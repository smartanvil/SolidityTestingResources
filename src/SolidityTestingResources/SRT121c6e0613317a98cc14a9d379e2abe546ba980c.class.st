Class {
	#name : #SRT121c6e0613317a98cc14a9d379e2abe546ba980c,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT121c6e0613317a98cc14a9d379e2abe546ba980c >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7Cgpjb250cmFjdCBNdWx0aW93bmFibGUgewoKICAgIC8vIFZBUklBQkxFUwoKICAgIHVpbnQyNTYgcHVibGljIGhvd01hbnlPd25lcnNEZWNpZGU7CiAgICBhZGRyZXNzW10gcHVibGljIG93bmVyczsKICAgIGJ5dGVzMzJbXSBwdWJsaWMgYWxsT3BlcmF0aW9uczsKICAgIGFkZHJlc3MgaW5zaWRlT25seU1hbnlPd25lcnM7CiAgICAKICAgIC8vIFJldmVyc2UgbG9va3VwIHRhYmxlcyBmb3Igb3duZXJzIGFuZCBhbGxPcGVyYXRpb25zCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgb3duZXJzSW5kaWNlczsgLy8gU3RhcnRzIGZyb20gMQogICAgbWFwcGluZyhieXRlczMyID0+IHVpbnQpIGFsbE9wZXJhdGlvbnNJbmRpY2llczsKICAgIAogICAgLy8gT3duZXJzIHZvdGluZyBtYXNrIHBlciBvcGVyYXRpb25zCiAgICBtYXBwaW5nKGJ5dGVzMzIgPT4gdWludDI1NikgcHVibGljIHZvdGVzTWFza0J5T3BlcmF0aW9uOwogICAgbWFwcGluZyhieXRlczMyID0+IHVpbnQyNTYpIHB1YmxpYyB2b3Rlc0NvdW50QnlPcGVyYXRpb247CiAgICAKICAgIC8vIEVWRU5UUwoKICAgIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3NbXSBwcmV2aW91c093bmVycywgYWRkcmVzc1tdIG5ld093bmVycyk7CgogICAgLy8gQUNDRVNTT1JTCgogICAgZnVuY3Rpb24gaXNPd25lcihhZGRyZXNzIHdhbGxldCkgcHVibGljIGNvbnN0YW50IHJldHVybnMoYm9vbCkgewogICAgICAgIHJldHVybiBvd25lcnNJbmRpY2VzW3dhbGxldF0gPiAwOwogICAgfQoKICAgIGZ1bmN0aW9uIG93bmVyc0NvdW50KCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludCkgewogICAgICAgIHJldHVybiBvd25lcnMubGVuZ3RoOwogICAgfQoKICAgIGZ1bmN0aW9uIGFsbE9wZXJhdGlvbnNDb3VudCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsKICAgICAgICByZXR1cm4gYWxsT3BlcmF0aW9ucy5sZW5ndGg7CiAgICB9CgogICAgLy8gTU9ESUZJRVJTCgogICAgLyoqCiAgICAqIEBkZXYgQWxsb3dzIHRvIHBlcmZvcm0gbWV0aG9kIGJ5IGFueSBvZiB0aGUgb3duZXJzCiAgICAqLwogICAgbW9kaWZpZXIgb25seUFueU93bmVyIHsKICAgICAgICByZXF1aXJlKGlzT3duZXIobXNnLnNlbmRlcikpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgQWxsb3dzIHRvIHBlcmZvcm0gbWV0aG9kIG9ubHkgYWZ0ZXIgYWxsIG93bmVycyBjYWxsIGl0IHdpdGggdGhlIHNhbWUgYXJndW1lbnRzCiAgICAqLwogICAgbW9kaWZpZXIgb25seU1hbnlPd25lcnMgewogICAgICAgIGlmIChpbnNpZGVPbmx5TWFueU93bmVycyA9PSBtc2cuc2VuZGVyKSB7CiAgICAgICAgICAgIF87CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgcmVxdWlyZShpc093bmVyKG1zZy5zZW5kZXIpKTsKCiAgICAgICAgdWludCBvd25lckluZGV4ID0gb3duZXJzSW5kaWNlc1ttc2cuc2VuZGVyXSAtIDE7CiAgICAgICAgYnl0ZXMzMiBvcGVyYXRpb24gPSBrZWNjYWsyNTYobXNnLmRhdGEpOwogICAgICAgIAogICAgICAgIGlmICh2b3Rlc01hc2tCeU9wZXJhdGlvbltvcGVyYXRpb25dID09IDApIHsKICAgICAgICAgICAgYWxsT3BlcmF0aW9uc0luZGljaWVzW29wZXJhdGlvbl0gPSBhbGxPcGVyYXRpb25zLmxlbmd0aDsKICAgICAgICAgICAgYWxsT3BlcmF0aW9ucy5wdXNoKG9wZXJhdGlvbik7CiAgICAgICAgfQogICAgICAgIHJlcXVpcmUoKHZvdGVzTWFza0J5T3BlcmF0aW9uW29wZXJhdGlvbl0gJiAoMiAqKiBvd25lckluZGV4KSkgPT0gMCk7CiAgICAgICAgdm90ZXNNYXNrQnlPcGVyYXRpb25bb3BlcmF0aW9uXSB8PSAoMiAqKiBvd25lckluZGV4KTsKICAgICAgICB2b3Rlc0NvdW50QnlPcGVyYXRpb25bb3BlcmF0aW9uXSArPSAxOwoKICAgICAgICAvLyBJZiBhbGwgb3duZXJzIGNvbmZpcm0gc2FtZSBvcGVyYXRpb24KICAgICAgICBpZiAodm90ZXNDb3VudEJ5T3BlcmF0aW9uW29wZXJhdGlvbl0gPT0gaG93TWFueU93bmVyc0RlY2lkZSkgewogICAgICAgICAgICBkZWxldGVPcGVyYXRpb24ob3BlcmF0aW9uKTsKICAgICAgICAgICAgaW5zaWRlT25seU1hbnlPd25lcnMgPSBtc2cuc2VuZGVyOwogICAgICAgICAgICBfOwogICAgICAgICAgICBpbnNpZGVPbmx5TWFueU93bmVycyA9IGFkZHJlc3MoMCk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIENPTlNUUlVDVE9SCgogICAgZnVuY3Rpb24gTXVsdGlvd25hYmxlKCkgcHVibGljIHsKICAgICAgICBvd25lcnMucHVzaChtc2cuc2VuZGVyKTsKICAgICAgICBvd25lcnNJbmRpY2VzW21zZy5zZW5kZXJdID0gMTsKICAgICAgICBob3dNYW55T3duZXJzRGVjaWRlID0gMTsKICAgIH0KCiAgICAvLyBJTlRFUk5BTCBNRVRIT0RTCgogICAgLyoqCiAgICAqIEBkZXYgVXNlZCB0byBkZWxldGUgY2FuY2VsbGVkIG9yIHBlcmZvcm1lZCBvcGVyYXRpb24KICAgICogQHBhcmFtIG9wZXJhdGlvbiBkZWZpbmVzIHdoaWNoIG9wZXJhdGlvbiB0byBkZWxldGUKICAgICovCiAgICBmdW5jdGlvbiBkZWxldGVPcGVyYXRpb24oYnl0ZXMzMiBvcGVyYXRpb24pIGludGVybmFsIHsKICAgICAgICB1aW50IGluZGV4ID0gYWxsT3BlcmF0aW9uc0luZGljaWVzW29wZXJhdGlvbl07CiAgICAgICAgaWYgKGFsbE9wZXJhdGlvbnMubGVuZ3RoID4gMSkgewogICAgICAgICAgICBhbGxPcGVyYXRpb25zW2luZGV4XSA9IGFsbE9wZXJhdGlvbnNbYWxsT3BlcmF0aW9ucy5sZW5ndGggLSAxXTsKICAgICAgICAgICAgYWxsT3BlcmF0aW9uc0luZGljaWVzW2FsbE9wZXJhdGlvbnNbaW5kZXhdXSA9IGluZGV4OwogICAgICAgIH0KICAgICAgICBhbGxPcGVyYXRpb25zLmxlbmd0aC0tOwogICAgICAgIAogICAgICAgIGRlbGV0ZSB2b3Rlc01hc2tCeU9wZXJhdGlvbltvcGVyYXRpb25dOwogICAgICAgIGRlbGV0ZSB2b3Rlc0NvdW50QnlPcGVyYXRpb25bb3BlcmF0aW9uXTsKICAgICAgICBkZWxldGUgYWxsT3BlcmF0aW9uc0luZGljaWVzW29wZXJhdGlvbl07CiAgICB9CgogICAgLy8gUFVCTElDIE1FVEhPRFMKCiAgICAvKioKICAgICogQGRldiBBbGxvd3Mgb3duZXJzIHRvIGNoYW5nZSB0aGVpciBtaW5kIGJ5IGNhY25lbGxpbmcgdm90ZXNNYXNrQnlPcGVyYXRpb24gb3BlcmF0aW9ucwogICAgKiBAcGFyYW0gb3BlcmF0aW9uIGRlZmluZXMgd2hpY2ggb3BlcmF0aW9uIHRvIGRlbGV0ZQogICAgKi8KICAgIGZ1bmN0aW9uIGNhbmNlbFBlbmRpbmcoYnl0ZXMzMiBvcGVyYXRpb24pIHB1YmxpYyBvbmx5QW55T3duZXIgewogICAgICAgIHVpbnQgb3duZXJJbmRleCA9IG93bmVyc0luZGljZXNbbXNnLnNlbmRlcl0gLSAxOwogICAgICAgIHJlcXVpcmUoKHZvdGVzTWFza0J5T3BlcmF0aW9uW29wZXJhdGlvbl0gJiAoMiAqKiBvd25lckluZGV4KSkgIT0gMCk7CiAgICAgICAgCiAgICAgICAgdm90ZXNNYXNrQnlPcGVyYXRpb25bb3BlcmF0aW9uXSAmPSB+KDIgKiogb3duZXJJbmRleCk7CiAgICAgICAgdm90ZXNDb3VudEJ5T3BlcmF0aW9uW29wZXJhdGlvbl0tLTsKICAgICAgICBpZiAodm90ZXNDb3VudEJ5T3BlcmF0aW9uW29wZXJhdGlvbl0gPT0gMCkgewogICAgICAgICAgICBkZWxldGVPcGVyYXRpb24ob3BlcmF0aW9uKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgQWxsb3dzIG93bmVycyB0byBjaGFuZ2Ugb3duZXJzaGlwCiAgICAqIEBwYXJhbSBuZXdPd25lcnMgZGVmaW5lcyBhcnJheSBvZiBhZGRyZXNzZXMgb2YgbmV3IG93bmVycwogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3NbXSBuZXdPd25lcnMpIHB1YmxpYyB7CiAgICAgICAgdHJhbnNmZXJPd25lcnNoaXBXaXRoSG93TWFueShuZXdPd25lcnMsIG5ld093bmVycy5sZW5ndGgpOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEFsbG93cyBvd25lcnMgdG8gY2hhbmdlIG93bmVyc2hpcAogICAgKiBAcGFyYW0gbmV3T3duZXJzIGRlZmluZXMgYXJyYXkgb2YgYWRkcmVzc2VzIG9mIG5ldyBvd25lcnMKICAgICogQHBhcmFtIG5ld0hvd01hbnlPd25lcnNEZWNpZGUgZGVmaW5lcyBob3cgbWFueSBvd25lcnMgY2FuIGRlY2lkZQogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwV2l0aEhvd01hbnkoYWRkcmVzc1tdIG5ld093bmVycywgdWludDI1NiBuZXdIb3dNYW55T3duZXJzRGVjaWRlKSBwdWJsaWMgb25seU1hbnlPd25lcnMgewogICAgICAgIHJlcXVpcmUobmV3T3duZXJzLmxlbmd0aCA+IDApOwogICAgICAgIHJlcXVpcmUobmV3T3duZXJzLmxlbmd0aCA8PSAyNTYpOwogICAgICAgIHJlcXVpcmUobmV3SG93TWFueU93bmVyc0RlY2lkZSA+IDApOwogICAgICAgIHJlcXVpcmUobmV3SG93TWFueU93bmVyc0RlY2lkZSA8PSBuZXdPd25lcnMubGVuZ3RoKTsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBuZXdPd25lcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgcmVxdWlyZShuZXdPd25lcnNbaV0gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgfQoKICAgICAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lcnMsIG5ld093bmVycyk7CgogICAgICAgIC8vIFJlc2V0IG93bmVycyBhcnJheSBhbmQgaW5kZXggcmV2ZXJzZSBsb29rdXAgdGFibGUKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgb3duZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGRlbGV0ZSBvd25lcnNJbmRpY2VzW293bmVyc1tpXV07CiAgICAgICAgfQogICAgICAgIGZvciAoaSA9IDA7IGkgPCBuZXdPd25lcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgcmVxdWlyZShvd25lcnNJbmRpY2VzW25ld093bmVyc1tpXV0gPT0gMCk7CiAgICAgICAgICAgIG93bmVyc0luZGljZXNbbmV3T3duZXJzW2ldXSA9IGkgKyAxOwogICAgICAgIH0KICAgICAgICBvd25lcnMgPSBuZXdPd25lcnM7CiAgICAgICAgaG93TWFueU93bmVyc0RlY2lkZSA9IG5ld0hvd01hbnlPd25lcnNEZWNpZGU7CgogICAgICAgIC8vIERpc2NhcmQgYWxsIHBlbmRpZ24gb3BlcmF0aW9ucwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBhbGxPcGVyYXRpb25zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGRlbGV0ZSB2b3Rlc01hc2tCeU9wZXJhdGlvblthbGxPcGVyYXRpb25zW2ldXTsKICAgICAgICAgICAgZGVsZXRlIHZvdGVzQ291bnRCeU9wZXJhdGlvblthbGxPcGVyYXRpb25zW2ldXTsKICAgICAgICAgICAgZGVsZXRlIGFsbE9wZXJhdGlvbnNJbmRpY2llc1thbGxPcGVyYXRpb25zW2ldXTsKICAgICAgICB9CiAgICAgICAgYWxsT3BlcmF0aW9ucy5sZW5ndGggPSAwOwogICAgfQoKfQoKY29udHJhY3Qgb3duZWQgewogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgogICAgZnVuY3Rpb24gb3duZWQoKSBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICBvd25lciA9IG5ld093bmVyOwogICAgfQp9CgoKY29udHJhY3QgUEVMT0V4dGVuc2lvbkludGVyZmFjZSBpcyBvd25lZCB7CgogICAgZXZlbnQgRXh0ZW5zaW9uQ2FsbGVkKGJ5dGVzMzJbOF0gcGFyYW1zKTsKCiAgICBhZGRyZXNzIHB1YmxpYyBvd25lckNvbnRyYWN0OwoKICAgIGZ1bmN0aW9uIFBFTE9FeHRlbnNpb25JbnRlcmZhY2UoYWRkcmVzcyBfb3duZXJDb250cmFjdCkgcHVibGljIHsKICAgICAgICBvd25lckNvbnRyYWN0ID0gX293bmVyQ29udHJhY3Q7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIENoYW5nZU93bmVyQ29udHJhY3QoYWRkcmVzcyBfb3duZXJDb250cmFjdCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgb3duZXJDb250cmFjdCA9IF9vd25lckNvbnRyYWN0OwogICAgfQogICAgCiAgICBmdW5jdGlvbiBPcGVyYXRpb24odWludDggb3BDb2RlLCBieXRlczMyWzhdIHBhcmFtcykgcHVibGljIHJldHVybnMgKGJ5dGVzMzJbOF0gcmVzdWx0KSB7fQp9Cgpjb250cmFjdCBQRUxPRXh0ZW5zaW9uMSBpcyBQRUxPRXh0ZW5zaW9uSW50ZXJmYWNlIHsKCiAgICBmdW5jdGlvbiBQRUxPRXh0ZW5zaW9uMShhZGRyZXNzIF9vd25lckNvbnRyYWN0KSBQRUxPRXh0ZW5zaW9uSW50ZXJmYWNlKF9vd25lckNvbnRyYWN0KSBwdWJsaWMge30gCiAgICAKICAgIGZ1bmN0aW9uIE9wZXJhdGlvbih1aW50OCBvcENvZGUsIGJ5dGVzMzJbOF0gcGFyYW1zKSBwdWJsaWMgcmV0dXJucyAoYnl0ZXMzMls4XSByZXN1bHQpIHsKICAgICAgICBpZihvcENvZGUgPT0gMSkgewogICAgICAgICAgICBFeHRlbnNpb25DYWxsZWQocGFyYW1zKTsKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZihvcENvZGUgPT0gMikgewogICAgICAgICAgICBFeHRlbnNpb25DYWxsZWQocGFyYW1zKTsKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgfQogICAgfQp9CgoKaW50ZXJmYWNlIHRva2VuUmVjaXBpZW50IHsgZnVuY3Rpb24gcmVjZWl2ZUFwcHJvdmFsKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlLCBhZGRyZXNzIF90b2tlbiwgYnl0ZXMgX2V4dHJhRGF0YSkgcHVibGljOyB9Cgpjb250cmFjdCBUb2tlbkVSQzIwIHsKICAgIC8vIFB1YmxpYyB2YXJpYWJsZXMgb2YgdGhlIHRva2VuCiAgICBzdHJpbmcgcHVibGljIG5hbWU7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsKICAgIHVpbnQ4IHB1YmxpYyBkZWNpbWFscyA9IDE4OwogICAgLy8gMTggZGVjaW1hbHMgaXMgdGhlIHN0cm9uZ2x5IHN1Z2dlc3RlZCBkZWZhdWx0LCBhdm9pZCBjaGFuZ2luZyBpdAogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CgogICAgLy8gVGhpcyBjcmVhdGVzIGFuIGFycmF5IHdpdGggYWxsIGJhbGFuY2VzCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBiYWxhbmNlT2Y7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIHB1YmxpYyBhbGxvd2FuY2U7CgogICAgLy8gVGhpcyBnZW5lcmF0ZXMgYSBwdWJsaWMgZXZlbnQgb24gdGhlIGJsb2NrY2hhaW4gdGhhdCB3aWxsIG5vdGlmeSBjbGllbnRzCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKCiAgICAvLyBUaGlzIG5vdGlmaWVzIGNsaWVudHMgYWJvdXQgdGhlIGFtb3VudCBidXJudAogICAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgdWludDI1NiB2YWx1ZSk7CgogICAgLyoqCiAgICAgKiBDb25zdHJjdG9yIGZ1bmN0aW9uCiAgICAgKgogICAgICogSW5pdGlhbGl6ZXMgY29udHJhY3Qgd2l0aCBpbml0aWFsIHN1cHBseSB0b2tlbnMgdG8gdGhlIGNyZWF0b3Igb2YgdGhlIGNvbnRyYWN0CiAgICAgKi8KICAgIGZ1bmN0aW9uIFRva2VuRVJDMjAoCiAgICAgICAgdWludDI1NiBpbml0aWFsU3VwcGx5LAogICAgICAgIHN0cmluZyB0b2tlbk5hbWUsCiAgICAgICAgc3RyaW5nIHRva2VuU3ltYm9sCiAgICApIHB1YmxpYyB7CiAgICAgICAgdG90YWxTdXBwbHkgPSBpbml0aWFsU3VwcGx5ICogMTAgKiogdWludDI1NihkZWNpbWFscyk7ICAvLyBVcGRhdGUgdG90YWwgc3VwcGx5IHdpdGggdGhlIGRlY2ltYWwgYW1vdW50CiAgICAgICAgYmFsYW5jZU9mW21zZy5zZW5kZXJdID0gdG90YWxTdXBwbHk7ICAgICAgICAgICAgICAgIC8vIEdpdmUgdGhlIGNyZWF0b3IgYWxsIGluaXRpYWwgdG9rZW5zCiAgICAgICAgbmFtZSA9IHRva2VuTmFtZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgbmFtZSBmb3IgZGlzcGxheSBwdXJwb3NlcwogICAgICAgIHN5bWJvbCA9IHRva2VuU3ltYm9sOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIHN5bWJvbCBmb3IgZGlzcGxheSBwdXJwb3NlcwogICAgfQoKICAgIC8qKgogICAgICogSW50ZXJuYWwgdHJhbnNmZXIsIG9ubHkgY2FuIGJlIGNhbGxlZCBieSB0aGlzIGNvbnRyYWN0CiAgICAgKi8KICAgIGZ1bmN0aW9uIF90cmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIGludGVybmFsIHsKICAgICAgICAvLyBQcmV2ZW50IHRyYW5zZmVyIHRvIDB4MCBhZGRyZXNzLiBVc2UgYnVybigpIGluc3RlYWQKICAgICAgICByZXF1aXJlKF90byAhPSAweDApOwogICAgICAgIC8vIENoZWNrIGlmIHRoZSBzZW5kZXIgaGFzIGVub3VnaAogICAgICAgIHJlcXVpcmUoYmFsYW5jZU9mW19mcm9tXSA+PSBfdmFsdWUpOwogICAgICAgIC8vIENoZWNrIGZvciBvdmVyZmxvd3MKICAgICAgICByZXF1aXJlKGJhbGFuY2VPZltfdG9dICsgX3ZhbHVlID4gYmFsYW5jZU9mW190b10pOwogICAgICAgIC8vIFNhdmUgdGhpcyBmb3IgYW4gYXNzZXJ0aW9uIGluIHRoZSBmdXR1cmUKICAgICAgICB1aW50IHByZXZpb3VzQmFsYW5jZXMgPSBiYWxhbmNlT2ZbX2Zyb21dICsgYmFsYW5jZU9mW190b107CiAgICAgICAgLy8gU3VidHJhY3QgZnJvbSB0aGUgc2VuZGVyCiAgICAgICAgYmFsYW5jZU9mW19mcm9tXSAtPSBfdmFsdWU7CiAgICAgICAgLy8gQWRkIHRoZSBzYW1lIHRvIHRoZSByZWNpcGllbnQKICAgICAgICBiYWxhbmNlT2ZbX3RvXSArPSBfdmFsdWU7CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICAvLyBBc3NlcnRzIGFyZSB1c2VkIHRvIHVzZSBzdGF0aWMgYW5hbHlzaXMgdG8gZmluZCBidWdzIGluIHlvdXIgY29kZS4gVGhleSBzaG91bGQgbmV2ZXIgZmFpbAogICAgICAgIGFzc2VydChiYWxhbmNlT2ZbX2Zyb21dICsgYmFsYW5jZU9mW190b10gPT0gcHJldmlvdXNCYWxhbmNlcyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUcmFuc2ZlciB0b2tlbnMKICAgICAqCiAgICAgKiBTZW5kIGBfdmFsdWVgIHRva2VucyB0byBgX3RvYCBmcm9tIHlvdXIgYWNjb3VudAogICAgICoKICAgICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudAogICAgICogQHBhcmFtIF92YWx1ZSB0aGUgYW1vdW50IHRvIHNlbmQKICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgewogICAgICAgIF90cmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvdGhlciBhZGRyZXNzCiAgICAgKgogICAgICogU2VuZCBgX3ZhbHVlYCB0b2tlbnMgdG8gYF90b2AgaW4gYmVoYWxmIG9mIGBfZnJvbWAKICAgICAqCiAgICAgKiBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3Mgb2YgdGhlIHNlbmRlcgogICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICAgKiBAcGFyYW0gX3ZhbHVlIHRoZSBhbW91bnQgdG8gc2VuZAogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYWxsb3dhbmNlW19mcm9tXVttc2cuc2VuZGVyXSk7ICAgICAvLyBDaGVjayBhbGxvd2FuY2UKICAgICAgICBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdIC09IF92YWx1ZTsKICAgICAgICBfdHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCBhbGxvd2FuY2UgZm9yIG90aGVyIGFkZHJlc3MKICAgICAqCiAgICAgKiBBbGxvd3MgYF9zcGVuZGVyYCB0byBzcGVuZCBubyBtb3JlIHRoYW4gYF92YWx1ZWAgdG9rZW5zIGluIHlvdXIgYmVoYWxmCiAgICAgKgogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIGF1dGhvcml6ZWQgdG8gc3BlbmQKICAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIG1heCBhbW91bnQgdGhleSBjYW4gc3BlbmQKICAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgYWxsb3dhbmNlW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCBhbGxvd2FuY2UgZm9yIG90aGVyIGFkZHJlc3MgYW5kIG5vdGlmeQogICAgICoKICAgICAqIEFsbG93cyBgX3NwZW5kZXJgIHRvIHNwZW5kIG5vIG1vcmUgdGhhbiBgX3ZhbHVlYCB0b2tlbnMgaW4geW91ciBiZWhhbGYsIGFuZCB0aGVuIHBpbmcgdGhlIGNvbnRyYWN0IGFib3V0IGl0CiAgICAgKgogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIGF1dGhvcml6ZWQgdG8gc3BlbmQKICAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIG1heCBhbW91bnQgdGhleSBjYW4gc3BlbmQKICAgICAqIEBwYXJhbSBfZXh0cmFEYXRhIHNvbWUgZXh0cmEgaW5mb3JtYXRpb24gdG8gc2VuZCB0byB0aGUgYXBwcm92ZWQgY29udHJhY3QKICAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZUFuZENhbGwoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9leHRyYURhdGEpCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgdG9rZW5SZWNpcGllbnQgc3BlbmRlciA9IHRva2VuUmVjaXBpZW50KF9zcGVuZGVyKTsKICAgICAgICBpZiAoYXBwcm92ZShfc3BlbmRlciwgX3ZhbHVlKSkgewogICAgICAgICAgICBzcGVuZGVyLnJlY2VpdmVBcHByb3ZhbChtc2cuc2VuZGVyLCBfdmFsdWUsIHRoaXMsIF9leHRyYURhdGEpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBEZXN0cm95IHRva2VucwogICAgICoKICAgICAqIFJlbW92ZSBgX3ZhbHVlYCB0b2tlbnMgZnJvbSB0aGUgc3lzdGVtIGlycmV2ZXJzaWJseQogICAgICoKICAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIGFtb3VudCBvZiBtb25leSB0byBidXJuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJ1cm4odWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXF1aXJlKGJhbGFuY2VPZlttc2cuc2VuZGVyXSA+PSBfdmFsdWUpOyAgIC8vIENoZWNrIGlmIHRoZSBzZW5kZXIgaGFzIGVub3VnaAogICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSAtPSBfdmFsdWU7ICAgICAgICAgICAgLy8gU3VidHJhY3QgZnJvbSB0aGUgc2VuZGVyCiAgICAgICAgdG90YWxTdXBwbHkgLT0gX3ZhbHVlOyAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGVzIHRvdGFsU3VwcGx5CiAgICAgICAgQnVybihtc2cuc2VuZGVyLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogRGVzdHJveSB0b2tlbnMgZnJvbSBvdGhlciBhY2NvdW50CiAgICAgKgogICAgICogUmVtb3ZlIGBfdmFsdWVgIHRva2VucyBmcm9tIHRoZSBzeXN0ZW0gaXJyZXZlcnNpYmx5IG9uIGJlaGFsZiBvZiBgX2Zyb21gLgogICAgICoKICAgICAqIEBwYXJhbSBfZnJvbSB0aGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyCiAgICAgKiBAcGFyYW0gX3ZhbHVlIHRoZSBhbW91bnQgb2YgbW9uZXkgdG8gYnVybgogICAgICovCiAgICBmdW5jdGlvbiBidXJuRnJvbShhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoYmFsYW5jZU9mW19mcm9tXSA+PSBfdmFsdWUpOyAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgdGFyZ2V0ZWQgYmFsYW5jZSBpcyBlbm91Z2gKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdKTsgICAgLy8gQ2hlY2sgYWxsb3dhbmNlCiAgICAgICAgYmFsYW5jZU9mW19mcm9tXSAtPSBfdmFsdWU7ICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN1YnRyYWN0IGZyb20gdGhlIHRhcmdldGVkIGJhbGFuY2UKICAgICAgICBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdIC09IF92YWx1ZTsgICAgICAgICAgICAgLy8gU3VidHJhY3QgZnJvbSB0aGUgc2VuZGVyJ3MgYWxsb3dhbmNlCiAgICAgICAgdG90YWxTdXBwbHkgLT0gX3ZhbHVlOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0b3RhbFN1cHBseQogICAgICAgIEJ1cm4oX2Zyb20sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0KCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qICAgICAgIEFEVkFOQ0VEIFRPS0VOIFNUQVJUUyBIRVJFICAgICAgICovCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgpjb250cmFjdCBQRUxPQ29pblRva2VuIGlzIE11bHRpb3duYWJsZSwgVG9rZW5FUkMyMCB7CgogICAgdWludDI1NiBwdWJsaWMgc2VsbFByaWNlOwogICAgdWludDI1NiBwdWJsaWMgYnV5UHJpY2U7CiAgICAKICAgIGJvb2wgcHVibGljIHVzZXJJbml0aWFsaXplZCA9IGZhbHNlOwogICAgCiAgICBQRUxPRXh0ZW5zaW9uSW50ZXJmYWNlIHB1YmxpYyBwZWxvRXh0ZW5zdGlvbjsKICAgIAogICAgc3RydWN0IFBFTE9NZW1iZXIgewogICAgICAgIHVpbnQzMiBpZDsKICAgICAgICBieXRlczMyIG5pY2tuYW1lOwogICAgICAgIGFkZHJlc3MgZXRoQWRkcjsKCiAgICAgICAgLyogcGVsb0Ftb3VudCBzaG91bGQgYmUgc3BlY2lmaWVkIHdpdGhvdXQgZGVjaW1hbHMuIGV4OiAxMDAwMFBFTE8gc2hvdWxkIGJlIHNwZWNpZmllZCBhcyAxMDAwMCBub3QgMTAwMDAgKiAxMF4xOCAqLwogICAgICAgIHVpbnQgcGVsb0Ftb3VudDsKCiAgICAgICAgLyogcGVsb0JvbnVzIHNob3VsZCBiZSBzcGVjaWZpZWQgd2l0aG91dCBkZWNpbWFscy4gZXg6IDEwMDAwUEVMTyBzaG91bGQgYmUgc3BlY2lmaWVkIGFzIDEwMDAwIG5vdCAxMDAwMCAqIDEwXjE4ICovCiAgICAgICAgdWludCBwZWxvQm9udXM7CgogICAgICAgIC8qIDE6IGluZmluaXRlIG1lbWJlcnMsIDI6IGxpbWl0ZWQgbWVtYmVyKGhhcyBleHBhaXJhdGlvbiBkYXRlKSwgNDogeHh4LCA4OiB4eHgsIDE2OiB4eHgsIDMyIC4uLiA2NTUzNiAuLi4gMl4yNTUgKi8KICAgICAgICB1aW50IGJpdEZsYWc7CgogICAgICAgIHVpbnQzMiBleHBpcmU7CiAgICAgICAgYnl0ZXMzMiBleHRyYURhdGExOwogICAgICAgIGJ5dGVzMzIgZXh0cmFEYXRhMjsKICAgICAgICBieXRlczMyIGV4dHJhRGF0YTM7CiAgICB9CiAgICAKICAgIHVpbnQ4IHB1YmxpYyBudW1NZW1iZXJzOwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIGZyb3plbkFjY291bnQ7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBQRUxPTWVtYmVyKSBwdWJsaWMgUEVMT01lbWJlck1hcDsKICAgIG1hcHBpbmcgKHVpbnQzMiA9PiBhZGRyZXNzKSBwdWJsaWMgUEVMT01lbWJlcklETWFwOwoKICAgIC8qIFRoaXMgZ2VuZXJhdGVzIGEgcHVibGljIGV2ZW50IG9uIHRoZSBibG9ja2NoYWluIHRoYXQgd2lsbCBub3RpZnkgY2xpZW50cyAqLwogICAgZXZlbnQgRnJvemVuRnVuZHMoYWRkcmVzcyB0YXJnZXQsIGJvb2wgZnJvemVuKTsKCiAgICAvKiBJbml0aWFsaXplcyBjb250cmFjdCB3aXRoIGluaXRpYWwgc3VwcGx5IHRva2VucyB0byB0aGUgY3JlYXRvciBvZiB0aGUgY29udHJhY3QgKi8KICAgIGZ1bmN0aW9uIFBFTE9Db2luVG9rZW4oCiAgICAgICAgdWludDI1NiBpbml0aWFsU3VwcGx5LAogICAgICAgIHN0cmluZyB0b2tlbk5hbWUsCiAgICAgICAgc3RyaW5nIHRva2VuU3ltYm9sCiAgICApIFRva2VuRVJDMjAoaW5pdGlhbFN1cHBseSwgdG9rZW5OYW1lLCB0b2tlblN5bWJvbCkgcHVibGljIHt9CgogICAgZnVuY3Rpb24gR2V0VXNlck5pY2tOYW1lKGFkZHJlc3MgX2FkZHIpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zKGJ5dGVzMzIpIHsKICAgICAgICByZXF1aXJlKFBFTE9NZW1iZXJNYXBbX2FkZHJdLmlkID4gMCk7CiAgICAgICAgUEVMT01lbWJlciBtZW1vcnkgZGF0YSA9IFBFTE9NZW1iZXJNYXBbX2FkZHJdOyAKICAgICAgICAKICAgICAgICByZXR1cm4gZGF0YS5uaWNrbmFtZTsKICAgIH0KCiAgICBmdW5jdGlvbiBHZXRVc2VySUQoYWRkcmVzcyBfYWRkcikgY29uc3RhbnQgcHVibGljIHJldHVybnModWludDMyKSB7CiAgICAgICAgcmVxdWlyZShQRUxPTWVtYmVyTWFwW19hZGRyXS5pZCA+IDApOwogICAgICAgIFBFTE9NZW1iZXIgbWVtb3J5IGRhdGEgPSBQRUxPTWVtYmVyTWFwW19hZGRyXTsgCiAgICAgICAgCiAgICAgICAgcmV0dXJuIGRhdGEuaWQ7CiAgICB9CgogICAgZnVuY3Rpb24gR2V0VXNlclBFTE9BbW91bnQoYWRkcmVzcyBfYWRkcikgY29uc3RhbnQgcHVibGljIHJldHVybnModWludCkgewogICAgICAgIHJlcXVpcmUoUEVMT01lbWJlck1hcFtfYWRkcl0uaWQgPiAwKTsKICAgICAgICBQRUxPTWVtYmVyIG1lbW9yeSBkYXRhID0gUEVMT01lbWJlck1hcFtfYWRkcl07IAogICAgICAgIAogICAgICAgIHJldHVybiBkYXRhLnBlbG9BbW91bnQ7CiAgICB9CgogICAgZnVuY3Rpb24gR2V0VXNlclBFTE9Cb251cyhhZGRyZXNzIF9hZGRyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyh1aW50KSB7CiAgICAgICAgcmVxdWlyZShQRUxPTWVtYmVyTWFwW19hZGRyXS5pZCA+IDApOwogICAgICAgIFBFTE9NZW1iZXIgbWVtb3J5IGRhdGEgPSBQRUxPTWVtYmVyTWFwW19hZGRyXTsgCiAgICAgICAgCiAgICAgICAgcmV0dXJuIGRhdGEucGVsb0JvbnVzOwogICAgfQoKICAgIGZ1bmN0aW9uIEdldFVzZXJCaXRGbGFnKGFkZHJlc3MgX2FkZHIpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zKHVpbnQpIHsKICAgICAgICByZXF1aXJlKFBFTE9NZW1iZXJNYXBbX2FkZHJdLmlkID4gMCk7CiAgICAgICAgUEVMT01lbWJlciBtZW1vcnkgZGF0YSA9IFBFTE9NZW1iZXJNYXBbX2FkZHJdOyAKICAgICAgICAKICAgICAgICByZXR1cm4gZGF0YS5iaXRGbGFnOwogICAgfQoKICAgIGZ1bmN0aW9uIFRlc3RVc2VyQml0RmxhZyhhZGRyZXNzIF9hZGRyLCB1aW50IF9mbGFnKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmVxdWlyZShQRUxPTWVtYmVyTWFwW19hZGRyXS5pZCA+IDApOwogICAgICAgIFBFTE9NZW1iZXIgbWVtb3J5IGRhdGEgPSBQRUxPTWVtYmVyTWFwW19hZGRyXTsgCiAgICAgICAgCiAgICAgICAgcmV0dXJuIChkYXRhLmJpdEZsYWcgJiBfZmxhZykgPT0gX2ZsYWc7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIEdldFVzZXJFeHBpcmUoYWRkcmVzcyBfYWRkcikgY29uc3RhbnQgcHVibGljIHJldHVybnModWludDMyKSB7CiAgICAgICAgcmVxdWlyZShQRUxPTWVtYmVyTWFwW19hZGRyXS5pZCA+IDApOwogICAgICAgIFBFTE9NZW1iZXIgbWVtb3J5IGRhdGEgPSBQRUxPTWVtYmVyTWFwW19hZGRyXTsgCiAgICAgICAgCiAgICAgICAgcmV0dXJuIGRhdGEuZXhwaXJlOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBHZXRVc2VyRXh0cmFEYXRhMShhZGRyZXNzIF9hZGRyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyhieXRlczMyKSB7CiAgICAgICAgcmVxdWlyZShQRUxPTWVtYmVyTWFwW19hZGRyXS5pZCA+IDApOwogICAgICAgIFBFTE9NZW1iZXIgbWVtb3J5IGRhdGEgPSBQRUxPTWVtYmVyTWFwW19hZGRyXTsgCiAgICAgICAgCiAgICAgICAgcmV0dXJuIGRhdGEuZXh0cmFEYXRhMTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gR2V0VXNlckV4dHJhRGF0YTIoYWRkcmVzcyBfYWRkcikgY29uc3RhbnQgcHVibGljIHJldHVybnMoYnl0ZXMzMikgewogICAgICAgIHJlcXVpcmUoUEVMT01lbWJlck1hcFtfYWRkcl0uaWQgPiAwKTsKICAgICAgICBQRUxPTWVtYmVyIG1lbW9yeSBkYXRhID0gUEVMT01lbWJlck1hcFtfYWRkcl07IAogICAgICAgIAogICAgICAgIHJldHVybiBkYXRhLmV4dHJhRGF0YTI7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIEdldFVzZXJFeHRyYURhdGEzKGFkZHJlc3MgX2FkZHIpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zKGJ5dGVzMzIpIHsKICAgICAgICByZXF1aXJlKFBFTE9NZW1iZXJNYXBbX2FkZHJdLmlkID4gMCk7CiAgICAgICAgUEVMT01lbWJlciBtZW1vcnkgZGF0YSA9IFBFTE9NZW1iZXJNYXBbX2FkZHJdOyAKICAgICAgICAKICAgICAgICByZXR1cm4gZGF0YS5leHRyYURhdGEzOwogICAgfQoKICAgIGZ1bmN0aW9uIFVwZGF0ZVVzZXJOaWNrTmFtZShhZGRyZXNzIF9hZGRyLCBieXRlczMyIF9uZXdOaWNrTmFtZSkgb25seU1hbnlPd25lcnMgcHVibGljIHsKICAgICAgICByZXF1aXJlKFBFTE9NZW1iZXJNYXBbX2FkZHJdLmlkID4gMCk7CiAgICAgICAgUEVMT01lbWJlciBzdG9yYWdlIGRhdGEgPSBQRUxPTWVtYmVyTWFwW19hZGRyXTsgCiAgICAgICAgCiAgICAgICAgZGF0YS5uaWNrbmFtZSA9IF9uZXdOaWNrTmFtZTsKICAgIH0KCiAgICBmdW5jdGlvbiBVcGRhdGVVc2VyUEVMT0Ftb3VudChhZGRyZXNzIF9hZGRyLCB1aW50IF9uZXdWYWx1ZSkgb25seU1hbnlPd25lcnMgcHVibGljIHsKICAgICAgICByZXF1aXJlKFBFTE9NZW1iZXJNYXBbX2FkZHJdLmlkID4gMCk7CiAgICAgICAgUEVMT01lbWJlciBzdG9yYWdlIGRhdGEgPSBQRUxPTWVtYmVyTWFwW19hZGRyXTsgCiAgICAgICAgCiAgICAgICAgZGF0YS5wZWxvQW1vdW50ID0gX25ld1ZhbHVlOwogICAgfQoKICAgIGZ1bmN0aW9uIFVwZGF0ZVVzZXJQRUxPQm9udXMoYWRkcmVzcyBfYWRkciwgdWludCBfbmV3VmFsdWUpIG9ubHlNYW55T3duZXJzIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShQRUxPTWVtYmVyTWFwW19hZGRyXS5pZCA+IDApOwogICAgICAgIFBFTE9NZW1iZXIgc3RvcmFnZSBkYXRhID0gUEVMT01lbWJlck1hcFtfYWRkcl07IAogICAgICAgIAogICAgICAgIGRhdGEucGVsb0JvbnVzID0gX25ld1ZhbHVlOwogICAgfQoKICAgIGZ1bmN0aW9uIFVwZGF0ZVVzZXJCaXRGbGFnKGFkZHJlc3MgX2FkZHIsIHVpbnQgX25ld1ZhbHVlKSBvbmx5TWFueU93bmVycyBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoUEVMT01lbWJlck1hcFtfYWRkcl0uaWQgPiAwKTsKICAgICAgICBQRUxPTWVtYmVyIHN0b3JhZ2UgZGF0YSA9IFBFTE9NZW1iZXJNYXBbX2FkZHJdOyAKICAgICAgICAKICAgICAgICBkYXRhLmJpdEZsYWcgPSBfbmV3VmFsdWU7CiAgICB9CgogICAgZnVuY3Rpb24gVXBkYXRlVXNlckV4cGlyZShhZGRyZXNzIF9hZGRyLCB1aW50MzIgX25ld1ZhbHVlKSBvbmx5TWFueU93bmVycyBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoUEVMT01lbWJlck1hcFtfYWRkcl0uaWQgPiAwKTsKICAgICAgICBQRUxPTWVtYmVyIHN0b3JhZ2UgZGF0YSA9IFBFTE9NZW1iZXJNYXBbX2FkZHJdOyAKICAgICAgICAKICAgICAgICBkYXRhLmV4cGlyZSA9IF9uZXdWYWx1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBVcGRhdGVVc2VyRXh0cmFEYXRhMShhZGRyZXNzIF9hZGRyLCBieXRlczMyIF9uZXdWYWx1ZSkgb25seU1hbnlPd25lcnMgcHVibGljIHsKICAgICAgICByZXF1aXJlKFBFTE9NZW1iZXJNYXBbX2FkZHJdLmlkID4gMCk7CiAgICAgICAgUEVMT01lbWJlciBzdG9yYWdlIGRhdGEgPSBQRUxPTWVtYmVyTWFwW19hZGRyXTsgCiAgICAgICAgCiAgICAgICAgZGF0YS5leHRyYURhdGExID0gX25ld1ZhbHVlOwogICAgfQoKICAgIGZ1bmN0aW9uIFVwZGF0ZVVzZXJFeHRyYURhdGEyKGFkZHJlc3MgX2FkZHIsIGJ5dGVzMzIgX25ld1ZhbHVlKSBvbmx5TWFueU93bmVycyBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoUEVMT01lbWJlck1hcFtfYWRkcl0uaWQgPiAwKTsKICAgICAgICBQRUxPTWVtYmVyIHN0b3JhZ2UgZGF0YSA9IFBFTE9NZW1iZXJNYXBbX2FkZHJdOyAKICAgICAgICAKICAgICAgICBkYXRhLmV4dHJhRGF0YTIgPSBfbmV3VmFsdWU7CiAgICB9CgogICAgZnVuY3Rpb24gVXBkYXRlVXNlckV4dHJhRGF0YTMoYWRkcmVzcyBfYWRkciwgYnl0ZXMzMiBfbmV3VmFsdWUpIG9ubHlNYW55T3duZXJzIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShQRUxPTWVtYmVyTWFwW19hZGRyXS5pZCA+IDApOwogICAgICAgIFBFTE9NZW1iZXIgc3RvcmFnZSBkYXRhID0gUEVMT01lbWJlck1hcFtfYWRkcl07IAogICAgICAgIAogICAgICAgIGRhdGEuZXh0cmFEYXRhMyA9IF9uZXdWYWx1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBEZWxldGVVc2VyQnlBZGRyKGFkZHJlc3MgX2FkZHIpIG9ubHlNYW55T3duZXJzIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShQRUxPTWVtYmVyTWFwW19hZGRyXS5pZCA+IDApOwoKICAgICAgICBkZWxldGUgUEVMT01lbWJlcklETWFwW1BFTE9NZW1iZXJNYXBbX2FkZHJdLmlkXTsKICAgICAgICBkZWxldGUgUEVMT01lbWJlck1hcFtfYWRkcl07CgogICAgICAgIG51bU1lbWJlcnMtLTsKICAgICAgICBhc3NlcnQobnVtTWVtYmVycyA+PSAwKTsKICAgIH0KCiAgICBmdW5jdGlvbiBEZWxldGVVc2VyQnlJRCh1aW50MzIgX2lkKSBvbmx5TWFueU93bmVycyBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoUEVMT01lbWJlcklETWFwW19pZF0gIT0gMHgwKTsKICAgICAgICBhZGRyZXNzIGFkZHIgPSBQRUxPTWVtYmVySURNYXBbX2lkXTsKICAgICAgICByZXF1aXJlKFBFTE9NZW1iZXJNYXBbYWRkcl0uaWQgPiAwKTsKCiAgICAgICAgZGVsZXRlIFBFTE9NZW1iZXJNYXBbYWRkcl07CiAgICAgICAgZGVsZXRlIFBFTE9NZW1iZXJJRE1hcFtfaWRdOwogICAgICAgIAogICAgICAgIG51bU1lbWJlcnMtLTsKICAgICAgICBhc3NlcnQobnVtTWVtYmVycyA+PSAwKTsKICAgIH0KCiAgICBmdW5jdGlvbiBpbml0aWFsaXplVXNlcnMoKSBvbmx5TWFueU93bmVycyBwdWJsaWMgewogICAgICAgIGlmKCF1c2VySW5pdGlhbGl6ZWQpIHsKCiAgICAgICAgICAgIHVzZXJJbml0aWFsaXplZCA9IHRydWU7CiAgICAgICAgfQogICAgfQogICAgICAgICAgICAKICAgIGZ1bmN0aW9uIGluc2VydE5ld1VzZXIodWludDMyIF9pZCwgYnl0ZXMzMiBfbmlja25hbWUsIGFkZHJlc3MgX2V0aEFkZHIsIHVpbnQgX3BlbG9BbW91bnQsIHVpbnQgX3BlbG9Cb251cywgdWludCBfYml0RmxhZywgdWludDMyIF9leHBpcmUsIGJvb2wgZldpdGhUcmFuc2Zlcikgb25seU1hbnlPd25lcnMgcHVibGljIHsKCiAgICAgICAgUEVMT01lbWJlciBtZW1vcnkgZGF0YTsgCgogICAgICAgIHJlcXVpcmUoX2lkID4gMCk7CiAgICAgICAgcmVxdWlyZShQRUxPTWVtYmVyTWFwW19ldGhBZGRyXS5pZCA9PSAwKTsKICAgICAgICByZXF1aXJlKFBFTE9NZW1iZXJJRE1hcFtfaWRdID09IDB4MCk7CgogICAgICAgIGRhdGEuaWQgPSBfaWQ7CiAgICAgICAgZGF0YS5uaWNrbmFtZSA9IF9uaWNrbmFtZTsKICAgICAgICBkYXRhLmV0aEFkZHIgPSBfZXRoQWRkcjsKICAgICAgICBkYXRhLnBlbG9BbW91bnQgPSBfcGVsb0Ftb3VudDsKICAgICAgICBkYXRhLnBlbG9Cb251cyA9IF9wZWxvQm9udXM7CiAgICAgICAgZGF0YS5iaXRGbGFnID0gX2JpdEZsYWc7CiAgICAgICAgZGF0YS5leHBpcmUgPSBfZXhwaXJlOwoKICAgICAgICBQRUxPTWVtYmVyTWFwW19ldGhBZGRyXSA9IGRhdGE7CiAgICAgICAgUEVMT01lbWJlcklETWFwW19pZF0gPSBfZXRoQWRkcjsKICAgICAgICAKICAgICAgICBpZihmV2l0aFRyYW5zZmVyKSB7CiAgICAgICAgICAgIHJlcXVpcmUoX3BlbG9BbW91bnQgPiAwKTsKICAgICAgICAgICAgdWludDI1NiBhbW91bnQgPSAoX3BlbG9BbW91bnQgKyBfcGVsb0JvbnVzKSAqIDEwICoqIHVpbnQyNTYoZGVjaW1hbHMpOwogICAgICAgICAgICBfdHJhbnNmZXIobXNnLnNlbmRlciwgX2V0aEFkZHIsIGFtb3VudCk7CiAgICAgICAgICAgIAogICAgICAgICAgICBhc3NlcnQoYmFsYW5jZU9mW19ldGhBZGRyXSA9PSBhbW91bnQpOwogICAgICAgIH0KICAgICAgICBudW1NZW1iZXJzKys7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHVwZGF0ZVBlbG9FeHRlbnN0aW9uQ29udHJhY3QoUEVMT0V4dGVuc2lvbkludGVyZmFjZSBfcGVsb0V4dGVuc2lvbikgb25seU1hbnlPd25lcnMgcHVibGljIHsKICAgICAgICBwZWxvRXh0ZW5zdGlvbiA9IF9wZWxvRXh0ZW5zaW9uOwogICAgfQoKICAgIC8qIEludGVybmFsIHRyYW5zZmVyLCBvbmx5IGNhbiBiZSBjYWxsZWQgYnkgdGhpcyBjb250cmFjdCAqLwogICAgZnVuY3Rpb24gX3RyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgaW50ZXJuYWwgewogICAgICAgIHJlcXVpcmUgKF90byAhPSAweDApOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQcmV2ZW50IHRyYW5zZmVyIHRvIDB4MCBhZGRyZXNzLiBVc2UgYnVybigpIGluc3RlYWQKICAgICAgICByZXF1aXJlIChiYWxhbmNlT2ZbX2Zyb21dID49IF92YWx1ZSk7ICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBzZW5kZXIgaGFzIGVub3VnaAogICAgICAgIHJlcXVpcmUgKGJhbGFuY2VPZltfdG9dICsgX3ZhbHVlID4gYmFsYW5jZU9mW190b10pOyAvLyBDaGVjayBmb3Igb3ZlcmZsb3dzCiAgICAgICAgcmVxdWlyZSghZnJvemVuQWNjb3VudFtfZnJvbV0pOyAgICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHNlbmRlciBpcyBmcm96ZW4KICAgICAgICByZXF1aXJlKCFmcm96ZW5BY2NvdW50W190b10pOyAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgcmVjaXBpZW50IGlzIGZyb3plbgoKICAgICAgICAvLyBTYXZlIHRoaXMgZm9yIGFuIGFzc2VydGlvbiBpbiB0aGUgZnV0dXJlCiAgICAgICAgdWludCBwcmV2aW91c0JhbGFuY2VzID0gYmFsYW5jZU9mW19mcm9tXSArIGJhbGFuY2VPZltfdG9dOwoKICAgICAgICBpZihwZWxvRXh0ZW5zdGlvbiAhPSBQRUxPRXh0ZW5zaW9uSW50ZXJmYWNlKDB4MCkpCiAgICAgICAgICAgIHBlbG9FeHRlbnN0aW9uLk9wZXJhdGlvbigxLCBbYnl0ZXMzMihfZnJvbSksIGJ5dGVzMzIoX3RvKSwgYnl0ZXMzMihfdmFsdWUpLCBieXRlczMyKGJhbGFuY2VPZltfZnJvbV0pLCBieXRlczMyKGJhbGFuY2VPZltfdG9dKSwgYnl0ZXMzMigwKSwgYnl0ZXMzMigwKSwgYnl0ZXMzMigwKV0pOwogICAgICAgIAogICAgICAgIGJhbGFuY2VPZltfZnJvbV0gLT0gX3ZhbHVlOyAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTdWJ0cmFjdCBmcm9tIHRoZSBzZW5kZXIKICAgICAgICBiYWxhbmNlT2ZbX3RvXSArPSBfdmFsdWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHRoZSBzYW1lIHRvIHRoZSByZWNpcGllbnQKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwoKICAgICAgICAvLyBBc3NlcnRzIGFyZSB1c2VkIHRvIHVzZSBzdGF0aWMgYW5hbHlzaXMgdG8gZmluZCBidWdzIGluIHlvdXIgY29kZS4gVGhleSBzaG91bGQgbmV2ZXIgZmFpbAogICAgICAgIGFzc2VydChiYWxhbmNlT2ZbX2Zyb21dICsgYmFsYW5jZU9mW190b10gPT0gcHJldmlvdXNCYWxhbmNlcyk7CiAgICAgICAgCiAgICAgICAgaWYocGVsb0V4dGVuc3Rpb24gIT0gUEVMT0V4dGVuc2lvbkludGVyZmFjZSgweDApKQogICAgICAgICAgICBwZWxvRXh0ZW5zdGlvbi5PcGVyYXRpb24oMiwgW2J5dGVzMzIoX2Zyb20pLCBieXRlczMyKF90byksIGJ5dGVzMzIoX3ZhbHVlKSwgYnl0ZXMzMihiYWxhbmNlT2ZbX2Zyb21dKSwgYnl0ZXMzMihiYWxhbmNlT2ZbX3RvXSksIGJ5dGVzMzIoMCksIGJ5dGVzMzIoMCksIGJ5dGVzMzIoMCldKTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBDcmVhdGUgYG1pbnRlZEFtb3VudGAgdG9rZW5zIGFuZCBzZW5kIGl0IHRvIGB0YXJnZXRgCiAgICAvLy8gQHBhcmFtIHRhcmdldCBBZGRyZXNzIHRvIHJlY2VpdmUgdGhlIHRva2VucwogICAgLy8vIEBwYXJhbSBtaW50ZWRBbW91bnQgdGhlIGFtb3VudCBvZiB0b2tlbnMgaXQgd2lsbCByZWNlaXZlCiAgICBmdW5jdGlvbiBtaW50VG9rZW4oYWRkcmVzcyB0YXJnZXQsIHVpbnQyNTYgbWludGVkQW1vdW50KSBvbmx5TWFueU93bmVycyBwdWJsaWMgewogICAgICAgIGJhbGFuY2VPZlt0YXJnZXRdICs9IG1pbnRlZEFtb3VudDsKICAgICAgICB0b3RhbFN1cHBseSArPSBtaW50ZWRBbW91bnQ7CiAgICAgICAgVHJhbnNmZXIoMCwgdGhpcywgbWludGVkQW1vdW50KTsKICAgICAgICBUcmFuc2Zlcih0aGlzLCB0YXJnZXQsIG1pbnRlZEFtb3VudCk7CiAgICB9CgogICAgLy8vIEBub3RpY2UgYGZyZWV6ZT8gUHJldmVudCB8IEFsbG93YCBgdGFyZ2V0YCBmcm9tIHNlbmRpbmcgJiByZWNlaXZpbmcgdG9rZW5zCiAgICAvLy8gQHBhcmFtIHRhcmdldCBBZGRyZXNzIHRvIGJlIGZyb3plbgogICAgLy8vIEBwYXJhbSBmcmVlemUgZWl0aGVyIHRvIGZyZWV6ZSBpdCBvciBub3QKICAgIGZ1bmN0aW9uIGZyZWV6ZUFjY291bnQoYWRkcmVzcyB0YXJnZXQsIGJvb2wgZnJlZXplKSBvbmx5TWFueU93bmVycyBwdWJsaWMgewogICAgICAgIGZyb3plbkFjY291bnRbdGFyZ2V0XSA9IGZyZWV6ZTsKICAgICAgICBGcm96ZW5GdW5kcyh0YXJnZXQsIGZyZWV6ZSk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogVHJhbnNmZXIgdG9rZW5zIGZyb20gb3RoZXIgYWRkcmVzcyBmb3JjaWJseShmb3IgZGVhbGluZyB3aXRoIGlsbGVnYWwgdXNhZ2UsIGV0YykKICAgICAqCiAgICAgKiBTZW5kIGBfdmFsdWVgIHRva2VucyB0byBgX3RvYCBpbiBiZWhhbGYgb2YgYF9mcm9tYAogICAgICoKICAgICAqIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyCiAgICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQKICAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIGFtb3VudCB0byBzZW5kCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbUZvcmNpYmx5KGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgb25seU1hbnlPd25lcnMgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewoKICAgICAgICBpZihhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdID4gX3ZhbHVlKQogICAgICAgICAgICBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdIC09IF92YWx1ZTsKICAgICAgICBlbHNlIAogICAgICAgICAgICBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdID0gMDsKCiAgICAgICAgYXNzZXJ0KGFsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0gPj0gMCk7CgogICAgICAgIF90cmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgICAgIAogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFRyYW5zZmVyIGFsbCB0aGUgdG9rZW5zIGZyb20gb3RoZXIgYWRkcmVzcyBmb3JjaWJseShmb3IgZGVhbGluZyB3aXRoIGlsbGVnYWwgdXNhZ2UsIGV0YykKICAgICAqCiAgICAgKiBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3Mgb2YgdGhlIHNlbmRlcgogICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyQWxsRnJvbUZvcmNpYmx5KGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvKSBvbmx5TWFueU93bmVycyBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CgogICAgICAgIHVpbnQyNTYgX3ZhbHVlID0gYmFsYW5jZU9mW19mcm9tXTsKICAgICAgICByZXF1aXJlIChfdmFsdWUgPj0gMCk7CiAgICAgICAgcmV0dXJuIHRyYW5zZmVyRnJvbUZvcmNpYmx5KF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICB9ICAgICAKCiAgICAvLy8gQG5vdGljZSBBbGxvdyB1c2VycyB0byBidXkgdG9rZW5zIGZvciBgbmV3QnV5UHJpY2VgIGV0aCBhbmQgc2VsbCB0b2tlbnMgZm9yIGBuZXdTZWxsUHJpY2VgIGV0aAogICAgLy8vIEBwYXJhbSBuZXdTZWxsUHJpY2UgUHJpY2UgdGhlIHVzZXJzIGNhbiBzZWxsIHRvIHRoZSBjb250cmFjdAogICAgLy8vIEBwYXJhbSBuZXdCdXlQcmljZSBQcmljZSB1c2VycyBjYW4gYnV5IGZyb20gdGhlIGNvbnRyYWN0CiAgICBmdW5jdGlvbiBzZXRQcmljZXModWludDI1NiBuZXdTZWxsUHJpY2UsIHVpbnQyNTYgbmV3QnV5UHJpY2UpIG9ubHlNYW55T3duZXJzIHB1YmxpYyB7CiAgICAgICAgc2VsbFByaWNlID0gbmV3U2VsbFByaWNlOwogICAgICAgIGJ1eVByaWNlID0gbmV3QnV5UHJpY2U7CiAgICB9CgogICAgLy8vIEBub3RpY2UgQnV5IHRva2VucyBmcm9tIGNvbnRyYWN0IGJ5IHNlbmRpbmcgZXRoZXIKICAgIGZ1bmN0aW9uIGJ1eSgpIHBheWFibGUgcHVibGljIHsKICAgICAgICB1aW50IGFtb3VudCA9IG1zZy52YWx1ZSAvIGJ1eVByaWNlOyAgICAgICAgICAgICAgIC8vIGNhbGN1bGF0ZXMgdGhlIGFtb3VudAogICAgICAgIF90cmFuc2Zlcih0aGlzLCBtc2cuc2VuZGVyLCBhbW91bnQpOyAgICAgICAgICAgICAgLy8gbWFrZXMgdGhlIHRyYW5zZmVycwogICAgfQoKICAgIC8vLyBAbm90aWNlIFNlbGwgYGFtb3VudGAgdG9rZW5zIHRvIGNvbnRyYWN0CiAgICAvLy8gQHBhcmFtIGFtb3VudCBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNvbGQKICAgIGZ1bmN0aW9uIHNlbGwodWludDI1NiBhbW91bnQpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZSh0aGlzLmJhbGFuY2UgPj0gYW1vdW50ICogc2VsbFByaWNlKTsgICAgICAvLyBjaGVja3MgaWYgdGhlIGNvbnRyYWN0IGhhcyBlbm91Z2ggZXRoZXIgdG8gYnV5CiAgICAgICAgX3RyYW5zZmVyKG1zZy5zZW5kZXIsIHRoaXMsIGFtb3VudCk7ICAgICAgICAgICAgICAvLyBtYWtlcyB0aGUgdHJhbnNmZXJzCiAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihhbW91bnQgKiBzZWxsUHJpY2UpOyAgICAgICAgICAvLyBzZW5kcyBldGhlciB0byB0aGUgc2VsbGVyLiBJdCdzIGltcG9ydGFudCB0byBkbyB0aGlzIGxhc3QgdG8gYXZvaWQgcmVjdXJzaW9uIGF0dGFja3MKICAgIH0KfQ=='.
	

]
