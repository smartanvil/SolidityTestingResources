Class {
	#name : #SRT3b043d457f4270f52a99148fd104e0e9782759eb,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT3b043d457f4270f52a99148fd104e0e9782759eb >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTc7CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBBcHBsaWNhdGlvbiBFbnRpdHkgR2VuZXJpYyBDb250cmFjdAogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PHNwYW4gY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSJiMmRmZGJkMWQ5Y2JmMmRjZGRjNWRlZGJjNGQ3OWNjMGRkIj5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4KCiAgICBVc2VkIGZvciB0aGUgQUJJIGludGVyZmFjZSB3aGVuIGFzc2V0cyBuZWVkIHRvIGNhbGwgQXBwbGljYXRpb24gRW50aXR5LgoKICAgIFRoaXMgaXMgcmVxdWlyZWQsIG90aGVyd2lzZSB3ZSBlbmQgdXAgbG9hZGluZyB0aGUgYXNzZXRzIHRoZW1zZWx2ZXMgd2hlbiB3ZSBsb2FkIHRoZSBBcHBsaWNhdGlvbkVudGl0eSBjb250cmFjdAogICAgYW5kIGVuZCB1cCBpbiBhIGxvb3AKKi8KCgoKY29udHJhY3QgQXBwbGljYXRpb25FbnRpdHlBQkkgewoKICAgIGFkZHJlc3MgcHVibGljIFByb3Bvc2Fsc0VudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIEZ1bmRpbmdFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBNaWxlc3RvbmVzRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgTWVldGluZ3NFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBCb3VudHlNYW5hZ2VyRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgVG9rZW5NYW5hZ2VyRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgTGlzdGluZ0NvbnRyYWN0RW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgRnVuZGluZ01hbmFnZXJFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBOZXdzQ29udHJhY3RFbnRpdHk7CgogICAgYm9vbCBwdWJsaWMgX2luaXRpYWxpemVkID0gZmFsc2U7CiAgICBib29sIHB1YmxpYyBfbG9ja2VkID0gZmFsc2U7CiAgICB1aW50OCBwdWJsaWMgQ3VycmVudEVudGl0eVN0YXRlOwogICAgdWludDggcHVibGljIEFzc2V0Q29sbGVjdGlvbk51bTsKICAgIGFkZHJlc3MgcHVibGljIEdhdGV3YXlJbnRlcmZhY2VBZGRyZXNzOwogICAgYWRkcmVzcyBwdWJsaWMgZGVwbG95ZXJBZGRyZXNzOwogICAgYWRkcmVzcyB0ZXN0QWRkcmVzc0FsbG93VXBncmFkZUZyb207CiAgICBtYXBwaW5nIChieXRlczMyID0+IHVpbnQ4KSBwdWJsaWMgRW50aXR5U3RhdGVzOwogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiBhZGRyZXNzKSBwdWJsaWMgQXNzZXRDb2xsZWN0aW9uOwogICAgbWFwcGluZyAodWludDggPT4gYnl0ZXMzMikgcHVibGljIEFzc2V0Q29sbGVjdGlvbklkVG9OYW1lOwogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiB1aW50MjU2KSBwdWJsaWMgQnlsYXdzVWludDI1NjsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gYnl0ZXMzMikgcHVibGljIEJ5bGF3c0J5dGVzMzI7CgogICAgZnVuY3Rpb24gQXBwbGljYXRpb25FbnRpdHkoKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBnZXRFbnRpdHlTdGF0ZShieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGxpbmtUb0dhdGV3YXkoIGFkZHJlc3MgX0dhdGV3YXlJbnRlcmZhY2VBZGRyZXNzLCBieXRlczMyIF9zb3VyY2VDb2RlVXJsICkgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBzZXRVcGdyYWRlU3RhdGUodWludDggc3RhdGUpIHB1YmxpYyA7CiAgICBmdW5jdGlvbiBhZGRBc3NldFByb3Bvc2FscyhhZGRyZXNzIF9hc3NldEFkZHJlc3NlcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBhZGRBc3NldEZ1bmRpbmcoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYWRkQXNzZXRNaWxlc3RvbmVzKGFkZHJlc3MgX2Fzc2V0QWRkcmVzc2VzKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIGFkZEFzc2V0TWVldGluZ3MoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYWRkQXNzZXRCb3VudHlNYW5hZ2VyKGFkZHJlc3MgX2Fzc2V0QWRkcmVzc2VzKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIGFkZEFzc2V0VG9rZW5NYW5hZ2VyKGFkZHJlc3MgX2Fzc2V0QWRkcmVzc2VzKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIGFkZEFzc2V0RnVuZGluZ01hbmFnZXIoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYWRkQXNzZXRMaXN0aW5nQ29udHJhY3QoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYWRkQXNzZXROZXdzQ29udHJhY3QoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gZ2V0QXNzZXRBZGRyZXNzQnlOYW1lKGJ5dGVzMzIgX25hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3MpOwogICAgZnVuY3Rpb24gc2V0QnlsYXdVaW50MjU2KGJ5dGVzMzIgbmFtZSwgdWludDI1NiB2YWx1ZSkgcHVibGljOwogICAgZnVuY3Rpb24gZ2V0QnlsYXdVaW50MjU2KGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBzZXRCeWxhd0J5dGVzMzIoYnl0ZXMzMiBuYW1lLCBieXRlczMyIHZhbHVlKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBnZXRCeWxhd0J5dGVzMzIoYnl0ZXMzMiBuYW1lKSBwdWJsaWMgdmlldyByZXR1cm5zIChieXRlczMyKTsKICAgIGZ1bmN0aW9uIGluaXRpYWxpemUoKSBleHRlcm5hbCByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldFBhcmVudEFkZHJlc3MoKSBleHRlcm5hbCB2aWV3IHJldHVybnMoYWRkcmVzcyk7CiAgICBmdW5jdGlvbiBjcmVhdGVDb2RlVXBncmFkZVByb3Bvc2FsKCBhZGRyZXNzIF9uZXdBZGRyZXNzLCBieXRlczMyIF9zb3VyY2VDb2RlVXJsICkgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBhY2NlcHRDb2RlVXBncmFkZVByb3Bvc2FsKGFkZHJlc3MgX25ld0FkZHJlc3MpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gaW5pdGlhbGl6ZUFzc2V0c1RvVGhpc0FwcGxpY2F0aW9uKCkgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckFzc2V0c1RvTmV3QXBwbGljYXRpb24oYWRkcmVzcyBfbmV3QWRkcmVzcykgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBsb2NrKCkgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBjYW5Jbml0aWF0ZUNvZGVVcGdyYWRlKGFkZHJlc3MgX3NlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyhib29sKTsKICAgIGZ1bmN0aW9uIGRvU3RhdGVDaGFuZ2VzKCkgcHVibGljOwogICAgZnVuY3Rpb24gaGFzUmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGFueUFzc2V0SGFzQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZXh0ZW5kZWRBbnlBc3NldEhhc0NoYW5nZXMoKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0UmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCwgdWludDgpOwogICAgZnVuY3Rpb24gZ2V0VGltZXN0YW1wKCkgdmlldyBwdWJsaWMgcmV0dXJucyAodWludDI1Nik7Cgp9CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBUb2tlbiBDb250cmFjdAogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PHNwYW4gY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSI1MTNjMzgzMjNhMjgxMTNmM2UyNjNkMzgyNzM0N2YyMzNlIj5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4KCiBaZXBwZWxpbiBFUkMyMCBTdGFuZGFyZCBUb2tlbgoKKi8KCgoKY29udHJhY3QgQUJJVG9rZW4gewoKICAgIHN0cmluZyBwdWJsaWMgIHN5bWJvbDsKICAgIHN0cmluZyBwdWJsaWMgIG5hbWU7CiAgICB1aW50OCBwdWJsaWMgICBkZWNpbWFsczsKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogICAgc3RyaW5nIHB1YmxpYyAgdmVyc2lvbjsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGJhbGFuY2VzOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwogICAgYWRkcmVzcyBwdWJsaWMgbWFuYWdlcjsKICAgIGFkZHJlc3MgcHVibGljIGRlcGxveWVyOwogICAgYm9vbCBwdWJsaWMgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CiAgICBib29sIHB1YmxpYyBpbml0aWFsaXplZCA9IGZhbHNlOwoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZyk7CiAgICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBmaW5pc2hNaW50aW5nKCkgcHVibGljIHJldHVybnMgKGJvb2wpOwoKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgaW5kZXhlZCB2YWx1ZSk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IGluZGV4ZWQgdmFsdWUpOwogICAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKICAgIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwp9CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBBcHBsaWNhdGlvbiBBc3NldCBDb250cmFjdCBBQkkKICogQHBhY2thZ2UgICAgIEJsb2NrQml0c0lPCiAqIEBhdXRob3IgICAgICBNaWNreSBTb2NhY2kgPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iOTRmOWZkZjdmZmVkZDRmYWZiZTNmOGZkZTJmMWJhZTZmYiI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+CgogQW55IGNvbnRyYWN0IGluaGVyaXRpbmcgdGhpcyB3aWxsIGJlIHVzYWJsZSBhcyBhbiBBc3NldCBpbiB0aGUgQXBwbGljYXRpb24gRW50aXR5CgoqLwoKCgpjb250cmFjdCBBQklBcHBsaWNhdGlvbkFzc2V0IHsKCiAgICBieXRlczMyIHB1YmxpYyBhc3NldE5hbWU7CiAgICB1aW50OCBwdWJsaWMgQ3VycmVudEVudGl0eVN0YXRlOwogICAgdWludDggcHVibGljIFJlY29yZE51bTsKICAgIGJvb2wgcHVibGljIF9pbml0aWFsaXplZDsKICAgIGJvb2wgcHVibGljIF9zZXR0aW5nc0FwcGxpZWQ7CiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKICAgIGFkZHJlc3MgcHVibGljIGRlcGxveWVyQWRkcmVzczsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludDgpIHB1YmxpYyBFbnRpdHlTdGF0ZXM7CiAgICBtYXBwaW5nIChieXRlczMyID0+IHVpbnQ4KSBwdWJsaWMgUmVjb3JkU3RhdGVzOwoKICAgIGZ1bmN0aW9uIHNldEluaXRpYWxBcHBsaWNhdGlvbkFkZHJlc3MoYWRkcmVzcyBfb3duZXJBZGRyZXNzKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBzZXRJbml0aWFsT3duZXJBbmROYW1lKGJ5dGVzMzIgX25hbWUpIGV4dGVybmFsIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0UmVjb3JkU3RhdGUoYnl0ZXMzMiBuYW1lKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCk7CiAgICBmdW5jdGlvbiBnZXRFbnRpdHlTdGF0ZShieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGFwcGx5QW5kTG9ja1NldHRpbmdzKCkgcHVibGljIHJldHVybnMoYm9vbCk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlclRvTmV3T3duZXIoYWRkcmVzcyBfbmV3T3duZXIpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldEFwcGxpY2F0aW9uQXNzZXRBZGRyZXNzQnlOYW1lKGJ5dGVzMzIgX25hbWUpIHB1YmxpYyByZXR1cm5zKGFkZHJlc3MpOwogICAgZnVuY3Rpb24gZ2V0QXBwbGljYXRpb25TdGF0ZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGdldEFwcGxpY2F0aW9uRW50aXR5U3RhdGUoYnl0ZXMzMiBuYW1lKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCk7CiAgICBmdW5jdGlvbiBnZXRBcHBCeWxhd1VpbnQyNTYoYnl0ZXMzMiBuYW1lKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGdldEFwcEJ5bGF3Qnl0ZXMzMihieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJ5dGVzMzIpOwogICAgZnVuY3Rpb24gZ2V0VGltZXN0YW1wKCkgdmlldyBwdWJsaWMgcmV0dXJucyAodWludDI1Nik7CgoKfQoKLyoKCiAqIHNvdXJjZSAgICAgICBodHRwczovL2dpdGh1Yi5jb20vYmxvY2tiaXRzaW8vCgogKiBAbmFtZSAgICAgICAgRnVuZGluZyBDb250cmFjdCBBQkkKICogQHBhY2thZ2UgICAgIEJsb2NrQml0c0lPCiAqIEBhdXRob3IgICAgICBNaWNreSBTb2NhY2kgPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iOGJlNmUyZThlMGYyY2JlNWU0ZmNlN2UyZmRlZWE1ZjllNCI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+CgogQ29udGFpbnMgdGhlIEZ1bmRpbmcgQ29udHJhY3QgY29kZSBkZXBsb3llZCBhbmQgbGlua2VkIHRvIHRoZSBBcHBsaWNhdGlvbiBFbnRpdHkKCgogICAgISEhIExpbmtzIGRpcmVjdGx5IHRvIE1pbGVzdG9uZXMKCiovCgoKCgoKY29udHJhY3QgQUJJRnVuZGluZyBpcyBBQklBcHBsaWNhdGlvbkFzc2V0IHsKCiAgICBhZGRyZXNzIHB1YmxpYyBtdWx0aVNpZ091dHB1dEFkZHJlc3M7CiAgICBhZGRyZXNzIHB1YmxpYyBEaXJlY3RJbnB1dDsKICAgIGFkZHJlc3MgcHVibGljIE1pbGVzdG9uZUlucHV0OwogICAgYWRkcmVzcyBwdWJsaWMgVG9rZW5NYW5hZ2VyRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgRnVuZGluZ01hbmFnZXJFbnRpdHk7CgogICAgc3RydWN0IEZ1bmRpbmdTdGFnZSB7CiAgICAgICAgYnl0ZXMzMiBuYW1lOwogICAgICAgIHVpbnQ4ICAgc3RhdGU7CiAgICAgICAgdWludDI1NiB0aW1lX3N0YXJ0OwogICAgICAgIHVpbnQyNTYgdGltZV9lbmQ7CiAgICAgICAgdWludDI1NiBhbW91bnRfY2FwX3NvZnQ7ICAgICAgICAgICAgLy8gMCA9IG5vdCBlbmZvcmNlZAogICAgICAgIHVpbnQyNTYgYW1vdW50X2NhcF9oYXJkOyAgICAgICAgICAgIC8vIDAgPSBub3QgZW5mb3JjZWQKICAgICAgICB1aW50MjU2IGFtb3VudF9yYWlzZWQ7ICAgICAgICAgICAgICAvLyAwID0gbm90IGVuZm9yY2VkCiAgICAgICAgLy8gZnVuZGluZyBtZXRob2Qgc2V0dGluZ3MKICAgICAgICB1aW50MjU2IG1pbmltdW1fZW50cnk7CiAgICAgICAgdWludDggICBtZXRob2RzOyAgICAgICAgICAgICAgICAgICAgLy8gRnVuZGluZ01ldGhvZElkcwogICAgICAgIC8vIHRva2VuIHNldHRpbmdzCiAgICAgICAgdWludDI1NiBmaXhlZF90b2tlbnM7CiAgICAgICAgdWludDggICBwcmljZV9hZGRpdGlvbl9wZXJjZW50YWdlOyAgLy8KICAgICAgICB1aW50OCAgIHRva2VuX3NoYXJlX3BlcmNlbnRhZ2U7CiAgICAgICAgdWludDggICBpbmRleDsKICAgIH0KCiAgICBtYXBwaW5nICh1aW50OCA9PiBGdW5kaW5nU3RhZ2UpIHB1YmxpYyBDb2xsZWN0aW9uOwogICAgdWludDggcHVibGljIEZ1bmRpbmdTdGFnZU51bTsKICAgIHVpbnQ4IHB1YmxpYyBjdXJyZW50RnVuZGluZ1N0YWdlOwogICAgdWludDI1NiBwdWJsaWMgQW1vdW50UmFpc2VkOwogICAgdWludDI1NiBwdWJsaWMgTWlsZXN0b25lQW1vdW50UmFpc2VkOwogICAgdWludDI1NiBwdWJsaWMgR2xvYmFsQW1vdW50Q2FwU29mdDsKICAgIHVpbnQyNTYgcHVibGljIEdsb2JhbEFtb3VudENhcEhhcmQ7CiAgICB1aW50OCBwdWJsaWMgVG9rZW5TZWxsUGVyY2VudGFnZTsKICAgIHVpbnQyNTYgcHVibGljIEZ1bmRpbmdfU2V0dGluZ19mdW5kaW5nX3RpbWVfc3RhcnQ7CiAgICB1aW50MjU2IHB1YmxpYyBGdW5kaW5nX1NldHRpbmdfZnVuZGluZ190aW1lX2VuZDsKICAgIHVpbnQyNTYgcHVibGljIEZ1bmRpbmdfU2V0dGluZ19jYXNoYmFja190aW1lX3N0YXJ0OwogICAgdWludDI1NiBwdWJsaWMgRnVuZGluZ19TZXR0aW5nX2Nhc2hiYWNrX3RpbWVfZW5kOwogICAgdWludDI1NiBwdWJsaWMgRnVuZGluZ19TZXR0aW5nX2Nhc2hiYWNrX2JlZm9yZV9zdGFydF93YWl0X2R1cmF0aW9uOwogICAgdWludDI1NiBwdWJsaWMgRnVuZGluZ19TZXR0aW5nX2Nhc2hiYWNrX2R1cmF0aW9uOwoKCiAgICBmdW5jdGlvbiBhZGRGdW5kaW5nU3RhZ2UoCiAgICAgICAgYnl0ZXMzMiBfbmFtZSwKICAgICAgICB1aW50MjU2IF90aW1lX3N0YXJ0LAogICAgICAgIHVpbnQyNTYgX3RpbWVfZW5kLAogICAgICAgIHVpbnQyNTYgX2Ftb3VudF9jYXBfc29mdCwKICAgICAgICB1aW50MjU2IF9hbW91bnRfY2FwX2hhcmQsICAgLy8gcmVxdWlyZWQgPiAwCiAgICAgICAgdWludDggICBfbWV0aG9kcywKICAgICAgICB1aW50MjU2IF9taW5pbXVtX2VudHJ5LAogICAgICAgIHVpbnQyNTYgX2ZpeGVkX3Rva2VucywKICAgICAgICB1aW50OCAgIF9wcmljZV9hZGRpdGlvbl9wZXJjZW50YWdlLAogICAgICAgIHVpbnQ4ICAgX3Rva2VuX3NoYXJlX3BlcmNlbnRhZ2UKICAgICkKICAgIHB1YmxpYzsKCiAgICBmdW5jdGlvbiBhZGRTZXR0aW5ncyhhZGRyZXNzIF9vdXRwdXRBZGRyZXNzLCB1aW50MjU2IHNvZnRfY2FwLCB1aW50MjU2IGhhcmRfY2FwLCB1aW50OCBzYWxlX3BlcmNlbnRhZ2UsIGFkZHJlc3MgX2RpcmVjdCwgYWRkcmVzcyBfbWlsZXN0b25lICkgcHVibGljOwogICAgZnVuY3Rpb24gZ2V0U3RhZ2VBbW91bnQodWludDggU3RhZ2VJZCkgcHVibGljIHZpZXcgcmV0dXJucyAoIHVpbnQyNTYgKTsKICAgIGZ1bmN0aW9uIGFsbG93ZWRQYXltZW50TWV0aG9kKHVpbnQ4IF9wYXltZW50X21ldGhvZCkgcHVibGljIHB1cmUgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiByZWNlaXZlUGF5bWVudChhZGRyZXNzIF9zZW5kZXIsIHVpbnQ4IF9wYXltZW50X21ldGhvZCkgcGF5YWJsZSBwdWJsaWMgcmV0dXJucyhib29sKTsKICAgIGZ1bmN0aW9uIGNhbkFjY2VwdFBheW1lbnQodWludDI1NiBfYW1vdW50KSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldFZhbHVlT3ZlckN1cnJlbnRDYXAodWludDI1NiBfYW1vdW50KSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGlzRnVuZGluZ1N0YWdlVXBkYXRlQWxsb3dlZCh1aW50OCBfbmV3X3N0YXRlICkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRSZWNvcmRTdGF0ZVJlcXVpcmVkQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGRvU3RhdGVDaGFuZ2VzKCkgcHVibGljOwogICAgZnVuY3Rpb24gaGFzUmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldFJlcXVpcmVkU3RhdGVDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgsIHVpbnQ4LCB1aW50OCk7Cgp9CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBNaWxlc3RvbmVzIENvbnRyYWN0CiAqIEBwYWNrYWdlICAgICBCbG9ja0JpdHNJTwogKiBAYXV0aG9yICAgICAgTWlja3kgU29jYWNpIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjY1MDgwYzA2MGUxYzI1MGIwYTEyMDkwYzEzMDA0YjE3MGEiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+PgoKIENvbnRhaW5zIHRoZSBNaWxlc3RvbmVzIENvbnRyYWN0IGNvZGUgZGVwbG95ZWQgYW5kIGxpbmtlZCB0byB0aGUgQXBwbGljYXRpb24gRW50aXR5CgoqLwoKCgoKCmNvbnRyYWN0IEFCSU1pbGVzdG9uZXMgaXMgQUJJQXBwbGljYXRpb25Bc3NldCB7CgogICAgc3RydWN0IFJlY29yZCB7CiAgICAgICAgYnl0ZXMzMiBuYW1lOwogICAgICAgIHN0cmluZyBkZXNjcmlwdGlvbjsgICAgICAgICAgICAgICAgICAgICAvLyB3aWxsIGNoYW5nZSB0byBoYXNoIHBvaW50ZXIgKCBleHRlcm5hbCBzdG9yYWdlICkKICAgICAgICB1aW50OCBzdGF0ZTsKICAgICAgICB1aW50MjU2IGR1cmF0aW9uOwogICAgICAgIHVpbnQyNTYgdGltZV9zdGFydDsgICAgICAgICAgICAgICAgICAgICAvLyBzdGFydCBhdCB1bml4dGltZXN0YW1wCiAgICAgICAgdWludDI1NiBsYXN0X3N0YXRlX2NoYW5nZV90aW1lOyAgICAgICAgIC8vIHRpbWUgb2YgbGFzdCBzdGF0ZSBjaGFuZ2UKICAgICAgICB1aW50MjU2IHRpbWVfZW5kOyAgICAgICAgICAgICAgICAgICAgICAgLy8gZXN0aW1hdGVkIGVuZCB0aW1lID4+IGNhbiBiZSBpbmNyZWFzZWQgYnkgcHJvcG9zYWwKICAgICAgICB1aW50MjU2IHRpbWVfZW5kZWQ7ICAgICAgICAgICAgICAgICAgICAgLy8gYWN0dWFsIGVuZCB0aW1lCiAgICAgICAgdWludDI1NiBtZWV0aW5nX3RpbWU7CiAgICAgICAgdWludDggZnVuZGluZ19wZXJjZW50YWdlOwogICAgICAgIHVpbnQ4IGluZGV4OwogICAgfQoKICAgIHVpbnQ4IHB1YmxpYyBjdXJyZW50UmVjb3JkOwogICAgdWludDI1NiBwdWJsaWMgTWlsZXN0b25lQ2FzaEJhY2tUaW1lID0gMDsKICAgIG1hcHBpbmcgKHVpbnQ4ID0+IFJlY29yZCkgcHVibGljIENvbGxlY3Rpb247CiAgICBtYXBwaW5nIChieXRlczMyID0+IGJvb2wpIHB1YmxpYyBNaWxlc3RvbmVQb3N0cG9uaW5nSGFzaDsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludDI1NikgcHVibGljIFByb3Bvc2FsSWRCeUhhc2g7CgogICAgZnVuY3Rpb24gZ2V0QnlsYXdzUHJvamVjdERldmVsb3BtZW50U3RhcnQoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGdldEJ5bGF3c01pblRpbWVJblRoZUZ1dHVyZUZvck1lZXRpbmdDcmVhdGlvbigpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gZ2V0QnlsYXdzQ2FzaEJhY2tWb3RlUmVqZWN0ZWREdXJhdGlvbigpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gYWRkUmVjb3JkKCBieXRlczMyIF9uYW1lLCBzdHJpbmcgX2Rlc2NyaXB0aW9uLCB1aW50MjU2IF9kdXJhdGlvbiwgdWludDggX3BlcmMgKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBnZXRNaWxlc3RvbmVGdW5kaW5nUGVyY2VudGFnZSh1aW50OCByZWNvcmRJZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gZG9TdGF0ZUNoYW5nZXMoKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBnZXRSZWNvcmRTdGF0ZVJlcXVpcmVkQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGhhc1JlcXVpcmVkU3RhdGVDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBhZnRlclZvdGVOb0Nhc2hCYWNrVGltZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKCBib29sICk7CiAgICBmdW5jdGlvbiBnZXRIYXNoKHVpbnQ4IGFjdGlvblR5cGUsIGJ5dGVzMzIgYXJnMSwgYnl0ZXMzMiBhcmcyKSBwdWJsaWMgcHVyZSByZXR1cm5zICggYnl0ZXMzMiApOwogICAgZnVuY3Rpb24gZ2V0Q3VycmVudEhhc2goKSBwdWJsaWMgdmlldyByZXR1cm5zICggYnl0ZXMzMiApOwogICAgZnVuY3Rpb24gZ2V0Q3VycmVudFByb3Bvc2FsSWQoKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKCB1aW50MjU2ICk7CiAgICBmdW5jdGlvbiBzZXRDdXJyZW50TWlsZXN0b25lTWVldGluZ1RpbWUodWludDI1NiBfbWVldGluZ190aW1lKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBpc1JlY29yZFVwZGF0ZUFsbG93ZWQodWludDggX25ld19zdGF0ZSApIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0UmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCwgdWludDgsIHVpbnQ4KTsKICAgIGZ1bmN0aW9uIEFwcGxpY2F0aW9uSXNJbkRldmVsb3BtZW50KCkgcHVibGljIHZpZXcgcmV0dXJucyhib29sKTsKICAgIGZ1bmN0aW9uIE1lZXRpbmdUaW1lU2V0RmFpbHVyZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwoKfQoKLyoKCiAqIHNvdXJjZSAgICAgICBodHRwczovL2dpdGh1Yi5jb20vYmxvY2tiaXRzaW8vCgogKiBAbmFtZSAgICAgICAgUHJvcG9zYWxzIENvbnRyYWN0CiAqIEBwYWNrYWdlICAgICBCbG9ja0JpdHNJTwogKiBAYXV0aG9yICAgICAgTWlja3kgU29jYWNpIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjA1Njg2YzY2NmU3YzQ1NmI2YTcyNjk2YzczNjAyYjc3NmEiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+PgoKIENvbnRhaW5zIHRoZSBQcm9wb3NhbHMgQ29udHJhY3QgY29kZSBkZXBsb3llZCBhbmQgbGlua2VkIHRvIHRoZSBBcHBsaWNhdGlvbiBFbnRpdHkKCiovCgoKCgoKY29udHJhY3QgQUJJUHJvcG9zYWxzIGlzIEFCSUFwcGxpY2F0aW9uQXNzZXQgewoKICAgIGFkZHJlc3MgcHVibGljIEFwcGxpY2F0aW9uOwogICAgYWRkcmVzcyBwdWJsaWMgTGlzdGluZ0NvbnRyYWN0RW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgRnVuZGluZ0VudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIEZ1bmRpbmdNYW5hZ2VyRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgVG9rZW5NYW5hZ2VyRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgVG9rZW5FbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBNaWxlc3RvbmVzRW50aXR5OwoKICAgIHN0cnVjdCBQcm9wb3NhbFJlY29yZCB7CiAgICAgICAgYWRkcmVzcyBjcmVhdG9yOwogICAgICAgIGJ5dGVzMzIgbmFtZTsKICAgICAgICB1aW50OCBhY3Rpb25UeXBlOwogICAgICAgIHVpbnQ4IHN0YXRlOwogICAgICAgIGJ5dGVzMzIgaGFzaDsgICAgICAgICAgICAgICAgICAgICAgIC8vIGFjdGlvbiBuYW1lICsgYXJncyBoYXNoCiAgICAgICAgYWRkcmVzcyBhZGRyOwogICAgICAgIGJ5dGVzMzIgc291cmNlQ29kZVVybDsKICAgICAgICB1aW50MjU2IGV4dHJhOwogICAgICAgIHVpbnQyNTYgdGltZV9zdGFydDsKICAgICAgICB1aW50MjU2IHRpbWVfZW5kOwogICAgICAgIHVpbnQyNTYgaW5kZXg7CiAgICB9CgogICAgc3RydWN0IFZvdGVTdHJ1Y3QgewogICAgICAgIGFkZHJlc3Mgdm90ZXI7CiAgICAgICAgdWludDI1NiB0aW1lOwogICAgICAgIGJvb2wgICAgdm90ZTsKICAgICAgICB1aW50MjU2IHBvd2VyOwogICAgICAgIGJvb2wgICAgYW5udWxsZWQ7CiAgICAgICAgdWludDI1NiBpbmRleDsKICAgIH0KCiAgICBzdHJ1Y3QgUmVzdWx0UmVjb3JkIHsKICAgICAgICB1aW50MjU2IHRvdGFsQXZhaWxhYmxlOwogICAgICAgIHVpbnQyNTYgcmVxdWlyZWRGb3JSZXN1bHQ7CiAgICAgICAgdWludDI1NiB0b3RhbFNvRmFyOwogICAgICAgIHVpbnQyNTYgeWVzOwogICAgICAgIHVpbnQyNTYgbm87CiAgICAgICAgYm9vbCAgICByZXF1aXJlc0NvdW50aW5nOwogICAgfQoKICAgIHVpbnQ4IHB1YmxpYyBBY3RpdmVQcm9wb3NhbE51bTsKICAgIHVpbnQyNTYgcHVibGljIFZvdGVDb3VudFBlclByb2Nlc3M7CiAgICBib29sIHB1YmxpYyBFbWVyZ2VuY3lGdW5kaW5nUmVsZWFzZUFwcHJvdmVkOwoKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludDgpIHB1YmxpYyBBY3Rpb25UeXBlczsKICAgIG1hcHBpbmcgKHVpbnQ4ID0+IHVpbnQyNTYpIHB1YmxpYyBBY3RpdmVQcm9wb3NhbElkczsKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gYm9vbCkgcHVibGljIEV4cGlyZWRQcm9wb3NhbElkczsKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gUHJvcG9zYWxSZWNvcmQpIHB1YmxpYyBQcm9wb3NhbHNCeUlkOwogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiB1aW50MjU2KSBwdWJsaWMgUHJvcG9zYWxJZEJ5SGFzaDsKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gbWFwcGluZyAodWludDI1NiA9PiBWb3RlU3RydWN0KSApIHB1YmxpYyBWb3Rlc0J5UHJvcG9zYWxJZDsKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiBWb3RlU3RydWN0KSApIHB1YmxpYyBWb3Rlc0J5Q2FzdGVyOwogICAgbWFwcGluZyAodWludDI1NiA9PiB1aW50MjU2KSBwdWJsaWMgVm90ZXNOdW1CeVByb3Bvc2FsSWQ7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IFJlc3VsdFJlY29yZCApIHB1YmxpYyBSZXN1bHRzQnlQcm9wb3NhbElkOwogICAgbWFwcGluZyAodWludDI1NiA9PiB1aW50MjU2KSBwdWJsaWMgbGFzdFByb2Nlc3NlZFZvdGVJZEJ5UHJvcG9zYWw7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IHVpbnQyNTYpIHB1YmxpYyBQcm9jZXNzZWRWb3Rlc0J5UHJvcG9zYWw7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IHVpbnQyNTYpIHB1YmxpYyBWb3RlQ291bnRBdFByb2Nlc3NpbmdTdGFydEJ5UHJvcG9zYWw7CgogICAgZnVuY3Rpb24gZ2V0UmVjb3JkU3RhdGUoYnl0ZXMzMiBuYW1lKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCk7CiAgICBmdW5jdGlvbiBnZXRBY3Rpb25UeXBlKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gZ2V0UHJvcG9zYWxTdGF0ZSh1aW50MjU2IF9wcm9wb3NhbElkKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCk7CiAgICBmdW5jdGlvbiBnZXRCeWxhd3NQcm9wb3NhbFZvdGluZ0R1cmF0aW9uKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBnZXRCeWxhd3NNaWxlc3RvbmVNaW5Qb3N0cG9uaW5nKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBnZXRCeWxhd3NNaWxlc3RvbmVNYXhQb3N0cG9uaW5nKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBnZXRIYXNoKHVpbnQ4IGFjdGlvblR5cGUsIGJ5dGVzMzIgYXJnMSwgYnl0ZXMzMiBhcmcyKSBwdWJsaWMgcHVyZSByZXR1cm5zICggYnl0ZXMzMiApOwogICAgZnVuY3Rpb24gcHJvY2VzcygpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGhhc1JlcXVpcmVkU3RhdGVDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRSZXF1aXJlZFN0YXRlQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGFkZENvZGVVcGdyYWRlUHJvcG9zYWwoYWRkcmVzcyBfYWRkciwgYnl0ZXMzMiBfc291cmNlQ29kZVVybCkgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBjcmVhdGVNaWxlc3RvbmVBY2NlcHRhbmNlUHJvcG9zYWwoKSBleHRlcm5hbCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGNyZWF0ZU1pbGVzdG9uZVBvc3Rwb25pbmdQcm9wb3NhbCh1aW50MjU2IF9kdXJhdGlvbikgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBnZXRDdXJyZW50TWlsZXN0b25lUG9zdHBvbmluZ1Byb3Bvc2FsRHVyYXRpb24oKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRNaWxlc3RvbmVQcm9wb3NhbFN0YXR1c0ZvclR5cGUodWludDggX2FjdGlvblR5cGUgKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCk7CiAgICBmdW5jdGlvbiBjcmVhdGVFbWVyZ2VuY3lGdW5kUmVsZWFzZVByb3Bvc2FsKCkgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBjcmVhdGVEZWxpc3RpbmdQcm9wb3NhbCh1aW50MjU2IF9wcm9qZWN0SWQpIGV4dGVybmFsIHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gUmVnaXN0ZXJWb3RlKHVpbnQyNTYgX3Byb3Bvc2FsSWQsIGJvb2wgX215Vm90ZSkgcHVibGljOwogICAgZnVuY3Rpb24gaGFzUHJldmlvdXNWb3RlKHVpbnQyNTYgX3Byb3Bvc2FsSWQsIGFkZHJlc3MgX3ZvdGVyKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldFRvdGFsVG9rZW5Wb3RpbmdQb3dlcihhZGRyZXNzIF92b3RlcikgcHVibGljIHZpZXcgcmV0dXJucyAoIHVpbnQyNTYgKTsKICAgIGZ1bmN0aW9uIGdldFZvdGluZ1Bvd2VyKHVpbnQyNTYgX3Byb3Bvc2FsSWQsIGFkZHJlc3MgX3ZvdGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICggdWludDI1NiApOwogICAgZnVuY3Rpb24gc2V0Vm90ZUNvdW50UGVyUHJvY2Vzcyh1aW50MjU2IF9wZXJQcm9jZXNzKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIFByb2Nlc3NWb3RlVG90YWxzKHVpbnQyNTYgX3Byb3Bvc2FsSWQsIHVpbnQyNTYgbGVuZ3RoKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBjYW5FbmRWb3RpbmcodWludDI1NiBfcHJvcG9zYWxJZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRQcm9wb3NhbFR5cGUodWludDI1NiBfcHJvcG9zYWxJZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gZXhwaXJ5Q2hhbmdlc1N0YXRlKHVpbnQyNTYgX3Byb3Bvc2FsSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gbmVlZHNQcm9jZXNzaW5nKHVpbnQyNTYgX3Byb3Bvc2FsSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0TXlWb3RlRm9yQ3VycmVudE1pbGVzdG9uZVJlbGVhc2UoYWRkcmVzcyBfdm90ZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0SGFzVm90ZUZvckN1cnJlbnRNaWxlc3RvbmVSZWxlYXNlKGFkZHJlc3MgX3ZvdGVyKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldE15Vm90ZSh1aW50MjU2IF9wcm9wb3NhbElkLCBhZGRyZXNzIF92b3RlcikgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7Cgp9CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBUb2tlbiBNYW5hZ2VyIENvbnRyYWN0CiAqIEBwYWNrYWdlICAgICBCbG9ja0JpdHNJTwogKiBAYXV0aG9yICAgICAgTWlja3kgU29jYWNpIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjNlNTM1NzVkNTU0NzdlNTA1MTQ5NTI1NzQ4NWIxMDRjNTEiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+PgoKKi8KCgoKCgpjb250cmFjdCBBQklUb2tlbk1hbmFnZXIgaXMgQUJJQXBwbGljYXRpb25Bc3NldCB7CgogICAgYWRkcmVzcyBwdWJsaWMgVG9rZW5TQ0FEQUVudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIFRva2VuRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgTWFya2V0aW5nTWV0aG9kQWRkcmVzczsKICAgIGJvb2wgT3duZXJUb2tlbkJhbGFuY2VzUmVsZWFzZWQgPSBmYWxzZTsKCiAgICBmdW5jdGlvbiBhZGRTZXR0aW5ncyhhZGRyZXNzIF9zY2FkYUFkZHJlc3MsIGFkZHJlc3MgX3Rva2VuQWRkcmVzcywgYWRkcmVzcyBfbWFya2V0aW5nICkgcHVibGljOwogICAgZnVuY3Rpb24gZ2V0VG9rZW5TQ0FEQVJlcXVpcmVzSGFyZENhcCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBmaW5pc2hNaW50aW5nKCkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gbWludEZvck1hcmtldGluZ1Bvb2woYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBSZWxlYXNlT3duZXJzTG9ja2VkVG9rZW5zKGFkZHJlc3MgX211bHRpU2lnT3V0cHV0QWRkcmVzcykgcHVibGljIHJldHVybnMgKGJvb2wpOwoKfQoKLyoKCiAqIHNvdXJjZSAgICAgICBodHRwczovL2dpdGh1Yi5jb20vYmxvY2tiaXRzaW8vCgogKiBAbmFtZSAgICAgICAgRnVuZGluZyBDb250cmFjdCBBQkkKICogQHBhY2thZ2UgICAgIEJsb2NrQml0c0lPCiAqIEBhdXRob3IgICAgICBNaWNreSBTb2NhY2kgPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iOWRmMGY0ZmVmNmU0ZGRmM2YyZWFmMWY0ZWJmOGIzZWZmMiI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+CgogQ29udGFpbnMgdGhlIEZ1bmRpbmcgQ29udHJhY3QgY29kZSBkZXBsb3llZCBhbmQgbGlua2VkIHRvIHRoZSBBcHBsaWNhdGlvbiBFbnRpdHkKCiovCgoKCgoKY29udHJhY3QgQUJJRnVuZGluZ01hbmFnZXIgaXMgQUJJQXBwbGljYXRpb25Bc3NldCB7CgogICAgYm9vbCBwdWJsaWMgZnVuZGluZ1Byb2Nlc3NlZDsKICAgIGJvb2wgRnVuZGluZ1Bvb2xCYWxhbmNlc0FsbG9jYXRlZDsKICAgIHVpbnQ4IHB1YmxpYyBWYXVsdENvdW50UGVyUHJvY2VzczsKICAgIHVpbnQyNTYgcHVibGljIGxhc3RQcm9jZXNzZWRWYXVsdElkOwogICAgdWludDI1NiBwdWJsaWMgdmF1bHROdW07CiAgICB1aW50MjU2IHB1YmxpYyBMb2NrZWRWb3RpbmdUb2tlbnM7CiAgICBieXRlczMyIHB1YmxpYyBjdXJyZW50VGFzazsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gYm9vbCkgcHVibGljIHRhc2tCeUhhc2g7CiAgICBtYXBwaW5nICAoYWRkcmVzcyA9PiBhZGRyZXNzKSBwdWJsaWMgdmF1bHRMaXN0OwogICAgbWFwcGluZyAgKHVpbnQyNTYgPT4gYWRkcmVzcykgcHVibGljIHZhdWx0QnlJZDsKCiAgICBmdW5jdGlvbiByZWNlaXZlUGF5bWVudChhZGRyZXNzIF9zZW5kZXIsIHVpbnQ4IF9wYXltZW50X21ldGhvZCwgdWludDggX2Z1bmRpbmdfc3RhZ2UpIHBheWFibGUgcHVibGljIHJldHVybnMoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRNeVZhdWx0QWRkcmVzcyhhZGRyZXNzIF9zZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3MpOwogICAgZnVuY3Rpb24gc2V0VmF1bHRDb3VudFBlclByb2Nlc3ModWludDggX3BlclByb2Nlc3MpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gZ2V0SGFzaChieXRlczMyIGFjdGlvblR5cGUsIGJ5dGVzMzIgYXJnMSkgcHVibGljIHB1cmUgcmV0dXJucyAoIGJ5dGVzMzIgKTsKICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRNaWxlc3RvbmVQcm9jZXNzZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIHByb2Nlc3NGdW5kaW5nRmFpbGVkRmluaXNoZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIHByb2Nlc3NGdW5kaW5nU3VjY2Vzc2Z1bEZpbmlzaGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRDdXJyZW50TWlsZXN0b25lSWRIYXNoKCkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChieXRlczMyKTsKICAgIGZ1bmN0aW9uIHByb2Nlc3NNaWxlc3RvbmVGaW5pc2hlZCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gcHJvY2Vzc0VtZXJnZW5jeUZ1bmRSZWxlYXNlRmluaXNoZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldEFmdGVyVHJhbnNmZXJMb2NrZWRUb2tlbkJhbGFuY2VzKGFkZHJlc3MgdmF1bHRBZGRyZXNzLCBib29sIGV4Y2x1ZGVDdXJyZW50KSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIFZhdWx0UmVxdWVzdGVkVXBkYXRlRm9yTG9ja2VkVm90aW5nVG9rZW5zKGFkZHJlc3Mgb3duZXIpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGRvU3RhdGVDaGFuZ2VzKCkgcHVibGljOwogICAgZnVuY3Rpb24gaGFzUmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldFJlcXVpcmVkU3RhdGVDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgsIHVpbnQ4KTsKICAgIGZ1bmN0aW9uIEFwcGxpY2F0aW9uSW5GdW5kaW5nT3JEZXZlbG9wbWVudCgpIHB1YmxpYyB2aWV3IHJldHVybnMoYm9vbCk7Cgp9CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBUb2tlbiBTdGFrZSBDYWxjdWxhdGlvbiBBbmQgRGlzdHJpYnV0aW9uIEFsZ29yaXRobSAtIFR5cGUgMyAtIFNlbGwgYSB2YXJpYWJsZSBhbW91bnQgb2YgdG9rZW5zIGZvciBhIGZpeGVkIHByaWNlCiAqIEBwYWNrYWdlICAgICBCbG9ja0JpdHNJTwogKiBAYXV0aG9yICAgICAgTWlja3kgU29jYWNpIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjBjNjE2NTZmNjc3NTRjNjI2MzdiNjA2NTdhNjkyMjdlNjMiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+PgoKCiAgICBJbnB1dHM6CgogICAgRGVmaW5lZCBudW1iZXIgb2YgdG9rZW5zIHBlciB3ZWkgKCBYIFRva2VucyA9IDEgd2VpICkKICAgIFJlY2VpdmVkIGFtb3VudCBvZiBFVEgKICAgIEdlbmVyYXRlczoKCiAgICBUb3RhbCBTdXBwbHkgb2YgdG9rZW5zIGF2YWlsYWJsZSBpbiBGdW5kaW5nIFBoYXNlIHJlc3BlY3RpdmVseSBQcm9qZWN0CiAgICBPYnNlcnZhdGlvbnM6CgogICAgV2lsbCBzZWxsIHRoZSB3aG9sZSBzdXBwbHkgb2YgVG9rZW5zIGF2YWlsYWJsZSB0byBDdXJyZW50IEZ1bmRpbmcgUGhhc2UKICAgIFVzZSBjYXNlczoKCiAgICBBbnkgRnVuZGluZyBQaGFzZSB3aGVyZSB5b3Ugd2FudCB0aGUgZmlyc3QgRnVuZGluZyBQaGFzZSB0byBkZXRlcm1pbmUgdGhlIHRva2VuIHN1cHBseSBvZiB0aGUgd2hvbGUgUHJvamVjdAoKKi8KCgoKCmNvbnRyYWN0IEFCSVRva2VuU0NBREFWYXJpYWJsZSB7CiAgICBib29sIHB1YmxpYyBTQ0FEQV9yZXF1aXJlc19oYXJkX2NhcCA9IHRydWU7CiAgICBib29sIHB1YmxpYyBpbml0aWFsaXplZDsKICAgIGFkZHJlc3MgcHVibGljIGRlcGxveWVyQWRkcmVzczsKICAgIGZ1bmN0aW9uIGFkZFNldHRpbmdzKGFkZHJlc3MgX2Z1bmRpbmdDb250cmFjdCkgcHVibGljOwogICAgZnVuY3Rpb24gcmVxdWlyZXNIYXJkQ2FwKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRUb2tlbnNGb3JWYWx1ZUluQ3VycmVudFN0YWdlKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGdldFRva2Vuc0ZvclZhbHVlSW5TdGFnZSh1aW50OCBfc3RhZ2UsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGdldEJvdWdodFRva2VucyggYWRkcmVzcyBfdmF1bHRBZGRyZXNzLCBib29sIF9kaXJlY3QgKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKfQoKLyoKCiAqIHNvdXJjZSAgICAgICBodHRwczovL2dpdGh1Yi5jb20vYmxvY2tiaXRzaW8vCgogKiBAbmFtZSAgICAgICAgRnVuZGluZyBWYXVsdAogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PHNwYW4gY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSJmNTk4OWM5NjllOGNiNTliOWE4Mjk5OWM4MzkwZGI4NzlhIj5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4KCiAgICBlYWNoIHB1cmNoYXNlIGNyZWF0ZXMgYSBzZXBhcmF0ZSBmdW5kaW5nIHZhdWx0IGNvbnRyYWN0CiovCgoKY29udHJhY3QgRnVuZGluZ1ZhdWx0IHsKCiAgICAvKiBBc3NldCBpbml0aWFsaXNlZCBvciBub3QgKi8KICAgIGJvb2wgcHVibGljIF9pbml0aWFsaXplZCA9IGZhbHNlOwoKICAgIC8qCiAgICAgICAgQWRkcmVzc2VzOgogICAgICAgIHZhdWx0T3duZXIgLSB0aGUgYWRkcmVzcyBvZiB0aGUgd2FsbGV0IHRoYXQgc3RvcmVzIHB1cmNoYXNlcyBpbiB0aGlzIHZhdWx0ICggaW52ZXN0b3IgYWRkcmVzcyApCiAgICAgICAgb3V0cHV0QWRkcmVzcyAtIGFkZHJlc3Mgd2hlcmUgZnVuZHMgZ28gdXBvbiBzdWNjZXNzZnVsIGZ1bmRpbmcgb3Igc3VjY2Vzc2Z1bCBtaWxlc3RvbmUgcmVsZWFzZQogICAgICAgIG1hbmFnZXJBZGRyZXNzIC0gYWRkcmVzcyBvZiB0aGUgIkZ1bmRpbmdNYW5hZ2VyIgogICAgKi8KICAgIGFkZHJlc3MgcHVibGljIHZhdWx0T3duZXIgOwogICAgYWRkcmVzcyBwdWJsaWMgb3V0cHV0QWRkcmVzczsKICAgIGFkZHJlc3MgcHVibGljIG1hbmFnZXJBZGRyZXNzOwoKICAgIC8qCiAgICAgICAgTG9jayBhbmQgQmxhY2tIb2xlIHNldHRpbmdzCiAgICAqLwoKICAgIGJvb2wgcHVibGljIGFsbEZ1bmRpbmdQcm9jZXNzZWQgPSBmYWxzZTsKICAgIGJvb2wgcHVibGljIERpcmVjdEZ1bmRpbmdQcm9jZXNzZWQgPSBmYWxzZTsKCiAgICAvKgogICAgICAgIEFzc2V0cwogICAgKi8KICAgIC8vIEFwcGxpY2F0aW9uRW50aXR5QUJJIHB1YmxpYyBBcHBsaWNhdGlvbkVudGl0eTsKICAgIEFCSUZ1bmRpbmcgRnVuZGluZ0VudGl0eTsKICAgIEFCSUZ1bmRpbmdNYW5hZ2VyIEZ1bmRpbmdNYW5hZ2VyRW50aXR5OwogICAgQUJJTWlsZXN0b25lcyBNaWxlc3RvbmVzRW50aXR5OwogICAgQUJJUHJvcG9zYWxzIFByb3Bvc2Fsc0VudGl0eTsKICAgIEFCSVRva2VuU0NBREFWYXJpYWJsZSBUb2tlblNDQURBRW50aXR5OwogICAgQUJJVG9rZW4gVG9rZW5FbnRpdHkgOwoKICAgIC8qCiAgICAgICAgR2xvYmFscwogICAgKi8KICAgIHVpbnQyNTYgcHVibGljIGFtb3VudF9kaXJlY3QgPSAwOwogICAgdWludDI1NiBwdWJsaWMgYW1vdW50X21pbGVzdG9uZSA9IDA7CgogICAgLy8gYnlsYXdzCiAgICBib29sIHB1YmxpYyBlbWVyZ2VuY3lGdW5kUmVsZWFzZWQgPSBmYWxzZTsKICAgIHVpbnQ4IGVtZXJnZW5jeUZ1bmRQZXJjZW50YWdlID0gMDsKICAgIHVpbnQyNTYgQnlsYXdzQ2FzaEJhY2tPd25lck1pYUR1cmF0aW9uOwogICAgdWludDI1NiBCeWxhd3NDYXNoQmFja1ZvdGVSZWplY3RlZER1cmF0aW9uOwogICAgdWludDI1NiBCeWxhd3NQcm9wb3NhbFZvdGluZ0R1cmF0aW9uOwoKICAgIHN0cnVjdCBQdXJjaGFzZVN0cnVjdCB7CiAgICAgICAgdWludDI1NiB1bml4X3RpbWU7CiAgICAgICAgdWludDggcGF5bWVudF9tZXRob2Q7CiAgICAgICAgdWludDI1NiBhbW91bnQ7CiAgICAgICAgdWludDggZnVuZGluZ19zdGFnZTsKICAgICAgICB1aW50MTYgaW5kZXg7CiAgICB9CgogICAgbWFwcGluZyh1aW50MTYgPT4gUHVyY2hhc2VTdHJ1Y3QpIHB1YmxpYyBwdXJjaGFzZVJlY29yZHM7CiAgICB1aW50MTYgcHVibGljIHB1cmNoYXNlUmVjb3Jkc051bTsKCiAgICBldmVudCBFdmVudFBheW1lbnRSZWNlaXZlZCh1aW50OCBpbmRleGVkIF9wYXltZW50X21ldGhvZCwgdWludDI1NiBpbmRleGVkIF9hbW91bnQsIHVpbnQxNiBpbmRleGVkIF9pbmRleCApOwogICAgZXZlbnQgVmF1bHRJbml0aWFsaXplZChhZGRyZXNzIGluZGV4ZWQgX293bmVyKTsKCiAgICBmdW5jdGlvbiBpbml0aWFsaXplKAogICAgICAgIGFkZHJlc3MgX293bmVyLAogICAgICAgIGFkZHJlc3MgX291dHB1dCwKICAgICAgICBhZGRyZXNzIF9mdW5kaW5nQWRkcmVzcywKICAgICAgICBhZGRyZXNzIF9taWxlc3RvbmVBZGRyZXNzLAogICAgICAgIGFkZHJlc3MgX3Byb3Bvc2Fsc0FkZHJlc3MKICAgICkKICAgICAgICBwdWJsaWMKICAgICAgICByZXF1aXJlTm90SW5pdGlhbGlzZWQKICAgICAgICByZXR1cm5zKGJvb2wpCiAgICB7CiAgICAgICAgVmF1bHRJbml0aWFsaXplZChfb3duZXIpOwoKICAgICAgICBvdXRwdXRBZGRyZXNzID0gX291dHB1dDsKICAgICAgICB2YXVsdE93bmVyID0gX293bmVyOwoKICAgICAgICAvLyB3aG9tZXZlciBjcmVhdGVzIHRoaXMgY29udHJhY3QgaXMgdGhlIG1hbmFnZXIuCiAgICAgICAgbWFuYWdlckFkZHJlc3MgPSBtc2cuc2VuZGVyOwoKICAgICAgICAvLyBhc3NldHMKICAgICAgICBGdW5kaW5nRW50aXR5ID0gQUJJRnVuZGluZyhfZnVuZGluZ0FkZHJlc3MpOwogICAgICAgIEZ1bmRpbmdNYW5hZ2VyRW50aXR5ID0gQUJJRnVuZGluZ01hbmFnZXIobWFuYWdlckFkZHJlc3MpOwogICAgICAgIE1pbGVzdG9uZXNFbnRpdHkgPSBBQklNaWxlc3RvbmVzKF9taWxlc3RvbmVBZGRyZXNzKTsKICAgICAgICBQcm9wb3NhbHNFbnRpdHkgPSBBQklQcm9wb3NhbHMoX3Byb3Bvc2Fsc0FkZHJlc3MpOwoKICAgICAgICBhZGRyZXNzIFRva2VuTWFuYWdlckFkZHJlc3MgPSBGdW5kaW5nRW50aXR5LmdldEFwcGxpY2F0aW9uQXNzZXRBZGRyZXNzQnlOYW1lKCJUb2tlbk1hbmFnZXIiKTsKICAgICAgICBBQklUb2tlbk1hbmFnZXIgVG9rZW5NYW5hZ2VyRW50aXR5ID0gQUJJVG9rZW5NYW5hZ2VyKFRva2VuTWFuYWdlckFkZHJlc3MpOwoKICAgICAgICBhZGRyZXNzIFRva2VuQWRkcmVzcyA9IFRva2VuTWFuYWdlckVudGl0eS5Ub2tlbkVudGl0eSgpOwogICAgICAgIFRva2VuRW50aXR5ID0gQUJJVG9rZW4oVG9rZW5BZGRyZXNzKTsKCiAgICAgICAgYWRkcmVzcyBUb2tlblNDQURBQWRkcmVzcyA9IFRva2VuTWFuYWdlckVudGl0eS5Ub2tlblNDQURBRW50aXR5KCk7CiAgICAgICAgVG9rZW5TQ0FEQUVudGl0eSA9IEFCSVRva2VuU0NBREFWYXJpYWJsZShUb2tlblNDQURBQWRkcmVzcyk7CgogICAgICAgIC8vIHNldCBFbWVyZ2VuY3kgRnVuZCBQZXJjZW50YWdlIGlmIGF2YWlsYWJsZS4KICAgICAgICBhZGRyZXNzIEFwcGxpY2F0aW9uRW50aXR5QWRkcmVzcyA9IFRva2VuTWFuYWdlckVudGl0eS5vd25lcigpOwogICAgICAgIEFwcGxpY2F0aW9uRW50aXR5QUJJIEFwcGxpY2F0aW9uRW50aXR5ID0gQXBwbGljYXRpb25FbnRpdHlBQkkoQXBwbGljYXRpb25FbnRpdHlBZGRyZXNzKTsKCiAgICAgICAgLy8gZ2V0IEFwcGxpY2F0aW9uIEJ5bGF3cwogICAgICAgIGVtZXJnZW5jeUZ1bmRQZXJjZW50YWdlICAgICAgICAgICAgID0gdWludDgoIEFwcGxpY2F0aW9uRW50aXR5LmdldEJ5bGF3VWludDI1NigiZW1lcmdlbmN5X2Z1bmRfcGVyY2VudGFnZSIpICk7CiAgICAgICAgQnlsYXdzQ2FzaEJhY2tPd25lck1pYUR1cmF0aW9uICAgICAgPSBBcHBsaWNhdGlvbkVudGl0eS5nZXRCeWxhd1VpbnQyNTYoImNhc2hiYWNrX293bmVyX21pYV9kdXIiKSA7CiAgICAgICAgQnlsYXdzQ2FzaEJhY2tWb3RlUmVqZWN0ZWREdXJhdGlvbiAgPSBBcHBsaWNhdGlvbkVudGl0eS5nZXRCeWxhd1VpbnQyNTYoImNhc2hiYWNrX2ludmVzdG9yX25vIikgOwogICAgICAgIEJ5bGF3c1Byb3Bvc2FsVm90aW5nRHVyYXRpb24gICAgICAgID0gQXBwbGljYXRpb25FbnRpdHkuZ2V0QnlsYXdVaW50MjU2KCJwcm9wb3NhbF92b3RpbmdfZHVyYXRpb24iKSA7CgogICAgICAgIC8vIGluaXQKICAgICAgICBfaW5pdGlhbGl6ZWQgPSB0cnVlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKCgogICAgLyoKICAgICAgICBUaGUgZnVuZGluZyBjb250cmFjdCBkZWNpZGVzIGlmIGEgdmF1bHQgc2hvdWxkIHJlY2VpdmUgcGF5bWVudHMgb3Igbm90LCBzaW5jZSBpdCdzIHRoZSBvbmUgdGhhdCBjcmVhdGVzIHRoZW0sCiAgICAgICAgbm8gcG9pbnQgaW4gY3JlYXRpbmcgb25lIGlmIHlvdSBjYW4ndCBhY2NlcHQgcGF5bWVudHMuCiAgICAqLwoKICAgIG1hcHBpbmcgKHVpbnQ4ID0+IHVpbnQyNTYpIHB1YmxpYyBzdGFnZUFtb3VudHM7CiAgICBtYXBwaW5nICh1aW50OCA9PiB1aW50MjU2KSBwdWJsaWMgc3RhZ2VBbW91bnRzRGlyZWN0OwoKICAgIGZ1bmN0aW9uIGFkZFBheW1lbnQoCiAgICAgICAgdWludDggX3BheW1lbnRfbWV0aG9kLAogICAgICAgIHVpbnQ4IF9mdW5kaW5nX3N0YWdlCiAgICApCiAgICAgICAgcHVibGljCiAgICAgICAgcGF5YWJsZQogICAgICAgIHJlcXVpcmVJbml0aWFsaXNlZAogICAgICAgIG9ubHlNYW5hZ2VyCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICBpZihtc2cudmFsdWUgPiAwICYmIEZ1bmRpbmdFbnRpdHkuYWxsb3dlZFBheW1lbnRNZXRob2QoX3BheW1lbnRfbWV0aG9kKSkgewoKICAgICAgICAgICAgLy8gc3RvcmUgcGF5bWVudAogICAgICAgICAgICBQdXJjaGFzZVN0cnVjdCBzdG9yYWdlIHB1cmNoYXNlID0gcHVyY2hhc2VSZWNvcmRzWysrcHVyY2hhc2VSZWNvcmRzTnVtXTsKICAgICAgICAgICAgICAgIHB1cmNoYXNlLnVuaXhfdGltZSA9IG5vdzsKICAgICAgICAgICAgICAgIHB1cmNoYXNlLnBheW1lbnRfbWV0aG9kID0gX3BheW1lbnRfbWV0aG9kOwogICAgICAgICAgICAgICAgcHVyY2hhc2UuYW1vdW50ID0gbXNnLnZhbHVlOwogICAgICAgICAgICAgICAgcHVyY2hhc2UuZnVuZGluZ19zdGFnZSA9IF9mdW5kaW5nX3N0YWdlOwogICAgICAgICAgICAgICAgcHVyY2hhc2UuaW5kZXggPSBwdXJjaGFzZVJlY29yZHNOdW07CgogICAgICAgICAgICAvLyBhc3NpZ24gcGF5bWVudCB0byBkaXJlY3Qgb3IgbWlsZXN0b25lCiAgICAgICAgICAgIGlmKF9wYXltZW50X21ldGhvZCA9PSAxKSB7CiAgICAgICAgICAgICAgICBhbW91bnRfZGlyZWN0Kz0gcHVyY2hhc2UuYW1vdW50OwogICAgICAgICAgICAgICAgc3RhZ2VBbW91bnRzRGlyZWN0W19mdW5kaW5nX3N0YWdlXSs9cHVyY2hhc2UuYW1vdW50OwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZihfcGF5bWVudF9tZXRob2QgPT0gMikgewogICAgICAgICAgICAgICAgYW1vdW50X21pbGVzdG9uZSs9IHB1cmNoYXNlLmFtb3VudDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gaW4gb3JkZXIgdG8gbm90IGl0ZXJhdGUgdGhyb3VnaCBwdXJjaGFzZSByZWNvcmRzLCB3ZSBqdXN0IGluY3JlYXNlIGZ1bmRpbmcgc3RhZ2UgYW1vdW50LgogICAgICAgICAgICAvLyBpc3N1ZSB3aXRoIGl0ZXJhdGluZyBvdmVyIHRoZW0sIHdoaWxlIHByb2Nlc3NpbmcgdmF1bHRzLCB3b3VsZCBiZSB0aGF0IHNvbWVvbmUgY291bGQgY3JlYXRlIGEgbGFyZ2UKICAgICAgICAgICAgLy8gbnVtYmVyIG9mIHBheW1lbnRzLCB3aGljaCB3b3VsZCByZXN1bHQgaW4gYW4gIm91dCBvZiBnYXMiIC8gc3RhY2sgb3ZlcmZsb3cgaXNzdWUsIHRoYXQgd291bGQgbG9jawogICAgICAgICAgICAvLyBvdXIgY29udHJhY3QsIHNvIHdlIGRvbid0IHJlYWxseSB3YW50IHRvIGRvIHRoYXQuCiAgICAgICAgICAgIC8vIGRvaW5nIGl0IHRoaXMgd2F5IGFsc28gc2F2ZXMgc29tZSBnYXMKICAgICAgICAgICAgc3RhZ2VBbW91bnRzW19mdW5kaW5nX3N0YWdlXSs9cHVyY2hhc2UuYW1vdW50OwoKICAgICAgICAgICAgRXZlbnRQYXltZW50UmVjZWl2ZWQoIHB1cmNoYXNlLnBheW1lbnRfbWV0aG9kLCBwdXJjaGFzZS5hbW91bnQsIHB1cmNoYXNlLmluZGV4ICk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBnZXRCb3VnaHRUb2tlbnMoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIFRva2VuU0NBREFFbnRpdHkuZ2V0Qm91Z2h0VG9rZW5zKCBhZGRyZXNzKHRoaXMpLCBmYWxzZSApOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldERpcmVjdEJvdWdodFRva2VucygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gVG9rZW5TQ0FEQUVudGl0eS5nZXRCb3VnaHRUb2tlbnMoIGFkZHJlc3ModGhpcyksIHRydWUgKTsKICAgIH0KCgogICAgbWFwcGluZyAodWludDggPT4gdWludDI1NikgcHVibGljIGV0aGVyQmFsYW5jZXM7CiAgICBtYXBwaW5nICh1aW50OCA9PiB1aW50MjU2KSBwdWJsaWMgdG9rZW5CYWxhbmNlczsKICAgIHVpbnQ4IHB1YmxpYyBCYWxhbmNlTnVtID0gMDsKCiAgICBib29sIHB1YmxpYyBCYWxhbmNlc0luaXRpYWxpc2VkID0gZmFsc2U7CiAgICBmdW5jdGlvbiBpbml0TWlsZXN0b25lVG9rZW5BbmRFdGhlckJhbGFuY2VzKCkgaW50ZXJuYWwKICAgIHsKICAgICAgICBpZihCYWxhbmNlc0luaXRpYWxpc2VkID09IGZhbHNlKSB7CgogICAgICAgICAgICB1aW50MjU2IG1pbGVzdG9uZVRva2VuQmFsYW5jZSA9IFRva2VuRW50aXR5LmJhbGFuY2VPZihhZGRyZXNzKHRoaXMpKTsKICAgICAgICAgICAgdWludDI1NiBtaWxlc3RvbmVFdGhlckJhbGFuY2UgPSB0aGlzLmJhbGFuY2U7CgogICAgICAgICAgICAvLyBubyBuZWVkIHRvIHdvcnJ5IGFib3V0IGZyYWN0aW9ucyBiZWNhdXNlIGF0IHRoZSBsYXN0IG1pbGVzdG9uZSwgd2Ugc2VuZCBldmVyeXRoaW5nIHRoYXQncyBsZWZ0LgoKICAgICAgICAgICAgLy8gZW1lcmdlbmN5IGZ1bmQgdGFrZXMgaXQncyBwZXJjZW50YWdlIGZyb20gaW5pdGlhbCBiYWxhbmNlcy4KICAgICAgICAgICAgaWYoZW1lcmdlbmN5RnVuZFBlcmNlbnRhZ2UgPiAwKSB7CiAgICAgICAgICAgICAgICB0b2tlbkJhbGFuY2VzWzBdID0gbWlsZXN0b25lVG9rZW5CYWxhbmNlIC8gMTAwICogZW1lcmdlbmN5RnVuZFBlcmNlbnRhZ2U7CiAgICAgICAgICAgICAgICBldGhlckJhbGFuY2VzWzBdID0gbWlsZXN0b25lRXRoZXJCYWxhbmNlIC8gMTAwICogZW1lcmdlbmN5RnVuZFBlcmNlbnRhZ2U7CgogICAgICAgICAgICAgICAgbWlsZXN0b25lVG9rZW5CYWxhbmNlLT10b2tlbkJhbGFuY2VzWzBdOwogICAgICAgICAgICAgICAgbWlsZXN0b25lRXRoZXJCYWxhbmNlLT1ldGhlckJhbGFuY2VzWzBdOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBtaWxlc3RvbmVzIHBlcmNlbnRhZ2VzIGFyZSB0aGVuIHRha2VuIGZyb20gd2hhdCdzIGxlZnQuCiAgICAgICAgICAgIGZvcih1aW50OCBpID0gMTsgaSA8PSBNaWxlc3RvbmVzRW50aXR5LlJlY29yZE51bSgpOyBpKyspIHsKCiAgICAgICAgICAgICAgICB1aW50OCBwZXJjID0gTWlsZXN0b25lc0VudGl0eS5nZXRNaWxlc3RvbmVGdW5kaW5nUGVyY2VudGFnZShpKTsKICAgICAgICAgICAgICAgIHRva2VuQmFsYW5jZXNbaV0gPSBtaWxlc3RvbmVUb2tlbkJhbGFuY2UgLyAxMDAgKiBwZXJjOwogICAgICAgICAgICAgICAgZXRoZXJCYWxhbmNlc1tpXSA9IG1pbGVzdG9uZUV0aGVyQmFsYW5jZSAvIDEwMCAqIHBlcmM7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEJhbGFuY2VOdW0gPSBpOwogICAgICAgICAgICBCYWxhbmNlc0luaXRpYWxpc2VkID0gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gUmVsZWFzZUZ1bmRzQW5kVG9rZW5zKCkKICAgICAgICBwdWJsaWMKICAgICAgICByZXF1aXJlSW5pdGlhbGlzZWQKICAgICAgICBvbmx5TWFuYWdlcgogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgLy8gZmlyc3QgbWFrZSBzdXJlIGNhc2hiYWNrIGlzIG5vdCBwb3NzaWJsZSwgYW5kIHRoYXQgd2UndmUgbm90IHByb2Nlc3NlZCBldmVyeXRoaW5nIGluIHRoaXMgdmF1bHQKICAgICAgICBpZighY2FuQ2FzaEJhY2soKSAmJiBhbGxGdW5kaW5nUHJvY2Vzc2VkID09IGZhbHNlKSB7CgogICAgICAgICAgICBpZihGdW5kaW5nTWFuYWdlckVudGl0eS5DdXJyZW50RW50aXR5U3RhdGUoKSA9PSBGdW5kaW5nTWFuYWdlckVudGl0eS5nZXRFbnRpdHlTdGF0ZSgiRlVORElOR19TVUNDRVNTRlVMX1BST0dSRVNTIikpIHsKCiAgICAgICAgICAgICAgICAvLyBjYXNlIDEsIGRpcmVjdCBmdW5kaW5nIG9ubHkKICAgICAgICAgICAgICAgIGlmKGFtb3VudF9kaXJlY3QgPiAwICYmIGFtb3VudF9taWxlc3RvbmUgPT0gMCkgewoKICAgICAgICAgICAgICAgICAgICAvLyBpZiB3ZSBoYXZlIGRpcmVjdCBmdW5kaW5nIGFuZCBubyBtaWxlc3RvbmUgYmFsYW5jZSwgdHJhbnNmZXIgZXZlcnl0aGluZyBhbmQgbG9jayB2YXVsdAogICAgICAgICAgICAgICAgICAgIC8vIHRvIHNhdmUgZ2FzIGluIGZ1dHVyZSBwcm9jZXNzaW5nIHJ1bnMuCgogICAgICAgICAgICAgICAgICAgIC8vIHRyYW5zZmVyIHRva2VucyB0byB0aGUgaW52ZXN0b3IKICAgICAgICAgICAgICAgICAgICBUb2tlbkVudGl0eS50cmFuc2Zlcih2YXVsdE93bmVyLCBUb2tlbkVudGl0eS5iYWxhbmNlT2YoIGFkZHJlc3ModGhpcykgKSApOwoKICAgICAgICAgICAgICAgICAgICAvLyB0cmFuc2ZlciBldGhlciB0byB0aGUgb3duZXIncyB3YWxsZXQKICAgICAgICAgICAgICAgICAgICBvdXRwdXRBZGRyZXNzLnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CgogICAgICAgICAgICAgICAgICAgIC8vIGxvY2sgdmF1bHQuLiBhbmQgZW5hYmxlIGJsYWNrIGhvbGUgbWV0aG9kcwogICAgICAgICAgICAgICAgICAgIGFsbEZ1bmRpbmdQcm9jZXNzZWQgPSB0cnVlOwoKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBjYXNlIDIgYW5kIDMsIGRpcmVjdCBmdW5kaW5nIG9ubHkKCiAgICAgICAgICAgICAgICAgICAgaWYoYW1vdW50X2RpcmVjdCA+IDAgJiYgRGlyZWN0RnVuZGluZ1Byb2Nlc3NlZCA9PSBmYWxzZSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgVG9rZW5FbnRpdHkudHJhbnNmZXIodmF1bHRPd25lciwgZ2V0RGlyZWN0Qm91Z2h0VG9rZW5zKCkgKTsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJhbnNmZXIgImRpcmVjdCBmdW5kaW5nIiBldGhlciB0byB0aGUgb3duZXIncyB3YWxsZXQKICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0QWRkcmVzcy50cmFuc2ZlcihhbW91bnRfZGlyZWN0KTsKICAgICAgICAgICAgICAgICAgICAgICAgRGlyZWN0RnVuZGluZ1Byb2Nlc3NlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAvLyBwcm9jZXNzIGFuZCBpbml0aWFsaXplIG1pbGVzdG9uZSBiYWxhbmNlcywgZW1lcmdlbmN5IGZ1bmQsIGV0Yywgb25jZQogICAgICAgICAgICAgICAgICAgIGluaXRNaWxlc3RvbmVUb2tlbkFuZEV0aGVyQmFsYW5jZXMoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgICAgICAgfSBlbHNlIGlmKEZ1bmRpbmdNYW5hZ2VyRW50aXR5LkN1cnJlbnRFbnRpdHlTdGF0ZSgpID09IEZ1bmRpbmdNYW5hZ2VyRW50aXR5LmdldEVudGl0eVN0YXRlKCJNSUxFU1RPTkVfUFJPQ0VTU19QUk9HUkVTUyIpKSB7CgogICAgICAgICAgICAgICAgLy8gZ2V0IGN1cnJlbnQgbWlsZXN0b25lIHNvIHdlIGtub3cgd2hpY2ggb25lIHdlIG5lZWQgdG8gcmVsZWFzZSBmdW5kcyBmb3IuCiAgICAgICAgICAgICAgICB1aW50OCBtaWxlc3RvbmVJZCA9IE1pbGVzdG9uZXNFbnRpdHkuY3VycmVudFJlY29yZCgpOwoKICAgICAgICAgICAgICAgIHVpbnQyNTYgdHJhbnNmZXJUb2tlbnMgPSB0b2tlbkJhbGFuY2VzW21pbGVzdG9uZUlkXTsKICAgICAgICAgICAgICAgIHVpbnQyNTYgdHJhbnNmZXJFdGhlciA9IGV0aGVyQmFsYW5jZXNbbWlsZXN0b25lSWRdOwoKICAgICAgICAgICAgICAgIGlmKG1pbGVzdG9uZUlkID09IEJhbGFuY2VOdW0gLSAxKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gd2UncmUgcHJvY2Vzc2luZyB0aGUgbGFzdCBtaWxlc3RvbmUgYW5kIGJhbGFuY2UsIHRoaXMgbWVhbnMgd2UncmUgdHJhbnNmZXJyaW5nIGV2ZXJ5dGhpbmcgbGVmdC4KICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIGlzIGRvbmUgdG8gbWFrZSBzdXJlIHdlJ3ZlIHRyYW5zZmVycmVkIGV2ZXJ5dGhpbmcsIGV2ZW4gImV0aGVyIHRoYXQgZ290IG1pc3Rha2VubHkgc2VudCB0byB0aGlzIGFkZHJlc3MiCiAgICAgICAgICAgICAgICAgICAgLy8gYXMgd2VsbCBhcyB0aGUgZW1lcmdlbmN5IGZ1bmQgaWYgaXQgaGFzIG5vdCBiZWVuIHVzZWQuCiAgICAgICAgICAgICAgICAgICAgdHJhbnNmZXJUb2tlbnMgPSBUb2tlbkVudGl0eS5iYWxhbmNlT2YoYWRkcmVzcyh0aGlzKSk7CiAgICAgICAgICAgICAgICAgICAgdHJhbnNmZXJFdGhlciA9IHRoaXMuYmFsYW5jZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBzZXQgYmFsYW5jZXMgdG8gMCBzbyB3ZSBjYW4ndCB0cmFuc2ZlciBtdWx0aXBsZSB0aW1lcy4KICAgICAgICAgICAgICAgIC8vIHRva2VuQmFsYW5jZXNbbWlsZXN0b25lSWRdID0gMDsKICAgICAgICAgICAgICAgIC8vIGV0aGVyQmFsYW5jZXNbbWlsZXN0b25lSWRdID0gMDsKCiAgICAgICAgICAgICAgICAvLyB0cmFuc2ZlciB0b2tlbnMgdG8gdGhlIGludmVzdG9yCiAgICAgICAgICAgICAgICBUb2tlbkVudGl0eS50cmFuc2Zlcih2YXVsdE93bmVyLCB0cmFuc2ZlclRva2VucyApOwoKICAgICAgICAgICAgICAgIC8vIHRyYW5zZmVyIGV0aGVyIHRvIHRoZSBvd25lcidzIHdhbGxldAogICAgICAgICAgICAgICAgb3V0cHV0QWRkcmVzcy50cmFuc2Zlcih0cmFuc2ZlckV0aGVyKTsKCiAgICAgICAgICAgICAgICBpZihtaWxlc3RvbmVJZCA9PSBCYWxhbmNlTnVtIC0gMSkgewogICAgICAgICAgICAgICAgICAgIC8vIGxvY2sgdmF1bHQuLiBhbmQgZW5hYmxlIGJsYWNrIGhvbGUgbWV0aG9kcwogICAgICAgICAgICAgICAgICAgIGFsbEZ1bmRpbmdQcm9jZXNzZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgoKICAgIGZ1bmN0aW9uIHJlbGVhc2VUb2tlbnNBbmRFdGhlckZvckVtZXJnZW5jeUZ1bmQoKQogICAgICAgIHB1YmxpYwogICAgICAgIHJlcXVpcmVJbml0aWFsaXNlZAogICAgICAgIG9ubHlNYW5hZ2VyCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICBpZiggZW1lcmdlbmN5RnVuZFJlbGVhc2VkID09IGZhbHNlICYmIGVtZXJnZW5jeUZ1bmRQZXJjZW50YWdlID4gMCkgewoKICAgICAgICAgICAgLy8gdHJhbnNmZXIgdG9rZW5zIHRvIHRoZSBpbnZlc3RvcgogICAgICAgICAgICBUb2tlbkVudGl0eS50cmFuc2Zlcih2YXVsdE93bmVyLCB0b2tlbkJhbGFuY2VzWzBdICk7CgogICAgICAgICAgICAvLyB0cmFuc2ZlciBldGhlciB0byB0aGUgb3duZXIncyB3YWxsZXQKICAgICAgICAgICAgb3V0cHV0QWRkcmVzcy50cmFuc2ZlcihldGhlckJhbGFuY2VzWzBdKTsKCiAgICAgICAgICAgIGVtZXJnZW5jeUZ1bmRSZWxlYXNlZCA9IHRydWU7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgZnVuY3Rpb24gUmVsZWFzZUZ1bmRzVG9JbnZlc3RvcigpCiAgICAgICAgcHVibGljCiAgICAgICAgcmVxdWlyZUluaXRpYWxpc2VkCiAgICAgICAgaXNPd25lcgogICAgewogICAgICAgIGlmKGNhbkNhc2hCYWNrKCkpIHsKCiAgICAgICAgICAgIC8vIElGIHdlJ3JlIGRvaW5nIGEgY2FzaGJhY2sKICAgICAgICAgICAgLy8gdHJhbnNmZXIgdmF1bHQgdG9rZW5zIGJhY2sgdG8gb3duZXIgYWRkcmVzcwogICAgICAgICAgICAvLyBzZW5kIGFsbCBldGhlciB0byB3YWxsZXQgb3duZXIKCiAgICAgICAgICAgIC8vIGdldCB0b2tlbiBiYWxhbmNlCiAgICAgICAgICAgIHVpbnQyNTYgbXlCYWxhbmNlID0gVG9rZW5FbnRpdHkuYmFsYW5jZU9mKGFkZHJlc3ModGhpcykpOwogICAgICAgICAgICAvLyB0cmFuc2ZlciBhbGwgdmF1bHQgdG9rZW5zIHRvIG93bmVyCiAgICAgICAgICAgIGlmKG15QmFsYW5jZSA+IDApIHsKICAgICAgICAgICAgICAgIFRva2VuRW50aXR5LnRyYW5zZmVyKG91dHB1dEFkZHJlc3MsIG15QmFsYW5jZSApOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBub3cgdHJhbnNmZXIgYWxsIHJlbWFpbmluZyBldGhlciBiYWNrIHRvIGludmVzdG9yIGFkZHJlc3MKICAgICAgICAgICAgdmF1bHRPd25lci50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwoKICAgICAgICAgICAgLy8gdXBkYXRlIEZ1bmRpbmdNYW5hZ2VyIExvY2tlZCBUb2tlbiBBbW91bnQsIHNvIHdlIGRvbid0IGJyZWFrIHZvdGluZwogICAgICAgICAgICBGdW5kaW5nTWFuYWdlckVudGl0eS5WYXVsdFJlcXVlc3RlZFVwZGF0ZUZvckxvY2tlZFZvdGluZ1Rva2VucyggdmF1bHRPd25lciApOwoKICAgICAgICAgICAgLy8gZGlzYWxsb3cgZnVydGhlciBwcm9jZXNzaW5nLCBzbyB3ZSBkb24ndCBicmVhayBGdW5kaW5nIE1hbmFnZXIuCiAgICAgICAgICAgIC8vIHRoaXMgbWV0aG9kIGNhbiBzdGlsbCBiZSBjYWxsZWQgdG8gY29sbGVjdCBmdXR1cmUgYmxhY2sgaG9sZSBldGhlciB0byB0aGlzIHZhdWx0LgogICAgICAgICAgICBhbGxGdW5kaW5nUHJvY2Vzc2VkID0gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgLyoKICAgICAgICAxIC0gaWYgdGhlIGZ1bmRpbmcgb2YgdGhlIHByb2plY3QgRmFpbGVkLCBhbGxvd3MgaW52ZXN0b3JzIHRvIGNsYWltIHRoZWlyIGxvY2tlZCBldGhlciBiYWNrLgogICAgICAgIDIgLSBpZiB0aGUgSW52ZXN0b3Igdm90ZXMgTk8gdG8gYSBEZXZlbG9wbWVudCBNaWxlc3RvbmUgQ29tcGxldGlvbiBQcm9wb3NhbCwgd2hlcmUgdGhlIG1ham9yaXR5CiAgICAgICAgICAgIGFsc28gdm90ZXMgTk8gYWxsb3dzIGludmVzdG9ycyB0byBjbGFpbSB0aGVpciBsb2NrZWQgZXRoZXIgYmFjay4KICAgICAgICAzIC0gcHJvamVjdCBvd25lciBtaXNzZXMgdG8gc2V0IHRoZSB0aW1lIGZvciBhIERldmVsb3BtZW50IE1pbGVzdG9uZSBDb21wbGV0aW9uIE1lZXRpbmcgYWxsb3dzIGludmVzdG9ycwogICAgICAgIHRvIGNsYWltIHRoZWlyIGxvY2tlZCBldGhlciBiYWNrLgogICAgKi8KICAgIGZ1bmN0aW9uIGNhbkNhc2hCYWNrKCkgcHVibGljIHZpZXcgcmVxdWlyZUluaXRpYWxpc2VkIHJldHVybnMgKGJvb2wpIHsKCiAgICAgICAgLy8gY2FzZSAxCiAgICAgICAgaWYoY2hlY2tGdW5kaW5nU3RhdGVGYWlsZWQoKSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgLy8gY2FzZSAyCiAgICAgICAgaWYoY2hlY2tNaWxlc3RvbmVTdGF0ZUludmVzdG9yVm90ZWROb1ZvdGluZ0VuZGVkTm8oKSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgLy8gY2FzZSAzCiAgICAgICAgaWYoY2hlY2tPd25lckZhaWxlZFRvU2V0VGltZU9uTWVldGluZygpKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoZWNrRnVuZGluZ1N0YXRlRmFpbGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmKEZ1bmRpbmdFbnRpdHkuQ3VycmVudEVudGl0eVN0YXRlKCkgPT0gRnVuZGluZ0VudGl0eS5nZXRFbnRpdHlTdGF0ZSgiRkFJTEVEX0ZJTkFMIikgKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgLy8gYWxzbyBjaGVjayBpZiBmdW5kaW5nIHBlcmlvZCBlbmRlZCwgYW5kIDcgZGF5cyBoYXZlIHBhc3NlZCBhbmQgbm8gcHJvY2Vzc2luZyB3YXMgZG9uZS4KICAgICAgICBpZiggRnVuZGluZ0VudGl0eS5nZXRUaW1lc3RhbXAoKSA+PSBGdW5kaW5nRW50aXR5LkZ1bmRpbmdfU2V0dGluZ19jYXNoYmFja190aW1lX3N0YXJ0KCkgKSB7CgogICAgICAgICAgICAvLyBzaG91bGQgb25seSBiZSBwb3NzaWJsZSBpZiBmdW5kaW5nIGVudGl0eSBoYXMgYmVlbiBzdHVjayBpbiBwcm9jZXNzaW5nIGZvciBtb3JlIHRoYW4gNyBkYXlzLgogICAgICAgICAgICBpZiggRnVuZGluZ0VudGl0eS5DdXJyZW50RW50aXR5U3RhdGUoKSAhPSBGdW5kaW5nRW50aXR5LmdldEVudGl0eVN0YXRlKCJTVUNDRVNTRlVMX0ZJTkFMIikgKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoZWNrTWlsZXN0b25lU3RhdGVJbnZlc3RvclZvdGVkTm9Wb3RpbmdFbmRlZE5vKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmKE1pbGVzdG9uZXNFbnRpdHkuQ3VycmVudEVudGl0eVN0YXRlKCkgPT0gTWlsZXN0b25lc0VudGl0eS5nZXRFbnRpdHlTdGF0ZSgiVk9USU5HX0VOREVEX05PIikgKSB7CiAgICAgICAgICAgIC8vIGZpcnN0IHdlIG5lZWQgdG8gbWFrZSBzdXJlIHdlIGFjdHVhbGx5IHZvdGVkLgogICAgICAgICAgICBpZiggUHJvcG9zYWxzRW50aXR5LmdldEhhc1ZvdGVGb3JDdXJyZW50TWlsZXN0b25lUmVsZWFzZSh2YXVsdE93bmVyKSA9PSB0cnVlKSB7CiAgICAgICAgICAgICAgICAvLyBub3cgbWFrZSBzdXJlIHdlIHZvdGVkIE5PLCBhbmQgaWYgc28gcmV0dXJuIHRydWUKICAgICAgICAgICAgICAgIGlmKCBQcm9wb3NhbHNFbnRpdHkuZ2V0TXlWb3RlRm9yQ3VycmVudE1pbGVzdG9uZVJlbGVhc2UoIHZhdWx0T3duZXIgKSA9PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGVja093bmVyRmFpbGVkVG9TZXRUaW1lT25NZWV0aW5nKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIC8vIExvb2tzIGxpa2UgdGhlIHByb2plY3Qgb3duZXIgaXMgbWlzc2luZyBpbiBhY3Rpb24KICAgICAgICAvLyB0aGV5IG9ubHkgaGF2ZSB0byBkbyAxIHRoaW5nLCB3aGljaCBpcyBzZXQgdGhlIG1lZXRpbmcgdGltZSA3IGRheXMgYmVmb3JlIHRoZSBlbmQgb2YgdGhlIG1pbGVzdG9uZSBzbyB0aGF0CiAgICAgICAgLy8gaW52ZXN0b3JzIGtub3cgd2hlbiB0aGV5IG5lZWQgdG8gc2hvdyB1cCBmb3IgYSBwcm9ncmVzcyByZXBvcnQgbWVldGluZwoKICAgICAgICAvLyBhcyB0aGV5IGRpZCBub3QsIHdlIGNvbnNpZGVyIHRoZW0gbWlzc2luZyBpbiBhY3Rpb24gYW5kIGFsbG93IGludmVzdG9ycyB0byByZXRyaWV2ZSB0aGVpciBsb2NrZWQgZXRoZXIgYmFjawogICAgICAgIGlmKCBNaWxlc3RvbmVzRW50aXR5LkN1cnJlbnRFbnRpdHlTdGF0ZSgpID09IE1pbGVzdG9uZXNFbnRpdHkuZ2V0RW50aXR5U3RhdGUoIkRFQURMSU5FX01FRVRJTkdfVElNRV9GQUlMRUQiKSApIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCgogICAgbW9kaWZpZXIgaXNPd25lcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gdmF1bHRPd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5TWFuYWdlcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gbWFuYWdlckFkZHJlc3MpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgcmVxdWlyZUluaXRpYWxpc2VkKCkgewogICAgICAgIHJlcXVpcmUoX2luaXRpYWxpemVkID09IHRydWUpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgcmVxdWlyZU5vdEluaXRpYWxpc2VkKCkgewogICAgICAgIHJlcXVpcmUoX2luaXRpYWxpemVkID09IGZhbHNlKTsKICAgICAgICBfOwogICAgfQp9'.
	

]
