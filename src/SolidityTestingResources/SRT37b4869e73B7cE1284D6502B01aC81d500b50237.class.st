Class {
	#name : #SRT37b4869e73B7cE1284D6502B01aC81d500b50237,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT37b4869e73B7cE1284D6502B01aC81d500b50237 >> base64 [
	^ 'Y29udHJhY3QgQVJLCnsKICAgICAgIAogICAgYWRkcmVzcyBvd25lcjsKICAgIGFkZHJlc3MgY29udHJvbGxlcjsKICAgIGJvb2wgbXV0ZTsKICAgIHN0cmluZ1tdIGNvbXBhbmllczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgY29tcGFueUluZGV4OwogICAgYWRkcmVzc1tdIGNvbXBhbnlXYWxsZXQ7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIGJhbGFuY2VzOwogICAgbWFwcGluZyAodWludCA9PiBCb3QpICBib3RzOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50W10pICBib3RPd25lcnM7ICAgICAgCiAgICBtYXBwaW5nICh1aW50ID0+IE1hcmtldEJpbGwpICBNYXJrZXRCaWxsczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludFtdKSAgQnV5ZXJzQmlsbHM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnRbXSkgIFNlbGxlcnNCaWxsczsKICAgIG1hcHBpbmcgKHVpbnQgPT4gU3RhdHMpICBjeWNsZTsKICAgIHVpbnRbXSAgbGFzdFByaWNlOwogICAgdWludCB0b3RDb21wYW5pZXM7CgogICAgbG9nW10gbG9nczsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIFRPUzsKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBiYW47CiAgICB1aW50WzIwXSAgbGlzdGVkOyAgCiAgICB1aW50IGNvaW5JbmRleDsgICAgICAKICAgIG1hcHBpbmcgKHVpbnQgPT4gQ29pbikgY29pbnM7CiAgICBtYXBwaW5nICh1aW50ID0+IENvaW4pIHRyYXNoOwogICAgQVJLQ29udHJvbGxlcl8xXzAwIGNvbnRyb2w7CgogICAgc3RydWN0IGxvZ3sKICAgIGFkZHJlc3MgYWRtaW47CiAgICBzdHJpbmcgYWN0aW9uOwogICAgYWRkcmVzcyBhZGRyOwogICAgfQoKICAgIHN0cnVjdCBNYXJrZXRCaWxsIHsKICAgIHVpbnQgc2VsbGVyZGF0YTsKICAgIHVpbnQgYnV5ZXJkYXRhOwogICAgdWludCBwcm9kdWN0OwogICAgdWludCBpbmRleDsKICAgIHVpbnQgY29zdDsKICAgIHVpbnQgYmxvY2s7CiAgICB9CiAgICAKICAgIHN0cnVjdCBDb2luIHsKICAgIGFkZHJlc3MgY29pbk93bmVyOwogICAgc3RyaW5nIGRhdGE7CiAgICBzdHJpbmcgbWluZTsgICAgICAKICAgIHVpbnQgY29pblR5cGU7CiAgICB1aW50IHBsYXRmOwogICAgc3RyaW5nIGFkdjsKICAgIHVpbnQgYmxvY2s7CiAgICB9CiAgCiAgICBzdHJ1Y3QgQm90IHsKICAgIGFkZHJlc3Mgb3duZXI7CiAgICBzdHJpbmcgaW5mbzsgICAgICAgICAgICAgIAogICAgdWludCBjb3N0OwogICAgdWludCBuYmlsbHM7IAogICAgbWFwcGluZyAodWludCA9PiB1aW50KSBiaWxsczsKICAgIG1hcHBpbmcgKHVpbnQgPT4gdWludCkgc2FsZXM7CiAgICB9CgoKICAgIG1hcHBpbmcgKHVpbnQgPT4gdWludCkgIGhhZHY7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpICBtaW5lcjsKCiAgICB1aW50IHRvdEJPVFM7CiAgICB1aW50IHNlbGxpbmc7CiAgICB1aW50IG5NYmlsbHM7CiAgICB1aW50IHRvdGFsOwogICAgdWludCBjbGFpbWVkOwogICAgdWludCBib3VudHk7CiAgIAogICAgc3RydWN0IFN0YXRzewogICAgdWludCBzb2xkOwogICAgdWludCBjdXJyZW50U2VsbGVyOwogICAgfQoKICAgICAgICAgICAKICAgICAgICBmdW5jdGlvbiBBUksoKSB7b3duZXI9bXNnLnNlbmRlcjt9ICAgICAgICAKCiAgICAgICAgZnVuY3Rpb24gaW5pdFN0YXRzKHN0cmluZyBzdHIsYWRkcmVzcyBhZCx1aW50IGEpewoKICAgICAgICAgICBpZihtc2cuc2VuZGVyPT1vd25lcil7CiAgICAgICAgICAgCiAgICAgICAgICAgICAgaWYoY29tcGFuaWVzLmxlbmd0aD09MCl7CgogICAgICAgICAgICAgICAgIGNvaW5JbmRleD0wOwogICAgICAgICAgICAgICAgIHRvdEJPVFM9MTAwMDA7CiAgICAgICAgICAgICAgICAgc2VsbGluZz0xOwogICAgICAgICAgICAgICAgIGNsYWltZWQ9MDsgICAgICAgCiAgICAgICAgICAgICAgICAgbk1iaWxscz0xOwogICAgICAgICAgICAgICAgIHRvdGFsPTA7CiAgICAgICAgICAgICAgICAgYm91bnR5PTI1MDA7CiAgICAgICAgICAgICAgICAgbXV0ZT1mYWxzZTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIGZvcih1aW50IHo9MDt6PDIwO3orKyl7ICAgICAgCiAgICAgICAgICAgICAgICAgICAgY3ljbGVbel09U3RhdHMoe3NvbGQ6MCxjdXJyZW50U2VsbGVyOjF9KTsgICAKICAgICAgICAgICAgICAgICAgICBpZih6PDcpe2xhc3RQcmljZS5wdXNoKGEpO30KICAgICAgICAgICAgICAgICAgICBsaXN0ZWRbel09MDsgICAgICAgIAogICAgICAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICAgICAgICAgICBjb21wYW55SW5kZXhbbXNnLnNlbmRlcl09MTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgaWYoY29tcGFuaWVzLmxlbmd0aDwyKXsKICAgICAgICAgICAgICAgICBjb21wYW5pZXMucHVzaChzdHIpOwogICAgICAgICAgICAgICAgIGNvbXBhbnlXYWxsZXQucHVzaChhZCk7CiAgICAgICAgICAgICAgfWVsc2V7aWYoYWQ9PW93bmVyKWNvbXBhbmllc1swXT1zdHI7fQogICAgICAgICAgICAgIAogICAgICAgICAgICAgIGlmKGE9PTMzMyl7b3duZXI9YWQ7bG9ncy5wdXNoKGxvZyhvd25lciwic2V0T3duZXIiLGFkKSk7fSAgICAgICAgICAgICAgCiAgICAgICAgICAgfQoKICAgICAgICB9CgogICAgICAgIAogCgogICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUNvaW4oc3RyaW5nIGRhdCx1aW50IHR5cCx1aW50IHBsdGYsc3RyaW5nIG1pbixzdHJpbmcgYnV5ZXJCaWxsLGFkZHJlc3Mgb3duKSByZXR1cm5zKGJvb2wpewogICAgICAgIGNvaW5JbmRleCsrOwogICAgICAgIGNvaW5zW2NvaW5JbmRleF09IENvaW4oe2NvaW5Pd25lciA6IG93bixkYXRhIDogZGF0LG1pbmUgOiBtaW4sY29pblR5cGUgOiB0eXAscGxhdGY6IHBsdGYsYWR2IDogIiIsYmxvY2sgOiBibG9jay5udW1iZXJ9KTsKICAgICAgICAKICAgICAgICBsaXN0ZWRbdHlwXSsrOwogICAgICAgIGxpc3RlZFtwbHRmXSsrOwoKICAgICAgICBhZG1pbmlzdHJhdGlvbigyLGJ1eWVyQmlsbCxjb2luSW5kZXgsbGFzdFByaWNlWzJdLG1zZy5zZW5kZXIpOwogICAgICAgIGNvbnRyb2wucHVzaENvaW4oY29pbkluZGV4LG93bixkYXQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgCiAgICAgICAgZnVuY3Rpb24gdXBkdCh1aW50IGksc3RyaW5nIGRhdGEsdWludCB0eXAsdWludCBwbHRmLHN0cmluZyBtaW4sc3RyaW5nIGJ1eWVyQmlsbCxhZGRyZXNzIG93bikgIHJldHVybnMoYm9vbCl7CiAgICAgICAgaWYoY29pbnNbaV0uY29pbk93bmVyIT1tc2cuc2VuZGVyKXRocm93OyAgICAgICAgICAKICAgICAgICBjb2luc1tpXS5kYXRhPWRhdGE7CiAgICAgICAgY29pbnNbaV0uY29pblR5cGU9dHlwOwogICAgICAgIGNvaW5zW2ldLnBsYXRmPXBsdGY7CiAgICAgICAgY29pbnNbaV0ubWluZT1taW47CiAgICAgICAgY29pbnNbaV0uY29pbk93bmVyPW93bjsKICAgICAgICBhZG1pbmlzdHJhdGlvbigzLGJ1eWVyQmlsbCxpLGxhc3RQcmljZVszXSxtc2cuc2VuZGVyKTsKICAgICAgICByZXR1cm4gdHJ1ZTsgICAgICAgIAogICAgICAgIH0KICAgCgoKICAgICAgICBmdW5jdGlvbiBzZXRBZHYodWludCBpLHN0cmluZyBkYXRhLHN0cmluZyBidXllckJpbGwpIHJldHVybnMoYm9vbCl7ICAgICAgICAKICAgICAgICBjb2luc1tpXS5hZHY9ZGF0YTsgICAKICAgICAgICBhZG1pbmlzdHJhdGlvbig0LGJ1eWVyQmlsbCxpLGxhc3RQcmljZVs0XSxtc2cuc2VuZGVyKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgIAogICAgICAgIGZ1bmN0aW9uIHNldEhvbWVBZHYodWludCBpLHN0cmluZyBidXllckJpbGwpIHJldHVybnMoYm9vbCl7ICAgICAgIAogICAgICAgIGhhZHZbY3ljbGVbNV0uc29sZF09aTsKICAgICAgICBhZG1pbmlzdHJhdGlvbig1LGJ1eWVyQmlsbCxpLGxhc3RQcmljZVs1XSxtc2cuc2VuZGVyKTsgIAogICAgICAgIHJldHVybiB0cnVlOyAgICAgICAgIAogICAgICAgIH0KICAgICAgCiAgICAgICAgZnVuY3Rpb24gYWRtaW5pc3RyYXRpb24odWludCB0aXBvLHN0cmluZyBidXllckJpbGwsdWludCBpbmRleCx1aW50IGMsYWRkcmVzcyBvd24pIHByaXZhdGV7CiAgICAgICAKICAgICAgICAgICAgICAgIGlmKCEoY29tcGFueUluZGV4W293bl0+MCkpcmVnaXN0ZXJDb21wYW55KG93bixidXllckJpbGwpOwogICAgICAgICAgICAgICAgdWludCB1PWN5Y2xlW3RpcG9dLmN1cnJlbnRTZWxsZXI7CiAgICAgICAgICAgICAgICBpZighYmFuW293bl0pe2JhbGFuY2VzW2JvdHNbdV0ub3duZXJdKz1jO31lbHNle2JhbGFuY2VzW293bmVyXSs9Yzt9CiAgICAgICAgICAgICAgICBiYWxhbmNlc1tvd25dKz1tc2cudmFsdWUtYzsKICAgICAgICAgICAgICAgIHJlZ2lzdGVyQmlsbCh1LGJvdHNbdV0ub3duZXIsb3duLHRpcG8saW5kZXgsYyk7ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICB9CgoKICAgICAgICBmdW5jdGlvbiBzZXRCb3VudHkoYWRkcmVzcyBhLHN0cmluZyBkYXRhLHVpbnQgYW1vdW50KXsKICAgICAgICAgICBpZigobXNnLnNlbmRlcj09b3duZXIpJiYoYm91bnR5PmFtb3VudCkpewogICAgICAgICAgICAgIHJlZ2lzdGVyQ29tcGFueShhLGRhdGEpOwogICAgICAgICAgICAgIGZvcih1aW50IGo9MDtqPGFtb3VudDtqKyspewogICAgICAgICAgICAgIGJvdHNbc2VsbGluZ10gPSBCb3QoYSwiIiwwLDApOwogICAgICAgICAgICAgIGJvdE93bmVyc1thXS5wdXNoKHNlbGxpbmcpOwogICAgICAgICAgICAgIHRvdEJPVFMrKzsKICAgICAgICAgICAgICBzZWxsaW5nKys7CiAgICAgICAgICAgICAgYm91bnR5LS07CiAgICAgICAgICAgICAgfQogICAgICAgICAgIH0KICAgICAgICB9CgoKICAgICAgICBmdW5jdGlvbiBib3RPblNhbGUodWludCBpLHVpbnQgYykge2lmKChtc2cuc2VuZGVyIT1ib3RzW2ldLm93bmVyKXx8KHNlbGxpbmc8PXRvdEJPVFMpfHwoIVRPU1ttc2cuc2VuZGVyXSkpdGhyb3c7Ym90c1tpXS5jb3N0PWM7fQoKICAgICAgICAKICAgICAgICBmdW5jdGlvbiBidXlCT1R4KHVpbnQgaSxzdHJpbmcgYnV5ZXJiaWxsLHN0cmluZyBidXllckluZm8sYWRkcmVzcyBidXllcndhbGxldCx1aW50IGFtb3VudCkgcmV0dXJucyAoYm9vbCl7CiAgICAgICAgIGlmKChhbW91bnQ8MSl8fChhbW91bnQ+MjApfHwoaT4xNTAwMCl8fCgoYW1vdW50PjEpJiYoKHNlbGxpbmcrYW1vdW50Kzk5OT50b3RCT1RTKXx8KHNlbGxpbmc8NDAwKSkpKXRocm93OwogICAgICAgIAogICAgICAgICAgICAgICAgYWRkcmVzcyBzZWxsc05vdzsKICAgICAgICAgICAgICAgIGFkZHJlc3MgaG9sZGVyOwogICAgICAgICAgICAgICAgdWludCBzZWxsOwogICAgICAgICAgICAgICAgdWludCBjdXJyZW50U2VsbGVyOwogICAgICAgICAgICAgICAgdWludCBjOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZighKGNvbXBhbnlJbmRleFtidXllcndhbGxldF0+MCkpcmVnaXN0ZXJDb21wYW55KGJ1eWVyd2FsbGV0LGJ1eWVyYmlsbCk7CgogICAgICAgICAgICAgICAgaWYoKG1pbmVyW21zZy5zZW5kZXJdKSYmKGNsYWltZWQ8MjUwMCkpewogICAgICAgICAgICAgICAgY3VycmVudFNlbGxlcj1jeWNsZVswXS5jdXJyZW50U2VsbGVyOwogICAgICAgICAgICAgICAgc2VsbHNOb3c9Ym90c1tjdXJyZW50U2VsbGVyXS5vd25lcjsKICAgICAgICAgICAgICAgIGM9bGFzdFByaWNlWzBdOwogICAgICAgICAgICAgICAgY2xhaW1lZCsrOwogICAgICAgICAgICAgICAgdG90Qk9UUysrOwogICAgICAgICAgICAgICAgbWluZXJbbXNnLnNlbmRlcl09ZmFsc2U7CiAgICAgICAgICAgICAgICBob2xkZXI9b3duZXI7CiAgICAgICAgICAgICAgICBzZWxsPXNlbGxpbmc7CgogICAgICAgICAgICAgICAgaWYoIWJhbltib3RzW2N1cnJlbnRTZWxsZXJdLm93bmVyXSl7YmFsYW5jZXNbYm90c1tjdXJyZW50U2VsbGVyXS5vd25lcl0rPWM7fWVsc2V7YmFsYW5jZXNbb3duZXJdKz1jO30KCiAgICAgICAgICAgICAgICBzZWxsaW5nKys7CiAgICAgICAgICAgICAgICBib3RzW3NlbGxdID0gQm90KGJ1eWVyd2FsbGV0LGJ1eWVySW5mbywwLDApOwogICAgICAgICAgICAgICAgfWVsc2V7CgogICAgICAgICAgICAgICAgaWYoc2VsbGluZz50b3RCT1RTKXsKICAgICAgICAgICAgICAgIGlmKGJvdHNbaV0uY29zdD09MCl0aHJvdzsKICAgICAgICAgICAgICAgIGN1cnJlbnRTZWxsZXI9Y3ljbGVbMF0uY3VycmVudFNlbGxlcjsKICAgICAgICAgICAgICAgIHNlbGxzTm93PWJvdHNbY3VycmVudFNlbGxlcl0ub3duZXI7CiAgICAgICAgICAgICAgICBob2xkZXI9Ym90c1tpXS5vd25lcjsKICAgICAgICAgICAgICAgIHNlbGw9aTsKICAgICAgICAgICAgICAgIGM9Ym90c1tpXS5jb3N0K2xhc3RQcmljZVswXTsKICAgICAgICAgICAgICAgIG1vdmUoaSxidXllcndhbGxldCk7CiAgICAgICAgICAgICAgICAgICAJCSAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYoIWJhbltzZWxsc05vd10pe2JhbGFuY2VzW3NlbGxzTm93XSs9bGFzdFByaWNlWzBdO31lbHNle2JhbGFuY2VzW293bmVyXSs9bGFzdFByaWNlWzBdO30KICAgICAgICAgCiAgICAgICAgICAgICAgICByZWdpc3RlckJpbGwoaSxob2xkZXIsc2VsbHNOb3csNixzZWxsLGMtbGFzdFByaWNlWzBdKTsgICAgICAgICAgICAgICAgICAgCQkKICAgICAgICAgICAgICAgIGxhc3RQcmljZVtsYXN0UHJpY2UubGVuZ3RoKytdPWMtbGFzdFByaWNlWzBdOwogICAgICAgICAgICAgICAgICAgCQkKICAgICAgICAgICAgICAgIH1lbHNlewoKICAgICAgICAgICAgICAgIGM9bGFzdFByaWNlWzZdKmFtb3VudDsKICAgICAgICAgICAgICAgIGJhbGFuY2VzW293bmVyXSs9bXNnLnZhbHVlOyAKICAgICAgICAgICAgICAgIGN1cnJlbnRTZWxsZXI9c2VsbGluZzsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYoYW1vdW50PjEpe3NlbGw9YW1vdW50KzEwMDAwMDt9ZWxzZXtzZWxsPXNlbGxpbmc7fQogICAgICAgICAgICAgICAgc2VsbHNOb3c9b3duZXI7CiAgICAgICAgICAgICAgICBmb3IodWludCBqPTA7ajxhbW91bnQ7aisrKXsKICAgICAgICAgICAgICAgIGJvdHNbc2VsbGluZytqXSA9IEJvdChidXllcndhbGxldCxidXllckluZm8sMCwwKTsKICAgICAgICAgICAgICAgIGJvdE93bmVyc1tidXllcndhbGxldF0ucHVzaChzZWxsaW5nK2opOwogICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHNlbGxpbmcrPWFtb3VudDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYoc2VsbHNOb3chPW93bmVyKWJvdE93bmVyc1tidXllcndhbGxldF0ucHVzaChzZWxsKTsKICAgICAgICAgICAgICAgIHJlZ2lzdGVyQmlsbChjdXJyZW50U2VsbGVyLHNlbGxzTm93LGJ1eWVyd2FsbGV0LDAsc2VsbCxjKTsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgIAoKICAgICAgIGZ1bmN0aW9uIG1vdmUodWludCBpbmRleCxhZGRyZXNzIHdhbGxldCkgcHJpdmF0ZSByZXR1cm5zICh1aW50W10pewoKICAgICAgICB1aW50W10gbD1ib3RPd25lcnNbYm90c1tpbmRleF0ub3duZXJdOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgdWludCBsbD1sLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICBmb3IodWludCBqPTA7ajxsbDtqKyspewogICAgICAgICAgaWYobFtqXT09aW5kZXgpewogICAgICAgICAgICAgIGlmKGo8bGwtMSlsW2pdPWxbbGwtMV07CiAgICAgICAgICAgICAgZGVsZXRlIGxbbGwtMV07aj1sbDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgYm90T3duZXJzW2JvdHNbaW5kZXhdLm93bmVyXT1sOwogICAgICAgIGJvdE93bmVyc1tib3RzW2luZGV4XS5vd25lcl0ubGVuZ3RoLS07CiAgICAgICAgYm90c1tpbmRleF0ub3duZXI9d2FsbGV0OwogICAgICAgIGJvdHNbaW5kZXhdLmNvc3Q9MDsKCiAgICAgICAgfQoKCiAgICAgICAgZnVuY3Rpb24gdXBkYXRlQk9UQmlsbGluZ0luZm8odWludCBpbmRleCxzdHJpbmcgZGF0YSxhZGRyZXNzIHdhbGxldCxzdHJpbmcgaW5mbyxzdHJpbmcgYnV5ZXJiaWxsLHVpbnQgdXBkYXRldHlwZSkgcmV0dXJucyhib29sKXsKICAgICAgICAgICAgICAgCiAgICAgICAgaWYoKGluZGV4PnRvdEJPVFMpfHwobXNnLnNlbmRlciE9Ym90c1tpbmRleF0ub3duZXIpKXRocm93OwogICAgICAgICAKICAgICAgICAgICAgICAgICAgICB1aW50IHQ9MTsKICAgICAgICAgICAgICAgICAgICBhZGRyZXNzIGNzPWJvdHNbY3ljbGVbMV0uY3VycmVudFNlbGxlcl0ub3duZXI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYoYm90c1tpbmRleF0ub3duZXIhPXdhbGxldCl7CgogICAgICAgICAgICAgICAgICAgICAgIGlmKCEoY29tcGFueUluZGV4W3dhbGxldF0+MCkpcmVnaXN0ZXJDb21wYW55KHdhbGxldCxkYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICBib3RPd25lcnNbd2FsbGV0XS5wdXNoKGluZGV4KTsgCiAgICAgICAgICAgICAgICAgICAgICAgbW92ZShpbmRleCx3YWxsZXQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIH1lbHNlewoKICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHVwZGF0ZXR5cGUhPTEpewogICAgICAgICAgICAgICAgICAgICAgICAgICB0PWNvbXBhbnlJbmRleFttc2cuc2VuZGVyXSsxMDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lzdGVyQ29tcGFueShtc2cuc2VuZGVyLGRhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RDb21wYW5pZXMtLTsKICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICBpZih1cGRhdGV0eXBlIT0yKWJvdHNbaW5kZXhdLmluZm89aW5mbzsKICAgICAgICAgICAgICAgICBpZighYmFuW2NzXSl7YmFsYW5jZXNbY3NdKz1sYXN0UHJpY2VbMV07fWVsc2V7YmFsYW5jZXNbb3duZXJdKz1sYXN0UHJpY2VbMV07fSAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIHJlZ2lzdGVyQmlsbChjeWNsZVsxXS5jdXJyZW50U2VsbGVyLGNzLG1zZy5zZW5kZXIsdCxpbmRleCxsYXN0UHJpY2VbMV0pOyAgICAKICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICAKICAgICAgICBmdW5jdGlvbiByZWdpc3RlckV4dGVybmFsQmlsbCh1aW50IGJpLGFkZHJlc3Mgc2VsbHNOb3csYWRkcmVzcyBidXllcndhbGxldCx1aW50IHRpcG8sdWludCBzZWxsLHVpbnQgYyl7CiAgICAgICAgaWYobXNnLnNlbmRlciE9Y29udHJvbGxlcil0aHJvdzsKICAgICAgICByZWdpc3RlckJpbGwoYmksc2VsbHNOb3csYnV5ZXJ3YWxsZXQsdGlwbyxzZWxsLGMpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gcmVnaXN0ZXJCaWxsKHVpbnQgYmksYWRkcmVzcyBzZWxsc05vdyxhZGRyZXNzIGJ1eWVyd2FsbGV0LHVpbnQgdGlwbyx1aW50IHNlbGwsdWludCBjKSBwcml2YXRlewogICAgICAgICAKICAgICAgICAgaWYoKG1zZy52YWx1ZTxjKXx8KG11dGUpfHwoIVRPU1tidXllcndhbGxldF0pKXRocm93OwogICAgICAgICBCb3QgYj1ib3RzW2JpXTsKICAgICAgICAgdWludCBzZWxsZXJJbmRleDt1aW50IGJ1eWVySW5kZXg7CiAgICAgICAgIGlmKHRpcG8+MTAwKXtzZWxsZXJJbmRleD10aXBvLTEwMDtidXllckluZGV4PXNlbGxlckluZGV4O3RpcG89MTt9ZWxzZXtzZWxsZXJJbmRleD1jb21wYW55SW5kZXhbc2VsbHNOb3ddO2J1eWVySW5kZXg9Y29tcGFueUluZGV4W2J1eWVyd2FsbGV0XTt9CiAgICAgICAgCiAgICAgICAgICBNYXJrZXRCaWxsc1tuTWJpbGxzXT1NYXJrZXRCaWxsKHNlbGxlckluZGV4LGJ1eWVySW5kZXgsdGlwbyxzZWxsLGMsYmxvY2subnVtYmVyKTsKICAgICAgIAogICAgICAgICAgICAgICAgYi5iaWxsc1tiLm5iaWxscysxXT1uTWJpbGxzOwogICAgICAgICAgICAgICAgYi5uYmlsbHMrKzsKICAgICAgICAgICAgICAgIGIuc2FsZXNbdGlwb10rKzsgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBCdXllcnNCaWxsc1tidXllcndhbGxldF1bQnV5ZXJzQmlsbHNbYnV5ZXJ3YWxsZXRdLmxlbmd0aCsrXT1uTWJpbGxzOwogICAgICAgICAgICAgICAgU2VsbGVyc0JpbGxzW3NlbGxzTm93XVtTZWxsZXJzQmlsbHNbc2VsbHNOb3ddLmxlbmd0aCsrXT1uTWJpbGxzOwogICAgICAgICAgICAgICAgbk1iaWxscysrOwogICAgICAgICAgICAgICAgaWYoc2VsbHNOb3chPW93bmVyKXsKICAgICAgICAgICAgICAgIHRvdGFsKz1jOwogICAgICAgICAgICAgICAgaWYodGlwbyE9Nil7CiAgICAgICAgICAgICAgICBjeWNsZVt0aXBvXS5zb2xkKys7CiAgICAgICAgICAgICAgICBjeWNsZVt0aXBvXS5jdXJyZW50U2VsbGVyKys7CiAgICAgICAgICAgICAgICBpZigoY3ljbGVbdGlwb10uY3VycmVudFNlbGxlcj50b3RCT1RTKXx8KGN5Y2xlW3RpcG9dLmN1cnJlbnRTZWxsZXI+PXNlbGxpbmcpKWN5Y2xlW3RpcG9dLmN1cnJlbnRTZWxsZXI9MTt9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZihjbGFpbWVkPD0yNTAwKW1pbmVyW2Jsb2NrLmNvaW5iYXNlXT10cnVlOwogICAgICAgIH0KCiAgIAogICAgICAgIGZ1bmN0aW9uIHJlZ2lzdGVyQ29tcGFueShhZGRyZXNzIHdhbCxzdHJpbmcgZGF0YSkgcHJpdmF0ZXsgICAgICAgIAogICAgICAgIGNvbXBhbnlXYWxsZXRbY29tcGFueVdhbGxldC5sZW5ndGgrK109d2FsOwogICAgICAgIGNvbXBhbnlJbmRleFt3YWxdPWNvbXBhbmllcy5sZW5ndGg7CiAgICAgICAgY29tcGFuaWVzW2NvbXBhbmllcy5sZW5ndGgrK109ZGF0YTsKICAgICAgICB0b3RDb21wYW5pZXMrKzsKICAgICAgICB9CiAgCiAgICAgICAgCiAgICAgICAgZnVuY3Rpb24gbXV0ZU1lKGJvb2wgbSl7CiAgICAgICAgaWYoKG1zZy5zZW5kZXI9PW93bmVyKXx8KG1zZy5zZW5kZXI9PWNvbnRyb2xsZXIpKW11dGU9bTsKICAgICAgICB9CiAgICAgICAgICAgCgogICAgICAgIGZ1bmN0aW9uIHNldENvbnRyb2xsZXIoYWRkcmVzcyBhKSByZXR1cm5zKGJvb2wpe2lmKG1zZy5zZW5kZXIhPW93bmVyKXRocm93O2NvbnRyb2xsZXI9YTtjb250cm9sPUFSS0NvbnRyb2xsZXJfMV8wMChhKTtsb2dzLnB1c2gobG9nKG93bmVyLCJzZXRDZW5zb3JlciIsYSkpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCgogICAgICAgIGZ1bmN0aW9uIGNlbnNvcnNoaXAodWludCBpLGJvb2wgYixib29sIGMpIHJldHVybnMoYm9vbCl7CiAgICAgICAgaWYobXNnLnNlbmRlciE9Y29udHJvbGxlcil0aHJvdzsKICAgICAgICBpZihjKXtjb2luc1tpXT1Db2luKHtjb2luT3duZXIgOiAweDAsZGF0YSA6ICJDZW5zb3JlZCIsbWluZSA6ICIiLGNvaW5UeXBlIDogMCxwbGF0ZjogMCxhZHYgOiAiIixibG9jayA6IDB9KTt9ZWxzZXsKICAgICAgICBpZihiKXsKICAgICAgICB0cmFzaFtpXT1jb2luc1tpXTsKICAgICAgICBjb2luc1tpXT1Db2luKHtjb2luT3duZXIgOiAweDAsZGF0YSA6ICJDZW5zb3JlZCIsbWluZSA6ICIiLGNvaW5UeXBlIDogMCxwbGF0ZjogMCxhZHYgOiAiIixibG9jayA6IDB9KTsKICAgICAgICB9ZWxzZXsKICAgICAgICBjb2luc1tpXT10cmFzaFtpXTsKICAgICAgICB9fQogICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCgogICAgICAgIGZ1bmN0aW9uIHNldFByaWNlKHVpbnQgaSx1aW50IGopIHJldHVybnMoYm9vbCl7aWYobXNnLnNlbmRlciE9Y29udHJvbGxlcil0aHJvdztsYXN0UHJpY2VbaV09ajsgcmV0dXJuIHRydWU7fSAgIAogICAgICAgICAKCiAgICAgICAgZnVuY3Rpb24gYWNjZXB0VE9TKGFkZHJlc3MgYSxib29sIGIpICByZXR1cm5zKGJvb2wpewogICAgICAgIGlmKGIpaWYoIWJhblttc2cuc2VuZGVyXSl7VE9TW21zZy5zZW5kZXJdPXRydWU7YmFuW21zZy5zZW5kZXJdPWZhbHNlO30KICAgICAgICBpZihtc2cuc2VuZGVyPT1jb250cm9sbGVyKXtUT1NbYV09YjtiYW5bYV09IWI7bG9ncy5wdXNoKGxvZyhjb250cm9sbGVyLCJzZXRUT1MiLGEpKTt9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgIAogICAgICAgIGZ1bmN0aW9uIHRvdEJPVHMoKSBjb25zdGFudCByZXR1cm5zKHVpbnQsdWludCx1aW50LHVpbnQsdWludCkge3JldHVybiAgKHRvdEJPVFMsY2xhaW1lZCxzZWxsaW5nLGNvbXBhbmllcy5sZW5ndGgsdG90Q29tcGFuaWVzKTsgfQogICAgICAKCiAgICAgICAgZnVuY3Rpb24gZ2V0Qm90QmlsbGluZ0luZGV4KHVpbnQgaSx1aW50IGJpKSAgY29uc3RhbnQgcmV0dXJucyAodWludCl7CiAgICAgICAgcmV0dXJuIGJvdHNbaV0uYmlsbHNbYmldOwogICAgICAgIH0KCiAgICAgICAgICAgIAogICAgICAgIGZ1bmN0aW9uIGdldEJpbGwodWludCBpLHVpbnQgYmkpY29uc3RhbnQgcmV0dXJucyh1aW50LHVpbnQsdWludCx1aW50LHVpbnQsdWludCl7CiAgICAgICAgTWFya2V0QmlsbCBiPU1hcmtldEJpbGxzW2ldOwogICAgICAgIHJldHVybiAoYi5zZWxsZXJkYXRhLGIuYnV5ZXJkYXRhLGIucHJvZHVjdCxiLmluZGV4LGIuY29zdCxiLmJsb2NrKTsKICAgICAgICB9CiAgICAgICAgCgogICAgICAgIGZ1bmN0aW9uIGdldE5leHRTZWxsZXJCT1RkYXRhKHVpbnQgY3ljKSBjb25zdGFudCByZXR1cm5zICh1aW50LHVpbnQsc3RyaW5nKXtyZXR1cm4gKGN5Y2xlW2N5Y10uY3VycmVudFNlbGxlcixjeWNsZVtjeWNdLnNvbGQsY29tcGFuaWVzW2NvbXBhbnlJbmRleFtib3RzW2N5Y2xlW2N5Y10uY3VycmVudFNlbGxlcl0ub3duZXJdXSk7fQogICAKICAgICAgICBmdW5jdGlvbiBnZXRCb3QodWludCBpKSBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzLHN0cmluZyx1aW50LHVpbnQpewogICAgICAgIEJvdCBCPWJvdHNbaV07CiAgICAgICAgcmV0dXJuIChCLm93bmVyLEIuaW5mbyxCLmNvc3QsQi5uYmlsbHMpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZ2V0T3duZWRCb3QoYWRkcmVzcyBvd24sdWludCBiaW5kZXgpIGNvbnN0YW50IHJldHVybnModWludCl7cmV0dXJuIGJvdE93bmVyc1tvd25dW2JpbmRleF07fQogICAgICAKICAKICAgICAgICBmdW5jdGlvbiBnZXRCb3RTdGF0cyh1aW50IGksdWludCBqKSBjb25zdGFudCByZXR1cm5zICh1aW50KXsKICAgICAgICBCb3QgQj1ib3RzW2ldOwogICAgICAgIHJldHVybiBCLnNhbGVzW2pdO30KCgogICAgICAgIGZ1bmN0aW9uIGdldEZ1bGxDb21wYW55KGFkZHJlc3Mgdyx1aW50IGkpIGNvbnN0YW50IHJldHVybnMgKHN0cmluZyx1aW50LGJvb2wsdWludCx1aW50LHN0cmluZyxhZGRyZXNzKXtyZXR1cm4gKGNvbXBhbmllc1tjb21wYW55SW5kZXhbd11dLGJvdE93bmVyc1t3XS5sZW5ndGgsbWluZXJbd10sYmFsYW5jZXNbd10sdGhpcy5iYWxhbmNlLGNvbXBhbmllc1tpXSxjb21wYW55V2FsbGV0W2ldKTt9CgoKICAgICAgICBmdW5jdGlvbiBnZXRBY3RvckJpbGxYZGV0YWlsKGFkZHJlc3Mgdyx1aW50IGksYm9vbCB3aG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQsdWludCl7aWYod2hvKXtyZXR1cm4gKFNlbGxlcnNCaWxsc1t3XVtpXSxTZWxsZXJzQmlsbHNbd10ubGVuZ3RoKTt9ZWxzZXtyZXR1cm4gKEJ1eWVyc0JpbGxzW3ddW2ldLEJ1eWVyc0JpbGxzW3ddLmxlbmd0aCk7fX0KCiAgCiAgICAgICAgZnVuY3Rpb24gZ2V0SG9tZWFkdkluZGV4KHVpbnQgaW5kKSBjb25zdGFudCByZXR1cm5zICh1aW50KXtyZXR1cm4gaGFkdltpbmRdO30KCiAgICAgICAgZnVuY3Rpb24gZ2V0TGFzdFByaWNlKHVpbnQgaSkgY29uc3RhbnQgcmV0dXJucyAodWludCx1aW50LHVpbnQsdWludCx1aW50KXtyZXR1cm4gKGxhc3RQcmljZVtpXSxsYXN0UHJpY2VbbGFzdFByaWNlLmxlbmd0aC0xXSxzZWxsaW5nLG5NYmlsbHMsdG90YWwpO30KCgogICAgICAgIGZ1bmN0aW9uIHJlYWRMb2codWludCBpKWNvbnN0YW50IHJldHVybnMoYWRkcmVzcyxzdHJpbmcsYWRkcmVzcyl7bG9nIGw9bG9nc1tpXTtyZXR1cm4obC5hZG1pbixsLmFjdGlvbixsLmFkZHIpO30KICAgIAoKICAgICAgICBmdW5jdGlvbiBnZXRUT1MoYWRkcmVzcyBhKWNvbnN0YW50IHJldHVybnMoYm9vbCkge3JldHVybiBUT1NbYV07fQoKICAgICAgICAKICAgICAgICBmdW5jdGlvbiBvd25zKGFkZHJlc3MgYSkgY29uc3RhbnQgcmV0dXJucyAoYm9vbCl7cmV0dXJuIGJvdE93bmVyc1thXS5sZW5ndGg+MDt9CgoKICAgICAgICBmdW5jdGlvbiBnZXRDb2luKHVpbnQgbikgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcyxzdHJpbmcsdWludCx1aW50LHN0cmluZyxzdHJpbmcpIHsKICAgICAgICBDb2luIGMgPSBjb2luc1tuXTsKICAgICAgICByZXR1cm4gKGMuY29pbk93bmVyLGMuZGF0YSxjLmNvaW5UeXBlLGMucGxhdGYsYy5taW5lLGMuYWR2KTsgICAKICAgICAgICB9CgoKICAgICAgICBmdW5jdGlvbiBUcmFzaCh1aW50IG4pIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3Msc3RyaW5nLHVpbnQsdWludCxzdHJpbmcsc3RyaW5nKSB7CiAgICAgICAgaWYoKG1zZy5zZW5kZXI9PWNvbnRyb2xsZXIpfHwoZ2V0T3duZWRCb3QobXNnLnNlbmRlciwwKT4wKSkgICAgICAKICAgICAgICBDb2luIGMgPSB0cmFzaFtuXTsgICAKICAgICAgICByZXR1cm4gKGMuY29pbk93bmVyLGMuZGF0YSxjLmNvaW5UeXBlLGMucGxhdGYsYy5taW5lLGMuYWR2KTsgCiAgICAgICAgfQoKICAgICAgIAogICAgICAgIGZ1bmN0aW9uIGdldENvaW5TdGF0cyh1aW50IGkpIGNvbnN0YW50IHJldHVybnMgKHVpbnQsdWludCl7CiAgICAgICAgcmV0dXJuIChsaXN0ZWRbaV0sY29pbkluZGV4KTsgICAKICAgICAgICB9CiAgICAgICAKCiAgICAgICAgZnVuY3Rpb24gd2l0aGRyYXcoKXsKICAgICAgICBpZighVE9TW21zZy5zZW5kZXJdKXRocm93OwogICAgICAgIHVpbnQgdD1iYWxhbmNlc1ttc2cuc2VuZGVyXTsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXT0wOwogICAgICAgIGlmKCEobXNnLnNlbmRlci5zZW5kKHQpKSl0aHJvdzsKICAgICAgICB9CgoKICAgICAgICBmdW5jdGlvbiAoKXt0aHJvdzt9CgogfQoKCgoKCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCmNvbnRyYWN0IEFSS0NvbnRyb2xsZXJfMV8wMCB7CiAgICAvKiBDb25zdHJ1Y3RvciAqLwogICAgQVJLIEFyazsKCiAgICBldmVudCBDb2luU2VudCh1aW50IGluZGV4ZWQgaWQsYWRkcmVzcyBmcm9tLHN0cmluZyBuYW1lKTsKCiAgICBhZGRyZXNzIG93bmVyOwogICAgYWRkcmVzcyBTb3VyY2U7CgogICAgbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpYWRtaW5pc3RyYXRvcjsKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKW1vZHVsZTsKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBzdHJpbmcpYWRtaW5OYW1lOwoKICAgIG1hcHBpbmcodWludCA9PiBib29sKXJlc3RvcmU7CgovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIGxvZ1tdIGxvZ3M7CgogICAgc3RydWN0IGxvZ3sKICAgIGFkZHJlc3MgYWRtaW47CiAgICBzdHJpbmcgd2hhdDsKICAgIHVpbnQgaWQ7CiAgICBhZGRyZXNzIGE7CiAgICB9Ci8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgCiAgICBmdW5jdGlvbiBBUktDb250cm9sbGVyXzFfMDAoKSB7CiAgICBvd25lcj1tc2cuc2VuZGVyOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldE93bmVyKGFkZHJlc3MgYSxzdHJpbmcgbmFtZSkgewogICAgaWYobXNnLnNlbmRlcj09b3duZXIpb3duZXI9YTsKICAgIH0KCiAgICBmdW5jdGlvbiBiYW4oYWRkcmVzcyBhKSByZXR1cm5zKGJvb2wpewogICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEFkbWluaXN0cmF0b3IoYWRkcmVzcyBhLHN0cmluZyBuYW1lLGJvb2wgeWVzbm8pIHsKICAgIGlmKGlzTW9kdWxlKG1zZy5zZW5kZXIpKXsKICAgIGFkbWluaXN0cmF0b3JbYV09eWVzbm87CiAgICBhZG1pbk5hbWVbYV09bmFtZTsKICAgIAogICAgaWYobXNnLnNlbmRlcj09b3duZXIpbG9ncy5wdXNoKGxvZyhtc2cuc2VuZGVyLCJzZXRBZG1pbiIsMCxhKSk7CiAgICBpZihtc2cuc2VuZGVyIT1vd25lcilsb2dzLnB1c2gobG9nKG1zZy5zZW5kZXIsIm1vZHVsZVNldEFkbWluIiwwLGEpKTsKICAgIAogICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHNldE1vZHVsZShhZGRyZXNzIGEsYm9vbCB5ZXNubykgewogICAgaWYoIWlzTW9kdWxlKG1zZy5zZW5kZXIpKXRocm93OwogICAgbW9kdWxlW2FdPXllc25vOwogICAgbG9ncy5wdXNoKGxvZyhvd25lciwic2V0TW9kdWxlIiwwLGEpKTsKCiAgICB9CgogICAgZnVuY3Rpb24gc2V0UHJpY2UodWludCBpLHVpbnQgail7CiAgICBpZigoIWlzTW9kdWxlKG1zZy5zZW5kZXIpKXx8KGk+NikpdGhyb3c7CiAgICBBcmsuc2V0UHJpY2UoaSxqKTsKICAgIGxvZ3MucHVzaChsb2cobXNnLnNlbmRlciwic2V0UHJpY2UiLGksbXNnLnNlbmRlcikpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFRPUyhhZGRyZXNzIGEsYm9vbCBiKXsKICAgIGlmKCFpc01vZHVsZShtc2cuc2VuZGVyKSl0aHJvdzsKICAgIEFyay5hY2NlcHRUT1MoYSxiKTsKICAgIH0KCiAgICAKICAgIGZ1bmN0aW9uIHNldFNvdXJjZShhZGRyZXNzIGEpIHsKICAgIGlmKG1zZy5zZW5kZXIhPW93bmVyKXRocm93OwogICAgQXJrPUFSSyhhKTsgICAgCiAgICBTb3VyY2U9YTsKICAgIGxvZ3MucHVzaChsb2cobXNnLnNlbmRlciwic2V0U291cmNlIiwwLGEpKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRBUktvd25lcihhZGRyZXNzIGEpIHsKICAgIGlmKG1zZy5zZW5kZXIhPW93bmVyKXRocm93OwogICAgQXJrLmluaXRTdGF0cygiIixhLDMzMyk7CiAgICBsb2dzLnB1c2gobG9nKG1zZy5zZW5kZXIsInNldEFSS293bmVyIiwwLDB4MCkpOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlc3RvcmVJdGVtKHVpbnQgaSl7CiAgICBpZihpc0FkbWluKG1zZy5zZW5kZXIpfHxpc01vZHVsZShtc2cuc2VuZGVyKSl7CiAgICBBcmsuY2Vuc29yc2hpcChpLGZhbHNlLGZhbHNlKTsKICAgIGxvZ3MucHVzaChsb2cobXNnLnNlbmRlciwicmVzdG9yZSIsaSwweDApKTsKICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBhcHBseUNlbnNvcnNoaXAodWludCBpKXsKICAgIGlmKCFpc0FkbWluKG1zZy5zZW5kZXIpKXRocm93OwogICAgQXJrLmNlbnNvcnNoaXAoaSx0cnVlLGZhbHNlKTsKICAgIGxvZ3MucHVzaChsb2cobXNnLnNlbmRlciwiY2Vuc29yIixpLDB4MCkpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlbGV0ZUNvaW4odWludCBpKXsKICAgIGlmKCFpc01vZHVsZShtc2cuc2VuZGVyKSl0aHJvdzsKICAgIEFyay5jZW5zb3JzaGlwKGksdHJ1ZSx0cnVlKTsKICAgIGxvZ3MucHVzaChsb2cobXNnLnNlbmRlciwiY2Vuc29yIixpLDB4MCkpOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlZ2lzdGVyRXh0ZXJuYWxCaWxsKHVpbnQgYmksYWRkcmVzcyBzZWxsc05vdyxhZGRyZXNzIGJ1eWVyd2FsbGV0LHVpbnQgdGlwbyx1aW50IHNlbGwsdWludCBjKSBwcml2YXRlewogICAgaWYoIWlzTW9kdWxlKG1zZy5zZW5kZXIpKXRocm93OwogICAgQXJrLnJlZ2lzdGVyRXh0ZXJuYWxCaWxsKGJpLHNlbGxzTm93LGJ1eWVyd2FsbGV0LHRpcG8sc2VsbCxjKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwdXNoQ29pbih1aW50IGksYWRkcmVzcyBhLHN0cmluZyBzKSByZXR1cm5zKGJvb2wpewogICAgaWYobXNnLnNlbmRlciE9U291cmNlKXRocm93OwogICAgQ29pblNlbnQoaSxhLHMpOwogICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gaXNBZG1pbihhZGRyZXNzIGEpY29uc3RhbnQgcmV0dXJucyhib29sKXsKICAgIGJvb2wgYj1mYWxzZTsKICAgIGlmKChhPT1vd25lcil8fChhZG1pbmlzdHJhdG9yW2FdKSliPXRydWU7CiAgICByZXR1cm4gYjsKICAgIH0KCiAgICBmdW5jdGlvbiBpc01vZHVsZShhZGRyZXNzIGEpY29uc3RhbnQgcmV0dXJucyhib29sKXsKICAgIGJvb2wgYj1mYWxzZTsKICAgIGlmKChhPT1vd25lcil8fChtb2R1bGVbYV0pKWI9dHJ1ZTsKICAgIHJldHVybiBiOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEFkbWluTmFtZShhZGRyZXNzIGEpY29uc3RhbnQgcmV0dXJucyhzdHJpbmcpewogICAgcmV0dXJuIGFkbWluTmFtZVthXTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRTb3VyY2UoKWNvbnN0YW50IHJldHVybnMoYWRkcmVzcyl7CiAgICByZXR1cm4gU291cmNlOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlYWRMb2codWludCBpKWNvbnN0YW50IHJldHVybnMoc3RyaW5nLGFkZHJlc3Msc3RyaW5nLHVpbnQsYWRkcmVzcyl7CiAgICBsb2cgbD1sb2dzW2ldOwogICAgcmV0dXJuKGdldEFkbWluTmFtZShsLmFkbWluKSxsLmFkbWluLGwud2hhdCxsLmlkLGwuYSk7CiAgICB9CiAgICAKCn0='.
	

]
