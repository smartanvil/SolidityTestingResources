Class {
	#name : #SRT49ab5a64b3eaed6c2e2e46adc8ee7974e8e88de3,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT49ab5a64b3eaed6c2e2e46adc8ee7974e8e88de3 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7Ci8qKgogKiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIHVpbnQgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KZnVuY3Rpb24gZGl2KHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KICBmdW5jdGlvbiBzdWIodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KICBmdW5jdGlvbiBhZGQodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIHVpbnQgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9CiAgZnVuY3Rpb24gbWF4NjQodWludDY0IGEsIHVpbnQ2NCBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50NjQpIHsKICAgIHJldHVybiBhID49IGIgPyBhIDogYjsKICB9CiAgZnVuY3Rpb24gbWluNjQodWludDY0IGEsIHVpbnQ2NCBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50NjQpIHsKICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOwogIH0KICBmdW5jdGlvbiBtYXgyNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBhID49IGIgPyBhIDogYjsKICB9CiAgZnVuY3Rpb24gbWluMjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsKICB9CiAgZnVuY3Rpb24gYXNzZXJ0KGJvb2wgYXNzZXJ0aW9uKSBpbnRlcm5hbCB7CiAgICBpZiAoIWFzc2VydGlvbikgewogICAgICByZXZlcnQoKTsKICAgIH0KICB9Cn0KLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgY29uc3RhbnQgcmV0dXJucyAodWludCk7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludCB2YWx1ZSk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSk7Cn0KLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLiAKICovCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CgogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50KSBiYWxhbmNlczsKCiAgLyoqCiAgICogQGRldiBGaXggZm9yIHRoZSBFUkMyMCBzaG9ydCBhZGRyZXNzIGF0dGFjay4KICAgKi8KICBtb2RpZmllciBvbmx5UGF5bG9hZFNpemUodWludCBzaXplKSB7CiAgICAgaWYobXNnLmRhdGEubGVuZ3RoIDwgc2l6ZSArIDQpIHsKICAgICAgIHJldmVydCgpOwogICAgIH0KICAgICBfOwogIH0KCiAgLyoqCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSB7CiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4gCiAgKiBAcmV0dXJuIEFuIHVpbnQgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCgoKCi8qKgogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKi8KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCk7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludCB2YWx1ZSk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQgdmFsdWUpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOwp9CgoKCgovKioKICogQHRpdGxlIFN0YW5kYXJkIEVSQzIwIHRva2VuCiAqCiAqIEBkZXYgSW1wbGVtYW50YXRpb24gb2YgdGhlIGJhc2ljIHN0YW5kYXJ0IHRva2VuLgogKiBAZGV2IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgRmlyc3RCbG9vZDogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sCiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEJhc2ljVG9rZW4sIEVSQzIwIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpKSBhbGxvd2VkOwoKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludCB0aGUgYW1vdXQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMyAqIDMyKSB7CiAgICB2YXIgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOwoKICAgIC8vIENoZWNrIGlzIG5vdCBuZWVkZWQgYmVjYXVzZSBzdWIoX2FsbG93YW5jZSwgX3ZhbHVlKSB3aWxsIGFscmVhZHkgdGhyb3cgaWYgdGhpcyBjb25kaXRpb24gaXMgbm90IG1ldAogICAgLy8gaWYgKF92YWx1ZSA+IF9hbGxvd2FuY2UpIHJldmVydCgpOwoKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBfYWxsb3dhbmNlLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICB9CgogIC8qKgogICAqIEBkZXYgQXByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVhaGxmIG9mIG1zZy5zZW5kZXIuCiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkgewoKICAgIC8vIFRvIGNoYW5nZSB0aGUgYXBwcm92ZSBhbW91bnQgeW91IGZpcnN0IGhhdmUgdG8gcmVkdWNlIHRoZSBhZGRyZXNzZXNgCiAgICAvLyAgYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyBgYXBwcm92ZShfc3BlbmRlciwgMClgIGlmIGl0IGlzIG5vdAogICAgLy8gIGFscmVhZHkgMCB0byBtaXRpZ2F0ZSB0aGUgcmFjZSBjb25kaXRpb24gZGVzY3JpYmVkIGhlcmU6CiAgICAvLyAgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgIGlmICgoX3ZhbHVlICE9IDApICYmIChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSAhPSAwKSkgcmV2ZXJ0KCk7CgogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhbiBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQgc3BlY2lmaW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlbWFpbmluZykgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKfQoKCi8qKgogKiBAdGl0bGUgTGltaXRlZFRyYW5zZmVyVG9rZW4KICogQGRldiBMaW1pdGVkVHJhbnNmZXJUb2tlbiBkZWZpbmVzIHRoZSBnZW5lcmljIGludGVyZmFjZSBhbmQgdGhlIGltcGxlbWVudGF0aW9uIHRvIGxpbWl0IHRva2VuIAogKiB0cmFuc2ZlcmFiaWxpdHkgZm9yIGRpZmZlcmVudCBldmVudHMuIEl0IGlzIGludGVuZGVkIHRvIGJlIHVzZWQgYXMgYSBiYXNlIGNsYXNzIGZvciBvdGhlciB0b2tlbiAKICogY29udHJhY3RzLiAKICogTGltaXRlZFRyYW5zZmVyVG9rZW4gaGFzIGJlZW4gZGVzaWduZWQgdG8gYWxsb3cgZm9yIGRpZmZlcmVudCBsaW1pdGluZyBmYWN0b3JzLAogKiB0aGlzIGNhbiBiZSBhY2hpZXZlZCBieSByZWN1cnNpdmVseSBjYWxsaW5nIHN1cGVyLnRyYW5zZmVyYWJsZVRva2VucygpIHVudGlsIHRoZSBiYXNlIGNsYXNzIGlzIAogKiBoaXQuIEZvciBleGFtcGxlOgogKiAgICAgZnVuY3Rpb24gdHJhbnNmZXJhYmxlVG9rZW5zKGFkZHJlc3MgaG9sZGVyLCB1aW50NjQgdGltZSkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQyNTYpIHsKICogICAgICAgcmV0dXJuIG1pbjI1Nih1bmxvY2tlZFRva2Vucywgc3VwZXIudHJhbnNmZXJhYmxlVG9rZW5zKGhvbGRlciwgdGltZSkpOwogKiAgICAgfQogKiBBIHdvcmtpbmcgZXhhbXBsZSBpcyBWZXN0ZWRUb2tlbi5zb2w6CiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvYmxvYi9tYXN0ZXIvY29udHJhY3RzL3Rva2VuL1Zlc3RlZFRva2VuLnNvbAogKi8KCmNvbnRyYWN0IExpbWl0ZWRUcmFuc2ZlclRva2VuIGlzIEVSQzIwIHsKCiAgLyoqCiAgICogQGRldiBDaGVja3Mgd2hldGhlciBpdCBjYW4gdHJhbnNmZXIgb3Igb3RoZXJ3aXNlIHRocm93cy4KICAgKi8KICBtb2RpZmllciBjYW5UcmFuc2ZlcihhZGRyZXNzIF9zZW5kZXIsIHVpbnQgX3ZhbHVlKSB7CiAgIGlmIChfdmFsdWUgPiB0cmFuc2ZlcmFibGVUb2tlbnMoX3NlbmRlciwgdWludDY0KG5vdykpKSByZXZlcnQoKTsKICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgQ2hlY2tzIG1vZGlmaWVyIGFuZCBhbGxvd3MgdHJhbnNmZXIgaWYgdG9rZW5zIGFyZSBub3QgbG9ja2VkLgogICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2lldmUgdGhlIHRva2Vucy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgY2FuVHJhbnNmZXIobXNnLnNlbmRlciwgX3ZhbHVlKSB7CiAgICBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgfQoKICAvKioKICAqIEBkZXYgQ2hlY2tzIG1vZGlmaWVyIGFuZCBhbGxvd3MgdHJhbnNmZXIgaWYgdG9rZW5zIGFyZSBub3QgbG9ja2VkLgogICogQHBhcmFtIF9mcm9tIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCBzZW5kIHRoZSB0b2tlbnMuCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCByZWNpZXZlIHRoZSB0b2tlbnMuCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgY2FuVHJhbnNmZXIoX2Zyb20sIF92YWx1ZSkgewogICAgc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgfQoKICAvKioKICAgKiBAZGV2IERlZmF1bHQgdHJhbnNmZXJhYmxlIHRva2VucyBmdW5jdGlvbiByZXR1cm5zIGFsbCB0b2tlbnMgZm9yIGEgaG9sZGVyIChubyBsaW1pdCkuCiAgICogQGRldiBPdmVyd3JpdGluZyB0cmFuc2ZlcmFibGVUb2tlbnMoYWRkcmVzcyBob2xkZXIsIHVpbnQ2NCB0aW1lKSBpcyB0aGUgd2F5IHRvIHByb3ZpZGUgdGhlIAogICAqIHNwZWNpZmljIGxvZ2ljIGZvciBsaW1pdGluZyB0b2tlbiB0cmFuc2ZlcmFiaWxpdHkgZm9yIGEgaG9sZGVyIG92ZXIgdGltZS4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcmFibGVUb2tlbnMoYWRkcmVzcyBob2xkZXIsIHVpbnQ2NCB0aW1lKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGJhbGFuY2VPZihob2xkZXIpOwogIH0KfQoKCi8qKgogKiBAdGl0bGUgVmVzdGVkIHRva2VuCiAqIEBkZXYgVG9rZW5zIHRoYXQgY2FuIGJlIHZlc3RlZCBmb3IgYSBncm91cCBvZiBhZGRyZXNzZXMuCiAqLwpjb250cmFjdCBWZXN0ZWRUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBMaW1pdGVkVHJhbnNmZXJUb2tlbiB7CgogIHVpbnQyNTYgTUFYX0dSQU5UU19QRVJfQUREUkVTUyA9IDIwOwoKICBzdHJ1Y3QgVG9rZW5HcmFudCB7CiAgICBhZGRyZXNzIGdyYW50ZXI7ICAgICAvLyAyMCBieXRlcwogICAgdWludDI1NiB2YWx1ZTsgICAgICAgLy8gMzIgYnl0ZXMKICAgIHVpbnQ2NCBjbGlmZjsKICAgIHVpbnQ2NCB2ZXN0aW5nOwogICAgdWludDY0IHN0YXJ0OyAgICAgICAgLy8gMyAqIDggPSAyNCBieXRlcwogICAgYm9vbCByZXZva2FibGU7CiAgICBib29sIGJ1cm5zT25SZXZva2U7ICAvLyAyICogMSA9IDIgYml0cz8gb3IgMiBieXRlcz8KICB9IC8vIHRvdGFsIDc4IGJ5dGVzID0gMyBzc3RvcmUgcGVyIG9wZXJhdGlvbiAoMzIgcGVyIHNzdG9yZSkKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBUb2tlbkdyYW50W10pIHB1YmxpYyBncmFudHM7CgogIGV2ZW50IE5ld1Rva2VuR3JhbnQoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSwgdWludDI1NiBncmFudElkKTsKCiAgLyoqCiAgICogQGRldiBHcmFudCB0b2tlbnMgdG8gYSBzcGVjaWZpZWQgYWRkcmVzcwogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB0aGUgdG9rZW5zIHdpbGwgYmUgZ3JhbnRlZCB0by4KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgZ3JhbnRlZC4KICAgKiBAcGFyYW0gX3N0YXJ0IHVpbnQ2NCBUaW1lIG9mIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGdyYW50LgogICAqIEBwYXJhbSBfY2xpZmYgdWludDY0IFRpbWUgb2YgdGhlIGNsaWZmIHBlcmlvZC4KICAgKiBAcGFyYW0gX3Zlc3RpbmcgdWludDY0IFRoZSB2ZXN0aW5nIHBlcmlvZC4KICAgKi8KICBmdW5jdGlvbiBncmFudFZlc3RlZFRva2VucygKICAgIGFkZHJlc3MgX3RvLAogICAgdWludDI1NiBfdmFsdWUsCiAgICB1aW50NjQgX3N0YXJ0LAogICAgdWludDY0IF9jbGlmZiwKICAgIHVpbnQ2NCBfdmVzdGluZywKICAgIGJvb2wgX3Jldm9rYWJsZSwKICAgIGJvb2wgX2J1cm5zT25SZXZva2UKICApIHB1YmxpYyB7CgogICAgLy8gQ2hlY2sgZm9yIGRhdGUgaW5jb25zaXN0ZW5jaWVzIHRoYXQgbWF5IGNhdXNlIHVuZXhwZWN0ZWQgYmVoYXZpb3IKICAgIGlmIChfY2xpZmYgPCBfc3RhcnQgfHwgX3Zlc3RpbmcgPCBfY2xpZmYpIHsKICAgICAgcmV2ZXJ0KCk7CiAgICB9CgogICAgaWYgKHRva2VuR3JhbnRzQ291bnQoX3RvKSA+IE1BWF9HUkFOVFNfUEVSX0FERFJFU1MpIHJldmVydCgpOyAgIC8vIFRvIHByZXZlbnQgYSB1c2VyIGJlaW5nIHNwYW1tZWQgYW5kIGhhdmUgaGlzIGJhbGFuY2UgbG9ja2VkIChvdXQgb2YgZ2FzIGF0dGFjayB3aGVuIGNhbGN1bGF0aW5nIHZlc3RpbmcpLgoKICAgIHVpbnQgY291bnQgPSBncmFudHNbX3RvXS5wdXNoKAogICAgICAgICAgICAgICAgVG9rZW5HcmFudCgKICAgICAgICAgICAgICAgICAgX3Jldm9rYWJsZSA/IG1zZy5zZW5kZXIgOiAwLCAvLyBhdm9pZCBzdG9yaW5nIGFuIGV4dHJhIDIwIGJ5dGVzIHdoZW4gaXQgaXMgbm9uLXJldm9rYWJsZQogICAgICAgICAgICAgICAgICBfdmFsdWUsCiAgICAgICAgICAgICAgICAgIF9jbGlmZiwKICAgICAgICAgICAgICAgICAgX3Zlc3RpbmcsCiAgICAgICAgICAgICAgICAgIF9zdGFydCwKICAgICAgICAgICAgICAgICAgX3Jldm9rYWJsZSwKICAgICAgICAgICAgICAgICAgX2J1cm5zT25SZXZva2UKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICApOwoKICAgIHRyYW5zZmVyKF90bywgX3ZhbHVlKTsKCiAgICBOZXdUb2tlbkdyYW50KG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlLCBjb3VudCAtIDEpOwogIH0KCiAgLyoqCiAgICogQGRldiBSZXZva2UgdGhlIGdyYW50IG9mIHRva2VucyBvZiBhIHNwZWNpZmVkIGFkZHJlc3MuCiAgICogQHBhcmFtIF9ob2xkZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBoYXZlIGl0cyB0b2tlbnMgcmV2b2tlZC4KICAgKiBAcGFyYW0gX2dyYW50SWQgVGhlIGlkIG9mIHRoZSB0b2tlbiBncmFudC4KICAgKi8KICBmdW5jdGlvbiByZXZva2VUb2tlbkdyYW50KGFkZHJlc3MgX2hvbGRlciwgdWludCBfZ3JhbnRJZCkgcHVibGljIHsKICAgIFRva2VuR3JhbnQgZ3JhbnQgPSBncmFudHNbX2hvbGRlcl1bX2dyYW50SWRdOwoKICAgIGlmICghZ3JhbnQucmV2b2thYmxlKSB7IC8vIENoZWNrIGlmIGdyYW50IHdhcyByZXZva2FibGUKICAgICAgcmV2ZXJ0KCk7CiAgICB9CgogICAgaWYgKGdyYW50LmdyYW50ZXIgIT0gbXNnLnNlbmRlcikgeyAvLyBPbmx5IGdyYW50ZXIgY2FuIHJldm9rZSBpdAogICAgICByZXZlcnQoKTsKICAgIH0KCiAgICBhZGRyZXNzIHJlY2VpdmVyID0gZ3JhbnQuYnVybnNPblJldm9rZSA/IDB4ZGVhZCA6IG1zZy5zZW5kZXI7CgogICAgdWludDI1NiBub25WZXN0ZWQgPSBub25WZXN0ZWRUb2tlbnMoZ3JhbnQsIHVpbnQ2NChub3cpKTsKCiAgICAvLyByZW1vdmUgZ3JhbnQgZnJvbSBhcnJheQogICAgZGVsZXRlIGdyYW50c1tfaG9sZGVyXVtfZ3JhbnRJZF07CiAgICBncmFudHNbX2hvbGRlcl1bX2dyYW50SWRdID0gZ3JhbnRzW19ob2xkZXJdW2dyYW50c1tfaG9sZGVyXS5sZW5ndGguc3ViKDEpXTsKICAgIGdyYW50c1tfaG9sZGVyXS5sZW5ndGggLT0gMTsKCiAgICBiYWxhbmNlc1tyZWNlaXZlcl0gPSBiYWxhbmNlc1tyZWNlaXZlcl0uYWRkKG5vblZlc3RlZCk7CiAgICBiYWxhbmNlc1tfaG9sZGVyXSA9IGJhbGFuY2VzW19ob2xkZXJdLnN1Yihub25WZXN0ZWQpOwoKICAgIFRyYW5zZmVyKF9ob2xkZXIsIHJlY2VpdmVyLCBub25WZXN0ZWQpOwogIH0KCgogIC8qKgogICAqIEBkZXYgQ2FsY3VsYXRlIHRoZSB0b3RhbCBhbW91bnQgb2YgdHJhbnNmZXJhYmxlIHRva2VucyBvZiBhIGhvbGRlciBhdCBhIGdpdmVuIHRpbWUKICAgKiBAcGFyYW0gaG9sZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgb2YgdGhlIGhvbGRlcgogICAqIEBwYXJhbSB0aW1lIHVpbnQ2NCBUaGUgc3BlY2lmaWMgdGltZS4KICAgKiBAcmV0dXJuIEFuIHVpbnQgcmVwcmVzZW50aW5nIGEgaG9sZGVyJ3MgdG90YWwgYW1vdW50IG9mIHRyYW5zZmVyYWJsZSB0b2tlbnMuCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJhYmxlVG9rZW5zKGFkZHJlc3MgaG9sZGVyLCB1aW50NjQgdGltZSkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgZ3JhbnRJbmRleCA9IHRva2VuR3JhbnRzQ291bnQoaG9sZGVyKTsKCiAgICBpZiAoZ3JhbnRJbmRleCA9PSAwKSByZXR1cm4gYmFsYW5jZU9mKGhvbGRlcik7IC8vIHNob3J0Y3V0IGZvciBob2xkZXIgd2l0aG91dCBncmFudHMKCiAgICAvLyBJdGVyYXRlIHRocm91Z2ggYWxsIHRoZSBncmFudHMgdGhlIGhvbGRlciBoYXMsIGFuZCBhZGQgYWxsIG5vbi12ZXN0ZWQgdG9rZW5zCiAgICB1aW50MjU2IG5vblZlc3RlZCA9IDA7CiAgICBmb3IgKHVpbnQyNTYgaSA9IDA7IGkgPCBncmFudEluZGV4OyBpKyspIHsKICAgICAgbm9uVmVzdGVkID0gU2FmZU1hdGguYWRkKG5vblZlc3RlZCwgbm9uVmVzdGVkVG9rZW5zKGdyYW50c1tob2xkZXJdW2ldLCB0aW1lKSk7CiAgICB9CgogICAgLy8gQmFsYW5jZSAtIHRvdGFsTm9uVmVzdGVkIGlzIHRoZSBhbW91bnQgb2YgdG9rZW5zIGEgaG9sZGVyIGNhbiB0cmFuc2ZlciBhdCBhbnkgZ2l2ZW4gdGltZQogICAgdWludDI1NiB2ZXN0ZWRUcmFuc2ZlcmFibGUgPSBTYWZlTWF0aC5zdWIoYmFsYW5jZU9mKGhvbGRlciksIG5vblZlc3RlZCk7CgogICAgLy8gUmV0dXJuIHRoZSBtaW5pbXVtIG9mIGhvdyBtYW55IHZlc3RlZCBjYW4gdHJhbnNmZXIgYW5kIG90aGVyIHZhbHVlCiAgICAvLyBpbiBjYXNlIHRoZXJlIGFyZSBvdGhlciBsaW1pdGluZyB0cmFuc2ZlcmFiaWxpdHkgZmFjdG9ycyAoZGVmYXVsdCBpcyBiYWxhbmNlT2YpCiAgICByZXR1cm4gU2FmZU1hdGgubWluMjU2KHZlc3RlZFRyYW5zZmVyYWJsZSwgc3VwZXIudHJhbnNmZXJhYmxlVG9rZW5zKGhvbGRlciwgdGltZSkpOwogIH0KCiAgLyoqCiAgICogQGRldiBDaGVjayB0aGUgYW1vdW50IG9mIGdyYW50cyB0aGF0IGFuIGFkZHJlc3MgaGFzLgogICAqIEBwYXJhbSBfaG9sZGVyIFRoZSBob2xkZXIgb2YgdGhlIGdyYW50cy4KICAgKiBAcmV0dXJuIEEgdWludCByZXByZXNlbnRpbmcgdGhlIHRvdGFsIGFtb3VudCBvZiBncmFudHMuCiAgICovCiAgZnVuY3Rpb24gdG9rZW5HcmFudHNDb3VudChhZGRyZXNzIF9ob2xkZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgaW5kZXgpIHsKICAgIHJldHVybiBncmFudHNbX2hvbGRlcl0ubGVuZ3RoOwogIH0KCiAgLyoqCiAgICogQGRldiBDYWxjdWxhdGUgYW1vdW50IG9mIHZlc3RlZCB0b2tlbnMgYXQgYSBzcGVjaWZjIHRpbWUuCiAgICogQHBhcmFtIHRva2VucyB1aW50MjU2IFRoZSBhbW91bnQgb2YgdG9rZW5zIGdyYW50dGVkLgogICAqIEBwYXJhbSB0aW1lIHVpbnQ2NCBUaGUgdGltZSB0byBiZSBjaGVja2VkCiAgICogQHBhcmFtIHN0YXJ0IHVpbnQ2NCBBIHRpbWUgcmVwcmVzZW50aW5nIHRoZSBiZWdpbmluZyBvZiB0aGUgZ3JhbnQKICAgKiBAcGFyYW0gY2xpZmYgdWludDY0IFRoZSBjbGlmZiBwZXJpb2QuCiAgICogQHBhcmFtIHZlc3RpbmcgdWludDY0IFRoZSB2ZXN0aW5nIHBlcmlvZC4KICAgKiBAcmV0dXJuIEFuIHVpbnQgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb2YgdmVzdGVkIHRva2Vuc29mIGEgc3BlY2lmIGdyYW50LgogICAqICB0cmFuc2ZlcmFibGVUb2tlbnMKICAgKiAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgXy8tLS0tLS0tLSAgIHZlc3RlZFRva2VucyByZWN0CiAgICogICB8ICAgICAgICAgICAgICAgICAgICAgICBfLwogICAqICAgfCAgICAgICAgICAgICAgICAgICAgIF8vCiAgICogICB8ICAgICAgICAgICAgICAgICAgIF8vCiAgICogICB8ICAgICAgICAgICAgICAgICBfLwogICAqICAgfCAgICAgICAgICAgICAgICAvCiAgICogICB8ICAgICAgICAgICAgICAufAogICAqICAgfCAgICAgICAgICAgIC4gIHwKICAgKiAgIHwgICAgICAgICAgLiAgICB8CiAgICogICB8ICAgICAgICAuICAgICAgfAogICAqICAgfCAgICAgIC4gICAgICAgIHwKICAgKiAgIHwgICAgLiAgICAgICAgICB8CiAgICogICArPT09Kz09PT09PT09PT09Ky0tLS0tLS0tLSstLS0tLS0tLS0tPiB0aW1lCiAgICogICAgICBTdGFydCAgICAgICBDbGlmdCAgICBWZXN0aW5nCiAgICovCiAgZnVuY3Rpb24gY2FsY3VsYXRlVmVzdGVkVG9rZW5zKAogICAgdWludDI1NiB0b2tlbnMsCiAgICB1aW50MjU2IHRpbWUsCiAgICB1aW50MjU2IHN0YXJ0LAogICAgdWludDI1NiBjbGlmZiwKICAgIHVpbnQyNTYgdmVzdGluZykgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikKICAgIHsKICAgICAgLy8gU2hvcnRjdXRzIGZvciBiZWZvcmUgY2xpZmYgYW5kIGFmdGVyIHZlc3RpbmcgY2FzZXMuCiAgICAgIGlmICh0aW1lIDwgY2xpZmYpIHJldHVybiAwOwogICAgICBpZiAodGltZSA+PSB2ZXN0aW5nKSByZXR1cm4gdG9rZW5zOwoKICAgICAgLy8gSW50ZXJwb2xhdGUgYWxsIHZlc3RlZCB0b2tlbnMuCiAgICAgIC8vIEFzIGJlZm9yZSBjbGlmZiB0aGUgc2hvcnRjdXQgcmV0dXJucyAwLCB3ZSBjYW4gdXNlIGp1c3QgY2FsY3VsYXRlIGEgdmFsdWUKICAgICAgLy8gaW4gdGhlIHZlc3RpbmcgcmVjdCAoYXMgc2hvd24gaW4gYWJvdmUncyBmaWd1cmUpCgogICAgICAvLyB2ZXN0ZWRUb2tlbnMgPSB0b2tlbnMgKiAodGltZSAtIHN0YXJ0KSAvICh2ZXN0aW5nIC0gc3RhcnQpCiAgICAgIHVpbnQyNTYgdmVzdGVkVG9rZW5zID0gU2FmZU1hdGguZGl2KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTYWZlTWF0aC5tdWwoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW5zLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNhZmVNYXRoLnN1Yih0aW1lLCBzdGFydCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTYWZlTWF0aC5zdWIodmVzdGluZywgc3RhcnQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7CgogICAgICByZXR1cm4gdmVzdGVkVG9rZW5zOwogIH0KCiAgLyoqCiAgICogQGRldiBHZXQgYWxsIGluZm9ybWF0aW9uIGFib3V0IGEgc3BlY2lmYyBncmFudC4KICAgKiBAcGFyYW0gX2hvbGRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIGhhdmUgaXRzIHRva2VucyByZXZva2VkLgogICAqIEBwYXJhbSBfZ3JhbnRJZCBUaGUgaWQgb2YgdGhlIHRva2VuIGdyYW50LgogICAqIEByZXR1cm4gUmV0dXJucyBhbGwgdGhlIHZhbHVlcyB0aGF0IHJlcHJlc2VudCBhIFRva2VuR3JhbnQoYWRkcmVzcywgdmFsdWUsIHN0YXJ0LCBjbGlmZiwKICAgKiByZXZva2FiaWxpdHksIGJ1cm5zT25SZXZva2UsIGFuZCB2ZXN0aW5nKSBwbHVzIHRoZSB2ZXN0ZWQgdmFsdWUgYXQgdGhlIGN1cnJlbnQgdGltZS4KICAgKi8KICBmdW5jdGlvbiB0b2tlbkdyYW50KGFkZHJlc3MgX2hvbGRlciwgdWludCBfZ3JhbnRJZCkgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcyBncmFudGVyLCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IHZlc3RlZCwgdWludDY0IHN0YXJ0LCB1aW50NjQgY2xpZmYsIHVpbnQ2NCB2ZXN0aW5nLCBib29sIHJldm9rYWJsZSwgYm9vbCBidXJuc09uUmV2b2tlKSB7CiAgICBUb2tlbkdyYW50IGdyYW50ID0gZ3JhbnRzW19ob2xkZXJdW19ncmFudElkXTsKCiAgICBncmFudGVyID0gZ3JhbnQuZ3JhbnRlcjsKICAgIHZhbHVlID0gZ3JhbnQudmFsdWU7CiAgICBzdGFydCA9IGdyYW50LnN0YXJ0OwogICAgY2xpZmYgPSBncmFudC5jbGlmZjsKICAgIHZlc3RpbmcgPSBncmFudC52ZXN0aW5nOwogICAgcmV2b2thYmxlID0gZ3JhbnQucmV2b2thYmxlOwogICAgYnVybnNPblJldm9rZSA9IGdyYW50LmJ1cm5zT25SZXZva2U7CgogICAgdmVzdGVkID0gdmVzdGVkVG9rZW5zKGdyYW50LCB1aW50NjQobm93KSk7CiAgfQoKICAvKioKICAgKiBAZGV2IEdldCB0aGUgYW1vdW50IG9mIHZlc3RlZCB0b2tlbnMgYXQgYSBzcGVjaWZpYyB0aW1lLgogICAqIEBwYXJhbSBncmFudCBUb2tlbkdyYW50IFRoZSBncmFudCB0byBiZSBjaGVja2VkLgogICAqIEBwYXJhbSB0aW1lIFRoZSB0aW1lIHRvIGJlIGNoZWNrZWQKICAgKiBAcmV0dXJuIEFuIHVpbnQgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb2YgdmVzdGVkIHRva2VucyBvZiBhIHNwZWNpZmljIGdyYW50IGF0IGEgc3BlY2lmaWMgdGltZS4KICAgKi8KICBmdW5jdGlvbiB2ZXN0ZWRUb2tlbnMoVG9rZW5HcmFudCBncmFudCwgdWludDY0IHRpbWUpIHByaXZhdGUgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGNhbGN1bGF0ZVZlc3RlZFRva2VucygKICAgICAgZ3JhbnQudmFsdWUsCiAgICAgIHVpbnQyNTYodGltZSksCiAgICAgIHVpbnQyNTYoZ3JhbnQuc3RhcnQpLAogICAgICB1aW50MjU2KGdyYW50LmNsaWZmKSwKICAgICAgdWludDI1NihncmFudC52ZXN0aW5nKQogICAgKTsKICB9CgogIC8qKgogICAqIEBkZXYgQ2FsY3VsYXRlIHRoZSBhbW91bnQgb2Ygbm9uIHZlc3RlZCB0b2tlbnMgYXQgYSBzcGVjaWZpYyB0aW1lLgogICAqIEBwYXJhbSBncmFudCBUb2tlbkdyYW50IFRoZSBncmFudCB0byBiZSBjaGVja2VkLgogICAqIEBwYXJhbSB0aW1lIHVpbnQ2NCBUaGUgdGltZSB0byBiZSBjaGVja2VkCiAgICogQHJldHVybiBBbiB1aW50IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG9mIG5vbiB2ZXN0ZWQgdG9rZW5zIG9mIGEgc3BlY2lmYyBncmFudCBvbiB0aGUgCiAgICogcGFzc2VkIHRpbWUgZnJhbWUuCiAgICovCiAgZnVuY3Rpb24gbm9uVmVzdGVkVG9rZW5zKFRva2VuR3JhbnQgZ3JhbnQsIHVpbnQ2NCB0aW1lKSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBncmFudC52YWx1ZS5zdWIodmVzdGVkVG9rZW5zKGdyYW50LCB0aW1lKSk7CiAgfQoKICAvKioKICAgKiBAZGV2IENhbGN1bGF0ZSB0aGUgZGF0ZSB3aGVuIHRoZSBob2xkZXIgY2FuIHRyYXNmZXIgYWxsIGl0cyB0b2tlbnMKICAgKiBAcGFyYW0gaG9sZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgb2YgdGhlIGhvbGRlcgogICAqIEByZXR1cm4gQW4gdWludCByZXByZXNlbnRpbmcgdGhlIGRhdGUgb2YgdGhlIGxhc3QgdHJhbnNmZXJhYmxlIHRva2Vucy4KICAgKi8KICBmdW5jdGlvbiBsYXN0VG9rZW5Jc1RyYW5zZmVyYWJsZURhdGUoYWRkcmVzcyBob2xkZXIpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50NjQgZGF0ZSkgewogICAgZGF0ZSA9IHVpbnQ2NChub3cpOwogICAgdWludDI1NiBncmFudEluZGV4ID0gZ3JhbnRzW2hvbGRlcl0ubGVuZ3RoOwogICAgZm9yICh1aW50MjU2IGkgPSAwOyBpIDwgZ3JhbnRJbmRleDsgaSsrKSB7CiAgICAgIGRhdGUgPSBTYWZlTWF0aC5tYXg2NChncmFudHNbaG9sZGVyXVtpXS52ZXN0aW5nLCBkYXRlKTsKICAgIH0KICB9Cn0KCi8vIFFVRVNUSU9OUyBGT1IgQVVESVRPUlM6Ci8vIC0gQ29uc2lkZXJpbmcgd2UgaW5oZXJpdCBmcm9tIFZlc3RlZFRva2VuLCBob3cgbXVjaCBkb2VzIHRoYXQgaGl0IGF0IG91ciBnYXMgcHJpY2U/Ci8vIC0gRW5zdXJlIG1heCBzdXBwbHkgaXMgOTgsMDAwLDAwMAovLyAtIEVuc3VyZSB0aGF0IGV2ZW4gaWYgbm90IHRvdGFsU3VwcGx5IGlzIHNvbGQsIHRva2VucyB3b3VsZCBzdGlsbCBiZSB0cmFuc2ZlcnJhYmxlIGFmdGVyICh3ZSB3aWxsIHVwIHRvIHRvdGFsU3VwcGx5IGJ5IGNyZWF0aW5nIFdQWCB0b2tlbnMpCgovLyB2ZXN0aW5nOiAzNjUgZGF5cywgMzY1IGRheXMgLyA0IHZlc3RpbmcKCgpjb250cmFjdCBXUFhUb2tlbiBpcyBWZXN0ZWRUb2tlbiB7CiAgLy9GSUVMRFMKICBzdHJpbmcgcHVibGljIG5hbWUgPSAiV29ya1ByZXNzIjsgLy8oaW1wb3J0YW50IGlucHV0KQogIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIldQWCI7ICAgIC8vKGltcG9ydGFudCBpbnB1dCkKICB1aW50IHB1YmxpYyBkZWNpbWFscyA9IDQ7ICAgICAgICAvLyhpbXBvcnRhbnQgaW5wdXQpCi8vIE11bHRpcGxpZXIgZm9yIHRoZSBkZWNpbWFscwogIHVpbnQgcHJpdmF0ZSBjb25zdGFudCBERUNJTUFMUyA9IDEwMDAwOwogIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5ID0gOTgwMDAwMDAqREVDSU1BTFM7IC8vKGltcG9ydGFudCBpbnB1dCkKICAvL0NPTlNUQU5UUwogIC8vVGltZSBsaW1pdHMKICB1aW50IHB1YmxpYyBjb25zdGFudCBTVEFHRV9PTkVfVElNRV9FTkQgPSAzOCBkYXlzOyAvLyBmaXJzdCBkYXkgYm9udXMgKGltcG9ydGFudCBpbnB1dCkKICB1aW50IHB1YmxpYyBjb25zdGFudCBTVEFHRV9UV09fVElNRV9FTkQgPSA1OCBkYXlzOyAvLyBmaXJzdCB3ZWVrIGJvbnVzIChpbXBvcnRhbnQgaW5wdXQpCiAgdWludCBwdWJsaWMgY29uc3RhbnQgU1RBR0VfVEhSRUVfVElNRV9FTkQgPSA2OSBkYXlzOyAvLyhpbXBvcnRhbnQgaW5wdXQpCiAgCgogIC8vUHJpY2VzIG9mIFdQWAogIHVpbnQgcHVibGljIGNvbnN0YW50IFBSSUNFX1NUQU5EQVJEICAgID0gMjAwMCpERUNJTUFMUzsgLy8gV1BYIHJlY2VpdmVkIHBlciBvbmUgRVRIOyBBcHByb3hpbWF0ZWx5ICQwLjE1IGlmIEVUSCBwcmljZSAkMzAwLiBNQVhfU1VQUExZIC8gKHZhbHVhdGlvbiAvIGV0aFByaWNlKQogIHVpbnQgcHVibGljIGNvbnN0YW50IFBSSUNFX1NUQUdFX09ORSAgID0gUFJJQ0VfU1RBTkRBUkQgKiAxNTAvMTAwOyAgLy8gMUVUSCA9IDEwMCUgQm9udXMgMS41WCBvciA1MCUgMUVUSCA9IDMwMDAgV1BYIH4gJDAuMTAoaW1wb3J0YW50IGlucHV0KQogIHVpbnQgcHVibGljIGNvbnN0YW50IFBSSUNFX1NUQUdFX1RXTyAgID0gUFJJQ0VfU1RBTkRBUkQgKiAxMjUvMTAwOyAvLyAxRVRIID0gMjUlIElDTyBCb251cyAgICAgICAgICAgMUVUSCA9IDI1MDAgV1BYIH4gJDAuMTI1KGltcG9ydGFudCBpbnB1dCkKICB1aW50IHB1YmxpYyBjb25zdGFudCBQUklDRV9TVEFHRV9USFJFRSA9IFBSSUNFX1NUQU5EQVJEOyAJCQkvLyBTdGFuZGFyZCBQcmljZSBubyBib251cyAgICAgICAgIDFFVEggPSAyMDAwIFdQWCB+ICQwLjE1KGltcG9ydGFudCBpbnB1dCkKCiAgLy9XUFggVG9rZW4gTGltaXRzIAogIHVpbnQgcHVibGljIGNvbnN0YW50IEFMTE9DX1RFQU0gPSAgICAgICAgIDEwMDAwMDAwKkRFQ0lNQUxTOyAvLyB0ZWFtICsgYWR2aXNvcnMgdG8gbWFpbiBhZGRyZXNzIChpbXBvcnRhbnQgaW5wdXQpCiAgdWludCBwdWJsaWMgY29uc3RhbnQgQUxMT0NfQk9VTlRJRVMgPSAgICAgIDMwMDAwMDAqREVDSU1BTFM7IC8vIFJlc2VydmVkIEFkZHJlc3MgKGltcG9ydGFudCBpbnB1dCkKICB1aW50IHB1YmxpYyBjb25zdGFudCBBTExPQ19XSU5HUyA9ICAgICAgICAgNTAwMDAwMCpERUNJTUFMUzsgLy8gUmVzZXJ2ZWQgQWRkcmVzcyAoaW1wb3J0YW50IGlucHV0KQogIHVpbnQgcHVibGljIGNvbnN0YW50IEFMTE9DX0NST1dEU0FMRSA9ICAgIDgwMDAwMDAwKkRFQ0lNQUxTOyAvLyBDcm93ZHNhbGUgdG8gTWFpbiBhZGRyZXNzIChpbXBvcnRhbnQgaW5wdXQpCiAgCiAgdWludCBwdWJsaWMgY29uc3RhbnQgUFJFQlVZX1BPUlRJT05fTUFYID0gMjAwMDAwMDAqREVDSU1BTFM7IC8vIHRoaXMgaXMgcmVkdW5kYW50bHkgbW9yZSB0aGFuIHdoYXQgd2lsbCBiZSBwcmUtc29sZAogIAogIC8vQVNTSUdORUQgSU4gSU5JVElBTElaQVRJT04KICAvL1N0YXJ0IGFuZCBlbmQgdGltZXMKICB1aW50IHB1YmxpYyBwdWJsaWNTdGFydFRpbWU7IC8vIFRpbWUgaW4gc2Vjb25kcyBwdWJsaWMgY3Jvd2QgZnVuZCBzdGFydHMuCiAgdWludCBwdWJsaWMgcHJpdmF0ZVN0YXJ0VGltZTsgLy8gVGltZSBpbiBzZWNvbmRzIC0gYXQgdGhpcyB0aW1lIHRoZXJlIGlzIG5vIGludGVudGlvbiB0byBkbyBhIHByaXZhdGUgc2Vzc2lvbi4KICB1aW50IHB1YmxpYyBwdWJsaWNFbmRUaW1lOyAvLyBUaW1lIGluIHNlY29uZHMgY3Jvd2RzYWxlIGVuZHMKICB1aW50IHB1YmxpYyBoYXJkY2FwSW5FdGg7CgogIC8vU3BlY2lhbCBBZGRyZXNzZXMKICBhZGRyZXNzIHB1YmxpYyBtdWx0aXNpZ0FkZHJlc3M7IC8vIEFkZHJlc3MgdG8gd2hpY2ggYWxsIGV0aGVyIGZsb3dzLgogIGFkZHJlc3MgcHVibGljIHdweFRlYW1BZGRyZXNzOyAvLyBBZGRyZXNzIHRvIHdoaWNoIEFMTE9DX1RFQU0sIEFMTE9DX0JPVU5USUVTLCBBTExPQ19XSU5HUyBpcyAodWx0aW1hdGVseSkgc2VudCB0by4KICBhZGRyZXNzIHB1YmxpYyBvd25lckFkZHJlc3M7IC8vIEFkZHJlc3Mgb2YgdGhlIGNvbnRyYWN0IG93bmVyLiBDYW4gaGFsdCB0aGUgY3Jvd2RzYWxlLgogIGFkZHJlc3MgcHVibGljIHByZUJ1eTE7IC8vIEFkZHJlc3MgdXNlZCBieSBwcmUtYnV5CiAgYWRkcmVzcyBwdWJsaWMgcHJlQnV5MjsgLy8gQWRkcmVzcyB1c2VkIGJ5IHByZS1idXkKICBhZGRyZXNzIHB1YmxpYyBwcmVCdXkzOyAvLyBBZGRyZXNzIHVzZWQgYnkgcHJlLWJ1eQogIHVpbnQgcHVibGljIHByZUJ1eVByaWNlMTsgLy8gcHJpY2UgZm9yIHByZS1idXkKICB1aW50IHB1YmxpYyBwcmVCdXlQcmljZTI7IC8vIHByaWNlIGZvciBwcmUtYnV5CiAgdWludCBwdWJsaWMgcHJlQnV5UHJpY2UzOyAvLyBwcmljZSBmb3IgcHJlLWJ1eQoKICAvL1J1bm5pbmcgdG90YWxzCiAgdWludCBwdWJsaWMgZXRoZXJSYWlzZWQ7IC8vIFRvdGFsIEV0aGVyIHJhaXNlZC4KICB1aW50IHB1YmxpYyBXUFhTb2xkOyAvLyBUb3RhbCBXUFggY3JlYXRlZAogIHVpbnQgcHVibGljIHByZWJ1eVBvcnRpb25Ub3RhbDsgLy8gVG90YWwgb2YgVG9rZW5zIHB1cmNoYXNlZCBieSBwcmUtYnV5LiBOb3QgdG8gZXhjZWVkIFBSRUJVWV9QT1JUSU9OX01BWC4KICAKICAvL2Jvb2xlYW5zCiAgYm9vbCBwdWJsaWMgaGFsdGVkOyAvLyBoYWx0cyB0aGUgY3Jvd2Qgc2FsZSBpZiB0cnVlLgogIAogIC8vIE1PRElGSUVSUwogIC8vSXMgY3VycmVudGx5IGluIHRoZSBwZXJpb2QgYWZ0ZXIgdGhlIHByaXZhdGUgc3RhcnQgdGltZSBhbmQgYmVmb3JlIHRoZSBwdWJsaWMgc3RhcnQgdGltZS4KICBtb2RpZmllciBpc19wcmVfY3Jvd2RmdW5kX3BlcmlvZCgpIHsKICAgIGlmIChub3cgPj0gcHVibGljU3RhcnRUaW1lIHx8IG5vdyA8IHByaXZhdGVTdGFydFRpbWUpIHJldmVydCgpOwogICAgXzsKICB9CgogIC8vSXMgY3VycmVudGx5IHRoZSBjcm93ZGZ1bmQgcGVyaW9kCiAgbW9kaWZpZXIgaXNfY3Jvd2RmdW5kX3BlcmlvZCgpIHsKICAgIGlmIChub3cgPCBwdWJsaWNTdGFydFRpbWUpIHJldmVydCgpOwogICAgaWYgKGlzQ3Jvd2RmdW5kQ29tcGxldGVkKCkpIHJldmVydCgpOwogICAgXzsKICB9CgogIC8vIElzIGNvbXBsZXRlZAogIG1vZGlmaWVyIGlzX2Nyb3dkZnVuZF9jb21wbGV0ZWQoKSB7CiAgICBpZiAoIWlzQ3Jvd2RmdW5kQ29tcGxldGVkKCkpIHJldmVydCgpOwogICAgXzsKICB9CiAgZnVuY3Rpb24gaXNDcm93ZGZ1bmRDb21wbGV0ZWQoKSBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7CiAgICBpZiAobm93ID4gcHVibGljRW5kVGltZSB8fCBXUFhTb2xkKzUwMDAwKkRFQ0lNQUxTID49IEFMTE9DX0NST1dEU0FMRSB8fCBldGhlclJhaXNlZCA+PSBoYXJkY2FwSW5FdGgqMTAwMDAwMDAwMDAwMDAwMDAwMCkge3JldHVybiB0cnVlOyB9CgkKICAgIHJldHVybiBmYWxzZTsKICB9CgogIC8vTWF5IG9ubHkgYmUgY2FsbGVkIGJ5IHRoZSBvd25lciBhZGRyZXNzCiAgbW9kaWZpZXIgb25seV9vd25lcigpIHsKICAgIGlmIChtc2cuc2VuZGVyICE9IG93bmVyQWRkcmVzcykgcmV2ZXJ0KCk7CiAgICBfOwogIH0KCiAgLy9NYXkgb25seSBiZSBjYWxsZWQgaWYgdGhlIGNyb3dkZnVuZCBoYXMgbm90IGJlZW4gaGFsdGVkCiAgbW9kaWZpZXIgaXNfbm90X2hhbHRlZCgpIHsKICAgIGlmIChoYWx0ZWQpIHJldmVydCgpOwogICAgXzsKICB9CgogIC8vIEVWRU5UUwogIGV2ZW50IFByZUJ1eSh1aW50IF9hbW91bnQpOwogIGV2ZW50IEJ1eShhZGRyZXNzIGluZGV4ZWQgX3JlY2lwaWVudCwgdWludCBfYW1vdW50KTsKCiAgLy8gSW5pdGlhbGl6YXRpb24gY29udHJhY3QgYXNzaWducyBhZGRyZXNzIG9mIGNyb3dkZnVuZCBjb250cmFjdCBhbmQgZW5kIHRpbWUuCiAgZnVuY3Rpb24gV1BYVG9rZW4oCiAgICBhZGRyZXNzIF9tdWx0aXNpZywKICAgIGFkZHJlc3MgX3dweFRlYW0sCiAgICB1aW50IF9wdWJsaWNTdGFydFRpbWUsCiAgICB1aW50IF9wcml2YXRlU3RhcnRUaW1lLAogICAgdWludCBfaGFyZGNhcEluRXRoLAogICAgYWRkcmVzcyBfcHJlYnV5MSwgdWludCBfcHJlQnV5UHJpY2UxLAogICAgYWRkcmVzcyBfcHJlYnV5MiwgdWludCBfcHJlQnV5UHJpY2UyLAogICAgYWRkcmVzcyBfcHJlYnV5MywgdWludCBfcHJlQnV5UHJpY2UzCiAgKSB7CiAgICBvd25lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgcHVibGljU3RhcnRUaW1lID0gX3B1YmxpY1N0YXJ0VGltZTsKICAgIHByaXZhdGVTdGFydFRpbWUgPSBfcHJpdmF0ZVN0YXJ0VGltZTsKICAgIHB1YmxpY0VuZFRpbWUgPSBfcHVibGljU3RhcnRUaW1lICsgNjkgZGF5czsgLy8gKGltcG9ydGFudCBpbnB1dCkKICAgIG11bHRpc2lnQWRkcmVzcyA9IF9tdWx0aXNpZzsKICAgIHdweFRlYW1BZGRyZXNzID0gX3dweFRlYW07CgogICAgaGFyZGNhcEluRXRoID0gX2hhcmRjYXBJbkV0aDsKCiAgICBwcmVCdXkxID0gX3ByZWJ1eTE7CiAgICBwcmVCdXlQcmljZTEgPSBfcHJlQnV5UHJpY2UxOwogICAgcHJlQnV5MiA9IF9wcmVidXkyOwogICAgcHJlQnV5UHJpY2UyID0gX3ByZUJ1eVByaWNlMjsKICAgIHByZUJ1eTMgPSBfcHJlYnV5MzsKICAgIHByZUJ1eVByaWNlMyA9IF9wcmVCdXlQcmljZTM7CgogICAgYmFsYW5jZXNbd3B4VGVhbUFkZHJlc3NdICs9IEFMTE9DX0JPVU5USUVTOwogICAgYmFsYW5jZXNbd3B4VGVhbUFkZHJlc3NdICs9IEFMTE9DX1dJTkdTOwoKICAgIGJhbGFuY2VzW293bmVyQWRkcmVzc10gKz0gQUxMT0NfVEVBTTsKCiAgICBiYWxhbmNlc1tvd25lckFkZHJlc3NdICs9IEFMTE9DX0NST1dEU0FMRTsKICB9CgogIC8vIFRyYW5zZmVyIGFtb3VudCBvZiB0b2tlbnMgZnJvbSBzZW5kZXIgYWNjb3VudCB0byByZWNpcGllbnQuCiAgLy8gT25seSBjYWxsYWJsZSBhZnRlciB0aGUgY3Jvd2QgZnVuZCBpcyBjb21wbGV0ZWQKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpCiAgewogICAgaWYgKF90byA9PSBtc2cuc2VuZGVyKSByZXR1cm47IC8vIG5vLW9wLCBhbGxvdyBldmVuIGR1cmluZyBjcm93ZHNhbGUsIGluIG9yZGVyIHRvIHdvcmsgYXJvdW5kIHVzaW5nIGdyYW50VmVzdGVkVG9rZW5zKCkgd2hpbGUgaW4gY3Jvd2RzYWxlCiAgICBpZiAoIWlzQ3Jvd2RmdW5kQ29tcGxldGVkKCkpIHJldmVydCgpOwogICAgc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogIH0KCiAgLy8gVHJhbnNmZXIgYW1vdW50IG9mIHRva2VucyBmcm9tIGEgc3BlY2lmaWVkIGFkZHJlc3MgdG8gYSByZWNpcGllbnQuCiAgLy8gVHJhbnNmZXIgYW1vdW50IG9mIHRva2VucyBmcm9tIHNlbmRlciBhY2NvdW50IHRvIHJlY2lwaWVudC4KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKQogICAgaXNfY3Jvd2RmdW5kX2NvbXBsZXRlZAogIHsKICAgIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogIH0KCiAgLy9jb25zdGFudCBmdW5jdGlvbiByZXR1cm5zIHRoZSBjdXJyZW50IFdQWCBwcmljZS4KICBmdW5jdGlvbiBnZXRQcmljZVJhdGUoKQogICAgICBjb25zdGFudAogICAgICByZXR1cm5zICh1aW50IG9fcmF0ZSkKICB7CiAgICAgIHVpbnQgZGVsdGEgPSBTYWZlTWF0aC5zdWIobm93LCBwdWJsaWNTdGFydFRpbWUpOwoKICAgICAgaWYgKGRlbHRhID4gU1RBR0VfVFdPX1RJTUVfRU5EKSByZXR1cm4gUFJJQ0VfU1RBR0VfVEhSRUU7CiAgICAgIGlmIChkZWx0YSA+IFNUQUdFX09ORV9USU1FX0VORCkgcmV0dXJuIFBSSUNFX1NUQUdFX1RXTzsKCiAgICAgIHJldHVybiAoUFJJQ0VfU1RBR0VfT05FKTsKICB9CgogIC8vIGNhbGN1bGF0ZXMgd21vdW50IG9mIFdQWCB3ZSBnZXQsIGdpdmVuIHRoZSB3ZWkgYW5kIHRoZSByYXRlcyB3ZSd2ZSBkZWZpbmVkIHBlciAxIGV0aAogIGZ1bmN0aW9uIGNhbGNBbW91bnQodWludCBfd2VpLCB1aW50IF9yYXRlKSAKICAgIGNvbnN0YW50CiAgICByZXR1cm5zICh1aW50KSAKICB7CiAgICByZXR1cm4gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChfd2VpLCBfcmF0ZSksIDEgZXRoZXIpOwogIH0gCiAgCiAgLy8gR2l2ZW4gdGhlIHJhdGUgb2YgYSBwdXJjaGFzZSBhbmQgdGhlIHJlbWFpbmluZyB0b2tlbnMgaW4gdGhpcyB0cmFuY2hlLCBpdAogIC8vIHdpbGwgdGhyb3cgaWYgdGhlIHNhbGUgd291bGQgdGFrZSBpdCBwYXN0IHRoZSBsaW1pdCBvZiB0aGUgdHJhbmNoZS4KICAvLyBSZXR1cm5zIGBhbW91bnRgIGluIHNjb3BlIGFzIHRoZSBudW1iZXIgb2YgV1BYIHRva2VucyB0aGF0IGl0IHdpbGwgcHVyY2hhc2UuCiAgZnVuY3Rpb24gcHJvY2Vzc1B1cmNoYXNlKHVpbnQgX3JhdGUsIHVpbnQgX3JlbWFpbmluZykKICAgIGludGVybmFsCiAgICByZXR1cm5zICh1aW50IG9fYW1vdW50KQogIHsKICAgIG9fYW1vdW50ID0gY2FsY0Ftb3VudChtc2cudmFsdWUsIF9yYXRlKTsKCiAgICBpZiAob19hbW91bnQgPiBfcmVtYWluaW5nKSByZXZlcnQoKTsKICAgIGlmICghbXVsdGlzaWdBZGRyZXNzLnNlbmQobXNnLnZhbHVlKSkgcmV2ZXJ0KCk7CgogICAgYmFsYW5jZXNbb3duZXJBZGRyZXNzXSA9IGJhbGFuY2VzW293bmVyQWRkcmVzc10uc3ViKG9fYW1vdW50KTsKICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uYWRkKG9fYW1vdW50KTsKCiAgICBXUFhTb2xkICs9IG9fYW1vdW50OwogICAgZXRoZXJSYWlzZWQgKz0gbXNnLnZhbHVlOwogIH0KCiAgLy9TcGVjaWFsIEZ1bmN0aW9uIGNhbiBvbmx5IGJlIGNhbGxlZCBieSBwcmUtYnV5IGFuZCBvbmx5IGR1cmluZyB0aGUgcHJlLWNyb3dkc2FsZSBwZXJpb2QuCiAgZnVuY3Rpb24gcHJlQnV5KCkKICAgIHBheWFibGUKICAgIGlzX3ByZV9jcm93ZGZ1bmRfcGVyaW9kCiAgICBpc19ub3RfaGFsdGVkCiAgewogICAgLy8gUHJlLWJ1eSBwYXJ0aWNpcGFudHMgd291bGQgZ2V0IHRoZSBmaXJzdC1kYXkgcHJpY2UsIGFzIHdlbGwgYXMgYSBib251cyBvZiB2ZXN0ZWQgdG9rZW5zCiAgICB1aW50IHByaWNlVmVzdGVkID0gMDsKCiAgICBpZiAobXNnLnNlbmRlciA9PSBwcmVCdXkxKSBwcmljZVZlc3RlZCA9IHByZUJ1eVByaWNlMTsKICAgIGlmIChtc2cuc2VuZGVyID09IHByZUJ1eTIpIHByaWNlVmVzdGVkID0gcHJlQnV5UHJpY2UyOwogICAgaWYgKG1zZy5zZW5kZXIgPT0gcHJlQnV5MykgcHJpY2VWZXN0ZWQgPSBwcmVCdXlQcmljZTM7CgogICAgaWYgKHByaWNlVmVzdGVkID09IDApIHJldmVydCgpOwoKICAgIHVpbnQgYW1vdW50ID0gcHJvY2Vzc1B1cmNoYXNlKFBSSUNFX1NUQUdFX09ORSArIHByaWNlVmVzdGVkLCBTYWZlTWF0aC5zdWIoUFJFQlVZX1BPUlRJT05fTUFYLCBwcmVidXlQb3J0aW9uVG90YWwpKTsKICAgIGdyYW50VmVzdGVkVG9rZW5zKG1zZy5zZW5kZXIsIGNhbGNBbW91bnQobXNnLnZhbHVlLCBwcmljZVZlc3RlZCksIAogICAgICB1aW50NjQobm93KSwgdWludDY0KG5vdykgKyA5MSBkYXlzLCB1aW50NjQobm93KSArIDM2NSBkYXlzLCAKICAgICAgZmFsc2UsIGZhbHNlCiAgICApOwogICAgcHJlYnV5UG9ydGlvblRvdGFsICs9IGFtb3VudDsKICAgIFByZUJ1eShhbW91bnQpOwogIH0KCiAgLy9EZWZhdWx0IGZ1bmN0aW9uIGNhbGxlZCBieSBzZW5kaW5nIEV0aGVyIHRvIHRoaXMgYWRkcmVzcyB3aXRoIG5vIGFyZ3VtZW50cy4KICAvL1Jlc3VsdHMgaW4gY3JlYXRpb24gb2YgbmV3IFdQWCBUb2tlbnMgaWYgdHJhbnNhY3Rpb24gd291bGQgbm90IGV4Y2VlZCBoYXJkIGxpbWl0IG9mIFdQWCBUb2tlbi4KICBmdW5jdGlvbigpCiAgICBwYXlhYmxlCiAgICBpc19jcm93ZGZ1bmRfcGVyaW9kCiAgICBpc19ub3RfaGFsdGVkCiAgewogICAgdWludCBhbW91bnQgPSBwcm9jZXNzUHVyY2hhc2UoZ2V0UHJpY2VSYXRlKCksIFNhZmVNYXRoLnN1YihBTExPQ19DUk9XRFNBTEUsIFdQWFNvbGQpKTsKICAgIEJ1eShtc2cuc2VuZGVyLCBhbW91bnQpOwogIH0KCiAgLy8gVG8gYmUgY2FsbGVkIGF0IHRoZSBlbmQgb2YgY3Jvd2RmdW5kIHBlcmlvZAogIC8vIFdBUk5JTkc6IHRyYW5zZmVyKCksIHdoaWNoIGlzIGNhbGxlZCBieSBncmFudFZlc3RlZFRva2VucygpLCB3YW50cyBhIG1pbmltdW0gbWVzc2FnZSBsZW5ndGgKICBmdW5jdGlvbiBncmFudFZlc3RlZChhZGRyZXNzIF93cHhUZWFtQWRkcmVzcywgYWRkcmVzcyBfd3B4RnVuZEFkZHJlc3MpCiAgICBpc19jcm93ZGZ1bmRfY29tcGxldGVkCiAgICBvbmx5X293bmVyCiAgICBpc19ub3RfaGFsdGVkCiAgewogICAgLy8gR3JhbnQgdG9rZW5zIHByZS1hbGxvY2F0ZWQgZm9yIHRoZSB0ZWFtCiAgICBncmFudFZlc3RlZFRva2VucygKICAgICAgX3dweFRlYW1BZGRyZXNzLCBBTExPQ19URUFNLAogICAgICB1aW50NjQobm93KSwgdWludDY0KG5vdykgKyA5MSBkYXlzICwgdWludDY0KG5vdykgKyAzNjUgZGF5cywgCiAgICAgIGZhbHNlLCBmYWxzZQogICAgKTsKCiAgICAvLyBHcmFudCB0b2tlbnMgdGhhdCByZW1haW4gYWZ0ZXIgY3Jvd2RzYWxlIHRvIHRoZSBXUFggZnVuZCwgdmVzdGVkIGZvciAyIHllYXJzCiAgICBncmFudFZlc3RlZFRva2VucygKICAgICAgX3dweEZ1bmRBZGRyZXNzLCBiYWxhbmNlc1tvd25lckFkZHJlc3NdLAogICAgICB1aW50NjQobm93KSwgdWludDY0KG5vdykgKyAxODIgZGF5cyAsIHVpbnQ2NChub3cpICsgNzMwIGRheXMsIAogICAgICBmYWxzZSwgZmFsc2UKICAgICk7CiAgfQoKICAvL01heSBiZSB1c2VkIGJ5IG93bmVyIG9mIGNvbnRyYWN0IHRvIGhhbHQgY3Jvd2RzYWxlIGFuZCBubyBsb25nZXIgZXhjZXB0IGV0aGVyLgogIGZ1bmN0aW9uIHRvZ2dsZUhhbHQoYm9vbCBfaGFsdGVkKQogICAgb25seV9vd25lcgogIHsKICAgIGhhbHRlZCA9IF9oYWx0ZWQ7CiAgfQoKICAvL2ZhaWxzYWZlIGRyYWluCiAgZnVuY3Rpb24gZHJhaW4oKQogICAgb25seV9vd25lcgogIHsKICAgIGlmICghb3duZXJBZGRyZXNzLnNlbmQodGhpcy5iYWxhbmNlKSkgcmV2ZXJ0KCk7CiAgfQp9'.
	

]
