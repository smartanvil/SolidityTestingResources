Class {
	#name : #SRTB5e4Ebe6CE2c46327F725659F3B7E63A7f89c9F4,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTB5e4Ebe6CE2c46327F725659F3B7E63A7f89c9F4 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKCmNvbnRyYWN0IERvZ3MgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogIC8qKiogRVZFTlRTICoqKi8KICAvLy8gQGRldiBUaGUgQmlydGggZXZlbnQgaXMgZmlyZWQgd2hlbmV2ZXIgYSBuZXcgY29sbGVjdGlibGUgY29tZXMgaW50byBleGlzdGVuY2UuCiAgZXZlbnQgQmlydGgodWludDI1NiB0b2tlbklkLCB1aW50MjU2IHN0YXJ0UHJpY2UpOwogIC8vLyBAZGV2IFRoZSBUb2tlblNvbGQgZXZlbnQgaXMgZmlyZWQgd2hlbmV2ZXIgYSB0b2tlbiBpcyBzb2xkLgogIGV2ZW50IFRva2VuU29sZCh1aW50MjU2IGluZGV4ZWQgdG9rZW5JZCwgdWludDI1NiBwcmljZSwgYWRkcmVzcyBwcmV2T3duZXIsIGFkZHJlc3Mgd2lubmVyKTsKICAvLyBFUkM3MjEgVHJhbnNmZXIKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHRva2VuSWQpOwogIC8vIEVSQzcyMSBBcHByb3ZhbAogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIGFwcHJvdmVkLCB1aW50MjU2IHRva2VuSWQpOwoKICAvKioqIENPTlNUQU5UUyAqKiovCgogIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgTkFNRSA9ICJkb2dzLXlvdUNvbGxlY3QiOwogIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgU1lNQk9MID0gIkRZQyI7CiAgdWludDI1NltdIHByaXZhdGUgdG9rZW5zOwoKICAvKioqIFNUT1JBR0UgKioqLwoKICAvLy8gQGRldiBBIG1hcHBpbmcgZnJvbSBjb2xsZWN0aWJsZSBJRHMgdG8gdGhlIGFkZHJlc3MgdGhhdCBvd25zIHRoZW0uIEFsbCBjb2xsZWN0aWJsZXMgaGF2ZQogIC8vLyAgc29tZSB2YWxpZCBvd25lciBhZGRyZXNzLgogIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgcHVibGljIGNvbGxlY3RpYmxlSW5kZXhUb093bmVyOwoKICAvLy8gQGRldiBBIG1hcHBpbmcgZnJvbSBDb2xsZWN0aWJsZUlEcyB0byBhbiBhZGRyZXNzIHRoYXQgaGFzIGJlZW4gYXBwcm92ZWQgdG8gY2FsbAogIC8vLyAgdHJhbnNmZXJGcm9tKCkuIEVhY2ggQ29sbGVjdGlibGUgY2FuIG9ubHkgaGF2ZSBvbmUgYXBwcm92ZWQgYWRkcmVzcyBmb3IgdHJhbnNmZXIKICAvLy8gIGF0IGFueSB0aW1lLiBBIHplcm8gdmFsdWUgbWVhbnMgbm8gYXBwcm92YWwgaXMgb3V0c3RhbmRpbmcuCiAgbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSBwdWJsaWMgY29sbGVjdGlibGVJbmRleFRvQXBwcm92ZWQ7CgogIC8vIEBkZXYgQSBtYXBwaW5nIGZyb20gQ29sbGVjdGlibGVJRHMgdG8gdGhlIHByaWNlIG9mIHRoZSB0b2tlbi4KICBtYXBwaW5nICh1aW50MjU2ID0+IHVpbnQyNTYpIHB1YmxpYyBjb2xsZWN0aWJsZUluZGV4VG9QcmljZTsKCiAgLy8gVGhlIGFkZHJlc3NlcyBvZiB0aGUgYWNjb3VudHMgKG9yIGNvbnRyYWN0cykgdGhhdCBjYW4gZXhlY3V0ZSBhY3Rpb25zIHdpdGhpbiBlYWNoIHJvbGVzLgogIGFkZHJlc3MgcHVibGljIGNlb0FkZHJlc3M7CiAgYWRkcmVzcyBwdWJsaWMgY29vQWRkcmVzczsKCiAgbWFwcGluZyAodWludCA9PiBhZGRyZXNzKSBwcml2YXRlIHN1YlRva2VuQ3JlYXRvcjsKICBtYXBwaW5nICh1aW50ID0+IGFkZHJlc3MpIHByaXZhdGUgbGFzdFN1YlRva2VuQnV5ZXI7CiAgbWFwcGluZyAodWludCA9PiBib29sKSBwcml2YXRlIHVubG9ja2VkOwoKICB1aW50OCBjb25zdGFudCBCQVNFX1RPS0VOX0lEID0gMDsKICB1aW50MTYgY29uc3RhbnQgTUFYX1NFVFNfSU5ERVggPSAxMDAwMDsKICB1aW50NjQgY29uc3RhbnQgRklGVFlfVE9LRU5TX0lOREVYID0gMTAwMDAwMDAwMDAwMDAwMDsKICB1aW50MTI4IGNvbnN0YW50IFRSSUJMRV9UT0tFTlNfSU5ERVggPSAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA7CiAgdWludDEyOCBjb25zdGFudCBET1VCTEVfVE9LRU5TX0lOREVYID0gMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwOwogIHVpbnQyNTYgcHJpdmF0ZSBjb25zdGFudCBQUk9NT19DUkVBVElPTl9MSU1JVCA9IDUwMDAwOwogIHVpbnQyNTYgcHVibGljIHByb21vQ3JlYXRlZENvdW50OwogIHVpbnQyNTYgY29uc3RhbnQgU1RBUlRfUFJJQ0VfRE9HID0gMSBmaW5uZXk7CiAgdWludDI1NiBjb25zdGFudCBTVEFSVF9QUklDRV9TRVRTID0gMTAwIGZpbm5leTsKICB1aW50MjU2IGNvbnN0YW50IFNUQVJUX1BSSUNFX0JBU0VfRE9HID0gMTAgZXRoZXI7CgoKICAvKioqIENPTlNUUlVDVE9SICoqKi8KICBmdW5jdGlvbiBEb2dzKCkgcHVibGljIHsKICAgIGNlb0FkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgY29vQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgfQogIGZ1bmN0aW9uIGdldFRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgcmV0dXJuIHRva2Vucy5sZW5ndGg7CiAgfQogIGZ1bmN0aW9uIGdldEluaXRpYWxQcmljZU9mVG9rZW4odWludCBfdG9rZW5JZCkgcHVibGljIHB1cmUgcmV0dXJucyAodWludCkgewogICAgaWYgKF90b2tlbklkID4gTUFYX1NFVFNfSU5ERVgpCiAgICAgIHJldHVybiBTVEFSVF9QUklDRV9ET0c7CiAgICBpZiAoX3Rva2VuSWQgPiAwKQogICAgICByZXR1cm4gU1RBUlRfUFJJQ0VfU0VUUzsKICAgIHJldHVybiBTVEFSVF9QUklDRV9CQVNFX0RPRzsKICB9CgogIGZ1bmN0aW9uIGdldE5leHRQcmljZSh1aW50IHByaWNlLCB1aW50IF90b2tlbklkKSBwdWJsaWMgcHVyZSByZXR1cm5zICh1aW50KSB7CiAgICBpZiAoX3Rva2VuSWQ+RE9VQkxFX1RPS0VOU19JTkRFWCkKICAgICAgcmV0dXJuIHByaWNlLm11bCgyKTsKICAgIGlmIChfdG9rZW5JZD5UUklCTEVfVE9LRU5TX0lOREVYKQogICAgICByZXR1cm4gcHJpY2UubXVsKDMpOwogICAgaWYgKF90b2tlbklkPkZJRlRZX1RPS0VOU19JTkRFWCkKICAgICAgcmV0dXJuIHByaWNlLm11bCgzKS5kaXYoMik7CiAgICBpZiAocHJpY2UgPCAxLjIgZXRoZXIpCiAgICAgIHJldHVybiBwcmljZS5tdWwoMjAwKS5kaXYoOTIpOwogICAgaWYgKHByaWNlIDwgNSBldGhlcikKICAgICAgcmV0dXJuIHByaWNlLm11bCgxNTApLmRpdig5Mik7CiAgICByZXR1cm4gcHJpY2UubXVsKDEyMCkuZGl2KDkyKTsKICB9CgogIGZ1bmN0aW9uIGJ1eVRva2VuKHVpbnQgX3Rva2VuSWQpIHB1YmxpYyBwYXlhYmxlIHsKICAgIGFkZHJlc3Mgb2xkT3duZXIgPSBjb2xsZWN0aWJsZUluZGV4VG9Pd25lcltfdG9rZW5JZF07CiAgICByZXF1aXJlKG9sZE93bmVyIT1tc2cuc2VuZGVyKTsKICAgIHVpbnQyNTYgc2VsbGluZ1ByaWNlID0gY29sbGVjdGlibGVJbmRleFRvUHJpY2VbX3Rva2VuSWRdOwogICAgaWYgKHNlbGxpbmdQcmljZT09MCkgewogICAgICBzZWxsaW5nUHJpY2UgPSBnZXRJbml0aWFsUHJpY2VPZlRva2VuKF90b2tlbklkKTsKICAgICAgaWYgKF90b2tlbklkPk1BWF9TRVRTX0lOREVYKQogICAgICAgIHN1YlRva2VuQ3JlYXRvcltfdG9rZW5JZF0gPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIHJlcXVpcmUobXNnLnZhbHVlID49IHNlbGxpbmdQcmljZSk7CiAgICB1aW50MjU2IHB1cmNoYXNlRXhjZXNzID0gbXNnLnZhbHVlLnN1YihzZWxsaW5nUHJpY2UpOwoKICAgIHVpbnQyNTYgcGF5bWVudCA9IHNlbGxpbmdQcmljZS5tdWwoOTIpLmRpdigxMDApOwogICAgdWludDI1NiBmZWVPbmNlID0gc2VsbGluZ1ByaWNlLnN1YihwYXltZW50KS5kaXYoOCk7CgogICAgLy8gdHJhbnNmZXIgdGF4ZXMKICAgIGlmIChfdG9rZW5JZCA+IDApIHsKICAgICAgaWYgKGNvbGxlY3RpYmxlSW5kZXhUb093bmVyW0JBU0VfVE9LRU5fSURdIT1hZGRyZXNzKDApKQogICAgICAgIGNvbGxlY3RpYmxlSW5kZXhUb093bmVyW0JBU0VfVE9LRU5fSURdLnRyYW5zZmVyKGZlZU9uY2UpOwogICAgICBpZiAoX3Rva2VuSWQgPiBNQVhfU0VUU19JTkRFWCkgewogICAgICAgIGlmIChjb2xsZWN0aWJsZUluZGV4VG9Pd25lcltfdG9rZW5JZCAlIE1BWF9TRVRTX0lOREVYXSE9YWRkcmVzcygwKSkKICAgICAgICAgIGNvbGxlY3RpYmxlSW5kZXhUb093bmVyW190b2tlbklkICUgTUFYX1NFVFNfSU5ERVhdLnRyYW5zZmVyKGZlZU9uY2UpOwogICAgICAgIGlmIChzdWJUb2tlbkNyZWF0b3JbX3Rva2VuSWRdIT1hZGRyZXNzKDApKQogICAgICAgICAgc3ViVG9rZW5DcmVhdG9yW190b2tlbklkXS50cmFuc2ZlcihmZWVPbmNlKTsKCiAgICAgICAgaWYgKHVubG9ja2VkW190b2tlbklkXSkgewogICAgICAgICAgbGFzdFN1YlRva2VuQnV5ZXJbQkFTRV9UT0tFTl9JRF0gPSBtc2cuc2VuZGVyOwogICAgICAgICAgbGFzdFN1YlRva2VuQnV5ZXJbX3Rva2VuSWQgJSBNQVhfU0VUU19JTkRFWF0gPSBtc2cuc2VuZGVyOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBsYXN0U3ViVG9rZW5CdXllcltfdG9rZW5JZF0udHJhbnNmZXIoZmVlT25jZSoyKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgbGFzdFN1YlRva2VuQnV5ZXJbX3Rva2VuSWRdLnRyYW5zZmVyKGZlZU9uY2UqMik7CiAgICB9CiAgICAvLyBUcmFuc2ZlcnMgdGhlIFRva2VuCiAgICBjb2xsZWN0aWJsZUluZGV4VG9Pd25lcltfdG9rZW5JZF0gPSBtc2cuc2VuZGVyOwogICAgaWYgKG9sZE93bmVyICE9IGFkZHJlc3MoMCkpIHsKICAgICAgLy8gUGF5bWVudCBmb3Igb2xkIG93bmVyCiAgICAgIG9sZE93bmVyLnRyYW5zZmVyKHBheW1lbnQpOwogICAgICAvLyBjbGVhciBhbnkgcHJldmlvdXNseSBhcHByb3ZlZCBvd25lcnNoaXAgZXhjaGFuZ2UKICAgICAgZGVsZXRlIGNvbGxlY3RpYmxlSW5kZXhUb0FwcHJvdmVkW190b2tlbklkXTsKICAgIH0gZWxzZSB7CiAgICAgIEJpcnRoKF90b2tlbklkLCBzZWxsaW5nUHJpY2UpOwogICAgICB0b2tlbnMucHVzaChfdG9rZW5JZCk7CiAgICB9CiAgICAvLyBVcGRhdGUgcHJpY2VzCiAgICBjb2xsZWN0aWJsZUluZGV4VG9QcmljZVtfdG9rZW5JZF0gPSBnZXROZXh0UHJpY2Uoc2VsbGluZ1ByaWNlLCBfdG9rZW5JZCk7CgogICAgVG9rZW5Tb2xkKF90b2tlbklkLCBzZWxsaW5nUHJpY2UsIG9sZE93bmVyLCBtc2cuc2VuZGVyKTsKICAgIFRyYW5zZmVyKG9sZE93bmVyLCBtc2cuc2VuZGVyLCBfdG9rZW5JZCk7CiAgICAvLyByZWZ1bmQgd2hlbiBwYWlkIHRvbyBtdWNoCiAgICBpZiAocHVyY2hhc2VFeGNlc3M+MCkKICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihwdXJjaGFzZUV4Y2Vzcyk7CiAgfQoKCgogIC8qKiogQUNDRVNTIE1PRElGSUVSUyAqKiovCiAgLy8vIEBkZXYgQWNjZXNzIG1vZGlmaWVyIGZvciBDRU8tb25seSBmdW5jdGlvbmFsaXR5CiAgbW9kaWZpZXIgb25seUNFTygpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjZW9BZGRyZXNzKTsKICAgIF87CiAgfQoKICAvLy8gQGRldiBBY2Nlc3MgbW9kaWZpZXIgZm9yIENPTy1vbmx5IGZ1bmN0aW9uYWxpdHkKICBtb2RpZmllciBvbmx5Q09PKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNvb0FkZHJlc3MpOwogICAgXzsKICB9CgogIC8vLyBBY2Nlc3MgbW9kaWZpZXIgZm9yIGNvbnRyYWN0IG93bmVyIG9ubHkgZnVuY3Rpb25hbGl0eQogIG1vZGlmaWVyIG9ubHlDTGV2ZWwoKSB7CiAgICByZXF1aXJlKAogICAgICBtc2cuc2VuZGVyID09IGNlb0FkZHJlc3MgfHwKICAgICAgbXNnLnNlbmRlciA9PSBjb29BZGRyZXNzCiAgICApOwogICAgXzsKICB9CgogIC8qKiogUFVCTElDIEZVTkNUSU9OUyAqKiovCiAgLy8vIEBub3RpY2UgR3JhbnQgYW5vdGhlciBhZGRyZXNzIHRoZSByaWdodCB0byB0cmFuc2ZlciB0b2tlbiB2aWEgdGFrZU93bmVyc2hpcCgpIGFuZCB0cmFuc2ZlckZyb20oKS4KICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byBiZSBncmFudGVkIHRyYW5zZmVyIGFwcHJvdmFsLiBQYXNzIGFkZHJlc3MoMCkgdG8KICAvLy8gIGNsZWFyIGFsbCBhcHByb3ZhbHMuCiAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgSUQgb2YgdGhlIFRva2VuIHRoYXQgY2FuIGJlIHRyYW5zZmVycmVkIGlmIHRoaXMgY2FsbCBzdWNjZWVkcy4KICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIGFwcHJvdmUoCiAgICBhZGRyZXNzIF90bywKICAgIHVpbnQyNTYgX3Rva2VuSWQKICApIHB1YmxpYyB7CiAgICAvLyBDYWxsZXIgbXVzdCBvd24gdG9rZW4uCiAgICByZXF1aXJlKF9vd25zKG1zZy5zZW5kZXIsIF90b2tlbklkKSk7CgogICAgY29sbGVjdGlibGVJbmRleFRvQXBwcm92ZWRbX3Rva2VuSWRdID0gX3RvOwoKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF90bywgX3Rva2VuSWQpOwogIH0KCiAgLy8vIEBkZXYgQ3JlYXRlcyBhIG5ldyBwcm9tbyBjb2xsZWN0aWJsZSB3aXRoIHRoZSBnaXZlbiBuYW1lLCB3aXRoIGdpdmVuIF9wcmljZSBhbmQgYXNzaWduZXMgaXQgdG8gYW4gYWRkcmVzcy4KICBmdW5jdGlvbiBjcmVhdGVQcm9tb0NvbGxlY3RpYmxlKHVpbnQyNTYgdG9rZW5JZCwgYWRkcmVzcyBfb3duZXIsIHVpbnQyNTYgX3ByaWNlKSBwdWJsaWMgb25seUNPTyB7CiAgICByZXF1aXJlKGNvbGxlY3RpYmxlSW5kZXhUb093bmVyW3Rva2VuSWRdPT1hZGRyZXNzKDApKTsKICAgIHJlcXVpcmUocHJvbW9DcmVhdGVkQ291bnQgPCBQUk9NT19DUkVBVElPTl9MSU1JVCk7CgogICAgYWRkcmVzcyBjb2xsZWN0aWJsZU93bmVyID0gX293bmVyOwogICAgaWYgKGNvbGxlY3RpYmxlT3duZXIgPT0gYWRkcmVzcygwKSkgewogICAgICBjb2xsZWN0aWJsZU93bmVyID0gY29vQWRkcmVzczsKICAgIH0KCiAgICBpZiAoX3ByaWNlIDw9IDApIHsKICAgICAgX3ByaWNlID0gZ2V0SW5pdGlhbFByaWNlT2ZUb2tlbih0b2tlbklkKTsKICAgIH0KCiAgICBwcm9tb0NyZWF0ZWRDb3VudCsrOwogICAgX2NyZWF0ZUNvbGxlY3RpYmxlKHRva2VuSWQsIF9wcmljZSk7CiAgICBzdWJUb2tlbkNyZWF0b3JbdG9rZW5JZF0gPSBjb2xsZWN0aWJsZU93bmVyOwogICAgdW5sb2NrZWRbdG9rZW5JZF0gPSB0cnVlOwogICAgLy8gVGhpcyB3aWxsIGFzc2lnbiBvd25lcnNoaXAsIGFuZCBhbHNvIGVtaXQgdGhlIFRyYW5zZmVyIGV2ZW50IGFzCiAgICAvLyBwZXIgRVJDNzIxIGRyYWZ0CiAgICBfdHJhbnNmZXIoYWRkcmVzcygwKSwgY29sbGVjdGlibGVPd25lciwgdG9rZW5JZCk7CgogIH0KCiAgZnVuY3Rpb24gY3JlYXRlU2Vjb25kUHJvbW9Db2xsZWN0aWJsZSh1aW50MjU2IHRva2VuSWQsIGFkZHJlc3MgX2NyZWF0b3IsIHVpbnQyNTYgX3ByaWNlLCBhZGRyZXNzIF9vd25lcikgcHVibGljIG9ubHlDT08gewogICAgcmVxdWlyZShjb2xsZWN0aWJsZUluZGV4VG9Pd25lclt0b2tlbklkXT09YWRkcmVzcygwKSk7CiAgICByZXF1aXJlKHByb21vQ3JlYXRlZENvdW50IDwgUFJPTU9fQ1JFQVRJT05fTElNSVQpOwoKICAgIGFkZHJlc3MgY29sbGVjdGlibGVPd25lciA9IF9vd25lcjsKICAgIGlmIChjb2xsZWN0aWJsZU93bmVyID09IGFkZHJlc3MoMCkpIHsKICAgICAgY29sbGVjdGlibGVPd25lciA9IGNvb0FkZHJlc3M7CiAgICB9CgogICAgaWYgKF9wcmljZSA8PSAwKSB7CiAgICAgIF9wcmljZSA9IGdldEluaXRpYWxQcmljZU9mVG9rZW4odG9rZW5JZCk7CiAgICB9CgogICAgcHJvbW9DcmVhdGVkQ291bnQrKzsKICAgIF9jcmVhdGVDb2xsZWN0aWJsZSh0b2tlbklkLCBfcHJpY2UpOwogICAgc3ViVG9rZW5DcmVhdG9yW3Rva2VuSWRdID0gX2NyZWF0b3I7CiAgICB1bmxvY2tlZFt0b2tlbklkXSA9IHRydWU7CiAgICAvLyBUaGlzIHdpbGwgYXNzaWduIG93bmVyc2hpcCwgYW5kIGFsc28gZW1pdCB0aGUgVHJhbnNmZXIgZXZlbnQgYXMKICAgIC8vIHBlciBFUkM3MjEgZHJhZnQKICAgIF90cmFuc2ZlcihhZGRyZXNzKDApLCBjb2xsZWN0aWJsZU93bmVyLCB0b2tlbklkKTsKCiAgfQoKICBib29sIGlzQ2hhbmdlUHJpY2VMb2NrZWQgPSB0cnVlOwogIC8vIGFsbG93cyBvd25lcnMgb2YgdG9rZW5zIHRvIGRlY3JlYXNlIHRoZSBwcmljZSBvZiB0aGVtIG9yIGlmIHRoZXJlIGlzIG5vIG93bmVyIHRoZSBjb28gY2FuIGRvIGl0CiAgZnVuY3Rpb24gY2hhbmdlUHJpY2UodWludDI1NiBuZXdQcmljZSwgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIHsKICAgIHJlcXVpcmUoKF9vd25zKG1zZy5zZW5kZXIsIF90b2tlbklkKSAmJiAhaXNDaGFuZ2VQcmljZUxvY2tlZCkgfHwgKF9vd25zKGFkZHJlc3MoMCksIF90b2tlbklkKSAmJiBtc2cuc2VuZGVyID09IGNvb0FkZHJlc3MpKTsKICAgIHJlcXVpcmUobmV3UHJpY2U8Y29sbGVjdGlibGVJbmRleFRvUHJpY2VbX3Rva2VuSWRdKTsKICAgIGNvbGxlY3RpYmxlSW5kZXhUb1ByaWNlW190b2tlbklkXSA9IG5ld1ByaWNlOwogIH0KICBmdW5jdGlvbiB1bmxvY2tUb2tlbih1aW50IHRva2VuSWQpIHB1YmxpYyBvbmx5Q09PIHsKICAgIHVubG9ja2VkW3Rva2VuSWRdID0gdHJ1ZTsKICB9CiAgZnVuY3Rpb24gdW5sb2NrUHJpY2VDaGFuZ2UoKSBwdWJsaWMgb25seUNPTyB7CiAgICBpc0NoYW5nZVByaWNlTG9ja2VkID0gZmFsc2U7CiAgfQoKICAvLy8gQG5vdGljZSBSZXR1cm5zIGFsbCB0aGUgcmVsZXZhbnQgaW5mb3JtYXRpb24gYWJvdXQgYSBzcGVjaWZpYyBjb2xsZWN0aWJsZS4KICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSB0b2tlbklkIG9mIHRoZSBjb2xsZWN0aWJsZSBvZiBpbnRlcmVzdC4KICBmdW5jdGlvbiBnZXRUb2tlbih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHRva2VuSWQsIHVpbnQyNTYgc2VsbGluZ1ByaWNlLCBhZGRyZXNzIG93bmVyLCB1aW50MjU2IG5leHRTZWxsaW5nUHJpY2UpIHsKICAgIHRva2VuSWQgPSBfdG9rZW5JZDsKICAgIHNlbGxpbmdQcmljZSA9IGNvbGxlY3RpYmxlSW5kZXhUb1ByaWNlW190b2tlbklkXTsKICAgIGlmIChzZWxsaW5nUHJpY2UgPT0gMCkKICAgICAgc2VsbGluZ1ByaWNlID0gZ2V0SW5pdGlhbFByaWNlT2ZUb2tlbihfdG9rZW5JZCk7CiAgICBvd25lciA9IGNvbGxlY3RpYmxlSW5kZXhUb093bmVyW190b2tlbklkXTsKICAgIG5leHRTZWxsaW5nUHJpY2UgPSBnZXROZXh0UHJpY2Uoc2VsbGluZ1ByaWNlLCBfdG9rZW5JZCk7CiAgfQoKICBmdW5jdGlvbiBpbXBsZW1lbnRzRVJDNzIxKCkgcHVibGljIHB1cmUgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgcHVyZSByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBOQU1FOwogIH0KCiAgLy8vIEZvciBxdWVyeWluZyBvd25lciBvZiB0b2tlbgogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIHRva2VuSUQgZm9yIG93bmVyIGlucXVpcnkKICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkKICAgIHB1YmxpYwogICAgdmlldwogICAgcmV0dXJucyAoYWRkcmVzcyBvd25lcikKICB7CiAgICBvd25lciA9IGNvbGxlY3RpYmxlSW5kZXhUb093bmVyW190b2tlbklkXTsKICAgIHJlcXVpcmUob3duZXIgIT0gYWRkcmVzcygwKSk7CiAgfQoKICBmdW5jdGlvbiBwYXlvdXQoYWRkcmVzcyBfdG8pIHB1YmxpYyBvbmx5Q0xldmVsIHsKICAgIF9wYXlvdXQoX3RvKTsKICB9CgoKICBmdW5jdGlvbiBwcmljZU9mKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgcHJpY2UpIHsKICAgIHByaWNlID0gY29sbGVjdGlibGVJbmRleFRvUHJpY2VbX3Rva2VuSWRdOwogICAgaWYgKHByaWNlID09IDApCiAgICAgIHByaWNlID0gZ2V0SW5pdGlhbFByaWNlT2ZUb2tlbihfdG9rZW5JZCk7CiAgfQoKICAvLy8gQGRldiBBc3NpZ25zIGEgbmV3IGFkZHJlc3MgdG8gYWN0IGFzIHRoZSBDRU8uIE9ubHkgYXZhaWxhYmxlIHRvIHRoZSBjdXJyZW50IENFTy4KICAvLy8gQHBhcmFtIF9uZXdDRU8gVGhlIGFkZHJlc3Mgb2YgdGhlIG5ldyBDRU8KICBmdW5jdGlvbiBzZXRDRU8oYWRkcmVzcyBfbmV3Q0VPKSBwdWJsaWMgb25seUNFTyB7CiAgICByZXF1aXJlKF9uZXdDRU8gIT0gYWRkcmVzcygwKSk7CgogICAgY2VvQWRkcmVzcyA9IF9uZXdDRU87CiAgfQoKICAvLy8gQGRldiBBc3NpZ25zIGEgbmV3IGFkZHJlc3MgdG8gYWN0IGFzIHRoZSBDT08uIE9ubHkgYXZhaWxhYmxlIHRvIHRoZSBjdXJyZW50IENPTy4KICAvLy8gQHBhcmFtIF9uZXdDT08gVGhlIGFkZHJlc3Mgb2YgdGhlIG5ldyBDT08KICBmdW5jdGlvbiBzZXRDT08oYWRkcmVzcyBfbmV3Q09PKSBwdWJsaWMgb25seUNFTyB7CiAgICByZXF1aXJlKF9uZXdDT08gIT0gYWRkcmVzcygwKSk7CgogICAgY29vQWRkcmVzcyA9IF9uZXdDT087CiAgfQoKICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyBwdXJlIHJldHVybnMgKHN0cmluZykgewogICAgcmV0dXJuIFNZTUJPTDsKICB9CgogIC8vLyBAbm90aWNlIEFsbG93IHByZS1hcHByb3ZlZCB1c2VyIHRvIHRha2Ugb3duZXJzaGlwIG9mIGEgdG9rZW4KICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSBJRCBvZiB0aGUgVG9rZW4gdGhhdCBjYW4gYmUgdHJhbnNmZXJyZWQgaWYgdGhpcyBjYWxsIHN1Y2NlZWRzLgogIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgZnVuY3Rpb24gdGFrZU93bmVyc2hpcCh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgewogICAgYWRkcmVzcyBuZXdPd25lciA9IG1zZy5zZW5kZXI7CiAgICBhZGRyZXNzIG9sZE93bmVyID0gY29sbGVjdGlibGVJbmRleFRvT3duZXJbX3Rva2VuSWRdOwoKICAgIC8vIFNhZmV0eSBjaGVjayB0byBwcmV2ZW50IGFnYWluc3QgYW4gdW5leHBlY3RlZCAweDAgZGVmYXVsdC4KICAgIHJlcXVpcmUoX2FkZHJlc3NOb3ROdWxsKG5ld093bmVyKSk7CgogICAgLy8gTWFraW5nIHN1cmUgdHJhbnNmZXIgaXMgYXBwcm92ZWQKICAgIHJlcXVpcmUoX2FwcHJvdmVkKG5ld093bmVyLCBfdG9rZW5JZCkpOwoKICAgIF90cmFuc2ZlcihvbGRPd25lciwgbmV3T3duZXIsIF90b2tlbklkKTsKICB9CgogIC8vLyBPd25lciBpbml0YXRlcyB0aGUgdHJhbnNmZXIgb2YgdGhlIHRva2VuIHRvIGFub3RoZXIgYWNjb3VudAogIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIGZvciB0aGUgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQgdG8uCiAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgSUQgb2YgdGhlIFRva2VuIHRoYXQgY2FuIGJlIHRyYW5zZmVycmVkIGlmIHRoaXMgY2FsbCBzdWNjZWVkcy4KICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIHRyYW5zZmVyKAogICAgYWRkcmVzcyBfdG8sCiAgICB1aW50MjU2IF90b2tlbklkCiAgKSBwdWJsaWMgewogICAgcmVxdWlyZShfb3ducyhtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwogICAgcmVxdWlyZShfYWRkcmVzc05vdE51bGwoX3RvKSk7CgogICAgX3RyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3Rva2VuSWQpOwogIH0KCiAgLy8vIFRoaXJkLXBhcnR5IGluaXRpYXRlcyB0cmFuc2ZlciBvZiB0b2tlbiBmcm9tIGFkZHJlc3MgX2Zyb20gdG8gYWRkcmVzcyBfdG8KICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBhZGRyZXNzIGZvciB0aGUgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQgZnJvbS4KICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBmb3IgdGhlIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkIHRvLgogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIElEIG9mIHRoZSBUb2tlbiB0aGF0IGNhbiBiZSB0cmFuc2ZlcnJlZCBpZiB0aGlzIGNhbGwgc3VjY2VlZHMuCiAgLy8vIEBkZXYgUmVxdWlyZWQgZm9yIEVSQy03MjEgY29tcGxpYW5jZS4KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oCiAgICBhZGRyZXNzIF9mcm9tLAogICAgYWRkcmVzcyBfdG8sCiAgICB1aW50MjU2IF90b2tlbklkCiAgKSBwdWJsaWMgewogICAgcmVxdWlyZShfb3ducyhfZnJvbSwgX3Rva2VuSWQpKTsKICAgIHJlcXVpcmUoX2FwcHJvdmVkKF90bywgX3Rva2VuSWQpKTsKICAgIHJlcXVpcmUoX2FkZHJlc3NOb3ROdWxsKF90bykpOwoKICAgIF90cmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgfQoKICAvKioqIFBSSVZBVEUgRlVOQ1RJT05TICoqKi8KICAvLy8gU2FmZXR5IGNoZWNrIG9uIF90byBhZGRyZXNzIHRvIHByZXZlbnQgYWdhaW5zdCBhbiB1bmV4cGVjdGVkIDB4MCBkZWZhdWx0LgogIGZ1bmN0aW9uIF9hZGRyZXNzTm90TnVsbChhZGRyZXNzIF90bykgcHJpdmF0ZSBwdXJlIHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBfdG8gIT0gYWRkcmVzcygwKTsKICB9CgogIC8vLyBGb3IgY2hlY2tpbmcgYXBwcm92YWwgb2YgdHJhbnNmZXIgZm9yIGFkZHJlc3MgX3RvCiAgZnVuY3Rpb24gX2FwcHJvdmVkKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIGNvbGxlY3RpYmxlSW5kZXhUb0FwcHJvdmVkW190b2tlbklkXSA9PSBfdG87CiAgfQoKICAvLy8gRm9yIGNyZWF0aW5nIENvbGxlY3RpYmxlCiAgZnVuY3Rpb24gX2NyZWF0ZUNvbGxlY3RpYmxlKHVpbnQyNTYgdG9rZW5JZCwgdWludDI1NiBfcHJpY2UpIHByaXZhdGUgewogICAgY29sbGVjdGlibGVJbmRleFRvUHJpY2VbdG9rZW5JZF0gPSBfcHJpY2U7CiAgICBCaXJ0aCh0b2tlbklkLCBfcHJpY2UpOwogICAgdG9rZW5zLnB1c2godG9rZW5JZCk7CiAgfQoKICAvLy8gQ2hlY2sgZm9yIHRva2VuIG93bmVyc2hpcAogIGZ1bmN0aW9uIF9vd25zKGFkZHJlc3MgY2xhaW1hbnQsIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gY2xhaW1hbnQgPT0gY29sbGVjdGlibGVJbmRleFRvT3duZXJbX3Rva2VuSWRdOwogIH0KCiAgLy8vIEZvciBwYXlpbmcgb3V0IGJhbGFuY2Ugb24gY29udHJhY3QKICBmdW5jdGlvbiBfcGF5b3V0KGFkZHJlc3MgX3RvKSBwcml2YXRlIHsKICAgIGlmIChfdG8gPT0gYWRkcmVzcygwKSkgewogICAgICBjZW9BZGRyZXNzLnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgICB9IGVsc2UgewogICAgICBfdG8udHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgIH0KICB9CgogIC8vLyBGb3IgcXVlcnlpbmcgYmFsYW5jZSBvZiBhIHBhcnRpY3VsYXIgYWNjb3VudAogIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIGZvciBiYWxhbmNlIHF1ZXJ5CiAgLy8vIEBkZXYgUmVxdWlyZWQgZm9yIEVSQy03MjEgY29tcGxpYW5jZS4KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgcmVzdWx0KSB7CiAgICAgIHVpbnQyNTYgdG90YWxUb2tlbnMgPSB0b2tlbnMubGVuZ3RoOwogICAgICB1aW50MjU2IHRva2VuSW5kZXg7CiAgICAgIHVpbnQyNTYgdG9rZW5JZDsKICAgICAgcmVzdWx0ID0gMDsKICAgICAgZm9yICh0b2tlbkluZGV4ID0gMDsgdG9rZW5JbmRleCA8IHRvdGFsVG9rZW5zOyB0b2tlbkluZGV4KyspIHsKICAgICAgICB0b2tlbklkID0gdG9rZW5zW3Rva2VuSW5kZXhdOwogICAgICAgIGlmIChjb2xsZWN0aWJsZUluZGV4VG9Pd25lclt0b2tlbklkXSA9PSBfb3duZXIpIHsKICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5hZGQoMSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgfQoKICAvLy8gQGRldiBBc3NpZ25zIG93bmVyc2hpcCBvZiBhIHNwZWNpZmljIENvbGxlY3RpYmxlIHRvIGFuIGFkZHJlc3MuCiAgZnVuY3Rpb24gX3RyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHsKICAgIC8vdHJhbnNmZXIgb3duZXJzaGlwCiAgICBjb2xsZWN0aWJsZUluZGV4VG9Pd25lcltfdG9rZW5JZF0gPSBfdG87CgogICAgLy8gV2hlbiBjcmVhdGluZyBuZXcgY29sbGVjdGlibGVzIF9mcm9tIGlzIDB4MCwgYnV0IHdlIGNhbid0IGFjY291bnQgdGhhdCBhZGRyZXNzLgogICAgaWYgKF9mcm9tICE9IGFkZHJlc3MoMCkpIHsKICAgICAgLy8gY2xlYXIgYW55IHByZXZpb3VzbHkgYXBwcm92ZWQgb3duZXJzaGlwIGV4Y2hhbmdlCiAgICAgIGRlbGV0ZSBjb2xsZWN0aWJsZUluZGV4VG9BcHByb3ZlZFtfdG9rZW5JZF07CiAgICB9CgogICAgLy8gRW1pdCB0aGUgdHJhbnNmZXIgZXZlbnQuCiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgfQoKCiAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBvd25lciB3aG9zZSBjZWxlYnJpdHkgdG9rZW5zIHdlIGFyZSBpbnRlcmVzdGVkIGluLgogIC8vLyBAZGV2IFRoaXMgbWV0aG9kIE1VU1QgTkVWRVIgYmUgY2FsbGVkIGJ5IHNtYXJ0IGNvbnRyYWN0IGNvZGUuIEZpcnN0LCBpdCdzIGZhaXJseQogIC8vLyAgZXhwZW5zaXZlIChpdCB3YWxrcyB0aGUgZW50aXJlIHRva2VucyBhcnJheSBsb29raW5nIGZvciB0b2tlbnMgYmVsb25naW5nIHRvIG93bmVyKSwKICAvLy8gIGJ1dCBpdCBhbHNvIHJldHVybnMgYSBkeW5hbWljIGFycmF5LCB3aGljaCBpcyBvbmx5IHN1cHBvcnRlZCBmb3Igd2ViMyBjYWxscywgYW5kCiAgLy8vICBub3QgY29udHJhY3QtdG8tY29udHJhY3QgY2FsbHMuCiAgZnVuY3Rpb24gdG9rZW5zT2ZPd25lcihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyh1aW50MjU2W10gb3duZXJUb2tlbnMpIHsKICAgIHVpbnQyNTYgdG9rZW5Db3VudCA9IGJhbGFuY2VPZihfb3duZXIpOwogICAgaWYgKHRva2VuQ291bnQgPT0gMCkgewogICAgICAgIC8vIFJldHVybiBhbiBlbXB0eSBhcnJheQogICAgICByZXR1cm4gbmV3IHVpbnQyNTZbXSgwKTsKICAgIH0gZWxzZSB7CiAgICAgIHVpbnQyNTZbXSBtZW1vcnkgcmVzdWx0ID0gbmV3IHVpbnQyNTZbXSh0b2tlbkNvdW50KTsKICAgICAgdWludDI1NiB0b3RhbFRva2VucyA9IGdldFRvdGFsU3VwcGx5KCk7CiAgICAgIHVpbnQyNTYgcmVzdWx0SW5kZXggPSAwOwoKICAgICAgdWludDI1NiB0b2tlbkluZGV4OwogICAgICB1aW50MjU2IHRva2VuSWQ7CiAgICAgIGZvciAodG9rZW5JbmRleCA9IDA7IHRva2VuSW5kZXggPCB0b3RhbFRva2VuczsgdG9rZW5JbmRleCsrKSB7CiAgICAgICAgdG9rZW5JZCA9IHRva2Vuc1t0b2tlbkluZGV4XTsKICAgICAgICBpZiAoY29sbGVjdGlibGVJbmRleFRvT3duZXJbdG9rZW5JZF0gPT0gX293bmVyKSB7CiAgICAgICAgICByZXN1bHRbcmVzdWx0SW5kZXhdID0gdG9rZW5JZDsKICAgICAgICAgIHJlc3VsdEluZGV4ID0gcmVzdWx0SW5kZXguYWRkKDEpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH0KfQ=='.
	

]
