Class {
	#name : #SRT51430fbd23a8aef3d82e4240152ba379ff84016b,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT51430fbd23a8aef3d82e4240152ba379ff84016b >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7IC8vIHNvbGhpbnQtZGlzYWJsZS1saW5lCgovLy8gQHRpdGxlIEludGVyZmFjZSBmb3IgY29udHJhY3RzIGNvbmZvcm1pbmcgdG8gRVJDLTcyMTogTm9uLUZ1bmdpYmxlIFRva2VucwovLy8gQGF1dGhvciBEaWV0ZXIgU2hpcmxleSA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjVlM2EzYjJhM2IxZTNmMjYzNzMxMzMyNDNiMzA3MDNkMzEiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+PiAoaHR0cHM6Ly9naXRodWIuY29tL2RldGUpCmNvbnRyYWN0IEVSQzcyMSB7CiAgLy8gUmVxdWlyZWQgbWV0aG9kcwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYzsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7CiAgZnVuY3Rpb24gaW1wbGVtZW50c0VSQzcyMSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBhZGRyKTsKICBmdW5jdGlvbiB0YWtlT3duZXJzaGlwKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYzsKICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgdG90YWwpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWM7CgogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdG9rZW5JZCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgYXBwcm92ZWQsIHVpbnQyNTYgdG9rZW5JZCk7CgogIC8vIE9wdGlvbmFsCiAgLy8gZnVuY3Rpb24gbmFtZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZyBuYW1lKTsKICAvLyBmdW5jdGlvbiBzeW1ib2woKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcgc3ltYm9sKTsKICAvLyBmdW5jdGlvbiB0b2tlbk9mT3duZXJCeUluZGV4KGFkZHJlc3MgX293bmVyLCB1aW50MjU2IF9pbmRleCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2IHRva2VuSWQpOwogIC8vIGZ1bmN0aW9uIHRva2VuTWV0YWRhdGEodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nIGluZm9VcmwpOwp9Cgpjb250cmFjdCBQb3Juc3RhcnNJbnRlcmZhY2UgewogICAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF9pZCkgcHVibGljIHZpZXcgcmV0dXJucyAoCiAgICAgICAgYWRkcmVzcyBvd25lcgogICAgKTsKICAgIAogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICgKICAgICAgICB1aW50MjU2IHRvdGFsCiAgICApOwp9Cgpjb250cmFjdCBQb3JuU2NlbmVUb2tlbiBpcyBFUkM3MjEgewoKICAvKioqIEVWRU5UUyAqKiovCgogIC8vLyBAZGV2IFRoZSBCaXJ0aCBldmVudCBpcyBmaXJlZCB3aGVuZXZlciBhIG5ldyBzY2VuZSBjb21lcyBpbnRvIGV4aXN0ZW5jZS4KICBldmVudCBCaXJ0aCh1aW50MjU2IHRva2VuSWQsIHN0cmluZyBuYW1lLCB1aW50W10gc3RhcnMsIGFkZHJlc3Mgb3duZXIpOwoKICAvLy8gQGRldiBUaGUgVG9rZW5Tb2xkIGV2ZW50IGlzIGZpcmVkIHdoZW5ldmVyIGEgdG9rZW4gaXMgc29sZC4KICBldmVudCBUb2tlblNvbGQodWludDI1NiB0b2tlbklkLCB1aW50MjU2IG9sZFByaWNlLCB1aW50MjU2IG5ld1ByaWNlLCBhZGRyZXNzIHByZXZPd25lciwgYWRkcmVzcyB3aW5uZXIsIHN0cmluZyBuYW1lLCB1aW50W10gc3RhcnMpOwoKICAvLy8gQGRldiBUcmFuc2ZlciBldmVudCBhcyBkZWZpbmVkIGluIGN1cnJlbnQgZHJhZnQgb2YgRVJDNzIxLiAKICAvLy8gIG93bmVyc2hpcCBpcyBhc3NpZ25lZCwgaW5jbHVkaW5nIGJpcnRocy4KICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdG9rZW5JZCk7CgogIC8qKiogQ09OU1RBTlRTICoqKi8KCiAgLy8vIEBub3RpY2UgTmFtZSBhbmQgc3ltYm9sIG9mIHRoZSBub24gZnVuZ2libGUgdG9rZW4sIGFzIGRlZmluZWQgaW4gRVJDNzIxLgogIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgTkFNRSA9ICJDcnlwdG9Qb3JuU2NlbmVzIjsgLy8gc29saGludC1kaXNhYmxlLWxpbmUKICBzdHJpbmcgcHVibGljIGNvbnN0YW50IFNZTUJPTCA9ICJQb3JuU2NlbmVUb2tlbiI7IC8vIHNvbGhpbnQtZGlzYWJsZS1saW5lCgogIHVpbnQyNTYgcHJpdmF0ZSBzdGFydGluZ1ByaWNlID0gMC4wMDEgZXRoZXI7CiAgdWludDI1NiBwcml2YXRlIGNvbnN0YW50IFBST01PX0NSRUFUSU9OX0xJTUlUID0gMTAwMDA7CiAgdWludDI1NiBwcml2YXRlIGZpcnN0U3RlcExpbWl0ID0gIDAuMDUzNjEzIGV0aGVyOwogIHVpbnQyNTYgcHJpdmF0ZSBzZWNvbmRTdGVwTGltaXQgPSAwLjU2NDk1NyBldGhlcjsKCiAgLyoqKiBTVE9SQUdFICoqKi8KCiAgLy8vIEBkZXYgQSBtYXBwaW5nIGZyb20gc2NlbmUgSURzIHRvIHRoZSBhZGRyZXNzIHRoYXQgb3ducyB0aGVtLiBBbGwgc2NlbmVzIGhhdmUKICAvLy8gIHNvbWUgdmFsaWQgb3duZXIgYWRkcmVzcy4KICBtYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIHB1YmxpYyBzY2VuZUluZGV4VG9Pd25lcjsKCiAgLy8gQGRldiBBIG1hcHBpbmcgZnJvbSBvd25lciBhZGRyZXNzIHRvIGNvdW50IG9mIHRva2VucyB0aGF0IGFkZHJlc3Mgb3ducy4KICAvLyAgVXNlZCBpbnRlcm5hbGx5IGluc2lkZSBiYWxhbmNlT2YoKSB0byByZXNvbHZlIG93bmVyc2hpcCBjb3VudC4KICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHByaXZhdGUgb3duZXJzaGlwVG9rZW5Db3VudDsKCiAgLy8vIEBkZXYgQSBtYXBwaW5nIGZyb20gU2NlbmVJRHMgdG8gYW4gYWRkcmVzcyB0aGF0IGhhcyBiZWVuIGFwcHJvdmVkIHRvIGNhbGwKICAvLy8gIHRyYW5zZmVyRnJvbSgpLiBFYWNoIFNjZW5lIGNhbiBvbmx5IGhhdmUgb25lIGFwcHJvdmVkIGFkZHJlc3MgZm9yIHRyYW5zZmVyCiAgLy8vICBhdCBhbnkgdGltZS4gQSB6ZXJvIHZhbHVlIG1lYW5zIG5vIGFwcHJvdmFsIGlzIG91dHN0YW5kaW5nLgogIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgcHVibGljIHNjZW5lSW5kZXhUb0FwcHJvdmVkOwoKICAvLyBAZGV2IEEgbWFwcGluZyBmcm9tIFNjZW5lSURzIHRvIHRoZSBwcmljZSBvZiB0aGUgdG9rZW4uCiAgbWFwcGluZyAodWludDI1NiA9PiB1aW50MjU2KSBwcml2YXRlIHNjZW5lSW5kZXhUb1ByaWNlOwoKICAvLyBUaGUgYWRkcmVzc2VzIG9mIHRoZSBhY2NvdW50cyAob3IgY29udHJhY3RzKSB0aGF0IGNhbiBleGVjdXRlIGFjdGlvbnMgd2l0aGluIGVhY2ggcm9sZXMuCiAgYWRkcmVzcyBwdWJsaWMgY2VvQWRkcmVzczsKICBhZGRyZXNzIHB1YmxpYyBjb29BZGRyZXNzOwoKICBQb3Juc3RhcnNJbnRlcmZhY2UgcG9ybnN0YXJzQ29udHJhY3Q7CiAgdWludCBjdXJyZW50QXdhcmRXaW5uZXI7CgogIHVpbnQyNTYgcHVibGljIHByb21vQ3JlYXRlZENvdW50OwoKICAvKioqIERBVEFUWVBFUyAqKiovCiAgc3RydWN0IFNjZW5lIHsKICAgIHN0cmluZyBuYW1lOwogICAgdWludFtdIHN0YXJzOwogIH0KCiAgU2NlbmVbXSBwcml2YXRlIHNjZW5lczsKCiAgLyoqKiBBQ0NFU1MgTU9ESUZJRVJTICoqKi8KICAvLy8gQGRldiBBY2Nlc3MgbW9kaWZpZXIgZm9yIENFTy1vbmx5IGZ1bmN0aW9uYWxpdHkKICBtb2RpZmllciBvbmx5Q0VPKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNlb0FkZHJlc3MpOwogICAgXzsKICB9CgogIC8vLyBAZGV2IEFjY2VzcyBtb2RpZmllciBmb3IgQ09PLW9ubHkgZnVuY3Rpb25hbGl0eQogIG1vZGlmaWVyIG9ubHlDT08oKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY29vQWRkcmVzcyk7CiAgICBfOwogIH0KCiAgLy8vIEFjY2VzcyBtb2RpZmllciBmb3IgY29udHJhY3Qgb3duZXIgb25seSBmdW5jdGlvbmFsaXR5CiAgbW9kaWZpZXIgb25seUNMZXZlbCgpIHsKICAgIHJlcXVpcmUoCiAgICAgIG1zZy5zZW5kZXIgPT0gY2VvQWRkcmVzcyB8fAogICAgICBtc2cuc2VuZGVyID09IGNvb0FkZHJlc3MKICAgICk7CiAgICBfOwogIH0KCiAgLyoqKiBDT05TVFJVQ1RPUiAqKiovCiAgZnVuY3Rpb24gUG9yblNjZW5lVG9rZW4oKSBwdWJsaWMgewogICAgY2VvQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICBjb29BZGRyZXNzID0gbXNnLnNlbmRlcjsKICB9CgogIC8qKiogUFVCTElDIEZVTkNUSU9OUyAqKiovCiAgLy8vIEBub3RpY2UgR3JhbnQgYW5vdGhlciBhZGRyZXNzIHRoZSByaWdodCB0byB0cmFuc2ZlciB0b2tlbiB2aWEgdGFrZU93bmVyc2hpcCgpIGFuZCB0cmFuc2ZlckZyb20oKS4KICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byBiZSBncmFudGVkIHRyYW5zZmVyIGFwcHJvdmFsLiBQYXNzIGFkZHJlc3MoMCkgdG8KICAvLy8gIGNsZWFyIGFsbCBhcHByb3ZhbHMuCiAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgSUQgb2YgdGhlIFRva2VuIHRoYXQgY2FuIGJlIHRyYW5zZmVycmVkIGlmIHRoaXMgY2FsbCBzdWNjZWVkcy4KICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIGFwcHJvdmUoCiAgICBhZGRyZXNzIF90bywKICAgIHVpbnQyNTYgX3Rva2VuSWQKICApIHB1YmxpYyB7CiAgICAvLyBDYWxsZXIgbXVzdCBvd24gdG9rZW4uCiAgICByZXF1aXJlKF9vd25zKG1zZy5zZW5kZXIsIF90b2tlbklkKSk7CgogICAgc2NlbmVJbmRleFRvQXBwcm92ZWRbX3Rva2VuSWRdID0gX3RvOwoKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF90bywgX3Rva2VuSWQpOwogIH0KCiAgLy8vIEZvciBxdWVyeWluZyBiYWxhbmNlIG9mIGEgcGFydGljdWxhciBhY2NvdW50CiAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgZm9yIGJhbGFuY2UgcXVlcnkKICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gb3duZXJzaGlwVG9rZW5Db3VudFtfb3duZXJdOwogIH0KICAKICBmdW5jdGlvbiBzZXRQb3Juc3RhcnNDb250cmFjdEFkZHJlc3MoYWRkcmVzcyBfYWRkcmVzcykgcHVibGljIG9ubHlDT08gewogICAgICBwb3Juc3RhcnNDb250cmFjdCA9IFBvcm5zdGFyc0ludGVyZmFjZShfYWRkcmVzcyk7CiAgfQogIAogIC8vLyBAZGV2IENyZWF0ZXMgYSBuZXcgcHJvbW8gU2NlbmUgd2l0aCB0aGUgZ2l2ZW4gbmFtZSwgd2l0aCBnaXZlbiBfcHJpY2UgYW5kIGFzc2lnbmVzIGl0IHRvIGFuIGFkZHJlc3MuCiAgZnVuY3Rpb24gY3JlYXRlUHJvbW9TY2VuZShhZGRyZXNzIF9vd25lciwgc3RyaW5nIF9uYW1lLCB1aW50W10gX3N0YXJzLCB1aW50MjU2IF9wcmljZSkgcHVibGljIG9ubHlDT08gewogICAgcmVxdWlyZShwcm9tb0NyZWF0ZWRDb3VudCA8IFBST01PX0NSRUFUSU9OX0xJTUlUKTsKCiAgICBhZGRyZXNzIHNjZW5lT3duZXIgPSBfb3duZXI7CiAgICBpZiAoc2NlbmVPd25lciA9PSBhZGRyZXNzKDApKSB7CiAgICAgIHNjZW5lT3duZXIgPSBjb29BZGRyZXNzOwogICAgfQoKICAgIGlmIChfcHJpY2UgPD0gMCkgewogICAgICBfcHJpY2UgPSBzdGFydGluZ1ByaWNlOwogICAgfQoKICAgIHByb21vQ3JlYXRlZENvdW50Kys7CiAgICBfY3JlYXRlU2NlbmUoX25hbWUsIF9zdGFycywgc2NlbmVPd25lciwgX3ByaWNlKTsKICB9CgogIC8vLyBAZGV2IENyZWF0ZXMgYSBuZXcgU2NlbmUgd2l0aCB0aGUgZ2l2ZW4gbmFtZS4KICBmdW5jdGlvbiBjcmVhdGVDb250cmFjdFNjZW5lKHN0cmluZyBfbmFtZSwgdWludFtdIF9zdGFycykgcHVibGljIG9ubHlDT08gewogICAgX2NyZWF0ZVNjZW5lKF9uYW1lLCBfc3RhcnMsIGFkZHJlc3ModGhpcyksIHN0YXJ0aW5nUHJpY2UpOwogIH0KCiAgLy8vIEBub3RpY2UgUmV0dXJucyBhbGwgdGhlIHJlbGV2YW50IGluZm9ybWF0aW9uIGFib3V0IGEgc3BlY2lmaWMgc2NlbmUuCiAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgdG9rZW5JZCBvZiB0aGUgc2NlbmUgb2YgaW50ZXJlc3QuCiAgZnVuY3Rpb24gZ2V0U2NlbmUodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoCiAgICBzdHJpbmcgc2NlbmVOYW1lLAogICAgdWludFtdIHN0YXJzLAogICAgdWludDI1NiBzZWxsaW5nUHJpY2UsCiAgICBhZGRyZXNzIG93bmVyCiAgKSB7CiAgICBTY2VuZSBzdG9yYWdlIHNjZW5lID0gc2NlbmVzW190b2tlbklkXTsKICAgIHNjZW5lTmFtZSA9IHNjZW5lLm5hbWU7CiAgICBzdGFycyA9IHNjZW5lLnN0YXJzOwogICAgc2VsbGluZ1ByaWNlID0gc2NlbmVJbmRleFRvUHJpY2VbX3Rva2VuSWRdOwogICAgb3duZXIgPSBzY2VuZUluZGV4VG9Pd25lcltfdG9rZW5JZF07CiAgfQoKICBmdW5jdGlvbiBpbXBsZW1lbnRzRVJDNzIxKCkgcHVibGljIHB1cmUgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgcHVyZSByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBOQU1FOwogIH0KCiAgLy8vIEZvciBxdWVyeWluZyBvd25lciBvZiB0b2tlbgogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIHRva2VuSUQgZm9yIG93bmVyIGlucXVpcnkKICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkKICAgIHB1YmxpYwogICAgdmlldwogICAgcmV0dXJucyAoYWRkcmVzcyBvd25lcikKICB7CiAgICBvd25lciA9IHNjZW5lSW5kZXhUb093bmVyW190b2tlbklkXTsKICAgIHJlcXVpcmUob3duZXIgIT0gYWRkcmVzcygwKSk7CiAgfQoKICBmdW5jdGlvbiBwYXlvdXQoYWRkcmVzcyBfdG8pIHB1YmxpYyBvbmx5Q0xldmVsIHsKICAgIF9wYXlvdXQoX3RvKTsKICB9CgogIC8vIEFsbG93cyBzb21lb25lIHRvIHNlbmQgZXRoZXIgYW5kIG9idGFpbiB0aGUgdG9rZW4KICBmdW5jdGlvbiBwdXJjaGFzZSh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgcGF5YWJsZSB7CiAgICBhZGRyZXNzIG9sZE93bmVyID0gc2NlbmVJbmRleFRvT3duZXJbX3Rva2VuSWRdOwogICAgYWRkcmVzcyBuZXdPd25lciA9IG1zZy5zZW5kZXI7CgogICAgdWludDI1NiBzZWxsaW5nUHJpY2UgPSBzY2VuZUluZGV4VG9QcmljZVtfdG9rZW5JZF07CgogICAgLy8gTWFraW5nIHN1cmUgdG9rZW4gb3duZXIgaXMgbm90IHNlbmRpbmcgdG8gc2VsZgogICAgcmVxdWlyZShvbGRPd25lciAhPSBuZXdPd25lcik7CgogICAgLy8gU2FmZXR5IGNoZWNrIHRvIHByZXZlbnQgYWdhaW5zdCBhbiB1bmV4cGVjdGVkIDB4MCBkZWZhdWx0LgogICAgcmVxdWlyZShfYWRkcmVzc05vdE51bGwobmV3T3duZXIpKTsKCiAgICAvLyBNYWtpbmcgc3VyZSBzZW50IGFtb3VudCBpcyBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gdGhlIHNlbGxpbmdQcmljZQogICAgcmVxdWlyZShtc2cudmFsdWUgPj0gc2VsbGluZ1ByaWNlKTsKCiAgICB1aW50MjU2IHBheW1lbnQgPSB1aW50MjU2KFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoc2VsbGluZ1ByaWNlLCA4MCksIDEwMCkpOwogICAgdWludDI1NiBwdXJjaGFzZUV4Y2VzcyA9IFNhZmVNYXRoLnN1Yihtc2cudmFsdWUsIHNlbGxpbmdQcmljZSk7CiAgICAKICAgIC8vIFBvcm5zdGFyIEhvbGRlciBGZWVzCiAgICAvLyBHZXQgU2NlbmUgU3RhciBMZW5ndGgKICAgIFNjZW5lIG1lbW9yeSBfc2NlbmUgPSBzY2VuZXNbX3Rva2VuSWRdOwogICAgCiAgICByZXF1aXJlKF9zY2VuZS5zdGFycy5sZW5ndGggPiAwKTsgLy9NYWtlIHN1cmUgaGF2ZSBzdGFycyBpbiB0aGUgc2NlbmUKCiAgICB1aW50MjU2IGhvbGRlckZlZSA9IHVpbnQyNTYoU2FmZU1hdGguZGl2KFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoc2VsbGluZ1ByaWNlLCAxMCksIDEwMCksIF9zY2VuZS5zdGFycy5sZW5ndGgpKTsKICAgIHVpbnQyNTYgYXdhcmRPd25lckZlZSA9IHVpbnQyNTYoU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChzZWxsaW5nUHJpY2UsIDQpLCAxMDApKTsKCiAgICAvLyBVcGRhdGUgcHJpY2VzCiAgICBpZiAoc2VsbGluZ1ByaWNlIDwgZmlyc3RTdGVwTGltaXQpIHsKICAgICAgLy8gZmlyc3Qgc3RhZ2UKICAgICAgc2NlbmVJbmRleFRvUHJpY2VbX3Rva2VuSWRdID0gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChzZWxsaW5nUHJpY2UsIDIwMCksIDk0KTsKICAgIH0gZWxzZSBpZiAoc2VsbGluZ1ByaWNlIDwgc2Vjb25kU3RlcExpbWl0KSB7CiAgICAgIC8vIHNlY29uZCBzdGFnZQogICAgICBzY2VuZUluZGV4VG9QcmljZVtfdG9rZW5JZF0gPSBTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKHNlbGxpbmdQcmljZSwgMTIwKSwgOTQpOwogICAgfSBlbHNlIHsKICAgICAgLy8gdGhpcmQgc3RhZ2UKICAgICAgc2NlbmVJbmRleFRvUHJpY2VbX3Rva2VuSWRdID0gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChzZWxsaW5nUHJpY2UsIDExNSksIDk0KTsKICAgIH0KCiAgICBfdHJhbnNmZXIob2xkT3duZXIsIG5ld093bmVyLCBfdG9rZW5JZCk7CgogICAgLy8gUGF5IHByZXZpb3VzIHRva2VuT3duZXIgaWYgb3duZXIgaXMgbm90IGNvbnRyYWN0CiAgICBpZiAob2xkT3duZXIgIT0gYWRkcmVzcyh0aGlzKSkgewogICAgICBvbGRPd25lci50cmFuc2ZlcihwYXltZW50KTsgLy8oMS0wLjA2KQogICAgfQogICAgCiAgICBfcGF5U2NlbmVTdGFyT3duZXJzKF9zY2VuZSwgaG9sZGVyRmVlKTsKICAgIF9wYXlBd2FyZE93bmVyKGF3YXJkT3duZXJGZWUpOwogICAgCiAgICBUb2tlblNvbGQoX3Rva2VuSWQsIHNlbGxpbmdQcmljZSwgc2NlbmVJbmRleFRvUHJpY2VbX3Rva2VuSWRdLCBvbGRPd25lciwgbmV3T3duZXIsIF9zY2VuZS5uYW1lLCBfc2NlbmUuc3RhcnMpOwoKICAgIG1zZy5zZW5kZXIudHJhbnNmZXIocHVyY2hhc2VFeGNlc3MpOwogIH0KICAKICBmdW5jdGlvbiBfcGF5U2NlbmVTdGFyT3duZXJzKFNjZW5lIF9zY2VuZSwgdWludDI1NiBmZWUpIHByaXZhdGUgewogICAgZm9yICh1aW50IGkgPSAwOyBpIDwgX3NjZW5lLnN0YXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgYWRkcmVzcyBfcG9ybnN0YXJPd25lcjsKICAgICAgICAoX3Bvcm5zdGFyT3duZXIpID0gcG9ybnN0YXJzQ29udHJhY3Qub3duZXJPZihfc2NlbmUuc3RhcnNbaV0pOwogICAgICAgIAogICAgICAgIGlmKF9pc0dvb2RBZGRyZXNzKF9wb3Juc3Rhck93bmVyKSkgewogICAgICAgICAgICBfcG9ybnN0YXJPd25lci50cmFuc2ZlcihmZWUpOwogICAgICAgIH0KICAgIH0KICB9CiAgCiAgZnVuY3Rpb24gX3BheUF3YXJkT3duZXIodWludDI1NiBmZWUpIHByaXZhdGUgewogICAgYWRkcmVzcyBfYXdhcmRPd25lcjsKICAgIChfYXdhcmRPd25lcikgPSBwb3Juc3RhcnNDb250cmFjdC5vd25lck9mKGN1cnJlbnRBd2FyZFdpbm5lcik7CiAgICAKICAgIGlmKF9pc0dvb2RBZGRyZXNzKF9hd2FyZE93bmVyKSkgewogICAgICAgIF9hd2FyZE93bmVyLnRyYW5zZmVyKGZlZSk7CiAgICB9CiAgfQogIAogIGZ1bmN0aW9uIF9pc0dvb2RBZGRyZXNzKGFkZHJlc3MgX2FkZHkpIHByaXZhdGUgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgIGlmKF9hZGR5ID09IGFkZHJlc3MocG9ybnN0YXJzQ29udHJhY3QpKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgCiAgICAgIGlmKF9hZGR5ID09IGFkZHJlc3MoMCkgfHwgX2FkZHkgPT0gYWRkcmVzcygweDApKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgCiAgICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gcHJpY2VPZih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHByaWNlKSB7CiAgICByZXR1cm4gc2NlbmVJbmRleFRvUHJpY2VbX3Rva2VuSWRdOwogIH0KICAKICBmdW5jdGlvbiBzdGFyc09mKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnRbXSkgewogICAgICByZXR1cm4gc2NlbmVzW190b2tlbklkXS5zdGFyczsKICB9CiAgCiAgLy8vIEBkZXYgQXNzaWducyBhIG5ldyBhZGRyZXNzIHRvIGFjdCBhcyB0aGUgQ0VPLiBPbmx5IGF2YWlsYWJsZSB0byB0aGUgY3VycmVudCBDRU8uCiAgLy8vIEBwYXJhbSBfbmV3Q0VPIFRoZSBhZGRyZXNzIG9mIHRoZSBuZXcgQ0VPCiAgZnVuY3Rpb24gc2V0Q0VPKGFkZHJlc3MgX25ld0NFTykgcHVibGljIG9ubHlDRU8gewogICAgcmVxdWlyZShfbmV3Q0VPICE9IGFkZHJlc3MoMCkpOwoKICAgIGNlb0FkZHJlc3MgPSBfbmV3Q0VPOwogIH0KCiAgLy8vIEBkZXYgQXNzaWducyBhIG5ldyBhZGRyZXNzIHRvIGFjdCBhcyB0aGUgQ09PLiBPbmx5IGF2YWlsYWJsZSB0byB0aGUgY3VycmVudCBDT08uCiAgLy8vIEBwYXJhbSBfbmV3Q09PIFRoZSBhZGRyZXNzIG9mIHRoZSBuZXcgQ09PCiAgZnVuY3Rpb24gc2V0Q09PKGFkZHJlc3MgX25ld0NPTykgcHVibGljIG9ubHlDRU8gewogICAgcmVxdWlyZShfbmV3Q09PICE9IGFkZHJlc3MoMCkpOwoKICAgIGNvb0FkZHJlc3MgPSBfbmV3Q09POwogIH0KCiAgLy8vIEBkZXYgUmVxdWlyZWQgZm9yIEVSQy03MjEgY29tcGxpYW5jZS4KICBmdW5jdGlvbiBzeW1ib2woKSBwdWJsaWMgcHVyZSByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBTWU1CT0w7CiAgfQoKICAvLy8gQG5vdGljZSBBbGxvdyBwcmUtYXBwcm92ZWQgdXNlciB0byB0YWtlIG93bmVyc2hpcCBvZiBhIHRva2VuCiAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgSUQgb2YgdGhlIFRva2VuIHRoYXQgY2FuIGJlIHRyYW5zZmVycmVkIGlmIHRoaXMgY2FsbCBzdWNjZWVkcy4KICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHsKICAgIGFkZHJlc3MgbmV3T3duZXIgPSBtc2cuc2VuZGVyOwogICAgYWRkcmVzcyBvbGRPd25lciA9IHNjZW5lSW5kZXhUb093bmVyW190b2tlbklkXTsKCiAgICAvLyBTYWZldHkgY2hlY2sgdG8gcHJldmVudCBhZ2FpbnN0IGFuIHVuZXhwZWN0ZWQgMHgwIGRlZmF1bHQuCiAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChuZXdPd25lcikpOwoKICAgIC8vIE1ha2luZyBzdXJlIHRyYW5zZmVyIGlzIGFwcHJvdmVkCiAgICByZXF1aXJlKF9hcHByb3ZlZChuZXdPd25lciwgX3Rva2VuSWQpKTsKCiAgICBfdHJhbnNmZXIob2xkT3duZXIsIG5ld093bmVyLCBfdG9rZW5JZCk7CiAgfQoKICAvLy8gQHBhcmFtIF9vd25lciBUaGUgb3duZXIgd2hvc2UgY2VsZWJyaXR5IHRva2VucyB3ZSBhcmUgaW50ZXJlc3RlZCBpbi4KICAvLy8gQGRldiBUaGlzIG1ldGhvZCBNVVNUIE5FVkVSIGJlIGNhbGxlZCBieSBzbWFydCBjb250cmFjdCBjb2RlLiBGaXJzdCwgaXQncyBmYWlybHkKICAvLy8gIGV4cGVuc2l2ZSAoaXQgd2Fsa3MgdGhlIGVudGlyZSBzY2VuZXMgYXJyYXkgbG9va2luZyBmb3Igc2NlbmVzIGJlbG9uZ2luZyB0byBvd25lciksCiAgLy8vICBidXQgaXQgYWxzbyByZXR1cm5zIGEgZHluYW1pYyBhcnJheSwgd2hpY2ggaXMgb25seSBzdXBwb3J0ZWQgZm9yIHdlYjMgY2FsbHMsIGFuZAogIC8vLyAgbm90IGNvbnRyYWN0LXRvLWNvbnRyYWN0IGNhbGxzLgogIGZ1bmN0aW9uIHRva2Vuc09mT3duZXIoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnModWludDI1NltdIG93bmVyVG9rZW5zKSB7CiAgICB1aW50MjU2IHRva2VuQ291bnQgPSBiYWxhbmNlT2YoX293bmVyKTsKICAgIGlmICh0b2tlbkNvdW50ID09IDApIHsKICAgICAgICAvLyBSZXR1cm4gYW4gZW1wdHkgYXJyYXkKICAgICAgcmV0dXJuIG5ldyB1aW50MjU2W10oMCk7CiAgICB9IGVsc2UgewogICAgICB1aW50MjU2W10gbWVtb3J5IHJlc3VsdCA9IG5ldyB1aW50MjU2W10odG9rZW5Db3VudCk7CiAgICAgIHVpbnQyNTYgdG90YWxzY2VuZXMgPSB0b3RhbFN1cHBseSgpOwogICAgICB1aW50MjU2IHJlc3VsdEluZGV4ID0gMDsKCiAgICAgIHVpbnQyNTYgc2NlbmVJZDsKICAgICAgZm9yIChzY2VuZUlkID0gMDsgc2NlbmVJZCA8PSB0b3RhbHNjZW5lczsgc2NlbmVJZCsrKSB7CiAgICAgICAgaWYgKHNjZW5lSW5kZXhUb093bmVyW3NjZW5lSWRdID09IF9vd25lcikgewogICAgICAgICAgcmVzdWx0W3Jlc3VsdEluZGV4XSA9IHNjZW5lSWQ7CiAgICAgICAgICByZXN1bHRJbmRleCsrOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH0KCiAgLy8vIEZvciBxdWVyeWluZyB0b3RhbFN1cHBseSBvZiB0b2tlbgogIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHRvdGFsKSB7CiAgICByZXR1cm4gc2NlbmVzLmxlbmd0aDsKICB9CgogIC8vLyBPd25lciBpbml0YXRlcyB0aGUgdHJhbnNmZXIgb2YgdGhlIHRva2VuIHRvIGFub3RoZXIgYWNjb3VudAogIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIGZvciB0aGUgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQgdG8uCiAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgSUQgb2YgdGhlIFRva2VuIHRoYXQgY2FuIGJlIHRyYW5zZmVycmVkIGlmIHRoaXMgY2FsbCBzdWNjZWVkcy4KICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIHRyYW5zZmVyKAogICAgYWRkcmVzcyBfdG8sCiAgICB1aW50MjU2IF90b2tlbklkCiAgKSBwdWJsaWMgewogICAgcmVxdWlyZShfb3ducyhtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwogICAgcmVxdWlyZShfYWRkcmVzc05vdE51bGwoX3RvKSk7CgogICAgX3RyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3Rva2VuSWQpOwogIH0KCiAgLy8vIFRoaXJkLXBhcnR5IGluaXRpYXRlcyB0cmFuc2ZlciBvZiB0b2tlbiBmcm9tIGFkZHJlc3MgX2Zyb20gdG8gYWRkcmVzcyBfdG8KICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBhZGRyZXNzIGZvciB0aGUgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQgZnJvbS4KICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBmb3IgdGhlIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkIHRvLgogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIElEIG9mIHRoZSBUb2tlbiB0aGF0IGNhbiBiZSB0cmFuc2ZlcnJlZCBpZiB0aGlzIGNhbGwgc3VjY2VlZHMuCiAgLy8vIEBkZXYgUmVxdWlyZWQgZm9yIEVSQy03MjEgY29tcGxpYW5jZS4KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oCiAgICBhZGRyZXNzIF9mcm9tLAogICAgYWRkcmVzcyBfdG8sCiAgICB1aW50MjU2IF90b2tlbklkCiAgKSBwdWJsaWMgewogICAgcmVxdWlyZShfb3ducyhfZnJvbSwgX3Rva2VuSWQpKTsKICAgIHJlcXVpcmUoX2FwcHJvdmVkKF90bywgX3Rva2VuSWQpKTsKICAgIHJlcXVpcmUoX2FkZHJlc3NOb3ROdWxsKF90bykpOwoKICAgIF90cmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgfQoKICAvKioqIFBSSVZBVEUgRlVOQ1RJT05TICoqKi8KICAvLy8gU2FmZXR5IGNoZWNrIG9uIF90byBhZGRyZXNzIHRvIHByZXZlbnQgYWdhaW5zdCBhbiB1bmV4cGVjdGVkIDB4MCBkZWZhdWx0LgogIGZ1bmN0aW9uIF9hZGRyZXNzTm90TnVsbChhZGRyZXNzIF90bykgcHJpdmF0ZSBwdXJlIHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBfdG8gIT0gYWRkcmVzcygwKTsKICB9CgogIC8vLyBGb3IgY2hlY2tpbmcgYXBwcm92YWwgb2YgdHJhbnNmZXIgZm9yIGFkZHJlc3MgX3RvCiAgZnVuY3Rpb24gX2FwcHJvdmVkKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHNjZW5lSW5kZXhUb0FwcHJvdmVkW190b2tlbklkXSA9PSBfdG87CiAgfQoKICAvLy8gRm9yIGNyZWF0aW5nIFNjZW5lCiAgZnVuY3Rpb24gX2NyZWF0ZVNjZW5lKHN0cmluZyBfbmFtZSwgdWludFtdIF9zdGFycyxhZGRyZXNzIF9vd25lciwgdWludDI1NiBfcHJpY2UpIHByaXZhdGUgewogICAgLy8gUmVxdWlyZSBTdGFycyBFeGlzdHMKICAgIHJlcXVpcmUoX3N0YXJzLmxlbmd0aCA+IDApOwogICAgCiAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBfc3RhcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICBhZGRyZXNzIF9wb3Juc3Rhck93bmVyOwogICAgICAgIChfcG9ybnN0YXJPd25lcikgPSBwb3Juc3RhcnNDb250cmFjdC5vd25lck9mKF9zdGFyc1tpXSk7CiAgICAgICAgcmVxdWlyZShfcG9ybnN0YXJPd25lciAhPSBhZGRyZXNzKDApIHx8IF9wb3Juc3Rhck93bmVyICE9IGFkZHJlc3MoMHgwKSk7CiAgICB9CiAgICAgIAogICAgU2NlbmUgbWVtb3J5IF9zY2VuZSA9IFNjZW5lKHsKICAgICAgbmFtZTogX25hbWUsCiAgICAgIHN0YXJzOiBfc3RhcnMKICAgIH0pOwogICAgdWludDI1NiBuZXdTY2VuZUlkID0gc2NlbmVzLnB1c2goX3NjZW5lKSAtIDE7CgogICAgLy8gSXQncyBwcm9iYWJseSBuZXZlciBnb2luZyB0byBoYXBwZW4sIDQgYmlsbGlvbiB0b2tlbnMgYXJlIEEgTE9ULCBidXQKICAgIC8vIGxldCdzIGp1c3QgYmUgMTAwJSBzdXJlIHdlIG5ldmVyIGxldCB0aGlzIGhhcHBlbi4KICAgIHJlcXVpcmUobmV3U2NlbmVJZCA9PSB1aW50MjU2KHVpbnQzMihuZXdTY2VuZUlkKSkpOwoKICAgIEJpcnRoKG5ld1NjZW5lSWQsIF9uYW1lLCBfc3RhcnMsIF9vd25lcik7CgogICAgc2NlbmVJbmRleFRvUHJpY2VbbmV3U2NlbmVJZF0gPSBfcHJpY2U7CgogICAgLy8gVGhpcyB3aWxsIGFzc2lnbiBvd25lcnNoaXAsIGFuZCBhbHNvIGVtaXQgdGhlIFRyYW5zZmVyIGV2ZW50IGFzCiAgICAvLyBwZXIgRVJDNzIxIGRyYWZ0CiAgICBfdHJhbnNmZXIoYWRkcmVzcygwKSwgX293bmVyLCBuZXdTY2VuZUlkKTsKICB9CgogIC8vLyBDaGVjayBmb3IgdG9rZW4gb3duZXJzaGlwCiAgZnVuY3Rpb24gX293bnMoYWRkcmVzcyBjbGFpbWFudCwgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBjbGFpbWFudCA9PSBzY2VuZUluZGV4VG9Pd25lcltfdG9rZW5JZF07CiAgfQoKICAvLy8gRm9yIHBheWluZyBvdXQgYmFsYW5jZSBvbiBjb250cmFjdAogIGZ1bmN0aW9uIF9wYXlvdXQoYWRkcmVzcyBfdG8pIHByaXZhdGUgewogICAgaWYgKF90byA9PSBhZGRyZXNzKDApKSB7CiAgICAgIGNlb0FkZHJlc3MudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgIH0gZWxzZSB7CiAgICAgIF90by50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgfQogIH0KCiAgLy8vIEBkZXYgQXNzaWducyBvd25lcnNoaXAgb2YgYSBzcGVjaWZpYyBTY2VuZSB0byBhbiBhZGRyZXNzLgogIGZ1bmN0aW9uIF90cmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB7CiAgICAvLyBTaW5jZSB0aGUgbnVtYmVyIG9mIHNjZW5lcyBpcyBjYXBwZWQgdG8gMl4zMiB3ZSBjYW4ndCBvdmVyZmxvdyB0aGlzCiAgICBvd25lcnNoaXBUb2tlbkNvdW50W190b10rKzsKICAgIC8vdHJhbnNmZXIgb3duZXJzaGlwCiAgICBzY2VuZUluZGV4VG9Pd25lcltfdG9rZW5JZF0gPSBfdG87CgogICAgLy8gV2hlbiBjcmVhdGluZyBuZXcgc2NlbmVzIF9mcm9tIGlzIDB4MCwgYnV0IHdlIGNhbid0IGFjY291bnQgdGhhdCBhZGRyZXNzLgogICAgaWYgKF9mcm9tICE9IGFkZHJlc3MoMCkpIHsKICAgICAgb3duZXJzaGlwVG9rZW5Db3VudFtfZnJvbV0tLTsKICAgICAgLy8gY2xlYXIgYW55IHByZXZpb3VzbHkgYXBwcm92ZWQgb3duZXJzaGlwIGV4Y2hhbmdlCiAgICAgIGRlbGV0ZSBzY2VuZUluZGV4VG9BcHByb3ZlZFtfdG9rZW5JZF07CiAgICB9CgogICAgLy8gRW1pdCB0aGUgdHJhbnNmZXIgZXZlbnQuCiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgfQp9Cgpjb250cmFjdCBDcnlwdG9Qb3Juc3RhckF3YXJkIGlzIFBvcm5TY2VuZVRva2VuewogICAgZXZlbnQgQXdhcmQodWludDI1NiBjdXJyZW50QXdhcmRXaW5uZXIsIHVpbnQzMiBhd2FyZFRpbWUpOwogICAgCiAgICB1aW50IG5vbmNlID0gMDsKICAgIHVpbnQgY29vbGRvd25UaW1lID0gNjA7CiAgICB1aW50MzIgYXdhcmRUaW1lID0gdWludDMyKG5vdyk7CiAgICAKICAgIGZ1bmN0aW9uIF90cmlnZ2VyQ29vbGRvd24oKSBpbnRlcm5hbCB7CiAgICAgICAgYXdhcmRUaW1lID0gdWludDMyKG5vdyArIGNvb2xkb3duVGltZSk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIF9pc1RpbWUoKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gKGF3YXJkVGltZSA8PSBub3cpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiByYW5kKHVpbnQgbWluLCB1aW50IG1heCkgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgICAgIG5vbmNlKys7CiAgICAgICAgcmV0dXJuIHVpbnQoa2VjY2FrMjU2KG5vbmNlKSklKG1pbittYXgpLW1pbjsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRDb29sZG93bih1aW50IF9uZXdDb29sZG93bikgcHVibGljIG9ubHlDT08gewogICAgICAgIHJlcXVpcmUgKF9uZXdDb29sZG93biA+IDApOwogICAgICAgIGNvb2xkb3duVGltZSA9IF9uZXdDb29sZG93bjsKICAgICAgICBfdHJpZ2dlckNvb2xkb3duKCk7CiAgICB9IAogICAgCiAgICBmdW5jdGlvbiBnZXRBd2FyZFRpbWUgKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDMyKSB7CiAgICAgICAgcmV0dXJuIGF3YXJkVGltZTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0Q29vbGRvd24gKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBjb29sZG93blRpbWU7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIG5ld0F3YXJkKCkgcHVibGljIG9ubHlDT08geyAgICAgICAgCiAgICAgICAgdWludDI1NiBfdG90YWxQb3Juc3RhcnM7CiAgICAgICAgKF90b3RhbFBvcm5zdGFycykgPSBwb3Juc3RhcnNDb250cmFjdC50b3RhbFN1cHBseSgpOwogICAgICAgIAogICAgICAgIHJlcXVpcmUoX3RvdGFsUG9ybnN0YXJzID4gMCk7CiAgICAgICAgcmVxdWlyZShfaXNUaW1lKCkpOwogICAgICAgIAogICAgICAgIGN1cnJlbnRBd2FyZFdpbm5lciA9IHJhbmQoMCwgX3RvdGFsUG9ybnN0YXJzKTsKICAgICAgICBfdHJpZ2dlckNvb2xkb3duKCk7CiAgICAgICAgCiAgICAgICAgQXdhcmQoY3VycmVudEF3YXJkV2lubmVyLCBhd2FyZFRpbWUpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRDdXJyZW50QXdhcmQoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KXsKICAgICAgICByZXR1cm4gY3VycmVudEF3YXJkV2lubmVyOwogICAgfQogIAp9CgpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQ=='.
	

]
