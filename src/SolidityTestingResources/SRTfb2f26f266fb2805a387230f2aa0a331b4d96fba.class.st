Class {
	#name : #SRTfb2f26f266fb2805a387230f2aa0a331b4d96fba,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTfb2f26f266fb2805a387230f2aa0a331b4d96fba >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9CgpwcmFnbWEgc29saWRpdHkgXjAuNC4xMTsKCgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKCnByYWdtYSBzb2xpZGl0eSBeMC40LjExOwoKCi8qKgogKiBAdGl0bGUgQmFzaWMgdG9rZW4KICogQGRldiBCYXNpYyB2ZXJzaW9uIG9mIFN0YW5kYXJkVG9rZW4sIHdpdGggbm8gYWxsb3dhbmNlcy4KICovCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgLyoqCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CgogICAgLy8gU2FmZU1hdGguc3ViIHdpbGwgdGhyb3cgaWYgdGhlcmUgaXMgbm90IGVub3VnaCBiYWxhbmNlLgogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgKi8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCnByYWdtYSBzb2xpZGl0eSBeMC40LjExOwoKCi8qKgogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKi8KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgpwcmFnbWEgc29saWRpdHkgXjAuNC4xMTsKCgovKioKICogQHRpdGxlIFN0YW5kYXJkIEVSQzIwIHRva2VuCiAqCiAqIEBkZXYgSW1wbGVtZW50YXRpb24gb2YgdGhlIGJhc2ljIHN0YW5kYXJkIHRva2VuLgogKiBAZGV2IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgRmlyc3RCbG9vZDogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sCiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwoKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICB1aW50MjU2IF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKCiAgICAvLyBDaGVjayBpcyBub3QgbmVlZGVkIGJlY2F1c2Ugc3ViKF9hbGxvd2FuY2UsIF92YWx1ZSkgd2lsbCBhbHJlYWR5IHRocm93IGlmIHRoaXMgY29uZGl0aW9uIGlzIG5vdCBtZXQKICAgIC8vIHJlcXVpcmUgKF92YWx1ZSA8PSBfYWxsb3dhbmNlKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAqCiAgICogQmV3YXJlIHRoYXQgY2hhbmdpbmcgYW4gYWxsb3dhbmNlIHdpdGggdGhpcyBtZXRob2QgYnJpbmdzIHRoZSByaXNrIHRoYXQgc29tZW9uZSBtYXkgdXNlIGJvdGggdGhlIG9sZAogICAqIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZSB0cmFuc2FjdGlvbiBvcmRlcmluZy4gT25lIHBvc3NpYmxlIHNvbHV0aW9uIHRvIG1pdGlnYXRlIHRoaXMKICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KCiAgLyoqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgfSBlbHNlIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKfQoKcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgoKLyoqKioqCiogQHRpdGxlIFRoZSBJQ08gQ29udHJhY3QKKi8KY29udHJhY3QgRGFkaVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIE93bmFibGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgLyogUHVibGljIHZhcmlhYmxlcyBvZiB0aGUgdG9rZW4gKi8KICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICJEQURJIjsKICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIkRBREkiOwogICAgdWludDggcHVibGljIGRlY2ltYWxzID0gMTg7CiAgICBzdHJpbmcgcHVibGljIHZlcnNpb24gPSAiSDEuMCI7CgogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgogICAgdWludDI1NiBwdWJsaWMgaHVuZHJlZFBlcmNlbnQgPSAxMDAwOwogICAgdWludDI1NiBwdWJsaWMgZm91bmRlcnNQZXJjZW50T2ZUb3RhbCA9IDIwMDsKICAgIHVpbnQyNTYgcHVibGljIHJlZmVycmFsUGVyY2VudE9mVG90YWwgPSA1MDsKICAgIHVpbnQyNTYgcHVibGljIGVjb3N5c3RlbVBlcmNlbnRPZlRvdGFsID0gMjU7CiAgICB1aW50MjU2IHB1YmxpYyBvcGVyYXRpb25zUGVyY2VudE9mVG90YWwgPSAyNTsKCiAgICB1aW50MjU2IHB1YmxpYyBpbnZlc3RvckNvdW50ID0gMDsKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsUmFpc2VkOyAvLyB0b3RhbCBldGhlciByYWlzZWQgKGluIHdlaSkKICAgIHVpbnQyNTYgcHVibGljIHByZVNhbGVSYWlzZWQgPSAwOyAvLyBldGhlciByYWlzZWQgKGluIHdlaSkKICAgIHVpbnQyNTYgcHVibGljIHB1YmxpY1NhbGVSYWlzZWQgPSAwOyAvLyBldGhlciByYWlzZWQgKGluIHdlaSkKCiAgICAvLyBQYXJ0bmVyU2FsZSB2YXJpYWJsZXMKICAgIHVpbnQyNTYgcHVibGljIHBhcnRuZXJTYWxlVG9rZW5zQXZhaWxhYmxlOwogICAgdWludDI1NiBwdWJsaWMgcGFydG5lclNhbGVUb2tlbnNQdXJjaGFzZWQgPSAwOwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBwdXJjaGFzZWRUb2tlbnM7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIHBhcnRuZXJTYWxlV2VpOwoKICAgIC8vIFByZVNhbGUgdmFyaWFibGVzCiAgICB1aW50MjU2IHB1YmxpYyBwcmVTYWxlVG9rZW5zQXZhaWxhYmxlOwogICAgdWludDI1NiBwdWJsaWMgcHJlU2FsZVRva2Vuc1B1cmNoYXNlZCA9IDA7CgogICAgLy8gUHVibGljU2FsZSB2YXJpYWJsZXMKICAgIHVpbnQyNTYgcHVibGljIHB1YmxpY1NhbGVUb2tlbnNBdmFpbGFibGU7CiAgICB1aW50MjU2IHB1YmxpYyBwdWJsaWNTYWxlVG9rZW5zUHVyY2hhc2VkID0gMDsKCiAgICAvLyBQcmljZSBkYXRhCiAgICB1aW50MjU2IHB1YmxpYyBwYXJ0bmVyU2FsZVRva2VuUHJpY2UgPSAxMjU7ICAgICAvLyBVU0QkMC4xMjUKICAgIHVpbnQyNTYgcHVibGljIHBhcnRuZXJTYWxlVG9rZW5WYWx1ZTsKICAgIHVpbnQyNTYgcHVibGljIHByZVNhbGVUb2tlblByaWNlID0gMjUwOyAgICAgICAgIC8vIFVTRCQwLjI1CiAgICB1aW50MjU2IHB1YmxpYyBwdWJsaWNTYWxlVG9rZW5QcmljZSA9IDUwMDsgICAgICAgLy8gVVNEJDAuNTAKCiAgICAvLyBFVEggdG8gVVNEIFJhdGUsIHNldCBieSBvd25lcjogMSBFVEggPSBldGhSYXRlIFVTRAogICAgdWludDI1NiBwdWJsaWMgZXRoUmF0ZTsKCiAgICAvLyBBZGRyZXNzIHdoaWNoIHdpbGwgcmVjZWl2ZSByYWlzZWQgZnVuZHMgYW5kIG93bnMgdGhlIHRvdGFsIHN1cHBseSBvZiB0b2tlbnMKICAgIGFkZHJlc3MgcHVibGljIGZ1bmRzV2FsbGV0OwogICAgYWRkcmVzcyBwdWJsaWMgZWNvc3lzdGVtV2FsbGV0OwogICAgYWRkcmVzcyBwdWJsaWMgb3BlcmF0aW9uc1dhbGxldDsKICAgIGFkZHJlc3MgcHVibGljIHJlZmVycmFsUHJvZ3JhbW1lV2FsbGV0OwogICAgYWRkcmVzc1tdIHB1YmxpYyBmb3VuZGluZ1RlYW1XYWxsZXRzOwogICAgCiAgICBhZGRyZXNzW10gcHVibGljIHBhcnRuZXJTYWxlV2FsbGV0czsKICAgIGFkZHJlc3NbXSBwdWJsaWMgcHJlU2FsZVdhbGxldHM7CiAgICBhZGRyZXNzW10gcHVibGljIHB1YmxpY1NhbGVXYWxsZXRzOwogICAKICAgIC8qKioqKgogICAgKiBTdGF0ZSBtYWNoaW5lCiAgICAqICAwIC0gUHJlcGFyaW5nOiAgICAgICAgICAgIEFsbCBjb250cmFjdCBpbml0aWFsaXphdGlvbiBjYWxscwogICAgKiAgMSAtIFBhcnRuZXJTYWxlOiAgICAgICAgICBDb250cmFjdCBpcyBpbiB0aGUgaW52aXRlLW9ubHkgUGFydG5lclNhbGUgUGVyaW9kCiAgICAqICA2IC0gUGFydG5lclNhbGVGaW5hbGl6ZWQ6IFBhcnRuZXJTYWxlIGhhcyBjb21wbGV0ZWQKICAgICogIDIgLSBQcmVTYWxlOiAgICAgICAgICAgICAgQ29udHJhY3QgaXMgaW4gdGhlIFByZVNhbGUgUGVyaW9kCiAgICAqICA3IC0gUHJlU2FsZUZpbmFsaXplZDogICAgIFByZVNhbGUgaGFzIGNvbXBsZXRlZAogICAgKiAgMyAtIFB1YmxpY1NhbGU6ICAgICAgICAgICBUaGUgcHVibGljIHNhbGUgb2YgdG9rZW5zLCBmb2xsb3dzIFByZVNhbGUKICAgICogIDggLSBQdWJsaWNTYWxlRmluYWxpemVkOiAgVGhlIFB1YmxpY1NhbGUgaGFzIGNvbXBsZXRlZAogICAgKiAgNCAtIFN1Y2Nlc3M6ICAgICAgICAgICAgICBJQ08gU3VjY2Vzc2Z1bAogICAgKiAgNSAtIEZhaWx1cmU6ICAgICAgICAgICAgICBNaW5pbXVtIGZ1bmRpbmcgZ29hbCBub3QgcmVhY2hlZAogICAgKiAgOSAtIFJlZnVuZGluZzogICAgICAgICAgICBPd25lciBjYW4gdHJhbnNmZXIgcmVmdW5kcwogICAgKiAxMCAtIENsb3NlZDogICAgICAgICAgICAgICBJQ08gaGFzIGZpbmlzaGVkLCBhbGwgdG9rZW5zIG11c3QgaGF2ZSBiZWVuIGNsYWltZWQKICAgICovCiAgICBlbnVtIFNhbGVTdGF0ZSB7IFByZXBhcmluZywgUGFydG5lclNhbGUsIFByZVNhbGUsIFB1YmxpY1NhbGUsIFN1Y2Nlc3MsIEZhaWx1cmUsIFBhcnRuZXJTYWxlRmluYWxpemVkLCBQcmVTYWxlRmluYWxpemVkLCBQdWJsaWNTYWxlRmluYWxpemVkLCBSZWZ1bmRpbmcsIENsb3NlZCB9CiAgICBTYWxlU3RhdGUgcHVibGljIHN0YXRlID0gU2FsZVN0YXRlLlByZXBhcmluZzsKCiAgICAvKioKICAgICogZXZlbnQgZm9yIHRva2VuIHB1cmNoYXNlIGxvZ2dpbmcKICAgICogQHBhcmFtIHB1cmNoYXNlciB3aG8gcGFpZCBmb3IgdGhlIHRva2VucwogICAgKiBAcGFyYW0gYmVuZWZpY2lhcnkgd2hvIGdvdCB0aGUgdG9rZW5zCiAgICAqIEBwYXJhbSB2YWx1ZSB3ZWlzIHBhaWQgZm9yIHB1cmNoYXNlCiAgICAqIEBwYXJhbSB0b2tlbnMgYW1vdW50IG9mIHRva2VucyBwdXJjaGFzZWQKICAgICovCiAgICBldmVudCBMb2dUb2tlblB1cmNoYXNlKGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB2YWx1ZSwgdWludDI1NiB0b2tlbnMpOwogICAgZXZlbnQgTG9nUmVkaXN0cmlidXRlVG9rZW5zKGFkZHJlc3MgcmVjaXBpZW50LCBTYWxlU3RhdGUgc3RhdGUsIHVpbnQyNTYgdG9rZW5zKTsKICAgIGV2ZW50IExvZ1JlZnVuZFByb2Nlc3NlZChhZGRyZXNzIHJlY2lwaWVudCwgdWludDI1NiB2YWx1ZSk7CiAgICBldmVudCBMb2dSZWZ1bmRGYWlsZWQoYWRkcmVzcyByZWNpcGllbnQsIHVpbnQyNTYgdmFsdWUpOwogICAgZXZlbnQgTG9nQ2xhaW1Ub2tlbnMoYWRkcmVzcyByZWNpcGllbnQsIHVpbnQyNTYgdG9rZW5zKTsKICAgIGV2ZW50IExvZ0Z1bmRUcmFuc2ZlcihhZGRyZXNzIHdhbGxldCwgdWludDI1NiB2YWx1ZSk7CgogICAgLyoqKioqCiAgICAqIEBkZXYgTW9kaWZpZXIgdG8gY2hlY2sgdGhhdCBhbW91bnQgdHJhbnNmZXJyZWQgaXMgbm90IDAKICAgICovCiAgICBtb2RpZmllciBub25aZXJvKCkgewogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlICE9IDApOwogICAgICAgIF87CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgVGhlIGNvbnN0cnVjdG9yIGZ1bmN0aW9uIHRvIGluaXRpYWxpemUgdGhlIHRva2VuIHJlbGF0ZWQgcHJvcGVydGllcwogICAgKiBAcGFyYW0gX3dhbGxldCAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3MgICAgIFNwZWNpZmllcyB0aGUgYWRkcmVzcyBvZiB0aGUgZnVuZGluZyB3YWxsZXQKICAgICogQHBhcmFtIF9vcGVyYXRpb25hbFdhbGxldHMgICAgICAgICAgICBhZGRyZXNzW10gICBTcGVjaWZpZXMgYW4gYXJyYXkgb2YgYWRkcmVzc2VzIGZvciBbMF0gZWNvc3lzdGVtLCBbMV0gb3BlcmF0aW9ucywgWzJdIHJlZmVycmFsIHByb2dyYW1tZQogICAgKiBAcGFyYW0gX2ZvdW5kaW5nVGVhbVdhbGxldHMgICAgICAgICAgIGFkZHJlc3NbXSAgIFNwZWNpZmllcyBhbiBhcnJheSBvZiBhZGRyZXNzZXMgb2YgdGhlIGZvdW5kaW5nIHRlYW0gd2FsbGV0cwogICAgKiBAcGFyYW0gX2luaXRpYWxTdXBwbHkgICAgICAgICAgICAgICAgIHVpbnQyNTYgICAgIFNwZWNpZmllcyB0aGUgdG90YWwgbnVtYmVyIG9mIHRva2VucyBhdmFpbGFibGUKICAgICogQHBhcmFtIF90b2tlbnNBdmFpbGFibGUgICAgICAgICAgICAgICB1aW50MjU2W10gICBTcGVjaWZpZXMgYW4gYXJyYXkgb2YgdG9rZW5zIGF2YWlsYWJsZSBmb3IgZWFjaCBwaGFzZSwgWzBdIFBhcnRuZXJTYWxlLCBbMV0gUHJlU2FsZSwgWzJdIFB1YmxpY1NhbGUKICAgICovCiAgICBmdW5jdGlvbiBEYWRpVG9rZW4gKAogICAgICAgIGFkZHJlc3MgX3dhbGxldCwKICAgICAgICBhZGRyZXNzW10gX29wZXJhdGlvbmFsV2FsbGV0cywKICAgICAgICBhZGRyZXNzW10gX2ZvdW5kaW5nVGVhbVdhbGxldHMsCiAgICAgICAgdWludDI1NiBfaW5pdGlhbFN1cHBseSwKICAgICAgICB1aW50MjU2W10gX3Rva2Vuc0F2YWlsYWJsZQogICAgKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX3dhbGxldCAhPSBhZGRyZXNzKDApKTsKCiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogCiAgICAgICAgLy8gVG9rZW4gZGlzdHJpYnV0aW9uIHBlciBzYWxlIHBoYXNlCiAgICAgICAgcGFydG5lclNhbGVUb2tlbnNBdmFpbGFibGUgPSBfdG9rZW5zQXZhaWxhYmxlWzBdOwogICAgICAgIHByZVNhbGVUb2tlbnNBdmFpbGFibGUgPSBfdG9rZW5zQXZhaWxhYmxlWzFdOwogICAgICAgIHB1YmxpY1NhbGVUb2tlbnNBdmFpbGFibGUgPSBfdG9rZW5zQXZhaWxhYmxlWzJdOwoKICAgICAgICAvLyBEZXRlcm1pbmUgdGhlIGFjdHVhbCBzdXBwbHkgdXNpbmcgdG9rZW4gYW1vdW50ICogZGVjaW1hbHMKICAgICAgICB0b3RhbFN1cHBseSA9IF9pbml0aWFsU3VwcGx5ICogKHVpbnQyNTYoMTApICoqIGRlY2ltYWxzKTsKCiAgICAgICAgLy8gR2l2ZSBhbGwgdGhlIGluaXRpYWwgdG9rZW5zIHRvIHRoZSBjb250cmFjdCBvd25lcgogICAgICAgIGJhbGFuY2VzW293bmVyXSA9IHRvdGFsU3VwcGx5OwogICAgICAgIFRyYW5zZmVyKDB4MCwgb3duZXIsIHRvdGFsU3VwcGx5KTsKCiAgICAgICAgLy8gRGlzdHJpYnV0ZSB0b2tlbnMgdG8gdGhlIHN1cHBvcnRpbmcgb3BlcmF0aW9uYWwgd2FsbGV0cwogICAgICAgIGVjb3N5c3RlbVdhbGxldCA9IF9vcGVyYXRpb25hbFdhbGxldHNbMF07CiAgICAgICAgb3BlcmF0aW9uc1dhbGxldCA9IF9vcGVyYXRpb25hbFdhbGxldHNbMV07CiAgICAgICAgcmVmZXJyYWxQcm9ncmFtbWVXYWxsZXQgPSBfb3BlcmF0aW9uYWxXYWxsZXRzWzJdOwogICAgICAgIGZvdW5kaW5nVGVhbVdhbGxldHMgPSBfZm91bmRpbmdUZWFtV2FsbGV0czsKICAgICAgICBmdW5kc1dhbGxldCA9IF93YWxsZXQ7CiAgICAgICAgCiAgICAgICAgLy8gU2V0IGEgYmFzZSBFVEhVU0QgcmF0ZQogICAgICAgIHVwZGF0ZUV0aFJhdGUoMzAwMDAwKTsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBGYWxsYmFjayBGdW5jdGlvbiB0byBidXkgdGhlIHRva2VucwogICAgKi8KICAgIGZ1bmN0aW9uICgpIHBheWFibGUgewogICAgICAgIHJlcXVpcmUoCiAgICAgICAgICAgIHN0YXRlID09IFNhbGVTdGF0ZS5QYXJ0bmVyU2FsZSB8fCAKICAgICAgICAgICAgc3RhdGUgPT0gU2FsZVN0YXRlLlByZVNhbGUgfHwgCiAgICAgICAgICAgIHN0YXRlID09IFNhbGVTdGF0ZS5QdWJsaWNTYWxlCiAgICAgICAgKTsKCiAgICAgICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIsIG1zZy52YWx1ZSk7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgQWxsb3dzIHRyYW5zZmVyIG9mIHRva2VucyB0byBhIHJlY2lwaWVudCB3aG8gaGFzIHB1cmNoYXNlZCBvZmZsaW5lLCBkdXJpbmcgdGhlIFBhcnRuZXJTYWxlCiAgICAqIEBwYXJhbSBfcmVjaXBpZW50ICAgICBhZGRyZXNzICAgICBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50IG9mIHRoZSB0b2tlbnMKICAgICogQHBhcmFtIF90b2tlbnMgICAgICAgIHVpbnQyNTYgICAgIFRoZSBudW1iZXIgb2YgdG9rZW5zIHB1cmNoYXNlZCBieSB0aGUgcmVjaXBpZW50CiAgICAqIEByZXR1cm4gc3VjY2VzcyAgICAgICBib29sICAgICAgICBSZXR1cm5zIHRydWUgaWYgZXhlY3V0ZWQgc3VjY2Vzc2Z1bGx5CiAgICAqLwogICAgZnVuY3Rpb24gb2ZmbGluZVRyYW5zYWN0aW9uIChhZGRyZXNzIF9yZWNpcGllbnQsIHVpbnQyNTYgX3Rva2VucykgcHVibGljIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTYWxlU3RhdGUuUGFydG5lclNhbGUpOwogICAgICAgIHJlcXVpcmUoX3Rva2VucyA+IDApOwoKICAgICAgICAvLyBDb252ZXJ0IHRvIGEgdG9rZW4gd2l0aCBkZWNpbWFscyAKICAgICAgICB1aW50MjU2IHRva2VucyA9IF90b2tlbnMgKiAodWludDI1NigxMCkgKiogZGVjaW1hbHMpOwoKICAgICAgICBwdXJjaGFzZWRUb2tlbnNbX3JlY2lwaWVudF0gPSBwdXJjaGFzZWRUb2tlbnNbX3JlY2lwaWVudF0uYWRkKHRva2Vucyk7CgogICAgICAgIC8vIFVzZSBvcmlnaW5hbCBfdG9rZW4gYXJndW1lbnQgdG8gaW5jcmVhc2UgdGhlIGNvdW50IG9mIHRva2VucyBwdXJjaGFzZWQgaW4gdGhlIFBhcnRuZXJTYWxlCiAgICAgICAgcGFydG5lclNhbGVUb2tlbnNQdXJjaGFzZWQgPSBwYXJ0bmVyU2FsZVRva2Vuc1B1cmNoYXNlZC5hZGQoX3Rva2Vucyk7CgogICAgICAgIC8vIEZpbmFsaXplIHRoZSBQYXJ0bmVyU2FsZSBpZiBuZWNlc3NhcnkKICAgICAgICBpZiAocGFydG5lclNhbGVUb2tlbnNQdXJjaGFzZWQgPj0gcGFydG5lclNhbGVUb2tlbnNBdmFpbGFibGUpIHsKICAgICAgICAgICAgc3RhdGUgPSBTYWxlU3RhdGUuUGFydG5lclNhbGVGaW5hbGl6ZWQ7CiAgICAgICAgfQoKICAgICAgICBMb2dUb2tlblB1cmNoYXNlKG1zZy5zZW5kZXIsIF9yZWNpcGllbnQsIDAsIHRva2Vucyk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IEFsbG93IHVwZGF0aW5nIHRoZSBFVEggVVNEIGV4Y2hhbmdlIHJhdGUKICAgICogQHBhcmFtIHJhdGUgICB1aW50MjU2ICB0aGUgY3VycmVudCBFVEggVVNEIHJhdGUsIG11bHRpcGxpZWQgYnkgMTAwMAogICAgKiBAcmV0dXJuIGJvb2wgIFJldHVybiB0cnVlIGlmIHRoZSBjb250cmFjdCBpcyBpbiBQYXJ0bmVyU2FsZSBQZXJpb2QKICAgICovCiAgICBmdW5jdGlvbiB1cGRhdGVFdGhSYXRlICh1aW50MjU2IHJhdGUpIHB1YmxpYyBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUocmF0ZSA+PSAxMDAwMDApOwogICAgICAgIAogICAgICAgIGV0aFJhdGUgPSByYXRlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IEFsbG93cyB0aGUgY29udHJhY3Qgb3duZXIgdG8gYWRkIGEgbmV3IFBhcnRuZXJTYWxlIHdhbGxldCwgdXNlZCB0byBob2xkIGZ1bmRzIHNhZmVseQogICAgKiAgICAgIENhbiBvbmx5IGJlIHBlcmZvcm1lZCBpbiB0aGUgUHJlcGFyaW5nIHN0YXRlCiAgICAqIEBwYXJhbSBfd2FsbGV0ICAgICAgICBhZGRyZXNzICAgICBUaGUgYWRkcmVzcyBvZiB0aGUgd2FsbGV0CiAgICAqIEByZXR1cm4gc3VjY2VzcyAgICAgICBib29sICAgICAgICBSZXR1cm5zIHRydWUgaWYgZXhlY3V0ZWQgc3VjY2Vzc2Z1bGx5CiAgICAqLwogICAgZnVuY3Rpb24gYWRkUGFydG5lclNhbGVXYWxsZXQgKGFkZHJlc3MgX3dhbGxldCkgcHVibGljIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA8IFNhbGVTdGF0ZS5QYXJ0bmVyU2FsZUZpbmFsaXplZCk7CiAgICAgICAgcmVxdWlyZShfd2FsbGV0ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHBhcnRuZXJTYWxlV2FsbGV0cy5wdXNoKF93YWxsZXQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IEFsbG93cyB0aGUgY29udHJhY3Qgb3duZXIgdG8gYWRkIGEgbmV3IFByZVNhbGUgd2FsbGV0LCB1c2VkIHRvIGhvbGQgZnVuZHMgc2FmZWx5CiAgICAqICAgICAgQ2FuIG5vdCBiZSBwZXJmb3JtZWQgaW4gdGhlIFByZVNhbGUgc3RhdGUKICAgICogQHBhcmFtIF93YWxsZXQgICAgICAgIGFkZHJlc3MgICAgIFRoZSBhZGRyZXNzIG9mIHRoZSB3YWxsZXQKICAgICogQHJldHVybiBzdWNjZXNzICAgICAgIGJvb2wgICAgICAgIFJldHVybnMgdHJ1ZSBpZiBleGVjdXRlZCBzdWNjZXNzZnVsbHkKICAgICovCiAgICBmdW5jdGlvbiBhZGRQcmVTYWxlV2FsbGV0IChhZGRyZXNzIF93YWxsZXQpIHB1YmxpYyBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoc3RhdGUgIT0gU2FsZVN0YXRlLlByZVNhbGUpOwogICAgICAgIHJlcXVpcmUoX3dhbGxldCAhPSBhZGRyZXNzKDApKTsKICAgICAgICBwcmVTYWxlV2FsbGV0cy5wdXNoKF93YWxsZXQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IEFsbG93cyB0aGUgY29udHJhY3Qgb3duZXIgdG8gYWRkIGEgbmV3IFB1YmxpY1NhbGUgd2FsbGV0LCB1c2VkIHRvIGhvbGQgZnVuZHMgc2FmZWx5CiAgICAqICAgICAgQ2FuIG5vdCBiZSBwZXJmb3JtZWQgaW4gdGhlIFB1YmxpY1NhbGUgc3RhdGUKICAgICogQHBhcmFtIF93YWxsZXQgICAgICAgIGFkZHJlc3MgICAgIFRoZSBhZGRyZXNzIG9mIHRoZSB3YWxsZXQKICAgICogQHJldHVybiBzdWNjZXNzICAgICAgIGJvb2wgICAgICAgIFJldHVybnMgdHJ1ZSBpZiBleGVjdXRlZCBzdWNjZXNzZnVsbHkKICAgICovCiAgICBmdW5jdGlvbiBhZGRQdWJsaWNTYWxlV2FsbGV0IChhZGRyZXNzIF93YWxsZXQpIHB1YmxpYyBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoc3RhdGUgIT0gU2FsZVN0YXRlLlB1YmxpY1NhbGUpOwogICAgICAgIHJlcXVpcmUoX3dhbGxldCAhPSBhZGRyZXNzKDApKTsKICAgICAgICBwdWJsaWNTYWxlV2FsbGV0cy5wdXNoKF93YWxsZXQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IENhbGN1bGF0ZXMgdGhlIG51bWJlciBvZiB0b2tlbnMgdGhhdCBjYW4gYmUgYm91Z2h0IGZvciB0aGUgYW1vdW50IG9mIFdlaSB0cmFuc2ZlcnJlZAogICAgKiBAcGFyYW0gX2Ftb3VudCAgICB1aW50MjU2ICAgICBUaGUgYW1vdW50IG9mIG1vbmV5IGludmVzdGVkIGJ5IHRoZSBpbnZlc3RvcgogICAgKiBAcmV0dXJuIHRva2VucyAgICB1aW50MjU2ICAgICBUaGUgbnVtYmVyIG9mIHRva2VucyBwdXJjaGFzZWQgZm9yIHRoZSBhbW91bnQgaW52ZXN0ZWQKICAgICovCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVUb2tlbnMgKHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIHJldHVybnMgKHVpbnQyNTYgdG9rZW5zKSB7CiAgICAgICAgaWYgKGlzU3RhdGVQYXJ0bmVyU2FsZSgpKSB7CiAgICAgICAgICAgIHRva2VucyA9IF9hbW91bnQgKiBldGhSYXRlIC8gcGFydG5lclNhbGVUb2tlblByaWNlOwogICAgICAgIH0gZWxzZSBpZiAoaXNTdGF0ZVByZVNhbGUoKSkgewogICAgICAgICAgICB0b2tlbnMgPSBfYW1vdW50ICogZXRoUmF0ZSAvIHByZVNhbGVUb2tlblByaWNlOwogICAgICAgIH0gZWxzZSBpZiAoaXNTdGF0ZVB1YmxpY1NhbGUoKSkgewogICAgICAgICAgICB0b2tlbnMgPSBfYW1vdW50ICogZXRoUmF0ZSAvIHB1YmxpY1NhbGVUb2tlblByaWNlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRva2VucyA9IDA7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdG9rZW5zOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IENhbGxlZCBieSB0aGUgb3duZXIgb2YgdGhlIGNvbnRyYWN0IHRvIG9wZW4gdGhlIFBhcnRuZXIvUHJlL0Nyb3dkIFNhbGUgcGVyaW9kcwogICAgKi8KICAgIGZ1bmN0aW9uIHNldFBoYXNlICh1aW50MjU2IHBoYXNlKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBzdGF0ZSA9IFNhbGVTdGF0ZSh1aW50KHBoYXNlKSk7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgQ2FsbGVkIGJ5IHRoZSBvd25lciBvZiB0aGUgY29udHJhY3QgdG8gc3RhcnQgdGhlIFBhcnRuZXIgU2FsZQogICAgKiBAcGFyYW0gcmF0ZSAgIHVpbnQyNTYgIHRoZSBjdXJyZW50IEVUSCBVU0QgcmF0ZSwgbXVsdGlwbGllZCBieSAxMDAwCiAgICAqLwogICAgZnVuY3Rpb24gc3RhcnRQYXJ0bmVyU2FsZSAodWludDI1NiByYXRlKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBzdGF0ZSA9IFNhbGVTdGF0ZS5QYXJ0bmVyU2FsZTsKICAgICAgICB1cGRhdGVFdGhSYXRlKHJhdGUpOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IENhbGxlZCBieSB0aGUgb3duZXIgb2YgdGhlIGNvbnRyYWN0IHRvIHN0YXJ0IHRoZSBQcmUgU2FsZQogICAgKiBAcGFyYW0gcmF0ZSAgIHVpbnQyNTYgIHRoZSBjdXJyZW50IEVUSCBVU0QgcmF0ZSwgbXVsdGlwbGllZCBieSAxMDAwCiAgICAqLwogICAgZnVuY3Rpb24gc3RhcnRQcmVTYWxlICh1aW50MjU2IHJhdGUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHN0YXRlID0gU2FsZVN0YXRlLlByZVNhbGU7CiAgICAgICAgdXBkYXRlRXRoUmF0ZShyYXRlKTsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBDYWxsZWQgYnkgdGhlIG93bmVyIG9mIHRoZSBjb250cmFjdCB0byBzdGFydCB0aGUgUHVibGljIFNhbGUKICAgICogQHBhcmFtIHJhdGUgICB1aW50MjU2ICB0aGUgY3VycmVudCBFVEggVVNEIHJhdGUsIG11bHRpcGxpZWQgYnkgMTAwMAogICAgKi8KICAgIGZ1bmN0aW9uIHN0YXJ0UHVibGljU2FsZSAodWludDI1NiByYXRlKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBzdGF0ZSA9IFNhbGVTdGF0ZS5QdWJsaWNTYWxlOwogICAgICAgIHVwZGF0ZUV0aFJhdGUocmF0ZSk7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgQ2FsbGVkIGJ5IHRoZSBvd25lciBvZiB0aGUgY29udHJhY3QgdG8gY2xvc2UgdGhlIFBhcnRuZXIgU2FsZQogICAgKi8KICAgIGZ1bmN0aW9uIGZpbmFsaXplUGFydG5lclNhbGUgKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTYWxlU3RhdGUuUGFydG5lclNhbGUpOwogICAgICAgIAogICAgICAgIHN0YXRlID0gU2FsZVN0YXRlLlBhcnRuZXJTYWxlRmluYWxpemVkOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IENhbGxlZCBieSB0aGUgb3duZXIgb2YgdGhlIGNvbnRyYWN0IHRvIGNsb3NlIHRoZSBQcmUgU2FsZQogICAgKi8KICAgIGZ1bmN0aW9uIGZpbmFsaXplUHJlU2FsZSAoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFNhbGVTdGF0ZS5QcmVTYWxlKTsKICAgICAgICAKICAgICAgICBzdGF0ZSA9IFNhbGVTdGF0ZS5QcmVTYWxlRmluYWxpemVkOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IENhbGxlZCBieSB0aGUgb3duZXIgb2YgdGhlIGNvbnRyYWN0IHRvIGNsb3NlIHRoZSBQdWJsaWMgU2FsZQogICAgKi8KICAgIGZ1bmN0aW9uIGZpbmFsaXplUHVibGljU2FsZSAoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFNhbGVTdGF0ZS5QdWJsaWNTYWxlKTsKICAgICAgICAKICAgICAgICBzdGF0ZSA9IFNhbGVTdGF0ZS5QdWJsaWNTYWxlRmluYWxpemVkOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IENhbGxlZCBieSB0aGUgb3duZXIgb2YgdGhlIGNvbnRyYWN0IHRvIGZpbmFsaXplIHRoZSBJQ08KICAgICogICAgICBhbmQgcmVkaXN0cmlidXRlIGZ1bmRzIGFuZCB1bnNvbGQgdG9rZW5zCiAgICAqLwogICAgZnVuY3Rpb24gZmluYWxpemVJY28gKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTYWxlU3RhdGUuUHVibGljU2FsZUZpbmFsaXplZCk7CgogICAgICAgIHN0YXRlID0gU2FsZVN0YXRlLlN1Y2Nlc3M7CgogICAgICAgIC8vIDIuNSUgb2YgdG90YWwgZ29lcyB0byBEQURJIGVjb3N5c3RlbQogICAgICAgIGRpc3RyaWJ1dGUoZWNvc3lzdGVtV2FsbGV0LCBlY29zeXN0ZW1QZXJjZW50T2ZUb3RhbCk7CgogICAgICAgIC8vIDIuNSUgb2YgdG90YWwgZ29lcyB0byBEQURJKyBvcGVyYXRpb25zCiAgICAgICAgZGlzdHJpYnV0ZShvcGVyYXRpb25zV2FsbGV0LCBvcGVyYXRpb25zUGVyY2VudE9mVG90YWwpOwoKICAgICAgICAvLyA1JSBvZiB0b3RhbCBnb2VzIHRvIHJlZmVycmFsIHByb2dyYW1tZQogICAgICAgIGRpc3RyaWJ1dGUocmVmZXJyYWxQcm9ncmFtbWVXYWxsZXQsIHJlZmVycmFsUGVyY2VudE9mVG90YWwpOwogICAgICAgIAogICAgICAgIC8vIDIwJSBvZiB0b3RhbCBnb2VzIHRvIHRoZSBmb3VuZGluZyB0ZWFtIHdhbGxldHMKICAgICAgICBkaXN0cmlidXRlRm91bmRpbmdUZWFtVG9rZW5zKGZvdW5kaW5nVGVhbVdhbGxldHMpOwoKICAgICAgICAvLyByZWRpc3RyaWJ1dGUgdW5zb2xkIHRva2VucyB0byBEQURJIGVjb3N5c3RlbQogICAgICAgIHVpbnQyNTYgcmVtYWluaW5nUHJlU2FsZVRva2VucyA9IGdldFByZVNhbGVUb2tlbnNBdmFpbGFibGUoKTsKICAgICAgICBwcmVTYWxlVG9rZW5zQXZhaWxhYmxlID0gMDsKICAgICAgICAKICAgICAgICB1aW50MjU2IHJlbWFpbmluZ1B1YmxpY1NhbGVUb2tlbnMgPSBnZXRQdWJsaWNTYWxlVG9rZW5zQXZhaWxhYmxlKCk7CiAgICAgICAgcHVibGljU2FsZVRva2Vuc0F2YWlsYWJsZSA9IDA7CgogICAgICAgIC8vIHdlIG5lZWQgdG8gcmVwcmVzZW50IHRoZSB0b2tlbnMgd2l0aCBpbmNsdWRlZCBkZWNpbWFscwogICAgICAgIC8vIGAyNjQwICoqICgxMCBeIDE4KWAgbm90IGAyNjQwYAogICAgICAgIGlmIChyZW1haW5pbmdQcmVTYWxlVG9rZW5zID4gMCkgewogICAgICAgICAgICByZW1haW5pbmdQcmVTYWxlVG9rZW5zID0gcmVtYWluaW5nUHJlU2FsZVRva2VucyAqICh1aW50MjU2KDEwKSAqKiBkZWNpbWFscyk7CiAgICAgICAgICAgIGJhbGFuY2VzW293bmVyXSA9IGJhbGFuY2VzW293bmVyXS5zdWIocmVtYWluaW5nUHJlU2FsZVRva2Vucyk7CiAgICAgICAgICAgIGJhbGFuY2VzW2Vjb3N5c3RlbVdhbGxldF0gPSBiYWxhbmNlc1tlY29zeXN0ZW1XYWxsZXRdLmFkZChyZW1haW5pbmdQcmVTYWxlVG9rZW5zKTsKICAgICAgICAgICAgVHJhbnNmZXIoMCwgZWNvc3lzdGVtV2FsbGV0LCByZW1haW5pbmdQcmVTYWxlVG9rZW5zKTsKICAgICAgICB9CgogICAgICAgIGlmIChyZW1haW5pbmdQdWJsaWNTYWxlVG9rZW5zID4gMCkgewogICAgICAgICAgICByZW1haW5pbmdQdWJsaWNTYWxlVG9rZW5zID0gcmVtYWluaW5nUHVibGljU2FsZVRva2VucyAqICh1aW50MjU2KDEwKSAqKiBkZWNpbWFscyk7CiAgICAgICAgICAgIGJhbGFuY2VzW293bmVyXSA9IGJhbGFuY2VzW293bmVyXS5zdWIocmVtYWluaW5nUHVibGljU2FsZVRva2Vucyk7CiAgICAgICAgICAgIGJhbGFuY2VzW2Vjb3N5c3RlbVdhbGxldF0gPSBiYWxhbmNlc1tlY29zeXN0ZW1XYWxsZXRdLmFkZChyZW1haW5pbmdQdWJsaWNTYWxlVG9rZW5zKTsKICAgICAgICAgICAgVHJhbnNmZXIoMCwgZWNvc3lzdGVtV2FsbGV0LCByZW1haW5pbmdQdWJsaWNTYWxlVG9rZW5zKTsKICAgICAgICB9CgogICAgICAgIC8vIFRyYW5zZmVyIEVUSCB0byB0aGUgZnVuZGluZyB3YWxsZXQuCiAgICAgICAgaWYgKCFmdW5kc1dhbGxldC5zZW5kKHRoaXMuYmFsYW5jZSkpIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IENhbGxlZCBieSB0aGUgb3duZXIgb2YgdGhlIGNvbnRyYWN0IHRvIGNsb3NlIHRoZSBJQ08KICAgICogICAgICBhbmQgdW5zb2xkIHRva2VucyB0byB0aGUgZWNvc3lzdGVtIHdhbGxldC4gTm8gbW9yZSB0b2tlbnMgCiAgICAqICAgICAgbWF5IGJlIGNsYWltZWQKICAgICovCiAgICBmdW5jdGlvbiBjbG9zZUljbyAoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBzdGF0ZSA9IFNhbGVTdGF0ZS5DbG9zZWQ7CiAgICB9CiAgICAKCiAgICAvKioqKioKICAgICogQGRldiBBbGxvdyBpbnZlc3RvcnMgdG8gY2xhaW0gdGhlaXIgdG9rZW5zIGFmdGVyIHRoZSBJQ08gaXMgZmluYWxpemVkICYgc3VjY2Vzc2Z1bAogICAgKiBAcmV0dXJuICAgYm9vbCAgUmV0dXJuIHRydWUsIGlmIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseQogICAgKi8KICAgIGZ1bmN0aW9uIGNsYWltVG9rZW5zICgpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTYWxlU3RhdGUuU3VjY2Vzcyk7CiAgICAgICAgCiAgICAgICAgLy8gZ2V0IHRoZSB0b2tlbnMgYXZhaWxhYmxlIGZvciB0aGUgc2VuZGVyCiAgICAgICAgdWludDI1NiB0b2tlbnMgPSBwdXJjaGFzZWRUb2tlbnNbbXNnLnNlbmRlcl07CiAgICAgICAgcmVxdWlyZSh0b2tlbnMgPiAwKTsKCiAgICAgICAgcHVyY2hhc2VkVG9rZW5zW21zZy5zZW5kZXJdID0gMDsKCiAgICAgICAgYmFsYW5jZXNbb3duZXJdID0gYmFsYW5jZXNbb3duZXJdLnN1Yih0b2tlbnMpOwogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uYWRkKHRva2Vucyk7CiAgICAgIAogICAgICAgIExvZ0NsYWltVG9rZW5zKG1zZy5zZW5kZXIsIHRva2Vucyk7CiAgICAgICAgVHJhbnNmZXIob3duZXIsIG1zZy5zZW5kZXIsIHRva2Vucyk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgQWxsb3cgaW52ZXN0b3JzIHRvIHRha2UgdGhlaXIgbW9uZXkgYmFjayBhZnRlciBhIGZhaWx1cmUgaW4gdGhlIElDTwogICAgKiBAcGFyYW0gX3JlY2lwaWVudCAgICAgYWRkcmVzcyAgICAgVGhlIGNhbGxlciBvZiB0aGUgZnVuY3Rpb24gd2hvIGlzIGxvb2tpbmcgZm9yIHJlZnVuZAogICAgKiBAcmV0dXJuICAgICAgICAgICAgICAgYm9vbCAgICAgICAgUmV0dXJuIHRydWUsIGlmIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseQogICAgKi8KICAgIGZ1bmN0aW9uIHJlZnVuZCAoYWRkcmVzcyBfcmVjaXBpZW50KSBwdWJsaWMgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFNhbGVTdGF0ZS5SZWZ1bmRpbmcpOwoKICAgICAgICB1aW50MjU2IHZhbHVlID0gcGFydG5lclNhbGVXZWlbX3JlY2lwaWVudF07CiAgICAgICAgCiAgICAgICAgcmVxdWlyZSh2YWx1ZSA+IDApOwoKICAgICAgICBwYXJ0bmVyU2FsZVdlaVtfcmVjaXBpZW50XSA9IDA7CgogICAgICAgIGlmKCFfcmVjaXBpZW50LnNlbmQodmFsdWUpKSB7CiAgICAgICAgICAgIHBhcnRuZXJTYWxlV2VpW19yZWNpcGllbnRdID0gdmFsdWU7CiAgICAgICAgICAgIExvZ1JlZnVuZEZhaWxlZChfcmVjaXBpZW50LCB2YWx1ZSk7CiAgICAgICAgfQoKICAgICAgICBMb2dSZWZ1bmRQcm9jZXNzZWQoX3JlY2lwaWVudCwgdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IEFsbG93cyBvd25lciB0byB3aXRoZHJhdyBmdW5kcyBmcm9tIHRoZSBjb250cmFjdCBiYWxhbmNlIGZvciBtYXJrZXRpbmcgcHVycG9zZXMKICAgICogQHBhcmFtIF9hZGRyZXNzICAgICAgIGFkZHJlc3MgICAgIFRoZSByZWNpcGllbnQgYWRkcmVzcyBmb3IgdGhlIGV0aGVyCiAgICAqIEByZXR1cm4gICAgICAgICAgICAgICBib29sICAgICAgICBSZXR1cm4gdHJ1ZSwgaWYgZXhlY3V0ZWQgc3VjY2Vzc2Z1bGx5CiAgICAqLwogICAgZnVuY3Rpb24gd2l0aGRyYXdGdW5kcyAoYWRkcmVzcyBfYWRkcmVzcywgdWludDI1NiBfYW1vdW50KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBfYWRkcmVzcy50cmFuc2ZlcihfYW1vdW50KTsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBHZW5lcmF0ZXMgYSByYW5kb20gbnVtYmVyIGZyb20gMSB0byBtYXggYmFzZWQgb24gdGhlIGxhc3QgYmxvY2sgaGFzaAogICAgKiBAcGFyYW0gbWF4ICAgICB1aW50ICB0aGUgbWF4aW11bSB2YWx1ZSAKICAgICogQHJldHVybiBhIHJhbmRvbSBudW1iZXIKICAgICovCiAgICBmdW5jdGlvbiBnZXRSYW5kb20odWludCBtYXgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50IHJhbmRvbU51bWJlcikgewogICAgICAgIHJldHVybiAodWludChzaGEzKGJsb2NrLmJsb2NraGFzaChibG9jay5udW1iZXIgLSAxKSkpICUgbWF4KSArIDE7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgQ2FsbGVkIGJ5IHRoZSBvd25lciBvZiB0aGUgY29udHJhY3QgdG8gc2V0IHRoZSBzdGF0ZSB0byBSZWZ1bmRpbmcKICAgICovCiAgICBmdW5jdGlvbiBzZXRSZWZ1bmRpbmcgKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTYWxlU3RhdGUuUGFydG5lclNhbGVGaW5hbGl6ZWQpOwogICAgICAgIAogICAgICAgIHN0YXRlID0gU2FsZVN0YXRlLlJlZnVuZGluZzsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBHZXQgdGhlIG92ZXJhbGwgc3VjY2VzcyBzdGF0ZSBvZiB0aGUgSUNPCiAgICAqIEByZXR1cm4gYm9vbCB3aGV0aGVyIHRoZSBzdGF0ZSBpcyBzdWNjZXNzZnVsLCBvciBub3QKICAgICovCiAgICBmdW5jdGlvbiBpc1N1Y2Nlc3NmdWwgKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3RhdGUgPT0gU2FsZVN0YXRlLlN1Y2Nlc3M7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgR2V0IHRoZSBhbW91bnQgb2YgUHJlU2FsZSB0b2tlbnMgbGVmdCBmb3IgcHVyY2hhc2UKICAgICogQHJldHVybiB1aW50MjU2IHRoZSBjb3VudCBvZiB0b2tlbnMgYXZhaWxhYmxlCiAgICAqLwogICAgZnVuY3Rpb24gZ2V0UHJlU2FsZVRva2Vuc0F2YWlsYWJsZSAoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGlmIChwcmVTYWxlVG9rZW5zQXZhaWxhYmxlID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcHJlU2FsZVRva2Vuc0F2YWlsYWJsZSAtIHByZVNhbGVUb2tlbnNQdXJjaGFzZWQ7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgR2V0IHRoZSBhbW91bnQgb2YgUHVibGljU2FsZSB0b2tlbnMgbGVmdCBmb3IgcHVyY2hhc2UKICAgICogQHJldHVybiB1aW50MjU2IHRoZSBjb3VudCBvZiB0b2tlbnMgYXZhaWxhYmxlCiAgICAqLwogICAgZnVuY3Rpb24gZ2V0UHVibGljU2FsZVRva2Vuc0F2YWlsYWJsZSAoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGlmIChwdWJsaWNTYWxlVG9rZW5zQXZhaWxhYmxlID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcHVibGljU2FsZVRva2Vuc0F2YWlsYWJsZSAtIHB1YmxpY1NhbGVUb2tlbnNQdXJjaGFzZWQ7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgR2V0IHRoZSB0b3RhbCBjb3VudCBvZiB0b2tlbnMgcHVyY2hhc2VkIGluIGFsbCB0aGUgU2FsZSBwZXJpb2RzCiAgICAqIEByZXR1cm4gdWludDI1NiB0aGUgY291bnQgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAgKi8KICAgIGZ1bmN0aW9uIGdldFRva2Vuc1B1cmNoYXNlZCAoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBwYXJ0bmVyU2FsZVRva2Vuc1B1cmNoYXNlZCArIHByZVNhbGVUb2tlbnNQdXJjaGFzZWQgKyBwdWJsaWNTYWxlVG9rZW5zUHVyY2hhc2VkOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IEdldCB0aGUgdG90YWwgYW1vdW50IHJhaXNlZCBpbiB0aGUgUHJlU2FsZSBhbmQgUHVibGljU2FsZSBwZXJpb2RzCiAgICAqIEByZXR1cm4gdWludDI1NiB0aGUgYW1vdW50IHJhaXNlZCwgaW4gV2VpCiAgICAqLwogICAgZnVuY3Rpb24gZ2V0VG90YWxSYWlzZWQgKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gcHJlU2FsZVJhaXNlZCArIHB1YmxpY1NhbGVSYWlzZWQ7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgR2V0IHRoZSBiYWxhbmNlIHNlbnQgdG8gdGhlIGNvbnRyYWN0CiAgICAqIEByZXR1cm4gdWludDI1NiB0aGUgYW1vdW50IHNlbnQgdG8gdGhpcyBjb250cmFjdCwgaW4gV2VpCiAgICAqLwogICAgZnVuY3Rpb24gZ2V0QmFsYW5jZSAoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiB0aGlzLmJhbGFuY2U7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgR2V0IHRoZSBiYWxhbmNlIG9mIHRoZSBmdW5kcyB3YWxsZXQgdXNlZCB0byB0cmFuc2ZlciB0aGUgZmluYWwgYmFsYW5jZQogICAgKiBAcmV0dXJuIHVpbnQyNTYgdGhlIGFtb3VudCBzZW50IHRvIHRoZSBmdW5kcyB3YWxsZXQgYXQgdGhlIGVuZCBvZiB0aGUgSUNPLCBpbiBXZWkKICAgICovCiAgICBmdW5jdGlvbiBnZXRGdW5kc1dhbGxldEJhbGFuY2UgKCkgcHVibGljIGNvbnN0YW50IG9ubHlPd25lciByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGZ1bmRzV2FsbGV0LmJhbGFuY2U7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgR2V0IHRoZSBjb3VudCBvZiB1bmlxdWUgaW52ZXN0b3JzCiAgICAqIEByZXR1cm4gdWludDI1NiB0aGUgdG90YWwgbnVtYmVyIG9mIHVuaXF1ZSBpbnZlc3RvcnMKICAgICovCiAgICBmdW5jdGlvbiBnZXRJbnZlc3RvckNvdW50ICgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGludmVzdG9yQ291bnQ7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgU2VuZCBldGhlciB0byB0aGUgZnVuZCBjb2xsZWN0aW9uIHdhbGxldHMKICAgICovCiAgICBmdW5jdGlvbiBmb3J3YXJkRnVuZHMgKHVpbnQyNTYgX3ZhbHVlKSBpbnRlcm5hbCB7CiAgICAgICAgLy8gaWYgKGlzU3RhdGVQYXJ0bmVyU2FsZSgpKSB7CiAgICAgICAgLy8gICAgIC8vIG1vdmUgZnVuZHMgdG8gYSBwYXJ0bmVyU2FsZVdhbGxldAogICAgICAgIC8vICAgICBpZiAocGFydG5lclNhbGVXYWxsZXRzLmxlbmd0aCA+IDApIHsKICAgICAgICAvLyAgICAgICAgIC8vIFRyYW5zZmVyIEVUSCB0byBhIHJhbmRvbSB3YWxsZXQKICAgICAgICAvLyAgICAgICAgIHVpbnQgYWNjb3VudE51bWJlciA9IGdldFJhbmRvbShwYXJ0bmVyU2FsZVdhbGxldHMubGVuZ3RoKSAtIDE7CiAgICAgICAgLy8gICAgICAgICBhZGRyZXNzIGFjY291bnQgPSBwYXJ0bmVyU2FsZVdhbGxldHNbYWNjb3VudE51bWJlcl07CiAgICAgICAgLy8gICAgICAgICBhY2NvdW50LnRyYW5zZmVyKF92YWx1ZSk7CiAgICAgICAgLy8gICAgICAgICBMb2dGdW5kVHJhbnNmZXIoYWNjb3VudCwgX3ZhbHVlKTsKICAgICAgICAvLyAgICAgfQogICAgICAgIC8vIH0KCiAgICAgICAgdWludCBhY2NvdW50TnVtYmVyOwogICAgICAgIGFkZHJlc3MgYWNjb3VudDsKCiAgICAgICAgaWYgKGlzU3RhdGVQcmVTYWxlKCkpIHsKICAgICAgICAgICAgLy8gbW92ZSBmdW5kcyB0byBhIHByZVNhbGVXYWxsZXQKICAgICAgICAgICAgaWYgKHByZVNhbGVXYWxsZXRzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIC8vIFRyYW5zZmVyIEVUSCB0byBhIHJhbmRvbSB3YWxsZXQKICAgICAgICAgICAgICAgIGFjY291bnROdW1iZXIgPSBnZXRSYW5kb20ocHJlU2FsZVdhbGxldHMubGVuZ3RoKSAtIDE7CiAgICAgICAgICAgICAgICBhY2NvdW50ID0gcHJlU2FsZVdhbGxldHNbYWNjb3VudE51bWJlcl07CiAgICAgICAgICAgICAgICBhY2NvdW50LnRyYW5zZmVyKF92YWx1ZSk7CiAgICAgICAgICAgICAgICBMb2dGdW5kVHJhbnNmZXIoYWNjb3VudCwgX3ZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoaXNTdGF0ZVB1YmxpY1NhbGUoKSkgewogICAgICAgICAgICAvLyBtb3ZlIGZ1bmRzIHRvIGEgcHVibGljU2FsZVdhbGxldAogICAgICAgICAgICBpZiAocHVibGljU2FsZVdhbGxldHMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgLy8gVHJhbnNmZXIgRVRIIHRvIGEgcmFuZG9tIHdhbGxldAogICAgICAgICAgICAgICAgYWNjb3VudE51bWJlciA9IGdldFJhbmRvbShwdWJsaWNTYWxlV2FsbGV0cy5sZW5ndGgpIC0gMTsKICAgICAgICAgICAgICAgIGFjY291bnQgPSBwdWJsaWNTYWxlV2FsbGV0c1thY2NvdW50TnVtYmVyXTsKICAgICAgICAgICAgICAgIGFjY291bnQudHJhbnNmZXIoX3ZhbHVlKTsKICAgICAgICAgICAgICAgIExvZ0Z1bmRUcmFuc2ZlcihhY2NvdW50LCBfdmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIGV4ZWN1dGUgdGhlIHRva2VuIHRyYW5zZmVyIHRvIHRoZSByZWNpcGllbnQKICAgICogICAgICBJbiB0aGUgUGFydG5lclNhbGUgcGVyaW9kLCB0b2tlbiBiYWxhbmNlcyBhcmUgc3RvcmVkIGluIGEgc2VwYXJhdGUgbWFwcGluZywgdG8KICAgICogICAgICBhd2FpdCB0aGUgUGFydG5lclNhbGVGaW5hbGl6ZWQgc3RhdGUsIHdoZW4gaW52ZXN0b3JzIG1heSBjYWxsIGNsYWltVG9rZW5zCiAgICAqIEBwYXJhbSBfcmVjaXBpZW50ICAgICBhZGRyZXNzICAgICBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50IG9mIHRoZSB0b2tlbnMKICAgICogQHBhcmFtIF92YWx1ZSAgICAgICAgIHVpbnQyNTYgICAgIFRoZSBhbW91bnQgaW52ZXN0ZWQgYnkgdGhlIHJlY2lwaWVudAogICAgKiBAcmV0dXJuIHN1Y2Nlc3MgICAgICAgYm9vbCAgICAgICAgUmV0dXJucyB0cnVlIGlmIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseQogICAgKi8KICAgIGZ1bmN0aW9uIGJ1eVRva2VucyAoYWRkcmVzcyBfcmVjaXBpZW50LCB1aW50MjU2IF92YWx1ZSkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHVpbnQyNTYgYm91Z2h0VG9rZW5zID0gY2FsY3VsYXRlVG9rZW5zKF92YWx1ZSk7CiAgICAgICAgcmVxdWlyZShib3VnaHRUb2tlbnMgIT0gMCk7CgogICAgICAgIGlmIChpc1N0YXRlUGFydG5lclNhbGUoKSkgewogICAgICAgICAgICAvLyBhc3NpZ24gdG9rZW5zIHRvIHNlcGFyYXRlIG1hcHBpbmcKICAgICAgICAgICAgcHVyY2hhc2VkVG9rZW5zW19yZWNpcGllbnRdID0gcHVyY2hhc2VkVG9rZW5zW19yZWNpcGllbnRdLmFkZChib3VnaHRUb2tlbnMpOwogICAgICAgICAgICBwYXJ0bmVyU2FsZVdlaVtfcmVjaXBpZW50XSA9IHBhcnRuZXJTYWxlV2VpW19yZWNpcGllbnRdLmFkZChfdmFsdWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIGluY3JlbWVudCB0aGUgdW5pcXVlIGludmVzdG9yIGNvdW50CiAgICAgICAgICAgIGlmIChwdXJjaGFzZWRUb2tlbnNbX3JlY2lwaWVudF0gPT0gMCkgewogICAgICAgICAgICAgICAgaW52ZXN0b3JDb3VudCsrOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBhc3NpZ24gdG9rZW5zIHRvIHNlcGFyYXRlIG1hcHBpbmcsIHRoYXQgaXMgbm90ICJiYWxhbmNlcyIKICAgICAgICAgICAgcHVyY2hhc2VkVG9rZW5zW19yZWNpcGllbnRdID0gcHVyY2hhc2VkVG9rZW5zW19yZWNpcGllbnRdLmFkZChib3VnaHRUb2tlbnMpOwogICAgICAgIH0KCiAgICAgICAKICAgICAgICBMb2dUb2tlblB1cmNoYXNlKG1zZy5zZW5kZXIsIF9yZWNpcGllbnQsIF92YWx1ZSwgYm91Z2h0VG9rZW5zKTsKCiAgICAgICAgZm9yd2FyZEZ1bmRzKF92YWx1ZSk7CgogICAgICAgIHVwZGF0ZVNhbGVQYXJhbWV0ZXJzKF92YWx1ZSwgYm91Z2h0VG9rZW5zKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgSW50ZXJuYWwgZnVuY3Rpb24gdG8gbW9kaWZ5IHBhcmFtZXRlcnMgYmFzZWQgb24gdG9rZW5zIGJvdWdodAogICAgKiBAcGFyYW0gX3ZhbHVlICAgICAgICAgdWludDI1NiAgICAgVGhlIGFtb3VudCBpbnZlc3RlZCBpbiBleGNoYW5nZSBmb3IgdGhlIHRva2VucwogICAgKiBAcGFyYW0gX3Rva2VucyAgICAgICAgdWludDI1NiAgICAgVGhlIG51bWJlciBvZiB0b2tlbnMgcHVyY2hhc2VkCiAgICAqIEByZXR1cm4gc3VjY2VzcyAgICAgICBib29sICAgICAgICBSZXR1cm5zIHRydWUgaWYgZXhlY3V0ZWQgc3VjY2Vzc2Z1bGx5CiAgICAqLwogICAgZnVuY3Rpb24gdXBkYXRlU2FsZVBhcmFtZXRlcnMgKHVpbnQyNTYgX3ZhbHVlLCB1aW50MjU2IF90b2tlbnMpIGludGVybmFsIHJldHVybnMgKGJvb2wpIHsKICAgICAgICAvLyB3ZSBuZWVkIHRvIHJlcHJlc2VudCB0aGUgaW50ZWdlciB2YWx1ZSBvZiB0b2tlbnMgaGVyZQogICAgICAgIC8vIHRva2Vuc1B1cmNoYXNlZCA9IGAyNjQwYCwgbm90IGAyNjQwICoqICgxMCBeIDE4KWAKICAgICAgICB1aW50MjU2IHRva2VucyA9IF90b2tlbnMgLyAodWludDI1NigxMCkgKiogZGVjaW1hbHMpOwoKICAgICAgICBpZiAoaXNTdGF0ZVBhcnRuZXJTYWxlKCkpIHsKICAgICAgICAgICAgcGFydG5lclNhbGVUb2tlbnNQdXJjaGFzZWQgPSBwYXJ0bmVyU2FsZVRva2Vuc1B1cmNoYXNlZC5hZGQodG9rZW5zKTsKCiAgICAgICAgICAgIC8vIE5vIFBhcnRuZXJTYWxlIHRva2VucyByZW1haW5pbmcKICAgICAgICAgICAgaWYgKHBhcnRuZXJTYWxlVG9rZW5zUHVyY2hhc2VkID49IHBhcnRuZXJTYWxlVG9rZW5zQXZhaWxhYmxlKSB7CiAgICAgICAgICAgICAgICBzdGF0ZSA9IFNhbGVTdGF0ZS5QYXJ0bmVyU2FsZUZpbmFsaXplZDsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoaXNTdGF0ZVByZVNhbGUoKSkgewogICAgICAgICAgICBwcmVTYWxlVG9rZW5zUHVyY2hhc2VkID0gcHJlU2FsZVRva2Vuc1B1cmNoYXNlZC5hZGQodG9rZW5zKTsKCiAgICAgICAgICAgIHByZVNhbGVSYWlzZWQgPSBwcmVTYWxlUmFpc2VkLmFkZChfdmFsdWUpOwoKICAgICAgICAgICAgLy8gTm8gUHJlU2FsZSB0b2tlbnMgcmVtYWluaW5nCiAgICAgICAgICAgIGlmIChwcmVTYWxlVG9rZW5zUHVyY2hhc2VkID49IHByZVNhbGVUb2tlbnNBdmFpbGFibGUpIHsKICAgICAgICAgICAgICAgIHN0YXRlID0gU2FsZVN0YXRlLlByZVNhbGVGaW5hbGl6ZWQ7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGlzU3RhdGVQdWJsaWNTYWxlKCkpIHsKICAgICAgICAgICAgcHVibGljU2FsZVRva2Vuc1B1cmNoYXNlZCA9IHB1YmxpY1NhbGVUb2tlbnNQdXJjaGFzZWQuYWRkKHRva2Vucyk7CgogICAgICAgICAgICBwdWJsaWNTYWxlUmFpc2VkID0gcHVibGljU2FsZVJhaXNlZC5hZGQoX3ZhbHVlKTsKCiAgICAgICAgICAgIC8vIE5vIFB1YmxpY1NhbGUgdG9rZW5zIHJlbWFpbmluZwogICAgICAgICAgICBpZiAocHVibGljU2FsZVRva2Vuc1B1cmNoYXNlZCA+PSBwdWJsaWNTYWxlVG9rZW5zQXZhaWxhYmxlKSB7CiAgICAgICAgICAgICAgICBzdGF0ZSA9IFNhbGVTdGF0ZS5QdWJsaWNTYWxlRmluYWxpemVkOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IEludGVybmFsIGNhbGN1bGF0aW9uIGZvciB0aGUgYW1vdW50IG9mIFdlaSB0aGUgc3BlY2lmaWVkIHRva2VucyBhcmUgd29ydGgKICAgICogQHBhcmFtIF90b2tlbnMgICAgdWludDI1NiAgICAgVGhlIG51bWJlciBvZiB0b2tlbnMgcHVyY2hhc2VkIGJ5IHRoZSBpbnZlc3RvcgogICAgKiBAcmV0dXJuIGFtb3VudCAgICB1aW50MjU2ICAgICBUaGUgYW1vdW50IHRoZSB0b2tlbnMgYXJlIHdvcnRoCiAgICAqLwogICAgZnVuY3Rpb24gY2FsY3VsYXRlVmFsdWVGcm9tVG9rZW5zICh1aW50MjU2IF90b2tlbnMpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IGFtb3VudCA9IF90b2tlbnMuZGl2KGV0aFJhdGUuZGl2KHBhcnRuZXJTYWxlVG9rZW5QcmljZSkpOwogICAgICAgIHJldHVybiBhbW91bnQ7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgUHJpdmF0ZSBmdW5jdGlvbiB0byBkaXN0cmlidXRlIHRva2VucyBldmVubHkgYW1vbmdzdCB0aGUgZm91bmRpbmcgdGVhbSB3YWxsZXQgYWRkcmVzc2VzCiAgICAqIEBwYXJhbSBfcmVjaXBpZW50cyAgICBhZGRyZXNzW10gICBBbiBhcnJheSBvZiBmb3VuZGluZyB0ZWFtIHdhbGxldCBhZGRyZXNzZXMKICAgICogQHJldHVybiBzdWNjZXNzICAgICAgIGJvb2wgICAgICAgIFJldHVybnMgdHJ1ZSBpZiBleGVjdXRlZCBzdWNjZXNzZnVsbHkKICAgICovCiAgICBmdW5jdGlvbiBkaXN0cmlidXRlRm91bmRpbmdUZWFtVG9rZW5zIChhZGRyZXNzW10gX3JlY2lwaWVudHMpIHByaXZhdGUgcmV0dXJucyAoYm9vbCkgewogICAgICAgIC8vIGRldGVybWluZSB0aGUgc3BsaXQgYmV0d2VlbiB3YWxsZXRzCiAgICAgICAgLy8gdG8gYXJyaXZlIGF0IGEgdmFsaWQgcGVyY2VudGFnZSB3ZSBzdGFydCB0aGUgcGVyY2VudGFnZSB0aGUgZm91bmRpbmcgdGVhbSBoYXMKICAgICAgICAvLyBhdmFpbGFibGUsIHdoaWNoIGlzIDIwJSBvZiB0aGUgdG90YWwgc3VwcGx5LiBUaGUgcGVyY2VudGFnZSB0byBkaXN0cmlidXRlIHRoZW4gaXMgdGhlCiAgICAgICAgLy8gdG90YWwgcGVyY2VudGFnZSBkaXZpZGVkIGJ5IHRoZSBudW1iZXIgb2YgZm91bmRpbmcgdGVhbSB3YWxsZXRzIChsaWtlbHkgNCkuCiAgICAgICAgdWludCBwZXJjZW50YWdlID0gZm91bmRlcnNQZXJjZW50T2ZUb3RhbCAvIF9yZWNpcGllbnRzLmxlbmd0aDsKCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgX3JlY2lwaWVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgZGlzdHJpYnV0ZShfcmVjaXBpZW50c1tpXSwgcGVyY2VudGFnZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IFByaXZhdGUgZnVuY3Rpb24gdG8gbW92ZSB0b2tlbnMgdG8gdGhlIHNwZWNpZmllZCB3YWxsZXQgYWRkcmVzcwogICAgKiBAcGFyYW0gX3JlY2lwaWVudCAgICAgYWRkcmVzcyAgICAgVGhlIGFkZHJlc3Mgb2YgdGhlIHdhbGxldCB0byBtb3ZlIHRva2VucyB0bwogICAgKiBAcGFyYW0gcGVyY2VudGFnZSAgICAgdWludCAgICAgICAgVGhlIHBlcmNlbnRhZ2Ugb2YgdGhlIHRvdGFsIHN1cHBseSBvZiB0b2tlbnMgdG8gbW92ZQogICAgKiBAcmV0dXJuIHN1Y2Nlc3MgICAgICAgYm9vbCAgICAgICAgUmV0dXJucyB0cnVlIGlmIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseQogICAgKi8KICAgIGZ1bmN0aW9uIGRpc3RyaWJ1dGUgKGFkZHJlc3MgX3JlY2lwaWVudCwgdWludCBwZXJjZW50YWdlKSBwcml2YXRlIHJldHVybnMgKGJvb2wpIHsKICAgICAgICB1aW50MjU2IHRva2VucyA9IHRvdGFsU3VwcGx5IC8gKGh1bmRyZWRQZXJjZW50IC8gcGVyY2VudGFnZSk7CgogICAgICAgIGJhbGFuY2VzW293bmVyXSA9IGJhbGFuY2VzW293bmVyXS5zdWIodG9rZW5zKTsKICAgICAgICBiYWxhbmNlc1tfcmVjaXBpZW50XSA9IGJhbGFuY2VzW19yZWNpcGllbnRdLmFkZCh0b2tlbnMpOwogICAgICAgIFRyYW5zZmVyKDAsIF9yZWNpcGllbnQsIHRva2Vucyk7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgQ2hlY2sgdGhlIFBhcnRuZXJTYWxlIHN0YXRlIG9mIHRoZSBjb250cmFjdAogICAgKiBAcmV0dXJuIGJvb2wgIFJldHVybiB0cnVlIGlmIHRoZSBjb250cmFjdCBpcyBpbiB0aGUgUGFydG5lclNhbGUgc3RhdGUKICAgICovCiAgICBmdW5jdGlvbiBpc1N0YXRlUGFydG5lclNhbGUgKCkgcHJpdmF0ZSBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN0YXRlID09IFNhbGVTdGF0ZS5QYXJ0bmVyU2FsZTsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBDaGVjayB0aGUgUHJlU2FsZSBzdGF0ZSBvZiB0aGUgY29udHJhY3QKICAgICogQHJldHVybiBib29sICBSZXR1cm4gdHJ1ZSBpZiB0aGUgY29udHJhY3QgaXMgaW4gdGhlIFByZVNhbGUgc3RhdGUKICAgICovCiAgICBmdW5jdGlvbiBpc1N0YXRlUHJlU2FsZSAoKSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3RhdGUgPT0gU2FsZVN0YXRlLlByZVNhbGU7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgQ2hlY2sgdGhlIFB1YmxpY1NhbGUgc3RhdGUgb2YgdGhlIGNvbnRyYWN0CiAgICAqIEByZXR1cm4gYm9vbCAgUmV0dXJuIHRydWUgaWYgdGhlIGNvbnRyYWN0IGlzIGluIHRoZSBQdWJsaWNTYWxlIHN0YXRlCiAgICAqLwogICAgZnVuY3Rpb24gaXNTdGF0ZVB1YmxpY1NhbGUgKCkgcHJpdmF0ZSBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN0YXRlID09IFNhbGVTdGF0ZS5QdWJsaWNTYWxlOwogICAgfQp9'.
	

]
