Class {
	#name : #SRT672a1ad4f667fb18a333af13667aa0af1f5b5bdd,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT672a1ad4f667fb18a333af13667aa0af1f5b5bdd >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKGEgPT0gMCkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogIC8qKgogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCi8qKgogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKi8KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CgoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqLwogIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9CgovKioKICogQHRpdGxlIE1pbnRhYmxlIHRva2VuCiAqIEBkZXYgU2ltcGxlIEVSQzIwIFRva2VuIGV4YW1wbGUsIHdpdGggbWludGFibGUgdG9rZW4gY3JlYXRpb24KICogQGRldiBJc3N1ZTogKiBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5L2lzc3Vlcy8xMjAKICogQmFzZWQgb24gY29kZSBieSBUb2tlbk1hcmtldE5ldDogaHR0cHM6Ly9naXRodWIuY29tL1Rva2VuTWFya2V0TmV0L2ljby9ibG9iL21hc3Rlci9jb250cmFjdHMvTWludGFibGVUb2tlbi5zb2wKICovCgpjb250cmFjdCBNaW50YWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIE93bmFibGUgewogIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGFtb3VudCk7CiAgZXZlbnQgTWludEZpbmlzaGVkKCk7CgogIGJvb2wgcHVibGljIG1pbnRpbmdGaW5pc2hlZCA9IGZhbHNlOwoKCiAgbW9kaWZpZXIgY2FuTWludCgpIHsKICAgIHJlcXVpcmUoIW1pbnRpbmdGaW5pc2hlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBtaW50IHRva2VucwogICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIG1pbnRlZCB0b2tlbnMuCiAgICogQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gbWludC4KICAgKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgb25seU93bmVyIGNhbk1pbnQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKF9hbW91bnQpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF9hbW91bnQpOwogICAgTWludChfdG8sIF9hbW91bnQpOwogICAgVHJhbnNmZXIoYWRkcmVzcygwKSwgX3RvLCBfYW1vdW50KTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBzdG9wIG1pbnRpbmcgbmV3IHRva2Vucy4KICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBmaW5pc2hNaW50aW5nKCkgb25seU93bmVyIGNhbk1pbnQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIG1pbnRpbmdGaW5pc2hlZCA9IHRydWU7CiAgICBNaW50RmluaXNoZWQoKTsKICAgIHJldHVybiB0cnVlOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBDYXBwZWQgdG9rZW4KICogQGRldiBNaW50YWJsZSB0b2tlbiB3aXRoIGEgdG9rZW4gY2FwLgogKi8KCmNvbnRyYWN0IENhcHBlZFRva2VuIGlzIE1pbnRhYmxlVG9rZW4gewoKICB1aW50MjU2IHB1YmxpYyBjYXA7CgogIGZ1bmN0aW9uIENhcHBlZFRva2VuKHVpbnQyNTYgX2NhcCkgcHVibGljIHsKICAgIHJlcXVpcmUoX2NhcCA+IDApOwogICAgY2FwID0gX2NhcDsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gbWludCB0b2tlbnMKICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCByZWNlaXZlIHRoZSBtaW50ZWQgdG9rZW5zLgogICAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIG1pbnQuCiAgICogQHJldHVybiBBIGJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIG9ubHlPd25lciBjYW5NaW50IHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKHRvdGFsU3VwcGx5LmFkZChfYW1vdW50KSA8PSBjYXApOwoKICAgIHJldHVybiBzdXBlci5taW50KF90bywgX2Ftb3VudCk7CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBTYWZlRVJDMjAKICogQGRldiBXcmFwcGVycyBhcm91bmQgRVJDMjAgb3BlcmF0aW9ucyB0aGF0IHRocm93IG9uIGZhaWx1cmUuCiAqIFRvIHVzZSB0aGlzIGxpYnJhcnkgeW91IGNhbiBhZGQgYSBgdXNpbmcgU2FmZUVSQzIwIGZvciBFUkMyMDtgIHN0YXRlbWVudCB0byB5b3VyIGNvbnRyYWN0LAogKiB3aGljaCBhbGxvd3MgeW91IHRvIGNhbGwgdGhlIHNhZmUgb3BlcmF0aW9ucyBhcyBgdG9rZW4uc2FmZVRyYW5zZmVyKC4uLilgLCBldGMuCiAqLwpsaWJyYXJ5IFNhZmVFUkMyMCB7CiAgZnVuY3Rpb24gc2FmZVRyYW5zZmVyKEVSQzIwQmFzaWMgdG9rZW4sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHsKICAgIGFzc2VydCh0b2tlbi50cmFuc2Zlcih0bywgdmFsdWUpKTsKICB9CgogIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlckZyb20oRVJDMjAgdG9rZW4sIGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgaW50ZXJuYWwgewogICAgYXNzZXJ0KHRva2VuLnRyYW5zZmVyRnJvbShmcm9tLCB0bywgdmFsdWUpKTsKICB9CgogIGZ1bmN0aW9uIHNhZmVBcHByb3ZlKEVSQzIwIHRva2VuLCBhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHsKICAgIGFzc2VydCh0b2tlbi5hcHByb3ZlKHNwZW5kZXIsIHZhbHVlKSk7CiAgfQp9CgovKioKICogQHRpdGxlIFRva2VuVmVzdGluZwogKiBAZGV2IEEgdG9rZW4gaG9sZGVyIGNvbnRyYWN0IHRoYXQgY2FuIHJlbGVhc2UgaXRzIHRva2VuIGJhbGFuY2UgZ3JhZHVhbGx5IGxpa2UgYQogKiB0eXBpY2FsIHZlc3Rpbmcgc2NoZW1lLCB3aXRoIGEgY2xpZmYgYW5kIHZlc3RpbmcgcGVyaW9kLiBPcHRpb25hbGx5IHJldm9jYWJsZSBieSB0aGUKICogb3duZXIuCiAqLwpjb250cmFjdCBUb2tlblZlc3RpbmcgaXMgT3duYWJsZSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CiAgdXNpbmcgU2FmZUVSQzIwIGZvciBFUkMyMEJhc2ljOwoKICBldmVudCBSZWxlYXNlZCh1aW50MjU2IGFtb3VudCk7CiAgZXZlbnQgUmV2b2tlZCgpOwoKICAvLyBiZW5lZmljaWFyeSBvZiB0b2tlbnMgYWZ0ZXIgdGhleSBhcmUgcmVsZWFzZWQKICBhZGRyZXNzIHB1YmxpYyBiZW5lZmljaWFyeTsKCiAgdWludDI1NiBwdWJsaWMgY2xpZmY7CiAgdWludDI1NiBwdWJsaWMgc3RhcnQ7CiAgdWludDI1NiBwdWJsaWMgZHVyYXRpb247CgogIGJvb2wgcHVibGljIHJldm9jYWJsZTsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgcmVsZWFzZWQ7CiAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgcmV2b2tlZDsKCiAgLyoqCiAgICogQGRldiBDcmVhdGVzIGEgdmVzdGluZyBjb250cmFjdCB0aGF0IHZlc3RzIGl0cyBiYWxhbmNlIG9mIGFueSBFUkMyMCB0b2tlbiB0byB0aGUKICAgKiBfYmVuZWZpY2lhcnksIGdyYWR1YWxseSBpbiBhIGxpbmVhciBmYXNoaW9uIHVudGlsIF9zdGFydCArIF9kdXJhdGlvbi4gQnkgdGhlbiBhbGwKICAgKiBvZiB0aGUgYmFsYW5jZSB3aWxsIGhhdmUgdmVzdGVkLgogICAqIEBwYXJhbSBfYmVuZWZpY2lhcnkgYWRkcmVzcyBvZiB0aGUgYmVuZWZpY2lhcnkgdG8gd2hvbSB2ZXN0ZWQgdG9rZW5zIGFyZSB0cmFuc2ZlcnJlZAogICAqIEBwYXJhbSBfY2xpZmYgZHVyYXRpb24gaW4gc2Vjb25kcyBvZiB0aGUgY2xpZmYgaW4gd2hpY2ggdG9rZW5zIHdpbGwgYmVnaW4gdG8gdmVzdAogICAqIEBwYXJhbSBfZHVyYXRpb24gZHVyYXRpb24gaW4gc2Vjb25kcyBvZiB0aGUgcGVyaW9kIGluIHdoaWNoIHRoZSB0b2tlbnMgd2lsbCB2ZXN0CiAgICogQHBhcmFtIF9yZXZvY2FibGUgd2hldGhlciB0aGUgdmVzdGluZyBpcyByZXZvY2FibGUgb3Igbm90CiAgICovCiAgZnVuY3Rpb24gVG9rZW5WZXN0aW5nKGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCB1aW50MjU2IF9zdGFydCwgdWludDI1NiBfY2xpZmYsIHVpbnQyNTYgX2R1cmF0aW9uLCBib29sIF9yZXZvY2FibGUpIHB1YmxpYyB7CiAgICByZXF1aXJlKF9iZW5lZmljaWFyeSAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX2NsaWZmIDw9IF9kdXJhdGlvbik7CgogICAgYmVuZWZpY2lhcnkgPSBfYmVuZWZpY2lhcnk7CiAgICByZXZvY2FibGUgPSBfcmV2b2NhYmxlOwogICAgZHVyYXRpb24gPSBfZHVyYXRpb247CiAgICBjbGlmZiA9IF9zdGFydC5hZGQoX2NsaWZmKTsKICAgIHN0YXJ0ID0gX3N0YXJ0OwogIH0KCiAgLyoqCiAgICogQG5vdGljZSBUcmFuc2ZlcnMgdmVzdGVkIHRva2VucyB0byBiZW5lZmljaWFyeS4KICAgKiBAcGFyYW0gdG9rZW4gRVJDMjAgdG9rZW4gd2hpY2ggaXMgYmVpbmcgdmVzdGVkCiAgICovCiAgZnVuY3Rpb24gcmVsZWFzZShFUkMyMEJhc2ljIHRva2VuKSBwdWJsaWMgewogICAgdWludDI1NiB1bnJlbGVhc2VkID0gcmVsZWFzYWJsZUFtb3VudCh0b2tlbik7CgogICAgcmVxdWlyZSh1bnJlbGVhc2VkID4gMCk7CgogICAgcmVsZWFzZWRbdG9rZW5dID0gcmVsZWFzZWRbdG9rZW5dLmFkZCh1bnJlbGVhc2VkKTsKCiAgICB0b2tlbi5zYWZlVHJhbnNmZXIoYmVuZWZpY2lhcnksIHVucmVsZWFzZWQpOwoKICAgIFJlbGVhc2VkKHVucmVsZWFzZWQpOwogIH0KCiAgLyoqCiAgICogQG5vdGljZSBBbGxvd3MgdGhlIG93bmVyIHRvIHJldm9rZSB0aGUgdmVzdGluZy4gVG9rZW5zIGFscmVhZHkgdmVzdGVkCiAgICogcmVtYWluIGluIHRoZSBjb250cmFjdCwgdGhlIHJlc3QgYXJlIHJldHVybmVkIHRvIHRoZSBvd25lci4KICAgKiBAcGFyYW0gdG9rZW4gRVJDMjAgdG9rZW4gd2hpY2ggaXMgYmVpbmcgdmVzdGVkCiAgICovCiAgZnVuY3Rpb24gcmV2b2tlKEVSQzIwQmFzaWMgdG9rZW4pIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShyZXZvY2FibGUpOwogICAgcmVxdWlyZSghcmV2b2tlZFt0b2tlbl0pOwoKICAgIHVpbnQyNTYgYmFsYW5jZSA9IHRva2VuLmJhbGFuY2VPZih0aGlzKTsKCiAgICB1aW50MjU2IHVucmVsZWFzZWQgPSByZWxlYXNhYmxlQW1vdW50KHRva2VuKTsKICAgIHVpbnQyNTYgcmVmdW5kID0gYmFsYW5jZS5zdWIodW5yZWxlYXNlZCk7CgogICAgcmV2b2tlZFt0b2tlbl0gPSB0cnVlOwoKICAgIHRva2VuLnNhZmVUcmFuc2Zlcihvd25lciwgcmVmdW5kKTsKCiAgICBSZXZva2VkKCk7CiAgfQoKICAvKioKICAgKiBAZGV2IENhbGN1bGF0ZXMgdGhlIGFtb3VudCB0aGF0IGhhcyBhbHJlYWR5IHZlc3RlZCBidXQgaGFzbid0IGJlZW4gcmVsZWFzZWQgeWV0LgogICAqIEBwYXJhbSB0b2tlbiBFUkMyMCB0b2tlbiB3aGljaCBpcyBiZWluZyB2ZXN0ZWQKICAgKi8KICBmdW5jdGlvbiByZWxlYXNhYmxlQW1vdW50KEVSQzIwQmFzaWMgdG9rZW4pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiB2ZXN0ZWRBbW91bnQodG9rZW4pLnN1YihyZWxlYXNlZFt0b2tlbl0pOwogIH0KCiAgLyoqCiAgICogQGRldiBDYWxjdWxhdGVzIHRoZSBhbW91bnQgdGhhdCBoYXMgYWxyZWFkeSB2ZXN0ZWQuCiAgICogQHBhcmFtIHRva2VuIEVSQzIwIHRva2VuIHdoaWNoIGlzIGJlaW5nIHZlc3RlZAogICAqLwogIGZ1bmN0aW9uIHZlc3RlZEFtb3VudChFUkMyMEJhc2ljIHRva2VuKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGN1cnJlbnRCYWxhbmNlID0gdG9rZW4uYmFsYW5jZU9mKHRoaXMpOwogICAgdWludDI1NiB0b3RhbEJhbGFuY2UgPSBjdXJyZW50QmFsYW5jZS5hZGQocmVsZWFzZWRbdG9rZW5dKTsKCiAgICBpZiAobm93IDwgY2xpZmYpIHsKICAgICAgcmV0dXJuIDA7CiAgICB9IGVsc2UgaWYgKG5vdyA+PSBzdGFydC5hZGQoZHVyYXRpb24pIHx8IHJldm9rZWRbdG9rZW5dKSB7CiAgICAgIHJldHVybiB0b3RhbEJhbGFuY2U7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gdG90YWxCYWxhbmNlLm11bChub3cuc3ViKHN0YXJ0KSkuZGl2KGR1cmF0aW9uKTsKICAgIH0KICB9Cn0KCmNvbnRyYWN0IE1vbnRobHlUb2tlblZlc3RpbmcgaXMgVG9rZW5WZXN0aW5nIHsKCiAgICB1aW50MjU2IHB1YmxpYyBwcmV2aW91c1Rva2VuVmVzdGluZyA9IDA7CgogICAgZnVuY3Rpb24gTW9udGhseVRva2VuVmVzdGluZygKICAgICAgICBhZGRyZXNzIF9iZW5lZmljaWFyeSwKICAgICAgICB1aW50MjU2IF9zdGFydCwKICAgICAgICB1aW50MjU2IF9jbGlmZiwKICAgICAgICB1aW50MjU2IF9kdXJhdGlvbiwKICAgICAgICBib29sIF9yZXZvY2FibGUKICAgICkgcHVibGljCiAgICBUb2tlblZlc3RpbmcoX2JlbmVmaWNpYXJ5LCBfc3RhcnQsIF9jbGlmZiwgX2R1cmF0aW9uLCBfcmV2b2NhYmxlKQogICAgeyB9CgoKICAgIGZ1bmN0aW9uIHJlbGVhc2UoRVJDMjBCYXNpYyB0b2tlbikgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShub3cgPj0gcHJldmlvdXNUb2tlblZlc3RpbmcgKyAzMCBkYXlzKTsKICAgICAgICBzdXBlci5yZWxlYXNlKHRva2VuKTsKICAgICAgICBwcmV2aW91c1Rva2VuVmVzdGluZyA9IG5vdzsKICAgIH0KfQoKY29udHJhY3QgQ1JFRFRva2VuIGlzIENhcHBlZFRva2VuIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIC8qKgogICAgICogQ29uc3RhbnQgZmllbGRzCiAgICAgKi8KCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiVmVyaWZ5IFRva2VuIjsKICAgIHVpbnQ4IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiQ1JFRCI7CgogICAgLyoqCiAgICAgKiBJbW11dGFibGUgc3RhdGUgdmFyaWFibGVzCiAgICAgKi8KCiAgICAvLyBUaW1lIHdoZW4gdGVhbSBhbmQgcmVzZXJ2ZWQgdG9rZW5zIGFyZSB1bmxvY2tlZAogICAgdWludDI1NiBwdWJsaWMgcmVzZXJ2ZVVubG9ja1RpbWU7CgogICAgYWRkcmVzcyBwdWJsaWMgdGVhbVdhbGxldDsKICAgIGFkZHJlc3MgcHVibGljIHJlc2VydmVXYWxsZXQ7CiAgICBhZGRyZXNzIHB1YmxpYyBhZHZpc29yc1dhbGxldDsKCiAgICAvKioKICAgICAqIFN0YXRlIHZhcmlhYmxlcwogICAgICovCgogICAgdWludDI1NiB0ZWFtTG9ja2VkOwogICAgdWludDI1NiByZXNlcnZlTG9ja2VkOwogICAgdWludDI1NiBhZHZpc29yc0xvY2tlZDsKCiAgICAvLyBBcmUgdGhlIHRva2VucyBub24tdHJhbnNmZXJyYWJsZT8KICAgIGJvb2wgcHVibGljIGxvY2tlZCA9IHRydWU7CgogICAgLy8gV2hlbiB0b2tlbnMgY2FuIGJlIHVuZnJlZXplZC4KICAgIHVpbnQyNTYgcHVibGljIHVuZnJlZXplVGltZSA9IDA7CgogICAgYm9vbCBwdWJsaWMgdW5sb2NrZWRSZXNlcnZlQW5kVGVhbUZ1bmRzID0gZmFsc2U7CgogICAgTW9udGhseVRva2VuVmVzdGluZyBwdWJsaWMgYWR2aXNvcnNWZXN0aW5nID0gTW9udGhseVRva2VuVmVzdGluZyhhZGRyZXNzKDApKTsKCiAgICAvKioKICAgICAqIEV2ZW50cwogICAgICovCgogICAgZXZlbnQgTWludExvY2tlZChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKCiAgICBldmVudCBVbmxvY2tlZChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKCiAgICAvKioKICAgICAqIE1vZGlmaWVycwogICAgICovCgogICAgLy8gVG9rZW5zIG11c3Qgbm90IGJlIGxvY2tlZC4KICAgIG1vZGlmaWVyIHdoZW5MaXF1aWQgewogICAgICAgIHJlcXVpcmUoIWxvY2tlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBhZnRlclJlc2VydmVVbmxvY2tUaW1lIHsKICAgICAgICByZXF1aXJlKG5vdyA+PSByZXNlcnZlVW5sb2NrVGltZSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciB1bmxvY2tSZXNlcnZlQW5kVGVhbU9uY2UgewogICAgICAgIHJlcXVpcmUoIXVubG9ja2VkUmVzZXJ2ZUFuZFRlYW1GdW5kcyk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9yCiAgICAgKi8KICAgIGZ1bmN0aW9uIENSRURUb2tlbigKICAgICAgICB1aW50MjU2IF9jYXAsCiAgICAgICAgdWludDI1NiBfeWVhckxvY2tFbmRUaW1lLAogICAgICAgIGFkZHJlc3MgX3RlYW1XYWxsZXQsCiAgICAgICAgYWRkcmVzcyBfcmVzZXJ2ZVdhbGxldCwKICAgICAgICBhZGRyZXNzIF9hZHZpc29yc1dhbGxldAogICAgKQogICAgQ2FwcGVkVG9rZW4oX2NhcCkKICAgIHB1YmxpYwogICAgewogICAgICAgIHJlcXVpcmUoX3llYXJMb2NrRW5kVGltZSAhPSAwKTsKICAgICAgICByZXF1aXJlKF90ZWFtV2FsbGV0ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3Jlc2VydmVXYWxsZXQgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfYWR2aXNvcnNXYWxsZXQgIT0gYWRkcmVzcygwKSk7CgogICAgICAgIHJlc2VydmVVbmxvY2tUaW1lID0gX3llYXJMb2NrRW5kVGltZTsKICAgICAgICB0ZWFtV2FsbGV0ID0gX3RlYW1XYWxsZXQ7CiAgICAgICAgcmVzZXJ2ZVdhbGxldCA9IF9yZXNlcnZlV2FsbGV0OwogICAgICAgIGFkdmlzb3JzV2FsbGV0ID0gX2Fkdmlzb3JzV2FsbGV0OwogICAgfQoKICAgIC8vIE1pbnQgYSBjZXJ0YWluIG51bWJlciBvZiB0b2tlbnMgdGhhdCBhcmUgbG9ja2VkIHVwLgogICAgLy8gX3ZhbHVlIGhhcyB0byBiZSBib3VuZGVkIG5vdCB0byBvdmVyZmxvdy4KICAgIGZ1bmN0aW9uIG1pbnRBZHZpc29yc1Rva2Vucyh1aW50MjU2IF92YWx1ZSkgcHVibGljIG9ubHlPd25lciBjYW5NaW50IHsKICAgICAgICByZXF1aXJlKGFkdmlzb3JzTG9ja2VkID09IDApOwogICAgICAgIHJlcXVpcmUoX3ZhbHVlLmFkZCh0b3RhbFN1cHBseSkgPD0gY2FwKTsKICAgICAgICBhZHZpc29yc0xvY2tlZCA9IF92YWx1ZTsKICAgICAgICBNaW50TG9ja2VkKGFkdmlzb3JzV2FsbGV0LCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIG1pbnRUZWFtVG9rZW5zKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgb25seU93bmVyIGNhbk1pbnQgewogICAgICAgIHJlcXVpcmUodGVhbUxvY2tlZCA9PSAwKTsKICAgICAgICByZXF1aXJlKF92YWx1ZS5hZGQodG90YWxTdXBwbHkpIDw9IGNhcCk7CiAgICAgICAgdGVhbUxvY2tlZCA9IF92YWx1ZTsKICAgICAgICBNaW50TG9ja2VkKHRlYW1XYWxsZXQsIF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gbWludFJlc2VydmVUb2tlbnModWludDI1NiBfdmFsdWUpIHB1YmxpYyBvbmx5T3duZXIgY2FuTWludCB7CiAgICAgICAgcmVxdWlyZShyZXNlcnZlTG9ja2VkID09IDApOwogICAgICAgIHJlcXVpcmUoX3ZhbHVlLmFkZCh0b3RhbFN1cHBseSkgPD0gY2FwKTsKICAgICAgICByZXNlcnZlTG9ja2VkID0gX3ZhbHVlOwogICAgICAgIE1pbnRMb2NrZWQocmVzZXJ2ZVdhbGxldCwgX3ZhbHVlKTsKICAgIH0KCgogICAgLy8vIEZpbmFsaXNlIGFueSBtaW50aW5nIG9wZXJhdGlvbnMuIFJlc2V0cyB0aGUgb3duZXIgYW5kIGNhdXNlcyBub3JtYWwgdG9rZW5zCiAgICAvLy8gdG8gYmUgZnJvemVuLiBBbHNvIGJlZ2lucyB0aGUgY291bnRkb3duIGZvciBsb2NrZWQtdXAgdG9rZW5zLgogICAgZnVuY3Rpb24gZmluYWxpc2UoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKHJlc2VydmVMb2NrZWQgPiAwKTsKICAgICAgICByZXF1aXJlKHRlYW1Mb2NrZWQgPiAwKTsKICAgICAgICByZXF1aXJlKGFkdmlzb3JzTG9ja2VkID4gMCk7CgogICAgICAgIGFkdmlzb3JzVmVzdGluZyA9IG5ldyBNb250aGx5VG9rZW5WZXN0aW5nKGFkdmlzb3JzV2FsbGV0LCBub3csIDkyIGRheXMsIDIgeWVhcnMsIGZhbHNlKTsKICAgICAgICBtaW50KGFkdmlzb3JzVmVzdGluZywgYWR2aXNvcnNMb2NrZWQpOwogICAgICAgIGZpbmlzaE1pbnRpbmcoKTsKCiAgICAgICAgb3duZXIgPSAwOwogICAgICAgIHVuZnJlZXplVGltZSA9IG5vdyArIDEgd2Vla3M7CiAgICB9CgoKICAgIC8vIENhdXNlcyB0b2tlbnMgdG8gYmUgbGlxdWlkIDEgd2VlayBhZnRlciB0aGUgdG9rZW5zYWxlIGlzIGNvbXBsZXRlZAogICAgZnVuY3Rpb24gdW5mcmVlemUoKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUodW5mcmVlemVUaW1lID4gMCk7CiAgICAgICAgcmVxdWlyZShub3cgPj0gdW5mcmVlemVUaW1lKTsKICAgICAgICBsb2NrZWQgPSBmYWxzZTsKICAgIH0KCgogICAgLy8vIFVubG9jayBhbnkgbm93IGZyZWVhYmxlIHRva2VucyB0aGF0IGFyZSBsb2NrZWQgdXAgZm9yIHRlYW0gYW5kIHJlc2VydmUgYWNjb3VudHMgLgogICAgZnVuY3Rpb24gdW5sb2NrVGVhbUFuZFJlc2VydmVUb2tlbnMoKSBwdWJsaWMgd2hlbkxpcXVpZCBhZnRlclJlc2VydmVVbmxvY2tUaW1lIHVubG9ja1Jlc2VydmVBbmRUZWFtT25jZSB7CiAgICAgICAgcmVxdWlyZSh0b3RhbFN1cHBseS5hZGQodGVhbUxvY2tlZCkuYWRkKHJlc2VydmVMb2NrZWQpIDw9IGNhcCk7CgogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKHRlYW1Mb2NrZWQpLmFkZChyZXNlcnZlTG9ja2VkKTsKICAgICAgICBiYWxhbmNlc1t0ZWFtV2FsbGV0XSA9IGJhbGFuY2VzW3RlYW1XYWxsZXRdLmFkZCh0ZWFtTG9ja2VkKTsKICAgICAgICBiYWxhbmNlc1tyZXNlcnZlV2FsbGV0XSA9IGJhbGFuY2VzW3Jlc2VydmVXYWxsZXRdLmFkZChyZXNlcnZlTG9ja2VkKTsKICAgICAgICB0ZWFtTG9ja2VkID0gMDsKICAgICAgICByZXNlcnZlTG9ja2VkID0gMDsKICAgICAgICB1bmxvY2tlZFJlc2VydmVBbmRUZWFtRnVuZHMgPSB0cnVlOwoKICAgICAgICBUcmFuc2ZlcihhZGRyZXNzKDApLCB0ZWFtV2FsbGV0LCB0ZWFtTG9ja2VkKTsKICAgICAgICBUcmFuc2ZlcihhZGRyZXNzKDApLCByZXNlcnZlV2FsbGV0LCByZXNlcnZlTG9ja2VkKTsKICAgICAgICBVbmxvY2tlZCh0ZWFtV2FsbGV0LCB0ZWFtTG9ja2VkKTsKICAgICAgICBVbmxvY2tlZChyZXNlcnZlV2FsbGV0LCByZXNlcnZlTG9ja2VkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB1bmxvY2tBZHZpc29yVG9rZW5zKCkgcHVibGljIHdoZW5MaXF1aWQgewogICAgICAgIGFkdmlzb3JzVmVzdGluZy5yZWxlYXNlKHRoaXMpOwogICAgfQoKCiAgICAvKioKICAgICAqIE1ldGhvZHMgb3ZlcnJpZGluZyBzb21lIE9wZW5aZXBwZWxpbiBmdW5jdGlvbnMgdG8gcHJldmVudCBjYWxsaW5nIHRoZW0gd2hlbiB0b2tlbiBpcyBub3QgbGlxdWlkLgogICAgICovCgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgd2hlbkxpcXVpZCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgd2hlbkxpcXVpZCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB3aGVuTGlxdWlkIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIuYXBwcm92ZShfc3BlbmRlciwgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX2FkZGVkVmFsdWUpIHB1YmxpYyB3aGVuTGlxdWlkIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIuaW5jcmVhc2VBcHByb3ZhbChfc3BlbmRlciwgX2FkZGVkVmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgd2hlbkxpcXVpZCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLmRlY3JlYXNlQXBwcm92YWwoX3NwZW5kZXIsIF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQoKfQ=='.
	

]
