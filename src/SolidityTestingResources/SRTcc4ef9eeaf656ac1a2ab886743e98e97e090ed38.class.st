Class {
	#name : #SRTcc4ef9eeaf656ac1a2ab886743e98e97e090ed38,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTcc4ef9eeaf656ac1a2ab886743e98e97e090ed38 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgoKLyoKICogT3duYWJsZQogKgogKiBCYXNlIGNvbnRyYWN0IHdpdGggYW4gb3duZXIuCiAqIFByb3ZpZGVzIG9ubHlPd25lciBtb2RpZmllciwgd2hpY2ggcHJldmVudHMgZnVuY3Rpb24gZnJvbSBydW5uaW5nIGlmIGl0IGlzIGNhbGxlZCBieSBhbnlvbmUgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAqLwpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIGlmIChtc2cuc2VuZGVyICE9IG93bmVyKSB7CiAgICAgIHRocm93OwogICAgfQogICAgXzsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciB7CiAgICBpZiAobmV3T3duZXIgIT0gYWRkcmVzcygwKSkgewogICAgICBvd25lciA9IG5ld093bmVyOwogICAgfQogIH0KCn0KCi8qIHRha2luZyBpZGVhcyBmcm9tIEZpcnN0Qmxvb2QgdG9rZW4gKi8KY29udHJhY3QgU2FmZU1hdGggewoKICAgIC8qIGZ1bmN0aW9uIGFzc2VydChib29sIGFzc2VydGlvbikgaW50ZXJuYWwgeyAqLwogICAgLyogICBpZiAoIWFzc2VydGlvbikgeyAqLwogICAgLyogICAgIHRocm93OyAqLwogICAgLyogICB9ICovCiAgICAvKiB9ICAgICAgLy8gYXNzZXJ0IG5vIGxvbmdlciBuZWVkZWQgb25jZSBzb2xpZGl0eSBpcyBvbiAwLjQuMTAgKi8KCiAgICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQyNTYgeCwgdWludDI1NiB5KSBpbnRlcm5hbCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgdWludDI1NiB6ID0geCArIHk7CiAgICAgIGFzc2VydCgoeiA+PSB4KSAmJiAoeiA+PSB5KSk7CiAgICAgIHJldHVybiB6OwogICAgfQoKICAgIGZ1bmN0aW9uIHNhZmVTdWJ0cmFjdCh1aW50MjU2IHgsIHVpbnQyNTYgeSkgaW50ZXJuYWwgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgIGFzc2VydCh4ID49IHkpOwogICAgICB1aW50MjU2IHogPSB4IC0geTsKICAgICAgcmV0dXJuIHo7CiAgICB9CgogICAgZnVuY3Rpb24gc2FmZU11bHQodWludDI1NiB4LCB1aW50MjU2IHkpIGludGVybmFsIHJldHVybnModWludDI1NikgewogICAgICB1aW50MjU2IHogPSB4ICogeTsKICAgICAgYXNzZXJ0KCh4ID09IDApfHwoei94ID09IHkpKTsKICAgICAgcmV0dXJuIHo7CiAgICB9Cgp9Cgpjb250cmFjdCBUb2tlbiB7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZyk7CiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpOwp9CgoKLyogIEVSQyAyMCB0b2tlbiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIFRva2VuIHsKCiAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgc2l6ZSkgewogICAgIGlmKG1zZy5kYXRhLmxlbmd0aCA8IHNpemUgKyA0KSB7CiAgICAgICB0aHJvdzsKICAgICB9CiAgICAgXzsKICB9CgoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDIgKiAzMikgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgewogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdIC09IF92YWx1ZTsKICAgICAgICBiYWxhbmNlc1tfdG9dICs9IF92YWx1ZTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDMgKiAzMikgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgIGlmIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7CiAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7CiAgICAgICAgYmFsYW5jZXNbX2Zyb21dIC09IF92YWx1ZTsKICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogICAgfQoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgICB9CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKfQoKY29udHJhY3Qgc3BsaXR0ZXJDb250cmFjdCBpcyBPd25hYmxlewoKICAgIGV2ZW50IGV2KHN0cmluZyBtc2csIGFkZHJlc3Mgd2hvbSwgdWludDI1NiB2YWwpOwoKICAgIHN0cnVjdCB4UmVjIHsKICAgICAgICBib29sIGluTGlzdDsKICAgICAgICBhZGRyZXNzIG5leHQ7CiAgICAgICAgYWRkcmVzcyBwcmV2OwogICAgICAgIHVpbnQyNTYgdmFsOwogICAgfQoKICAgIHN0cnVjdCBsOHIgewogICAgICAgIGFkZHJlc3Mgd2hvbTsKICAgICAgICB1aW50MjU2IHZhbDsKICAgIH0KICAgIGFkZHJlc3MgcHVibGljIG15QWRkcmVzcyA9IHRoaXM7CiAgICBhZGRyZXNzIHB1YmxpYyBmaXJzdDsKICAgIGFkZHJlc3MgcHVibGljIGxhc3Q7CiAgICBhZGRyZXNzIHB1YmxpYyBkZGY7CiAgICBib29sICAgIHB1YmxpYyB0aGlua01vZGU7CiAgICB1aW50MjU2IHB1YmxpYyBwb3M7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB4UmVjKSBwdWJsaWMgdGhlTGlzdDsKCiAgICBsOHJbXSAgYWZ0ZXJQYXJ0eTsKCiAgICBtb2RpZmllciBvbmx5TWVPckRERigpIHsKICAgICAgICBpZiAobXNnLnNlbmRlciA9PSBkZGYgfHwgbXNnLnNlbmRlciA9PSBteUFkZHJlc3MgfHwgbXNnLnNlbmRlciA9PSBvd25lcikgewogICAgICAgICAgICBfOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHNldERERihhZGRyZXNzIGRkZl8pIG9ubHlPd25lciB7CiAgICAgICAgZGRmID0gZGRmXzsKICAgIH0KCiAgICBmdW5jdGlvbiBzcGxpdHRlckNvbnRyYWN0KGFkZHJlc3Mgc2VlZCwgdWludDI1NiBzZWVkVmFsKSB7CiAgICAgICAgZmlyc3QgPSBzZWVkOwogICAgICAgIGxhc3QgPSBzZWVkOwogICAgICAgIHRoZUxpc3Rbc2VlZF0gPSB4UmVjKHRydWUsMHgwLDB4MCxzZWVkVmFsKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzdGFydFRoaW5raW5nKCkgb25seU93bmVyIHsKICAgICAgICB0aGlua01vZGUgPSB0cnVlOwogICAgICAgIHBvcyA9IDA7CiAgICB9CgogICAgZnVuY3Rpb24gc3RvcFRoaW5raW5nKHVpbnQyNTYgbnVtKSBvbmx5T3duZXIgewogICAgICAgIHRoaW5rTW9kZSA9IGZhbHNlOwogICAgICAgIGZvciAodWludDI1NiBpID0gMDsgaSA8IG51bTsgaSsrKSB7CiAgICAgICAgICAgIGlmIChwb3MgPj0gYWZ0ZXJQYXJ0eS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIGRlbGV0ZSBhZnRlclBhcnR5OwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHVwZGF0ZShhZnRlclBhcnR5W3Bvc10ud2hvbSxhZnRlclBhcnR5W3Bvc10udmFsKTsKICAgICAgICAgICAgcG9zKys7CiAgICAgICAgfQogICAgICAgIHRoaW5rTW9kZSA9IHRydWU7CiAgICB9IAoKICAgIGZ1bmN0aW9uIHRoaW5rTGVuZ3RoKCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBhZnRlclBhcnR5Lmxlbmd0aDsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRSZWM0TDhSKGFkZHJlc3Mgd2hvbSwgdWludDI1NiB2YWwpIGludGVybmFsIHsKICAgICAgICBhZnRlclBhcnR5LnB1c2gobDhyKHdob20sdmFsKSk7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkKGFkZHJlc3Mgd2hvbSwgdWludDI1NiB2YWx1ZSkgaW50ZXJuYWwgewogICAgICAgIHRoZUxpc3Rbd2hvbV0gPSB4UmVjKHRydWUsMHgwLGxhc3QsdmFsdWUpOwogICAgICAgIHRoZUxpc3RbbGFzdF0ubmV4dCA9IHdob207CiAgICAgICAgbGFzdCA9IHdob207CiAgICAgICAgZXYoImFkZCIsd2hvbSx2YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gcmVtb3ZlKGFkZHJlc3Mgd2hvbSkgaW50ZXJuYWwgewogICAgICAgIGlmIChmaXJzdCA9PSB3aG9tKSB7CiAgICAgICAgICAgIGZpcnN0ID0gdGhlTGlzdFt3aG9tXS5uZXh0OwogICAgICAgICAgICB0aGVMaXN0W3dob21dID0geFJlYyhmYWxzZSwweDAsMHgwLDApOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGFkZHJlc3MgbmV4dCA9IHRoZUxpc3Rbd2hvbV0ubmV4dDsKICAgICAgICBhZGRyZXNzIHByZXYgPSB0aGVMaXN0W3dob21dLnByZXY7CiAgICAgICAgaWYgKHByZXYgIT0gMHgwKSB7CiAgICAgICAgICAgIHRoZUxpc3RbcHJldl0ubmV4dCA9IG5leHQ7CiAgICAgICAgfQogICAgICAgIGlmIChuZXh0ICE9IDB4MCkgewogICAgICAgICAgICB0aGVMaXN0W25leHRdLnByZXYgPSBwcmV2OwogICAgICAgIH0KICAgICAgICB0aGVMaXN0W3dob21dID0geFJlYyhmYWxzZSwweDAsMHgwLDApOwogICAgICAgIGV2KCJyZW1vdmUiLHdob20sMCk7CiAgICB9CgogICAgZnVuY3Rpb24gdXBkYXRlKGFkZHJlc3Mgd2hvbSwgdWludDI1NiB2YWx1ZSkgb25seU1lT3JEREYgewogICAgICAgIGlmICh0aGlua01vZGUpIHsKICAgICAgICAgICAgYWRkUmVjNEw4Uih3aG9tLHZhbHVlKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAodmFsdWUgIT0gMCkgewogICAgICAgICAgICBpZiAoIXRoZUxpc3Rbd2hvbV0uaW5MaXN0KSB7CiAgICAgICAgICAgICAgICBhZGQod2hvbSx2YWx1ZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGVMaXN0W3dob21dLnZhbCA9IHZhbHVlOwogICAgICAgICAgICAgICAgZXYoInVwZGF0ZSIsd2hvbSx2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAodGhlTGlzdFt3aG9tXS5pbkxpc3QpIHsKICAgICAgICAgICAgICAgIHJlbW92ZSh3aG9tKTsKICAgICAgICB9CiAgICB9Cgp9CgoKCmNvbnRyYWN0IERERlRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIFNhZmVNYXRoIHsKCiAgICAvLyBtZXRhZGF0YQogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIkRpZ2l0YWwgRGV2ZWxvcGVycyBGdW5kIFRva2VuIjsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIkRERiI7CiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwogICAgc3RyaW5nIHB1YmxpYyB2ZXJzaW9uID0gIjEuMCI7CgogICAgLy8gY29udHJhY3RzCiAgICBhZGRyZXNzIHB1YmxpYyBldGhGdW5kRGVwb3NpdDsgICAgICAvLyBkZXBvc2l0IGFkZHJlc3MgZm9yIEVUSCBmb3IgRG9tYWluIERldmVsb3BtZW50IEZ1bmQKICAgIGFkZHJlc3MgcHVibGljIGRkZnRGdW5kRGVwb3NpdDsgICAgIC8vIGRlcG9zaXQgYWRkcmVzcyBmb3IgRG9tYWluIERldmVsb3BtZW50IEZ1bmQgcmVzZXJ2ZQogICAgYWRkcmVzcyBwdWJsaWMgc3BsaXR0ZXI7ICAgICAgICAgIC8vIERBIDgvNi8yMDE3IC0gc3BsaXR0ZXIgY29udHJhY3QKCiAgICAvLyBjcm93ZHNhbGUgcGFyYW1ldGVycwogICAgYm9vbCBwdWJsaWMgaXNGaW5hbGl6ZWQ7ICAgICAgICAgICAgICAvLyBzd2l0Y2hlZCB0byB0cnVlIGluIG9wZXJhdGlvbmFsIHN0YXRlCiAgICB1aW50MjU2IHB1YmxpYyBmdW5kaW5nU3RhcnRUaW1lOwogICAgdWludDI1NiBwdWJsaWMgZnVuZGluZ0VuZFRpbWU7CiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBkZGZ0RnVuZCA9IDI1ICogKDEwKio1KSAqIDEwKipkZWNpbWFsczsgICAvLyAxbSBEREZUIHJlc2VydmVkIGZvciBEREYgdXNlCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCB0b2tlbkV4Y2hhbmdlUmF0ZSA9IDEwMDA7ICAgICAgICAgICAgICAgLy8gMTAwMCBEREZUIHRva2VucyBwZXIgMSBFVEgKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IHRva2VuQ3JlYXRpb25DYXAgPSAgMjUwICogKDEwKio2KSAqIDEwKipkZWNpbWFsczsKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IHRva2VuQ3JlYXRpb25NaW4gPSAgMSAqICgxMCoqNikgKiAxMCoqZGVjaW1hbHM7CgoKICAgIC8vIGV2ZW50cwogICAgZXZlbnQgTG9nUmVmdW5kKGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsKICAgIGV2ZW50IENyZWF0ZURERlQoYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwoKICAgIC8vIGNvbnN0cnVjdG9yCiAgICBmdW5jdGlvbiBEREZUb2tlbigKICAgICAgICBhZGRyZXNzIF9ldGhGdW5kRGVwb3NpdCwKICAgICAgICBhZGRyZXNzIF9kZGZ0RnVuZERlcG9zaXQsCiAgICAgICAgYWRkcmVzcyBfc3BsaXR0ZXIsIC8vIERBIDgvNi8yMDE3CiAgICAgICAgdWludDI1NiBfZnVuZGluZ1N0YXJ0VGltZSwKICAgICAgICB1aW50MjU2IGR1cmF0aW9uKQogICAgewogICAgICBpc0ZpbmFsaXplZCA9IGZhbHNlOyAgICAgICAgICAgICAgICAgICAvL2NvbnRyb2xzIHByZSB0aHJvdWdoIGNyb3dkc2FsZSBzdGF0ZQogICAgICBldGhGdW5kRGVwb3NpdCA9IF9ldGhGdW5kRGVwb3NpdDsKICAgICAgZGRmdEZ1bmREZXBvc2l0ID0gX2RkZnRGdW5kRGVwb3NpdDsKICAgICAgc3BsaXR0ZXIgPSAgX3NwbGl0dGVyIDsgICAgICAgICAgICAgICAgICAvLyBEQSA4LzYvMjAxNwogICAgICBmdW5kaW5nU3RhcnRUaW1lID0gX2Z1bmRpbmdTdGFydFRpbWU7CiAgICAgIGZ1bmRpbmdFbmRUaW1lID0gZnVuZGluZ1N0YXJ0VGltZSArIGR1cmF0aW9uICogMSBkYXlzOwogICAgICB0b3RhbFN1cHBseSA9IGRkZnRGdW5kOwogICAgICBiYWxhbmNlc1tkZGZ0RnVuZERlcG9zaXRdID0gZGRmdEZ1bmQ7ICAgIC8vIERlcG9zaXQgRERGIHNoYXJlCiAgICAgIENyZWF0ZURERlQoZGRmdEZ1bmREZXBvc2l0LCBkZGZ0RnVuZCk7ICAvLyBsb2dzIERERiBmdW5kCiAgICB9CgogICAgZnVuY3Rpb24gKCkgcGF5YWJsZSB7ICAgICAgICAgICAvLyBEQSA4LzYvMjAxNyBwcmVmZXIgdG8gdXNlIGZhbGxiYWNrIGZ1bmN0aW9uCiAgICAgIGNyZWF0ZVRva2Vucyhtc2cudmFsdWUpOwogICAgfQoKICAgIC8vLyBAZGV2IEFjY2VwdHMgZXRoZXIgYW5kIGNyZWF0ZXMgbmV3IERERlQgdG9rZW5zLgogICAgZnVuY3Rpb24gY3JlYXRlVG9rZW5zKHVpbnQyNTYgX3ZhbHVlKSAgaW50ZXJuYWwgewogICAgICBpZiAoaXNGaW5hbGl6ZWQpIHRocm93OwogICAgICBpZiAobm93IDwgZnVuZGluZ1N0YXJ0VGltZSkgdGhyb3c7CiAgICAgIGlmIChub3cgPiBmdW5kaW5nRW5kVGltZSkgdGhyb3c7CiAgICAgIGlmIChtc2cudmFsdWUgPT0gMCkgdGhyb3c7CgogICAgICB1aW50MjU2IHRva2VucyA9IHNhZmVNdWx0KF92YWx1ZSwgdG9rZW5FeGNoYW5nZVJhdGUpOyAvLyBjaGVjayB0aGF0IHdlJ3JlIG5vdCBvdmVyIHRvdGFscwogICAgICB1aW50MjU2IGNoZWNrZWRTdXBwbHkgPSBzYWZlQWRkKHRvdGFsU3VwcGx5LCB0b2tlbnMpOwoKICAgICAgLy8gREEgOC82LzIwMTcgdG8gZmFpcmx5IGFsbG9jYXRlIHRoZSBsYXN0IGZldyB0b2tlbnMKICAgICAgaWYgKHRva2VuQ3JlYXRpb25DYXAgPCBjaGVja2VkU3VwcGx5KSB7CiAgICAgICAgaWYgKHRva2VuQ3JlYXRpb25DYXAgPD0gdG90YWxTdXBwbHkpIHRocm93OyAgLy8gQ0FQIHJlYWNoZWQgbm8gbW9yZSBwbGVhc2UKICAgICAgICB1aW50MjU2IHRva2Vuc1RvQWxsb2NhdGUgPSBzYWZlU3VidHJhY3QodG9rZW5DcmVhdGlvbkNhcCx0b3RhbFN1cHBseSk7CiAgICAgICAgdWludDI1NiB0b2tlbnNUb1JlZnVuZCAgID0gc2FmZVN1YnRyYWN0KHRva2Vucyx0b2tlbnNUb0FsbG9jYXRlKTsKICAgICAgICB0b3RhbFN1cHBseSA9IHRva2VuQ3JlYXRpb25DYXA7CiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gKz0gdG9rZW5zVG9BbGxvY2F0ZTsgIC8vIHNhZmVBZGQgbm90IG5lZWRlZDsgYmFkIHNlbWFudGljcyB0byB1c2UgaGVyZQogICAgICAgIHVpbnQyNTYgZXRoZXJUb1JlZnVuZCA9IHRva2Vuc1RvUmVmdW5kIC8gdG9rZW5FeGNoYW5nZVJhdGU7CiAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihldGhlclRvUmVmdW5kKTsKICAgICAgICBDcmVhdGVEREZUKG1zZy5zZW5kZXIsIHRva2Vuc1RvQWxsb2NhdGUpOyAgLy8gbG9ncyB0b2tlbiBjcmVhdGlvbgogICAgICAgIExvZ1JlZnVuZChtc2cuc2VuZGVyLGV0aGVyVG9SZWZ1bmQpOwogICAgICAgIHNwbGl0dGVyQ29udHJhY3Qoc3BsaXR0ZXIpLnVwZGF0ZShtc2cuc2VuZGVyLGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgLy8gREEgOC82LzIwMTcgZW5kIG9mIGZhaXIgYWxsb2NhdGlvbiBjb2RlCiAgICAgIHRvdGFsU3VwcGx5ID0gY2hlY2tlZFN1cHBseTsKICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gKz0gdG9rZW5zOyAgLy8gc2FmZUFkZCBub3QgbmVlZGVkOyBiYWQgc2VtYW50aWNzIHRvIHVzZSBoZXJlCiAgICAgIENyZWF0ZURERlQobXNnLnNlbmRlciwgdG9rZW5zKTsgIC8vIGxvZ3MgdG9rZW4gY3JlYXRpb24KICAgICAgc3BsaXR0ZXJDb250cmFjdChzcGxpdHRlcikudXBkYXRlKG1zZy5zZW5kZXIsYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwogICAgfQoKICAgIC8vLyBAZGV2IEVuZHMgdGhlIGZ1bmRpbmcgcGVyaW9kIGFuZCBzZW5kcyB0aGUgRVRIIGhvbWUKICAgIGZ1bmN0aW9uIGZpbmFsaXplKCkgZXh0ZXJuYWwgewogICAgICBpZiAoaXNGaW5hbGl6ZWQpIHRocm93OwogICAgICBpZiAobXNnLnNlbmRlciAhPSBldGhGdW5kRGVwb3NpdCkgdGhyb3c7IC8vIGxvY2tzIGZpbmFsaXplIHRvIHRoZSB1bHRpbWF0ZSBFVEggb3duZXIKICAgICAgaWYodG90YWxTdXBwbHkgPCB0b2tlbkNyZWF0aW9uTWluICsgZGRmdEZ1bmQpIHRocm93OyAgICAgIC8vIGhhdmUgdG8gc2VsbCBtaW5pbXVtIHRvIG1vdmUgdG8gb3BlcmF0aW9uYWwKICAgICAgaWYobm93IDw9IGZ1bmRpbmdFbmRUaW1lICYmIHRvdGFsU3VwcGx5ICE9IHRva2VuQ3JlYXRpb25DYXApIHRocm93OwogICAgICAvLyBtb3ZlIHRvIG9wZXJhdGlvbmFsCiAgICAgIGlzRmluYWxpemVkID0gdHJ1ZTsKICAgICAgLy8gREEgOC82LzIwMTcgY2hhbmdlIHNlbmQvdGhyb3cgdG8gdHJhbnNmZXIKICAgICAgZXRoRnVuZERlcG9zaXQudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsgIC8vIHNlbmQgdGhlIGV0aCB0byBEREYKICAgIH0KCiAgICAvLy8gQGRldiBBbGxvd3MgY29udHJpYnV0b3JzIHRvIHJlY292ZXIgdGhlaXIgZXRoZXIgaW4gdGhlIGNhc2Ugb2YgYSBmYWlsZWQgZnVuZGluZyBjYW1wYWlnbi4KICAgIGZ1bmN0aW9uIHJlZnVuZCgpIGV4dGVybmFsIHsKICAgICAgaWYoaXNGaW5hbGl6ZWQpIHRocm93OyAgICAgICAgICAgICAgICAgICAgICAgLy8gcHJldmVudHMgcmVmdW5kIGlmIG9wZXJhdGlvbmFsCiAgICAgIGlmIChub3cgPD0gZnVuZGluZ0VuZFRpbWUpIHRocm93OyAvLyBwcmV2ZW50cyByZWZ1bmQgdW50aWwgc2FsZSBwZXJpb2QgaXMgb3ZlcgogICAgICBpZih0b3RhbFN1cHBseSA+PSB0b2tlbkNyZWF0aW9uTWluICsgZGRmdEZ1bmQpIHRocm93OyAgLy8gbm8gcmVmdW5kcyBpZiB3ZSBzb2xkIGVub3VnaAogICAgICBpZihtc2cuc2VuZGVyID09IGRkZnRGdW5kRGVwb3NpdCkgdGhyb3c7ICAgIC8vIERERiBub3QgZW50aXRsZWQgdG8gYSByZWZ1bmQKICAgICAgdWludDI1NiBkZGZ0VmFsID0gYmFsYW5jZXNbbXNnLnNlbmRlcl07CiAgICAgIGlmIChkZGZ0VmFsID09IDApIHRocm93OwogICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IDA7CiAgICAgIHRvdGFsU3VwcGx5ID0gc2FmZVN1YnRyYWN0KHRvdGFsU3VwcGx5LCBkZGZ0VmFsKTsgLy8gZXh0cmEgc2FmZQogICAgICB1aW50MjU2IGV0aFZhbCA9IGRkZnRWYWwgLyB0b2tlbkV4Y2hhbmdlUmF0ZTsgICAgIC8vIHNob3VsZCBiZSBzYWZlOyBwcmV2aW91cyB0aHJvd3MgY292ZXJzIGVkZ2VzCiAgICAgIExvZ1JlZnVuZChtc2cuc2VuZGVyLCBldGhWYWwpOyAgICAgICAgICAgICAgIC8vIGxvZyBpdCAKICAgICAgLy8gREEgOC82LzIwMTcgY2hhbmdlIHNlbmQvdGhyb3cgdG8gdHJhbnNmZXIKICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihldGhWYWwpOyAgICAgICAgICAgICAgICAgLy8gaWYgeW91J3JlIHVzaW5nIGEgY29udHJhY3Q7IG1ha2Ugc3VyZSBpdCB3b3JrcyB3aXRoIC5zZW5kIGdhcyBsaW1pdHMKICAgIH0KCiAgICAvLyBEQSA4LzYvMjAxNwogICAgLy8vIEBkZXYgVXBkYXRlcyBzcGxpdHRlciBjb250cmFjdCB3aXRoIG93bmVyc2hpcCBjaGFuZ2VzCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgIHsKICAgICAgc3VjY2VzcyA9IHN1cGVyLnRyYW5zZmVyKF90byxfdmFsdWUpOwogICAgICBzcGxpdHRlckNvbnRyYWN0IHNjID0gc3BsaXR0ZXJDb250cmFjdChzcGxpdHRlcik7CiAgICAgIHNjLnVwZGF0ZShtc2cuc2VuZGVyLGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKICAgICAgc2MudXBkYXRlKF90byxiYWxhbmNlc1tfdG9dKTsKICAgICAgcmV0dXJuOwogICAgfQoKfQ=='.
	

]
