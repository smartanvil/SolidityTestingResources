Class {
	#name : #SRTc2dc0c3054dB1740a9153B5D54911dB728672EAa,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTc2dc0c3054dB1740a9153B5D54911dB728672EAa >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IDAuNC4yMTsKCi8qKgogKiBAdGl0bGUgU2FmZU1hdGgKICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCmxpYnJhcnkgU2FmZU1hdGggewogICAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBpZiAoYSA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgICAgICB1aW50MjU2IGMgPSBhICogYjsKICAgICAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgICAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgICAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgYXNzZXJ0KGIgPD0gYSk7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSk7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9Cn0KCi8qKgogKiBAdGl0bGUgT3duYWJsZQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuCiAqLwpjb250cmFjdCBPd25hYmxlIHsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwoKICAgIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKICAgIC8qKgogICAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICAgKiBhY2NvdW50LgogICAgICovCiAgICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB9CiAgICAvKioKICAgICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgICAqLwogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIGVtaXQgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgICAgICBvd25lciA9IG5ld093bmVyOwogICAgfQp9CgovKioKICogQHRpdGxlIEF1dGhvcml6YWJsZQogKiBAZGV2IFRoZSBBdXRob3JpemFibGUgY29udHJhY3QgaGFzIGF1dGhvcml6ZWQgYWRkcmVzc2VzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAibXVsdGlwbGUgdXNlciBwZXJtaXNzaW9ucyIuCiAqLwpjb250cmFjdCBBdXRob3JpemFibGUgaXMgT3duYWJsZSB7CiAgICAKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgYXV0aG9yaXplZDsKICAgIGV2ZW50IEF1dGhvcml6YXRpb25TZXQoYWRkcmVzcyBpbmRleGVkIGFkZHJlc3NBdXRob3JpemVkLCBib29sIGluZGV4ZWQgYXV0aG9yaXphdGlvbik7CgogICAgLyoqCiAgICAgKiBAZGV2IFRoZSBBdXRob3JpemFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgZmlyc3QgYGF1dGhvcml6ZWRgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICAgKiBhY2NvdW50LgogICAgICovCiAgICBmdW5jdGlvbiBBdXRob3JpemFibGUoKSBwdWJsaWMgewogICAgICAgIGF1dGhvcml6ZShtc2cuc2VuZGVyKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBhdXRob3JpemVkLgogICAgICovCiAgICBtb2RpZmllciBvbmx5QXV0aG9yaXplZCgpIHsKICAgICAgICByZXF1aXJlKGF1dGhvcml6ZWRbbXNnLnNlbmRlcl0pOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFsbG93cyAKICAgICAqIEBwYXJhbSBfYWRkcmVzcyBUaGUgYWRkcmVzcyB0byBjaGFuZ2UgYXV0aG9yaXphdGlvbi4KICAgICAqLwogICAgZnVuY3Rpb24gYXV0aG9yaXplKGFkZHJlc3MgX2FkZHJlc3MpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoIWF1dGhvcml6ZWRbX2FkZHJlc3NdKTsKICAgICAgICBlbWl0IEF1dGhvcml6YXRpb25TZXQoX2FkZHJlc3MsIHRydWUpOwogICAgICAgIGF1dGhvcml6ZWRbX2FkZHJlc3NdID0gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogQGRldiBEaXNhbGxvd3MKICAgICAqIEBwYXJhbSBfYWRkcmVzcyBUaGUgYWRkcmVzcyB0byBjaGFuZ2UgYXV0aG9yaXphdGlvbi4KICAgICAqLwogICAgZnVuY3Rpb24gZGVhdXRob3JpemUoYWRkcmVzcyBfYWRkcmVzcykgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShhdXRob3JpemVkW19hZGRyZXNzXSk7CiAgICAgICAgZW1pdCBBdXRob3JpemF0aW9uU2V0KF9hZGRyZXNzLCBmYWxzZSk7CiAgICAgICAgYXV0aG9yaXplZFtfYWRkcmVzc10gPSBmYWxzZTsKICAgIH0KfQoKLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5CiAqLwpjb250cmFjdCBFUkMyMEJhc2ljIHsKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCi8qKgogKiBAdGl0bGUgUHJpdmF0ZVNhbGVFeGNoYW5nZVJhdGUgaW50ZXJmYWNlCiAqLwpjb250cmFjdCBQcml2YXRlU2FsZUV4Y2hhbmdlUmF0ZSB7CiAgICB1aW50MjU2IHB1YmxpYyByYXRlOwogICAgdWludDI1NiBwdWJsaWMgdGltZXN0YW1wOwogICAgZXZlbnQgVXBkYXRlVXNkRXRoUmF0ZSh1aW50IF9yYXRlKTsKICAgIGZ1bmN0aW9uIHVwZGF0ZVVzZEV0aFJhdGUodWludCBfcmF0ZSkgcHVibGljOwogICAgZnVuY3Rpb24gZ2V0VG9rZW5BbW91bnQodWludDI1NiBfd2VpQW1vdW50KSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKfQoKLyoqCiAqIEB0aXRsZSBXaGl0ZWxpc3QgaW50ZXJmYWNlCiAqLwpjb250cmFjdCBXaGl0ZWxpc3QgewogICAgbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIHdoaXRlbGlzdGVkOwogICAgZXZlbnQgQWRkVG9XaGl0ZWxpc3QoYWRkcmVzcyBfYmVuZWZpY2lhcnkpOwogICAgZXZlbnQgUmVtb3ZlRnJvbVdoaXRlbGlzdChhZGRyZXNzIF9iZW5lZmljaWFyeSk7CiAgICBmdW5jdGlvbiBpc1doaXRlbGlzdGVkKGFkZHJlc3MgX2FkZHJlc3MpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gYWRkVG9XaGl0ZWxpc3QoYWRkcmVzcyBfYmVuZWZpY2lhcnkpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIHJlbW92ZUZyb21XaGl0ZWxpc3QoYWRkcmVzcyBfYmVuZWZpY2lhcnkpIHB1YmxpYzsKfQoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8gQ3Jvd2RzYWxlCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpjb250cmFjdCBDcm93ZHNhbGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgLy8gVGhlIHRva2VuIGJlaW5nIHNvbGQKICAgIEVSQzIwIHB1YmxpYyB0b2tlbjsKCiAgICAvLyBBZGRyZXNzIHdoZXJlIGZ1bmRzIGFyZSBjb2xsZWN0ZWQKICAgIGFkZHJlc3MgcHVibGljIHdhbGxldDsKCiAgICAvLyBIb3cgbWFueSB0b2tlbiB1bml0cyBhIGJ1eWVyIGdldHMgcGVyIHdlaQogICAgUHJpdmF0ZVNhbGVFeGNoYW5nZVJhdGUgcHVibGljIHJhdGU7CgogICAgLy8gQW1vdW50IG9mIHdlaSByYWlzZWQKICAgIHVpbnQyNTYgcHVibGljIHdlaVJhaXNlZDsKICAgIAogICAgLy8gQW1vdW50IG9mIHdlaSByYWlzZWQgKHRva2VuKQogICAgdWludDI1NiBwdWJsaWMgdG9rZW5SYWlzZWQ7CgogICAgLyoqCiAgICAqIEV2ZW50IGZvciB0b2tlbiBwdXJjaGFzZSBsb2dnaW5nCiAgICAqIEBwYXJhbSBwdXJjaGFzZXIgd2hvIHBhaWQgZm9yIHRoZSB0b2tlbnMKICAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IHdobyBnb3QgdGhlIHRva2VucwogICAgKiBAcGFyYW0gdmFsdWUgd2VpcyBwYWlkIGZvciBwdXJjaGFzZQogICAgKiBAcGFyYW0gYW1vdW50IGFtb3VudCBvZiB0b2tlbnMgcHVyY2hhc2VkCiAgICAqLwogICAgZXZlbnQgVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgdmFsdWUsIHVpbnQyNTYgYW1vdW50KTsKCiAgICAvKioKICAgICogQHBhcmFtIF9yYXRlIE51bWJlciBvZiB0b2tlbiB1bml0cyBhIGJ1eWVyIGdldHMgcGVyIHdlaQogICAgKiBAcGFyYW0gX3dhbGxldCBBZGRyZXNzIHdoZXJlIGNvbGxlY3RlZCBmdW5kcyB3aWxsIGJlIGZvcndhcmRlZCB0bwogICAgKiBAcGFyYW0gX3Rva2VuIEFkZHJlc3Mgb2YgdGhlIHRva2VuIGJlaW5nIHNvbGQKICAgICovCiAgICBmdW5jdGlvbiBDcm93ZHNhbGUoUHJpdmF0ZVNhbGVFeGNoYW5nZVJhdGUgX3JhdGUsIGFkZHJlc3MgX3dhbGxldCwgRVJDMjAgX3Rva2VuKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX3JhdGUucmF0ZSgpID4gMCk7CiAgICAgICAgcmVxdWlyZShfdG9rZW4gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfd2FsbGV0ICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICByYXRlID0gX3JhdGU7CiAgICAgICAgdG9rZW4gPSBfdG9rZW47CiAgICAgICAgd2FsbGV0ID0gX3dhbGxldDsKICAgIH0KCiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gQ3Jvd2RzYWxlIGV4dGVybmFsIGludGVyZmFjZQogICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICAvKioKICAgICogQGRldiBmYWxsYmFjayBmdW5jdGlvbiAqKipETyBOT1QgT1ZFUlJJREUqKioKICAgICovCiAgICBmdW5jdGlvbiAoKSBleHRlcm5hbCBwYXlhYmxlIHsKICAgICAgICBidXlUb2tlbnMobXNnLnNlbmRlcik7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgbG93IGxldmVsIHRva2VuIHB1cmNoYXNlICoqKkRPIE5PVCBPVkVSUklERSoqKgogICAgKiBAcGFyYW0gX2JlbmVmaWNpYXJ5IEFkZHJlc3MgcGVyZm9ybWluZyB0aGUgdG9rZW4gcHVyY2hhc2UKICAgICovCiAgICBmdW5jdGlvbiBidXlUb2tlbnMoYWRkcmVzcyBfYmVuZWZpY2lhcnkpIHB1YmxpYyBwYXlhYmxlIHsKCiAgICAgICAgdWludDI1NiB3ZWlBbW91bnQgPSBtc2cudmFsdWU7CiAgICAgICAgCiAgICAgICAgIC8vIGNhbGN1bGF0ZSB0b2tlbiBhbW91bnQgdG8gYmUgY3JlYXRlZAogICAgICAgIHVpbnQyNTYgdG9rZW5BbW91bnQgPSBfZ2V0VG9rZW5BbW91bnQod2VpQW1vdW50KTsKICAgICAgICAKICAgICAgICBfcHJlVmFsaWRhdGVQdXJjaGFzZShfYmVuZWZpY2lhcnksIHdlaUFtb3VudCwgdG9rZW5BbW91bnQpOwoKICAgICAgICAvLyB1cGRhdGUgc3RhdGUKICAgICAgICB3ZWlSYWlzZWQgPSB3ZWlSYWlzZWQuYWRkKHdlaUFtb3VudCk7CiAgICAgICAgdG9rZW5SYWlzZWQgPSB0b2tlblJhaXNlZC5hZGQodG9rZW5BbW91bnQpOwoKICAgICAgICBfcHJvY2Vzc1B1cmNoYXNlKF9iZW5lZmljaWFyeSwgdG9rZW5BbW91bnQpOwogICAgICAgIGVtaXQgVG9rZW5QdXJjaGFzZShtc2cuc2VuZGVyLCBfYmVuZWZpY2lhcnksIHdlaUFtb3VudCwgdG9rZW5BbW91bnQpOwoKICAgICAgICBfdXBkYXRlUHVyY2hhc2luZ1N0YXRlKF9iZW5lZmljaWFyeSwgd2VpQW1vdW50KTsKCiAgICAgICAgX2ZvcndhcmRGdW5kcygpOwogICAgICAgIF9wb3N0VmFsaWRhdGVQdXJjaGFzZShfYmVuZWZpY2lhcnksIHdlaUFtb3VudCk7CiAgICB9CgogICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIEludGVybmFsIGludGVyZmFjZSAoZXh0ZW5zaWJsZSkKICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgLyoqCiAgICAqIEBkZXYgVmFsaWRhdGlvbiBvZiBhbiBpbmNvbWluZyBwdXJjaGFzZS4gVXNlIHJlcXVpcmUgc3RhdGVtZW50cyB0byByZXZlcnQgc3RhdGUgd2hlbiBjb25kaXRpb25zIGFyZSBub3QgbWV0LiBVc2Ugc3VwZXIgdG8gY29uY2F0ZW5hdGUgdmFsaWRhdGlvbnMuCiAgICAqIEBwYXJhbSBfYmVuZWZpY2lhcnkgQWRkcmVzcyBwZXJmb3JtaW5nIHRoZSB0b2tlbiBwdXJjaGFzZQogICAgKiBAcGFyYW0gX3dlaUFtb3VudCBWYWx1ZSBpbiB3ZWkgaW52b2x2ZWQgaW4gdGhlIHB1cmNoYXNlCiAgICAqLwogICAgZnVuY3Rpb24gX3ByZVZhbGlkYXRlUHVyY2hhc2UoYWRkcmVzcyBfYmVuZWZpY2lhcnksIHVpbnQyNTYgX3dlaUFtb3VudCwgdWludDI1NiBfdG9rZW5BbW91bnQpIGludGVybmFsIHsKICAgICAgICByZXF1aXJlKF9iZW5lZmljaWFyeSAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF93ZWlBbW91bnQgPiAwKTsKICAgICAgICByZXF1aXJlKF90b2tlbkFtb3VudCA+IDApOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IFZhbGlkYXRpb24gb2YgYW4gZXhlY3V0ZWQgcHVyY2hhc2UuIE9ic2VydmUgc3RhdGUgYW5kIHVzZSByZXZlcnQgc3RhdGVtZW50cyB0byB1bmRvIHJvbGxiYWNrIHdoZW4gdmFsaWQgY29uZGl0aW9ucyBhcmUgbm90IG1ldC4KICAgICogQHBhcmFtIF9iZW5lZmljaWFyeSBBZGRyZXNzIHBlcmZvcm1pbmcgdGhlIHRva2VuIHB1cmNoYXNlCiAgICAqIEBwYXJhbSBfd2VpQW1vdW50IFZhbHVlIGluIHdlaSBpbnZvbHZlZCBpbiB0aGUgcHVyY2hhc2UKICAgICovCiAgICBmdW5jdGlvbiBfcG9zdFZhbGlkYXRlUHVyY2hhc2UoYWRkcmVzcyBfYmVuZWZpY2lhcnksIHVpbnQyNTYgX3dlaUFtb3VudCkgaW50ZXJuYWwgewogICAgICAgIC8vIG9wdGlvbmFsIG92ZXJyaWRlCiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgU291cmNlIG9mIHRva2Vucy4gT3ZlcnJpZGUgdGhpcyBtZXRob2QgdG8gbW9kaWZ5IHRoZSB3YXkgaW4gd2hpY2ggdGhlIGNyb3dkc2FsZSB1bHRpbWF0ZWx5IGdldHMgYW5kIHNlbmRzIGl0cyB0b2tlbnMuCiAgICAqIEBwYXJhbSBfYmVuZWZpY2lhcnkgQWRkcmVzcyBwZXJmb3JtaW5nIHRoZSB0b2tlbiBwdXJjaGFzZQogICAgKiBAcGFyYW0gX3Rva2VuQW1vdW50IE51bWJlciBvZiB0b2tlbnMgdG8gYmUgZW1pdHRlZAogICAgKi8KICAgIGZ1bmN0aW9uIF9kZWxpdmVyVG9rZW5zKGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCB1aW50MjU2IF90b2tlbkFtb3VudCkgaW50ZXJuYWwgewogICAgICAgIHRva2VuLnRyYW5zZmVyKF9iZW5lZmljaWFyeSwgX3Rva2VuQW1vdW50KTsKICAgIH0KICAgIAogICAgLyoqCiAgICAqIEBkZXYgRXhlY3V0ZWQgd2hlbiBhIHB1cmNoYXNlIGhhcyBiZWVuIHZhbGlkYXRlZCBhbmQgaXMgcmVhZHkgdG8gYmUgZXhlY3V0ZWQuIE5vdCBuZWNlc3NhcmlseSBlbWl0cy9zZW5kcyB0b2tlbnMuCiAgICAqIEBwYXJhbSBfYmVuZWZpY2lhcnkgQWRkcmVzcyByZWNlaXZpbmcgdGhlIHRva2VucwogICAgKiBAcGFyYW0gX3Rva2VuQW1vdW50IE51bWJlciBvZiB0b2tlbnMgdG8gYmUgcHVyY2hhc2VkCiAgICAqLwogICAgZnVuY3Rpb24gX3Byb2Nlc3NQdXJjaGFzZShhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludDI1NiBfdG9rZW5BbW91bnQpIGludGVybmFsIHsKICAgICAgICBfZGVsaXZlclRva2VucyhfYmVuZWZpY2lhcnksIF90b2tlbkFtb3VudCk7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgT3ZlcnJpZGUgZm9yIGV4dGVuc2lvbnMgdGhhdCByZXF1aXJlIGFuIGludGVybmFsIHN0YXRlIHRvIGNoZWNrIGZvciB2YWxpZGl0eSAoY3VycmVudCB1c2VyIGNvbnRyaWJ1dGlvbnMsIGV0Yy4pCiAgICAqIEBwYXJhbSBfYmVuZWZpY2lhcnkgQWRkcmVzcyByZWNlaXZpbmcgdGhlIHRva2VucwogICAgKiBAcGFyYW0gX3dlaUFtb3VudCBWYWx1ZSBpbiB3ZWkgaW52b2x2ZWQgaW4gdGhlIHB1cmNoYXNlCiAgICAqLwogICAgZnVuY3Rpb24gX3VwZGF0ZVB1cmNoYXNpbmdTdGF0ZShhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludDI1NiBfd2VpQW1vdW50KSBpbnRlcm5hbCB7CiAgICAgICAgLy8gb3B0aW9uYWwgb3ZlcnJpZGUKICAgIH0KCiAgICAvKioKICAgICogQGRldiBPdmVycmlkZSB0byBleHRlbmQgdGhlIHdheSBpbiB3aGljaCBldGhlciBpcyBjb252ZXJ0ZWQgdG8gdG9rZW5zLgogICAgKiBAcGFyYW0gX3dlaUFtb3VudCBWYWx1ZSBpbiB3ZWkgdG8gYmUgY29udmVydGVkIGludG8gdG9rZW5zCiAgICAqIEByZXR1cm4gTnVtYmVyIG9mIHRva2VucyB0aGF0IGNhbiBiZSBwdXJjaGFzZWQgd2l0aCB0aGUgc3BlY2lmaWVkIF93ZWlBbW91bnQKICAgICovCiAgICBmdW5jdGlvbiBfZ2V0VG9rZW5BbW91bnQodWludDI1NiBfd2VpQW1vdW50KSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gcmF0ZS5nZXRUb2tlbkFtb3VudChfd2VpQW1vdW50KTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBEZXRlcm1pbmVzIGhvdyBFVEggaXMgc3RvcmVkL2ZvcndhcmRlZCBvbiBwdXJjaGFzZXMuCiAgICAqLwogICAgZnVuY3Rpb24gX2ZvcndhcmRGdW5kcygpIGludGVybmFsIHsKICAgICAgICB3YWxsZXQudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgIH0KfQoKLyoqCiAqIEB0aXRsZSBUaW1lZENyb3dkc2FsZQogKiBAZGV2IENyb3dkc2FsZSBhY2NlcHRpbmcgY29udHJpYnV0aW9ucyBvbmx5IHdpdGhpbiBhIHRpbWUgZnJhbWUuCiAqLwpjb250cmFjdCBUaW1lZENyb3dkc2FsZSBpcyBDcm93ZHNhbGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgdWludDI1NiBwdWJsaWMgb3BlbmluZ1RpbWU7CiAgICB1aW50MjU2IHB1YmxpYyBjbG9zaW5nVGltZTsKCiAgICAvKioKICAgICAqIEBkZXYgUmV2ZXJ0cyBpZiBub3QgaW4gY3Jvd2RzYWxlIHRpbWUgcmFuZ2UuIAogICAgKi8KICAgIG1vZGlmaWVyIG9ubHlXaGlsZU9wZW4gewogICAgICAgIHJlcXVpcmUobm93ID49IG9wZW5pbmdUaW1lICYmIG5vdyA8PSBjbG9zaW5nVGltZSk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQ29uc3RydWN0b3IsIHRha2VzIGNyb3dkc2FsZSBvcGVuaW5nIGFuZCBjbG9zaW5nIHRpbWVzLgogICAgICogQHBhcmFtIF9vcGVuaW5nVGltZSBDcm93ZHNhbGUgb3BlbmluZyB0aW1lCiAgICAgKiBAcGFyYW0gX2Nsb3NpbmdUaW1lIENyb3dkc2FsZSBjbG9zaW5nIHRpbWUKICAgICAqLwogICAgZnVuY3Rpb24gVGltZWRDcm93ZHNhbGUodWludDI1NiBfb3BlbmluZ1RpbWUsIHVpbnQyNTYgX2Nsb3NpbmdUaW1lKSBwdWJsaWMgewogICAgICAgIAogICAgICAgIHJlcXVpcmUoX2Nsb3NpbmdUaW1lID49IG5vdyk7CiAgICAgICAgIAogICAgICAgIHJlcXVpcmUoX2Nsb3NpbmdUaW1lID49IF9vcGVuaW5nVGltZSk7CiAgICAgICAgb3BlbmluZ1RpbWUgPSBfb3BlbmluZ1RpbWU7CiAgICAgICAgY2xvc2luZ1RpbWUgPSBfY2xvc2luZ1RpbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IENoZWNrcyB3aGV0aGVyIHRoZSBwZXJpb2QgaW4gd2hpY2ggdGhlIGNyb3dkc2FsZSBpcyBvcGVuIGhhcyBhbHJlYWR5IGVsYXBzZWQuCiAgICAgKiBAcmV0dXJuIFdoZXRoZXIgY3Jvd2RzYWxlIHBlcmlvZCBoYXMgZWxhcHNlZAogICAgICovCiAgICBmdW5jdGlvbiBoYXNDbG9zZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIG5vdyA+IGNsb3NpbmdUaW1lOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBDaGVja3Mgd2hldGhlciB0aGUgcGVyaW9kIGluIHdoaWNoIHRoZSBjcm93ZHNhbGUgaXMgb3BlbmVkLgogICAgICogQHJldHVybiBXaGV0aGVyIGNyb3dkc2FsZSBwZXJpb2QgaGFzIGVsYXBzZWQKICAgICAqLwogICAgZnVuY3Rpb24gaGFzT3BlbmluZygpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gKG5vdyA+PSBvcGVuaW5nVGltZSAmJiBub3cgPD0gY2xvc2luZ1RpbWUpOwogICAgfQogIAogICAgLyoqCiAgICAgKiBAZGV2IEV4dGVuZCBwYXJlbnQgYmVoYXZpb3IgcmVxdWlyaW5nIHRvIGJlIHdpdGhpbiBjb250cmlidXRpbmcgcGVyaW9kCiAgICAgKiBAcGFyYW0gX2JlbmVmaWNpYXJ5IFRva2VuIHB1cmNoYXNlcgogICAgICogQHBhcmFtIF93ZWlBbW91bnQgQW1vdW50IG9mIHdlaSBjb250cmlidXRlZAogICAgICovCiAgICBmdW5jdGlvbiBfcHJlVmFsaWRhdGVQdXJjaGFzZShhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludDI1NiBfd2VpQW1vdW50LCB1aW50MjU2IF90b2tlbkFtb3VudCkgaW50ZXJuYWwgb25seVdoaWxlT3BlbiB7CiAgICAgICAgc3VwZXIuX3ByZVZhbGlkYXRlUHVyY2hhc2UoX2JlbmVmaWNpYXJ5LCBfd2VpQW1vdW50LCBfdG9rZW5BbW91bnQpOwogICAgfQoKfQoKLyoqCiAqIEB0aXRsZSBBbGxvd2FuY2VDcm93ZHNhbGUKICogQGRldiBFeHRlbnNpb24gb2YgQ3Jvd2RzYWxlIHdoZXJlIHRva2VucyBhcmUgaGVsZCBieSBhIHdhbGxldCwgd2hpY2ggYXBwcm92ZXMgYW4gYWxsb3dhbmNlIHRvIHRoZSBjcm93ZHNhbGUuCiAqLwpjb250cmFjdCBBbGxvd2FuY2VDcm93ZHNhbGUgaXMgQ3Jvd2RzYWxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogICAgYWRkcmVzcyBwdWJsaWMgdG9rZW5XYWxsZXQ7CgogICAgLyoqCiAgICAqIEBkZXYgQ29uc3RydWN0b3IsIHRha2VzIHRva2VuIHdhbGxldCBhZGRyZXNzLiAKICAgICogQHBhcmFtIF90b2tlbldhbGxldCBBZGRyZXNzIGhvbGRpbmcgdGhlIHRva2Vucywgd2hpY2ggaGFzIGFwcHJvdmVkIGFsbG93YW5jZSB0byB0aGUgY3Jvd2RzYWxlCiAgICAqLwogICAgZnVuY3Rpb24gQWxsb3dhbmNlQ3Jvd2RzYWxlKGFkZHJlc3MgX3Rva2VuV2FsbGV0KSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX3Rva2VuV2FsbGV0ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHRva2VuV2FsbGV0ID0gX3Rva2VuV2FsbGV0OwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IE92ZXJyaWRlcyBwYXJlbnQgYmVoYXZpb3IgYnkgdHJhbnNmZXJyaW5nIHRva2VucyBmcm9tIHdhbGxldC4KICAgICogQHBhcmFtIF9iZW5lZmljaWFyeSBUb2tlbiBwdXJjaGFzZXIKICAgICogQHBhcmFtIF90b2tlbkFtb3VudCBBbW91bnQgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAgKi8KICAgIGZ1bmN0aW9uIF9kZWxpdmVyVG9rZW5zKGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCB1aW50MjU2IF90b2tlbkFtb3VudCkgaW50ZXJuYWwgewogICAgICAgIHRva2VuLnRyYW5zZmVyRnJvbSh0b2tlbldhbGxldCwgX2JlbmVmaWNpYXJ5LCBfdG9rZW5BbW91bnQpOwogICAgfQp9CgovKioKICogQHRpdGxlIENhcHBlZENyb3dkc2FsZQogKiBAZGV2IENyb3dkc2FsZSB3aXRoIGEgbGltaXQgZm9yIHRvdGFsIGNvbnRyaWJ1dGlvbnMuCiAqLwpjb250cmFjdCBDYXBwZWRDcm93ZHNhbGUgaXMgQ3Jvd2RzYWxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIHVpbnQyNTYgcHVibGljIG1pbldlaTsKICAgIHVpbnQyNTYgcHVibGljIGNhcFRva2VuOwoKICAgIC8qKgogICAgKiBAZGV2IENvbnN0cnVjdG9yLCB0YWtlcyBtYXhpbXVtIGFtb3VudCBvZiB3ZWkgYWNjZXB0ZWQgaW4gdGhlIGNyb3dkc2FsZS4KICAgICogQHBhcmFtIF9jYXBUb2tlbiBNYXggYW1vdW50IG9mIHRva2VuIHRvIGJlIGNvbnRyaWJ1dGVkCiAgICAqLwogICAgZnVuY3Rpb24gQ2FwcGVkQ3Jvd2RzYWxlKHVpbnQyNTYgX2NhcFRva2VuLCB1aW50MjU2IF9taW5XZWkpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfbWluV2VpID4gMCk7CiAgICAgICAgcmVxdWlyZShfY2FwVG9rZW4gPiAwKTsKICAgICAgICBtaW5XZWkgPSBfbWluV2VpOwogICAgICAgIGNhcFRva2VuID0gX2NhcFRva2VuOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IENoZWNrcyB3aGV0aGVyIHRoZSBjYXAgaGFzIGJlZW4gcmVhY2hlZC4gCiAgICAqIEByZXR1cm4gV2hldGhlciB0aGUgY2FwIHdhcyByZWFjaGVkCiAgICAqLwogICAgZnVuY3Rpb24gY2FwUmVhY2hlZCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZih0b2tlblJhaXNlZCA+PSBjYXBUb2tlbikgcmV0dXJuIHRydWU7CiAgICAgICAgdWludDI1NiBtaW5Ub2tlbnMgPSByYXRlLmdldFRva2VuQW1vdW50KG1pbldlaSk7CiAgICAgICAgaWYoY2FwVG9rZW4gLSB0b2tlblJhaXNlZCA8PSBtaW5Ub2tlbnMpIHJldHVybiB0cnVlOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBFeHRlbmQgcGFyZW50IGJlaGF2aW9yIHJlcXVpcmluZyBwdXJjaGFzZSB0byByZXNwZWN0IHRoZSBmdW5kaW5nIGNhcC4KICAgICogQHBhcmFtIF9iZW5lZmljaWFyeSBUb2tlbiBwdXJjaGFzZXIKICAgICogQHBhcmFtIF93ZWlBbW91bnQgQW1vdW50IG9mIHdlaSBjb250cmlidXRlZAogICAgKi8KICAgIGZ1bmN0aW9uIF9wcmVWYWxpZGF0ZVB1cmNoYXNlKGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCB1aW50MjU2IF93ZWlBbW91bnQsIHVpbnQyNTYgX3Rva2VuQW1vdW50KSBpbnRlcm5hbCB7CiAgICAgICAgc3VwZXIuX3ByZVZhbGlkYXRlUHVyY2hhc2UoX2JlbmVmaWNpYXJ5LCBfd2VpQW1vdW50LCBfdG9rZW5BbW91bnQpOwogICAgICAgIHJlcXVpcmUoX3dlaUFtb3VudCA+PSBtaW5XZWkpOwogICAgICAgIHJlcXVpcmUodG9rZW5SYWlzZWQuYWRkKF90b2tlbkFtb3VudCkgPD0gY2FwVG9rZW4pOwogICAgfQp9CgovKioKICogQHRpdGxlIFdoaXRlbGlzdGVkQ3Jvd2RzYWxlCiAqIEBkZXYgQ3Jvd2RzYWxlIHdpdGggYSBsaW1pdCBmb3IgdG90YWwgY29udHJpYnV0aW9ucy4KICovCmNvbnRyYWN0IFdoaXRlbGlzdGVkQ3Jvd2RzYWxlIGlzIENyb3dkc2FsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICAvLyBPbmx5IEtZQyBpbnZlc3RvciBhbGxvd2VkIHRvIGJ1eSB0aGUgdG9rZW4KICAgIFdoaXRlbGlzdCBwdWJsaWMgd2hpdGVsaXN0OwoKICAgIC8qKgogICAgKiBAZGV2IENvbnN0cnVjdG9yLCB0YWtlcyBtYXhpbXVtIGFtb3VudCBvZiB3ZWkgYWNjZXB0ZWQgaW4gdGhlIGNyb3dkc2FsZS4KICAgICogQHBhcmFtIF93aGl0ZWxpc3Qgd2hpdGVsaXN0IGNvbnRyYWN0CiAgICAqLwogICAgZnVuY3Rpb24gV2hpdGVsaXN0ZWRDcm93ZHNhbGUoV2hpdGVsaXN0IF93aGl0ZWxpc3QpIHB1YmxpYyB7CiAgICAgICAgd2hpdGVsaXN0ID0gX3doaXRlbGlzdDsKICAgIH0KCiAgICBmdW5jdGlvbiBpc1doaXRlbGlzdGVkKGFkZHJlc3MgX2FkZHJlc3MpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gd2hpdGVsaXN0LmlzV2hpdGVsaXN0ZWQoX2FkZHJlc3MpOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEV4dGVuZCBwYXJlbnQgYmVoYXZpb3IgcmVxdWlyaW5nIHB1cmNoYXNlIHRvIHJlc3BlY3QgdGhlIGZ1bmRpbmcgY2FwLgogICAgKiBAcGFyYW0gX2JlbmVmaWNpYXJ5IFRva2VuIHB1cmNoYXNlcgogICAgKiBAcGFyYW0gX3dlaUFtb3VudCBBbW91bnQgb2Ygd2VpIGNvbnRyaWJ1dGVkCiAgICAqLwogICAgZnVuY3Rpb24gX3ByZVZhbGlkYXRlUHVyY2hhc2UoYWRkcmVzcyBfYmVuZWZpY2lhcnksIHVpbnQyNTYgX3dlaUFtb3VudCwgdWludDI1NiBfdG9rZW5BbW91bnQpIGludGVybmFsIHsKICAgICAgICBzdXBlci5fcHJlVmFsaWRhdGVQdXJjaGFzZShfYmVuZWZpY2lhcnksIF93ZWlBbW91bnQsIF90b2tlbkFtb3VudCk7CiAgICAgICAgcmVxdWlyZSh3aGl0ZWxpc3QuaXNXaGl0ZWxpc3RlZChfYmVuZWZpY2lhcnkpKTsKICAgIH0KfQoKLyoqCiAqIEB0aXRsZSBDbGFpbWVkQ3Jvd2RzYWxlCiAqIEBkZXYgRXh0ZW5zaW9uIG9mIENyb3dkc2FsZSB3aGVyZSB0b2tlbnMgYXJlIGhlbGQgYnkgYSB3YWxsZXQsIHdoaWNoIGFwcHJvdmVzIGFuIGFsbG93YW5jZSB0byB0aGUgY3Jvd2RzYWxlLgogKi8KY29udHJhY3QgQ2xhaW1Dcm93ZHNhbGUgaXMgQ3Jvd2RzYWxlLCBBdXRob3JpemFibGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CiAgICAKICAgIHVpbnQyNTYgZGl2aWRlcjsKICAgIGV2ZW50IENsYWltVG9rZW4oYWRkcmVzcyBpbmRleGVkIGNsYWltYW50LCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgY2xhaW1BbW91bnQpOwogICAgIAogICAgLy8gQ2xhaW0gcmVtYWluIGFtb3VudCBvZiB0b2tlbgogICAgLy9hZGRyZXNzSW5kaWNlcyBub3QgdXNlIGluZGV4IDAgCiAgICBhZGRyZXNzW10gcHVibGljIGFkZHJlc3NJbmRpY2VzOwoKICAgIC8vIGdldCBhbW91bnQgb2YgY2xhaW0gdG9rZW4KICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBtYXBBZGRyZXNzVG9Ub2tlbjsKICAgIAogICAgLy9nZXQgaW5kZXggb2YgYWRkcmVzc0luZGljZXMgaWYgPSAwID4+IG5vdCBmb3VuZAogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIG1hcEFkZHJlc3NUb0luZGV4OwogICAgCiAgICAgLy8gQW1vdW50IG9mIHdlaSB3YWl0aW5nIGZvciBjbGFpbSAodG9rZW4pCiAgICB1aW50MjU2IHB1YmxpYyB3YWl0aW5nRm9yQ2xhaW1Ub2tlbnM7CgogICAgLyoqCiAgICAqIEBkZXYgQ29uc3RydWN0b3IsIHRha2VzIHRva2VuIHdhbGxldCBhZGRyZXNzLiAKICAgICovCiAgICBmdW5jdGlvbiBDbGFpbUNyb3dkc2FsZSh1aW50MjU2IF9kaXZpZGVyKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX2RpdmlkZXIgPiAwKTsKICAgICAgICBkaXZpZGVyID0gX2RpdmlkZXI7CiAgICAgICAgYWRkcmVzc0luZGljZXMucHVzaChhZGRyZXNzKDApKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAqIEBkZXYgQ2xhaW0gcmVtYWluZWQgdG9rZW4gYWZ0ZXIgY2xvc2VkIHRpbWUKICAgICovCiAgICBmdW5jdGlvbiBjbGFpbShhZGRyZXNzIF9iZW5lZmljaWFyeSkgcHVibGljIG9ubHlBdXRob3JpemVkIHsKICAgICAgIAogICAgICAgIHJlcXVpcmUoX2JlbmVmaWNpYXJ5ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUobWFwQWRkcmVzc1RvVG9rZW5bX2JlbmVmaWNpYXJ5XSA+IDApOwogICAgICAgIAogICAgICAgIC8vIHJlbW92ZSBmcm9tIGxpc3QKICAgICAgICB1aW50IGluZGV4VG9CZURlbGV0ZWQgPSBtYXBBZGRyZXNzVG9JbmRleFtfYmVuZWZpY2lhcnldOwogICAgICAgIHJlcXVpcmUoaW5kZXhUb0JlRGVsZXRlZCAhPSAwKTsKICAgICAgICAKICAgICAgICB1aW50IGFycmF5TGVuZ3RoID0gYWRkcmVzc0luZGljZXMubGVuZ3RoOwogICAgICAgIC8vIGlmIGluZGV4IHRvIGJlIGRlbGV0ZWQgaXMgbm90IHRoZSBsYXN0IGluZGV4LCBzd2FwIHBvc2l0aW9uLgogICAgICAgIGlmIChpbmRleFRvQmVEZWxldGVkIDwgYXJyYXlMZW5ndGgtMSkgewogICAgICAgICAgICAvLyBzd2FwIAogICAgICAgICAgICBhZGRyZXNzSW5kaWNlc1tpbmRleFRvQmVEZWxldGVkXSA9IGFkZHJlc3NJbmRpY2VzW2FycmF5TGVuZ3RoLTFdOwogICAgICAgICAgICBtYXBBZGRyZXNzVG9JbmRleFthZGRyZXNzSW5kaWNlc1tpbmRleFRvQmVEZWxldGVkXV0gPSBpbmRleFRvQmVEZWxldGVkOwogICAgICAgIH0KICAgICAgICAgLy8gd2UgY2FuIG5vdyByZWR1Y2UgdGhlIGFycmF5IGxlbmd0aCBieSAxCiAgICAgICAgYWRkcmVzc0luZGljZXMubGVuZ3RoLS07CiAgICAgICAgbWFwQWRkcmVzc1RvSW5kZXhbX2JlbmVmaWNpYXJ5XSA9IDA7CiAgICAgICAgCiAgICAgICAgLy8gZGVsaXZlciB0b2tlbgogICAgICAgIHVpbnQyNTYgX2NsYWltQW1vdW50ID0gbWFwQWRkcmVzc1RvVG9rZW5bX2JlbmVmaWNpYXJ5XTsKICAgICAgICBtYXBBZGRyZXNzVG9Ub2tlbltfYmVuZWZpY2lhcnldID0gMDsKICAgICAgICB3YWl0aW5nRm9yQ2xhaW1Ub2tlbnMgPSB3YWl0aW5nRm9yQ2xhaW1Ub2tlbnMuc3ViKF9jbGFpbUFtb3VudCk7CiAgICAgICAgZW1pdCBDbGFpbVRva2VuKG1zZy5zZW5kZXIsIF9iZW5lZmljaWFyeSwgX2NsYWltQW1vdW50KTsKICAgICAgICAKICAgICAgICBfZGVsaXZlclRva2VucyhfYmVuZWZpY2lhcnksIF9jbGFpbUFtb3VudCk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNoZWNrQ2xhaW1Ub2tlbkJ5SW5kZXgodWludCBpbmRleCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nil7CiAgICAgICAgcmVxdWlyZShpbmRleCA+PSAwKTsKICAgICAgICByZXF1aXJlKGluZGV4IDwgYWRkcmVzc0luZGljZXMubGVuZ3RoKTsKICAgICAgICByZXR1cm4gY2hlY2tDbGFpbVRva2VuQnlBZGRyZXNzKGFkZHJlc3NJbmRpY2VzW2luZGV4XSk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNoZWNrQ2xhaW1Ub2tlbkJ5QWRkcmVzcyhhZGRyZXNzIF9iZW5lZmljaWFyeSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nil7CiAgICAgICAgcmVxdWlyZShfYmVuZWZpY2lhcnkgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmV0dXJuIG1hcEFkZHJlc3NUb1Rva2VuW19iZW5lZmljaWFyeV07CiAgICB9CiAgICBmdW5jdGlvbiBjb3VudENsYWltQmFja2VycygpICBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGFkZHJlc3NJbmRpY2VzLmxlbmd0aC0xOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBfYWRkVG9DbGFpbUxpc3QoYWRkcmVzcyBfYmVuZWZpY2lhcnksIHVpbnQyNTYgX2NsYWltQW1vdW50KSBpbnRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShfYmVuZWZpY2lhcnkgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfY2xhaW1BbW91bnQgPiAwKTsKICAgICAgICAKICAgICAgICBpZihtYXBBZGRyZXNzVG9Ub2tlbltfYmVuZWZpY2lhcnldID09IDApewogICAgICAgICAgICBhZGRyZXNzSW5kaWNlcy5wdXNoKF9iZW5lZmljaWFyeSk7CiAgICAgICAgICAgIG1hcEFkZHJlc3NUb0luZGV4W19iZW5lZmljaWFyeV0gPSBhZGRyZXNzSW5kaWNlcy5sZW5ndGgtMTsKICAgICAgICB9CiAgICAgICAgd2FpdGluZ0ZvckNsYWltVG9rZW5zID0gd2FpdGluZ0ZvckNsYWltVG9rZW5zLmFkZChfY2xhaW1BbW91bnQpOwogICAgICAgIG1hcEFkZHJlc3NUb1Rva2VuW19iZW5lZmljaWFyeV0gPSBtYXBBZGRyZXNzVG9Ub2tlbltfYmVuZWZpY2lhcnldLmFkZChfY2xhaW1BbW91bnQpOwogICAgfQoKICAgCiAgICAvKioKICAgICAqIEBkZXYgRXhlY3V0ZWQgd2hlbiBhIHB1cmNoYXNlIGhhcyBiZWVuIHZhbGlkYXRlZCBhbmQgaXMgcmVhZHkgdG8gYmUgZXhlY3V0ZWQuIE5vdCBuZWNlc3NhcmlseSBlbWl0cy9zZW5kcyB0b2tlbnMuCiAgICAgKiBAcGFyYW0gX2JlbmVmaWNpYXJ5IEFkZHJlc3MgcmVjZWl2aW5nIHRoZSB0b2tlbnMKICAgICAqIEBwYXJhbSBfdG9rZW5BbW91bnQgTnVtYmVyIG9mIHRva2VucyB0byBiZSBwdXJjaGFzZWQKICAgICAqLwogICAgZnVuY3Rpb24gX3Byb2Nlc3NQdXJjaGFzZShhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludDI1NiBfdG9rZW5BbW91bnQpIGludGVybmFsIHsKICAgICAgICAKICAgICAgICAvLyBUbyBwcm90ZWN0IG91ciBwcml2YXRlLXNhbGUgaW52ZXN0b3JzIHdobyB0cmFuc2ZlcmVkIGV0aCB2aWEgd2FsbGV0IGZyb20gZXhjaGFuZ2UuCiAgICAgICAgLy8gSW5zdGVhZCBvZiBzZW5kIGFsbCB0b2tlbnMgYW1vdW50IGJhY2ssIHRoZSBwcml2YXRlLXNhbGUgY29udHJhY3Qgd2lsbCBzZW5kIGJhY2sgaW4gc21hbGwgcG9ydGlvbiBvZiB0b2tlbnMgKHBwbSkuIAogICAgICAgIC8vIFRoZSBmdWxsIGFtb3VudCBvZiB0b2tlbnMgd2lsbCBiZSBzZW5kIGxhdGVyIGFmdGVyIHRoZSBpbnZlc3RvciBoYXMgY29uZmlybWVkIHJlY2VpdmVkIGFtb3VudCB0byB1cy4KICAgICAgICB1aW50MjU2IHRva2VuU2FtcGxlQW1vdW50ID0gX3Rva2VuQW1vdW50LmRpdihkaXZpZGVyKTsKCiAgICAgICAgX2FkZFRvQ2xhaW1MaXN0KF9iZW5lZmljaWFyeSwgX3Rva2VuQW1vdW50LnN1Yih0b2tlblNhbXBsZUFtb3VudCkpOwogICAgICAgIF9kZWxpdmVyVG9rZW5zKF9iZW5lZmljaWFyeSwgdG9rZW5TYW1wbGVBbW91bnQpOwogICAgfQp9CgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyBaTUlORQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKLyoqCiAqIEB0aXRsZSBabWluZVByaXZhdGVTYWxlCiAqLwpjb250cmFjdCBabWluZVByaXZhdGVTYWxlIGlzIENsYWltQ3Jvd2RzYWxlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBBbGxvd2FuY2VDcm93ZHNhbGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIENhcHBlZENyb3dkc2FsZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgVGltZWRDcm93ZHNhbGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIFdoaXRlbGlzdGVkQ3Jvd2RzYWxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogICAgCiAgICAvKioKICAgICAqIEBwYXJhbSBfcmF0ZSBOdW1iZXIgb2YgdG9rZW4gdW5pdHMgYSBidXllciBnZXRzIHBlciB3ZWkKICAgICAqIEBwYXJhbSBfd2hpdGVsaXN0IEFsbG93ZCBhZGRyZXNzIG9mIGJ1eWVyCiAgICAgKiBAcGFyYW0gX3dhbGxldCBBZGRyZXNzIHdoZXJlIGNvbGxlY3RlZCBmdW5kcyB3aWxsIGJlIGZvcndhcmRlZCB0bwogICAgICogQHBhcmFtIF90b2tlbiBBZGRyZXNzIG9mIHRoZSB0b2tlbiBiZWluZyBzb2xkCiAgICAgKi8KICAgIGZ1bmN0aW9uIFptaW5lUHJpdmF0ZVNhbGUoUHJpdmF0ZVNhbGVFeGNoYW5nZVJhdGUgX3JhdGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIFdoaXRlbGlzdCBfd2hpdGVsaXN0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCB1aW50MjU2IF9jYXBUb2tlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgdWludDI1NiBfbWluV2VpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCB1aW50MjU2IF9vcGVuaW5nVGltZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgdWludDI1NiBfY2xvc2luZ1RpbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGFkZHJlc3MgX3dhbGxldAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgYWRkcmVzcyBfdG9rZW5XYWxsZXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIEVSQzIwIF90b2tlbgogICAgKSBwdWJsaWMgCiAgICAgICAgQ3Jvd2RzYWxlKF9yYXRlLCBfd2FsbGV0LCBfdG9rZW4pIAogICAgICAgIENsYWltQ3Jvd2RzYWxlKDEwMDAwMDApCiAgICAgICAgQWxsb3dhbmNlQ3Jvd2RzYWxlKF90b2tlbldhbGxldCkgCiAgICAgICAgQ2FwcGVkQ3Jvd2RzYWxlKF9jYXBUb2tlbiwgX21pbldlaSkKICAgICAgICBUaW1lZENyb3dkc2FsZShfb3BlbmluZ1RpbWUsIF9jbG9zaW5nVGltZSkgCiAgICAgICAgV2hpdGVsaXN0ZWRDcm93ZHNhbGUoX3doaXRlbGlzdCkKICAgIHsKICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgIH0KCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVUb2tlbkFtb3VudCh1aW50MjU2IF93ZWlBbW91bnQpICBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHJhdGUuZ2V0VG9rZW5BbW91bnQoX3dlaUFtb3VudCk7CiAgICB9CiAgICAKICAgICAvKioKICAgICAgKiBAZGV2IENoZWNrcyB0aGUgYW1vdW50IG9mIHRva2VucyBsZWZ0IGluIHRoZSBhbGxvd2FuY2UuCiAgICAgICogQHJldHVybiBBbW91bnQgb2YgdG9rZW5zIGxlZnQgaW4gdGhlIGFsbG93YW5jZQogICAgICAqLwogICAgZnVuY3Rpb24gcmVtYWluaW5nVG9rZW5Gb3JTYWxlKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYWxsb3dhbmNlVG9rZW5MZWZ0ID0gKHRva2VuLmFsbG93YW5jZSh0b2tlbldhbGxldCwgdGhpcykpLnN1Yih3YWl0aW5nRm9yQ2xhaW1Ub2tlbnMpOwogICAgICAgIHVpbnQyNTYgYmFsYW5jZVRva2VuTGVmdCA9ICh0b2tlbi5iYWxhbmNlT2YodG9rZW5XYWxsZXQpKS5zdWIod2FpdGluZ0ZvckNsYWltVG9rZW5zKTsKICAgICAgICBpZihhbGxvd2FuY2VUb2tlbkxlZnQgPCBiYWxhbmNlVG9rZW5MZWZ0KSByZXR1cm4gYWxsb3dhbmNlVG9rZW5MZWZ0OwogICAgICAgIHJldHVybiBiYWxhbmNlVG9rZW5MZWZ0OwogICAgfQogICAgCiAgICAgLyoqCiAgICAgKiBAZGV2IEV4dGVuZCBwYXJlbnQgYmVoYXZpb3IgcmVxdWlyaW5nIHRvIGJlIHdpdGhpbiBjb250cmlidXRpbmcgcGVyaW9kCiAgICAgKiBAcGFyYW0gX2JlbmVmaWNpYXJ5IFRva2VuIHB1cmNoYXNlcgogICAgICogQHBhcmFtIF93ZWlBbW91bnQgQW1vdW50IG9mIHdlaSBjb250cmlidXRlZAogICAgICovCiAgICBmdW5jdGlvbiBfcHJlVmFsaWRhdGVQdXJjaGFzZShhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludDI1NiBfd2VpQW1vdW50LCB1aW50MjU2IF90b2tlbkFtb3VudCkgaW50ZXJuYWwgewogICAgICAgIHN1cGVyLl9wcmVWYWxpZGF0ZVB1cmNoYXNlKF9iZW5lZmljaWFyeSwgX3dlaUFtb3VudCwgX3Rva2VuQW1vdW50KTsKICAgICAgICByZXF1aXJlKHJlbWFpbmluZ1Rva2VuRm9yU2FsZSgpLnN1YihfdG9rZW5BbW91bnQpID49IDApOwogICAgfQp9CgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ=='.
	

]
