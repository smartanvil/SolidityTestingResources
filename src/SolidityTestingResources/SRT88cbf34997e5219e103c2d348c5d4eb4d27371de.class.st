Class {
	#name : #SRT88cbf34997e5219e103c2d348c5d4eb4d27371de,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT88cbf34997e5219e103c2d348c5d4eb4d27371de >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CmxpYnJhcnkgU2FmZU1hdGggewogIGZ1bmN0aW9uIG11bCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgdWludCBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQogIGZ1bmN0aW9uIGRpdih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgYXNzZXJ0KGIgPiAwKTsKICAgIHVpbnQgYyA9IGEgLyBiOwogICAgYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7CiAgICByZXR1cm4gYzsKICB9CiAgZnVuY3Rpb24gc3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CiAgZnVuY3Rpb24gYWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICB1aW50IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQogIGZ1bmN0aW9uIG1heDY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7CiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7CiAgfQogIGZ1bmN0aW9uIG1pbjY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7CiAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsKICB9CiAgZnVuY3Rpb24gbWF4MjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7CiAgfQogIGZ1bmN0aW9uIG1pbjI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7CiAgfQogIGZ1bmN0aW9uIGFzc2VydChib29sIGFzc2VydGlvbikgaW50ZXJuYWwgewogICAgaWYgKCFhc3NlcnRpb24pIHsKICAgICAgdGhyb3c7CiAgICB9CiAgfQp9CmNvbnRyYWN0IE93bmFibGUgewogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICBmdW5jdGlvbiBPd25hYmxlKCkgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KICAgIG1vZGlmaWVyIG9ubHlPd25lciB7CiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIpIHRocm93OwogICAgICAgIF87CiAgICB9CiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgewogICAgICAgIGlmIChuZXdPd25lciAhPSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICAgICAgfQogICAgfQp9Ci8qCiAqIFBhdXNhYmxlCiAqIEFic3RyYWN0IGNvbnRyYWN0IHRoYXQgYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbgogKiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uCiAqLwpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKICBib29sIHB1YmxpYyBzdG9wcGVkOwogIG1vZGlmaWVyIHN0b3BJbkVtZXJnZW5jeSB7CiAgICBpZiAoc3RvcHBlZCkgewogICAgICB0aHJvdzsKICAgIH0KICAgIF87CiAgfQogIAogIG1vZGlmaWVyIG9ubHlJbkVtZXJnZW5jeSB7CiAgICBpZiAoIXN0b3BwZWQpIHsKICAgICAgdGhyb3c7CiAgICB9CiAgICBfOwogIH0KICAvLyBjYWxsZWQgYnkgdGhlIG93bmVyIG9uIGVtZXJnZW5jeSwgdHJpZ2dlcnMgc3RvcHBlZCBzdGF0ZQogIGZ1bmN0aW9uIGVtZXJnZW5jeVN0b3AoKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgc3RvcHBlZCA9IHRydWU7CiAgfQogIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW5kIG9mIGVtZXJnZW5jeSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICBmdW5jdGlvbiByZWxlYXNlKCkgZXh0ZXJuYWwgb25seU93bmVyIG9ubHlJbkVtZXJnZW5jeSB7CiAgICBzdG9wcGVkID0gZmFsc2U7CiAgfQp9CmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgY29uc3RhbnQgcmV0dXJucyAodWludCk7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludCB2YWx1ZSk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSk7Cn0KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCk7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludCB2YWx1ZSk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQgdmFsdWUpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOwp9Ci8qCiAqIFB1bGxQYXltZW50CiAqIEJhc2UgY29udHJhY3Qgc3VwcG9ydGluZyBhc3luYyBzZW5kIGZvciBwdWxsIHBheW1lbnRzLgogKiBJbmhlcml0IGZyb20gdGhpcyBjb250cmFjdCBhbmQgdXNlIGFzeW5jU2VuZCBpbnN0ZWFkIG9mIHNlbmQuCiAqLwpjb250cmFjdCBQdWxsUGF5bWVudCB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CiAgCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBwYXltZW50czsKICBldmVudCBMb2dSZWZ1bmRFVEgoYWRkcmVzcyB0bywgdWludCB2YWx1ZSk7CiAgLyoqCiAgKiAgU3RvcmUgc2VudCBhbW91bnQgYXMgY3JlZGl0IHRvIGJlIHB1bGxlZCwgY2FsbGVkIGJ5IHBheWVyIAogICoqLwogIGZ1bmN0aW9uIGFzeW5jU2VuZChhZGRyZXNzIGRlc3QsIHVpbnQgYW1vdW50KSBpbnRlcm5hbCB7CiAgICBwYXltZW50c1tkZXN0XSA9IHBheW1lbnRzW2Rlc3RdLmFkZChhbW91bnQpOwogIH0KICAvLyB3aXRoZHJhdyBhY2N1bXVsYXRlZCBiYWxhbmNlLCBjYWxsZWQgYnkgcGF5ZWUKICBmdW5jdGlvbiB3aXRoZHJhd1BheW1lbnRzKCkgewogICAgYWRkcmVzcyBwYXllZSA9IG1zZy5zZW5kZXI7CiAgICB1aW50IHBheW1lbnQgPSBwYXltZW50c1twYXllZV07CiAgICAKICAgIGlmIChwYXltZW50ID09IDApIHsKICAgICAgdGhyb3c7CiAgICB9CiAgICBpZiAodGhpcy5iYWxhbmNlIDwgcGF5bWVudCkgewogICAgICB0aHJvdzsKICAgIH0KICAgIHBheW1lbnRzW3BheWVlXSA9IDA7CiAgICBpZiAoIXBheWVlLnNlbmQocGF5bWVudCkpIHsKICAgICAgdGhyb3c7CiAgICB9CiAgICBMb2dSZWZ1bmRFVEgocGF5ZWUscGF5bWVudCk7CiAgfQp9CmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgCiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CiAgCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIGJhbGFuY2VzOwogIAogIC8qCiAgICogRml4IGZvciB0aGUgRVJDMjAgc2hvcnQgYWRkcmVzcyBhdHRhY2sgIAogICovCiAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgc2l6ZSkgewogICAgIGlmKG1zZy5kYXRhLmxlbmd0aCA8IHNpemUgKyA0KSB7CiAgICAgICB0aHJvdzsKICAgICB9CiAgICAgXzsKICB9CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSB7CiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgfQogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cn0KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBCYXNpY1Rva2VuLCBFUkMyMCB7CiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpKSBhbGxvd2VkOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIG9ubHlQYXlsb2FkU2l6ZSgzICogMzIpIHsKICAgIHZhciBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07CiAgICAvLyBDaGVjayBpcyBub3QgbmVlZGVkIGJlY2F1c2Ugc3ViKF9hbGxvd2FuY2UsIF92YWx1ZSkgd2lsbCBhbHJlYWR5IHRocm93IGlmIHRoaXMgY29uZGl0aW9uIGlzIG5vdCBtZXQKICAgIC8vIGlmIChfdmFsdWUgPiBfYWxsb3dhbmNlKSB0aHJvdzsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBfYWxsb3dhbmNlLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICB9CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkgewogICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2AKICAgIC8vICBhbGxvd2FuY2UgdG8gemVybyBieSBjYWxsaW5nIGBhcHByb3ZlKF9zcGVuZGVyLCAwKWAgaWYgaXQgaXMgbm90CiAgICAvLyAgYWxyZWFkeSAwIHRvIG1pdGlnYXRlIHRoZSByYWNlIGNvbmRpdGlvbiBkZXNjcmliZWQgaGVyZToKICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgaWYgKChfdmFsdWUgIT0gMCkgJiYgKGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdICE9IDApKSB0aHJvdzsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgfQogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCByZW1haW5pbmcpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KfQovKioKICogIE5ld0hvcGUgdG9rZW4gY29udHJhY3QuIEltcGxlbWVudHMKICovCmNvbnRyYWN0IE5ld0hvcGUgaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZSB7CiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIk5ld0hvcGUiOwogIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIk5ld0giOwogIHVpbnQgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gNjsKICAvLyBDb25zdHJ1Y3RvcgogIGZ1bmN0aW9uIE5ld0hvcGUoKSB7CiAgICAgIHRvdGFsU3VwcGx5ID0gMTAwMDAwMDAwMDAwMDsvLzFNCiAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gdG90YWxTdXBwbHk7IC8vIFNlbmQgYWxsIHRva2VucyB0byBvd25lcgogIH0KICAvKioKICAgKiAgQnVybiBhd2F5IHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIE5ld0hvcGUgdG9rZW5zCiAgICovCiAgZnVuY3Rpb24gYnVybih1aW50IF92YWx1ZSkgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgMHgwLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQp9Ci8qCiAgQ3Jvd2RzYWxlIFNtYXJ0IENvbnRyYWN0IGZvciB0aGUgTmV3SG9wZS5vcmcgcHJvamVjdAogIFRoaXMgc21hcnQgY29udHJhY3QgY29sbGVjdHMgRVRILCBhbmQgaW4gcmV0dXJuIGVtaXRzIE5ld0hvcGUgdG9rZW5zIHRvIHRoZSBiYWNrZXJzCiovCmNvbnRyYWN0IENyb3dkc2FsZSBpcyBQYXVzYWJsZSwgUHVsbFBheW1lbnQgewogICAgCiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKICAgIHN0cnVjdCBCYWNrZXIgewogICAgICAgIHVpbnQgd2VpUmVjZWl2ZWQ7IC8vIEFtb3VudCBvZiBFdGhlciBnaXZlbgogICAgICAgIHVpbnQgY29pblNlbnQ7CiAgICB9CiAgICAvKgogICAgKiBDb25zdGFudHMKICAgICovCiAgICAvKiBNaW5pbXVtIG51bWJlciBvZiBOZXdIb3BlIHRvIHNlbGwgKi8KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IE1JTl9DQVAgPSA1MDAwMDAwMDAwMDsgLy8gNTAsMDAwIE5ld0hvcGVzCiAgICAvKiBNYXhpbXVtIG51bWJlciBvZiBOZXdIb3BlIHRvIHNlbGwgKi8KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IE1BWF9DQVAgPSA3MDAwMDAwMDAwMDA7IC8vIDcwMCwwMDAgTmV3SG9wZXMKICAgIC8qIE1pbmltdW0gYW1vdW50IHRvIGludmVzdCAqLwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgTUlOX0lOVkVTVF9FVEhFUiA9IDEwMCBmaW5uZXk7CiAgICAvKiBDcm93ZHNhbGUgcGVyaW9kICovCiAgICB1aW50IHByaXZhdGUgY29uc3RhbnQgQ1JPV0RTQUxFX1BFUklPRCA9IDUgZGF5czsKICAgIC8qIE51bWJlciBvZiBOZXdIb3BlcyBwZXIgRXRoZXIgKi8KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IENPSU5fUEVSX0VUSEVSID0gOTAwMDAwMDAwMDsgLy8gOSwwMDAgTmV3SG9wZXMKICAgIC8qCiAgICAqIFZhcmlhYmxlcwogICAgKi8KICAgIC8qIE5ld0hvcGUgY29udHJhY3QgcmVmZXJlbmNlICovCiAgICBOZXdIb3BlIHB1YmxpYyBjb2luOwogICAgLyogTXVsdGlzaWcgY29udHJhY3QgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIEV0aGVyICovCiAgICBhZGRyZXNzIHB1YmxpYyBtdWx0aXNpZ0V0aGVyOwogICAgLyogTnVtYmVyIG9mIEV0aGVyIHJlY2VpdmVkICovCiAgICB1aW50IHB1YmxpYyBldGhlclJlY2VpdmVkOwogICAgLyogTnVtYmVyIG9mIE5ld0hvcGVzIHNlbnQgdG8gRXRoZXIgY29udHJpYnV0b3JzICovCiAgICB1aW50IHB1YmxpYyBjb2luU2VudFRvRXRoZXI7CiAgICAvKiBDcm93ZHNhbGUgc3RhcnQgdGltZSAqLwogICAgdWludCBwdWJsaWMgc3RhcnRUaW1lOwogICAgLyogQ3Jvd2RzYWxlIGVuZCB0aW1lICovCiAgICB1aW50IHB1YmxpYyBlbmRUaW1lOwogICAgLyogSXMgY3Jvd2RzYWxlIHN0aWxsIG9uIGdvaW5nICovCiAgICBib29sIHB1YmxpYyBjcm93ZHNhbGVDbG9zZWQ7CiAgICAvKiBCYWNrZXJzIEV0aGVyIGluZGV4ZWQgYnkgdGhlaXIgRXRoZXJldW0gYWRkcmVzcyAqLwogICAgbWFwcGluZyhhZGRyZXNzID0+IEJhY2tlcikgcHVibGljIGJhY2tlcnM7CiAgICAvKgogICAgKiBNb2RpZmllcnMKICAgICovCiAgICBtb2RpZmllciBtaW5DYXBOb3RSZWFjaGVkKCkgewogICAgICAgIGlmICgobm93IDwgZW5kVGltZSkgfHwgY29pblNlbnRUb0V0aGVyID49IE1JTl9DQVAgKSB0aHJvdzsKICAgICAgICBfOwogICAgfQogICAgbW9kaWZpZXIgcmVzcGVjdFRpbWVGcmFtZSgpIHsKICAgICAgICBpZiAoKG5vdyA8IHN0YXJ0VGltZSkgfHwgKG5vdyA+IGVuZFRpbWUgKSkgdGhyb3c7CiAgICAgICAgXzsKICAgIH0KICAgIC8qCiAgICAgKiBFdmVudAogICAgKi8KICAgIGV2ZW50IExvZ1JlY2VpdmVkRVRIKGFkZHJlc3MgYWRkciwgdWludCB2YWx1ZSk7CiAgICBldmVudCBMb2dDb2luc0VtaXRlZChhZGRyZXNzIGluZGV4ZWQgZnJvbSwgdWludCBhbW91bnQpOwogICAgLyoKICAgICAqIENvbnN0cnVjdG9yCiAgICAqLwogICAgZnVuY3Rpb24gQ3Jvd2RzYWxlKGFkZHJlc3MgX05ld0hvcGVBZGRyZXNzLCBhZGRyZXNzIF90bykgewogICAgICAgIGNvaW4gPSBOZXdIb3BlKF9OZXdIb3BlQWRkcmVzcyk7CiAgICAgICAgbXVsdGlzaWdFdGhlciA9IF90bzsKICAgIH0KICAgIC8qIAogICAgICogVGhlIGZhbGxiYWNrIGZ1bmN0aW9uIGNvcnJlc3BvbmRzIHRvIGEgZG9uYXRpb24gaW4gRVRICiAgICAgKi8KICAgIGZ1bmN0aW9uKCkgc3RvcEluRW1lcmdlbmN5IHJlc3BlY3RUaW1lRnJhbWUgcGF5YWJsZSB7CiAgICAgICAgcmVjZWl2ZUVUSChtc2cuc2VuZGVyKTsKICAgIH0KICAgIC8qIAogICAgICogVG8gY2FsbCB0byBzdGFydCB0aGUgY3Jvd2RzYWxlCiAgICAgKi8KICAgIGZ1bmN0aW9uIHN0YXJ0KCkgb25seU93bmVyIHsKICAgICAgICBpZiAoc3RhcnRUaW1lICE9IDApIHRocm93OyAvLyBDcm93ZHNhbGUgd2FzIGFscmVhZHkgc3RhcnRlZAogICAgICAgIHN0YXJ0VGltZSA9IG5vdyA7ICAgICAgICAgICAgCiAgICAgICAgZW5kVGltZSA9ICBub3cgKyBDUk9XRFNBTEVfUEVSSU9EOyAgICAKICAgIH0KICAgIC8qCiAgICAgKiAgUmVjZWl2ZXMgYSBkb25hdGlvbiBpbiBFdGhlcgogICAgKi8KICAgIGZ1bmN0aW9uIHJlY2VpdmVFVEgoYWRkcmVzcyBiZW5lZmljaWFyeSkgaW50ZXJuYWwgewogICAgICAgIGlmIChtc2cudmFsdWUgPCBNSU5fSU5WRVNUX0VUSEVSKSB0aHJvdzsgLy8gRG9uJ3QgYWNjZXB0IGZ1bmRpbmcgdW5kZXIgYSBwcmVkZWZpbmVkIHRocmVzaG9sZAogICAgICAgIAogICAgICAgIHVpbnQgY29pblRvU2VuZCA9IGJvbnVzKG1zZy52YWx1ZS5tdWwoQ09JTl9QRVJfRVRIRVIpLmRpdigxIGV0aGVyKSk7IC8vIENvbXB1dGUgdGhlIG51bWJlciBvZiBOZXdIb3BlIHRvIHNlbmQKICAgICAgICBpZiAoY29pblRvU2VuZC5hZGQoY29pblNlbnRUb0V0aGVyKSA+IE1BWF9DQVApIHRocm93OyAgICAKICAgICAgICBCYWNrZXIgYmFja2VyID0gYmFja2Vyc1tiZW5lZmljaWFyeV07CiAgICAgICAgY29pbi50cmFuc2ZlcihiZW5lZmljaWFyeSwgY29pblRvU2VuZCk7IC8vIFRyYW5zZmVyIE5ld0hvcGVzIHJpZ2h0IG5vdyAKICAgICAgICBiYWNrZXIuY29pblNlbnQgPSBiYWNrZXIuY29pblNlbnQuYWRkKGNvaW5Ub1NlbmQpOwogICAgICAgIGJhY2tlci53ZWlSZWNlaXZlZCA9IGJhY2tlci53ZWlSZWNlaXZlZC5hZGQobXNnLnZhbHVlKTsgLy8gVXBkYXRlIHRoZSB0b3RhbCB3ZWkgY29sbGVjdGVkIGR1cmluZyB0aGUgY3Jvd2RmdW5kaW5nIGZvciB0aGlzIGJhY2tlciAgICAKICAgICAgICBldGhlclJlY2VpdmVkID0gZXRoZXJSZWNlaXZlZC5hZGQobXNnLnZhbHVlKTsgLy8gVXBkYXRlIHRoZSB0b3RhbCB3ZWkgY29sbGVjdGVkIGR1cmluZyB0aGUgY3Jvd2RmdW5kaW5nCiAgICAgICAgY29pblNlbnRUb0V0aGVyID0gY29pblNlbnRUb0V0aGVyLmFkZChjb2luVG9TZW5kKTsKICAgICAgICAvLyBTZW5kIGV2ZW50cwogICAgICAgIExvZ0NvaW5zRW1pdGVkKG1zZy5zZW5kZXIgLGNvaW5Ub1NlbmQpOwogICAgICAgIExvZ1JlY2VpdmVkRVRIKGJlbmVmaWNpYXJ5LCBldGhlclJlY2VpdmVkKTsgCiAgICB9CiAgICAKICAgIC8qCiAgICAgKkNvbXB1dGUgdGhlIE5ld0hvcGUgYm9udXMgYWNjb3JkaW5nIHRvIHRoZSBpbnZlc3RtZW50IHBlcmlvZAogICAgICovCiAgICBmdW5jdGlvbiBib251cyh1aW50IGFtb3VudCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIGlmIChub3cgPCBzdGFydFRpbWUuYWRkKDEgZGF5cykpIHJldHVybiBhbW91bnQuYWRkKGFtb3VudC5kaXYoMikpOyAgIC8vIGJvbnVzIDUwJQogICAgICAgIHJldHVybiBhbW91bnQ7CiAgICB9CiAgICAvKiAgCiAgICAgKiBGaW5hbGl6ZSB0aGUgY3Jvd2RzYWxlLCBzaG91bGQgYmUgY2FsbGVkIGFmdGVyIHRoZSByZWZ1bmQgcGVyaW9kCiAgICAqLwogICAgZnVuY3Rpb24gZmluYWxpemUoKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICBpZiAobm93IDwgZW5kVGltZSkgeyAvLyBDYW5ub3QgZmluYWxpc2UgYmVmb3JlIENST1dEU0FMRV9QRVJJT0Qgb3IgYmVmb3JlIHNlbGxpbmcgYWxsIGNvaW5zCiAgICAgICAgICAgIGlmIChjb2luU2VudFRvRXRoZXIgPT0gTUFYX0NBUCkgewogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGNvaW5TZW50VG9FdGhlciA8IE1JTl9DQVAgJiYgbm93IDwgZW5kVGltZSArIDMgZGF5cykgdGhyb3c7IC8vIElmIE1JTl9DQVAgaXMgbm90IHJlYWNoZWQgZG9ub3JzIGhhdmUgMTVkYXlzIHRvIGdldCByZWZ1bmQgYmVmb3JlIHdlIGNhbiBmaW5hbGlzZQogICAgICAgIGlmICghbXVsdGlzaWdFdGhlci5zZW5kKHRoaXMuYmFsYW5jZSkpIHRocm93OyAvLyBNb3ZlIHRoZSByZW1haW5pbmcgRXRoZXIgdG8gdGhlIG11bHRpc2lnIGFkZHJlc3MKICAgICAgICAKICAgICAgICB1aW50IHJlbWFpbnMgPSBjb2luLmJhbGFuY2VPZih0aGlzKTsKICAgICAgICBpZiAocmVtYWlucyA+IDApIHsgLy8gQnVybiB0aGUgcmVzdCBvZiBOZXdIb3BlcwogICAgICAgICAgICBpZiAoIWNvaW4uYnVybihyZW1haW5zKSkgdGhyb3cgOwogICAgICAgIH0KICAgICAgICBjcm93ZHNhbGVDbG9zZWQgPSB0cnVlOwogICAgfQogICAgLyogIAogICAgKiBGYWlsc2FmZSBkcmFpbgogICAgKi8KICAgIGZ1bmN0aW9uIGRyYWluKCkgb25seU93bmVyIHsKICAgICAgICBpZiAoIW93bmVyLnNlbmQodGhpcy5iYWxhbmNlKSkgdGhyb3c7CiAgICB9CiAgICAvKioKICAgICAqIEFsbG93IHRvIGNoYW5nZSB0aGUgdGVhbSBtdWx0aXNpZyBhZGRyZXNzIGluIHRoZSBjYXNlIG9mIGVtZXJnZW5jeS4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0TXVsdGlzaWcoYWRkcmVzcyBhZGRyKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICBpZiAoYWRkciA9PSBhZGRyZXNzKDApKSB0aHJvdzsKICAgICAgICBtdWx0aXNpZ0V0aGVyID0gYWRkcjsKICAgIH0KICAgIC8qKgogICAgICogTWFudWFsbHkgYmFjayBOZXdIb3BlIG93bmVyIGFkZHJlc3MuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJhY2tOZXdIb3BlT3duZXIoKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICBjb2luLnRyYW5zZmVyT3duZXJzaGlwKG93bmVyKTsKICAgIH0KICAgIC8qKgogICAgICogVHJhbnNmZXIgcmVtYWlucyB0byBvd25lciBpbiBjYXNlIGlmIGltcG9zc2libGUgdG8gZG8gbWluIGludmVzdAogICAgICovCiAgICBmdW5jdGlvbiBnZXRSZW1haW5Db2lucygpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHZhciByZW1haW5zID0gTUFYX0NBUCAtIGNvaW5TZW50VG9FdGhlcjsKICAgICAgICB1aW50IG1pbkNvaW5zVG9TZWxsID0gYm9udXMoTUlOX0lOVkVTVF9FVEhFUi5tdWwoQ09JTl9QRVJfRVRIRVIpIC8gKDEgZXRoZXIpKTsKICAgICAgICBpZihyZW1haW5zID4gbWluQ29pbnNUb1NlbGwpIHRocm93OwogICAgICAgIEJhY2tlciBiYWNrZXIgPSBiYWNrZXJzW293bmVyXTsKICAgICAgICBjb2luLnRyYW5zZmVyKG93bmVyLCByZW1haW5zKTsgLy8gVHJhbnNmZXIgTmV3SG9wZXMgcmlnaHQgbm93IAogICAgICAgIGJhY2tlci5jb2luU2VudCA9IGJhY2tlci5jb2luU2VudC5hZGQocmVtYWlucyk7CiAgICAgICAgY29pblNlbnRUb0V0aGVyID0gY29pblNlbnRUb0V0aGVyLmFkZChyZW1haW5zKTsKICAgICAgICAvLyBTZW5kIGV2ZW50cwogICAgICAgIExvZ0NvaW5zRW1pdGVkKHRoaXMgLHJlbWFpbnMpOwogICAgICAgIExvZ1JlY2VpdmVkRVRIKG93bmVyLCBldGhlclJlY2VpdmVkKTsgCiAgICB9CiAgICAvKiAKICAgICAqIFdoZW4gTUlOX0NBUCBpcyBub3QgcmVhY2g6CiAgICAgKiAxKSBiYWNrZXIgY2FsbCB0aGUgImFwcHJvdmUiIGZ1bmN0aW9uIG9mIHRoZSBOZXdIb3BlIHRva2VuIGNvbnRyYWN0IHdpdGggdGhlIGFtb3VudCBvZiBhbGwgTmV3SG9wZXMgdGhleSBnb3QgaW4gb3JkZXIgdG8gYmUgcmVmdW5kCiAgICAgKiAyKSBiYWNrZXIgY2FsbCB0aGUgInJlZnVuZCIgZnVuY3Rpb24gb2YgdGhlIENyb3dkc2FsZSBjb250cmFjdCB3aXRoIHRoZSBzYW1lIGFtb3VudCBvZiBOZXdIb3BlcwogICAgICogMykgYmFja2VyIGNhbGwgdGhlICJ3aXRoZHJhd1BheW1lbnRzIiBmdW5jdGlvbiBvZiB0aGUgQ3Jvd2RzYWxlIGNvbnRyYWN0IHRvIGdldCBhIHJlZnVuZCBpbiBFVEgKICAgICAqLwogICAgZnVuY3Rpb24gcmVmdW5kKHVpbnQgX3ZhbHVlKSBtaW5DYXBOb3RSZWFjaGVkIHB1YmxpYyB7CiAgICAgICAgCiAgICAgICAgaWYgKF92YWx1ZSAhPSBiYWNrZXJzW21zZy5zZW5kZXJdLmNvaW5TZW50KSB0aHJvdzsgLy8gY29tcGFyZSB2YWx1ZSBmcm9tIGJhY2tlciBiYWxhbmNlCiAgICAgICAgY29pbi50cmFuc2ZlckZyb20obXNnLnNlbmRlciwgYWRkcmVzcyh0aGlzKSwgX3ZhbHVlKTsgLy8gZ2V0IHRoZSB0b2tlbiBiYWNrIHRvIHRoZSBjcm93ZHNhbGUgY29udHJhY3QKICAgICAgICBpZiAoIWNvaW4uYnVybihfdmFsdWUpKSB0aHJvdyA7IC8vIHRva2VuIHNlbnQgZm9yIHJlZnVuZCBhcmUgYnVybnQKICAgICAgICB1aW50IEVUSFRvU2VuZCA9IGJhY2tlcnNbbXNnLnNlbmRlcl0ud2VpUmVjZWl2ZWQ7CiAgICAgICAgYmFja2Vyc1ttc2cuc2VuZGVyXS53ZWlSZWNlaXZlZD0wOwogICAgICAgIGlmIChFVEhUb1NlbmQgPiAwKSB7CiAgICAgICAgICAgIGFzeW5jU2VuZChtc2cuc2VuZGVyLCBFVEhUb1NlbmQpOyAvLyBwdWxsIHBheW1lbnQgdG8gZ2V0IHJlZnVuZCBpbiBFVEgKICAgICAgICB9CiAgICB9Cn0='.
	

]
