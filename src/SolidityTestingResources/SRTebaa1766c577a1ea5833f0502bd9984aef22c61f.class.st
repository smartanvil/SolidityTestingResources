Class {
	#name : #SRTebaa1766c577a1ea5833f0502bd9984aef22c61f,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTebaa1766c577a1ea5833f0502bd9984aef22c61f >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9CgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CgogICAgdWludDI1NiBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07CgogICAgLy8gQ2hlY2sgaXMgbm90IG5lZWRlZCBiZWNhdXNlIHN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0CiAgICAvLyByZXF1aXJlIChfdmFsdWUgPD0gX2FsbG93YW5jZSk7CgogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CgogIC8qKgogICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAogICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICovCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KfQoKCi8qKioqKgoqIEB0aXRsZSBBIERBREkgQ29udHJhY3QKKi8KY29udHJhY3QgRGFkaVNhbGUgaXMgT3duYWJsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICBTdGFuZGFyZFRva2VuIHB1YmxpYyB0b2tlbjsgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIERBREkgRVJDMjAgdG9rZW4gKi8KICAgIGFkZHJlc3NbXSBwdWJsaWMgc2FsZVdhbGxldHM7CgogICAgc3RydWN0IFdoaXRlbGlzdFVzZXIgewogICAgICB1aW50MjU2IHBsZWRnZWQ7CiAgICAgIHVpbnQgaW5kZXg7CiAgICB9CgogICAgc3RydWN0IEludmVzdG9yIHsKICAgICAgdWludDI1NiB0b2tlbnM7CiAgICAgIHVpbnQyNTYgY29udHJpYnV0aW9uOwogICAgICBib29sIGRpc3RyaWJ1dGVkOwogICAgICB1aW50IGluZGV4OwogICAgfQoKICAgIHVpbnQyNTYgcHVibGljIHRva2VuU3VwcGx5OwogICAgdWludDI1NiBwdWJsaWMgdG9rZW5zUHVyY2hhc2VkID0gMDsKICAgIHVpbnQyNTYgcHVibGljIHRva2VuUHJpY2UgPSA1MDA7ICAgICAgICAgICAgICAgICAgICAvLyBVU0QkMC41MAogICAgdWludDI1NiBwdWJsaWMgZXRoUmF0ZSA9IDIwMDsgICAgICAgICAgICAgICAgICAgICAgIC8vIEVUSCB0byBVU0QgUmF0ZSwgc2V0IGJ5IG93bmVyOiAxIEVUSCA9IGV0aFJhdGUgVVNECiAKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBXaGl0ZWxpc3RVc2VyKSBwcml2YXRlIHdoaXRlbGlzdGVkOwogICAgYWRkcmVzc1tdIHByaXZhdGUgd2hpdGVsaXN0ZWRJbmRleDsKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBJbnZlc3RvcikgcHJpdmF0ZSBpbnZlc3RvcnM7CiAgICBhZGRyZXNzW10gcHJpdmF0ZSBpbnZlc3RvckluZGV4OwoKICAgIC8qKioqKgogICAgKiBTdGF0ZSBmb3IgU2FsZSBNb2RlcwogICAgKiAgMCAtIFByZXBhcmluZzogICAgICAgICAgICBBbGwgY29udHJhY3QgaW5pdGlhbGl6YXRpb24gY2FsbHMKICAgICogIDEgLSBTYWxlOiAgICAgICAgICAgICAgICAgQ29udHJhY3QgaXMgaW4gdGhlIFNhbGUgUGVyaW9kCiAgICAqICAyIC0gU2FsZUZpbmFsaXplZCAgICAgICAgIFNhbGUgcGVyaW9kIGlzIGZpbmFsaXplZCwgbm8gbW9yZSBwYXltZW50cyBhcmUgYWxsb3dlZAogICAgKiAgMyAtIFN1Y2Nlc3M6ICAgICAgICAgICAgICBTYWxlIFN1Y2Nlc3NmdWwKICAgICogIDQgLSBUb2tlbkRpc3RyaWJ1dGlvbjogICAgU2FsZSBmaW5pc2hlZCwgdG9rZW5zIGNhbiBiZSBkaXN0cmlidXRlZAogICAgKiAgNSAtIENsb3NlZDogICAgICAgICAgICAgICBTYWxlIGNsb3NlZCwgbm8gdG9rZW5zIG1vcmUgY2FuIGJlIGRpc3RyaWJ1dGVkCiAgICAqLwogICAgZW51bSBTYWxlU3RhdGUgeyBQcmVwYXJpbmcsIFNhbGUsIFNhbGVGaW5hbGl6ZWQsIFN1Y2Nlc3MsIFRva2VuRGlzdHJpYnV0aW9uLCBDbG9zZWQgfQogICAgU2FsZVN0YXRlIHB1YmxpYyBzdGF0ZSA9IFNhbGVTdGF0ZS5QcmVwYXJpbmc7CgogICAgZXZlbnQgTG9nVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgdmFsdWUsIHVpbnQyNTYgdG9rZW5zKTsKICAgIGV2ZW50IExvZ1Rva2VuRGlzdHJpYnV0aW9uKGFkZHJlc3MgcmVjaXBpZW50LCB1aW50MjU2IHRva2Vucyk7CiAgICBldmVudCBMb2dSZWRpc3RyaWJ1dGVUb2tlbnMoYWRkcmVzcyByZWNpcGllbnQsIFNhbGVTdGF0ZSBfc3RhdGUsIHVpbnQyNTYgdG9rZW5zKTsKICAgIGV2ZW50IExvZ0Z1bmRUcmFuc2ZlcihhZGRyZXNzIHdhbGxldCwgdWludDI1NiB2YWx1ZSk7CiAgICBldmVudCBMb2dSZWZ1bmQoYWRkcmVzcyB3YWxsZXQsIHVpbnQyNTYgdmFsdWUpOwogICAgZXZlbnQgTG9nU3RhdGVDaGFuZ2UoU2FsZVN0YXRlIF9zdGF0ZSk7CiAgICBldmVudCBMb2dOZXdXaGl0ZWxpc3RVc2VyKGFkZHJlc3MgaW5kZXhlZCB1c2VyQWRkcmVzcywgdWludCBpbmRleCwgdWludDI1NiB2YWx1ZSk7CgogICAgLyoqKioqCiAgICAqIEBkZXYgTW9kaWZpZXIgdG8gY2hlY2sgdGhhdCBhbW91bnQgdHJhbnNmZXJyZWQgaXMgbm90IDAKICAgICovCiAgICBtb2RpZmllciBub25aZXJvKCkgewogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlICE9IDApOwogICAgICAgIF87CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgVGhlIGNvbnN0cnVjdG9yIGZ1bmN0aW9uIHRvIGluaXRpYWxpemUgdGhlIHNhbGUKICAgICogQHBhcmFtIF90b2tlbiAgICAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzICAgdGhlIGFkZHJlc3Mgb2YgdGhlIEVSQzIwIHRva2VuIGZvciB0aGUgc2FsZQogICAgKiBAcGFyYW0gX3Rva2VuU3VwcGx5ICAgICAgICAgICAgICAgICAgIHVpbnQyNTYgICB0aGUgYW1vdW50IG9mIHRva2VucyBhdmFpbGFibGUKICAgICovCiAgICBmdW5jdGlvbiBEYWRpU2FsZSAoU3RhbmRhcmRUb2tlbiBfdG9rZW4sIHVpbnQyNTYgX3Rva2VuU3VwcGx5KSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX3Rva2VuICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3Rva2VuU3VwcGx5ICE9IDApOwoKICAgICAgICB0b2tlbiA9IFN0YW5kYXJkVG9rZW4oX3Rva2VuKTsKICAgICAgICB0b2tlblN1cHBseSA9IF90b2tlblN1cHBseSAqICh1aW50MjU2KDEwKSAqKiAxOCk7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgRmFsbGJhY2sgRnVuY3Rpb24gdG8gYnV5IHRoZSB0b2tlbnMKICAgICovCiAgICBmdW5jdGlvbiAoKSBwdWJsaWMgbm9uWmVybyBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFNhbGVTdGF0ZS5TYWxlKTsKICAgICAgICBidXlUb2tlbnMobXNnLnNlbmRlciwgbXNnLnZhbHVlKTsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBBbGxvd3MgdGhlIGNvbnRyYWN0IG93bmVyIHRvIGFkZCBhIG5ldyBTYWxlIHdhbGxldCwgdXNlZCB0byBob2xkIGZ1bmRzIHNhZmVseQogICAgKiBAcGFyYW0gX3dhbGxldCAgICAgICAgYWRkcmVzcyAgICAgVGhlIGFkZHJlc3Mgb2YgdGhlIHdhbGxldAogICAgKiBAcmV0dXJuIHN1Y2Nlc3MgICAgICAgYm9vbCAgICAgICAgUmV0dXJucyB0cnVlIGlmIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseQogICAgKi8KICAgIGZ1bmN0aW9uIGFkZFNhbGVXYWxsZXQgKGFkZHJlc3MgX3dhbGxldCkgcHVibGljIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShfd2FsbGV0ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHNhbGVXYWxsZXRzLnB1c2goX3dhbGxldCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgQWxsb3dzIHRoZSBjb250cmFjdCBvd25lciB0byBhIHNpbmdsZSB3aGl0ZWxpc3QgdXNlcgogICAgKiBAcGFyYW0gdXNlckFkZHJlc3MgICAgIGFkZHJlc3MgICAgICBUaGUgd2FsbGV0IGFkZHJlc3MgdG8gd2hpdGVsaXN0CiAgICAqIEBwYXJhbSBwbGVkZ2VkICAgICAgICAgdWludDI1NiAgICAgIFRoZSBhbW91bnQgcGxlZGdlZCBieSB0aGUgdXNlcgogICAgKi8KICAgIGZ1bmN0aW9uIGFkZFdoaXRlbGlzdFVzZXIoYWRkcmVzcyB1c2VyQWRkcmVzcywgdWludDI1NiBwbGVkZ2VkKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBpZiAoIWlzV2hpdGVsaXN0ZWQodXNlckFkZHJlc3MpKSB7CiAgICAgICAgICAgIHdoaXRlbGlzdGVkW3VzZXJBZGRyZXNzXS5pbmRleCA9IHdoaXRlbGlzdGVkSW5kZXgucHVzaCh1c2VyQWRkcmVzcykgLSAxOwogICAgICAgICAgCiAgICAgICAgICAgIExvZ05ld1doaXRlbGlzdFVzZXIodXNlckFkZHJlc3MsIHdoaXRlbGlzdGVkW3VzZXJBZGRyZXNzXS5pbmRleCwgcGxlZGdlZCk7CiAgICAgICAgfQoKICAgICAgICB3aGl0ZWxpc3RlZFt1c2VyQWRkcmVzc10ucGxlZGdlZCA9IHBsZWRnZWQgKiAxMDAwOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IENhbGN1bGF0ZXMgdGhlIG51bWJlciBvZiB0b2tlbnMgdGhhdCBjYW4gYmUgYm91Z2h0IGZvciB0aGUgYW1vdW50IG9mIFdlaSB0cmFuc2ZlcnJlZAogICAgKiBAcGFyYW0gX2Ftb3VudCAgICB1aW50MjU2ICAgICBUaGUgYW1vdW50IG9mIG1vbmV5IGludmVzdGVkIGJ5IHRoZSBpbnZlc3RvcgogICAgKiBAcmV0dXJuIHRva2VucyAgICB1aW50MjU2ICAgICBUaGUgbnVtYmVyIG9mIHRva2VucyBwdXJjaGFzZWQgZm9yIHRoZSBhbW91bnQgaW52ZXN0ZWQKICAgICovCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVUb2tlbnMgKHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgdG9rZW5zKSB7CiAgICAgICAgdG9rZW5zID0gX2Ftb3VudCAqIGV0aFJhdGUgLyB0b2tlblByaWNlOwogICAgICAgIHJldHVybiB0b2tlbnM7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgQ2FsbGVkIGJ5IHRoZSBvd25lciBvZiB0aGUgY29udHJhY3QgdG8gbW9kaWZ5IHRoZSBzYWxlIHN0YXRlCiAgICAqLwogICAgZnVuY3Rpb24gc2V0U3RhdGUgKHVpbnQyNTYgX3N0YXRlKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBzdGF0ZSA9IFNhbGVTdGF0ZSh1aW50KF9zdGF0ZSkpOwogICAgICAgIExvZ1N0YXRlQ2hhbmdlKHN0YXRlKTsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBDYWxsZWQgYnkgdGhlIG93bmVyIG9mIHRoZSBjb250cmFjdCB0byBzdGFydCB0aGUgU2FsZQogICAgKiBAcGFyYW0gcmF0ZSAgIHVpbnQyNTYgIHRoZSBjdXJyZW50IEVUSCBVU0QgcmF0ZSwgbXVsdGlwbGllZCBieSAxMDAwCiAgICAqLwogICAgZnVuY3Rpb24gc3RhcnRTYWxlICh1aW50MjU2IHJhdGUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHN0YXRlID0gU2FsZVN0YXRlLlNhbGU7CiAgICAgICAgdXBkYXRlRXRoUmF0ZShyYXRlKTsKICAgICAgICBMb2dTdGF0ZUNoYW5nZShzdGF0ZSk7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgQWxsb3cgdXBkYXRpbmcgdGhlIEVUSCBVU0QgZXhjaGFuZ2UgcmF0ZQogICAgKiBAcGFyYW0gcmF0ZSAgIHVpbnQyNTYgIHRoZSBjdXJyZW50IEVUSCBVU0QgcmF0ZSwgbXVsdGlwbGllZCBieSAxMDAwCiAgICAqIEByZXR1cm4gYm9vbCAgUmV0dXJuIHRydWUgaWYgdGhlIGNvbnRyYWN0IGlzIGluIFBhcnRuZXJTYWxlIFBlcmlvZAogICAgKi8KICAgIGZ1bmN0aW9uIHVwZGF0ZUV0aFJhdGUgKHVpbnQyNTYgcmF0ZSkgcHVibGljIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShyYXRlID49IDEwMDAwMCk7CiAgICAgICAgCiAgICAgICAgZXRoUmF0ZSA9IHJhdGU7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gdXBkYXRlVG9rZW5TdXBwbHkgKHVpbnQyNTYgX3Rva2VuU3VwcGx5KSAgcHVibGljIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShfdG9rZW5TdXBwbHkgIT0gMCk7CiAgICAgICAgdG9rZW5TdXBwbHkgPSBfdG9rZW5TdXBwbHkgKiAodWludDI1NigxMCkgKiogMTgpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IEFsbG93cyB0cmFuc2ZlciBvZiB0b2tlbnMgdG8gYSByZWNpcGllbnQgd2hvIGhhcyBwdXJjaGFzZWQgb2ZmbGluZSwgZHVyaW5nIHRoZSBTYWxlCiAgICAqIEBwYXJhbSBfcmVjaXBpZW50ICAgICBhZGRyZXNzICAgICBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50IG9mIHRoZSB0b2tlbnMKICAgICogQHBhcmFtIF90b2tlbnMgICAgICAgIHVpbnQyNTYgICAgIFRoZSBudW1iZXIgb2YgdG9rZW5zIHB1cmNoYXNlZCBieSB0aGUgcmVjaXBpZW50CiAgICAqIEByZXR1cm4gc3VjY2VzcyAgICAgICBib29sICAgICAgICBSZXR1cm5zIHRydWUgaWYgZXhlY3V0ZWQgc3VjY2Vzc2Z1bGx5CiAgICAqLwogICAgZnVuY3Rpb24gb2ZmbGluZVRyYW5zYWN0aW9uIChhZGRyZXNzIF9yZWNpcGllbnQsIHVpbnQyNTYgX3Rva2VucykgcHVibGljIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShfdG9rZW5zID4gMCk7CgogICAgICAgIC8vIENvbnZlcnQgdG8gYSB0b2tlbiB3aXRoIGRlY2ltYWxzIAogICAgICAgIHVpbnQyNTYgdG9rZW5zID0gX3Rva2VucyAqICh1aW50MjU2KDEwKSAqKiB1aW50OCgxOCkpOwoKICAgICAgICAvLyBpZiB0aGUgbnVtYmVyIG9mIHRva2VucyBpcyBncmVhdGVyIHRoYW4gYXZhaWxhYmxlLCByZWplY3QgdHgKICAgICAgICBpZiAodG9rZW5zID49IGdldFRva2Vuc0F2YWlsYWJsZSgpKSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KCiAgICAgICAgYWRkVG9JbnZlc3RvcihfcmVjaXBpZW50LCAwLCB0b2tlbnMpOwoKICAgICAgICAvLyBJbmNyZWFzZSB0aGUgY291bnQgb2YgdG9rZW5zIHB1cmNoYXNlZCBpbiB0aGUgc2FsZQogICAgICAgIHVwZGF0ZVNhbGVQYXJhbWV0ZXJzKHRva2Vucyk7CgogICAgICAgIExvZ1Rva2VuUHVyY2hhc2UobXNnLnNlbmRlciwgX3JlY2lwaWVudCwgMCwgdG9rZW5zKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgQ2FsbGVkIGJ5IHRoZSBvd25lciBvZiB0aGUgY29udHJhY3QgdG8gZmluYWxpemUgdGhlIElDTwogICAgKiAgICAgIGFuZCByZWRpc3RyaWJ1dGUgZnVuZHMgKGlmIGFueSkKICAgICovCiAgICBmdW5jdGlvbiBmaW5hbGl6ZVNhbGUgKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgc3RhdGUgPSBTYWxlU3RhdGUuU3VjY2VzczsKICAgICAgICBMb2dTdGF0ZUNoYW5nZShzdGF0ZSk7CgogICAgICAgIC8vIFRyYW5zZmVyIGFueSBFVEggdG8gb25lIG9mIHRoZSBTYWxlIHdhbGxldHMKICAgICAgICBpZiAodGhpcy5iYWxhbmNlID4gMCkgewogICAgICAgICAgICBmb3J3YXJkRnVuZHModGhpcy5iYWxhbmNlKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgQ2FsbGVkIGJ5IHRoZSBvd25lciBvZiB0aGUgY29udHJhY3QgdG8gY2xvc2UgdGhlIFNhbGUgYW5kIHJlZGlzdHJpYnV0ZSBhbnkgY3J1bWJzLgogICAgKiBAcGFyYW0gcmVjaXBpZW50ICAgICBhZGRyZXNzICAgICBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50IG9mIHRoZSB0b2tlbnMKICAgICovCiAgICBmdW5jdGlvbiBjbG9zZVNhbGUgKGFkZHJlc3MgcmVjaXBpZW50KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBzdGF0ZSA9IFNhbGVTdGF0ZS5DbG9zZWQ7CiAgICAgICAgTG9nU3RhdGVDaGFuZ2Uoc3RhdGUpOwoKICAgICAgICAvLyByZWRpc3RyaWJ1dGUgdW5zb2xkIHRva2VucyB0byBEQURJIGVjb3N5c3RlbQogICAgICAgIHVpbnQyNTYgcmVtYWluaW5nID0gZ2V0VG9rZW5zQXZhaWxhYmxlKCk7CiAgICAgICAgdXBkYXRlU2FsZVBhcmFtZXRlcnMocmVtYWluaW5nKTsKCiAgICAgICAgaWYgKHJlbWFpbmluZyA+IDApIHsKICAgICAgICAgICAgdG9rZW4udHJhbnNmZXIocmVjaXBpZW50LCByZW1haW5pbmcpOwogICAgICAgICAgICBMb2dSZWRpc3RyaWJ1dGVUb2tlbnMocmVjaXBpZW50LCBzdGF0ZSwgcmVtYWluaW5nKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgQ2FsbGVkIGJ5IHRoZSBvd25lciBvZiB0aGUgY29udHJhY3QgdG8gYWxsb3cgdG9rZW5zIHRvIGJlIGRpc3RyaWJ1dGVkCiAgICAqLwogICAgZnVuY3Rpb24gc2V0VG9rZW5EaXN0cmlidXRpb24gKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgc3RhdGUgPSBTYWxlU3RhdGUuVG9rZW5EaXN0cmlidXRpb247CiAgICAgICAgTG9nU3RhdGVDaGFuZ2Uoc3RhdGUpOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IENhbGxlZCBieSB0aGUgb3duZXIgb2YgdGhlIGNvbnRyYWN0IHRvIGRpc3RyaWJ1dGUgdG9rZW5zIHRvIGludmVzdG9ycwogICAgKiBAcGFyYW0gX2FkZHJlc3MgICAgICAgYWRkcmVzcyAgICAgVGhlIGFkZHJlc3Mgb2YgdGhlIGludmVzdG9yIGZvciB3aGljaCB0byBkaXN0cmlidXRlIHRva2VucwogICAgKiBAcmV0dXJuIHN1Y2Nlc3MgICAgICAgYm9vbCAgICAgICAgUmV0dXJucyB0cnVlIGlmIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseQogICAgKi8KICAgIGZ1bmN0aW9uIGRpc3RyaWJ1dGVUb2tlbnMgKGFkZHJlc3MgX2FkZHJlc3MpIHB1YmxpYyBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoc3RhdGUgPT0gU2FsZVN0YXRlLlRva2VuRGlzdHJpYnV0aW9uKTsKICAgICAgICAKICAgICAgICAvLyBnZXQgdGhlIHRva2VucyBhdmFpbGFibGUgZm9yIHRoZSBpbnZlc3RvcgogICAgICAgIHVpbnQyNTYgdG9rZW5zID0gaW52ZXN0b3JzW19hZGRyZXNzXS50b2tlbnM7CiAgICAgICAgcmVxdWlyZSh0b2tlbnMgPiAwKTsKCiAgICAgICAgcmVxdWlyZShpbnZlc3RvcnNbX2FkZHJlc3NdLmRpc3RyaWJ1dGVkID09IGZhbHNlKTsKCiAgICAgICAgaW52ZXN0b3JzW19hZGRyZXNzXS5kaXN0cmlidXRlZCA9IHRydWU7CgogICAgICAgIHRva2VuLnRyYW5zZmVyKF9hZGRyZXNzLCB0b2tlbnMpOwogICAgICAKICAgICAgICBMb2dUb2tlbkRpc3RyaWJ1dGlvbihfYWRkcmVzcywgdG9rZW5zKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBDYWxsZWQgYnkgdGhlIG93bmVyIG9mIHRoZSBjb250cmFjdCB0byBkaXN0cmlidXRlIHRva2VucyB0byBpbnZlc3RvcnMgd2hvIHVzZWQgYSBub24tRVJDMjAgd2FsbGV0IGFkZHJlc3MKICAgICogQHBhcmFtIF9wdXJjaGFzZUFkZHJlc3MgICAgICAgIGFkZHJlc3MgICAgIFRoZSBhZGRyZXNzIHRoZSBpbnZlc3RvciB1c2VkIHRvIGJ1eSB0b2tlbnMKICAgICogQHBhcmFtIF90b2tlbkFkZHJlc3MgICAgICAgICAgIGFkZHJlc3MgICAgIFRoZSBhZGRyZXNzIHRvIHNlbmQgdGhlIHRva2VucyB0bwogICAgKiBAcmV0dXJuIHN1Y2Nlc3MgICAgICAgICAgICAgICAgYm9vbCAgICAgICAgUmV0dXJucyB0cnVlIGlmIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseQogICAgKi8KICAgIGZ1bmN0aW9uIGRpc3RyaWJ1dGVUb0FsdGVybmF0ZUFkZHJlc3MgKGFkZHJlc3MgX3B1cmNoYXNlQWRkcmVzcywgYWRkcmVzcyBfdG9rZW5BZGRyZXNzKSBwdWJsaWMgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFNhbGVTdGF0ZS5Ub2tlbkRpc3RyaWJ1dGlvbik7CiAgICAgICAgCiAgICAgICAgLy8gZ2V0IHRoZSB0b2tlbnMgYXZhaWxhYmxlIGZvciB0aGUgaW52ZXN0b3IKICAgICAgICB1aW50MjU2IHRva2VucyA9IGludmVzdG9yc1tfcHVyY2hhc2VBZGRyZXNzXS50b2tlbnM7CiAgICAgICAgcmVxdWlyZSh0b2tlbnMgPiAwKTsKCiAgICAgICAgcmVxdWlyZShpbnZlc3RvcnNbX3B1cmNoYXNlQWRkcmVzc10uZGlzdHJpYnV0ZWQgPT0gZmFsc2UpOwoKICAgICAgICBpbnZlc3RvcnNbX3B1cmNoYXNlQWRkcmVzc10uZGlzdHJpYnV0ZWQgPSB0cnVlOwoKICAgICAgICB0b2tlbi50cmFuc2ZlcihfdG9rZW5BZGRyZXNzLCB0b2tlbnMpOwogICAgICAKICAgICAgICBMb2dUb2tlbkRpc3RyaWJ1dGlvbihfdG9rZW5BZGRyZXNzLCB0b2tlbnMpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IENhbGxlZCBieSB0aGUgb3duZXIgb2YgdGhlIGNvbnRyYWN0IHRvIHJlZGlzdHJpYnV0ZSB0b2tlbnMgaWYgYW4gaW52ZXN0b3IgaGFzIGJlZW4gcmVmdW5kZWQgb2ZmbGluZQogICAgKiBAcGFyYW0gaW52ZXN0b3JBZGRyZXNzICAgICAgICAgYWRkcmVzcyAgICAgVGhlIGFkZHJlc3MgdGhlIGludmVzdG9yIHVzZWQgdG8gYnV5IHRva2VucwogICAgKiBAcGFyYW0gcmVjaXBpZW50ICAgICAgICAgICAgICAgYWRkcmVzcyAgICAgVGhlIGFkZHJlc3MgdG8gc2VuZCB0aGUgdG9rZW5zIHRvCiAgICAqLwogICAgZnVuY3Rpb24gcmVkaXN0cmlidXRlVG9rZW5zIChhZGRyZXNzIGludmVzdG9yQWRkcmVzcywgYWRkcmVzcyByZWNpcGllbnQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHVpbnQyNTYgdG9rZW5zID0gaW52ZXN0b3JzW2ludmVzdG9yQWRkcmVzc10udG9rZW5zOwogICAgICAgIHJlcXVpcmUodG9rZW5zID4gMCk7CiAgICAgICAgcmVxdWlyZShpbnZlc3RvcnNbaW52ZXN0b3JBZGRyZXNzXS5kaXN0cmlidXRlZCA9PSBmYWxzZSk7CiAgICAgICAgCiAgICAgICAgLy8gc2V0IGZsYWcsIHNvIHRoZXkgY2FuJ3QgYmUgcmVkaXN0cmlidXRlZAogICAgICAgIGludmVzdG9yc1tpbnZlc3RvckFkZHJlc3NdLmRpc3RyaWJ1dGVkID0gdHJ1ZTsKICAgICAgICB0b2tlbi50cmFuc2ZlcihyZWNpcGllbnQsIHRva2Vucyk7CgogICAgICAgIExvZ1JlZGlzdHJpYnV0ZVRva2VucyhyZWNpcGllbnQsIHN0YXRlLCB0b2tlbnMpOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IEdldCB0aGUgYW1vdW50IG9mIFNhbGUgdG9rZW5zIGxlZnQgZm9yIHB1cmNoYXNlCiAgICAqIEByZXR1cm4gdWludDI1NiB0aGUgY291bnQgb2YgdG9rZW5zIGF2YWlsYWJsZQogICAgKi8KICAgIGZ1bmN0aW9uIGdldFRva2Vuc0F2YWlsYWJsZSAoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiB0b2tlblN1cHBseSAtIHRva2Vuc1B1cmNoYXNlZDsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBHZXQgdGhlIHRvdGFsIGNvdW50IG9mIHRva2VucyBwdXJjaGFzZWQgaW4gYWxsIHRoZSBTYWxlIHBlcmlvZHMKICAgICogQHJldHVybiB1aW50MjU2IHRoZSBjb3VudCBvZiB0b2tlbnMgcHVyY2hhc2VkCiAgICAqLwogICAgZnVuY3Rpb24gZ2V0VG9rZW5zUHVyY2hhc2VkICgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHRva2Vuc1B1cmNoYXNlZDsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBHZXQgdGhlIGJhbGFuY2Ugc2VudCB0byB0aGUgY29udHJhY3QKICAgICogQHJldHVybiB1aW50MjU2IHRoZSBhbW91bnQgc2VudCB0byB0aGlzIGNvbnRyYWN0LCBpbiBXZWkKICAgICovCiAgICBmdW5jdGlvbiBnZXRCYWxhbmNlICgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHRoaXMuYmFsYW5jZTsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBDb252ZXJ0cyBhbiBhbW91bnQgc2VudCBpbiBXZWkgdG8gdGhlIGVxdWl2YWxlbnQgaW4gVVNECiAgICAqIEBwYXJhbSBfYW1vdW50ICAgICAgdWludDI1NiAgICAgICB0aGUgYW1vdW50IHNlbnQgdG8gdGhlIGNvbnRyYWN0LCBpbiBXZWkKICAgICogQHJldHVybiB1aW50MjU2ICB0aGUgYW1vdW50IHNlbnQgdG8gdGhpcyBjb250cmFjdCwgaW4gVVNECiAgICAqLwogICAgZnVuY3Rpb24gZXRoVG9Vc2QgKHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gKF9hbW91bnQgKiBldGhSYXRlKSAvICh1aW50MjU2KDEwKSAqKiAxOCk7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgR2V0IGEgd2hpdGVsaXN0ZWQgdXNlcgogICAgKiBAcGFyYW0gdXNlckFkZHJlc3MgICAgICBhZGRyZXNzICAgICAgIHRoZSB3YWxsZXQgYWRkcmVzcyBvZiB0aGUgdXNlcgogICAgKiBAcmV0dXJuIHVpbnQyNTYgIHRoZSBhbW91bnQgcGxlZGdlZCBieSB0aGUgdXNlcgogICAgKiBAcmV0dXJuIHVpbnQgICAgIHRoZSBpbmRleCBvZiB0aGUgdXNlcgogICAgKi8KICAgIGZ1bmN0aW9uIGdldFdoaXRlbGlzdFVzZXIgKGFkZHJlc3MgdXNlckFkZHJlc3MpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHBsZWRnZWQsIHVpbnQgaW5kZXgpIHsKICAgICAgICByZXF1aXJlKGlzV2hpdGVsaXN0ZWQodXNlckFkZHJlc3MpKTsKICAgICAgICByZXR1cm4od2hpdGVsaXN0ZWRbdXNlckFkZHJlc3NdLnBsZWRnZWQsIHdoaXRlbGlzdGVkW3VzZXJBZGRyZXNzXS5pbmRleCk7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgR2V0IGNvdW50IG9mIGNvbnRyaWJ1dG9ycwogICAgKiBAcmV0dXJuIHVpbnQgICAgIHRoZSBudW1iZXIgb2YgdW5pcXVlIGNvbnRyaWJ1dG9ycwogICAgKi8KICAgIGZ1bmN0aW9uIGdldEludmVzdG9yQ291bnQgKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQgY291bnQpIHsKICAgICAgICByZXR1cm4gaW52ZXN0b3JJbmRleC5sZW5ndGg7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgR2V0IGFuIGludmVzdG9yCiAgICAqIEBwYXJhbSBfYWRkcmVzcyAgICAgIGFkZHJlc3MgICAgICAgdGhlIHdhbGxldCBhZGRyZXNzIG9mIHRoZSBpbnZlc3RvcgogICAgKiBAcmV0dXJuIHVpbnQyNTYgIHRoZSBhbW91bnQgY29udHJpYnV0ZWQgYnkgdGhlIHVzZXIKICAgICogQHJldHVybiB1aW50MjU2ICB0aGUgbnVtYmVyIG9mIHRva2VucyBhc3NpZ25lZCB0byB0aGUgdXNlcgogICAgKiBAcmV0dXJuIHVpbnQgICAgIHRoZSBpbmRleCBvZiB0aGUgdXNlcgogICAgKi8KICAgIGZ1bmN0aW9uIGdldEludmVzdG9yIChhZGRyZXNzIF9hZGRyZXNzKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBjb250cmlidXRpb24sIHVpbnQyNTYgdG9rZW5zLCBib29sIGRpc3RyaWJ1dGVkLCB1aW50IGluZGV4KSB7CiAgICAgICAgcmVxdWlyZShpc0ludmVzdGVkKF9hZGRyZXNzKSk7CiAgICAgICAgcmV0dXJuKGludmVzdG9yc1tfYWRkcmVzc10uY29udHJpYnV0aW9uLCBpbnZlc3RvcnNbX2FkZHJlc3NdLnRva2VucywgaW52ZXN0b3JzW19hZGRyZXNzXS5kaXN0cmlidXRlZCwgaW52ZXN0b3JzW19hZGRyZXNzXS5pbmRleCk7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgR2V0IGEgdXNlcidzIHdoaXRlbGlzdGVkIHN0YXRlCiAgICAqIEBwYXJhbSB1c2VyQWRkcmVzcyAgICAgIGFkZHJlc3MgICAgICAgdGhlIHdhbGxldCBhZGRyZXNzIG9mIHRoZSB1c2VyCiAgICAqIEByZXR1cm4gYm9vbCAgdHJ1ZSBpZiB0aGUgdXNlciBpcyBpbiB0aGUgd2hpdGVsaXN0CiAgICAqLwogICAgZnVuY3Rpb24gaXNXaGl0ZWxpc3RlZCAoYWRkcmVzcyB1c2VyQWRkcmVzcykgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYm9vbCBpc0luZGVlZCkgewogICAgICAgIGlmICh3aGl0ZWxpc3RlZEluZGV4Lmxlbmd0aCA9PSAwKSByZXR1cm4gZmFsc2U7CiAgICAgICAgcmV0dXJuICh3aGl0ZWxpc3RlZEluZGV4W3doaXRlbGlzdGVkW3VzZXJBZGRyZXNzXS5pbmRleF0gPT0gdXNlckFkZHJlc3MpOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IEdldCBhIHVzZXIncyBpbnZlc3RlZCBzdGF0ZQogICAgKiBAcGFyYW0gX2FkZHJlc3MgICAgICBhZGRyZXNzICAgICAgIHRoZSB3YWxsZXQgYWRkcmVzcyBvZiB0aGUgdXNlcgogICAgKiBAcmV0dXJuIGJvb2wgIHRydWUgaWYgdGhlIHVzZXIgaGFzIGFscmVhZHkgY29udHJpYnV0ZWQKICAgICovCiAgICBmdW5jdGlvbiBpc0ludmVzdGVkIChhZGRyZXNzIF9hZGRyZXNzKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zIChib29sIGlzSW5kZWVkKSB7CiAgICAgICAgaWYgKGludmVzdG9ySW5kZXgubGVuZ3RoID09IDApIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gKGludmVzdG9ySW5kZXhbaW52ZXN0b3JzW19hZGRyZXNzXS5pbmRleF0gPT0gX2FkZHJlc3MpOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IFVwZGF0ZSBhIHVzZXIncyBpbnZlc3RlZCBzdGF0ZQogICAgKiBAcGFyYW0gX2FkZHJlc3MgICAgICBhZGRyZXNzICAgICAgIHRoZSB3YWxsZXQgYWRkcmVzcyBvZiB0aGUgdXNlcgogICAgKiBAcGFyYW0gX3ZhbHVlICAgICAgICB1aW50MjU2ICAgICAgIHRoZSBhbW91bnQgY29udHJpYnV0ZWQgaW4gdGhpcyB0cmFuc2FjdGlvbgogICAgKiBAcGFyYW0gX3Rva2VucyAgICAgICB1aW50MjU2ICAgICAgIHRoZSBudW1iZXIgb2YgdG9rZW5zIGFzc2lnbmVkIGluIHRoaXMgdHJhbnNhY3Rpb24KICAgICovCiAgICBmdW5jdGlvbiBhZGRUb0ludmVzdG9yKGFkZHJlc3MgX2FkZHJlc3MsIHVpbnQyNTYgX3ZhbHVlLCB1aW50MjU2IF90b2tlbnMpIGludGVybmFsIHsKICAgICAgICAvLyBhZGQgdGhlIHVzZXIgdG8gdGhlIGludmVzdG9ySW5kZXggaWYgdGhpcyBpcyB0aGVpciBmaXJzdCBjb250cmlidXRpb24KICAgICAgICBpZiAoIWlzSW52ZXN0ZWQoX2FkZHJlc3MpKSB7CiAgICAgICAgICAgIGludmVzdG9yc1tfYWRkcmVzc10uaW5kZXggPSBpbnZlc3RvckluZGV4LnB1c2goX2FkZHJlc3MpIC0gMTsKICAgICAgICB9CiAgICAgIAogICAgICAgIGludmVzdG9yc1tfYWRkcmVzc10udG9rZW5zID0gaW52ZXN0b3JzW19hZGRyZXNzXS50b2tlbnMuYWRkKF90b2tlbnMpOwogICAgICAgIGludmVzdG9yc1tfYWRkcmVzc10uY29udHJpYnV0aW9uID0gaW52ZXN0b3JzW19hZGRyZXNzXS5jb250cmlidXRpb24uYWRkKF92YWx1ZSk7CiAgICAgICAgaW52ZXN0b3JzW19hZGRyZXNzXS5kaXN0cmlidXRlZCA9IGZhbHNlOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IFNlbmQgZXRoZXIgdG8gdGhlIFNhbGUgY29sbGVjdGlvbiB3YWxsZXRzCiAgICAqLwogICAgZnVuY3Rpb24gZm9yd2FyZEZ1bmRzICh1aW50MjU2IF92YWx1ZSkgaW50ZXJuYWwgewogICAgICAgIHVpbnQgYWNjb3VudE51bWJlcjsKICAgICAgICBhZGRyZXNzIGFjY291bnQ7CgogICAgICAgIC8vIG1vdmUgZnVuZHMgdG8gYSByYW5kb20gU2FsZVdhbGxldAogICAgICAgIGlmIChzYWxlV2FsbGV0cy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGFjY291bnROdW1iZXIgPSBnZXRSYW5kb20oc2FsZVdhbGxldHMubGVuZ3RoKSAtIDE7CiAgICAgICAgICAgIGFjY291bnQgPSBzYWxlV2FsbGV0c1thY2NvdW50TnVtYmVyXTsKICAgICAgICAgICAgYWNjb3VudC50cmFuc2ZlcihfdmFsdWUpOwogICAgICAgICAgICBMb2dGdW5kVHJhbnNmZXIoYWNjb3VudCwgX3ZhbHVlKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgSW50ZXJuYWwgZnVuY3Rpb24gdG8gYXNzaWduIHRva2VucyB0byB0aGUgY29udHJpYnV0b3IKICAgICogQHBhcmFtIF9hZGRyZXNzICAgICAgIGFkZHJlc3MgICAgIFRoZSBhZGRyZXNzIG9mIHRoZSBjb250cmlidXRpbmcgaW52ZXN0b3IKICAgICogQHBhcmFtIF92YWx1ZSAgICAgICAgIHVpbnQyNTYgICAgIFRoZSBhbW91bnQgaW52ZXN0ZWQgCiAgICAqIEByZXR1cm4gc3VjY2VzcyAgICAgICBib29sICAgICAgICBSZXR1cm5zIHRydWUgaWYgZXhlY3V0ZWQgc3VjY2Vzc2Z1bGx5CiAgICAqLwogICAgZnVuY3Rpb24gYnV5VG9rZW5zIChhZGRyZXNzIF9hZGRyZXNzLCB1aW50MjU2IF92YWx1ZSkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoaXNXaGl0ZWxpc3RlZChfYWRkcmVzcykpOwoKICAgICAgICByZXF1aXJlKGlzVmFsaWRDb250cmlidXRpb24oX2FkZHJlc3MsIF92YWx1ZSkpOwoKICAgICAgICB1aW50MjU2IGJvdWdodFRva2VucyA9IGNhbGN1bGF0ZVRva2VucyhfdmFsdWUpOwogICAgICAgIHJlcXVpcmUoYm91Z2h0VG9rZW5zICE9IDApOwoKICAgICAgICAvLyBpZiB0aGUgbnVtYmVyIG9mIHRva2VucyBjYWxjdWxhdGVkIGZvciB0aGUgZ2l2ZW4gdmFsdWUgaXMgCiAgICAgICAgLy8gZ3JlYXRlciB0aGFuIHRoZSB0b2tlbnMgYXZhaWxhYmxlLCByZWplY3QgdGhlIHBheW1lbnQKICAgICAgICBpZiAoYm91Z2h0VG9rZW5zID4gZ2V0VG9rZW5zQXZhaWxhYmxlKCkpIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQoKICAgICAgICAvLyB1cGRhdGUgaW52ZXN0b3Igc3RhdGUKICAgICAgICBhZGRUb0ludmVzdG9yKF9hZGRyZXNzLCBfdmFsdWUsIGJvdWdodFRva2Vucyk7CgogICAgICAgIGZvcndhcmRGdW5kcyhfdmFsdWUpOwoKICAgICAgICB1cGRhdGVTYWxlUGFyYW1ldGVycyhib3VnaHRUb2tlbnMpOwoKICAgICAgICBMb2dUb2tlblB1cmNoYXNlKG1zZy5zZW5kZXIsIF9hZGRyZXNzLCBfdmFsdWUsIGJvdWdodFRva2Vucyk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IENoZWNrIHRoYXQgdGhlIGFtb3VudCBzZW50IGluIHRoZSB0cmFuc2FjdGlvbiBpcyBiZWxvdyB0aGUgcGxlZGdlZCBhbW91bnQuCiAgICAqIEZhY3RvcnMgaW4gcHJldmlvdXMgdHJhbnNhY3Rpb25zIGJ5IHRoZSBzYW1lIHVzZXIKICAgICogQHBhcmFtIF9hZGRyZXNzICAgICAgICAgYWRkcmVzcyAgICAgVGhlIGFkZHJlc3Mgb2YgdGhlIHVzZXIgbWFraW5nIHRoZSB0cmFuc2FjdGlvbgogICAgKiBAcGFyYW0gX2Ftb3VudCAgICAgICAgICB1aW50MjU2ICAgICBUaGUgYW1vdW50IHNlbnQgaW4gdGhlIHRyYW5zYWN0aW9uCiAgICAqIEByZXR1cm4gICAgICAgIGJvb2wgICAgICAgIFJldHVybnMgdHJ1ZSBpZiB0aGUgYW1vdW50IGlzIHZhbGlkCiAgICAqLwogICAgZnVuY3Rpb24gaXNWYWxpZENvbnRyaWJ1dGlvbiAoYWRkcmVzcyBfYWRkcmVzcywgdWludDI1NiBfYW1vdW50KSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zIChib29sIHZhbGlkKSB7CiAgICAgICAgcmV0dXJuIGV0aFRvVXNkKF9hbW91bnQgKyBpbnZlc3RvcnNbX2FkZHJlc3NdLmNvbnRyaWJ1dGlvbikgPD0gd2hpdGVsaXN0ZWRbX2FkZHJlc3NdLnBsZWRnZWQ7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgR2VuZXJhdGVzIGEgcmFuZG9tIG51bWJlciBmcm9tIDEgdG8gbWF4IGJhc2VkIG9uIHRoZSBsYXN0IGJsb2NrIGhhc2gKICAgICogQHBhcmFtIG1heCAgICAgdWludCAgdGhlIG1heGltdW0gdmFsdWUgCiAgICAqIEByZXR1cm4gYSByYW5kb20gbnVtYmVyCiAgICAqLwogICAgZnVuY3Rpb24gZ2V0UmFuZG9tKHVpbnQgbWF4KSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50IHJhbmRvbU51bWJlcikgewogICAgICAgIHJldHVybiAodWludChrZWNjYWsyNTYoYmxvY2suYmxvY2toYXNoKGJsb2NrLm51bWJlciAtIDEpKSkgJSBtYXgpICsgMTsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byBtb2RpZnkgcGFyYW1ldGVycyBiYXNlZCBvbiB0b2tlbnMgYm91Z2h0CiAgICAqIEBwYXJhbSBfdG9rZW5zICAgICAgICB1aW50MjU2ICAgICBUaGUgbnVtYmVyIG9mIHRva2VucyBwdXJjaGFzZWQKICAgICovCiAgICBmdW5jdGlvbiB1cGRhdGVTYWxlUGFyYW1ldGVycyAodWludDI1NiBfdG9rZW5zKSBpbnRlcm5hbCB7CiAgICAgICAgdG9rZW5zUHVyY2hhc2VkID0gdG9rZW5zUHVyY2hhc2VkLmFkZChfdG9rZW5zKTsKICAgIH0KfQ=='.
	

]
