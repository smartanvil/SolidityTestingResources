Class {
	#name : #SRT7f395379174ab6245239c0c4badc6ea7652a9f01,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT7f395379174ab6245239c0c4badc6ea7652a9f01 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovLyBGaWxlOiB6ZXBwZWxpbi1zb2xpZGl0eS9jb250cmFjdHMvbWF0aC9TYWZlTWF0aC5zb2wKCi8qKgogKiBAdGl0bGUgU2FmZU1hdGgKICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCmxpYnJhcnkgU2FmZU1hdGggewogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCi8vIEZpbGU6IHplcHBlbGluLXNvbGlkaXR5L2NvbnRyYWN0cy90b2tlbi9FUkMyMEJhc2ljLnNvbAoKLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5CiAqLwpjb250cmFjdCBFUkMyMEJhc2ljIHsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL3Rva2VuL0Jhc2ljVG9rZW4uc29sCgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogIC8qKgogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCi8vIEZpbGU6IHplcHBlbGluLXNvbGlkaXR5L2NvbnRyYWN0cy90b2tlbi9FUkMyMC5zb2wKCi8qKgogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKi8KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCi8vIEZpbGU6IHplcHBlbGluLXNvbGlkaXR5L2NvbnRyYWN0cy90b2tlbi9TdGFuZGFyZFRva2VuLnNvbAoKLyoqCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbgogKgogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgaW50ZXJuYWwgYWxsb3dlZDsKCgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1tfZnJvbV0pOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0pOwoKICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAqCiAgICogQmV3YXJlIHRoYXQgY2hhbmdpbmcgYW4gYWxsb3dhbmNlIHdpdGggdGhpcyBtZXRob2QgYnJpbmdzIHRoZSByaXNrIHRoYXQgc29tZW9uZSBtYXkgdXNlIGJvdGggdGhlIG9sZAogICAqIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZSB0cmFuc2FjdGlvbiBvcmRlcmluZy4gT25lIHBvc3NpYmxlIHNvbHV0aW9uIHRvIG1pdGlnYXRlIHRoaXMKICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CgogIC8qKgogICAqIEBkZXYgSW5jcmVhc2UgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKgogICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAogICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfYWRkZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBpbmNyZWFzZSB0aGUgYWxsb3dhbmNlIGJ5LgogICAqLwogIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRGVjcmVhc2UgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKgogICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGRlY3JlbWVudAogICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3VidHJhY3RlZFZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGRlY3JlYXNlIHRoZSBhbGxvd2FuY2UgYnkuCiAgICovCiAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9iYXNlL2Nyb3dkc2FsZS9Dcm93ZHNhbGUuc29sCgovKioKICogQHRpdGxlIENyb3dkc2FsZQogKiBAZGV2IENyb3dkc2FsZSBpcyBhIGJhc2UgY29udHJhY3QgZm9yIG1hbmFnaW5nIGEgdG9rZW4gY3Jvd2RzYWxlLgogKiBDcm93ZHNhbGVzIGhhdmUgYSBzdGFydCBhbmQgZW5kIHRpbWVzdGFtcHMsIHdoZXJlIGludmVzdG9ycyBjYW4gbWFrZQogKiB0b2tlbiBwdXJjaGFzZXMgYW5kIHRoZSBjcm93ZHNhbGUgd2lsbCBhc3NpZ24gdGhlbSB0b2tlbnMgYmFzZWQKICogb24gYSB0b2tlbiBwZXIgRVRIIHJhdGUuIEZ1bmRzIGNvbGxlY3RlZCBhcmUgZm9yd2FyZGVkIHRvIGEgd2FsbGV0CiAqIGFzIHRoZXkgYXJyaXZlLgogKi8KY29udHJhY3QgQ3Jvd2RzYWxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgLy8gVGhlIHRva2VuIGJlaW5nIHNvbGQKICBTdGFuZGFyZFRva2VuIHB1YmxpYyB0b2tlbjsKCiAgLy8gc3RhcnQgYW5kIGVuZCB0aW1lc3RhbXBzIHdoZXJlIGludmVzdG1lbnRzIGFyZSBhbGxvd2VkIChib3RoIGluY2x1c2l2ZSkKICB1aW50MjU2IHB1YmxpYyBzdGFydFRpbWU7CiAgdWludDI1NiBwdWJsaWMgZW5kVGltZTsKCiAgLy8gYWRkcmVzcyB3aGVyZSBmdW5kcyBhcmUgY29sbGVjdGVkCiAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0OwoKICAvLyBob3cgbWFueSB0b2tlbiB1bml0cyBhIGJ1eWVyIGdldHMgcGVyIHdlaQogIHVpbnQyNTYgcHVibGljIHJhdGU7CgogIC8vIGFtb3VudCBvZiByYWlzZWQgbW9uZXkgaW4gd2VpCiAgdWludDI1NiBwdWJsaWMgd2VpUmFpc2VkOwoKICAvKioKICAgKiBldmVudCBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAqIEBwYXJhbSBwdXJjaGFzZXIgd2hvIHBhaWQgZm9yIHRoZSB0b2tlbnMKICAgKiBAcGFyYW0gYmVuZWZpY2lhcnkgd2hvIGdvdCB0aGUgdG9rZW5zCiAgICogQHBhcmFtIHZhbHVlIHdlaXMgcGFpZCBmb3IgcHVyY2hhc2UKICAgKiBAcGFyYW0gYW1vdW50IGFtb3VudCBvZiB0b2tlbnMgcHVyY2hhc2VkCiAgICovCiAgZXZlbnQgVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgdmFsdWUsIHVpbnQyNTYgYW1vdW50KTsKCgogIGZ1bmN0aW9uIENyb3dkc2FsZSh1aW50MjU2IF9zdGFydFRpbWUsIHVpbnQyNTYgX2VuZFRpbWUsIHVpbnQyNTYgX3JhdGUsIGFkZHJlc3MgX3dhbGxldCwgU3RhbmRhcmRUb2tlbiBfdG9rZW4pIHB1YmxpYyB7CiAgICByZXF1aXJlKF9zdGFydFRpbWUgPj0gbm93KTsKICAgIHJlcXVpcmUoX2VuZFRpbWUgPj0gX3N0YXJ0VGltZSk7CiAgICByZXF1aXJlKF9yYXRlID4gMCk7CiAgICByZXF1aXJlKF93YWxsZXQgIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF90b2tlbiAhPSBhZGRyZXNzKDApKTsKCiAgICB0b2tlbiA9IF90b2tlbjsKICAgIHN0YXJ0VGltZSA9IF9zdGFydFRpbWU7CiAgICBlbmRUaW1lID0gX2VuZFRpbWU7CiAgICByYXRlID0gX3JhdGU7CiAgICB3YWxsZXQgPSBfd2FsbGV0OwogIH0KCgogIC8vIGZhbGxiYWNrIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIGJ1eSB0b2tlbnMKICBmdW5jdGlvbiAoKSBleHRlcm5hbCBwYXlhYmxlIHsKICAgIGJ1eVRva2Vucyhtc2cuc2VuZGVyKTsKICB9CgogIC8vIGxvdyBsZXZlbCB0b2tlbiBwdXJjaGFzZSBmdW5jdGlvbgogIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgcGF5YWJsZSB7CiAgICByZXF1aXJlKGJlbmVmaWNpYXJ5ICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZSh2YWxpZFB1cmNoYXNlKCkpOwoKICAgIHVpbnQyNTYgd2VpQW1vdW50ID0gbXNnLnZhbHVlOwoKICAgIC8vIGNhbGN1bGF0ZSB0b2tlbiBhbW91bnQgdG8gYmUgY3JlYXRlZAogICAgdWludDI1NiB0b2tlbnMgPSB3ZWlBbW91bnQubXVsKHJhdGUpOwoKICAgIC8vIHVwZGF0ZSBzdGF0ZQogICAgd2VpUmFpc2VkID0gd2VpUmFpc2VkLmFkZCh3ZWlBbW91bnQpOwoKICAgIHRva2VuLnRyYW5zZmVyKGJlbmVmaWNpYXJ5LCB0b2tlbnMpOwogICAgVG9rZW5QdXJjaGFzZShtc2cuc2VuZGVyLCBiZW5lZmljaWFyeSwgd2VpQW1vdW50LCB0b2tlbnMpOwoKICAgIGZvcndhcmRGdW5kcygpOwogIH0KCiAgLy8gc2VuZCBldGhlciB0byB0aGUgZnVuZCBjb2xsZWN0aW9uIHdhbGxldAogIC8vIG92ZXJyaWRlIHRvIGNyZWF0ZSBjdXN0b20gZnVuZCBmb3J3YXJkaW5nIG1lY2hhbmlzbXMKICBmdW5jdGlvbiBmb3J3YXJkRnVuZHMoKSBpbnRlcm5hbCB7CiAgICB3YWxsZXQudHJhbnNmZXIobXNnLnZhbHVlKTsKICB9CgogIC8vIEByZXR1cm4gdHJ1ZSBpZiB0aGUgdHJhbnNhY3Rpb24gY2FuIGJ1eSB0b2tlbnMKICBmdW5jdGlvbiB2YWxpZFB1cmNoYXNlKCkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICBib29sIHdpdGhpblBlcmlvZCA9IG5vdyA+PSBzdGFydFRpbWUgJiYgbm93IDw9IGVuZFRpbWU7CiAgICBib29sIG5vblplcm9QdXJjaGFzZSA9IG1zZy52YWx1ZSAhPSAwOwogICAgcmV0dXJuIHdpdGhpblBlcmlvZCAmJiBub25aZXJvUHVyY2hhc2U7CiAgfQoKICAvLyBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBlbmRlZAogIGZ1bmN0aW9uIGhhc0VuZGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIG5vdyA+IGVuZFRpbWU7CiAgfQoKCn0KCi8vIEZpbGU6IHplcHBlbGluLXNvbGlkaXR5L2NvbnRyYWN0cy9vd25lcnNoaXAvT3duYWJsZS5zb2wKCi8qKgogKiBAdGl0bGUgT3duYWJsZQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuCiAqLwpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCgogIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9iYXNlL2Nyb3dkc2FsZS9GaW5hbGl6YWJsZUNyb3dkc2FsZS5zb2wKCi8qKgogKiBAdGl0bGUgRmluYWxpemFibGVDcm93ZHNhbGUKICogQGRldiBFeHRlbnNpb24gb2YgQ3Jvd2RzYWxlIHdoZXJlIGFuIG93bmVyIGNhbiBkbyBleHRyYSB3b3JrCiAqIGFmdGVyIGZpbmlzaGluZy4KICovCgoKY29udHJhY3QgRmluYWxpemFibGVDcm93ZHNhbGUgaXMgQ3Jvd2RzYWxlLCBPd25hYmxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgYm9vbCBwdWJsaWMgaXNGaW5hbGl6ZWQgPSBmYWxzZTsKCiAgZXZlbnQgRmluYWxpemVkKCk7CgogIC8qKgogICAqIEBkZXYgTXVzdCBiZSBjYWxsZWQgYWZ0ZXIgY3Jvd2RzYWxlIGVuZHMsIHRvIGRvIHNvbWUgZXh0cmEgZmluYWxpemF0aW9uCiAgICogd29yay4gQ2FsbHMgdGhlIGNvbnRyYWN0J3MgZmluYWxpemF0aW9uIGZ1bmN0aW9uLgogICAqLwogIGZ1bmN0aW9uIGZpbmFsaXplKCkgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKCFpc0ZpbmFsaXplZCk7CiAgICByZXF1aXJlKGhhc0VuZGVkKCkpOwoKICAgIGZpbmFsaXphdGlvbigpOwogICAgRmluYWxpemVkKCk7CgogICAgaXNGaW5hbGl6ZWQgPSB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBDYW4gYmUgb3ZlcnJpZGRlbiB0byBhZGQgZmluYWxpemF0aW9uIGxvZ2ljLiBUaGUgb3ZlcnJpZGluZyBmdW5jdGlvbgogICAqIHNob3VsZCBjYWxsIHN1cGVyLmZpbmFsaXphdGlvbigpIHRvIGVuc3VyZSB0aGUgY2hhaW4gb2YgZmluYWxpemF0aW9uIGlzCiAgICogZXhlY3V0ZWQgZW50aXJlbHkuCiAgICovCiAgZnVuY3Rpb24gZmluYWxpemF0aW9uKCkgaW50ZXJuYWwgewogIH0KfQoKLy8gRmlsZTogY29udHJhY3RzL2Jhc2UvY3Jvd2RzYWxlL1JlZnVuZFZhdWx0LnNvbAoKLyoqCiAqIEB0aXRsZSBSZWZ1bmRWYXVsdAogKiBAZGV2IFRoaXMgY29udHJhY3QgaXMgdXNlZCBmb3Igc3RvcmluZyBmdW5kcyB3aGlsZSBhIGNyb3dkc2FsZQogKiBpcyBpbiBwcm9ncmVzcy4gU3VwcG9ydHMgcmVmdW5kaW5nIHRoZSBtb25leSBpZiBjcm93ZHNhbGUgZmFpbHMsCiAqIGFuZCBmb3J3YXJkaW5nIGl0IGlmIGNyb3dkc2FsZSBpcyBzdWNjZXNzZnVsLgogKi8KCgpjb250cmFjdCBSZWZ1bmRWYXVsdCBpcyBPd25hYmxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgZW51bSBTdGF0ZSB7IEFjdGl2ZSwgUmVmdW5kaW5nLCBDbG9zZWQgfQoKICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBkZXBvc2l0ZWQ7CiAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0OwogIFN0YXRlIHB1YmxpYyBzdGF0ZTsKCiAgZXZlbnQgQ2xvc2VkKCk7CiAgZXZlbnQgUmVmdW5kc0VuYWJsZWQoKTsKICBldmVudCBSZWZ1bmRlZChhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgd2VpQW1vdW50KTsKCiAgZnVuY3Rpb24gUmVmdW5kVmF1bHQoYWRkcmVzcyBfd2FsbGV0KSBwdWJsaWMgewogICAgcmVxdWlyZShfd2FsbGV0ICE9IGFkZHJlc3MoMCkpOwogICAgd2FsbGV0ID0gX3dhbGxldDsKICAgIHN0YXRlID0gU3RhdGUuQWN0aXZlOwogIH0KCiAgZnVuY3Rpb24gZGVwb3NpdChhZGRyZXNzIGludmVzdG9yKSBvbmx5T3duZXIgcHVibGljIHBheWFibGUgewogICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5BY3RpdmUpOwogICAgZGVwb3NpdGVkW2ludmVzdG9yXSA9IGRlcG9zaXRlZFtpbnZlc3Rvcl0uYWRkKG1zZy52YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBjbG9zZSgpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5BY3RpdmUpOwogICAgc3RhdGUgPSBTdGF0ZS5DbG9zZWQ7CiAgICBDbG9zZWQoKTsKICAgIHdhbGxldC50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogIH0KCiAgZnVuY3Rpb24gZW5hYmxlUmVmdW5kcygpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5BY3RpdmUpOwogICAgc3RhdGUgPSBTdGF0ZS5SZWZ1bmRpbmc7CiAgICBSZWZ1bmRzRW5hYmxlZCgpOwogIH0KCiAgZnVuY3Rpb24gcmVmdW5kKGFkZHJlc3MgaW52ZXN0b3IpIHB1YmxpYyB7CiAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLlJlZnVuZGluZyk7CiAgICB1aW50MjU2IGRlcG9zaXRlZFZhbHVlID0gZGVwb3NpdGVkW2ludmVzdG9yXTsKICAgIGRlcG9zaXRlZFtpbnZlc3Rvcl0gPSAwOwogICAgaW52ZXN0b3IudHJhbnNmZXIoZGVwb3NpdGVkVmFsdWUpOwogICAgUmVmdW5kZWQoaW52ZXN0b3IsIGRlcG9zaXRlZFZhbHVlKTsKICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9iYXNlL2Nyb3dkc2FsZS9SZWZ1bmRhYmxlQ3Jvd2RzYWxlLnNvbAoKLyoqCiAqIEB0aXRsZSBSZWZ1bmRhYmxlQ3Jvd2RzYWxlCiAqIEBkZXYgRXh0ZW5zaW9uIG9mIENyb3dkc2FsZSBjb250cmFjdCB0aGF0IGFkZHMgYSBmdW5kaW5nIGdvYWwsIGFuZAogKiB0aGUgcG9zc2liaWxpdHkgb2YgdXNlcnMgZ2V0dGluZyBhIHJlZnVuZCBpZiBnb2FsIGlzIG5vdCBtZXQuCiAqIFVzZXMgYSBSZWZ1bmRWYXVsdCBhcyB0aGUgY3Jvd2RzYWxlJ3MgdmF1bHQuCiAqLwoKCmNvbnRyYWN0IFJlZnVuZGFibGVDcm93ZHNhbGUgaXMgRmluYWxpemFibGVDcm93ZHNhbGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAvLyBtaW5pbXVtIGFtb3VudCBvZiBmdW5kcyB0byBiZSByYWlzZWQgaW4gd2VpcwogIHVpbnQyNTYgcHVibGljIGdvYWw7CgogIC8vIHJlZnVuZCB2YXVsdCB1c2VkIHRvIGhvbGQgZnVuZHMgd2hpbGUgY3Jvd2RzYWxlIGlzIHJ1bm5pbmcKICBSZWZ1bmRWYXVsdCBwdWJsaWMgdmF1bHQ7CgogIGZ1bmN0aW9uIFJlZnVuZGFibGVDcm93ZHNhbGUodWludDI1NiBfZ29hbCkgcHVibGljIHsKICAgIHJlcXVpcmUoX2dvYWwgPiAwKTsKICAgIHZhdWx0ID0gbmV3IFJlZnVuZFZhdWx0KHdhbGxldCk7CiAgICBnb2FsID0gX2dvYWw7CiAgfQoKICAvLyBXZSdyZSBvdmVycmlkaW5nIHRoZSBmdW5kIGZvcndhcmRpbmcgZnJvbSBDcm93ZHNhbGUuCiAgLy8gSW4gYWRkaXRpb24gdG8gc2VuZGluZyB0aGUgZnVuZHMsIHdlIHdhbnQgdG8gY2FsbAogIC8vIHRoZSBSZWZ1bmRWYXVsdCBkZXBvc2l0IGZ1bmN0aW9uCiAgZnVuY3Rpb24gZm9yd2FyZEZ1bmRzKCkgaW50ZXJuYWwgewogICAgdmF1bHQuZGVwb3NpdC52YWx1ZShtc2cudmFsdWUpKG1zZy5zZW5kZXIpOwogIH0KCiAgLy8gaWYgY3Jvd2RzYWxlIGlzIHVuc3VjY2Vzc2Z1bCwgaW52ZXN0b3JzIGNhbiBjbGFpbSByZWZ1bmRzIGhlcmUKICBmdW5jdGlvbiBjbGFpbVJlZnVuZCgpIHB1YmxpYyB7CiAgICByZXF1aXJlKGlzRmluYWxpemVkKTsKICAgIHJlcXVpcmUoIWdvYWxSZWFjaGVkKCkpOwoKICAgIHZhdWx0LnJlZnVuZChtc2cuc2VuZGVyKTsKICB9CgogIC8vIHZhdWx0IGZpbmFsaXphdGlvbiB0YXNrLCBjYWxsZWQgd2hlbiBvd25lciBjYWxscyBmaW5hbGl6ZSgpCiAgZnVuY3Rpb24gZmluYWxpemF0aW9uKCkgaW50ZXJuYWwgewogICAgaWYgKGdvYWxSZWFjaGVkKCkpIHsKICAgICAgdmF1bHQuY2xvc2UoKTsKICAgIH0gZWxzZSB7CiAgICAgIHZhdWx0LmVuYWJsZVJlZnVuZHMoKTsKICAgIH0KCiAgICBzdXBlci5maW5hbGl6YXRpb24oKTsKICB9CgogIGZ1bmN0aW9uIGdvYWxSZWFjaGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHdlaVJhaXNlZCA+PSBnb2FsOwogIH0KCn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9iYXNlL3Rva2Vucy9SZWxlYXNhYmxlVG9rZW4uc29sCgovKioKICogVGhpcyBzbWFydCBjb250cmFjdCBjb2RlIGlzIENvcHlyaWdodCAyMDE3IFRva2VuTWFya2V0IEx0ZC4gRm9yIG1vcmUgaW5mb3JtYXRpb24gc2VlIGh0dHBzOi8vdG9rZW5tYXJrZXQubmV0CiAqCiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgdmVyc2lvbiAyLjA6IGh0dHBzOi8vZ2l0aHViLmNvbS9Ub2tlbk1hcmtldE5ldC9pY28vYmxvYi9tYXN0ZXIvTElDRU5TRS50eHQKICovCgpwcmFnbWEgc29saWRpdHkgXjAuNC4xODsKCgoKCgovKioKICogRGVmaW5lIGludGVyZmFjZSBmb3IgcmVsZWFzaW5nIHRoZSB0b2tlbiB0cmFuc2ZlciBhZnRlciBhIHN1Y2Nlc3NmdWwgY3Jvd2RzYWxlLgogKi8KY29udHJhY3QgUmVsZWFzYWJsZVRva2VuIGlzIEVSQzIwLCBPd25hYmxlIHsKCiAgLyogVGhlIGZpbmFsaXplciBjb250cmFjdCB0aGF0IGFsbG93cyB1bmxpZnQgdGhlIHRyYW5zZmVyIGxpbWl0cyBvbiB0aGlzIHRva2VuICovCiAgYWRkcmVzcyBwdWJsaWMgcmVsZWFzZUFnZW50OwoKICAvKiogQSBjcm93ZHNhbGUgY29udHJhY3QgY2FuIHJlbGVhc2UgdXMgdG8gdGhlIHdpbGQgaWYgSUNPIHN1Y2Nlc3MuIElmIGZhbHNlIHdlIGFyZSBhcmUgaW4gdHJhbnNmZXIgbG9jayB1cCBwZXJpb2QuKi8KICBib29sIHB1YmxpYyByZWxlYXNlZCA9IGZhbHNlOwoKICAvKiogTWFwIG9mIGFnZW50cyB0aGF0IGFyZSBhbGxvd2VkIHRvIHRyYW5zZmVyIHRva2VucyByZWdhcmRsZXNzIG9mIHRoZSBsb2NrIGRvd24gcGVyaW9kLiBUaGVzZSBhcmUgY3Jvd2RzYWxlIGNvbnRyYWN0cyBhbmQgcG9zc2libGUgdGhlIHRlYW0gbXVsdGlzaWcgaXRzZWxmLiAqLwogIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIHRyYW5zZmVyQWdlbnRzOwoKICAvKioKICAgKiBMaW1pdCB0b2tlbiB0cmFuc2ZlciB1bnRpbCB0aGUgY3Jvd2RzYWxlIGlzIG92ZXIuCiAgICoKICAgKi8KICBtb2RpZmllciBjYW5UcmFuc2ZlcihhZGRyZXNzIF9zZW5kZXIpIHsKICAgIGlmICghcmVsZWFzZWQpIHsKICAgICAgcmVxdWlyZSh0cmFuc2ZlckFnZW50c1tfc2VuZGVyXSk7CiAgICB9CgogICAgXzsKICB9CgogIC8qKgogICAqIFNldCB0aGUgY29udHJhY3QgdGhhdCBjYW4gY2FsbCByZWxlYXNlIGFuZCBtYWtlIHRoZSB0b2tlbiB0cmFuc2ZlcmFibGUuCiAgICoKICAgKiBEZXNpZ24gY2hvaWNlLiBBbGxvdyByZXNldCB0aGUgcmVsZWFzZSBhZ2VudCB0byBmaXggZmF0IGZpbmdlciBtaXN0YWtlcy4KICAgKi8KICBmdW5jdGlvbiBzZXRSZWxlYXNlQWdlbnQoYWRkcmVzcyBhZGRyKSBvbmx5T3duZXIgaW5SZWxlYXNlU3RhdGUoZmFsc2UpIHB1YmxpYyB7CgogICAgLy8gV2UgZG9uJ3QgZG8gaW50ZXJmYWNlIGNoZWNrIGhlcmUgYXMgd2UgbWlnaHQgd2FudCB0byBhIG5vcm1hbCB3YWxsZXQgYWRkcmVzcyB0byBhY3QgYXMgYSByZWxlYXNlIGFnZW50CiAgICByZWxlYXNlQWdlbnQgPSBhZGRyOwogIH0KCiAgLyoqCiAgICogT3duZXIgY2FuIGFsbG93IGEgcGFydGljdWxhciBhZGRyZXNzIChhIGNyb3dkc2FsZSBjb250cmFjdCkgdG8gdHJhbnNmZXIgdG9rZW5zIGRlc3BpdGUgdGhlIGxvY2sgdXAgcGVyaW9kLgogICAqLwogIGZ1bmN0aW9uIHNldFRyYW5zZmVyQWdlbnQoYWRkcmVzcyBhZGRyLCBib29sIHN0YXRlKSBvbmx5T3duZXIgaW5SZWxlYXNlU3RhdGUoZmFsc2UpIHB1YmxpYyB7CiAgICB0cmFuc2ZlckFnZW50c1thZGRyXSA9IHN0YXRlOwogIH0KCiAgLyoqCiAgICogT25lIHdheSBmdW5jdGlvbiB0byByZWxlYXNlIHRoZSB0b2tlbnMgdG8gdGhlIHdpbGQuCiAgICoKICAgKiBDYW4gYmUgY2FsbGVkIG9ubHkgZnJvbSB0aGUgcmVsZWFzZSBhZ2VudCB0aGF0IGlzIHRoZSBmaW5hbCBJQ08gY29udHJhY3QuIEl0IGlzIG9ubHkgY2FsbGVkIGlmIHRoZSBjcm93ZHNhbGUgaGFzIGJlZW4gc3VjY2VzcyAoZmlyc3QgbWlsZXN0b25lIHJlYWNoZWQpLgogICAqLwogIGZ1bmN0aW9uIHJlbGVhc2VUb2tlblRyYW5zZmVyKCkgcHVibGljIG9ubHlSZWxlYXNlQWdlbnQgewogICAgcmVsZWFzZWQgPSB0cnVlOwogIH0KCiAgLyoqIFRoZSBmdW5jdGlvbiBjYW4gYmUgY2FsbGVkIG9ubHkgYmVmb3JlIG9yIGFmdGVyIHRoZSB0b2tlbnMgaGF2ZSBiZWVuIHJlbGVhc2VkICovCiAgbW9kaWZpZXIgaW5SZWxlYXNlU3RhdGUoYm9vbCByZWxlYXNlU3RhdGUpIHsKICAgIHJlcXVpcmUocmVsZWFzZVN0YXRlID09IHJlbGVhc2VkKTsKICAgIF87CiAgfQoKICAvKiogVGhlIGZ1bmN0aW9uIGNhbiBiZSBjYWxsZWQgb25seSBieSBhIHdoaXRlbGlzdGVkIHJlbGVhc2UgYWdlbnQuICovCiAgbW9kaWZpZXIgb25seVJlbGVhc2VBZ2VudCgpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSByZWxlYXNlQWdlbnQpOwogICAgXzsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcHVibGljIGNhblRyYW5zZmVyKG1zZy5zZW5kZXIpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgLy8gQ2FsbCBTdGFuZGFyZFRva2VuLnRyYW5zZmVyKCkKICAgIHJldHVybiBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBwdWJsaWMgY2FuVHJhbnNmZXIoX2Zyb20pIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgLy8gQ2FsbCBTdGFuZGFyZFRva2VuLnRyYW5zZmVyRm9ybSgpCiAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgfQoKfQoKLy8gRmlsZTogY29udHJhY3RzL0JSRlRva2VuL0JSRlRva2VuLnNvbAoKY29udHJhY3QgQlJGVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgUmVsZWFzYWJsZVRva2VuIHsKICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiQlJGIFRva2VuIjsKICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJCUkYiOwogIHVpbnQ4IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwoKICBmdW5jdGlvbiBCUkZUb2tlbigpIHB1YmxpYyB7CiAgICB0b3RhbFN1cHBseSA9IDEwMDAwMDAwMDAgKiAoMTAgKiogdWludDI1NihkZWNpbWFscykpOwogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSB0b3RhbFN1cHBseTsKICAgIHNldFJlbGVhc2VBZ2VudChtc2cuc2VuZGVyKTsKICAgIHNldFRyYW5zZmVyQWdlbnQobXNnLnNlbmRlciwgdHJ1ZSk7CiAgfQp9CgovLyBGaWxlOiBjb250cmFjdHMvQlJGVG9rZW4vQlJGQ3Jvd2RzYWxlLnNvbAoKY29udHJhY3QgQlJGQ3Jvd2RzYWxlIGlzIFJlZnVuZGFibGVDcm93ZHNhbGUgewoKICB1aW50MjU2WzNdIHB1YmxpYyBpY29TdGFydFRpbWVzOwogIHVpbnQyNTZbM10gcHVibGljIGljb0VuZFRpbWVzOwogIHVpbnQyNTZbM10gcHVibGljIGljb1JhdGVzOwogIHVpbnQyNTZbM10gcHVibGljIGljb0NhcHM7CiAgdWludDI1NiBwdWJsaWMgbWFuYWdlbWVudFRva2VuQWxsb2NhdGlvbjsKICBhZGRyZXNzIHB1YmxpYyBtYW5hZ2VtZW50V2FsbGV0QWRkcmVzczsKICB1aW50MjU2IHB1YmxpYyBib3VudHlUb2tlbkFsbG9jYXRpb247CiAgYWRkcmVzcyBwdWJsaWMgYm91bnR5TWFuYWdlbWVudFdhbGxldEFkZHJlc3M7CiAgYm9vbCBwdWJsaWMgY29udHJhY3RJbml0aWFsaXplZCA9IGZhbHNlOwogIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IE1JTklNVU1fUFVSQ0hBU0UgPSAxMDA7CiAgbWFwcGluZyh1aW50MjU2ID0+IHVpbnQyNTYpIHB1YmxpYyB0b3RhbFRva2Vuc0J5U3RhZ2U7CiAgYm9vbCBwdWJsaWMgcmVmdW5kaW5nQ29tcGxldGUgPSBmYWxzZTsKICB1aW50MjU2IHB1YmxpYyByZWZ1bmRpbmdJbmRleCA9IDA7CiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBkaXJlY3RJbnZlc3RvcnM7CiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBpbmRpcmVjdEludmVzdG9yczsKICBhZGRyZXNzW10gcHJpdmF0ZSBkaXJlY3RJbnZlc3RvcnNDb2xsZWN0aW9uOwoKICBldmVudCBUb2tlbkFsbG9jYXRlZChhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgdG9rZW5zQWxsb2NhdGVkLCB1aW50MjU2IGFtb3VudCk7CgogIGZ1bmN0aW9uIEJSRkNyb3dkc2FsZSgKICAgIHVpbnQyNTZbM10gX2ljb1N0YXJ0VGltZXMsCiAgICB1aW50MjU2WzNdIF9pY29FbmRUaW1lcywKICAgIHVpbnQyNTZbM10gX2ljb1JhdGVzLAogICAgdWludDI1NlszXSBfaWNvQ2FwcywKICAgIGFkZHJlc3MgX3dhbGxldCwKICAgIHVpbnQyNTYgX2dvYWwsCiAgICB1aW50MjU2IF9tYW5hZ2VtZW50VG9rZW5BbGxvY2F0aW9uLAogICAgYWRkcmVzcyBfbWFuYWdlbWVudFdhbGxldEFkZHJlc3MsCiAgICB1aW50MjU2IF9ib3VudHlUb2tlbkFsbG9jYXRpb24sCiAgICBhZGRyZXNzIF9ib3VudHlNYW5hZ2VtZW50V2FsbGV0QWRkcmVzcwogICAgKSBwdWJsaWMKICAgIENyb3dkc2FsZShfaWNvU3RhcnRUaW1lc1swXSwgX2ljb0VuZFRpbWVzWzJdLCBfaWNvUmF0ZXNbMF0sIF93YWxsZXQsIG5ldyBCUkZUb2tlbigpKQogICAgUmVmdW5kYWJsZUNyb3dkc2FsZShfZ29hbCkKICB7CiAgICByZXF1aXJlKChfaWNvQ2Fwc1swXSA+IDApICYmIChfaWNvQ2Fwc1sxXSA+IDApICYmIChfaWNvQ2Fwc1syXSA+IDApKTsKICAgIHJlcXVpcmUoKF9pY29SYXRlc1swXSA+IDApICYmIChfaWNvUmF0ZXNbMV0gPiAwKSAmJiAoX2ljb1JhdGVzWzJdID4gMCkpOwogICAgcmVxdWlyZSgoX2ljb0VuZFRpbWVzWzBdID4gX2ljb1N0YXJ0VGltZXNbMF0pICYmIChfaWNvRW5kVGltZXNbMV0gPiBfaWNvU3RhcnRUaW1lc1sxXSkgJiYgKF9pY29FbmRUaW1lc1syXSA+IF9pY29TdGFydFRpbWVzWzJdKSk7CiAgICByZXF1aXJlKChfaWNvU3RhcnRUaW1lc1sxXSA+PSBfaWNvRW5kVGltZXNbMF0pICYmIChfaWNvU3RhcnRUaW1lc1syXSA+PSBfaWNvRW5kVGltZXNbMV0pKTsKICAgIHJlcXVpcmUoX21hbmFnZW1lbnRXYWxsZXRBZGRyZXNzICE9IG93bmVyICYmIF93YWxsZXQgIT0gX21hbmFnZW1lbnRXYWxsZXRBZGRyZXNzKTsKICAgIHJlcXVpcmUoX2JvdW50eU1hbmFnZW1lbnRXYWxsZXRBZGRyZXNzICE9IG93bmVyICYmIF93YWxsZXQgIT0gX2JvdW50eU1hbmFnZW1lbnRXYWxsZXRBZGRyZXNzKTsKICAgIGljb1N0YXJ0VGltZXMgPSBfaWNvU3RhcnRUaW1lczsKICAgIGljb0VuZFRpbWVzID0gX2ljb0VuZFRpbWVzOwogICAgaWNvUmF0ZXMgPSBfaWNvUmF0ZXM7CiAgICBpY29DYXBzID0gX2ljb0NhcHM7CiAgICBtYW5hZ2VtZW50VG9rZW5BbGxvY2F0aW9uID0gX21hbmFnZW1lbnRUb2tlbkFsbG9jYXRpb247CiAgICBtYW5hZ2VtZW50V2FsbGV0QWRkcmVzcyA9IF9tYW5hZ2VtZW50V2FsbGV0QWRkcmVzczsKICAgIGJvdW50eVRva2VuQWxsb2NhdGlvbiA9IF9ib3VudHlUb2tlbkFsbG9jYXRpb247CiAgICBib3VudHlNYW5hZ2VtZW50V2FsbGV0QWRkcmVzcyA9IF9ib3VudHlNYW5hZ2VtZW50V2FsbGV0QWRkcmVzczsKICB9CgogIC8vIGZhbGxiYWNrIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIGJ1eSB0b2tlbnMKICBmdW5jdGlvbiAoKSBleHRlcm5hbCBwYXlhYmxlIHsKICAgIHJlcXVpcmUoY29udHJhY3RJbml0aWFsaXplZCk7CiAgICBidXlUb2tlbnMobXNnLnNlbmRlcik7CiAgfQoKICBmdW5jdGlvbiBpbml0aWFsaXplQ29udHJhY3QoKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUoIWNvbnRyYWN0SW5pdGlhbGl6ZWQpOwogICAgYWxsb2NhdGVUb2tlbnMobWFuYWdlbWVudFdhbGxldEFkZHJlc3MsIG1hbmFnZW1lbnRUb2tlbkFsbG9jYXRpb24sIDAsIDApOwogICAgYWxsb2NhdGVUb2tlbnMoYm91bnR5TWFuYWdlbWVudFdhbGxldEFkZHJlc3MsIGJvdW50eVRva2VuQWxsb2NhdGlvbiwgMCwgMCk7CiAgICBCUkZUb2tlbiBicmZUb2tlbiA9IEJSRlRva2VuKHRva2VuKTsKICAgIGJyZlRva2VuLnNldFRyYW5zZmVyQWdlbnQobWFuYWdlbWVudFdhbGxldEFkZHJlc3MsIHRydWUpOwogICAgYnJmVG9rZW4uc2V0VHJhbnNmZXJBZ2VudChib3VudHlNYW5hZ2VtZW50V2FsbGV0QWRkcmVzcywgdHJ1ZSk7CiAgICBjb250cmFjdEluaXRpYWxpemVkID0gdHJ1ZTsKICB9CgogIC8vIEZvciBBbGxvY2F0aW5nIFByZVNvbGQgYW5kIFJlc2VydmVkIFRva2VucwogIGZ1bmN0aW9uIGFsbG9jYXRlVG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQyNTYgdG9rZW5zVG9BbGxvY2F0ZSwgdWludDI1NiBzdGFnZSwgdWludDI1NiB3ZWlQcmljZSkgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKHN0YWdlIDw9IDUpOwogICAgdWludDI1NiB0b2tlbnNXaXRoRGVjaW1hbHMgPSB0b0JSRldFSSh0b2tlbnNUb0FsbG9jYXRlKTsKICAgIHVpbnQyNTYgd2VpQW1vdW50ID0gd2VpUHJpY2UgKiB0b2tlbnNXaXRoRGVjaW1hbHM7CiAgICB3ZWlSYWlzZWQgPSB3ZWlSYWlzZWQuYWRkKHdlaUFtb3VudCk7CiAgICBpZiAod2VpQW1vdW50ID4gMCkgewogICAgICB0b3RhbFRva2Vuc0J5U3RhZ2Vbc3RhZ2VdID0gdG90YWxUb2tlbnNCeVN0YWdlW3N0YWdlXS5hZGQodG9rZW5zV2l0aERlY2ltYWxzKTsKICAgICAgaW5kaXJlY3RJbnZlc3RvcnNbYmVuZWZpY2lhcnldID0gaW5kaXJlY3RJbnZlc3RvcnNbYmVuZWZpY2lhcnldLmFkZCh0b2tlbnNXaXRoRGVjaW1hbHMpOwogICAgfQogICAgdG9rZW4udHJhbnNmZXIoYmVuZWZpY2lhcnksIHRva2Vuc1dpdGhEZWNpbWFscyk7CiAgICBUb2tlbkFsbG9jYXRlZChiZW5lZmljaWFyeSwgdG9rZW5zV2l0aERlY2ltYWxzLCB3ZWlBbW91bnQpOwogIH0KCiAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnkpIHB1YmxpYyBwYXlhYmxlIHsKICAgIHJlcXVpcmUoY29udHJhY3RJbml0aWFsaXplZCk7CiAgICAvLyB1cGRhdGUgdG9rZW4gcmF0ZQogICAgdWludDI1NiBjdXJyVGltZSA9IG5vdzsKICAgIHVpbnQyNTYgc3RhZ2VDYXAgPSB0b0JSRldFSShnZXRTdGFnZUNhcChjdXJyVGltZSkpOwogICAgcmF0ZSA9IGdldFRva2VuUmF0ZShjdXJyVGltZSk7CiAgICB1aW50MjU2IHN0YWdlID0gZ2V0U3RhZ2UoY3VyclRpbWUpOwogICAgdWludDI1NiB3ZWlBbW91bnQgPSBtc2cudmFsdWU7CiAgICB1aW50MjU2IHRva2VuVG9HZXQgPSB3ZWlBbW91bnQubXVsKHJhdGUpOwogICAgaWYgKHRvdGFsVG9rZW5zQnlTdGFnZVtzdGFnZV0uYWRkKHRva2VuVG9HZXQpID4gc3RhZ2VDYXApIHsKICAgICAgc3RhZ2UgPSBzdGFnZSArIDE7CiAgICAgIHJhdGUgPSBnZXRSYXRlQnlTdGFnZShzdGFnZSk7CiAgICAgIHRva2VuVG9HZXQgPSB3ZWlBbW91bnQubXVsKHJhdGUpOwogICAgfQoKICAgIHJlcXVpcmUoKHRva2VuVG9HZXQgPj0gTUlOSU1VTV9QVVJDSEFTRSkpOwoKICAgIGlmIChkaXJlY3RJbnZlc3RvcnNbYmVuZWZpY2lhcnldID09IDApIHsKICAgICAgZGlyZWN0SW52ZXN0b3JzQ29sbGVjdGlvbi5wdXNoKGJlbmVmaWNpYXJ5KTsKICAgIH0KICAgIGRpcmVjdEludmVzdG9yc1tiZW5lZmljaWFyeV0gPSBkaXJlY3RJbnZlc3RvcnNbYmVuZWZpY2lhcnldLmFkZCh0b2tlblRvR2V0KTsKICAgIHRvdGFsVG9rZW5zQnlTdGFnZVtzdGFnZV0gPSB0b3RhbFRva2Vuc0J5U3RhZ2Vbc3RhZ2VdLmFkZCh0b2tlblRvR2V0KTsKICAgIHN1cGVyLmJ1eVRva2VucyhiZW5lZmljaWFyeSk7CiAgfQoKICBmdW5jdGlvbiByZWZ1bmRJbnZlc3RvcnMoKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUoaXNGaW5hbGl6ZWQpOwogICAgcmVxdWlyZSghZ29hbFJlYWNoZWQoKSk7CiAgICByZXF1aXJlKCFyZWZ1bmRpbmdDb21wbGV0ZSk7CiAgICBmb3IgKHVpbnQyNTYgaSA9IDA7IGkgPCAyMDsgaSsrKSB7CiAgICAgIGlmIChyZWZ1bmRpbmdJbmRleCA+PSBkaXJlY3RJbnZlc3RvcnNDb2xsZWN0aW9uLmxlbmd0aCkgewogICAgICAgIHJlZnVuZGluZ0NvbXBsZXRlID0gdHJ1ZTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgICB2YXVsdC5yZWZ1bmQoZGlyZWN0SW52ZXN0b3JzQ29sbGVjdGlvbltyZWZ1bmRpbmdJbmRleF0pOwogICAgICByZWZ1bmRpbmdJbmRleCA9IHJlZnVuZGluZ0luZGV4LmFkZCgxKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGFkdmFuY2VFbmRUaW1lKHVpbnQyNTYgbmV3RW5kVGltZSkgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKCFpc0ZpbmFsaXplZCk7CiAgICByZXF1aXJlKG5ld0VuZFRpbWUgPiBlbmRUaW1lKTsKICAgIGVuZFRpbWUgPSBuZXdFbmRUaW1lOwogIH0KCiAgZnVuY3Rpb24gZ2V0VG9rZW5SYXRlKHVpbnQyNTYgY3VyclRpbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBnZXRSYXRlQnlTdGFnZShnZXRTdGFnZShjdXJyVGltZSkpOwogIH0KCiAgZnVuY3Rpb24gZ2V0U3RhZ2VDYXAodWludDI1NiBjdXJyVGltZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGdldENhcEJ5U3RhZ2UoZ2V0U3RhZ2UoY3VyclRpbWUpKTsKICB9CgogIGZ1bmN0aW9uIGdldFN0YWdlKHVpbnQyNTYgY3VyclRpbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChjdXJyVGltZSA8IGljb0VuZFRpbWVzWzBdKSB7CiAgICAgIHJldHVybiAwOwogICAgfSBlbHNlIGlmICgoY3VyclRpbWUgPiBpY29FbmRUaW1lc1swXSkgJiYgKGN1cnJUaW1lIDw9IGljb0VuZFRpbWVzWzFdKSkgewogICAgICByZXR1cm4gMTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiAyOwogICAgfQogIH0KCiAgZnVuY3Rpb24gZ2V0Q2FwQnlTdGFnZSh1aW50MjU2IHN0YWdlKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gaWNvQ2Fwc1tzdGFnZV07CiAgfQoKICBmdW5jdGlvbiBnZXRSYXRlQnlTdGFnZSh1aW50MjU2IHN0YWdlKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gaWNvUmF0ZXNbc3RhZ2VdOwogIH0KCiAgZnVuY3Rpb24gYWxsb2NhdGVVbnNvbGQoKSBpbnRlcm5hbCB7CiAgICByZXF1aXJlKGhhc0VuZGVkKCkpOwogICAgQlJGVG9rZW4gYnJmVG9rZW4gPSBCUkZUb2tlbih0b2tlbik7CiAgICB0b2tlbi50cmFuc2Zlcihvd25lciwgYnJmVG9rZW4uYmFsYW5jZU9mKGFkZHJlc3ModGhpcykpKTsKICB9CgogIGZ1bmN0aW9uIHRvQlJGV0VJKHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgQlJGVG9rZW4gYnJmVG9rZW4gPSBCUkZUb2tlbih0b2tlbik7CiAgICByZXR1cm4gKHZhbHVlICogKDEwICoqIHVpbnQyNTYoYnJmVG9rZW4uZGVjaW1hbHMoKSkpKTsKICB9CgogIGZ1bmN0aW9uIGZpbmFsaXphdGlvbigpIGludGVybmFsIHsKICAgIHN1cGVyLmZpbmFsaXphdGlvbigpOwogICAgaWYgKGdvYWxSZWFjaGVkKCkpIHsKICAgICAgYWxsb2NhdGVVbnNvbGQoKTsKICAgICAgQlJGVG9rZW4gYnJmVG9rZW4gPSBCUkZUb2tlbih0b2tlbik7CiAgICAgIGJyZlRva2VuLnJlbGVhc2VUb2tlblRyYW5zZmVyKCk7CiAgICAgIGJyZlRva2VuLnRyYW5zZmVyT3duZXJzaGlwKG93bmVyKTsKICAgIH0KICB9Cgp9'.
	

]
