Class {
	#name : #SRTf8ef303406cbcbfc82af008d45210c835ad2f736,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTf8ef303406cbcbfc82af008d45210c835ad2f736 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7IC8vCgovLyBFdGhlclZpbGxhaW5zLmNvCgoKY29udHJhY3QgRVJDNzIxIHsKICAvLyBSZXF1aXJlZCBtZXRob2RzCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljOwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKICBmdW5jdGlvbiBpbXBsZW1lbnRzRVJDNzIxKCkgcHVibGljIHB1cmUgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzIGFkZHIpOwogIGZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JZCkgcHVibGljOwogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiB0b3RhbCk7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWM7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYzsKCiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB0b2tlbklkKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBhcHByb3ZlZCwgdWludDI1NiB0b2tlbklkKTsKCiAgLy8gT3B0aW9uYWwKICAvLyBmdW5jdGlvbiBuYW1lKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nIG5hbWUpOwogIC8vIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZyBzeW1ib2wpOwogIC8vIGZ1bmN0aW9uIHRva2VuT2ZPd25lckJ5SW5kZXgoYWRkcmVzcyBfb3duZXIsIHVpbnQyNTYgX2luZGV4KSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYgdG9rZW5JZCk7CiAgLy8gZnVuY3Rpb24gdG9rZW5NZXRhZGF0YSh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcgaW5mb1VybCk7Cn0KCmNvbnRyYWN0IEV0aGVyVmlsbGFpbnMgaXMgRVJDNzIxIHsKCiAgLyoqKiBFVkVOVFMgKioqLwoKICAvLy8gQGRldiBUaGUgQmlydGggZXZlbnQgaXMgZmlyZWQgd2hlbmV2ZXIgYSBuZXcgdmlsbGFpbiBjb21lcyBpbnRvIGV4aXN0ZW5jZS4KICBldmVudCBCaXJ0aCh1aW50MjU2IHRva2VuSWQsIHN0cmluZyBuYW1lLCBhZGRyZXNzIG93bmVyKTsKCiAgLy8vIEBkZXYgVGhlIFRva2VuU29sZCBldmVudCBpcyBmaXJlZCB3aGVuZXZlciBhIHRva2VuIGlzIHNvbGQuCiAgZXZlbnQgVG9rZW5Tb2xkKHVpbnQyNTYgdG9rZW5JZCwgdWludDI1NiBvbGRQcmljZSwgdWludDI1NiBuZXdQcmljZSwgYWRkcmVzcyBwcmV2T3duZXIsIGFkZHJlc3Mgd2lubmVyLCBzdHJpbmcgbmFtZSk7CgogIC8vLyBAZGV2IFRyYW5zZmVyIGV2ZW50IGFzIGRlZmluZWQgaW4gY3VycmVudCBkcmFmdCBvZiBFUkM3MjEuCiAgLy8vICBvd25lcnNoaXAgaXMgYXNzaWduZWQsIGluY2x1ZGluZyBiaXJ0aHMuCiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHRva2VuSWQpOwoKICAvKioqIENPTlNUQU5UUyAqKiovCgogIC8vLyBAbm90aWNlIE5hbWUgYW5kIHN5bWJvbCBvZiB0aGUgbm9uIGZ1bmdpYmxlIHRva2VuLCBhcyBkZWZpbmVkIGluIEVSQzcyMS4KICBzdHJpbmcgcHVibGljIGNvbnN0YW50IE5BTUUgPSAiRXRoZXJWaWxsYWlucyI7IC8vCiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBTWU1CT0wgPSAiRVZJTCI7IC8vCgogIHVpbnQyNTYgcHVibGljIHByZWNpc2lvbiA9IDEwMDAwMDAwMDAwMDA7IC8vMC4wMDAwMDEgRXRoCgogIHVpbnQyNTYgcHJpdmF0ZSB6YXBQcmljZSA9ICAwLjAwMSBldGhlcjsKICB1aW50MjU2IHByaXZhdGUgcGluY2hQcmljZSA9ICAwLjAwMiBldGhlcjsKICB1aW50MjU2IHByaXZhdGUgZ3VhcmRQcmljZSA9ICAwLjAwMiBldGhlcjsKCiAgdWludDI1NiBwcml2YXRlIHBpbmNoUGVyY2VudGFnZVJldHVybiA9IDIwOyAvLyBob3cgbXVjaCBhIGZsaXAgaXMgd29ydGggd2hlbiBhIHZpbGxhaW4gaXMgZmxpcHBlZC4KCiAgdWludDI1NiBwcml2YXRlIGRlZmF1bHRTdGFydGluZ1ByaWNlID0gMC4wMDEgZXRoZXI7CiAgdWludDI1NiBwcml2YXRlIGZpcnN0U3RlcExpbWl0ID0gIDAuMDUgZXRoZXI7CiAgdWludDI1NiBwcml2YXRlIHNlY29uZFN0ZXBMaW1pdCA9IDAuNSBldGhlcjsKCiAgLyoqKiBTVE9SQUdFICoqKi8KCiAgLy8vIEBkZXYgQSBtYXBwaW5nIGZyb20gdmlsbGFpbiBJRHMgdG8gdGhlIGFkZHJlc3MgdGhhdCBvd25zIHRoZW0uIEFsbCB2aWxsaWFucyBoYXZlCiAgLy8vICBzb21lIHZhbGlkIG93bmVyIGFkZHJlc3MuCiAgbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSBwdWJsaWMgdmlsbGFpbkluZGV4VG9Pd25lcjsKCiAgLy8gQGRldiBBIG1hcHBpbmcgZnJvbSBvd25lciBhZGRyZXNzIHRvIGNvdW50IG9mIHRva2VucyB0aGF0IGFkZHJlc3Mgb3ducy4KICAvLyAgVXNlZCBpbnRlcm5hbGx5IGluc2lkZSBiYWxhbmNlT2YoKSB0byByZXNvbHZlIG93bmVyc2hpcCBjb3VudC4KICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHByaXZhdGUgb3duZXJzaGlwVG9rZW5Db3VudDsKCiAgLy8vIEBkZXYgQSBtYXBwaW5nIGZyb20gVmlsbGFpbnMgdG8gYW4gYWRkcmVzcyB0aGF0IGhhcyBiZWVuIGFwcHJvdmVkIHRvIGNhbGwKICAvLy8gIHRyYW5zZmVyRnJvbSgpLiBFYWNoIFZpbGxhaW4gY2FuIG9ubHkgaGF2ZSBvbmUgYXBwcm92ZWQgYWRkcmVzcyBmb3IgdHJhbnNmZXIKICAvLy8gIGF0IGFueSB0aW1lLiBBIHplcm8gdmFsdWUgbWVhbnMgbm8gYXBwcm92YWwgaXMgb3V0c3RhbmRpbmcuCiAgbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSBwdWJsaWMgdmlsbGFpbkluZGV4VG9BcHByb3ZlZDsKCiAgLy8gQGRldiBBIG1hcHBpbmcgZnJvbSBWaWxsYWlucyB0byB0aGUgcHJpY2Ugb2YgdGhlIHRva2VuLgogIG1hcHBpbmcgKHVpbnQyNTYgPT4gdWludDI1NikgcHJpdmF0ZSB2aWxsYWluSW5kZXhUb1ByaWNlOwoKICAvLyBUaGUgYWRkcmVzc2VzIG9mIHRoZSBhY2NvdW50cyAob3IgY29udHJhY3RzKSB0aGF0IGNhbiBleGVjdXRlIGFjdGlvbnMgd2l0aGluIGVhY2ggcm9sZXMuCiAgYWRkcmVzcyBwdWJsaWMgY2VvQWRkcmVzczsKICBhZGRyZXNzIHB1YmxpYyBjb29BZGRyZXNzOwoKCiAgLyoqKiBEQVRBVFlQRVMgKioqLwogIHN0cnVjdCBWaWxsYWluIHsKICAgIHVpbnQyNTYgaWQ7IC8vIG5lZWRlZCBmb3IgZ25hcmx5IGZyb250IGVuZAogICAgc3RyaW5nIG5hbWU7CiAgICB1aW50MjU2IGNsYXNzOyAvLyAwID0gWmFwcGVyICwgMSA9IFBpbmNoZXIgLCAyID0gR3VhcmQKICAgIHVpbnQyNTYgbGV2ZWw7IC8vIDAgZm9yIFphcHBlciwgMSAtIDUgZm9yIFBpbmNoZXIsIEd1YXJkIC0gcmVwcmVzZW50aW5nIHRoZSBtYXggYWN0aXZlIHBpbmNoZXMgb3IgZ3VhcmRzCiAgICB1aW50MjU2IG51bVNraWxsQWN0aXZlOyAvLyB0aGUgY3VycmVudCBudW1iZXIgb2YgYWN0aXZlIHNraWxsIGltcGxlbWVudGF0aW9ucyAocGluY2hlcyBvciBndWFyZHMpCiAgICB1aW50MjU2IHN0YXRlOyAvLyAwID0gbm9ybWFsICwgMSA9IHphcHBlZCAsIDIgPSBwaW5jaGVkICwgMyA9IGd1YXJkZWQKICAgIHVpbnQyNTYgemFwcGVkRXhpcHJ5VGltZTsgLy8gaWYgdGhpcyB2aWxsYWluIHdhcyBkaXNhcm1lZCwgd2hlbiBkb2VzIGl0IGV4cGlyZQogICAgdWludDI1NiBhZmZlY3RlZEJ5VG9rZW47IC8vIHRva2VuIHRoYXQgaGFzIGFmZmVjdGVkIHRoaXMgdG9rZW4gKHphcHBlZCwgcGluY2hlZCwgZ3VhcmRlZCkKICAgIHVpbnQyNTYgYnV5UHJpY2U7IC8vIHRoZSBwcmljZSBhdCB3aGljaCB0aGlzIHZpbGxhaW4gd2FzIHB1cmNoYXNlZAogIH0KCiAgVmlsbGFpbltdIHByaXZhdGUgdmlsbGFpbnM7CgogIC8qKiogQUNDRVNTIE1PRElGSUVSUyAqKiovCiAgLy8vIEBkZXYgQWNjZXNzIG1vZGlmaWVyIGZvciBDRU8tb25seSBmdW5jdGlvbmFsaXR5CiAgbW9kaWZpZXIgb25seUNFTygpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjZW9BZGRyZXNzKTsKICAgIF87CiAgfQoKICAvLy8gQGRldiBBY2Nlc3MgbW9kaWZpZXIgZm9yIENPTy1vbmx5IGZ1bmN0aW9uYWxpdHkKICBtb2RpZmllciBvbmx5Q09PKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNvb0FkZHJlc3MpOwogICAgXzsKICB9CgogIC8vLyBBY2Nlc3MgbW9kaWZpZXIgZm9yIGNvbnRyYWN0IG93bmVyIG9ubHkgZnVuY3Rpb25hbGl0eQogIG1vZGlmaWVyIG9ubHlDTGV2ZWwoKSB7CiAgICByZXF1aXJlKAogICAgICBtc2cuc2VuZGVyID09IGNlb0FkZHJlc3MgfHwKICAgICAgbXNnLnNlbmRlciA9PSBjb29BZGRyZXNzCiAgICApOwogICAgXzsKICB9CgogIC8qKiogQ09OU1RSVUNUT1IgKioqLwogIGZ1bmN0aW9uIEV0aGVyVmlsbGFpbnMoKSBwdWJsaWMgewogICAgY2VvQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICBjb29BZGRyZXNzID0gbXNnLnNlbmRlcjsKICB9CgogIC8qKiogUFVCTElDIEZVTkNUSU9OUyAqKiovCiAgLy8vIEBub3RpY2UgR3JhbnQgYW5vdGhlciBhZGRyZXNzIHRoZSByaWdodCB0byB0cmFuc2ZlciB0b2tlbiB2aWEgdGFrZU93bmVyc2hpcCgpIGFuZCB0cmFuc2ZlckZyb20oKS4KICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byBiZSBncmFudGVkIHRyYW5zZmVyIGFwcHJvdmFsLiBQYXNzIGFkZHJlc3MoMCkgdG8KICAvLy8gIGNsZWFyIGFsbCBhcHByb3ZhbHMuCiAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgSUQgb2YgdGhlIFRva2VuIHRoYXQgY2FuIGJlIHRyYW5zZmVycmVkIGlmIHRoaXMgY2FsbCBzdWNjZWVkcy4KICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIGFwcHJvdmUoCiAgICBhZGRyZXNzIF90bywKICAgIHVpbnQyNTYgX3Rva2VuSWQKICApIHB1YmxpYyB7CiAgICAvLyBDYWxsZXIgbXVzdCBvd24gdG9rZW4uCiAgICByZXF1aXJlKF9vd25zKG1zZy5zZW5kZXIsIF90b2tlbklkKSk7CgogICAgdmlsbGFpbkluZGV4VG9BcHByb3ZlZFtfdG9rZW5JZF0gPSBfdG87CgogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3RvLCBfdG9rZW5JZCk7CiAgfQoKICAvLy8gRm9yIHF1ZXJ5aW5nIGJhbGFuY2Ugb2YgYSBwYXJ0aWN1bGFyIGFjY291bnQKICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBmb3IgYmFsYW5jZSBxdWVyeQogIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBvd25lcnNoaXBUb2tlbkNvdW50W19vd25lcl07CiAgfQoKICAvLy8gQGRldiBDcmVhdGVzIGEgbmV3IFZpbGxhaW4gd2l0aCB0aGUgZ2l2ZW4gbmFtZS4KICBmdW5jdGlvbiBjcmVhdGVWaWxsYWluKHN0cmluZyBfbmFtZSwgdWludDI1NiBfc3RhcnRQcmljZSwgdWludDI1NiBfY2xhc3MsIHVpbnQyNTYgX2xldmVsKSBwdWJsaWMgb25seUNMZXZlbCB7CiAgICBfY3JlYXRlVmlsbGFpbihfbmFtZSwgYWRkcmVzcyh0aGlzKSwgX3N0YXJ0UHJpY2UsX2NsYXNzLF9sZXZlbCk7CiAgfQoKICAvLy8gQG5vdGljZSBSZXR1cm5zIGFsbCB0aGUgcmVsZXZhbnQgaW5mb3JtYXRpb24gYWJvdXQgYSBzcGVjaWZpYyB2aWxsYWluLgogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIHRva2VuSWQgb2YgdGhlIHZpbGxhaW4gb2YgaW50ZXJlc3QuCiAgZnVuY3Rpb24gZ2V0VmlsbGFpbih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zICgKICAgIHVpbnQyNTYgaWQsCiAgICBzdHJpbmcgdmlsbGFpbk5hbWUsCiAgICB1aW50MjU2IHNlbGxpbmdQcmljZSwKICAgIGFkZHJlc3Mgb3duZXIsCiAgICB1aW50MjU2IGNsYXNzLAogICAgdWludDI1NiBsZXZlbCwKICAgIHVpbnQyNTYgbnVtU2tpbGxBY3RpdmUsCiAgICB1aW50MjU2IHN0YXRlLAogICAgdWludDI1NiB6YXBwZWRFeGlwcnlUaW1lLAogICAgdWludDI1NiBidXlQcmljZSwKICAgIHVpbnQyNTYgbmV4dFByaWNlLAogICAgdWludDI1NiBhZmZlY3RlZEJ5VG9rZW4KICApIHsKICAgIGlkID0gX3Rva2VuSWQ7CiAgICBWaWxsYWluIHN0b3JhZ2UgdmlsbGFpbiA9IHZpbGxhaW5zW190b2tlbklkXTsKICAgIHZpbGxhaW5OYW1lID0gdmlsbGFpbi5uYW1lOwogICAgc2VsbGluZ1ByaWNlID12aWxsYWluSW5kZXhUb1ByaWNlW190b2tlbklkXTsKICAgIG93bmVyID0gdmlsbGFpbkluZGV4VG9Pd25lcltfdG9rZW5JZF07CiAgICBjbGFzcyA9IHZpbGxhaW4uY2xhc3M7CiAgICBsZXZlbCA9IHZpbGxhaW4ubGV2ZWw7CiAgICBudW1Ta2lsbEFjdGl2ZSA9IHZpbGxhaW4ubnVtU2tpbGxBY3RpdmU7CiAgICBzdGF0ZSA9IHZpbGxhaW4uc3RhdGU7CiAgICBpZiAodmlsbGFpbi5zdGF0ZT09MSAmJiBub3c+dmlsbGFpbi56YXBwZWRFeGlwcnlUaW1lKXsKICAgICAgICBzdGF0ZT0wOyAvLyB0aW1lIGV4cGlyZWQgc28gc2F5IHRoZXkgYXJlIGFybWVkCiAgICB9CiAgICB6YXBwZWRFeGlwcnlUaW1lPXZpbGxhaW4uemFwcGVkRXhpcHJ5VGltZTsKICAgIGJ1eVByaWNlPXZpbGxhaW4uYnV5UHJpY2U7CiAgICBuZXh0UHJpY2U9Y2FsY3VsYXRlTmV3UHJpY2UoX3Rva2VuSWQpOwogICAgYWZmZWN0ZWRCeVRva2VuPXZpbGxhaW4uYWZmZWN0ZWRCeVRva2VuOwogIH0KCiAgLy8vIHphcCBhIHZpbGxhaW4gaW4gcHJlcGFyYXRpb24gZm9yIGEgcGluY2gKICBmdW5jdGlvbiB6YXBWaWxsYWluKHVpbnQyNTYgX3ZpY3RpbSAgLCB1aW50MjU2IF96YXBwZXIpIHB1YmxpYyBwYXlhYmxlIHJldHVybnMgKGJvb2wpewogICAgYWRkcmVzcyB2aWxsYW5Pd25lciA9IHZpbGxhaW5JbmRleFRvT3duZXJbX3ZpY3RpbV07CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgIT0gdmlsbGFuT3duZXIpOyAvLyBpdCBkb2Vzbid0IG1ha2Ugc2Vuc2UsIGJ1dCBoZXkKICAgIHJlcXVpcmUodmlsbGFpbnNbX3phcHBlcl0uY2xhc3M9PTApOyAvLyB0aGV5IG11c3QgYmUgYSB6YXBwZXIgY2xhc3MKICAgIHJlcXVpcmUobXNnLnNlbmRlcj09dmlsbGFpbkluZGV4VG9Pd25lcltfemFwcGVyXSk7IC8vIHRoZXkgbXVzdCBiZSBhIHphcHBlciBvd25lcgoKICAgIHVpbnQyNTYgb3BlcmF0aW9uUHJpY2UgPSB6YXBQcmljZTsKICAgIC8vIGlmIHRoZSB0YXJnZXQgc2FsZSBwcmljZSA8MC4wMSB0aGVuIG9wZXJhdGlvbiBpcyBmcmVlCiAgICBpZiAodmlsbGFpbkluZGV4VG9QcmljZVtfdmljdGltXTwwLjAxIGV0aGVyKXsKICAgICAgb3BlcmF0aW9uUHJpY2U9MDsKICAgIH0KCiAgICAvLyBjYW4gYmUgdXNlZCB0byBleHRlbmQgYSB6YXBwZWQgcGVyaW9kCiAgICBpZiAobXNnLnZhbHVlPj1vcGVyYXRpb25QcmljZSAmJiB2aWxsYWluc1tfdmljdGltXS5zdGF0ZTwyKXsKICAgICAgICAvLyB6YXAgdmlsbGFpbgogICAgICAgIHZpbGxhaW5zW192aWN0aW1dLnN0YXRlPTE7CiAgICAgICAgdmlsbGFpbnNbX3ZpY3RpbV0uemFwcGVkRXhpcHJ5VGltZSA9IG5vdyArICh2aWxsYWluc1tfemFwcGVyXS5sZXZlbCAqIDEgbWludXRlcyk7CiAgICB9CgogIH0KCiAgICAvLy8gcGluY2ggYSB2aWxsYWluCiAgZnVuY3Rpb24gcGluY2hWaWxsYWluKHVpbnQyNTYgX3ZpY3RpbSwgdWludDI1NiBfcGluY2hlcikgcHVibGljIHBheWFibGUgcmV0dXJucyAoYm9vbCl7CiAgICBhZGRyZXNzIHZpY3RpbU93bmVyID0gdmlsbGFpbkluZGV4VG9Pd25lcltfdmljdGltXTsKICAgIHJlcXVpcmUobXNnLnNlbmRlciAhPSB2aWN0aW1Pd25lcik7IC8vIGl0IGRvZXNuJ3QgbWFrZSBzZW5zZSwgYnV0IGhleQogICAgcmVxdWlyZShtc2cuc2VuZGVyPT12aWxsYWluSW5kZXhUb093bmVyW19waW5jaGVyXSk7CiAgICByZXF1aXJlKHZpbGxhaW5zW19waW5jaGVyXS5jbGFzcz09MSk7IC8vIHRoZXkgbXVzdCBiZSBhIHBpbmNoZXIKICAgIHJlcXVpcmUodmlsbGFpbnNbX3BpbmNoZXJdLm51bVNraWxsQWN0aXZlPHZpbGxhaW5zW19waW5jaGVyXS5sZXZlbCk7CgogICAgdWludDI1NiBvcGVyYXRpb25QcmljZSA9IHBpbmNoUHJpY2U7CiAgICAvLyBpZiB0aGUgdGFyZ2V0IHNhbGUgcHJpY2UgPDAuMDEgdGhlbiBvcGVyYXRpb24gaXMgZnJlZQogICAgaWYgKHZpbGxhaW5JbmRleFRvUHJpY2VbX3ZpY3RpbV08MC4wMSBldGhlcil7CiAgICAgIG9wZXJhdGlvblByaWNlPTA7CiAgICB9CgogICAgLy8gMCA9IG5vcm1hbCAsIDEgPSB6YXBwZWQgLCAyID0gcGluY2hlZAogICAgLy8gbXVzdCBiZSBpbnNpZGUgdGhlIHphcHBlZCB3aW5kb3cKICAgIGlmIChtc2cudmFsdWU+PW9wZXJhdGlvblByaWNlICYmIHZpbGxhaW5zW192aWN0aW1dLnN0YXRlPT0xICYmIG5vdzwgdmlsbGFpbnNbX3ZpY3RpbV0uemFwcGVkRXhpcHJ5VGltZSl7CiAgICAgICAgLy8gc3F1ZWV6ZQogICAgICAgIHZpbGxhaW5zW192aWN0aW1dLnN0YXRlPTI7IC8vIHNxdWVlemVkCiAgICAgICAgdmlsbGFpbnNbX3ZpY3RpbV0uYWZmZWN0ZWRCeVRva2VuPV9waW5jaGVyOwogICAgICAgIHZpbGxhaW5zW19waW5jaGVyXS5udW1Ta2lsbEFjdGl2ZSsrOwogICAgfQogIH0KCiAgLy8vIGd1YXJkIGEgdmlsbGFpbgogIGZ1bmN0aW9uIGd1YXJkVmlsbGFpbih1aW50MjU2IF90YXJnZXQsIHVpbnQyNTYgX2d1YXJkKSBwdWJsaWMgcGF5YWJsZSByZXR1cm5zIChib29sKXsKICAgIHJlcXVpcmUobXNnLnNlbmRlcj09dmlsbGFpbkluZGV4VG9Pd25lcltfZ3VhcmRdKTsgLy8gc2VuZGVyIG11c3Qgb3duIHRoaXMgdG9rZW4KICAgIHJlcXVpcmUodmlsbGFpbnNbX2d1YXJkXS5udW1Ta2lsbEFjdGl2ZTx2aWxsYWluc1tfZ3VhcmRdLmxldmVsKTsKCiAgICB1aW50MjU2IG9wZXJhdGlvblByaWNlID0gZ3VhcmRQcmljZTsKICAgIC8vIGlmIHRoZSB0YXJnZXQgc2FsZSBwcmljZSA8MC4wMSB0aGVuIG9wZXJhdGlvbiBpcyBmcmVlCiAgICBpZiAodmlsbGFpbkluZGV4VG9QcmljZVtfdGFyZ2V0XTwwLjAxIGV0aGVyKXsKICAgICAgb3BlcmF0aW9uUHJpY2U9MDsKICAgIH0KCiAgICAvLyAwID0gbm9ybWFsICwgMSA9IHphcHBlZCAsIDIgPSBwaW5jaGVkLCAzID0gZ3VhcmRlZAogICAgaWYgKG1zZy52YWx1ZT49b3BlcmF0aW9uUHJpY2UgJiYgdmlsbGFpbnNbX3RhcmdldF0uc3RhdGU8Mil7CiAgICAgICAgLy8gZ3VhcmQgdGhpcyB2aWxsYWluCiAgICAgICAgdmlsbGFpbnNbX3RhcmdldF0uc3RhdGU9MzsKICAgICAgICB2aWxsYWluc1tfdGFyZ2V0XS5hZmZlY3RlZEJ5VG9rZW49X2d1YXJkOwogICAgICAgIHZpbGxhaW5zW19ndWFyZF0ubnVtU2tpbGxBY3RpdmUrKzsKICAgIH0KICB9CgoKICBmdW5jdGlvbiBpbXBsZW1lbnRzRVJDNzIxKCkgcHVibGljIHB1cmUgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgcHVyZSByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBOQU1FOwogIH0KCiAgLy8vIEZvciBxdWVyeWluZyBvd25lciBvZiB0b2tlbgogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIHRva2VuSUQgZm9yIG93bmVyIGlucXVpcnkKICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkKICAgIHB1YmxpYwogICAgdmlldwogICAgcmV0dXJucyAoYWRkcmVzcyBvd25lcikKICB7CiAgICBvd25lciA9IHZpbGxhaW5JbmRleFRvT3duZXJbX3Rva2VuSWRdOwogICAgcmVxdWlyZShvd25lciAhPSBhZGRyZXNzKDApKTsKICB9CgogIGZ1bmN0aW9uIHBheW91dChhZGRyZXNzIF90bykgcHVibGljIG9ubHlDTGV2ZWwgewogICAgX3BheW91dChfdG8pOwogIH0KCgoKCiAgLy8gQWxsb3dzIHNvbWVvbmUgdG8gc2VuZCBldGhlciBhbmQgb2J0YWluIHRoZSB0b2tlbgogIGZ1bmN0aW9uIHB1cmNoYXNlKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBwYXlhYmxlIHsKICAgIGFkZHJlc3Mgb2xkT3duZXIgPSB2aWxsYWluSW5kZXhUb093bmVyW190b2tlbklkXTsKICAgIGFkZHJlc3MgbmV3T3duZXIgPSBtc2cuc2VuZGVyOwoKICAgIHVpbnQyNTYgc2VsbGluZ1ByaWNlID0gdmlsbGFpbkluZGV4VG9QcmljZVtfdG9rZW5JZF07CgogICAgLy8gTWFraW5nIHN1cmUgdG9rZW4gb3duZXIgaXMgbm90IHNlbmRpbmcgdG8gc2VsZgogICAgcmVxdWlyZShvbGRPd25lciAhPSBuZXdPd25lcik7CgogICAgLy8gU2FmZXR5IGNoZWNrIHRvIHByZXZlbnQgYWdhaW5zdCBhbiB1bmV4cGVjdGVkIDB4MCBkZWZhdWx0LgogICAgcmVxdWlyZShfYWRkcmVzc05vdE51bGwobmV3T3duZXIpKTsKCiAgICAvLyBNYWtpbmcgc3VyZSBzZW50IGFtb3VudCBpcyBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gdGhlIHNlbGxpbmdQcmljZQogICAgcmVxdWlyZShtc2cudmFsdWUgPj0gc2VsbGluZ1ByaWNlKTsKCiAgICB1aW50MjU2IHBheW1lbnQgPSByb3VuZEl0KHVpbnQyNTYoU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChzZWxsaW5nUHJpY2UsIDkzKSwgMTAwKSkpOyAvLyB0YWtpbmcgNyUgZm9yIHRoZSBob3VzZSBiZWZvcmUgYW55IHBpbmNoZXM/CiAgICB1aW50MjU2IHB1cmNoYXNlRXhjZXNzID0gU2FmZU1hdGguc3ViKG1zZy52YWx1ZSwgc2VsbGluZ1ByaWNlKTsKCgogICAgLy8gSEVSRSdTIFRIRSBGTElQUElORyBTVFJBVEVHWQoKICAgIHZpbGxhaW5JbmRleFRvUHJpY2VbX3Rva2VuSWRdICA9IGNhbGN1bGF0ZU5ld1ByaWNlKF90b2tlbklkKTsKCgogICAgIC8vIHdlIGNoZWNrIHRvIHNlZSBpZiB0aGVyZSBpcyBhIHBpbmNoIG9uIHRoaXMgdmlsbGFpbgogICAgIC8vIGlmIHRoZXJlIGlzLCB0aGVuIHRyYW5zZmVyIHRoZSBwaW5jaCBwZXJjZW50YWdlIHRvIHRoZSBvd25lciBvZiB0aGUgcGluY2ggdG9rZW4KICAgICBpZiAodmlsbGFpbnNbX3Rva2VuSWRdLnN0YXRlPT0yICYmIHZpbGxhaW5zW190b2tlbklkXS5hZmZlY3RlZEJ5VG9rZW4hPTApewogICAgICAgICB1aW50MjU2IHByb2ZpdCA9IHNlbGxpbmdQcmljZSAtIHZpbGxhaW5zW190b2tlbklkXS5idXlQcmljZTsKICAgICAgICAgdWludDI1NiBwaW5jaFBheW1lbnQgPSByb3VuZEl0KFNhZmVNYXRoLm11bChTYWZlTWF0aC5kaXYocHJvZml0LDEwMCkscGluY2hQZXJjZW50YWdlUmV0dXJuKSk7CgogICAgICAgICAvLyByZWxlYXNlIG9uIG9mIHRoaXMgdmlsbGFucyBwaW5jaCBjYXBhYmlsaXRpZXNsCiAgICAgICAgIGFkZHJlc3MgcGluY2hlclRva2VuT3duZXIgPSB2aWxsYWluSW5kZXhUb093bmVyW3ZpbGxhaW5zW190b2tlbklkXS5hZmZlY3RlZEJ5VG9rZW5dOwogICAgICAgICBwaW5jaGVyVG9rZW5Pd25lci50cmFuc2ZlcihwaW5jaFBheW1lbnQpOwogICAgICAgICBwYXltZW50ID0gU2FmZU1hdGguc3ViKHBheW1lbnQscGluY2hQYXltZW50KTsgLy8gc3VidHJhY3QgdGhlIHBpbmNoIGZlZXMKICAgICB9CgogICAgIC8vIGZyZWUgdGhlIHZpbGxhbiBvZiBhbnkgcGluY2hlcyBvciBndWFyZHMgYXMgcGFydCBvZiB0aGlzIHB1cnBvc2UKICAgICBpZiAodmlsbGFpbnNbdmlsbGFpbnNbX3Rva2VuSWRdLmFmZmVjdGVkQnlUb2tlbl0ubnVtU2tpbGxBY3RpdmU+MCl7CiAgICAgICAgdmlsbGFpbnNbdmlsbGFpbnNbX3Rva2VuSWRdLmFmZmVjdGVkQnlUb2tlbl0ubnVtU2tpbGxBY3RpdmUtLTsgLy8gcmVzZXQgdGhlIHBpbmNoZXIgb3IgZ3VhcmQgYWZmZWN0ZWQgY291bnQKICAgICB9CgogICAgIHZpbGxhaW5zW190b2tlbklkXS5zdGF0ZT0wOwogICAgIHZpbGxhaW5zW190b2tlbklkXS5hZmZlY3RlZEJ5VG9rZW49MDsKICAgICB2aWxsYWluc1tfdG9rZW5JZF0uYnV5UHJpY2U9c2VsbGluZ1ByaWNlOwoKICAgIF90cmFuc2ZlcihvbGRPd25lciwgbmV3T3duZXIsIF90b2tlbklkKTsKCiAgICAvLyBQYXkgcHJldmlvdXMgdG9rZW5Pd25lciBpZiBvd25lciBpcyBub3QgY29udHJhY3QKICAgIGlmIChvbGRPd25lciAhPSBhZGRyZXNzKHRoaXMpKSB7CiAgICAgIG9sZE93bmVyLnRyYW5zZmVyKHBheW1lbnQpOyAvLygxLTAuMDgpCiAgICB9CgogICAgVG9rZW5Tb2xkKF90b2tlbklkLCBzZWxsaW5nUHJpY2UsIHZpbGxhaW5JbmRleFRvUHJpY2VbX3Rva2VuSWRdLCBvbGRPd25lciwgbmV3T3duZXIsIHZpbGxhaW5zW190b2tlbklkXS5uYW1lKTsKCiAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHB1cmNoYXNlRXhjZXNzKTsgLy8gcmV0dXJuIGFueSBhZGRpdGlvbmFsIGFtb3VudAogIH0KCiAgZnVuY3Rpb24gcHJpY2VPZih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHByaWNlKSB7CiAgICByZXR1cm4gdmlsbGFpbkluZGV4VG9QcmljZVtfdG9rZW5JZF07CiAgfQoKICBmdW5jdGlvbiBuZXh0UHJpY2UodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBuUHJpY2UpIHsKICAgIHJldHVybiBjYWxjdWxhdGVOZXdQcmljZShfdG9rZW5JZCk7CiAgfQoKCi8vKG5vdGU6IGhhcmQgY29kZWQgdmFsdWUgYXBwcmVjaWF0aW9uIGlzIDJYIGZyb20gYSBjb250cmFjdCBwcmljZSBvZiAwIEVUSCB0byAwLjA1IEVUSCwgMS4yWCBmcm9tIDAuMDUgdG8gMC41IGFuZCAxLjE1WCBmcm9tIDAuNSBFVEggYW5kIHVwKS4KCgogZnVuY3Rpb24gY2FsY3VsYXRlTmV3UHJpY2UodWludDI1NiBfdG9rZW5JZCkgaW50ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2IHByaWNlKXsKICAgdWludDI1NiBzZWxsaW5nUHJpY2UgPSB2aWxsYWluSW5kZXhUb1ByaWNlW190b2tlbklkXTsKICAgdWludDI1NiBuZXdQcmljZTsKICAgLy8gVXBkYXRlIHByaWNlcwogICBpZiAoc2VsbGluZ1ByaWNlIDwgZmlyc3RTdGVwTGltaXQpIHsKICAgICAvLyBmaXJzdCBzdGFnZQogICAgbmV3UHJpY2UgPSByb3VuZEl0KFNhZmVNYXRoLm11bChzZWxsaW5nUHJpY2UsIDIpKTsKICAgfSBlbHNlIGlmIChzZWxsaW5nUHJpY2UgPCBzZWNvbmRTdGVwTGltaXQpIHsKICAgICAvLyBzZWNvbmQgc3RhZ2UKICAgICBuZXdQcmljZSA9IHJvdW5kSXQoU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChzZWxsaW5nUHJpY2UsIDEyMCksIDEwMCkpOwogICB9IGVsc2UgewogICAgIC8vIHRoaXJkIHN0YWdlCiAgICAgbmV3UHJpY2U9IHJvdW5kSXQoU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChzZWxsaW5nUHJpY2UsIDExNSksIDEwMCkpOwogICB9CiAgIHJldHVybiBuZXdQcmljZTsKCiB9CgogIC8vLyBAZGV2IEFzc2lnbnMgYSBuZXcgYWRkcmVzcyB0byBhY3QgYXMgdGhlIENFTy4gT25seSBhdmFpbGFibGUgdG8gdGhlIGN1cnJlbnQgQ0VPLgogIC8vLyBAcGFyYW0gX25ld0NFTyBUaGUgYWRkcmVzcyBvZiB0aGUgbmV3IENFTwogIGZ1bmN0aW9uIHNldENFTyhhZGRyZXNzIF9uZXdDRU8pIHB1YmxpYyBvbmx5Q0VPIHsKICAgIHJlcXVpcmUoX25ld0NFTyAhPSBhZGRyZXNzKDApKTsKCiAgICBjZW9BZGRyZXNzID0gX25ld0NFTzsKICB9CgogIC8vLyBAZGV2IEFzc2lnbnMgYSBuZXcgYWRkcmVzcyB0byBhY3QgYXMgdGhlIENPTy4gT25seSBhdmFpbGFibGUgdG8gdGhlIGN1cnJlbnQgQ09PLgogIC8vLyBAcGFyYW0gX25ld0NPTyBUaGUgYWRkcmVzcyBvZiB0aGUgbmV3IENPTwogIGZ1bmN0aW9uIHNldENPTyhhZGRyZXNzIF9uZXdDT08pIHB1YmxpYyBvbmx5Q0VPIHsKICAgIHJlcXVpcmUoX25ld0NPTyAhPSBhZGRyZXNzKDApKTsKCiAgICBjb29BZGRyZXNzID0gX25ld0NPTzsKICB9CgogIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgZnVuY3Rpb24gc3ltYm9sKCkgcHVibGljIHB1cmUgcmV0dXJucyAoc3RyaW5nKSB7CiAgICByZXR1cm4gU1lNQk9MOwogIH0KCiAgLy8vIEBub3RpY2UgQWxsb3cgcHJlLWFwcHJvdmVkIHVzZXIgdG8gdGFrZSBvd25lcnNoaXAgb2YgYSB0b2tlbgogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIElEIG9mIHRoZSBUb2tlbiB0aGF0IGNhbiBiZSB0cmFuc2ZlcnJlZCBpZiB0aGlzIGNhbGwgc3VjY2VlZHMuCiAgLy8vIEBkZXYgUmVxdWlyZWQgZm9yIEVSQy03MjEgY29tcGxpYW5jZS4KICBmdW5jdGlvbiB0YWtlT3duZXJzaGlwKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB7CiAgICBhZGRyZXNzIG5ld093bmVyID0gbXNnLnNlbmRlcjsKICAgIGFkZHJlc3Mgb2xkT3duZXIgPSB2aWxsYWluSW5kZXhUb093bmVyW190b2tlbklkXTsKCiAgICAvLyBTYWZldHkgY2hlY2sgdG8gcHJldmVudCBhZ2FpbnN0IGFuIHVuZXhwZWN0ZWQgMHgwIGRlZmF1bHQuCiAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChuZXdPd25lcikpOwoKICAgIC8vIE1ha2luZyBzdXJlIHRyYW5zZmVyIGlzIGFwcHJvdmVkCiAgICByZXF1aXJlKF9hcHByb3ZlZChuZXdPd25lciwgX3Rva2VuSWQpKTsKCiAgICBfdHJhbnNmZXIob2xkT3duZXIsIG5ld093bmVyLCBfdG9rZW5JZCk7CiAgfQoKICAvLy8gQHBhcmFtIF9vd25lciBUaGUgb3duZXIgd2hvc2UgdG9rZW5zIHdlIGFyZSBpbnRlcmVzdGVkIGluLgogIGZ1bmN0aW9uIHRva2Vuc09mT3duZXIoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnModWludDI1NltdIG93bmVyVG9rZW5zKSB7CiAgICB1aW50MjU2IHRva2VuQ291bnQgPSBiYWxhbmNlT2YoX293bmVyKTsKICAgIGlmICh0b2tlbkNvdW50ID09IDApIHsKICAgICAgICAvLyBSZXR1cm4gYW4gZW1wdHkgYXJyYXkKICAgICAgcmV0dXJuIG5ldyB1aW50MjU2W10oMCk7CiAgICB9IGVsc2UgewogICAgICB1aW50MjU2W10gbWVtb3J5IHJlc3VsdCA9IG5ldyB1aW50MjU2W10odG9rZW5Db3VudCk7CiAgICAgIHVpbnQyNTYgdG90YWxWaWxsYWlucyA9IHRvdGFsU3VwcGx5KCk7CiAgICAgIHVpbnQyNTYgcmVzdWx0SW5kZXggPSAwOwoKICAgICAgdWludDI1NiB2aWxsYWluSWQ7CiAgICAgIGZvciAodmlsbGFpbklkID0gMDsgdmlsbGFpbklkIDw9IHRvdGFsVmlsbGFpbnM7IHZpbGxhaW5JZCsrKSB7CiAgICAgICAgaWYgKHZpbGxhaW5JbmRleFRvT3duZXJbdmlsbGFpbklkXSA9PSBfb3duZXIpIHsKICAgICAgICAgIHJlc3VsdFtyZXN1bHRJbmRleF0gPSB2aWxsYWluSWQ7CiAgICAgICAgICByZXN1bHRJbmRleCsrOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH0KCiAgLy8vIEZvciBxdWVyeWluZyB0b3RhbFN1cHBseSBvZiB0b2tlbgogIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHRvdGFsKSB7CiAgICByZXR1cm4gdmlsbGFpbnMubGVuZ3RoOwogIH0KCiAgLy8vIE93bmVyIGluaXRhdGVzIHRoZSB0cmFuc2ZlciBvZiB0aGUgdG9rZW4gdG8gYW5vdGhlciBhY2NvdW50CiAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgZm9yIHRoZSB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZCB0by4KICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSBJRCBvZiB0aGUgVG9rZW4gdGhhdCBjYW4gYmUgdHJhbnNmZXJyZWQgaWYgdGhpcyBjYWxsIHN1Y2NlZWRzLgogIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgZnVuY3Rpb24gdHJhbnNmZXIoCiAgICBhZGRyZXNzIF90bywKICAgIHVpbnQyNTYgX3Rva2VuSWQKICApIHB1YmxpYyB7CiAgICByZXF1aXJlKF9vd25zKG1zZy5zZW5kZXIsIF90b2tlbklkKSk7CiAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChfdG8pKTsKCiAgICBfdHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdG9rZW5JZCk7CiAgfQoKICAvLy8gVGhpcmQtcGFydHkgaW5pdGlhdGVzIHRyYW5zZmVyIG9mIHRva2VuIGZyb20gYWRkcmVzcyBfZnJvbSB0byBhZGRyZXNzIF90bwogIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3MgZm9yIHRoZSB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZCBmcm9tLgogIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIGZvciB0aGUgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQgdG8uCiAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgSUQgb2YgdGhlIFRva2VuIHRoYXQgY2FuIGJlIHRyYW5zZmVycmVkIGlmIHRoaXMgY2FsbCBzdWNjZWVkcy4KICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbSgKICAgIGFkZHJlc3MgX2Zyb20sCiAgICBhZGRyZXNzIF90bywKICAgIHVpbnQyNTYgX3Rva2VuSWQKICApIHB1YmxpYyB7CiAgICByZXF1aXJlKF9vd25zKF9mcm9tLCBfdG9rZW5JZCkpOwogICAgcmVxdWlyZShfYXBwcm92ZWQoX3RvLCBfdG9rZW5JZCkpOwogICAgcmVxdWlyZShfYWRkcmVzc05vdE51bGwoX3RvKSk7CgogICAgX3RyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICB9CgogIC8qKiogUFJJVkFURSBGVU5DVElPTlMgKioqLwogIC8vLyBTYWZldHkgY2hlY2sgb24gX3RvIGFkZHJlc3MgdG8gcHJldmVudCBhZ2FpbnN0IGFuIHVuZXhwZWN0ZWQgMHgwIGRlZmF1bHQuCiAgZnVuY3Rpb24gX2FkZHJlc3NOb3ROdWxsKGFkZHJlc3MgX3RvKSBwcml2YXRlIHB1cmUgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIF90byAhPSBhZGRyZXNzKDApOwogIH0KCiAgLy8vIEZvciBjaGVja2luZyBhcHByb3ZhbCBvZiB0cmFuc2ZlciBmb3IgYWRkcmVzcyBfdG8KICBmdW5jdGlvbiBfYXBwcm92ZWQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gdmlsbGFpbkluZGV4VG9BcHByb3ZlZFtfdG9rZW5JZF0gPT0gX3RvOwogIH0KCgoKICAvLy8gRm9yIGNyZWF0aW5nIFZpbGxhaW5zCiAgZnVuY3Rpb24gX2NyZWF0ZVZpbGxhaW4oc3RyaW5nIF9uYW1lLCBhZGRyZXNzIF9vd25lciwgdWludDI1NiBfcHJpY2UsIHVpbnQyNTYgX2NsYXNzLCB1aW50MjU2IF9sZXZlbCkgcHJpdmF0ZSB7CgogICAgVmlsbGFpbiBtZW1vcnkgX3ZpbGxhaW4gPSBWaWxsYWluKHsKICAgICAgbmFtZTogX25hbWUsCiAgICAgIGNsYXNzOiBfY2xhc3MsCiAgICAgIGxldmVsOiBfbGV2ZWwsCiAgICAgIG51bVNraWxsQWN0aXZlOiAwLAogICAgICBzdGF0ZTogMCwKICAgICAgemFwcGVkRXhpcHJ5VGltZTogMCwKICAgICAgYWZmZWN0ZWRCeVRva2VuOiAwLAogICAgICBidXlQcmljZTogMCwKICAgICAgaWQ6IHZpbGxhaW5zLmxlbmd0aC0xCiAgICB9KTsKICAgIHVpbnQyNTYgbmV3VmlsbGFpbklkID0gdmlsbGFpbnMucHVzaChfdmlsbGFpbikgLSAxOwogICAgdmlsbGFpbnNbbmV3VmlsbGFpbklkXS5pZD1uZXdWaWxsYWluSWQ7CgogICAgLy8gSXQncyBwcm9iYWJseSBuZXZlciBnb2luZyB0byBoYXBwZW4sIDQgYmlsbGlvbiB0b2tlbnMgYXJlIEEgTE9ULCBidXQKICAgIC8vIGxldCdzIGp1c3QgYmUgMTAwJSBzdXJlIHdlIG5ldmVyIGxldCB0aGlzIGhhcHBlbi4KICAgIHJlcXVpcmUobmV3VmlsbGFpbklkID09IHVpbnQyNTYodWludDMyKG5ld1ZpbGxhaW5JZCkpKTsKCiAgICBCaXJ0aChuZXdWaWxsYWluSWQsIF9uYW1lLCBfb3duZXIpOwoKICAgIHZpbGxhaW5JbmRleFRvUHJpY2VbbmV3VmlsbGFpbklkXSA9IF9wcmljZTsKCiAgICAvLyBUaGlzIHdpbGwgYXNzaWduIG93bmVyc2hpcCwgYW5kIGFsc28gZW1pdCB0aGUgVHJhbnNmZXIgZXZlbnQgYXMKICAgIC8vIHBlciBFUkM3MjEgZHJhZnQKICAgIF90cmFuc2ZlcihhZGRyZXNzKDApLCBfb3duZXIsIG5ld1ZpbGxhaW5JZCk7CiAgfQoKICAvLy8gQ2hlY2sgZm9yIHRva2VuIG93bmVyc2hpcAogIGZ1bmN0aW9uIF9vd25zKGFkZHJlc3MgY2xhaW1hbnQsIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gY2xhaW1hbnQgPT0gdmlsbGFpbkluZGV4VG9Pd25lcltfdG9rZW5JZF07CiAgfQoKICAvLy8gRm9yIHBheWluZyBvdXQgYmFsYW5jZSBvbiBjb250cmFjdAogIGZ1bmN0aW9uIF9wYXlvdXQoYWRkcmVzcyBfdG8pIHByaXZhdGUgewogICAgaWYgKF90byA9PSBhZGRyZXNzKDApKSB7CiAgICAgIGNlb0FkZHJlc3MudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgIH0gZWxzZSB7CiAgICAgIF90by50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgfQogIH0KCiAgLy8vIEBkZXYgQXNzaWducyBvd25lcnNoaXAgb2YgYSBzcGVjaWZpYyBWaWxsYWluIHRvIGFuIGFkZHJlc3MuCiAgZnVuY3Rpb24gX3RyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHsKICAgIC8vIFNpbmNlIHRoZSBudW1iZXIgb2YgdmlsbGFpbnMgaXMgY2FwcGVkIHRvIDJeMzIgd2UgY2FuJ3Qgb3ZlcmZsb3cgdGhpcwogICAgb3duZXJzaGlwVG9rZW5Db3VudFtfdG9dKys7CiAgICAvL3RyYW5zZmVyIG93bmVyc2hpcAogICAgdmlsbGFpbkluZGV4VG9Pd25lcltfdG9rZW5JZF0gPSBfdG87CgogICAgLy8gV2hlbiBjcmVhdGluZyBuZXcgdmlsbGFpbnMgX2Zyb20gaXMgMHgwLCBidXQgd2UgY2FuJ3QgYWNjb3VudCB0aGF0IGFkZHJlc3MuCiAgICBpZiAoX2Zyb20gIT0gYWRkcmVzcygwKSkgewogICAgICBvd25lcnNoaXBUb2tlbkNvdW50W19mcm9tXS0tOwogICAgICAvLyBjbGVhciBhbnkgcHJldmlvdXNseSBhcHByb3ZlZCBvd25lcnNoaXAgZXhjaGFuZ2UKICAgICAgZGVsZXRlIHZpbGxhaW5JbmRleFRvQXBwcm92ZWRbX3Rva2VuSWRdOwogICAgfQoKICAgIC8vIEVtaXQgdGhlIHRyYW5zZmVyIGV2ZW50LgogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogIH0KCiAgICAvLyB1dGlsaXR5IHRvIHJvdW5kIHRvIHRoZSBnYW1lIHByZWNpc2lvbgogICAgZnVuY3Rpb24gcm91bmRJdCh1aW50MjU2IGFtb3VudCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikKICAgIHsKICAgICAgICAvLyByb3VuZCBkb3duIHRvIGNvcnJlY3QgcHJlaWNpc2lvbgogICAgICAgIHVpbnQyNTYgcmVzdWx0ID0gKGFtb3VudC9wcmVjaXNpb24pKnByZWNpc2lvbjsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKfQoKCgpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQ=='.
	

]
