Class {
	#name : #SRT1103849f41222a4c348515331f0e734d4bd9ad34,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT1103849f41222a4c348515331f0e734d4bd9ad34 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7CgoKIC8vLyBAdGl0bGUgU2FmZU1hdGggY29udHJhY3QgLSBtYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzCmNvbnRyYWN0IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBzYWZlTXVsKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICB1aW50IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHNhZmVEaXYodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIGFzc2VydChiID4gMCk7CiAgICB1aW50IGMgPSBhIC8gYjsKICAgIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzYWZlU3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIHNhZmVBZGQodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIHVpbnQgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGM+PWEgJiYgYz49Yik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIG1heDY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7CiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7CiAgfQoKICBmdW5jdGlvbiBtaW42NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgewogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7CiAgfQoKICBmdW5jdGlvbiBtYXgyNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBhID49IGIgPyBhIDogYjsKICB9CgogIGZ1bmN0aW9uIG1pbjI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7CiAgfQoKICBmdW5jdGlvbiBhc3NlcnQoYm9vbCBhc3NlcnRpb24pIGludGVybmFsIHsKICAgIHJlcXVpcmUoYXNzZXJ0aW9uKTsKICB9Cn0KCgoKIC8vLyBAdGl0bGUgT3duYWJsZSBjb250cmFjdCAtIGJhc2UgY29udHJhY3Qgd2l0aCBhbiBvd25lcgpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHsKICAgIGlmIChuZXdPd25lciAhPSBhZGRyZXNzKDApKSB7CiAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICB9CiAgfQp9CgoKLy8vIEB0aXRsZSBIYWx0YWJsZSBjb250cmFjdCAtIGFic3RyYWN0IGNvbnRyYWN0IHRoYXQgYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uCi8vLyBPcmlnaW5hbGx5IGVudmlzaW9uZWQgaW4gRmlyc3RCbG9vZCBJQ08gY29udHJhY3QuCmNvbnRyYWN0IEhhbHRhYmxlIGlzIE93bmFibGUgewogIGJvb2wgcHVibGljIGhhbHRlZDsKCiAgbW9kaWZpZXIgc3RvcEluRW1lcmdlbmN5IHsKICAgIHJlcXVpcmUoIWhhbHRlZCk7CiAgICBfOwogIH0KCiAgbW9kaWZpZXIgb25seUluRW1lcmdlbmN5IHsKICAgIHJlcXVpcmUoaGFsdGVkKTsKICAgIF87CiAgfQoKICAvLy8gY2FsbGVkIGJ5IHRoZSBvd25lciBvbiBlbWVyZ2VuY3ksIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUKICBmdW5jdGlvbiBoYWx0KCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIGhhbHRlZCA9IHRydWU7CiAgfQoKICAvLy8gY2FsbGVkIGJ5IHRoZSBvd25lciBvbiBlbmQgb2YgZW1lcmdlbmN5LCByZXR1cm5zIHRvIG5vcm1hbCBzdGF0ZQogIGZ1bmN0aW9uIHVuaGFsdCgpIGV4dGVybmFsIG9ubHlPd25lciBvbmx5SW5FbWVyZ2VuY3kgewogICAgaGFsdGVkID0gZmFsc2U7CiAgfQp9CgoKCgogLy8vIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2Ugc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMApjb250cmFjdCBFUkMyMCB7CiAgdWludCBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBjb25zdGFudCByZXR1cm5zICh1aW50KTsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50KTsKICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgcmVjZWl2ZXIsIHVpbnQgYW1vdW50KTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50IHZhbHVlKSByZXR1cm5zIChib29sIG9rKTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50IHZhbHVlKSByZXR1cm5zIChib29sIG9rKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludCB2YWx1ZSkgcmV0dXJucyAoYm9vbCBvayk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludCB2YWx1ZSk7Cn0KCgoKLy8vIEB0aXRsZSBTb2xhckRhb1Rva2VuIGNvbnRyYWN0IC0gc3RhbmRhcmQgRVJDMjAgdG9rZW4gd2l0aCBTaG9ydCBIYW5kIEF0dGFjayBhbmQgYXBwcm92ZSgpIHJhY2UgY29uZGl0aW9uIG1pdGlnYXRpb24uCmNvbnRyYWN0IFNvbGFyRGFvVG9rZW4gaXMgU2FmZU1hdGgsIEVSQzIwLCBPd25hYmxlIHsKIHN0cmluZyBwdWJsaWMgbmFtZSA9ICJTb2xhciBEQU8gVG9rZW4iOwogc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAiU0RBTyI7CiB1aW50IHB1YmxpYyBkZWNpbWFscyA9IDQ7CgogLy8vIGNvbnRyYWN0IHRoYXQgaXMgYWxsb3dlZCB0byBjcmVhdGUgbmV3IHRva2VucyBhbmQgYWxsb3dzIHVubGlmdCB0aGUgdHJhbnNmZXIgbGltaXRzIG9uIHRoaXMgdG9rZW4KIGFkZHJlc3MgcHVibGljIGNyb3dkc2FsZUFnZW50OwogLy8vIEEgY3Jvd2RzYWxlIGNvbnRyYWN0IGNhbiByZWxlYXNlIHVzIHRvIHRoZSB3aWxkIGlmIElDTyBzdWNjZXNzLiBJZiBmYWxzZSB3ZSBhcmUgYXJlIGluIHRyYW5zZmVyIGxvY2sgdXAgcGVyaW9kLgogYm9vbCBwdWJsaWMgcmVsZWFzZWQgPSBmYWxzZTsKIC8vLyBhcHByb3ZlKCkgYWxsb3dhbmNlcwogbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpKSBhbGxvd2VkOwogLy8vIGhvbGRlciBiYWxhbmNlcwogbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIGJhbGFuY2VzOwoKIC8vLyBAZGV2IExpbWl0IHRva2VuIHRyYW5zZmVyIHVudGlsIHRoZSBjcm93ZHNhbGUgaXMgb3Zlci4KIG1vZGlmaWVyIGNhblRyYW5zZmVyKCkgewogICBpZighcmVsZWFzZWQpIHsKICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjcm93ZHNhbGVBZ2VudCk7CiAgIH0KICAgXzsKIH0KCiAvLy8gQGRldiBUaGUgZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCBvbmx5IGJlZm9yZSBvciBhZnRlciB0aGUgdG9rZW5zIGhhdmUgYmVlbiByZWxlYXNlc2QKIC8vLyBAcGFyYW0gX3JlbGVhc2VkIHRva2VuIHRyYW5zZmVyIGFuZCBtaW50IHN0YXRlCiBtb2RpZmllciBpblJlbGVhc2VTdGF0ZShib29sIF9yZWxlYXNlZCkgewogICByZXF1aXJlKF9yZWxlYXNlZCA9PSByZWxlYXNlZCk7CiAgIF87CiB9CgogLy8vIEBkZXYgVGhlIGZ1bmN0aW9uIGNhbiBiZSBjYWxsZWQgb25seSBieSByZWxlYXNlIGFnZW50LgogbW9kaWZpZXIgb25seUNyb3dkc2FsZUFnZW50KCkgewogICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY3Jvd2RzYWxlQWdlbnQpOwogICBfOwogfQoKIC8vLyBAZGV2IEZpeCBmb3IgdGhlIEVSQzIwIHNob3J0IGFkZHJlc3MgYXR0YWNrIGh0dHA6Ly92ZXNzZW5lcy5jb20vdGhlLWVyYzIwLXNob3J0LWFkZHJlc3MtYXR0YWNrLWV4cGxhaW5lZC8KIC8vLyBAcGFyYW0gc2l6ZSBwYXlsb2FkIHNpemUKIG1vZGlmaWVyIG9ubHlQYXlsb2FkU2l6ZSh1aW50IHNpemUpIHsKICAgIHJlcXVpcmUobXNnLmRhdGEubGVuZ3RoID49IHNpemUgKyA0KTsKICAgIF87CiB9CgogLy8vIEBkZXYgTWFrZSBzdXJlIHdlIGFyZSBub3QgZG9uZSB5ZXQuCiBtb2RpZmllciBjYW5NaW50KCkgewogICAgcmVxdWlyZSghcmVsZWFzZWQpOwogICAgXzsKICB9CgogLy8vIEBkZXYgQ29uc3RydWN0b3IKIGZ1bmN0aW9uIFNvbGFyRGFvVG9rZW4oKSB7CiAgIG93bmVyID0gbXNnLnNlbmRlcjsKIH0KCiAvLy8gRmFsbGJhY2sgbWV0aG9kIHdpbGwgYnV5b3V0IHRva2VucwogZnVuY3Rpb24oKSBwYXlhYmxlIHsKICAgcmV2ZXJ0KCk7CiB9CgogLy8vIEBkZXYgQ3JlYXRlIG5ldyB0b2tlbnMgYW5kIGFsbG9jYXRlIHRoZW0gdG8gYW4gYWRkcmVzcy4gT25seSBjYWxsYWJseSBieSBhIGNyb3dkc2FsZSBjb250cmFjdAogLy8vIEBwYXJhbSByZWNlaXZlciBBZGRyZXNzIG9mIHJlY2VpdmVyCiAvLy8gQHBhcmFtIGFtb3VudCAgTnVtYmVyIG9mIHRva2VucyB0byBpc3N1ZS4KIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyByZWNlaXZlciwgdWludCBhbW91bnQpIG9ubHlDcm93ZHNhbGVBZ2VudCBjYW5NaW50IHB1YmxpYyB7CiAgICB0b3RhbFN1cHBseSA9IHNhZmVBZGQodG90YWxTdXBwbHksIGFtb3VudCk7CiAgICBiYWxhbmNlc1tyZWNlaXZlcl0gPSBzYWZlQWRkKGJhbGFuY2VzW3JlY2VpdmVyXSwgYW1vdW50KTsKICAgIFRyYW5zZmVyKDAsIHJlY2VpdmVyLCBhbW91bnQpOwogfQoKIC8vLyBAZGV2IFNldCB0aGUgY29udHJhY3QgdGhhdCBjYW4gY2FsbCByZWxlYXNlIGFuZCBtYWtlIHRoZSB0b2tlbiB0cmFuc2ZlcmFibGUuCiAvLy8gQHBhcmFtIF9jcm93ZHNhbGVBZ2VudCBjcm93ZHNhbGUgY29udHJhY3QgYWRkcmVzcwogZnVuY3Rpb24gc2V0Q3Jvd2RzYWxlQWdlbnQoYWRkcmVzcyBfY3Jvd2RzYWxlQWdlbnQpIG9ubHlPd25lciBpblJlbGVhc2VTdGF0ZShmYWxzZSkgcHVibGljIHsKICAgY3Jvd2RzYWxlQWdlbnQgPSBfY3Jvd2RzYWxlQWdlbnQ7CiB9CiAvLy8gQGRldiBPbmUgd2F5IGZ1bmN0aW9uIHRvIHJlbGVhc2UgdGhlIHRva2VucyB0byB0aGUgd2lsZC4gQ2FuIGJlIGNhbGxlZCBvbmx5IGZyb20gdGhlIHJlbGVhc2UgYWdlbnQgdGhhdCBpcyB0aGUgZmluYWwgSUNPIGNvbnRyYWN0LiBJdCBpcyBvbmx5IGNhbGxlZCBpZiB0aGUgY3Jvd2RzYWxlIGhhcyBiZWVuIHN1Y2Nlc3MgKGZpcnN0IG1pbGVzdG9uZSByZWFjaGVkKS4KIGZ1bmN0aW9uIHJlbGVhc2VUb2tlblRyYW5zZmVyKCkgcHVibGljIG9ubHlDcm93ZHNhbGVBZ2VudCB7CiAgIHJlbGVhc2VkID0gdHJ1ZTsKIH0KIC8vLyBAZGV2IFRyYW5mZXIgdG9rZW5zIHRvIGFkZHJlc3MKIC8vLyBAcGFyYW0gX3RvIGRlc3QgYWRkcmVzcwogLy8vIEBwYXJhbSBfdmFsdWUgdG9rZW5zIGFtb3VudAogLy8vIEByZXR1cm4gdHJhbnNmZXIgcmVzdWx0CiBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIG9ubHlQYXlsb2FkU2l6ZSgyICogMzIpIGNhblRyYW5zZmVyIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHNhZmVTdWIoYmFsYW5jZXNbbXNnLnNlbmRlcl0sIF92YWx1ZSk7CiAgIGJhbGFuY2VzW190b10gPSBzYWZlQWRkKGJhbGFuY2VzW190b10sIF92YWx1ZSk7CgogICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgIHJldHVybiB0cnVlOwogfQoKIC8vLyBAZGV2IFRyYW5mZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gb3RoZXIKIC8vLyBAcGFyYW0gX2Zyb20gc291cmNlIGFkZHJlc3MKIC8vLyBAcGFyYW0gX3RvIGRlc3QgYWRkcmVzcwogLy8vIEBwYXJhbSBfdmFsdWUgdG9rZW5zIGFtb3VudAogLy8vIEByZXR1cm4gdHJhbnNmZXIgcmVzdWx0CiBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSBjYW5UcmFuc2ZlciByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgdmFyIF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKCiAgICBiYWxhbmNlc1tfdG9dID0gc2FmZUFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOwogICAgYmFsYW5jZXNbX2Zyb21dID0gc2FmZVN1YihiYWxhbmNlc1tfZnJvbV0sIF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IHNhZmVTdWIoX2FsbG93YW5jZSwgX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKIH0KIC8vLyBAZGV2IFRva2VucyBiYWxhbmNlCiAvLy8gQHBhcmFtIF9vd25lciBob2xkZXIgYWRkcmVzcwogLy8vIEByZXR1cm4gYmFsYW5jZSBhbW91bnQKIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKSB7CiAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogfQoKIC8vLyBAZGV2IEFwcHJvdmUgdHJhbnNmZXIKIC8vLyBAcGFyYW0gX3NwZW5kZXIgaG9sZGVyIGFkZHJlc3MKIC8vLyBAcGFyYW0gX3ZhbHVlIHRva2VucyBhbW91bnQKIC8vLyBAcmV0dXJuIHJlc3VsdAogZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgIC8vIFRvIGNoYW5nZSB0aGUgYXBwcm92ZSBhbW91bnQgeW91IGZpcnN0IGhhdmUgdG8gcmVkdWNlIHRoZSBhZGRyZXNzZXNgCiAgIC8vICBhbGxvd2FuY2UgdG8gemVybyBieSBjYWxsaW5nIGBhcHByb3ZlKF9zcGVuZGVyLCAwKWAgaWYgaXQgaXMgbm90CiAgIC8vICBhbHJlYWR5IDAgdG8gbWl0aWdhdGUgdGhlIHJhY2UgY29uZGl0aW9uIGRlc2NyaWJlZCBoZXJlOgogICAvLyAgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgcmVxdWlyZSAoKF92YWx1ZSA9PSAwKSB8fCAoYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPT0gMCkpOwoKICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICByZXR1cm4gdHJ1ZTsKIH0KCiAvLy8gQGRldiBUb2tlbiBhbGxvd2FuY2UKIC8vLyBAcGFyYW0gX293bmVyIGhvbGRlciBhZGRyZXNzCiAvLy8gQHBhcmFtIF9zcGVuZGVyIHNwZW5kZXIgYWRkcmVzcwogLy8vIEByZXR1cm4gcmVtYWluIGFtb3VudAogZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlbWFpbmluZykgewogICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKIH0KfQovLy8gQHRpdGxlIEtpbGxhYmxlIGNvbnRyYWN0IC0gYmFzZSBjb250cmFjdCB0aGF0IGNhbiBiZSBraWxsZWQgYnkgb3duZXIuIEFsbCBmdW5kcyBpbiBjb250cmFjdCB3aWxsIGJlIHNlbnQgdG8gdGhlIG93bmVyLgpjb250cmFjdCBLaWxsYWJsZSBpcyBPd25hYmxlIHsKIGZ1bmN0aW9uIGtpbGwoKSBvbmx5T3duZXIgewogICBzZWxmZGVzdHJ1Y3Qob3duZXIpOwogfQp9CgoKLy8vIEB0aXRsZSBTb2xhckRhb1Rva2VuQ3Jvd2RzYWxlIGNvbnRyYWN0IC0gY29udHJhY3QgZm9yIHRva2VuIHNhbGVzLgpjb250cmFjdCBTb2xhckRhb1Rva2VuQ3Jvd2RzYWxlIGlzIEhhbHRhYmxlLCBLaWxsYWJsZSwgU2FmZU1hdGggewoKICAvLy8gUHJlZnVuZGluZyBnb2FsIGluIFVTRCBjZW50cywgaWYgdGhlIHByZWZ1bmRpbmcgZ29hbCBpcyByZWFjaGVkLCBpY28gd2lsbCBzdGFydAogIHVpbnQgcHVibGljIGNvbnN0YW50IFBSRV9GVU5ESU5HX0dPQUwgPSA0ZTYgKiBQUklDRTsKCiAgLy8vIFRva2VucyBmdW5kaW5nIGdvYWwgaW4gVVNEIGNlbnRzLCBpZiB0aGUgZnVuZGluZyBnb2FsIGlzIHJlYWNoZWQsIGljbyB3aWxsIHN0b3AKICB1aW50IHB1YmxpYyBjb25zdGFudCBJQ09fR09BTCA9IDhlNyAqIFBSSUNFOwoKICAvLy8gTWltaW5hbCB0b2tlbnMgZnVuZGluZyBnb2FsIGluIFVTRCBjZW50cywgaWYgdGhpcyBnb2FsIGlzbid0IHJlYWNoZWQgZHVyaW5nIElDTywgcmVmdW5kIHdpbGwgYmVnaW4KICB1aW50IHB1YmxpYyBjb25zdGFudCBNSU5fSUNPX0dPQUwgPSAxZTc7CgogIC8vLyBQZXJjZW50IG9mIGJvbnVzIHRva2VucyB0ZWFtIHJlY2VpdmVzIGZyb20gZWFjaCBpbnZlc3RtZW50CiAgdWludCBwdWJsaWMgY29uc3RhbnQgVEVBTV9CT05VU19QRVJDRU5UID0gMjU7CgogIC8vLyBUaGUgdG9rZW4gcHJpY2UgaW4gVVNEIGNlbnRzCiAgdWludCBjb25zdGFudCBwdWJsaWMgUFJJQ0UgPSAxMDA7CgogIC8vLyBEdXJhdGlvbiBvZiB0aGUgcHJlLUlDTyBzdGFnZQogIHVpbnQgY29uc3RhbnQgcHVibGljIFBSRV9JQ09fRFVSQVRJT04gPSA1IHdlZWtzOwoKICAvLy8gVGhlIHRva2VuIHdlIGFyZSBzZWxsaW5nCiAgU29sYXJEYW9Ub2tlbiBwdWJsaWMgdG9rZW47CgogIC8vLyB0b2tlbnMgd2lsbCBiZSB0cmFuc2ZlcmVkIGZyb20gdGhpcyBhZGRyZXNzCiAgYWRkcmVzcyBwdWJsaWMgbXVsdGlzaWdXYWxsZXQ7CgogIC8vLyB0aGUgVU5JWCB0aW1lc3RhbXAgc3RhcnQgZGF0ZSBvZiB0aGUgY3Jvd2RzYWxlCiAgdWludCBwdWJsaWMgc3RhcnRzQXQ7CgogIC8vLyB0aGUgVU5JWCB0aW1lc3RhbXAgZW5kIGRhdGUgb2YgdGhlIGNyb3dkc2FsZQogIHVpbnQgcHVibGljIGVuZHNBdDsKCiAgLy8vIHRoZSBVTklYIHRpbWVzdGFtcCBzdGFydCBkYXRlIG9mIHRoZSBwcmUgaW52ZXN0IGNyb3dkc2FsZQogIHVpbnQgcHVibGljIHByZUludmVzdFN0YXJ0OwoKICAvLy8gdGhlIG51bWJlciBvZiB0b2tlbnMgYWxyZWFkeSBzb2xkIHRocm91Z2ggdGhpcyBjb250cmFjdAogIHVpbnQgcHVibGljIHRva2Vuc1NvbGQgPSAwOwoKICAvLy8gSG93IG1hbnkgd2VpIG9mIGZ1bmRpbmcgd2UgaGF2ZSByYWlzZWQKICB1aW50IHB1YmxpYyB3ZWlSYWlzZWQgPSAwOwoKICAvLy8gSG93IG1hbnkgZGlzdGluY3QgYWRkcmVzc2VzIGhhdmUgaW52ZXN0ZWQKICB1aW50IHB1YmxpYyBpbnZlc3RvckNvdW50ID0gMDsKCiAgLy8vIEhvdyBtdWNoIHdlaSB3ZSBoYXZlIHJldHVybmVkIGJhY2sgdG8gdGhlIGNvbnRyYWN0IGFmdGVyIGEgZmFpbGVkIGNyb3dkZnVuZC4KICB1aW50IHB1YmxpYyBsb2FkZWRSZWZ1bmQgPSAwOwoKICAvLy8gSG93IG11Y2ggd2VpIHdlIGhhdmUgZ2l2ZW4gYmFjayB0byBpbnZlc3RvcnMuCiAgdWludCBwdWJsaWMgd2VpUmVmdW5kZWQgPSAwOwoKICAvLy8gSGFzIHRoaXMgY3Jvd2RzYWxlIGJlZW4gZmluYWxpemVkCiAgYm9vbCBwdWJsaWMgZmluYWxpemVkOwoKICAvLy8gVVNEIHRvIEV0aGVyIHJhdGUgaW4gY2VudHMKICB1aW50IHB1YmxpYyBleGNoYW5nZVJhdGU7CgogIC8vLyBleGNoYW5nZVJhdGUgdGltZXN0YW1wCiAgdWludCBwdWJsaWMgZXhjaGFuZ2VSYXRlVGltZXN0YW1wOwoKICAvLy8gRXh0ZXJuYWwgYWdlbnQgdGhhdCB3aWxsIGNhbiBjaGFuZ2UgZXhjaGFuZ2UgcmF0ZQogIGFkZHJlc3MgcHVibGljIGV4Y2hhbmdlUmF0ZUFnZW50OwoKICAvLy8gSG93IG11Y2ggRVRIIGVhY2ggYWRkcmVzcyBoYXMgaW52ZXN0ZWQgdG8gdGhpcyBjcm93ZHNhbGUKICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBpbnZlc3RlZEFtb3VudE9mOwoKICAvLy8gSG93IG11Y2ggdG9rZW5zIHRoaXMgY3Jvd2RzYWxlIGhhcyBjcmVkaXRlZCBmb3IgZWFjaCBpbnZlc3RvciBhZGRyZXNzCiAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgdG9rZW5BbW91bnRPZjsKCiAgLy8vIERlZmluZSBwcmVJQ08gcHJpY2luZyBzY2hlZHVsZSB1c2luZyBtaWxlc3RvbmVzLgogIHN0cnVjdCBNaWxlc3RvbmUgewogICAgICAvLyBVTklYIHRpbWVzdGFtcCB3aGVuIHRoaXMgbWlsZXN0b25lIGtpY2tzIGluCiAgICAgIHVpbnQgc3RhcnQ7CiAgICAgIC8vIFVOSVggdGltZXN0YW1wIHdoZW4gdGhpcyBtaWxlc3RvbmUga2lja3Mgb3V0CiAgICAgIHVpbnQgZW5kOwogICAgICAvLyBIb3cgbWFueSAlIHRva2VucyB3aWxsIGFkZAogICAgICB1aW50IGJvbnVzOwogIH0KCiAgTWlsZXN0b25lW10gcHVibGljIG1pbGVzdG9uZXM7CgogIC8vLyBTdGF0ZSBtYWNoaW5lCiAgLy8vIFByZXBhcmluZzogQWxsIGNvbnRyYWN0IGluaXRpYWxpemF0aW9uIGNhbGxzIGFuZCB2YXJpYWJsZXMgaGF2ZSBub3QgYmVlbiBzZXQgeWV0CiAgLy8vIFByZWZ1bmRpbmc6IFdlIGhhdmUgbm90IHBhc3NlZCBzdGFydCB0aW1lIHlldAogIC8vLyBGdW5kaW5nOiBBY3RpdmUgY3Jvd2RzYWxlCiAgLy8vIFN1Y2Nlc3M6IE1pbmltdW0gZnVuZGluZyBnb2FsIHJlYWNoZWQKICAvLy8gRmFpbHVyZTogTWluaW11bSBmdW5kaW5nIGdvYWwgbm90IHJlYWNoZWQgYmVmb3JlIGVuZGluZyB0aW1lCiAgLy8vIEZpbmFsaXplZDogVGhlIGZpbmFsaXplZCBoYXMgYmVlbiBjYWxsZWQgYW5kIHN1Y2Nlc2Z1bGx5IGV4ZWN1dGVkXAogIC8vLyBSZWZ1bmRpbmc6IFJlZnVuZHMgYXJlIGxvYWRlZCBvbiB0aGUgY29udHJhY3QgZm9yIHJlY2xhaW0uCiAgZW51bSBTdGF0ZXtVbmtub3duLCBQcmVwYXJpbmcsIFByZUZ1bmRpbmcsIEZ1bmRpbmcsIFN1Y2Nlc3MsIEZhaWx1cmUsIEZpbmFsaXplZCwgUmVmdW5kaW5nfQoKICAvLy8gQSBuZXcgaW52ZXN0bWVudCB3YXMgbWFkZQogIGV2ZW50IEludmVzdGVkKGFkZHJlc3MgaW52ZXN0b3IsIHVpbnQgd2VpQW1vdW50LCB1aW50IHRva2VuQW1vdW50KTsKICAvLy8gUmVmdW5kIHdhcyBwcm9jZXNzZWQgZm9yIGEgY29udHJpYnV0b3IKICBldmVudCBSZWZ1bmQoYWRkcmVzcyBpbnZlc3RvciwgdWludCB3ZWlBbW91bnQpOwogIC8vLyBDcm93ZHNhbGUgZW5kIHRpbWUgaGFzIGJlZW4gY2hhbmdlZAogIGV2ZW50IEVuZHNBdENoYW5nZWQodWludCBlbmRzQXQpOwogIC8vLyBDYWxjdWxhdGVkIG5ldyBwcmljZQogIGV2ZW50IEV4Y2hhbmdlUmF0ZUNoYW5nZWQodWludCBvbGRWYWx1ZSwgdWludCBuZXdWYWx1ZSk7CgogIC8vLyBAZGV2IE1vZGlmaWVkIGFsbG93aW5nIGV4ZWN1dGlvbiBvbmx5IGlmIHRoZSBjcm93ZHNhbGUgaXMgY3VycmVudGx5IHJ1bm5pbmcKICBtb2RpZmllciBpblN0YXRlKFN0YXRlIHN0YXRlKSB7CiAgICByZXF1aXJlKGdldFN0YXRlKCkgPT0gc3RhdGUpOwogICAgXzsKICB9CgogIG1vZGlmaWVyIG9ubHlFeGNoYW5nZVJhdGVBZ2VudCgpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBleGNoYW5nZVJhdGVBZ2VudCk7CiAgICBfOwogIH0KCiAgLy8vIEBkZXYgQ29uc3RydWN0b3IKICAvLy8gQHBhcmFtIF90b2tlbiBTb2xhciBEYW8gdG9rZW4gYWRkcmVzcwogIC8vLyBAcGFyYW0gX211bHRpc2lnV2FsbGV0IHRlYW0gd2FsbGV0CiAgLy8vIEBwYXJhbSBfcHJlSW52ZXN0U3RhcnQgcHJlSUNPIHN0YXJ0IGRhdGUKICAvLy8gQHBhcmFtIF9zdGFydCB0b2tlbiBJQ08gc3RhcnQgZGF0ZQogIC8vLyBAcGFyYW0gX2VuZCB0b2tlbiBJQ08gZW5kIGRhdGUKICBmdW5jdGlvbiBTb2xhckRhb1Rva2VuQ3Jvd2RzYWxlKGFkZHJlc3MgX3Rva2VuLCBhZGRyZXNzIF9tdWx0aXNpZ1dhbGxldCwgdWludCBfcHJlSW52ZXN0U3RhcnQsIHVpbnQgX3N0YXJ0LCB1aW50IF9lbmQpIHsKICAgIHJlcXVpcmUoX211bHRpc2lnV2FsbGV0ICE9IDApOwogICAgcmVxdWlyZShfcHJlSW52ZXN0U3RhcnQgIT0gMCk7CiAgICByZXF1aXJlKF9zdGFydCAhPSAwKTsKICAgIHJlcXVpcmUoX2VuZCAhPSAwKTsKICAgIHJlcXVpcmUoX3N0YXJ0IDwgX2VuZCk7CiAgICByZXF1aXJlKF9lbmQgPiBfcHJlSW52ZXN0U3RhcnQgKyBQUkVfSUNPX0RVUkFUSU9OKTsKCiAgICB0b2tlbiA9IFNvbGFyRGFvVG9rZW4oX3Rva2VuKTsKCiAgICBtdWx0aXNpZ1dhbGxldCA9IF9tdWx0aXNpZ1dhbGxldDsKICAgIHN0YXJ0c0F0ID0gX3N0YXJ0OwogICAgZW5kc0F0ID0gX2VuZDsKICAgIHByZUludmVzdFN0YXJ0ID0gX3ByZUludmVzdFN0YXJ0OwoKICAgIHZhciBwcmVJY29Cb251c2VzID0gW3VpbnQoMTAwKSwgODAsIDcwLCA2MCwgNTBdOwogICAgZm9yICh1aW50IGkgPSAwOyBpIDwgcHJlSWNvQm9udXNlcy5sZW5ndGg7IGkrKykgewogICAgICBtaWxlc3RvbmVzLnB1c2goTWlsZXN0b25lKHByZUludmVzdFN0YXJ0ICsgaSAqIDEgd2Vla3MsIHByZUludmVzdFN0YXJ0ICsgKGkgKyAxKSAqIDEgd2Vla3MsIHByZUljb0JvbnVzZXNbaV0pKTsKICAgIH0KICAgIG1pbGVzdG9uZXMucHVzaChNaWxlc3RvbmUoc3RhcnRzQXQsIHN0YXJ0c0F0ICsgNCBkYXlzLCAyNSkpOwogICAgbWlsZXN0b25lcy5wdXNoKE1pbGVzdG9uZShzdGFydHNBdCArIDQgZGF5cywgc3RhcnRzQXQgKyAxIHdlZWtzLCAyMCkpOwogICAgZGVsZXRlIHByZUljb0JvbnVzZXM7CgogICAgdmFyIGljb0JvbnVzZXMgPSBbdWludCgxNSksIDEwLCA1XTsKICAgIGZvciAoaSA9IDE7IGkgPD0gaWNvQm9udXNlcy5sZW5ndGg7IGkrKykgewogICAgICBtaWxlc3RvbmVzLnB1c2goTWlsZXN0b25lKHN0YXJ0c0F0ICsgaSAqIDEgd2Vla3MsIHN0YXJ0c0F0ICsgKGkgKyAxKSAqIDEgd2Vla3MsIGljb0JvbnVzZXNbaSAtIDFdKSk7CiAgICB9CiAgICBkZWxldGUgaWNvQm9udXNlczsKICB9CgogIGZ1bmN0aW9uKCkgcGF5YWJsZSB7CiAgICBidXkoKTsKICB9CgogIC8vLyBAZGV2IEdldCB0aGUgY3VycmVudCBtaWxlc3RvbmUgb3IgYmFpbCBvdXQgaWYgd2UgYXJlIG5vdCBpbiB0aGUgbWlsZXN0b25lIHBlcmlvZHMuCiAgLy8vIEByZXR1cm4gTWlsZXN0b25lIGN1cnJlbnQgYm9udXMgbWlsZXN0b25lCiAgZnVuY3Rpb24gZ2V0Q3VycmVudE1pbGVzdG9uZSgpIHByaXZhdGUgY29uc3RhbnQgcmV0dXJucyAoTWlsZXN0b25lKSB7CiAgICAgIGZvciAodWludCBpID0gMDsgaSA8IG1pbGVzdG9uZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAobWlsZXN0b25lc1tpXS5zdGFydCA8PSBub3cgJiYgbWlsZXN0b25lc1tpXS5lbmQgPiBub3cpIHsKICAgICAgICAgIHJldHVybiBtaWxlc3RvbmVzW2ldOwogICAgICAgIH0KICAgICAgfQogIH0KCiAgIC8vLyBAZGV2IE1ha2UgYW4gaW52ZXN0bWVudC4gQ3Jvd2RzYWxlIG11c3QgYmUgcnVubmluZyBmb3Igb25lIHRvIGludmVzdC4KICAgLy8vIEBwYXJhbSByZWNlaXZlciBUaGUgRXRoZXJldW0gYWRkcmVzcyB3aG8gcmVjZWl2ZXMgdGhlIHRva2VucwogIGZ1bmN0aW9uIGludmVzdEludGVybmFsKGFkZHJlc3MgcmVjZWl2ZXIpIHN0b3BJbkVtZXJnZW5jeSBwcml2YXRlIHsKICAgIHZhciBzdGF0ZSA9IGdldFN0YXRlKCk7CiAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLkZ1bmRpbmcgfHwgc3RhdGUgPT0gU3RhdGUuUHJlRnVuZGluZyk7CgogICAgdWludCB3ZWlBbW91bnQgPSBtc2cudmFsdWU7CiAgICB1aW50IHRva2Vuc0Ftb3VudCA9IGNhbGN1bGF0ZVRva2Vucyh3ZWlBbW91bnQpOwogICAgYXNzZXJ0ICh0b2tlbnNBbW91bnQgPiAwKTsKCiAgICBpZihzdGF0ZSA9PSBTdGF0ZS5QcmVGdW5kaW5nKSB7CiAgICAgICAgdG9rZW5zQW1vdW50ICs9IHNhZmVEaXYoc2FmZU11bCh0b2tlbnNBbW91bnQsIGdldEN1cnJlbnRNaWxlc3RvbmUoKS5ib251cyksIDEwMCk7CiAgICB9CgogICAgaWYoaW52ZXN0ZWRBbW91bnRPZltyZWNlaXZlcl0gPT0gMCkgewogICAgICAgLy8gQSBuZXcgaW52ZXN0b3IKICAgICAgIGludmVzdG9yQ291bnQrKzsKICAgIH0KCiAgICAvLyBVcGRhdGUgaW52ZXN0b3IKICAgIGludmVzdGVkQW1vdW50T2ZbcmVjZWl2ZXJdID0gc2FmZUFkZChpbnZlc3RlZEFtb3VudE9mW3JlY2VpdmVyXSwgd2VpQW1vdW50KTsKICAgIHRva2VuQW1vdW50T2ZbcmVjZWl2ZXJdID0gc2FmZUFkZCh0b2tlbkFtb3VudE9mW3JlY2VpdmVyXSwgdG9rZW5zQW1vdW50KTsKICAgIC8vIFVwZGF0ZSB0b3RhbHMKICAgIHdlaVJhaXNlZCA9IHNhZmVBZGQod2VpUmFpc2VkLCB3ZWlBbW91bnQpOwogICAgdG9rZW5zU29sZCA9IHNhZmVBZGQodG9rZW5zU29sZCwgdG9rZW5zQW1vdW50KTsgICAKCiAgICBhc3NpZ25Ub2tlbnMocmVjZWl2ZXIsIHRva2Vuc0Ftb3VudCk7CiAgICB2YXIgdGVhbUJvbnVzVG9rZW5zID0gc2FmZURpdihzYWZlTXVsKHRva2Vuc0Ftb3VudCwgVEVBTV9CT05VU19QRVJDRU5UKSwgMTAwIC0gVEVBTV9CT05VU19QRVJDRU5UKTsKICAgIGFzc2lnblRva2VucyhtdWx0aXNpZ1dhbGxldCwgdGVhbUJvbnVzVG9rZW5zKTsKCiAgICBtdWx0aXNpZ1dhbGxldC50cmFuc2Zlcih3ZWlBbW91bnQpOwogICAgLy8gVGVsbCB1cyBpbnZlc3Qgd2FzIHN1Y2Nlc3MKICAgIEludmVzdGVkKHJlY2VpdmVyLCB3ZWlBbW91bnQsIHRva2Vuc0Ftb3VudCk7CiAgfQoKICAvLy8gQGRldiBBbGxvdyBhbm9ueW1vdXMgY29udHJpYnV0aW9ucyB0byB0aGlzIGNyb3dkc2FsZS4KICAvLy8gQHBhcmFtIHJlY2VpdmVyIFRoZSBFdGhlcmV1bSBhZGRyZXNzIHdobyByZWNlaXZlcyB0aGUgdG9rZW5zCiAgZnVuY3Rpb24gaW52ZXN0KGFkZHJlc3MgcmVjZWl2ZXIpIHB1YmxpYyBwYXlhYmxlIHsKICAgIGludmVzdEludGVybmFsKHJlY2VpdmVyKTsKICB9CgogIC8vLyBAZGV2IFRoZSBiYXNpYyBlbnRyeSBwb2ludCB0byBwYXJ0aWNpcGF0ZSB0aGUgY3Jvd2RzYWxlIHByb2Nlc3MuCiAgZnVuY3Rpb24gYnV5KCkgcHVibGljIHBheWFibGUgewogICAgaW52ZXN0KG1zZy5zZW5kZXIpOwogIH0KCiAgLy8vIEBkZXYgRmluYWxpemUgYSBzdWNjY2VzZnVsIGNyb3dkc2FsZS4KICBmdW5jdGlvbiBmaW5hbGl6ZSgpIHB1YmxpYyBpblN0YXRlKFN0YXRlLlN1Y2Nlc3MpIG9ubHlPd25lciBzdG9wSW5FbWVyZ2VuY3kgewogICAgcmVxdWlyZSghZmluYWxpemVkKTsKCiAgICBmaW5hbGl6ZWQgPSB0cnVlOwogICAgZmluYWxpemVDcm93ZHNhbGUoKTsKICB9CgogIC8vLyBAZGV2IEZpbmFsaXplIGEgc3VjY2Nlc2Z1bCBjcm93ZHNhbGUuCiAgZnVuY3Rpb24gZmluYWxpemVDcm93ZHNhbGUoKSBpbnRlcm5hbCB7ICAgIAogICAgdG9rZW4ucmVsZWFzZVRva2VuVHJhbnNmZXIoKTsKICB9CgogICAvLy8gQGRldiBNZXRob2QgZm9yIHNldHRpbmcgVVNEIHRvIEV0aGVyIHJhdGUgZnJvbSBQb2xvbmlleAogICAvLy8gQHBhcmFtIHZhbHVlIFVTRCBhbW91dCBpbiBjZW50cyBmb3IgMSBFdGhlcgogICAvLy8gQHBhcmFtIHRpbWUgdGltZXN0YW1wCiAgZnVuY3Rpb24gc2V0RXhjaGFuZ2VSYXRlKHVpbnQgdmFsdWUsIHVpbnQgdGltZSkgb25seUV4Y2hhbmdlUmF0ZUFnZW50IHsKICAgIHJlcXVpcmUodmFsdWUgPiAwKTsKICAgIHJlcXVpcmUodGltZSA+IDApOwogICAgcmVxdWlyZShleGNoYW5nZVJhdGVUaW1lc3RhbXAgPT0gMCB8fCBnZXREaWZmZXJlbmNlKGludCh0aW1lKSwgaW50KG5vdykpIDw9IDEgbWludXRlcyk7CiAgICByZXF1aXJlKGV4Y2hhbmdlUmF0ZSA9PSAwIHx8IChnZXREaWZmZXJlbmNlKGludCh2YWx1ZSksIGludChleGNoYW5nZVJhdGUpKSAqIDEwMCAvIGV4Y2hhbmdlUmF0ZSA8PSAzMCkpOwoKICAgIEV4Y2hhbmdlUmF0ZUNoYW5nZWQoZXhjaGFuZ2VSYXRlLCB2YWx1ZSk7CiAgICBleGNoYW5nZVJhdGUgPSB2YWx1ZTsKICAgIGV4Y2hhbmdlUmF0ZVRpbWVzdGFtcCA9IHRpbWU7CiAgfQoKICAvLy8gQGRldiBNZXRob2Qgc2V0IGV4Y2hhbmdlIHJhdGUgYWdlbnQKICAvLy8gQHBhcmFtIG5ld0FnZW50IG5ldyBhZ2VudAogZnVuY3Rpb24gc2V0RXhjaGFuZ2VSYXRlQWdlbnQoYWRkcmVzcyBuZXdBZ2VudCkgb25seU93bmVyIHsKICAgaWYgKG5ld0FnZW50ICE9IGFkZHJlc3MoMCkpIHsKICAgICBleGNoYW5nZVJhdGVBZ2VudCA9IG5ld0FnZW50OwogICB9CiB9CiAKICAvLy8gQGRldiBNZXRob2Qgc2V0IGRhdGEgZnJvbSBtaWdyYXRlZCBjb250cmFjdAogIC8vLyBAcGFyYW0gX3Rva2Vuc1NvbGQgdG9rZW5zIHNvbGQKICAvLy8gQHBhcmFtIF93ZWlSYWlzZWQgX3dlaSByYWlzZWQKICAvLy8gQHBhcmFtIF9pbnZlc3RvckNvdW50IGludmVzdG9yIGNvdW50CiBmdW5jdGlvbiBzZXRDcm93ZHNhbGVEYXRhKHVpbnQgX3Rva2Vuc1NvbGQsIHVpbnQgX3dlaVJhaXNlZCwgdWludCBfaW52ZXN0b3JDb3VudCkgb25seU93bmVyIHsgIAoJcmVxdWlyZShfdG9rZW5zU29sZCA+IDApOwoJcmVxdWlyZShfd2VpUmFpc2VkID4gMCk7CglyZXF1aXJlKF9pbnZlc3RvckNvdW50ID4gMCk7CgkKCXRva2Vuc1NvbGQgPSBfdG9rZW5zU29sZDsKCXdlaVJhaXNlZCA9IF93ZWlSYWlzZWQ7CglpbnZlc3RvckNvdW50ID0gX2ludmVzdG9yQ291bnQ7CQogfQoKICBmdW5jdGlvbiBnZXREaWZmZXJlbmNlKGludCBvbmUsIGludCB0d28pIHByaXZhdGUgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgdmFyIGRpZmYgPSBvbmUgLSB0d287CiAgICBpZiAoZGlmZiA8IDApCiAgICAgIGRpZmYgPSAtZGlmZjsKICAgIHJldHVybiB1aW50KGRpZmYpOwogIH0KCiAgLy8vIEBkZXYgQWxsb3cgY3Jvd2RzYWxlIG93bmVyIHRvIGNsb3NlIGVhcmx5IG9yIGV4dGVuZCB0aGUgY3Jvd2RzYWxlLgogIC8vLyBAcGFyYW0gdGltZSB0aW1lc3RhbXAKICBmdW5jdGlvbiBzZXRFbmRzQXQodWludCB0aW1lKSBvbmx5T3duZXIgewogICAgcmVxdWlyZSh0aW1lID49IG5vdyk7CiAgICBlbmRzQXQgPSB0aW1lOwogICAgRW5kc0F0Q2hhbmdlZChlbmRzQXQpOwogIH0KCiAgLy8vIEBkZXYgQWxsb3cgbG9hZCByZWZ1bmRzIGJhY2sgb24gdGhlIGNvbnRyYWN0IGZvciB0aGUgcmVmdW5kaW5nLgogIGZ1bmN0aW9uIGxvYWRSZWZ1bmQoKSBwdWJsaWMgcGF5YWJsZSBpblN0YXRlKFN0YXRlLkZhaWx1cmUpIHsKICAgIHJlcXVpcmUobXNnLnZhbHVlID4gMCk7CiAgICBsb2FkZWRSZWZ1bmQgPSBzYWZlQWRkKGxvYWRlZFJlZnVuZCwgbXNnLnZhbHVlKTsKICB9CgogIC8vLyBAZGV2IEludmVzdG9ycyBjYW4gY2xhaW0gcmVmdW5kLgogIGZ1bmN0aW9uIHJlZnVuZCgpIHB1YmxpYyBpblN0YXRlKFN0YXRlLlJlZnVuZGluZykgewogICAgdWludDI1NiB3ZWlWYWx1ZSA9IGludmVzdGVkQW1vdW50T2ZbbXNnLnNlbmRlcl07CiAgICBpZiAod2VpVmFsdWUgPT0gMCkKICAgICAgcmV0dXJuOwogICAgaW52ZXN0ZWRBbW91bnRPZlttc2cuc2VuZGVyXSA9IDA7CiAgICB3ZWlSZWZ1bmRlZCA9IHNhZmVBZGQod2VpUmVmdW5kZWQsIHdlaVZhbHVlKTsKICAgIFJlZnVuZChtc2cuc2VuZGVyLCB3ZWlWYWx1ZSk7CiAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHdlaVZhbHVlKTsKICB9CgogIC8vLyBAZGV2IE1pbmltdW0gZ29hbCB3YXMgcmVhY2hlZAogIC8vLyBAcmV0dXJuIHRydWUgaWYgdGhlIGNyb3dkc2FsZSBoYXMgcmFpc2VkIGVub3VnaCBtb25leSB0byBub3QgaW5pdGlhdGUgdGhlIHJlZnVuZGluZwogIGZ1bmN0aW9uIGlzTWluaW11bUdvYWxSZWFjaGVkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wgcmVhY2hlZCkgewogICAgcmV0dXJuIHdlaVRvVXNkQ2VudHMod2VpUmFpc2VkKSA+PSBNSU5fSUNPX0dPQUw7CiAgfQoKICAvLy8gQGRldiBDaGVjayBpZiB0aGUgSUNPIGdvYWwgd2FzIHJlYWNoZWQuCiAgLy8vIEByZXR1cm4gdHJ1ZSBpZiB0aGUgY3Jvd2RzYWxlIGhhcyByYWlzZWQgZW5vdWdoIG1vbmV5IHRvIGJlIGEgc3VjY2VzcwogIGZ1bmN0aW9uIGlzQ3Jvd2RzYWxlRnVsbCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gd2VpVG9Vc2RDZW50cyh3ZWlSYWlzZWQpID49IElDT19HT0FMOwogIH0KCiAgLy8vIEBkZXYgQ3Jvd2RmdW5kIHN0YXRlIG1hY2hpbmUgbWFuYWdlbWVudC4KICAvLy8gQHJldHVybiBTdGF0ZSBjdXJyZW50IHN0YXRlCiAgZnVuY3Rpb24gZ2V0U3RhdGUoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoU3RhdGUpIHsKICAgIGlmIChmaW5hbGl6ZWQpCiAgICAgIHJldHVybiBTdGF0ZS5GaW5hbGl6ZWQ7CiAgICBpZiAoYWRkcmVzcyh0b2tlbikgPT0gMCB8fCBhZGRyZXNzKG11bHRpc2lnV2FsbGV0KSA9PSAwIHx8IG5vdyA8IHByZUludmVzdFN0YXJ0KQogICAgICByZXR1cm4gU3RhdGUuUHJlcGFyaW5nOwogICAgaWYgKHByZUludmVzdFN0YXJ0IDw9IG5vdyAmJiBub3cgPCBzdGFydHNBdCAmJiAhaXNNYXhpbXVtUHJlRnVuZGluZ0dvYWxSZWFjaGVkKCkpCiAgICAgIHJldHVybiBTdGF0ZS5QcmVGdW5kaW5nOwogICAgaWYgKG5vdyA8PSBlbmRzQXQgJiYgIWlzQ3Jvd2RzYWxlRnVsbCgpKQogICAgICByZXR1cm4gU3RhdGUuRnVuZGluZzsKICAgIGlmIChpc01pbmltdW1Hb2FsUmVhY2hlZCgpKQogICAgICByZXR1cm4gU3RhdGUuU3VjY2VzczsKICAgIGlmICghaXNNaW5pbXVtR29hbFJlYWNoZWQoKSAmJiB3ZWlSYWlzZWQgPiAwICYmIGxvYWRlZFJlZnVuZCA+PSB3ZWlSYWlzZWQpCiAgICAgIHJldHVybiBTdGF0ZS5SZWZ1bmRpbmc7CiAgICByZXR1cm4gU3RhdGUuRmFpbHVyZTsKICB9CgogIC8vLyBAZGV2IENhbGN1bGF0aW5nIHRva2VucyBjb3VudAogIC8vLyBAcGFyYW0gd2VpQW1vdW50IGludmVzdGVkCiAgLy8vIEByZXR1cm4gdG9rZW5zIGFtb3VudAogIGZ1bmN0aW9uIGNhbGN1bGF0ZVRva2Vucyh1aW50IHdlaUFtb3VudCkgaW50ZXJuYWwgcmV0dXJucyAodWludCB0b2tlbkFtb3VudCkgewogICAgdmFyIG11bHRpcGxpZXIgPSAxMCAqKiB0b2tlbi5kZWNpbWFscygpOwoKICAgIHVpbnQgdXNkQW1vdW50ID0gd2VpVG9Vc2RDZW50cyh3ZWlBbW91bnQpOwogICAgYXNzZXJ0ICh1c2RBbW91bnQgPj0gUFJJQ0UpOwoKICAgIHJldHVybiBzYWZlTXVsKHVzZEFtb3VudCwgc2FmZURpdihtdWx0aXBsaWVyLCBQUklDRSkpOwogIH0gIAoKICAgLy8vIEBkZXYgQ2hlY2sgaWYgdGhlIHByZSBJQ08gZ29hbCB3YXMgcmVhY2hlZC4KICAgLy8vIEByZXR1cm4gdHJ1ZSBpZiB0aGUgcHJlSUNPIGhhcyByYWlzZWQgZW5vdWdoIG1vbmV5IHRvIGJlIGEgc3VjY2VzcwogICBmdW5jdGlvbiBpc01heGltdW1QcmVGdW5kaW5nR29hbFJlYWNoZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCByZWFjaGVkKSB7CiAgICAgcmV0dXJuIHdlaVRvVXNkQ2VudHMod2VpUmFpc2VkKSA+PSBQUkVfRlVORElOR19HT0FMOwogICB9CgogICAvLy8gQGRldiBDb252ZXJ0cyB3ZWkgdmFsdWUgaW50byBVU0QgY2VudHMgYWNjb3JkaW5nIHRvIGN1cnJlbnQgZXhjaGFuZ2UgcmF0ZQogICAvLy8gQHBhcmFtIHdlaVZhbHVlIHdlaSB2YWx1ZSB0byBjb252ZXJ0CiAgIC8vLyBAcmV0dXJuIFVTRCBjZW50cyBlcXVpdmFsZW50IG9mIHRoZSB3ZWkgdmFsdWUKICAgZnVuY3Rpb24gd2VpVG9Vc2RDZW50cyh1aW50IHdlaVZhbHVlKSBwcml2YXRlIHJldHVybnMgKHVpbnQpIHsKICAgICByZXR1cm4gc2FmZURpdihzYWZlTXVsKHdlaVZhbHVlLCBleGNoYW5nZVJhdGUpLCAxZTE4KTsKICAgfQoKICAgLy8vIEBkZXYgRHluYW1pY2FsbHkgY3JlYXRlIHRva2VucyBhbmQgYXNzaWduIHRoZW0gdG8gdGhlIGludmVzdG9yLgogICAvLy8gQHBhcmFtIHJlY2VpdmVyIGludmVzdG9yIGFkZHJlc3MKICAgLy8vIEBwYXJhbSB0b2tlbkFtb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB3ZSB0cnkgdG8gZ2l2ZSB0byB0aGUgaW52ZXN0b3IgaW4gdGhlIGN1cnJlbnQgdHJhbnNhY3Rpb24KICAgZnVuY3Rpb24gYXNzaWduVG9rZW5zKGFkZHJlc3MgcmVjZWl2ZXIsIHVpbnQgdG9rZW5BbW91bnQpIHByaXZhdGUgewogICAgIHRva2VuLm1pbnQocmVjZWl2ZXIsIHRva2VuQW1vdW50KTsKICAgfQp9'.
	

]
