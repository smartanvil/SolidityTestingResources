Class {
	#name : #SRTd87c91884f5796e7b0a7ee8cc5d40ad6c63f289d,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd87c91884f5796e7b0a7ee8cc5d40ad6c63f289d >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgovLyBWRVJTSU9OIExBVkEoRCkKCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIGhlcmUncyBob3cgdGhpcyB3b3JrczoKLy8gdGhlIGN1cnJlbnQgYW1vdW50IG9mIGRpdmlkZW5kcyBkdWUgdG8gZWFjaCB0b2tlbi1ob2xkZXIncyAgaXM6Ci8vICAgcHJldmlvdXNfZHVlICsgWyBwKHgpICogdCh4KS9OIF0gKyBbIHAoeCsxKSAqIHQoeCsxKS9OIF0gKyAuLi4KLy8gICB3aGVyZSBwKHgpIGlzIHRoZSB4J3RoIHBheW1lbnQgcmVjZWl2ZWQgYnkgdGhlIGNvbnRyYWN0Ci8vICAgICAgICAgdCh4KSBpcyB0aGUgbnVtYmVyIG9mIHRva2VucyBoZWxkIGJ5IHRoZSB0b2tlbi1ob2xkZXIgYXQgdGhlIHRpbWUgb2YgcCh4KQovLyAgICAgICAgIE4gICAgaXMgdGhlIHRvdGFsIG51bWJlciBvZiB0b2tlbnMsIHdoaWNoIG5ldmVyIGNoYW5nZXMKLy8KLy8gYXNzdW1lIHRoYXQgdCh4KSB0YWtlcyBvbiAzIHZhbHVlcywgdChhKSwgdChiKSBhbmQgdChjKSwgZHVyaW5nIHBlcmlvZHMgYSwgYiwgYW5kIGMuIHRoZW46Ci8vIGZhY3RvcmluZzoKLy8gICBjdXJyZW50X2R1ZSA9IHsgKHQoYSkgKiBbcCh4KSArIHAoeCsxKV0gLi4uKSArCi8vICAgICAgICAgICAgICAgICAgICh0KGIpICogW3AoeSkgKyBwKHkrMSldIC4uLikgKwovLyAgICAgICAgICAgICAgICAgICAodChjKSAqIFtwKHopICsgcCh6KzEpXSAuLi4pIH0gLyBOCi8vCi8vIG9yCi8vCi8vICAgY3VycmVudF9kdWUgPSB7ICh0KGEpICogcGVyaW9kX2FfZmVlcykgKwovLyAgICAgICAgICAgICAgICAgICAodChiKSAqIHBlcmlvZF9iX2ZlZXMpICsKLy8gICAgICAgICAgICAgICAgICAgKHQoYykgKiBwZXJpb2RfY19mZWVzKSB9IC8gTgovLwovLyBpZiB3ZSBkZXNpZ25hdGUgY3VycmVudF9kdWUgKiBOIGFzIGN1cnJlbnQtcG9pbnRzLCB0aGVuCi8vCi8vICAgY3VycmVudFBvaW50cyA9IHsgICh0KGEpICogcGVyaW9kX2FfZmVlcykgKwovLyAgICAgICAgICAgICAgICAgICAgICAodChiKSAqIHBlcmlvZF9iX2ZlZXMpICsKLy8gICAgICAgICAgICAgICAgICAgICAgKHQoYykgKiBwZXJpb2RfY19mZWVzKSB9Ci8vCi8vIG9yIG1vcmUgc3VjY2ljdGx5LCBpZiB3ZSByZWNvbXB1dGUgY3VycmVudCBwb2ludHMgYmVmb3JlIGEgdG9rZW4taG9sZGVyJ3MgbnVtYmVyIG9mCi8vIHRva2VucywgVCwgaXMgYWJvdXQgdG8gY2hhbmdlOgovLwovLyAgIGN1cnJlbnRQb2ludHMgPSBwcmV2aW91c19wb2ludHMgKyAoVCAqIGN1cnJlbnQtcGVyaW9kLWZlZXMpCi8vCi8vIHdoZW4gd2Ugd2FudCB0byBkbyBhIHBheW91dCwgd2UnbGwgY2FsY3VsYXRlOgovLyAgY3VycmVudF9kdWUgPSBjdXJyZW50LXBvaW50cyAvIE4KLy8KLy8gd2UnbGwga2VlcCB0cmFjayBvZiBhIHRva2VuLWhvbGRlcidzIGN1cnJlbnQtcGVyaW9kLXBvaW50cywgd2hpY2ggaXM6Ci8vICAgVCAqIGN1cnJlbnQtcGVyaW9kLWZlZXMKLy8gYnkgdGFraW5nIGEgc25hcHNob3Qgb2YgZmVlcyBjb2xsZWN0ZWQgZXhhY3RseSB3aGVuIHRoZSBjdXJyZW50IHBlcmlvZCBiZWdhbjsgdGhhdCBpcywgdGhlIHdoZW4gdGhlCi8vIG51bWJlciBvZiB0b2tlbnMgbGFzdCBjaGFuZ2VkLiB0aGF0IGlzLCB3ZSBrZWVwIGEgcnVubmluZyBjb3VudCBvZiB0b3RhbCBmZWVzIHJlY2VpdmVkCi8vCi8vICAgVG90YWxGZWVzUmVjZWl2ZWQgPSBwKHgpICsgcCh4KzEpICsgcCh4KzIpCi8vCi8vICh3aGljaCBoYXBwaWx5IGlzIHRoZSBzYW1lIGZvciBhbGwgdG9rZW4gaG9sZGVycykgdGhlbiwgYmVmb3JlIGFueSB0b2tlbiBob2xkZXIgY2hhbmdlcyB0aGVpciBudW1iZXIgb2YKLy8gdG9rZW5zIHdlIGNvbXB1dGUgKGZvciB0aGF0IHRva2VuIGhvbGRlcik6Ci8vCi8vICBmdW5jdGlvbiBjYWxjQ3VyUG9pbnRzRm9yQWNjdChhY2N0KSB7Ci8vICAgIGN1cnJlbnRQb2ludHNbYWNjdF0gKz0gKFRvdGFsRmVlc1JlY2VpdmVkIC0gbGFzdFNuYXBzaG90W2FjY3RdKSAqIFRbYWNjdF0KLy8gICAgbGFzdFNuYXBzaG90W2FjY3RdID0gVG90YWxGZWVzUmVjZWl2ZWQKLy8gIH0KLy8KLy8gaW4gdGhlIHdpdGhkcmF3IGZjbiwgYWxsIHdlIG5lZWQgaXM6Ci8vCi8vICBmdW5jdGlvbiB3aXRoZHJhdyhhY2N0KSB7Ci8vICAgIGNhbGNDdXJQb2ludHNGb3JBY2N0KGFjY3QpOwovLyAgICBjdXJyZW50X2Ftb3VudF9kdWUgPSBjdXJyZW50UG9pbnRzW2FjY3RdIC8gTgovLyAgICBjdXJyZW50UG9pbnRzW2FjY3RdID0gMDsKLy8gICAgc2VuZChjdXJyZW50X2Ftb3VudF9kdWUpOwovLyAgfQovLwovLwovLyBzcGVjaWFsIHByb3Zpc2lvbnMgZm9yIHRyYW5zZmVycyBmcm9tIHRoZSBvbGQgZTRyb3cgY29udHJhY3QgKHRva2VuLXNwbGl0IHRyYW5zZmVycykKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyBub3JtYWxseSB3aGVuIGEgbmV3IGFjY3QgaXMgY3JlYXRlZCwgZWcgY3V6IHRva2VucyBhcmUgdHJhbnNmZXJyZWQgZnJvbSBvbmUgYWNjdCB0byBhbm90aGVyLCB3ZSBmaXJzdCBjYWxsCi8vIGNhbGNDdXJQb2ludHNGb3JBY2N0KGFjY3QpIG9uIHRoZSBvbGQgYWNjdDsgb24gdGhlIG5ldyBhY2N0IHdlIHNldDoKLy8gIGN1cnJlbnRQb2ludHNbYWNjdF0gPSAwOwovLyAgbGFzdFNuYXBzaG90W2FjY3RdID0gVG90YWxGZWVzUmVjZWl2ZWQ7Ci8vCi8vIHRoaXMgc3RhcnRzIHRoZSBuZXcgYWNjb3VudCB3aXRoIG5vIGNyZWRpdHMgZm9yIGFueSBkaXZpZGVuZHMgdGhhdCBoYXZlIGJlZW4gY29sbGVjdGVkIHNvIGZhciwgd2hpY2ggaXMgd2hhdAovLyB5b3Ugd291bGQgZ2VuZXJhbGx5IHdhbnQuIGhvd2V2ZXIsIHRoZXJlIGlzIGEgY2FzZSBpbiB3aGljaCB0b2tlbnMgYXJlIHRyYW5zZmVycmVkIGZyb20gdGhlIG9sZCBlNHJvdyBjb250cmFjdC4KLy8gaW4gdGhhdCBjYXNlIHRoZSB0b2tlbnMgd2VyZSByZXNlcnZlZCBvbiB0aGlzIGNvbnRyYWN0IGFsbCBhbG9uZywgYW5kIHRoZXkgZWFybiBkaXZpZGVuZHMgZXZlbiBiZWZvcmUgdGhleSBhcmUKLy8gYXNzaWduZWQgdG8gYW4gYWNjb3VudC4gc28gZm9yIHRva2VuLXNwbGl0IHRyYW5zZmVyczoKLy8gIGN1cnJlbnRQb2ludHNbYWNjdF0gPSAwOwovLyAgbGFzdFNuYXBzaG90W2FjY3RdID0gMDsKLy8KLy8gdGhlbiBpbW1lZGlhdGVseSBjYWxsIGNhbGNDdXJQb2ludHNGb3JBY2N0KGFjY3QpIGZvciB0aGUgbmV3IHRva2VuLXNwbGl0IGFjY291bnQuIGhlIHdpbGwgZ2V0IGNyZWRpdAovLyBmb3IgYWxsIHRoZSBhY2N1bXVsYXRlZCBwb2ludHMsIGZyb20gdGhlIGJlZ2lubmluZyBvZiB0aW1lLgovLwovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKCi8vIEFic3RyYWN0IGNvbnRyYWN0IGZvciB0aGUgZnVsbCBFUkMgMjAgVG9rZW4gc3RhbmRhcmQKLy8gaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8gQUJTVFJBQ1Qgc3RhbmRhcmQgdG9rZW4gY2xhc3MKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmNvbnRyYWN0IFRva2VuIHsgCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgc3VwcGx5KTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZyk7CgogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKfQoKCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vICBFNFJvd1Jld2FyZHMgLSBhYnN0cmFjdCBlNCBkaXZpZGVuZCBjb250cmFjdAovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpjb250cmFjdCBFNExhdmFSZXdhcmRzCnsKICAgICAgICBmdW5jdGlvbiBjaGVja0RpdmlkZW5kcyhhZGRyZXNzIF9hZGRyKSBjb25zdGFudCByZXR1cm5zKHVpbnQgX2Ftb3VudCk7CiAgICAgICAgZnVuY3Rpb24gd2l0aGRyYXdEaXZpZGVuZHMoKSBwdWJsaWMgcmV0dXJucyAodWludCBuYW1vdW50KTsKICAgICAgICBmdW5jdGlvbiB0cmFuc2ZlckRpdmlkZW5kcyhhZGRyZXNzIF90bykgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCn0KCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vICBFNFJPVyAoTEFWQSkgLSB0b2tlbiBjb250cmFjdAovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpjb250cmFjdCBFNExhdmEgaXMgVG9rZW4sIEU0TGF2YVJld2FyZHMgewogICAgICAgIGV2ZW50IFN0YXRFdmVudChzdHJpbmcgbXNnKTsKICAgICAgICBldmVudCBTdGF0RXZlbnRJKHN0cmluZyBtc2csIHVpbnQgdmFsKTsKCiAgICAgICAgZW51bSBTZXR0aW5nU3RhdGVWYWx1ZSAge2RlYnVnLCBsb2NrZWRSZWxlYXNlfQoKICAgICAgICBzdHJ1Y3QgdG9rZW5BY2NvdW50IHsKICAgICAgICAgICAgICAgIGJvb2wgYWxsb2NlZDsgICAgICAgLy8gZmxhZyB0byBhc2NlcnQgcHJpb3IgYWxsb2NhdGlvbgogICAgICAgICAgICAgICAgdWludCB0b2tlbnM7ICAgICAgICAvLyBudW0gdG9rZW5zIGN1cnJlbnRseSBoZWxkIGluIHRoaXMgYWNjdAogICAgICAgICAgICAgICAgdWludCBjdXJyZW50UG9pbnRzOyAvLyB1cGRhdGVkIGJlZm9yZSB0b2tlbiBiYWxhbmNlIGNoYW5nZXMsIG9yIGJlZm9yZSBhIHdpdGhkcmF3YWwuIGNyZWRpdCBmb3Igb3duaW5nIHRva2VucwogICAgICAgICAgICAgICAgdWludCBsYXN0U25hcHNob3Q7ICAvLyBzbmFwc2hvdCBvZiBnbG9iYWwgVG90YWxQb2ludHMsIGxhc3QgdGltZSB3ZSB1cGRhdGVkIHRoaXMgYWNjdCdzIGN1cnJlbnRQb2ludHMKICAgICAgICB9CgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyAgZGF0YSBzdG9yYWdlCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICB1aW50IGNvbnN0YW50IE51bU9yaWdUb2tlbnMgICAgICAgICA9IDU3NjI7ICAgLy8gbnVtYmVyIG9mIG9sZCB0b2tlbnMsIGZyb20gb3JpZ2luYWwgdG9rZW4gY29udHJhY3QKICAgICAgICB1aW50IGNvbnN0YW50IE5ld1Rva2Vuc1Blck9yaWdUb2tlbiA9IDEwMDAwMDsgLy8gaG93IG1hbnkgbmV3IHRva2VucyBhcmUgY3JlYXRlZCBmb3IgZWFjaCBmcm9tIG9yaWdpbmFsIHRva2VuCiAgICAgICAgdWludCBjb25zdGFudCBOZXdUb2tlblN1cHBseSAgICAgICAgPSA1NzYyICogMTAwMDAwOwogICAgICAgIHVpbnQgcHVibGljIG51bVRva3NTd2l0Y2hlZE92ZXI7ICAgICAgICAgICAgICAvLyBjb3VudCBvbGQgdG9rZW5zIHRoYXQgaGF2ZSBiZWVuIGNvbnZlcnRlZAogICAgICAgIHVpbnQgcHVibGljIGhvbGRvdmVyQmFsYW5jZTsgICAgICAgICAgICAgICAgICAvLyBmdW5kcyByZWNlaXZlZCwgYnV0IG5vdCB5ZXQgZGlzdHJpYnV0ZWQKICAgICAgICB1aW50IHB1YmxpYyBUb3RhbEZlZXNSZWNlaXZlZDsgICAgICAgICAgICAgICAgLy8gdG90YWwgZmVlcyByZWNlaXZlZCBmcm9tIHBhcnRuZXIgY29udHJhY3QocykKCiAgICAgICAgYWRkcmVzcyBwdWJsaWMgZGV2ZWxvcGVyczsgICAgICAgICAgICAgICAgICAgIC8vIGRldmVsb3BlcnMgdG9rZW4gaG9sZGluZyBhZGRyZXNzCiAgICAgICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7ICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRlcGxveWVyIGV4ZWN1dG9yCiAgICAgICAgYWRkcmVzcyBwdWJsaWMgb2xkRTQ7ICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZHIgb2Ygb2xkIGU0IHRva2VuIGNvbnRyYWN0CiAgICAgICAgYWRkcmVzcyBwdWJsaWMgb2xkRTRSZWN5Y2xlQmluOyAgLy8gYWRkciB0byB0cmFuc2ZlciBvbGQgdG9rZW5zCgogICAgICAgIHVpbnQgcHVibGljIGRlY2ltYWxzOwogICAgICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sOwoKICAgICAgICBtYXBwaW5nIChhZGRyZXNzID0+IHRva2VuQWNjb3VudCkgaG9sZGVyQWNjb3VudHM7ICAgICAgICAgIC8vIHdobyBob2xkcyBob3cgbWFueSB0b2tlbnMgKGhpZ2ggdHdvIGJ5dGVzIGNvbnRhaW4gY3VyUGF5SWQpCiAgICAgICAgbWFwcGluZyAodWludCA9PiBhZGRyZXNzKSBob2xkZXJJbmRleGVzOyAgICAgICAgICAgICAgICAgICAvLyBmb3IgaXRlcmF0aW9uIHRocnUgaG9sZGVyCiAgICAgICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOyAvLyBhcHByb3ZhbHMKICAgICAgICB1aW50IHB1YmxpYyBudW1BY2NvdW50czsKCiAgICAgICAgdWludCBwdWJsaWMgcGF5b3V0VGhyZXNob2xkOyAgICAgICAgICAgICAgICAgIC8vIG5vIHdpdGhkcmF3YWxzIGxlc3MgdGhhbiB0aGlzIGFtb3VudCwgdG8gYXZvaWQgcmVtYWluZGVycwogICAgICAgIHVpbnQgcHVibGljIHZlc3RUaW1lOyAgICAgICAgICAgICAgICAgICAgICAgICAvLyAxIHllYXIgcGFzdCBzYWxlIHZlc3QgZGV2ZWxvcGVyIHRva2VucwogICAgICAgIHVpbnQgcHVibGljIHJ3R2FzOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZXdhcmQgZ2FzCiAgICAgICAgdWludCBwdWJsaWMgb3B0SW5HYXM7CgogICAgICAgIFNldHRpbmdTdGF0ZVZhbHVlIHB1YmxpYyBzZXR0aW5nc1N0YXRlOwoKCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAvLyBjb250cmFjdCBjb25zdHJ1Y3RvcgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgZnVuY3Rpb24gRTRMYXZhKCkgCiAgICAgICAgewogICAgICAgICAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgICAgICAgICAgICAgZGV2ZWxvcGVycyA9IG1zZy5zZW5kZXI7CiAgICAgICAgICAgICAgICBkZWNpbWFscyA9IDI7CiAgICAgICAgICAgICAgICBzeW1ib2wgPSAiRTRST1ciOwogICAgICAgIH0KCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAvLyB1c2UgdGhpcyB0byByZXNldCBldmVyeXRoaW5nLCB3aWxsIG5ldmVyIGJlIGNhbGxlZCBhZnRlciBsb2NrUmVsZWFzZQogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgZnVuY3Rpb24gYXBwbHlTZXR0aW5ncyhTZXR0aW5nU3RhdGVWYWx1ZSBxU3RhdGUsIHVpbnQgX3RocmVzaG9sZCwgdWludCBfdmVzdCwgdWludCBfcncsIHVpbnQgX29wdEdhcyApCiAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIpIAogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CgogICAgICAgICAgICAgICAgLy8gdGhlc2Ugc2V0dGluZ3MgYXJlIHBlcm1hbmVudGx5IHR3ZWFrYWJsZSBmb3IgcGVyZm9ybWFuY2UgYWRqdXN0bWVudHMKICAgICAgICAgICAgICAgIHBheW91dFRocmVzaG9sZCA9IF90aHJlc2hvbGQ7CiAgICAgICAgICAgICAgICByd0dhcyA9IF9ydzsKICAgICAgICAgICAgICAgIG9wdEluR2FzID0gX29wdEdhczsKCiAgICAgICAgICAgICAgICAvLyB0aGlzIGZpcnN0IHRlc3QgY2hlY2tzIGlmIGFscmVhZHkgbG9ja2VkCiAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3NTdGF0ZSA9PSBTZXR0aW5nU3RhdGVWYWx1ZS5sb2NrZWRSZWxlYXNlKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CgogICAgICAgICAgICAgICAgc2V0dGluZ3NTdGF0ZSA9IHFTdGF0ZTsKCiAgICAgICAgICAgICAgICAvLyB0aGlzIHNlY29uZCB0ZXN0IGFsbG93cyBsb2NraW5nIHdpdGhvdXQgY2hhbmdpbmcgb3RoZXIgcGVybWFuZW50IHNldHRpbmdzCiAgICAgICAgICAgICAgICAvLyBXQVJOSU5HLCBNQUtFIFNVUkUgWU9VUidSRSBIQVBQWSBXSVRIIEFMTCBTRVRUSU5HUyAKICAgICAgICAgICAgICAgIC8vIEJFRk9SRSBMT0NLSU5HCgogICAgICAgICAgICAgICAgaWYgKHFTdGF0ZSA9PSBTZXR0aW5nU3RhdGVWYWx1ZS5sb2NrZWRSZWxlYXNlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFN0YXRFdmVudCgiTG9ja2luZyEiKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIHplcm8gb3V0IGFsbCB0b2tlbiBob2xkZXJzLiAgCiAgICAgICAgICAgICAgICAvLyBsZWF2ZSBhbGxvY2VkIG9uLCBsZWF2ZSBudW0gYWNjb3VudHMKICAgICAgICAgICAgICAgIC8vIGNhbnQgZGVsZXRlIHRoZW0gYW55d2F5cwoKICAgICAgICAgICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IG51bUFjY291bnRzOyBpKysgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3MgYSA9IGhvbGRlckluZGV4ZXNbaV07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2xkZXJBY2NvdW50c1thXS50b2tlbnMgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGRlckFjY291bnRzW2FdLmN1cnJlbnRQb2ludHMgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGRlckFjY291bnRzW2FdLmxhc3RTbmFwc2hvdCA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB2ZXN0VGltZSA9IF92ZXN0OwogICAgICAgICAgICAgICAgbnVtVG9rc1N3aXRjaGVkT3ZlciA9IDA7CgogICAgICAgICAgICAgICAgaWYgKHRoaXMuYmFsYW5jZSA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFvd25lci5jYWxsLmdhcyhyd0dhcykudmFsdWUodGhpcy5iYWxhbmNlKSgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN0YXRFdmVudCgiRVJST1IhIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBTdGF0RXZlbnQoIm9rIik7CgogICAgICAgIH0KCgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIC8vIGFsbG9jYXRlIGEgbmV3IGFjY291bnQgYnkgc2V0dGluZyBhbGxvYyB0byB0cnVlCiAgICAgICAgLy8gYWRkIGhvbGRlciBpbmRleCwgYnVtcCB0aGUgbnVtIGFjY291bnRzCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgZnVuY3Rpb24gYWRkQWNjb3VudChhZGRyZXNzIF9hZGRyKSBpbnRlcm5hbCAgewogICAgICAgICAgICAgICAgaG9sZGVyQWNjb3VudHNbX2FkZHJdLmFsbG9jZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgaG9sZGVyQWNjb3VudHNbX2FkZHJdLnRva2VucyA9IDA7CiAgICAgICAgICAgICAgICBob2xkZXJBY2NvdW50c1tfYWRkcl0uY3VycmVudFBvaW50cyA9IDA7CiAgICAgICAgICAgICAgICBob2xkZXJBY2NvdW50c1tfYWRkcl0ubGFzdFNuYXBzaG90ID0gVG90YWxGZWVzUmVjZWl2ZWQ7CiAgICAgICAgICAgICAgICBob2xkZXJJbmRleGVzW251bUFjY291bnRzKytdID0gX2FkZHI7CiAgICAgICAgfQoKCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIEJFR0lOIEVSQy0yMCBmcm9tIFN0YW5kYXJkVG9rZW4KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICAgICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHN1cHBseSkKICAgICAgICB7CiAgICAgICAgICAgICAgICBzdXBwbHkgPSBOZXdUb2tlblN1cHBseTsKICAgICAgICB9CgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAvLyBzZW5kZXIgdHJhbnNmZXJzIHRva2VucyB0byBhIG5ldyBhY2N0CiAgICAgICAgLy8gZG8gbm90IHVzZSB0aGlzIGZjbiBmb3IgYSB0b2tlbi1zcGxpdCB0cmFuc2ZlciBmcm9tIHRoZSBvbGQgdG9rZW4gY29udHJhY3QhCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSAKICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoKG1zZy5zZW5kZXIgPT0gZGV2ZWxvcGVycykgCiAgICAgICAgICAgICAgICAgICAgICAgICYmICAobm93IDwgdmVzdFRpbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vc3RhdEV2ZW50KCJUb2tlbnMgbm90IHlldCB2ZXN0ZWQuIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvL0RlZmF1bHQgYXNzdW1lcyB0b3RhbFN1cHBseSBjYW4ndCBiZSBvdmVyIG1heCAoMl4yNTYgLSAxKS4KICAgICAgICAgICAgICAgIC8vSWYgeW91ciB0b2tlbiBsZWF2ZXMgb3V0IHRvdGFsU3VwcGx5IGFuZCBjYW4gaXNzdWUgbW9yZSB0b2tlbnMgYXMgdGltZSBnb2VzIG9uLCB5b3UgbmVlZCB0byBjaGVjayBpZiBpdCBkb2Vzbid0IHdyYXAuCiAgICAgICAgICAgICAgICAvL1JlcGxhY2UgdGhlIGlmIHdpdGggdGhpcyBvbmUgaW5zdGVhZC4KICAgICAgICAgICAgICAgIC8vaWYgKGhvbGRlckFjY291bnRzW21zZy5zZW5kZXJdLnRva2VucyA+PSBfdmFsdWUgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+IGhvbGRlckFjY291bnRzW190b10pIHsKICAgICAgICAgICAgICAgIGlmIChob2xkZXJBY2NvdW50c1ttc2cuc2VuZGVyXS50b2tlbnMgPj0gX3ZhbHVlICYmIF92YWx1ZSA+IDApIHsKICAgICAgICAgICAgICAgICAgICAvL2ZpcnN0IGNyZWRpdCBzZW5kZXIgd2l0aCBwb2ludHMgYWNjcnVlZCBzbyBmYXIuLiBtdXN0IGRvIHRoaXMgYmVmb3JlIG51bWJlciBvZiBoZWxkIHRva2VucyBjaGFuZ2VzCiAgICAgICAgICAgICAgICAgICAgY2FsY0N1clBvaW50c0ZvckFjY3QobXNnLnNlbmRlcik7CiAgICAgICAgICAgICAgICAgICAgaG9sZGVyQWNjb3VudHNbbXNnLnNlbmRlcl0udG9rZW5zIC09IF92YWx1ZTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiAoIWhvbGRlckFjY291bnRzW190b10uYWxsb2NlZCkgewogICAgICAgICAgICAgICAgICAgICAgICBhZGRBY2NvdW50KF90byk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC8vY3JlZGl0IGRlc3RpbmF0aW9uIGFjY3Qgd2l0aCBwb2ludHMgYWNjcnVlZCBzbyBmYXIuLiBtdXN0IGRvIHRoaXMgYmVmb3JlIG51bWJlciBvZiBoZWxkIHRva2VucyBjaGFuZ2VzCiAgICAgICAgICAgICAgICAgICAgY2FsY0N1clBvaW50c0ZvckFjY3QoX3RvKTsKICAgICAgICAgICAgICAgICAgICBob2xkZXJBY2NvdW50c1tfdG9dLnRva2VucyArPSBfdmFsdWU7CgogICAgICAgICAgICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7IAogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsgCiAgICAgICAgICAgICAgICB9CiAgICAgICAgfQoKCiAgICAgICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgICAgICAgICBpZiAoKF9mcm9tID09IGRldmVsb3BlcnMpIAogICAgICAgICAgICAgICAgICAgICAgICAmJiAgKG5vdyA8IHZlc3RUaW1lKSkgewogICAgICAgICAgICAgICAgICAgICAgICAvL3N0YXRFdmVudCgiVG9rZW5zIG5vdCB5ZXQgdmVzdGVkLiIpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy9zYW1lIGFzIGFib3ZlLiBSZXBsYWNlIHRoaXMgbGluZSB3aXRoIHRoZSBmb2xsb3dpbmcgaWYgeW91IHdhbnQgdG8gcHJvdGVjdCBhZ2FpbnN0IHdyYXBwaW5nIHVpbnRzLgogICAgICAgICAgICAgICAgLy9pZiAoaG9sZGVyQWNjb3VudHNbX2Zyb21dLnRva2VucyA+PSBfdmFsdWUgJiYgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIGhvbGRlckFjY291bnRzW190b10udG9rZW5zICsgX3ZhbHVlID4gaG9sZGVyQWNjb3VudHNbX3RvXS50b2tlbnMpIHsKICAgICAgICAgICAgICAgIGlmIChob2xkZXJBY2NvdW50c1tfZnJvbV0udG9rZW5zID49IF92YWx1ZSAmJiBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgewoKICAgICAgICAgICAgICAgICAgICBjYWxjQ3VyUG9pbnRzRm9yQWNjdChfZnJvbSk7CiAgICAgICAgICAgICAgICAgICAgaG9sZGVyQWNjb3VudHNbX2Zyb21dLnRva2VucyAtPSBfdmFsdWU7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgKCFob2xkZXJBY2NvdW50c1tfdG9dLmFsbG9jZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWRkQWNjb3VudChfdG8pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAvL2NyZWRpdCBkZXN0aW5hdGlvbiBhY2N0IHdpdGggcG9pbnRzIGFjY3J1ZWQgc28gZmFyLi4gbXVzdCBkbyB0aGlzIGJlZm9yZSBudW1iZXIgb2YgaGVsZCB0b2tlbnMgY2hhbmdlcwogICAgICAgICAgICAgICAgICAgIGNhbGNDdXJQb2ludHNGb3JBY2N0KF90byk7CiAgICAgICAgICAgICAgICAgICAgaG9sZGVyQWNjb3VudHNbX3RvXS50b2tlbnMgKz0gX3ZhbHVlOwoKICAgICAgICAgICAgICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICAgICAgICAgICAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7IAogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsgCiAgICAgICAgICAgICAgICB9CiAgICAgICAgfQoKCiAgICAgICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICAgICAgICAgIGJhbGFuY2UgPSBob2xkZXJBY2NvdW50c1tfb3duZXJdLnRva2VuczsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgICAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgICAgICAgICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgICAgICAgfQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIEVORCBFUkMyMAovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAvLyBjYWxjIGN1cnJlbnQgcG9pbnRzIGZvciBhIHRva2VuIGhvbGRlcjsgdGhhdCBpcywgcG9pbnRzIHRoYXQgYXJlIGR1ZSB0byB0aGlzIHRva2VuIGhvbGRlciBmb3IgYWxsIGRpdmlkZW5kcwogICAgICAgIC8vIHJlY2VpdmVkIGJ5IHRoZSBjb250cmFjdCBkdXJpbmcgdGhlIGN1cnJlbnQgInBlcmlvZCIuIHRoZSBwZXJpb2QgYmVnYW4gdGhlIGxhc3QgdGltZSB0aGlzIGZjbiB3YXMgY2FsbGVkLCBhdCB3aGljaAogICAgICAgIC8vIHRpbWUgd2UgdXBkYXRlZCB0aGUgYWNjb3VudCdzIHNuYXBzaG90IG9mIHRoZSBydW5uaW5nIHBvaW50IGNvdW50LCBUb3RhbEZlZXNSZWNlaXZlZC4gZHVyaW5nIHRoZSBwZXJpb2QgdGhlIGFjY291bnQncwogICAgICAgIC8vIG51bWJlciBvZiB0b2tlbnMgbXVzdCBub3QgaGF2ZSBjaGFuZ2VkLiBzbyBhbHdheXMgY2FsbCB0aGlzIGZjbiBiZWZvcmUgY2hhbmdpbmcgdGhlIG51bWJlciBvZiB0b2tlbnMuCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIGZ1bmN0aW9uIGNhbGNDdXJQb2ludHNGb3JBY2N0KGFkZHJlc3MgX2FjY3QpIHsKICAgICAgICAgICAgICBob2xkZXJBY2NvdW50c1tfYWNjdF0uY3VycmVudFBvaW50cyArPSAoVG90YWxGZWVzUmVjZWl2ZWQgLSBob2xkZXJBY2NvdW50c1tfYWNjdF0ubGFzdFNuYXBzaG90KSAqIGhvbGRlckFjY291bnRzW19hY2N0XS50b2tlbnM7CiAgICAgICAgICAgICAgaG9sZGVyQWNjb3VudHNbX2FjY3RdLmxhc3RTbmFwc2hvdCA9IFRvdGFsRmVlc1JlY2VpdmVkOwogICAgICAgIH0KCgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIC8vIGFjY2VwdCBwYXltZW50IGZyb20gYSBwYXJ0bmVyIGNvbnRyYWN0CiAgICAgICAgLy8gZnVuZHMgc2VudCBoZXJlIGFyZSBhZGRlZCB0byBUb3RhbEZlZXNSZWNlaXZlZAogICAgICAgIC8vIFdBUk5JTkchIERPIE5PVCBDQUxMIFRISVMgRlVOQ1RJT04gTEVTVCBZT1UgTE9TRSBZT1VSIE1PTkVZCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgZnVuY3Rpb24gKCkgcGF5YWJsZSB7CiAgICAgICAgICAgICAgICBob2xkb3ZlckJhbGFuY2UgKz0gbXNnLnZhbHVlOwogICAgICAgICAgICAgICAgVG90YWxGZWVzUmVjZWl2ZWQgKz0gbXNnLnZhbHVlOwogICAgICAgICAgICAgICAgU3RhdEV2ZW50SSgiUGF5bWVudCIsIG1zZy52YWx1ZSk7CiAgICAgICAgfQoKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAvLyBvbmUgbmV2ZXIga25vd3MgaWYgdGhpcyB3aWxsIGNvbWUgaW4gaGFuZHkuCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgZnVuY3Rpb24gYmxhY2tIb2xlKCkgcGF5YWJsZSB7CiAgICAgICAgICAgICAgICBTdGF0RXZlbnRJKCJhZGp1c3RlZCIsIG1zZy52YWx1ZSk7CiAgICAgICAgfQoKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgLy8gc2VuZGVyIHdpdGhkcmF3IGVudGlyZSByZXdhcmRzL2RpdmlkZW5kcwogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBmdW5jdGlvbiB3aXRoZHJhd0RpdmlkZW5kcygpIHB1YmxpYyByZXR1cm5zICh1aW50IF9hbW91bnQpCiAgICAgICAgewogICAgICAgICAgICAgICAgY2FsY0N1clBvaW50c0ZvckFjY3QobXNnLnNlbmRlcik7CgogICAgICAgICAgICAgICAgX2Ftb3VudCA9IGhvbGRlckFjY291bnRzW21zZy5zZW5kZXJdLmN1cnJlbnRQb2ludHMgLyBOZXdUb2tlblN1cHBseTsKICAgICAgICAgICAgICAgIGlmIChfYW1vdW50IDw9IHBheW91dFRocmVzaG9sZCkgewogICAgICAgICAgICAgICAgICAgICAgICBTdGF0RXZlbnRJKCJsb3cgQmFsYW5jZSIsIF9hbW91bnQpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKG1zZy5zZW5kZXIgPT0gZGV2ZWxvcGVycykgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgIChub3cgPCB2ZXN0VGltZSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdGF0RXZlbnQoIlRva2VucyBub3QgeWV0IHZlc3RlZC4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYW1vdW50ID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQgX3BvaW50c1VzZWQgPSBfYW1vdW50ICogTmV3VG9rZW5TdXBwbHk7CiAgICAgICAgICAgICAgICAgICAgICAgIGhvbGRlckFjY291bnRzW21zZy5zZW5kZXJdLmN1cnJlbnRQb2ludHMgLT0gX3BvaW50c1VzZWQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGhvbGRvdmVyQmFsYW5jZSAtPSBfYW1vdW50OwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1zZy5zZW5kZXIuY2FsbC5nYXMocndHYXMpLnZhbHVlKF9hbW91bnQpKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgLy8gYWxsb3cgc2VuZGVyIHRvIHRyYW5zZmVyIGRpdmlkZW5kcwogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBmdW5jdGlvbiB0cmFuc2ZlckRpdmlkZW5kcyhhZGRyZXNzIF90bykgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSAKICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoKG1zZy5zZW5kZXIgPT0gZGV2ZWxvcGVycykgCiAgICAgICAgICAgICAgICAgICAgICAgICYmICAobm93IDwgdmVzdFRpbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vc3RhdEV2ZW50KCJUb2tlbnMgbm90IHlldCB2ZXN0ZWQuIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhbGNDdXJQb2ludHNGb3JBY2N0KG1zZy5zZW5kZXIpOwogICAgICAgICAgICAgICAgaWYgKGhvbGRlckFjY291bnRzW21zZy5zZW5kZXJdLmN1cnJlbnRQb2ludHMgPT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICBTdGF0RXZlbnQoIlplcm8gYmFsYW5jZSIpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoIWhvbGRlckFjY291bnRzW190b10uYWxsb2NlZCkgewogICAgICAgICAgICAgICAgICAgICAgICBhZGRBY2NvdW50KF90byk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYWxjQ3VyUG9pbnRzRm9yQWNjdChfdG8pOwogICAgICAgICAgICAgICAgaG9sZGVyQWNjb3VudHNbX3RvXS5jdXJyZW50UG9pbnRzICs9IGhvbGRlckFjY291bnRzW21zZy5zZW5kZXJdLmN1cnJlbnRQb2ludHM7CiAgICAgICAgICAgICAgICBob2xkZXJBY2NvdW50c1ttc2cuc2VuZGVyXS5jdXJyZW50UG9pbnRzID0gMDsKICAgICAgICAgICAgICAgIFN0YXRFdmVudCgiVHJhc25mZXJlZCBEaXZpZGVuZHMiKTsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCgoKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgLy8gc2V0IGdhcyBmb3Igb3BlcmF0aW9ucwogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBmdW5jdGlvbiBzZXRPcEdhcyh1aW50IF9ydywgdWludCBfb3B0SW4pCiAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIgJiYgbXNnLnNlbmRlciAhPSBkZXZlbG9wZXJzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vU3RhdEV2ZW50KCJvbmx5IG93bmVyIGNhbGxzIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJ3R2FzID0gX3J3OwogICAgICAgICAgICAgICAgICAgICAgICBvcHRJbkdhcyA9IF9vcHRJbjsKICAgICAgICAgICAgICAgIH0KICAgICAgICB9CgoKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgLy8gY2hlY2sgcmV3YXJkcy4gIHBhc3MgaW4gYWRkcmVzcyBvZiB0b2tlbiBob2xkZXIKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgZnVuY3Rpb24gY2hlY2tEaXZpZGVuZHMoYWRkcmVzcyBfYWRkcikgY29uc3RhbnQgcmV0dXJucyh1aW50IF9hbW91bnQpCiAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKGhvbGRlckFjY291bnRzW19hZGRyXS5hbGxvY2VkKSB7CiAgICAgICAgICAgICAgICAgICAvL2Rvbid0IGNhbGwgY2FsY0N1clBvaW50c0ZvckFjY3QgaGVyZSwgY3V6IHRoaXMgaXMgYSBjb25zdGFudCBmY24KICAgICAgICAgICAgICAgICAgIHVpbnQgX2N1cnJlbnRQb2ludHMgPSBob2xkZXJBY2NvdW50c1tfYWRkcl0uY3VycmVudFBvaW50cyArIAogICAgICAgICAgICAgICAgICAgICAgICAoKFRvdGFsRmVlc1JlY2VpdmVkIC0gaG9sZGVyQWNjb3VudHNbX2FkZHJdLmxhc3RTbmFwc2hvdCkgKiBob2xkZXJBY2NvdW50c1tfYWRkcl0udG9rZW5zKTsKICAgICAgICAgICAgICAgICAgIF9hbW91bnQgPSBfY3VycmVudFBvaW50cyAvIE5ld1Rva2VuU3VwcGx5OwoKICAgICAgICAgICAgICAgIC8vIGxvdyBiYWxhbmNlPyBsZXQgaGltIHNlZSBpdCAtRXRhbnNreQogICAgICAgICAgICAgICAgICAvLyBpZiAoX2Ftb3VudCA8PSBwYXlvdXRUaHJlc2hvbGQpIHsKICAgICAgICAgICAgICAgICAgLy8gICAgX2Ftb3VudCA9IDA7CiAgICAgICAgICAgICAgICAgIC8vIH0KCiAgICAgICAgICAgICAgICB9CiAgICAgICAgfQoKCgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAvLyBzd2FwIGV4ZWN1dG9yCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIGZ1bmN0aW9uIGNoYW5nZU93bmVyKGFkZHJlc3MgX2FkZHIpIAogICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChtc2cuc2VuZGVyICE9IG93bmVyCiAgICAgICAgICAgICAgICAgICAgICAgIHx8IHNldHRpbmdzU3RhdGUgPT0gU2V0dGluZ1N0YXRlVmFsdWUubG9ja2VkUmVsZWFzZSkKICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93OwogICAgICAgICAgICAgICAgb3duZXIgPSBfYWRkcjsKICAgICAgICB9CgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAvLyBzZXQgZGV2ZWxvcGVycyBhY2NvdW50CiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIGZ1bmN0aW9uIHNldERldmVsb3BlcihhZGRyZXNzIF9hZGRyKSAKICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lcgogICAgICAgICAgICAgICAgICAgICAgICB8fCBzZXR0aW5nc1N0YXRlID09IFNldHRpbmdTdGF0ZVZhbHVlLmxvY2tlZFJlbGVhc2UpCiAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdzsKICAgICAgICAgICAgICAgIGRldmVsb3BlcnMgPSBfYWRkcjsKICAgICAgICB9CgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAvLyBzZXQgb2xkRTQgQWRkcmVzc2VzCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIGZ1bmN0aW9uIHNldE9sZEU0KGFkZHJlc3MgX29sZEU0LCBhZGRyZXNzIF9vbGRFNFJlY3lsZSkgCiAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIKICAgICAgICAgICAgICAgICAgICAgICAgfHwgc2V0dGluZ3NTdGF0ZSA9PSBTZXR0aW5nU3RhdGVWYWx1ZS5sb2NrZWRSZWxlYXNlKQogICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICAgICAgICBvbGRFNCA9IF9vbGRFNDsKICAgICAgICAgICAgICAgIG9sZEU0UmVjeWNsZUJpbiA9IF9vbGRFNFJlY3lsZTsKICAgICAgICB9CgoKCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIC8vIERFQlVHIE9OTFkgLSBlbmQgdGhpcyBjb250cmFjdCwgc3VpY2lkZSB0byBkZXZlbG9wZXJzCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIGZ1bmN0aW9uIGhhcmFLaXJpKCkKICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3NTdGF0ZSAhPSBTZXR0aW5nU3RhdGVWYWx1ZS5kZWJ1ZykKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lcikKICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93OwogICAgICAgICAgICAgICAgc3VpY2lkZShkZXZlbG9wZXJzKTsKICAgICAgICB9CgoKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgLy8gT1BUIElOIEZST00gQ0xBU1NJQy4KICAgICAgICAvLyBBbGwgb2xkIHRva2VuIGhvbGRlcnMgY2FuIG9wdCBpbnRvIHRoaXMgbmV3IGNvbnRyYWN0IGJ5IGNhbGxpbmcgdGhpcyBmdW5jdGlvbi4KICAgICAgICAvLyBUaGlzICJ0cmFuc2ZlckZyb20icyB0b2tlbnMgZnJvbSB0aGUgb2xkIGFkZHJlc3NlcyB0byB0aGUgbmV3IHJlY3ljbGVCaW4gYWRkcmVzcwogICAgICAgIC8vIHdoaWNoIGlzIGEgbmV3IGFkZHJlc3Mgc2V0IHVwIG9uIHRoZSBvbGQgY29udHJhY3QuICBBZnRlcndoaWNoIG5ldyB0b2tlbnMgCiAgICAgICAgLy8gYXJlIGNyZWRpdGVkIHRvIHRoZSBvbGQgaG9sZGVyLiAgQWxzbyB0aGUgbGFzdFNuYXBTaG90IGlzIHNldCB0byAwIHRoZW4gCiAgICAgICAgLy8gY2FsY0NyZWRpdGVkIHBvaW50cyBhcmUgY2FsbGVkIHNldHRpbmcgdXAgdGhlIG5ldyBzaWduYXRvcmVlIGFsbCBvZiBoaXMgCiAgICAgICAgLy8gYWNjcnVlZCBkaXZpZGVuZHMuCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIGZ1bmN0aW9uIG9wdEluRnJvbUNsYXNzaWMoKSBwdWJsaWMKICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAob2xkRTQgPT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICAgICAgICAgICAgICBTdGF0RXZlbnQoImNvbmZpZyBlcnIiKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gMS4gY2hlY2sgYmFsYW5jZSBvZiBtc2cuc2VuZGVyIGluIG9sZCBjb250cmFjdC4KICAgICAgICAgICAgICAgIGFkZHJlc3MgbnJlcXVlc3RlciA9IG1zZy5zZW5kZXI7CgogICAgICAgICAgICAgICAgLy8gMi4gbWFrZSBzdXJlIGFjY291bnQgbm90IGFscmVhZHkgYWxsb2NkIChpbiBmYWN0LCBpdCdzIG9rIGlmIGl0J3MgYWxsb2NkLCBzbyBsb25nCiAgICAgICAgICAgICAgICAvLyBhcyBpdCBpcyBlbXB0eSBub3cuIHRoZSByZWFzb24gZm9yIHRoaXMgY2hlY2sgaXMgY3V6IHdlIGFyZSBnb2luZyB0byBjcmVkaXQgaGltIHdpdGgKICAgICAgICAgICAgICAgIC8vIGRpdmlkZW5kcywgYWNjb3JkaW5nIHRvIGhpcyB0b2tlbiBjb3VudCwgZnJvbSB0aGUgYmVnaW4gb2YgdGltZS4KICAgICAgICAgICAgICAgIGlmIChob2xkZXJBY2NvdW50c1tucmVxdWVzdGVyXS50b2tlbnMgIT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICBTdGF0RXZlbnQoIkFjY291bnQgaGFzIGFscmVhZHkgYmVlbiBhbGxvY2QhIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyAzLiBjaGVjayBoaXMgdG9rIGJhbGFuY2UKICAgICAgICAgICAgICAgIFRva2VuIGljbGFzc2ljID0gVG9rZW4ob2xkRTQpOwogICAgICAgICAgICAgICAgdWludCBfdG9rcyA9IGljbGFzc2ljLmJhbGFuY2VPZihucmVxdWVzdGVyKTsKICAgICAgICAgICAgICAgIGlmIChfdG9rcyA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFN0YXRFdmVudCgiTm90aGluZyB0byBkbyIpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gbXVzdCBiZSAxMDAgcGVyY2VudCBvZiBob2xkaW5ncwogICAgICAgICAgICAgICAgaWYgKGljbGFzc2ljLmFsbG93YW5jZShucmVxdWVzdGVyLCBhZGRyZXNzKHRoaXMpKSA8IF90b2tzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFN0YXRFdmVudCgiUGxlYXNlIGFwcHJvdmUgdGhpcyBjb250cmFjdCB0byB0cmFuc2ZlciIpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gNCwgdHJhbnNmZXIgaGlzIG9sZCB0b2tzIHRvIHJlY3lsZSBiaW4KICAgICAgICAgICAgICAgIGljbGFzc2ljLnRyYW5zZmVyRnJvbS5nYXMob3B0SW5HYXMpKG5yZXF1ZXN0ZXIsIG9sZEU0UmVjeWNsZUJpbiwgX3Rva3MpOwoKICAgICAgICAgICAgICAgIC8vIHRvZG8sIGVycm9yIGNoZWNrPwogICAgICAgICAgICAgICAgaWYgKGljbGFzc2ljLmJhbGFuY2VPZihucmVxdWVzdGVyKSA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN1Y2Nlc3MsIGFkZCB0aGUgYWNjb3VudCwgc2V0IHRoZSB0b2tlbnMsIHNldCBzbmFwc2hvdCB0byB6ZXJvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaG9sZGVyQWNjb3VudHNbbnJlcXVlc3Rlcl0uYWxsb2NlZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRBY2NvdW50KG5yZXF1ZXN0ZXIpOwogICAgICAgICAgICAgICAgICAgICAgICBob2xkZXJBY2NvdW50c1tucmVxdWVzdGVyXS50b2tlbnMgPSBfdG9rcyAqIE5ld1Rva2Vuc1Blck9yaWdUb2tlbjsKICAgICAgICAgICAgICAgICAgICAgICAgaG9sZGVyQWNjb3VudHNbbnJlcXVlc3Rlcl0ubGFzdFNuYXBzaG90ID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgY2FsY0N1clBvaW50c0ZvckFjY3QobnJlcXVlc3Rlcik7CiAgICAgICAgICAgICAgICAgICAgICAgIG51bVRva3NTd2l0Y2hlZE92ZXIgKz0gX3Rva3M7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vIG5lZWQgdG8gZGVjcmVtZW50IHBvaW50cyBmcm9tIGEgImhvbGRpbmcgYWNjb3VudCIKICAgICAgICAgICAgICAgICAgICAgICAgLy8gYi9jIHRoZXJlIGlzIG5vIG5lZWQgdG8ga2VlcCBpdC4KICAgICAgICAgICAgICAgICAgICAgICAgU3RhdEV2ZW50KCJTdWNjZXNzIFN3aXRjaGVkIE92ZXIiKTsKICAgICAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBTdGF0RXZlbnQoIlRyYW5zZmVyIEVycm9yISBwbGVhc2UgY29udGFjdCBEZXYgdGVhbSEiKTsKCgogICAgICAgIH0KCn0='.
	

]
