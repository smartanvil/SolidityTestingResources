Class {
	#name : #SRT89b5eaec2702ab0ff33ca397b3e66c7d925d5144,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT89b5eaec2702ab0ff33ca397b3e66c7d925d5144 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7Cgpjb250cmFjdCBTb2NjZXIgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogIC8qKiogRVZFTlRTICoqKi8KICAvLy8gQGRldiBUaGUgQmlydGggZXZlbnQgaXMgZmlyZWQgd2hlbmV2ZXIgYSBuZXcgY29sbGVjdGlibGUgY29tZXMgaW50byBleGlzdGVuY2UuCiAgZXZlbnQgQmlydGgodWludDI1NiB0b2tlbklkLCB1aW50MjU2IHN0YXJ0UHJpY2UpOwogIC8vLyBAZGV2IFRoZSBUb2tlblNvbGQgZXZlbnQgaXMgZmlyZWQgd2hlbmV2ZXIgYSB0b2tlbiBpcyBzb2xkLgogIGV2ZW50IFRva2VuU29sZCh1aW50MjU2IGluZGV4ZWQgdG9rZW5JZCwgdWludDI1NiBwcmljZSwgYWRkcmVzcyBwcmV2T3duZXIsIGFkZHJlc3Mgd2lubmVyKTsKICAvLyBFUkM3MjEgVHJhbnNmZXIKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHRva2VuSWQpOwogIC8vIEVSQzcyMSBBcHByb3ZhbAogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIGFwcHJvdmVkLCB1aW50MjU2IHRva2VuSWQpOwoKICAvKioqIENPTlNUQU5UUyAqKiovCgogIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgTkFNRSA9ICJTb2NjZXJBbGxTdGFycyI7CiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBTWU1CT0wgPSAiU0FTIjsKCiAgLyoqKiBTVE9SQUdFICoqKi8KICBzdHJ1Y3QgVG9rZW4gewogICAgYWRkcmVzcyBvd25lcjsKICAgIHVpbnQyNTYgcHJpY2U7CiAgfQogIG1hcHBpbmcgKHVpbnQyNTYgPT4gVG9rZW4pIGNvbGxlY3RpYmxlSWR4OwogIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzc1szXSkgbWFwVG9MYXN0T3duZXJzOwogIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgY29sbGVjdGlibGVJbmRleFRvQXBwcm92ZWQ7CiAgdWludDI1NltdIHByaXZhdGUgdG9rZW5zOwoKICAvLyBUaGUgYWRkcmVzc2VzIG9mIHRoZSBhY2NvdW50cyAob3IgY29udHJhY3RzKSB0aGF0IGNhbiBleGVjdXRlIGFjdGlvbnMgd2l0aGluIGVhY2ggcm9sZXMuCiAgYWRkcmVzcyBwdWJsaWMgY2VvQWRkcmVzczsKICBhZGRyZXNzIHB1YmxpYyBjb29BZGRyZXNzOwoKICB1aW50MTYgY29uc3RhbnQgTkFUSU9OX0lOREVYID0gMTAwMDsKICB1aW50MzIgY29uc3RhbnQgQ0xVQl9JTkRFWCA9IDEwMDAwMDA7CgogIHVpbnQyNTYgcHJpdmF0ZSBjb25zdGFudCBQUk9NT19DUkVBVElPTl9MSU1JVCA9IDUwMDAwOwogIHVpbnQyNTYgcHVibGljIHByb21vQ3JlYXRlZENvdW50OwoKICB1aW50MjU2IGNvbnN0YW50IFBMQVlFUl9QUklDRSA9IDEgZmlubmV5OwogIHVpbnQyNTYgY29uc3RhbnQgQ0xVQl9QUklDRSA9IDEwIGZpbm5leTsKICB1aW50MjU2IGNvbnN0YW50IE5BVElPTl9QUklDRSA9IDEwMCBmaW5uZXk7CgogIC8qKiogQ09OU1RSVUNUT1IgKioqLwogIGZ1bmN0aW9uIFNvY2NlcigpIHB1YmxpYyB7CiAgICBjZW9BZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgIGNvb0FkZHJlc3MgPSBtc2cuc2VuZGVyOwogIH0KICAKICBmdW5jdGlvbiBnZXRUb3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQpIHsKICAgIHJldHVybiB0b2tlbnMubGVuZ3RoOwogIH0KICAKICBmdW5jdGlvbiBnZXRJbml0aWFsUHJpY2VPZlRva2VuKHVpbnQgX3Rva2VuSWQpIHB1YmxpYyBwdXJlIHJldHVybnMgKHVpbnQpIHsKICAgIGlmIChfdG9rZW5JZCA+IENMVUJfSU5ERVgpCiAgICAgIHJldHVybiBQTEFZRVJfUFJJQ0U7CiAgICBpZiAoX3Rva2VuSWQgPiBOQVRJT05fSU5ERVgpCiAgICAgIHJldHVybiBDTFVCX1BSSUNFOwogICAgcmV0dXJuIE5BVElPTl9QUklDRTsKICB9CgogIGZ1bmN0aW9uIGdldE5leHRQcmljZSh1aW50IHByaWNlLCB1aW50IF90b2tlbklkKSBwdWJsaWMgcHVyZSByZXR1cm5zICh1aW50KSB7CiAgICBpZiAocHJpY2UgPCAwLjA1IGV0aGVyKQogICAgICByZXR1cm4gcHJpY2UubXVsKDIwMCkuZGl2KDkzKTsgLy94MgogICAgaWYgKHByaWNlIDwgMC41IGV0aGVyKQogICAgICByZXR1cm4gcHJpY2UubXVsKDE1MCkuZGl2KDkzKTsgLy94MS41CiAgICBpZiAocHJpY2UgPCAyIGV0aGVyKQogICAgICByZXR1cm4gcHJpY2UubXVsKDEzMCkuZGl2KDkzKTsgLy94MS4zCiAgICByZXR1cm4gcHJpY2UubXVsKDEyMCkuZGl2KDkzKTsgLy94MS4yCiAgfQoKICBmdW5jdGlvbiBidXlUb2tlbih1aW50IF90b2tlbklkKSBwdWJsaWMgcGF5YWJsZSB7CiAgICByZXF1aXJlKCFpc0NvbnRyYWN0KG1zZy5zZW5kZXIpKTsKICAgIAogICAgVG9rZW4gbWVtb3J5IHRva2VuID0gY29sbGVjdGlibGVJZHhbX3Rva2VuSWRdOwogICAgYWRkcmVzcyBvbGRPd25lciA9IGFkZHJlc3MoMCk7CiAgICB1aW50MjU2IHNlbGxpbmdQcmljZTsKICAgIGlmICh0b2tlbi5vd25lciA9PSBhZGRyZXNzKDApKSB7CiAgICAgICAgc2VsbGluZ1ByaWNlID0gZ2V0SW5pdGlhbFByaWNlT2ZUb2tlbihfdG9rZW5JZCk7CiAgICAgICAgdG9rZW4gPSBUb2tlbih7CiAgICAgICAgICAgIG93bmVyOiBtc2cuc2VuZGVyLAogICAgICAgICAgICBwcmljZTogc2VsbGluZ1ByaWNlCiAgICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICAgIG9sZE93bmVyID0gdG9rZW4ub3duZXI7CiAgICAgICAgc2VsbGluZ1ByaWNlID0gdG9rZW4ucHJpY2U7CiAgICAgICAgcmVxdWlyZShvbGRPd25lciAhPSBtc2cuc2VuZGVyKTsKICAgIH0KICAgIHJlcXVpcmUobXNnLnZhbHVlID49IHNlbGxpbmdQcmljZSk7CiAgICAKICAgIGFkZHJlc3NbM10gc3RvcmFnZSBsYXN0T3duZXJzID0gbWFwVG9MYXN0T3duZXJzW190b2tlbklkXTsKICAgIHVpbnQyNTYgcGF5bWVudCA9IF9oYW5kbGUoX3Rva2VuSWQsIHNlbGxpbmdQcmljZSwgbGFzdE93bmVycyk7CgogICAgLy8gVHJhbnNmZXJzIHRoZSBUb2tlbgogICAgdG9rZW4ub3duZXIgPSBtc2cuc2VuZGVyOwogICAgdG9rZW4ucHJpY2UgPSBnZXROZXh0UHJpY2Uoc2VsbGluZ1ByaWNlLCBfdG9rZW5JZCk7CiAgICBtYXBUb0xhc3RPd25lcnNbX3Rva2VuSWRdID0gX2FkZExhc3RPd25lcihsYXN0T3duZXJzLCBvbGRPd25lcik7CgogICAgY29sbGVjdGlibGVJZHhbX3Rva2VuSWRdID0gdG9rZW47CiAgICBpZiAob2xkT3duZXIgIT0gYWRkcmVzcygwKSkgewogICAgICAvLyBQYXltZW50IGZvciBvbGQgb3duZXIKICAgICAgb2xkT3duZXIudHJhbnNmZXIocGF5bWVudCk7CiAgICAgIC8vIGNsZWFyIGFueSBwcmV2aW91c2x5IGFwcHJvdmVkIG93bmVyc2hpcCBleGNoYW5nZQogICAgICBkZWxldGUgY29sbGVjdGlibGVJbmRleFRvQXBwcm92ZWRbX3Rva2VuSWRdOwogICAgfSBlbHNlIHsKICAgICAgQmlydGgoX3Rva2VuSWQsIHNlbGxpbmdQcmljZSk7CiAgICAgIHRva2Vucy5wdXNoKF90b2tlbklkKTsKICAgIH0KCiAgICBUb2tlblNvbGQoX3Rva2VuSWQsIHNlbGxpbmdQcmljZSwgb2xkT3duZXIsIG1zZy5zZW5kZXIpOwogICAgVHJhbnNmZXIob2xkT3duZXIsIG1zZy5zZW5kZXIsIF90b2tlbklkKTsKCiAgICAvLyByZWZ1bmQgd2hlbiBwYWlkIHRvbyBtdWNoCiAgICB1aW50MjU2IHB1cmNoYXNlRXhjZXNzID0gbXNnLnZhbHVlLnN1YihzZWxsaW5nUHJpY2UpOwogICAgaWYgKHB1cmNoYXNlRXhjZXNzID4gMCkgewogICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIocHVyY2hhc2VFeGNlc3MpOwogICAgfQogIH0KCmZ1bmN0aW9uIF9oYW5kbGUodWludDI1NiBfdG9rZW5JZCwgdWludDI1NiBzZWxsaW5nUHJpY2UsIGFkZHJlc3NbM10gbGFzdE93bmVycykgcHJpdmF0ZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IHBQcmljZSA9IHNlbGxpbmdQcmljZS5kaXYoMTAwKTsKICAgIHVpbnQyNTYgdGF4ID0gcFByaWNlLm11bCg3KTsgLy8gaW5pdGlhbCBkZXYgY3V0ID0gNyUKICAgIGlmIChfdG9rZW5JZCA+IENMVUJfSU5ERVgpIHsKICAgICAgICB1aW50MjU2IGNsdWJJZCA9IF90b2tlbklkICUgQ0xVQl9JTkRFWDsKICAgICAgICBUb2tlbiBzdG9yYWdlIGNsdWJUb2tlbiA9IGNvbGxlY3RpYmxlSWR4W2NsdWJJZF07CiAgICAgICAgaWYgKGNsdWJUb2tlbi5vd25lciAhPSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIHVpbnQyNTYgY2x1YlRheCA9IHBQcmljZS5tdWwoMik7IC8vIDIlIGNsdWIgdGF4OwogICAgICAgICAgICB0YXggKz0gY2x1YlRheDsKICAgICAgICAgICAgY2x1YlRva2VuLm93bmVyLnRyYW5zZmVyKGNsdWJUYXgpOwogICAgICAgIH0KCiAgICAgICAgdWludDI1NiBuYXRpb25JZCA9IGNsdWJJZCAlIE5BVElPTl9JTkRFWDsKICAgICAgICBUb2tlbiBzdG9yYWdlIG5hdGlvblRva2VuID0gY29sbGVjdGlibGVJZHhbbmF0aW9uSWRdOwogICAgICAgIGlmIChuYXRpb25Ub2tlbi5vd25lciAhPSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIHRheCArPSBwUHJpY2U7IC8vIDElIG5hdGlvbiB0YXg7CiAgICAgICAgICAgIG5hdGlvblRva2VuLm93bmVyLnRyYW5zZmVyKHBQcmljZSk7CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChfdG9rZW5JZCA+IE5BVElPTl9JTkRFWCkgewogICAgICAgIG5hdGlvbklkID0gX3Rva2VuSWQgJSBOQVRJT05fSU5ERVg7CiAgICAgICAgbmF0aW9uVG9rZW4gPSBjb2xsZWN0aWJsZUlkeFtuYXRpb25JZF07CiAgICAgICAgaWYgKG5hdGlvblRva2VuLm93bmVyICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgdGF4ICs9IHBQcmljZTsgLy8gMSUgbmF0aW9uIHRheDsKICAgICAgICAgICAgbmF0aW9uVG9rZW4ub3duZXIudHJhbnNmZXIocFByaWNlKTsKICAgICAgICB9CiAgICB9CgogICAgLy9QYXkgdGF4IHRvIHRoZSBwcmV2aW91cyAzIG93bmVycwogICAgdWludDI1NiBsYXN0T3duZXJUYXg7CiAgICBpZiAobGFzdE93bmVyc1swXSAhPSBhZGRyZXNzKDApKSB7CiAgICAgIHRheCArPSBwUHJpY2U7IC8vIDElIDNyZCBwYXltZW50CiAgICAgIGxhc3RPd25lcnNbMF0udHJhbnNmZXIocFByaWNlKTsKICAgIH0KICAgIGlmIChsYXN0T3duZXJzWzFdICE9IGFkZHJlc3MoMCkpIHsKICAgICAgbGFzdE93bmVyVGF4ID0gcFByaWNlLm11bCgyKTsgLy8gMiUgMm5kIHBheW1lbnQKICAgICAgdGF4ICs9IGxhc3RPd25lclRheDsKICAgICAgbGFzdE93bmVyc1sxXS50cmFuc2ZlcihsYXN0T3duZXJUYXgpOwogICAgfQogICAgaWYgKGxhc3RPd25lcnNbMl0gIT0gYWRkcmVzcygwKSkgewogICAgICBsYXN0T3duZXJUYXggPSBwUHJpY2UubXVsKDMpOyAvLyAzJSAxc3QgcGF5bWVudAogICAgICB0YXggKz0gbGFzdE93bmVyVGF4OwogICAgICBsYXN0T3duZXJzWzJdLnRyYW5zZmVyKGxhc3RPd25lclRheCk7CiAgICB9CgogICAgcmV0dXJuIHNlbGxpbmdQcmljZS5zdWIodGF4KTsKfQoKZnVuY3Rpb24gX2FkZExhc3RPd25lcihhZGRyZXNzWzNdIGxhc3RPd25lcnMsIGFkZHJlc3Mgb2xkT3duZXIpIHB1cmUgcHJpdmF0ZSByZXR1cm5zIChhZGRyZXNzWzNdKSB7CiAgICBsYXN0T3duZXJzWzBdID0gbGFzdE93bmVyc1sxXTsKICAgIGxhc3RPd25lcnNbMV0gPSBsYXN0T3duZXJzWzJdOwogICAgbGFzdE93bmVyc1syXSA9IG9sZE93bmVyOwogICAgcmV0dXJuIGxhc3RPd25lcnM7Cn0KICAvKioqIEFDQ0VTUyBNT0RJRklFUlMgKioqLwogIC8vLyBAZGV2IEFjY2VzcyBtb2RpZmllciBmb3IgQ0VPLW9ubHkgZnVuY3Rpb25hbGl0eQogIG1vZGlmaWVyIG9ubHlDRU8oKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY2VvQWRkcmVzcyk7CiAgICBfOwogIH0KCiAgLy8vIEBkZXYgQWNjZXNzIG1vZGlmaWVyIGZvciBDT08tb25seSBmdW5jdGlvbmFsaXR5CiAgbW9kaWZpZXIgb25seUNPTygpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjb29BZGRyZXNzKTsKICAgIF87CiAgfQoKICAvLy8gQWNjZXNzIG1vZGlmaWVyIGZvciBjb250cmFjdCBvd25lciBvbmx5IGZ1bmN0aW9uYWxpdHkKICBtb2RpZmllciBvbmx5Q0xldmVsKCkgewogICAgcmVxdWlyZSggbXNnLnNlbmRlciA9PSBjZW9BZGRyZXNzIHx8IG1zZy5zZW5kZXIgPT0gY29vQWRkcmVzcyApOwogICAgXzsKICB9CgogIC8qKiogUFVCTElDIEZVTkNUSU9OUyAqKiovCiAgLy8vIEBub3RpY2UgR3JhbnQgYW5vdGhlciBhZGRyZXNzIHRoZSByaWdodCB0byB0cmFuc2ZlciB0b2tlbiB2aWEgdGFrZU93bmVyc2hpcCgpIGFuZCB0cmFuc2ZlckZyb20oKS4KICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byBiZSBncmFudGVkIHRyYW5zZmVyIGFwcHJvdmFsLiBQYXNzIGFkZHJlc3MoMCkgdG8KICAvLy8gIGNsZWFyIGFsbCBhcHByb3ZhbHMuCiAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgSUQgb2YgdGhlIFRva2VuIHRoYXQgY2FuIGJlIHRyYW5zZmVycmVkIGlmIHRoaXMgY2FsbCBzdWNjZWVkcy4KICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB7CiAgICAvLyBDYWxsZXIgbXVzdCBvd24gdG9rZW4uCiAgICByZXF1aXJlKF9vd25zKG1zZy5zZW5kZXIsIF90b2tlbklkKSk7CgogICAgY29sbGVjdGlibGVJbmRleFRvQXBwcm92ZWRbX3Rva2VuSWRdID0gX3RvOwoKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF90bywgX3Rva2VuSWQpOwogIH0KCiAgLy8vIEBkZXYgQ3JlYXRlcyBhIG5ldyBwcm9tbyBjb2xsZWN0aWJsZSB3aXRoIHRoZSBnaXZlbiBuYW1lLCB3aXRoIGdpdmVuIF9wcmljZSBhbmQgYXNzaWduZXMgaXQgdG8gYW4gYWRkcmVzcy4KICBmdW5jdGlvbiBjcmVhdGVQcm9tb0NvbGxlY3RpYmxlKHVpbnQyNTYgdG9rZW5JZCwgYWRkcmVzcyBfb3duZXIsIHVpbnQyNTYgX3ByaWNlKSBwdWJsaWMgb25seUNMZXZlbCB7CiAgICBUb2tlbiBtZW1vcnkgdG9rZW4gPSBjb2xsZWN0aWJsZUlkeFt0b2tlbklkXTsKICAgIHJlcXVpcmUodG9rZW4ub3duZXIgPT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKHByb21vQ3JlYXRlZENvdW50IDwgUFJPTU9fQ1JFQVRJT05fTElNSVQpOwoKICAgIGFkZHJlc3MgY29sbGVjdGlibGVPd25lciA9IF9vd25lcjsKICAgIGlmIChjb2xsZWN0aWJsZU93bmVyID09IGFkZHJlc3MoMCkpIHsKICAgICAgY29sbGVjdGlibGVPd25lciA9IGNvb0FkZHJlc3M7CiAgICB9CgogICAgaWYgKF9wcmljZSA8PSAwKSB7CiAgICAgIF9wcmljZSA9IGdldEluaXRpYWxQcmljZU9mVG9rZW4odG9rZW5JZCk7CiAgICB9CgogICAgcHJvbW9DcmVhdGVkQ291bnQrKzsKICAgIHRva2VuID0gVG9rZW4oewogICAgICAgIG93bmVyOiBjb2xsZWN0aWJsZU93bmVyLAogICAgICAgIHByaWNlOiBfcHJpY2UKICAgIH0pOwogICAgY29sbGVjdGlibGVJZHhbdG9rZW5JZF0gPSB0b2tlbjsKICAgIEJpcnRoKHRva2VuSWQsIF9wcmljZSk7CiAgICB0b2tlbnMucHVzaCh0b2tlbklkKTsKCiAgICAvLyBUaGlzIHdpbGwgYXNzaWduIG93bmVyc2hpcCwgYW5kIGFsc28gZW1pdCB0aGUgVHJhbnNmZXIgZXZlbnQgYXMKICAgIC8vIHBlciBFUkM3MjEgZHJhZnQKICAgIF90cmFuc2ZlcihhZGRyZXNzKDApLCBjb2xsZWN0aWJsZU93bmVyLCB0b2tlbklkKTsKCiAgfQoKICBib29sIGlzQ2hhbmdlUHJpY2VMb2NrZWQgPSBmYWxzZTsKICAvLyBhbGxvd3Mgb3duZXJzIG9mIHRva2VucyB0byBkZWNyZWFzZSB0aGUgcHJpY2Ugb2YgdGhlbSBvciBpZiB0aGVyZSBpcyBubyBvd25lciB0aGUgY29vIGNhbiBkbyBpdAogIGZ1bmN0aW9uIGNoYW5nZVByaWNlKHVpbnQyNTYgX3Rva2VuSWQsIHVpbnQyNTYgbmV3UHJpY2UpIHB1YmxpYyB7CiAgICByZXF1aXJlKChfb3ducyhtc2cuc2VuZGVyLCBfdG9rZW5JZCkgJiYgIWlzQ2hhbmdlUHJpY2VMb2NrZWQpIHx8IChfb3ducyhhZGRyZXNzKDApLCBfdG9rZW5JZCkgJiYgbXNnLnNlbmRlciA9PSBjb29BZGRyZXNzKSk7CiAgICBUb2tlbiBzdG9yYWdlIHRva2VuID0gY29sbGVjdGlibGVJZHhbX3Rva2VuSWRdOwogICAgcmVxdWlyZShuZXdQcmljZSA8IHRva2VuLnByaWNlKTsKICAgIHRva2VuLnByaWNlID0gbmV3UHJpY2U7CiAgICBjb2xsZWN0aWJsZUlkeFtfdG9rZW5JZF0gPSB0b2tlbjsKICB9CiAgZnVuY3Rpb24gdW5sb2NrUHJpY2VDaGFuZ2UoKSBwdWJsaWMgb25seUNMZXZlbCB7CiAgICBpc0NoYW5nZVByaWNlTG9ja2VkID0gZmFsc2U7CiAgfQogIGZ1bmN0aW9uIGxvY2tQcmljZUNoYW5nZSgpIHB1YmxpYyBvbmx5Q0xldmVsIHsKICAgIGlzQ2hhbmdlUHJpY2VMb2NrZWQgPSB0cnVlOwogIH0KCiAgLy8vIEBub3RpY2UgUmV0dXJucyBhbGwgdGhlIHJlbGV2YW50IGluZm9ybWF0aW9uIGFib3V0IGEgc3BlY2lmaWMgY29sbGVjdGlibGUuCiAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgdG9rZW5JZCBvZiB0aGUgY29sbGVjdGlibGUgb2YgaW50ZXJlc3QuCiAgZnVuY3Rpb24gZ2V0VG9rZW4odWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiB0b2tlbklkLCB1aW50MjU2IHNlbGxpbmdQcmljZSwgYWRkcmVzcyBvd25lciwgdWludDI1NiBuZXh0U2VsbGluZ1ByaWNlKSB7CiAgICB0b2tlbklkID0gX3Rva2VuSWQ7CiAgICBUb2tlbiBzdG9yYWdlIHRva2VuID0gY29sbGVjdGlibGVJZHhbX3Rva2VuSWRdOwogICAgc2VsbGluZ1ByaWNlID0gdG9rZW4ucHJpY2U7CiAgICBpZiAoc2VsbGluZ1ByaWNlID09IDApCiAgICAgIHNlbGxpbmdQcmljZSA9IGdldEluaXRpYWxQcmljZU9mVG9rZW4oX3Rva2VuSWQpOwogICAgb3duZXIgPSB0b2tlbi5vd25lcjsKICAgIG5leHRTZWxsaW5nUHJpY2UgPSBnZXROZXh0UHJpY2Uoc2VsbGluZ1ByaWNlLCBfdG9rZW5JZCk7CiAgfQoKICBmdW5jdGlvbiBpbXBsZW1lbnRzRVJDNzIxKCkgcHVibGljIHB1cmUgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgcHVyZSByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBOQU1FOwogIH0KCiAgLy8vIEZvciBxdWVyeWluZyBvd25lciBvZiB0b2tlbgogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIHRva2VuSUQgZm9yIG93bmVyIGlucXVpcnkKICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkKICAgIHB1YmxpYwogICAgdmlldwogICAgcmV0dXJucyAoYWRkcmVzcyBvd25lcikKICB7CiAgICBUb2tlbiBzdG9yYWdlIHRva2VuID0gY29sbGVjdGlibGVJZHhbX3Rva2VuSWRdOwogICAgcmVxdWlyZSh0b2tlbi5vd25lciAhPSBhZGRyZXNzKDApKTsKICAgIG93bmVyID0gdG9rZW4ub3duZXI7CiAgfQoKICBmdW5jdGlvbiBwYXlvdXQoYWRkcmVzcyBfdG8pIHB1YmxpYyBvbmx5Q0xldmVsIHsKICAgIF9wYXlvdXQoX3RvKTsKICB9CgoKICBmdW5jdGlvbiBwcmljZU9mKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgcHJpY2UpIHsKICAgIFRva2VuIHN0b3JhZ2UgdG9rZW4gPSBjb2xsZWN0aWJsZUlkeFtfdG9rZW5JZF07CiAgICBpZiAodG9rZW4ub3duZXIgPT0gYWRkcmVzcygwKSkgewogICAgICAgIHByaWNlID0gZ2V0SW5pdGlhbFByaWNlT2ZUb2tlbihfdG9rZW5JZCk7CiAgICB9IGVsc2UgewogICAgICAgIHByaWNlID0gdG9rZW4ucHJpY2U7CiAgICB9CiAgfQoKICAvLy8gQGRldiBBc3NpZ25zIGEgbmV3IGFkZHJlc3MgdG8gYWN0IGFzIHRoZSBDRU8uIE9ubHkgYXZhaWxhYmxlIHRvIHRoZSBjdXJyZW50IENFTy4KICAvLy8gQHBhcmFtIF9uZXdDRU8gVGhlIGFkZHJlc3Mgb2YgdGhlIG5ldyBDRU8KICBmdW5jdGlvbiBzZXRDRU8oYWRkcmVzcyBfbmV3Q0VPKSBwdWJsaWMgb25seUNFTyB7CiAgICByZXF1aXJlKF9uZXdDRU8gIT0gYWRkcmVzcygwKSk7CgogICAgY2VvQWRkcmVzcyA9IF9uZXdDRU87CiAgfQoKICAvLy8gQGRldiBBc3NpZ25zIGEgbmV3IGFkZHJlc3MgdG8gYWN0IGFzIHRoZSBDT08uIE9ubHkgYXZhaWxhYmxlIHRvIHRoZSBjdXJyZW50IENPTy4KICAvLy8gQHBhcmFtIF9uZXdDT08gVGhlIGFkZHJlc3Mgb2YgdGhlIG5ldyBDT08KICBmdW5jdGlvbiBzZXRDT08oYWRkcmVzcyBfbmV3Q09PKSBwdWJsaWMgb25seUNFTyB7CiAgICByZXF1aXJlKF9uZXdDT08gIT0gYWRkcmVzcygwKSk7CgogICAgY29vQWRkcmVzcyA9IF9uZXdDT087CiAgfQoKICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyBwdXJlIHJldHVybnMgKHN0cmluZykgewogICAgcmV0dXJuIFNZTUJPTDsKICB9CgogIC8vLyBAbm90aWNlIEFsbG93IHByZS1hcHByb3ZlZCB1c2VyIHRvIHRha2Ugb3duZXJzaGlwIG9mIGEgdG9rZW4KICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSBJRCBvZiB0aGUgVG9rZW4gdGhhdCBjYW4gYmUgdHJhbnNmZXJyZWQgaWYgdGhpcyBjYWxsIHN1Y2NlZWRzLgogIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgZnVuY3Rpb24gdGFrZU93bmVyc2hpcCh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgewogICAgYWRkcmVzcyBuZXdPd25lciA9IG1zZy5zZW5kZXI7CiAgICBUb2tlbiBzdG9yYWdlIHRva2VuID0gY29sbGVjdGlibGVJZHhbX3Rva2VuSWRdOwogICAgcmVxdWlyZSh0b2tlbi5vd25lciAhPSBhZGRyZXNzKDApKTsKICAgIGFkZHJlc3Mgb2xkT3duZXIgPSB0b2tlbi5vd25lcjsKCiAgICAvLyBTYWZldHkgY2hlY2sgdG8gcHJldmVudCBhZ2FpbnN0IGFuIHVuZXhwZWN0ZWQgMHgwIGRlZmF1bHQuCiAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChuZXdPd25lcikpOwoKICAgIC8vIE1ha2luZyBzdXJlIHRyYW5zZmVyIGlzIGFwcHJvdmVkCiAgICByZXF1aXJlKF9hcHByb3ZlZChuZXdPd25lciwgX3Rva2VuSWQpKTsKCiAgICBfdHJhbnNmZXIob2xkT3duZXIsIG5ld093bmVyLCBfdG9rZW5JZCk7CiAgfQoKICAvLy8gT3duZXIgaW5pdGF0ZXMgdGhlIHRyYW5zZmVyIG9mIHRoZSB0b2tlbiB0byBhbm90aGVyIGFjY291bnQKICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBmb3IgdGhlIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkIHRvLgogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIElEIG9mIHRoZSBUb2tlbiB0aGF0IGNhbiBiZSB0cmFuc2ZlcnJlZCBpZiB0aGlzIGNhbGwgc3VjY2VlZHMuCiAgLy8vIEBkZXYgUmVxdWlyZWQgZm9yIEVSQy03MjEgY29tcGxpYW5jZS4KICBmdW5jdGlvbiB0cmFuc2ZlcigKICAgIGFkZHJlc3MgX3RvLAogICAgdWludDI1NiBfdG9rZW5JZAogICkgcHVibGljIHsKICAgIHJlcXVpcmUoX293bnMobXNnLnNlbmRlciwgX3Rva2VuSWQpKTsKICAgIHJlcXVpcmUoX2FkZHJlc3NOb3ROdWxsKF90bykpOwoKICAgIF90cmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF90b2tlbklkKTsKICB9CgogIC8vLyBUaGlyZC1wYXJ0eSBpbml0aWF0ZXMgdHJhbnNmZXIgb2YgdG9rZW4gZnJvbSBhZGRyZXNzIF9mcm9tIHRvIGFkZHJlc3MgX3RvCiAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBmb3IgdGhlIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkIGZyb20uCiAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgZm9yIHRoZSB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZCB0by4KICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSBJRCBvZiB0aGUgVG9rZW4gdGhhdCBjYW4gYmUgdHJhbnNmZXJyZWQgaWYgdGhpcyBjYWxsIHN1Y2NlZWRzLgogIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKAogICAgYWRkcmVzcyBfZnJvbSwKICAgIGFkZHJlc3MgX3RvLAogICAgdWludDI1NiBfdG9rZW5JZAogICkgcHVibGljIHsKICAgIHJlcXVpcmUoX293bnMoX2Zyb20sIF90b2tlbklkKSk7CiAgICByZXF1aXJlKF9hcHByb3ZlZChfdG8sIF90b2tlbklkKSk7CiAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChfdG8pKTsKCiAgICBfdHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogIH0KCiAgLyoqKiBQUklWQVRFIEZVTkNUSU9OUyAqKiovCiAgLy8vIFNhZmV0eSBjaGVjayBvbiBfdG8gYWRkcmVzcyB0byBwcmV2ZW50IGFnYWluc3QgYW4gdW5leHBlY3RlZCAweDAgZGVmYXVsdC4KICBmdW5jdGlvbiBfYWRkcmVzc05vdE51bGwoYWRkcmVzcyBfdG8pIHByaXZhdGUgcHVyZSByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gX3RvICE9IGFkZHJlc3MoMCk7CiAgfQoKICAvLy8gRm9yIGNoZWNraW5nIGFwcHJvdmFsIG9mIHRyYW5zZmVyIGZvciBhZGRyZXNzIF90bwogIGZ1bmN0aW9uIF9hcHByb3ZlZChhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBjb2xsZWN0aWJsZUluZGV4VG9BcHByb3ZlZFtfdG9rZW5JZF0gPT0gX3RvOwogIH0KCiAgLy8vIENoZWNrIGZvciB0b2tlbiBvd25lcnNoaXAKICBmdW5jdGlvbiBfb3ducyhhZGRyZXNzIGNsYWltYW50LCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgVG9rZW4gc3RvcmFnZSB0b2tlbiA9IGNvbGxlY3RpYmxlSWR4W190b2tlbklkXTsKICAgIHJldHVybiBjbGFpbWFudCA9PSB0b2tlbi5vd25lcjsKICB9CgogIC8vLyBGb3IgcGF5aW5nIG91dCBiYWxhbmNlIG9uIGNvbnRyYWN0CiAgZnVuY3Rpb24gX3BheW91dChhZGRyZXNzIF90bykgcHJpdmF0ZSB7CiAgICBpZiAoX3RvID09IGFkZHJlc3MoMCkpIHsKICAgICAgY2VvQWRkcmVzcy50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgfSBlbHNlIHsKICAgICAgX3RvLnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgICB9CiAgfQoKICAvLy8gRm9yIHF1ZXJ5aW5nIGJhbGFuY2Ugb2YgYSBwYXJ0aWN1bGFyIGFjY291bnQKICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBmb3IgYmFsYW5jZSBxdWVyeQogIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHJlc3VsdCkgewogICAgICB1aW50MjU2IHRvdGFsVG9rZW5zID0gdG9rZW5zLmxlbmd0aDsKICAgICAgdWludDI1NiB0b2tlbkluZGV4OwogICAgICB1aW50MjU2IHRva2VuSWQ7CiAgICAgIHJlc3VsdCA9IDA7CiAgICAgIGZvciAodG9rZW5JbmRleCA9IDA7IHRva2VuSW5kZXggPCB0b3RhbFRva2VuczsgdG9rZW5JbmRleCsrKSB7CiAgICAgICAgdG9rZW5JZCA9IHRva2Vuc1t0b2tlbkluZGV4XTsKICAgICAgICBpZiAoY29sbGVjdGlibGVJZHhbdG9rZW5JZF0ub3duZXIgPT0gX293bmVyKSB7CiAgICAgICAgICByZXN1bHQgPSByZXN1bHQuYWRkKDEpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogIH0KCiAgLy8vIEBkZXYgQXNzaWducyBvd25lcnNoaXAgb2YgYSBzcGVjaWZpYyBDb2xsZWN0aWJsZSB0byBhbiBhZGRyZXNzLgogIGZ1bmN0aW9uIF90cmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB7CiAgICAvL3RyYW5zZmVyIG93bmVyc2hpcAogICAgY29sbGVjdGlibGVJZHhbX3Rva2VuSWRdLm93bmVyID0gX3RvOwoKICAgIC8vIFdoZW4gY3JlYXRpbmcgbmV3IGNvbGxlY3RpYmxlcyBfZnJvbSBpcyAweDAsIGJ1dCB3ZSBjYW4ndCBhY2NvdW50IHRoYXQgYWRkcmVzcy4KICAgIGlmIChfZnJvbSAhPSBhZGRyZXNzKDApKSB7CiAgICAgIC8vIGNsZWFyIGFueSBwcmV2aW91c2x5IGFwcHJvdmVkIG93bmVyc2hpcCBleGNoYW5nZQogICAgICBkZWxldGUgY29sbGVjdGlibGVJbmRleFRvQXBwcm92ZWRbX3Rva2VuSWRdOwogICAgfQoKICAgIC8vIEVtaXQgdGhlIHRyYW5zZmVyIGV2ZW50LgogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogIH0KCgogICAvLy8gQHBhcmFtIF9vd25lciBUaGUgb3duZXIgd2hvc2UgY2VsZWJyaXR5IHRva2VucyB3ZSBhcmUgaW50ZXJlc3RlZCBpbi4KICAvLy8gQGRldiBUaGlzIG1ldGhvZCBNVVNUIE5FVkVSIGJlIGNhbGxlZCBieSBzbWFydCBjb250cmFjdCBjb2RlLiBGaXJzdCwgaXQncyBmYWlybHkKICAvLy8gIGV4cGVuc2l2ZSAoaXQgd2Fsa3MgdGhlIGVudGlyZSB0b2tlbnMgYXJyYXkgbG9va2luZyBmb3IgdG9rZW5zIGJlbG9uZ2luZyB0byBvd25lciksCiAgLy8vICBidXQgaXQgYWxzbyByZXR1cm5zIGEgZHluYW1pYyBhcnJheSwgd2hpY2ggaXMgb25seSBzdXBwb3J0ZWQgZm9yIHdlYjMgY2FsbHMsIGFuZAogIC8vLyAgbm90IGNvbnRyYWN0LXRvLWNvbnRyYWN0IGNhbGxzLgogIGZ1bmN0aW9uIHRva2Vuc09mT3duZXIoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnModWludDI1NltdIG93bmVyVG9rZW5zKSB7CiAgICB1aW50MjU2IHRva2VuQ291bnQgPSBiYWxhbmNlT2YoX293bmVyKTsKICAgIGlmICh0b2tlbkNvdW50ID09IDApIHsKICAgICAgICAvLyBSZXR1cm4gYW4gZW1wdHkgYXJyYXkKICAgICAgcmV0dXJuIG5ldyB1aW50MjU2W10oMCk7CiAgICB9IGVsc2UgewogICAgICB1aW50MjU2W10gbWVtb3J5IHJlc3VsdCA9IG5ldyB1aW50MjU2W10odG9rZW5Db3VudCk7CiAgICAgIHVpbnQyNTYgdG90YWxUb2tlbnMgPSBnZXRUb3RhbFN1cHBseSgpOwogICAgICB1aW50MjU2IHJlc3VsdEluZGV4ID0gMDsKCiAgICAgIHVpbnQyNTYgdG9rZW5JbmRleDsKICAgICAgdWludDI1NiB0b2tlbklkOwogICAgICBmb3IgKHRva2VuSW5kZXggPSAwOyB0b2tlbkluZGV4IDwgdG90YWxUb2tlbnM7IHRva2VuSW5kZXgrKykgewogICAgICAgIHRva2VuSWQgPSB0b2tlbnNbdG9rZW5JbmRleF07CiAgICAgICAgaWYgKGNvbGxlY3RpYmxlSWR4W3Rva2VuSWRdLm93bmVyID09IF9vd25lcikgewogICAgICAgICAgcmVzdWx0W3Jlc3VsdEluZGV4XSA9IHRva2VuSWQ7CiAgICAgICAgICByZXN1bHRJbmRleCA9IHJlc3VsdEluZGV4LmFkZCgxKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICB9CgogICAgLyogVXRpbCAqLwogIGZ1bmN0aW9uIGlzQ29udHJhY3QoYWRkcmVzcyBhZGRyKSBwcml2YXRlIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgdWludCBzaXplOwogICAgYXNzZW1ibHkgeyBzaXplIDo9IGV4dGNvZGVzaXplKGFkZHIpIH0gLy8gc29saXVtLWRpc2FibGUtbGluZQogICAgcmV0dXJuIHNpemUgPiAwOwogIH0KfQoKCgpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQ=='.
	

]
