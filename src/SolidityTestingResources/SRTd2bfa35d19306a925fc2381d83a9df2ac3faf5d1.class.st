Class {
	#name : #SRTd2bfa35d19306a925fc2381d83a9df2ac3faf5d1,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd2bfa35d19306a925fc2381d83a9df2ac3faf5d1 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTY7CgoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgICAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgICAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgYXNzZXJ0KGIgPD0gYSk7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSk7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9Cn0KCgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHkgPSA5MDAwMDAwMCAqIDEwICoqIDE4OwoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKCi8qKgogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKi8KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CgogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgICAvKioKICAgICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICAgKi8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogICAgfQoKfQoKCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCgogICAgLyoqCiAgICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CgogICAgICAgIHVpbnQyNTYgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOwoKICAgICAgICAvLyBDaGVjayBpcyBub3QgbmVlZGVkIGJlY2F1c2Ugc3ViKF9hbGxvd2FuY2UsIF92YWx1ZSkgd2lsbCBhbHJlYWR5IHRocm93IGlmIHRoaXMgY29uZGl0aW9uIGlzIG5vdCBtZXQKICAgICAgICAvLyByZXF1aXJlIChfdmFsdWUgPD0gX2FsbG93YW5jZSk7CgogICAgICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAgICoKICAgICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgICAqIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZSB0cmFuc2FjdGlvbiBvcmRlcmluZy4gT25lIHBvc3NpYmxlIHNvbHV0aW9uIHRvIG1pdGlnYXRlIHRoaXMKICAgICAqIHJhY2UgY29uZGl0aW9uIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUgYWZ0ZXJ3YXJkczoKICAgICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgICB9CgogICAgLyoqCiAgICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAgICovCiAgICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkKICAgIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICAgICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgICAgICB9CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCn0KCgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CgogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgogICAgLyoqCiAgICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgICAqIGFjY291bnQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgICAqLwogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICB9Cn0KCgovKgogKiBDaGFyZ0NvaW5Db250cmFjdAogKgogKiBTaW1wbGUgRVJDMjAgVG9rZW4gZXhhbXBsZSwgd2l0aCBjcm93ZHNhbGUgdG9rZW4gY3JlYXRpb24KICovCmNvbnRyYWN0IENoYXJnQ29pbkNvbnRyYWN0IGlzIFN0YW5kYXJkVG9rZW4sIE93bmFibGUgewoKICAgIHN0cmluZyBwdWJsaWMgc3RhbmRhcmQgPSAiQ0hHIjsKICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICJDaGFyZyBDb2luIjsKICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIkNIRyI7CgogICAgdWludCBwdWJsaWMgZGVjaW1hbHMgPSAxODsKCiAgICBhZGRyZXNzIHB1YmxpYyBtdWx0aXNpZyA9IDB4NDgyRUZkNDQ3YkU4ODc0OGU3NjI1ZTJiN2M1MjJjMzg4OTcwQjc5MDsKCiAgICBzdHJ1Y3QgQ2hhcmdpbmdEYXRhIHsKICAgIGFkZHJlc3Mgbm9kZTsKICAgIHVpbnQgc3RhcnRUaW1lOwogICAgdWludCBlbmRUaW1lOwogICAgdWludDI1NiBmaXhlZFJhdGU7CiAgICBib29sIGluaXRpYWxpemVkOwogICAgdWludDI1NiBwcmVkZWZpbmVkQW1vdW50OwogICAgfQoKICAgIHN0cnVjdCBQYXJraW5nRGF0YSB7CiAgICBhZGRyZXNzIG5vZGU7CiAgICB1aW50IHN0YXJ0VGltZTsKICAgIHVpbnQgZW5kVGltZTsKICAgIHVpbnQyNTYgZml4ZWRSYXRlOwogICAgYm9vbCBpbml0aWFsaXplZDsKICAgIHVpbnQyNTYgcHJlZGVmaW5lZEFtb3VudDsKICAgIH0KCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBhdXRob3JpemVkOwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIHJhdGVPZkNoYXJnaW5nOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgcmF0ZU9mUGFya2luZzsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IENoYXJnaW5nRGF0YSkgcHVibGljIGNoYXJnaW5nU3dpdGNoZXM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IFBhcmtpbmdEYXRhKSBwdWJsaWMgcGFya2luZ1N3aXRjaGVzOwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIHJlc2VydmVkRnVuZHNDaGFyZ2luZzsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIHJlc2VydmVkRnVuZHNQYXJraW5nOwoKICAgIC8vIDEgRVRIID0gNTAwIENIQVJHIHRva2VucyAoMSBDSEFSRyA9IDAuNTkgVVNEKQogICAgdWludCBQUklDRSA9IDUwMDsKCiAgICBzdHJ1Y3QgQ29udHJpYnV0b3JEYXRhIHsKICAgIHVpbnQgY29udHJpYnV0aW9uQW1vdW50OwogICAgdWludCB0b2tlbnNJc3N1ZWQ7CiAgICB9CgogICAgZnVuY3Rpb24gQ2hhcmdDb2luQ29udHJhY3QoKSBwdWJsaWMgewogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gdG90YWxTdXBwbHk7CiAgICB9CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBDb250cmlidXRvckRhdGEpIHB1YmxpYyBjb250cmlidXRvckxpc3Q7CgogICAgdWludCBuZXh0Q29udHJpYnV0b3JJbmRleDsKCiAgICBtYXBwaW5nICh1aW50ID0+IGFkZHJlc3MpIGNvbnRyaWJ1dG9ySW5kZXhlczsKCiAgICBzdGF0ZSBwdWJsaWMgY3Jvd2RzYWxlU3RhdGUgPSBzdGF0ZS5wZW5kaW5nU3RhcnQ7CiAgICBlbnVtIHN0YXRlIHtwZW5kaW5nU3RhcnQsIGNyb3dkc2FsZSwgY3Jvd2RzYWxlRW5kZWR9CgogICAgZXZlbnQgQ3Jvd2RzYWxlU3RhcnRlZCh1aW50IGJsb2NrTnVtYmVyKTsKCiAgICBldmVudCBDcm93ZHNhbGVFbmRlZCh1aW50IGJsb2NrTnVtYmVyKTsKCiAgICBldmVudCBFcnJvclNlbmRpbmdFVEgoYWRkcmVzcyB0bywgdWludCBhbW91bnQpOwoKICAgIGV2ZW50IE1pbkNhcFJlYWNoZWQodWludCBibG9ja051bWJlcik7CgogICAgZXZlbnQgTWF4Q2FwUmVhY2hlZCh1aW50IGJsb2NrTnVtYmVyKTsKCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBCRUdJTl9USU1FID0gMTUxMjI2NTYzMzsKCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBFTkRfVElNRSA9IDE1MTQ3NjQ4MDA7CgogICAgdWludCBwdWJsaWMgbWluQ2FwID0gMSBldGhlcjsKCiAgICB1aW50IHB1YmxpYyBtYXhDYXAgPSA3MDIwMCBldGhlcjsKCiAgICB1aW50IHB1YmxpYyBldGhSYWlzZWQgPSAwOwoKICAgIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5ID0gOTAwMDAwMDAgKiAxMCAqKiBkZWNpbWFsczsKCiAgICB1aW50IGNyb3dkc2FsZVRva2VuQ2FwID0gMzUxMDAwMDAgKiAxMCAqKiBkZWNpbWFsczsgLy8gMzklCiAgICB1aW50IGZvdW5kZXJzQW5kVGVhbVRva2VucyA9IDkwMDAwMDAgKiAxMCAqKiBkZWNpbWFsczsgLy8gMTAlCiAgICB1aW50IHNsdXNoRnVuZFRva2VucyA9IDQ1OTAwMDAwICogMTAgKiogZGVjaW1hbHM7IC8vIDUxJQoKICAgIGJvb2wgZm91bmRlcnNBbmRUZWFtVG9rZW5zQ2xhaW1lZCA9IGZhbHNlOwogICAgYm9vbCBzbHVzaEZ1bmRUb2tlbnNDbGFpbWVkID0gZmFsc2U7CgogICAgdWludCBuZXh0Q29udHJpYnV0b3JUb0NsYWltOwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgaGFzQ2xhaW1lZEV0aFdoZW5GYWlsOwoKICAgIGZ1bmN0aW9uKCkgcGF5YWJsZSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlICE9IDApOwogICAgICAgIHJlcXVpcmUoY3Jvd2RzYWxlU3RhdGUgIT0gc3RhdGUuY3Jvd2RzYWxlRW5kZWQpOwogICAgICAgIC8vIENoZWNrIGlmIGNyb3dkc2FsZSBoYXMgZW5kZWQKCiAgICAgICAgYm9vbCBzdGF0ZUNoYW5nZWQgPSBjaGVja0Nyb3dkc2FsZVN0YXRlKCk7CiAgICAgICAgLy8gQ2hlY2sgYmxvY2tzIGFuZCBjYWxpYnJhdGUgY3Jvd2RzYWxlIHN0YXRlCgogICAgICAgIGlmIChjcm93ZHNhbGVTdGF0ZSA9PSBzdGF0ZS5jcm93ZHNhbGUpIHsKICAgICAgICAgICAgY3JlYXRlVG9rZW5zKG1zZy5zZW5kZXIpOwogICAgICAgICAgICAvLyBQcm9jZXNzIHRyYW5zYWN0aW9uIGFuZCBpc3N1ZSB0b2tlbnMKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHJlZnVuZFRyYW5zYWN0aW9uKHN0YXRlQ2hhbmdlZCk7CiAgICAgICAgICAgIC8vIFNldCBzdGF0ZSBhbmQgcmV0dXJuIGZ1bmRzIG9yIHRocm93CiAgICAgICAgfQogICAgfQoKICAgIC8vCiAgICAvLyBDaGVjayBjcm93ZHNhbGUgc3RhdGUgYW5kIGNhbGlicmF0ZSBpdAogICAgLy8KICAgIGZ1bmN0aW9uIGNoZWNrQ3Jvd2RzYWxlU3RhdGUoKSBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYgKGV0aFJhaXNlZCA+PSBtYXhDYXAgJiYgY3Jvd2RzYWxlU3RhdGUgIT0gc3RhdGUuY3Jvd2RzYWxlRW5kZWQpIHsvLyBDaGVjayBpZiBtYXggY2FwIGlzIHJlYWNoZWQKICAgICAgICAgICAgY3Jvd2RzYWxlU3RhdGUgPSBzdGF0ZS5jcm93ZHNhbGVFbmRlZDsKICAgICAgICAgICAgQ3Jvd2RzYWxlRW5kZWQoYmxvY2subnVtYmVyKTsKICAgICAgICAgICAgLy8gUmFpc2UgZXZlbnQKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICBpZiAobm93ID49IEVORF9USU1FKSB7CiAgICAgICAgICAgIGNyb3dkc2FsZVN0YXRlID0gc3RhdGUuY3Jvd2RzYWxlRW5kZWQ7CiAgICAgICAgICAgIENyb3dkc2FsZUVuZGVkKGJsb2NrLm51bWJlcik7CiAgICAgICAgICAgIC8vIFJhaXNlIGV2ZW50CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKG5vdyA+PSBCRUdJTl9USU1FICYmIG5vdyA8IEVORF9USU1FKSB7Ly8gQ2hlY2sgaWYgd2UgYXJlIGluIGNyb3dkc2FsZSBzdGF0ZQogICAgICAgICAgICBpZiAoY3Jvd2RzYWxlU3RhdGUgIT0gc3RhdGUuY3Jvd2RzYWxlKSB7Ly8gQ2hlY2sgaWYgc3RhdGUgbmVlZHMgdG8gYmUgY2hhbmdlZAogICAgICAgICAgICAgICAgY3Jvd2RzYWxlU3RhdGUgPSBzdGF0ZS5jcm93ZHNhbGU7CiAgICAgICAgICAgICAgICAvLyBTZXQgbmV3IHN0YXRlCiAgICAgICAgICAgICAgICBDcm93ZHNhbGVTdGFydGVkKGJsb2NrLm51bWJlcik7CiAgICAgICAgICAgICAgICAvLyBSYWlzZSBldmVudAogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvLwogICAgLy8gRGVjaWRlIGlmIHRocm93IG9yIG9ubHkgcmV0dXJuIGV0aGVyCiAgICAvLwogICAgZnVuY3Rpb24gcmVmdW5kVHJhbnNhY3Rpb24oYm9vbCBfc3RhdGVDaGFuZ2VkKSBpbnRlcm5hbCB7CiAgICAgICAgaWYgKF9zdGF0ZUNoYW5nZWQpIHsKICAgICAgICAgICAgbXNnLnNlbmRlci50cmFuc2Zlcihtc2cudmFsdWUpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGNyZWF0ZVRva2VucyhhZGRyZXNzIF9jb250cmlidXRvcikgcGF5YWJsZSBwdWJsaWMgewoKICAgICAgICB1aW50IF9hbW91bnQgPSBtc2cudmFsdWU7CgogICAgICAgIHVpbnQgY29udHJpYnV0aW9uQW1vdW50ID0gX2Ftb3VudDsKICAgICAgICB1aW50IHJldHVybkFtb3VudCA9IDA7CgogICAgICAgIGlmIChfYW1vdW50ID4gKG1heENhcCAtIGV0aFJhaXNlZCkpIHsvLyBDaGVjayBpZiBtYXggY29udHJpYnV0aW9uIGlzIGxvd2VyIHRoYW4gX2Ftb3VudCBzZW50CiAgICAgICAgICAgIGNvbnRyaWJ1dGlvbkFtb3VudCA9IG1heENhcCAtIGV0aFJhaXNlZDsKICAgICAgICAgICAgLy8gU2V0IHRoYXQgdXNlciBjb250aWJ1dGVzIGhpcyBtYXhpbXVtIGFsb3dlZCBjb250cmlidXRpb24KICAgICAgICAgICAgcmV0dXJuQW1vdW50ID0gX2Ftb3VudCAtIGNvbnRyaWJ1dGlvbkFtb3VudDsKICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGhvdyBtdWNoIGhlIG11c3QgZ2V0IGJhY2sKICAgICAgICB9CgogICAgICAgIGlmIChldGhSYWlzZWQgKyBjb250cmlidXRpb25BbW91bnQgPiBtaW5DYXAgJiYgbWluQ2FwID4gZXRoUmFpc2VkKSB7CiAgICAgICAgICAgIE1pbkNhcFJlYWNoZWQoYmxvY2subnVtYmVyKTsKICAgICAgICB9CgogICAgICAgIGlmIChldGhSYWlzZWQgKyBjb250cmlidXRpb25BbW91bnQgPT0gbWF4Q2FwICYmIGV0aFJhaXNlZCA8IG1heENhcCkgewogICAgICAgICAgICBNYXhDYXBSZWFjaGVkKGJsb2NrLm51bWJlcik7CiAgICAgICAgfQoKICAgICAgICBpZiAoY29udHJpYnV0b3JMaXN0W19jb250cmlidXRvcl0uY29udHJpYnV0aW9uQW1vdW50ID09IDApIHsKICAgICAgICAgICAgY29udHJpYnV0b3JJbmRleGVzW25leHRDb250cmlidXRvckluZGV4XSA9IF9jb250cmlidXRvcjsKICAgICAgICAgICAgbmV4dENvbnRyaWJ1dG9ySW5kZXggKz0gMTsKICAgICAgICB9CgogICAgICAgIGNvbnRyaWJ1dG9yTGlzdFtfY29udHJpYnV0b3JdLmNvbnRyaWJ1dGlvbkFtb3VudCArPSBjb250cmlidXRpb25BbW91bnQ7CiAgICAgICAgZXRoUmFpc2VkICs9IGNvbnRyaWJ1dGlvbkFtb3VudDsKICAgICAgICAvLyBBZGQgdG8gZXRoIHJhaXNlZAoKICAgICAgICB1aW50MjU2IHRva2VuQW1vdW50ID0gY2FsY3VsYXRlRXRoVG9DaGFyZ2NvaW4oY29udHJpYnV0aW9uQW1vdW50KTsKICAgICAgICAvLyBDYWxjdWxhdGUgaG93IG11Y2ggdG9rZW5zIG11c3QgY29udHJpYnV0b3IgZ2V0CiAgICAgICAgaWYgKHRva2VuQW1vdW50ID4gMCkgewogICAgICAgICAgICB0cmFuc2ZlclRvQ29udHJpYnV0b3IoX2NvbnRyaWJ1dG9yLCB0b2tlbkFtb3VudCk7CiAgICAgICAgICAgIGNvbnRyaWJ1dG9yTGlzdFtfY29udHJpYnV0b3JdLnRva2Vuc0lzc3VlZCArPSB0b2tlbkFtb3VudDsKICAgICAgICAgICAgLy8gbG9nIHRva2VuIGlzc3VhbmNlCiAgICAgICAgfQoKICAgICAgICBpZiAoIW11bHRpc2lnLnNlbmQobXNnLnZhbHVlKSkgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CiAgICB9CgoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyVG9Db250cmlidXRvcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpICBwdWJsaWMgewogICAgICAgIGJhbGFuY2VzW293bmVyXSA9IGJhbGFuY2VzW293bmVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVFdGhUb0NoYXJnY29pbih1aW50IF9ldGgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KSB7CgogICAgICAgIHVpbnQgdG9rZW5zID0gX2V0aC5tdWwoZ2V0UHJpY2UoKSk7CiAgICAgICAgdWludCBwZXJjZW50YWdlID0gMDsKCiAgICAgICAgaWYgKGV0aFJhaXNlZCA+IDApIHsKICAgICAgICAgICAgcGVyY2VudGFnZSA9IGV0aFJhaXNlZCAqIDEwMCAvIG1heENhcDsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0b2tlbnMgKyBnZXRBbW91bnRCb251cyh0b2tlbnMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEFtb3VudEJvbnVzKHVpbnQgdG9rZW5zKSBwdXJlIHB1YmxpYyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgdWludCBhbW91bnRCb251cyA9IDA7CgogICAgICAgIGlmICh0b2tlbnMgPj0gMTAwMDApIGFtb3VudEJvbnVzID0gdG9rZW5zOwogICAgICAgIGVsc2UgaWYgKHRva2VucyA+PSA1MDAwKSBhbW91bnRCb251cyA9IHRva2VucyAqIDYwIC8gMTAwOwogICAgICAgIGVsc2UgaWYgKHRva2VucyA+PSAxMDAwKSBhbW91bnRCb251cyA9IHRva2VucyAqIDMwIC8gMTAwOwogICAgICAgIGVsc2UgaWYgKHRva2VucyA+PSA1MDApIGFtb3VudEJvbnVzID0gdG9rZW5zICogMTAgLyAxMDA7CiAgICAgICAgZWxzZSBpZiAodG9rZW5zID49IDEwMCkgYW1vdW50Qm9udXMgPSB0b2tlbnMgKiA1IC8gMTAwOwogICAgICAgIGVsc2UgaWYgKHRva2VucyA+PSAxMCkgYW1vdW50Qm9udXMgPSB0b2tlbnMgKiAxIC8gMTAwOwoKICAgICAgICByZXR1cm4gYW1vdW50Qm9udXM7CiAgICB9CgogICAgLy8gcmVwbGFjZSB0aGlzIHdpdGggYW55IG90aGVyIHByaWNlIGZ1bmN0aW9uCiAgICBmdW5jdGlvbiBnZXRQcmljZSgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50IHJlc3VsdCkgewogICAgICAgIHJldHVybiBQUklDRTsKICAgIH0KCiAgICAvLwogICAgLy8gT3duZXIgY2FuIGJhdGNoIHJldHVybiBjb250cmlidXRvcnMgY29udHJpYnV0aW9ucyhldGgpCiAgICAvLwogICAgZnVuY3Rpb24gYmF0Y2hSZXR1cm5FdGhJZkZhaWxlZCh1aW50IF9udW1iZXJPZlJldHVybnMpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoY3Jvd2RzYWxlU3RhdGUgIT0gc3RhdGUuY3Jvd2RzYWxlRW5kZWQpOwogICAgICAgIC8vIENoZWNrIGlmIGNyb3dkc2FsZSBoYXMgZW5kZWQKICAgICAgICByZXF1aXJlKGV0aFJhaXNlZCA8IG1pbkNhcCk7CiAgICAgICAgLy8gQ2hlY2sgaWYgY3Jvd2RzYWxlIGhhcyBmYWlsZWQKICAgICAgICBhZGRyZXNzIGN1cnJlbnRQYXJ0aWNpcGFudEFkZHJlc3M7CiAgICAgICAgdWludCBjb250cmlidXRpb247CiAgICAgICAgZm9yICh1aW50IGNudCA9IDA7IGNudCA8IF9udW1iZXJPZlJldHVybnM7IGNudCsrKSB7CiAgICAgICAgICAgIGN1cnJlbnRQYXJ0aWNpcGFudEFkZHJlc3MgPSBjb250cmlidXRvckluZGV4ZXNbbmV4dENvbnRyaWJ1dG9yVG9DbGFpbV07CiAgICAgICAgICAgIC8vIEdldCBuZXh0IHVuY2xhaW1lZCBwYXJ0aWNpcGFudAogICAgICAgICAgICBpZiAoY3VycmVudFBhcnRpY2lwYW50QWRkcmVzcyA9PSAweDApIHJldHVybjsKICAgICAgICAgICAgLy8gQ2hlY2sgaWYgYWxsIHRoZSBwYXJ0aWNpcGFudHMgd2VyZSBjb21wZW5zYXRlZAogICAgICAgICAgICBpZiAoIWhhc0NsYWltZWRFdGhXaGVuRmFpbFtjdXJyZW50UGFydGljaXBhbnRBZGRyZXNzXSkgey8vIENoZWNrIGlmIHBhcnRpY2lwYW50IGhhcyBhbHJlYWR5IGNsYWltZWQKICAgICAgICAgICAgICAgIGNvbnRyaWJ1dGlvbiA9IGNvbnRyaWJ1dG9yTGlzdFtjdXJyZW50UGFydGljaXBhbnRBZGRyZXNzXS5jb250cmlidXRpb25BbW91bnQ7CiAgICAgICAgICAgICAgICAvLyBHZXQgY29udHJpYnV0aW9uIG9mIHBhcnRpY2lwYW50CiAgICAgICAgICAgICAgICBoYXNDbGFpbWVkRXRoV2hlbkZhaWxbY3VycmVudFBhcnRpY2lwYW50QWRkcmVzc10gPSB0cnVlOwogICAgICAgICAgICAgICAgLy8gU2V0IHRoYXQgaGUgaGFzIGNsYWltZWQKICAgICAgICAgICAgICAgIGJhbGFuY2VzW2N1cnJlbnRQYXJ0aWNpcGFudEFkZHJlc3NdID0gMDsKICAgICAgICAgICAgICAgIGlmICghY3VycmVudFBhcnRpY2lwYW50QWRkcmVzcy5zZW5kKGNvbnRyaWJ1dGlvbikpIHsvLyBSZWZ1bmQgZXRoCiAgICAgICAgICAgICAgICAgICAgRXJyb3JTZW5kaW5nRVRIKGN1cnJlbnRQYXJ0aWNpcGFudEFkZHJlc3MsIGNvbnRyaWJ1dGlvbik7CiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlcmUgaXMgYW4gaXNzdWUgcmFpc2UgZXZlbnQgZm9yIG1hbnVhbCByZWNvdmVyeQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIG5leHRDb250cmlidXRvclRvQ2xhaW0gKz0gMTsKICAgICAgICAgICAgLy8gUmVwZWF0CiAgICAgICAgfQogICAgfQoKICAgIC8vCiAgICAvLyBPd25lciBjYW4gc2V0IG11bHRpc2lnIGFkZHJlc3MgZm9yIGNyb3dkc2FsZQogICAgLy8KICAgIGZ1bmN0aW9uIHNldE11bHRpc2lnQWRkcmVzcyhhZGRyZXNzIF9uZXdBZGRyZXNzKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICBtdWx0aXNpZyA9IF9uZXdBZGRyZXNzOwogICAgfQoKICAgIC8vCiAgICAvLyBSZWdpc3RlcnMgbm9kZSB3aXRoIHJhdGUKICAgIC8vCiAgICBmdW5jdGlvbiByZWdpc3Rlck5vZGUodWludDI1NiBjaGFyZ2luZ1JhdGUsIHVpbnQyNTYgcGFya2luZ1JhdGUpIHB1YmxpYyB7CiAgICAgICAgaWYgKGF1dGhvcml6ZWRbbXNnLnNlbmRlcl0gPT0gMSkgcmV2ZXJ0KCk7CgogICAgICAgIHJhdGVPZkNoYXJnaW5nW21zZy5zZW5kZXJdID0gY2hhcmdpbmdSYXRlOwogICAgICAgIHJhdGVPZlBhcmtpbmdbbXNnLnNlbmRlcl0gPSBwYXJraW5nUmF0ZTsKICAgICAgICBhdXRob3JpemVkW21zZy5zZW5kZXJdID0gMTsKICAgIH0KCiAgICAvLyAKICAgIC8vIEJsb2NrIG5vZGUKICAgIC8vCiAgICBmdW5jdGlvbiBibG9ja05vZGUgKGFkZHJlc3Mgbm9kZSkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgYXV0aG9yaXplZFtub2RlXSA9IDA7CiAgICB9CgogICAgLy8KICAgIC8vIFVwZGF0ZXMgbm9kZSBjaGFyZ2luZyByYXRlCiAgICAvLyAKICAgIGZ1bmN0aW9uIHVwZGF0ZUNoYXJnaW5nUmF0ZSAodWludDI1NiByYXRlKSBwdWJsaWMgewogICAgICAgIHJhdGVPZkNoYXJnaW5nW21zZy5zZW5kZXJdID0gcmF0ZTsKICAgIH0KCiAgICAvLwogICAgLy8gVXBkYXRlcyBub2RlIHBhcmtpbmcgcmF0ZQogICAgLy8gCiAgICBmdW5jdGlvbiB1cGRhdGVQYXJraW5nUmF0ZSAodWludDI1NiByYXRlKSBwdWJsaWMgewogICAgICAgIHJhdGVPZkNoYXJnaW5nW21zZy5zZW5kZXJdID0gcmF0ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGFyZ2VPbiAoYWRkcmVzcyBub2RlLCB1aW50IHRpbWUpIHB1YmxpYyB7CiAgICAgICAgLy8gUHJldmVudCBmcm9tIG5vdCBhdXRob3JpemVkIG5vZGVzCiAgICAgICAgaWYgKGF1dGhvcml6ZWRbbm9kZV0gPT0gMCkgcmV2ZXJ0KCk7CiAgICAgICAgLy8gUHJldmVudCBmcm9tIGRvdWJsZSBjaGFyZ2luZwogICAgICAgIGlmIChjaGFyZ2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLmluaXRpYWxpemVkKSByZXZlcnQoKTsKCiAgICAgICAgLy8gRGV0ZXJtaW5lIGVuZFRpbWUKICAgICAgICB1aW50IGVuZFRpbWUgPSBub3cgKyB0aW1lOwoKICAgICAgICAvLyBQcmV2ZW50IGZyb20gcGFzdCBkYXRlcwogICAgICAgIGlmIChlbmRUaW1lIDw9IG5vdykgcmV2ZXJ0KCk7CgogICAgICAgIC8vIENhbGN1bGF0ZSB0aGUgYW1vdW50IG9mIHRva2VucyBoYXMgdG8gYmUgdGFrZW4gZnJvbSB1c2VycyBhY2NvdW50CiAgICAgICAgdWludDI1NiBwcmVkZWZpbmVkQW1vdW50ID0gKGVuZFRpbWUgLSBub3cpICogcmF0ZU9mQ2hhcmdpbmdbbm9kZV07CgogICAgICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA8IHByZWRlZmluZWRBbW91bnQpIHJldmVydCgpOwoKICAgICAgICBjaGFyZ2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdID0gQ2hhcmdpbmdEYXRhKG5vZGUsIG5vdywgZW5kVGltZSwgcmF0ZU9mQ2hhcmdpbmdbbm9kZV0sIHRydWUsIHByZWRlZmluZWRBbW91bnQpOwogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKHByZWRlZmluZWRBbW91bnQpOwogICAgICAgIHJlc2VydmVkRnVuZHNDaGFyZ2luZ1ttc2cuc2VuZGVyXSA9IHJlc2VydmVkRnVuZHNDaGFyZ2luZ1ttc2cuc2VuZGVyXS5hZGQocHJlZGVmaW5lZEFtb3VudCk7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhcmdlT2ZmIChhZGRyZXNzIG5vZGUpIHB1YmxpYyB7CiAgICAgICAgLy8gQ2hlY2sgdGhhdCBpbml0aWFsaXphdGlvbiBoYXBwZW5lZAogICAgICAgIGlmICghY2hhcmdpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5pbml0aWFsaXplZCkgcmV2ZXJ0KCk7CiAgICAgICAgLy8gQ2FsY3VsYXRlIHRoZSBhbW91bnQgZGVwZW5kaW5nIG9uIHJhdGUKICAgICAgICB1aW50MjU2IGFtb3VudCA9IChub3cgLSBjaGFyZ2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLnN0YXJ0VGltZSkgKiBjaGFyZ2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLmZpeGVkUmF0ZTsKICAgICAgICAvLyBNYXhpbXVtIGNhbiBiZSBwcmVkZWZpbmVkQW1vdW50LCBpZiBpdCBsZXNzIHRoYW4gdGhhdCwgcmV0dXJuIHRva2VucwogICAgICAgIGFtb3VudCA9IGFtb3VudCA+IGNoYXJnaW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0ucHJlZGVmaW5lZEFtb3VudCA/IGNoYXJnaW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0ucHJlZGVmaW5lZEFtb3VudCA6IGFtb3VudDsKCiAgICAgICAgLy8gVGFrZSB0b2tlbnMgZnJvbSByZXNlckZ1bmRzIGFuZCBwdXQgaXQgb24gYmFsYW5jZQogICAgICAgIGJhbGFuY2VzW25vZGVdID0gYmFsYW5jZXNbbm9kZV0gKyBhbW91bnQ7CiAgICAgICAgcmVzZXJ2ZWRGdW5kc0NoYXJnaW5nW21zZy5zZW5kZXJdID0gcmVzZXJ2ZWRGdW5kc0NoYXJnaW5nW21zZy5zZW5kZXJdIC0gYW1vdW50OwoKICAgICAgICAvLyBXaGVuIGFtb3VudCBpcyBsZXNzIHRoYW4gcHJlZGVmaW5lZEFtb3VudCwgcmV0dXJuIG90aGVyIHRva2VucyB0byB1c2VyCiAgICAgICAgaWYgKHJlc2VydmVkRnVuZHNDaGFyZ2luZ1ttc2cuc2VuZGVyXSA+IDApIHsKICAgICAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXSArIHJlc2VydmVkRnVuZHNDaGFyZ2luZ1ttc2cuc2VuZGVyXTsKICAgICAgICAgICAgcmVzZXJ2ZWRGdW5kc0NoYXJnaW5nW21zZy5zZW5kZXJdID0gMDsKICAgICAgICB9CgogICAgICAgIC8vIFVuaW5pdGlhbGl6ZQogICAgICAgIGNoYXJnaW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0ubm9kZSA9IDA7CiAgICAgICAgY2hhcmdpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5zdGFydFRpbWUgPSAwOwogICAgICAgIGNoYXJnaW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0uZW5kVGltZSA9IDA7CiAgICAgICAgY2hhcmdpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5maXhlZFJhdGUgPSAwOwogICAgICAgIGNoYXJnaW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0uaW5pdGlhbGl6ZWQgPSBmYWxzZTsKICAgICAgICBjaGFyZ2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLnByZWRlZmluZWRBbW91bnQgPSAwOwogICAgfQoKICAgIGZ1bmN0aW9uIHBhcmtpbmdPbiAoYWRkcmVzcyBub2RlLCB1aW50IHRpbWUpIHB1YmxpYyB7CiAgICAgICAgLy8gUHJldmVudCBmcm9tIG5vdCBhdXRob3JpemVkIG5vZGVzCiAgICAgICAgaWYgKGF1dGhvcml6ZWRbbm9kZV0gPT0gMCkgcmV2ZXJ0KCk7CiAgICAgICAgLy8gUHJldmVudCBmcm9tIGRvdWJsZSBjaGFyZ2luZwogICAgICAgIGlmIChwYXJraW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0uaW5pdGlhbGl6ZWQpIHJldmVydCgpOwoKICAgICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPCBwcmVkZWZpbmVkQW1vdW50KSByZXZlcnQoKTsKCiAgICAgICAgdWludCBlbmRUaW1lID0gbm93ICsgdGltZTsKCiAgICAgICAgLy8gUHJldmVudCBmcm9tIHBhc3QgZGF0ZXMKICAgICAgICBpZiAoZW5kVGltZSA8PSBub3cpIHJldmVydCgpOwoKICAgICAgICB1aW50MjU2IHByZWRlZmluZWRBbW91bnQgPSAoZW5kVGltZSAtIG5vdykgKiByYXRlT2ZQYXJraW5nW25vZGVdOwoKICAgICAgICBwYXJraW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0gPSBQYXJraW5nRGF0YShub2RlLCBub3csIGVuZFRpbWUsIHJhdGVPZlBhcmtpbmdbbm9kZV0sIHRydWUsIHByZWRlZmluZWRBbW91bnQpOwogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKHByZWRlZmluZWRBbW91bnQpOwogICAgICAgIHJlc2VydmVkRnVuZHNQYXJraW5nW21zZy5zZW5kZXJdID0gcmVzZXJ2ZWRGdW5kc1BhcmtpbmdbbXNnLnNlbmRlcl0uYWRkKHByZWRlZmluZWRBbW91bnQpOwogICAgfQoKICAgIC8vIFBhcmtpbmcgb2ZmICAgICAKICAgIGZ1bmN0aW9uIHBhcmtpbmdPZmYgKGFkZHJlc3Mgbm9kZSkgcHVibGljIHsKICAgICAgICBpZiAoIXBhcmtpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5pbml0aWFsaXplZCkgcmV2ZXJ0KCk7CgogICAgICAgIC8vIENhbGN1bGF0ZSB0aGUgYW1vdW50IGRlcGVuZGluZyBvbiByYXRlCiAgICAgICAgdWludDI1NiBhbW91bnQgPSAobm93IC0gcGFya2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLnN0YXJ0VGltZSkgKiBwYXJraW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0uZml4ZWRSYXRlOwogICAgICAgIC8vIE1heGltdW0gY2FuIGJlIHByZWRlZmluZWRBbW91bnQsIGlmIGl0IGxlc3MgdGhhbiB0aGF0LCByZXR1cm4gdG9rZW5zCiAgICAgICAgYW1vdW50ID0gYW1vdW50ID4gcGFya2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLnByZWRlZmluZWRBbW91bnQgPyBwYXJraW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0ucHJlZGVmaW5lZEFtb3VudCA6IGFtb3VudDsKCiAgICAgICAgYmFsYW5jZXNbbm9kZV0gPSBiYWxhbmNlc1tub2RlXSArIGFtb3VudDsKICAgICAgICByZXNlcnZlZEZ1bmRzUGFya2luZ1ttc2cuc2VuZGVyXSA9IHJlc2VydmVkRnVuZHNQYXJraW5nW21zZy5zZW5kZXJdIC0gYW1vdW50OwoKICAgICAgICAvLyAgCiAgICAgICAgaWYgKHJlc2VydmVkRnVuZHNQYXJraW5nW21zZy5zZW5kZXJdID4gMCkgewogICAgICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdICsgcmVzZXJ2ZWRGdW5kc1BhcmtpbmdbbXNnLnNlbmRlcl07CiAgICAgICAgICAgIC8vIGFsbCB0b2tlbnMgdGFrZW4sIHNldCB0byAwCiAgICAgICAgICAgIHJlc2VydmVkRnVuZHNQYXJraW5nW21zZy5zZW5kZXJdID0gMDsKICAgICAgICB9CgogICAgICAgIC8vIFVuaW5pdGlhbGl6ZQogICAgICAgIHBhcmtpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5ub2RlID0gMDsKICAgICAgICBwYXJraW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0uc3RhcnRUaW1lID0gMDsKICAgICAgICBwYXJraW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0uZW5kVGltZSA9IDA7CiAgICAgICAgcGFya2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLmZpeGVkUmF0ZSA9IDA7CiAgICAgICAgcGFya2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLmluaXRpYWxpemVkID0gZmFsc2U7CiAgICAgICAgcGFya2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLnByZWRlZmluZWRBbW91bnQgPSAwOwogICAgfQoKfQ=='.
	

]
