Class {
	#name : #SRT7aBbE415D8504D89B188C3c783e694690c5F5f88,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT7aBbE415D8504D89B188C3c783e694690c5F5f88 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CmxpYnJhcnkgU2FmZU1hdGggewogIGZ1bmN0aW9uIG11bCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgdWludCBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQogIGZ1bmN0aW9uIGRpdih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgYXNzZXJ0KGIgPiAwKTsKICAgIHVpbnQgYyA9IGEgLyBiOwogICAgYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7CiAgICByZXR1cm4gYzsKICB9CiAgZnVuY3Rpb24gc3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CiAgZnVuY3Rpb24gYWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICB1aW50IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQogIGZ1bmN0aW9uIG1heDY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7CiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7CiAgfQogIGZ1bmN0aW9uIG1pbjY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7CiAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsKICB9CiAgZnVuY3Rpb24gbWF4MjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7CiAgfQogIGZ1bmN0aW9uIG1pbjI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7CiAgfQogIGZ1bmN0aW9uIGFzc2VydChib29sIGFzc2VydGlvbikgaW50ZXJuYWwgewogICAgaWYgKCFhc3NlcnRpb24pIHsKICAgICAgdGhyb3c7CiAgICB9CiAgfQp9CmNvbnRyYWN0IE93bmFibGUgewogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICBmdW5jdGlvbiBPd25hYmxlKCkgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KICAgIG1vZGlmaWVyIG9ubHlPd25lciB7CiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIpIHRocm93OwogICAgICAgIF87CiAgICB9CiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgewogICAgICAgIGlmIChuZXdPd25lciAhPSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICAgICAgfQogICAgfQp9Ci8qCiAqIFBhdXNhYmxlCiAqIEFic3RyYWN0IGNvbnRyYWN0IHRoYXQgYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbgogKiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uCiAqLwpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKICBib29sIHB1YmxpYyBzdG9wcGVkOwogIG1vZGlmaWVyIHN0b3BJbkVtZXJnZW5jeSB7CiAgICBpZiAoc3RvcHBlZCkgewogICAgICB0aHJvdzsKICAgIH0KICAgIF87CiAgfQogIAogIG1vZGlmaWVyIG9ubHlJbkVtZXJnZW5jeSB7CiAgICBpZiAoIXN0b3BwZWQpIHsKICAgICAgdGhyb3c7CiAgICB9CiAgICBfOwogIH0KICAvLyBjYWxsZWQgYnkgdGhlIG93bmVyIG9uIGVtZXJnZW5jeSwgdHJpZ2dlcnMgc3RvcHBlZCBzdGF0ZQogIGZ1bmN0aW9uIGVtZXJnZW5jeVN0b3AoKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgc3RvcHBlZCA9IHRydWU7CiAgfQogIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW5kIG9mIGVtZXJnZW5jeSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICBmdW5jdGlvbiByZWxlYXNlKCkgZXh0ZXJuYWwgb25seU93bmVyIG9ubHlJbkVtZXJnZW5jeSB7CiAgICBzdG9wcGVkID0gZmFsc2U7CiAgfQp9CmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgY29uc3RhbnQgcmV0dXJucyAodWludCk7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludCB2YWx1ZSk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSk7Cn0KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCk7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludCB2YWx1ZSk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQgdmFsdWUpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOwp9Ci8qCiAqIFB1bGxQYXltZW50CiAqIEJhc2UgY29udHJhY3Qgc3VwcG9ydGluZyBhc3luYyBzZW5kIGZvciBwdWxsIHBheW1lbnRzLgogKiBJbmhlcml0IGZyb20gdGhpcyBjb250cmFjdCBhbmQgdXNlIGFzeW5jU2VuZCBpbnN0ZWFkIG9mIHNlbmQuCiAqLwpjb250cmFjdCBQdWxsUGF5bWVudCB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CiAgCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBwYXltZW50czsKICBldmVudCBMb2dSZWZ1bmRFVEgoYWRkcmVzcyB0bywgdWludCB2YWx1ZSk7CiAgLyoqCiAgKiAgU3RvcmUgc2VudCBhbW91bnQgYXMgY3JlZGl0IHRvIGJlIHB1bGxlZCwgY2FsbGVkIGJ5IHBheWVyIAogICoqLwogIGZ1bmN0aW9uIGFzeW5jU2VuZChhZGRyZXNzIGRlc3QsIHVpbnQgYW1vdW50KSBpbnRlcm5hbCB7CiAgICBwYXltZW50c1tkZXN0XSA9IHBheW1lbnRzW2Rlc3RdLmFkZChhbW91bnQpOwogIH0KICAvLyB3aXRoZHJhdyBhY2N1bXVsYXRlZCBiYWxhbmNlLCBjYWxsZWQgYnkgcGF5ZWUKICBmdW5jdGlvbiB3aXRoZHJhd1BheW1lbnRzKCkgewogICAgYWRkcmVzcyBwYXllZSA9IG1zZy5zZW5kZXI7CiAgICB1aW50IHBheW1lbnQgPSBwYXltZW50c1twYXllZV07CiAgICAKICAgIGlmIChwYXltZW50ID09IDApIHsKICAgICAgdGhyb3c7CiAgICB9CiAgICBpZiAodGhpcy5iYWxhbmNlIDwgcGF5bWVudCkgewogICAgICB0aHJvdzsKICAgIH0KICAgIHBheW1lbnRzW3BheWVlXSA9IDA7CiAgICBpZiAoIXBheWVlLnNlbmQocGF5bWVudCkpIHsKICAgICAgdGhyb3c7CiAgICB9CiAgICBMb2dSZWZ1bmRFVEgocGF5ZWUscGF5bWVudCk7CiAgfQp9CmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgCiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CiAgCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIGJhbGFuY2VzOwogIAogIC8qCiAgICogRml4IGZvciB0aGUgRVJDMjAgc2hvcnQgYWRkcmVzcyBhdHRhY2sgIAogICovCiAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgc2l6ZSkgewogICAgIGlmKG1zZy5kYXRhLmxlbmd0aCA8IHNpemUgKyA0KSB7CiAgICAgICB0aHJvdzsKICAgICB9CiAgICAgXzsKICB9CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSB7CiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgfQogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cn0KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBCYXNpY1Rva2VuLCBFUkMyMCB7CiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpKSBhbGxvd2VkOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIG9ubHlQYXlsb2FkU2l6ZSgzICogMzIpIHsKICAgIHZhciBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07CiAgICAvLyBDaGVjayBpcyBub3QgbmVlZGVkIGJlY2F1c2Ugc3ViKF9hbGxvd2FuY2UsIF92YWx1ZSkgd2lsbCBhbHJlYWR5IHRocm93IGlmIHRoaXMgY29uZGl0aW9uIGlzIG5vdCBtZXQKICAgIC8vIGlmIChfdmFsdWUgPiBfYWxsb3dhbmNlKSB0aHJvdzsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBfYWxsb3dhbmNlLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICB9CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkgewogICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2AKICAgIC8vICBhbGxvd2FuY2UgdG8gemVybyBieSBjYWxsaW5nIGBhcHByb3ZlKF9zcGVuZGVyLCAwKWAgaWYgaXQgaXMgbm90CiAgICAvLyAgYWxyZWFkeSAwIHRvIG1pdGlnYXRlIHRoZSByYWNlIGNvbmRpdGlvbiBkZXNjcmliZWQgaGVyZToKICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgaWYgKChfdmFsdWUgIT0gMCkgJiYgKGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdICE9IDApKSB0aHJvdzsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgfQogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCByZW1haW5pbmcpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KfQovKioKICogIEdhbWVQbGF5ZXJDb2luIHRva2VuIGNvbnRyYWN0LiBJbXBsZW1lbnRzCiAqLwpjb250cmFjdCBHYW1lUGxheWVyQ29pbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiR2FtZVBsYXllckNvaW4iOwogIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIkdQQyI7CiAgdWludCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKICAvLyBDb25zdHJ1Y3RvcgogIGZ1bmN0aW9uIEdhbWVQbGF5ZXJDb2luKCkgewogICAgICB0b3RhbFN1cHBseSA9IDEwMCAqICgxMCoqNikgKiAoMTAgKiogZGVjaW1hbHMpOyAvLyAxMDAgbWlsbGlvbiAKICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSB0b3RhbFN1cHBseTsgLy8gU2VuZCBhbGwgdG9rZW5zIHRvIG93bmVyCiAgfQogIC8qKgogICAqICBCdXJuIGF3YXkgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgR2FtZVBsYXllckNvaW4gdG9rZW5zCiAgICovCiAgZnVuY3Rpb24gYnVybih1aW50IF92YWx1ZSkgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgMHgwLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQp9Ci8qCiAgQ3Jvd2RzYWxlIFNtYXJ0IENvbnRyYWN0IGZvciB0aGUgZ2FtZXBsYXllcmNvaW4uY29tIHByb2plY3QKICBUaGlzIHNtYXJ0IGNvbnRyYWN0IGNvbGxlY3RzIEVUSCwgYW5kIGluIHJldHVybiBlbWl0cyBHYW1lUGxheWVyQ29pbiB0b2tlbnMgdG8gdGhlIGJhY2tlcnMKKi8KY29udHJhY3QgQ3Jvd2RzYWxlIGlzIFBhdXNhYmxlLCBQdWxsUGF5bWVudCB7CiAgICAKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwogICAgc3RydWN0IEJhY2tlciB7CiAgICAgICAgdWludCB3ZWlSZWNlaXZlZDsgLy8gQW1vdW50IG9mIEV0aGVyIGdpdmVuCiAgICAgICAgdWludCBjb2luU2VudDsKICAgIH0KICAgIC8qCiAgICAqIENvbnN0YW50cwogICAgKi8KICAgIC8qIE1pbmltdW0gbnVtYmVyIG9mIEdhbWVQbGF5ZXJDb2lucyB0byBzZWxsICovCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBNSU5fQ0FQID0gNSAqICgxMCoqNikgKiAoMTAgKiogMTgpOyAvLyAxMCBtaWxsaW9uIEdhbWVQbGF5ZXJDb2luICwgYWJvdXQgMjUwMCBFVEgKICAgIC8qIE1heGltdW0gbnVtYmVyIG9mIEdhbWVQbGF5ZXJDb2lucyB0byBzZWxsICovCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBNQVhfQ0FQID0gNzAgKiAoMTAqKjYpICogKDEwICoqIDE4KTsgLy8gNzAgbWlsbGlvbiBHYW1lUGxheWVyQ29pbiAsIGFib3V0IDM1MDAwIEVUSAogICAgLyogTWluaW11bSBhbW91bnQgdG8gaW52ZXN0ICovCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBNSU5fSU5WRVNUX0VUSEVSID0gMTAwIGZpbm5leTsKICAgIC8qIENyb3dkc2FsZSBwZXJpb2QgKi8KICAgIHVpbnQgcHJpdmF0ZSBjb25zdGFudCBDUk9XRFNBTEVfUEVSSU9EID0gOTAgZGF5czsKICAgIC8qIE51bWJlciBvZiBHYW1lUGxheWVyQ29pbiBwZXIgRXRoZXIgKi8KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IENPSU5fUEVSX0VUSEVSID0gMjAwMCAqICgxMCAqKiAxOCk7IC8vIDIsMDAwIEdhbWVQbGF5ZXJDb2luIAogICAgLyoKICAgICogVmFyaWFibGVzCiAgICAqLwogICAgLyogR2FtZVBsYXllcmNvaW4gY29udHJhY3QgcmVmZXJlbmNlICovCiAgICBHYW1lUGxheWVyQ29pbiBwdWJsaWMgY29pbjsKICAgIC8qIE11bHRpc2lnIGNvbnRyYWN0IHRoYXQgd2lsbCByZWNlaXZlIHRoZSBFdGhlciAqLwogICAgYWRkcmVzcyBwdWJsaWMgbXVsdGlzaWdFdGhlcjsKICAgIC8qIE51bWJlciBvZiBFdGhlciByZWNlaXZlZCAqLwogICAgdWludCBwdWJsaWMgZXRoZXJSZWNlaXZlZDsKICAgIC8qIE51bWJlciBvZiBHYW1lUGxheWVyY29pbnMgc2VudCB0byBFdGhlciBjb250cmlidXRvcnMgKi8KICAgIHVpbnQgcHVibGljIGNvaW5TZW50VG9FdGhlcjsKICAgIC8qIENyb3dkc2FsZSBzdGFydCB0aW1lICovCiAgICB1aW50IHB1YmxpYyBzdGFydFRpbWU7CiAgICAvKiBDcm93ZHNhbGUgZW5kIHRpbWUgKi8KICAgIHVpbnQgcHVibGljIGVuZFRpbWU7CiAgICAvKiBJcyBjcm93ZHNhbGUgc3RpbGwgb24gZ29pbmcgKi8KICAgIGJvb2wgcHVibGljIGNyb3dkc2FsZUNsb3NlZDsKICAgIC8qIEJhY2tlcnMgRXRoZXIgaW5kZXhlZCBieSB0aGVpciBFdGhlcmV1bSBhZGRyZXNzICovCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gQmFja2VyKSBwdWJsaWMgYmFja2VyczsKICAgIC8qCiAgICAqIE1vZGlmaWVycwogICAgKi8KICAgIG1vZGlmaWVyIG1pbkNhcE5vdFJlYWNoZWQoKSB7CiAgICAgICAgaWYgKChub3cgPCBlbmRUaW1lKSB8fCBjb2luU2VudFRvRXRoZXIgPj0gTUlOX0NBUCApIHRocm93OwogICAgICAgIF87CiAgICB9CiAgICBtb2RpZmllciByZXNwZWN0VGltZUZyYW1lKCkgewogICAgICAgIGlmICgobm93IDwgc3RhcnRUaW1lKSB8fCAobm93ID4gZW5kVGltZSApKSB0aHJvdzsKICAgICAgICBfOwogICAgfQogICAgLyoKICAgICAqIEV2ZW50CiAgICAqLwogICAgZXZlbnQgTG9nUmVjZWl2ZWRFVEgoYWRkcmVzcyBhZGRyLCB1aW50IHZhbHVlKTsKICAgIGV2ZW50IExvZ0NvaW5zRW1pdGVkKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCB1aW50IGFtb3VudCk7CiAgICAvKgogICAgICogQ29uc3RydWN0b3IKICAgICovCiAgICBmdW5jdGlvbiBDcm93ZHNhbGUoYWRkcmVzcyBfZ2FtZVBsYXllckNvaW5BZGRyZXNzLCBhZGRyZXNzIF90bykgewogICAgICAgIGNvaW4gPSBHYW1lUGxheWVyQ29pbihfZ2FtZVBsYXllckNvaW5BZGRyZXNzKTsKICAgICAgICBtdWx0aXNpZ0V0aGVyID0gX3RvOwogICAgfQogICAgLyogCiAgICAgKiBUaGUgZmFsbGJhY2sgZnVuY3Rpb24gY29ycmVzcG9uZHMgdG8gYSBkb25hdGlvbiBpbiBFVEgKICAgICAqLwogICAgZnVuY3Rpb24oKSBzdG9wSW5FbWVyZ2VuY3kgcmVzcGVjdFRpbWVGcmFtZSBwYXlhYmxlIHsKICAgICAgICByZWNlaXZlRVRIKG1zZy5zZW5kZXIpOwogICAgfQogICAgLyogCiAgICAgKiBUbyBjYWxsIHRvIHN0YXJ0IHRoZSBjcm93ZHNhbGUKICAgICAqLwogICAgZnVuY3Rpb24gc3RhcnQoKSBvbmx5T3duZXIgewogICAgICAgIGlmIChzdGFydFRpbWUgIT0gMCkgdGhyb3c7IC8vIENyb3dkc2FsZSB3YXMgYWxyZWFkeSBzdGFydGVkCiAgICAgICAgc3RhcnRUaW1lID0gbm93IDsKICAgICAgICBlbmRUaW1lID0gIG5vdyArIENST1dEU0FMRV9QRVJJT0Q7CiAgICB9CiAgICAvKgogICAgICogIFJlY2VpdmVzIGEgZG9uYXRpb24gaW4gRXRoZXIKICAgICovCiAgICBmdW5jdGlvbiByZWNlaXZlRVRIKGFkZHJlc3MgYmVuZWZpY2lhcnkpIGludGVybmFsIHsKICAgICAgICBpZiAobXNnLnZhbHVlIDwgTUlOX0lOVkVTVF9FVEhFUikgdGhyb3c7IC8vIERvbid0IGFjY2VwdCBmdW5kaW5nIHVuZGVyIGEgcHJlZGVmaW5lZCB0aHJlc2hvbGQKICAgICAgICAKICAgICAgICB1aW50IGNvaW5Ub1NlbmQgPSBib251cyhtc2cudmFsdWUubXVsKENPSU5fUEVSX0VUSEVSKS5kaXYoMSBldGhlcikpOyAvLyBDb21wdXRlIHRoZSBudW1iZXIgb2YgR2FtZVBsYXllckNvaW4gdG8gc2VuZAogICAgICAgIGlmIChjb2luVG9TZW5kLmFkZChjb2luU2VudFRvRXRoZXIpID4gTUFYX0NBUCkgdGhyb3c7ICAgIAogICAgICAgIEJhY2tlciBiYWNrZXIgPSBiYWNrZXJzW2JlbmVmaWNpYXJ5XTsKICAgICAgICBjb2luLnRyYW5zZmVyKGJlbmVmaWNpYXJ5LCBjb2luVG9TZW5kKTsgLy8gVHJhbnNmZXIgR2FtZXBsYXllcmNvaW5zIHJpZ2h0IG5vdyAKICAgICAgICBiYWNrZXIuY29pblNlbnQgPSBiYWNrZXIuY29pblNlbnQuYWRkKGNvaW5Ub1NlbmQpOwogICAgICAgIGJhY2tlci53ZWlSZWNlaXZlZCA9IGJhY2tlci53ZWlSZWNlaXZlZC5hZGQobXNnLnZhbHVlKTsgLy8gVXBkYXRlIHRoZSB0b3RhbCB3ZWkgY29sbGVjdGVkIGR1cmluZyB0aGUgY3Jvd2RmdW5kaW5nIGZvciB0aGlzIGJhY2tlciAgICAKICAgICAgICBldGhlclJlY2VpdmVkID0gZXRoZXJSZWNlaXZlZC5hZGQobXNnLnZhbHVlKTsgLy8gVXBkYXRlIHRoZSB0b3RhbCB3ZWkgY29sbGVjdGVkIGR1cmluZyB0aGUgY3Jvd2RmdW5kaW5nCiAgICAgICAgY29pblNlbnRUb0V0aGVyID0gY29pblNlbnRUb0V0aGVyLmFkZChjb2luVG9TZW5kKTsKICAgICAgICAvLyBTZW5kIGV2ZW50cwogICAgICAgIExvZ0NvaW5zRW1pdGVkKG1zZy5zZW5kZXIgLGNvaW5Ub1NlbmQpOwogICAgICAgIExvZ1JlY2VpdmVkRVRIKGJlbmVmaWNpYXJ5LCBldGhlclJlY2VpdmVkKTsgCiAgICB9CiAgICAKICAgIC8qCiAgICAgKkNvbXB1dGUgdGhlIEdhbWVQbGF5ZXJjb2luIGJvbnVzIGFjY29yZGluZyB0byB0aGUgaW52ZXN0bWVudCBwZXJpb2QKICAgICAqLwogICAgZnVuY3Rpb24gYm9udXModWludCBhbW91bnQpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICBpZiAobm93IDwgc3RhcnRUaW1lLmFkZCg3IGRheXMpKSByZXR1cm4gYW1vdW50LmFkZChhbW91bnQuZGl2KDUpKTsgICAvLyBib251cyAyMCUKICAgICAgICBpZiAobm93ID49IHN0YXJ0VGltZS5hZGQoNyBkYXlzKSAmJiBub3cgPCBzdGFydFRpbWUuYWRkKDE0IGRheXMpKSByZXR1cm4gYW1vdW50LmFkZChhbW91bnQuZGl2KDEwKSk7ICAgLy8gYm9udXMgMTAlCiAgICAgICAgaWYgKG5vdyA+PSBzdGFydFRpbWUuYWRkKDE0IGRheXMpICYmIG5vdyA8IHN0YXJ0VGltZS5hZGQoMjEgZGF5cykpIHJldHVybiBhbW91bnQuYWRkKGFtb3VudC5kaXYoMjApKTsgICAvLyBib251cyA1JQogICAgICAgIHJldHVybiBhbW91bnQ7CiAgICB9CiAgICAvKiAgCiAgICAgKiBGaW5hbGl6ZSB0aGUgY3Jvd2RzYWxlLCBzaG91bGQgYmUgY2FsbGVkIGFmdGVyIHRoZSByZWZ1bmQgcGVyaW9kCiAgICAqLwogICAgZnVuY3Rpb24gZmluYWxpemUoKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICBpZiAobm93IDwgZW5kVGltZSkgeyAvLyBDYW5ub3QgZmluYWxpc2UgYmVmb3JlIENST1dEU0FMRV9QRVJJT0Qgb3IgYmVmb3JlIHNlbGxpbmcgYWxsIGNvaW5zCiAgICAgICAgICAgIGlmIChjb2luU2VudFRvRXRoZXIgPT0gTUFYX0NBUCkgewogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGNvaW5TZW50VG9FdGhlciA8IE1JTl9DQVAgJiYgbm93IDwgZW5kVGltZSArIDE1IGRheXMpIHRocm93OyAvLyBJZiBNSU5fQ0FQIGlzIG5vdCByZWFjaGVkIGRvbm9ycyBoYXZlIDE1ZGF5cyB0byBnZXQgcmVmdW5kIGJlZm9yZSB3ZSBjYW4gZmluYWxpc2UKICAgICAgICBpZiAoIW11bHRpc2lnRXRoZXIuc2VuZCh0aGlzLmJhbGFuY2UpKSB0aHJvdzsgLy8gTW92ZSB0aGUgcmVtYWluaW5nIEV0aGVyIHRvIHRoZSBtdWx0aXNpZyBhZGRyZXNzCiAgICAgICAgCiAgICAgICAgdWludCByZW1haW5zID0gY29pbi5iYWxhbmNlT2YodGhpcyk7CiAgICAgICAgaWYgKHJlbWFpbnMgPiAwKSB7IC8vIEJ1cm4gdGhlIHJlc3Qgb2YgR2FtZVBsYXllcmNvaW5zCiAgICAgICAgICAgIGlmICghY29pbi5idXJuKHJlbWFpbnMpKSB0aHJvdyA7CiAgICAgICAgfQogICAgICAgIGNyb3dkc2FsZUNsb3NlZCA9IHRydWU7CiAgICB9CiAgICAvKiAgCiAgICAqIEZhaWxzYWZlIGRyYWluCiAgICAqLwogICAgZnVuY3Rpb24gZHJhaW4oKSBvbmx5T3duZXIgewogICAgICAgIGlmICghb3duZXIuc2VuZCh0aGlzLmJhbGFuY2UpKSB0aHJvdzsKICAgIH0KICAgIC8qKgogICAgICogQWxsb3cgdG8gY2hhbmdlIHRoZSB0ZWFtIG11bHRpc2lnIGFkZHJlc3MgaW4gdGhlIGNhc2Ugb2YgZW1lcmdlbmN5LgogICAgICovCiAgICBmdW5jdGlvbiBzZXRNdWx0aXNpZyhhZGRyZXNzIGFkZHIpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGlmIChhZGRyID09IGFkZHJlc3MoMCkpIHRocm93OwogICAgICAgIG11bHRpc2lnRXRoZXIgPSBhZGRyOwogICAgfQogICAgLyoqCiAgICAgKiBNYW51YWxseSBiYWNrIEdhbWVQbGF5ZXJDb2lucyBvd25lciBhZGRyZXNzLgogICAgICovCiAgICBmdW5jdGlvbiBiYWNrR2FtZVBsYXllckNvaW5Pd25lcigpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGNvaW4udHJhbnNmZXJPd25lcnNoaXAob3duZXIpOwogICAgfQogICAgLyoqCiAgICAgKiBUcmFuc2ZlciByZW1haW5zIHRvIG93bmVyIGluIGNhc2UgaWYgaW1wb3NzaWJsZSB0byBkbyBtaW4gaW52ZXN0CiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFJlbWFpbkNvaW5zKCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgdmFyIHJlbWFpbnMgPSBNQVhfQ0FQIC0gY29pblNlbnRUb0V0aGVyOwogICAgICAgIHVpbnQgbWluQ29pbnNUb1NlbGwgPSBib251cyhNSU5fSU5WRVNUX0VUSEVSLm11bChDT0lOX1BFUl9FVEhFUikgLyAoMSBldGhlcikpOwogICAgICAgIGlmKHJlbWFpbnMgPiBtaW5Db2luc1RvU2VsbCkgdGhyb3c7CiAgICAgICAgQmFja2VyIGJhY2tlciA9IGJhY2tlcnNbb3duZXJdOwogICAgICAgIGNvaW4udHJhbnNmZXIob3duZXIsIHJlbWFpbnMpOyAvLyBUcmFuc2ZlciBHYW1lUGxheWVyQ29pbnMgcmlnaHQgbm93IAogICAgICAgIGJhY2tlci5jb2luU2VudCA9IGJhY2tlci5jb2luU2VudC5hZGQocmVtYWlucyk7CiAgICAgICAgY29pblNlbnRUb0V0aGVyID0gY29pblNlbnRUb0V0aGVyLmFkZChyZW1haW5zKTsKICAgICAgICAvLyBTZW5kIGV2ZW50cwogICAgICAgIExvZ0NvaW5zRW1pdGVkKHRoaXMgLHJlbWFpbnMpOwogICAgICAgIExvZ1JlY2VpdmVkRVRIKG93bmVyLCBldGhlclJlY2VpdmVkKTsgCiAgICB9CiAgICAvKiAKICAgICAqIFdoZW4gTUlOX0NBUCBpcyBub3QgcmVhY2g6CiAgICAgKiAxKSBiYWNrZXIgY2FsbCB0aGUgImFwcHJvdmUiIGZ1bmN0aW9uIG9mIHRoZSBHYW1lUGxheWVyQ29pbiB0b2tlbiBjb250cmFjdCB3aXRoIHRoZSBhbW91bnQgb2YgYWxsIEdhbWVQbGF5ZXJDb2lucyB0aGV5IGdvdCBpbiBvcmRlciB0byBiZSByZWZ1bmQKICAgICAqIDIpIGJhY2tlciBjYWxsIHRoZSAicmVmdW5kIiBmdW5jdGlvbiBvZiB0aGUgQ3Jvd2RzYWxlIGNvbnRyYWN0IHdpdGggdGhlIHNhbWUgYW1vdW50IG9mIEdhbWVQbGF5ZXJzCiAgICAgKiAzKSBiYWNrZXIgY2FsbCB0aGUgIndpdGhkcmF3UGF5bWVudHMiIGZ1bmN0aW9uIG9mIHRoZSBDcm93ZHNhbGUgY29udHJhY3QgdG8gZ2V0IGEgcmVmdW5kIGluIEVUSAogICAgICovCiAgICBmdW5jdGlvbiByZWZ1bmQodWludCBfdmFsdWUpIG1pbkNhcE5vdFJlYWNoZWQgcHVibGljIHsKICAgICAgICBpZiAoX3ZhbHVlICE9IGJhY2tlcnNbbXNnLnNlbmRlcl0uY29pblNlbnQpIHRocm93OyAvLyBjb21wYXJlIHZhbHVlIGZyb20gYmFja2VyIGJhbGFuY2UKICAgICAgICBjb2luLnRyYW5zZmVyRnJvbShtc2cuc2VuZGVyLCBhZGRyZXNzKHRoaXMpLCBfdmFsdWUpOyAvLyBnZXQgdGhlIHRva2VuIGJhY2sgdG8gdGhlIGNyb3dkc2FsZSBjb250cmFjdAogICAgICAgIGlmICghY29pbi5idXJuKF92YWx1ZSkpIHRocm93IDsgLy8gdG9rZW4gc2VudCBmb3IgcmVmdW5kIGFyZSBidXJudAogICAgICAgIHVpbnQgRVRIVG9TZW5kID0gYmFja2Vyc1ttc2cuc2VuZGVyXS53ZWlSZWNlaXZlZDsKICAgICAgICBiYWNrZXJzW21zZy5zZW5kZXJdLndlaVJlY2VpdmVkPTA7CiAgICAgICAgaWYgKEVUSFRvU2VuZCA+IDApIHsKICAgICAgICAgICAgYXN5bmNTZW5kKG1zZy5zZW5kZXIsIEVUSFRvU2VuZCk7IC8vIHB1bGwgcGF5bWVudCB0byBnZXQgcmVmdW5kIGluIEVUSAogICAgICAgIH0KICAgIH0KfQ=='.
	

]
