Class {
	#name : #SRT58534c480ef96b6478940f9bbf6748da8f2ec935,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT58534c480ef96b6478940f9bbf6748da8f2ec935 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTc7CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBBcHBsaWNhdGlvbiBFbnRpdHkgR2VuZXJpYyBDb250cmFjdAogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjYwMGQwOTAzMGIxOTIwMGUwZjE3MGMwOTE2MDU0ZTEyMGYiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+PgoKICAgIFVzZWQgZm9yIHRoZSBBQkkgaW50ZXJmYWNlIHdoZW4gYXNzZXRzIG5lZWQgdG8gY2FsbCBBcHBsaWNhdGlvbiBFbnRpdHkuCgogICAgVGhpcyBpcyByZXF1aXJlZCwgb3RoZXJ3aXNlIHdlIGVuZCB1cCBsb2FkaW5nIHRoZSBhc3NldHMgdGhlbXNlbHZlcyB3aGVuIHdlIGxvYWQgdGhlIEFwcGxpY2F0aW9uRW50aXR5IGNvbnRyYWN0CiAgICBhbmQgZW5kIHVwIGluIGEgbG9vcAoqLwoKCgpjb250cmFjdCBBcHBsaWNhdGlvbkVudGl0eUFCSSB7CgogICAgYWRkcmVzcyBwdWJsaWMgUHJvcG9zYWxzRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgRnVuZGluZ0VudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIE1pbGVzdG9uZXNFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBNZWV0aW5nc0VudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIEJvdW50eU1hbmFnZXJFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBUb2tlbk1hbmFnZXJFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBMaXN0aW5nQ29udHJhY3RFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBGdW5kaW5nTWFuYWdlckVudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIE5ld3NDb250cmFjdEVudGl0eTsKCiAgICBib29sIHB1YmxpYyBfaW5pdGlhbGl6ZWQgPSBmYWxzZTsKICAgIGJvb2wgcHVibGljIF9sb2NrZWQgPSBmYWxzZTsKICAgIHVpbnQ4IHB1YmxpYyBDdXJyZW50RW50aXR5U3RhdGU7CiAgICB1aW50OCBwdWJsaWMgQXNzZXRDb2xsZWN0aW9uTnVtOwogICAgYWRkcmVzcyBwdWJsaWMgR2F0ZXdheUludGVyZmFjZUFkZHJlc3M7CiAgICBhZGRyZXNzIHB1YmxpYyBkZXBsb3llckFkZHJlc3M7CiAgICBhZGRyZXNzIHRlc3RBZGRyZXNzQWxsb3dVcGdyYWRlRnJvbTsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludDgpIHB1YmxpYyBFbnRpdHlTdGF0ZXM7CiAgICBtYXBwaW5nIChieXRlczMyID0+IGFkZHJlc3MpIHB1YmxpYyBBc3NldENvbGxlY3Rpb247CiAgICBtYXBwaW5nICh1aW50OCA9PiBieXRlczMyKSBwdWJsaWMgQXNzZXRDb2xsZWN0aW9uSWRUb05hbWU7CiAgICBtYXBwaW5nIChieXRlczMyID0+IHVpbnQyNTYpIHB1YmxpYyBCeWxhd3NVaW50MjU2OwogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiBieXRlczMyKSBwdWJsaWMgQnlsYXdzQnl0ZXMzMjsKCiAgICBmdW5jdGlvbiBBcHBsaWNhdGlvbkVudGl0eSgpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGdldEVudGl0eVN0YXRlKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gbGlua1RvR2F0ZXdheSggYWRkcmVzcyBfR2F0ZXdheUludGVyZmFjZUFkZHJlc3MsIGJ5dGVzMzIgX3NvdXJjZUNvZGVVcmwgKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIHNldFVwZ3JhZGVTdGF0ZSh1aW50OCBzdGF0ZSkgcHVibGljIDsKICAgIGZ1bmN0aW9uIGFkZEFzc2V0UHJvcG9zYWxzKGFkZHJlc3MgX2Fzc2V0QWRkcmVzc2VzKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIGFkZEFzc2V0RnVuZGluZyhhZGRyZXNzIF9hc3NldEFkZHJlc3NlcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBhZGRBc3NldE1pbGVzdG9uZXMoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYWRkQXNzZXRNZWV0aW5ncyhhZGRyZXNzIF9hc3NldEFkZHJlc3NlcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBhZGRBc3NldEJvdW50eU1hbmFnZXIoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYWRkQXNzZXRUb2tlbk1hbmFnZXIoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYWRkQXNzZXRGdW5kaW5nTWFuYWdlcihhZGRyZXNzIF9hc3NldEFkZHJlc3NlcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBhZGRBc3NldExpc3RpbmdDb250cmFjdChhZGRyZXNzIF9hc3NldEFkZHJlc3NlcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBhZGRBc3NldE5ld3NDb250cmFjdChhZGRyZXNzIF9hc3NldEFkZHJlc3NlcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBnZXRBc3NldEFkZHJlc3NCeU5hbWUoYnl0ZXMzMiBfbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyk7CiAgICBmdW5jdGlvbiBzZXRCeWxhd1VpbnQyNTYoYnl0ZXMzMiBuYW1lLCB1aW50MjU2IHZhbHVlKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBnZXRCeWxhd1VpbnQyNTYoYnl0ZXMzMiBuYW1lKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHNldEJ5bGF3Qnl0ZXMzMihieXRlczMyIG5hbWUsIGJ5dGVzMzIgdmFsdWUpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGdldEJ5bGF3Qnl0ZXMzMihieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJ5dGVzMzIpOwogICAgZnVuY3Rpb24gaW5pdGlhbGl6ZSgpIGV4dGVybmFsIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0UGFyZW50QWRkcmVzcygpIGV4dGVybmFsIHZpZXcgcmV0dXJucyhhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIGNyZWF0ZUNvZGVVcGdyYWRlUHJvcG9zYWwoIGFkZHJlc3MgX25ld0FkZHJlc3MsIGJ5dGVzMzIgX3NvdXJjZUNvZGVVcmwgKSBleHRlcm5hbCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGFjY2VwdENvZGVVcGdyYWRlUHJvcG9zYWwoYWRkcmVzcyBfbmV3QWRkcmVzcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBpbml0aWFsaXplQXNzZXRzVG9UaGlzQXBwbGljYXRpb24oKSBleHRlcm5hbCByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyQXNzZXRzVG9OZXdBcHBsaWNhdGlvbihhZGRyZXNzIF9uZXdBZGRyZXNzKSBleHRlcm5hbCByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGxvY2soKSBleHRlcm5hbCByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGNhbkluaXRpYXRlQ29kZVVwZ3JhZGUoYWRkcmVzcyBfc2VuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zKGJvb2wpOwogICAgZnVuY3Rpb24gZG9TdGF0ZUNoYW5nZXMoKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBoYXNSZXF1aXJlZFN0YXRlQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gYW55QXNzZXRIYXNDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBleHRlbmRlZEFueUFzc2V0SGFzQ2hhbmdlcygpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRSZXF1aXJlZFN0YXRlQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4LCB1aW50OCk7CiAgICBmdW5jdGlvbiBnZXRUaW1lc3RhbXAoKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KTsKCn0KCi8qCgogKiBzb3VyY2UgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL2Jsb2NrYml0c2lvLwoKICogQG5hbWUgICAgICAgIEFwcGxpY2F0aW9uIEFzc2V0IENvbnRyYWN0CiAqIEBwYWNrYWdlICAgICBCbG9ja0JpdHNJTwogKiBAYXV0aG9yICAgICAgTWlja3kgU29jYWNpIDw8YSBocmVmPSIvY2RuLWNnaS9sL2VtYWlsLXByb3RlY3Rpb24iIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iYzVhOGFjYTZhZWJjODVhYmFhYjJhOWFjYjNhMGViYjdhYSI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvYT4+CgogQW55IGNvbnRyYWN0IGluaGVyaXRpbmcgdGhpcyB3aWxsIGJlIHVzYWJsZSBhcyBhbiBBc3NldCBpbiB0aGUgQXBwbGljYXRpb24gRW50aXR5CgoqLwoKCgoKY29udHJhY3QgQXBwbGljYXRpb25Bc3NldCB7CgogICAgZXZlbnQgRXZlbnRBcHBBc3NldE93bmVyU2V0KGJ5dGVzMzIgaW5kZXhlZCBfbmFtZSwgYWRkcmVzcyBpbmRleGVkIF9vd25lcik7CiAgICBldmVudCBFdmVudFJ1bkJlZm9yZUluaXQoYnl0ZXMzMiBpbmRleGVkIF9uYW1lKTsKICAgIGV2ZW50IEV2ZW50UnVuQmVmb3JlQXBwbHlpbmdTZXR0aW5ncyhieXRlczMyIGluZGV4ZWQgX25hbWUpOwoKCiAgICBtYXBwaW5nIChieXRlczMyID0+IHVpbnQ4KSBwdWJsaWMgRW50aXR5U3RhdGVzOwogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiB1aW50OCkgcHVibGljIFJlY29yZFN0YXRlczsKICAgIHVpbnQ4IHB1YmxpYyBDdXJyZW50RW50aXR5U3RhdGU7CgogICAgZXZlbnQgRXZlbnRFbnRpdHlQcm9jZXNzb3IoYnl0ZXMzMiBpbmRleGVkIF9hc3NldE5hbWUsIHVpbnQ4IGluZGV4ZWQgX2N1cnJlbnQsIHVpbnQ4IGluZGV4ZWQgX3JlcXVpcmVkKTsKICAgIGV2ZW50IERlYnVnRW50aXR5UmVxdWlyZWRDaGFuZ2VzKCBieXRlczMyIF9hc3NldE5hbWUsIHVpbnQ4IGluZGV4ZWQgX2N1cnJlbnQsIHVpbnQ4IGluZGV4ZWQgX3JlcXVpcmVkICk7CgogICAgYnl0ZXMzMiBwdWJsaWMgYXNzZXROYW1lOwoKICAgIC8qIEFzc2V0IHJlY29yZHMgKi8KICAgIHVpbnQ4IHB1YmxpYyBSZWNvcmROdW0gPSAwOwoKICAgIC8qIEFzc2V0IGluaXRpYWxpc2VkIG9yIG5vdCAqLwogICAgYm9vbCBwdWJsaWMgX2luaXRpYWxpemVkID0gZmFsc2U7CgogICAgLyogQXNzZXQgc2V0dGluZ3MgcHJlc2VudCBvciBub3QgKi8KICAgIGJvb2wgcHVibGljIF9zZXR0aW5nc0FwcGxpZWQgPSBmYWxzZTsKCiAgICAvKiBBc3NldCBvd25lciAoIEFwcGxpY2F0aW9uRW50aXR5IGFkZHJlc3MgKSAqLwogICAgYWRkcmVzcyBwdWJsaWMgb3duZXIgPSBhZGRyZXNzKDB4MCkgOwogICAgYWRkcmVzcyBwdWJsaWMgZGVwbG95ZXJBZGRyZXNzOwoKICAgIGZ1bmN0aW9uIEFwcGxpY2F0aW9uQXNzZXQoKSBwdWJsaWMgewogICAgICAgIGRlcGxveWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0SW5pdGlhbEFwcGxpY2F0aW9uQWRkcmVzcyhhZGRyZXNzIF9vd25lckFkZHJlc3MpIHB1YmxpYyBvbmx5RGVwbG95ZXIgcmVxdWlyZU5vdEluaXRpYWxpc2VkIHsKICAgICAgICBvd25lciA9IF9vd25lckFkZHJlc3M7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0SW5pdGlhbE93bmVyQW5kTmFtZShieXRlczMyIF9uYW1lKSBleHRlcm5hbAogICAgICAgIHJlcXVpcmVOb3RJbml0aWFsaXNlZAogICAgICAgIG9ubHlPd25lcgogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgLy8gaW5pdCBzdGF0ZXMKICAgICAgICBzZXRBc3NldFN0YXRlcygpOwogICAgICAgIGFzc2V0TmFtZSA9IF9uYW1lOwogICAgICAgIC8vIHNldCBpbml0aWFsIHN0YXRlCiAgICAgICAgQ3VycmVudEVudGl0eVN0YXRlID0gZ2V0RW50aXR5U3RhdGUoIk5FVyIpOwogICAgICAgIHJ1bkJlZm9yZUluaXRpYWxpemF0aW9uKCk7CiAgICAgICAgX2luaXRpYWxpemVkID0gdHJ1ZTsKICAgICAgICBFdmVudEFwcEFzc2V0T3duZXJTZXQoX25hbWUsIG93bmVyKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRBc3NldFN0YXRlcygpIGludGVybmFsIHsKICAgICAgICAvLyBBc3NldCBTdGF0ZXMKICAgICAgICBFbnRpdHlTdGF0ZXNbIl9fSUdOT1JFRF9fIl0gICAgID0gMDsKICAgICAgICBFbnRpdHlTdGF0ZXNbIk5FVyJdICAgICAgICAgICAgID0gMTsKICAgICAgICAvLyBGdW5kaW5nIFN0YWdlIFN0YXRlcwogICAgICAgIFJlY29yZFN0YXRlc1siX19JR05PUkVEX18iXSAgICAgPSAwOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFJlY29yZFN0YXRlKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gUmVjb3JkU3RhdGVzW25hbWVdOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEVudGl0eVN0YXRlKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gRW50aXR5U3RhdGVzW25hbWVdOwogICAgfQoKICAgIGZ1bmN0aW9uIHJ1bkJlZm9yZUluaXRpYWxpemF0aW9uKCkgaW50ZXJuYWwgcmVxdWlyZU5vdEluaXRpYWxpc2VkICB7CiAgICAgICAgRXZlbnRSdW5CZWZvcmVJbml0KGFzc2V0TmFtZSk7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwbHlBbmRMb2NrU2V0dGluZ3MoKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlEZXBsb3llcgogICAgICAgIHJlcXVpcmVJbml0aWFsaXNlZAogICAgICAgIHJlcXVpcmVTZXR0aW5nc05vdEFwcGxpZWQKICAgICAgICByZXR1cm5zKGJvb2wpCiAgICB7CiAgICAgICAgcnVuQmVmb3JlQXBwbHlpbmdTZXR0aW5ncygpOwogICAgICAgIF9zZXR0aW5nc0FwcGxpZWQgPSB0cnVlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHJ1bkJlZm9yZUFwcGx5aW5nU2V0dGluZ3MoKSBpbnRlcm5hbCByZXF1aXJlSW5pdGlhbGlzZWQgcmVxdWlyZVNldHRpbmdzTm90QXBwbGllZCAgewogICAgICAgIEV2ZW50UnVuQmVmb3JlQXBwbHlpbmdTZXR0aW5ncyhhc3NldE5hbWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyVG9OZXdPd25lcihhZGRyZXNzIF9uZXdPd25lcikgcHVibGljIHJlcXVpcmVJbml0aWFsaXNlZCBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUob3duZXIgIT0gYWRkcmVzcygweDApICYmIF9uZXdPd25lciAhPSBhZGRyZXNzKDB4MCkpOwogICAgICAgIG93bmVyID0gX25ld093bmVyOwogICAgICAgIEV2ZW50QXBwQXNzZXRPd25lclNldChhc3NldE5hbWUsIG93bmVyKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvbkFzc2V0QWRkcmVzc0J5TmFtZShieXRlczMyIF9uYW1lKQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zKGFkZHJlc3MpCiAgICB7CiAgICAgICAgYWRkcmVzcyBhc3NldCA9IEFwcGxpY2F0aW9uRW50aXR5QUJJKG93bmVyKS5nZXRBc3NldEFkZHJlc3NCeU5hbWUoX25hbWUpOwogICAgICAgIGlmKCBhc3NldCAhPSBhZGRyZXNzKDB4MCkgKSB7CiAgICAgICAgICAgIHJldHVybiBhc3NldDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QXBwbGljYXRpb25TdGF0ZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgcmV0dXJuIEFwcGxpY2F0aW9uRW50aXR5QUJJKG93bmVyKS5DdXJyZW50RW50aXR5U3RhdGUoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvbkVudGl0eVN0YXRlKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gQXBwbGljYXRpb25FbnRpdHlBQkkob3duZXIpLmdldEVudGl0eVN0YXRlKG5hbWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEFwcEJ5bGF3VWludDI1NihieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJlcXVpcmVJbml0aWFsaXNlZCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgQXBwbGljYXRpb25FbnRpdHlBQkkgQ3VycmVudEFwcCA9IEFwcGxpY2F0aW9uRW50aXR5QUJJKG93bmVyKTsKICAgICAgICByZXR1cm4gQ3VycmVudEFwcC5nZXRCeWxhd1VpbnQyNTYobmFtZSk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QXBwQnlsYXdCeXRlczMyKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmVxdWlyZUluaXRpYWxpc2VkIHJldHVybnMgKGJ5dGVzMzIpIHsKICAgICAgICBBcHBsaWNhdGlvbkVudGl0eUFCSSBDdXJyZW50QXBwID0gQXBwbGljYXRpb25FbnRpdHlBQkkob3duZXIpOwogICAgICAgIHJldHVybiBDdXJyZW50QXBwLmdldEJ5bGF3Qnl0ZXMzMihuYW1lKTsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlBcHBsaWNhdGlvbkVudGl0eSgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgcmVxdWlyZUluaXRpYWxpc2VkKCkgewogICAgICAgIHJlcXVpcmUoX2luaXRpYWxpemVkID09IHRydWUpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgcmVxdWlyZU5vdEluaXRpYWxpc2VkKCkgewogICAgICAgIHJlcXVpcmUoX2luaXRpYWxpemVkID09IGZhbHNlKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIHJlcXVpcmVTZXR0aW5nc0FwcGxpZWQoKSB7CiAgICAgICAgcmVxdWlyZShfc2V0dGluZ3NBcHBsaWVkID09IHRydWUpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgcmVxdWlyZVNldHRpbmdzTm90QXBwbGllZCgpIHsKICAgICAgICByZXF1aXJlKF9zZXR0aW5nc0FwcGxpZWQgPT0gZmFsc2UpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seURlcGxveWVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBkZXBsb3llckFkZHJlc3MpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seUFzc2V0KGJ5dGVzMzIgX25hbWUpIHsKICAgICAgICBhZGRyZXNzIEFzc2V0QWRkcmVzcyA9IGdldEFwcGxpY2F0aW9uQXNzZXRBZGRyZXNzQnlOYW1lKF9uYW1lKTsKICAgICAgICByZXF1aXJlKCBtc2cuc2VuZGVyID09IEFzc2V0QWRkcmVzcyk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRUaW1lc3RhbXAoKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIG5vdzsKICAgIH0KCgp9CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBBcHBsaWNhdGlvbiBBc3NldCBDb250cmFjdCBBQkkKICogQHBhY2thZ2UgICAgIEJsb2NrQml0c0lPCiAqIEBhdXRob3IgICAgICBNaWNreSBTb2NhY2kgPDxhIGhyZWY9Ii9jZG4tY2dpL2wvZW1haWwtcHJvdGVjdGlvbiIgY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSJkZGIwYjRiZWI2YTQ5ZGIzYjJhYWIxYjRhYmI4ZjNhZmIyIj5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9hPj4KCiBBbnkgY29udHJhY3QgaW5oZXJpdGluZyB0aGlzIHdpbGwgYmUgdXNhYmxlIGFzIGFuIEFzc2V0IGluIHRoZSBBcHBsaWNhdGlvbiBFbnRpdHkKCiovCgoKCmNvbnRyYWN0IEFCSUFwcGxpY2F0aW9uQXNzZXQgewoKICAgIGJ5dGVzMzIgcHVibGljIGFzc2V0TmFtZTsKICAgIHVpbnQ4IHB1YmxpYyBDdXJyZW50RW50aXR5U3RhdGU7CiAgICB1aW50OCBwdWJsaWMgUmVjb3JkTnVtOwogICAgYm9vbCBwdWJsaWMgX2luaXRpYWxpemVkOwogICAgYm9vbCBwdWJsaWMgX3NldHRpbmdzQXBwbGllZDsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwogICAgYWRkcmVzcyBwdWJsaWMgZGVwbG95ZXJBZGRyZXNzOwogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiB1aW50OCkgcHVibGljIEVudGl0eVN0YXRlczsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludDgpIHB1YmxpYyBSZWNvcmRTdGF0ZXM7CgogICAgZnVuY3Rpb24gc2V0SW5pdGlhbEFwcGxpY2F0aW9uQWRkcmVzcyhhZGRyZXNzIF9vd25lckFkZHJlc3MpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIHNldEluaXRpYWxPd25lckFuZE5hbWUoYnl0ZXMzMiBfbmFtZSkgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRSZWNvcmRTdGF0ZShieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGdldEVudGl0eVN0YXRlKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gYXBwbHlBbmRMb2NrU2V0dGluZ3MoKSBwdWJsaWMgcmV0dXJucyhib29sKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyVG9OZXdPd25lcihhZGRyZXNzIF9uZXdPd25lcikgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0QXBwbGljYXRpb25Bc3NldEFkZHJlc3NCeU5hbWUoYnl0ZXMzMiBfbmFtZSkgcHVibGljIHJldHVybnMoYWRkcmVzcyk7CiAgICBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvblN0YXRlKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gZ2V0QXBwbGljYXRpb25FbnRpdHlTdGF0ZShieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGdldEFwcEJ5bGF3VWludDI1NihieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gZ2V0QXBwQnlsYXdCeXRlczMyKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAoYnl0ZXMzMik7CiAgICBmdW5jdGlvbiBnZXRUaW1lc3RhbXAoKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KTsKCgp9CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBGdW5kaW5nIENvbnRyYWN0IEFCSQogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjQxMmMyODIyMmEzODAxMmYyZTM2MmQyODM3MjQ2ZjMzMmUiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+PgoKIENvbnRhaW5zIHRoZSBGdW5kaW5nIENvbnRyYWN0IGNvZGUgZGVwbG95ZWQgYW5kIGxpbmtlZCB0byB0aGUgQXBwbGljYXRpb24gRW50aXR5CgoqLwoKCgoKCmNvbnRyYWN0IEFCSUZ1bmRpbmdNYW5hZ2VyIGlzIEFCSUFwcGxpY2F0aW9uQXNzZXQgewoKICAgIGJvb2wgcHVibGljIGZ1bmRpbmdQcm9jZXNzZWQ7CiAgICBib29sIEZ1bmRpbmdQb29sQmFsYW5jZXNBbGxvY2F0ZWQ7CiAgICB1aW50OCBwdWJsaWMgVmF1bHRDb3VudFBlclByb2Nlc3M7CiAgICB1aW50MjU2IHB1YmxpYyBsYXN0UHJvY2Vzc2VkVmF1bHRJZDsKICAgIHVpbnQyNTYgcHVibGljIHZhdWx0TnVtOwogICAgdWludDI1NiBwdWJsaWMgTG9ja2VkVm90aW5nVG9rZW5zOwogICAgYnl0ZXMzMiBwdWJsaWMgY3VycmVudFRhc2s7CiAgICBtYXBwaW5nIChieXRlczMyID0+IGJvb2wpIHB1YmxpYyB0YXNrQnlIYXNoOwogICAgbWFwcGluZyAgKGFkZHJlc3MgPT4gYWRkcmVzcykgcHVibGljIHZhdWx0TGlzdDsKICAgIG1hcHBpbmcgICh1aW50MjU2ID0+IGFkZHJlc3MpIHB1YmxpYyB2YXVsdEJ5SWQ7CgogICAgZnVuY3Rpb24gcmVjZWl2ZVBheW1lbnQoYWRkcmVzcyBfc2VuZGVyLCB1aW50OCBfcGF5bWVudF9tZXRob2QsIHVpbnQ4IF9mdW5kaW5nX3N0YWdlKSBwYXlhYmxlIHB1YmxpYyByZXR1cm5zKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0TXlWYXVsdEFkZHJlc3MoYWRkcmVzcyBfc2VuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIHNldFZhdWx0Q291bnRQZXJQcm9jZXNzKHVpbnQ4IF9wZXJQcm9jZXNzKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIGdldEhhc2goYnl0ZXMzMiBhY3Rpb25UeXBlLCBieXRlczMyIGFyZzEpIHB1YmxpYyBwdXJlIHJldHVybnMgKCBieXRlczMyICk7CiAgICBmdW5jdGlvbiBnZXRDdXJyZW50TWlsZXN0b25lUHJvY2Vzc2VkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBwcm9jZXNzRnVuZGluZ0ZhaWxlZEZpbmlzaGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBwcm9jZXNzRnVuZGluZ1N1Y2Nlc3NmdWxGaW5pc2hlZCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0Q3VycmVudE1pbGVzdG9uZUlkSGFzaCgpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYnl0ZXMzMik7CiAgICBmdW5jdGlvbiBwcm9jZXNzTWlsZXN0b25lRmluaXNoZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIHByb2Nlc3NFbWVyZ2VuY3lGdW5kUmVsZWFzZUZpbmlzaGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRBZnRlclRyYW5zZmVyTG9ja2VkVG9rZW5CYWxhbmNlcyhhZGRyZXNzIHZhdWx0QWRkcmVzcywgYm9vbCBleGNsdWRlQ3VycmVudCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBWYXVsdFJlcXVlc3RlZFVwZGF0ZUZvckxvY2tlZFZvdGluZ1Rva2VucyhhZGRyZXNzIG93bmVyKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBkb1N0YXRlQ2hhbmdlcygpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGhhc1JlcXVpcmVkU3RhdGVDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRSZXF1aXJlZFN0YXRlQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4LCB1aW50OCk7CiAgICBmdW5jdGlvbiBBcHBsaWNhdGlvbkluRnVuZGluZ09yRGV2ZWxvcG1lbnQoKSBwdWJsaWMgdmlldyByZXR1cm5zKGJvb2wpOwoKfQoKLyoKCiAqIHNvdXJjZSAgICAgICBodHRwczovL2dpdGh1Yi5jb20vYmxvY2tiaXRzaW8vCgogKiBAbmFtZSAgICAgICAgVG9rZW4gTWFuYWdlciBDb250cmFjdAogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjdkMTAxNDFlMTYwNDNkMTMxMjBhMTExNDBiMTg1MzBmMTIiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+PgoKKi8KCgoKCgpjb250cmFjdCBBQklUb2tlbk1hbmFnZXIgaXMgQUJJQXBwbGljYXRpb25Bc3NldCB7CgogICAgYWRkcmVzcyBwdWJsaWMgVG9rZW5TQ0FEQUVudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIFRva2VuRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgTWFya2V0aW5nTWV0aG9kQWRkcmVzczsKICAgIGJvb2wgT3duZXJUb2tlbkJhbGFuY2VzUmVsZWFzZWQgPSBmYWxzZTsKCiAgICBmdW5jdGlvbiBhZGRTZXR0aW5ncyhhZGRyZXNzIF9zY2FkYUFkZHJlc3MsIGFkZHJlc3MgX3Rva2VuQWRkcmVzcywgYWRkcmVzcyBfbWFya2V0aW5nICkgcHVibGljOwogICAgZnVuY3Rpb24gZ2V0VG9rZW5TQ0FEQVJlcXVpcmVzSGFyZENhcCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBmaW5pc2hNaW50aW5nKCkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gbWludEZvck1hcmtldGluZ1Bvb2woYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBSZWxlYXNlT3duZXJzTG9ja2VkVG9rZW5zKGFkZHJlc3MgX211bHRpU2lnT3V0cHV0QWRkcmVzcykgcHVibGljIHJldHVybnMgKGJvb2wpOwoKfQoKLyoKCiAqIHNvdXJjZSAgICAgICBodHRwczovL2dpdGh1Yi5jb20vYmxvY2tiaXRzaW8vCgogKiBAbmFtZSAgICAgICAgR2VuZXJhbCBGdW5kaW5nIElucHV0IENvbnRyYWN0IEFCSQogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjY4MDUwMTBiMDMxMTI4MDYwNzFmMDQwMTFlMGQ0NjFhMDciPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+PgoKKi8KCgoKY29udHJhY3QgQUJJRnVuZGluZ0lucHV0R2VuZXJhbCB7CgogICAgYm9vbCBwdWJsaWMgaW5pdGlhbGl6ZWQgPSBmYWxzZTsKICAgIHVpbnQ4IHB1YmxpYyB0eXBlSWQ7CiAgICBhZGRyZXNzIHB1YmxpYyBGdW5kaW5nQXNzZXRBZGRyZXNzOwoKICAgIGV2ZW50IEV2ZW50SW5wdXRQYXltZW50UmVjZWl2ZWQoYWRkcmVzcyBzZW5kZXIsIHVpbnQgYW1vdW50LCB1aW50OCBfdHlwZSk7CgogICAgZnVuY3Rpb24gc2V0RnVuZGluZ0Fzc2V0QWRkcmVzcyhhZGRyZXNzIF9hZGRyKSBwdWJsaWM7CiAgICBmdW5jdGlvbiAoKSBwdWJsaWMgcGF5YWJsZTsKICAgIGZ1bmN0aW9uIGJ1eSgpIHB1YmxpYyBwYXlhYmxlIHJldHVybnMoYm9vbCk7Cn0KCi8qCgogKiBzb3VyY2UgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL2Jsb2NrYml0c2lvLwoKICogQG5hbWUgICAgICAgIEZ1bmRpbmcgQ29udHJhY3QKICogQHBhY2thZ2UgICAgIEJsb2NrQml0c0lPCiAqIEBhdXRob3IgICAgICBNaWNreSBTb2NhY2kgPDxhIGhyZWY9Ii9jZG4tY2dpL2wvZW1haWwtcHJvdGVjdGlvbiIgY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSI0YzIxMjUyZjI3MzUwYzIyMjMzYjIwMjUzYTI5NjIzZTIzIj5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9hPj4KCiBDb250YWlucyB0aGUgRnVuZGluZyBDb250cmFjdCBjb2RlIGRlcGxveWVkIGFuZCBsaW5rZWQgdG8gdGhlIEFwcGxpY2F0aW9uIEVudGl0eQoKICEhISBMaW5rcyBkaXJlY3RseSB0byBNaWxlc3RvbmVzCgoqLwoKCgoKCgoKCgoKY29udHJhY3QgRnVuZGluZyBpcyBBcHBsaWNhdGlvbkFzc2V0IHsKCiAgICBhZGRyZXNzIHB1YmxpYyBtdWx0aVNpZ091dHB1dEFkZHJlc3M7CiAgICBBQklGdW5kaW5nSW5wdXRHZW5lcmFsIHB1YmxpYyBEaXJlY3RJbnB1dDsKICAgIEFCSUZ1bmRpbmdJbnB1dEdlbmVyYWwgcHVibGljIE1pbGVzdG9uZUlucHV0OwoKICAgIC8vIG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludDgpIHB1YmxpYyBGdW5kaW5nTWV0aG9kczsKICAgIGVudW0gRnVuZGluZ01ldGhvZElkcyB7CiAgICAgICAgX19JR05PUkVEX18sCiAgICAgICAgRElSRUNUX09OTFksIAkJCQkvLwogICAgICAgIE1JTEVTVE9ORV9PTkxZLCAJCSAgICAvLwogICAgICAgIERJUkVDVF9BTkRfTUlMRVNUT05FCQkvLwogICAgfQoKICAgIEFCSVRva2VuTWFuYWdlciBwdWJsaWMgVG9rZW5NYW5hZ2VyRW50aXR5OwogICAgQUJJRnVuZGluZ01hbmFnZXIgcHVibGljIEZ1bmRpbmdNYW5hZ2VyRW50aXR5OwoKICAgIGV2ZW50IEZ1bmRpbmdTdGFnZUNyZWF0ZWQoIHVpbnQ4IGluZGV4ZWQgaW5kZXgsIGJ5dGVzMzIgaW5kZXhlZCBuYW1lICk7CgogICAgc3RydWN0IEZ1bmRpbmdTdGFnZSB7CiAgICAgICAgYnl0ZXMzMiBuYW1lOwogICAgICAgIHVpbnQ4ICAgc3RhdGU7CiAgICAgICAgdWludDI1NiB0aW1lX3N0YXJ0OwogICAgICAgIHVpbnQyNTYgdGltZV9lbmQ7CiAgICAgICAgdWludDI1NiBhbW91bnRfY2FwX3NvZnQ7ICAgICAgICAgICAgLy8gMCA9IG5vdCBlbmZvcmNlZAogICAgICAgIHVpbnQyNTYgYW1vdW50X2NhcF9oYXJkOyAgICAgICAgICAgIC8vIDAgPSBub3QgZW5mb3JjZWQKICAgICAgICB1aW50MjU2IGFtb3VudF9yYWlzZWQ7ICAgICAgICAgICAgICAvLyAwID0gbm90IGVuZm9yY2VkCiAgICAgICAgLy8gZnVuZGluZyBtZXRob2Qgc2V0dGluZ3MKICAgICAgICB1aW50MjU2IG1pbmltdW1fZW50cnk7CiAgICAgICAgdWludDggICBtZXRob2RzOyAgICAgICAgICAgICAgICAgICAgLy8gRnVuZGluZ01ldGhvZElkcwogICAgICAgIC8vIHRva2VuIHNldHRpbmdzCiAgICAgICAgdWludDI1NiBmaXhlZF90b2tlbnM7CiAgICAgICAgdWludDggICBwcmljZV9hZGRpdGlvbl9wZXJjZW50YWdlOyAgLy8KICAgICAgICB1aW50OCAgIHRva2VuX3NoYXJlX3BlcmNlbnRhZ2U7CiAgICAgICAgdWludDggICBpbmRleDsKICAgIH0KCiAgICBtYXBwaW5nICh1aW50OCA9PiBGdW5kaW5nU3RhZ2UpIHB1YmxpYyBDb2xsZWN0aW9uOwogICAgdWludDggcHVibGljIEZ1bmRpbmdTdGFnZU51bSA9IDA7CiAgICB1aW50OCBwdWJsaWMgY3VycmVudEZ1bmRpbmdTdGFnZSA9IDE7CgogICAgLy8gZnVuZGluZyBzZXR0aW5ncwogICAgdWludDI1NiBwdWJsaWMgQW1vdW50UmFpc2VkID0gMDsKICAgIHVpbnQyNTYgcHVibGljIE1pbGVzdG9uZUFtb3VudFJhaXNlZCA9IDA7CgogICAgdWludDI1NiBwdWJsaWMgR2xvYmFsQW1vdW50Q2FwU29mdCA9IDA7CiAgICB1aW50MjU2IHB1YmxpYyBHbG9iYWxBbW91bnRDYXBIYXJkID0gMDsKCiAgICB1aW50OCBwdWJsaWMgVG9rZW5TZWxsUGVyY2VudGFnZSA9IDA7CgogICAgdWludDI1NiBwdWJsaWMgRnVuZGluZ19TZXR0aW5nX2Z1bmRpbmdfdGltZV9zdGFydCA9IDA7CiAgICB1aW50MjU2IHB1YmxpYyBGdW5kaW5nX1NldHRpbmdfZnVuZGluZ190aW1lX2VuZCA9IDA7CgogICAgdWludDI1NiBwdWJsaWMgRnVuZGluZ19TZXR0aW5nX2Nhc2hiYWNrX3RpbWVfc3RhcnQgPSAwOwogICAgLy8gZW5kIHRpbWUgaXMgaWdub3JlZCBhdCB0aGlzIHN0YWdlLCBhbnlvbmUgY2FuIGNhc2hiYWNrIGZvcmV2ZXIgaWYgZnVuZGluZyBmYWlscy4KICAgIHVpbnQyNTYgcHVibGljIEZ1bmRpbmdfU2V0dGluZ19jYXNoYmFja190aW1lX2VuZCA9IDA7CgogICAgLy8gdG8gYmUgdGFrZW4gZnJvbSBhcHBsaWNhdGlvbiBieWxhd3MKICAgIHVpbnQyNTYgcHVibGljIEZ1bmRpbmdfU2V0dGluZ19jYXNoYmFja19iZWZvcmVfc3RhcnRfd2FpdF9kdXJhdGlvbiA9IDcgZGF5czsKICAgIHVpbnQyNTYgcHVibGljIEZ1bmRpbmdfU2V0dGluZ19jYXNoYmFja19kdXJhdGlvbiA9IDM2NSBkYXlzOwoKICAgIGV2ZW50IExpZmVDeWNsZSgpOwogICAgZXZlbnQgRGVidWdSZWNvcmRSZXF1aXJlZENoYW5nZXMoIGJ5dGVzMzIgaW5kZXhlZCBfYXNzZXROYW1lLCB1aW50OCBpbmRleGVkIF9jdXJyZW50LCB1aW50OCBpbmRleGVkIF9yZXF1aXJlZCApOwogICAgZXZlbnQgRGVidWdDYWxsQWdhaW4odWludDggaW5kZXhlZCBfd2hvKTsKCiAgICBldmVudCBFdmVudEVudGl0eVByb2Nlc3NvcihieXRlczMyIGluZGV4ZWQgX2Fzc2V0TmFtZSwgdWludDggaW5kZXhlZCBfY3VycmVudCwgdWludDggaW5kZXhlZCBfcmVxdWlyZWQpOwogICAgZXZlbnQgRXZlbnRSZWNvcmRQcm9jZXNzb3IoYnl0ZXMzMiBpbmRleGVkIF9hc3NldE5hbWUsIHVpbnQ4IGluZGV4ZWQgX2N1cnJlbnQsIHVpbnQ4IGluZGV4ZWQgX3JlcXVpcmVkKTsKCiAgICBldmVudCBEZWJ1Z0FjdGlvbihieXRlczMyIGluZGV4ZWQgX25hbWUsIGJvb2wgaW5kZXhlZCBfYWxsb3dlZCk7CgoKICAgIGV2ZW50IEV2ZW50RnVuZGluZ1JlY2VpdmVkUGF5bWVudChhZGRyZXNzIGluZGV4ZWQgX3NlbmRlciwgdWludDggaW5kZXhlZCBfcGF5bWVudF9tZXRob2QsIHVpbnQyNTYgaW5kZXhlZCBfYW1vdW50ICk7CgogICAgZnVuY3Rpb24gcnVuQmVmb3JlSW5pdGlhbGl6YXRpb24oKSBpbnRlcm5hbCByZXF1aXJlTm90SW5pdGlhbGlzZWQgewoKICAgICAgICAvLyBpbnN0YW50aWF0ZSB0b2tlbiBtYW5hZ2VyLCBtb3ZlZCBmcm9tIHJ1bkJlZm9yZUFwcGx5aW5nU2V0dGluZ3MKICAgICAgICBUb2tlbk1hbmFnZXJFbnRpdHkgPSBBQklUb2tlbk1hbmFnZXIoIGdldEFwcGxpY2F0aW9uQXNzZXRBZGRyZXNzQnlOYW1lKCdUb2tlbk1hbmFnZXInKSApOwogICAgICAgIEZ1bmRpbmdNYW5hZ2VyRW50aXR5ID0gQUJJRnVuZGluZ01hbmFnZXIoIGdldEFwcGxpY2F0aW9uQXNzZXRBZGRyZXNzQnlOYW1lKCdGdW5kaW5nTWFuYWdlcicpICk7CgogICAgICAgIEV2ZW50UnVuQmVmb3JlSW5pdChhc3NldE5hbWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEFzc2V0U3RhdGVzKCkgaW50ZXJuYWwgewogICAgICAgIC8vIEFzc2V0IFN0YXRlcwogICAgICAgIEVudGl0eVN0YXRlc1siX19JR05PUkVEX18iXSAgICAgPSAwOwogICAgICAgIEVudGl0eVN0YXRlc1siTkVXIl0gICAgICAgICAgICAgPSAxOwogICAgICAgIEVudGl0eVN0YXRlc1siV0FJVElORyJdICAgICAgICAgPSAyOwogICAgICAgIEVudGl0eVN0YXRlc1siSU5fUFJPR1JFU1MiXSAgICAgPSAzOwogICAgICAgIEVudGl0eVN0YXRlc1siQ09PTERPV04iXSAgICAgICAgPSA0OwogICAgICAgIEVudGl0eVN0YXRlc1siRlVORElOR19FTkRFRCJdICAgPSA1OwogICAgICAgIEVudGl0eVN0YXRlc1siRkFJTEVEIl0gICAgICAgICAgPSA2OwogICAgICAgIEVudGl0eVN0YXRlc1siRkFJTEVEX0ZJTkFMIl0gICAgPSA3OwogICAgICAgIEVudGl0eVN0YXRlc1siU1VDQ0VTU0ZVTCJdICAgICAgPSA4OwogICAgICAgIEVudGl0eVN0YXRlc1siU1VDQ0VTU0ZVTF9GSU5BTCJdPSA5OwoKICAgICAgICAvLyBGdW5kaW5nIFN0YWdlIFN0YXRlcwogICAgICAgIFJlY29yZFN0YXRlc1siX19JR05PUkVEX18iXSAgICAgPSAwOwogICAgICAgIFJlY29yZFN0YXRlc1siTkVXIl0gICAgICAgICAgICAgPSAxOwogICAgICAgIFJlY29yZFN0YXRlc1siSU5fUFJPR1JFU1MiXSAgICAgPSAyOwogICAgICAgIFJlY29yZFN0YXRlc1siRklOQUwiXSAgICAgICAgICAgPSAzOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZFNldHRpbmdzKGFkZHJlc3MgX291dHB1dEFkZHJlc3MsIHVpbnQyNTYgc29mdF9jYXAsIHVpbnQyNTYgaGFyZF9jYXAsIHVpbnQ4IHNhbGVfcGVyY2VudGFnZSwgYWRkcmVzcyBfZGlyZWN0LCBhZGRyZXNzIF9taWxlc3RvbmUgKQogICAgICAgIHB1YmxpYwogICAgICAgIHJlcXVpcmVJbml0aWFsaXNlZAogICAgICAgIHJlcXVpcmVTZXR0aW5nc05vdEFwcGxpZWQKICAgIHsKICAgICAgICBpZihzb2Z0X2NhcCA+IGhhcmRfY2FwKSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KCiAgICAgICAgbXVsdGlTaWdPdXRwdXRBZGRyZXNzID0gX291dHB1dEFkZHJlc3M7CiAgICAgICAgR2xvYmFsQW1vdW50Q2FwU29mdCA9IHNvZnRfY2FwOwogICAgICAgIEdsb2JhbEFtb3VudENhcEhhcmQgPSBoYXJkX2NhcDsKCiAgICAgICAgaWYoc2FsZV9wZXJjZW50YWdlID4gOTApIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQoKICAgICAgICBUb2tlblNlbGxQZXJjZW50YWdlID0gc2FsZV9wZXJjZW50YWdlOwoKICAgICAgICBEaXJlY3RJbnB1dCA9IEFCSUZ1bmRpbmdJbnB1dEdlbmVyYWwoX2RpcmVjdCk7CiAgICAgICAgTWlsZXN0b25lSW5wdXQgPSBBQklGdW5kaW5nSW5wdXRHZW5lcmFsKF9taWxlc3RvbmUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZEZ1bmRpbmdTdGFnZSgKICAgICAgICBieXRlczMyIF9uYW1lLAogICAgICAgIHVpbnQyNTYgX3RpbWVfc3RhcnQsCiAgICAgICAgdWludDI1NiBfdGltZV9lbmQsCiAgICAgICAgdWludDI1NiBfYW1vdW50X2NhcF9zb2Z0LAogICAgICAgIHVpbnQyNTYgX2Ftb3VudF9jYXBfaGFyZCwgICAvLyByZXF1aXJlZCA+IDAKICAgICAgICB1aW50OCAgIF9tZXRob2RzLAogICAgICAgIHVpbnQyNTYgX21pbmltdW1fZW50cnksCiAgICAgICAgdWludDI1NiBfZml4ZWRfdG9rZW5zLAogICAgICAgIHVpbnQ4ICAgX3ByaWNlX2FkZGl0aW9uX3BlcmNlbnRhZ2UsCiAgICAgICAgdWludDggICBfdG9rZW5fc2hhcmVfcGVyY2VudGFnZQogICAgKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlEZXBsb3llcgogICAgICAgIHJlcXVpcmVJbml0aWFsaXNlZAogICAgICAgIHJlcXVpcmVTZXR0aW5nc05vdEFwcGxpZWQKICAgIHsKCiAgICAgICAgLy8gbWFrZSBzdXJlIGVuZCB0aW1lIGlzIGxhdGVyIHRoYW4gc3RhcnQgdGltZQogICAgICAgIGlmKF90aW1lX2VuZCA8PSBfdGltZV9zdGFydCkgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CgogICAgICAgIC8vIG1ha2Ugc3VyZSBoYXJkIGNhcCBleGlzdHMhCiAgICAgICAgaWYoX2Ftb3VudF9jYXBfaGFyZCA9PSAwKSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KCiAgICAgICAgLy8gbWFrZSBzdXJlIHNvZnQgY2FwIGlzIG5vdCBoaWdoZXIgdGhhbiBoYXJkIGNhcAogICAgICAgIGlmKF9hbW91bnRfY2FwX3NvZnQgPiBfYW1vdW50X2NhcF9oYXJkKSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KCiAgICAgICAgaWYoX3Rva2VuX3NoYXJlX3BlcmNlbnRhZ2UgPiAwKSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KCiAgICAgICAgRnVuZGluZ1N0YWdlIHN0b3JhZ2UgcHJldlJlY29yZCA9IENvbGxlY3Rpb25bRnVuZGluZ1N0YWdlTnVtXTsKICAgICAgICBpZihGdW5kaW5nU3RhZ2VOdW0gPiAwKSB7CgogICAgICAgICAgICAvLyBuZXcgc3RhZ2UgZG9lcyBub3Qgc3RhcnQgYmVmb3JlIHRoZSBwcmV2aW91cyBvbmUgZW5kcwogICAgICAgICAgICBpZiggX3RpbWVfc3RhcnQgPD0gcHJldlJlY29yZC50aW1lX2VuZCApIHsKICAgICAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBGdW5kaW5nU3RhZ2Ugc3RvcmFnZSByZWNvcmQgPSBDb2xsZWN0aW9uWysrRnVuZGluZ1N0YWdlTnVtXTsKICAgICAgICByZWNvcmQubmFtZSAgICAgICAgICAgICA9IF9uYW1lOwogICAgICAgIHJlY29yZC50aW1lX3N0YXJ0ICAgICAgID0gX3RpbWVfc3RhcnQ7CiAgICAgICAgcmVjb3JkLnRpbWVfZW5kICAgICAgICAgPSBfdGltZV9lbmQ7CiAgICAgICAgcmVjb3JkLmFtb3VudF9jYXBfc29mdCAgPSBfYW1vdW50X2NhcF9zb2Z0OwogICAgICAgIHJlY29yZC5hbW91bnRfY2FwX2hhcmQgID0gX2Ftb3VudF9jYXBfaGFyZDsKCiAgICAgICAgLy8gZnVuZGluZyBtZXRob2Qgc2V0dGluZ3MKICAgICAgICByZWNvcmQubWV0aG9kcyAgICAgICAgICA9IF9tZXRob2RzOwogICAgICAgIHJlY29yZC5taW5pbXVtX2VudHJ5ICAgID0gX21pbmltdW1fZW50cnk7CgogICAgICAgIC8vIHRva2VuIHNldHRpbmdzCiAgICAgICAgcmVjb3JkLmZpeGVkX3Rva2VucyAgICAgICAgICAgICAgPSBfZml4ZWRfdG9rZW5zOwogICAgICAgIHJlY29yZC5wcmljZV9hZGRpdGlvbl9wZXJjZW50YWdlID0gX3ByaWNlX2FkZGl0aW9uX3BlcmNlbnRhZ2U7CiAgICAgICAgcmVjb3JkLnRva2VuX3NoYXJlX3BlcmNlbnRhZ2UgICAgPSBfdG9rZW5fc2hhcmVfcGVyY2VudGFnZTsKCiAgICAgICAgLy8gc3RhdGUgbmV3CiAgICAgICAgcmVjb3JkLnN0YXRlID0gZ2V0UmVjb3JkU3RhdGUoIk5FVyIpOwogICAgICAgIHJlY29yZC5pbmRleCA9IEZ1bmRpbmdTdGFnZU51bTsKCiAgICAgICAgRnVuZGluZ1N0YWdlQ3JlYXRlZCggRnVuZGluZ1N0YWdlTnVtLCBfbmFtZSApOwoKICAgICAgICBhZGp1c3RGdW5kaW5nU2V0dGluZ3NCYXNlZE9uTmV3RnVuZGluZ1N0YWdlKCk7CiAgICB9CgogICAgZnVuY3Rpb24gYWRqdXN0RnVuZGluZ1NldHRpbmdzQmFzZWRPbk5ld0Z1bmRpbmdTdGFnZSgpIGludGVybmFsIHsKCiAgICAgICAgLy8gc2V0IGZ1bmRpbmcgc3RhcnQKICAgICAgICBGdW5kaW5nX1NldHRpbmdfZnVuZGluZ190aW1lX3N0YXJ0ID0gQ29sbGVjdGlvblsxXS50aW1lX3N0YXJ0OwogICAgICAgIC8vIHNldCBmdW5kaW5nIGVuZAogICAgICAgIEZ1bmRpbmdfU2V0dGluZ19mdW5kaW5nX3RpbWVfZW5kID0gQ29sbGVjdGlvbltGdW5kaW5nU3RhZ2VOdW1dLnRpbWVfZW5kOwoKICAgICAgICAvLyBjYXNoYmFjayBzdGFydHMgMSBkYXkgYWZ0ZXIgZnVuZGluZyBzdGF0dXMgaXMgZmFpbGVkCiAgICAgICAgRnVuZGluZ19TZXR0aW5nX2Nhc2hiYWNrX3RpbWVfc3RhcnQgPSBGdW5kaW5nX1NldHRpbmdfZnVuZGluZ190aW1lX2VuZCArIEZ1bmRpbmdfU2V0dGluZ19jYXNoYmFja19iZWZvcmVfc3RhcnRfd2FpdF9kdXJhdGlvbjsKICAgICAgICBGdW5kaW5nX1NldHRpbmdfY2FzaGJhY2tfdGltZV9lbmQgPSBGdW5kaW5nX1NldHRpbmdfY2FzaGJhY2tfdGltZV9zdGFydCArIEZ1bmRpbmdfU2V0dGluZ19jYXNoYmFja19kdXJhdGlvbjsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRTdGFnZUFtb3VudCh1aW50OCBTdGFnZUlkKSBwdWJsaWMgdmlldyByZXR1cm5zICggdWludDI1NiApIHsKICAgICAgICByZXR1cm4gQ29sbGVjdGlvbltTdGFnZUlkXS5maXhlZF90b2tlbnM7CiAgICB9CgogICAgZnVuY3Rpb24gYWxsb3dlZFBheW1lbnRNZXRob2QodWludDggX3BheW1lbnRfbWV0aG9kKSBwdWJsaWMgcHVyZSByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYoCiAgICAgICAgX3BheW1lbnRfbWV0aG9kID09IHVpbnQ4KEZ1bmRpbmdNZXRob2RJZHMuRElSRUNUX09OTFkpIHx8CiAgICAgICAgX3BheW1lbnRfbWV0aG9kID09IHVpbnQ4KEZ1bmRpbmdNZXRob2RJZHMuTUlMRVNUT05FX09OTFkpCiAgICAgICAgKXsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiByZWNlaXZlUGF5bWVudChhZGRyZXNzIF9zZW5kZXIsIHVpbnQ4IF9wYXltZW50X21ldGhvZCkKICAgICAgICBwYXlhYmxlCiAgICAgICAgcHVibGljCiAgICAgICAgcmVxdWlyZUluaXRpYWxpc2VkCiAgICAgICAgb25seUlucHV0UGF5bWVudE1ldGhvZAogICAgICAgIHJldHVybnMoYm9vbCkKICAgIHsKICAgICAgICAvLyBjaGVjayB0aGF0IG1zZy52YWx1ZSBpcyBoaWdoZXIgdGhhbiAwLCBkb24ndCByZWFsbHkgd2FudCB0byBoYXZlIHRvIGRlYWwgd2l0aCBtaW51cyBpbiBjYXNlIHRoZSBuZXR3b3JrIGJyZWFrcyB0aGlzIHNvbWVob3cKICAgICAgICBpZihhbGxvd2VkUGF5bWVudE1ldGhvZChfcGF5bWVudF9tZXRob2QpICYmIGNhbkFjY2VwdFBheW1lbnQobXNnLnZhbHVlKSApIHsKCiAgICAgICAgICAgIHVpbnQyNTYgY29udHJpYnV0ZWRfdmFsdWUgPSBtc2cudmFsdWU7CgogICAgICAgICAgICB1aW50MjU2IGFtb3VudE92ZXJDYXAgPSBnZXRWYWx1ZU92ZXJDdXJyZW50Q2FwKGNvbnRyaWJ1dGVkX3ZhbHVlKTsKICAgICAgICAgICAgaWYgKCBhbW91bnRPdmVyQ2FwID4gMCApIHsKICAgICAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSBob3cgbXVjaCB3ZSBjYW4gYWNjZXB0CgogICAgICAgICAgICAgICAgLy8gdXBkYXRlIGNvbnRyaWJ1dGVkIHZhbHVlCiAgICAgICAgICAgICAgICBjb250cmlidXRlZF92YWx1ZSAtPSBhbW91bnRPdmVyQ2FwOwogICAgICAgICAgICB9CgogICAgICAgICAgICBDb2xsZWN0aW9uW2N1cnJlbnRGdW5kaW5nU3RhZ2VdLmFtb3VudF9yYWlzZWQrPSBjb250cmlidXRlZF92YWx1ZTsKICAgICAgICAgICAgQW1vdW50UmFpc2VkKz0gY29udHJpYnV0ZWRfdmFsdWU7CgogICAgICAgICAgICBpZihfcGF5bWVudF9tZXRob2QgPT0gdWludDgoRnVuZGluZ01ldGhvZElkcy5NSUxFU1RPTkVfT05MWSkpIHsKICAgICAgICAgICAgICAgIE1pbGVzdG9uZUFtb3VudFJhaXNlZCs9Y29udHJpYnV0ZWRfdmFsdWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEV2ZW50RnVuZGluZ1JlY2VpdmVkUGF5bWVudChfc2VuZGVyLCBfcGF5bWVudF9tZXRob2QsIGNvbnRyaWJ1dGVkX3ZhbHVlKTsKCiAgICAgICAgICAgIGlmKCBGdW5kaW5nTWFuYWdlckVudGl0eS5yZWNlaXZlUGF5bWVudC52YWx1ZShjb250cmlidXRlZF92YWx1ZSkoIF9zZW5kZXIsIF9wYXltZW50X21ldGhvZCwgY3VycmVudEZ1bmRpbmdTdGFnZSApICkgewoKICAgICAgICAgICAgICAgIGlmKGFtb3VudE92ZXJDYXAgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gbGFzdCBzdGVwLCBpZiB3ZSByZWNlaXZlZCBtb3JlIHRoYW4gd2UgY2FuIGFjY2VwdCwgc2VuZCByZW1haW5pbmcgYmFjawogICAgICAgICAgICAgICAgICAgIC8vIGFtb3VudE92ZXJDYXAgc2VudCBiYWNrCiAgICAgICAgICAgICAgICAgICAgaWYoIF9zZW5kZXIuc2VuZCh0aGlzLmJhbGFuY2UpICkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICAgICAgfQoKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CiAgICB9CgogICAgbW9kaWZpZXIgb25seUlucHV0UGF5bWVudE1ldGhvZCgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgIT0gMHgwICYmICggbXNnLnNlbmRlciA9PSBhZGRyZXNzKERpcmVjdElucHV0KSB8fCBtc2cuc2VuZGVyID09IGFkZHJlc3MoTWlsZXN0b25lSW5wdXQpICkpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gY2FuQWNjZXB0UGF5bWVudCh1aW50MjU2IF9hbW91bnQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiggX2Ftb3VudCA+IDAgKSB7CiAgICAgICAgICAgIC8vIGZ1bmRpbmcgc3RhdGUgc2hvdWxkIGJlIElOX1BST0dSRVNTLCBubyBzdGF0ZSBjaGFuZ2VzIHNob3VsZCBiZSByZXF1aXJlZAogICAgICAgICAgICBpZiggQ3VycmVudEVudGl0eVN0YXRlID09IGdldEVudGl0eVN0YXRlKCJJTl9QUk9HUkVTUyIpICYmIGhhc1JlcXVpcmVkU3RhdGVDaGFuZ2VzKCkgPT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRWYWx1ZU92ZXJDdXJyZW50Q2FwKHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIEZ1bmRpbmdTdGFnZSBtZW1vcnkgcmVjb3JkID0gQ29sbGVjdGlvbltjdXJyZW50RnVuZGluZ1N0YWdlXTsKICAgICAgICB1aW50MjU2IHJlbWFpbmluZyA9IHJlY29yZC5hbW91bnRfY2FwX2hhcmQgLSBBbW91bnRSYWlzZWQ7CiAgICAgICAgaWYoIF9hbW91bnQgPiByZW1haW5pbmcgKSB7CiAgICAgICAgICAgIHJldHVybiBfYW1vdW50IC0gcmVtYWluaW5nOwogICAgICAgIH0KICAgICAgICByZXR1cm4gMDsKICAgIH0KCgogICAgLyoKICAgICogVXBkYXRlIEV4aXN0aW5nIEZ1bmRpbmdTdGFnZQogICAgKgogICAgKiBAcGFyYW0gICAgICAgIHVpbnQ4IF9yZWNvcmRfaWQKICAgICogQHBhcmFtICAgICAgICB1aW50OCBfbmV3X3N0YXRlCiAgICAqIEBwYXJhbSAgICAgICAgdWludDggX2R1cmF0aW9uCiAgICAqCiAgICAqIEBhY2Nlc3MgICAgICAgcHVibGljCiAgICAqIEB0eXBlICAgICAgICAgbWV0aG9kCiAgICAqIEBtb2RpZmllcnMgICAgb25seU93bmVyLCByZXF1aXJlSW5pdGlhbGlzZWQsIHVwZGF0ZUFsbG93ZWQKICAgICoKICAgICogQHJldHVybiAgICAgICB2b2lkCiAgICAqLwoKICAgIGZ1bmN0aW9uIHVwZGF0ZUZ1bmRpbmdTdGFnZSggdWludDggX25ld19zdGF0ZSApCiAgICAgICAgaW50ZXJuYWwKICAgICAgICByZXF1aXJlSW5pdGlhbGlzZWQKICAgICAgICBGdW5kaW5nU3RhZ2VVcGRhdGVBbGxvd2VkKF9uZXdfc3RhdGUpCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICBGdW5kaW5nU3RhZ2Ugc3RvcmFnZSByZWMgPSBDb2xsZWN0aW9uW2N1cnJlbnRGdW5kaW5nU3RhZ2VdOwogICAgICAgIHJlYy5zdGF0ZSAgICAgICA9IF9uZXdfc3RhdGU7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgoKICAgIC8qCiAgICAqIE1vZGlmaWVyOiBWYWxpZGF0ZSBpZiByZWNvcmQgdXBkYXRlcyBhcmUgYWxsb3dlZAogICAgKgogICAgKiBAdHlwZSAgICAgICAgIG1vZGlmaWVyCiAgICAqCiAgICAqIEBwYXJhbSAgICAgICAgdWludDggX3JlY29yZF9pZAogICAgKiBAcGFyYW0gICAgICAgIHVpbnQ4IF9uZXdfc3RhdGUKICAgICogQHBhcmFtICAgICAgICB1aW50MjU2IF9kdXJhdGlvbgogICAgKgogICAgKiBAcmV0dXJuICAgICAgIGJvb2wKICAgICovCgogICAgbW9kaWZpZXIgRnVuZGluZ1N0YWdlVXBkYXRlQWxsb3dlZCh1aW50OCBfbmV3X3N0YXRlKSB7CiAgICAgICAgcmVxdWlyZSggaXNGdW5kaW5nU3RhZ2VVcGRhdGVBbGxvd2VkKCBfbmV3X3N0YXRlICkgICk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKgogICAgICogTWV0aG9kOiBWYWxpZGF0ZSBpZiByZWNvcmQgY2FuIGJlIHVwZGF0ZWQgdG8gcmVxdWVzdGVkIHN0YXRlCiAgICAgKgogICAgICogQGFjY2VzcyAgICAgICBwdWJsaWMKICAgICAqIEB0eXBlICAgICAgICAgbWV0aG9kCiAgICAgKgogICAgICogQHBhcmFtICAgICAgICB1aW50OCBfcmVjb3JkX2lkCiAgICAgKiBAcGFyYW0gICAgICAgIHVpbnQ4IF9uZXdfc3RhdGUKICAgICAqCiAgICAgKiBAcmV0dXJuICAgICAgIGJvb2wKICAgICAqLwogICAgZnVuY3Rpb24gaXNGdW5kaW5nU3RhZ2VVcGRhdGVBbGxvd2VkKHVpbnQ4IF9uZXdfc3RhdGUgKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CgogICAgICAgIHZhciAoQ3VycmVudFJlY29yZFN0YXRlLCBSZWNvcmRTdGF0ZVJlcXVpcmVkLCBFbnRpdHlTdGF0ZVJlcXVpcmVkKSA9IGdldFJlcXVpcmVkU3RhdGVDaGFuZ2VzKCk7CgogICAgICAgIEN1cnJlbnRSZWNvcmRTdGF0ZSA9IDA7CiAgICAgICAgRW50aXR5U3RhdGVSZXF1aXJlZCA9IDA7CgogICAgICAgIGlmKF9uZXdfc3RhdGUgPT0gdWludDgoUmVjb3JkU3RhdGVSZXF1aXJlZCkpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKgogICAgICogRnVuZGluZyBQaGFzZSBjaGFuZ2VzCiAgICAgKgogICAgICogTWV0aG9kOiBHZXQgRnVuZGluZ1N0YWdlIFJlcXVpcmVkIFN0YXRlIENoYW5nZXMKICAgICAqCiAgICAgKiBAYWNjZXNzICAgICAgIHB1YmxpYwogICAgICogQHR5cGUgICAgICAgICBtZXRob2QKICAgICAqIEBtb2RpZmllcnMgICAgb25seU93bmVyCiAgICAgKgogICAgICogQHJldHVybiAgICAgICB1aW50OCBSZWNvcmRTdGF0ZVJlcXVpcmVkCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFJlY29yZFN0YXRlUmVxdWlyZWRDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpIHsKCiAgICAgICAgRnVuZGluZ1N0YWdlIG1lbW9yeSByZWNvcmQgPSBDb2xsZWN0aW9uW2N1cnJlbnRGdW5kaW5nU3RhZ2VdOwogICAgICAgIHVpbnQ4IFJlY29yZFN0YXRlUmVxdWlyZWQgPSBnZXRSZWNvcmRTdGF0ZSgiX19JR05PUkVEX18iKTsKCiAgICAgICAgaWYocmVjb3JkLnN0YXRlID09IGdldFJlY29yZFN0YXRlKCJGSU5BTCIpKSB7CiAgICAgICAgICAgIHJldHVybiBnZXRSZWNvcmRTdGF0ZSgiX19JR05PUkVEX18iKTsKICAgICAgICB9CgogICAgICAgIC8qCiAgICAgICAgICAgIElmIGZ1bmRpbmcgc3RhZ2UgaXMgbm90IHN0YXJ0ZWQgYW5kIHRpbWVzdGFtcCBpcyBhZnRlciBzdGFydCB0aW1lOgogICAgICAgICAgICAtIHdlIG5lZWQgdG8gY2hhbmdlIHN0YXRlIHRvIElOX1BST0dSRVNTIHNvIHdlIGNhbiBzdGFydCByZWNlaXZpbmcgZnVuZHMKICAgICAgICAqLwogICAgICAgIGlmKCBnZXRUaW1lc3RhbXAoKSA+PSByZWNvcmQudGltZV9zdGFydCApIHsKICAgICAgICAgICAgUmVjb3JkU3RhdGVSZXF1aXJlZCA9IGdldFJlY29yZFN0YXRlKCJJTl9QUk9HUkVTUyIpOwogICAgICAgIH0KCiAgICAgICAgLyoKICAgICAgICAgICAgVGhpcyBpcyB3aGVyZSB3ZSdyZSBhY2NlcHRpbmcgcGF5bWVudHMgdW5sZXNzIHdlIGNhbiBjaGFuZ2Ugc3RhdGUgdG8gRklOQUwKCiAgICAgICAgICAgIDEuIENoZWNrIGlmIHRpbWVzdGFtcCBpcyBhZnRlciByZWNvcmQgdGltZV9lbmQKICAgICAgICAgICAgMi4gQ2hlY2sgaGFyZCBjYXBzCiAgICAgICAgICAgIEFsbCBsZWFkIHRvIHN0YXRlIGNoYW5nZSA9PiBGSU5BTAogICAgICAgICovCgogICAgICAgIC8vIFRpbWUgY2hlY2sKICAgICAgICBpZihnZXRUaW1lc3RhbXAoKSA+PSByZWNvcmQudGltZV9lbmQpIHsKICAgICAgICAgICAgLy8gRnVuZGluZyBQaGFzZSBlbmRlZCBwYXNzZWQKICAgICAgICAgICAgcmV0dXJuIGdldFJlY29yZFN0YXRlKCJGSU5BTCIpOwogICAgICAgIH0KCiAgICAgICAgLy8gd2lsbCB0cmlnZ2VyIGluIHByZS1pY28KICAgICAgICAvLyBSZWNvcmQgSGFyZCBDYXAgQ2hlY2sKICAgICAgICBpZihBbW91bnRSYWlzZWQgPj0gcmVjb3JkLmFtb3VudF9jYXBfaGFyZCkgewogICAgICAgICAgICAvLyByZWNvcmQgaGFyZCBjYXAgcmVhY2hlZAogICAgICAgICAgICByZXR1cm4gZ2V0UmVjb3JkU3RhdGUoIkZJTkFMIik7CiAgICAgICAgfQoKICAgICAgICAvLyB3aWxsIHRyaWdnZXIgaW4gaWNvCiAgICAgICAgLy8gR2xvYmFsIEhhcmQgQ2FwIENoZWNrCiAgICAgICAgaWYoQW1vdW50UmFpc2VkID49IEdsb2JhbEFtb3VudENhcEhhcmQpIHsKICAgICAgICAgICAgLy8gaGFyZCBjYXAgcmVhY2hlZAogICAgICAgICAgICByZXR1cm4gZ2V0UmVjb3JkU3RhdGUoIkZJTkFMIik7CiAgICAgICAgfQoKICAgICAgICBpZiggcmVjb3JkLnN0YXRlID09IFJlY29yZFN0YXRlUmVxdWlyZWQgKSB7CiAgICAgICAgICAgIFJlY29yZFN0YXRlUmVxdWlyZWQgPSBnZXRSZWNvcmRTdGF0ZSgiX19JR05PUkVEX18iKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBSZWNvcmRTdGF0ZVJlcXVpcmVkOwogICAgfQoKICAgIGZ1bmN0aW9uIGRvU3RhdGVDaGFuZ2VzKCkgcHVibGljIHsKICAgICAgICB2YXIgKEN1cnJlbnRSZWNvcmRTdGF0ZSwgUmVjb3JkU3RhdGVSZXF1aXJlZCwgRW50aXR5U3RhdGVSZXF1aXJlZCkgPSBnZXRSZXF1aXJlZFN0YXRlQ2hhbmdlcygpOwogICAgICAgIGJvb2wgY2FsbEFnYWluID0gZmFsc2U7CgogICAgICAgIERlYnVnUmVjb3JkUmVxdWlyZWRDaGFuZ2VzKCBhc3NldE5hbWUsIEN1cnJlbnRSZWNvcmRTdGF0ZSwgUmVjb3JkU3RhdGVSZXF1aXJlZCApOwogICAgICAgIERlYnVnRW50aXR5UmVxdWlyZWRDaGFuZ2VzKCBhc3NldE5hbWUsIEN1cnJlbnRFbnRpdHlTdGF0ZSwgRW50aXR5U3RhdGVSZXF1aXJlZCApOwoKICAgICAgICBpZiggUmVjb3JkU3RhdGVSZXF1aXJlZCAhPSBnZXRSZWNvcmRTdGF0ZSgiX19JR05PUkVEX18iKSApIHsKICAgICAgICAgICAgLy8gcHJvY2VzcyByZWNvcmQgY2hhbmdlcy4KICAgICAgICAgICAgUmVjb3JkUHJvY2Vzc29yKEN1cnJlbnRSZWNvcmRTdGF0ZSwgUmVjb3JkU3RhdGVSZXF1aXJlZCk7CiAgICAgICAgICAgIERlYnVnQ2FsbEFnYWluKDIpOwogICAgICAgICAgICBjYWxsQWdhaW4gPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgaWYoRW50aXR5U3RhdGVSZXF1aXJlZCAhPSBnZXRFbnRpdHlTdGF0ZSgiX19JR05PUkVEX18iKSApIHsKICAgICAgICAgICAgLy8gcHJvY2VzcyBlbnRpdHkgY2hhbmdlcy4KICAgICAgICAgICAgLy8gaWYoQ3VycmVudEVudGl0eVN0YXRlICE9IEVudGl0eVN0YXRlUmVxdWlyZWQpIHsKICAgICAgICAgICAgRW50aXR5UHJvY2Vzc29yKEVudGl0eVN0YXRlUmVxdWlyZWQpOwogICAgICAgICAgICBEZWJ1Z0NhbGxBZ2FpbigxKTsKICAgICAgICAgICAgY2FsbEFnYWluID0gdHJ1ZTsKICAgICAgICAgICAgLy99CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGhhc1JlcXVpcmVkU3RhdGVDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGJvb2wgaGFzQ2hhbmdlcyA9IGZhbHNlOwoKICAgICAgICB2YXIgKEN1cnJlbnRSZWNvcmRTdGF0ZSwgUmVjb3JkU3RhdGVSZXF1aXJlZCwgRW50aXR5U3RhdGVSZXF1aXJlZCkgPSBnZXRSZXF1aXJlZFN0YXRlQ2hhbmdlcygpOwogICAgICAgIEN1cnJlbnRSZWNvcmRTdGF0ZSA9IDA7CgogICAgICAgIGlmKCBSZWNvcmRTdGF0ZVJlcXVpcmVkICE9IGdldFJlY29yZFN0YXRlKCJfX0lHTk9SRURfXyIpICkgewogICAgICAgICAgICBoYXNDaGFuZ2VzID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaWYoRW50aXR5U3RhdGVSZXF1aXJlZCAhPSBnZXRFbnRpdHlTdGF0ZSgiX19JR05PUkVEX18iKSApIHsKICAgICAgICAgICAgaGFzQ2hhbmdlcyA9IHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBoYXNDaGFuZ2VzOwogICAgfQoKICAgIC8vIHZpZXcgbWV0aG9kcyBkZWNpZGUgaWYgY2hhbmdlcyBhcmUgdG8gYmUgbWFkZQogICAgLy8gaW4gY2FzZSBvZiB0YXNrcywgd2UgZG8gdGhlbSBpbiB0aGUgUHJvY2Vzc29ycy4KCiAgICBmdW5jdGlvbiBSZWNvcmRQcm9jZXNzb3IodWludDggQ3VycmVudFJlY29yZFN0YXRlLCB1aW50OCBSZWNvcmRTdGF0ZVJlcXVpcmVkKSBpbnRlcm5hbCB7CiAgICAgICAgRXZlbnRSZWNvcmRQcm9jZXNzb3IoIGFzc2V0TmFtZSwgQ3VycmVudFJlY29yZFN0YXRlLCBSZWNvcmRTdGF0ZVJlcXVpcmVkICk7CiAgICAgICAgdXBkYXRlRnVuZGluZ1N0YWdlKCBSZWNvcmRTdGF0ZVJlcXVpcmVkICk7CiAgICAgICAgaWYoIFJlY29yZFN0YXRlUmVxdWlyZWQgPT0gZ2V0UmVjb3JkU3RhdGUoIkZJTkFMIikgKSB7CiAgICAgICAgICAgIGlmKGN1cnJlbnRGdW5kaW5nU3RhZ2UgPCBGdW5kaW5nU3RhZ2VOdW0pIHsKICAgICAgICAgICAgICAgIC8vIGp1bXAgdG8gbmV4dCBzdGFnZQogICAgICAgICAgICAgICAgY3VycmVudEZ1bmRpbmdTdGFnZSsrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIEVudGl0eVByb2Nlc3Nvcih1aW50OCBFbnRpdHlTdGF0ZVJlcXVpcmVkKSBpbnRlcm5hbCB7CiAgICAgICAgRXZlbnRFbnRpdHlQcm9jZXNzb3IoIGFzc2V0TmFtZSwgQ3VycmVudEVudGl0eVN0YXRlLCBFbnRpdHlTdGF0ZVJlcXVpcmVkICk7CgogICAgICAgIC8vIERvIFN0YXRlIFNwZWNpZmljIFVwZGF0ZXMKICAgICAgICAvLyBVcGRhdGUgb3VyIEVudGl0eSBTdGF0ZQogICAgICAgIEN1cnJlbnRFbnRpdHlTdGF0ZSA9IEVudGl0eVN0YXRlUmVxdWlyZWQ7CgogICAgICAgIGlmICggRW50aXR5U3RhdGVSZXF1aXJlZCA9PSBnZXRFbnRpdHlTdGF0ZSgiRlVORElOR19FTkRFRCIpICkgewogICAgICAgICAgICAvKgogICAgICAgICAgICAgICAgU1RBVEU6IEZVTkRJTkdfRU5ERUQKICAgICAgICAgICAgICAgIEBQcm9jZXNzb3IgaG9vawogICAgICAgICAgICAgICAgQWN0aW9uOiBDaGVjayBpZiBmdW5kaW5nIGlzIHN1Y2Nlc3NmdWwgb3Igbm90LCBhbmQgbW92ZSBzdGF0ZSB0byAiRkFJTEVEIiBvciAiU1VDQ0VTU0ZVTCIKICAgICAgICAgICAgKi8KCiAgICAgICAgICAgIC8vIEdsb2JhbCBIYXJkIENhcCBDaGVjawogICAgICAgICAgICBpZihBbW91bnRSYWlzZWQgPj0gR2xvYmFsQW1vdW50Q2FwU29mdCkgewogICAgICAgICAgICAgICAgLy8gaGFyZCBjYXAgcmVhY2hlZAogICAgICAgICAgICAgICAgQ3VycmVudEVudGl0eVN0YXRlID0gZ2V0RW50aXR5U3RhdGUoIlNVQ0NFU1NGVUwiKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIEN1cnJlbnRFbnRpdHlTdGF0ZSA9IGdldEVudGl0eVN0YXRlKCJGQUlMRUQiKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCgogICAgfQoKICAgIC8qCiAgICAgKiBNZXRob2Q6IEdldCBSZWNvcmQgYW5kIEVudGl0eSBTdGF0ZSBDaGFuZ2VzCiAgICAgKgogICAgICogQGFjY2VzcyAgICAgICBwdWJsaWMKICAgICAqIEB0eXBlICAgICAgICAgbWV0aG9kCiAgICAgKiBAbW9kaWZpZXJzICAgIG9ubHlPd25lcgogICAgICoKICAgICAqIEByZXR1cm4gICAgICAgKCB1aW50OCBDdXJyZW50UmVjb3JkU3RhdGUsIHVpbnQ4IFJlY29yZFN0YXRlUmVxdWlyZWQsIHVpbnQ4IEVudGl0eVN0YXRlUmVxdWlyZWQpCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFJlcXVpcmVkU3RhdGVDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgsIHVpbnQ4LCB1aW50OCkgewoKICAgICAgICAvLyBnZXQgRnVuZGluZ1N0YWdlIGN1cnJlbnQgc3RhdGUKICAgICAgICBGdW5kaW5nU3RhZ2UgbWVtb3J5IHJlY29yZCA9IENvbGxlY3Rpb25bY3VycmVudEZ1bmRpbmdTdGFnZV07CgogICAgICAgIHVpbnQ4IEN1cnJlbnRSZWNvcmRTdGF0ZSA9IHJlY29yZC5zdGF0ZTsKICAgICAgICB1aW50OCBSZWNvcmRTdGF0ZVJlcXVpcmVkID0gZ2V0UmVjb3JkU3RhdGVSZXF1aXJlZENoYW5nZXMoKTsKICAgICAgICB1aW50OCBFbnRpdHlTdGF0ZVJlcXVpcmVkID0gZ2V0RW50aXR5U3RhdGUoIl9fSUdOT1JFRF9fIik7CgoKICAgICAgICAvLyBGdW5kaW5nIFJlY29yZCBTdGF0ZSBPdmVycmlkZXMKICAgICAgICAvLyBpZihDdXJyZW50UmVjb3JkU3RhdGUgIT0gUmVjb3JkU3RhdGVSZXF1aXJlZCkgewogICAgICAgIGlmKFJlY29yZFN0YXRlUmVxdWlyZWQgIT0gZ2V0UmVjb3JkU3RhdGUoIl9fSUdOT1JFRF9fIikpCiAgICAgICAgewogICAgICAgICAgICAvLyBkaXJlY3Qgc3RhdGUgb3ZlcnJpZGVzIGJ5IGZ1bmRpbmcgc3RhZ2UKICAgICAgICAgICAgaWYoUmVjb3JkU3RhdGVSZXF1aXJlZCA9PSBnZXRSZWNvcmRTdGF0ZSgiSU5fUFJPR1JFU1MiKSApIHsKICAgICAgICAgICAgICAgIC8vIGJvdGggZnVuZGluZyBzdGFnZSBhbmQgZW50aXR5IHN0YXRlcyBuZWVkIHRvIG1vdmUgdG8gSU5fUFJPR1JFU1MKICAgICAgICAgICAgICAgIEVudGl0eVN0YXRlUmVxdWlyZWQgPSBnZXRFbnRpdHlTdGF0ZSgiSU5fUFJPR1JFU1MiKTsKCiAgICAgICAgICAgIH0gZWxzZSBpZiAoUmVjb3JkU3RhdGVSZXF1aXJlZCA9PSBnZXRSZWNvcmRTdGF0ZSgiRklOQUwiKSkgewogICAgICAgICAgICAgICAgLy8gZnVuZGluZyBzdGFnZSBtb3ZlcyB0byBGSU5BTAoKICAgICAgICAgICAgICAgIGlmIChjdXJyZW50RnVuZGluZ1N0YWdlID09IEZ1bmRpbmdTdGFnZU51bSkgewogICAgICAgICAgICAgICAgICAgIC8vIGlmIGN1cnJlbnQgZnVuZGluZyBpcyBsYXN0CiAgICAgICAgICAgICAgICAgICAgRW50aXR5U3RhdGVSZXF1aXJlZCA9IGdldEVudGl0eVN0YXRlKCJGVU5ESU5HX0VOREVEIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvLyBzdGFydCBjb29sZG93biBiZXR3ZWVuIGZ1bmRpbmcgc3RhZ2VzCiAgICAgICAgICAgICAgICAgICAgRW50aXR5U3RhdGVSZXF1aXJlZCA9IGdldEVudGl0eVN0YXRlKCJDT09MRE9XTiIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgIH0gZWxzZSB7CgogICAgICAgICAgICAvLyBSZWNvcmRzIGRvIG5vdCByZXF1aXJlIGFueSB1cGRhdGVzLgogICAgICAgICAgICAvLyBEbyBFbnRpdHkgQ2hlY2tzCgogICAgICAgICAgICBpZiggQ3VycmVudEVudGl0eVN0YXRlID09IGdldEVudGl0eVN0YXRlKCJORVciKSApIHsKICAgICAgICAgICAgICAgIC8qCiAgICAgICAgICAgICAgICAgICAgU1RBVEU6IE5FVwogICAgICAgICAgICAgICAgICAgIFByb2Nlc3NvciBBY3Rpb246IEFsbG9jYXRlIFRva2VucyB0byBGdW5kaW5nIC8gT3duZXJzIHRoZW4gVXBkYXRlIHRvIFdBSVRJTkcKICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgICBFbnRpdHlTdGF0ZVJlcXVpcmVkID0gZ2V0RW50aXR5U3RhdGUoIldBSVRJTkciKTsKICAgICAgICAgICAgfSBlbHNlICBpZiAoIEN1cnJlbnRFbnRpdHlTdGF0ZSA9PSBnZXRFbnRpdHlTdGF0ZSgiRlVORElOR19FTkRFRCIpICkgewogICAgICAgICAgICAgICAgLyoKICAgICAgICAgICAgICAgICAgICBTVEFURTogRlVORElOR19FTkRFRAogICAgICAgICAgICAgICAgICAgIFByb2Nlc3NvciBBY3Rpb246IENoZWNrIGlmIGZ1bmRpbmcgaXMgc3VjY2Vzc2Z1bCBvciBub3QsIGFuZCBtb3ZlIHN0YXRlIHRvICJTVUNDRVNTRlVMIiBvciAiRkFJTEVEIgogICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgfSBlbHNlIGlmICggQ3VycmVudEVudGl0eVN0YXRlID09IGdldEVudGl0eVN0YXRlKCJTVUNDRVNTRlVMIikgKSB7CiAgICAgICAgICAgICAgICAvKgogICAgICAgICAgICAgICAgICAgIFNUQVRFOiBTVUNDRVNTRlVMCiAgICAgICAgICAgICAgICAgICAgUHJvY2Vzc29yIEFjdGlvbjogbm9uZQoKICAgICAgICAgICAgICAgICAgICBFeHRlcm5hbCBBY3Rpb246CiAgICAgICAgICAgICAgICAgICAgRnVuZGluZ01hbmFnZXIgLSBSdW4gSW50ZXJuYWwgUHJvY2Vzc29yICggZGVsaXZlciB0b2tlbnMsIGRlbGl2ZXIgZGlyZWN0IGZ1bmRpbmcgZXRoICkKICAgICAgICAgICAgICAgICovCgogICAgICAgICAgICAgICAgLy8gY2hlY2sgZnVuZGluZyBtYW5hZ2VyIGhhcyBwcm9jZXNzZWQgdGhlIEZVTkRJTkdfU1VDQ0VTU0ZVTCBUYXNrLCBpZiB0cnVlID0+IEZVTkRJTkdfU1VDQ0VTU0ZVTF9ET05FCiAgICAgICAgICAgICAgICBpZihGdW5kaW5nTWFuYWdlckVudGl0eS50YXNrQnlIYXNoKCBGdW5kaW5nTWFuYWdlckVudGl0eS5nZXRIYXNoKCJGVU5ESU5HX1NVQ0NFU1NGVUxfU1RBUlQiLCAiIikgKSA9PSB0cnVlKSB7CiAgICAgICAgICAgICAgICAgICAgRW50aXR5U3RhdGVSZXF1aXJlZCA9IGdldEVudGl0eVN0YXRlKCJTVUNDRVNTRlVMX0ZJTkFMIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvKgogICAgICAgICAgICAgICAgaWYoIEZ1bmRpbmdNYW5hZ2VyRW50aXR5LkN1cnJlbnRFbnRpdHlTdGF0ZSgpID09IEZ1bmRpbmdNYW5hZ2VyRW50aXR5LmdldEVudGl0eVN0YXRlKCJGVU5ESU5HX1NVQ0NFU1NGVUxfRE9ORSIpICkgewogICAgICAgICAgICAgICAgICAgIEVudGl0eVN0YXRlUmVxdWlyZWQgPSBnZXRFbnRpdHlTdGF0ZSgiU1VDQ0VTU0ZVTF9GSU5BTCIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKi8KCiAgICAgICAgICAgIH0gZWxzZSBpZiAoIEN1cnJlbnRFbnRpdHlTdGF0ZSA9PSBnZXRFbnRpdHlTdGF0ZSgiRkFJTEVEIikgKSB7CiAgICAgICAgICAgICAgICAvKgogICAgICAgICAgICAgICAgICAgIFNUQVRFOiBGQUlMRUQKICAgICAgICAgICAgICAgICAgICBQcm9jZXNzb3IgQWN0aW9uOiBub25lCgogICAgICAgICAgICAgICAgICAgIEV4dGVybmFsIEFjdGlvbjoKICAgICAgICAgICAgICAgICAgICBGdW5kaW5nTWFuYWdlciAtIFJ1biBJbnRlcm5hbCBQcm9jZXNzb3IgKHJlbGVhc2UgdG9rZW5zIHRvIG93bmVyKSAoIENhc2hiYWNrIGlzIGF2YWlsYWJsZSApCiAgICAgICAgICAgICAgICAqLwoKICAgICAgICAgICAgICAgIC8vIGNoZWNrIGZ1bmRpbmcgbWFuYWdlciBzdGF0ZSwgaWYgRlVORElOR19OT1RfUFJPQ0VTU0VEIC0+IGdldEVudGl0eVN0YXRlKCJfX0lHTk9SRURfXyIpCiAgICAgICAgICAgICAgICAvLyBpZiBGVU5ESU5HX0ZBSUxFRF9ET05FCgogICAgICAgICAgICAgICAgaWYoRnVuZGluZ01hbmFnZXJFbnRpdHkudGFza0J5SGFzaCggRnVuZGluZ01hbmFnZXJFbnRpdHkuZ2V0SGFzaCgiRlVORElOR19GQUlMRURfU1RBUlQiLCAiIikgKSA9PSB0cnVlKSB7CiAgICAgICAgICAgICAgICAgICAgRW50aXR5U3RhdGVSZXF1aXJlZCA9IGdldEVudGl0eVN0YXRlKCJGQUlMRURfRklOQUwiKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmICggQ3VycmVudEVudGl0eVN0YXRlID09IGdldEVudGl0eVN0YXRlKCJTVUNDRVNTRlVMX0ZJTkFMIikgKSB7CiAgICAgICAgICAgICAgICAvKgogICAgICAgICAgICAgICAgICAgIFNUQVRFOiBTVUNDRVNTRlVMX0ZJTkFMCiAgICAgICAgICAgICAgICAgICAgUHJvY2Vzc29yIEFjdGlvbjogbm9uZQoKICAgICAgICAgICAgICAgICAgICBFeHRlcm5hbCBBY3Rpb246CiAgICAgICAgICAgICAgICAgICAgQXBwbGljYXRpb246IFJ1biBJbnRlcm5hbCBQcm9jZXNzb3IgKCBDaGFuZ2UgU3RhdGUgdG8gSU5fREVWRUxPUE1FTlQgKQogICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgfSBlbHNlIGlmICggQ3VycmVudEVudGl0eVN0YXRlID09IGdldEVudGl0eVN0YXRlKCJGQUlMRURfRklOQUwiKSApIHsKICAgICAgICAgICAgICAgIC8qCiAgICAgICAgICAgICAgICAgICAgU1RBVEU6IEZJTkFMX0ZBSUxFRAogICAgICAgICAgICAgICAgICAgIFByb2Nlc3NvciBBY3Rpb246IG5vbmUKCiAgICAgICAgICAgICAgICAgICAgRXh0ZXJuYWwgQWN0aW9uOgogICAgICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uOiBSdW4gSW50ZXJuYWwgUHJvY2Vzc29yICggQ2hhbmdlIFN0YXRlIHRvIEZVTkRJTkdfRkFJTEVEICkKICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiAoQ3VycmVudFJlY29yZFN0YXRlLCBSZWNvcmRTdGF0ZVJlcXVpcmVkLCBFbnRpdHlTdGF0ZVJlcXVpcmVkKTsKICAgIH0KCn0='.
	

]
