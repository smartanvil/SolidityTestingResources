Class {
	#name : #SRT3cbb9bb54a4a2bd8cb5d9487841b03d7a65e4404,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT3cbb9bb54a4a2bd8cb5d9487841b03d7a65e4404 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7Cgpjb250cmFjdCBFUkMyMEJhc2ljIHsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9Cgpjb250cmFjdCBETk5UREUgewoKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIEROTiBUb2tlbiBDb250cmFjdCAgLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIEROTlRva2VuIHB1YmxpYyBkbm5Ub2tlbjsKCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIEFkZHJlc3NlcyBvZiB0aGUgY28tZm91bmRlcnMgb2YgRE5OLiAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBhZGRyZXNzIHB1YmxpYyBjb2ZvdW5kZXJBOwogICAgYWRkcmVzcyBwdWJsaWMgY29mb3VuZGVyQjsKCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIEROTiBIb2xkaW5nIE11bHRpc2lnIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgYWRkcmVzcyBwdWJsaWMgZG5uSG9sZGluZ011bHRpc2lnOwoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gU3RhcnQgZGF0ZSBvZiB0aGUgVERFIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIHVpbnQyNTYgcHVibGljIFRERVN0YXJ0RGF0ZTsgIC8vIEVwb2NoCgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gRW5kIGRhdGUgb2YgdGhlIFRERSAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgdWludDI1NiBwdWJsaWMgVERFRW5kRGF0ZTsgIC8vIEVwb2NoCgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBBbW91bnQgb2YgYXR0by1ETk4gcGVyIHdlaSAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICB1aW50MjU2IHB1YmxpYyB0b2tlbkV4Y2hhbmdlUmF0ZUJhc2UgPSAzMDAwOyAvLyAxIFdlaSA9IDMwMDAgYXR0by1ETk4KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBOdW1iZXIgb2YgdG9rZW5zIGRpc3RyaWJ1dGVkIChpbiBhdHRvLUROTikgLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIHVpbnQyNTYgcHVibGljIHRva2Vuc0Rpc3RyaWJ1dGVkID0gMDsKCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gTWludW11bSBDb250cmlidXRpb25zIGZvciBwcmUtVERFIGFuZCBUREUgLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICB1aW50MjU2IHB1YmxpYyBtaW5pbXVtVERFQ29udHJpYnV0aW9uSW5XZWkgPSAwLjAwMSBldGhlcjsKICAgIHVpbnQyNTYgcHVibGljIG1pbmltdW1QUkVUREVDb250cmlidXRpb25JbldlaSA9IDUgZXRoZXI7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gRnVuZGluZyBIYXJkIGNhcCAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgdWludDI1NiBwdWJsaWMgbWF4aW11bUZ1bmRpbmdHb2FsSW5FVEg7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBGdW5kcyBSYWlzZWQgLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLwogICAgdWludDI1NiBwdWJsaWMgZnVuZHNSYWlzZWRJbldlaSA9IDA7CiAgICB1aW50MjU2IHB1YmxpYyBwcmVzYWxlRnVuZHNSYWlzZWRJbldlaSA9IDA7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIEtlZXAgdHJhY2sgb2YgV2VpIGNvbnRyaWJ1dGVkIHBlciB1c2VyIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIEVUSENvbnRyaWJ1dGlvbnM7CgoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gS2VlcHMgdHJhY2sgb2YgcHJlLXRkZSBjb250cmlidXRvcnMgYW5kIGhvdyBtYW55IHRva2VucyB0aGV5IGFyZSBlbnRpdGxlZCB0byBnZXQgYmFzZWQgb24gdGhlaXIgY29udHJpYnV0aW9uIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBQUkVUREVDb250cmlidXRvclRva2Vuc1BlbmRpbmdSZWxlYXNlOwogICAgdWludDI1NiBQUkVUREVDb250cmlidXRvcnNUb2tlbnNQZW5kaW5nQ291bnQgPSAwOyAvLyBrZWVwIHRyYWNrIG9mIGNvbnRyaWJ1dG9ycyB3YWl0aW5nIGZvciB0b2tlbnMKICAgIHVpbnQyNTYgVG9rZW5zUHVyY2hhc2VkRHVyaW5nUFJFVERFID0gMDsgLy8ga2VlcCB0cmFjayBvZiBob3cgbWFueSB0b2tlbnMgbmVlZCB0byBiZSBpc3N1ZWQgdG8gcHJlc2FsZSBjb250cmlidXRvcnMKCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDaGVja3MgaWYgYWxsIHByZS10ZGUgY29udHJpYnV0b3JzIGhhdmUgcmVjZWl2ZWQgdGhlaXIgdG9rZW5zIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBtb2RpZmllciBOb1BSRVRERUNvbnRyaWJ1dG9yc0F3YWl0aW5nVG9rZW5zKCkgewoKICAgICAgICAvLyBEZXRlcm1pbmUgaWYgYWxsIHByZS10ZGUgY29udHJpYnV0b3JzIGhhdmUgcmVjZWl2ZWQgdG9rZW5zCiAgICAgICAgcmVxdWlyZShQUkVUREVDb250cmlidXRvcnNUb2tlbnNQZW5kaW5nQ291bnQgPT0gMCk7CgogICAgICAgIF87CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDaGVja3MgaWYgdGhlcmUgYXJlIGFueSBwcmUtdGRlIGNvbnRyaWJ1dG9ycyB0aGF0IGhhdmUgbm90IHJlY2lldmVkIHRoZWlyIHRva2VucyAgLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgbW9kaWZpZXIgUFJFVERFQ29udHJpYnV0b3JzQXdhaXRpbmdUb2tlbnMoKSB7CgogICAgICAgIC8vIERldGVybWluZSBpZiB0aGVyZSBwcmUtdGRlIGNvbnRyaWJ1dG9ycyB0aGF0IGhhdmUgbm90IHJlY2VpdmVkIHRva2VucwogICAgICAgIHJlcXVpcmUoUFJFVERFQ29udHJpYnV0b3JzVG9rZW5zUGVuZGluZ0NvdW50ID4gMCk7CgogICAgICAgIF87CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gQ2hlY2tzIGlmIENvRm91bmRlcnMgYXJlIHBlcmZvcm1pbmcgdGhlIGFjdGlvbiAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgbW9kaWZpZXIgb25seUNvZm91bmRlcnMoKSB7CiAgICAgICAgcmVxdWlyZSAobXNnLnNlbmRlciA9PSBjb2ZvdW5kZXJBIHx8IG1zZy5zZW5kZXIgPT0gY29mb3VuZGVyQik7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDaGVja3MgaWYgQ29Gb3VuZGVyIEEgaXMgcGVyZm9ybWluZyB0aGUgYWN0aW9uIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBtb2RpZmllciBvbmx5Q29mb3VuZGVyQSgpIHsKICAgICAgICByZXF1aXJlIChtc2cuc2VuZGVyID09IGNvZm91bmRlckEpOwogICAgICAgIF87CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gQ2hlY2tzIGlmIENvRm91bmRlciBCIGlzIHBlcmZvcm1pbmcgdGhlIGFjdGlvbiAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgbW9kaWZpZXIgb25seUNvZm91bmRlckIoKSB7CiAgICAgICAgcmVxdWlyZSAobXNnLnNlbmRlciA9PSBjb2ZvdW5kZXJCKTsKICAgICAgICBfOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDaGVjayBpZiB0aGUgcHJlLXRkZSBpcyBnb2luZyBvbiAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIG1vZGlmaWVyIFBSRVRERUhhc05vdEVuZGVkKCkgewogICAgICAgcmVxdWlyZSAobm93IDwgVERFU3RhcnREYXRlKTsKICAgICAgIF87CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9zCiAgICAvLyBDaGVjayBpZiB0aGUgdGRlIGhhcyBlbmRlZCAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIG1vZGlmaWVyIFRERUhhc0VuZGVkKCkgewogICAgICAgcmVxdWlyZSAobm93ID49IFRERUVuZERhdGUgfHwgZnVuZHNSYWlzZWRJbldlaSA+PSBtYXhpbXVtRnVuZGluZ0dvYWxJbkVUSCk7CiAgICAgICBfOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gQ2hlY2tzdG8gc2VlIGlmIHRoZSBjb250cmlidXRpb24gaXMgYXQgbGVhc3QgdGhlIG1pbmltdW0gYWxsb3dlZCBmb3IgdGRlIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIG1vZGlmaWVyIENvbnRyaWJ1dGlvbklzQXRMZWFzdE1pbmltdW0oKSB7CiAgICAgICAgcmVxdWlyZSAobXNnLnZhbHVlID49IG1pbmltdW1UREVDb250cmlidXRpb25JbldlaSk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIE1ha2Ugc3VyZSBtYXggY2FwIGlzIG5vdCBleGNlZWRlZCB3aXRoIGFkZGVkIGNvbnRyaWJ1dGlvbiAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBtb2RpZmllciBDb250cmlidXRpb25Eb2VzTm90Q2F1c2VHb2FsRXhjZWVkYW5jZSgpIHsKICAgICAgIHVpbnQyNTYgbmV3RnVuZHNSYWlzZWQgPSBtc2cudmFsdWUrZnVuZHNSYWlzZWRJbldlaTsKICAgICAgIHJlcXVpcmUgKG5ld0Z1bmRzUmFpc2VkIDw9IG1heGltdW1GdW5kaW5nR29hbEluRVRIKTsKICAgICAgIF87CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIENoZWNrIGlmIHRoZSBzcGVjaWZpZWQgYmVuZWZpY2lhcnkgaGFzIHNlbnQgdXMgZnVuZHMgYmVmb3JlIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgbW9kaWZpZXIgSGFzUGVuZGluZ1BSRVRERVRva2VucyhhZGRyZXNzIF9jb250cmlidXRvcikgewogICAgICAgIHJlcXVpcmUgKFBSRVRERUNvbnRyaWJ1dG9yVG9rZW5zUGVuZGluZ1JlbGVhc2VbX2NvbnRyaWJ1dG9yXSAhPSAgMCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDaGVjayBpZiBwcmUtdGRlIGNvbnRyaWJ1dG9ycyBpcyBub3Qgd2FpdGluZyBmb3IgdG9rZW5zIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBtb2RpZmllciBJc05vdEF3YWl0aW5nUFJFVERFVG9rZW5zKGFkZHJlc3MgX2NvbnRyaWJ1dG9yKSB7CiAgICAgICAgcmVxdWlyZSAoUFJFVERFQ29udHJpYnV0b3JUb2tlbnNQZW5kaW5nUmVsZWFzZVtfY29udHJpYnV0b3JdID09ICAwKTsKICAgICAgICBfOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vICBAZGVzIEZ1bmN0aW9uIHRvIGNoYW5nZSBmb3VuZGVyIEEgYWRkcmVzcy4gICAgICAgLy8KICAgIC8vICBAcGFyYW0gbmV3QWRkcmVzcyBBZGRyZXNzIG9mIG5ldyBmb3VuZGVyIEEuICAgICAgLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIGZ1bmN0aW9uIGNoYW5nZUNvZm91bmRlckEoYWRkcmVzcyBuZXdBZGRyZXNzKQogICAgICAgIG9ubHlDb2ZvdW5kZXJBCiAgICB7CiAgICAgICAgY29mb3VuZGVyQSA9IG5ld0FkZHJlc3M7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyAgQGRlcyBGdW5jdGlvbiB0byBjaGFuZ2UgZm91bmRlciBCIGFkZHJlc3MuICAgICAgLy8KICAgIC8vICBAcGFyYW0gbmV3QWRkcmVzcyBBZGRyZXNzIG9mIG5ldyBmb3VuZGVyIEIuICAgICAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBmdW5jdGlvbiBjaGFuZ2VDb2ZvdW5kZXJCKGFkZHJlc3MgbmV3QWRkcmVzcykKICAgICAgICBvbmx5Q29mb3VuZGVyQgogICAgewogICAgICAgIGNvZm91bmRlckIgPSBuZXdBZGRyZXNzOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vICBAZGVzIEZ1bmN0aW9uIHRvIGV4dGVuZCBwcmUtdGRlICAgLy8KICAgIC8vICBAcGFyYW0gbmV3IGNyb3dkc2FsZSBzdGFydCBkYXRlICAgLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIGZ1bmN0aW9uIGV4dGVuZFBSRVRERSh1aW50MjU2IHN0YXJ0RGF0ZSkKICAgICAgICBvbmx5Q29mb3VuZGVycwogICAgICAgIFBSRVRERUhhc05vdEVuZGVkCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICAvLyBNYWtlIHN1cmUgdGhhdCB0aGUgbmV3IGRhdGUgaXMgcGFzdCB0aGUgZXhpc3RpbmcgZGF0ZSBhbmQKICAgICAgICAvLyBpcyBub3QgaW4gdGhlIHBhc3QuCiAgICAgICAgaWYgKHN0YXJ0RGF0ZSA+IG5vdyAmJiBzdGFydERhdGUgPiBUREVTdGFydERhdGUpIHsKICAgICAgICAgICAgVERFRW5kRGF0ZSA9IFRERUVuZERhdGUgKyAoc3RhcnREYXRlLVRERVN0YXJ0RGF0ZSk7IC8vIE1vdmUgZW5kIGRhdGUgdGhlIHNhbWUgYW1vdW50IG9mIGRheXMgYXMgc3RhcnQgZGF0ZQogICAgICAgICAgICBUREVTdGFydERhdGUgPSBzdGFydERhdGU7IC8vIHNldCBuZXcgc3RhcnQgZGF0ZQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vICBAZGVzIEZ1bmN0aW9uIHRvIGNoYW5nZSBtdWx0aXNpZyBhZGRyZXNzLiAgICAgICAvLwogICAgLy8gIEBwYXJhbSBuZXdBZGRyZXNzIEFkZHJlc3Mgb2YgbmV3IG11bHRpc2lnLiAgICAgIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIGZ1bmN0aW9uIGNoYW5nZUROTkhvbGRpbmdNdWx0aXNpZyhhZGRyZXNzIG5ld0FkZHJlc3MpCiAgICAgICAgb25seUNvZm91bmRlcnMKICAgIHsKICAgICAgICBkbm5Ib2xkaW5nTXVsdGlzaWcgPSBuZXdBZGRyZXNzOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gQGRlcyBFVEggYmFsYW5jZSBvZiBlYWNoIGNvbnRyaWJ1dG9yIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIGZ1bmN0aW9uIGNvbnRyaWJ1dG9yRVRIQmFsYW5jZShhZGRyZXNzIF9vd25lcikKICAgICAgY29uc3RhbnQKICAgICAgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKQogICAgewogICAgICAgIHJldHVybiBFVEhDb250cmlidXRpb25zW19vd25lcl07CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBAZGVzIERldGVybWluZXMgaWYgYW4gYWRkcmVzcyBpcyBhIHByZS1UREUgY29udHJpYnV0b3IgLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgZnVuY3Rpb24gaXNBd2FpdGluZ1BSRVRERVRva2VucyhhZGRyZXNzIF9jb250cmlidXRvckFkZHJlc3MpCiAgICAgICBpbnRlcm5hbAogICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXR1cm4gUFJFVERFQ29udHJpYnV0b3JUb2tlbnNQZW5kaW5nUmVsZWFzZVtfY29udHJpYnV0b3JBZGRyZXNzXSA+IDA7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gQGRlcyBSZXR1cm5zIHBlbmRpbmcgcHJlc2FsZSB0b2tlbnMgZm9yIGEgZ2l2ZW4gYWRkcmVzcyAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgZnVuY3Rpb24gZ2V0UGVuZGluZ1ByZXNhbGVUb2tlbnMoYWRkcmVzcyBfY29udHJpYnV0b3IpCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50MjU2KQogICAgewogICAgICAgIHJldHVybiBQUkVUREVDb250cmlidXRvclRva2Vuc1BlbmRpbmdSZWxlYXNlW19jb250cmlidXRvcl07CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIEBkZXMgUmV0dXJucyBjdXJyZW50IGJvbnVzIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgZnVuY3Rpb24gZ2V0Q3VycmVudFRERUJvbnVzKCkKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQyNTYpCiAgICB7CiAgICAgICAgcmV0dXJuIGdldFRERVRva2VuRXhjaGFuZ2VSYXRlKG5vdyk7CiAgICB9CgoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBAZGVzIFJldHVybnMgY3VycmVudCBib251cyAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRQUkVUREVCb251cygpCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50MjU2KQogICAgewogICAgICAgIHJldHVybiBnZXRQUkVUREVUb2tlbkV4Y2hhbmdlUmF0ZShub3cpOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBAZGVzIFJldHVybnMgYm9udXMgKGluIGF0dG8tRE5OKSBwZXIgd2VpIGZvciB0aGUgc3BlY2lmaWMgbW9tZW50IC8vCiAgICAvLyBAcGFyYW0gdGltZXN0YW1wIFRpbWUgb2YgcHVyY2hhc2UgKGluIHNlY29uZHMpICAgICAgICAgICAgICAgICAgICAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIGZ1bmN0aW9uIGdldFRERVRva2VuRXhjaGFuZ2VSYXRlKHVpbnQyNTYgdGltZXN0YW1wKQogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludDI1NikKICAgIHsKICAgICAgICAvLyBObyBib251cyAtIFRERSBlbmRlZAogICAgICAgIGlmICh0aW1lc3RhbXAgPiBUREVFbmREYXRlKSB7CiAgICAgICAgICAgIHJldHVybiB1aW50MjU2KDApOwogICAgICAgIH0KCiAgICAgICAgLy8gTm8gYm9udXMgLSBUREUgaGFzIG5vdCBzdGFydGVkCiAgICAgICAgaWYgKFRERVN0YXJ0RGF0ZSA+IHRpbWVzdGFtcCkgewogICAgICAgICAgICByZXR1cm4gdWludDI1NigwKTsKICAgICAgICB9CgogICAgICAgIC8vIDEgRVRIID0gMzYwMCBETk4gKDAgLSAyMCUgb2YgZnVuZGluZyBnb2FsKSAtIDIwJSBCb251cwogICAgICAgIGlmIChmdW5kc1JhaXNlZEluV2VpIDw9IG1heGltdW1GdW5kaW5nR29hbEluRVRILm11bCgyMCkuZGl2KDEwMCkpIHsKICAgICAgICAgICAgcmV0dXJuIHRva2VuRXhjaGFuZ2VSYXRlQmFzZS5tdWwoMTIwKS5kaXYoMTAwKTsKCiAgICAgICAgLy8gMSBFVEggPSAzNDUwIEROTiAoPjIwJSB0byA2MCUgb2YgZnVuZGluZyBnb2FsKSAtIDE1JSBCb251cwogICAgICAgIH0gZWxzZSBpZiAoZnVuZHNSYWlzZWRJbldlaSA+IG1heGltdW1GdW5kaW5nR29hbEluRVRILm11bCgyMCkuZGl2KDEwMCkgJiYgZnVuZHNSYWlzZWRJbldlaSA8PSBtYXhpbXVtRnVuZGluZ0dvYWxJbkVUSC5tdWwoNjApLmRpdigxMDApKSB7CiAgICAgICAgICAgIHJldHVybiB0b2tlbkV4Y2hhbmdlUmF0ZUJhc2UubXVsKDExNSkuZGl2KDEwMCk7CgogICAgICAgIC8vIDEgRVRIID0gMzMwMCBETk4gKD42MCUgdG8gRnVuZGluZyBHb2FsKSAtIDEwJSBCb251cwogICAgICAgIH0gZWxzZSBpZiAoZnVuZHNSYWlzZWRJbldlaSA+IG1heGltdW1GdW5kaW5nR29hbEluRVRILm11bCg2MCkuZGl2KDEwMCkgJiYgZnVuZHNSYWlzZWRJbldlaSA8PSBtYXhpbXVtRnVuZGluZ0dvYWxJbkVUSCkgewogICAgICAgICAgICByZXR1cm4gdG9rZW5FeGNoYW5nZVJhdGVCYXNlLm11bCgxMTApLmRpdigxMDApOwoKICAgICAgICAvLyBEZWZhdWx0OiAxIEVUSCA9IDMwMDAgRE5OCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIHRva2VuRXhjaGFuZ2VSYXRlQmFzZTsKICAgICAgICB9CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBAZGVzIFJldHVybnMgYm9udXMgKGluIGF0dG8tRE5OKSBwZXIgd2VpIGZvciB0aGUgc3BlY2lmaWMgY29udHJpYnV0aW9uIGFtb3VudCAvLwogICAgLy8gQHBhcmFtIHdlaWFtb3VudCBUaGUgYW1vdW50IG9mIHdlaSBiZWluZyBjb250cmlidXRlZCAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIGZ1bmN0aW9uIGdldFBSRVRERVRva2VuRXhjaGFuZ2VSYXRlKHVpbnQyNTYgd2VpYW1vdW50KQogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludDI1NikKICAgIHsKICAgICAgICAvLyBQcmVzYWxlIHdpbGwgb25seSBhY2NlcHQgY29udHJpYnV0aW9ucyBhYm92ZSBtaW5pbXVtCiAgICAgICAgaWYgKHdlaWFtb3VudCA8IG1pbmltdW1QUkVUREVDb250cmlidXRpb25JbldlaSkgewogICAgICAgICAgICByZXR1cm4gdWludDI1NigwKTsKICAgICAgICB9CgogICAgICAgIC8vIE1pbmltdW0gQ29udHJpYnV0aW9uIC0gMTk5IEVUSCAoMjUlIEJvbnVzKQogICAgICAgIGlmICh3ZWlhbW91bnQgPj0gbWluaW11bVBSRVRERUNvbnRyaWJ1dGlvbkluV2VpICYmIHdlaWFtb3VudCA8PSAxOTkgZXRoZXIpIHsKICAgICAgICAgICAgcmV0dXJuIHRva2VuRXhjaGFuZ2VSYXRlQmFzZSArIHRva2VuRXhjaGFuZ2VSYXRlQmFzZS5tdWwoMjUpLmRpdigxMDApOwoKICAgICAgICAvLyAyMDAgRVRIIC0gMzAwIEVUSCBCb251cyAoMzAlIEJvbnVzKQogICAgICAgIH0gZWxzZSBpZiAod2VpYW1vdW50ID49IDIwMCBldGhlciAmJiB3ZWlhbW91bnQgPD0gMzAwIGV0aGVyKSB7CiAgICAgICAgICAgIHJldHVybiB0b2tlbkV4Y2hhbmdlUmF0ZUJhc2UgKyB0b2tlbkV4Y2hhbmdlUmF0ZUJhc2UubXVsKDMwKS5kaXYoMTAwKTsKCiAgICAgICAgLy8gMzAxIEVUSCAtIDI2NjUgRVRIIEJvbnVzICgzNSUgQm9udXMpCiAgICAgICAgfSBlbHNlIGlmICh3ZWlhbW91bnQgPj0gMzAxIGV0aGVyICYmIHdlaWFtb3VudCA8PSAyNjY1IGV0aGVyKSB7CiAgICAgICAgICAgIHJldHVybiB0b2tlbkV4Y2hhbmdlUmF0ZUJhc2UgKyB0b2tlbkV4Y2hhbmdlUmF0ZUJhc2UubXVsKDM1KS5kaXYoMTAwKTsKCiAgICAgICAgLy8gMjY2NisgRVRIIEJvbnVzICg1MCUgQm9udXMpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIHRva2VuRXhjaGFuZ2VSYXRlQmFzZSArIHRva2VuRXhjaGFuZ2VSYXRlQmFzZS5tdWwoNTApLmRpdigxMDApOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIEBkZXMgQ29tcHV0ZXMgaG93IG1hbnkgdG9rZW5zIGEgYnV5ZXIgaXMgZW50aXRsZWQgdG8gYmFzZWQgb24gY29udHJpYnV0aW9uIGFuZCB0aW1lLiAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVUb2tlbnModWludDI1NiB3ZWlhbW91bnQsIHVpbnQyNTYgdGltZXN0YW1wKQogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludDI1NikKICAgIHsKCiAgICAgICAgLy8gQ29tcHV0ZSBob3cgbWFueSBhdHRvLUROTiB1c2VyIGlzIGVudGl0bGVkIHRvLgogICAgICAgIHVpbnQyNTYgY29tcHV0ZWRUb2tlbnNGb3JQdXJjaGFzZSA9IHdlaWFtb3VudC5tdWwodGltZXN0YW1wID49IFRERVN0YXJ0RGF0ZSA/IGdldFRERVRva2VuRXhjaGFuZ2VSYXRlKHRpbWVzdGFtcCkgOiBnZXRQUkVUREVUb2tlbkV4Y2hhbmdlUmF0ZSh3ZWlhbW91bnQpKTsKCiAgICAgICAgLy8gQW1vdW50IG9mIGF0dG8tRE5OIHRvIGlzc3VlCiAgICAgICAgcmV0dXJuIGNvbXB1dGVkVG9rZW5zRm9yUHVyY2hhc2U7CiAgICAgfQoKCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIEBkZXMgSXNzdWVzIHRva2VucyBmb3IgdXNlcnMgd2hvIG1hZGUgcHVyY2hhc2Ugd2l0aCBFVEggICAvLwogICAgLy8gQHBhcmFtIGJlbmVmaWNpYXJ5IEFkZHJlc3MgdGhlIHRva2VucyB3aWxsIGJlIGlzc3VlZCB0by4gIC8vCiAgICAvLyBAcGFyYW0gd2VpYW1vdW50IEVUSCBhbW91bnQgKGluIFdlaSkgICAgICAgICAgICAgICAgICAgICAgLy8KICAgIC8vIEBwYXJhbSB0aW1lc3RhbXAgVGltZSBvZiBwdXJjaGFzZSAoaW4gc2Vjb25kcykgICAgICAgICAgICAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBmdW5jdGlvbiBidXlUb2tlbnMoKQogICAgICAgIGludGVybmFsCiAgICAgICAgQ29udHJpYnV0aW9uSXNBdExlYXN0TWluaW11bQogICAgICAgIENvbnRyaWJ1dGlvbkRvZXNOb3RDYXVzZUdvYWxFeGNlZWRhbmNlCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKCiAgICAgICAgLy8gRGV0ZXJtaW5lIGhvdyBtYW55IHRva2VucyBzaG91bGQgYmUgaXNzdWVkCiAgICAgICAgdWludDI1NiB0b2tlbkNvdW50ID0gY2FsY3VsYXRlVG9rZW5zKG1zZy52YWx1ZSwgbm93KTsKCiAgICAgICAgLy8gVXBkYXRlIHRvdGFsIGFtb3VudCBvZiB0b2tlbnMgZGlzdHJpYnV0ZWQgKGluIGF0dG8tRE5OKQogICAgICAgIHRva2Vuc0Rpc3RyaWJ1dGVkID0gdG9rZW5zRGlzdHJpYnV0ZWQuYWRkKHRva2VuQ291bnQpOwoKICAgICAgICAvLyBLZWVwIHRyYWNrIG9mIGNvbnRyaWJ1dGlvbnMgKGluIFdlaSkKICAgICAgICBFVEhDb250cmlidXRpb25zW21zZy5zZW5kZXJdID0gRVRIQ29udHJpYnV0aW9uc1ttc2cuc2VuZGVyXS5hZGQobXNnLnZhbHVlKTsKCiAgICAgICAgLy8gSW5jcmVhc2UgdG90YWwgZnVuZHMgcmFpc2VkIGJ5IGNvbnRyaWJ1dGlvbgogICAgICAgIGZ1bmRzUmFpc2VkSW5XZWkgPSBmdW5kc1JhaXNlZEluV2VpLmFkZChtc2cudmFsdWUpOwoKICAgICAgICAvLyBEZXRlcm1pbmUgd2hpY2ggdG9rZW4gYWxsb2NhdGlvbiB3ZSBzaG91bGQgYmUgZGVkdWN0aW5nIGZyb20KICAgICAgICBETk5Ub2tlbi5ETk5TdXBwbHlBbGxvY2F0aW9ucyBhbGxvY2F0aW9uVHlwZSA9IEROTlRva2VuLkROTlN1cHBseUFsbG9jYXRpb25zLlRERVN1cHBseUFsbG9jYXRpb247CgogICAgICAgIC8vIEF0dGVtcHQgdG8gaXNzdWUgdG9rZW5zIHRvIGNvbnRyaWJ1dG9yCiAgICAgICAgaWYgKCFkbm5Ub2tlbi5pc3N1ZVRva2Vucyhtc2cuc2VuZGVyLCB0b2tlbkNvdW50LCBhbGxvY2F0aW9uVHlwZSkpIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQoKICAgICAgICAvLyBUcmFuc2ZlciBmdW5kcyB0byBtdWx0aXNpZwogICAgICAgIGRubkhvbGRpbmdNdWx0aXNpZy50cmFuc2Zlcihtc2cudmFsdWUpOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBAZGVzIElzc3VlcyB0b2tlbnMgZm9yIHVzZXJzIHdobyBtYWRlIHB1cmNoYXNlIHdpdGhvdXQgdXNpbmcgRVRIIGR1cmluZyBwcmVzYWxlLiAgIC8vCiAgICAvLyBAcGFyYW0gYmVuZWZpY2lhcnkgQWRkcmVzcyB0aGUgdG9rZW5zIHdpbGwgYmUgaXNzdWVkIHRvLiAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vCiAgICAvLyBAcGFyYW0gd2VpYW1vdW50IEVUSCBhbW91bnQgKGluIFdlaSkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBmdW5jdGlvbiBidXlQUkVUREVUb2tlbnNXaXRob3V0RVRIKGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQyNTYgd2VpYW1vdW50LCB1aW50MjU2IHRva2VuQ291bnQpCiAgICAgICAgb25seUNvZm91bmRlcnMKICAgICAgICBQUkVUREVIYXNOb3RFbmRlZAogICAgICAgIElzTm90QXdhaXRpbmdQUkVUREVUb2tlbnMoYmVuZWZpY2lhcnkpCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICAgIC8vIEtlZXAgdHJhY2sgb2YgY29udHJpYnV0aW9ucyAoaW4gV2VpKQogICAgICAgICAgRVRIQ29udHJpYnV0aW9uc1tiZW5lZmljaWFyeV0gPSBFVEhDb250cmlidXRpb25zW2JlbmVmaWNpYXJ5XS5hZGQod2VpYW1vdW50KTsKCiAgICAgICAgICAvLyBJbmNyZWFzZSB0b3RhbCBmdW5kcyByYWlzZWQgYnkgY29udHJpYnV0aW9uCiAgICAgICAgICBmdW5kc1JhaXNlZEluV2VpID0gZnVuZHNSYWlzZWRJbldlaS5hZGQod2VpYW1vdW50KTsKCiAgICAgICAgICAvLyBLZWVwIHRyYWNrIG9mIHByZXNhbGUgZnVuZHMgaW4gYWRkaXRpb24sIHNlcGFyYXRlbHkKICAgICAgICAgIHByZXNhbGVGdW5kc1JhaXNlZEluV2VpID0gcHJlc2FsZUZ1bmRzUmFpc2VkSW5XZWkuYWRkKHdlaWFtb3VudCk7CgogICAgICAgICAgLy8gQWRkIHRoZXNlIHRva2VucyB0byB0aGUgdG90YWwgYW1vdW50IG9mIHRva2VucyB0aGlzIGNvbnRyaWJ1dG9yIGlzIGVudGl0bGVkIHRvCiAgICAgICAgICBQUkVUREVDb250cmlidXRvclRva2Vuc1BlbmRpbmdSZWxlYXNlW2JlbmVmaWNpYXJ5XSA9IFBSRVRERUNvbnRyaWJ1dG9yVG9rZW5zUGVuZGluZ1JlbGVhc2VbYmVuZWZpY2lhcnldLmFkZCh0b2tlbkNvdW50KTsKCiAgICAgICAgICAvLyBJbmNybWVudCBudW1iZXIgb2YgcHJlLXRkZSBjb250cmlidXRvcnMgd2FpdGluZyBmb3IgdG9rZW5zCiAgICAgICAgICBQUkVUREVDb250cmlidXRvcnNUb2tlbnNQZW5kaW5nQ291bnQgKz0gMTsKCiAgICAgICAgICAvLyBTZW5kIHRva2VucyB0byBjb250aWJ1dG9yCiAgICAgICAgICByZXR1cm4gaXNzdWVQUkVUREVUb2tlbnMoYmVuZWZpY2lhcnkpOwogICAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBAZGVzIElzc3VlcyBwZW5kaW5nIHRva2VucyB0byBwcmUtdGRlIGNvbnRyaWJ1dG9yICAgICAgICAgLy8KICAgIC8vIEBwYXJhbSBiZW5lZmljaWFyeSBBZGRyZXNzIHRoZSB0b2tlbnMgd2lsbCBiZSBpc3N1ZWQgdG8uICAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBmdW5jdGlvbiBpc3N1ZVBSRVRERVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KQogICAgICAgIG9ubHlDb2ZvdW5kZXJzCiAgICAgICAgUFJFVERFQ29udHJpYnV0b3JzQXdhaXRpbmdUb2tlbnMKICAgICAgICBIYXNQZW5kaW5nUFJFVERFVG9rZW5zKGJlbmVmaWNpYXJ5KQogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CgogICAgICAgIC8vIEFtb3VudCBvZiB0b2tlbnMgdG8gY3JlZGl0IHByZS10ZGUgY29udHJpYnV0b3IKICAgICAgICB1aW50MjU2IHRva2VuQ291bnQgPSBQUkVUREVDb250cmlidXRvclRva2Vuc1BlbmRpbmdSZWxlYXNlW2JlbmVmaWNpYXJ5XTsKCiAgICAgICAgLy8gVXBkYXRlIHRvdGFsIGFtb3VudCBvZiB0b2tlbnMgZGlzdHJpYnV0ZWQgKGluIGF0dG8tRE5OKQogICAgICAgIHRva2Vuc0Rpc3RyaWJ1dGVkID0gdG9rZW5zRGlzdHJpYnV0ZWQuYWRkKHRva2VuQ291bnQpOwoKICAgICAgICAvLyBBbGxvY2F0aW9uIHR5cGUgd2lsbCBiZSBQUkVUREVTdXBwbHlBbGxvY2F0aW9uCiAgICAgICAgRE5OVG9rZW4uRE5OU3VwcGx5QWxsb2NhdGlvbnMgYWxsb2NhdGlvblR5cGUgPSBETk5Ub2tlbi5ETk5TdXBwbHlBbGxvY2F0aW9ucy5QUkVUREVTdXBwbHlBbGxvY2F0aW9uOwoKICAgICAgICAvLyBBdHRlbXB0IHRvIGlzc3VlIHRva2VucwogICAgICAgIGlmICghZG5uVG9rZW4uaXNzdWVUb2tlbnMoYmVuZWZpY2lhcnksIHRva2VuQ291bnQsIGFsbG9jYXRpb25UeXBlKSkgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CgogICAgICAgIC8vIFJlZHVjZSBudW1iZXIgb2YgcHJlLXRkZSBjb250cmlidXRvcnMgd2FpdGluZyBmb3IgdG9rZW5zCiAgICAgICAgUFJFVERFQ29udHJpYnV0b3JzVG9rZW5zUGVuZGluZ0NvdW50IC09IDE7CgogICAgICAgIC8vIERlbm90ZSB0aGF0IHRva2VucyBoYXZlIGJlZW4gaXNzdWVkIGZvciB0aGlzIHByZS10ZGUgY29udHJpYnV0b3IKICAgICAgICBQUkVUREVDb250cmlidXRvclRva2Vuc1BlbmRpbmdSZWxlYXNlW2JlbmVmaWNpYXJ5XSA9IDA7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIEBkZXMgTWFya3MgVERFIGFzIGNvbXBsZXRlZCAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBmdW5jdGlvbiBmaW5hbGl6ZVRERSgpCiAgICAgICBvbmx5Q29mb3VuZGVycwogICAgICAgVERFSGFzRW5kZWQKICAgIHsKICAgICAgICAvLyBDaGVjayBpZiB0aGUgdG9rZW5zIGFyZSBsb2NrZWQgYW5kIGFsbCBwcmUtc2FsZSB0b2tlbnMgaGF2ZSBiZWVuCiAgICAgICAgLy8gdHJhbnNmZXJyZWQgdG8gdGhlIFRERSBTdXBwbHkgYmVmb3JlIHVubG9ja2luZyB0b2tlbnMuCiAgICAgICAgcmVxdWlyZShkbm5Ub2tlbi50b2tlbnNMb2NrZWQoKSA9PSB0cnVlICYmIGRublRva2VuLlBSRVRERVN1cHBseVJlbWFpbmluZygpID09IDApOwoKICAgICAgICAvLyBVbmxvY2sgdG9rZW5zCiAgICAgICAgZG5uVG9rZW4udW5sb2NrVG9rZW5zKCk7CgogICAgICAgIC8vIFVwZGF0ZSB0b2tlbnMgZGlzdHJpYnV0ZWQKICAgICAgICB0b2tlbnNEaXN0cmlidXRlZCArPSBkbm5Ub2tlbi5UREVTdXBwbHlSZW1haW5pbmcoKTsKCiAgICAgICAgLy8gVHJhbnNmZXIgdW5zb2xkIFRERSB0b2tlbnMgdG8gcGxhdGZvcm0KICAgICAgICBkbm5Ub2tlbi5zZW5kVW5zb2xkVERFVG9rZW5zVG9QbGF0Zm9ybSgpOwogICAgfQoKCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gQGRlcyBNYXJrcyBwcmUtVERFIGFzIGNvbXBsZXRlZCBieSBtb3ZpbmcgcmVtYWluaW5nIHRva2VucyBpbnRvIFRERSBzdXBwbHkgLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBmdW5jdGlvbiBmaW5hbGl6ZVBSRVRERSgpCiAgICAgICBvbmx5Q29mb3VuZGVycwogICAgICAgTm9QUkVUREVDb250cmlidXRvcnNBd2FpdGluZ1Rva2VucwogICAgewogICAgICAgIC8vIENoZWNrIGlmIHdlIGhhdmUgdG9rZW5zIHRvIHRyYW5zZmVyIHRvIFRERQogICAgICAgIHJlcXVpcmUoZG5uVG9rZW4uUFJFVERFU3VwcGx5UmVtYWluaW5nKCkgPiAwKTsKCiAgICAgICAgLy8gVHJhbnNmZXIgdW5zb2xkIFRERSB0b2tlbnMgdG8gcGxhdGZvcm0KICAgICAgICBkbm5Ub2tlbi5zZW5kVW5zb2xkUFJFVERFVG9rZW5zVG9UREUoKTsKICAgIH0KCgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gQGRlcyBDb250cmFjdCBjb25zdHJ1Y3RvciAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgZnVuY3Rpb24gRE5OVERFKGFkZHJlc3MgdG9rZW5BZGRyZXNzLCBhZGRyZXNzIGZvdW5kZXJBLCBhZGRyZXNzIGZvdW5kZXJCLCBhZGRyZXNzIGRubkhvbGRpbmcsIHVpbnQyNTYgaGFyZENhcCwgdWludDI1NiBzdGFydERhdGUsIHVpbnQyNTYgZW5kRGF0ZSkKICAgIHsKCiAgICAgICAgLy8gU2V0IHRva2VuIGFkZHJlc3MKICAgICAgICBkbm5Ub2tlbiA9IEROTlRva2VuKHRva2VuQWRkcmVzcyk7CgogICAgICAgIC8vIFNldCBjb2ZvdW5kZXIgYWRkcmVzc2VzCiAgICAgICAgY29mb3VuZGVyQSA9IGZvdW5kZXJBOwogICAgICAgIGNvZm91bmRlckIgPSBmb3VuZGVyQjsKCiAgICAgICAgLy8gU2V0IEROTiBob2xkaW5nIGFkZHJlc3MKICAgICAgICBkbm5Ib2xkaW5nTXVsdGlzaWcgPSBkbm5Ib2xkaW5nOwoKICAgICAgICAvLyBTZXQgSGFyZCBDYXAKICAgICAgICBtYXhpbXVtRnVuZGluZ0dvYWxJbkVUSCA9IGhhcmRDYXAgKiAxIGV0aGVyOwoKICAgICAgICAvLyBTZXQgU3RhcnQgRGF0ZQogICAgICAgIFRERVN0YXJ0RGF0ZSA9IHN0YXJ0RGF0ZSA+PSBub3cgPyBzdGFydERhdGUgOiBub3c7CgogICAgICAgIC8vIFNldCBFbmQgZGF0ZSAoTWFrZSBzdXJlIHRoZSBlbmQgZGF0ZSBpcyBhdCBsZWFzdCAzMCBkYXlzIGZyb20gc3RhcnQgZGF0ZSkKICAgICAgICAvLyBXaWxsIGRlZmF1bHQgdG8gYSBkYXRlIHRoYXQgaXMgZXhhY3RseSAzMCBkYXlzIGZyb20gc3RhcnQgZGF0ZS4KICAgICAgICBUREVFbmREYXRlID0gZW5kRGF0ZSA+IFRERVN0YXJ0RGF0ZSAmJiAoZW5kRGF0ZS1UREVTdGFydERhdGUpID49IDMwIGRheXMgPyBlbmREYXRlIDogKFRERVN0YXJ0RGF0ZSArIDMwIGRheXMpOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gQGRlcyBIYW5kbGUncyBFVEggc2VudCBkaXJlY3RseSB0byBjb250cmFjdCBhZGRyZXNzIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIGZ1bmN0aW9uICgpIHBheWFibGUgewoKICAgICAgICAvLyBIYW5kbGUgcHJlLXNhbGUgY29udHJpYnV0aW9uICh0b2tlbnMgaGVsZCwgdW50aWwgdHggY29uZmlybWF0aW9uIGZyb20gY29udHJpYnV0b3IpCiAgICAgICAgLy8gTWFrZXMgc3VyZSB0aGUgdXNlciBzZW5kcyBtaW5pbXVtIFBSRS1UREUgY29udHJpYnV0aW9uLCBhbmQgdGhhdCAgcHJlLXRkZSBjb250cmlidXRvcnMKICAgICAgICAvLyBhcmUgdW5hYmxlIHRvIHNlbmQgc3Vic2VxdWVudCBFVEggY29udHJpYnV0b3JzIGJlZm9yZSBiZWluZyBpc3N1ZWQgdG9rZW5zLgogICAgICAgIGlmIChub3cgPCBUREVTdGFydERhdGUgJiYgbXNnLnZhbHVlID49IG1pbmltdW1QUkVUREVDb250cmlidXRpb25JbldlaSAmJiBQUkVUREVDb250cmlidXRvclRva2Vuc1BlbmRpbmdSZWxlYXNlW21zZy5zZW5kZXJdID09IDApIHsKCiAgICAgICAgICAgIC8vIEtlZXAgdHJhY2sgb2YgY29udHJpYnV0aW9ucyAoaW4gV2VpKQogICAgICAgICAgICBFVEhDb250cmlidXRpb25zW21zZy5zZW5kZXJdID0gRVRIQ29udHJpYnV0aW9uc1ttc2cuc2VuZGVyXS5hZGQobXNnLnZhbHVlKTsKCiAgICAgICAgICAgIC8vIEluY3JlYXNlIHRvdGFsIGZ1bmRzIHJhaXNlZCBieSBjb250cmlidXRpb24KICAgICAgICAgICAgZnVuZHNSYWlzZWRJbldlaSA9IGZ1bmRzUmFpc2VkSW5XZWkuYWRkKG1zZy52YWx1ZSk7CgogICAgICAgICAgICAvLyBLZWVwIHRyYWNrIG9mIHByZXNhbGUgZnVuZHMgaW4gYWRkaXRpb24sIHNlcGFyYXRlbHkKICAgICAgICAgICAgcHJlc2FsZUZ1bmRzUmFpc2VkSW5XZWkgPSBwcmVzYWxlRnVuZHNSYWlzZWRJbldlaS5hZGQobXNnLnZhbHVlKTsKCiAgICAgICAgICAgIC8vLyBNYWtlIGEgbm90ZSBvZiBob3cgbWFueSB0b2tlbnMgdGhpcyB1c2VyIHNob3VsZCBnZXQgZm9yIHRoZWlyIGNvbnRyaWJ1dGlvbiB0byB0aGUgcHJlc2FsZQogICAgICAgICAgICBQUkVUREVDb250cmlidXRvclRva2Vuc1BlbmRpbmdSZWxlYXNlW21zZy5zZW5kZXJdID0gUFJFVERFQ29udHJpYnV0b3JUb2tlbnNQZW5kaW5nUmVsZWFzZVttc2cuc2VuZGVyXS5hZGQoY2FsY3VsYXRlVG9rZW5zKG1zZy52YWx1ZSwgbm93KSk7CgogICAgICAgICAgICAvLyBLZWVwIHRyYWNrIG9mIHBlbmRpbmcgdG9rZW5zCiAgICAgICAgICAgIFRva2Vuc1B1cmNoYXNlZER1cmluZ1BSRVRERSArPSBjYWxjdWxhdGVUb2tlbnMobXNnLnZhbHVlLCBub3cpOwoKICAgICAgICAgICAgLy8gSW5jcmVtZW50IG51bWJlciBvZiBwcmUtdGRlIGNvbnRyaWJ1dG9ycyB3YWl0aW5nIGZvciB0b2tlbnMKICAgICAgICAgICAgUFJFVERFQ29udHJpYnV0b3JzVG9rZW5zUGVuZGluZ0NvdW50ICs9IDE7CgogICAgICAgICAgICAvLyBQcmV2ZW50IGNvbnRyaWJ1dGlvbnMgdGhhdCB3aWxsIGNhdXNlIHVzIHRvIGhhdmUgYSBzaG9ydGFnZSBvZiB0b2tlbnMgZHVyaW5nIHRoZSBwcmUtc2FsZQogICAgICAgICAgICBpZiAoVG9rZW5zUHVyY2hhc2VkRHVyaW5nUFJFVERFID4gZG5uVG9rZW4uVERFU3VwcGx5UmVtYWluaW5nKCkrZG5uVG9rZW4uUFJFVERFU3VwcGx5UmVtYWluaW5nKCkpIHsKICAgICAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBUcmFuc2ZlciBjb250cmlidXRpb24gZGlyZWN0bHkgdG8gbXVsdGlzaWcKICAgICAgICAgICAgZG5uSG9sZGluZ011bHRpc2lnLnRyYW5zZmVyKG1zZy52YWx1ZSk7CiAgICAgICAgfQoKICAgICAgICAvLyBIYW5kbGUgcHVibGljLXNhbGUgY29udHJpYnV0aW9uICh0b2tlbnMgaXNzdWVkIGltbWVkaWF0ZWx5KQogICAgICAgIGVsc2UgaWYgKG5vdyA+PSBUREVTdGFydERhdGUgJiYgbm93IDwgVERFRW5kRGF0ZSkgYnV5VG9rZW5zKCk7CgogICAgICAgIC8vIE90aGVyd2lzZSwgcmVqZWN0IHRoZSBjb250cmlidXRpb24KICAgICAgICBlbHNlIHJldmVydCgpOwogICAgfQp9Cgpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCmxpYnJhcnkgU2FmZU1hdGggewogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9Cgpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogIC8qKgogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CgogICAgLy8gU2FmZU1hdGguc3ViIHdpbGwgdGhyb3cgaWYgdGhlcmUgaXMgbm90IGVub3VnaCBiYWxhbmNlLgogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgKi8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQp9Cgpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwoKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwoKICAgIHZhciBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07CgogICAgLy8gQ2hlY2sgaXMgbm90IG5lZWRlZCBiZWNhdXNlIHN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0CiAgICAvLyByZXF1aXJlIChfdmFsdWUgPD0gX2FsbG93YW5jZSk7CgogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CgogICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2AKICAgIC8vICBhbGxvd2FuY2UgdG8gemVybyBieSBjYWxsaW5nIGBhcHByb3ZlKF9zcGVuZGVyLCAwKWAgaWYgaXQgaXMgbm90CiAgICAvLyAgYWxyZWFkeSAwIHRvIG1pdGlnYXRlIHRoZSByYWNlIGNvbmRpdGlvbiBkZXNjcmliZWQgaGVyZToKICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgcmVxdWlyZSgoX3ZhbHVlID09IDApIHx8IChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9PSAwKSk7CgogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqLwogIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCmNvbnRyYWN0IEROTlRva2VuIGlzIFN0YW5kYXJkVG9rZW4gewoKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gVXNlZCB0byBpbmRpY2F0ZSB3aGljaCBhbGxvY2F0aW9uIHdlIGlzc3VlIHRva2VucyBmcm9tIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIGVudW0gRE5OU3VwcGx5QWxsb2NhdGlvbnMgewogICAgICAgIEVhcmx5QmFja2VyU3VwcGx5QWxsb2NhdGlvbiwKICAgICAgICBQUkVUREVTdXBwbHlBbGxvY2F0aW9uLAogICAgICAgIFRERVN1cHBseUFsbG9jYXRpb24sCiAgICAgICAgQm91bnR5U3VwcGx5QWxsb2NhdGlvbiwKICAgICAgICBXcml0ZXJBY2NvdW50U3VwcGx5QWxsb2NhdGlvbiwKICAgICAgICBBZHZpc29yeVN1cHBseUFsbG9jYXRpb24sCiAgICAgICAgUGxhdGZvcm1TdXBwbHlBbGxvY2F0aW9uCiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBTbWFydC1Db250cmFjdCB3aXRoIHBlcm1pc3Npb24gdG8gYWxsb2NhdGUgdG9rZW5zIGZyb20gc3VwcGxpZXMgLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgYWRkcmVzcyBwdWJsaWMgYWxsb2NhdG9yQWRkcmVzczsKICAgIGFkZHJlc3MgcHVibGljIGNyb3dkZnVuZENvbnRyYWN0OwoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gVG9rZW4gTWV0YSBEYXRhIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIHN0cmluZyBjb25zdGFudCBwdWJsaWMgbmFtZSA9ICJETk4iOwogICAgc3RyaW5nIGNvbnN0YW50IHB1YmxpYyBzeW1ib2wgPSAiRE5OIjsKICAgIHVpbnQ4IGNvbnN0YW50IHB1YmxpYyBkZWNpbWFscyA9IDE4OyAvLyAxIEROTiA9IDEgKiAxMF4xOCBhdHRvLUROTgoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBBZGRyZXNzZXMgb2YgdGhlIGNvLWZvdW5kZXJzIG9mIEROTiAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIGFkZHJlc3MgcHVibGljIGNvZm91bmRlckE7CiAgICBhZGRyZXNzIHB1YmxpYyBjb2ZvdW5kZXJCOwoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIEFkZHJlc3Mgb2YgUGxhdGZvcm0gLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIGFkZHJlc3MgcHVibGljIHBsYXRmb3JtOwoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gVG9rZW4gRGlzdHJpYnV0aW9ucyAoJSBvZiB0b3RhbCBzdXBwbHkpIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIHVpbnQyNTYgcHVibGljIGVhcmx5QmFja2VyU3VwcGx5OyAvLyAxMCUKICAgIHVpbnQyNTYgcHVibGljIFBSRVRERVN1cHBseTsgLy8gMTAlCiAgICB1aW50MjU2IHB1YmxpYyBUREVTdXBwbHk7IC8vIDQwJQogICAgdWludDI1NiBwdWJsaWMgYm91bnR5U3VwcGx5OyAvLyAxJQogICAgdWludDI1NiBwdWJsaWMgd3JpdGVyQWNjb3VudFN1cHBseTsgLy8gNCUKICAgIHVpbnQyNTYgcHVibGljIGFkdmlzb3J5U3VwcGx5OyAvLyAxNCUKICAgIHVpbnQyNTYgcHVibGljIGNvZm91bmRlcnNTdXBwbHk7IC8vIDEwJQogICAgdWludDI1NiBwdWJsaWMgcGxhdGZvcm1TdXBwbHk7IC8vIDExJQoKICAgIHVpbnQyNTYgcHVibGljIGVhcmx5QmFja2VyU3VwcGx5UmVtYWluaW5nOyAvLyAxMCUKICAgIHVpbnQyNTYgcHVibGljIFBSRVRERVN1cHBseVJlbWFpbmluZzsgLy8gMTAlCiAgICB1aW50MjU2IHB1YmxpYyBUREVTdXBwbHlSZW1haW5pbmc7IC8vIDQwJQogICAgdWludDI1NiBwdWJsaWMgYm91bnR5U3VwcGx5UmVtYWluaW5nOyAvLyAxJQogICAgdWludDI1NiBwdWJsaWMgd3JpdGVyQWNjb3VudFN1cHBseVJlbWFpbmluZzsgLy8gNCUKICAgIHVpbnQyNTYgcHVibGljIGFkdmlzb3J5U3VwcGx5UmVtYWluaW5nOyAvLyAxNCUKICAgIHVpbnQyNTYgcHVibGljIGNvZm91bmRlcnNTdXBwbHlSZW1haW5pbmc7IC8vIDEwJQogICAgdWludDI1NiBwdWJsaWMgcGxhdGZvcm1TdXBwbHlSZW1haW5pbmc7IC8vIDExJQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gQW1vdW50IG9mIENvRm91bmRlciBTdXBwbHkgdGhhdCBoYXMgYmVlbiBkaXN0cmlidXRlZCBiYXNlZCBvbiB2ZXN0aW5nIHNjaGVkdWxlIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIHVpbnQyNTYgcHVibGljIGNvZm91bmRlcnNTdXBwbHlWZXN0aW5nVHJhbmNoZXMgPSAxMDsKICAgIHVpbnQyNTYgcHVibGljIGNvZm91bmRlcnNTdXBwbHlWZXN0aW5nVHJhbmNoZXNJc3N1ZWQgPSAwOwogICAgdWludDI1NiBwdWJsaWMgY29mb3VuZGVyc1N1cHBseVZlc3RpbmdTdGFydERhdGU7IC8vIEVwb2NoCiAgICB1aW50MjU2IHB1YmxpYyBjb2ZvdW5kZXJzU3VwcGx5RGlzdHJpYnV0ZWQgPSAwOyAgLy8gIyBvZiBhdHRvLUROTiBkaXN0cmlidXRlZCB0byBmb3VuZGVycwoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIFByZXZlbnRzIHRva2VucyBmcm9tIGJlaW5nIHRyYW5zZmVycmFibGUgLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIGJvb2wgcHVibGljIHRva2Vuc0xvY2tlZCA9IHRydWU7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIEV2ZW50IHRyaWdnZXJlZCB3aGVuIHRva2VucyBhcmUgdHJhbnNmZXJyZWQgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDaGVja3MgaWYgdG9rZW5zIGNhbiBiZSBpc3N1ZWQgdG8gZm91bmRlciBhdCB0aGlzIHRpbWUgLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgbW9kaWZpZXIgQ29mb3VuZGVyc1Rva2Vuc1Zlc3RlZCgpCiAgICB7CiAgICAgICAgLy8gTWFrZSBzdXJlIHRoYXQgYSBzdGFydGluZyB2ZXN0aW5nIGRhdGUgaGFzIGJlZW4gc2V0IGFuZCA0IHdlZWtzIGhhdmUgcGFzc2VkIHNpbmNlIHZlc3RpbmcgZGF0ZQogICAgICAgIHJlcXVpcmUgKGNvZm91bmRlcnNTdXBwbHlWZXN0aW5nU3RhcnREYXRlICE9IDAgJiYgKG5vdy1jb2ZvdW5kZXJzU3VwcGx5VmVzdGluZ1N0YXJ0RGF0ZSkgPj0gNCB3ZWVrcyk7CgogICAgICAgIC8vIEdldCBjdXJyZW50IHRyYW5jaGUgYmFzZWQgb24gdGhlIGFtb3VudCBvZiB0aW1lIHRoYXQgaGFzIHBhc3NlZCBzaW5jZSB2ZXN0aW5nIHN0YXJ0IGRhdGUKICAgICAgICB1aW50MjU2IGN1cnJlbnRUcmFuY2hlID0gbm93LnN1Yihjb2ZvdW5kZXJzU3VwcGx5VmVzdGluZ1N0YXJ0RGF0ZSkgLyA0IHdlZWtzOwoKICAgICAgICAvLyBBbW91bnQgb2YgdHJhbmNoZXMgdGhhdCBoYXZlIGJlZW4gaXNzdWVkIHNvIGZhcgogICAgICAgIHVpbnQyNTYgaXNzdWVkVHJhbmNoZXMgPSBjb2ZvdW5kZXJzU3VwcGx5VmVzdGluZ1RyYW5jaGVzSXNzdWVkOwoKICAgICAgICAvLyBBbW91bnQgb2YgdHJhbmNoZXMgdGhhdCBjb2ZvdW5kZXJzIGFyZSBlbnRpdGxlZCB0bwogICAgICAgIHVpbnQyNTYgbWF4VHJhbmNoZXMgPSBjb2ZvdW5kZXJzU3VwcGx5VmVzdGluZ1RyYW5jaGVzOwoKICAgICAgICAvLyBNYWtlIHN1cmUgdGhhdCB3ZSBzdGlsbCBoYXZlIHVudmVzdGVkIHRva2VucyBhbmQgdGhhdAogICAgICAgIC8vIHRoZSB0b2tlbnMgZm9yIHRoZSBjdXJyZW50IHRyYW5jaGUgaGF2ZSBub3QgYmVlbiBpc3N1ZWQuCiAgICAgICAgcmVxdWlyZSAoaXNzdWVkVHJhbmNoZXMgIT0gbWF4VHJhbmNoZXMgJiYgY3VycmVudFRyYW5jaGUgPiBpc3N1ZWRUcmFuY2hlcyk7CgogICAgICAgIF87CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIENoZWNrcyBpZiB0b2tlbnMgYXJlIHVubG9ja2VkIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgbW9kaWZpZXIgVG9rZW5zVW5sb2NrZWQoKQogICAgewogICAgICAgIHJlcXVpcmUgKHRva2Vuc0xvY2tlZCA9PSBmYWxzZSk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIENoZWNrcyBpZiB0b2tlbnMgYXJlIGxvY2tlZCAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBtb2RpZmllciBUb2tlbnNMb2NrZWQoKQogICAgewogICAgICAgcmVxdWlyZSAodG9rZW5zTG9ja2VkID09IHRydWUpOwogICAgICAgXzsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDaGVja3MgaWYgQ29Gb3VuZGVycyBhcmUgcGVyZm9ybWluZyB0aGUgYWN0aW9uIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBtb2RpZmllciBvbmx5Q29mb3VuZGVycygpCiAgICB7CiAgICAgICAgcmVxdWlyZSAobXNnLnNlbmRlciA9PSBjb2ZvdW5kZXJBIHx8IG1zZy5zZW5kZXIgPT0gY29mb3VuZGVyQik7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDaGVja3MgaWYgQ29Gb3VuZGVyIEEgaXMgcGVyZm9ybWluZyB0aGUgYWN0aW9uIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBtb2RpZmllciBvbmx5Q29mb3VuZGVyQSgpCiAgICB7CiAgICAgICAgcmVxdWlyZSAobXNnLnNlbmRlciA9PSBjb2ZvdW5kZXJBKTsKICAgICAgICBfOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIENoZWNrcyBpZiBDb0ZvdW5kZXIgQiBpcyBwZXJmb3JtaW5nIHRoZSBhY3Rpb24gLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIG1vZGlmaWVyIG9ubHlDb2ZvdW5kZXJCKCkKICAgIHsKICAgICAgICByZXF1aXJlIChtc2cuc2VuZGVyID09IGNvZm91bmRlckIpOwogICAgICAgIF87CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDaGVja3MgdG8gc2VlIGlmIHdlIGFyZSBhbGxvd2VkIHRvIGNoYW5nZSB0aGUgYWxsb2NhdG9yIGFkZHJlc3MgLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgbW9kaWZpZXIgQ2FuU2V0QWxsb2NhdG9yKCkKICAgIHsKICAgICAgIHJlcXVpcmUgKGFsbG9jYXRvckFkZHJlc3MgPT0gYWRkcmVzcygweDApIHx8IHRva2Vuc0xvY2tlZCA9PSBmYWxzZSk7CiAgICAgICBfOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIENoZWNrcyB0byBzZWUgaWYgd2UgYXJlIGFsbG93ZWQgdG8gY2hhbmdlIHRoZSBjcm93ZGZ1bmQgY29udHJhY3QgLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIG1vZGlmaWVyIENhblNldENyb3dkZnVuZENvbnRyYWN0KCkKICAgIHsKICAgICAgIHJlcXVpcmUgKGNyb3dkZnVuZENvbnRyYWN0ID09IGFkZHJlc3MoMHgwKSk7CiAgICAgICBfOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDaGVja3MgaWYgQWxsb2NhdG9yIGlzIHBlcmZvcm1pbmcgdGhlIGFjdGlvbiAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIG1vZGlmaWVyIG9ubHlBbGxvY2F0b3IoKQogICAgewogICAgICAgIHJlcXVpcmUgKG1zZy5zZW5kZXIgPT0gYWxsb2NhdG9yQWRkcmVzcyAmJiB0b2tlbnNMb2NrZWQgPT0gZmFsc2UpOwogICAgICAgIF87CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIENoZWNrcyBpZiBDcm93ZGZ1bmQgQ29udHJhY3QgaXMgcGVyZm9ybWluZyB0aGUgYWN0aW9uIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgbW9kaWZpZXIgb25seUNyb3dkZnVuZENvbnRyYWN0KCkKICAgIHsKICAgICAgICByZXF1aXJlIChtc2cuc2VuZGVyID09IGNyb3dkZnVuZENvbnRyYWN0KTsKICAgICAgICBfOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDaGVja3MgaWYgQ3Jvd2RmdW5kIENvbnRyYWN0LCBQbGF0Zm9ybSwgb3IgQWxsb2NhdG9yIGlzIHBlcmZvcm1pbmcgdGhlIGFjdGlvbiAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIG1vZGlmaWVyIG9ubHlBbGxvY2F0b3JPckNyb3dkZnVuZENvbnRyYWN0T3JQbGF0Zm9ybSgpCiAgICB7CiAgICAgICAgcmVxdWlyZSAobXNnLnNlbmRlciA9PSBhbGxvY2F0b3JBZGRyZXNzIHx8IG1zZy5zZW5kZXIgPT0gY3Jvd2RmdW5kQ29udHJhY3QgfHwgbXNnLnNlbmRlciA9PSBwbGF0Zm9ybSk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gIEBkZXMgRnVuY3Rpb24gdG8gY2hhbmdlIGFkZHJlc3MgdGhhdCBpcyBtYW5hZ2UgcGxhdGZvcm0gaG9sZGluZyAgLy8KICAgIC8vICBAcGFyYW0gbmV3QWRkcmVzcyBBZGRyZXNzIG9mIG5ldyBpc3N1YW5jZSBjb250cmFjdC4gICAgICAgICAgICAgIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgZnVuY3Rpb24gY2hhbmdlUGxhdGZvcm0oYWRkcmVzcyBuZXdBZGRyZXNzKQogICAgICAgIG9ubHlDb2ZvdW5kZXJzCiAgICB7CiAgICAgICAgcGxhdGZvcm0gPSBuZXdBZGRyZXNzOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyAgQGRlcyBGdW5jdGlvbiB0byBjaGFuZ2UgYWRkcmVzcyB0aGF0IGlzIGFsbG93ZWQgdG8gZG8gdG9rZW4gaXNzdWFuY2UuIENyb3dkZnVuZCBjb250cmFjdCBjYW4gb25seSBiZSBzZXQgb25jZS4gICAvLwogICAgLy8gIEBwYXJhbSBuZXdBZGRyZXNzIEFkZHJlc3Mgb2YgbmV3IGlzc3VhbmNlIGNvbnRyYWN0LiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBmdW5jdGlvbiBjaGFuZ2VDcm93ZGZ1bmRDb250cmFjdChhZGRyZXNzIG5ld0FkZHJlc3MpCiAgICAgICAgb25seUNvZm91bmRlcnMKICAgICAgICBDYW5TZXRDcm93ZGZ1bmRDb250cmFjdAogICAgewogICAgICAgIGNyb3dkZnVuZENvbnRyYWN0ID0gbmV3QWRkcmVzczsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyAgQGRlcyBGdW5jdGlvbiB0byBjaGFuZ2UgYWRkcmVzcyB0aGF0IGlzIGFsbG93ZWQgdG8gZG8gdG9rZW4gaXNzdWFuY2UuIEFsbG9jYXRvciBjYW4gb25seSBiZSBzZXQgb25jZS4gIC8vCiAgICAvLyAgQHBhcmFtIG5ld0FkZHJlc3MgQWRkcmVzcyBvZiBuZXcgaXNzdWFuY2UgY29udHJhY3QuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBmdW5jdGlvbiBjaGFuZ2VBbGxvY2F0b3IoYWRkcmVzcyBuZXdBZGRyZXNzKQogICAgICAgIG9ubHlDb2ZvdW5kZXJzCiAgICAgICAgQ2FuU2V0QWxsb2NhdG9yCiAgICB7CiAgICAgICAgYWxsb2NhdG9yQWRkcmVzcyA9IG5ld0FkZHJlc3M7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gIEBkZXMgRnVuY3Rpb24gdG8gY2hhbmdlIGZvdW5kZXIgQSBhZGRyZXNzLiAgICAgICAvLwogICAgLy8gIEBwYXJhbSBuZXdBZGRyZXNzIEFkZHJlc3Mgb2YgbmV3IGZvdW5kZXIgQS4gICAgICAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgZnVuY3Rpb24gY2hhbmdlQ29mb3VuZGVyQShhZGRyZXNzIG5ld0FkZHJlc3MpCiAgICAgICAgb25seUNvZm91bmRlckEKICAgIHsKICAgICAgICBjb2ZvdW5kZXJBID0gbmV3QWRkcmVzczsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vICBAZGVzIEZ1bmN0aW9uIHRvIGNoYW5nZSBmb3VuZGVyIEIgYWRkcmVzcy4gICAgICAvLwogICAgLy8gIEBwYXJhbSBuZXdBZGRyZXNzIEFkZHJlc3Mgb2YgbmV3IGZvdW5kZXIgQi4gICAgIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIGZ1bmN0aW9uIGNoYW5nZUNvZm91bmRlckIoYWRkcmVzcyBuZXdBZGRyZXNzKQogICAgICAgIG9ubHlDb2ZvdW5kZXJCCiAgICB7CiAgICAgICAgY29mb3VuZGVyQiA9IG5ld0FkZHJlc3M7CiAgICB9CgoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBUcmFuc2ZlcnMgdG9rZW5zIGZyb20gc2VuZGVycyBhZGRyZXNzIHRvIGFub3RoZXIgYWRkcmVzcyAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkKICAgICAgVG9rZW5zVW5sb2NrZWQKICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICAgIHJldHVybiBCYXNpY1Rva2VuLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBUcmFuc2ZlcnMgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlciBhZGRyZXNzIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKQogICAgICBUb2tlbnNVbmxvY2tlZAogICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICAgIHJldHVybiBTdGFuZGFyZFRva2VuLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQoKCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gIEBkZXMgQ29mb3VuZGVycyBpc3N1ZSB0b2tlbnMgdG8gdGhlbXNsZXZlcyBpZiB3aXRoaW4gdmVzdGluZyBwZXJpb2QuIFJldHVybnMgc3VjY2Vzcy4gICAgLy8KICAgIC8vICBAcGFyYW0gYmVuZWZpY2lhcnkgQWRkcmVzcyBvZiByZWNlaXZlci4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vCiAgICAvLyAgQHBhcmFtIHRva2VuQ291bnQgTnVtYmVyIG9mIHRva2VucyB0byBpc3N1ZS4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIGZ1bmN0aW9uIGlzc3VlQ29mb3VuZGVyc1Rva2Vuc0lmUG9zc2libGUoKQogICAgICAgIG9ubHlDb2ZvdW5kZXJzCiAgICAgICAgQ29mb3VuZGVyc1Rva2Vuc1Zlc3RlZAogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgLy8gQ29tcHV0ZSB0b3RhbCBhbW91bnQgb2YgdmVzdGVkIHRva2VucyB0byBpc3N1ZQogICAgICAgIHVpbnQyNTYgdG9rZW5Db3VudCA9IGNvZm91bmRlcnNTdXBwbHkuZGl2KGNvZm91bmRlcnNTdXBwbHlWZXN0aW5nVHJhbmNoZXMpOwoKICAgICAgICAvLyBNYWtlIHN1cmUgdGhhdCB0aGVyZSBhcmUgY29mb3VuZGVyIHRva2VucyBsZWZ0CiAgICAgICAgaWYgKHRva2VuQ291bnQgPiBjb2ZvdW5kZXJzU3VwcGx5UmVtYWluaW5nKSB7CiAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgLy8gRGVjcmVhc2UgY29mb3VuZGVycyBzdXBwbHkKICAgICAgICBjb2ZvdW5kZXJzU3VwcGx5UmVtYWluaW5nID0gY29mb3VuZGVyc1N1cHBseVJlbWFpbmluZy5zdWIodG9rZW5Db3VudCk7CgogICAgICAgIC8vIFVwZGF0ZSBob3cgbWFueSB0b2tlbnMgaGF2ZSBiZWVuIGRpc3RyaWJ1dGVkIHRvIGNvZm91bmRlcnMKICAgICAgICBjb2ZvdW5kZXJzU3VwcGx5RGlzdHJpYnV0ZWQgPSBjb2ZvdW5kZXJzU3VwcGx5RGlzdHJpYnV0ZWQuYWRkKHRva2VuQ291bnQpOwoKICAgICAgICAvLyBTcGxpdCB0b2tlbnMgYmV0d2VlbiBib3RoIGZvdW5kZXJzCiAgICAgICAgYmFsYW5jZXNbY29mb3VuZGVyQV0gPSBiYWxhbmNlc1tjb2ZvdW5kZXJBXS5hZGQodG9rZW5Db3VudC5kaXYoMikpOwogICAgICAgIGJhbGFuY2VzW2NvZm91bmRlckJdID0gYmFsYW5jZXNbY29mb3VuZGVyQl0uYWRkKHRva2VuQ291bnQuZGl2KDIpKTsKCiAgICAgICAgLy8gVXBkYXRlIHRoYXQgYSB0cmFuY2hlIGhhcyBiZWVuIGlzc3VlZAogICAgICAgIGNvZm91bmRlcnNTdXBwbHlWZXN0aW5nVHJhbmNoZXNJc3N1ZWQgKz0gMTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gSXNzdWUgdG9rZW5zIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8KICAgIGZ1bmN0aW9uIGlzc3VlVG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQyNTYgdG9rZW5Db3VudCwgRE5OU3VwcGx5QWxsb2NhdGlvbnMgYWxsb2NhdGlvblR5cGUpCiAgICAgIG9ubHlBbGxvY2F0b3JPckNyb3dkZnVuZENvbnRyYWN0T3JQbGF0Zm9ybQogICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIC8vIFdlJ2xsIHVzZSB0aGUgZm9sbG93aW5nIHRvIGRldGVybWluZSB3aGV0aGVyIHRoZSBhbGxvY2F0b3IsIHBsYXRmb3JtLAogICAgICAgIC8vIG9yIHRoZSBjcm93ZGZ1bmRpbmcgY29udHJhY3QgY2FuIGFsbG9jYXRlIHNwZWNpZmllZCBzdXBwbHkKICAgICAgICBib29sIGNhbkFsbG9jYXRvclBlcmZvcm0gPSBtc2cuc2VuZGVyID09IGFsbG9jYXRvckFkZHJlc3MgJiYgdG9rZW5zTG9ja2VkID09IGZhbHNlOwogICAgICAgIGJvb2wgY2FuQ3Jvd2RmdW5kQ29udHJhY3RQZXJmb3JtID0gbXNnLnNlbmRlciA9PSBjcm93ZGZ1bmRDb250cmFjdDsKICAgICAgICBib29sIGNhblBsYXRmb3JtUGVyZm9ybSA9IG1zZy5zZW5kZXIgPT0gcGxhdGZvcm0gJiYgdG9rZW5zTG9ja2VkID09IGZhbHNlOwoKICAgICAgICAvLyBFYXJseSBCYWNrZXJzCiAgICAgICAgaWYgKGNhbkFsbG9jYXRvclBlcmZvcm0gJiYgYWxsb2NhdGlvblR5cGUgPT0gRE5OU3VwcGx5QWxsb2NhdGlvbnMuRWFybHlCYWNrZXJTdXBwbHlBbGxvY2F0aW9uICYmIHRva2VuQ291bnQgPD0gZWFybHlCYWNrZXJTdXBwbHlSZW1haW5pbmcpIHsKICAgICAgICAgICAgZWFybHlCYWNrZXJTdXBwbHlSZW1haW5pbmcgPSBlYXJseUJhY2tlclN1cHBseVJlbWFpbmluZy5zdWIodG9rZW5Db3VudCk7CiAgICAgICAgfQoKICAgICAgICAvLyBQUkUtVERFCiAgICAgICAgZWxzZSBpZiAoY2FuQ3Jvd2RmdW5kQ29udHJhY3RQZXJmb3JtICYmIG1zZy5zZW5kZXIgPT0gY3Jvd2RmdW5kQ29udHJhY3QgJiYgYWxsb2NhdGlvblR5cGUgPT0gRE5OU3VwcGx5QWxsb2NhdGlvbnMuUFJFVERFU3VwcGx5QWxsb2NhdGlvbikgewoKICAgICAgICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgd2UgaGF2ZSBlbm91Z2ggdG9rZW5zIHRvIHNhdGlzZnkgdGhpcyBwdXJjaGFzZQogICAgICAgICAgICAgIC8vIHVzaW5nIGp1c3QgdGhlIHByZS10ZGUuCiAgICAgICAgICAgICAgaWYgKFBSRVRERVN1cHBseVJlbWFpbmluZyA+PSB0b2tlbkNvdW50KSB7CgogICAgICAgICAgICAgICAgICAgIC8vIERlY3JlYXNlIHByZS10ZGUgc3VwcGx5CiAgICAgICAgICAgICAgICAgICAgUFJFVERFU3VwcGx5UmVtYWluaW5nID0gUFJFVERFU3VwcGx5UmVtYWluaW5nLnN1Yih0b2tlbkNvdW50KTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIC8vIENoZWNrIHRvIHNlZSBpZiB3ZSBjYW4gc2F0aXNmeSB0aGlzIHVzaW5nIHByZS10ZGUgYW5kIHRkZSBzdXBwbHkgY29tYmluZWQKICAgICAgICAgICAgICBlbHNlIGlmIChQUkVUREVTdXBwbHlSZW1haW5pbmcrVERFU3VwcGx5UmVtYWluaW5nID49IHRva2VuQ291bnQpIHsKCiAgICAgICAgICAgICAgICAgICAgLy8gRGVjcmVhc2UgdGRlIHN1cHBseQogICAgICAgICAgICAgICAgICAgIFRERVN1cHBseVJlbWFpbmluZyA9IFRERVN1cHBseVJlbWFpbmluZy5zdWIodG9rZW5Db3VudC1QUkVUREVTdXBwbHlSZW1haW5pbmcpOwoKICAgICAgICAgICAgICAgICAgICAvLyBEZWNyZWFzZSBwcmUtdGRlIHN1cHBseSBieSBpdHMnIHJlbWFpbmluZyB0b2tlbnMKICAgICAgICAgICAgICAgICAgICBQUkVUREVTdXBwbHlSZW1haW5pbmcgPSAwOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgLy8gT3RoZXJ3aXNlLCB3ZSBjYW4ndCBzYXRpc2Z5IHRoaXMgc2FsZSBiZWNhdXNlIHdlIGRvbid0IGhhdmUgZW5vdWdoIHRva2Vucy4KICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIFRERQogICAgICAgIGVsc2UgaWYgKGNhbkNyb3dkZnVuZENvbnRyYWN0UGVyZm9ybSAmJiBhbGxvY2F0aW9uVHlwZSA9PSBETk5TdXBwbHlBbGxvY2F0aW9ucy5UREVTdXBwbHlBbGxvY2F0aW9uICYmIHRva2VuQ291bnQgPD0gVERFU3VwcGx5UmVtYWluaW5nKSB7CiAgICAgICAgICAgIFRERVN1cHBseVJlbWFpbmluZyA9IFRERVN1cHBseVJlbWFpbmluZy5zdWIodG9rZW5Db3VudCk7CiAgICAgICAgfQoKICAgICAgICAvLyBCb3VudHkKICAgICAgICBlbHNlIGlmIChjYW5BbGxvY2F0b3JQZXJmb3JtICYmIGFsbG9jYXRpb25UeXBlID09IEROTlN1cHBseUFsbG9jYXRpb25zLkJvdW50eVN1cHBseUFsbG9jYXRpb24gJiYgdG9rZW5Db3VudCA8PSBib3VudHlTdXBwbHlSZW1haW5pbmcpIHsKICAgICAgICAgICAgYm91bnR5U3VwcGx5UmVtYWluaW5nID0gYm91bnR5U3VwcGx5UmVtYWluaW5nLnN1Yih0b2tlbkNvdW50KTsKICAgICAgICB9CgogICAgICAgIC8vIFdyaXRlciBBY2NvdW50cwogICAgICAgIGVsc2UgaWYgKGNhbkFsbG9jYXRvclBlcmZvcm0gJiYgYWxsb2NhdGlvblR5cGUgPT0gRE5OU3VwcGx5QWxsb2NhdGlvbnMuV3JpdGVyQWNjb3VudFN1cHBseUFsbG9jYXRpb24gJiYgdG9rZW5Db3VudCA8PSB3cml0ZXJBY2NvdW50U3VwcGx5UmVtYWluaW5nKSB7CiAgICAgICAgICAgIHdyaXRlckFjY291bnRTdXBwbHlSZW1haW5pbmcgPSB3cml0ZXJBY2NvdW50U3VwcGx5UmVtYWluaW5nLnN1Yih0b2tlbkNvdW50KTsKICAgICAgICB9CgogICAgICAgIC8vIEFkdmlzb3J5CiAgICAgICAgZWxzZSBpZiAoY2FuQWxsb2NhdG9yUGVyZm9ybSAmJiBhbGxvY2F0aW9uVHlwZSA9PSBETk5TdXBwbHlBbGxvY2F0aW9ucy5BZHZpc29yeVN1cHBseUFsbG9jYXRpb24gJiYgdG9rZW5Db3VudCA8PSBhZHZpc29yeVN1cHBseVJlbWFpbmluZykgewogICAgICAgICAgICBhZHZpc29yeVN1cHBseVJlbWFpbmluZyA9IGFkdmlzb3J5U3VwcGx5UmVtYWluaW5nLnN1Yih0b2tlbkNvdW50KTsKICAgICAgICB9CgogICAgICAgIC8vIFBsYXRmb3JtIChBbHNvIG1ha2VzIHN1cmUgdGhhdCB0aGUgYmVuZWZpY2lhcnkgaXMgdGhlIHBsYXRmb3JtIGFkZHJlc3Mgc3BlY2lmaWVkIGluIHRoaXMgY29udHJhY3QpCiAgICAgICAgZWxzZSBpZiAoY2FuUGxhdGZvcm1QZXJmb3JtICYmIGFsbG9jYXRpb25UeXBlID09IEROTlN1cHBseUFsbG9jYXRpb25zLlBsYXRmb3JtU3VwcGx5QWxsb2NhdGlvbiAmJiB0b2tlbkNvdW50IDw9IHBsYXRmb3JtU3VwcGx5UmVtYWluaW5nKSB7CiAgICAgICAgICAgIHBsYXRmb3JtU3VwcGx5UmVtYWluaW5nID0gcGxhdGZvcm1TdXBwbHlSZW1haW5pbmcuc3ViKHRva2VuQ291bnQpOwogICAgICAgIH0KCiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIC8vIENyZWRpdCB0b2tlbnMgdG8gdGhlIGFkZHJlc3Mgc3BlY2lmaWVkCiAgICAgICAgYmFsYW5jZXNbYmVuZWZpY2lhcnldID0gYmFsYW5jZXNbYmVuZWZpY2lhcnldLmFkZCh0b2tlbkNvdW50KTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gVHJhbnNmZXIgVW5zb2xkIHRva2VucyBmcm9tIFRERSB0byBQbGF0Zm9ybSAvLwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgZnVuY3Rpb24gc2VuZFVuc29sZFRERVRva2Vuc1RvUGxhdGZvcm0oKQogICAgICBleHRlcm5hbAogICAgICBvbmx5Q3Jvd2RmdW5kQ29udHJhY3QKICAgIHsKICAgICAgICAvLyBNYWtlIHN1cmUgd2UgaGF2ZSB0b2tlbnMgdG8gc2VuZCBmcm9tIFRERQogICAgICAgIGlmIChUREVTdXBwbHlSZW1haW5pbmcgPiAwKSB7CgogICAgICAgICAgICAvLyBBZGQgcmVtYWluaW5nIHRkZSB0b2tlbnMgdG8gcGxhdGZvcm0gcmVtYWluaW5nIHRva2VucwogICAgICAgICAgICBwbGF0Zm9ybVN1cHBseVJlbWFpbmluZyA9IHBsYXRmb3JtU3VwcGx5UmVtYWluaW5nLmFkZChUREVTdXBwbHlSZW1haW5pbmcpOwoKICAgICAgICAgICAgLy8gQ2xlYXIgcmVtYWluaW5nIHRkZSB0b2tlbiBjb3VudAogICAgICAgICAgICBUREVTdXBwbHlSZW1haW5pbmcgPSAwOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gVHJhbnNmZXIgVW5zb2xkIHRva2VucyBmcm9tIHByZS1UREUgdG8gUGxhdGZvcm0gLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBmdW5jdGlvbiBzZW5kVW5zb2xkUFJFVERFVG9rZW5zVG9UREUoKQogICAgICBleHRlcm5hbAogICAgICBvbmx5Q3Jvd2RmdW5kQ29udHJhY3QKICAgIHsKICAgICAgICAgIC8vIE1ha2Ugc3VyZSB3ZSBoYXZlIHRva2VucyB0byBzZW5kIGZyb20gcHJlLVRERQogICAgICAgICAgaWYgKFBSRVRERVN1cHBseVJlbWFpbmluZyA+IDApIHsKCiAgICAgICAgICAgICAgLy8gQWRkIHJlbWFpbmluZyBwcmUtdGRlIHRva2VucyB0byB0ZGUgcmVtYWluaW5nIHRva2VucwogICAgICAgICAgICAgIFRERVN1cHBseVJlbWFpbmluZyA9IFRERVN1cHBseVJlbWFpbmluZy5hZGQoUFJFVERFU3VwcGx5UmVtYWluaW5nKTsKCiAgICAgICAgICAgICAgLy8gQ2xlYXIgcmVtYWluaW5nIHByZS10ZGUgdG9rZW4gY291bnQKICAgICAgICAgICAgICBQUkVUREVTdXBwbHlSZW1haW5pbmcgPSAwOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBAZGVzIEFsbG93cyB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyYWJsZS4gUmV0dXJucyBsb2NrIHN0YXRlIC8vCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBmdW5jdGlvbiB1bmxvY2tUb2tlbnMoKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgb25seUNyb3dkZnVuZENvbnRyYWN0CiAgICB7CiAgICAgICAgLy8gTWFrZSBzdXJlIHRva2VucyBhcmUgY3VycmVudGx5IGxvY2tlZCBiZWZvcmUgcHJvY2VlZGluZyB0byB1bmxvY2sgdGhlbQogICAgICAgIHJlcXVpcmUodG9rZW5zTG9ja2VkID09IHRydWUpOwoKICAgICAgICB0b2tlbnNMb2NrZWQgPSBmYWxzZTsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gIEBkZXMgQ29udHJhY3QgY29uc3RydWN0b3IgZnVuY3Rpb24gc2V0cyBpbml0aWFsIHRva2VuIGJhbGFuY2VzLiAgLy8KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICBmdW5jdGlvbiBETk5Ub2tlbihhZGRyZXNzIGZvdW5kZXJBLCBhZGRyZXNzIGZvdW5kZXJCLCBhZGRyZXNzIHBsYXRmb3JtQWRkcmVzcywgdWludDI1NiB2ZXN0aW5nU3RhcnREYXRlKQogICAgewogICAgICAgICAgLy8gU2V0IGNvZm91bmRlciBhZGRyZXNzZXMKICAgICAgICAgIGNvZm91bmRlckEgPSBmb3VuZGVyQTsKICAgICAgICAgIGNvZm91bmRlckIgPSBmb3VuZGVyQjsKCiAgICAgICAgICAvLyBTZXRzIHBsYXRmb3JtIGFkZHJlc3MKICAgICAgICAgIHBsYXRmb3JtID0gcGxhdGZvcm1BZGRyZXNzOwoKICAgICAgICAgIC8vIFNldCB0b3RhbCBzdXBwbHkgLSAxIEJpbGxpb24gRE5OIFRva2VucyA9ICgxLDAwMCwwMDAsMDAwICogMTBeMTgpIGF0dG8tRE5OCiAgICAgICAgICAvLyAxIEROTiA9IDEwXjE4IGF0dG8tRE5OCiAgICAgICAgICB0b3RhbFN1cHBseSA9IHVpbnQyNTYoMTAwMDAwMDAwMCkubXVsKHVpbnQyNTYoMTApKipkZWNpbWFscyk7CgogICAgICAgICAgLy8gU2V0IFRva2VuIERpc3RyaWJ1dGlvbnMgKCUgb2YgdG90YWwgc3VwcGx5KQogICAgICAgICAgZWFybHlCYWNrZXJTdXBwbHkgPSB0b3RhbFN1cHBseS5tdWwoMTApLmRpdigxMDApOyAvLyAxMCUKICAgICAgICAgIFBSRVRERVN1cHBseSA9IHRvdGFsU3VwcGx5Lm11bCgxMCkuZGl2KDEwMCk7IC8vIDEwJQogICAgICAgICAgVERFU3VwcGx5ID0gdG90YWxTdXBwbHkubXVsKDQwKS5kaXYoMTAwKTsgLy8gNDAlCiAgICAgICAgICBib3VudHlTdXBwbHkgPSB0b3RhbFN1cHBseS5tdWwoMSkuZGl2KDEwMCk7IC8vIDElCiAgICAgICAgICB3cml0ZXJBY2NvdW50U3VwcGx5ID0gdG90YWxTdXBwbHkubXVsKDQpLmRpdigxMDApOyAvLyA0JQogICAgICAgICAgYWR2aXNvcnlTdXBwbHkgPSB0b3RhbFN1cHBseS5tdWwoMTQpLmRpdigxMDApOyAvLyAxNCUKICAgICAgICAgIGNvZm91bmRlcnNTdXBwbHkgPSB0b3RhbFN1cHBseS5tdWwoMTApLmRpdigxMDApOyAvLyAxMCUKICAgICAgICAgIHBsYXRmb3JtU3VwcGx5ID0gdG90YWxTdXBwbHkubXVsKDExKS5kaXYoMTAwKTsgLy8gMTElCgogICAgICAgICAgLy8gU2V0IGVhY2ggcmVtYWluaW5nIHRva2VuIGNvdW50IGVxdWFsIHRvIGl0cycgcmVzcGVjdGl2ZSBzdXBwbHkKICAgICAgICAgIGVhcmx5QmFja2VyU3VwcGx5UmVtYWluaW5nID0gZWFybHlCYWNrZXJTdXBwbHk7CiAgICAgICAgICBQUkVUREVTdXBwbHlSZW1haW5pbmcgPSBQUkVUREVTdXBwbHk7CiAgICAgICAgICBUREVTdXBwbHlSZW1haW5pbmcgPSBUREVTdXBwbHk7CiAgICAgICAgICBib3VudHlTdXBwbHlSZW1haW5pbmcgPSBib3VudHlTdXBwbHk7CiAgICAgICAgICB3cml0ZXJBY2NvdW50U3VwcGx5UmVtYWluaW5nID0gd3JpdGVyQWNjb3VudFN1cHBseTsKICAgICAgICAgIGFkdmlzb3J5U3VwcGx5UmVtYWluaW5nID0gYWR2aXNvcnlTdXBwbHk7CiAgICAgICAgICBjb2ZvdW5kZXJzU3VwcGx5UmVtYWluaW5nID0gY29mb3VuZGVyc1N1cHBseTsKICAgICAgICAgIHBsYXRmb3JtU3VwcGx5UmVtYWluaW5nID0gcGxhdGZvcm1TdXBwbHk7CgogICAgICAgICAgLy8gU2V0cyBjb2ZvdW5kZXIgdmVzdGluZyBzdGFydCBkYXRlIChFbnN1cmVzIHRoYXQgaXQgaXMgYSBkYXRlIGluIHRoZSBmdXR1cmUsIG90aGVyd2lzZSBpdCB3aWxsIGRlZmF1bHQgdG8gbm93KQogICAgICAgICAgY29mb3VuZGVyc1N1cHBseVZlc3RpbmdTdGFydERhdGUgPSB2ZXN0aW5nU3RhcnREYXRlID49IG5vdyA/IHZlc3RpbmdTdGFydERhdGUgOiBub3c7CiAgICB9Cn0='.
	

]
