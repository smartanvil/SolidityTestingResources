Class {
	#name : #SRTfd9683e9f2c62e08b6bf68123e18e527efa8fbbc,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTfd9683e9f2c62e08b6bf68123e18e527efa8fbbc >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9CgovKioKICogQHRpdGxlIFBhdXNhYmxlT25jZQogKiBAZGV2IFRoZSBQYXVzYWJsZU9uY2UgY29udHJhY3QgcHJvdmlkZXMgYW4gb3B0aW9uIGZvciB0aGUgInBhdXNlTWFzdGVyIgogKiB0byBwYXVzZSBvbmNlIHRoZSB0cmFuc2FjdGlvbnMgZm9yIHR3byB3ZWVrcy4KICoKICovCgpjb250cmFjdCBQYXVzYWJsZU9uY2UgaXMgT3duYWJsZSB7CgogICAgLyoqIEFkZHJlc3MgdGhhdCBjYW4gc3RhcnQgdGhlIHBhdXNlICovCiAgICBhZGRyZXNzIHB1YmxpYyBwYXVzZU1hc3RlcjsKCiAgICB1aW50IGNvbnN0YW50IGludGVybmFsIFBBVVNFX0RVUkFUSU9OID0gMTQgZGF5czsKICAgIHVpbnQ2NCBwdWJsaWMgcGF1c2VFbmQgPSAwOwoKICAgIGV2ZW50IFBhdXNlZCgpOwoKICAgIC8qKgogICAgICogQGRldiBTZXQgdGhlIHBhdXNlTWFzdGVyIChjYWxsYWJsZSBieSB0aGUgb3duZXIgb25seSkuCiAgICAgKiBAcGFyYW0gX3BhdXNlTWFzdGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBwYXVzZU1hc3RlcgogICAgICovCiAgICBmdW5jdGlvbiBzZXRQYXVzZU1hc3RlcihhZGRyZXNzIF9wYXVzZU1hc3Rlcikgb25seU93bmVyIGV4dGVybmFsIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoX3BhdXNlTWFzdGVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHBhdXNlTWFzdGVyID0gX3BhdXNlTWFzdGVyOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBTdGFydCB0aGUgcGF1c2UgKGJ5IHRoZSBwYXVzZU1hc3RlciwgT05DRSBvbmx5KS4KICAgICAqLwogICAgZnVuY3Rpb24gcGF1c2UoKSBvbmx5UGF1c2VNYXN0ZXIgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmVxdWlyZShwYXVzZUVuZCA9PSAwKTsKICAgICAgICBwYXVzZUVuZCA9IHVpbnQ2NChub3cgKyBQQVVTRV9EVVJBVElPTik7CiAgICAgICAgUGF1c2VkKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIG5vdCBwYXVzZWQuCiAgICAgKi8KICAgIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICAgICAgcmVxdWlyZShub3cgPiBwYXVzZUVuZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBwYXVzZU1hc3Rlci4KICAgICAqLwogICAgbW9kaWZpZXIgb25seVBhdXNlTWFzdGVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBwYXVzZU1hc3Rlcik7CiAgICAgICAgXzsKICAgIH0KCn0KCi8qKgogKiBAdGl0bGUgRVJDMjBCYXNpYwogKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE3OQogKi8KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogIC8qKgogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwoKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cgp9CgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbgogKgogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CgogICAgdWludDI1NiBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07CgogICAgLy8gQ2hlY2sgaXMgbm90IG5lZWRlZCBiZWNhdXNlIHN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0CiAgICAvLyByZXF1aXJlIChfdmFsdWUgPD0gX2FsbG93YW5jZSk7CgogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CgogIC8qKgogICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAogICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICovCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCi8qKgoqIEB0aXRsZSBVcGdyYWRlIGFnZW50IGludGVyZmFjZQoqLwpjb250cmFjdCBJbnRlcmZhY2VVcGdyYWRlQWdlbnQgewoKICAgIHVpbnQzMiBwdWJsaWMgcmV2aXNpb247CiAgICB1aW50MjU2IHB1YmxpYyBvcmlnaW5hbFN1cHBseTsKCiAgICAvKioKICAgICAqIEBkZXYgUmVpc3N1ZSB0aGUgdG9rZW5zIG9udG8gdGhlIG5ldyBjb250cmFjdCByZXZpc2lvbi4KICAgICAqIEBwYXJhbSBob2xkZXIgSG9sZGVyIChvd25lcikgb2YgdGhlIHRva2VucwogICAgICogQHBhcmFtIHRva2VuUXR5IEhvdyBtYW55IHRva2VucyB0byBiZSBpc3N1ZWQKICAgICAqLwogICAgZnVuY3Rpb24gdXBncmFkZUZyb20oYWRkcmVzcyBob2xkZXIsIHVpbnQyNTYgdG9rZW5RdHkpIHB1YmxpYzsKfQoKLyoqCiAqIEB0aXRsZSBVcGdyYWRhYmxlVG9rZW4KICogQGRldiBUaGUgVXBncmFkYWJsZVRva2VuIGNvbnRyYWN0IHByb3ZpZGVzIGFuIG9wdGlvbiBvZiB1cGdyYWRpbmcgdGhlIHRva2VucyB0byBhIG5ldyByZXZpc2lvbi4KICogVGhlICJ1cGdyYWRlTWFzdGVyIiBtYXkgcHJvcG9zZSB0aGUgdXBncmFkZS4gVG9rZW4gaG9sZGVycyBjYW4gb3B0LWluIGFtb3VudCBvZiB0b2tlbnMgdG8gdXBncmFkZS4KICovCgpjb250cmFjdCBVcGdyYWRhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZSB7CgogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgdWludDMyIHB1YmxpYyBSRVZJU0lPTjsKCiAgICAvKiogQWRkcmVzcyB0aGF0IGNhbiBzZXQgdGhlIHVwZ3JhZGUgYWdlbnQgdGh1cyBlbmFibGluZyB0aGUgdXBncmFkZS4gKi8KICAgIGFkZHJlc3MgcHVibGljIHVwZ3JhZGVNYXN0ZXIgPSBhZGRyZXNzKDApOwoKICAgIC8qKiBBZGRyZXNzIG9mIHRoZSBjb250cmFjdCB0aGF0IGlzc3VlcyB0aGUgbmV3IHJldmlzaW9uIHRva2Vucy4gKi8KICAgIGFkZHJlc3MgcHVibGljIHVwZ3JhZGVBZ2VudCA9IGFkZHJlc3MoMCk7CgogICAgLyoqIEhvdyBtYW55IHRva2VucyBhcmUgdXBncmFkZWQuICovCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFVwZ3JhZGVkOwoKICAgIGV2ZW50IFVwZ3JhZGUoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCB1aW50MjU2IF92YWx1ZSk7CiAgICBldmVudCBVcGdyYWRlRW5hYmxlZChhZGRyZXNzIGFnZW50KTsKCiAgICAvKioKICAgICAqIEBkZXYgU2V0IHRoZSB1cGdyYWRlIG1hc3Rlci4KICAgICAqIHBhcmFtZXRlciBfdXBncmFkZU1hc3RlciBVcGdyYWRlIG1hc3RlcgogICAgICovCiAgICBmdW5jdGlvbiBzZXRVcGdyYWRlTWFzdGVyKGFkZHJlc3MgX3VwZ3JhZGVNYXN0ZXIpIG9ubHlPd25lciBleHRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShfdXBncmFkZU1hc3RlciAhPSBhZGRyZXNzKDApKTsKICAgICAgICB1cGdyYWRlTWFzdGVyID0gX3VwZ3JhZGVNYXN0ZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IFNldCB0aGUgdXBncmFkZSBhZ2VudCAob25jZSBvbmx5KSB0aHVzIGVuYWJsaW5nIHRoZSB1cGdyYWRlLgogICAgICogQHBhcmFtIF91cGdyYWRlQWdlbnQgVXBncmFkZSBhZ2VudCBjb250cmFjdCBhZGRyZXNzCiAgICAgKiBAcGFyYW0gX3JldmlzaW9uIFVuaXF1ZSBJRCB0aGF0IGFnZW50IGNvbnRyYWN0IG11c3QgcmV0dXJuIG9uICIucmV2aXNpb24oKSIKICAgICAqLwogICAgZnVuY3Rpb24gc2V0VXBncmFkZUFnZW50KGFkZHJlc3MgX3VwZ3JhZGVBZ2VudCwgdWludDMyIF9yZXZpc2lvbikKICAgICAgICBvbmx5VXBncmFkZU1hc3RlciB3aGVuVXBncmFkZURpc2FibGVkIGV4dGVybmFsCiAgICB7CiAgICAgICAgcmVxdWlyZSgoX3VwZ3JhZGVBZ2VudCAhPSBhZGRyZXNzKDApKSAmJiAoX3JldmlzaW9uICE9IDApKTsKCiAgICAgICAgSW50ZXJmYWNlVXBncmFkZUFnZW50IGFnZW50ID0gSW50ZXJmYWNlVXBncmFkZUFnZW50KF91cGdyYWRlQWdlbnQpOwoKICAgICAgICByZXF1aXJlKGFnZW50LnJldmlzaW9uKCkgPT0gX3JldmlzaW9uKTsKICAgICAgICByZXF1aXJlKGFnZW50Lm9yaWdpbmFsU3VwcGx5KCkgPT0gdG90YWxTdXBwbHkpOwoKICAgICAgICB1cGdyYWRlQWdlbnQgPSBfdXBncmFkZUFnZW50OwogICAgICAgIFVwZ3JhZGVFbmFibGVkKF91cGdyYWRlQWdlbnQpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBVcGdyYWRlIHRva2VucyB0byB0aGUgbmV3IHJldmlzaW9uLgogICAgICogQHBhcmFtIHZhbHVlIEhvdyBtYW55IHRva2VucyB0byBiZSB1cGdyYWRlZAogICAgICovCiAgICBmdW5jdGlvbiB1cGdyYWRlKHVpbnQyNTYgdmFsdWUpIHdoZW5VcGdyYWRlRW5hYmxlZCBleHRlcm5hbCB7CiAgICAgICAgcmVxdWlyZSh2YWx1ZSA+IDApOwoKICAgICAgICB1aW50MjU2IGJhbGFuY2UgPSBiYWxhbmNlc1ttc2cuc2VuZGVyXTsKICAgICAgICByZXF1aXJlKGJhbGFuY2UgPiAwKTsKCiAgICAgICAgLy8gVGFrZSB0b2tlbnMgb3V0IGZyb20gdGhlIG9sZCBjb250cmFjdAogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZS5zdWIodmFsdWUpOwogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuc3ViKHZhbHVlKTsKICAgICAgICB0b3RhbFVwZ3JhZGVkID0gdG90YWxVcGdyYWRlZC5hZGQodmFsdWUpOwogICAgICAgIC8vIElzc3VlIHRoZSBuZXcgcmV2aXNpb24gdG9rZW5zCiAgICAgICAgSW50ZXJmYWNlVXBncmFkZUFnZW50IGFnZW50ID0gSW50ZXJmYWNlVXBncmFkZUFnZW50KHVwZ3JhZGVBZ2VudCk7CiAgICAgICAgYWdlbnQudXBncmFkZUZyb20obXNnLnNlbmRlciwgdmFsdWUpOwoKICAgICAgICBVcGdyYWRlKG1zZy5zZW5kZXIsIHZhbHVlKTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSB1cGdyYWRlIGlzIGVuYWJsZWQuCiAgICAqLwogICAgbW9kaWZpZXIgd2hlblVwZ3JhZGVFbmFibGVkKCkgewogICAgICAgIHJlcXVpcmUodXBncmFkZUFnZW50ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgdXBncmFkZSBpcyBpbXBvc3NpYmxlLgogICAgKi8KICAgIG1vZGlmaWVyIHdoZW5VcGdyYWRlRGlzYWJsZWQoKSB7CiAgICAgICAgcmVxdWlyZSh1cGdyYWRlQWdlbnQgPT0gYWRkcmVzcygwKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIHVwZ3JhZGVNYXN0ZXIuCiAgICAqLwogICAgbW9kaWZpZXIgb25seVVwZ3JhZGVNYXN0ZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHVwZ3JhZGVNYXN0ZXIpOwogICAgICAgIF87CiAgICB9Cgp9CgovKioKICogQHRpdGxlIFdpdGhkcmF3YWJsZQogKiBAZGV2IFRoZSBXaXRoZHJhd2FibGUgY29udHJhY3QgcHJvdmlkZXMgYSBtZWNoYW5pc20gb2Ygd2l0aGRyYXdhbChzKS4KICogIldpdGhkcmF3YWxzIiBhcmUgcGVybWlzc2lvbnMgZm9yIHNwZWNpZmllZCBhZGRyZXNzZXMgdG8gcHVsbCAod2l0aGRyYXcpIHBheW1lbnRzIGZyb20gdGhlIGNvbnRyYWN0IGJhbGFuY2UuCiAqLwoKY29udHJhY3QgV2l0aGRyYXdhYmxlIHsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHBlbmRpbmdXaXRoZHJhd2FsczsKCiAgICAvKgogICAgICogQGRldiBMb2dnZWQgdXBvbiBhIGdyYW50ZWQgYWxsb3dhbmNlIHRvIHRoZSBzcGVjaWZpZWQgZHJhd2VyIG9uIHdpdGhkcmF3YWwuCiAgICAgKiBAcGFyYW0gZHJhd2VyIFRoZSBhZGRyZXNzIG9mIHRoZSBkcmF3ZXIuCiAgICAgKiBAcGFyYW0gd2VpQW1vdW50IFRoZSB2YWx1ZSBpbiBXZWkgd2hpY2ggbWF5IGJlIHdpdGhkcmF3bi4KICAgICAqLwogICAgZXZlbnQgV2l0aGRyYXdhbChhZGRyZXNzIGluZGV4ZWQgZHJhd2VyLCB1aW50MjU2IHdlaUFtb3VudCk7CgogICAgLyoKICAgICAqIEBkZXYgTG9nZ2VkIHVwb24gYSB3aXRoZHJhd24gdmFsdWUuCiAgICAgKiBAcGFyYW0gZHJhd2VyIFRoZSBhZGRyZXNzIG9mIHRoZSBkcmF3ZXIuCiAgICAgKiBAcGFyYW0gd2VpQW1vdW50IFRoZSB2YWx1ZSBpbiBXZWkgd2hpY2ggaGFzIGJlZW4gd2l0aGRyYXduLgogICAgICovCiAgICBldmVudCBXaXRoZHJhd24oYWRkcmVzcyBpbmRleGVkIGRyYXdlciwgdWludDI1NiB3ZWlBbW91bnQpOwoKICAgIC8qCiAgICAgKiBAZGV2IEFsbG93IHRoZSBzcGVjaWZpZWQgZHJhd2VyIHRvIHdpdGhkcmF3IHRoZSBzcGVjaWZpZWQgdmFsdWUgZnJvbSB0aGUgY29udHJhY3QgYmFsYW5jZS4KICAgICAqIEBwYXJhbSBkcmF3ZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGRyYXdlci4KICAgICAqIEBwYXJhbSB3ZWlBbW91bnQgVGhlIHZhbHVlIGluIFdlaSBhbGxvd2VkIHRvIHdpdGhkcmF3LgogICAgICogQHJldHVybiBzdWNjZXNzCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldFdpdGhkcmF3YWwoYWRkcmVzcyBkcmF3ZXIsIHVpbnQyNTYgd2VpQW1vdW50KSBpbnRlcm5hbCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBpZiAoKGRyYXdlciAhPSBhZGRyZXNzKDApKSAmJiAod2VpQW1vdW50ID4gMCkpIHsKICAgICAgICAgICAgdWludDI1NiBvbGRCYWxhbmNlID0gcGVuZGluZ1dpdGhkcmF3YWxzW2RyYXdlcl07CiAgICAgICAgICAgIHVpbnQyNTYgbmV3QmFsYW5jZSA9IG9sZEJhbGFuY2UgKyB3ZWlBbW91bnQ7CiAgICAgICAgICAgIGlmIChuZXdCYWxhbmNlID4gb2xkQmFsYW5jZSkgewogICAgICAgICAgICAgICAgcGVuZGluZ1dpdGhkcmF3YWxzW2RyYXdlcl0gPSBuZXdCYWxhbmNlOwogICAgICAgICAgICAgICAgV2l0aGRyYXdhbChkcmF3ZXIsIHdlaUFtb3VudCk7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyoKICAgICAqIEBkZXYgV2l0aGRyYXcgdGhlIGFsbG93ZWQgdmFsdWUgZnJvbSB0aGUgY29udHJhY3QgYmFsYW5jZS4KICAgICAqIEByZXR1cm4gc3VjY2VzcwogICAgICovCiAgICBmdW5jdGlvbiB3aXRoZHJhdygpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICB1aW50MjU2IHdlaUFtb3VudCA9IHBlbmRpbmdXaXRoZHJhd2Fsc1ttc2cuc2VuZGVyXTsKICAgICAgICByZXF1aXJlKHdlaUFtb3VudCA+IDApOwoKICAgICAgICBwZW5kaW5nV2l0aGRyYXdhbHNbbXNnLnNlbmRlcl0gPSAwOwogICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIod2VpQW1vdW50KTsKICAgICAgICBXaXRoZHJhd24obXNnLnNlbmRlciwgd2VpQW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCn0KCi8qKgogKiBAdGl0bGUgQ29pbnRlZCBUb2tlbgogKiBAZGV2IENvaW50ZWQgVG9rZW4gKENURCkgYW5kIFRva2VuIFNhbGUgKElDTykuCiAqLwoKY29udHJhY3QgQ3RkVG9rZW4gaXMgVXBncmFkYWJsZVRva2VuLCBQYXVzYWJsZU9uY2UsIFdpdGhkcmF3YWJsZSB7CgogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIkNvaW50ZWQgVG9rZW4iOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiQ1REIjsKICAgIC8qKiBOdW1iZXIgb2YgIkF0b20iIGluIDEgQ1REICgxIENURCA9IDF4MTBeZGVjaW1hbHMgQXRvbSkgKi8KICAgIHVpbnQ4ICBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKCiAgICAvKiogSG9sZGVyIG9mIGJvdW50eSB0b2tlbnMgKi8KICAgIGFkZHJlc3MgcHVibGljIGJvdW50eTsKCiAgICAvKiogTGltaXQgKGluIEF0b20pIGlzc3VlZCwgaW5jbHVzaXZlIG93bmVyJ3MgYW5kIGJvdW50eSBzaGFyZXMgKi8KICAgIHVpbnQyNTYgY29uc3RhbnQgaW50ZXJuYWwgVE9UQUxfTElNSVQgICA9IDY1MDAwMDAwMCAqICgxMCAqKiB1aW50MjU2KGRlY2ltYWxzKSk7CiAgICAvKiogTGltaXQgKGluIEF0b20pIGZvciBQcmUtSUNPIFBoYXNlcyBBLCBpbmNsLiBvd25lcidzIGFuZCBib3VudHkgc2hhcmVzICovCiAgICB1aW50MjU2IGNvbnN0YW50IGludGVybmFsIFBSRV9JQ09fTElNSVQgPSAxMzAwMDAwMDAgKiAoMTAgKiogdWludDI1NihkZWNpbWFscykpOwoKICAgIC8qKgogICAgKiBJQ08gUGhhc2VzLgogICAgKgogICAgKiAtIFByZVN0YXJ0OiB0b2tlbnMgYXJlIG5vdCB5ZXQgc29sZC9pc3N1ZWQKICAgICogLSBQcmVJY29BOiAgbmV3IHRva2VucyBzb2xkL2lzc3VlZCBhdCB0aGUgcHJlbWl1bSBwcmljZQogICAgKiAtIFByZUljb0I6ICBuZXcgdG9rZW5zIHNvbGQvaXNzdWVkIGF0IHRoZSBkaXNjb3VudGVkIHByaWNlCiAgICAqIC0gTWFpbkljbyAgIG5ldyB0b2tlbnMgc29sZC9pc3N1ZWQgYXQgdGhlIHJlZ3VsYXIgcHJpY2UKICAgICogLSBBZnRlckljbzogbmV3IHRva2VucyBjYW4gbm90IGJlIG5vdCBiZSBzb2xkL2lzc3VlZCBhbnkgbG9uZ2VyCiAgICAqLwogICAgZW51bSBQaGFzZXMge1ByZVN0YXJ0LCBQcmVJY29BLCBQcmVJY29CLCBNYWluSWNvLCBBZnRlckljb30KCiAgICB1aW50NjQgY29uc3RhbnQgaW50ZXJuYWwgUFJFX0lDT19EVVJBVElPTiA9IDMwIGRheXM7CiAgICB1aW50NjQgY29uc3RhbnQgaW50ZXJuYWwgSUNPX0RVUkFUSU9OID0gODIgZGF5czsKICAgIHVpbnQ2NCBjb25zdGFudCBpbnRlcm5hbCBSRVRVUk5fV0VJX1BBVVNFID0gMzAgZGF5czsKCiAgICAvLyBNYWluIElDTyByYXRlIGluIENURChzKSBwZXIgMSBFVEg6CiAgICB1aW50MjU2IGNvbnN0YW50IGludGVybmFsIFRPX1NFTkRFUl9SQVRFICAgPSAxMDAwOwogICAgdWludDI1NiBjb25zdGFudCBpbnRlcm5hbCBUT19PV05FUl9SQVRFICAgID0gIDI2MzsKICAgIHVpbnQyNTYgY29uc3RhbnQgaW50ZXJuYWwgVE9fQk9VTlRZX1JBVEUgICA9ICAgNTI7CiAgICB1aW50MjU2IGNvbnN0YW50IGludGVybmFsIFRPVEFMX1JBVEUgICA9ICAgVE9fU0VOREVSX1JBVEUgKyBUT19PV05FUl9SQVRFICsgVE9fQk9VTlRZX1JBVEU7CiAgICAvLyBQcmUtSUNPIFBoYXNlIEEgcmF0ZQogICAgdWludDI1NiBjb25zdGFudCBpbnRlcm5hbCBUT19TRU5ERVJfUkFURV9BID0gMTE1MDsKICAgIHVpbnQyNTYgY29uc3RhbnQgaW50ZXJuYWwgVE9fT1dORVJfUkFURV9BICA9ICAzMDQ7CiAgICB1aW50MjU2IGNvbnN0YW50IGludGVybmFsIFRPX0JPVU5UWV9SQVRFX0EgPSAgIDYxOwogICAgdWludDI1NiBjb25zdGFudCBpbnRlcm5hbCBUT1RBTF9SQVRFX0EgICA9ICAgVE9fU0VOREVSX1JBVEVfQSArIFRPX09XTkVSX1JBVEVfQSArIFRPX0JPVU5UWV9SQVRFX0E7CiAgICAvLyBQcmUtSUNPIFBoYXNlIEIgcmF0ZQogICAgdWludDI1NiBjb25zdGFudCBpbnRlcm5hbCBUT19TRU5ERVJfUkFURV9CID0gMTEwMDsKICAgIHVpbnQyNTYgY29uc3RhbnQgaW50ZXJuYWwgVE9fT1dORVJfUkFURV9CICA9ICAyOTI7CiAgICB1aW50MjU2IGNvbnN0YW50IGludGVybmFsIFRPX0JPVU5UWV9SQVRFX0IgPSAgIDU4OwogICAgdWludDI1NiBjb25zdGFudCBpbnRlcm5hbCBUT1RBTF9SQVRFX0IgICA9ICAgVE9fU0VOREVSX1JBVEVfQiArIFRPX09XTkVSX1JBVEVfQiArIFRPX0JPVU5UWV9SQVRFX0I7CgogICAgLy8gQXdhcmQgaW4gV2VpKHMpIHRvIGEgc3VjY2Vzc2Z1bCBpbml0aWF0b3Igb2YgYSBQaGFzZSBzaGlmdAogICAgdWludDI1NiBjb25zdGFudCBpbnRlcm5hbCBQUkVfT1BFTklOR19BV0FSRCA9IDEwMCAqICgxMCAqKiB1aW50MjU2KDE1KSk7CiAgICB1aW50MjU2IGNvbnN0YW50IGludGVybmFsIElDT19PUEVOSU5HX0FXQVJEID0gMjAwICogKDEwICoqIHVpbnQyNTYoMTUpKTsKICAgIHVpbnQyNTYgY29uc3RhbnQgaW50ZXJuYWwgSUNPX0NMT1NJTkdfQVdBUkQgPSA1MDAgKiAoMTAgKiogdWludDI1NigxNSkpOwoKICAgIHN0cnVjdCBSYXRlcyB7CiAgICAgICAgdWludDI1NiB0b1NlbmRlcjsKICAgICAgICB1aW50MjU2IHRvT3duZXI7CiAgICAgICAgdWludDI1NiB0b0JvdW50eTsKICAgICAgICB1aW50MjU2IHRvdGFsOwogICAgfQoKICAgIGV2ZW50IE5ld1Rva2Vucyh1aW50MjU2IGFtb3VudCk7CiAgICBldmVudCBOZXdGdW5kcyhhZGRyZXNzIGZ1bmRlciwgdWludDI1NiB2YWx1ZSk7CiAgICBldmVudCBOZXdQaGFzZShQaGFzZXMgcGhhc2UpOwoKICAgIC8vIGN1cnJlbnQgUGhhc2UKICAgIFBoYXNlcyBwdWJsaWMgcGhhc2UgPSBQaGFzZXMuUHJlU3RhcnQ7CgogICAgLy8gVGltZXN0YW1wcyBsaW1pdGluZyBkdXJhdGlvbiBvZiBQaGFzZXMsIGluIHNlY29uZHMgc2luY2UgVW5peCBlcG9jaC4KICAgIHVpbnQ2NCBwdWJsaWMgcHJlSWNvT3BlbmluZ1RpbWU7ICAvLyB3aGVuIFByZS1JQ08gUGhhc2UgQSBzdGFydHMKICAgIHVpbnQ2NCBwdWJsaWMgaWNvT3BlbmluZ1RpbWU7ICAgICAvLyB3aGVuIE1haW4gSUNPIHN0YXJ0cyAoaWYgbm90IHNvbGQgb3V0IGJlZm9yZSkKICAgIHVpbnQ2NCBwdWJsaWMgY2xvc2luZ1RpbWU7ICAgICAgICAvLyBieSB3aGVuIHRoZSBJQ08gY2FtcGFpZ24gZmluaXNoZXMgaW4gYW55IHdheQogICAgdWludDY0IHB1YmxpYyByZXR1cm5BbGxvd2VkVGltZTsgIC8vIHdoZW4gb3duZXIgbWF5IHdpdGhkcmF3IEV0aCBmcm9tIGNvbnRyYWN0LCBpZiBhbnkKCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFByb2NlZWRzOwoKICAgIC8qCiAgICAgKiBAZGV2IGNvbnN0cnVjdG9yCiAgICAgKiBAcGFyYW0gX3ByZUljb09wZW5pbmdUaW1lIFRpbWVzdGFtcCB3aGVuIHRoZSBQcmUtSUNPIChQaGFzZSBBKSBzaGFsbCBzdGFydC4KICAgICAqIG1zZy52YWx1ZSBNVVNUIGJlIGF0IGxlYXN0IHRoZSBzdW0gb2YgYXdhcmRzLgogICAgICovCiAgICBmdW5jdGlvbiBDdGRUb2tlbih1aW50NjQgX3ByZUljb09wZW5pbmdUaW1lKSBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKF9wcmVJY29PcGVuaW5nVGltZSA+IG5vdyk7CgogICAgICAgIHByZUljb09wZW5pbmdUaW1lID0gX3ByZUljb09wZW5pbmdUaW1lOwogICAgICAgIGljb09wZW5pbmdUaW1lID0gcHJlSWNvT3BlbmluZ1RpbWUgKyBQUkVfSUNPX0RVUkFUSU9OOwogICAgICAgIGNsb3NpbmdUaW1lID0gaWNvT3BlbmluZ1RpbWUgKyBJQ09fRFVSQVRJT047CiAgICB9CgogICAgLyoKICAgICAqIEBkZXYgRmFsbGJhY2sgZnVuY3Rpb24gZGVsZWdhdGVzIHRoZSByZXF1ZXN0IHRvIGNyZWF0ZSgpLgogICAgICovCiAgICBmdW5jdGlvbiAoKSBwYXlhYmxlIGV4dGVybmFsIHsKICAgICAgICBjcmVhdGUoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgU2V0IHRoZSBhZGRyZXNzIG9mIHRoZSBob2xkZXIgb2YgYm91bnR5IHRva2Vucy4KICAgICAqIEBwYXJhbSBfYm91bnR5IFRoZSBhZGRyZXNzIG9mIHRoZSBib3VudHkgdG9rZW4gaG9sZGVyLgogICAgICogQHJldHVybiBzdWNjZXNzL2ZhaWx1cmUKICAgICAqLwogICAgZnVuY3Rpb24gc2V0Qm91bnR5KGFkZHJlc3MgX2JvdW50eSkgb25seU93bmVyIGV4dGVybmFsIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoX2JvdW50eSAhPSBhZGRyZXNzKDApKTsKICAgICAgICBib3VudHkgPSBfYm91bnR5OwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBNaW50IHRva2VucyBhbmQgYWRkIHRoZW0gdG8gdGhlIGJhbGFuY2Ugb2YgdGhlIG1lc3NhZ2Uuc2VuZGVyLgogICAgICogQWRkaXRpb25hbCB0b2tlbnMgYXJlIG1pbnRlZCBhbmQgYWRkZWQgdG8gdGhlIG93bmVyIGFuZCB0aGUgYm91bnR5IGJhbGFuY2VzLgogICAgICogQHJldHVybiBzdWNjZXNzL2ZhaWx1cmUKICAgICAqLwogICAgZnVuY3Rpb24gY3JlYXRlKCkgcGF5YWJsZSB3aGVuTm90Q2xvc2VkIHdoZW5Ob3RQYXVzZWQgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID4gMCk7CiAgICAgICAgcmVxdWlyZShub3cgPj0gcHJlSWNvT3BlbmluZ1RpbWUpOwoKICAgICAgICBQaGFzZXMgb2xkUGhhc2UgPSBwaGFzZTsKICAgICAgICB1aW50MjU2IHdlaVRvUGFydGljaXBhdGUgPSBtc2cudmFsdWU7CiAgICAgICAgdWludDI1NiBvdmVycGFpZFdlaTsKCiAgICAgICAgYWRqdXN0UGhhc2VCYXNlZE9uVGltZSgpOwoKICAgICAgICBpZiAocGhhc2UgIT0gUGhhc2VzLkFmdGVySWNvKSB7CgogICAgICAgICAgICBSYXRlcyBtZW1vcnkgcmF0ZXMgPSBnZXRSYXRlcygpOwogICAgICAgICAgICB1aW50MjU2IG5ld1Rva2VucyA9IHdlaVRvUGFydGljaXBhdGUubXVsKHJhdGVzLnRvdGFsKTsKICAgICAgICAgICAgdWludDI1NiByZXF1ZXN0ZWRTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQobmV3VG9rZW5zKTsKCiAgICAgICAgICAgIHVpbnQyNTYgb3ZlcnNvbGRUb2tlbnMgPSBjb21wdXRlT3ZlcnNvbGRBbmRBZGp1c3RQaGFzZShyZXF1ZXN0ZWRTdXBwbHkpOwogICAgICAgICAgICBvdmVycGFpZFdlaSA9IChvdmVyc29sZFRva2VucyA+IDApID8gb3ZlcnNvbGRUb2tlbnMuZGl2KHJhdGVzLnRvdGFsKSA6IDA7CgogICAgICAgICAgICBpZiAob3ZlcnBhaWRXZWkgPiAwKSB7CiAgICAgICAgICAgICAgICB3ZWlUb1BhcnRpY2lwYXRlID0gbXNnLnZhbHVlLnN1YihvdmVycGFpZFdlaSk7CiAgICAgICAgICAgICAgICBuZXdUb2tlbnMgPSB3ZWlUb1BhcnRpY2lwYXRlLm11bChyYXRlcy50b3RhbCk7CiAgICAgICAgICAgICAgICByZXF1ZXN0ZWRTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQobmV3VG9rZW5zKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gImVtaXNzaW9uIiBvZiBuZXcgdG9rZW5zCiAgICAgICAgICAgIHRvdGFsU3VwcGx5ID0gcmVxdWVzdGVkU3VwcGx5OwogICAgICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLmFkZCh3ZWlUb1BhcnRpY2lwYXRlLm11bChyYXRlcy50b1NlbmRlcikpOwogICAgICAgICAgICBiYWxhbmNlc1tvd25lcl0gPSBiYWxhbmNlc1tvd25lcl0uYWRkKHdlaVRvUGFydGljaXBhdGUubXVsKHJhdGVzLnRvT3duZXIpKTsKICAgICAgICAgICAgYmFsYW5jZXNbYm91bnR5XSA9IGJhbGFuY2VzW2JvdW50eV0uYWRkKHdlaVRvUGFydGljaXBhdGUubXVsKHJhdGVzLnRvQm91bnR5KSk7CgogICAgICAgICAgICAvLyBFVEggdHJhbnNmZXJzCiAgICAgICAgICAgIHRvdGFsUHJvY2VlZHMgPSB0b3RhbFByb2NlZWRzLmFkZCh3ZWlUb1BhcnRpY2lwYXRlKTsKICAgICAgICAgICAgb3duZXIudHJhbnNmZXIod2VpVG9QYXJ0aWNpcGF0ZSk7CiAgICAgICAgICAgIGlmIChvdmVycGFpZFdlaSA+IDApIHsKICAgICAgICAgICAgICAgIHNldFdpdGhkcmF3YWwobXNnLnNlbmRlciwgb3ZlcnBhaWRXZWkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBMb2dnaW5nCiAgICAgICAgICAgIE5ld1Rva2VucyhuZXdUb2tlbnMpOwogICAgICAgICAgICBOZXdGdW5kcyhtc2cuc2VuZGVyLCB3ZWlUb1BhcnRpY2lwYXRlKTsKCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc2V0V2l0aGRyYXdhbChtc2cuc2VuZGVyLCBtc2cudmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHBoYXNlICE9IG9sZFBoYXNlKSB7CiAgICAgICAgICAgIGxvZ1NoaWZ0QW5kQm9va0F3YXJkKCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgU2VuZCB0aGUgdmFsdWUgKGV0aGVycykgdGhhdCB0aGUgY29udHJhY3QgaG9sZHMgdG8gdGhlIG93bmVyIGFkZHJlc3MuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHJldHVybldlaSgpIG9ubHlPd25lciB3aGVuQ2xvc2VkIGFmdGVyV2l0aGRyYXdQYXVzZSBleHRlcm5hbCB7CiAgICAgICAgb3duZXIudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGp1c3RQaGFzZUJhc2VkT25UaW1lKCkgaW50ZXJuYWwgewoKICAgICAgICBpZiAobm93ID49IGNsb3NpbmdUaW1lKSB7CiAgICAgICAgICAgIGlmIChwaGFzZSAhPSBQaGFzZXMuQWZ0ZXJJY28pIHsKICAgICAgICAgICAgICAgIHBoYXNlID0gUGhhc2VzLkFmdGVySWNvOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChub3cgPj0gaWNvT3BlbmluZ1RpbWUpIHsKICAgICAgICAgICAgaWYgKHBoYXNlICE9IFBoYXNlcy5NYWluSWNvKSB7CiAgICAgICAgICAgICAgICBwaGFzZSA9IFBoYXNlcy5NYWluSWNvOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChwaGFzZSA9PSBQaGFzZXMuUHJlU3RhcnQpIHsKICAgICAgICAgICAgc2V0RGVmYXVsdFBhcmFtc0lmTmVlZGVkKCk7CiAgICAgICAgICAgIHBoYXNlID0gUGhhc2VzLlByZUljb0E7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHNldERlZmF1bHRQYXJhbXNJZk5lZWRlZCgpIGludGVybmFsIHsKICAgICAgICBpZiAoYm91bnR5ID09IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgYm91bnR5ID0gb3duZXI7CiAgICAgICAgfQogICAgICAgIGlmICh1cGdyYWRlTWFzdGVyID09IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgdXBncmFkZU1hc3RlciA9IG93bmVyOwogICAgICAgIH0KICAgICAgICBpZiAocGF1c2VNYXN0ZXIgPT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICBwYXVzZU1hc3RlciA9IG93bmVyOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBjb21wdXRlT3ZlcnNvbGRBbmRBZGp1c3RQaGFzZSh1aW50MjU2IG5ld1RvdGFsU3VwcGx5KSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2IG92ZXJzb2xkVG9rZW5zKSB7CgogICAgICAgIGlmICgocGhhc2UgPT0gUGhhc2VzLlByZUljb0EpICYmCiAgICAgICAgICAgIChuZXdUb3RhbFN1cHBseSA+PSBQUkVfSUNPX0xJTUlUKSkgewogICAgICAgICAgICBwaGFzZSA9IFBoYXNlcy5QcmVJY29COwogICAgICAgICAgICBvdmVyc29sZFRva2VucyA9IG5ld1RvdGFsU3VwcGx5LnN1YihQUkVfSUNPX0xJTUlUKTsKCiAgICAgICAgfSBlbHNlIGlmIChuZXdUb3RhbFN1cHBseSA+PSBUT1RBTF9MSU1JVCkgewogICAgICAgICAgICBwaGFzZSA9IFBoYXNlcy5BZnRlckljbzsKICAgICAgICAgICAgb3ZlcnNvbGRUb2tlbnMgPSBuZXdUb3RhbFN1cHBseS5zdWIoVE9UQUxfTElNSVQpOwoKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBvdmVyc29sZFRva2VucyA9IDA7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gb3ZlcnNvbGRUb2tlbnM7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0UmF0ZXMoKSBpbnRlcm5hbCByZXR1cm5zIChSYXRlcyByYXRlcykgewoKICAgICAgICBpZiAocGhhc2UgPT0gUGhhc2VzLlByZUljb0EpIHsKICAgICAgICAgICAgcmF0ZXMudG9TZW5kZXIgPSBUT19TRU5ERVJfUkFURV9BOwogICAgICAgICAgICByYXRlcy50b093bmVyID0gVE9fT1dORVJfUkFURV9BOwogICAgICAgICAgICByYXRlcy50b0JvdW50eSA9IFRPX0JPVU5UWV9SQVRFX0E7CiAgICAgICAgICAgIHJhdGVzLnRvdGFsID0gVE9UQUxfUkFURV9BOwogICAgICAgIH0gZWxzZSBpZiAocGhhc2UgPT0gUGhhc2VzLlByZUljb0IpIHsKICAgICAgICAgICAgcmF0ZXMudG9TZW5kZXIgPSBUT19TRU5ERVJfUkFURV9COwogICAgICAgICAgICByYXRlcy50b093bmVyID0gVE9fT1dORVJfUkFURV9COwogICAgICAgICAgICByYXRlcy50b0JvdW50eSA9IFRPX0JPVU5UWV9SQVRFX0I7CiAgICAgICAgICAgIHJhdGVzLnRvdGFsID0gVE9UQUxfUkFURV9COwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJhdGVzLnRvU2VuZGVyID0gVE9fU0VOREVSX1JBVEU7CiAgICAgICAgICAgIHJhdGVzLnRvT3duZXIgPSBUT19PV05FUl9SQVRFOwogICAgICAgICAgICByYXRlcy50b0JvdW50eSA9IFRPX0JPVU5UWV9SQVRFOwogICAgICAgICAgICByYXRlcy50b3RhbCA9IFRPVEFMX1JBVEU7CiAgICAgICAgfQogICAgICAgIHJldHVybiByYXRlczsKICAgIH0KCiAgICBmdW5jdGlvbiBsb2dTaGlmdEFuZEJvb2tBd2FyZCgpIGludGVybmFsIHsKICAgICAgICB1aW50MjU2IHNoaWZ0QXdhcmQ7CgogICAgICAgIGlmICgocGhhc2UgPT0gUGhhc2VzLlByZUljb0EpIHx8IChwaGFzZSA9PSBQaGFzZXMuUHJlSWNvQikpIHsKICAgICAgICAgICAgc2hpZnRBd2FyZCA9IFBSRV9PUEVOSU5HX0FXQVJEOwoKICAgICAgICB9IGVsc2UgaWYgKHBoYXNlID09IFBoYXNlcy5NYWluSWNvKSB7CiAgICAgICAgICAgIHNoaWZ0QXdhcmQgPSBJQ09fT1BFTklOR19BV0FSRDsKCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc2hpZnRBd2FyZCA9IElDT19DTE9TSU5HX0FXQVJEOwogICAgICAgICAgICByZXR1cm5BbGxvd2VkVGltZSA9IHVpbnQ2NChub3cgKyBSRVRVUk5fV0VJX1BBVVNFKTsKICAgICAgICB9CgogICAgICAgIHNldFdpdGhkcmF3YWwobXNnLnNlbmRlciwgc2hpZnRBd2FyZCk7CiAgICAgICAgTmV3UGhhc2UocGhhc2UpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgdG8gdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQuCiAgICAgKiBAcmV0dXJuIHN1Y2Nlc3MvZmFpbHVyZQogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpCiAgICAgICAgd2hlbk5vdFBhdXNlZCBsaW1pdEZvck93bmVyIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlci4KICAgICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20uCiAgICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8uCiAgICAgKiBAcGFyYW0gX3ZhbHVlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkLgogICAgICogQHJldHVybiBzdWNjZXNzL2ZhaWx1cmUKICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkKICAgICAgICB3aGVuTm90UGF1c2VkIGxpbWl0Rm9yT3duZXIgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFwcHJvdmUgdGhlIHNwZWNpZmllZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgdGhlIG1zZy5zZW5kZXIuCiAgICAgKiBVc2UgImluY3JlYXNlQXBwcm92YWwiIG9yICJkZWNyZWFzZUFwcHJvdmFsIiBmdW5jdGlvbiB0byBjaGFuZ2UgdGhlIGFwcHJvdmFsLCBpZiBuZWVkZWQuCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAgICogQHJldHVybiBzdWNjZXNzL2ZhaWx1cmUKICAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkKICAgICAgICB3aGVuTm90UGF1c2VkIGxpbWl0Rm9yT3duZXIgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICByZXF1aXJlKChfdmFsdWUgPT0gMCkgfHwgKGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID09IDApKTsKICAgICAgICByZXR1cm4gc3VwZXIuYXBwcm92ZShfc3BlbmRlciwgX3ZhbHVlKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgSW5jcmVhc2UgdGhlIGFwcHJvdmFsIGZvciB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdG9rZW5zIG9uIGJlaGFsZiBvZiB0aGUgbXNnLnNlbmRlci4KICAgICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgICAqIEBwYXJhbSBfYWRkZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBpbmNyZWFzZSB0aGUgYXBwcm92YWwgd2l0aC4KICAgICAqIEByZXR1cm4gc3VjY2Vzcy9mYWlsdXJlCiAgICAgKi8KICAgIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkKICAgICAgICB3aGVuTm90UGF1c2VkIGxpbWl0Rm9yT3duZXIgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICByZXR1cm4gc3VwZXIuaW5jcmVhc2VBcHByb3ZhbChfc3BlbmRlciwgX2FkZGVkVmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBEZWNyZWFzZSB0aGUgYXBwcm92YWwgZm9yIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0b2tlbnMgb24gYmVoYWxmIG9mIHRoZSBtc2cuc2VuZGVyLgogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF9zdWJ0cmFjdGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gZGVjcmVhc2UgdGhlIGFwcHJvdmFsIHdpdGguCiAgICAgKiBAcmV0dXJuIHN1Y2Nlc3MvZmFpbHVyZQogICAgICovCiAgICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkKICAgICAgICB3aGVuTm90UGF1c2VkIGxpbWl0Rm9yT3duZXIgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICByZXR1cm4gc3VwZXIuZGVjcmVhc2VBcHByb3ZhbChfc3BlbmRlciwgX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CgogICAgLyoKICAgICAqIEBkZXYgV2l0aGRyYXcgdGhlIGFsbG93ZWQgdmFsdWUgKGV0aGVycykgZnJvbSB0aGUgY29udHJhY3QgYmFsYW5jZS4KICAgICAqIEByZXR1cm4gc3VjY2Vzcy9mYWlsdXJlCiAgICAgKi8KICAgIGZ1bmN0aW9uIHdpdGhkcmF3KCkgd2hlbk5vdFBhdXNlZCBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLndpdGhkcmF3KCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgd2hlbiBJQ08gaXMgYWN0aXZlLgogICAgICovCiAgICBtb2RpZmllciB3aGVuQ2xvc2VkKCkgewogICAgICAgIHJlcXVpcmUocGhhc2UgPT0gUGhhc2VzLkFmdGVySWNvKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIHdoZW4gSUNPIGlzIGNvbXBsZXRlZC4KICAgICAqLwogICAgbW9kaWZpZXIgd2hlbk5vdENsb3NlZCgpIHsKICAgICAgICByZXF1aXJlKHBoYXNlICE9IFBoYXNlcy5BZnRlckljbyk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSB0aGUgb3duZXIgYmVmb3JlIElDTyBpcyBjb21wbGV0ZWQuCiAgICAgKi8KICAgIG1vZGlmaWVyIGxpbWl0Rm9yT3duZXIoKSB7CiAgICAgICAgcmVxdWlyZSgobXNnLnNlbmRlciAhPSBvd25lcikgfHwgKHBoYXNlID09IFBoYXNlcy5BZnRlckljbykpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYmVmb3JlIHJldHVybkFsbG93ZWRUaW1lLgogICAgICovCiAgICBtb2RpZmllciBhZnRlcldpdGhkcmF3UGF1c2UoKSB7CiAgICAgICAgcmVxdWlyZShub3cgPiByZXR1cm5BbGxvd2VkVGltZSk7CiAgICAgICAgXzsKICAgIH0KCn0='.
	

]
