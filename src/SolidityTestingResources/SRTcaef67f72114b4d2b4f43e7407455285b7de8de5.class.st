Class {
	#name : #SRTcaef67f72114b4d2b4f43e7407455285b7de8de5,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTcaef67f72114b4d2b4f43e7407455285b7de8de5 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTY7CgovLyBjb3B5cmlnaHQgPHNwYW4gY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSJlNDg3OGI4YTkwODU4NzkwYTRhMTkwOGM4MTk2ODE4OThiOGFjYTg3OGI4OSI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4KCmNvbnRyYWN0IFNhZmVNYXRoIHsKCiAgICAvKiBmdW5jdGlvbiBhc3NlcnQoYm9vbCBhc3NlcnRpb24pIGludGVybmFsIHsgKi8KICAgIC8qICAgaWYgKCFhc3NlcnRpb24pIHsgKi8KICAgIC8qICAgICB0aHJvdzsgKi8KICAgIC8qICAgfSAqLwogICAgLyogfSAgICAgIC8vIGFzc2VydCBubyBsb25nZXIgbmVlZGVkIG9uY2Ugc29saWRpdHkgaXMgb24gMC40LjEwICovCgogICAgZnVuY3Rpb24gc2FmZUFkZCh1aW50MjU2IHgsIHVpbnQyNTYgeSkgcHVyZSBpbnRlcm5hbCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgdWludDI1NiB6ID0geCArIHk7CiAgICAgIGFzc2VydCgoeiA+PSB4KSAmJiAoeiA+PSB5KSk7CiAgICAgIHJldHVybiB6OwogICAgfQoKICAgIGZ1bmN0aW9uIHNhZmVTdWJ0cmFjdCh1aW50MjU2IHgsIHVpbnQyNTYgeSkgcHVyZSBpbnRlcm5hbCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgYXNzZXJ0KHggPj0geSk7CiAgICAgIHVpbnQyNTYgeiA9IHggLSB5OwogICAgICByZXR1cm4gejsKICAgIH0KCiAgICBmdW5jdGlvbiBzYWZlTXVsdCh1aW50MjU2IHgsIHVpbnQyNTYgeSkgcHVyZSBpbnRlcm5hbCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgdWludDI1NiB6ID0geCAqIHk7CiAgICAgIGFzc2VydCgoeCA9PSAwKXx8KHoveCA9PSB5KSk7CiAgICAgIHJldHVybiB6OwogICAgfQoKfQoKY29udHJhY3QgQmFzaWNBY2Nlc3NDb250cm9sIHsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwogICAgLy8gYWRkcmVzc1tdIHB1YmxpYyBtb2RlcmF0b3JzOwogICAgdWludDE2IHB1YmxpYyB0b3RhbE1vZGVyYXRvcnMgPSAwOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgbW9kZXJhdG9yczsKICAgIGJvb2wgcHVibGljIGlzTWFpbnRhaW5pbmcgPSB0cnVlOwoKICAgIGZ1bmN0aW9uIEJhc2ljQWNjZXNzQ29udHJvbCgpIHB1YmxpYyB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlNb2RlcmF0b3JzKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lciB8fCBtb2RlcmF0b3JzW21zZy5zZW5kZXJdID09IHRydWUpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgaXNBY3RpdmUgewogICAgICAgIHJlcXVpcmUoIWlzTWFpbnRhaW5pbmcpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gQ2hhbmdlT3duZXIoYWRkcmVzcyBfbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGlmIChfbmV3T3duZXIgIT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICBvd25lciA9IF9uZXdPd25lcjsKICAgICAgICB9CiAgICB9CgoKICAgIGZ1bmN0aW9uIEFkZE1vZGVyYXRvcihhZGRyZXNzIF9uZXdNb2RlcmF0b3IpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGlmIChtb2RlcmF0b3JzW19uZXdNb2RlcmF0b3JdID09IGZhbHNlKSB7CiAgICAgICAgICAgIG1vZGVyYXRvcnNbX25ld01vZGVyYXRvcl0gPSB0cnVlOwogICAgICAgICAgICB0b3RhbE1vZGVyYXRvcnMgKz0gMTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIFJlbW92ZU1vZGVyYXRvcihhZGRyZXNzIF9vbGRNb2RlcmF0b3IpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGlmIChtb2RlcmF0b3JzW19vbGRNb2RlcmF0b3JdID09IHRydWUpIHsKICAgICAgICAgICAgbW9kZXJhdG9yc1tfb2xkTW9kZXJhdG9yXSA9IGZhbHNlOwogICAgICAgICAgICB0b3RhbE1vZGVyYXRvcnMgLT0gMTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gVXBkYXRlTWFpbnRhaW5pbmcoYm9vbCBfaXNNYWludGFpbmluZykgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgaXNNYWludGFpbmluZyA9IF9pc01haW50YWluaW5nOwogICAgfQp9Cgpjb250cmFjdCBFdGhlcmVtb25FbnVtIHsKCiAgICBlbnVtIFJlc3VsdENvZGUgewogICAgICAgIFNVQ0NFU1MsCiAgICAgICAgRVJST1JfQ0xBU1NfTk9UX0ZPVU5ELAogICAgICAgIEVSUk9SX0xPV19CQUxBTkNFLAogICAgICAgIEVSUk9SX1NFTkRfRkFJTCwKICAgICAgICBFUlJPUl9OT1RfVFJBSU5FUiwKICAgICAgICBFUlJPUl9OT1RfRU5PVUdIX01PTkVZLAogICAgICAgIEVSUk9SX0lOVkFMSURfQU1PVU5ULAogICAgICAgIEVSUk9SX09CSl9OT1RfRk9VTkQsCiAgICAgICAgRVJST1JfT0JKX0lOVkFMSURfT1dORVJTSElQCiAgICB9CiAgICAKICAgIGVudW0gQXJyYXlUeXBlIHsKICAgICAgICBDTEFTU19UWVBFLAogICAgICAgIFNUQVRfU1RFUCwKICAgICAgICBTVEFUX1NUQVJULAogICAgICAgIFNUQVRfQkFTRSwKICAgICAgICBPQkpfU0tJTEwKICAgIH0KCiAgICBlbnVtIFByb3BlcnR5VHlwZSB7CiAgICAgICAgQU5DRVNUT1IsCiAgICAgICAgWEZBQ1RPUgogICAgfQogICAgCiAgICBlbnVtIEJhdHRsZVJlc3VsdCB7CiAgICAgICAgQ0FTVExFX1dJTiwKICAgICAgICBDQVNUTEVfTE9TRSwKICAgICAgICBDQVNUTEVfREVTVFJPWUVECiAgICB9CiAgICAKICAgIGVudW0gQ2FjaGVDbGFzc0luZm9UeXBlIHsKICAgICAgICBDTEFTU19UWVBFLAogICAgICAgIENMQVNTX1NURVAsCiAgICAgICAgQ0xBU1NfQU5DRVNUT1IKICAgIH0KfQoKY29udHJhY3QgRXRoZXJlbW9uRGF0YUJhc2UgaXMgRXRoZXJlbW9uRW51bSwgQmFzaWNBY2Nlc3NDb250cm9sLCBTYWZlTWF0aCB7CiAgICAKICAgIHVpbnQ2NCBwdWJsaWMgdG90YWxNb25zdGVyOwogICAgdWludDMyIHB1YmxpYyB0b3RhbENsYXNzOwogICAgCiAgICAvLyByZWFkCiAgICBmdW5jdGlvbiBnZXRTaXplQXJyYXlUeXBlKEFycmF5VHlwZSBfdHlwZSwgdWludDY0IF9pZCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludCk7CiAgICBmdW5jdGlvbiBnZXRFbGVtZW50SW5BcnJheVR5cGUoQXJyYXlUeXBlIF90eXBlLCB1aW50NjQgX2lkLCB1aW50IF9pbmRleCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludDgpOwogICAgZnVuY3Rpb24gZ2V0TW9uc3RlckNsYXNzKHVpbnQzMiBfY2xhc3NJZCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludDMyIGNsYXNzSWQsIHVpbnQyNTYgcHJpY2UsIHVpbnQyNTYgcmV0dXJuUHJpY2UsIHVpbnQzMiB0b3RhbCwgYm9vbCBjYXRjaGFibGUpOwogICAgZnVuY3Rpb24gZ2V0TW9uc3Rlck9iaih1aW50NjQgX29iaklkKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyh1aW50NjQgb2JqSWQsIHVpbnQzMiBjbGFzc0lkLCBhZGRyZXNzIHRyYWluZXIsIHVpbnQzMiBleHAsIHVpbnQzMiBjcmVhdGVJbmRleCwgdWludDMyIGxhc3RDbGFpbUluZGV4LCB1aW50IGNyZWF0ZVRpbWUpOwogICAgZnVuY3Rpb24gZ2V0TW9uc3Rlck5hbWUodWludDY0IF9vYmpJZCkgY29uc3RhbnQgcHVibGljIHJldHVybnMoc3RyaW5nIG5hbWUpOwogICAgZnVuY3Rpb24gZ2V0RXh0cmFCYWxhbmNlKGFkZHJlc3MgX3RyYWluZXIpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gZ2V0TW9uc3RlckRleFNpemUoYWRkcmVzcyBfdHJhaW5lcikgY29uc3RhbnQgcHVibGljIHJldHVybnModWludCk7CiAgICBmdW5jdGlvbiBnZXRNb25zdGVyT2JqSWQoYWRkcmVzcyBfdHJhaW5lciwgdWludCBpbmRleCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludDY0KTsKICAgIGZ1bmN0aW9uIGdldEV4cGVjdGVkQmFsYW5jZShhZGRyZXNzIF90cmFpbmVyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGdldE1vbnN0ZXJSZXR1cm4odWludDY0IF9vYmpJZCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludDI1NiBjdXJyZW50LCB1aW50MjU2IHRvdGFsKTsKfQoKY29udHJhY3QgRXRoZXJlbW9uR2F0ZXdheSBpcyBFdGhlcmVtb25FbnVtLCBCYXNpY0FjY2Vzc0NvbnRyb2wgewogICAgLy8gdXNpbmcgZm9yIGJhdHRsZSBjb250cmFjdCBsYXRlcgogICAgZnVuY3Rpb24gaW5jcmVhc2VNb25zdGVyRXhwKHVpbnQ2NCBfb2JqSWQsIHVpbnQzMiBhbW91bnQpIG9ubHlNb2RlcmF0b3JzIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGRlY3JlYXNlTW9uc3RlckV4cCh1aW50NjQgX29iaklkLCB1aW50MzIgYW1vdW50KSBvbmx5TW9kZXJhdG9ycyBwdWJsaWM7CiAgICAKICAgIC8vIHJlYWQgCiAgICBmdW5jdGlvbiBpc0dhc29uKHVpbnQ2NCBfb2JqSWQpIGNvbnN0YW50IGV4dGVybmFsIHJldHVybnMoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRPYmpCYXR0bGVJbmZvKHVpbnQ2NCBfb2JqSWQpIGNvbnN0YW50IGV4dGVybmFsIHJldHVybnModWludDMyIGNsYXNzSWQsIHVpbnQzMiBleHAsIGJvb2wgaXNHYXNvbiwgCiAgICAgICAgdWludCBhbmNlc3Rvckxlbmd0aCwgdWludCB4ZmFjdG9yc0xlbmd0aCk7CiAgICBmdW5jdGlvbiBnZXRDbGFzc1Byb3BlcnR5U2l6ZSh1aW50MzIgX2NsYXNzSWQsIFByb3BlcnR5VHlwZSBfdHlwZSkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyh1aW50KTsKICAgIGZ1bmN0aW9uIGdldENsYXNzUHJvcGVydHlWYWx1ZSh1aW50MzIgX2NsYXNzSWQsIFByb3BlcnR5VHlwZSBfdHlwZSwgdWludCBpbmRleCkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyh1aW50MzIpOwp9Cgpjb250cmFjdCBFdGhlcmVtb25HeW0gaXMgRXRoZXJlbW9uRW51bSwgQmFzaWNBY2Nlc3NDb250cm9sLCBTYWZlTWF0aCB7CiAgICB1aW50OCBjb25zdGFudCBwdWJsaWMgU1RBVF9DT1VOVCA9IDY7CiAgICAKICAgIHN0cnVjdCBNb25zdGVyT2JqQWNjIHsKICAgICAgICB1aW50NjQgbW9uc3RlcklkOwogICAgICAgIHVpbnQzMiBjbGFzc0lkOwogICAgICAgIGFkZHJlc3MgdHJhaW5lcjsKICAgICAgICBzdHJpbmcgbmFtZTsKICAgICAgICB1aW50MzIgZXhwOwogICAgICAgIHVpbnQzMiBjcmVhdGVJbmRleDsKICAgICAgICB1aW50MzIgbGFzdENsYWltSW5kZXg7CiAgICAgICAgdWludCBjcmVhdGVUaW1lOwogICAgfQogICAgCiAgICBzdHJ1Y3QgQXR0YWNrRGF0YSB7CiAgICAgICAgdWludDMyIG9iakNsYXNzSWQ7CiAgICAgICAgYWRkcmVzcyB0cmFpbmVlOwogICAgICAgIHVpbnQ4IG9iakxldmVsOwogICAgICAgIHVpbnQ4IHdpbkNvdW50OwogICAgICAgIHVpbnQzMiB3aW5FeHA7CiAgICAgICAgdWludDMyIGxvc2VFeHA7CiAgICB9CiAgICAKICAgIHN0cnVjdCBIcERhdGEgewogICAgICAgIHVpbnQxNiBhSHBBdHRhY2s7CiAgICAgICAgdWludDE2IGFIcEF0dGFja0NyaXRpY2FsOwogICAgICAgIHVpbnQxNiBiSHBBdHRhY2s7CiAgICAgICAgdWludDE2IGJIcEF0dGFja0NyaXRpY2FsOyAgICAgICAgCiAgICB9CiAgICAKICAgIHN0cnVjdCBHeW1UcmFpbmVyIHsKICAgICAgICB1aW50MzIgY2xhc3NJZDsKICAgICAgICB1aW50OFs2XSBzdGF0QmFzZXM7CiAgICB9CiAgICAKICAgIHN0cnVjdCBUcmFpbmluZ0xvZyB7CiAgICAgICAgdWludDhbM10gdHJhaW5lcnM7CiAgICAgICAgdWludDggdHJhaW5lckxldmVsOwogICAgICAgIHVpbnQ2NCBvYmpJZDsKICAgICAgICB1aW50OCBvYmpMZXZlbDsKICAgICAgICB1aW50OCByYW47CiAgICB9CiAgICAKICAgIHN0cnVjdCBDYWNoZUNsYXNzSW5mbyB7CiAgICAgICAgdWludDhbXSB0eXBlczsKICAgICAgICB1aW50OFtdIHN0ZXBzOwogICAgICAgIHVpbnQzMltdIGFuY2VzdG9yczsKICAgIH0KICAgIAogICAgbWFwcGluZyh1aW50OCA9PiBHeW1UcmFpbmVyKSBwdWJsaWMgZ3ltVHJhaW5lcnM7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gVHJhaW5pbmdMb2cpIHB1YmxpYyB0cmFpbmVlczsKICAgIG1hcHBpbmcodWludDggPT4gdWludDgpIHR5cGVBZHZhbnRhZ2VzOwogICAgbWFwcGluZyh1aW50MzIgPT4gQ2FjaGVDbGFzc0luZm8pIGNhY2hlQ2xhc3NlczsKICAgIG1hcHBpbmcodWludDggPT4gdWludDMyKSBsZXZlbEV4cHM7CiAgICBtYXBwaW5nKHVpbnQ4ID0+IHVpbnQzMikgbGV2ZWxFeHBHYWluczsKICAgIHVpbnQyNTYgcHVibGljIGd5bUZlZSA9IDAuMDAxIGV0aGVyOwogICAgdWludDggcHVibGljIG1heFRyYWluZXJMZXZlbCA9IDU7CiAgICB1aW50OCBwdWJsaWMgdG90YWxUcmFpbmVyID0gMDsKICAgIHVpbnQ4IHB1YmxpYyBtYXhSYW5kb21Sb3VuZCA9IDQ7CiAgICB1aW50OCBwdWJsaWMgdHlwZUJ1ZmZQZXJjZW50YWdlID0gMjA7CiAgICB1aW50OCBwdWJsaWMgbWluSHBEZWR1Y3RlZCA9IDEwOwogICAgdWludDggcHVibGljIGV4cFBlcmNlbnRhZ2UgPSA3MDsKICAgIAogICAgLy8gY29udHJhY3QKICAgIGFkZHJlc3MgcHVibGljIHdvcmxkQ29udHJhY3Q7CiAgICBhZGRyZXNzIHB1YmxpYyBkYXRhQ29udHJhY3Q7CgogICAvLyBtb2RpZmllcgogICAgbW9kaWZpZXIgcmVxdWlyZURhdGFDb250cmFjdCB7CiAgICAgICAgcmVxdWlyZShkYXRhQ29udHJhY3QgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgbW9kaWZpZXIgcmVxdWlyZVdvcmxkQ29udHJhY3QgewogICAgICAgIHJlcXVpcmUod29ybGRDb250cmFjdCAhPSBhZGRyZXNzKDApKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICAvLyBjb25zdHJ1Y3RvcgogICAgZnVuY3Rpb24gRXRoZXJlbW9uR3ltKGFkZHJlc3MgX2RhdGFDb250cmFjdCwgYWRkcmVzcyBfd29ybGRDb250cmFjdCkgcHVibGljIHsKICAgICAgICBkYXRhQ29udHJhY3QgPSBfZGF0YUNvbnRyYWN0OwogICAgICAgIHdvcmxkQ29udHJhY3QgPSBfd29ybGRDb250cmFjdDsKICAgIH0KICAgIAogICAgCiAgICAgLy8gYWRtaW4gJiBtb2RlcmF0b3JzCiAgICBmdW5jdGlvbiBzZXRUeXBlQWR2YW50YWdlcygpIG9ubHlNb2RlcmF0b3JzIGV4dGVybmFsIHsKICAgICAgICB0eXBlQWR2YW50YWdlc1sxXSA9IDE0OwogICAgICAgIHR5cGVBZHZhbnRhZ2VzWzJdID0gMTY7CiAgICAgICAgdHlwZUFkdmFudGFnZXNbM10gPSA4OwogICAgICAgIHR5cGVBZHZhbnRhZ2VzWzRdID0gOTsKICAgICAgICB0eXBlQWR2YW50YWdlc1s1XSA9IDI7CiAgICAgICAgdHlwZUFkdmFudGFnZXNbNl0gPSAxMTsKICAgICAgICB0eXBlQWR2YW50YWdlc1s3XSA9IDM7CiAgICAgICAgdHlwZUFkdmFudGFnZXNbOF0gPSA1OwogICAgICAgIHR5cGVBZHZhbnRhZ2VzWzldID0gMTU7CiAgICAgICAgdHlwZUFkdmFudGFnZXNbMTFdID0gMTg7CiAgICAgICAgLy8gc2tpcHAgMTAKICAgICAgICB0eXBlQWR2YW50YWdlc1sxMl0gPSA3OwogICAgICAgIHR5cGVBZHZhbnRhZ2VzWzEzXSA9IDY7CiAgICAgICAgdHlwZUFkdmFudGFnZXNbMTRdID0gMTc7CiAgICAgICAgdHlwZUFkdmFudGFnZXNbMTVdID0gMTM7CiAgICAgICAgdHlwZUFkdmFudGFnZXNbMTZdID0gMTI7CiAgICAgICAgdHlwZUFkdmFudGFnZXNbMTddID0gMTsKICAgICAgICB0eXBlQWR2YW50YWdlc1sxOF0gPSA0OwogICAgfQogICAgCiAgICBmdW5jdGlvbiBzZXRUeXBlQWR2YW50YWdlKHVpbnQ4IF90eXBlMSwgdWludDggX3R5cGUyKSBvbmx5TW9kZXJhdG9ycyBleHRlcm5hbCB7CiAgICAgICAgdHlwZUFkdmFudGFnZXNbX3R5cGUxXSA9IF90eXBlMjsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gc2V0Q2FjaGVDbGFzc0luZm8odWludDMyIF9jbGFzc0lkKSBvbmx5TW9kZXJhdG9ycyByZXF1aXJlRGF0YUNvbnRyYWN0IHJlcXVpcmVXb3JsZENvbnRyYWN0IHB1YmxpYyB7CiAgICAgICAgRXRoZXJlbW9uRGF0YUJhc2UgZGF0YSA9IEV0aGVyZW1vbkRhdGFCYXNlKGRhdGFDb250cmFjdCk7CiAgICAgICAgIEV0aGVyZW1vbkdhdGV3YXkgZ2F0ZXdheSA9IEV0aGVyZW1vbkdhdGV3YXkod29ybGRDb250cmFjdCk7CiAgICAgICAgdWludCBpID0gMDsKICAgICAgICBDYWNoZUNsYXNzSW5mbyBzdG9yYWdlIGNsYXNzSW5mbyA9IGNhY2hlQ2xhc3Nlc1tfY2xhc3NJZF07CgogICAgICAgIC8vIGFkZCB0eXBlCiAgICAgICAgaSA9IGRhdGEuZ2V0U2l6ZUFycmF5VHlwZShBcnJheVR5cGUuQ0xBU1NfVFlQRSwgdWludDY0KF9jbGFzc0lkKSk7CiAgICAgICAgdWludDhbXSBtZW1vcnkgYVR5cGVzID0gbmV3IHVpbnQ4W10oaSk7CiAgICAgICAgZm9yKDsgaSA+IDAgOyBpLS0pIHsKICAgICAgICAgICAgYVR5cGVzW2ktMV0gPSBkYXRhLmdldEVsZW1lbnRJbkFycmF5VHlwZShBcnJheVR5cGUuQ0xBU1NfVFlQRSwgdWludDY0KF9jbGFzc0lkKSwgaS0xKTsKICAgICAgICB9CiAgICAgICAgY2xhc3NJbmZvLnR5cGVzID0gYVR5cGVzOwoKICAgICAgICAvLyBhZGQgc3RlcHMKICAgICAgICBpID0gZGF0YS5nZXRTaXplQXJyYXlUeXBlKEFycmF5VHlwZS5TVEFUX1NURVAsIHVpbnQ2NChfY2xhc3NJZCkpOwogICAgICAgIHVpbnQ4W10gbWVtb3J5IHN0ZXBzID0gbmV3IHVpbnQ4W10oaSk7CiAgICAgICAgZm9yKDsgaSA+IDAgOyBpLS0pIHsKICAgICAgICAgICAgc3RlcHNbaS0xXSA9IGRhdGEuZ2V0RWxlbWVudEluQXJyYXlUeXBlKEFycmF5VHlwZS5TVEFUX1NURVAsIHVpbnQ2NChfY2xhc3NJZCksIGktMSk7CiAgICAgICAgfQogICAgICAgIGNsYXNzSW5mby5zdGVwcyA9IHN0ZXBzOwogICAgICAgIAogICAgICAgIC8vIGFkZCBhbmNlc3RvcgogICAgICAgIGkgPSBnYXRld2F5LmdldENsYXNzUHJvcGVydHlTaXplKF9jbGFzc0lkLCBQcm9wZXJ0eVR5cGUuQU5DRVNUT1IpOwogICAgICAgIHVpbnQzMltdIG1lbW9yeSBhbmNlc3RvcnMgPSBuZXcgdWludDMyW10oaSk7CiAgICAgICAgZm9yKDsgaSA+IDAgOyBpLS0pIHsKICAgICAgICAgICAgYW5jZXN0b3JzW2ktMV0gPSBnYXRld2F5LmdldENsYXNzUHJvcGVydHlWYWx1ZShfY2xhc3NJZCwgUHJvcGVydHlUeXBlLkFOQ0VTVE9SLCBpLTEpOwogICAgICAgIH0KICAgICAgICBjbGFzc0luZm8uYW5jZXN0b3JzID0gYW5jZXN0b3JzOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBmYXN0U2V0Q2FjaGVDbGFzc0luZm8odWludDMyIF9jbGFzc0lkMSwgdWludDMyIF9jbGFzc0lkMiwgdWludDMyIF9jbGFzc0lkMywgdWludDMyIF9jbGFzc0lkNCkgb25seU1vZGVyYXRvcnMgcmVxdWlyZURhdGFDb250cmFjdCByZXF1aXJlV29ybGRDb250cmFjdCBleHRlcm5hbCB7CiAgICAgICAgc2V0Q2FjaGVDbGFzc0luZm8oX2NsYXNzSWQxKTsKICAgICAgICBzZXRDYWNoZUNsYXNzSW5mbyhfY2xhc3NJZDIpOwogICAgICAgIHNldENhY2hlQ2xhc3NJbmZvKF9jbGFzc0lkMyk7CiAgICAgICAgc2V0Q2FjaGVDbGFzc0luZm8oX2NsYXNzSWQ0KTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gcHJlc2V0R3ltVHJhaW5lcigpIG9ubHlNb2RlcmF0b3JzIGV4dGVybmFsIHsKICAgICAgICBHeW1UcmFpbmVyIHN0b3JhZ2UgdHJhaW5lcjEgPSBneW1UcmFpbmVyc1sxXTsKICAgICAgICB0cmFpbmVyMS5jbGFzc0lkID0gMTI7CiAgICAgICAgdHJhaW5lcjEuc3RhdEJhc2VzWzBdID0gODU7CiAgICAgICAgdHJhaW5lcjEuc3RhdEJhc2VzWzFdID0gOTU7CiAgICAgICAgdHJhaW5lcjEuc3RhdEJhc2VzWzJdID0gNjU7CiAgICAgICAgdHJhaW5lcjEuc3RhdEJhc2VzWzNdID0gNTA7CiAgICAgICAgdHJhaW5lcjEuc3RhdEJhc2VzWzRdID0gNTA7CiAgICAgICAgdHJhaW5lcjEuc3RhdEJhc2VzWzVdID0gNTA7CiAgICAgICAgR3ltVHJhaW5lciBzdG9yYWdlIHRyYWluZXIyID0gZ3ltVHJhaW5lcnNbMl07CiAgICAgICAgdHJhaW5lcjIuY2xhc3NJZCA9IDE1OwogICAgICAgIHRyYWluZXIyLnN0YXRCYXNlc1swXSA9IDUwOwogICAgICAgIHRyYWluZXIyLnN0YXRCYXNlc1sxXSA9IDU1OwogICAgICAgIHRyYWluZXIyLnN0YXRCYXNlc1syXSA9IDg1OwogICAgICAgIHRyYWluZXIyLnN0YXRCYXNlc1szXSA9IDg1OwogICAgICAgIHRyYWluZXIyLnN0YXRCYXNlc1s0XSA9IDQwOwogICAgICAgIHRyYWluZXIyLnN0YXRCYXNlc1s1XSA9IDc1OwogICAgICAgIEd5bVRyYWluZXIgc3RvcmFnZSB0cmFpbmVyMyA9IGd5bVRyYWluZXJzWzNdOwogICAgICAgIHRyYWluZXIzLmNsYXNzSWQgPSA4OwogICAgICAgIHRyYWluZXIzLnN0YXRCYXNlc1swXSA9IDExMDsKICAgICAgICB0cmFpbmVyMy5zdGF0QmFzZXNbMV0gPSA2MDsKICAgICAgICB0cmFpbmVyMy5zdGF0QmFzZXNbMl0gPSA0MDsKICAgICAgICB0cmFpbmVyMy5zdGF0QmFzZXNbM10gPSA2MDsKICAgICAgICB0cmFpbmVyMy5zdGF0QmFzZXNbNF0gPSA0MDsKICAgICAgICB0cmFpbmVyMy5zdGF0QmFzZXNbNV0gPSA0MDsKICAgICAgICBHeW1UcmFpbmVyIHN0b3JhZ2UgdHJhaW5lcjQgPSBneW1UcmFpbmVyc1s0XTsKICAgICAgICB0cmFpbmVyNC5jbGFzc0lkID0gNDsKICAgICAgICB0cmFpbmVyNC5zdGF0QmFzZXNbMF0gPSA1NDsKICAgICAgICB0cmFpbmVyNC5zdGF0QmFzZXNbMV0gPSA2OTsKICAgICAgICB0cmFpbmVyNC5zdGF0QmFzZXNbMl0gPSA1ODsKICAgICAgICB0cmFpbmVyNC5zdGF0QmFzZXNbM10gPSA3NTsKICAgICAgICB0cmFpbmVyNC5zdGF0QmFzZXNbNF0gPSA3NTsKICAgICAgICB0cmFpbmVyNC5zdGF0QmFzZXNbNV0gPSA3MDsKICAgICAgICBHeW1UcmFpbmVyIHN0b3JhZ2UgdHJhaW5lcjUgPSBneW1UcmFpbmVyc1s1XTsKICAgICAgICB0cmFpbmVyNS5jbGFzc0lkID0gNjsKICAgICAgICB0cmFpbmVyNS5zdGF0QmFzZXNbMF0gPSA1MDsKICAgICAgICB0cmFpbmVyNS5zdGF0QmFzZXNbMV0gPSA1MDsKICAgICAgICB0cmFpbmVyNS5zdGF0QmFzZXNbMl0gPSA1MDsKICAgICAgICB0cmFpbmVyNS5zdGF0QmFzZXNbM10gPSAxMDU7CiAgICAgICAgdHJhaW5lcjUuc3RhdEJhc2VzWzRdID0gNTU7CiAgICAgICAgdHJhaW5lcjUuc3RhdEJhc2VzWzVdID0gOTU7CiAgICAgICAgR3ltVHJhaW5lciBzdG9yYWdlIHRyYWluZXI2ID0gZ3ltVHJhaW5lcnNbNl07CiAgICAgICAgdHJhaW5lcjYuY2xhc3NJZCA9IDEzOwogICAgICAgIHRyYWluZXI2LnN0YXRCYXNlc1swXSA9IDU1OwogICAgICAgIHRyYWluZXI2LnN0YXRCYXNlc1sxXSA9IDkwOwogICAgICAgIHRyYWluZXI2LnN0YXRCYXNlc1syXSA9IDk1OwogICAgICAgIHRyYWluZXI2LnN0YXRCYXNlc1szXSA9IDQ1OwogICAgICAgIHRyYWluZXI2LnN0YXRCYXNlc1s0XSA9IDM1OwogICAgICAgIHRyYWluZXI2LnN0YXRCYXNlc1s1XSA9IDM1OwogICAgICAgIEd5bVRyYWluZXIgc3RvcmFnZSB0cmFpbmVyNyA9IGd5bVRyYWluZXJzWzddOwogICAgICAgIHRyYWluZXI3LmNsYXNzSWQgPSA3OwogICAgICAgIHRyYWluZXI3LnN0YXRCYXNlc1swXSA9IDg1OwogICAgICAgIHRyYWluZXI3LnN0YXRCYXNlc1sxXSA9IDYwOwogICAgICAgIHRyYWluZXI3LnN0YXRCYXNlc1syXSA9IDczOwogICAgICAgIHRyYWluZXI3LnN0YXRCYXNlc1szXSA9IDc1OwogICAgICAgIHRyYWluZXI3LnN0YXRCYXNlc1s0XSA9IDgwOwogICAgICAgIHRyYWluZXI3LnN0YXRCYXNlc1s1XSA9IDUwOwogICAgICAgIEd5bVRyYWluZXIgc3RvcmFnZSB0cmFpbmVyOCA9IGd5bVRyYWluZXJzWzhdOwogICAgICAgIHRyYWluZXI4LmNsYXNzSWQgPSAyNDsKICAgICAgICB0cmFpbmVyOC5zdGF0QmFzZXNbMF0gPSAxNDA7CiAgICAgICAgdHJhaW5lcjguc3RhdEJhc2VzWzFdID0gMTM1OwogICAgICAgIHRyYWluZXI4LnN0YXRCYXNlc1syXSA9IDcwOwogICAgICAgIHRyYWluZXI4LnN0YXRCYXNlc1szXSA9IDc3OwogICAgICAgIHRyYWluZXI4LnN0YXRCYXNlc1s0XSA9IDkwOwogICAgICAgIHRyYWluZXI4LnN0YXRCYXNlc1s1XSA9IDUwOwogICAgICAgIEd5bVRyYWluZXIgc3RvcmFnZSB0cmFpbmVyOSA9IGd5bVRyYWluZXJzWzldOwogICAgICAgIHRyYWluZXI5LmNsYXNzSWQgPSAxNjsKICAgICAgICB0cmFpbmVyOS5zdGF0QmFzZXNbMF0gPSA3MDsKICAgICAgICB0cmFpbmVyOS5zdGF0QmFzZXNbMV0gPSAxMDU7CiAgICAgICAgdHJhaW5lcjkuc3RhdEJhc2VzWzJdID0gODA7CiAgICAgICAgdHJhaW5lcjkuc3RhdEJhc2VzWzNdID0gNjA7CiAgICAgICAgdHJhaW5lcjkuc3RhdEJhc2VzWzRdID0gODA7CiAgICAgICAgdHJhaW5lcjkuc3RhdEJhc2VzWzVdID0gOTA7CiAgICAgICAgdG90YWxUcmFpbmVyID0gOTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gc2V0R3ltVHJhaW5lcih1aW50OCBfdHJhaW5lcklkLCB1aW50MzIgX2NsYXNzSWQsIHVpbnQ4IF9zMCwgdWludDggX3MxLCB1aW50OCBfczIsIHVpbnQ4IF9zMywgdWludDggX3M0LCB1aW50OCBfczUpIG9ubHlNb2RlcmF0b3JzIGV4dGVybmFsIHsKICAgICAgICBHeW1UcmFpbmVyIHN0b3JhZ2UgdHJhaW5lciA9IGd5bVRyYWluZXJzW190cmFpbmVySWRdOwogICAgICAgIGlmICh0cmFpbmVyLmNsYXNzSWQgPT0gMCkKICAgICAgICAgICAgdG90YWxUcmFpbmVyICs9IDE7CiAgICAgICAgdHJhaW5lci5jbGFzc0lkID0gX2NsYXNzSWQ7CiAgICAgICAgdHJhaW5lci5zdGF0QmFzZXNbMF0gPSBfczA7CiAgICAgICAgdHJhaW5lci5zdGF0QmFzZXNbMV0gPSBfczE7CiAgICAgICAgdHJhaW5lci5zdGF0QmFzZXNbMl0gPSBfczI7CiAgICAgICAgdHJhaW5lci5zdGF0QmFzZXNbM10gPSBfczM7CiAgICAgICAgdHJhaW5lci5zdGF0QmFzZXNbNF0gPSBfczQ7CiAgICAgICAgdHJhaW5lci5zdGF0QmFzZXNbNV0gPSBfczU7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHNldENvbnRyYWN0KGFkZHJlc3MgX2RhdGFDb250cmFjdCwgYWRkcmVzcyBfd29ybGRDb250cmFjdCkgb25seU1vZGVyYXRvcnMgZXh0ZXJuYWwgewogICAgICAgIGRhdGFDb250cmFjdCA9IF9kYXRhQ29udHJhY3Q7CiAgICAgICAgd29ybGRDb250cmFjdCA9IF93b3JsZENvbnRyYWN0OwogICAgfQogICAgCiAgICBmdW5jdGlvbiBzZXRDb25maWcodWludDI1NiBfZ3ltRmVlLCB1aW50OCBfbWF4VHJhaW5lckxldmVsLCB1aW50OCBfbWF4UmFuZG9tUm91bmQsIHVpbnQ4IF90eXBlQnVmZlBlcmNlbnRhZ2UsIAogICAgICAgIHVpbnQ4IF9taW5IcERlZHVjdGVkLCB1aW50OCBfZXhwUGVyY2VudGFnZSkgb25seU1vZGVyYXRvcnMgZXh0ZXJuYWwgewogICAgICAgIGd5bUZlZSA9IF9neW1GZWU7CiAgICAgICAgbWF4VHJhaW5lckxldmVsID0gX21heFRyYWluZXJMZXZlbDsKICAgICAgICBtYXhSYW5kb21Sb3VuZCA9IF9tYXhSYW5kb21Sb3VuZDsKICAgICAgICB0eXBlQnVmZlBlcmNlbnRhZ2UgPSBfdHlwZUJ1ZmZQZXJjZW50YWdlOwogICAgICAgIG1pbkhwRGVkdWN0ZWQgPSBfbWluSHBEZWR1Y3RlZDsKICAgICAgICBleHBQZXJjZW50YWdlID0gX2V4cFBlcmNlbnRhZ2U7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdlbkxldmVsRXhwKCkgb25seU1vZGVyYXRvcnMgZXh0ZXJuYWwgewogICAgICAgIHVpbnQ4IGxldmVsID0gMTsKICAgICAgICB1aW50MzIgcmVxdWlyZW1lbnQgPSAxMDA7CiAgICAgICAgdWludDMyIHN1bSA9IHJlcXVpcmVtZW50OwogICAgICAgIHdoaWxlKGxldmVsIDw9IDEwMCkgewogICAgICAgICAgICBsZXZlbEV4cHNbbGV2ZWxdID0gc3VtOwogICAgICAgICAgICBsZXZlbCArPSAxOwogICAgICAgICAgICByZXF1aXJlbWVudCA9IChyZXF1aXJlbWVudCAqIDExKSAvIDEwICsgNTsKICAgICAgICAgICAgc3VtICs9IHJlcXVpcmVtZW50OwogICAgICAgIH0KICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2VuTGV2ZWxFeHBHYWluKCkgb25seU1vZGVyYXRvcnMgZXh0ZXJuYWwgewogICAgICAgIGxldmVsRXhwR2FpbnNbMV0gPSAzMTsKICAgICAgICBsZXZlbEV4cEdhaW5zWzJdID0gMzM7CiAgICAgICAgbGV2ZWxFeHBHYWluc1szXSA9IDM0OwogICAgICAgIGxldmVsRXhwR2FpbnNbNF0gPSAzNjsKICAgICAgICBsZXZlbEV4cEdhaW5zWzVdID0gMzg7CiAgICAgICAgbGV2ZWxFeHBHYWluc1s2XSA9IDQwOwogICAgICAgIGxldmVsRXhwR2FpbnNbN10gPSA0MjsKICAgICAgICBsZXZlbEV4cEdhaW5zWzhdID0gNDQ7CiAgICAgICAgbGV2ZWxFeHBHYWluc1s5XSA9IDQ2OwogICAgICAgIGxldmVsRXhwR2FpbnNbMTBdID0gNDg7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHNldExldmVsRXhwR2Fpbih1aW50OCBfbGV2ZWwsIHVpbnQzMiBfZXhwKSBvbmx5TW9kZXJhdG9ycyBleHRlcm5hbCB7CiAgICAgICAgbGV2ZWxFeHBHYWluc1tfbGV2ZWxdID0gX2V4cDsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gd2l0aGRyYXdFdGhlcihhZGRyZXNzIF9zZW5kVG8sIHVpbnQgX2Ftb3VudCkgb25seU1vZGVyYXRvcnMgZXh0ZXJuYWwgewogICAgICAgIGlmIChfYW1vdW50ID4gdGhpcy5iYWxhbmNlKSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KICAgICAgICBfc2VuZFRvLnRyYW5zZmVyKF9hbW91bnQpOwogICAgfQogICAgCiAgICAvLyBwdWJsaWMKICAgIGZ1bmN0aW9uIGdldENhY2hlQ2xhc3NTaXplKHVpbnQzMiBfY2xhc3NJZCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludCwgdWludCwgdWludCkgewogICAgICAgIENhY2hlQ2xhc3NJbmZvIHN0b3JhZ2UgY2xhc3NJbmZvID0gY2FjaGVDbGFzc2VzW19jbGFzc0lkXTsKICAgICAgICByZXR1cm4gKGNsYXNzSW5mby50eXBlcy5sZW5ndGgsIGNsYXNzSW5mby5zdGVwcy5sZW5ndGgsIGNsYXNzSW5mby5hbmNlc3RvcnMubGVuZ3RoKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0VHJhaW5lckluZm8odWludDggX3RyYWluZXJJZCkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyh1aW50MzIsIHVpbnQ4LCB1aW50OCwgdWludDgsIHVpbnQ4LCB1aW50OCwgdWludDgpIHsKICAgICAgICBHeW1UcmFpbmVyIG1lbW9yeSB0cmFpbmVyID0gZ3ltVHJhaW5lcnNbX3RyYWluZXJJZF07CiAgICAgICAgcmV0dXJuICh0cmFpbmVyLmNsYXNzSWQsIHRyYWluZXIuc3RhdEJhc2VzWzBdLCB0cmFpbmVyLnN0YXRCYXNlc1sxXSwgdHJhaW5lci5zdGF0QmFzZXNbMl0sIHRyYWluZXIuc3RhdEJhc2VzWzNdLAogICAgICAgICAgICB0cmFpbmVyLnN0YXRCYXNlc1s0XSwgdHJhaW5lci5zdGF0QmFzZXNbNV0pOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRSYW5kb20odWludDggbWF4UmFuLCB1aW50OCBpbmRleCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludDgpIHsKICAgICAgICB1aW50MjU2IGdlbk51bSA9IHVpbnQyNTYoYmxvY2suYmxvY2toYXNoKGJsb2NrLm51bWJlci0xKSk7CiAgICAgICAgZm9yICh1aW50OCBpID0gMDsgaSA8IGluZGV4ICYmIGkgPCA2OyBpICsrKSB7CiAgICAgICAgICAgIGdlbk51bSAvPSAyNTY7CiAgICAgICAgfQogICAgICAgIHJldHVybiB1aW50OChnZW5OdW0gJSBtYXhSYW4pOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRMZXZlbCh1aW50MzIgZXhwKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50OCkgewogICAgICAgIHVpbnQ4IG1pbkluZGV4ID0gMTsKICAgICAgICB1aW50OCBtYXhJbmRleCA9IDEwMDsKICAgICAgICB1aW50OCBjdXJyZW50SW5kZXg7CiAgICAgCiAgICAgICAgd2hpbGUgKG1pbkluZGV4IDwgbWF4SW5kZXgpIHsKICAgICAgICAgICAgY3VycmVudEluZGV4ID0gKG1pbkluZGV4ICsgbWF4SW5kZXgpIC8gMjsKICAgICAgICAgICAgaWYgKGV4cCA8IGxldmVsRXhwc1tjdXJyZW50SW5kZXhdKQogICAgICAgICAgICAgICAgbWF4SW5kZXggPSBjdXJyZW50SW5kZXg7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIG1pbkluZGV4ID0gY3VycmVudEluZGV4ICsgMTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG1pbkluZGV4OwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRHYWluRXhwKHVpbnQ4IHhMZXZlbCwgdWludDggeUxldmVsKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyh1aW50MzIgd2luRXhwLCB1aW50MzIgbG9zZUV4cCl7CiAgICAgICAgd2luRXhwID0gbGV2ZWxFeHBHYWluc1t5TGV2ZWxdICogZXhwUGVyY2VudGFnZSAvIDEwMDsKICAgICAgICBpZiAoeExldmVsID4geUxldmVsKSB7CiAgICAgICAgICAgIGlmICh4TGV2ZWwgPiB5TGV2ZWwgKyAxMCkgewogICAgICAgICAgICAgICAgd2luRXhwID0gNTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHdpbkV4cCAvPSB1aW50MzIoMykgKiogKHhMZXZlbCAtIHlMZXZlbCkgLyB1aW50MzIoMikgKiogKHhMZXZlbCAtIHlMZXZlbCk7CiAgICAgICAgICAgICAgICBpZiAod2luRXhwIDwgNSkKICAgICAgICAgICAgICAgICAgICB3aW5FeHAgPSA1OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGxvc2VFeHAgPSB3aW5FeHAgLyAzOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBzYWZlRGVkdWN0KHVpbnQxNiBhLCB1aW50MTYgYikgcHVyZSBwcml2YXRlIHJldHVybnModWludDE2KXsKICAgICAgICBpZiAoYSA+IGIpIHsKICAgICAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgICAgIH0KICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0VHlwZVN1cHBvcnQodWludDMyIF9hQ2xhc3NJZCwgdWludDMyIF9iQ2xhc3NJZCkgY29uc3RhbnQgcHJpdmF0ZSByZXR1cm5zIChib29sIGFIYXNBZHZhbnRhZ2UsIGJvb2wgYkhhc0FkdmFudGFnZSkgewogICAgICAgIC8vIGNoZWNrIHR5cGVzIAogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IGNhY2hlQ2xhc3Nlc1tfYUNsYXNzSWRdLnR5cGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGZvciAodWludCBqID0gMDsgaiA8IGNhY2hlQ2xhc3Nlc1tfYkNsYXNzSWRdLnR5cGVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICBpZiAodHlwZUFkdmFudGFnZXNbY2FjaGVDbGFzc2VzW19hQ2xhc3NJZF0udHlwZXNbaV1dID09IGNhY2hlQ2xhc3Nlc1tfYkNsYXNzSWRdLnR5cGVzW2pdKSB7CiAgICAgICAgICAgICAgICAgICAgYUhhc0FkdmFudGFnZSA9IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAodHlwZUFkdmFudGFnZXNbY2FjaGVDbGFzc2VzW19iQ2xhc3NJZF0udHlwZXNbal1dID09IGNhY2hlQ2xhc3Nlc1tfYUNsYXNzSWRdLnR5cGVzW2ldKSB7CiAgICAgICAgICAgICAgICAgICAgYkhhc0FkdmFudGFnZSA9IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNhbEhwRGVkdWN0ZWQodWludDE2IF9hdHRhY2ssIHVpbnQxNiBfc3BlY2lhbEF0dGFjaywgdWludDE2IF9kZWZlbnNlLCB1aW50MTYgX3NwZWNpYWxEZWZlbnNlLCBib29sIF9sdWNreSkgdmlldyBwdWJsaWMgcmV0dXJucyh1aW50MTYpewogICAgICAgIGlmIChfbHVja3kpIHsKICAgICAgICAgICAgX2F0dGFjayA9IF9hdHRhY2sgKiAxMyAvIDEwOwogICAgICAgICAgICBfc3BlY2lhbEF0dGFjayA9IF9zcGVjaWFsQXR0YWNrICogMTMgLyAxMDsKICAgICAgICB9CiAgICAgICAgdWludDE2IGhwRGVkdWN0ZWQgPSBzYWZlRGVkdWN0KF9hdHRhY2ssIF9kZWZlbnNlICogMyAvNCk7CiAgICAgICAgdWludDE2IGhwU3BlY2lhbERlZHVjdGVkID0gc2FmZURlZHVjdChfc3BlY2lhbEF0dGFjaywgX3NwZWNpYWxEZWZlbnNlKiAzIC8gNCk7CiAgICAgICAgaWYgKGhwRGVkdWN0ZWQgPCBtaW5IcERlZHVjdGVkICYmIGhwU3BlY2lhbERlZHVjdGVkIDwgbWluSHBEZWR1Y3RlZCkKICAgICAgICAgICAgcmV0dXJuIG1pbkhwRGVkdWN0ZWQ7CiAgICAgICAgaWYgKGhwRGVkdWN0ZWQgPiBocFNwZWNpYWxEZWR1Y3RlZCkKICAgICAgICAgICAgcmV0dXJuIGhwRGVkdWN0ZWQ7CiAgICAgICAgcmV0dXJuIGhwU3BlY2lhbERlZHVjdGVkOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBhdHRhY2sodWludDggX2luZGV4LCB1aW50OCBfcmFuLCB1aW50MTZbNl0gX2FTdGF0cywgdWludDE2WzZdIF9iU3RhdHMpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zKGJvb2wgd2luKSB7CiAgICAgICAgaWYgKF9yYW4gPCBfaW5kZXggKiBtYXhSYW5kb21Sb3VuZCkKICAgICAgICAgICAgX3JhbiA9IG1heFJhbmRvbVJvdW5kOwogICAgICAgIGVsc2UKICAgICAgICAgICAgX3JhbiA9IF9yYW4gLSBfaW5kZXggKiBtYXhSYW5kb21Sb3VuZDsKICAgICAgICAgICAgCiAgICAgICAgdWludDE2IHJvdW5kID0gMDsKICAgICAgICB1aW50MTYgYUhwID0gX2FTdGF0c1swXTsKICAgICAgICB1aW50MTYgYkhwID0gX2JTdGF0c1swXTsKICAgICAgICBpZiAoX2FTdGF0c1s1XSA+IF9iU3RhdHNbNV0pIHsKICAgICAgICAgICAgd2hpbGUgKHJvdW5kIDwgbWF4UmFuZG9tUm91bmQgJiYgYUhwID4gMCAmJiBiSHAgPiAwKSB7CiAgICAgICAgICAgICAgICBpZiAocm91bmQgJSAyID09IDApIHsKICAgICAgICAgICAgICAgICAgICAvLyBhIGF0dGFjayAKICAgICAgICAgICAgICAgICAgICBiSHAgPSBzYWZlRGVkdWN0KGJIcCwgY2FsSHBEZWR1Y3RlZChfYVN0YXRzWzFdLCBfYVN0YXRzWzNdLCBfYlN0YXRzWzJdLCBfYlN0YXRzWzRdLCByb3VuZD09X3JhbikpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBhSHAgPSBzYWZlRGVkdWN0KGFIcCwgY2FsSHBEZWR1Y3RlZChfYlN0YXRzWzFdLCBfYlN0YXRzWzNdLCBfYVN0YXRzWzJdLCBfYVN0YXRzWzRdLCByb3VuZD09X3JhbikpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcm91bmQrKzsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHdoaWxlIChyb3VuZCA8IG1heFJhbmRvbVJvdW5kICYmIGFIcCA+IDAgJiYgYkhwID4gMCkgewogICAgICAgICAgICAgICAgaWYgKHJvdW5kICUgMiAhPSAwKSB7CiAgICAgICAgICAgICAgICAgICAgYkhwID0gc2FmZURlZHVjdChiSHAsIGNhbEhwRGVkdWN0ZWQoX2FTdGF0c1sxXSwgX2FTdGF0c1szXSwgX2JTdGF0c1syXSwgX2JTdGF0c1s0XSwgcm91bmQ9PV9yYW4pKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgYUhwID0gc2FmZURlZHVjdChhSHAsIGNhbEhwRGVkdWN0ZWQoX2JTdGF0c1sxXSwgX2JTdGF0c1szXSwgX2FTdGF0c1syXSwgX2FTdGF0c1s0XSwgcm91bmQ9PV9yYW4pKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJvdW5kKys7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgd2luID0gYUhwID49IGJIcDsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gYXR0YWNrVHJhaW5lcih1aW50OCBfaW5kZXgsIHVpbnQ4IF9yYW4sIHVpbnQ4IF90cmFpbmVySWQsIHVpbnQ4IF90cmFpbmVyTGV2ZWwsIHVpbnQzMiBfb2JqQ2xhc3NJZCwgdWludDE2WzZdIF9vYmpTdGF0cykgY29uc3RhbnQgcHVibGljIHJldHVybnMoYm9vbCByZXN1bHQpIHsKICAgICAgICBHeW1UcmFpbmVyIG1lbW9yeSB0cmFpbmVyID0gZ3ltVHJhaW5lcnNbX3RyYWluZXJJZF07CiAgICAgICAgdWludDE2WzZdIG1lbW9yeSB0cmFpbmVyU3RhdHM7CiAgICAgICAgdWludCBpID0gMDsKICAgICAgICBmb3IgKGk9MDsgaSA8IFNUQVRfQ09VTlQ7IGkrPTEpIHsKICAgICAgICAgICAgdHJhaW5lclN0YXRzW2ldID0gdHJhaW5lci5zdGF0QmFzZXNbaV07CiAgICAgICAgfQogICAgICAgIGZvciAoaT0wOyBpIDwgY2FjaGVDbGFzc2VzW3RyYWluZXIuY2xhc3NJZF0uc3RlcHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdHJhaW5lclN0YXRzW2ldICs9IHVpbnQxNihzYWZlTXVsdChjYWNoZUNsYXNzZXNbdHJhaW5lci5jbGFzc0lkXS5zdGVwc1tpXSwgX3RyYWluZXJMZXZlbCozKSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGJvb2wgb2JqSGFzQWR2YW50YWdlOwogICAgICAgIGJvb2wgdHJhaW5lckhhc0FkdmFudGFnZTsKICAgICAgICAob2JqSGFzQWR2YW50YWdlLCB0cmFpbmVySGFzQWR2YW50YWdlKSA9IGdldFR5cGVTdXBwb3J0KF9vYmpDbGFzc0lkLCB0cmFpbmVyLmNsYXNzSWQpOwogICAgICAgIHVpbnQxNiBvcmlnaW5BdHRhY2sgPSBfb2JqU3RhdHNbMV07CiAgICAgICAgdWludDE2IG9yaWdpbkF0dGFja1NwZWNpYWwgPSBfb2JqU3RhdHNbM107CiAgICAgICAgaWYgKG9iakhhc0FkdmFudGFnZSkgewogICAgICAgICAgICBfb2JqU3RhdHNbMV0gKz0gX29ialN0YXRzWzFdICogdHlwZUJ1ZmZQZXJjZW50YWdlIC8gMTAwOwogICAgICAgICAgICBfb2JqU3RhdHNbM10gKz0gX29ialN0YXRzWzNdICogdHlwZUJ1ZmZQZXJjZW50YWdlIC8gMTAwOwogICAgICAgIH0KICAgICAgICBpZiAodHJhaW5lckhhc0FkdmFudGFnZSkgewogICAgICAgICAgICB0cmFpbmVyU3RhdHNbMV0gKz0gdHJhaW5lclN0YXRzWzFdICogdHlwZUJ1ZmZQZXJjZW50YWdlIC8gMTAwOwogICAgICAgICAgICB0cmFpbmVyU3RhdHNbM10gKz0gdHJhaW5lclN0YXRzWzNdICogdHlwZUJ1ZmZQZXJjZW50YWdlIC8gMTAwOwogICAgICAgIH0KICAgICAgICByZXN1bHQgPSBhdHRhY2soX2luZGV4LCBfcmFuLCBfb2JqU3RhdHMsIHRyYWluZXJTdGF0cyk7CiAgICAgICAgX29ialN0YXRzWzFdID0gb3JpZ2luQXR0YWNrOwogICAgICAgIF9vYmpTdGF0c1szXSA9IG9yaWdpbkF0dGFja1NwZWNpYWw7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldE9iakluZm8odWludDY0IF9vYmpJZCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludDMyIGNsYXNzSWQsIGFkZHJlc3MgdHJhaW5lZSwgdWludDggbGV2ZWwpIHsKICAgICAgICBFdGhlcmVtb25EYXRhQmFzZSBkYXRhID0gRXRoZXJlbW9uRGF0YUJhc2UoZGF0YUNvbnRyYWN0KTsKICAgICAgICBNb25zdGVyT2JqQWNjIG1lbW9yeSBvYmo7CiAgICAgICAgKG9iai5tb25zdGVySWQsIGNsYXNzSWQsIHRyYWluZWUsIG9iai5leHAsIG9iai5jcmVhdGVJbmRleCwgb2JqLmxhc3RDbGFpbUluZGV4LCBvYmouY3JlYXRlVGltZSkgPSBkYXRhLmdldE1vbnN0ZXJPYmooX29iaklkKTsKICAgICAgICBsZXZlbCA9IGdldExldmVsKG9iai5leHApOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBzdGFydFRyYWluaW5nKHVpbnQ2NCBfb2JqSWQsIHVpbnQ4IF90cmFpbmVyTGV2ZWwsIHVpbnQ4IF90MSwgdWludDggX3QyLCB1aW50OCBfdDMpIGlzQWN0aXZlIHJlcXVpcmVEYXRhQ29udHJhY3QgcmVxdWlyZVdvcmxkQ29udHJhY3QgcGF5YWJsZSBleHRlcm5hbCB7CiAgICAgICAgaWYgKF90cmFpbmVyTGV2ZWwgPiBtYXhUcmFpbmVyTGV2ZWwpCiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIGlmIChtc2cudmFsdWUgIT0gZ3ltRmVlKQogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICBpZiAoX3QxID09IF90MiB8fCBfdDEgPT0gX3QzIHx8IF90MiA9PSBfdDMpCiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIGlmIChfdDEgPT0gMCB8fCBfdDIgPT0gMCB8fCBfdDMgPT0gMCB8fCBfdDEgPiB0b3RhbFRyYWluZXIgfHwgX3QyID4gdG90YWxUcmFpbmVyIHx8IF90MyA+IHRvdGFsVHJhaW5lcikKICAgICAgICAgICAgcmV2ZXJ0KCk7CgogICAgICAgIEF0dGFja0RhdGEgbWVtb3J5IGF0dDsKICAgICAgICAoYXR0Lm9iakNsYXNzSWQsIGF0dC50cmFpbmVlLCBhdHQub2JqTGV2ZWwpID0gZ2V0T2JqSW5mbyhfb2JqSWQpOwogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IGF0dC50cmFpbmVlKQogICAgICAgICAgICByZXZlcnQoKTsKCiAgICAgICAgdWludCBpID0gMDsKICAgICAgICB1aW50MTZbNl0gbWVtb3J5IG9ialN0YXRzOwogICAgICAgIEV0aGVyZW1vbkRhdGFCYXNlIGRhdGEgPSBFdGhlcmVtb25EYXRhQmFzZShkYXRhQ29udHJhY3QpOwogICAgICAgIGZvciAoaT0wOyBpIDwgU1RBVF9DT1VOVDsgaSs9MSkgewogICAgICAgICAgICBvYmpTdGF0c1tpXSA9IGRhdGEuZ2V0RWxlbWVudEluQXJyYXlUeXBlKEFycmF5VHlwZS5TVEFUX0JBU0UsIF9vYmpJZCwgaSk7CiAgICAgICAgfQogICAgICAgIGZvciAoaT0wOyBpIDwgY2FjaGVDbGFzc2VzW2F0dC5vYmpDbGFzc0lkXS5zdGVwcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBvYmpTdGF0c1tpXSArPSB1aW50MTYoc2FmZU11bHQoY2FjaGVDbGFzc2VzW2F0dC5vYmpDbGFzc0lkXS5zdGVwc1tpXSwgYXR0Lm9iakxldmVsKjMpKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgYXR0LndpbkNvdW50ID0gMDsKICAgICAgICB1aW50OCByYW4gPSBnZXRSYW5kb20obWF4UmFuZG9tUm91bmQqMywgMCk7CiAgICAgICAgaWYgKGF0dGFja1RyYWluZXIoMCwgcmFuLCBfdDEsIF90cmFpbmVyTGV2ZWwsIGF0dC5vYmpDbGFzc0lkLCBvYmpTdGF0cykpCiAgICAgICAgICAgIGF0dC53aW5Db3VudCArPSAxOwogICAgICAgIGlmIChhdHRhY2tUcmFpbmVyKDEsIHJhbiwgX3QyLCBfdHJhaW5lckxldmVsLCBhdHQub2JqQ2xhc3NJZCwgb2JqU3RhdHMpKQogICAgICAgICAgICBhdHQud2luQ291bnQgKz0gMTsKICAgICAgICBpZiAoYXR0YWNrVHJhaW5lcigyLCByYW4sIF90MywgX3RyYWluZXJMZXZlbCwgYXR0Lm9iakNsYXNzSWQsIG9ialN0YXRzKSkKICAgICAgICAgICAgYXR0LndpbkNvdW50ICs9IDE7CgogICAgICAgIChhdHQud2luRXhwLCBhdHQubG9zZUV4cCkgPSBnZXRHYWluRXhwKGF0dC5vYmpMZXZlbCwgX3RyYWluZXJMZXZlbCk7CiAgICAgICAgRXRoZXJlbW9uR2F0ZXdheSBnYXRld2F5ID0gRXRoZXJlbW9uR2F0ZXdheSh3b3JsZENvbnRyYWN0KTsKICAgICAgICBnYXRld2F5LmluY3JlYXNlTW9uc3RlckV4cChfb2JqSWQsIGF0dC53aW5Db3VudCAqIGF0dC53aW5FeHAgKyAoMyAtIGF0dC53aW5Db3VudCkgKiBhdHQubG9zZUV4cCk7CiAgICAgICAgCiAgICAgICAgVHJhaW5pbmdMb2cgc3RvcmFnZSB0cmFpbmluZ0xvZyA9IHRyYWluZWVzW21zZy5zZW5kZXJdOwogICAgICAgIHRyYWluaW5nTG9nLnRyYWluZXJzWzBdID0gX3QxOwogICAgICAgIHRyYWluaW5nTG9nLnRyYWluZXJzWzFdID0gX3QyOwogICAgICAgIHRyYWluaW5nTG9nLnRyYWluZXJzWzJdID0gX3QzOwogICAgICAgIHRyYWluaW5nTG9nLnRyYWluZXJMZXZlbCA9IF90cmFpbmVyTGV2ZWw7CiAgICAgICAgdHJhaW5pbmdMb2cub2JqSWQgPSBfb2JqSWQ7CiAgICAgICAgdHJhaW5pbmdMb2cub2JqTGV2ZWwgPSBhdHQub2JqTGV2ZWw7CiAgICAgICAgdHJhaW5pbmdMb2cucmFuID0gcmFuOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRUcmFpbmluZ0xvZyhhZGRyZXNzIF90cmFpbmVlKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zKHVpbnQ4LCB1aW50OCwgdWludDgsIHVpbnQ2NCwgdWludDgsIHVpbnQ4LCB1aW50OCkgewogICAgICAgIFRyYWluaW5nTG9nIG1lbW9yeSB0cmFpbmluZ0xvZyA9IHRyYWluZWVzW190cmFpbmVlXTsKICAgICAgICByZXR1cm4gKHRyYWluaW5nTG9nLnRyYWluZXJzWzBdLCB0cmFpbmluZ0xvZy50cmFpbmVyc1sxXSwgdHJhaW5pbmdMb2cudHJhaW5lcnNbMl0sIAogICAgICAgICAgICB0cmFpbmluZ0xvZy5vYmpJZCwgdHJhaW5pbmdMb2cudHJhaW5lckxldmVsLCB0cmFpbmluZ0xvZy5vYmpMZXZlbCwgdHJhaW5pbmdMb2cucmFuKTsKICAgIH0KfQ=='.
	

]
