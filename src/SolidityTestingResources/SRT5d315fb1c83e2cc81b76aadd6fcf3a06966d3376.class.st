Class {
	#name : #SRT5d315fb1c83e2cc81b76aadd6fcf3a06966d3376,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT5d315fb1c83e2cc81b76aadd6fcf3a06966d3376 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7CgovLyBXb2xmIENyeXB0byBwb29saW5nIGNvbnRyYWN0IGZvciBSZWZlcmV1bQovLyB3cml0dGVuIGJ5IEBpYW1kZWZpbml0ZWx5YWh1bWFuCgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKGEgPT0gMCkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgoKY29udHJhY3QgRVJDMjAgewogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7fQogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7fQp9CgoKY29udHJhY3QgV2hpdGVMaXN0IHsKICAgZnVuY3Rpb24gY2hlY2tNZW1iZXJMZXZlbCAoYWRkcmVzcyBhZGRyKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50KSB7fQp9CgoKY29udHJhY3QgUHJlc2FsZVBvb2wgewoKICAvLyBTYWZlTWF0aCBpcyBhIGxpYnJhcnkgdG8gZW5zdXJlIHRoYXQgbWF0aCBvcGVyYXRpb25zIGRvIG5vdCBoYXZlIG92ZXJmbG93IGVycm9ycwogIC8vIGh0dHBzOi8vemVwcGVsaW4tc29saWRpdHkucmVhZHRoZWRvY3MuaW8vZW4vbGF0ZXN0L3NhZmVtYXRoLmh0bWwKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKICAKICAvLyBUaGUgY29udHJhY3QgaGFzIDMgc3RhZ2VzOgogIC8vIDEgLSBUaGUgaW5pdGlhbCBzdGF0ZS4gVGhlIG93bmVyIGlzIGFibGUgdG8gYWRkIGFkZHJlc3NlcyB0byB0aGUgd2hpdGVsaXN0LCBhbmQgYW55IHdoaXRlbGlzdGVkIGFkZHJlc3NlcyBjYW4gZGVwb3NpdCBvciB3aXRoZHJhdyBldGggdG8gdGhlIGNvbnRyYWN0LgogIC8vIDIgLSBUaGUgb3duZXIgaGFzIGNsb3NlZCB0aGUgY29udHJhY3QgZm9yIGZ1cnRoZXIgZGVwb3NpdHMuIFdoaXRlbGlzdGVkIGFkZHJlc3NlcyBjYW4gc3RpbGwgd2l0aGRyYXcgZXRoIGZyb20gdGhlIGNvbnRyYWN0LgogIC8vIDMgLSBUaGUgZXRoIGlzIHNlbnQgZnJvbSB0aGUgY29udHJhY3QgdG8gdGhlIHJlY2VpdmVyLiBVbnVzZWQgZXRoIGNhbiBiZSBjbGFpbWVkIGJ5IGNvbnRyaWJ1dG9ycyBpbW1lZGlhdGVseS4gT25jZSB0b2tlbnMgYXJlIHNlbnQgdG8gdGhlIGNvbnRyYWN0LAogIC8vICAgICB0aGUgb3duZXIgZW5hYmxlcyB3aXRoZHJhd2FscyBhbmQgY29udHJpYnV0b3JzIGNhbiB3aXRoZHJhdyB0aGVpciB0b2tlbnMuCiAgdWludDggcHVibGljIGNvbnRyYWN0U3RhZ2UgPSAxOwogIAogIC8vIFRoZXNlIHZhcmlhYmxlcyBhcmUgc2V0IGF0IHRoZSB0aW1lIG9mIGNvbnRyYWN0IGNyZWF0aW9uCiAgLy8gdGhlIGFkZHJlc3MgdGhhdCBjcmVhdGVzIHRoZSBjb250cmFjdAogIGFkZHJlc3MgcHVibGljIG93bmVyOwogIC8vIHRoZSBtaW5pbXVtIGV0aCBhbW91bnQgKGluIHdlaSkgdGhhdCBjYW4gYmUgc2VudCBieSBhIHdoaXRlbGlzdGVkIGFkZHJlc3MKICB1aW50IHB1YmxpYyBjb250cmlidXRpb25NaW47CiAgLy8gdGhlIG1heGltdW0gZXRoIGFtb3VudCAoaW4gd2VpKSB0aGF0IGNhbiBiZSBzZW50IGJ5IGEgd2hpdGVsaXN0ZWQgYWRkcmVzcwogIHVpbnRbXSBwdWJsaWMgY29udHJpYnV0aW9uQ2FwczsKICAvLyB0aGUgJSBvZiB0b2tlbnMga2VwdCBieSB0aGUgY29udHJhY3Qgb3duZXIKICB1aW50IHB1YmxpYyBmZWVQY3Q7CiAgLy8gdGhlIGFkZHJlc3MgdGhhdCB0aGUgcG9vbCB3aWxsIGJlIHBhaWQgb3V0IHRvCiAgYWRkcmVzcyBwdWJsaWMgcmVjZWl2ZXJBZGRyZXNzOwogIC8vIHRoZSBtYXhpbXVtIGdhcyBwcmljZSBhbGxvd2VkIGZvciBkZXBvc2l0cyBpbiBzdGFnZSAxCiAgdWludCBjb25zdGFudCBwdWJsaWMgbWF4R2FzUHJpY2UgPSA1MDAwMDAwMDAwMDsKICAvLyB0aGUgd2hpdGVsaXN0aW5nIGNvbnRyYWN0CiAgV2hpdGVMaXN0IHB1YmxpYyB3aGl0ZWxpc3RDb250cmFjdDsKICAKICAvLyBUaGVzZSB2YXJpYWJsZXMgYXJlIGFsbCBpbml0aWFsbHkgc2V0IHRvIDAgYW5kIHdpbGwgYmUgc2V0IGF0IHNvbWUgcG9pbnQgZHVyaW5nIHRoZSBjb250cmFjdAogIC8vIHRoZSBhbW91bnQgb2YgZXRoIChpbiB3ZWkpIHByZXNlbnQgaW4gdGhlIGNvbnRyYWN0IHdoZW4gaXQgd2FzIHN1Ym1pdHRlZAogIHVpbnQgcHVibGljIGZpbmFsQmFsYW5jZTsKICAvLyBhbiBhcnJheSBjb250YWluaW5nIGV0aCBhbW91bnRzIHRvIGJlIHJlZnVuZGVkIGluIHN0YWdlIDMKICB1aW50W10gcHVibGljIGV0aFJlZnVuZEFtb3VudDsKICAvLyB0aGUgZGVmYXVsdCB0b2tlbiBjb250cmFjdCB0byBiZSB1c2VkIGZvciB3aXRoZHJhd2luZyB0b2tlbnMgaW4gc3RhZ2UgMwogIGFkZHJlc3MgcHVibGljIGFjdGl2ZVRva2VuOwogIAogIC8vIGEgZGF0YSBzdHJ1Y3R1cmUgZm9yIGhvbGRpbmcgdGhlIGNvbnRyaWJ1dGlvbiBhbW91bnQsIGNhcCwgZXRoIHJlZnVuZCBzdGF0dXMsIGFuZCB0b2tlbiB3aXRoZHJhd2FsIHN0YXR1cyBmb3IgZWFjaCB3aGl0ZWxpc3RlZCBhZGRyZXNzCiAgc3RydWN0IENvbnRyaWJ1dG9yIHsKICAgIGJvb2wgYXV0aG9yaXplZDsKICAgIHVpbnQgZXRoUmVmdW5kOwogICAgdWludCBiYWxhbmNlOwogICAgdWludCBjYXA7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHRva2Vuc0NsYWltZWQ7CiAgfQogIC8vIGEgbWFwcGluZyB0aGF0IGhvbGRzIHRoZSBjb250cmlidXRvciBzdHJ1Y3QgZm9yIGVhY2ggd2hpdGVsaXN0ZWQgYWRkcmVzcwogIG1hcHBpbmcgKGFkZHJlc3MgPT4gQ29udHJpYnV0b3IpIHdoaXRlbGlzdDsKICAKICAvLyBhIGRhdGEgc3RydWN0dXJlIGZvciBob2xkaW5nIGluZm9ybWF0aW9uIHJlbGF0ZWQgdG8gdG9rZW4gd2l0aGRyYXdhbHMuCiAgc3RydWN0IFRva2VuQWxsb2NhdGlvbiB7CiAgICBFUkMyMCB0b2tlbjsKICAgIHVpbnRbXSBwY3Q7CiAgICB1aW50IGJhbGFuY2VSZW1haW5pbmc7CiAgfQogIC8vIGEgbWFwcGluZyB0aGF0IGhvbGRzIHRoZSB0b2tlbiBhbGxvY2F0aW9uIHN0cnVjdCBmb3IgZWFjaCB0b2tlbiBhZGRyZXNzCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBUb2tlbkFsbG9jYXRpb24pIGRpc3RyaWJ1dGlvbjsKICAKICAKICAvLyB0aGlzIG1vZGlmaWVyIGlzIHVzZWQgZm9yIGZ1bmN0aW9ucyB0aGF0IGNhbiBvbmx5IGJlIGFjY2Vzc2VkIGJ5IHRoZSBjb250cmFjdCBjcmVhdG9yCiAgbW9kaWZpZXIgb25seU93bmVyICgpIHsKICAgIHJlcXVpcmUgKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CiAgCiAgLy8gdGhpcyBtb2RpZmllciBpcyB1c2VkIHRvIHByZXZlbnQgcmUtZW50cmFuY3kgZXhwbG9pdHMgZHVyaW5nIGNvbnRyYWN0ID4gY29udHJhY3QgaW50ZXJhY3Rpb24KICBib29sIGxvY2tlZDsKICBtb2RpZmllciBub1JlZW50cmFuY3koKSB7CiAgICByZXF1aXJlKCFsb2NrZWQpOwogICAgbG9ja2VkID0gdHJ1ZTsKICAgIF87CiAgICBsb2NrZWQgPSBmYWxzZTsKICB9CiAgCiAgLy8gRXZlbnRzIHRyaWdnZXJlZCB0aHJvdWdob3V0IGNvbnRyYWN0IGV4ZWN1dGlvbgogIC8vIFRoZXNlIGNhbiBiZSB3YXRjaGVkIHZpYSBnZXRoIGZpbHRlcnMgdG8ga2VlcCB1cC10by1kYXRlIHdpdGggdGhlIGNvbnRyYWN0CiAgZXZlbnQgQ29udHJpYnV0b3JCYWxhbmNlQ2hhbmdlZCAoYWRkcmVzcyBjb250cmlidXRvciwgdWludCB0b3RhbEJhbGFuY2UpOwogIGV2ZW50IFRva2Vuc1dpdGhkcmF3biAoYWRkcmVzcyByZWNlaXZlciwgdWludCBhbW91bnQpOwogIGV2ZW50IEV0aFJlZnVuZGVkIChhZGRyZXNzIHJlY2VpdmVyLCB1aW50IGFtb3VudCk7CiAgZXZlbnQgV2l0aGRyYXdhbHNPcGVuIChhZGRyZXNzIHRva2VuQWRkcik7CiAgZXZlbnQgRVJDMjIzUmVjZWl2ZWQgKGFkZHJlc3MgdG9rZW4sIHVpbnQgdmFsdWUpOwogIGV2ZW50IEV0aFJlZnVuZFJlY2VpdmVkIChhZGRyZXNzIHNlbmRlciwgdWludCBhbW91bnQpOwogICAKICAvLyBUaGVzZSBhcmUgaW50ZXJuYWwgZnVuY3Rpb25zIHVzZWQgZm9yIGNhbGN1bGF0aW5nIGZlZXMsIGV0aCBhbmQgdG9rZW4gYWxsb2NhdGlvbnMgYXMgJQogIC8vIHJldHVybnMgYSB2YWx1ZSBhcyBhICUgYWNjdXJhdGUgdG8gMjAgZGVjaW1hbCBwb2ludHMKICBmdW5jdGlvbiBfdG9QY3QgKHVpbnQgbnVtZXJhdG9yLCB1aW50IGRlbm9taW5hdG9yICkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50KSB7CiAgICByZXR1cm4gbnVtZXJhdG9yLm11bCgxMCAqKiAyMCkgLyBkZW5vbWluYXRvcjsKICB9CiAgCiAgLy8gcmV0dXJucyAlIG9mIGFueSBudW1iZXIsIHdoZXJlICUgZ2l2ZW4gd2FzIGdlbmVyYXRlZCB3aXRoIHRvUGN0CiAgZnVuY3Rpb24gX2FwcGx5UGN0ICh1aW50IG51bWVyYXRvciwgdWludCBwY3QpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCkgewogICAgcmV0dXJuIG51bWVyYXRvci5tdWwocGN0KSAvICgxMCAqKiAyMCk7CiAgfQogIAogIC8vIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGF0IHRoZSB0aW1lIG9mIGNvbnRyYWN0IGNyZWF0aW9uLAogIC8vIGl0IHNldHMgdGhlIGluaXRpYWwgdmFyaWFibGVzIGFuZCB3aGl0ZWxpc3RzIHRoZSBjb250cmFjdCBvd25lci4KICBmdW5jdGlvbiBQcmVzYWxlUG9vbChhZGRyZXNzIHJlY2VpdmVyQWRkciwgYWRkcmVzcyB3aGl0ZWxpc3RBZGRyLCB1aW50IGluZGl2aWR1YWxNaW4sIHVpbnRbXSBjYXBBbW91bnRzLCB1aW50IGZlZSkgcHVibGljIHsKICAgIHJlcXVpcmUgKHJlY2VpdmVyQWRkciAhPSAweDAwKTsKICAgIHJlcXVpcmUgKGZlZSA8IDEwMCk7CiAgICByZXF1aXJlICgxMDAwMDAwMDAwMDAwMDAwMDAgPD0gaW5kaXZpZHVhbE1pbik7CiAgICByZXF1aXJlIChjYXBBbW91bnRzLmxlbmd0aD4xICYmIGNhcEFtb3VudHMubGVuZ3RoPDI1Nik7CiAgICBmb3IgKHVpbnQ4IGk9MTsgaTxjYXBBbW91bnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHJlcXVpcmUgKGNhcEFtb3VudHNbaV0gPD0gY2FwQW1vdW50c1swXSk7CiAgICB9CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICByZWNlaXZlckFkZHJlc3MgPSByZWNlaXZlckFkZHI7CiAgICBjb250cmlidXRpb25NaW4gPSBpbmRpdmlkdWFsTWluOwogICAgY29udHJpYnV0aW9uQ2FwcyA9IGNhcEFtb3VudHM7CiAgICBmZWVQY3QgPSBfdG9QY3QoZmVlLDEwMCk7CiAgICB3aGl0ZWxpc3RDb250cmFjdCA9IFdoaXRlTGlzdCh3aGl0ZWxpc3RBZGRyKTsKICAgIHdoaXRlbGlzdFttc2cuc2VuZGVyXS5hdXRob3JpemVkID0gdHJ1ZTsKICB9CiAgCiAgLy8gVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgd2hlbmV2ZXIgZXRoIGlzIHNlbnQgaW50byB0aGUgY29udHJhY3QuCiAgLy8gVGhlIHNlbmQgd2lsbCBmYWlsIHVubGVzcyB0aGUgY29udHJhY3QgaXMgaW4gc3RhZ2Ugb25lIGFuZCB0aGUgc2VuZGVyIGhhcyBiZWVuIHdoaXRlbGlzdGVkLgogIC8vIFRoZSBhbW91bnQgc2VudCBpcyBhZGRlZCB0byB0aGUgYmFsYW5jZSBpbiB0aGUgQ29udHJpYnV0b3Igc3RydWN0IGFzc29jaWF0ZWQgd2l0aCB0aGUgc2VuZGluZyBhZGRyZXNzLgogIGZ1bmN0aW9uICgpIHBheWFibGUgcHVibGljIHsKICAgIGlmIChjb250cmFjdFN0YWdlID09IDEpIHsKICAgICAgX2V0aERlcG9zaXQoKTsKICAgIH0gZWxzZSBpZiAoY29udHJhY3RTdGFnZSA9PSAzKSB7CiAgICAgIF9ldGhSZWZ1bmQoKTsKICAgIH0gZWxzZSByZXZlcnQoKTsKICB9CiAgCiAgLy8gSW50ZXJuYWwgZnVuY3Rpb24gZm9yIGhhbmRsaW5nIGV0aCBkZXBvc2l0cyBkdXJpbmcgY29udHJhY3Qgc3RhZ2Ugb25lLgogIGZ1bmN0aW9uIF9ldGhEZXBvc2l0ICgpIGludGVybmFsIHsKICAgIGFzc2VydCAoY29udHJhY3RTdGFnZSA9PSAxKTsKICAgIHJlcXVpcmUgKHR4Lmdhc3ByaWNlIDw9IG1heEdhc1ByaWNlKTsKICAgIHJlcXVpcmUgKHRoaXMuYmFsYW5jZSA8PSBjb250cmlidXRpb25DYXBzWzBdKTsKICAgIHZhciBjID0gd2hpdGVsaXN0W21zZy5zZW5kZXJdOwogICAgdWludCBuZXdCYWxhbmNlID0gYy5iYWxhbmNlLmFkZChtc2cudmFsdWUpOwogICAgcmVxdWlyZSAobmV3QmFsYW5jZSA+PSBjb250cmlidXRpb25NaW4pOwogICAgcmVxdWlyZSAobmV3QmFsYW5jZSA8PSBfY2hlY2tDYXAobXNnLnNlbmRlcikpOwogICAgYy5iYWxhbmNlID0gbmV3QmFsYW5jZTsKICAgIENvbnRyaWJ1dG9yQmFsYW5jZUNoYW5nZWQobXNnLnNlbmRlciwgbmV3QmFsYW5jZSk7CiAgfQogIAogIC8vIEludGVybmFsIGZ1bmN0aW9uIGZvciBoYW5kbGluZyBldGggcmVmdW5kcyBkdXJpbmcgc3RhZ2UgdGhyZWUuCiAgZnVuY3Rpb24gX2V0aFJlZnVuZCAoKSBpbnRlcm5hbCB7CiAgICBhc3NlcnQgKGNvbnRyYWN0U3RhZ2UgPT0gMyk7CiAgICByZXF1aXJlIChtc2cuc2VuZGVyID09IG93bmVyIHx8IG1zZy5zZW5kZXIgPT0gcmVjZWl2ZXJBZGRyZXNzKTsKICAgIHJlcXVpcmUgKG1zZy52YWx1ZSA+PSBjb250cmlidXRpb25NaW4pOwogICAgZXRoUmVmdW5kQW1vdW50LnB1c2gobXNnLnZhbHVlKTsKICAgIEV0aFJlZnVuZFJlY2VpdmVkKG1zZy5zZW5kZXIsIG1zZy52YWx1ZSk7CiAgfQogIAogIC8vIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIHRvIHdpdGhkcmF3IGV0aCBvciB0b2tlbnMgZnJvbSB0aGUgY29udHJhY3QuCiAgLy8gSXQgY2FuIG9ubHkgYmUgY2FsbGVkIGJ5IGFkZHJlc3NlcyB0aGF0IGFyZSB3aGl0ZWxpc3RlZCBhbmQgc2hvdyBhIGJhbGFuY2UgZ3JlYXRlciB0aGFuIDAuCiAgLy8gSWYgY2FsbGVkIGR1cmluZyBjb250cmFjdCBzdGFnZXMgb25lIG9yIHR3bywgdGhlIGZ1bGwgZXRoIGJhbGFuY2UgZGVwb3NpdGVkIGludG8gdGhlIGNvbnRyYWN0IHdpbGwgYmUgcmV0dXJuZWQgYW5kIHRoZSBjb250cmlidXRvcidzIGJhbGFuY2Ugd2lsbCBiZSByZXNldCB0byAwLgogIC8vIElmIGNhbGxlZCBkdXJpbmcgc3RhZ2UgdGhyZWUsIHRoZSBjb250cmlidXRvcidzIHVudXNlZCBldGggd2lsbCBiZSByZXR1cm5lZCwgYXMgd2VsbCBhcyBhbnkgYXZhaWxhYmxlIHRva2Vucy4KICAvLyBUaGUgdG9rZW4gYWRkcmVzcyBtYXkgYmUgcHJvdmlkZWQgb3B0aW9uYWxseSB0byB3aXRoZHJhdyB0b2tlbnMgdGhhdCBhcmUgbm90IGN1cnJlbnRseSB0aGUgZGVmYXVsdCB0b2tlbiAoYWlyZHJvcHMpLgogIGZ1bmN0aW9uIHdpdGhkcmF3IChhZGRyZXNzIHRva2VuQWRkcikgcHVibGljIHsKICAgIHZhciBjID0gd2hpdGVsaXN0W21zZy5zZW5kZXJdOwogICAgcmVxdWlyZSAoYy5iYWxhbmNlID4gMCk7CiAgICBpZiAoY29udHJhY3RTdGFnZSA8IDMpIHsKICAgICAgdWludCBhbW91bnRUb1RyYW5zZmVyID0gYy5iYWxhbmNlOwogICAgICBjLmJhbGFuY2UgPSAwOwogICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKGFtb3VudFRvVHJhbnNmZXIpOwogICAgICBDb250cmlidXRvckJhbGFuY2VDaGFuZ2VkKG1zZy5zZW5kZXIsIDApOwogICAgfSBlbHNlIHsKICAgICAgX3dpdGhkcmF3KG1zZy5zZW5kZXIsdG9rZW5BZGRyKTsKICAgIH0gIAogIH0KICAKICAvLyBUaGlzIGZ1bmN0aW9uIGFsbG93cyB0aGUgY29udHJhY3Qgb3duZXIgdG8gZm9yY2UgYSB3aXRoZHJhd2FsIHRvIGFueSBjb250cmlidXRvci4KICBmdW5jdGlvbiB3aXRoZHJhd0ZvciAoYWRkcmVzcyBjb250cmlidXRvciwgYWRkcmVzcyB0b2tlbkFkZHIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZSAoY29udHJhY3RTdGFnZSA9PSAzKTsKICAgIHJlcXVpcmUgKHdoaXRlbGlzdFtjb250cmlidXRvcl0uYmFsYW5jZSA+IDApOwogICAgX3dpdGhkcmF3KGNvbnRyaWJ1dG9yLHRva2VuQWRkcik7CiAgfQogIAogIC8vIFRoaXMgaW50ZXJuYWwgZnVuY3Rpb24gaGFuZGxlcyB3aXRoZHJhd2FscyBkdXJpbmcgc3RhZ2UgdGhyZWUuCiAgLy8gVGhlIGFzc29jaWF0ZWQgZXZlbnRzIHdpbGwgZmlyZSB0byBub3RpZnkgd2hlbiBhIHJlZnVuZCBvciB0b2tlbiBhbGxvY2F0aW9uIGlzIGNsYWltZWQuCiAgZnVuY3Rpb24gX3dpdGhkcmF3IChhZGRyZXNzIHJlY2VpdmVyLCBhZGRyZXNzIHRva2VuQWRkcikgaW50ZXJuYWwgewogICAgYXNzZXJ0IChjb250cmFjdFN0YWdlID09IDMpOwogICAgdmFyIGMgPSB3aGl0ZWxpc3RbcmVjZWl2ZXJdOwogICAgaWYgKHRva2VuQWRkciA9PSAweDAwKSB7CiAgICAgIHRva2VuQWRkciA9IGFjdGl2ZVRva2VuOwogICAgfQogICAgdmFyIGQgPSBkaXN0cmlidXRpb25bdG9rZW5BZGRyXTsKICAgIHJlcXVpcmUgKCAoZXRoUmVmdW5kQW1vdW50Lmxlbmd0aCA+IGMuZXRoUmVmdW5kKSB8fCBkLnBjdC5sZW5ndGggPiBjLnRva2Vuc0NsYWltZWRbdG9rZW5BZGRyXSApOwogICAgaWYgKGV0aFJlZnVuZEFtb3VudC5sZW5ndGggPiBjLmV0aFJlZnVuZCkgewogICAgICB1aW50IHBjdCA9IF90b1BjdChjLmJhbGFuY2UsZmluYWxCYWxhbmNlKTsKICAgICAgdWludCBldGhBbW91bnQgPSAwOwogICAgICBmb3IgKHVpbnQgaT1jLmV0aFJlZnVuZDsgaTxldGhSZWZ1bmRBbW91bnQubGVuZ3RoOyBpKyspIHsKICAgICAgICBldGhBbW91bnQgPSBldGhBbW91bnQuYWRkKF9hcHBseVBjdChldGhSZWZ1bmRBbW91bnRbaV0scGN0KSk7CiAgICAgIH0KICAgICAgYy5ldGhSZWZ1bmQgPSBldGhSZWZ1bmRBbW91bnQubGVuZ3RoOwogICAgICBpZiAoZXRoQW1vdW50ID4gMCkgewogICAgICAgIHJlY2VpdmVyLnRyYW5zZmVyKGV0aEFtb3VudCk7CiAgICAgICAgRXRoUmVmdW5kZWQocmVjZWl2ZXIsZXRoQW1vdW50KTsKICAgICAgfQogICAgfQogICAgaWYgKGQucGN0Lmxlbmd0aCA+IGMudG9rZW5zQ2xhaW1lZFt0b2tlbkFkZHJdKSB7CiAgICAgIHVpbnQgdG9rZW5BbW91bnQgPSAwOwogICAgICBmb3IgKGk9Yy50b2tlbnNDbGFpbWVkW3Rva2VuQWRkcl07IGk8ZC5wY3QubGVuZ3RoOyBpKyspIHsKICAgICAgICB0b2tlbkFtb3VudCA9IHRva2VuQW1vdW50LmFkZChfYXBwbHlQY3QoYy5iYWxhbmNlLGQucGN0W2ldKSk7CiAgICAgIH0KICAgICAgYy50b2tlbnNDbGFpbWVkW3Rva2VuQWRkcl0gPSBkLnBjdC5sZW5ndGg7CiAgICAgIGlmICh0b2tlbkFtb3VudCA+IDApIHsKICAgICAgICByZXF1aXJlKGQudG9rZW4udHJhbnNmZXIocmVjZWl2ZXIsdG9rZW5BbW91bnQpKTsKICAgICAgICBkLmJhbGFuY2VSZW1haW5pbmcgPSBkLmJhbGFuY2VSZW1haW5pbmcuc3ViKHRva2VuQW1vdW50KTsKICAgICAgICBUb2tlbnNXaXRoZHJhd24ocmVjZWl2ZXIsdG9rZW5BbW91bnQpOwogICAgICB9ICAKICAgIH0KICAgIAogIH0KICAKICAvLyBUaGlzIGZ1bmN0aW9uIGNhbiBvbmx5IGJlIGV4ZWN1dGVkIGJ5IHRoZSBvd25lciwgaXQgYWRkcyBhbiBhZGRyZXNzIHRvIHRoZSB3aGl0ZWxpc3QuCiAgLy8gVG8gZXhlY3V0ZSwgdGhlIGNvbnRyYWN0IG11c3QgYmUgaW4gc3RhZ2UgMSwgdGhlIGFkZHJlc3MgY2Fubm90IGFscmVhZHkgYmUgd2hpdGVsaXN0ZWQsIGFuZCB0aGUgYWRkcmVzcyBjYW5ub3QgYmUgYSBjb250cmFjdCBpdHNlbGYuCiAgLy8gQmxvY2tpbmcgY29udHJhY3RzIGZyb20gYmVpbmcgd2hpdGVsaXN0ZWQgcHJldmVudHMgYXR0YWNrcyBmcm9tIHVuZXhwZWN0ZWQgY29udHJhY3QgdG8gY29udHJhY3QgaW50ZXJhY3Rpb24gLSB2ZXJ5IGltcG9ydGFudCEKICBmdW5jdGlvbiBhdXRob3JpemUgKGFkZHJlc3MgYWRkciwgdWludCBjYXApIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZSAoY29udHJhY3RTdGFnZSA9PSAxKTsKICAgIF9jaGVja1doaXRlbGlzdENvbnRyYWN0KGFkZHIpOwogICAgcmVxdWlyZSAoIXdoaXRlbGlzdFthZGRyXS5hdXRob3JpemVkKTsKICAgIHJlcXVpcmUgKChjYXAgPiAwICYmIGNhcCA8IGNvbnRyaWJ1dGlvbkNhcHMubGVuZ3RoKSB8fCAoY2FwID49IGNvbnRyaWJ1dGlvbk1pbiAmJiBjYXAgPD0gY29udHJpYnV0aW9uQ2Fwc1swXSkgKTsKICAgIHVpbnQgc2l6ZTsKICAgIGFzc2VtYmx5IHsgc2l6ZSA6PSBleHRjb2Rlc2l6ZShhZGRyKSB9CiAgICByZXF1aXJlIChzaXplID09IDApOwogICAgd2hpdGVsaXN0W2FkZHJdLmNhcCA9IGNhcDsKICAgIHdoaXRlbGlzdFthZGRyXS5hdXRob3JpemVkID0gdHJ1ZTsKICB9CiAgCiAgLy8gVGhpcyBmdW5jdGlvbiBpcyB1c2VkIGJ5IHRoZSBvd25lciB0byBhdXRob3JpemUgbWFueSBhZGRyZXNzZXMgaW4gYSBzaW5nbGUgY2FsbC4KICAvLyBFYWNoIGFkZHJlc3Mgd2lsbCBiZSBnaXZlbiB0aGUgc2FtZSBjYXAsIGFuZCB0aGUgY2FwIG11c3QgYmUgb25lIG9mIHRoZSBzdGFuZGFyZCBsZXZlbHMuCiAgZnVuY3Rpb24gYXV0aG9yaXplTWFueSAoYWRkcmVzc1tdIGFkZHIsIHVpbnQgY2FwKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUgKGFkZHIubGVuZ3RoIDwgMjU1KTsKICAgIHJlcXVpcmUgKGNhcCA+IDAgJiYgY2FwIDwgY29udHJpYnV0aW9uQ2Fwcy5sZW5ndGgpOwogICAgZm9yICh1aW50OCBpPTA7IGk8YWRkci5sZW5ndGg7IGkrKykgewogICAgICBhdXRob3JpemUoYWRkcltpXSwgY2FwKTsKICAgIH0KICB9CiAgCiAgLy8gVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHJlbW92ZSBhbiBhZGRyZXNzIGZyb20gdGhlIHdoaXRlbGlzdC4KICAvLyBJdCBtYXkgb25seSBiZSBleGVjdXRlZCBkdXJpbmcgc3RhZ2VzIDEgYW5kIDIuICBBbnkgZXRoIHNlbnQgYnkgdGhlIGFkZHJlc3MgaXMgcmVmdW5kZWQgYW5kIHRoZWlyIHBlcnNvbmFsIGNhcCBpcyBzZXQgdG8gMC4KICAvLyBJdCB3aWxsIHRocm93IGlmIHRoZSBhZGRyZXNzIGlzIHN0aWxsIGF1dGhvcmlzZWQgaW4gdGhlIHdoaXRlbGlzdCBjb250cmFjdC4KICBmdW5jdGlvbiByZXZva2UgKGFkZHJlc3MgYWRkcikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlIChjb250cmFjdFN0YWdlIDwgMyk7CiAgICByZXF1aXJlICh3aGl0ZWxpc3RbYWRkcl0uYXV0aG9yaXplZCk7CiAgICByZXF1aXJlICh3aGl0ZWxpc3RDb250cmFjdC5jaGVja01lbWJlckxldmVsKGFkZHIpID09IDApOwogICAgd2hpdGVsaXN0W2FkZHJdLmF1dGhvcml6ZWQgPSBmYWxzZTsKICAgIGlmICh3aGl0ZWxpc3RbYWRkcl0uYmFsYW5jZSA+IDApIHsKICAgICAgdWludCBhbW91bnRUb1RyYW5zZmVyID0gd2hpdGVsaXN0W2FkZHJdLmJhbGFuY2U7CiAgICAgIHdoaXRlbGlzdFthZGRyXS5iYWxhbmNlID0gMDsKICAgICAgYWRkci50cmFuc2ZlcihhbW91bnRUb1RyYW5zZmVyKTsKICAgICAgQ29udHJpYnV0b3JCYWxhbmNlQ2hhbmdlZChhZGRyLCAwKTsKICAgIH0KICB9CiAgCiAgLy8gVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIG1vZGlmeSB0aGUgY29udHJpYnV0aW9uIGNhcCBvZiBhIHdoaXRlbGlzdGVkIGFkZHJlc3MuCiAgLy8gSWYgdGhlIGN1cnJlbnQgY29udHJpYnV0aW9uIGJhbGFuY2UgZXhjZWVkcyB0aGUgbmV3IGNhcCwgdGhlIGV4Y2VzcyBiYWxhbmNlIGlzIHJlZnVuZGVkLgogIGZ1bmN0aW9uIG1vZGlmeUluZGl2aWR1YWxDYXAgKGFkZHJlc3MgYWRkciwgdWludCBjYXApIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZSAoY29udHJhY3RTdGFnZSA8IDMpOwogICAgcmVxdWlyZSAoY2FwIDwgY29udHJpYnV0aW9uQ2Fwcy5sZW5ndGggfHwgKGNhcCA+PSBjb250cmlidXRpb25NaW4gJiYgY2FwIDw9IGNvbnRyaWJ1dGlvbkNhcHNbMF0pICk7CiAgICBfY2hlY2tXaGl0ZWxpc3RDb250cmFjdChhZGRyKTsKICAgIHZhciBjID0gd2hpdGVsaXN0W2FkZHJdOwogICAgcmVxdWlyZSAoYy5hdXRob3JpemVkKTsKICAgIHVpbnQgYW1vdW50ID0gYy5iYWxhbmNlOwogICAgYy5jYXAgPSBjYXA7CiAgICB1aW50IGNhcEFtb3VudCA9IF9jaGVja0NhcChhZGRyKTsKICAgIGlmIChhbW91bnQgPiBjYXBBbW91bnQpIHsKICAgICAgYy5iYWxhbmNlID0gY2FwQW1vdW50OwogICAgICBhZGRyLnRyYW5zZmVyKGFtb3VudC5zdWIoY2FwQW1vdW50KSk7CiAgICAgIENvbnRyaWJ1dG9yQmFsYW5jZUNoYW5nZWQoYWRkciwgY2FwQW1vdW50KTsKICAgIH0KICB9CiAgCiAgLy8gVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIG1vZGlmeSB0aGUgY2FwIGZvciBhIGNvbnRyaWJ1dGlvbiBsZXZlbC4KICAvLyBUaGUgY2FwIGNhbiBvbmx5IGJlIGluY3JlYXNlZCwgbm90IGRlY3JlYXNlZCwgYW5kIGNhbm5vdCBleGNlZWQgdGhlIGNvbnRyYWN0IGxpbWl0LgogIGZ1bmN0aW9uIG1vZGlmeUxldmVsQ2FwICh1aW50IGxldmVsLCB1aW50IGNhcCkgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlIChjb250cmFjdFN0YWdlIDwgMyk7CiAgICByZXF1aXJlIChsZXZlbCA+IDAgJiYgbGV2ZWwgPCBjb250cmlidXRpb25DYXBzLmxlbmd0aCk7CiAgICByZXF1aXJlIChjb250cmlidXRpb25DYXBzW2xldmVsXSA8IGNhcCAmJiBjb250cmlidXRpb25DYXBzWzBdID49IGNhcCk7CiAgICBjb250cmlidXRpb25DYXBzW2xldmVsXSA9IGNhcDsKICB9CiAgCiAgLy8gVGhpcyBmdW5jdGlvbiBjaGFuZ2VzIGV2ZXJ5IGxldmVsIGNhcCBhdCBvbmNlLgogIGZ1bmN0aW9uIG1vZGlmeUxldmVsQ2FwcyAodWludFtdIGNhcCkgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlIChjb250cmFjdFN0YWdlIDwgMyk7CiAgICByZXF1aXJlIChjYXAubGVuZ3RoID09IGNvbnRyaWJ1dGlvbkNhcHMubGVuZ3RoLTEpOwogICAgZm9yICh1aW50OCBpID0gMTsgaTxjb250cmlidXRpb25DYXBzLmxlbmd0aDsgaSsrKSB7CiAgICAgIG1vZGlmeUxldmVsQ2FwKGksY2FwW2ktMV0pOwogICAgfQogIH0KICAKICAKICAvLyBUaGlzIGZ1bmN0aW9uIGNhbiBiZSBjYWxsZWQgZHVyaW5nIHN0YWdlcyBvbmUgb3IgdHdvIHRvIG1vZGlmeSB0aGUgbWF4aW11bSBiYWxhbmNlIG9mIHRoZSBjb250cmFjdC4KICAvLyBJdCBjYW4gb25seSBiZSBjYWxsZWQgYnkgdGhlIG93bmVyLiBUaGUgYW1vdW50IGNhbm5vdCBiZSBzZXQgdG8gbG93ZXIgdGhhbiB0aGUgY3VycmVudCBiYWxhbmNlIG9mIHRoZSBjb250cmFjdC4KICBmdW5jdGlvbiBtb2RpZnlNYXhDb250cmFjdEJhbGFuY2UgKHVpbnQgYW1vdW50KSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUgKGNvbnRyYWN0U3RhZ2UgPCAzKTsKICAgIHJlcXVpcmUgKGFtb3VudCA+PSBjb250cmlidXRpb25NaW4pOwogICAgcmVxdWlyZSAoYW1vdW50ID49IHRoaXMuYmFsYW5jZSk7CiAgICBjb250cmlidXRpb25DYXBzWzBdID0gYW1vdW50OwogICAgZm9yICh1aW50OCBpPTE7IGk8Y29udHJpYnV0aW9uQ2Fwcy5sZW5ndGg7IGkrKykgewogICAgICBpZiAoY29udHJpYnV0aW9uQ2Fwc1tpXT5hbW91bnQpIGNvbnRyaWJ1dGlvbkNhcHNbaV09YW1vdW50OwogICAgfQogIH0KICAKICAvLyBUaGlzIGludGVybmFsIGZ1bmN0aW9uIHJldHVybnMgdGhlIGNhcCBhbW91bnQgb2YgYSB3aGl0ZWxpc3RlZCBhZGRyZXNzLgogIGZ1bmN0aW9uIF9jaGVja0NhcCAoYWRkcmVzcyBhZGRyKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICBfY2hlY2tXaGl0ZWxpc3RDb250cmFjdChhZGRyKTsKICAgIHZhciBjID0gd2hpdGVsaXN0W2FkZHJdOwogICAgaWYgKCFjLmF1dGhvcml6ZWQpIHJldHVybiAwOwogICAgaWYgKGMuY2FwPGNvbnRyaWJ1dGlvbkNhcHMubGVuZ3RoKSByZXR1cm4gY29udHJpYnV0aW9uQ2Fwc1tjLmNhcF07CiAgICByZXR1cm4gYy5jYXA7IAogIH0KICAKICAvLyBUaGlzIGludGVybmFsIGZ1bmN0aW9uIGNoZWNrcyBpZiBhbiBhZGRyZXNzIGlzIHdoaXRlbGlzdGVkIGluIHRoZSB3aGl0ZWxpc3QgY29udHJhY3QuCiAgZnVuY3Rpb24gX2NoZWNrV2hpdGVsaXN0Q29udHJhY3QgKGFkZHJlc3MgYWRkcikgaW50ZXJuYWwgewogICAgdmFyIGMgPSB3aGl0ZWxpc3RbYWRkcl07CiAgICBpZiAoIWMuYXV0aG9yaXplZCkgewogICAgICB2YXIgbGV2ZWwgPSB3aGl0ZWxpc3RDb250cmFjdC5jaGVja01lbWJlckxldmVsKGFkZHIpOwogICAgICBpZiAobGV2ZWwgPT0gMCB8fCBsZXZlbCA+PSBjb250cmlidXRpb25DYXBzLmxlbmd0aCkgcmV0dXJuOwogICAgICBjLmNhcCA9IGxldmVsOwogICAgICBjLmF1dGhvcml6ZWQgPSB0cnVlOwogICAgfQogIH0KICAKICAvLyBUaGlzIGNhbGxhYmxlIGZ1bmN0aW9uIHJldHVybnMgdGhlIHRvdGFsIHBvb2wgY2FwLCBjdXJyZW50IGJhbGFuY2UgYW5kIHJlbWFpbmluZyBiYWxhbmNlIHRvIGJlIGZpbGxlZC4KICBmdW5jdGlvbiBjaGVja1Bvb2xCYWxhbmNlICgpIHZpZXcgcHVibGljIHJldHVybnMgKHVpbnQgcG9vbENhcCwgdWludCBiYWxhbmNlLCB1aW50IHJlbWFpbmluZykgewogICAgaWYgKGNvbnRyYWN0U3RhZ2UgPT0gMSkgewogICAgICByZW1haW5pbmcgPSBjb250cmlidXRpb25DYXBzWzBdLnN1Yih0aGlzLmJhbGFuY2UpOwogICAgfSBlbHNlIHsKICAgICAgcmVtYWluaW5nID0gMDsKICAgIH0KICAgIHJldHVybiAoY29udHJpYnV0aW9uQ2Fwc1swXSx0aGlzLmJhbGFuY2UscmVtYWluaW5nKTsKICB9CiAgCiAgLy8gVGhpcyBjYWxsYWJsZSBmdW5jdGlvbiByZXR1cm5zIHRoZSBiYWxhbmNlLCBjb250cmlidXRpb24gY2FwLCBhbmQgcmVtYWluaW5nIGF2YWlsYWJsZSBiYWxhbmNlIG9mIGFueSBjb250cmlidXRvci4KICBmdW5jdGlvbiBjaGVja0NvbnRyaWJ1dG9yQmFsYW5jZSAoYWRkcmVzcyBhZGRyKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50IGJhbGFuY2UsIHVpbnQgY2FwLCB1aW50IHJlbWFpbmluZykgewogICAgdmFyIGMgPSB3aGl0ZWxpc3RbYWRkcl07CiAgICBpZiAoIWMuYXV0aG9yaXplZCkgewogICAgICBjYXAgPSB3aGl0ZWxpc3RDb250cmFjdC5jaGVja01lbWJlckxldmVsKGFkZHIpOwogICAgICBpZiAoY2FwID09IDApIHJldHVybiAoMCwwLDApOwogICAgfSBlbHNlIHsKICAgICAgY2FwID0gYy5jYXA7CiAgICB9CiAgICBiYWxhbmNlID0gYy5iYWxhbmNlOwogICAgaWYgKGNvbnRyYWN0U3RhZ2UgPT0gMSkgewogICAgICBpZiAoY2FwPGNvbnRyaWJ1dGlvbkNhcHMubGVuZ3RoKSB7CiAgICAgICAgY2FwID0gY29udHJpYnV0aW9uQ2Fwc1tjYXBdOwogICAgICB9CiAgICAgIHJlbWFpbmluZyA9IGNhcC5zdWIoYmFsYW5jZSk7CiAgICAgIGlmIChjb250cmlidXRpb25DYXBzWzBdLnN1Yih0aGlzLmJhbGFuY2UpIDwgcmVtYWluaW5nKSByZW1haW5pbmcgPSBjb250cmlidXRpb25DYXBzWzBdLnN1Yih0aGlzLmJhbGFuY2UpOwogICAgfSBlbHNlIHsKICAgICAgcmVtYWluaW5nID0gMDsKICAgIH0KICAgIHJldHVybiAoYmFsYW5jZSwgY2FwLCByZW1haW5pbmcpOwogIH0KICAKICAvLyBUaGlzIGNhbGxhYmxlIGZ1bmN0aW9uIHJldHVybnMgdGhlIHRva2VuIGJhbGFuY2UgdGhhdCBhIGNvbnRyaWJ1dG9yIGNhbiBjdXJyZW50bHkgY2xhaW0uCiAgZnVuY3Rpb24gY2hlY2tBdmFpbGFibGVUb2tlbnMgKGFkZHJlc3MgYWRkciwgYWRkcmVzcyB0b2tlbkFkZHIpIHZpZXcgcHVibGljIHJldHVybnMgKHVpbnQgdG9rZW5BbW91bnQpIHsKICAgIHZhciBjID0gd2hpdGVsaXN0W2FkZHJdOwogICAgdmFyIGQgPSBkaXN0cmlidXRpb25bdG9rZW5BZGRyXTsKICAgIGZvciAodWludCBpPWMudG9rZW5zQ2xhaW1lZFt0b2tlbkFkZHJdOyBpPGQucGN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgIHRva2VuQW1vdW50ID0gdG9rZW5BbW91bnQuYWRkKF9hcHBseVBjdChjLmJhbGFuY2UsZC5wY3RbaV0pKTsKICAgIH0KICAgIHJldHVybiB0b2tlbkFtb3VudDsKICB9CiAgCiAgLy8gVGhpcyBmdW5jdGlvbiBjbG9zZXMgZnVydGhlciBjb250cmlidXRpb25zIHRvIHRoZSBjb250cmFjdCwgYWR2YW5jaW5nIGl0IHRvIHN0YWdlIHR3by4KICAvLyBJdCBjYW4gb25seSBiZSBjYWxsZWQgYnkgdGhlIG93bmVyLiAgQWZ0ZXIgdGhpcyBjYWxsIGhhcyBiZWVuIG1hZGUsIHdoaXRlbGlzdGVkIGFkZHJlc3NlcwogIC8vIGNhbiBzdGlsbCByZW1vdmUgdGhlaXIgZXRoIGZyb20gdGhlIGNvbnRyYWN0IGJ1dCBjYW5ub3QgY29udHJpYnV0ZSBhbnkgbW9yZS4KICBmdW5jdGlvbiBjbG9zZUNvbnRyaWJ1dGlvbnMgKCkgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlIChjb250cmFjdFN0YWdlID09IDEpOwogICAgY29udHJhY3RTdGFnZSA9IDI7CiAgfQogIAogIC8vIFRoaXMgZnVuY3Rpb24gcmVvcGVucyB0aGUgY29udHJhY3QgdG8gY29udHJpYnV0aW9ucyBhbmQgZnVydGhlciB3aGl0ZWxpc3RpbmcsIHJldHVybmluZyBpdCB0byBzdGFnZSBvbmUuCiAgLy8gSXQgY2FuIG9ubHkgYmUgY2FsbGVkIGJ5IHRoZSBvd25lciBkdXJpbmcgc3RhZ2UgdHdvLgogIGZ1bmN0aW9uIHJlb3BlbkNvbnRyaWJ1dGlvbnMgKCkgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlIChjb250cmFjdFN0YWdlID09IDIpOwogICAgY29udHJhY3RTdGFnZSA9IDE7CiAgfQogIAoKICAvLyBUaGlzIGZ1bmN0aW9uIHNlbmRzIHRoZSBwb29sZWQgZXRoIHRvIHRoZSByZWNlaXZpbmcgYWRkcmVzcywgY2FsY3VsYXRlcyB0aGUgJSBvZiB1bnVzZWQgZXRoIHRvIGJlIHJldHVybmVkLAogIC8vIGFuZCBhZHZhbmNlcyB0aGUgY29udHJhY3QgdG8gc3RhZ2UgdGhyZWUuIEl0IGNhbiBvbmx5IGJlIGNhbGxlZCBieSB0aGUgY29udHJhY3Qgb3duZXIgZHVyaW5nIHN0YWdlcyBvbmUgb3IgdHdvLgogIC8vIFRoZSBhbW91bnQgdG8gc2VuZCAoZ2l2ZW4gaW4gd2VpKSBtdXN0IGJlIHNwZWNpZmllZCBkdXJpbmcgdGhlIGNhbGwuIEFzIHRoaXMgZnVuY3Rpb24gY2FuIG9ubHkgYmUgZXhlY3V0ZWQgb25jZSwKICAvLyBpdCBpcyBWRVJZIElNUE9SVEFOVCBub3QgdG8gZ2V0IHRoZSBhbW91bnQgd3JvbmcuCiAgZnVuY3Rpb24gc3VibWl0UG9vbCAodWludCBhbW91bnRJbldlaSkgcHVibGljIG9ubHlPd25lciBub1JlZW50cmFuY3kgewogICAgcmVxdWlyZSAoY29udHJhY3RTdGFnZSA8IDMpOwogICAgcmVxdWlyZSAoY29udHJpYnV0aW9uTWluIDw9IGFtb3VudEluV2VpICYmIGFtb3VudEluV2VpIDw9IHRoaXMuYmFsYW5jZSk7CiAgICBmaW5hbEJhbGFuY2UgPSB0aGlzLmJhbGFuY2U7CiAgICByZXF1aXJlIChyZWNlaXZlckFkZHJlc3MuY2FsbC52YWx1ZShhbW91bnRJbldlaSkuZ2FzKG1zZy5nYXMuc3ViKDUwMDApKSgpKTsKICAgIGV0aFJlZnVuZEFtb3VudC5wdXNoKHRoaXMuYmFsYW5jZSk7CiAgICBjb250cmFjdFN0YWdlID0gMzsKICB9CiAgCiAgLy8gVGhpcyBmdW5jdGlvbiBvcGVucyB0aGUgY29udHJhY3QgdXAgZm9yIHRva2VuIHdpdGhkcmF3YWxzLgogIC8vIEl0IGNhbiBvbmx5IGJlIGNhbGxlZCBieSB0aGUgb3duZXIgZHVyaW5nIHN0YWdlIDMuICBUaGUgb3duZXIgc3BlY2lmaWVzIHRoZSBhZGRyZXNzIG9mIGFuIEVSQzIwIHRva2VuCiAgLy8gY29udHJhY3QgdGhhdCB0aGlzIGNvbnRyYWN0IGhhcyBhIGJhbGFuY2UgaW4sIGFuZCBvcHRpb25hbGx5IGEgYm9vbCB0byBwcmV2ZW50IHRoaXMgdG9rZW4gZnJvbSBiZWluZwogIC8vIHRoZSBkZWZhdWx0IHdpdGhkcmF3YWwgKGluIHRoZSBldmVudCBvZiBhbiBhaXJkcm9wLCBmb3IgZXhhbXBsZSkuCiAgLy8gVGhlIGZ1bmN0aW9uIGNhbiBvbmx5IGJlIGNhbGxlZCBpZiB0aGVyZSBpcyBub3QgY3VycmVudGx5IGEgdG9rZW4gZGlzdHJpYnV0aW9uIAogIGZ1bmN0aW9uIGVuYWJsZVRva2VuV2l0aGRyYXdhbHMgKGFkZHJlc3MgdG9rZW5BZGRyLCBib29sIG5vdERlZmF1bHQpIHB1YmxpYyBvbmx5T3duZXIgbm9SZWVudHJhbmN5IHsKICAgIHJlcXVpcmUgKGNvbnRyYWN0U3RhZ2UgPT0gMyk7CiAgICBpZiAobm90RGVmYXVsdCkgewogICAgICByZXF1aXJlIChhY3RpdmVUb2tlbiAhPSAweDAwKTsKICAgIH0gZWxzZSB7CiAgICAgIGFjdGl2ZVRva2VuID0gdG9rZW5BZGRyOwogICAgfQogICAgdmFyIGQgPSBkaXN0cmlidXRpb25bdG9rZW5BZGRyXTsgICAgCiAgICBpZiAoZC5wY3QubGVuZ3RoPT0wKSBkLnRva2VuID0gRVJDMjAodG9rZW5BZGRyKTsKICAgIHVpbnQgYW1vdW50ID0gZC50b2tlbi5iYWxhbmNlT2YodGhpcykuc3ViKGQuYmFsYW5jZVJlbWFpbmluZyk7CiAgICByZXF1aXJlIChhbW91bnQgPiAwKTsKICAgIGlmIChmZWVQY3QgPiAwKSB7CiAgICAgIHJlcXVpcmUgKGQudG9rZW4udHJhbnNmZXIob3duZXIsX2FwcGx5UGN0KGFtb3VudCxmZWVQY3QpKSk7CiAgICB9CiAgICBhbW91bnQgPSBkLnRva2VuLmJhbGFuY2VPZih0aGlzKS5zdWIoZC5iYWxhbmNlUmVtYWluaW5nKTsKICAgIGQuYmFsYW5jZVJlbWFpbmluZyA9IGQudG9rZW4uYmFsYW5jZU9mKHRoaXMpOwogICAgZC5wY3QucHVzaChfdG9QY3QoYW1vdW50LGZpbmFsQmFsYW5jZSkpOwogIH0KICAKICAvLyBUaGlzIGlzIGEgc3RhbmRhcmQgZnVuY3Rpb24gcmVxdWlyZWQgZm9yIEVSQzIyMyBjb21wYXRpYmlsaXR5LgogIGZ1bmN0aW9uIHRva2VuRmFsbGJhY2sgKGFkZHJlc3MgZnJvbSwgdWludCB2YWx1ZSwgYnl0ZXMgZGF0YSkgcHVibGljIHsKICAgIEVSQzIyM1JlY2VpdmVkIChmcm9tLCB2YWx1ZSk7CiAgfQogIAp9'.
	

]
