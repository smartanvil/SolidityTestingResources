Class {
	#name : #SRT2abb88d483ec7c4f5ae078670f156434a5129f40,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT2abb88d483ec7c4f5ae078670f156434a5129f40 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7Cgpjb250cmFjdCBBZG1pbiB7CgogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIEFkbWluTGlzdDsKICAgIHVpbnQyNTYgcHVibGljIENsYWltQW1vdW50ID0gMzUwMDAwMDAwMDAwMDAwMDAwMDAwOwogICAgdWludDI1NiBwdWJsaWMgQ2xhaW1lZEFtb3VudCA9IDA7CgogICAgZXZlbnQgQWRtaW5pc3RyYXRvckFkZGVkKGFkZHJlc3MgaW5kZXhlZCBfaW52b2tlciwgYWRkcmVzcyBpbmRleGVkIF9uZXdBZG1pbmlzdHJhdG9yKTsKICAgIGV2ZW50IEFkbWluaXN0cmF0b3JSZW1vdmVkKGFkZHJlc3MgaW5kZXhlZCBfaW52b2tlciwgYWRkcmVzcyBpbmRleGVkIF9yZW1vdmVkQWRtaW5pc3RyYXRvcik7CiAgICBldmVudCBPd25lcnNoaXBDaGFuZ2VkKGFkZHJlc3MgaW5kZXhlZCBfaW52b2tlciwgYWRkcmVzcyBpbmRleGVkIF9uZXdPd25lcik7CgogICAgZnVuY3Rpb24gQWRtaW4oKSBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICBtb2RpZmllciBPbmx5QWRtaW4oKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyIHx8IEFkbWluTGlzdFttc2cuc2VuZGVyXSA9PSB0cnVlKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIE9ubHlPd25lcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CiAgICAKICAgIG1vZGlmaWVyIEFpcmRyb3BTdGF0dXMoKSB7CiAgICAgICAgcmVxdWlyZShDbGFpbUFtb3VudCAhPSAwKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIE1ha2VBZG1pbmlzdHJhdG9yKGFkZHJlc3MgQWRkcmVzc1RvQWRkKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CgogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgcmVxdWlyZShBZGRyZXNzVG9BZGQgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgQWRtaW5MaXN0W0FkZHJlc3NUb0FkZF0gPSB0cnVlOwogICAgICAgIEFkbWluaXN0cmF0b3JBZGRlZChtc2cuc2VuZGVyLCBBZGRyZXNzVG9BZGQpOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICB9CgogICAgZnVuY3Rpb24gUmVtb3ZlQWRtaW5pc3RyYXRvcihhZGRyZXNzIEFkZHJlc3NUb1JlbW92ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewoKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIHJlcXVpcmUoQWRkcmVzc1RvUmVtb3ZlICE9IGFkZHJlc3MoMCkpOwogICAgICAgIGRlbGV0ZSBBZG1pbkxpc3RbQWRkcmVzc1RvUmVtb3ZlXTsKICAgICAgICBBZG1pbmlzdHJhdG9yUmVtb3ZlZChtc2cuc2VuZGVyLCBBZGRyZXNzVG9SZW1vdmUpOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICB9CgogICAgZnVuY3Rpb24gQ2hhbmdlT3duZXIoYWRkcmVzcyBBZGRyZXNzVG9NYWtlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CgogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgcmVxdWlyZShBZGRyZXNzVG9NYWtlICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUob3duZXIgIT0gQWRkcmVzc1RvTWFrZSk7CiAgICAgICAgb3duZXIgPSBBZGRyZXNzVG9NYWtlOwogICAgICAgIE93bmVyc2hpcENoYW5nZWQobXNnLnNlbmRlciwgQWRkcmVzc1RvTWFrZSk7CgogICAgICAgIHJldHVybiB0cnVlOwoKICAgIH0KCiAgICBmdW5jdGlvbiBDaGFuZ2VDbGFpbUFtb3VudCh1aW50MjU2IE5ld0Ftb3VudCkgcHVibGljIE9ubHlBZG1pbigpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewoKICAgICAgICBDbGFpbUFtb3VudCA9IE5ld0Ftb3VudDsKICAgICAgICAKICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICB9Cgp9Cgpjb250cmFjdCBLb3ZlcmVkUGF5IGlzIEFkbWluIHsKCiAgICBieXRlczQgcHVibGljIHN5bWJvbCA9ICJLVlAiOwogICAgYnl0ZXMxNiBwdWJsaWMgbmFtZSA9ICJLb3ZlcmVkUGF5IjsKICAgIHVpbnQ4IHB1YmxpYyBkZWNpbWFscyA9IDE4OwogICAgdWludDI1NiBjb25zdGFudCBUb3RhbFN1cHBseSA9IDUwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwOwoKICAgIGJvb2wgcHVibGljIFRyYW5zZmVyc0VuYWJsZWQ7CiAgICB1aW50MjU2IHB1YmxpYyBUcnVzdGxlc3NUcmFuc2FjdGlvbnNfVHJhbnNhY3Rpb25IZWlnaHQgPSAwOwogICAgdWludDI1NiBwdWJsaWMgTWVkaWF0ZWRUcmFuc2FjdGlvbnNfVHJhbnNhY3Rpb25IZWlnaHQgPSAwOwogICAgdWludDEyOCBwdWJsaWMgVHJ1c3RsZXNzVHJhbnNhY3Rpb25fUHJvdGVjdGlvbl9TZWNvbmRzID0gMjU5MjAwOwogICAgdWludDEyOCBwdWJsaWMgTWVkaWF0ZWRUcmFuc2FjdGlvbl9Qcm90ZWN0aW9uX1NlY29uZHMgPSAyNjIwODAwOwogICAgYWRkcmVzcyBwdWJsaWMgSW5pdGlhbE93bmVyQWRkcmVzcyA9IGFkZHJlc3MoMCk7CiAgICBhZGRyZXNzIHB1YmxpYyBDb3JlTWVkaWF0b3IgPSBhZGRyZXNzKDApOwogICAgdWludDI1NiBwdWJsaWMgTWVkaWF0b3JGZWVzID0gMDsKICAgIHVpbnQyNTYgcHVibGljIExvY2tJbkV4cGlyeSA9IDA7CgogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBVc2VyQmFsYW5jZXM7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpKSBwdWJsaWMgQWxsb3dhbmNlOwoKICAgIHN0cnVjdCBUcnVzdGxlc3NUcmFuc2FjdGlvbiB7CiAgICAgICAgYWRkcmVzcyBfc2VuZGVyOwogICAgICAgIGFkZHJlc3MgX3JlY2VpdmVyOwogICAgICAgIHVpbnQyNTYgX2t2cF9hbW91bnQ7CiAgICAgICAgYm9vbCBfc3RhdHVzTW9kaWZpZWQ7CiAgICAgICAgYm9vbCBfY3JlZGl0ZWQ7CiAgICAgICAgYm9vbCBfcmVmdW5kZWQ7CiAgICAgICAgdWludDI1NiBfdGltZTsKICAgIH0KCiAgICBzdHJ1Y3QgTWVkaWF0ZWRUcmFuc2FjdGlvbiB7CiAgICAgICAgYWRkcmVzcyBfc2VuZGVyOwogICAgICAgIGFkZHJlc3MgX3JlY2VpdmVyOwogICAgICAgIGJvb2wgX21lZGlhdG9yOwogICAgICAgIHVpbnQyNTYgX2t2cF9hbW91bnQ7CiAgICAgICAgdWludDI1NiBfZmVlX2Ftb3VudDsKICAgICAgICBib29sIF9zYXRpc2ZhY3Rpb247CiAgICAgICAgYm9vbCBfc3RhdHVzTW9kaWZpZWQ7CiAgICAgICAgYm9vbCBfY3JlZGl0ZWQ7CiAgICAgICAgdWludDI1NiBfdGltZTsKICAgIH0KCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIENsYWltczsKICAgIG1hcHBpbmcodWludDI1NiA9PiBUcnVzdGxlc3NUcmFuc2FjdGlvbikgcHVibGljIFRydXN0bGVzc1RyYW5zYWN0aW9uc19Mb2c7CiAgICBtYXBwaW5nKHVpbnQyNTYgPT4gTWVkaWF0ZWRUcmFuc2FjdGlvbikgcHVibGljIE1lZGlhdGVkVHJhbnNhY3Rpb25zX0xvZzsKCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsKICAgIGV2ZW50IFRydXN0bGVzc19UcmFuc2Zlcih1aW50MjU2IF9pZCwgYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CiAgICBldmVudCBNZWRpYXRlZF9UcmFuc2Zlcih1aW50MjU2IF9pZCwgYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CiAgICBldmVudCBUcnVzdGxlc3NUcmFuc2ZlclN0YXR1c01vZGlmaWVkKHVpbnQyNTYgX3RyYW5zYWN0aW9uSWQsIGJvb2wgX25ld1N0YXR1cyk7CiAgICBldmVudCBNZWRpYXRlZFRyYW5zZmVyU3RhdHVzTW9kaWZpZWQodWludDI1NiBfdHJhbnNhY3Rpb25JZCwgYm9vbCBfbmV3U3RhdHVzKTsKICAgIGV2ZW50IFRydXN0bGVzc1RyYW5zYWN0aW9uX1JlZnVuZGVkKHVpbnQyNTYgX3RyYW5zYWN0aW9uSWQsIHVpbnQyNTYgX2Ftb3VudCk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKCiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgICAgIHJlcXVpcmUoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXF1aXJlKGIgPD0gYSk7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSArIGI7CiAgICAgICAgcmVxdWlyZShjID49IGEpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIEtvdmVyZWRQYXkoKSBwdWJsaWMgewoKICAgICAgICBVc2VyQmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBUb3RhbFN1cHBseTsKICAgICAgICBDb3JlTWVkaWF0b3IgPSBtc2cuc2VuZGVyOwogICAgICAgIEluaXRpYWxPd25lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIExvY2tJbkV4cGlyeSA9IGFkZChibG9jay50aW1lc3RhbXAsIDE1Nzc4NDYzKTsKICAgICAgICBUcmFuc2ZlcnNFbmFibGVkID0gdHJ1ZTsKCiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIEFpcmRyb3BDbGFpbSgpIHB1YmxpYyBBaXJkcm9wU3RhdHVzIHJldHVybnMgKHVpbnQyNTYgQW1vdW50Q2xhaW1lZCkgewogICAgICAgIAogICAgICAgIHJlcXVpcmUoQ2xhaW1zW21zZy5zZW5kZXJdID09IGZhbHNlKTsKICAgICAgICByZXF1aXJlKENsYWltZWRBbW91bnQgPCAzNTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCk7ICAgCiAgICAgICAgcmVxdWlyZShUcmFuc2ZlclZhbGlkYXRpb24ob3duZXIsIG1zZy5zZW5kZXIsIENsYWltQW1vdW50KSA9PSB0cnVlKTsKICAgICAgICBDbGFpbWVkQW1vdW50ID0gQ2xhaW1lZEFtb3VudCArIENsYWltQW1vdW50OwogICAgICAgIFVzZXJCYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGFkZChVc2VyQmFsYW5jZXNbbXNnLnNlbmRlcl0sIENsYWltQW1vdW50KTsKICAgICAgICBVc2VyQmFsYW5jZXNbb3duZXJdID0gc3ViKFVzZXJCYWxhbmNlc1tvd25lcl0sIENsYWltQW1vdW50KTsKICAgICAgICBDbGFpbXNbbXNnLnNlbmRlcl0gPSB0cnVlOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIG93bmVyLCBDbGFpbUFtb3VudCk7CgogICAgICAgIHJldHVybiBDbGFpbUFtb3VudDsKICAgICAgICAKICAgIH0KCiAgICBmdW5jdGlvbiBBbHRlck1lZGlhdG9yU2V0dGluZ3MoYWRkcmVzcyBfbmV3QWRkcmVzcywgdWludDEyOCBfZmVlcykgcHVibGljIE9ubHlBZG1pbiByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKCiAgICAgICAgQ29yZU1lZGlhdG9yID0gX25ld0FkZHJlc3M7CiAgICAgICAgTWVkaWF0b3JGZWVzID0gX2ZlZXM7CgogICAgICAgIHJldHVybiB0cnVlOwoKICAgIH0KCiAgICBmdW5jdGlvbiBDaGFuZ2VQcm90ZWN0aW9uVGltZSh1aW50IF90eXBlLCB1aW50MTI4IF9zZWNvbmRzKSBwdWJsaWMgT25seUFkbWluIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewoKICAgICAgICBpZiAoX3R5cGUgPT0gMSkgewogICAgICAgICAgICBUcnVzdGxlc3NUcmFuc2FjdGlvbl9Qcm90ZWN0aW9uX1NlY29uZHMgPSBfc2Vjb25kczsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBNZWRpYXRlZFRyYW5zYWN0aW9uX1Byb3RlY3Rpb25fU2Vjb25kcyA9IF9zZWNvbmRzOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRydWU7CgogICAgfQoKICAgIGZ1bmN0aW9uIFRyYW5zZmVyU3RhdHVzKGJvb2wgX25ld1N0YXR1cykgcHVibGljIE9ubHlBZG1pbiByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKCiAgICAgICAgVHJhbnNmZXJzRW5hYmxlZCA9IF9uZXdTdGF0dXM7CgogICAgICAgIHJldHVybiB0cnVlOwoKICAgIH0KCiAgICBmdW5jdGlvbiBUcmFuc2ZlclZhbGlkYXRpb24oYWRkcmVzcyBzZW5kZXIsIGFkZHJlc3MgcmVjaXBpZW50LCB1aW50MjU2IGFtb3VudCkgcHJpdmF0ZSB2aWV3IHJldHVybnMgKGJvb2wgc3VjY2VzcykgewoKICAgICAgICByZXF1aXJlKFRyYW5zZmVyc0VuYWJsZWQgPT0gdHJ1ZSk7CiAgICAgICAgcmVxdWlyZShhbW91bnQgPiAwKTsKICAgICAgICByZXF1aXJlKHJlY2lwaWVudCAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKFVzZXJCYWxhbmNlc1tzZW5kZXJdID49IGFtb3VudCk7CiAgICAgICAgcmVxdWlyZShzdWIoVXNlckJhbGFuY2VzW3NlbmRlcl0sIGFtb3VudCkgPj0gMCk7CiAgICAgICAgcmVxdWlyZShhZGQoVXNlckJhbGFuY2VzW3JlY2lwaWVudF0sIGFtb3VudCkgPiBVc2VyQmFsYW5jZXNbcmVjaXBpZW50XSk7CgogICAgICAgIGlmIChzZW5kZXIgPT0gSW5pdGlhbE93bmVyQWRkcmVzcyAmJiBibG9jay50aW1lc3RhbXAgPCBMb2NrSW5FeHBpcnkpIHsKICAgICAgICAgICAgcmVxdWlyZShzdWIoVXNlckJhbGFuY2VzW3NlbmRlcl0sIGFtb3VudCkgPj0gMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDApOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRydWU7CgogICAgfQoKICAgIGZ1bmN0aW9uIE11bHRpVHJhbnNmZXIoYWRkcmVzc1tdIF9kZXN0aW5hdGlvbnMsIHVpbnQyNTZbXSBfdmFsdWVzKSBwdWJsaWMgcmV0dXJucyAodWludDI1NikgewoKICAgICAgICB1aW50MjU2IGkgPSAwOwoKICAgICAgICB3aGlsZSAoaSA8IF9kZXN0aW5hdGlvbnMubGVuZ3RoKSB7CiAgICAgICAgICAgIHRyYW5zZmVyKF9kZXN0aW5hdGlvbnNbaV0sIF92YWx1ZXNbaV0pOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gKGkpOwoKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHJlY2VpdmVyLCB1aW50MjU2IGFtb3VudCkgcHVibGljIHJldHVybnMgKGJvb2wgX3N0YXR1cykgewoKICAgICAgICByZXF1aXJlKFRyYW5zZmVyVmFsaWRhdGlvbihtc2cuc2VuZGVyLCByZWNlaXZlciwgYW1vdW50KSk7CiAgICAgICAgVXNlckJhbGFuY2VzW21zZy5zZW5kZXJdID0gc3ViKFVzZXJCYWxhbmNlc1ttc2cuc2VuZGVyXSwgYW1vdW50KTsKICAgICAgICBVc2VyQmFsYW5jZXNbcmVjZWl2ZXJdID0gYWRkKFVzZXJCYWxhbmNlc1tyZWNlaXZlcl0sIGFtb3VudCk7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgcmVjZWl2ZXIsIGFtb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CgogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfcmVjZWl2ZXIsIHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIHJldHVybnMgKGJvb2wgX3N0YXR1cykgewoKICAgICAgICByZXF1aXJlKFRyYW5zZmVyVmFsaWRhdGlvbihfb3duZXIsIF9yZWNlaXZlciwgX2Ftb3VudCkpOwogICAgICAgIHJlcXVpcmUoc3ViKEFsbG93YW5jZVtfb3duZXJdW21zZy5zZW5kZXJdLCBfYW1vdW50KSA+PSAwKTsKICAgICAgICBBbGxvd2FuY2VbX293bmVyXVttc2cuc2VuZGVyXSA9IHN1YihBbGxvd2FuY2VbX293bmVyXVttc2cuc2VuZGVyXSwgX2Ftb3VudCk7CiAgICAgICAgVXNlckJhbGFuY2VzW19vd25lcl0gPSBzdWIoVXNlckJhbGFuY2VzW19vd25lcl0sIF9hbW91bnQpOwogICAgICAgIFVzZXJCYWxhbmNlc1tfcmVjZWl2ZXJdID0gYWRkKFVzZXJCYWxhbmNlc1tfcmVjZWl2ZXJdLCBfYW1vdW50KTsKICAgICAgICBUcmFuc2Zlcihfb3duZXIsIF9yZWNlaXZlciwgX2Ftb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CgogICAgfQoKICAgIGZ1bmN0aW9uIFNlbmRfVHJ1c3RsZXNzVHJhbnNhY3Rpb24oYWRkcmVzcyByZWNlaXZlciwgdWludDI1NiBhbW91bnQpIHB1YmxpYyByZXR1cm5zICh1aW50MjU2IHRyYW5zZmVySWQpIHsKCiAgICAgICAgcmVxdWlyZShUcmFuc2ZlclZhbGlkYXRpb24obXNnLnNlbmRlciwgcmVjZWl2ZXIsIGFtb3VudCkpOwogICAgICAgIFVzZXJCYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHN1YihVc2VyQmFsYW5jZXNbbXNnLnNlbmRlcl0sIGFtb3VudCk7CiAgICAgICAgVHJ1c3RsZXNzVHJhbnNhY3Rpb25zX1RyYW5zYWN0aW9uSGVpZ2h0ID0gVHJ1c3RsZXNzVHJhbnNhY3Rpb25zX1RyYW5zYWN0aW9uSGVpZ2h0ICsgMTsKICAgICAgICBUcnVzdGxlc3NUcmFuc2FjdGlvbnNfTG9nW1RydXN0bGVzc1RyYW5zYWN0aW9uc19UcmFuc2FjdGlvbkhlaWdodF0gPSBUcnVzdGxlc3NUcmFuc2FjdGlvbihtc2cuc2VuZGVyLCByZWNlaXZlciwgYW1vdW50LCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBibG9jay50aW1lc3RhbXApOwogICAgICAgIFRydXN0bGVzc19UcmFuc2ZlcihUcnVzdGxlc3NUcmFuc2FjdGlvbnNfVHJhbnNhY3Rpb25IZWlnaHQsIG1zZy5zZW5kZXIsIHJlY2VpdmVyLCBhbW91bnQpOwogICAgICAgIHJldHVybiBUcnVzdGxlc3NUcmFuc2FjdGlvbnNfVHJhbnNhY3Rpb25IZWlnaHQ7CgogICAgfQoKICAgIGZ1bmN0aW9uIFNlbmRfTWVkaWF0ZWRUcmFuc2FjdGlvbihhZGRyZXNzIHJlY2VpdmVyLCB1aW50MjU2IGFtb3VudCkgcHVibGljIHJldHVybnMgKHVpbnQyNTYgdHJhbnNmZXJJZCkgewoKICAgICAgICByZXF1aXJlKFRyYW5zZmVyVmFsaWRhdGlvbihtc2cuc2VuZGVyLCByZWNlaXZlciwgYW1vdW50KSk7CiAgICAgICAgVXNlckJhbGFuY2VzW21zZy5zZW5kZXJdID0gc3ViKFVzZXJCYWxhbmNlc1ttc2cuc2VuZGVyXSwgYW1vdW50KTsKICAgICAgICBNZWRpYXRlZFRyYW5zYWN0aW9uc19UcmFuc2FjdGlvbkhlaWdodCA9IE1lZGlhdGVkVHJhbnNhY3Rpb25zX1RyYW5zYWN0aW9uSGVpZ2h0ICsgMTsKICAgICAgICBNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbTWVkaWF0ZWRUcmFuc2FjdGlvbnNfVHJhbnNhY3Rpb25IZWlnaHRdID0gTWVkaWF0ZWRUcmFuc2FjdGlvbihtc2cuc2VuZGVyLCByZWNlaXZlciwgZmFsc2UsIGFtb3VudCwgMCwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgYmxvY2sudGltZXN0YW1wKTsKICAgICAgICBNZWRpYXRlZF9UcmFuc2ZlcihNZWRpYXRlZFRyYW5zYWN0aW9uc19UcmFuc2FjdGlvbkhlaWdodCwgbXNnLnNlbmRlciwgcmVjZWl2ZXIsIGFtb3VudCk7CiAgICAgICAgcmV0dXJuIE1lZGlhdGVkVHJhbnNhY3Rpb25zX1RyYW5zYWN0aW9uSGVpZ2h0OwoKICAgIH0KCiAgICBmdW5jdGlvbiBBcHBvaW50X01lZGlhdG9yKHVpbnQyNTYgX3R4aWQpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKCiAgICAgICAgaWYgKE1lZGlhdGVkVHJhbnNhY3Rpb25zX0xvZ1tfdHhpZF0uX3NlbmRlciA9PSBtc2cuc2VuZGVyIHx8IE1lZGlhdGVkVHJhbnNhY3Rpb25zX0xvZ1tfdHhpZF0uX3JlY2VpdmVyID09IG1zZy5zZW5kZXIpIHsKCiAgICAgICAgICAgIHVpbnQyNTYgc2VudF9vbiA9IE1lZGlhdGVkVHJhbnNhY3Rpb25zX0xvZ1tfdHhpZF0uX3RpbWU7CiAgICAgICAgICAgIHVpbnQyNTYgcmlnaHRfbm93ID0gYmxvY2sudGltZXN0YW1wOwogICAgICAgICAgICB1aW50MjU2IGRpZmZlcmVuY2UgPSBzdWIocmlnaHRfbm93LCBzZW50X29uKTsKCiAgICAgICAgICAgIHJlcXVpcmUoTWVkaWF0ZWRUcmFuc2FjdGlvbnNfTG9nW190eGlkXS5fbWVkaWF0b3IgPT0gZmFsc2UpOwogICAgICAgICAgICByZXF1aXJlKE1lZGlhdGVkVHJhbnNhY3Rpb25zX0xvZ1tfdHhpZF0uX3NhdGlzZmFjdGlvbiA9PSBmYWxzZSk7CiAgICAgICAgICAgIHJlcXVpcmUoTWVkaWF0ZWRUcmFuc2FjdGlvbnNfTG9nW190eGlkXS5fc3RhdHVzTW9kaWZpZWQgPT0gZmFsc2UpOwogICAgICAgICAgICByZXF1aXJlKGRpZmZlcmVuY2UgPD0gTWVkaWF0ZWRUcmFuc2FjdGlvbl9Qcm90ZWN0aW9uX1NlY29uZHMpOwogICAgICAgICAgICByZXF1aXJlKE1lZGlhdGVkVHJhbnNhY3Rpb25zX0xvZ1tfdHhpZF0uX2NyZWRpdGVkID09IGZhbHNlKTsKICAgICAgICAgICAgcmVxdWlyZShNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3R4aWRdLl9rdnBfYW1vdW50ID49IE1lZGlhdG9yRmVlcyk7CgogICAgICAgICAgICBNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3R4aWRdLl9tZWRpYXRvciA9IHRydWU7CiAgICAgICAgICAgIE1lZGlhdGVkVHJhbnNhY3Rpb25zX0xvZ1tfdHhpZF0uX2ZlZV9hbW91bnQgPSBNZWRpYXRvckZlZXM7CgogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgfQoKICAgIH0KCiAgICBmdW5jdGlvbiBBbHRlcl9UcnVzdGxlc3NUcmFuc2FjdGlvbih1aW50MjU2IF90cmFuc2FjdGlvbklkLCBib29sIF9uZXdTdGF0dXMpIHB1YmxpYyByZXR1cm5zIChib29sIF9yZXNwb25zZSkgewoKICAgICAgICB1aW50MjU2IHNlbnRfb24gPSBUcnVzdGxlc3NUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fdGltZTsKICAgICAgICB1aW50MjU2IHJpZ2h0X25vdyA9IGJsb2NrLnRpbWVzdGFtcDsKICAgICAgICB1aW50MjU2IGRpZmZlcmVuY2UgPSBzdWIocmlnaHRfbm93LCBzZW50X29uKTsKCiAgICAgICAgcmVxdWlyZShUcmFuc2ZlcnNFbmFibGVkID09IHRydWUpOwogICAgICAgIHJlcXVpcmUoVHJ1c3RsZXNzVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX3N0YXR1c01vZGlmaWVkID09IGZhbHNlKTsKICAgICAgICByZXF1aXJlKGRpZmZlcmVuY2UgPD0gVHJ1c3RsZXNzVHJhbnNhY3Rpb25fUHJvdGVjdGlvbl9TZWNvbmRzKTsKICAgICAgICByZXF1aXJlKFRydXN0bGVzc1RyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9zZW5kZXIgPT0gbXNnLnNlbmRlcik7CiAgICAgICAgcmVxdWlyZShUcnVzdGxlc3NUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fcmVmdW5kZWQgPT0gZmFsc2UpOwogICAgICAgIHJlcXVpcmUoVHJ1c3RsZXNzVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX2NyZWRpdGVkID09IGZhbHNlKTsKCiAgICAgICAgaWYgKF9uZXdTdGF0dXMgPT0gdHJ1ZSkgewoKICAgICAgICAgICAgVXNlckJhbGFuY2VzW1RydXN0bGVzc1RyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9yZWNlaXZlcl0gPSBhZGQoVXNlckJhbGFuY2VzW1RydXN0bGVzc1RyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9yZWNlaXZlcl0sIFRydXN0bGVzc1RyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9rdnBfYW1vdW50KTsKICAgICAgICAgICAgVHJ1c3RsZXNzVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX2NyZWRpdGVkID0gdHJ1ZTsKCiAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgIFVzZXJCYWxhbmNlc1tUcnVzdGxlc3NUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fc2VuZGVyXSA9IGFkZChVc2VyQmFsYW5jZXNbVHJ1c3RsZXNzVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX3NlbmRlcl0sIFRydXN0bGVzc1RyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9rdnBfYW1vdW50KTsKCiAgICAgICAgfQoKICAgICAgICBUcnVzdGxlc3NUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fc3RhdHVzTW9kaWZpZWQgPSB0cnVlOwogICAgICAgIFRydXN0bGVzc1RyYW5zZmVyU3RhdHVzTW9kaWZpZWQoX3RyYW5zYWN0aW9uSWQsIF9uZXdTdGF0dXMpOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICB9CgogICAgZnVuY3Rpb24gQWx0ZXJfTWVkaWF0ZWRUcmFuc2FjdGlvbih1aW50MjU2IF90cmFuc2FjdGlvbklkLCBib29sIF9uZXdTdGF0dXMpIHB1YmxpYyByZXR1cm5zIChib29sIF9yZXNwb25zZSkgewoKICAgICAgICByZXF1aXJlKFRyYW5zZmVyc0VuYWJsZWQgPT0gdHJ1ZSk7CiAgICAgICAgcmVxdWlyZShNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9tZWRpYXRvciA9PSB0cnVlKTsKICAgICAgICByZXF1aXJlKE1lZGlhdGVkVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX3N0YXR1c01vZGlmaWVkID09IGZhbHNlKTsKICAgICAgICByZXF1aXJlKENvcmVNZWRpYXRvciA9PSBtc2cuc2VuZGVyKTsKICAgICAgICByZXF1aXJlKE1lZGlhdGVkVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX2NyZWRpdGVkID09IGZhbHNlKTsKCiAgICAgICAgdWludDI1NiBuZXdBbW91bnQgPSBzdWIoTWVkaWF0ZWRUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fa3ZwX2Ftb3VudCwgTWVkaWF0ZWRUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fZmVlX2Ftb3VudCk7CgogICAgICAgIGlmIChuZXdBbW91bnQgPCAwKSB7CiAgICAgICAgICAgIG5ld0Ftb3VudCA9IDA7CiAgICAgICAgfQoKICAgICAgICBpZiAoX25ld1N0YXR1cyA9PSB0cnVlKSB7CgogICAgICAgICAgICBVc2VyQmFsYW5jZXNbTWVkaWF0ZWRUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fcmVjZWl2ZXJdID0gYWRkKFVzZXJCYWxhbmNlc1tNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9yZWNlaXZlcl0sIG5ld0Ftb3VudCk7CiAgICAgICAgICAgIE1lZGlhdGVkVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX2NyZWRpdGVkID0gdHJ1ZTsKCiAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgIFVzZXJCYWxhbmNlc1tNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9zZW5kZXJdID0gYWRkKFVzZXJCYWxhbmNlc1tNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9zZW5kZXJdLCBuZXdBbW91bnQpOwoKICAgICAgICB9CgogICAgICAgIFVzZXJCYWxhbmNlc1tDb3JlTWVkaWF0b3JdID0gYWRkKFVzZXJCYWxhbmNlc1tDb3JlTWVkaWF0b3JdLCBNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9mZWVfYW1vdW50KTsKCiAgICAgICAgTWVkaWF0ZWRUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fc3RhdHVzTW9kaWZpZWQgPSB0cnVlOwogICAgICAgIE1lZGlhdGVkVHJhbnNmZXJTdGF0dXNNb2RpZmllZChfdHJhbnNhY3Rpb25JZCwgX25ld1N0YXR1cyk7CgogICAgICAgIHJldHVybiB0cnVlOwoKICAgIH0KCiAgICBmdW5jdGlvbiBSZWZ1bmRfVHJ1c3RsZXNzVHJhbnNhY3Rpb24odWludDI1NiBfdHJhbnNhY3Rpb25JZCkgcHVibGljIHJldHVybnMgKGJvb2wgX3Jlc3BvbnNlKSB7CgogICAgICAgIHJlcXVpcmUoVHJhbnNmZXJzRW5hYmxlZCA9PSB0cnVlKTsKICAgICAgICByZXF1aXJlKFRydXN0bGVzc1RyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9yZWZ1bmRlZCA9PSBmYWxzZSk7CiAgICAgICAgcmVxdWlyZShUcnVzdGxlc3NUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fc3RhdHVzTW9kaWZpZWQgPT0gdHJ1ZSk7CiAgICAgICAgcmVxdWlyZShUcnVzdGxlc3NUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fY3JlZGl0ZWQgPT0gdHJ1ZSk7CiAgICAgICAgcmVxdWlyZShUcnVzdGxlc3NUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fcmVjZWl2ZXIgPT0gbXNnLnNlbmRlcik7CiAgICAgICAgcmVxdWlyZShUcmFuc2ZlclZhbGlkYXRpb24obXNnLnNlbmRlciwgVHJ1c3RsZXNzVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX3NlbmRlciwgVHJ1c3RsZXNzVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX2t2cF9hbW91bnQpKTsKICAgICAgICByZXF1aXJlKHN1YihVc2VyQmFsYW5jZXNbVHJ1c3RsZXNzVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX3NlbmRlcl0sIFRydXN0bGVzc1RyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9rdnBfYW1vdW50KSA+IDApOwogICAgICAgIFVzZXJCYWxhbmNlc1tUcnVzdGxlc3NUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fc2VuZGVyXSA9IGFkZChVc2VyQmFsYW5jZXNbVHJ1c3RsZXNzVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX3NlbmRlcl0sIFRydXN0bGVzc1RyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9rdnBfYW1vdW50KTsKICAgICAgICBUcnVzdGxlc3NUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fcmVmdW5kZWQgPSB0cnVlOwogICAgICAgIFRydXN0bGVzc1RyYW5zYWN0aW9uX1JlZnVuZGVkKF90cmFuc2FjdGlvbklkLCBUcnVzdGxlc3NUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fa3ZwX2Ftb3VudCk7CgogICAgICAgIHJldHVybiB0cnVlOwoKICAgIH0KCiAgICBmdW5jdGlvbiBVcGRhdGVfVHJ1c3RsZXNzVHJhbnNhY3Rpb24odWludDI1NiBfdHJhbnNhY3Rpb25JZCkgcHVibGljIHJldHVybnMgKGJvb2wgX3Jlc3BvbnNlKSB7CgogICAgICAgIHVpbnQyNTYgc2VudF9vbiA9IFRydXN0bGVzc1RyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl90aW1lOwogICAgICAgIHVpbnQyNTYgcmlnaHRfbm93ID0gYmxvY2sudGltZXN0YW1wOwogICAgICAgIHVpbnQyNTYgZGlmZmVyZW5jZSA9IHN1YihyaWdodF9ub3csIHNlbnRfb24pOwoKICAgICAgICByZXF1aXJlKFRyYW5zZmVyc0VuYWJsZWQgPT0gdHJ1ZSk7CiAgICAgICAgcmVxdWlyZShUcnVzdGxlc3NUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fc3RhdHVzTW9kaWZpZWQgPT0gZmFsc2UpOwogICAgICAgIHJlcXVpcmUoZGlmZmVyZW5jZSA+IFRydXN0bGVzc1RyYW5zYWN0aW9uX1Byb3RlY3Rpb25fU2Vjb25kcyk7CiAgICAgICAgcmVxdWlyZShUcnVzdGxlc3NUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fcmVmdW5kZWQgPT0gZmFsc2UpOwogICAgICAgIHJlcXVpcmUoVHJ1c3RsZXNzVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX2NyZWRpdGVkID09IGZhbHNlKTsKCiAgICAgICAgVXNlckJhbGFuY2VzW1RydXN0bGVzc1RyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9yZWNlaXZlcl0gPSBhZGQoVXNlckJhbGFuY2VzW1RydXN0bGVzc1RyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9yZWNlaXZlcl0sIFRydXN0bGVzc1RyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9rdnBfYW1vdW50KTsKICAgICAgICBUcnVzdGxlc3NUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fY3JlZGl0ZWQgPSB0cnVlOwogICAgICAgIFRydXN0bGVzc1RyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9zdGF0dXNNb2RpZmllZCA9IHRydWU7CiAgICAgICAgVHJ1c3RsZXNzVHJhbnNmZXJTdGF0dXNNb2RpZmllZChfdHJhbnNhY3Rpb25JZCwgdHJ1ZSk7CgogICAgICAgIHJldHVybiB0cnVlOwoKICAgIH0KCiAgICBmdW5jdGlvbiBFeHByZXNzX1NhdGlzZmFjdGlvbl9NZWRpYXRlZFRyYW5zYWN0aW9uKHVpbnQyNTYgX3RyYW5zYWN0aW9uSWQpIHB1YmxpYyByZXR1cm5zIChib29sIF9yZXNwb25zZSkgewoKICAgICAgICByZXF1aXJlKFRyYW5zZmVyc0VuYWJsZWQgPT0gdHJ1ZSk7CiAgICAgICAgcmVxdWlyZShNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9zZW5kZXIgPT0gbXNnLnNlbmRlcik7CiAgICAgICAgcmVxdWlyZShNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9tZWRpYXRvciA9PSBmYWxzZSk7CiAgICAgICAgcmVxdWlyZShNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9zdGF0dXNNb2RpZmllZCA9PSBmYWxzZSk7CiAgICAgICAgcmVxdWlyZShNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9jcmVkaXRlZCA9PSBmYWxzZSk7CiAgICAgICAgcmVxdWlyZShNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9zYXRpc2ZhY3Rpb24gPT0gZmFsc2UpOwoKICAgICAgICBVc2VyQmFsYW5jZXNbTWVkaWF0ZWRUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fcmVjZWl2ZXJdID0gYWRkKFVzZXJCYWxhbmNlc1tNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9yZWNlaXZlcl0sIE1lZGlhdGVkVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX2t2cF9hbW91bnQpOwogICAgICAgIE1lZGlhdGVkVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX2NyZWRpdGVkID0gdHJ1ZTsKICAgICAgICBNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9zdGF0dXNNb2RpZmllZCA9IHRydWU7CiAgICAgICAgTWVkaWF0ZWRUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fc2F0aXNmYWN0aW9uID0gdHJ1ZTsKICAgICAgICBNZWRpYXRlZFRyYW5zZmVyU3RhdHVzTW9kaWZpZWQoX3RyYW5zYWN0aW9uSWQsIHRydWUpOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICB9CgogICAgZnVuY3Rpb24gVXBkYXRlX01lZGlhdGVkVHJhbnNhY3Rpb24odWludDI1NiBfdHJhbnNhY3Rpb25JZCkgcHVibGljIHJldHVybnMgKGJvb2wgX3Jlc3BvbnNlKSB7CgogICAgICAgIHVpbnQyNTYgc2VudF9vbiA9IE1lZGlhdGVkVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX3RpbWU7CiAgICAgICAgdWludDI1NiByaWdodF9ub3cgPSBibG9jay50aW1lc3RhbXA7CiAgICAgICAgdWludDI1NiBkaWZmZXJlbmNlID0gc3ViKHJpZ2h0X25vdywgc2VudF9vbik7CgogICAgICAgIHJlcXVpcmUoVHJhbnNmZXJzRW5hYmxlZCA9PSB0cnVlKTsKICAgICAgICByZXF1aXJlKGRpZmZlcmVuY2UgPiBNZWRpYXRlZFRyYW5zYWN0aW9uX1Byb3RlY3Rpb25fU2Vjb25kcyk7CiAgICAgICAgcmVxdWlyZShNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9tZWRpYXRvciA9PSBmYWxzZSk7CiAgICAgICAgcmVxdWlyZShNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9zdGF0dXNNb2RpZmllZCA9PSBmYWxzZSk7CiAgICAgICAgcmVxdWlyZShNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9jcmVkaXRlZCA9PSBmYWxzZSk7CiAgICAgICAgcmVxdWlyZShNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9zYXRpc2ZhY3Rpb24gPT0gZmFsc2UpOwoKICAgICAgICBVc2VyQmFsYW5jZXNbTWVkaWF0ZWRUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fc2VuZGVyXSA9IGFkZChVc2VyQmFsYW5jZXNbTWVkaWF0ZWRUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fc2VuZGVyXSwgTWVkaWF0ZWRUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fa3ZwX2Ftb3VudCk7CgogICAgICAgIE1lZGlhdGVkVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX3N0YXR1c01vZGlmaWVkID0gdHJ1ZTsKICAgICAgICBNZWRpYXRlZFRyYW5zZmVyU3RhdHVzTW9kaWZpZWQoX3RyYW5zYWN0aW9uSWQsIGZhbHNlKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CgogICAgfQoKICAgIGZ1bmN0aW9uIFZpZXdfVHJ1c3RsZXNzVHJhbnNhY3Rpb25fSW5mbyh1aW50MjU2IF90cmFuc2FjdGlvbklkKSBwdWJsaWMgdmlldyByZXR1cm5zICgKICAgICAgICBhZGRyZXNzIF9zZW5kZXIsCiAgICAgICAgYWRkcmVzcyBfcmVjZWl2ZXIsCiAgICAgICAgdWludDI1NiBfa3ZwX2Ftb3VudCwKICAgICAgICB1aW50MjU2IF90aW1lCiAgICApIHsKCiAgICAgICAgcmV0dXJuIChUcnVzdGxlc3NUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fc2VuZGVyLCBUcnVzdGxlc3NUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fcmVjZWl2ZXIsIFRydXN0bGVzc1RyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9rdnBfYW1vdW50LCBUcnVzdGxlc3NUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fdGltZSk7CgogICAgfQoKICAgIGZ1bmN0aW9uIFZpZXdfTWVkaWF0ZWRUcmFuc2FjdGlvbl9JbmZvKHVpbnQyNTYgX3RyYW5zYWN0aW9uSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKAogICAgICAgIGFkZHJlc3MgX3NlbmRlciwKICAgICAgICBhZGRyZXNzIF9yZWNlaXZlciwKICAgICAgICB1aW50MjU2IF9rdnBfYW1vdW50LAogICAgICAgIHVpbnQyNTYgX2ZlZV9hbW91bnQsCiAgICAgICAgdWludDI1NiBfdGltZQogICAgKSB7CgogICAgICAgIHJldHVybiAoTWVkaWF0ZWRUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fc2VuZGVyLCBNZWRpYXRlZFRyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9yZWNlaXZlciwgTWVkaWF0ZWRUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fa3ZwX2Ftb3VudCwgTWVkaWF0ZWRUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fZmVlX2Ftb3VudCwgTWVkaWF0ZWRUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fdGltZSk7CgogICAgfQoKICAgIGZ1bmN0aW9uIFZpZXdfVHJ1c3RsZXNzVHJhbnNhY3Rpb25fU3RhdHVzKHVpbnQyNTYgX3RyYW5zYWN0aW9uSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKAogICAgICAgIGJvb2wgX3N0YXR1c01vZGlmaWVkLAogICAgICAgIGJvb2wgX2NyZWRpdGVkLAogICAgICAgIGJvb2wgX3JlZnVuZGVkCiAgICApIHsKCiAgICAgICAgcmV0dXJuIChUcnVzdGxlc3NUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fc3RhdHVzTW9kaWZpZWQsIFRydXN0bGVzc1RyYW5zYWN0aW9uc19Mb2dbX3RyYW5zYWN0aW9uSWRdLl9jcmVkaXRlZCwgVHJ1c3RsZXNzVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX3JlZnVuZGVkKTsKCiAgICB9CgogICAgZnVuY3Rpb24gVmlld19NZWRpYXRlZFRyYW5zYWN0aW9uX1N0YXR1cyh1aW50MjU2IF90cmFuc2FjdGlvbklkKSBwdWJsaWMgdmlldyByZXR1cm5zICgKICAgICAgICBib29sIF9zYXRpc2ZhY3Rpb24sCiAgICAgICAgYm9vbCBfc3RhdHVzTW9kaWZpZWQsCiAgICAgICAgYm9vbCBfY3JlZGl0ZWQKICAgICkgewoKICAgICAgICByZXR1cm4gKE1lZGlhdGVkVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX3NhdGlzZmFjdGlvbiwgTWVkaWF0ZWRUcmFuc2FjdGlvbnNfTG9nW190cmFuc2FjdGlvbklkXS5fc3RhdHVzTW9kaWZpZWQsIE1lZGlhdGVkVHJhbnNhY3Rpb25zX0xvZ1tfdHJhbnNhY3Rpb25JZF0uX2NyZWRpdGVkKTsKCiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgYW1vdW50KSBwdWJsaWMgcmV0dXJucyAoYm9vbCBhcHByb3ZlZCkgewogICAgICAgIEFsbG93YW5jZVttc2cuc2VuZGVyXVtzcGVuZGVyXSA9IGFtb3VudDsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBzcGVuZGVyLCBhbW91bnQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9hZGRyZXNzKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gVXNlckJhbGFuY2VzW19hZGRyZXNzXTsKICAgIH0KCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGFtb3VudF9hbGxvd2VkKSB7CiAgICAgICAgcmV0dXJuIEFsbG93YW5jZVtvd25lcl1bc3BlbmRlcl07CiAgICB9CgogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgcHVyZSByZXR1cm5zICh1aW50MjU2IF9zdXBwbHkpIHsKICAgICAgICByZXR1cm4gVG90YWxTdXBwbHk7CiAgICB9Cgp9'.
	

]
