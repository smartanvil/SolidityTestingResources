Class {
	#name : #SRTE7c31C786c5CaB6F8cb2B9E03F6f534f8c3e8C3F,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTE7c31C786c5CaB6F8cb2B9E03F6f534f8c3e8C3F >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTc7CgovKioKKiBAdGl0bGUgU2FmZU1hdGgKKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgoqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKGEgPT0gMCkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgovKioKKiBAdGl0bGUgT3duYWJsZQoqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgoqLwpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCiAgLyoqCiAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAqIGFjY291bnQuCiAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgogIC8qKgogICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKICAvKioKICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQp9CgovKioKKiBAdGl0bGUgQXV0aG9yaXphYmxlCiogQGRldiBUaGUgQXV0aG9yaXphYmxlIGNvbnRyYWN0IGhhcyBhdXRob3JpemVkIGFkZHJlc3NlcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAoqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAibXVsdGlwbGUgdXNlciBwZXJtaXNzaW9ucyIuCiovCmNvbnRyYWN0IEF1dGhvcml6YWJsZSBpcyBPd25hYmxlIHsKbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBhdXRob3JpemVkOwoKZXZlbnQgQXV0aG9yaXphdGlvblNldChhZGRyZXNzIGluZGV4ZWQgYWRkcmVzc0F1dGhvcml6ZWQsIGJvb2wgaW5kZXhlZCBhdXRob3JpemF0aW9uKTsKCi8qKgoqIEBkZXYgVGhlIEF1dGhvcml6YWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBmaXJzdCBgYXV0aG9yaXplZGAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKKiBhY2NvdW50LgoqLwpmdW5jdGlvbiBBdXRob3JpemFibGUoKSBwdWJsaWMgewogIEF1dGhvcml6YXRpb25TZXQobXNnLnNlbmRlciwgdHJ1ZSk7CiAgICBhdXRob3JpemVkW21zZy5zZW5kZXJdID0gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIGF1dGhvcml6ZWQuCiAgKi8KICBtb2RpZmllciBvbmx5QXV0aG9yaXplZCgpIHsKICAgIHJlcXVpcmUoYXV0aG9yaXplZFttc2cuc2VuZGVyXSk7CiAgICBfOwogIH0KCiAgLyoqCiAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byBzZXQgYW4gYXV0aG9yaXphdGlvbi4KICAqIEBwYXJhbSBhZGRyZXNzQXV0aG9yaXplZCBUaGUgYWRkcmVzcyB0byBjaGFuZ2UgYXV0aG9yaXphdGlvbi4KICAqLwogIGZ1bmN0aW9uIHNldEF1dGhvcml6ZWQoYWRkcmVzcyBhZGRyZXNzQXV0aG9yaXplZCwgYm9vbCBhdXRob3JpemF0aW9uKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUoYXV0aG9yaXplZFthZGRyZXNzQXV0aG9yaXplZF0gIT0gYXV0aG9yaXphdGlvbik7CiAgICBBdXRob3JpemF0aW9uU2V0KGFkZHJlc3NBdXRob3JpemVkLCBhdXRob3JpemF0aW9uKTsKICAgIGF1dGhvcml6ZWRbYWRkcmVzc0F1dGhvcml6ZWRdID0gYXV0aG9yaXphdGlvbjsKICB9Cn0KCi8qKgoqIEB0aXRsZSBXaGl0ZUxpc3QKKiBAZGV2IFRoZSBXaGl0ZUxpc3QgY29udHJhY3QgaGFzIHdoaXRlTGlzdGVkIGFkZHJlc3NlcywgYW5kIHByb3ZpZGVzIGJhc2ljIHdoaXRlTGlzdFN0YXR1cyBjb250cm9sCiogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJtdWx0aXBsZSB1c2VyIHBlcm1pc3Npb25zIi4KKi8KY29udHJhY3QgV2hpdGVMaXN0IGlzIEF1dGhvcml6YWJsZSB7CiAgbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIHdoaXRlTGlzdGVkOwoKICBldmVudCBXaGl0ZUxpc3RTZXQoYWRkcmVzcyBpbmRleGVkIGFkZHJlc3NXaGl0ZUxpc3RlZCwgYm9vbCBpbmRleGVkIHdoaXRlTGlzdFN0YXR1cyk7CgogIC8qKgogICogQGRldiBUaGUgV2hpdGVMaXN0IGNvbnN0cnVjdG9yIHNldHMgdGhlIGZpcnN0IGB3aGl0ZUxpc3RlZGAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAqIGFjY291bnQuCiAgKi8KICBmdW5jdGlvbiBXaGl0ZUxpc3QoKSBwdWJsaWMgewogICAgV2hpdGVMaXN0U2V0KG1zZy5zZW5kZXIsIHRydWUpOwogICAgd2hpdGVMaXN0ZWRbbXNnLnNlbmRlcl0gPSB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgd2hpdGVMaXN0ZWQuCiAgKi8KICBtb2RpZmllciBvbmx5V2hpdGVMaXN0ZWQoKSB7CiAgICByZXF1aXJlKHdoaXRlTGlzdGVkW21zZy5zZW5kZXJdKTsKICAgIF87CiAgfQoKICBmdW5jdGlvbiBpc1doaXRlTGlzdGVkKGFkZHJlc3MgX2FkZHJlc3MpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiB3aGl0ZUxpc3RlZFtfYWRkcmVzc107CiAgfQoKICAvKioKICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHNldCBhbiB3aGl0ZUxpc3RTdGF0dXMuCiAgKiBAcGFyYW0gYWRkcmVzc1doaXRlTGlzdGVkIFRoZSBhZGRyZXNzIHRvIGNoYW5nZSB3aGl0ZUxpc3RTdGF0dXMuCiAgKi8KICBmdW5jdGlvbiBzZXRXaGl0ZUxpc3RlZChhZGRyZXNzIGFkZHJlc3NXaGl0ZUxpc3RlZCwgYm9vbCB3aGl0ZUxpc3RTdGF0dXMpIHB1YmxpYyBvbmx5QXV0aG9yaXplZCB7CiAgICByZXF1aXJlKHdoaXRlTGlzdGVkW2FkZHJlc3NXaGl0ZUxpc3RlZF0gIT0gd2hpdGVMaXN0U3RhdHVzKTsKICAgIFdoaXRlTGlzdFNldChhZGRyZXNzV2hpdGVMaXN0ZWQsIHdoaXRlTGlzdFN0YXR1cyk7CiAgICB3aGl0ZUxpc3RlZFthZGRyZXNzV2hpdGVMaXN0ZWRdID0gd2hpdGVMaXN0U3RhdHVzOwogIH0KfQoKLyoqCiogQHRpdGxlIEVSQzIwQmFzaWMKKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5CiovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKKiBAdGl0bGUgQmFzaWMgdG9rZW4KKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgoqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogIC8qKgogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KfQoKLyoqCiogQHRpdGxlIFN0YW5kYXJkIEVSQzIwIHRva2VuCioKKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4KKiBAZGV2IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAoqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBpbnRlcm5hbCBhbGxvd2VkOwoKICAvKioKICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW19mcm9tXSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSk7CgogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAqCiAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAogICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgfSBlbHNlIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQp9Cgpjb250cmFjdCBUcmVhc3VyZUJveCB7CiAgLy8gRVJDMjAgYmFzaWMgdG9rZW4gY29udHJhY3QgYmVpbmcgaGVsZAogIFN0YW5kYXJkVG9rZW4gdG9rZW47CiAgLy8gYmVuZWZpY2lhcnkgb2YgdG9rZW5zIGFmdGVyIHRoZXkgYXJlIHJlbGVhc2VkCiAgYWRkcmVzcyBwdWJsaWMgYmVuZWZpY2lhcnk7CiAgLy8gdGltZXN0YW1wIHdoZXJlIHRva2VuIHJlbGVhc2UgaXMgZW5hYmxlZAogIHVpbnQgcHVibGljIHJlbGVhc2VUaW1lOwoKICBmdW5jdGlvbiBUcmVhc3VyZUJveChTdGFuZGFyZFRva2VuIF90b2tlbiwgYWRkcmVzcyBfYmVuZWZpY2lhcnksIHVpbnQgX3JlbGVhc2VUaW1lKSBwdWJsaWMgewogICAgcmVxdWlyZShfYmVuZWZpY2lhcnkgIT0gYWRkcmVzcygwKSk7CiAgICB0b2tlbiA9IFN0YW5kYXJkVG9rZW4oX3Rva2VuKTsKICAgIGJlbmVmaWNpYXJ5ID0gX2JlbmVmaWNpYXJ5OwogICAgcmVsZWFzZVRpbWUgPSBfcmVsZWFzZVRpbWU7CiAgfQoKICBmdW5jdGlvbiBjbGFpbSgpIGV4dGVybmFsIHsKICAgIHJlcXVpcmUoYXZhaWxhYmxlKCkpOwogICAgcmVxdWlyZShhbW91bnQoKSA+IDApOwogICAgdG9rZW4udHJhbnNmZXIoYmVuZWZpY2lhcnksIGFtb3VudCgpKTsKICB9CgogIGZ1bmN0aW9uIGF2YWlsYWJsZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiAobm93ID49IHJlbGVhc2VUaW1lKTsKICB9CgogIGZ1bmN0aW9uIGFtb3VudCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiB0b2tlbi5iYWxhbmNlT2YodGhpcyk7CiAgfQp9Cgpjb250cmFjdCBBaXJEcm9wcGVyIGlzIEF1dGhvcml6YWJsZSB7CiAgbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBpc0FuRXhjaGFuZ2VyOyAvLyBhbGxvdyB0byBhaXJkcm9wIHRvIGRlc3RpbmF0aW9uIGlzIGV4Y2hhbmdlciB3aXRoIG91dCBtaW5pbXVtCiAgbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBpc1RyZWFzdXJlQm94OyAvLyBmbGFnIHdobyBub3QgZWxpZ2libGUgYWlyZHJvcAogIG1hcHBpbmcoYWRkcmVzcyA9PiBhZGRyZXNzKSBwdWJsaWMgYWlyRHJvcERlc3RpbmF0aW9uczsgLy8gc2V0VG8gMHgwIGlmIHdhbnQgYWlyZHJvcCB0byBzZWxmCgogIFN0YW5kYXJkVG9rZW4gdG9rZW47CgogIGV2ZW50IFNldERlc3RpbmF0aW9uKGFkZHJlc3MgX2FkZHJlc3MsIGFkZHJlc3MgX2Rlc3RpbmF0aW9uKTsKICBldmVudCBTZXRFeGNoYW5nZXIoYWRkcmVzcyBfYWRkcmVzcywgYm9vbCBfaXNFeGNoYW5nZXIpOwoKICBmdW5jdGlvbiBBaXJEcm9wcGVyKFN0YW5kYXJkVG9rZW4gX3Rva2VuKSBwdWJsaWMgewogICAgdG9rZW4gPSBfdG9rZW47CiAgfQoKICBmdW5jdGlvbiBnZXRUb2tlbigpIHB1YmxpYyB2aWV3IHJldHVybnMoU3RhbmRhcmRUb2tlbikgewogICAgcmV0dXJuIHRva2VuOwogIH0KCiAgLyoqCiAgKiBzZXQgX2Rlc3RpbmF0aW9uIHRvIDB4MCBpZiB3YW50IHRvIHNlbGYgYWlyZHJvcAogICovCiAgZnVuY3Rpb24gc2V0QWlyRHJvcERlc3RpbmF0aW9uKGFkZHJlc3MgX2Rlc3RpbmF0aW9uKSBleHRlcm5hbCB7CiAgICByZXF1aXJlKF9kZXN0aW5hdGlvbiAhPSBtc2cuc2VuZGVyKTsKICAgIGFpckRyb3BEZXN0aW5hdGlvbnNbbXNnLnNlbmRlcl0gPSBfZGVzdGluYXRpb247CiAgICBTZXREZXN0aW5hdGlvbihtc2cuc2VuZGVyLCBfZGVzdGluYXRpb24pOwogIH0KCiAgZnVuY3Rpb24gc2V0VHJlYXN1cmVCb3ggKGFkZHJlc3MgX2FkZHJlc3MsIGJvb2wgX3N0YXR1cykgcHVibGljIG9ubHlBdXRob3JpemVkIHsKICAgIHJlcXVpcmUoX2FkZHJlc3MgIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKGlzVHJlYXN1cmVCb3hbX2FkZHJlc3NdICE9IF9zdGF0dXMpOwogICAgaXNUcmVhc3VyZUJveFtfYWRkcmVzc10gPSBfc3RhdHVzOwogIH0KCiAgZnVuY3Rpb24gc2V0RXhjaGFuZ2VyKGFkZHJlc3MgX2FkZHJlc3MsIGJvb2wgX2lzRXhjaGFuZ2VyKSBleHRlcm5hbCBvbmx5QXV0aG9yaXplZCB7CiAgICByZXF1aXJlKF9hZGRyZXNzICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShpc0FuRXhjaGFuZ2VyW19hZGRyZXNzXSAhPSBfaXNFeGNoYW5nZXIpOwogICAgaXNBbkV4Y2hhbmdlcltfYWRkcmVzc10gPSBfaXNFeGNoYW5nZXI7CiAgICBTZXRFeGNoYW5nZXIoX2FkZHJlc3MsIF9pc0V4Y2hhbmdlcik7CiAgfQoKICAvKioKICAqIGhlbHAgZml4IGFpcmRyb3Agd2hlbiBob2xkZXIgPiAxMDAKICAqIGJ1dCBuZWVkIHRvIGNhbGN1bGF0ZSBvdXRlcgogICovCiAgZnVuY3Rpb24gbXVsdGlUcmFuc2ZlcihhZGRyZXNzW10gX2FkZHJlc3MsIHVpbnRbXSBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBfYWRkcmVzcy5sZW5ndGg7IGkrKykgewogICAgICB0b2tlbi50cmFuc2ZlckZyb20obXNnLnNlbmRlciwgX2FkZHJlc3NbaV0sIF92YWx1ZVtpXSk7CiAgICB9CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCi8qKgoqIEB0aXRsZSBUZW1Ub2tlbgoqIEBkZXYgVGhlIG1haW4gWk1JTkUgdG9rZW4gY29udHJhY3QKKgoqIEFCSQoqIFt7ImNvbnN0YW50Ijp0cnVlLCJpbnB1dHMiOltdLCJuYW1lIjoibWludGluZ0ZpbmlzaGVkIiwib3V0cHV0cyI6W3sibmFtZSI6IiIsInR5cGUiOiJib29sIn1dLCJwYXlhYmxlIjpmYWxzZSwidHlwZSI6ImZ1bmN0aW9uIn0seyJjb25zdGFudCI6dHJ1ZSwiaW5wdXRzIjpbXSwibmFtZSI6Im5hbWUiLCJvdXRwdXRzIjpbeyJuYW1lIjoiIiwidHlwZSI6InN0cmluZyJ9XSwicGF5YWJsZSI6ZmFsc2UsInR5cGUiOiJmdW5jdGlvbiJ9LHsiY29uc3RhbnQiOmZhbHNlLCJpbnB1dHMiOlt7Im5hbWUiOiJfc3BlbmRlciIsInR5cGUiOiJhZGRyZXNzIn0seyJuYW1lIjoiX3ZhbHVlIiwidHlwZSI6InVpbnQyNTYifV0sIm5hbWUiOiJhcHByb3ZlIiwib3V0cHV0cyI6W10sInBheWFibGUiOmZhbHNlLCJ0eXBlIjoiZnVuY3Rpb24ifSx7ImNvbnN0YW50Ijp0cnVlLCJpbnB1dHMiOltdLCJuYW1lIjoidG90YWxTdXBwbHkiLCJvdXRwdXRzIjpbeyJuYW1lIjoiIiwidHlwZSI6InVpbnQyNTYifV0sInBheWFibGUiOmZhbHNlLCJ0eXBlIjoiZnVuY3Rpb24ifSx7ImNvbnN0YW50IjpmYWxzZSwiaW5wdXRzIjpbeyJuYW1lIjoiX2Zyb20iLCJ0eXBlIjoiYWRkcmVzcyJ9LHsibmFtZSI6Il90byIsInR5cGUiOiJhZGRyZXNzIn0seyJuYW1lIjoiX3ZhbHVlIiwidHlwZSI6InVpbnQyNTYifV0sIm5hbWUiOiJ0cmFuc2ZlckZyb20iLCJvdXRwdXRzIjpbXSwicGF5YWJsZSI6ZmFsc2UsInR5cGUiOiJmdW5jdGlvbiJ9LHsiY29uc3RhbnQiOmZhbHNlLCJpbnB1dHMiOltdLCJuYW1lIjoic3RhcnRUcmFkaW5nIiwib3V0cHV0cyI6W10sInBheWFibGUiOmZhbHNlLCJ0eXBlIjoiZnVuY3Rpb24ifSx7ImNvbnN0YW50Ijp0cnVlLCJpbnB1dHMiOltdLCJuYW1lIjoiZGVjaW1hbHMiLCJvdXRwdXRzIjpbeyJuYW1lIjoiIiwidHlwZSI6InVpbnQyNTYifV0sInBheWFibGUiOmZhbHNlLCJ0eXBlIjoiZnVuY3Rpb24ifSx7ImNvbnN0YW50IjpmYWxzZSwiaW5wdXRzIjpbeyJuYW1lIjoiX3RvIiwidHlwZSI6ImFkZHJlc3MifSx7Im5hbWUiOiJfYW1vdW50IiwidHlwZSI6InVpbnQyNTYifV0sIm5hbWUiOiJtaW50Iiwib3V0cHV0cyI6W3sibmFtZSI6IiIsInR5cGUiOiJib29sIn1dLCJwYXlhYmxlIjpmYWxzZSwidHlwZSI6ImZ1bmN0aW9uIn0seyJjb25zdGFudCI6dHJ1ZSwiaW5wdXRzIjpbXSwibmFtZSI6InRyYWRpbmdTdGFydGVkIiwib3V0cHV0cyI6W3sibmFtZSI6IiIsInR5cGUiOiJib29sIn1dLCJwYXlhYmxlIjpmYWxzZSwidHlwZSI6ImZ1bmN0aW9uIn0seyJjb25zdGFudCI6dHJ1ZSwiaW5wdXRzIjpbeyJuYW1lIjoiX293bmVyIiwidHlwZSI6ImFkZHJlc3MifV0sIm5hbWUiOiJiYWxhbmNlT2YiLCJvdXRwdXRzIjpbeyJuYW1lIjoiYmFsYW5jZSIsInR5cGUiOiJ1aW50MjU2In1dLCJwYXlhYmxlIjpmYWxzZSwidHlwZSI6ImZ1bmN0aW9uIn0seyJjb25zdGFudCI6ZmFsc2UsImlucHV0cyI6W10sIm5hbWUiOiJmaW5pc2hNaW50aW5nIiwib3V0cHV0cyI6W3sibmFtZSI6IiIsInR5cGUiOiJib29sIn1dLCJwYXlhYmxlIjpmYWxzZSwidHlwZSI6ImZ1bmN0aW9uIn0seyJjb25zdGFudCI6dHJ1ZSwiaW5wdXRzIjpbXSwibmFtZSI6Im93bmVyIiwib3V0cHV0cyI6W3sibmFtZSI6IiIsInR5cGUiOiJhZGRyZXNzIn1dLCJwYXlhYmxlIjpmYWxzZSwidHlwZSI6ImZ1bmN0aW9uIn0seyJjb25zdGFudCI6dHJ1ZSwiaW5wdXRzIjpbXSwibmFtZSI6InN5bWJvbCIsIm91dHB1dHMiOlt7Im5hbWUiOiIiLCJ0eXBlIjoic3RyaW5nIn1dLCJwYXlhYmxlIjpmYWxzZSwidHlwZSI6ImZ1bmN0aW9uIn0seyJjb25zdGFudCI6ZmFsc2UsImlucHV0cyI6W3sibmFtZSI6Il90byIsInR5cGUiOiJhZGRyZXNzIn0seyJuYW1lIjoiX3ZhbHVlIiwidHlwZSI6InVpbnQyNTYifV0sIm5hbWUiOiJ0cmFuc2ZlciIsIm91dHB1dHMiOltdLCJwYXlhYmxlIjpmYWxzZSwidHlwZSI6ImZ1bmN0aW9uIn0seyJjb25zdGFudCI6dHJ1ZSwiaW5wdXRzIjpbeyJuYW1lIjoiX293bmVyIiwidHlwZSI6ImFkZHJlc3MifSx7Im5hbWUiOiJfc3BlbmRlciIsInR5cGUiOiJhZGRyZXNzIn1dLCJuYW1lIjoiYWxsb3dhbmNlIiwib3V0cHV0cyI6W3sibmFtZSI6InJlbWFpbmluZyIsInR5cGUiOiJ1aW50MjU2In1dLCJwYXlhYmxlIjpmYWxzZSwidHlwZSI6ImZ1bmN0aW9uIn0seyJjb25zdGFudCI6ZmFsc2UsImlucHV0cyI6W3sibmFtZSI6Im5ld093bmVyIiwidHlwZSI6ImFkZHJlc3MifV0sIm5hbWUiOiJ0cmFuc2Zlck93bmVyc2hpcCIsIm91dHB1dHMiOltdLCJwYXlhYmxlIjpmYWxzZSwidHlwZSI6ImZ1bmN0aW9uIn0seyJhbm9ueW1vdXMiOmZhbHNlLCJpbnB1dHMiOlt7ImluZGV4ZWQiOnRydWUsIm5hbWUiOiJ0byIsInR5cGUiOiJhZGRyZXNzIn0seyJpbmRleGVkIjpmYWxzZSwibmFtZSI6InZhbHVlIiwidHlwZSI6InVpbnQyNTYifV0sIm5hbWUiOiJNaW50IiwidHlwZSI6ImV2ZW50In0seyJhbm9ueW1vdXMiOmZhbHNlLCJpbnB1dHMiOltdLCJuYW1lIjoiTWludEZpbmlzaGVkIiwidHlwZSI6ImV2ZW50In0seyJhbm9ueW1vdXMiOmZhbHNlLCJpbnB1dHMiOlt7ImluZGV4ZWQiOnRydWUsIm5hbWUiOiJvd25lciIsInR5cGUiOiJhZGRyZXNzIn0seyJpbmRleGVkIjp0cnVlLCJuYW1lIjoic3BlbmRlciIsInR5cGUiOiJhZGRyZXNzIn0seyJpbmRleGVkIjpmYWxzZSwibmFtZSI6InZhbHVlIiwidHlwZSI6InVpbnQyNTYifV0sIm5hbWUiOiJBcHByb3ZhbCIsInR5cGUiOiJldmVudCJ9LHsiYW5vbnltb3VzIjpmYWxzZSwiaW5wdXRzIjpbeyJpbmRleGVkIjp0cnVlLCJuYW1lIjoiZnJvbSIsInR5cGUiOiJhZGRyZXNzIn0seyJpbmRleGVkIjp0cnVlLCJuYW1lIjoidG8iLCJ0eXBlIjoiYWRkcmVzcyJ9LHsiaW5kZXhlZCI6ZmFsc2UsIm5hbWUiOiJ2YWx1ZSIsInR5cGUiOiJ1aW50MjU2In1dLCJuYW1lIjoiVHJhbnNmZXIiLCJ0eXBlIjoiZXZlbnQifV0KKi8KY29udHJhY3QgWk1JTkUgaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZSB7CiAgc3RyaW5nIHB1YmxpYyBuYW1lID0gIlpNSU5FIFRva2VuIjsKICBzdHJpbmcgcHVibGljIHN5bWJvbCA9ICJaTU4iOwogIHVpbnQ4IHB1YmxpYyBkZWNpbWFscyA9IDE4OwoKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseSA9IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA7IC8vIDEsMDAwLDAwMCwwMDAgXiAxOAoKICBmdW5jdGlvbiBaTUlORSgpIHB1YmxpYyB7CiAgICBiYWxhbmNlc1tvd25lcl0gPSB0b3RhbFN1cHBseTsKICAgIFRyYW5zZmVyKGFkZHJlc3MoMHgwKSwgb3duZXIsIHRvdGFsU3VwcGx5KTsKICB9CgogIC8qKgogICogYnVybiB0b2tlbiBpZiB0b2tlbiBpcyBub3Qgc29sZCBvdXQgYWZ0ZXIgUHVibGljCiAgKi8KICBmdW5jdGlvbiBidXJuKHVpbnQgX2Ftb3VudCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIHJlcXVpcmUoYmFsYW5jZXNbb3duZXJdID49IF9hbW91bnQpOwogICAgYmFsYW5jZXNbb3duZXJdID0gYmFsYW5jZXNbb3duZXJdIC0gX2Ftb3VudDsKICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkgLSBfYW1vdW50OwogICAgVHJhbnNmZXIob3duZXIsIGFkZHJlc3MoMHgwKSwgX2Ftb3VudCk7CiAgfQp9Cgpjb250cmFjdCBSYXRlQ29udHJhY3QgaXMgQXV0aG9yaXphYmxlIHsKICB1aW50IHB1YmxpYyByYXRlID0gNjAwMDAwMDAwMDAwMDAwMDAwMDAwMDsKCiAgZXZlbnQgVXBkYXRlUmF0ZSh1aW50IF9vbGRSYXRlLCB1aW50IF9uZXdSYXRlKTsKCiAgZnVuY3Rpb24gdXBkYXRlUmF0ZSh1aW50IF9yYXRlKSBwdWJsaWMgb25seUF1dGhvcml6ZWQgewogICAgcmVxdWlyZShyYXRlICE9IF9yYXRlKTsKICAgIFVwZGF0ZVJhdGUocmF0ZSwgX3JhdGUpOwogICAgcmF0ZSA9IF9yYXRlOwogIH0KCiAgZnVuY3Rpb24gZ2V0UmF0ZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQpIHsKICAgIHJldHVybiByYXRlOwogIH0KfQoKY29udHJhY3QgRm91bmRlclRocmVhZGVyIGlzIE93bmFibGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwoKICBldmVudCBUb2tlblRyYW5zZmVyRm9yRm91bmRlcihhZGRyZXNzIF9yZWNpcGllbnQsIHVpbnQgX3ZhbHVlLCBhZGRyZXNzIGJveDEsIGFkZHJlc3MgYm94Mik7CgogIEFpckRyb3BwZXIgcHVibGljIGFpcmRyb3BwZXI7CgogIHVpbnQgcHVibGljIGhhcmRDYXAgPSAzMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA7IC8vIDMwMCAwMDAgMDAwICogMWUxOAogIHVpbnQgcHVibGljIHJlbWFpbiA9IDMwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDsgLy8gMzAwIDAwMCAwMDAgKiAxZTE4CgogIHVpbnQgcHVibGljIG1pblR4ID0gMTAwMDAwMDAwMDAwMDAwMDAwMDAwOyAvLyAxMDAgKiAxZTE4CgogIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBpc0ZvdW5kZXI7CgogIGZ1bmN0aW9uIEZvdW5kZXJUaHJlYWRlciAoQWlyRHJvcHBlciBfYWlyZHJvcHBlciwgYWRkcmVzc1tdIF9mb3VuZGVycykgcHVibGljIHsKICAgIGFpcmRyb3BwZXIgPSBBaXJEcm9wcGVyKF9haXJkcm9wcGVyKTsKICAgIGZvciAodWludCBpID0gMDsgaSA8IF9mb3VuZGVycy5sZW5ndGg7IGkrKykgewogICAgICBpc0ZvdW5kZXJbX2ZvdW5kZXJzW2ldXSA9IHRydWU7CiAgICB9CiAgfQoKICBmdW5jdGlvbiB0cmFuc2ZlckZvcihhZGRyZXNzIF9yZWNpcGllbnQsIHVpbnQgX3Rva2VucykgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIHJlcXVpcmUoX3JlY2lwaWVudCAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3Rva2VucyA+PSBtaW5UeCk7CiAgICByZXF1aXJlKGlzRm91bmRlcltfcmVjaXBpZW50XSk7CgogICAgU3RhbmRhcmRUb2tlbiB0b2tlbiA9IFN0YW5kYXJkVG9rZW4oYWlyZHJvcHBlci5nZXRUb2tlbigpKTsKCiAgICBUcmVhc3VyZUJveCBib3gxID0gbmV3IFRyZWFzdXJlQm94KHRva2VuLCBfcmVjaXBpZW50LCAxNTMzMDg4ODAwKTsgLy8gY2FuIG9wZW4gMjAxOC0wOC0wMSAwOSswNzowMAogICAgVHJlYXN1cmVCb3ggYm94MiA9IG5ldyBUcmVhc3VyZUJveCh0b2tlbiwgX3JlY2lwaWVudCwgMTU0ODk4NjQwMCk7IC8vIGNhbiBvcGVuIDIwMTktMDItMDEgMDkrMDc6MDAKCiAgICBhaXJkcm9wcGVyLnNldFRyZWFzdXJlQm94KGJveDEsIHRydWUpOwogICAgYWlyZHJvcHBlci5zZXRUcmVhc3VyZUJveChib3gyLCB0cnVlKTsKCiAgICB0b2tlbi50cmFuc2ZlckZyb20ob3duZXIsIF9yZWNpcGllbnQsIF90b2tlbnMubXVsKDMzKS5kaXYoMTAwKSk7IC8vIDMzICUgZm9yIG5vdwogICAgdG9rZW4udHJhbnNmZXJGcm9tKG93bmVyLCBib3gxLCBfdG9rZW5zLm11bCgzMykuZGl2KDEwMCkpOyAvLyAzMyAlIGZvciBib3gxCiAgICB0b2tlbi50cmFuc2ZlckZyb20ob3duZXIsIGJveDIsIF90b2tlbnMubXVsKDM0KS5kaXYoMTAwKSk7IC8vIDM0ICUgZm9yIGJveDIKCiAgICByZW1haW4gPSByZW1haW4uc3ViKF90b2tlbnMpOwoKICAgIFRva2VuVHJhbnNmZXJGb3JGb3VuZGVyKF9yZWNpcGllbnQsIF90b2tlbnMsIGJveDEsIGJveDIpOwogIH0KfQoKY29udHJhY3QgUHJlU2FsZSBpcyBPd25hYmxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKCiAgZXZlbnQgVG9rZW5Tb2xkKGFkZHJlc3MgX3JlY2lwaWVudCwgdWludCBfdmFsdWUsIHVpbnQgX3Rva2VucywgdWludCBfcmF0ZSk7CiAgZXZlbnQgVG9rZW5Tb2xkKGFkZHJlc3MgX3JlY2lwaWVudCwgdWludCBfdG9rZW5zKTsKCiAgWk1JTkUgcHVibGljIHRva2VuOwogIFdoaXRlTGlzdCB3aGl0ZWxpc3Q7CgogIHVpbnQgcHVibGljIGhhcmRDYXAgPSAzMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA7IC8vIDMwMCAwMDAgMDAwICogMWUxOAogIHVpbnQgcHVibGljIHJlbWFpbiA9IDMwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDsgLy8gMzAwIDAwMCAwMDAgKiAxZTE4CgogIHVpbnQgcHVibGljIHN0YXJ0RGF0ZSA9IDE1MTI1MjU2MDA7IC8vIDIwMTctMTItMDYgMDkrMDc6MDAKICB1aW50IHB1YmxpYyBzdG9wRGF0ZSA9IDE1MTczNjQwMDA7ICAvLyAyMDE4LTAxLTMxIDA5KzA3OjAwCgogIHVpbnQgcHVibGljIG1pblR4ID0gMTAwMDAwMDAwMDAwMDAwMDAwMDAwOyAvLyAxMDAgKiAxZTE4CiAgdWludCBwdWJsaWMgbWF4VHggPSAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA7IC8vIDEwMCAwMDAgKiAxZTE4CgogIFJhdGVDb250cmFjdCByYXRlQ29udHJhY3Q7CgogIGZ1bmN0aW9uIFByZVNhbGUgKFpNSU5FIF90b2tlbiwgUmF0ZUNvbnRyYWN0IF9yYXRlQ29udHJhY3QsIFdoaXRlTGlzdCBfd2hpdGVsaXN0KSBwdWJsaWMgewogICAgdG9rZW4gPSBaTUlORShfdG9rZW4pOwogICAgcmF0ZUNvbnRyYWN0ID0gUmF0ZUNvbnRyYWN0KF9yYXRlQ29udHJhY3QpOwogICAgd2hpdGVsaXN0ID0gV2hpdGVMaXN0KF93aGl0ZWxpc3QpOwogIH0KCiAgLyoqCiAgKiB0cmFuc2ZlciB0b2tlbiB0byBwcmVzYWxlIGludmVzdG9yIHdobyBwYXkgYnkgY2FzaAogICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGb3IoYWRkcmVzcyBfcmVjaXBpZW50LCB1aW50IF90b2tlbnMpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICByZXF1aXJlKF9yZWNpcGllbnQgIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKGF2YWlsYWJsZSgpKTsKCiAgICByZW1haW4gPSByZW1haW4uc3ViKF90b2tlbnMpOwogICAgdG9rZW4udHJhbnNmZXJGcm9tKG93bmVyLCBfcmVjaXBpZW50LCBfdG9rZW5zKTsKCiAgICBUb2tlblNvbGQoX3JlY2lwaWVudCwgX3Rva2Vucyk7CiAgfQoKICBmdW5jdGlvbiBzYWxlKGFkZHJlc3MgX3JlY2lwaWVudCwgdWludCBfdmFsdWUsIHVpbnQgX3JhdGUpIHByaXZhdGUgewogICAgcmVxdWlyZShfcmVjaXBpZW50ICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShhdmFpbGFibGUoKSk7CiAgICByZXF1aXJlKGlzV2hpdGVMaXN0ZWQoX3JlY2lwaWVudCkpOwogICAgcmVxdWlyZShfdmFsdWUgPj0gbWluVHggJiYgX3ZhbHVlIDw9IG1heFR4KTsKICAgIHVpbnQgdG9rZW5zID0gX3JhdGUubXVsKF92YWx1ZSkuZGl2KDEwMDAwMDAwMDAwMDAwMDAwMDApOwoKICAgIHJlbWFpbiA9IHJlbWFpbi5zdWIodG9rZW5zKTsKICAgIHRva2VuLnRyYW5zZmVyRnJvbShvd25lciwgX3JlY2lwaWVudCwgdG9rZW5zKTsKICAgIG93bmVyLnRyYW5zZmVyKF92YWx1ZSk7CgogICAgVG9rZW5Tb2xkKF9yZWNpcGllbnQsIF92YWx1ZSwgdG9rZW5zLCBfcmF0ZSk7CiAgfQoKICBmdW5jdGlvbiByYXRlKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgcmV0dXJuIHJhdGVDb250cmFjdC5nZXRSYXRlKCk7CiAgfQoKICBmdW5jdGlvbiBhdmFpbGFibGUoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gKG5vdyA+IHN0YXJ0RGF0ZSAmJiBub3cgPCBzdG9wRGF0ZSk7CiAgfQoKICBmdW5jdGlvbiBpc1doaXRlTGlzdGVkKGFkZHJlc3MgX2FkZHJlc3MpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiB3aGl0ZWxpc3QuaXNXaGl0ZUxpc3RlZChfYWRkcmVzcyk7CiAgfQoKICBmdW5jdGlvbigpIGV4dGVybmFsIHBheWFibGUgewogICAgc2FsZShtc2cuc2VuZGVyLCBtc2cudmFsdWUsIHJhdGUoKSk7CiAgfQp9Cgpjb250cmFjdCBQdWJsaWNTYWxlIGlzIE93bmFibGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwoKICBldmVudCBUb2tlblNvbGQoYWRkcmVzcyBfcmVjaXBpZW50LCB1aW50IF92YWx1ZSwgdWludCBfdG9rZW5zLCB1aW50IF9yYXRlKTsKICBldmVudCBJbmNyZWFzZUhhcmRDYXAodWludCBfYW1vdW50KTsKCiAgWk1JTkUgcHVibGljIHRva2VuOwoKICBXaGl0ZUxpc3Qgd2hpdGVsaXN0UHVibGljOwogIFdoaXRlTGlzdCB3aGl0ZWxpc3RQUkU7CgogIHVpbnQgcHVibGljIGhhcmRDYXAgPSA0MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA7IC8vIDQwMCAwMDAgMDAwICogMWUxOAogIHVpbnQgcHVibGljIHJlbWFpbiA9IDQwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDsgLy8gNDAwIDAwMCAwMDAgKiAxZTE4CgogIHVpbnQgcHVibGljIHN0YXJ0RGF0ZSA9IDE1MTUzNzY4MDA7IC8vIDIwMTgtMDEtMDggMDkrMDc6MDAKICB1aW50IHB1YmxpYyBzdG9wRGF0ZSA9IDE1MTczNjQwMDA7ICAvLyAyMDE4LTAxLTMxIDA5KzA3OjAwCgogIHVpbnQgcHVibGljIG1pblR4ID0gMTAwMDAwMDAwMDAwMDAwMDAwMDsgLy8gMWUxOAogIHVpbnQgcHVibGljIG1heFR4ID0gMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwOyAvLyAxMDAgMDAwIDFlMTgKCiAgUmF0ZUNvbnRyYWN0IHJhdGVDb250cmFjdDsKCiAgZnVuY3Rpb24gUHVibGljU2FsZShaTUlORSBfdG9rZW4sIFJhdGVDb250cmFjdCBfcmF0ZUNvbnRyYWN0LCBXaGl0ZUxpc3QgX3doaXRlbGlzdFBSRSwgV2hpdGVMaXN0IF93aGl0ZWxpc3RQdWJsaWMpIHB1YmxpYyB7CiAgICB0b2tlbiA9IFpNSU5FKF90b2tlbik7CiAgICByYXRlQ29udHJhY3QgPSBSYXRlQ29udHJhY3QoX3JhdGVDb250cmFjdCk7CiAgICB3aGl0ZWxpc3RQUkUgPSBXaGl0ZUxpc3QoX3doaXRlbGlzdFBSRSk7CiAgICB3aGl0ZWxpc3RQdWJsaWMgPSBXaGl0ZUxpc3QoX3doaXRlbGlzdFB1YmxpYyk7CiAgfQoKICAvKioKICAqIGluY3JlYXNlIGhhcmQgY2FwIGlmIHByZXZpb3VzIGRvbnQgc29sZCBvdXQKICAqLwogIGZ1bmN0aW9uIGluY3JlYXNlSGFyZENhcCh1aW50IF9hbW91bnQpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICByZXF1aXJlKF9hbW91bnQgPD0gMzAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwKTsgLy8gcHJlc2FsZSBoYXJkIGNhcAogICAgaGFyZENhcCA9IGhhcmRDYXAuYWRkKF9hbW91bnQpOwogICAgcmVtYWluID0gcmVtYWluLmFkZChfYW1vdW50KTsKICAgIEluY3JlYXNlSGFyZENhcChfYW1vdW50KTsKICB9CgogIGZ1bmN0aW9uIHNhbGUoYWRkcmVzcyBfcmVjaXBpZW50LCB1aW50IF92YWx1ZSwgdWludCBfcmF0ZSkgcHJpdmF0ZSB7CiAgICByZXF1aXJlKGF2YWlsYWJsZSgpKTsKICAgIHJlcXVpcmUoaXNXaGl0ZUxpc3RlZChfcmVjaXBpZW50KSk7CiAgICByZXF1aXJlKF92YWx1ZSA+PSBtaW5UeCAmJiBfdmFsdWUgPD0gbWF4VHgpOwogICAgdWludCB0b2tlbnMgPSBfcmF0ZS5tdWwoX3ZhbHVlKS5kaXYoMTAwMDAwMDAwMDAwMDAwMDAwMCk7CgogICAgcmVtYWluID0gcmVtYWluLnN1Yih0b2tlbnMpOwogICAgdG9rZW4udHJhbnNmZXJGcm9tKG93bmVyLCBfcmVjaXBpZW50LCB0b2tlbnMpOwogICAgb3duZXIudHJhbnNmZXIoX3ZhbHVlKTsKCiAgICBUb2tlblNvbGQoX3JlY2lwaWVudCwgX3ZhbHVlLCB0b2tlbnMsIF9yYXRlKTsKICB9CgogIGZ1bmN0aW9uIHJhdGUoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KSB7CiAgICByZXR1cm4gcmF0ZUNvbnRyYWN0LmdldFJhdGUoKTsKICB9CgogIGZ1bmN0aW9uIGF2YWlsYWJsZSAoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gKG5vdyA+IHN0YXJ0RGF0ZSAmJiBub3cgPCBzdG9wRGF0ZSk7CiAgfQoKICBmdW5jdGlvbiBpc1doaXRlTGlzdGVkIChhZGRyZXNzIF9hZGRyZXNzKSBwdWJsaWMgdmlldyByZXR1cm5zKGJvb2wpIHsKICAgIHJldHVybiAod2hpdGVsaXN0UFJFLmlzV2hpdGVMaXN0ZWQoX2FkZHJlc3MpIHx8ICh3aGl0ZWxpc3RQdWJsaWMuaXNXaGl0ZUxpc3RlZChfYWRkcmVzcykpKTsKICB9CgogIGZ1bmN0aW9uKCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICBzYWxlKG1zZy5zZW5kZXIsIG1zZy52YWx1ZSwgcmF0ZSgpKTsKICB9Cn0='.
	

]
