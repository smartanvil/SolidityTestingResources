Class {
	#name : #SRT6b86047c30f88de33848f2d314e52a2c15c01662,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT6b86047c30f88de33848f2d314e52a2c15c01662 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7Cgpjb250cmFjdCBTYWZlTWF0aCB7CgogICAgZnVuY3Rpb24gc2FmZU11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2ICkgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gc2FmZURpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2ICkgewogICAgICAgIGFzc2VydChiID4gMCk7CiAgICAgICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAgICAgYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gc2FmZVN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2ICkgewogICAgICAgIGFzc2VydChiIDw9IGEpOwogICAgICAgIHJldHVybiBhIC0gYjsKICAgIH0KCiAgICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYgKSB7CiAgICAgICAgdWludDI1NiBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSk7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9Cn0KCmNvbnRyYWN0IEVSQzIwIHsKCiAgICAvKiBUaGlzIGlzIGEgc2xpZ2h0IGNoYW5nZSB0byB0aGUgRVJDMjAgYmFzZSBzdGFuZGFyZC4KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBzdXBwbHkpOwogICAgaXMgcmVwbGFjZWQgd2l0aDoKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogICAgVGhpcyBhdXRvbWF0aWNhbGx5IGNyZWF0ZXMgYSBnZXR0ZXIgZnVuY3Rpb24gZm9yIHRoZSB0b3RhbFN1cHBseS4KICAgIFRoaXMgaXMgbW92ZWQgdG8gdGhlIGJhc2UgY29udHJhY3Qgc2luY2UgcHVibGljIGdldHRlciBmdW5jdGlvbnMgYXJlIG5vdAogICAgY3VycmVudGx5IHJlY29nbmlzZWQgYXMgYW4gaW1wbGVtZW50YXRpb24gb2YgdGhlIG1hdGNoaW5nIGFic3RyYWN0CiAgICBmdW5jdGlvbiBieSB0aGUgY29tcGlsZXIuCiAgICAqLwogICAgLy8vIHRvdGFsIGFtb3VudCBvZiB0b2tlbnMKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwoKICAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIGZyb20gd2hpY2ggdGhlIGJhbGFuY2Ugd2lsbCBiZSByZXRyaWV2ZWQKICAgIC8vLyBAcmV0dXJuIFRoZSBiYWxhbmNlCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwoKICAgIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgbXNnLnNlbmRlcmAKICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQKICAgIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQKICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIHRyYW5zZmVyIHdhcyBzdWNjZXNzZnVsIG9yIG5vdAogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCiAgICAvLy8gQG5vdGljZSBzZW5kIGBfdmFsdWVgIHRva2VuIHRvIGBfdG9gIGZyb20gYF9mcm9tYCBvbiB0aGUgY29uZGl0aW9uIGl0IGlzIGFwcHJvdmVkIGJ5IGBfZnJvbWAKICAgIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3Mgb2YgdGhlIHNlbmRlcgogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudAogICAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZAogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgdHJhbnNmZXIgd2FzIHN1Y2Nlc3NmdWwgb3Igbm90CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCiAgICAvLy8gQG5vdGljZSBgbXNnLnNlbmRlcmAgYXBwcm92ZXMgYF9zcGVuZGVyYCB0byBzcGVuZCBgX3ZhbHVlYCB0b2tlbnMKICAgIC8vLyBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgYWJsZSB0byB0cmFuc2ZlciB0aGUgdG9rZW5zCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBhcHByb3ZlZCBmb3IgdHJhbnNmZXIKICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIGFwcHJvdmFsIHdhcyBzdWNjZXNzZnVsIG9yIG5vdAogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgb3duaW5nIHRva2VucwogICAgLy8vIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBhYmxlIHRvIHRyYW5zZmVyIHRoZSB0b2tlbnMKICAgIC8vLyBAcmV0dXJuIEFtb3VudCBvZiByZW1haW5pbmcgdG9rZW5zIGFsbG93ZWQgdG8gc3BlbnQKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKTsKCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpOwp9Cgpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBTYWZlTWF0aCB7CgogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwogICAgbWFwcGluZyhhZGRyZXNzID0+IG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCiAgICAvLy8gQGRldiBSZXR1cm5zIG51bWJlciBvZiB0b2tlbnMgb3duZWQgYnkgZ2l2ZW4gYWRkcmVzcy4KICAgIC8vLyBAcGFyYW0gX293bmVyIEFkZHJlc3Mgb2YgdG9rZW4gb3duZXIuCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KCiAgICAvLy8gQGRldiBUcmFuc2ZlcnMgc2VuZGVyJ3MgdG9rZW5zIHRvIGEgZ2l2ZW4gYWRkcmVzcy4gUmV0dXJucyBzdWNjZXNzLgogICAgLy8vIEBwYXJhbSBfdG8gQWRkcmVzcyBvZiB0b2tlbiByZWNlaXZlci4KICAgIC8vLyBAcGFyYW0gX3ZhbHVlIE51bWJlciBvZiB0b2tlbnMgdG8gdHJhbnNmZXIuCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYgKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gc2FmZVN1YihiYWxhbmNlc1ttc2cuc2VuZGVyXSwgX3ZhbHVlKTsKICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSA9IHNhZmVBZGQoYmFsYW5jZXNbX3RvXSwgX3ZhbHVlKTsKICAgICAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyBhbGxvd2VkIHRoaXJkIHBhcnR5IHRvIHRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIuIFJldHVybnMgc3VjY2Vzcy4KICAgIC8vLyBAcGFyYW0gX2Zyb20gQWRkcmVzcyBmcm9tIHdoZXJlIHRva2VucyBhcmUgd2l0aGRyYXduLgogICAgLy8vIEBwYXJhbSBfdG8gQWRkcmVzcyB0byB3aGVyZSB0b2tlbnMgYXJlIHNlbnQuCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBOdW1iZXIgb2YgdG9rZW5zIHRvIHRyYW5zZmVyLgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAoYmFsYW5jZXNbX2Zyb21dID49IF92YWx1ZSAmJiBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgewogICAgICAgICAgICBiYWxhbmNlc1tfdG9dID0gc2FmZUFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOwogICAgICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBzYWZlU3ViKGJhbGFuY2VzW19mcm9tXSwgX3ZhbHVlKTsKICAgICAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBzYWZlU3ViKGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLCBfdmFsdWUpOwogICAgICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8vLyBAZGV2IFNldHMgYXBwcm92ZWQgYW1vdW50IG9mIHRva2VucyBmb3Igc3BlbmRlci4gUmV0dXJucyBzdWNjZXNzLgogICAgLy8vIEBwYXJhbSBfc3BlbmRlciBBZGRyZXNzIG9mIGFsbG93ZWQgYWNjb3VudC4KICAgIC8vLyBAcGFyYW0gX3ZhbHVlIE51bWJlciBvZiBhcHByb3ZlZCB0b2tlbnMuCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgbnVtYmVyIG9mIGFsbG93ZWQgdG9rZW5zIGZvciBnaXZlbiBhZGRyZXNzLgogICAgLy8vIEBwYXJhbSBfb3duZXIgQWRkcmVzcyBvZiB0b2tlbiBvd25lci4KICAgIC8vLyBAcGFyYW0gX3NwZW5kZXIgQWRkcmVzcyBvZiB0b2tlbiBzcGVuZGVyLgogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KfQoKY29udHJhY3QgT3duYWJsZSB7CgogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICBhZGRyZXNzIHB1YmxpYyBwZW5kaW5nT3duZXI7CgogICAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLyBTYWZlIHRyYW5zZmVyIG9mIG93bmVyc2hpcCBpbiAyIHN0ZXBzLiBPbmNlIGNhbGxlZCwgYSBuZXdPd25lciBuZWVkcyB0byBjYWxsIGNsYWltT3duZXJzaGlwKCkgdG8gcHJvdmUgb3duZXJzaGlwLgogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHsKICAgICAgICBwZW5kaW5nT3duZXIgPSBuZXdPd25lcjsKICAgIH0KCiAgICBmdW5jdGlvbiBjbGFpbU93bmVyc2hpcCgpIHsKICAgICAgICBpZiAobXNnLnNlbmRlciA9PSBwZW5kaW5nT3duZXIpIHsKICAgICAgICAgICAgb3duZXIgPSBwZW5kaW5nT3duZXI7CiAgICAgICAgICAgIHBlbmRpbmdPd25lciA9IDA7CiAgICAgICAgfQogICAgfQp9Cgpjb250cmFjdCBNdWx0aU93bmFibGUgewoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgb3duZXJNYXA7CiAgICBhZGRyZXNzW10gcHVibGljIG93bmVyczsKCiAgICBldmVudCBPd25lckFkZGVkKGFkZHJlc3MgaW5kZXhlZCBfbmV3T3duZXIpOwogICAgZXZlbnQgT3duZXJSZW1vdmVkKGFkZHJlc3MgaW5kZXhlZCBfb2xkT3duZXIpOwoKICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgICAgICByZXF1aXJlKGlzT3duZXIobXNnLnNlbmRlcikpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gTXVsdGlPd25hYmxlKCkgewogICAgICAgIC8vIEFkZCBkZWZhdWx0IG93bmVyCiAgICAgICAgYWRkcmVzcyBvd25lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgb3duZXJNYXBbb3duZXJdID0gdHJ1ZTsKICAgICAgICBvd25lcnMucHVzaChvd25lcik7CiAgICB9CgogICAgZnVuY3Rpb24gb3duZXJDb3VudCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIG93bmVycy5sZW5ndGg7CiAgICB9CgogICAgZnVuY3Rpb24gaXNPd25lcihhZGRyZXNzIG93bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBvd25lck1hcFtvd25lcl07CiAgICB9CgogICAgZnVuY3Rpb24gYWRkT3duZXIoYWRkcmVzcyBvd25lcikgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYgKCFpc093bmVyKG93bmVyKSAmJiBvd25lciAhPSAwKSB7CiAgICAgICAgICAgIG93bmVyTWFwW293bmVyXSA9IHRydWU7CiAgICAgICAgICAgIG93bmVycy5wdXNoKG93bmVyKTsKCiAgICAgICAgICAgIE93bmVyQWRkZWQob3duZXIpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlbW92ZU93bmVyKGFkZHJlc3Mgb3duZXIpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmIChpc093bmVyKG93bmVyKSkgewogICAgICAgICAgICBvd25lck1hcFtvd25lcl0gPSBmYWxzZTsKICAgICAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgb3duZXJzLmxlbmd0aCAtIDE7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKG93bmVyc1tpXSA9PSBvd25lcikgewogICAgICAgICAgICAgICAgICAgIG93bmVyc1tpXSA9IG93bmVyc1tvd25lcnMubGVuZ3RoIC0gMV07CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgb3duZXJzLmxlbmd0aCAtPSAxOwoKICAgICAgICAgICAgT3duZXJSZW1vdmVkKG93bmVyKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHJldHVybiBmYWxzZTsKICAgIH0KfQoKY29udHJhY3QgUGF1c2FibGUgaXMgT3duYWJsZSB7CgogICAgYm9vbCBwdWJsaWMgcGF1c2VkOwoKICAgIG1vZGlmaWVyIGlmTm90UGF1c2VkIHsKICAgICAgICByZXF1aXJlKCFwYXVzZWQpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgaWZQYXVzZWQgewogICAgICAgIHJlcXVpcmUocGF1c2VkKTsKICAgICAgICBfOwogICAgfQoKICAgIC8vIENhbGxlZCBieSB0aGUgb3duZXIgb24gZW1lcmdlbmN5LCB0cmlnZ2VycyBwYXVzZWQgc3RhdGUKICAgIGZ1bmN0aW9uIHBhdXNlKCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICBwYXVzZWQgPSB0cnVlOwogICAgfQoKICAgIC8vIENhbGxlZCBieSB0aGUgb3duZXIgb24gZW5kIG9mIGVtZXJnZW5jeSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgIGZ1bmN0aW9uIHJlc3VtZSgpIGV4dGVybmFsIG9ubHlPd25lciBpZlBhdXNlZCB7CiAgICAgICAgcGF1c2VkID0gZmFsc2U7CiAgICB9Cn0KCmNvbnRyYWN0IENvbW1vbkJzVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgTXVsdGlPd25hYmxlIHsKCiAgICBzdHJpbmcgcHVibGljIG5hbWU7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogICAgdWludDggcHVibGljIGRlY2ltYWxzID0gMTg7CiAgICBzdHJpbmcgcHVibGljIHZlcnNpb24gPSAndjAuMSc7CgogICAgYWRkcmVzcyBwdWJsaWMgY3JlYXRvcjsKICAgIGFkZHJlc3MgcHVibGljIHNlbGxlcjsgICAgIC8vIFRoZSBtYWluIGFjY291bnQgdGhhdCBob2xkcyBhbGwgdG9rZW5zIGF0IHRoZSBiZWdpbm5pbmcuCgogICAgdWludDI1NiBwdWJsaWMgc2FsZUxpbWl0OyAgLy8gKGUxOCkgSG93IG1hbnkgdG9rZW5zIGNhbiBiZSBzb2xkIGluIHRvdGFsIHRocm91Z2ggYWxsIHRpZXJzIG9yIHRva2Vuc2FsZXMuCiAgICB1aW50MjU2IHB1YmxpYyB0b2tlbnNTb2xkOyAvLyAoZTE4KSBOdW1iZXIgb2YgdG9rZW5zIHNvbGQgdGhyb3VnaCBhbGwgdGllcnMgb3IgdG9rZW5zYWxlcy4KICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU2FsZXM7IC8vIFRvdGFsIG51bWJlciBvZiBzYWxlIChpbmNsdWRpbmcgZXh0ZXJuYWwgc2FsZXMpIG1hZGUgdGhyb3VnaCBhbGwgdGllcnMgb3IgdG9rZW5zYWxlcy4KCiAgICBib29sIHB1YmxpYyBsb2NrZWQ7CgogICAgZXZlbnQgU2VsbChhZGRyZXNzIGluZGV4ZWQgX3NlbGxlciwgYWRkcmVzcyBpbmRleGVkIF9idXllciwgdWludDI1NiBfdmFsdWUpOwogICAgZXZlbnQgU2VsbGVyQ2hhbmdlZChhZGRyZXNzIGluZGV4ZWQgX29sZFNlbGxlciwgYWRkcmVzcyBpbmRleGVkIF9uZXdTZWxsZXIpOwoKICAgIGV2ZW50IExvY2soKTsKICAgIGV2ZW50IFVubG9jaygpOwoKICAgIGV2ZW50IEJ1cm4oYWRkcmVzcyBpbmRleGVkIF9idXJuZXIsIHVpbnQyNTYgX3ZhbHVlKTsKCiAgICBtb2RpZmllciBvbmx5VW5sb2NrZWQoKSB7CiAgICAgICAgaWYgKCFpc093bmVyKG1zZy5zZW5kZXIpICYmIGxvY2tlZCkgdGhyb3c7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBDb21tb25Cc1Rva2VuKAogICAgICAgIGFkZHJlc3MgX3NlbGxlciwKICAgICAgICBzdHJpbmcgX25hbWUsCiAgICAgICAgc3RyaW5nIF9zeW1ib2wsCiAgICAgICAgdWludDI1NiBfdG90YWxTdXBwbHlOb0RlY2ltYWxzLAogICAgICAgIHVpbnQyNTYgX3NhbGVMaW1pdE5vRGVjaW1hbHMKICAgICkgTXVsdGlPd25hYmxlKCkgewoKICAgICAgICAvLyBMb2NrIHRoZSB0cmFuc2ZlciBmdW5jdGlvbiBkdXJpbmcgdGhlIHByZXNhbGUvY3Jvd2RzYWxlIHRvIHByZXZlbnQgc3BlY3VsYXRpb25zLgogICAgICAgIGxvY2tlZCA9IHRydWU7CgogICAgICAgIGNyZWF0b3IgPSBtc2cuc2VuZGVyOwogICAgICAgIHNlbGxlciA9IF9zZWxsZXI7CgogICAgICAgIG5hbWUgPSBfbmFtZTsKICAgICAgICBzeW1ib2wgPSBfc3ltYm9sOwogICAgICAgIHRvdGFsU3VwcGx5ID0gX3RvdGFsU3VwcGx5Tm9EZWNpbWFscyAqIDFlMTg7CiAgICAgICAgc2FsZUxpbWl0ID0gX3NhbGVMaW1pdE5vRGVjaW1hbHMgKiAxZTE4OwoKICAgICAgICBiYWxhbmNlc1tzZWxsZXJdID0gdG90YWxTdXBwbHk7CiAgICAgICAgVHJhbnNmZXIoMHgwLCBzZWxsZXIsIHRvdGFsU3VwcGx5KTsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGFuZ2VTZWxsZXIoYWRkcmVzcyBuZXdTZWxsZXIpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUobmV3U2VsbGVyICE9IDB4MCAmJiBzZWxsZXIgIT0gbmV3U2VsbGVyKTsKCiAgICAgICAgYWRkcmVzcyBvbGRTZWxsZXIgPSBzZWxsZXI7CiAgICAgICAgdWludDI1NiB1bnNvbGRUb2tlbnMgPSBiYWxhbmNlc1tvbGRTZWxsZXJdOwogICAgICAgIGJhbGFuY2VzW29sZFNlbGxlcl0gPSAwOwogICAgICAgIGJhbGFuY2VzW25ld1NlbGxlcl0gPSBzYWZlQWRkKGJhbGFuY2VzW25ld1NlbGxlcl0sIHVuc29sZFRva2Vucyk7CiAgICAgICAgVHJhbnNmZXIob2xkU2VsbGVyLCBuZXdTZWxsZXIsIHVuc29sZFRva2Vucyk7CgogICAgICAgIHNlbGxlciA9IG5ld1NlbGxlcjsKICAgICAgICBTZWxsZXJDaGFuZ2VkKG9sZFNlbGxlciwgbmV3U2VsbGVyKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZWxsTm9EZWNpbWFscyhhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHNlbGwoX3RvLCBfdmFsdWUgKiAxZTE4KTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZWxsKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CgogICAgICAgIC8vIENoZWNrIHRoYXQgd2UgYXJlIG5vdCBvdXQgb2YgbGltaXQgYW5kIHN0aWxsIGNhbiBzZWxsIHRva2VuczoKICAgICAgICBpZiAoc2FsZUxpbWl0ID4gMCkgcmVxdWlyZShzYWZlU3ViKHNhbGVMaW1pdCwgc2FmZUFkZCh0b2tlbnNTb2xkLCBfdmFsdWUpKSA+PSAwKTsKCiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPiAwKTsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1tzZWxsZXJdKTsKCiAgICAgICAgYmFsYW5jZXNbc2VsbGVyXSA9IHNhZmVTdWIoYmFsYW5jZXNbc2VsbGVyXSwgX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gc2FmZUFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKHNlbGxlciwgX3RvLCBfdmFsdWUpOwoKICAgICAgICB0b2tlbnNTb2xkID0gc2FmZUFkZCh0b2tlbnNTb2xkLCBfdmFsdWUpOwogICAgICAgIHRvdGFsU2FsZXMgPSBzYWZlQWRkKHRvdGFsU2FsZXMsIDEpOwogICAgICAgIFNlbGwoc2VsbGVyLCBfdG8sIF92YWx1ZSk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgb25seVVubG9ja2VkIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBvbmx5VW5sb2NrZWQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gbG9jaygpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGxvY2tlZCA9IHRydWU7CiAgICAgICAgTG9jaygpOwogICAgfQoKICAgIGZ1bmN0aW9uIHVubG9jaygpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGxvY2tlZCA9IGZhbHNlOwogICAgICAgIFVubG9jaygpOwogICAgfQoKICAgIGZ1bmN0aW9uIGJ1cm4odWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPiAwKTsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1ttc2cuc2VuZGVyXSk7CgogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gc2FmZVN1YihiYWxhbmNlc1ttc2cuc2VuZGVyXSwgX3ZhbHVlKSA7CiAgICAgICAgdG90YWxTdXBwbHkgPSBzYWZlU3ViKHRvdGFsU3VwcGx5LCBfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIDB4MCwgX3ZhbHVlKTsKICAgICAgICBCdXJuKG1zZy5zZW5kZXIsIF92YWx1ZSk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9Cgpjb250cmFjdCBDb21tb25Cc1ByZXNhbGUgaXMgU2FmZU1hdGgsIE93bmFibGUsIFBhdXNhYmxlIHsKCiAgICBlbnVtIEN1cnJlbmN5IHsgQlRDLCBMVEMsIFpFQywgREFTSCwgV0FWRVMsIFVTRCwgRVVSIH0KCiAgICAvLyBUT0RPIHJlbmFtZSB0byBCdXllcj8KCiAgICBzdHJ1Y3QgQmFja2VyIHsKICAgICAgICB1aW50MjU2IHdlaVJlY2VpdmVkOyAvLyBBbW91bnQgb2Ygd2VpIGdpdmVuIGJ5IGJhY2tlcgogICAgICAgIHVpbnQyNTYgdG9rZW5zU2VudDsgIC8vIEFtb3VudCBvZiB0b2tlbnMgcmVjZWl2ZWQgaW4gcmV0dXJuIHRvIHRoZSBnaXZlbiBhbW91bnQgb2YgRVRILgogICAgfQoKICAgIC8vIFRPRE8gcmVuYW1lIHRvIGJ1eWVycz8KCiAgICAvLyAoYnV5ZXJfZXRoX2FkZHJlc3MgLT4gc3RydWN0KQogICAgbWFwcGluZyhhZGRyZXNzID0+IEJhY2tlcikgcHVibGljIGJhY2tlcnM7CgogICAgLy8gY3VycmVuY3lfY29kZSA9PiAodHhfaGFzaCA9PiB0b2tlbnMpCiAgICBtYXBwaW5nKHVpbnQ4ID0+IG1hcHBpbmcoYnl0ZXMzMiA9PiB1aW50MjU2KSkgcHVibGljIGV4dGVybmFsVHhzOwoKICAgIENvbW1vbkJzVG9rZW4gcHVibGljIHRva2VuOyAvLyBUb2tlbiBjb250cmFjdCByZWZlcmVuY2UuCiAgICBhZGRyZXNzIHB1YmxpYyBiZW5lZmljaWFyeTsgLy8gQWRkcmVzcyB0aGF0IHdpbGwgcmVjZWl2ZSBFVEggcmFpc2VkIGR1cmluZyB0aGlzIGNyb3dkc2FsZS4KICAgIGFkZHJlc3MgcHVibGljIG5vdGlmaWVyOyAgICAvLyBBZGRyZXNzIHRoYXQgY2FuIHRoaXMgY3Jvd2RzYWxlIGFib3V0IGNoYW5nZWQgZXh0ZXJuYWwgY29uZGl0aW9ucy4KCiAgICAvLyBUT0RPIGltcGxlbWVudAogICAgdWludDI1NiBwdWJsaWMgbWluV2VpVG9BY2NlcHQgPSAwLjAwMDEgZXRoZXI7CgogICAgdWludDI1NiBwdWJsaWMgbWF4Q2FwV2VpID0gMC4wMSBldGhlcjsKICAgIHVpbnQgcHVibGljIHRva2Vuc1BlcldlaSA9IDQwMCAqIDEuMjU7IC8vIE9yZGluYXJ5IHByaWNlOiAxIEVUSCA9IDQwMCB0b2tlbnMuIFBsdXMgMjUlIGJvbnVzIGR1cmluZyBwcmVzYWxlLgoKICAgIHVpbnQgcHVibGljIHN0YXJ0VGltZTsgLy8gV2lsbCBiZSBzZXR1cCBvbmNlIGluIGEgY29uc3RydWN0b3IgZnJvbSBub3coKS4KICAgIHVpbnQgcHVibGljIGVuZFRpbWUgPSAxNTIwNjAwNDAwOyAvLyAyMDE4LTAzLTA5VDEzOjAwOjAwWgoKICAgIC8vIFN0YXRzIGZvciBjdXJyZW50IGNyb3dkc2FsZQoKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsSW5XZWkgICAgICAgICA9IDA7IC8vIEdyYW5kIHRvdGFsIGluIHdlaQogICAgdWludDI1NiBwdWJsaWMgdG90YWxUb2tlbnNTb2xkICAgID0gMDsgLy8gVG90YWwgYW1vdW50IG9mIHRva2VucyBzb2xkIGR1cmluZyB0aGlzIGNyb3dkc2FsZS4KICAgIHVpbnQyNTYgcHVibGljIHRvdGFsRXRoU2FsZXMgICAgICA9IDA7IC8vIFRvdGFsIGFtb3VudCBvZiBFVEggY29udHJpYnV0aW9ucyBkdXJpbmcgdGhpcyBjcm93ZHNhbGUuCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbEV4dGVybmFsU2FsZXMgPSAwOyAvLyBUb3RhbCBhbW91bnQgb2YgZXh0ZXJuYWwgY29udHJpYnV0aW9ucyAoQlRDLCBMVEMsIFVTRCwgZXRjLikgZHVyaW5nIHRoaXMgY3Jvd2RzYWxlLgogICAgdWludDI1NiBwdWJsaWMgd2VpUmVjZWl2ZWQgICAgICAgID0gMDsgLy8gVG90YWwgYW1vdW50IG9mIHdlaSByZWNlaXZlZCBkdXJpbmcgdGhpcyBjcm93ZHNhbGUgc21hcnQgY29udHJhY3QuCgogICAgdWludCBwdWJsaWMgZmluYWxpemVkVGltZSA9IDA7IC8vIFVuaXggdGltZXN0YW1wIHdoZW4gZmluYWxpemUoKSB3YXMgY2FsbGVkLgoKICAgIGJvb2wgcHVibGljIHNhbGVFbmFibGVkID0gdHJ1ZTsgICAvLyBpZiBmYWxzZSwgdGhlbiBjb250cmFjdCB3aWxsIG5vdCBzZWxsIHRva2VucyBvbiBwYXltZW50IHJlY2VpdmVkCgogICAgZXZlbnQgQmVuZWZpY2lhcnlDaGFuZ2VkKGFkZHJlc3MgaW5kZXhlZCBfb2xkQWRkcmVzcywgYWRkcmVzcyBpbmRleGVkIF9uZXdBZGRyZXNzKTsKICAgIGV2ZW50IE5vdGlmaWVyQ2hhbmdlZChhZGRyZXNzIGluZGV4ZWQgX29sZEFkZHJlc3MsIGFkZHJlc3MgaW5kZXhlZCBfbmV3QWRkcmVzcyk7CgogICAgZXZlbnQgRXRoUmVjZWl2ZWQoYWRkcmVzcyBpbmRleGVkIF9idXllciwgdWludDI1NiBfYW1vdW50V2VpKTsKICAgIGV2ZW50IEV4dGVybmFsU2FsZShDdXJyZW5jeSBfY3VycmVuY3ksIGJ5dGVzMzIgX3R4SWRTaGEzLCBhZGRyZXNzIGluZGV4ZWQgX2J1eWVyLCB1aW50MjU2IF9hbW91bnRXZWksIHVpbnQyNTYgX3Rva2Vuc0UxOCk7CgogICAgbW9kaWZpZXIgcmVzcGVjdFRpbWVGcmFtZSgpIHsKICAgICAgICByZXF1aXJlKGlzU2FsZU9uKCkpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgY2FuTm90aWZ5KCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lciB8fCBtc2cuc2VuZGVyID09IG5vdGlmaWVyKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIENvbW1vbkJzUHJlc2FsZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfdG9rZW4sIGFkZHJlc3MgX2JlbmVmaWNpYXJ5KSB7CiAgICAgICAgdG9rZW4gPSBDb21tb25Cc1Rva2VuKF90b2tlbik7CiAgICAgICAgb3duZXIgPSBfb3duZXI7CiAgICAgICAgbm90aWZpZXIgPSBvd25lcjsKICAgICAgICBiZW5lZmljaWFyeSA9IF9iZW5lZmljaWFyeTsKICAgICAgICBzdGFydFRpbWUgPSBub3c7CiAgICB9CgogICAgLy8gT3ZlcnJpZGUgdGhpcyBtZXRob2QgdG8gbW9jayBjdXJyZW50IHRpbWUuCiAgICBmdW5jdGlvbiBnZXROb3coKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBub3c7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0U2FsZUVuYWJsZWQoYm9vbCBfZW5hYmxlZCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgc2FsZUVuYWJsZWQgPSBfZW5hYmxlZDsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRCZW5lZmljaWFyeShhZGRyZXNzIF9iZW5lZmljaWFyeSkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgQmVuZWZpY2lhcnlDaGFuZ2VkKGJlbmVmaWNpYXJ5LCBfYmVuZWZpY2lhcnkpOwogICAgICAgIGJlbmVmaWNpYXJ5ID0gX2JlbmVmaWNpYXJ5OwogICAgfQoKICAgIGZ1bmN0aW9uIHNldE5vdGlmaWVyKGFkZHJlc3MgX25vdGlmaWVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBOb3RpZmllckNoYW5nZWQobm90aWZpZXIsIF9ub3RpZmllcik7CiAgICAgICAgbm90aWZpZXIgPSBfbm90aWZpZXI7CiAgICB9CgogICAgLyoKICAgICAqIFRoZSBmYWxsYmFjayBmdW5jdGlvbiBjb3JyZXNwb25kcyB0byBhIGRvbmF0aW9uIGluIEVUSAogICAgICovCiAgICBmdW5jdGlvbigpIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICBpZiAoc2FsZUVuYWJsZWQpIHNlbGxUb2tlbnNGb3JFdGgobXNnLnNlbmRlciwgbXNnLnZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZWxsVG9rZW5zRm9yRXRoKGFkZHJlc3MgX2J1eWVyLCB1aW50MjU2IF9hbW91bnRXZWkpIGludGVybmFsIGlmTm90UGF1c2VkIHJlc3BlY3RUaW1lRnJhbWUgewoKICAgICAgICByZXF1aXJlKF9hbW91bnRXZWkgPj0gbWluV2VpVG9BY2NlcHQpOwoKICAgICAgICB0b3RhbEluV2VpID0gc2FmZUFkZCh0b3RhbEluV2VpLCBfYW1vdW50V2VpKTsKICAgICAgICB3ZWlSZWNlaXZlZCA9IHNhZmVBZGQod2VpUmVjZWl2ZWQsIF9hbW91bnRXZWkpOwogICAgICAgIHJlcXVpcmUodG90YWxJbldlaSA8PSBtYXhDYXBXZWkpOyAvLyBJZiBtYXggY2FwIHJlYWNoZWQuCgogICAgICAgIHVpbnQyNTYgdG9rZW5zRTE4ID0gd2VpVG9Ub2tlbnMoX2Ftb3VudFdlaSk7CiAgICAgICAgcmVxdWlyZSh0b2tlbi5zZWxsKF9idXllciwgdG9rZW5zRTE4KSk7IC8vIFRyYW5zZmVyIHRva2VucyB0byBidXllci4KICAgICAgICB0b3RhbFRva2Vuc1NvbGQgPSBzYWZlQWRkKHRvdGFsVG9rZW5zU29sZCwgdG9rZW5zRTE4KTsKICAgICAgICB0b3RhbEV0aFNhbGVzKys7CgogICAgICAgIEJhY2tlciBiYWNrZXIgPSBiYWNrZXJzW19idXllcl07CiAgICAgICAgYmFja2VyLnRva2Vuc1NlbnQgPSBzYWZlQWRkKGJhY2tlci50b2tlbnNTZW50LCB0b2tlbnNFMTgpOwogICAgICAgIGJhY2tlci53ZWlSZWNlaXZlZCA9IHNhZmVBZGQoYmFja2VyLndlaVJlY2VpdmVkLCBfYW1vdW50V2VpKTsgIC8vIFVwZGF0ZSB0aGUgdG90YWwgd2VpIGNvbGxlY3RlZCBkdXJpbmcgdGhlIGNyb3dkZnVuZGluZyBmb3IgdGhpcyBiYWNrZXIKCiAgICAgICAgRXRoUmVjZWl2ZWQoX2J1eWVyLCBfYW1vdW50V2VpKTsKICAgIH0KCiAgICAvLyBDYWxjIGhvdyBtdWNoIHRva2VucyB5b3UgY2FuIGJ1eSBhdCBjdXJyZW50IHRpbWUuCiAgICBmdW5jdGlvbiB3ZWlUb1Rva2Vucyh1aW50MjU2IF9hbW91bnRXZWkpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHNhZmVNdWwoX2Ftb3VudFdlaSwgdG9rZW5zUGVyV2VpKTsKICAgIH0KCiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIEJlZ2luIG9mIGV4dGVybmFsIHNhbGVzLgoKICAgIGZ1bmN0aW9uIGV4dGVybmFsU2FsZXMoCiAgICAgICAgdWludDhbXSBfY3VycmVuY2llcywKICAgICAgICBieXRlczMyW10gX3R4SWRTaGEzLAogICAgICAgIGFkZHJlc3NbXSBfYnV5ZXJzLAogICAgICAgIHVpbnQyNTZbXSBfYW1vdW50c1dlaSwKICAgICAgICB1aW50MjU2W10gX3Rva2Vuc0UxOAogICAgKSBwdWJsaWMgaWZOb3RQYXVzZWQgY2FuTm90aWZ5IHsKCiAgICAgICAgcmVxdWlyZShfY3VycmVuY2llcy5sZW5ndGggPiAwKTsKICAgICAgICByZXF1aXJlKF9jdXJyZW5jaWVzLmxlbmd0aCA9PSBfdHhJZFNoYTMubGVuZ3RoKTsKICAgICAgICByZXF1aXJlKF9jdXJyZW5jaWVzLmxlbmd0aCA9PSBfYnV5ZXJzLmxlbmd0aCk7CiAgICAgICAgcmVxdWlyZShfY3VycmVuY2llcy5sZW5ndGggPT0gX2Ftb3VudHNXZWkubGVuZ3RoKTsKICAgICAgICByZXF1aXJlKF9jdXJyZW5jaWVzLmxlbmd0aCA9PSBfdG9rZW5zRTE4Lmxlbmd0aCk7CgogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IF90eElkU2hhMy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBfZXh0ZXJuYWxTYWxlU2hhMygKICAgICAgICAgICAgICAgIEN1cnJlbmN5KF9jdXJyZW5jaWVzW2ldKSwKICAgICAgICAgICAgICAgIF90eElkU2hhM1tpXSwKICAgICAgICAgICAgICAgIF9idXllcnNbaV0sCiAgICAgICAgICAgICAgICBfYW1vdW50c1dlaVtpXSwKICAgICAgICAgICAgICAgIF90b2tlbnNFMThbaV0KICAgICAgICAgICAgKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gX2V4dGVybmFsU2FsZVNoYTMoCiAgICAgICAgQ3VycmVuY3kgX2N1cnJlbmN5LAogICAgICAgIGJ5dGVzMzIgX3R4SWRTaGEzLCAvLyBUbyBnZXQgYnl0ZXMzMiB1c2Uga2VjY2FrMjU2KHR4SWQpIE9SIHNoYTModHhJZCkKICAgICAgICBhZGRyZXNzIF9idXllciwKICAgICAgICB1aW50MjU2IF9hbW91bnRXZWksCiAgICAgICAgdWludDI1NiBfdG9rZW5zRTE4CiAgICApIGludGVybmFsIHsKCiAgICAgICAgcmVxdWlyZShfYnV5ZXIgPiAwICYmIF9hbW91bnRXZWkgPiAwICYmIF90b2tlbnNFMTggPiAwKTsKCiAgICAgICAgdmFyIHR4c0J5Q3VyID0gZXh0ZXJuYWxUeHNbdWludDgoX2N1cnJlbmN5KV07CgogICAgICAgIC8vIElmIHRoaXMgZm9yZWlnbiB0cmFuc2FjdGlvbiBoYXMgYmVlbiBhbHJlYWR5IHByb2Nlc3NlZCBpbiB0aGlzIGNvbnRyYWN0LgogICAgICAgIHJlcXVpcmUodHhzQnlDdXJbX3R4SWRTaGEzXSA9PSAwKTsKCiAgICAgICAgdG90YWxJbldlaSA9IHNhZmVBZGQodG90YWxJbldlaSwgX2Ftb3VudFdlaSk7CiAgICAgICAgcmVxdWlyZSh0b3RhbEluV2VpIDw9IG1heENhcFdlaSk7IC8vIE1heCBjYXAgc2hvdWxkIG5vdCBiZSByZWFjaGVkIHlldC4KCiAgICAgICAgcmVxdWlyZSh0b2tlbi5zZWxsKF9idXllciwgX3Rva2Vuc0UxOCkpOyAvLyBUcmFuc2ZlciB0b2tlbnMgdG8gYnV5ZXIuCiAgICAgICAgdG90YWxUb2tlbnNTb2xkID0gc2FmZUFkZCh0b3RhbFRva2Vuc1NvbGQsIF90b2tlbnNFMTgpOwogICAgICAgIHRvdGFsRXh0ZXJuYWxTYWxlcysrOwoKICAgICAgICB0eHNCeUN1cltfdHhJZFNoYTNdID0gX3Rva2Vuc0UxODsKICAgICAgICBFeHRlcm5hbFNhbGUoX2N1cnJlbmN5LCBfdHhJZFNoYTMsIF9idXllciwgX2Ftb3VudFdlaSwgX3Rva2Vuc0UxOCk7CiAgICB9CgogICAgLy8gR2V0IGlkIG9mIGN1cnJlbmN5IGVudW0uIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgZnVuY3Rpb24gYnRjSWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gdWludDgoQ3VycmVuY3kuQlRDKTsKICAgIH0KCiAgICBmdW5jdGlvbiBsdGNJZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50OCkgewogICAgICAgIHJldHVybiB1aW50OChDdXJyZW5jeS5MVEMpOwogICAgfQoKICAgIGZ1bmN0aW9uIHplY0lkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgcmV0dXJuIHVpbnQ4KEN1cnJlbmN5LlpFQyk7CiAgICB9CgogICAgZnVuY3Rpb24gZGFzaElkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgcmV0dXJuIHVpbnQ4KEN1cnJlbmN5LkRBU0gpOwogICAgfQoKICAgIGZ1bmN0aW9uIHdhdmVzSWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gdWludDgoQ3VycmVuY3kuV0FWRVMpOwogICAgfQoKICAgIGZ1bmN0aW9uIHVzZElkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgcmV0dXJuIHVpbnQ4KEN1cnJlbmN5LlVTRCk7CiAgICB9CgogICAgZnVuY3Rpb24gZXVySWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gdWludDgoQ3VycmVuY3kuRVVSKTsKICAgIH0KCiAgICAvLyBHZXQgdG9rZW4gY291bnQgYnkgdHJhbnNhY3Rpb24gaWQuIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBmdW5jdGlvbiBfdG9rZW5zQnlUeChDdXJyZW5jeSBfY3VycmVuY3ksIHN0cmluZyBfdHhJZCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiB0b2tlbnNCeVR4KHVpbnQ4KF9jdXJyZW5jeSksIF90eElkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b2tlbnNCeVR4KHVpbnQ4IF9jdXJyZW5jeSwgc3RyaW5nIF90eElkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBleHRlcm5hbFR4c1tfY3VycmVuY3ldW2tlY2NhazI1NihfdHhJZCldOwogICAgfQoKICAgIGZ1bmN0aW9uIHRva2Vuc0J5QnRjVHgoc3RyaW5nIF90eElkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBfdG9rZW5zQnlUeChDdXJyZW5jeS5CVEMsIF90eElkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b2tlbnNCeUx0Y1R4KHN0cmluZyBfdHhJZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gX3Rva2Vuc0J5VHgoQ3VycmVuY3kuTFRDLCBfdHhJZCk7CiAgICB9CgogICAgZnVuY3Rpb24gdG9rZW5zQnlaZWNUeChzdHJpbmcgX3R4SWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIF90b2tlbnNCeVR4KEN1cnJlbmN5LlpFQywgX3R4SWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRva2Vuc0J5RGFzaFR4KHN0cmluZyBfdHhJZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gX3Rva2Vuc0J5VHgoQ3VycmVuY3kuREFTSCwgX3R4SWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRva2Vuc0J5V2F2ZXNUeChzdHJpbmcgX3R4SWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIF90b2tlbnNCeVR4KEN1cnJlbmN5LldBVkVTLCBfdHhJZCk7CiAgICB9CgogICAgZnVuY3Rpb24gdG9rZW5zQnlVc2RUeChzdHJpbmcgX3R4SWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIF90b2tlbnNCeVR4KEN1cnJlbmN5LlVTRCwgX3R4SWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRva2Vuc0J5RXVyVHgoc3RyaW5nIF90eElkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBfdG9rZW5zQnlUeChDdXJyZW5jeS5FVVIsIF90eElkKTsKICAgIH0KCiAgICAvLyBFbmQgb2YgZXh0ZXJuYWwgc2FsZXMuCiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBmdW5jdGlvbiB0b3RhbFNhbGVzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gc2FmZUFkZCh0b3RhbEV0aFNhbGVzLCB0b3RhbEV4dGVybmFsU2FsZXMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzTWF4Q2FwUmVhY2hlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHRvdGFsSW5XZWkgPj0gbWF4Q2FwV2VpOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzU2FsZU9uKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICB1aW50IF9ub3cgPSBnZXROb3coKTsKICAgICAgICByZXR1cm4gc3RhcnRUaW1lIDw9IF9ub3cgJiYgX25vdyA8PSBlbmRUaW1lOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzU2FsZU92ZXIoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBnZXROb3coKSA+IGVuZFRpbWU7CiAgICB9CgogICAgZnVuY3Rpb24gaXNGaW5hbGl6ZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBmaW5hbGl6ZWRUaW1lID4gMDsKICAgIH0KCiAgICAvKgogICAgICogRmluYWxpemUgdGhlIGNyb3dkc2FsZS4gUmFpc2VkIG1vbmV5IGNhbiBiZSBzZW50IHRvIGJlbmVmaWNpYXJ5IG9ubHkgaWYgY3Jvd2RzYWxlIGhpdCBlbmQgdGltZSBvciBtYXggY2FwLgogICAgICovCiAgICBmdW5jdGlvbiBmaW5hbGl6ZSgpIHB1YmxpYyBvbmx5T3duZXIgewoKICAgICAgICAvLyBDYW5ub3QgZmluYWxpc2UgYmVmb3JlIGVuZCBkYXkgb2YgY3Jvd2RzYWxlIHVudGlsIG1heCBjYXAgaXMgcmVhY2hlZC4KICAgICAgICByZXF1aXJlKGlzTWF4Q2FwUmVhY2hlZCgpIHx8IGlzU2FsZU92ZXIoKSk7CgogICAgICAgIGJlbmVmaWNpYXJ5LnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CgogICAgICAgIGZpbmFsaXplZFRpbWUgPSBnZXROb3coKTsKICAgIH0KfQoKCmNvbnRyYWN0IFhUb2tlbiBpcyBDb21tb25Cc1Rva2VuIHsKCiAgICBmdW5jdGlvbiBYVG9rZW4oKSBwdWJsaWMgQ29tbW9uQnNUb2tlbigKICAgICAgICAweEUzRTlGNjZFNUViZTlFOTYxNjYyZGEzNEZGOWFFQTk1YzY3OTVmZDAsICAgICAvLyBUT0RPIGFkZHJlc3MgX3NlbGxlciAobWFpbiBob2xkZXIgb2YgYWxsIHRva2VucykKICAgICAgICAnWCBmdWxsJywKICAgICAgICAnWCBzaG9ydCcsCiAgICAgICAgMTAwICogMWU2LCAvLyBNYXggdG9rZW4gc3VwcGx5LgogICAgICAgIDQwICogMWU2ICAgLy8gU2FsZSBsaW1pdCAtIG1heCB0b2tlbnMgdGhhdCBjYW4gYmUgc29sZCB0aHJvdWdoIGFsbCB0aWVycyBvZiB0b2tlbnNhbGUuCiAgICApIHt9Cn0KCmNvbnRyYWN0IFhQcmVzYWxlIGlzIENvbW1vbkJzUHJlc2FsZSB7CgogICAgZnVuY3Rpb24gWFByZXNhbGUoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3Rva2VuKSBwdWJsaWMgQ29tbW9uQnNQcmVzYWxlKAogICAgICAgIF9vd25lciwKICAgICAgICBfdG9rZW4sCiAgICAgICAgMHhFM0U5RjY2RTVFYmU5RTk2MTY2MmRhMzRGRjlhRUE5NWM2Nzk1ZmQwICAvLyBUT0RPIGFkZHJlc3MgX2JlbmVmaWNpYXJ5CiAgICApIHt9Cn0KCmNvbnRyYWN0IERlcGxveWVyIHsKICAgIAogICAgWFRva2VuIHB1YmxpYyB0b2tlbjsKICAgIFhQcmVzYWxlIHB1YmxpYyBwcmVzYWxlOwogICAgCiAgICBmdW5jdGlvbiBEZXBsb3llcigpIHB1YmxpYyB7CiAgICAgICAgYWRkcmVzcyBvd25lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgdG9rZW4gPSBuZXcgWFRva2VuKCk7CiAgICAgICAgcHJlc2FsZSA9IG5ldyBYUHJlc2FsZShvd25lciwgdG9rZW4pOwogICAgICAgIHRva2VuLmFkZE93bmVyKG93bmVyKTsKICAgICAgICB0b2tlbi5hZGRPd25lcihwcmVzYWxlKTsKICAgIH0KfQ=='.
	

]
