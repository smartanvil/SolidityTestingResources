Class {
	#name : #SRTdafae9d2ecfa1f8bba620680f296c3404770e6fe,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTdafae9d2ecfa1f8bba620680f296c3404770e6fe >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuOTsKCmNvbnRyYWN0IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBzYWZlTXVsKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICB1aW50IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHNhZmVTdWIodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gc2FmZUFkZCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgdWludCBjID0gYSArIGI7CiAgICBhc3NlcnQoYz49YSAmJiBjPj1iKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gYXNzZXJ0KGJvb2wgYXNzZXJ0aW9uKSBpbnRlcm5hbCB7CiAgICBpZiAoIWFzc2VydGlvbikgdGhyb3c7CiAgfQp9Cgpjb250cmFjdCBUb2tlbiB7CiAgLy8vIEByZXR1cm4gdG90YWwgYW1vdW50IG9mIHRva2VucwogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBzdXBwbHkpIHt9CgogIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIGZyb20gd2hpY2ggdGhlIGJhbGFuY2Ugd2lsbCBiZSByZXRyaWV2ZWQKICAvLy8gQHJldHVybiBUaGUgYmFsYW5jZQogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7fQoKICAvLy8gQG5vdGljZSBzZW5kIGBfdmFsdWVgIHRva2VuIHRvIGBfdG9gIGZyb20gYG1zZy5zZW5kZXJgCiAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudAogIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQKICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykge30KCiAgLy8vIEBub3RpY2Ugc2VuZCBgX3ZhbHVlYCB0b2tlbiB0byBgX3RvYCBmcm9tIGBfZnJvbWAgb24gdGhlIGNvbmRpdGlvbiBpdCBpcyBhcHByb3ZlZCBieSBgX2Zyb21gCiAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyCiAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudAogIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQKICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHt9CgogIC8vLyBAbm90aWNlIGBtc2cuc2VuZGVyYCBhcHByb3ZlcyBgX2FkZHJgIHRvIHNwZW5kIGBfdmFsdWVgIHRva2VucwogIC8vLyBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgYWJsZSB0byB0cmFuc2ZlciB0aGUgdG9rZW5zCiAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB3ZWkgdG8gYmUgYXBwcm92ZWQgZm9yIHRyYW5zZmVyCiAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgYXBwcm92YWwgd2FzIHN1Y2Nlc3NmdWwgb3Igbm90CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7fQoKICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBvd25pbmcgdG9rZW5zCiAgLy8vIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBhYmxlIHRvIHRyYW5zZmVyIHRoZSB0b2tlbnMKICAvLy8gQHJldHVybiBBbW91bnQgb2YgcmVtYWluaW5nIHRva2VucyBhbGxvd2VkIHRvIHNwZW50CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykge30KCiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgaW5kZXhlZCBkYXRhKTsKICB1aW50IHB1YmxpYyBkZWNpbWFsczsKICBzdHJpbmcgcHVibGljIG5hbWU7Cn0KCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgVG9rZW4gewoKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgLy9EZWZhdWx0IGFzc3VtZXMgdG90YWxTdXBwbHkgY2FuJ3QgYmUgb3ZlciBtYXggKDJeMjU2IC0gMSkuCiAgICAvL0lmIHlvdXIgdG9rZW4gbGVhdmVzIG91dCB0b3RhbFN1cHBseSBhbmQgY2FuIGlzc3VlIG1vcmUgdG9rZW5zIGFzIHRpbWUgZ29lcyBvbiwgeW91IG5lZWQgdG8gY2hlY2sgaWYgaXQgZG9lc24ndCB3cmFwLgogICAgLy9SZXBsYWNlIHRoZSBpZiB3aXRoIHRoaXMgb25lIGluc3RlYWQuCiAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIGJhbGFuY2VzW190b10gKyBfdmFsdWUgPiBiYWxhbmNlc1tfdG9dKSB7CiAgICAvL2lmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgewogICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICAgIGJhbGFuY2VzW190b10gKz0gX3ZhbHVlOwogICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9CiAgfQoKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIC8vc2FtZSBhcyBhYm92ZS4gUmVwbGFjZSB0aGlzIGxpbmUgd2l0aCB0aGUgZm9sbG93aW5nIGlmIHlvdSB3YW50IHRvIHByb3RlY3QgYWdhaW5zdCB3cmFwcGluZyB1aW50cy4KICAgIGlmIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBiYWxhbmNlc1tfdG9dICsgX3ZhbHVlID4gYmFsYW5jZXNbX3RvXSkgewogICAgLy9pZiAoYmFsYW5jZXNbX2Zyb21dID49IF92YWx1ZSAmJiBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgewogICAgICBiYWxhbmNlc1tfdG9dICs9IF92YWx1ZTsKICAgICAgYmFsYW5jZXNbX2Zyb21dIC09IF92YWx1ZTsKICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOwogICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gZWxzZSB7IHJldHVybiBmYWxzZTsgfQogIH0KCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CgogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwoKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKfQoKY29udHJhY3QgUmVzZXJ2ZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIFNhZmVNYXRoIHsKICBhZGRyZXNzIHB1YmxpYyBtaW50ZXI7CiAgZnVuY3Rpb24gUmVzZXJ2ZVRva2VuKCkgewogICAgbWludGVyID0gbXNnLnNlbmRlcjsKICB9CiAgZnVuY3Rpb24gY3JlYXRlKGFkZHJlc3MgYWNjb3VudCwgdWludCBhbW91bnQpIHsKICAgIGlmIChtc2cuc2VuZGVyICE9IG1pbnRlcikgdGhyb3c7CiAgICBiYWxhbmNlc1thY2NvdW50XSA9IHNhZmVBZGQoYmFsYW5jZXNbYWNjb3VudF0sIGFtb3VudCk7CiAgICB0b3RhbFN1cHBseSA9IHNhZmVBZGQodG90YWxTdXBwbHksIGFtb3VudCk7CiAgfQogIGZ1bmN0aW9uIGRlc3Ryb3koYWRkcmVzcyBhY2NvdW50LCB1aW50IGFtb3VudCkgewogICAgaWYgKG1zZy5zZW5kZXIgIT0gbWludGVyKSB0aHJvdzsKICAgIGlmIChiYWxhbmNlc1thY2NvdW50XSA8IGFtb3VudCkgdGhyb3c7CiAgICBiYWxhbmNlc1thY2NvdW50XSA9IHNhZmVTdWIoYmFsYW5jZXNbYWNjb3VudF0sIGFtb3VudCk7CiAgICB0b3RhbFN1cHBseSA9IHNhZmVTdWIodG90YWxTdXBwbHksIGFtb3VudCk7CiAgfQp9Cgpjb250cmFjdCBBY2NvdW50TGV2ZWxzIHsKICAvL2dpdmVuIGEgdXNlciwgcmV0dXJucyBhbiBhY2NvdW50IGxldmVsCiAgLy8wID0gcmVndWxhciB1c2VyIChwYXlzIHRha2UgZmVlIGFuZCBtYWtlIGZlZSkKICAvLzEgPSBtYXJrZXQgbWFrZXIgc2lsdmVyIChwYXlzIHRha2UgZmVlLCBubyBtYWtlIGZlZSwgZ2V0cyByZWJhdGUpCiAgLy8yID0gbWFya2V0IG1ha2VyIGdvbGQgKHBheXMgdGFrZSBmZWUsIG5vIG1ha2UgZmVlLCBnZXRzIGVudGlyZSBjb3VudGVycGFydHkncyB0YWtlIGZlZSBhcyByZWJhdGUpCiAgZnVuY3Rpb24gYWNjb3VudExldmVsKGFkZHJlc3MgdXNlcikgY29uc3RhbnQgcmV0dXJucyh1aW50KSB7fQp9Cgpjb250cmFjdCBBY2NvdW50TGV2ZWxzVGVzdCBpcyBBY2NvdW50TGV2ZWxzIHsKICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBhY2NvdW50TGV2ZWxzOwoKICBmdW5jdGlvbiBzZXRBY2NvdW50TGV2ZWwoYWRkcmVzcyB1c2VyLCB1aW50IGxldmVsKSB7CiAgICBhY2NvdW50TGV2ZWxzW3VzZXJdID0gbGV2ZWw7CiAgfQoKICBmdW5jdGlvbiBhY2NvdW50TGV2ZWwoYWRkcmVzcyB1c2VyKSBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsKICAgIHJldHVybiBhY2NvdW50TGV2ZWxzW3VzZXJdOwogIH0KfQoKY29udHJhY3QgR2VuZXZFeGNoIGlzIFNhZmVNYXRoIHsKICBhZGRyZXNzIHB1YmxpYyBhZG1pbjsgLy90aGUgYWRtaW4gYWRkcmVzcwogIGFkZHJlc3MgcHVibGljIGZlZUFjY291bnQ7IC8vdGhlIGFjY291bnQgdGhhdCB3aWxsIHJlY2VpdmUgZmVlcwogIGFkZHJlc3MgcHVibGljIGFjY291bnRMZXZlbHNBZGRyOyAvL3RoZSBhZGRyZXNzIG9mIHRoZSBBY2NvdW50TGV2ZWxzIGNvbnRyYWN0CiAgdWludCBwdWJsaWMgZmVlTWFrZTsgLy9wZXJjZW50YWdlIHRpbWVzICgxIGV0aGVyKQogIHVpbnQgcHVibGljIGZlZVRha2U7IC8vcGVyY2VudGFnZSB0aW1lcyAoMSBldGhlcikKICB1aW50IHB1YmxpYyBmZWVSZWJhdGU7IC8vcGVyY2VudGFnZSB0aW1lcyAoMSBldGhlcikKICBieXRlczMyIHB1YmxpYyBoYXNoOwogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSkgcHVibGljIHRva2VuczsgLy9tYXBwaW5nIG9mIHRva2VuIGFkZHJlc3NlcyB0byBtYXBwaW5nIG9mIGFjY291bnQgYmFsYW5jZXMgKHRva2VuPTAgbWVhbnMgRXRoZXIpCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChieXRlczMyID0+IGJvb2wpKSBwdWJsaWMgb3JkZXJzOyAvL21hcHBpbmcgb2YgdXNlciBhY2NvdW50cyB0byBtYXBwaW5nIG9mIG9yZGVyIGhhc2hlcyB0byBib29sZWFucyAodHJ1ZSA9IHN1Ym1pdHRlZCBieSB1c2VyLCBlcXVpdmFsZW50IHRvIG9mZmNoYWluIHNpZ25hdHVyZSkKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludCkpIHB1YmxpYyBvcmRlckZpbGxzOyAvL21hcHBpbmcgb2YgdXNlciBhY2NvdW50cyB0byBtYXBwaW5nIG9mIG9yZGVyIGhhc2hlcyB0byB1aW50cyAoYW1vdW50IG9mIG9yZGVyIHRoYXQgaGFzIGJlZW4gZmlsbGVkKQoKICBldmVudCBPcmRlcihhZGRyZXNzIHRva2VuR2V0LCB1aW50IGFtb3VudEdldCwgYWRkcmVzcyB0b2tlbkdpdmUsIHVpbnQgYW1vdW50R2l2ZSwgdWludCBleHBpcmVzLCB1aW50IG5vbmNlLCBhZGRyZXNzIHVzZXIpOwogIGV2ZW50IENhbmNlbChhZGRyZXNzIHRva2VuR2V0LCB1aW50IGFtb3VudEdldCwgYWRkcmVzcyB0b2tlbkdpdmUsIHVpbnQgYW1vdW50R2l2ZSwgdWludCBleHBpcmVzLCB1aW50IG5vbmNlLCBhZGRyZXNzIHVzZXIsIHVpbnQ4IHYsIGJ5dGVzMzIgciwgYnl0ZXMzMiBzKTsKICBldmVudCBUcmFkZShhZGRyZXNzIHRva2VuR2V0LCB1aW50IGFtb3VudEdldCwgYWRkcmVzcyB0b2tlbkdpdmUsIHVpbnQgYW1vdW50R2l2ZSwgYWRkcmVzcyBnZXQsIGFkZHJlc3MgZ2l2ZSk7CiAgZXZlbnQgR3JhZmljbyh1aW50IGFtb3VudCx1aW50IGFtb3VudEdpdmUsdWludCBhbW91bnRHZXQpOwogIGV2ZW50IERlcG9zaXQoYWRkcmVzcyB0b2tlbiwgYWRkcmVzcyB1c2VyLCB1aW50IGFtb3VudCwgdWludCBiYWxhbmNlKTsKICBldmVudCBXaXRoZHJhdyhhZGRyZXNzIHRva2VuLCBhZGRyZXNzIHVzZXIsIHVpbnQgYW1vdW50LCB1aW50IGJhbGFuY2UpOwogIGV2ZW50IE1lc3NhZ2Uoc3RyaW5nIG1lc3NhZ2UpOwogIAogIGZ1bmN0aW9uIEdlbmV2RXhjaChhZGRyZXNzIGFkbWluXywgYWRkcmVzcyBmZWVBY2NvdW50XywgYWRkcmVzcyBhY2NvdW50TGV2ZWxzQWRkcl8sIHVpbnQgZmVlTWFrZV8sIHVpbnQgZmVlVGFrZV8sIHVpbnQgZmVlUmViYXRlXykgewogICAgYWRtaW4gPSBhZG1pbl87CiAgICBmZWVBY2NvdW50ID0gZmVlQWNjb3VudF87CiAgICBhY2NvdW50TGV2ZWxzQWRkciA9IGFjY291bnRMZXZlbHNBZGRyXzsKICAgIGZlZU1ha2UgPSBmZWVNYWtlXzsKICAgIGZlZVRha2UgPSBmZWVUYWtlXzsKICAgIGZlZVJlYmF0ZSA9IGZlZVJlYmF0ZV87CiAgfQoKICBmdW5jdGlvbigpIHsKICAgIHRocm93OwogIH0KCiAgZnVuY3Rpb24gdG9rZW5GYWxsYmFjayhhZGRyZXNzIF9mcm9tLCB1aW50IF92YWx1ZSwgYnl0ZXMgX2RhdGEpewogICAgLy90b2tlbnNbbXNnLnNlbmRlcl1bX2Zyb21dID0gc2FmZUFkZCh0b2tlbnNbbXNnLnNlbmRlcl1bX2Zyb21dLCBfdmFsdWUpOwogICAgLy9EZXBvc2l0KG1zZy5zZW5kZXIsIF9mcm9tLCBfdmFsdWUsIHRva2Vuc1ttc2cuc2VuZGVyXVtfZnJvbV0pOwogICB9CgogIGZ1bmN0aW9uIGNoYW5nZUFkbWluKGFkZHJlc3MgYWRtaW5fKSB7CiAgICBpZiAobXNnLnNlbmRlciAhPSBhZG1pbikgdGhyb3c7CiAgICBhZG1pbiA9IGFkbWluXzsKICB9CgogIGZ1bmN0aW9uIGNoYW5nZUFjY291bnRMZXZlbHNBZGRyKGFkZHJlc3MgYWNjb3VudExldmVsc0FkZHJfKSB7CiAgICBpZiAobXNnLnNlbmRlciAhPSBhZG1pbikgdGhyb3c7CiAgICBhY2NvdW50TGV2ZWxzQWRkciA9IGFjY291bnRMZXZlbHNBZGRyXzsKICB9CgogIGZ1bmN0aW9uIGNoYW5nZUZlZUFjY291bnQoYWRkcmVzcyBmZWVBY2NvdW50XykgewogICAgaWYgKG1zZy5zZW5kZXIgIT0gYWRtaW4pIHRocm93OwogICAgZmVlQWNjb3VudCA9IGZlZUFjY291bnRfOwogIH0KCiAgZnVuY3Rpb24gY2hhbmdlRmVlTWFrZSh1aW50IGZlZU1ha2VfKSB7CiAgICBpZiAobXNnLnNlbmRlciAhPSBhZG1pbikgdGhyb3c7CiAgICBpZiAoZmVlTWFrZV8gPiBmZWVNYWtlKSB0aHJvdzsKICAgIGZlZU1ha2UgPSBmZWVNYWtlXzsKICB9CgogIGZ1bmN0aW9uIGNoYW5nZUZlZVRha2UodWludCBmZWVUYWtlXykgewogICAgaWYgKG1zZy5zZW5kZXIgIT0gYWRtaW4pIHRocm93OwogICAgaWYgKGZlZVRha2VfID4gZmVlVGFrZSB8fCBmZWVUYWtlXyA8IGZlZVJlYmF0ZSkgdGhyb3c7CiAgICBmZWVUYWtlID0gZmVlVGFrZV87CiAgfQoKICBmdW5jdGlvbiBjaGFuZ2VGZWVSZWJhdGUodWludCBmZWVSZWJhdGVfKSB7CiAgICBpZiAobXNnLnNlbmRlciAhPSBhZG1pbikgdGhyb3c7CiAgICBpZiAoZmVlUmViYXRlXyA8IGZlZVJlYmF0ZSB8fCBmZWVSZWJhdGVfID4gZmVlVGFrZSkgdGhyb3c7CiAgICBmZWVSZWJhdGUgPSBmZWVSZWJhdGVfOwogIH0KCiAgZnVuY3Rpb24gZGVwb3NpdCgpIHBheWFibGUgewogICAgdG9rZW5zWzBdW21zZy5zZW5kZXJdID0gc2FmZUFkZCh0b2tlbnNbMF1bbXNnLnNlbmRlcl0sIG1zZy52YWx1ZSk7CiAgICBEZXBvc2l0KDAsIG1zZy5zZW5kZXIsIG1zZy52YWx1ZSwgdG9rZW5zWzBdW21zZy5zZW5kZXJdKTsKICB9CgogIGZ1bmN0aW9uIHdpdGhkcmF3KHVpbnQgYW1vdW50KSB7CiAgICBpZiAodG9rZW5zWzBdW21zZy5zZW5kZXJdIDwgYW1vdW50KSB0aHJvdzsKICAgIHRva2Vuc1swXVttc2cuc2VuZGVyXSA9IHNhZmVTdWIodG9rZW5zWzBdW21zZy5zZW5kZXJdLCBhbW91bnQpOwogICAgaWYgKCFtc2cuc2VuZGVyLmNhbGwudmFsdWUoYW1vdW50KSgpKSB0aHJvdzsKICAgIFdpdGhkcmF3KDAsIG1zZy5zZW5kZXIsIGFtb3VudCwgdG9rZW5zWzBdW21zZy5zZW5kZXJdKTsKICB9CgogIGZ1bmN0aW9uIGRlcG9zaXRUb2tlbihhZGRyZXNzIHRva2VuLCB1aW50IGFtb3VudCkgeyAvLyBOb3QgdXNlZAogICAgLy9yZW1lbWJlciB0byBjYWxsIFRva2VuKGFkZHJlc3MpLmFwcHJvdmUodGhpcywgYW1vdW50KSBvciB0aGlzIGNvbnRyYWN0IHdpbGwgbm90IGJlIGFibGUgdG8gZG8gdGhlIHRyYW5zZmVyIG9uIHlvdXIgYmVoYWxmLgogICAgaWYgKHRva2VuPT0wKSB0aHJvdzsKICAgIGlmICghVG9rZW4odG9rZW4pLnRyYW5zZmVyRnJvbShtc2cuc2VuZGVyLCB0aGlzLCBhbW91bnQpKSB0aHJvdzsKICAgIHRva2Vuc1t0b2tlbl1bbXNnLnNlbmRlcl0gPSBzYWZlQWRkKHRva2Vuc1t0b2tlbl1bbXNnLnNlbmRlcl0sIGFtb3VudCk7CiAgICBEZXBvc2l0KHRva2VuLCBtc2cuc2VuZGVyLCBhbW91bnQsIHRva2Vuc1t0b2tlbl1bbXNnLnNlbmRlcl0pOwogIH0KCiAgZnVuY3Rpb24gd2l0aGRyYXdUb2tlbihhZGRyZXNzIHRva2VuLCB1aW50IGFtb3VudCkgewogICAgaWYgKHRva2VuPT0wKSB0aHJvdzsKICAgIGlmICh0b2tlbnNbdG9rZW5dW21zZy5zZW5kZXJdIDwgYW1vdW50KSB0aHJvdzsKICAgIHRva2Vuc1t0b2tlbl1bbXNnLnNlbmRlcl0gPSBzYWZlU3ViKHRva2Vuc1t0b2tlbl1bbXNnLnNlbmRlcl0sIGFtb3VudCk7CiAgICBpZiAoIVRva2VuKHRva2VuKS50cmFuc2Zlcihtc2cuc2VuZGVyLCBhbW91bnQpKSB0aHJvdzsKICAgIFdpdGhkcmF3KHRva2VuLCBtc2cuc2VuZGVyLCBhbW91bnQsIHRva2Vuc1t0b2tlbl1bbXNnLnNlbmRlcl0pOwogIH0KCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgdG9rZW4sIGFkZHJlc3MgdXNlcikgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgcmV0dXJuIHRva2Vuc1t0b2tlbl1bdXNlcl07CiAgfQoKICBmdW5jdGlvbiBvcmRlcihhZGRyZXNzIHRva2VuR2V0LCB1aW50IGFtb3VudEdldCwgYWRkcmVzcyB0b2tlbkdpdmUsIHVpbnQgYW1vdW50R2l2ZSwgdWludCBleHBpcmVzLCB1aW50IG5vbmNlKSB7CiAgICBoYXNoID0gc2hhMjU2KHRoaXMsIHRva2VuR2V0LCBhbW91bnRHZXQsIHRva2VuR2l2ZSwgYW1vdW50R2l2ZSwgZXhwaXJlcywgbm9uY2UpOwogICAgb3JkZXJzW21zZy5zZW5kZXJdW2hhc2hdID0gdHJ1ZTsKICAgIE9yZGVyKHRva2VuR2V0LCBhbW91bnRHZXQsIHRva2VuR2l2ZSwgYW1vdW50R2l2ZSwgZXhwaXJlcywgbm9uY2UsIG1zZy5zZW5kZXIpOwogIH0KCiAgZnVuY3Rpb24gdHJhZGUoYWRkcmVzcyB0b2tlbkdldCwgdWludCBhbW91bnRHZXQsIGFkZHJlc3MgdG9rZW5HaXZlLCB1aW50IGFtb3VudEdpdmUsIHVpbnQgZXhwaXJlcywgdWludCBub25jZSwgYWRkcmVzcyB1c2VyLCB1aW50OCB2LCBieXRlczMyIHIsIGJ5dGVzMzIgcywgdWludCBhbW91bnQpIHsKICAgIC8vYW1vdW50IGlzIGluIGFtb3VudEdldCB0ZXJtcwogICAgaGFzaCA9IHNoYTI1Nih0aGlzLCB0b2tlbkdldCwgYW1vdW50R2V0LCB0b2tlbkdpdmUsIGFtb3VudEdpdmUsIGV4cGlyZXMsIG5vbmNlKTsKICAgIGlmICghKAogICAgICAob3JkZXJzW3VzZXJdW2hhc2hdIHx8IGVjcmVjb3ZlcihzaGEzKCJceDE5RXRoZXJldW0gU2lnbmVkIE1lc3NhZ2U6XG4zMiIsIGhhc2gpLHYscixzKSA9PSB1c2VyKSAmJgogICAgICBibG9jay5udW1iZXIgPD0gZXhwaXJlcyAmJgogICAgICBzYWZlQWRkKG9yZGVyRmlsbHNbdXNlcl1baGFzaF0sIGFtb3VudCkgPD0gYW1vdW50R2V0CiAgICApKSB0aHJvdzsKICAgIGlmKHRyYWRlQmFsYW5jZXModG9rZW5HZXQsIGFtb3VudEdldCwgdG9rZW5HaXZlLCBhbW91bnRHaXZlLCB1c2VyLCBhbW91bnQpKXsKICAgICAgTWVzc2FnZSgnaGl6byBiaWVuIGVsIHRyYWRlQmFsYW5jZXMnKTsKICAgIH1lbHNlewogICAgICBNZXNzYWdlKCdOTyBoaXpvIGJpZW4gZWwgdHJhZGVCYWxhbmNlcycpOwogICAgfQogICAgb3JkZXJGaWxsc1t1c2VyXVtoYXNoXSA9IHNhZmVBZGQob3JkZXJGaWxsc1t1c2VyXVtoYXNoXSwgYW1vdW50KTsKICAgIFRyYWRlKHRva2VuR2V0LCBhbW91bnQsIHRva2VuR2l2ZSwgYW1vdW50R2l2ZSAqIGFtb3VudCAvIGFtb3VudEdldCwgdXNlciwgbXNnLnNlbmRlcik7CiAgICBHcmFmaWNvKGFtb3VudCxhbW91bnRHaXZlLGFtb3VudEdldCk7CiAgfQoKICBmdW5jdGlvbiB0cmFkZUJhbGFuY2VzKGFkZHJlc3MgdG9rZW5HZXQsIHVpbnQgYW1vdW50R2V0LCBhZGRyZXNzIHRva2VuR2l2ZSwgdWludCBhbW91bnRHaXZlLCBhZGRyZXNzIHVzZXIsIHVpbnQgYW1vdW50KSByZXR1cm5zIChib29sKSB7CiAgICB1aW50IGZlZU1ha2VYZmVyID0gc2FmZU11bChhbW91bnQsIGZlZU1ha2UpIC8gKDEgZXRoZXIpOwogICAgdWludCBmZWVUYWtlWGZlciA9IHNhZmVNdWwoYW1vdW50LCBmZWVUYWtlKSAvICgxIGV0aGVyKTsKICAgIHVpbnQgZmVlUmViYXRlWGZlciA9IDA7CiAgICB1aW50IG11bHRpcGxpZXI7CiAgICBpZiAoYWNjb3VudExldmVsc0FkZHIgIT0gMHgwKSB7CiAgICAgIHVpbnQgYWNjb3VudExldmVsID0gQWNjb3VudExldmVscyhhY2NvdW50TGV2ZWxzQWRkcikuYWNjb3VudExldmVsKHVzZXIpOwogICAgICBpZiAoYWNjb3VudExldmVsPT0xKSBmZWVSZWJhdGVYZmVyID0gc2FmZU11bChhbW91bnQsIGZlZVJlYmF0ZSkgLyAoMSBldGhlcik7CiAgICAgIGlmIChhY2NvdW50TGV2ZWw9PTIpIGZlZVJlYmF0ZVhmZXIgPSBmZWVUYWtlWGZlcjsKICAgIH0KCiAgICAvLyB0b2tlbnNbdG9rZW5HZXRdW21zZy5zZW5kZXJdID0gc2FmZVN1Yih0b2tlbnNbdG9rZW5HZXRdW21zZy5zZW5kZXJdLCBzYWZlQWRkKGFtb3VudCwgZmVlVGFrZVhmZXIpKTsKICAgIC8vIHRva2Vuc1t0b2tlbkdldF1bdXNlcl0gPSBzYWZlQWRkKHRva2Vuc1t0b2tlbkdldF1bdXNlcl0sIHNhZmVTdWIoc2FmZUFkZChhbW91bnQsIGZlZVJlYmF0ZVhmZXIpLCBmZWVNYWtlWGZlcikpOwoKICAgIGlmKHRva2VuR2V0ICE9IDApewogICAgICBtdWx0aXBsaWVyID0gMTsKICAgIH1lbHNlewogICAgICBtdWx0aXBsaWVyID0gMTAwMDAwOwogICAgfQogICAgdG9rZW5zW3Rva2VuR2V0XVttc2cuc2VuZGVyXSA9IHNhZmVTdWIodG9rZW5zW3Rva2VuR2V0XVttc2cuc2VuZGVyXSwgYW1vdW50ICogbXVsdGlwbGllcik7CiAgICB0b2tlbnNbdG9rZW5HZXRdW3VzZXJdID0gc2FmZUFkZCh0b2tlbnNbdG9rZW5HZXRdW3VzZXJdLCBhbW91bnQgKiBtdWx0aXBsaWVyICk7IC8vIGFkZGluZyAxMDAwMDAwMDAgdG8gdGVzdCAKCiAgICB0b2tlbnNbdG9rZW5HZXRdW2ZlZUFjY291bnRdID0gc2FmZUFkZCh0b2tlbnNbdG9rZW5HZXRdW2ZlZUFjY291bnRdLCBzYWZlU3ViKHNhZmVBZGQoZmVlTWFrZVhmZXIsIGZlZVRha2VYZmVyKSwgZmVlUmViYXRlWGZlcikpOwogICAgLy8gdG9rZW5zW3Rva2VuR2l2ZV1bdXNlcl0gPSBzYWZlU3ViKHRva2Vuc1t0b2tlbkdpdmVdW3VzZXJdLCBzYWZlTXVsKGFtb3VudEdpdmUsIGFtb3VudCkgLyBhbW91bnRHZXQpOwogICAgLy8gdG9rZW5zW3Rva2VuR2l2ZV1bbXNnLnNlbmRlcl0gPSBzYWZlQWRkKHRva2Vuc1t0b2tlbkdpdmVdW21zZy5zZW5kZXJdLCBzYWZlTXVsKGFtb3VudEdpdmUsIGFtb3VudCkgLyBhbW91bnRHZXQpOwogICAgaWYodG9rZW5HZXQgIT0gMCl7CiAgICAgIG11bHRpcGxpZXIgPSAxMDAwMDA7CiAgICB9ZWxzZXsKICAgICAgbXVsdGlwbGllciA9IDE7CiAgICB9CiAgICB0b2tlbnNbdG9rZW5HaXZlXVt1c2VyXSA9IHNhZmVTdWIodG9rZW5zW3Rva2VuR2l2ZV1bdXNlcl0sIGFtb3VudCAqIG11bHRpcGxpZXIpOwogICAgdG9rZW5zW3Rva2VuR2l2ZV1bbXNnLnNlbmRlcl0gPSBzYWZlQWRkKHRva2Vuc1t0b2tlbkdpdmVdW21zZy5zZW5kZXJdLCBhbW91bnQgKiBtdWx0aXBsaWVyKTsKCiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgZnVuY3Rpb24gdGVzdFRyYWRlKGFkZHJlc3MgdG9rZW5HZXQsIHVpbnQgYW1vdW50R2V0LCBhZGRyZXNzIHRva2VuR2l2ZSwgdWludCBhbW91bnRHaXZlLCB1aW50IGV4cGlyZXMsIHVpbnQgbm9uY2UsIGFkZHJlc3MgdXNlciwgdWludDggdiwgYnl0ZXMzMiByLCBieXRlczMyIHMsIHVpbnQgYW1vdW50LCBhZGRyZXNzIHNlbmRlcikgY29uc3RhbnQgcmV0dXJucyhib29sKSB7CiAgICBpZiAoISgKICAgICAgdG9rZW5zW3Rva2VuR2V0XVtzZW5kZXJdID49IGFtb3VudCAmJgogICAgICBhdmFpbGFibGVWb2x1bWUodG9rZW5HZXQsIGFtb3VudEdldCwgdG9rZW5HaXZlLCBhbW91bnRHaXZlLCBleHBpcmVzLCBub25jZSwgdXNlciwgdiwgciwgcykgPj0gYW1vdW50CiAgICApKSByZXR1cm4gZmFsc2U7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGF2YWlsYWJsZVZvbHVtZShhZGRyZXNzIHRva2VuR2V0LCB1aW50IGFtb3VudEdldCwgYWRkcmVzcyB0b2tlbkdpdmUsIHVpbnQgYW1vdW50R2l2ZSwgdWludCBleHBpcmVzLCB1aW50IG5vbmNlLCBhZGRyZXNzIHVzZXIsIHVpbnQ4IHYsIGJ5dGVzMzIgciwgYnl0ZXMzMiBzKSBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsKICAgIGhhc2ggPSBzaGEyNTYodGhpcywgdG9rZW5HZXQsIGFtb3VudEdldCwgdG9rZW5HaXZlLCBhbW91bnRHaXZlLCBleHBpcmVzLCBub25jZSk7CiAgICBpZiAoISgKICAgICAgKG9yZGVyc1t1c2VyXVtoYXNoXSB8fCBlY3JlY292ZXIoc2hhMygiXHgxOUV0aGVyZXVtIFNpZ25lZCBNZXNzYWdlOlxuMzIiLCBoYXNoKSx2LHIscykgPT0gdXNlcikgJiYKICAgICAgYmxvY2subnVtYmVyIDw9IGV4cGlyZXMKICAgICkpIHJldHVybiAwOwogICAgdWludCBhdmFpbGFibGUxID0gc2FmZVN1YihhbW91bnRHZXQsIG9yZGVyRmlsbHNbdXNlcl1baGFzaF0pOwogICAgdWludCBhdmFpbGFibGUyID0gc2FmZU11bCh0b2tlbnNbdG9rZW5HaXZlXVt1c2VyXSwgYW1vdW50R2V0KSAvIGFtb3VudEdpdmU7CiAgICBpZiAoYXZhaWxhYmxlMTxhdmFpbGFibGUyKSByZXR1cm4gYXZhaWxhYmxlMTsKICAgIHJldHVybiBhdmFpbGFibGUyOwogIH0KCiAgZnVuY3Rpb24gYW1vdW50RmlsbGVkKGFkZHJlc3MgdG9rZW5HZXQsIHVpbnQgYW1vdW50R2V0LCBhZGRyZXNzIHRva2VuR2l2ZSwgdWludCBhbW91bnRHaXZlLCB1aW50IGV4cGlyZXMsIHVpbnQgbm9uY2UsIGFkZHJlc3MgdXNlciwgdWludDggdiwgYnl0ZXMzMiByLCBieXRlczMyIHMpIGNvbnN0YW50IHJldHVybnModWludCkgewogICAgaGFzaCA9IHNoYTI1Nih0aGlzLCB0b2tlbkdldCwgYW1vdW50R2V0LCB0b2tlbkdpdmUsIGFtb3VudEdpdmUsIGV4cGlyZXMsIG5vbmNlKTsKICAgIHJldHVybiBvcmRlckZpbGxzW3VzZXJdW2hhc2hdOwogIH0KCiAgZnVuY3Rpb24gY2FuY2VsT3JkZXIoYWRkcmVzcyB0b2tlbkdldCwgdWludCBhbW91bnRHZXQsIGFkZHJlc3MgdG9rZW5HaXZlLCB1aW50IGFtb3VudEdpdmUsIHVpbnQgZXhwaXJlcywgdWludCBub25jZSwgdWludDggdiwgYnl0ZXMzMiByLCBieXRlczMyIHMpIHsKICAgIGhhc2ggPSBzaGEyNTYodGhpcywgdG9rZW5HZXQsIGFtb3VudEdldCwgdG9rZW5HaXZlLCBhbW91bnRHaXZlLCBleHBpcmVzLCBub25jZSk7CiAgICBpZiAoIShvcmRlcnNbbXNnLnNlbmRlcl1baGFzaF0gfHwgZWNyZWNvdmVyKHNoYTMoIlx4MTlFdGhlcmV1bSBTaWduZWQgTWVzc2FnZTpcbjMyIiwgaGFzaCksdixyLHMpID09IG1zZy5zZW5kZXIpKSB0aHJvdzsKICAgIG9yZGVyRmlsbHNbbXNnLnNlbmRlcl1baGFzaF0gPSBhbW91bnRHZXQ7CiAgICBDYW5jZWwodG9rZW5HZXQsIGFtb3VudEdldCwgdG9rZW5HaXZlLCBhbW91bnRHaXZlLCBleHBpcmVzLCBub25jZSwgbXNnLnNlbmRlciwgdiwgciwgcyk7CiAgfQp9'.
	

]
