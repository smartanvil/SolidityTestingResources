Class {
	#name : #SRT51cf62dE2339682CD5905cbb32faD4403d0cab21,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT51cf62dE2339682CD5905cbb32faD4403d0cab21 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7Cgpjb250cmFjdCBvd25lZCB7CiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgICBmdW5jdGlvbiBvd25lZCgpIHB1YmxpYyB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICB9Cn0KCmludGVyZmFjZSB0b2tlblJlY2lwaWVudCB7IGZ1bmN0aW9uIHJlY2VpdmVBcHByb3ZhbChhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF92YWx1ZSwgYWRkcmVzcyBfdG9rZW4sIGJ5dGVzIF9leHRyYURhdGEpIHB1YmxpYzsgfQoKY29udHJhY3QgVG9rZW5FUkMyMCB7CiAgICAvLyBQdWJsaWMgdmFyaWFibGVzIG9mIHRoZSB0b2tlbgogICAgc3RyaW5nIHB1YmxpYyBuYW1lOwogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2w7CiAgICB1aW50OCBwdWJsaWMgZGVjaW1hbHM7CiAgICAvLyAxOCBkZWNpbWFscyBpcyB0aGUgc3Ryb25nbHkgc3VnZ2VzdGVkIGRlZmF1bHQsIGF2b2lkIGNoYW5naW5nIGl0CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgICAvLyBUaGlzIGNyZWF0ZXMgYW4gYXJyYXkgd2l0aCBhbGwgYmFsYW5jZXMKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGJhbGFuY2VPZjsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgcHVibGljIGFsbG93YW5jZTsKCiAgICAvLyBUaGlzIGdlbmVyYXRlcyBhIHB1YmxpYyBldmVudCBvbiB0aGUgYmxvY2tjaGFpbiB0aGF0IHdpbGwgbm90aWZ5IGNsaWVudHMKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwoKICAgIC8vIFRoaXMgbm90aWZpZXMgY2xpZW50cyBhYm91dCB0aGUgYW1vdW50IGJ1cm50CiAgICBldmVudCBCdXJuKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCB1aW50MjU2IHZhbHVlKTsKCiAgICAvKioKICAgICAqIENvbnN0cmN0b3IgZnVuY3Rpb24KICAgICAqCiAgICAgKiBJbml0aWFsaXplcyBjb250cmFjdCB3aXRoIGluaXRpYWwgc3VwcGx5IHRva2VucyB0byB0aGUgY3JlYXRvciBvZiB0aGUgY29udHJhY3QKICAgICAqLwogICAgZnVuY3Rpb24gVG9rZW5FUkMyMCgKICAgICAgICB1aW50MjU2IGluaXRpYWxTdXBwbHksCiAgICAgICAgc3RyaW5nIHRva2VuTmFtZSwKICAgICAgICBzdHJpbmcgdG9rZW5TeW1ib2wsCiAgICAgICAgdWludDggZGVjaW1hbFBhbGNlcwogICAgKSBwdWJsaWMgewogICAgICAgIHRvdGFsU3VwcGx5ID0gaW5pdGlhbFN1cHBseSAqIDEwICoqIHVpbnQyNTYoZGVjaW1hbFBhbGNlcyk7ICAvLyBVcGRhdGUgdG90YWwgc3VwcGx5IHdpdGggdGhlIGRlY2ltYWwgYW1vdW50CiAgICAgICAgYmFsYW5jZU9mW21zZy5zZW5kZXJdID0gdG90YWxTdXBwbHk7ICAgICAgICAgICAgICAgIC8vIEdpdmUgdGhlIGNyZWF0b3IgYWxsIGluaXRpYWwgdG9rZW5zCiAgICAgICAgbmFtZSA9IHRva2VuTmFtZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgbmFtZSBmb3IgZGlzcGxheSBwdXJwb3NlcwogICAgICAgIHN5bWJvbCA9IHRva2VuU3ltYm9sOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIHN5bWJvbCBmb3IgZGlzcGxheSBwdXJwb3NlcwogICAgICAgIGRlY2ltYWxzID0gZGVjaW1hbFBhbGNlczsKICAgIH0KCiAgICAvKioKICAgICAqIEludGVybmFsIHRyYW5zZmVyLCBvbmx5IGNhbiBiZSBjYWxsZWQgYnkgdGhpcyBjb250cmFjdAogICAgICovCiAgICBmdW5jdGlvbiBfdHJhbnNmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBpbnRlcm5hbCB7CiAgICAgICAgLy8gUHJldmVudCB0cmFuc2ZlciB0byAweDAgYWRkcmVzcy4gVXNlIGJ1cm4oKSBpbnN0ZWFkCiAgICAgICAgcmVxdWlyZShfdG8gIT0gMHgwKTsgICAgICAgIAogICAgICAgIHJlcXVpcmUoYmFsYW5jZU9mW19mcm9tXSA+PSBfdmFsdWUpOyAgICAgICAgCiAgICAgICAgcmVxdWlyZShiYWxhbmNlT2ZbX3RvXSArIF92YWx1ZSA+IGJhbGFuY2VPZltfdG9dKTsgICAgICAgIAogICAgICAgIHVpbnQgcHJldmlvdXNCYWxhbmNlcyA9IGJhbGFuY2VPZltfZnJvbV0gKyBiYWxhbmNlT2ZbX3RvXTsgICAgICAgIAogICAgICAgIGJhbGFuY2VPZltfZnJvbV0gLT0gX3ZhbHVlOyAgICAgICAgCiAgICAgICAgYmFsYW5jZU9mW190b10gKz0gX3ZhbHVlOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgLy8gQXNzZXJ0cyBhcmUgdXNlZCB0byB1c2Ugc3RhdGljIGFuYWx5c2lzIHRvIGZpbmQgYnVncyBpbiB5b3VyIGNvZGUuIFRoZXkgc2hvdWxkIG5ldmVyIGZhaWwKICAgICAgICBhc3NlcnQoYmFsYW5jZU9mW19mcm9tXSArIGJhbGFuY2VPZltfdG9dID09IHByZXZpb3VzQmFsYW5jZXMpOwogICAgfQoKICAgIC8qKgogICAgICogVHJhbnNmZXIgdG9rZW5zCiAgICAgKiBTZW5kIGBfdmFsdWVgIHRva2VucyB0byBgX3RvYCBmcm9tIHlvdXIgYWNjb3VudCAgICAgCiAgICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQKICAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIGFtb3VudCB0byBzZW5kCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHsKICAgICAgICBfdHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgICogVHJhbnNmZXIgdG9rZW5zIGZyb20gb3RoZXIgYWRkcmVzcwogICAgICogU2VuZCBgX3ZhbHVlYCB0b2tlbnMgdG8gYF90b2AgaW4gYmVoYWxmIG9mIGBfZnJvbWAKICAgICAqIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyCiAgICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQKICAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIGFtb3VudCB0byBzZW5kCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdKTsgICAgIC8vIENoZWNrIGFsbG93YW5jZQogICAgICAgIGFsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOwogICAgICAgIF90cmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IGFsbG93YW5jZSBmb3Igb3RoZXIgYWRkcmVzcwogICAgICogQWxsb3dzIGBfc3BlbmRlcmAgdG8gc3BlbmQgbm8gbW9yZSB0aGFuIGBfdmFsdWVgIHRva2VucyBpbiB5b3VyIGJlaGFsZgogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIGF1dGhvcml6ZWQgdG8gc3BlbmQKICAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIG1heCBhbW91bnQgdGhleSBjYW4gc3BlbmQKICAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgYWxsb3dhbmNlW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCBhbGxvd2FuY2UgZm9yIG90aGVyIGFkZHJlc3MgYW5kIG5vdGlmeQogICAgICogQWxsb3dzIGBfc3BlbmRlcmAgdG8gc3BlbmQgbm8gbW9yZSB0aGFuIGBfdmFsdWVgIHRva2VucyBpbiB5b3VyIGJlaGFsZiwgYW5kIHRoZW4gcGluZyB0aGUgY29udHJhY3QgYWJvdXQgaXQKICAgICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBhdXRob3JpemVkIHRvIHNwZW5kCiAgICAgKiBAcGFyYW0gX3ZhbHVlIHRoZSBtYXggYW1vdW50IHRoZXkgY2FuIHNwZW5kCiAgICAgKiBAcGFyYW0gX2V4dHJhRGF0YSBzb21lIGV4dHJhIGluZm9ybWF0aW9uIHRvIHNlbmQgdG8gdGhlIGFwcHJvdmVkIGNvbnRyYWN0CiAgICAgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmVBbmRDYWxsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZXh0cmFEYXRhKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKQogICAgewogICAgICAgIHRva2VuUmVjaXBpZW50IHNwZW5kZXIgPSB0b2tlblJlY2lwaWVudChfc3BlbmRlcik7CiAgICAgICAgaWYgKGFwcHJvdmUoX3NwZW5kZXIsIF92YWx1ZSkpIHsKICAgICAgICAgICAgc3BlbmRlci5yZWNlaXZlQXBwcm92YWwobXNnLnNlbmRlciwgX3ZhbHVlLCB0aGlzLCBfZXh0cmFEYXRhKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogRGVzdHJveSB0b2tlbnMKICAgICAqIFJlbW92ZSBgX3ZhbHVlYCB0b2tlbnMgZnJvbSB0aGUgc3lzdGVtIGlycmV2ZXJzaWJseQogICAgICogQHBhcmFtIF92YWx1ZSB0aGUgYW1vdW50IG9mIG1vbmV5IHRvIGJ1cm4KICAgICAqLwogICAgZnVuY3Rpb24gYnVybih1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoYmFsYW5jZU9mW21zZy5zZW5kZXJdID49IF92YWx1ZSk7ICAgLy8gQ2hlY2sgaWYgdGhlIHNlbmRlciBoYXMgZW5vdWdoCiAgICAgICAgYmFsYW5jZU9mW21zZy5zZW5kZXJdIC09IF92YWx1ZTsgICAgICAgICAgICAvLyBTdWJ0cmFjdCBmcm9tIHRoZSBzZW5kZXIKICAgICAgICB0b3RhbFN1cHBseSAtPSBfdmFsdWU7ICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZXMgdG90YWxTdXBwbHkKICAgICAgICBCdXJuKG1zZy5zZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBEZXN0cm95IHRva2VucyBmcm9tIG90aGVyIGFjY291bnQKICAgICAqIFJlbW92ZSBgX3ZhbHVlYCB0b2tlbnMgZnJvbSB0aGUgc3lzdGVtIGlycmV2ZXJzaWJseSBvbiBiZWhhbGYgb2YgYF9mcm9tYC4KICAgICAqIEBwYXJhbSBfZnJvbSB0aGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyCiAgICAgKiBAcGFyYW0gX3ZhbHVlIHRoZSBhbW91bnQgb2YgbW9uZXkgdG8gYnVybgogICAgICovCiAgICBmdW5jdGlvbiBidXJuRnJvbShhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoYmFsYW5jZU9mW19mcm9tXSA+PSBfdmFsdWUpOyAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgdGFyZ2V0ZWQgYmFsYW5jZSBpcyBlbm91Z2gKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdKTsgICAgLy8gQ2hlY2sgYWxsb3dhbmNlCiAgICAgICAgYmFsYW5jZU9mW19mcm9tXSAtPSBfdmFsdWU7ICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN1YnRyYWN0IGZyb20gdGhlIHRhcmdldGVkIGJhbGFuY2UKICAgICAgICBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdIC09IF92YWx1ZTsgICAgICAgICAgICAgLy8gU3VidHJhY3QgZnJvbSB0aGUgc2VuZGVyJ3MgYWxsb3dhbmNlCiAgICAgICAgdG90YWxTdXBwbHkgLT0gX3ZhbHVlOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0b3RhbFN1cHBseQogICAgICAgIEJ1cm4oX2Zyb20sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0KCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qICAgICBVVElMSVRZIEZVTkNUSU9OUyBTVEFSVFMgSEVSRSAgICAgICovCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgpjb250cmFjdCB1dGlsaXR5CnsKICAgIGV2ZW50IGNoZWNrMSh1aW50MjU2IHZhbDEpOwogICAgZnVuY3Rpb24gY2FsY3VsYXRlRXRoZXJzKHVpbnQgbnVtYmVyT2ZUb2tlbnMsIHVpbnQgcHJpY2UsIHVpbnQgX2RlY2ltYWxWYWx1ZSkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyh1aW50IGV0aGVycykKICAgIHsKICAgICAgICBldGhlcnMgPSBudW1iZXJPZlRva2VucypwcmljZTsKICAgICAgICBldGhlcnMgPSBldGhlcnMgLyAxMCoqX2RlY2ltYWxWYWx1ZTsKICAgICAgICBjaGVjazEoZXRoZXJzKTsKICAgICAgICByZXR1cm4gKGV0aGVycyk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZVRva2Vucyh1aW50IF9hbW91bnQsIHVpbnQgX3JhdGUsIHVpbnQgX2RlY2ltYWxWYWx1ZSkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyh1aW50IHRva2VucywgdWludCBleGNlc3NFdGhlcnMpIAogICAgewogICAgICAgIHRva2VucyA9IF9hbW91bnQqMTAqKl9kZWNpbWFsVmFsdWU7CiAgICAgICAgdG9rZW5zID0gdG9rZW5zL19yYXRlOwogICAgICAgIGV4Y2Vzc0V0aGVycyA9IF9hbW91bnQtKCh0b2tlbnMqX3JhdGUpLzEwKipfZGVjaW1hbFZhbHVlKTsKICAgICAgICByZXR1cm4gKHRva2VucywgZXhjZXNzRXRoZXJzKTsKICAgIH0gCiAgICAKICAgCiAgICBmdW5jdGlvbiBkZWNpbWFsQWRqdXN0bWVudCh1aW50IF9hbW91bnQsIHVpbnQgX2RlY2ltYWxQbGFjZXMpIGNvbnN0YW50IGludGVybmFsIHJldHVybnModWludCBhZGp1c3RlZFZhbHVlKQogICAgewogICAgICAgIHVpbnQgZGlmZiA9IDE4LV9kZWNpbWFsUGxhY2VzOwogICAgICAgIHVpbnQgYWRqdXN0ID0gMSoxMCoqZGlmZjsKICAgICAgIAogICAgICAgIGFkanVzdGVkVmFsdWUgPSBfYW1vdW50L2FkanVzdDsKICAgICAgIAogICAgICAgIHJldHVybiBhZGp1c3RlZFZhbHVlOyAgICAgICAKICAgIH0KICAgCiAgICAvLyBmdW5jdGlvbiBjZWlsKHVpbnQgYSwgdWludCBtKSBjb25zdGFudCByZXR1cm5zICh1aW50ICkgewogICAgLy8gICAgIHJldHVybiAoKGEgKyBtIC0gMSkgLyBtKSAqIG07CiAgICAvLyB9Cn0KCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qICAgICAgIEFEVkFOQ0VEIFRPS0VOIFNUQVJUUyBIRVJFICAgICAgICovCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgpjb250cmFjdCBUb2tlbk5XVEMgaXMgb3duZWQsIFRva2VuRVJDMjAsIHV0aWxpdHkgewogICAgCiAgICBldmVudCBjaGVjayh1aW50MjU2IHZhbDEpOwogICAgCiAgICB1aW50MjU2IHB1YmxpYyBzZWxsUHJpY2U7CiAgICB1aW50MjU2IHB1YmxpYyBidXlQcmljZTsKICAgIGFkZHJlc3NbXSBmcnpBY2M7CiAgICBhZGRyZXNzW10gdXNlcnM7CiAgICBhZGRyZXNzW10gZnJ6QWNjMTsKICAgIGFkZHJlc3NbXSB1c2VyczE7CiAgICB1aW50MjU2IHNlbGxUb2tlbkFtb3VudDsKCiAgICBib29sIGVtZXJnZW5jeUZyZWV6ZTsgICAgICAgLy8gSWYgdGhpcyB2YXJpYWJsZSBpcyB0cnVlIHRoZW4gYWxsIGFjY291bnQgd2lsbCBiZSBmcm96ZW4gYW5kIGNhbiBub3QgdHJhbnNmZXIvcmVjaWV2ZSB0b2tlbnMuCgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgZnJvemVuQWNjb3VudDsKICAgIG1hcHBpbmcgKHVpbnQgPT4gYWRkcmVzcykgcHVibGljIHRva2VuVXNlcnM7CgogICAgLyogVGhpcyBnZW5lcmF0ZXMgYSBwdWJsaWMgZXZlbnQgb24gdGhlIGJsb2NrY2hhaW4gdGhhdCB3aWxsIG5vdGlmeSBjbGllbnRzICovCiAgICBldmVudCBGcm96ZW5GdW5kcyhhZGRyZXNzIHRhcmdldCwgYm9vbCBmcm96ZW4pOwoKICAgIC8qIEluaXRpYWxpemVzIGNvbnRyYWN0IHdpdGggaW5pdGlhbCBzdXBwbHkgdG9rZW5zIHRvIHRoZSBjcmVhdG9yIG9mIHRoZSBjb250cmFjdCAqLwogICAgZnVuY3Rpb24gVG9rZW5OV1RDKAogICAgICAgIHVpbnQyNTYgaW5pdGlhbFN1cHBseSwKICAgICAgICBzdHJpbmcgdG9rZW5OYW1lLAogICAgICAgIHN0cmluZyB0b2tlblN5bWJvbCwKICAgICAgICB1aW50OCBkZWNpbWFsUGFsY2VzCiAgICApIFRva2VuRVJDMjAoaW5pdGlhbFN1cHBseSwgdG9rZW5OYW1lLCB0b2tlblN5bWJvbCwgZGVjaW1hbFBhbGNlcykgcHVibGljIHt9CgogICAgLyogSW50ZXJuYWwgdHJhbnNmZXIsIG9ubHkgY2FuIGJlIGNhbGxlZCBieSB0aGlzIGNvbnRyYWN0ICovCiAgICBmdW5jdGlvbiBfdHJhbnNmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBpbnRlcm5hbCB7CiAgICAgICAgcmVxdWlyZSAoX3RvICE9IDB4MCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFByZXZlbnQgdHJhbnNmZXIgdG8gMHgwIGFkZHJlc3MuIFVzZSBidXJuKCkgaW5zdGVhZAogICAgICAgIHJlcXVpcmUgKGJhbGFuY2VPZltfZnJvbV0gPj0gX3ZhbHVlKTsgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHNlbmRlciBoYXMgZW5vdWdoCiAgICAgICAgcmVxdWlyZSAoYmFsYW5jZU9mW190b10gKyBfdmFsdWUgPiBiYWxhbmNlT2ZbX3RvXSk7IC8vIENoZWNrIGZvciBvdmVyZmxvd3MKICAgICAgICByZXF1aXJlKCFmcm96ZW5BY2NvdW50W19mcm9tXSk7ICAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgc2VuZGVyIGlzIGZyb3plbgogICAgICAgIHJlcXVpcmUoIWZyb3plbkFjY291bnRbX3RvXSk7ICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiByZWNpcGllbnQgaXMgZnJvemVuCiAgICAgICAgcmVxdWlyZSghZW1lcmdlbmN5RnJlZXplKTsgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGVtZXJnZW5jeUZyZWV6ZSBlbmFibGUgIC8vIGJ5IEpELgogICAgICAgIGJhbGFuY2VPZltfZnJvbV0gLT0gX3ZhbHVlOyAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTdWJ0cmFjdCBmcm9tIHRoZSBzZW5kZXIKICAgICAgICBiYWxhbmNlT2ZbX3RvXSArPSBfdmFsdWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHRoZSBzYW1lIHRvIHRoZSByZWNpcGllbnQKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgICAgIHNlbGxUb2tlbkFtb3VudCArPSBfdmFsdWU7CiAgICAgICAgCiAgICAgICAgaWYgKHVzZXJzLmxlbmd0aD4wKXsKICAgICAgICAgICAgICAgIHVpbnQgY291bnQ9MDsKICAgICAgICAgICAgZm9yICh1aW50IGE9MDthPHVzZXJzLmxlbmd0aDthKyspCiAgICAgICAgICAgIHsKICAgICAgICAgICAgaWYgKHVzZXJzW2FdPT1fdG8pewogICAgICAgICAgICBjb3VudD1jb3VudCsxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGNvdW50PT0wKXsKICAgICAgICAgICAgICAgIHVzZXJzLnB1c2goX3RvKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgIAogICAgICAgIH0KICAgICAgICBlbHNlewogICAgICAgICAgICB1c2Vycy5wdXNoKF90byk7CiAgICAgICAgfQogICAgfQogICAgCgogICAgLy8gQG5vdGljZSBDcmVhdGUgYG1pbnRlZEFtb3VudGAgdG9rZW5zIGFuZCBzZW5kIGl0IHRvIGB0YXJnZXRgCiAgICAvLyBAcGFyYW0gdGFyZ2V0IEFkZHJlc3MgdG8gcmVjZWl2ZSB0aGUgdG9rZW5zCiAgICAvLyBAcGFyYW0gbWludGVkQW1vdW50IHRoZSBhbW91bnQgb2YgdG9rZW5zIGl0IHdpbGwgcmVjZWl2ZQogICAgLy8gYW1vdW50IHNob3VsZCBiZSBpbiBmb3JtIG9mIGRlY2ltYWwgc3BlY2lmaWVkIGluIHRoaXMgY29udHJhY3QuCiAgICBmdW5jdGlvbiBtaW50VG9rZW4oYWRkcmVzcyB0YXJnZXQsIHVpbnQyNTYgbWludGVkQW1vdW50KSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICAvL3JlcXVpcmUodGFyZ2V0IT0weDApOwogICAgICAgIGJhbGFuY2VPZlt0YXJnZXRdICs9IG1pbnRlZEFtb3VudDsKICAgICAgICB0b3RhbFN1cHBseSArPSBtaW50ZWRBbW91bnQ7CiAgICAgICAgVHJhbnNmZXIoMCwgdGhpcywgbWludGVkQW1vdW50KTsKICAgICAgICBUcmFuc2Zlcih0aGlzLCB0YXJnZXQsIG1pbnRlZEFtb3VudCk7CiAgICAgICAgc2VsbFRva2VuQW1vdW50ICs9IG1pbnRlZEFtb3VudDsKICAgICAgICAKICAgICAgICAgaWYgKHVzZXJzLmxlbmd0aD4wKXsKICAgICAgICAgICAgICAgIHVpbnQgY291bnQxPTA7CiAgICAgICAgICAgIGZvciAodWludCBhPTA7YTx1c2Vycy5sZW5ndGg7YSsrKQogICAgICAgICAgICB7CiAgICAgICAgICAgIGlmICh1c2Vyc1thXT09dGFyZ2V0KXsKICAgICAgICAgICAgY291bnQxPWNvdW50MSsxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGNvdW50MT09MCl7CiAgICAgICAgICAgICAgICB1c2Vycy5wdXNoKHRhcmdldCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgZWxzZXsKICAgICAgICAgICAgdXNlcnMucHVzaCh0YXJnZXQpOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8gQG5vdGljZSBgZnJlZXplPyBQcmV2ZW50IHwgQWxsb3dgIGB0YXJnZXRgIGZyb20gc2VuZGluZyAmIHJlY2VpdmluZyB0b2tlbnMKICAgIC8vLyBAcGFyYW0gdGFyZ2V0IEFkZHJlc3MgdG8gYmUgZnJvemVuCiAgICAvLy8gQHBhcmFtIGZyZWV6ZSBlaXRoZXIgdG8gZnJlZXplIGl0IG9yIG5vdAogICAgZnVuY3Rpb24gZnJlZXplQWNjb3VudChhZGRyZXNzIHRhcmdldCwgYm9vbCBmcmVlemUpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIC8vcmVxdWlyZSh0YXJnZXQhPTB4MCk7CiAgICAgICAgZnJvemVuQWNjb3VudFt0YXJnZXRdID0gZnJlZXplOwogICAgICAgIEZyb3plbkZ1bmRzKHRhcmdldCwgZnJlZXplKTsKICAgICAgICBpZiAoZnJ6QWNjLmxlbmd0aD4wKXsKICAgICAgICAgICAgICAgIHVpbnQgY291bnQ9MDsKICAgICAgICAgICAgZm9yICh1aW50IGE9MDthPGZyekFjYy5sZW5ndGg7YSsrKQogICAgICAgICAgICB7CiAgICAgICAgICAgIGlmIChmcnpBY2NbYV09PXRhcmdldCl7CiAgICAgICAgICAgIGNvdW50PWNvdW50KzE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoY291bnQ9PTApewogICAgICAgICAgICAgICAgZnJ6QWNjLnB1c2godGFyZ2V0KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlewogICAgICAgICAgICBmcnpBY2MucHVzaCh0YXJnZXQpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBmcmVlemVBbGxBY2NvdW50SW5FbWVyZ2VuY3koYm9vbCBmcmVlemVBbGwpIG9ubHlPd25lciBwdWJsaWMKICAgIHsKICAgICAgICBlbWVyZ2VuY3lGcmVlemUgPSBmcmVlemVBbGw7ICAgIAogICAgfQoKICAgIC8vLyBub3RpY2UgQWxsb3cgdXNlcnMgdG8gYnV5IHRva2VucyBmb3IgYG5ld0J1eVByaWNlYCBldGggYW5kIHNlbGwgdG9rZW5zIGZvciBgbmV3U2VsbFByaWNlYCBldGgKICAgIC8vLyBAcGFyYW0gbmV3U2VsbFByaWNlIFByaWNlIHRoZSB1c2VycyBjYW4gc2VsbCB0byB0aGUgY29udHJhY3QKICAgIC8vLyBAcGFyYW0gbmV3QnV5UHJpY2UgUHJpY2UgdXNlcnMgY2FuIGJ1eSBmcm9tIHRoZSBjb250cmFjdAogICAgZnVuY3Rpb24gc2V0UHJpY2VzKHVpbnQyNTYgbmV3U2VsbFByaWNlLCB1aW50MjU2IG5ld0J1eVByaWNlKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKG5ld1NlbGxQcmljZSE9MCB8fCBzZWxsUHJpY2UhPTApOwogICAgICAgIHJlcXVpcmUobmV3QnV5UHJpY2UhPTAgfHwgYnV5UHJpY2UhPTApOyAKICAgICAgICBpZihuZXdTZWxsUHJpY2UhPTApCiAgICAgICAgewogICAgICAgICAgICBzZWxsUHJpY2UgPSBuZXdTZWxsUHJpY2U7CiAgICAgICAgfQogICAgICAgIGlmKG5ld0J1eVByaWNlIT0wKQogICAgICAgIHsKICAgICAgICAgICAgYnV5UHJpY2UgPSBuZXdCdXlQcmljZTsKICAgICAgICB9CiAgICB9CgogICAgLy8vIEBub3RpY2UgQnV5IHRva2VucyBmcm9tIGNvbnRyYWN0IGJ5IHNlbmRpbmcgZXRoZXIKICAgIGZ1bmN0aW9uIGJ1eSgpIHBheWFibGUgcHVibGljIHsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSE9MCk7CiAgICAgICAgcmVxdWlyZShidXlQcmljZSE9MCk7CiAgICAgICAgdWludCBleGNlZWRlZEV0aGVyczsKICAgICAgICB1aW50IGFtb3VudCA9IG1zZy52YWx1ZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1zZy52YWx1ZSB3aWxsIGJlIGluIHdlaS4gICAKICAgICAgICAoYW1vdW50LCBleGNlZWRlZEV0aGVycykgPSBjYWxjdWxhdGVUb2tlbnMoYW1vdW50LCBidXlQcmljZSwgZGVjaW1hbHMpOwogICAgICAgIHJlcXVpcmUoYW1vdW50IT0wKTsKICAgICAgICBfdHJhbnNmZXIodGhpcywgbXNnLnNlbmRlciwgYW1vdW50KTsgICAgICAgICAgICAgIC8vIG1ha2VzIHRoZSB0cmFuc2ZlcnMuCiAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihleGNlZWRlZEV0aGVycyk7Ly8gc2VuZHMgZXhjZWVkZWQgZXRoZXIgdG8gdGhlIHNlbGxlci4KICAgICAgICAKICAgICAgIC8vIGFkZFVzZXJzKG1zZy5zZW5kZXIpOwogICAgICAgIAogICAgICAgIGlmICh1c2Vycy5sZW5ndGg+MCl7CiAgICAgICAgICAgICAgICB1aW50IGNvdW50PTA7CiAgICAgICAgICAgIGZvciAodWludCBhPTA7YTx1c2Vycy5sZW5ndGg7YSsrKQogICAgICAgICAgICB7CiAgICAgICAgICAgIGlmICh1c2Vyc1thXT09bXNnLnNlbmRlcil7CiAgICAgICAgICAgIGNvdW50PWNvdW50KzE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoY291bnQ9PTApewogICAgICAgICAgICAgICAgdXNlcnMucHVzaChtc2cuc2VuZGVyKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgIAogICAgICAgIH0KICAgICAgICBlbHNlewogICAgICAgICAgICB1c2Vycy5wdXNoKG1zZy5zZW5kZXIpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAKICAgIH0KCiAgICAvLyBAbm90aWNlIFNlbGwgYGFtb3VudGAgdG9rZW5zIHRvIGNvbnRyYWN0CiAgICAvLyBAcGFyYW0gYW1vdW50IGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc29sZAogICAgLy8gYW1vdW50IHNob3VsZCBiZSBpbiBmb3JtIG9mIGRlY2ltYWwgc3BlY2lmaWVkIGluIHRoaXMgY29udHJhY3QuIAogICAgZnVuY3Rpb24gc2VsbCh1aW50MjU2IGFtb3VudCkgcHVibGljIHsKICAgICAgICByZXF1aXJlKGFtb3VudCE9MCk7CiAgICAgICAgcmVxdWlyZShzZWxsUHJpY2UhPTApOwogICAgICAgIHVpbnQgZXRoZXJBbW91bnQ7CiAgICAgICAgZXRoZXJBbW91bnQgPSBjYWxjdWxhdGVFdGhlcnMoYW1vdW50LCBzZWxsUHJpY2UsIGRlY2ltYWxzKTsKICAgICAgICByZXF1aXJlKHRoaXMuYmFsYW5jZSA+PSBldGhlckFtb3VudCk7ICAgICAgICAgICAvLyBjaGVja3MgaWYgdGhlIGNvbnRyYWN0IGhhcyBlbm91Z2ggZXRoZXIgdG8gYnV5CiAgICAgICAgX3RyYW5zZmVyKG1zZy5zZW5kZXIsIHRoaXMsIGFtb3VudCk7ICAgICAvLyBtYWtlcyB0aGUgdHJhbnNmZXJzCiAgICAgICAgY2hlY2soZXRoZXJBbW91bnQpOwogICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoZXRoZXJBbW91bnQpOyAgICAgICAgICAgICAgIC8vIHNlbmRzIGV0aGVyIHRvIHRoZSBzZWxsZXIuIEl0J3MgaW1wb3J0YW50IHRvIGRvIHRoaXMgbGFzdCB0byBhdm9pZCByZWN1cnNpb24gYXR0YWNrcwogICAgfQoKCiAgICBmdW5jdGlvbiByZWFkQWxsVXNlcnMoKWNvbnN0YW50IHJldHVybnMoYWRkcmVzc1tdKXsKCSAgICAgIAoJICAgICAgCgkgICAgICAgICAgZm9yICh1aW50IGs9MDtrPHVzZXJzLmxlbmd0aDtrKyspewoJICAgICAgICAgICAgICBpZiAoYmFsYW5jZU9mW3VzZXJzW2tdXT4wKXsKCSAgICAgICAgICAgICAgICAgIHVzZXJzMS5wdXNoKHVzZXJzW2tdKTsKCSAgICAgICAgICAgICAgfQoJICAgICAgICAgIH0KCSAgICAgIAogICAgICAgcmV0dXJuIHVzZXJzMTsKICAgfQogICAKICAgZnVuY3Rpb24gcmVhZEFsbEZyekFjYygpY29uc3RhbnQgcmV0dXJucyhhZGRyZXNzW10pewogICAgICAgZm9yICh1aW50IGs9MDtrPGZyekFjYy5sZW5ndGg7aysrKXsKCSAgICAgICAgICAgICAgaWYgKGZyb3plbkFjY291bnRbZnJ6QWNjW2tdXSA9PSB0cnVlKXsKCSAgICAgICAgICAgICAgICAgIGZyekFjYzEucHVzaChmcnpBY2Nba10pOwoJICAgICAgICAgICAgICB9CgkgICAgICAgICAgfQogICAgICAgcmV0dXJuIGZyekFjYzE7CiAgIH0KICAgCiAgIGZ1bmN0aW9uIHJlYWRTZWxsVG9rZW5BbW91bnQoKWNvbnN0YW50IHJldHVybnModWludDI1Nil7CiAgICAgICByZXR1cm4gc2VsbFRva2VuQW1vdW50OwogICB9CiAgIAogICAKLy8gICBmdW5jdGlvbiBhZGRVc2VycyhhZGRyZXNzIGFkZCkgaW50ZXJuYWx7Ci8vICAgICAgIHVpbnQgdG90YWxVc2VycyA9IHRvdGFsVXNlcnMrMTsKLy8gICAgICAgdG9rZW5Vc2Vyc1t0b3RhbFVzZXJzXSA9IGFkZDsKLy8gICB9CiAgIAovLyAgICAgZnVuY3Rpb24gdHJhbnNmZXIxKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSl7CgovLyAJCS8vIGlmKGZyb3plbkFjY291bnRbbXNnLnNlbmRlcl0pIHRocm93OwovLyAJCSAgICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHNlbmRlciBpcyBmcm96ZW4KLy8gICAgICAgICByZXF1aXJlKCFmcm96ZW5BY2NvdW50W190b10pOyAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgcmVjaXBpZW50IGlzIGZyb3plbgovLyAgICAgICAgIHJlcXVpcmUoIWVtZXJnZW5jeUZyZWV6ZSk7IAovLyAJCXJlcXVpcmUoIWZyb3plbkFjY291bnRbbXNnLnNlbmRlcl0pOwovLyAJCS8vIGlmKGJhbGFuY2VPZlttc2cuc2VuZGVyXSA8IF92YWx1ZSkgdGhyb3c7Ci8vIAkJcmVxdWlyZShiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlKTsKLy8gCQkvLyBpZihiYWxhbmNlT2ZbX3RvXSArIF92YWx1ZSA8IGJhbGFuY2VPZltfdG9dKSB0aHJvdzsKLy8gCQlyZXF1aXJlKGJhbGFuY2VPZltfdG9dICsgX3ZhbHVlID49IGJhbGFuY2VPZltfdG9dKTsKLy8gCQkvL2lmKGFkbWluKQoKLy8gCQliYWxhbmNlT2ZbbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOwovLyAJCWJhbGFuY2VPZltfdG9dICs9IF92YWx1ZTsKLy8gCQlUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7Ci8vIAl9CgovLyAJZnVuY3Rpb24gdHJhbnNmZXJGcm9tMShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyl7Ci8vIAkJLy8gaWYoZnJvemVuQWNjb3VudFtfZnJvbV0pIHRocm93OwovLyAJCXJlcXVpcmUoIWZyb3plbkFjY291bnRbX2Zyb21dKTsKLy8gCQkvLyBpZihiYWxhbmNlT2ZbX2Zyb21dIDwgX3ZhbHVlKSB0aHJvdzsKLy8gCQlyZXF1aXJlKGJhbGFuY2VPZltfZnJvbV0gPj0gX3ZhbHVlKTsKLy8gCQkvLyBpZihiYWxhbmNlT2ZbX3RvXSArIF92YWx1ZSA8IGJhbGFuY2VPZltfdG9dKSB0aHJvdzsKLy8gCQlyZXF1aXJlKGJhbGFuY2VPZltfdG9dICsgX3ZhbHVlID49IGJhbGFuY2VPZltfdG9dKTsKLy8gCQkvLyBpZihfdmFsdWUgPiBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdKSB0aHJvdzsKLy8gCQlyZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdKTsKLy8gCQliYWxhbmNlT2ZbX2Zyb21dIC09IF92YWx1ZTsKLy8gCQliYWxhbmNlT2ZbX3RvXSArPSBfdmFsdWU7Ci8vIAkJYWxsb3dhbmNlW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7Ci8vIAkJVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKLy8gCQlyZXR1cm4gdHJ1ZTsKCi8vIAl9CgogICAgLyoqCiAgICAgKiBTZXQgYWxsb3dhbmNlIGZvciBvdGhlciBhZGRyZXNzCiAgICAgKiBBbGxvd3MgYF9zcGVuZGVyYCB0byBzcGVuZCBubyBtb3JlIHRoYW4gYF92YWx1ZWAgdG9rZW5zIGluIHlvdXIgYmVoYWxmCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3MgYXV0aG9yaXplZCB0byBzcGVuZAogICAgICogQHBhcmFtIF92YWx1ZSB0aGUgbWF4IGFtb3VudCB0aGV5IGNhbiBzcGVuZAogICAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBhbGxvd2FuY2VbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IGFsbG93YW5jZSBmb3Igb3RoZXIgYWRkcmVzcyBhbmQgbm90aWZ5CiAgICAgKiBBbGxvd3MgYF9zcGVuZGVyYCB0byBzcGVuZCBubyBtb3JlIHRoYW4gYF92YWx1ZWAgdG9rZW5zIGluIHlvdXIgYmVoYWxmLCBhbmQgdGhlbiBwaW5nIHRoZSBjb250cmFjdCBhYm91dCBpdAogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIGF1dGhvcml6ZWQgdG8gc3BlbmQKICAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIG1heCBhbW91bnQgdGhleSBjYW4gc3BlbmQKICAgICAqIEBwYXJhbSBfZXh0cmFEYXRhIHNvbWUgZXh0cmEgaW5mb3JtYXRpb24gdG8gc2VuZCB0byB0aGUgYXBwcm92ZWQgY29udHJhY3QKICAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZUFuZENhbGwoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9leHRyYURhdGEpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgICAgdG9rZW5SZWNpcGllbnQgc3BlbmRlciA9IHRva2VuUmVjaXBpZW50KF9zcGVuZGVyKTsKICAgICAgICBpZiAoYXBwcm92ZShfc3BlbmRlciwgX3ZhbHVlKSkgewogICAgICAgICAgICBzcGVuZGVyLnJlY2VpdmVBcHByb3ZhbChtc2cuc2VuZGVyLCBfdmFsdWUsIHRoaXMsIF9leHRyYURhdGEpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBEZXN0cm95IHRva2VucwogICAgICogUmVtb3ZlIGBfdmFsdWVgIHRva2VucyBmcm9tIHRoZSBzeXN0ZW0gaXJyZXZlcnNpYmx5CiAgICAgKiBAcGFyYW0gX3ZhbHVlIHRoZSBhbW91bnQgb2YgbW9uZXkgdG8gYnVybgogICAgICovCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmVxdWlyZShiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlKTsgICAvLyBDaGVjayBpZiB0aGUgc2VuZGVyIGhhcyBlbm91Z2gKICAgICAgICBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOyAgICAgICAgICAgIC8vIFN1YnRyYWN0IGZyb20gdGhlIHNlbmRlcgogICAgICAgIHRvdGFsU3VwcGx5IC09IF92YWx1ZTsgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlcyB0b3RhbFN1cHBseQogICAgICAgIEJ1cm4obXNnLnNlbmRlciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIERlc3Ryb3kgdG9rZW5zIGZyb20gb3RoZXIgYWNjb3VudAogICAgICogUmVtb3ZlIGBfdmFsdWVgIHRva2VucyBmcm9tIHRoZSBzeXN0ZW0gaXJyZXZlcnNpYmx5IG9uIGJlaGFsZiBvZiBgX2Zyb21gLgogICAgICogQHBhcmFtIF9mcm9tIHRoZSBhZGRyZXNzIG9mIHRoZSBzZW5kZXIKICAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIGFtb3VudCBvZiBtb25leSB0byBidXJuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJ1cm5Gcm9tKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmVxdWlyZShiYWxhbmNlT2ZbX2Zyb21dID49IF92YWx1ZSk7ICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSB0YXJnZXRlZCBiYWxhbmNlIGlzIGVub3VnaAogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0pOyAgICAvLyBDaGVjayBhbGxvd2FuY2UKICAgICAgICBiYWxhbmNlT2ZbX2Zyb21dIC09IF92YWx1ZTsgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3VidHJhY3QgZnJvbSB0aGUgdGFyZ2V0ZWQgYmFsYW5jZQogICAgICAgIGFsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOyAgICAgICAgICAgICAvLyBTdWJ0cmFjdCBmcm9tIHRoZSBzZW5kZXIncyBhbGxvd2FuY2UKICAgICAgICB0b3RhbFN1cHBseSAtPSBfdmFsdWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRvdGFsU3VwcGx5CiAgICAgICAgQnVybihfZnJvbSwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIAogICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIGZ1bmN0aW9uIGdldFRva2VuTmFtZSgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zIChzdHJpbmcpCiAgICB7CiAgICAgICAgcmV0dXJuIG5hbWU7CiAgICB9CiAgICAKICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIGZ1bmN0aW9uIGdldFRva2VuU3ltYm9sKCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHN0cmluZykKICAgIHsKICAgICAgICByZXR1cm4gc3ltYm9sOwogICAgfQoKICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIGZ1bmN0aW9uIGdldFNwZWNpZmllZERlY2ltYWwoKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludCkKICAgIHsKICAgICAgICByZXR1cm4gZGVjaW1hbHM7CiAgICB9CgogICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIGZ1bmN0aW9uIGdldFRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQpCiAgICB7CiAgICAgICAgcmV0dXJuIHRvdGFsU3VwcGx5OwogICAgfQogICAgCn0='.
	

]
