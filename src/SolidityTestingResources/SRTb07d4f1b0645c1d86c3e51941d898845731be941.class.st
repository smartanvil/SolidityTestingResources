Class {
	#name : #SRTb07d4f1b0645c1d86c3e51941d898845731be941,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTb07d4f1b0645c1d86c3e51941d898845731be941 >> base64 [
	^ 'LyoqCiAqIERldmVsb3BlciBUZWFtOiAKICogSGlyYSBTaWRkaXF1aQogKiBjb25uZWN0IG9uOiBodHRwczovL3d3dy5saW5rZWRpbi5jb20vaW4vaGlyYS1zaWRkaXF1aS05NmI2MGE3NC8KICogCiAqIE11anRhYmEgSWRyZWVzCiAqIGNvbm5lY3Qgb246IGh0dHBzOi8vd3d3LmxpbmtlZGluLmNvbS9pbi9tdWp0YWJhaWRyZWVzOTQvCiAqKi8KCnByYWdtYSBzb2xpZGl0eSBeMC40LjExOwoKLyoqCiAqIEB0aXRsZSBDcm93ZHNhbGUKICogQGRldiBDcm93ZHNhbGUgaXMgYSBiYXNlIGNvbnRyYWN0IGZvciBtYW5hZ2luZyBhIHRva2VuIGNyb3dkc2FsZS4KICogQ3Jvd2RzYWxlcyBoYXZlIGEgc3RhcnQgYW5kIGVuZCB0aW1lc3RhbXBzLCB3aGVyZSBpbnZlc3RvcnMgY2FuIG1ha2UKICogdG9rZW4gcHVyY2hhc2VzIGFuZCB0aGUgY3Jvd2RzYWxlIHdpbGwgYXNzaWduIHRoZW0gdG9rZW5zIGJhc2VkCiAqIG9uIGEgdG9rZW4gcGVyIEVUSCByYXRlLiBGdW5kcyBjb2xsZWN0ZWQgYXJlIGZvcndhcmRlZCB0byBhIHdhbGxldAogKiBhcyB0aGV5IGFycml2ZS4KICovCiAKIApsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQp9CgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHRva2VuQmFsYW5jZXM7CgogIC8qKgogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUodG9rZW5CYWxhbmNlc1ttc2cuc2VuZGVyXT49X3ZhbHVlKTsKICAgIHRva2VuQmFsYW5jZXNbbXNnLnNlbmRlcl0gPSB0b2tlbkJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgdG9rZW5CYWxhbmNlc1tfdG9dID0gdG9rZW5CYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgKi8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiB0b2tlbkJhbGFuY2VzW19vd25lcl07CiAgfQoKfQpjb250cmFjdCBFdGhlZXJhVG9rZW4gaXMgQmFzaWNUb2tlbixPd25hYmxlIHsKCiAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogICAKICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIkVUSEVFUkEiOwogICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJFVEEiOwogICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwoKICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgSU5JVElBTF9TVVBQTFkgPSAzMDAwMDAwMDA7CiAgIGV2ZW50IERlYnVnKHN0cmluZyBtZXNzYWdlLCBhZGRyZXNzIGFkZHIsIHVpbnQyNTYgbnVtYmVyKTsKICAgLyoqCiAgICogQGRldiBDb250cnVjdG9yIHRoYXQgZ2l2ZXMgbXNnLnNlbmRlciBhbGwgb2YgZXhpc3RpbmcgdG9rZW5zLgogICAqLwogICAgZnVuY3Rpb24gRXRoZWVyYVRva2VuKGFkZHJlc3Mgd2FsbGV0KSBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgICAgICB0b3RhbFN1cHBseSA9IElOSVRJQUxfU1VQUExZICogMTAgKiogMTg7CiAgICAgICAgdG9rZW5CYWxhbmNlc1t3YWxsZXRdID0gdG90YWxTdXBwbHk7ICAgLy9TaW5jZSB3ZSBkaXZpZGVkIHRoZSB0b2tlbiBpbnRvIDEwXjE4IHBhcnRzCiAgICB9CgogICAgZnVuY3Rpb24gbWludChhZGRyZXNzIHdhbGxldCwgYWRkcmVzcyBidXllciwgdWludDI1NiB0b2tlbkFtb3VudCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgIHJlcXVpcmUodG9rZW5CYWxhbmNlc1t3YWxsZXRdID49IHRva2VuQW1vdW50KTsgICAgICAgICAgICAgICAvLyBjaGVja3MgaWYgaXQgaGFzIGVub3VnaCB0byBzZWxsCiAgICAgIHRva2VuQmFsYW5jZXNbYnV5ZXJdID0gdG9rZW5CYWxhbmNlc1tidXllcl0uYWRkKHRva2VuQW1vdW50KTsgICAgICAgICAgICAgICAgICAvLyBhZGRzIHRoZSBhbW91bnQgdG8gYnV5ZXIncyBiYWxhbmNlCiAgICAgIHRva2VuQmFsYW5jZXNbd2FsbGV0XSA9IHRva2VuQmFsYW5jZXNbd2FsbGV0XS5zdWIodG9rZW5BbW91bnQpOyAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN1YnRyYWN0cyBhbW91bnQgZnJvbSBzZWxsZXIncyBiYWxhbmNlCiAgICAgIFRyYW5zZmVyKHdhbGxldCwgYnV5ZXIsIHRva2VuQW1vdW50KTsgCiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHNob3dNeVRva2VuQmFsYW5jZShhZGRyZXNzIGFkZHIpIHB1YmxpYyB2aWV3IG9ubHlPd25lciByZXR1cm5zICh1aW50IHRva2VuQmFsYW5jZSkgewogICAgICAgIHRva2VuQmFsYW5jZSA9IHRva2VuQmFsYW5jZXNbYWRkcl07CiAgICAgICAgcmV0dXJuIHRva2VuQmFsYW5jZTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gc2hvd015RXRoZXJCYWxhbmNlKGFkZHJlc3MgYWRkcikgcHVibGljIHZpZXcgb25seU93bmVyIHJldHVybnMgKHVpbnQgZXRoZXJCYWxhbmNlKSB7CiAgICAgICAgZXRoZXJCYWxhbmNlID0gYWRkci5iYWxhbmNlOwogICAgfQp9CmNvbnRyYWN0IEV0aGVlcmFDcm93ZHNhbGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogCiAgLy8gVGhlIHRva2VuIGJlaW5nIHNvbGQKICBFdGhlZXJhVG9rZW4gcHVibGljIHRva2VuOwoKICAvLyBzdGFydCBhbmQgZW5kIHRpbWVzdGFtcHMgd2hlcmUgaW52ZXN0bWVudHMgYXJlIGFsbG93ZWQgKGJvdGggaW5jbHVzaXZlKQogIHVpbnQyNTYgcHVibGljIHN0YXJ0VGltZTsKICB1aW50MjU2IHB1YmxpYyBlbmRUaW1lOwoKICAvLyBhZGRyZXNzIHdoZXJlIGZ1bmRzIGFyZSBjb2xsZWN0ZWQKICAvLyBhZGRyZXNzIHdoZXJlIHRva2VucyBhcmUgZGVwb3NpdGVkIGFuZCBmcm9tIHdoZXJlIHdlIHNlbmQgdG9rZW5zIHRvIGJ1eWVycwogIGFkZHJlc3MgcHVibGljIHdhbGxldDsKCiAgLy8gaG93IG1hbnkgdG9rZW4gdW5pdHMgYSBidXllciBnZXRzIHBlciB3ZWkKICB1aW50MjU2IHB1YmxpYyByYXRlUGVyV2VpID0gMjAwMDsKCiAgLy8gYW1vdW50IG9mIHJhaXNlZCBtb25leSBpbiB3ZWkKICB1aW50MjU2IHB1YmxpYyB3ZWlSYWlzZWQ7CgogIC8vIGZsYWdzIHRvIHNob3cgd2hldGhlciBzb2Z0IGNhcCAvIGhhcmQgY2FwIGlzIHJlYWNoZWQKICBib29sIHB1YmxpYyBpc1NvZnRDYXBSZWFjaGVkID0gZmFsc2U7CiAgYm9vbCBwdWJsaWMgaXNIYXJkQ2FwUmVhY2hlZCA9IGZhbHNlOwogICAgCiAgLy90aGlzIGZsYWcgaXMgc2V0IHRvIHRydWUgd2hlbiBJQ08gZHVyYXRpb24gaXMgb3ZlciBhbmQgc29mdCBjYXAgaXMgbm90IHJlYWNoZWQgIAogIGJvb2wgcHVibGljIHJlZnVuZFRvQnV5ZXJzID0gZmFsc2U7CiAgICAKICAvLyBTb2Z0IGNhcCBvZiB0aGUgSUNPIGluIGV0aGVycyAgCiAgdWludDI1NiBwdWJsaWMgc29mdENhcCA9IDYwMDA7CiAgICAKICAvL0hhcmQgY2FwIG9mIHRoZSBJQ08gaW4gZXRoZXJzCiAgdWludDI1NiBwdWJsaWMgaGFyZENhcCA9IDEwNTAwMDsKICAKICAvL3RvdGFsIHRva2VucyB0aGF0IGhhdmUgYmVlbiBzb2xkICAKICB1aW50MjU2IHRva2Vuc19zb2xkID0gMDsKCiAgLy90b3RhbCB0b2tlbnMgdGhhdCBhcmUgdG8gYmUgc29sZCAtIHRoaXMgaXMgNzAlIG9mIHRoZSB0b3RhbCBzdXBwbHkgaS5lLiAzMDAwMDAwMDAKICB1aW50IG1heFRva2Vuc0ZvclNhbGUgPSAyMTAwMDAwMDA7CiAgCiAgLy90b2tlbnMgdGhhdCBhcmUgcmVzZXJ2ZWQgZm9yIHRoZSBldGhlZXJhIHRlYW0gLSB0aGlzIGlzIDMwJSBvZiB0aGUgdG90YWwgc3VwcGx5ICAKICB1aW50MjU2IHB1YmxpYyB0b2tlbnNGb3JSZXNlcnZlZEZ1bmQgPSAwOwogIHVpbnQyNTYgcHVibGljIHRva2Vuc0ZvckFkdmlzb3JzID0gMDsKICB1aW50MjU2IHB1YmxpYyB0b2tlbnNGb3JGb3VuZGVyc0FuZFRlYW0gPSAwOwogIHVpbnQyNTYgcHVibGljIHRva2Vuc0Zvck1hcmtldGluZyA9IDA7CiAgdWludDI1NiBwdWJsaWMgdG9rZW5zRm9yVG91cm5hbWVudCA9IDA7CgogIGJvb2wgZXRoZXJzU2VudEZvclJlZnVuZCA9IGZhbHNlOwogIAogIC8vIHdoaXRlbGlzdGVkIGFkZHJlc3NlcyBhcmUgdGhvc2UgdGhhdCBoYXZlIHJlZ2lzdGVyZWQgb24gdGhlIHdlYnNpdGUKICBtYXBwaW5nKGFkZHJlc3M9PmJvb2wpIHdoaXRlTGlzdGVkQWRkcmVzc2VzOwoKICAvLyB0aGUgYnV5ZXJzIG9mIHRva2VucyBhbmQgdGhlIGFtb3VudCBvZiBldGhlcnMgdGhleSBzZW50IGluCiAgbWFwcGluZyhhZGRyZXNzPT51aW50MjU2KSB1c2Vyc1RoYXRCb3VnaHRFVEE7CiAKICBhZGRyZXNzIHdoaXRlTGlzdGVyOyAKICAvKioKICAgKiBldmVudCBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAqIEBwYXJhbSBwdXJjaGFzZXIgd2hvIHBhaWQgZm9yIHRoZSB0b2tlbnMKICAgKiBAcGFyYW0gYmVuZWZpY2lhcnkgd2hvIGdvdCB0aGUgdG9rZW5zCiAgICogQHBhcmFtIHZhbHVlIHdlaXMgcGFpZCBmb3IgcHVyY2hhc2UKICAgKiBAcGFyYW0gYW1vdW50IGFtb3VudCBvZiB0b2tlbnMgcHVyY2hhc2VkCiAgICovCiAgZXZlbnQgVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgdmFsdWUsIHVpbnQyNTYgYW1vdW50KTsKCgogIGZ1bmN0aW9uIEV0aGVlcmFDcm93ZHNhbGUodWludDI1NiBfc3RhcnRUaW1lLCBhZGRyZXNzIF93YWxsZXQsIGFkZHJlc3MgX3doaXRlTGlzdGVyKSBwdWJsaWMgewogICAgCiAgICByZXF1aXJlKF9zdGFydFRpbWUgPj0gbm93KTsKICAgIHN0YXJ0VGltZSA9IF9zdGFydFRpbWU7CiAgICBlbmRUaW1lID0gc3RhcnRUaW1lICsgNjAgZGF5czsKICAgIAogICAgcmVxdWlyZShlbmRUaW1lID49IHN0YXJ0VGltZSk7CiAgICByZXF1aXJlKF93YWxsZXQgIT0gMHgwKTsKCiAgICB3YWxsZXQgPSBfd2FsbGV0OwogICAgd2hpdGVMaXN0ZXIgPSBfd2hpdGVMaXN0ZXI7CiAgICB0b2tlbiA9IGNyZWF0ZVRva2VuQ29udHJhY3Qod2FsbGV0KTsKICB9CgogIGZ1bmN0aW9uIGNyZWF0ZVRva2VuQ29udHJhY3QoYWRkcmVzcyB3YWxsKSBpbnRlcm5hbCByZXR1cm5zIChFdGhlZXJhVG9rZW4pIHsKICAgIHJldHVybiBuZXcgRXRoZWVyYVRva2VuKHdhbGwpOwogIH0KCiAgLy8gZmFsbGJhY2sgZnVuY3Rpb24gY2FuIGJlIHVzZWQgdG8gYnV5IHRva2VucwogIGZ1bmN0aW9uICgpIHB1YmxpYyBwYXlhYmxlIHsKICAgIGJ1eVRva2Vucyhtc2cuc2VuZGVyKTsKICB9CgogIC8vZGV0ZXJtaW5lIHRoZSBib251cyB3aXRoIHJlc3BlY3QgdG8gdGltZSBlbGFwc2VkCiAgZnVuY3Rpb24gZGV0ZXJtaW5lQm9udXModWludCB0b2tlbnMpIGludGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NiBib251cykgewogICAgCiAgICB1aW50MjU2IHRpbWVFbGFwc2VkID0gbm93IC0gc3RhcnRUaW1lOwogICAgdWludDI1NiB0aW1lRWxhcHNlZEluRGF5cyA9IHRpbWVFbGFwc2VkLmRpdigxIGRheXMpOwogICAgCiAgICBpZiAodGltZUVsYXBzZWRJbkRheXMgPD03KQogICAgewogICAgICAgIC8vZWFybHkgc2FsZQogICAgICAgIC8vdmFsaWQgZm9yIDcgZGF5cyAoMXN0IHdlZWspCiAgICAgICAgLy8zMDAwMCsgVE9LRU4gUFVSQ0hBU0UgQU1PVU5UIC8gMzMlIEJPTlVTCiAgICAgICAgaWYgKHRva2Vucz4zMDAwMCAqIDEwICoqIDE4KQogICAgICAgIHsKICAgICAgICAgICAgLy8zMyUgYm9udXMKICAgICAgICAgICAgYm9udXMgPSB0b2tlbnMubXVsKDMzKTsKICAgICAgICAgICAgYm9udXMgPSBib251cy5kaXYoMTAwKTsKICAgICAgICB9CiAgICAgICAgLy8xMDAwMCsgVE9LRU4gUFVSQ0hBU0UgQU1PVU5UIC8gMjYlIEJPTlVTCiAgICAgICAgZWxzZSBpZiAodG9rZW5zPjEwMDAwICoxMCAqKiAxOCAmJiB0b2tlbnM8PSAzMDAwMCAqIDEwICoqIDE4KQogICAgICAgIHsKICAgICAgICAgICAgLy8yNiUgYm9udXMKICAgICAgICAgICAgYm9udXMgPSB0b2tlbnMubXVsKDI2KTsKICAgICAgICAgICAgYm9udXMgPSBib251cy5kaXYoMTAwKTsKICAgICAgICB9CiAgICAgICAgLy8zMDAwKyBUT0tFTiBQVVJDSEFTRSBBTU9VTlQgLyAyMyUgQk9OVVMKICAgICAgICBlbHNlIGlmICh0b2tlbnM+MzAwMCAqMTAgKiogMTggJiYgdG9rZW5zPD0gMTAwMDAgKiAxMCAqKiAxOCkKICAgICAgICB7CiAgICAgICAgICAgIC8vMjMlIGJvbnVzCiAgICAgICAgICAgIGJvbnVzID0gdG9rZW5zLm11bCgyMyk7CiAgICAgICAgICAgIGJvbnVzID0gYm9udXMuZGl2KDEwMCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vNzUrIFRPS0VOIFBVUkNIQVNFIEFNT1VOVCAvIDIwJSBCT05VUwogICAgICAgIGVsc2UgaWYgKHRva2Vucz49NzUgKjEwICoqIDE4ICYmIHRva2Vuczw9IDMwMDAgKiAxMCAqKiAxOCkKICAgICAgICB7CiAgICAgICAgICAgIC8vMjAlIGJvbnVzCiAgICAgICAgICAgIGJvbnVzID0gdG9rZW5zLm11bCgyMCk7CiAgICAgICAgICAgIGJvbnVzID0gYm9udXMuZGl2KDEwMCk7CiAgICAgICAgfQogICAgICAgIGVsc2UgCiAgICAgICAgewogICAgICAgICAgICBib251cyA9IDA7CiAgICAgICAgfQogICAgfQogICAgZWxzZSBpZiAodGltZUVsYXBzZWRJbkRheXM+NyAmJiB0aW1lRWxhcHNlZEluRGF5cyA8PTQ5KQogICAgewogICAgICAgIC8vc2FsZQogICAgICAgIC8vZnJvbSA3dGggZGF5IHRpbGwgNDl0aCBkYXkgKHRvdGFsIDQyIGRheXMgb3IgNiB3ZWVrcykKICAgICAgICAvLzMwMDAwKyBUT0tFTiBQVVJDSEFTRSBBTU9VTlQgLyAxNSUgQk9OVVMKICAgICAgICBpZiAodG9rZW5zPjMwMDAwICogMTAgKiogMTgpCiAgICAgICAgewogICAgICAgICAgICAvLzE1JSBib251cwogICAgICAgICAgICBib251cyA9IHRva2Vucy5tdWwoMTUpOwogICAgICAgICAgICBib251cyA9IGJvbnVzLmRpdigxMDApOwogICAgICAgIH0KICAgICAgICAvLzEwMDAwKyBUT0tFTiBQVVJDSEFTRSBBTU9VTlQgLyAxMCUgQk9OVVMKICAgICAgICBlbHNlIGlmICh0b2tlbnM+MTAwMDAgKjEwICoqIDE4ICYmIHRva2Vuczw9IDMwMDAwICogMTAgKiogMTgpCiAgICAgICAgewogICAgICAgICAgICAvLzEwJSBib251cwogICAgICAgICAgICBib251cyA9IHRva2Vucy5tdWwoMTApOwogICAgICAgICAgICBib251cyA9IGJvbnVzLmRpdigxMDApOwogICAgICAgIH0KICAgICAgICAvLzMwMDArIFRPS0VOIFBVUkNIQVNFIEFNT1VOVCAvIDUlIEJPTlVTCiAgICAgICAgZWxzZSBpZiAodG9rZW5zPjMwMDAgKjEwICoqIDE4ICYmIHRva2Vuczw9IDEwMDAwICogMTAgKiogMTgpCiAgICAgICAgewogICAgICAgICAgICAvLzUlIGJvbnVzCiAgICAgICAgICAgIGJvbnVzID0gdG9rZW5zLm11bCg1KTsKICAgICAgICAgICAgYm9udXMgPSBib251cy5kaXYoMTAwKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy83NSsgVE9LRU4gUFVSQ0hBU0UgQU1PVU5UIC8gMyUgQk9OVVMKICAgICAgICBlbHNlIGlmICh0b2tlbnM+PTc1ICoxMCAqKiAxOCAmJiB0b2tlbnM8PSAzMDAwICogMTAgKiogMTgpCiAgICAgICAgewogICAgICAgICAgICAvLzMlIGJvbnVzCiAgICAgICAgICAgIGJvbnVzID0gdG9rZW5zLm11bCgzKTsKICAgICAgICAgICAgYm9udXMgPSBib251cy5kaXYoMTAwKTsKICAgICAgICB9CiAgICAgICAgZWxzZSAKICAgICAgICB7CiAgICAgICAgICAgIGJvbnVzID0gMDsKICAgICAgICB9CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgLy9ubyBib251c2VzIGFmdGVyIDd0aCB3ZWVrIGkuZS4gNDkgZGF5cwogICAgICAgIGJvbnVzID0gMDsKICAgIH0KICB9CgogIC8vIGxvdyBsZXZlbCB0b2tlbiBwdXJjaGFzZSBmdW5jdGlvbgogIC8vIE1pbmltdW0gcHVyY2hhc2UgY2FuIGJlIG9mIDc1IEVUQSB0b2tlbnMKICAKICBmdW5jdGlvbiBidXlUb2tlbnMoYWRkcmVzcyBiZW5lZmljaWFyeSkgcHVibGljIHBheWFibGUgewogICAgCiAgLy90b2tlbnMgbm90IHRvIGJlIHNlbnQgdG8gMHgwCiAgcmVxdWlyZShiZW5lZmljaWFyeSAhPSAweDApOwoKICBpZihoYXNFbmRlZCgpICYmICFpc0hhcmRDYXBSZWFjaGVkKQogIHsKICAgICAgaWYgKCFpc1NvZnRDYXBSZWFjaGVkKQogICAgICAgIHJlZnVuZFRvQnV5ZXJzID0gdHJ1ZTsKICAgICAgYnVyblJlbWFpbmluZ1Rva2VucygpOwogICAgICBiZW5lZmljaWFyeS50cmFuc2Zlcihtc2cudmFsdWUpOwogIH0KICAKICBlbHNlCiAgewogIAogICAgLy90aGUgcHVyY2hhc2Ugc2hvdWxkIGJlIHdpdGhpbiBkdXJhdGlvbiBhbmQgbm9uIHplcm8KICAgIHJlcXVpcmUodmFsaWRQdXJjaGFzZSgpKTsKICAgIAogICAgcmVxdWlyZSh3aGl0ZUxpc3RlZEFkZHJlc3Nlc1tiZW5lZmljaWFyeV0gPT0gdHJ1ZSk7CiAgICAvLyBhbW91bnQgc2VudCBieSB0aGUgdXNlcgogICAgdWludDI1NiB3ZWlBbW91bnQgPSBtc2cudmFsdWU7CiAgICAKICAgIC8vIGNhbGN1bGF0ZSB0b2tlbiBhbW91bnQgdG8gYmUgc29sZAogICAgdWludDI1NiB0b2tlbnMgPSB3ZWlBbW91bnQubXVsKHJhdGVQZXJXZWkpOwogIAogICAgcmVxdWlyZSAodG9rZW5zPj03NSAqIDEwICoqIDE4KTsKICAgIAogICAgLy9EZXRlcm1pbmUgYm9udXMKICAgIHVpbnQgYm9udXMgPSBkZXRlcm1pbmVCb251cyh0b2tlbnMpOwogICAgdG9rZW5zID0gdG9rZW5zLmFkZChib251cyk7CiAgCiAgICAvL2Nhbid0IHNhbGUgdG9rZW5zIG1vcmUgdGhhbiAyMTAwMDAwMDAwMAogICAgcmVxdWlyZSh0b2tlbnNfc29sZCArIHRva2VucyA8PSBtYXhUb2tlbnNGb3JTYWxlICogMTAgKiogMTgpOwogIAogICAgLy8zMCUgb2YgdGhlIHRva2VucyBiZWluZyBzb2xkIGFyZSBiZWluZyBhY2N1bXVsYXRlZCBmb3IgdGhlIGV0aGVlcmEgdGVhbQogICAgdXBkYXRlVG9rZW5zRm9yRXRoZWVyYVRlYW0odG9rZW5zKTsKCiAgICB3ZWlSYWlzZWQgPSB3ZWlSYWlzZWQuYWRkKHdlaUFtb3VudCk7CiAgICAKICAgIAogICAgaWYgKHdlaVJhaXNlZCA+PSBzb2Z0Q2FwICogMTAgKiogMTggJiYgIWlzU29mdENhcFJlYWNoZWQpCiAgICB7CiAgICAgIGlzU29mdENhcFJlYWNoZWQgPSB0cnVlOwogICAgfQogIAogICAgaWYgKHdlaVJhaXNlZCA+PSBoYXJkQ2FwICogMTAgKiogMTggJiYgIWlzSGFyZENhcFJlYWNoZWQpCiAgICAgIGlzSGFyZENhcFJlYWNoZWQgPSB0cnVlOwogICAgCiAgICB0b2tlbi5taW50KHdhbGxldCwgYmVuZWZpY2lhcnksIHRva2Vucyk7CiAgICAKICAgIHVpbnQgb2xkZXJBbW91bnQgPSB1c2Vyc1RoYXRCb3VnaHRFVEFbYmVuZWZpY2lhcnldOwogICAgdXNlcnNUaGF0Qm91Z2h0RVRBW2JlbmVmaWNpYXJ5XSA9IHdlaUFtb3VudCArIG9sZGVyQW1vdW50OwogICAgCiAgICBUb2tlblB1cmNoYXNlKG1zZy5zZW5kZXIsIGJlbmVmaWNpYXJ5LCB3ZWlBbW91bnQsIHRva2Vucyk7CiAgICAKICAgIHRva2Vuc19zb2xkID0gdG9rZW5zX3NvbGQuYWRkKHRva2Vucyk7CiAgICAKICAgIGZvcndhcmRGdW5kcygpOwogIH0KIH0KCiAgLy8gc2VuZCBldGhlciB0byB0aGUgZnVuZCBjb2xsZWN0aW9uIHdhbGxldAogIGZ1bmN0aW9uIGZvcndhcmRGdW5kcygpIGludGVybmFsIHsKICAgIHdhbGxldC50cmFuc2Zlcihtc2cudmFsdWUpOwogIH0KCiAgLy8gQHJldHVybiB0cnVlIGlmIHRoZSB0cmFuc2FjdGlvbiBjYW4gYnV5IHRva2VucwogIGZ1bmN0aW9uIHZhbGlkUHVyY2hhc2UoKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICBib29sIHdpdGhpblBlcmlvZCA9IG5vdyA+PSBzdGFydFRpbWUgJiYgbm93IDw9IGVuZFRpbWU7CiAgICBib29sIG5vblplcm9QdXJjaGFzZSA9IG1zZy52YWx1ZSAhPSAwOwogICAgcmV0dXJuIHdpdGhpblBlcmlvZCAmJiBub25aZXJvUHVyY2hhc2U7CiAgfQoKICAvLyBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBlbmRlZAogIGZ1bmN0aW9uIGhhc0VuZGVkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBub3cgPiBlbmRUaW1lOwogIH0KICAKICAgZnVuY3Rpb24gc2hvd015VG9rZW5CYWxhbmNlKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiB0b2tlbkJhbGFuY2UpIHsKICAgICAgICB0b2tlbkJhbGFuY2UgPSB0b2tlbi5zaG93TXlUb2tlbkJhbGFuY2UobXNnLnNlbmRlcik7CiAgICAgICAgcmV0dXJuIHRva2VuQmFsYW5jZTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gYnVyblJlbWFpbmluZ1Rva2VucygpIGludGVybmFsCiAgICB7CiAgICAgICAgLy9idXJuIGFsbCB0aGUgdW5zb2xkIHRva2VucyBhcyBzb29uIGFzIHRoZSBJQ08gaXMgZW5kZWQKICAgICAgICB1aW50IGJhbGFuY2UgPSB0b2tlbi5zaG93TXlUb2tlbkJhbGFuY2Uod2FsbGV0KTsKICAgICAgICByZXF1aXJlKGJhbGFuY2U+MCk7CiAgICAgICAgdWludCB0b2tlbnNGb3JUZWFtID0gdG9rZW5zRm9yUmVzZXJ2ZWRGdW5kICsgdG9rZW5zRm9yRm91bmRlcnNBbmRUZWFtICsgdG9rZW5zRm9yQWR2aXNvcnMgK3Rva2Vuc0Zvck1hcmtldGluZyArIHRva2Vuc0ZvclRvdXJuYW1lbnQ7CiAgICAgICAgdWludCB0b2tlbnNUb0J1cm4gPSBiYWxhbmNlLnN1Yih0b2tlbnNGb3JUZWFtKTsKICAgICAgICByZXF1aXJlIChiYWxhbmNlID49dG9rZW5zVG9CdXJuKTsKICAgICAgICBhZGRyZXNzIGJ1cm5BZGRyZXNzID0gMHgwOwogICAgICAgIHRva2VuLm1pbnQod2FsbGV0LGJ1cm5BZGRyZXNzLHRva2Vuc1RvQnVybik7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGFkZEFkZHJlc3NUb1doaXRlTGlzdChhZGRyZXNzIHdoaXRlbGlzdGFkZHJlc3MpIHB1YmxpYyAKICAgIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gd2FsbGV0IHx8IG1zZy5zZW5kZXIgPT0gd2hpdGVMaXN0ZXIpOwogICAgICAgIHdoaXRlTGlzdGVkQWRkcmVzc2VzW3doaXRlbGlzdGFkZHJlc3NdID0gdHJ1ZTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gY2hlY2tJZkFkZHJlc3NJc1doaXRlbGlzdGVkKGFkZHJlc3Mgd2hpdGVsaXN0YWRkcmVzcykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgaWYgKHdoaXRlTGlzdGVkQWRkcmVzc2VzW3doaXRlbGlzdGFkZHJlc3NdID09IHRydWUpCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIHJldHVybiBmYWxzZTsgCiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldFJlZnVuZCgpIHB1YmxpYyAKICAgIHsKICAgICAgICByZXF1aXJlKGV0aGVyc1NlbnRGb3JSZWZ1bmQgJiYgdXNlcnNUaGF0Qm91Z2h0RVRBW21zZy5zZW5kZXJdPjApOwogICAgICAgIHVpbnQyNTYgZXRoZXJzU2VudCA9IHVzZXJzVGhhdEJvdWdodEVUQVttc2cuc2VuZGVyXTsKICAgICAgICByZXF1aXJlICh3YWxsZXQuYmFsYW5jZSA+PSBldGhlcnNTZW50KTsKICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKGV0aGVyc1NlbnQpOwogICAgICAgIHVpbnQyNTYgdG9rZW5zSUhhdmUgPSB0b2tlbi5zaG93TXlUb2tlbkJhbGFuY2UobXNnLnNlbmRlcik7CiAgICAgICAgdG9rZW4ubWludChtc2cuc2VuZGVyLDB4MCx0b2tlbnNJSGF2ZSk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGRlYml0QW1vdW50VG9SZWZ1bmQoKSBwdWJsaWMgcGF5YWJsZSAKICAgIHsKICAgICAgICByZXF1aXJlKGhhc0VuZGVkKCkgJiYgbXNnLnNlbmRlciA9PSB3YWxsZXQgJiYgIWlzU29mdENhcFJlYWNoZWQgJiYgIWV0aGVyc1NlbnRGb3JSZWZ1bmQpOwogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID49d2VpUmFpc2VkKTsKICAgICAgICBldGhlcnNTZW50Rm9yUmVmdW5kID0gdHJ1ZTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gdXBkYXRlVG9rZW5zRm9yRXRoZWVyYVRlYW0odWludDI1NiB0b2tlbnMpIGludGVybmFsIAogICAgewogICAgICAgIHVpbnQyNTYgcmVzZXJ2ZWRGdW5kVG9rZW5zOwogICAgICAgIHVpbnQyNTYgZm91bmRlcnNBbmRUZWFtVG9rZW5zOwogICAgICAgIHVpbnQyNTYgYWR2aXNvcnNUb2tlbnM7CiAgICAgICAgdWludDI1NiBtYXJrZXRpbmdUb2tlbnM7CiAgICAgICAgdWludDI1NiB0b3VybmFtZW50VG9rZW5zOwogICAgICAgIAogICAgICAgIC8vMTAlIG9mIHRva2VucyBmb3IgcmVzZXJ2ZWQgZnVuZAogICAgICAgIHJlc2VydmVkRnVuZFRva2VucyA9IHRva2Vucy5tdWwoMTApOwogICAgICAgIHJlc2VydmVkRnVuZFRva2VucyA9IHJlc2VydmVkRnVuZFRva2Vucy5kaXYoMTAwKTsKICAgICAgICB0b2tlbnNGb3JSZXNlcnZlZEZ1bmQgPSB0b2tlbnNGb3JSZXNlcnZlZEZ1bmQuYWRkKHJlc2VydmVkRnVuZFRva2Vucyk7CiAgICAKICAgICAgICAvLzE1JSBvZiB0b2tlbnMgZm9yIGZvdW5kZXJzIGFuZCB0ZWFtICAgIAogICAgICAgIGZvdW5kZXJzQW5kVGVhbVRva2Vucz10b2tlbnMubXVsKDE1KTsKICAgICAgICBmb3VuZGVyc0FuZFRlYW1Ub2tlbnM9IGZvdW5kZXJzQW5kVGVhbVRva2Vucy5kaXYoMTAwKTsKICAgICAgICB0b2tlbnNGb3JGb3VuZGVyc0FuZFRlYW0gPSB0b2tlbnNGb3JGb3VuZGVyc0FuZFRlYW0uYWRkKGZvdW5kZXJzQW5kVGVhbVRva2Vucyk7CiAgICAKICAgICAgICAvLzMlIG9mIHRva2VucyBmb3IgYWR2aXNvcnMKICAgICAgICBhZHZpc29yc1Rva2Vucz10b2tlbnMubXVsKDMpOwogICAgICAgIGFkdmlzb3JzVG9rZW5zPSBhZHZpc29yc1Rva2Vucy5kaXYoMTAwKTsKICAgICAgICB0b2tlbnNGb3JBZHZpc29ycz0gdG9rZW5zRm9yQWR2aXNvcnMuYWRkKGFkdmlzb3JzVG9rZW5zKTsKICAgIAogICAgICAgIC8vMSUgb2YgdG9rZW5zIGZvciBtYXJrZXRpbmcKICAgICAgICBtYXJrZXRpbmdUb2tlbnMgPSB0b2tlbnMubXVsKDEpOwogICAgICAgIG1hcmtldGluZ1Rva2Vucz0gbWFya2V0aW5nVG9rZW5zLmRpdigxMDApOwogICAgICAgIHRva2Vuc0Zvck1hcmtldGluZz0gdG9rZW5zRm9yTWFya2V0aW5nLmFkZChtYXJrZXRpbmdUb2tlbnMpOwogICAgICAgIAogICAgICAgIC8vMSUgb2YgdG9rZW5zIGZvciB0b3VybmFtZW50IAogICAgICAgIHRvdXJuYW1lbnRUb2tlbnM9dG9rZW5zLm11bCgxKTsKICAgICAgICB0b3VybmFtZW50VG9rZW5zPSB0b3VybmFtZW50VG9rZW5zLmRpdigxMDApOwogICAgICAgIHRva2Vuc0ZvclRvdXJuYW1lbnQ9IHRva2Vuc0ZvclRvdXJuYW1lbnQuYWRkKHRvdXJuYW1lbnRUb2tlbnMpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB3aXRoZHJhd1Rva2Vuc0ZvckV0aGVlcmFUZWFtKHVpbnQyNTYgd2hvc2VUb2tlbnNUb1dpdGhkcmF3LGFkZHJlc3NbXSB3aGVyZVRvU2VuZFRva2VucykgcHVibGljIHsKICAgICAgICAvLzEgcmVzZXJ2ZWQgZnVuZCwgMiBmb3IgZm91bmRlcnMgYW5kIHRlYW0sIDMgZm9yIGFkdmlzb3JzLCA0IGZvciBtYXJrZXRpbmcsIDUgZm9yIHRvdXJuYW1lbnQKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gd2FsbGV0ICYmIG5vdz49ZW5kVGltZSk7CiAgICAgICAgdWludDI1NiBsb2NrUGVyaW9kID0gMDsKICAgICAgICB1aW50MjU2IHRpbWVQYXNzZWQgPSBub3cgLSBlbmRUaW1lOwogICAgICAgIHVpbnQyNTYgdG9rZW5zVG9TZW5kID0gMDsKICAgICAgICB1aW50MjU2IGkgPSAwOwogICAgICAgIGlmICh3aG9zZVRva2Vuc1RvV2l0aGRyYXcgPT0gMSkKICAgICAgICB7CiAgICAgICAgICAvLzE1IG1vbnRocyBsb2NrdXAgcGVyaW9kCiAgICAgICAgICBsb2NrUGVyaW9kID0gMTUgZGF5cyAqIDMwOwogICAgICAgICAgcmVxdWlyZSh0aW1lUGFzc2VkID49IGxvY2tQZXJpb2QpOwogICAgICAgICAgcmVxdWlyZSAodG9rZW5zRm9yUmVzZXJ2ZWRGdW5kID4wKTsKICAgICAgICAgIC8vYWxsb3cgd2l0aGRyYXdhbAogICAgICAgICAgdG9rZW5zVG9TZW5kID0gdG9rZW5zRm9yUmVzZXJ2ZWRGdW5kLmRpdih3aGVyZVRvU2VuZFRva2Vucy5sZW5ndGgpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICBmb3IgKGk9MDtpPHdoZXJlVG9TZW5kVG9rZW5zLmxlbmd0aDtpKyspCiAgICAgICAgICB7CiAgICAgICAgICAgIHRva2VuLm1pbnQod2FsbGV0LHdoZXJlVG9TZW5kVG9rZW5zW2ldLHRva2Vuc1RvU2VuZCk7CiAgICAgICAgICB9CiAgICAgICAgICB0b2tlbnNGb3JSZXNlcnZlZEZ1bmQgPSAwOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmICh3aG9zZVRva2Vuc1RvV2l0aGRyYXcgPT0gMikKICAgICAgICB7CiAgICAgICAgICAvLzEwIG1vbnRocyBsb2NrdXAgcGVyaW9kCiAgICAgICAgICBsb2NrUGVyaW9kID0gMTAgZGF5cyAqIDMwOwogICAgICAgICAgcmVxdWlyZSh0aW1lUGFzc2VkID49IGxvY2tQZXJpb2QpOwogICAgICAgICAgcmVxdWlyZSh0b2tlbnNGb3JGb3VuZGVyc0FuZFRlYW0gPiAwKTsKICAgICAgICAgIC8vYWxsb3cgd2l0aGRyYXdhbAogICAgICAgICAgdG9rZW5zVG9TZW5kID0gdG9rZW5zRm9yRm91bmRlcnNBbmRUZWFtLmRpdih3aGVyZVRvU2VuZFRva2Vucy5sZW5ndGgpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICBmb3IgKGk9MDtpPHdoZXJlVG9TZW5kVG9rZW5zLmxlbmd0aDtpKyspCiAgICAgICAgICB7CiAgICAgICAgICAgIHRva2VuLm1pbnQod2FsbGV0LHdoZXJlVG9TZW5kVG9rZW5zW2ldLHRva2Vuc1RvU2VuZCk7CiAgICAgICAgICB9ICAgICAgICAgICAgCiAgICAgICAgICB0b2tlbnNGb3JGb3VuZGVyc0FuZFRlYW0gPSAwOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmICh3aG9zZVRva2Vuc1RvV2l0aGRyYXcgPT0gMykKICAgICAgICB7CiAgICAgICAgICAgIHJlcXVpcmUgKHRva2Vuc0ZvckFkdmlzb3JzID4gMCk7CiAgICAgICAgICAvL2FsbG93IHdpdGhkcmF3YWwKICAgICAgICAgIHRva2Vuc1RvU2VuZCA9IHRva2Vuc0ZvckFkdmlzb3JzLmRpdih3aGVyZVRvU2VuZFRva2Vucy5sZW5ndGgpOyAgICAgICAgCiAgICAgICAgICBmb3IgKGk9MDtpPHdoZXJlVG9TZW5kVG9rZW5zLmxlbmd0aDtpKyspCiAgICAgICAgICB7CiAgICAgICAgICAgIHRva2VuLm1pbnQod2FsbGV0LHdoZXJlVG9TZW5kVG9rZW5zW2ldLHRva2Vuc1RvU2VuZCk7CiAgICAgICAgICB9CiAgICAgICAgICB0b2tlbnNGb3JBZHZpc29ycyA9IDA7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKHdob3NlVG9rZW5zVG9XaXRoZHJhdyA9PSA0KQogICAgICAgIHsKICAgICAgICAgICAgcmVxdWlyZSAodG9rZW5zRm9yTWFya2V0aW5nID4gMCk7CiAgICAgICAgICAvL2FsbG93IHdpdGhkcmF3YWwKICAgICAgICAgIHRva2Vuc1RvU2VuZCA9IHRva2Vuc0Zvck1hcmtldGluZy5kaXYod2hlcmVUb1NlbmRUb2tlbnMubGVuZ3RoKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgZm9yIChpPTA7aTx3aGVyZVRvU2VuZFRva2Vucy5sZW5ndGg7aSsrKQogICAgICAgICAgewogICAgICAgICAgICB0b2tlbi5taW50KHdhbGxldCx3aGVyZVRvU2VuZFRva2Vuc1tpXSx0b2tlbnNUb1NlbmQpOwogICAgICAgICAgfQogICAgICAgICAgdG9rZW5zRm9yTWFya2V0aW5nID0gMDsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAod2hvc2VUb2tlbnNUb1dpdGhkcmF3ID09IDUpCiAgICAgICAgewogICAgICAgICAgICByZXF1aXJlICh0b2tlbnNGb3JUb3VybmFtZW50ID4gMCk7CiAgICAgICAgICAvL2FsbG93IHdpdGhkcmF3YWwKICAgICAgICAgIHRva2Vuc1RvU2VuZCA9IHRva2Vuc0ZvclRvdXJuYW1lbnQuZGl2KHdoZXJlVG9TZW5kVG9rZW5zLmxlbmd0aCk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgIGZvciAoaT0wO2k8d2hlcmVUb1NlbmRUb2tlbnMubGVuZ3RoO2krKykKICAgICAgICAgIHsKICAgICAgICAgICAgdG9rZW4ubWludCh3YWxsZXQsd2hlcmVUb1NlbmRUb2tlbnNbaV0sdG9rZW5zVG9TZW5kKTsKICAgICAgICAgIH0KICAgICAgICAgIHRva2Vuc0ZvclRvdXJuYW1lbnQgPSAwOwogICAgICAgIH0KICAgICAgICBlbHNlIAogICAgICAgIHsKICAgICAgICAgIC8vd3JvbmcgaW5wdXQKICAgICAgICAgIHJlcXVpcmUgKDEhPTEpOwogICAgICAgIH0KICAgIH0KfQ=='.
	

]
