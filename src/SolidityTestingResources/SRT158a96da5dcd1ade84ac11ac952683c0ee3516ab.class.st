Class {
	#name : #SRT158a96da5dcd1ade84ac11ac952683c0ee3516ab,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT158a96da5dcd1ade84ac11ac952683c0ee3516ab >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7Cgpjb250cmFjdCBFUkMyMEJhc2ljIHsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgoKY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsKICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCmNvbnRyYWN0IEVSQzIyM1Rva2VuSW50ZXJmYWNlIHsKICAgIGZ1bmN0aW9uIG5hbWUoKSBjb25zdGFudCByZXR1cm5zIChzdHJpbmcgX25hbWUpOwogICAgZnVuY3Rpb24gc3ltYm9sKCkgY29uc3RhbnQgcmV0dXJucyAoc3RyaW5nIF9zeW1ib2wpOwogICAgZnVuY3Rpb24gZGVjaW1hbHMoKSBjb25zdGFudCByZXR1cm5zICh1aW50OCBfZGVjaW1hbHMpOwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IF90b3RhbFN1cHBseSk7CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludCB2YWx1ZSwgYnl0ZXMgZGF0YSkgcmV0dXJucyAoYm9vbCk7CiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50IHZhbHVlLCBieXRlcyBkYXRhKTsKfQoKY29udHJhY3QgRVJDMjIzUmVjZWl2ZXJJbnRlcmZhY2UgewogICAgZnVuY3Rpb24gdG9rZW5GYWxsYmFjayhhZGRyZXNzIGZyb20sIHVpbnQgdmFsdWUsIGJ5dGVzIGRhdGEpOwp9Cgpjb250cmFjdCBFUkMyMjNUb2tlbiBpcyBCYXNpY1Rva2VuLCBFUkMyMjNUb2tlbkludGVyZmFjZSB7CiAgICBzdHJpbmcgcHVibGljIG5hbWU7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsKICAgIHVpbnQ4IHB1YmxpYyBkZWNpbWFsczsKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwoKICAgIGZ1bmN0aW9uIG5hbWUoKSBjb25zdGFudCByZXR1cm5zIChzdHJpbmcgX25hbWUpIHsKICAgICAgICByZXR1cm4gbmFtZTsKICAgIH0KICAgIGZ1bmN0aW9uIHN5bWJvbCgpIGNvbnN0YW50IHJldHVybnMgKHN0cmluZyBfc3ltYm9sKSB7CiAgICAgICAgcmV0dXJuIHN5bWJvbDsKICAgIH0KICAgIGZ1bmN0aW9uIGRlY2ltYWxzKCkgY29uc3RhbnQgcmV0dXJucyAodWludDggX2RlY2ltYWxzKSB7CiAgICAgICAgcmV0dXJuIGRlY2ltYWxzOwogICAgfQogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IF90b3RhbFN1cHBseSkgewogICAgICAgIHJldHVybiB0b3RhbFN1cHBseTsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5UGF5bG9hZFNpemUodWludCBzaXplKSB7CiAgICAgICAgcmVxdWlyZShtc2cuZGF0YS5sZW5ndGggPj0gc2l6ZSArIDQpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludCB2YWx1ZSwgYnl0ZXMgZGF0YSkgb25seVBheWxvYWRTaXplKDIgKiAzMikgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gU2FmZU1hdGguc3ViKGJhbGFuY2VzW21zZy5zZW5kZXJdLCB2YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbdG9dID0gU2FmZU1hdGguYWRkKGJhbGFuY2VzW3RvXSwgdmFsdWUpOwogICAgICAgIGlmIChpc0NvbnRyYWN0KHRvKSl7CiAgICAgICAgICAgIEVSQzIyM1JlY2VpdmVySW50ZXJmYWNlIHJlY2VpdmVyID0gRVJDMjIzUmVjZWl2ZXJJbnRlcmZhY2UodG8pOwogICAgICAgICAgICByZWNlaXZlci50b2tlbkZhbGxiYWNrKG1zZy5zZW5kZXIsIHZhbHVlLCBkYXRhKTsKICAgICAgICB9CiAgICAgICAgLy9FUkMyMjMgZXZlbnQKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCB0bywgdmFsdWUsIGRhdGEpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQgdmFsdWUpIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBieXRlcyBtZW1vcnkgZW1wdHk7CiAgICAgICAgdHJhbnNmZXIodG8sIHZhbHVlLCBlbXB0eSk7CiAgICAgICAgLy9FUkMyMCBsZWdhY3kgZXZlbnQKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCB0bywgdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzQ29udHJhY3QoYWRkcmVzcyBfYWRkcmVzcykgcHJpdmF0ZSByZXR1cm5zIChib29sIGlzQ29udHJhY3QpIHsKICAgICAgICB1aW50IGxlbmd0aDsKICAgICAgICBfYWRkcmVzcyA9IF9hZGRyZXNzOyAvL1NpbGVuY2UgY29tcGlsZXIgd2FybmluZwogICAgICAgIGFzc2VtYmx5IHsgbGVuZ3RoIDo9IGV4dGNvZGVzaXplKF9hZGRyZXNzKSB9CiAgICAgICAgcmV0dXJuIGxlbmd0aCA+IDA7CiAgICB9Cn0KCmNvbnRyYWN0IFB1bGxQYXltZW50IHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBwYXltZW50czsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFBheW1lbnRzOwoKICBmdW5jdGlvbiBhc3luY1NlbmQoYWRkcmVzcyBkZXN0LCB1aW50MjU2IGFtb3VudCkgaW50ZXJuYWwgewogICAgcGF5bWVudHNbZGVzdF0gPSBwYXltZW50c1tkZXN0XS5hZGQoYW1vdW50KTsKICAgIHRvdGFsUGF5bWVudHMgPSB0b3RhbFBheW1lbnRzLmFkZChhbW91bnQpOwogIH0KCgogIGZ1bmN0aW9uIHdpdGhkcmF3UGF5bWVudHMoKSB7CiAgICBhZGRyZXNzIHBheWVlID0gbXNnLnNlbmRlcjsKICAgIHVpbnQyNTYgcGF5bWVudCA9IHBheW1lbnRzW3BheWVlXTsKCiAgICByZXF1aXJlKHBheW1lbnQgIT0gMCk7CiAgICByZXF1aXJlKHRoaXMuYmFsYW5jZSA+PSBwYXltZW50KTsKCiAgICB0b3RhbFBheW1lbnRzID0gdG90YWxQYXltZW50cy5zdWIocGF5bWVudCk7CiAgICBwYXltZW50c1twYXllZV0gPSAwOwoKICAgIGFzc2VydChwYXllZS5zZW5kKHBheW1lbnQpKTsKICB9Cn0KCmxpYnJhcnkgU2FmZU1hdGggewogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgoKY29udHJhY3QgVHJpdmlhbFRva2VuIGlzIEVSQzIyM1Rva2VuLCBQdWxsUGF5bWVudCB7CgogICAgLy9Db25zdGFudHMKICAgIHVpbnQ4IGNvbnN0YW50IERFQ0lNQUxTID0gMDsKICAgIHVpbnQyNTYgY29uc3RhbnQgTUlOX0VUSF9BTU9VTlQgPSAwLjAwNSBldGhlcjsKICAgIHVpbnQyNTYgY29uc3RhbnQgTUlOX0JJRF9QRVJDRU5UQUdFID0gMTA7CiAgICB1aW50MjU2IGNvbnN0YW50IFRPVEFMX1NVUFBMWSA9IDEwMDAwMDA7CiAgICB1aW50MjU2IGNvbnN0YW50IFRPS0VOU19QRVJDRU5UQUdFX0ZPUl9LRVlfSE9MREVSID0gMjU7CiAgICB1aW50MjU2IGNvbnN0YW50IENMRUFOVVBfREVMQVkgPSAxODAgZGF5czsKCiAgICAvL0FjY291bnRzCiAgICBhZGRyZXNzIHB1YmxpYyBhcnRpc3Q7CiAgICBhZGRyZXNzIHB1YmxpYyB0cml2aWFsOwoKICAgIC8vVGltZSBpbmZvcm1hdGlvbgogICAgdWludDI1NiBwdWJsaWMgaWNvRW5kVGltZTsKICAgIHVpbnQyNTYgcHVibGljIGF1Y3Rpb25EdXJhdGlvbjsKICAgIHVpbnQyNTYgcHVibGljIGF1Y3Rpb25FbmRUaW1lOwoKICAgIC8vVG9rZW4gaW5mb3JtYXRpb24KICAgIHVpbnQyNTYgcHVibGljIHRva2Vuc0ZvckFydGlzdDsKICAgIHVpbnQyNTYgcHVibGljIHRva2Vuc0ZvclRyaXZpYWw7CiAgICB1aW50MjU2IHB1YmxpYyB0b2tlbnNGb3JJY287CgogICAgLy9JQ08gYW5kIGF1Y3Rpb24gcmVzdWx0cwogICAgdWludDI1NiBwdWJsaWMgYW1vdW50UmFpc2VkOwogICAgYWRkcmVzcyBwdWJsaWMgaGlnaGVzdEJpZGRlcjsKICAgIHVpbnQyNTYgcHVibGljIGhpZ2hlc3RCaWQ7CiAgICBieXRlczMyIHB1YmxpYyBhdWN0aW9uV2lubmVyTWVzc2FnZUhhc2g7CiAgICB1aW50MjU2IHB1YmxpYyBuZXh0Q29udHJpYnV0b3JJbmRleFRvQmVHaXZlblRva2VuczsKICAgIHVpbnQyNTYgcHVibGljIHRva2Vuc0Rpc3RyaWJ1dGVkVG9Db250cmlidXRvcnM7CgogICAgLy9FdmVudHMKICAgIGV2ZW50IEljb1N0YXJ0ZWQodWludDI1NiBpY29FbmRUaW1lKTsKICAgIGV2ZW50IEljb0NvbnRyaWJ1dGVkKGFkZHJlc3MgY29udHJpYnV0b3IsIHVpbnQyNTYgYW1vdW50Q29udHJpYnV0ZWQsIHVpbnQyNTYgYW1vdW50UmFpc2VkKTsKICAgIGV2ZW50IEljb0ZpbmlzaGVkKHVpbnQyNTYgYW1vdW50UmFpc2VkKTsKICAgIGV2ZW50IEljb0NhbmNlbGxlZCgpOwogICAgZXZlbnQgQXVjdGlvblN0YXJ0ZWQodWludDI1NiBhdWN0aW9uRW5kVGltZSk7CiAgICBldmVudCBIaWdoZXN0QmlkQ2hhbmdlZChhZGRyZXNzIGhpZ2hlc3RCaWRkZXIsIHVpbnQyNTYgaGlnaGVzdEJpZCk7CiAgICBldmVudCBBdWN0aW9uRmluaXNoZWQoYWRkcmVzcyBoaWdoZXN0QmlkZGVyLCB1aW50MjU2IGhpZ2hlc3RCaWQpOwogICAgZXZlbnQgV2lubmVyUHJvdmlkZWRIYXNoKCk7CgogICAgLy9TdGF0ZQogICAgZW51bSBTdGF0ZSB7IENyZWF0ZWQsIEljb1N0YXJ0ZWQsIEljb0ZpbmlzaGVkLCBBdWN0aW9uU3RhcnRlZCwgQXVjdGlvbkZpbmlzaGVkLCBJY29DYW5jZWxsZWQgfQogICAgU3RhdGUgcHVibGljIGN1cnJlbnRTdGF0ZTsKCiAgICAvL1Rva2VuIGNvbnRyaWJ1dG9ycyBhbmQgaG9sZGVycwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBjb250cmlidXRpb25zOwogICAgYWRkcmVzc1tdIHB1YmxpYyBjb250cmlidXRvcnM7CgogICAgLy9Nb2RpZmlmZXJzCiAgICBtb2RpZmllciBvbmx5SW5TdGF0ZShTdGF0ZSBleHBlY3RlZFN0YXRlKSB7IHJlcXVpcmUoZXhwZWN0ZWRTdGF0ZSA9PSBjdXJyZW50U3RhdGUpOyBfOyB9CiAgICBtb2RpZmllciBvbmx5QmVmb3JlKHVpbnQyNTYgX3RpbWUpIHsgcmVxdWlyZShub3cgPCBfdGltZSk7IF87IH0KICAgIG1vZGlmaWVyIG9ubHlBZnRlcih1aW50MjU2IF90aW1lKSB7IHJlcXVpcmUobm93ID4gX3RpbWUpOyBfOyB9CiAgICBtb2RpZmllciBvbmx5VHJpdmlhbCgpIHsgcmVxdWlyZShtc2cuc2VuZGVyID09IHRyaXZpYWwpOyBfOyB9CiAgICBtb2RpZmllciBvbmx5S2V5SG9sZGVycygpIHsgcmVxdWlyZShiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBTYWZlTWF0aC5kaXYoCiAgICAgICAgU2FmZU1hdGgubXVsKHRva2Vuc0ZvckljbywgVE9LRU5TX1BFUkNFTlRBR0VfRk9SX0tFWV9IT0xERVIpLCAxMDApKTsgXzsKICAgIH0KICAgIG1vZGlmaWVyIG9ubHlBdWN0aW9uV2lubmVyKCkgewogICAgICAgIHJlcXVpcmUoY3VycmVudFN0YXRlID09IFN0YXRlLkF1Y3Rpb25GaW5pc2hlZCk7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGhpZ2hlc3RCaWRkZXIpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gVHJpdmlhbFRva2VuKAogICAgICAgIHN0cmluZyBfbmFtZSwgc3RyaW5nIF9zeW1ib2wsCiAgICAgICAgdWludDI1NiBfaWNvRW5kVGltZSwgdWludDI1NiBfYXVjdGlvbkR1cmF0aW9uLAogICAgICAgIGFkZHJlc3MgX2FydGlzdCwgYWRkcmVzcyBfdHJpdmlhbCwKICAgICAgICB1aW50MjU2IF90b2tlbnNGb3JBcnRpc3QsCiAgICAgICAgdWludDI1NiBfdG9rZW5zRm9yVHJpdmlhbCwKICAgICAgICB1aW50MjU2IF90b2tlbnNGb3JJY28KICAgICkgewogICAgICAgIHJlcXVpcmUobm93IDwgX2ljb0VuZFRpbWUpOwogICAgICAgIHJlcXVpcmUoCiAgICAgICAgICAgIFRPVEFMX1NVUFBMWSA9PSBTYWZlTWF0aC5hZGQoCiAgICAgICAgICAgICAgICBfdG9rZW5zRm9yQXJ0aXN0LAogICAgICAgICAgICAgICAgU2FmZU1hdGguYWRkKF90b2tlbnNGb3JUcml2aWFsLCBfdG9rZW5zRm9ySWNvKQogICAgICAgICAgICApCiAgICAgICAgKTsKICAgICAgICByZXF1aXJlKE1JTl9CSURfUEVSQ0VOVEFHRSA8IDEwMCk7CiAgICAgICAgcmVxdWlyZShUT0tFTlNfUEVSQ0VOVEFHRV9GT1JfS0VZX0hPTERFUiA8IDEwMCk7CgogICAgICAgIG5hbWUgPSBfbmFtZTsKICAgICAgICBzeW1ib2wgPSBfc3ltYm9sOwogICAgICAgIGRlY2ltYWxzID0gREVDSU1BTFM7CgogICAgICAgIGljb0VuZFRpbWUgPSBfaWNvRW5kVGltZTsKICAgICAgICBhdWN0aW9uRHVyYXRpb24gPSBfYXVjdGlvbkR1cmF0aW9uOwogICAgICAgIGFydGlzdCA9IF9hcnRpc3Q7CiAgICAgICAgdHJpdmlhbCA9IF90cml2aWFsOwoKICAgICAgICB0b2tlbnNGb3JBcnRpc3QgPSBfdG9rZW5zRm9yQXJ0aXN0OwogICAgICAgIHRva2Vuc0ZvclRyaXZpYWwgPSBfdG9rZW5zRm9yVHJpdmlhbDsKICAgICAgICB0b2tlbnNGb3JJY28gPSBfdG9rZW5zRm9ySWNvOwoKICAgICAgICBjdXJyZW50U3RhdGUgPSBTdGF0ZS5DcmVhdGVkOwogICAgfQoKICAgIC8qCiAgICAgICAgSUNPIG1ldGhvZHMKICAgICovCiAgICBmdW5jdGlvbiBzdGFydEljbygpCiAgICBvbmx5SW5TdGF0ZShTdGF0ZS5DcmVhdGVkKQogICAgb25seVRyaXZpYWwoKSB7CiAgICAgICAgY3VycmVudFN0YXRlID0gU3RhdGUuSWNvU3RhcnRlZDsKICAgICAgICBJY29TdGFydGVkKGljb0VuZFRpbWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNvbnRyaWJ1dGVJbkljbygpIHBheWFibGUKICAgIG9ubHlJblN0YXRlKFN0YXRlLkljb1N0YXJ0ZWQpCiAgICBvbmx5QmVmb3JlKGljb0VuZFRpbWUpIHsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+IE1JTl9FVEhfQU1PVU5UKTsKCiAgICAgICAgaWYgKGNvbnRyaWJ1dGlvbnNbbXNnLnNlbmRlcl0gPT0gMCkgewogICAgICAgICAgICBjb250cmlidXRvcnMucHVzaChtc2cuc2VuZGVyKTsKICAgICAgICB9CiAgICAgICAgY29udHJpYnV0aW9uc1ttc2cuc2VuZGVyXSA9IFNhZmVNYXRoLmFkZChjb250cmlidXRpb25zW21zZy5zZW5kZXJdLCBtc2cudmFsdWUpOwogICAgICAgIGFtb3VudFJhaXNlZCA9IFNhZmVNYXRoLmFkZChhbW91bnRSYWlzZWQsIG1zZy52YWx1ZSk7CgogICAgICAgIEljb0NvbnRyaWJ1dGVkKG1zZy5zZW5kZXIsIG1zZy52YWx1ZSwgYW1vdW50UmFpc2VkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkaXN0cmlidXRlVG9rZW5zKHVpbnQyNTYgY29udHJpYnV0b3JzTnVtYmVyKQogICAgb25seUluU3RhdGUoU3RhdGUuSWNvU3RhcnRlZCkKICAgIG9ubHlBZnRlcihpY29FbmRUaW1lKSB7CiAgICAgICAgZm9yICh1aW50MjU2IGkgPSAwOyBpIDwgY29udHJpYnV0b3JzTnVtYmVyICYmIG5leHRDb250cmlidXRvckluZGV4VG9CZUdpdmVuVG9rZW5zIDwgY29udHJpYnV0b3JzLmxlbmd0aDsgKytpKSB7CiAgICAgICAgICAgIGFkZHJlc3MgY3VycmVudENvbnRyaWJ1dG9yID0gY29udHJpYnV0b3JzW25leHRDb250cmlidXRvckluZGV4VG9CZUdpdmVuVG9rZW5zKytdOwogICAgICAgICAgICB1aW50MjU2IHRva2Vuc0ZvckNvbnRyaWJ1dG9yID0gU2FmZU1hdGguZGl2KAogICAgICAgICAgICAgICAgU2FmZU1hdGgubXVsKHRva2Vuc0ZvckljbywgY29udHJpYnV0aW9uc1tjdXJyZW50Q29udHJpYnV0b3JdKSwKICAgICAgICAgICAgICAgIGFtb3VudFJhaXNlZCAgLy8gYW1vdW50UmFpc2VkIGNhbid0IGJlIDAsIElDTyBpcyBjYW5jZWxsZWQgdGhlbgogICAgICAgICAgICApOwogICAgICAgICAgICBiYWxhbmNlc1tjdXJyZW50Q29udHJpYnV0b3JdID0gdG9rZW5zRm9yQ29udHJpYnV0b3I7CiAgICAgICAgICAgIHRva2Vuc0Rpc3RyaWJ1dGVkVG9Db250cmlidXRvcnMgPSBTYWZlTWF0aC5hZGQodG9rZW5zRGlzdHJpYnV0ZWRUb0NvbnRyaWJ1dG9ycywgdG9rZW5zRm9yQ29udHJpYnV0b3IpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBmaW5pc2hJY28oKQogICAgb25seUluU3RhdGUoU3RhdGUuSWNvU3RhcnRlZCkKICAgIG9ubHlBZnRlcihpY29FbmRUaW1lKSB7CiAgICAgICAgaWYgKGFtb3VudFJhaXNlZCA9PSAwKSB7CiAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSA9IFN0YXRlLkljb0NhbmNlbGxlZDsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgLy8gYWxsIGNvbnRyaWJ1dG9ycyBtdXN0IGhhdmUgcmVjZWl2ZWQgdGhlaXIgdG9rZW5zIHRvIGZpbmlzaCBJQ08KICAgICAgICByZXF1aXJlKG5leHRDb250cmlidXRvckluZGV4VG9CZUdpdmVuVG9rZW5zID49IGNvbnRyaWJ1dG9ycy5sZW5ndGgpOwoKICAgICAgICBiYWxhbmNlc1thcnRpc3RdID0gU2FmZU1hdGguYWRkKGJhbGFuY2VzW2FydGlzdF0sIHRva2Vuc0ZvckFydGlzdCk7CiAgICAgICAgYmFsYW5jZXNbdHJpdmlhbF0gPSBTYWZlTWF0aC5hZGQoYmFsYW5jZXNbdHJpdmlhbF0sIHRva2Vuc0ZvclRyaXZpYWwpOwogICAgICAgIHVpbnQyNTYgbGVmdG92ZXJzID0gU2FmZU1hdGguc3ViKHRva2Vuc0ZvckljbywgdG9rZW5zRGlzdHJpYnV0ZWRUb0NvbnRyaWJ1dG9ycyk7CiAgICAgICAgYmFsYW5jZXNbYXJ0aXN0XSA9IFNhZmVNYXRoLmFkZChiYWxhbmNlc1thcnRpc3RdLCBsZWZ0b3ZlcnMpOwoKICAgICAgICBpZiAoIWFydGlzdC5zZW5kKHRoaXMuYmFsYW5jZSkpIHsKICAgICAgICAgICAgYXN5bmNTZW5kKGFydGlzdCwgdGhpcy5iYWxhbmNlKTsKICAgICAgICB9CiAgICAgICAgY3VycmVudFN0YXRlID0gU3RhdGUuSWNvRmluaXNoZWQ7CiAgICAgICAgSWNvRmluaXNoZWQoYW1vdW50UmFpc2VkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGVja0NvbnRyaWJ1dGlvbihhZGRyZXNzIGNvbnRyaWJ1dG9yKSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIGNvbnRyaWJ1dGlvbnNbY29udHJpYnV0b3JdOwogICAgfQoKICAgIC8qCiAgICAgICAgQXVjdGlvbiBtZXRob2RzCiAgICAqLwogICAgZnVuY3Rpb24gc3RhcnRBdWN0aW9uKCkKICAgIG9ubHlJblN0YXRlKFN0YXRlLkljb0ZpbmlzaGVkKQogICAgb25seUtleUhvbGRlcnMoKSB7CiAgICAgICAgLy8gMTAwJSB0b2tlbnMgb3duZXIgaXMgdGhlIG9ubHkga2V5IGhvbGRlcgogICAgICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA9PSBUT1RBTF9TVVBQTFkpIHsKICAgICAgICAgICAgLy8gbm8gYXVjdGlvbiB0YWtlcyBwbGFjZSwKICAgICAgICAgICAgaGlnaGVzdEJpZGRlciA9IG1zZy5zZW5kZXI7CiAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSA9IFN0YXRlLkF1Y3Rpb25GaW5pc2hlZDsKICAgICAgICAgICAgQXVjdGlvbkZpbmlzaGVkKGhpZ2hlc3RCaWRkZXIsIGhpZ2hlc3RCaWQpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBhdWN0aW9uRW5kVGltZSA9IFNhZmVNYXRoLmFkZChub3csIGF1Y3Rpb25EdXJhdGlvbik7CiAgICAgICAgY3VycmVudFN0YXRlID0gU3RhdGUuQXVjdGlvblN0YXJ0ZWQ7CiAgICAgICAgQXVjdGlvblN0YXJ0ZWQoYXVjdGlvbkVuZFRpbWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGJpZEluQXVjdGlvbigpIHBheWFibGUKICAgIG9ubHlJblN0YXRlKFN0YXRlLkF1Y3Rpb25TdGFydGVkKQogICAgb25seUJlZm9yZShhdWN0aW9uRW5kVGltZSkgewogICAgICAgIC8vTXVzdCBiZSBncmVhdGVyIG9yIGVxdWFsIHRvIG1pbmltYWwgYW1vdW50CiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPj0gTUlOX0VUSF9BTU9VTlQpOwogICAgICAgIHVpbnQyNTYgYmlkID0gY2FsY3VsYXRlVXNlckJpZCgpOwoKICAgICAgICAvL0lmIHRoZXJlIHdhcyBhIGJpZCBhbHJlYWR5CiAgICAgICAgaWYgKGhpZ2hlc3RCaWQgPj0gTUlOX0VUSF9BTU9VTlQpIHsKICAgICAgICAgICAgLy9NdXN0IGJlIGdyZWF0ZXIgb3IgZXF1YWwgdG8gMTA1JSBvZiBwcmV2aW91cyBiaWQKICAgICAgICAgICAgdWludDI1NiBtaW5pbWFsT3ZlckJpZCA9IFNhZmVNYXRoLmFkZChoaWdoZXN0QmlkLCBTYWZlTWF0aC5kaXYoCiAgICAgICAgICAgICAgICBTYWZlTWF0aC5tdWwoaGlnaGVzdEJpZCwgTUlOX0JJRF9QRVJDRU5UQUdFKSwgMTAwCiAgICAgICAgICAgICkpOwogICAgICAgICAgICByZXF1aXJlKGJpZCA+PSBtaW5pbWFsT3ZlckJpZCk7CiAgICAgICAgICAgIC8vUmV0dXJuIHRvIHByZXZpb3VzIGJpZGRlciBoaXMgYmFsYW5jZQogICAgICAgICAgICAvL1ZhbHVlIHRvIHJldHVybjogY3VycmVudCBiYWxhbmNlIC0gY3VycmVudCBiaWQgLSBwYXltZW50c0luQXN5bmNTZW5kCiAgICAgICAgICAgIHVpbnQyNTYgYW1vdW50VG9SZXR1cm4gPSBTYWZlTWF0aC5zdWIoU2FmZU1hdGguc3ViKAogICAgICAgICAgICAgICAgdGhpcy5iYWxhbmNlLCBtc2cudmFsdWUKICAgICAgICAgICAgKSwgdG90YWxQYXltZW50cyk7CiAgICAgICAgICAgIGlmICghaGlnaGVzdEJpZGRlci5zZW5kKGFtb3VudFRvUmV0dXJuKSkgewogICAgICAgICAgICAgICAgYXN5bmNTZW5kKGhpZ2hlc3RCaWRkZXIsIGFtb3VudFRvUmV0dXJuKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaGlnaGVzdEJpZGRlciA9IG1zZy5zZW5kZXI7CiAgICAgICAgaGlnaGVzdEJpZCA9IGJpZDsKICAgICAgICBIaWdoZXN0QmlkQ2hhbmdlZChoaWdoZXN0QmlkZGVyLCBoaWdoZXN0QmlkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVVc2VyQmlkKCkgcHJpdmF0ZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBiaWQgPSBtc2cudmFsdWU7CiAgICAgICAgdWludDI1NiBjb250cmlidXRpb24gPSBiYWxhbmNlT2YobXNnLnNlbmRlcik7CiAgICAgICAgaWYgKGNvbnRyaWJ1dGlvbiA+IDApIHsKICAgICAgICAgICAgLy9Gb3JtdWxhOiAoc2VudEVUSCAqIGFsbFRva2VucykgLyAoYWxsVG9rZW5zIC0gdXNlclRva2VucykKICAgICAgICAgICAgLy9Vc2VyIHNlbmRzIDE2RVRILCBoYXMgNDAgb2YgMjAwIHRva2VucwogICAgICAgICAgICAvLygxNiAqIDIwMCkgLyAoMjAwIC0gNDApID0+IDMyMDAgLyAxNjAgPT4gMjAKICAgICAgICAgICAgYmlkID0gU2FmZU1hdGguZGl2KAogICAgICAgICAgICAgICAgU2FmZU1hdGgubXVsKG1zZy52YWx1ZSwgVE9UQUxfU1VQUExZKSwKICAgICAgICAgICAgICAgIFNhZmVNYXRoLnN1YihUT1RBTF9TVVBQTFksIGNvbnRyaWJ1dGlvbikKICAgICAgICAgICAgKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJpZDsKICAgIH0KCiAgICBmdW5jdGlvbiBmaW5pc2hBdWN0aW9uKCkKICAgIG9ubHlJblN0YXRlKFN0YXRlLkF1Y3Rpb25TdGFydGVkKQogICAgb25seUFmdGVyKGF1Y3Rpb25FbmRUaW1lKSB7CiAgICAgICAgcmVxdWlyZShoaWdoZXN0QmlkID4gMCk7ICAvLyBhdWN0aW9uIGNhbm5vdCBiZSBmaW5pc2hlZCB1bnRpbCBhdCBsZWFzdCBvbmUgcGVyc29uIGJpZHMKICAgICAgICBjdXJyZW50U3RhdGUgPSBTdGF0ZS5BdWN0aW9uRmluaXNoZWQ7CiAgICAgICAgQXVjdGlvbkZpbmlzaGVkKGhpZ2hlc3RCaWRkZXIsIGhpZ2hlc3RCaWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHdpdGhkcmF3U2hhcmVzKGFkZHJlc3MgaG9sZGVyKSBwdWJsaWMKICAgIG9ubHlJblN0YXRlKFN0YXRlLkF1Y3Rpb25GaW5pc2hlZCkgewogICAgICAgIHVpbnQyNTYgYXZhaWxhYmxlVG9rZW5zID0gYmFsYW5jZXNbaG9sZGVyXTsKICAgICAgICByZXF1aXJlKGF2YWlsYWJsZVRva2VucyA+IDApOwogICAgICAgIGJhbGFuY2VzW2hvbGRlcl0gPSAwOwoKICAgICAgICBpZiAoaG9sZGVyICE9IGhpZ2hlc3RCaWRkZXIpIHsKICAgICAgICAgICAgaG9sZGVyLnRyYW5zZmVyKAogICAgICAgICAgICAgICAgU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChoaWdoZXN0QmlkLCBhdmFpbGFibGVUb2tlbnMpLCBUT1RBTF9TVVBQTFkpCiAgICAgICAgICAgICk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGlzS2V5SG9sZGVyKGFkZHJlc3MgcGVyc29uKSBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW3BlcnNvbl0gPj0gU2FmZU1hdGguZGl2KHRva2Vuc0ZvckljbywgVE9LRU5TX1BFUkNFTlRBR0VfRk9SX0tFWV9IT0xERVIpOyB9CgogICAgLyoKICAgICAgICBHZW5lcmFsIG1ldGhvZHMKICAgICovCgogICAgLy8gQ2FuY2VsIElDTyB3aWxsIGJlIHJlZGVzaWduZWQgdG8gcHJldmVudAogICAgLy8gcmlzayBvZiB1c2VyIGZ1bmRzIG92ZXJ0YWtlbgoKICAgIC8qZnVuY3Rpb24gY2FuY2VsSWNvKCkKICAgIG9ubHlJblN0YXRlKFN0YXRlLkljb1N0YXJ0ZWQpCiAgICBvbmx5VHJpdmlhbCgpIHsKICAgICAgICBjdXJyZW50U3RhdGUgPSBTdGF0ZS5JY29DYW5jZWxsZWQ7CiAgICAgICAgSWNvQ2FuY2VsbGVkKCk7CiAgICB9CgogICAgZnVuY3Rpb24gY2xhaW1JY29Db250cmlidXRpb24oYWRkcmVzcyBjb250cmlidXRvcikgb25seUluU3RhdGUoU3RhdGUuSWNvQ2FuY2VsbGVkKSB7CiAgICAgICAgdWludDI1NiBjb250cmlidXRpb24gPSBjb250cmlidXRpb25zW2NvbnRyaWJ1dG9yXTsKICAgICAgICByZXF1aXJlKGNvbnRyaWJ1dGlvbiA+IDApOwogICAgICAgIGNvbnRyaWJ1dGlvbnNbY29udHJpYnV0b3JdID0gMDsKICAgICAgICBjb250cmlidXRvci50cmFuc2Zlcihjb250cmlidXRpb24pOwogICAgfSovCgogICAgZnVuY3Rpb24gc2V0QXVjdGlvbldpbm5lck1lc3NhZ2VIYXNoKGJ5dGVzMzIgX2F1Y3Rpb25XaW5uZXJNZXNzYWdlSGFzaCkKICAgIG9ubHlBdWN0aW9uV2lubmVyKCkgewogICAgICAgIGF1Y3Rpb25XaW5uZXJNZXNzYWdlSGFzaCA9IF9hdWN0aW9uV2lubmVyTWVzc2FnZUhhc2g7CiAgICAgICAgV2lubmVyUHJvdmlkZWRIYXNoKCk7CiAgICB9CgogICAgZnVuY3Rpb24ga2lsbENvbnRyYWN0KCkKICAgIG9ubHlUcml2aWFsKCkgewogICAgICAgIHJlcXVpcmUoCiAgICAgICAgICAgICgKICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSA9PSBTdGF0ZS5BdWN0aW9uRmluaXNoZWQgJiYKICAgICAgICAgICAgICAgIG5vdyA+IFNhZmVNYXRoLmFkZChhdWN0aW9uRW5kVGltZSwgQ0xFQU5VUF9ERUxBWSkgLy8gRGVsYXkgaW4gY29ycmVjdCBzdGF0ZQogICAgICAgICAgICApIHx8CiAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSA9PSBTdGF0ZS5JY29DYW5jZWxsZWQgLy8gTm8gZGVsYXkgaW4gY2FuY2VsbGVkIHN0YXRlCiAgICAgICAgKTsKICAgICAgICBzZWxmZGVzdHJ1Y3QodHJpdmlhbCk7CiAgICB9CgogICAgLy8gaGVscGVyIGZ1bmN0aW9uIHRvIGF2b2lkIHRvbyBtYW55IGNvbnRyYWN0IGNhbGxzIG9uIGZyb250ZW5kIHNpZGUKICAgIGZ1bmN0aW9uIGdldENvbnRyYWN0U3RhdGUoKSBjb25zdGFudCByZXR1cm5zICgKICAgICAgICB1aW50MjU2LCB1aW50MjU2LCB1aW50MjU2LCB1aW50MjU2LCB1aW50MjU2LAogICAgICAgIHVpbnQyNTYsIHVpbnQyNTYsIGFkZHJlc3MsIHVpbnQyNTYsIFN0YXRlLAogICAgICAgIHVpbnQyNTYsIHVpbnQyNTYKICAgICkgewogICAgICAgIHJldHVybiAoCiAgICAgICAgICAgIGljb0VuZFRpbWUsIGF1Y3Rpb25EdXJhdGlvbiwgYXVjdGlvbkVuZFRpbWUsCiAgICAgICAgICAgIHRva2Vuc0ZvckFydGlzdCwgdG9rZW5zRm9yVHJpdmlhbCwgdG9rZW5zRm9ySWNvLAogICAgICAgICAgICBhbW91bnRSYWlzZWQsIGhpZ2hlc3RCaWRkZXIsIGhpZ2hlc3RCaWQsIGN1cnJlbnRTdGF0ZSwKICAgICAgICAgICAgVE9LRU5TX1BFUkNFTlRBR0VfRk9SX0tFWV9IT0xERVIsIE1JTl9CSURfUEVSQ0VOVEFHRQogICAgICAgICk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBieXRlcyBfZGF0YSkgb25seUluU3RhdGUoU3RhdGUuSWNvRmluaXNoZWQpIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gRVJDMjIzVG9rZW4udHJhbnNmZXIoX3RvLCBfdmFsdWUsIF9kYXRhKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsKICAgICAgICAvLyBvbmx5SW5TdGF0ZShJY29GaW5pc2hlZCkgY2hlY2sgaXMgY29udGFpbmVkIGluIGEgY2FsbCBiZWxvdwogICAgICAgIGJ5dGVzIG1lbW9yeSBlbXB0eTsKICAgICAgICByZXR1cm4gdHJhbnNmZXIoX3RvLCBfdmFsdWUsIGVtcHR5KTsKICAgIH0KCiAgICBmdW5jdGlvbiAoKSBwYXlhYmxlIHsKICAgICAgICByZXZlcnQoKTsKICAgIH0KfQ=='.
	

]
