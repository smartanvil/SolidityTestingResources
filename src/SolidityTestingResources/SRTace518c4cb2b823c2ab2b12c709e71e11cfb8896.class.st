Class {
	#name : #SRTace518c4cb2b823c2ab2b12c709e71e11cfb8896,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTace518c4cb2b823c2ab2b12c709e71e11cfb8896 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgoKLyoqCiAqIE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MKICovCgpsaWJyYXJ5IFNhZmVNYXRoIHsKCgogICAgZnVuY3Rpb24gbXVsKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQpIHsKICAgICAgICB1aW50IGMgPSBhICogYjsKICAgICAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIHN1Yih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50KSB7CiAgICAgICAgYXNzZXJ0KGIgPD0gYSk7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50KSB7CiAgICAgICAgdWludCBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGM+PWEgJiYgYz49Yik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9Cn0KCgovKiAKICogVG9rZW4gcmVsYXRlZCBjb250cmFjdHMgCiAqLwoKCi8qCiAqIEVSQzIwQmFzaWMKICogU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwoKY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIHZpZXcgcmV0dXJucyAodWludCk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50IHZhbHVlKTsKfQoKCi8qKgogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKi8KCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuCiAqLwoKY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgICAvKioKICAgICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAgICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1ttc2cuc2VuZGVyXSk7CgogICAgICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgICAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAgICAqIEByZXR1cm4gQW4gdWludCByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogICAgfQoKfQoKCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCgpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CgoKICAgIC8qKgogICAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW19mcm9tXSk7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0pOwoKICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICAgKgogICAgICogQmV3YXJlIHRoYXQgY2hhbmdpbmcgYW4gYWxsb3dhbmNlIHdpdGggdGhpcyBtZXRob2QgYnJpbmdzIHRoZSByaXNrIHRoYXQgc29tZW9uZSBtYXkgdXNlIGJvdGggdGhlIG9sZAogICAgICogYW5kIHRoZSBuZXcgYWxsb3dhbmNlIGJ5IHVuZm9ydHVuYXRlIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcwogICAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAgICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgICAqLwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgICB9Cgp9CgoKLyoKICogT3duYWJsZQogKgogKiBCYXNlIGNvbnRyYWN0IHdpdGggYW4gb3duZXIuCiAqIFByb3ZpZGVzIG9ubHlPd25lciBtb2RpZmllciwgd2hpY2ggcHJldmVudHMgZnVuY3Rpb24gZnJvbSBydW5uaW5nIGlmIGl0IGlzIGNhbGxlZCBieSBhbnlvbmUgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAqLwoKY29udHJhY3QgT3duYWJsZSB7CiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKICAgIGFkZHJlc3MgcHVibGljIG5ld093bmVyOwoKICAgIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5T3duZXIoKSB7IAogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5TmV3T3duZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG5ld093bmVyKTsKICAgICAgICBfOwogICAgfQogICAgLyoKICAgIC8vIFRoaXMgY29kZSBpcyBkYW5nZXJvdXMgYmVjYXVzZSBhbiBlcnJvciBpbiB0aGUgbmV3T3duZXIgCiAgICAvLyBtZWFucyB0aGF0IHRoaXMgY29udHJhY3Qgd2lsbCBiZSBvd25lcmxlc3MgCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOyAKICAgICAgICBvd25lciA9IG5ld093bmVyOwogICAgfQogICAqLwoKICAgIGZ1bmN0aW9uIHByb3Bvc2VOZXdPd25lcihhZGRyZXNzIF9uZXdPd25lcikgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKF9uZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgICAgICBuZXdPd25lciA9IF9uZXdPd25lcjsKICAgIH0KCiAgICBmdW5jdGlvbiBhY2NlcHRPd25lcnNoaXAoKSBleHRlcm5hbCBvbmx5TmV3T3duZXIgewogICAgICAgIHJlcXVpcmUobmV3T3duZXIgIT0gb3duZXIpOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICB9Cn0KCgovKioKICogQHRpdGxlIE1pbnRhYmxlIHRva2VuCiAqIEBkZXYgU2ltcGxlIEVSQzIwIFRva2VuIGV4YW1wbGUsIHdpdGggbWludGFibGUgdG9rZW4gY3JlYXRpb24KICogQGRldiBJc3N1ZTogKiBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5L2lzc3Vlcy8xMjAKICogQmFzZWQgb24gY29kZSBieSBUb2tlbk1hcmtldE5ldDogaHR0cHM6Ly9naXRodWIuY29tL1Rva2VuTWFya2V0TmV0L2ljby9ibG9iL21hc3Rlci9jb250cmFjdHMvTWludGFibGVUb2tlbi5zb2wKICovCgpjb250cmFjdCBNaW50YWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIE93bmFibGUgewogICAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKICAgIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwoKICAgIGJvb2wgcHVibGljIG1pbnRpbmdGaW5pc2hlZCA9IGZhbHNlOwoKCiAgICBtb2RpZmllciBjYW5NaW50KCkgewogICAgICAgIHJlcXVpcmUoIW1pbnRpbmdGaW5pc2hlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gbWludCB0b2tlbnMKICAgICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIG1pbnRlZCB0b2tlbnMuCiAgICAgKiBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAgICogQHJldHVybiBBIGJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgICAqLwogICAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBwdWJsaWMgb25seU93bmVyIGNhbk1pbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKF9hbW91bnQpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfYW1vdW50KTsKICAgICAgICBNaW50KF90bywgX2Ftb3VudCk7CiAgICAgICAgVHJhbnNmZXIoYWRkcmVzcygwKSwgX3RvLCBfYW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gc3RvcCBtaW50aW5nIG5ldyB0b2tlbnMuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgICAqLwogICAgZnVuY3Rpb24gZmluaXNoTWludGluZygpIHB1YmxpYyBvbmx5T3duZXIgY2FuTWludCByZXR1cm5zIChib29sKSB7CiAgICAgICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgICAgICBNaW50RmluaXNoZWQoKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQoKCi8qKgogKiBAdGl0bGUgQnVybmFibGUgVG9rZW4KICogQGRldiBUb2tlbiB0aGF0IGNhbiBiZSBpcnJldmVyc2libHkgYnVybmVkIChkZXN0cm95ZWQpLgogKi8KY29udHJhY3QgQnVybmFibGVUb2tlbiBpcyBCYXNpY1Rva2VuIHsKCiAgICBldmVudCBCdXJuKGFkZHJlc3MgaW5kZXhlZCBidXJuZXIsIHVpbnQyNTYgdmFsdWUpOwoKICAgIC8qKgogICAgICogQGRldiBCdXJucyBhIHNwZWNpZmljIGFtb3VudCBvZiB0b2tlbnMuCiAgICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgYnVybmVkLgogICAgICovCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgIHsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1ttc2cuc2VuZGVyXSk7CiAgICAgICAgLy8gbm8gbmVlZCB0byByZXF1aXJlIHZhbHVlIDw9IHRvdGFsU3VwcGx5LCBzaW5jZSB0aGF0IHdvdWxkIGltcGx5IHRoZQogICAgICAgIC8vIHNlbmRlcidzIGJhbGFuY2UgaXMgZ3JlYXRlciB0aGFuIHRoZSB0b3RhbFN1cHBseSwgd2hpY2ggKnNob3VsZCogYmUgYW4gYXNzZXJ0aW9uIGZhaWx1cmUKCiAgICAgICAgYWRkcmVzcyBidXJuZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIGJhbGFuY2VzW2J1cm5lcl0gPSBiYWxhbmNlc1tidXJuZXJdLnN1YihfdmFsdWUpOwogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuc3ViKF92YWx1ZSk7CiAgICAgICAgQnVybihidXJuZXIsIF92YWx1ZSk7CiAgICB9Cn0KCgovKioKICogQHRpdGxlIFBhdXNhYmxlCiAqIEBkZXYgQmFzZSBjb250cmFjdCB3aGljaCBhbGxvd3MgY2hpbGRyZW4gdG8gaW1wbGVtZW50IGFuIGVtZXJnZW5jeSBzdG9wIG1lY2hhbmlzbS4KICovCgpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKCgogICAgZXZlbnQgUGF1c2UoKTsKICAgIGV2ZW50IFVucGF1c2UoKTsKCiAgICBib29sIHB1YmxpYyBwYXVzZWQgPSB0cnVlOwoKCiAgICAvKioKICAgICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgbm90IHBhdXNlZC4KICAgICAqLwogICAgbW9kaWZpZXIgd2hlbk5vdFBhdXNlZCgpIHsKICAgICAgICByZXF1aXJlKCFwYXVzZWQpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIHBhdXNlZC4KICAgICAqLwogICAgbW9kaWZpZXIgd2hlblBhdXNlZCgpIHsKICAgICAgICByZXF1aXJlKHBhdXNlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byBwYXVzZSwgdHJpZ2dlcnMgc3RvcHBlZCBzdGF0ZQogICAgICovCiAgICBmdW5jdGlvbiBwYXVzZSgpIG9ubHlPd25lciB3aGVuTm90UGF1c2VkIHB1YmxpYyB7CiAgICAgICAgcGF1c2VkID0gdHJ1ZTsKICAgICAgICBQYXVzZSgpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHVucGF1c2UsIHJldHVybnMgdG8gbm9ybWFsIHN0YXRlCiAgICAgKi8KICAgIGZ1bmN0aW9uIHVucGF1c2UoKSBvbmx5T3duZXIgd2hlblBhdXNlZCBwdWJsaWMgewogICAgICAgIHBhdXNlZCA9IGZhbHNlOwogICAgICAgIFVucGF1c2UoKTsKICAgIH0KfQoKCgovKiBAdGl0bGUgUGF1c2FibGUgdG9rZW4KICoKICogQGRldiBTdGFuZGFyZFRva2VuIG1vZGlmaWVkIHdpdGggcGF1c2FibGUgdHJhbnNmZXJzLgogKiovCgpjb250cmFjdCBQYXVzYWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIFBhdXNhYmxlIHsKCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci5hcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUpOwogICAgfQoKfQoKCi8qCiAqIEFjdHVhbCB0b2tlbiBjb250cmFjdAogKi8KCmNvbnRyYWN0IEFjalRva2VuIGlzIEJ1cm5hYmxlVG9rZW4sIE1pbnRhYmxlVG9rZW4sIFBhdXNhYmxlVG9rZW4gewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIkFydGlzdCBDb25uZWN0IENvaW4iOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiQUNKIjsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CiAgICAKICAgIGZ1bmN0aW9uIEFjalRva2VuKCkgcHVibGljIHsKICAgICAgICB0b3RhbFN1cHBseSA9IDE1MDAwMDAwMCBldGhlcjsgCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSB0b3RhbFN1cHBseTsKICAgICAgICBwYXVzZWQgPSB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICB1bnBhdXNlKCk7CiAgICAgICAgZmluaXNoTWludGluZygpOwogICAgfQoKICAgIC8vIFRoaXMgbWV0aG9kIHdpbGwgYmUgdXNlZCBieSB0aGUgY3Jvd2RzYWxlIHNtYXJ0IGNvbnRyYWN0IAogICAgLy8gdGhhdCBvd25zIHRoZSBBY2pUb2tlbiBhbmQgd2lsbCBkaXN0cmlidXRlIAogICAgLy8gdGhlIHRva2VucyB0byB0aGUgY29udHJpYnV0b3JzCiAgICBmdW5jdGlvbiBpbml0aWFsVHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBleHRlcm5hbCBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gYnVybih1aW50MjU2IF9hbW91bnQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHN1cGVyLmJ1cm4oX2Ftb3VudCk7CiAgICB9Cgp9CgogCgoKY29udHJhY3QgQWNqQ3Jvd2RzYWxlIGlzIE93bmFibGUgewoKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogICAgCiAgICAvLyBQcmVzYWxlIGJvbnVzIHBlcmNlbnRhZ2UKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IEJPTlVTX1BSRVNBTEUgPSAxMDsgICAgICAgICAgICAKICAgIC8vIE1lZGl1bSBib251cyBwZXJjZW50YWdlCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBCT05VU19NSUQgPSAxMDsgICAgICAgICAgICAgICAgCiAgICAvLyBIaWdoIGJvbnVzIHBlcmNlbnRhZ2UKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IEJPTlVTX0hJID0gMjA7ICAgICAgICAgICAgICAgICAKICAgIC8vIE1lZGl1bSBib251cyB0aHJlc2hvbGQKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IEJPTlVTX01JRF9RVFkgPSAxNTAgZXRoZXI7ICAgICAKICAgIC8vIEhpZ2ggYm9udXMgdGhyZXNob2xkCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBCT05VU19ISV9RVFkgPSAzMzUgZXRoZXI7ICAgICAgCiAgICAvLyBBYnNvbHV0ZSBkYXRlcyBhcyB0aW1lc3RhbXBzCiAgICB1aW50IHB1YmxpYyBzdGFydFByZXNhbGU7ICAgICAgICAgICAgCiAgICB1aW50IHB1YmxpYyBlbmRQcmVzYWxlOyAgICAgICAgICAgICAKICAgIHVpbnQgcHVibGljIHN0YXJ0SWNvOyAgICAgICAgICAgICAgCiAgICB1aW50IHB1YmxpYyBlbmRJY287ICAgICAgICAgICAgICAgCiAgICAvLyAzMCBkYXlzIHJlZnVuZCBwZXJpb2Qgb24gZmFpbAogICAgdWludCBwdWJsaWMgY29uc3RhbnQgUkVGVU5EX1BFUklPRCA9IDMwIGRheXM7CiAgICAvLyBJbmRpY2F0aXZlIHRva2VuIGJhbGFuY2VzIGR1cmluZyB0aGUgY3Jvd2RzYWxlIAogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyB0b2tlbkJhbGFuY2VzOyAgICAKICAgIC8vIFRva2VuIHNtYXJ0IGNvbnRyYWN0IGFkZHJlc3MKICAgIGFkZHJlc3MgcHVibGljIHRva2VuOwogICAgLy8gVG90YWwgdG9rZW5zIGNyZWF0ZWQKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IFRPS0VOU19UT1RBTF9TVVBQTFkgPSAxNTAwMDAwMDAgZXRoZXI7IAogICAgLy8gVG9rZW5zIGF2YWlsYWJsZSBmb3Igc2FsZQogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgVE9LRU5TX0ZPUl9TQUxFID0gNzUwMDAwMDAgZXRoZXI7ICAgIAogICAgLy8gc29mdCBjYXAgaW4gVG9rZW5zCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBUT0tFTlNfU09GVF9DQVAgPSA1MDAwMDAgZXRoZXI7ICAgICAgIAogICAgLy8gVG9rZW5zIHNvbGQgdmlhIGJ1eVRva2VucwogICAgdWludDI1NiBwdWJsaWMgdG9rZW5zU29sZDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgLy8gVG9rZW5zIGNyZWF0ZWQgZHVyaW5nIHRoZSBzYWxlCiAgICB1aW50MjU2IHB1YmxpYyB0b2tlbnNEaXN0cmlidXRlZDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgLy8gSUNPIGZsYXQgcmF0ZSBzdWJqZWN0IHRvIGJvbnVzZXMKICAgIHVpbnQyNTYgcHVibGljIGV0aFRva2VuUmF0ZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgIC8vIEFsbG93IG11bHRpcGxlIGFkbWluaXN0cmF0b3JzCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIGFkbWluczsgICAgICAgICAgICAgICAgICAgIAogICAgLy8gVG90YWwgd2VpIHJlY2VpdmVkIAogICAgdWludDI1NiBwdWJsaWMgd2VpUmVjZWl2ZWQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgLy8gTWluaW11bSBjb250cmlidXRpb24gaW4gRVRICiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBNSU5fQ09OVFJJQlVUSU9OID0gMTAwIGZpbm5leTsgICAgICAgICAgIAogICAgLy8gQ29udHJpYnV0aW9ucyBpbiB3ZWkgZm9yIGVhY2ggYWRkcmVzcwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBjb250cmlidXRpb25zOwogICAgLy8gUmVmdW5kIHN0YXRlIGZvciBlYWNoIGFkZHJlc3MKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgcmVmdW5kczsKICAgIC8vIENvbXBhbnkgd2FsbGV0IHRoYXQgd2lsbCByZWNlaXZlIHRoZSBFVEgKICAgIGFkZHJlc3MgcHVibGljIGNvbXBhbnlXYWxsZXQ7ICAgICAKCiAgICAvLyBZb29ob28gc29tZW9uZSBjb250cmlidXRlZCAhCiAgICBldmVudCBDb250cmlidXRlKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgdWludCBfYW1vdW50KTsgCiAgICAvLyBUb2tlbiA8PiBFVEggcmF0ZSB1cGRhdGVkCiAgICBldmVudCBUb2tlblJhdGVVcGRhdGVkKHVpbnQgX25ld1JhdGUpOyAgICAgICAgICAgICAgICAgIAogICAgLy8gRVRIIFJlZnVuZCAKICAgIGV2ZW50IFJlZnVuZGVkKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgdWludCBfYW1vdW50KTsgICAgCiAgICAKICAgIG1vZGlmaWVyIGJlbG93VG90YWxTdXBwbHkgewogICAgICAgIHJlcXVpcmUodG9rZW5zRGlzdHJpYnV0ZWQgPCBUT0tFTlNfVE9UQUxfU1VQUExZKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIGJlbG93SGFyZENhcCB7CiAgICAgICAgcmVxdWlyZSh0b2tlbnNEaXN0cmlidXRlZCA8IFRPS0VOU19GT1JfU0FMRSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBhZG1pbk9ubHkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lciB8fCBhZG1pbnNbbXNnLnNlbmRlcl0gPT0gdHJ1ZSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBjcm93ZHNhbGVGYWlsZWQgewogICAgICAgIHJlcXVpcmUoaXNGYWlsZWQoKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBjcm93ZHNhbGVTdWNjZXNzIHsKICAgICAgICByZXF1aXJlKGlzU3VjY2VzcygpKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIGR1cmluZ1NhbGUgewogICAgICAgIHJlcXVpcmUobm93IDwgZW5kSWNvKTsKICAgICAgICByZXF1aXJlKChub3cgPiBzdGFydFByZXNhbGUgJiYgbm93IDwgZW5kUHJlc2FsZSkgfHwgbm93ID4gc3RhcnRJY28pOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgYWZ0ZXJTYWxlIHsKICAgICAgICByZXF1aXJlKG5vdyA+IGVuZEljbyk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBhYm92ZU1pbmltdW0gewogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID49IE1JTl9DT05UUklCVVRJT04pOwogICAgICAgIF87CiAgICB9CgogICAgLyogCiAgICAgKiBDb25zdHJ1Y3RvcgogICAgICogQ3JlYXRpbmcgdGhlIG5ldyBUb2tlbiBzbWFydCBjb250cmFjdAogICAgICogYW5kIHNldHRpbmcgaXRzIG93bmVyIHRvIHRoZSBjdXJyZW50IHNlbmRlcgogICAgICogCiAgICAgKi8KICAgIGZ1bmN0aW9uIEFjakNyb3dkc2FsZSgKICAgICAgICB1aW50IF9wcmVzYWxlU3RhcnQsCiAgICAgICAgdWludCBfcHJlc2FsZUVuZCwKICAgICAgICB1aW50IF9pY29TdGFydCwKICAgICAgICB1aW50IF9pY29FbmQsCiAgICAgICAgdWludDI1NiBfcmF0ZSwKICAgICAgICBhZGRyZXNzIF90b2tlbgogICAgKSBwdWJsaWMgCiAgICB7CiAgICAgICAgcmVxdWlyZShfcHJlc2FsZUVuZCA+IF9wcmVzYWxlU3RhcnQpOwogICAgICAgIHJlcXVpcmUoX2ljb1N0YXJ0ID4gX3ByZXNhbGVFbmQpOwogICAgICAgIHJlcXVpcmUoX2ljb0VuZCA+IF9pY29TdGFydCk7CiAgICAgICAgcmVxdWlyZShfcmF0ZSA+IDApOyAKCiAgICAgICAgc3RhcnRQcmVzYWxlID0gX3ByZXNhbGVTdGFydDsKICAgICAgICBlbmRQcmVzYWxlID0gX3ByZXNhbGVFbmQ7CiAgICAgICAgc3RhcnRJY28gPSBfaWNvU3RhcnQ7CiAgICAgICAgZW5kSWNvID0gX2ljb0VuZDsKICAgICAgICBldGhUb2tlblJhdGUgPSBfcmF0ZTsKICAgICAgICAKICAgICAgICBhZG1pbnNbbXNnLnNlbmRlcl0gPSB0cnVlOwogICAgICAgIGNvbXBhbnlXYWxsZXQgPSBtc2cuc2VuZGVyOwoKICAgICAgICB0b2tlbiA9IF90b2tlbjsKICAgIH0KCiAgICAvKgogICAgICogRmFsbGJhY2sgcGF5YWJsZQogICAgICovCiAgICBmdW5jdGlvbiAoKSBleHRlcm5hbCBwYXlhYmxlIHsKICAgICAgICBidXlUb2tlbnMobXNnLnNlbmRlcik7CiAgICB9CgogICAgLyogQ3Jvd2RzYWxlIHN0YWZmIG9ubHkgKi8KICAgIC8qCiAgICAgKiBBZG1pbiBtYW5hZ2VtZW50CiAgICAgKi8KICAgIGZ1bmN0aW9uIGFkZEFkbWluKGFkZHJlc3MgX2FkcikgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKF9hZHIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgYWRtaW5zW19hZHJdID0gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiByZW1vdmVBZG1pbihhZGRyZXNzIF9hZHIpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShfYWRyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIGFkbWluc1tfYWRyXSA9IGZhbHNlOwogICAgfQoKICAgIC8qCiAgICAgKiBDaGFuZ2UgdGhlIGNvbXBhbnkgd2FsbGV0CiAgICAgKi8KICAgIGZ1bmN0aW9uIHVwZGF0ZUNvbXBhbnlXYWxsZXQoYWRkcmVzcyBfd2FsbGV0KSBleHRlcm5hbCBhZG1pbk9ubHkgewogICAgICAgIGNvbXBhbnlXYWxsZXQgPSBfd2FsbGV0OwogICAgfQoKICAgIC8qCiAgICAgKiAgQ2hhbmdlIHRoZSBvd25lciBvZiB0aGUgdG9rZW4KICAgICAqLwogICAgZnVuY3Rpb24gcHJvcG9zZVRva2VuT3duZXIoYWRkcmVzcyBfbmV3T3duZXIpIGV4dGVybmFsIGFkbWluT25seSB7CiAgICAgICAgQWNqVG9rZW4gX3Rva2VuID0gQWNqVG9rZW4odG9rZW4pOwogICAgICAgIF90b2tlbi5wcm9wb3NlTmV3T3duZXIoX25ld093bmVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhY2NlcHRUb2tlbk93bmVyc2hpcCgpIGV4dGVybmFsIG9ubHlPd25lciB7ICAgIAogICAgICAgIEFjalRva2VuIF90b2tlbiA9IEFjalRva2VuKHRva2VuKTsKICAgICAgICBfdG9rZW4uYWNjZXB0T3duZXJzaGlwKCk7CiAgICB9CgogICAgLyoKICAgICAqIEFjdGl2YXRlIHRoZSB0b2tlbgogICAgICovCiAgICBmdW5jdGlvbiBhY3RpdmF0ZVRva2VuKCkgZXh0ZXJuYWwgYWRtaW5Pbmx5IGNyb3dkc2FsZVN1Y2Nlc3MgYWZ0ZXJTYWxlIHsKICAgICAgICBBY2pUb2tlbiBfdG9rZW4gPSBBY2pUb2tlbih0b2tlbik7CiAgICAgICAgX3Rva2VuLmFjdGl2YXRlKCk7CiAgICB9CgogICAgLyogCiAgICAgKiBBZGp1c3QgdGhlIHRva2VuIHZhbHVlIGJlZm9yZSB0aGUgSUNPCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFkanVzdFRva2VuRXhjaGFuZ2VSYXRlKHVpbnQgX3JhdGUpIGV4dGVybmFsIGFkbWluT25seSB7CiAgICAgICAgcmVxdWlyZShub3cgPiBlbmRQcmVzYWxlICYmIG5vdyA8IHN0YXJ0SWNvKTsKICAgICAgICBldGhUb2tlblJhdGUgPSBfcmF0ZTsKICAgICAgICBUb2tlblJhdGVVcGRhdGVkKF9yYXRlKTsKICAgIH0KCiAgICAvKiAKICAgICAqIFN0YXJ0IHRoZXJlZnVuZCBwZXJpb2QKICAgICAqIEVhY2ggY29udHJpYnV0b3IgaGFzIHRvIGNsYWltIG93biAgRVRIIAogICAgICovICAgICAKICAgIGZ1bmN0aW9uIHJlZnVuZENvbnRyaWJ1dGlvbigpIGV4dGVybmFsIGNyb3dkc2FsZUZhaWxlZCBhZnRlclNhbGUgewogICAgICAgIHJlcXVpcmUoIXJlZnVuZHNbbXNnLnNlbmRlcl0pOwogICAgICAgIHJlcXVpcmUoY29udHJpYnV0aW9uc1ttc2cuc2VuZGVyXSA+IDApOwoKICAgICAgICB1aW50MjU2IF9hbW91bnQgPSBjb250cmlidXRpb25zW21zZy5zZW5kZXJdOwogICAgICAgIHRva2VuQmFsYW5jZXNbbXNnLnNlbmRlcl0gPSAwOwogICAgICAgIHJlZnVuZHNbbXNnLnNlbmRlcl0gPSB0cnVlOwogICAgICAgIFJlZnVuZGVkKG1zZy5zZW5kZXIsIGNvbnRyaWJ1dGlvbnNbbXNnLnNlbmRlcl0pOwogICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoX2Ftb3VudCk7CiAgICB9CgogICAgLyoKICAgICAqIEFmdGVyIHRoZSByZWZ1bmQgcGVyaW9kLCByZW1haW5pbmcgdG9rZW5zCiAgICAgKiBhcmUgdHJhbnNmZXJlZCB0byB0aGUgY29tcGFueSB3YWxsZXQKICAgICAqIEFsbG93IHdpdGhkcmF3YWwgYXQgYW55IHRpbWUgaWYgdGhlIElDTyBpcyBhIHN1Y2Nlc3MuCiAgICAgKi8gICAgIAogICAgZnVuY3Rpb24gd2l0aGRyYXdVbmNsYWltZWQoKSBleHRlcm5hbCBhZG1pbk9ubHkgewogICAgICAgIHJlcXVpcmUobm93ID4gZW5kSWNvICsgUkVGVU5EX1BFUklPRCB8fCBpc1N1Y2Nlc3MoKSk7CiAgICAgICAgY29tcGFueVdhbGxldC50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgfQoKICAgIC8qCiAgICAgKiBQcmUtSUNPIGFuZCBvZmZsaW5lIEludmVzdG9ycywgY29sbGFib3JhdG9ycyBhbmQgdGVhbSB0b2tlbnMKICAgICAqLwogICAgZnVuY3Rpb24gcmVzZXJ2ZVRva2VucyhhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludDI1NiBfdG9rZW5zUXR5KSBleHRlcm5hbCBhZG1pbk9ubHkgYmVsb3dUb3RhbFN1cHBseSB7CiAgICAgICAgcmVxdWlyZShfYmVuZWZpY2lhcnkgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgdWludCBfZGlzdHJpYnV0ZWQgPSB0b2tlbnNEaXN0cmlidXRlZC5hZGQoX3Rva2Vuc1F0eSk7CgogICAgICAgIHJlcXVpcmUoX2Rpc3RyaWJ1dGVkIDw9IFRPS0VOU19UT1RBTF9TVVBQTFkpOwoKICAgICAgICB0b2tlbkJhbGFuY2VzW19iZW5lZmljaWFyeV0gPSBfdG9rZW5zUXR5LmFkZCh0b2tlbkJhbGFuY2VzW19iZW5lZmljaWFyeV0pOwogICAgICAgIHRva2Vuc0Rpc3RyaWJ1dGVkID0gX2Rpc3RyaWJ1dGVkOwoKICAgICAgICBBY2pUb2tlbiBfdG9rZW4gPSBBY2pUb2tlbih0b2tlbik7CiAgICAgICAgX3Rva2VuLmluaXRpYWxUcmFuc2ZlcihfYmVuZWZpY2lhcnksIF90b2tlbnNRdHkpOwogICAgfQoKICAgIC8qCiAgICAgKiBBY3R1YWxseSBidXkgdGhlIHRva2VucwogICAgICogcmVxdWlyZXMgYW4gYWN0aXZlIHNhbGUgdGltZQogICAgICogYW5kIGFtb3VudCBhYm92ZSB0aGUgbWluaW11bSBjb250cmlidXRpb24KICAgICAqIGFuZCBzb2xkIHRva2VucyBpbmZlcmlvciB0byB0b2tlbnMgZm9yIHNhbGUKICAgICAqLyAgICAgCiAgICBmdW5jdGlvbiBidXlUb2tlbnMoYWRkcmVzcyBfYmVuZWZpY2lhcnkpIHB1YmxpYyBwYXlhYmxlIGR1cmluZ1NhbGUgYWJvdmVNaW5pbXVtIGJlbG93SGFyZENhcCB7CiAgICAgICAgcmVxdWlyZShfYmVuZWZpY2lhcnkgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgdWludDI1NiBfd2VpQW1vdW50ID0gbXNnLnZhbHVlOyAgICAgICAgCiAgICAgICAgdWludDI1NiBfdG9rZW5zUXR5ID0gbXNnLnZhbHVlLm11bChnZXRCb251cyhfd2VpQW1vdW50KSk7CiAgICAgICAgdWludDI1NiBfZGlzdHJpYnV0ZWQgPSBfdG9rZW5zUXR5LmFkZCh0b2tlbnNEaXN0cmlidXRlZCk7CiAgICAgICAgdWludDI1NiBfc29sZCA9IF90b2tlbnNRdHkuYWRkKHRva2Vuc1NvbGQpOwoKICAgICAgICByZXF1aXJlKF9kaXN0cmlidXRlZCA8PSBUT0tFTlNfVE9UQUxfU1VQUExZKTsKICAgICAgICByZXF1aXJlKF9zb2xkIDw9IFRPS0VOU19GT1JfU0FMRSk7CgogICAgICAgIGNvbnRyaWJ1dGlvbnNbX2JlbmVmaWNpYXJ5XSA9IF93ZWlBbW91bnQuYWRkKGNvbnRyaWJ1dGlvbnNbX2JlbmVmaWNpYXJ5XSk7CiAgICAgICAgdG9rZW5CYWxhbmNlc1tfYmVuZWZpY2lhcnldID0gX3Rva2Vuc1F0eS5hZGQodG9rZW5CYWxhbmNlc1tfYmVuZWZpY2lhcnldKTsKICAgICAgICB3ZWlSZWNlaXZlZCA9IHdlaVJlY2VpdmVkLmFkZChfd2VpQW1vdW50KTsKICAgICAgICB0b2tlbnNEaXN0cmlidXRlZCA9IF9kaXN0cmlidXRlZDsKICAgICAgICB0b2tlbnNTb2xkID0gX3NvbGQ7CgogICAgICAgIENvbnRyaWJ1dGUoX2JlbmVmaWNpYXJ5LCBtc2cudmFsdWUpOwoKICAgICAgICBBY2pUb2tlbiBfdG9rZW4gPSBBY2pUb2tlbih0b2tlbik7CiAgICAgICAgX3Rva2VuLmluaXRpYWxUcmFuc2ZlcihfYmVuZWZpY2lhcnksIF90b2tlbnNRdHkpOwogICAgfQoKICAgIC8qCiAgICAgKiBDcm93ZHNhbGUgSGVscGVycyAKICAgICAqLwogICAgZnVuY3Rpb24gaGFzRW5kZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXR1cm4gbm93ID4gZW5kSWNvOwogICAgfQoKICAgIC8qCiAgICAgKiBDaGVja3MgaWYgdGhlIGNyb3dkc2FsZSBpcyBhIHN1Y2Nlc3MKICAgICAqLwogICAgZnVuY3Rpb24gaXNTdWNjZXNzKCkgcHVibGljIHZpZXcgcmV0dXJucyhib29sKSB7CiAgICAgICAgaWYgKHRva2Vuc0Rpc3RyaWJ1dGVkID49IFRPS0VOU19TT0ZUX0NBUCkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qCiAgICAgKiBDaGVja3MgaWYgdGhlIGNyb3dkc2FsZSBmYWlsZWQKICAgICAqLwogICAgZnVuY3Rpb24gaXNGYWlsZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zKGJvb2wpIHsKICAgICAgICBpZiAodG9rZW5zRGlzdHJpYnV0ZWQgPCBUT0tFTlNfU09GVF9DQVAgJiYgbm93ID4gZW5kSWNvKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyogCiAgICAgKiBCb251cyBjYWxjdWxhdGlvbnMKICAgICAqIEVpdGhlciB0aW1lIG9yIEVUSCBxdWFudGl0eSBiYXNlZCAKICAgICAqLwogICAgZnVuY3Rpb24gZ2V0Qm9udXModWludDI1NiBfd2VpKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYgZXRoVG9BY2opIHsKICAgICAgICB1aW50MjU2IF9ib251cyA9IDA7CgogICAgICAgIC8vIFRpbWUgYmFzZWQgYm9udXMKICAgICAgICBpZiAoZW5kUHJlc2FsZSA+IG5vdykgewogICAgICAgICAgICBfYm9udXMgPSBfYm9udXMuYWRkKEJPTlVTX1BSRVNBTEUpOyAKICAgICAgICB9CgogICAgICAgIC8vIEVUSCBRdWFudGl0eSBiYXNlZCBib251cwogICAgICAgIGlmIChfd2VpID49IEJPTlVTX0hJX1FUWSkgeyAKICAgICAgICAgICAgX2JvbnVzID0gX2JvbnVzLmFkZChCT05VU19ISSk7CiAgICAgICAgfSBlbHNlIGlmIChfd2VpID49IEJPTlVTX01JRF9RVFkpIHsKICAgICAgICAgICAgX2JvbnVzID0gX2JvbnVzLmFkZChCT05VU19NSUQpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGV0aFRva2VuUmF0ZS5tdWwoMTAwICsgX2JvbnVzKSAvIDEwMDsKICAgIH0KCn0='.
	

]
