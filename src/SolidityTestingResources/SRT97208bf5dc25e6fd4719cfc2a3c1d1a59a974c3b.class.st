Class {
	#name : #SRT97208bf5dc25e6fd4719cfc2a3c1d1a59a974c3b,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT97208bf5dc25e6fd4719cfc2a3c1d1a59a974c3b >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCi8qKgogKiBAdGl0bGUgRVJDMjBCYXNpYwogKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE3OQogKi8KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQp9CgovKioKICogQHRpdGxlIFN0YW5kYXJkIEVSQzIwIHRva2VuCiAqCiAqIEBkZXYgSW1wbGVtZW50YXRpb24gb2YgdGhlIGJhc2ljIHN0YW5kYXJkIHRva2VuLgogKiBAZGV2IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgRmlyc3RCbG9vZDogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sCiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwoKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICB1aW50MjU2IF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKCiAgICAvLyBDaGVjayBpcyBub3QgbmVlZGVkIGJlY2F1c2Ugc3ViKF9hbGxvd2FuY2UsIF92YWx1ZSkgd2lsbCBhbHJlYWR5IHRocm93IGlmIHRoaXMgY29uZGl0aW9uIGlzIG5vdCBtZXQKICAgIC8vIHJlcXVpcmUgKF92YWx1ZSA8PSBfYWxsb3dhbmNlKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAqCiAgICogQmV3YXJlIHRoYXQgY2hhbmdpbmcgYW4gYWxsb3dhbmNlIHdpdGggdGhpcyBtZXRob2QgYnJpbmdzIHRoZSByaXNrIHRoYXQgc29tZW9uZSBtYXkgdXNlIGJvdGggdGhlIG9sZAogICAqIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZSB0cmFuc2FjdGlvbiBvcmRlcmluZy4gT25lIHBvc3NpYmxlIHNvbHV0aW9uIHRvIG1pdGlnYXRlIHRoaXMKICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KCiAgLyoqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgfSBlbHNlIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQp9CgovKioKICogQHRpdGxlIFN0YW5kYXJkQ3Jvd2RzYWxlIAogKiBAZGV2IFN0YW5kYXJkQ3Jvd2RzYWxlIGlzIGEgYmFzZSBjb250cmFjdCBmb3IgbWFuYWdpbmcgYSB0b2tlbiBjcm93ZHNhbGUuCiAqIENyb3dkc2FsZXMgaGF2ZSBhIHN0YXJ0IGFuZCBlbmQgdGltZXN0YW1wcywgd2hlcmUgaW52ZXN0b3JzIGNhbiBtYWtlCiAqIHRva2VuIHB1cmNoYXNlcyBhbmQgdGhlIGNyb3dkc2FsZSB3aWxsIGFzc2lnbiB0aGVtIHRva2VucyBiYXNlZAogKiBvbiBhIHRva2VuIHBlciBFVEggcmF0ZS4gRnVuZHMgY29sbGVjdGVkIGFyZSBmb3J3YXJkZWQgdG8gYSB3YWxsZXQKICogYXMgdGhleSBhcnJpdmUuCiAqIEBkZXYgZnJvbSBDcm93ZHNhbGUgYnkgWmVwZWxsaW4gd2l0aCBzbWFsbCBjaGFuZ2VzLiBDaGFuZ2VzIGFyZSBjb21tZW50ZWQgd2l0aCAiUmVxdWVzdCBNb2RpZmljYXRpb24iCiAqLwpjb250cmFjdCBTdGFuZGFyZENyb3dkc2FsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICAvLyBUaGUgdG9rZW4gYmVpbmcgc29sZAogICAgU3RhbmRhcmRUb2tlbiBwdWJsaWMgdG9rZW47IC8vIFJlcXVlc3QgTW9kaWZpY2F0aW9uIDogY2hhbmdlIHRvIG5vdCBtaW50YWJsZQoKICAgIC8vIHN0YXJ0IGFuZCBlbmQgdGltZXN0YW1wcyB3aGVyZSBpbnZlc3RtZW50cyBhcmUgYWxsb3dlZCAoYm90aCBpbmNsdXNpdmUpCiAgICB1aW50MjU2IHB1YmxpYyBzdGFydFRpbWU7CiAgICB1aW50MjU2IHB1YmxpYyBlbmRUaW1lOwoKICAgIC8vIGFkZHJlc3Mgd2hlcmUgZnVuZHMgYXJlIGNvbGxlY3RlZAogICAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0OwoKICAgIC8vIGhvdyBtYW55IHRva2VuIHVuaXRzIGEgYnV5ZXIgZ2V0cyBwZXIgd2VpCiAgICB1aW50MjU2IHB1YmxpYyByYXRlOwoKICAgIC8vIGFtb3VudCBvZiByYWlzZWQgbW9uZXkgaW4gd2VpCiAgICB1aW50MjU2IHB1YmxpYyB3ZWlSYWlzZWQ7CgogICAgLyoqCiAgICAgKiBldmVudCBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAgICogQHBhcmFtIHB1cmNoYXNlciB3aG8gcGFpZCBmb3IgdGhlIHRva2VucwogICAgICogQHBhcmFtIHZhbHVlIHdlaXMgcGFpZCBmb3IgcHVyY2hhc2UKICAgICAqIEBwYXJhbSBhbW91bnQgYW1vdW50IG9mIHRva2VucyBwdXJjaGFzZWQKICAgICAqLwogICAgZXZlbnQgVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IGFtb3VudCk7CgogICAgZnVuY3Rpb24gU3RhbmRhcmRDcm93ZHNhbGUoCiAgICAgICAgdWludDI1NiBfc3RhcnRUaW1lLCAKICAgICAgICB1aW50MjU2IF9lbmRUaW1lLCAKICAgICAgICB1aW50MjU2IF9yYXRlLCAKICAgICAgICBhZGRyZXNzIF93YWxsZXQpIAogICAgewogICAgICAgIHJlcXVpcmUoX3N0YXJ0VGltZSA+PSBub3cpOwogICAgICAgIHJlcXVpcmUoX2VuZFRpbWUgPj0gX3N0YXJ0VGltZSk7CiAgICAgICAgcmVxdWlyZShfcmF0ZSA+IDApOwogICAgICAgIHJlcXVpcmUoX3dhbGxldCAhPSAweDApOwoKICAgICAgICBzdGFydFRpbWUgPSBfc3RhcnRUaW1lOwogICAgICAgIGVuZFRpbWUgPSBfZW5kVGltZTsKICAgICAgICByYXRlID0gX3JhdGU7CiAgICAgICAgd2FsbGV0ID0gX3dhbGxldDsKCiAgICAgICAgdG9rZW4gPSBjcmVhdGVUb2tlbkNvbnRyYWN0KCk7IC8vIFJlcXVlc3QgTW9kaWZpY2F0aW9uIDogY2hhbmdlIHRvIFN0YW5kYXJkVG9rZW4gKyBwb3NpdGlvbgogICAgfQoKICAgIC8vIGNyZWF0ZXMgdGhlIHRva2VuIHRvIGJlIHNvbGQuCiAgICAvLyBSZXF1ZXN0IE1vZGlmaWNhdGlvbiA6IGNoYW5nZSB0byBTdGFuZGFyZFRva2VuCiAgICAvLyBvdmVycmlkZSB0aGlzIG1ldGhvZCB0byBoYXZlIGNyb3dkc2FsZSBvZiBhIHNwZWNpZmljIG1pbnRhYmxlIHRva2VuLgogICAgZnVuY3Rpb24gY3JlYXRlVG9rZW5Db250cmFjdCgpIAogICAgICAgIGludGVybmFsIAogICAgICAgIHJldHVybnMoU3RhbmRhcmRUb2tlbikgCiAgICB7CiAgICAgICAgcmV0dXJuIG5ldyBTdGFuZGFyZFRva2VuKCk7CiAgICB9CgogICAgLy8gZmFsbGJhY2sgZnVuY3Rpb24gY2FuIGJlIHVzZWQgdG8gYnV5IHRva2VucwogICAgZnVuY3Rpb24gKCkgCiAgICAgICBwYXlhYmxlIAogICAgewogICAgICAgIGJ1eVRva2VucygpOwogICAgfQoKICAgIC8vIGxvdyBsZXZlbCB0b2tlbiBwdXJjaGFzZSBmdW5jdGlvbgogICAgLy8gUmVxdWVzdCBNb2RpZmljYXRpb24gOiBjaGFuZ2UgdG8gbm90IG1pbnQgYnV0IHRyYW5zZmVyIGZyb20gdGhpcyBjb250cmFjdAogICAgZnVuY3Rpb24gYnV5VG9rZW5zKCkgCiAgICAgICBwdWJsaWMgCiAgICAgICBwYXlhYmxlIAogICAgewogICAgICAgIHJlcXVpcmUodmFsaWRQdXJjaGFzZSgpKTsKCiAgICAgICAgdWludDI1NiB3ZWlBbW91bnQgPSBtc2cudmFsdWU7CgogICAgICAgIC8vIGNhbGN1bGF0ZSB0b2tlbiBhbW91bnQgdG8gYmUgY3JlYXRlZAogICAgICAgIHVpbnQyNTYgdG9rZW5zID0gd2VpQW1vdW50Lm11bChyYXRlKTsKCiAgICAgICAgLy8gdXBkYXRlIHN0YXRlCiAgICAgICAgd2VpUmFpc2VkID0gd2VpUmFpc2VkLmFkZCh3ZWlBbW91bnQpOwoKICAgICAgICByZXF1aXJlKHRva2VuLnRyYW5zZmVyKG1zZy5zZW5kZXIsIHRva2VucykpOyAvLyBSZXF1ZXN0IE1vZGlmaWNhdGlvbiA6IGNoYW5nZWQgaGVyZSAtIHRyYW5mZXIgaW5zdGVhZCBvZiBtaW50YWJsZQogICAgICAgIFRva2VuUHVyY2hhc2UobXNnLnNlbmRlciwgd2VpQW1vdW50LCB0b2tlbnMpOwoKICAgICAgICBmb3J3YXJkRnVuZHMoKTsKICAgIH0KCiAgICAvLyBzZW5kIGV0aGVyIHRvIHRoZSBmdW5kIGNvbGxlY3Rpb24gd2FsbGV0CiAgICAvLyBvdmVycmlkZSB0byBjcmVhdGUgY3VzdG9tIGZ1bmQgZm9yd2FyZGluZyBtZWNoYW5pc21zCiAgICBmdW5jdGlvbiBmb3J3YXJkRnVuZHMoKSAKICAgICAgIGludGVybmFsIAogICAgewogICAgICAgIHdhbGxldC50cmFuc2Zlcihtc2cudmFsdWUpOwogICAgfQoKICAgIC8vIEByZXR1cm4gdHJ1ZSBpZiB0aGUgdHJhbnNhY3Rpb24gY2FuIGJ1eSB0b2tlbnMKICAgIGZ1bmN0aW9uIHZhbGlkUHVyY2hhc2UoKSAKICAgICAgICBpbnRlcm5hbCAKICAgICAgICByZXR1cm5zKGJvb2wpIAogICAgewogICAgICAgIGJvb2wgd2l0aGluUGVyaW9kID0gbm93ID49IHN0YXJ0VGltZSAmJiBub3cgPD0gZW5kVGltZTsKICAgICAgICBib29sIG5vblplcm9QdXJjaGFzZSA9IG1zZy52YWx1ZSAhPSAwOwogICAgICAgIHJldHVybiB3aXRoaW5QZXJpb2QgJiYgbm9uWmVyb1B1cmNoYXNlOwogICAgfQoKICAgIC8vIEByZXR1cm4gdHJ1ZSBpZiBjcm93ZHNhbGUgZXZlbnQgaGFzIGVuZGVkCiAgICBmdW5jdGlvbiBoYXNFbmRlZCgpIAogICAgICAgIHB1YmxpYyAKICAgICAgICBjb25zdGFudCAKICAgICAgICByZXR1cm5zKGJvb2wpIAogICAgewogICAgICAgIHJldHVybiBub3cgPiBlbmRUaW1lOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlCZWZvcmVTYWxlKCkgewogICAgICAgIHJlcXVpcmUobm93IDwgc3RhcnRUaW1lKTsKICAgICAgICBfOwogICAgfQoKICAgIC8vIFJlcXVlc3QgTW9kaWZpY2F0aW9uIDogQWRkIGNoZWNrIDI0aG91cnMgYmVmb3JlIHRva2VuIHNhbGUKICAgIG1vZGlmaWVyIG9ubHkyNEhCZWZvcmVTYWxlKCkgewogICAgICAgIHJlcXVpcmUobm93IDwgc3RhcnRUaW1lLnN1YigxIGRheXMpKTsKICAgICAgICBfOwogICAgfQp9CgovKioKICogQHRpdGxlIENhcHBlZENyb3dkc2FsZQogKiBAZGV2IEV4dGVuc2lvbiBvZiBDcm93ZHNhbGUgd2l0aCBhIG1heCBhbW91bnQgb2YgZnVuZHMgcmFpc2VkCiAqLwpjb250cmFjdCBDYXBwZWRDcm93ZHNhbGUgaXMgU3RhbmRhcmRDcm93ZHNhbGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICB1aW50MjU2IHB1YmxpYyBjYXA7CgogIGZ1bmN0aW9uIENhcHBlZENyb3dkc2FsZSh1aW50MjU2IF9jYXApIHsKICAgIHJlcXVpcmUoX2NhcCA+IDApOwogICAgY2FwID0gX2NhcDsKICB9CgogIC8vIG92ZXJyaWRpbmcgQ3Jvd2RzYWxlI3ZhbGlkUHVyY2hhc2UgdG8gYWRkIGV4dHJhIGNhcCBsb2dpYwogIC8vIEByZXR1cm4gdHJ1ZSBpZiBpbnZlc3RvcnMgY2FuIGJ1eSBhdCB0aGUgbW9tZW50CiAgLy8gUmVxdWVzdCBNb2RpZmljYXRpb24gOiBkZWxldGUgY29uc3RhbnQgYmVjYXVzZSBuZWVkZWQgaW4gc29uIGNvbnRyYWN0CiAgZnVuY3Rpb24gdmFsaWRQdXJjaGFzZSgpIGludGVybmFsIHJldHVybnMgKGJvb2wpIHsKICAgIGJvb2wgd2l0aGluQ2FwID0gd2VpUmFpc2VkLmFkZChtc2cudmFsdWUpIDw9IGNhcDsKICAgIHJldHVybiBzdXBlci52YWxpZFB1cmNoYXNlKCkgJiYgd2l0aGluQ2FwOwogIH0KCiAgLy8gb3ZlcnJpZGluZyBDcm93ZHNhbGUjaGFzRW5kZWQgdG8gYWRkIGNhcCBsb2dpYwogIC8vIEByZXR1cm4gdHJ1ZSBpZiBjcm93ZHNhbGUgZXZlbnQgaGFzIGVuZGVkCiAgZnVuY3Rpb24gaGFzRW5kZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgYm9vbCBjYXBSZWFjaGVkID0gd2VpUmFpc2VkID49IGNhcDsKICAgIHJldHVybiBzdXBlci5oYXNFbmRlZCgpIHx8IGNhcFJlYWNoZWQ7CiAgfQp9CgovKioKICogQHRpdGxlIFByb2dyZXNzaXZlSW5kaXZpZHVhbENhcHBlZENyb3dkc2FsZQogKiBAZGV2IEV4dGVuc2lvbiBvZiBDcm93ZHNhbGUgd2l0aCBhIHByb2dyZXNzaXZlIGluZGl2aWR1YWwgY2FwCiAqIEBkZXYgVGhpcyBjb250cmFjdCBpcyBub3QgbWFkZSBmb3IgY3Jvd2RzYWxlIHN1cGVyaW9yIHRvIDI1NiAqIFRJTUVfUEVSSU9EX0lOX1NFQwogKiBAYXV0aG9yIFJlcXVlc3QubmV0d29yawogKi8KY29udHJhY3QgUHJvZ3Jlc3NpdmVJbmRpdmlkdWFsQ2FwcGVkQ3Jvd2RzYWxlIGlzIFN0YW5kYXJkQ3Jvd2RzYWxlLCBPd25hYmxlIHsKCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBUSU1FX1BFUklPRF9JTl9TRUMgPSAxIGRheXM7CiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBHQVNfTElNSVRfSU5fV0VJID0gNTAwMDAwMDAwMDAgd2VpOyAvLyBsaW1pdCBnYXMgcHJpY2UgLTUwIEd3ZWkgd2FsZXMgc3RvcHBlcgogICAgdWludDI1NiBwdWJsaWMgYmFzZUV0aENhcFBlckFkZHJlc3MgPSAwIGV0aGVyOwoKICAgIG1hcHBpbmcoYWRkcmVzcz0+dWludCkgcHVibGljIHBhcnRpY2lwYXRlZDsKCiAgICAvKioKICAgICAqIEBkZXYgb3ZlcnJpZGluZyBDYXBwZWRDcm93ZHNhbGUjdmFsaWRQdXJjaGFzZSB0byBhZGQgYW4gaW5kaXZpZHVhbCBjYXAKICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBpbnZlc3RvcnMgY2FuIGJ1eSBhdCB0aGUgbW9tZW50CiAgICAgKi8KICAgIGZ1bmN0aW9uIHZhbGlkUHVyY2hhc2UoKSAKICAgICAgICBpbnRlcm5hbCAKICAgICAgICByZXR1cm5zKGJvb2wpCiAgICB7CiAgICAgICAgcmVxdWlyZSh0eC5nYXNwcmljZSA8PSBHQVNfTElNSVRfSU5fV0VJKTsKICAgICAgICB1aW50IGV0aENhcFBlckFkZHJlc3MgPSBnZXRDdXJyZW50RXRoQ2FwUGVyQWRkcmVzcygpOwogICAgICAgIHBhcnRpY2lwYXRlZFttc2cuc2VuZGVyXSA9IHBhcnRpY2lwYXRlZFttc2cuc2VuZGVyXS5hZGQobXNnLnZhbHVlKTsKICAgICAgICByZXR1cm4gc3VwZXIudmFsaWRQdXJjaGFzZSgpICYmIHBhcnRpY2lwYXRlZFttc2cuc2VuZGVyXSA8PSBldGhDYXBQZXJBZGRyZXNzOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBTZXQgdGhlIGluZGl2aWR1YWwgY2FwIGZvciB0aGUgZmlyc3QgZGF5LiBUaGlzIGZ1bmN0aW9uIGNhbiBub3QgYmUgY2FsbGVkIHdpdGhpbmcgdGhlIDI0aCBiZWZvcmUgdGhlIHNhbGUgZm9yIHNlY3VyaXR5IHJlYXNvbnMKICAgICAqIEBwYXJhbSBfYmFzZUV0aENhcFBlckFkZHJlc3MgYmFzZSBjYXAgaW4gd2VpCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldEJhc2VFdGhDYXBQZXJBZGRyZXNzKHVpbnQyNTYgX2Jhc2VFdGhDYXBQZXJBZGRyZXNzKSAKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5T3duZXIgCiAgICAgICAgb25seTI0SEJlZm9yZVNhbGUKICAgIHsKICAgICAgICBiYXNlRXRoQ2FwUGVyQWRkcmVzcyA9IF9iYXNlRXRoQ2FwUGVyQWRkcmVzczsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgR2V0IHRoZSBjdXJyZW50IGluZGl2aWR1YWwgY2FwLiAKICAgICAqIEBkZXYgVGhpcyBhbW91bnQgaW5jcmVhc2UgZXZlcnlkYXkgaW4gYW4gZXhwb25lbnRpYWwgd2F5LiBEYXkgMTogYmFzZSBjYXAsIERheSAyOiAyICogYmFzZSBjYXAsIERheSAzOiA0ICogYmFzZSBjYXAgLi4uCiAgICAgKiBAcmV0dXJuIGluZGl2aWR1YWwgY2FwIGluIHdlaQogICAgICovCiAgICBmdW5jdGlvbiBnZXRDdXJyZW50RXRoQ2FwUGVyQWRkcmVzcygpIAogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyh1aW50KQogICAgewogICAgICAgIGlmIChibG9jay50aW1lc3RhbXAgPCBzdGFydFRpbWUpIHJldHVybiAwOwogICAgICAgIHVpbnQgdGltZVNpbmNlU3RhcnRJblNlYyA9IGJsb2NrLnRpbWVzdGFtcC5zdWIoc3RhcnRUaW1lKTsKICAgICAgICB1aW50IGN1cnJlbnRQZXJpb2QgPSB0aW1lU2luY2VTdGFydEluU2VjLmRpdihUSU1FX1BFUklPRF9JTl9TRUMpLmFkZCgxKTsKCiAgICAgICAgLy8gZm9yIGN1cnJlbnRQZXJpb2QgPiAyNTYgd2lsbCBhbHdheXMgcmV0dXJuIGJhc2VFdGhDYXBQZXJBZGRyZXNzCiAgICAgICAgcmV0dXJuICgyICoqIGN1cnJlbnRQZXJpb2Quc3ViKDEpKS5tdWwoYmFzZUV0aENhcFBlckFkZHJlc3MpOwogICAgfQp9CgovKioKICogQHRpdGxlIFdoaXRlbGlzdGVkQ3Jvd2RzYWxlCiAqIEBkZXYgVGhpcyBpcyBhbiBleHRlbnNpb24gdG8gYWRkIHdoaXRlbGlzdCB0byBhIGNyb3dkc2FsZQogKiBAYXV0aG9yIFJlcXVlc3QubmV0d29yawogKgogKi8KY29udHJhY3QgV2hpdGVsaXN0ZWRDcm93ZHNhbGUgaXMgU3RhbmRhcmRDcm93ZHNhbGUsIE93bmFibGUgewogICAgCiAgICBtYXBwaW5nKGFkZHJlc3M9PmJvb2wpIHB1YmxpYyByZWdpc3RlcmVkOwoKICAgIGV2ZW50IFJlZ2lzdHJhdGlvblN0YXR1c0NoYW5nZWQoYWRkcmVzcyB0YXJnZXQsIGJvb2wgaXNSZWdpc3RlcmVkKTsKCiAgICAvKioKICAgICAqIEBkZXYgQ2hhbmdlcyByZWdpc3RyYXRpb24gc3RhdHVzIG9mIGFuIGFkZHJlc3MgZm9yIHBhcnRpY2lwYXRpb24uCiAgICAgKiBAcGFyYW0gdGFyZ2V0IEFkZHJlc3MgdGhhdCB3aWxsIGJlIHJlZ2lzdGVyZWQvZGVyZWdpc3RlcmVkLgogICAgICogQHBhcmFtIGlzUmVnaXN0ZXJlZCBOZXcgcmVnaXN0cmF0aW9uIHN0YXR1cyBvZiBhZGRyZXNzLgogICAgICovCiAgICBmdW5jdGlvbiBjaGFuZ2VSZWdpc3RyYXRpb25TdGF0dXMoYWRkcmVzcyB0YXJnZXQsIGJvb2wgaXNSZWdpc3RlcmVkKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlPd25lcgogICAgICAgIG9ubHkyNEhCZWZvcmVTYWxlCiAgICB7CiAgICAgICAgcmVnaXN0ZXJlZFt0YXJnZXRdID0gaXNSZWdpc3RlcmVkOwogICAgICAgIFJlZ2lzdHJhdGlvblN0YXR1c0NoYW5nZWQodGFyZ2V0LCBpc1JlZ2lzdGVyZWQpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBDaGFuZ2VzIHJlZ2lzdHJhdGlvbiBzdGF0dXNlcyBvZiBhZGRyZXNzZXMgZm9yIHBhcnRpY2lwYXRpb24uCiAgICAgKiBAcGFyYW0gdGFyZ2V0cyBBZGRyZXNzZXMgdGhhdCB3aWxsIGJlIHJlZ2lzdGVyZWQvZGVyZWdpc3RlcmVkLgogICAgICogQHBhcmFtIGlzUmVnaXN0ZXJlZCBOZXcgcmVnaXN0cmF0aW9uIHN0YXR1cyBvZiBhZGRyZXNzZXMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGNoYW5nZVJlZ2lzdHJhdGlvblN0YXR1c2VzKGFkZHJlc3NbXSB0YXJnZXRzLCBib29sIGlzUmVnaXN0ZXJlZCkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5T3duZXIKICAgICAgICBvbmx5MjRIQmVmb3JlU2FsZQogICAgewogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IHRhcmdldHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgY2hhbmdlUmVnaXN0cmF0aW9uU3RhdHVzKHRhcmdldHNbaV0sIGlzUmVnaXN0ZXJlZCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQGRldiBvdmVycmlkaW5nIENyb3dkc2FsZSN2YWxpZFB1cmNoYXNlIHRvIGFkZCB3aGlsZWxpc3QKICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBpbnZlc3RvcnMgY2FuIGJ1eSBhdCB0aGUgbW9tZW50LCBmYWxzZSBvdGhlcndpc2UKICAgICAqLwogICAgZnVuY3Rpb24gdmFsaWRQdXJjaGFzZSgpIGludGVybmFsIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIudmFsaWRQdXJjaGFzZSgpICYmIHJlZ2lzdGVyZWRbbXNnLnNlbmRlcl07CiAgICB9Cn0KCi8qKgogKiBAdGl0bGUgVGhlIFJlcXVlc3RUb2tlbiBjb250cmFjdAogKiBAZGV2IFRoZSBSZXF1ZXN0IFRva2VuIGNvbnRyYWN0CiAqIEBkZXYgaW5oZXJpdGUgZnJvbSBTdGFuZGFyZFRva2VuIGFuZCBPd25hYmxlIGJ5IFplcHBlbGluCiAqIEBhdXRob3IgUmVxdWVzdC5uZXR3b3JrCiAqLwpjb250cmFjdCBSZXF1ZXN0VG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZSB7CiAgICBzdHJpbmcgIHB1YmxpYyAgY29uc3RhbnQgbmFtZSA9ICJSZXF1ZXN0IFRva2VuIjsKICAgIHN0cmluZyAgcHVibGljICBjb25zdGFudCBzeW1ib2wgPSAiUkVRIjsKICAgIHVpbnQ4ICAgIHB1YmxpYyAgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKCiAgICB1aW50ICAgIHB1YmxpYyAgdHJhbnNmZXJhYmxlU3RhcnRUaW1lOwoKICAgIGFkZHJlc3MgcHVibGljICB0b2tlblNhbGVDb250cmFjdDsKICAgIGFkZHJlc3MgcHVibGljICBlYXJseUludmVzdG9yV2FsbGV0OwoKCiAgICBtb2RpZmllciBvbmx5V2hlblRyYW5zZmVyRW5hYmxlZCgpIAogICAgewogICAgICAgIGlmICggbm93IDw9IHRyYW5zZmVyYWJsZVN0YXJ0VGltZSApIHsKICAgICAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHRva2VuU2FsZUNvbnRyYWN0IHx8IG1zZy5zZW5kZXIgPT0gZWFybHlJbnZlc3RvcldhbGxldCB8fCBtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICB9CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciB2YWxpZERlc3RpbmF0aW9uKGFkZHJlc3MgdG8pIAogICAgewogICAgICAgIHJlcXVpcmUodG8gIT0gYWRkcmVzcyh0aGlzKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBSZXF1ZXN0VG9rZW4oCiAgICAgICAgdWludCB0b2tlblRvdGFsQW1vdW50LCAKICAgICAgICB1aW50IF90cmFuc2ZlcmFibGVTdGFydFRpbWUsIAogICAgICAgIGFkZHJlc3MgX2FkbWluLCAKICAgICAgICBhZGRyZXNzIF9lYXJseUludmVzdG9yV2FsbGV0KSAKICAgIHsKICAgICAgICAvLyBNaW50IGFsbCB0b2tlbnMuIFRoZW4gZGlzYWJsZSBtaW50aW5nIGZvcmV2ZXIuCiAgICAgICAgdG90YWxTdXBwbHkgPSB0b2tlblRvdGFsQW1vdW50ICogKDEwICoqIHVpbnQyNTYoZGVjaW1hbHMpKTsKCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSB0b3RhbFN1cHBseTsKICAgICAgICBUcmFuc2ZlcihhZGRyZXNzKDB4MCksIG1zZy5zZW5kZXIsIHRvdGFsU3VwcGx5KTsKCiAgICAgICAgdHJhbnNmZXJhYmxlU3RhcnRUaW1lID0gX3RyYW5zZmVyYWJsZVN0YXJ0VGltZTsKICAgICAgICB0b2tlblNhbGVDb250cmFjdCA9IG1zZy5zZW5kZXI7CiAgICAgICAgZWFybHlJbnZlc3RvcldhbGxldCA9IF9lYXJseUludmVzdG9yV2FsbGV0OwoKICAgICAgICB0cmFuc2Zlck93bmVyc2hpcChfYWRtaW4pOyAvLyBhZG1pbiBjb3VsZCBkcmFpbiB0b2tlbnMgYW5kIGV0aCB0aGF0IHdlcmUgc2VudCBoZXJlIGJ5IG1pc3Rha2UKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgb3ZlcnJpZGUgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MgdG8gYWRkIG9ubHlXaGVuVHJhbnNmZXJFbmFibGVkIGFuZCB2YWxpZERlc3RpbmF0aW9uCiAgICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpCiAgICAgICAgcHVibGljCiAgICAgICAgdmFsaWREZXN0aW5hdGlvbihfdG8pCiAgICAgICAgb25seVdoZW5UcmFuc2ZlckVuYWJsZWQKICAgICAgICByZXR1cm5zIChib29sKSAKICAgIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBvdmVycmlkZSB0cmFuc2ZlckZyb20gdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MgdG8gYWRkIG9ubHlXaGVuVHJhbnNmZXJFbmFibGVkIGFuZCB2YWxpZERlc3RpbmF0aW9uCiAgICAgKiBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgZnJvbS4KICAgICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpCiAgICAgICAgcHVibGljCiAgICAgICAgdmFsaWREZXN0aW5hdGlvbihfdG8pCiAgICAgICAgb25seVdoZW5UcmFuc2ZlckVuYWJsZWQKICAgICAgICByZXR1cm5zIChib29sKSAKICAgIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgX2J1cm5lciwgdWludCBfdmFsdWUpOwoKICAgIC8qKgogICAgICogQGRldiBidXJuIHRva2VucwogICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIGJ1cm5lZC4KICAgICAqIEByZXR1cm4gYWx3YXlzIHRydWUgKG5lY2Vzc2FyeSBpbiBjYXNlIG9mIG92ZXJyaWRlKQogICAgICovCiAgICBmdW5jdGlvbiBidXJuKHVpbnQgX3ZhbHVlKSAKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5V2hlblRyYW5zZmVyRW5hYmxlZAogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LnN1YihfdmFsdWUpOwogICAgICAgIEJ1cm4obXNnLnNlbmRlciwgX3ZhbHVlKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBhZGRyZXNzKDB4MCksIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGJ1cm4gdG9rZW5zIGluIHRoZSBiZWhhbGYgb2Ygc29tZW9uZQogICAgICogQHBhcmFtIF9mcm9tIFRoZSBhZGRyZXNzIG9mIHRoZSBvd25lciBvZiB0aGUgdG9rZW4uCiAgICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgYnVybmVkLgogICAgICogQHJldHVybiBhbHdheXMgdHJ1ZSAobmVjZXNzYXJ5IGluIGNhc2Ugb2Ygb3ZlcnJpZGUpCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJ1cm5Gcm9tKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlKSAKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5V2hlblRyYW5zZmVyRW5hYmxlZAogICAgICAgIHJldHVybnMoYm9vbCkgCiAgICB7CiAgICAgICAgYXNzZXJ0KHRyYW5zZmVyRnJvbShfZnJvbSwgbXNnLnNlbmRlciwgX3ZhbHVlKSk7CiAgICAgICAgcmV0dXJuIGJ1cm4oX3ZhbHVlKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgdHJhbnNmZXIgdG8gb3duZXIgYW55IHRva2VucyBzZW5kIGJ5IG1pc3Rha2Ugb24gdGhpcyBjb250cmFjdHMKICAgICAqIEBwYXJhbSB0b2tlbiBUaGUgYWRkcmVzcyBvZiB0aGUgdG9rZW4gdG8gdHJhbnNmZXIuCiAgICAgKiBAcGFyYW0gYW1vdW50IFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJlZC4KICAgICAqLwogICAgZnVuY3Rpb24gZW1lcmdlbmN5RVJDMjBEcmFpbihFUkMyMCB0b2tlbiwgdWludCBhbW91bnQgKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlPd25lciAKICAgIHsKICAgICAgICB0b2tlbi50cmFuc2Zlcihvd25lciwgYW1vdW50KTsKICAgIH0KfQoKLyoqCiAqIEB0aXRsZSBSZXF1ZXN0VG9rZW5TYWxlCiAqIEBkZXYgCiAqIFdlIGFkZCBuZXcgZmVhdHVyZXMgdG8gYSBiYXNlIGNyb3dkc2FsZSB1c2luZyBtdWx0aXBsZSBpbmhlcml0YW5jZS4KICogV2UgYXJlIHVzaW5nIHRoZSBmb2xsb3dpbmcgZXh0ZW5zaW9uczoKICogQ2FwcGVkQ3Jvd2RzYWxlIC0gc2V0cyBhIG1heCBib3VuZGFyeSBmb3IgcmFpc2VkIGZ1bmRzCiAqIFdoaXRlbGlzdGVkQ3Jvd2RzYWxlIC0gYWRkIGEgd2hpdGVsaXN0CiAqIFByb2dyZXNzaXZlSW5kaXZpZHVhbENhcHBlZENyb3dkc2FsZSAtIGFkZCBhIFByb2dyZXNzaXZlIGluZGl2aWR1YWwgY2FwCiAqCiAqIFRoZSBjb2RlIGlzIGJhc2VkIG9uIHRoZSBjb250cmFjdHMgb2YgT3BlbiBaZXBwZWxpbiBhbmQgd2UgYWRkIG91ciBjb250cmFjdHMgOiBSZXF1ZXN0VG9rZW5TYWxlLCBXaGl0ZUxpc3RlZENyb3dkc2FsZSwgUHJvZ3Jlc3NpdmVJbmRpdmlkdWFsQ2FwcGVkQ3Jvd2RzYWxlIGFuZCB0aGUgUmVxdWVzdCBUb2tlbgogKgogKiBAYXV0aG9yIFJlcXVlc3QubmV0d29yawogKi8KY29udHJhY3QgUmVxdWVzdFRva2VuU2FsZSBpcyBPd25hYmxlLCBDYXBwZWRDcm93ZHNhbGUsIFdoaXRlbGlzdGVkQ3Jvd2RzYWxlLCBQcm9ncmVzc2l2ZUluZGl2aWR1YWxDYXBwZWRDcm93ZHNhbGUgewogICAgLy8gaGFyZCBjYXAgb2YgdGhlIHRva2VuIHNhbGUgaW4gZXRoZXIKICAgIHVpbnQgcHJpdmF0ZSBjb25zdGFudCBIQVJEX0NBUF9JTl9XRUkgPSAxMDAwMDAgZXRoZXI7CgogICAgLy8gVG90YWwgb2YgUmVxdWVzdCBUb2tlbiBzdXBwbHkKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFRPVEFMX1JFUVVFU1RfVE9LRU5fU1VQUExZID0gMTAwMDAwMDAwMDsKCiAgICAvLyBUb2tlbiBzYWxlIHJhdGUgZnJvbSBFVEggdG8gUkVRCiAgICB1aW50IHByaXZhdGUgY29uc3RhbnQgUkFURV9FVEhfUkVRID0gNTAwMDsKCiAgICAvLyBUb2tlbiBpbml0aWFseSBkaXN0cmlidXRlZCBmb3IgdGhlIHRlYW0gKDE1JSkKICAgIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IFRFQU1fVkVTVElOR19XQUxMRVQgPSAweEE3NmJDMzlhRTRCODhlZjIwM0M2QWZlM2ZEMjE5NTQ5ZDg2RDEyZjI7CiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBURUFNX1ZFU1RJTkdfQU1PVU5UID0gMTUwMDAwMDAwZTE4OwoKICAgIC8vIFRva2VuIGluaXRpYWx5IGRpc3RyaWJ1dGVkIGZvciB0aGUgZWFybHkgaW52ZXN0b3IgKDIwJSkKICAgIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IEVBUkxZX0lOVkVTVE9SX1dBTExFVCA9IDB4YTU3OUUzMWI5MzA3OTZlM0RmNTBBNTY4MjljRjgyRGI5OGI2RjRCMzsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IEVBUkxZX0lOVkVTVE9SX0FNT1VOVCA9IDIwMDAwMDAwMGUxODsKCiAgICAvLyBUb2tlbiBpbml0aWFseSBkaXN0cmlidXRlZCBmb3IgdGhlIGVhcmx5IGZvdW5kYXRpb24gKDE1JSkKICAgIC8vIHdhbGxldCB1c2UgYWxzbyB0byBnYXRoZXIgdGhlIGV0aGVyIG9mIHRoZSB0b2tlbiBzYWxlCiAgICBhZGRyZXNzIHByaXZhdGUgY29uc3RhbnQgUkVRVUVTVF9GT1VOREFUSU9OX1dBTExFVCA9IDB4ZEQ3NkI1NWVlNmRBZmUwYzdjOTc4YmZmNjkyMDZkNDc2YTViOUNlNzsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFJFUVVFU1RfRk9VTkRBVElPTl9BTU9VTlQgPSAxNTAwMDAwMDBlMTg7CgogICAgLy8gUEVSSU9EIFdIRU4gVE9LRU4gSVMgTk9UIFRSQU5TRkVSQUJMRSBBRlRFUiBUSEUgU0FMRQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgUEVSSU9EX0FGVEVSU0FMRV9OT1RfVFJBTlNGRVJBQkxFX0lOX1NFQyA9IDMgZGF5czsKCiAgICBmdW5jdGlvbiBSZXF1ZXN0VG9rZW5TYWxlKHVpbnQyNTYgX3N0YXJ0VGltZSwgdWludDI1NiBfZW5kVGltZSkKICAgICAgUHJvZ3Jlc3NpdmVJbmRpdmlkdWFsQ2FwcGVkQ3Jvd2RzYWxlKCkKICAgICAgV2hpdGVsaXN0ZWRDcm93ZHNhbGUoKQogICAgICBDYXBwZWRDcm93ZHNhbGUoSEFSRF9DQVBfSU5fV0VJKQogICAgICBTdGFuZGFyZENyb3dkc2FsZShfc3RhcnRUaW1lLCBfZW5kVGltZSwgUkFURV9FVEhfUkVRLCBSRVFVRVNUX0ZPVU5EQVRJT05fV0FMTEVUKQogICAgewogICAgICAgIHRva2VuLnRyYW5zZmVyKFRFQU1fVkVTVElOR19XQUxMRVQsIFRFQU1fVkVTVElOR19BTU9VTlQpOwoKICAgICAgICB0b2tlbi50cmFuc2ZlcihFQVJMWV9JTlZFU1RPUl9XQUxMRVQsIEVBUkxZX0lOVkVTVE9SX0FNT1VOVCk7CgogICAgICAgIHRva2VuLnRyYW5zZmVyKFJFUVVFU1RfRk9VTkRBVElPTl9XQUxMRVQsIFJFUVVFU1RfRk9VTkRBVElPTl9BTU9VTlQpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBDcmVhdGUgdGhlIFJlcXVlc3QgdG9rZW4gKG92ZXJyaWRlIGNyZWF0ZVRva2VuQ29udHJhY3Qgb2YgU3RhbmRhcmRDcm93ZHNhbGUpCiAgICAgKiBAcmV0dXJuIHRoZSBTdGFuZGFyZFRva2VuIGNyZWF0ZWQKICAgICAqLwogICAgZnVuY3Rpb24gY3JlYXRlVG9rZW5Db250cmFjdCAoKSAKICAgICAgaW50ZXJuYWwgCiAgICAgIHJldHVybnMoU3RhbmRhcmRUb2tlbikgCiAgICB7CiAgICAgICAgcmV0dXJuIG5ldyBSZXF1ZXN0VG9rZW4oVE9UQUxfUkVRVUVTVF9UT0tFTl9TVVBQTFksIGVuZFRpbWUuYWRkKFBFUklPRF9BRlRFUlNBTEVfTk9UX1RSQU5TRkVSQUJMRV9JTl9TRUMpLCBSRVFVRVNUX0ZPVU5EQVRJT05fV0FMTEVULCBFQVJMWV9JTlZFU1RPUl9XQUxMRVQpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBUcmFuc2ZlciB0aGUgdW5zb2xkIHRva2VucyB0byB0aGUgcmVxdWVzdCBGb3VuZGF0aW9uIG11bHRpc2lnbiB3YWxsZXQgCiAgICAgKiBAZGV2IE9ubHkgZm9yIG93bmVyCiAgICAgKiBAcmV0dXJuIHRoZSBTdGFuZGFyZFRva2VuIGNyZWF0ZWQKICAgICAqLwogICAgZnVuY3Rpb24gZHJhaW5SZW1haW5pbmdUb2tlbiAoKSAKICAgICAgcHVibGljCiAgICAgIG9ubHlPd25lcgogICAgewogICAgICAgIHJlcXVpcmUoaGFzRW5kZWQoKSk7CiAgICAgICAgdG9rZW4udHJhbnNmZXIoUkVRVUVTVF9GT1VOREFUSU9OX1dBTExFVCwgdG9rZW4uYmFsYW5jZU9mKHRoaXMpKTsKICAgIH0KICAKfQ=='.
	

]
