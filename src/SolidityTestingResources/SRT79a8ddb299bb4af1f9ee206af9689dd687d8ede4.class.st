Class {
	#name : #SRT79a8ddb299bb4af1f9ee206af9689dd687d8ede4,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT79a8ddb299bb4af1f9ee206af9689dd687d8ede4 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7Cgpjb250cmFjdCBEU01hdGggewogICAgZnVuY3Rpb24gYWRkKHVpbnQgeCwgdWludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHJlcXVpcmUoKHogPSB4ICsgeSkgPj0geCk7CiAgICB9CiAgICBmdW5jdGlvbiBzdWIodWludCB4LCB1aW50IHkpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCB6KSB7CiAgICAgICAgcmVxdWlyZSgoeiA9IHggLSB5KSA8PSB4KTsKICAgIH0KICAgIGZ1bmN0aW9uIG11bCh1aW50IHgsIHVpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICByZXF1aXJlKHkgPT0gMCB8fCAoeiA9IHggKiB5KSAvIHkgPT0geCk7CiAgICB9CgogICAgZnVuY3Rpb24gbWluKHVpbnQgeCwgdWludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHJldHVybiB4IDw9IHkgPyB4IDogeTsKICAgIH0KICAgIGZ1bmN0aW9uIG1heCh1aW50IHgsIHVpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICByZXR1cm4geCA+PSB5ID8geCA6IHk7CiAgICB9CiAgICBmdW5jdGlvbiBpbWluKGludCB4LCBpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChpbnQgeikgewogICAgICAgIHJldHVybiB4IDw9IHkgPyB4IDogeTsKICAgIH0KICAgIGZ1bmN0aW9uIGltYXgoaW50IHgsIGludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKGludCB6KSB7CiAgICAgICAgcmV0dXJuIHggPj0geSA/IHggOiB5OwogICAgfQoKICAgIHVpbnQgY29uc3RhbnQgV0FEID0gMTAgKiogMTg7CiAgICB1aW50IGNvbnN0YW50IFJBWSA9IDEwICoqIDI3OwoKICAgIGZ1bmN0aW9uIHdtdWwodWludCB4LCB1aW50IHkpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCB6KSB7CiAgICAgICAgeiA9IGFkZChtdWwoeCwgeSksIFdBRCAvIDIpIC8gV0FEOwogICAgfQogICAgZnVuY3Rpb24gcm11bCh1aW50IHgsIHVpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICB6ID0gYWRkKG11bCh4LCB5KSwgUkFZIC8gMikgLyBSQVk7CiAgICB9CiAgICBmdW5jdGlvbiB3ZGl2KHVpbnQgeCwgdWludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHogPSBhZGQobXVsKHgsIFdBRCksIHkgLyAyKSAvIHk7CiAgICB9CiAgICBmdW5jdGlvbiByZGl2KHVpbnQgeCwgdWludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHogPSBhZGQobXVsKHgsIFJBWSksIHkgLyAyKSAvIHk7CiAgICB9CgogICAgLy8gVGhpcyBmYW1vdXMgYWxnb3JpdGhtIGlzIGNhbGxlZCAiZXhwb25lbnRpYXRpb24gYnkgc3F1YXJpbmciCiAgICAvLyBhbmQgY2FsY3VsYXRlcyB4Xm4gd2l0aCB4IGFzIGZpeGVkLXBvaW50IGFuZCBuIGFzIHJlZ3VsYXIgdW5zaWduZWQuCiAgICAvLwogICAgLy8gSXQncyBPKGxvZyBuKSwgaW5zdGVhZCBvZiBPKG4pIGZvciBuYWl2ZSByZXBlYXRlZCBtdWx0aXBsaWNhdGlvbi4KICAgIC8vCiAgICAvLyBUaGVzZSBmYWN0cyBhcmUgd2h5IGl0IHdvcmtzOgogICAgLy8KICAgIC8vICBJZiBuIGlzIGV2ZW4sIHRoZW4geF5uID0gKHheMileKG4vMikuCiAgICAvLyAgSWYgbiBpcyBvZGQsICB0aGVuIHhebiA9IHggKiB4XihuLTEpLAogICAgLy8gICBhbmQgYXBwbHlpbmcgdGhlIGVxdWF0aW9uIGZvciBldmVuIHggZ2l2ZXMKICAgIC8vICAgIHhebiA9IHggKiAoeF4yKV4oKG4tMSkgLyAyKS4KICAgIC8vCiAgICAvLyAgQWxzbywgRVZNIGRpdmlzaW9uIGlzIGZsb29yaW5nIGFuZAogICAgLy8gICAgZmxvb3JbKG4tMSkgLyAyXSA9IGZsb29yW24gLyAyXS4KICAgIC8vCiAgICBmdW5jdGlvbiBycG93KHVpbnQgeCwgdWludCBuKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHogPSBuICUgMiAhPSAwID8geCA6IFJBWTsKCiAgICAgICAgZm9yIChuIC89IDI7IG4gIT0gMDsgbiAvPSAyKSB7CiAgICAgICAgICAgIHggPSBybXVsKHgsIHgpOwoKICAgICAgICAgICAgaWYgKG4gJSAyICE9IDApIHsKICAgICAgICAgICAgICAgIHogPSBybXVsKHosIHgpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9Cgpjb250cmFjdCBEQkMgewoKICAgIC8vIE1PRElGSUVSUwoKICAgIG1vZGlmaWVyIHByZV9jb25kKGJvb2wgY29uZGl0aW9uKSB7CiAgICAgICAgcmVxdWlyZShjb25kaXRpb24pOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgcG9zdF9jb25kKGJvb2wgY29uZGl0aW9uKSB7CiAgICAgICAgXzsKICAgICAgICBhc3NlcnQoY29uZGl0aW9uKTsKICAgIH0KCiAgICBtb2RpZmllciBpbnZhcmlhbnQoYm9vbCBjb25kaXRpb24pIHsKICAgICAgICByZXF1aXJlKGNvbmRpdGlvbik7CiAgICAgICAgXzsKICAgICAgICBhc3NlcnQoY29uZGl0aW9uKTsKICAgIH0KfQoKY29udHJhY3QgT3duZWQgaXMgREJDIHsKCiAgICAvLyBGSUVMRFMKCiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgICAvLyBOT04tQ09OU1RBTlQgTUVUSE9EUwoKICAgIGZ1bmN0aW9uIE93bmVkKCkgeyBvd25lciA9IG1zZy5zZW5kZXI7IH0KCiAgICBmdW5jdGlvbiBjaGFuZ2VPd25lcihhZGRyZXNzIG9mTmV3T3duZXIpIHByZV9jb25kKGlzT3duZXIoKSkgeyBvd25lciA9IG9mTmV3T3duZXI7IH0KCiAgICAvLyBQUkUsIFBPU1QsIElOVkFSSUFOVCBDT05ESVRJT05TCgogICAgZnVuY3Rpb24gaXNPd25lcigpIGludGVybmFsIHJldHVybnMgKGJvb2wpIHsgcmV0dXJuIG1zZy5zZW5kZXIgPT0gb3duZXI7IH0KCn0KCmNvbnRyYWN0IEFzc2V0UmVnaXN0cmFyIGlzIERCQywgT3duZWQgewoKICAgIC8vIFRZUEVTCgogICAgc3RydWN0IEFzc2V0IHsKICAgICAgICBhZGRyZXNzIGJyZWFrSW47IC8vIEJyZWFrIGluIGNvbnRyYWN0IG9uIGRlc3RpbmF0aW9uIGNoYWluCiAgICAgICAgYWRkcmVzcyBicmVha091dDsgLy8gQnJlYWsgb3V0IGNvbnRyYWN0IG9uIHRoaXMgY2hhaW47IEEgd2F5IHRvIGxlYXZlCiAgICAgICAgYnl0ZXMzMiBjaGFpbklkOyAvLyBPbiB3aGljaCBjaGFpbiB0aGlzIGFzc2V0IHJlc2lkZXMKICAgICAgICB1aW50IGRlY2ltYWw7IC8vIERlY2ltYWwsIG9yZGVyIG9mIG1hZ25pdHVkZSBvZiBwcmVjaXNpb24sIG9mIHRoZSBBc3NldCBhcyBpbiBFUkMyMjMgdG9rZW4gc3RhbmRhcmQKICAgICAgICBib29sIGV4aXN0czsgLy8gSXMgdGhpcyBhc3NldCByZWdpc3RlcmVkCiAgICAgICAgc3RyaW5nIGlwZnNIYXNoOyAvLyBTYW1lIGFzIHVybCBidXQgZm9yIGlwZnMKICAgICAgICBzdHJpbmcgbmFtZTsgLy8gSHVtYW4tcmVhZGFibGUgbmFtZSBvZiB0aGUgQXNzZXQgYXMgaW4gRVJDMjIzIHRva2VuIHN0YW5kYXJkCiAgICAgICAgdWludCBwcmljZTsgLy8gUHJpY2Ugb2YgYXNzZXQgcXVvdGVkIGFnYWluc3QgYFFVT1RFX0FTU0VUYCAqIDEwICoqIGRlY2ltYWxzCiAgICAgICAgc3RyaW5nIHN5bWJvbDsgLy8gSHVtYW4tcmVhZGFibGUgc3ltYm9sIG9mIHRoZSBBc3NldCBhcyBpbiBFUkMyMjMgdG9rZW4gc3RhbmRhcmQKICAgICAgICB1aW50IHRpbWVzdGFtcDsgLy8gVGltZXN0YW1wIG9mIGxhc3QgcHJpY2UgdXBkYXRlIG9mIHRoaXMgYXNzZXQKICAgICAgICBzdHJpbmcgdXJsOyAvLyBVUkwgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gb2YgQXNzZXQKICAgIH0KCiAgICAvLyBGSUVMRFMKCiAgICAvLyBNZXRob2RzIGZpZWxkcwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBBc3NldCkgcHVibGljIGluZm9ybWF0aW9uOwoKICAgIC8vIE1FVEhPRFMKCiAgICAvLyBQVUJMSUMgTUVUSE9EUwoKICAgIC8vLyBAbm90aWNlIFJlZ2lzdGVycyBhbiBBc3NldCByZXNpZGluZyBpbiBhIGNoYWluCiAgICAvLy8gQGRldiBQcmU6IE9ubHkgcmVnaXN0cmFyIG93bmVyIHNob3VsZCBiZSBhYmxlIHRvIHJlZ2lzdGVyCiAgICAvLy8gQGRldiBQb3N0OiBBZGRyZXNzIG9mQXNzZXQgaXMgcmVnaXN0ZXJlZAogICAgLy8vIEBwYXJhbSBvZkFzc2V0IEFkZHJlc3Mgb2YgYXNzZXQgdG8gYmUgcmVnaXN0ZXJlZAogICAgLy8vIEBwYXJhbSBuYW1lIEh1bWFuLXJlYWRhYmxlIG5hbWUgb2YgdGhlIEFzc2V0IGFzIGluIEVSQzIyMyB0b2tlbiBzdGFuZGFyZAogICAgLy8vIEBwYXJhbSBzeW1ib2wgSHVtYW4tcmVhZGFibGUgc3ltYm9sIG9mIHRoZSBBc3NldCBhcyBpbiBFUkMyMjMgdG9rZW4gc3RhbmRhcmQKICAgIC8vLyBAcGFyYW0gZGVjaW1hbCBIdW1hbi1yZWFkYWJsZSBzeW1ib2wgb2YgdGhlIEFzc2V0IGFzIGluIEVSQzIyMyB0b2tlbiBzdGFuZGFyZAogICAgLy8vIEBwYXJhbSB1cmwgVXJsIGZvciBleHRlbmRlZCBpbmZvcm1hdGlvbiBvZiB0aGUgYXNzZXQKICAgIC8vLyBAcGFyYW0gaXBmc0hhc2ggU2FtZSBhcyB1cmwgYnV0IGZvciBpcGZzCiAgICAvLy8gQHBhcmFtIGNoYWluSWQgQ2hhaW4gd2hlcmUgdGhlIGFzc2V0IHJlc2lkZXMKICAgIC8vLyBAcGFyYW0gYnJlYWtJbiBBZGRyZXNzIG9mIGJyZWFrIGluIGNvbnRyYWN0IG9uIGRlc3RpbmF0aW9uIGNoYWluCiAgICAvLy8gQHBhcmFtIGJyZWFrT3V0IEFkZHJlc3Mgb2YgYnJlYWsgb3V0IGNvbnRyYWN0IG9uIHRoaXMgY2hhaW4KICAgIGZ1bmN0aW9uIHJlZ2lzdGVyKAogICAgICAgIGFkZHJlc3Mgb2ZBc3NldCwKICAgICAgICBzdHJpbmcgbmFtZSwKICAgICAgICBzdHJpbmcgc3ltYm9sLAogICAgICAgIHVpbnQgZGVjaW1hbCwKICAgICAgICBzdHJpbmcgdXJsLAogICAgICAgIHN0cmluZyBpcGZzSGFzaCwKICAgICAgICBieXRlczMyIGNoYWluSWQsCiAgICAgICAgYWRkcmVzcyBicmVha0luLAogICAgICAgIGFkZHJlc3MgYnJlYWtPdXQKICAgICkKICAgICAgICBwcmVfY29uZChpc093bmVyKCkpCiAgICAgICAgcHJlX2NvbmQoIWluZm9ybWF0aW9uW29mQXNzZXRdLmV4aXN0cykKICAgIHsKICAgICAgICBBc3NldCBhc3NldCA9IGluZm9ybWF0aW9uW29mQXNzZXRdOwogICAgICAgIGFzc2V0Lm5hbWUgPSBuYW1lOwogICAgICAgIGFzc2V0LnN5bWJvbCA9IHN5bWJvbDsKICAgICAgICBhc3NldC5kZWNpbWFsID0gZGVjaW1hbDsKICAgICAgICBhc3NldC51cmwgPSB1cmw7CiAgICAgICAgYXNzZXQuaXBmc0hhc2ggPSBpcGZzSGFzaDsKICAgICAgICBhc3NldC5icmVha0luID0gYnJlYWtJbjsKICAgICAgICBhc3NldC5icmVha091dCA9IGJyZWFrT3V0OwogICAgICAgIGFzc2V0LmV4aXN0cyA9IHRydWU7CiAgICAgICAgYXNzZXJ0KGluZm9ybWF0aW9uW29mQXNzZXRdLmV4aXN0cyk7CiAgICB9CgogICAgLy8vIEBub3RpY2UgVXBkYXRlcyBkZXNjcmlwdGlvbiBpbmZvcm1hdGlvbiBvZiBhIHJlZ2lzdGVyZWQgQXNzZXQKICAgIC8vLyBAZGV2IFByZTogT3duZXIgY2FuIGNoYW5nZSBhbiBleGlzdGluZyBlbnRyeQogICAgLy8vIEBkZXYgUG9zdDogQ2hhbmdlZCBOYW1lLCBTeW1ib2wsIFVSTCBhbmQvb3IgSVBGU0hhc2gKICAgIC8vLyBAcGFyYW0gb2ZBc3NldCBBZGRyZXNzIG9mIHRoZSBhc3NldCB0byBiZSB1cGRhdGVkCiAgICAvLy8gQHBhcmFtIG5hbWUgSHVtYW4tcmVhZGFibGUgbmFtZSBvZiB0aGUgQXNzZXQgYXMgaW4gRVJDMjIzIHRva2VuIHN0YW5kYXJkCiAgICAvLy8gQHBhcmFtIHN5bWJvbCBIdW1hbi1yZWFkYWJsZSBzeW1ib2wgb2YgdGhlIEFzc2V0IGFzIGluIEVSQzIyMyB0b2tlbiBzdGFuZGFyZAogICAgLy8vIEBwYXJhbSB1cmwgVXJsIGZvciBleHRlbmRlZCBpbmZvcm1hdGlvbiBvZiB0aGUgYXNzZXQKICAgIC8vLyBAcGFyYW0gaXBmc0hhc2ggU2FtZSBhcyB1cmwgYnV0IGZvciBpcGZzCiAgICBmdW5jdGlvbiB1cGRhdGVEZXNjcmlwdGl2ZUluZm9ybWF0aW9uKAogICAgICAgIGFkZHJlc3Mgb2ZBc3NldCwKICAgICAgICBzdHJpbmcgbmFtZSwKICAgICAgICBzdHJpbmcgc3ltYm9sLAogICAgICAgIHN0cmluZyB1cmwsCiAgICAgICAgc3RyaW5nIGlwZnNIYXNoCiAgICApCiAgICAgICAgcHJlX2NvbmQoaXNPd25lcigpKQogICAgICAgIHByZV9jb25kKGluZm9ybWF0aW9uW29mQXNzZXRdLmV4aXN0cykKICAgIHsKICAgICAgICBBc3NldCBhc3NldCA9IGluZm9ybWF0aW9uW29mQXNzZXRdOwogICAgICAgIGFzc2V0Lm5hbWUgPSBuYW1lOwogICAgICAgIGFzc2V0LnN5bWJvbCA9IHN5bWJvbDsKICAgICAgICBhc3NldC51cmwgPSB1cmw7CiAgICAgICAgYXNzZXQuaXBmc0hhc2ggPSBpcGZzSGFzaDsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBEZWxldGVzIGFuIGV4aXN0aW5nIGVudHJ5CiAgICAvLy8gQGRldiBPd25lciBjYW4gZGVsZXRlIGFuIGV4aXN0aW5nIGVudHJ5CiAgICAvLy8gQHBhcmFtIG9mQXNzZXQgYWRkcmVzcyBmb3Igd2hpY2ggc3BlY2lmaWMgaW5mb3JtYXRpb24gaXMgcmVxdWVzdGVkCiAgICBmdW5jdGlvbiByZW1vdmUoCiAgICAgICAgYWRkcmVzcyBvZkFzc2V0CiAgICApCiAgICAgICAgcHJlX2NvbmQoaXNPd25lcigpKQogICAgICAgIHByZV9jb25kKGluZm9ybWF0aW9uW29mQXNzZXRdLmV4aXN0cykKICAgIHsKICAgICAgICBkZWxldGUgaW5mb3JtYXRpb25bb2ZBc3NldF07IC8vIFNldHMgZXhpc3RzIGJvb2xlYW4gdG8gZmFsc2UKICAgICAgICBhc3NlcnQoIWluZm9ybWF0aW9uW29mQXNzZXRdLmV4aXN0cyk7CiAgICB9CgogICAgLy8gUFVCTElDIFZJRVcgTUVUSE9EUwoKICAgIC8vIEdldCBhc3NldCBzcGVjaWZpYyBpbmZvcm1hdGlvbgogICAgZnVuY3Rpb24gZ2V0TmFtZShhZGRyZXNzIG9mQXNzZXQpIHZpZXcgcmV0dXJucyAoc3RyaW5nKSB7IHJldHVybiBpbmZvcm1hdGlvbltvZkFzc2V0XS5uYW1lOyB9CiAgICBmdW5jdGlvbiBnZXRTeW1ib2woYWRkcmVzcyBvZkFzc2V0KSB2aWV3IHJldHVybnMgKHN0cmluZykgeyByZXR1cm4gaW5mb3JtYXRpb25bb2ZBc3NldF0uc3ltYm9sOyB9CiAgICBmdW5jdGlvbiBnZXREZWNpbWFscyhhZGRyZXNzIG9mQXNzZXQpIHZpZXcgcmV0dXJucyAodWludCkgeyByZXR1cm4gaW5mb3JtYXRpb25bb2ZBc3NldF0uZGVjaW1hbDsgfQoKfQoKaW50ZXJmYWNlIFByaWNlRmVlZEludGVyZmFjZSB7CgogICAgLy8gRVZFTlRTCgogICAgZXZlbnQgUHJpY2VVcGRhdGVkKHVpbnQgdGltZXN0YW1wKTsKCiAgICAvLyBQVUJMSUMgTUVUSE9EUwoKICAgIGZ1bmN0aW9uIHVwZGF0ZShhZGRyZXNzW10gb2ZBc3NldHMsIHVpbnRbXSBuZXdQcmljZXMpOwoKICAgIC8vIFBVQkxJQyBWSUVXIE1FVEhPRFMKCiAgICAvLyBHZXQgYXNzZXQgc3BlY2lmaWMgaW5mb3JtYXRpb24KICAgIGZ1bmN0aW9uIGdldE5hbWUoYWRkcmVzcyBvZkFzc2V0KSB2aWV3IHJldHVybnMgKHN0cmluZyk7CiAgICBmdW5jdGlvbiBnZXRTeW1ib2woYWRkcmVzcyBvZkFzc2V0KSB2aWV3IHJldHVybnMgKHN0cmluZyk7CiAgICBmdW5jdGlvbiBnZXREZWNpbWFscyhhZGRyZXNzIG9mQXNzZXQpIHZpZXcgcmV0dXJucyAodWludCk7CiAgICAvLyBHZXQgcHJpY2UgZmVlZCBvcGVyYXRpb24gc3BlY2lmaWMgaW5mb3JtYXRpb24KICAgIGZ1bmN0aW9uIGdldFF1b3RlQXNzZXQoKSB2aWV3IHJldHVybnMgKGFkZHJlc3MpOwogICAgZnVuY3Rpb24gZ2V0SW50ZXJ2YWwoKSB2aWV3IHJldHVybnMgKHVpbnQpOwogICAgZnVuY3Rpb24gZ2V0VmFsaWRpdHkoKSB2aWV3IHJldHVybnMgKHVpbnQpOwogICAgZnVuY3Rpb24gZ2V0TGFzdFVwZGF0ZUlkKCkgdmlldyByZXR1cm5zICh1aW50KTsKICAgIC8vIEdldCBhc3NldCBzcGVjaWZpYyBpbmZvcm1hdGlvbiBhcyB1cGRhdGVkIGluIHByaWNlIGZlZWQKICAgIGZ1bmN0aW9uIGhhc1JlY2VudFByaWNlKGFkZHJlc3Mgb2ZBc3NldCkgdmlldyByZXR1cm5zIChib29sIGlzUmVjZW50KTsKICAgIGZ1bmN0aW9uIGhhc1JlY2VudFByaWNlcyhhZGRyZXNzW10gb2ZBc3NldHMpIHZpZXcgcmV0dXJucyAoYm9vbCBhcmVSZWNlbnQpOwogICAgZnVuY3Rpb24gZ2V0UHJpY2UoYWRkcmVzcyBvZkFzc2V0KSB2aWV3IHJldHVybnMgKGJvb2wgaXNSZWNlbnQsIHVpbnQgcHJpY2UsIHVpbnQgZGVjaW1hbCk7CiAgICBmdW5jdGlvbiBnZXRQcmljZXMoYWRkcmVzc1tdIG9mQXNzZXRzKSB2aWV3IHJldHVybnMgKGJvb2wgYXJlUmVjZW50LCB1aW50W10gcHJpY2VzLCB1aW50W10gZGVjaW1hbHMpOwogICAgZnVuY3Rpb24gZ2V0SW52ZXJ0ZWRQcmljZShhZGRyZXNzIG9mQXNzZXQpIHZpZXcgcmV0dXJucyAoYm9vbCBpc1JlY2VudCwgdWludCBpbnZlcnRlZFByaWNlLCB1aW50IGRlY2ltYWwpOwogICAgZnVuY3Rpb24gZ2V0UmVmZXJlbmNlUHJpY2UoYWRkcmVzcyBvZkJhc2UsIGFkZHJlc3Mgb2ZRdW90ZSkgdmlldyByZXR1cm5zIChib29sIGlzUmVjZW50LCB1aW50IHJlZmVyZW5jZVByaWNlLCB1aW50IGRlY2ltYWwpOwogICAgZnVuY3Rpb24gZ2V0T3JkZXJQcmljZSgKICAgICAgICBhZGRyZXNzIHNlbGxBc3NldCwKICAgICAgICBhZGRyZXNzIGJ1eUFzc2V0LAogICAgICAgIHVpbnQgc2VsbFF1YW50aXR5LAogICAgICAgIHVpbnQgYnV5UXVhbnRpdHkKICAgICkgdmlldyByZXR1cm5zICh1aW50IG9yZGVyUHJpY2UpOwogICAgZnVuY3Rpb24gZXhpc3RzUHJpY2VPbkFzc2V0UGFpcihhZGRyZXNzIHNlbGxBc3NldCwgYWRkcmVzcyBidXlBc3NldCkgdmlldyByZXR1cm5zIChib29sIGlzRXhpc3RlbnQpOwp9Cgpjb250cmFjdCBQcmljZUZlZWQgaXMgUHJpY2VGZWVkSW50ZXJmYWNlLCBBc3NldFJlZ2lzdHJhciwgRFNNYXRoIHsKCiAgICAvLyBGSUVMRFMKCiAgICAvLyBDb25zdHJ1Y3RvciBmaWVsZHMKICAgIGFkZHJlc3MgcHVibGljIFFVT1RFX0FTU0VUOyAvLyBBc3NldCBvZiBhIHBvcnRmb2xpbyBhZ2FpbnN0IHdoaWNoIGFsbCBvdGhlciBhc3NldHMgYXJlIHByaWNlZAogICAgLy8vIE5vdGU6IEludGVydmFsIGlzIHB1cmVseSBzZWxmIGltcG9zZWQgYW5kIGZvciBpbmZvcm1hdGlvbiBwdXJwb3NlcyBvbmx5CiAgICB1aW50IHB1YmxpYyBJTlRFUlZBTDsgLy8gRnJlcXVlbmN5IG9mIHVwZGF0ZXMgaW4gc2Vjb25kcwogICAgdWludCBwdWJsaWMgVkFMSURJVFk7IC8vIFRpbWUgaW4gc2Vjb25kcyBmb3Igd2hpY2ggZGF0YSBpcyBjb25zaWRlcmVkIHJlY2VudAogICAgdWludCB1cGRhdGVJZDsgICAgICAgIC8vIFVwZGF0ZSBjb3VudGVyIGZvciB0aGlzIHByaWNlZmVlZDsgdXNlZCBhcyBhIGNoZWNrIGR1cmluZyBpbnZlc3RtZW50CgogICAgLy8gTUVUSE9EUwoKICAgIC8vIENPTlNUUlVDVE9SCgogICAgLy8vIEBkZXYgRGVmaW5lIGFuZCByZWdpc3RlciBhIHF1b3RlIGFzc2V0IGFnYWluc3Qgd2hpY2ggYWxsIHByaWNlcyBhcmUgbWVhc3VyZWQvYmFzZWQgYWdhaW5zdAogICAgLy8vIEBwYXJhbSBvZlF1b3RlQXNzZXQgQWRkcmVzcyBvZiBxdW90ZSBhc3NldAogICAgLy8vIEBwYXJhbSBxdW90ZUFzc2V0TmFtZSBOYW1lIG9mIHF1b3RlIGFzc2V0CiAgICAvLy8gQHBhcmFtIHF1b3RlQXNzZXRTeW1ib2wgU3ltYm9sIGZvciBxdW90ZSBhc3NldAogICAgLy8vIEBwYXJhbSBxdW90ZUFzc2V0RGVjaW1hbHMgRGVjaW1hbCBwbGFjZXMgZm9yIHF1b3RlIGFzc2V0CiAgICAvLy8gQHBhcmFtIHF1b3RlQXNzZXRVcmwgVVJMIHJlbGF0ZWQgdG8gcXVvdGUgYXNzZXQKICAgIC8vLyBAcGFyYW0gcXVvdGVBc3NldElwZnNIYXNoIElQRlMgaGFzaCBhc3NvY2lhdGVkIHdpdGggcXVvdGUgYXNzZXQKICAgIC8vLyBAcGFyYW0gcXVvdGVBc3NldENoYWluSWQgQ2hhaW4gSUQgYXNzb2NpYXRlZCB3aXRoIHF1b3RlIGFzc2V0IChlLmcuICIxIiBmb3IgbWFpbiBFdGhlcmV1bSBuZXR3b3JrKQogICAgLy8vIEBwYXJhbSBxdW90ZUFzc2V0QnJlYWtJbiBCcmVhay1pbiBhZGRyZXNzIGZvciB0aGUgcXVvdGUgYXNzZXQKICAgIC8vLyBAcGFyYW0gcXVvdGVBc3NldEJyZWFrT3V0IEJyZWFrLW91dCBhZGRyZXNzIGZvciB0aGUgcXVvdGUgYXNzZXQKICAgIC8vLyBAcGFyYW0gaW50ZXJ2YWwgTnVtYmVyIG9mIHNlY29uZHMgYmV0d2VlbiBwcmljZWZlZWQgdXBkYXRlcyAodGhpcyBpbnRlcnZhbCBpcyBub3QgZW5mb3JjZWQgb24tY2hhaW4sIGJ1dCBzaG91bGQgYmUgZm9sbG93ZWQgYnkgdGhlIGRhdGFmZWVkIG1haW50YWluZXIpCiAgICAvLy8gQHBhcmFtIHZhbGlkaXR5IE51bWJlciBvZiBzZWNvbmRzIHRoYXQgZGF0YWZlZWQgdXBkYXRlIGluZm9ybWF0aW9uIGlzIHZhbGlkIGZvcgogICAgZnVuY3Rpb24gUHJpY2VGZWVkKAogICAgICAgIGFkZHJlc3Mgb2ZRdW90ZUFzc2V0LCAvLyBJbml0YWwgZW50cnkgaW4gYXNzZXQgcmVnaXN0cmFyIGNvbnRyYWN0IGlzIE1lbG9uIChRVU9URV9BU1NFVCkKICAgICAgICBzdHJpbmcgcXVvdGVBc3NldE5hbWUsCiAgICAgICAgc3RyaW5nIHF1b3RlQXNzZXRTeW1ib2wsCiAgICAgICAgdWludCBxdW90ZUFzc2V0RGVjaW1hbHMsCiAgICAgICAgc3RyaW5nIHF1b3RlQXNzZXRVcmwsCiAgICAgICAgc3RyaW5nIHF1b3RlQXNzZXRJcGZzSGFzaCwKICAgICAgICBieXRlczMyIHF1b3RlQXNzZXRDaGFpbklkLAogICAgICAgIGFkZHJlc3MgcXVvdGVBc3NldEJyZWFrSW4sCiAgICAgICAgYWRkcmVzcyBxdW90ZUFzc2V0QnJlYWtPdXQsCiAgICAgICAgdWludCBpbnRlcnZhbCwKICAgICAgICB1aW50IHZhbGlkaXR5CiAgICApIHsKICAgICAgICBRVU9URV9BU1NFVCA9IG9mUXVvdGVBc3NldDsKICAgICAgICByZWdpc3RlcigKICAgICAgICAgICAgUVVPVEVfQVNTRVQsCiAgICAgICAgICAgIHF1b3RlQXNzZXROYW1lLAogICAgICAgICAgICBxdW90ZUFzc2V0U3ltYm9sLAogICAgICAgICAgICBxdW90ZUFzc2V0RGVjaW1hbHMsCiAgICAgICAgICAgIHF1b3RlQXNzZXRVcmwsCiAgICAgICAgICAgIHF1b3RlQXNzZXRJcGZzSGFzaCwKICAgICAgICAgICAgcXVvdGVBc3NldENoYWluSWQsCiAgICAgICAgICAgIHF1b3RlQXNzZXRCcmVha0luLAogICAgICAgICAgICBxdW90ZUFzc2V0QnJlYWtPdXQKICAgICAgICApOwogICAgICAgIElOVEVSVkFMID0gaW50ZXJ2YWw7CiAgICAgICAgVkFMSURJVFkgPSB2YWxpZGl0eTsKICAgIH0KCiAgICAvLyBQVUJMSUMgTUVUSE9EUwoKICAgIC8vLyBAZGV2IE9ubHkgT3duZXI7IFNhbWUgc2l6ZWQgaW5wdXQgYXJyYXlzCiAgICAvLy8gQGRldiBVcGRhdGVzIHByaWNlIG9mIGFzc2V0IHJlbGF0aXZlIHRvIFFVT1RFX0FTU0VUCiAgICAvKiogRXg6CiAgICAgKiAgTGV0IFFVT1RFX0FTU0VUID09IE1MTiAoYmFzZSB1bml0cyksIGxldCBhc3NldCA9PSBFVVItVCwKICAgICAqICBsZXQgVmFsdWUgb2YgMSBFVVItVCA6PSAxIEVVUiA9PSAwLjA4MDQ1Njc4OSBNTE4sIGhlbmNlIHByaWNlIDAuMDgwNDU2Nzg5IE1MTiAvIEVVUi1UCiAgICAgKiAgYW5kIGxldCBFVVItVCBkZWNpbWFscyA9PSA4LgogICAgICogIElucHV0IHdvdWxkIGJlOiBpbmZvcm1hdGlvbltFVVItVF0ucHJpY2UgPSA4MDQ1Njc4IFtNTE4vIChFVVItVCAqIDEwKio4KV0KICAgICAqLwogICAgLy8vIEBwYXJhbSBvZkFzc2V0cyBsaXN0IG9mIGFzc2V0IGFkZHJlc3NlcwogICAgLy8vIEBwYXJhbSBuZXdQcmljZXMgbGlzdCBvZiBwcmljZXMgZm9yIGVhY2ggb2YgdGhlIGFzc2V0cwogICAgZnVuY3Rpb24gdXBkYXRlKGFkZHJlc3NbXSBvZkFzc2V0cywgdWludFtdIG5ld1ByaWNlcykKICAgICAgICBwcmVfY29uZChpc093bmVyKCkpCiAgICAgICAgcHJlX2NvbmQob2ZBc3NldHMubGVuZ3RoID09IG5ld1ByaWNlcy5sZW5ndGgpCiAgICB7CiAgICAgICAgdXBkYXRlSWQgKz0gMTsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBvZkFzc2V0cy5sZW5ndGg7ICsraSkgewogICAgICAgICAgICByZXF1aXJlKGluZm9ybWF0aW9uW29mQXNzZXRzW2ldXS50aW1lc3RhbXAgIT0gbm93KTsgLy8gcHJldmVudCB0d28gdXBkYXRlcyBpbiBvbmUgYmxvY2sKICAgICAgICAgICAgcmVxdWlyZShpbmZvcm1hdGlvbltvZkFzc2V0c1tpXV0uZXhpc3RzKTsKICAgICAgICAgICAgaW5mb3JtYXRpb25bb2ZBc3NldHNbaV1dLnRpbWVzdGFtcCA9IG5vdzsKICAgICAgICAgICAgaW5mb3JtYXRpb25bb2ZBc3NldHNbaV1dLnByaWNlID0gbmV3UHJpY2VzW2ldOwogICAgICAgIH0KICAgICAgICBQcmljZVVwZGF0ZWQobm93KTsKICAgIH0KCiAgICAvLyBQVUJMSUMgVklFVyBNRVRIT0RTCgogICAgLy8gR2V0IHByaWNlZmVlZCBzcGVjaWZpYyBpbmZvcm1hdGlvbgogICAgZnVuY3Rpb24gZ2V0UXVvdGVBc3NldCgpIHZpZXcgcmV0dXJucyAoYWRkcmVzcykgeyByZXR1cm4gUVVPVEVfQVNTRVQ7IH0KICAgIGZ1bmN0aW9uIGdldEludGVydmFsKCkgdmlldyByZXR1cm5zICh1aW50KSB7IHJldHVybiBJTlRFUlZBTDsgfQogICAgZnVuY3Rpb24gZ2V0VmFsaWRpdHkoKSB2aWV3IHJldHVybnMgKHVpbnQpIHsgcmV0dXJuIFZBTElESVRZOyB9CiAgICBmdW5jdGlvbiBnZXRMYXN0VXBkYXRlSWQoKSB2aWV3IHJldHVybnMgKHVpbnQpIHsgcmV0dXJuIHVwZGF0ZUlkOyB9CgogICAgLy8vIEBub3RpY2UgV2hldGhlciBwcmljZSBvZiBhc3NldCBoYXMgYmVlbiB1cGRhdGVkIGxlc3MgdGhhbiBWQUxJRElUWSBzZWNvbmRzIGFnbwogICAgLy8vIEBwYXJhbSBvZkFzc2V0IEV4aXN0ZW5kIGFzc2V0IGluIEFzc2V0UmVnaXN0cmFyCiAgICAvLy8gQHJldHVybiBpc1JlY2VudCBQcmljZSBpbmZvcm1hdGlvbiBvZkFzc2V0IGlzIHJlY2VudAogICAgZnVuY3Rpb24gaGFzUmVjZW50UHJpY2UoYWRkcmVzcyBvZkFzc2V0KQogICAgICAgIHZpZXcKICAgICAgICBwcmVfY29uZChpbmZvcm1hdGlvbltvZkFzc2V0XS5leGlzdHMpCiAgICAgICAgcmV0dXJucyAoYm9vbCBpc1JlY2VudCkKICAgIHsKICAgICAgICByZXR1cm4gc3ViKG5vdywgaW5mb3JtYXRpb25bb2ZBc3NldF0udGltZXN0YW1wKSA8PSBWQUxJRElUWTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBXaGV0aGVyIHByaWNlcyBvZiBhc3NldHMgaGF2ZSBiZWVuIHVwZGF0ZWQgbGVzcyB0aGFuIFZBTElESVRZIHNlY29uZHMgYWdvCiAgICAvLy8gQHBhcmFtIG9mQXNzZXRzIEFsbCBhc3N0ZXMgZXhpc3RlbmQgaW4gQXNzZXRSZWdpc3RyYXIKICAgIC8vLyBAcmV0dXJuIGlzUmVjZW50IFByaWNlIGluZm9ybWF0aW9uIG9mQXNzZXRzIGFycmF5IGlzIHJlY2VudAogICAgZnVuY3Rpb24gaGFzUmVjZW50UHJpY2VzKGFkZHJlc3NbXSBvZkFzc2V0cykKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyAoYm9vbCBhcmVSZWNlbnQpCiAgICB7CiAgICAgICAgZm9yICh1aW50IGk7IGkgPCBvZkFzc2V0cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoIWhhc1JlY2VudFByaWNlKG9mQXNzZXRzW2ldKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgQG5vdGljZSBHZXRzIHByaWNlIG9mIGFuIGFzc2V0IG11bHRpcGxpZWQgYnkgdGVuIHRvIHRoZSBwb3dlciBvZiBhc3NldERlY2ltYWxzCiAgICBAZGV2IEFzc2V0IGhhcyBiZWVuIHJlZ2lzdGVyZWQKICAgIEBwYXJhbSBvZkFzc2V0IEFzc2V0IGZvciB3aGljaCBwcmljZSBzaG91bGQgYmUgcmV0dXJuZWQKICAgIEByZXR1cm4gewogICAgICAiaXNSZWNlbnQiOiAiV2hldGhlciB0aGUgcmV0dXJuZWQgcHJpY2UgaXMgdmFsaWQgKGFzIGRlZmluZWQgYnkgVkFMSURJVFkpIiwKICAgICAgInByaWNlIjogIlByaWNlIGZvcm1hdHRpbmc6IG11bChleGNoYW5nZVByaWNlLCAxMCAqKiBkZWNpbWFsKSwgdG8gYXZvaWQgZmxvYXRpbmcgbnVtYmVycyIsCiAgICAgICJkZWNpbWFsIjogIkRlY2ltYWwsIG9yZGVyIG9mIG1hZ25pdHVkZSBvZiBwcmVjaXNpb24sIG9mIHRoZSBBc3NldCBhcyBpbiBFUkMyMjMgdG9rZW4gc3RhbmRhcmQiLAogICAgfQogICAgKi8KICAgIGZ1bmN0aW9uIGdldFByaWNlKGFkZHJlc3Mgb2ZBc3NldCkKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyAoYm9vbCBpc1JlY2VudCwgdWludCBwcmljZSwgdWludCBkZWNpbWFsKQogICAgewogICAgICAgIHJldHVybiAoCiAgICAgICAgICAgIGhhc1JlY2VudFByaWNlKG9mQXNzZXQpLAogICAgICAgICAgICBpbmZvcm1hdGlvbltvZkFzc2V0XS5wcmljZSwKICAgICAgICAgICAgaW5mb3JtYXRpb25bb2ZBc3NldF0uZGVjaW1hbAogICAgICAgICk7CiAgICB9CgogICAgLyoqCiAgICBAbm90aWNlIFByaWNlIG9mIGEgcmVnaXN0ZXJlZCBhc3NldCBpbiBmb3JtYXQgKGJvb2wgYXJlUmVjZW50LCB1aW50W10gcHJpY2VzLCB1aW50W10gZGVjaW1hbHMpCiAgICBAZGV2IENvbnZlbnRpb24gZm9yIHByaWNlIGZvcm1hdHRpbmc6IG11bChwcmljZSwgMTAgKiogZGVjaW1hbCksIHRvIGF2b2lkIGZsb2F0aW5nIG51bWJlcnMKICAgIEBwYXJhbSBvZkFzc2V0cyBBc3NldHMgZm9yIHdoaWNoIHByaWNlcyBzaG91bGQgYmUgcmV0dXJuZWQKICAgIEByZXR1cm4gewogICAgICAgICJhcmVSZWNlbnQiOiAgICAiV2hldGhlciBhbGwgb2YgdGhlIHByaWNlcyBhcmUgZnJlc2gsIGdpdmVuIFZBTElESVRZIGludGVydmFsIiwKICAgICAgICAicHJpY2VzIjogICAgICAgIkFycmF5IG9mIHByaWNlcyIsCiAgICAgICAgImRlY2ltYWxzIjogICAgICJBcnJheSBvZiBkZWNpbWFsIHBsYWNlcyBmb3IgcmV0dXJuZWQgYXNzZXRzIgogICAgfQogICAgKi8KICAgIGZ1bmN0aW9uIGdldFByaWNlcyhhZGRyZXNzW10gb2ZBc3NldHMpCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnMgKGJvb2wgYXJlUmVjZW50LCB1aW50W10gcHJpY2VzLCB1aW50W10gZGVjaW1hbHMpCiAgICB7CiAgICAgICAgYXJlUmVjZW50ID0gdHJ1ZTsKICAgICAgICBmb3IgKHVpbnQgaTsgaSA8IG9mQXNzZXRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciAoaXNSZWNlbnQsIHByaWNlLCBkZWNpbWFsKSA9IGdldFByaWNlKG9mQXNzZXRzW2ldKTsKICAgICAgICAgICAgaWYgKCFpc1JlY2VudCkgewogICAgICAgICAgICAgICAgYXJlUmVjZW50ID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcHJpY2VzW2ldID0gcHJpY2U7CiAgICAgICAgICAgIGRlY2ltYWxzW2ldID0gZGVjaW1hbDsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICBAbm90aWNlIEdldHMgaW52ZXJ0ZWQgcHJpY2Ugb2YgYW4gYXNzZXQKICAgIEBkZXYgQXNzZXQgaGFzIGJlZW4gaW5pdGlhbGlzZWQgYW5kIGl0cyBwcmljZSBpcyBub24temVybwogICAgQGRldiBFeGlzdGluZyBwcmljZSBvZkFzc2V0cyBxdW90ZWQgaW4gUVVPVEVfQVNTRVQgKGNvbnZlbnRpb24pCiAgICBAcGFyYW0gb2ZBc3NldCBBc3NldCBmb3Igd2hpY2ggaW52ZXJ0ZWQgcHJpY2Ugc2hvdWxkIGJlIHJldHVybgogICAgQHJldHVybiB7CiAgICAgICAgImlzUmVjZW50IjogIldoZXRoZXIgdGhlIHByaWNlIGlzIGZyZXNoLCBnaXZlbiBWQUxJRElUWSBpbnRlcnZhbCIsCiAgICAgICAgImludmVydGVkUHJpY2UiOiAiUHJpY2UgYmFzZWQgKGluc3RlYWQgb2YgcXVvdGVkKSBhZ2FpbnN0IFFVT1RFX0FTU0VUIiwKICAgICAgICAiZGVjaW1hbCI6ICJEZWNpbWFsIHBsYWNlcyBmb3IgdGhpcyBhc3NldCIKICAgIH0KICAgICovCiAgICBmdW5jdGlvbiBnZXRJbnZlcnRlZFByaWNlKGFkZHJlc3Mgb2ZBc3NldCkKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyAoYm9vbCBpc1JlY2VudCwgdWludCBpbnZlcnRlZFByaWNlLCB1aW50IGRlY2ltYWwpCiAgICB7CiAgICAgICAgLy8gaW5wdXRQcmljZSBxdW90ZWQgaW4gUVVPVEVfQVNTRVQgYW5kIG11bHRpcGxpZWQgYnkgMTAgKiogYXNzZXREZWNpbWFsCiAgICAgICAgdmFyIChpc0ludmVydGVkUmVjZW50LCBpbnB1dFByaWNlLCBhc3NldERlY2ltYWwpID0gZ2V0UHJpY2Uob2ZBc3NldCk7CgogICAgICAgIC8vIG91dHB1dFByaWNlIGJhc2VkIGluIFFVT1RFX0FTU0VUIGFuZCBtdWx0aXBsaWVkIGJ5IDEwICoqIHF1b3RlRGVjaW1hbAogICAgICAgIHVpbnQgcXVvdGVEZWNpbWFsID0gZ2V0RGVjaW1hbHMoUVVPVEVfQVNTRVQpOwoKICAgICAgICByZXR1cm4gKAogICAgICAgICAgICBpc0ludmVydGVkUmVjZW50LAogICAgICAgICAgICBtdWwoMTAgKiogdWludChxdW90ZURlY2ltYWwpLCAxMCAqKiB1aW50KGFzc2V0RGVjaW1hbCkpIC8gaW5wdXRQcmljZSwKICAgICAgICAgICAgcXVvdGVEZWNpbWFsCiAgICAgICAgKTsKICAgIH0KCiAgICAvKioKICAgIEBub3RpY2UgR2V0cyByZWZlcmVuY2UgcHJpY2Ugb2YgYW4gYXNzZXQgcGFpcgogICAgQGRldiBPbmUgb2YgdGhlIGFkZHJlc3MgaXMgZXF1YWwgdG8gcXVvdGUgYXNzZXQKICAgIEBkZXYgZWl0aGVyIG9mQmFzZSA9PSBRVU9URV9BU1NFVCBvciBvZlF1b3RlID09IFFVT1RFX0FTU0VUCiAgICBAcGFyYW0gb2ZCYXNlIEFkZHJlc3Mgb2YgYmFzZSBhc3NldAogICAgQHBhcmFtIG9mUXVvdGUgQWRkcmVzcyBvZiBxdW90ZSBhc3NldAogICAgQHJldHVybiB7CiAgICAgICAgImlzUmVjZW50IjogIldoZXRoZXIgdGhlIHByaWNlIGlzIGZyZXNoLCBnaXZlbiBWQUxJRElUWSBpbnRlcnZhbCIsCiAgICAgICAgInJlZmVyZW5jZVByaWNlIjogIlJlZmVyZW5jZSBwcmljZSIsCiAgICAgICAgImRlY2ltYWwiOiAiRGVjaW1hbCBwbGFjZXMgZm9yIHRoaXMgYXNzZXQiCiAgICB9CiAgICAqLwogICAgZnVuY3Rpb24gZ2V0UmVmZXJlbmNlUHJpY2UoYWRkcmVzcyBvZkJhc2UsIGFkZHJlc3Mgb2ZRdW90ZSkKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyAoYm9vbCBpc1JlY2VudCwgdWludCByZWZlcmVuY2VQcmljZSwgdWludCBkZWNpbWFsKQogICAgewogICAgICAgIGlmIChnZXRRdW90ZUFzc2V0KCkgPT0gb2ZRdW90ZSkgewogICAgICAgICAgICAoaXNSZWNlbnQsIHJlZmVyZW5jZVByaWNlLCBkZWNpbWFsKSA9IGdldFByaWNlKG9mQmFzZSk7CiAgICAgICAgfSBlbHNlIGlmIChnZXRRdW90ZUFzc2V0KCkgPT0gb2ZCYXNlKSB7CiAgICAgICAgICAgIChpc1JlY2VudCwgcmVmZXJlbmNlUHJpY2UsIGRlY2ltYWwpID0gZ2V0SW52ZXJ0ZWRQcmljZShvZlF1b3RlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXZlcnQoKTsgLy8gbm8gc3VpdGFibGUgcmVmZXJlbmNlIHByaWNlIGF2YWlsYWJsZQogICAgICAgIH0KICAgIH0KCiAgICAvLy8gQG5vdGljZSBHZXRzIHByaWNlIG9mIE9yZGVyCiAgICAvLy8gQHBhcmFtIHNlbGxBc3NldCBBZGRyZXNzIG9mIHRoZSBhc3NldCB0byBiZSBzb2xkCiAgICAvLy8gQHBhcmFtIGJ1eUFzc2V0IEFkZHJlc3Mgb2YgdGhlIGFzc2V0IHRvIGJlIGJvdWdodAogICAgLy8vIEBwYXJhbSBzZWxsUXVhbnRpdHkgUXVhbnRpdHkgaW4gYmFzZSB1bml0cyBiZWluZyBzb2xkIG9mIHNlbGxBc3NldAogICAgLy8vIEBwYXJhbSBidXlRdWFudGl0eSBRdWFudGl0eSBpbiBiYXNlIHVuaXRzIGJlaW5nIGJvdWdodCBvZiBidXlBc3NldAogICAgLy8vIEByZXR1cm4gb3JkZXJQcmljZSBQcmljZSBhcyBkZXRlcm1pbmVkIGJ5IGFuIG9yZGVyCiAgICBmdW5jdGlvbiBnZXRPcmRlclByaWNlKAogICAgICAgIGFkZHJlc3Mgc2VsbEFzc2V0LAogICAgICAgIGFkZHJlc3MgYnV5QXNzZXQsCiAgICAgICAgdWludCBzZWxsUXVhbnRpdHksCiAgICAgICAgdWludCBidXlRdWFudGl0eQogICAgKQogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zICh1aW50IG9yZGVyUHJpY2UpCiAgICB7CiAgICAgICAgcmV0dXJuIG11bChidXlRdWFudGl0eSwgMTAgKiogdWludChnZXREZWNpbWFscyhzZWxsQXNzZXQpKSkgLyBzZWxsUXVhbnRpdHk7CiAgICB9CgogICAgLy8vIEBub3RpY2UgQ2hlY2tzIHdoZXRoZXIgZGF0YSBleGlzdHMgZm9yIGEgZ2l2ZW4gYXNzZXQgcGFpcgogICAgLy8vIEBkZXYgUHJpY2VzIGFyZSBvbmx5IHVwYXRlZCBhZ2FpbnN0IFFVT1RFX0FTU0VUCiAgICAvLy8gQHBhcmFtIHNlbGxBc3NldCBBc3NldCBmb3Igd2hpY2ggY2hlY2sgdG8gYmUgZG9uZSBpZiBkYXRhIGV4aXN0cwogICAgLy8vIEBwYXJhbSBidXlBc3NldCBBc3NldCBmb3Igd2hpY2ggY2hlY2sgdG8gYmUgZG9uZSBpZiBkYXRhIGV4aXN0cwogICAgLy8vIEByZXR1cm4gV2hldGhlciBhc3NldHMgZXhpc3QgZm9yIGdpdmVuIGFzc2V0IHBhaXIKICAgIGZ1bmN0aW9uIGV4aXN0c1ByaWNlT25Bc3NldFBhaXIoYWRkcmVzcyBzZWxsQXNzZXQsIGFkZHJlc3MgYnV5QXNzZXQpCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnMgKGJvb2wgaXNFeGlzdGVudCkKICAgIHsKICAgICAgICByZXR1cm4KICAgICAgICAgICAgaGFzUmVjZW50UHJpY2Uoc2VsbEFzc2V0KSAmJiAvLyBJcyB0cmFkYWJsZSBhc3NldCAoVE9ETyBjbGVhbmVyKSBhbmQgZGF0YWZlZWQgZGVsaXZlcmluZyBkYXRhCiAgICAgICAgICAgIGhhc1JlY2VudFByaWNlKGJ1eUFzc2V0KSAmJiAvLyBJcyB0cmFkYWJsZSBhc3NldCAoVE9ETyBjbGVhbmVyKSBhbmQgZGF0YWZlZWQgZGVsaXZlcmluZyBkYXRhCiAgICAgICAgICAgIChidXlBc3NldCA9PSBRVU9URV9BU1NFVCB8fCBzZWxsQXNzZXQgPT0gUVVPVEVfQVNTRVQpICYmIC8vIE9uZSBhc3NldCBtdXN0IGJlIFFVT1RFX0FTU0VUCiAgICAgICAgICAgIChidXlBc3NldCAhPSBRVU9URV9BU1NFVCB8fCBzZWxsQXNzZXQgIT0gUVVPVEVfQVNTRVQpOyAvLyBQYWlyIG11c3QgY29uc2lzdHMgb2YgZGlmZnJlbnQgYXNzZXRzCiAgICB9Cn0='.
	

]
