Class {
	#name : #SRT09133d5AcFF2353d3860F1dc455589A941cF5EBd,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT09133d5AcFF2353d3860F1dc455589A941cF5EBd >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7CgoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgogICAgLyoqCiAgICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgICAqIGFjY291bnQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIE93bmFibGUoKSB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKCiAgICAvKioKICAgICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgICAqLwogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCgogICAgLyoqCiAgICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHsKICAgICAgICBpZiAobmV3T3duZXIgIT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICBvd25lciA9IG5ld093bmVyOwogICAgICAgIH0KICAgIH0KfQoKY29udHJhY3QgdG9rZW5SZWNpcGllbnQgeyBmdW5jdGlvbiByZWNlaXZlQXBwcm92YWwoYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdmFsdWUsIGFkZHJlc3MgX3Rva2VuLCBieXRlcyBfZXh0cmFEYXRhKTsgfQoKLyoKICAgIEVSQzIwIGNvbXBhdGlibGUgc21hcnQgY29udHJhY3QKKi8KY29udHJhY3QgTG9nZ2VkRVJDMjAgaXMgT3duYWJsZSB7CiAgICAvKiBTdHJ1Y3R1cmVzICovCiAgICBzdHJ1Y3QgTG9nVmFsdWVCbG9jayB7CiAgICB1aW50MjU2IHZhbHVlOwogICAgdWludDI1NiBibG9jazsKICAgIH0KCiAgICAvKiBQdWJsaWMgdmFyaWFibGVzIG9mIHRoZSB0b2tlbiAqLwogICAgc3RyaW5nIHB1YmxpYyBzdGFuZGFyZCA9ICdMb2dWYWx1ZUJsb2NrVG9rZW4gMC4xJzsKICAgIHN0cmluZyBwdWJsaWMgbmFtZTsKICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sOwogICAgdWludDggcHVibGljIGRlY2ltYWxzOwogICAgTG9nVmFsdWVCbG9ja1tdIHB1YmxpYyBsb2dnZWRUb3RhbFN1cHBseTsKCiAgICBib29sIHB1YmxpYyBsb2NrZWQ7CgogICAgdWludDI1NiBwdWJsaWMgY3JlYXRpb25CbG9jazsKCiAgICAvKiBUaGlzIGNyZWF0ZXMgYW4gYXJyYXkgd2l0aCBhbGwgYmFsYW5jZXMgKi8KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gTG9nVmFsdWVCbG9ja1tdKSBwdWJsaWMgbG9nZ2VkQmFsYW5jZXM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIHB1YmxpYyBhbGxvd2FuY2U7CgogICAgLyogVGhpcyBnZW5lcmF0ZXMgYSBwdWJsaWMgZXZlbnQgb24gdGhlIGJsb2NrY2hhaW4gdGhhdCB3aWxsIG5vdGlmeSBjbGllbnRzICovCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBmcm96ZW5BY2NvdW50OwoKICAgIC8qIFRoaXMgZ2VuZXJhdGVzIGEgcHVibGljIGV2ZW50IG9uIHRoZSBibG9ja2NoYWluIHRoYXQgd2lsbCBub3RpZnkgY2xpZW50cyAqLwogICAgZXZlbnQgRnJvemVuRnVuZHMoYWRkcmVzcyB0YXJnZXQsIGJvb2wgZnJvemVuKTsKCiAgICAvKiBJbml0aWFsaXplcyBjb250cmFjdCB3aXRoIGluaXRpYWwgc3VwcGx5IHRva2VucyB0byB0aGUgY3JlYXRvciBvZiB0aGUgY29udHJhY3QgKi8KICAgIGZ1bmN0aW9uIExvZ2dlZEVSQzIwKAogICAgdWludDI1NiBpbml0aWFsU3VwcGx5LAogICAgc3RyaW5nIHRva2VuTmFtZSwKICAgIHVpbnQ4IGRlY2ltYWxVbml0cywKICAgIHN0cmluZyB0b2tlblN5bWJvbCwKICAgIGJvb2wgdHJhbnNmZXJBbGxTdXBwbHlUb093bmVyLAogICAgYm9vbCBfbG9ja2VkCiAgICApIHsKICAgICAgICBMb2dWYWx1ZUJsb2NrIG1lbW9yeSB2YWx1ZUJsb2NrID0gTG9nVmFsdWVCbG9jayhpbml0aWFsU3VwcGx5LCBibG9jay5udW1iZXIpOwoKICAgICAgICBsb2dnZWRUb3RhbFN1cHBseS5wdXNoKHZhbHVlQmxvY2spOwoKICAgICAgICBpZih0cmFuc2ZlckFsbFN1cHBseVRvT3duZXIpIHsKICAgICAgICAgICAgbG9nZ2VkQmFsYW5jZXNbbXNnLnNlbmRlcl0ucHVzaCh2YWx1ZUJsb2NrKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGxvZ2dlZEJhbGFuY2VzW3RoaXNdLnB1c2godmFsdWVCbG9jayk7CiAgICAgICAgfQoKICAgICAgICBuYW1lID0gdG9rZW5OYW1lOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSBuYW1lIGZvciBkaXNwbGF5IHB1cnBvc2VzCiAgICAgICAgc3ltYm9sID0gdG9rZW5TeW1ib2w7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgc3ltYm9sIGZvciBkaXNwbGF5IHB1cnBvc2VzCiAgICAgICAgZGVjaW1hbHMgPSBkZWNpbWFsVW5pdHM7ICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFtb3VudCBvZiBkZWNpbWFscyBmb3IgZGlzcGxheSBwdXJwb3NlcwogICAgICAgIGxvY2tlZCA9IF9sb2NrZWQ7CiAgICB9CgogICAgZnVuY3Rpb24gdmFsdWVBdChMb2dWYWx1ZUJsb2NrIFtdIHN0b3JhZ2UgY2hlY2twb2ludHMsIHVpbnQyNTYgYmxvY2spIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBpZihjaGVja3BvaW50cy5sZW5ndGggPT0gMCkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CgogICAgICAgIExvZ1ZhbHVlQmxvY2sgbWVtb3J5IHByZXZMb2dWYWx1ZUJsb2NrOwoKICAgICAgICBmb3IodWludDI1NiBpID0gMDsgaSA8IGNoZWNrcG9pbnRzLmxlbmd0aDsgaSsrKSB7CgogICAgICAgICAgICBMb2dWYWx1ZUJsb2NrIG1lbW9yeSBjaGVja3BvaW50ID0gY2hlY2twb2ludHNbaV07CgogICAgICAgICAgICBpZihjaGVja3BvaW50LmJsb2NrID4gYmxvY2spIHsKICAgICAgICAgICAgICAgIHJldHVybiBwcmV2TG9nVmFsdWVCbG9jay52YWx1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJldkxvZ1ZhbHVlQmxvY2sgPSBjaGVja3BvaW50OwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHByZXZMb2dWYWx1ZUJsb2NrLnZhbHVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEJhbGFuY2UoYWRkcmVzcyBfYWRkcmVzcywgdWludDI1NiB2YWx1ZSkgaW50ZXJuYWwgewogICAgICAgIGxvZ2dlZEJhbGFuY2VzW19hZGRyZXNzXS5wdXNoKExvZ1ZhbHVlQmxvY2sodmFsdWUsIGJsb2NrLm51bWJlcikpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiB2YWx1ZUF0KGxvZ2dlZFRvdGFsU3VwcGx5LCBibG9jay5udW1iZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9hZGRyZXNzKSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHZhbHVlQXQobG9nZ2VkQmFsYW5jZXNbX2FkZHJlc3NdLCBibG9jay5udW1iZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVySW50ZXJuYWwoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHVpbnQyNTYgYmFsYW5jZUZyb20gPSB2YWx1ZUF0KGxvZ2dlZEJhbGFuY2VzW19mcm9tXSwgYmxvY2subnVtYmVyKTsKICAgICAgICB1aW50MjU2IGJhbGFuY2VUbyA9IHZhbHVlQXQobG9nZ2VkQmFsYW5jZXNbX3RvXSwgYmxvY2subnVtYmVyKTsKCiAgICAgICAgaWYodmFsdWUgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBpZihmcm96ZW5BY2NvdW50W19mcm9tXSA9PSB0cnVlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGlmKGJhbGFuY2VGcm9tIDwgdmFsdWUpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgaWYoYmFsYW5jZVRvICsgdmFsdWUgPD0gYmFsYW5jZVRvKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGxvZ2dlZEJhbGFuY2VzW19mcm9tXS5wdXNoKExvZ1ZhbHVlQmxvY2soYmFsYW5jZUZyb20gLSB2YWx1ZSwgYmxvY2subnVtYmVyKSk7CiAgICAgICAgbG9nZ2VkQmFsYW5jZXNbX3RvXS5wdXNoKExvZ1ZhbHVlQmxvY2soYmFsYW5jZVRvICsgdmFsdWUsIGJsb2NrLm51bWJlcikpOwoKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCB2YWx1ZSk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qIFNlbmQgY29pbnMgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgewogICAgICAgIHJlcXVpcmUobG9ja2VkID09IGZhbHNlKTsKCiAgICAgICAgYm9vbCBzdGF0dXMgPSB0cmFuc2ZlckludGVybmFsKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKCiAgICAgICAgcmVxdWlyZShzdGF0dXMgPT0gdHJ1ZSk7CiAgICB9CgogICAgLyogQWxsb3cgYW5vdGhlciBjb250cmFjdCB0byBzcGVuZCBzb21lIHRva2VucyBpbiB5b3VyIGJlaGFsZiAqLwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgaWYobG9ja2VkKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGFsbG93YW5jZVttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyogQXBwcm92ZSBhbmQgdGhlbiBjb21tdW5pY2F0ZSB0aGUgYXBwcm92ZWQgY29udHJhY3QgaW4gYSBzaW5nbGUgdHggKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmVBbmRDYWxsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZXh0cmFEYXRhKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBpZihsb2NrZWQpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdG9rZW5SZWNpcGllbnQgc3BlbmRlciA9IHRva2VuUmVjaXBpZW50KF9zcGVuZGVyKTsKICAgICAgICBpZiAoYXBwcm92ZShfc3BlbmRlciwgX3ZhbHVlKSkgewogICAgICAgICAgICBzcGVuZGVyLnJlY2VpdmVBcHByb3ZhbChtc2cuc2VuZGVyLCBfdmFsdWUsIHRoaXMsIF9leHRyYURhdGEpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgLyogQSBjb250cmFjdCBhdHRlbXB0cyB0byBnZXQgdGhlIGNvaW5zICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBpZihsb2NrZWQpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgaWYoYWxsb3dhbmNlW19mcm9tXVttc2cuc2VuZGVyXSA8IF92YWx1ZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBib29sIF9zdWNjZXNzID0gdHJhbnNmZXJJbnRlcm5hbChfZnJvbSwgX3RvLCBfdmFsdWUpOwoKICAgICAgICBpZihfc3VjY2VzcykgewogICAgICAgICAgICBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdIC09IF92YWx1ZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBfc3VjY2VzczsKICAgIH0KfQoKLyoKICAgIFJld2FyZCBkaXN0cmlidXRpb24gZnVuY3Rpb25hbGl0eQoqLwpjb250cmFjdCBMb2dnZWRSZXdhcmQgaXMgT3duYWJsZSwgTG9nZ2VkRVJDMjAgewogICAgLyogU3RydWN0cyAqLwogICAgc3RydWN0IFJld2FyZCB7CiAgICB1aW50MjU2IGlkOwoKICAgIHVpbnQyNTYgYmxvY2s7CiAgICB1aW50MjU2IHRpbWU7CiAgICB1aW50MjU2IGFtb3VudDsKCiAgICB1aW50MjU2IGNsYWltZWRBbW91bnQ7CiAgICB1aW50MjU2IHRyYW5zZmVyZWRCYWNrOwoKICAgIHVpbnQyNTYgdG90YWxTdXBwbHk7CiAgICB1aW50MjU2IHJlY3ljbGVUaW1lOwoKICAgIGJvb2wgcmVjeWNsZWQ7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBjbGFpbWVkOwogICAgfQoKICAgIC8qIHZhcmlhYmxlcyAqLwogICAgUmV3YXJkIFtdIHB1YmxpYyByZXdhcmRzOwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcmV3YXJkc0NsYWltZWQ7CgogICAgLyogRXZlbnRzICovCiAgICBldmVudCBSZXdhcmRUcmFuc2ZlcmVkKHVpbnQyNTYgaWQsIGFkZHJlc3MgaW5kZXhlZCBfYWRkcmVzcywgdWludDI1NiBfYmxvY2ssIHVpbnQyNTYgX2Ftb3VudCwgdWludDI1NiBfdG90YWxTdXBwbHkpOwogICAgZXZlbnQgUmV3YXJkQ2xhaW1lZCh1aW50MjU2IGlkLCBhZGRyZXNzIGluZGV4ZWQgX2FkZHJlc3MsIHVpbnQyNTYgX2NsYWltKTsKICAgIGV2ZW50IFVuY2xhaW1lZFJld2FyZFRyYW5zZmVyKHVpbnQyNTYgaWQsIHVpbnQyNTYgX3ZhbHVlKTsKICAgIGV2ZW50IFJld2FyZFJlY3ljbGVkKHVpbnQyNTYgaWQsIGFkZHJlc3MgaW5kZXhlZCBfcmVjeWNsZXIsIHVpbnQyNTYgX2Jsb2NrTnVtYmVyLCB1aW50MjU2IF9hbW91bnQsIHVpbnQyNTYgX3RvdGFsU3VwcGx5KTsKCiAgICBmdW5jdGlvbiBMb2dnZWRSZXdhcmQoCiAgICB1aW50MjU2IGluaXRpYWxTdXBwbHksCiAgICBzdHJpbmcgdG9rZW5OYW1lLAogICAgdWludDggZGVjaW1hbFVuaXRzLAogICAgc3RyaW5nIHRva2VuU3ltYm9sLAogICAgYm9vbCB0cmFuc2ZlckFsbFN1cHBseVRvT3duZXIsCiAgICBib29sIF9sb2NrZWQKICAgICkgTG9nZ2VkRVJDMjAoaW5pdGlhbFN1cHBseSwgdG9rZW5OYW1lLCBkZWNpbWFsVW5pdHMsIHRva2VuU3ltYm9sLCB0cmFuc2ZlckFsbFN1cHBseVRvT3duZXIsIF9sb2NrZWQpIHsKCiAgICB9CgogICAgZnVuY3Rpb24gYWRkUmV3YXJkKHVpbnQyNTYgcmVjeWNsZVRpbWUpIHBheWFibGUgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID4gMCk7CgogICAgICAgIHVpbnQyNTYgaWQgPSByZXdhcmRzLmxlbmd0aDsKICAgICAgICB1aW50MjU2IF90b3RhbFN1cHBseSA9IHZhbHVlQXQobG9nZ2VkVG90YWxTdXBwbHksIGJsb2NrLm51bWJlcik7CgogICAgICAgIHJld2FyZHMucHVzaCgKICAgICAgICBSZXdhcmQoCiAgICAgICAgaWQsCiAgICAgICAgYmxvY2subnVtYmVyLAogICAgICAgIG5vdywKICAgICAgICBtc2cudmFsdWUsCiAgICAgICAgMCwKICAgICAgICAwLAogICAgICAgIF90b3RhbFN1cHBseSwKICAgICAgICByZWN5Y2xlVGltZSwKICAgICAgICBmYWxzZQogICAgICAgICkKICAgICAgICApOwoKICAgICAgICBSZXdhcmRUcmFuc2ZlcmVkKGlkLCBtc2cuc2VuZGVyLCBibG9jay5udW1iZXIsIG1zZy52YWx1ZSwgX3RvdGFsU3VwcGx5KTsKICAgIH0KCiAgICBmdW5jdGlvbiBjbGFpbWVkUmV3YXJkSG9vayh1aW50MjU2IHJld2FyZElkLCBhZGRyZXNzIF9hZGRyZXNzLCB1aW50MjU2IGNsYWltZWQpIGludGVybmFsIHsKICAgICAgICBSZXdhcmRDbGFpbWVkKHJld2FyZElkLCBfYWRkcmVzcywgY2xhaW1lZCk7CiAgICB9CgogICAgZnVuY3Rpb24gY2xhaW1SZXdhcmQodWludDI1NiByZXdhcmRJZCkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZihyZXdhcmRzLmxlbmd0aCAtIDEgPCByZXdhcmRJZCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBSZXdhcmQgc3RvcmFnZSByZXdhcmQgPSByZXdhcmRzW3Jld2FyZElkXTsKCiAgICAgICAgaWYocmV3YXJkLmNsYWltZWRbbXNnLnNlbmRlcl0gPT0gdHJ1ZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBpZihyZXdhcmQucmVjeWNsZWQgPT0gdHJ1ZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBpZihub3cgPj0gcmV3YXJkLnRpbWUgKyByZXdhcmQucmVjeWNsZVRpbWUpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdWludDI1NiBiYWxhbmNlID0gdmFsdWVBdChsb2dnZWRCYWxhbmNlc1ttc2cuc2VuZGVyXSwgcmV3YXJkLmJsb2NrKTsKCiAgICAgICAgaWYoYmFsYW5jZSA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHVpbnQyNTYgY2xhaW0gPSBiYWxhbmNlICogcmV3YXJkLmFtb3VudCAvIHJld2FyZC50b3RhbFN1cHBseTsKCiAgICAgICAgcmV3YXJkLmNsYWltZWRbbXNnLnNlbmRlcl0gPSB0cnVlOwoKICAgICAgICByZXdhcmQuY2xhaW1lZEFtb3VudCA9IHJld2FyZC5jbGFpbWVkQW1vdW50ICsgY2xhaW07CgogICAgICAgIGlmIChjbGFpbSA+IDApIHsKICAgICAgICAgICAgY2xhaW1lZFJld2FyZEhvb2socmV3YXJkSWQsIG1zZy5zZW5kZXIsIGNsYWltKTsKCiAgICAgICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoY2xhaW0pOwoKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgZnVuY3Rpb24gY2xhaW1SZXdhcmRzKCkgcHVibGljIHsKICAgICAgICByZXF1aXJlKHJld2FyZHNDbGFpbWVkW21zZy5zZW5kZXJdIDwgcmV3YXJkcy5sZW5ndGgpOwogICAgICAgIGZvciAodWludCBpID0gcmV3YXJkc0NsYWltZWRbbXNnLnNlbmRlcl07IGkgPCByZXdhcmRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmICgocmV3YXJkc1tpXS5jbGFpbWVkW21zZy5zZW5kZXJdID09IGZhbHNlKSAmJiAocmV3YXJkc1tpXS5yZWN5Y2xlZCA9PSBmYWxzZSkpIHsKICAgICAgICAgICAgICAgIHJld2FyZHNDbGFpbWVkW21zZy5zZW5kZXJdID0gaSArIDE7CiAgICAgICAgICAgICAgICBjbGFpbVJld2FyZChpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiByZWN5Y2xlUmV3YXJkKHVpbnQyNTYgcmV3YXJkSWQpIHB1YmxpYyBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgaWYocmV3YXJkcy5sZW5ndGggLSAxIDwgcmV3YXJkSWQpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgUmV3YXJkIHN0b3JhZ2UgcmV3YXJkID0gcmV3YXJkc1tyZXdhcmRJZF07CgogICAgICAgIGlmKHJld2FyZC5yZWN5Y2xlZCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICByZXdhcmQucmVjeWNsZWQgPSB0cnVlOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiByZWZ1bmRVbmNsYWltZWRFdGhlcnModWludDI1NiByZXdhcmRJZCkgcHVibGljIG9ubHlPd25lciByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBpZihyZXdhcmRzLmxlbmd0aCAtIDEgPCByZXdhcmRJZCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBSZXdhcmQgc3RvcmFnZSByZXdhcmQgPSByZXdhcmRzW3Jld2FyZElkXTsKCiAgICAgICAgaWYocmV3YXJkLnJlY3ljbGVkID09IGZhbHNlKSB7CiAgICAgICAgICAgIGlmKG5vdyA8IHJld2FyZC50aW1lICsgcmV3YXJkLnJlY3ljbGVUaW1lKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHVpbnQyNTYgY2xhaW1lZEJhY2tBbW91bnQgPSByZXdhcmQuYW1vdW50IC0gcmV3YXJkLmNsYWltZWRBbW91bnQ7CgogICAgICAgIHJld2FyZC50cmFuc2ZlcmVkQmFjayA9IGNsYWltZWRCYWNrQW1vdW50OwoKICAgICAgICBpZihjbGFpbWVkQmFja0Ftb3VudCA+IDApIHsKICAgICAgICAgICAgb3duZXIudHJhbnNmZXIoY2xhaW1lZEJhY2tBbW91bnQpOwoKICAgICAgICAgICAgVW5jbGFpbWVkUmV3YXJkVHJhbnNmZXIocmV3YXJkSWQsIGNsYWltZWRCYWNrQW1vdW50KTsKCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQp9CgovKgogICAgU21hcnQgY29udHJhY3Qgd2l0aCByZXdhcmQgZnVuY3Rpb25hbGl0eSAmIGVyYzIwIGNvbXBhdGlibGUgaW50ZXJmYWNlCiovCmNvbnRyYWN0IElub25pdCBpcyBMb2dnZWRSZXdhcmQgewogICAgLyogZXZlbnRzICovCiAgICBldmVudCBBZGRyZXNzUmVjb3ZlcmVkKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8pOwogICAgZXZlbnQgSW5hY3Rpdml0eUhvbGRlclJlc2V0QmFsYW5jZShhZGRyZXNzIGluZGV4ZWQgX2hvbGRlcik7CgogICAgZnVuY3Rpb24gSW5vbml0KAogICAgdWludDI1NiBpbml0aWFsU3VwcGx5LAogICAgc3RyaW5nIHN0YW5kYXJkTmFtZSwKICAgIHN0cmluZyB0b2tlbk5hbWUsCiAgICBzdHJpbmcgdG9rZW5TeW1ib2wKICAgICkgTG9nZ2VkUmV3YXJkKGluaXRpYWxTdXBwbHksIHRva2VuTmFtZSwgMTgsIHRva2VuU3ltYm9sLCB0cnVlLCBmYWxzZSkgewogICAgICAgIHN0YW5kYXJkID0gc3RhbmRhcmROYW1lOwogICAgfQoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9hZGRyZXNzKSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgaWYocmV3YXJkcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIFJld2FyZCBzdG9yYWdlIHJld2FyZCA9IHJld2FyZHNbMF07CgogICAgICAgICAgICBpZihyZXdhcmQucmVjeWNsZWQpIHsKICAgICAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZihub3cgPj0gcmV3YXJkLnRpbWUgKyByZXdhcmQucmVjeWNsZVRpbWUpIHsKICAgICAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB1aW50MjU2IGhvbGRlckJhbGFuY2UgPSB2YWx1ZUF0KGxvZ2dlZEJhbGFuY2VzW19hZGRyZXNzXSwgYmxvY2subnVtYmVyKTsKCiAgICAgICAgcmV0dXJuIGhvbGRlckJhbGFuY2U7CiAgICB9CgogICAgZnVuY3Rpb24gY2xhaW1lZFJld2FyZEhvb2sodWludDI1NiByZXdhcmRJZCwgYWRkcmVzcyBfYWRkcmVzcywgdWludDI1NiBjbGFpbWVkKSBpbnRlcm5hbCB7CiAgICAgICAgc2V0QmFsYW5jZShfYWRkcmVzcywgMCk7CgogICAgICAgIHN1cGVyLmNsYWltZWRSZXdhcmRIb29rKHJld2FyZElkLCBfYWRkcmVzcywgY2xhaW1lZCk7CiAgICB9CgogICAgZnVuY3Rpb24gcmVjb3ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bykgb25seU93bmVyIHsKICAgICAgICB1aW50MjU2IHRva2VucyA9IGJhbGFuY2VPZihfZnJvbSk7CgogICAgICAgIHNldEJhbGFuY2UoX2Zyb20sIDApOwogICAgICAgIHNldEJhbGFuY2UoX3RvLCB0b2tlbnMpOwoKICAgICAgICBBZGRyZXNzUmVjb3ZlcmVkKF9mcm9tLCBfdG8pOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldExvY2tlZChib29sIF9sb2NrZWQpIG9ubHlPd25lciB7CiAgICAgICAgbG9ja2VkID0gX2xvY2tlZDsKICAgIH0KfQ=='.
	

]
