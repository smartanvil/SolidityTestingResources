Class {
	#name : #SRTd88b1647f4ece2b2cfd1c06d0ace67b09fe43578,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd88b1647f4ece2b2cfd1c06d0ace67b09fe43578 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCi8qKgogKiBAdGl0bGUgUGF1c2FibGUKICogQGRldiBCYXNlIGNvbnRyYWN0IHdoaWNoIGFsbG93cyBjaGlsZHJlbiB0byBpbXBsZW1lbnQgYW4gZW1lcmdlbmN5IHN0b3AgbWVjaGFuaXNtLgogKi8KY29udHJhY3QgUGF1c2FibGUgaXMgT3duYWJsZSB7CiAgZXZlbnQgUGF1c2UoKTsKICBldmVudCBVbnBhdXNlKCk7CgogIGJvb2wgcHVibGljIHBhdXNlZCA9IGZhbHNlOwoKCiAgLyoqCiAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBub3QgcGF1c2VkLgogICAqLwogIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICByZXF1aXJlKCFwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgcGF1c2VkLgogICAqLwogIG1vZGlmaWVyIHdoZW5QYXVzZWQoKSB7CiAgICByZXF1aXJlKHBhdXNlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHBhdXNlLCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlCiAgICovCiAgZnVuY3Rpb24gcGF1c2UoKSBvbmx5T3duZXIgd2hlbk5vdFBhdXNlZCBwdWJsaWMgewogICAgcGF1c2VkID0gdHJ1ZTsKICAgIFBhdXNlKCk7CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gdW5wYXVzZSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgKi8KICBmdW5jdGlvbiB1bnBhdXNlKCkgb25seU93bmVyIHdoZW5QYXVzZWQgcHVibGljIHsKICAgIHBhdXNlZCA9IGZhbHNlOwogICAgVW5wYXVzZSgpOwogIH0KfQoKCi8qKgogKiBAdGl0bGUgRVJDMjBCYXNpYwogKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE3OQogKi8KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKCmNvbnRyYWN0IERldGFpbGVkRVJDMjAgaXMgRVJDMjAgewogIHN0cmluZyBwdWJsaWMgbmFtZTsKICBzdHJpbmcgcHVibGljIHN5bWJvbDsKICB1aW50OCBwdWJsaWMgZGVjaW1hbHM7CgogIGZ1bmN0aW9uIERldGFpbGVkRVJDMjAoc3RyaW5nIF9uYW1lLCBzdHJpbmcgX3N5bWJvbCwgdWludDggX2RlY2ltYWxzKSBwdWJsaWMgewogICAgbmFtZSA9IF9uYW1lOwogICAgc3ltYm9sID0gX3N5bWJvbDsKICAgIGRlY2ltYWxzID0gX2RlY2ltYWxzOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICB1aW50MjU2IHRvdGFsU3VwcGx5XzsKCiAgLyoqCiAgKiBAZGV2IHRvdGFsIG51bWJlciBvZiB0b2tlbnMgaW4gZXhpc3RlbmNlCiAgKi8KICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiB0b3RhbFN1cHBseV87CiAgfQoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cgp9CgovKioKICogQHRpdGxlIFN0YW5kYXJkIEVSQzIwIHRva2VuCiAqCiAqIEBkZXYgSW1wbGVtZW50YXRpb24gb2YgdGhlIGJhc2ljIHN0YW5kYXJkIHRva2VuLgogKiBAZGV2IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgRmlyc3RCbG9vZDogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sCiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBpbnRlcm5hbCBhbGxvd2VkOwoKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW19mcm9tXSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSk7CgogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICoKICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICogYW5kIHRoZSBuZXcgYWxsb3dhbmNlIGJ5IHVuZm9ydHVuYXRlIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcwogICAqIHJhY2UgY29uZGl0aW9uIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUgYWZ0ZXJ3YXJkczoKICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgKi8KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KCiAgLyoqCiAgICogQGRldiBJbmNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9hZGRlZFZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGluY3JlYXNlIHRoZSBhbGxvd2FuY2UgYnkuCiAgICovCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBEZWNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gZGVjcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zdWJ0cmFjdGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gZGVjcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKi8KICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgfSBlbHNlIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKfQovKioKICogQHRpdGxlIFBhdXNhYmxlIHRva2VuCiAqIEBkZXYgU3RhbmRhcmRUb2tlbiBtb2RpZmllZCB3aXRoIHBhdXNhYmxlIHRyYW5zZmVycy4KICoqLwpjb250cmFjdCBQYXVzYWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIFBhdXNhYmxlIHsKCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLmFwcHJvdmUoX3NwZW5kZXIsIF92YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgcmV0dXJuIHN1cGVyLmluY3JlYXNlQXBwcm92YWwoX3NwZW5kZXIsIF9hZGRlZFZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJldHVybiBzdXBlci5kZWNyZWFzZUFwcHJvdmFsKF9zcGVuZGVyLCBfc3VidHJhY3RlZFZhbHVlKTsKICB9Cn0KCi8qKgogKiBAdGl0bGUgU2FmZUVSQzIwCiAqIEBkZXYgV3JhcHBlcnMgYXJvdW5kIEVSQzIwIG9wZXJhdGlvbnMgdGhhdCB0aHJvdyBvbiBmYWlsdXJlLgogKiBUbyB1c2UgdGhpcyBsaWJyYXJ5IHlvdSBjYW4gYWRkIGEgYHVzaW5nIFNhZmVFUkMyMCBmb3IgRVJDMjA7YCBzdGF0ZW1lbnQgdG8geW91ciBjb250cmFjdCwKICogd2hpY2ggYWxsb3dzIHlvdSB0byBjYWxsIHRoZSBzYWZlIG9wZXJhdGlvbnMgYXMgYHRva2VuLnNhZmVUcmFuc2ZlciguLi4pYCwgZXRjLgogKi8KbGlicmFyeSBTYWZlRVJDMjAgewogIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlcihFUkMyMEJhc2ljIHRva2VuLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBpbnRlcm5hbCB7CiAgICBhc3NlcnQodG9rZW4udHJhbnNmZXIodG8sIHZhbHVlKSk7CiAgfQoKICBmdW5jdGlvbiBzYWZlVHJhbnNmZXJGcm9tKEVSQzIwIHRva2VuLCBhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHsKICAgIGFzc2VydCh0b2tlbi50cmFuc2ZlckZyb20oZnJvbSwgdG8sIHZhbHVlKSk7CiAgfQoKICBmdW5jdGlvbiBzYWZlQXBwcm92ZShFUkMyMCB0b2tlbiwgYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBpbnRlcm5hbCB7CiAgICBhc3NlcnQodG9rZW4uYXBwcm92ZShzcGVuZGVyLCB2YWx1ZSkpOwogIH0KfQoKCi8qKgogKiBAdGl0bGUgVG9rZW5WZXN0aW5nCiAqIEBkZXYgQSB0b2tlbiBob2xkZXIgY29udHJhY3QgdGhhdCBjYW4gcmVsZWFzZSBpdHMgdG9rZW4gYmFsYW5jZSBncmFkdWFsbHkgbGlrZSBhCiAqIHR5cGljYWwgdmVzdGluZyBzY2hlbWUsIHdpdGggYSBjbGlmZiBhbmQgdmVzdGluZyBwZXJpb2QuIE9wdGlvbmFsbHkgcmV2b2NhYmxlIGJ5IHRoZQogKiBvd25lci4KICovCmNvbnRyYWN0IFRva2VuVmVzdGluZyBpcyBPd25hYmxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKICB1c2luZyBTYWZlRVJDMjAgZm9yIEVSQzIwQmFzaWM7CgogIGV2ZW50IFJlbGVhc2VkKHVpbnQyNTYgYW1vdW50KTsKICBldmVudCBSZXZva2VkKCk7CgogIC8vIGJlbmVmaWNpYXJ5IG9mIHRva2VucyBhZnRlciB0aGV5IGFyZSByZWxlYXNlZAogIGFkZHJlc3MgcHVibGljIGJlbmVmaWNpYXJ5OwoKICB1aW50MjU2IHB1YmxpYyBjbGlmZjsKICB1aW50MjU2IHB1YmxpYyBzdGFydDsKICB1aW50MjU2IHB1YmxpYyBkdXJhdGlvbjsKCiAgYm9vbCBwdWJsaWMgcmV2b2NhYmxlOwoKICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyByZWxlYXNlZDsKICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyByZXZva2VkOwoKICAvKioKICAgKiBAZGV2IENyZWF0ZXMgYSB2ZXN0aW5nIGNvbnRyYWN0IHRoYXQgdmVzdHMgaXRzIGJhbGFuY2Ugb2YgYW55IEVSQzIwIHRva2VuIHRvIHRoZQogICAqIF9iZW5lZmljaWFyeSwgZ3JhZHVhbGx5IGluIGEgbGluZWFyIGZhc2hpb24gdW50aWwgX3N0YXJ0ICsgX2R1cmF0aW9uLiBCeSB0aGVuIGFsbAogICAqIG9mIHRoZSBiYWxhbmNlIHdpbGwgaGF2ZSB2ZXN0ZWQuCiAgICogQHBhcmFtIF9iZW5lZmljaWFyeSBhZGRyZXNzIG9mIHRoZSBiZW5lZmljaWFyeSB0byB3aG9tIHZlc3RlZCB0b2tlbnMgYXJlIHRyYW5zZmVycmVkCiAgICogQHBhcmFtIF9jbGlmZiBkdXJhdGlvbiBpbiBzZWNvbmRzIG9mIHRoZSBjbGlmZiBpbiB3aGljaCB0b2tlbnMgd2lsbCBiZWdpbiB0byB2ZXN0CiAgICogQHBhcmFtIF9kdXJhdGlvbiBkdXJhdGlvbiBpbiBzZWNvbmRzIG9mIHRoZSBwZXJpb2QgaW4gd2hpY2ggdGhlIHRva2VucyB3aWxsIHZlc3QKICAgKiBAcGFyYW0gX3Jldm9jYWJsZSB3aGV0aGVyIHRoZSB2ZXN0aW5nIGlzIHJldm9jYWJsZSBvciBub3QKICAgKi8KICBmdW5jdGlvbiBUb2tlblZlc3RpbmcoYWRkcmVzcyBfYmVuZWZpY2lhcnksIHVpbnQyNTYgX3N0YXJ0LCB1aW50MjU2IF9jbGlmZiwgdWludDI1NiBfZHVyYXRpb24sIGJvb2wgX3Jldm9jYWJsZSkgcHVibGljIHsKICAgIHJlcXVpcmUoX2JlbmVmaWNpYXJ5ICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfY2xpZmYgPD0gX2R1cmF0aW9uKTsKCiAgICBiZW5lZmljaWFyeSA9IF9iZW5lZmljaWFyeTsKICAgIHJldm9jYWJsZSA9IF9yZXZvY2FibGU7CiAgICBkdXJhdGlvbiA9IF9kdXJhdGlvbjsKICAgIGNsaWZmID0gX3N0YXJ0LmFkZChfY2xpZmYpOwogICAgc3RhcnQgPSBfc3RhcnQ7CiAgfQoKICAvKioKICAgKiBAbm90aWNlIFRyYW5zZmVycyB2ZXN0ZWQgdG9rZW5zIHRvIGJlbmVmaWNpYXJ5LgogICAqIEBwYXJhbSB0b2tlbiBFUkMyMCB0b2tlbiB3aGljaCBpcyBiZWluZyB2ZXN0ZWQKICAgKi8KICBmdW5jdGlvbiByZWxlYXNlKEVSQzIwQmFzaWMgdG9rZW4pIHB1YmxpYyB7CiAgICB1aW50MjU2IHVucmVsZWFzZWQgPSByZWxlYXNhYmxlQW1vdW50KHRva2VuKTsKCiAgICByZXF1aXJlKHVucmVsZWFzZWQgPiAwKTsKCiAgICByZWxlYXNlZFt0b2tlbl0gPSByZWxlYXNlZFt0b2tlbl0uYWRkKHVucmVsZWFzZWQpOwoKICAgIHRva2VuLnNhZmVUcmFuc2ZlcihiZW5lZmljaWFyeSwgdW5yZWxlYXNlZCk7CgogICAgUmVsZWFzZWQodW5yZWxlYXNlZCk7CiAgfQoKICAvKioKICAgKiBAbm90aWNlIEFsbG93cyB0aGUgb3duZXIgdG8gcmV2b2tlIHRoZSB2ZXN0aW5nLiBUb2tlbnMgYWxyZWFkeSB2ZXN0ZWQKICAgKiByZW1haW4gaW4gdGhlIGNvbnRyYWN0LCB0aGUgcmVzdCBhcmUgcmV0dXJuZWQgdG8gdGhlIG93bmVyLgogICAqIEBwYXJhbSB0b2tlbiBFUkMyMCB0b2tlbiB3aGljaCBpcyBiZWluZyB2ZXN0ZWQKICAgKi8KICBmdW5jdGlvbiByZXZva2UoRVJDMjBCYXNpYyB0b2tlbikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKHJldm9jYWJsZSk7CiAgICByZXF1aXJlKCFyZXZva2VkW3Rva2VuXSk7CgogICAgdWludDI1NiBiYWxhbmNlID0gdG9rZW4uYmFsYW5jZU9mKHRoaXMpOwoKICAgIHVpbnQyNTYgdW5yZWxlYXNlZCA9IHJlbGVhc2FibGVBbW91bnQodG9rZW4pOwogICAgdWludDI1NiByZWZ1bmQgPSBiYWxhbmNlLnN1Yih1bnJlbGVhc2VkKTsKCiAgICByZXZva2VkW3Rva2VuXSA9IHRydWU7CgogICAgdG9rZW4uc2FmZVRyYW5zZmVyKG93bmVyLCByZWZ1bmQpOwoKICAgIFJldm9rZWQoKTsKICB9CgogIC8qKgogICAqIEBkZXYgQ2FsY3VsYXRlcyB0aGUgYW1vdW50IHRoYXQgaGFzIGFscmVhZHkgdmVzdGVkIGJ1dCBoYXNuJ3QgYmVlbiByZWxlYXNlZCB5ZXQuCiAgICogQHBhcmFtIHRva2VuIEVSQzIwIHRva2VuIHdoaWNoIGlzIGJlaW5nIHZlc3RlZAogICAqLwogIGZ1bmN0aW9uIHJlbGVhc2FibGVBbW91bnQoRVJDMjBCYXNpYyB0b2tlbikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIHZlc3RlZEFtb3VudCh0b2tlbikuc3ViKHJlbGVhc2VkW3Rva2VuXSk7CiAgfQoKICAvKioKICAgKiBAZGV2IENhbGN1bGF0ZXMgdGhlIGFtb3VudCB0aGF0IGhhcyBhbHJlYWR5IHZlc3RlZC4KICAgKiBAcGFyYW0gdG9rZW4gRVJDMjAgdG9rZW4gd2hpY2ggaXMgYmVpbmcgdmVzdGVkCiAgICovCiAgZnVuY3Rpb24gdmVzdGVkQW1vdW50KEVSQzIwQmFzaWMgdG9rZW4pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgY3VycmVudEJhbGFuY2UgPSB0b2tlbi5iYWxhbmNlT2YodGhpcyk7CiAgICB1aW50MjU2IHRvdGFsQmFsYW5jZSA9IGN1cnJlbnRCYWxhbmNlLmFkZChyZWxlYXNlZFt0b2tlbl0pOwoKICAgIGlmIChub3cgPCBjbGlmZikgewogICAgICByZXR1cm4gMDsKICAgIH0gZWxzZSBpZiAobm93ID49IHN0YXJ0LmFkZChkdXJhdGlvbikgfHwgcmV2b2tlZFt0b2tlbl0pIHsKICAgICAgcmV0dXJuIHRvdGFsQmFsYW5jZTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB0b3RhbEJhbGFuY2UubXVsKG5vdy5zdWIoc3RhcnQpKS5kaXYoZHVyYXRpb24pOwogICAgfQogIH0KfQoKCi8qKgogICogQHRpdGxlICBSYXRlVG9rZW4KICAqIEBkZXYgUmF0ZSBUb2tlbiBDb250cmFjdCBpbXBsZW1lbnRhdGlvbiAKKi8KY29udHJhY3QgUmF0ZVRva2VuIGlzIE93bmFibGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CiAgICAvL3N0cnVjdCB0aGF0IGhvbGRzIHZhbHVlcyBmb3Igc3BlY2lmaWMgZGlzY291bnQKICAgIHN0cnVjdCBEaXNjb3VudCB7CiAgICAgICAgLy9taW4gbnVtYmVyIG9mIHRva2VucyBleHBlY3RlZCB0byBiZSBib3VnaHQKICAgICAgICB1aW50MjU2IG1pblRva2VuczsKICAgICAgICAvL2Rpc2NvdW50IHBlcmNlbnRhZ2UKICAgICAgICB1aW50MjU2IHBlcmNlbnQ7CiAgICB9CiAgICAvL0Rpc2NvdW50IHBlciBhZGRyZXNzCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gRGlzY291bnQpIHByaXZhdGUgZGlzY291bnRzOwogICAgLy9Ub2tlbiBjb252ZXJzaW9uIHJhdGUKICAgIHVpbnQyNTYgcHVibGljIHJhdGU7CgogICAvKioKICAgICogQGRldiBFdmVudCB3aGljaCBpcyBmaXJlZCB3aGVuIFJhdGUgaXMgc2V0CiAgICAqLwogICAgZXZlbnQgUmF0ZVNldCh1aW50MjU2IHJhdGUpOwoKICAgCiAgICBmdW5jdGlvbiBSYXRlVG9rZW4odWludDI1NiBfaW5pdGlhbFJhdGUpIHB1YmxpYyB7CiAgICAgICAgc2V0UmF0ZShfaW5pdGlhbFJhdGUpOwogICAgfQoKICAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0aGF0IHNldHMgdGhlIGNvbnZlcnNpb24gcmF0ZQogICAqIEBwYXJhbSBfcmF0ZUluV2VpIFRoZSBhbW91bnQgb2YgcmF0ZSB0byBiZSBzZXQKICAgICovCiAgICBmdW5jdGlvbiBzZXRSYXRlKHVpbnQgX3JhdGVJbldlaSkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfcmF0ZUluV2VpID4gMCk7CiAgICAgICAgcmF0ZSA9IF9yYXRlSW5XZWk7CiAgICAgICAgUmF0ZVNldChyYXRlKTsKICAgIH0KCiAgIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gZm9yIGFkZGluZyBkaXNjb3VudCBmb3IgY29uY3JldGUgYnV5ZXIsIG9ubHkgYXZhaWxhYmxlIGZvciB0aGUgb3duZXIuICAKICAgKiBAcGFyYW0gX2J1eWVyIFRoZSBhZGRyZXNzIG9mIHRoZSBidXllci4KICAgKiBAcGFyYW0gX21pblRva2VucyBUaGUgYW1vdW50IG9mIHRva2Vucy4KICAgKiBAcGFyYW0gX3BlcmNlbnQgVGhlIGFtb3VudCBvZiBkaXNjb3VudCBpbiBwZXJjZW50cy4KICAgKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAgKi8KICAgIAogICAgLy8gTk9URSBGUk9NIEJMT0NLRVJBIC0gUEVSQ0VOVEFHRSBDT1VMRCBCRSBVSU5UOCAoMCAtIDI1NSkKICAgIGZ1bmN0aW9uIGFkZERpc2NvdW50KGFkZHJlc3MgX2J1eWVyLCB1aW50MjU2IF9taW5Ub2tlbnMsIHVpbnQyNTYgX3BlcmNlbnQpIHB1YmxpYyBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgeyAKICAgICAgICByZXF1aXJlKF9idXllciAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF9taW5Ub2tlbnMgPiAwKTsKICAgICAgICByZXF1aXJlKF9wZXJjZW50ID4gMCk7CiAgICAgICAgcmVxdWlyZShfcGVyY2VudCA8IDEwMCk7CiAgICAgICAgRGlzY291bnQgbWVtb3J5IGRpc2NvdW50OwogICAgICAgIGRpc2NvdW50Lm1pblRva2VucyA9IF9taW5Ub2tlbnM7CiAgICAgICAgZGlzY291bnQucGVyY2VudCA9IF9wZXJjZW50OwogICAgICAgIGRpc2NvdW50c1tfYnV5ZXJdID0gZGlzY291bnQ7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHJlbW92ZSBkaXNjb3VudC4KICAgKiBAcGFyYW0gX2J1eWVyIFRoZSBhZGRyZXNzIHRvIHJlbW92ZSB0aGUgZGlzY291bnQgZnJvbS4KICAgKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogICAgZnVuY3Rpb24gcmVtb3ZlRGlzY291bnQoYWRkcmVzcyBfYnV5ZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoX2J1eWVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlbW92ZUV4aXN0aW5nRGlzY291bnQoX2J1eWVyKTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBQdWJsaWMgRnVuY3Rpb24gdGhhdCBjYWxjdWxhdGVzIHRoZSBhbW91bnQgaW4gd2VpIGZvciBzcGVjaWZpYyBudW1iZXIgb2YgdG9rZW5zCiAgICAqIEBwYXJhbSBfYnV5ZXIgYWRkcmVzcy4KICAgICogQHBhcmFtIF90b2tlbnMgVGhlIGFtb3VudCBvZiB0b2tlbnMuCiAgICAqIEByZXR1cm4gdWludDI1NiB0aGUgcHJpY2UgZm9yIHRva2VucyBpbiB3ZWkuCiAgICAqLwogICAgZnVuY3Rpb24gY2FsY3VsYXRlV2VpTmVlZGVkKGFkZHJlc3MgX2J1eWVyLCB1aW50IF90b2tlbnMpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXF1aXJlKF9idXllciAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF90b2tlbnMgPiAwKTsKCiAgICAgICAgRGlzY291bnQgbWVtb3J5IGRpc2NvdW50ID0gZGlzY291bnRzW19idXllcl07CiAgICAgICAgcmVxdWlyZShfdG9rZW5zID49IGRpc2NvdW50Lm1pblRva2Vucyk7CiAgICAgICAgaWYgKGRpc2NvdW50Lm1pblRva2VucyA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBfdG9rZW5zLmRpdihyYXRlKTsKICAgICAgICB9CgogICAgICAgIHVpbnQyNTYgY29zdE9mVG9rZW5zTm9ybWFsbHkgPSBfdG9rZW5zLmRpdihyYXRlKTsKICAgICAgICByZXR1cm4gY29zdE9mVG9rZW5zTm9ybWFsbHkubXVsKDEwMCAtIGRpc2NvdW50LnBlcmNlbnQpLmRpdigxMDApOwoKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBAZGV2IFJlbW92ZXMgZGlzY291bnQgZm9yIGNvbmNyZXRlIGJ1eWVyLgogICAgICogQHBhcmFtIF9idXllciB0aGUgYWRkcmVzcyBmb3Igd2hpY2ggdGhlIGRpc2NvdW50IHdpbGwgYmUgcmVtb3ZlZC4KICAgICAqLwogICAgZnVuY3Rpb24gcmVtb3ZlRXhpc3RpbmdEaXNjb3VudChhZGRyZXNzIF9idXllcikgaW50ZXJuYWwgewogICAgICAgIGRlbGV0ZShkaXNjb3VudHNbX2J1eWVyXSk7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgRnVuY3Rpb24gdGhhdCBjb252ZXJ0cyB3ZWkgaW50byB0b2tlbnMuCiAgICAqIEBwYXJhbSBfYnV5ZXIgYWRkcmVzcyBvZiB0aGUgYnV5ZXIuCiAgICAqIEBwYXJhbSBfYnV5ZXJBbW91bnRJbldlaSBhbW91bnQgb2YgZXRoZXIgaW4gd2VpLiAKICAgICogQHJldHVybiB1aW50MjU2IHZhbHVlIG9mIHRoZSBjYWxjdWxhdGVkIHRva2Vucy4KICAgICovCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVUb2tlbnMoYWRkcmVzcyBfYnV5ZXIsIHVpbnQyNTYgX2J1eWVyQW1vdW50SW5XZWkpIGludGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIERpc2NvdW50IG1lbW9yeSBkaXNjb3VudCA9IGRpc2NvdW50c1tfYnV5ZXJdOwogICAgICAgIGlmIChkaXNjb3VudC5taW5Ub2tlbnMgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gX2J1eWVyQW1vdW50SW5XZWkubXVsKHJhdGUpOwogICAgICAgIH0KCiAgICAgICAgdWludDI1NiBub3JtYWxUb2tlbnMgPSBfYnV5ZXJBbW91bnRJbldlaS5tdWwocmF0ZSk7CiAgICAgICAgdWludDI1NiBkaXNjb3VudEJvbnVzID0gbm9ybWFsVG9rZW5zLm11bChkaXNjb3VudC5wZXJjZW50KS5kaXYoMTAwKTsKICAgICAgICB1aW50MjU2IHRva2VucyA9IG5vcm1hbFRva2VucyArIGRpc2NvdW50Qm9udXM7CiAgICAgICAgcmVxdWlyZSh0b2tlbnMgPj0gZGlzY291bnQubWluVG9rZW5zKTsKICAgICAgICByZXR1cm4gdG9rZW5zOwogICAgfSAgCn0KCgoKLyoqCiAqIEB0aXRsZSBDYWVydXMgdG9rZW4uCiAqIEBkZXYgSW1wbGVtZW50YXRpb24gb2YgdGhlIENhZXJ1cyB0b2tlbi4KICovCmNvbnRyYWN0IENhZXJ1c1Rva2VuIGlzIFJhdGVUb2tlbiwgUGF1c2FibGVUb2tlbiwgRGV0YWlsZWRFUkMyMCB7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBjb250cmlidXRpb25zOwogICAgdWludDI1NiBwdWJsaWMgdG9rZW5Tb2xkID0gMDsgCiAgICB1aW50MjU2IHB1YmxpYyB3ZWlSYWlzZWQgPSAwOyAKICAgIGFkZHJlc3MgdHJhbnNmZXJBZGRyZXNzOwogICAgCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IFRva2VuVmVzdGluZykgcHVibGljIHZlc3RlZFRva2VuczsKCiAgICBldmVudCBUb2tlbnNCb3VnaHQoYWRkcmVzcyBpbmRleGVkIGJ1eWVyLCB1aW50MjU2IHRva2Vucyk7CiAgICBldmVudCBDb250cmlidXRpb24oYWRkcmVzcyBpbmRleGVkIGJ1eWVyLCB1aW50MjU2IGFtb3VudEluV2VpKTsKICAgIGV2ZW50IFZlc3RlZFRva2VuQ3JlYXRlZChhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgZHVyYXRpb24sIHVpbnQyNTYgdG9rZW5zKTsKICAgIGV2ZW50IFRva2Vuc1NwZW50KGFkZHJlc3MgaW5kZXhlZCB0b2tlbnNIb2xkZXIsIHVpbnQyNTYgdG9rZW5zKTsKCiAgICBmdW5jdGlvbiBDYWVydXNUb2tlbihhZGRyZXNzIF90cmFuc2ZlckFkZHJlc3MsIHVpbnQgX2luaXRpYWxSYXRlKSBwdWJsaWMgUmF0ZVRva2VuKF9pbml0aWFsUmF0ZSkgRGV0YWlsZWRFUkMyMCgiQ2FlcnVzIFRva2VuIiwgIkNBRVIiLCAxOCkgewogICAgICAgIHRvdGFsU3VwcGx5XyA9IDczMDAwMDAwICogMTAgKiogMTg7CiAgICAgICAgdHJhbnNmZXJBZGRyZXNzID0gX3RyYW5zZmVyQWRkcmVzczsKICAgICAgICBiYWxhbmNlc1tvd25lcl0gPSB0b3RhbFN1cHBseV87CiAgCX0KICAgIC8qKgogICAgKiBAZGV2IFNldHMgdGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgZnVuZHMuCiAgICAqIEBwYXJhbSBfdHJhbnNmZXJBZGRyZXNzIEFuIGFkZHJlc3MgdG8gdHJhbnNmZXIgZnVuZHMuCiAgICAqLwogICAgZnVuY3Rpb24gc2V0VHJhbnNmZXJBZGRyZXNzKGFkZHJlc3MgX3RyYW5zZmVyQWRkcmVzcykgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgdHJhbnNmZXJBZGRyZXNzID0gX3RyYW5zZmVyQWRkcmVzczsKICAgIH0KICAgIC8qKgogICAgKiBAZGV2IEZhbGxiYWNrIGZ1bmN0aW9uIHdoZW4gcmVjZWl2aW5nIEV0aGVyLgogICAgKi8KICAgIGZ1bmN0aW9uKCkgcGF5YWJsZSBwdWJsaWMgewogICAgICAgIGJ1eVRva2VucygpOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEFsbG93IGFkZHJlc3NlcyB0byBidXkgdG9rZW5zLgogICAgKi8KICAgIGZ1bmN0aW9uIGJ1eVRva2VucygpIHBheWFibGUgcHVibGljIHdoZW5Ob3RQYXVzZWQgewogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID4gMCk7CiAgICAgICAgCiAgICAgICAgdWludDI1NiB0b2tlbnMgPSBjYWxjdWxhdGVUb2tlbnMobXNnLnNlbmRlciwgbXNnLnZhbHVlKTsKICAgICAgICB0cmFuc2ZlclRva2Vucyhvd25lciwgbXNnLnNlbmRlciwgdG9rZW5zKTsKCiAgICAgICAgbWFya1Rva2VuU29sZCh0b2tlbnMpOwogICAgICAgIG1hcmtDb250cmlidXRpb24oKTsKICAgICAgICByZW1vdmVFeGlzdGluZ0Rpc2NvdW50KG1zZy5zZW5kZXIpOwogICAgICAgIHRyYW5zZmVyQWRkcmVzcy50cmFuc2Zlcihtc2cudmFsdWUpOwogICAgICAgIFRva2Vuc0JvdWdodChtc2cuc2VuZGVyLCB0b2tlbnMpOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG93bmVyIHRvIHNwZWNpZmljIGFkZHJlc3MsIGF2YWlsYWJsZSBvbmx5IGZvciB0aGUgb3duZXIuCiAgICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgd2hlcmUgdG9rZW5zIGFyZSB0cmFuc2ZlcmVkLgogICAgKiBAcGFyYW0gX3Rva2VucyBBbW91bnQgb2YgdG9rZW5zIHRoYXQgbmVlZCB0byBiZSB0cmFuc2ZlcmVkLgogICAgKiBAcmV0dXJuIEJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSBzdWNjZXNzZnVsIGV4ZWN1dGlvbiBvZiB0aGUgZnVuY3Rpb24uCiAgICAqLwogICAgLy8gT3duZXIgY291bGQgdXNlIHJlZ3VsYXIgdHJhbnNmZXIgbWV0aG9kIGlmIHRoZXkgd2FudGVkIHRvCiAgICBmdW5jdGlvbiBtYXJrVHJhbnNmZXJUb2tlbnMoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2Vucykgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CgogICAgICAgIHRyYW5zZmVyVG9rZW5zKG93bmVyLCBfdG8sIF90b2tlbnMpOwogICAgICAgIG1hcmtUb2tlblNvbGQoX3Rva2Vucyk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICogQGRldiBDcmVhdGVzIGEgdmVzdGluZyBjb250cmFjdCB0aGF0IHZlc3RzIGl0cyBiYWxhbmNlIG9mIGFueSBFUkMyMCB0b2tlbiB0byB0aGUKICAgKiBfYmVuZWZpY2lhcnksIGdyYWR1YWxseSBpbiBhIGxpbmVhciBmYXNoaW9uIHVudGlsIF9zdGFydCArIF9kdXJhdGlvbi4gQnkgdGhlbiBhbGwKICAgKiBvZiB0aGUgYmFsYW5jZSB3aWxsIGhhdmUgdmVzdGVkLgogICAqIEBwYXJhbSBfYmVuZWZpY2lhcnkgYWRkcmVzcyBvZiB0aGUgYmVuZWZpY2lhcnkgdG8gd2hvbSB2ZXN0ZWQgdG9rZW5zIGFyZSB0cmFuc2ZlcnJlZC4KICAgKiBAcGFyYW0gX3N0YXJ0IHRpbWUgd2hlbiB2ZXN0aW5nIHN0YXJ0cy4KICAgKiBAcGFyYW0gX2NsaWZmIGR1cmF0aW9uIGluIHNlY29uZHMgb2YgdGhlIGNsaWZmIGluIHdoaWNoIHRva2VucyB3aWxsIGJlZ2luIHRvIHZlc3QuCiAgICogQHBhcmFtIF9kdXJhdGlvbiBkdXJhdGlvbiBpbiBzZWNvbmRzIG9mIHRoZSBwZXJpb2QgaW4gd2hpY2ggdGhlIHRva2VucyB3aWxsIHZlc3QuCiAgICogQHBhcmFtIF90b2tlbnMgQW1vdW50IG9mIHRva2VucyB0aGF0IG5lZWQgdG8gYmUgdmVzdGVkLgogICAqIEByZXR1cm4gQm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHN1Y2Nlc3NmdWwgZXhlY3V0aW9uIG9mIHRoZSBmdW5jdGlvbi4KICAgKi8KICAgIGZ1bmN0aW9uIGNyZWF0ZVZlc3RlZFRva2VuKGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCB1aW50MjU2IF9zdGFydCwgdWludDI1NiBfY2xpZmYsIHVpbnQyNTYgX2R1cmF0aW9uLCB1aW50MjU2IF90b2tlbnMpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIFRva2VuVmVzdGluZyB2ZXN0ZWRUb2tlbiA9IG5ldyBUb2tlblZlc3RpbmcoX2JlbmVmaWNpYXJ5LCBfc3RhcnQsIF9jbGlmZiwgX2R1cmF0aW9uLCBmYWxzZSk7CiAgICAgICAgdmVzdGVkVG9rZW5zW19iZW5lZmljaWFyeV0gPSB2ZXN0ZWRUb2tlbjsKICAgICAgICBhZGRyZXNzIHZlc3RlZEFkZHJlc3MgPSBhZGRyZXNzKHZlc3RlZFRva2VuKTsKICAgICAgICB0cmFuc2ZlclRva2Vucyhvd25lciwgdmVzdGVkQWRkcmVzcywgX3Rva2Vucyk7CiAgICAgICAgVmVzdGVkVG9rZW5DcmVhdGVkKF9iZW5lZmljaWFyeSwgX2R1cmF0aW9uLCBfdG9rZW5zKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBhZGRyZXNzIHRvIG93bmVyIGFkZHJlc3MuCiAgICAqIEBwYXJhbSBfdG9rZW5zIEFtb3VudCBvZiB0b2tlbnMgdGhhdCBuZWVkIHRvIGJlIHRyYW5zZmVyZWQuCiAgICAqIEByZXR1cm4gQm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHN1Y2Nlc3NmdWwgZXhlY3V0aW9uIG9mIHRoZSBmdW5jdGlvbi4KICAgICovCiAgICBmdW5jdGlvbiBzcGVuZFRva2VuKHVpbnQyNTYgX3Rva2VucykgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICB0cmFuc2ZlclRva2Vucyhtc2cuc2VuZGVyLCBvd25lciwgX3Rva2Vucyk7CiAgICAgICAgVG9rZW5zU3BlbnQobXNnLnNlbmRlciwgX3Rva2Vucyk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICAqIEByZXR1cm4gQm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHN1Y2Nlc3NmdWwgZXhlY3V0aW9uIG9mIHRoZSBmdW5jdGlvbi4KICAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIC8vICBUbyBjaGFuZ2UgdGhlIGFwcHJvdmUgYW1vdW50IHlvdSBmaXJzdCBoYXZlIHRvIHJlZHVjZSB0aGUgYWRkcmVzc2VzYAogICAgICAgIC8vICBhbGxvd2FuY2UgdG8gemVybyBieSBjYWxsaW5nIGBhcHByb3ZlKF9zcGVuZGVyLCAwKWAgaWYgaXQgaXMgbm90CiAgICAgICAgLy8gIGFscmVhZHkgMCB0byBtaXRpZ2F0ZSB0aGUgcmFjZSBjb25kaXRpb24gZGVzY3JpYmVkIGhlcmU6CiAgICAgICAgLy8gIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPT0gMCB8fCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9PSAwKTsKCiAgICAgICAgcmV0dXJuIHN1cGVyLmFwcHJvdmUoX3NwZW5kZXIsIF92YWx1ZSk7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlci4KICAgICogQHBhcmFtIF9mcm9tIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20uCiAgICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8uCiAgICAqIEBwYXJhbSBfdG9rZW5zIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkLgogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyVG9rZW5zKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbnMpIHByaXZhdGUgewogICAgICAgIHJlcXVpcmUoX3Rva2VucyA+IDApOwogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbX2Zyb21dID49IF90b2tlbnMpOwogICAgICAgIAogICAgICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3Rva2Vucyk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF90b2tlbnMpOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbnMpOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEFkZHMgb3IgdXBkYXRlcyBjb250cmlidXRpb25zCiAgICAqLwogICAgZnVuY3Rpb24gbWFya0NvbnRyaWJ1dGlvbigpIHByaXZhdGUgewogICAgICAgIGNvbnRyaWJ1dGlvbnNbbXNnLnNlbmRlcl0gPSBjb250cmlidXRpb25zW21zZy5zZW5kZXJdLmFkZChtc2cudmFsdWUpOwogICAgICAgIHdlaVJhaXNlZCA9IHdlaVJhaXNlZC5hZGQobXNnLnZhbHVlKTsKICAgICAgICBDb250cmlidXRpb24obXNnLnNlbmRlciwgbXNnLnZhbHVlKTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBJbmNyZWFzZSB0b2tlbiBzb2xkIGFtb3VudC4KICAgICogQHBhcmFtIF90b2tlbnMgQW1vdW50IG9mIHRva2VucyB0aGF0IGFyZSBzb2xkLgogICAgKi8KICAgIGZ1bmN0aW9uIG1hcmtUb2tlblNvbGQodWludDI1NiBfdG9rZW5zKSBwcml2YXRlIHsKICAgICAgICB0b2tlblNvbGQgPSB0b2tlblNvbGQuYWRkKF90b2tlbnMpOwogICAgfQogICAgCiAgICAvKioKICAgICogQGRldiBPd25lciBjYW4gdHJhbnNmZXIgb3V0IGFueSBhY2NpZGVudGFsbHkgc2VudCBDYWVydXMgdG9rZW5zLgogICAgKiBAcGFyYW0gX3Rva2VuQWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tLgogICAgKiBAcGFyYW0gX3Rva2VucyB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZC4KICAgICovICAgIAogICAgZnVuY3Rpb24gdHJhbnNmZXJBbnlDYWVydXNUb2tlbihhZGRyZXNzIF90b2tlbkFkZHJlc3MsIHVpbnQgX3Rva2VucykgcHVibGljIG9ubHlPd25lciByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICB0cmFuc2ZlclRva2VucyhfdG9rZW5BZGRyZXNzLCBvd25lciwgX3Rva2Vucyk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0='.
	

]
