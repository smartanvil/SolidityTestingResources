Class {
	#name : #SRTd571788859897023b500c6c7fd295bba1e7ff71c,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd571788859897023b500c6c7fd295bba1e7ff71c >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7IC8vIHNvbGhpbnQtZGlzYWJsZS1saW5lCgoKCi8vLyBAdGl0bGUgSW50ZXJmYWNlIGZvciBjb250cmFjdHMgY29uZm9ybWluZyB0byBFUkMtNzIxOiBOb24tRnVuZ2libGUgVG9rZW5zCi8vLyBAYXV0aG9yIERpZXRlciBTaGlybGV5IDw8YSBocmVmPSIvY2RuLWNnaS9sL2VtYWlsLXByb3RlY3Rpb24iIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iOWFmZWZmZWVmZmRhZmJlMmYzZjVmN2UwZmZmNGI0ZjlmNSI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvYT4+IChodHRwczovL2dpdGh1Yi5jb20vZGV0ZSkKY29udHJhY3QgRVJDNzIxIHsKICAgIC8vIFJlcXVpcmVkIG1ldGhvZHMKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKICAgIGZ1bmN0aW9uIGltcGxlbWVudHNFUkM3MjEoKSBwdWJsaWMgcHVyZSByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBhZGRyKTsKICAgIGZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JZCkgcHVibGljOwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHRvdGFsKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYzsKCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHRva2VuSWQpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgYXBwcm92ZWQsIHVpbnQyNTYgdG9rZW5JZCk7CgogICAgLy8gT3B0aW9uYWwKICAgIC8vIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcgbmFtZSk7CiAgICAvLyBmdW5jdGlvbiBzeW1ib2woKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcgc3ltYm9sKTsKICAgIC8vIGZ1bmN0aW9uIHRva2VuT2ZPd25lckJ5SW5kZXgoYWRkcmVzcyBfb3duZXIsIHVpbnQyNTYgX2luZGV4KSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYgdG9rZW5JZCk7CiAgICAvLyBmdW5jdGlvbiB0b2tlbk1ldGFkYXRhKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZyBpbmZvVXJsKTsKfQoKCmNvbnRyYWN0IFNwb3J0U3RhclRva2VuIGlzIEVSQzcyMSB7CgogICAgLy8gKioqKiogRVZFTlRTCgogICAgLy8gQGRldiBUcmFuc2ZlciBldmVudCBhcyBkZWZpbmVkIGluIGN1cnJlbnQgZHJhZnQgb2YgRVJDNzIxLgogICAgLy8gIG93bmVyc2hpcCBpcyBhc3NpZ25lZCwgaW5jbHVkaW5nIGJpcnRocy4KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB0b2tlbklkKTsKCgoKICAgIC8vICoqKioqIFNUT1JBR0UKCiAgICAvLyBAZGV2IEEgbWFwcGluZyBmcm9tIHRva2VuIElEcyB0byB0aGUgYWRkcmVzcyB0aGF0IG93bnMgdGhlbS4gQWxsIHRva2VucyBoYXZlCiAgICAvLyAgc29tZSB2YWxpZCBvd25lciBhZGRyZXNzLgogICAgbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSBwdWJsaWMgdG9rZW5JbmRleFRvT3duZXI7CgogICAgLy8gQGRldiBBIG1hcHBpbmcgZnJvbSBvd25lciBhZGRyZXNzIHRvIGNvdW50IG9mIHRva2VucyB0aGF0IGFkZHJlc3Mgb3ducy4KICAgIC8vICBVc2VkIGludGVybmFsbHkgaW5zaWRlIGJhbGFuY2VPZigpIHRvIHJlc29sdmUgb3duZXJzaGlwIGNvdW50LgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwcml2YXRlIG93bmVyc2hpcFRva2VuQ291bnQ7CgogICAgLy8gQGRldiBBIG1hcHBpbmcgZnJvbSBUb2tlbklEcyB0byBhbiBhZGRyZXNzIHRoYXQgaGFzIGJlZW4gYXBwcm92ZWQgdG8gY2FsbAogICAgLy8gIHRyYW5zZmVyRnJvbSgpLiBFYWNoIFRva2VuIGNhbiBvbmx5IGhhdmUgb25lIGFwcHJvdmVkIGFkZHJlc3MgZm9yIHRyYW5zZmVyCiAgICAvLyAgYXQgYW55IHRpbWUuIEEgemVybyB2YWx1ZSBtZWFucyBubyBhcHByb3ZhbCBpcyBvdXRzdGFuZGluZy4KICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgcHVibGljIHRva2VuSW5kZXhUb0FwcHJvdmVkOwoKICAgIC8vIEFkZGl0aW9uYWwgdG9rZW4gZGF0YQogICAgbWFwcGluZyAodWludDI1NiA9PiBieXRlczMyKSBwdWJsaWMgdG9rZW5JbmRleFRvRGF0YTsKCiAgICBhZGRyZXNzIHB1YmxpYyBjZW9BZGRyZXNzOwogICAgYWRkcmVzcyBwdWJsaWMgbWFzdGVyQ29udHJhY3RBZGRyZXNzOwoKICAgIHVpbnQyNTYgcHVibGljIHByb21vQ3JlYXRlZENvdW50OwoKCgogICAgLy8gKioqKiogREFUQVRZUEVTCgogICAgc3RydWN0IFRva2VuIHsKICAgICAgICBzdHJpbmcgbmFtZTsKICAgIH0KCiAgICBUb2tlbltdIHByaXZhdGUgdG9rZW5zOwoKCgogICAgLy8gKioqKiogQUNDRVNTIE1PRElGSUVSUwoKICAgIG1vZGlmaWVyIG9ubHlDRU8oKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNlb0FkZHJlc3MpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seU1hc3RlckNvbnRyYWN0KCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBtYXN0ZXJDb250cmFjdEFkZHJlc3MpOwogICAgICAgIF87CiAgICB9CgoKCiAgICAvLyAqKioqKiBDT05TVFJVQ1RPUgoKICAgIGZ1bmN0aW9uIFNwb3J0U3RhclRva2VuKCkgcHVibGljIHsKICAgICAgICBjZW9BZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgIH0KCgoKICAgIC8vICoqKioqIFBSSVZJTEVHRVMgU0VUVElORyBGVU5DVElPTlMKCiAgICBmdW5jdGlvbiBzZXRDRU8oYWRkcmVzcyBfbmV3Q0VPKSBwdWJsaWMgb25seUNFTyB7CiAgICAgICAgcmVxdWlyZShfbmV3Q0VPICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICBjZW9BZGRyZXNzID0gX25ld0NFTzsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRNYXN0ZXJDb250cmFjdChhZGRyZXNzIF9uZXdNYXN0ZXJDb250cmFjdCkgcHVibGljIG9ubHlDRU8gewogICAgICAgIHJlcXVpcmUoX25ld01hc3RlckNvbnRyYWN0ICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICBtYXN0ZXJDb250cmFjdEFkZHJlc3MgPSBfbmV3TWFzdGVyQ29udHJhY3Q7CiAgICB9CgoKCiAgICAvLyAqKioqKiBQVUJMSUMgRlVOQ1RJT05TCgogICAgLy8gQG5vdGljZSBSZXR1cm5zIGFsbCB0aGUgcmVsZXZhbnQgaW5mb3JtYXRpb24gYWJvdXQgYSBzcGVjaWZpYyB0b2tlbi4KICAgIC8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgdG9rZW5JZCBvZiB0aGUgdG9rZW4gb2YgaW50ZXJlc3QuCiAgICBmdW5jdGlvbiBnZXRUb2tlbih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zICgKICAgICAgICBzdHJpbmcgdG9rZW5OYW1lLAogICAgICAgIGFkZHJlc3Mgb3duZXIKICAgICkgewogICAgICAgIFRva2VuIHN0b3JhZ2UgdG9rZW4gPSB0b2tlbnNbX3Rva2VuSWRdOwogICAgICAgIHRva2VuTmFtZSA9IHRva2VuLm5hbWU7CiAgICAgICAgb3duZXIgPSB0b2tlbkluZGV4VG9Pd25lcltfdG9rZW5JZF07CiAgICB9CgogICAgLy8gQHBhcmFtIF9vd25lciBUaGUgb3duZXIgd2hvc2Ugc3BvcnQgc3RhciB0b2tlbnMgd2UgYXJlIGludGVyZXN0ZWQgaW4uCiAgICAvLyBAZGV2IFRoaXMgbWV0aG9kIE1VU1QgTkVWRVIgYmUgY2FsbGVkIGJ5IHNtYXJ0IGNvbnRyYWN0IGNvZGUuIEZpcnN0LCBpdCdzIGZhaXJseQogICAgLy8gIGV4cGVuc2l2ZSAoaXQgd2Fsa3MgdGhlIGVudGlyZSBUb2tlbnMgYXJyYXkgbG9va2luZyBmb3IgdG9rZW5zIGJlbG9uZ2luZyB0byBvd25lciksCiAgICAvLyAgYnV0IGl0IGFsc28gcmV0dXJucyBhIGR5bmFtaWMgYXJyYXksIHdoaWNoIGlzIG9ubHkgc3VwcG9ydGVkIGZvciB3ZWIzIGNhbGxzLCBhbmQKICAgIC8vICBub3QgY29udHJhY3QtdG8tY29udHJhY3QgY2FsbHMuCiAgICBmdW5jdGlvbiB0b2tlbnNPZk93bmVyKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2W10gb3duZXJUb2tlbnMpIHsKICAgICAgICB1aW50MjU2IHRva2VuQ291bnQgPSBiYWxhbmNlT2YoX293bmVyKTsKICAgICAgICBpZiAodG9rZW5Db3VudCA9PSAwKSB7CiAgICAgICAgICAgIC8vIFJldHVybiBhbiBlbXB0eSBhcnJheQogICAgICAgICAgICByZXR1cm4gbmV3IHVpbnQyNTZbXSgwKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB1aW50MjU2W10gbWVtb3J5IHJlc3VsdCA9IG5ldyB1aW50MjU2W10odG9rZW5Db3VudCk7CiAgICAgICAgICAgIHVpbnQyNTYgdG90YWxUb2tlbnMgPSB0b3RhbFN1cHBseSgpOwogICAgICAgICAgICB1aW50MjU2IHJlc3VsdEluZGV4ID0gMDsKCiAgICAgICAgICAgIHVpbnQyNTYgdG9rZW5JZDsKICAgICAgICAgICAgZm9yICh0b2tlbklkID0gMDsgdG9rZW5JZCA8PSB0b3RhbFRva2VuczsgdG9rZW5JZCsrKSB7CiAgICAgICAgICAgICAgICBpZiAodG9rZW5JbmRleFRvT3duZXJbdG9rZW5JZF0gPT0gX293bmVyKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3Jlc3VsdEluZGV4XSA9IHRva2VuSWQ7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0SW5kZXgrKzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBnZXRUb2tlbkRhdGEodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYnl0ZXMzMiB0b2tlbkRhdGEpIHsKICAgICAgICByZXR1cm4gdG9rZW5JbmRleFRvRGF0YVtfdG9rZW5JZF07CiAgICB9CgoKCiAgICAvLyAqKioqKiBFUkMtNzIxIEZVTkNUSU9OUwoKICAgIC8vIEBub3RpY2UgR3JhbnQgYW5vdGhlciBhZGRyZXNzIHRoZSByaWdodCB0byB0cmFuc2ZlciB0b2tlbiB2aWEgdGFrZU93bmVyc2hpcCgpIGFuZCB0cmFuc2ZlckZyb20oKS4KICAgIC8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gYmUgZ3JhbnRlZCB0cmFuc2ZlciBhcHByb3ZhbC4gUGFzcyBhZGRyZXNzKDApIHRvCiAgICAvLyAgY2xlYXIgYWxsIGFwcHJvdmFscy4KICAgIC8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgSUQgb2YgdGhlIFRva2VuIHRoYXQgY2FuIGJlIHRyYW5zZmVycmVkIGlmIHRoaXMgY2FsbCBzdWNjZWVkcy4KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB7CiAgICAgICAgLy8gQ2FsbGVyIG11c3Qgb3duIHRva2VuLgogICAgICAgIHJlcXVpcmUoX293bnMobXNnLnNlbmRlciwgX3Rva2VuSWQpKTsKCiAgICAgICAgdG9rZW5JbmRleFRvQXBwcm92ZWRbX3Rva2VuSWRdID0gX3RvOwoKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfdG8sIF90b2tlbklkKTsKICAgIH0KCiAgICAvLyBGb3IgcXVlcnlpbmcgYmFsYW5jZSBvZiBhIHBhcnRpY3VsYXIgYWNjb3VudAogICAgLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBmb3IgYmFsYW5jZSBxdWVyeQogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gb3duZXJzaGlwVG9rZW5Db3VudFtfb3duZXJdOwogICAgfQoKICAgIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgcHVyZSByZXR1cm5zIChzdHJpbmcpIHsKICAgICAgICByZXR1cm4gIkNyeXB0b1Nwb3J0U3RhcnMiOwogICAgfQoKICAgIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyBwdXJlIHJldHVybnMgKHN0cmluZykgewogICAgICAgIHJldHVybiAiU3BvcnRTdGFyVG9rZW4iOwogICAgfQoKICAgIGZ1bmN0aW9uIGltcGxlbWVudHNFUkM3MjEoKSBwdWJsaWMgcHVyZSByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gRm9yIHF1ZXJ5aW5nIG93bmVyIG9mIHRva2VuCiAgICAvLyBAcGFyYW0gX3Rva2VuSWQgVGhlIHRva2VuSUQgZm9yIG93bmVyIGlucXVpcnkKICAgIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBvd25lcikKICAgIHsKICAgICAgICBvd25lciA9IHRva2VuSW5kZXhUb093bmVyW190b2tlbklkXTsKICAgICAgICByZXF1aXJlKG93bmVyICE9IGFkZHJlc3MoMCkpOwogICAgfQoKICAgIC8vIEBub3RpY2UgQWxsb3cgcHJlLWFwcHJvdmVkIHVzZXIgdG8gdGFrZSBvd25lcnNoaXAgb2YgYSB0b2tlbgogICAgLy8gQHBhcmFtIF90b2tlbklkIFRoZSBJRCBvZiB0aGUgVG9rZW4gdGhhdCBjYW4gYmUgdHJhbnNmZXJyZWQgaWYgdGhpcyBjYWxsIHN1Y2NlZWRzLgogICAgZnVuY3Rpb24gdGFrZU93bmVyc2hpcCh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgewogICAgICAgIGFkZHJlc3MgbmV3T3duZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIGFkZHJlc3Mgb2xkT3duZXIgPSB0b2tlbkluZGV4VG9Pd25lcltfdG9rZW5JZF07CgogICAgICAgIC8vIFNhZmV0eSBjaGVjayB0byBwcmV2ZW50IGFnYWluc3QgYW4gdW5leHBlY3RlZCAweDAgZGVmYXVsdC4KICAgICAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChuZXdPd25lcikpOwoKICAgICAgICAvLyBNYWtpbmcgc3VyZSB0cmFuc2ZlciBpcyBhcHByb3ZlZAogICAgICAgIHJlcXVpcmUoX2FwcHJvdmVkKG5ld093bmVyLCBfdG9rZW5JZCkpOwoKICAgICAgICBfdHJhbnNmZXIob2xkT3duZXIsIG5ld093bmVyLCBfdG9rZW5JZCk7CiAgICB9CgogICAgLy8gRm9yIHF1ZXJ5aW5nIHRvdGFsU3VwcGx5IG9mIHRva2VuCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgdG90YWwpIHsKICAgICAgICByZXR1cm4gdG9rZW5zLmxlbmd0aDsKICAgIH0KCiAgICAvLyBPd25lciBpbml0YXRlcyB0aGUgdHJhbnNmZXIgb2YgdGhlIHRva2VuIHRvIGFub3RoZXIgYWNjb3VudAogICAgLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBmb3IgdGhlIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkIHRvLgogICAgLy8gQHBhcmFtIF90b2tlbklkIFRoZSBJRCBvZiB0aGUgVG9rZW4gdGhhdCBjYW4gYmUgdHJhbnNmZXJyZWQgaWYgdGhpcyBjYWxsIHN1Y2NlZWRzLgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfb3ducyhtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwogICAgICAgIHJlcXVpcmUoX2FkZHJlc3NOb3ROdWxsKF90bykpOwoKICAgICAgICBfdHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgLy8gVGhpcmQtcGFydHkgaW5pdGlhdGVzIHRyYW5zZmVyIG9mIHRva2VuIGZyb20gYWRkcmVzcyBfZnJvbSB0byBhZGRyZXNzIF90bwogICAgLy8gQHBhcmFtIF9mcm9tIFRoZSBhZGRyZXNzIGZvciB0aGUgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQgZnJvbS4KICAgIC8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgZm9yIHRoZSB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZCB0by4KICAgIC8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgSUQgb2YgdGhlIFRva2VuIHRoYXQgY2FuIGJlIHRyYW5zZmVycmVkIGlmIHRoaXMgY2FsbCBzdWNjZWVkcy4KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIHsKICAgICAgICByZXF1aXJlKF9vd25zKF9mcm9tLCBfdG9rZW5JZCkpOwogICAgICAgIHJlcXVpcmUoX2FwcHJvdmVkKF90bywgX3Rva2VuSWQpKTsKICAgICAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChfdG8pKTsKCiAgICAgICAgX3RyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICAgIH0KCgoKICAgIC8vIE9OTFkgTUFTVEVSIENPTlRSQUNUIEZVTkNUSU9OUwoKICAgIGZ1bmN0aW9uIGNyZWF0ZVRva2VuKHN0cmluZyBfbmFtZSwgYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBvbmx5TWFzdGVyQ29udHJhY3QgcmV0dXJucyAodWludDI1NiBfdG9rZW5JZCkgewogICAgICAgIHJldHVybiBfY3JlYXRlVG9rZW4oX25hbWUsIF9vd25lcik7CiAgICB9CgogICAgZnVuY3Rpb24gdXBkYXRlT3duZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBvbmx5TWFzdGVyQ29udHJhY3QgewogICAgICAgIF90cmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0VG9rZW5EYXRhKHVpbnQyNTYgX3Rva2VuSWQsIGJ5dGVzMzIgdG9rZW5EYXRhKSBwdWJsaWMgb25seU1hc3RlckNvbnRyYWN0IHsKICAgICAgICB0b2tlbkluZGV4VG9EYXRhW190b2tlbklkXSA9IHRva2VuRGF0YTsKICAgIH0KCgoKICAgIC8vIFBSSVZBVEUgRlVOQ1RJT05TCgogICAgLy8gU2FmZXR5IGNoZWNrIG9uIF90byBhZGRyZXNzIHRvIHByZXZlbnQgYWdhaW5zdCBhbiB1bmV4cGVjdGVkIDB4MCBkZWZhdWx0LgogICAgZnVuY3Rpb24gX2FkZHJlc3NOb3ROdWxsKGFkZHJlc3MgX3RvKSBwcml2YXRlIHB1cmUgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBfdG8gIT0gYWRkcmVzcygwKTsKICAgIH0KCiAgICAvLyBGb3IgY2hlY2tpbmcgYXBwcm92YWwgb2YgdHJhbnNmZXIgZm9yIGFkZHJlc3MgX3RvCiAgICBmdW5jdGlvbiBfYXBwcm92ZWQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHRva2VuSW5kZXhUb0FwcHJvdmVkW190b2tlbklkXSA9PSBfdG87CiAgICB9CgogICAgLy8gRm9yIGNyZWF0aW5nIFRva2VuCiAgICBmdW5jdGlvbiBfY3JlYXRlVG9rZW4oc3RyaW5nIF9uYW1lLCBhZGRyZXNzIF9vd25lcikgcHJpdmF0ZSByZXR1cm5zICh1aW50MjU2IF90b2tlbklkKSB7CiAgICAgICAgVG9rZW4gbWVtb3J5IF90b2tlbiA9IFRva2VuKHsKICAgICAgICAgICAgbmFtZTogX25hbWUKICAgICAgICAgICAgfSk7CiAgICAgICAgdWludDI1NiBuZXdUb2tlbklkID0gdG9rZW5zLnB1c2goX3Rva2VuKSAtIDE7CgogICAgICAgIC8vIEl0J3MgcHJvYmFibHkgbmV2ZXIgZ29pbmcgdG8gaGFwcGVuLCA0IGJpbGxpb24gdG9rZW5zIGFyZSBBIExPVCwgYnV0CiAgICAgICAgLy8gbGV0J3MganVzdCBiZSAxMDAlIHN1cmUgd2UgbmV2ZXIgbGV0IHRoaXMgaGFwcGVuLgogICAgICAgIHJlcXVpcmUobmV3VG9rZW5JZCA9PSB1aW50MjU2KHVpbnQzMihuZXdUb2tlbklkKSkpOwoKICAgICAgICAvLyBUaGlzIHdpbGwgYXNzaWduIG93bmVyc2hpcCwgYW5kIGFsc28gZW1pdCB0aGUgVHJhbnNmZXIgZXZlbnQgYXMKICAgICAgICAvLyBwZXIgRVJDNzIxIGRyYWZ0CiAgICAgICAgX3RyYW5zZmVyKGFkZHJlc3MoMCksIF9vd25lciwgbmV3VG9rZW5JZCk7CgogICAgICAgIHJldHVybiBuZXdUb2tlbklkOwogICAgfQoKICAgIC8vIENoZWNrIGZvciB0b2tlbiBvd25lcnNoaXAKICAgIGZ1bmN0aW9uIF9vd25zKGFkZHJlc3MgY2xhaW1hbnQsIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIGNsYWltYW50ID09IHRva2VuSW5kZXhUb093bmVyW190b2tlbklkXTsKICAgIH0KCiAgICAvLyBAZGV2IEFzc2lnbnMgb3duZXJzaGlwIG9mIGEgc3BlY2lmaWMgVG9rZW4gdG8gYW4gYWRkcmVzcy4KICAgIGZ1bmN0aW9uIF90cmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB7CiAgICAgICAgLy8gU2luY2UgdGhlIG51bWJlciBvZiB0b2tlbnMgaXMgY2FwcGVkIHRvIDJeMzIgd2UgY2FuJ3Qgb3ZlcmZsb3cgdGhpcwogICAgICAgIG93bmVyc2hpcFRva2VuQ291bnRbX3RvXSsrOwogICAgICAgIC8vdHJhbnNmZXIgb3duZXJzaGlwCiAgICAgICAgdG9rZW5JbmRleFRvT3duZXJbX3Rva2VuSWRdID0gX3RvOwoKICAgICAgICAvLyBXaGVuIGNyZWF0aW5nIG5ldyB0b2tlbnMgX2Zyb20gaXMgMHgwLCBidXQgd2UgY2FuJ3QgYWNjb3VudCB0aGF0IGFkZHJlc3MuCiAgICAgICAgaWYgKF9mcm9tICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgb3duZXJzaGlwVG9rZW5Db3VudFtfZnJvbV0tLTsKICAgICAgICAgICAgLy8gY2xlYXIgYW55IHByZXZpb3VzbHkgYXBwcm92ZWQgb3duZXJzaGlwIGV4Y2hhbmdlCiAgICAgICAgICAgIGRlbGV0ZSB0b2tlbkluZGV4VG9BcHByb3ZlZFtfdG9rZW5JZF07CiAgICAgICAgfQoKICAgICAgICAvLyBFbWl0IHRoZSB0cmFuc2ZlciBldmVudC4KICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgICB9Cn0KCgoKY29udHJhY3QgU3BvcnRTdGFyTWFzdGVyIHsKCiAgICAvLyAqKioqKiBFVkVOVFMgKioqLwoKICAgIC8vIEBkZXYgVGhlIEJpcnRoIGV2ZW50IGlzIGZpcmVkIHdoZW5ldmVyIGEgbmV3IHRva2VuIGNvbWVzIGludG8gZXhpc3RlbmNlLgogICAgZXZlbnQgQmlydGgodWludDI1NiB0b2tlbklkLCBzdHJpbmcgbmFtZSwgYWRkcmVzcyBvd25lcik7CgogICAgLy8gQGRldiBUaGUgVG9rZW5Tb2xkIGV2ZW50IGlzIGZpcmVkIHdoZW5ldmVyIGEgdG9rZW4gaXMgc29sZC4KICAgIGV2ZW50IFRva2VuU29sZCh1aW50MjU2IHRva2VuSWQsIHVpbnQyNTYgb2xkUHJpY2UsIHVpbnQyNTYgbmV3UHJpY2UsIGFkZHJlc3MgcHJldk93bmVyLCBhZGRyZXNzIHdpbm5lcik7CgogICAgLy8gQGRldiBUcmFuc2ZlciBldmVudCBhcyBkZWZpbmVkIGluIGN1cnJlbnQgZHJhZnQgb2YgRVJDNzIxLgogICAgLy8gIG93bmVyc2hpcCBpcyBhc3NpZ25lZCwgaW5jbHVkaW5nIGJpcnRocy4KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB0b2tlbklkKTsKCgoKICAgIC8vICoqKioqIENPTlNUQU5UUyAqKiovCgogICAgdWludDI1NiBwcml2YXRlIHN0YXJ0aW5nUHJpY2UgPSAwLjAwMSBldGhlcjsKICAgIHVpbnQyNTYgcHJpdmF0ZSBmaXJzdFN0ZXBMaW1pdCA9IDAuMDUzNjEzIGV0aGVyOwogICAgdWludDI1NiBwcml2YXRlIHNlY29uZFN0ZXBMaW1pdCA9IDAuNTY0OTU3IGV0aGVyOwoKCgogICAgLy8gKioqKiogU1RPUkFHRSAqKiovCgogICAgLy8gQGRldiBBIG1hcHBpbmcgZnJvbSBUb2tlbklEcyB0byB0aGUgcHJpY2Ugb2YgdGhlIHRva2VuLgogICAgbWFwcGluZyh1aW50MjU2ID0+IHVpbnQyNTYpIHByaXZhdGUgdG9rZW5JbmRleFRvUHJpY2U7CgogICAgLy8gVGhlIGFkZHJlc3NlcyBvZiB0aGUgYWNjb3VudHMgKG9yIGNvbnRyYWN0cykgdGhhdCBjYW4gZXhlY3V0ZSBhY3Rpb25zIHdpdGhpbiBlYWNoIHJvbGVzLgogICAgYWRkcmVzcyBwdWJsaWMgY2VvQWRkcmVzczsKICAgIGFkZHJlc3MgcHVibGljIGNvb0FkZHJlc3M7CgogICAgLy8gVGhlIGFkZHJlc3Mgb2YgdG9rZW5zIGNvbnRyYWN0CiAgICBTcG9ydFN0YXJUb2tlbiBwdWJsaWMgdG9rZW5zQ29udHJhY3Q7CgogICAgdWludDI1NiBwdWJsaWMgcHJvbW9DcmVhdGVkQ291bnQ7CgoKICAgIHVpbnQyNTYgcHJpdmF0ZSBpbmNyZWFzZUxpbWl0MSA9IDAuMDUgZXRoZXI7CiAgICB1aW50MjU2IHByaXZhdGUgaW5jcmVhc2VMaW1pdDIgPSAwLjUgZXRoZXI7CiAgICB1aW50MjU2IHByaXZhdGUgaW5jcmVhc2VMaW1pdDMgPSAyLjAgZXRoZXI7CiAgICB1aW50MjU2IHByaXZhdGUgaW5jcmVhc2VMaW1pdDQgPSA1LjAgZXRoZXI7CgoKCiAgICAvLyAqKioqKiBBQ0NFU1MgTU9ESUZJRVJTICoqKi8KCiAgICAvLyBAZGV2IEFjY2VzcyBtb2RpZmllciBmb3IgQ0VPLW9ubHkgZnVuY3Rpb25hbGl0eQogICAgbW9kaWZpZXIgb25seUNFTygpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY2VvQWRkcmVzcyk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLyBAZGV2IEFjY2VzcyBtb2RpZmllciBmb3IgQ09PLW9ubHkgZnVuY3Rpb25hbGl0eQogICAgbW9kaWZpZXIgb25seUNPTygpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY29vQWRkcmVzcyk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLyBBY2Nlc3MgbW9kaWZpZXIgZm9yIGNvbnRyYWN0IG93bmVyIG9ubHkgZnVuY3Rpb25hbGl0eQogICAgbW9kaWZpZXIgb25seUNMZXZlbCgpIHsKICAgICAgICByZXF1aXJlKAogICAgICAgICAgICBtc2cuc2VuZGVyID09IGNlb0FkZHJlc3MgfHwKICAgICAgICAgICAgbXNnLnNlbmRlciA9PSBjb29BZGRyZXNzCiAgICAgICAgKTsKICAgICAgICBfOwogICAgfQoKCgogICAgLy8gKioqKiogQ09OU1RSVUNUT1IgKioqLwoKICAgIGZ1bmN0aW9uIFNwb3J0U3Rhck1hc3RlcigpIHB1YmxpYyB7CiAgICAgICAgY2VvQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgY29vQWRkcmVzcyA9IG1zZy5zZW5kZXI7CgogICAgICAgIC8vT2xkIHByaWNlcwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzBdPTE5ODA1NjU4NTkzNjQ4MTEzNTsKICAgICAgICB0b2tlbkluZGV4VG9QcmljZVsxXT0xOTgwNTY1ODU5MzY0ODExMzU7CiAgICAgICAgdG9rZW5JbmRleFRvUHJpY2VbMl09MTk4MDU2NTg1OTM2NDgxMTM1OwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzNdPTc2ODMzMzE0NDcwNzAwNzcxOwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzRdPTc2ODMzMzE0NDcwNzAwNzcxOwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzVdPTc2ODMzMzE0NDcwNzAwNzcxOwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzZdPTc2ODMzMzE0NDcwNzAwNzcxOwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzddPTc2ODMzMzE0NDcwNzAwNzcxOwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzhdPTc2ODMzMzE0NDcwNzAwNzcxOwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzldPTc2ODMzMzE0NDcwNzAwNzcxOwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzEwXT03NjgzMzMxNDQ3MDcwMDc3MTsKICAgICAgICB0b2tlbkluZGV4VG9QcmljZVsxMV09NzY4MzMzMTQ0NzA3MDA3NzE7CiAgICAgICAgdG9rZW5JbmRleFRvUHJpY2VbMTJdPTc2ODMzMzE0NDcwNzAwNzcxOwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzEzXT03NjgzMzMxNDQ3MDcwMDc3MTsKICAgICAgICB0b2tlbkluZGV4VG9QcmljZVsxNF09MzcyNjQxNTc1MTgyODk4NzQ7CiAgICAgICAgdG9rZW5JbmRleFRvUHJpY2VbMTVdPTc2ODMzMzE0NDcwNzAwNzcxOwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzE2XT0xNDQ0NDcyODQ0Nzk5OTAwMDE7CiAgICAgICAgdG9rZW5JbmRleFRvUHJpY2VbMTddPTE0NDQ0NzI4NDQ3OTk5MDAwMTsKICAgICAgICB0b2tlbkluZGV4VG9QcmljZVsxOF09MzcyNjQxNTc1MTgyODk4NzQ7CiAgICAgICAgdG9rZW5JbmRleFRvUHJpY2VbMTldPTc2ODMzMzE0NDcwNzAwNzcxOwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzIwXT0zNzI2NDE1NzUxODI4OTg3NDsKICAgICAgICB0b2tlbkluZGV4VG9QcmljZVsyMV09NzY4MzMzMTQ0NzA3MDA3NzE7CiAgICAgICAgdG9rZW5JbmRleFRvUHJpY2VbMjJdPTEwNTM0ODc3MTM4NzY2MTg4MTsKICAgICAgICB0b2tlbkluZGV4VG9QcmljZVsyM109MTQ0NDQ3Mjg0NDc5OTkwMDAxOwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzI0XT0xMDUzNDg3NzEzODc2NjE4ODE7CiAgICAgICAgdG9rZW5JbmRleFRvUHJpY2VbMjVdPTM3MjY0MTU3NTE4Mjg5ODc0OwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzI2XT0zNzI2NDE1NzUxODI4OTg3NDsKICAgICAgICB0b2tlbkluZGV4VG9QcmljZVsyN109MzcyNjQxNTc1MTgyODk4NzQ7CiAgICAgICAgdG9rZW5JbmRleFRvUHJpY2VbMjhdPTc2ODMzMzE0NDcwNzAwNzcxOwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzI5XT0xMDUzNDg3NzEzODc2NjE4ODE7CiAgICAgICAgdG9rZW5JbmRleFRvUHJpY2VbMzBdPTc2ODMzMzE0NDcwNzAwNzcxOwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzMxXT0zNzI2NDE1NzUxODI4OTg3NDsKICAgICAgICB0b2tlbkluZGV4VG9QcmljZVszMl09NzY4MzMzMTQ0NzA3MDA3NzE7CiAgICAgICAgdG9rZW5JbmRleFRvUHJpY2VbMzNdPTM3MjY0MTU3NTE4Mjg5ODc0OwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzM0XT03NjgzMzMxNDQ3MDcwMDc3MTsKICAgICAgICB0b2tlbkluZGV4VG9QcmljZVszNV09MzcyNjQxNTc1MTgyODk4NzQ7CiAgICAgICAgdG9rZW5JbmRleFRvUHJpY2VbMzZdPTM3MjY0MTU3NTE4Mjg5ODc0OwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzM3XT03NjgzMzMxNDQ3MDcwMDc3MTsKICAgICAgICB0b2tlbkluZGV4VG9QcmljZVszOF09NzY4MzMzMTQ0NzA3MDA3NzE7CiAgICAgICAgdG9rZW5JbmRleFRvUHJpY2VbMzldPTM3MjY0MTU3NTE4Mjg5ODc0OwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzQwXT0zNzI2NDE1NzUxODI4OTg3NDsKICAgICAgICB0b2tlbkluZGV4VG9QcmljZVs0MV09MzcyNjQxNTc1MTgyODk4NzQ7CiAgICAgICAgdG9rZW5JbmRleFRvUHJpY2VbNDJdPTc2ODMzMzE0NDcwNzAwNzcxOwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzQzXT0zNzI2NDE1NzUxODI4OTg3NDsKICAgICAgICB0b2tlbkluZGV4VG9QcmljZVs0NF09MzcyNjQxNTc1MTgyODk4NzQ7CiAgICAgICAgdG9rZW5JbmRleFRvUHJpY2VbNDVdPTc2ODMzMzE0NDcwNzAwNzcxOwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlWzQ2XT0zNzI2NDE1NzUxODI4OTg3NDsKICAgICAgICB0b2tlbkluZGV4VG9QcmljZVs0N109MzcyNjQxNTc1MTgyODk4NzQ7CiAgICAgICAgdG9rZW5JbmRleFRvUHJpY2VbNDhdPTc2ODMzMzE0NDcwNzAwNzcxOwogICAgfQoKCiAgICBmdW5jdGlvbiBzZXRUb2tlbnNDb250cmFjdChhZGRyZXNzIF9uZXdUb2tlbnNDb250cmFjdCkgcHVibGljIG9ubHlDRU8gewogICAgICAgIHJlcXVpcmUoX25ld1Rva2Vuc0NvbnRyYWN0ICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICB0b2tlbnNDb250cmFjdCA9IFNwb3J0U3RhclRva2VuKF9uZXdUb2tlbnNDb250cmFjdCk7CiAgICB9CgoKCiAgICAvLyAqKioqKiBQUklWSUxFR0VTIFNFVFRJTkcgRlVOQ1RJT05TCgogICAgZnVuY3Rpb24gc2V0Q0VPKGFkZHJlc3MgX25ld0NFTykgcHVibGljIG9ubHlDRU8gewogICAgICAgIHJlcXVpcmUoX25ld0NFTyAhPSBhZGRyZXNzKDApKTsKCiAgICAgICAgY2VvQWRkcmVzcyA9IF9uZXdDRU87CiAgICB9CgogICAgZnVuY3Rpb24gc2V0Q09PKGFkZHJlc3MgX25ld0NPTykgcHVibGljIG9ubHlDRU8gewogICAgICAgIHJlcXVpcmUoX25ld0NPTyAhPSBhZGRyZXNzKDApKTsKCiAgICAgICAgY29vQWRkcmVzcyA9IF9uZXdDT087CiAgICB9CgoKCiAgICAvLyAqKioqKiBQVUJMSUMgRlVOQ1RJT05TICoqKi8KICAgIGZ1bmN0aW9uIGdldFRva2VuSW5mbyh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zICgKICAgICAgICBhZGRyZXNzIG93bmVyLAogICAgICAgIHVpbnQyNTYgcHJpY2UsCiAgICAgICAgYnl0ZXMzMiB0b2tlbkRhdGEKICAgICkgewogICAgICAgIG93bmVyID0gdG9rZW5zQ29udHJhY3Qub3duZXJPZihfdG9rZW5JZCk7CiAgICAgICAgcHJpY2UgPSB0b2tlbkluZGV4VG9QcmljZVtfdG9rZW5JZF07CiAgICAgICAgdG9rZW5EYXRhID0gdG9rZW5zQ29udHJhY3QuZ2V0VG9rZW5EYXRhKF90b2tlbklkKTsKICAgIH0KCiAgICAvLyBAZGV2IENyZWF0ZXMgYSBuZXcgcHJvbW8gVG9rZW4gd2l0aCB0aGUgZ2l2ZW4gbmFtZSwgd2l0aCBnaXZlbiBfcHJpY2UgYW5kIGFzc2lnbmVzIGl0IHRvIGFuIGFkZHJlc3MuCiAgICBmdW5jdGlvbiBjcmVhdGVQcm9tb1Rva2VuKGFkZHJlc3MgX293bmVyLCBzdHJpbmcgX25hbWUsIHVpbnQyNTYgX3ByaWNlKSBwdWJsaWMgb25seUNPTyB7CiAgICAgICAgYWRkcmVzcyB0b2tlbk93bmVyID0gX293bmVyOwogICAgICAgIGlmICh0b2tlbk93bmVyID09IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgdG9rZW5Pd25lciA9IGNvb0FkZHJlc3M7CiAgICAgICAgfQoKICAgICAgICBpZiAoX3ByaWNlIDw9IDApIHsKICAgICAgICAgICAgX3ByaWNlID0gc3RhcnRpbmdQcmljZTsKICAgICAgICB9CgogICAgICAgIHByb21vQ3JlYXRlZENvdW50Kys7CiAgICAgICAgdWludDI1NiBuZXdUb2tlbklkID0gdG9rZW5zQ29udHJhY3QuY3JlYXRlVG9rZW4oX25hbWUsIHRva2VuT3duZXIpOwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlW25ld1Rva2VuSWRdID0gX3ByaWNlOwoKICAgICAgICBCaXJ0aChuZXdUb2tlbklkLCBfbmFtZSwgX293bmVyKTsKICAgIH0KCiAgICAvLyBAZGV2IENyZWF0ZXMgYSBuZXcgVG9rZW4gd2l0aCB0aGUgZ2l2ZW4gbmFtZS4KICAgIGZ1bmN0aW9uIGNyZWF0ZUNvbnRyYWN0VG9rZW4oc3RyaW5nIF9uYW1lKSBwdWJsaWMgb25seUNPTyB7CiAgICAgICAgdWludDI1NiBuZXdUb2tlbklkID0gdG9rZW5zQ29udHJhY3QuY3JlYXRlVG9rZW4oX25hbWUsIGFkZHJlc3ModGhpcykpOwogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlW25ld1Rva2VuSWRdID0gc3RhcnRpbmdQcmljZTsKCiAgICAgICAgQmlydGgobmV3VG9rZW5JZCwgX25hbWUsIGFkZHJlc3ModGhpcykpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNyZWF0ZUNvbnRyYWN0VG9rZW5XaXRoUHJpY2Uoc3RyaW5nIF9uYW1lLCB1aW50MjU2IF9wcmljZSkgcHVibGljIG9ubHlDT08gewogICAgICAgIHVpbnQyNTYgbmV3VG9rZW5JZCA9IHRva2Vuc0NvbnRyYWN0LmNyZWF0ZVRva2VuKF9uYW1lLCBhZGRyZXNzKHRoaXMpKTsKICAgICAgICB0b2tlbkluZGV4VG9QcmljZVtuZXdUb2tlbklkXSA9IF9wcmljZTsKCiAgICAgICAgQmlydGgobmV3VG9rZW5JZCwgX25hbWUsIGFkZHJlc3ModGhpcykpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEdhbWJsaW5nRmVlKHVpbnQyNTYgX3Rva2VuSWQsIHVpbnQyNTYgX2ZlZSkgcHVibGljIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gdG9rZW5zQ29udHJhY3Qub3duZXJPZihfdG9rZW5JZCkpOwogICAgICAgIHJlcXVpcmUoX2ZlZSA+PSAwICYmIF9mZWUgPD0gMTAwKTsKCiAgICAgICAgYnl0ZXMzMiB0b2tlbkRhdGEgPSBieXRlKF9mZWUpOwogICAgICAgIHRva2Vuc0NvbnRyYWN0LnNldFRva2VuRGF0YShfdG9rZW5JZCwgdG9rZW5EYXRhKTsKICAgIH0KCiAgICAvLyBBbGxvd3Mgc29tZW9uZSB0byBzZW5kIGV0aGVyIGFuZCBvYnRhaW4gdGhlIHRva2VuCiAgICBmdW5jdGlvbiBwdXJjaGFzZSh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgYWRkcmVzcyBvbGRPd25lciA9IHRva2Vuc0NvbnRyYWN0Lm93bmVyT2YoX3Rva2VuSWQpOwogICAgICAgIGFkZHJlc3MgbmV3T3duZXIgPSBtc2cuc2VuZGVyOwoKICAgICAgICB1aW50MjU2IHNlbGxpbmdQcmljZSA9IHRva2VuSW5kZXhUb1ByaWNlW190b2tlbklkXTsKCiAgICAgICAgLy8gTWFraW5nIHN1cmUgdG9rZW4gb3duZXIgaXMgbm90IHNlbmRpbmcgdG8gc2VsZgogICAgICAgIHJlcXVpcmUob2xkT3duZXIgIT0gbmV3T3duZXIpOwoKICAgICAgICAvLyBTYWZldHkgY2hlY2sgdG8gcHJldmVudCBhZ2FpbnN0IGFuIHVuZXhwZWN0ZWQgMHgwIGRlZmF1bHQuCiAgICAgICAgcmVxdWlyZShfYWRkcmVzc05vdE51bGwobmV3T3duZXIpKTsKCiAgICAgICAgLy8gTWFraW5nIHN1cmUgc2VudCBhbW91bnQgaXMgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIHRoZSBzZWxsaW5nUHJpY2UKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSBzZWxsaW5nUHJpY2UpOwoKICAgICAgICB1aW50MjU2IGRldkN1dCA9IGNhbGN1bGF0ZURldkN1dChzZWxsaW5nUHJpY2UpOwogICAgICAgIHVpbnQyNTYgcGF5bWVudCA9IFNhZmVNYXRoLnN1YihzZWxsaW5nUHJpY2UsIGRldkN1dCk7CiAgICAgICAgdWludDI1NiBwdXJjaGFzZUV4Y2VzcyA9IFNhZmVNYXRoLnN1Yihtc2cudmFsdWUsIHNlbGxpbmdQcmljZSk7CgogICAgICAgIHRva2VuSW5kZXhUb1ByaWNlW190b2tlbklkXSA9IGNhbGN1bGF0ZU5leHRQcmljZShzZWxsaW5nUHJpY2UpOwoKICAgICAgICB0b2tlbnNDb250cmFjdC51cGRhdGVPd25lcihvbGRPd25lciwgbmV3T3duZXIsIF90b2tlbklkKTsKCiAgICAgICAgLy8gUGF5IHByZXZpb3VzIHRva2VuT3duZXIgaWYgb3duZXIgaXMgbm90IGNvbnRyYWN0CiAgICAgICAgaWYgKG9sZE93bmVyICE9IGFkZHJlc3ModGhpcykpIHsKICAgICAgICAgICAgb2xkT3duZXIudHJhbnNmZXIocGF5bWVudCk7CiAgICAgICAgfQoKICAgICAgICBUb2tlblNvbGQoX3Rva2VuSWQsIHNlbGxpbmdQcmljZSwgdG9rZW5JbmRleFRvUHJpY2VbX3Rva2VuSWRdLCBvbGRPd25lciwgbmV3T3duZXIpOwoKICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHB1cmNoYXNlRXhjZXNzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwcmljZU9mKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgcHJpY2UpIHsKICAgICAgICByZXR1cm4gdG9rZW5JbmRleFRvUHJpY2VbX3Rva2VuSWRdOwogICAgfQoKICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZURldkN1dCAodWludDI1NiBfcHJpY2UpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgX2RldkN1dCkgewogICAgICAgIGlmIChfcHJpY2UgPCBpbmNyZWFzZUxpbWl0MSkgewogICAgICAgICAgICByZXR1cm4gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChfcHJpY2UsIDMpLCAxMDApOyAvLyAzJQogICAgICAgIH0gZWxzZSBpZiAoX3ByaWNlIDwgaW5jcmVhc2VMaW1pdDIpIHsKICAgICAgICAgICAgcmV0dXJuIFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoX3ByaWNlLCAzKSwgMTAwKTsgLy8gMyUKICAgICAgICB9IGVsc2UgaWYgKF9wcmljZSA8IGluY3JlYXNlTGltaXQzKSB7CiAgICAgICAgICAgIHJldHVybiBTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKF9wcmljZSwgMyksIDEwMCk7IC8vIDMlCiAgICAgICAgfSBlbHNlIGlmIChfcHJpY2UgPCBpbmNyZWFzZUxpbWl0NCkgewogICAgICAgICAgICByZXR1cm4gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChfcHJpY2UsIDMpLCAxMDApOyAvLyAzJQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKF9wcmljZSwgMiksIDEwMCk7IC8vIDIlCiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZU5leHRQcmljZSAodWludDI1NiBfcHJpY2UpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgX25leHRQcmljZSkgewogICAgICAgIGlmIChfcHJpY2UgPCBpbmNyZWFzZUxpbWl0MSkgewogICAgICAgICAgICByZXR1cm4gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChfcHJpY2UsIDIwMCksIDk3KTsKICAgICAgICB9IGVsc2UgaWYgKF9wcmljZSA8IGluY3JlYXNlTGltaXQyKSB7CiAgICAgICAgICAgIHJldHVybiBTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKF9wcmljZSwgMTMzKSwgOTcpOwogICAgICAgIH0gZWxzZSBpZiAoX3ByaWNlIDwgaW5jcmVhc2VMaW1pdDMpIHsKICAgICAgICAgICAgcmV0dXJuIFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoX3ByaWNlLCAxMjUpLCA5Nyk7CiAgICAgICAgfSBlbHNlIGlmIChfcHJpY2UgPCBpbmNyZWFzZUxpbWl0NCkgewogICAgICAgICAgICByZXR1cm4gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChfcHJpY2UsIDExNSksIDk3KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChfcHJpY2UsIDExMyksIDk4KTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gcGF5b3V0KGFkZHJlc3MgX3RvKSBwdWJsaWMgb25seUNFTyB7CiAgICAgICAgaWYgKF90byA9PSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIGNlb0FkZHJlc3MudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfdG8udHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgICAgICB9CiAgICB9CgoKCiAgICAvLyBQUklWQVRFIEZVTkNUSU9OUwoKICAgIC8vIFNhZmV0eSBjaGVjayBvbiBfdG8gYWRkcmVzcyB0byBwcmV2ZW50IGFnYWluc3QgYW4gdW5leHBlY3RlZCAweDAgZGVmYXVsdC4KICAgIGZ1bmN0aW9uIF9hZGRyZXNzTm90TnVsbChhZGRyZXNzIF90bykgcHJpdmF0ZSBwdXJlIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gX3RvICE9IGFkZHJlc3MoMCk7CiAgICB9Cn0KCgoKbGlicmFyeSBTYWZlTWF0aCB7CgogICAgLyoqCiAgICAqIEBkZXYgTXVsdGlwbGllcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICAgKi8KICAgIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgaWYgKGEgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgICAgdWludDI1NiBjID0gYSAqIGI7CiAgICAgICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEludGVnZXIgZGl2aXNpb24gb2YgdHdvIG51bWJlcnMsIHRydW5jYXRpbmcgdGhlIHF1b3RpZW50LgogICAgKi8KICAgIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICAgICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAgICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBTdWJzdHJhY3RzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cgKGkuZS4gaWYgc3VidHJhaGVuZCBpcyBncmVhdGVyIHRoYW4gbWludWVuZCkuCiAgICAqLwogICAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoYiA8PSBhKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgQWRkcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICAgKi8KICAgIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSk7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9Cn0='.
	

]
