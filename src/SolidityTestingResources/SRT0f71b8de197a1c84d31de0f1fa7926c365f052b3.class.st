Class {
	#name : #SRT0f71b8de197a1c84d31de0f1fa7926c365f052b3,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT0f71b8de197a1c84d31de0f1fa7926c365f052b3 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjE7CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICAgIAogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9CiAKfQoKCi8qKgogKiBAdGl0bGUgRVJDMjBCYXNpYwogKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE3OQogKi8KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKCi8qKgogKiBAdGl0bGUgQmFzaWMgdG9rZW4KICogQGRldiBCYXNpYyB2ZXJzaW9uIG9mIFN0YW5kYXJkVG9rZW4sIHJlcXVpcmUgbWludGluZ0ZpbmlzaGVkIGJlZm9yZSBzdGFydCB0cmFuc2ZlcnMKICovCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgICAKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwogIGJvb2wgcHVibGljIG1pbnRpbmdGaW5pc2hlZCA9IGZhbHNlOwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgcmVsZWFzZVRpbWU7CiAgLy8gT25seSBhZnRlciBmaW5pc2hNaW50aW5nIGFuZCBjaGVja3MgZm9yIGJvdW50eSBhY2NvdW50cyB0aW1lIHJlc3RyaWN0aW9ucwogIG1vZGlmaWVyIHRpbWVBbGxvd2VkKCkgewogICAgcmVxdWlyZShtaW50aW5nRmluaXNoZWQpOwogICAgcmVxdWlyZShyZWxlYXNlVGltZVttc2cuc2VuZGVyXSA9PSAwIHx8IG5vdyA+IHJlbGVhc2VUaW1lW21zZy5zZW5kZXJdKTsgLy9maW5pc2hTYWxlICsgcmVsZWFzZWRheXMgKiAxIGRheXMKICAgIF87CiAgfQoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB0aW1lQWxsb3dlZCByZXR1cm5zIChib29sKSB7CiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBlbWl0IFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuIAogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKICAvLyByZWxlYXNlIHRpbWUgb2YgZnJlZXplZCBhY2NvdW50CiAgZnVuY3Rpb24gY2hlY2tSZWxlYXNlQXQoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGRhdGUpIHsKICAgIHJldHVybiByZWxlYXNlVGltZVtfb3duZXJdOwogIH0KCiAgLy8gY2hhbmdlIHJlc3RyaWN0ZWQgcmVsZWFzZVhYIGFjY291bnQKICBmdW5jdGlvbiBjaGFuZ2VSZWxlYXNlQWNjb3VudChhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfbmV3b3duZXIpIGludGVybmFsIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoYmFsYW5jZXNbX25ld293bmVyXSA9PSAwKTsKICAgIHJlcXVpcmUocmVsZWFzZVRpbWVbX293bmVyXSAhPSAwICk7CiAgICByZXF1aXJlKHJlbGVhc2VUaW1lW19uZXdvd25lcl0gPT0gMCApOwogICAgYmFsYW5jZXNbX25ld293bmVyXSA9IGJhbGFuY2VzW19vd25lcl07CiAgICByZWxlYXNlVGltZVtfbmV3b3duZXJdID0gcmVsZWFzZVRpbWVbX293bmVyXTsKICAgIGJhbGFuY2VzW19vd25lcl0gPSAwOwogICAgcmVsZWFzZVRpbWVbX293bmVyXSA9IDA7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8vIHJlbGVhc2UgQ3VzdG9tZXIncyBhY2NvdW50IGFmdGVyIEtZQwogIGZ1bmN0aW9uIHJlbGVhc2VBY2NvdW50KGFkZHJlc3MgX293bmVyKSBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7CiAgICByZWxlYXNlVGltZVtfb3duZXJdID0gbm93OwogICAgcmV0dXJuIHRydWU7CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbgogKgogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgaW50ZXJuYWwgYWxsb3dlZDsKCgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShtaW50aW5nRmluaXNoZWQpOwogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1tfZnJvbV0pOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0pOwoKICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIGVtaXQgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICoKICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICogYW5kIHRoZSBuZXcgYWxsb3dhbmNlIGJ5IHVuZm9ydHVuYXRlIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcwogICAqIHJhY2UgY29uZGl0aW9uIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUgYWZ0ZXJ3YXJkczoKICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIGVtaXQgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBAZGV2IEluY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX2FkZGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gaW5jcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBlbWl0IEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRGVjcmVhc2UgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKgogICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGRlY3JlbWVudAogICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3VidHJhY3RlZFZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGRlY3JlYXNlIHRoZSBhbGxvd2FuY2UgYnkuCiAgICovCiAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQogICAgZW1pdCBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKfQovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgICAKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCi8qKgogKiBAdGl0bGUgTWludGFibGUgdG9rZW4KICogQGRldiBTaW1wbGUgRVJDMjAgVG9rZW4gZXhhbXBsZSwgd2l0aCBtaW50YWJsZSB0b2tlbiBjcmVhdGlvbgogKiBAZGV2IElzc3VlOiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvaXNzdWVzLzEyMAogKiBCYXNlZCBvbiBjb2RlIGJ5IFRva2VuTWFya2V0TmV0OiBodHRwczovL2dpdGh1Yi5jb20vVG9rZW5NYXJrZXROZXQvaWNvL2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy9NaW50YWJsZVRva2VuLnNvbAogKi8KCmNvbnRyYWN0IE1pbnRhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZSB7CgogIG1vZGlmaWVyIGNhbk1pbnQoKSB7CiAgICByZXF1aXJlKCFtaW50aW5nRmluaXNoZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gbWludCB0b2tlbnMKICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCByZWNpZXZlIHRoZSBtaW50ZWQgdG9rZW5zLgogICAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIG1pbnQuCiAgICogQHBhcmFtIF9yZWxlYXNlVGltZSBUaGUgKG9wdGlvbmFsKSBmcmVlemUgdGltZSAtIEtZQyAmIGJvdW50eSBhY2NvdW50cy4KICAgKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCwgdWludDI1NiBfcmVsZWFzZVRpbWUpIGludGVybmFsIGNhbk1pbnQgcmV0dXJucyAoYm9vbCkgewogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoX2Ftb3VudCk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICBpZiAoIF9yZWxlYXNlVGltZSA+IDAgKSB7CiAgICAgICAgcmVsZWFzZVRpbWVbX3RvXSA9IF9yZWxlYXNlVGltZTsKICAgIH0KICAgIGVtaXQgVHJhbnNmZXIoMHgwLCBfdG8sIF9hbW91bnQpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLyBkcmFpbiB0b2tlbnMKICBmdW5jdGlvbiB1bk1pbnQoYWRkcmVzcyBfZnJvbSkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5zdWIoYmFsYW5jZXNbX2Zyb21dKTsKICAgIGVtaXQgVHJhbnNmZXIoX2Zyb20sIDB4MCwgYmFsYW5jZXNbX2Zyb21dKTsKICAgIGJhbGFuY2VzW19mcm9tXSA9IDA7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAKfQogIAogICAKY29udHJhY3QgQXJjb25hVG9rZW4gaXMgTWludGFibGVUb2tlbiB7CgogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIkFyY29uYSBEaXN0cmlidXRpb24gQ29udHJhY3QiOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiQVJDT05BIjsKICAgIHVpbnQ4IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwogICAKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwogICAgCiAgICBhZGRyZXNzIHB1YmxpYyBtdWx0aXNpZzsKICAgIGFkZHJlc3MgcHVibGljIHJlc3RyaWN0ZWQ7CiAgICBhZGRyZXNzIHB1YmxpYyByZWdpc3RlcmJvdDsKICAgIGFkZHJlc3MgcHVibGljIGNlcnRib3Q7CiAgICBhZGRyZXNzIHB1YmxpYyByZWxlYXNlNm07CiAgICBhZGRyZXNzIHB1YmxpYyByZWxlYXNlMTJtOwogICAgYWRkcmVzcyBwdWJsaWMgcmVsZWFzZTE4bTsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHJlZ2lzdGVyZWQ7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGFkZHJlc3MpIHJlZmVycmFsOwogICAgbWFwcGluZyAoc3RyaW5nID0+IGFkZHJlc3MpIGNlcnRpZmljYXRlOwoKICAgIHVpbnQgcmVzdHJpY3RlZFBlcmNlbnQgPSA0MDsKICAgIHVpbnQgcmVmZXJlclBlcmNlbnQgPSA1NTsgLy8gNS41JQogICAgdWludCBmaXJzdDI0UGVyY2VudCA9IDUwOyAvLyA1MCUKICAgIHVpbnQgYXVjdGlvblBlcmNlbnQgPSA1OyAvLyA1JQogICAgdWludCBib251c1BlcmlvZCA9IDIxOyAvLyAyMSBkYXlzICgyMCArIDFzdCBkYXkgd2hpdGVsaXN0IHNhbGUpCgogICAgdWludCBwdWJsaWMgc3RhcnRTYWxlOwogICAgdWludCBwdWJsaWMgZmluaXNoU2FsZTsKICAgIGJvb2wgcHVibGljIGlzR2xvYmFsUGF1c2U9ZmFsc2U7CiAgICB1aW50IHB1YmxpYyBtaW5Ub2tlblNhbGUgPSAxMCoxMCoqMTg7IC8vIG1pbiAxMCB0b2tlbnMKICAgIHVpbnQgcHVibGljIHRvdGFsV2VpU2FsZSA9IDI3NDYqMTAqKjE4OyAvLyBzb2Z0Y2FwIHJlYWNoZWQgb24gcHJlSUNPOiAgMHg1MTYxMzA4NTZlNzQzMDkwYWY5ZDdmZDk1ZDZmYzk0Yzg3NDNhNGUxCiAgICBib29sIHB1YmxpYyBpc0ZpbmlzaGVkPWZhbHNlOwoKICAgIHVpbnQgcHVibGljIHN0YXJ0QXVjdGlvbjsKICAgIHVpbnQgcHVibGljIGZpbmlzaEF1Y3Rpb247CiAgICB1aW50IHB1YmxpYyBoYXJkY2FwID0gMjUqMTAqKjY7IC8vIFVTRAogICAgdWludCBwdWJsaWMgcmF0ZVNhbGUgPSA0MDAqMTAqKjE4OyAvLyAxRVRIID0gNDAwIEFSTgogICAgdWludCBwdWJsaWMgcmF0ZVVTRCA9IDUwMDsgLy8gRVRIIENvdXJzZSBpbiBVU0QKCiAgICAvLyBjb25zdHJ1Y3RvcgogICAgZnVuY3Rpb24gQXJjb25hVG9rZW4odWludDI1NiBfc3RhcnRTYWxlLHVpbnQyNTYgX2ZpbmlzaFNhbGUsYWRkcmVzcyBfbXVsdGlzaWcsYWRkcmVzcyBfcmVzdHJpY3RlZCxhZGRyZXNzIF9yZWdpc3RlcmJvdCxhZGRyZXNzIF9jZXJ0Ym90LCBhZGRyZXNzIF9yZWxlYXNlNm0sIGFkZHJlc3MgX3JlbGVhc2UxMm0sIGFkZHJlc3MgX3JlbGVhc2UxOG0pIHB1YmxpYyAgewogICAgICAgIG11bHRpc2lnID0gX211bHRpc2lnOwogICAgICAgIHJlc3RyaWN0ZWQgPSBfcmVzdHJpY3RlZDsKICAgICAgICByZWdpc3RlcmJvdCA9IF9yZWdpc3RlcmJvdDsKICAgICAgICBjZXJ0Ym90ID0gX2NlcnRib3Q7CiAgICAgICAgcmVsZWFzZTZtID0gX3JlbGVhc2U2bTsKICAgICAgICByZWxlYXNlMTJtID0gX3JlbGVhc2UxMm07CiAgICAgICAgcmVsZWFzZTE4bSA9IF9yZWxlYXNlMThtOwogICAgICAgIHN0YXJ0U2FsZSA9IF9zdGFydFNhbGU7CiAgICAgICAgZmluaXNoU2FsZSA9IF9maW5pc2hTYWxlOwogICAgfQoKICAgIG1vZGlmaWVyIGlzUmVnaXN0ZXJlZCgpIHsKICAgICAgICByZXF1aXJlIChyZWdpc3RlcmVkW21zZy5zZW5kZXJdKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIGFueVNhbGVJc09uKCkgewogICAgICAgIHJlcXVpcmUobm93ID4gc3RhcnRTYWxlICYmIG5vdyA8IGZpbmlzaFNhbGUgJiYgIWlzR2xvYmFsUGF1c2UpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgaXNVbmRlckhhcmRDYXAoKSB7CiAgICAgICAgdWludCB0b3RhbFVzZFNhbGUgPSByYXRlVVNELm11bCh0b3RhbFdlaVNhbGUpLmRpdigxIGV0aGVyKTsKICAgICAgICByZXF1aXJlKHRvdGFsVXNkU2FsZSA8PSBoYXJkY2FwKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYW5nZWZpcnN0MjRQZXJjZW50KHVpbnQgX3BlcmNlbnQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIGZpcnN0MjRQZXJjZW50ID0gX3BlcmNlbnQ7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlQ291cnNlKHVpbnQgX3VzZCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmF0ZVVTRCA9IF91c2Q7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlTXVsdGlzaWcoYWRkcmVzcyBfbmV3KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBtdWx0aXNpZyA9IF9uZXc7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlUmVnaXN0ZXJCb3QoYWRkcmVzcyBfbmV3KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZWdpc3RlcmJvdCA9IF9uZXc7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlQ2VydEJvdChhZGRyZXNzIF9uZXcpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIGNlcnRib3QgPSBfbmV3OwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYW5nZVJlc3RyaWN0ZWQoYWRkcmVzcyBfbmV3KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBpZiAoaXNGaW5pc2hlZCkgewogICAgICAgICAgICBjaGFuZ2VSZWxlYXNlQWNjb3VudChyZXN0cmljdGVkLF9uZXcpOwogICAgICAgIH0KICAgICAgICByZXN0cmljdGVkID0gX25ldzsKICAgIH0KCiAgICBmdW5jdGlvbiBwcm9jZWVkS1lDKGFkZHJlc3MgX2N1c3RvbWVyKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSByZWdpc3RlcmJvdCB8fCBtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICByZXF1aXJlKF9jdXN0b21lciAhPSBhZGRyZXNzKDApKTsKICAgICAgIHJlbGVhc2VBY2NvdW50KF9jdXN0b21lcik7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlUmVsZWFzZTZtKGFkZHJlc3MgX25ldykgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgaWYgKGlzRmluaXNoZWQpIHsKICAgICAgICAgICAgY2hhbmdlUmVsZWFzZUFjY291bnQocmVsZWFzZTZtLF9uZXcpOwogICAgICAgIH0KICAgICAgICByZWxlYXNlNm0gPSBfbmV3OwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYW5nZVJlbGVhc2UxMm0oYWRkcmVzcyBfbmV3KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBpZiAoaXNGaW5pc2hlZCkgewogICAgICAgICAgICBjaGFuZ2VSZWxlYXNlQWNjb3VudChyZWxlYXNlMTJtLF9uZXcpOwogICAgICAgIH0KICAgICAgICByZWxlYXNlMTJtID0gX25ldzsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGFuZ2VSZWxlYXNlMThtKGFkZHJlc3MgX25ldykgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgaWYgKGlzRmluaXNoZWQpIHsKICAgICAgICAgICAgY2hhbmdlUmVsZWFzZUFjY291bnQocmVsZWFzZTE4bSxfbmV3KTsKICAgICAgICB9CiAgICAgICAgcmVsZWFzZTE4bSA9IF9uZXc7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkQ2VydGlmaWNhdGUoc3RyaW5nIF9pZCwgIGFkZHJlc3MgX293bmVyKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjZXJ0Ym90IHx8IG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIHJlcXVpcmUoY2VydGlmaWNhdGVbX2lkXSA9PSBhZGRyZXNzKDApKTsKICAgICAgICBpZiAoX293bmVyICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgY2VydGlmaWNhdGVbX2lkXSA9IF9vd25lcjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjZXJ0aWZpY2F0ZVtfaWRdID0gb3duZXI7CiAgICAgICAgfSAgICAKICAgIH0KCiAgICBmdW5jdGlvbiBlZGl0Q2VydGlmaWNhdGUoc3RyaW5nIF9pZCwgIGFkZHJlc3MgX25ld293bmVyKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoY2VydGlmaWNhdGVbX2lkXSAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY2VydGlmaWNhdGVbX2lkXSB8fCBtc2cuc2VuZGVyID09IGNlcnRib3QgfHwgbXNnLnNlbmRlciA9PSBvd25lciApOwogICAgICAgIGNlcnRpZmljYXRlW19pZF0gPSBfbmV3b3duZXI7CiAgICB9CgogICAgZnVuY3Rpb24gY2hlY2tDZXJ0aWZpY2F0ZShzdHJpbmcgX2lkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICAgICAgcmV0dXJuIGNlcnRpZmljYXRlW19pZF07CiAgICB9CgogICAgZnVuY3Rpb24gZGVsZXRlQ2VydGlmaWNhdGUoc3RyaW5nIF9pZCkgcHVibGljICB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNlcnRib3QgfHwgbXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgZGVsZXRlIGNlcnRpZmljYXRlW19pZF07CiAgICB9CgogICAgZnVuY3Rpb24gcmVnaXN0ZXJDdXN0b21lcihhZGRyZXNzIF9jdXN0b21lciwgYWRkcmVzcyBfcmVmZXJyYWwpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHJlZ2lzdGVyYm90IHx8IG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIHJlcXVpcmUoX2N1c3RvbWVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlZ2lzdGVyZWRbX2N1c3RvbWVyXSA9IHRydWU7CiAgICAgICAgaWYgKF9yZWZlcnJhbCAhPSBhZGRyZXNzKDApICYmIF9yZWZlcnJhbCAhPSBfY3VzdG9tZXIpIHsKICAgICAgICAgICAgcmVmZXJyYWxbX2N1c3RvbWVyXSA9IF9yZWZlcnJhbDsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gY2hlY2tDdXN0b21lcihhZGRyZXNzIF9jdXN0b21lcikgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCwgYWRkcmVzcykgewogICAgICAgIHJldHVybiAoIHJlZ2lzdGVyZWRbX2N1c3RvbWVyXSwgcmVmZXJyYWxbX2N1c3RvbWVyXSk7CiAgICB9CgogICAgLy8gaW1wb3J0IHByZUlDTyBjdXN0b21lcnMgZnJvbSAweDUxNjEzMDg1NmU3NDMwOTBhZjlkN2ZkOTVkNmZjOTRjODc0M2E0ZTEKICAgIGZ1bmN0aW9uIGltcG9ydEN1c3RvbWVyKGFkZHJlc3MgX2N1c3RvbWVyLCBhZGRyZXNzIF9yZWZlcnJhbCwgdWludCBfdG9rZW5BbW91bnQpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHJlZ2lzdGVyYm90IHx8IG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIHJlcXVpcmUoX2N1c3RvbWVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUobm93IDwgc3RhcnRTYWxlKTsgLy8gYmVmb3JlIElDTyBzdGFydHMKICAgICAgICByZWdpc3RlcmVkW19jdXN0b21lcl0gPSB0cnVlOwogICAgICAgIGlmIChfcmVmZXJyYWwgIT0gYWRkcmVzcygwKSAmJiBfcmVmZXJyYWwgIT0gX2N1c3RvbWVyKSB7CiAgICAgICAgICAgIHJlZmVycmFsW19jdXN0b21lcl0gPSBfcmVmZXJyYWw7CiAgICAgICAgfQogICAgICAgIG1pbnQoX2N1c3RvbWVyLCBfdG9rZW5BbW91bnQsIG5vdyArIDk5ICogMSB5ZWFycyk7IC8vIHRpbGwgS1lDIGlzIGNvbXBsZXRlZAogICAgfQoKICAgIGZ1bmN0aW9uIGRlbGV0ZUN1c3RvbWVyKGFkZHJlc3MgX2N1c3RvbWVyKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSByZWdpc3RlcmJvdCB8fCBtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICByZXF1aXJlKF9jdXN0b21lciE9IGFkZHJlc3MoMCkpOwogICAgICAgIGRlbGV0ZSByZWdpc3RlcmVkW19jdXN0b21lcl07CiAgICAgICAgZGVsZXRlIHJlZmVycmFsW19jdXN0b21lcl07CiAgICAgICAgLy8gRHJhaW4gdG9rZW5zCiAgICAgICAgdW5NaW50KF9jdXN0b21lcik7CiAgICB9CgogICAgZnVuY3Rpb24gZ2xvYmFsUGF1c2UoYm9vbCBfc3RhdGUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIGlzR2xvYmFsUGF1c2UgPSBfc3RhdGU7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlUmF0ZVNhbGUodWludCBfdG9rZW5BbW91bnQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoaXNHbG9iYWxQYXVzZSB8fCAobm93ID4gc3RhcnRTYWxlICYmIG5vdyA8IGZpbmlzaFNhbGUpKTsKICAgICAgICByYXRlU2FsZSA9IF90b2tlbkFtb3VudDsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGFuZ2VTdGFydFNhbGUodWludDI1NiBfdHMpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHN0YXJ0U2FsZSA9IF90czsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGFuZ2VNaW5Ub2tlblNhbGUodWludDI1NiBfdHMpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIG1pblRva2VuU2FsZSA9IF90czsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGFuZ2VGaW5pc2hTYWxlKHVpbnQyNTYgX3RzKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBmaW5pc2hTYWxlID0gX3RzOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEF1Y3Rpb24odWludDI1NiBfc3RhcnRBdWN0aW9uLCB1aW50MjU2IF9maW5pc2hBdWN0aW9uLCB1aW50MjU2IF9hdWN0aW9uUGVyY2VudCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShfc3RhcnRBdWN0aW9uIDwgX2ZpbmlzaEF1Y3Rpb24pOwogICAgICAgIHJlcXVpcmUoX2F1Y3Rpb25QZXJjZW50ID4gMCk7CiAgICAgICAgcmVxdWlyZShfc3RhcnRBdWN0aW9uID4gc3RhcnRTYWxlKTsKICAgICAgICByZXF1aXJlKF9maW5pc2hBdWN0aW9uIDw9IGZpbmlzaFNhbGUpOwogICAgICAgIGZpbmlzaEF1Y3Rpb24gPSBfZmluaXNoQXVjdGlvbjsKICAgICAgICBzdGFydEF1Y3Rpb24gPSBfc3RhcnRBdWN0aW9uOwogICAgICAgIGF1Y3Rpb25QZXJjZW50ID0gX2F1Y3Rpb25QZXJjZW50OwogICAgfQoKICAgIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKCFpc0ZpbmlzaGVkKTsKICAgICAgICBpc0ZpbmlzaGVkPXRydWU7CiAgICAgICAgdWludCBpc3N1ZWRUb2tlblN1cHBseSA9IHRvdGFsU3VwcGx5OwogICAgICAgIC8vIDQwJSByZXN0cmljdGVkICsgNjAlIGlzc3VlZFRva2VuU3VwcGx5ID0gMTAwJQogICAgICAgIHVpbnQgcmVzdHJpY3RlZFRva2VucyA9IGlzc3VlZFRva2VuU3VwcGx5Lm11bChyZXN0cmljdGVkUGVyY2VudCkuZGl2KDEwMCAtIHJlc3RyaWN0ZWRQZXJjZW50KTsKICAgICAgICBpc3N1ZWRUb2tlblN1cHBseSA9IGlzc3VlZFRva2VuU3VwcGx5LmFkZChyZXN0cmljdGVkVG9rZW5zKTsKICAgICAgICAvLyAxMyUgLSAxMSUgZm9yIGFueSBwdXJwb3NlIGFuZCAyJSBib3VudHkKICAgICAgICBtaW50KHJlc3RyaWN0ZWQsIGlzc3VlZFRva2VuU3VwcGx5Lm11bCgxMykuZGl2KDEwMCksIG5vdyk7CiAgICAgICAgLy8gMjclIC0gZnJlZXplZCBmb3VuZHMgdG8gdGVhbSAmIGFkd2lzZXJzCiAgICAgICAgbWludChyZWxlYXNlNm0sIGlzc3VlZFRva2VuU3VwcGx5Lm11bCg4NSkuZGl2KDEwMDApLCBub3cgKyAxODAgKiAxIGRheXMpOyAvLyA4LjUgJQogICAgICAgIG1pbnQocmVsZWFzZTEybSwgaXNzdWVkVG9rZW5TdXBwbHkubXVsKDg1KS5kaXYoMTAwMCksIG5vdyArIDM2NSAqIDEgZGF5cyk7IC8vIDguNSAlCiAgICAgICAgbWludChyZWxlYXNlMThtLCBpc3N1ZWRUb2tlblN1cHBseS5tdWwoMTApLmRpdigxMDApLCBub3cgKyA1NDUgKiAxIGRheXMpOyAvLyAxMCAlCiAgICAgICAgbWludGluZ0ZpbmlzaGVkPXRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gZm9yZWlnbkJ1eVRlc3QodWludDI1NiBfd2VpQW1vdW50LCB1aW50MjU2IF9yYXRlKSBwdWJsaWMgcHVyZSByZXR1cm5zICh1aW50IHRva2VuQW1vdW50KSB7CiAgICAgICAgcmVxdWlyZShfd2VpQW1vdW50ID4gMCk7CiAgICAgICAgcmVxdWlyZShfcmF0ZSA+IDApOwogICAgICAgIHJldHVybiBfcmF0ZS5tdWwoX3dlaUFtb3VudCkuZGl2KDEgZXRoZXIpOwogICAgfQogICAgCiAgICAvLyBCVEMgZXh0ZXJuYWwgcGF5bWVudHMKICAgIGZ1bmN0aW9uIGZvcmVpZ25CdXkoYWRkcmVzcyBfaG9sZGVyLCB1aW50MjU2IF93ZWlBbW91bnQsIHVpbnQyNTYgX3JhdGUpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHJlZ2lzdGVyYm90IHx8IG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIHJlcXVpcmUoX3dlaUFtb3VudCA+IDApOwogICAgICAgIHJlcXVpcmUoX3JhdGUgPiAwKTsKICAgICAgICByZWdpc3RlcmVkW19ob2xkZXJdID0gdHJ1ZTsKICAgICAgICB1aW50IHRva2VucyA9IF9yYXRlLm11bChfd2VpQW1vdW50KS5kaXYoMSBldGhlcik7CiAgICAgICAgbWludChfaG9sZGVyLCB0b2tlbnMsIG5vdyArIDk5ICogMSB5ZWFycyk7IC8vIHRpbGwgS1lDIGlzIGNvbXBsZXRlZAogICAgICAgIHRvdGFsV2VpU2FsZSA9IHRvdGFsV2VpU2FsZS5hZGQoX3dlaUFtb3VudCk7CiAgICB9CgogICAgZnVuY3Rpb24gY3JlYXRlVG9rZW5zKCkgcHVibGljIGlzUmVnaXN0ZXJlZCBhbnlTYWxlSXNPbiBpc1VuZGVySGFyZENhcCBwYXlhYmxlIHsKICAgICAgICB1aW50IHRva2VucyA9IHJhdGVTYWxlLm11bChtc2cudmFsdWUpLmRpdigxIGV0aGVyKTsKICAgICAgICByZXF1aXJlKHRva2VucyA+PSBtaW5Ub2tlblNhbGUpOyAvLyBtaW4gMTAgdG9rZW5zCiAgICAgICAgbXVsdGlzaWcudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgICAgICB1aW50IHBlcmNlbnQgPSAwOwogICAgICAgIHVpbnQgYm9udXNUb2tlbnMgPSAwOwogICAgICAgIHVpbnQgZmluaXNoQm9udXMgPSBzdGFydFNhbGUgKyAoYm9udXNQZXJpb2QgKiAxIGRheXMpOwogICAgICAgIGlmICggbm93IDwgZmluaXNoQm9udXMgKSB7CiAgICAgICAgICAgIGlmICggbm93IDw9IHN0YXJ0U2FsZSArIDEgZGF5cyApIHsKICAgICAgICAgICAgICAgIHBlcmNlbnQgPSBmaXJzdDI0UGVyY2VudDsgICAvLyAxc3QgZGF5OiA1MCUgKGZvciByZWdpc3RlcmVkIHdoaXRlbGlzdCBvbmx5KQogICAgICAgICAgIH0gZWxzZSB7ICAgICAgICAvLyAyNSUgdG90YWw6CiAgICAgICAgICAgICAgIHBlcmNlbnQgPSAoZmluaXNoQm9udXMgLSBub3cpLmRpdigxIGRheXMpOyAvLyBsYXN0IDE1ZGF5cyAtMSUgZXZlcnkgZGF5CiAgICAgICAgICAgICAgIGlmICggcGVyY2VudCA+PSAxNSApIHsgIC8vICBmaXJzdCA1ZGF5cywgLTElIGV2ZXJ5IDEyaAogICAgICAgICAgICAgICAgICBwZXJjZW50ID0gMjcgLSAobm93IC0gc3RhcnRTYWxlKS5kaXYoMSBob3VycykuZGl2KDEyKTsKICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgcGVyY2VudCA9IHBlcmNlbnQuYWRkKDEpOwogICAgICAgICAgICAgICB9CQkJCQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICggbm93ID49IHN0YXJ0QXVjdGlvbiAmJiBub3cgPCBmaW5pc2hBdWN0aW9uICkgewogICAgICAgICAgICAgICAgcGVyY2VudCA9IGF1Y3Rpb25QZXJjZW50OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICggcGVyY2VudCA+IDAgKSB7CiAgICAgICAgICAgIGJvbnVzVG9rZW5zID0gdG9rZW5zLm11bChwZXJjZW50KS5kaXYoMTAwKTsKICAgICAgICAgICAgdG9rZW5zID0gdG9rZW5zLmFkZChib251c1Rva2Vucyk7CiAgICAgICAgfQoKICAgICAgICB0b3RhbFdlaVNhbGUgPSB0b3RhbFdlaVNhbGUuYWRkKG1zZy52YWx1ZSk7CiAgICAgICAgbWludChtc2cuc2VuZGVyLCB0b2tlbnMsIG5vdyArIDk5ICogMSB5ZWFycyk7IC8vIHRpbGwgS1lDIGlzIGNvbXBsZXRlZAoKICAgICAgICBpZiAoIHJlZmVycmFsW21zZy5zZW5kZXJdICE9IGFkZHJlc3MoMCkgKSB7CiAgICAgICAgICAgIHVpbnQgcmVmZXJlclRva2VucyA9IHRva2Vucy5tdWwocmVmZXJlclBlcmNlbnQpLmRpdigxMDAwKTsKICAgICAgICAgICAgbWludChyZWZlcnJhbFttc2cuc2VuZGVyXSwgcmVmZXJlclRva2Vucywgbm93ICsgOTkgKiAxIHllYXJzKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24oKSBleHRlcm5hbCBpc1JlZ2lzdGVyZWQgYW55U2FsZUlzT24gaXNVbmRlckhhcmRDYXAgcGF5YWJsZSB7CiAgICAgICAgY3JlYXRlVG9rZW5zKCk7CiAgICB9CiAgICAKfQ=='.
	

]
