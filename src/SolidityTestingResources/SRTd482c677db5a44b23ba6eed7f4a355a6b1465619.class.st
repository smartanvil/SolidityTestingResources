Class {
	#name : #SRTd482c677db5a44b23ba6eed7f4a355a6b1465619,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd482c677db5a44b23ba6eed7f4a355a6b1465619 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7Cgpjb250cmFjdCBJVG9rZW4gewogICAgZnVuY3Rpb24gZXhlY3V0ZVNldHRpbmdzQ2hhbmdlKAogICAgICAgIHVpbnQgYW1vdW50LCAKICAgICAgICB1aW50IHBhcnRJbnZlc3RvciwKICAgICAgICB1aW50IHBhcnRQcm9qZWN0LCAKICAgICAgICB1aW50IHBhcnRGb3VuZGVycywgCiAgICAgICAgdWludCBibG9ja3NQZXJTdGFnZSwgCiAgICAgICAgdWludCBwYXJ0SW52ZXN0b3JJbmNyZWFzZVBlclN0YWdlLAogICAgICAgIHVpbnQgbWF4U3RhZ2VzCiAgICApOwp9CgoKY29udHJhY3QgTXVsdGlTaWdXYWxsZXQgewoKICAgIHVpbnQgY29uc3RhbnQgcHVibGljIE1BWF9PV05FUl9DT1VOVCA9IDUwOwogICAgbWFwcGluZyAodWludCA9PiBUcmFuc2FjdGlvbikgcHVibGljIHRyYW5zYWN0aW9uczsKICAgIG1hcHBpbmcgKHVpbnQgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSkgcHVibGljIGNvbmZpcm1hdGlvbnM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBpc093bmVyOwogICAgYWRkcmVzc1tdIHB1YmxpYyBvd25lcnM7CiAgICBhZGRyZXNzIG93bmVyOyAvL3RoZSBvbmUgd2hvIGNyZWF0ZXMgdGhlIGNvbnRyYWN0LCBvbmx5IHRoaXMgcGVyc29uIGNhbiBzZXQgdGhlIHRva2VuCiAgICB1aW50IHB1YmxpYyByZXF1aXJlZDsKICAgIHVpbnQgcHVibGljIHRyYW5zYWN0aW9uQ291bnQ7CgogICAgZXZlbnQgQ29uZmlybWF0aW9uKGFkZHJlc3MgaW5kZXhlZCBzZW5kZXIsIHVpbnQgaW5kZXhlZCB0cmFuc2FjdGlvbklkKTsKICAgIGV2ZW50IFJldm9jYXRpb24oYWRkcmVzcyBpbmRleGVkIHNlbmRlciwgdWludCBpbmRleGVkIHRyYW5zYWN0aW9uSWQpOwogICAgZXZlbnQgU3VibWlzc2lvbih1aW50IGluZGV4ZWQgdHJhbnNhY3Rpb25JZCk7CiAgICBldmVudCBFeGVjdXRpb24odWludCBpbmRleGVkIHRyYW5zYWN0aW9uSWQpOwogICAgZXZlbnQgRXhlY3V0aW9uRmFpbHVyZSh1aW50IGluZGV4ZWQgdHJhbnNhY3Rpb25JZCk7CiAgICBldmVudCBEZXBvc2l0KGFkZHJlc3MgaW5kZXhlZCBzZW5kZXIsIHVpbnQgdmFsdWUpOwogICAgZXZlbnQgT3duZXJBZGRpdGlvbihhZGRyZXNzIGluZGV4ZWQgb3duZXIpOwogICAgZXZlbnQgT3duZXJSZW1vdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lcik7CiAgICBldmVudCBSZXF1aXJlbWVudENoYW5nZSh1aW50IHJlcXVpcmVkKTsKICAgCiAgICBJVG9rZW4gcHVibGljIHRva2VuOwoKICAgIHN0cnVjdCBTZXR0aW5nc1JlcXVlc3QgewogICAgICAgIHVpbnQgYW1vdW50OwogICAgICAgIHVpbnQgcGFydEludmVzdG9yOwogICAgICAgIHVpbnQgcGFydFByb2plY3Q7CiAgICAgICAgdWludCBwYXJ0Rm91bmRlcnM7CiAgICAgICAgdWludCBibG9ja3NQZXJTdGFnZTsKICAgICAgICB1aW50IHBhcnRJbnZlc3RvckluY3JlYXNlUGVyU3RhZ2U7CiAgICAgICAgdWludCBtYXhTdGFnZXM7CiAgICAgICAgYm9vbCBleGVjdXRlZDsKICAgICAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgY29uZmlybWF0aW9uczsKICAgIH0KCiAgICB1aW50IHNldHRpbmdzUmVxdWVzdHNDb3VudCA9IDA7CiAgICBtYXBwaW5nKHVpbnQgPT4gU2V0dGluZ3NSZXF1ZXN0KSBzZXR0aW5nc1JlcXVlc3RzOwoKICAgIHN0cnVjdCBUcmFuc2FjdGlvbiB7IAogICAgICAgIGFkZHJlc3MgZGVzdGluYXRpb247CiAgICAgICAgdWludCB2YWx1ZTsKICAgICAgICBieXRlcyBkYXRhOwogICAgICAgIGJvb2wgZXhlY3V0ZWQ7CiAgICB9CgogICAgbW9kaWZpZXIgb25seVdhbGxldCgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYWRkcmVzcyh0aGlzKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICBtb2RpZmllciBvd25lckRvZXNOb3RFeGlzdChhZGRyZXNzIF9vd25lcikgewogICAgICAgIHJlcXVpcmUoIWlzT3duZXJbX293bmVyXSk7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgbW9kaWZpZXIgb3duZXJFeGlzdHMoYWRkcmVzcyBfb3duZXIpIHsKICAgICAgICByZXF1aXJlKGlzT3duZXJbX293bmVyXSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciB0cmFuc2FjdGlvbkV4aXN0cyh1aW50IF90cmFuc2FjdGlvbklkKSB7CiAgICAgICAgcmVxdWlyZSh0cmFuc2FjdGlvbnNbX3RyYW5zYWN0aW9uSWRdLmRlc3RpbmF0aW9uICE9IDApOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgY29uZmlybWVkKHVpbnQgX3RyYW5zYWN0aW9uSWQsIGFkZHJlc3MgX293bmVyKSB7CiAgICAgICAgcmVxdWlyZShjb25maXJtYXRpb25zW190cmFuc2FjdGlvbklkXVtfb3duZXJdKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG5vdENvbmZpcm1lZCh1aW50IF90cmFuc2FjdGlvbklkLCBhZGRyZXNzIF9vd25lcikgewogICAgICAgIHJlcXVpcmUoIWNvbmZpcm1hdGlvbnNbX3RyYW5zYWN0aW9uSWRdW19vd25lcl0pOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgbm90RXhlY3V0ZWQodWludCBfdHJhbnNhY3Rpb25JZCkgewogICAgICAgIHJlcXVpcmUoIXRyYW5zYWN0aW9uc1tfdHJhbnNhY3Rpb25JZF0uZXhlY3V0ZWQpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgbm90TnVsbChhZGRyZXNzIF9hZGRyZXNzKSB7CiAgICAgICAgcmVxdWlyZShfYWRkcmVzcyAhPSAwKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIHZhbGlkUmVxdWlyZW1lbnQodWludCBvd25lckNvdW50LCB1aW50IF9yZXF1aXJlZCkgewogICAgICAgIHJlcXVpcmUob3duZXJDb3VudCA8IE1BWF9PV05FUl9DT1VOVAogICAgICAgICAgICAmJiBfcmVxdWlyZWQgPD0gb3duZXJDb3VudAogICAgICAgICAgICAmJiBfcmVxdWlyZWQgIT0gMAogICAgICAgICAgICAmJiBvd25lckNvdW50ICE9IDApOwogICAgICAgIF87CiAgICB9CgogICAgLy8vIEBkZXYgRmFsbGJhY2sgZnVuY3Rpb24gYWxsb3dzIHRvIGRlcG9zaXQgZXRoZXIuCiAgICBmdW5jdGlvbigpIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICBpZiAobXNnLnZhbHVlID4gMCkKICAgICAgICAgICAgRGVwb3NpdChtc2cuc2VuZGVyLCBtc2cudmFsdWUpOwogICAgfQoKICAgIC8vLyBAZGV2IENvbnRyYWN0IGNvbnN0cnVjdG9yIHNldHMgaW5pdGlhbCBvd25lcnMgYW5kIHJlcXVpcmVkIG51bWJlciBvZiBjb25maXJtYXRpb25zLgogICAgLy8vIEBwYXJhbSBfb3duZXJzIExpc3Qgb2YgaW5pdGlhbCBvd25lcnMuCiAgICAvLy8gQHBhcmFtIF9yZXF1aXJlZCBOdW1iZXIgb2YgcmVxdWlyZWQgY29uZmlybWF0aW9ucy4KICAgIGZ1bmN0aW9uIE11bHRpU2lnV2FsbGV0KGFkZHJlc3NbXSBfb3duZXJzLCB1aW50IF9yZXF1aXJlZCkgcHVibGljIHZhbGlkUmVxdWlyZW1lbnQoX293bmVycy5sZW5ndGgsIF9yZXF1aXJlZCkgewogICAgICAgIGZvciAodWludCBpPTA7IGk8X293bmVycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICByZXF1aXJlKCFpc093bmVyW19vd25lcnNbaV1dICYmIF9vd25lcnNbaV0gIT0gMCk7CiAgICAgICAgICAgIGlzT3duZXJbX293bmVyc1tpXV0gPSB0cnVlOwogICAgICAgIH0KICAgICAgICBvd25lcnMgPSBfb3duZXJzOwogICAgICAgIHJlcXVpcmVkID0gX3JlcXVpcmVkOwogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRUb2tlbihhZGRyZXNzIF90b2tlbikgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZSh0b2tlbiA9PSBhZGRyZXNzKDApKTsKICAgICAgICB0b2tlbiA9IElUb2tlbihfdG9rZW4pOwogICAgfQoKICAgIC8vLS0tLS0tLS0tLS0tLS0tLSBUR0UgU0VUVElOR1MgLS0tLS0tLS0tLS0KICAgIC8vLyBAZGV2IFNlbmRzIHJlcXVlc3QgdG8gY2hhbmdlIHNldHRpbmdzCiAgICAvLy8gQHJldHVybiBUcmFuc2FjdGlvbiBJRAogICAgZnVuY3Rpb24gdGdlU2V0dGluZ3NDaGFuZ2VSZXF1ZXN0KAogICAgICAgIHVpbnQgYW1vdW50LCAKICAgICAgICB1aW50IHBhcnRJbnZlc3RvciwKICAgICAgICB1aW50IHBhcnRQcm9qZWN0LCAKICAgICAgICB1aW50IHBhcnRGb3VuZGVycywgCiAgICAgICAgdWludCBibG9ja3NQZXJTdGFnZSwgCiAgICAgICAgdWludCBwYXJ0SW52ZXN0b3JJbmNyZWFzZVBlclN0YWdlLAogICAgICAgIHVpbnQgbWF4U3RhZ2VzCiAgICApIAogICAgcHVibGljCiAgICBvd25lckV4aXN0cyhtc2cuc2VuZGVyKQogICAgcmV0dXJucyAodWludCBfdHhJbmRleCkgCiAgICB7CiAgICAgICAgYXNzZXJ0KGFtb3VudCpwYXJ0SW52ZXN0b3IqcGFydFByb2plY3QqYmxvY2tzUGVyU3RhZ2UqcGFydEludmVzdG9ySW5jcmVhc2VQZXJTdGFnZSptYXhTdGFnZXMgIT0gMCk7IC8vYXNzZXJ0aW5nIG5vIHBhcmFtZXRlciBpcyB6ZXJvIGV4Y2VwdCBwYXJ0Rm91bmRlcnMKICAgICAgICBfdHhJbmRleCA9IHNldHRpbmdzUmVxdWVzdHNDb3VudDsKICAgICAgICBzZXR0aW5nc1JlcXVlc3RzW190eEluZGV4XSA9IFNldHRpbmdzUmVxdWVzdCh7CiAgICAgICAgICAgIGFtb3VudDogYW1vdW50LAogICAgICAgICAgICBwYXJ0SW52ZXN0b3I6IHBhcnRJbnZlc3RvciwKICAgICAgICAgICAgcGFydFByb2plY3Q6IHBhcnRQcm9qZWN0LAogICAgICAgICAgICBwYXJ0Rm91bmRlcnM6IHBhcnRGb3VuZGVycywKICAgICAgICAgICAgYmxvY2tzUGVyU3RhZ2U6IGJsb2Nrc1BlclN0YWdlLAogICAgICAgICAgICBwYXJ0SW52ZXN0b3JJbmNyZWFzZVBlclN0YWdlOiBwYXJ0SW52ZXN0b3JJbmNyZWFzZVBlclN0YWdlLAogICAgICAgICAgICBtYXhTdGFnZXM6IG1heFN0YWdlcywKICAgICAgICAgICAgZXhlY3V0ZWQ6IGZhbHNlCiAgICAgICAgfSk7CiAgICAgICAgc2V0dGluZ3NSZXF1ZXN0c0NvdW50Kys7CiAgICAgICAgY29uZmlybVNldHRpbmdzQ2hhbmdlKF90eEluZGV4KTsKICAgICAgICByZXR1cm4gX3R4SW5kZXg7CiAgICB9CgogICAgLy8vIEBkZXYgQWxsb3dzIGFuIG93bmVyIHRvIGNvbmZpcm0gYSBjaGFuZ2Ugc2V0dGluZ3MgcmVxdWVzdC4KICAgIC8vLyBAcGFyYW0gX3R4SW5kZXggVHJhbnNhY3Rpb24gSUQuCiAgICBmdW5jdGlvbiBjb25maXJtU2V0dGluZ3NDaGFuZ2UodWludCBfdHhJbmRleCkgcHVibGljIG93bmVyRXhpc3RzKG1zZy5zZW5kZXIpIHJldHVybnMoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmVxdWlyZShzZXR0aW5nc1JlcXVlc3RzW190eEluZGV4XS5leGVjdXRlZCA9PSBmYWxzZSk7CiAgICAgICAgc2V0dGluZ3NSZXF1ZXN0c1tfdHhJbmRleF0uY29uZmlybWF0aW9uc1ttc2cuc2VuZGVyXSA9IHRydWU7CiAgICAgICAgaWYoaXNDb25maXJtZWRTZXR0aW5nc1JlcXVlc3QoX3R4SW5kZXgpKXsKICAgICAgICAgICAgU2V0dGluZ3NSZXF1ZXN0IHN0b3JhZ2UgcmVxdWVzdCA9IHNldHRpbmdzUmVxdWVzdHNbX3R4SW5kZXhdOwogICAgICAgICAgICByZXF1ZXN0LmV4ZWN1dGVkID0gdHJ1ZTsKICAgICAgICAgICAgSVRva2VuKHRva2VuKS5leGVjdXRlU2V0dGluZ3NDaGFuZ2UoCiAgICAgICAgICAgICAgICByZXF1ZXN0LmFtb3VudCwgCiAgICAgICAgICAgICAgICByZXF1ZXN0LnBhcnRJbnZlc3RvciwKICAgICAgICAgICAgICAgIHJlcXVlc3QucGFydFByb2plY3QsCiAgICAgICAgICAgICAgICByZXF1ZXN0LnBhcnRGb3VuZGVycywKICAgICAgICAgICAgICAgIHJlcXVlc3QuYmxvY2tzUGVyU3RhZ2UsCiAgICAgICAgICAgICAgICByZXF1ZXN0LnBhcnRJbnZlc3RvckluY3JlYXNlUGVyU3RhZ2UsCiAgICAgICAgICAgICAgICByZXF1ZXN0Lm1heFN0YWdlcwogICAgICAgICAgICApOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGlzQ29uZmlybWVkU2V0dGluZ3NSZXF1ZXN0KHVpbnQgdHJhbnNhY3Rpb25JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHVpbnQgY291bnQgPSAwOwogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IG93bmVycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoc2V0dGluZ3NSZXF1ZXN0c1t0cmFuc2FjdGlvbklkXS5jb25maXJtYXRpb25zW293bmVyc1tpXV0pCiAgICAgICAgICAgICAgICBjb3VudCArPSAxOwogICAgICAgICAgICBpZiAoY291bnQgPT0gcmVxdWlyZWQpCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFNldHRpbmdzQ2hhbmdlQ29uZmlybWF0aW9uQ291bnQodWludCBfdHhJbmRleCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCBjb3VudCkgewogICAgICAgIGZvciAodWludCBpPTA7IGk8b3duZXJzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBpZiAoc2V0dGluZ3NSZXF1ZXN0c1tfdHhJbmRleF0uY29uZmlybWF0aW9uc1tvd25lcnNbaV1dKQogICAgICAgICAgICAgICAgY291bnQgKz0gMTsKICAgIH0KCiAgICAvLy8gQGRldiBTaG93cyB3aGF0IHNldHRpbmdzIHdlcmUgcmVxdWVzdGVkIGluIGEgc2V0dGluZ3MgY2hhbmdlIHJlcXVlc3QKICAgIGZ1bmN0aW9uIHZpZXdTZXR0aW5nc0NoYW5nZSh1aW50IF90eEluZGV4KSBwdWJsaWMgY29uc3RhbnQgCiAgICByZXR1cm5zICh1aW50IGFtb3VudCwgdWludCBwYXJ0SW52ZXN0b3IsIHVpbnQgcGFydFByb2plY3QsIHVpbnQgcGFydEZvdW5kZXJzLCB1aW50IGJsb2Nrc1BlclN0YWdlLCB1aW50IHBhcnRJbnZlc3RvckluY3JlYXNlUGVyU3RhZ2UsIHVpbnQgbWF4U3RhZ2VzKSB7CiAgICAgICAgU2V0dGluZ3NSZXF1ZXN0IG1lbW9yeSByZXF1ZXN0ID0gc2V0dGluZ3NSZXF1ZXN0c1tfdHhJbmRleF07CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgcmVxdWVzdC5hbW91bnQsCiAgICAgICAgICAgIHJlcXVlc3QucGFydEludmVzdG9yLCAKICAgICAgICAgICAgcmVxdWVzdC5wYXJ0UHJvamVjdCwKICAgICAgICAgICAgcmVxdWVzdC5wYXJ0Rm91bmRlcnMsCiAgICAgICAgICAgIHJlcXVlc3QuYmxvY2tzUGVyU3RhZ2UsCiAgICAgICAgICAgIHJlcXVlc3QucGFydEludmVzdG9ySW5jcmVhc2VQZXJTdGFnZSwKICAgICAgICAgICAgcmVxdWVzdC5tYXhTdGFnZXMKICAgICAgICApOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyB0byBhZGQgYSBuZXcgb3duZXIuIFRyYW5zYWN0aW9uIGhhcyB0byBiZSBzZW50IGJ5IHdhbGxldC4KICAgIC8vLyBAcGFyYW0gX293bmVyIEFkZHJlc3Mgb2YgbmV3IG93bmVyLgogICAgZnVuY3Rpb24gYWRkT3duZXIoYWRkcmVzcyBfb3duZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seVdhbGxldAogICAgICAgIG93bmVyRG9lc05vdEV4aXN0KF9vd25lcikKICAgICAgICBub3ROdWxsKF9vd25lcikKICAgICAgICB2YWxpZFJlcXVpcmVtZW50KG93bmVycy5sZW5ndGggKyAxLCByZXF1aXJlZCkKICAgIHsKICAgICAgICBpc093bmVyW293bmVyXSA9IHRydWU7CiAgICAgICAgb3duZXJzLnB1c2goX293bmVyKTsKICAgICAgICBPd25lckFkZGl0aW9uKF9vd25lcik7CiAgICB9CiAgICAvLy8gQGRldiBBbGxvd3MgdG8gcmVtb3ZlIGFuIG93bmVyLiBUcmFuc2FjdGlvbiBoYXMgdG8gYmUgc2VudCBieSB3YWxsZXQuCiAgICAvLy8gQHBhcmFtIF9vd25lciBBZGRyZXNzIG9mIG93bmVyLgogICAgZnVuY3Rpb24gcmVtb3ZlT3duZXIoYWRkcmVzcyBfb3duZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seVdhbGxldAogICAgICAgIG93bmVyRXhpc3RzKF9vd25lcikKICAgIHsKICAgICAgICBpc093bmVyW19vd25lcl0gPSBmYWxzZTsKICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPG93bmVycy5sZW5ndGggLSAxOyBpKyspCiAgICAgICAgICAgIGlmIChvd25lcnNbaV0gPT0gX293bmVyKSB7CiAgICAgICAgICAgICAgICBvd25lcnNbaV0gPSBvd25lcnNbb3duZXJzLmxlbmd0aCAtIDFdOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICBvd25lcnMubGVuZ3RoIC09IDE7CiAgICAgICAgaWYgKHJlcXVpcmVkID4gb3duZXJzLmxlbmd0aCkKICAgICAgICAgICAgY2hhbmdlUmVxdWlyZW1lbnQob3duZXJzLmxlbmd0aCk7CiAgICAgICAgT3duZXJSZW1vdmFsKF9vd25lcik7CiAgICB9CgogICAgLy8vIEBkZXYgQWxsb3dzIHRvIHJlcGxhY2UgYW4gb3duZXIgd2l0aCBhIG5ldyBvd25lci4gVHJhbnNhY3Rpb24gaGFzIHRvIGJlIHNlbnQgYnkgd2FsbGV0LgogICAgLy8vIEBwYXJhbSBfb3duZXIgQWRkcmVzcyBvZiBvd25lciB0byBiZSByZXBsYWNlZC4KICAgIC8vLyBAcGFyYW0gX25ld093bmVyIEFkZHJlc3Mgb2YgbmV3IG93bmVyLgogICAgZnVuY3Rpb24gcmVwbGFjZU93bmVyKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9uZXdPd25lcikKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5V2FsbGV0CiAgICAgICAgb3duZXJFeGlzdHMoX293bmVyKQogICAgICAgIG93bmVyRG9lc05vdEV4aXN0KF9uZXdPd25lcikKICAgIHsKICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPG93bmVycy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKG93bmVyc1tpXSA9PSBfb3duZXIpIHsKICAgICAgICAgICAgICAgIG93bmVyc1tpXSA9IF9uZXdPd25lcjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgaXNPd25lcltfb3duZXJdID0gZmFsc2U7CiAgICAgICAgaXNPd25lcltfbmV3T3duZXJdID0gdHJ1ZTsKICAgICAgICBPd25lclJlbW92YWwoX293bmVyKTsKICAgICAgICBPd25lckFkZGl0aW9uKF9uZXdPd25lcik7CiAgICB9CgogICAgLy8vIEBkZXYgQWxsb3dzIHRvIGNoYW5nZSB0aGUgbnVtYmVyIG9mIHJlcXVpcmVkIGNvbmZpcm1hdGlvbnMuIFRyYW5zYWN0aW9uIGhhcyB0byBiZSBzZW50IGJ5IHdhbGxldC4KICAgIC8vLyBAcGFyYW0gX3JlcXVpcmVkIE51bWJlciBvZiByZXF1aXJlZCBjb25maXJtYXRpb25zLgogICAgZnVuY3Rpb24gY2hhbmdlUmVxdWlyZW1lbnQodWludCBfcmVxdWlyZWQpIHB1YmxpYyBvbmx5V2FsbGV0IHZhbGlkUmVxdWlyZW1lbnQob3duZXJzLmxlbmd0aCwgX3JlcXVpcmVkKSB7CiAgICAgICAgcmVxdWlyZWQgPSBfcmVxdWlyZWQ7CiAgICAgICAgUmVxdWlyZW1lbnRDaGFuZ2UoX3JlcXVpcmVkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRGaW5pc2hlZFR4KCkgcHVibGljIG93bmVyRXhpc3RzKG1zZy5zZW5kZXIpIHJldHVybnModWludCB0cmFuc2FjdGlvbklkKSB7CiAgICAgICAgdHJhbnNhY3Rpb25JZCA9IGFkZFRyYW5zYWN0aW9uKHRva2VuLCAwLCBoZXgiNjRmNjVjYzAiKTsKICAgICAgICBjb25maXJtVHJhbnNhY3Rpb24odHJhbnNhY3Rpb25JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0TGl2ZVR4KCkgcHVibGljIG93bmVyRXhpc3RzKG1zZy5zZW5kZXIpIHJldHVybnModWludCB0cmFuc2FjdGlvbklkKSB7CiAgICAgICAgdHJhbnNhY3Rpb25JZCA9IGFkZFRyYW5zYWN0aW9uKHRva2VuLCAwLCBoZXgiOWQwNzE0YjIiKTsKICAgICAgICBjb25maXJtVHJhbnNhY3Rpb24odHJhbnNhY3Rpb25JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0RnJlZXplVHgoKSBwdWJsaWMgb3duZXJFeGlzdHMobXNnLnNlbmRlcikgcmV0dXJucyh1aW50IHRyYW5zYWN0aW9uSWQpIHsKICAgICAgICB0cmFuc2FjdGlvbklkID0gYWRkVHJhbnNhY3Rpb24odG9rZW4sIDAsIGhleCIyYzhjYmU0MCIpOwogICAgICAgIGNvbmZpcm1UcmFuc2FjdGlvbih0cmFuc2FjdGlvbklkKTsKICAgIH0KCiAgICAvLy8gQGRldiBBbGxvd3MgYW4gb3duZXIgdG8gc3VibWl0IGFuZCBjb25maXJtIGEgdHJhbnNhY3Rpb24uCiAgICAvLy8gQHBhcmFtIGRlc3RpbmF0aW9uIFRyYW5zYWN0aW9uIHRhcmdldCBhZGRyZXNzLgogICAgLy8vIEBwYXJhbSB2YWx1ZSBUcmFuc2FjdGlvbiBldGhlciB2YWx1ZS4KICAgIC8vLyBAcGFyYW0gZGF0YSBUcmFuc2FjdGlvbiBkYXRhIHBheWxvYWQuCiAgICAvLy8gQHJldHVybiBSZXR1cm5zIHRyYW5zYWN0aW9uIElELgogICAgZnVuY3Rpb24gc3VibWl0VHJhbnNhY3Rpb24oYWRkcmVzcyBkZXN0aW5hdGlvbiwgdWludCB2YWx1ZSwgYnl0ZXMgZGF0YSkgcHVibGljCiAgICAgICAgb3duZXJFeGlzdHMobXNnLnNlbmRlcikKICAgICAgICBub3ROdWxsKGRlc3RpbmF0aW9uKQogICAgICAgIHJldHVybnMgKHVpbnQgdHJhbnNhY3Rpb25JZCkKICAgIHsKICAgICAgICB0cmFuc2FjdGlvbklkID0gYWRkVHJhbnNhY3Rpb24oZGVzdGluYXRpb24sIHZhbHVlLCBkYXRhKTsKICAgICAgICBjb25maXJtVHJhbnNhY3Rpb24odHJhbnNhY3Rpb25JZCk7CiAgICB9CgogICAgLy8vIEBkZXYgQWxsb3dzIGFuIG93bmVyIHRvIGNvbmZpcm0gYSB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRC4KICAgIGZ1bmN0aW9uIGNvbmZpcm1UcmFuc2FjdGlvbih1aW50IHRyYW5zYWN0aW9uSWQpCiAgICAgICAgcHVibGljCiAgICAgICAgb3duZXJFeGlzdHMobXNnLnNlbmRlcikKICAgICAgICB0cmFuc2FjdGlvbkV4aXN0cyh0cmFuc2FjdGlvbklkKQogICAgICAgIG5vdENvbmZpcm1lZCh0cmFuc2FjdGlvbklkLCBtc2cuc2VuZGVyKQogICAgewogICAgICAgIGNvbmZpcm1hdGlvbnNbdHJhbnNhY3Rpb25JZF1bbXNnLnNlbmRlcl0gPSB0cnVlOwogICAgICAgIENvbmZpcm1hdGlvbihtc2cuc2VuZGVyLCB0cmFuc2FjdGlvbklkKTsKICAgICAgICBleGVjdXRlVHJhbnNhY3Rpb24odHJhbnNhY3Rpb25JZCk7CiAgICB9CgogICAgLy8vIEBkZXYgQWxsb3dzIGFuIG93bmVyIHRvIHJldm9rZSBhIGNvbmZpcm1hdGlvbiBmb3IgYSB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRC4KICAgIGZ1bmN0aW9uIHJldm9rZUNvbmZpcm1hdGlvbih1aW50IHRyYW5zYWN0aW9uSWQpCiAgICAgICAgcHVibGljCiAgICAgICAgb3duZXJFeGlzdHMobXNnLnNlbmRlcikKICAgICAgICBjb25maXJtZWQodHJhbnNhY3Rpb25JZCwgbXNnLnNlbmRlcikKICAgICAgICBub3RFeGVjdXRlZCh0cmFuc2FjdGlvbklkKQogICAgewogICAgICAgIGNvbmZpcm1hdGlvbnNbdHJhbnNhY3Rpb25JZF1bbXNnLnNlbmRlcl0gPSBmYWxzZTsKICAgICAgICBSZXZvY2F0aW9uKG1zZy5zZW5kZXIsIHRyYW5zYWN0aW9uSWQpOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyBhbnlvbmUgdG8gZXhlY3V0ZSBhIGNvbmZpcm1lZCB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gX3RyYW5zYWN0aW9uSWQgVHJhbnNhY3Rpb24gSUQuCiAgICBmdW5jdGlvbiBleGVjdXRlVHJhbnNhY3Rpb24odWludCBfdHJhbnNhY3Rpb25JZCkgcHVibGljIG5vdEV4ZWN1dGVkKF90cmFuc2FjdGlvbklkKSB7CiAgICAgICAgaWYgKGlzQ29uZmlybWVkKF90cmFuc2FjdGlvbklkKSkgewogICAgICAgICAgICBUcmFuc2FjdGlvbiBzdG9yYWdlIHRyeCA9IHRyYW5zYWN0aW9uc1tfdHJhbnNhY3Rpb25JZF07CiAgICAgICAgICAgIHRyeC5leGVjdXRlZCA9IHRydWU7CiAgICAgICAgICAgIGlmICh0cnguZGVzdGluYXRpb24uY2FsbC52YWx1ZSh0cngudmFsdWUpKHRyeC5kYXRhKSkKICAgICAgICAgICAgICAgIEV4ZWN1dGlvbihfdHJhbnNhY3Rpb25JZCk7CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgRXhlY3V0aW9uRmFpbHVyZShfdHJhbnNhY3Rpb25JZCk7CiAgICAgICAgICAgICAgICB0cnguZXhlY3V0ZWQgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIHRoZSBjb25maXJtYXRpb24gc3RhdHVzIG9mIGEgdHJhbnNhY3Rpb24uCiAgICAvLy8gQHBhcmFtIHRyYW5zYWN0aW9uSWQgVHJhbnNhY3Rpb24gSUQuCiAgICAvLy8gQHJldHVybiBDb25maXJtYXRpb24gc3RhdHVzLgogICAgZnVuY3Rpb24gaXNDb25maXJtZWQodWludCB0cmFuc2FjdGlvbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgdWludCBjb3VudCA9IDA7CiAgICAgICAgZm9yICh1aW50IGk9MDsgaTxvd25lcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGNvbmZpcm1hdGlvbnNbdHJhbnNhY3Rpb25JZF1bb3duZXJzW2ldXSkKICAgICAgICAgICAgICAgIGNvdW50ICs9IDE7CiAgICAgICAgICAgIGlmIChjb3VudCA9PSByZXF1aXJlZCkKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyoKICAgICAqIEludGVybmFsIGZ1bmN0aW9ucwogICAgICovCgogICAgLy8vIEBkZXYgQWRkcyBhIG5ldyB0cmFuc2FjdGlvbiB0byB0aGUgdHJhbnNhY3Rpb24gbWFwcGluZywgaWYgdHJhbnNhY3Rpb24gZG9lcyBub3QgZXhpc3QgeWV0LgogICAgLy8vIEBwYXJhbSBkZXN0aW5hdGlvbiBUcmFuc2FjdGlvbiB0YXJnZXQgYWRkcmVzcy4KICAgIC8vLyBAcGFyYW0gdmFsdWUgVHJhbnNhY3Rpb24gZXRoZXIgdmFsdWUuCiAgICAvLy8gQHBhcmFtIGRhdGEgVHJhbnNhY3Rpb24gZGF0YSBwYXlsb2FkLgogICAgLy8vIEByZXR1cm4gUmV0dXJucyB0cmFuc2FjdGlvbiBJRC4KICAgIGZ1bmN0aW9uIGFkZFRyYW5zYWN0aW9uKGFkZHJlc3MgZGVzdGluYXRpb24sIHVpbnQgdmFsdWUsIGJ5dGVzIGRhdGEpIGludGVybmFsIHJldHVybnMgKHVpbnQgdHJhbnNhY3Rpb25JZCkgewogICAgICAgIHRyYW5zYWN0aW9uSWQgPSB0cmFuc2FjdGlvbkNvdW50OwogICAgICAgIHRyYW5zYWN0aW9uc1t0cmFuc2FjdGlvbklkXSA9IFRyYW5zYWN0aW9uKHsKICAgICAgICAgICAgZGVzdGluYXRpb246IGRlc3RpbmF0aW9uLAogICAgICAgICAgICB2YWx1ZTogdmFsdWUsCiAgICAgICAgICAgIGRhdGE6IGRhdGEsCiAgICAgICAgICAgIGV4ZWN1dGVkOiBmYWxzZQogICAgICAgIH0pOwogICAgICAgIHRyYW5zYWN0aW9uQ291bnQgKz0gMTsKICAgICAgICBTdWJtaXNzaW9uKHRyYW5zYWN0aW9uSWQpOwogICAgfQoKICAgIC8qCiAgICAgKiBXZWIzIGNhbGwgZnVuY3Rpb25zCiAgICAqLwoKICAgIC8vLyBAZGV2IFJldHVybnMgbnVtYmVyIG9mIGNvbmZpcm1hdGlvbnMgb2YgYSB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRC4KICAgIC8vLyBAcmV0dXJuIE51bWJlciBvZiBjb25maXJtYXRpb25zLgogICAgZnVuY3Rpb24gZ2V0Q29uZmlybWF0aW9uQ291bnQodWludCB0cmFuc2FjdGlvbklkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCBjb3VudCkgewogICAgICAgIGZvciAodWludCBpPTA7IGk8b3duZXJzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBpZiAoY29uZmlybWF0aW9uc1t0cmFuc2FjdGlvbklkXVtvd25lcnNbaV1dKQogICAgICAgICAgICAgICAgY291bnQgKz0gMTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIHRvdGFsIG51bWJlciBvZiB0cmFuc2FjdGlvbnMgYWZ0ZXIgZmlsZXJzIGFyZSBhcHBsaWVkLgogICAgLy8vIEBwYXJhbSBwZW5kaW5nIEluY2x1ZGUgcGVuZGluZyB0cmFuc2FjdGlvbnMuCiAgICAvLy8gQHBhcmFtIGV4ZWN1dGVkIEluY2x1ZGUgZXhlY3V0ZWQgdHJhbnNhY3Rpb25zLgogICAgLy8vIEByZXR1cm4gVG90YWwgbnVtYmVyIG9mIHRyYW5zYWN0aW9ucyBhZnRlciBmaWx0ZXJzIGFyZSBhcHBsaWVkLgogICAgZnVuY3Rpb24gZ2V0VHJhbnNhY3Rpb25Db3VudChib29sIHBlbmRpbmcsIGJvb2wgZXhlY3V0ZWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50IGNvdW50KSB7CiAgICAgICAgZm9yICh1aW50IGk9MDsgaTx0cmFuc2FjdGlvbkNvdW50OyBpKyspCiAgICAgICAgICAgIGlmICggICBwZW5kaW5nICYmICF0cmFuc2FjdGlvbnNbaV0uZXhlY3V0ZWQKICAgICAgICAgICAgICAgIHx8IGV4ZWN1dGVkICYmIHRyYW5zYWN0aW9uc1tpXS5leGVjdXRlZCkKICAgICAgICAgICAgICAgIGNvdW50ICs9IDE7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyBsaXN0IG9mIG93bmVycy4KICAgIC8vLyBAcmV0dXJuIExpc3Qgb2Ygb3duZXIgYWRkcmVzc2VzLgogICAgZnVuY3Rpb24gZ2V0T3duZXJzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3NbXSkgewogICAgICAgIHJldHVybiBvd25lcnM7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyBhcnJheSB3aXRoIG93bmVyIGFkZHJlc3Nlcywgd2hpY2ggY29uZmlybWVkIHRyYW5zYWN0aW9uLgogICAgLy8vIEBwYXJhbSB0cmFuc2FjdGlvbklkIFRyYW5zYWN0aW9uIElELgogICAgLy8vIEByZXR1cm4gUmV0dXJucyBhcnJheSBvZiBvd25lciBhZGRyZXNzZXMuCiAgICBmdW5jdGlvbiBnZXRDb25maXJtYXRpb25zKHVpbnQgdHJhbnNhY3Rpb25JZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3NbXSBfY29uZmlybWF0aW9ucykgewogICAgICAgIGFkZHJlc3NbXSBtZW1vcnkgY29uZmlybWF0aW9uc1RlbXAgPSBuZXcgYWRkcmVzc1tdKG93bmVycy5sZW5ndGgpOwogICAgICAgIHVpbnQgY291bnQgPSAwOwogICAgICAgIHVpbnQgaTsKICAgICAgICBmb3IgKGk9MDsgaTxvd25lcnMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlmIChjb25maXJtYXRpb25zW3RyYW5zYWN0aW9uSWRdW293bmVyc1tpXV0pIHsKICAgICAgICAgICAgICAgIGNvbmZpcm1hdGlvbnNUZW1wW2NvdW50XSA9IG93bmVyc1tpXTsKICAgICAgICAgICAgICAgIGNvdW50ICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICBfY29uZmlybWF0aW9ucyA9IG5ldyBhZGRyZXNzW10oY291bnQpOwogICAgICAgIGZvciAoaT0wOyBpPGNvdW50OyBpKyspCiAgICAgICAgICAgIF9jb25maXJtYXRpb25zW2ldID0gY29uZmlybWF0aW9uc1RlbXBbaV07CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyBsaXN0IG9mIHRyYW5zYWN0aW9uIElEcyBpbiBkZWZpbmVkIHJhbmdlLgogICAgLy8vIEBwYXJhbSBmcm9tIEluZGV4IHN0YXJ0IHBvc2l0aW9uIG9mIHRyYW5zYWN0aW9uIGFycmF5LgogICAgLy8vIEBwYXJhbSB0byBJbmRleCBlbmQgcG9zaXRpb24gb2YgdHJhbnNhY3Rpb24gYXJyYXkuCiAgICAvLy8gQHBhcmFtIHBlbmRpbmcgSW5jbHVkZSBwZW5kaW5nIHRyYW5zYWN0aW9ucy4KICAgIC8vLyBAcGFyYW0gZXhlY3V0ZWQgSW5jbHVkZSBleGVjdXRlZCB0cmFuc2FjdGlvbnMuCiAgICAvLy8gQHJldHVybiBSZXR1cm5zIGFycmF5IG9mIHRyYW5zYWN0aW9uIElEcy4KICAgIGZ1bmN0aW9uIGdldFRyYW5zYWN0aW9uSWRzKHVpbnQgZnJvbSwgdWludCB0bywgYm9vbCBwZW5kaW5nLCBib29sIGV4ZWN1dGVkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludFtdIF90cmFuc2FjdGlvbklkcykgewogICAgICAgIHVpbnRbXSBtZW1vcnkgdHJhbnNhY3Rpb25JZHNUZW1wID0gbmV3IHVpbnRbXSh0cmFuc2FjdGlvbkNvdW50KTsKICAgICAgICB1aW50IGNvdW50ID0gMDsKICAgICAgICB1aW50IGk7CiAgICAgICAgZm9yIChpPWZyb207IGk8dHJhbnNhY3Rpb25Db3VudDsgaSsrKQogICAgICAgICAgICBpZiAoICAgcGVuZGluZyAmJiAhdHJhbnNhY3Rpb25zW2ldLmV4ZWN1dGVkCiAgICAgICAgICAgICAgICB8fCBleGVjdXRlZCAmJiB0cmFuc2FjdGlvbnNbaV0uZXhlY3V0ZWQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uSWRzVGVtcFtjb3VudF0gPSBpOwogICAgICAgICAgICAgICAgY291bnQgKz0gMTsKICAgICAgICAgICAgfQogICAgICAgIF90cmFuc2FjdGlvbklkcyA9IG5ldyB1aW50W10odG8gLSBmcm9tKTsKICAgICAgICBmb3IgKGk9ZnJvbTsgaTx0bzsgaSsrKQogICAgICAgICAgICBfdHJhbnNhY3Rpb25JZHNbaSAtIGZyb21dID0gdHJhbnNhY3Rpb25JZHNUZW1wW2ldOwogICAgfQoKfQ=='.
	

]
