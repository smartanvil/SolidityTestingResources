Class {
	#name : #SRTf4a0767888e483143671f873b40376a7d20ba3e4,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTf4a0767888e483143671f873b40376a7d20ba3e4 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgovLyBGaWxlOiB6ZXBwZWxpbi1zb2xpZGl0eS9jb250cmFjdHMvb3duZXJzaGlwL093bmFibGUuc29sCgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCi8vIEZpbGU6IHplcHBlbGluLXNvbGlkaXR5L2NvbnRyYWN0cy9tYXRoL1NhZmVNYXRoLnNvbAoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCi8vIEZpbGU6IHplcHBlbGluLXNvbGlkaXR5L2NvbnRyYWN0cy90b2tlbi9FUkMyMEJhc2ljLnNvbAoKLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5CiAqLwpjb250cmFjdCBFUkMyMEJhc2ljIHsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCi8vIEZpbGU6IHplcHBlbGluLXNvbGlkaXR5L2NvbnRyYWN0cy90b2tlbi9CYXNpY1Rva2VuLnNvbAoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL3Rva2VuL0VSQzIwLnNvbAoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCi8vIEZpbGU6IHplcHBlbGluLXNvbGlkaXR5L2NvbnRyYWN0cy90b2tlbi9TdGFuZGFyZFRva2VuLnNvbAoKLyoqCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbgogKgogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CgogICAgdWludDI1NiBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07CgogICAgLy8gQ2hlY2sgaXMgbm90IG5lZWRlZCBiZWNhdXNlIHN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0CiAgICAvLyByZXF1aXJlIChfdmFsdWUgPD0gX2FsbG93YW5jZSk7CgogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CgogIC8qKgogICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAogICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICovCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9CdXJuYWJsZVRva2VuLnNvbAoKLyoqCiogQHRpdGxlIEN1c3RvbWl6ZWQgQnVybmFibGUgVG9rZW4KKiBAZGV2IFRva2VuIHRoYXQgY2FuIGJlIGlycmV2ZXJzaWJseSBidXJuZWQgKGRlc3Ryb3llZCkuCiovCmNvbnRyYWN0IEJ1cm5hYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZSB7CgogICAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgYnVybmVyLCB1aW50MjU2IGFtb3VudCk7CgogICAgLyoqCiAgICAqIEBkZXYgQW55Ym9keSBjYW4gYnVybiBhIHNwZWNpZmljIGFtb3VudCBvZiB0aGVpciB0b2tlbnMuCiAgICAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgYnVybmVkLgogICAgKi8KICAgIGZ1bmN0aW9uIGJ1cm4odWludDI1NiBfYW1vdW50KSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX2Ftb3VudCA+IDApOwogICAgICAgIHJlcXVpcmUoX2Ftb3VudCA8PSBiYWxhbmNlc1ttc2cuc2VuZGVyXSk7CiAgICAgICAgLy8gbm8gbmVlZCB0byByZXF1aXJlIF9hbW91bnQgPD0gdG90YWxTdXBwbHksIHNpbmNlIHRoYXQgd291bGQgaW1wbHkgdGhlCiAgICAgICAgLy8gc2VuZGVyJ3MgYmFsYW5jZSBpcyBncmVhdGVyIHRoYW4gdGhlIHRvdGFsU3VwcGx5LCB3aGljaCAqc2hvdWxkKiBiZSBhbiBhc3NlcnRpb24gZmFpbHVyZQoKICAgICAgICBhZGRyZXNzIGJ1cm5lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgYmFsYW5jZXNbYnVybmVyXSA9IGJhbGFuY2VzW2J1cm5lcl0uc3ViKF9hbW91bnQpOwogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuc3ViKF9hbW91bnQpOwogICAgICAgIFRyYW5zZmVyKGJ1cm5lciwgYWRkcmVzcygwKSwgX2Ftb3VudCk7CiAgICAgICAgQnVybihidXJuZXIsIF9hbW91bnQpOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IE93bmVyIGNhbiBidXJuIGEgc3BlY2lmaWMgYW1vdW50IG9mIHRva2VucyBvZiBvdGhlciB0b2tlbiBob2xkZXJzLgogICAgKiBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3Mgb2YgdG9rZW4gaG9sZGVyIHdob3NlIHRva2VucyB0byBiZSBidXJuZWQuCiAgICAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgYnVybmVkLgogICAgKi8KICAgIGZ1bmN0aW9uIGJ1cm5Gcm9tKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX2Ftb3VudCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfZnJvbSAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF9hbW91bnQgPiAwKTsKICAgICAgICByZXF1aXJlKF9hbW91bnQgPD0gYmFsYW5jZXNbX2Zyb21dKTsKICAgICAgICAvLyBubyBuZWVkIHRvIHJlcXVpcmUgX2Ftb3VudCA8PSB0b3RhbFN1cHBseSwgc2luY2UgdGhhdCB3b3VsZCBpbXBseSB0aGUKICAgICAgICAvLyBzZW5kZXIncyBiYWxhbmNlIGlzIGdyZWF0ZXIgdGhhbiB0aGUgdG90YWxTdXBwbHksIHdoaWNoICpzaG91bGQqIGJlIGFuIGFzc2VydGlvbiBmYWlsdXJlCgogICAgICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX2Ftb3VudCk7CiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5zdWIoX2Ftb3VudCk7CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIGFkZHJlc3MoMCksIF9hbW91bnQpOwogICAgICAgIEJ1cm4oX2Zyb20sIF9hbW91bnQpOwogICAgfQoKfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL2xpZmVjeWNsZS9QYXVzYWJsZS5zb2wKCi8qKgogKiBAdGl0bGUgUGF1c2FibGUKICogQGRldiBCYXNlIGNvbnRyYWN0IHdoaWNoIGFsbG93cyBjaGlsZHJlbiB0byBpbXBsZW1lbnQgYW4gZW1lcmdlbmN5IHN0b3AgbWVjaGFuaXNtLgogKi8KY29udHJhY3QgUGF1c2FibGUgaXMgT3duYWJsZSB7CiAgZXZlbnQgUGF1c2UoKTsKICBldmVudCBVbnBhdXNlKCk7CgogIGJvb2wgcHVibGljIHBhdXNlZCA9IGZhbHNlOwoKCiAgLyoqCiAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBub3QgcGF1c2VkLgogICAqLwogIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICByZXF1aXJlKCFwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgcGF1c2VkLgogICAqLwogIG1vZGlmaWVyIHdoZW5QYXVzZWQoKSB7CiAgICByZXF1aXJlKHBhdXNlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHBhdXNlLCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlCiAgICovCiAgZnVuY3Rpb24gcGF1c2UoKSBvbmx5T3duZXIgd2hlbk5vdFBhdXNlZCBwdWJsaWMgewogICAgcGF1c2VkID0gdHJ1ZTsKICAgIFBhdXNlKCk7CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gdW5wYXVzZSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgKi8KICBmdW5jdGlvbiB1bnBhdXNlKCkgb25seU93bmVyIHdoZW5QYXVzZWQgcHVibGljIHsKICAgIHBhdXNlZCA9IGZhbHNlOwogICAgVW5wYXVzZSgpOwogIH0KfQoKLy8gRmlsZTogY29udHJhY3RzL0dpZnRUb2tlbi5zb2wKCmNvbnRyYWN0IEdpZnRUb2tlbiBpcyBCdXJuYWJsZVRva2VuLCBQYXVzYWJsZSB7CiAgICBzdHJpbmcgY29uc3RhbnQgcHVibGljIG5hbWUgPSAiR2lmdGNvaW4iOwogICAgc3RyaW5nIGNvbnN0YW50IHB1YmxpYyBzeW1ib2wgPSAiR0lGVCI7CiAgICB1aW50OCBjb25zdGFudCBwdWJsaWMgZGVjaW1hbHMgPSAxODsKCiAgICB1aW50MjU2IGNvbnN0YW50IHB1YmxpYyBJTklUSUFMX1RPVEFMX1NVUFBMWSA9IDFlOCAqICh1aW50MjU2KDEwKSAqKiBkZWNpbWFscyk7CgogICAgYWRkcmVzcyBwcml2YXRlIGFkZHJlc3NJY287CgogICAgbW9kaWZpZXIgb25seUljbygpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYWRkcmVzc0ljbyk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBDcmVhdGUgR2lmdFRva2VuIGNvbnRyYWN0IGFuZCBzZXQgcGF1c2UKICAgICogQHBhcmFtIF9pY28gVGhlIGFkZHJlc3Mgb2YgSUNPIGNvbnRyYWN0LgogICAgKi8KICAgIGZ1bmN0aW9uIEdpZnRUb2tlbiAoYWRkcmVzcyBfaWNvKSB7CiAgICAgICAgcmVxdWlyZShfaWNvICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICBhZGRyZXNzSWNvID0gX2ljbzsKCiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoSU5JVElBTF9UT1RBTF9TVVBQTFkpOwogICAgICAgIGJhbGFuY2VzW19pY29dID0gYmFsYW5jZXNbX2ljb10uYWRkKElOSVRJQUxfVE9UQUxfU1VQUExZKTsKICAgICAgICBUcmFuc2ZlcihhZGRyZXNzKDApLCBfaWNvLCBJTklUSUFMX1RPVEFMX1NVUFBMWSk7CgogICAgICAgIHBhdXNlKCk7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgVHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3Mgd2l0aCBwYXVzZSBmZWF0dXJlIGZvciBvd25lci4KICAgICogQGRldiBPbmx5IGFwcGxpZXMgd2hlbiB0aGUgdHJhbnNmZXIgaXMgYWxsb3dlZCBieSB0aGUgb3duZXIuCiAgICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHdoZW5Ob3RQYXVzZWQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlciB3aXRoIHBhdXNlIGZlYXR1cmUgZm9yIG93bmVyLgogICAgKiBAZGV2IE9ubHkgYXBwbGllcyB3aGVuIHRoZSB0cmFuc2ZlciBpcyBhbGxvd2VkIGJ5IHRoZSBvd25lci4KICAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgd2hlbk5vdFBhdXNlZCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIElDTyBhZGRyZXNzIHRvIGFub3RoZXIgYWRkcmVzcy4KICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbUljbyhhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIG9ubHlJY28gcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9XaGl0ZWxpc3Quc29sCgovKioKICogQHRpdGxlIFdoaXRlbGlzdCBjb250cmFjdAogKiBAZGV2IFdoaXRlbGlzdCBmb3Igd2FsbGV0cywgd2l0aCBhZGRpdGlvbmFsIGRhdGEgZm9yIGV2ZXJ5IHdhbGxldC4KKi8KY29udHJhY3QgV2hpdGVsaXN0IGlzIE93bmFibGUgewogICAgc3RydWN0IFdhbGxldEluZm8gewogICAgICAgIHN0cmluZyBkYXRhOwogICAgICAgIGJvb2wgd2hpdGVsaXN0ZWQ7CiAgICAgICAgdWludDI1NiBjcmVhdGVkVGltZXN0YW1wOwogICAgfQoKICAgIGFkZHJlc3MgcHJpdmF0ZSBhZGRyZXNzQXBpOwoKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBXYWxsZXRJbmZvKSBwdWJsaWMgd2hpdGVsaXN0OwoKICAgIHVpbnQyNTYgcHVibGljIHdoaXRlbGlzdExlbmd0aCA9IDA7CgogICAgbW9kaWZpZXIgb25seVByaXZpbGVnZUFkZHJlc3NlcyB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkZHJlc3NBcGkgfHwgbXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBTZXQgYmFja2VuZCBBcGkgYWRkcmVzcy4KICAgICogQGRldiBBY2NlcHQgcmVxdWVzdCBmcm9tIG93bmVyIG9ubHkuCiAgICAqIEBwYXJhbSBfYXBpIFRoZSBhZGRyZXNzIG9mIGJhY2tlbmQgQVBJLgogICAgKi8KICAgIGZ1bmN0aW9uIHNldEFwaUFkZHJlc3MoYWRkcmVzcyBfYXBpKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKF9hcGkgIT0gYWRkcmVzcygwKSk7CgogICAgICAgIGFkZHJlc3NBcGkgPSBfYXBpOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEFkZCB3YWxsZXQgdG8gd2hpdGVsaXN0LgogICAgKiBAZGV2IEFjY2VwdCByZXF1ZXN0IGZyb20gcHJpdmlsZWdlIGFkcmVzc2VzIG9ubHkuCiAgICAqIEBwYXJhbSBfd2FsbGV0IFRoZSBhZGRyZXNzIG9mIHdhbGxldCB0byBhZGQuCiAgICAqIEBwYXJhbSBfZGF0YSBUaGUgY2hlY2tzdW0gb2YgYWRkaXRpb25hbCB3YWxsZXQgZGF0YS4KICAgICovICAKICAgIGZ1bmN0aW9uIGFkZFdhbGxldChhZGRyZXNzIF93YWxsZXQsIHN0cmluZyBfZGF0YSkgb25seVByaXZpbGVnZUFkZHJlc3NlcyBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX3dhbGxldCAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKCFpc1doaXRlbGlzdGVkKF93YWxsZXQpKTsKICAgICAgICB3aGl0ZWxpc3RbX3dhbGxldF0uZGF0YSA9IF9kYXRhOwogICAgICAgIHdoaXRlbGlzdFtfd2FsbGV0XS53aGl0ZWxpc3RlZCA9IHRydWU7CiAgICAgICAgd2hpdGVsaXN0W193YWxsZXRdLmNyZWF0ZWRUaW1lc3RhbXAgPSBub3c7CiAgICAgICAgd2hpdGVsaXN0TGVuZ3RoKys7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgVXBkYXRlIGFkZGl0aW9uYWwgZGF0YSBmb3Igd2hpdGVsaXN0ZWQgd2FsbGV0LgogICAgKiBAZGV2IEFjY2VwdCByZXF1ZXN0IGZyb20gcHJpdmlsZWdlIGFkcmVzc2VzIG9ubHkuCiAgICAqIEBwYXJhbSBfd2FsbGV0IFRoZSBhZGRyZXNzIG9mIHdoaXRlbGlzdGVkIHdhbGxldCB0byB1cGRhdGUuCiAgICAqIEBwYXJhbSBfZGF0YSBUaGUgY2hlY2tzdW0gb2YgbmV3IGFkZGl0aW9uYWwgd2FsbGV0IGRhdGEuCiAgICAqLyAgICAgIAogICAgZnVuY3Rpb24gdXBkYXRlV2FsbGV0KGFkZHJlc3MgX3dhbGxldCwgc3RyaW5nIF9kYXRhKSBvbmx5UHJpdmlsZWdlQWRkcmVzc2VzIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfd2FsbGV0ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoaXNXaGl0ZWxpc3RlZChfd2FsbGV0KSk7CiAgICAgICAgd2hpdGVsaXN0W193YWxsZXRdLmRhdGEgPSBfZGF0YTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBSZW1vdmUgd2FsbGV0IGZyb20gd2hpdGVsaXN0LgogICAgKiBAZGV2IEFjY2VwdCByZXF1ZXN0IGZyb20gcHJpdmlsZWdlIGFkcmVzc2VzIG9ubHkuCiAgICAqIEBwYXJhbSBfd2FsbGV0IFRoZSBhZGRyZXNzIG9mIHdoaXRlbGlzdGVkIHdhbGxldCB0byByZW1vdmUuCiAgICAqLyAgCiAgICBmdW5jdGlvbiByZW1vdmVXYWxsZXQoYWRkcmVzcyBfd2FsbGV0KSBvbmx5UHJpdmlsZWdlQWRkcmVzc2VzIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfd2FsbGV0ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoaXNXaGl0ZWxpc3RlZChfd2FsbGV0KSk7CiAgICAgICAgZGVsZXRlIHdoaXRlbGlzdFtfd2FsbGV0XTsKICAgICAgICB3aGl0ZWxpc3RMZW5ndGgtLTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBDaGVjayB0aGUgc3BlY2lmaWVkIHdhbGxldCB3aGV0aGVyIGl0IGlzIGluIHRoZSB3aGl0ZWxpc3QuCiAgICAqIEBwYXJhbSBfd2FsbGV0IFRoZSBhZGRyZXNzIG9mIHdhbGxldCB0byBjaGVjay4KICAgICovIAogICAgZnVuY3Rpb24gaXNXaGl0ZWxpc3RlZChhZGRyZXNzIF93YWxsZXQpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHdoaXRlbGlzdFtfd2FsbGV0XS53aGl0ZWxpc3RlZDsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBHZXQgdGhlIGNoZWNrc3VtIG9mIGFkZGl0aW9uYWwgZGF0YSBmb3IgdGhlIHNwZWNpZmllZCB3aGl0ZWxpc3RlZCB3YWxsZXQuCiAgICAqIEBwYXJhbSBfd2FsbGV0IFRoZSBhZGRyZXNzIG9mIHdhbGxldCB0byBnZXQuCiAgICAqLyAKICAgIGZ1bmN0aW9uIHdhbGxldERhdGEoYWRkcmVzcyBfd2FsbGV0KSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAoc3RyaW5nKSB7CiAgICAgICAgcmV0dXJuIHdoaXRlbGlzdFtfd2FsbGV0XS5kYXRhOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEdldCB0aGUgY3JlYXRpb24gdGltZXN0YW1wIGZvciB0aGUgc3BlY2lmaWVkIHdoaXRlbGlzdGVkIHdhbGxldC4KICAgICogQHBhcmFtIF93YWxsZXQgVGhlIGFkZHJlc3Mgb2Ygd2FsbGV0IHRvIGdldC4KICAgICovCiAgICBmdW5jdGlvbiB3YWxsZXRDcmVhdGVkVGltZXN0YW1wKGFkZHJlc3MgX3dhbGxldCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gd2hpdGVsaXN0W193YWxsZXRdLmNyZWF0ZWRUaW1lc3RhbXA7CiAgICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9XaGl0ZWxpc3RhYmxlLnNvbAoKY29udHJhY3QgV2hpdGVsaXN0YWJsZSB7CiAgICBXaGl0ZWxpc3QgcHVibGljIHdoaXRlbGlzdDsKCiAgICBtb2RpZmllciB3aGVuV2hpdGVsaXN0ZWQoYWRkcmVzcyBfd2FsbGV0KSB7CiAgICAgICAgcmVxdWlyZSh3aGl0ZWxpc3QuaXNXaGl0ZWxpc3RlZChfd2FsbGV0KSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBXaGl0ZWxpc3RhYmxlICgpIHB1YmxpYyB7CiAgICAgICAgd2hpdGVsaXN0ID0gbmV3IFdoaXRlbGlzdCgpOwoKICAgICAgICB3aGl0ZWxpc3QudHJhbnNmZXJPd25lcnNoaXAobXNnLnNlbmRlcik7CiAgICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9HaWZ0Q3Jvd2RzYWxlLnNvbAoKY29udHJhY3QgR2lmdENyb3dkc2FsZSBpcyBQYXVzYWJsZSwgV2hpdGVsaXN0YWJsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICB1aW50MjU2IHB1YmxpYyBzdGFydFRpbWVzdGFtcCA9IDA7CgogICAgdWludDI1NiBwdWJsaWMgZW5kVGltZXN0YW1wID0gMDsKCiAgICB1aW50MjU2IHB1YmxpYyBleGNoYW5nZVJhdGUgPSAwOwoKICAgIHVpbnQyNTYgcHVibGljIHRva2Vuc1NvbGQgPSAwOwoKICAgIHVpbnQyNTYgY29uc3RhbnQgcHVibGljIG1pbmltdW1JbnZlc3RtZW50ID0gMjVlMTY7IC8vIDAuMjUgRVRICgogICAgdWludDI1NiBwdWJsaWMgbWluQ2FwID0gMDsKCiAgICB1aW50MjU2IHB1YmxpYyBlbmRGaXJzdFBlcmlvZFRpbWVzdGFtcCA9IDA7CiAgICB1aW50MjU2IHB1YmxpYyBlbmRTZWNvbmRQZXJpb2RUaW1lc3RhbXAgPSAwOwogICAgdWludDI1NiBwdWJsaWMgZW5kVGhpcmRQZXJpb2RUaW1lc3RhbXAgPSAwOwoKICAgIEdpZnRUb2tlbiBwdWJsaWMgdG9rZW4gPSBuZXcgR2lmdFRva2VuKHRoaXMpOwoKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgaW52ZXN0bWVudHM7CgogICAgbW9kaWZpZXIgd2hlblNhbGVJc09wZW4gKCkgewogICAgICAgIHJlcXVpcmUobm93ID49IHN0YXJ0VGltZXN0YW1wICYmIG5vdyA8IGVuZFRpbWVzdGFtcCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciB3aGVuU2FsZUhhc0VuZGVkICgpIHsKICAgICAgICByZXF1aXJlKG5vdyA+PSBlbmRUaW1lc3RhbXApOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgQ29uc3RydWN0b3IgZm9yIEdpZnRDcm93ZHNhbGUgY29udHJhY3QuCiAgICAqIEBkZXYgU2V0IGZpcnN0IG93bmVyIHdobyBjYW4gbWFuYWdlIHdoaXRlbGlzdC4KICAgICogQHBhcmFtIF9zdGFydFRpbWVzdGFtcCB1aW50MjU2IFRoZSBzdGFydCB0aW1lIGljby4KICAgICogQHBhcmFtIF9lbmRUaW1lc3RhbXAgdWludDI1NiBUaGUgZW5kIHRpbWUgaWNvLgogICAgKiBAcGFyYW0gX2V4Y2hhbmdlUmF0ZSB1aW50MjU2IFRoZSBwcmljZSBvZiB0aGUgR2lmdCB0b2tlbi4KICAgICogQHBhcmFtIF9taW5DYXAgVGhlIG1pbmltdW0gYW1vdW50IG9mIHRva2VucyBzb2xkIHJlcXVpcmVkIGZvciB0aGUgSUNPIHRvIGJlIGNvbnNpZGVyZWQgc3VjY2Vzc2Z1bC4KICAgICovCiAgICBmdW5jdGlvbiBHaWZ0Q3Jvd2RzYWxlICgKICAgICAgICB1aW50MjU2IF9zdGFydFRpbWVzdGFtcCwKICAgICAgICB1aW50MjU2IF9lbmRUaW1lc3RhbXAsCiAgICAgICAgdWludDI1NiBfZXhjaGFuZ2VSYXRlLAogICAgICAgIHVpbnQyNTYgX21pbkNhcAogICAgKSBwdWJsaWMKICAgIHsKICAgICAgICByZXF1aXJlKF9zdGFydFRpbWVzdGFtcCA+PSBub3cgJiYgX2VuZFRpbWVzdGFtcCA+IF9zdGFydFRpbWVzdGFtcCk7CiAgICAgICAgcmVxdWlyZShfZXhjaGFuZ2VSYXRlID4gMCk7CgogICAgICAgIHN0YXJ0VGltZXN0YW1wID0gX3N0YXJ0VGltZXN0YW1wOwogICAgICAgIGVuZFRpbWVzdGFtcCA9IF9lbmRUaW1lc3RhbXA7CgogICAgICAgIGV4Y2hhbmdlUmF0ZSA9IF9leGNoYW5nZVJhdGU7CgogICAgICAgIGVuZEZpcnN0UGVyaW9kVGltZXN0YW1wID0gX3N0YXJ0VGltZXN0YW1wLmFkZCgxIGRheXMpOwogICAgICAgIGVuZFNlY29uZFBlcmlvZFRpbWVzdGFtcCA9IF9zdGFydFRpbWVzdGFtcC5hZGQoMSB3ZWVrcyk7CiAgICAgICAgZW5kVGhpcmRQZXJpb2RUaW1lc3RhbXAgPSBfc3RhcnRUaW1lc3RhbXAuYWRkKDIgd2Vla3MpOwoKICAgICAgICBtaW5DYXAgPSBfbWluQ2FwOwogICAgfQoKICAgIGZ1bmN0aW9uIGRpc2NvdW50KCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBpZiAobm93ID4gZW5kVGhpcmRQZXJpb2RUaW1lc3RhbXApCiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIGlmIChub3cgPiBlbmRTZWNvbmRQZXJpb2RUaW1lc3RhbXApCiAgICAgICAgICAgIHJldHVybiA1OwogICAgICAgIGlmIChub3cgPiBlbmRGaXJzdFBlcmlvZFRpbWVzdGFtcCkKICAgICAgICAgICAgcmV0dXJuIDE1OwogICAgICAgIHJldHVybiAyNTsKICAgIH0KCiAgICBmdW5jdGlvbiBib251cyhhZGRyZXNzIF93YWxsZXQpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBfY3JlYXRlZCA9IHdoaXRlbGlzdC53YWxsZXRDcmVhdGVkVGltZXN0YW1wKF93YWxsZXQpOwogICAgICAgIGlmIChfY3JlYXRlZCA+IDAgJiYgX2NyZWF0ZWQgPCBzdGFydFRpbWVzdGFtcCkgewogICAgICAgICAgICByZXR1cm4gMTA7CiAgICAgICAgfQogICAgICAgIHJldHVybiAwOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEZ1bmN0aW9uIGZvciBzZWxsIHRva2Vucy4KICAgICogQGRldiBTZWxscyB0b2tlbnMgb25seSBmb3Igd2FsbGV0cyBmcm9tIFdoaXRlbGlzdCB3aGlsZSBJQ08gbGFzdHMKICAgICovCiAgICBmdW5jdGlvbiBzZWxsVG9rZW5zICgpIHdoZW5TYWxlSXNPcGVuIHdoZW5XaGl0ZWxpc3RlZChtc2cuc2VuZGVyKSB3aGVuTm90UGF1c2VkIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+IG1pbmltdW1JbnZlc3RtZW50KTsKICAgICAgICB1aW50MjU2IF9ib251cyA9IGJvbnVzKG1zZy5zZW5kZXIpOwogICAgICAgIHVpbnQyNTYgX2Rpc2NvdW50ID0gZGlzY291bnQoKTsKICAgICAgICB1aW50MjU2IHRva2Vuc0Ftb3VudCA9IChtc2cudmFsdWUpLm11bChleGNoYW5nZVJhdGUpLm11bChfYm9udXMuYWRkKDEwMCkpLmRpdigoMTAwIC0gX2Rpc2NvdW50KSk7CgogICAgICAgIHRva2VuLnRyYW5zZmVyRnJvbUljbyhtc2cuc2VuZGVyLCB0b2tlbnNBbW91bnQpOwoKICAgICAgICB0b2tlbnNTb2xkID0gdG9rZW5zU29sZC5hZGQodG9rZW5zQW1vdW50KTsKCiAgICAgICAgYWRkSW52ZXN0bWVudChtc2cuc2VuZGVyLCBtc2cudmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEZhbGxiYWNrIGZ1bmN0aW9uIGFsbG93aW5nIHRoZSBjb250cmFjdCB0byByZWNlaXZlIGZ1bmRzCiAgICAqLwogICAgZnVuY3Rpb24gKCkgcHVibGljIHBheWFibGUgewogICAgICAgIHNlbGxUb2tlbnMoKTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBGdW5jdGlvbiBmb3IgZnVuZHMgd2l0aGRyYXdhbAogICAgKiBAZGV2IHRyYW5zZmVycyBmdW5kcyB0byBzcGVjaWZpZWQgd2FsbGV0IG9uY2UgSUNPIGlzIGVuZGVkCiAgICAqIEBwYXJhbSBfd2FsbGV0IGFkZHJlc3Mgd2FsbGV0IGFkZHJlc3MsIHRvICB3aGljaCBmdW5kcyAgd2lsbCBiZSB0cmFuc2ZlcnJlZAogICAgKi8KICAgIGZ1bmN0aW9uIHdpdGhkcmF3YWwgKGFkZHJlc3MgX3dhbGxldCkgb25seU93bmVyIHdoZW5TYWxlSGFzRW5kZWQgZXh0ZXJuYWwgewogICAgICAgIHJlcXVpcmUoX3dhbGxldCAhPSBhZGRyZXNzKDApKTsKICAgICAgICBfd2FsbGV0LnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CgogICAgICAgIHRva2VuLnRyYW5zZmVyT3duZXJzaGlwKG1zZy5zZW5kZXIpOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEZ1bmN0aW9uIGZvciBtYW51YWwgdG9rZW4gYXNzaWdubWVudCAodG9rZW4gdHJhbnNmZXIgZnJvbSBJQ08gdG8gcmVxdWVzdGVkIHdhbGxldCkKICAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRyYW5zZmVyIHRvCiAgICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAgKi8KICAgIGZ1bmN0aW9uIGFzc2lnblRva2VucyAoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBvbmx5T3duZXIgZXh0ZXJuYWwgewogICAgICAgIHRva2VuLnRyYW5zZmVyRnJvbUljbyhfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgQWRkIG5ldyBpbnZlc3RtZW50IHRvIHRoZSBJQ08gaW52ZXN0bWVudHMgc3RvcmFnZS4KICAgICogQHBhcmFtIF9mcm9tIFRoZSBhZGRyZXNzIG9mIGEgSUNPIGludmVzdG9yLgogICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBpbnZlc3RtZW50IHJlY2VpdmVkIGZyb20gYSBJQ08gaW52ZXN0b3IuCiAgICAqLwogICAgZnVuY3Rpb24gYWRkSW52ZXN0bWVudChhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF92YWx1ZSkgaW50ZXJuYWwgewogICAgICAgIGludmVzdG1lbnRzW19mcm9tXSA9IGludmVzdG1lbnRzW19mcm9tXS5hZGQoX3ZhbHVlKTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBGdW5jdGlvbiB0byByZXR1cm4gbW9uZXkgdG8gb25lIGN1c3RvbWVyLCBpZiBtaW5jYXAgaGFzIG5vdCBiZWVuIHJlYWNoZWQKICAgICovCiAgICBmdW5jdGlvbiByZWZ1bmRQYXltZW50KCkgd2hlbldoaXRlbGlzdGVkKG1zZy5zZW5kZXIpIHdoZW5TYWxlSGFzRW5kZWQgZXh0ZXJuYWwgewogICAgICAgIHJlcXVpcmUodG9rZW5zU29sZCA8IG1pbkNhcCk7CiAgICAgICAgcmVxdWlyZShpbnZlc3RtZW50c1ttc2cuc2VuZGVyXSA+IDApOwoKICAgICAgICB0b2tlbi5idXJuRnJvbShtc2cuc2VuZGVyLCB0b2tlbi5iYWxhbmNlT2YobXNnLnNlbmRlcikpOwoKICAgICAgICB1aW50MjU2IGludmVzdG1lbnQgPSBpbnZlc3RtZW50c1ttc2cuc2VuZGVyXTsKICAgICAgICBpbnZlc3RtZW50c1ttc2cuc2VuZGVyXSA9IDA7CiAgICAgICAgKG1zZy5zZW5kZXIpLnRyYW5zZmVyKGludmVzdG1lbnQpOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSB0b2tlbiBjb250cmFjdCBmcm9tIElDTyB0byBhIG5ld093bmVyLgogICAgKiBAcGFyYW0gX25ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlclRva2VuT3duZXJzaGlwKGFkZHJlc3MgX25ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICB0b2tlbi50cmFuc2Zlck93bmVyc2hpcChfbmV3T3duZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIHVwZGF0ZUljb0VuZGluZyh1aW50MjU2IF9lbmRUaW1lc3RhbXApIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGVuZFRpbWVzdGFtcCA9IF9lbmRUaW1lc3RhbXA7CiAgICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9HaWZ0RmFjdG9yeS5zb2wKCmNvbnRyYWN0IEdpZnRGYWN0b3J5IHsKICAgIEdpZnRDcm93ZHNhbGUgcHVibGljIGNyb3dkc2FsZTsKCiAgICBmdW5jdGlvbiBjcmVhdGVDcm93ZHNhbGUgKAogICAgICAgIHVpbnQyNTYgX3N0YXJ0VGltZXN0YW1wLAogICAgICAgIHVpbnQyNTYgX2VuZFRpbWVzdGFtcCwKICAgICAgICB1aW50MjU2IF9leGNoYW5nZVJhdGUsCiAgICAgICAgdWludDI1NiBfbWluQ2FwCiAgICApIHB1YmxpYwogICAgewogICAgICAgIGNyb3dkc2FsZSA9IG5ldyBHaWZ0Q3Jvd2RzYWxlKAogICAgICAgICAgICBfc3RhcnRUaW1lc3RhbXAsCiAgICAgICAgICAgIF9lbmRUaW1lc3RhbXAsCiAgICAgICAgICAgIF9leGNoYW5nZVJhdGUsCiAgICAgICAgICAgIF9taW5DYXAKICAgICAgICApOwoKICAgICAgICBXaGl0ZWxpc3Qgd2hpdGVsaXN0ID0gY3Jvd2RzYWxlLndoaXRlbGlzdCgpOwoKICAgICAgICBjcm93ZHNhbGUudHJhbnNmZXJPd25lcnNoaXAobXNnLnNlbmRlcik7CiAgICAgICAgd2hpdGVsaXN0LnRyYW5zZmVyT3duZXJzaGlwKG1zZy5zZW5kZXIpOwogICAgfQp9'.
	

]
