Class {
	#name : #SRT0af02d90d359a4628ace226df184c3e8b4b816ff,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT0af02d90d359a4628ace226df184c3e8b4b816ff >> base64 [
	^ 'Ly8gV0VMQ09NRSBUTyBUSEUgRU9TQkVULklPIEJVRyBCT1VOVFkgQ09OVFJBQ1RTIQovLyBHT09EIExVQ0suLi4gWU9VJ0xMIE5FRUQgSVQhCgpwcmFnbWEgc29saWRpdHkgXjAuNC4yMTsKCi8qKgogKiBAdGl0bGUgU2FmZU1hdGgKICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCmxpYnJhcnkgU2FmZU1hdGggewoKICAvKioKICAqIEBkZXYgTXVsdGlwbGllcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICovCiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IEludGVnZXIgZGl2aXNpb24gb2YgdHdvIG51bWJlcnMsIHRydW5jYXRpbmcgdGhlIHF1b3RpZW50LgogICovCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICAvKioKICAqIEBkZXYgU3VidHJhY3RzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cgKGkuZS4gaWYgc3VidHJhaGVuZCBpcyBncmVhdGVyIHRoYW4gbWludWVuZCkuCiAgKi8KICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICAvKioKICAqIEBkZXYgQWRkcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICovCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCmNvbnRyYWN0IEVPU0JldEdhbWVJbnRlcmZhY2UgewoJdWludDI1NiBwdWJsaWMgREVWRUxPUEVSU0ZVTkQ7Cgl1aW50MjU2IHB1YmxpYyBMSUFCSUxJVElFUzsKCWZ1bmN0aW9uIHBheURldmVsb3BlcnNGdW5kKGFkZHJlc3MgZGV2ZWxvcGVyKSBwdWJsaWM7CglmdW5jdGlvbiByZWNlaXZlUGF5bWVudEZvck9yYWNsaXplKCkgcGF5YWJsZSBwdWJsaWM7CglmdW5jdGlvbiBnZXRNYXhXaW4oKSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnQyNTYpOwp9Cgpjb250cmFjdCBFT1NCZXRCYW5rcm9sbEludGVyZmFjZSB7CglmdW5jdGlvbiBwYXlFdGhlclRvV2lubmVyKHVpbnQyNTYgYW10RXRoZXIsIGFkZHJlc3Mgd2lubmVyKSBwdWJsaWM7CglmdW5jdGlvbiByZWNlaXZlRXRoZXJGcm9tR2FtZUFkZHJlc3MoKSBwYXlhYmxlIHB1YmxpYzsKCWZ1bmN0aW9uIHBheU9yYWNsaXplKHVpbnQyNTYgYW1vdW50VG9QYXkpIHB1YmxpYzsKCWZ1bmN0aW9uIGdldEJhbmtyb2xsKCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50MjU2KTsKfQoKY29udHJhY3QgRVJDMjAgewoJZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludCBzdXBwbHkpOwoJZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludCBiYWxhbmNlKTsKCWZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CglmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCWZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoJZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludCByZW1haW5pbmcpOwoJZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50IF92YWx1ZSk7CglldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKTsKfQoKY29udHJhY3QgRU9TQmV0QmFua3JvbGwgaXMgRVJDMjAsIEVPU0JldEJhbmtyb2xsSW50ZXJmYWNlIHsKCgl1c2luZyBTYWZlTWF0aCBmb3IgKjsKCgkvLyBjb25zdGFudHMgZm9yIEVPU0JldCBCYW5rcm9sbAoKCWFkZHJlc3MgcHVibGljIE9XTkVSOwoJdWludDI1NiBwdWJsaWMgTUFYSU1VTUlOVkVTVE1FTlRTQUxMT1dFRDsKCXVpbnQyNTYgcHVibGljIFdBSVRUSU1FVU5USUxXSVRIRFJBV09SVFJBTlNGRVI7Cgl1aW50MjU2IHB1YmxpYyBERVZFTE9QRVJTRlVORDsKCgkvLyB0aGlzIHdpbGwgYmUgaW5pdGlhbGl6ZWQgYXMgdGhlIHRydXN0ZWQgZ2FtZSBhZGRyZXNzZXMgd2hpY2ggd2lsbCBmb3J3YXJkIHRoZWlyIGV0aGVyCgkvLyB0byB0aGUgYmFua3JvbGwgY29udHJhY3QsIGFuZCB3aGVuIHBsYXllcnMgd2luLCB0aGV5IHdpbGwgcmVxdWVzdCB0aGUgYmFua3JvbGwgY29udHJhY3QgCgkvLyB0byBzZW5kIHRoZXNlIHBsYXllcnMgdGhlaXIgd2lubmluZ3MuCgkvLyBGZWVsIGZyZWUgdG8gYXVkaXQgdGhlc2UgY29udHJhY3RzIG9uIGV0aGVyc2Nhbi4uLgoJbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBUUlVTVEVEQUREUkVTU0VTOwoKCWFkZHJlc3MgcHVibGljIERJQ0U7CglhZGRyZXNzIHB1YmxpYyBTTE9UUzsKCgkvLyBtYXBwaW5nIHRvIGxvZyB0aGUgbGFzdCB0aW1lIGEgdXNlciBjb250cmlidXRlZCB0byB0aGUgYmFua3JvbGwgCgltYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgY29udHJpYnV0aW9uVGltZTsKCgkvLyBjb25zdGFudHMgZm9yIEVSQzIwIHN0YW5kYXJkCglzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiRU9TQmV0IFN0YWtlIFRva2VucyI7CglzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJFT1NCRVRTVCI7Cgl1aW50OCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKCS8vIHZhcmlhYmxlIHRvdGFsIHN1cHBseQoJdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CgoJLy8gbWFwcGluZyB0byBzdG9yZSB0b2tlbnMKCW1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgYmFsYW5jZXM7CgltYXBwaW5nKGFkZHJlc3MgPT4gbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpKSBwdWJsaWMgYWxsb3dlZDsKCgkvLyBldmVudHMKCWV2ZW50IEZ1bmRCYW5rcm9sbChhZGRyZXNzIGNvbnRyaWJ1dG9yLCB1aW50MjU2IGV0aGVyQ29udHJpYnV0ZWQsIHVpbnQyNTYgdG9rZW5zUmVjZWl2ZWQpOwoJZXZlbnQgQ2FzaE91dChhZGRyZXNzIGNvbnRyaWJ1dG9yLCB1aW50MjU2IGV0aGVyV2l0aGRyYXduLCB1aW50MjU2IHRva2Vuc0Nhc2hlZEluKTsKCWV2ZW50IEZhaWxlZFNlbmQoYWRkcmVzcyBzZW5kVG8sIHVpbnQyNTYgYW10KTsKCgkvLyBjaGVja3MgdGhhdCBhbiBhZGRyZXNzIGlzIGEgInRydXN0ZWQgYWRkcmVzcyBvZiBhIGxlZ2l0aW1hdGUgRU9TQmV0IGdhbWUiCgltb2RpZmllciBhZGRyZXNzSW5UcnVzdGVkQWRkcmVzc2VzKGFkZHJlc3MgdGhpc0FkZHJlc3MpewoKCQlyZXF1aXJlKFRSVVNURURBRERSRVNTRVNbdGhpc0FkZHJlc3NdKTsKCQlfOwoJfQoKCS8vIGluaXRpYWxpemF0aW9uIGZ1bmN0aW9uIAoJZnVuY3Rpb24gRU9TQmV0QmFua3JvbGwoYWRkcmVzcyBkaWNlLCBhZGRyZXNzIHNsb3RzKSBwdWJsaWMgcGF5YWJsZSB7CgkJLy8gZnVuY3Rpb24gaXMgcGF5YWJsZSwgb3duZXIgb2YgY29udHJhY3QgTVVTVCAic2VlZCIgY29udHJhY3Qgd2l0aCBzb21lIGV0aGVyLCAKCQkvLyBzbyB0aGF0IHRoZSByYXRpb3MgYXJlIGNvcnJlY3Qgd2hlbiB0b2tlbnMgYXJlIGJlaW5nIG1pbnRlZAoJCXJlcXVpcmUgKG1zZy52YWx1ZSA+IDApOwoKCQlPV05FUiA9IG1zZy5zZW5kZXI7CgoJCS8vIDEwMCB0b2tlbnMvZXRoZXIgaXMgdGhlIGluaXRhbCBzZWVkIGFtb3VudCwgc286CgkJdWludDI1NiBpbml0aWFsVG9rZW5zID0gbXNnLnZhbHVlICogMTAwOwoJCWJhbGFuY2VzW21zZy5zZW5kZXJdID0gaW5pdGlhbFRva2VuczsKCQl0b3RhbFN1cHBseSA9IGluaXRpYWxUb2tlbnM7CgoJCS8vIGxvZyBhIG1pbnQgdG9rZW5zIGV2ZW50CgkJZW1pdCBUcmFuc2ZlcigweDAsIG1zZy5zZW5kZXIsIGluaXRpYWxUb2tlbnMpOwoKCQkvLyBpbnNlcnQgZ2l2ZW4gZ2FtZSBhZGRyZXNzZXMgaW50byB0aGUgVFJVU1RFREFERFJFU1NFUyBtYXBwaW5nLCBhbmQgc2F2ZSB0aGUgYWRkcmVzc2VzIGFzIGdsb2JhbCB2YXJpYWJsZXMKCQlUUlVTVEVEQUREUkVTU0VTW2RpY2VdID0gdHJ1ZTsKCQlUUlVTVEVEQUREUkVTU0VTW3Nsb3RzXSA9IHRydWU7CgoJCURJQ0UgPSBkaWNlOwoJCVNMT1RTID0gc2xvdHM7CgoJCS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoJCS8vIENIQU5HRSBUTyA2IEhPVVJTIE9OIExJVkUgREVQTE9ZTUVOVAoJCS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoJCVdBSVRUSU1FVU5USUxXSVRIRFJBV09SVFJBTlNGRVIgPSAwIHNlY29uZHM7CgkJTUFYSU1VTUlOVkVTVE1FTlRTQUxMT1dFRCA9IDUwMCBldGhlcjsKCX0KCgkvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoJLy8gVklFVyBGVU5DVElPTlMKCS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIAoKCWZ1bmN0aW9uIGNoZWNrV2hlbkNvbnRyaWJ1dG9yQ2FuVHJhbnNmZXJPcldpdGhkcmF3KGFkZHJlc3MgYmFua3JvbGxlckFkZHJlc3MpIHZpZXcgcHVibGljIHJldHVybnModWludDI1Nil7CgkJcmV0dXJuIGNvbnRyaWJ1dGlvblRpbWVbYmFua3JvbGxlckFkZHJlc3NdOwoJfQoKCWZ1bmN0aW9uIGdldEJhbmtyb2xsKCkgdmlldyBwdWJsaWMgcmV0dXJucyh1aW50MjU2KXsKCQkvLyByZXR1cm5zIHRoZSB0b3RhbCBiYWxhbmNlIG1pbnVzIHRoZSBkZXZlbG9wZXJzIGZ1bmQsIGFzIHRoZSBhbW91bnQgb2YgYWN0aXZlIGJhbmtyb2xsCgkJcmV0dXJuIFNhZmVNYXRoLnN1YihhZGRyZXNzKHRoaXMpLmJhbGFuY2UsIERFVkVMT1BFUlNGVU5EKTsKCX0KCgkvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoJLy8gQkFOS1JPTEwgQ09OVFJBQ1QgPC0+IEdBTUUgQ09OVFJBQ1RTIGZ1bmN0aW9ucwoJLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gCgoJZnVuY3Rpb24gcGF5RXRoZXJUb1dpbm5lcih1aW50MjU2IGFtdEV0aGVyLCBhZGRyZXNzIHdpbm5lcikgcHVibGljIGFkZHJlc3NJblRydXN0ZWRBZGRyZXNzZXMobXNnLnNlbmRlcil7CgkJLy8gdGhpcyBmdW5jdGlvbiB3aWxsIGdldCBjYWxsZWQgYnkgYSBnYW1lIGNvbnRyYWN0IHdoZW4gc29tZW9uZSB3aW5zIGEgZ2FtZQoJCS8vIHRyeSB0byBzZW5kLCBpZiBpdCBmYWlscywgdGhlbiBzZW5kIHRoZSBhbW91bnQgdG8gdGhlIG93bmVyCgkJLy8gbm90ZSwgdGhpcyB3aWxsIG9ubHkgaGFwcGVuIGlmIHNvbWVvbmUgaXMgY2FsbGluZyB0aGUgYmV0dGluZyBmdW5jdGlvbnMgd2l0aAoJCS8vIGEgY29udHJhY3QuIFRoZXkgYXJlIGNsZWFybHkgdXAgdG8gbm8gZ29vZCwgc28gdGhleSBjYW4gY29udGFjdCB1cyB0byByZXRyZWl2ZSAKCQkvLyB0aGVpciBldGhlcgoJCS8vIGlmIHRoZSBldGhlciBjYW5ub3QgYmUgc2VudCB0byB1cywgdGhlIE9XTkVSLCB0aGF0IG1lYW5zIHdlIGFyZSB1cCB0byBubyBnb29kLCAKCQkvLyBhbmQgdGhlIGV0aGVyIHdpbGwganVzdCBiZSBnaXZlbiB0byB0aGUgYmFua3JvbGxlcnMgYXMgaWYgdGhlIHBsYXllci9vd25lciBsb3N0IAoKCQlpZiAoISB3aW5uZXIuc2VuZChhbXRFdGhlcikpewoKCQkJZW1pdCBGYWlsZWRTZW5kKHdpbm5lciwgYW10RXRoZXIpOwoKCQkJaWYgKCEgT1dORVIuc2VuZChhbXRFdGhlcikpewoKCQkJCWVtaXQgRmFpbGVkU2VuZChPV05FUiwgYW10RXRoZXIpOwoJCQl9CgkJfQoJfQoKCWZ1bmN0aW9uIHJlY2VpdmVFdGhlckZyb21HYW1lQWRkcmVzcygpIHBheWFibGUgcHVibGljIGFkZHJlc3NJblRydXN0ZWRBZGRyZXNzZXMobXNnLnNlbmRlcil7CgkJLy8gdGhpcyBmdW5jdGlvbiB3aWxsIGdldCBjYWxsZWQgZnJvbSB0aGUgZ2FtZSBjb250cmFjdHMgd2hlbiBzb21lb25lIHN0YXJ0cyBhIGdhbWUuCgl9CgoJZnVuY3Rpb24gcGF5T3JhY2xpemUodWludDI1NiBhbW91bnRUb1BheSkgcHVibGljIGFkZHJlc3NJblRydXN0ZWRBZGRyZXNzZXMobXNnLnNlbmRlcil7CgkJLy8gdGhpcyBmdW5jdGlvbiB3aWxsIGdldCBjYWxsZWQgd2hlbiBhIGdhbWUgY29udHJhY3QgbXVzdCBwYXkgcGF5T3JhY2xpemUKCQlFT1NCZXRHYW1lSW50ZXJmYWNlKG1zZy5zZW5kZXIpLnJlY2VpdmVQYXltZW50Rm9yT3JhY2xpemUudmFsdWUoYW1vdW50VG9QYXkpKCk7Cgl9CgoJLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCS8vIEJBTktST0xMIENPTlRSQUNUIE1BSU4gRlVOQ1RJT05TCgkvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKCgkvLyB0aGlzIGZ1bmN0aW9uIEFERFMgdG8gdGhlIGJhbmtyb2xsIG9mIEVPU0JldCwgYW5kIGNyZWRpdHMgdGhlIGJhbmtyb2xsZXIgYSBwcm9wb3J0aW9uYWwKCS8vIGFtb3VudCBvZiB0b2tlbnMgc28gdGhleSBtYXkgd2l0aGRyYXcgdGhlaXIgdG9rZW5zIGxhdGVyCgkvLyBhbHNvIGlmIHRoZXJlIGlzIG9ubHkgYSBsaW1pdGVkIGFtb3VudCBvZiBzcGFjZSBsZWZ0IGluIHRoZSBiYW5rcm9sbCwgYSB1c2VyIGNhbiBqdXN0IHNlbmQgYXMgbXVjaCAKCS8vIGV0aGVyIGFzIHRoZXkgd2FudCwgYmVjYXVzZSB0aGV5IHdpbGwgYmUgYWJsZSB0byBjb250cmlidXRlIHVwIHRvIHRoZSBtYXhpbXVtLCBhbmQgdGhlbiBnZXQgcmVmdW5kZWQgdGhlIHJlc3QuCglmdW5jdGlvbiAoKSBwdWJsaWMgcGF5YWJsZSB7CgoJCS8vIHNhdmUgaW4gbWVtb3J5IGZvciBjaGVhcCBhY2Nlc3MuCgkJLy8gdGhpcyByZXByZXNlbnRzIHRoZSB0b3RhbCBiYW5rcm9sbCBiYWxhbmNlIGJlZm9yZSB0aGUgZnVuY3Rpb24gd2FzIGNhbGxlZC4KCQl1aW50MjU2IGN1cnJlbnRUb3RhbEJhbmtyb2xsID0gU2FmZU1hdGguc3ViKGdldEJhbmtyb2xsKCksIG1zZy52YWx1ZSk7CgkJdWludDI1NiBtYXhJbnZlc3RtZW50c0FsbG93ZWQgPSBNQVhJTVVNSU5WRVNUTUVOVFNBTExPV0VEOwoKCQlyZXF1aXJlKGN1cnJlbnRUb3RhbEJhbmtyb2xsIDwgbWF4SW52ZXN0bWVudHNBbGxvd2VkICYmIG1zZy52YWx1ZSAhPSAwKTsKCgkJdWludDI1NiBjdXJyZW50U3VwcGx5T2ZUb2tlbnMgPSB0b3RhbFN1cHBseTsKCQl1aW50MjU2IGNvbnRyaWJ1dGVkRXRoZXI7CgoJCWJvb2wgY29udHJpYnV0aW9uVGFrZXNCYW5rcm9sbE92ZXJMaW1pdDsKCQl1aW50MjU2IGlmQ29udHJpYnV0aW9uVGFrZXNCYW5rcm9sbE92ZXJMaW1pdF9SZWZ1bmQ7CgoJCXVpbnQyNTYgY3JlZGl0ZWRUb2tlbnM7CgoJCWlmIChTYWZlTWF0aC5hZGQoY3VycmVudFRvdGFsQmFua3JvbGwsIG1zZy52YWx1ZSkgPiBtYXhJbnZlc3RtZW50c0FsbG93ZWQpewoJCQkvLyBhbGxvdyB0aGUgYmFua3JvbGxlciB0byBjb250cmlidXRlIHVwIHRvIHRoZSBhbGxvd2VkIGFtb3VudCBvZiBldGhlciwgYW5kIHJlZnVuZCB0aGUgcmVzdC4KCQkJY29udHJpYnV0aW9uVGFrZXNCYW5rcm9sbE92ZXJMaW1pdCA9IHRydWU7CgkJCS8vIHNldCBjb250cmlidXRlZCBldGhlciBhcyAoTUFYSU1VTUlOVkVTVE1FTlRTQUxMT1dFRCAtIEJBTktST0xMKQoJCQljb250cmlidXRlZEV0aGVyID0gU2FmZU1hdGguc3ViKG1heEludmVzdG1lbnRzQWxsb3dlZCwgY3VycmVudFRvdGFsQmFua3JvbGwpOwoJCQkvLyByZWZ1bmQgdGhlIHJlc3Qgb2YgdGhlIGV0aGVyLCB3aGljaCBpcyAob3JpZ2luYWwgYW1vdW50IHNlbnQgLSAobWF4aW11bSBhbW91bnQgYWxsb3dlZCAtIGJhbmtyb2xsKSkKCQkJaWZDb250cmlidXRpb25UYWtlc0Jhbmtyb2xsT3ZlckxpbWl0X1JlZnVuZCA9IFNhZmVNYXRoLnN1Yihtc2cudmFsdWUsIGNvbnRyaWJ1dGVkRXRoZXIpOwoJCX0KCQllbHNlIHsKCQkJY29udHJpYnV0ZWRFdGhlciA9IG1zZy52YWx1ZTsKCQl9CiAgICAgICAgCgkJaWYgKGN1cnJlbnRTdXBwbHlPZlRva2VucyAhPSAwKXsKCQkJLy8gZGV0ZXJtaW5lIHRoZSByYXRpbyBvZiBjb250cmlidXRpb24gdmVyc3VzIHRvdGFsIEJBTktST0xMLgoJCQljcmVkaXRlZFRva2VucyA9IFNhZmVNYXRoLm11bChjb250cmlidXRlZEV0aGVyLCBjdXJyZW50U3VwcGx5T2ZUb2tlbnMpIC8gY3VycmVudFRvdGFsQmFua3JvbGw7CgkJfQoJCWVsc2UgewoJCQkvLyBlZGdlIGNhc2Ugd2hlcmUgQUxMIG1vbmV5IHdhcyBjYXNoZWQgb3V0IGZyb20gYmFua3JvbGwKCQkJLy8gc28gY3VycmVudFN1cHBseU9mVG9rZW5zID09IDAKCQkJLy8gY3VycmVudFRvdGFsQmFua3JvbGwgY2FuID09IDAgb3Igbm90LCBpZiBzb21lb25lIG1pbmVzL3NlbGZkZXN0cnVjdCdzIHRvIHRoZSBjb250cmFjdAoJCQkvLyBidXQgZWl0aGVyIHdheSwgZ2l2ZSBhbGwgdGhlIGJhbmtyb2xsIHRvIHBlcnNvbiB3aG8gZGVwb3NpdHMgZXRoZXIKCQkJY3JlZGl0ZWRUb2tlbnMgPSBTYWZlTWF0aC5tdWwoY29udHJpYnV0ZWRFdGhlciwgMTAwKTsKCQl9CgkJCgkJLy8gbm93IHVwZGF0ZSB0aGUgdG90YWwgc3VwcGx5IG9mIHRva2VucyBhbmQgYmFua3JvbGwgYW1vdW50CgkJdG90YWxTdXBwbHkgPSBTYWZlTWF0aC5hZGQoY3VycmVudFN1cHBseU9mVG9rZW5zLCBjcmVkaXRlZFRva2Vucyk7CgoJCS8vIG5vdyBjcmVkaXQgdGhlIHVzZXIgd2l0aCBoaXMgYW1vdW50IG9mIGNvbnRyaWJ1dGVkIHRva2VucyAKCQliYWxhbmNlc1ttc2cuc2VuZGVyXSA9IFNhZmVNYXRoLmFkZChiYWxhbmNlc1ttc2cuc2VuZGVyXSwgY3JlZGl0ZWRUb2tlbnMpOwoKCQkvLyB1cGRhdGUgaGlzIGNvbnRyaWJ1dGlvbiB0aW1lIGZvciBzdGFrZSB0aW1lIGxvY2tpbmcKCQljb250cmlidXRpb25UaW1lW21zZy5zZW5kZXJdID0gYmxvY2sudGltZXN0YW1wOwoKCQkvLyBub3cgbG9vayBpZiB0aGUgYXR0ZW1wdGVkIGNvbnRyaWJ1dGlvbiB3b3VsZCBoYXZlIHRha2VuIHRoZSBCQU5LUk9MTCBvdmVyIHRoZSBsaW1pdCwgCgkJLy8gYW5kIGlmIHRydWUsIHJlZnVuZCB0aGUgZXhjZXNzIGV0aGVyLgoJCWlmIChjb250cmlidXRpb25UYWtlc0Jhbmtyb2xsT3ZlckxpbWl0KXsKCQkJbXNnLnNlbmRlci50cmFuc2ZlcihpZkNvbnRyaWJ1dGlvblRha2VzQmFua3JvbGxPdmVyTGltaXRfUmVmdW5kKTsKCQl9CgoJCS8vIGxvZyBhbiBldmVudCBhYm91dCBmdW5kaW5nIGJhbmtyb2xsCgkJZW1pdCBGdW5kQmFua3JvbGwobXNnLnNlbmRlciwgY29udHJpYnV0ZWRFdGhlciwgY3JlZGl0ZWRUb2tlbnMpOwoKCQkvLyBsb2cgYSBtaW50IHRva2VucyBldmVudAoJCWVtaXQgVHJhbnNmZXIoMHgwLCBtc2cuc2VuZGVyLCBjcmVkaXRlZFRva2Vucyk7Cgl9CgoJZnVuY3Rpb24gY2FzaG91dEVPU0JldFN0YWtlVG9rZW5zKHVpbnQyNTYgX2Ftb3VudFRva2VucykgcHVibGljIHsKCQkvLyBJbiBlZmZlY3QsIHRoaXMgZnVuY3Rpb24gaXMgdGhlIE9QUE9TSVRFIG9mIHRoZSB1bi1uYW1lZCBwYXlhYmxlIGZ1bmN0aW9uIGFib3ZlXl5eCgkJLy8gdGhpcyBhbGxvd3MgYmFua3JvbGxlcnMgdG8gImNhc2ggb3V0IiBhdCBhbnkgdGltZSwgYW5kIHJlY2VpdmUgdGhlIGV0aGVyIHRoYXQgdGhleSBjb250cmlidXRlZCwgUExVUwoJCS8vIGEgcHJvcG9ydGlvbiBvZiBhbnkgZXRoZXIgdGhhdCB3YXMgZWFybmVkIGJ5IHRoZSBzbWFydCBjb250YWN0IHdoZW4gdGhlaXIgZXRoZXIgd2FzICJzdGFraW5nIiwgSG93ZXZlcgoJCS8vIHRoaXMgd29ya3MgaW4gcmV2ZXJzZSBhcyB3ZWxsLiBBbnkgbmV0IGxvc3NlcyBvZiB0aGUgc21hcnQgY29udHJhY3Qgd2lsbCBiZSBhYnNvcmJlZCBieSB0aGUgcGxheWVyIGluIGxpa2UgbWFubmVyLgoJCS8vIE9mIGNvdXJzZSwgZHVlIHRvIHRoZSBjb25zdGFudCBob3VzZSBlZGdlLCBhIGJhbmtyb2xsZXIgdGhhdCBsZWF2ZXMgdGhlaXIgZXRoZXIgaW4gdGhlIGNvbnRyYWN0IGxvbmcgZW5vdWdoCgkJLy8gaXMgZWZmZWN0aXZlbHkgZ3VhcmFudGVlZCB0byB3aXRoZHJhdyBtb3JlIGV0aGVyIHRoYW4gdGhleSBvcmlnaW5hbGx5ICJzdGFrZWQiCgoJCS8vIHNhdmUgaW4gbWVtb3J5IGZvciBjaGVhcCBhY2Nlc3MuCgkJdWludDI1NiB0b2tlbkJhbGFuY2UgPSBiYWxhbmNlc1ttc2cuc2VuZGVyXTsKCQkvLyB2ZXJpZnkgdGhhdCB0aGUgY29udHJpYnV0b3IgaGFzIGVub3VnaCB0b2tlbnMgdG8gY2FzaCBvdXQgdGhpcyBtYW55LCBhbmQgaGFzIHdhaXRlZCB0aGUgcmVxdWlyZWQgdGltZS4KCQlyZXF1aXJlKF9hbW91bnRUb2tlbnMgPD0gdG9rZW5CYWxhbmNlIAoJCQkmJiBjb250cmlidXRpb25UaW1lW21zZy5zZW5kZXJdICsgV0FJVFRJTUVVTlRJTFdJVEhEUkFXT1JUUkFOU0ZFUiA8PSBibG9jay50aW1lc3RhbXAKCQkJJiYgX2Ftb3VudFRva2VucyA+IDApOwoKCQkvLyBzYXZlIGluIG1lbW9yeSBmb3IgY2hlYXAgYWNjZXNzLgoJCS8vIGFnYWluLCByZXByZXNlbnRzIHRoZSB0b3RhbCBiYWxhbmNlIG9mIHRoZSBjb250cmFjdCBiZWZvcmUgdGhlIGZ1bmN0aW9uIHdhcyBjYWxsZWQuCgkJdWludDI1NiBjdXJyZW50VG90YWxCYW5rcm9sbCA9IGdldEJhbmtyb2xsKCk7CgkJdWludDI1NiBjdXJyZW50U3VwcGx5T2ZUb2tlbnMgPSB0b3RhbFN1cHBseTsKCgkJLy8gY2FsY3VsYXRlIHRoZSB0b2tlbiB3aXRoZHJhdyByYXRpbyBiYXNlZCBvbiBjdXJyZW50IHN1cHBseSAKCQl1aW50MjU2IHdpdGhkcmF3RXRoZXIgPSBTYWZlTWF0aC5tdWwoX2Ftb3VudFRva2VucywgY3VycmVudFRvdGFsQmFua3JvbGwpIC8gY3VycmVudFN1cHBseU9mVG9rZW5zOwoKCQkvLyBkZXZlbG9wZXJzIHRha2UgMSUgb2Ygd2l0aGRyYXdscyAKCQl1aW50MjU2IGRldmVsb3BlcnNDdXQgPSB3aXRoZHJhd0V0aGVyIC8gMTAwOwoJCXVpbnQyNTYgY29udHJpYnV0b3JBbW91bnQgPSBTYWZlTWF0aC5zdWIod2l0aGRyYXdFdGhlciwgZGV2ZWxvcGVyc0N1dCk7CgoJCS8vIG5vdyB1cGRhdGUgdGhlIHRvdGFsIHN1cHBseSBvZiB0b2tlbnMgYnkgc3VidHJhY3RpbmcgdGhlIHRva2VucyB0aGF0IGFyZSBiZWluZyAiY2FzaGVkIGluIgoJCXRvdGFsU3VwcGx5ID0gU2FmZU1hdGguc3ViKGN1cnJlbnRTdXBwbHlPZlRva2VucywgX2Ftb3VudFRva2Vucyk7CgoJCS8vIGFuZCB1cGRhdGUgdGhlIHVzZXJzIHN1cHBseSBvZiB0b2tlbnMgCgkJYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBTYWZlTWF0aC5zdWIodG9rZW5CYWxhbmNlLCBfYW1vdW50VG9rZW5zKTsKCgkJLy8gdXBkYXRlIHRoZSBkZXZlbG9wZXJzIGZ1bmQgYmFzZWQgb24gdGhpcyBjYWxjdWxhdGVkIGFtb3VudCAKCQlERVZFTE9QRVJTRlVORCA9IFNhZmVNYXRoLmFkZChERVZFTE9QRVJTRlVORCwgZGV2ZWxvcGVyc0N1dCk7CgoJCS8vIGxhc3RseSwgdHJhbnNmZXIgdGhlIGV0aGVyIGJhY2sgdG8gdGhlIGJhbmtyb2xsZXIuIFRoYW5rcyBmb3IgeW91ciBjb250cmlidXRpb24hCgkJbXNnLnNlbmRlci50cmFuc2Zlcihjb250cmlidXRvckFtb3VudCk7CgoJCS8vIGxvZyBhbiBldmVudCBhYm91dCBjYXNob3V0CgkJZW1pdCBDYXNoT3V0KG1zZy5zZW5kZXIsIGNvbnRyaWJ1dG9yQW1vdW50LCBfYW1vdW50VG9rZW5zKTsKCgkJLy8gbG9nIGEgZGVzdHJveSB0b2tlbnMgZXZlbnQKCQllbWl0IFRyYW5zZmVyKG1zZy5zZW5kZXIsIDB4MCwgX2Ftb3VudFRva2Vucyk7Cgl9CgoJLy8gVE8gQ0FMTCBUSElTIEZVTkNUSU9OIEVBU0lMWSwgU0VORCBBIDAgRVRIRVIgVFJBTlNBQ1RJT04gVE8gVEhJUyBDT05UUkFDVCBXSVRIIEVYVFJBIERBVEE6IDB4N2EwOTU4OGIKCWZ1bmN0aW9uIGNhc2hvdXRFT1NCZXRTdGFrZVRva2Vuc19BTEwoKSBwdWJsaWMgewoKCQkvLyBqdXN0IGZvcndhcmQgdG8gY2FzaG91dEVPU0JldFN0YWtlVG9rZW5zIHdpdGggaW5wdXQgYXMgdGhlIHNlbmRlcnMgZW50aXJlIGJhbGFuY2UKCQljYXNob3V0RU9TQmV0U3Rha2VUb2tlbnMoYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoJfQoKCS8vLy8vLy8vLy8vLy8vLy8vLy8vCgkvLyBPV05FUiBGVU5DVElPTlM6CgkvLy8vLy8vLy8vLy8vLy8vLy8vLwoJLy8gUGxlYXNlLCBiZSBhd2FyZSB0aGF0IHRoZSBvd25lciBPTkxZIGNhbiBjaGFuZ2U6CgkJLy8gMS4gVGhlIG93bmVyIGNhbiBpbmNyZWFzZSBvciBkZWNyZWFzZSB0aGUgdGFyZ2V0IGFtb3VudCBmb3IgYSBnYW1lLiBUaGV5IGNhbiB0aGVuIGNhbGwgdGhlIHVwZGF0ZXIgZnVuY3Rpb24gdG8gZ2l2ZS9yZWNlaXZlIHRoZSBldGhlciBmcm9tIHRoZSBnYW1lLgoJCS8vIDEuIFRoZSB3YWl0IHRpbWUgdW50aWwgYSB1c2VyIGNhbiB3aXRoZHJhdyBvciB0cmFuc2ZlciB0aGVpciB0b2tlbnMgYWZ0ZXIgcHVyY2hhc2UgdGhyb3VnaCB0aGUgZGVmYXVsdCBmdW5jdGlvbiBhYm92ZSBeXl4KCQkvLyAyLiBUaGUgb3duZXIgY2FuIGNoYW5nZSB0aGUgbWF4aW11bSBhbW91bnQgb2YgaW52ZXN0bWVudHMgYWxsb3dlZC4gVGhpcyBhbGxvd3MgZm9yIGVhcmx5IGNvbnRyaWJ1dG9ycyB0byBndWFyYW50ZWUKCQkvLyAJCWEgY2VydGFpbiBwZXJjZW50YWdlIG9mIHRoZSBiYW5rcm9sbCBzbyB0aGF0IHRoZWlyIHN0YWtlIGNhbm5vdCBiZSBkaWx1dGVkIGltbWVkaWF0ZWx5LiBIb3dldmVyLCBiZSBhd2FyZSB0aGF0IHRoZSAKCQkvLwkJbWF4aW11bSBhbW91bnQgb2YgaW52ZXN0bWVudHMgYWxsb3dlZCB3aWxsIGJlIHJhaXNlZCBvdmVyIHRpbWUuIFRoaXMgd2lsbCBhbGxvdyBmb3IgaGlnaGVyIGJldHMgYnkgZ2FtYmxlcnMsIHJlc3VsdGluZwoJCS8vIAkJaW4gaGlnaGVyIGRpdmlkZW5kcyBmb3IgdGhlIGJhbmtyb2xsZXJzCgkJLy8gMy4gVGhlIG93bmVyIGNhbiBmcmVlemUgcGF5b3V0cyB0byBiZXR0b3JzLiBUaGlzIHdpbGwgYmUgdXNlZCBpbiBjYXNlIG9mIGFuIGVtZXJnZW5jeSwgYW5kIHRoZSBjb250cmFjdCB3aWxsIHJlamVjdCBhbGwKCQkvLwkJbmV3IGJldHMgYXMgd2VsbC4gVGhpcyBkb2VzIG5vdCBtZWFuIHRoYXQgYmV0dG9ycyB3aWxsIGxvc2UgdGhlaXIgbW9uZXkgd2l0aG91dCByZWNvbXBlbnNlLiBUaGV5IHdpbGwgYmUgYWxsb3dlZCB0byBjYWxsIHRoZSAKCQkvLyAJCSJyZWZ1bmQiIGZ1bmN0aW9uIGluIHRoZSByZXNwZWN0aXZlIGdhbWUgc21hcnQgY29udHJhY3Qgb25jZSBwYXlvdXRzIGFyZSB1bi1mcm96ZW4uCgkJLy8gNC4gRmluYWxseSwgdGhlIG93bmVyIGNhbiBtb2RpZnkgYW5kIHdpdGhkcmF3IHRoZSBkZXZlbG9wZXJzIHJld2FyZCwgd2hpY2ggd2lsbCBmdW5kIGZ1dHVyZSBkZXZlbG9wbWVudCwgaW5jbHVkaW5nIG5ldyBnYW1lcywgYSBzZXhpZXIgZnJvbnRlbmQsCgkJLy8gCQlhbmQgVFJVRSBEQU8gZ292ZXJuYW5jZSBzbyB0aGF0IG9ubHlPd25lciBmdW5jdGlvbnMgZG9uJ3QgaGF2ZSB0byBleGlzdCBhbnltb3JlIDspIGFuZCBpbiBvcmRlciB0byBlZmZlY3RpdmVseSByZWFjdCB0byBjaGFuZ2VzIAoJCS8vIAkJaW4gdGhlIG1hcmtldCAobG93ZXIgdGhlIHBlcmNlbnRhZ2UgYmVjYXVzZSBvZiBpbmNyZWFzZWQgY29tcGV0aXRpb24gaW4gdGhlIGJsb2NrY2hhaW4gY2FzaW5vIHNwYWNlLCBldGMuKQoKCWZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyB7CgkJcmVxdWlyZShtc2cuc2VuZGVyID09IE9XTkVSKTsKCgkJT1dORVIgPSBuZXdPd25lcjsKCX0KCglmdW5jdGlvbiBjaGFuZ2VXYWl0VGltZVVudGlsV2l0aGRyYXdPclRyYW5zZmVyKHVpbnQyNTYgd2FpdFRpbWUpIHB1YmxpYyB7CgkJLy8gd2FpdFRpbWUgTVVTVCBiZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gMTAgd2Vla3MKCQlyZXF1aXJlIChtc2cuc2VuZGVyID09IE9XTkVSICYmIHdhaXRUaW1lIDw9IDYwNDgwMDApOwoKCQlXQUlUVElNRVVOVElMV0lUSERSQVdPUlRSQU5TRkVSID0gd2FpdFRpbWU7Cgl9CgoJZnVuY3Rpb24gY2hhbmdlTWF4aW11bUludmVzdG1lbnRzQWxsb3dlZCh1aW50MjU2IG1heEFtb3VudCkgcHVibGljIHsKCQlyZXF1aXJlKG1zZy5zZW5kZXIgPT0gT1dORVIpOwoKCQlNQVhJTVVNSU5WRVNUTUVOVFNBTExPV0VEID0gbWF4QW1vdW50OwoJfQoKCglmdW5jdGlvbiB3aXRoZHJhd0RldmVsb3BlcnNGdW5kKGFkZHJlc3MgcmVjZWl2ZXIpIHB1YmxpYyB7CgkJcmVxdWlyZShtc2cuc2VuZGVyID09IE9XTkVSKTsKCgkJLy8gZmlyc3QgZ2V0IGRldmVsb3BlcnMgZnVuZCBmcm9tIGVhY2ggZ2FtZSAKICAgICAgICBFT1NCZXRHYW1lSW50ZXJmYWNlKERJQ0UpLnBheURldmVsb3BlcnNGdW5kKHJlY2VpdmVyKTsKCQlFT1NCZXRHYW1lSW50ZXJmYWNlKFNMT1RTKS5wYXlEZXZlbG9wZXJzRnVuZChyZWNlaXZlcik7CgoJCS8vIG5vdyBzZW5kIHRoZSBkZXZlbG9wZXJzIGZ1bmQgZnJvbSB0aGUgbWFpbiBjb250cmFjdC4KCQl1aW50MjU2IGRldmVsb3BlcnNGdW5kID0gREVWRUxPUEVSU0ZVTkQ7CgoJCS8vIHNldCBkZXZlbG9wZXJzIGZ1bmQgdG8gemVybwoJCURFVkVMT1BFUlNGVU5EID0gMDsKCgkJLy8gdHJhbnNmZXIgdGhpcyBhbW91bnQgdG8gdGhlIG93bmVyIQoJCXJlY2VpdmVyLnRyYW5zZmVyKGRldmVsb3BlcnNGdW5kKTsKCX0KCgkvLyBDYW4gYmUgcmVtb3ZlZCBhZnRlciBzb21lIHRlc3RpbmcuLi4KCWZ1bmN0aW9uIGVtZXJnZW5jeVNlbGZEZXN0cnVjdCgpIHB1YmxpYyB7CgkJcmVxdWlyZShtc2cuc2VuZGVyID09IE9XTkVSKTsKCgkJc2VsZmRlc3RydWN0KG1zZy5zZW5kZXIpOwoJfQoKCS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCS8vIEJBU0lDIEVSQzIwIFRPS0VOIE9QRVJBVElPTlMKCS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCglmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zKHVpbnQpewoJCXJldHVybiB0b3RhbFN1cHBseTsKCX0KCglmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zKHVpbnQpewoJCXJldHVybiBiYWxhbmNlc1tfb3duZXJdOwoJfQoKCS8vIGRvbid0IGFsbG93IHRyYW5zZmVycyBiZWZvcmUgdGhlIHJlcXVpcmVkIHdhaXQtdGltZQoJLy8gYW5kIGRvbid0IGFsbG93IHRyYW5zZmVycyB0byB0aGlzIGNvbnRyYWN0IGFkZHIsIGl0J2xsIGp1c3Qga2lsbCB0b2tlbnMKCWZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyl7CgkJaWYgKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IF92YWx1ZSAKCQkJJiYgX3ZhbHVlID4gMCAKCQkJJiYgY29udHJpYnV0aW9uVGltZVttc2cuc2VuZGVyXSArIFdBSVRUSU1FVU5USUxXSVRIRFJBV09SVFJBTlNGRVIgPD0gYmxvY2sudGltZXN0YW1wCgkJCSYmIF90byAhPSBhZGRyZXNzKHRoaXMpKXsKCgkJCS8vIHNhZmVseSBzdWJ0cmFjdAoJCQliYWxhbmNlc1ttc2cuc2VuZGVyXSA9IFNhZmVNYXRoLnN1YihiYWxhbmNlc1ttc2cuc2VuZGVyXSwgX3ZhbHVlKTsKCQkJYmFsYW5jZXNbX3RvXSA9IFNhZmVNYXRoLmFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOwoKCQkJLy8gbG9nIGV2ZW50IAoJCQllbWl0IFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKCQkJcmV0dXJuIHRydWU7CgkJfQoJCWVsc2UgewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJfQoKCS8vIGRvbid0IGFsbG93IHRyYW5zZmVycyBiZWZvcmUgdGhlIHJlcXVpcmVkIHdhaXQtdGltZQoJLy8gYW5kIGRvbid0IGFsbG93IHRyYW5zZmVycyB0byB0aGUgY29udHJhY3QgYWRkciwgaXQnbGwganVzdCBraWxsIHRva2VucwoJZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcHVibGljIHJldHVybnMoYm9vbCl7CgkJaWYgKGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSAKCQkJJiYgYmFsYW5jZXNbX2Zyb21dID49IF92YWx1ZSAKCQkJJiYgX3ZhbHVlID4gMCAKCQkJJiYgY29udHJpYnV0aW9uVGltZVtfZnJvbV0gKyBXQUlUVElNRVVOVElMV0lUSERSQVdPUlRSQU5TRkVSIDw9IGJsb2NrLnRpbWVzdGFtcAoJCQkmJiBfdG8gIT0gYWRkcmVzcyh0aGlzKSl7CgoJCQkvLyBzYWZlbHkgYWRkIHRvIF90byBhbmQgc3VidHJhY3QgZnJvbSBfZnJvbSwgYW5kIHN1YnRyYWN0IGZyb20gYWxsb3dlZCBiYWxhbmNlcy4KCQkJYmFsYW5jZXNbX3RvXSA9IFNhZmVNYXRoLmFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOwoJICAgCQliYWxhbmNlc1tfZnJvbV0gPSBTYWZlTWF0aC5zdWIoYmFsYW5jZXNbX2Zyb21dLCBfdmFsdWUpOwoJICAJCWFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gU2FmZU1hdGguc3ViKGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLCBfdmFsdWUpOwoKCSAgCQkvLyBsb2cgZXZlbnQKICAgIAkJZW1pdCBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgCQlyZXR1cm4gdHJ1ZTsKICAgCQl9IAogICAgCWVsc2UgeyAKICAgIAkJcmV0dXJuIGZhbHNlOwogICAgCX0KCX0KCQoJZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkgcHVibGljIHJldHVybnMoYm9vbCl7CgkJaWYoX3ZhbHVlID4gMCl7CgoJCQlhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKCQkJZW1pdCBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKCQkJLy8gbG9nIGV2ZW50CgkJCXJldHVybiB0cnVlOwoJCX0KCQllbHNlIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCX0KCQoJZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyh1aW50KXsKCQlyZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKCX0KfQ=='.
	

]
