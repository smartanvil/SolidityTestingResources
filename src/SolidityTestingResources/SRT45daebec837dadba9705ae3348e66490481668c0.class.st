Class {
	#name : #SRT45daebec837dadba9705ae3348e66490481668c0,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT45daebec837dadba9705ae3348e66490481668c0 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTY7Cgpjb250cmFjdCBTYWZlTWF0aCB7CiAgICAgZnVuY3Rpb24gc2FmZU11bCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgICAgICAgdWludCBjID0gYSAqIGI7CiAgICAgICAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgICAgICAgcmV0dXJuIGM7CiAgICAgfQoKICAgICBmdW5jdGlvbiBzYWZlU3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgICBhc3NlcnQoYiA8PSBhKTsKICAgICAgICAgIHJldHVybiBhIC0gYjsKICAgICB9CgogICAgIGZ1bmN0aW9uIHNhZmVBZGQodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgICAgICAgIHVpbnQgYyA9IGEgKyBiOwogICAgICAgICAgYXNzZXJ0KGM+PWEgJiYgYz49Yik7CiAgICAgICAgICByZXR1cm4gYzsKICAgICB9Cn0KCi8vIEVSQzIwIHN0YW5kYXJkCi8vIFdlIGRvbid0IHVzZSBFUkMyMyBzdGFuZGFyZApjb250cmFjdCBTdGRUb2tlbiBpcyBTYWZlTWF0aCB7Ci8vIEZpZWxkczoKICAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CiAgICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwogICAgIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5ID0gMDsKCi8vIEV2ZW50czoKICAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsKICAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKCi8vIEZ1bmN0aW9uczoKICAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIG9ubHlQYXlsb2FkU2l6ZSgyICogMzIpIHJldHVybnMoYm9vbCl7CiAgICAgICAgICByZXF1aXJlKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IF92YWx1ZSk7CiAgICAgICAgICByZXF1aXJlKGJhbGFuY2VzW190b10gKyBfdmFsdWUgPiBiYWxhbmNlc1tfdG9dKTsKCiAgICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHNhZmVTdWIoYmFsYW5jZXNbbXNnLnNlbmRlcl0sX3ZhbHVlKTsKICAgICAgICAgIGJhbGFuY2VzW190b10gPSBzYWZlQWRkKGJhbGFuY2VzW190b10sX3ZhbHVlKTsKCiAgICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICB9CgogICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMoYm9vbCl7CiAgICAgICAgICByZXF1aXJlKGJhbGFuY2VzW19mcm9tXSA+PSBfdmFsdWUpOwogICAgICAgICAgcmVxdWlyZShhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUpOwogICAgICAgICAgcmVxdWlyZShiYWxhbmNlc1tfdG9dICsgX3ZhbHVlID4gYmFsYW5jZXNbX3RvXSk7CgogICAgICAgICAgYmFsYW5jZXNbX3RvXSA9IHNhZmVBZGQoYmFsYW5jZXNbX3RvXSxfdmFsdWUpOwogICAgICAgICAgYmFsYW5jZXNbX2Zyb21dID0gc2FmZVN1YihiYWxhbmNlc1tfZnJvbV0sX3ZhbHVlKTsKICAgICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gc2FmZVN1YihhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSxfdmFsdWUpOwoKICAgICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICB9CgogICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICAgfQoKICAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICAgICAgICAvLyBUbyBjaGFuZ2UgdGhlIGFwcHJvdmUgYW1vdW50IHlvdSBmaXJzdCBoYXZlIHRvIHJlZHVjZSB0aGUgYWRkcmVzc2VzYAogICAgICAgICAgLy8gIGFsbG93YW5jZSB0byB6ZXJvIGJ5IGNhbGxpbmcgYGFwcHJvdmUoX3NwZW5kZXIsIDApYCBpZiBpdCBpcyBub3QKICAgICAgICAgIC8vICBhbHJlYWR5IDAgdG8gbWl0aWdhdGUgdGhlIHJhY2UgY29uZGl0aW9uIGRlc2NyaWJlZCBoZXJlOgogICAgICAgICAgLy8gIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICAgICAgICByZXF1aXJlKChfdmFsdWUgPT0gMCkgfHwgKGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID09IDApKTsKCiAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgfQoKICAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgIH0KCiAgICAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgX3NpemUpIHsKICAgICAgICAgIHJlcXVpcmUobXNnLmRhdGEubGVuZ3RoID49IF9zaXplICsgNCk7CiAgICAgICAgICBfOwogICAgIH0KfQoKY29udHJhY3QgTU5UUCBpcyBTdGRUb2tlbiB7Ci8vIEZpZWxkczoKICAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiR29sZG1pbnQgTU5UIFByZWxhdW5jaCBUb2tlbiI7CiAgICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiTU5UUCI7CiAgICAgdWludCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKCiAgICAgYWRkcmVzcyBwdWJsaWMgY3JlYXRvciA9IDB4MDsKICAgICBhZGRyZXNzIHB1YmxpYyBpY29Db250cmFjdEFkZHJlc3MgPSAweDA7CiAgICAgYm9vbCBwdWJsaWMgbG9ja1RyYW5zZmVycyA9IGZhbHNlOwoKICAgICAvLyAxMCBtbG4KICAgICB1aW50IHB1YmxpYyBjb25zdGFudCBUT1RBTF9UT0tFTl9TVVBQTFkgPSAxMDAwMDAwMCAqIDEgZXRoZXI7CgovLy8gTW9kaWZpZXJzOgogICAgIG1vZGlmaWVyIG9ubHlDcmVhdG9yKCkgeyAKICAgICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjcmVhdG9yKTsgCiAgICAgICAgICBfOyAKICAgICB9CgogICAgIG1vZGlmaWVyIGJ5SWNvQ29udHJhY3QoKSB7IAogICAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGljb0NvbnRyYWN0QWRkcmVzcyk7IAogICAgICAgICAgXzsgCiAgICAgfQoKICAgICBmdW5jdGlvbiBzZXRDcmVhdG9yKGFkZHJlc3MgX2NyZWF0b3IpIG9ubHlDcmVhdG9yIHsKICAgICAgICAgIGNyZWF0b3IgPSBfY3JlYXRvcjsKICAgICB9CgovLyBTZXR0ZXJzL0dldHRlcnMKICAgICBmdW5jdGlvbiBzZXRJY29Db250cmFjdEFkZHJlc3MoYWRkcmVzcyBfaWNvQ29udHJhY3RBZGRyZXNzKSBvbmx5Q3JlYXRvciB7CiAgICAgICAgICBpY29Db250cmFjdEFkZHJlc3MgPSBfaWNvQ29udHJhY3RBZGRyZXNzOwogICAgIH0KCi8vIEZ1bmN0aW9uczoKICAgICBmdW5jdGlvbiBNTlRQKCkgewogICAgICAgICAgY3JlYXRvciA9IG1zZy5zZW5kZXI7CgogICAgICAgICAgYXNzZXJ0KFRPVEFMX1RPS0VOX1NVUFBMWSA9PSAxMDAwMDAwMCAqIDEgZXRoZXIpOwogICAgIH0KCiAgICAgLy8vIEBkZXYgT3ZlcnJpZGUKICAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zKGJvb2wpewogICAgICAgICAgcmVxdWlyZSghbG9ja1RyYW5zZmVycyk7CiAgICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLF92YWx1ZSk7CiAgICAgfQoKICAgICAvLy8gQGRldiBPdmVycmlkZQogICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zKGJvb2wpewogICAgICAgICAgcmVxdWlyZSghbG9ja1RyYW5zZmVycyk7CiAgICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLF90byxfdmFsdWUpOwogICAgIH0KCiAgICAgZnVuY3Rpb24gaXNzdWVUb2tlbnMoYWRkcmVzcyBfd2hvLCB1aW50IF90b2tlbnMpIGJ5SWNvQ29udHJhY3QgewogICAgICAgICAgcmVxdWlyZSgodG90YWxTdXBwbHkgKyBfdG9rZW5zKSA8PSBUT1RBTF9UT0tFTl9TVVBQTFkpOwoKICAgICAgICAgIGJhbGFuY2VzW193aG9dID0gc2FmZUFkZChiYWxhbmNlc1tfd2hvXSxfdG9rZW5zKTsKICAgICAgICAgIHRvdGFsU3VwcGx5ID0gc2FmZUFkZCh0b3RhbFN1cHBseSxfdG9rZW5zKTsKCiAgICAgICAgICBUcmFuc2ZlcigweDAsIF93aG8sIF90b2tlbnMpOwogICAgIH0KCiAgICAgLy8gRm9yIHJlZnVuZHMgb25seQogICAgIGZ1bmN0aW9uIGJ1cm5Ub2tlbnMoYWRkcmVzcyBfd2hvLCB1aW50IF90b2tlbnMpIGJ5SWNvQ29udHJhY3QgewogICAgICAgICAgYmFsYW5jZXNbX3dob10gPSBzYWZlU3ViKGJhbGFuY2VzW193aG9dLCBfdG9rZW5zKTsKICAgICAgICAgIHRvdGFsU3VwcGx5ID0gc2FmZVN1Yih0b3RhbFN1cHBseSwgX3Rva2Vucyk7CiAgICAgfQoKICAgICBmdW5jdGlvbiBsb2NrVHJhbnNmZXIoYm9vbCBfbG9jaykgYnlJY29Db250cmFjdCB7CiAgICAgICAgICBsb2NrVHJhbnNmZXJzID0gX2xvY2s7CiAgICAgfQoKICAgICAvLyBEbyBub3QgYWxsb3cgdG8gc2VuZCBtb25leSBkaXJlY3RseSB0byB0aGlzIGNvbnRyYWN0CiAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXZlcnQoKTsKICAgICB9Cn0KCi8vIFRoaXMgY29udHJhY3Qgd2lsbCBob2xkIGFsbCB0b2tlbnMgdGhhdCB3ZXJlIHVuc29sZCBkdXJpbmcgSUNPLgovLwovLyBHb2xkbWludCBUZWFtIHNob3VsZCBiZSBhYmxlIHRvIHdpdGhkcmF3IHRoZW0gYW5kIHNlbGwgb25seSBhZnRlciAxIHllYXIgaXMgcGFzc2VkIGFmdGVyIAovLyBJQ08gaXMgZmluaXNoZWQuCmNvbnRyYWN0IEdvbGRtaW50VW5zb2xkIGlzIFNhZmVNYXRoIHsKICAgICBhZGRyZXNzIHB1YmxpYyBjcmVhdG9yOwogICAgIGFkZHJlc3MgcHVibGljIHRlYW1BY2NvdW50QWRkcmVzczsKICAgICBhZGRyZXNzIHB1YmxpYyBpY29Db250cmFjdEFkZHJlc3M7CiAgICAgdWludDY0IHB1YmxpYyBpY29Jc0ZpbmlzaGVkRGF0ZTsKCiAgICAgTU5UUCBwdWJsaWMgbW50VG9rZW47CgogICAgIGZ1bmN0aW9uIEdvbGRtaW50VW5zb2xkKGFkZHJlc3MgX3RlYW1BY2NvdW50QWRkcmVzcyxhZGRyZXNzIF9tbnRUb2tlbkFkZHJlc3MpewogICAgICAgICAgY3JlYXRvciA9IG1zZy5zZW5kZXI7CiAgICAgICAgICB0ZWFtQWNjb3VudEFkZHJlc3MgPSBfdGVhbUFjY291bnRBZGRyZXNzOwoKICAgICAgICAgIG1udFRva2VuID0gTU5UUChfbW50VG9rZW5BZGRyZXNzKTsgICAgICAgICAgCiAgICAgfQoKICAgICBtb2RpZmllciBvbmx5Q3JlYXRvcigpIHsgCiAgICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXI9PWNyZWF0b3IpOyAKICAgICAgICAgIF87IAogICAgIH0KCiAgICAgbW9kaWZpZXIgb25seUljb0NvbnRyYWN0KCkgeyAKICAgICAgICAgIHJlcXVpcmUobXNnLnNlbmRlcj09aWNvQ29udHJhY3RBZGRyZXNzKTsgCiAgICAgICAgICBfOyAKICAgICB9CgovLyBTZXR0ZXJzL0dldHRlcnMKICAgICBmdW5jdGlvbiBzZXRJY29Db250cmFjdEFkZHJlc3MoYWRkcmVzcyBfaWNvQ29udHJhY3RBZGRyZXNzKSBvbmx5Q3JlYXRvciB7CiAgICAgICAgICBpY29Db250cmFjdEFkZHJlc3MgPSBfaWNvQ29udHJhY3RBZGRyZXNzOwogICAgIH0KCiAgICAgZnVuY3Rpb24gZmluaXNoSWNvKCkgcHVibGljIG9ubHlJY29Db250cmFjdCB7CiAgICAgICAgICBpY29Jc0ZpbmlzaGVkRGF0ZSA9IHVpbnQ2NChub3cpOwogICAgIH0KCiAgICAgLy8gY2FuIGJlIGNhbGxlZCBieSBhbnlvbmUuLi4KICAgICBmdW5jdGlvbiB3aXRoZHJhd1Rva2VucygpIHB1YmxpYyB7CiAgICAgICAgICAvLyBDaGVjayBpZiAxIHllYXIgaXMgcGFzc2VkCiAgICAgICAgICB1aW50NjQgb25lWWVhclBhc3NlZCA9IGljb0lzRmluaXNoZWREYXRlICsgMzY1IGRheXM7ICAKICAgICAgICAgIHJlcXVpcmUodWludChub3cpID49IG9uZVllYXJQYXNzZWQpOwoKICAgICAgICAgIC8vIFRyYW5zZmVyIGFsbCB0b2tlbnMgZnJvbSB0aGlzIGNvbnRyYWN0IHRvIHRoZSB0ZWFtQWNjb3VudEFkZHJlc3MKICAgICAgICAgIHVpbnQgdG90YWwgPSBtbnRUb2tlbi5iYWxhbmNlT2YodGhpcyk7CiAgICAgICAgICBtbnRUb2tlbi50cmFuc2Zlcih0ZWFtQWNjb3VudEFkZHJlc3MsdG90YWwpOwogICAgIH0KCiAgICAgLy8gRG8gbm90IGFsbG93IHRvIHNlbmQgbW9uZXkgZGlyZWN0bHkgdG8gdGhpcyBjb250cmFjdAogICAgIGZ1bmN0aW9uKCkgcGF5YWJsZSB7CiAgICAgICAgICByZXZlcnQoKTsKICAgICB9Cn0KCmNvbnRyYWN0IEZvdW5kZXJzVmVzdGluZyBpcyBTYWZlTWF0aCB7CiAgICAgYWRkcmVzcyBwdWJsaWMgY3JlYXRvcjsKICAgICBhZGRyZXNzIHB1YmxpYyB0ZWFtQWNjb3VudEFkZHJlc3M7CiAgICAgdWludDY0IHB1YmxpYyBsYXN0V2l0aGRyYXdUaW1lOwoKICAgICB1aW50IHB1YmxpYyB3aXRoZHJhd3NDb3VudCA9IDA7CiAgICAgdWludCBwdWJsaWMgYW1vdW50VG9TZW5kID0gMDsKCiAgICAgTU5UUCBwdWJsaWMgbW50VG9rZW47CgogICAgIGZ1bmN0aW9uIEZvdW5kZXJzVmVzdGluZyhhZGRyZXNzIF90ZWFtQWNjb3VudEFkZHJlc3MsYWRkcmVzcyBfbW50VG9rZW5BZGRyZXNzKXsKICAgICAgICAgIHRlYW1BY2NvdW50QWRkcmVzcyA9IF90ZWFtQWNjb3VudEFkZHJlc3M7CiAgICAgICAgICBsYXN0V2l0aGRyYXdUaW1lID0gdWludDY0KG5vdyk7CgogICAgICAgICAgbW50VG9rZW4gPSBNTlRQKF9tbnRUb2tlbkFkZHJlc3MpOyAgICAgICAgICAKCiAgICAgICAgICBjcmVhdG9yID0gbXNnLnNlbmRlcjsKICAgICB9CgogICAgIG1vZGlmaWVyIG9ubHlDcmVhdG9yKCkgeyAKICAgICAgICAgIHJlcXVpcmUobXNnLnNlbmRlcj09Y3JlYXRvcik7IAogICAgICAgICAgXzsgCiAgICAgfQoKICAgICBmdW5jdGlvbiB3aXRoZHJhd1Rva2VucygpIG9ubHlDcmVhdG9yIHB1YmxpYyB7CiAgICAgICAgICAvLyAxIC0gd2FpdCBmb3IgdGhlIG5leHQgbW9udGgKICAgICAgICAgIHVpbnQ2NCBvbmVNb250aCA9IGxhc3RXaXRoZHJhd1RpbWUgKyAzMCBkYXlzOyAgCiAgICAgICAgICByZXF1aXJlKHVpbnQobm93KSA+PSBvbmVNb250aCk7CgogICAgICAgICAgLy8gMiAtIGNhbGN1bGF0ZSBhbW91bnQgKG9ubHkgZmlyc3QgdGltZSkKICAgICAgICAgIGlmKHdpdGhkcmF3c0NvdW50PT0wKXsKICAgICAgICAgICAgICAgYW1vdW50VG9TZW5kID0gbW50VG9rZW4uYmFsYW5jZU9mKHRoaXMpIC8gMTA7CiAgICAgICAgICB9CgogICAgICAgICAgcmVxdWlyZShhbW91bnRUb1NlbmQhPTApOwoKICAgICAgICAgIC8vIDMgLSBzZW5kIDEvMTB0aAogICAgICAgICAgdWludCBjdXJyZW50QmFsYW5jZSA9IG1udFRva2VuLmJhbGFuY2VPZih0aGlzKTsKICAgICAgICAgIGlmKGN1cnJlbnRCYWxhbmNlPGFtb3VudFRvU2VuZCl7CiAgICAgICAgICAgICBhbW91bnRUb1NlbmQgPSBjdXJyZW50QmFsYW5jZTsgIAogICAgICAgICAgfQogICAgICAgICAgbW50VG9rZW4udHJhbnNmZXIodGVhbUFjY291bnRBZGRyZXNzLGFtb3VudFRvU2VuZCk7CgogICAgICAgICAgLy8gNCAtIHVwZGF0ZSBjb3VudGVyCiAgICAgICAgICB3aXRoZHJhd3NDb3VudCsrOwogICAgICAgICAgbGFzdFdpdGhkcmF3VGltZSA9IHVpbnQ2NChub3cpOwogICAgIH0KCiAgICAgLy8gRG8gbm90IGFsbG93IHRvIHNlbmQgbW9uZXkgZGlyZWN0bHkgdG8gdGhpcyBjb250cmFjdAogICAgIGZ1bmN0aW9uKCkgcGF5YWJsZSB7CiAgICAgICAgICByZXZlcnQoKTsKICAgICB9Cn0KCi8vIFRoaXMgaXMgdGhlIG1haW4gR29sZG1pbnQgSUNPIHNtYXJ0IGNvbnRyYWN0CmNvbnRyYWN0IEdvbGRtaW50IGlzIFNhZmVNYXRoIHsKLy8gQ29uc3RhbnRzOgogICAgIC8vIFRoZXNlIHZhbHVlcyBhcmUgSEFSRCBDT0RFRCEhIQogICAgIC8vIEZvciBleHRyYSBzZWN1cml0eSB3ZSBzcGxpdCBzaW5nbGUgbXVsdGlzaWcgd2FsbGV0IGludG8gMTAgc2VwYXJhdGUgbXVsdGlzaWcgd2FsbGV0cwogICAgIC8vCiAgICAgLy8gVEhJUyBJUyBBIFJFQUwgSUNPIFdBTExFVFMhISEKICAgICAvLyBQTEVBU0UgRE9VQkxFIENIRUNLIFRIQVQuLi4KICAgICBhZGRyZXNzW10gcHVibGljIG11bHRpc2lncyA9IFsKICAgICAgICAgIDB4Y0VjNDJFMjQ3MDk3QzI3NkFkM0Q3Y0ZkMjcwYURCZDU2MmRBNWM2MSwKICAgICAgICAgIDB4MzczQzQ2YzU0NDY2MkI4QzVENTVjMjRDZjRGOWE1MDIwMTYzZUMyZiwKICAgICAgICAgIDB4NjcyQ0Y4MjkyNzIzMzlBNmM4YzExYjE0QWNjNUY5ZDA3YkFGQUM3YywKICAgICAgICAgIDB4Y2UwZTE5ODFBMTlhNTdhRTgwOGE3NTc1YTY3MzhlNDUyN2ZCOTExOCwKICAgICAgICAgIDB4OTNBYTc2Y2RiMTdFZUE4MGU0RGU5ODMxMDhlZjU3NUQ4ZmM4ZjEyYiwKICAgICAgICAgIDB4MjBhZTMzMjlDZDFlMzVGRWZGNzExNUI0NjIxOGM5RDA1NmQ0MzBGZCwKICAgICAgICAgIDB4ZTlmQzFBNTdhNWRDMUNhQTNERTIyQTk0MEU5RjA5ZTY0MDYxNWY3RSwKICAgICAgICAgIDB4RDM2MDQzMzk1MERFOUY2RkEwZTkzQzI5NDI1ODQ1RWVENkJGQTBkMCwKICAgICAgICAgIDB4RjBEZTk3RUFmZjVENmM5OThjODBlMDc3NDZjODFhMzM2ZTFCQmQ0MywKICAgICAgICAgIDB4ODBiMzY1ZGExQzE4ZjRhYTFlY0ZhMGRGQTA3RWQ0NDE3QjA1Q2M2OQogICAgIF07CgogICAgIC8vIFdlIGNvdW50IEVUSCBpbnZlc3RlZCBieSBwZXJzb24sIGZvciByZWZ1bmRzIChzZWUgYmVsb3cpCiAgICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIGV0aEludmVzdGVkQnk7CiAgICAgdWludCBjb2xsZWN0ZWRXZWkgPSAwOwoKICAgICAvLyBUaGVzZSBjYW4gYmUgY2hhbmdlZCBiZWZvcmUgSUNPIHN0YXJ0cyAoJDdVU0QvTU5UUCkKICAgICB1aW50IGNvbnN0YW50IFNURF9QUklDRV9VU0RfUEVSXzEwMDBfVE9LRU5TID0gNzAwMDsKCiAgICAgLy8gVGhlIFVTRC9FVEggZXhjaGFuZ2UgcmF0ZSBtYXkgYmUgY2hhbmdlZCBldmVyeSBob3VyIGFuZCBjYW4gdmFyeSBmcm9tICQxMDAgdG8gJDcwMCBkZXBlbmRpbmcgb24gdGhlIG1hcmtldC4gVGhlIGV4Y2hhbmdlIHJhdGUgaXMgcmV0cmlldmVkIGZyb20gY29pbm1hcmtldGNhcC5jb20gc2l0ZSBhbmQgaXMgcm91bmRlZCB0byAkMSBkb2xsYXIuIEZvciBleGFtcGxlIGlmIGN1cnJlbnQgbWFya2V0Y2FwIHByaWNlIGlzICQzMDYuMTIzIHBlciBFVEgsIHRoZSBwcmljZSBpcyBzZXQgYXMgJDMwNiB0byB0aGUgY29udHJhY3QuCiAgICAgdWludCBwdWJsaWMgdXNkUGVyRXRoQ29pbm1hcmtldGNhcFJhdGUgPSAzMDA7CiAgICAgdWludDY0IHB1YmxpYyBsYXN0VXNkUGVyRXRoQ2hhbmdlRGF0ZSA9IDA7CgogICAgIC8vIFByaWNlIGNoYW5nZXMgZnJvbSBibG9jayB0byBibG9jawogICAgIHVpbnQgY29uc3RhbnQgU0lOR0xFX0JMT0NLX0xFTiA9IDcwMDAwMDsKICAgICAvLyAxIDAwMCAwMDAgdG9rZW5zCiAgICAgdWludCBwdWJsaWMgY29uc3RhbnQgQk9OVVNfUkVXQVJEID0gMTAwMDAwMCAqIDEgZXRoZXI7CiAgICAgLy8gMiAwMDAgMDAwIHRva2VucwogICAgIHVpbnQgcHVibGljIGNvbnN0YW50IEZPVU5ERVJTX1JFV0FSRCA9IDIwMDAwMDAgKiAxIGV0aGVyOwogICAgIC8vIDcgMDAwIDAwMCBpcyBzb2xkIGR1cmluZyB0aGUgSUNPCiAgICAgdWludCBwdWJsaWMgY29uc3RhbnQgSUNPX1RPS0VOX1NVUFBMWV9MSU1JVCA9IDcwMDAwMDAgKiAxIGV0aGVyOwogICAgIC8vIDE1MCAwMDAgdG9rZW5zIHNvZnQgY2FwIChvdGhlcndpc2UgLSByZWZ1bmQpCiAgICAgdWludCBwdWJsaWMgY29uc3RhbnQgSUNPX1RPS0VOX1NPRlRfQ0FQID0gMTUwMDAwICogMSBldGhlcjsKCiAgICAgLy8gMyAwMDAgMDAwIGNhbiBiZSBpc3N1ZWQgZnJvbSBvdGhlciBjdXJyZW5jaWVzCiAgICAgdWludCBwdWJsaWMgY29uc3RhbnQgTUFYX0lTU1VFRF9GUk9NX09USEVSX0NVUlJFTkNJRVMgPSAzMDAwMDAwICogMSBldGhlcjsKICAgICAvLyAzMCAwMDAgTU5UUCB0b2tlbnMgcGVyIG9uZSBjYWxsIG9ubHkKICAgICB1aW50IHB1YmxpYyBjb25zdGFudCBNQVhfU0lOR0xFX0lTU1VFRF9GUk9NX09USEVSX0NVUlJFTkNJRVMgPSAzMDAwMCAqIDEgZXRoZXI7CiAgICAgdWludCBwdWJsaWMgaXNzdWVkRnJvbU90aGVyQ3VycmVuY2llcyA9IDA7CgovLyBGaWVsZHM6CiAgICAgYWRkcmVzcyBwdWJsaWMgY3JlYXRvciA9IDB4MDsgICAgICAgICAgICAgICAgLy8gY2FuIG5vdCBiZSBjaGFuZ2VkIGFmdGVyIGRlcGxveQogICAgIGFkZHJlc3MgcHVibGljIGV0aFJhdGVDaGFuZ2VyID0gMHgwOyAgICAgICAgIC8vIGNhbiBub3QgYmUgY2hhbmdlZCBhZnRlciBkZXBsb3kKICAgICBhZGRyZXNzIHB1YmxpYyB0b2tlbk1hbmFnZXIgPSAweDA7ICAgICAgICAgICAvLyBjYW4gYmUgY2hhbmdlZCBieSB0b2tlbiBtYW5hZ2VyIG9ubHkKICAgICBhZGRyZXNzIHB1YmxpYyBvdGhlckN1cnJlbmNpZXNDaGVja2VyID0gMHgwOyAvLyBjYW4gbm90IGJlIGNoYW5nZWQgYWZ0ZXIgZGVwbG95CgogICAgIHVpbnQ2NCBwdWJsaWMgaWNvU3RhcnRlZFRpbWUgPSAwOwoKICAgICBNTlRQIHB1YmxpYyBtbnRUb2tlbjsgCgogICAgIEdvbGRtaW50VW5zb2xkIHB1YmxpYyB1bnNvbGRDb250cmFjdDsKCiAgICAgLy8gVG90YWwgYW1vdW50IG9mIHRva2VucyBzb2xkIGR1cmluZyBJQ08KICAgICB1aW50IHB1YmxpYyBpY29Ub2tlbnNTb2xkID0gMDsKICAgICAvLyBUb3RhbCBhbW91bnQgb2YgdG9rZW5zIHNlbnQgdG8gR29sZG1pbnRVbnNvbGQgY29udHJhY3QgYWZ0ZXIgSUNPIGlzIGZpbmlzaGVkCiAgICAgdWludCBwdWJsaWMgaWNvVG9rZW5zVW5zb2xkID0gMDsKICAgICAvLyBUb3RhbCBudW1iZXIgb2YgdG9rZW5zIHRoYXQgd2VyZSBpc3N1ZWQgYnkgYSBzY3JpcHRzCiAgICAgdWludCBwdWJsaWMgaXNzdWVkRXh0ZXJuYWxseVRva2VucyA9IDA7CiAgICAgLy8gVGhpcyBpcyB3aGVyZSBGT1VOREVSU19SRVdBUkQgd2lsbCBiZSBhbGxvY2F0ZWQKICAgICBhZGRyZXNzIHB1YmxpYyBmb3VuZGVyc1Jld2FyZHNBY2NvdW50ID0gMHgwOwoKICAgICBlbnVtIFN0YXRlewogICAgICAgICAgSW5pdCwKCiAgICAgICAgICBJQ09SdW5uaW5nLAogICAgICAgICAgSUNPUGF1c2VkLAoKICAgICAgICAgIC8vIENvbGxlY3RlZCBFVEggaXMgdHJhbnNmZXJyZWQgdG8gbXVsdGlzaWdzLgogICAgICAgICAgLy8gVW5zb2xkIHRva2VucyB0cmFuc2ZlcnJlZCB0byBHb2xkbWludFVuc29sZCBjb250cmFjdC4KICAgICAgICAgIElDT0ZpbmlzaGVkLAoKICAgICAgICAgIC8vIFdlIHN0YXJ0IHRvIHJlZnVuZCBpZiBTb2Z0IENhcCBpcyBub3QgcmVhY2hlZC4KICAgICAgICAgIC8vIFRoZW4gZWFjaCB0b2tlbiBob2xkZXIgc2hvdWxkIHJlcXVlc3QgYSByZWZ1bmQgcGVyc29uYWxseSBmcm9tIGhpcwogICAgICAgICAgLy8gcGVyc29uYWwgd2FsbGV0LgogICAgICAgICAgLy8KICAgICAgICAgIC8vIFdlIHdpbGwgcmV0dXJuIEVUSHMgb25seSB0byB0aGUgb3JpZ2luYWwgYWRkcmVzcy4gSWYgeW91ciBhZGRyZXNzIGlzIGNoYW5nZWQKICAgICAgICAgIC8vIG9yIHlvdSBoYXZlIGxvc3QgeW91ciBrZXlzIC0+IHlvdSB3aWxsIG5vdCBiZSBhYmxlIHRvIGdldCBhIHJlZnVuZC4KICAgICAgICAgIC8vIAogICAgICAgICAgLy8gVGhlcmUgaXMgbm8gYW55IHBvc3NpYmlsaXR5IHRvIHRyYW5zZmVyIHRva2VucwogICAgICAgICAgLy8gVGhlcmUgaXMgbm8gYW55IHBvc3NpYmlsaXR5IHRvIG1vdmUgYmFjawogICAgICAgICAgUmVmdW5kaW5nLAoKICAgICAgICAgIC8vIEluIHRoaXMgc3RhdGUgd2UgbG9jayBhbGwgTU5UIHRva2VucyBmb3JldmVyLgogICAgICAgICAgLy8gV2UgYXJlIGdvaW5nIHRvIG1pZ3JhdGUgTU5UUCAtPiBNTlQgdG9rZW5zIGR1cmluZyB0aGlzIHN0YWdlLiAKICAgICAgICAgIC8vIAogICAgICAgICAgLy8gVGhlcmUgaXMgbm8gYW55IHBvc3NpYmlsaXR5IHRvIHRyYW5zZmVyIHRva2VucwogICAgICAgICAgLy8gVGhlcmUgaXMgbm8gYW55IHBvc3NpYmlsaXR5IHRvIG1vdmUgYmFjawogICAgICAgICAgTWlncmF0aW5nCiAgICAgfQogICAgIFN0YXRlIHB1YmxpYyBjdXJyZW50U3RhdGUgPSBTdGF0ZS5Jbml0OwoKLy8gTW9kaWZpZXJzOgogICAgIG1vZGlmaWVyIG9ubHlDcmVhdG9yKCkgeyAKICAgICAgICAgIHJlcXVpcmUobXNnLnNlbmRlcj09Y3JlYXRvcik7IAogICAgICAgICAgXzsgCiAgICAgfQogICAgIG1vZGlmaWVyIG9ubHlUb2tlbk1hbmFnZXIoKSB7IAogICAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyPT10b2tlbk1hbmFnZXIpOyAKICAgICAgICAgIF87IAogICAgIH0KICAgICBtb2RpZmllciBvbmx5T3RoZXJDdXJyZW5jaWVzQ2hlY2tlcigpIHsgCiAgICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXI9PW90aGVyQ3VycmVuY2llc0NoZWNrZXIpOyAKICAgICAgICAgIF87IAogICAgIH0KICAgICBtb2RpZmllciBvbmx5RXRoU2V0dGVyKCkgeyAKICAgICAgICAgIHJlcXVpcmUobXNnLnNlbmRlcj09ZXRoUmF0ZUNoYW5nZXIpOyAKICAgICAgICAgIF87IAogICAgIH0KCiAgICAgbW9kaWZpZXIgb25seUluU3RhdGUoU3RhdGUgc3RhdGUpeyAKICAgICAgICAgIHJlcXVpcmUoc3RhdGU9PWN1cnJlbnRTdGF0ZSk7IAogICAgICAgICAgXzsgCiAgICAgfQoKLy8gRXZlbnRzOgogICAgIGV2ZW50IExvZ1N0YXRlU3dpdGNoKFN0YXRlIG5ld1N0YXRlKTsKICAgICBldmVudCBMb2dCdXkoYWRkcmVzcyBpbmRleGVkIG93bmVyLCB1aW50IHZhbHVlKTsKICAgICBldmVudCBMb2dCdXJuKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgdWludCB2YWx1ZSk7CiAgICAgCi8vIEZ1bmN0aW9uczoKICAgICAvLy8gQGRldiBDb25zdHJ1Y3RvcgogICAgIGZ1bmN0aW9uIEdvbGRtaW50KAogICAgICAgICAgYWRkcmVzcyBfdG9rZW5NYW5hZ2VyLAogICAgICAgICAgYWRkcmVzcyBfZXRoUmF0ZUNoYW5nZXIsCiAgICAgICAgICBhZGRyZXNzIF9vdGhlckN1cnJlbmNpZXNDaGVja2VyLAoKICAgICAgICAgIGFkZHJlc3MgX21udFRva2VuQWRkcmVzcywKICAgICAgICAgIGFkZHJlc3MgX3Vuc29sZENvbnRyYWN0QWRkcmVzcywKICAgICAgICAgIGFkZHJlc3MgX2ZvdW5kZXJzVmVzdGluZ0FkZHJlc3MpCiAgICAgewogICAgICAgICAgY3JlYXRvciA9IG1zZy5zZW5kZXI7CgogICAgICAgICAgdG9rZW5NYW5hZ2VyID0gX3Rva2VuTWFuYWdlcjsKICAgICAgICAgIGV0aFJhdGVDaGFuZ2VyID0gX2V0aFJhdGVDaGFuZ2VyOwogICAgICAgICAgbGFzdFVzZFBlckV0aENoYW5nZURhdGUgPSB1aW50NjQobm93KTsKCiAgICAgICAgICBvdGhlckN1cnJlbmNpZXNDaGVja2VyID0gX290aGVyQ3VycmVuY2llc0NoZWNrZXI7IAoKICAgICAgICAgIG1udFRva2VuID0gTU5UUChfbW50VG9rZW5BZGRyZXNzKTsKICAgICAgICAgIHVuc29sZENvbnRyYWN0ID0gR29sZG1pbnRVbnNvbGQoX3Vuc29sZENvbnRyYWN0QWRkcmVzcyk7CgogICAgICAgICAgLy8gc2xpZ2h0IHJlbmFtZQogICAgICAgICAgZm91bmRlcnNSZXdhcmRzQWNjb3VudCA9IF9mb3VuZGVyc1Zlc3RpbmdBZGRyZXNzOwoKICAgICAgICAgIGFzc2VydChtdWx0aXNpZ3MubGVuZ3RoPT0xMCk7CiAgICAgfQoKICAgICBmdW5jdGlvbiBzdGFydElDTygpIHB1YmxpYyBvbmx5Q3JlYXRvciBvbmx5SW5TdGF0ZShTdGF0ZS5Jbml0KSB7CiAgICAgICAgICBzZXRTdGF0ZShTdGF0ZS5JQ09SdW5uaW5nKTsKICAgICAgICAgIGljb1N0YXJ0ZWRUaW1lID0gdWludDY0KG5vdyk7CiAgICAgICAgICBtbnRUb2tlbi5sb2NrVHJhbnNmZXIodHJ1ZSk7CiAgICAgICAgICBtbnRUb2tlbi5pc3N1ZVRva2Vucyhmb3VuZGVyc1Jld2FyZHNBY2NvdW50LCBGT1VOREVSU19SRVdBUkQpOwogICAgIH0KCiAgICAgZnVuY3Rpb24gcGF1c2VJQ08oKSBwdWJsaWMgb25seUNyZWF0b3Igb25seUluU3RhdGUoU3RhdGUuSUNPUnVubmluZykgewogICAgICAgICAgc2V0U3RhdGUoU3RhdGUuSUNPUGF1c2VkKTsKICAgICB9CgogICAgIGZ1bmN0aW9uIHJlc3VtZUlDTygpIHB1YmxpYyBvbmx5Q3JlYXRvciBvbmx5SW5TdGF0ZShTdGF0ZS5JQ09QYXVzZWQpIHsKICAgICAgICAgIHNldFN0YXRlKFN0YXRlLklDT1J1bm5pbmcpOwogICAgIH0KCiAgICAgZnVuY3Rpb24gc3RhcnRSZWZ1bmRpbmcoKSBwdWJsaWMgb25seUNyZWF0b3Igb25seUluU3RhdGUoU3RhdGUuSUNPUnVubmluZykgewogICAgICAgICAgLy8gb25seSBzd2l0Y2ggdG8gdGhpcyBzdGF0ZSBpZiBsZXNzIHRoYW4gSUNPX1RPS0VOX1NPRlRfQ0FQIHNvbGQKICAgICAgICAgIHJlcXVpcmUoaWNvVG9rZW5zU29sZCA8IElDT19UT0tFTl9TT0ZUX0NBUCk7CiAgICAgICAgICBzZXRTdGF0ZShTdGF0ZS5SZWZ1bmRpbmcpOwoKICAgICAgICAgIC8vIGluIHRoaXMgc3RhdGUgdG9rZW5zIHN0aWxsIHNob3VsZG4ndCBiZSB0cmFuc2ZlcnJlZAogICAgICAgICAgYXNzZXJ0KG1udFRva2VuLmxvY2tUcmFuc2ZlcnMoKSk7CiAgICAgfQoKICAgICBmdW5jdGlvbiBzdGFydE1pZ3JhdGlvbigpIHB1YmxpYyBvbmx5Q3JlYXRvciBvbmx5SW5TdGF0ZShTdGF0ZS5JQ09GaW5pc2hlZCkgewogICAgICAgICAgLy8gdGhlcmUgaXMgbm8gd2F5IGJhY2suLi4KICAgICAgICAgIHNldFN0YXRlKFN0YXRlLk1pZ3JhdGluZyk7CgogICAgICAgICAgLy8gZGlzYWJsZSB0b2tlbiB0cmFuc2ZlcnMKICAgICAgICAgIG1udFRva2VuLmxvY2tUcmFuc2Zlcih0cnVlKTsKICAgICB9CgogICAgIC8vLyBAZGV2IFRoaXMgZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCBieSBjcmVhdG9yIGF0IGFueSB0aW1lLAogICAgIC8vLyBvciBieSBhbnlvbmUgaWYgSUNPIGhhcyByZWFsbHkgZmluaXNoZWQuCiAgICAgZnVuY3Rpb24gZmluaXNoSUNPKCkgcHVibGljIG9ubHlJblN0YXRlKFN0YXRlLklDT1J1bm5pbmcpIHsKICAgICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjcmVhdG9yIHx8IGlzSWNvRmluaXNoZWQoKSk7CiAgICAgICAgICBzZXRTdGF0ZShTdGF0ZS5JQ09GaW5pc2hlZCk7CgogICAgICAgICAgLy8gMSAtIGxvY2sgYWxsIHRyYW5zZmVycwogICAgICAgICAgbW50VG9rZW4ubG9ja1RyYW5zZmVyKGZhbHNlKTsKCiAgICAgICAgICAvLyAyIC0gbW92ZSBhbGwgdW5zb2xkIHRva2VucyB0byB1bnNvbGRUb2tlbnMgY29udHJhY3QKICAgICAgICAgIGljb1Rva2Vuc1Vuc29sZCA9IHNhZmVTdWIoSUNPX1RPS0VOX1NVUFBMWV9MSU1JVCxpY29Ub2tlbnNTb2xkKTsKICAgICAgICAgIGlmKGljb1Rva2Vuc1Vuc29sZD4wKXsKICAgICAgICAgICAgICAgbW50VG9rZW4uaXNzdWVUb2tlbnModW5zb2xkQ29udHJhY3QsaWNvVG9rZW5zVW5zb2xkKTsKICAgICAgICAgICAgICAgdW5zb2xkQ29udHJhY3QuZmluaXNoSWNvKCk7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gMyAtIHNlbmQgYWxsIEVUSCB0byBtdWx0aXNpZ3MKICAgICAgICAgIC8vIHdlIGhhdmUgTiBzZXBhcmF0ZSBtdWx0aXNpZ3MgZm9yIGV4dHJhIHNlY3VyaXR5CiAgICAgICAgICB1aW50IHNlbmRUaGlzQW1vdW50ID0gKHRoaXMuYmFsYW5jZSAvIDEwKTsKCiAgICAgICAgICAvLyAzLjEgLSBzZW5kIHRvIDkgbXVsdGlzaWdzCiAgICAgICAgICBmb3IodWludCBpPTA7IGk8OTsgKytpKXsKICAgICAgICAgICAgICAgYWRkcmVzcyBtcyA9IG11bHRpc2lnc1tpXTsKCiAgICAgICAgICAgICAgIGlmKHRoaXMuYmFsYW5jZT49c2VuZFRoaXNBbW91bnQpewogICAgICAgICAgICAgICAgICAgIG1zLnRyYW5zZmVyKHNlbmRUaGlzQW1vdW50KTsKICAgICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIC8vIDMuMiAtIHNlbmQgZXZlcnl0aGluZyBsZWZ0IHRvIDEwdGggbXVsdGlzaWcKICAgICAgICAgIGlmKDAhPXRoaXMuYmFsYW5jZSl7CiAgICAgICAgICAgICAgIGFkZHJlc3MgbGFzdE1zID0gbXVsdGlzaWdzWzldOwogICAgICAgICAgICAgICBsYXN0TXMudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgICAgICAgIH0KICAgICB9CgogICAgIGZ1bmN0aW9uIHNldFN0YXRlKFN0YXRlIF9zKSBpbnRlcm5hbCB7CiAgICAgICAgICBjdXJyZW50U3RhdGUgPSBfczsKICAgICAgICAgIExvZ1N0YXRlU3dpdGNoKF9zKTsKICAgICB9CgovLyBBY2Nlc3MgbWV0aG9kczoKICAgICBmdW5jdGlvbiBzZXRUb2tlbk1hbmFnZXIoYWRkcmVzcyBfbmV3KSBwdWJsaWMgb25seVRva2VuTWFuYWdlciB7CiAgICAgICAgICB0b2tlbk1hbmFnZXIgPSBfbmV3OwogICAgIH0KCiAgICAgLy8gVE9ETzogc3RlYWxpbmcgY3JlYXRvcidzIGtleSBtZWFucyBzdGVhbGluZyBvdGhlckN1cnJlbmNpZXNDaGVja2VyIGtleSB0b28hCiAgICAgLyoKICAgICBmdW5jdGlvbiBzZXRPdGhlckN1cnJlbmNpZXNDaGVja2VyKGFkZHJlc3MgX25ldykgcHVibGljIG9ubHlDcmVhdG9yIHsKICAgICAgICAgIG90aGVyQ3VycmVuY2llc0NoZWNrZXIgPSBfbmV3OwogICAgIH0KICAgICAqLwoKICAgICAvLyBUaGVzZSBhcmUgdXNlZCBieSBmcm9udGVuZCBzbyB3ZSBjYW4gbm90IHJlbW92ZSB0aGVtCiAgICAgZnVuY3Rpb24gZ2V0VG9rZW5zSWNvU29sZCgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50KXsgICAgICAgICAgCiAgICAgICAgICByZXR1cm4gaWNvVG9rZW5zU29sZDsgICAgICAgCiAgICAgfSAgICAgIAogICAgIAogICAgIGZ1bmN0aW9uIGdldFRvdGFsSWNvVG9rZW5zKCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQpeyAgICAgICAgICAKICAgICAgICAgIHJldHVybiBJQ09fVE9LRU5fU1VQUExZX0xJTUlUOyAgICAgICAgIAogICAgIH0gICAgICAgCiAgICAgCiAgICAgZnVuY3Rpb24gZ2V0TW50VG9rZW5CYWxhbmNlKGFkZHJlc3MgX29mKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludCl7ICAgICAgICAgCiAgICAgICAgICByZXR1cm4gbW50VG9rZW4uYmFsYW5jZU9mKF9vZik7ICAgICAgICAgCiAgICAgfSAgICAgICAgCgogICAgIGZ1bmN0aW9uIGdldEJsb2NrTGVuZ3RoKCljb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludCl7ICAgICAgICAgIAogICAgICAgICAgcmV0dXJuIFNJTkdMRV9CTE9DS19MRU47ICAgICAgCiAgICAgfQoKICAgICBmdW5jdGlvbiBnZXRDdXJyZW50UHJpY2UoKWNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50KXsKICAgICAgICAgIHJldHVybiBnZXRNbnRUb2tlbnNQZXJFdGgoaWNvVG9rZW5zU29sZCk7CiAgICAgfQoKICAgICBmdW5jdGlvbiBnZXRUb3RhbENvbGxlY3RlZFdlaSgpY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQpewogICAgICAgICAgcmV0dXJuIGNvbGxlY3RlZFdlaTsKICAgICB9CgovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgIGZ1bmN0aW9uIGlzSWNvRmluaXNoZWQoKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgICByZXR1cm4gKGljb1N0YXJ0ZWRUaW1lID4gMCkKICAgICAgICAgICAgJiYgKG5vdyA+IChpY29TdGFydGVkVGltZSArIDMwIGRheXMpIHx8IChpY29Ub2tlbnNTb2xkID49IElDT19UT0tFTl9TVVBQTFlfTElNSVQpKTsKICAgICB9CgogICAgIGZ1bmN0aW9uIGdldE1udFRva2Vuc1BlckV0aCh1aW50IF90b2tlbnNTb2xkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCl7CiAgICAgICAgICAvLyAxMCBidWNrZXRzCiAgICAgICAgICB1aW50IHByaWNlSW5kZXggPSAoX3Rva2Vuc1NvbGQgLyAxIGV0aGVyKSAvIFNJTkdMRV9CTE9DS19MRU47CiAgICAgICAgICBhc3NlcnQocHJpY2VJbmRleD49MCAmJiAocHJpY2VJbmRleDw9OSkpOwogICAgICAgICAgCiAgICAgICAgICB1aW50OFsxMF0gbWVtb3J5IGRpc2NvdW50UGVyY2VudHMgPSBbMjAsMTUsMTAsOCw2LDQsMiwwLDAsMF07CgogICAgICAgICAgLy8gV2UgaGF2ZSB0byBtdWx0aXBseSBieSAnMSBldGhlcicgdG8gYXZvaWQgZmxvYXQgdHJ1bmNhdGlvbnMKICAgICAgICAgIC8vIEV4YW1wbGU6ICgkNzAwMCAqIDEwMCkgLyAxMjAgPSAkNTgzMy4zMzMzMwogICAgICAgICAgdWludCBwcmljZVBlcjEwMDB0b2tlbnNVc2QgPSAKICAgICAgICAgICAgICAgKChTVERfUFJJQ0VfVVNEX1BFUl8xMDAwX1RPS0VOUyAqIDEwMCkgKiAxIGV0aGVyKSAvICgxMDAgKyBkaXNjb3VudFBlcmNlbnRzW3ByaWNlSW5kZXhdKTsKCiAgICAgICAgICAvLyBDb3JyZWN0OiAzMDAwMDAgLyA1ODMzLjMzMzMzMzMzID0gNTEuNDI4NTcxNDIKICAgICAgICAgIC8vIFdlIGhhdmUgdG8gbXVsdGlwbHkgYnkgJzEgZXRoZXInIHRvIGF2b2lkIGZsb2F0IHRydW5jYXRpb25zCiAgICAgICAgICB1aW50IG1udFBlckV0aCA9ICh1c2RQZXJFdGhDb2lubWFya2V0Y2FwUmF0ZSAqIDEwMDAgKiAxIGV0aGVyICogMSBldGhlcikgLyBwcmljZVBlcjEwMDB0b2tlbnNVc2Q7CiAgICAgICAgICByZXR1cm4gbW50UGVyRXRoOwogICAgIH0KCiAgICAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgX2J1eWVyKSBwdWJsaWMgcGF5YWJsZSBvbmx5SW5TdGF0ZShTdGF0ZS5JQ09SdW5uaW5nKSB7CiAgICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSE9MCk7CgogICAgICAgICAgLy8gVGhlIHByaWNlIGlzIHNlbGVjdGVkIGJhc2VkIG9uIGN1cnJlbnQgc29sZCB0b2tlbnMuCiAgICAgICAgICAvLyBQcmljZSBjYW4gJ292ZXJsYXAnLiBGb3IgZXhhbXBsZToKICAgICAgICAgIC8vICAgMS4gaWYgY3VycmVudGx5IHdlIHNvbGQgNjk5OTUwIHRva2VucyAodGhlIHByaWNlIGlzIDEwJSBkaXNjb3VudCkKICAgICAgICAgIC8vICAgMi4gYnV5ZXIgYnV5cyAxMDAwIHRva2VucwogICAgICAgICAgLy8gICAzLiB0aGUgcHJpY2Ugb2YgYWxsIDEwMDAgdG9rZW5zIHdvdWxkIGJlIHdpdGggMTAlIGRpc2NvdW50ISEhCiAgICAgICAgICB1aW50IG5ld1Rva2VucyA9IChtc2cudmFsdWUgKiBnZXRNbnRUb2tlbnNQZXJFdGgoaWNvVG9rZW5zU29sZCkpIC8gMSBldGhlcjsKCiAgICAgICAgICBpc3N1ZVRva2Vuc0ludGVybmFsKF9idXllcixuZXdUb2tlbnMpOwoKICAgICAgICAgIC8vIFVwZGF0ZSB0aGlzIG9ubHkgd2hlbiBidXlpbmcgZnJvbSBFVEgKICAgICAgICAgIGV0aEludmVzdGVkQnlbbXNnLnNlbmRlcl0gPSBzYWZlQWRkKGV0aEludmVzdGVkQnlbbXNnLnNlbmRlcl0sIG1zZy52YWx1ZSk7CgogICAgICAgICAgLy8gVGhpcyBpcyB0b3RhbCBjb2xsZWN0ZWQgRVRICiAgICAgICAgICBjb2xsZWN0ZWRXZWkgPSBzYWZlQWRkKGNvbGxlY3RlZFdlaSwgbXNnLnZhbHVlKTsKICAgICB9CgogICAgIC8vLyBAZGV2IFRoaXMgaXMgY2FsbGVkIGJ5IG90aGVyIGN1cnJlbmN5IHByb2Nlc3NvcnMgdG8gaXNzdWUgbmV3IHRva2VucyAKICAgICBmdW5jdGlvbiBpc3N1ZVRva2Vuc0Zyb21PdGhlckN1cnJlbmN5KGFkZHJlc3MgX3RvLCB1aW50IF93ZWlDb3VudCkgb25seUluU3RhdGUoU3RhdGUuSUNPUnVubmluZykgcHVibGljIG9ubHlPdGhlckN1cnJlbmNpZXNDaGVja2VyIHsKICAgICAgICAgIHJlcXVpcmUoX3dlaUNvdW50IT0wKTsKCiAgICAgICAgICB1aW50IG5ld1Rva2VucyA9IChfd2VpQ291bnQgKiBnZXRNbnRUb2tlbnNQZXJFdGgoaWNvVG9rZW5zU29sZCkpIC8gMSBldGhlcjsKICAgICAgICAgIAogICAgICAgICAgcmVxdWlyZShuZXdUb2tlbnM8PU1BWF9TSU5HTEVfSVNTVUVEX0ZST01fT1RIRVJfQ1VSUkVOQ0lFUyk7CiAgICAgICAgICByZXF1aXJlKChpc3N1ZWRGcm9tT3RoZXJDdXJyZW5jaWVzICsgbmV3VG9rZW5zKTw9TUFYX0lTU1VFRF9GUk9NX09USEVSX0NVUlJFTkNJRVMpOwoKICAgICAgICAgIGlzc3VlVG9rZW5zSW50ZXJuYWwoX3RvLG5ld1Rva2Vucyk7CgogICAgICAgICAgaXNzdWVkRnJvbU90aGVyQ3VycmVuY2llcyA9IGlzc3VlZEZyb21PdGhlckN1cnJlbmNpZXMgKyBuZXdUb2tlbnM7CiAgICAgfQoKICAgICAvLy8gQGRldiBUaGlzIGNhbiBiZSBjYWxsZWQgdG8gbWFudWFsbHkgaXNzdWUgbmV3IHRva2VucyAKICAgICAvLy8gZnJvbSB0aGUgYm9udXMgcmV3YXJkCiAgICAgZnVuY3Rpb24gaXNzdWVUb2tlbnNFeHRlcm5hbChhZGRyZXNzIF90bywgdWludCBfdG9rZW5zKSBwdWJsaWMgb25seVRva2VuTWFuYWdlciB7CiAgICAgICAgICAvLyBpbiAyIHN0YXRlcwogICAgICAgICAgcmVxdWlyZSgoU3RhdGUuSUNPRmluaXNoZWQ9PWN1cnJlbnRTdGF0ZSkgfHwgKFN0YXRlLklDT1J1bm5pbmc9PWN1cnJlbnRTdGF0ZSkpOwogICAgICAgICAgLy8gY2FuIG5vdCBpc3N1ZSBtb3JlIHRoYW4gQk9OVVNfUkVXQVJECiAgICAgICAgICByZXF1aXJlKChpc3N1ZWRFeHRlcm5hbGx5VG9rZW5zICsgX3Rva2Vucyk8PUJPTlVTX1JFV0FSRCk7CgogICAgICAgICAgbW50VG9rZW4uaXNzdWVUb2tlbnMoX3RvLF90b2tlbnMpOwoKICAgICAgICAgIGlzc3VlZEV4dGVybmFsbHlUb2tlbnMgPSBpc3N1ZWRFeHRlcm5hbGx5VG9rZW5zICsgX3Rva2VuczsKICAgICB9CgogICAgIGZ1bmN0aW9uIGlzc3VlVG9rZW5zSW50ZXJuYWwoYWRkcmVzcyBfdG8sIHVpbnQgX3Rva2VucykgaW50ZXJuYWwgewogICAgICAgICAgcmVxdWlyZSgoaWNvVG9rZW5zU29sZCArIF90b2tlbnMpPD1JQ09fVE9LRU5fU1VQUExZX0xJTUlUKTsKCiAgICAgICAgICBtbnRUb2tlbi5pc3N1ZVRva2VucyhfdG8sX3Rva2Vucyk7IAogICAgICAgICAgaWNvVG9rZW5zU29sZCs9X3Rva2VuczsKCiAgICAgICAgICBMb2dCdXkoX3RvLF90b2tlbnMpOwogICAgIH0KCiAgICAgLy8gYW55b25lIGNhbiBjYWxsIHRoaXMgYW5kIGdldCBoaXMgbW9uZXkgYmFjawogICAgIGZ1bmN0aW9uIGdldE15UmVmdW5kKCkgcHVibGljIG9ubHlJblN0YXRlKFN0YXRlLlJlZnVuZGluZykgewogICAgICAgICAgYWRkcmVzcyBzZW5kZXIgPSBtc2cuc2VuZGVyOwogICAgICAgICAgdWludCBldGhWYWx1ZSA9IGV0aEludmVzdGVkQnlbc2VuZGVyXTsKCiAgICAgICAgICByZXF1aXJlKGV0aFZhbHVlID4gMCk7CgogICAgICAgICAgLy8gMSAtIGJ1cm4gdG9rZW5zCiAgICAgICAgICBldGhJbnZlc3RlZEJ5W3NlbmRlcl0gPSAwOwogICAgICAgICAgbW50VG9rZW4uYnVyblRva2VucyhzZW5kZXIsIG1udFRva2VuLmJhbGFuY2VPZihzZW5kZXIpKTsKCiAgICAgICAgICAvLyAyIC0gc2VuZCBtb25leSBiYWNrCiAgICAgICAgICBzZW5kZXIudHJhbnNmZXIoZXRoVmFsdWUpOwogICAgIH0KCiAgICAgZnVuY3Rpb24gc2V0VXNkUGVyRXRoUmF0ZSh1aW50IF91c2RQZXJFdGhSYXRlKSBwdWJsaWMgb25seUV0aFNldHRlciB7CiAgICAgICAgICAvLyAxIC0gY2hlY2sKICAgICAgICAgIHJlcXVpcmUoKF91c2RQZXJFdGhSYXRlPj0xMDApICYmIChfdXNkUGVyRXRoUmF0ZTw9NzAwKSk7CiAgICAgICAgICB1aW50NjQgaG91cnNQYXNzZWQgPSBsYXN0VXNkUGVyRXRoQ2hhbmdlRGF0ZSArIDEgaG91cnM7ICAKICAgICAgICAgIHJlcXVpcmUodWludChub3cpID49IGhvdXJzUGFzc2VkKTsKCiAgICAgICAgICAvLyAyIC0gdXBkYXRlCiAgICAgICAgICB1c2RQZXJFdGhDb2lubWFya2V0Y2FwUmF0ZSA9IF91c2RQZXJFdGhSYXRlOwogICAgICAgICAgbGFzdFVzZFBlckV0aENoYW5nZURhdGUgPSB1aW50NjQobm93KTsKICAgICB9CgogICAgIC8vIERlZmF1bHQgZmFsbGJhY2sgZnVuY3Rpb24KICAgICBmdW5jdGlvbigpIHBheWFibGUgewogICAgICAgICAgLy8gYnV5VG9rZW5zIC0+IGlzc3VlVG9rZW5zSW50ZXJuYWwKICAgICAgICAgIGJ1eVRva2Vucyhtc2cuc2VuZGVyKTsKICAgICB9Cn0='.
	

]
