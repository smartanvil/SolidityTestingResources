Class {
	#name : #SRTd160995b3e72e5bd67935f5c99e05aa289d5a228,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd160995b3e72e5bd67935f5c99e05aa289d5a228 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CgogICAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IGMgPSBhICogYjsKICAgICAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICAgICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAgICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGFzc2VydChiIDw9IGEpOwogICAgICAgIHJldHVybiBhIC0gYjsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgICAgIGFzc2VydChjID49IGEpOwogICAgICAgIHJldHVybiBjOwogICAgfQp9CgoKCgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqLwpjb250cmFjdCBFUkMyMEJhc2ljIHsKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCgogICAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgogICAgLyoqCiAgICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgICAqIGFjY291bnQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgICAqLwogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgIH0KCn0KCi8qKgogKiBAdGl0bGUgUGF1c2FibGUKICogQGRldiBCYXNlIGNvbnRyYWN0IHdoaWNoIGFsbG93cyBjaGlsZHJlbiB0byBpbXBsZW1lbnQgYW4gZW1lcmdlbmN5IHN0b3AgbWVjaGFuaXNtLgogKi8KY29udHJhY3QgUGF1c2FibGUgaXMgT3duYWJsZSB7CiAgICBldmVudCBQYXVzZSgpOwogICAgZXZlbnQgVW5wYXVzZSgpOwoKICAgIGJvb2wgcHVibGljIHBhdXNlZCA9IGZhbHNlOwoKICAgIC8qKgogICAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBub3QgcGF1c2VkLgogICAgICovCiAgICBtb2RpZmllciB3aGVuTm90UGF1c2VkKCkgewogICAgICAgIHJlcXVpcmUoIXBhdXNlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgcGF1c2VkLgogICAgICovCiAgICBtb2RpZmllciB3aGVuUGF1c2VkKCkgewogICAgICAgIHJlcXVpcmUocGF1c2VkKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHBhdXNlLCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlCiAgICAgKi8KICAgIGZ1bmN0aW9uIHBhdXNlKCkgcHVibGljIG9ubHlPd25lciB3aGVuTm90UGF1c2VkIHsKICAgICAgICBwYXVzZWQgPSB0cnVlOwogICAgICAgIFBhdXNlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gdW5wYXVzZSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgICAqLwogICAgZnVuY3Rpb24gdW5wYXVzZSgpIHB1YmxpYyBvbmx5T3duZXIgd2hlblBhdXNlZCB7CiAgICAgICAgcGF1c2VkID0gZmFsc2U7CiAgICAgICAgVW5wYXVzZSgpOwogICAgfQp9CgoKCi8qKgogKiBAdGl0bGUgQmFzaWMgdG9rZW4KICogQGRldiBCYXNpYyB2ZXJzaW9uIG9mIFN0YW5kYXJkVG9rZW4sIHdpdGggbm8gYWxsb3dhbmNlcy4KICovCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogICAgLyoqCiAgICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1ttc2cuc2VuZGVyXSk7CgogICAgICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAgICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgICAqLwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9Cgp9CgoKLyoqCiAqIEB0aXRsZSBSZWZ1bmRWYXVsdAogKiBAZGV2IFRoaXMgY29udHJhY3QgaXMgdXNlZCBmb3Igc3RvcmluZyBmdW5kcyB3aGlsZSBhIGNyb3dkc2FsZQogKiBpcyBpbiBwcm9ncmVzcy4gU3VwcG9ydHMgcmVmdW5kaW5nIHRoZSBtb25leSBpZiBjcm93ZHNhbGUgZmFpbHMsCiAqIGFuZCBmb3J3YXJkaW5nIGl0IGlmIGNyb3dkc2FsZSBpcyBzdWNjZXNzZnVsLgogKi8KY29udHJhY3QgUmVmdW5kVmF1bHQgaXMgT3duYWJsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICBlbnVtIFN0YXRlIHsgQWN0aXZlLCBSZWZ1bmRpbmcsIENsb3NlZCB9CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgZGVwb3NpdGVkOwogICAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0OwogICAgU3RhdGUgcHVibGljIHN0YXRlOwoKICAgIGV2ZW50IENsb3NlZCgpOwogICAgZXZlbnQgUmVmdW5kc0VuYWJsZWQoKTsKICAgIGV2ZW50IFJlZnVuZGVkKGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB3ZWlBbW91bnQpOwoKICAgIGZ1bmN0aW9uIFJlZnVuZFZhdWx0KGFkZHJlc3MgX3dhbGxldCkgcHVibGljIHsKICAgICAgICByZXF1aXJlKF93YWxsZXQgIT0gMHgwKTsKICAgICAgICB3YWxsZXQgPSBfd2FsbGV0OwogICAgICAgIHN0YXRlID0gU3RhdGUuQWN0aXZlOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlcG9zaXQoYWRkcmVzcyBpbnZlc3RvcikgcHVibGljIG9ubHlPd25lciAgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5BY3RpdmUpOwogICAgICAgIGRlcG9zaXRlZFtpbnZlc3Rvcl0gPSBkZXBvc2l0ZWRbaW52ZXN0b3JdLmFkZChtc2cudmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNsb3NlKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5BY3RpdmUpOwogICAgICAgIHN0YXRlID0gU3RhdGUuQ2xvc2VkOwogICAgICAgIENsb3NlZCgpOwogICAgICAgIHdhbGxldC50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgfQoKICAgIGZ1bmN0aW9uIGVuYWJsZVJlZnVuZHMoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLkFjdGl2ZSk7CiAgICAgICAgc3RhdGUgPSBTdGF0ZS5SZWZ1bmRpbmc7CiAgICAgICAgUmVmdW5kc0VuYWJsZWQoKTsKICAgIH0KCiAgICBmdW5jdGlvbiByZWZ1bmQoYWRkcmVzcyBpbnZlc3RvcikgcHVibGljIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLlJlZnVuZGluZyk7CiAgICAgICAgdWludDI1NiBkZXBvc2l0ZWRWYWx1ZSA9IGRlcG9zaXRlZFtpbnZlc3Rvcl07CiAgICAgICAgZGVwb3NpdGVkW2ludmVzdG9yXSA9IDA7CiAgICAgICAgaW52ZXN0b3IudHJhbnNmZXIoZGVwb3NpdGVkVmFsdWUpOwogICAgICAgIFJlZnVuZGVkKGludmVzdG9yLCBkZXBvc2l0ZWRWYWx1ZSk7CiAgICB9Cn0KCgovKioKICogQHRpdGxlIFN0YW5kYXJkIEVSQzIwIHRva2VuCiAqCiAqIEBkZXYgSW1wbGVtZW50YXRpb24gb2YgdGhlIGJhc2ljIHN0YW5kYXJkIHRva2VuLgogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgRmlyc3RCbG9vZDoKICogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sCiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CgogICAgLyoqCiAgICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSk7CgogICAgICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgICAqCiAgICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKCiAgICAgICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2AKICAgICAgICAvLyAgYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyBgYXBwcm92ZShfc3BlbmRlciwgMClgIGlmIGl0IGlzIG5vdAogICAgICAgIC8vICBhbHJlYWR5IDAgdG8gbWl0aWdhdGUgdGhlIHJhY2UgY29uZGl0aW9uIGRlc2NyaWJlZCBoZXJlOgogICAgICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgICAgIHJlcXVpcmUoKF92YWx1ZSA9PSAwKSB8fCAoYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPT0gMCkpOwoKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAgICovCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQoKICAgIC8qKgogICAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgICAqLwogICAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgICAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgICAgICB9CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCn0KCgpjb250cmFjdCBQYXVzYWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIFBhdXNhYmxlIHsKCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci5hcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLmluY3JlYXNlQXBwcm92YWwoX3NwZW5kZXIsIF9hZGRlZFZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLmRlY3JlYXNlQXBwcm92YWwoX3NwZW5kZXIsIF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQp9CgoKY29udHJhY3QgQXBwbGF1c2VDYXNoVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgUGF1c2FibGVUb2tlbiB7CiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiQXBwbGF1c2VDYXNoIjsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIkFQTEMiOwogICAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gNDsKICAgIHVpbnQyNTYgcHVibGljIElOSVRJQUxfU1VQUExZID0gMzAwMDAwMDAwICogMTAwMDA7CgogICAgZnVuY3Rpb24gQXBwbGF1c2VDYXNoVG9rZW4oKSBwdWJsaWMgewogICAgICAgIHRvdGFsU3VwcGx5ID0gSU5JVElBTF9TVVBQTFk7CiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBJTklUSUFMX1NVUFBMWTsKICAgIH0KfQoKCgovKioKICogQHRpdGxlIENyb3dkc2FsZQogKiBAZGV2IE1vZGlmaWVkIGNvbnRyYWN0IGZvciBtYW5hZ2luZyBhIHRva2VuIGNyb3dkc2FsZS4KICogQXBwbGF1c2VDYXNoQ3Jvd2RzYWxlIGhhdmUgcHJlLXNhbGUgYW5kIG1haW4gc2FsZSBwZXJpb2RzLAogKiB3aGVyZSBpbnZlc3RvcnMgY2FuIG1ha2UgdG9rZW4gcHVyY2hhc2VzIGFuZCB0aGUgY3Jvd2RzYWxlIHdpbGwgYXNzaWduCiAqIHRoZW0gdG9rZW5zIGJhc2VkIG9uIGEgdG9rZW4gcGVyIEVUSCByYXRlIGFuZCB0aGUgc3lzdGVtIG9mIGJvbnVzZXMuCiAqIEZ1bmRzIGNvbGxlY3RlZCBhcmUgZm9yd2FyZGVkIHRvIGEgd2FsbGV0IGFzIHRoZXkgYXJyaXZlLgogKiBwcmUtc2FsZSBhbmQgbWFpbiBzYWxlIHBlcmlvZHMgYm90aCBoYXZlIGNhcHMgZGVmaW5lZCBpbiB0b2tlbnMuCiAqLwoKY29udHJhY3QgQXBwbGF1c2VDYXNoQ3Jvd2RzYWxlIGlzIE93bmFibGUgewoKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIHN0cnVjdCBCb251cyB7CiAgICAgICAgdWludCBkdXJhdGlvbjsKICAgICAgICB1aW50IHBlcmNlbnQ7CiAgICB9CgogICAgLy8gbWluaW11bSBhbW91bnQgb2YgZnVuZHMgdG8gYmUgcmFpc2VkIGluIHRva2VucwogICAgdWludDI1NiBwdWJsaWMgc29mdGNhcDsKCiAgICAvLyByZWZ1bmQgdmF1bHQgdXNlZCB0byBob2xkIGZ1bmRzIHdoaWxlIGNyb3dkc2FsZSBpcyBydW5uaW5nCiAgICBSZWZ1bmRWYXVsdCBwdWJsaWMgdmF1bHQ7CgogICAgLy8gdHJ1ZSBmb3IgZmluYWxpc2VkIGNyb3dkc2FsZQogICAgYm9vbCBwdWJsaWMgaXNGaW5hbGl6ZWQ7CgogICAgLy8gVGhlIHRva2VuIGJlaW5nIHNvbGQKICAgIEFwcGxhdXNlQ2FzaFRva2VuIHB1YmxpYyB0b2tlbiA9IG5ldyBBcHBsYXVzZUNhc2hUb2tlbigpOwoKICAgIC8vIHN0YXJ0IGFuZCBlbmQgdGltZXN0YW1wcyB3aGVyZSBwcmUtaW52ZXN0bWVudHMgYXJlIGFsbG93ZWQgKGJvdGggaW5jbHVzaXZlKQogICAgdWludDI1NiBwdWJsaWMgcHJlSWNvU3RhcnRUaW1lOwogICAgdWludDI1NiBwdWJsaWMgcHJlSWNvRW5kVGltZTsKCiAgICAvLyBzdGFydCBhbmQgZW5kIHRpbWVzdGFtcHMgd2hlcmUgbWFpbi1pbnZlc3RtZW50cyBhcmUgYWxsb3dlZCAoYm90aCBpbmNsdXNpdmUpCiAgICB1aW50MjU2IHB1YmxpYyBpY29TdGFydFRpbWU7CiAgICB1aW50MjU2IHB1YmxpYyBpY29FbmRUaW1lOwoKICAgIC8vIG1heGltdW0gYW1vdXQgb2YgdG9rZW5zIGZvciBwcmUtc2FsZSBhbmQgbWFpbiBzYWxlCiAgICB1aW50MjU2IHB1YmxpYyBwcmVJY29IYXJkY2FwOwogICAgdWludDI1NiBwdWJsaWMgaWNvSGFyZGNhcDsKCiAgICAvLyBhZGRyZXNzIHdoZXJlIGZ1bmRzIGFyZSBjb2xsZWN0ZWQKICAgIGFkZHJlc3MgcHVibGljIHdhbGxldDsKCiAgICAvLyBob3cgbWFueSB0b2tlbiB1bml0cyBhIGJ1eWVyIGdldHMgcGVyIEVUSAogICAgdWludDI1NiBwdWJsaWMgcmF0ZTsKCiAgICAvLyBhbW91bnQgb2YgcmFpc2VkIHRva2VucwogICAgdWludDI1NiBwdWJsaWMgdG9rZW5zSW52ZXN0ZWQ7CgogICAgQm9udXNbXSBwdWJsaWMgcHJlSWNvQm9udXNlczsKICAgIEJvbnVzW10gcHVibGljIGljb0JvbnVzZXM7CgogICAgLy8gSW52c3RvcnMgY2FuJ3QgaW52ZXN0IGxlc3MgdGhlbiBzcGVjaWZpZWQgbnVtYmVycyBpbiB3ZWkKICAgIHVpbnQyNTYgcHVibGljIHByZUljb01pbmltdW1XZWk7CiAgICB1aW50MjU2IHB1YmxpYyBpY29NaW5pbXVtV2VpOwoKICAgIC8vIERlZmF1bHQgYm9udXMgJQogICAgdWludDI1NiBwdWJsaWMgZGVmYXVsdFBlcmNlbnQ7CgogICAgLyoqCiAgICAgKiBldmVudCBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAgICogQHBhcmFtIHB1cmNoYXNlciB3aG8gcGFpZCBmb3IgdGhlIHRva2VucwogICAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IHdobyBnb3QgdGhlIHRva2VucwogICAgICogQHBhcmFtIHZhbHVlIHdlaXMgcGFpZCBmb3IgcHVyY2hhc2UKICAgICAqIEBwYXJhbSBhbW91bnQgYW1vdW50IG9mIHRva2VucyBwdXJjaGFzZWQKICAgICAqLwogICAgZXZlbnQgVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgdmFsdWUsIHVpbnQyNTYgYW1vdW50KTsKCiAgICBmdW5jdGlvbiBBcHBsYXVzZUNhc2hDcm93ZHNhbGUoCiAgICAgICAgdWludDI1NiBfcHJlSWNvU3RhcnRUaW1lLAogICAgICAgIHVpbnQyNTYgX3ByZUljb0VuZFRpbWUsCiAgICAgICAgdWludDI1NiBfcHJlSWNvSGFyZGNhcCwKICAgICAgICB1aW50MjU2IF9pY29TdGFydFRpbWUsCiAgICAgICAgdWludDI1NiBfaWNvRW5kVGltZSwKICAgICAgICB1aW50MjU2IF9pY29IYXJkY2FwLAogICAgICAgIHVpbnQyNTYgX3NvZnRjYXAsCiAgICAgICAgdWludDI1NiBfcmF0ZSwKICAgICAgICBhZGRyZXNzIF93YWxsZXQKICAgICkgcHVibGljIHsKCiAgICAgICAgLy9yZXF1aXJlKF9zb2Z0Y2FwID4gMCk7CgogICAgICAgIC8vIGNhbid0IHN0YXJ0IHByZS1zYWxlIGluIHRoZSBwYXN0CiAgICAgICAgcmVxdWlyZShfcHJlSWNvU3RhcnRUaW1lID49IG5vdyk7CgogICAgICAgIC8vIGNhbid0IHN0YXJ0IG1haW4gc2FsZSBpbiB0aGUgcGFzdAogICAgICAgIHJlcXVpcmUoX2ljb1N0YXJ0VGltZSA+PSBub3cpOwoKICAgICAgICAvLyBjYW4ndCBzdGFydCBtYWluIHNhbGUgYmVmb3JlIHRoZSBlbmQgb2YgcHJlLXNhbGUKICAgICAgICByZXF1aXJlKF9wcmVJY29FbmRUaW1lIDwgX2ljb1N0YXJ0VGltZSk7CgogICAgICAgIC8vIHRoZSBlbmQgb2YgcHJlLXNhbGUgY2FuJ3QgaGFwcGVuIGJlZm9yZSBpdCdzIHN0YXJ0CiAgICAgICAgcmVxdWlyZShfcHJlSWNvU3RhcnRUaW1lIDwgX3ByZUljb0VuZFRpbWUpOwoKICAgICAgICAvLyB0aGUgZW5kIG9mIG1haW4gc2FsZSBjYW4ndCBoYXBwZW4gYmVmb3JlIGl0J3Mgc3RhcnQKICAgICAgICByZXF1aXJlKF9pY29TdGFydFRpbWUgPCBfaWNvRW5kVGltZSk7CgogICAgICAgIHJlcXVpcmUoX3JhdGUgPiAwKTsKICAgICAgICByZXF1aXJlKF9wcmVJY29IYXJkY2FwID4gMCk7CiAgICAgICAgcmVxdWlyZShfaWNvSGFyZGNhcCA+IDApOwogICAgICAgIHJlcXVpcmUoX3dhbGxldCAhPSAweDApOwoKICAgICAgICBwcmVJY29NaW5pbXVtV2VpID0gMjAwMDAwMDAwMDAwMDAwMDA7ICAvLyAwLjAyIEV0aGVyIGRlZmF1bHQgbWluaW11bQogICAgICAgIGljb01pbmltdW1XZWkgPSAyMDAwMDAwMDAwMDAwMDAwMDsgLy8gMC4wMiBFdGhlciBkZWZhdWx0IG1pbmltdW0KICAgICAgICBkZWZhdWx0UGVyY2VudCA9IDA7CgogICAgICAgIHByZUljb0JvbnVzZXMucHVzaChCb251cyh7ZHVyYXRpb246IDEgaG91cnMsIHBlcmNlbnQ6IDkwfSkpOwogICAgICAgIHByZUljb0JvbnVzZXMucHVzaChCb251cyh7ZHVyYXRpb246IDYgZGF5cyArIDUgaG91cnMsIHBlcmNlbnQ6IDUwfSkpOwoKICAgICAgICBpY29Cb251c2VzLnB1c2goQm9udXMoe2R1cmF0aW9uOiAxIGhvdXJzLCBwZXJjZW50OiA0NX0pKTsKICAgICAgICBpY29Cb251c2VzLnB1c2goQm9udXMoe2R1cmF0aW9uOiA3IGRheXMgKyAxNSBob3VycywgcGVyY2VudDogNDB9KSk7CiAgICAgICAgaWNvQm9udXNlcy5wdXNoKEJvbnVzKHtkdXJhdGlvbjogNiBkYXlzLCBwZXJjZW50OiAzMH0pKTsKICAgICAgICBpY29Cb251c2VzLnB1c2goQm9udXMoe2R1cmF0aW9uOiA2IGRheXMsIHBlcmNlbnQ6IDIwfSkpOwogICAgICAgIGljb0JvbnVzZXMucHVzaChCb251cyh7ZHVyYXRpb246IDcgZGF5cywgcGVyY2VudDogMTB9KSk7CgogICAgICAgIHByZUljb1N0YXJ0VGltZSA9IF9wcmVJY29TdGFydFRpbWU7CiAgICAgICAgcHJlSWNvRW5kVGltZSA9IF9wcmVJY29FbmRUaW1lOwogICAgICAgIHByZUljb0hhcmRjYXAgPSBfcHJlSWNvSGFyZGNhcDsKICAgICAgICBpY29TdGFydFRpbWUgPSBfaWNvU3RhcnRUaW1lOwogICAgICAgIGljb0VuZFRpbWUgPSBfaWNvRW5kVGltZTsKICAgICAgICBpY29IYXJkY2FwID0gX2ljb0hhcmRjYXA7CiAgICAgICAgc29mdGNhcCA9IF9zb2Z0Y2FwOwogICAgICAgIHJhdGUgPSBfcmF0ZTsKICAgICAgICB3YWxsZXQgPSBfd2FsbGV0OwoKICAgICAgICBpc0ZpbmFsaXplZCA9IGZhbHNlOwoKICAgICAgICB2YXVsdCA9IG5ldyBSZWZ1bmRWYXVsdCh3YWxsZXQpOwogICAgfQoKICAgIC8vIGZhbGxiYWNrIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIGJ1eSB0b2tlbnMKICAgIGZ1bmN0aW9uICgpIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICBidXlUb2tlbnMobXNnLnNlbmRlcik7CiAgICB9CgogICAgLy8gbG93IGxldmVsIHRva2VuIHB1cmNoYXNlIGZ1bmN0aW9uCiAgICBmdW5jdGlvbiBidXlUb2tlbnMoYWRkcmVzcyBiZW5lZmljaWFyeSkgcHVibGljIHBheWFibGUgewoKICAgICAgICByZXF1aXJlKGJlbmVmaWNpYXJ5ICE9IDB4MCk7CiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgIT0gMCk7CiAgICAgICAgcmVxdWlyZSghaXNGaW5hbGl6ZWQpOwoKICAgICAgICB1aW50MjU2IHdlaUFtb3VudCA9IG1zZy52YWx1ZTsKCiAgICAgICAgdmFsaWRhdGVXaXRoaW5QZXJpb2RzKCk7CgogICAgICAgIC8vIGNhbGN1bGF0ZSB0b2tlbiBhbW91bnQgdG8gYmUgY3JlYXRlZC4KICAgICAgICAvLyBFVEggYW5kIG91ciB0b2tlbnMgaGF2ZSBkaWZmZXJlbnQgbnVtYmVycyBvZiBkZWNpbWFscyBhZnRlciBjb21tYQogICAgICAgIC8vIEVUSCAtIDE4IGRlY2ltYWxzLCBvdXIgdG9rZXMgLSA0LiBzbyB3ZSBuZWVkIHRvIGRpdmlkZSBvdXIgdmFsdWUKICAgICAgICAvLyBieSAxZTE0ICgxOCAtIDQgPT0gMTQpLgogICAgICAgIHVpbnQyNTYgdG9rZW5zID0gd2VpQW1vdW50Lm11bChyYXRlKS5kaXYoMTAwMDAwMDAwMDAwMDAwKTsKCiAgICAgICAgdWludDI1NiBwZXJjZW50ID0gZ2V0Qm9udXNQZXJjZW50KG5vdyk7CgogICAgICAgIC8vIGFkZCBib251cyB0byB0b2tlbnMgZGVwZW5kcyBvbiB0aGUgcGVyaW9kCiAgICAgICAgdWludDI1NiBib251c2VkVG9rZW5zID0gYXBwbHlCb251cyh0b2tlbnMsIHBlcmNlbnQpOwoKICAgICAgICB2YWxpZGF0ZVdpdGhpbkNhcHMoYm9udXNlZFRva2Vucywgd2VpQW1vdW50KTsKCiAgICAgICAgLy8gdXBkYXRlIHN0YXRlCiAgICAgICAgdG9rZW5zSW52ZXN0ZWQgPSB0b2tlbnNJbnZlc3RlZC5hZGQoYm9udXNlZFRva2Vucyk7CiAgICAgICAgdG9rZW4udHJhbnNmZXIoYmVuZWZpY2lhcnksIGJvbnVzZWRUb2tlbnMpOwogICAgICAgIFRva2VuUHVyY2hhc2UobXNnLnNlbmRlciwgYmVuZWZpY2lhcnksIHdlaUFtb3VudCwgYm9udXNlZFRva2Vucyk7CgogICAgICAgIGZvcndhcmRGdW5kcygpOwogICAgfQogICAgCiAgICAvLyBvd25lciBjYW4gdHJhbnNmZXIgdG9rZW5zCiAgICBmdW5jdGlvbiB0cmFuc2ZlclRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHRva2VucykgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgdG9rZW4udHJhbnNmZXIoYmVuZWZpY2lhcnksIHRva2Vucyk7CiAgICB9CgogICAgLy8gc2V0IG5ldyBkYXRlcyBmb3IgcHJlLXNhbGV2IChlbWVyZ2VuY3kgY2FzZSkKICAgIGZ1bmN0aW9uIHNldFByZUljb1BhcmFtZXRlcnMoCiAgICAgICAgdWludDI1NiBfcHJlSWNvU3RhcnRUaW1lLAogICAgICAgIHVpbnQyNTYgX3ByZUljb0VuZFRpbWUsCiAgICAgICAgdWludDI1NiBfcHJlSWNvSGFyZGNhcCwKICAgICAgICB1aW50MjU2IF9wcmVJY29NaW5pbXVtV2VpCiAgICApIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoIWlzRmluYWxpemVkKTsKICAgICAgICByZXF1aXJlKF9wcmVJY29TdGFydFRpbWUgPCBfcHJlSWNvRW5kVGltZSk7CiAgICAgICAgcmVxdWlyZShfcHJlSWNvSGFyZGNhcCA+IDApOwogICAgICAgIHByZUljb1N0YXJ0VGltZSA9IF9wcmVJY29TdGFydFRpbWU7CiAgICAgICAgcHJlSWNvRW5kVGltZSA9IF9wcmVJY29FbmRUaW1lOwogICAgICAgIHByZUljb0hhcmRjYXAgPSBfcHJlSWNvSGFyZGNhcDsKICAgICAgICBwcmVJY29NaW5pbXVtV2VpID0gX3ByZUljb01pbmltdW1XZWk7CiAgICB9CgogICAgLy8gc2V0IG5ldyBkYXRlcyBmb3IgbWFpbi1zYWxlIChlbWVyZ2VuY3kgY2FzZSkKICAgIGZ1bmN0aW9uIHNldEljb1BhcmFtZXRlcnMoCiAgICAgICAgdWludDI1NiBfaWNvU3RhcnRUaW1lLAogICAgICAgIHVpbnQyNTYgX2ljb0VuZFRpbWUsCiAgICAgICAgdWludDI1NiBfaWNvSGFyZGNhcCwKICAgICAgICB1aW50MjU2IF9pY29NaW5pbXVtV2VpCiAgICApIHB1YmxpYyBvbmx5T3duZXIgewoKICAgICAgICByZXF1aXJlKCFpc0ZpbmFsaXplZCk7CiAgICAgICAgcmVxdWlyZShfaWNvU3RhcnRUaW1lIDwgX2ljb0VuZFRpbWUpOwogICAgICAgIHJlcXVpcmUoX2ljb0hhcmRjYXAgPiAwKTsKICAgICAgICBpY29TdGFydFRpbWUgPSBfaWNvU3RhcnRUaW1lOwogICAgICAgIGljb0VuZFRpbWUgPSBfaWNvRW5kVGltZTsKICAgICAgICBpY29IYXJkY2FwID0gX2ljb0hhcmRjYXA7CiAgICAgICAgaWNvTWluaW11bVdlaSA9IF9pY29NaW5pbXVtV2VpOwogICAgfQoKICAgIC8vIHNldCBuZXcgd2FsbGV0cyAoZW1lcmdlbmN5IGNhc2UpCiAgICBmdW5jdGlvbiBzZXRXYWxsZXQoYWRkcmVzcyBfd2FsbGV0KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKCFpc0ZpbmFsaXplZCk7CiAgICAgICAgcmVxdWlyZShfd2FsbGV0ICE9IDB4MCk7CiAgICAgICAgd2FsbGV0ID0gX3dhbGxldDsKICAgIH0KCiAgICAgIC8vIHNldCBuZXcgcmF0ZSAoZW1lcmdlbmN5IGNhc2UpCiAgICBmdW5jdGlvbiBzZXRSYXRlKHVpbnQyNTYgX3JhdGUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoIWlzRmluYWxpemVkKTsKICAgICAgICByZXF1aXJlKF9yYXRlID4gMCk7CiAgICAgICAgcmF0ZSA9IF9yYXRlOwogICAgfQoKICAgICAgICAvLyBzZXQgbmV3IHNvZnRjYXAgKGVtZXJnZW5jeSBjYXNlKQogICAgZnVuY3Rpb24gc2V0U29mdGNhcCh1aW50MjU2IF9zb2Z0Y2FwKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKCFpc0ZpbmFsaXplZCk7CiAgICAgICAgcmVxdWlyZShfc29mdGNhcCA+IDApOwogICAgICAgIHNvZnRjYXAgPSBfc29mdGNhcDsKICAgIH0KCgogICAgLy8gc2V0IHRva2VuIG9uIHBhdXNlCiAgICBmdW5jdGlvbiBwYXVzZVRva2VuKCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKCFpc0ZpbmFsaXplZCk7CiAgICAgICAgdG9rZW4ucGF1c2UoKTsKICAgIH0KCiAgICAvLyB1bnNldCB0b2tlbidzIHBhdXNlCiAgICBmdW5jdGlvbiB1bnBhdXNlVG9rZW4oKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIHRva2VuLnVucGF1c2UoKTsKICAgIH0KCiAgICAvLyBzZXQgdG9rZW4gT3duZXJzaGlwCiAgICBmdW5jdGlvbiB0cmFuc2ZlclRva2VuT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgdG9rZW4udHJhbnNmZXJPd25lcnNoaXAobmV3T3duZXIpOwogICAgfQoKICAgIC8vIEByZXR1cm4gdHJ1ZSBpZiBtYWluIHNhbGUgZXZlbnQgaGFzIGVuZGVkCiAgICBmdW5jdGlvbiBpY29IYXNFbmRlZCgpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gbm93ID4gaWNvRW5kVGltZTsKICAgIH0KCiAgICAvLyBAcmV0dXJuIHRydWUgaWYgcHJlIHNhbGUgZXZlbnQgaGFzIGVuZGVkCiAgICBmdW5jdGlvbiBwcmVJY29IYXNFbmRlZCgpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gbm93ID4gcHJlSWNvRW5kVGltZTsKICAgIH0KCiAgICAvLyBzZW5kIGV0aGVyIHRvIHRoZSBmdW5kIGNvbGxlY3Rpb24gd2FsbGV0CiAgICBmdW5jdGlvbiBmb3J3YXJkRnVuZHMoKSBpbnRlcm5hbCB7CiAgICAgICAgLy93YWxsZXQudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgICAgICB2YXVsdC5kZXBvc2l0LnZhbHVlKG1zZy52YWx1ZSkobXNnLnNlbmRlcik7CiAgICB9CgogICAgLy8gd2Ugd2FudCB0byBiZSBhYmxlIHRvIGNoZWNrIGFsbCBib251c2VzIGluIGFscmVhZHkgZGVwbG95ZWQgY29udHJhY3QKICAgIC8vIHRoYXQncyB3aHkgd2UgcGFzcyBjdXJyZW50VGltZSBhcyBhIHBhcmFtZXRlciBpbnN0ZWFkIG9mIHVzaW5nICJub3ciCiAgICBmdW5jdGlvbiBnZXRCb251c1BlcmNlbnQodWludDI1NiBjdXJyZW50VGltZSkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcGVyY2VudCkgewogICAgICAvL3JlcXVpcmUoY3VycmVudFRpbWUgPj0gcHJlSWNvU3RhcnRUaW1lKTsKICAgICAgICB1aW50IGkgPSAwOwogICAgICAgIGJvb2wgaXNQcmVJY28gPSBjdXJyZW50VGltZSA+PSBwcmVJY29TdGFydFRpbWUgJiYgY3VycmVudFRpbWUgPD0gcHJlSWNvRW5kVGltZTsKICAgICAgICB1aW50MjU2IG9mZnNldCA9IDA7CiAgICAgICAgaWYgKGlzUHJlSWNvKSB7CiAgICAgICAgICAgIHVpbnQyNTYgcHJlSWNvRGlmZkluU2Vjb25kcyA9IGN1cnJlbnRUaW1lLnN1YihwcmVJY29TdGFydFRpbWUpOwogICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcHJlSWNvQm9udXNlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKHByZUljb0RpZmZJblNlY29uZHMgPD0gcHJlSWNvQm9udXNlc1tpXS5kdXJhdGlvbiArIG9mZnNldCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmVJY29Cb251c2VzW2ldLnBlcmNlbnQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBvZmZzZXQgPSBvZmZzZXQuYWRkKHByZUljb0JvbnVzZXNbaV0uZHVyYXRpb24pOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdWludDI1NiBpY29EaWZmSW5TZWNvbmRzID0gY3VycmVudFRpbWUuc3ViKGljb1N0YXJ0VGltZSk7CiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBpY29Cb251c2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoaWNvRGlmZkluU2Vjb25kcyA8PSBpY29Cb251c2VzW2ldLmR1cmF0aW9uICsgb2Zmc2V0KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGljb0JvbnVzZXNbaV0ucGVyY2VudDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIG9mZnNldCA9IG9mZnNldC5hZGQoaWNvQm9udXNlc1tpXS5kdXJhdGlvbik7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGRlZmF1bHRQZXJjZW50OwogICAgfQoKICAgIGZ1bmN0aW9uIGFwcGx5Qm9udXModWludDI1NiB0b2tlbnMsIHVpbnQyNTYgcGVyY2VudCkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICAodWludDI1NiBib251c2VkVG9rZW5zKSB7CiAgICAgICAgdWludDI1NiB0b2tlbnNUb0FkZCA9IHRva2Vucy5tdWwocGVyY2VudCkuZGl2KDEwMCk7CiAgICAgICAgcmV0dXJuIHRva2Vucy5hZGQodG9rZW5zVG9BZGQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHZhbGlkYXRlV2l0aGluUGVyaW9kcygpIGludGVybmFsIGNvbnN0YW50IHsKICAgICAgICAvLyB3aXRoaW4gcHJlLXNhbGUgb3IgbWFpbiBzYWxlCiAgICAgICAgcmVxdWlyZSgobm93ID49IHByZUljb1N0YXJ0VGltZSAmJiBub3cgPD0gcHJlSWNvRW5kVGltZSkgfHwgKG5vdyA+PSBpY29TdGFydFRpbWUgJiYgbm93IDw9IGljb0VuZFRpbWUpKTsKICAgIH0KCiAgICBmdW5jdGlvbiB2YWxpZGF0ZVdpdGhpbkNhcHModWludDI1NiB0b2tlbnNBbW91bnQsIHVpbnQyNTYgd2VpQW1vdW50KSBpbnRlcm5hbCBjb25zdGFudCB7CiAgICAgICAgdWludDI1NiBleHBlY3RlZFRva2Vuc0ludmVzdGVkID0gdG9rZW5zSW52ZXN0ZWQuYWRkKHRva2Vuc0Ftb3VudCk7CgogICAgICAgIC8vIHdpdGhpbiBwcmUtc2FsZQogICAgICAgIGlmIChub3cgPj0gcHJlSWNvU3RhcnRUaW1lICYmIG5vdyA8PSBwcmVJY29FbmRUaW1lKSB7CiAgICAgICAgICAgIHJlcXVpcmUod2VpQW1vdW50ID49IHByZUljb01pbmltdW1XZWkpOwogICAgICAgICAgICByZXF1aXJlKGV4cGVjdGVkVG9rZW5zSW52ZXN0ZWQgPD0gcHJlSWNvSGFyZGNhcCk7CiAgICAgICAgfQoKICAgICAgICAvLyB3aXRoaW4gbWFpbiBzYWxlCiAgICAgICAgaWYgKG5vdyA+PSBpY29TdGFydFRpbWUgJiYgbm93IDw9IGljb0VuZFRpbWUpIHsKICAgICAgICAgICAgcmVxdWlyZShleHBlY3RlZFRva2Vuc0ludmVzdGVkIDw9IGljb0hhcmRjYXApOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBpZiBjcm93ZHNhbGUgaXMgdW5zdWNjZXNzZnVsLCBpbnZlc3RvcnMgY2FuIGNsYWltIHJlZnVuZHMgaGVyZQogICAgZnVuY3Rpb24gY2xhaW1SZWZ1bmQoKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoaXNGaW5hbGl6ZWQpOwogICAgICAgIHJlcXVpcmUoIXNvZnRjYXBSZWFjaGVkKCkpOwogICAgICAgIHZhdWx0LnJlZnVuZChtc2cuc2VuZGVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzb2Z0Y2FwUmVhY2hlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHRva2Vuc0ludmVzdGVkID49IHNvZnRjYXA7CiAgICB9CgogICAgLy8gZmluaXNoIGNyb3dkc2FsZQogICAgZnVuY3Rpb24gZmluYWxpc2VDcm93ZHNhbGUoKSBleHRlcm5hbCBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoIWlzRmluYWxpemVkKTsKICAgICAgICBpZiAoc29mdGNhcFJlYWNoZWQoKSkgewogICAgICAgICAgICB2YXVsdC5jbG9zZSgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZhdWx0LmVuYWJsZVJlZnVuZHMoKTsKICAgICAgICB9CgogICAgICAgIGlzRmluYWxpemVkID0gdHJ1ZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCn0KCgpjb250cmFjdCBEZXBsb3llciBpcyBPd25hYmxlIHsKCiAgICBBcHBsYXVzZUNhc2hDcm93ZHNhbGUgcHVibGljIGFwcGxhdXNlQ2FzaENyb3dkc2FsZTsKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IFRPS0VOX0RFQ0lNQUxTX01VTFRJUExJRVIgPSAxMDAwMDsKICAgIGFkZHJlc3MgcHVibGljIG11bHRpc2lnID0gMHhhQjE4OGFDQkI4YTQwMTI3N0RDMkQ4M0MyNDI2NzdjYTNDOTZmRjA1OwoKICAgIGZ1bmN0aW9uIGRlcGxveSgpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIGFwcGxhdXNlQ2FzaENyb3dkc2FsZSA9IG5ldyBBcHBsYXVzZUNhc2hDcm93ZHNhbGUoCiAgICAgICAgICAgIDE1MTYyODA0MDAsIC8vUHJlIElDTyBTdGFydDogMTggSmFuIDIwMTggYXQgODowMCBhbSBFU1QKICAgICAgICAgICAgMTUxNjg1NjQwMCwgLy9QcmUgSUNPIEVuZDogMjQgSmFuIDIwMTggYXQgMTE6NTkgcG0gRVNUCiAgICAgICAgICAgIDMwMDAwMDAgKiBUT0tFTl9ERUNJTUFMU19NVUxUSVBMSUVSLCAvL1ByZSBJQ08gaGFyZGNhcAogICAgICAgICAgICAxNTE3NDkwMDAwLCAgLy8gSUNPIFN0YXJ0OiAxIEZlYiAyMDE4IGF0IDggYW0gRVNUCiAgICAgICAgICAgIDE1MTk4ODA0MDAsIC8vIElDTyBFbmQ6IDI4IEZlYiAyMDE4IGF0IDExLjU5IHBtIEVTVAogICAgICAgICAgICAxNDQwMDAwMDAgKiBUT0tFTl9ERUNJTUFMU19NVUxUSVBMSUVSLCAgLy8gSUNPIGhhcmRjYXAKICAgICAgICAgICAgNTAwMDAgKiBUT0tFTl9ERUNJTUFMU19NVUxUSVBMSUVSLCAvLyBPdmVyYWwgY3Jvd2RzYWxlIHNvZnRjYXAKICAgICAgICAgICAgNTAwLCAvLyAxIEVUSCA9IDUwMCBBUExDCiAgICAgICAgICAgIG11bHRpc2lnIC8vIE11bHRpc2lnbmF0dXJlIHdhbGxldCAoY29udHJvbGxlZCBieSBtdWx0aXBsZSBhY2NvdW50cykKICAgICAgICApOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldE93bmVyKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgYXBwbGF1c2VDYXNoQ3Jvd2RzYWxlLnRyYW5zZmVyT3duZXJzaGlwKG93bmVyKTsKICAgIH0KCgp9'.
	

]
