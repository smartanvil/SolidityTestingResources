Class {
	#name : #SRTbA6284cA128d72B25f1353FadD06Aa145D9095Af,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTbA6284cA128d72B25f1353FadD06Aa145D9095Af >> base64 [
	^ 'Y29udHJhY3QgRXRoc3RpY2sgewogICAgCi8vQ09QWVJJR0hUIDIwMTYgS0FUQVRTVUtJIEFMTCBSSUdIVFMgUkVTRVJWRUQKLy9ObyBwYXJ0IG9mIHRoaXMgc291cmNlIGNvZGUgbWF5IGJlIHJlcHJvZHVjZWQsIGRpc3RyaWJ1dGVkLAovL21vZGlmaWVkIG9yIHRyYW5zbWl0dGVkIGluIGFueSBmb3JtIG9yIGJ5IGFueSBtZWFucyB3aXRob3V0Ci8vdGhlIHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbiBvZiB0aGUgY3JlYXRvci4KICAgIAogICAgYWRkcmVzcyBwcml2YXRlIHBpZzsKICAgIAogICAgLy9TdG9yZWQgdmFyaWFibGVzCiAgICB1aW50IHByaXZhdGUgYmFsYW5jZSA9IDA7CiAgICB1aW50IHByaXZhdGUgbWF4RGVwb3NpdCA9IDU7CiAgICB1aW50IHByaXZhdGUgZmVlID0gMDsKICAgIHVpbnQgcHJpdmF0ZSBtdWx0aXBsaWVyID0gMTIwOwogICAgdWludCBwcml2YXRlIHBheW91dE9yZGVyID0gMDsKICAgIHVpbnQgcHJpdmF0ZSBkb25rZXlzSW52ZXN0ZWQgPSAwOwogICAgdWludCBwcml2YXRlIGludmVzdG1lbnRSZWNvcmQgPSAwOwogICAgdWludCBwcml2YXRlIGNhcnJvdHMgPSAwOwogICAgdWludCBwcml2YXRlIGVsaWdpYmxlRm9yRmVlcyA9IDU7CiAgICBhZGRyZXNzIHByaXZhdGUgZG9ua2V5S2luZyA9IDB4MDsKICAgIAogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBEb25rZXkpIHByaXZhdGUgZG9ua2V5czsKICAgIEVudHJ5W10gcHJpdmF0ZSBlbnRyaWVzOwogICAgCiAgICBEb25rZXlbXSBwcml2YXRlIHJhbmtpbmc7CiAgICAKICAgIGV2ZW50IE5ld0tpbmcoYWRkcmVzcyBhc3MpOwogICAgCiAgICAvL1NldCBvd25lciBvbiBjb250cmFjdCBjcmVhdGlvbgogICAgZnVuY3Rpb24gRXRoc3RpY2soKSB7CiAgICAgICAgcGlnID0gbXNnLnNlbmRlcjsKICAgICAgICByYW5raW5nLmxlbmd0aCA9IDEwOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlwaWcgeyBpZiAobXNnLnNlbmRlciA9PSBwaWcpIF87IH0gICAgCiAgICBzdHJ1Y3QgRG9ua2V5IHsKICAgICAgICBhZGRyZXNzIGFkZHI7CiAgICAgICAgc3RyaW5nIG5pY2tuYW1lOwogICAgICAgIHVpbnQgaW52ZXN0ZWQ7CiAgICB9CiAgICAKICAgIHN0cnVjdCBFbnRyeSB7CiAgICAgICAgYWRkcmVzcyBlbnRyeUFkZHJlc3M7CiAgICAgICAgdWludCBkZXBvc2l0OwogICAgICAgIHVpbnQgcGF5b3V0OwogICAgICAgIGJvb2wgcGFpZDsKICAgIH0KCiAgICAvL0ZhbGxiYWNrIGZ1bmN0aW9uCiAgICBmdW5jdGlvbigpIHsKICAgICAgICBpbml0KCk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGluaXQoKSBwcml2YXRlewogICAgICAgIC8vT25seSBkZXBvc2l0cyA+MC4xRVRIIGFyZSBhbGxvd2VkIHRvIGpvaW4KICAgICAgICBpZiAobXNnLnZhbHVlIDwgMTAwIGZpbm5leSkgewogICAgICAgICAgICBtc2cuc2VuZGVyLnNlbmQobXNnLnZhbHVlKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBjaGFzZSgpOwogICAgfQogICAgCiAgICAvL0NoYXNlIHRoZSBjYXJyb3QKICAgIGZ1bmN0aW9uIGNoYXNlKCkgcHJpdmF0ZSB7CiAgICAgICAgCiAgICAgICAgLy9MaW1pdCBkZXBvc2l0cyB0byBYRVRICiAgICAgICAgdWludCBkVmFsdWUgPSAxMDAgZmlubmV5OwogICAgICAgIGlmIChtc2cudmFsdWUgPiBtYXhEZXBvc2l0ICogMSBldGhlcikgewogICAgICAgICAgICAKICAgICAgICAJbXNnLnNlbmRlci5zZW5kKG1zZy52YWx1ZSAtIG1heERlcG9zaXQgKiAxIGV0aGVyKTsJCiAgICAgICAgCWRWYWx1ZSA9IG1heERlcG9zaXQgKiAxIGV0aGVyOwogICAgICAgIH0KICAgICAgICBlbHNlIHsgZFZhbHVlID0gbXNnLnZhbHVlOyB9CgogICAgICAgIC8vQWRkIG5ldyB1c2VycyB0byB0aGUgdXNlcnMgYXJyYXkgaWYgaGUncyBhIG5ldyBwbGF5ZXIKICAgICAgICBhZGROZXdEb25rZXkobXNnLnNlbmRlcik7CiAgICAgICAgCiAgICAgICAgLy9BZGQgbmV3IGVudHJ5IHRvIHRoZSBlbnRyaWVzIGFycmF5IAogICAgICAgIGVudHJpZXMucHVzaChFbnRyeShtc2cuc2VuZGVyLCBkVmFsdWUsIChkVmFsdWUgKiAobXVsdGlwbGllcikgLyAxMDApLCBmYWxzZSkpOwogICAgICAgICAgIAogICAgICAgIC8vVXBkYXRlIGNvbnRyYWN0IHN0YXRzCiAgICAgICAgYmFsYW5jZSArPSAoZFZhbHVlICogKDEwMCAtIGZlZSkpIC8gMTAwOwogICAgICAgIGRvbmtleXNJbnZlc3RlZCArPSBkVmFsdWU7CiAgICAgICAgZG9ua2V5c1ttc2cuc2VuZGVyXS5pbnZlc3RlZCArPSBkVmFsdWU7CiAgICAgICAgCiAgICAgICAgCiAgICAgICAgLy9SYW5raW5nIGxvZ2ljOiBtaW5kZnVjayBlZGl0aW9uCiAgICAgICAgdWludCBpbmRleCA9IHJhbmtpbmcubGVuZ3RoIC0gMTsKICAgICAgICB1aW50IG5ld0VudHJ5ID0gZG9ua2V5c1ttc2cuc2VuZGVyXS5pbnZlc3RlZDsKICAgICAgICBib29sIGRvbmUgPSBmYWxzZTsKICAgICAgICBib29sIHNhbWVQb3NpdGlvbiA9IGZhbHNlOwogICAgICAgIHVpbnQgZXhpc3RpbmdBdCA9IHJhbmtpbmcubGVuZ3RoIC0gMTsKCiAgICAgICAgd2hpbGUgKHJhbmtpbmdbaW5kZXhdLmludmVzdGVkIDwgbmV3RW50cnkgJiYgIWRvbmUpCiAgICAgICAgewogICAgICAgICAgICBpZiAoaW5kZXggPiAwKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBkb25lID0gZG9ua2V5c1tyYW5raW5nW2luZGV4IC0gMV0uYWRkcl0uaW52ZXN0ZWQgPiBuZXdFbnRyeTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgKHJhbmtpbmdbaW5kZXhdLmFkZHIgPT0gbXNnLnNlbmRlcikKICAgICAgICAgICAgICAgICAgICBleGlzdGluZ0F0ID0gaW5kZXg7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIChkb25lKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmIChyYW5raW5nW2luZGV4XS5hZGRyID09IG1zZy5zZW5kZXIpCiAgICAgICAgICAgICAgICAgICAgeyAKICAgICAgICAgICAgICAgICAgICAgICAgcmFua2luZ1tpbmRleF0gPSBkb25rZXlzW21zZy5zZW5kZXJdOwogICAgICAgICAgICAgICAgICAgICAgICBzYW1lUG9zaXRpb24gPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmICghZG9uZSkgaW5kZXgtLTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGRvbmUgPSB0cnVlOwogICAgICAgICAgICAgICAgaW5kZXggPSAwOwogICAgICAgICAgICAgICAgaWYgKHJhbmtpbmdbaW5kZXhdLmFkZHIgPT0gbXNnLnNlbmRlciB8fCByYW5raW5nW2luZGV4XS5hZGRyID09IGFkZHJlc3MoMHgwKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICByYW5raW5nW2luZGV4XSA9IGRvbmtleXNbbXNnLnNlbmRlcl07CiAgICAgICAgICAgICAgICAgICAgc2FtZVBvc2l0aW9uID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKCFzYW1lUG9zaXRpb24pCiAgICAgICAgewogICAgICAgICAgICByYW5rRG93bihpbmRleCwgZXhpc3RpbmdBdCk7CiAgICAgICAgICAgIHJhbmtpbmdbaW5kZXhdID0gZG9ua2V5c1ttc2cuc2VuZGVyXTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgCiAgICAgICAgLy9QYXkgcGVuZGluZyBlbnRyaWVzIGlmIHRoZSBuZXcgYmFsYW5jZSBhbGxvd3MgZm9yIGl0CiAgICAgICAgd2hpbGUgKGJhbGFuY2UgPiBlbnRyaWVzW3BheW91dE9yZGVyXS5wYXlvdXQpIHsKICAgICAgICAgICAgCiAgICAgICAgICAgIHVpbnQgcGF5b3V0ID0gZW50cmllc1twYXlvdXRPcmRlcl0ucGF5b3V0OwogICAgICAgICAgICAKICAgICAgICAgICAgZW50cmllc1twYXlvdXRPcmRlcl0uZW50cnlBZGRyZXNzLnNlbmQocGF5b3V0KTsKICAgICAgICAgICAgZW50cmllc1twYXlvdXRPcmRlcl0ucGFpZCA9IHRydWU7CgogICAgICAgICAgICBiYWxhbmNlIC09IHBheW91dDsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNhcnJvdHMrKzsKICAgICAgICAgICAgcGF5b3V0T3JkZXIrKzsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy9Db2xsZWN0IG1vbmV5IGZyb20gZmVlcyBhbmQgcG9zc2libGUgbGVmdG92ZXJzIGZyb20gZXJyb3JzIChhY3R1YWwgYmFsYW5jZSB1bnRvdWNoZWQpCiAgICAgICAgdWludCBmZWVzID0gdGhpcy5iYWxhbmNlIC0gYmFsYW5jZTsKICAgICAgICBpZiAoZmVlcyA+IDApCiAgICAgICAgewogICAgICAgICAgICBpZiAoZW50cmllcy5sZW5ndGggPj0gNTAgJiYgZW50cmllcy5sZW5ndGggJSA1ID09IDApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGZlZXMgPSBkVmFsdWUgKiBmZWUgLyAxMDA7CiAgICAgICAgICAgICAgICB1aW50IGx1Y2t5RG9ua2V5ID0gcmFuZChlbGlnaWJsZUZvckZlZXMpIC0gMTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgKHJhbmtpbmdbbHVja3lEb25rZXldLmFkZHIgIT0gYWRkcmVzcygweDApKQogICAgICAgICAgICAgICAgICAgIHJhbmtpbmdbbHVja3lEb25rZXldLmFkZHIuc2VuZChmZWVzKTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBkb25rZXlLaW5nLnNlbmQoZmVlcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcGlnLnNlbmQoZmVlcyk7CiAgICAgICAgfSAgICAgICAgCiAgICAgICAgCiAgICAgICAgLy9DaGVjayBmb3IgbmV3IERvbmtleSBLaW5nCiAgICAgICAgaWYgKGRvbmtleXNbbXNnLnNlbmRlcl0uaW52ZXN0ZWQgPiBpbnZlc3RtZW50UmVjb3JkKQogICAgICAgIHsKICAgICAgICAgICAgZG9ua2V5S2luZyA9IG1zZy5zZW5kZXI7CiAgICAgICAgICAgIE5ld0tpbmcobXNnLnNlbmRlcik7CiAgICAgICAgICAgIGludmVzdG1lbnRSZWNvcmQgPSBkb25rZXlzW21zZy5zZW5kZXJdLmludmVzdGVkOwogICAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKHJhbmtpbmdbMF0uYWRkciAhPSBkb25rZXlzW2RvbmtleUtpbmddLmFkZHIgJiYgcmFua2luZ1swXS5hZGRyICE9IGFkZHJlc3MoMHgwKSkKICAgICAgICB7CiAgICAgICAgICAgIHJhbmtpbmdbMV0gPSBkb25rZXlzW3JhbmtpbmdbMF0uYWRkcl07CiAgICAgICAgICAgIHJhbmtpbmdbMF0gPSBkb25rZXlzW2RvbmtleUtpbmddOwogICAgICAgIH0KICAgICAgICAKICAgIH0KICAgIAogICAgZnVuY3Rpb24gcmFua0Rvd24odWludCBpbmRleCwgdWludCBvZmZzZXQpIHByaXZhdGUKICAgIHsKICAgICAgICBmb3IgKHVpbnQgaSA9IG9mZnNldDsgaSA+IGluZGV4OyBpLS0pCiAgICAgICAgewogICAgICAgICAgICByYW5raW5nW2ldID0gZG9ua2V5c1tyYW5raW5nW2ktMV0uYWRkcl07CiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jdGlvbiBhZGROZXdEb25rZXkoYWRkcmVzcyBBZGRyZXNzKSBwcml2YXRlCiAgICB7CiAgICAgICAgaWYgKGRvbmtleXNbQWRkcmVzc10uYWRkciA9PSBhZGRyZXNzKDApKQogICAgICAgIHsKICAgICAgICAgICAgZG9ua2V5c1tBZGRyZXNzXS5hZGRyID0gQWRkcmVzczsKICAgICAgICAgICAgZG9ua2V5c1tBZGRyZXNzXS5uaWNrbmFtZSA9ICdHdWxsaWJsZURvbmtleSc7CiAgICAgICAgICAgIGRvbmtleXNbQWRkcmVzc10uaW52ZXN0ZWQgPSAwOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLy9HZW5lcmF0ZSByYW5kb20gbnVtYmVyIGJldHdlZW4gMSAmIG1heAogICAgdWludDI1NiBjb25zdGFudCBwcml2YXRlIEZBQ1RPUiA9ICAxMTU3OTIwODkyMzczMTYxOTU0MjM1NzA5ODUwMDg2ODc5MDc4NTMyNjk5ODQ2NjU2NDA1NjQwMzk0NTc1ODQwMDc5MTMxMjk2Mzk5OwogICAgZnVuY3Rpb24gcmFuZCh1aW50IG1heCkgY29uc3RhbnQgcHJpdmF0ZSByZXR1cm5zICh1aW50MjU2IHJlc3VsdCl7CiAgICAgICAgdWludDI1NiBmYWN0b3IgPSBGQUNUT1IgKiAxMDAgLyBtYXg7CiAgICAgICAgdWludDI1NiBsYXN0QmxvY2tOdW1iZXIgPSBibG9jay5udW1iZXIgLSAxOwogICAgICAgIHVpbnQyNTYgaGFzaFZhbCA9IHVpbnQyNTYoYmxvY2suYmxvY2toYXNoKGxhc3RCbG9ja051bWJlcikpOwogICAgCiAgICAgICAgcmV0dXJuIHVpbnQyNTYoKHVpbnQyNTYoaGFzaFZhbCkgLyBmYWN0b3IpKSAlIG1heCArIDE7CiAgICB9CiAgICAKCiAgICAvL0NvbnRyYWN0IG1hbmFnZW1lbnQKICAgIGZ1bmN0aW9uIGNoYW5nZVBpZyhhZGRyZXNzIG5ld1BpZykgb25seXBpZyB7CiAgICAgICAgcGlnID0gbmV3UGlnOwogICAgfQogICAgCiAgICAKICAgIGZ1bmN0aW9uIGNoYW5nZU11bHRpcGxpZXIodWludCBtdWx0aSkgb25seXBpZyB7CiAgICAgICAgaWYgKG11bHRpIDwgMTEwIHx8IG11bHRpID4gMTMwKSAKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgCiAgICAgICAgbXVsdGlwbGllciA9IG11bHRpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBjaGFuZ2VGZWUodWludCBuZXdGZWUpIG9ubHlwaWcgewogICAgICAgIGlmIChuZXdGZWUgPiA1KSAKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgCiAgICAgICAgZmVlID0gbmV3RmVlOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBjaGFuZ2VNYXhEZXBvc2l0KHVpbnQgbWF4KSBvbmx5cGlnIHsKICAgICAgICBpZiAobWF4IDwgMSB8fCBtYXggPiAxMCkKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICAgIAogICAgICAgIG1heERlcG9zaXQgPSBtYXg7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNoYW5nZVJhbmtpbmdTaXplKHVpbnQgc2l6ZSkgb25seXBpZyB7CiAgICAgICAgaWYgKHNpemUgPCA1IHx8IHNpemUgPiAxMDApCiAgICAgICAgICAgIHRocm93OwogICAgICAgICAgICAKICAgICAgICByYW5raW5nLmxlbmd0aCA9IHNpemU7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNoYW5nZUVsaWdpYmxlRG9ua2V5cyh1aW50IG51bWJlcikgb25seXBpZyB7CiAgICAgICAgaWYgKG51bWJlciA8IDUgfHwgbnVtYmVyID4gMTUpCiAgICAgICAgICAgIHRocm93OwogICAgICAgICAgICAKICAgICAgICBlbGlnaWJsZUZvckZlZXMgPSBudW1iZXI7CiAgICB9CiAgICAKICAgIAogICAgLy9KU09OIGZ1bmN0aW9ucwogICAgZnVuY3Rpb24gc2V0Tmlja25hbWUoc3RyaW5nIG5hbWUpIHsKICAgICAgICBhZGROZXdEb25rZXkobXNnLnNlbmRlcik7CiAgICAgICAgCiAgICAgICAgaWYgKGJ5dGVzKG5hbWUpLmxlbmd0aCA+PSAyICYmIGJ5dGVzKG5hbWUpLmxlbmd0aCA8PSAxNikKICAgICAgICAgICAgZG9ua2V5c1ttc2cuc2VuZGVyXS5uaWNrbmFtZSA9IG5hbWU7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNhcnJvdHNDYXVnaHQoKSBjb25zdGFudCByZXR1cm5zICh1aW50IGFtb3VudCwgc3RyaW5nIGluZm8pIHsKICAgICAgICBhbW91bnQgPSBjYXJyb3RzOwogICAgICAgIGluZm8gPSAnVGhlIG51bWJlciBvZiBwYXlvdXRzIHNlbnQgdG8gcGFydGljaXBhbnRzLic7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGN1cnJlbnRCYWxhbmNlKCkgY29uc3RhbnQgcmV0dXJucyAodWludCB0aGVCYWxhbmNlLCBzdHJpbmcgaW5mbykgewogICAgICAgIHRoZUJhbGFuY2UgPSBiYWxhbmNlIC8gMSBmaW5uZXk7CiAgICAgICAgaW5mbyA9ICdUaGUgYmFsYW5jZSBvZiB0aGUgY29udHJhY3QgaW4gRmlubmV5cy4nOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB0aGVEb25rZXlLaW5nKCkgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcyBraW5nLCBzdHJpbmcgbmlja25hbWUsIHVpbnQgdG90YWxJbnZlc3RlZCwgc3RyaW5nIGluZm8pIHsKICAgICAgICBraW5nID0gZG9ua2V5S2luZzsgIAogICAgICAgIG5pY2tuYW1lID0gZG9ua2V5c1tkb25rZXlLaW5nXS5uaWNrbmFtZTsKICAgICAgICB0b3RhbEludmVzdGVkID0gZG9ua2V5c1tkb25rZXlLaW5nXS5pbnZlc3RlZCAvIDEgZXRoZXI7CiAgICAgICAgaW5mbyA9ICdUaGUgZ3JlZWRpZXN0IG9mIGFsbCBkb25rZXlzLiBZb3UgZ28sIGFzcyEnOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBkb25rZXlOYW1lKGFkZHJlc3MgQWRkcmVzcykgY29uc3RhbnQgcmV0dXJucyAoc3RyaW5nIG5pY2tuYW1lKSB7CiAgICAgICAgbmlja25hbWUgPSBkb25rZXlzW0FkZHJlc3NdLm5pY2tuYW1lOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBjdXJyZW50TXVsdGlwbGllcigpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgdGhlTXVsdGlwbGllciwgc3RyaW5nIGluZm8pIHsKICAgICAgICB0aGVNdWx0aXBsaWVyID0gbXVsdGlwbGllcjsKICAgICAgICBpbmZvID0gJ1RoZSBtdWx0aXBsaWVyIGFwcGxpZWQgdG8gYWxsIGRlcG9zaXRzICh4MTAwKS4gSXQgZGV0ZXJtaW5lcyB0aGUgYW1vdW50IG9mIG1vbmV5IHlvdSB3aWxsIGdldCB3aGVuIHlvdSBjYXRjaCB0aGUgY2Fycm90Lic7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdlbmVyb3VzRmVlKCkgY29uc3RhbnQgcmV0dXJucyAodWludCBmZWVQZXJjZW50YWdlLCBzdHJpbmcgaW5mbykgewogICAgICAgIGZlZVBlcmNlbnRhZ2UgPSBmZWU7CiAgICAgICAgaW5mbyA9ICdUaGUgZ2VuZXJvdXNseSBtb2Rlc3QgZmVlIHBlcmNlbnRhZ2UgYXBwbGllZCB0byBhbGwgZGVwb3NpdHMuIEl0IGNhbiBjaGFuZ2UgdG8gbHVyZSBtb3JlIGRvbmtleXMgKG1heCA1JSkuJzsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gbmV4dFBheW91dEdvYWwoKSBjb25zdGFudCByZXR1cm5zICh1aW50IGZpbm5leXMsIHN0cmluZyBpbmZvKSB7CiAgICAgICAgZmlubmV5cyA9IChlbnRyaWVzW3BheW91dE9yZGVyXS5wYXlvdXQgLSBiYWxhbmNlKSAvIDEgZmlubmV5OwogICAgICAgIGluZm8gPSAnVGhlIGFtb3VudCBvZiBGaW5uZXlzIChFdGhlcnMgKiAxMDAwKSB0aGF0IG5lZWQgdG8gYmUgZGVwb3NpdGVkIGZvciB0aGUgbmV4dCBkb25rZXkgdG8gY2F0Y2ggaGlzIGNhcnJvdC4nOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB0b3RhbEVudHJpZXMoKSBjb25zdGFudCByZXR1cm5zICh1aW50IGNvdW50LCBzdHJpbmcgaW5mbykgewogICAgICAgIGNvdW50ID0gZW50cmllcy5sZW5ndGg7CiAgICAgICAgaW5mbyA9ICdUaGUgbnVtYmVyIG9mIHRpbWVzIHRoZSBjYXJyb3Qgd2FzIGNoYXNlZCBieSBndWxsaWJsZSBkb25rZXlzLic7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGVudHJ5RGV0YWlscyh1aW50IGluZGV4KSBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzIGRvbmtleSwgc3RyaW5nIG5pY2tOYW1lLCB1aW50IGRlcG9zaXQsIHVpbnQgcGF5b3V0LCBib29sIHBhaWQsIHN0cmluZyBpbmZvKQogICAgewogICAgICAgIGlmIChpbmRleCA8IGVudHJpZXMubGVuZ3RoIHx8IGluZGV4ID09IDAgJiYgZW50cmllcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGRvbmtleSA9IGVudHJpZXNbaW5kZXhdLmVudHJ5QWRkcmVzczsKICAgICAgICAgICAgbmlja05hbWUgPSBkb25rZXlzW2VudHJpZXNbaW5kZXhdLmVudHJ5QWRkcmVzc10ubmlja25hbWU7CiAgICAgICAgICAgIGRlcG9zaXQgPSBlbnRyaWVzW2luZGV4XS5kZXBvc2l0IC8gMSBmaW5uZXk7CiAgICAgICAgICAgIHBheW91dCA9IGVudHJpZXNbaW5kZXhdLnBheW91dCAvIDEgZmlubmV5OwogICAgICAgICAgICBwYWlkID0gZW50cmllc1tpbmRleF0ucGFpZDsKICAgICAgICAgICAgaW5mbyA9ICdFbnRyeSBpbmZvOiBkb25rZXkgYWRkcmVzcywgbmFtZSwgZGVwb3NpdCwgZXhwZWN0ZWQgcGF5b3V0IGluIEZpbm5leXMsIHBheW91dCBzdGF0dXMuJzsKICAgICAgICB9CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGRvbmtleVJhbmtpbmcodWludCBpbmRleCkgY29uc3RhbnQgcmV0dXJucyhhZGRyZXNzIGRvbmtleSwgc3RyaW5nIG5pY2tuYW1lLCB1aW50IHRvdGFsSW52ZXN0ZWQsIHN0cmluZyBpbmZvKQogICAgewogICAgICAgIGlmIChpbmRleCA8IHJhbmtpbmcubGVuZ3RoKQogICAgICAgIHsKICAgICAgICAgICAgZG9ua2V5ID0gcmFua2luZ1tpbmRleF0uYWRkcjsKICAgICAgICAgICAgbmlja25hbWUgPSBkb25rZXlzW3JhbmtpbmdbaW5kZXhdLmFkZHJdLm5pY2tuYW1lOwogICAgICAgICAgICB0b3RhbEludmVzdGVkID0gZG9ua2V5c1tyYW5raW5nW2luZGV4XS5hZGRyXS5pbnZlc3RlZCAvIDEgZXRoZXI7CiAgICAgICAgICAgIGluZm8gPSAnVG9wIGRvbmtleSBzdGF0czogYWRkcmVzcywgbmFtZSwgZXRoZXJzIGRlcG9zaXRlZC4gTG93ZXIgaW5kZXggbnVtYmVyIG1lYW5zIGhpZ2hlciByYW5rLic7CiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jdGlvbiBkb25rZXlJbnZlc3RlZChhZGRyZXNzIGRvbmtleSkgY29uc3RhbnQgcmV0dXJucyh1aW50IGludmVzdGVkLCBzdHJpbmcgaW5mbykgewogICAgICAgIGludmVzdGVkID0gZG9ua2V5c1tkb25rZXldLmFkZHIgIT0gYWRkcmVzcygweDApID8gZG9ua2V5c1tkb25rZXldLmludmVzdGVkIC8gMSBldGhlciA6IDA7CiAgICAgICAgaW5mbyA9ICdUaGUgYW1vdW50IG9mIEV0aGVycyB0aGUgZG9ua2V5IGhhcyBjaGFzZWQgY2Fycm90cyB3aXRoLic7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHRvdGFsSW52ZXN0ZWQoKSBjb25zdGFudCByZXR1cm5zKHVpbnQgaW52ZXN0ZWQsIHN0cmluZyBpbmZvKSB7CiAgICAgICAgaW52ZXN0ZWQgPSBkb25rZXlzSW52ZXN0ZWQgLyAxIGV0aGVyOwogICAgICAgIGluZm8gPSAnVGhlIGNvbWJpbmVkIGludmVzdG1lbnRzIG9mIGFsbCBkb25rZXlzIGluIEV0aGVycy4nOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBjdXJyZW50RGVwb3NpdExpbWl0KCkgY29uc3RhbnQgcmV0dXJucyh1aW50IGV0aGVycywgc3RyaW5nIGluZm8pIHsKICAgICAgICBldGhlcnMgPSBtYXhEZXBvc2l0OwogICAgICAgIGluZm8gPSAnVGhlIGN1cnJlbnQgbWF4aW11bSBudW1iZXIgb2YgRXRoZXJzIHlvdSBtYXkgZGVwb3NpdCBhdCBvbmNlLic7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGRvbmtleXNFbGlnaWJsZUZvckZlZXMoKSBjb25zdGFudCByZXR1cm5zKHVpbnQgdG9wLCBzdHJpbmcgaW5mbykgewogICAgICAgIHRvcCA9IGVsaWdpYmxlRm9yRmVlczsKICAgICAgICBpbmZvID0gJ1RoZSBudW1iZXIgb2YgZG9ua2V5cyBpbiB0aGUgcmFua2luZyB0aGF0IGFyZSBlbGlnaWJsZSB0byByZWNlaXZlIGZlZXMuJzsKICAgIH0KICAgIAp9'.
	

]
