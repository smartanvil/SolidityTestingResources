Class {
	#name : #SRT4e9547d1a1154ee0451f063c253ad8dc39d5384c,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT4e9547d1a1154ee0451f063c253ad8dc39d5384c >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKCi8qKgogKiBAdGl0bGUgRVJDMjBCYXNpYwogKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE3OQogKi8KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLiAKICovCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgLyoqCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLiAKICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgKi8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKfQoKCi8qKgogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKi8KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIFN0YW5kYXJkIEVSQzIwIHRva2VuCiAqCiAqIEBkZXYgSW1wbGVtZW50YXRpb24gb2YgdGhlIGJhc2ljIHN0YW5kYXJkIHRva2VuLgogKiBAZGV2IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgRmlyc3RCbG9vZDogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sCiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwoKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdXQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICB2YXIgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOwoKICAgIC8vIENoZWNrIGlzIG5vdCBuZWVkZWQgYmVjYXVzZSBzdWIoX2FsbG93YW5jZSwgX3ZhbHVlKSB3aWxsIGFscmVhZHkgdGhyb3cgaWYgdGhpcyBjb25kaXRpb24gaXMgbm90IG1ldAogICAgLy8gcmVxdWlyZSAoX3ZhbHVlIDw9IF9hbGxvd2FuY2UpOwoKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBfYWxsb3dhbmNlLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CgogICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2AKICAgIC8vICBhbGxvd2FuY2UgdG8gemVybyBieSBjYWxsaW5nIGBhcHByb3ZlKF9zcGVuZGVyLCAwKWAgaWYgaXQgaXMgbm90CiAgICAvLyAgYWxyZWFkeSAwIHRvIG1pdGlnYXRlIHRoZSByYWNlIGNvbmRpdGlvbiBkZXNjcmliZWQgaGVyZToKICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgcmVxdWlyZSgoX3ZhbHVlID09IDApIHx8IChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9PSAwKSk7CgogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQp9CgoKLy8gTWlncmF0aW9uIEFnZW50IGludGVyZmFjZQpjb250cmFjdCBNaWdyYXRpb25BZ2VudCB7CiAgICBmdW5jdGlvbiBtaWdyYXRlRnJvbShhZGRyZXNzIF9mcm9tLCB1aW50IF92YWx1ZSk7Cn0KCmNvbnRyYWN0IEdWVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiB7CiAgICAKICAgIC8vIENvbnN0YW50cwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIkdlbmVzaXMgVmlzaW9uIFRva2VuIjsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIkdWVCI7CiAgICB1aW50ICAgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CiAgICB1aW50ICAgY29uc3RhbnQgVE9LRU5fTElNSVQgPSA0NCAqIDFlNiAqIDFlMTg7IAogICAgCiAgICBhZGRyZXNzIHB1YmxpYyBpY287CgogICAgLy8gR1ZUIHRyYW5zZmVycyBhcmUgYmxvY2tlZCB1bnRpbCBJQ08gaXMgZmluaXNoZWQuCiAgICBib29sIHB1YmxpYyBpc0Zyb3plbiA9IHRydWU7CgogICAgLy8gVG9rZW4gbWlncmF0aW9uIHZhcmlhYmxlcwogICAgYWRkcmVzcyBwdWJsaWMgbWlncmF0aW9uTWFzdGVyOwogICAgYWRkcmVzcyBwdWJsaWMgbWlncmF0aW9uQWdlbnQ7CiAgICB1aW50IHB1YmxpYyB0b3RhbE1pZ3JhdGVkOwoKICAgIGV2ZW50IE1pZ3JhdGUoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50IF92YWx1ZSk7CgogICAgLy8gQ29uc3RydWN0b3IKICAgIGZ1bmN0aW9uIEdWVG9rZW4oYWRkcmVzcyBfaWNvLCBhZGRyZXNzIF9taWdyYXRpb25NYXN0ZXIpIHsKICAgICAgICByZXF1aXJlKF9pY28gIT0gMCk7CiAgICAgICAgcmVxdWlyZShfbWlncmF0aW9uTWFzdGVyICE9IDApOwogICAgICAgIGljbyA9IF9pY287CiAgICAgICAgbWlncmF0aW9uTWFzdGVyID0gX21pZ3JhdGlvbk1hc3RlcjsKICAgIH0KCiAgICAvLyBDcmVhdGUgdG9rZW5zCiAgICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgaG9sZGVyLCB1aW50IHZhbHVlKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGljbyk7CiAgICAgICAgcmVxdWlyZSh2YWx1ZSA+IDApOwogICAgICAgIHJlcXVpcmUodG90YWxTdXBwbHkgKyB2YWx1ZSA8PSBUT0tFTl9MSU1JVCk7CgogICAgICAgIGJhbGFuY2VzW2hvbGRlcl0gKz0gdmFsdWU7CiAgICAgICAgdG90YWxTdXBwbHkgKz0gdmFsdWU7CiAgICAgICAgVHJhbnNmZXIoMHgwLCBob2xkZXIsIHZhbHVlKTsKICAgIH0KCiAgICAvLyBBbGxvdyB0b2tlbiB0cmFuc2Zlci4KICAgIGZ1bmN0aW9uIHVuZnJlZXplKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBpY28pOwogICAgICAgIGlzRnJvemVuID0gZmFsc2U7CiAgICB9CgogICAgLy8gRVJDMjAgZnVuY3Rpb25zCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoIWlzRnJvemVuKTsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZSghaXNGcm96ZW4pOwogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoIWlzRnJvemVuKTsKICAgICAgICByZXR1cm4gc3VwZXIuYXBwcm92ZShfc3BlbmRlciwgX3ZhbHVlKTsKICAgIH0KCiAgICAvLyBUb2tlbiBtaWdyYXRpb24KICAgIGZ1bmN0aW9uIG1pZ3JhdGUodWludCB2YWx1ZSkgZXh0ZXJuYWwgewogICAgICAgIHJlcXVpcmUobWlncmF0aW9uQWdlbnQgIT0gMCk7CiAgICAgICAgcmVxdWlyZSh2YWx1ZSA+IDApOwogICAgICAgIHJlcXVpcmUodmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSB2YWx1ZTsKICAgICAgICB0b3RhbFN1cHBseSAtPSB2YWx1ZTsKICAgICAgICB0b3RhbE1pZ3JhdGVkICs9IHZhbHVlOwogICAgICAgIE1pZ3JhdGlvbkFnZW50KG1pZ3JhdGlvbkFnZW50KS5taWdyYXRlRnJvbShtc2cuc2VuZGVyLCB2YWx1ZSk7CiAgICAgICAgTWlncmF0ZShtc2cuc2VuZGVyLCBtaWdyYXRpb25BZ2VudCwgdmFsdWUpOwogICAgfQoKICAgIC8vIFNldCBhZGRyZXNzIG9mIG1pZ3JhdGlvbiBjb250cmFjdAogICAgZnVuY3Rpb24gc2V0TWlncmF0aW9uQWdlbnQoYWRkcmVzcyBfYWdlbnQpIGV4dGVybmFsIHsKICAgICAgICByZXF1aXJlKG1pZ3JhdGlvbkFnZW50ID09IDApOwogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBtaWdyYXRpb25NYXN0ZXIpOwogICAgICAgIG1pZ3JhdGlvbkFnZW50ID0gX2FnZW50OwogICAgfQoKICAgIGZ1bmN0aW9uIHNldE1pZ3JhdGlvbk1hc3RlcihhZGRyZXNzIF9tYXN0ZXIpIGV4dGVybmFsIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gbWlncmF0aW9uTWFzdGVyKTsKICAgICAgICByZXF1aXJlKF9tYXN0ZXIgIT0gMCk7CiAgICAgICAgbWlncmF0aW9uTWFzdGVyID0gX21hc3RlcjsKICAgIH0KfQoKY29udHJhY3QgR1ZPcHRpb25Ub2tlbiBpcyBTdGFuZGFyZFRva2VuIHsKICAgIAogICAgYWRkcmVzcyBwdWJsaWMgb3B0aW9uUHJvZ3JhbTsKCiAgICBzdHJpbmcgcHVibGljIG5hbWU7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsKICAgIHVpbnQgICBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKCiAgICB1aW50IFRPS0VOX0xJTUlUOwoKICAgIC8vIE1vZGlmaWVycwogICAgbW9kaWZpZXIgb3B0aW9uUHJvZ3JhbU9ubHkgeyByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3B0aW9uUHJvZ3JhbSk7IF87IH0KCiAgICAvLyBDb25zdHJ1Y3RvcgogICAgZnVuY3Rpb24gR1ZPcHRpb25Ub2tlbigKICAgICAgICBhZGRyZXNzIF9vcHRpb25Qcm9ncmFtLAogICAgICAgIHN0cmluZyBfbmFtZSwKICAgICAgICBzdHJpbmcgX3N5bWJvbCwKICAgICAgICB1aW50IF9UT0tFTl9MSU1JVAogICAgKSB7CiAgICAgICAgcmVxdWlyZShfb3B0aW9uUHJvZ3JhbSAhPSAwKTsgICAgICAgIAogICAgICAgIG9wdGlvblByb2dyYW0gPSBfb3B0aW9uUHJvZ3JhbTsKICAgICAgICBuYW1lID0gX25hbWU7CiAgICAgICAgc3ltYm9sID0gX3N5bWJvbDsKICAgICAgICBUT0tFTl9MSU1JVCA9IF9UT0tFTl9MSU1JVDsKICAgIH0KCiAgICAvLyBDcmVhdGUgdG9rZW5zCiAgICBmdW5jdGlvbiBidXlPcHRpb25zKGFkZHJlc3MgYnV5ZXIsIHVpbnQgdmFsdWUpIG9wdGlvblByb2dyYW1Pbmx5IHsKICAgICAgICByZXF1aXJlKHZhbHVlID4gMCk7CiAgICAgICAgcmVxdWlyZSh0b3RhbFN1cHBseSArIHZhbHVlIDw9IFRPS0VOX0xJTUlUKTsKCiAgICAgICAgYmFsYW5jZXNbYnV5ZXJdICs9IHZhbHVlOwogICAgICAgIHRvdGFsU3VwcGx5ICs9IHZhbHVlOwogICAgICAgIFRyYW5zZmVyKDB4MCwgYnV5ZXIsIHZhbHVlKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gcmVtYWluaW5nVG9rZW5zQ291bnQoKSByZXR1cm5zKHVpbnQpIHsKICAgICAgICByZXR1cm4gVE9LRU5fTElNSVQgLSB0b3RhbFN1cHBseTsKICAgIH0KICAgIAogICAgLy8gQnVybiBvcHRpb24gdG9rZW5zIGFmdGVyIGV4ZWN1dGlvbiBkdXJpbmcgSUNPCiAgICBmdW5jdGlvbiBleGVjdXRlT3B0aW9uKGFkZHJlc3MgYWRkciwgdWludCBvcHRpb25zQ291bnQpIAogICAgICAgIG9wdGlvblByb2dyYW1Pbmx5CiAgICAgICAgcmV0dXJucyAodWludCkgewogICAgICAgIGlmIChiYWxhbmNlc1thZGRyXSA8IG9wdGlvbnNDb3VudCkgewogICAgICAgICAgICBvcHRpb25zQ291bnQgPSBiYWxhbmNlc1thZGRyXTsKICAgICAgICB9CiAgICAgICAgaWYgKG9wdGlvbnNDb3VudCA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KCiAgICAgICAgYmFsYW5jZXNbYWRkcl0gLT0gb3B0aW9uc0NvdW50OwogICAgICAgIHRvdGFsU3VwcGx5IC09IG9wdGlvbnNDb3VudDsKCiAgICAgICAgcmV0dXJuIG9wdGlvbnNDb3VudDsKICAgIH0KfQoKY29udHJhY3QgR1ZPcHRpb25Qcm9ncmFtIHsKCiAgICAvLyBDb25zdGFudHMKICAgIHVpbnQgY29uc3RhbnQgb3B0aW9uMzBwZXJDZW50ID0gMjYgKiAxZTE2OyAvLyBHVk9UMzAgdG9rZW5zIHBlciB1c2QgY2VudCBkdXJpbmcgb3B0aW9uIHB1cmNoYXNlIAogICAgdWludCBjb25zdGFudCBvcHRpb24yMHBlckNlbnQgPSAyNCAqIDFlMTY7IC8vIEdWT1QyMCB0b2tlbnMgcGVyIHVzZCBjZW50IGR1cmluZyBvcHRpb24gcHVyY2hhc2UKICAgIHVpbnQgY29uc3RhbnQgb3B0aW9uMTBwZXJDZW50ID0gMjIgKiAxZTE2OyAvLyBHVk9UMTAgdG9rZW5zIHBlciB1c2QgY2VudCBkdXJpbmcgb3B0aW9uIHB1cmNoYXNlCiAgICB1aW50IGNvbnN0YW50IHRva2VuMzBwZXJDZW50ICA9IDEzNjg0MjEwNTI2MzE1ODAwOyAgLy8gR1ZUIHRva2VucyBwZXIgdXNkIGNlbnQgZHVyaW5nIGV4ZWN1dGlvbiBvZiBHVk9UMzAKICAgIHVpbnQgY29uc3RhbnQgdG9rZW4yMHBlckNlbnQgID0gMTI2MzE1Nzg5NDczNjg1MDA7ICAvLyBHVlQgdG9rZW5zIHBlciB1c2QgY2VudCBkdXJpbmcgZXhlY3V0aW9uIG9mIEdWT1QyMAogICAgdWludCBjb25zdGFudCB0b2tlbjEwcGVyQ2VudCAgPSAxMTU3ODk0NzM2ODQyMTEwMDsgIC8vIEdWVCB0b2tlbnMgcGVyIHVzZCBjZW50IGR1cmluZyBleGVjdXRpb24gb2YgR1ZPVDEwCgogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBvcHRpb24zMG5hbWUgPSAiMzAlIEdWT1QiOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBvcHRpb24yMG5hbWUgPSAiMjAlIEdWT1QiOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBvcHRpb24xMG5hbWUgPSAiMTAlIEdWT1QiOwoKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgb3B0aW9uMzBzeW1ib2wgPSAiR1ZPVDMwIjsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgb3B0aW9uMjBzeW1ib2wgPSAiR1ZPVDIwIjsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgb3B0aW9uMTBzeW1ib2wgPSAiR1ZPVDEwIjsKCiAgICB1aW50IGNvbnN0YW50IG9wdGlvbjMwX1RPS0VOX0xJTUlUID0gMjYgKiAxZTUgKiAxZTE4OwogICAgdWludCBjb25zdGFudCBvcHRpb24yMF9UT0tFTl9MSU1JVCA9IDM2ICogMWU1ICogMWUxODsKICAgIHVpbnQgY29uc3RhbnQgb3B0aW9uMTBfVE9LRU5fTElNSVQgPSA1NSAqIDFlNSAqIDFlMTg7CgogICAgLy8gRXZlbnRzCiAgICBldmVudCBCdXlPcHRpb25zKGFkZHJlc3MgYnV5ZXIsIHVpbnQgYW1vdW50LCBzdHJpbmcgdHgsIHVpbnQ4IG9wdGlvblR5cGUpOwogICAgZXZlbnQgRXhlY3V0ZU9wdGlvbnMoYWRkcmVzcyBidXllciwgdWludCBhbW91bnQsIHN0cmluZyB0eCwgdWludDggb3B0aW9uVHlwZSk7CgogICAgLy8gU3RhdGUgdmFyaWFibGVzCiAgICBhZGRyZXNzIHB1YmxpYyBndkFnZW50OyAvLyBwYXltZW50cyBib3QgYWNjb3VudAogICAgYWRkcmVzcyBwdWJsaWMgdGVhbTsgICAgLy8gdGVhbSBhY2NvdW50CiAgICBhZGRyZXNzIHB1YmxpYyBpY287ICAgICAKCiAgICBHVk9wdGlvblRva2VuIHB1YmxpYyBndk9wdGlvblRva2VuMzA7CiAgICBHVk9wdGlvblRva2VuIHB1YmxpYyBndk9wdGlvblRva2VuMjA7CiAgICBHVk9wdGlvblRva2VuIHB1YmxpYyBndk9wdGlvblRva2VuMTA7CgogICAgLy8gTW9kaWZpZXJzCiAgICBtb2RpZmllciBpY29Pbmx5IHsgcmVxdWlyZShtc2cuc2VuZGVyID09IGljbyk7IF87IH0KICAgIAogICAgLy8gQ29uc3RydWN0b3IKICAgIGZ1bmN0aW9uIEdWT3B0aW9uUHJvZ3JhbShhZGRyZXNzIF9pY28sIGFkZHJlc3MgX2d2QWdlbnQsIGFkZHJlc3MgX3RlYW0pIHsKICAgICAgICBndk9wdGlvblRva2VuMzAgPSBuZXcgR1ZPcHRpb25Ub2tlbih0aGlzLCBvcHRpb24zMG5hbWUsIG9wdGlvbjMwc3ltYm9sLCBvcHRpb24zMF9UT0tFTl9MSU1JVCk7CiAgICAgICAgZ3ZPcHRpb25Ub2tlbjIwID0gbmV3IEdWT3B0aW9uVG9rZW4odGhpcywgb3B0aW9uMjBuYW1lLCBvcHRpb24yMHN5bWJvbCwgb3B0aW9uMjBfVE9LRU5fTElNSVQpOwogICAgICAgIGd2T3B0aW9uVG9rZW4xMCA9IG5ldyBHVk9wdGlvblRva2VuKHRoaXMsIG9wdGlvbjEwbmFtZSwgb3B0aW9uMTBzeW1ib2wsIG9wdGlvbjEwX1RPS0VOX0xJTUlUKTsKICAgICAgICBndkFnZW50ID0gX2d2QWdlbnQ7CiAgICAgICAgdGVhbSA9IF90ZWFtOwogICAgICAgIGljbyA9IF9pY287CiAgICB9CgogICAgLy8gR2V0IHJlbWFpbmluZyB0b2tlbnMgZm9yIGFsbCB0eXBlcyBvZiBvcHRpb24gdG9rZW5zCiAgICBmdW5jdGlvbiBnZXRCYWxhbmNlKCkgcHVibGljIHJldHVybnMgKHVpbnQsIHVpbnQsIHVpbnQpIHsKICAgICAgICByZXR1cm4gKGd2T3B0aW9uVG9rZW4zMC5yZW1haW5pbmdUb2tlbnNDb3VudCgpLCBndk9wdGlvblRva2VuMjAucmVtYWluaW5nVG9rZW5zQ291bnQoKSwgZ3ZPcHRpb25Ub2tlbjEwLnJlbWFpbmluZ1Rva2Vuc0NvdW50KCkpOwogICAgfQoKICAgIC8vIEV4ZWN1dGUgb3B0aW9ucyBkdXJpbmcgdGhlIElDTyB0b2tlbiBwdXJjaGFzZS4gUHJpb3JpdHk6IEdWT1QzMCAtPiBHVk9UMjAgLT4gR1ZPVDEwCiAgICBmdW5jdGlvbiBleGVjdXRlT3B0aW9ucyhhZGRyZXNzIGJ1eWVyLCB1aW50IHVzZENlbnRzLCBzdHJpbmcgdHhIYXNoKSBpY29Pbmx5CiAgICAgICAgcmV0dXJucyAodWludCBleGVjdXRlZFRva2VucywgdWludCByZW1haW5pbmdDZW50cykgewogICAgICAgIHJlcXVpcmUodXNkQ2VudHMgPiAwKTsKCiAgICAgICAgKGV4ZWN1dGVkVG9rZW5zLCByZW1haW5pbmdDZW50cykgPSBleGVjdXRlSWZBdmFpbGFibGUoYnV5ZXIsIHVzZENlbnRzLCB0eEhhc2gsIGd2T3B0aW9uVG9rZW4zMCwgMCwgdG9rZW4zMHBlckNlbnQpOwogICAgICAgIGlmIChyZW1haW5pbmdDZW50cyA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiAoZXhlY3V0ZWRUb2tlbnMsIDApOwogICAgICAgIH0KCiAgICAgICAgdWludCBleGVjdXRlZDIwOwogICAgICAgIChleGVjdXRlZDIwLCByZW1haW5pbmdDZW50cykgPSBleGVjdXRlSWZBdmFpbGFibGUoYnV5ZXIsIHJlbWFpbmluZ0NlbnRzLCB0eEhhc2gsIGd2T3B0aW9uVG9rZW4yMCwgMSwgdG9rZW4yMHBlckNlbnQpOwogICAgICAgIGlmIChyZW1haW5pbmdDZW50cyA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiAoZXhlY3V0ZWRUb2tlbnMgKyBleGVjdXRlZDIwLCAwKTsKICAgICAgICB9CgogICAgICAgIHVpbnQgZXhlY3V0ZWQxMDsKICAgICAgICAoZXhlY3V0ZWQxMCwgcmVtYWluaW5nQ2VudHMpID0gZXhlY3V0ZUlmQXZhaWxhYmxlKGJ1eWVyLCByZW1haW5pbmdDZW50cywgdHhIYXNoLCBndk9wdGlvblRva2VuMTAsIDIsIHRva2VuMTBwZXJDZW50KTsKICAgICAgICAKICAgICAgICByZXR1cm4gKGV4ZWN1dGVkVG9rZW5zICsgZXhlY3V0ZWQyMCArIGV4ZWN1dGVkMTAsIHJlbWFpbmluZ0NlbnRzKTsKICAgIH0KCiAgICAvLyBCdXkgb3B0aW9uIHRva2Vucy4gUHJpb3JpdHk6IEdWT1QzMCAtPiBHVk9UMjAgLT4gR1ZPVDEwCiAgICBmdW5jdGlvbiBidXlPcHRpb25zKGFkZHJlc3MgYnV5ZXIsIHVpbnQgdXNkQ2VudHMsIHN0cmluZyB0eEhhc2gpIGljb09ubHkgewogICAgICAgIHJlcXVpcmUodXNkQ2VudHMgPiAwKTsKCiAgICAgICAgdmFyIHJlbWFpblVzZENlbnRzID0gYnV5SWZBdmFpbGFibGUoYnV5ZXIsIHVzZENlbnRzLCB0eEhhc2gsIGd2T3B0aW9uVG9rZW4zMCwgMCwgb3B0aW9uMzBwZXJDZW50KTsKICAgICAgICBpZiAocmVtYWluVXNkQ2VudHMgPT0gMCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICByZW1haW5Vc2RDZW50cyA9IGJ1eUlmQXZhaWxhYmxlKGJ1eWVyLCByZW1haW5Vc2RDZW50cywgdHhIYXNoLCBndk9wdGlvblRva2VuMjAsIDEsIG9wdGlvbjIwcGVyQ2VudCk7CiAgICAgICAgaWYgKHJlbWFpblVzZENlbnRzID09IDApIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgcmVtYWluVXNkQ2VudHMgPSBidXlJZkF2YWlsYWJsZShidXllciwgcmVtYWluVXNkQ2VudHMsIHR4SGFzaCwgZ3ZPcHRpb25Ub2tlbjEwLCAyLCBvcHRpb24xMHBlckNlbnQpOwogICAgfSAgIAoKICAgIC8vIFByaXZhdGUgZnVuY3Rpb25zCiAgICAKICAgIGZ1bmN0aW9uIGV4ZWN1dGVJZkF2YWlsYWJsZShhZGRyZXNzIGJ1eWVyLCB1aW50IHVzZENlbnRzLCBzdHJpbmcgdHhIYXNoLAogICAgICAgIEdWT3B0aW9uVG9rZW4gb3B0aW9uVG9rZW4sIHVpbnQ4IG9wdGlvblR5cGUsIHVpbnQgb3B0aW9uUGVyQ2VudCkKICAgICAgICBwcml2YXRlIHJldHVybnMgKHVpbnQgZXhlY3V0ZWRUb2tlbnMsIHVpbnQgcmVtYWluaW5nQ2VudHMpIHsKICAgICAgICAKICAgICAgICB2YXIgb3B0aW9uc0Ftb3VudCA9IHVzZENlbnRzICogb3B0aW9uUGVyQ2VudDsKICAgICAgICBleGVjdXRlZFRva2VucyA9IG9wdGlvblRva2VuLmV4ZWN1dGVPcHRpb24oYnV5ZXIsIG9wdGlvbnNBbW91bnQpOwogICAgICAgIHJlbWFpbmluZ0NlbnRzID0gdXNkQ2VudHMgLSAoZXhlY3V0ZWRUb2tlbnMgLyBvcHRpb25QZXJDZW50KTsKICAgICAgICBpZiAoZXhlY3V0ZWRUb2tlbnMgPiAwKSB7CiAgICAgICAgICAgIEV4ZWN1dGVPcHRpb25zKGJ1eWVyLCBleGVjdXRlZFRva2VucywgdHhIYXNoLCBvcHRpb25UeXBlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIChleGVjdXRlZFRva2VucywgcmVtYWluaW5nQ2VudHMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGJ1eUlmQXZhaWxhYmxlKGFkZHJlc3MgYnV5ZXIsIHVpbnQgdXNkQ2VudHMsIHN0cmluZyB0eEhhc2gsCiAgICAgICAgR1ZPcHRpb25Ub2tlbiBvcHRpb25Ub2tlbiwgdWludDggb3B0aW9uVHlwZSwgdWludCBvcHRpb25zUGVyQ2VudCkKICAgICAgICBwcml2YXRlIHJldHVybnMgKHVpbnQpIHsKICAgICAgICAKICAgICAgICB2YXIgYXZhaWxhYmxlVG9rZW5zID0gb3B0aW9uVG9rZW4ucmVtYWluaW5nVG9rZW5zQ291bnQoKTsgCiAgICAgICAgaWYgKGF2YWlsYWJsZVRva2VucyA+IDApIHsKICAgICAgICAgICAgdmFyIHRva2VucyA9IHVzZENlbnRzICogb3B0aW9uc1BlckNlbnQ7CiAgICAgICAgICAgIGlmKGF2YWlsYWJsZVRva2VucyA+PSB0b2tlbnMpIHsKICAgICAgICAgICAgICAgIG9wdGlvblRva2VuLmJ1eU9wdGlvbnMoYnV5ZXIsIHRva2Vucyk7CiAgICAgICAgICAgICAgICBCdXlPcHRpb25zKGJ1eWVyLCB0b2tlbnMsIHR4SGFzaCwgb3B0aW9uVHlwZSk7CiAgICAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIG9wdGlvblRva2VuLmJ1eU9wdGlvbnMoYnV5ZXIsIGF2YWlsYWJsZVRva2Vucyk7CiAgICAgICAgICAgICAgICBCdXlPcHRpb25zKGJ1eWVyLCBhdmFpbGFibGVUb2tlbnMsIHR4SGFzaCwgb3B0aW9uVHlwZSk7CiAgICAgICAgICAgICAgICByZXR1cm4gdXNkQ2VudHMgLSBhdmFpbGFibGVUb2tlbnMgLyBvcHRpb25zUGVyQ2VudDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gdXNkQ2VudHM7CiAgICB9Cn0KCmNvbnRyYWN0IEluaXRhYmxlIHsKICAgIGZ1bmN0aW9uIGluaXQoYWRkcmVzcyB0b2tlbik7Cn0KCi8vIENyb3dkZnVuZGluZyBjb2RlIGZvciBHZW5lc2lzIFZpc2lvbiBQcm9qZWN0CmNvbnRyYWN0IElDTyB7CgogICAgLy8gQ29uc3RhbnRzCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBUT0tFTlNfRk9SX1NBTEUgPSAzMyAqIDFlNiAqIDFlMTg7CgogICAgLy8gRXZlbnRzCiAgICBldmVudCBTdGFydE9wdGlvbnNTZWxsaW5nKCk7CiAgICBldmVudCBTdGFydElDT0Zvck9wdGlvbnNIb2xkZXJzKCk7CiAgICBldmVudCBSdW5JY28oKTsKICAgIGV2ZW50IFBhdXNlSWNvKCk7CiAgICBldmVudCBSZXN1bWVJY28oKTsKICAgIGV2ZW50IEZpbmlzaEljbygpOwoKICAgIGV2ZW50IEJ1eVRva2VucyhhZGRyZXNzIGJ1eWVyLCB1aW50IGFtb3VudCwgc3RyaW5nIHR4SGFzaCk7CgogICAgYWRkcmVzcyBwdWJsaWMgZ3ZBZ2VudDsgLy8gcGF5bWVudHMgYm90IGFjY291bnQKICAgIGFkZHJlc3MgcHVibGljIHRlYW07ICAgIC8vIHRlYW0gYWNjb3VudAoKICAgIEdWVG9rZW4gcHVibGljIGd2VG9rZW47CiAgICBHVk9wdGlvblByb2dyYW0gcHVibGljIG9wdGlvblByb2dyYW07CiAgICBJbml0YWJsZSBwdWJsaWMgdGVhbUFsbG9jYXRvcjsKICAgIGFkZHJlc3MgcHVibGljIG1pZ3JhdGlvbk1hc3RlcjsKCiAgICAvLyBNb2RpZmllcnMKICAgIG1vZGlmaWVyIHRlYW1Pbmx5IHsgcmVxdWlyZShtc2cuc2VuZGVyID09IHRlYW0pOyBfOyB9CiAgICBtb2RpZmllciBndkFnZW50T25seSB7IHJlcXVpcmUobXNnLnNlbmRlciA9PSBndkFnZW50KTsgXzsgfQoKICAgIC8vIEN1cnJlbnQgdG90YWwgdG9rZW4gc3VwcGx5CiAgICB1aW50IHRva2Vuc1NvbGQgPSAwOwoKICAgIGJvb2wgcHVibGljIGlzUGF1c2VkID0gZmFsc2U7CiAgICBlbnVtIEljb1N0YXRlIHsgQ3JlYXRlZCwgUnVubmluZ09wdGlvbnNTZWxsaW5nLCBSdW5uaW5nRm9yT3B0aW9uc0hvbGRlcnMsIFJ1bm5pbmcsIEZpbmlzaGVkIH0KICAgIEljb1N0YXRlIHB1YmxpYyBpY29TdGF0ZSA9IEljb1N0YXRlLkNyZWF0ZWQ7CgogICAgLy8gQ29uc3RydWN0b3IKICAgIGZ1bmN0aW9uIElDTyhhZGRyZXNzIF90ZWFtLCBhZGRyZXNzIF9ndkFnZW50LCBhZGRyZXNzIF9taWdyYXRpb25NYXN0ZXIsIGFkZHJlc3MgX3RlYW1BbGxvY2F0b3IpIHsKICAgICAgICBndkFnZW50ID0gX2d2QWdlbnQ7CiAgICAgICAgdGVhbSA9IF90ZWFtOwogICAgICAgIHRlYW1BbGxvY2F0b3IgPSBJbml0YWJsZShfdGVhbUFsbG9jYXRvcik7CiAgICAgICAgbWlncmF0aW9uTWFzdGVyID0gX21pZ3JhdGlvbk1hc3RlcjsKICAgICAgICBndlRva2VuID0gbmV3IEdWVG9rZW4odGhpcywgbWlncmF0aW9uTWFzdGVyKTsKICAgIH0KCiAgICAvLyBJbml0aWFsaXplIE9wdGlvbiBQcm9ncmFtIGNvbnRyYWN0CiAgICBmdW5jdGlvbiBpbml0T3B0aW9uUHJvZ3JhbSgpIGV4dGVybmFsIHRlYW1Pbmx5IHsKICAgICAgICBpZiAob3B0aW9uUHJvZ3JhbSA9PSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIG9wdGlvblByb2dyYW0gPSBuZXcgR1ZPcHRpb25Qcm9ncmFtKHRoaXMsIGd2QWdlbnQsIHRlYW0pOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBJQ08gYW5kIE9wdGlvbiBQcm9ncmFtIHN0YXRlIG1hbmFnZW1lbnQKICAgIGZ1bmN0aW9uIHN0YXJ0T3B0aW9uc1NlbGxpbmcoKSBleHRlcm5hbCB0ZWFtT25seSB7CiAgICAgICAgcmVxdWlyZShpY29TdGF0ZSA9PSBJY29TdGF0ZS5DcmVhdGVkKTsKICAgICAgICAvLyBDaGVjayBpZiBPcHRpb24gUHJvZ3JhbSBpcyBpbml0aWFsaXplZAogICAgICAgIHJlcXVpcmUob3B0aW9uUHJvZ3JhbSAhPSBhZGRyZXNzKDApKTsgICAgCiAgICAgICAgaWNvU3RhdGUgPSBJY29TdGF0ZS5SdW5uaW5nT3B0aW9uc1NlbGxpbmc7CiAgICAgICAgU3RhcnRPcHRpb25zU2VsbGluZygpOwogICAgfQoKICAgIC8vIEZpbmlzaCBvcHRpb25zIHNlbGxpbmcgYW5kIHN0YXJ0IElDTyBmb3IgdGhlIG9wdGlvbiBob2xkZXJzCiAgICBmdW5jdGlvbiBzdGFydEljb0Zvck9wdGlvbnNIb2xkZXJzKCkgZXh0ZXJuYWwgdGVhbU9ubHkgewogICAgICAgIHJlcXVpcmUoaWNvU3RhdGUgPT0gSWNvU3RhdGUuUnVubmluZ09wdGlvbnNTZWxsaW5nKTsgICAgICAgCiAgICAgICAgaWNvU3RhdGUgPSBJY29TdGF0ZS5SdW5uaW5nRm9yT3B0aW9uc0hvbGRlcnM7CiAgICAgICAgU3RhcnRJQ09Gb3JPcHRpb25zSG9sZGVycygpOwogICAgfQoKICAgIGZ1bmN0aW9uIHN0YXJ0SWNvKCkgZXh0ZXJuYWwgdGVhbU9ubHkgewogICAgICAgIHJlcXVpcmUoaWNvU3RhdGUgPT0gSWNvU3RhdGUuUnVubmluZ0Zvck9wdGlvbnNIb2xkZXJzKTsKICAgICAgICBpY29TdGF0ZSA9IEljb1N0YXRlLlJ1bm5pbmc7CiAgICAgICAgUnVuSWNvKCk7CiAgICB9CgogICAgZnVuY3Rpb24gcGF1c2VJY28oKSBleHRlcm5hbCB0ZWFtT25seSB7CiAgICAgICAgcmVxdWlyZSghaXNQYXVzZWQpOwogICAgICAgIHJlcXVpcmUoaWNvU3RhdGUgPT0gSWNvU3RhdGUuUnVubmluZyB8fCBpY29TdGF0ZSA9PSBJY29TdGF0ZS5SdW5uaW5nRm9yT3B0aW9uc0hvbGRlcnMgfHwgaWNvU3RhdGUgPT0gSWNvU3RhdGUuUnVubmluZ09wdGlvbnNTZWxsaW5nKTsKICAgICAgICBpc1BhdXNlZCA9IHRydWU7CiAgICAgICAgUGF1c2VJY28oKTsKICAgIH0KCiAgICBmdW5jdGlvbiByZXN1bWVJY28oKSBleHRlcm5hbCB0ZWFtT25seSB7CiAgICAgICAgcmVxdWlyZShpc1BhdXNlZCk7CiAgICAgICAgcmVxdWlyZShpY29TdGF0ZSA9PSBJY29TdGF0ZS5SdW5uaW5nIHx8IGljb1N0YXRlID09IEljb1N0YXRlLlJ1bm5pbmdGb3JPcHRpb25zSG9sZGVycyB8fCBpY29TdGF0ZSA9PSBJY29TdGF0ZS5SdW5uaW5nT3B0aW9uc1NlbGxpbmcpOwogICAgICAgIGlzUGF1c2VkID0gZmFsc2U7CiAgICAgICAgUmVzdW1lSWNvKCk7CiAgICB9CgogICAgZnVuY3Rpb24gZmluaXNoSWNvKGFkZHJlc3MgX2Z1bmQsIGFkZHJlc3MgX2JvdW50eSkgZXh0ZXJuYWwgdGVhbU9ubHkgewogICAgICAgIHJlcXVpcmUoaWNvU3RhdGUgPT0gSWNvU3RhdGUuUnVubmluZyk7CiAgICAgICAgaWNvU3RhdGUgPSBJY29TdGF0ZS5GaW5pc2hlZDsKCiAgICAgICAgdWludCBtaW50ZWRUb2tlbnMgPSBndlRva2VuLnRvdGFsU3VwcGx5KCk7CiAgICAgICAgaWYgKG1pbnRlZFRva2VucyA+IDApIHsKICAgICAgICAgICAgdWludCB0b3RhbEFtb3VudCA9IG1pbnRlZFRva2VucyAqIDQgLyAzOyAgICAgICAgICAgICAgLy8gNzUlIG9mIHRvdGFsIHRva2VucyBhcmUgZm9yIHNhbGUsIGdldCAxMDAlCiAgICAgICAgICAgIGd2VG9rZW4ubWludCh0ZWFtQWxsb2NhdG9yLCAxMSAqIHRvdGFsQW1vdW50IC8gMTAwKTsgIC8vIDExJSBmb3IgdGVhbSB0byB0aGUgdGltZS1sb2NrZWQgd2FsbGV0CiAgICAgICAgICAgIGd2VG9rZW4ubWludChfZnVuZCwgdG90YWxBbW91bnQgLyAyMCk7ICAgICAgICAgICAgICAgIC8vIDUlIGZvciBHZW5lc2lzIFZpc2lvbiBmdW5kCiAgICAgICAgICAgIGd2VG9rZW4ubWludChfYm91bnR5LCA5ICogdG90YWxBbW91bnQgLyAxMDApOyAgICAgICAgIC8vIDklIGZvciBBZHZpc2VycywgTWFya2V0aW5nLCBCb3VudHkKICAgICAgICAgICAgZ3ZUb2tlbi51bmZyZWV6ZSgpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBGaW5pc2hJY28oKTsKICAgIH0gICAgCgogICAgLy8gQnV5IEdWVCB3aXRob3V0IG9wdGlvbnMKICAgIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJ1eWVyLCB1aW50IHVzZENlbnRzLCBzdHJpbmcgdHhIYXNoKQogICAgICAgIGV4dGVybmFsIGd2QWdlbnRPbmx5IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXF1aXJlKGljb1N0YXRlID09IEljb1N0YXRlLlJ1bm5pbmcpOwogICAgICAgIHJlcXVpcmUoIWlzUGF1c2VkKTsKICAgICAgICByZXR1cm4gYnV5VG9rZW5zSW50ZXJuYWwoYnV5ZXIsIHVzZENlbnRzLCB0eEhhc2gpOwogICAgfQoKICAgIC8vIEJ1eSBHVlQgZm9yIG9wdGlvbiBob2xkZXJzLiBBdCBmaXJzdCBidXkgR1ZUIHdpdGggb3B0aW9uIGV4ZWN1dGlvbiwgdGhlbiBidXkgR1ZUIGluIHJlZ3VsYXIgd2F5IGlmIElDTyBpcyBydW5uaW5nCiAgICBmdW5jdGlvbiBidXlUb2tlbnNCeU9wdGlvbnMoYWRkcmVzcyBidXllciwgdWludCB1c2RDZW50cywgc3RyaW5nIHR4SGFzaCkKICAgICAgICBleHRlcm5hbCBndkFnZW50T25seSByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmVxdWlyZSghaXNQYXVzZWQpOwogICAgICAgIHJlcXVpcmUoaWNvU3RhdGUgPT0gSWNvU3RhdGUuUnVubmluZyB8fCBpY29TdGF0ZSA9PSBJY29TdGF0ZS5SdW5uaW5nRm9yT3B0aW9uc0hvbGRlcnMpOwogICAgICAgIHJlcXVpcmUodXNkQ2VudHMgPiAwKTsKCiAgICAgICAgdWludCBleGVjdXRlZFRva2VuczsgCiAgICAgICAgdWludCByZW1haW5pbmdDZW50czsKICAgICAgICAvLyBFeGVjdXRlIG9wdGlvbnMKICAgICAgICAoZXhlY3V0ZWRUb2tlbnMsIHJlbWFpbmluZ0NlbnRzKSA9IG9wdGlvblByb2dyYW0uZXhlY3V0ZU9wdGlvbnMoYnV5ZXIsIHVzZENlbnRzLCB0eEhhc2gpOwoKICAgICAgICBpZiAoZXhlY3V0ZWRUb2tlbnMgPiAwKSB7CiAgICAgICAgICAgIHJlcXVpcmUodG9rZW5zU29sZCArIGV4ZWN1dGVkVG9rZW5zIDw9IFRPS0VOU19GT1JfU0FMRSk7CiAgICAgICAgICAgIHRva2Vuc1NvbGQgKz0gZXhlY3V0ZWRUb2tlbnM7CiAgICAgICAgICAgIAogICAgICAgICAgICBndlRva2VuLm1pbnQoYnV5ZXIsIGV4ZWN1dGVkVG9rZW5zKTsKICAgICAgICAgICAgQnV5VG9rZW5zKGJ1eWVyLCBleGVjdXRlZFRva2VucywgdHhIYXNoKTsKICAgICAgICB9CgogICAgICAgIC8vQnV5IEdWVCBmb3IgcmVtYWluaW5nIGNlbnRzIHdpdGhvdXQgb3B0aW9ucwogICAgICAgIGlmIChpY29TdGF0ZSA9PSBJY29TdGF0ZS5SdW5uaW5nKSB7CiAgICAgICAgICAgIHJldHVybiBidXlUb2tlbnNJbnRlcm5hbChidXllciwgcmVtYWluaW5nQ2VudHMsIHR4SGFzaCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIHJlbWFpbmluZ0NlbnRzOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBCdXkgR1ZPVCBkdXJpbmcgdGhlIE9wdGlvbiBQcm9ncmFtCiAgICBmdW5jdGlvbiBidXlPcHRpb25zKGFkZHJlc3MgYnV5ZXIsIHVpbnQgdXNkQ2VudHMsIHN0cmluZyB0eEhhc2gpCiAgICAgICAgZXh0ZXJuYWwgZ3ZBZ2VudE9ubHkgewogICAgICAgIHJlcXVpcmUoIWlzUGF1c2VkKTsKICAgICAgICByZXF1aXJlKGljb1N0YXRlID09IEljb1N0YXRlLlJ1bm5pbmdPcHRpb25zU2VsbGluZyk7CiAgICAgICAgb3B0aW9uUHJvZ3JhbS5idXlPcHRpb25zKGJ1eWVyLCB1c2RDZW50cywgdHhIYXNoKTsKICAgIH0KCiAgICAvLyBJbnRlcm5hbCBidXkgR1ZUIHdpdGhvdXQgb3B0aW9ucwogICAgZnVuY3Rpb24gYnV5VG9rZW5zSW50ZXJuYWwoYWRkcmVzcyBidXllciwgdWludCB1c2RDZW50cywgc3RyaW5nIHR4SGFzaCkKICAgIHByaXZhdGUgcmV0dXJucyAodWludCkgewogICAgICAgIC8vSUNPIHN0YXRlIGlzIGNoZWNrZWQgaW4gZXh0ZXJuYWwgZnVuY3Rpb25zLCB3aGljaCBjYWxsIHRoaXMgZnVuY3Rpb24gICAgICAgIAogICAgICAgIHJlcXVpcmUodXNkQ2VudHMgPiAwKTsKICAgICAgICB1aW50IHRva2VucyA9IHVzZENlbnRzICogMWUxNjsKICAgICAgICByZXF1aXJlKHRva2Vuc1NvbGQgKyB0b2tlbnMgPD0gVE9LRU5TX0ZPUl9TQUxFKTsKICAgICAgICB0b2tlbnNTb2xkICs9IHRva2VuczsKICAgICAgICAgICAgCiAgICAgICAgZ3ZUb2tlbi5taW50KGJ1eWVyLCB0b2tlbnMpOwogICAgICAgIEJ1eVRva2VucyhidXllciwgdG9rZW5zLCB0eEhhc2gpOwoKICAgICAgICByZXR1cm4gMDsKICAgIH0KfQ=='.
	

]
