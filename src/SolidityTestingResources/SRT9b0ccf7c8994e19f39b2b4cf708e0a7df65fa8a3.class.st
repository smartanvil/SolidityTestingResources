Class {
	#name : #SRT9b0ccf7c8994e19f39b2b4cf708e0a7df65fa8a3,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT9b0ccf7c8994e19f39b2b4cf708e0a7df65fa8a3 >> base64 [
	^ 'Ly8gaGV2bTogZmxhdHRlbmVkIHNvdXJjZXMgb2Ygc3JjL3RvcC5zb2wKcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovLy8vLy8gbGliL2RzLWd1YXJkL2xpYi9kcy1hdXRoL3NyYy9hdXRoLnNvbAovLyBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQovLyBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQovLyB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcgovLyAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgoKLy8gVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCi8vIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCi8vIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKLy8gR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KCi8vIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCi8vIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgoKLyogcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7ICovCgpjb250cmFjdCBEU0F1dGhvcml0eSB7CiAgICBmdW5jdGlvbiBjYW5DYWxsKAogICAgICAgIGFkZHJlc3Mgc3JjLCBhZGRyZXNzIGRzdCwgYnl0ZXM0IHNpZwogICAgKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKfQoKY29udHJhY3QgRFNBdXRoRXZlbnRzIHsKICAgIGV2ZW50IExvZ1NldEF1dGhvcml0eSAoYWRkcmVzcyBpbmRleGVkIGF1dGhvcml0eSk7CiAgICBldmVudCBMb2dTZXRPd25lciAgICAgKGFkZHJlc3MgaW5kZXhlZCBvd25lcik7Cn0KCmNvbnRyYWN0IERTQXV0aCBpcyBEU0F1dGhFdmVudHMgewogICAgRFNBdXRob3JpdHkgIHB1YmxpYyAgYXV0aG9yaXR5OwogICAgYWRkcmVzcyAgICAgIHB1YmxpYyAgb3duZXI7CgogICAgZnVuY3Rpb24gRFNBdXRoKCkgcHVibGljIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgTG9nU2V0T3duZXIobXNnLnNlbmRlcik7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0T3duZXIoYWRkcmVzcyBvd25lcl8pCiAgICAgICAgcHVibGljCiAgICAgICAgYXV0aAogICAgewogICAgICAgIG93bmVyID0gb3duZXJfOwogICAgICAgIExvZ1NldE93bmVyKG93bmVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRBdXRob3JpdHkoRFNBdXRob3JpdHkgYXV0aG9yaXR5XykKICAgICAgICBwdWJsaWMKICAgICAgICBhdXRoCiAgICB7CiAgICAgICAgYXV0aG9yaXR5ID0gYXV0aG9yaXR5XzsKICAgICAgICBMb2dTZXRBdXRob3JpdHkoYXV0aG9yaXR5KTsKICAgIH0KCiAgICBtb2RpZmllciBhdXRoIHsKICAgICAgICByZXF1aXJlKGlzQXV0aG9yaXplZChtc2cuc2VuZGVyLCBtc2cuc2lnKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBpc0F1dGhvcml6ZWQoYWRkcmVzcyBzcmMsIGJ5dGVzNCBzaWcpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmIChzcmMgPT0gYWRkcmVzcyh0aGlzKSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgaWYgKHNyYyA9PSBvd25lcikgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgaWYgKGF1dGhvcml0eSA9PSBEU0F1dGhvcml0eSgwKSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGF1dGhvcml0eS5jYW5DYWxsKHNyYywgdGhpcywgc2lnKTsKICAgICAgICB9CiAgICB9Cn0KCi8vLy8vLyBsaWIvZHMtc3BlbGwvbGliL2RzLW5vdGUvc3JjL25vdGUuc29sCi8vLyBub3RlLnNvbCAtLSB0aGUgYG5vdGUnIG1vZGlmaWVyLCBmb3IgbG9nZ2luZyBjYWxscyBhcyBldmVudHMKCi8vIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5Ci8vIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5Ci8vIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCi8vIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgovLyBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKLy8gYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKLy8gTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQovLyBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgoKLy8gWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKLy8gYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0uICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCgovKiBwcmFnbWEgc29saWRpdHkgXjAuNC4xMzsgKi8KCmNvbnRyYWN0IERTTm90ZSB7CiAgICBldmVudCBMb2dOb3RlKAogICAgICAgIGJ5dGVzNCAgIGluZGV4ZWQgIHNpZywKICAgICAgICBhZGRyZXNzICBpbmRleGVkICBndXksCiAgICAgICAgYnl0ZXMzMiAgaW5kZXhlZCAgZm9vLAogICAgICAgIGJ5dGVzMzIgIGluZGV4ZWQgIGJhciwKICAgICAgICB1aW50ICAgICAgICAgICAgICB3YWQsCiAgICAgICAgYnl0ZXMgICAgICAgICAgICAgZmF4CiAgICApIGFub255bW91czsKCiAgICBtb2RpZmllciBub3RlIHsKICAgICAgICBieXRlczMyIGZvbzsKICAgICAgICBieXRlczMyIGJhcjsKCiAgICAgICAgYXNzZW1ibHkgewogICAgICAgICAgICBmb28gOj0gY2FsbGRhdGFsb2FkKDQpCiAgICAgICAgICAgIGJhciA6PSBjYWxsZGF0YWxvYWQoMzYpCiAgICAgICAgfQoKICAgICAgICBMb2dOb3RlKG1zZy5zaWcsIG1zZy5zZW5kZXIsIGZvbywgYmFyLCBtc2cudmFsdWUsIG1zZy5kYXRhKTsKCiAgICAgICAgXzsKICAgIH0KfQoKLy8vLy8vIGxpYi9kcy10aGluZy9saWIvZHMtbWF0aC9zcmMvbWF0aC5zb2wKLy8vIG1hdGguc29sIC0tIG1peGluIGZvciBpbmxpbmUgbnVtZXJpY2FsIHdpemFyZHJ5CgovLyBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQovLyBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQovLyB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcgovLyAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgoKLy8gVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCi8vIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCi8vIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKLy8gR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KCi8vIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCi8vIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgoKLyogcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7ICovCgpjb250cmFjdCBEU01hdGggewogICAgZnVuY3Rpb24gYWRkKHVpbnQgeCwgdWludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHJlcXVpcmUoKHogPSB4ICsgeSkgPj0geCk7CiAgICB9CiAgICBmdW5jdGlvbiBzdWIodWludCB4LCB1aW50IHkpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCB6KSB7CiAgICAgICAgcmVxdWlyZSgoeiA9IHggLSB5KSA8PSB4KTsKICAgIH0KICAgIGZ1bmN0aW9uIG11bCh1aW50IHgsIHVpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICByZXF1aXJlKHkgPT0gMCB8fCAoeiA9IHggKiB5KSAvIHkgPT0geCk7CiAgICB9CgogICAgZnVuY3Rpb24gbWluKHVpbnQgeCwgdWludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHJldHVybiB4IDw9IHkgPyB4IDogeTsKICAgIH0KICAgIGZ1bmN0aW9uIG1heCh1aW50IHgsIHVpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICByZXR1cm4geCA+PSB5ID8geCA6IHk7CiAgICB9CiAgICBmdW5jdGlvbiBpbWluKGludCB4LCBpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChpbnQgeikgewogICAgICAgIHJldHVybiB4IDw9IHkgPyB4IDogeTsKICAgIH0KICAgIGZ1bmN0aW9uIGltYXgoaW50IHgsIGludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKGludCB6KSB7CiAgICAgICAgcmV0dXJuIHggPj0geSA/IHggOiB5OwogICAgfQoKICAgIHVpbnQgY29uc3RhbnQgV0FEID0gMTAgKiogMTg7CiAgICB1aW50IGNvbnN0YW50IFJBWSA9IDEwICoqIDI3OwoKICAgIGZ1bmN0aW9uIHdtdWwodWludCB4LCB1aW50IHkpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCB6KSB7CiAgICAgICAgeiA9IGFkZChtdWwoeCwgeSksIFdBRCAvIDIpIC8gV0FEOwogICAgfQogICAgZnVuY3Rpb24gcm11bCh1aW50IHgsIHVpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICB6ID0gYWRkKG11bCh4LCB5KSwgUkFZIC8gMikgLyBSQVk7CiAgICB9CiAgICBmdW5jdGlvbiB3ZGl2KHVpbnQgeCwgdWludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHogPSBhZGQobXVsKHgsIFdBRCksIHkgLyAyKSAvIHk7CiAgICB9CiAgICBmdW5jdGlvbiByZGl2KHVpbnQgeCwgdWludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHogPSBhZGQobXVsKHgsIFJBWSksIHkgLyAyKSAvIHk7CiAgICB9CgogICAgLy8gVGhpcyBmYW1vdXMgYWxnb3JpdGhtIGlzIGNhbGxlZCAiZXhwb25lbnRpYXRpb24gYnkgc3F1YXJpbmciCiAgICAvLyBhbmQgY2FsY3VsYXRlcyB4Xm4gd2l0aCB4IGFzIGZpeGVkLXBvaW50IGFuZCBuIGFzIHJlZ3VsYXIgdW5zaWduZWQuCiAgICAvLwogICAgLy8gSXQncyBPKGxvZyBuKSwgaW5zdGVhZCBvZiBPKG4pIGZvciBuYWl2ZSByZXBlYXRlZCBtdWx0aXBsaWNhdGlvbi4KICAgIC8vCiAgICAvLyBUaGVzZSBmYWN0cyBhcmUgd2h5IGl0IHdvcmtzOgogICAgLy8KICAgIC8vICBJZiBuIGlzIGV2ZW4sIHRoZW4geF5uID0gKHheMileKG4vMikuCiAgICAvLyAgSWYgbiBpcyBvZGQsICB0aGVuIHhebiA9IHggKiB4XihuLTEpLAogICAgLy8gICBhbmQgYXBwbHlpbmcgdGhlIGVxdWF0aW9uIGZvciBldmVuIHggZ2l2ZXMKICAgIC8vICAgIHhebiA9IHggKiAoeF4yKV4oKG4tMSkgLyAyKS4KICAgIC8vCiAgICAvLyAgQWxzbywgRVZNIGRpdmlzaW9uIGlzIGZsb29yaW5nIGFuZAogICAgLy8gICAgZmxvb3JbKG4tMSkgLyAyXSA9IGZsb29yW24gLyAyXS4KICAgIC8vCiAgICBmdW5jdGlvbiBycG93KHVpbnQgeCwgdWludCBuKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHogPSBuICUgMiAhPSAwID8geCA6IFJBWTsKCiAgICAgICAgZm9yIChuIC89IDI7IG4gIT0gMDsgbiAvPSAyKSB7CiAgICAgICAgICAgIHggPSBybXVsKHgsIHgpOwoKICAgICAgICAgICAgaWYgKG4gJSAyICE9IDApIHsKICAgICAgICAgICAgICAgIHogPSBybXVsKHosIHgpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgovLy8vLy8gbGliL2RzLXRoaW5nL3NyYy90aGluZy5zb2wKLy8gdGhpbmcuc29sIC0gYGF1dGhgIHdpdGggaGFuZHkgbWl4aW5zLiB5b3VyIHRoaW5ncyBzaG91bGQgYmUgRFNUaGluZ3MKCi8vIENvcHlyaWdodCAoQykgMjAxNyAgRGFwcEh1YiwgTExDCgovLyBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQovLyBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQovLyB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcgovLyAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgoKLy8gVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCi8vIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCi8vIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKLy8gR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KCi8vIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCi8vIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgoKLyogcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7ICovCgovKiBpbXBvcnQgJ2RzLWF1dGgvYXV0aC5zb2wnOyAqLwovKiBpbXBvcnQgJ2RzLW5vdGUvbm90ZS5zb2wnOyAqLwovKiBpbXBvcnQgJ2RzLW1hdGgvbWF0aC5zb2wnOyAqLwoKY29udHJhY3QgRFNUaGluZyBpcyBEU0F1dGgsIERTTm90ZSwgRFNNYXRoIHsKCiAgICBmdW5jdGlvbiBTKHN0cmluZyBzKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKGJ5dGVzNCkgewogICAgICAgIHJldHVybiBieXRlczQoa2VjY2FrMjU2KHMpKTsKICAgIH0KCn0KCi8vLy8vLyBsaWIvZHMtdG9rZW4vbGliL2RzLXN0b3Avc3JjL3N0b3Auc29sCi8vLyBzdG9wLnNvbCAtLSBtaXhpbiBmb3IgZW5hYmxlL2Rpc2FibGUgZnVuY3Rpb25hbGl0eQoKLy8gQ29weXJpZ2h0IChDKSAyMDE3ICBEYXBwSHViLCBMTEMKCi8vIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5Ci8vIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5Ci8vIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCi8vIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgovLyBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKLy8gYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKLy8gTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQovLyBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgoKLy8gWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKLy8gYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0uICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCgovKiBwcmFnbWEgc29saWRpdHkgXjAuNC4xMzsgKi8KCi8qIGltcG9ydCAiZHMtYXV0aC9hdXRoLnNvbCI7ICovCi8qIGltcG9ydCAiZHMtbm90ZS9ub3RlLnNvbCI7ICovCgpjb250cmFjdCBEU1N0b3AgaXMgRFNOb3RlLCBEU0F1dGggewoKICAgIGJvb2wgcHVibGljIHN0b3BwZWQ7CgogICAgbW9kaWZpZXIgc3RvcHBhYmxlIHsKICAgICAgICByZXF1aXJlKCFzdG9wcGVkKTsKICAgICAgICBfOwogICAgfQogICAgZnVuY3Rpb24gc3RvcCgpIHB1YmxpYyBhdXRoIG5vdGUgewogICAgICAgIHN0b3BwZWQgPSB0cnVlOwogICAgfQogICAgZnVuY3Rpb24gc3RhcnQoKSBwdWJsaWMgYXV0aCBub3RlIHsKICAgICAgICBzdG9wcGVkID0gZmFsc2U7CiAgICB9Cgp9CgovLy8vLy8gbGliL2RzLXRva2VuL2xpYi9lcmMyMC9zcmMvZXJjMjAuc29sCi8vLyBlcmMyMC5zb2wgLS0gQVBJIGZvciB0aGUgRVJDMjAgdG9rZW4gc3RhbmRhcmQKCi8vIFNlZSA8aHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwPi4KCi8vIFRoaXMgZmlsZSBsaWtlbHkgZG9lcyBub3QgbWVldCB0aGUgdGhyZXNob2xkIG9mIG9yaWdpbmFsaXR5Ci8vIHJlcXVpcmVkIGZvciBjb3B5cmlnaHQgdG8gYXBwbHkuICBBcyBhIHJlc3VsdCwgdGhpcyBpcyBmcmVlIGFuZAovLyB1bmVuY3VtYmVyZWQgc29mdHdhcmUgYmVsb25naW5nIHRvIHRoZSBwdWJsaWMgZG9tYWluLgoKLyogcHJhZ21hIHNvbGlkaXR5IF4wLjQuODsgKi8KCmNvbnRyYWN0IEVSQzIwRXZlbnRzIHsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBzcmMsIGFkZHJlc3MgaW5kZXhlZCBndXksIHVpbnQgd2FkKTsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBzcmMsIGFkZHJlc3MgaW5kZXhlZCBkc3QsIHVpbnQgd2FkKTsKfQoKY29udHJhY3QgRVJDMjAgaXMgRVJDMjBFdmVudHMgewogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIGd1eSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCk7CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBzcmMsIGFkZHJlc3MgZ3V5KSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KTsKCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgZ3V5LCB1aW50IHdhZCkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBkc3QsIHVpbnQgd2FkKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oCiAgICAgICAgYWRkcmVzcyBzcmMsIGFkZHJlc3MgZHN0LCB1aW50IHdhZAogICAgKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7Cn0KCi8vLy8vLyBsaWIvZHMtdG9rZW4vc3JjL2Jhc2Uuc29sCi8vLyBiYXNlLnNvbCAtLSBiYXNpYyBFUkMyMCBpbXBsZW1lbnRhdGlvbgoKLy8gQ29weXJpZ2h0IChDKSAyMDE1LCAyMDE2LCAyMDE3ICBEYXBwSHViLCBMTEMKCi8vIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5Ci8vIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5Ci8vIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCi8vIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgovLyBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKLy8gYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKLy8gTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQovLyBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgoKLy8gWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKLy8gYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0uICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCgovKiBwcmFnbWEgc29saWRpdHkgXjAuNC4xMzsgKi8KCi8qIGltcG9ydCAiZXJjMjAvZXJjMjAuc29sIjsgKi8KLyogaW1wb3J0ICJkcy1tYXRoL21hdGguc29sIjsgKi8KCmNvbnRyYWN0IERTVG9rZW5CYXNlIGlzIEVSQzIwLCBEU01hdGggewogICAgdWludDI1NiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3N1cHBseTsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgICAgICAgICAgICAgICAgICAgICAgIF9iYWxhbmNlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgIF9hcHByb3ZhbHM7CgogICAgZnVuY3Rpb24gRFNUb2tlbkJhc2UodWludCBzdXBwbHkpIHB1YmxpYyB7CiAgICAgICAgX2JhbGFuY2VzW21zZy5zZW5kZXJdID0gc3VwcGx5OwogICAgICAgIF9zdXBwbHkgPSBzdXBwbHk7CiAgICB9CgogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIF9zdXBwbHk7CiAgICB9CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBzcmMpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gX2JhbGFuY2VzW3NyY107CiAgICB9CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBzcmMsIGFkZHJlc3MgZ3V5KSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIF9hcHByb3ZhbHNbc3JjXVtndXldOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgZHN0LCB1aW50IHdhZCkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gdHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIGRzdCwgd2FkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBzcmMsIGFkZHJlc3MgZHN0LCB1aW50IHdhZCkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIGlmIChzcmMgIT0gbXNnLnNlbmRlcikgewogICAgICAgICAgICBfYXBwcm92YWxzW3NyY11bbXNnLnNlbmRlcl0gPSBzdWIoX2FwcHJvdmFsc1tzcmNdW21zZy5zZW5kZXJdLCB3YWQpOwogICAgICAgIH0KCiAgICAgICAgX2JhbGFuY2VzW3NyY10gPSBzdWIoX2JhbGFuY2VzW3NyY10sIHdhZCk7CiAgICAgICAgX2JhbGFuY2VzW2RzdF0gPSBhZGQoX2JhbGFuY2VzW2RzdF0sIHdhZCk7CgogICAgICAgIFRyYW5zZmVyKHNyYywgZHN0LCB3YWQpOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgZ3V5LCB1aW50IHdhZCkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBfYXBwcm92YWxzW21zZy5zZW5kZXJdW2d1eV0gPSB3YWQ7CgogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIGd1eSwgd2FkKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0KCi8vLy8vLyBsaWIvZHMtdG9rZW4vc3JjL3Rva2VuLnNvbAovLy8gdG9rZW4uc29sIC0tIEVSQzIwIGltcGxlbWVudGF0aW9uIHdpdGggbWludGluZyBhbmQgYnVybmluZwoKLy8gQ29weXJpZ2h0IChDKSAyMDE1LCAyMDE2LCAyMDE3ICBEYXBwSHViLCBMTEMKCi8vIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5Ci8vIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5Ci8vIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCi8vIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgovLyBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKLy8gYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKLy8gTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQovLyBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgoKLy8gWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKLy8gYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0uICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCgovKiBwcmFnbWEgc29saWRpdHkgXjAuNC4xMzsgKi8KCi8qIGltcG9ydCAiZHMtc3RvcC9zdG9wLnNvbCI7ICovCgovKiBpbXBvcnQgIi4vYmFzZS5zb2wiOyAqLwoKY29udHJhY3QgRFNUb2tlbiBpcyBEU1Rva2VuQmFzZSgwKSwgRFNTdG9wIHsKCiAgICBieXRlczMyICBwdWJsaWMgIHN5bWJvbDsKICAgIHVpbnQyNTYgIHB1YmxpYyAgZGVjaW1hbHMgPSAxODsgLy8gc3RhbmRhcmQgdG9rZW4gcHJlY2lzaW9uLiBvdmVycmlkZSB0byBjdXN0b21pemUKCiAgICBmdW5jdGlvbiBEU1Rva2VuKGJ5dGVzMzIgc3ltYm9sXykgcHVibGljIHsKICAgICAgICBzeW1ib2wgPSBzeW1ib2xfOwogICAgfQoKICAgIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIGd1eSwgdWludCB3YWQpOwogICAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgZ3V5LCB1aW50IHdhZCk7CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIGd1eSkgcHVibGljIHN0b3BwYWJsZSByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLmFwcHJvdmUoZ3V5LCB1aW50KC0xKSk7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIGd1eSwgdWludCB3YWQpIHB1YmxpYyBzdG9wcGFibGUgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci5hcHByb3ZlKGd1eSwgd2FkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBzcmMsIGFkZHJlc3MgZHN0LCB1aW50IHdhZCkKICAgICAgICBwdWJsaWMKICAgICAgICBzdG9wcGFibGUKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIGlmIChzcmMgIT0gbXNnLnNlbmRlciAmJiBfYXBwcm92YWxzW3NyY11bbXNnLnNlbmRlcl0gIT0gdWludCgtMSkpIHsKICAgICAgICAgICAgX2FwcHJvdmFsc1tzcmNdW21zZy5zZW5kZXJdID0gc3ViKF9hcHByb3ZhbHNbc3JjXVttc2cuc2VuZGVyXSwgd2FkKTsKICAgICAgICB9CgogICAgICAgIF9iYWxhbmNlc1tzcmNdID0gc3ViKF9iYWxhbmNlc1tzcmNdLCB3YWQpOwogICAgICAgIF9iYWxhbmNlc1tkc3RdID0gYWRkKF9iYWxhbmNlc1tkc3RdLCB3YWQpOwoKICAgICAgICBUcmFuc2ZlcihzcmMsIGRzdCwgd2FkKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gcHVzaChhZGRyZXNzIGRzdCwgdWludCB3YWQpIHB1YmxpYyB7CiAgICAgICAgdHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIGRzdCwgd2FkKTsKICAgIH0KICAgIGZ1bmN0aW9uIHB1bGwoYWRkcmVzcyBzcmMsIHVpbnQgd2FkKSBwdWJsaWMgewogICAgICAgIHRyYW5zZmVyRnJvbShzcmMsIG1zZy5zZW5kZXIsIHdhZCk7CiAgICB9CiAgICBmdW5jdGlvbiBtb3ZlKGFkZHJlc3Mgc3JjLCBhZGRyZXNzIGRzdCwgdWludCB3YWQpIHB1YmxpYyB7CiAgICAgICAgdHJhbnNmZXJGcm9tKHNyYywgZHN0LCB3YWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIG1pbnQodWludCB3YWQpIHB1YmxpYyB7CiAgICAgICAgbWludChtc2cuc2VuZGVyLCB3YWQpOwogICAgfQogICAgZnVuY3Rpb24gYnVybih1aW50IHdhZCkgcHVibGljIHsKICAgICAgICBidXJuKG1zZy5zZW5kZXIsIHdhZCk7CiAgICB9CiAgICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgZ3V5LCB1aW50IHdhZCkgcHVibGljIGF1dGggc3RvcHBhYmxlIHsKICAgICAgICBfYmFsYW5jZXNbZ3V5XSA9IGFkZChfYmFsYW5jZXNbZ3V5XSwgd2FkKTsKICAgICAgICBfc3VwcGx5ID0gYWRkKF9zdXBwbHksIHdhZCk7CiAgICAgICAgTWludChndXksIHdhZCk7CiAgICB9CiAgICBmdW5jdGlvbiBidXJuKGFkZHJlc3MgZ3V5LCB1aW50IHdhZCkgcHVibGljIGF1dGggc3RvcHBhYmxlIHsKICAgICAgICBpZiAoZ3V5ICE9IG1zZy5zZW5kZXIgJiYgX2FwcHJvdmFsc1tndXldW21zZy5zZW5kZXJdICE9IHVpbnQoLTEpKSB7CiAgICAgICAgICAgIF9hcHByb3ZhbHNbZ3V5XVttc2cuc2VuZGVyXSA9IHN1YihfYXBwcm92YWxzW2d1eV1bbXNnLnNlbmRlcl0sIHdhZCk7CiAgICAgICAgfQoKICAgICAgICBfYmFsYW5jZXNbZ3V5XSA9IHN1YihfYmFsYW5jZXNbZ3V5XSwgd2FkKTsKICAgICAgICBfc3VwcGx5ID0gc3ViKF9zdXBwbHksIHdhZCk7CiAgICAgICAgQnVybihndXksIHdhZCk7CiAgICB9CgogICAgLy8gT3B0aW9uYWwgdG9rZW4gbmFtZQogICAgYnl0ZXMzMiAgIHB1YmxpYyAgbmFtZSA9ICIiOwoKICAgIGZ1bmN0aW9uIHNldE5hbWUoYnl0ZXMzMiBuYW1lXykgcHVibGljIGF1dGggewogICAgICAgIG5hbWUgPSBuYW1lXzsKICAgIH0KfQoKLy8vLy8vIGxpYi9kcy12YWx1ZS9zcmMvdmFsdWUuc29sCi8vLyB2YWx1ZS5zb2wgLSBhIHZhbHVlIGlzIGEgc2ltcGxlIHRoaW5nLCBpdCBjYW4gYmUgZ2V0IGFuZCBzZXQKCi8vIENvcHlyaWdodCAoQykgMjAxNyAgRGFwcEh1YiwgTExDCgovLyBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQovLyBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQovLyB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcgovLyAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgoKLy8gVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCi8vIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCi8vIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKLy8gR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KCi8vIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCi8vIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgoKLyogcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7ICovCgovKiBpbXBvcnQgJ2RzLXRoaW5nL3RoaW5nLnNvbCc7ICovCgpjb250cmFjdCBEU1ZhbHVlIGlzIERTVGhpbmcgewogICAgYm9vbCAgICBoYXM7CiAgICBieXRlczMyIHZhbDsKICAgIGZ1bmN0aW9uIHBlZWsoKSBwdWJsaWMgdmlldyByZXR1cm5zIChieXRlczMyLCBib29sKSB7CiAgICAgICAgcmV0dXJuICh2YWwsaGFzKTsKICAgIH0KICAgIGZ1bmN0aW9uIHJlYWQoKSBwdWJsaWMgdmlldyByZXR1cm5zIChieXRlczMyKSB7CiAgICAgICAgdmFyICh3dXQsIGhheikgPSBwZWVrKCk7CiAgICAgICAgYXNzZXJ0KGhheik7CiAgICAgICAgcmV0dXJuIHd1dDsKICAgIH0KICAgIGZ1bmN0aW9uIHBva2UoYnl0ZXMzMiB3dXQpIHB1YmxpYyBub3RlIGF1dGggewogICAgICAgIHZhbCA9IHd1dDsKICAgICAgICBoYXMgPSB0cnVlOwogICAgfQogICAgZnVuY3Rpb24gdm9pZCgpIHB1YmxpYyBub3RlIGF1dGggeyAgLy8gdW5zZXQgdGhlIHZhbHVlCiAgICAgICAgaGFzID0gZmFsc2U7CiAgICB9Cn0KCi8vLy8vLyBzcmMvdm94LnNvbAovLy8gdm94LnNvbCAtLSB0YXJnZXQgcHJpY2UgZmVlZAoKLy8gQ29weXJpZ2h0IChDKSAyMDE2LCAyMDE3ICBOaWtvbGFpIE11c2hlZ2lhbiA8PHNwYW4gY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSI3NzE5MWUxYzE4MWIxNjFlMzcxMzE2MDcwNzFmMDIxNTU5MTQxODFhIj5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4KLy8gQ29weXJpZ2h0IChDKSAyMDE2LCAyMDE3ICBEYW5pZWwgQnJvY2ttYW4gPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iY2NhOGFkYTJhNWE5YTA4Y2E4YWRiY2JjYTRiOWFlZTJhZmEzYTEiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+PgovLyBDb3B5cmlnaHQgKEMpIDIwMTcgICAgICAgIFJhaW4gQnJlYWsgPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iN2MwZTFkMTUxMjFlMGUxOTFkMTczYzBlMTUwZjE5MDkwYzUyMTIxOTA4Ij5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4KCi8vIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5Ci8vIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5Ci8vIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCi8vIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgovLyBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKLy8gYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKLy8gTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQovLyBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgoKLy8gWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKLy8gYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0uICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCgovKiBwcmFnbWEgc29saWRpdHkgXjAuNC4xODsgKi8KCi8qIGltcG9ydCAiZHMtdGhpbmcvdGhpbmcuc29sIjsgKi8KCmNvbnRyYWN0IFNhaVZveCBpcyBEU1RoaW5nIHsKICAgIHVpbnQyNTYgIF9wYXI7CiAgICB1aW50MjU2ICBfd2F5OwoKICAgIHVpbnQyNTYgIHB1YmxpYyAgZml4OwogICAgdWludDI1NiAgcHVibGljICBob3c7CiAgICB1aW50MjU2ICBwdWJsaWMgIHRhdTsKCiAgICBmdW5jdGlvbiBTYWlWb3godWludCBwYXJfKSBwdWJsaWMgewogICAgICAgIF9wYXIgPSBmaXggPSBwYXJfOwogICAgICAgIF93YXkgPSBSQVk7CiAgICAgICAgdGF1ICA9IGVyYSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIGVyYSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gYmxvY2sudGltZXN0YW1wOwogICAgfQoKICAgIGZ1bmN0aW9uIG1vbGQoYnl0ZXMzMiBwYXJhbSwgdWludCB2YWwpIHB1YmxpYyBub3RlIGF1dGggewogICAgICAgIGlmIChwYXJhbSA9PSAnd2F5JykgX3dheSA9IHZhbDsKICAgIH0KCiAgICAvLyBEYWkgVGFyZ2V0IFByaWNlIChyZWYgcGVyIGRhaSkKICAgIGZ1bmN0aW9uIHBhcigpIHB1YmxpYyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcHJvZCgpOwogICAgICAgIHJldHVybiBfcGFyOwogICAgfQogICAgZnVuY3Rpb24gd2F5KCkgcHVibGljIHJldHVybnMgKHVpbnQpIHsKICAgICAgICBwcm9kKCk7CiAgICAgICAgcmV0dXJuIF93YXk7CiAgICB9CgogICAgZnVuY3Rpb24gdGVsbCh1aW50MjU2IHJheSkgcHVibGljIG5vdGUgYXV0aCB7CiAgICAgICAgZml4ID0gcmF5OwogICAgfQogICAgZnVuY3Rpb24gdHVuZSh1aW50MjU2IHJheSkgcHVibGljIG5vdGUgYXV0aCB7CiAgICAgICAgaG93ID0gcmF5OwogICAgfQoKICAgIGZ1bmN0aW9uIHByb2QoKSBwdWJsaWMgbm90ZSB7CiAgICAgICAgdmFyIGFnZSA9IGVyYSgpIC0gdGF1OwogICAgICAgIGlmIChhZ2UgPT0gMCkgcmV0dXJuOyAgLy8gb3B0aW1pc2VkCiAgICAgICAgdGF1ID0gZXJhKCk7CgogICAgICAgIGlmIChfd2F5ICE9IFJBWSkgX3BhciA9IHJtdWwoX3BhciwgcnBvdyhfd2F5LCBhZ2UpKTsgIC8vIG9wdGltaXNlZAoKICAgICAgICBpZiAoaG93ID09IDApIHJldHVybjsgIC8vIG9wdGltaXNlZAogICAgICAgIHZhciB3YWcgPSBpbnQxMjgoaG93ICogYWdlKTsKICAgICAgICBfd2F5ID0gaW5qKHByaihfd2F5KSArIChmaXggPCBfcGFyID8gd2FnIDogLXdhZykpOwogICAgfQoKICAgIGZ1bmN0aW9uIGluaihpbnQxMjggeCkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHggPj0gMCA/IHVpbnQyNTYoeCkgKyBSQVkKICAgICAgICAgICAgOiByZGl2KFJBWSwgUkFZICsgdWludDI1NigteCkpOwogICAgfQogICAgZnVuY3Rpb24gcHJqKHVpbnQyNTYgeCkgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChpbnQxMjgpIHsKICAgICAgICByZXR1cm4geCA+PSBSQVkgPyBpbnQxMjgoeCAtIFJBWSkKICAgICAgICAgICAgOiBpbnQxMjgoUkFZKSAtIGludDEyOChyZGl2KFJBWSwgeCkpOwogICAgfQp9CgovLy8vLy8gc3JjL3R1Yi5zb2wKLy8vIHR1Yi5zb2wgLS0gc2ltcGxpZmllZCBDRFAgZW5naW5lIChiYWJ5IGJyb3RoZXIgb2YgYHZhdCcpCgovLyBDb3B5cmlnaHQgKEMpIDIwMTcgIE5pa29sYWkgTXVzaGVnaWFuIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjkxZmZmOGZhZmVmZGYwZjhkMWY1ZjBlMWUxZjllNGYzYmZmMmZlZmMiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+PgovLyBDb3B5cmlnaHQgKEMpIDIwMTcgIERhbmllbCBCcm9ja21hbiA8PHNwYW4gY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSJjNGEwYTVhYWFkYTFhODg0YTBhNWI0YjRhY2IxYTZlYWE3YWJhOSI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+Ci8vIENvcHlyaWdodCAoQykgMjAxNyAgUmFpbiBCcmVhayA8PHNwYW4gY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSI4N2Y1ZTZlZWU5ZTVmNWUyZTZlY2M3ZjVlZWY0ZTJmMmY3YTllOWUyZjMiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+PgoKLy8gVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKLy8gaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKLy8gdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3IKLy8gKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KCi8vIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAovLyBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgovLyBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCi8vIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCgovLyBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQovLyBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KCi8qIHByYWdtYSBzb2xpZGl0eSBeMC40LjE4OyAqLwoKLyogaW1wb3J0ICJkcy10aGluZy90aGluZy5zb2wiOyAqLwovKiBpbXBvcnQgImRzLXRva2VuL3Rva2VuLnNvbCI7ICovCi8qIGltcG9ydCAiZHMtdmFsdWUvdmFsdWUuc29sIjsgKi8KCi8qIGltcG9ydCAiLi92b3guc29sIjsgKi8KCmNvbnRyYWN0IFNhaVR1YkV2ZW50cyB7CiAgICBldmVudCBMb2dOZXdDdXAoYWRkcmVzcyBpbmRleGVkIGxhZCwgYnl0ZXMzMiBjdXApOwp9Cgpjb250cmFjdCBTYWlUdWIgaXMgRFNUaGluZywgU2FpVHViRXZlbnRzIHsKICAgIERTVG9rZW4gIHB1YmxpYyAgc2FpOyAgLy8gU3RhYmxlY29pbgogICAgRFNUb2tlbiAgcHVibGljICBzaW47ICAvLyBEZWJ0IChuZWdhdGl2ZSBzYWkpCgogICAgRFNUb2tlbiAgcHVibGljICBza3I7ICAvLyBBYnN0cmFjdGVkIGNvbGxhdGVyYWwKICAgIEVSQzIwICAgIHB1YmxpYyAgZ2VtOyAgLy8gVW5kZXJseWluZyBjb2xsYXRlcmFsCgogICAgRFNUb2tlbiAgcHVibGljICBnb3Y7ICAvLyBHb3Zlcm5hbmNlIHRva2VuCgogICAgU2FpVm94ICAgcHVibGljICB2b3g7ICAvLyBUYXJnZXQgcHJpY2UgZmVlZAogICAgRFNWYWx1ZSAgcHVibGljICBwaXA7ICAvLyBSZWZlcmVuY2UgcHJpY2UgZmVlZAogICAgRFNWYWx1ZSAgcHVibGljICBwZXA7ICAvLyBHb3Zlcm5hbmNlIHByaWNlIGZlZWQKCiAgICBhZGRyZXNzICBwdWJsaWMgIHRhcDsgIC8vIExpcXVpZGF0b3IKICAgIGFkZHJlc3MgIHB1YmxpYyAgcGl0OyAgLy8gR292ZXJuYW5jZSBWYXVsdAoKICAgIHVpbnQyNTYgIHB1YmxpYyAgYXhlOyAgLy8gTGlxdWlkYXRpb24gcGVuYWx0eQogICAgdWludDI1NiAgcHVibGljICBjYXA7ICAvLyBEZWJ0IGNlaWxpbmcKICAgIHVpbnQyNTYgIHB1YmxpYyAgbWF0OyAgLy8gTGlxdWlkYXRpb24gcmF0aW8KICAgIHVpbnQyNTYgIHB1YmxpYyAgdGF4OyAgLy8gU3RhYmlsaXR5IGZlZQogICAgdWludDI1NiAgcHVibGljICBmZWU7ICAvLyBHb3Zlcm5hbmNlIGZlZQogICAgdWludDI1NiAgcHVibGljICBnYXA7ICAvLyBKb2luLUV4aXQgU3ByZWFkCgogICAgYm9vbCAgICAgcHVibGljICBvZmY7ICAvLyBDYWdlIGZsYWcKICAgIGJvb2wgICAgIHB1YmxpYyAgb3V0OyAgLy8gUG9zdCBjYWdlIGV4aXQKCiAgICB1aW50MjU2ICBwdWJsaWMgIGZpdDsgIC8vIFJFRiBwZXIgU0tSIChqdXN0IGJlZm9yZSBzZXR0bGVtZW50KQoKICAgIHVpbnQyNTYgIHB1YmxpYyAgcmhvOyAgLy8gVGltZSBvZiBsYXN0IGRyaXAKICAgIHVpbnQyNTYgICAgICAgICBfY2hpOyAgLy8gQWNjdW11bGF0ZWQgVGF4IFJhdGVzCiAgICB1aW50MjU2ICAgICAgICAgX3JoaTsgIC8vIEFjY3VtdWxhdGVkIFRheCArIEZlZSBSYXRlcwogICAgdWludDI1NiAgcHVibGljICBydW07ICAvLyBUb3RhbCBub3JtYWxpc2VkIGRlYnQKCiAgICB1aW50MjU2ICAgICAgICAgICAgICAgICAgIHB1YmxpYyAgY3VwaTsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gQ3VwKSAgcHVibGljICBjdXBzOwoKICAgIHN0cnVjdCBDdXAgewogICAgICAgIGFkZHJlc3MgIGxhZDsgICAgICAvLyBDRFAgb3duZXIKICAgICAgICB1aW50MjU2ICBpbms7ICAgICAgLy8gTG9ja2VkIGNvbGxhdGVyYWwgKGluIFNLUikKICAgICAgICB1aW50MjU2ICBhcnQ7ICAgICAgLy8gT3V0c3RhbmRpbmcgbm9ybWFsaXNlZCBkZWJ0ICh0YXggb25seSkKICAgICAgICB1aW50MjU2ICBpcmU7ICAgICAgLy8gT3V0c3RhbmRpbmcgbm9ybWFsaXNlZCBkZWJ0CiAgICB9CgogICAgZnVuY3Rpb24gbGFkKGJ5dGVzMzIgY3VwKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICAgICAgcmV0dXJuIGN1cHNbY3VwXS5sYWQ7CiAgICB9CiAgICBmdW5jdGlvbiBpbmsoYnl0ZXMzMiBjdXApIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gY3Vwc1tjdXBdLmluazsKICAgIH0KICAgIGZ1bmN0aW9uIHRhYihieXRlczMyIGN1cCkgcHVibGljIHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gcm11bChjdXBzW2N1cF0uYXJ0LCBjaGkoKSk7CiAgICB9CiAgICBmdW5jdGlvbiByYXAoYnl0ZXMzMiBjdXApIHB1YmxpYyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIHN1YihybXVsKGN1cHNbY3VwXS5pcmUsIHJoaSgpKSwgdGFiKGN1cCkpOwogICAgfQoKICAgIC8vIFRvdGFsIENEUCBEZWJ0CiAgICBmdW5jdGlvbiBkaW4oKSBwdWJsaWMgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBybXVsKHJ1bSwgY2hpKCkpOwogICAgfQogICAgLy8gQmFja2luZyBjb2xsYXRlcmFsCiAgICBmdW5jdGlvbiBhaXIoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIHNrci5iYWxhbmNlT2YodGhpcyk7CiAgICB9CiAgICAvLyBSYXcgY29sbGF0ZXJhbAogICAgZnVuY3Rpb24gcGllKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBnZW0uYmFsYW5jZU9mKHRoaXMpOwogICAgfQoKICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgZnVuY3Rpb24gU2FpVHViKAogICAgICAgIERTVG9rZW4gIHNhaV8sCiAgICAgICAgRFNUb2tlbiAgc2luXywKICAgICAgICBEU1Rva2VuICBza3JfLAogICAgICAgIEVSQzIwICAgIGdlbV8sCiAgICAgICAgRFNUb2tlbiAgZ292XywKICAgICAgICBEU1ZhbHVlICBwaXBfLAogICAgICAgIERTVmFsdWUgIHBlcF8sCiAgICAgICAgU2FpVm94ICAgdm94XywKICAgICAgICBhZGRyZXNzICBwaXRfCiAgICApIHB1YmxpYyB7CiAgICAgICAgZ2VtID0gZ2VtXzsKICAgICAgICBza3IgPSBza3JfOwoKICAgICAgICBzYWkgPSBzYWlfOwogICAgICAgIHNpbiA9IHNpbl87CgogICAgICAgIGdvdiA9IGdvdl87CiAgICAgICAgcGl0ID0gcGl0XzsKCiAgICAgICAgcGlwID0gcGlwXzsKICAgICAgICBwZXAgPSBwZXBfOwogICAgICAgIHZveCA9IHZveF87CgogICAgICAgIGF4ZSA9IFJBWTsKICAgICAgICBtYXQgPSBSQVk7CiAgICAgICAgdGF4ID0gUkFZOwogICAgICAgIGZlZSA9IFJBWTsKICAgICAgICBnYXAgPSBXQUQ7CgogICAgICAgIF9jaGkgPSBSQVk7CiAgICAgICAgX3JoaSA9IFJBWTsKCiAgICAgICAgcmhvID0gZXJhKCk7CiAgICB9CgogICAgZnVuY3Rpb24gZXJhKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gYmxvY2sudGltZXN0YW1wOwogICAgfQoKICAgIC8vLS1SaXNrLXBhcmFtZXRlci1jb25maWctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgZnVuY3Rpb24gbW9sZChieXRlczMyIHBhcmFtLCB1aW50IHZhbCkgcHVibGljIG5vdGUgYXV0aCB7CiAgICAgICAgaWYgICAgICAocGFyYW0gPT0gJ2NhcCcpIGNhcCA9IHZhbDsKICAgICAgICBlbHNlIGlmIChwYXJhbSA9PSAnbWF0JykgeyByZXF1aXJlKHZhbCA+PSBSQVkpOyBtYXQgPSB2YWw7IH0KICAgICAgICBlbHNlIGlmIChwYXJhbSA9PSAndGF4JykgeyByZXF1aXJlKHZhbCA+PSBSQVkpOyBkcmlwKCk7IHRheCA9IHZhbDsgfQogICAgICAgIGVsc2UgaWYgKHBhcmFtID09ICdmZWUnKSB7IHJlcXVpcmUodmFsID49IFJBWSk7IGRyaXAoKTsgZmVlID0gdmFsOyB9CiAgICAgICAgZWxzZSBpZiAocGFyYW0gPT0gJ2F4ZScpIHsgcmVxdWlyZSh2YWwgPj0gUkFZKTsgYXhlID0gdmFsOyB9CiAgICAgICAgZWxzZSBpZiAocGFyYW0gPT0gJ2dhcCcpIHsgcmVxdWlyZSh2YWwgPj0gV0FEKTsgZ2FwID0gdmFsOyB9CiAgICAgICAgZWxzZSByZXR1cm47CiAgICB9CgogICAgLy8tLVByaWNlLWZlZWQtc2V0dGVycy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBmdW5jdGlvbiBzZXRQaXAoRFNWYWx1ZSBwaXBfKSBwdWJsaWMgbm90ZSBhdXRoIHsKICAgICAgICBwaXAgPSBwaXBfOwogICAgfQogICAgZnVuY3Rpb24gc2V0UGVwKERTVmFsdWUgcGVwXykgcHVibGljIG5vdGUgYXV0aCB7CiAgICAgICAgcGVwID0gcGVwXzsKICAgIH0KICAgIGZ1bmN0aW9uIHNldFZveChTYWlWb3ggdm94XykgcHVibGljIG5vdGUgYXV0aCB7CiAgICAgICAgdm94ID0gdm94XzsKICAgIH0KCiAgICAvLy0tVGFwLXNldHRlci0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgZnVuY3Rpb24gdHVybihhZGRyZXNzIHRhcF8pIHB1YmxpYyBub3RlIHsKICAgICAgICByZXF1aXJlKHRhcCAgPT0gMCk7CiAgICAgICAgcmVxdWlyZSh0YXBfICE9IDApOwogICAgICAgIHRhcCA9IHRhcF87CiAgICB9CgogICAgLy8tLUNvbGxhdGVyYWwtd3JhcHBlci0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICAvLyBXcmFwcGVyIHJhdGlvIChnZW0gcGVyIHNrcikKICAgIGZ1bmN0aW9uIHBlcigpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQgcmF5KSB7CiAgICAgICAgcmV0dXJuIHNrci50b3RhbFN1cHBseSgpID09IDAgPyBSQVkgOiByZGl2KHBpZSgpLCBza3IudG90YWxTdXBwbHkoKSk7CiAgICB9CiAgICAvLyBKb2luIHByaWNlIChnZW0gcGVyIHNrcikKICAgIGZ1bmN0aW9uIGFzayh1aW50IHdhZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBybXVsKHdhZCwgd211bChwZXIoKSwgZ2FwKSk7CiAgICB9CiAgICAvLyBFeGl0IHByaWNlIChnZW0gcGVyIHNrcikKICAgIGZ1bmN0aW9uIGJpZCh1aW50IHdhZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBybXVsKHdhZCwgd211bChwZXIoKSwgc3ViKDIgKiBXQUQsIGdhcCkpKTsKICAgIH0KICAgIGZ1bmN0aW9uIGpvaW4odWludCB3YWQpIHB1YmxpYyBub3RlIHsKICAgICAgICByZXF1aXJlKCFvZmYpOwogICAgICAgIHJlcXVpcmUoYXNrKHdhZCkgPiAwKTsKICAgICAgICByZXF1aXJlKGdlbS50cmFuc2ZlckZyb20obXNnLnNlbmRlciwgdGhpcywgYXNrKHdhZCkpKTsKICAgICAgICBza3IubWludChtc2cuc2VuZGVyLCB3YWQpOwogICAgfQogICAgZnVuY3Rpb24gZXhpdCh1aW50IHdhZCkgcHVibGljIG5vdGUgewogICAgICAgIHJlcXVpcmUoIW9mZiB8fCBvdXQpOwogICAgICAgIHJlcXVpcmUoZ2VtLnRyYW5zZmVyKG1zZy5zZW5kZXIsIGJpZCh3YWQpKSk7CiAgICAgICAgc2tyLmJ1cm4obXNnLnNlbmRlciwgd2FkKTsKICAgIH0KCiAgICAvLy0tU3RhYmlsaXR5LWZlZS1hY2N1bXVsYXRpb24tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIC8vIEFjY3VtdWxhdGVkIFJhdGVzCiAgICBmdW5jdGlvbiBjaGkoKSBwdWJsaWMgcmV0dXJucyAodWludCkgewogICAgICAgIGRyaXAoKTsKICAgICAgICByZXR1cm4gX2NoaTsKICAgIH0KICAgIGZ1bmN0aW9uIHJoaSgpIHB1YmxpYyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgZHJpcCgpOwogICAgICAgIHJldHVybiBfcmhpOwogICAgfQogICAgZnVuY3Rpb24gZHJpcCgpIHB1YmxpYyBub3RlIHsKICAgICAgICBpZiAob2ZmKSByZXR1cm47CgogICAgICAgIHZhciByaG9fID0gZXJhKCk7CiAgICAgICAgdmFyIGFnZSA9IHJob18gLSByaG87CiAgICAgICAgaWYgKGFnZSA9PSAwKSByZXR1cm47ICAgIC8vIG9wdGltaXNlZAogICAgICAgIHJobyA9IHJob187CgogICAgICAgIHZhciBpbmMgPSBSQVk7CgogICAgICAgIGlmICh0YXggIT0gUkFZKSB7ICAvLyBvcHRpbWlzZWQKICAgICAgICAgICAgdmFyIF9jaGlfID0gX2NoaTsKICAgICAgICAgICAgaW5jID0gcnBvdyh0YXgsIGFnZSk7CiAgICAgICAgICAgIF9jaGkgPSBybXVsKF9jaGksIGluYyk7CiAgICAgICAgICAgIHNhaS5taW50KHRhcCwgcm11bChzdWIoX2NoaSwgX2NoaV8pLCBydW0pKTsKICAgICAgICB9CgogICAgICAgIC8vIG9wdGltaXNlZAogICAgICAgIGlmIChmZWUgIT0gUkFZKSBpbmMgPSBybXVsKGluYywgcnBvdyhmZWUsIGFnZSkpOwogICAgICAgIGlmIChpbmMgIT0gUkFZKSBfcmhpID0gcm11bChfcmhpLCBpbmMpOwogICAgfQoKCiAgICAvLy0tQ0RQLXJpc2staW5kaWNhdG9yLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIC8vIEFic3RyYWN0ZWQgY29sbGF0ZXJhbCBwcmljZSAocmVmIHBlciBza3IpCiAgICBmdW5jdGlvbiB0YWcoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50IHdhZCkgewogICAgICAgIHJldHVybiBvZmYgPyBmaXQgOiB3bXVsKHBlcigpLCB1aW50KHBpcC5yZWFkKCkpKTsKICAgIH0KICAgIC8vIFJldHVybnMgdHJ1ZSBpZiBjdXAgaXMgd2VsbC1jb2xsYXRlcmFsaXplZAogICAgZnVuY3Rpb24gc2FmZShieXRlczMyIGN1cCkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICB2YXIgcHJvID0gcm11bCh0YWcoKSwgaW5rKGN1cCkpOwogICAgICAgIHZhciBjb24gPSBybXVsKHZveC5wYXIoKSwgdGFiKGN1cCkpOwogICAgICAgIHZhciBtaW4gPSBybXVsKGNvbiwgbWF0KTsKICAgICAgICByZXR1cm4gcHJvID49IG1pbjsKICAgIH0KCgogICAgLy8tLUNEUC1vcGVyYXRpb25zLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBmdW5jdGlvbiBvcGVuKCkgcHVibGljIG5vdGUgcmV0dXJucyAoYnl0ZXMzMiBjdXApIHsKICAgICAgICByZXF1aXJlKCFvZmYpOwogICAgICAgIGN1cGkgPSBhZGQoY3VwaSwgMSk7CiAgICAgICAgY3VwID0gYnl0ZXMzMihjdXBpKTsKICAgICAgICBjdXBzW2N1cF0ubGFkID0gbXNnLnNlbmRlcjsKICAgICAgICBMb2dOZXdDdXAobXNnLnNlbmRlciwgY3VwKTsKICAgIH0KICAgIGZ1bmN0aW9uIGdpdmUoYnl0ZXMzMiBjdXAsIGFkZHJlc3MgZ3V5KSBwdWJsaWMgbm90ZSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGN1cHNbY3VwXS5sYWQpOwogICAgICAgIHJlcXVpcmUoZ3V5ICE9IDApOwogICAgICAgIGN1cHNbY3VwXS5sYWQgPSBndXk7CiAgICB9CgogICAgZnVuY3Rpb24gbG9jayhieXRlczMyIGN1cCwgdWludCB3YWQpIHB1YmxpYyBub3RlIHsKICAgICAgICByZXF1aXJlKCFvZmYpOwogICAgICAgIGN1cHNbY3VwXS5pbmsgPSBhZGQoY3Vwc1tjdXBdLmluaywgd2FkKTsKICAgICAgICBza3IucHVsbChtc2cuc2VuZGVyLCB3YWQpOwogICAgICAgIHJlcXVpcmUoY3Vwc1tjdXBdLmluayA9PSAwIHx8IGN1cHNbY3VwXS5pbmsgPiAwLjAwNSBldGhlcik7CiAgICB9CiAgICBmdW5jdGlvbiBmcmVlKGJ5dGVzMzIgY3VwLCB1aW50IHdhZCkgcHVibGljIG5vdGUgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjdXBzW2N1cF0ubGFkKTsKICAgICAgICBjdXBzW2N1cF0uaW5rID0gc3ViKGN1cHNbY3VwXS5pbmssIHdhZCk7CiAgICAgICAgc2tyLnB1c2gobXNnLnNlbmRlciwgd2FkKTsKICAgICAgICByZXF1aXJlKHNhZmUoY3VwKSk7CiAgICAgICAgcmVxdWlyZShjdXBzW2N1cF0uaW5rID09IDAgfHwgY3Vwc1tjdXBdLmluayA+IDAuMDA1IGV0aGVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkcmF3KGJ5dGVzMzIgY3VwLCB1aW50IHdhZCkgcHVibGljIG5vdGUgewogICAgICAgIHJlcXVpcmUoIW9mZik7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGN1cHNbY3VwXS5sYWQpOwogICAgICAgIHJlcXVpcmUocmRpdih3YWQsIGNoaSgpKSA+IDApOwoKICAgICAgICBjdXBzW2N1cF0uYXJ0ID0gYWRkKGN1cHNbY3VwXS5hcnQsIHJkaXYod2FkLCBjaGkoKSkpOwogICAgICAgIHJ1bSA9IGFkZChydW0sIHJkaXYod2FkLCBjaGkoKSkpOwoKICAgICAgICBjdXBzW2N1cF0uaXJlID0gYWRkKGN1cHNbY3VwXS5pcmUsIHJkaXYod2FkLCByaGkoKSkpOwogICAgICAgIHNhaS5taW50KGN1cHNbY3VwXS5sYWQsIHdhZCk7CgogICAgICAgIHJlcXVpcmUoc2FmZShjdXApKTsKICAgICAgICByZXF1aXJlKHNhaS50b3RhbFN1cHBseSgpIDw9IGNhcCk7CiAgICB9CiAgICBmdW5jdGlvbiB3aXBlKGJ5dGVzMzIgY3VwLCB1aW50IHdhZCkgcHVibGljIG5vdGUgewogICAgICAgIHJlcXVpcmUoIW9mZik7CgogICAgICAgIHZhciBvd2UgPSBybXVsKHdhZCwgcmRpdihyYXAoY3VwKSwgdGFiKGN1cCkpKTsKCiAgICAgICAgY3Vwc1tjdXBdLmFydCA9IHN1YihjdXBzW2N1cF0uYXJ0LCByZGl2KHdhZCwgY2hpKCkpKTsKICAgICAgICBydW0gPSBzdWIocnVtLCByZGl2KHdhZCwgY2hpKCkpKTsKCiAgICAgICAgY3Vwc1tjdXBdLmlyZSA9IHN1YihjdXBzW2N1cF0uaXJlLCByZGl2KGFkZCh3YWQsIG93ZSksIHJoaSgpKSk7CiAgICAgICAgc2FpLmJ1cm4obXNnLnNlbmRlciwgd2FkKTsKCiAgICAgICAgdmFyICh2YWwsIG9rKSA9IHBlcC5wZWVrKCk7CiAgICAgICAgaWYgKG9rICYmIHZhbCAhPSAwKSBnb3YubW92ZShtc2cuc2VuZGVyLCBwaXQsIHdkaXYob3dlLCB1aW50KHZhbCkpKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzaHV0KGJ5dGVzMzIgY3VwKSBwdWJsaWMgbm90ZSB7CiAgICAgICAgcmVxdWlyZSghb2ZmKTsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY3Vwc1tjdXBdLmxhZCk7CiAgICAgICAgaWYgKHRhYihjdXApICE9IDApIHdpcGUoY3VwLCB0YWIoY3VwKSk7CiAgICAgICAgaWYgKGluayhjdXApICE9IDApIGZyZWUoY3VwLCBpbmsoY3VwKSk7CiAgICAgICAgZGVsZXRlIGN1cHNbY3VwXTsKICAgIH0KCiAgICBmdW5jdGlvbiBiaXRlKGJ5dGVzMzIgY3VwKSBwdWJsaWMgbm90ZSB7CiAgICAgICAgcmVxdWlyZSghc2FmZShjdXApIHx8IG9mZik7CgogICAgICAgIC8vIFRha2Ugb24gYWxsIG9mIHRoZSBkZWJ0LCBleGNlcHQgdW5wYWlkIGZlZXMKICAgICAgICB2YXIgcnVlID0gdGFiKGN1cCk7CiAgICAgICAgc2luLm1pbnQodGFwLCBydWUpOwogICAgICAgIHJ1bSA9IHN1YihydW0sIGN1cHNbY3VwXS5hcnQpOwogICAgICAgIGN1cHNbY3VwXS5hcnQgPSAwOwogICAgICAgIGN1cHNbY3VwXS5pcmUgPSAwOwoKICAgICAgICAvLyBBbW91bnQgb3dlZCBpbiBTS1IsIGluY2x1ZGluZyBsaXF1aWRhdGlvbiBwZW5hbHR5CiAgICAgICAgdmFyIG93ZSA9IHJkaXYocm11bChybXVsKHJ1ZSwgYXhlKSwgdm94LnBhcigpKSwgdGFnKCkpOwoKICAgICAgICBpZiAob3dlID4gY3Vwc1tjdXBdLmluaykgewogICAgICAgICAgICBvd2UgPSBjdXBzW2N1cF0uaW5rOwogICAgICAgIH0KCiAgICAgICAgc2tyLnB1c2godGFwLCBvd2UpOwogICAgICAgIGN1cHNbY3VwXS5pbmsgPSBzdWIoY3Vwc1tjdXBdLmluaywgb3dlKTsKICAgIH0KCiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIGZ1bmN0aW9uIGNhZ2UodWludCBmaXRfLCB1aW50IGphbSkgcHVibGljIG5vdGUgYXV0aCB7CiAgICAgICAgcmVxdWlyZSghb2ZmICYmIGZpdF8gIT0gMCk7CiAgICAgICAgb2ZmID0gdHJ1ZTsKICAgICAgICBheGUgPSBSQVk7CiAgICAgICAgZ2FwID0gV0FEOwogICAgICAgIGZpdCA9IGZpdF87ICAgICAgICAgLy8gcmVmIHBlciBza3IKICAgICAgICByZXF1aXJlKGdlbS50cmFuc2Zlcih0YXAsIGphbSkpOwogICAgfQogICAgZnVuY3Rpb24gZmxvdygpIHB1YmxpYyBub3RlIGF1dGggewogICAgICAgIHJlcXVpcmUob2ZmKTsKICAgICAgICBvdXQgPSB0cnVlOwogICAgfQp9CgovLy8vLy8gc3JjL3RhcC5zb2wKLy8vIHRhcC5zb2wgLS0gbGlxdWlkYXRpb24gZW5naW5lIChzZWUgYWxzbyBgdm93YCkKCi8vIENvcHlyaWdodCAoQykgMjAxNyAgTmlrb2xhaSBNdXNoZWdpYW4gPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iM2M1MjU1NTc1MzUwNWQ1NTdjNTg1ZDRjNGM1NDQ5NWUxMjVmNTM1MSI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+Ci8vIENvcHlyaWdodCAoQykgMjAxNyAgRGFuaWVsIEJyb2NrbWFuIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9Ijg2ZTJlN2U4ZWZlM2VhYzZlMmU3ZjZmNmVlZjNlNGE4ZTVlOWViIj5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4KLy8gQ29weXJpZ2h0IChDKSAyMDE3ICBSYWluIEJyZWFrIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImNkYmZhY2E0YTNhZmJmYThhY2E2OGRiZmE0YmVhOGI4YmRlM2EzYThiOSI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+CgovLyBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQovLyBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQovLyB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcgovLyAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgoKLy8gVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCi8vIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCi8vIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKLy8gR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KCi8vIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCi8vIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgoKLyogcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7ICovCgovKiBpbXBvcnQgIi4vdHViLnNvbCI7ICovCgpjb250cmFjdCBTYWlUYXAgaXMgRFNUaGluZyB7CiAgICBEU1Rva2VuICBwdWJsaWMgIHNhaTsKICAgIERTVG9rZW4gIHB1YmxpYyAgc2luOwogICAgRFNUb2tlbiAgcHVibGljICBza3I7CgogICAgU2FpVm94ICAgcHVibGljICB2b3g7CiAgICBTYWlUdWIgICBwdWJsaWMgIHR1YjsKCiAgICB1aW50MjU2ICBwdWJsaWMgIGdhcDsgIC8vIEJvb20tQnVzdCBTcHJlYWQKICAgIGJvb2wgICAgIHB1YmxpYyAgb2ZmOyAgLy8gQ2FnZSBmbGFnCiAgICB1aW50MjU2ICBwdWJsaWMgIGZpeDsgIC8vIENhZ2UgcHJpY2UKCiAgICAvLyBTdXJwbHVzCiAgICBmdW5jdGlvbiBqb3koKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIHNhaS5iYWxhbmNlT2YodGhpcyk7CiAgICB9CiAgICAvLyBCYWQgZGVidAogICAgZnVuY3Rpb24gd29lKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBzaW4uYmFsYW5jZU9mKHRoaXMpOwogICAgfQogICAgLy8gQ29sbGF0ZXJhbCBwZW5kaW5nIGxpcXVpZGF0aW9uCiAgICBmdW5jdGlvbiBmb2coKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIHNrci5iYWxhbmNlT2YodGhpcyk7CiAgICB9CgoKICAgIGZ1bmN0aW9uIFNhaVRhcChTYWlUdWIgdHViXykgcHVibGljIHsKICAgICAgICB0dWIgPSB0dWJfOwoKICAgICAgICBzYWkgPSB0dWIuc2FpKCk7CiAgICAgICAgc2luID0gdHViLnNpbigpOwogICAgICAgIHNrciA9IHR1Yi5za3IoKTsKCiAgICAgICAgdm94ID0gdHViLnZveCgpOwoKICAgICAgICBnYXAgPSBXQUQ7CiAgICB9CgogICAgZnVuY3Rpb24gbW9sZChieXRlczMyIHBhcmFtLCB1aW50IHZhbCkgcHVibGljIG5vdGUgYXV0aCB7CiAgICAgICAgaWYgKHBhcmFtID09ICdnYXAnKSBnYXAgPSB2YWw7CiAgICB9CgogICAgLy8gQ2FuY2VsIGRlYnQKICAgIGZ1bmN0aW9uIGhlYWwoKSBwdWJsaWMgbm90ZSB7CiAgICAgICAgaWYgKGpveSgpID09IDAgfHwgd29lKCkgPT0gMCkgcmV0dXJuOyAgLy8gb3B0aW1pc2VkCiAgICAgICAgdmFyIHdhZCA9IG1pbihqb3koKSwgd29lKCkpOwogICAgICAgIHNhaS5idXJuKHdhZCk7CiAgICAgICAgc2luLmJ1cm4od2FkKTsKICAgIH0KCiAgICAvLyBGZWVkIHByaWNlIChzYWkgcGVyIHNrcikKICAgIGZ1bmN0aW9uIHMycygpIHB1YmxpYyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgdmFyIHRhZyA9IHR1Yi50YWcoKTsgICAgLy8gcmVmIHBlciBza3IKICAgICAgICB2YXIgcGFyID0gdm94LnBhcigpOyAgICAvLyByZWYgcGVyIHNhaQogICAgICAgIHJldHVybiByZGl2KHRhZywgcGFyKTsgIC8vIHNhaSBwZXIgc2tyCiAgICB9CiAgICAvLyBCb29tIHByaWNlIChzYWkgcGVyIHNrcikKICAgIGZ1bmN0aW9uIGJpZCh1aW50IHdhZCkgcHVibGljIHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gcm11bCh3YWQsIHdtdWwoczJzKCksIHN1YigyICogV0FELCBnYXApKSk7CiAgICB9CiAgICAvLyBCdXN0IHByaWNlIChzYWkgcGVyIHNrcikKICAgIGZ1bmN0aW9uIGFzayh1aW50IHdhZCkgcHVibGljIHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gcm11bCh3YWQsIHdtdWwoczJzKCksIGdhcCkpOwogICAgfQogICAgZnVuY3Rpb24gZmxpcCh1aW50IHdhZCkgaW50ZXJuYWwgewogICAgICAgIHJlcXVpcmUoYXNrKHdhZCkgPiAwKTsKICAgICAgICBza3IucHVzaChtc2cuc2VuZGVyLCB3YWQpOwogICAgICAgIHNhaS5wdWxsKG1zZy5zZW5kZXIsIGFzayh3YWQpKTsKICAgICAgICBoZWFsKCk7CiAgICB9CiAgICBmdW5jdGlvbiBmbG9wKHVpbnQgd2FkKSBpbnRlcm5hbCB7CiAgICAgICAgc2tyLm1pbnQoc3ViKHdhZCwgZm9nKCkpKTsKICAgICAgICBmbGlwKHdhZCk7CiAgICAgICAgcmVxdWlyZShqb3koKSA9PSAwKTsgIC8vIGNhbid0IGZsb3AgaW50byBzdXJwbHVzCiAgICB9CiAgICBmdW5jdGlvbiBmbGFwKHVpbnQgd2FkKSBpbnRlcm5hbCB7CiAgICAgICAgaGVhbCgpOwogICAgICAgIHNhaS5wdXNoKG1zZy5zZW5kZXIsIGJpZCh3YWQpKTsKICAgICAgICBza3IuYnVybihtc2cuc2VuZGVyLCB3YWQpOwogICAgfQogICAgZnVuY3Rpb24gYnVzdCh1aW50IHdhZCkgcHVibGljIG5vdGUgewogICAgICAgIHJlcXVpcmUoIW9mZik7CiAgICAgICAgaWYgKHdhZCA+IGZvZygpKSBmbG9wKHdhZCk7CiAgICAgICAgZWxzZSBmbGlwKHdhZCk7CiAgICB9CiAgICBmdW5jdGlvbiBib29tKHVpbnQgd2FkKSBwdWJsaWMgbm90ZSB7CiAgICAgICAgcmVxdWlyZSghb2ZmKTsKICAgICAgICBmbGFwKHdhZCk7CiAgICB9CgogICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBmdW5jdGlvbiBjYWdlKHVpbnQgZml4XykgcHVibGljIG5vdGUgYXV0aCB7CiAgICAgICAgcmVxdWlyZSghb2ZmKTsKICAgICAgICBvZmYgPSB0cnVlOwogICAgICAgIGZpeCA9IGZpeF87CiAgICB9CiAgICBmdW5jdGlvbiBjYXNoKHVpbnQgd2FkKSBwdWJsaWMgbm90ZSB7CiAgICAgICAgcmVxdWlyZShvZmYpOwogICAgICAgIHNhaS5idXJuKG1zZy5zZW5kZXIsIHdhZCk7CiAgICAgICAgcmVxdWlyZSh0dWIuZ2VtKCkudHJhbnNmZXIobXNnLnNlbmRlciwgcm11bCh3YWQsIGZpeCkpKTsKICAgIH0KICAgIGZ1bmN0aW9uIG1vY2sodWludCB3YWQpIHB1YmxpYyBub3RlIHsKICAgICAgICByZXF1aXJlKG9mZik7CiAgICAgICAgc2FpLm1pbnQobXNnLnNlbmRlciwgd2FkKTsKICAgICAgICByZXF1aXJlKHR1Yi5nZW0oKS50cmFuc2ZlckZyb20obXNnLnNlbmRlciwgdGhpcywgcm11bCh3YWQsIGZpeCkpKTsKICAgIH0KICAgIGZ1bmN0aW9uIHZlbnQoKSBwdWJsaWMgbm90ZSB7CiAgICAgICAgcmVxdWlyZShvZmYpOwogICAgICAgIHNrci5idXJuKGZvZygpKTsKICAgIH0KfQoKLy8vLy8vIHNyYy90b3Auc29sCi8vLyB0b3Auc29sIC0tIGdsb2JhbCBzZXR0bGVtZW50IG1hbmFnZXIKCi8vIENvcHlyaWdodCAoQykgMjAxNyAgTmlrb2xhaSBNdXNoZWdpYW4gPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iYzlhN2EwYTJhNmE1YThhMDg5YWRhOGI5YjlhMWJjYWJlN2FhYTZhNCI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+Ci8vIENvcHlyaWdodCAoQykgMjAxNyAgRGFuaWVsIEJyb2NrbWFuIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjRkMjkyYzIzMjQyODIxMGQyOTJjM2QzZDI1MzgyZjYzMmUyMjIwIj5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4KLy8gQ29weXJpZ2h0IChDKSAyMDE3ICBSYWluIEJyZWFrIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjgwZjJlMWU5ZWVlMmYyZTVlMWViYzBmMmU5ZjNlNWY1ZjBhZWVlZTVmNCI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+CgovLyBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQovLyBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQovLyB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcgovLyAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgoKLy8gVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCi8vIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCi8vIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKLy8gR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KCi8vIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCi8vIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgoKLyogcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7ICovCgovKiBpbXBvcnQgIi4vdHViLnNvbCI7ICovCi8qIGltcG9ydCAiLi90YXAuc29sIjsgKi8KCmNvbnRyYWN0IFNhaVRvcCBpcyBEU1RoaW5nIHsKICAgIFNhaVZveCAgIHB1YmxpYyAgdm94OwogICAgU2FpVHViICAgcHVibGljICB0dWI7CiAgICBTYWlUYXAgICBwdWJsaWMgIHRhcDsKCiAgICBEU1Rva2VuICBwdWJsaWMgIHNhaTsKICAgIERTVG9rZW4gIHB1YmxpYyAgc2luOwogICAgRFNUb2tlbiAgcHVibGljICBza3I7CiAgICBFUkMyMCAgICBwdWJsaWMgIGdlbTsKCiAgICB1aW50MjU2ICBwdWJsaWMgIGZpeDsgIC8vIHNhaSBjYWdlIHByaWNlIChnZW0gcGVyIHNhaSkKICAgIHVpbnQyNTYgIHB1YmxpYyAgZml0OyAgLy8gc2tyIGNhZ2UgcHJpY2UgKHJlZiBwZXIgc2tyKQogICAgdWludDI1NiAgcHVibGljICBjYWdlZDsKICAgIHVpbnQyNTYgIHB1YmxpYyAgY29vbGRvd24gPSA2IGhvdXJzOwoKICAgIGZ1bmN0aW9uIFNhaVRvcChTYWlUdWIgdHViXywgU2FpVGFwIHRhcF8pIHB1YmxpYyB7CiAgICAgICAgdHViID0gdHViXzsKICAgICAgICB0YXAgPSB0YXBfOwoKICAgICAgICB2b3ggPSB0dWIudm94KCk7CgogICAgICAgIHNhaSA9IHR1Yi5zYWkoKTsKICAgICAgICBzaW4gPSB0dWIuc2luKCk7CiAgICAgICAgc2tyID0gdHViLnNrcigpOwogICAgICAgIGdlbSA9IHR1Yi5nZW0oKTsKICAgIH0KCiAgICBmdW5jdGlvbiBlcmEoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIGJsb2NrLnRpbWVzdGFtcDsKICAgIH0KCiAgICAvLyBmb3JjZSBzZXR0bGVtZW50IG9mIHRoZSBzeXN0ZW0gYXQgYSBnaXZlbiBwcmljZSAoc2FpIHBlciBnZW0pLgogICAgLy8gVGhpcyBpcyBuZWFybHkgdGhlIGVxdWl2YWxlbnQgb2YgYml0aW5nIGFsbCBjdXBzIGF0IG9uY2UuCiAgICAvLyBJbXBvcnRhbnQgY29uc2lkZXJhdGlvbjogdGhlIGdlbXMgYXNzb2NpYXRlZCB3aXRoIGZyZWUgc2tyIGNhbgogICAgLy8gYmUgdGFwcGVkIHRvIG1ha2Ugc2FpIHdob2xlLgogICAgZnVuY3Rpb24gY2FnZSh1aW50IHByaWNlKSBpbnRlcm5hbCB7CiAgICAgICAgcmVxdWlyZSghdHViLm9mZigpICYmIHByaWNlICE9IDApOwogICAgICAgIGNhZ2VkID0gZXJhKCk7CgogICAgICAgIHR1Yi5kcmlwKCk7ICAvLyBjb2xsZWN0IHJlbWFpbmluZyBmZWVzCiAgICAgICAgdGFwLmhlYWwoKTsgIC8vIGFic29yYiBhbnkgcGVuZGluZyBmZWVzCgogICAgICAgIGZpdCA9IHJtdWwod211bChwcmljZSwgdm94LnBhcigpKSwgdHViLnBlcigpKTsKICAgICAgICAvLyBNb3N0IGdlbXMgd2UgY2FuIGdldCBwZXIgc2FpIGlzIHRoZSBmdWxsIGJhbGFuY2Ugb2YgdGhlIHR1Yi4KICAgICAgICAvLyBJZiB0aGVyZSBpcyBubyBzYWkgaXNzdWVkLCB3ZSBzaG91bGQgc3RpbGwgYmUgYWJsZSB0byBjYWdlLgogICAgICAgIGlmIChzYWkudG90YWxTdXBwbHkoKSA9PSAwKSB7CiAgICAgICAgICAgIGZpeCA9IHJkaXYoV0FELCBwcmljZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZml4ID0gbWluKHJkaXYoV0FELCBwcmljZSksIHJkaXYodHViLnBpZSgpLCBzYWkudG90YWxTdXBwbHkoKSkpOwogICAgICAgIH0KCiAgICAgICAgdHViLmNhZ2UoZml0LCBybXVsKGZpeCwgc2FpLnRvdGFsU3VwcGx5KCkpKTsKICAgICAgICB0YXAuY2FnZShmaXgpOwoKICAgICAgICB0YXAudmVudCgpOyAgICAvLyBidXJuIHBlbmRpbmcgc2FsZSBza3IKICAgIH0KICAgIC8vIGNhZ2UgYnkgcmVhZGluZyB0aGUgbGFzdCB2YWx1ZSBmcm9tIHRoZSBmZWVkIGZvciB0aGUgcHJpY2UKICAgIGZ1bmN0aW9uIGNhZ2UoKSBwdWJsaWMgbm90ZSBhdXRoIHsKICAgICAgICBjYWdlKHJkaXYodWludCh0dWIucGlwKCkucmVhZCgpKSwgdm94LnBhcigpKSk7CiAgICB9CgogICAgZnVuY3Rpb24gZmxvdygpIHB1YmxpYyBub3RlIHsKICAgICAgICByZXF1aXJlKHR1Yi5vZmYoKSk7CiAgICAgICAgdmFyIGVtcHR5ID0gdHViLmRpbigpID09IDAgJiYgdGFwLmZvZygpID09IDA7CiAgICAgICAgdmFyIGVuZGVkID0gZXJhKCkgPiBjYWdlZCArIGNvb2xkb3duOwogICAgICAgIHJlcXVpcmUoZW1wdHkgfHwgZW5kZWQpOwogICAgICAgIHR1Yi5mbG93KCk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0Q29vbGRvd24odWludCBjb29sZG93bl8pIHB1YmxpYyBhdXRoIHsKICAgICAgICBjb29sZG93biA9IGNvb2xkb3duXzsKICAgIH0KfQ=='.
	

]
