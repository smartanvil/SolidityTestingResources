Class {
	#name : #SRTc333228daab9bde8a3866efa3a9e616b7e1bae51,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTc333228daab9bde8a3866efa3a9e616b7e1bae51 >> base64 [
	^ 'LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KLyogQ29weXJpZ2h0IChjKSAyMDE4IFRoZSBldGhlci5vbmxpbmUgUHJvamVjdC4gIEFsbCByaWdodHMgcmVzZXJ2ZWQuCi8qIAovKiBodHRwczovL2V0aGVyLm9ubGluZSAgVGhlIGZpcnN0IFJQRyBnYW1lIG9mIGJsb2NrY2hhaW4gICAgICAgICAgICAgICAgIAovKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLwpwcmFnbWEgc29saWRpdHkgXjAuNC4yMDsKCi8vLyBAdGl0bGUgRVJDLTE2NSBTdGFuZGFyZCBJbnRlcmZhY2UgRGV0ZWN0aW9uCi8vLyBAZGV2IFNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9ibG9iL21hc3Rlci9FSVBTL2VpcC0xNjUubWQKaW50ZXJmYWNlIEVSQzE2NSB7CiAgICBmdW5jdGlvbiBzdXBwb3J0c0ludGVyZmFjZShieXRlczQgaW50ZXJmYWNlSUQpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCk7Cn0KCi8vLyBAdGl0bGUgRVJDLTcyMSBOb24tRnVuZ2libGUgVG9rZW4gU3RhbmRhcmQKLy8vIEBkZXYgU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2Jsb2IvbWFzdGVyL0VJUFMvZWlwLTcyMS5tZApjb250cmFjdCBFUkM3MjEgaXMgRVJDMTY1IHsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdG9rZW5JZCk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX2FwcHJvdmVkLCB1aW50MjU2IF90b2tlbklkKTsKICAgIGV2ZW50IEFwcHJvdmFsRm9yQWxsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfb3BlcmF0b3IsIGJvb2wgX2FwcHJvdmVkKTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQsIGJ5dGVzIGRhdGEpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gc2FmZVRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9hcHByb3ZlZCwgdWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBzZXRBcHByb3ZhbEZvckFsbChhZGRyZXNzIF9vcGVyYXRvciwgYm9vbCBfYXBwcm92ZWQpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gZ2V0QXBwcm92ZWQodWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIGlzQXBwcm92ZWRGb3JBbGwoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX29wZXJhdG9yKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpOwp9CgovLy8gQHRpdGxlIEVSQy03MjEgTm9uLUZ1bmdpYmxlIFRva2VuIFN0YW5kYXJkCmludGVyZmFjZSBFUkM3MjFUb2tlblJlY2VpdmVyIHsKCWZ1bmN0aW9uIG9uRVJDNzIxUmVjZWl2ZWQoYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdG9rZW5JZCwgYnl0ZXMgZGF0YSkgZXh0ZXJuYWwgcmV0dXJucyhieXRlczQpOwp9Cgpjb250cmFjdCBBY2Nlc3NBZG1pbiB7CiAgICBib29sIHB1YmxpYyBpc1BhdXNlZCA9IGZhbHNlOwogICAgYWRkcmVzcyBwdWJsaWMgYWRkckFkbWluOyAgCgogICAgZXZlbnQgQWRtaW5UcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJlQWRtaW4sIGFkZHJlc3MgaW5kZXhlZCBuZXdBZG1pbik7CgogICAgZnVuY3Rpb24gQWNjZXNzQWRtaW4oKSBwdWJsaWMgewogICAgICAgIGFkZHJBZG1pbiA9IG1zZy5zZW5kZXI7CiAgICB9ICAKCgogICAgbW9kaWZpZXIgb25seUFkbWluKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBhZGRyQWRtaW4pOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgd2hlbk5vdFBhdXNlZCgpIHsKICAgICAgICByZXF1aXJlKCFpc1BhdXNlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciB3aGVuUGF1c2VkIHsKICAgICAgICByZXF1aXJlKGlzUGF1c2VkKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEFkbWluKGFkZHJlc3MgX25ld0FkbWluKSBleHRlcm5hbCBvbmx5QWRtaW4gewogICAgICAgIHJlcXVpcmUoX25ld0FkbWluICE9IGFkZHJlc3MoMCkpOwogICAgICAgIEFkbWluVHJhbnNmZXJyZWQoYWRkckFkbWluLCBfbmV3QWRtaW4pOwogICAgICAgIGFkZHJBZG1pbiA9IF9uZXdBZG1pbjsKICAgIH0KCiAgICBmdW5jdGlvbiBkb1BhdXNlKCkgZXh0ZXJuYWwgb25seUFkbWluIHdoZW5Ob3RQYXVzZWQgewogICAgICAgIGlzUGF1c2VkID0gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBkb1VucGF1c2UoKSBleHRlcm5hbCBvbmx5QWRtaW4gd2hlblBhdXNlZCB7CiAgICAgICAgaXNQYXVzZWQgPSBmYWxzZTsKICAgIH0KfQoKY29udHJhY3QgQWNjZXNzU2VydmljZSBpcyBBY2Nlc3NBZG1pbiB7CiAgICBhZGRyZXNzIHB1YmxpYyBhZGRyU2VydmljZTsKICAgIGFkZHJlc3MgcHVibGljIGFkZHJGaW5hbmNlOwoKICAgIG1vZGlmaWVyIG9ubHlTZXJ2aWNlKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBhZGRyU2VydmljZSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5RmluYW5jZSgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYWRkckZpbmFuY2UpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gc2V0U2VydmljZShhZGRyZXNzIF9uZXdTZXJ2aWNlKSBleHRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkZHJTZXJ2aWNlIHx8IG1zZy5zZW5kZXIgPT0gYWRkckFkbWluKTsKICAgICAgICByZXF1aXJlKF9uZXdTZXJ2aWNlICE9IGFkZHJlc3MoMCkpOwogICAgICAgIGFkZHJTZXJ2aWNlID0gX25ld1NlcnZpY2U7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0RmluYW5jZShhZGRyZXNzIF9uZXdGaW5hbmNlKSBleHRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkZHJGaW5hbmNlIHx8IG1zZy5zZW5kZXIgPT0gYWRkckFkbWluKTsKICAgICAgICByZXF1aXJlKF9uZXdGaW5hbmNlICE9IGFkZHJlc3MoMCkpOwogICAgICAgIGFkZHJGaW5hbmNlID0gX25ld0ZpbmFuY2U7CiAgICB9Cn0KCmNvbnRyYWN0IFdhclRva2VuIGlzIEVSQzcyMSwgQWNjZXNzQWRtaW4gewogICAgLy8vIEBkZXYgVGhlIGVxdWlwbWVudCBpbmZvCiAgICBzdHJ1Y3QgRmFzaGlvbiB7CiAgICAgICAgdWludDE2IHByb3RvSWQ7ICAgICAvLyAwICBFcXVpcG1lbnQgSUQKICAgICAgICB1aW50MTYgcXVhbGl0eTsgICAgIC8vIDEgIFJhcml0eTogMSBDb2Fyc2UvMiBHb29kLzMgUmFyZS80IEVwaWMvNSBMZWdlbmRhcnkKICAgICAgICB1aW50MTYgcG9zOyAgICAgICAgIC8vIDIgIFNsb3RzOiAxIFdlYXBvbi8yIEhhdC8zIENsb3RoLzQgUGFudC81IFNob2VzLzkgUGV0cwogICAgICAgIHVpbnQxNiBoZWFsdGg7ICAgICAgLy8gMyAgSGVhbHRoCiAgICAgICAgdWludDE2IGF0a01pbjsgICAgICAvLyA0ICBNaW4gYXR0YWNrCiAgICAgICAgdWludDE2IGF0a01heDsgICAgICAvLyA1ICBNYXggYXR0YWNrCiAgICAgICAgdWludDE2IGRlZmVuY2U7ICAgICAvLyA2ICBEZWZlbm5zZQogICAgICAgIHVpbnQxNiBjcml0OyAgICAgICAgLy8gNyAgQ3JpdGljYWwgcmF0ZQogICAgICAgIHVpbnQxNiBpc1BlcmNlbnQ7ICAgLy8gOCAgQXR0ciB2YWx1ZSB0eXBlCiAgICAgICAgdWludDE2IGF0dHJFeHQxOyAgICAvLyA5ICBmdXR1cmUgc3RhdCAxCiAgICAgICAgdWludDE2IGF0dHJFeHQyOyAgICAvLyAxMCBmdXR1cmUgc3RhdCAyCiAgICAgICAgdWludDE2IGF0dHJFeHQzOyAgICAvLyAxMSBmdXR1cmUgc3RhdCAzCiAgICB9CgogICAgLy8vIEBkZXYgQWxsIGVxdWlwbWVudHMgdG9rZW5BcnJheSAobm90IGV4Y2VlZGluZyAyXjMyLTEpCiAgICBGYXNoaW9uW10gcHVibGljIGZhc2hpb25BcnJheTsKCiAgICAvLy8gQGRldiBBbW91bnQgb2YgdG9rZW5zIGRlc3Ryb3llZAogICAgdWludDI1NiBkZXN0cm95RmFzaGlvbkNvdW50OwoKICAgIC8vLyBAZGV2IEVxdWlwbWVudCB0b2tlbiBJRCB2cyBvd25lciBhZGRyZXNzCiAgICBtYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIGZhc2hpb25JZFRvT3duZXI7CgogICAgLy8vIEBkZXYgRXF1aXBtZW50cyBvd25lciBieSB0aGUgb3duZXIgKGFycmF5KQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2W10pIG93bmVyVG9GYXNoaW9uQXJyYXk7CgogICAgLy8vIEBkZXYgRXF1aXBtZW50IHRva2VuIElEIHNlYXJjaCBpbiBvd25lciBhcnJheQogICAgbWFwcGluZyAodWludDI1NiA9PiB1aW50MjU2KSBmYXNoaW9uSWRUb093bmVySW5kZXg7CgogICAgLy8vIEBkZXYgVGhlIGF1dGhvcml6ZWQgYWRkcmVzcyBmb3IgZWFjaCBXQVIKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgZmFzaGlvbklkVG9BcHByb3ZhbHM7CgogICAgLy8vIEBkZXYgVGhlIGF1dGhvcml6ZWQgb3BlcmF0b3JzIGZvciBlYWNoIGFkZHJlc3MKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSkgb3BlcmF0b3JUb0FwcHJvdmFsczsKCiAgICAvLy8gQGRldiBUcnVzdCBjb250cmFjdAogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBhY3Rpb25Db250cmFjdHM7CgogICAgZnVuY3Rpb24gc2V0QWN0aW9uQ29udHJhY3QoYWRkcmVzcyBfYWN0aW9uQWRkciwgYm9vbCBfdXNlZnVsKSBleHRlcm5hbCBvbmx5QWRtaW4gewogICAgICAgIGFjdGlvbkNvbnRyYWN0c1tfYWN0aW9uQWRkcl0gPSBfdXNlZnVsOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEFjdGlvbkNvbnRyYWN0KGFkZHJlc3MgX2FjdGlvbkFkZHIpIGV4dGVybmFsIHZpZXcgb25seUFkbWluIHJldHVybnMoYm9vbCkgewogICAgICAgIHJldHVybiBhY3Rpb25Db250cmFjdHNbX2FjdGlvbkFkZHJdOwogICAgfQoKICAgIC8vLyBAZGV2IFRoaXMgZW1pdHMgd2hlbiB0aGUgYXBwcm92ZWQgYWRkcmVzcyBmb3IgYW4gV0FSIGlzIGNoYW5nZWQgb3IgcmVhZmZpcm1lZC4KICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfYXBwcm92ZWQsIHVpbnQyNTYgX3Rva2VuSWQpOwoKICAgIC8vLyBAZGV2IFRoaXMgZW1pdHMgd2hlbiBhbiBvcGVyYXRvciBpcyBlbmFibGVkIG9yIGRpc2FibGVkIGZvciBhbiBvd25lci4KICAgIGV2ZW50IEFwcHJvdmFsRm9yQWxsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfb3BlcmF0b3IsIGJvb2wgX2FwcHJvdmVkKTsKCiAgICAvLy8gQGRldiBUaGlzIGVtaXRzIHdoZW4gdGhlIGVxdWlwbWVudCBvd25lcnNoaXAgY2hhbmdlZCAKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdG9rZW5JZCk7CgogICAgLy8vIEBkZXYgVGhpcyBlbWl0cyB3aGVuIHRoZSBlcXVpcG1lbnQgY3JlYXRlZAogICAgZXZlbnQgQ3JlYXRlRmFzaGlvbihhZGRyZXNzIGluZGV4ZWQgb3duZXIsIHVpbnQyNTYgdG9rZW5JZCwgdWludDE2IHByb3RvSWQsIHVpbnQxNiBxdWFsaXR5LCB1aW50MTYgcG9zLCB1aW50MTYgY3JlYXRlVHlwZSk7CgogICAgLy8vIEBkZXYgVGhpcyBlbWl0cyB3aGVuIHRoZSBlcXVpcG1lbnQncyBhdHRyaWJ1dGVzIGNoYW5nZWQKICAgIGV2ZW50IENoYW5nZUZhc2hpb24oYWRkcmVzcyBpbmRleGVkIG93bmVyLCB1aW50MjU2IHRva2VuSWQsIHVpbnQxNiBjaGFuZ2VUeXBlKTsKCiAgICAvLy8gQGRldiBUaGlzIGVtaXRzIHdoZW4gdGhlIGVxdWlwbWVudCBkZXN0cm95ZWQKICAgIGV2ZW50IERlbGV0ZUZhc2hpb24oYWRkcmVzcyBpbmRleGVkIG93bmVyLCB1aW50MjU2IHRva2VuSWQsIHVpbnQxNiBkZWxldGVUeXBlKTsKICAgIAogICAgZnVuY3Rpb24gV2FyVG9rZW4oKSBwdWJsaWMgewogICAgICAgIGFkZHJBZG1pbiA9IG1zZy5zZW5kZXI7CiAgICAgICAgZmFzaGlvbkFycmF5Lmxlbmd0aCArPSAxOwogICAgfQoKICAgIC8vIG1vZGlmaWVyCiAgICAvLy8gQGRldiBDaGVjayBpZiB0b2tlbiBJRCBpcyB2YWxpZAogICAgbW9kaWZpZXIgaXNWYWxpZFRva2VuKHVpbnQyNTYgX3Rva2VuSWQpIHsKICAgICAgICByZXF1aXJlKF90b2tlbklkID49IDEgJiYgX3Rva2VuSWQgPD0gZmFzaGlvbkFycmF5Lmxlbmd0aCk7CiAgICAgICAgcmVxdWlyZShmYXNoaW9uSWRUb093bmVyW190b2tlbklkXSAhPSBhZGRyZXNzKDApKTsgCiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBjYW5UcmFuc2Zlcih1aW50MjU2IF90b2tlbklkKSB7CiAgICAgICAgYWRkcmVzcyBvd25lciA9IGZhc2hpb25JZFRvT3duZXJbX3Rva2VuSWRdOwogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lciB8fCBtc2cuc2VuZGVyID09IGZhc2hpb25JZFRvQXBwcm92YWxzW190b2tlbklkXSB8fCBvcGVyYXRvclRvQXBwcm92YWxzW293bmVyXVttc2cuc2VuZGVyXSk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLyBFUkM3MjEKICAgIGZ1bmN0aW9uIHN1cHBvcnRzSW50ZXJmYWNlKGJ5dGVzNCBfaW50ZXJmYWNlSWQpIGV4dGVybmFsIHZpZXcgcmV0dXJucyhib29sKSB7CiAgICAgICAgLy8gRVJDMTY1IHx8IEVSQzcyMSB8fCBFUkMxNjVeRVJDNzIxCiAgICAgICAgcmV0dXJuIChfaW50ZXJmYWNlSWQgPT0gMHgwMWZmYzlhNyB8fCBfaW50ZXJmYWNlSWQgPT0gMHg4MGFjNThjZCB8fCBfaW50ZXJmYWNlSWQgPT0gMHg4MTUzOTE2YSkgJiYgKF9pbnRlcmZhY2VJZCAhPSAweGZmZmZmZmZmKTsKICAgIH0KICAgICAgICAKICAgIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgcHVyZSByZXR1cm5zKHN0cmluZykgewogICAgICAgIHJldHVybiAiV0FSIFRva2VuIjsKICAgIH0KCiAgICBmdW5jdGlvbiBzeW1ib2woKSBwdWJsaWMgcHVyZSByZXR1cm5zKHN0cmluZykgewogICAgICAgIHJldHVybiAiV0FSIjsKICAgIH0KCiAgICAvLy8gQGRldiBTZWFyY2ggZm9yIHRva2VuIHF1YW50aXR5IGFkZHJlc3MKICAgIC8vLyBAcGFyYW0gX293bmVyIEFkZHJlc3MgdGhhdCBuZWVkcyB0byBiZSBzZWFyY2hlZAogICAgLy8vIEByZXR1cm4gUmV0dXJucyB0b2tlbiBxdWFudGl0eQogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBleHRlcm5hbCB2aWV3IHJldHVybnModWludDI1NikgewogICAgICAgIHJlcXVpcmUoX293bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJldHVybiBvd25lclRvRmFzaGlvbkFycmF5W19vd25lcl0ubGVuZ3RoOwogICAgfQoKICAgIC8vLyBAZGV2IEZpbmQgdGhlIG93bmVyIG9mIGFuIFdBUgogICAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgdG9rZW5JZCBvZiBXQVIKICAgIC8vLyBAcmV0dXJuIEdpdmUgVGhlIGFkZHJlc3Mgb2YgdGhlIG93bmVyIG9mIHRoaXMgV0FSCiAgICBmdW5jdGlvbiBvd25lck9mKHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsIHZpZXcgLyppc1ZhbGlkVG9rZW4oX3Rva2VuSWQpKi8gcmV0dXJucyAoYWRkcmVzcyBvd25lcikgewogICAgICAgIHJldHVybiBmYXNoaW9uSWRUb093bmVyW190b2tlbklkXTsKICAgIH0KCiAgICAvLy8gQGRldiBUcmFuc2ZlcnMgdGhlIG93bmVyc2hpcCBvZiBhbiBXQVIgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyIGFkZHJlc3MKICAgIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGN1cnJlbnQgb3duZXIgb2YgdGhlIFdBUgogICAgLy8vIEBwYXJhbSBfdG8gVGhlIG5ldyBvd25lcgogICAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgV0FSIHRvIHRyYW5zZmVyCiAgICAvLy8gQHBhcmFtIGRhdGEgQWRkaXRpb25hbCBkYXRhIHdpdGggbm8gc3BlY2lmaWVkIGZvcm1hdCwgc2VudCBpbiBjYWxsIHRvIGBfdG9gCiAgICBmdW5jdGlvbiBzYWZlVHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkLCBieXRlcyBkYXRhKSAKICAgICAgICBleHRlcm5hbAogICAgICAgIHdoZW5Ob3RQYXVzZWQKICAgIHsKICAgICAgICBfc2FmZVRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdG9rZW5JZCwgZGF0YSk7CiAgICB9CgogICAgLy8vIEBkZXYgVHJhbnNmZXJzIHRoZSBvd25lcnNoaXAgb2YgYW4gV0FSIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlciBhZGRyZXNzCiAgICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBjdXJyZW50IG93bmVyIG9mIHRoZSBXQVIKICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBuZXcgb3duZXIKICAgIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIFdBUiB0byB0cmFuc2ZlcgogICAgZnVuY3Rpb24gc2FmZVRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICB3aGVuTm90UGF1c2VkCiAgICB7CiAgICAgICAgX3NhZmVUcmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3Rva2VuSWQsICIiKTsKICAgIH0KCiAgICAvLy8gQGRldiBUcmFuc2ZlciBvd25lcnNoaXAgb2YgYW4gV0FSLCAnX3RvJyBtdXN0IGJlIGEgdmFpbGQgYWRkcmVzcywgb3IgdGhlIFdBUiB3aWxsIGxvc3QKICAgIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGN1cnJlbnQgb3duZXIgb2YgdGhlIFdBUgogICAgLy8vIEBwYXJhbSBfdG8gVGhlIG5ldyBvd25lcgogICAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgV0FSIHRvIHRyYW5zZmVyCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICB3aGVuTm90UGF1c2VkCiAgICAgICAgaXNWYWxpZFRva2VuKF90b2tlbklkKQogICAgICAgIGNhblRyYW5zZmVyKF90b2tlbklkKQogICAgewogICAgICAgIGFkZHJlc3Mgb3duZXIgPSBmYXNoaW9uSWRUb093bmVyW190b2tlbklkXTsKICAgICAgICByZXF1aXJlKG93bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUob3duZXIgPT0gX2Zyb20pOwogICAgICAgIAogICAgICAgIF90cmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgLy8vIEBkZXYgU2V0IG9yIHJlYWZmaXJtIHRoZSBhcHByb3ZlZCBhZGRyZXNzIGZvciBhbiBXQVIKICAgIC8vLyBAcGFyYW0gX2FwcHJvdmVkIFRoZSBuZXcgYXBwcm92ZWQgV0FSIGNvbnRyb2xsZXIKICAgIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIFdBUiB0byBhcHByb3ZlCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX2FwcHJvdmVkLCB1aW50MjU2IF90b2tlbklkKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgd2hlbk5vdFBhdXNlZAogICAgewogICAgICAgIGFkZHJlc3Mgb3duZXIgPSBmYXNoaW9uSWRUb093bmVyW190b2tlbklkXTsKICAgICAgICByZXF1aXJlKG93bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lciB8fCBvcGVyYXRvclRvQXBwcm92YWxzW293bmVyXVttc2cuc2VuZGVyXSk7CgogICAgICAgIGZhc2hpb25JZFRvQXBwcm92YWxzW190b2tlbklkXSA9IF9hcHByb3ZlZDsKICAgICAgICBBcHByb3ZhbChvd25lciwgX2FwcHJvdmVkLCBfdG9rZW5JZCk7CiAgICB9CgogICAgLy8vIEBkZXYgRW5hYmxlIG9yIGRpc2FibGUgYXBwcm92YWwgZm9yIGEgdGhpcmQgcGFydHkgKCJvcGVyYXRvciIpIHRvIG1hbmFnZSBhbGwgeW91ciBhc3NldC4KICAgIC8vLyBAcGFyYW0gX29wZXJhdG9yIEFkZHJlc3MgdG8gYWRkIHRvIHRoZSBzZXQgb2YgYXV0aG9yaXplZCBvcGVyYXRvcnMuCiAgICAvLy8gQHBhcmFtIF9hcHByb3ZlZCBUcnVlIGlmIHRoZSBvcGVyYXRvcnMgaXMgYXBwcm92ZWQsIGZhbHNlIHRvIHJldm9rZSBhcHByb3ZhbAogICAgZnVuY3Rpb24gc2V0QXBwcm92YWxGb3JBbGwoYWRkcmVzcyBfb3BlcmF0b3IsIGJvb2wgX2FwcHJvdmVkKSAKICAgICAgICBleHRlcm5hbCAKICAgICAgICB3aGVuTm90UGF1c2VkCiAgICB7CiAgICAgICAgb3BlcmF0b3JUb0FwcHJvdmFsc1ttc2cuc2VuZGVyXVtfb3BlcmF0b3JdID0gX2FwcHJvdmVkOwogICAgICAgIEFwcHJvdmFsRm9yQWxsKG1zZy5zZW5kZXIsIF9vcGVyYXRvciwgX2FwcHJvdmVkKTsKICAgIH0KCiAgICAvLy8gQGRldiBHZXQgdGhlIGFwcHJvdmVkIGFkZHJlc3MgZm9yIGEgc2luZ2xlIFdBUgogICAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgV0FSIHRvIGZpbmQgdGhlIGFwcHJvdmVkIGFkZHJlc3MgZm9yCiAgICAvLy8gQHJldHVybiBUaGUgYXBwcm92ZWQgYWRkcmVzcyBmb3IgdGhpcyBXQVIsIG9yIHRoZSB6ZXJvIGFkZHJlc3MgaWYgdGhlcmUgaXMgbm9uZQogICAgZnVuY3Rpb24gZ2V0QXBwcm92ZWQodWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWwgdmlldyBpc1ZhbGlkVG9rZW4oX3Rva2VuSWQpIHJldHVybnMgKGFkZHJlc3MpIHsKICAgICAgICByZXR1cm4gZmFzaGlvbklkVG9BcHByb3ZhbHNbX3Rva2VuSWRdOwogICAgfQoKICAgIC8vLyBAZGV2IFF1ZXJ5IGlmIGFuIGFkZHJlc3MgaXMgYW4gYXV0aG9yaXplZCBvcGVyYXRvciBmb3IgYW5vdGhlciBhZGRyZXNzCiAgICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0aGF0IG93bnMgdGhlIFdBUnMKICAgIC8vLyBAcGFyYW0gX29wZXJhdG9yIFRoZSBhZGRyZXNzIHRoYXQgYWN0cyBvbiBiZWhhbGYgb2YgdGhlIG93bmVyCiAgICAvLy8gQHJldHVybiBUcnVlIGlmIGBfb3BlcmF0b3JgIGlzIGFuIGFwcHJvdmVkIG9wZXJhdG9yIGZvciBgX293bmVyYCwgZmFsc2Ugb3RoZXJ3aXNlCiAgICBmdW5jdGlvbiBpc0FwcHJvdmVkRm9yQWxsKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9vcGVyYXRvcikgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIG9wZXJhdG9yVG9BcHByb3ZhbHNbX293bmVyXVtfb3BlcmF0b3JdOwogICAgfQoKICAgIC8vLyBAZGV2IENvdW50IFdBUnMgdHJhY2tlZCBieSB0aGlzIGNvbnRyYWN0CiAgICAvLy8gQHJldHVybiBBIGNvdW50IG9mIHZhbGlkIFdBUnMgdHJhY2tlZCBieSB0aGlzIGNvbnRyYWN0LCB3aGVyZSBlYWNoIG9uZSBvZgogICAgLy8vICB0aGVtIGhhcyBhbiBhc3NpZ25lZCBhbmQgcXVlcnlhYmxlIG93bmVyIG5vdCBlcXVhbCB0byB0aGUgemVybyBhZGRyZXNzCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBmYXNoaW9uQXJyYXkubGVuZ3RoIC0gZGVzdHJveUZhc2hpb25Db3VudCAtIDE7CiAgICB9CgogICAgLy8vIEBkZXYgRG8gdGhlIHJlYWwgdHJhbnNmZXIgd2l0aCBvdXQgYW55IGNvbmRpdGlvbiBjaGVja2luZwogICAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgb2xkIG93bmVyIG9mIHRoaXMgV0FSKElmIGNyZWF0ZWQ6IDB4MCkKICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBuZXcgb3duZXIgb2YgdGhpcyBXQVIgCiAgICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSB0b2tlbklkIG9mIHRoZSBXQVIKICAgIGZ1bmN0aW9uIF90cmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgaW50ZXJuYWwgewogICAgICAgIGlmIChfZnJvbSAhPSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIHVpbnQyNTYgaW5kZXhGcm9tID0gZmFzaGlvbklkVG9Pd25lckluZGV4W190b2tlbklkXTsKICAgICAgICAgICAgdWludDI1NltdIHN0b3JhZ2UgZnNBcnJheSA9IG93bmVyVG9GYXNoaW9uQXJyYXlbX2Zyb21dOwogICAgICAgICAgICByZXF1aXJlKGZzQXJyYXlbaW5kZXhGcm9tXSA9PSBfdG9rZW5JZCk7CgogICAgICAgICAgICAvLyBJZiB0aGUgV0FSIGlzIG5vdCB0aGUgZWxlbWVudCBvZiBhcnJheSwgY2hhbmdlIGl0IHRvIHdpdGggdGhlIGxhc3QKICAgICAgICAgICAgaWYgKGluZGV4RnJvbSAhPSBmc0FycmF5Lmxlbmd0aCAtIDEpIHsKICAgICAgICAgICAgICAgIHVpbnQyNTYgbGFzdFRva2VuSWQgPSBmc0FycmF5W2ZzQXJyYXkubGVuZ3RoIC0gMV07CiAgICAgICAgICAgICAgICBmc0FycmF5W2luZGV4RnJvbV0gPSBsYXN0VG9rZW5JZDsgCiAgICAgICAgICAgICAgICBmYXNoaW9uSWRUb093bmVySW5kZXhbbGFzdFRva2VuSWRdID0gaW5kZXhGcm9tOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZzQXJyYXkubGVuZ3RoIC09IDE7IAogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKGZhc2hpb25JZFRvQXBwcm92YWxzW190b2tlbklkXSAhPSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgICAgICBkZWxldGUgZmFzaGlvbklkVG9BcHByb3ZhbHNbX3Rva2VuSWRdOwogICAgICAgICAgICB9ICAgICAgCiAgICAgICAgfQoKICAgICAgICAvLyBHaXZlIHRoZSBXQVIgdG8gJ190bycKICAgICAgICBmYXNoaW9uSWRUb093bmVyW190b2tlbklkXSA9IF90bzsKICAgICAgICBvd25lclRvRmFzaGlvbkFycmF5W190b10ucHVzaChfdG9rZW5JZCk7CiAgICAgICAgZmFzaGlvbklkVG9Pd25lckluZGV4W190b2tlbklkXSA9IG93bmVyVG9GYXNoaW9uQXJyYXlbX3RvXS5sZW5ndGggLSAxOwogICAgICAgIAogICAgICAgIFRyYW5zZmVyKF9mcm9tICE9IGFkZHJlc3MoMCkgPyBfZnJvbSA6IHRoaXMsIF90bywgX3Rva2VuSWQpOwogICAgfQoKICAgIC8vLyBAZGV2IEFjdHVhbGx5IHBlcmZvcm0gdGhlIHNhZmVUcmFuc2ZlckZyb20KICAgIGZ1bmN0aW9uIF9zYWZlVHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkLCBieXRlcyBkYXRhKSAKICAgICAgICBpbnRlcm5hbAogICAgICAgIGlzVmFsaWRUb2tlbihfdG9rZW5JZCkgCiAgICAgICAgY2FuVHJhbnNmZXIoX3Rva2VuSWQpCiAgICB7CiAgICAgICAgYWRkcmVzcyBvd25lciA9IGZhc2hpb25JZFRvT3duZXJbX3Rva2VuSWRdOwogICAgICAgIHJlcXVpcmUob3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShvd25lciA9PSBfZnJvbSk7CiAgICAgICAgCiAgICAgICAgX3RyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKCiAgICAgICAgLy8gRG8gdGhlIGNhbGxiYWNrIGFmdGVyIGV2ZXJ5dGhpbmcgaXMgZG9uZSB0byBhdm9pZCByZWVudHJhbmN5IGF0dGFjawogICAgICAgIHVpbnQyNTYgY29kZVNpemU7CiAgICAgICAgYXNzZW1ibHkgeyBjb2RlU2l6ZSA6PSBleHRjb2Rlc2l6ZShfdG8pIH0KICAgICAgICBpZiAoY29kZVNpemUgPT0gMCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGJ5dGVzNCByZXR2YWwgPSBFUkM3MjFUb2tlblJlY2VpdmVyKF90bykub25FUkM3MjFSZWNlaXZlZChfZnJvbSwgX3Rva2VuSWQsIGRhdGEpOwogICAgICAgIC8vIGJ5dGVzNChrZWNjYWsyNTYoIm9uRVJDNzIxUmVjZWl2ZWQoYWRkcmVzcyx1aW50MjU2LGJ5dGVzKSIpKSA9IDB4ZjBiOWU1YmE7CiAgICAgICAgcmVxdWlyZShyZXR2YWwgPT0gMHhmMGI5ZTViYSk7CiAgICB9CgogICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgLy8vIEBkZXYgRXF1aXBtZW50IGNyZWF0aW9uCiAgICAvLy8gQHBhcmFtIF9vd25lciBPd25lciBvZiB0aGUgZXF1aXBtZW50IGNyZWF0ZWQKICAgIC8vLyBAcGFyYW0gX2F0dHJzIEF0dHJpYnV0ZXMgb2YgdGhlIGVxdWlwbWVudCBjcmVhdGVkCiAgICAvLy8gQHJldHVybiBUb2tlbiBJRCBvZiB0aGUgZXF1aXBtZW50IGNyZWF0ZWQKICAgIGZ1bmN0aW9uIGNyZWF0ZUZhc2hpb24oYWRkcmVzcyBfb3duZXIsIHVpbnQxNls5XSBfYXR0cnMsIHVpbnQxNiBfY3JlYXRlVHlwZSkgCiAgICAgICAgZXh0ZXJuYWwgCiAgICAgICAgd2hlbk5vdFBhdXNlZAogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICByZXF1aXJlKGFjdGlvbkNvbnRyYWN0c1ttc2cuc2VuZGVyXSk7CiAgICAgICAgcmVxdWlyZShfb3duZXIgIT0gYWRkcmVzcygwKSk7CgogICAgICAgIHVpbnQyNTYgbmV3RmFzaGlvbklkID0gZmFzaGlvbkFycmF5Lmxlbmd0aDsKICAgICAgICByZXF1aXJlKG5ld0Zhc2hpb25JZCA8IDQyOTQ5NjcyOTYpOwoKICAgICAgICBmYXNoaW9uQXJyYXkubGVuZ3RoICs9IDE7CiAgICAgICAgRmFzaGlvbiBzdG9yYWdlIGZzID0gZmFzaGlvbkFycmF5W25ld0Zhc2hpb25JZF07CiAgICAgICAgZnMucHJvdG9JZCA9IF9hdHRyc1swXTsKICAgICAgICBmcy5xdWFsaXR5ID0gX2F0dHJzWzFdOwogICAgICAgIGZzLnBvcyA9IF9hdHRyc1syXTsKICAgICAgICBpZiAoX2F0dHJzWzNdICE9IDApIHsKICAgICAgICAgICAgZnMuaGVhbHRoID0gX2F0dHJzWzNdOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAoX2F0dHJzWzRdICE9IDApIHsKICAgICAgICAgICAgZnMuYXRrTWluID0gX2F0dHJzWzRdOwogICAgICAgICAgICBmcy5hdGtNYXggPSBfYXR0cnNbNV07CiAgICAgICAgfQogICAgICAgCiAgICAgICAgaWYgKF9hdHRyc1s2XSAhPSAwKSB7CiAgICAgICAgICAgIGZzLmRlZmVuY2UgPSBfYXR0cnNbNl07CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGlmIChfYXR0cnNbN10gIT0gMCkgewogICAgICAgICAgICBmcy5jcml0ID0gX2F0dHJzWzddOwogICAgICAgIH0KCiAgICAgICAgaWYgKF9hdHRyc1s4XSAhPSAwKSB7CiAgICAgICAgICAgIGZzLmlzUGVyY2VudCA9IF9hdHRyc1s4XTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgX3RyYW5zZmVyKDAsIF9vd25lciwgbmV3RmFzaGlvbklkKTsKICAgICAgICBDcmVhdGVGYXNoaW9uKF9vd25lciwgbmV3RmFzaGlvbklkLCBfYXR0cnNbMF0sIF9hdHRyc1sxXSwgX2F0dHJzWzJdLCBfY3JlYXRlVHlwZSk7CiAgICAgICAgcmV0dXJuIG5ld0Zhc2hpb25JZDsKICAgIH0KCiAgICAvLy8gQGRldiBPbmUgc3BlY2lmaWMgYXR0cmlidXRlIG9mIHRoZSBlcXVpcG1lbnQgbW9kaWZpZWQKICAgIGZ1bmN0aW9uIF9jaGFuZ2VBdHRyQnlJbmRleChGYXNoaW9uIHN0b3JhZ2UgX2ZzLCB1aW50MTYgX2luZGV4LCB1aW50MTYgX3ZhbCkgaW50ZXJuYWwgewogICAgICAgIGlmIChfaW5kZXggPT0gMykgewogICAgICAgICAgICBfZnMuaGVhbHRoID0gX3ZhbDsKICAgICAgICB9IGVsc2UgaWYoX2luZGV4ID09IDQpIHsKICAgICAgICAgICAgX2ZzLmF0a01pbiA9IF92YWw7CiAgICAgICAgfSBlbHNlIGlmKF9pbmRleCA9PSA1KSB7CiAgICAgICAgICAgIF9mcy5hdGtNYXggPSBfdmFsOwogICAgICAgIH0gZWxzZSBpZihfaW5kZXggPT0gNikgewogICAgICAgICAgICBfZnMuZGVmZW5jZSA9IF92YWw7CiAgICAgICAgfSBlbHNlIGlmKF9pbmRleCA9PSA3KSB7CiAgICAgICAgICAgIF9mcy5jcml0ID0gX3ZhbDsKICAgICAgICB9IGVsc2UgaWYoX2luZGV4ID09IDkpIHsKICAgICAgICAgICAgX2ZzLmF0dHJFeHQxID0gX3ZhbDsKICAgICAgICB9IGVsc2UgaWYoX2luZGV4ID09IDEwKSB7CiAgICAgICAgICAgIF9mcy5hdHRyRXh0MiA9IF92YWw7CiAgICAgICAgfSBlbHNlIGlmKF9pbmRleCA9PSAxMSkgewogICAgICAgICAgICBfZnMuYXR0ckV4dDMgPSBfdmFsOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8gQGRldiBFcXVpbWVudCBhdHRyaWJ1dGVzIG1vZGlmaWVkIChtYXggNCBzdGF0cyBtb2RpZmllZCkKICAgIC8vLyBAcGFyYW0gX3Rva2VuSWQgRXF1aXBtZW50IFRva2VuIElECiAgICAvLy8gQHBhcmFtIF9pZHhBcnJheSBTdGF0cyBvcmRlciB0aGF0IG11c3QgYmUgbW9kaWZpZWQKICAgIC8vLyBAcGFyYW0gX3BhcmFtcyBTdGF0IHZhbHVlIHRoYXQgbXVzdCBiZSBtb2RpZmllZAogICAgLy8vIEBwYXJhbSBfY2hhbmdlVHlwZSBNb2RpZmljYXRpb24gdHlwZSBzdWNoIGFzIGVuaGFuY2UsIHNvY2tldCwgZXRjLgogICAgZnVuY3Rpb24gY2hhbmdlRmFzaGlvbkF0dHIodWludDI1NiBfdG9rZW5JZCwgdWludDE2WzRdIF9pZHhBcnJheSwgdWludDE2WzRdIF9wYXJhbXMsIHVpbnQxNiBfY2hhbmdlVHlwZSkgCiAgICAgICAgZXh0ZXJuYWwgCiAgICAgICAgd2hlbk5vdFBhdXNlZAogICAgICAgIGlzVmFsaWRUb2tlbihfdG9rZW5JZCkgCiAgICB7CiAgICAgICAgcmVxdWlyZShhY3Rpb25Db250cmFjdHNbbXNnLnNlbmRlcl0pOwoKICAgICAgICBGYXNoaW9uIHN0b3JhZ2UgZnMgPSBmYXNoaW9uQXJyYXlbX3Rva2VuSWRdOwogICAgICAgIGlmIChfaWR4QXJyYXlbMF0gPiAwKSB7CiAgICAgICAgICAgIF9jaGFuZ2VBdHRyQnlJbmRleChmcywgX2lkeEFycmF5WzBdLCBfcGFyYW1zWzBdKTsKICAgICAgICB9CgogICAgICAgIGlmIChfaWR4QXJyYXlbMV0gPiAwKSB7CiAgICAgICAgICAgIF9jaGFuZ2VBdHRyQnlJbmRleChmcywgX2lkeEFycmF5WzFdLCBfcGFyYW1zWzFdKTsKICAgICAgICB9CgogICAgICAgIGlmIChfaWR4QXJyYXlbMl0gPiAwKSB7CiAgICAgICAgICAgIF9jaGFuZ2VBdHRyQnlJbmRleChmcywgX2lkeEFycmF5WzJdLCBfcGFyYW1zWzJdKTsKICAgICAgICB9CgogICAgICAgIGlmIChfaWR4QXJyYXlbM10gPiAwKSB7CiAgICAgICAgICAgIF9jaGFuZ2VBdHRyQnlJbmRleChmcywgX2lkeEFycmF5WzNdLCBfcGFyYW1zWzNdKTsKICAgICAgICB9CgogICAgICAgIENoYW5nZUZhc2hpb24oZmFzaGlvbklkVG9Pd25lcltfdG9rZW5JZF0sIF90b2tlbklkLCBfY2hhbmdlVHlwZSk7CiAgICB9CgogICAgLy8vIEBkZXYgRXF1aXBtZW50IGRlc3RydWN0aW9uCiAgICAvLy8gQHBhcmFtIF90b2tlbklkIEVxdWlwbWVudCBUb2tlbiBJRAogICAgLy8vIEBwYXJhbSBfZGVsZXRlVHlwZSBEZXN0cnVjdGlvbiB0eXBlLCBzdWNoIGFzIGNyYWZ0CiAgICBmdW5jdGlvbiBkZXN0cm95RmFzaGlvbih1aW50MjU2IF90b2tlbklkLCB1aW50MTYgX2RlbGV0ZVR5cGUpCiAgICAgICAgZXh0ZXJuYWwgCiAgICAgICAgd2hlbk5vdFBhdXNlZAogICAgICAgIGlzVmFsaWRUb2tlbihfdG9rZW5JZCkgCiAgICB7CiAgICAgICAgcmVxdWlyZShhY3Rpb25Db250cmFjdHNbbXNnLnNlbmRlcl0pOwoKICAgICAgICBhZGRyZXNzIF9mcm9tID0gZmFzaGlvbklkVG9Pd25lcltfdG9rZW5JZF07CiAgICAgICAgdWludDI1NiBpbmRleEZyb20gPSBmYXNoaW9uSWRUb093bmVySW5kZXhbX3Rva2VuSWRdOwogICAgICAgIHVpbnQyNTZbXSBzdG9yYWdlIGZzQXJyYXkgPSBvd25lclRvRmFzaGlvbkFycmF5W19mcm9tXTsgCiAgICAgICAgcmVxdWlyZShmc0FycmF5W2luZGV4RnJvbV0gPT0gX3Rva2VuSWQpOwoKICAgICAgICBpZiAoaW5kZXhGcm9tICE9IGZzQXJyYXkubGVuZ3RoIC0gMSkgewogICAgICAgICAgICB1aW50MjU2IGxhc3RUb2tlbklkID0gZnNBcnJheVtmc0FycmF5Lmxlbmd0aCAtIDFdOwogICAgICAgICAgICBmc0FycmF5W2luZGV4RnJvbV0gPSBsYXN0VG9rZW5JZDsgCiAgICAgICAgICAgIGZhc2hpb25JZFRvT3duZXJJbmRleFtsYXN0VG9rZW5JZF0gPSBpbmRleEZyb207CiAgICAgICAgfQogICAgICAgIGZzQXJyYXkubGVuZ3RoIC09IDE7IAoKICAgICAgICBmYXNoaW9uSWRUb093bmVyW190b2tlbklkXSA9IGFkZHJlc3MoMCk7CiAgICAgICAgZGVsZXRlIGZhc2hpb25JZFRvT3duZXJJbmRleFtfdG9rZW5JZF07CiAgICAgICAgZGVzdHJveUZhc2hpb25Db3VudCArPSAxOwoKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgMCwgX3Rva2VuSWQpOwoKICAgICAgICBEZWxldGVGYXNoaW9uKF9mcm9tLCBfdG9rZW5JZCwgX2RlbGV0ZVR5cGUpOwogICAgfQoKICAgIC8vLyBAZGV2IFNhZmUgdHJhbnNmZXIgYnkgdHJ1c3QgY29udHJhY3RzCiAgICBmdW5jdGlvbiBzYWZlVHJhbnNmZXJCeUNvbnRyYWN0KHVpbnQyNTYgX3Rva2VuSWQsIGFkZHJlc3MgX3RvKSAKICAgICAgICBleHRlcm5hbAogICAgICAgIHdoZW5Ob3RQYXVzZWQKICAgIHsKICAgICAgICByZXF1aXJlKGFjdGlvbkNvbnRyYWN0c1ttc2cuc2VuZGVyXSk7CgogICAgICAgIHJlcXVpcmUoX3Rva2VuSWQgPj0gMSAmJiBfdG9rZW5JZCA8PSBmYXNoaW9uQXJyYXkubGVuZ3RoKTsKICAgICAgICBhZGRyZXNzIG93bmVyID0gZmFzaGlvbklkVG9Pd25lcltfdG9rZW5JZF07CiAgICAgICAgcmVxdWlyZShvd25lciAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKG93bmVyICE9IF90byk7CgogICAgICAgIF90cmFuc2Zlcihvd25lciwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgLy8vIEBkZXYgR2V0IGZhc2hpb24gYXR0cnMgYnkgdG9rZW5JZAogICAgZnVuY3Rpb24gZ2V0RmFzaGlvbih1aW50MjU2IF90b2tlbklkKSBleHRlcm5hbCB2aWV3IGlzVmFsaWRUb2tlbihfdG9rZW5JZCkgcmV0dXJucyAodWludDE2WzEyXSBkYXRhcykgewogICAgICAgIEZhc2hpb24gc3RvcmFnZSBmcyA9IGZhc2hpb25BcnJheVtfdG9rZW5JZF07CiAgICAgICAgZGF0YXNbMF0gPSBmcy5wcm90b0lkOwogICAgICAgIGRhdGFzWzFdID0gZnMucXVhbGl0eTsKICAgICAgICBkYXRhc1syXSA9IGZzLnBvczsKICAgICAgICBkYXRhc1szXSA9IGZzLmhlYWx0aDsKICAgICAgICBkYXRhc1s0XSA9IGZzLmF0a01pbjsKICAgICAgICBkYXRhc1s1XSA9IGZzLmF0a01heDsKICAgICAgICBkYXRhc1s2XSA9IGZzLmRlZmVuY2U7CiAgICAgICAgZGF0YXNbN10gPSBmcy5jcml0OwogICAgICAgIGRhdGFzWzhdID0gZnMuaXNQZXJjZW50OwogICAgICAgIGRhdGFzWzldID0gZnMuYXR0ckV4dDE7CiAgICAgICAgZGF0YXNbMTBdID0gZnMuYXR0ckV4dDI7CiAgICAgICAgZGF0YXNbMTFdID0gZnMuYXR0ckV4dDM7CiAgICB9CgogICAgLy8vIEBkZXYgR2V0IHRva2VuSWRzIGFuZCBmbGFncyBieSBvd25lcgogICAgZnVuY3Rpb24gZ2V0T3duRmFzaGlvbnMoYWRkcmVzcyBfb3duZXIpIGV4dGVybmFsIHZpZXcgcmV0dXJucyh1aW50MjU2W10gdG9rZW5zLCB1aW50MzJbXSBmbGFncykgewogICAgICAgIHJlcXVpcmUoX293bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHVpbnQyNTZbXSBzdG9yYWdlIGZzQXJyYXkgPSBvd25lclRvRmFzaGlvbkFycmF5W19vd25lcl07CiAgICAgICAgdWludDI1NiBsZW5ndGggPSBmc0FycmF5Lmxlbmd0aDsKICAgICAgICB0b2tlbnMgPSBuZXcgdWludDI1NltdKGxlbmd0aCk7CiAgICAgICAgZmxhZ3MgPSBuZXcgdWludDMyW10obGVuZ3RoKTsKICAgICAgICBmb3IgKHVpbnQyNTYgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewogICAgICAgICAgICB0b2tlbnNbaV0gPSBmc0FycmF5W2ldOwogICAgICAgICAgICBGYXNoaW9uIHN0b3JhZ2UgZnMgPSBmYXNoaW9uQXJyYXlbZnNBcnJheVtpXV07CiAgICAgICAgICAgIGZsYWdzW2ldID0gdWludDMyKHVpbnQzMihmcy5wcm90b0lkKSAqIDEwMCArIHVpbnQzMihmcy5xdWFsaXR5KSAqIDEwICsgZnMucG9zKTsKICAgICAgICB9CiAgICB9CgogICAgLy8vIEBkZXYgV0FSIHRva2VuIGluZm8gcmV0dXJuZWQgYmFzZWQgb24gVG9rZW4gSUQgdHJhbnNmZXJlZCAoNjQgYXQgbW9zdCkKICAgIGZ1bmN0aW9uIGdldEZhc2hpb25zQXR0cnModWludDI1NltdIF90b2tlbnMpIGV4dGVybmFsIHZpZXcgcmV0dXJucyh1aW50MTZbXSBhdHRycykgewogICAgICAgIHVpbnQyNTYgbGVuZ3RoID0gX3Rva2Vucy5sZW5ndGg7CiAgICAgICAgcmVxdWlyZShsZW5ndGggPD0gNjQpOwogICAgICAgIGF0dHJzID0gbmV3IHVpbnQxNltdKGxlbmd0aCAqIDExKTsKICAgICAgICB1aW50MjU2IHRva2VuSWQ7CiAgICAgICAgdWludDI1NiBpbmRleDsKICAgICAgICBmb3IgKHVpbnQyNTYgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewogICAgICAgICAgICB0b2tlbklkID0gX3Rva2Vuc1tpXTsKICAgICAgICAgICAgaWYgKGZhc2hpb25JZFRvT3duZXJbdG9rZW5JZF0gIT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICAgICAgaW5kZXggPSBpICogMTE7CiAgICAgICAgICAgICAgICBGYXNoaW9uIHN0b3JhZ2UgZnMgPSBmYXNoaW9uQXJyYXlbdG9rZW5JZF07CiAgICAgICAgICAgICAgICBhdHRyc1tpbmRleF0gPSBmcy5oZWFsdGg7CiAgICAgICAgICAgICAgICBhdHRyc1tpbmRleCArIDFdID0gZnMuYXRrTWluOwogICAgICAgICAgICAgICAgYXR0cnNbaW5kZXggKyAyXSA9IGZzLmF0a01heDsKICAgICAgICAgICAgICAgIGF0dHJzW2luZGV4ICsgM10gPSBmcy5kZWZlbmNlOwogICAgICAgICAgICAgICAgYXR0cnNbaW5kZXggKyA0XSA9IGZzLmNyaXQ7CiAgICAgICAgICAgICAgICBhdHRyc1tpbmRleCArIDVdID0gZnMuaXNQZXJjZW50OwogICAgICAgICAgICAgICAgYXR0cnNbaW5kZXggKyA2XSA9IGZzLmF0dHJFeHQxOwogICAgICAgICAgICAgICAgYXR0cnNbaW5kZXggKyA3XSA9IGZzLmF0dHJFeHQyOwogICAgICAgICAgICAgICAgYXR0cnNbaW5kZXggKyA4XSA9IGZzLmF0dHJFeHQzOwogICAgICAgICAgICB9ICAgCiAgICAgICAgfQogICAgfQp9Cgpjb250cmFjdCBBY3Rpb25QcmVzZWxsIGlzIEFjY2Vzc1NlcnZpY2UgewogICAgV2FyVG9rZW4gdG9rZW5Db250cmFjdDsKICAgIG1hcHBpbmcgKHVpbnQxNiA9PiB1aW50MTYpIHBldFByZXNlbGxDb3VudGVyOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MTZbXSkgcHJlc2VsbExpbWl0OwoKICAgIGV2ZW50IFBldFByZVNlbGxlZChhZGRyZXNzIGluZGV4ZWQgYnV5ZXIsIHVpbnQxNiBwcm90b0lkKTsKCiAgICBmdW5jdGlvbiBBY3Rpb25QcmVzZWxsKGFkZHJlc3MgX25mdEFkZHIpIHB1YmxpYyB7CiAgICAgICAgYWRkckFkbWluID0gbXNnLnNlbmRlcjsKICAgICAgICBhZGRyU2VydmljZSA9IG1zZy5zZW5kZXI7CiAgICAgICAgYWRkckZpbmFuY2UgPSBtc2cuc2VuZGVyOwoKICAgICAgICB0b2tlbkNvbnRyYWN0ID0gV2FyVG9rZW4oX25mdEFkZHIpOwoKICAgICAgICBwZXRQcmVzZWxsQ291bnRlclsxMDAwMV0gPSA1MDsKICAgICAgICBwZXRQcmVzZWxsQ291bnRlclsxMDAwMl0gPSAzMDsKICAgICAgICBwZXRQcmVzZWxsQ291bnRlclsxMDAwM10gPSA1MDsKICAgICAgICBwZXRQcmVzZWxsQ291bnRlclsxMDAwNF0gPSAzMDsKICAgICAgICBwZXRQcmVzZWxsQ291bnRlclsxMDAwNV0gPSAzMDsKICAgIH0KCiAgICBmdW5jdGlvbigpIGV4dGVybmFsIHBheWFibGUgewoKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRXYXJUb2tlbkFkZHIoYWRkcmVzcyBfbmZ0QWRkcikgZXh0ZXJuYWwgb25seUFkbWluIHsKICAgICAgICB0b2tlbkNvbnRyYWN0ID0gV2FyVG9rZW4oX25mdEFkZHIpOwogICAgfQoKICAgIGZ1bmN0aW9uIHBldFByZXNlbGwodWludDE2IF9wcm90b0lkKSAKICAgICAgICBleHRlcm5hbAogICAgICAgIHBheWFibGUKICAgICAgICB3aGVuTm90UGF1c2VkIAogICAgewogICAgICAgIHVpbnQxNiBjdXJTdXBwbHkgPSBwZXRQcmVzZWxsQ291bnRlcltfcHJvdG9JZF07CiAgICAgICAgcmVxdWlyZShjdXJTdXBwbHkgPiAwKTsKICAgICAgICB1aW50MTZbXSBzdG9yYWdlIGJ1eUFycmF5ID0gcHJlc2VsbExpbWl0W21zZy5zZW5kZXJdOwogICAgICAgIHVpbnQyNTYgY3VyQnV5Q250ID0gYnV5QXJyYXkubGVuZ3RoOwogICAgICAgIHJlcXVpcmUoY3VyQnV5Q250IDwgMTApOwoKICAgICAgICB1aW50MjU2IHBheUJhY2sgPSAwOwogICAgICAgIGlmIChfcHJvdG9JZCA9PSAxMDAwMSkgewogICAgICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSAwLjY2IGV0aGVyKTsKICAgICAgICAgICAgcGF5QmFjayA9IChtc2cudmFsdWUgLSAwLjY2IGV0aGVyKTsKICAgICAgICAgICAgdWludDE2WzldIG1lbW9yeSBwYXJhbTEgPSBbMTAwMDEsIDUsIDksIDQwLCAwLCAwLCAwLCAwLCAxXTsgICAgICAgLy8gaHAgKzQwJQogICAgICAgICAgICB0b2tlbkNvbnRyYWN0LmNyZWF0ZUZhc2hpb24obXNnLnNlbmRlciwgcGFyYW0xLCAxKTsKICAgICAgICAgICAgYnV5QXJyYXkucHVzaCgxMDAwMSk7CiAgICAgICAgfSBlbHNlIGlmKF9wcm90b0lkID09IDEwMDAyKSB7CiAgICAgICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID49IDAuOTkgZXRoZXIpOwogICAgICAgICAgICBwYXlCYWNrID0gKG1zZy52YWx1ZSAtIDAuOTkgZXRoZXIpOwogICAgICAgICAgICB1aW50MTZbOV0gbWVtb3J5IHBhcmFtMiA9IFsxMDAwMiwgNSwgOSwgMCwgMzAsIDMwLCAwLCAwLCAxXTsgICAgICAgLy8gYXRrICszMCUKICAgICAgICAgICAgdG9rZW5Db250cmFjdC5jcmVhdGVGYXNoaW9uKG1zZy5zZW5kZXIsIHBhcmFtMiwgMSk7CiAgICAgICAgICAgIGJ1eUFycmF5LnB1c2goMTAwMDIpOwogICAgICAgIH0gZWxzZSBpZihfcHJvdG9JZCA9PSAxMDAwMykgewogICAgICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSAwLjY2IGV0aGVyKTsKICAgICAgICAgICAgcGF5QmFjayA9IChtc2cudmFsdWUgLSAwLjY2IGV0aGVyKTsKICAgICAgICAgICAgdWludDE2WzldIG1lbW9yeSBwYXJhbTMgPSBbMTAwMDMsIDUsIDksIDAsIDAsIDAsIDQwLCAwLCAxXTsgICAgICAgIC8vIGRlZiArNDAlCiAgICAgICAgICAgIHRva2VuQ29udHJhY3QuY3JlYXRlRmFzaGlvbihtc2cuc2VuZGVyLCBwYXJhbTMsIDEpOwogICAgICAgICAgICBidXlBcnJheS5wdXNoKDEwMDAzKTsKICAgICAgICB9IGVsc2UgaWYoX3Byb3RvSWQgPT0gMTAwMDQpIHsKICAgICAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPj0gMC45OSBldGhlcik7CiAgICAgICAgICAgIHBheUJhY2sgPSAobXNnLnZhbHVlIC0gMC45OSBldGhlcik7CiAgICAgICAgICAgIHVpbnQxNls5XSBtZW1vcnkgcGFyYW00ID0gWzEwMDA0LCA1LCA5LCAwLCAwLCAwLCAwLCAzMCwgMV07ICAgICAgICAvLyBjcml0ICs1MCUKICAgICAgICAgICAgdG9rZW5Db250cmFjdC5jcmVhdGVGYXNoaW9uKG1zZy5zZW5kZXIsIHBhcmFtNCwgMSk7CiAgICAgICAgICAgIGJ1eUFycmF5LnB1c2goMTAwMDQpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID49IDAuOTkgZXRoZXIpOwogICAgICAgICAgICBwYXlCYWNrID0gKG1zZy52YWx1ZSAtIDAuOTkgZXRoZXIpOwogICAgICAgICAgICB1aW50MTZbOV0gbWVtb3J5IHBhcmFtNSA9IFsxMDAwNSwgNSwgOSwgMjAsIDEwLCAxMCwgMjAsIDAsIDFdOyAgICAgIC8vIGhwICsyMCUsIGF0ayArMTAlLCBkZWYgKzIwJQogICAgICAgICAgICB0b2tlbkNvbnRyYWN0LmNyZWF0ZUZhc2hpb24obXNnLnNlbmRlciwgcGFyYW01LCAxKTsKICAgICAgICAgICAgYnV5QXJyYXkucHVzaCgxMDAwNSk7CiAgICAgICAgfQoKICAgICAgICBwZXRQcmVzZWxsQ291bnRlcltfcHJvdG9JZF0gPSAoY3VyU3VwcGx5IC0gMSk7CgogICAgICAgIFBldFByZVNlbGxlZChtc2cuc2VuZGVyLCBfcHJvdG9JZCk7CgogICAgICAgIGFkZHJGaW5hbmNlLnRyYW5zZmVyKG1zZy52YWx1ZSAtIHBheUJhY2spOyAgICAgICAgLy8gbmVlZCAyMzAwIGdhcyAtXy0hCiAgICAgICAgaWYgKHBheUJhY2sgPiAwKSB7CiAgICAgICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIocGF5QmFjayk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHdpdGhkcmF3KCkgCiAgICAgICAgZXh0ZXJuYWwgCiAgICB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkZHJGaW5hbmNlIHx8IG1zZy5zZW5kZXIgPT0gYWRkckFkbWluKTsKICAgICAgICBhZGRyRmluYW5jZS50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFBldENhblByZXNlbGxDb3VudCgpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludDE2WzVdIGNudEFycmF5KSB7CiAgICAgICAgY250QXJyYXlbMF0gPSBwZXRQcmVzZWxsQ291bnRlclsxMDAwMV07CiAgICAgICAgY250QXJyYXlbMV0gPSBwZXRQcmVzZWxsQ291bnRlclsxMDAwMl07CiAgICAgICAgY250QXJyYXlbMl0gPSBwZXRQcmVzZWxsQ291bnRlclsxMDAwM107CiAgICAgICAgY250QXJyYXlbM10gPSBwZXRQcmVzZWxsQ291bnRlclsxMDAwNF07CiAgICAgICAgY250QXJyYXlbNF0gPSBwZXRQcmVzZWxsQ291bnRlclsxMDAwNV07ICAgCiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QnV5Q291bnQoYWRkcmVzcyBfb3duZXIpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludDMyKSB7CiAgICAgICAgcmV0dXJuIHVpbnQzMihwcmVzZWxsTGltaXRbX293bmVyXS5sZW5ndGgpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEJ1eUFycmF5KGFkZHJlc3MgX293bmVyKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQxNltdKSB7CiAgICAgICAgdWludDE2W10gc3RvcmFnZSBidXlBcnJheSA9IHByZXNlbGxMaW1pdFtfb3duZXJdOwogICAgICAgIHJldHVybiBidXlBcnJheTsKICAgIH0KfQ=='.
	

]
