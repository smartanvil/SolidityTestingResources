Class {
	#name : #SRT22ff092fb751d2fabe23c6913e224ab3690b08cc,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT22ff092fb751d2fabe23c6913e224ab3690b08cc >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7CgovKioKICogQ29udHJhY3QgIk1hdGgiCiAqIFB1cnBvc2U6IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MKICovCmxpYnJhcnkgTWF0aCB7CgogICAgLyoqCiAgICAqIE11bHRpcGxpY2F0aW9uIHdpdGggc2FmZXR5IGNoZWNrCiAgICAqLwogICAgZnVuY3Rpb24gTXVsKHVpbnQgYSwgdWludCBiKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICAgIHVpbnQgYyA9IGEgKiBiOwogICAgICAvL2NoZWNrIHJlc3VsdCBzaG91bGQgbm90IGJlIG90aGVyIHdpc2UgdW50aWwgYT0wCiAgICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICAgIHJldHVybiBjOwogICAgfQoKICAgIC8qKgogICAgKiBEaXZpc2lvbiB3aXRoIHNhZmV0eSBjaGVjawogICAgKi8KICAgIGZ1bmN0aW9uIERpdih1aW50IGEsIHVpbnQgYikgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgICAvL292ZXJmbG93IGNoZWNrOyBiIG11c3Qgbm90IGJlIDAKICAgICAgYXNzZXJ0KGIgPiAwKTsKICAgICAgdWludCBjID0gYSAvIGI7CiAgICAgIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOwogICAgICByZXR1cm4gYzsKICAgIH0KCiAgICAvKioKICAgICogU3VidHJhY3Rpb24gd2l0aCBzYWZldHkgY2hlY2sKICAgICovCiAgICBmdW5jdGlvbiBTdWIodWludCBhLCB1aW50IGIpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgICAgLy9iIG11c3QgYmUgZ3JlYXRlciB0aGF0IGEgYXMgd2UgbmVlZCB0byBzdG9yZSB2YWx1ZSBpbiB1bnNpZ25lZCBpbnRlZ2VyCiAgICAgIGFzc2VydChiIDw9IGEpOwogICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgLyoqCiAgICAqIEFkZGl0aW9uIHdpdGggc2FmZXR5IGNoZWNrCiAgICAqLwogICAgZnVuY3Rpb24gQWRkKHVpbnQgYSwgdWludCBiKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICAgIHVpbnQgYyA9IGEgKyBiOwogICAgICAvL3Jlc3VsdCBtdXN0IGJlIGdyZWF0ZXIgYXMgYSBvciBiIGNhbiBub3QgYmUgbmVnYXRpdmUKICAgICAgYXNzZXJ0KGM+PWEgJiYgYz49Yik7CiAgICAgIHJldHVybiBjOwogICAgfQp9CgovKioKICogQ29udHJhY3QgIkVSQzIwQmFzaWMiCiAqIFB1cnBvc2U6IERlZmluaW5nIEVSQzIwIHN0YW5kYXJkIHdpdGggYmFzaWMgZnVuY3Rpb25hbGl0eSBsaWtlIC0gQ2hlY2tCYWxhbmNlIGFuZCBUcmFuc2ZlciBpbmNsdWRpbmcgVHJhbnNmZXIgZXZlbnQKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIAogIC8vR2l2ZSByZWFsdGltZSB0b3RhbFN1cHBseSBvZiBFWEggdG9rZW4KICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgLy9HZXQgRVhIIHRva2VuIGJhbGFuY2UgZm9yIHByb3ZpZGVkIGFkZHJlc3MgaW4gbG93ZXN0IGRlbm9taW5hdGlvbgogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQpOwoKICAvL1RyYW5zZmVyIEVYSCB0b2tlbiB0byBwcm92aWRlZCBhZGRyZXNzCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sIG9rKTsKCiAgLy9FbWl0IFRyYW5zZmVyIGV2ZW50IG91dHNpZGUgb2YgYmxvY2tjaGFpbiBmb3IgZXZlcnkgRVhIIHRva2VuIHRyYW5zZmVycwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludCBfdmFsdWUpOwp9CgovKioKICogQ29udHJhY3QgIkVSQzIwIgogKiBQdXJwb3NlOiBEZWZpbmluZyBFUkMyMCBzdGFuZGFyZCB3aXRoIG1vcmUgYWR2YW5jZWQgZnVuY3Rpb25hbGl0eSBsaWtlIC0gQXV0aG9yaXplIHNwZW5kZXIgdG8gdHJhbnNmZXIgRVhIIHRva2VuCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKCiAgLy9HZXQgRVhIIHRva2VuIGFtb3VudCB0aGF0IHNwZW5kZXIgY2FuIHNwZW5kIGZyb20gcHJvdmlkZWQgb3duZXIncyBhY2NvdW50IAogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KTsKCiAgLy9UcmFuc2ZlciBpbml0aWF0ZWQgYnkgc3BlbmRlciAKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sIG9rKTsKCiAgLy9BZGQgc3BlbmRlciB0byBhdXRocml6ZSBmb3Igc3BlbmRpbmcgc3BlY2lmaWVkIGFtb3VudCBvZiBFWEggVG9rZW4KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sIG9rKTsKCiAgLy9FbWl0IGV2ZW50IGZvciBhbnkgYXBwcm92YWwgcHJvdmlkZWQgdG8gc3BlbmRlcgogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOwp9CgoKLyoqCiAqIENvbnRyYWN0ICJPd25hYmxlIgogKiBQdXJwb3NlOiBEZWZpbmVzIE93bmVyIGZvciBjb250cmFjdCBhbmQgcHJvdmlkZSBmdW5jdGlvbmFsaXR5IHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0byBhbm90aGVyIGFjY291bnQKICovCmNvbnRyYWN0IE93bmFibGUgewoKICAvL293bmVyIHZhcmlhYmxlIHRvIHN0b3JlIGNvbnRyYWN0IG93bmVyIGFjY291bnQKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgLy9Db25zdHJ1Y3RvciBmb3IgdGhlIGNvbnRyYWN0IHRvIHN0b3JlIG93bmVyJ3MgYWNjb3VudCBvbiBkZXBsb3llbWVudAogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KICAKICAvL21vZGlmaWVyIHRvIGNoZWNrIHRyYW5zYWN0aW9uIGluaXRpYXRvciBpcyBvbmx5IG93bmVyCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgaWYgKG1zZy5zZW5kZXIgPT0gb3duZXIpCiAgICAgIF87CiAgfQoKICAvL293bmVyc2hpcCBjYW4gYmUgdHJhbnNmZXJyZWQgdG8gcHJvdmlkZWQgbmV3T3duZXIuIEZ1bmN0aW9uIGNhbiBvbmx5IGJlIGluaXRpYXRlZCBieSBjb250cmFjdCBvd25lcidzIGFjY291bnQKICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIGlmIChuZXdPd25lciAhPSBhZGRyZXNzKDApKSAKICAgICAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCi8qKgogKiBDb250cmFjdCAiUGF1c2FibGUiCiAqIFB1cnBvc2U6IENvbnRyYWN0IHRvIHByb3ZpZGUgZnVuY3Rpb25hbGl0eSB0byBwYXVzZSBhbmQgcmVzdW1lIFNhbGUgaW4gY2FzZSBvZiBlbWVyZ2VuY3kKICovCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgewoKICAvL2ZsYWcgdG8gaW5kaWNhdGUgd2hldGhlciBTYWxlIGlzIHBhdXNlZCBvciBub3QKICBib29sIHB1YmxpYyBzdG9wcGVkOwoKICAvL0VtaXQgZXZlbnQgd2hlbiBhbnkgY2hhbmdlIGhhcHBlbnMgaW4gY3Jvd2RzYWxlIHN0YXRlCiAgZXZlbnQgU3RhdGVDaGFuZ2VkKGJvb2wgY2hhbmdlZCk7CgogIC8vbW9kaWZpZXIgdG8gY29udGludWUgd2l0aCB0cmFuc2FjdGlvbiBvbmx5IHdoZW4gU2FsZSBpcyBub3QgcGF1c2VkCiAgbW9kaWZpZXIgc3RvcEluRW1lcmdlbmN5IHsKICAgIHJlcXVpcmUoIXN0b3BwZWQpOwogICAgXzsKICB9CgogIC8vbW9kaWZpZXIgdG8gY29udGludWUgd2l0aCB0cmFuc2FjdGlvbiBvbmx5IHdoZW4gU2FsZSBpcyBwYXVzZWQKICBtb2RpZmllciBvbmx5SW5FbWVyZ2VuY3kgewogICAgcmVxdWlyZShzdG9wcGVkKTsKICAgIF87CiAgfQoKICAvLyBjYWxsZWQgYnkgdGhlIG93bmVyIG9uIGVtZXJnZW5jeSwgcGF1c2UgU2FsZQogIGZ1bmN0aW9uIGVtZXJnZW5jeVN0b3AoKSBleHRlcm5hbCBvbmx5T3duZXIgIHsKICAgIHN0b3BwZWQgPSB0cnVlOwogICAgLy9FbWl0IGV2ZW50IHdoZW4gY3Jvd2RzYWxlIHN0YXRlIGNoYW5nZXMKICAgIFN0YXRlQ2hhbmdlZCh0cnVlKTsKICB9CgogIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW5kIG9mIGVtZXJnZW5jeSwgcmVzdW1lcyBTYWxlCiAgZnVuY3Rpb24gcmVsZWFzZSgpIGV4dGVybmFsIG9ubHlPd25lciBvbmx5SW5FbWVyZ2VuY3kgewogICAgc3RvcHBlZCA9IGZhbHNlOwogICAgLy9FbWl0IGV2ZW50IHdoZW4gY3Jvd2RzYWxlIHN0YXRlIGNoYW5nZXMKICAgIFN0YXRlQ2hhbmdlZCh0cnVlKTsKICB9Cgp9CgovKioKICogQ29udHJhY3QgIkVYSCIKICogUHVycG9zZTogQ3JlYXRlIEVYSCB0b2tlbgogKi8KY29udHJhY3QgRVhIIGlzIEVSQzIwLCBPd25hYmxlIHsKCiAgdXNpbmcgTWF0aCBmb3IgdWludDsKCiAgLyogUHVibGljIHZhcmlhYmxlcyBvZiB0aGUgdG9rZW4gKi8KICAvL1RvIHN0b3JlIG5hbWUgZm9yIHRva2VuCiAgc3RyaW5nIHB1YmxpYyBuYW1lOwoKICAvL1RvIHN0b3JlIHN5bWJvbCBmb3IgdG9rZW4gICAgICAgCiAgc3RyaW5nIHB1YmxpYyBzeW1ib2w7CgogIC8vVG8gc3RvcmUgZGVjaW1hbCBwbGFjZXMgZm9yIHRva2VuCiAgdWludDggcHVibGljIGRlY2ltYWxzOyAgICAKCiAgLy9UbyBzdG9yZSBkZWNpbWFsIHZlcnNpb24gZm9yIHRva2VuCiAgc3RyaW5nIHB1YmxpYyB2ZXJzaW9uID0gJ3YxLjAnOyAKCiAgLy9UbyBzdG9yZSBjdXJyZW50IHN1cHBseSBvZiBFWEggVG9rZW4KICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgLy9mbGFnIHRvIGluZGljYXRlIHdoZXRoZXIgdHJhbnNmZXIgb2YgRVhIIFRva2VuIGlzIGFsbG93ZWQgb3Igbm90CiAgYm9vbCBwdWJsaWMgbG9ja2VkOwoKICAvL21hcCB0byBzdG9yZSBFWEggVG9rZW4gYmFsYW5jZSBjb3JyZXNwb25kaW5nIHRvIGFkZHJlc3MKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgYmFsYW5jZXM7CgogIC8vVG8gc3RvcmUgc3BlbmRlciB3aXRoIGFsbG93ZWQgYW1vdW50IG9mIEVYSCBUb2tlbiB0byBzcGVuZCBjb3JyZXNwb25kaW5nIHRvIEVYSCBUb2tlbiBob2xkZXIncyBhY2NvdW50CiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpKSBhbGxvd2VkOwoKICAvL1RvIGhhbmRsZSBFUkMyMCBzaG9ydCBhZGRyZXNzIGF0dGFjayAgCiAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgc2l6ZSkgewogICAgIHJlcXVpcmUobXNnLmRhdGEubGVuZ3RoID49IHNpemUgKyA0KTsKICAgICBfOwogIH0KICAKICAvLyBMb2NrIHRyYW5zZmVyIGR1cmluZyBTYWxlCiAgbW9kaWZpZXIgb25seVVubG9ja2VkKCkgewogICAgcmVxdWlyZSghbG9ja2VkKTsKICAgIF87CiAgfQoKICAvL0NvbnRydWN0b3IgdG8gZGVmaW5lIEVYSCBUb2tlbiB0b2tlbiBwcm9wZXJ0aWVzCiAgZnVuY3Rpb24gRVhIKCkgcHVibGljIHsKCiAgICAvLyBsb2NrIHRoZSB0cmFuc2ZlciBmdW5jdGlvbiBkdXJpbmcgU2FsZQogICAgbG9ja2VkID0gdHJ1ZTsKCiAgICAvL2luaXRpYWwgdG9rZW4gc3VwcGx5IGlzIDAKICAgIHRvdGFsU3VwcGx5ID0gMDsKCiAgICAvL05hbWUgZm9yIHRva2VuIHNldCB0byBFWEggVG9rZW4KICAgIG5hbWUgPSAnRVhIIFRva2VuJzsKCiAgICAvLyBTeW1ib2wgZm9yIHRva2VuIHNldCB0byAnRVhIJwogICAgc3ltYm9sID0gJ0VYSCc7CiAKICAgIGRlY2ltYWxzID0gMTg7CiAgfQogCiAgLy9JbXBsZW1lbnRhdGlvbiBmb3IgdHJhbnNmZXJyaW5nIEVYSCBUb2tlbiB0byBwcm92aWRlZCBhZGRyZXNzIAogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDIgKiAzMikgcHVibGljIG9ubHlVbmxvY2tlZCByZXR1cm5zIChib29sKXsKCiAgICAvL0NoZWNrIHByb3ZpZGVkIEVYSCBUb2tlbiBzaG91bGQgbm90IGJlIDAKICAgIGlmIChfdmFsdWUgPiAwICYmICEoX3RvID09IGFkZHJlc3MoMCkpKSB7CiAgICAgIC8vZGVkdWN0IEVYSCBUb2tlbiBhbW91bnQgZnJvbSB0cmFuc2FjdGlvbiBpbml0aWF0b3IKICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5TdWIoX3ZhbHVlKTsKICAgICAgLy9BZGQgRVhIIFRva2VuIHRvIGJhbGFjZSBvZiB0YXJnZXQgYWNjb3VudAogICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5BZGQoX3ZhbHVlKTsKICAgICAgLy9FbWl0IGV2ZW50IGZvciB0cmFuc2ZlcnJpbmcgRVhIIFRva2VuCiAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICBlbHNlewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQoKICAvL1RyYW5zZmVyIGluaXRpYXRlZCBieSBzcGVuZGVyIAogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIG9ubHlQYXlsb2FkU2l6ZSgzICogMzIpIHB1YmxpYyBvbmx5VW5sb2NrZWQgcmV0dXJucyAoYm9vbCkgewoKICAgIC8vQ2hlY2sgcHJvdmlkZWQgRVhIIFRva2VuIHNob3VsZCBub3QgYmUgMAogICAgaWYgKF92YWx1ZSA+IDAgJiYgKF90byAhPSBhZGRyZXNzKDApICYmIF9mcm9tICE9IGFkZHJlc3MoMCkpKSB7CiAgICAgIC8vR2V0IGFtb3VudCBvZiBFWEggVG9rZW4gZm9yIHdoaWNoIHNwZW5kZXIgaXMgYXV0aG9yaXplZAogICAgICB2YXIgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOwogICAgICAvL0FkZCBhbW91bnQgb2YgRVhIIFRva2VuIGluIHRyYXJnZXQgYWNjb3VudCdzIGJhbGFuY2UKICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uQWRkKCBfdmFsdWUpOwogICAgICAvL0RlZHVjdCBFWEggVG9rZW4gYW1vdW50IGZyb20gX2Zyb20gYWNjb3VudAogICAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uU3ViKCBfdmFsdWUpOwogICAgICAvL0RlZHVjdCBBdXRob3JpemVkIGFtb3VudCBmb3Igc3BlbmRlcgogICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2UuU3ViKCBfdmFsdWUpOwogICAgICAvL0VtaXQgZXZlbnQgZm9yIFRyYW5zZmVyCiAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfWVsc2V7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9CgogIC8vR2V0IEVYSCBUb2tlbiBiYWxhbmNlIGZvciBwcm92aWRlZCBhZGRyZXNzCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9CiAgCiAgLy9BZGQgc3BlbmRlciB0byBhdXRob3JpemUgZm9yIHNwZW5kaW5nIHNwZWNpZmllZCBhbW91bnQgb2YgRVhIIFRva2VuIAogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF9zcGVuZGVyICE9IGFkZHJlc3MoMCkpOwogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAvL0VtaXQgZXZlbnQgZm9yIGFwcHJvdmFsIHByb3ZpZGVkIHRvIHNwZW5kZXIKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvL0dldCBFWEggVG9rZW4gYW1vdW50IHRoYXQgc3BlbmRlciBjYW4gc3BlbmQgZnJvbSBwcm92aWRlZCBvd25lcidzIGFjY291bnQgCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCByZW1haW5pbmcpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KICAKfQoKLyoqCiAqIENvbnRyYWN0ICJDcm93ZHNhbGUiCiAqIFB1cnBvc2U6IENvbnRyYWN0IGZvciBjcm93ZHNhbGUgb2YgRVhIIFRva2VuCiAqLwpjb250cmFjdCBDcm93ZHNhbGUgaXMgRVhILCBQYXVzYWJsZSB7CgogIHVzaW5nIE1hdGggZm9yIHVpbnQ7CiAgCiAgLyogUHVibGljIHZhcmlhYmxlcyBmb3IgU2FsZSAqLwoKICAvLyBTYWxlIHN0YXJ0IGJsb2NrCiAgdWludCBwdWJsaWMgc3RhcnRCbG9jazsgICAKCiAgLy8gU2FsZSBlbmQgYmxvY2sgIAogIHVpbnQgcHVibGljIGVuZEJsb2NrOyAgCgogIC8vIFRvIHN0b3JlIG1heGltdW0gbnVtYmVyIG9mIEVYSCBUb2tlbiB0byBzZWxsCiAgdWludCBwdWJsaWMgbWF4Q2FwOyAgIAoKICAvLyBUbyBzdG9yZSBtYXhpbXVtIG51bWJlciBvZiBFWEggVG9rZW4gdG8gc2VsbCBpbiBQcmVTYWxlCiAgdWludCBwdWJsaWMgbWF4Q2FwUHJlU2FsZTsgICAKCiAgLy8gVG8gc3RvcmUgdG90YWwgbnVtYmVyIG9mIEVUSCByZWNlaXZlZAogIHVpbnQgcHVibGljIEVUSFJlY2VpdmVkOyAgICAKCiAgLy8gTnVtYmVyIG9mIHRva2VucyB0aGF0IGNhbiBiZSBwdXJjaGFzZWQgd2l0aCAxIEV0aGVyCiAgdWludCBwdWJsaWMgUFJJQ0U7ICAgCgogIC8vIFRvIGluZGljYXRlIFNhbGUgc3RhdHVzOyBjcm93ZHNhbGVTdGF0dXM9MCA9PiBjcm93ZHNhbGUgbm90IHN0YXJ0ZWQ7IGNyb3dkc2FsZVN0YXR1cz0xPT4gY3Jvd2RzYWxlIHN0YXJ0ZWQ7IGNyb3dkc2FsZVN0YXR1cz0yPT4gY3Jvd2RzYWxlIGZpbmlzaGVkCiAgdWludCBwdWJsaWMgY3Jvd2RzYWxlU3RhdHVzOyAKCiAgLy8gVG8gc3RvcmUgY3Jvd2RTYWxlIHR5cGU7IGNyb3dkU2FsZVR5cGU9MCA9PiBQcmVTYWxlOyBjcm93ZFNhbGVUeXBlPTEgPT4gQ3Jvd2RTYWxlCiAgdWludCBwdWJsaWMgY3Jvd2RTYWxlVHlwZTsgCgogIC8vVG90YWwgU3VwcGx5IGluIFByZVNhbGUKICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseVByZVNhbGU7IAoKICAvL05vIG9mIGRheXMgZm9yIHdoaWNoIHByZXNhbGUgd2lsbCBiZSBvcGVuCiAgdWludCBwdWJsaWMgZHVyYXRpb25QcmVTYWxlOwoKICAvL1ZhbHVlIG9mIDEgZXRoZXIsIGllLCAxIGZvbGxvd2VkIGJ5IDE4IHplcm8KICB1aW50IHZhbHVlT25lRXRoZXIgPSAxZTE4OwoKICAvL05vIG9mIGRheXMgZm9yIHdoaWNoIHRoZSBjb21wbGV0ZSBjcm93ZHNhbGUgd2lsbCBydW4tIHByZXNhbGUgICsgY3Jvd2RzYWxlCiAgdWludCBwdWJsaWMgZHVyYXRpb25Dcm93ZFNhbGU7CgogIC8vU3RvcmUgdG90YWwgbnVtYmVyIG9mIGludmVzdG9ycwogIHVpbnQgcHVibGljIGNvdW50VG90YWxJbnZlc3RvcnM7CgogIC8vTnVtYmVyIG9mIGludmVzdG9ycyB3aG8gaGF2ZSByZWNlaXZlZCByZWZ1bmQKICB1aW50IHB1YmxpYyBjb3VudEludmVzdG9yc1JlZnVuZGVkOwogIAogIC8vU2V0IHN0YXR1cyBvZiByZWZ1bmQKICB1aW50IHB1YmxpYyByZWZ1bmRTdGF0dXM7CgogLy9tYXhDQXAgZm9yIG1pbnQgYW5kIHRyYW5zZmVyCiAgdWludCBwdWJsaWMgbWF4Q2FwTWludFRyYW5zZmVyIDsKCiAgLy90b3RhbCBzdXBwbHkgZm9yIG1pbnQgYW5kIHRyYW5zZmVyCiAgdWludCBwdWJsaWMgdG90YWxTdXBwbHlNaW50VHJhbnNmZXI7CgogIC8vdG90YWwgdG9rZW5zIHNvbGQgaW4gY3Jvd2RzYWxlCiAgdWludCBwdWJsaWMgdG90YWxTdXBwbHlDcm93ZHNhbGU7CgogIC8vU3RvcmVzIHRvdGFsIGludmVzdHJvcyBpbiBjcm93ZHNhbGUKICB1aW50MjU2IHB1YmxpYyBjb3VudFRvdGFsSW52ZXN0b3JzSW5Dcm93ZHNhbGU7CgogIHVpbnQyNTYgcHVibGljIGNvdW50SW52ZXN0b3JzUmVmdW5kZWRJbkNyb3dkc2FsZTsKCiAgLy9TdHJ1Y3R1cmUgZm9yIGludmVzdG9yczsgaG9sZHMgcmVjZWl2ZWQgd2VpIGFtb3VudCBhbmQgRVhIIFRva2VuIHNlbnQKICBzdHJ1Y3QgSW52ZXN0b3IgewogICAgLy93ZWkgcmVjZWl2ZWQgZHVyaW5nIFByZVNhbGUKICAgIHVpbnQgd2VpUmVjZWl2ZWRDcm93ZHNhbGVUeXBlMDsKICAgIC8vd2VpIHJlY2VpdmVkIGR1cmluZyBDcm93ZFNhbGUKICAgIHVpbnQgd2VpUmVjZWl2ZWRDcm93ZHNhbGVUeXBlMTsKICAgIC8vVG9rZW5zIHNlbnQgZHVyaW5nIFByZVNhbGUKICAgIHVpbnQgZXhoU2VudENyb3dkc2FsZVR5cGUwOwogICAgLy9Ub2tlbnMgc2VudCBkdXJpbmcgQ3Jvd2RTYWxlCiAgICB1aW50IGV4aFNlbnRDcm93ZHNhbGVUeXBlMTsKICAgIC8vVW5pcXVlbHkgaWRlbnRpZnkgYW4gaW52ZXN0b3IodXNlZCBmb3IgaXRlcmF0aW5nKQogICAgdWludCBpbnZlc3RvcklEOwogIH0KCiAgLy9pbnZlc3RvcnMgaW5kZXhlZCBieSB0aGVpciBFVEggYWRkcmVzcwogIG1hcHBpbmcoYWRkcmVzcyA9PiBJbnZlc3RvcikgcHVibGljIGludmVzdG9yczsKICAvL2ludmVzdG9ycyBpbmRleGVkIGJ5IHRoZWlyIElEcwogIG1hcHBpbmcgKHVpbnQgPT4gYWRkcmVzcykgcHVibGljIGludmVzdG9yTGlzdDsKCiAgCiAgLy9FbWl0IGV2ZW50IG9uIHJlY2VpdmluZyBFVEgKICBldmVudCBSZWNlaXZlZEVUSChhZGRyZXNzIGFkZHIsIHVpbnQgdmFsdWUpOwoKICAvL0VtaXQgZXZlbnQgb24gdHJhbnNmZXJyaW5nIEVYSCBUb2tlbiB0byB1c2VyIHdoZW4gcGF5bWVudCBpcyByZWNlaXZlZCBpbiB0cmFkaXRpb25hbCB3YXlzIG9yIEIgdHlwZSBFWEggVG9rZW4gY29udmVydGVkIHRvIEEgdHlwZSBFWEggVG9rZW4KICBldmVudCBNaW50QW5kVHJhbnNmZXJFWEgoYWRkcmVzcyBhZGRyLCB1aW50IHZhbHVlLCBieXRlczMyIGNvbW1lbnQpOwoKICAvL2NvbnN0cnVjdG9yIHRvIGluaXRpYWxpemUgY29udHJhY3QgdmFyaWFibGVzCiAgZnVuY3Rpb24gQ3Jvd2RzYWxlKCkgcHVibGljIHsKCiAgICAvL1dpbGwgYmUgc2V0IGluIGZ1bmN0aW9uIHN0YXJ0OyBNYWtlcyBzdXJlIFNhbGUgd2lsbCBiZSBzdGFydGVkIG9ubHkgd2hlbiBzdGFydCgpIGZ1bmN0aW9uIGlzIGNhbGxlZAogICAgc3RhcnRCbG9jayA9IDA7ICAgCiAgICAvL1dpbGwgYmUgc2V0IGluIGZ1bmN0aW9uIHN0YXJ0OyBNYWtlcyBzdXJlIFNhbGUgd2lsbCBiZSBzdGFydGVkIG9ubHkgd2hlbiBzdGFydCgpIGZ1bmN0aW9uIGlzIGNhbGxlZCAgICAgICAgCiAgICBlbmRCbG9jayA9IDA7ICAgIAogICAgLy9NYXggbnVtYmVyIG9mIEVYSCBUb2tlbiB0byBzZWxsIGluIENyb3dkU2FsZVtJbmNsdWRlcyB0aGUgdG9rZW5zIHNvbGQgaW4gcHJlc2FsZV0oMzNNKQogICAgbWF4Q2FwID0gMzE3NTAwMDBlMTg7CiAgICAvL01heCBudW1iZXIgb2YgRVhIIFRva2VuIHRvIHNlbGwgaW4gUHJlc2FsZSgwLjVNKQogICAgbWF4Q2FwUHJlU2FsZSA9IDUwMDAwMGUxODsKICAgIC8vMTI1MDAwMCBUb2tlbnMgYXZhbGFibGUgZm9yIE1pbnQgYW5kIFRyYW5zZmVyCiAgICBtYXhDYXBNaW50VHJhbnNmZXIgPSAxMjUwMDAwZTE4OwogICAgLy8gRVhIIFRva2VuIHBlciBldGhlcgogICAgUFJJQ0UgPSAxMDsgCiAgICAvL0luZGljYXRlcyBTYWxlIHN0YXR1czsgU2FsZSBpcyBub3Qgc3RhcnRlZCB5ZXQKICAgIGNyb3dkc2FsZVN0YXR1cyA9IDA7ICAgIAogICAgLy9BdCB0aW1lIG9mIGRlcGxveW1lbnQgY3Jvd2RTYWxlIHR5cGUgaXMgc2V0IHRvIFByZXNhbGUKICAgIGNyb3dkU2FsZVR5cGUgPSAwOwogICAgLy8gTnVtYmVyIG9mIGRheXMgYWZ0ZXIgd2hpY2ggc2FsZSB3aWxsIHN0YXJ0IHNpbmNlIHRoZSBzdGFydGluZyBvZiBwcmVzYWxlLCBhIHNpbmdsZSB2YWx1ZSB0byByZXBsYWNlIHRoZSBoYXJkY29kZWQKICAgIGR1cmF0aW9uUHJlU2FsZSA9IDIgaG91cnMgKyAzMCBtaW51dGVzOwogICAgLy8gTnVtYmVyIG9mIGRheXMgZm9yIHdoaWNoIGNvbXBsZXRlIGNyb3dkc2FsZSB3aWxsIHJ1biwgaWUsIHByZXNhbGUgYW5kIGNyb3dkc2FsZSBwZXJpb2QKICAgIGR1cmF0aW9uQ3Jvd2RTYWxlID0gMiBob3VyczsKICAgIC8vIEludmVzdG9yIGNvdW50IGlzIDAgaW5pdGlhbGx5CiAgICBjb3VudFRvdGFsSW52ZXN0b3JzID0gMDsKICAgIC8vSW5pdGlhbGx5IG5vIGludmVzdG9yIGhhcyBiZWVuIHJlZnVuZGVkCiAgICBjb3VudEludmVzdG9yc1JlZnVuZGVkID0gMDsKICAgIC8vUmVmdW5kIGVsaWdpYmxlIG9yIG5vdAogICAgcmVmdW5kU3RhdHVzID0gMDsKCiAgICBjb3VudFRvdGFsSW52ZXN0b3JzSW5Dcm93ZHNhbGUgPSAwOwogICAgY291bnRJbnZlc3RvcnNSZWZ1bmRlZEluQ3Jvd2RzYWxlID0gMDsKICAgIAogIH0KCiAgLy9Nb2RpZmllciB0byBtYWtlIHN1cmUgdHJhbnNhY3Rpb24gaXMgaGFwcGVuaW5nIGR1cmluZyBTYWxlCiAgbW9kaWZpZXIgcmVzcGVjdFRpbWVGcmFtZSgpIHsKICAgIGFzc2VydCghKChub3cgPCBzdGFydEJsb2NrKSB8fCAobm93ID4gZW5kQmxvY2sgKSkpOwogICAgXzsKICB9CgogIC8qCiAgKiBUbyBzdGFydCBTYWxlIGZyb20gUHJlc2FsZQogICovCiAgZnVuY3Rpb24gc3RhcnQoKSBwdWJsaWMgb25seU93bmVyIHsKICAgIC8vU2V0IGJsb2NrIG51bWJlciB0byBjdXJyZW50IGJsb2NrIG51bWJlcgogICAgYXNzZXJ0KHN0YXJ0QmxvY2sgPT0gMCk7CiAgICBzdGFydEJsb2NrID0gbm93OyAgICAgICAgICAgIAogICAgLy9TZXQgZW5kIGJsb2NrIG51bWJlcgogICAgZW5kQmxvY2sgPSBub3cuQWRkKGR1cmF0aW9uQ3Jvd2RTYWxlLkFkZChkdXJhdGlvblByZVNhbGUpKTsKICAgIC8vU2FsZSBwcmVzYWxlIGlzIHN0YXJ0ZWQKICAgIGNyb3dkc2FsZVN0YXR1cyA9IDE7CiAgICAvL0VtaXQgZXZlbnQgd2hlbiBjcm93ZHNhbGUgc3RhdGUgY2hhbmdlcwogICAgU3RhdGVDaGFuZ2VkKHRydWUpOyAgCiAgfQoKICAvKgogICogVG8gc3RhcnQgQ3Jvd2RzYWxlCiAgKi8KICBmdW5jdGlvbiBzdGFydFNhbGUoKSBwdWJsaWMgb25seU93bmVyCiAgewogICAgaWYobm93ID4gc3RhcnRCbG9jay5BZGQoZHVyYXRpb25QcmVTYWxlKSAmJiBub3cgPD0gZW5kQmxvY2spewogICAgICAgIGNyb3dkc2FsZVN0YXR1cyA9IDE7CiAgICAgICAgY3Jvd2RTYWxlVHlwZSA9IDE7CiAgICAgICAgaWYoY3Jvd2RTYWxlVHlwZSAhPSAxKQogICAgICAgIHsKICAgICAgICAgIHRvdGFsU3VwcGx5Q3Jvd2RzYWxlID0gdG90YWxTdXBwbHlQcmVTYWxlOwogICAgICAgIH0KICAgICAgICAvL0VtaXQgZXZlbnQgd2hlbiBjcm93ZHNhbGUgc3RhdGUgY2hhbmdlcwogICAgICAgIFN0YXRlQ2hhbmdlZCh0cnVlKTsgCiAgICB9CiAgICBlbHNlCiAgICAgIHJldmVydCgpOwogIH0KCiAgLyoKICAqIFRvIGV4dGVuZCBkdXJhdGlvbiBvZiBDcm93ZHNhbGUKICAqLwogIGZ1bmN0aW9uIHVwZGF0ZUR1cmF0aW9uKHVpbnQgdGltZSkgcHVibGljIG9ubHlPd25lcgogIHsKICAgICAgcmVxdWlyZSh0aW1lICE9IDApOwogICAgICBhc3NlcnQoc3RhcnRCbG9jayAhPSAwKTsKICAgICAgYXNzZXJ0KGNyb3dkU2FsZVR5cGUgPT0gMSAmJiBjcm93ZHNhbGVTdGF0dXMgIT0gMik7CiAgICAgIGR1cmF0aW9uQ3Jvd2RTYWxlID0gZHVyYXRpb25Dcm93ZFNhbGUuQWRkKHRpbWUpOwogICAgICBlbmRCbG9jayA9IGVuZEJsb2NrLkFkZCh0aW1lKTsKICAgICAgLy9FbWl0IGV2ZW50IHdoZW4gY3Jvd2RzYWxlIHN0YXRlIGNoYW5nZXMKICAgICAgU3RhdGVDaGFuZ2VkKHRydWUpOwogIH0KCiAgLyoKICAqIFRvIHNldCBwcmljZSBmb3IgRVhIIFRva2VuCiAgKi8KICBmdW5jdGlvbiBzZXRQcmljZSh1aW50IHByaWNlKSBwdWJsaWMgb25seU93bmVyCiAgewogICAgICByZXF1aXJlKCBwcmljZSAhPSAwKTsKICAgICAgUFJJQ0UgPSBwcmljZTsKICAgICAgLy9FbWl0IGV2ZW50IHdoZW4gY3Jvd2RzYWxlIHN0YXRlIGNoYW5nZXMKICAgICAgU3RhdGVDaGFuZ2VkKHRydWUpOwogIH0KICAKICAvKgogICogVG8gZW5hYmxlIHRyYW5zZmVycyBvZiBFWEggVG9rZW4gYWZ0ZXIgY29tcGxldGlvbiBvZiBTYWxlCiAgKi8KICBmdW5jdGlvbiB1bmxvY2soKSBwdWJsaWMgb25seU93bmVyCiAgewogICAgbG9ja2VkID0gZmFsc2U7CiAgICAvL0VtaXQgZXZlbnQgd2hlbiBjcm93ZHNhbGUgc3RhdGUgY2hhbmdlcwogICAgU3RhdGVDaGFuZ2VkKHRydWUpOwogIH0KICAKICAvL2ZhbGxiYWNrIGZ1bmN0aW9uIGkuZS4gcGF5YWJsZTsgaW5pdGlhdGVzIHdoZW4gYW55IGFkZHJlc3MgdHJhbnNmZXJzIEV0aCB0byBDb250cmFjdCBhZGRyZXNzCiAgZnVuY3Rpb24gKCkgcHVibGljIHBheWFibGUgewogIC8vY2FsbCBjcmVhdGVUb2tlbiBmdW5jdGlvbiB3aXRoIGFjY291bnQgd2hvIHRyYW5zZmVycmVkIEV0aCB0byBjb250cmFjdCBhZGRyZXNzCiAgICBjcmVhdGVUb2tlbnMobXNnLnNlbmRlcik7CiAgfQoKICAvKgogICogVG8gY3JlYXRlIEVYSCBUb2tlbiBhbmQgYXNzaWduIHRvIHRyYW5zYWN0aW9uIGluaXRpYXRvcgogICovCiAgZnVuY3Rpb24gY3JlYXRlVG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnkpIGludGVybmFsIHN0b3BJbkVtZXJnZW5jeSAgcmVzcGVjdFRpbWVGcmFtZSB7CiAgICAvL01ha2Ugc3VyZSBTYWxlIGlzIHJ1bm5pbmcKICAgIGFzc2VydChjcm93ZHNhbGVTdGF0dXMgPT0gMSk7IAogICAgLy9Eb24ndCBhY2NlcHQgZnVuZCB0byBwdXJjaGFzZSBsZXNzIHRoYW4gMSBFWEggVG9rZW4gICAKICAgIHJlcXVpcmUobXNnLnZhbHVlID49IDEgZXRoZXIvZ2V0UHJpY2UoKSk7ICAgCiAgICAvL01ha2Ugc3VyZSBzZW50IEV0aCBpcyBub3QgMCAgICAgICAgICAgCiAgICByZXF1aXJlKG1zZy52YWx1ZSAhPSAwKTsKICAgIC8vQ2FsY3VsYXRlIEVYSCBUb2tlbiB0byBzZW5kCiAgICB1aW50IGV4aFRvU2VuZCA9IG1zZy52YWx1ZS5NdWwoZ2V0UHJpY2UoKSk7CgogICAgLy9NYWtlIGVudHJ5IGluIEludmVzdG9yIGluZGV4ZWQgd2l0aCBhZGRyZXNzCiAgICBJbnZlc3RvciBzdG9yYWdlIGludmVzdG9yU3RydWN0ID0gaW52ZXN0b3JzW2JlbmVmaWNpYXJ5XTsKCiAgICAvLyBGb3IgUHJlc2FsZQogICAgaWYoY3Jvd2RTYWxlVHlwZSA9PSAwKXsKICAgICAgcmVxdWlyZShleGhUb1NlbmQuQWRkKHRvdGFsU3VwcGx5UHJlU2FsZSkgPD0gbWF4Q2FwUHJlU2FsZSk7CiAgICAgIHRvdGFsU3VwcGx5UHJlU2FsZSA9IHRvdGFsU3VwcGx5UHJlU2FsZS5BZGQoZXhoVG9TZW5kKTsKICAgICAgaWYoKG1heENhcFByZVNhbGUuU3ViKHRvdGFsU3VwcGx5UHJlU2FsZSkgPCB2YWx1ZU9uZUV0aGVyKXx8KG5vdyA+IChzdGFydEJsb2NrLkFkZCgyIGhvdXJzICsgMTUgbWludXRlcykpKSl7CiAgICAgICAgY3Jvd2RzYWxlU3RhdHVzID0gMjsKICAgICAgfSAgICAgICAgCiAgICAgIGludmVzdG9yU3RydWN0LndlaVJlY2VpdmVkQ3Jvd2RzYWxlVHlwZTAgPSBpbnZlc3RvclN0cnVjdC53ZWlSZWNlaXZlZENyb3dkc2FsZVR5cGUwLkFkZChtc2cudmFsdWUpOwogICAgICBpbnZlc3RvclN0cnVjdC5leGhTZW50Q3Jvd2RzYWxlVHlwZTAgPSBpbnZlc3RvclN0cnVjdC5leGhTZW50Q3Jvd2RzYWxlVHlwZTAuQWRkKGV4aFRvU2VuZCk7CiAgICB9CgogICAgLy8gRm9yIENyb3dkU2FsZQogICAgZWxzZSBpZiAoY3Jvd2RTYWxlVHlwZSA9PSAxKXsKICAgICAgaWYgKGV4aFRvU2VuZC5BZGQodG90YWxTdXBwbHkpID4gbWF4Q2FwICkgewogICAgICAgIHJldmVydCgpOwogICAgICB9CiAgICAgIHRvdGFsU3VwcGx5Q3Jvd2RzYWxlID0gdG90YWxTdXBwbHlDcm93ZHNhbGUuQWRkKGV4aFRvU2VuZCk7CiAgICAgIGlmKG1heENhcC5TdWIodG90YWxTdXBwbHlDcm93ZHNhbGUpIDwgdmFsdWVPbmVFdGhlcikKICAgICAgewogICAgICAgIGNyb3dkc2FsZVN0YXR1cyA9IDI7CiAgICAgIH0KICAgICAgaWYoaW52ZXN0b3JTdHJ1Y3QuaW52ZXN0b3JJRCA9PSAwIHx8IGludmVzdG9yU3RydWN0LndlaVJlY2VpdmVkQ3Jvd2RzYWxlVHlwZTEgPT0gMCl7CiAgICAgICAgY291bnRUb3RhbEludmVzdG9yc0luQ3Jvd2RzYWxlKys7CiAgICAgIH0KICAgICAgaW52ZXN0b3JTdHJ1Y3Qud2VpUmVjZWl2ZWRDcm93ZHNhbGVUeXBlMSA9IGludmVzdG9yU3RydWN0LndlaVJlY2VpdmVkQ3Jvd2RzYWxlVHlwZTEuQWRkKG1zZy52YWx1ZSk7CiAgICAgIGludmVzdG9yU3RydWN0LmV4aFNlbnRDcm93ZHNhbGVUeXBlMSA9IGludmVzdG9yU3RydWN0LmV4aFNlbnRDcm93ZHNhbGVUeXBlMS5BZGQoZXhoVG9TZW5kKTsKICAgIH0KCiAgICAvL0lmIGl0IGlzIGEgbmV3IGludmVzdG9yLCB0aGVuIGNyZWF0ZSBhIG5ldyBpZAogICAgaWYoaW52ZXN0b3JTdHJ1Y3QuaW52ZXN0b3JJRCA9PSAwKXsKICAgICAgICBjb3VudFRvdGFsSW52ZXN0b3JzKys7CiAgICAgICAgaW52ZXN0b3JTdHJ1Y3QuaW52ZXN0b3JJRCA9IGNvdW50VG90YWxJbnZlc3RvcnM7CiAgICAgICAgaW52ZXN0b3JMaXN0W2NvdW50VG90YWxJbnZlc3RvcnNdID0gYmVuZWZpY2lhcnk7CiAgICB9CgogICAgLy91cGRhdGUgdG90YWwgc3VwcGx5IG9mIEVYSCBUb2tlbgogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5BZGQoZXhoVG9TZW5kKTsKICAgIC8vIFVwZGF0ZSB0aGUgdG90YWwgd2VpIGNvbGxlY3RlZCBkdXJpbmcgU2FsZQogICAgRVRIUmVjZWl2ZWQgPSBFVEhSZWNlaXZlZC5BZGQobXNnLnZhbHVlKTsgIAogICAgLy9VcGRhdGUgRVhIIFRva2VuIGJhbGFuY2UgZm9yIHRyYW5zYWN0aW9uIGluaXRpYXRvcgogICAgYmFsYW5jZXNbYmVuZWZpY2lhcnldID0gYmFsYW5jZXNbYmVuZWZpY2lhcnldLkFkZChleGhUb1NlbmQpOwogICAgLy9FbWl0IGV2ZW50IGZvciBjb250cmlidXRpb24KICAgIFJlY2VpdmVkRVRIKGJlbmVmaWNpYXJ5LEVUSFJlY2VpdmVkKTsgCiAgICAvL0VUSFJlY2VpdmVkIGR1cmluZyBTYWxlIHdpbGwgcmVtYWluIHdpdGggY29udHJhY3QKICAgIEdldEVYSEZ1bmRBY2NvdW50KCkudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgIC8vRW1pdCBldmVudCB3aGVuIGNyb3dkc2FsZSBzdGF0ZSBjaGFuZ2VzCiAgICBTdGF0ZUNoYW5nZWQodHJ1ZSk7CiAgfQoKICAvKgogICogVG8gZW5hYmxlIHZlc3Rpbmcgb2YgQiB0eXBlIEVYSCBUb2tlbgogICovCiAgZnVuY3Rpb24gTWludEFuZFRyYW5zZmVyVG9rZW4oYWRkcmVzcyBiZW5lZmljaWFyeSx1aW50IGV4aFRvQ3JlZGl0LGJ5dGVzMzIgY29tbWVudCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIC8vQXZhaWxhYmxlIGFmdGVyIHRoZSBjcm93ZHNhbGUgaXMgc3RhcnRlZAogICAgYXNzZXJ0KHN0YXJ0QmxvY2sgIT0gMCk7CiAgICAvL0NoZWNrIHdoZXRoZXIgdG9rZW5zIGFyZSBhdmFpbGFibGUgb3Igbm90CiAgICBhc3NlcnQodG90YWxTdXBwbHlNaW50VHJhbnNmZXIgPD0gbWF4Q2FwTWludFRyYW5zZmVyKTsKICAgIC8vQ2hlY2sgd2hldGhlciB0aGUgYW1vdW50IG9mIHRva2VuIGFyZSBhdmFpbGFibGUgdG8gdHJhbnNmZXIKICAgIHJlcXVpcmUodG90YWxTdXBwbHlNaW50VHJhbnNmZXIuQWRkKGV4aFRvQ3JlZGl0KSA8PSBtYXhDYXBNaW50VHJhbnNmZXIpOwogICAgLy9VcGRhdGUgRVhIIFRva2VuIGJhbGFuY2UgZm9yIGJlbmVmaWNpYXJ5CiAgICBiYWxhbmNlc1tiZW5lZmljaWFyeV0gPSBiYWxhbmNlc1tiZW5lZmljaWFyeV0uQWRkKGV4aFRvQ3JlZGl0KTsKICAgIC8vVXBkYXRlIHRvdGFsIHN1cHBseSBmb3IgRVhIIFRva2VuCiAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LkFkZChleGhUb0NyZWRpdCk7CiAgICAvL3VwZGF0ZSB0b3RhbCBzdXBwbHkgZm9yIEVYSCB0b2tlbiBpbiBtaW50IGFuZCB0cmFuc2ZlcgogICAgdG90YWxTdXBwbHlNaW50VHJhbnNmZXIgPSB0b3RhbFN1cHBseU1pbnRUcmFuc2Zlci5BZGQoZXhoVG9DcmVkaXQpOwogICAgLy8gc2VuZCBldmVudCBmb3IgdHJhbnNmZXJyaW5nIEVYSCBUb2tlbiBvbiBvZmZsaW5lIHBheW1lbnQKICAgIE1pbnRBbmRUcmFuc2ZlckVYSChiZW5lZmljaWFyeSwgZXhoVG9DcmVkaXQsY29tbWVudCk7CiAgICAvL0VtaXQgZXZlbnQgd2hlbiBjcm93ZHNhbGUgc3RhdGUgY2hhbmdlcwogICAgU3RhdGVDaGFuZ2VkKHRydWUpOyAgCiAgfQoKICAvKgogICogVG8gZ2V0IHByaWNlIGZvciBFWEggVG9rZW4KICAqLwogIGZ1bmN0aW9uIGdldFByaWNlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcmVzdWx0KSB7CiAgICAgIGlmIChjcm93ZFNhbGVUeXBlID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIChQUklDRS5NdWwoMTAwKSkuRGl2KDcwKTsKICAgICAgfQogICAgICBpZiAoY3Jvd2RTYWxlVHlwZSA9PSAxKSB7CiAgICAgICAgICB1aW50IGNyb3dkc2FsZVByaWNlQnJhY2tldCA9IDE1IG1pbnV0ZXM7CiAgICAgICAgICB1aW50IHN0YXJ0Q3Jvd2RzYWxlID0gc3RhcnRCbG9jay5BZGQoZHVyYXRpb25QcmVTYWxlKTsKICAgICAgICAgICAgaWYgKG5vdyA+IHN0YXJ0Q3Jvd2RzYWxlICYmIG5vdyA8PSBzdGFydENyb3dkc2FsZS5BZGQoY3Jvd2RzYWxlUHJpY2VCcmFja2V0KSkgewogICAgICAgICAgICAgICAgcmV0dXJuICgoUFJJQ0UuTXVsKDEwMCkpLkRpdig4MCkpOwogICAgICAgICAgICB9ZWxzZSBpZiAobm93ID4gc3RhcnRDcm93ZHNhbGUuQWRkKGNyb3dkc2FsZVByaWNlQnJhY2tldCkgJiYgbm93IDw9IChzdGFydENyb3dkc2FsZS5BZGQoY3Jvd2RzYWxlUHJpY2VCcmFja2V0Lk11bCgyKSkpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gKFBSSUNFLk11bCgxMDApKS5EaXYoODUpOwogICAgICAgICAgICB9ZWxzZSBpZiAobm93ID4gKHN0YXJ0Q3Jvd2RzYWxlLkFkZChjcm93ZHNhbGVQcmljZUJyYWNrZXQuTXVsKDIpKSkgJiYgbm93IDw9IChzdGFydENyb3dkc2FsZS5BZGQoY3Jvd2RzYWxlUHJpY2VCcmFja2V0Lk11bCgzKSkpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gKFBSSUNFLk11bCgxMDApKS5EaXYoOTApOwogICAgICAgICAgICB9ZWxzZSBpZiAobm93ID4gKHN0YXJ0Q3Jvd2RzYWxlLkFkZChjcm93ZHNhbGVQcmljZUJyYWNrZXQuTXVsKDMpKSkgJiYgbm93IDw9IChzdGFydENyb3dkc2FsZS5BZGQoY3Jvd2RzYWxlUHJpY2VCcmFja2V0Lk11bCg0KSkpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gKFBSSUNFLk11bCgxMDApKS5EaXYoOTUpOwogICAgICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIFBSSUNFOwogIH0KCiAgZnVuY3Rpb24gR2V0RVhIRnVuZEFjY291bnQoKSBpbnRlcm5hbCByZXR1cm5zIChhZGRyZXNzKSB7CiAgICB1aW50IHJlbWFpbmRlciA9IGJsb2NrLm51bWJlciUxMDsKICAgIGlmKHJlbWFpbmRlcj09MCl7CiAgICAgIHJldHVybiAweGRhMTQxZTcwNDYwMWY4QzhFMzQzQzVjQTI0NjM1NWM4MTIyMzhEOTE7CiAgICB9IGVsc2UgaWYocmVtYWluZGVyPT0xKXsKICAgICAgcmV0dXJuIDB4MjM4MTk2MzkwNkM0MzRkRDQ2Mzk0ODlCZWM5QTJiQjU1RDgzY0MxNDsKICAgIH0gZWxzZSBpZihyZW1haW5kZXI9PTIpewogICAgICByZXR1cm4gMHg1MzdDNzExOTQ1MkE3ODE0QUJEMUM0RUQ3MUY2ZUNEMjUyMjVDMEY2OwogICAgfSBlbHNlIGlmKHJlbWFpbmRlcj09Myl7CiAgICAgIHJldHVybiAweDFGMDQ4ODBmRmRGZmYwNWQzNjMwN2Y2OUVBQWM4NjQ1Qjk4NDQ5RTI7CiAgICB9IGVsc2UgaWYocmVtYWluZGVyPT00KXsKICAgICAgcmV0dXJuIDB4ZDcyQjgyYjY5RkVlMjlkODFmNWUyREE2NmFCOTEwMTRhRGFFMEFBMDsKICAgIH0gZWxzZSBpZihyZW1haW5kZXI9PTUpewogICAgICByZXR1cm4gMHhmNjNiZWY2QjY3MDY0MDUzMTkxZGM0YkM2RjFEMDY1OTJDMDc5MjVmOwogICAgfSBlbHNlIGlmKHJlbWFpbmRlcj09Nil7CiAgICAgIHJldHVybiAweDczODFGOUM1ZDM1RTg5NWU4MGFEZUMxZTFBMzU0MTg2MEY4NzY2MDA7CiAgICB9IGVsc2UgaWYocmVtYWluZGVyPT03KXsKICAgICAgcmV0dXJuIDB4MzcwMzAxQUU0NjU5RDI5NzViZTlGOTc2MDExYzc4N0VDNTllMDY0NTsKICAgIH0gZWxzZSBpZihyZW1haW5kZXI9PTgpewogICAgICByZXR1cm4gMHgyQzA0MWI2QTdmRjI3Nzk2NmNCMGI0Y2I5NjZhYUI4RmMxMTc4YWM1OwogICAgfWVsc2UgewogICAgICByZXR1cm4gMHg4QTQwMTI5MEEzOURjOEQwNDZlNDJCQUJhZjVhODE4ZTI5YWU0ZmRhOwogICAgfQogIH0KCiAgLyoKICAqIEZpbmFsaXplIHRoZSBjcm93ZHNhbGUKICAqLwogIGZ1bmN0aW9uIGZpbmFsaXplKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAvL01ha2Ugc3VyZSBTYWxlIGlzIHJ1bm5pbmcKICAgIGFzc2VydChjcm93ZHNhbGVTdGF0dXM9PTEgJiYgY3Jvd2RTYWxlVHlwZT09MSk7CiAgICAvLyBjYW5ub3QgZmluYWxpc2UgYmVmb3JlIGVuZCBvciB1bnRpbCBtYXhjYXAgaXMgcmVhY2hlZAogICAgICBhc3NlcnQoISgodG90YWxTdXBwbHlDcm93ZHNhbGUgPCBtYXhDYXAgJiYgbm93IDwgZW5kQmxvY2spICYmIChtYXhDYXAuU3ViKHRvdGFsU3VwcGx5Q3Jvd2RzYWxlKSA+PSB2YWx1ZU9uZUV0aGVyKSkpOyAgCiAgICAgIC8vSW5kaWNhdGVzIFNhbGUgaXMgZW5kZWQKICAgICAgCiAgICAgIC8vQ2hlY2tzIGlmIHRoZSBmdW5kcmFpc2luZyBnb2FsIGlzIHJlYWNoZWQgaW4gY3Jvd2RzYWxlIG9yIG5vdAogICAgICBpZiAodG90YWxTdXBwbHkgPCA1MzAwMDAwZTE4KQogICAgICAgIHJlZnVuZFN0YXR1cyA9IDI7CiAgICAgIGVsc2UKICAgICAgICByZWZ1bmRTdGF0dXMgPSAxOwogICAgICAKICAgIC8vY3Jvd2RzYWxlIGlzIGVuZGVkCiAgICBjcm93ZHNhbGVTdGF0dXMgPSAyOwogICAgLy9FbWl0IGV2ZW50IHdoZW4gY3Jvd2RzYWxlIHN0YXRlIGNoYW5nZXMKICAgIFN0YXRlQ2hhbmdlZCh0cnVlKTsKICB9CgogIC8qCiAgKiBSZWZ1bmQgdGhlIGludmVzdG9ycyBpbiBjYXNlIHRhcmdldCBvZiBjcm93ZHNhbGUgbm90IGFjaGlldmVkCiAgKi8KICBmdW5jdGlvbiByZWZ1bmQoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgYXNzZXJ0KHJlZnVuZFN0YXR1cyA9PSAyKTsKICAgICAgdWludCBiYXRjaFNpemUgPSBjb3VudEludmVzdG9yc1JlZnVuZGVkLkFkZCgzMCkgPCBjb3VudFRvdGFsSW52ZXN0b3JzID8gY291bnRJbnZlc3RvcnNSZWZ1bmRlZC5BZGQoMzApOiBjb3VudFRvdGFsSW52ZXN0b3JzOwogICAgICBmb3IodWludCBpPWNvdW50SW52ZXN0b3JzUmVmdW5kZWQuQWRkKDEpOyBpIDw9IGJhdGNoU2l6ZTsgaSsrKXsKICAgICAgICAgIGFkZHJlc3MgaW52ZXN0b3JBZGRyZXNzID0gaW52ZXN0b3JMaXN0W2ldOwogICAgICAgICAgSW52ZXN0b3Igc3RvcmFnZSBpbnZlc3RvclN0cnVjdCA9IGludmVzdG9yc1tpbnZlc3RvckFkZHJlc3NdOwogICAgICAgICAgLy9JZiBwdXJjaGFzZSBoYXMgYmVlbiBtYWRlIGR1cmluZyBDcm93ZFNhbGUKICAgICAgICAgIGlmKGludmVzdG9yU3RydWN0LmV4aFNlbnRDcm93ZHNhbGVUeXBlMSA+IDAgJiYgaW52ZXN0b3JTdHJ1Y3QuZXhoU2VudENyb3dkc2FsZVR5cGUxIDw9IGJhbGFuY2VzW2ludmVzdG9yQWRkcmVzc10pewogICAgICAgICAgICAgIC8vcmV0dXJuIGV2ZXJ5dGhpbmcKICAgICAgICAgICAgICBpbnZlc3RvckFkZHJlc3MudHJhbnNmZXIoaW52ZXN0b3JTdHJ1Y3Qud2VpUmVjZWl2ZWRDcm93ZHNhbGVUeXBlMSk7CiAgICAgICAgICAgICAgLy9SZWR1Y2UgRVRIUmVjZWl2ZWQKICAgICAgICAgICAgICBFVEhSZWNlaXZlZCA9IEVUSFJlY2VpdmVkLlN1YihpbnZlc3RvclN0cnVjdC53ZWlSZWNlaXZlZENyb3dkc2FsZVR5cGUxKTsKICAgICAgICAgICAgICAvL1VwZGF0ZSB0b3RhbFN1cHBseQogICAgICAgICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuU3ViKGludmVzdG9yU3RydWN0LmV4aFNlbnRDcm93ZHNhbGVUeXBlMSk7CiAgICAgICAgICAgICAgLy8gcmVkdWNlIGJhbGFuY2VzCiAgICAgICAgICAgICAgYmFsYW5jZXNbaW52ZXN0b3JBZGRyZXNzXSA9IGJhbGFuY2VzW2ludmVzdG9yQWRkcmVzc10uU3ViKGludmVzdG9yU3RydWN0LmV4aFNlbnRDcm93ZHNhbGVUeXBlMSk7CiAgICAgICAgICAgICAgLy9zZXQgZXZlcnl0aGluZyB0byB6ZXJvIGFmdGVyIHRyYW5zZmVyIHN1Y2Nlc3NmdWwKICAgICAgICAgICAgICBpbnZlc3RvclN0cnVjdC53ZWlSZWNlaXZlZENyb3dkc2FsZVR5cGUxID0gMDsKICAgICAgICAgICAgICBpbnZlc3RvclN0cnVjdC5leGhTZW50Q3Jvd2RzYWxlVHlwZTEgPSAwOwogICAgICAgICAgICAgIGNvdW50SW52ZXN0b3JzUmVmdW5kZWRJbkNyb3dkc2FsZSA9IGNvdW50SW52ZXN0b3JzUmVmdW5kZWRJbkNyb3dkc2FsZS5BZGQoMSk7CiAgICAgICAgICB9CiAgICAgIH0KICAgICAgLy9VcGRhdGUgdGhlIG51bWJlciBvZiBpbnZlc3RvcnMgdGhhdCBoYXZlIHJlY2lldmVkIHJlZnVuZAogICAgICBjb3VudEludmVzdG9yc1JlZnVuZGVkID0gYmF0Y2hTaXplOwogICAgICBTdGF0ZUNoYW5nZWQodHJ1ZSk7CiAgfQoKICAvKgogICAqIEZhaWxzYWZlIGRyYWluCiAgICovCiAgZnVuY3Rpb24gZHJhaW4oKSBwdWJsaWMgb25seU93bmVyIHsKICAgIEdldEVYSEZ1bmRBY2NvdW50KCkudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICB9CgogIC8qCiAgKiBGdW5jdGlvbiB0byBhZGQgRXRoZXIgaW4gdGhlIGNvbnRyYWN0IAogICovCiAgZnVuY3Rpb24gZnVuZENvbnRyYWN0Rm9yUmVmdW5kKCkgcGF5YWJsZXsKICAgIC8vIFN0YXRlQ2hhbmdlZCh0cnVlKTsKICB9Cgp9'.
	

]
