Class {
	#name : #SRTc890b3450f273209cd19a11d4027e968bdd6f04e,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTc890b3450f273209cd19a11d4027e968bdd6f04e >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgppbnRlcmZhY2UgR2FtZSB7CiAgICBldmVudCBHYW1lU3RhcnRlZCh1aW50IGJldEFtb3VudCk7CiAgICBldmVudCBOZXdQbGF5ZXJBZGRlZCh1aW50IG51bVBsYXllcnMsIHVpbnQgcHJpemVBbW91bnQpOwogICAgZXZlbnQgR2FtZUZpbmlzaGVkKGFkZHJlc3Mgd2lubmVyKTsKCiAgICBmdW5jdGlvbiAoKSBwdWJsaWMgcGF5YWJsZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vUGFydGljaXBhdGUgaW4gZ2FtZS4gUHJveHkgZm9yIHBsYXkgbWV0aG9kCiAgICBmdW5jdGlvbiBnZXRQcml6ZUFtb3VudCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KTsgICAgIC8vR2V0IHBvdGVudGlhbCBvciBhY3R1YWwgcHJpemUgYW1vdW50CiAgICBmdW5jdGlvbiBnZXROdW1XaW5uZXJzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludCwgdWludCk7CiAgICBmdW5jdGlvbiBnZXRQbGF5ZXJzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMoYWRkcmVzc1tdKTsgICAgICAgICAgIC8vR2V0IGZ1bGwgbGlzdCBvZiBwbGF5ZXJzCiAgICBmdW5jdGlvbiBnZXRXaW5uZXJzKCkgcHVibGljIHZpZXcgcmV0dXJucyhhZGRyZXNzW10gbWVtb3J5IHBsYXllcnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnRbXSBtZW1vcnkgcHJpemVzKTsgIC8vR2V0IHdpbm5lcnMuIEFjY2Vzc2FibGUgb25seSB3aGVuIGZpbmlzaGVkCiAgICBmdW5jdGlvbiBnZXRTdGF0KCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludCwgdWludCwgdWludCk7ICAgICAgIC8vU2hvcnQgc3RhdCBvbiBnYW1lCgogICAgZnVuY3Rpb24gY2FsY2F1bHRlUHJpemVzKCkgcHVibGljIHJldHVybnMgKHVpbnRbXSk7CgogICAgZnVuY3Rpb24gZmluaXNoKCkgcHVibGljOyAgICAgICAgICAgICAgICAgICAgICAgIC8vQ2xvc2VzIGdhbWUgY2hvb3NlcyB3aW5uZXIKCiAgICBmdW5jdGlvbiByZXZva2UoKSBwdWJsaWM7ICAgICAgICAgICAgICAgICAgICAgICAgLy9TdG9wIGdhbWUgYW5kIHJldHVybiBtb25leSB0byBwbGF5ZXJzCiAgICAvLyBmdW5jdGlvbiBtb3ZlKGFkZHJlc3MgbmV4dEdhbWUpOyAgICAgICAgICAgICAgLy9Nb3ZlIHBsYXllcnMgYmV0cyB0byBhbm90aGVyIGdhbWUKfQoKbGlicmFyeSBUaWNrZXRMaWIgewogICAgc3RydWN0IFRpY2tldCB7CiAgICAgICAgdWludDQwIGJsb2NrX251bWJlcjsKICAgICAgICB1aW50MzIgYmxvY2tfdGltZTsKICAgICAgICB1aW50IHByaXplOwogICAgfQp9Cgpjb250cmFjdCBVbmlsb3RQcml6ZUNhbGN1bGF0b3IgewogICAgLy9DYWxjdWxhdGlvbiBjb25zdGFudHMKICAgIHVpbnQ2NCAgY29uc3RhbnQgYWNjdXJhY3kgICAgICAgICAgICAgICAgICAgPSAxMDAwMDAwMDAwMDAwMDAwMDAwOwogICAgdWludDggIGNvbnN0YW50IE1BWF9YX0ZPUl9ZICAgICAgICAgICAgICAgID0gMTk1OyAgLy8gMTkuNQoKICAgIHVpbnQ4ICBjb25zdGFudCBtaW5Qcml6ZUNvZWZpY2VudCAgICAgICAgICA9IDE7CiAgICB1aW50OCAgY29uc3RhbnQgcGVyY2VudE9mV2lubmVycyAgICAgICAgICAgPSA1OyAgICAvLyA1JQogICAgdWludDggIGNvbnN0YW50IHBlcmNlbnRPZkZpeGVkUHJpemVXaW5uZXJzID0gMjA7ICAgLy8gMjAlCgogICAgdWludDggIGNvbnN0YW50IGdhbWVDb21taXNpb24gICAgICAgICAgICAgID0gMDsgICAvLyAwJQogICAgdWludDggIGNvbnN0YW50IGJvbnVzR2FtZUNvbW1pc2lvbiAgICAgICAgID0gMDsgICAvLyAwJQogICAgdWludDggIGNvbnN0YW50IHRva2VuSG9sZXJHYW1lQ29tbWlzaW9uICAgID0gMDsgICAgLy8gMCUKICAgIC8vIEVuZCBDYWxjdWxhdGlvbiBjb25zdGFudHMKCiAgICBldmVudCBEZWJ1Zyh1aW50KTsKCiAgICBmdW5jdGlvbiBnZXRQcml6ZUFtb3VudCh1aW50IHRvdGFsQW1vdW50KQogICAgICAgIHB1YmxpYwogICAgICAgIHB1cmUKICAgICAgICByZXR1cm5zICh1aW50IHJlc3VsdCkKICAgIHsKICAgICAgICB1aW50IHRvdGFsQ29tbWlzaW9uID0gZ2FtZUNvbW1pc2lvbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBib251c0dhbWVDb21taXNpb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgdG9rZW5Ib2xlckdhbWVDb21taXNpb247CgogICAgICAgIC8vQ2FsY3VsYXRpb24gaXMgb2RkIG9uIHB1cnBvc2UuICBJdCBpcyBhIHNvcnQgb2YgY2VpbGluZyBlZmZlY3QgdG8KICAgICAgICAvLyBtYXhpbWl6ZSBhbW91bnQgb2YgcHJpemUKICAgICAgICByZXN1bHQgPSAoIHRvdGFsQW1vdW50IC0gKCAoIHRvdGFsQW1vdW50ICogdG90YWxDb21taXNpb24pIC8gMTAwKSApOwoKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICAgIGZ1bmN0aW9uIGdldE51bVdpbm5lcnModWludCBudW1QbGF5ZXJzKQogICAgICAgIHB1YmxpYwogICAgICAgIHB1cmUKICAgICAgICByZXR1cm5zICh1aW50MTYgbnVtV2lubmVycywgdWludDE2IG51bUZpeGVkQW1vdW50V2lubmVycykKICAgIHsKICAgICAgICAvLyBDYWxjdWxhdGlvbiBpcyBvZGQgb24gcHVycG9zZS4gSXQgaXMgYSBzb3J0IG9mIGNlaWxpbmcgZWZmZWN0IHRvCiAgICAgICAgLy8gbWF4aW1pemUgbnVtYmVyIG9mIHdpbm5lcnMKICAgICAgICB1aW50MTYgdG90YU51bWxXaW5uZXJzID0gdWludDE2KCBudW1QbGF5ZXJzIC0gKCAobnVtUGxheWVycyAqICggMTAwIC0gcGVyY2VudE9mV2lubmVycyApICkgLyAxMDAgKSApOwoKCiAgICAgICAgbnVtRml4ZWRBbW91bnRXaW5uZXJzID0gdWludDE2KCAodG90YU51bWxXaW5uZXJzICogcGVyY2VudE9mRml4ZWRQcml6ZVdpbm5lcnMpIC8gMTAwICk7CiAgICAgICAgbnVtV2lubmVycyA9IHVpbnQxNiggdG90YU51bWxXaW5uZXJzIC0gbnVtRml4ZWRBbW91bnRXaW5uZXJzICk7CgogICAgICAgIHJldHVybiAobnVtV2lubmVycywgbnVtRml4ZWRBbW91bnRXaW5uZXJzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjYWxjYXVsdGVQcml6ZXModWludCBiZXQsIHVpbnQgbnVtUGxheWVycykKICAgICAgICBwdWJsaWMKICAgICAgICBwdXJlCiAgICAgICAgcmV0dXJucyAodWludFs1MF0gbWVtb3J5IHByaXplcykKICAgIHsKICAgICAgICB2YXIgKG51bVdpbm5lcnMsIG51bUZpeGVkQW1vdW50V2lubmVycykgPSBnZXROdW1XaW5uZXJzKG51bVBsYXllcnMpOwoKICAgICAgICByZXF1aXJlKCB1aW50KG51bVdpbm5lcnMgKyBudW1GaXhlZEFtb3VudFdpbm5lcnMpIDw9IHByaXplcy5sZW5ndGggKTsKCiAgICAgICAgdWludFtdIG1lbW9yeSB5ID0gbmV3IHVpbnRbXSgobnVtV2lubmVycyAtIDEpKTsKICAgICAgICB1aW50IHogPSAwOyAvLyBTdW0gb2YgYWxsIFkgdmFsdWVzCgogICAgICAgIGlmICggbnVtV2lubmVycyA9PSAxICkgewogICAgICAgICAgICBwcml6ZXNbMF0gPSBnZXRQcml6ZUFtb3VudCh1aW50KGJldCpudW1QbGF5ZXJzKSk7CgogICAgICAgICAgICByZXR1cm4gcHJpemVzOwogICAgICAgIH0gZWxzZSBpZiAoIG51bVdpbm5lcnMgPCAxICkgewogICAgICAgICAgICByZXR1cm4gcHJpemVzOwogICAgICAgIH0KCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgeS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB5W2ldID0gZm9ybXVsYSggKGNhbGN1bGF0ZVN0ZXAobnVtV2lubmVycykgKiBpKSApOwogICAgICAgICAgICB6ICs9IHlbaV07CiAgICAgICAgfQoKICAgICAgICBib29sIHN0b3AgPSBmYWxzZTsKCiAgICAgICAgZm9yIChpID0gMDsgaSA8IDEwOyBpKyspIHsKICAgICAgICAgICAgdWludFs1XSBtZW1vcnkgY2h1bmsgPSBkaXN0cmlidXRlUHJpemVDYWxjdWxhdGlvbigKICAgICAgICAgICAgICAgIGksIHosIHksIG51bVBsYXllcnMsIGJldCk7CgogICAgICAgICAgICBmb3IgKCB1aW50IGogPSAwOyBqIDwgY2h1bmsubGVuZ3RoOyBqKysgKSB7CiAgICAgICAgICAgICAgICBpZiAoICggKGkgKiBjaHVuay5sZW5ndGgpICsgaiApID49ICggbnVtV2lubmVycyArIG51bUZpeGVkQW1vdW50V2lubmVycyApICkgewogICAgICAgICAgICAgICAgICAgIHN0b3AgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHByaXplc1sgKGkgKiBjaHVuay5sZW5ndGgpICsgaiBdID0gY2h1bmtbal07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICggc3RvcCApIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcHJpemVzOwogICAgfQoKICAgIGZ1bmN0aW9uIGRpc3RyaWJ1dGVQcml6ZUNhbGN1bGF0aW9uICh1aW50IGNodW5rTnVtYmVyLCB1aW50IHosIHVpbnRbXSBtZW1vcnkgeSwgdWludCB0b3RhbE51bVBsYXllcnMsIHVpbnQgYmV0KQogICAgICAgIHByaXZhdGUKICAgICAgICBwdXJlCiAgICAgICAgcmV0dXJucyAodWludFs1XSBtZW1vcnkgcHJpemVzKQogICAgewogICAgICAgIHZhcihudW1XaW5uZXJzLCBudW1GaXhlZEFtb3VudFdpbm5lcnMpID0gZ2V0TnVtV2lubmVycyh0b3RhbE51bVBsYXllcnMpOwogICAgICAgIHVpbnQgcHJpemVBbW91bnRGb3JEZWxpZ2F0aW9uID0gZ2V0UHJpemVBbW91bnQoICh0b3RhbE51bVBsYXllcnMgKiBiZXQpICk7CiAgICAgICAgcHJpemVBbW91bnRGb3JEZWxpZ2F0aW9uIC09IHVpbnQoICggYmV0ICogbWluUHJpemVDb2VmaWNlbnQgKSAqIHVpbnQoIG51bVdpbm5lcnMgKyBudW1GaXhlZEFtb3VudFdpbm5lcnMgKSApOwoKICAgICAgICB1aW50IG1haW5XaW5uZXJCYXNlQW1vdW50ID0gKCAocHJpemVBbW91bnRGb3JEZWxpZ2F0aW9uICogYWNjdXJhY3kpIC8gKCAoICggeiAqIGFjY3VyYWN5ICkgLyAoIDIgKiB5WzBdICkgKSArICggMSAqIGFjY3VyYWN5ICkgKSApOwogICAgICAgIHVpbnQgdW5kZWxpZ2F0ZWRBbW91bnQgICAgPSBwcml6ZUFtb3VudEZvckRlbGlnYXRpb247CgogICAgICAgIHVpbnQgc3RhcnRQb2ludCA9IGNodW5rTnVtYmVyICogcHJpemVzLmxlbmd0aDsKCiAgICAgICAgZm9yICggdWludCBpID0gMDsgaSA8IHByaXplcy5sZW5ndGg7IGkrKyApIHsKICAgICAgICAgICAgaWYgKCBpID49IHVpbnQobnVtV2lubmVycyArIG51bUZpeGVkQW1vdW50V2lubmVycykgKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBwcml6ZXNbIGkgXSA9IChiZXQgKiBtaW5Qcml6ZUNvZWZpY2VudCk7CiAgICAgICAgICAgIHVpbnQgZXh0cmFQcml6ZSA9IDA7CgogICAgICAgICAgICBpZiAoIGkgPT0gKCBudW1XaW5uZXJzIC0gMSApICkgewogICAgICAgICAgICAgICAgZXh0cmFQcml6ZSA9IHVuZGVsaWdhdGVkQW1vdW50OwogICAgICAgICAgICB9IGVsc2UgaWYgKCBpID09IDAgJiYgY2h1bmtOdW1iZXIgPT0gMCApIHsKICAgICAgICAgICAgICAgIGV4dHJhUHJpemUgPSBtYWluV2lubmVyQmFzZUFtb3VudDsKICAgICAgICAgICAgfSBlbHNlIGlmICggKCBzdGFydFBvaW50ICsgaSApIDwgbnVtV2lubmVycyApIHsKICAgICAgICAgICAgICAgIGV4dHJhUHJpemUgPSAoICggeVsgKCBzdGFydFBvaW50ICsgaSApIC0gMSBdICogKHByaXplQW1vdW50Rm9yRGVsaWdhdGlvbiAtIG1haW5XaW5uZXJCYXNlQW1vdW50KSApIC8geik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXplc1sgaSBdICs9IGV4dHJhUHJpemU7CiAgICAgICAgICAgIHVuZGVsaWdhdGVkQW1vdW50IC09IGV4dHJhUHJpemU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcHJpemVzOwogICAgfQoKICAgIGZ1bmN0aW9uIGZvcm11bGEodWludCB4KQogICAgICAgIHB1YmxpYwogICAgICAgIHB1cmUKICAgICAgICByZXR1cm5zICh1aW50IHkpCiAgICB7CiAgICAgICAgeSA9ICggKDEgKiBhY2N1cmFjeSoqMikgLyAoeCArICg1KmFjY3VyYWN5LzEwKSkpIC0gKCg1ICogYWNjdXJhY3kpIC8gMTAwKTsKCiAgICAgICAgcmV0dXJuIHk7CiAgICB9CgogICAgZnVuY3Rpb24gY2FsY3VsYXRlU3RlcCh1aW50IG51bVdpbm5lcnMpCiAgICAgICAgcHVibGljCiAgICAgICAgcHVyZQogICAgICAgIHJldHVybnModWludCBzdGVwKQogICAgewogICAgICAgIHN0ZXAgPSAoIE1BWF9YX0ZPUl9ZICogYWNjdXJhY3kgLyAxMCApIC8gbnVtV2lubmVyczsKCiAgICAgICAgcmV0dXJuIHN0ZXA7CiAgICB9Cn0KCmNvbnRyYWN0IEJhc2VVbmlsb3RHYW1lIGlzIEdhbWUgewogICAgZW51bSBTdGF0ZSB7CiAgICAgICAgQUNUSVZFLAogICAgICAgIEVOREVELAogICAgICAgIFJFVk9LSU5HLAogICAgICAgIFJFVk9LRUQsCiAgICAgICAgTU9WRUQKICAgIH0KCiAgICBldmVudCBQcml6ZVJlc3VsdENhbGN1bGF0ZWQodWludCBzaXplLCB1aW50W10gcHJpemVzKTsKCiAgICBTdGF0ZSBzdGF0ZTsKICAgIGFkZHJlc3MgYWRtaW5pc3RyYXRvcjsKICAgIHVpbnQgYmV0OwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gVGlja2V0TGliLlRpY2tldCkgaW50ZXJuYWwgdGlja2V0czsKICAgIGFkZHJlc3NbXSBpbnRlcm5hbCB0aWNrZXRJbmRleDsKCiAgICBVbmlsb3RQcml6ZUNhbGN1bGF0b3IgY2FsY3VsYXRvcjsKCiAgICAvL01vZGlmaWVycwogICAgbW9kaWZpZXIgb25seUFkbWluaXN0cmF0b3IoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkbWluaXN0cmF0b3IpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seVBsYXllcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgIT0gYWRtaW5pc3RyYXRvcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciB2YWxpZEJldCgpIHsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA9PSBiZXQpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgYWN0aXZlR2FtZSgpIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLkFDVElWRSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBpbmFjdGl2ZUdhbWUoKSB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSAhPSBTdGF0ZS5BQ1RJVkUpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgZmluaXNoZWRHYW1lKCkgewogICAgICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuRU5ERUQpOwogICAgICAgIF87CiAgICB9CgogICAgLy9Qcml2YXRlIG1ldGhvZHMKCiAgICBmdW5jdGlvbiBnZXRTdGF0ZSgpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnMoU3RhdGUpCiAgICB7CiAgICAgICAgcmV0dXJuIHN0YXRlOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEJldCgpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnMgKHVpbnQpCiAgICB7CiAgICAgICAgcmV0dXJuIGJldDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRQbGF5ZXJzKCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMoYWRkcmVzc1tdKQogICAgewogICAgICAgIHJldHVybiB0aWNrZXRJbmRleDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRQbGF5ZXJEZXRhaWxzKGFkZHJlc3MgcGxheWVyKQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICBpbmFjdGl2ZUdhbWUKICAgICAgICByZXR1cm5zICh1aW50LCB1aW50LCB1aW50KQogICAgewogICAgICAgIFRpY2tldExpYi5UaWNrZXQgbWVtb3J5IHRpY2tldCA9IHRpY2tldHNbcGxheWVyXTsKCiAgICAgICAgcmV0dXJuICh0aWNrZXQuYmxvY2tfbnVtYmVyLCB0aWNrZXQuYmxvY2tfdGltZSwgdGlja2V0LnByaXplKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXROdW1XaW5uZXJzKCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQsIHVpbnQpCiAgICB7CiAgICAgICAgdmFyKG51bVdpbm5lcnMsIG51bUZpeGVkQW1vdW50V2lubmVycykgPSBjYWxjdWxhdG9yLmdldE51bVdpbm5lcnModGlja2V0SW5kZXgubGVuZ3RoKTsKCiAgICAgICAgcmV0dXJuIChudW1XaW5uZXJzLCBudW1GaXhlZEFtb3VudFdpbm5lcnMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFByaXplQW1vdW50KCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQgcmVzdWx0KQogICAgewogICAgICAgIHVpbnQgdG90YWxBbW91bnQgPSB0aGlzLmJhbGFuY2U7CgogICAgICAgIGlmICggc3RhdGUgPT0gU3RhdGUuRU5ERUQgKSB7CiAgICAgICAgICAgIHRvdGFsQW1vdW50ID0gYmV0ICogdGlja2V0SW5kZXgubGVuZ3RoOwogICAgICAgIH0KCiAgICAgICAgcmVzdWx0ID0gY2FsY3VsYXRvci5nZXRQcml6ZUFtb3VudCh0b3RhbEFtb3VudCk7CgogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0U3RhdCgpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICggdWludCwgdWludCwgdWludCApCiAgICB7CiAgICAgICAgdmFyIChudW1XaW5uZXJzLCBudW1GaXhlZEFtb3VudFdpbm5lcnMpID0gZ2V0TnVtV2lubmVycygpOwogICAgICAgIHJldHVybiAodGlja2V0SW5kZXgubGVuZ3RoLCBnZXRQcml6ZUFtb3VudCgpLCB1aW50KG51bVdpbm5lcnMgKyBudW1GaXhlZEFtb3VudFdpbm5lcnMpKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjYWxjYXVsdGVQcml6ZXMoKQogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnModWludFtdIG1lbW9yeSByZXN1bHQpCiAgICB7CiAgICAgICAgdmFyKG51bVdpbm5lcnMsIG51bUZpeGVkQW1vdW50V2lubmVycykgPSBnZXROdW1XaW5uZXJzKCk7CiAgICAgICAgdWludDE2IHRvdGFsTnVtV2lubmVycyA9IHVpbnQxNiggbnVtV2lubmVycyArIG51bUZpeGVkQW1vdW50V2lubmVycyApOwogICAgICAgIHJlc3VsdCA9IG5ldyB1aW50W10oIHRvdGFsTnVtV2lubmVycyApOwoKCiAgICAgICAgdWludFs1MF0gbWVtb3J5IHByaXplcyA9IGNhbGN1bGF0b3IuY2FsY2F1bHRlUHJpemVzKAogICAgICAgIGJldCwgdGlja2V0SW5kZXgubGVuZ3RoKTsKCiAgICAgICAgZm9yICh1aW50MTYgaSA9IDA7IGkgPCB0b3RhbE51bVdpbm5lcnM7IGkrKykgewogICAgICAgICAgICByZXN1bHRbaV0gPSBwcml6ZXNbaV07CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICAgIGZ1bmN0aW9uIHJldm9rZSgpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IKICAgICAgICBhY3RpdmVHYW1lCiAgICB7CiAgICAgICAgZm9yICh1aW50MjQgaSA9IDA7IGkgPCB0aWNrZXRJbmRleC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB0aWNrZXRJbmRleFtpXS50cmFuc2ZlcihiZXQpOwogICAgICAgIH0KCiAgICAgICAgc3RhdGUgPSBTdGF0ZS5SRVZPS0VEOwogICAgfQp9Cgpjb250cmFjdCBVbmlsb3RUYWlsRXRoZXIgaXMgQmFzZVVuaWxvdEdhbWUgewoKICAgIHVpbnQ2NCB3aW5uZXJJbmRleDsKCiAgICAvL1B1YmxpYyBtZXRob2RzCiAgICBmdW5jdGlvbiBVbmlsb3RUYWlsRXRoZXIodWludCBiZXRBbW91bnQsIGFkZHJlc3MgY2FsY3VsYXRvckNvbnRyYWN0QWRkcmVzcykKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICBzdGF0ZSA9IFN0YXRlLkFDVElWRTsKICAgICAgICBhZG1pbmlzdHJhdG9yID0gbXNnLnNlbmRlcjsKICAgICAgICBiZXQgPSBiZXRBbW91bnQ7CgogICAgICAgIGNhbGN1bGF0b3IgPSBVbmlsb3RQcml6ZUNhbGN1bGF0b3IoY2FsY3VsYXRvckNvbnRyYWN0QWRkcmVzcyk7CgogICAgICAgIEdhbWVTdGFydGVkKGJldEFtb3VudCk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0V2lubmVycygpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIGZpbmlzaGVkR2FtZQogICAgICAgIHJldHVybnMoYWRkcmVzc1tdIG1lbW9yeSBwbGF5ZXJzLCB1aW50W10gbWVtb3J5IHByaXplcykKICAgIHsKICAgICAgICB2YXIobnVtV2lubmVycywgbnVtRml4ZWRBbW91bnRXaW5uZXJzKSA9IGdldE51bVdpbm5lcnMoKTsKICAgICAgICB1aW50IHRvdGFsTnVtV2lubmVycyA9IG51bVdpbm5lcnMgKyBudW1GaXhlZEFtb3VudFdpbm5lcnM7CgogICAgICAgIHBsYXllcnMgPSBuZXcgYWRkcmVzc1tdKHRvdGFsTnVtV2lubmVycyk7CiAgICAgICAgcHJpemVzID0gbmV3IHVpbnRbXSh0b3RhbE51bVdpbm5lcnMpOwoKICAgICAgICB1aW50IGluZGV4OwoKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCB0b3RhbE51bVdpbm5lcnM7IGkrKykgewogICAgICAgICAgICBpZiAoIGkgPiB3aW5uZXJJbmRleCApIHsKICAgICAgICAgICAgICAgIGluZGV4ID0gKCAoIHBsYXllcnMubGVuZ3RoICkgLSAoIGkgLSB3aW5uZXJJbmRleCApICk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpbmRleCA9ICggd2lubmVySW5kZXggLSBpICk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHBsYXllcnNbaV0gPSB0aWNrZXRJbmRleFtpbmRleF07CiAgICAgICAgICAgIHByaXplc1tpXSA9IHRpY2tldHNbcGxheWVyc1tpXV0ucHJpemU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gKHBsYXllcnMsIHByaXplcyk7CiAgICB9CgogICAgZnVuY3Rpb24gKCkKICAgICAgICBwdWJsaWMKICAgICAgICBwYXlhYmxlCiAgICAgICAgdmFsaWRCZXQKICAgICAgICBvbmx5UGxheWVyCiAgICB7CiAgICAgICAgcmVxdWlyZSh0aWNrZXRzW21zZy5zZW5kZXJdLmJsb2NrX251bWJlciA9PSAwKTsKICAgICAgICByZXF1aXJlKHRpY2tldEluZGV4Lmxlbmd0aCA8PSAxMDAwKTsKCiAgICAgICAgdGlja2V0c1ttc2cuc2VuZGVyXS5ibG9ja19udW1iZXIgPSB1aW50NDAoYmxvY2subnVtYmVyKTsKICAgICAgICB0aWNrZXRzW21zZy5zZW5kZXJdLmJsb2NrX3RpbWUgICA9IHVpbnQzMihibG9jay50aW1lc3RhbXApOwoKICAgICAgICB0aWNrZXRJbmRleC5wdXNoKG1zZy5zZW5kZXIpOwoKICAgICAgICBOZXdQbGF5ZXJBZGRlZCh0aWNrZXRJbmRleC5sZW5ndGgsIGdldFByaXplQW1vdW50KCkpOwogICAgfQoKICAgIGZ1bmN0aW9uIGZpbmlzaCgpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IKICAgICAgICBhY3RpdmVHYW1lCiAgICB7CiAgICAgICAgdWludDY0IG1heF92b3RlczsKICAgICAgICB1aW50NjRbXSBtZW1vcnkgbnVtX3ZvdGVzID0gbmV3IHVpbnQ2NFtdKHRpY2tldEluZGV4Lmxlbmd0aCk7CgogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IHRpY2tldEluZGV4Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIFRpY2tldExpYi5UaWNrZXQgbWVtb3J5IHRpY2tldCA9IHRpY2tldHNbdGlja2V0SW5kZXhbaV1dOwogICAgICAgICAgICB1aW50NjQgdm90ZSA9IHVpbnQ2NCggKCAoIHRpY2tldC5ibG9ja19udW1iZXIgKiB0aWNrZXQuYmxvY2tfdGltZSApICsgdWludCggdGlja2V0SW5kZXhbaV0pICkgJSB0aWNrZXRJbmRleC5sZW5ndGggKTsKCiAgICAgICAgICAgIG51bV92b3Rlc1t2b3RlXSArPSAxOwoKICAgICAgICAgICAgaWYgKCBudW1fdm90ZXNbdm90ZV0gPiBtYXhfdm90ZXMgKSB7CiAgICAgICAgICAgICAgICBtYXhfdm90ZXMgPSBudW1fdm90ZXNbdm90ZV07CiAgICAgICAgICAgICAgICB3aW5uZXJJbmRleCA9IHZvdGU7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHVpbnRbXSBtZW1vcnkgcHJpemVzID0gY2FsY2F1bHRlUHJpemVzKCk7CgogICAgICAgIHVpbnQgbGFzdElkID0gd2lubmVySW5kZXg7CgogICAgICAgIGZvciAoIGkgPSAwOyBpIDwgcHJpemVzLmxlbmd0aDsgaSsrICkgewogICAgICAgICAgICB0aWNrZXRzW3RpY2tldEluZGV4W2xhc3RJZF1dLnByaXplID0gcHJpemVzW2ldOwogICAgICAgICAgICB0aWNrZXRJbmRleFtsYXN0SWRdLnRyYW5zZmVyKHByaXplc1tpXSk7CgogICAgICAgICAgICBpZiAoIGxhc3RJZCA8PSAwICkgewogICAgICAgICAgICAgICAgbGFzdElkID0gdGlja2V0SW5kZXgubGVuZ3RoOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsYXN0SWQgLT0gMTsKICAgICAgICB9CgogICAgICAgIGFkbWluaXN0cmF0b3IudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKCiAgICAgICAgc3RhdGUgPSBTdGF0ZS5FTkRFRDsKCiAgICAgICAgR2FtZUZpbmlzaGVkKHRpY2tldEluZGV4W3dpbm5lckluZGV4XSk7CiAgICB9Cn0KCmNvbnRyYWN0IFVuaWxvdEJvbnVzVGFpbFRva2VuIGlzIEJhc2VVbmlsb3RHYW1lIHsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gVGlja2V0TGliLlRpY2tldFtdKSBwdWJsaWMgdGlja2V0czsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgX3ByaXplOwoKICAgIHVpbnQxNiBudW1UaWNrZXRzOwoKICAgIHVpbnQ2NCB3aW5uZXJJbmRleDsKCiAgICB1aW50MjU2IGNvbnN0YW50IHB1YmxpYyBfcHJpemVBbW91bnQgPSAxMDAwMDAgKiAoMTAqKjE4KTsKCiAgICBmdW5jdGlvbiBVbmlsb3RCb251c1RhaWxUb2tlbihhZGRyZXNzIGNhbGN1bGF0b3JDb250cmFjdEFkZHJlc3MpCiAgICAgICAgcHVibGljCiAgICB7CiAgICAgICAgc3RhdGUgPSBTdGF0ZS5BQ1RJVkU7CiAgICAgICAgYWRtaW5pc3RyYXRvciA9IG1zZy5zZW5kZXI7CgogICAgICAgIGNhbGN1bGF0b3IgPSBVbmlsb3RQcml6ZUNhbGN1bGF0b3IoY2FsY3VsYXRvckNvbnRyYWN0QWRkcmVzcyk7CgogICAgICAgIEdhbWVTdGFydGVkKDApOwogICAgfQoKICAgIGZ1bmN0aW9uIGltcG9ydFBsYXllcnMoYWRkcmVzcyBnYW1lLCBhZGRyZXNzW10gcGxheWVycykKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5QWRtaW5pc3RyYXRvcgogICAgewogICAgICAgIFVuaWxvdFRhaWxFdGhlciBfZ2FtZSA9IFVuaWxvdFRhaWxFdGhlcihnYW1lKTsKCiAgICAgICAgZm9yICh1aW50OCBpID0gMDsgaSA8IHVpbnQ4KHBsYXllcnMubGVuZ3RoKTsgaSsrKSB7CiAgICAgICAgICAgIFRpY2tldExpYi5UaWNrZXQgbWVtb3J5IHRpY2tldDsKCiAgICAgICAgICAgIHZhcihibG9ja19udW1iZXIsIGJsb2NrX3RpbWUsIHByaXplKSA9IF9nYW1lLmdldFBsYXllckRldGFpbHMocGxheWVyc1tpXSk7CgogICAgICAgICAgICBpZiAocHJpemUgPiAwKSB7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGlja2V0LmJsb2NrX251bWJlciA9IHVpbnQ0MChibG9ja19udW1iZXIpOwogICAgICAgICAgICB0aWNrZXQuYmxvY2tfdGltZSA9IHVpbnQzMihibG9ja190aW1lKTsKCiAgICAgICAgICAgIGlmICggdGlja2V0c1twbGF5ZXJzW2ldXS5sZW5ndGggPT0gMCApIHsKICAgICAgICAgICAgICAgIHRpY2tldEluZGV4LnB1c2gocGxheWVyc1tpXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRpY2tldHNbcGxheWVyc1tpXV0ucHVzaCh0aWNrZXQpOwogICAgICAgICAgICBudW1UaWNrZXRzKys7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGdldFBsYXllckRldGFpbHMoYWRkcmVzcyBwbGF5ZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIGluYWN0aXZlR2FtZQogICAgICAgIHJldHVybnMgKHVpbnQsIHVpbnQsIHVpbnQpCiAgICB7CiAgICAgICAgcGxheWVyOwoKICAgICAgICByZXR1cm4gKDAsIDAsIDApOwogICAgfQoKICAgIGZ1bmN0aW9uICgpCiAgICAgICAgcHVibGljCiAgICAgICAgcGF5YWJsZQogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yCiAgICB7CgogICAgfQoKICAgIGZ1bmN0aW9uIGdldFByaXplQW1vdW50KCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQgcmVzdWx0KQogICAgewogICAgICAgIHJldHVybiBfcHJpemVBbW91bnQ7CiAgICB9CgogICAgZnVuY3Rpb24gY2FsY2F1bHRlUHJpemVzKCkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zKHVpbnRbXSBtZW1vcnkgcmVzdWx0KQogICAgewogICAgICAgIHZhcihudW1XaW5uZXJzLCBudW1GaXhlZEFtb3VudFdpbm5lcnMpID0gZ2V0TnVtV2lubmVycygpOwogICAgICAgIHVpbnQxNiB0b3RhbE51bVdpbm5lcnMgPSB1aW50MTYoIG51bVdpbm5lcnMgKyBudW1GaXhlZEFtb3VudFdpbm5lcnMgKTsKICAgICAgICByZXN1bHQgPSBuZXcgdWludFtdKCB0b3RhbE51bVdpbm5lcnMgKTsKCgogICAgICAgIHVpbnRbNTBdIG1lbW9yeSBwcml6ZXMgPSBjYWxjdWxhdG9yLmNhbGNhdWx0ZVByaXplcygKICAgICAgICAgICAgX3ByaXplQW1vdW50L3RpY2tldEluZGV4Lmxlbmd0aCwgdGlja2V0SW5kZXgubGVuZ3RoKTsKCiAgICAgICAgZm9yICh1aW50MTYgaSA9IDA7IGkgPCB0b3RhbE51bVdpbm5lcnM7IGkrKykgewogICAgICAgICAgICByZXN1bHRbaV0gPSBwcml6ZXNbaV07CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFdpbm5lcnMoKQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICBmaW5pc2hlZEdhbWUKICAgICAgICByZXR1cm5zKGFkZHJlc3NbXSBtZW1vcnkgcGxheWVycywgdWludFtdIG1lbW9yeSBwcml6ZXMpCiAgICB7CiAgICAgICAgdmFyKG51bVdpbm5lcnMsIG51bUZpeGVkQW1vdW50V2lubmVycykgPSBnZXROdW1XaW5uZXJzKCk7CiAgICAgICAgdWludCB0b3RhbE51bVdpbm5lcnMgPSBudW1XaW5uZXJzICsgbnVtRml4ZWRBbW91bnRXaW5uZXJzOwoKICAgICAgICBwbGF5ZXJzID0gbmV3IGFkZHJlc3NbXSh0b3RhbE51bVdpbm5lcnMpOwogICAgICAgIHByaXplcyA9IG5ldyB1aW50W10odG90YWxOdW1XaW5uZXJzKTsKCiAgICAgICAgdWludCBpbmRleDsKCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgdG90YWxOdW1XaW5uZXJzOyBpKyspIHsKICAgICAgICAgICAgaWYgKCBpID4gd2lubmVySW5kZXggKSB7CiAgICAgICAgICAgICAgICBpbmRleCA9ICggKCBwbGF5ZXJzLmxlbmd0aCApIC0gKCBpIC0gd2lubmVySW5kZXggKSApOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaW5kZXggPSAoIHdpbm5lckluZGV4IC0gaSApOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwbGF5ZXJzW2ldID0gdGlja2V0SW5kZXhbaW5kZXhdOwogICAgICAgICAgICBwcml6ZXNbaV0gPSBfcHJpemVbcGxheWVyc1tpXV07CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gKHBsYXllcnMsIHByaXplcyk7CiAgICB9CgogICAgZnVuY3Rpb24gZmluaXNoKCkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5QWRtaW5pc3RyYXRvcgogICAgICAgIGFjdGl2ZUdhbWUKICAgIHsKICAgICAgICB1aW50NjQgbWF4X3ZvdGVzOwogICAgICAgIHVpbnQ2NFtdIG1lbW9yeSBudW1fdm90ZXMgPSBuZXcgdWludDY0W10odGlja2V0SW5kZXgubGVuZ3RoKTsKCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgdGlja2V0SW5kZXgubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgZm9yICh1aW50OCBqID0gMDsgaiA8IHRpY2tldHNbdGlja2V0SW5kZXhbaV1dLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICBUaWNrZXRMaWIuVGlja2V0IG1lbW9yeSB0aWNrZXQgPSB0aWNrZXRzW3RpY2tldEluZGV4W2ldXVtqXTsKCiAgICAgICAgICAgICAgICB1aW50NjQgdm90ZSA9IHVpbnQ2NCggKCAoICggdGlja2V0LmJsb2NrX251bWJlciAqIHRpY2tldC5ibG9ja190aW1lICkgLyBudW1UaWNrZXRzICkgKyAoKChibG9jay5udW1iZXIvMikgKiBub3cpIC8gKG51bVRpY2tldHMvMikpICsgdWludCggdGlja2V0SW5kZXhbaV0pICkgJSB0aWNrZXRJbmRleC5sZW5ndGggKTsKCiAgICAgICAgICAgICAgICBudW1fdm90ZXNbdm90ZV0gKz0gMTsKCiAgICAgICAgICAgICAgICBpZiAoIG51bV92b3Rlc1t2b3RlXSA+IG1heF92b3RlcyApIHsKICAgICAgICAgICAgICAgICAgICBtYXhfdm90ZXMgPSBudW1fdm90ZXNbdm90ZV07CiAgICAgICAgICAgICAgICAgICAgd2lubmVySW5kZXggPSB2b3RlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB1aW50W10gbWVtb3J5IHByaXplcyA9IGNhbGNhdWx0ZVByaXplcygpOwoKICAgICAgICB1aW50IGxhc3RJZCA9IHdpbm5lckluZGV4OwoKICAgICAgICBmb3IgKCBpID0gMDsgaSA8IHByaXplcy5sZW5ndGg7IGkrKyApIHsKICAgICAgICAgICAgX3ByaXplW3RpY2tldEluZGV4W2xhc3RJZF1dID0gcHJpemVzW2ldOwoKICAgICAgICAgICAgaWYgKCBsYXN0SWQgPD0gMCApIHsKICAgICAgICAgICAgICAgIGxhc3RJZCA9IHRpY2tldEluZGV4Lmxlbmd0aDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbGFzdElkIC09IDE7CiAgICAgICAgfQoKICAgICAgICBhZG1pbmlzdHJhdG9yLnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7IC8vRm9yIGNhc2Ugb2YgbWlzc2NhbGN1bGF0aW9uCgogICAgICAgIHN0YXRlID0gU3RhdGUuRU5ERUQ7CgogICAgICAgIEdhbWVGaW5pc2hlZCh0aWNrZXRJbmRleFt3aW5uZXJJbmRleF0pOwogICAgfQoKICAgIGZ1bmN0aW9uIHJldm9rZSgpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IKICAgICAgICBhY3RpdmVHYW1lCiAgICB7CiAgICAgICAgYWRtaW5pc3RyYXRvci50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwoKICAgICAgICBzdGF0ZSA9IFN0YXRlLlJFVk9LRUQ7CiAgICB9Cn0='.
	

]
