Class {
	#name : #SRT4e55567c52cfde3a09441693a5a82a5c381226f9,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT4e55567c52cfde3a09441693a5a82a5c381226f9 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7CgovLyA8T1JBQ0xJWkVfQVBJPgovKgpDb3B5cmlnaHQgKGMpIDIwMTUtMjAxNiBPcmFjbGl6ZSBTUkwKQ29weXJpZ2h0IChjKSAyMDE2IE9yYWNsaXplIExURAoKCgpQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5Cm9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLCB0byBkZWFsCmluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMKdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbApjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMKZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKCgoKVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4KYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgoKClRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SCklNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLApGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFCkFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIKTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwKT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTgpUSEUgU09GVFdBUkUuCiovCgovLyBUaGlzIGFwaSBpcyBjdXJyZW50bHkgdGFyZ2V0ZWQgYXQgMC40LjE4LCBwbGVhc2UgaW1wb3J0IG9yYWNsaXplQVBJX3ByZTAuNC5zb2wgb3Igb3JhY2xpemVBUElfMC40IHdoZXJlIG5lY2Vzc2FyeQpwcmFnbWEgc29saWRpdHkgXjAuNC4xODsKCmNvbnRyYWN0IE9yYWNsaXplSSB7CiAgICBhZGRyZXNzIHB1YmxpYyBjYkFkZHJlc3M7CiAgICBmdW5jdGlvbiBxdWVyeSh1aW50IF90aW1lc3RhbXAsIHN0cmluZyBfZGF0YXNvdXJjZSwgc3RyaW5nIF9hcmcpIGV4dGVybmFsIHBheWFibGUgcmV0dXJucyAoYnl0ZXMzMiBfaWQpOwogICAgZnVuY3Rpb24gcXVlcnlfd2l0aEdhc0xpbWl0KHVpbnQgX3RpbWVzdGFtcCwgc3RyaW5nIF9kYXRhc291cmNlLCBzdHJpbmcgX2FyZywgdWludCBfZ2FzbGltaXQpIGV4dGVybmFsIHBheWFibGUgcmV0dXJucyAoYnl0ZXMzMiBfaWQpOwogICAgZnVuY3Rpb24gcXVlcnkyKHVpbnQgX3RpbWVzdGFtcCwgc3RyaW5nIF9kYXRhc291cmNlLCBzdHJpbmcgX2FyZzEsIHN0cmluZyBfYXJnMikgcHVibGljIHBheWFibGUgcmV0dXJucyAoYnl0ZXMzMiBfaWQpOwogICAgZnVuY3Rpb24gcXVlcnkyX3dpdGhHYXNMaW1pdCh1aW50IF90aW1lc3RhbXAsIHN0cmluZyBfZGF0YXNvdXJjZSwgc3RyaW5nIF9hcmcxLCBzdHJpbmcgX2FyZzIsIHVpbnQgX2dhc2xpbWl0KSBleHRlcm5hbCBwYXlhYmxlIHJldHVybnMgKGJ5dGVzMzIgX2lkKTsKICAgIGZ1bmN0aW9uIHF1ZXJ5Tih1aW50IF90aW1lc3RhbXAsIHN0cmluZyBfZGF0YXNvdXJjZSwgYnl0ZXMgX2FyZ04pIHB1YmxpYyBwYXlhYmxlIHJldHVybnMgKGJ5dGVzMzIgX2lkKTsKICAgIGZ1bmN0aW9uIHF1ZXJ5Tl93aXRoR2FzTGltaXQodWludCBfdGltZXN0YW1wLCBzdHJpbmcgX2RhdGFzb3VyY2UsIGJ5dGVzIF9hcmdOLCB1aW50IF9nYXNsaW1pdCkgZXh0ZXJuYWwgcGF5YWJsZSByZXR1cm5zIChieXRlczMyIF9pZCk7CiAgICBmdW5jdGlvbiBnZXRQcmljZShzdHJpbmcgX2RhdGFzb3VyY2UpIHB1YmxpYyByZXR1cm5zICh1aW50IF9kc3ByaWNlKTsKICAgIGZ1bmN0aW9uIGdldFByaWNlKHN0cmluZyBfZGF0YXNvdXJjZSwgdWludCBnYXNsaW1pdCkgcHVibGljIHJldHVybnMgKHVpbnQgX2RzcHJpY2UpOwogICAgZnVuY3Rpb24gc2V0UHJvb2ZUeXBlKGJ5dGUgX3Byb29mVHlwZSkgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBzZXRDdXN0b21HYXNQcmljZSh1aW50IF9nYXNQcmljZSkgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiByYW5kb21EU19nZXRTZXNzaW9uUHViS2V5SGFzaCgpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMoYnl0ZXMzMik7Cn0KY29udHJhY3QgT3JhY2xpemVBZGRyUmVzb2x2ZXJJIHsKICAgIGZ1bmN0aW9uIGdldEFkZHJlc3MoKSBwdWJsaWMgcmV0dXJucyAoYWRkcmVzcyBfYWRkcik7Cn0KY29udHJhY3QgdXNpbmdPcmFjbGl6ZSB7CiAgICB1aW50IGNvbnN0YW50IGRheSA9IDYwKjYwKjI0OwogICAgdWludCBjb25zdGFudCB3ZWVrID0gNjAqNjAqMjQqNzsKICAgIHVpbnQgY29uc3RhbnQgbW9udGggPSA2MCo2MCoyNCozMDsKICAgIGJ5dGUgY29uc3RhbnQgcHJvb2ZUeXBlX05PTkUgPSAweDAwOwogICAgYnl0ZSBjb25zdGFudCBwcm9vZlR5cGVfVExTTm90YXJ5ID0gMHgxMDsKICAgIGJ5dGUgY29uc3RhbnQgcHJvb2ZUeXBlX0FuZHJvaWQgPSAweDIwOwogICAgYnl0ZSBjb25zdGFudCBwcm9vZlR5cGVfTGVkZ2VyID0gMHgzMDsKICAgIGJ5dGUgY29uc3RhbnQgcHJvb2ZUeXBlX05hdGl2ZSA9IDB4RjA7CiAgICBieXRlIGNvbnN0YW50IHByb29mU3RvcmFnZV9JUEZTID0gMHgwMTsKICAgIHVpbnQ4IGNvbnN0YW50IG5ldHdvcmtJRF9hdXRvID0gMDsKICAgIHVpbnQ4IGNvbnN0YW50IG5ldHdvcmtJRF9tYWlubmV0ID0gMTsKICAgIHVpbnQ4IGNvbnN0YW50IG5ldHdvcmtJRF90ZXN0bmV0ID0gMjsKICAgIHVpbnQ4IGNvbnN0YW50IG5ldHdvcmtJRF9tb3JkZW4gPSAyOwogICAgdWludDggY29uc3RhbnQgbmV0d29ya0lEX2NvbnNlbnN5cyA9IDE2MTsKCiAgICBPcmFjbGl6ZUFkZHJSZXNvbHZlckkgT0FSOwoKICAgIE9yYWNsaXplSSBvcmFjbGl6ZTsKICAgIG1vZGlmaWVyIG9yYWNsaXplQVBJIHsKICAgICAgICBpZigoYWRkcmVzcyhPQVIpPT0wKXx8KGdldENvZGVTaXplKGFkZHJlc3MoT0FSKSk9PTApKQogICAgICAgICAgICBvcmFjbGl6ZV9zZXROZXR3b3JrKG5ldHdvcmtJRF9hdXRvKTsKCiAgICAgICAgaWYoYWRkcmVzcyhvcmFjbGl6ZSkgIT0gT0FSLmdldEFkZHJlc3MoKSkKICAgICAgICAgICAgb3JhY2xpemUgPSBPcmFjbGl6ZUkoT0FSLmdldEFkZHJlc3MoKSk7CgogICAgICAgIF87CiAgICB9CiAgICBtb2RpZmllciBjb3Vwb24oc3RyaW5nIGNvZGUpewogICAgICAgIG9yYWNsaXplID0gT3JhY2xpemVJKE9BUi5nZXRBZGRyZXNzKCkpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gb3JhY2xpemVfc2V0TmV0d29yayh1aW50OCBuZXR3b3JrSUQpIGludGVybmFsIHJldHVybnMoYm9vbCl7CiAgICAgIHJldHVybiBvcmFjbGl6ZV9zZXROZXR3b3JrKCk7CiAgICAgIG5ldHdvcmtJRDsgLy8gc2lsZW5jZSB0aGUgd2FybmluZyBhbmQgcmVtYWluIGJhY2t3YXJkcyBjb21wYXRpYmxlCiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9zZXROZXR3b3JrKCkgaW50ZXJuYWwgcmV0dXJucyhib29sKXsKICAgICAgICBpZiAoZ2V0Q29kZVNpemUoMHgxZDNCMjYzOGE3Y0M5ZjJDQjNEMjk4QTNEQTdhOTBCNjdFNTUwNmVkKT4wKXsgLy9tYWlubmV0CiAgICAgICAgICAgIE9BUiA9IE9yYWNsaXplQWRkclJlc29sdmVySSgweDFkM0IyNjM4YTdjQzlmMkNCM0QyOThBM0RBN2E5MEI2N0U1NTA2ZWQpOwogICAgICAgICAgICBvcmFjbGl6ZV9zZXROZXR3b3JrTmFtZSgiZXRoX21haW5uZXQiKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGlmIChnZXRDb2RlU2l6ZSgweGMwM0EyNjE1RDVlZmFmNUY0OUY2MEI3QkI2NTgzZWFlYzIxMmZkZjEpPjApeyAvL3JvcHN0ZW4gdGVzdG5ldAogICAgICAgICAgICBPQVIgPSBPcmFjbGl6ZUFkZHJSZXNvbHZlckkoMHhjMDNBMjYxNUQ1ZWZhZjVGNDlGNjBCN0JCNjU4M2VhZWMyMTJmZGYxKTsKICAgICAgICAgICAgb3JhY2xpemVfc2V0TmV0d29ya05hbWUoImV0aF9yb3BzdGVuMyIpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKGdldENvZGVTaXplKDB4QjdBMDdCY0YyQmEyZjI3MDNiMjRDMDY5MWI1Mjc4OTk5QzU5QUM3ZSk+MCl7IC8va292YW4gdGVzdG5ldAogICAgICAgICAgICBPQVIgPSBPcmFjbGl6ZUFkZHJSZXNvbHZlckkoMHhCN0EwN0JjRjJCYTJmMjcwM2IyNEMwNjkxYjUyNzg5OTlDNTlBQzdlKTsKICAgICAgICAgICAgb3JhY2xpemVfc2V0TmV0d29ya05hbWUoImV0aF9rb3ZhbiIpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKGdldENvZGVTaXplKDB4MTQ2NTAwY2ZkMzVCMjJFNEEzOTJGZTBhRGMwNkRlMWExMzY4RWQ0OCk+MCl7IC8vcmlua2VieSB0ZXN0bmV0CiAgICAgICAgICAgIE9BUiA9IE9yYWNsaXplQWRkclJlc29sdmVySSgweDE0NjUwMGNmZDM1QjIyRTRBMzkyRmUwYURjMDZEZTFhMTM2OEVkNDgpOwogICAgICAgICAgICBvcmFjbGl6ZV9zZXROZXR3b3JrTmFtZSgiZXRoX3JpbmtlYnkiKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGlmIChnZXRDb2RlU2l6ZSgweDZmNDg1QzhCRjZmYzQzZUEyMTJFOTNCQkY4Y2UwNDZDN2YxY2I0NzUpPjApeyAvL2V0aGVyZXVtLWJyaWRnZQogICAgICAgICAgICBPQVIgPSBPcmFjbGl6ZUFkZHJSZXNvbHZlckkoMHg2ZjQ4NUM4QkY2ZmM0M2VBMjEyRTkzQkJGOGNlMDQ2QzdmMWNiNDc1KTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGlmIChnZXRDb2RlU2l6ZSgweDIwZTEyQTFGODU5QjNGZWFFNUZiMkEwQTMyQzE4RjVhNjU1NTViQkYpPjApeyAvL2V0aGVyLmNhbXAgaWRlCiAgICAgICAgICAgIE9BUiA9IE9yYWNsaXplQWRkclJlc29sdmVySSgweDIwZTEyQTFGODU5QjNGZWFFNUZiMkEwQTMyQzE4RjVhNjU1NTViQkYpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKGdldENvZGVTaXplKDB4NTFlZmFGNGM4QjNDOUFmQkQ1YUI5RjRiYkM4Mjc4NEFiNmVmOGZBQSk+MCl7IC8vYnJvd3Nlci1zb2xpZGl0eQogICAgICAgICAgICBPQVIgPSBPcmFjbGl6ZUFkZHJSZXNvbHZlckkoMHg1MWVmYUY0YzhCM0M5QWZCRDVhQjlGNGJiQzgyNzg0QWI2ZWY4ZkFBKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBmdW5jdGlvbiBfX2NhbGxiYWNrKGJ5dGVzMzIgbXlpZCwgc3RyaW5nIHJlc3VsdCkgcHVibGljIHsKICAgICAgICBfX2NhbGxiYWNrKG15aWQsIHJlc3VsdCwgbmV3IGJ5dGVzKDApKTsKICAgIH0KICAgIGZ1bmN0aW9uIF9fY2FsbGJhY2soYnl0ZXMzMiBteWlkLCBzdHJpbmcgcmVzdWx0LCBieXRlcyBwcm9vZikgcHVibGljIHsKICAgICAgcmV0dXJuOwogICAgICBteWlkOyByZXN1bHQ7IHByb29mOyAvLyBTaWxlbmNlIGNvbXBpbGVyIHdhcm5pbmdzCiAgICB9CgogICAgZnVuY3Rpb24gb3JhY2xpemVfZ2V0UHJpY2Uoc3RyaW5nIGRhdGFzb3VyY2UpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKHVpbnQpewogICAgICAgIHJldHVybiBvcmFjbGl6ZS5nZXRQcmljZShkYXRhc291cmNlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9nZXRQcmljZShzdHJpbmcgZGF0YXNvdXJjZSwgdWludCBnYXNsaW1pdCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAodWludCl7CiAgICAgICAgcmV0dXJuIG9yYWNsaXplLmdldFByaWNlKGRhdGFzb3VyY2UsIGdhc2xpbWl0KTsKICAgIH0KCiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeShzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nIGFyZykgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCl7CiAgICAgICAgdWludCBwcmljZSA9IG9yYWNsaXplLmdldFByaWNlKGRhdGFzb3VyY2UpOwogICAgICAgIGlmIChwcmljZSA+IDEgZXRoZXIgKyB0eC5nYXNwcmljZSoyMDAwMDApIHJldHVybiAwOyAvLyB1bmV4cGVjdGVkbHkgaGlnaCBwcmljZQogICAgICAgIHJldHVybiBvcmFjbGl6ZS5xdWVyeS52YWx1ZShwcmljZSkoMCwgZGF0YXNvdXJjZSwgYXJnKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nIGFyZykgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCl7CiAgICAgICAgdWludCBwcmljZSA9IG9yYWNsaXplLmdldFByaWNlKGRhdGFzb3VyY2UpOwogICAgICAgIGlmIChwcmljZSA+IDEgZXRoZXIgKyB0eC5nYXNwcmljZSoyMDAwMDApIHJldHVybiAwOyAvLyB1bmV4cGVjdGVkbHkgaGlnaCBwcmljZQogICAgICAgIHJldHVybiBvcmFjbGl6ZS5xdWVyeS52YWx1ZShwcmljZSkodGltZXN0YW1wLCBkYXRhc291cmNlLCBhcmcpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmcgYXJnLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKXsKICAgICAgICB1aW50IHByaWNlID0gb3JhY2xpemUuZ2V0UHJpY2UoZGF0YXNvdXJjZSwgZ2FzbGltaXQpOwogICAgICAgIGlmIChwcmljZSA+IDEgZXRoZXIgKyB0eC5nYXNwcmljZSpnYXNsaW1pdCkgcmV0dXJuIDA7IC8vIHVuZXhwZWN0ZWRseSBoaWdoIHByaWNlCiAgICAgICAgcmV0dXJuIG9yYWNsaXplLnF1ZXJ5X3dpdGhHYXNMaW1pdC52YWx1ZShwcmljZSkodGltZXN0YW1wLCBkYXRhc291cmNlLCBhcmcsIGdhc2xpbWl0KTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmcgYXJnLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKXsKICAgICAgICB1aW50IHByaWNlID0gb3JhY2xpemUuZ2V0UHJpY2UoZGF0YXNvdXJjZSwgZ2FzbGltaXQpOwogICAgICAgIGlmIChwcmljZSA+IDEgZXRoZXIgKyB0eC5nYXNwcmljZSpnYXNsaW1pdCkgcmV0dXJuIDA7IC8vIHVuZXhwZWN0ZWRseSBoaWdoIHByaWNlCiAgICAgICAgcmV0dXJuIG9yYWNsaXplLnF1ZXJ5X3dpdGhHYXNMaW1pdC52YWx1ZShwcmljZSkoMCwgZGF0YXNvdXJjZSwgYXJnLCBnYXNsaW1pdCk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeShzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nIGFyZzEsIHN0cmluZyBhcmcyKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKXsKICAgICAgICB1aW50IHByaWNlID0gb3JhY2xpemUuZ2V0UHJpY2UoZGF0YXNvdXJjZSk7CiAgICAgICAgaWYgKHByaWNlID4gMSBldGhlciArIHR4Lmdhc3ByaWNlKjIwMDAwMCkgcmV0dXJuIDA7IC8vIHVuZXhwZWN0ZWRseSBoaWdoIHByaWNlCiAgICAgICAgcmV0dXJuIG9yYWNsaXplLnF1ZXJ5Mi52YWx1ZShwcmljZSkoMCwgZGF0YXNvdXJjZSwgYXJnMSwgYXJnMik7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeSh1aW50IHRpbWVzdGFtcCwgc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZyBhcmcxLCBzdHJpbmcgYXJnMikgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCl7CiAgICAgICAgdWludCBwcmljZSA9IG9yYWNsaXplLmdldFByaWNlKGRhdGFzb3VyY2UpOwogICAgICAgIGlmIChwcmljZSA+IDEgZXRoZXIgKyB0eC5nYXNwcmljZSoyMDAwMDApIHJldHVybiAwOyAvLyB1bmV4cGVjdGVkbHkgaGlnaCBwcmljZQogICAgICAgIHJldHVybiBvcmFjbGl6ZS5xdWVyeTIudmFsdWUocHJpY2UpKHRpbWVzdGFtcCwgZGF0YXNvdXJjZSwgYXJnMSwgYXJnMik7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeSh1aW50IHRpbWVzdGFtcCwgc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZyBhcmcxLCBzdHJpbmcgYXJnMiwgdWludCBnYXNsaW1pdCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCl7CiAgICAgICAgdWludCBwcmljZSA9IG9yYWNsaXplLmdldFByaWNlKGRhdGFzb3VyY2UsIGdhc2xpbWl0KTsKICAgICAgICBpZiAocHJpY2UgPiAxIGV0aGVyICsgdHguZ2FzcHJpY2UqZ2FzbGltaXQpIHJldHVybiAwOyAvLyB1bmV4cGVjdGVkbHkgaGlnaCBwcmljZQogICAgICAgIHJldHVybiBvcmFjbGl6ZS5xdWVyeTJfd2l0aEdhc0xpbWl0LnZhbHVlKHByaWNlKSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGFyZzEsIGFyZzIsIGdhc2xpbWl0KTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmcgYXJnMSwgc3RyaW5nIGFyZzIsIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpewogICAgICAgIHVpbnQgcHJpY2UgPSBvcmFjbGl6ZS5nZXRQcmljZShkYXRhc291cmNlLCBnYXNsaW1pdCk7CiAgICAgICAgaWYgKHByaWNlID4gMSBldGhlciArIHR4Lmdhc3ByaWNlKmdhc2xpbWl0KSByZXR1cm4gMDsgLy8gdW5leHBlY3RlZGx5IGhpZ2ggcHJpY2UKICAgICAgICByZXR1cm4gb3JhY2xpemUucXVlcnkyX3dpdGhHYXNMaW1pdC52YWx1ZShwcmljZSkoMCwgZGF0YXNvdXJjZSwgYXJnMSwgYXJnMiwgZ2FzbGltaXQpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkoc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZ1tdIGFyZ04pIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpewogICAgICAgIHVpbnQgcHJpY2UgPSBvcmFjbGl6ZS5nZXRQcmljZShkYXRhc291cmNlKTsKICAgICAgICBpZiAocHJpY2UgPiAxIGV0aGVyICsgdHguZ2FzcHJpY2UqMjAwMDAwKSByZXR1cm4gMDsgLy8gdW5leHBlY3RlZGx5IGhpZ2ggcHJpY2UKICAgICAgICBieXRlcyBtZW1vcnkgYXJncyA9IHN0cmEyY2JvcihhcmdOKTsKICAgICAgICByZXR1cm4gb3JhY2xpemUucXVlcnlOLnZhbHVlKHByaWNlKSgwLCBkYXRhc291cmNlLCBhcmdzKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nW10gYXJnTikgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCl7CiAgICAgICAgdWludCBwcmljZSA9IG9yYWNsaXplLmdldFByaWNlKGRhdGFzb3VyY2UpOwogICAgICAgIGlmIChwcmljZSA+IDEgZXRoZXIgKyB0eC5nYXNwcmljZSoyMDAwMDApIHJldHVybiAwOyAvLyB1bmV4cGVjdGVkbHkgaGlnaCBwcmljZQogICAgICAgIGJ5dGVzIG1lbW9yeSBhcmdzID0gc3RyYTJjYm9yKGFyZ04pOwogICAgICAgIHJldHVybiBvcmFjbGl6ZS5xdWVyeU4udmFsdWUocHJpY2UpKHRpbWVzdGFtcCwgZGF0YXNvdXJjZSwgYXJncyk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeSh1aW50IHRpbWVzdGFtcCwgc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZ1tdIGFyZ04sIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpewogICAgICAgIHVpbnQgcHJpY2UgPSBvcmFjbGl6ZS5nZXRQcmljZShkYXRhc291cmNlLCBnYXNsaW1pdCk7CiAgICAgICAgaWYgKHByaWNlID4gMSBldGhlciArIHR4Lmdhc3ByaWNlKmdhc2xpbWl0KSByZXR1cm4gMDsgLy8gdW5leHBlY3RlZGx5IGhpZ2ggcHJpY2UKICAgICAgICBieXRlcyBtZW1vcnkgYXJncyA9IHN0cmEyY2JvcihhcmdOKTsKICAgICAgICByZXR1cm4gb3JhY2xpemUucXVlcnlOX3dpdGhHYXNMaW1pdC52YWx1ZShwcmljZSkodGltZXN0YW1wLCBkYXRhc291cmNlLCBhcmdzLCBnYXNsaW1pdCk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeShzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nW10gYXJnTiwgdWludCBnYXNsaW1pdCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCl7CiAgICAgICAgdWludCBwcmljZSA9IG9yYWNsaXplLmdldFByaWNlKGRhdGFzb3VyY2UsIGdhc2xpbWl0KTsKICAgICAgICBpZiAocHJpY2UgPiAxIGV0aGVyICsgdHguZ2FzcHJpY2UqZ2FzbGltaXQpIHJldHVybiAwOyAvLyB1bmV4cGVjdGVkbHkgaGlnaCBwcmljZQogICAgICAgIGJ5dGVzIG1lbW9yeSBhcmdzID0gc3RyYTJjYm9yKGFyZ04pOwogICAgICAgIHJldHVybiBvcmFjbGl6ZS5xdWVyeU5fd2l0aEdhc0xpbWl0LnZhbHVlKHByaWNlKSgwLCBkYXRhc291cmNlLCBhcmdzLCBnYXNsaW1pdCk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeShzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nWzFdIGFyZ3MpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBzdHJpbmdbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBzdHJpbmdbXSgxKTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkoZGF0YXNvdXJjZSwgZHluYXJncyk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeSh1aW50IHRpbWVzdGFtcCwgc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZ1sxXSBhcmdzKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgc3RyaW5nW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgc3RyaW5nW10oMSk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KHRpbWVzdGFtcCwgZGF0YXNvdXJjZSwgZHluYXJncyk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeSh1aW50IHRpbWVzdGFtcCwgc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZ1sxXSBhcmdzLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgc3RyaW5nW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgc3RyaW5nW10oMSk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KHRpbWVzdGFtcCwgZGF0YXNvdXJjZSwgZHluYXJncywgZ2FzbGltaXQpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkoc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZ1sxXSBhcmdzLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgc3RyaW5nW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgc3RyaW5nW10oMSk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KGRhdGFzb3VyY2UsIGR5bmFyZ3MsIGdhc2xpbWl0KTsKICAgIH0KCiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeShzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nWzJdIGFyZ3MpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBzdHJpbmdbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBzdHJpbmdbXSgyKTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkoZGF0YXNvdXJjZSwgZHluYXJncyk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeSh1aW50IHRpbWVzdGFtcCwgc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZ1syXSBhcmdzKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgc3RyaW5nW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgc3RyaW5nW10oMik7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KHRpbWVzdGFtcCwgZGF0YXNvdXJjZSwgZHluYXJncyk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeSh1aW50IHRpbWVzdGFtcCwgc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZ1syXSBhcmdzLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgc3RyaW5nW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgc3RyaW5nW10oMik7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KHRpbWVzdGFtcCwgZGF0YXNvdXJjZSwgZHluYXJncywgZ2FzbGltaXQpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkoc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZ1syXSBhcmdzLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgc3RyaW5nW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgc3RyaW5nW10oMik7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KGRhdGFzb3VyY2UsIGR5bmFyZ3MsIGdhc2xpbWl0KTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmdbM10gYXJncykgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIHN0cmluZ1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IHN0cmluZ1tdKDMpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIGR5bmFyZ3NbMl0gPSBhcmdzWzJdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeShkYXRhc291cmNlLCBkeW5hcmdzKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nWzNdIGFyZ3MpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBzdHJpbmdbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBzdHJpbmdbXSgzKTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICBkeW5hcmdzWzJdID0gYXJnc1syXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkodGltZXN0YW1wLCBkYXRhc291cmNlLCBkeW5hcmdzKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nWzNdIGFyZ3MsIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBzdHJpbmdbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBzdHJpbmdbXSgzKTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICBkeW5hcmdzWzJdID0gYXJnc1syXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkodGltZXN0YW1wLCBkYXRhc291cmNlLCBkeW5hcmdzLCBnYXNsaW1pdCk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeShzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nWzNdIGFyZ3MsIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBzdHJpbmdbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBzdHJpbmdbXSgzKTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICBkeW5hcmdzWzJdID0gYXJnc1syXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkoZGF0YXNvdXJjZSwgZHluYXJncywgZ2FzbGltaXQpOwogICAgfQoKICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmdbNF0gYXJncykgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIHN0cmluZ1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IHN0cmluZ1tdKDQpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIGR5bmFyZ3NbMl0gPSBhcmdzWzJdOwogICAgICAgIGR5bmFyZ3NbM10gPSBhcmdzWzNdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeShkYXRhc291cmNlLCBkeW5hcmdzKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nWzRdIGFyZ3MpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBzdHJpbmdbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBzdHJpbmdbXSg0KTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICBkeW5hcmdzWzJdID0gYXJnc1syXTsKICAgICAgICBkeW5hcmdzWzNdID0gYXJnc1szXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkodGltZXN0YW1wLCBkYXRhc291cmNlLCBkeW5hcmdzKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nWzRdIGFyZ3MsIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBzdHJpbmdbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBzdHJpbmdbXSg0KTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICBkeW5hcmdzWzJdID0gYXJnc1syXTsKICAgICAgICBkeW5hcmdzWzNdID0gYXJnc1szXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkodGltZXN0YW1wLCBkYXRhc291cmNlLCBkeW5hcmdzLCBnYXNsaW1pdCk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeShzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nWzRdIGFyZ3MsIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBzdHJpbmdbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBzdHJpbmdbXSg0KTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICBkeW5hcmdzWzJdID0gYXJnc1syXTsKICAgICAgICBkeW5hcmdzWzNdID0gYXJnc1szXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkoZGF0YXNvdXJjZSwgZHluYXJncywgZ2FzbGltaXQpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkoc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZ1s1XSBhcmdzKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgc3RyaW5nW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgc3RyaW5nW10oNSk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgZHluYXJnc1syXSA9IGFyZ3NbMl07CiAgICAgICAgZHluYXJnc1szXSA9IGFyZ3NbM107CiAgICAgICAgZHluYXJnc1s0XSA9IGFyZ3NbNF07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KGRhdGFzb3VyY2UsIGR5bmFyZ3MpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmdbNV0gYXJncykgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIHN0cmluZ1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IHN0cmluZ1tdKDUpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIGR5bmFyZ3NbMl0gPSBhcmdzWzJdOwogICAgICAgIGR5bmFyZ3NbM10gPSBhcmdzWzNdOwogICAgICAgIGR5bmFyZ3NbNF0gPSBhcmdzWzRdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGR5bmFyZ3MpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmdbNV0gYXJncywgdWludCBnYXNsaW1pdCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIHN0cmluZ1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IHN0cmluZ1tdKDUpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIGR5bmFyZ3NbMl0gPSBhcmdzWzJdOwogICAgICAgIGR5bmFyZ3NbM10gPSBhcmdzWzNdOwogICAgICAgIGR5bmFyZ3NbNF0gPSBhcmdzWzRdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGR5bmFyZ3MsIGdhc2xpbWl0KTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmdbNV0gYXJncywgdWludCBnYXNsaW1pdCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIHN0cmluZ1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IHN0cmluZ1tdKDUpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIGR5bmFyZ3NbMl0gPSBhcmdzWzJdOwogICAgICAgIGR5bmFyZ3NbM10gPSBhcmdzWzNdOwogICAgICAgIGR5bmFyZ3NbNF0gPSBhcmdzWzRdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeShkYXRhc291cmNlLCBkeW5hcmdzLCBnYXNsaW1pdCk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeShzdHJpbmcgZGF0YXNvdXJjZSwgYnl0ZXNbXSBhcmdOKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKXsKICAgICAgICB1aW50IHByaWNlID0gb3JhY2xpemUuZ2V0UHJpY2UoZGF0YXNvdXJjZSk7CiAgICAgICAgaWYgKHByaWNlID4gMSBldGhlciArIHR4Lmdhc3ByaWNlKjIwMDAwMCkgcmV0dXJuIDA7IC8vIHVuZXhwZWN0ZWRseSBoaWdoIHByaWNlCiAgICAgICAgYnl0ZXMgbWVtb3J5IGFyZ3MgPSBiYTJjYm9yKGFyZ04pOwogICAgICAgIHJldHVybiBvcmFjbGl6ZS5xdWVyeU4udmFsdWUocHJpY2UpKDAsIGRhdGFzb3VyY2UsIGFyZ3MpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBieXRlc1tdIGFyZ04pIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpewogICAgICAgIHVpbnQgcHJpY2UgPSBvcmFjbGl6ZS5nZXRQcmljZShkYXRhc291cmNlKTsKICAgICAgICBpZiAocHJpY2UgPiAxIGV0aGVyICsgdHguZ2FzcHJpY2UqMjAwMDAwKSByZXR1cm4gMDsgLy8gdW5leHBlY3RlZGx5IGhpZ2ggcHJpY2UKICAgICAgICBieXRlcyBtZW1vcnkgYXJncyA9IGJhMmNib3IoYXJnTik7CiAgICAgICAgcmV0dXJuIG9yYWNsaXplLnF1ZXJ5Ti52YWx1ZShwcmljZSkodGltZXN0YW1wLCBkYXRhc291cmNlLCBhcmdzKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgYnl0ZXNbXSBhcmdOLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKXsKICAgICAgICB1aW50IHByaWNlID0gb3JhY2xpemUuZ2V0UHJpY2UoZGF0YXNvdXJjZSwgZ2FzbGltaXQpOwogICAgICAgIGlmIChwcmljZSA+IDEgZXRoZXIgKyB0eC5nYXNwcmljZSpnYXNsaW1pdCkgcmV0dXJuIDA7IC8vIHVuZXhwZWN0ZWRseSBoaWdoIHByaWNlCiAgICAgICAgYnl0ZXMgbWVtb3J5IGFyZ3MgPSBiYTJjYm9yKGFyZ04pOwogICAgICAgIHJldHVybiBvcmFjbGl6ZS5xdWVyeU5fd2l0aEdhc0xpbWl0LnZhbHVlKHByaWNlKSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGFyZ3MsIGdhc2xpbWl0KTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBieXRlc1tdIGFyZ04sIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpewogICAgICAgIHVpbnQgcHJpY2UgPSBvcmFjbGl6ZS5nZXRQcmljZShkYXRhc291cmNlLCBnYXNsaW1pdCk7CiAgICAgICAgaWYgKHByaWNlID4gMSBldGhlciArIHR4Lmdhc3ByaWNlKmdhc2xpbWl0KSByZXR1cm4gMDsgLy8gdW5leHBlY3RlZGx5IGhpZ2ggcHJpY2UKICAgICAgICBieXRlcyBtZW1vcnkgYXJncyA9IGJhMmNib3IoYXJnTik7CiAgICAgICAgcmV0dXJuIG9yYWNsaXplLnF1ZXJ5Tl93aXRoR2FzTGltaXQudmFsdWUocHJpY2UpKDAsIGRhdGFzb3VyY2UsIGFyZ3MsIGdhc2xpbWl0KTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBieXRlc1sxXSBhcmdzKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgYnl0ZXNbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBieXRlc1tdKDEpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeShkYXRhc291cmNlLCBkeW5hcmdzKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgYnl0ZXNbMV0gYXJncykgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIGJ5dGVzW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgYnl0ZXNbXSgxKTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkodGltZXN0YW1wLCBkYXRhc291cmNlLCBkeW5hcmdzKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgYnl0ZXNbMV0gYXJncywgdWludCBnYXNsaW1pdCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIGJ5dGVzW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgYnl0ZXNbXSgxKTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkodGltZXN0YW1wLCBkYXRhc291cmNlLCBkeW5hcmdzLCBnYXNsaW1pdCk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeShzdHJpbmcgZGF0YXNvdXJjZSwgYnl0ZXNbMV0gYXJncywgdWludCBnYXNsaW1pdCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIGJ5dGVzW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgYnl0ZXNbXSgxKTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkoZGF0YXNvdXJjZSwgZHluYXJncywgZ2FzbGltaXQpOwogICAgfQoKICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBieXRlc1syXSBhcmdzKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgYnl0ZXNbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBieXRlc1tdKDIpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeShkYXRhc291cmNlLCBkeW5hcmdzKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgYnl0ZXNbMl0gYXJncykgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIGJ5dGVzW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgYnl0ZXNbXSgyKTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkodGltZXN0YW1wLCBkYXRhc291cmNlLCBkeW5hcmdzKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgYnl0ZXNbMl0gYXJncywgdWludCBnYXNsaW1pdCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIGJ5dGVzW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgYnl0ZXNbXSgyKTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkodGltZXN0YW1wLCBkYXRhc291cmNlLCBkeW5hcmdzLCBnYXNsaW1pdCk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeShzdHJpbmcgZGF0YXNvdXJjZSwgYnl0ZXNbMl0gYXJncywgdWludCBnYXNsaW1pdCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIGJ5dGVzW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgYnl0ZXNbXSgyKTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkoZGF0YXNvdXJjZSwgZHluYXJncywgZ2FzbGltaXQpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkoc3RyaW5nIGRhdGFzb3VyY2UsIGJ5dGVzWzNdIGFyZ3MpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBieXRlc1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IGJ5dGVzW10oMyk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgZHluYXJnc1syXSA9IGFyZ3NbMl07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KGRhdGFzb3VyY2UsIGR5bmFyZ3MpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBieXRlc1szXSBhcmdzKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgYnl0ZXNbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBieXRlc1tdKDMpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIGR5bmFyZ3NbMl0gPSBhcmdzWzJdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGR5bmFyZ3MpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBieXRlc1szXSBhcmdzLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgYnl0ZXNbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBieXRlc1tdKDMpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIGR5bmFyZ3NbMl0gPSBhcmdzWzJdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGR5bmFyZ3MsIGdhc2xpbWl0KTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBieXRlc1szXSBhcmdzLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgYnl0ZXNbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBieXRlc1tdKDMpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIGR5bmFyZ3NbMl0gPSBhcmdzWzJdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeShkYXRhc291cmNlLCBkeW5hcmdzLCBnYXNsaW1pdCk7CiAgICB9CgogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkoc3RyaW5nIGRhdGFzb3VyY2UsIGJ5dGVzWzRdIGFyZ3MpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBieXRlc1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IGJ5dGVzW10oNCk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgZHluYXJnc1syXSA9IGFyZ3NbMl07CiAgICAgICAgZHluYXJnc1szXSA9IGFyZ3NbM107CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KGRhdGFzb3VyY2UsIGR5bmFyZ3MpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBieXRlc1s0XSBhcmdzKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgYnl0ZXNbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBieXRlc1tdKDQpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIGR5bmFyZ3NbMl0gPSBhcmdzWzJdOwogICAgICAgIGR5bmFyZ3NbM10gPSBhcmdzWzNdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGR5bmFyZ3MpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBieXRlc1s0XSBhcmdzLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgYnl0ZXNbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBieXRlc1tdKDQpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIGR5bmFyZ3NbMl0gPSBhcmdzWzJdOwogICAgICAgIGR5bmFyZ3NbM10gPSBhcmdzWzNdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGR5bmFyZ3MsIGdhc2xpbWl0KTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBieXRlc1s0XSBhcmdzLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgYnl0ZXNbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBieXRlc1tdKDQpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIGR5bmFyZ3NbMl0gPSBhcmdzWzJdOwogICAgICAgIGR5bmFyZ3NbM10gPSBhcmdzWzNdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeShkYXRhc291cmNlLCBkeW5hcmdzLCBnYXNsaW1pdCk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeShzdHJpbmcgZGF0YXNvdXJjZSwgYnl0ZXNbNV0gYXJncykgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIGJ5dGVzW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgYnl0ZXNbXSg1KTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICBkeW5hcmdzWzJdID0gYXJnc1syXTsKICAgICAgICBkeW5hcmdzWzNdID0gYXJnc1szXTsKICAgICAgICBkeW5hcmdzWzRdID0gYXJnc1s0XTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkoZGF0YXNvdXJjZSwgZHluYXJncyk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeSh1aW50IHRpbWVzdGFtcCwgc3RyaW5nIGRhdGFzb3VyY2UsIGJ5dGVzWzVdIGFyZ3MpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBieXRlc1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IGJ5dGVzW10oNSk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgZHluYXJnc1syXSA9IGFyZ3NbMl07CiAgICAgICAgZHluYXJnc1szXSA9IGFyZ3NbM107CiAgICAgICAgZHluYXJnc1s0XSA9IGFyZ3NbNF07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KHRpbWVzdGFtcCwgZGF0YXNvdXJjZSwgZHluYXJncyk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeSh1aW50IHRpbWVzdGFtcCwgc3RyaW5nIGRhdGFzb3VyY2UsIGJ5dGVzWzVdIGFyZ3MsIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBieXRlc1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IGJ5dGVzW10oNSk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgZHluYXJnc1syXSA9IGFyZ3NbMl07CiAgICAgICAgZHluYXJnc1szXSA9IGFyZ3NbM107CiAgICAgICAgZHluYXJnc1s0XSA9IGFyZ3NbNF07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KHRpbWVzdGFtcCwgZGF0YXNvdXJjZSwgZHluYXJncywgZ2FzbGltaXQpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkoc3RyaW5nIGRhdGFzb3VyY2UsIGJ5dGVzWzVdIGFyZ3MsIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBieXRlc1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IGJ5dGVzW10oNSk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgZHluYXJnc1syXSA9IGFyZ3NbMl07CiAgICAgICAgZHluYXJnc1szXSA9IGFyZ3NbM107CiAgICAgICAgZHluYXJnc1s0XSA9IGFyZ3NbNF07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KGRhdGFzb3VyY2UsIGR5bmFyZ3MsIGdhc2xpbWl0KTsKICAgIH0KCiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9jYkFkZHJlc3MoKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChhZGRyZXNzKXsKICAgICAgICByZXR1cm4gb3JhY2xpemUuY2JBZGRyZXNzKCk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9zZXRQcm9vZihieXRlIHByb29mUCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgewogICAgICAgIHJldHVybiBvcmFjbGl6ZS5zZXRQcm9vZlR5cGUocHJvb2ZQKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3NldEN1c3RvbUdhc1ByaWNlKHVpbnQgZ2FzUHJpY2UpIG9yYWNsaXplQVBJIGludGVybmFsIHsKICAgICAgICByZXR1cm4gb3JhY2xpemUuc2V0Q3VzdG9tR2FzUHJpY2UoZ2FzUHJpY2UpOwogICAgfQoKICAgIGZ1bmN0aW9uIG9yYWNsaXplX3JhbmRvbURTX2dldFNlc3Npb25QdWJLZXlIYXNoKCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMil7CiAgICAgICAgcmV0dXJuIG9yYWNsaXplLnJhbmRvbURTX2dldFNlc3Npb25QdWJLZXlIYXNoKCk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0Q29kZVNpemUoYWRkcmVzcyBfYWRkcikgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyh1aW50IF9zaXplKSB7CiAgICAgICAgYXNzZW1ibHkgewogICAgICAgICAgICBfc2l6ZSA6PSBleHRjb2Rlc2l6ZShfYWRkcikKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gcGFyc2VBZGRyKHN0cmluZyBfYSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChhZGRyZXNzKXsKICAgICAgICBieXRlcyBtZW1vcnkgdG1wID0gYnl0ZXMoX2EpOwogICAgICAgIHVpbnQxNjAgaWFkZHIgPSAwOwogICAgICAgIHVpbnQxNjAgYjE7CiAgICAgICAgdWludDE2MCBiMjsKICAgICAgICBmb3IgKHVpbnQgaT0yOyBpPDIrMioyMDsgaSs9Mil7CiAgICAgICAgICAgIGlhZGRyICo9IDI1NjsKICAgICAgICAgICAgYjEgPSB1aW50MTYwKHRtcFtpXSk7CiAgICAgICAgICAgIGIyID0gdWludDE2MCh0bXBbaSsxXSk7CiAgICAgICAgICAgIGlmICgoYjEgPj0gOTcpJiYoYjEgPD0gMTAyKSkgYjEgLT0gODc7CiAgICAgICAgICAgIGVsc2UgaWYgKChiMSA+PSA2NSkmJihiMSA8PSA3MCkpIGIxIC09IDU1OwogICAgICAgICAgICBlbHNlIGlmICgoYjEgPj0gNDgpJiYoYjEgPD0gNTcpKSBiMSAtPSA0ODsKICAgICAgICAgICAgaWYgKChiMiA+PSA5NykmJihiMiA8PSAxMDIpKSBiMiAtPSA4NzsKICAgICAgICAgICAgZWxzZSBpZiAoKGIyID49IDY1KSYmKGIyIDw9IDcwKSkgYjIgLT0gNTU7CiAgICAgICAgICAgIGVsc2UgaWYgKChiMiA+PSA0OCkmJihiMiA8PSA1NykpIGIyIC09IDQ4OwogICAgICAgICAgICBpYWRkciArPSAoYjEqMTYrYjIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYWRkcmVzcyhpYWRkcik7CiAgICB9CgogICAgZnVuY3Rpb24gc3RyQ29tcGFyZShzdHJpbmcgX2EsIHN0cmluZyBfYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChpbnQpIHsKICAgICAgICBieXRlcyBtZW1vcnkgYSA9IGJ5dGVzKF9hKTsKICAgICAgICBieXRlcyBtZW1vcnkgYiA9IGJ5dGVzKF9iKTsKICAgICAgICB1aW50IG1pbkxlbmd0aCA9IGEubGVuZ3RoOwogICAgICAgIGlmIChiLmxlbmd0aCA8IG1pbkxlbmd0aCkgbWluTGVuZ3RoID0gYi5sZW5ndGg7CiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgbWluTGVuZ3RoOyBpICsrKQogICAgICAgICAgICBpZiAoYVtpXSA8IGJbaV0pCiAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIGVsc2UgaWYgKGFbaV0gPiBiW2ldKQogICAgICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgaWYgKGEubGVuZ3RoIDwgYi5sZW5ndGgpCiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICBlbHNlIGlmIChhLmxlbmd0aCA+IGIubGVuZ3RoKQogICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJldHVybiAwOwogICAgfQoKICAgIGZ1bmN0aW9uIGluZGV4T2Yoc3RyaW5nIF9oYXlzdGFjaywgc3RyaW5nIF9uZWVkbGUpIGludGVybmFsIHB1cmUgcmV0dXJucyAoaW50KSB7CiAgICAgICAgYnl0ZXMgbWVtb3J5IGggPSBieXRlcyhfaGF5c3RhY2spOwogICAgICAgIGJ5dGVzIG1lbW9yeSBuID0gYnl0ZXMoX25lZWRsZSk7CiAgICAgICAgaWYoaC5sZW5ndGggPCAxIHx8IG4ubGVuZ3RoIDwgMSB8fCAobi5sZW5ndGggPiBoLmxlbmd0aCkpCiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICBlbHNlIGlmKGgubGVuZ3RoID4gKDIqKjEyOCAtMSkpCiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICB1aW50IHN1YmluZGV4ID0gMDsKICAgICAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgaC5sZW5ndGg7IGkgKyspCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChoW2ldID09IG5bMF0pCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgc3ViaW5kZXggPSAxOwogICAgICAgICAgICAgICAgICAgIHdoaWxlKHN1YmluZGV4IDwgbi5sZW5ndGggJiYgKGkgKyBzdWJpbmRleCkgPCBoLmxlbmd0aCAmJiBoW2kgKyBzdWJpbmRleF0gPT0gbltzdWJpbmRleF0pCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBzdWJpbmRleCsrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZihzdWJpbmRleCA9PSBuLmxlbmd0aCkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGludChpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHN0ckNvbmNhdChzdHJpbmcgX2EsIHN0cmluZyBfYiwgc3RyaW5nIF9jLCBzdHJpbmcgX2QsIHN0cmluZyBfZSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChzdHJpbmcpIHsKICAgICAgICBieXRlcyBtZW1vcnkgX2JhID0gYnl0ZXMoX2EpOwogICAgICAgIGJ5dGVzIG1lbW9yeSBfYmIgPSBieXRlcyhfYik7CiAgICAgICAgYnl0ZXMgbWVtb3J5IF9iYyA9IGJ5dGVzKF9jKTsKICAgICAgICBieXRlcyBtZW1vcnkgX2JkID0gYnl0ZXMoX2QpOwogICAgICAgIGJ5dGVzIG1lbW9yeSBfYmUgPSBieXRlcyhfZSk7CiAgICAgICAgc3RyaW5nIG1lbW9yeSBhYmNkZSA9IG5ldyBzdHJpbmcoX2JhLmxlbmd0aCArIF9iYi5sZW5ndGggKyBfYmMubGVuZ3RoICsgX2JkLmxlbmd0aCArIF9iZS5sZW5ndGgpOwogICAgICAgIGJ5dGVzIG1lbW9yeSBiYWJjZGUgPSBieXRlcyhhYmNkZSk7CiAgICAgICAgdWludCBrID0gMDsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBfYmEubGVuZ3RoOyBpKyspIGJhYmNkZVtrKytdID0gX2JhW2ldOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBfYmIubGVuZ3RoOyBpKyspIGJhYmNkZVtrKytdID0gX2JiW2ldOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBfYmMubGVuZ3RoOyBpKyspIGJhYmNkZVtrKytdID0gX2JjW2ldOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBfYmQubGVuZ3RoOyBpKyspIGJhYmNkZVtrKytdID0gX2JkW2ldOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBfYmUubGVuZ3RoOyBpKyspIGJhYmNkZVtrKytdID0gX2JlW2ldOwogICAgICAgIHJldHVybiBzdHJpbmcoYmFiY2RlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzdHJDb25jYXQoc3RyaW5nIF9hLCBzdHJpbmcgX2IsIHN0cmluZyBfYywgc3RyaW5nIF9kKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHN0cmluZykgewogICAgICAgIHJldHVybiBzdHJDb25jYXQoX2EsIF9iLCBfYywgX2QsICIiKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzdHJDb25jYXQoc3RyaW5nIF9hLCBzdHJpbmcgX2IsIHN0cmluZyBfYykgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChzdHJpbmcpIHsKICAgICAgICByZXR1cm4gc3RyQ29uY2F0KF9hLCBfYiwgX2MsICIiLCAiIik7CiAgICB9CgogICAgZnVuY3Rpb24gc3RyQ29uY2F0KHN0cmluZyBfYSwgc3RyaW5nIF9iKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHN0cmluZykgewogICAgICAgIHJldHVybiBzdHJDb25jYXQoX2EsIF9iLCAiIiwgIiIsICIiKTsKICAgIH0KCiAgICAvLyBwYXJzZUludAogICAgZnVuY3Rpb24gcGFyc2VJbnQoc3RyaW5nIF9hKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gcGFyc2VJbnQoX2EsIDApOwogICAgfQoKICAgIC8vIHBhcnNlSW50KHBhcnNlRmxvYXQqMTBeX2IpCiAgICBmdW5jdGlvbiBwYXJzZUludChzdHJpbmcgX2EsIHVpbnQgX2IpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCkgewogICAgICAgIGJ5dGVzIG1lbW9yeSBicmVzdWx0ID0gYnl0ZXMoX2EpOwogICAgICAgIHVpbnQgbWludCA9IDA7CiAgICAgICAgYm9vbCBkZWNpbWFscyA9IGZhbHNlOwogICAgICAgIGZvciAodWludCBpPTA7IGk8YnJlc3VsdC5sZW5ndGg7IGkrKyl7CiAgICAgICAgICAgIGlmICgoYnJlc3VsdFtpXSA+PSA0OCkmJihicmVzdWx0W2ldIDw9IDU3KSl7CiAgICAgICAgICAgICAgICBpZiAoZGVjaW1hbHMpewogICAgICAgICAgICAgICAgICAgaWYgKF9iID09IDApIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGVsc2UgX2ItLTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIG1pbnQgKj0gMTA7CiAgICAgICAgICAgICAgICBtaW50ICs9IHVpbnQoYnJlc3VsdFtpXSkgLSA0ODsKICAgICAgICAgICAgfSBlbHNlIGlmIChicmVzdWx0W2ldID09IDQ2KSBkZWNpbWFscyA9IHRydWU7CiAgICAgICAgfQogICAgICAgIGlmIChfYiA+IDApIG1pbnQgKj0gMTAqKl9iOwogICAgICAgIHJldHVybiBtaW50OwogICAgfQoKICAgIGZ1bmN0aW9uIHVpbnQyc3RyKHVpbnQgaSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChzdHJpbmcpewogICAgICAgIGlmIChpID09IDApIHJldHVybiAiMCI7CiAgICAgICAgdWludCBqID0gaTsKICAgICAgICB1aW50IGxlbjsKICAgICAgICB3aGlsZSAoaiAhPSAwKXsKICAgICAgICAgICAgbGVuKys7CiAgICAgICAgICAgIGogLz0gMTA7CiAgICAgICAgfQogICAgICAgIGJ5dGVzIG1lbW9yeSBic3RyID0gbmV3IGJ5dGVzKGxlbik7CiAgICAgICAgdWludCBrID0gbGVuIC0gMTsKICAgICAgICB3aGlsZSAoaSAhPSAwKXsKICAgICAgICAgICAgYnN0cltrLS1dID0gYnl0ZSg0OCArIGkgJSAxMCk7CiAgICAgICAgICAgIGkgLz0gMTA7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzdHJpbmcoYnN0cik7CiAgICB9CgogICAgZnVuY3Rpb24gc3RyYTJjYm9yKHN0cmluZ1tdIGFycikgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChieXRlcykgewogICAgICAgICAgICB1aW50IGFycmxlbiA9IGFyci5sZW5ndGg7CgogICAgICAgICAgICAvLyBnZXQgY29ycmVjdCBjYm9yIG91dHB1dCBsZW5ndGgKICAgICAgICAgICAgdWludCBvdXRwdXRsZW4gPSAwOwogICAgICAgICAgICBieXRlc1tdIG1lbW9yeSBlbGVtQXJyYXkgPSBuZXcgYnl0ZXNbXShhcnJsZW4pOwogICAgICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBhcnJsZW47IGkrKykgewogICAgICAgICAgICAgICAgZWxlbUFycmF5W2ldID0gKGJ5dGVzKGFycltpXSkpOwogICAgICAgICAgICAgICAgb3V0cHV0bGVuICs9IGVsZW1BcnJheVtpXS5sZW5ndGggKyAoZWxlbUFycmF5W2ldLmxlbmd0aCAtIDEpLzIzICsgMzsgLy8rMyBhY2NvdW50cyBmb3IgcGFpcmVkIGlkZW50aWZpZXIgdHlwZXMKICAgICAgICAgICAgfQogICAgICAgICAgICB1aW50IGN0ciA9IDA7CiAgICAgICAgICAgIHVpbnQgY2JvcmxlbiA9IGFycmxlbiArIDB4ODA7CiAgICAgICAgICAgIG91dHB1dGxlbiArPSBieXRlKGNib3JsZW4pLmxlbmd0aDsKICAgICAgICAgICAgYnl0ZXMgbWVtb3J5IHJlcyA9IG5ldyBieXRlcyhvdXRwdXRsZW4pOwoKICAgICAgICAgICAgd2hpbGUgKGJ5dGUoY2JvcmxlbikubGVuZ3RoID4gY3RyKSB7CiAgICAgICAgICAgICAgICByZXNbY3RyXSA9IGJ5dGUoY2JvcmxlbilbY3RyXTsKICAgICAgICAgICAgICAgIGN0cisrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBhcnJsZW47IGkrKykgewogICAgICAgICAgICAgICAgcmVzW2N0cl0gPSAweDVGOwogICAgICAgICAgICAgICAgY3RyKys7CiAgICAgICAgICAgICAgICBmb3IgKHVpbnQgeCA9IDA7IHggPCBlbGVtQXJyYXlbaV0ubGVuZ3RoOyB4KyspIHsKICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGVyZSdzIGEgYnVnIHdpdGggbGFyZ2VyIHN0cmluZ3MsIHRoaXMgbWF5IGJlIHRoZSBjdWxwcml0CiAgICAgICAgICAgICAgICAgICAgaWYgKHggJSAyMyA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQgZWxlbWNib3JsZW4gPSBlbGVtQXJyYXlbaV0ubGVuZ3RoIC0geCA+PSAyNCA/IDIzIDogZWxlbUFycmF5W2ldLmxlbmd0aCAtIHg7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1jYm9ybGVuICs9IDB4NDA7CiAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQgbGN0ciA9IGN0cjsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGJ5dGUoZWxlbWNib3JsZW4pLmxlbmd0aCA+IGN0ciAtIGxjdHIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc1tjdHJdID0gYnl0ZShlbGVtY2JvcmxlbilbY3RyIC0gbGN0cl07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHIrKzsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXNbY3RyXSA9IGVsZW1BcnJheVtpXVt4XTsKICAgICAgICAgICAgICAgICAgICBjdHIrKzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJlc1tjdHJdID0gMHhGRjsKICAgICAgICAgICAgICAgIGN0cisrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgfQoKICAgIGZ1bmN0aW9uIGJhMmNib3IoYnl0ZXNbXSBhcnIpIGludGVybmFsIHB1cmUgcmV0dXJucyAoYnl0ZXMpIHsKICAgICAgICAgICAgdWludCBhcnJsZW4gPSBhcnIubGVuZ3RoOwoKICAgICAgICAgICAgLy8gZ2V0IGNvcnJlY3QgY2JvciBvdXRwdXQgbGVuZ3RoCiAgICAgICAgICAgIHVpbnQgb3V0cHV0bGVuID0gMDsKICAgICAgICAgICAgYnl0ZXNbXSBtZW1vcnkgZWxlbUFycmF5ID0gbmV3IGJ5dGVzW10oYXJybGVuKTsKICAgICAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgYXJybGVuOyBpKyspIHsKICAgICAgICAgICAgICAgIGVsZW1BcnJheVtpXSA9IChieXRlcyhhcnJbaV0pKTsKICAgICAgICAgICAgICAgIG91dHB1dGxlbiArPSBlbGVtQXJyYXlbaV0ubGVuZ3RoICsgKGVsZW1BcnJheVtpXS5sZW5ndGggLSAxKS8yMyArIDM7IC8vKzMgYWNjb3VudHMgZm9yIHBhaXJlZCBpZGVudGlmaWVyIHR5cGVzCiAgICAgICAgICAgIH0KICAgICAgICAgICAgdWludCBjdHIgPSAwOwogICAgICAgICAgICB1aW50IGNib3JsZW4gPSBhcnJsZW4gKyAweDgwOwogICAgICAgICAgICBvdXRwdXRsZW4gKz0gYnl0ZShjYm9ybGVuKS5sZW5ndGg7CiAgICAgICAgICAgIGJ5dGVzIG1lbW9yeSByZXMgPSBuZXcgYnl0ZXMob3V0cHV0bGVuKTsKCiAgICAgICAgICAgIHdoaWxlIChieXRlKGNib3JsZW4pLmxlbmd0aCA+IGN0cikgewogICAgICAgICAgICAgICAgcmVzW2N0cl0gPSBieXRlKGNib3JsZW4pW2N0cl07CiAgICAgICAgICAgICAgICBjdHIrKzsKICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgYXJybGVuOyBpKyspIHsKICAgICAgICAgICAgICAgIHJlc1tjdHJdID0gMHg1RjsKICAgICAgICAgICAgICAgIGN0cisrOwogICAgICAgICAgICAgICAgZm9yICh1aW50IHggPSAwOyB4IDwgZWxlbUFycmF5W2ldLmxlbmd0aDsgeCsrKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlcmUncyBhIGJ1ZyB3aXRoIGxhcmdlciBzdHJpbmdzLCB0aGlzIG1heSBiZSB0aGUgY3VscHJpdAogICAgICAgICAgICAgICAgICAgIGlmICh4ICUgMjMgPT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICB1aW50IGVsZW1jYm9ybGVuID0gZWxlbUFycmF5W2ldLmxlbmd0aCAtIHggPj0gMjQgPyAyMyA6IGVsZW1BcnJheVtpXS5sZW5ndGggLSB4OwogICAgICAgICAgICAgICAgICAgICAgICBlbGVtY2JvcmxlbiArPSAweDQwOwogICAgICAgICAgICAgICAgICAgICAgICB1aW50IGxjdHIgPSBjdHI7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChieXRlKGVsZW1jYm9ybGVuKS5sZW5ndGggPiBjdHIgLSBsY3RyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNbY3RyXSA9IGJ5dGUoZWxlbWNib3JsZW4pW2N0ciAtIGxjdHJdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3RyKys7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmVzW2N0cl0gPSBlbGVtQXJyYXlbaV1beF07CiAgICAgICAgICAgICAgICAgICAgY3RyKys7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXNbY3RyXSA9IDB4RkY7CiAgICAgICAgICAgICAgICBjdHIrKzsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gcmVzOwogICAgICAgIH0KCgogICAgc3RyaW5nIG9yYWNsaXplX25ldHdvcmtfbmFtZTsKICAgIGZ1bmN0aW9uIG9yYWNsaXplX3NldE5ldHdvcmtOYW1lKHN0cmluZyBfbmV0d29ya19uYW1lKSBpbnRlcm5hbCB7CiAgICAgICAgb3JhY2xpemVfbmV0d29ya19uYW1lID0gX25ldHdvcmtfbmFtZTsKICAgIH0KCiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9nZXROZXR3b3JrTmFtZSgpIGludGVybmFsIHZpZXcgcmV0dXJucyAoc3RyaW5nKSB7CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX25ldHdvcmtfbmFtZTsKICAgIH0KCiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9uZXdSYW5kb21EU1F1ZXJ5KHVpbnQgX2RlbGF5LCB1aW50IF9uYnl0ZXMsIHVpbnQgX2N1c3RvbUdhc0xpbWl0KSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyKXsKICAgICAgICByZXF1aXJlKChfbmJ5dGVzID4gMCkgJiYgKF9uYnl0ZXMgPD0gMzIpKTsKICAgICAgICBieXRlcyBtZW1vcnkgbmJ5dGVzID0gbmV3IGJ5dGVzKDEpOwogICAgICAgIG5ieXRlc1swXSA9IGJ5dGUoX25ieXRlcyk7CiAgICAgICAgYnl0ZXMgbWVtb3J5IHVub25jZSA9IG5ldyBieXRlcygzMik7CiAgICAgICAgYnl0ZXMgbWVtb3J5IHNlc3Npb25LZXlIYXNoID0gbmV3IGJ5dGVzKDMyKTsKICAgICAgICBieXRlczMyIHNlc3Npb25LZXlIYXNoX2J5dGVzMzIgPSBvcmFjbGl6ZV9yYW5kb21EU19nZXRTZXNzaW9uUHViS2V5SGFzaCgpOwogICAgICAgIGFzc2VtYmx5IHsKICAgICAgICAgICAgbXN0b3JlKHVub25jZSwgMHgyMCkKICAgICAgICAgICAgbXN0b3JlKGFkZCh1bm9uY2UsIDB4MjApLCB4b3IoYmxvY2toYXNoKHN1YihudW1iZXIsIDEpKSwgeG9yKGNvaW5iYXNlLCB0aW1lc3RhbXApKSkKICAgICAgICAgICAgbXN0b3JlKHNlc3Npb25LZXlIYXNoLCAweDIwKQogICAgICAgICAgICBtc3RvcmUoYWRkKHNlc3Npb25LZXlIYXNoLCAweDIwKSwgc2Vzc2lvbktleUhhc2hfYnl0ZXMzMikKICAgICAgICB9CiAgICAgICAgYnl0ZXNbM10gbWVtb3J5IGFyZ3MgPSBbdW5vbmNlLCBuYnl0ZXMsIHNlc3Npb25LZXlIYXNoXTsKICAgICAgICBieXRlczMyIHF1ZXJ5SWQgPSBvcmFjbGl6ZV9xdWVyeShfZGVsYXksICJyYW5kb20iLCBhcmdzLCBfY3VzdG9tR2FzTGltaXQpOwogICAgICAgIG9yYWNsaXplX3JhbmRvbURTX3NldENvbW1pdG1lbnQocXVlcnlJZCwga2VjY2FrMjU2KGJ5dGVzOChfZGVsYXkpLCBhcmdzWzFdLCBzaGEyNTYoYXJnc1swXSksIGFyZ3NbMl0pKTsKICAgICAgICByZXR1cm4gcXVlcnlJZDsKICAgIH0KCiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9yYW5kb21EU19zZXRDb21taXRtZW50KGJ5dGVzMzIgcXVlcnlJZCwgYnl0ZXMzMiBjb21taXRtZW50KSBpbnRlcm5hbCB7CiAgICAgICAgb3JhY2xpemVfcmFuZG9tRFNfYXJnc1txdWVyeUlkXSA9IGNvbW1pdG1lbnQ7CiAgICB9CgogICAgbWFwcGluZyhieXRlczMyPT5ieXRlczMyKSBvcmFjbGl6ZV9yYW5kb21EU19hcmdzOwogICAgbWFwcGluZyhieXRlczMyPT5ib29sKSBvcmFjbGl6ZV9yYW5kb21EU19zZXNzaW9uS2V5c0hhc2hWZXJpZmllZDsKCiAgICBmdW5jdGlvbiB2ZXJpZnlTaWcoYnl0ZXMzMiB0b3NpZ25oLCBieXRlcyBkZXJzaWcsIGJ5dGVzIHB1YmtleSkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCl7CiAgICAgICAgYm9vbCBzaWdvazsKICAgICAgICBhZGRyZXNzIHNpZ25lcjsKCiAgICAgICAgYnl0ZXMzMiBzaWdyOwogICAgICAgIGJ5dGVzMzIgc2lnczsKCiAgICAgICAgYnl0ZXMgbWVtb3J5IHNpZ3JfID0gbmV3IGJ5dGVzKDMyKTsKICAgICAgICB1aW50IG9mZnNldCA9IDQrKHVpbnQoZGVyc2lnWzNdKSAtIDB4MjApOwogICAgICAgIHNpZ3JfID0gY29weUJ5dGVzKGRlcnNpZywgb2Zmc2V0LCAzMiwgc2lncl8sIDApOwogICAgICAgIGJ5dGVzIG1lbW9yeSBzaWdzXyA9IG5ldyBieXRlcygzMik7CiAgICAgICAgb2Zmc2V0ICs9IDMyICsgMjsKICAgICAgICBzaWdzXyA9IGNvcHlCeXRlcyhkZXJzaWcsIG9mZnNldCsodWludChkZXJzaWdbb2Zmc2V0LTFdKSAtIDB4MjApLCAzMiwgc2lnc18sIDApOwoKICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgIHNpZ3IgOj0gbWxvYWQoYWRkKHNpZ3JfLCAzMikpCiAgICAgICAgICAgIHNpZ3MgOj0gbWxvYWQoYWRkKHNpZ3NfLCAzMikpCiAgICAgICAgfQoKCiAgICAgICAgKHNpZ29rLCBzaWduZXIpID0gc2FmZXJfZWNyZWNvdmVyKHRvc2lnbmgsIDI3LCBzaWdyLCBzaWdzKTsKICAgICAgICBpZiAoYWRkcmVzcyhrZWNjYWsyNTYocHVia2V5KSkgPT0gc2lnbmVyKSByZXR1cm4gdHJ1ZTsKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgKHNpZ29rLCBzaWduZXIpID0gc2FmZXJfZWNyZWNvdmVyKHRvc2lnbmgsIDI4LCBzaWdyLCBzaWdzKTsKICAgICAgICAgICAgcmV0dXJuIChhZGRyZXNzKGtlY2NhazI1NihwdWJrZXkpKSA9PSBzaWduZXIpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9yYW5kb21EU19wcm9vZlZlcmlmeV9fc2Vzc2lvbktleVZhbGlkaXR5KGJ5dGVzIHByb29mLCB1aW50IHNpZzJvZmZzZXQpIGludGVybmFsIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBib29sIHNpZ29rOwoKICAgICAgICAvLyBTdGVwIDY6IHZlcmlmeSB0aGUgYXR0ZXN0YXRpb24gc2lnbmF0dXJlLCBBUFBLRVkxIG11c3Qgc2lnbiB0aGUgc2Vzc2lvbktleSBmcm9tIHRoZSBjb3JyZWN0IGxlZGdlciBhcHAgKENPREVIQVNIKQogICAgICAgIGJ5dGVzIG1lbW9yeSBzaWcyID0gbmV3IGJ5dGVzKHVpbnQocHJvb2Zbc2lnMm9mZnNldCsxXSkrMik7CiAgICAgICAgY29weUJ5dGVzKHByb29mLCBzaWcyb2Zmc2V0LCBzaWcyLmxlbmd0aCwgc2lnMiwgMCk7CgogICAgICAgIGJ5dGVzIG1lbW9yeSBhcHBrZXkxX3B1YmtleSA9IG5ldyBieXRlcyg2NCk7CiAgICAgICAgY29weUJ5dGVzKHByb29mLCAzKzEsIDY0LCBhcHBrZXkxX3B1YmtleSwgMCk7CgogICAgICAgIGJ5dGVzIG1lbW9yeSB0b3NpZ24yID0gbmV3IGJ5dGVzKDErNjUrMzIpOwogICAgICAgIHRvc2lnbjJbMF0gPSBieXRlKDEpOyAvL3JvbGUKICAgICAgICBjb3B5Qnl0ZXMocHJvb2YsIHNpZzJvZmZzZXQtNjUsIDY1LCB0b3NpZ24yLCAxKTsKICAgICAgICBieXRlcyBtZW1vcnkgQ09ERUhBU0ggPSBoZXgiZmQ5NGZhNzFiYzBiYTEwZDM5ZDQ2NGQwZDhmNDY1ZWZlZWYwYTI3NjRlMzg4N2ZjYzlkZjQxZGVkMjBmNTA1YyI7CiAgICAgICAgY29weUJ5dGVzKENPREVIQVNILCAwLCAzMiwgdG9zaWduMiwgMSs2NSk7CiAgICAgICAgc2lnb2sgPSB2ZXJpZnlTaWcoc2hhMjU2KHRvc2lnbjIpLCBzaWcyLCBhcHBrZXkxX3B1YmtleSk7CgogICAgICAgIGlmIChzaWdvayA9PSBmYWxzZSkgcmV0dXJuIGZhbHNlOwoKCiAgICAgICAgLy8gU3RlcCA3OiB2ZXJpZnkgdGhlIEFQUEtFWTEgcHJvdmVuYW5jZSAobXVzdCBiZSBzaWduZWQgYnkgTGVkZ2VyKQogICAgICAgIGJ5dGVzIG1lbW9yeSBMRURHRVJLRVkgPSBoZXgiN2ZiOTU2NDY5YzVjOWI4OTg0MGQ1NWI0MzUzN2U2NmE5OGRkNDgxMWVhMGEyNzIyNDI3MmMyZTU2MjI5MTFlODUzN2EyZjhlODZhNDZiYWVjODI4NjRlOThkZDAxZTljY2MyZjhiYzVkZmM5Y2JlNWE5MWEyOTA0OThkZDk2ZTQiOwoKICAgICAgICBieXRlcyBtZW1vcnkgdG9zaWduMyA9IG5ldyBieXRlcygxKzY1KTsKICAgICAgICB0b3NpZ24zWzBdID0gMHhGRTsKICAgICAgICBjb3B5Qnl0ZXMocHJvb2YsIDMsIDY1LCB0b3NpZ24zLCAxKTsKCiAgICAgICAgYnl0ZXMgbWVtb3J5IHNpZzMgPSBuZXcgYnl0ZXModWludChwcm9vZlszKzY1KzFdKSsyKTsKICAgICAgICBjb3B5Qnl0ZXMocHJvb2YsIDMrNjUsIHNpZzMubGVuZ3RoLCBzaWczLCAwKTsKCiAgICAgICAgc2lnb2sgPSB2ZXJpZnlTaWcoc2hhMjU2KHRvc2lnbjMpLCBzaWczLCBMRURHRVJLRVkpOwoKICAgICAgICByZXR1cm4gc2lnb2s7CiAgICB9CgogICAgbW9kaWZpZXIgb3JhY2xpemVfcmFuZG9tRFNfcHJvb2ZWZXJpZnkoYnl0ZXMzMiBfcXVlcnlJZCwgc3RyaW5nIF9yZXN1bHQsIGJ5dGVzIF9wcm9vZikgewogICAgICAgIC8vIFN0ZXAgMTogdGhlIHByZWZpeCBoYXMgdG8gbWF0Y2ggJ0xQXHgwMScgKExlZGdlciBQcm9vZiB2ZXJzaW9uIDEpCiAgICAgICAgcmVxdWlyZSgoX3Byb29mWzBdID09ICJMIikgJiYgKF9wcm9vZlsxXSA9PSAiUCIpICYmIChfcHJvb2ZbMl0gPT0gMSkpOwoKICAgICAgICBib29sIHByb29mVmVyaWZpZWQgPSBvcmFjbGl6ZV9yYW5kb21EU19wcm9vZlZlcmlmeV9fbWFpbihfcHJvb2YsIF9xdWVyeUlkLCBieXRlcyhfcmVzdWx0KSwgb3JhY2xpemVfZ2V0TmV0d29ya05hbWUoKSk7CiAgICAgICAgcmVxdWlyZShwcm9vZlZlcmlmaWVkKTsKCiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9yYW5kb21EU19wcm9vZlZlcmlmeV9fcmV0dXJuQ29kZShieXRlczMyIF9xdWVyeUlkLCBzdHJpbmcgX3Jlc3VsdCwgYnl0ZXMgX3Byb29mKSBpbnRlcm5hbCByZXR1cm5zICh1aW50OCl7CiAgICAgICAgLy8gU3RlcCAxOiB0aGUgcHJlZml4IGhhcyB0byBtYXRjaCAnTFBceDAxJyAoTGVkZ2VyIFByb29mIHZlcnNpb24gMSkKICAgICAgICBpZiAoKF9wcm9vZlswXSAhPSAiTCIpfHwoX3Byb29mWzFdICE9ICJQIil8fChfcHJvb2ZbMl0gIT0gMSkpIHJldHVybiAxOwoKICAgICAgICBib29sIHByb29mVmVyaWZpZWQgPSBvcmFjbGl6ZV9yYW5kb21EU19wcm9vZlZlcmlmeV9fbWFpbihfcHJvb2YsIF9xdWVyeUlkLCBieXRlcyhfcmVzdWx0KSwgb3JhY2xpemVfZ2V0TmV0d29ya05hbWUoKSk7CiAgICAgICAgaWYgKHByb29mVmVyaWZpZWQgPT0gZmFsc2UpIHJldHVybiAyOwoKICAgICAgICByZXR1cm4gMDsKICAgIH0KCiAgICBmdW5jdGlvbiBtYXRjaEJ5dGVzMzJQcmVmaXgoYnl0ZXMzMiBjb250ZW50LCBieXRlcyBwcmVmaXgsIHVpbnQgbl9yYW5kb21fYnl0ZXMpIGludGVybmFsIHB1cmUgcmV0dXJucyAoYm9vbCl7CiAgICAgICAgYm9vbCBtYXRjaF8gPSB0cnVlOwogICAgICAgIAoKICAgICAgICBmb3IgKHVpbnQyNTYgaT0wOyBpPCBuX3JhbmRvbV9ieXRlczsgaSsrKSB7CiAgICAgICAgICAgIGlmIChjb250ZW50W2ldICE9IHByZWZpeFtpXSkgbWF0Y2hfID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbWF0Y2hfOwogICAgfQoKICAgIGZ1bmN0aW9uIG9yYWNsaXplX3JhbmRvbURTX3Byb29mVmVyaWZ5X19tYWluKGJ5dGVzIHByb29mLCBieXRlczMyIHF1ZXJ5SWQsIGJ5dGVzIHJlc3VsdCwgc3RyaW5nIGNvbnRleHRfbmFtZSkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCl7CgogICAgICAgIC8vIFN0ZXAgMjogdGhlIHVuaXF1ZSBrZXloYXNoIGhhcyB0byBtYXRjaCB3aXRoIHRoZSBzaGEyNTYgb2YgKGNvbnRleHQgbmFtZSArIHF1ZXJ5SWQpCiAgICAgICAgdWludCBsZWRnZXJQcm9vZkxlbmd0aCA9IDMrNjUrKHVpbnQocHJvb2ZbMys2NSsxXSkrMikrMzI7CiAgICAgICAgYnl0ZXMgbWVtb3J5IGtleWhhc2ggPSBuZXcgYnl0ZXMoMzIpOwogICAgICAgIGNvcHlCeXRlcyhwcm9vZiwgbGVkZ2VyUHJvb2ZMZW5ndGgsIDMyLCBrZXloYXNoLCAwKTsKICAgICAgICBpZiAoIShrZWNjYWsyNTYoa2V5aGFzaCkgPT0ga2VjY2FrMjU2KHNoYTI1Nihjb250ZXh0X25hbWUsIHF1ZXJ5SWQpKSkpIHJldHVybiBmYWxzZTsKCiAgICAgICAgYnl0ZXMgbWVtb3J5IHNpZzEgPSBuZXcgYnl0ZXModWludChwcm9vZltsZWRnZXJQcm9vZkxlbmd0aCsoMzIrOCsxKzMyKSsxXSkrMik7CiAgICAgICAgY29weUJ5dGVzKHByb29mLCBsZWRnZXJQcm9vZkxlbmd0aCsoMzIrOCsxKzMyKSwgc2lnMS5sZW5ndGgsIHNpZzEsIDApOwoKICAgICAgICAvLyBTdGVwIDM6IHdlIGFzc3VtZSBzaWcxIGlzIHZhbGlkIChpdCB3aWxsIGJlIHZlcmlmaWVkIGR1cmluZyBzdGVwIDUpIGFuZCB3ZSB2ZXJpZnkgaWYgJ3Jlc3VsdCcgaXMgdGhlIHByZWZpeCBvZiBzaGEyNTYoc2lnMSkKICAgICAgICBpZiAoIW1hdGNoQnl0ZXMzMlByZWZpeChzaGEyNTYoc2lnMSksIHJlc3VsdCwgdWludChwcm9vZltsZWRnZXJQcm9vZkxlbmd0aCszMis4XSkpKSByZXR1cm4gZmFsc2U7CgogICAgICAgIC8vIFN0ZXAgNDogY29tbWl0bWVudCBtYXRjaCB2ZXJpZmljYXRpb24sIGtlY2NhazI1NihkZWxheSwgbmJ5dGVzLCB1bm9uY2UsIHNlc3Npb25LZXlIYXNoKSA9PSBjb21taXRtZW50IGluIHN0b3JhZ2UuCiAgICAgICAgLy8gVGhpcyBpcyB0byB2ZXJpZnkgdGhhdCB0aGUgY29tcHV0ZWQgYXJncyBtYXRjaCB3aXRoIHRoZSBvbmVzIHNwZWNpZmllZCBpbiB0aGUgcXVlcnkuCiAgICAgICAgYnl0ZXMgbWVtb3J5IGNvbW1pdG1lbnRTbGljZTEgPSBuZXcgYnl0ZXMoOCsxKzMyKTsKICAgICAgICBjb3B5Qnl0ZXMocHJvb2YsIGxlZGdlclByb29mTGVuZ3RoKzMyLCA4KzErMzIsIGNvbW1pdG1lbnRTbGljZTEsIDApOwoKICAgICAgICBieXRlcyBtZW1vcnkgc2Vzc2lvblB1YmtleSA9IG5ldyBieXRlcyg2NCk7CiAgICAgICAgdWludCBzaWcyb2Zmc2V0ID0gbGVkZ2VyUHJvb2ZMZW5ndGgrMzIrKDgrMSszMikrc2lnMS5sZW5ndGgrNjU7CiAgICAgICAgY29weUJ5dGVzKHByb29mLCBzaWcyb2Zmc2V0LTY0LCA2NCwgc2Vzc2lvblB1YmtleSwgMCk7CgogICAgICAgIGJ5dGVzMzIgc2Vzc2lvblB1YmtleUhhc2ggPSBzaGEyNTYoc2Vzc2lvblB1YmtleSk7CiAgICAgICAgaWYgKG9yYWNsaXplX3JhbmRvbURTX2FyZ3NbcXVlcnlJZF0gPT0ga2VjY2FrMjU2KGNvbW1pdG1lbnRTbGljZTEsIHNlc3Npb25QdWJrZXlIYXNoKSl7IC8vdW5vbmNlLCBuYnl0ZXMgYW5kIHNlc3Npb25LZXlIYXNoIG1hdGNoCiAgICAgICAgICAgIGRlbGV0ZSBvcmFjbGl6ZV9yYW5kb21EU19hcmdzW3F1ZXJ5SWRdOwogICAgICAgIH0gZWxzZSByZXR1cm4gZmFsc2U7CgoKICAgICAgICAvLyBTdGVwIDU6IHZhbGlkaXR5IHZlcmlmaWNhdGlvbiBmb3Igc2lnMSAoa2V5aGFzaCBhbmQgYXJncyBzaWduZWQgd2l0aCB0aGUgc2Vzc2lvbktleSkKICAgICAgICBieXRlcyBtZW1vcnkgdG9zaWduMSA9IG5ldyBieXRlcygzMis4KzErMzIpOwogICAgICAgIGNvcHlCeXRlcyhwcm9vZiwgbGVkZ2VyUHJvb2ZMZW5ndGgsIDMyKzgrMSszMiwgdG9zaWduMSwgMCk7CiAgICAgICAgaWYgKCF2ZXJpZnlTaWcoc2hhMjU2KHRvc2lnbjEpLCBzaWcxLCBzZXNzaW9uUHVia2V5KSkgcmV0dXJuIGZhbHNlOwoKICAgICAgICAvLyB2ZXJpZnkgaWYgc2Vzc2lvblB1YmtleUhhc2ggd2FzIHZlcmlmaWVkIGFscmVhZHksIGlmIG5vdC4uIGxldCdzIGRvIGl0IQogICAgICAgIGlmIChvcmFjbGl6ZV9yYW5kb21EU19zZXNzaW9uS2V5c0hhc2hWZXJpZmllZFtzZXNzaW9uUHVia2V5SGFzaF0gPT0gZmFsc2UpewogICAgICAgICAgICBvcmFjbGl6ZV9yYW5kb21EU19zZXNzaW9uS2V5c0hhc2hWZXJpZmllZFtzZXNzaW9uUHVia2V5SGFzaF0gPSBvcmFjbGl6ZV9yYW5kb21EU19wcm9vZlZlcmlmeV9fc2Vzc2lvbktleVZhbGlkaXR5KHByb29mLCBzaWcyb2Zmc2V0KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBvcmFjbGl6ZV9yYW5kb21EU19zZXNzaW9uS2V5c0hhc2hWZXJpZmllZFtzZXNzaW9uUHVia2V5SGFzaF07CiAgICB9CgogICAgLy8gdGhlIGZvbGxvd2luZyBmdW5jdGlvbiBoYXMgYmVlbiB3cml0dGVuIGJ5IEFsZXggQmVyZWdzemFzemkgKEBheGljKSwgdXNlIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgTUlUIGxpY2Vuc2UKICAgIGZ1bmN0aW9uIGNvcHlCeXRlcyhieXRlcyBmcm9tLCB1aW50IGZyb21PZmZzZXQsIHVpbnQgbGVuZ3RoLCBieXRlcyB0bywgdWludCB0b09mZnNldCkgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChieXRlcykgewogICAgICAgIHVpbnQgbWluTGVuZ3RoID0gbGVuZ3RoICsgdG9PZmZzZXQ7CgogICAgICAgIC8vIEJ1ZmZlciB0b28gc21hbGwKICAgICAgICByZXF1aXJlKHRvLmxlbmd0aCA+PSBtaW5MZW5ndGgpOyAvLyBTaG91bGQgYmUgYSBiZXR0ZXIgd2F5PwoKICAgICAgICAvLyBOT1RFOiB0aGUgb2Zmc2V0IDMyIGlzIGFkZGVkIHRvIHNraXAgdGhlIGBzaXplYCBmaWVsZCBvZiBib3RoIGJ5dGVzIHZhcmlhYmxlcwogICAgICAgIHVpbnQgaSA9IDMyICsgZnJvbU9mZnNldDsKICAgICAgICB1aW50IGogPSAzMiArIHRvT2Zmc2V0OwoKICAgICAgICB3aGlsZSAoaSA8ICgzMiArIGZyb21PZmZzZXQgKyBsZW5ndGgpKSB7CiAgICAgICAgICAgIGFzc2VtYmx5IHsKICAgICAgICAgICAgICAgIGxldCB0bXAgOj0gbWxvYWQoYWRkKGZyb20sIGkpKQogICAgICAgICAgICAgICAgbXN0b3JlKGFkZCh0bywgaiksIHRtcCkKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDMyOwogICAgICAgICAgICBqICs9IDMyOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRvOwogICAgfQoKICAgIC8vIHRoZSBmb2xsb3dpbmcgZnVuY3Rpb24gaGFzIGJlZW4gd3JpdHRlbiBieSBBbGV4IEJlcmVnc3phc3ppIChAYXhpYyksIHVzZSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIE1JVCBsaWNlbnNlCiAgICAvLyBEdXBsaWNhdGUgU29saWRpdHkncyBlY3JlY292ZXIsIGJ1dCBjYXRjaGluZyB0aGUgQ0FMTCByZXR1cm4gdmFsdWUKICAgIGZ1bmN0aW9uIHNhZmVyX2VjcmVjb3ZlcihieXRlczMyIGhhc2gsIHVpbnQ4IHYsIGJ5dGVzMzIgciwgYnl0ZXMzMiBzKSBpbnRlcm5hbCByZXR1cm5zIChib29sLCBhZGRyZXNzKSB7CiAgICAgICAgLy8gV2UgZG8gb3VyIG93biBtZW1vcnkgbWFuYWdlbWVudCBoZXJlLiBTb2xpZGl0eSB1c2VzIG1lbW9yeSBvZmZzZXQKICAgICAgICAvLyAweDQwIHRvIHN0b3JlIHRoZSBjdXJyZW50IGVuZCBvZiBtZW1vcnkuIFdlIHdyaXRlIHBhc3QgaXQgKGFzCiAgICAgICAgLy8gd3JpdGVzIGFyZSBtZW1vcnkgZXh0ZW5zaW9ucyksIGJ1dCBkb24ndCB1cGRhdGUgdGhlIG9mZnNldCBzbwogICAgICAgIC8vIFNvbGlkaXR5IHdpbGwgcmV1c2UgaXQuIFRoZSBtZW1vcnkgdXNlZCBoZXJlIGlzIG9ubHkgbmVlZGVkIGZvcgogICAgICAgIC8vIHRoaXMgY29udGV4dC4KCiAgICAgICAgLy8gRklYTUU6IGlubGluZSBhc3NlbWJseSBjYW4ndCBhY2Nlc3MgcmV0dXJuIHZhbHVlcwogICAgICAgIGJvb2wgcmV0OwogICAgICAgIGFkZHJlc3MgYWRkcjsKCiAgICAgICAgYXNzZW1ibHkgewogICAgICAgICAgICBsZXQgc2l6ZSA6PSBtbG9hZCgweDQwKQogICAgICAgICAgICBtc3RvcmUoc2l6ZSwgaGFzaCkKICAgICAgICAgICAgbXN0b3JlKGFkZChzaXplLCAzMiksIHYpCiAgICAgICAgICAgIG1zdG9yZShhZGQoc2l6ZSwgNjQpLCByKQogICAgICAgICAgICBtc3RvcmUoYWRkKHNpemUsIDk2KSwgcykKCiAgICAgICAgICAgIC8vIE5PVEU6IHdlIGNhbiByZXVzZSB0aGUgcmVxdWVzdCBtZW1vcnkgYmVjYXVzZSB3ZSBkZWFsIHdpdGgKICAgICAgICAgICAgLy8gICAgICAgdGhlIHJldHVybiBjb2RlCiAgICAgICAgICAgIHJldCA6PSBjYWxsKDMwMDAsIDEsIDAsIHNpemUsIDEyOCwgc2l6ZSwgMzIpCiAgICAgICAgICAgIGFkZHIgOj0gbWxvYWQoc2l6ZSkKICAgICAgICB9CgogICAgICAgIHJldHVybiAocmV0LCBhZGRyKTsKICAgIH0KCiAgICAvLyB0aGUgZm9sbG93aW5nIGZ1bmN0aW9uIGhhcyBiZWVuIHdyaXR0ZW4gYnkgQWxleCBCZXJlZ3N6YXN6aSAoQGF4aWMpLCB1c2UgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBNSVQgbGljZW5zZQogICAgZnVuY3Rpb24gZWNyZWNvdmVyeShieXRlczMyIGhhc2gsIGJ5dGVzIHNpZykgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCwgYWRkcmVzcykgewogICAgICAgIGJ5dGVzMzIgcjsKICAgICAgICBieXRlczMyIHM7CiAgICAgICAgdWludDggdjsKCiAgICAgICAgaWYgKHNpZy5sZW5ndGggIT0gNjUpCiAgICAgICAgICByZXR1cm4gKGZhbHNlLCAwKTsKCiAgICAgICAgLy8gVGhlIHNpZ25hdHVyZSBmb3JtYXQgaXMgYSBjb21wYWN0IGZvcm0gb2Y6CiAgICAgICAgLy8gICB7Ynl0ZXMzMiByfXtieXRlczMyIHN9e3VpbnQ4IHZ9CiAgICAgICAgLy8gQ29tcGFjdCBtZWFucywgdWludDggaXMgbm90IHBhZGRlZCB0byAzMiBieXRlcy4KICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgIHIgOj0gbWxvYWQoYWRkKHNpZywgMzIpKQogICAgICAgICAgICBzIDo9IG1sb2FkKGFkZChzaWcsIDY0KSkKCiAgICAgICAgICAgIC8vIEhlcmUgd2UgYXJlIGxvYWRpbmcgdGhlIGxhc3QgMzIgYnl0ZXMuIFdlIGV4cGxvaXQgdGhlIGZhY3QgdGhhdAogICAgICAgICAgICAvLyAnbWxvYWQnIHdpbGwgcGFkIHdpdGggemVyb2VzIGlmIHdlIG92ZXJyZWFkLgogICAgICAgICAgICAvLyBUaGVyZSBpcyBubyAnbWxvYWQ4JyB0byBkbyB0aGlzLCBidXQgdGhhdCB3b3VsZCBiZSBuaWNlci4KICAgICAgICAgICAgdiA6PSBieXRlKDAsIG1sb2FkKGFkZChzaWcsIDk2KSkpCgogICAgICAgICAgICAvLyBBbHRlcm5hdGl2ZSBzb2x1dGlvbjoKICAgICAgICAgICAgLy8gJ2J5dGUnIGlzIG5vdCB3b3JraW5nIGR1ZSB0byB0aGUgU29saWRpdHkgcGFyc2VyLCBzbyBsZXRzCiAgICAgICAgICAgIC8vIHVzZSB0aGUgc2Vjb25kIGJlc3Qgb3B0aW9uLCAnYW5kJwogICAgICAgICAgICAvLyB2IDo9IGFuZChtbG9hZChhZGQoc2lnLCA2NSkpLCAyNTUpCiAgICAgICAgfQoKICAgICAgICAvLyBhbGJlaXQgbm9uLXRyYW5zYWN0aW9uYWwgc2lnbmF0dXJlcyBhcmUgbm90IHNwZWNpZmllZCBieSB0aGUgWVAsIG9uZSB3b3VsZCBleHBlY3QgaXQKICAgICAgICAvLyB0byBtYXRjaCB0aGUgWVAgcmFuZ2Ugb2YgWzI3LCAyOF0KICAgICAgICAvLwogICAgICAgIC8vIGdldGggdXNlcyBbMCwgMV0gYW5kIHNvbWUgY2xpZW50cyBoYXZlIGZvbGxvd2VkLiBUaGlzIG1pZ2h0IGNoYW5nZSwgc2VlOgogICAgICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vZ28tZXRoZXJldW0vaXNzdWVzLzIwNTMKICAgICAgICBpZiAodiA8IDI3KQogICAgICAgICAgdiArPSAyNzsKCiAgICAgICAgaWYgKHYgIT0gMjcgJiYgdiAhPSAyOCkKICAgICAgICAgICAgcmV0dXJuIChmYWxzZSwgMCk7CgogICAgICAgIHJldHVybiBzYWZlcl9lY3JlY292ZXIoaGFzaCwgdiwgciwgcyk7CiAgICB9Cgp9Ci8vIDwvT1JBQ0xJWkVfQVBJPgoKCi8qIApIb25lc3RTd2VlcFN0YWtlcyBjb250cmFjdCBhbGxvd3MgcGFydGljaXBhbnQgdG8gY2hvb3NlIG9uZSBjb3Vwb24gd29ydGg6CiAtIDAuMDEgRVRIOiBsZXZlbCAxCiAtIDAuMSBFVEg6IGxldmVsIDIKIC0gMSBFVEg6IGxldmVsIDMKIC0gMTAgRVRIOiBsZXZlbCA0CkZvbGxvd2luZyB0aGF0IHRoZXJlIGFyZSB2YXJpYWJsZXMgdGhhdCB1c2UgdGhpcyBkaXZpc2lvbiBpbiB0aGVpciBuYW1lcyBsaWtlOgpwYXJ0aWNpcGFudHNFVEgwMSAtIGl0J3MgYW4gYXJyYXkgaG9sZGluZyBhZGRyZXNzZXMgb2YgYWxsIHBhcnRpY2lwYW50cyB0aGF0IGhhdmUgcGF5ZWQgMC4xIEVUSCAKZm9yIHRoZWlyIGNvdXBvbi4KCkNvbnRyYWN0IGlzIHNldCB0byB3b3JrIGNvbnRpbnVvc2x5IHdpdGggdGhlIGN5Y2xlIG9mIDEwMCBwYXJ0aWNpcGFudHMsIHNvIGFmdGVyIGVhY2ggY3ljbGUgc29tZW9uZSAodXN1YWxseSBpbml0aWF0b3IpIGhhcyB0byBydW4gZnVuY3Rpb24gZ2VuZXJhdGluZyB0aGUgcmFuZG9tIG51bWJlciAoWCkgaW4gY3ljbGUncyByYW5nZSAoZm9yIGV4YW1wbGUgMCAtIDk5IG9yIDMwMCAtIDM5OSkuIApQYXJ0aWNpcGFudHMgY2FuIHN0aWxsIGpvaW4gYSBuZXcgcm91bmQgd2l0aG91dCB3YWl0aW5nIGZvciB0aGUgcHJldmlvdXMgdG8gYmUgZnVsbHkgZmluaXNoZWQgd2l0aCB0aGUgd2lubmVycywgZXRjLgpUaGlzIHJhbmRvbSBudW1iZXIgaXMgdXNlZCB0byBzZWxlY3QgYSBncm91cCBvZiBwYXJ0aWNpcGFudHMgdGhhdCB3aWxsIGdldDoKIC0gcGFydGljaXBhbnRzRVRIMVtYXTogMjUlIG9mIHRoZSBncm91cHMgcG9vbAogLSBwYXJ0aWNpcGFudHNFVEgxW1ggKyAxXSAtIHBhcnRpY2lwYW50c0VUSDFbWCArIDRdOiAxMCUgZWFjaAogLSBwYXJ0aWNpcGFudHNFVEgxW1ggKyA1XSAtIHBhcnRpY2lwYW50c0VUSDFbWCArIDhdOiA1JSBlYWNoCiAtIHBhcnRpY2lwYW50c0VUSDFbWCArIDldIC0gcGFydGljaXBhbnRzRVRIMVtYICsgMTJdOiAyLjUlIGVhY2gKQWxsdG9nZXRoZXIgOTUlLiAKIApUaGUgZmF0ZSBvZiB0aGUgcmVtYWluaW5nIDUlIHdpbGwgYmUgZGV0ZXJtaW5lZCBieSBYOgogLSBpZiBpdCdzIGV2ZW4gdGhlbiBpdCBnb2VzIHRvIHRoZSBjb250cmFjdCBpbml0aWF0b3I6IDQlCiAtIGlmIGl0J3Mgb2RkIHRoZW4gaXQgZ29lcyB0byBuZXh0IHR3byBwYXJ0aWNpcGFudHMgCiAgIChwYXJ0aWNpcGFudHNFVEgxW1ggKyAxM10gYW5kIHBhcnRpY2lwYW50c0VUSDFbWCArIDE0XSk6IDIlIGVhY2gKICAgClRoZSBsYXN0IDElIGlzIHN0b3JlZCBpbiBjb250cmFjdCBmb3IgYW55IGNvc3RzIHJlbGF0ZWQgdG8gY29udHJhY3QgcnVubmluZy4gCkhvd2V2ZXIgaGlnaGVzdCBsZXZlbHMgKDAuMSwgMSBhbmQgMTAgZXRoZXIpIGxlYXZlIG9ubHkgcGFydCBvZiB0aGlzIDElIGZvciBjb3N0cy4KCkdlbmVyYWxseSB0aGUgY29udHJhY3QgaXMgd3JpdHRlbiB0aGUgbW9zdCBob25lc3Qgd2F5IHBvc3NpYmxlOgogLSBwcmV2ZW50cyBpbml0aWF0b3IgZnJvbSB3aXRoZHJhd2luZyB0aGUgY29udHJhY3QgYmFsYW5jZSB1bmxlc3Mgc29tZSByaWdvcmlzdGljIHJlcXVpcmVtZW50cyBhcmUgbWV0CiAtIGFsbG93cyBwYXJ0aWNpcGFudHMgdG8gd2l0aGRyYXcgdGhlaXIgZnVuZHMgaW4gY2FzZSBvcmFjbGl6ZSBxdWVyeSBmYWlscwogLSBhbGxvd3MgcGFydGljaXBhbnRzIHRvIHdpdGhkcmF3IHRoZWlyIGZ1bmRzL3ByaXplcyBpbiBjYXNlIHRoZSBzd2VlcHN0YWtlIGlzIHN0b3BwZWQKIC0gYWxsb3dzIGluaXRpYXRvciB0byB3aW4gZXRoZXIsIG5vdCBqdXN0IGdldCBpdCBpbiBlYWNoIHJvdW5kCiAtIGluaXRpYXRvciBjYW4gb25seSBnZXQgaGlzIGV0aGVyIGlmIHRoZSB3aW5uZXJzIG9mIGVhY2ggcm91bmQgd2VyZSBjaG9zZW4KIC0gaW5pdGlhdG9yIGNhbiB3aXRoZHJhdyB0aGUgcmVtYWluaW5nIGNvbnRyYWN0IGJhbGFuY2UgaWYgdGhlIHJlc3Qgb2YgcGFydGljaXBhbnRzIGhhdmUgd2l0aGRyYXduIHRoZWlyIGZ1bmRzL3ByaXplcyBhbmQgdGhlcmUgYXJlIG5vIHVuZmluaW5pc2hlZCByb3VuZHMgb3Igb3JhY2xpemUgcXVlcmllcwogCiBUaGlzIHN3ZWVwc3Rha2UgaXMgbWVhbnQgZm9yIHBlb3BsZSBub3Qgb3RoZXIgY29udHJhY3RzLCBzbyBpZiB5b3UgYXJlIHBsYXlpbmcgdXNpbmcgc29tZSBjb250cmFjdCB5b3UgaGF2ZSB0byBiZSBhd2FyZSB0aGF0IHRoZXJlIG1heSBvY2N1ciBzaXR1YXRpb24gd2hlcmUgeW91IHdvbid0IHJlY2VpdmUgeW91ciBmdW5kcyAoY2hlY2sgZm9yY2VXaXRoZHJhdyBmdW5jdGlvbikuCiovCmNvbnRyYWN0IEhvbmVzdFN3ZWVwU3Rha2VzIGlzIHVzaW5nT3JhY2xpemUgewogICAgLy8gdGhpcyB3aWxsIGJlIGRlZmF1bHRlZCB0byAxMDAKICAgIHVpbnQxNiBtYXhQYXJ0aWNpcGFudHM7CiAgICAKICAgIC8vIHN0b3JlIHRoZSBudW1iZXIgb2YgdGhlIG5leHQgcGFyaWNpcGFudCBmb3IgMC4wMDEsIDAuMSwgMSBhbmQgMTAgZXRoZXIgc3Rha2VzCiAgICB1aW50MTYgbmV4dFBhcnRpY2lwYW50TnVtYmVyRVRIMDAxOwogICAgdWludDE2IG5leHRQYXJ0aWNpcGFudE51bWJlckVUSDAxOwogICAgdWludDE2IG5leHRQYXJ0aWNpcGFudE51bWJlckVUSDE7CiAgICB1aW50MTYgbmV4dFBhcnRpY2lwYW50TnVtYmVyRVRIMTA7CiAgICAKICAgIC8vIGFkZHJlc3Mgb2YgdGhlIGluaXRpYXRvciBvZiB0aGVzZSBzd2VlcHN0YWtlCiAgICBhZGRyZXNzIGluaXRpYWxpemVkQnk7CgogICAgLy8gY29udHJvbCBmbGFnIGFsbG93aW5nIGluaXRpYXRvciBzb21lIGFkZGl0aW9uYWwgc3R1ZmYgKGV4cGxhaW5lZCBmdXJ0aGVyKQogICAgYm9vbCBzd2VlcFN0YWtlU3RvcHBlZCA9IGZhbHNlOwogICAgLy8gY29udHJvbCBmbGFnIGJsb2NraW5nIHdpdGhkcmF3aW5nIG9mIHRoZSB1bnVzZWQgZXRoZXIKICAgIGJvb2wgcmVzdE9mQmFsYW5jZUxvY2tlZCA9IHRydWU7CgogICAgLy8gdGFibGVzIHN0b3JpbmcgcGFydGljaXBhbnRzIGFkZHJlc3NlcyBmb3IgMC4wMDEsIDAuMSwgMSBhbmQgMTAgZXRoZXIgc3Rha2VzCiAgICBtYXBwaW5nICh1aW50MTYgPT4gYWRkcmVzcykgcGFydGljaXBhbnRzRVRIMDAxOwogICAgbWFwcGluZyAodWludDE2ID0+IGFkZHJlc3MpIHBhcnRpY2lwYW50c0VUSDAxOwogICAgbWFwcGluZyAodWludDE2ID0+IGFkZHJlc3MpIHBhcnRpY2lwYW50c0VUSDE7CiAgICBtYXBwaW5nICh1aW50MTYgPT4gYWRkcmVzcykgcGFydGljaXBhbnRzRVRIMTA7CiAgICAKICAgIC8vIGludGVnZXJzIHN0b3JpbmcgdGhlIGN5Y2xlJ3MgbnVtYmVyIGZvciAwLjAwMSwgMC4xLCAxIGFuZCAxMCBldGhlciBzdGFrZXMKICAgIHVpbnQzMiBjeWNsZUVUSDAwMTsKICAgIHVpbnQzMiBjeWNsZUVUSDAxOwogICAgdWludDMyIGN5Y2xlRVRIMTsKICAgIHVpbnQzMiBjeWNsZUVUSDEwOwogICAgCiAgICAvLyBzdHJ1Y3QgY29udGFpbmluZyBhZGRyZXNzZXMgb2YgZWFjaCByb3VuZCBwYXJ0aWNpcGFudHMgYW5kIGxldmVsCiAgICBzdHJ1Y3QgUXVlcnlEYXRhIHsKICAgICAgICBhZGRyZXNzW10gcGFydGljaXBhbnRzOwogICAgICAgIHVpbnQ4IGxldmVsOwogICAgfQogICAgCiAgICAvLyBzdHJ1dCBjb250YWluaW5nIGluZm8gb2YgZWFjaCByb3VuZCB0aGF0IHJlcXVpcmVzIGdlbmVyYXRpbmcgcmFuZG9tICJsdWNreSIgbnVtYmVyCiAgICBzdHJ1Y3QgUm91bmREYXRhIHsKICAgICAgICB1aW50MTYgbGFzdFBhcnRpY2lwYW50OwogICAgICAgIHVpbnQ4IGxldmVsOwogICAgfQogICAgCiAgICAvLyB0aGVzZSBhcmUgc29tZSBjb250cm9sIGZsYWdzCiAgICB1aW50MjU2IHRvdGFsUHJpemVzV2FpdGluZzsKICAgIHVpbnQzMiBxdWVyaWVzQ2FsbGJhY2s7CiAgICB1aW50MTYgcm91bmRzSW5kZXg7CiAgICB1aW50MTYgcXVlcmllc1RvRGVsZXRlSW5kZXg7CiAgICAKICAgIC8vIHRhYmxlcyB1c2VkIGZvciB2YXJpb3VzIHB1cnBvc2VzCiAgICBtYXBwaW5nICh1aW50MTYgPT4gUm91bmREYXRhKSByb3VuZHM7CiAgICBtYXBwaW5nIChieXRlczMyID0+IFF1ZXJ5RGF0YSkgcXVlcmllczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHJpemVzOwogICAgbWFwcGluZyAodWludDE2ID0+IGJ5dGVzMzIpIHF1ZXJpZXNUb0RlbGV0ZTsKCiAgICAvLyBsb2dzCiAgICBldmVudCBQYXJ0aWNpcGFudEpvaW5lZCh1aW50OCBsZXZlbCwgdWludDE2IHBhcnRpY2lwYW50TnVtYmVyLCB1aW50MzIgcm91bmQsIGFkZHJlc3MgcGFydGljaXBhbnRBZGRyZXNzKTsKICAgIGV2ZW50IFJhbmRvbU51bWJlckdlbmVyYXRlZCh1aW50MjU2IHJhbmRvbU51bWJlciwgdWludDggbGV2ZWwpOyAKCiAgICBmdW5jdGlvbiBIb25lc3RTd2VlcFN0YWtlcygpIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICBpbml0aWFsaXplZEJ5ID0gbXNnLnNlbmRlcjsKICAgIAogICAgICAgIG1heFBhcnRpY2lwYW50cyA9IDEwMDsKICAgIAogICAgICAgIG5leHRQYXJ0aWNpcGFudE51bWJlckVUSDAwMSA9IDA7CiAgICAgICAgbmV4dFBhcnRpY2lwYW50TnVtYmVyRVRIMDEgPSAwOwogICAgICAgIG5leHRQYXJ0aWNpcGFudE51bWJlckVUSDEgPSAwOwogICAgICAgIG5leHRQYXJ0aWNpcGFudE51bWJlckVUSDEwID0gMDsKICAgICAgICAKICAgICAgICBjeWNsZUVUSDAwMSA9IDE7CiAgICAgICAgY3ljbGVFVEgwMSA9IDE7CiAgICAgICAgY3ljbGVFVEgxID0gMTsKICAgICAgICBjeWNsZUVUSDEwID0gMTsKICAgICAgICAKICAgICAgICB0b3RhbFByaXplc1dhaXRpbmcgPSAwOwogICAgICAgIHF1ZXJpZXNDYWxsYmFjayA9IDA7CiAgICAgICAgcm91bmRzSW5kZXggPSAwOwogICAgICAgIHF1ZXJpZXNUb0RlbGV0ZUluZGV4ID0gMDsKICAgICAgICAKICAgICAgICAvLyBvcmFjbGl6ZSBjYWxiYWNrIGdhcyBwcmljZSBpcyBzZXQgdG8gNCBnd2VpLCBzaG91bGQgYmUgcXVpdGUgb2sKICAgICAgICBvcmFjbGl6ZV9zZXRDdXN0b21HYXNQcmljZSg0MDAwMDAwMDAwKTsKICAgIH0KCiAgICAvLyBmYWxsYmFjayBmdW5jdGlvbiBhbGxvd2luZyBvbmx5IGluaXRpYXRvciB0byBzZW5kIHNvbWUgZXRoZXIgdG8gdGhlCiAgICAvLyBjb250cmFjdCBwcmV2ZW50aW5nIGFjY2lkZW50YWwgdHJhbnNmZXJzCiAgICBmdW5jdGlvbiAoKSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGluaXRpYWxpemVkQnkpOwogICAgfQoKICAgIC8vIE1haW4gZnVuY3Rpb24gd2hpY2ggaXMgdXNlZCB0byBqb2luIHRoZSBzd2VlcHN0YWtlLiBDYW4gYmUgY2FsbGVkIG11bHRpcGxlIHRpbWVzIGljcmVhc2luZyB0aGUgY2hhbmNlIGZvciB3aW5uaW5nCiAgICBmdW5jdGlvbiBqb2luKCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgLy8gUGFydGljaXBhbnQgY2FuIGpvaW4gb25seSBpZiBzd2VlcHN0YWtlIGlzIGVuYWJsZWQKICAgICAgICByZXF1aXJlKCFzd2VlcFN0YWtlU3RvcHBlZCk7CiAgICAgICAgLy8gUGFydGljaXBhbnQgY2FuIG9ubHkgc2VuZCAwLjAxLCAwLjEsIDEgb3IgMTAgZXRoZXIKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA9PSAxMCBmaW5uZXkgfHwgbXNnLnZhbHVlID09IDEwMCBmaW5uZXkgfHwgbXNnLnZhbHVlID09IDEgZXRoZXIgfHwgbXNnLnZhbHVlID09IDEwIGV0aGVyKTsKICAgIAogICAgICAgIHVpbnQxNiBwYXJ0aWNpcGFudE51bWJlciA9IDA7CiAgICAgICAgdWludDMyIHJvdW5kID0gMDsKICAgICAgICB1aW50OCBsZXZlbCA9IDA7CiAgICAgICAgdWludDE2IG1heCA9IG1heFBhcnRpY2lwYW50czsKICAgIAogICAgICAgIC8vIGVhY2ggbGV2ZWwgaGFzIGl0J3Mgb3duIGxvZ2ljCiAgICAgICAgaWYobXNnLnZhbHVlID09IDEwIGZpbm5leSkgewogICAgICAgICAgICBwYXJ0aWNpcGFudE51bWJlciA9IG5leHRQYXJ0aWNpcGFudE51bWJlckVUSDAwMTsKICAgICAgICAgICAgcm91bmQgPSAodWludDMyKHBhcnRpY2lwYW50TnVtYmVyKS9tYXhQYXJ0aWNpcGFudHMpICsgMSArICgoY3ljbGVFVEgwMDEgLSAxKSAqIDY1NSk7CiAgICAgICAgICAgIGxldmVsID0gMTsKICAgICAgICAgICAgLy8gaXQgcmVzZXRzIHRoZSBwYXJ0aWNpcGFudCBjb3VudGVyIGlmIHRoZSB1aW50MTYgdG9wIGNhcCBpcyBhbG1vc3QgcmVhY2hlZAogICAgICAgICAgICBpZihuZXh0UGFydGljaXBhbnROdW1iZXJFVEgwMDEgPCA2NTQ5OSl7CiAgICAgICAgICAgICAgICBuZXh0UGFydGljaXBhbnROdW1iZXJFVEgwMDErKzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIG5leHRQYXJ0aWNpcGFudE51bWJlckVUSDAwMSA9IDA7CiAgICAgICAgICAgICAgICBjeWNsZUVUSDAwMSsrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHBhcnRpY2lwYW50c0VUSDAwMVtwYXJ0aWNpcGFudE51bWJlcl0gPSBtc2cuc2VuZGVyOwogICAgICAgIH0gZWxzZSBpZihtc2cudmFsdWUgPT0gMTAwIGZpbm5leSkgeyAKICAgICAgICAgICAgcGFydGljaXBhbnROdW1iZXIgPSBuZXh0UGFydGljaXBhbnROdW1iZXJFVEgwMTsKICAgICAgICAgICAgcm91bmQgPSAodWludDMyKHBhcnRpY2lwYW50TnVtYmVyKS9tYXhQYXJ0aWNpcGFudHMpICsgMSArICgoY3ljbGVFVEgwMSAtIDEpICogNjU1KTsKICAgICAgICAgICAgbGV2ZWwgPSAyOwogICAgICAgICAgICBpZihuZXh0UGFydGljaXBhbnROdW1iZXJFVEgwMSA8IDY1NDk5KXsKICAgICAgICAgICAgICAgIG5leHRQYXJ0aWNpcGFudE51bWJlckVUSDAxKys7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBuZXh0UGFydGljaXBhbnROdW1iZXJFVEgwMSA9IDA7CiAgICAgICAgICAgICAgICBjeWNsZUVUSDAxKys7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcGFydGljaXBhbnRzRVRIMDFbcGFydGljaXBhbnROdW1iZXJdID0gbXNnLnNlbmRlcjsKICAgICAgICB9IGVsc2UgaWYobXNnLnZhbHVlID09IDEgZXRoZXIpIHsgCiAgICAgICAgICAgIHBhcnRpY2lwYW50TnVtYmVyID0gbmV4dFBhcnRpY2lwYW50TnVtYmVyRVRIMTsKICAgICAgICAgICAgcm91bmQgPSAodWludDMyKHBhcnRpY2lwYW50TnVtYmVyKS9tYXhQYXJ0aWNpcGFudHMpICsgMSArICgoY3ljbGVFVEgxIC0gMSkgKiA2NTUpOwogICAgICAgICAgICBsZXZlbCA9IDM7CiAgICAgICAgICAgIGlmKG5leHRQYXJ0aWNpcGFudE51bWJlckVUSDEgPCA2NTQ5OSl7CiAgICAgICAgICAgICAgICBuZXh0UGFydGljaXBhbnROdW1iZXJFVEgxKys7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBuZXh0UGFydGljaXBhbnROdW1iZXJFVEgxID0gMDsKICAgICAgICAgICAgICAgIGN5Y2xlRVRIMSsrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHBhcnRpY2lwYW50c0VUSDFbcGFydGljaXBhbnROdW1iZXJdID0gbXNnLnNlbmRlcjsKICAgICAgICB9IGVsc2UgaWYobXNnLnZhbHVlID09IDEwIGV0aGVyKSB7IAogICAgICAgICAgICBwYXJ0aWNpcGFudE51bWJlciA9IG5leHRQYXJ0aWNpcGFudE51bWJlckVUSDEwOwogICAgICAgICAgICByb3VuZCA9ICh1aW50MzIocGFydGljaXBhbnROdW1iZXIpL21heFBhcnRpY2lwYW50cykgKyAxICsgKChjeWNsZUVUSDEwIC0gMSkgKiA2NTUpOwogICAgICAgICAgICBsZXZlbCA9IDQ7CiAgICAgICAgICAgIGlmKG5leHRQYXJ0aWNpcGFudE51bWJlckVUSDEwIDwgNjU0OTkpewogICAgICAgICAgICAgICAgbmV4dFBhcnRpY2lwYW50TnVtYmVyRVRIMTArKzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIG5leHRQYXJ0aWNpcGFudE51bWJlckVUSDEwID0gMDsKICAgICAgICAgICAgICAgIGN5Y2xlRVRIMTArKzsKICAgICAgICAgICAgfQogICAgICAgICAgICBwYXJ0aWNpcGFudHNFVEgxMFtwYXJ0aWNpcGFudE51bWJlcl0gPSBtc2cuc2VuZGVyOwogICAgICAgIH0gCiAgICAgICAgCiAgICAgICAgdWludDE2IHBhcnRpY2lwYW50TnVtYmVySW5Sb3VuZCA9IChwYXJ0aWNpcGFudE51bWJlciArIDEpICUgbWF4OwogICAgICAgIGlmKHBhcnRpY2lwYW50TnVtYmVySW5Sb3VuZCA9PSAwKXsKICAgICAgICAgICAgcGFydGljaXBhbnROdW1iZXJJblJvdW5kID0gbWF4OwogICAgICAgIH0KICAgICAgICBQYXJ0aWNpcGFudEpvaW5lZChsZXZlbCwgcGFydGljaXBhbnROdW1iZXJJblJvdW5kLCByb3VuZCwgbXNnLnNlbmRlcik7CiAgICAgICAgCiAgICAgICAgLy8gd2hlbiB0aGUgbGFzdCBwYXJ0aWNpcGFudCBpbiB0aGUgcm91bmQgaGFzIGpvaW5lZCB0aGUgcm91bmQgaXMgcmVhZHkgdG8gcmFuZG9tIG51bWJlciBnZW5lcmF0ZWQKICAgICAgICBpZihwYXJ0aWNpcGFudE51bWJlckluUm91bmQgPT0gbWF4KXsKICAgICAgICAgICAgcXVlcmllc0NhbGxiYWNrKys7CiAgICAgICAgICAgIHJlc3RPZkJhbGFuY2VMb2NrZWQgPSBmYWxzZTsKICAgICAgICAgICAgcm91bmRzW3JvdW5kc0luZGV4KytdID0gUm91bmREYXRhKHBhcnRpY2lwYW50TnVtYmVyLCBsZXZlbCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVzdE9mQmFsYW5jZUxvY2tlZCA9IHRydWU7CiAgICAgICAgfQogICAgfQogIAogIAogICAgLy8gVGhpcyBmdW5jdGlvbiBwcmVwYXJlcyB0aGUgcm91bmQgcGFydGljaXBhbnRzIGZvciB0aGUgcmFuZG9tIG51bWJlciBnZW5lcmF0aW9uCiAgICAvLyBJdCBjYW4gYmUgY2FsbGVkIGJ5IGFueWJvZHkgaW4gY2FzZSBpbml0aWF0b3Igd291bGQgYmUgdW5hdmFpbGFibGUKICAgIGZ1bmN0aW9uIHJ1blN3ZWVwU3Rha2UoKSBleHRlcm5hbCBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKHJvdW5kc0luZGV4ID4gMCk7CiAgICAgICAgUm91bmREYXRhIG1lbW9yeSByZCA9IHJvdW5kc1stLXJvdW5kc0luZGV4XTsKICAgICAgICB1aW50MTYgX3BhcnRpY2lwYW50TnVtYmVyID0gcmQubGFzdFBhcnRpY2lwYW50OwogICAgICAgIHVpbnQ4IF9sZXZlbCA9IHJkLmxldmVsOwogICAgICAgIAogICAgICAgIHVpbnQxNiBfbWluUmFuZ2UgPSBfcGFydGljaXBhbnROdW1iZXIgLSAobWF4UGFydGljaXBhbnRzIC0gMSk7CiAgICAgICAgdWludDE2IF9tYXhSYW5nZSA9IF9wYXJ0aWNpcGFudE51bWJlcjsKICAgICAgICAKICAgICAgICBhZGRyZXNzW10gbWVtb3J5IHF1ZXJ5UGFydGljaXBhbnRzID0gbmV3IGFkZHJlc3NbXSgxMDApOwogICAgICAgIHVpbnQ4IGsgPSAwOwogICAgICAgIHVpbnQxNiBpID0gMDsKICAgICAgICAKICAgICAgICBpZihfbGV2ZWwgPT0gMSl7CiAgICAgICAgICAgIGZvcihpID0gX21pblJhbmdlOyBpIDw9IF9tYXhSYW5nZTsgaSsrKXsKICAgICAgICAgICAgICAgIHF1ZXJ5UGFydGljaXBhbnRzW2tdID0gcGFydGljaXBhbnRzRVRIMDAxW2ldOwogICAgICAgICAgICAgICAgaysrOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmKF9sZXZlbCA9PSAyKXsKICAgICAgICAgICAgZm9yKGkgPSBfbWluUmFuZ2U7IGkgPD0gX21heFJhbmdlOyBpKyspewogICAgICAgICAgICAgICAgcXVlcnlQYXJ0aWNpcGFudHNba10gPSBwYXJ0aWNpcGFudHNFVEgwMVtpXTsKICAgICAgICAgICAgICAgIGsrKzsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZihfbGV2ZWwgPT0gMyl7CiAgICAgICAgICAgIGZvcihpID0gX21pblJhbmdlOyBpIDw9IF9tYXhSYW5nZTsgaSsrKXsKICAgICAgICAgICAgICAgIHF1ZXJ5UGFydGljaXBhbnRzW2tdID0gcGFydGljaXBhbnRzRVRIMVtpXTsKICAgICAgICAgICAgICAgIGsrKzsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZihfbGV2ZWwgPT0gNCl7CiAgICAgICAgICAgIGZvcihpID0gX21pblJhbmdlOyBpIDw9IF9tYXhSYW5nZTsgaSsrKXsKICAgICAgICAgICAgICAgIHF1ZXJ5UGFydGljaXBhbnRzW2tdID0gcGFydGljaXBhbnRzRVRIMTBbaV07CiAgICAgICAgICAgICAgICBrKys7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgZGVsZXRlIHJvdW5kc1tyb3VuZHNJbmRleF07CiAgICAgICAgCiAgICAgICAgb3JhY2xpemVfc2V0UHJvb2YocHJvb2ZUeXBlX0xlZGdlcik7IAogICAgICAgIHVpbnQgTiA9IDQ7CiAgICAgICAgdWludCBkZWxheSA9IDA7CiAgICAgICAgdWludCBjYWxsYmFja0dhcyA9IDc1MDAwMDsKICAgICAgICAvLyBRdWVyeSB0byBvcmFjbGl6ZSByZXF1ZXN0aW5nIHJhbmRvbSBudW1iZXIKICAgICAgICBieXRlczMyIHF1ZXJ5SWQgPSBvcmFjbGl6ZV9uZXdSYW5kb21EU1F1ZXJ5KGRlbGF5LCBOLCBjYWxsYmFja0dhcyk7IAogICAgICAgIAogICAgICAgIC8vIFF1ZXJ5IGlzIHNhdmVkIHdpdGggcm91bmQncyBwYXJ0aWNpcGFudHMKICAgICAgICBxdWVyaWVzW3F1ZXJ5SWRdID0gUXVlcnlEYXRhKHF1ZXJ5UGFydGljaXBhbnRzLCBfbGV2ZWwpOwogICAgICAgIAogICAgICAgIC8vIFRoZXNlIGlzIGRlbGV0aW5nIHRoZSBsYXN0IHByb2Nlc3NlZCBxdWVyeS4gQWxsb3dzIHRvIG1pbmltYXplIHRoZSBjb3N0IG9mIHRoZSB3aG9sZSBmdW5jdGlvbiB0aGFua3MgdG8gZ2FzIHJlZnVuZAogICAgICAgIGlmKHF1ZXJpZXNUb0RlbGV0ZUluZGV4ID4gMCl7CiAgICAgICAgICAgIGRlbGV0ZSBxdWVyaWVzW3F1ZXJpZXNUb0RlbGV0ZVstLXF1ZXJpZXNUb0RlbGV0ZUluZGV4XV07CiAgICAgICAgICAgIGRlbGV0ZSBxdWVyaWVzVG9EZWxldGVbcXVlcmllc1RvRGVsZXRlSW5kZXhdOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBfX2NhbGxiYWNrKGJ5dGVzMzIgX3F1ZXJ5SWQsIHN0cmluZyBfcmVzdWx0LCBieXRlcyBfcHJvb2YpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG9yYWNsaXplX2NiQWRkcmVzcygpIHx8IG1zZy5zZW5kZXIgPT0gaW5pdGlhbGl6ZWRCeSk7CiAgICAgICAgCiAgICAgICAgLy8gaWYgdGhlIHByb29mIHZlcmlmaWNhdGlvbiBmYWlscyBvciB0aGUgaW5pdGlhdG9yIHdpbGwgZm9yY2UgdGhlIGNhbGxiYWNrIGV4ZWN1dGlvbiAoaW4gY2FzZSBvZiBvcmFjbGl6ZSBub3QgY2FsbGluZyBiYWNrKQogICAgICAgIGlmIChvcmFjbGl6ZV9yYW5kb21EU19wcm9vZlZlcmlmeV9fcmV0dXJuQ29kZShfcXVlcnlJZCwgX3Jlc3VsdCwgX3Byb29mKSAhPSAwIHx8IG1zZy5zZW5kZXIgPT0gaW5pdGlhbGl6ZWRCeSkgewogICAgICAgICAgICBmYWlsZWRRdWVyeShfcXVlcnlJZCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdWludDggbWF4UmFuZ2UgPSA5OTsKICAgICAgICAgICAgdWludCByYW5kb21OdW1iZXIgPSB1aW50KGtlY2NhazI1NihfcmVzdWx0KSkgJSBtYXhSYW5nZTsgCiAgICAKICAgICAgICAgICAgY2hvb3NlV2lubmVycyh1aW50OChyYW5kb21OdW1iZXIpLCBfcXVlcnlJZCk7CiAgICAgICAgfQogICAgfQogICAgCiAgICAvLyBUaGlzIGZ1bmN0aW9uIGlzIGNob29zaW5nIHRoZSB3aW5uZXJzIGJhc2VkIG9uIHRoZSByYW5kb20gbnVtYmVyIHNlbnQgYnkgb3JhY2xpemUKICAgIGZ1bmN0aW9uIGNob29zZVdpbm5lcnModWludDggX3JhbmRvbU51bWJlciwgYnl0ZXMzMiBfcXVlcnlJZCkgcHJpdmF0ZSB7CiAgICAgICAgUXVlcnlEYXRhIG1lbW9yeSBxZCA9IHF1ZXJpZXNbX3F1ZXJ5SWRdOwogICAgICAgIHVpbnQgcHJpemU7CiAgICAgICAgdWludCB0b3RhbFByaXplcyA9IDA7CiAgICAgICAgdWludDE2IG1heCA9IG1heFBhcnRpY2lwYW50cyAtIDE7CiAgICAgICAgCiAgICAgICAgUmFuZG9tTnVtYmVyR2VuZXJhdGVkKF9yYW5kb21OdW1iZXIsIHFkLmxldmVsKTsKICAgICAgICAKICAgICAgICB1aW50MTYgbGV2ZWxNdWx0aXBsaWVyOwogICAgICAgIHVpbnQgcmVzZXJ2ZTsKICAgICAgICBpZihxZC5sZXZlbCA9PSAxKXsKICAgICAgICAgICAgbGV2ZWxNdWx0aXBsaWVyID0gMTsKICAgICAgICAgICAgcmVzZXJ2ZSA9IDA7CiAgICAgICAgfSBlbHNlIGlmKHFkLmxldmVsID09IDIpewogICAgICAgICAgICBsZXZlbE11bHRpcGxpZXIgPSAxMDsKICAgICAgICAgICAgcmVzZXJ2ZSA9IDIwIGZpbm5leTsKICAgICAgICB9IGVsc2UgaWYocWQubGV2ZWwgPT0gMyl7CiAgICAgICAgICAgIGxldmVsTXVsdGlwbGllciA9IDEwMDsKICAgICAgICAgICAgcmVzZXJ2ZSA9IDkwMCBmaW5uZXk7CiAgICAgICAgfSBlbHNlIGlmKHFkLmxldmVsID09IDQpewogICAgICAgICAgICBsZXZlbE11bHRpcGxpZXIgPSAxMDAwOwogICAgICAgICAgICByZXNlcnZlID0gOTkwMCBmaW5uZXk7CiAgICAgICAgfSAKICAgICAgICAKICAgICAgICB1aW50OCBrID0gMTQ7CiAgICAgICAgLy8gaW5pdGlhdG9yIGdldHMgZXRoZXIgb25seSBpZiB0aGUgcmFuZG9tIG51bWJlciBpcyBldmVuCiAgICAgICAgaWYoX3JhbmRvbU51bWJlciAlIDIgPT0gMCl7CiAgICAgICAgICAgIGsgPSAxMjsKICAgICAgICAgICAgcHJpemUgPSBsZXZlbE11bHRpcGxpZXIgKiAoNDAgZmlubmV5KTsKICAgICAgICAgICAgcHJpemVzW2luaXRpYWxpemVkQnldICs9IHByaXplICsgcmVzZXJ2ZTsgCiAgICAgICAgICAgIHRvdGFsUHJpemVzICs9IHByaXplOwogICAgICAgIH0KICAgIAogICAgICAgIC8vIHRoZSBtYWluIHdpbm5lcgogICAgICAgIHByaXplID0gbGV2ZWxNdWx0aXBsaWVyICogKDI1MCBmaW5uZXkpOwogICAgICAgIHByaXplc1txZC5wYXJ0aWNpcGFudHNbX3JhbmRvbU51bWJlcl1dICs9IHByaXplOwogICAgICAgIHRvdGFsUHJpemVzICs9IHByaXplOwogICAgICAgIAogICAgICAgIHVpbnQ4IGwgPSBfcmFuZG9tTnVtYmVyICsgMTsKICAgICAgICAvLyBhbmQgdGhlIHJlc3Qgb2YgdGhlIHdpbm5lcnMKICAgICAgICAvLyB0aGVyZSBpcyAxMi8xNCBvZiB0aGVtIGFuZCBpZiBjb3VudGVyIHJlYWNoIG51bWJlciA5OSB0aGVuIG5leHQgb25lIGlzIDAKICAgICAgICBmb3IodWludDggaSA9IDE7IGkgPD0gazsgaSsrKXsKICAgICAgICAgICAgaWYobCA9PSBtYXgpewogICAgICAgICAgICAgICAgbCA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoaSA8PSA0KXsKICAgICAgICAgICAgICAgIHByaXplID0gbGV2ZWxNdWx0aXBsaWVyICogKDEwMCBmaW5uZXkpOwogICAgICAgICAgICAgICAgcHJpemVzW3FkLnBhcnRpY2lwYW50c1tsXV0gKz0gcHJpemU7CiAgICAgICAgICAgIH0gZWxzZSBpZihpID4gNCAmJiBpIDw9IDgpewogICAgICAgICAgICAgICAgcHJpemUgPSBsZXZlbE11bHRpcGxpZXIgKiAoNTAgZmlubmV5KTsKICAgICAgICAgICAgICAgIHByaXplc1txZC5wYXJ0aWNpcGFudHNbbF1dICs9IHByaXplOwogICAgICAgICAgICB9IGVsc2UgaWYoaSA+IDggJiYgaSA8PSAxMil7CiAgICAgICAgICAgICAgICBwcml6ZSA9IGxldmVsTXVsdGlwbGllciAqICgyNSBmaW5uZXkpOwogICAgICAgICAgICAgICAgcHJpemVzW3FkLnBhcnRpY2lwYW50c1tsXV0gKz0gcHJpemU7CiAgICAgICAgICAgIH0gZWxzZSBpZihpID4gMTIgJiYgaSA8PSAxNCl7CiAgICAgICAgICAgICAgICBwcml6ZSA9IGxldmVsTXVsdGlwbGllciAqICgyMCBmaW5uZXkpOwogICAgICAgICAgICAgICAgcHJpemVzW3FkLnBhcnRpY2lwYW50c1tsXV0gKz0gcHJpemUgKyAocmVzZXJ2ZS8yKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0b3RhbFByaXplcyArPSBwcml6ZTsKICAgICAgICAgICAgbCsrOwogICAgICAgIH0KICAgICAgICAKICAgICAgICB0b3RhbFByaXplc1dhaXRpbmcgKz0gdG90YWxQcml6ZXM7CiAgICAgICAgLy8gcXVlcnkgd2FzIHByb2Nlc3NlZAogICAgICAgIHF1ZXJpZXNDYWxsYmFjay0tOwogICAgICAgIC8vIGFuZCBpcyBwcmVwYXJlZCB0byBkZWxldGUKICAgICAgICBxdWVyaWVzVG9EZWxldGVbcXVlcmllc1RvRGVsZXRlSW5kZXgrK10gPSBfcXVlcnlJZDsKICAgIH0KICAgIAogICAgLy8gVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgd2hlbiB0aGUgcXVlcnkgaGFzIGZhaWxlZCBvciBjb250cmFjdCBpbml0aWF0b3IgaGFkIHRvIGRvIG1hbnVhbCBjYWxsYmFjawogICAgLy8gaW5zdGVhZCBvZiBvcmFjbGl6ZQogICAgZnVuY3Rpb24gZmFpbGVkUXVlcnkoYnl0ZXMzMiBfcXVlcnlJZCkgcHJpdmF0ZSB7CiAgICAgICAgUXVlcnlEYXRhIG1lbW9yeSBxZCA9IHF1ZXJpZXNbX3F1ZXJ5SWRdOwogICAgICAgIAogICAgICAgIHVpbnQxNiBtYXggPSBtYXhQYXJ0aWNpcGFudHM7CiAgICAgICAgdWludCBhbW91bnQ7CiAgICAgICAgdWludCB0b3RhbFByaXplcyA9IDA7CiAgICAgICAgCiAgICAgICAgaWYocWQubGV2ZWwgPT0gMSl7CiAgICAgICAgICAgIGFtb3VudCA9ICgxMCBmaW5uZXkpOwogICAgICAgIH0gZWxzZSBpZihxZC5sZXZlbCA9PSAyKXsKICAgICAgICAgICAgYW1vdW50ID0gKDEwMCBmaW5uZXkpOwogICAgICAgIH0gZWxzZSBpZihxZC5sZXZlbCA9PSAzKXsKICAgICAgICAgICAgYW1vdW50ID0gKDEgZXRoZXIpOwogICAgICAgIH0gZWxzZSBpZihxZC5sZXZlbCA9PSA0KXsKICAgICAgICAgICAgYW1vdW50ID0gKDEwIGV0aGVyKTsKICAgICAgICB9IAogICAgICAgIAogICAgICAgIC8vIGVhY2ggb2YgdGhlIHJvdW5kIHBhcnRpY2lwYW50cyBpcyByZXdhcmRlZCB3aXRoIHRoZSBzYW1lIGFtb3VudCBoZS9zaGUgaGFzIHBheWVkCiAgICAgICAgZm9yKHVpbnQ4IGkgPSAwOyBpIDwgbWF4OyBpKyspewogICAgICAgICAgICBwcml6ZXNbcWQucGFydGljaXBhbnRzW2ldXSArPSBhbW91bnQ7CiAgICAgICAgICAgIHRvdGFsUHJpemVzICs9IGFtb3VudDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgdG90YWxQcml6ZXNXYWl0aW5nICs9IHRvdGFsUHJpemVzOwogICAgICAgIHF1ZXJpZXNDYWxsYmFjay0tOwogICAgICAgIHF1ZXJpZXNUb0RlbGV0ZVtxdWVyaWVzVG9EZWxldGVJbmRleCsrXSA9IF9xdWVyeUlkOwogICAgfQogICAgCiAgICAvLyBXaW5uZXJzIG9yIHBhcnRpY2lwYW50cyBmcm9tIGZhaWxlZCBxdWVyaWVzIGNhbiB3aXRoZHJhdyB0aGVpciBwcml6ZSBieSBjYWxsaW5nIHRoaXMgZnVuY3Rpb24KICAgIGZ1bmN0aW9uIHByaXplV2l0aGRyYXdhbCgpIGV4dGVybmFsIHsKICAgICAgICB1aW50IGFtb3VudCA9IHByaXplc1ttc2cuc2VuZGVyXTsKICAgICAgICBwcml6ZXNbbXNnLnNlbmRlcl0gPSAwOwogICAgICAgIGlmIChhbW91bnQgPiAwKSB7CiAgICAgICAgICAgIGlmIChtc2cuc2VuZGVyLnNlbmQoYW1vdW50KSkgewogICAgICAgICAgICAgICAgdG90YWxQcml6ZXNXYWl0aW5nIC09IGFtb3VudDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHByaXplc1ttc2cuc2VuZGVyXSA9IGFtb3VudDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIAogICAgLy8gRXZlcnlib2R5IGNhbiBjaGVjayBpZiB0aGVyZSBpcyBzb21lIHByaXplIHdhaXRpbmcgZm9yIHRoZW0KICAgIGZ1bmN0aW9uIGNoZWNrUHJpemUoKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYgcHJpemUpewogICAgICAgIHByaXplID0gcHJpemVzW21zZy5zZW5kZXJdOwogICAgICAgIHJldHVybiBwcml6ZTsKICAgIH0KICAgIAogICAgLy8gaXQncyBmb3IgbWFpbnRlbmFuY2UgcHVycG9zZXMgYWxsb3dpbmcgaW5pdGlhdG9yIHRvIGNoZWNrIGlmIHRoZXJlIGFyZSBzb21lIG5vdCBwcm9jZXNzZWQgcXVlcmllcwogICAgZnVuY3Rpb24gY2hlY2tPdXRzdGFuZGluZ1F1ZXJpZXMoKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYgbnVtT2ZRdWVyaWVzKXsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gaW5pdGlhbGl6ZWRCeSk7CiAgICAgICAgCiAgICAgICAgbnVtT2ZRdWVyaWVzID0gcXVlcmllc0NhbGxiYWNrOwogICAgICAgIHJldHVybiBudW1PZlF1ZXJpZXM7CiAgICB9CiAgICAKICAgIC8vIGl0J3MgZm9yIG1haW50ZW5hbmNlIHB1cnBvc2VzIGFsbG93aW5nIGluaXRpYXRvciB0byBjaGVjayBpZiBhbGwgdGhlIHByaXplcyBoYXZlIGJlZW4gd2l0aGRyYXduZWQuIAogICAgZnVuY3Rpb24gY2hlY2tUb3RhbFByaXplc1dhaXRpbmcoKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYgdG90YWwpewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBpbml0aWFsaXplZEJ5KTsKICAgICAgICAKICAgICAgICB0b3RhbCA9IHRvdGFsUHJpemVzV2FpdGluZzsKICAgICAgICByZXR1cm4gdG90YWw7CiAgICB9CiAgICAKICAgIC8vIGluaXRpYXRvciBjYW4gd2l0aGRyYXcgdGhlIHJlbWFpbmluZyBiYWxhbmNlIG9ubHkgaWY6CiAgICBmdW5jdGlvbiB3aXRoZHJhd1Jlc3RPZkJhbGFuY2UoKSBleHRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGluaXRpYWxpemVkQnkpOwogICAgICAgIC8vIDEuIHN3ZWVwc3Rha2UgaXMgc3RvcHBwZWQKICAgICAgICByZXF1aXJlKHN3ZWVwU3Rha2VTdG9wcGVkKTsKICAgICAgICB1aW50IGFtb3VudCA9IHRoaXMuYmFsYW5jZTsKICAgICAgICAvLyAyLiBldmVyeWJvZHkgaGF2ZSB0byB3aXRoZHJhdyB0aGVpciBwcml6ZXMKICAgICAgICAvLyAzLiB0aGVyZSBhcmUgbm8gb3V0c3RhbmRpbmcgcXVlcmllcyB0byBvcmFjbGl6ZQogICAgICAgIC8vIDQuIGNvbnRyYWN0IGJhbGFuY2UgaXMgdW5sb2NrZWQKICAgICAgICBpZih0b3RhbFByaXplc1dhaXRpbmcgPT0gMCAmJiBxdWVyaWVzQ2FsbGJhY2sgPT0gMCAmJiAhcmVzdE9mQmFsYW5jZUxvY2tlZCl7CiAgICAgICAgICAgIGluaXRpYWxpemVkQnkudHJhbnNmZXIoYW1vdW50KTsKICAgICAgICB9CiAgICB9ICAgIAogICAgCiAgICAvLyBJbml0aWF0b3IgY2FuIHN0b3AgdGhlIHN3ZWVwc3Rha2UgYW5kIHRoaXMgd2lsbCByb2xsYmFjayBhbGwgbm90IGZ1bGxmaWxsZWQgcm91bmRzLiBQYXJ0aWNpcGFudHMgY2FuIHRoZW4gd2l0aGRyYXcgdGhlaXIgZnVuZHMKICAgIGZ1bmN0aW9uIHN0b3BTd2VlcFN0YWtlKCkgZXh0ZXJuYWwgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBpbml0aWFsaXplZEJ5KTsKICAgICAgICBzd2VlcFN0YWtlU3RvcHBlZCA9IHRydWU7CiAgICAgICAgCiAgICAgICAgdWludDE2IGxhc3RQYXJ0aWNpcGFudE51bWJlckluUm91bmQ7CiAgICAgICAgdWludDE2IGZpcnN0UGFydGljaXBhbnROdW1iZXJJblJvdW5kOwogICAgICAgIHVpbnQgYW1vdW50OwogICAgICAgIGFkZHJlc3MgcGFydGljaXBhbnRBZGRyZXNzOwogICAgICAgIHVpbnQxNiBpOwogICAgICAgIHVpbnQxNiBtaW47CiAgICAgICAgdWludDE2IG1heDsKICAgICAgICB1aW50IHRvdGFsUHJpemVzID0gMDsKICAgICAgICAKICAgICAgICBsYXN0UGFydGljaXBhbnROdW1iZXJJblJvdW5kID0gbmV4dFBhcnRpY2lwYW50TnVtYmVyRVRIMDAxICUgbWF4UGFydGljaXBhbnRzOwogICAgICAgIGlmKGxhc3RQYXJ0aWNpcGFudE51bWJlckluUm91bmQgPiAwKXsKICAgICAgICAgICAgYW1vdW50ID0gMTAgZmlubmV5OwogICAgICAgICAgICBmaXJzdFBhcnRpY2lwYW50TnVtYmVySW5Sb3VuZCA9IGxhc3RQYXJ0aWNpcGFudE51bWJlckluUm91bmQgLSAobGFzdFBhcnRpY2lwYW50TnVtYmVySW5Sb3VuZCAtIDEpOwogICAgICAgICAgICBtYXggPSBsYXN0UGFydGljaXBhbnROdW1iZXJJblJvdW5kIC0gMTsKICAgICAgICAgICAgbWluID0gZmlyc3RQYXJ0aWNpcGFudE51bWJlckluUm91bmQgLSAxOwogICAgICAgICAgICBmb3IoaSA9IG1heDsgaSA+PSBtaW47IGktLSl7CiAgICAgICAgICAgICAgICBwYXJ0aWNpcGFudEFkZHJlc3MgPSBwYXJ0aWNpcGFudHNFVEgwMDFbaV07CiAgICAgICAgICAgICAgICBwcml6ZXNbcGFydGljaXBhbnRBZGRyZXNzXSArPSBhbW91bnQ7CiAgICAgICAgICAgICAgICB0b3RhbFByaXplcyArPSBhbW91bnQ7CiAgICAgICAgICAgICAgICBpZihpID09IDApeyBicmVhazt9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbmV4dFBhcnRpY2lwYW50TnVtYmVyRVRIMDAxID0gbWluOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBsYXN0UGFydGljaXBhbnROdW1iZXJJblJvdW5kID0gbmV4dFBhcnRpY2lwYW50TnVtYmVyRVRIMDEgJSBtYXhQYXJ0aWNpcGFudHM7CiAgICAgICAgaWYobGFzdFBhcnRpY2lwYW50TnVtYmVySW5Sb3VuZCA+IDApewogICAgICAgICAgICBhbW91bnQgPSAxMDAgZmlubmV5OwogICAgICAgICAgICBmaXJzdFBhcnRpY2lwYW50TnVtYmVySW5Sb3VuZCA9IGxhc3RQYXJ0aWNpcGFudE51bWJlckluUm91bmQgLSAobGFzdFBhcnRpY2lwYW50TnVtYmVySW5Sb3VuZCAtIDEpOwogICAgICAgICAgICBtYXggPSBsYXN0UGFydGljaXBhbnROdW1iZXJJblJvdW5kIC0gMTsKICAgICAgICAgICAgbWluID0gZmlyc3RQYXJ0aWNpcGFudE51bWJlckluUm91bmQgLSAxOwogICAgICAgICAgICBmb3IoaSA9IG1heDsgaSA+PSBtaW47IGktLSl7CiAgICAgICAgICAgICAgICBwYXJ0aWNpcGFudEFkZHJlc3MgPSBwYXJ0aWNpcGFudHNFVEgwMVtpXTsKICAgICAgICAgICAgICAgIHByaXplc1twYXJ0aWNpcGFudEFkZHJlc3NdICs9IGFtb3VudDsKICAgICAgICAgICAgICAgIHRvdGFsUHJpemVzICs9IGFtb3VudDsKICAgICAgICAgICAgICAgIGlmKGkgPT0gMCl7IGJyZWFrO30KICAgICAgICAgICAgfQogICAgICAgICAgICBuZXh0UGFydGljaXBhbnROdW1iZXJFVEgwMSA9IG1pbjsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgbGFzdFBhcnRpY2lwYW50TnVtYmVySW5Sb3VuZCA9IG5leHRQYXJ0aWNpcGFudE51bWJlckVUSDEgJSBtYXhQYXJ0aWNpcGFudHM7CiAgICAgICAgaWYobGFzdFBhcnRpY2lwYW50TnVtYmVySW5Sb3VuZCA+IDApewogICAgICAgICAgICBhbW91bnQgPSAxIGV0aGVyOwogICAgICAgICAgICBmaXJzdFBhcnRpY2lwYW50TnVtYmVySW5Sb3VuZCA9IGxhc3RQYXJ0aWNpcGFudE51bWJlckluUm91bmQgLSAobGFzdFBhcnRpY2lwYW50TnVtYmVySW5Sb3VuZCAtIDEpOwogICAgICAgICAgICBtYXggPSBsYXN0UGFydGljaXBhbnROdW1iZXJJblJvdW5kIC0gMTsKICAgICAgICAgICAgbWluID0gZmlyc3RQYXJ0aWNpcGFudE51bWJlckluUm91bmQgLSAxOwogICAgICAgICAgICBmb3IoaSA9IG1heDsgaSA+PSBtaW47IGktLSl7CiAgICAgICAgICAgICAgICBwYXJ0aWNpcGFudEFkZHJlc3MgPSBwYXJ0aWNpcGFudHNFVEgxW2ldOwogICAgICAgICAgICAgICAgcHJpemVzW3BhcnRpY2lwYW50QWRkcmVzc10gKz0gYW1vdW50OwogICAgICAgICAgICAgICAgdG90YWxQcml6ZXMgKz0gYW1vdW50OwogICAgICAgICAgICAgICAgaWYoaSA9PSAwKXsgYnJlYWs7fQogICAgICAgICAgICB9CiAgICAgICAgICAgIG5leHRQYXJ0aWNpcGFudE51bWJlckVUSDEgPSBtaW47CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGxhc3RQYXJ0aWNpcGFudE51bWJlckluUm91bmQgPSBuZXh0UGFydGljaXBhbnROdW1iZXJFVEgxMCAlIG1heFBhcnRpY2lwYW50czsKICAgICAgICBpZihsYXN0UGFydGljaXBhbnROdW1iZXJJblJvdW5kID4gMCl7CiAgICAgICAgICAgIGFtb3VudCA9IDEwIGV0aGVyOwogICAgICAgICAgICBmaXJzdFBhcnRpY2lwYW50TnVtYmVySW5Sb3VuZCA9IGxhc3RQYXJ0aWNpcGFudE51bWJlckluUm91bmQgLSAobGFzdFBhcnRpY2lwYW50TnVtYmVySW5Sb3VuZCAtIDEpOwogICAgICAgICAgICBtYXggPSBsYXN0UGFydGljaXBhbnROdW1iZXJJblJvdW5kIC0gMTsKICAgICAgICAgICAgbWluID0gZmlyc3RQYXJ0aWNpcGFudE51bWJlckluUm91bmQgLSAxOwogICAgICAgICAgICBmb3IoaSA9IG1heDsgaSA+PSBtaW47IGktLSl7CiAgICAgICAgICAgICAgICBwYXJ0aWNpcGFudEFkZHJlc3MgPSBwYXJ0aWNpcGFudHNFVEgxMFtpXTsKICAgICAgICAgICAgICAgIHByaXplc1twYXJ0aWNpcGFudEFkZHJlc3NdICs9IGFtb3VudDsKICAgICAgICAgICAgICAgIHRvdGFsUHJpemVzICs9IGFtb3VudDsKICAgICAgICAgICAgICAgIGlmKGkgPT0gMCl7IGJyZWFrO30KICAgICAgICAgICAgfQogICAgICAgICAgICBuZXh0UGFydGljaXBhbnROdW1iZXJFVEgxMCA9IG1pbjsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgdG90YWxQcml6ZXNXYWl0aW5nICs9IHRvdGFsUHJpemVzOwogICAgICAgIHJlc3RPZkJhbGFuY2VMb2NrZWQgPSBmYWxzZTsKICAgIH0KICAgIAogICAgLy8gQWxsb3dzIGluaXRpYXRvciB0byBzZW5kIGZ1bmRzIHRvIHRoZSB3aW5uZXJzIHdoaWNoIGRpZCBub3QgZG8gdGhlc2UgYnkgdGhlbXNlbHZlcwogICAgLy8gSXQgd291bGQgYmUgdXNlZCBvbmx5IGluIHRoZSBjYXNlIHdoZW4gc29tZSBwcml6ZSBpcyB3YWl0aW5nIGEgbG9uZyB0aW1lIHByZXZlbnRpbmcgaW5pdGlhdG9yIGZyb20gd2l0aGRyYXdpbmcgdGhlIHJlbWFpbmluZyBiYWxhbmNlLgogICAgZnVuY3Rpb24gZm9yY2VXaXRoZHJhdyhhZGRyZXNzIF9yZWNlaXZlcikgZXh0ZXJuYWwgewogICAgICAgIC8vIGluaXRpYXRvciBtdXN0IHNlbmQgMTAwIDAwMCBnYXMsIHdoaWNoIHdpbGwgYmUgZW5vdWdoIHRvIHNlbmQgdGhlIGZ1bmRzIHRvIGFsbCBub3JtYWwgYWRkcmVzc2VzCiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGluaXRpYWxpemVkQnkgJiYgbXNnLmdhcyA+PSAxMDAwMDApOwogICAgICAgIHJlcXVpcmUoc3dlZXBTdGFrZVN0b3BwZWQpOwogICAgICAgIAogICAgICAgIHVpbnQgYW1vdW50ID0gcHJpemVzW19yZWNlaXZlcl07CiAgICAgICAgcHJpemVzW19yZWNlaXZlcl0gPSAwOwogICAgICAgIGlmKGFtb3VudCA+IDApIHsKICAgICAgICAgICAgdG90YWxQcml6ZXNXYWl0aW5nIC09IGFtb3VudDsKICAgICAgICAgICAgaWYoX3JlY2VpdmVyLnNlbmQoYW1vdW50KSkgewogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIHRoZXJlIGlzIG5vIGVsc2UgYmVjYXVzZSBpZiB0aGUgc2VuZCBmYWlsIHRoZSBpdCB3b3VsZCBiZSBzb21lIGNvbnRyYWN0IGZhbGxiYWNrIGZ1bmN0aW9uIGFuZCBpdCBjYW4gYmUgZGFuZ2Vyb3VzLiAKICAgICAgICAgICAgLy8gaW4gY2FzZSBvZiBzZW5kIGZhaWx1cmUgZXRoZXIgZ29lcyB0byB0aGUgY29udHJhY3QKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8vIEluaXRpYXRvciBjYW4gc3RhcnQgdGhlIHN3ZWVwc3Rha2UgYWdhaW4KICAgIGZ1bmN0aW9uIHN0YXJ0U3dlZXBTdGFrZSgpIGV4dGVybmFsIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gaW5pdGlhbGl6ZWRCeSk7CiAgICAgICAgLy8gc2V0dGluZ3MgdGhlIGNvbnRyb2wgZmxhZ3MgdG8gcHJldmVudCB0aGUgaW5pdGlhdG9yIGZyb20gd2l0aGRyYXdpbmcgdGhlIGZ1bmRzCiAgICAgICAgc3dlZXBTdGFrZVN0b3BwZWQgPSBmYWxzZTsKICAgICAgICByZXN0T2ZCYWxhbmNlTG9ja2VkID0gdHJ1ZTsKICAgIH0KICAgIAogICAgLy8gc2hvd3MgaG93IG1hbnkgdGltZXMgcnVuU3dlZXBTdGFrZSBmdW5jdGlvbiBuZWVkcyB0byBiZSBydW4KICAgIGZ1bmN0aW9uIGNoZWNrUm91bmRzTnVtYmVyVG9SdW4oKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQxNiBybnRyKXsKICAgICAgICBybnRyID0gcm91bmRzSW5kZXg7CiAgICAgICAgcmV0dXJuIHJudHI7CiAgICB9Cn0='.
	

]
