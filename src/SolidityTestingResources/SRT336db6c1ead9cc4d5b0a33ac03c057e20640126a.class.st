Class {
	#name : #SRT336db6c1ead9cc4d5b0a33ac03c057e20640126a,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT336db6c1ead9cc4d5b0a33ac03c057e20640126a >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMDsKCmNvbnRyYWN0IEV0aGVyVGFua3NDb3JlIHsKICAgIAogICAgc3RydWN0IFRhbmtIdWxsIHsKICAgICAgICB1aW50MzIgYXJtb3I7IC8vIEh1bGwncyBhcm1vciB2YWx1ZQogICAgICAgIHVpbnQzMiBzcGVlZDsgLy8gSHVsbCdzIHNwZWVkIHZhbHVlCiAgICAgICAgdWludDggbGVhZ3VlOyAvLyBUaGUgYmF0dGxlIGxlYWd1ZSB3aGljaCBhbGxvd3MgdG8gcGxheSB3aXRoIHRoaXMgaHVsbCB0eXBlCiAgICB9CiAgICAKICAgIHN0cnVjdCBUYW5rV2VhcG9uIHsKICAgICAgICB1aW50MzIgbWluRGFtYWdlOyAvLyBXZWFwb24gbWluaW1hbCBkYW1hZ2UgdmFsdWUKICAgICAgICB1aW50MzIgbWF4RGFtYWdlOyAvLyBXZWFwb24gbWF4aW11bSBkYW1hZ2UgdmFsdWUKICAgICAgICB1aW50MzIgYXR0YWNrU3BlZWQ7IC8vIFdlYXBvbidzIGF0dGFjayBzcGVlZCB2YWx1ZQogICAgICAgIHVpbnQ4IGxlYWd1ZTsgLy8gVGhlIGJhdHRsZSBsZWFndWUgd2hpY2ggYWxsb3dzIHRvIHBsYXkgd2l0aCB0aGlzIHdlYXBvbiB0eXBlCiAgICB9CiAgICAKICAgIHN0cnVjdCBUYW5rUHJvZHVjdCB7CiAgICAgICAgc3RyaW5nIG5hbWU7IC8vIFRhbmsncyBuYW1lCiAgICAgICAgdWludDMyIGh1bGw7IC8vIEh1bGwncyBJRAogICAgICAgIHVpbnQzMiB3ZWFwb247IC8vIFdlYXBvbidzIElECiAgICAgICAgLy8gVW5mb3J0dW5hdGVseSwgaXQncyBpbXBvc3NpYmxlIHRvIGRlZmluZSB0aGUgdmFyaWFibGUgaW5zaWRlIHRoZSBzdHJ1Y3QgYXMgY29uc3RhbnQuCiAgICAgICAgLy8gSG93ZXZlciwgeW91IGNhbiByZWFkIHRoaXMgc21hcnQtY29udHJhY3QgYW5kIHNlZSB0aGF0IHRoZXJlIGFyZSBubyBjaGFuZ2VzIGF0IGFsbCByZWxhdGVkIHRvIHRoZSBzdGFydCBwcmljZXMuCiAgICAgICAgdWludDI1NiBzdGFydFByaWNlOwogICAgICAgIHVpbnQyNTYgY3VycmVudFByaWNlOyAvLyBUaGUgY3VycmVudCBwcmljZS4gQ2hhbmdlcyBldmVyeSB0aW1lIHNvbWVvbmUgYnV5cyB0aGlzIGtpbmQgb2YgdGFuawogICAgICAgIHVpbnQyNTYgZWFybmluZzsgLy8gVGhlIGFtb3VudCBvZiBlYXJuaW5nIGVhY2ggb3duZXIgb2YgdGhpcyB0YW5rIGdldHMgd2hlbiBzb21lb25lIGJ1eXMgdGhpcyB0eXBlIG9mIHRhbmsKICAgICAgICB1aW50MjU2IHJlbGVhc2VUaW1lOyAvLyBUaGUgbW9tZW50IHdoZW4gaXQgd2lsbCBiZSBhbGxvd2VkIHRvIGJ1eSB0aGlzIHR5cGUgb2YgdGFuawogICAgICAgIHVpbnQzMiBhbW91bnRPZlRhbmtzOyAvLyBUaGUgYW1vdW50IG9mIHRhbmtzIHdpdGggdGhpcyBraW5kIG9mIHByb2R1Y3QKICAgICAgICAKICAgIH0KICAgICAgICAKICAgIHN0cnVjdCBUYW5rRW50aXR5IHsKICAgICAgICB1aW50MzIgcHJvZHVjdElEOwogICAgICAgIHVpbnQ4WzRdIHVwZ3JhZGVzOwogICAgICAgIGFkZHJlc3Mgb3duZXI7IC8vIFRoZSBhZGRyZXNzIG9mIHRoZSBvd25lciBvZiB0aGlzIHRhbmsKICAgICAgICBhZGRyZXNzIGVhcm5lcjsgLy8gVGhlIGFkZHJlc3Mgb2YgdGhlIGVhcm5lciBvZiB0aGlzIHRhbmsgd2hvIGdldCBwYWlkCiAgICAgICAgYm9vbCBzZWxsaW5nOyAvLyBJcyB0aGlzIHRhbmsgb24gdGhlIGF1Y3Rpb24gbm93PwogICAgICAgIHVpbnQyNTYgYXVjdGlvbkVudGl0eTsgLy8gSWYgaXQncyBvbiB0aGUgYXVjdGlvbiwKICAgICAgICB1aW50MjU2IGVhcm5lZDsgLy8gVG90YWwgZnVuZHMgZWFybmVkIHdpdGggdGhpcyB0YW5rCiAgICAgICAgdWludDMyIGV4cDsgLy8gVGFuaydzIGV4cGVyaWVuY2UKICAgICAgICB1aW50MzIgbGFzdENhc2hvdXRJbmRleDsgLy8gTGFzdCBhbW91bnQgb2YgdGFua3MgZXhpc3RpbmcgaW4gdGhlIGdhbWUgd2l0aCB0aGUgc2FtZSBQcm9kdWN0SUQKICAgIH0KICAgIAoKICAgIHN0cnVjdCBBdWN0aW9uRW50aXR5IHsKICAgICAgICB1aW50MzIgdGFua0lkOwogICAgICAgIHVpbnQyNTYgc3RhcnRQcmljZTsKICAgICAgICB1aW50MjU2IGZpbmlzaFByaWNlOwogICAgICAgIHVpbnQyNTYgc3RhcnRUaW1lOwogICAgICAgIHVpbnQyNTYgZHVyYXRpb247CiAgICB9CiAgICAKICAgIGV2ZW50IEV2ZW50Q2FzaE91dCAoCiAgICAgICBhZGRyZXNzIGluZGV4ZWQgcGxheWVyLAogICAgICAgdWludDI1NiBhbW91bnQKICAgICAgICk7IC8vOy0pCiAgICAKICAgIGV2ZW50IEV2ZW50TG9naW4gKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBwbGF5ZXIsCiAgICAgICAgc3RyaW5nIGhhc2gKICAgICAgICApOyAvLzstKQogICAgCiAgICBldmVudCBFdmVudFVwZ3JhZGVUYW5rICgKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgcGxheWVyLAogICAgICAgIHVpbnQzMiB0YW5rSUQsCiAgICAgICAgdWludDggdXBncmFkZUNob2ljZQogICAgICAgICk7IC8vIDstKQogICAgCiAgICBldmVudCBFdmVudFRyYW5zZmVyICgKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgcGxheWVyLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCByZWNlaXZlciwKICAgICAgICB1aW50MzIgdGFua0lECiAgICAgICAgKTsgLy8gOy0pCiAgICAgICAgCiAgICBldmVudCBFdmVudFRyYW5zZmVyQWN0aW9uICgKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgcGxheWVyLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCByZWNlaXZlciwKICAgICAgICB1aW50MzIgdGFua0lELAogICAgICAgIHVpbnQ4IEFjdGlvblR5cGUKICAgICAgICApOyAvLyA7LSkKICAgICAgICAKICAgIGV2ZW50IEV2ZW50QXVjdGlvbiAoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIHBsYXllciwKICAgICAgICB1aW50MzIgdGFua0lELAogICAgICAgIHVpbnQyNTYgc3RhcnRQcmljZSwKICAgICAgICB1aW50MjU2IGZpbmlzaFByaWNlLAogICAgICAgIHVpbnQyNTYgZHVyYXRpb24sCiAgICAgICAgdWludDI1NiBjdXJyZW50VGltZQogICAgICAgICk7IC8vIDstKQogICAgZXZlbnQgRXZlbnRDYW5jZWxBdWN0aW9uICgKICAgICAgICB1aW50MzIgdGFua0lECiAgICAgICAgKTsgLy8gOy0pCiAgICAKICAgIGV2ZW50IEV2ZW50QmlkICgKICAgICAgICB1aW50MzIgdGFua0lEICAKICAgICAgICApOyAvLyA7LSkKICAgIAogICAgZXZlbnQgRXZlbnRQcm9kdWN0ICgKICAgICAgICB1aW50MzIgcHJvZHVjdElELAogICAgICAgIHN0cmluZyBuYW1lLAogICAgICAgIHVpbnQzMiBodWxsLAogICAgICAgIHVpbnQzMiB3ZWFwb24sCiAgICAgICAgdWludDI1NiBwcmljZSwKICAgICAgICB1aW50MjU2IGVhcm5pbmcsCiAgICAgICAgdWludDI1NiByZWxlYXNlVGltZSwKICAgICAgICB1aW50MjU2IGN1cnJlbnRUaW1lCiAgICAgICAgKTsgLy8gOy0pCiAgICAgICAgCiAgICBldmVudCBFdmVudEJ1eVRhbmsgKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBwbGF5ZXIsCiAgICAgICAgdWludDMyIHByb2R1Y3RJRCwKICAgICAgICB1aW50MzIgdGFua0lECiAgICAgICAgKTsgLy8gOy0pCgogICAgCiAgICBhZGRyZXNzIHB1YmxpYyBVcGdyYWRlTWFzdGVyOyAvLyBFYXJucyBmZWVzIGZvciB1cGdyYWRpbmcgdGFua3MgKDAuMDUgRXRoKQogICAgYWRkcmVzcyBwdWJsaWMgQXVjdGlvbk1hc3RlcjsgLy8gRWFybnMgZmVlcyBmb3IgcHJvZHVjaW5nIGF1Y3Rpb25zICgzJSkKICAgIGFkZHJlc3MgcHVibGljIFRhbmtTZWxsTWFzdGVyOyAvLyBFYXJucyBmZWVzIGZvciBzZWxsaW5nIHRhbmtzIChzdGFydCBwcmljZSkKICAgIGFkZHJlc3MgcHVibGljIEV4cG9ydE1hc3RlcjsgLy8gRXhwb3J0cyB0YW5rcyBmcm9tIHRoZSBwcmV2aW91cyBjb250cmFjdC4KICAgIGJvb2wgcHVibGljIGNhbkV4cG9ydCA9IHRydWU7IC8vIElmIGZhbHNlIC0tIHRoZSBleHBvcnRpbmcgaXMgbm90IGFsbG93ZWQgZm9yIHRoaXMgY29udHJhY3QgZm9yZXZlciwgc28gaXQncyBzYWZlLgogICAgLy8gTm8gbW9kaWZpZXJzIHdlcmUgbmVlZGVkLCBiZWNhdXNlIGVhY2ggYWNjZXNzIGlzIGNoZWNrZWQgbm8gbW9yZSB0aGFuIG9uZSB0aW1lIGluIHRoZSB3aG9sZSBjb2RlLAogICAgLy8gU28gY2FsbGluZyAicmVxdWlyZShtc2cuc2VuZGVyID09IFVwZ3JhZGVNYXN0ZXIpOyIgaXMgZW5vdWdoLgogICAgCiAgICBmdW5jdGlvbiBDaGFuZ2VVcGdyYWRlTWFzdGVyIChhZGRyZXNzIF9uZXdNYXN0ZXIpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IFVwZ3JhZGVNYXN0ZXIpOwogICAgICAgIFVwZ3JhZGVNYXN0ZXIgPSBfbmV3TWFzdGVyOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBDaGFuZ2VUYW5rU2VsbE1hc3RlciAoYWRkcmVzcyBfbmV3TWFzdGVyKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBUYW5rU2VsbE1hc3Rlcik7CiAgICAgICAgVGFua1NlbGxNYXN0ZXIgPSBfbmV3TWFzdGVyOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBDaGFuZ2VBdWN0aW9uTWFzdGVyIChhZGRyZXNzIF9uZXdNYXN0ZXIpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IEF1Y3Rpb25NYXN0ZXIpOwogICAgICAgIEF1Y3Rpb25NYXN0ZXIgPSBfbmV3TWFzdGVyOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBGaW5pc2hlZEV4cG9ydGluZyAoKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBFeHBvcnRNYXN0ZXIpOwogICAgICAgIGNhbkV4cG9ydCA9IGZhbHNlOyAvLyBOb3csIHRoZSBleHBvcnRpbmcgcHJvY2VzcyBoYXMgYmVlbiBmaW5pc2hlZCwgc28gd2UgZG8gbm90IG5lZWQgdG8gZXhwb3J0IGFueXRoaW5nIGFueW1vcmUuIERvbmUuCiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIEV0aGVyVGFua3NDb3JlKCkgcHVibGljIHsKICAgICAgICAKICAgICAgICBVcGdyYWRlTWFzdGVyID0gbXNnLnNlbmRlcjsKICAgICAgICBBdWN0aW9uTWFzdGVyID0gbXNnLnNlbmRlcjsKICAgICAgICBUYW5rU2VsbE1hc3RlciA9IG1zZy5zZW5kZXI7CiAgICAgICAgRXhwb3J0TWFzdGVyID0gbXNnLnNlbmRlcjsKCiAgICAgICAgLy8gQ3JlYXRpbmcgMTEgaHVsbHMKICAgICAgICBuZXdUYW5rSHVsbCgxMDAsIDUsIDEpOwogICAgICAgIG5ld1RhbmtIdWxsKDYwLCA2LCAyKTsKICAgICAgICBuZXdUYW5rSHVsbCgxNDAsIDQsIDEpOwogICAgICAgIG5ld1RhbmtIdWxsKDIwMCwgMywgMSk7CiAgICAgICAgbmV3VGFua0h1bGwoMjQwLCAzLCAxKTsKICAgICAgICBuZXdUYW5rSHVsbCgyMDAsIDYsIDIpOwogICAgICAgIG5ld1RhbmtIdWxsKDM2MCwgNCwgMik7CiAgICAgICAgbmV3VGFua0h1bGwoMTgwLCA5LCAzKTsKICAgICAgICBuZXdUYW5rSHVsbCgyNDAsIDgsIDMpOwogICAgICAgIG5ld1RhbmtIdWxsKDUwMCwgNCwgMik7CiAgICAgICAgbmV3VGFua0h1bGwoNDQwLCA2LCAzKTsKICAgICAgICAKICAgICAgICAvLyBDcmVhdGluZyAxMSB3ZWFwb25zCiAgICAgICAgbmV3VGFua1dlYXBvbig2LCAxNCwgNSwgMSk7CiAgICAgICAgbmV3VGFua1dlYXBvbigxOCwgMjYsIDMsIDIpOwogICAgICAgIG5ld1RhbmtXZWFwb24oNDQsIDY2LCAyLCAxKTsKICAgICAgICBuZXdUYW5rV2VhcG9uKDIxLCA0OSwgMywgMSk7CiAgICAgICAgbmV3VGFua1dlYXBvbig2MCwgOTAsIDIsIDIpOwogICAgICAgIG5ld1RhbmtXZWFwb24oMjEsIDQ5LCAyLCAyKTsKICAgICAgICBuZXdUYW5rV2VhcG9uKDQ4LCA3MiwgMywgMik7CiAgICAgICAgbmV3VGFua1dlYXBvbigxMywgMjksIDksIDMpOwogICAgICAgIG5ld1RhbmtXZWFwb24oMzYsIDg0LCA0LCAzKTsKICAgICAgICBuZXdUYW5rV2VhcG9uKDEyMCwgMTgwLCAyLCAzKTsKICAgICAgICBuZXdUYW5rV2VhcG9uKDcyLCAxMDgsIDQsIDMpOwogICAgICAgIAogICAgICAgIC8vIENyZWF0aW5nIGZpcnN0IDExIHRhbmsgdHlwZXMKICAgICAgICBuZXdUYW5rUHJvZHVjdCgiTFQtMSIsIDEsIDEsIDEwMDAwMDAwMDAwMDAwMDAwLCAxMDAwMDAwMDAwMDAwMDAsIG5vdyk7CiAgICAgICAgbmV3VGFua1Byb2R1Y3QoIkxULTIiLCAyLCAyLCA1MDAwMDAwMDAwMDAwMDAwMCwgNTAwMDAwMDAwMDAwMDAwLCBub3cpOwogICAgICAgIG5ld1RhbmtQcm9kdWN0KCJNVC0xIiwgMywgMywgMTAwMDAwMDAwMDAwMDAwMDAwLCAxMDAwMDAwMDAwMDAwMDAwLCBub3cpOwogICAgICAgIG5ld1RhbmtQcm9kdWN0KCJIVC0xIiwgNCwgNCwgNTAwMDAwMDAwMDAwMDAwMDAwLCA1MDAwMDAwMDAwMDAwMDAwLCBub3cpOwogICAgICAgIG5ld1RhbmtQcm9kdWN0KCJTUEctMSIsIDUsIDUsIDUwMDAwMDAwMDAwMDAwMDAwMCwgNTAwMDAwMDAwMDAwMDAwMCwgbm93KTsKICAgICAgICBuZXdUYW5rUHJvZHVjdCgiTVQtMiIsIDYsIDYsIDcwMDAwMDAwMDAwMDAwMDAwMCwgNzAwMDAwMDAwMDAwMDAwMCwgbm93KTsKICAgICAgICBuZXdUYW5rUHJvZHVjdCgiSFQtMiIsIDcsIDcsIDE1MDAwMDAwMDAwMDAwMDAwMDAsIDE1MDAwMDAwMDAwMDAwMDAwLCBub3cpOwogICAgICAgIG5ld1RhbmtQcm9kdWN0KCJMVC0zIiwgOCwgOCwgMzAwMDAwMDAwMDAwMDAwMDAwLCAzMDAwMDAwMDAwMDAwMDAwLCBub3cpOwogICAgICAgIG5ld1RhbmtQcm9kdWN0KCJNVC0zIiwgOSwgOSwgMTUwMDAwMDAwMDAwMDAwMDAwMCwgMTUwMDAwMDAwMDAwMDAwMDAsIG5vdyk7CiAgICAgICAgbmV3VGFua1Byb2R1Y3QoIlNQRy0yIiwgMTAsIDEwLCAyMDAwMDAwMDAwMDAwMDAwMDAwLCAyMDAwMDAwMDAwMDAwMDAwMCwgbm93Kyg2MCo2MCo1KSk7CiAgICAgICAgbmV3VGFua1Byb2R1Y3QoIkhULTMiLCAxMSwgMTEsIDI1MDAwMDAwMDAwMDAwMDAwMDAsIDI1MDAwMDAwMDAwMDAwMDAwLCBub3crKDYwKjYwKjUpKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gY2FzaE91dCAodWludDI1NiBfYW1vdW50KSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZSAoY2FuRXhwb3J0ID09IGZhbHNlKTsgLy8gQ2FuIGJlIGNhbGxlZCBvbmx5IGlmIHRoZSBwcm9jZXNzIG9mIGV4cG9ydGluZyBoYXMgYmVlbiBjb21wbGV0ZWQKCiAgICAgICAgcmVxdWlyZSAoX2Ftb3VudCA+PSAwKTsgLy9qdXN0IGluIGNhc2UKICAgICAgICByZXF1aXJlIChfYW1vdW50ID09IHVpbnQyNTYodWludDEyOChfYW1vdW50KSkpOyAvLyBKdXN0IHNvbWUgbWFnaWMgc3R1ZmYKICAgICAgICByZXF1aXJlICh0aGlzLmJhbGFuY2UgPj0gX2Ftb3VudCk7IC8vIENoZWNraW5nIGlmIHRoaXMgY29udHJhY3QgaGFzIGVub3VnaHQgbW9uZXkgdG8gcGF5CiAgICAgICAgcmVxdWlyZSAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX2Ftb3VudCk7IC8vIENoZWNraW5nIGlmIHBsYXllciBoYXMgZW5vdWdoIGZ1bmRzIG9uIGhpcyBiYWxhbmNlCiAgICAgICAgaWYgKF9hbW91bnQgPT0gMCl7CiAgICAgICAgICAgIF9hbW91bnQgPSBiYWxhbmNlc1ttc2cuc2VuZGVyXTsKICAgICAgICAgICAgLy8gSWYgdGhlIHJlcXVlc3RlZCBhbW91bnQgaXMgMCwgaXQgbWVhbnMgdGhhdCBwbGF5ZXIgd2FudHMgdG8gY2FzaG91dCB0aGUgd2hvbGUgYW1vdW50IG9mIGJhbGFuY2UKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gLT0gX2Ftb3VudDsgLy8gQ2hhbmdpbmcgdGhlIGFtb3VudCBvZiBmdW5kcyBvbiB0aGUgcGxheWVyJ3MgaW4tZ2FtZSBiYWxhbmNlCiAgICAgICAgCiAgICAgICAgaWYgKCFtc2cuc2VuZGVyLnNlbmQoX2Ftb3VudCkpeyAvLyBTZW5kaW5nIGZ1bmRzIGFuZCBpZiB0aGUgdHJhbnNhY3Rpb24gaXMgZmFpbGVkCiAgICAgICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdICs9IF9hbW91bnQ7IC8vIFJldHVybmluZyB0aGUgYW1vdW50IG9mIGZ1bmRzIG9uIHRoZSBwbGF5ZXIncyBpbi1nYW1lIGJhbGFuY2UKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgRXZlbnRDYXNoT3V0IChtc2cuc2VuZGVyLCBfYW1vdW50KTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNhc2hPdXRUYW5rICh1aW50MzIgX3RhbmtJRCkgcHVibGljIHBheWFibGUgewogICAgICAgIHJlcXVpcmUgKGNhbkV4cG9ydCA9PSBmYWxzZSk7IC8vIENhbiBiZSBjYWxsZWQgb25seSBpZiB0aGUgcHJvY2VzcyBvZiBleHBvcnRpbmcgaGFzIGJlZW4gY29tcGxldGVkCiAgICAgICAgCiAgICAgICAgcmVxdWlyZSAoX3RhbmtJRCA+IDAgJiYgX3RhbmtJRCA8IG5ld0lkVGFuayk7IC8vIENoZWNraW5nIGlmIHRoZSB0YW5rIGV4aXN0cwogICAgICAgIHJlcXVpcmUgKHRhbmtzW190YW5rSURdLm93bmVyID09IG1zZy5zZW5kZXIpOyAvLyBDaGVja2luZyBpZiBzZW5kZXIgb3ducyB0aGlzIHRhbmsKICAgICAgICB1aW50MjU2IF9hbW91bnQgPSB0YW5rUHJvZHVjdHNbdGFua3NbX3RhbmtJRF0ucHJvZHVjdElEXS5lYXJuaW5nKih0YW5rUHJvZHVjdHNbdGFua3NbX3RhbmtJRF0ucHJvZHVjdElEXS5hbW91bnRPZlRhbmtzLXRhbmtzW190YW5rSURdLmxhc3RDYXNob3V0SW5kZXgpOwogICAgICAgIHJlcXVpcmUgKHRoaXMuYmFsYW5jZSA+PSBfYW1vdW50KTsgLy8gQ2hlY2tpbmcgaWYgdGhpcyBjb250cmFjdCBoYXMgZW5vdWdodCBtb25leSB0byBwYXkKICAgICAgICByZXF1aXJlIChfYW1vdW50ID4gMCk7CiAgICAgICAgCiAgICAgICAgdWludDMyIGxhc3RJbmRleCA9IHRhbmtzW190YW5rSURdLmxhc3RDYXNob3V0SW5kZXg7CiAgICAgICAgCiAgICAgICAgdGFua3NbX3RhbmtJRF0ubGFzdENhc2hvdXRJbmRleCA9IHRhbmtQcm9kdWN0c1t0YW5rc1tfdGFua0lEXS5wcm9kdWN0SURdLmFtb3VudE9mVGFua3M7IC8vIENoYW5naW5nIHRoZSBhbW91bnQgb2YgZnVuZHMgb24gdGhlIHRhbmtzJ3MgaW4tZ2FtZSBiYWxhbmNlCiAgICAgICAgCiAgICAgICAgaWYgKCF0YW5rc1tfdGFua0lEXS5vd25lci5zZW5kKF9hbW91bnQpKXsgLy8gU2VuZGluZyBmdW5kcyBhbmQgaWYgdGhlIHRyYW5zYWN0aW9uIGlzIGZhaWxlZAogICAgICAgICAgICB0YW5rc1tfdGFua0lEXS5sYXN0Q2FzaG91dEluZGV4ID0gbGFzdEluZGV4OyAvLyBDaGFuZ2luZyB0aGUgYW1vdW50IG9mIGZ1bmRzIG9uIHRoZSB0YW5rcydzIGluLWdhbWUgYmFsYW5jZQogICAgICAgIH0KICAgICAgICAKICAgICAgICBFdmVudENhc2hPdXQgKG1zZy5zZW5kZXIsIF9hbW91bnQpOwogICAgICAgIHJldHVybjsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gbG9naW4gKHN0cmluZyBfaGFzaCkgcHVibGljIHsKICAgICAgICBFdmVudExvZ2luIChtc2cuc2VuZGVyLCBfaGFzaCk7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgCiAgICAvL3VwZ3JhZGUgdGFuawogICAgLy8gQF91cGdyYWRlQ2hvaWNlOiAwIGlzIGZvciBhcm1vciwgMSBpcyBmb3IgZGFtYWdlLCAyIGlzIGZvciBzcGVlZCwgMyBpcyBmb3IgYXR0YWNrIHNwZWVkCiAgICBmdW5jdGlvbiB1cGdyYWRlVGFuayAodWludDMyIF90YW5rSUQsIHVpbnQ4IF91cGdyYWRlQ2hvaWNlKSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZSAoX3RhbmtJRCA+IDAgJiYgX3RhbmtJRCA8IG5ld0lkVGFuayk7IC8vIENoZWNraW5nIGlmIHRoZSB0YW5rIGV4aXN0cwogICAgICAgIHJlcXVpcmUgKHRhbmtzW190YW5rSURdLm93bmVyID09IG1zZy5zZW5kZXIpOyAvLyBDaGVja2luZyBpZiBzZW5kZXIgb3ducyB0aGlzIHRhbmsKICAgICAgICByZXF1aXJlIChfdXBncmFkZUNob2ljZSA+PSAwICYmIF91cGdyYWRlQ2hvaWNlIDwgNCk7IC8vIEhhcyB0byBiZSBiZXR3ZWVuIDAgYW5kIDMKICAgICAgICByZXF1aXJlICh0YW5rc1tfdGFua0lEXS51cGdyYWRlc1tfdXBncmFkZUNob2ljZV0gPCA1KTsgLy8gT25seSA1IHVwZ3JhZGVzIGFyZSBhbGxvd2VkIGZvciBlYWNoIHR5cGUgb2YgdGFuaydzIHBhcmFtZXRyZXMKICAgICAgICByZXF1aXJlIChtc2cudmFsdWUgPj0gdXBncmFkZVByaWNlKTsgLy8gQ2hlY2tpbmcgaWYgdGhlcmUgaXMgZW5vdWdoIGFtb3VudCBvZiBtb25leSBmb3IgdGhlIHVwZ3JhZGUKICAgICAgICB0YW5rc1tfdGFua0lEXS51cGdyYWRlc1tfdXBncmFkZUNob2ljZV0rKzsgLy8gVXBncmFkaW5nCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gKz0gbXNnLnZhbHVlLXVwZ3JhZGVQcmljZTsgLy8gUmV0dXJuaW5nIHRoZSByZXN0IGFtb3VudCBvZiBtb25leSBiYWNrIHRvIHRoZSB0YW5rIG93bmVyCiAgICAgICAgYmFsYW5jZXNbVXBncmFkZU1hc3Rlcl0gKz0gdXBncmFkZVByaWNlOyAvLyBTZW5kaW5nIHRoZSBhbW91bnQgb2YgbW9uZXkgc3BlbnQgb24gdGhlIHVwZ3JhZGUgdG8gdGhlIGNvbnRyYWN0IGNyZWF0b3IKICAgICAgICAKICAgICAgICBFdmVudFVwZ3JhZGVUYW5rIChtc2cuc2VuZGVyLCBfdGFua0lELCBfdXBncmFkZUNob2ljZSk7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgCiAgICAKICAgIC8vIFRyYW5zZmVyLiBVc2luZyBmb3Igc2VuZGluZyB0YW5rcyB0byBhbm90aGVyIHBsYXllcnMKICAgIGZ1bmN0aW9uIF90cmFuc2ZlciAodWludDMyIF90YW5rSUQsIGFkZHJlc3MgX3JlY2VpdmVyKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUgKF90YW5rSUQgPiAwICYmIF90YW5rSUQgPCBuZXdJZFRhbmspOyAvLyBDaGVja2luZyBpZiB0aGUgdGFuayBleGlzdHMKICAgICAgICByZXF1aXJlICh0YW5rc1tfdGFua0lEXS5vd25lciA9PSBtc2cuc2VuZGVyKTsgLy9DaGVja2luZyBpZiBzZW5kZXIgb3ducyB0aGlzIHRhbmsKICAgICAgICByZXF1aXJlIChtc2cuc2VuZGVyICE9IF9yZWNlaXZlcik7IC8vIENoZWNraW5nIHRoYXQgdGhlIG93bmVyIGlzIG5vdCBzZW5kaW5nIHRoZSB0YW5rIHRvIGhpbXNlbGYKICAgICAgICByZXF1aXJlICh0YW5rc1tfdGFua0lEXS5zZWxsaW5nID09IGZhbHNlKTsgLy9NYWtpbmcgc3VyZSB0aGF0IHRoZSB0YW5rIGlzIG5vdCBvbiB0aGUgYXVjdGlvbiBub3cKICAgICAgICB0YW5rc1tfdGFua0lEXS5vd25lciA9IF9yZWNlaXZlcjsgLy8gQ2hhbmdpbmcgdGhlIHRhbmsncyBvd25lcgogICAgICAgIHRhbmtzW190YW5rSURdLmVhcm5lciA9IF9yZWNlaXZlcjsgLy8gQ2hhbmdpbmcgdGhlIHRhbmsncyBlYXJuZXIgYWRkcmVzcwoKICAgICAgICBFdmVudFRyYW5zZmVyIChtc2cuc2VuZGVyLCBfcmVjZWl2ZXIsIF90YW5rSUQpOwogICAgICAgIHJldHVybjsKICAgIH0KICAgIAogICAgLy8gVHJhbnNmZXIgQWN0aW9uLiBVc2luZyBmb3Igc2VuZGluZyB0YW5rcyB0byBFdGhlclRhbmtzJyBjb250cmFjdHMuIEZvciBleGFtcGxlLCB0aGUgYmF0dGxlLWFyZWEgY29udHJhY3QuCiAgICBmdW5jdGlvbiBfdHJhbnNmZXJBY3Rpb24gKHVpbnQzMiBfdGFua0lELCBhZGRyZXNzIF9yZWNlaXZlciwgdWludDggX0FjdGlvblR5cGUpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZSAoX3RhbmtJRCA+IDAgJiYgX3RhbmtJRCA8IG5ld0lkVGFuayk7IC8vIENoZWNraW5nIGlmIHRoZSB0YW5rIGV4aXN0cwogICAgICAgIHJlcXVpcmUgKHRhbmtzW190YW5rSURdLm93bmVyID09IG1zZy5zZW5kZXIpOyAvLyBDaGVja2luZyBpZiBzZW5kZXIgb3ducyB0aGlzIHRhbmsKICAgICAgICByZXF1aXJlIChtc2cuc2VuZGVyICE9IF9yZWNlaXZlcik7IC8vIENoZWNraW5nIHRoYXQgdGhlIG93bmVyIGlzIG5vdCBzZW5kaW5nIHRoZSB0YW5rIHRvIGhpbXNlbGYKICAgICAgICByZXF1aXJlICh0YW5rc1tfdGFua0lEXS5zZWxsaW5nID09IGZhbHNlKTsgLy8gTWFraW5nIHN1cmUgdGhhdCB0aGUgdGFuayBpcyBub3Qgb24gdGhlIGF1Y3Rpb24gbm93CiAgICAgICAgdGFua3NbX3RhbmtJRF0ub3duZXIgPSBfcmVjZWl2ZXI7IC8vIENoYW5naW5nIHRoZSB0YW5rJ3Mgb3duZXIKICAgICAgICAKICAgICAgICAvLyBBcyB5b3UgY2FuIHNlZSwgd2UgZG8gbm90IGNoYW5nZSB0aGUgZWFybmVyIGhlcmUuCiAgICAgICAgLy8gSXQgbWVhbnMgdGhhdCB0ZWNobmljYWxseSBzcGVha2luZywgdGhlIHRhbmsncyBvd25lciBpcyBzdGlsbCBnZXR0aW5nIGhpcyBlYXJuaW5ncy4KICAgICAgICAvLyBJdCdzIGxvZ2ljYWxseSB0aGF0IHRoaXMgbWV0aG9kICh0cmFuc2ZlckFjdGlvbikgd2lsbCBiZSB1c2VkIGZvciBzZW5kaW5nIHRhbmtzIHRvIHRoZSBiYXR0bGUgYXJlYSBjb250cmFjdCBvciBzb21lIG90aGVyIGNvbnRyYWN0cyB3aGljaCB3aWxsIGJlIGludGVyYWN0aW5nIHdpdGggdGFua3MKICAgICAgICAvLyBCZSBjYXJlZnVsIHdpdGggdGhpcyBtZXRob2QhIERvIG5vdCBjYWxsIGl0IHRvIHRyYW5zZmVyIHRhbmtzIHRvIGFub3RoZXIgcGxheWVyIQogICAgICAgIC8vIFRoZSByZWFzb24geW91IHNob3VsZCBub3QgZG8gdGhpcyBpcyB0aGF0IHRoZSBtZXRob2QgY2FsbGVkICJ0cmFuc2ZlciIgY2hhbmdlcyB0aGUgb3duZXIgYW5kIGVhcm5lciwgc28gaXQgaXMgcG9zc2libGUgdG8gY2hhbmdlIHRoZSBlYXJuZXIgYWRkcmVzcyB0byB0aGUgY3VycmVudCBvd25lciBhZGRyZXNzIGFueSB0aW1lLgogICAgICAgIC8vIEhvd2V2ZXIsIGZvciBvdXIgc3BlY2lhbCBjb250cmFjdHMgbGlrZSBiYXR0bGUgYXJlYSwgeW91IGFyZSBhYmxlIHRvIHJlYWQgdGhpcyBjb250cmFjdCBhbmQgbWFrZSBzdXJlIHRoYXQgeW91ciB0YW5rIHdpbGwgbm90IGJlIHNlbnQgdG8gYW55b25lIGVsc2UsIG9ubHkgYmFjayB0byB5b3UuCiAgICAgICAgLy8gU28sIHBsZWFzZSwgZG8gbm90IHVzZSB0aGlzIG1ldGhvZCB0byBzZW5kIHlvdXIgdGFua3MgdG8gb3RoZXIgcGxheWVycy4gVXNlIGl0IGp1c3QgZm9yIGludGVyYWN0aW5nIHdpdGggRXRoZXJUYW5rcycgY29udHJhY3RzLCB3aGljaCB3aWxsIGJlIGxpc3RlZCBvbiBFdGhlclRhbmtzLmNvbQogICAgICAgIAogICAgICAgIEV2ZW50VHJhbnNmZXJBY3Rpb24gKG1zZy5zZW5kZXIsIF9yZWNlaXZlciwgX3RhbmtJRCwgX0FjdGlvblR5cGUpOwogICAgICAgIHJldHVybjsKICAgIH0KICAgIAogICAgLy9zZWxsaW5nCiAgICBmdW5jdGlvbiBzZWxsVGFuayAodWludDMyIF90YW5rSUQsIHVpbnQyNTYgX3N0YXJ0UHJpY2UsIHVpbnQyNTYgX2ZpbmlzaFByaWNlLCB1aW50MjU2IF9kdXJhdGlvbikgcHVibGljIHsKICAgICAgICByZXF1aXJlIChfdGFua0lEID4gMCAmJiBfdGFua0lEIDwgbmV3SWRUYW5rKTsKICAgICAgICByZXF1aXJlICh0YW5rc1tfdGFua0lEXS5vd25lciA9PSBtc2cuc2VuZGVyKTsKICAgICAgICByZXF1aXJlICh0YW5rc1tfdGFua0lEXS5zZWxsaW5nID09IGZhbHNlKTsgLy8gTWFraW5nIHN1cmUgdGhhdCB0aGUgdGFuayBpcyBub3Qgb24gdGhlIGF1Y3Rpb24gYWxyZWFkeQogICAgICAgIHJlcXVpcmUgKF9zdGFydFByaWNlID49IF9maW5pc2hQcmljZSk7CiAgICAgICAgcmVxdWlyZSAoX3N0YXJ0UHJpY2UgPiAwICYmIF9maW5pc2hQcmljZSA+PSAwKTsKICAgICAgICByZXF1aXJlIChfZHVyYXRpb24gPiAwKTsKICAgICAgICByZXF1aXJlIChfc3RhcnRQcmljZSA9PSB1aW50MjU2KHVpbnQxMjgoX3N0YXJ0UHJpY2UpKSk7IC8vIEp1c3Qgc29tZSBtYWdpYyBzdHVmZgogICAgICAgIHJlcXVpcmUgKF9maW5pc2hQcmljZSA9PSB1aW50MjU2KHVpbnQxMjgoX2ZpbmlzaFByaWNlKSkpOyAvLyBKdXN0IHNvbWUgbWFnaWMgc3R1ZmYKICAgICAgICAKICAgICAgICBhdWN0aW9uc1tuZXdJZEF1Y3Rpb25FbnRpdHldID0gQXVjdGlvbkVudGl0eShfdGFua0lELCBfc3RhcnRQcmljZSwgX2ZpbmlzaFByaWNlLCBub3csIF9kdXJhdGlvbik7CiAgICAgICAgdGFua3NbX3RhbmtJRF0uc2VsbGluZyA9IHRydWU7CiAgICAgICAgdGFua3NbX3RhbmtJRF0uYXVjdGlvbkVudGl0eSA9IG5ld0lkQXVjdGlvbkVudGl0eSsrOwogICAgICAgIAogICAgICAgIEV2ZW50QXVjdGlvbiAobXNnLnNlbmRlciwgX3RhbmtJRCwgX3N0YXJ0UHJpY2UsIF9maW5pc2hQcmljZSwgX2R1cmF0aW9uLCBub3cpOwogICAgfQogICAgCiAgICAvL2JpZGRpbmcgZnVuY3Rpb24sIHBlb3BsZSB1c2UgdGhpcyB0byBidXkgdGFua3MKICAgIGZ1bmN0aW9uIGJpZCAodWludDMyIF90YW5rSUQpIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlIChfdGFua0lEID4gMCAmJiBfdGFua0lEIDwgbmV3SWRUYW5rKTsgLy8gQ2hlY2tpbmcgaWYgdGhlIHRhbmsgZXhpc3RzCiAgICAgICAgcmVxdWlyZSAodGFua3NbX3RhbmtJRF0uc2VsbGluZyA9PSB0cnVlKTsgLy8gQ2hlY2tpbmcgaWYgdGhpcyB0YW5rcyBpcyBvbiB0aGUgYXVjdGlvbiBub3cKICAgICAgICBBdWN0aW9uRW50aXR5IG1lbW9yeSBjdXJyZW50QXVjdGlvbiA9IGF1Y3Rpb25zW3RhbmtzW190YW5rSURdLmF1Y3Rpb25FbnRpdHldOyAvLyBUaGUgYXVjdGlvbiBlbnRpdHkgZm9yIHRoaXMgdGFuay4gSnVzdCB0byBtYWtlIHRoZSBsaW5lIGJlbG93IGVhc2llciB0byByZWFkCiAgICAgICAgdWludDI1NiBjdXJyZW50UHJpY2UgPSBjdXJyZW50QXVjdGlvbi5zdGFydFByaWNlLSgoKGN1cnJlbnRBdWN0aW9uLnN0YXJ0UHJpY2UtY3VycmVudEF1Y3Rpb24uZmluaXNoUHJpY2UpLyhjdXJyZW50QXVjdGlvbi5kdXJhdGlvbikpKihub3ctY3VycmVudEF1Y3Rpb24uc3RhcnRUaW1lKSk7CiAgICAgICAgLy8gVGhlIGxpbmUgYWJvdmUgY2FsY3VsYXRlcyB0aGUgY3VycmVudCBwcmljZSB1c2luZyB0aGUgZm9ybXVsYSBTdGFydFByaWNlLSgoKFN0YXJ0UHJpY2UtRmluaXNoUHJpY2UpL0R1cmF0aW9uKSooQ3VycmVudFRpbWUtU3RhcnRUaW1lKQogICAgICAgIGlmIChjdXJyZW50UHJpY2UgPCBjdXJyZW50QXVjdGlvbi5maW5pc2hQcmljZSl7IC8vIElmIHRoZSBhdWN0aW9uIGR1cmF0aW9uIHRpbWUgaGFzIGJlZW4gZXhwaXJlZAogICAgICAgICAgICBjdXJyZW50UHJpY2UgPSBjdXJyZW50QXVjdGlvbi5maW5pc2hQcmljZTsgIC8vIFNldHRpbmcgdGhlIGN1cnJlbnQgcHJpY2UgYXMgZmluaXNoUHJpY2UgCiAgICAgICAgfQogICAgICAgIHJlcXVpcmUgKGN1cnJlbnRQcmljZSA+PSAwKTsgLy8gV2hvIGtub3dzIDopCiAgICAgICAgcmVxdWlyZSAobXNnLnZhbHVlID49IGN1cnJlbnRQcmljZSk7IC8vIENoZWNraW5nIGlmIHRoZSBidXllciBzZW50IHRoZSBhbW91bnQgb2YgbW9uZXkgd2hpY2ggaXMgbW9yZSBvciBlcXVhbCB0aGUgY3VycmVudCBwcmljZQogICAgICAgIAogICAgICAgIC8vIEFsbCBpcyBmaW5lLCBjaGFuZ2luZyBiYWxhbmNlcyBhbmQgY2hhbmdpbmcgdGFuaydzIG93bmVyCiAgICAgICAgdWludDI1NiBtYXJrZXRGZWUgPSAoY3VycmVudFByaWNlLzEwMCkqMzsgLy8gQ2FsY3VsYXRpbmcgMyUgb2YgdGhlIGN1cnJlbnQgcHJpY2UgYXMgYSBmZWUKICAgICAgICBiYWxhbmNlc1t0YW5rc1tfdGFua0lEXS5vd25lcl0gKz0gY3VycmVudFByaWNlLW1hcmtldEZlZTsgLy8gR2l2aW5nIFtjdXJyZW50IHByaWNlXS1bZmVlXSBhbW91bnQgdG8gc2VsbGVyCiAgICAgICAgYmFsYW5jZXNbQXVjdGlvbk1hc3Rlcl0gKz0gbWFya2V0RmVlOyAvLyBTZW5kaW5nIHRoZSBmZWUgYW1vdW50IHRvIHRoZSBjb250cmFjdCBjcmVhdG9yJ3MgYmFsYW5jZQogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdICs9IG1zZy52YWx1ZS1jdXJyZW50UHJpY2U7IC8vUmV0dXJuIHRoZSByZXN0IGFtb3VudCB0byBidXllcgogICAgICAgIHRhbmtzW190YW5rSURdLm93bmVyID0gbXNnLnNlbmRlcjsgLy8gQ2hhbmdpbmcgdGhlIG93bmVyIG9mIHRoZSB0YW5rCiAgICAgICAgdGFua3NbX3RhbmtJRF0uc2VsbGluZyA9IGZhbHNlOyAvLyBDaGFuZ2UgdGhlIHRhbmsgc3RhdHVzIHRvICJub3Qgc2VsbGluZyBub3ciCiAgICAgICAgZGVsZXRlIGF1Y3Rpb25zW3RhbmtzW190YW5rSURdLmF1Y3Rpb25FbnRpdHldOyAvLyBEZWxldGluZyB0aGUgYXVjdGlvbiBlbnRpdHkgZnJvbSB0aGUgc3RvcmFnZSBmb3IgYXVjdGlvbnMgLS0gd2UgZG9uJ3QgbmVlZCBpdCBhbnltb3JlCiAgICAgICAgdGFua3NbX3RhbmtJRF0uYXVjdGlvbkVudGl0eSA9IDA7IC8vIE5vdCBuZWNlc3NhcnksIGJ1dCBkZWxldGluZyB0aGUgSUQgb2YgYXVjdGlvbiBlbnRpdHkgd2hpY2ggd2FzIGRlbGV0ZWQgaW4gdGhlIG9wZXJhdGlvbiBhYm92ZQogICAgICAgIAogICAgICAgIEV2ZW50QmlkIChfdGFua0lEKTsKICAgIH0KICAgIAogICAgLy9jYW5jZWwgYXVjdGlvbgogICAgZnVuY3Rpb24gY2FuY2VsQXVjdGlvbiAodWludDMyIF90YW5rSUQpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZSAoX3RhbmtJRCA+IDAgJiYgX3RhbmtJRCA8IG5ld0lkVGFuayk7IC8vIENoZWNraW5nIGlmIHRoZSB0YW5rIGV4aXN0cwogICAgICAgIHJlcXVpcmUgKHRhbmtzW190YW5rSURdLnNlbGxpbmcgPT0gdHJ1ZSk7IC8vIENoZWNraW5nIGlmIHRoaXMgdGFua3MgaXMgb24gdGhlIGF1Y3Rpb24gbm93CiAgICAgICAgcmVxdWlyZSAodGFua3NbX3RhbmtJRF0ub3duZXIgPT0gbXNnLnNlbmRlcik7IC8vIENoZWNraW5nIGlmIHNlbmRlciBvd25zIHRoaXMgdGFuawogICAgICAgIHRhbmtzW190YW5rSURdLnNlbGxpbmcgPSBmYWxzZTsgLy8gQ2hhbmdlIHRoZSB0YW5rIHN0YXR1cyB0byAibm90IHNlbGxpbmcgbm93IgogICAgICAgIGRlbGV0ZSBhdWN0aW9uc1t0YW5rc1tfdGFua0lEXS5hdWN0aW9uRW50aXR5XTsgLy8gRGVsZXRpbmcgdGhlIGF1Y3Rpb24gZW50aXR5IGZyb20gdGhlIHN0b3JhZ2UgZm9yIGF1Y3Rpb25zIC0tIHdlIGRvbid0IG5lZWQgaXQgYW55bW9yZQogICAgICAgIHRhbmtzW190YW5rSURdLmF1Y3Rpb25FbnRpdHkgPSAwOyAvLyBOb3QgbmVjZXNzYXJ5LCBidXQgZGVsZXRpbmcgdGhlIElEIG9mIGF1Y3Rpb24gZW50aXR5IHdoaWNoIHdhcyBkZWxldGVkIGluIHRoZSBvcGVyYXRpb24gYWJvdmUKICAgICAgICAKICAgICAgICBFdmVudENhbmNlbEF1Y3Rpb24gKF90YW5rSUQpOwogICAgfQogICAgCiAgICAKICAgIGZ1bmN0aW9uIG5ld1RhbmtQcm9kdWN0IChzdHJpbmcgX25hbWUsIHVpbnQzMiBfaHVsbCwgdWludDMyIF93ZWFwb24sIHVpbnQyNTYgX3ByaWNlLCB1aW50MjU2IF9lYXJuaW5nLCB1aW50MjU2IF9yZWxlYXNlVGltZSkgcHJpdmF0ZSB7CiAgICAgICAgdGFua1Byb2R1Y3RzW25ld0lkVGFua1Byb2R1Y3QrK10gPSBUYW5rUHJvZHVjdChfbmFtZSwgX2h1bGwsIF93ZWFwb24sIF9wcmljZSwgX3ByaWNlLCBfZWFybmluZywgX3JlbGVhc2VUaW1lLCAwKTsKICAgICAgICAKICAgICAgICBFdmVudFByb2R1Y3QgKG5ld0lkVGFua1Byb2R1Y3QtMSwgX25hbWUsIF9odWxsLCBfd2VhcG9uLCBfcHJpY2UsIF9lYXJuaW5nLCBfcmVsZWFzZVRpbWUsIG5vdyk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIG5ld1RhbmtIdWxsICh1aW50MzIgX2FybW9yLCB1aW50MzIgX3NwZWVkLCB1aW50OCBfbGVhZ3VlKSBwcml2YXRlIHsKICAgICAgICB0YW5rSHVsbHNbbmV3SWRUYW5rSHVsbCsrXSA9IFRhbmtIdWxsKF9hcm1vciwgX3NwZWVkLCBfbGVhZ3VlKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gbmV3VGFua1dlYXBvbiAodWludDMyIF9taW5EYW1hZ2UsIHVpbnQzMiBfbWF4RGFtYWdlLCB1aW50MzIgX2F0dGFja1NwZWVkLCB1aW50OCBfbGVhZ3VlKSBwcml2YXRlIHsKICAgICAgICB0YW5rV2VhcG9uc1tuZXdJZFRhbmtXZWFwb24rK10gPSBUYW5rV2VhcG9uKF9taW5EYW1hZ2UsIF9tYXhEYW1hZ2UsIF9hdHRhY2tTcGVlZCwgX2xlYWd1ZSk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGV4cG9ydFRhbmsgKGFkZHJlc3MgX293bmVyLCB1aW50MzIgX3Rhbmtwcm9kdWN0SUQpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZSAoY2FuRXhwb3J0ID09IHRydWUpOyAvLyBDYW4gYmUgY2FsbGVkIG9ubHkgaWYgdGhlIHByb2Nlc3Mgb2YgZXhwb3J0aW5nIGlzIGFsbG93ZWQKICAgICAgICByZXF1aXJlIChtc2cuc2VuZGVyID09IEV4cG9ydE1hc3Rlcik7IC8vIFRoaXMgaXMgd2hhdCB3YXMgbWlzc2VkIGJlZm9yZS4gQWxsIGJhbGFuY2VzIHdlcmUgcmV0dXJuZWQuCiAgICAgICAgdGFua1Byb2R1Y3RzW190YW5rcHJvZHVjdElEXS5jdXJyZW50UHJpY2UgKz0gdGFua1Byb2R1Y3RzW190YW5rcHJvZHVjdElEXS5lYXJuaW5nOwogICAgICAgIHRhbmtzW25ld0lkVGFuaysrXSA9IFRhbmtFbnRpdHkgKF90YW5rcHJvZHVjdElELCBbMCwgMCwgMCwgMF0sIF9vd25lciwgX293bmVyLCBmYWxzZSwgMCwgMCwgMCwgKyt0YW5rUHJvZHVjdHNbX3Rhbmtwcm9kdWN0SURdLmFtb3VudE9mVGFua3MpOwogICAgICAgIAogICAgICAgIGlmICh0YW5rc0JlZm9yZVRoZU5ld1RhbmtUeXBlKCkgPT0gMCAmJiBuZXdJZFRhbmtQcm9kdWN0IDw9IDEyMSl7CiAgICAgICAgICAgIG5ld1RhbmtUeXBlKCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEV2ZW50QnV5VGFuayAoX293bmVyLCBfdGFua3Byb2R1Y3RJRCwgbmV3SWRUYW5rLTEpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBleHBvcnRUYW5rUmVzZXRFYXJuaW5nICh1aW50MzIgX3RhbmtJRCkgcHVibGljIHsKICAgICAgICAvLyBCZWNhdXNlLCBiZWZvcmUgdGhlIGV4cG9ydGluZywgd2UgYWxyZWFkeSBwYXllZCBhbGwgZWFybmluZ3MKICAgICAgICByZXF1aXJlIChjYW5FeHBvcnQgPT0gdHJ1ZSk7IC8vIENhbiBiZSBjYWxsZWQgb25seSBpZiB0aGUgcHJvY2VzcyBvZiBleHBvcnRpbmcgaXMgYWxsb3dlZAogICAgICAgIHJlcXVpcmUgKG1zZy5zZW5kZXIgPT0gRXhwb3J0TWFzdGVyKTsgLy8gVGhpcyBpcyB3aGF0IHdhcyBtaXNzZWQgYmVmb3JlLiBBbGwgYmFsYW5jZXMgd2VyZSByZXR1cm5lZC4KICAgICAgICAKICAgICAgICB0YW5rc1tfdGFua0lEXS5sYXN0Q2FzaG91dEluZGV4ID0gdGFua1Byb2R1Y3RzW3RhbmtzW190YW5rSURdLnByb2R1Y3RJRF0uYW1vdW50T2ZUYW5rczsgLy8gUmVzZXRpbmcgdGhlIHRhbmsncyBlYXJuaW5ncwogICAgCiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGJ1eVRhbmsgKHVpbnQzMiBfdGFua3Byb2R1Y3RJRCkgcHVibGljIHBheWFibGUgewogICAgICAgIHJlcXVpcmUgKGNhbkV4cG9ydCA9PSBmYWxzZSk7IC8vIENhbiBiZSBjYWxsZWQgb25seSBpZiB0aGUgcHJvY2VzcyBvZiBleHBvcnRpbmcgaGFzIGJlZW4gY29tcGxldGVkCiAgICAgICAgcmVxdWlyZSAodGFua1Byb2R1Y3RzW190YW5rcHJvZHVjdElEXS5jdXJyZW50UHJpY2UgPiAwICYmIG1zZy52YWx1ZSA+IDApOyAvL3ZhbHVlIGlzIG1vcmUgdGhhbiAwLCBwcmljZSBpcyBtb3JlIHRoYW4gMAogICAgICAgIHJlcXVpcmUgKG1zZy52YWx1ZSA+PSB0YW5rUHJvZHVjdHNbX3Rhbmtwcm9kdWN0SURdLmN1cnJlbnRQcmljZSk7IC8vdmFsdWUgaXMgaGlnaGVyIHRoYW4gcHJpY2UKICAgICAgICByZXF1aXJlICh0YW5rUHJvZHVjdHNbX3Rhbmtwcm9kdWN0SURdLnJlbGVhc2VUaW1lIDw9IG5vdyk7IC8vY2hlY2tpbmcgaWYgdGhpcyB0YW5rIHdhcyByZWxlYXNlZC4KICAgICAgICAvLyBCYXNpY2FsbHksIHRoZSByZWxlYXNlVGltZSB3YXMgaW1wbGVtZW50ZWQganVzdCB0byBnaXZlIGEgY2hhbmNlIHRvIGdldCB0aGUgbmV3IHRhbmsgZm9yIGFzIG1hbnkgcGxheWVycyBhcyBwb3NzaWJsZS4KICAgICAgICAvLyBJdCBwcmV2ZW50cyB0aGUgdXNpbmcgb2YgYm90cy4KICAgICAgICAKICAgICAgICBpZiAobXNnLnZhbHVlID4gdGFua1Byb2R1Y3RzW190YW5rcHJvZHVjdElEXS5jdXJyZW50UHJpY2UpewogICAgICAgICAgICAvLyBJZiBwbGF5ZXIgcGF5ZWQgbW9yZSwgcHV0IHRoZSByZXN0IGFtb3VudCBvZiBtb25leSBvbiBoaXMgYmFsYW5jZQogICAgICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSArPSBtc2cudmFsdWUtdGFua1Byb2R1Y3RzW190YW5rcHJvZHVjdElEXS5jdXJyZW50UHJpY2U7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHRhbmtQcm9kdWN0c1tfdGFua3Byb2R1Y3RJRF0uY3VycmVudFByaWNlICs9IHRhbmtQcm9kdWN0c1tfdGFua3Byb2R1Y3RJRF0uZWFybmluZzsKICAgICAgICAKICAgICAgICAvKmZvciAodWludDMyIGluZGV4ID0gMTsgaW5kZXggPCBuZXdJZFRhbms7IGluZGV4KyspewogICAgICAgICAgICBpZiAodGFua3NbaW5kZXhdLnByb2R1Y3RJRCA9PSBfdGFua3Byb2R1Y3RJRCl7CiAgICAgICAgICAgICAgICBiYWxhbmNlc1t0YW5rc1tpbmRleF0uZWFybmVyXSArPSB0YW5rUHJvZHVjdHNbX3Rhbmtwcm9kdWN0SURdLmVhcm5pbmc7CiAgICAgICAgICAgICAgICB0YW5rc1tpbmRleF0uZWFybmVkICs9IHRhbmtQcm9kdWN0c1tfdGFua3Byb2R1Y3RJRF0uZWFybmluZzsKICAgICAgICAgICAgfQogICAgICAgIH0qLwogICAgICAgIC8vIFRoaXMgaXMgd2h5IHdlIGRlY2lkZWQgdG8gY3JlYXRlIHRoZSBuZXcgY29udHJhY3QgLSB0byBhdm9pZCBsb29wcy4gT3VyIHN1Z2dlc3Rpb24gdG8geW91OiBORVZFUiBFVkVSIFVTRSBMT09QUyBJTiBTTUFSVC1DT05UUkFDVFMKICAgICAgICAKICAgICAgICBpZiAodGFua3NCZWZvcmVUaGVOZXdUYW5rVHlwZSgpID09IDAgJiYgbmV3SWRUYW5rUHJvZHVjdCA8PSAxMjEpewogICAgICAgICAgICBuZXdUYW5rVHlwZSgpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICB0YW5rc1tuZXdJZFRhbmsrK10gPSBUYW5rRW50aXR5IChfdGFua3Byb2R1Y3RJRCwgWzAsIDAsIDAsIDBdLCBtc2cuc2VuZGVyLCBtc2cuc2VuZGVyLCBmYWxzZSwgMCwgMCwgMCwgKyt0YW5rUHJvZHVjdHNbX3Rhbmtwcm9kdWN0SURdLmFtb3VudE9mVGFua3MpOwoKICAgICAgICAvLyBBZnRlciBhbGwgb3duZXJzIG9mIHRoZSBzYW1lIHR5cGUgb2YgdGFuayBnb3QgdGhlaXIgZWFybmluZ3MsIGFkbWlucyBnZXQgdGhlIGFtb3VudCB3aGljaCByZW1haW5zIGFuZCBubyBvbmUgbmVlZCBpdAogICAgICAgIC8vIEJhc2ljYWxseSwgaXQgaXMgdGhlIHN0YXJ0IHByaWNlIG9mIHRoZSB0YW5rLgogICAgICAgIGJhbGFuY2VzW1RhbmtTZWxsTWFzdGVyXSArPSB0YW5rUHJvZHVjdHNbX3Rhbmtwcm9kdWN0SURdLnN0YXJ0UHJpY2U7CiAgICAgICAgCiAgICAgICAgRXZlbnRCdXlUYW5rIChtc2cuc2VuZGVyLCBfdGFua3Byb2R1Y3RJRCwgbmV3SWRUYW5rLTEpOwogICAgICAgIHJldHVybjsKICAgIH0KICAgIAogICAgLy8gVGhpcyBpcyB0aGUgdHJpY2t5IG1ldGhvZCB3aGljaCBjcmVhdGVzIHRoZSBuZXcgdHlwZSB0YW5rLgogICAgZnVuY3Rpb24gbmV3VGFua1R5cGUgKCkgcHJpdmF0ZSB7CiAgICAgICAgaWYgKG5ld0lkVGFua1Byb2R1Y3QgPiAxMjEpewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIC8vY3JlYXRpbmcgbmV3IHRhbmsgdHlwZSEKICAgICAgICBpZiAoY3JlYXRlTmV3VGFua0h1bGwgPCBuZXdJZFRhbmtIdWxsIC0gMSAmJiBjcmVhdGVOZXdUYW5rV2VhcG9uID49IG5ld0lkVGFua1dlYXBvbiAtIDEpIHsKICAgICAgICAgICAgY3JlYXRlTmV3VGFua1dlYXBvbiA9IDE7CiAgICAgICAgICAgIGNyZWF0ZU5ld1RhbmtIdWxsKys7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY3JlYXRlTmV3VGFua1dlYXBvbisrOwogICAgICAgICAgICBpZiAoY3JlYXRlTmV3VGFua0h1bGwgPT0gY3JlYXRlTmV3VGFua1dlYXBvbikgewogICAgICAgICAgICAgICAgY3JlYXRlTmV3VGFua1dlYXBvbisrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIG5ld1RhbmtQcm9kdWN0ICgiVGFuayIsIHVpbnQzMihjcmVhdGVOZXdUYW5rSHVsbCksIHVpbnQzMihjcmVhdGVOZXdUYW5rV2VhcG9uKSwgMjAwMDAwMDAwMDAwMDAwMDAwLCAzMDAwMDAwMDAwMDAwMDAwLCBub3crKDYwKjYwKSk7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgCiAgICAvLyBPdXIgc3RvcmFnZSwga2V5cyBhcmUgbGlzdGVkIGZpcnN0LCB0aGVuIG1hcHBpbmdzLgogICAgLy8gT2YgY291cnNlLCBpbnN0ZWFkIG9mIHNvbWUgbWFwcGluZ3Mgd2UgY291bGQgdXNlIGFycmF5cywgYnV0IHdoeSBub3QKICAgIAogICAgdWludDMyIHB1YmxpYyBuZXdJZFRhbmsgPSAxOyAvLyBUaGUgbmV4dCBJRCBmb3IgdGhlIG5ldyB0YW5rCiAgICB1aW50MzIgcHVibGljIG5ld0lkVGFua1Byb2R1Y3QgPSAxOyAvLyBUaGUgbmV4dCBJRCBmb3IgdGhlIG5ldyB0YW5rIHR5cGUKICAgIHVpbnQzMiBwdWJsaWMgbmV3SWRUYW5rSHVsbCA9IDE7IC8vIFRoZSBuZXh0IElEIGZvciB0aGUgbmV3IGh1bGwKICAgIHVpbnQzMiBwdWJsaWMgbmV3SWRUYW5rV2VhcG9uID0gMTsgLy8gVGhlIG5ldyBJRCBmb3IgdGhlIG5ldyB3ZWFwb24KICAgIHVpbnQzMiBwdWJsaWMgY3JlYXRlTmV3VGFua0h1bGwgPSAxOyAvLyBGb3IgbmV3VGFua1R5cGUoKQogICAgdWludDMyIHB1YmxpYyBjcmVhdGVOZXdUYW5rV2VhcG9uID0gMDsgLy8gRm9yIG5ld1RhbmtUeXBlKCkKICAgIHVpbnQyNTYgcHVibGljIG5ld0lkQXVjdGlvbkVudGl0eSA9IDE7IC8vIFRoZSBuZXh0IElEIGZvciB0aGUgbmV3IGF1Y3Rpb24gZW50aXR5CgogICAgbWFwcGluZyAodWludDMyID0+IFRhbmtFbnRpdHkpIHRhbmtzOyAvLyBUaGUgc3RvcmFnZSAKICAgIG1hcHBpbmcgKHVpbnQzMiA9PiBUYW5rUHJvZHVjdCkgdGFua1Byb2R1Y3RzOwogICAgbWFwcGluZyAodWludDMyID0+IFRhbmtIdWxsKSB0YW5rSHVsbHM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQzMltdKSB0YW5rT3duZXJzOwogICAgbWFwcGluZyAodWludDMyID0+IFRhbmtXZWFwb24pIHRhbmtXZWFwb25zOwogICAgbWFwcGluZyAodWludDI1NiA9PiBBdWN0aW9uRW50aXR5KSBhdWN0aW9uczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgYmFsYW5jZXM7CgogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgdXBncmFkZVByaWNlID0gNTAwMDAwMDAwMDAwMDAwMDA7IC8vIFRoZSBmZWUgd2hpY2ggdGhlIFVncmFkZU1hc3RlciBlYXJucyBmb3IgdXBncmFkaW5nIHRhbmtzCgogICAgZnVuY3Rpb24gZ2V0VGFua05hbWUgKHVpbnQzMiBfSUQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChzdHJpbmcpewogICAgICAgIHJldHVybiB0YW5rUHJvZHVjdHNbX0lEXS5uYW1lOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRUYW5rUHJvZHVjdCAodWludDMyIF9JRCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQzMls2XSl7CiAgICAgICAgcmV0dXJuIFt0YW5rSHVsbHNbdGFua1Byb2R1Y3RzW19JRF0uaHVsbF0uYXJtb3IsIHRhbmtIdWxsc1t0YW5rUHJvZHVjdHNbX0lEXS5odWxsXS5zcGVlZCwgdGFua1dlYXBvbnNbdGFua1Byb2R1Y3RzW19JRF0ud2VhcG9uXS5taW5EYW1hZ2UsIHRhbmtXZWFwb25zW3RhbmtQcm9kdWN0c1tfSURdLndlYXBvbl0ubWF4RGFtYWdlLCB0YW5rV2VhcG9uc1t0YW5rUHJvZHVjdHNbX0lEXS53ZWFwb25dLmF0dGFja1NwZWVkLCB1aW50MzIodGFua1Byb2R1Y3RzW19JRF0ucmVsZWFzZVRpbWUpXTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0VGFua0RldGFpbHMgKHVpbnQzMiBfSUQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MzJbNl0pewogICAgICAgIHJldHVybiBbdGFua3NbX0lEXS5wcm9kdWN0SUQsIHVpbnQzMih0YW5rc1tfSURdLnVwZ3JhZGVzWzBdKSwgdWludDMyKHRhbmtzW19JRF0udXBncmFkZXNbMV0pLCB1aW50MzIodGFua3NbX0lEXS51cGdyYWRlc1syXSksIHVpbnQzMih0YW5rc1tfSURdLnVwZ3JhZGVzWzNdKSwgdWludDMyKHRhbmtzW19JRF0uZXhwKV07CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldFRhbmtPd25lcih1aW50MzIgX0lEKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcyl7CiAgICAgICAgcmV0dXJuIHRhbmtzW19JRF0ub3duZXI7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldFRhbmtTZWxsKHVpbnQzMiBfSUQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKXsKICAgICAgICByZXR1cm4gdGFua3NbX0lEXS5zZWxsaW5nOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRUYW5rVG90YWxFYXJuZWQodWludDMyIF9JRCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpewogICAgICAgIHJldHVybiB0YW5rc1tfSURdLmVhcm5lZDsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0VGFua0F1Y3Rpb25FbnRpdHkgKHVpbnQzMiBfSUQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KXsKICAgICAgICByZXR1cm4gdGFua3NbX0lEXS5hdWN0aW9uRW50aXR5OwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRDdXJyZW50UHJpY2UgKHVpbnQzMiBfSUQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KXsKICAgICAgICByZXR1cm4gdGFua1Byb2R1Y3RzW19JRF0uY3VycmVudFByaWNlOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRQcm9kdWN0RWFybmluZyAodWludDMyIF9JRCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpewogICAgICAgIHJldHVybiB0YW5rUHJvZHVjdHNbX0lEXS5lYXJuaW5nOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRUYW5rRWFybmluZyAodWludDMyIF9JRCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpewogICAgICAgIHJldHVybiB0YW5rUHJvZHVjdHNbdGFua3NbX0lEXS5wcm9kdWN0SURdLmVhcm5pbmcqKHRhbmtQcm9kdWN0c1t0YW5rc1tfSURdLnByb2R1Y3RJRF0uYW1vdW50T2ZUYW5rcy10YW5rc1tfSURdLmxhc3RDYXNob3V0SW5kZXgpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRDdXJyZW50UHJpY2VBdWN0aW9uICh1aW50MzIgX0lEKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nil7CiAgICAgICAgcmVxdWlyZSAoZ2V0VGFua1NlbGwoX0lEKSk7CiAgICAgICAgQXVjdGlvbkVudGl0eSBtZW1vcnkgY3VycmVudEF1Y3Rpb24gPSBhdWN0aW9uc1t0YW5rc1tfSURdLmF1Y3Rpb25FbnRpdHldOyAvLyBUaGUgYXVjdGlvbiBlbnRpdHkgZm9yIHRoaXMgdGFuay4gSnVzdCB0byBtYWtlIHRoZSBsaW5lIGJlbG93IGVhc2llciB0byByZWFkCiAgICAgICAgdWludDI1NiBjdXJyZW50UHJpY2UgPSBjdXJyZW50QXVjdGlvbi5zdGFydFByaWNlLSgoKGN1cnJlbnRBdWN0aW9uLnN0YXJ0UHJpY2UtY3VycmVudEF1Y3Rpb24uZmluaXNoUHJpY2UpLyhjdXJyZW50QXVjdGlvbi5kdXJhdGlvbikpKihub3ctY3VycmVudEF1Y3Rpb24uc3RhcnRUaW1lKSk7CiAgICAgICAgaWYgKGN1cnJlbnRQcmljZSA8IGN1cnJlbnRBdWN0aW9uLmZpbmlzaFByaWNlKXsgLy8gSWYgdGhlIGF1Y3Rpb24gZHVyYXRpb24gdGltZSBoYXMgYmVlbiBleHBpcmVkCiAgICAgICAgICAgIGN1cnJlbnRQcmljZSA9IGN1cnJlbnRBdWN0aW9uLmZpbmlzaFByaWNlOyAgLy8gU2V0dGluZyB0aGUgY3VycmVudCBwcmljZSBhcyBmaW5pc2hQcmljZSAKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGN1cnJlbnRQcmljZTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0UGxheWVyQmFsYW5jZShhZGRyZXNzIF9wbGF5ZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KXsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX3BsYXllcl07CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldENvbnRyYWN0QmFsYW5jZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KXsKICAgICAgICByZXR1cm4gdGhpcy5iYWxhbmNlOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBob3dNYW55VGFua3MoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDMyKXsKICAgICAgICByZXR1cm4gbmV3SWRUYW5rUHJvZHVjdDsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gdGFua3NCZWZvcmVUaGVOZXdUYW5rVHlwZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KXsKICAgICAgICByZXR1cm4gMTAwMCsoKChuZXdJZFRhbmtQcm9kdWN0KSsxMCkqKChuZXdJZFRhbmtQcm9kdWN0KSsxMCkqKG5ld0lkVGFua1Byb2R1Y3QtMTEpKS1uZXdJZFRhbms7CiAgICB9Cn0KCi8qCiAgICBUaGUgcHJldmlvdXMgY29udHJhY3QgYWRkcmVzc2VzOiAKICAgIAogICAgU2Vjb25kIGFkZHJlc3M6IDB4ZWY4YTU2MGZhMTlmMjY5ODJjMjdjNzgxMDE1NDViOGZlMzAxODIzNwogICAgRmlyc3QgYWRkcmVzczogMHhjYTUwODg0NDliOTZjMjI1ODAxY2VkOGU5ZWZkY2FlMWUwYzkyYTNkCiAgICAKICAgIEJ5IHRoZSB3YXksIHdlIGFyZSB2ZXJ5IHRoYW5rZnVsIHRoYXQgeW91IHN1cHBvcnQgdXMhIAogICAgCiAgICBFdGhlclRhbmtzLmNvbQogICAgRXRoZXJlVGFua3MuY29tCiov'.
	

]
