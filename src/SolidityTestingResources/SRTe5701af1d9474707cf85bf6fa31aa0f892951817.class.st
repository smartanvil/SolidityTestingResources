Class {
	#name : #SRTe5701af1d9474707cf85bf6fa31aa0f892951817,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTe5701af1d9474707cf85bf6fa31aa0f892951817 >> base64 [
	^ 'Ly8gUGl4ZWxDb2lucyBTb3VyY2UgY29kZQpwcmFnbWEgc29saWRpdHkgXjAuNC4xMTsKCi8vLyBAdGl0bGUgSW50ZXJmYWNlIGZvciBjb250cmFjdHMgY29uZm9ybWluZyB0byBFUkMtNzIxOiBOb24tRnVuZ2libGUgVG9rZW5zCi8vLyBAYXV0aG9yIERpZXRlciBTaGlybGV5IDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImFmY2JjYWRiY2FlZmNlZDdjNmMwYzJkNWNhYzE4MWNjYzAiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+PiAoaHR0cHM6Ly9naXRodWIuY29tL2RldGUpCmNvbnRyYWN0IEVSQzcyMSB7CiAgICAvLyBSZXF1aXJlZCBtZXRob2RzCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgdG90YWwpOwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwogICAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF90b2tlbklkKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGFkZHJlc3Mgb3duZXIpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsOwoKICAgIC8vIEV2ZW50cwogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHRva2VuSWQpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBhcHByb3ZlZCwgdWludDI1NiB0b2tlbklkKTsKCiAgICAvLyBPcHRpb25hbAogICAgLy8gZnVuY3Rpb24gbmFtZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZyBuYW1lKTsKICAgIC8vIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZyBzeW1ib2wpOwogICAgLy8gZnVuY3Rpb24gdG9rZW5zT2ZPd25lcihhZGRyZXNzIF9vd25lcikgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2W10gdG9rZW5JZHMpOwogICAgLy8gZnVuY3Rpb24gdG9rZW5NZXRhZGF0YSh1aW50MjU2IF90b2tlbklkLCBzdHJpbmcgX3ByZWZlcnJlZFRyYW5zcG9ydCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nIGluZm9VcmwpOwoKICAgIC8vIEVSQy0xNjUgQ29tcGF0aWJpbGl0eSAoaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE2NSkKICAgIGZ1bmN0aW9uIHN1cHBvcnRzSW50ZXJmYWNlKGJ5dGVzNCBfaW50ZXJmYWNlSUQpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCk7Cn0KCgovLy8gQHRpdGxlIEEgZmFjZXQgb2YgUGl4ZWxDb3JlIHRoYXQgbWFuYWdlcyBzcGVjaWFsIGFjY2VzcyBwcml2aWxlZ2VzLgovLy8gQGF1dGhvciBPbGl2ZXIgU2NobmVpZGVyIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjBhNjM2NDZjNjU0YTdhNjM3MjZmNjY2OTY1NjM2NDc5MjQ2MzY1Ij5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4gKGh0dHBzOi8vcGl4ZWxjb2lucy5pbykKY29udHJhY3QgUGl4ZWxBdXRob3JpdHkgewoKICAgIC8vLyBAZGV2IEVtaXRlZCB3aGVuIGNvbnRyYWN0IGlzIHVwZ3JhZGVkCiAgICBldmVudCBDb250cmFjdFVwZ3JhZGUoYWRkcmVzcyBuZXdDb250cmFjdCk7CgogICAgYWRkcmVzcyBwdWJsaWMgYXV0aG9yaXR5QWRkcmVzczsKICAgIHVpbnQgcHVibGljIGF1dGhvcml0eUJhbGFuY2UgPSAwOwoKICAgIC8vLyBAZGV2IEFjY2VzcyBtb2RpZmllciBmb3IgYXV0aG9yaXR5LW9ubHkgZnVuY3Rpb25hbGl0eQogICAgbW9kaWZpZXIgb25seUF1dGhvcml0eSgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYXV0aG9yaXR5QWRkcmVzcyk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLy8gQGRldiBBc3NpZ25zIGEgbmV3IGFkZHJlc3MgdG8gYWN0IGFzIHRoZSBhdXRob3JpdHkuIE9ubHkgYXZhaWxhYmxlIHRvIHRoZSBjdXJyZW50IGF1dGhvcml0eS4KICAgIC8vLyBAcGFyYW0gX25ld0F1dGhvcml0eSBUaGUgYWRkcmVzcyBvZiB0aGUgbmV3IGF1dGhvcml0eQogICAgZnVuY3Rpb24gc2V0QXV0aG9yaXR5KGFkZHJlc3MgX25ld0F1dGhvcml0eSkgZXh0ZXJuYWwgb25seUF1dGhvcml0eSB7CiAgICAgICAgcmVxdWlyZShfbmV3QXV0aG9yaXR5ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIGF1dGhvcml0eUFkZHJlc3MgPSBfbmV3QXV0aG9yaXR5OwogICAgfQoKfQoKCi8vLyBAdGl0bGUgQmFzZSBjb250cmFjdCBmb3IgUGl4ZWxDb2lucy4gSG9sZHMgYWxsIGNvbW1vbiBzdHJ1Y3RzLCBldmVudHMgYW5kIGJhc2UgdmFyaWFibGVzLgovLy8gQGF1dGhvciBPbGl2ZXIgU2NobmVpZGVyIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImM4YTFhNmFlYTc4OGI4YTFiMGFkYTRhYmE3YTFhNmJiZTZhMWE3Ij5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4gKGh0dHBzOi8vcGl4ZWxjb2lucy5pbykKLy8vIEBkZXYgU2VlIHRoZSBQaXhlbENvcmUgY29udHJhY3QgZG9jdW1lbnRhdGlvbiB0byB1bmRlcnN0YW5kIGhvdyB0aGUgdmFyaW91cyBjb250cmFjdCBmYWNldHMgYXJlIGFycmFuZ2VkLgpjb250cmFjdCBQaXhlbEJhc2UgaXMgUGl4ZWxBdXRob3JpdHkgewogICAgLyoqKiBFVkVOVFMgKioqLwoKICAgIC8vLyBAZGV2IFRyYW5zZmVyIGV2ZW50IGFzIGRlZmluZWQgaW4gY3VycmVudCBkcmFmdCBvZiBFUkM3MjEuIEVtaXR0ZWQgZXZlcnkgdGltZSBhIFBpeGVsCiAgICAvLy8gIG93bmVyc2hpcCBpcyBhc3NpZ25lZC4KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB0b2tlbklkKTsKCiAgICAvKioqIENPTlNUQU5UUyAqKiovCiAgICB1aW50MzIgcHVibGljIFdJRFRIID0gMTAwMDsKICAgIHVpbnQzMiBwdWJsaWMgSEVJR0hUID0gMTAwMDsKCiAgICAvKioqIFNUT1JBR0UgKioqLwogICAgLy8vIEBkZXYgQSBtYXBwaW5nIGZyb20gcGl4ZWwgaWRzIHRvIHRoZSBhZGRyZXNzIHRoYXQgb3ducyB0aGVtLiBBIHBpeGVsIGFkZHJlc3Mgb2YgMCBtZWFucywKICAgIC8vLyB0aGF0IHRoZSBwaXhlbCBjYW4gc3RpbGwgYmUgYm91Z2h0LgogICAgbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSBwdWJsaWMgcGl4ZWxJbmRleFRvT3duZXI7CiAgICAvLy8gQWRkcmVzcyB0aGF0IGlzIGFwcHJvdmVkIHRvIGNoYW5nZSBvd25zaGlwCiAgICBtYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIHB1YmxpYyBwaXhlbEluZGV4VG9BcHByb3ZlZDsKICAgIC8vLyBTdG9yZXMgdGhlIGNvbG9yIG9mIGFuIHBpeGVsLCBpbmRleGVkIGJ5IHBpeGVsaWQKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gdWludDMyKSBwdWJsaWMgY29sb3JzOwogICAgLy8gQGRldiBBIG1hcHBpbmcgZnJvbSBvd25lciBhZGRyZXNzIHRvIGNvdW50IG9mIHRva2VucyB0aGF0IGFkZHJlc3Mgb3ducy4KICAgIC8vICBVc2VkIGludGVybmFsbHkgaW5zaWRlIGJhbGFuY2VPZigpIHRvIHJlc29sdmUgb3duZXJzaGlwIGNvdW50LgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBvd25lcnNoaXBUb2tlbkNvdW50OwoKICAgIC8vIEludGVybmFsIHV0aWxpdHkgZnVuY3Rpb25zOiBUaGVzZSBmdW5jdGlvbnMgYWxsIGFzc3VtZSB0aGF0IHRoZWlyIGlucHV0IGFyZ3VtZW50cwogICAgLy8gYXJlIHZhbGlkLiBXZSBsZWF2ZSBpdCB0byBwdWJsaWMgbWV0aG9kcyB0byBzYW5pdGl6ZSB0aGVpciBpbnB1dHMgYW5kIGZvbGxvdwogICAgLy8gdGhlIHJlcXVpcmVkIGxvZ2ljLgoKICAgIC8vLyBAZGV2IEFzc2lnbnMgb3duZXJzaGlwIG9mIGEgc3BlY2lmaWMgUGl4ZWwgdG8gYW4gYWRkcmVzcy4KICAgIGZ1bmN0aW9uIF90cmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgaW50ZXJuYWwgewogICAgICAgIC8vIENhbiBubyBvdmVyZmxvd2Ugc2luY2UgdGhlIG51bWJlciBvZiBQaXhlbHMgaXMgY2FwcGVkLgogICAgICAgIC8vIHRyYW5zZmVyIG93bmVyc2hpcAogICAgICAgIG93bmVyc2hpcFRva2VuQ291bnRbX3RvXSsrOwogICAgICAgIHBpeGVsSW5kZXhUb093bmVyW190b2tlbklkXSA9IF90bzsKICAgICAgICBpZiAoX2Zyb20gIT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICBvd25lcnNoaXBUb2tlbkNvdW50W19mcm9tXS0tOwogICAgICAgICAgICBkZWxldGUgcGl4ZWxJbmRleFRvQXBwcm92ZWRbX3Rva2VuSWRdOwogICAgICAgIH0KICAgICAgICAvLyBFbWl0IHRoZSB0cmFuc2ZlciBldmVudC4KICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgLy8vIEBkZXYgQ2hlY2tzIGlmIGEgZ2l2ZW4gYWRkcmVzcyBpcyB0aGUgY3VycmVudCBvd25lciBvZiBhIHBhcnRpY3VsYXIgUGl4ZWwuCiAgICAvLy8gQHBhcmFtIF9jbGFpbWFudCB0aGUgYWRkcmVzcyB3ZSBhcmUgdmFsaWRhdGluZyBhZ2FpbnN0LgogICAgLy8vIEBwYXJhbSBfdG9rZW5JZCBQaXhlbCBpZAogICAgZnVuY3Rpb24gX293bnMoYWRkcmVzcyBfY2xhaW1hbnQsIHVpbnQyNTYgX3Rva2VuSWQpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBwaXhlbEluZGV4VG9Pd25lcltfdG9rZW5JZF0gPT0gX2NsYWltYW50OwogICAgfQoKICAgIC8vLyBAZGV2IENoZWNrcyBpZiBhIGdpdmVuIGFkZHJlc3MgY3VycmVudGx5IGhhcyB0cmFuc2ZlckFwcHJvdmFsIGZvciBhIHBhcnRpY3VsYXIgUGl4ZWwuCiAgICAvLy8gQHBhcmFtIF9jbGFpbWFudCB0aGUgYWRkcmVzcyB3ZSBhcmUgY29uZmlybWluZyBwaXhlbCBpcyBhcHByb3ZlZCBmb3IuCiAgICAvLy8gQHBhcmFtIF90b2tlbklkIHBpeGVsIGlkLCBvbmx5IHZhbGlkIHdoZW4gPiAwCiAgICBmdW5jdGlvbiBfYXBwcm92ZWRGb3IoYWRkcmVzcyBfY2xhaW1hbnQsIHVpbnQyNTYgX3Rva2VuSWQpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBwaXhlbEluZGV4VG9BcHByb3ZlZFtfdG9rZW5JZF0gPT0gX2NsYWltYW50OwogICAgfQp9CgoKLy8vIEB0aXRsZSBUaGUgZmFjZXQgb2YgdGhlIFBpeGVsQ29pbnMgY29yZSBjb250cmFjdCB0aGF0IG1hbmFnZXMgb3duZXJzaGlwLCBFUkMtNzIxIChkcmFmdCkgY29tcGxpYW50LgovLy8gQGF1dGhvciBPbGl2ZXIgU2NobmVpZGVyIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImI5ZDBkN2RmZDZmOWM5ZDBjMWRjZDVkYWQ2ZDBkN2NhOTdkMGQ2Ij5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4gKGh0dHBzOi8vcGl4ZWxjb2lucy5pbyksIGJhc2VkIG9uIEF4aW9tIFplbiAoaHR0cHM6Ly93d3cuYXhpb216ZW4uY28pCi8vLyBAZGV2IFJlZjogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzcyMQovLy8gIFNlZSB0aGUgUGl4ZWxDb3JlIGNvbnRyYWN0IGRvY3VtZW50YXRpb24gdG8gdW5kZXJzdGFuZCBob3cgdGhlIHZhcmlvdXMgY29udHJhY3QgZmFjZXRzIGFyZSBhcnJhbmdlZC4KY29udHJhY3QgUGl4ZWxPd25lcnNoaXAgaXMgUGl4ZWxCYXNlLCBFUkM3MjEgewoKICAgIC8vLyBAbm90aWNlIE5hbWUgYW5kIHN5bWJvbCBvZiB0aGUgbm9uIGZ1bmdpYmxlIHRva2VuLCBhcyBkZWZpbmVkIGluIEVSQzcyMS4KICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJQaXhlbENvaW5zIjsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIlBYTCI7CgoKICAgIGJ5dGVzNCBjb25zdGFudCBJbnRlcmZhY2VTaWduYXR1cmVfRVJDMTY1ID0KICAgICAgICBieXRlczQoa2VjY2FrMjU2KCdzdXBwb3J0c0ludGVyZmFjZShieXRlczQpJykpOwoKICAgIGJ5dGVzNCBjb25zdGFudCBJbnRlcmZhY2VTaWduYXR1cmVfRVJDNzIxID0KICAgICAgICBieXRlczQoa2VjY2FrMjU2KCduYW1lKCknKSkgXgogICAgICAgIGJ5dGVzNChrZWNjYWsyNTYoJ3N5bWJvbCgpJykpIF4KICAgICAgICBieXRlczQoa2VjY2FrMjU2KCd0b3RhbFN1cHBseSgpJykpIF4KICAgICAgICBieXRlczQoa2VjY2FrMjU2KCdiYWxhbmNlT2YoYWRkcmVzcyknKSkgXgogICAgICAgIGJ5dGVzNChrZWNjYWsyNTYoJ293bmVyT2YodWludDI1NiknKSkgXgogICAgICAgIGJ5dGVzNChrZWNjYWsyNTYoJ2FwcHJvdmUoYWRkcmVzcyx1aW50MjU2KScpKSBeCiAgICAgICAgYnl0ZXM0KGtlY2NhazI1NigndHJhbnNmZXIoYWRkcmVzcyx1aW50MjU2KScpKSBeCiAgICAgICAgYnl0ZXM0KGtlY2NhazI1NigndHJhbnNmZXJGcm9tKGFkZHJlc3MsYWRkcmVzcyx1aW50MjU2KScpKSBeCiAgICAgICAgYnl0ZXM0KGtlY2NhazI1NigndG9rZW5zT2ZPd25lcihhZGRyZXNzKScpKSBeCiAgICAgICAgYnl0ZXM0KGtlY2NhazI1NigndG9rZW5NZXRhZGF0YSh1aW50MjU2LHN0cmluZyknKSk7CgoKICAgIHN0cmluZyBwdWJsaWMgbWV0YUJhc2VVcmwgPSAiaHR0cHM6Ly9waXhlbGNvaW5zLmlvL21ldGEvIjsKCgogICAgLy8vIEBub3RpY2UgSW50cm9zcGVjdGlvbiBpbnRlcmZhY2UgYXMgcGVyIEVSQy0xNjUgKGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNjUpLgogICAgLy8vICBSZXR1cm5zIHRydWUgZm9yIGFueSBzdGFuZGFyZGl6ZWQgaW50ZXJmYWNlcyBpbXBsZW1lbnRlZCBieSB0aGlzIGNvbnRyYWN0LiBXZSBpbXBsZW1lbnQKICAgIC8vLyAgRVJDLTE2NSAob2J2aW91c2x5ISkgYW5kIEVSQy03MjEuCiAgICBmdW5jdGlvbiBzdXBwb3J0c0ludGVyZmFjZShieXRlczQgX2ludGVyZmFjZUlEKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gKChfaW50ZXJmYWNlSUQgPT0gSW50ZXJmYWNlU2lnbmF0dXJlX0VSQzE2NSkgfHwgKF9pbnRlcmZhY2VJRCA9PSBJbnRlcmZhY2VTaWduYXR1cmVfRVJDNzIxKSk7CiAgICB9CgogICAgLy8vIEBub3RpY2UgUmV0dXJucyB0aGUgbnVtYmVyIG9mZCBQaXhlbHMgb3duZWQgYnkgYSBzcGVjaWZpYyBhZGRyZXNzLgogICAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIG93bmVyIGFkZHJlc3MgdG8gY2hlY2suCiAgICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgY291bnQpIHsKICAgICAgICByZXR1cm4gb3duZXJzaGlwVG9rZW5Db3VudFtfb3duZXJdOwogICAgfQoKICAgIC8vLyBAbm90aWNlIFRyYW5zZmVycyBhIFBpeGVsIHRvIGFub3RoZXIgYWRkcmVzcy4gSWYgdHJhbnNmZXJyaW5nIHRvIGEgc21hcnQKICAgIC8vLyAgY29udHJhY3QgYmUgVkVSWSBDQVJFRlVMIHRvIGVuc3VyZSB0aGF0IGl0IGlzIGF3YXJlIG9mIEVSQy03MjEgKG9yCiAgICAvLy8gIFBpeGVsQ29pbnMgc3BlY2lmaWNhbGx5KSBvciB5b3VyIFBpeGVsIG1heSBiZSBsb3N0IGZvcmV2ZXIuIFNlcmlvdXNseS4KICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQsIGNhbiBiZSBhIHVzZXIgb3IgY29udHJhY3QuCiAgICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSBJRCBvZiB0aGUgUGl4ZWwgdG8gdHJhbnNmZXIuCiAgICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogICAgZnVuY3Rpb24gdHJhbnNmZXIoCiAgICAgICAgYWRkcmVzcyBfdG8sCiAgICAgICAgdWludDI1NiBfdG9rZW5JZAogICAgKQogICAgICAgIGV4dGVybmFsCiAgICB7CiAgICAgICAgLy8gU2FmZXR5IGNoZWNrIHRvIHByZXZlbnQgYWdhaW5zdCBhbiB1bmV4cGVjdGVkIDB4MCBkZWZhdWx0LgogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIC8vIERpc2FsbG93IHRyYW5zZmVycyB0byB0aGlzIGNvbnRyYWN0IHRvIHByZXZlbnQgYWNjaWRlbnRhbCBtaXN1c2UuCiAgICAgICAgLy8gVGhlIGNvbnRyYWN0IHNob3VsZCBuZXZlciBvd24gYW55IHBpeGVsIChleGNlcHQgdmVyeSBicmllZmx5CiAgICAgICAgLy8gYWZ0ZXIgYSBnZW4wIGNhdCBpcyBjcmVhdGVkIGFuZCBiZWZvcmUgaXQgZ29lcyBvbiBhdWN0aW9uKS4KICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKHRoaXMpKTsKCiAgICAgICAgLy8gWW91IGNhbiBvbmx5IHNlbmQgeW91ciBvd24gcGl4ZWwuCiAgICAgICAgcmVxdWlyZShfb3ducyhtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwogICAgICAgIC8vIGFkZHJlc3MgaXMgbm90IGN1cnJlbnRseSBtYW5hZ2VkIGJ5IHRoZSBjb250cmFjdCAoaXQgaXMgaW4gYW4gYXVjdGlvbikKICAgICAgICByZXF1aXJlKHBpeGVsSW5kZXhUb0FwcHJvdmVkW190b2tlbklkXSAhPSBhZGRyZXNzKHRoaXMpKTsKCiAgICAgICAgLy8gUmVhc3NpZ24gb3duZXJzaGlwLCBjbGVhciBwZW5kaW5nIGFwcHJvdmFscywgZW1pdCBUcmFuc2ZlciBldmVudC4KICAgICAgICBfdHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgLy8vIEBub3RpY2UgR3JhbnQgYW5vdGhlciBhZGRyZXNzIHRoZSByaWdodCB0byB0cmFuc2ZlciBhIHNwZWNpZmljIHBpeGVsIHZpYQogICAgLy8vICB0cmFuc2ZlckZyb20oKS4gVGhpcyBpcyB0aGUgcHJlZmVycmVkIGZsb3cgZm9yIHRyYW5zZmVyaW5nIE5GVHMgdG8gY29udHJhY3RzLgogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gYmUgZ3JhbnRlZCB0cmFuc2ZlciBhcHByb3ZhbC4gUGFzcyBhZGRyZXNzKDApIHRvCiAgICAvLy8gIGNsZWFyIGFsbCBhcHByb3ZhbHMuCiAgICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSBJRCBvZiB0aGUgcGl4ZWwgdGhhdCBjYW4gYmUgdHJhbnNmZXJyZWQgaWYgdGhpcyBjYWxsIHN1Y2NlZWRzLgogICAgLy8vIEBkZXYgUmVxdWlyZWQgZm9yIEVSQy03MjEgY29tcGxpYW5jZS4KICAgIGZ1bmN0aW9uIGFwcHJvdmUoCiAgICAgICAgYWRkcmVzcyBfdG8sCiAgICAgICAgdWludDI1NiBfdG9rZW5JZAogICAgKQogICAgICAgIGV4dGVybmFsCiAgICB7CiAgICAgICAgLy8gT25seSBhbiBvd25lciBjYW4gZ3JhbnQgdHJhbnNmZXIgYXBwcm92YWwuCiAgICAgICAgcmVxdWlyZShfb3ducyhtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwogICAgICAgIC8vIGFkZHJlc3MgaXMgbm90IGN1cnJlbnRseSBtYW5hZ2VkIGJ5IHRoZSBjb250cmFjdCAoaXQgaXMgaW4gYW4gYXVjdGlvbikKICAgICAgICByZXF1aXJlKHBpeGVsSW5kZXhUb0FwcHJvdmVkW190b2tlbklkXSAhPSBhZGRyZXNzKHRoaXMpKTsKCiAgICAgICAgLy8gUmVnaXN0ZXIgdGhlIGFwcHJvdmFsIChyZXBsYWNpbmcgYW55IHByZXZpb3VzIGFwcHJvdmFsKS4KICAgICAgICBwaXhlbEluZGV4VG9BcHByb3ZlZFtfdG9rZW5JZF0gPSBfdG87CgogICAgICAgIC8vIEVtaXQgYXBwcm92YWwgZXZlbnQuCiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgLy8vIEBub3RpY2UgVHJhbnNmZXIgYSBQaXhlbCBvd25lZCBieSBhbm90aGVyIGFkZHJlc3MsIGZvciB3aGljaCB0aGUgY2FsbGluZyBhZGRyZXNzCiAgICAvLy8gIGhhcyBwcmV2aW91c2x5IGJlZW4gZ3JhbnRlZCB0cmFuc2ZlciBhcHByb3ZhbCBieSB0aGUgb3duZXIuCiAgICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBhZGRyZXNzIHRoYXQgb3ducyB0aGUgcGl4ZWwgdG8gYmUgdHJhbnNmZXJlZC4KICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgc2hvdWxkIHRha2Ugb3duZXJzaGlwIG9mIHRoZSBQaXhlbC4gQ2FuIGJlIGFueSBhZGRyZXNzLAogICAgLy8vICBpbmNsdWRpbmcgdGhlIGNhbGxlci4KICAgIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIElEIG9mIHRoZSBQaXhlbCB0byBiZSB0cmFuc2ZlcnJlZC4KICAgIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oCiAgICAgICAgYWRkcmVzcyBfZnJvbSwKICAgICAgICBhZGRyZXNzIF90bywKICAgICAgICB1aW50MjU2IF90b2tlbklkCiAgICApCiAgICAgICAgZXh0ZXJuYWwKICAgIHsKICAgICAgICAvLyBTYWZldHkgY2hlY2sgdG8gcHJldmVudCBhZ2FpbnN0IGFuIHVuZXhwZWN0ZWQgMHgwIGRlZmF1bHQuCiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgLy8gRGlzYWxsb3cgdHJhbnNmZXJzIHRvIHRoaXMgY29udHJhY3QgdG8gcHJldmVudCBhY2NpZGVudGFsIG1pc3VzZS4KICAgICAgICAvLyBUaGUgY29udHJhY3Qgc2hvdWxkIG5ldmVyIG93biBhbnlkIFBpeGVscyAoZXhjZXB0IHZlcnkgYnJpZWZseQogICAgICAgIC8vIGFmdGVyIGEgZ2VuMCBjYXQgaXMgY3JlYXRlZCBhbmQgYmVmb3JlIGl0IGdvZXMgb24gYXVjdGlvbikuCiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcyh0aGlzKSk7CiAgICAgICAgLy8gQ2hlY2sgZm9yIGFwcHJvdmFsIGFuZCB2YWxpZCBvd25lcnNoaXAKICAgICAgICByZXF1aXJlKF9hcHByb3ZlZEZvcihtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwogICAgICAgIHJlcXVpcmUoX293bnMoX2Zyb20sIF90b2tlbklkKSk7CgogICAgICAgIC8vIFJlYXNzaWduIG93bmVyc2hpcCAoYWxzbyBjbGVhcnMgcGVuZGluZyBhcHByb3ZhbHMgYW5kIGVtaXRzIFRyYW5zZmVyIGV2ZW50KS4KICAgICAgICBfdHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogICAgfQoKICAgIC8vLyBAbm90aWNlIFJldHVybnMgdGhlIHRvdGFsIG51bWJlciBvZiBwaXhlbHMgY3VycmVudGx5IGluIGV4aXN0ZW5jZS4KICAgIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gV0lEVEggKiBIRUlHSFQ7CiAgICB9CgogICAgLy8vIEBub3RpY2UgUmV0dXJucyB0aGUgYWRkcmVzcyBjdXJyZW50bHkgYXNzaWduZWQgb3duZXJzaGlwIG9mIGEgZ2l2ZW4gUGl4ZWwuCiAgICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogICAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF90b2tlbklkKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnMgKGFkZHJlc3Mgb3duZXIpCiAgICB7CiAgICAgICAgb3duZXIgPSBwaXhlbEluZGV4VG9Pd25lcltfdG9rZW5JZF07CiAgICAgICAgcmVxdWlyZShvd25lciAhPSBhZGRyZXNzKDApKTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBSZXR1cm5zIHRoZSBhZGRyZXNzZXMgY3VycmVudGx5IGFzc2lnbmVkIG93bmVyc2hpcCBvZiB0aGUgZ2l2ZW4gcGl4ZWwgYXJlYS4KICAgIGZ1bmN0aW9uIG93bmVyc09mQXJlYSh1aW50MjU2IHgsIHVpbnQyNTYgeSwgdWludDI1NiB4MiwgdWludDI1NiB5MikgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChhZGRyZXNzW10gcmVzdWx0KSB7CiAgICAgICAgcmVxdWlyZSh4MiA+IHggJiYgeTIgPiB5KTsKICAgICAgICByZXF1aXJlKHgyIDw9IFdJRFRIICYmIHkyIDw9IEhFSUdIVCk7CiAgICAgICAgcmVzdWx0ID0gbmV3IGFkZHJlc3NbXSgoeTIgLSB5KSAqICh4MiAtIHgpKTsKCiAgICAgICAgdWludDI1NiByID0gMDsKICAgICAgICBmb3IgKHVpbnQyNTYgaSA9IHk7IGkgPCB5MjsgaSsrKSB7CiAgICAgICAgICAgIHVpbnQyNTYgdG9rZW5JZCA9IGkgKiBXSURUSDsKICAgICAgICAgICAgZm9yICh1aW50MjU2IGogPSB4OyBqIDwgeDI7IGorKykgewogICAgICAgICAgICAgICAgcmVzdWx0W3JdID0gcGl4ZWxJbmRleFRvT3duZXJbdG9rZW5JZCArIGpdOwogICAgICAgICAgICAgICAgcisrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8vLyBAbm90aWNlIFJldHVybnMgYSBsaXN0IG9mIGFsbCBQaXhlbCBJRHMgYXNzaWduZWQgdG8gYW4gYWRkcmVzcy4KICAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBvd25lciB3aG9zZWQgUGl4ZWxzIHdlIGFyZSBpbnRlcmVzdGVkIGluLgogICAgLy8vIEBkZXYgVGhpcyBtZXRob2QgTVVTVCBORVZFUiBiZSBjYWxsZWQgYnkgc21hcnQgY29udHJhY3QgY29kZS4gRmlyc3QsIGl0J3MgZmFpcmx5CiAgICAvLy8gIGV4cGVuc2l2ZSAoaXQgd2Fsa3MgdGhlIGVudGlyZSBQaXhlbCBhcnJheSBsb29raW5nIGZvciBwaXhlbHMgYmVsb25naW5nIHRvIG93bmVyKSwKICAgIC8vLyAgYnV0IGl0IGFsc28gcmV0dXJucyBhIGR5bmFtaWMgYXJyYXksIHdoaWNoIGlzIG9ubHkgc3VwcG9ydGVkIGZvciB3ZWIzIGNhbGxzLCBhbmQKICAgIC8vLyAgbm90IGNvbnRyYWN0LXRvLWNvbnRyYWN0IGNhbGxzLgogICAgZnVuY3Rpb24gdG9rZW5zT2ZPd25lcihhZGRyZXNzIF9vd25lcikgZXh0ZXJuYWwgdmlldyByZXR1cm5zKHVpbnQyNTZbXSBvd25lclRva2VucykgewogICAgICAgIHVpbnQyNTYgdG9rZW5Db3VudCA9IGJhbGFuY2VPZihfb3duZXIpOwoKICAgICAgICBpZiAodG9rZW5Db3VudCA9PSAwKSB7CiAgICAgICAgICAgIC8vIFJldHVybiBhbiBlbXB0eSBhcnJheQogICAgICAgICAgICByZXR1cm4gbmV3IHVpbnQyNTZbXSgwKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB1aW50MjU2W10gbWVtb3J5IHJlc3VsdCA9IG5ldyB1aW50MjU2W10odG9rZW5Db3VudCk7CiAgICAgICAgICAgIHVpbnQyNTYgdG90YWxQaXhlbHMgPSB0b3RhbFN1cHBseSgpOwogICAgICAgICAgICB1aW50MjU2IHJlc3VsdEluZGV4ID0gMDsKCiAgICAgICAgICAgIC8vIFdlIGNvdW50IG9uIHRoZSBmYWN0IHRoYXQgYWxsIHBpeGVscyBoYXZlIElEcyBzdGFydGluZyBhdCAwIGFuZCBpbmNyZWFzaW5nCiAgICAgICAgICAgIC8vIHNlcXVlbnRpYWxseSB1cCB0byB0aGUgdG90YWxDYXQgY291bnQuCiAgICAgICAgICAgIHVpbnQyNTYgcGl4ZWxJZDsKCiAgICAgICAgICAgIGZvciAocGl4ZWxJZCA9IDA7IHBpeGVsSWQgPD0gdG90YWxQaXhlbHM7IHBpeGVsSWQrKykgewogICAgICAgICAgICAgICAgaWYgKHBpeGVsSW5kZXhUb093bmVyW3BpeGVsSWRdID09IF9vd25lcikgewogICAgICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHRJbmRleF0gPSBwaXhlbElkOwogICAgICAgICAgICAgICAgICAgIHJlc3VsdEluZGV4Kys7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgfQogICAgfQoKICAgIC8vIFRha2VuIGZyb20gaHR0cHM6Ly9ldGhlcmV1bS5zdGFja2V4Y2hhbmdlLmNvbS9hLzEwOTI5CiAgICBmdW5jdGlvbiB1aW50VG9TdHJpbmcodWludCB2KSBjb25zdGFudCByZXR1cm5zIChzdHJpbmcgc3RyKSB7CiAgICAgICAgdWludCBtYXhsZW5ndGggPSAxMDA7CiAgICAgICAgYnl0ZXMgbWVtb3J5IHJldmVyc2VkID0gbmV3IGJ5dGVzKG1heGxlbmd0aCk7CiAgICAgICAgdWludCBpID0gMDsKICAgICAgICB3aGlsZSAodiAhPSAwKSB7CiAgICAgICAgICAgIHVpbnQgcmVtYWluZGVyID0gdiAlIDEwOwogICAgICAgICAgICB2ID0gdiAvIDEwOwogICAgICAgICAgICByZXZlcnNlZFtpKytdID0gYnl0ZSg0OCArIHJlbWFpbmRlcik7CiAgICAgICAgfQogICAgICAgIGJ5dGVzIG1lbW9yeSBzID0gbmV3IGJ5dGVzKGkpOwogICAgICAgIGZvciAodWludCBqID0gMDsgaiA8IGk7IGorKykgewogICAgICAgICAgICBzW2pdID0gcmV2ZXJzZWRbaSAtIDEgLSBqXTsKICAgICAgICB9CiAgICAgICAgc3RyID0gc3RyaW5nKHMpOwogICAgfQoKICAgIC8vIFRha2VuIGZyb20gaHR0cHM6Ly9ldGhlcmV1bS5zdGFja2V4Y2hhbmdlLmNvbS9hLzEwOTI5CiAgICBmdW5jdGlvbiBhcHBlbmRVaW50VG9TdHJpbmcoc3RyaW5nIGluU3RyLCB1aW50IHYpIGNvbnN0YW50IHJldHVybnMgKHN0cmluZyBzdHIpIHsKICAgICAgICB1aW50IG1heGxlbmd0aCA9IDEwMDsKICAgICAgICBieXRlcyBtZW1vcnkgcmV2ZXJzZWQgPSBuZXcgYnl0ZXMobWF4bGVuZ3RoKTsKICAgICAgICB1aW50IGkgPSAwOwogICAgICAgIHdoaWxlICh2ICE9IDApIHsKICAgICAgICAgICAgdWludCByZW1haW5kZXIgPSB2ICUgMTA7CiAgICAgICAgICAgIHYgPSB2IC8gMTA7CiAgICAgICAgICAgIHJldmVyc2VkW2krK10gPSBieXRlKDQ4ICsgcmVtYWluZGVyKTsKICAgICAgICB9CiAgICAgICAgYnl0ZXMgbWVtb3J5IGluU3RyYiA9IGJ5dGVzKGluU3RyKTsKICAgICAgICBieXRlcyBtZW1vcnkgcyA9IG5ldyBieXRlcyhpblN0cmIubGVuZ3RoICsgaSk7CiAgICAgICAgdWludCBqOwogICAgICAgIGZvciAoaiA9IDA7IGogPCBpblN0cmIubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgc1tqXSA9IGluU3RyYltqXTsKICAgICAgICB9CiAgICAgICAgZm9yIChqID0gMDsgaiA8IGk7IGorKykgewogICAgICAgICAgICBzW2ogKyBpblN0cmIubGVuZ3RoXSA9IHJldmVyc2VkW2kgLSAxIC0gal07CiAgICAgICAgfQogICAgICAgIHN0ciA9IHN0cmluZyhzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRNZXRhQmFzZVVybChzdHJpbmcgX21ldGFCYXNlVXJsKSBleHRlcm5hbCBvbmx5QXV0aG9yaXR5IHsKICAgICAgICBtZXRhQmFzZVVybCA9IF9tZXRhQmFzZVVybDsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBSZXR1cm5zIGEgVVJJIHBvaW50aW5nIHRvIGEgbWV0YWRhdGEgcGFja2FnZSBmb3IgdGhpcyB0b2tlbiBjb25mb3JtaW5nIHRvCiAgICAvLy8gIEVSQy03MjEgKGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy83MjEpCiAgICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSBJRCBudW1iZXIgb2YgdGhlIFBpeGVsIHdob3NlIG1ldGFkYXRhIHNob3VsZCBiZSByZXR1cm5lZC4KICAgIGZ1bmN0aW9uIHRva2VuTWV0YWRhdGEodWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChzdHJpbmcgaW5mb1VybCkgewogICAgICAgIHJldHVybiBhcHBlbmRVaW50VG9TdHJpbmcobWV0YUJhc2VVcmwsIF90b2tlbklkKTsKICAgIH0KfQoKY29udHJhY3QgUGl4ZWxQYWludGluZyBpcyBQaXhlbE93bmVyc2hpcCB7CgogICAgZXZlbnQgUGFpbnQodWludDI1NiB0b2tlbklkLCB1aW50MzIgY29sb3IpOwoKICAgIC8vIFNldHMgdGhlIGNvbG9yIG9mIGFuIGluZGl2aWR1YWwgcGl4ZWwKICAgIGZ1bmN0aW9uIHNldFBpeGVsQ29sb3IodWludDI1NiBfdG9rZW5JZCwgdWludDMyIF9jb2xvcikgZXh0ZXJuYWwgewogICAgICAgIC8vIGNoZWNrIHRoYXQgdGhlIHRva2VuIGlkIGlzIGluIHRoZSByYW5nZQogICAgICAgIHJlcXVpcmUoX3Rva2VuSWQgPCBIRUlHSFQgKiBXSURUSCk7CiAgICAgICAgLy8gY2hlY2sgdGhhdCB0aGUgc2VuZGVyIGlzIG93bmVyIG9mIHRoZSBwaXhlbAogICAgICAgIHJlcXVpcmUoX293bnMobXNnLnNlbmRlciwgX3Rva2VuSWQpKTsKICAgICAgICBjb2xvcnNbX3Rva2VuSWRdID0gX2NvbG9yOwogICAgfQoKICAgIC8vIFNldHMgdGhlIGNvbG9yIG9mIHRoZSBwaXhlbHMgaW4gYW4gYXJlYSwgbGVmdCB0byByaWdodCBhbmQgdGhlbiB0b3AgdG8gYm90dG9tCiAgICBmdW5jdGlvbiBzZXRQaXhlbEFyZWFDb2xvcih1aW50MjU2IHgsIHVpbnQyNTYgeSwgdWludDI1NiB4MiwgdWludDI1NiB5MiwgdWludDMyW10gX2NvbG9ycykgZXh0ZXJuYWwgewogICAgICAgIHJlcXVpcmUoeDIgPiB4ICYmIHkyID4geSk7CiAgICAgICAgcmVxdWlyZSh4MiA8PSBXSURUSCAmJiB5MiA8PSBIRUlHSFQpOwogICAgICAgIHJlcXVpcmUoX2NvbG9ycy5sZW5ndGggPT0gKHkyIC0geSkgKiAoeDIgLSB4KSk7CiAgICAgICAgdWludDI1NiByID0gMDsKICAgICAgICBmb3IgKHVpbnQyNTYgaSA9IHk7IGkgPCB5MjsgaSsrKSB7CiAgICAgICAgICAgIHVpbnQyNTYgdG9rZW5JZCA9IGkgKiBXSURUSDsKICAgICAgICAgICAgZm9yICh1aW50MjU2IGogPSB4OyBqIDwgeDI7IGorKykgewogICAgICAgICAgICAgICAgaWYgKF9vd25zKG1zZy5zZW5kZXIsIHRva2VuSWQgKyBqKSkgewogICAgICAgICAgICAgICAgICAgIHVpbnQzMiBjb2xvciA9IF9jb2xvcnNbcl07CiAgICAgICAgICAgICAgICAgICAgY29sb3JzW3Rva2VuSWQgKyBqXSA9IGNvbG9yOwogICAgICAgICAgICAgICAgICAgIFBhaW50KHRva2VuSWQgKyBqLCBjb2xvcik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByKys7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLy8gUmV0dXJucyB0aGUgY29sb3Igb2YgYSBnaXZlbiBwaXhlbAogICAgZnVuY3Rpb24gZ2V0UGl4ZWxDb2xvcih1aW50MjU2IF90b2tlbklkKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQzMiBjb2xvcikgewogICAgICAgIHJlcXVpcmUoX3Rva2VuSWQgPCBIRUlHSFQgKiBXSURUSCk7CiAgICAgICAgY29sb3IgPSBjb2xvcnNbX3Rva2VuSWRdOwogICAgfQoKICAgIC8vIFJldHVybnMgdGhlIGNvbG9ycyBvZiB0aGUgcGl4ZWxzIGluIGFuIGFyZWEsIGxlZnQgdG8gcmlnaHQgYW5kIHRoZW4gdG9wIHRvIGJvdHRvbQogICAgZnVuY3Rpb24gZ2V0UGl4ZWxBcmVhQ29sb3IodWludDI1NiB4LCB1aW50MjU2IHksIHVpbnQyNTYgeDIsIHVpbnQyNTYgeTIpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludDMyW10gcmVzdWx0KSB7CiAgICAgICAgcmVxdWlyZSh4MiA+IHggJiYgeTIgPiB5KTsKICAgICAgICByZXF1aXJlKHgyIDw9IFdJRFRIICYmIHkyIDw9IEhFSUdIVCk7CiAgICAgICAgcmVzdWx0ID0gbmV3IHVpbnQzMltdKCh5MiAtIHkpICogKHgyIC0geCkpOwogICAgICAgIHVpbnQyNTYgciA9IDA7CiAgICAgICAgZm9yICh1aW50MjU2IGkgPSB5OyBpIDwgeTI7IGkrKykgewogICAgICAgICAgICB1aW50MjU2IHRva2VuSWQgPSBpICogV0lEVEg7CiAgICAgICAgICAgIGZvciAodWludDI1NiBqID0geDsgaiA8IHgyOyBqKyspIHsKICAgICAgICAgICAgICAgIHJlc3VsdFtyXSA9IGNvbG9yc1t0b2tlbklkICsgal07CiAgICAgICAgICAgICAgICByKys7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgovLy8gQHRpdGxlIGFsbCBmdW5jdGlvbnMgZm9yIGJ1eWluZyBlbXB0eSBwaXhlbHMKY29udHJhY3QgUGl4ZWxNaW50aW5nIGlzIFBpeGVsUGFpbnRpbmcgewoKICAgIHVpbnQgcHVibGljIHBpeGVsUHJpY2UgPSAzMDMwIHN6YWJvOwoKICAgIC8vIFNldCB0aGUgcHJpY2UgZm9yIGEgcGl4ZWwKICAgIGZ1bmN0aW9uIHNldE5ld1BpeGVsUHJpY2UodWludCBfcGl4ZWxQcmljZSkgZXh0ZXJuYWwgb25seUF1dGhvcml0eSB7CiAgICAgICAgcGl4ZWxQcmljZSA9IF9waXhlbFByaWNlOwogICAgfQogICAgCiAgICAvLyBidXkgZW4gZW1wdHkgcGl4ZWwKICAgIGZ1bmN0aW9uIGJ1eUVtcHR5UGl4ZWwodWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPT0gcGl4ZWxQcmljZSk7CiAgICAgICAgcmVxdWlyZShfdG9rZW5JZCA8IEhFSUdIVCAqIFdJRFRIKTsKICAgICAgICByZXF1aXJlKHBpeGVsSW5kZXhUb093bmVyW190b2tlbklkXSA9PSBhZGRyZXNzKDApKTsKICAgICAgICAvLyBpbmNyZWFzZSBhdXRob3JpdHkgYmFsYW5jZQogICAgICAgIGF1dGhvcml0eUJhbGFuY2UgKz0gbXNnLnZhbHVlOwogICAgICAgIC8vIFRoaXMgd2lsbCBhc3NpZ24gb3duZXJzaGlwLCBhbmQgYWxzbyBlbWl0IHRoZSBUcmFuc2ZlciBldmVudCBhcwogICAgICAgIC8vIHBlciBFUkM3MjEgZHJhZnQKICAgICAgICBfdHJhbnNmZXIoMCwgbXNnLnNlbmRlciwgX3Rva2VuSWQpOwogICAgfQoKICAgIC8vIGJ1eSBhbiBhcmVhIG9mIHBpeGVscywgbGVmdCB0byByaWdodCwgdG9wIHRvIGJvdHRvbQogICAgZnVuY3Rpb24gYnV5RW1wdHlQaXhlbEFyZWEodWludDI1NiB4LCB1aW50MjU2IHksIHVpbnQyNTYgeDIsIHVpbnQyNTYgeTIpIGV4dGVybmFsIHBheWFibGUgewogICAgICAgIHJlcXVpcmUoeDIgPiB4ICYmIHkyID4geSk7CiAgICAgICAgcmVxdWlyZSh4MiA8PSBXSURUSCAmJiB5MiA8PSBIRUlHSFQpOwogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID09IHBpeGVsUHJpY2UgKiAoeDIteCkgKiAoeTIteSkpOwogICAgICAgIAogICAgICAgIHVpbnQyNTYgaTsKICAgICAgICB1aW50MjU2IHRva2VuSWQ7CiAgICAgICAgdWludDI1NiBqOwogICAgICAgIC8vIGNoZWNrIHRoYXQgYWxsIHBpeGVscyB0byBidXkgYXJlIGF2YWlsYWJsZQogICAgICAgIGZvciAoaSA9IHk7IGkgPCB5MjsgaSsrKSB7CiAgICAgICAgICAgIHRva2VuSWQgPSBpICogV0lEVEg7CiAgICAgICAgICAgIGZvciAoaiA9IHg7IGogPCB4MjsgaisrKSB7CiAgICAgICAgICAgICAgICByZXF1aXJlKHBpeGVsSW5kZXhUb093bmVyW3Rva2VuSWQgKyBqXSA9PSBhZGRyZXNzKDApKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgYXV0aG9yaXR5QmFsYW5jZSArPSBtc2cudmFsdWU7CgogICAgICAgIC8vIERvIHRoZSBhY3R1YWwgdHJhbnNmZXIKICAgICAgICBmb3IgKGkgPSB5OyBpIDwgeTI7IGkrKykgewogICAgICAgICAgICB0b2tlbklkID0gaSAqIFdJRFRIOwogICAgICAgICAgICBmb3IgKGogPSB4OyBqIDwgeDI7IGorKykgewogICAgICAgICAgICAgICAgX3RyYW5zZmVyKDAsIG1zZy5zZW5kZXIsIHRva2VuSWQgKyBqKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCn0KCi8vLyBAdGl0bGUgYWxsIGZ1bmN0aW9ucyBmb3IgbWFuYWdpbmcgcGl4ZWwgYXVjdGlvbnMKY29udHJhY3QgUGl4ZWxBdWN0aW9uIGlzIFBpeGVsTWludGluZyB7CgogICAgLy8gUmVwcmVzZW50cyBhbiBhdWN0aW9uIG9uIGFuIE5GVAogICAgc3RydWN0IEF1Y3Rpb24gewogICAgICAgICAvLyBDdXJyZW50IHN0YXRlIG9mIHRoZSBhdWN0aW9uLgogICAgICAgIGFkZHJlc3MgaGlnaGVzdEJpZGRlcjsKICAgICAgICB1aW50IGhpZ2hlc3RCaWQ7CiAgICAgICAgdWludDI1NiBlbmRUaW1lOwogICAgICAgIGJvb2wgbGl2ZTsKICAgIH0KCiAgICAvLyBNYXAgZnJvbSB0b2tlbiBJRCB0byB0aGVpciBjb3JyZXNwb25kaW5nIGF1Y3Rpb24uCiAgICBtYXBwaW5nICh1aW50MjU2ID0+IEF1Y3Rpb24pIHRva2VuSWRUb0F1Y3Rpb247CiAgICAvLyBBbGxvd2VkIHdpdGhkcmF3YWxzIG9mIHByZXZpb3VzIGJpZHMKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgcGVuZGluZ1JldHVybnM7CgogICAgLy8gRHVyYXRpb24gb2YgYW4gYXVjdGlvbgogICAgdWludDI1NiBwdWJsaWMgZHVyYXRpb24gPSA2MCAqIDYwICogMjQgKiA0OwogICAgLy8gQXVjdGlvbnMgd2lsbCBiZSBlbmFibGVkIGxhdGVyCiAgICBib29sIHB1YmxpYyBhdWN0aW9uc0VuYWJsZWQgPSBmYWxzZTsKCiAgICAvLyBDaGFuZ2UgdGhlIGR1cmF0aW9uIGZvciBuZXcgYXVjdGlvbnMKICAgIGZ1bmN0aW9uIHNldER1cmF0aW9uKHVpbnQgX2R1cmF0aW9uKSBleHRlcm5hbCBvbmx5QXV0aG9yaXR5IHsKICAgICAgICBkdXJhdGlvbiA9IF9kdXJhdGlvbjsKICAgIH0KCiAgICAvLyBFbmFibGUgb3IgZGlzYWJsZSBhdWN0aW9ucwogICAgZnVuY3Rpb24gc2V0QXVjdGlvbnNFbmFibGVkKGJvb2wgX2F1Y3Rpb25zRW5hYmxlZCkgZXh0ZXJuYWwgb25seUF1dGhvcml0eSB7CiAgICAgICAgYXVjdGlvbnNFbmFibGVkID0gX2F1Y3Rpb25zRW5hYmxlZDsKICAgIH0KCiAgICAvLyBjcmVhdGUgYSBuZXcgYXVjdGlvbnMgZm9yIGEgZ2l2ZW4gcGl4ZWwsIG9ubHkgb3duZXIgb3IgYXV0aG9yaXR5IGNhbiBkbyB0aGlzCiAgICAvLyBUaGUgYXV0aG9yaXR5IHdpbGwgb25seSBkbyB0aGlzIGlmIHBpeGVscyBhcmUgbWlzdXNlZCBvciBsb3N0CiAgICBmdW5jdGlvbiBjcmVhdGVBdWN0aW9uKAogICAgICAgIHVpbnQyNTYgX3Rva2VuSWQKICAgICkKICAgICAgICBleHRlcm5hbCBwYXlhYmxlCiAgICB7CiAgICAgICAgLy8gb25seSBhdXRob3JpdHkgb3Igb3duZXIgY2FuIHN0YXJ0IGF1Y3Rpb24KICAgICAgICByZXF1aXJlKGF1Y3Rpb25zRW5hYmxlZCk7CiAgICAgICAgcmVxdWlyZShfb3ducyhtc2cuc2VuZGVyLCBfdG9rZW5JZCkgfHwgbXNnLnNlbmRlciA9PSBhdXRob3JpdHlBZGRyZXNzKTsKICAgICAgICAvLyBObyBhdWN0aW9uIGlzIGN1cnJlbnRseSBydW5uaW5nCiAgICAgICAgcmVxdWlyZSghdG9rZW5JZFRvQXVjdGlvbltfdG9rZW5JZF0ubGl2ZSk7CgogICAgICAgIHVpbnQgc3RhcnRQcmljZSA9IHBpeGVsUHJpY2U7CiAgICAgICAgaWYgKG1zZy5zZW5kZXIgPT0gYXV0aG9yaXR5QWRkcmVzcykgewogICAgICAgICAgICBzdGFydFByaWNlID0gMDsKICAgICAgICB9CgogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID09IHN0YXJ0UHJpY2UpOwogICAgICAgIC8vIHRoaXMgcHJldmVudHMgdHJhbnNmZXJzIGR1cmluZyB0aGUgYXVjdGlvbgogICAgICAgIHBpeGVsSW5kZXhUb0FwcHJvdmVkW190b2tlbklkXSA9IGFkZHJlc3ModGhpcyk7CgogICAgICAgIHRva2VuSWRUb0F1Y3Rpb25bX3Rva2VuSWRdID0gQXVjdGlvbigKICAgICAgICAgICAgbXNnLnNlbmRlciwKICAgICAgICAgICAgc3RhcnRQcmljZSwKICAgICAgICAgICAgYmxvY2sudGltZXN0YW1wICsgZHVyYXRpb24sCiAgICAgICAgICAgIHRydWUKICAgICAgICApOwogICAgICAgIEF1Y3Rpb25TdGFydGVkKF90b2tlbklkKTsKICAgIH0KCiAgICAvLyBiaWQgZm9yIGFuIHBpeGVsIGF1Y3Rpb24KICAgIGZ1bmN0aW9uIGJpZCh1aW50MjU2IF90b2tlbklkKSBleHRlcm5hbCBwYXlhYmxlIHsKICAgICAgICAvLyBObyBhcmd1bWVudHMgYXJlIG5lY2Vzc2FyeSwgYWxsCiAgICAgICAgLy8gaW5mb3JtYXRpb24gaXMgYWxyZWFkeSBwYXJ0IG9mCiAgICAgICAgLy8gdGhlIHRyYW5zYWN0aW9uLiBUaGUga2V5d29yZCBwYXlhYmxlCiAgICAgICAgLy8gaXMgcmVxdWlyZWQgZm9yIHRoZSBmdW5jdGlvbiB0bwogICAgICAgIC8vIGJlIGFibGUgdG8gcmVjZWl2ZSBFdGhlci4KICAgICAgICBBdWN0aW9uIHN0b3JhZ2UgYXVjdGlvbiA9IHRva2VuSWRUb0F1Y3Rpb25bX3Rva2VuSWRdOwoKICAgICAgICAvLyBSZXZlcnQgdGhlIGNhbGwgaWYgdGhlIGJpZGRpbmcKICAgICAgICAvLyBwZXJpb2QgaXMgb3Zlci4KICAgICAgICByZXF1aXJlKGF1Y3Rpb24ubGl2ZSk7CiAgICAgICAgcmVxdWlyZShhdWN0aW9uLmVuZFRpbWUgPiBibG9jay50aW1lc3RhbXApOwoKICAgICAgICAvLyBJZiB0aGUgYmlkIGlzIG5vdCBoaWdoZXIsIHNlbmQgdGhlCiAgICAgICAgLy8gbW9uZXkgYmFjay4KICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+IGF1Y3Rpb24uaGlnaGVzdEJpZCk7CgogICAgICAgIGlmIChhdWN0aW9uLmhpZ2hlc3RCaWRkZXIgIT0gMCkgewogICAgICAgICAgICAvLyBTZW5kaW5nIGJhY2sgdGhlIG1vbmV5IGJ5IHNpbXBseSB1c2luZwogICAgICAgICAgICAvLyBoaWdoZXN0QmlkZGVyLnNlbmQoaGlnaGVzdEJpZCkgaXMgYSBzZWN1cml0eSByaXNrCiAgICAgICAgICAgIC8vIGJlY2F1c2UgaXQgY291bGQgZXhlY3V0ZSBhbiB1bnRydXN0ZWQgY29udHJhY3QuCiAgICAgICAgICAgIC8vIEl0IGlzIGFsd2F5cyBzYWZlciB0byBsZXQgdGhlIHJlY2lwaWVudHMKICAgICAgICAgICAgLy8gd2l0aGRyYXcgdGhlaXIgbW9uZXkgdGhlbXNlbHZlcy4KICAgICAgICAgICAgcGVuZGluZ1JldHVybnNbYXVjdGlvbi5oaWdoZXN0QmlkZGVyXSArPSBhdWN0aW9uLmhpZ2hlc3RCaWQ7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGF1Y3Rpb24uaGlnaGVzdEJpZGRlciA9IG1zZy5zZW5kZXI7CiAgICAgICAgYXVjdGlvbi5oaWdoZXN0QmlkID0gbXNnLnZhbHVlOwoKICAgICAgICBIaWdoZXN0QmlkSW5jcmVhc2VkKF90b2tlbklkLCBtc2cuc2VuZGVyLCBtc2cudmFsdWUpOwogICAgfQoKICAgIC8vLyBXaXRoZHJhdyBhIGJpZCB0aGF0IHdhcyBvdmVyYmlkLgogICAgZnVuY3Rpb24gd2l0aGRyYXcoKSBleHRlcm5hbCByZXR1cm5zIChib29sKSB7CiAgICAgICAgdWludCBhbW91bnQgPSBwZW5kaW5nUmV0dXJuc1ttc2cuc2VuZGVyXTsKICAgICAgICBpZiAoYW1vdW50ID4gMCkgewogICAgICAgICAgICAvLyBJdCBpcyBpbXBvcnRhbnQgdG8gc2V0IHRoaXMgdG8gemVybyBiZWNhdXNlIHRoZSByZWNpcGllbnQKICAgICAgICAgICAgLy8gY2FuIGNhbGwgdGhpcyBmdW5jdGlvbiBhZ2FpbiBhcyBwYXJ0IG9mIHRoZSByZWNlaXZpbmcgY2FsbAogICAgICAgICAgICAvLyBiZWZvcmUgYHNlbmRgIHJldHVybnMuCiAgICAgICAgICAgIHBlbmRpbmdSZXR1cm5zW21zZy5zZW5kZXJdID0gMDsKCiAgICAgICAgICAgIGlmICghbXNnLnNlbmRlci5zZW5kKGFtb3VudCkpIHsKICAgICAgICAgICAgICAgIC8vIE5vIG5lZWQgdG8gY2FsbCB0aHJvdyBoZXJlLCBqdXN0IHJlc2V0IHRoZSBhbW91bnQgb3dpbmcKICAgICAgICAgICAgICAgIHBlbmRpbmdSZXR1cm5zW21zZy5zZW5kZXJdID0gYW1vdW50OwogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vIC8vLyBFbmQgdGhlIGF1Y3Rpb24gYW5kIHNlbmQgdGhlIGhpZ2hlc3QgYmlkCiAgICAvLyAvLy8gdG8gdGhlIGJlbmVmaWNpYXJ5LgogICAgZnVuY3Rpb24gZW5kQXVjdGlvbih1aW50MjU2IF90b2tlbklkKSBleHRlcm5hbCB7CiAgICAgICAgLy8gSXQgaXMgYSBnb29kIGd1aWRlbGluZSB0byBzdHJ1Y3R1cmUgZnVuY3Rpb25zIHRoYXQgaW50ZXJhY3QKICAgICAgICAvLyB3aXRoIG90aGVyIGNvbnRyYWN0cyAoaS5lLiB0aGV5IGNhbGwgZnVuY3Rpb25zIG9yIHNlbmQgRXRoZXIpCiAgICAgICAgLy8gaW50byB0aHJlZSBwaGFzZXM6CiAgICAgICAgLy8gMS4gY2hlY2tpbmcgY29uZGl0aW9ucwogICAgICAgIC8vIDIuIHBlcmZvcm1pbmcgYWN0aW9ucyAocG90ZW50aWFsbHkgY2hhbmdpbmcgY29uZGl0aW9ucykKICAgICAgICAvLyAzLiBpbnRlcmFjdGluZyB3aXRoIG90aGVyIGNvbnRyYWN0cwogICAgICAgIC8vIElmIHRoZXNlIHBoYXNlcyBhcmUgbWl4ZWQgdXAsIHRoZSBvdGhlciBjb250cmFjdCBjb3VsZCBjYWxsCiAgICAgICAgLy8gYmFjayBpbnRvIHRoZSBjdXJyZW50IGNvbnRyYWN0IGFuZCBtb2RpZnkgdGhlIHN0YXRlIG9yIGNhdXNlCiAgICAgICAgLy8gZWZmZWN0cyAoZXRoZXIgcGF5b3V0KSB0byBiZSBwZXJmb3JtZWQgbXVsdGlwbGUgdGltZXMuCiAgICAgICAgLy8gSWYgZnVuY3Rpb25zIGNhbGxlZCBpbnRlcm5hbGx5IGluY2x1ZGUgaW50ZXJhY3Rpb24gd2l0aCBleHRlcm5hbAogICAgICAgIC8vIGNvbnRyYWN0cywgdGhleSBhbHNvIGhhdmUgdG8gYmUgY29uc2lkZXJlZCBpbnRlcmFjdGlvbiB3aXRoCiAgICAgICAgLy8gZXh0ZXJuYWwgY29udHJhY3RzLgoKICAgICAgICBBdWN0aW9uIHN0b3JhZ2UgYXVjdGlvbiA9IHRva2VuSWRUb0F1Y3Rpb25bX3Rva2VuSWRdOwoKICAgICAgICAvLyAxLiBDb25kaXRpb25zCiAgICAgICAgcmVxdWlyZShhdWN0aW9uLmVuZFRpbWUgPCBibG9jay50aW1lc3RhbXApOwogICAgICAgIHJlcXVpcmUoYXVjdGlvbi5saXZlKTsgLy8gdGhpcyBmdW5jdGlvbiBoYXMgYWxyZWFkeSBiZWVuIGNhbGxlZAoKICAgICAgICAvLyAyLiBFZmZlY3RzCiAgICAgICAgYXVjdGlvbi5saXZlID0gZmFsc2U7CiAgICAgICAgQXVjdGlvbkVuZGVkKF90b2tlbklkLCBhdWN0aW9uLmhpZ2hlc3RCaWRkZXIsIGF1Y3Rpb24uaGlnaGVzdEJpZCk7CgogICAgICAgIC8vIDMuIEludGVyYWN0aW9uCiAgICAgICAgYWRkcmVzcyBvd25lciA9IHBpeGVsSW5kZXhUb093bmVyW190b2tlbklkXTsKICAgICAgICAvLyB0cmFuc2ZlciBtb25leSB3aXRob3V0IAogICAgICAgIHVpbnQgYW1vdW50ID0gYXVjdGlvbi5oaWdoZXN0QmlkICogOSAvIDEwOwogICAgICAgIHBlbmRpbmdSZXR1cm5zW293bmVyXSArPSBhbW91bnQ7CiAgICAgICAgYXV0aG9yaXR5QmFsYW5jZSArPSAoYXVjdGlvbi5oaWdoZXN0QmlkIC0gYW1vdW50KTsKICAgICAgICAvLyB0cmFuc2ZlciB0b2tlbgogICAgICAgIF90cmFuc2Zlcihvd25lciwgYXVjdGlvbi5oaWdoZXN0QmlkZGVyLCBfdG9rZW5JZCk7CgogICAgICAgCiAgICB9CgogICAgLy8gLy8gRXZlbnRzIHRoYXQgd2lsbCBiZSBmaXJlZCBvbiBjaGFuZ2VzLgogICAgZXZlbnQgQXVjdGlvblN0YXJ0ZWQodWludDI1NiBfdG9rZW5JZCk7CiAgICBldmVudCBIaWdoZXN0QmlkSW5jcmVhc2VkKHVpbnQyNTYgX3Rva2VuSWQsIGFkZHJlc3MgYmlkZGVyLCB1aW50IGFtb3VudCk7CiAgICBldmVudCBBdWN0aW9uRW5kZWQodWludDI1NiBfdG9rZW5JZCwgYWRkcmVzcyB3aW5uZXIsIHVpbnQgYW1vdW50KTsKCgogICAgLy8vIEBkZXYgUmV0dXJucyBhdWN0aW9uIGluZm8gZm9yIGFuIE5GVCBvbiBhdWN0aW9uLgogICAgLy8vIEBwYXJhbSBfdG9rZW5JZCAtIElEIG9mIE5GVCBvbiBhdWN0aW9uLgogICAgZnVuY3Rpb24gZ2V0QXVjdGlvbih1aW50MjU2IF90b2tlbklkKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnMKICAgICgKICAgICAgICBhZGRyZXNzIGhpZ2hlc3RCaWRkZXIsCiAgICAgICAgdWludCBoaWdoZXN0QmlkLAogICAgICAgIHVpbnQgZW5kVGltZSwKICAgICAgICBib29sIGxpdmUKICAgICkgewogICAgICAgIEF1Y3Rpb24gc3RvcmFnZSBhdWN0aW9uID0gdG9rZW5JZFRvQXVjdGlvbltfdG9rZW5JZF07CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgYXVjdGlvbi5oaWdoZXN0QmlkZGVyLAogICAgICAgICAgICBhdWN0aW9uLmhpZ2hlc3RCaWQsCiAgICAgICAgICAgIGF1Y3Rpb24uZW5kVGltZSwKICAgICAgICAgICAgYXVjdGlvbi5saXZlCiAgICAgICAgKTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIHRoZSBjdXJyZW50IHByaWNlIG9mIGFuIGF1Y3Rpb24uCiAgICAvLy8gQHBhcmFtIF90b2tlbklkIC0gSUQgb2YgdGhlIHRva2VuIHByaWNlIHdlIGFyZSBjaGVja2luZy4KICAgIGZ1bmN0aW9uIGdldEhpZ2hlc3RCaWQodWludDI1NiBfdG9rZW5JZCkKICAgICAgICBleHRlcm5hbAogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zICh1aW50MjU2KQogICAgewogICAgICAgIEF1Y3Rpb24gc3RvcmFnZSBhdWN0aW9uID0gdG9rZW5JZFRvQXVjdGlvbltfdG9rZW5JZF07CiAgICAgICAgcmV0dXJuIGF1Y3Rpb24uaGlnaGVzdEJpZDsKICAgIH0KfQoKCi8vLyBAdGl0bGUgUGl4ZWxDb3JlOiBQaXhlbHMgaW4gdGhlIGJsb2NrY2hhaW4KLy8vIEBhdXRob3IgT2xpdmVyIFNjaG5laWRlciA8PHNwYW4gY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSIxNDdkN2E3MjdiNTQ2NDdkNmM3MTc4Nzc3YjdkN2E2NzNhN2Q3YiI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+IChodHRwczovL3BpeGVsY29pbnMuaW8pLCBiYXNlZCBvbiBBeGlvbSBaZW4gKGh0dHBzOi8vd3d3LmF4aW9temVuLmNvKQovLy8gQGRldiBUaGUgbWFpbiBQaXhlbENvaW5zIGNvbnRyYWN0CmNvbnRyYWN0IFBpeGVsQ29yZSBpcyBQaXhlbEF1Y3Rpb24gewoKICAgIC8vIFNldCBpbiBjYXNlIHRoZSBjb3JlIGNvbnRyYWN0IGlzIGJyb2tlbiBhbmQgYW4gdXBncmFkZSBpcyByZXF1aXJlZAogICAgYWRkcmVzcyBwdWJsaWMgbmV3Q29udHJhY3RBZGRyZXNzOwoKICAgIC8vLyBAbm90aWNlIENyZWF0ZXMgdGhlIG1haW4gUGl4ZWxDb3JlIHNtYXJ0IGNvbnRyYWN0IGluc3RhbmNlLgogICAgZnVuY3Rpb24gUGl4ZWxDb3JlKCkgcHVibGljIHsKICAgICAgICAvLyB0aGUgY3JlYXRvciBvZiB0aGUgY29udHJhY3QgaXMgdGhlIGluaXRpYWwgYXV0aG9yaXR5CiAgICAgICAgYXV0aG9yaXR5QWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgLy8vIEBkZXYgVXNlZCB0byBtYXJrIHRoZSBzbWFydCBjb250cmFjdCBhcyB1cGdyYWRlZCwgaW4gY2FzZSB0aGVyZSBpcyBhIHNlcmlvdXMKICAgIC8vLyAgYnJlYWtpbmcgYnVnLiBUaGlzIG1ldGhvZCBkb2VzIG5vdGhpbmcgYnV0IGtlZXAgdHJhY2sgb2YgdGhlIG5ldyBjb250cmFjdCBhbmQKICAgIC8vLyAgZW1pdCBhIG1lc3NhZ2UgaW5kaWNhdGluZyB0aGF0IHRoZSBuZXcgYWRkcmVzcyBpcyBzZXQuIEl0J3MgdXAgdG8gY2xpZW50cyBvZiB0aGlzCiAgICAvLy8gIGNvbnRyYWN0IHRvIHVwZGF0ZSB0byB0aGUgbmV3IGNvbnRyYWN0IGFkZHJlc3MgaW4gdGhhdCBjYXNlLiAoVGhpcyBjb250cmFjdCB3aWxsCiAgICAvLy8gIGJlIHBhdXNlZCBpbmRlZmluaXRlbHkgaWYgc3VjaCBhbiB1cGdyYWRlIHRha2VzIHBsYWNlLikKICAgIC8vLyBAcGFyYW0gX3YyQWRkcmVzcyBuZXcgYWRkcmVzcwogICAgZnVuY3Rpb24gc2V0TmV3QWRkcmVzcyhhZGRyZXNzIF92MkFkZHJlc3MpIGV4dGVybmFsIG9ubHlBdXRob3JpdHkgewogICAgICAgIG5ld0NvbnRyYWN0QWRkcmVzcyA9IF92MkFkZHJlc3M7CiAgICAgICAgQ29udHJhY3RVcGdyYWRlKF92MkFkZHJlc3MpOwogICAgfQoKICAgIC8vIEBkZXYgQWxsb3dzIHRoZSBhdXRob3JpdHkgdG8gY2FwdHVyZSB0aGUgYmFsYW5jZSBhdmFpbGFibGUgdG8gdGhlIGNvbnRyYWN0LgogICAgZnVuY3Rpb24gd2l0aGRyYXdCYWxhbmNlKCkgZXh0ZXJuYWwgb25seUF1dGhvcml0eSByZXR1cm5zIChib29sKSB7CiAgICAgICAgdWludCBhbW91bnQgPSBhdXRob3JpdHlCYWxhbmNlOwogICAgICAgIGlmIChhbW91bnQgPiAwKSB7CiAgICAgICAgICAgIGF1dGhvcml0eUJhbGFuY2UgPSAwOwogICAgICAgICAgICBpZiAoIWF1dGhvcml0eUFkZHJlc3Muc2VuZChhbW91bnQpKSB7CiAgICAgICAgICAgICAgICBhdXRob3JpdHlCYWxhbmNlID0gYW1vdW50OwogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9'.
	

]
