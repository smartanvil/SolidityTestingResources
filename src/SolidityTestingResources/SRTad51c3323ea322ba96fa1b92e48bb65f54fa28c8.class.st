Class {
	#name : #SRTad51c3323ea322ba96fa1b92e48bb65f54fa28c8,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTad51c3323ea322ba96fa1b92e48bb65f54fa28c8 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKgoqICAgRGFwQ2FyIFRva2VuIChEQVBYKQoqICAgQ3JlYXRlZCBieSBTdGFybGFnIExhYnMgKHd3dy5zdGFybGFnLmNvbSkKKiAgIENvcHlyaWdodCAmIzE2OTsgRGFwQ2FyLmlvIDIwMTguIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiogICBodHRwczovL3d3dy5kYXBjYXIuaW8KKi8KCmxpYnJhcnkgTWF0aCB7CiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIAogICAgaW50ZXJuYWwgCiAgICBwdXJlIAogICAgcmV0dXJucyAodWludDI1NikgCiAgICB7CiAgICAgICAgaWYgKGEgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgICAgdWludDI1NiBjID0gYSAqIGI7CiAgICAgICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgCiAgICBpbnRlcm5hbCAKICAgIHB1cmUgCiAgICByZXR1cm5zICh1aW50MjU2KSAKICAgIHsKICAgICAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIAogICAgaW50ZXJuYWwgCiAgICBwdXJlIAogICAgcmV0dXJucyAodWludDI1NikgCiAgICB7CiAgICAgICAgYXNzZXJ0KGIgPD0gYSk7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgCiAgICBpbnRlcm5hbCAKICAgIHB1cmUgCiAgICByZXR1cm5zICh1aW50MjU2KSAKICAgIHsKICAgICAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgICAgICBhc3NlcnQoYyA+PSBhKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KfQoKY29udHJhY3QgVXRpbHMgewogICAgZnVuY3Rpb24gVXRpbHMoKSBwdWJsaWMge30KCiAgICBtb2RpZmllciBncmVhdGVyVGhhblplcm8odWludDI1NiBfdmFsdWUpIAogICAgewogICAgICAgIHJlcXVpcmUoX3ZhbHVlID4gMCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciB2YWxpZFVpbnQodWludDI1NiBfdmFsdWUpIAogICAgewogICAgICAgIHJlcXVpcmUoX3ZhbHVlID49IDApOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgdmFsaWRBZGRyZXNzKGFkZHJlc3MgX2FkZHJlc3MpIAogICAgewogICAgICAgIHJlcXVpcmUoX2FkZHJlc3MgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBub3RUaGlzKGFkZHJlc3MgX2FkZHJlc3MpIAogICAgewogICAgICAgIHJlcXVpcmUoX2FkZHJlc3MgIT0gYWRkcmVzcyh0aGlzKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciB2YWxpZEFkZHJlc3NBbmROb3RUaGlzKGFkZHJlc3MgX2FkZHJlc3MpIAogICAgewogICAgICAgIHJlcXVpcmUoX2FkZHJlc3MgIT0gYWRkcmVzcygwKSAmJiBfYWRkcmVzcyAhPSBhZGRyZXNzKHRoaXMpKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG5vdEVtcHR5KHN0cmluZyBfZGF0YSkKICAgIHsKICAgICAgICByZXF1aXJlKGJ5dGVzKF9kYXRhKS5sZW5ndGggPiAwKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIHN0cmluZ0xlbmd0aChzdHJpbmcgX2RhdGEsIHVpbnQyNTYgX2xlbmd0aCkKICAgIHsKICAgICAgICByZXF1aXJlKGJ5dGVzKF9kYXRhKS5sZW5ndGggPT0gX2xlbmd0aCk7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgbW9kaWZpZXIgdmFsaWRCeXRlczMyKGJ5dGVzMzIgX2J5dGVzKQogICAgewogICAgICAgIHJlcXVpcmUoX2J5dGVzICE9IDApOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgdmFsaWRVaW50NjQodWludDY0IF92YWx1ZSkgCiAgICB7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPj0gMCAmJiBfdmFsdWUgPCA0Mjk0OTY3Mjk2KTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIHZhbGlkVWludDgodWludDggX3ZhbHVlKSAKICAgIHsKICAgICAgICByZXF1aXJlKF92YWx1ZSA+PSAwICYmIF92YWx1ZSA8IDI1Nik7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciB2YWxpZEJhbGFuY2VUaGlzKHVpbnQyNTYgX3ZhbHVlKQogICAgewogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFkZHJlc3ModGhpcykuYmFsYW5jZSk7CiAgICAgICAgXzsKICAgIH0KfQoKY29udHJhY3QgQXV0aG9yaXphYmxlIGlzIFV0aWxzIHsKICAgIHVzaW5nIE1hdGggZm9yIHVpbnQyNTY7CgogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICBhZGRyZXNzIHB1YmxpYyBuZXdPd25lcjsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gTGV2ZWwpIGF1dGhvcml6ZWRzOwogICAgdWludDI1NiBwdWJsaWMgYXV0aG9yaXplZENvdW50OwoKICAgIC8qICAKICAgICogICBaRVJPIDAgLSBidWcgZm9yIG51bGwgb2JqZWN0CiAgICAqICAgT1dORVIgMQogICAgKiAgIEFETUlOIDIKICAgICogICBEQVBQIDMKICAgICovICAKICAgIGVudW0gTGV2ZWwge1pFUk8sT1dORVIsQURNSU4sREFQUH0KCiAgICBldmVudCBPd25lclRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBfcHJldk93bmVyLCBhZGRyZXNzIGluZGV4ZWQgX25ld093bmVyKTsKICAgIGV2ZW50IEF1dGhvcml6ZWQoYWRkcmVzcyBpbmRleGVkIF9hZGRyZXNzLCBMZXZlbCBfbGV2ZWwpOwogICAgZXZlbnQgVW5BdXRob3JpemVkKGFkZHJlc3MgaW5kZXhlZCBfYWRkcmVzcyk7CgogICAgZnVuY3Rpb24gQXV0aG9yaXphYmxlKCkgCiAgICBwdWJsaWMgCiAgICB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIGF1dGhvcml6ZWRzW21zZy5zZW5kZXJdID0gTGV2ZWwuT1dORVI7CiAgICAgICAgYXV0aG9yaXplZENvdW50ID0gYXV0aG9yaXplZENvdW50LmFkZCgxKTsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoYXV0aG9yaXplZHNbbXNnLnNlbmRlcl0gPT0gTGV2ZWwuT1dORVIpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seU93bmVyT3JUaGlzIHsKICAgICAgICByZXF1aXJlKGF1dGhvcml6ZWRzW21zZy5zZW5kZXJdID09IExldmVsLk9XTkVSIHx8IG1zZy5zZW5kZXIgPT0gYWRkcmVzcyh0aGlzKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBub3RPd25lcihhZGRyZXNzIF9hZGRyZXNzKSB7CiAgICAgICAgcmVxdWlyZShhdXRob3JpemVkc1tfYWRkcmVzc10gIT0gTGV2ZWwuT1dORVIpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgYXV0aExldmVsKExldmVsIF9sZXZlbCkgewogICAgICAgIHJlcXVpcmUoKGF1dGhvcml6ZWRzW21zZy5zZW5kZXJdID4gTGV2ZWwuWkVSTykgJiYgKGF1dGhvcml6ZWRzW21zZy5zZW5kZXJdIDw9IF9sZXZlbCkpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgYXV0aExldmVsT25seShMZXZlbCBfbGV2ZWwpIHsKICAgICAgICByZXF1aXJlKGF1dGhvcml6ZWRzW21zZy5zZW5kZXJdID09IF9sZXZlbCk7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgbW9kaWZpZXIgbm90U2VuZGVyKGFkZHJlc3MgX2FkZHJlc3MpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgIT0gX2FkZHJlc3MpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgaXNTZW5kZXIoYWRkcmVzcyBfYWRkcmVzcykgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBfYWRkcmVzcyk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBjaGVja0xldmVsKExldmVsIF9sZXZlbCkgewogICAgICAgIHJlcXVpcmUoKF9sZXZlbCA+IExldmVsLlpFUk8pICYmIChMZXZlbC5EQVBQID49IF9sZXZlbCkpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBfbmV3T3duZXIpIAogICAgcHVibGljIAogICAgewogICAgICAgIF90cmFuc2Zlck93bmVyc2hpcChfbmV3T3duZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIF90cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIF9uZXdPd25lcikgCiAgICBvbmx5T3duZXIgCiAgICB2YWxpZEFkZHJlc3MoX25ld093bmVyKQogICAgbm90VGhpcyhfbmV3T3duZXIpCiAgICBpbnRlcm5hbCAKICAgIHsKICAgICAgICByZXF1aXJlKF9uZXdPd25lciAhPSBvd25lcik7CiAgICAgICAgbmV3T3duZXIgPSBfbmV3T3duZXI7CiAgICB9CgogICAgZnVuY3Rpb24gYWNjZXB0T3duZXJzaGlwKCkgCiAgICB2YWxpZEFkZHJlc3MobmV3T3duZXIpCiAgICBpc1NlbmRlcihuZXdPd25lcikKICAgIHB1YmxpYyAKICAgIHsKICAgICAgICBPd25lclRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICAgICAgaWYgKGF1dGhvcml6ZWRzW293bmVyXSA9PSBMZXZlbC5PV05FUikgewogICAgICAgICAgICBkZWxldGUgYXV0aG9yaXplZHNbb3duZXJdOwogICAgICAgIH0KICAgICAgICBpZiAoYXV0aG9yaXplZHNbbmV3T3duZXJdID4gTGV2ZWwuWkVSTykgewogICAgICAgICAgICBhdXRob3JpemVkQ291bnQgPSBhdXRob3JpemVkQ291bnQuc3ViKDEpOwogICAgICAgIH0KICAgICAgICBvd25lciA9IG5ld093bmVyOwogICAgICAgIG5ld093bmVyID0gYWRkcmVzcygwKTsKICAgICAgICBhdXRob3JpemVkc1tvd25lcl0gPSBMZXZlbC5PV05FUjsKICAgIH0KCiAgICBmdW5jdGlvbiBjYW5jZWxPd25lcnNoaXAoKSAKICAgIG9ubHlPd25lcgogICAgcHVibGljIAogICAgewogICAgICAgIG5ld093bmVyID0gYWRkcmVzcygwKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhdXRob3JpemVkKGFkZHJlc3MgX2FkZHJlc3MsIExldmVsIF9sZXZlbCkgCiAgICBwdWJsaWMgIAogICAgewogICAgICAgIF9hdXRob3JpemVkKF9hZGRyZXNzLCBfbGV2ZWwpOwogICAgfQoKICAgIGZ1bmN0aW9uIF9hdXRob3JpemVkKGFkZHJlc3MgX2FkZHJlc3MsIExldmVsIF9sZXZlbCkgCiAgICBvbmx5T3duZXIKICAgIHZhbGlkQWRkcmVzcyhfYWRkcmVzcykKICAgIG5vdE93bmVyKF9hZGRyZXNzKQogICAgbm90VGhpcyhfYWRkcmVzcykKICAgIGNoZWNrTGV2ZWwoX2xldmVsKQogICAgaW50ZXJuYWwgIAogICAgewogICAgICAgIGlmIChhdXRob3JpemVkc1tfYWRkcmVzc10gPT0gTGV2ZWwuWkVSTykgewogICAgICAgICAgICBhdXRob3JpemVkQ291bnQgPSBhdXRob3JpemVkQ291bnQuYWRkKDEpOwogICAgICAgIH0KICAgICAgICBhdXRob3JpemVkc1tfYWRkcmVzc10gPSBfbGV2ZWw7CiAgICAgICAgQXV0aG9yaXplZChfYWRkcmVzcywgX2xldmVsKTsKICAgIH0KCiAgICBmdW5jdGlvbiB1bkF1dGhvcml6ZWQoYWRkcmVzcyBfYWRkcmVzcykgCiAgICBvbmx5T3duZXIKICAgIHZhbGlkQWRkcmVzcyhfYWRkcmVzcykKICAgIG5vdE93bmVyKF9hZGRyZXNzKQogICAgbm90VGhpcyhfYWRkcmVzcykKICAgIHB1YmxpYyAgCiAgICB7CiAgICAgICAgaWYgKGF1dGhvcml6ZWRzW19hZGRyZXNzXSA+IExldmVsLlpFUk8pIHsKICAgICAgICAgICAgYXV0aG9yaXplZENvdW50ID0gYXV0aG9yaXplZENvdW50LnN1YigxKTsKICAgICAgICB9CiAgICAgICAgZGVsZXRlIGF1dGhvcml6ZWRzW19hZGRyZXNzXTsKICAgICAgICBVbkF1dGhvcml6ZWQoX2FkZHJlc3MpOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzQXV0aG9yaXplZChhZGRyZXNzIF9hZGRyZXNzKSAKICAgIHZhbGlkQWRkcmVzcyhfYWRkcmVzcykKICAgIG5vdFRoaXMoX2FkZHJlc3MpCiAgICBwdWJsaWMgCiAgICBjb25zdGFudCAKICAgIHJldHVybnMgKExldmVsKSAKICAgIHsKICAgICAgICByZXR1cm4gYXV0aG9yaXplZHNbX2FkZHJlc3NdOwogICAgfQp9Cgpjb250cmFjdCBJVG9rZW5SZWNpcGllbnQgeyBmdW5jdGlvbiByZWNlaXZlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUsIGFkZHJlc3MgX3Rva2VuLCBieXRlcyBfZXh0cmFEYXRhKSBwdWJsaWM7IH0KCmNvbnRyYWN0IElFUkMyMCB7CiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZyk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9Cgpjb250cmFjdCBFUkMyMFRva2VuIGlzIEF1dGhvcml6YWJsZSwgSUVSQzIwIHsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CgogICAgdWludDI1NiB0b3RhbFN1cHBseV87CgogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKCiAgICBtb2RpZmllciB2YWxpZEJhbGFuY2UodWludDI1NiBfdmFsdWUpCiAgICB7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgdmFsaWRCYWxhbmNlRnJvbShhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF92YWx1ZSkKICAgIHsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1tfZnJvbV0pOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgdmFsaWRCYWxhbmNlT3ZlcmZsb3dzKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkKICAgIHsKICAgICAgICByZXF1aXJlKGJhbGFuY2VzW190b10gPD0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBFUkMyMFRva2VuKCkgcHVibGljIHt9CgogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKQogICAgcHVibGljIAogICAgY29uc3RhbnQgCiAgICByZXR1cm5zICh1aW50MjU2KSAKICAgIHsKICAgICAgICByZXR1cm4gdG90YWxTdXBwbHlfOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkKICAgIHB1YmxpYwogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSAKICAgIHsKICAgICAgICByZXR1cm4gX3RyYW5zZmVyKF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKQogICAgdmFsaWRBZGRyZXNzKF90bykKICAgIGdyZWF0ZXJUaGFuWmVybyhfdmFsdWUpCiAgICB2YWxpZEJhbGFuY2UoX3ZhbHVlKQogICAgdmFsaWRCYWxhbmNlT3ZlcmZsb3dzKF90bywgX3ZhbHVlKQogICAgaW50ZXJuYWwKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgCiAgICB7CiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkKICAgIHB1YmxpYyAKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgCiAgICB7CiAgICAgICAgcmV0dXJuIF90cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkKICAgIHZhbGlkQWRkcmVzcyhfdG8pCiAgICB2YWxpZEFkZHJlc3MoX2Zyb20pCiAgICBncmVhdGVyVGhhblplcm8oX3ZhbHVlKQogICAgdmFsaWRCYWxhbmNlRnJvbShfZnJvbSwgX3ZhbHVlKQogICAgdmFsaWRCYWxhbmNlT3ZlcmZsb3dzKF90bywgX3ZhbHVlKQogICAgaW50ZXJuYWwgCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIAogICAgewogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikKICAgIHZhbGlkQWRkcmVzcyhfb3duZXIpCiAgICBwdWJsaWMgCiAgICBjb25zdGFudCAKICAgIHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgCiAgICB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgCiAgICBwdWJsaWMgCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIAogICAgewogICAgICAgIHJldHVybiBfYXBwcm92ZShfc3BlbmRlciwgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgCiAgICB2YWxpZEFkZHJlc3MoX3NwZW5kZXIpCiAgICBpbnRlcm5hbCAKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgCiAgICB7CiAgICAgICAgcmVxdWlyZSgoX3ZhbHVlID09IDApIHx8IChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9PSAwKSk7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKQogICAgdmFsaWRBZGRyZXNzKF9vd25lcikKICAgIHZhbGlkQWRkcmVzcyhfc3BlbmRlcikKICAgIHB1YmxpYyAKICAgIGNvbnN0YW50IAogICAgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIAogICAgewogICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQoKICAgIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfYWRkZWRWYWx1ZSkKICAgIHZhbGlkQWRkcmVzcyhfc3BlbmRlcikKICAgIGdyZWF0ZXJUaGFuWmVybyhfYWRkZWRWYWx1ZSkKICAgIHB1YmxpYyAKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgCiAgICB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF9zdWJ0cmFjdGVkVmFsdWUpIAogICAgdmFsaWRBZGRyZXNzKF9zcGVuZGVyKQogICAgZ3JlYXRlclRoYW5aZXJvKF9zdWJ0cmFjdGVkVmFsdWUpCiAgICBwdWJsaWMKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgCiAgICB7CiAgICAgICAgdWludDI1NiBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgICAgICAgZGVsZXRlIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgICAgIH0KICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9Cgpjb250cmFjdCBGcm96ZW5Ub2tlbiBpcyBFUkMyMFRva2VuLCBJVG9rZW5SZWNpcGllbnQgewogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBmcm96ZWRzOwogICAgdWludDI1NiBwdWJsaWMgZnJvemVkQ291bnQ7CiAgICBib29sIHB1YmxpYyBmcmVlemVFbmFibGVkID0gdHJ1ZTsKICAgIGJvb2wgcHVibGljIGF1dG9GcmVlemUgPSB0cnVlOwogICAgYm9vbCBwdWJsaWMgbWludEZpbmlzaGVkID0gZmFsc2U7CgogICAgZXZlbnQgRnJlZXplKGFkZHJlc3MgaW5kZXhlZCB3YWxsZXQpOwogICAgZXZlbnQgVW5GcmVlemUoYWRkcmVzcyBpbmRleGVkIHdhbGxldCk7CiAgICBldmVudCBQcm9wc0NoYW5nZWQoYWRkcmVzcyBpbmRleGVkIHNlbmRlciwgc3RyaW5nIHByb3BzLCBib29sIG9sZFZhbHVlLCBib29sIG5ld1ZhbHVlKTsKICAgIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHNlbmRlciwgYWRkcmVzcyBpbmRleGVkIHdhbGxldCwgdWludDI1NiBhbW91bnQpOwogICAgZXZlbnQgUmVjZWl2ZVRva2VucyhhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgYWRkcmVzcyBpbmRleGVkIHRva2VuLCB1aW50MjU2IHZhbHVlLCBieXRlcyBleHRyYURhdGEpOwogICAgZXZlbnQgQXBwcm92ZUFuZENhbGwoYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUsIGJ5dGVzIGV4dHJhRGF0YSk7IAogICAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgc2VuZGVyLCB1aW50MjU2IGFtb3VudCk7CiAgICBldmVudCBNaW50RmluaXNoZWQoYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIpOwoKICAgIG1vZGlmaWVyIG5vdEZyZWV6ZQogICAgewogICAgICAgIHJlcXVpcmUoZnJvemVkc1ttc2cuc2VuZGVyXSA9PSBmYWxzZSB8fCBmcmVlemVFbmFibGVkID09IGZhbHNlKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG5vdEZyZWV6ZUZyb20oYWRkcmVzcyBfZnJvbSkgCiAgICB7CiAgICAgICAgcmVxdWlyZSgoX2Zyb20gIT0gYWRkcmVzcygwKSAmJiBmcm96ZWRzW19mcm9tXSA9PSBmYWxzZSkgfHwgZnJlZXplRW5hYmxlZCA9PSBmYWxzZSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBjYW5NaW50CiAgICB7CiAgICAgICAgcmVxdWlyZSghbWludEZpbmlzaGVkKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIEZyb3plblRva2VuKCkgcHVibGljIHt9CgogICAgZnVuY3Rpb24gZnJlZXplKGFkZHJlc3MgX2FkZHJlc3MpIAogICAgYXV0aExldmVsKExldmVsLkRBUFApCiAgICB2YWxpZEFkZHJlc3MoX2FkZHJlc3MpCiAgICBub3RUaGlzKF9hZGRyZXNzKQogICAgbm90T3duZXIoX2FkZHJlc3MpCiAgICBwdWJsaWMgCiAgICB7CiAgICAgICAgaWYgKCFmcm96ZWRzW19hZGRyZXNzXSkgewogICAgICAgICAgICBmcm96ZWRzW19hZGRyZXNzXSA9IHRydWU7CiAgICAgICAgICAgIGZyb3plZENvdW50ID0gZnJvemVkQ291bnQuYWRkKDEpOwogICAgICAgICAgICBGcmVlemUoX2FkZHJlc3MpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiB1bkZyZWV6ZShhZGRyZXNzIF9hZGRyZXNzKSAKICAgIGF1dGhMZXZlbChMZXZlbC5EQVBQKQogICAgdmFsaWRBZGRyZXNzKF9hZGRyZXNzKQogICAgcHVibGljIAogICAgewogICAgICAgIGlmIChmcm96ZWRzW19hZGRyZXNzXSkgewogICAgICAgICAgICBkZWxldGUgZnJvemVkc1tfYWRkcmVzc107CiAgICAgICAgICAgIGZyb3plZENvdW50ID0gZnJvemVkQ291bnQuc3ViKDEpOwogICAgICAgICAgICBVbkZyZWV6ZShfYWRkcmVzcyk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHVwZEZyZWV6ZUVuYWJsZWQoYm9vbCBfZnJlZXplRW5hYmxlZCkgCiAgICBhdXRoTGV2ZWwoTGV2ZWwuQURNSU4pCiAgICBwdWJsaWMgCiAgICB7CiAgICAgICAgUHJvcHNDaGFuZ2VkKG1zZy5zZW5kZXIsICJmcmVlemVFbmFibGVkIiwgZnJlZXplRW5hYmxlZCwgX2ZyZWV6ZUVuYWJsZWQpOwogICAgICAgIGZyZWV6ZUVuYWJsZWQgPSBfZnJlZXplRW5hYmxlZDsKICAgIH0KCiAgICBmdW5jdGlvbiB1cGRBdXRvRnJlZXplKGJvb2wgX2F1dG9GcmVlemUpIAogICAgYXV0aExldmVsKExldmVsLkFETUlOKQogICAgcHVibGljIAogICAgewogICAgICAgIFByb3BzQ2hhbmdlZChtc2cuc2VuZGVyLCAiYXV0b0ZyZWV6ZSIsIGF1dG9GcmVlemUsIF9hdXRvRnJlZXplKTsKICAgICAgICBhdXRvRnJlZXplID0gX2F1dG9GcmVlemU7CiAgICB9CgogICAgZnVuY3Rpb24gaXNGcmVlemUoYWRkcmVzcyBfYWRkcmVzcykgCiAgICB2YWxpZEFkZHJlc3MoX2FkZHJlc3MpCiAgICBwdWJsaWMgCiAgICBjb25zdGFudCAKICAgIHJldHVybnMoYm9vbCkgCiAgICB7CiAgICAgICAgcmV0dXJuIGJvb2woZnJvemVkc1tfYWRkcmVzc10pOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgCiAgICBub3RGcmVlemUKICAgIHB1YmxpYyAKICAgIHJldHVybnMgKGJvb2wpIAogICAgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgCiAgICBub3RGcmVlemVGcm9tKF9mcm9tKQogICAgcHVibGljIAogICAgcmV0dXJucyAoYm9vbCkgCiAgICB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIAogICAgbm90RnJlZXplRnJvbShfc3BlbmRlcikKICAgIHB1YmxpYyAKICAgIHJldHVybnMgKGJvb2wpIAogICAgewogICAgICAgIHJldHVybiBzdXBlci5hcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfYWRkZWRWYWx1ZSkKICAgIG5vdEZyZWV6ZUZyb20oX3NwZW5kZXIpCiAgICBwdWJsaWMgCiAgICByZXR1cm5zIChib29sKSAKICAgIHsKICAgICAgICByZXR1cm4gc3VwZXIuaW5jcmVhc2VBcHByb3ZhbChfc3BlbmRlciwgX2FkZGVkVmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfc3VidHJhY3RlZFZhbHVlKSAKICAgIG5vdEZyZWV6ZUZyb20oX3NwZW5kZXIpCiAgICBwdWJsaWMgCiAgICByZXR1cm5zIChib29sKSAKICAgIHsKICAgICAgICByZXR1cm4gc3VwZXIuZGVjcmVhc2VBcHByb3ZhbChfc3BlbmRlciwgX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZUFuZENhbGwoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9leHRyYURhdGEpIAogICAgdmFsaWRBZGRyZXNzKF9zcGVuZGVyKQogICAgZ3JlYXRlclRoYW5aZXJvKF92YWx1ZSkKICAgIHB1YmxpYyAKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgCiAgICB7CiAgICAgICAgSVRva2VuUmVjaXBpZW50IHNwZW5kZXIgPSBJVG9rZW5SZWNpcGllbnQoX3NwZW5kZXIpOwogICAgICAgIGlmIChhcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUpKSB7CiAgICAgICAgICAgIHNwZW5kZXIucmVjZWl2ZUFwcHJvdmFsKG1zZy5zZW5kZXIsIF92YWx1ZSwgdGhpcywgX2V4dHJhRGF0YSk7CiAgICAgICAgICAgIEFwcHJvdmVBbmRDYWxsKF9zcGVuZGVyLCBfdmFsdWUsIF9leHRyYURhdGEpOyAKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHJlY2VpdmVBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSwgYWRkcmVzcyBfdG9rZW4sIGJ5dGVzIF9leHRyYURhdGEpCiAgICB2YWxpZEFkZHJlc3MoX3NwZW5kZXIpCiAgICB2YWxpZEFkZHJlc3MoX3Rva2VuKQogICAgZ3JlYXRlclRoYW5aZXJvKF92YWx1ZSkKICAgIHB1YmxpYyAKICAgIHsKICAgICAgICBJRVJDMjAgdG9rZW4gPSBJRVJDMjAoX3Rva2VuKTsKICAgICAgICByZXF1aXJlKHRva2VuLnRyYW5zZmVyRnJvbShfc3BlbmRlciwgYWRkcmVzcyh0aGlzKSwgX3ZhbHVlKSk7CiAgICAgICAgUmVjZWl2ZVRva2Vucyhfc3BlbmRlciwgX3Rva2VuLCBfdmFsdWUsIF9leHRyYURhdGEpOwogICAgfQoKICAgIGZ1bmN0aW9uIG1pbnRGaW5pc2goKSAKICAgIG9ubHlPd25lcgogICAgcHVibGljIAogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKQogICAgewogICAgICAgIG1pbnRGaW5pc2hlZCA9IHRydWU7CiAgICAgICAgTWludEZpbmlzaGVkKG1zZy5zZW5kZXIpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfYWRkcmVzcywgdWludDI1NiBfdmFsdWUpCiAgICBjYW5NaW50CiAgICBhdXRoTGV2ZWwoTGV2ZWwuREFQUCkKICAgIHZhbGlkQWRkcmVzcyhfYWRkcmVzcykKICAgIGdyZWF0ZXJUaGFuWmVybyhfdmFsdWUpCiAgICBwdWJsaWMKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgCiAgICB7CiAgICAgICAgYmFsYW5jZXNbX2FkZHJlc3NdID0gYmFsYW5jZXNbX2FkZHJlc3NdLmFkZChfdmFsdWUpOwogICAgICAgIHRvdGFsU3VwcGx5XyA9IHRvdGFsU3VwcGx5Xy5hZGQoX3ZhbHVlKTsKICAgICAgICBUcmFuc2ZlcigwLCBfYWRkcmVzcywgX3ZhbHVlKTsKCiAgICAgICAgaWYgKGZyZWV6ZUVuYWJsZWQgJiYgYXV0b0ZyZWV6ZSAmJiBfYWRkcmVzcyAhPSBhZGRyZXNzKHRoaXMpICYmIGlzQXV0aG9yaXplZChfYWRkcmVzcykgPT0gTGV2ZWwuWkVSTykgewogICAgICAgICAgICBpZiAoIWlzRnJlZXplKF9hZGRyZXNzKSkgewogICAgICAgICAgICAgICAgZnJvemVkc1tfYWRkcmVzc10gPSB0cnVlOwogICAgICAgICAgICAgICAgZnJvemVkQ291bnQgPSBmcm96ZWRDb3VudC5hZGQoMSk7CiAgICAgICAgICAgICAgICBGcmVlemUoX2FkZHJlc3MpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBNaW50KDAsIF9hZGRyZXNzLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGJ1cm4odWludDI1NiBfdmFsdWUpCiAgICBncmVhdGVyVGhhblplcm8oX3ZhbHVlKQogICAgdmFsaWRCYWxhbmNlKF92YWx1ZSkKICAgIHB1YmxpYwogICAgcmV0dXJucyAoYm9vbCkgCiAgICB7CiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICB0b3RhbFN1cHBseV8gPSB0b3RhbFN1cHBseV8uc3ViKF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgYWRkcmVzcygwKSwgX3ZhbHVlKTsKCiAgICAgICAgaWYgKGlzRnJlZXplKG1zZy5zZW5kZXIpKSB7CiAgICAgICAgICAgIGRlbGV0ZSBmcm96ZWRzW21zZy5zZW5kZXJdOwogICAgICAgICAgICBmcm96ZWRDb3VudCA9IGZyb3plZENvdW50LnN1YigxKTsKICAgICAgICAgICAgVW5GcmVlemUobXNnLnNlbmRlcik7CiAgICAgICAgfQoKICAgICAgICBCdXJuKG1zZy5zZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0KCmNvbnRyYWN0IERhcENhclRva2VuIGlzIEZyb3plblRva2VuIHsKICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICJEYXBDYXIgVG9rZW4iOwogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAiREFQWCI7CiAgICB1aW50OCBwdWJsaWMgZGVjaW1hbHMgPSAwOwoKICAgIHN0cmluZyBwdWJsaWMgdmVyc2lvbiA9ICIwLjEiOwogICAgc3RyaW5nIHB1YmxpYyBwdWJsaXNoZXIgPSAiaHR0cHM6Ly93d3cuZGFwY2FyLmlvIjsKICAgIHN0cmluZyBwdWJsaWMgZGVzY3JpcHRpb24gPSAiVGhpcyBpcyBhbiBvZmZpY2lhbCBEYXBDYXIgVG9rZW4gKERBUFgpIjsKCiAgICBib29sIHB1YmxpYyBhY2NlcHRBZG1pbldpdGhkcmF3ID0gZmFsc2U7CiAgICBib29sIHB1YmxpYyBhY2NlcHREb25hdGUgPSB0cnVlOwoKICAgIGV2ZW50IEluZm9DaGFuZ2VkKGFkZHJlc3MgaW5kZXhlZCBzZW5kZXIsIHN0cmluZyB2ZXJzaW9uLCBzdHJpbmcgcHVibGlzaGVyLCBzdHJpbmcgZGVzY3JpcHRpb24pOwogICAgZXZlbnQgV2l0aGRyYXcoYWRkcmVzcyBpbmRleGVkIHNlbmRlciwgYWRkcmVzcyBpbmRleGVkIHdhbGxldCwgdWludDI1NiBhbW91bnQpOwogICAgZXZlbnQgV2l0aGRyYXdUb2tlbnMoYWRkcmVzcyBpbmRleGVkIHNlbmRlciwgYWRkcmVzcyBpbmRleGVkIHdhbGxldCwgYWRkcmVzcyBpbmRleGVkIHRva2VuLCB1aW50MjU2IGFtb3VudCk7CiAgICBldmVudCBEb25hdGUoYWRkcmVzcyBpbmRleGVkIHNlbmRlciwgdWludDI1NiB2YWx1ZSk7CiAgICBldmVudCBQcm9wc0NoYW5nZWQoYWRkcmVzcyBpbmRleGVkIHNlbmRlciwgc3RyaW5nIHByb3BzLCBib29sIG9sZFZhbHVlLCBib29sIG5ld1ZhbHVlKTsKCiAgICBmdW5jdGlvbiBEYXBDYXJUb2tlbigpIHB1YmxpYyB7fQoKICAgIGZ1bmN0aW9uIHNldHVwSW5mbyhzdHJpbmcgX3ZlcnNpb24sIHN0cmluZyBfcHVibGlzaGVyLCBzdHJpbmcgX2Rlc2NyaXB0aW9uKQogICAgYXV0aExldmVsKExldmVsLkFETUlOKQogICAgbm90RW1wdHkoX3ZlcnNpb24pCiAgICBub3RFbXB0eShfcHVibGlzaGVyKQogICAgbm90RW1wdHkoX2Rlc2NyaXB0aW9uKQogICAgcHVibGljCiAgICB7CiAgICAgICAgdmVyc2lvbiA9IF92ZXJzaW9uOwogICAgICAgIHB1Ymxpc2hlciA9IF9wdWJsaXNoZXI7CiAgICAgICAgZGVzY3JpcHRpb24gPSBfZGVzY3JpcHRpb247CiAgICAgICAgSW5mb0NoYW5nZWQobXNnLnNlbmRlciwgX3ZlcnNpb24sIF9wdWJsaXNoZXIsIF9kZXNjcmlwdGlvbik7CiAgICB9CgogICAgZnVuY3Rpb24gd2l0aGRyYXcoKSAKICAgIHB1YmxpYyAKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICByZXR1cm4gd2l0aGRyYXdBbW91bnQoYWRkcmVzcyh0aGlzKS5iYWxhbmNlKTsKICAgIH0KCiAgICBmdW5jdGlvbiB3aXRoZHJhd0Ftb3VudCh1aW50MjU2IF9hbW91bnQpIAogICAgYXV0aExldmVsKExldmVsLkFETUlOKSAKICAgIGdyZWF0ZXJUaGFuWmVybyhhZGRyZXNzKHRoaXMpLmJhbGFuY2UpCiAgICBncmVhdGVyVGhhblplcm8oX2Ftb3VudCkKICAgIHZhbGlkQmFsYW5jZVRoaXMoX2Ftb3VudCkKICAgIHB1YmxpYyAKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICBhZGRyZXNzIHdhbGxldCA9IG93bmVyOwogICAgICAgIGlmIChhY2NlcHRBZG1pbldpdGhkcmF3KSB7CiAgICAgICAgICAgIHdhbGxldCA9IG1zZy5zZW5kZXI7CiAgICAgICAgfQoKICAgICAgICBXaXRoZHJhdyhtc2cuc2VuZGVyLCB3YWxsZXQsIGFkZHJlc3ModGhpcykuYmFsYW5jZSk7CiAgICAgICAgd2FsbGV0LnRyYW5zZmVyKGFkZHJlc3ModGhpcykuYmFsYW5jZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gd2l0aGRyYXdUb2tlbnMoYWRkcmVzcyBfdG9rZW4sIHVpbnQyNTYgX2Ftb3VudCkKICAgIGF1dGhMZXZlbChMZXZlbC5BRE1JTikKICAgIHZhbGlkQWRkcmVzcyhfdG9rZW4pCiAgICBncmVhdGVyVGhhblplcm8oX2Ftb3VudCkKICAgIHB1YmxpYyAKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgCiAgICB7CiAgICAgICAgYWRkcmVzcyB3YWxsZXQgPSBvd25lcjsKICAgICAgICBpZiAoYWNjZXB0QWRtaW5XaXRoZHJhdykgewogICAgICAgICAgICB3YWxsZXQgPSBtc2cuc2VuZGVyOwogICAgICAgIH0KCiAgICAgICAgYm9vbCByZXN1bHQgPSBJRVJDMjAoX3Rva2VuKS50cmFuc2Zlcih3YWxsZXQsIF9hbW91bnQpOwogICAgICAgIGlmIChyZXN1bHQpIHsKICAgICAgICAgICAgV2l0aGRyYXdUb2tlbnMobXNnLnNlbmRlciwgd2FsbGV0LCBfdG9rZW4sIF9hbW91bnQpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICAgIGZ1bmN0aW9uIGJhbGFuY2VUb2tlbihhZGRyZXNzIF90b2tlbikKICAgIHZhbGlkQWRkcmVzcyhfdG9rZW4pCiAgICBwdWJsaWMgCiAgICBjb25zdGFudAogICAgcmV0dXJucyAodWludDI1NiBhbW91bnQpIAogICAgewogICAgICAgIHJldHVybiBJRVJDMjAoX3Rva2VuKS5iYWxhbmNlT2YoYWRkcmVzcyh0aGlzKSk7CiAgICB9CgogICAgZnVuY3Rpb24gdXBkQWNjZXB0QWRtaW5XaXRoZHJhdyhib29sIF9hY2NlcHQpCiAgICBvbmx5T3duZXIKICAgIHB1YmxpYwogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKQogICAgewogICAgICAgIFByb3BzQ2hhbmdlZChtc2cuc2VuZGVyLCAiYWNjZXB0QWRtaW5XaXRoZHJhdyIsIGFjY2VwdEFkbWluV2l0aGRyYXcsIF9hY2NlcHQpOwogICAgICAgIGFjY2VwdEFkbWluV2l0aGRyYXcgPSBfYWNjZXB0OwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgCiAgICBmdW5jdGlvbiAoKSAKICAgIGV4dGVybmFsIAogICAgcGF5YWJsZSAKICAgIHsKICAgICAgICBpZiAoYWNjZXB0RG9uYXRlKSB7CiAgICAgICAgICAgIGRvbmF0ZSgpOwogICAgICAgIH0KCX0KCiAgICBmdW5jdGlvbiBkb25hdGUoKSAKICAgIGdyZWF0ZXJUaGFuWmVybyhtc2cudmFsdWUpCiAgICBpbnRlcm5hbCAKICAgIHsKICAgICAgICBEb25hdGUobXNnLnNlbmRlciwgbXNnLnZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiB1cGRBY2NlcHREb25hdGUoYm9vbCBfYWNjZXB0KQogICAgYXV0aExldmVsKExldmVsLkFETUlOKQogICAgcHVibGljCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgICAgUHJvcHNDaGFuZ2VkKG1zZy5zZW5kZXIsICJhY2NlcHREb25hdGUiLCBhY2NlcHREb25hdGUsIF9hY2NlcHQpOwogICAgICAgIGFjY2VwdERvbmF0ZSA9IF9hY2NlcHQ7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0='.
	

]
