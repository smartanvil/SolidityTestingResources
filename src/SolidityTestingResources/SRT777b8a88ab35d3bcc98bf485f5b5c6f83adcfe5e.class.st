Class {
	#name : #SRT777b8a88ab35d3bcc98bf485f5b5c6f83adcfe5e,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT777b8a88ab35d3bcc98bf485f5b5c6f83adcfe5e >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4gMC40LjE3OwoKbGlicmFyeSBTYWZlTWF0aCB7CiAgICBmdW5jdGlvbiBtdWwodWludCBhLCB1aW50IGIpIHB1cmUgaW50ZXJuYWwgcmV0dXJucyh1aW50KSB7CiAgICAgICAgdWludCBjID0gYSAqIGI7CiAgICAgICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCgogICAgZnVuY3Rpb24gc3ViKHVpbnQgYSwgdWludCBiKSBwdXJlIGludGVybmFsIHJldHVybnModWludCkgewogICAgICAgIGFzc2VydChiIDw9IGEpOwogICAgICAgIHJldHVybiBhIC0gYjsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGQodWludCBhLCB1aW50IGIpIHB1cmUgaW50ZXJuYWwgcmV0dXJucyh1aW50KSB7CiAgICAgICAgdWludCBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSAmJiBjID49IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQp9Cgpjb250cmFjdCBFUkMyMCB7CiAgICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnModWludCk7CgogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyh1aW50KTsKCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50IHZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sIG9rKTsKCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50IHZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sIG9rKTsKCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludCB2YWx1ZSkgcHVibGljIHJldHVybnMoYm9vbCBvayk7CgogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50IHZhbHVlKTsKfQoKCmNvbnRyYWN0IE93bmFibGUgewogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgogICAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIGlmIChuZXdPd25lciAhPSBhZGRyZXNzKDApKSAKICAgICAgICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgIH0KCiAgICBmdW5jdGlvbiBraWxsKCkgcHVibGljIHsKICAgICAgICBpZiAobXNnLnNlbmRlciA9PSBvd25lcikgCiAgICAgICAgICAgIHNlbGZkZXN0cnVjdChvd25lcik7CiAgICB9CgogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIGlmIChtc2cuc2VuZGVyID09IG93bmVyKQogICAgICAgICAgICBfOwogICAgfQp9Cgpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKICAgIGJvb2wgcHVibGljIHN0b3BwZWQ7CgogICAgbW9kaWZpZXIgc3RvcEluRW1lcmdlbmN5IHsKICAgICAgICBpZiAoc3RvcHBlZCkgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5SW5FbWVyZ2VuY3kgewogICAgICAgIGlmICghc3RvcHBlZCkgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CiAgICAgICAgXzsKICAgIH0KCiAgICAvLyBDYWxsZWQgYnkgdGhlIG93bmVyIGluIGVtZXJnZW5jeSwgdHJpZ2dlcnMgc3RvcHBlZCBzdGF0ZQogICAgZnVuY3Rpb24gZW1lcmdlbmN5U3RvcCgpIGV4dGVybmFsIG9ubHlPd25lcigpIHsKICAgICAgICBzdG9wcGVkID0gdHJ1ZTsKICAgIH0KCiAgICAvLyBDYWxsZWQgYnkgdGhlIG93bmVyIHRvIGVuZCBvZiBlbWVyZ2VuY3ksIHJldHVybnMgdG8gbm9ybWFsIHN0YXRlCiAgICBmdW5jdGlvbiByZWxlYXNlKCkgZXh0ZXJuYWwgb25seU93bmVyKCkgb25seUluRW1lcmdlbmN5IHsKICAgICAgICBzdG9wcGVkID0gZmFsc2U7CiAgICB9Cn0KCgoKCgovLyBDcm93ZHNhbGUgU21hcnQgQ29udHJhY3QKLy8gVGhpcyBzbWFydCBjb250cmFjdCBjb2xsZWN0cyBFVEggYW5kIGluIHJldHVybiBzZW5kcyB0b2tlbnMgdG8gY29udHJpYnV0b3JzCmNvbnRyYWN0IENyb3dkc2FsZSBpcyBQYXVzYWJsZSB7CgogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CgogICAgc3RydWN0IEJhY2tlciB7CiAgICAgICAgdWludCB3ZWlSZWNlaXZlZDsgLy8gYW1vdW50IG9mIEVUSCBjb250cmlidXRlZAogICAgICAgIHVpbnQgdG9rZW5zU2VudDsgLy8gYW1vdW50IG9mIHRva2VucyAgc2VudCAgCiAgICAgICAgYm9vbCByZWZ1bmRlZDsgLy8gdHJ1ZSBpZiB1c2VyIGhhcyBiZWVuIHJlZnVuZGVkICAgICAgIAogICAgfQoKICAgIFRva2VuIHB1YmxpYyB0b2tlbjsgLy8gVG9rZW4gY29udHJhY3QgcmVmZXJlbmNlICAgCiAgICBhZGRyZXNzIHB1YmxpYyBtdWx0aXNpZzsgLy8gTXVsdGlzaWcgY29udHJhY3QgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIEVUSCAgICAKICAgIGFkZHJlc3MgcHVibGljIHRlYW07IC8vIEFkZHJlc3MgYXQgd2hpY2ggdGhlIHRlYW0gdG9rZW5zIHdpbGwgYmUgc2VudCAgICAgCiAgICBhZGRyZXNzIHB1YmxpYyBsb3R0ZXJ5OyAvL2FkZHJlc3MgZm9yIDUwJSBvZiByZW1haW5pbmcgdG9rZW5zIAogICAgdWludCBwdWJsaWMgZXRoUmVjZWl2ZWRQcmVzYWxlOyAvLyBOdW1iZXIgb2YgRVRIIHJlY2VpdmVkIGluIHByZXNhbAogICAgdWludCBwdWJsaWMgZXRoUmVjZWl2ZWRNYWluOyAvLyBOdW1iZXIgb2YgRVRIIHJlY2VpdmVkIGluIG1haW4gc2FsZQogICAgdWludCBwdWJsaWMgdG90YWxUb2tlbnNTZW50OyAvLyBOdW1iZXIgb2Ygc2VudCB0byBFVEggY29udHJpYnV0b3JzCiAgICB1aW50IHB1YmxpYyBzdGFydEJsb2NrOyAvLyBDcm93ZHNhbGUgc3RhcnQgYmxvY2sKICAgIHVpbnQgcHVibGljIGVuZEJsb2NrOyAvLyBDcm93ZHNhbGUgZW5kIGJsb2NrCiAgICB1aW50IHB1YmxpYyBtYXhDYXA7IC8vIE1heGltdW0gbnVtYmVyIG9mIHRvIHNlbGwKICAgIHVpbnQgcHVibGljIG1pbkNhcDsgLy8gTWluaW11bSBudW1iZXIgb2YgRVRIIHRvIHJhaXNlCiAgICB1aW50IHB1YmxpYyBtaW5JbnZlc3RFVEg7IC8vIE1pbmltdW0gYW1vdW50IHRvIGludmVzdCAgIAogICAgYm9vbCBwdWJsaWMgY3Jvd2RzYWxlQ2xvc2VkOyAvLyBJcyBjcm93ZHNhbGUgc3RpbGwgb24gZ29pbmcKICAgIFN0ZXAgcHVibGljIGN1cnJlbnRTdGVwOyAgLy8gdG8gYWxsb3cgZm9yIGNvbnRyb2xlZCBzdGVwcyBvZiB0aGUgY2FtcGFpZ24gCiAgICB1aW50IHB1YmxpYyByZWZ1bmRDb3VudDsgIC8vIG51bWJlciBvZiByZWZ1bmRzCiAgICB1aW50IHB1YmxpYyB0b3RhbFJlZnVuZGVkOyAvLyB0b3RhbCBhbW91bnQgb2YgcmVmdW5kcyAgICAKICAgIHVpbnQgcHVibGljIHRva2VuUHJpY2VXZWk7CgogICAgbWFwcGluZyhhZGRyZXNzID0+IEJhY2tlcikgcHVibGljIGJhY2tlcnM7IC8vYmFja2VyIGxpc3QKICAgIGFkZHJlc3NbXSBwdWJsaWMgYmFja2Vyc0luZGV4OyAvLyB0byBiZSBhYmxlIHRvIGl0YXJhdGUgdGhyb3VnaCBiYWNrZXJzIGZvciB2ZXJpZmljYXRpb24uICAKCgogICAgIC8vIEBudGljZSBvdndyaXRlIHRvIGVuc3VyZSB0aGF0IGlmIGFueSBtb25leSBhcmUgbGVmdCwgdGhleSBnbyAKICAgICAvLyB0byBtdWx0aXNpZyB3YWxsZXQKICAgICBmdW5jdGlvbiBraWxsKCkgcHVibGljIHsKICAgICAgICBpZiAobXNnLnNlbmRlciA9PSBvd25lcikgCiAgICAgICAgICAgIHNlbGZkZXN0cnVjdChtdWx0aXNpZyk7CiAgICB9CgogICAgLy8gQG5vdGljZSB0byB2ZXJpZnkgaWYgYWN0aW9uIGlzIG5vdCBwZXJmb3JtZWQgb3V0IG9mIHRoZSBjYW1wYWluZyByYW5nZQogICAgbW9kaWZpZXIgcmVzcGVjdFRpbWVGcmFtZSgpIHsKICAgICAgICBpZiAoKGJsb2NrLm51bWJlciA8IHN0YXJ0QmxvY2spIHx8IChibG9jay5udW1iZXIgPiBlbmRCbG9jaykpIAogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICBfOwogICAgfQoKCiAgICBtb2RpZmllciBtaW5DYXBOb3RSZWFjaGVkKCkgewogICAgICAgIGlmIChldGhSZWNlaXZlZFByZXNhbGUuYWRkKGV0aFJlY2VpdmVkTWFpbikgPj0gbWluQ2FwKSAKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgXzsKICAgIH0KCgogICAgLy8gQG5vdGljZSB0byBzZXQgYW5kIGRldGVybWluZSBzdGVwcyBvZiBjcm93ZHNhbGUKICAgIGVudW0gU3RlcCB7CiAgICAgICAgVW5rbm93biwKICAgICAgICBGdW5kaW5nUHJlU2FsZSwgICAgIC8vIHByZXNhbGUgbW9kZQogICAgICAgIEZ1bmRpbmdQdWJsaWNTYWxlLCAgLy8gcHVibGljIG1vZGUKICAgICAgICBSZWZ1bmRpbmcgIC8vIGluIGNhc2UgY2FtcGFpZ24gZmFpbGVkIGR1cmluZyB0aGlzIHN0ZXAgY29udHJpYnV0b3JzIHdpbGwgYmUgYWJsZSB0byByZWNlaXZlIHJlZnVuZHMKICAgIH0KCgogICAgLy8gRXZlbnRzCiAgICBldmVudCBSZWNlaXZlZEVUSChhZGRyZXNzIGJhY2tlciwgdWludCBhbW91bnQsIHVpbnQgdG9rZW5BbW91bnQpOwogICAgZXZlbnQgUmVmdW5kRVRIKGFkZHJlc3MgYmFja2VyLCB1aW50IGFtb3VudCk7CgoKICAgIC8vIENyb3dkc2FsZSAge2NvbnN0cnVjdG9yfQogICAgLy8gQG5vdGljZSBmaXJlZCB3aGVuIGNvbnRyYWN0IGlzIGNyYXRlZC4gSW5pdGlsaXplcyBhbGwgY29uc3RuYXQgdmFyaWFibGVzLgogICAgZnVuY3Rpb24gQ3Jvd2RzYWxlKCkgcHVibGljIHsKICAgICAgICAKICAgICAgICBtdWx0aXNpZyA9IDB4QzMwYjdhN2Q4MmM3MTQ2N0FGOWVDODVlMDM5ZTRFRDU4NkVGOTgxMjsgCiAgICAgICAgdGVhbSA9IDB4QzMwYjdhN2Q4MmM3MTQ2N0FGOWVDODVlMDM5ZTRFRDU4NkVGOTgxMjsgICAgICAgCiAgICAgICAgbG90dGVyeSA9IDB4MDI3MTI3OTMwRDlhZTEzM0MwOEFFNDgwQTZFNkMyY2FmMWU4Nzg2MTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICBtYXhDYXAgPSAxNDcwMDAwMGUxODsgICAgICAgIAogICAgICAgIHRva2VuUHJpY2VXZWkgPSA2NjY2NjY2NjY2ZTU7CiAgICAgICAgdG90YWxUb2tlbnNTZW50ID0gMDsgCiAgICAgICAgbWluQ2FwID0gKDI1MCBldGhlciAqIDFlMTgpIC8gdG9rZW5QcmljZVdlaTsKICAgICAgICBzZXRTdGVwKFN0ZXAuRnVuZGluZ1ByZVNhbGUpOwogICAgfQoKICAgICAgIC8vIEBub3RpY2UgdG8gcG9wdWxhdGUgd2Vic2l0ZSB3aXRoIHN0YXR1cyBvZiB0aGUgc2FsZSAKICAgIGZ1bmN0aW9uIHJldHVybldlYnNpdGVEYXRhKCkgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyh1aW50LCB1aW50LCB1aW50LCB1aW50LCB1aW50LCB1aW50LCB1aW50LCB1aW50LCBTdGVwLCBib29sLCBib29sKSB7CiAgICAgICAgCiAgICAKICAgICAgICByZXR1cm4gKHN0YXJ0QmxvY2ssIGVuZEJsb2NrLCBiYWNrZXJzSW5kZXgubGVuZ3RoLCBldGhSZWNlaXZlZFByZXNhbGUuYWRkKGV0aFJlY2VpdmVkTWFpbiksIG1heENhcCwgbWluQ2FwLCB0b3RhbFRva2Vuc1NlbnQsICB0b2tlblByaWNlV2VpLCBjdXJyZW50U3RlcCwgc3RvcHBlZCwgY3Jvd2RzYWxlQ2xvc2VkKTsKICAgIH0KCiAgICAvLyBAbm90aWNlIGluIGNhc2UgcmVmdW5kcyBhcmUgbmVlZGVkLCBtb25leSBjYW4gYmUgcmV0dXJuZWQgdG8gdGhlIGNvbnRyYWN0CiAgICBmdW5jdGlvbiBmdW5kQ29udHJhY3QoKSBleHRlcm5hbCBwYXlhYmxlIG9ubHlPd25lcigpIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCgogICAgLy8gQG5vdGljZSBTcGVjaWZ5IGFkZHJlc3Mgb2YgdG9rZW4gY29udHJhY3QKICAgIC8vIEBwYXJhbSBfdG9rZW5BZGRyZXNzIHthZGRyZXNzfSBhZGRyZXNzIG9mIHRva2VuIGNvbnRyYWMKICAgIC8vIEByZXR1cm4gcmVzIHtib29sfQogICAgZnVuY3Rpb24gdXBkYXRlVG9rZW5BZGRyZXNzKFRva2VuIF90b2tlbkFkZHJlc3MpIGV4dGVybmFsIG9ubHlPd25lcigpIHJldHVybnMoYm9vbCByZXMpIHsKICAgICAgICB0b2tlbiA9IF90b2tlbkFkZHJlc3M7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgoKICAgIC8vIEBub3RpY2Ugc2V0IHRoZSBzdGVwIG9mIHRoZSBjYW1wYWlnbiAKICAgIC8vIEBwYXJhbSBfc3RlcCB7U3RlcH0KICAgIGZ1bmN0aW9uIHNldFN0ZXAoU3RlcCBfc3RlcCkgcHVibGljIG9ubHlPd25lcigpIHsKICAgICAgICBjdXJyZW50U3RlcCA9IF9zdGVwOwogICAgICAgIAogICAgICAgIGlmIChjdXJyZW50U3RlcCA9PSBTdGVwLkZ1bmRpbmdQcmVTYWxlKSAgLy8gZm9yIHByZXNhbGUgICAgICAgICAgICAgCiAgICAgICAgICAgIG1pbkludmVzdEVUSCA9IDEgZXRoZXIvNDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIGVsc2UgaWYgKGN1cnJlbnRTdGVwID09IFN0ZXAuRnVuZGluZ1B1YmxpY1NhbGUpIC8vIGZvciBwdWJsaWMgc2FsZSAgICAgICAgICAgCiAgICAgICAgICAgIG1pbkludmVzdEVUSCA9IDA7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgfQoKCiAgICAvLyBAbm90aWNlIHJldHVybiBudW1iZXIgb2YgY29udHJpYnV0b3JzCiAgICAvLyBAcmV0dXJuICB7dWludH0gbnVtYmVyIG9mIGNvbnRyaWJ1dG9ycyAgIAogICAgZnVuY3Rpb24gbnVtYmVyT2ZCYWNrZXJzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludCkgewogICAgICAgIHJldHVybiBiYWNrZXJzSW5kZXgubGVuZ3RoOwogICAgfQoKCgogICAgLy8ge2ZhbGxiYWNrIGZ1bmN0aW9ufQogICAgLy8gQG5vdGljZSBJdCB3aWxsIGNhbGwgaW50ZXJuYWwgZnVuY3Rpb24gd2hpY2ggaGFuZGVscyBhbGxvY2F0aW9uIG9mIEV0aGVyIGFuZCBjYWxjdWxhdGVzIHRva2Vucy4KICAgIGZ1bmN0aW9uICgpIGV4dGVybmFsIHBheWFibGUgeyAgICAgICAgICAgCiAgICAgICAgY29udHJpYnV0ZShtc2cuc2VuZGVyKTsKICAgIH0KCgogICAgLy8gQG5vdGljZSBJdCB3aWxsIGJlIGNhbGxlZCBieSBvd25lciB0byBzdGFydCB0aGUgc2FsZSAgICAKICAgIGZ1bmN0aW9uIHN0YXJ0KHVpbnQgX2Jsb2NrKSBleHRlcm5hbCBvbmx5T3duZXIoKSB7ICAgCgogICAgICAgIHJlcXVpcmUoX2Jsb2NrIDwgMjE2MDAwKTsgIC8vIDIuNSo2MCoyNCo2MCBkYXlzID0gMjE2MDAwICAgICAKICAgICAgICBzdGFydEJsb2NrID0gYmxvY2subnVtYmVyOwogICAgICAgIGVuZEJsb2NrID0gc3RhcnRCbG9jay5hZGQoX2Jsb2NrKTsgCiAgICB9CgogICAgLy8gQG5vdGljZSBEdWUgdG8gY2hhbmdpbmcgYXZlcmFnZSBvZiBibG9jayB0aW1lCiAgICAvLyB0aGlzIGZ1bmN0aW9uIHdpbGwgYWxsb3cgb24gYWRqdXN0aW5nIGR1cmF0aW9uIG9mIGNhbXBhaWduIGNsb3NlciB0byB0aGUgZW5kIAogICAgZnVuY3Rpb24gYWRqdXN0RHVyYXRpb24odWludCBfYmxvY2spIGV4dGVybmFsIG9ubHlPd25lcigpIHsKCiAgICAgICAgcmVxdWlyZShfYmxvY2sgPCAyODgwMDApOyAgLy8gMi41KjYwKjI0KjgwIGRheXMgPSAyODgwMDAgICAgIAogICAgICAgIHJlcXVpcmUoX2Jsb2NrID4gYmxvY2subnVtYmVyLnN1YihzdGFydEJsb2NrKSk7IC8vIGVuc3VyZSB0aGF0IGVuZEJsb2NrIGlzIG5vdCBzZXQgaW4gdGhlIHBhc3QKICAgICAgICBlbmRCbG9jayA9IHN0YXJ0QmxvY2suYWRkKF9ibG9jayk7IAogICAgfQoKICAgIC8vIEBub3RpY2UgSXQgd2lsbCBiZSBjYWxsZWQgYnkgZmFsbGJhY2sgZnVuY3Rpb24gd2hlbmV2ZXIgZXRoZXIgaXMgc2VudCB0byBpdAogICAgLy8gQHBhcmFtICBfYmFja2VyIHthZGRyZXNzfSBhZGRyZXNzIG9mIGJlbmVmaWNpYXJ5CiAgICAvLyBAcmV0dXJuIHJlcyB7Ym9vbH0gdHJ1ZSBpZiB0cmFuc2FjdGlvbiB3YXMgc3VjY2Vzc2Z1bAogICAgZnVuY3Rpb24gY29udHJpYnV0ZShhZGRyZXNzIF9iYWNrZXIpIGludGVybmFsIHN0b3BJbkVtZXJnZW5jeSByZXNwZWN0VGltZUZyYW1lIHJldHVybnMoYm9vbCByZXMpIHsKCiAgICAgICAgdWludCB0b2tlbnNUb1NlbmQgPSB2YWxpZFB1cmNoYXNlKCk7CiAgICAgICAgICAgIAogICAgICAgIEJhY2tlciBzdG9yYWdlIGJhY2tlciA9IGJhY2tlcnNbX2JhY2tlcl07CgogICAgICAgIGlmICghdG9rZW4udHJhbnNmZXIoX2JhY2tlciwgdG9rZW5zVG9TZW5kKSkgCiAgICAgICAgICAgIHJldmVydCgpOyAvLyBUcmFuc2ZlciB0b2tlbnMKICAgICAgICBiYWNrZXIudG9rZW5zU2VudCA9IGJhY2tlci50b2tlbnNTZW50LmFkZCh0b2tlbnNUb1NlbmQpOyAvLyBzYXZlIGNvbnRyaWJ1dG9ycyB0b2tlbnMgdG8gYmUgc2VudAogICAgICAgIGJhY2tlci53ZWlSZWNlaXZlZCA9IGJhY2tlci53ZWlSZWNlaXZlZC5hZGQobXNnLnZhbHVlKTsgIC8vIHNhdmUgaG93IG11Y2ggd2FzIHRoZSBjb250cmlidXRpb24KCiAgICAgICAgaWYgKFN0ZXAuRnVuZGluZ1B1YmxpY1NhbGUgPT0gY3VycmVudFN0ZXApICAvLyBVcGRhdGUgdGhlIHRvdGFsIEV0aGVyIHJlY2l2ZWQKICAgICAgICAgICBldGhSZWNlaXZlZE1haW4gPSBldGhSZWNlaXZlZE1haW4uYWRkKG1zZy52YWx1ZSk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBldGhSZWNlaXZlZFByZXNhbGUgPSBldGhSZWNlaXZlZFByZXNhbGUuYWRkKG1zZy52YWx1ZSk7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIHRvdGFsVG9rZW5zU2VudCA9IHRvdGFsVG9rZW5zU2VudC5hZGQodG9rZW5zVG9TZW5kKTsgICAgIC8vIHVwZGF0ZSB0aGUgdG90YWwgYW1vdW50IG9mIHRva2VucyBzZW50CiAgICAgICAgYmFja2Vyc0luZGV4LnB1c2goX2JhY2tlcik7CgogICAgICAgIG11bHRpc2lnLnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7ICAgLy8gdHJhbnNmZXIgZnVuZHMgdG8gbXVsdGlzaWduYXR1cmUgd2FsbGV0ICAgICAgICAgICAgIAoKICAgICAgICBSZWNlaXZlZEVUSChfYmFja2VyLCBtc2cudmFsdWUsIHRva2Vuc1RvU2VuZCk7IC8vIFJlZ2lzdGVyIGV2ZW50CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgoKCiAgICAvLyBAbm90aWNlIGRldGVybWluZSBpZiBwdXJjaGFzZSBpcyB2YWxpZCBhbmQgcmV0dXJuIHByb3BlciBudW1iZXIgb2YgdG9rZW5zCiAgICAvLyBAcmV0dXJuIHRva2Vuc1RvU2VuZCB7dWludH0gcHJvcGVyIG51bWJlciBvZiB0b2tlbnMgYmFzZWQgb24gdGhlIHRpbWxpbmUKCiAgICBmdW5jdGlvbiB2YWxpZFB1cmNoYXNlKCkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgICAgCiAgICAgICAgcmVxdWlyZSAobXNnLnZhbHVlID49IG1pbkludmVzdEVUSCk7ICAgLy8gZW5zdXJlIHRoYXQgbWluIGNvbnRyaWJ1dGlvbnMgYW1vdW50IGlzIG1ldAoKICAgICAgICAvLyBjYWxjdWxhdGUgYW1vdW50IG9mIHRva2VucyB0byBzZW5kICAoYWRkIDE4IDBzIGZpcnN0KSAgIAogICAgICAgIHVpbnQgdG9rZW5zVG9TZW5kID0gbXNnLnZhbHVlLm11bCgxZTE4KSAvIHRva2VuUHJpY2VXZWk7ICAvLyBiYXNpYyBubXVtYmVyIG9mIHRva2VucyB0byBzZW5kCiAgICAgICAgICAKICAgICAgICBpZiAoU3RlcC5GdW5kaW5nUHVibGljU2FsZSA9PSBjdXJyZW50U3RlcCkgICAvLyBjYWxjdWxhdGUgc3RlcHBlZCBwcmljZSBvZiB0b2tlbiBpbiBwdWJsaWMgc2FsZQogICAgICAgICAgICB0b2tlbnNUb1NlbmQgPSBjYWxjdWxhdGVOb09mVG9rZW5zVG9TZW5kKHRva2Vuc1RvU2VuZCk7IAogICAgICAgIGVsc2UgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSBudW1iZXIgb2YgdG9rZW5zIGZvciBwcmVzYWxlIHdpdGggNTAlIGJvbnVzCiAgICAgICAgICAgIHRva2Vuc1RvU2VuZCA9IHRva2Vuc1RvU2VuZC5hZGQodG9rZW5zVG9TZW5kLm11bCg1MCkgLyAxMDApOwogICAgICAgICAgCiAgICAgICAgcmVxdWlyZSh0b3RhbFRva2Vuc1NlbnQuYWRkKHRva2Vuc1RvU2VuZCkgPCBtYXhDYXApOyAvLyBFbnN1cmUgdGhhdCBtYXggY2FwIGhhc24ndCBiZWVuIHJlYWNoZWQgIAoKICAgICAgICByZXR1cm4gdG9rZW5zVG9TZW5kOwogICAgfQogICAgCiAgICAvLyBAbm90aWNlIEl0IGlzIGNhbGxlZCBieSBoYW5kbGVFVEggdG8gZGV0ZXJtaW5lIGFtb3VudCBvZiB0b2tlbnMgZm9yIGdpdmVuIGNvbnRyaWJ1dGlvbgogICAgLy8gQHBhcmFtIF9hbW91bnQge3VpbnR9IGN1cnJlbnQgcmFuZ2UgY29tcHV0ZWQKICAgIC8vIEByZXR1cm4gdG9rZW5zVG9QdXJjaGFzZSB7dWludH0gdmFsdWUgb2YgdG9rZW5zIHRvIHB1cmNoYXNlCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVOb09mVG9rZW5zVG9TZW5kKHVpbnQgX2Ftb3VudCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyh1aW50KSB7CiAgIAogICAgICAgIGlmIChldGhSZWNlaXZlZE1haW4gPD0gMTUwMCBldGhlcikgICAgICAgIC8vIEZpcnN0IDE1MDAgRVRIOiAyNSUKICAgICAgICAgICAgcmV0dXJuIF9hbW91bnQuYWRkKF9hbW91bnQubXVsKDI1KSAvIDEwMCk7CiAgICAgICAgZWxzZSBpZiAoZXRoUmVjZWl2ZWRNYWluIDw9IDI1MDAgZXRoZXIpICAgLy8gMTUwMSB0byAyNTAwIEVUSDogMTUlICAgICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIF9hbW91bnQuYWRkKF9hbW91bnQubXVsKDE1KSAvIDEwMCk7CiAgICAgICAgZWxzZSBpZiAoZXRoUmVjZWl2ZWRNYWluIDwgMzAwMCBldGhlcikgICAvLyAyNTAxIHRvIDMwMDAgRVRIOiAxMCUKICAgICAgICAgICAgcmV0dXJuIF9hbW91bnQuYWRkKF9hbW91bnQubXVsKDEwKSAvIDEwMCk7CiAgICAgICAgZWxzZSBpZiAoZXRoUmVjZWl2ZWRNYWluIDw9IDQwMDAgZXRoZXIpICAvLyAzMDAxIHRvIDQwMDAgRVRIOiA1JQogICAgICAgICAgICByZXR1cm4gX2Ftb3VudC5hZGQoX2Ftb3VudC5tdWwoNSkgLyAxMDApOwogICAgICAgIGVsc2UgaWYgKGV0aFJlY2VpdmVkTWFpbiA8PSA1MDAwIGV0aGVyKSAgLy8gNDAwMSB0byA1MDAwIEVUSCA6IDIlCiAgICAgICAgICAgIHJldHVybiBfYW1vdW50LmFkZChfYW1vdW50Lm11bCgyKSAvIDEwMCk7CiAgICAgICAgZWxzZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIDUwMDArIE5vIGJvbnVzIGFmdGVyIHRoYXQKICAgICAgICAgICAgcmV0dXJuIF9hbW91bnQ7CiAgICB9CgogICAgLy8gQG5vdGljZSBzaG93IGZvciBkaXNwbGF5IHB1cnBvc2UgYW1vdW50IG9mIHRva2VucyB3aGljaCBjYW4gYmUgYm91Z2h0IAogICAgLy8gYXQgZ2l2ZW4gbW9tZW50LiAKICAgIC8vIEBwYXJhbSBfZXRoZXIge3VpbnR9IGFtb3VudCBvZiBlaHRlcgogICAgZnVuY3Rpb24gZXN0aW1hdGVUb2tlbk51bWJlcih1aW50IF9hbW91bnRXZWkgKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQpIHsgCiAgICAgICAgcmV0dXJuIGNhbGN1bGF0ZU5vT2ZUb2tlbnNUb1NlbmQoX2Ftb3VudFdlaSk7CiAgICB9CgogICAgLy8gQG5vdGljZSBUaGlzIGZ1bmN0aW9uIHdpbGwgZmluYWxpemUgdGhlIHNhbGUuCiAgICAvLyBJdCB3aWxsIG9ubHkgZXhlY3V0ZSBpZiBwcmVkZXRlcm1pbmVkIHNhbGUgdGltZSBwYXNzZWQgb3IgYWxsIHRva2VucyBhcmUgc29sZC4KICAgIGZ1bmN0aW9uIGZpbmFsaXplKCkgZXh0ZXJuYWwgb25seU93bmVyKCkgewoKICAgICAgICB1aW50IHRvdGFsRXRoZXJSZWNlaXZlZCA9IGV0aFJlY2VpdmVkUHJlc2FsZS5hZGQoZXRoUmVjZWl2ZWRNYWluKTsKCiAgICAgICAgcmVxdWlyZSghY3Jvd2RzYWxlQ2xvc2VkKTsgICAgICAgIAogICAgICAgIC8vIHB1cmNoYXNpbmcgcHJlY2lzZSBudW1iZXIgb2YgdG9rZW5zIG1pZ2h0IGJlIGltcHJhY3RpY2FsLCB0aHVzIHN1YnRyYWN0IDEwMCB0b2tlbnMgc28gZmluYWxpeml0aW9uIGlzIHBvc3NpYmxlCiAgICAgICAgLy8gbmVhciB0aGUgZW5kIAogICAgICAgIHJlcXVpcmUgKGJsb2NrLm51bWJlciA+PSBlbmRCbG9jayB8fCB0b3RhbFRva2Vuc1NlbnQgPj0gbWF4Q2FwLnN1YigxMDApKTsgCiAgICAgICAgcmVxdWlyZSh0b3RhbEV0aGVyUmVjZWl2ZWQgPj0gbWluQ2FwICYmIGJsb2NrLm51bWJlciA+PSBlbmRCbG9jayk7ICAgICAgICAgICAgIAoKICAgICAgICBpZiAodG90YWxUb2tlbnNTZW50ID49IG1pbkNhcCkgeyAgICAgICAgICAgCiAgICAgICAgICAgIGlmICghdG9rZW4udHJhbnNmZXIodGVhbSwgNjMwMDAwMGUxOCkpIC8vIHRyYW5zZmVyIHRva2VucyBmb3IgdGhlIHRlYW0vZGV2L2Fkdmlzb3JzCiAgICAgICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICAgICAgaWYgKCF0b2tlbi50cmFuc2Zlcihsb3R0ZXJ5LCB0b2tlbi5iYWxhbmNlT2YodGhpcykgLyAyKSkgCiAgICAgICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICAgICAgaWYgKCF0b2tlbi5idXJuKHRoaXMsIHRva2VuLmJhbGFuY2VPZih0aGlzKSkpCiAgICAgICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICAgICAgIHRva2VuLnVubG9jaygpOwogICAgICAgIH0KICAgICAgICBjcm93ZHNhbGVDbG9zZWQgPSB0cnVlOyAgICAgICAKICAgIH0KCiAgCgogICAgLy8gQG5vdGljZSBGYWlsc2FmZSBkcmFpbgogICAgZnVuY3Rpb24gZHJhaW4oKSBleHRlcm5hbCBvbmx5T3duZXIoKSB7CiAgICAgICAgbXVsdGlzaWcudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsgICAgICAgICAgICAgICAKICAgIH0KCgoKICAgIC8vIEBub3RpY2UgRmFpbHNhZmUgdG9rZW4gdHJhbnNmZXIKICAgIGZ1bmN0aW9uIHRva2VuRHJpYW4oKSBleHRlcm5hbCBvbmx5T3duZXIoKSB7CiAgICAgICBpZiAoYmxvY2subnVtYmVyID4gZW5kQmxvY2spIHsKICAgICAgICBpZiAoIXRva2VuLnRyYW5zZmVyKHRlYW0sIHRva2VuLmJhbGFuY2VPZih0aGlzKSkpIAogICAgICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQogICAgfQogICAgCgoKICAgIGZ1bmN0aW9uIHJlZnVuZCgpICBleHRlcm5hbCBzdG9wSW5FbWVyZ2VuY3kgcmV0dXJucyAoYm9vbCkgewoKICAgICAgICByZXF1aXJlKHRvdGFsVG9rZW5zU2VudCA8IG1pbkNhcCk7IAogICAgICAgIHJlcXVpcmUodGhpcy5iYWxhbmNlID4gMCk7ICAvLyBjb250cmFjdCB3aWxsIGhvbGQgMCBldGhlciBhdCB0aGUgZW5kIG9mIGNhbXBhaWduLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29udHJhY3QgbmVlZHMgdG8gYmUgZnVuZGVkIHRocm91Z2ggZnVuZENvbnRyYWN0KCkgCgogICAgICAgIEJhY2tlciBzdG9yYWdlIGJhY2tlciA9IGJhY2tlcnNbbXNnLnNlbmRlcl07CgogICAgICAgIGlmIChiYWNrZXIud2VpUmVjZWl2ZWQgPT0gMCkKICAgICAgICAgICAgcmV2ZXJ0KCk7CgogICAgICAgIHJlcXVpcmUoIWJhY2tlci5yZWZ1bmRlZCk7CiAgICAgICAgcmVxdWlyZShiYWNrZXIudG9rZW5zU2VudCAhPSAwKTsKCiAgICAgICAgaWYgKCF0b2tlbi5idXJuKG1zZy5zZW5kZXIsIGJhY2tlci50b2tlbnNTZW50KSkKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgYmFja2VyLnJlZnVuZGVkID0gdHJ1ZTsKICAgICAgCiAgICAgICAgcmVmdW5kQ291bnQgKys7CiAgICAgICAgdG90YWxSZWZ1bmRlZCA9IHRvdGFsUmVmdW5kZWQuYWRkKGJhY2tlci53ZWlSZWNlaXZlZCk7CiAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihiYWNrZXIud2VpUmVjZWl2ZWQpOwogICAgICAgIFJlZnVuZEVUSChtc2cuc2VuZGVyLCBiYWNrZXIud2VpUmVjZWl2ZWQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9CgovLyBUaGUgdG9rZW4KY29udHJhY3QgVG9rZW4gaXMgRVJDMjAsICBPd25hYmxlIHsKCiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKICAgIC8vIFB1YmxpYyB2YXJpYWJsZXMgb2YgdGhlIHRva2VuCiAgICBzdHJpbmcgcHVibGljIG5hbWU7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsKICAgIHVpbnQ4IHB1YmxpYyBkZWNpbWFsczsgLy8gSG93IG1hbnkgZGVjaW1hbHMgdG8gc2hvdy4KICAgIHN0cmluZyBwdWJsaWMgdmVyc2lvbiA9ICJ2MC4xIjsgICAgICAgCiAgICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseTsKICAgIGJvb2wgcHVibGljIGxvY2tlZDsKICAgIGFkZHJlc3MgcHVibGljIGNyb3dkU2FsZUFkZHJlc3M7CiAgICAKCgogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIGJhbGFuY2VzOwogICAgbWFwcGluZyhhZGRyZXNzID0+IG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50KSkgYWxsb3dlZDsKCiAgICAvLyB0b2tlbnMgYXJlIGxvY2tlZCBkdXJpbmcgdGhlIElDTy4gQWxsb3cgdHJhbnNmZXIgb2YgdG9rZW5zIGFmdGVyIElDTy4gCiAgICBtb2RpZmllciBvbmx5VW5sb2NrZWQoKSB7CiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gY3Jvd2RTYWxlQWRkcmVzcyAmJiBsb2NrZWQpIAogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICBfOwogICAgfQoKCiAgICAvLyBhbGxvdyBidXJuaW5nIG9mIHRva2VucyBvbmx5IGJ5IGF1dGhvcml6ZWQgdXNlcnMgCiAgICBtb2RpZmllciBvbmx5QXV0aG9yaXplZCgpIHsKICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lciAmJiBtc2cuc2VuZGVyICE9IGNyb3dkU2FsZUFkZHJlc3MgKSAKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgXzsKICAgIH0KCgogICAgLy8gVGhlIFRva2VuIAogICAgZnVuY3Rpb24gVG9rZW4oYWRkcmVzcyBfY3Jvd2RTYWxlQWRkcmVzcykgcHVibGljIHsKICAgICAgICAKICAgICAgICBsb2NrZWQgPSB0cnVlOyAgLy8gTG9jayB0aGUgdHJhbnNmQ3Jvd2RzYWxlZXIgZnVuY3Rpb24gZHVyaW5nIHRoZSBjcm93ZHNhbGUKICAgICAgICB0b3RhbFN1cHBseSA9IDIxMDAwMDAwZTE4OyAKICAgICAgICBuYW1lID0gIkxvdHRlcnkgVG9rZW4iOyAvLyBTZXQgdGhlIG5hbWUgZm9yIGRpc3BsYXkgcHVycG9zZXMKICAgICAgICBzeW1ib2wgPSAiRVRIRCI7IC8vIFNldCB0aGUgc3ltYm9sIGZvciBkaXNwbGF5IHB1cnBvc2VzCiAgICAgICAgZGVjaW1hbHMgPSAxODsgLy8gQW1vdW50IG9mIGRlY2ltYWxzIGZvciBkaXNwbGF5IHB1cnBvc2VzCiAgICAgICAgY3Jvd2RTYWxlQWRkcmVzcyA9IF9jcm93ZFNhbGVBZGRyZXNzOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICBiYWxhbmNlc1tjcm93ZFNhbGVBZGRyZXNzXSA9IHRvdGFsU3VwcGx5OwogICAgfQoKICAgIGZ1bmN0aW9uIHVubG9jaygpIHB1YmxpYyBvbmx5QXV0aG9yaXplZCB7CiAgICAgICAgbG9ja2VkID0gZmFsc2U7CiAgICB9CgogICAgZnVuY3Rpb24gbG9jaygpIHB1YmxpYyBvbmx5QXV0aG9yaXplZCB7CiAgICAgICAgbG9ja2VkID0gdHJ1ZTsKICAgIH0KICAgIAoKICAgIGZ1bmN0aW9uIGJ1cm4oIGFkZHJlc3MgX21lbWJlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyBvbmx5QXV0aG9yaXplZCByZXR1cm5zKGJvb2wpIHsKICAgICAgICBiYWxhbmNlc1tfbWVtYmVyXSA9IGJhbGFuY2VzW19tZW1iZXJdLnN1YihfdmFsdWUpOwogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuc3ViKF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIoX21lbWJlciwgMHgwLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcHVibGljIG9ubHlVbmxvY2tlZCByZXR1cm5zKGJvb2wpIHsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyBvbmx5VW5sb2NrZWQgcmV0dXJucyhib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXF1aXJlIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlKTsgLy8gQ2hlY2sgaWYgdGhlIHNlbmRlciBoYXMgZW5vdWdoICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIHJlcXVpcmUgKF92YWx1ZSA8PSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSk7IC8vIENoZWNrIGlmIGFsbG93ZWQgaXMgZ3JlYXRlciBvciBlcXVhbCAgICAgICAgCiAgICAgICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOyAvLyBTdWJ0cmFjdCBmcm9tIHRoZSBzZW5kZXIKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsgLy8gQWRkIHRoZSBzYW1lIHRvIHRoZSByZWNpcGllbnQKICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnQgYmFsYW5jZSkgewogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogICAgfQoKCiAgICAvKioKICAgICogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICAqCiAgICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgICogYW5kIHRoZSBuZXcgYWxsb3dhbmNlIGJ5IHVuZm9ydHVuYXRlIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcwogICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgoKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnModWludCByZW1haW5pbmcpIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KCiAgICAvKioKICAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgICovCiAgICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgICAgICB9CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCn0='.
	

]
