Class {
	#name : #SRT9a6a87ff80a327e10f995e747e77d4a29999175e,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT9a6a87ff80a327e10f995e747e77d4a29999175e >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovLyBGaWxlOiBjb250cmFjdHMvTWlncmF0aW9uVGFyZ2V0LnNvbAoKLy8KLy8gTWlncmF0aW9uIHRhcmdldAovLyBAZGV2IEltcGxlbWVudCB0aGlzIGludGVyZmFjZSB0byBtYWtlIG1pZ3JhdGlvbiB0YXJnZXQKLy8KY29udHJhY3QgTWlncmF0aW9uVGFyZ2V0IHsKICBmdW5jdGlvbiBtaWdyYXRlRnJvbShhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF9hbW91bnQsIHVpbnQyNTYgX3Jld2FyZHMsIHVpbnQyNTYgX3RydWVCdXksIGJvb2wgX2RldlN0YXR1cykgcHVibGljOwp9CgovLyBGaWxlOiBjb250cmFjdHMvT3duYWJsZS5zb2wKCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKICAvLyBFdmVudAogIGV2ZW50IE93bmVyc2hpcENoYW5nZWQoYWRkcmVzcyBpbmRleGVkIG9sZE93bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKICAvLyBNb2RpZmllcgogIG1vZGlmaWVyIG9ubHlPd25lciB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIGVtaXQgT3duZXJzaGlwQ2hhbmdlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9FUkMyMC5zb2wKCmNvbnRyYWN0IEVSQzIwIHsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHZpZXcgcHVibGljIHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHZpZXcgcHVibGljIHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKfQoKLy8gRmlsZTogY29udHJhY3RzL1NhZmVNYXRoLnNvbAoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKQogICAgaW50ZXJuYWwKICAgIHB1cmUKICAgIHJldHVybnMgKHVpbnQyNTYpCiAgewogICAgaWYgKGEgPT0gMCkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpCiAgICBpbnRlcm5hbAogICAgcHVyZQogICAgcmV0dXJucyAodWludDI1NikKICB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKQogICAgaW50ZXJuYWwKICAgIHB1cmUKICAgIHJldHVybnMgKHVpbnQyNTYpCiAgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpCiAgICBpbnRlcm5hbAogICAgcHVyZQogICAgcmV0dXJucyAodWludDI1NikKICB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgovLyBGaWxlOiBjb250cmFjdHMvU3RhbmRhcmRUb2tlbi5zb2wKCi8qICBFUkMgMjAgdG9rZW4gKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCB7CiAgLyoqCiAgICogSW50ZXJuYWwgdHJhbnNmZXIsIG9ubHkgY2FuIGJlIGNhbGxlZCBieSB0aGlzIGNvbnRyYWN0CiAgICovCiAgZnVuY3Rpb24gX3RyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAvLyBQcmV2ZW50IHRyYW5zZmVyIHRvIDB4MCBhZGRyZXNzLiBVc2UgYnVybigpIGluc3RlYWQKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgLy8gQ2hlY2sgaWYgdGhlIHNlbmRlciBoYXMgZW5vdWdoCiAgICByZXF1aXJlKGJhbGFuY2VzW19mcm9tXSA+PSBfdmFsdWUpOwogICAgLy8gQ2hlY2sgZm9yIG92ZXJmbG93cwogICAgcmVxdWlyZShiYWxhbmNlc1tfdG9dICsgX3ZhbHVlID4gYmFsYW5jZXNbX3RvXSk7CiAgICAvLyBTYXZlIHRoaXMgZm9yIGFuIGFzc2VydGlvbiBpbiB0aGUgZnV0dXJlCiAgICB1aW50MjU2IHByZXZpb3VzQmFsYW5jZXMgPSBiYWxhbmNlc1tfZnJvbV0gKyBiYWxhbmNlc1tfdG9dOwogICAgLy8gU3VidHJhY3QgZnJvbSB0aGUgc2VuZGVyCiAgICBiYWxhbmNlc1tfZnJvbV0gLT0gX3ZhbHVlOwogICAgLy8gQWRkIHRoZSBzYW1lIHRvIHRoZSByZWNpcGllbnQKICAgIGJhbGFuY2VzW190b10gKz0gX3ZhbHVlOwogICAgZW1pdCBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgLy8gQXNzZXJ0cyBhcmUgdXNlZCB0byB1c2Ugc3RhdGljIGFuYWx5c2lzIHRvIGZpbmQgYnVncyBpbiB5b3VyIGNvZGUuIFRoZXkgc2hvdWxkIG5ldmVyIGZhaWwKICAgIGFzc2VydChiYWxhbmNlc1tfZnJvbV0gKyBiYWxhbmNlc1tfdG9dID09IHByZXZpb3VzQmFsYW5jZXMpOwoKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogVHJhbnNmZXIgdG9rZW5zCiAgICoKICAgKiBTZW5kIGBfdmFsdWVgIHRva2VucyB0byBgX3RvYCBmcm9tIHlvdXIgYWNjb3VudAogICAqCiAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICogQHBhcmFtIF92YWx1ZSB0aGUgYW1vdW50IHRvIHNlbmQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJldHVybiBfdHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogIH0KCiAgLyoqCiAgICogVHJhbnNmZXIgdG9rZW5zIGZyb20gb3RoZXIgYWRkcmVzcwogICAqCiAgICogU2VuZCBgX3ZhbHVlYCB0b2tlbnMgdG8gYF90b2AgaW4gYmVoYWxmIG9mIGBfZnJvbWAKICAgKgogICAqIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyCiAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICogQHBhcmFtIF92YWx1ZSB0aGUgYW1vdW50IHRvIHNlbmQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSk7ICAgICAvLyBDaGVjayBhbGxvd2FuY2UKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdIC09IF92YWx1ZTsKICAgIHJldHVybiBfdHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgdmlldyBwdWJsaWMgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9CgogIC8qKgogICAqIFNldCBhbGxvd2FuY2UgZm9yIG90aGVyIGFkZHJlc3MKICAgKgogICAqIEFsbG93cyBgX3NwZW5kZXJgIHRvIHNwZW5kIG5vIG1vcmUgdGhhbiBgX3ZhbHVlYCB0b2tlbnMgaW4geW91ciBiZWhhbGYKICAgKgogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBhdXRob3JpemVkIHRvIHNwZW5kCiAgICogQHBhcmFtIF92YWx1ZSB0aGUgbWF4IGFtb3VudCB0aGV5IGNhbiBzcGVuZAogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgZW1pdCBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBiYWxhbmNlczsKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIHB1YmxpYyBhbGxvd2VkOwp9CgovLyBGaWxlOiBjb250cmFjdHMvUm95YWx0eVRva2VuLnNvbAoKLyogIFJveWFsdHkgdG9rZW4gKi8KY29udHJhY3QgUm95YWx0eVRva2VuIGlzIFN0YW5kYXJkVG9rZW4gewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogIC8vIHJlc3RyaWN0ZWQgYWRkcmVzc2VzCQogIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgcmVzdHJpY3RlZEFkZHJlc3NlczsKICAKICBldmVudCBSZXN0cmljdGVkU3RhdHVzQ2hhbmdlZChhZGRyZXNzIGluZGV4ZWQgX2FkZHJlc3MsIGJvb2wgc3RhdHVzKTsKCiAgc3RydWN0IEFjY291bnQgewogICAgdWludDI1NiBiYWxhbmNlOwogICAgdWludDI1NiBsYXN0Um95YWx0eVBvaW50OwogIH0KCiAgbWFwcGluZyhhZGRyZXNzID0+IEFjY291bnQpIHB1YmxpYyBhY2NvdW50czsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFJveWFsdHk7CiAgdWludDI1NiBwdWJsaWMgdW5jbGFpbWVkUm95YWx0eTsKCiAgLyoqCiAgICogR2V0IFJveWFsdHkgYW1vdW50IGZvciBnaXZlbiBhY2NvdW50CiAgICoKICAgKiBAcGFyYW0gYWNjb3VudCBUaGUgYWRkcmVzcyBmb3IgUm95YWx0eSBhY2NvdW50CiAgICovCiAgZnVuY3Rpb24gUm95YWx0eXNPd2luZyhhZGRyZXNzIGFjY291bnQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgbmV3Um95YWx0eSA9IHRvdGFsUm95YWx0eS5zdWIoYWNjb3VudHNbYWNjb3VudF0ubGFzdFJveWFsdHlQb2ludCk7CiAgICByZXR1cm4gYmFsYW5jZXNbYWNjb3VudF0ubXVsKG5ld1JveWFsdHkpLmRpdih0b3RhbFN1cHBseSk7CiAgfQoKICAvKioKICAgKiBAZGV2IFVwZGF0ZSBhY2NvdW50IGZvciBSb3lhbHR5CiAgICogQHBhcmFtIGFjY291bnQgVGhlIGFkZHJlc3Mgb2Ygb3duZXIKICAgKi8KICBmdW5jdGlvbiB1cGRhdGVBY2NvdW50KGFkZHJlc3MgYWNjb3VudCkgaW50ZXJuYWwgewogICAgdWludDI1NiBvd2luZyA9IFJveWFsdHlzT3dpbmcoYWNjb3VudCk7CiAgICBhY2NvdW50c1thY2NvdW50XS5sYXN0Um95YWx0eVBvaW50ID0gdG90YWxSb3lhbHR5OwogICAgaWYgKG93aW5nID4gMCkgewogICAgICB1bmNsYWltZWRSb3lhbHR5ID0gdW5jbGFpbWVkUm95YWx0eS5zdWIob3dpbmcpOwogICAgICBhY2NvdW50c1thY2NvdW50XS5iYWxhbmNlID0gYWNjb3VudHNbYWNjb3VudF0uYmFsYW5jZS5hZGQob3dpbmcpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gZGlzYnVyc2UoKSBwdWJsaWMgcGF5YWJsZSB7CiAgICByZXF1aXJlKHRvdGFsU3VwcGx5ID4gMCk7CiAgICByZXF1aXJlKG1zZy52YWx1ZSA+IDApOwoKICAgIHVpbnQyNTYgbmV3Um95YWx0eSA9IG1zZy52YWx1ZTsKICAgIHRvdGFsUm95YWx0eSA9IHRvdGFsUm95YWx0eS5hZGQobmV3Um95YWx0eSk7CiAgICB1bmNsYWltZWRSb3lhbHR5ID0gdW5jbGFpbWVkUm95YWx0eS5hZGQobmV3Um95YWx0eSk7CiAgfQoKICAvKioKICAgKiBAZGV2IFNlbmQgYF92YWx1ZWAgdG9rZW5zIHRvIGBfdG9gIGZyb20geW91ciBhY2NvdW50CiAgICoKICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQKICAgKiBAcGFyYW0gX3ZhbHVlIHRoZSBhbW91bnQgdG8gc2VuZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgLy8gUmVxdWlyZSB0aGF0IHRoZSBzZW5kZXIgaXMgbm90IHJlc3RyaWN0ZWQKICAgIHJlcXVpcmUocmVzdHJpY3RlZEFkZHJlc3Nlc1ttc2cuc2VuZGVyXSA9PSBmYWxzZSk7CiAgICB1cGRhdGVBY2NvdW50KF90byk7CiAgICB1cGRhdGVBY2NvdW50KG1zZy5zZW5kZXIpOwogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICB9CgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb3RoZXIgYWRkcmVzcy4gU2VuZCBgX3ZhbHVlYCB0b2tlbnMgdG8gYF90b2AgaW4gYmVoYWxmIG9mIGBfZnJvbWAKICAgKgogICAqIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyCiAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICogQHBhcmFtIF92YWx1ZSB0aGUgYW1vdW50IHRvIHNlbmQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oCiAgICBhZGRyZXNzIF9mcm9tLAogICAgYWRkcmVzcyBfdG8sCiAgICB1aW50MjU2IF92YWx1ZQogICkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgdXBkYXRlQWNjb3VudChfdG8pOwogICAgdXBkYXRlQWNjb3VudChfZnJvbSk7CiAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiB3aXRoZHJhd1JveWFsdHkoKSBwdWJsaWMgewogICAgdXBkYXRlQWNjb3VudChtc2cuc2VuZGVyKTsKCiAgICAvLyByZXRyaWV2ZSBSb3lhbHR5IGFtb3VudAogICAgdWludDI1NiBSb3lhbHR5QW1vdW50ID0gYWNjb3VudHNbbXNnLnNlbmRlcl0uYmFsYW5jZTsKICAgIHJlcXVpcmUoUm95YWx0eUFtb3VudCA+IDApOwogICAgYWNjb3VudHNbbXNnLnNlbmRlcl0uYmFsYW5jZSA9IDA7CgogICAgLy8gdHJhbnNmZXIgUm95YWx0eSBhbW91bnQKICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoUm95YWx0eUFtb3VudCk7CiAgfQp9CgovLyBGaWxlOiBjb250cmFjdHMvUTIuc29sCgpjb250cmFjdCBRMiBpcyBPd25hYmxlLCBSb3lhbHR5VG9rZW4gewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBzdHJpbmcgcHVibGljIG5hbWUgPSAiUTIiOwogIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIlEyIjsKICB1aW50OCBwdWJsaWMgZGVjaW1hbHMgPSAxODsKCiAgYm9vbCBwdWJsaWMgd2hpdGVsaXN0ID0gdHJ1ZTsKCiAgLy8gd2hpdGVsaXN0IGFkZHJlc3NlcwogIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgd2hpdGVsaXN0ZWRBZGRyZXNzZXM7CgogIC8vIHRva2VuIGNyZWF0aW9uIGNhcAogIHVpbnQyNTYgcHVibGljIGNyZWF0aW9uQ2FwID0gMTUwMDAwMDAgKiAoMTAgKiogMTgpOyAvLyAxNU0KICB1aW50MjU2IHB1YmxpYyByZXNlcnZlZEZ1bmQgPSAxMDAwMDAwMCAqICgxMCAqKiAxOCk7IC8vIDEwTQoKICAvLyBzdGFnZSBpbmZvCiAgc3RydWN0IFN0YWdlIHsKICAgIHVpbnQ4IG51bWJlcjsKICAgIHVpbnQyNTYgZXhjaGFuZ2VSYXRlOwogICAgdWludDI1NiBzdGFydEJsb2NrOwogICAgdWludDI1NiBlbmRCbG9jazsKICAgIHVpbnQyNTYgY2FwOwogIH0KCiAgLy8gZXZlbnRzCiAgZXZlbnQgTWludFRva2VucyhhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CiAgZXZlbnQgU3RhZ2VTdGFydGVkKHVpbnQ4IF9zdGFnZSwgdWludDI1NiBfdG90YWxTdXBwbHksIHVpbnQyNTYgX2JhbGFuY2UpOwogIGV2ZW50IFN0YWdlRW5kZWQodWludDggX3N0YWdlLCB1aW50MjU2IF90b3RhbFN1cHBseSwgdWludDI1NiBfYmFsYW5jZSk7CiAgZXZlbnQgV2hpdGVsaXN0U3RhdHVzQ2hhbmdlZChhZGRyZXNzIGluZGV4ZWQgX2FkZHJlc3MsIGJvb2wgc3RhdHVzKTsKICBldmVudCBXaGl0ZWxpc3RDaGFuZ2VkKGJvb2wgc3RhdHVzKTsKCiAgLy8gZXRoIHdhbGxldAogIGFkZHJlc3MgcHVibGljIGV0aFdhbGxldDsKICBtYXBwaW5nICh1aW50OCA9PiBTdGFnZSkgc3RhZ2VzOwoKICAvLyBjdXJyZW50IHN0YXRlIGluZm8KICB1aW50OCBwdWJsaWMgY3VycmVudFN0YWdlOwoKICBmdW5jdGlvbiBRMihhZGRyZXNzIF9ldGhXYWxsZXQpIHB1YmxpYyB7CiAgICBldGhXYWxsZXQgPSBfZXRoV2FsbGV0OwoKICAgIC8vIHJlc2VydmVkIHRva2VucwogICAgbWludFRva2VucyhldGhXYWxsZXQsIHJlc2VydmVkRnVuZCk7CiAgfQoKICBmdW5jdGlvbiBtaW50VG9rZW5zKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHsKICAgIHJlcXVpcmUodmFsdWUgPiAwKTsKICAgIGJhbGFuY2VzW3RvXSA9IGJhbGFuY2VzW3RvXS5hZGQodmFsdWUpOwogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQodmFsdWUpOwogICAgcmVxdWlyZSh0b3RhbFN1cHBseSA8PSBjcmVhdGlvbkNhcCk7CgogICAgLy8gYnJvYWRjYXN0IGV2ZW50CiAgICBlbWl0IE1pbnRUb2tlbnModG8sIHZhbHVlKTsKICB9CgogIGZ1bmN0aW9uICgpIHB1YmxpYyBwYXlhYmxlIHsKICAgIGJ1eVRva2VucygpOwogIH0KCiAgZnVuY3Rpb24gYnV5VG9rZW5zKCkgcHVibGljIHBheWFibGUgewogICAgcmVxdWlyZSh3aGl0ZWxpc3Q9PWZhbHNlIHx8IHdoaXRlbGlzdGVkQWRkcmVzc2VzW21zZy5zZW5kZXJdID09IHRydWUpOwogICAgcmVxdWlyZShtc2cudmFsdWUgPiAwKTsKCiAgICBTdGFnZSBtZW1vcnkgc3RhZ2UgPSBzdGFnZXNbY3VycmVudFN0YWdlXTsKICAgIHJlcXVpcmUoYmxvY2subnVtYmVyID49IHN0YWdlLnN0YXJ0QmxvY2sgJiYgYmxvY2subnVtYmVyIDw9IHN0YWdlLmVuZEJsb2NrKTsKCiAgICB1aW50MjU2IHRva2VucyA9IG1zZy52YWx1ZSAqIHN0YWdlLmV4Y2hhbmdlUmF0ZTsKICAgIHJlcXVpcmUodG90YWxTdXBwbHkuYWRkKHRva2VucykgPD0gc3RhZ2UuY2FwKTsKCiAgICBtaW50VG9rZW5zKG1zZy5zZW5kZXIsIHRva2Vucyk7CiAgfQoKICBmdW5jdGlvbiBzdGFydFN0YWdlKAogICAgdWludDI1NiBfZXhjaGFuZ2VSYXRlLAogICAgdWludDI1NiBfY2FwLAogICAgdWludDI1NiBfc3RhcnRCbG9jaywKICAgIHVpbnQyNTYgX2VuZEJsb2NrCiAgKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUoX2V4Y2hhbmdlUmF0ZSA+IDAgJiYgX2NhcCA+IDApOwogICAgcmVxdWlyZShfc3RhcnRCbG9jayA+IGJsb2NrLm51bWJlcik7CiAgICByZXF1aXJlKF9zdGFydEJsb2NrIDwgX2VuZEJsb2NrKTsKCiAgICAvLyBzdG9wIGN1cnJlbnQgc3RhZ2UgaWYgaXQncyBydW5uaW5nCiAgICBTdGFnZSBtZW1vcnkgY3VycmVudE9iaiA9IHN0YWdlc1tjdXJyZW50U3RhZ2VdOwogICAgaWYgKGN1cnJlbnRPYmouZW5kQmxvY2sgPiAwKSB7CiAgICAgIC8vIGJyb2FkY2FzdCBzdGFnZSBlbmQgZXZlbnQKICAgICAgZW1pdCBTdGFnZUVuZGVkKGN1cnJlbnRTdGFnZSwgdG90YWxTdXBwbHksIGFkZHJlc3ModGhpcykuYmFsYW5jZSk7CiAgICB9CgogICAgLy8gaW5jcmVtZW50IGN1cnJlbnQgc3RhZ2UKICAgIGN1cnJlbnRTdGFnZSA9IGN1cnJlbnRTdGFnZSArIDE7CgogICAgLy8gY3JlYXRlIG5ldyBzdGFnZSBvYmplY3QKICAgIFN0YWdlIG1lbW9yeSBzID0gU3RhZ2UoewogICAgICBudW1iZXI6IGN1cnJlbnRTdGFnZSwKICAgICAgc3RhcnRCbG9jazogX3N0YXJ0QmxvY2ssCiAgICAgIGVuZEJsb2NrOiBfZW5kQmxvY2ssCiAgICAgIGV4Y2hhbmdlUmF0ZTogX2V4Y2hhbmdlUmF0ZSwKICAgICAgY2FwOiBfY2FwICsgdG90YWxTdXBwbHkKICAgIH0pOwogICAgc3RhZ2VzW2N1cnJlbnRTdGFnZV0gPSBzOwoKICAgIC8vIGJyb2FkY2FzdCBzdGFnZSBzdGFydGVkIGV2ZW50CiAgICBlbWl0IFN0YWdlU3RhcnRlZChjdXJyZW50U3RhZ2UsIHRvdGFsU3VwcGx5LCBhZGRyZXNzKHRoaXMpLmJhbGFuY2UpOwogIH0KCiAgZnVuY3Rpb24gd2l0aGRyYXcoKSBwdWJsaWMgb25seU93bmVyIHsKICAgIGV0aFdhbGxldC50cmFuc2ZlcihhZGRyZXNzKHRoaXMpLmJhbGFuY2UpOwogIH0KCiAgZnVuY3Rpb24gZ2V0Q3VycmVudFN0YWdlKCkgdmlldyBwdWJsaWMgcmV0dXJucyAoCiAgICB1aW50OCBudW1iZXIsCiAgICB1aW50MjU2IGV4Y2hhbmdlUmF0ZSwKICAgIHVpbnQyNTYgc3RhcnRCbG9jaywKICAgIHVpbnQyNTYgZW5kQmxvY2ssCiAgICB1aW50MjU2IGNhcAogICkgewogICAgU3RhZ2UgbWVtb3J5IGN1cnJlbnRPYmogPSBzdGFnZXNbY3VycmVudFN0YWdlXTsKICAgIG51bWJlciA9IGN1cnJlbnRPYmoubnVtYmVyOwogICAgZXhjaGFuZ2VSYXRlID0gY3VycmVudE9iai5leGNoYW5nZVJhdGU7CiAgICBzdGFydEJsb2NrID0gY3VycmVudE9iai5zdGFydEJsb2NrOwogICAgZW5kQmxvY2sgPSBjdXJyZW50T2JqLmVuZEJsb2NrOwogICAgY2FwID0gY3VycmVudE9iai5jYXA7CiAgfQoKICBmdW5jdGlvbiBjaGFuZ2VXaGl0ZWxpc3RTdGF0dXMoYWRkcmVzcyBfYWRkcmVzcywgYm9vbCBzdGF0dXMpIHB1YmxpYyBvbmx5T3duZXIgewogICAgd2hpdGVsaXN0ZWRBZGRyZXNzZXNbX2FkZHJlc3NdID0gc3RhdHVzOwogICAgZW1pdCBXaGl0ZWxpc3RTdGF0dXNDaGFuZ2VkKF9hZGRyZXNzLCBzdGF0dXMpOwogIH0KCiAgZnVuY3Rpb24gY2hhbmdlUmVzdHJpY3RlZHRTdGF0dXMoYWRkcmVzcyBfYWRkcmVzcywgYm9vbCBzdGF0dXMpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVzdHJpY3RlZEFkZHJlc3Nlc1tfYWRkcmVzc10gPSBzdGF0dXM7CiAgICBlbWl0IFJlc3RyaWN0ZWRTdGF0dXNDaGFuZ2VkKF9hZGRyZXNzLCBzdGF0dXMpOwogIH0KICAKICBmdW5jdGlvbiBjaGFuZ2VXaGl0ZWxpc3QoYm9vbCBzdGF0dXMpIHB1YmxpYyBvbmx5T3duZXIgewogICAgIHdoaXRlbGlzdCA9IHN0YXR1czsKICAgICBlbWl0IFdoaXRlbGlzdENoYW5nZWQoc3RhdHVzKTsKICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9RdWFydGVycy5zb2wKCmludGVyZmFjZSBUb2tlblJlY2lwaWVudCB7CiAgZnVuY3Rpb24gcmVjZWl2ZUFwcHJvdmFsKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlLCBhZGRyZXNzIF90b2tlbiwgYnl0ZXMgX2V4dHJhRGF0YSkgZXh0ZXJuYWw7Cn0KCmNvbnRyYWN0IFF1YXJ0ZXJzIGlzIE93bmFibGUsIFN0YW5kYXJkVG9rZW4gewogIC8vIFB1YmxpYyB2YXJpYWJsZXMgb2YgdGhlIHRva2VuCiAgc3RyaW5nIHB1YmxpYyBuYW1lID0gIlF1YXJ0ZXJzIjsKICBzdHJpbmcgcHVibGljIHN5bWJvbCA9ICJRIjsKICB1aW50OCBwdWJsaWMgZGVjaW1hbHMgPSAwOyAvLyBubyBkZWNpbWFscywgb25seSBpbnRlZ2VyIHF1YXJ0ZXJzCgogIHVpbnQxNiBwdWJsaWMgZXRoUmF0ZSA9IDQwMDA7IC8vIFF1YXJ0ZXJzL0VUSAogIHVpbnQyNTYgcHVibGljIHRyYW5jaGUgPSA0MDAwMDsgLy8gTnVtYmVyIG9mIFF1YXJ0ZXJzIGluIGluaXRpYWwgdHJhbmNoZQoKICAvLyBMaXN0IG9mIGRldmVsb3BlcnMKICAvLyBhZGRyZXNzIC0+IHN0YXR1cwogIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIGRldmVsb3BlcnM7CgogIHVpbnQyNTYgcHVibGljIG91dHN0YW5kaW5nUXVhcnRlcnM7CiAgYWRkcmVzcyBwdWJsaWMgcTI7CgogIC8vIG51bWJlciBvZiBRdWFydGVycyBmb3IgbmV4dCB0cmFuY2hlCiAgdWludDggcHVibGljIHRyYW5jaGVOdW1lcmF0b3IgPSAyOwogIHVpbnQ4IHB1YmxpYyB0cmFuY2hlRGVub21pbmF0b3IgPSAxOwoKICAvLyBpbml0aWFsIG11bHRpcGxlcywgcmF0ZXMgKGFzIHBlcmNlbnRhZ2VzKSBmb3IgdGllcnMgb2YgZGV2ZWxvcGVycwogIHVpbnQzMiBwdWJsaWMgbWVnYSA9IDIwOwogIHVpbnQzMiBwdWJsaWMgbWVnYVJhdGUgPSAxMTU7CiAgdWludDMyIHB1YmxpYyBsYXJnZSA9IDEwMDsKICB1aW50MzIgcHVibGljIGxhcmdlUmF0ZSA9IDkwOwogIHVpbnQzMiBwdWJsaWMgbWVkaXVtID0gMjAwMDsKICB1aW50MzIgcHVibGljIG1lZGl1bVJhdGUgPSA3NTsKICB1aW50MzIgcHVibGljIHNtYWxsID0gNTAwMDA7CiAgdWludDMyIHB1YmxpYyBzbWFsbFJhdGUgPSA1MDsKICB1aW50MzIgcHVibGljIG1pY3JvUmF0ZSA9IDI1OwoKICAvLyByZXdhcmRzIHJlbGF0ZWQgc3RvcmFnZQogIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIHJld2FyZHM7ICAgIC8vIHJld2FyZHMgZWFybmVkLCBidXQgbm90IHlldCBjb2xsZWN0ZWQKICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyB0cnVlQnV5OyAgICAvLyB0cmFuY2hlIHJld2FyZHMgYXJlIHNldCBiYXNlZCBvbiAqYWN0dWFsKiBwdXJjaGFzZXMgb2YgUXVhcnRlcnMKCiAgdWludDI1NiBwdWJsaWMgcmV3YXJkQW1vdW50ID0gNDA7CgogIHVpbnQ4IHB1YmxpYyByZXdhcmROdW1lcmF0b3IgPSAxOwogIHVpbnQ4IHB1YmxpYyByZXdhcmREZW5vbWluYXRvciA9IDQ7CgogIC8vIHJlc2VydmUgRVRIIGZyb20gUTIgdG8gZnVuZCByZXdhcmRzCiAgdWludDI1NiBwdWJsaWMgcmVzZXJ2ZUVUSD0wOwoKICAvLyBFVEggcmF0ZSBjaGFuZ2VkCiAgZXZlbnQgRXRoUmF0ZUNoYW5nZWQodWludDE2IGN1cnJlbnRSYXRlLCB1aW50MTYgbmV3UmF0ZSk7CgogIC8vIFRoaXMgbm90aWZpZXMgY2xpZW50cyBhYm91dCB0aGUgYW1vdW50IGJ1cm50CiAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgdWludDI1NiB2YWx1ZSk7CgogIGV2ZW50IFF1YXJ0ZXJzT3JkZXJlZChhZGRyZXNzIGluZGV4ZWQgc2VuZGVyLCB1aW50MjU2IGV0aFZhbHVlLCB1aW50MjU2IHRva2Vucyk7CiAgZXZlbnQgRGV2ZWxvcGVyU3RhdHVzQ2hhbmdlZChhZGRyZXNzIGluZGV4ZWQgZGV2ZWxvcGVyLCBib29sIHN0YXR1cyk7CiAgZXZlbnQgVHJhbmNoZUluY3JlYXNlZCh1aW50MjU2IF90cmFuY2hlLCB1aW50MjU2IF9ldGhlclBvb2wsIHVpbnQyNTYgX291dHN0YW5kaW5nUXVhcnRlcnMpOwogIGV2ZW50IE1lZ2FFYXJuaW5ncyhhZGRyZXNzIGluZGV4ZWQgZGV2ZWxvcGVyLCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IF9iYXNlUmF0ZSwgdWludDI1NiBfdHJhbmNoZSwgdWludDI1NiBfb3V0c3RhbmRpbmdRdWFydGVycywgdWludDI1NiBfZXRoZXJQb29sKTsKICBldmVudCBXaXRoZHJhdyhhZGRyZXNzIGluZGV4ZWQgZGV2ZWxvcGVyLCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IF9iYXNlUmF0ZSwgdWludDI1NiBfdHJhbmNoZSwgdWludDI1NiBfb3V0c3RhbmRpbmdRdWFydGVycywgdWludDI1NiBfZXRoZXJQb29sKTsKICBldmVudCBCYXNlUmF0ZUNoYW5nZWQodWludDI1NiBfYmFzZVJhdGUsIHVpbnQyNTYgX3RyYW5jaGUsIHVpbnQyNTYgX291dHN0YW5kaW5nUXVhcnRlcnMsIHVpbnQyNTYgX2V0aGVyUG9vbCwgIHVpbnQyNTYgX3RvdGFsU3VwcGx5KTsKICBldmVudCBSZXdhcmQoYWRkcmVzcyBpbmRleGVkIF9hZGRyZXNzLCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IF9vdXRzdGFuZGluZ1F1YXJ0ZXJzLCB1aW50MjU2IF90b3RhbFN1cHBseSk7CgogIC8qKgogICAqIGRldmVsb3BlciBtb2RpZmllcgogICAqLwogIG1vZGlmaWVyIG9ubHlBY3RpdmVEZXZlbG9wZXIoKSB7CiAgICByZXF1aXJlKGRldmVsb3BlcnNbbXNnLnNlbmRlcl0gPT0gdHJ1ZSk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQ29uc3RydWN0b3IgZnVuY3Rpb24KICAgKgogICAqIEluaXRpYWxpemVzIGNvbnRyYWN0IHdpdGggaW5pdGlhbCBzdXBwbHkgdG9rZW5zIHRvIHRoZSBvd25lciBvZiB0aGUgY29udHJhY3QKICAgKi8KICBmdW5jdGlvbiBRdWFydGVycygKICAgIGFkZHJlc3MgX3EyLAogICAgdWludDI1NiBmaXJzdFRyYW5jaGUKICApIHB1YmxpYyB7CiAgICBxMiA9IF9xMjsKICAgIHRyYW5jaGUgPSBmaXJzdFRyYW5jaGU7IC8vIG51bWJlciBvZiBRdWFydGVycyB0byBiZSBzb2xkIGJlZm9yZSBpbmNyZWFzaW5nIHByaWNlCiAgfQoKICBmdW5jdGlvbiBzZXRFdGhSYXRlICh1aW50MTYgcmF0ZSkgb25seU93bmVyIHB1YmxpYyB7CiAgICAvLyBFdGhlciBwcmljZSBpcyBzZXQgaW4gV2VpCiAgICByZXF1aXJlKHJhdGUgPiAwKTsKICAgIGV0aFJhdGUgPSByYXRlOwogICAgZW1pdCBFdGhSYXRlQ2hhbmdlZChldGhSYXRlLCByYXRlKTsKICB9CgogIC8qKgogICAqIEFkanVzdCByZXdhcmQgYW1vdW50CiAgICovCiAgZnVuY3Rpb24gYWRqdXN0UmV3YXJkICh1aW50MjU2IHJld2FyZCkgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXdhcmRBbW91bnQgPSByZXdhcmQ7IC8vIG1heSBiZSB6ZXJvLCBubyBuZWVkIHRvIGNoZWNrIHZhbHVlIHRvIDAKICB9CgogIGZ1bmN0aW9uIGFkanVzdFdpdGhkcmF3UmF0ZSh1aW50MzIgbWVnYTIsIHVpbnQzMiBtZWdhUmF0ZTIsIHVpbnQzMiBsYXJnZTIsIHVpbnQzMiBsYXJnZVJhdGUyLCB1aW50MzIgbWVkaXVtMiwgdWludDMyIG1lZGl1bVJhdGUyLCB1aW50MzIgc21hbGwyLCB1aW50MzIgc21hbGxSYXRlMiwgdWludDMyIG1pY3JvUmF0ZTIpIG9ubHlPd25lciBwdWJsaWMgewogICAgLy8gdGhlIHZhbHVlcyAobWVnYSwgbGFyZ2UsIG1lZGl1bSwgc21hbGwpIGFyZSBtdWx0aXBsZXMsIGUuZy4sIDIweCwgMTAweCwgMTAwMDB4CiAgICAvLyB0aGUgcmF0ZXMgKG1lZ2FSYXRlLCBldGMuKSBhcmUgcGVyY2VudGFnZSBwb2ludHMsIGUuZy4sIDE1MCBpcyAxNTAlIG9mIHRoZSByZW1haW5pbmcgZXRoZXJQb29sCiAgICBpZiAobWVnYTIgPiAwICYmIG1lZ2FSYXRlMiA+IDApIHsKICAgICAgbWVnYSA9IG1lZ2EyOwogICAgICBtZWdhUmF0ZSA9IG1lZ2FSYXRlMjsKICAgIH0KCiAgICBpZiAobGFyZ2UyID4gMCAmJiBsYXJnZVJhdGUyID4gMCkgewogICAgICBsYXJnZSA9IGxhcmdlMjsKICAgICAgbGFyZ2VSYXRlID0gbGFyZ2VSYXRlMjsKICAgIH0KCiAgICBpZiAobWVkaXVtMiA+IDAgJiYgbWVkaXVtUmF0ZTIgPiAwKSB7CiAgICAgIG1lZGl1bSA9IG1lZGl1bTI7CiAgICAgIG1lZGl1bVJhdGUgPSBtZWRpdW1SYXRlMjsKICAgIH0KCiAgICBpZiAoc21hbGwyID4gMCAmJiBzbWFsbFJhdGUyID4gMCl7CiAgICAgIHNtYWxsID0gc21hbGwyOwogICAgICBzbWFsbFJhdGUgPSBzbWFsbFJhdGUyOwogICAgfQoKICAgIGlmIChtaWNyb1JhdGUyID4gMCkgewogICAgICBtaWNyb1JhdGUgPSBtaWNyb1JhdGUyOwogICAgfQogIH0KCiAgLyoqCiAgICogYWRqdXN0IHRyYW5jaGUgZm9yIG5leHQgY3ljbGUKICAgKi8KICBmdW5jdGlvbiBhZGp1c3ROZXh0VHJhbmNoZSAodWludDggbnVtZXJhdG9yLCB1aW50OCBkZW5vbWluYXRvcikgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKG51bWVyYXRvciA+IDAgJiYgZGVub21pbmF0b3IgPiAwKTsKICAgIHRyYW5jaGVOdW1lcmF0b3IgPSBudW1lcmF0b3I7CiAgICB0cmFuY2hlRGVub21pbmF0b3IgPSBkZW5vbWluYXRvcjsKICB9CgogIGZ1bmN0aW9uIGFkanVzdFRyYW5jaGUodWludDI1NiB0cmFuY2hlMikgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKHRyYW5jaGUyID4gMCk7CiAgICB0cmFuY2hlID0gdHJhbmNoZTI7CiAgfQoKICAvKioKICAgKiBBZGp1c3QgcmV3YXJkcyBmb3IgYF9hZGRyZXNzYAogICAqLwogIGZ1bmN0aW9uIHVwZGF0ZVBsYXllclJld2FyZHMoYWRkcmVzcyBfYWRkcmVzcykgaW50ZXJuYWwgewogICAgcmVxdWlyZShfYWRkcmVzcyAhPSBhZGRyZXNzKDApKTsKCiAgICB1aW50MjU2IF9yZXdhcmQgPSAwOwogICAgaWYgKHJld2FyZHNbX2FkZHJlc3NdID09IDApIHsKICAgICAgX3Jld2FyZCA9IHJld2FyZEFtb3VudDsKICAgIH0gZWxzZSBpZiAocmV3YXJkc1tfYWRkcmVzc10gPCB0cmFuY2hlKSB7CiAgICAgIF9yZXdhcmQgPSB0cnVlQnV5W19hZGRyZXNzXSAqIHJld2FyZE51bWVyYXRvciAvIHJld2FyZERlbm9taW5hdG9yOwogICAgfQoKICAgIGlmIChfcmV3YXJkID4gMCkgewogICAgICAvLyB1cGRhdGUgcmV3YXJkcyByZWNvcmQKICAgICAgcmV3YXJkc1tfYWRkcmVzc10gPSB0cmFuY2hlOwoKICAgICAgYmFsYW5jZXNbX2FkZHJlc3NdICs9IF9yZXdhcmQ7CiAgICAgIGFsbG93ZWRbX2FkZHJlc3NdW21zZy5zZW5kZXJdICs9IF9yZXdhcmQ7IC8vIHNldCBhbGxvd2FuY2UKCiAgICAgIHRvdGFsU3VwcGx5ICs9IF9yZXdhcmQ7CiAgICAgIG91dHN0YW5kaW5nUXVhcnRlcnMgKz0gX3Jld2FyZDsKCiAgICAgIHVpbnQyNTYgc3BlbnRFVEggPSAoX3Jld2FyZCAqICgxMCAqKiAxOCkpIC8gZXRoUmF0ZTsKICAgICAgaWYgKHJlc2VydmVFVEggPj0gc3BlbnRFVEgpIHsKICAgICAgICAgIHJlc2VydmVFVEggLT0gc3BlbnRFVEg7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlc2VydmVFVEggPSAwOwogICAgICAgIH0KCiAgICAgIC8vIHRyYW5jaGUgc2l6ZSBjaGFuZ2UKICAgICAgX2NoYW5nZVRyYW5jaGVJZk5lZWRlZCgpOwoKICAgICAgZW1pdCBBcHByb3ZhbChfYWRkcmVzcywgbXNnLnNlbmRlciwgX3Jld2FyZCk7CiAgICAgIGVtaXQgUmV3YXJkKF9hZGRyZXNzLCBfcmV3YXJkLCBvdXRzdGFuZGluZ1F1YXJ0ZXJzLCB0b3RhbFN1cHBseSk7CiAgICB9CiAgfQoKICAvKioKICAgKiBEZXZlbG9wZXIgc3RhdHVzCiAgICovCiAgZnVuY3Rpb24gc2V0RGV2ZWxvcGVyU3RhdHVzIChhZGRyZXNzIF9hZGRyZXNzLCBib29sIHN0YXR1cykgb25seU93bmVyIHB1YmxpYyB7CiAgICBkZXZlbG9wZXJzW19hZGRyZXNzXSA9IHN0YXR1czsKICAgIGVtaXQgRGV2ZWxvcGVyU3RhdHVzQ2hhbmdlZChfYWRkcmVzcywgc3RhdHVzKTsKICB9CgogIC8qKgogICAqIFNldCBhbGxvd2FuY2UgZm9yIG90aGVyIGFkZHJlc3MgYW5kIG5vdGlmeQogICAqCiAgICogQWxsb3dzIGBfc3BlbmRlcmAgdG8gc3BlbmQgbm8gbW9yZSB0aGFuIGBfdmFsdWVgIHRva2VucyBpbiB5b3VyIGJlaGFsZiwgYW5kIHRoZW4gcGluZyB0aGUgY29udHJhY3QgYWJvdXQgaXQKICAgKgogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBhdXRob3JpemVkIHRvIHNwZW5kCiAgICogQHBhcmFtIF92YWx1ZSB0aGUgbWF4IGFtb3VudCB0aGV5IGNhbiBzcGVuZAogICAqIEBwYXJhbSBfZXh0cmFEYXRhIHNvbWUgZXh0cmEgaW5mb3JtYXRpb24gdG8gc2VuZCB0byB0aGUgYXBwcm92ZWQgY29udHJhY3QKICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlQW5kQ2FsbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2V4dHJhRGF0YSkKICBwdWJsaWMKICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIFRva2VuUmVjaXBpZW50IHNwZW5kZXIgPSBUb2tlblJlY2lwaWVudChfc3BlbmRlcik7CiAgICBpZiAoYXBwcm92ZShfc3BlbmRlciwgX3ZhbHVlKSkgewogICAgICBzcGVuZGVyLnJlY2VpdmVBcHByb3ZhbChtc2cuc2VuZGVyLCBfdmFsdWUsIHRoaXMsIF9leHRyYURhdGEpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICAvKioKICAgKiBEZXN0cm95IHRva2VucwogICAqCiAgICogUmVtb3ZlIGBfdmFsdWVgIHRva2VucyBmcm9tIHRoZSBzeXN0ZW0gaXJyZXZlcnNpYmx5CiAgICoKICAgKiBAcGFyYW0gX3ZhbHVlIHRoZSBhbW91bnQgb2YgbW9uZXkgdG8gYnVybgogICAqLwogIGZ1bmN0aW9uIGJ1cm4odWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJlcXVpcmUoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlKTsgICAvLyBDaGVjayBpZiB0aGUgc2VuZGVyIGhhcyBlbm91Z2gKICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdIC09IF92YWx1ZTsgICAgICAgICAgICAvLyBTdWJ0cmFjdCBmcm9tIHRoZSBzZW5kZXIKICAgIHRvdGFsU3VwcGx5IC09IF92YWx1ZTsgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGVzIHRvdGFsU3VwcGx5CiAgICBvdXRzdGFuZGluZ1F1YXJ0ZXJzIC09IF92YWx1ZTsgICAgICAgICAgICAgIC8vIFVwZGF0ZSBvdXRzdGFuZGluZyBxdWFydGVycwogICAgZW1pdCBCdXJuKG1zZy5zZW5kZXIsIF92YWx1ZSk7CgogICAgLy8gbG9nIHJhdGUgY2hhbmdlCiAgICBlbWl0IEJhc2VSYXRlQ2hhbmdlZChnZXRCYXNlUmF0ZSgpLCB0cmFuY2hlLCBvdXRzdGFuZGluZ1F1YXJ0ZXJzLCBhZGRyZXNzKHRoaXMpLmJhbGFuY2UsIHRvdGFsU3VwcGx5KTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogRGVzdHJveSB0b2tlbnMgZnJvbSBvdGhlciBhY2NvdW50CiAgICoKICAgKiBSZW1vdmUgYF92YWx1ZWAgdG9rZW5zIGZyb20gdGhlIHN5c3RlbSBpcnJldmVyc2libHkgb24gYmVoYWxmIG9mIGBfZnJvbWAuCiAgICoKICAgKiBAcGFyYW0gX2Zyb20gdGhlIGFkZHJlc3Mgb2YgdGhlIHNlbmRlcgogICAqIEBwYXJhbSBfdmFsdWUgdGhlIGFtb3VudCBvZiBtb25leSB0byBidXJuCiAgICovCiAgZnVuY3Rpb24gYnVybkZyb20oYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJlcXVpcmUoYmFsYW5jZXNbX2Zyb21dID49IF92YWx1ZSk7ICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSB0YXJnZXRlZCBiYWxhbmNlIGlzIGVub3VnaAogICAgcmVxdWlyZShfdmFsdWUgPD0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0pOyAgICAgLy8gQ2hlY2sgYWxsb3dhbmNlCiAgICBiYWxhbmNlc1tfZnJvbV0gLT0gX3ZhbHVlOyAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTdWJ0cmFjdCBmcm9tIHRoZSB0YXJnZXRlZCBiYWxhbmNlCiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7ICAgICAgICAgICAgICAvLyBTdWJ0cmFjdCBmcm9tIHRoZSBzZW5kZXIncyBhbGxvd2FuY2UKICAgIHRvdGFsU3VwcGx5IC09IF92YWx1ZTsgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRvdGFsU3VwcGx5CiAgICBvdXRzdGFuZGluZ1F1YXJ0ZXJzIC09IF92YWx1ZTsgICAgICAgICAgICAgIC8vIFVwZGF0ZSBvdXRzdGFuZGluZyBxdWFydGVycwogICAgZW1pdCBCdXJuKF9mcm9tLCBfdmFsdWUpOwoKICAgIC8vIGxvZyByYXRlIGNoYW5nZQogICAgZW1pdCBCYXNlUmF0ZUNoYW5nZWQoZ2V0QmFzZVJhdGUoKSwgdHJhbmNoZSwgb3V0c3RhbmRpbmdRdWFydGVycywgYWRkcmVzcyh0aGlzKS5iYWxhbmNlLCB0b3RhbFN1cHBseSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEJ1eSBxdWFydGVycyBieSBzZW5kaW5nIGV0aGVycyB0byBjb250cmFjdCBhZGRyZXNzIChubyBkYXRhIHJlcXVpcmVkKQogICAqLwogIGZ1bmN0aW9uICgpIHBheWFibGUgcHVibGljIHsKICAgIF9idXkobXNnLnNlbmRlcik7CiAgfQoKCiAgZnVuY3Rpb24gYnV5KCkgcGF5YWJsZSBwdWJsaWMgewogICAgX2J1eShtc2cuc2VuZGVyKTsKICB9CgogIGZ1bmN0aW9uIGJ1eUZvcihhZGRyZXNzIGJ1eWVyKSBwYXlhYmxlIHB1YmxpYyB7CiAgICB1aW50MjU2IF92YWx1ZSA9ICBfYnV5KGJ1eWVyKTsKCiAgICAvLyBhbGxvdyBkb25vciAobXNnLnNlbmRlcikgdG8gc3BlbmQgYnV5ZXIncyB0b2tlbnMKICAgIGFsbG93ZWRbYnV5ZXJdW21zZy5zZW5kZXJdICs9IF92YWx1ZTsKICAgIGVtaXQgQXBwcm92YWwoYnV5ZXIsIG1zZy5zZW5kZXIsIF92YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBfY2hhbmdlVHJhbmNoZUlmTmVlZGVkKCkgaW50ZXJuYWwgewogICAgaWYgKHRvdGFsU3VwcGx5ID49IHRyYW5jaGUpIHsKICAgICAgLy8gY2hhbmdlIHRyYW5jaGUgc2l6ZSBmb3IgbmV4dCBjeWNsZQogICAgICB0cmFuY2hlID0gKHRyYW5jaGUgKiB0cmFuY2hlTnVtZXJhdG9yKSAvIHRyYW5jaGVEZW5vbWluYXRvcjsKCiAgICAgIC8vIGZpcmUgZXZlbnQgZm9yIHRyYW5jaGUgY2hhbmdlCiAgICAgIGVtaXQgVHJhbmNoZUluY3JlYXNlZCh0cmFuY2hlLCBhZGRyZXNzKHRoaXMpLmJhbGFuY2UsIG91dHN0YW5kaW5nUXVhcnRlcnMpOwogICAgfQogIH0KCiAgLy8gcmV0dXJucyBudW1iZXIgb2YgcXVhcnRlcnMgYnV5ZXIgZ290CiAgZnVuY3Rpb24gX2J1eShhZGRyZXNzIGJ1eWVyKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXF1aXJlKGJ1eWVyICE9IGFkZHJlc3MoMCkpOwoKICAgIHVpbnQyNTYgbnEgPSAobXNnLnZhbHVlICogZXRoUmF0ZSkgLyAoMTAgKiogMTgpOwogICAgcmVxdWlyZShucSAhPSAwKTsKICAgIGlmIChucSA+IHRyYW5jaGUpIHsKICAgICAgbnEgPSB0cmFuY2hlOwogICAgfQoKICAgIHRvdGFsU3VwcGx5ICs9IG5xOwogICAgYmFsYW5jZXNbYnV5ZXJdICs9IG5xOwogICAgdHJ1ZUJ1eVtidXllcl0gKz0gbnE7CiAgICBvdXRzdGFuZGluZ1F1YXJ0ZXJzICs9IG5xOwoKICAgIC8vIGNoYW5nZSB0cmFuY2hlIHNpemUKICAgIF9jaGFuZ2VUcmFuY2hlSWZOZWVkZWQoKTsKCiAgICAvLyBldmVudCBmb3IgcXVhcnRlcnMgb3JkZXIgKGludm9pY2UpCiAgICBlbWl0IFF1YXJ0ZXJzT3JkZXJlZChidXllciwgbXNnLnZhbHVlLCBucSk7CgogICAgLy8gbG9nIHJhdGUgY2hhbmdlCiAgICBlbWl0IEJhc2VSYXRlQ2hhbmdlZChnZXRCYXNlUmF0ZSgpLCB0cmFuY2hlLCBvdXRzdGFuZGluZ1F1YXJ0ZXJzLCBhZGRyZXNzKHRoaXMpLmJhbGFuY2UsIHRvdGFsU3VwcGx5KTsKCiAgICAvLyB0cmFuc2ZlciBvd25lcidzIGN1dAogICAgUTIocTIpLmRpc2J1cnNlLnZhbHVlKG1zZy52YWx1ZSAqIDE1IC8gMTAwKSgpOwoKICAgIC8vIHJldHVybiBucQogICAgcmV0dXJuIG5xOwogIH0KCiAgLyoqCiAgICogVHJhbnNmZXIgYWxsb3dhbmNlIGZyb20gb3RoZXIgYWRkcmVzcydzIGFsbG93YW5jZQogICAqCiAgICogU2VuZCBgX3ZhbHVlYCB0b2tlbnMgdG8gYF90b2AgaW4gYmVoYWxmIG9mIGBfZnJvbWAKICAgKgogICAqIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyCiAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICogQHBhcmFtIF92YWx1ZSB0aGUgYW1vdW50IHRvIHNlbmQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckFsbG93YW5jZShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHVwZGF0ZVBsYXllclJld2FyZHMoX2Zyb20pOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0pOyAgICAgLy8gQ2hlY2sgYWxsb3dhbmNlCiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CgogICAgaWYgKF90cmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpKSB7CiAgICAgIC8vIGFsbG93IG1zZy5zZW5kZXIgdG8gc3BlbmQgX3RvJ3MgdG9rZW5zCiAgICAgIGFsbG93ZWRbX3RvXVttc2cuc2VuZGVyXSArPSBfdmFsdWU7CiAgICAgIGVtaXQgQXBwcm92YWwoX3RvLCBtc2cuc2VuZGVyLCBfdmFsdWUpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBmdW5jdGlvbiB3aXRoZHJhdyh1aW50MjU2IHZhbHVlKSBvbmx5QWN0aXZlRGV2ZWxvcGVyIHB1YmxpYyB7CiAgICByZXF1aXJlKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IHZhbHVlKTsKCiAgICB1aW50MjU2IGJhc2VSYXRlID0gZ2V0QmFzZVJhdGUoKTsKICAgIHJlcXVpcmUoYmFzZVJhdGUgPiAwKTsgLy8gY2hlY2sgaWYgYmFzZSByYXRlID4gMAoKICAgIHVpbnQyNTYgZWFybmluZ3MgPSB2YWx1ZSAqIGJhc2VSYXRlOwogICAgdWludDI1NiByYXRlID0gZ2V0UmF0ZSh2YWx1ZSk7IC8vIGdldCByYXRlIGZyb20gdmFsdWUgYW5kIHRyYW5jaGUKICAgIHVpbnQyNTYgZWFybmluZ3NXaXRoQm9udXMgPSAocmF0ZSAqIGVhcm5pbmdzKSAvIDEwMDsKICAgIGlmIChlYXJuaW5nc1dpdGhCb251cyA+IGFkZHJlc3ModGhpcykuYmFsYW5jZSkgewogICAgICBlYXJuaW5ncyA9IGFkZHJlc3ModGhpcykuYmFsYW5jZTsKICAgIH0gZWxzZSB7CiAgICAgIGVhcm5pbmdzID0gZWFybmluZ3NXaXRoQm9udXM7CiAgICB9CgogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gLT0gdmFsdWU7CiAgICBvdXRzdGFuZGluZ1F1YXJ0ZXJzIC09IHZhbHVlOyAvLyB1cGRhdGUgdGhlIG91dHN0YW5kaW5nIFF1YXJ0ZXJzCgogICAgdWludDI1NiBldGhlclBvb2wgPSBhZGRyZXNzKHRoaXMpLmJhbGFuY2UgLSBlYXJuaW5nczsKICAgIGlmIChyYXRlID09IG1lZ2FSYXRlKSB7CiAgICAgIGVtaXQgTWVnYUVhcm5pbmdzKG1zZy5zZW5kZXIsIGVhcm5pbmdzLCBiYXNlUmF0ZSwgdHJhbmNoZSwgb3V0c3RhbmRpbmdRdWFydGVycywgZXRoZXJQb29sKTsgLy8gd2l0aCBjdXJyZW50IGJhc2UgcmF0ZQogICAgfQoKICAgIC8vIGV2ZW50IGZvciB3aXRoZHJhdwogICAgZW1pdCBXaXRoZHJhdyhtc2cuc2VuZGVyLCBlYXJuaW5ncywgYmFzZVJhdGUsIHRyYW5jaGUsIG91dHN0YW5kaW5nUXVhcnRlcnMsIGV0aGVyUG9vbCk7ICAvLyB3aXRoIGN1cnJlbnQgYmFzZSByYXRlCgogICAgLy8gbG9nIHJhdGUgY2hhbmdlCiAgICBlbWl0IEJhc2VSYXRlQ2hhbmdlZChnZXRCYXNlUmF0ZSgpLCB0cmFuY2hlLCBvdXRzdGFuZGluZ1F1YXJ0ZXJzLCBhZGRyZXNzKHRoaXMpLmJhbGFuY2UsIHRvdGFsU3VwcGx5KTsKCiAgICAvLyBlYXJuaW5nIGZvciBkZXZlbG9wZXJzCiAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKGVhcm5pbmdzKTsgIAp9CgogIGZ1bmN0aW9uIGRpc2J1cnNlKCkgcHVibGljIHBheWFibGUgewogICAgcmVzZXJ2ZUVUSCArPSBtc2cudmFsdWU7CiAgfQoKICBmdW5jdGlvbiBnZXRCYXNlUmF0ZSAoKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAob3V0c3RhbmRpbmdRdWFydGVycyA+IDApIHsKICAgICAgcmV0dXJuIChhZGRyZXNzKHRoaXMpLmJhbGFuY2UgLSByZXNlcnZlRVRIKSAvIG91dHN0YW5kaW5nUXVhcnRlcnM7CiAgICB9CgogICAgcmV0dXJuIChhZGRyZXNzKHRoaXMpLmJhbGFuY2UgLSByZXNlcnZlRVRIKTsKICB9CgogIGZ1bmN0aW9uIGdldFJhdGUgKHVpbnQyNTYgdmFsdWUpIHZpZXcgcHVibGljIHJldHVybnMgKHVpbnQzMikgewogICAgaWYgKHZhbHVlICogbWVnYSA+IHRyYW5jaGUpIHsgIC8vIHNpemUgJiByYXRlIGZvciBtZWdhIGRldmVsb3BlcgogICAgICByZXR1cm4gbWVnYVJhdGU7CiAgICB9IGVsc2UgaWYgKHZhbHVlICogbGFyZ2UgPiB0cmFuY2hlKSB7ICAgLy8gc2l6ZSAmIHJhdGUgZm9yIGxhcmdlIGRldmVsb3BlcgogICAgICByZXR1cm4gbGFyZ2VSYXRlOwogICAgfSBlbHNlIGlmICh2YWx1ZSAqIG1lZGl1bSA+IHRyYW5jaGUpIHsgIC8vIHNpemUgYW5kIHJhdGUgZm9yIG1lZGl1bSBkZXZlbG9wZXIKICAgICAgcmV0dXJuIG1lZGl1bVJhdGU7CiAgICB9IGVsc2UgaWYgKHZhbHVlICogc21hbGwgPiB0cmFuY2hlKXsgIC8vIHNpemUgYW5kIHJhdGUgZm9yIHNtYWxsIGRldmVsb3BlcgogICAgICByZXR1cm4gc21hbGxSYXRlOwogICAgfQoKICAgIHJldHVybiBtaWNyb1JhdGU7IC8vIHJhdGUgZm9yIG1pY3JvIGRldmVsb3BlcgogIH0KCgogIC8vCiAgLy8gTWlncmF0aW9ucwogIC8vCgogIC8vIFRhcmdldCBjb250cmFjdAogIGFkZHJlc3MgcHVibGljIG1pZ3JhdGlvblRhcmdldDsKICBib29sIHB1YmxpYyBtaWdyYXRpbmcgPSBmYWxzZTsKCiAgLy8gTWlncmF0ZSBldmVudAogIGV2ZW50IE1pZ3JhdGUoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCB1aW50MjU2IF92YWx1ZSk7CgogIC8vCiAgLy8gTWlncmF0ZSB0b2tlbnMgdG8gdGhlIG5ldyB0b2tlbiBjb250cmFjdC4KICAvLwogIGZ1bmN0aW9uIG1pZ3JhdGUoKSBwdWJsaWMgewogICAgcmVxdWlyZShtaWdyYXRpb25UYXJnZXQgIT0gYWRkcmVzcygwKSk7CiAgICB1aW50MjU2IF9hbW91bnQgPSBiYWxhbmNlc1ttc2cuc2VuZGVyXTsKICAgIHJlcXVpcmUoX2Ftb3VudCA+IDApOwogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSAwOwoKICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkgLSBfYW1vdW50OwogICAgb3V0c3RhbmRpbmdRdWFydGVycyA9IG91dHN0YW5kaW5nUXVhcnRlcnMgLSBfYW1vdW50OwoKICAgIHJld2FyZHNbbXNnLnNlbmRlcl0gPSAwOwogICAgdHJ1ZUJ1eVttc2cuc2VuZGVyXSA9IDA7CiAgICBkZXZlbG9wZXJzW21zZy5zZW5kZXJdID0gZmFsc2U7CgogICAgZW1pdCBNaWdyYXRlKG1zZy5zZW5kZXIsIF9hbW91bnQpOwogICAgTWlncmF0aW9uVGFyZ2V0KG1pZ3JhdGlvblRhcmdldCkubWlncmF0ZUZyb20obXNnLnNlbmRlciwgX2Ftb3VudCwgcmV3YXJkc1ttc2cuc2VuZGVyXSwgdHJ1ZUJ1eVttc2cuc2VuZGVyXSwgZGV2ZWxvcGVyc1ttc2cuc2VuZGVyXSk7CiAgfQoKICAvLwogIC8vIFNldCBhZGRyZXNzIG9mIG1pZ3JhdGlvbiB0YXJnZXQgY29udHJhY3QKICAvLyBAcGFyYW0gX3RhcmdldCBUaGUgYWRkcmVzcyBvZiB0aGUgTWlncmF0aW9uVGFyZ2V0IGNvbnRyYWN0CiAgLy8KICBmdW5jdGlvbiBzZXRNaWdyYXRpb25UYXJnZXQoYWRkcmVzcyBfdGFyZ2V0KSBvbmx5T3duZXIgcHVibGljIHsKICAgIG1pZ3JhdGlvblRhcmdldCA9IF90YXJnZXQ7CiAgfQp9'.
	

]
