Class {
	#name : #SRT3adfc4999f77d04c8341bac5f3a76f58dff5b37a,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT3adfc4999f77d04c8341bac5f3a76f58dff5b37a >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKfQoKY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9Cgpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwoKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICB1aW50MjU2IF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKCiAgICAvLyBDaGVjayBpcyBub3QgbmVlZGVkIGJlY2F1c2Ugc3ViKF9hbGxvd2FuY2UsIF92YWx1ZSkgd2lsbCBhbHJlYWR5IHRocm93IGlmIHRoaXMgY29uZGl0aW9uIGlzIG5vdCBtZXQKICAgIC8vIHJlcXVpcmUgKF92YWx1ZSA8PSBfYWxsb3dhbmNlKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAqCiAgICogQmV3YXJlIHRoYXQgY2hhbmdpbmcgYW4gYWxsb3dhbmNlIHdpdGggdGhpcyBtZXRob2QgYnJpbmdzIHRoZSByaXNrIHRoYXQgc29tZW9uZSBtYXkgdXNlIGJvdGggdGhlIG9sZAogICAqIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZSB0cmFuc2FjdGlvbiBvcmRlcmluZy4gT25lIHBvc3NpYmxlIHNvbHV0aW9uIHRvIG1pdGlnYXRlIHRoaXMKICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KCiAgLyoqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgfSBlbHNlIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKfQoKY29udHJhY3QgTWludGFibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwogIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwoKICBib29sIHB1YmxpYyBtaW50aW5nRmluaXNoZWQgPSBmYWxzZTsKCgogIG1vZGlmaWVyIGNhbk1pbnQoKSB7CiAgICByZXF1aXJlKCFtaW50aW5nRmluaXNoZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gbWludCB0b2tlbnMKICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCByZWNlaXZlIHRoZSBtaW50ZWQgdG9rZW5zLgogICAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIG1pbnQuCiAgICogQHJldHVybiBBIGJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIG9ubHlPd25lciBjYW5NaW50IHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfYW1vdW50KTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfYW1vdW50KTsKICAgIE1pbnQoX3RvLCBfYW1vdW50KTsKICAgIFRyYW5zZmVyKDB4MCwgX3RvLCBfYW1vdW50KTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBzdG9wIG1pbnRpbmcgbmV3IHRva2Vucy4KICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBmaW5pc2hNaW50aW5nKCkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBtaW50aW5nRmluaXNoZWQgPSB0cnVlOwogICAgTWludEZpbmlzaGVkKCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCmNvbnRyYWN0IE11bHRpT3duZXJzIHsKCiAgICBldmVudCBBY2Nlc3NHcmFudChhZGRyZXNzIGluZGV4ZWQgb3duZXIpOwogICAgZXZlbnQgQWNjZXNzUmV2b2tlKGFkZHJlc3MgaW5kZXhlZCBvd25lcik7CiAgICAKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBvd25lcnM7CgogICAgZnVuY3Rpb24gTXVsdGlPd25lcnMoKSB7CiAgICAgICAgb3duZXJzW21zZy5zZW5kZXJdID0gdHJ1ZTsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5T3duZXIoKSB7IAogICAgICAgIHJlcXVpcmUob3duZXJzW21zZy5zZW5kZXJdID09IHRydWUpOwogICAgICAgIF87IAogICAgfQoKICAgIGZ1bmN0aW9uIGlzT3duZXIoKSBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIG93bmVyc1ttc2cuc2VuZGVyXSA/IHRydWUgOiBmYWxzZTsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGVja093bmVyKGFkZHJlc3MgbWF5YmVfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gb3duZXJzW21heWJlX293bmVyXSA/IHRydWUgOiBmYWxzZTsKICAgIH0KCgogICAgZnVuY3Rpb24gZ3JhbnQoYWRkcmVzcyBfb3duZXIpIG9ubHlPd25lciB7CiAgICAgICAgb3duZXJzW19vd25lcl0gPSB0cnVlOwogICAgICAgIEFjY2Vzc0dyYW50KF9vd25lcik7CiAgICB9CgogICAgZnVuY3Rpb24gcmV2b2tlKGFkZHJlc3MgX293bmVyKSBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciAhPSBfb3duZXIpOwogICAgICAgIG93bmVyc1tfb3duZXJdID0gZmFsc2U7CiAgICAgICAgQWNjZXNzUmV2b2tlKF9vd25lcik7CiAgICB9Cn0KCmNvbnRyYWN0IFNhbGUgaXMgTXVsdGlPd25lcnMgewogICAgLy8gTWluaW1hbCBwb3NzaWJsZSBjYXAgaW4gZXRoZXJzCiAgICB1aW50MjU2IHB1YmxpYyBzb2Z0Q2FwOwoKICAgIC8vIE1heGltdW0gcG9zc2libGUgY2FwIGluIGV0aGVycwogICAgdWludDI1NiBwdWJsaWMgaGFyZENhcDsKCiAgICAvLyB0b3RhbEV0aGVycyByZWNlaXZlZAogICAgdWludDI1NiBwdWJsaWMgdG90YWxFdGhlcnM7CgogICAgLy8gU3NhbGUgdG9rZW4KICAgIFRva2VuIHB1YmxpYyB0b2tlbjsKCiAgICAvLyBXaXRoZHJhdyB3YWxsZXQKICAgIGFkZHJlc3MgcHVibGljIHdhbGxldDsKCiAgICAvLyBNYXhpbXVtIGF2YWlsYWJsZSB0byBzZWxsIHRva2VucwogICAgdWludDI1NiBwdWJsaWMgbWF4aW11bVRva2VuczsKCiAgICAvLyBNaW5pbWFsIGV0aGVyCiAgICB1aW50MjU2IHB1YmxpYyBtaW5pbWFsRXRoZXI7CgogICAgLy8gVG9rZW4gcGVyIGV0aGVyCiAgICB1aW50MjU2IHB1YmxpYyB3ZWlQZXJUb2tlbjsKCiAgICAvLyBzdGFydCBhbmQgZW5kIHRpbWVzdGFtcCB3aGVyZSBpbnZlc3RtZW50cyBhcmUgYWxsb3dlZCAoYm90aCBpbmNsdXNpdmUpCiAgICB1aW50MjU2IHB1YmxpYyBzdGFydFRpbWU7CiAgICB1aW50MjU2IHB1YmxpYyBlbmRUaW1lOwoKICAgIC8vIHJlZnVuZCBpZiBzb2Z0Q2FwIGlzIG5vdCByZWFjaGVkCiAgICBib29sIHB1YmxpYyByZWZ1bmRBbGxvd2VkOwoKICAgIC8vIAogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBldGhlckJhbGFuY2VzOwoKICAgIC8vIAogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyB3aGl0ZWxpc3Q7CgogICAgLy8gYm91bnR5IHRva2VucwogICAgdWludDI1NiBwdWJsaWMgYm91bnR5UmV3YXJkOwoKICAgIC8vIHRlYW0gdG9rZW5zCiAgICB1aW50MjU2IHB1YmxpYyB0ZWFtUmV3YXJkOwoKICAgIC8vIGZvdW5kZXIgdG9rZW5zCiAgICB1aW50MjU2IHB1YmxpYyBmb3VuZGVyUmV3YXJkOwoKCiAgICBldmVudCBUb2tlblB1cmNoYXNlKGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB2YWx1ZSwgdWludDI1NiBhbW91bnQpOwogICAgZXZlbnQgV2hpdGVsaXN0KGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB2YWx1ZSk7CgogICAgbW9kaWZpZXIgdmFsaWRQdXJjaGFzZShhZGRyZXNzIGNvbnRyaWJ1dG9yKSB7CiAgICAgICAgYm9vbCB3aXRoaW5QZXJpb2QgPSAoKG5vdyA+PSBzdGFydFRpbWUgfHwgY2hlY2tXaGl0ZWxpc3QoY29udHJpYnV0b3IsIG1zZy52YWx1ZSkpICYmIG5vdyA8PSBlbmRUaW1lKTsKICAgICAgICBib29sIG5vblplcm9QdXJjaGFzZSA9IG1zZy52YWx1ZSAhPSAwOwogICAgICAgIHJlcXVpcmUod2l0aGluUGVyaW9kICYmIG5vblplcm9QdXJjaGFzZSk7CgogICAgICAgIF87ICAgICAgICAKICAgIH0KCiAgICBtb2RpZmllciBpc1N0YXJ0ZWQoKSB7CiAgICAgICAgcmVxdWlyZShub3cgPj0gc3RhcnRUaW1lKTsKCiAgICAgICAgXzsgICAgICAgIAogICAgfQoKICAgIG1vZGlmaWVyIGlzRXhwaXJlZCgpIHsKICAgICAgICByZXF1aXJlKG5vdyA+IGVuZFRpbWUpOwoKICAgICAgICBfOyAgICAgICAgCiAgICB9CgogICAgZnVuY3Rpb24gU2FsZSh1aW50MjU2IF9zdGFydFRpbWUsIGFkZHJlc3MgX3dhbGxldCkgewogICAgICAgIHJlcXVpcmUoX3N0YXJ0VGltZSA+PSAgbm93KTsKICAgICAgICByZXF1aXJlKF93YWxsZXQgIT0gMHgwKTsKCiAgICAgICAgdG9rZW4gPSBuZXcgVG9rZW4oKTsKCiAgICAgICAgd2FsbGV0ID0gX3dhbGxldDsKICAgICAgICBzdGFydFRpbWUgPSBfc3RhcnRUaW1lOwoKICAgICAgICBtaW5pbWFsRXRoZXIgPSAxZTE2OyAvLyAwLjAxIGV0aGVyCiAgICAgICAgZW5kVGltZSA9IF9zdGFydFRpbWUgKyAyOCBkYXlzOwogICAgICAgIHdlaVBlclRva2VuID0gMWUxOCAvIDEwMGU4OyAvLyB0b2tlbiBwcmljZQogICAgICAgIGhhcmRDYXAgPSA1NzE0MmUxODsKICAgICAgICBzb2Z0Q2FwID0gMzM1MGUxODsKCiAgICAKICAgICAgICAvLyBXZSBsb3ZlIG91ciBQcmUtSVRPIGJhY2tlcnMKICAgICAgICB0b2tlbi5taW50KDB4OTkyMDY2YTk2NEMyNDFlRDQ5OTZFNzUwMjg0ZDAzOUIxNEExOWZBNSwgMTExOTk5OTk5OTk4NjApOwogICAgICAgIHRva2VuLm1pbnQoMHgxRjRkZjYzQjhkMzJlNTRkOTQxNDFFRjg0NzVjNTVkRjRkYjJhMDJELCA5MzMzMzMzMzMzMTcwKTsKICAgICAgICB0b2tlbi5taW50KDB4Y2UxOTJCZTExRGRFMzc2MzBFZjg0MkUzYUY1ZkJEN2JFQTE1QzZmOSwgMjc5OTk5OTk5OTkzMCk7CiAgICAgICAgdG9rZW4ubWludCgweDE4RDJBRDlERkMwQkEzNUUxMjRFMTA1RTI2OGViQzIyNDMyMzY5NGEsIDExMjAwMDAwMDAwMDApOwogICAgICAgIHRva2VuLm1pbnQoMHg0ZUQxZGI5OGE1NjI1OTRDYkQ0MjE2MTM1NDc0NmVBYWZEMUY5QzQ0LCA5MzMzMzMzMzMzMTApOwogICAgICAgIHRva2VuLm1pbnQoMHgwMEZFYmZjN2JlMzczZjgwODgxODI4NTBGZUNBMDM0RERBOGI3YTY3LCA4OTYwMDAwMDAwMDApOwogICAgICAgIHRva2VuLm1pbnQoMHg4Njg1MGY1ZjdEMDM1ZEQ5NkIwN0E3NWM0ODRENTIwY2ZmMTNlYjU4LCA2MzQ2NjY2NjY2MjApOwogICAgICAgIHRva2VuLm1pbnQoMHgwODc1MERBMzBlOTUyQjZlZjNEMDM0MTcyOTA0Y2E3RWMxYWIxMzNBLCA2MTYwMDAwMDAwMDApOwogICAgICAgIHRva2VuLm1pbnQoMHg0QjYxZURlNDFlN0M4MDM0ZDZiZEYxNzQxY0E5NDkxMDk5Mzc5OGFhLCA1Nzg2NjY2NjY2MjApOwogICAgICAgIHRva2VuLm1pbnQoMHhkY2IwMThFQUQ2YTk0ODQzZWYyMzkxYjMzNTgyOTQwMjA3OTE0NTBiLCA1NjAwMDAwMDAwMDApOwogICAgICAgIHRva2VuLm1pbnQoMHhiNjJFMjc0NDYwNzljMkYyNTc1Qzc5Mjc0Y2Q5MDVCZjFFMWU0ZURiLCA1NjAwMDAwMDAwMDApOwogICAgICAgIHRva2VuLm1pbnQoMHhGRjM3NzMyYTI2OGEyRUQyNzYyN2MxNGM0NWYxMDBiODdFMTdmRkRhLCA1NjAwMDAwMDAwMDApOwogICAgICAgIHRva2VuLm1pbnQoMHg3YkRlRDBENUI2ZTJGOWE0NGY1OTc1MkFmNjMzZTREMWVkMjAwMzkyLCA4MDAwMDAwMDAwMCk7CiAgICAgICAgdG9rZW4ubWludCgweDk5NTUxNmJiMTQ1OGZhN2IxOTJCYjRCYWIwNjM1RmM5QWI0NDdGRDEsIDQ4MDAwMDAwMDAwKTsKICAgICAgICB0b2tlbi5taW50KDB4OTVhN0JFZjkxQTU1MTJkOTU0YzcyMWNjYmQ2ZkM1NDAyNjY3RmFEZSwgMzIwMDAwMDAwMDApOwogICAgICAgIHRva2VuLm1pbnQoMHgzRTEwNTUzZmZmM2E1QWMyOEI5QTdlN2Y0YWZhRkI0QzFENkVmYzBiLCAyNDAwMDAwMDAwMCk7CiAgICAgICAgdG9rZW4ubWludCgweDdDOEU3ZDlCRTg2ODY3M2ExYmZFMDY4Njc0MmFDY2I2RWFGRkVGNkYsIDE3NjAwMDAwMDAwKTsKCiAgICAgICAgbWF4aW11bVRva2VucyA9IHRva2VuLnRvdGFsU3VwcGx5KCkgKyA4MDAwMDAwZTg7CgogICAgICAgIC8vIEFsc28gd2UgbGlrZSBLWUMKICAgICAgICB3aGl0ZWxpc3RbMHhCZDdkQzRCMjJCZkFENzkxQ2Q1ZDM5MzI3RjY3NkUwZEMzYzBDMkQwXSA9IDIwMDAgZXRoZXI7CiAgICAgICAgd2hpdGVsaXN0WzB4ZWJBZDEyRTUwYURCZWIzQzdiNzJmNGE4NzdiQzQzRTdFYzAzQ0Q2MF0gPSAyMDAgZXRoZXI7CiAgICAgICAgd2hpdGVsaXN0WzB4Y0ZDOTMxNWNlZTg4ZTVDNjUwYjVhOTczMThjMkI5RjYzMmFmNjU0N10gPSAyMDAgZXRoZXI7CiAgICAgICAgd2hpdGVsaXN0WzB4QzYzMTg1NzNhMUViNzBCN0IzZDUzRjAwN2Q0NmZjRUIzQ0ZjRUVhQ10gPSAyMDAgZXRoZXI7CiAgICAgICAgd2hpdGVsaXN0WzB4OWQ0MDk2MTE3ZDdGRkNhRDgzMTFBMTUyMjAyOTU4MUQ3QkY2ZjAwOF0gPSAxNTAgZXRoZXI7CiAgICAgICAgd2hpdGVsaXN0WzB4ZmE5OWI3MzNmYzk5NjE3NENFMWVmOTFmZUEyNmIxNUQyYWRDM0UzMV0gPSAxMDAgZXRoZXI7CiAgICAgICAgd2hpdGVsaXN0WzB4ZGJiNzBmYmVkZDI2NjFlZjNiNmJkZjBjMTA1ZTYyZmQxYzYxZGE3Y10gPSAxMDAgZXRoZXI7CiAgICAgICAgd2hpdGVsaXN0WzB4YTE2ZmQ2MEI4MmI4MWI0Mzc0YWMyZjI3MzRGRjBkYTc4RDFDRWYzZl0gPSAxMDAgZXRoZXI7CiAgICAgICAgd2hpdGVsaXN0WzB4OGM5NTBCNThkRDU0QTU0RTkwRDljOEFEOGJFODdCMTBhZDMwQjU5Ql0gPSAxMDAgZXRoZXI7CiAgICAgICAgd2hpdGVsaXN0WzB4NWMzMkJkNzNBZmUxNmIzRGU3OGM4Q2U5MEI2NGU1Njk3OTJFOTQxMV0gPSAxMDAgZXRoZXI7CiAgICAgICAgd2hpdGVsaXN0WzB4NERhZjY5MEE1RjhhNDY2Q2I0OWI0MjRBNzc2YUQ1MDVkMkNEN0I3ZF0gPSAxMDAgZXRoZXI7CiAgICAgICAgd2hpdGVsaXN0WzB4M2RhNzQ4NkRGMEYzNDNBMEU2QUY4RDI2MjU5MTg3NDE3ZWQwOEVDOV0gPSAxMDAgZXRoZXI7CiAgICAgICAgd2hpdGVsaXN0WzB4M2FjMDVhYTFmMDZlOTMwNjQwYzQ4NWE4NmE4MzE3NTBhNmMyMjc1ZV0gPSAxMDAgZXRoZXI7CiAgICAgICAgd2hpdGVsaXN0WzB4MDA5ZTAyYjIxYUJFRmM3RUNDMUYyQjExNzAwYjQ5MTA2RDdENTUyYl0gPSAxMDAgZXRoZXI7CiAgICAgICAgd2hpdGVsaXN0WzB4Q0Q1NDBBMGNDNTI2MDM3OGZjODE4Q0E4MTVFQzhCMjJGOTY2QzBhZl0gPSA4NSBldGhlcjsKICAgICAgICB3aGl0ZWxpc3RbMHg2ZThiNjg4Q0I1NjJhMDI4RTVEOUNiNTVhYzFlRTQzYzIyYzk2OTk1XSA9IDYwIGV0aGVyOwogICAgICAgIHdoaXRlbGlzdFsweGU2RDYyZWM2Mzg1MmIyNDZkM0QzNDhENGIzNzU0ZTBFNzJGNjdkZjRdID0gNTAgZXRoZXI7CiAgICAgICAgd2hpdGVsaXN0WzB4RTEyN0MwYzlBMjc4M2NCYTAxN2E4MzVjMzREN0FGNkNhNjAyYzdDMl0gPSA1MCBldGhlcjsKICAgICAgICB3aGl0ZWxpc3RbMHhEOTMzZDUzMUQzNTRCYjQ5ZTI4MzkzMDc0M0UwYTQ3M0ZDODA5OURmXSA9IDUwIGV0aGVyOwogICAgICAgIHdoaXRlbGlzdFsweDhjM0M1MjRBMmJlNDUxQTY3MDE4M0VlNEEyNDE1ZjBkNjRhOGYxYWVdID0gNTAgZXRoZXI7CiAgICAgICAgd2hpdGVsaXN0WzB4N2UwZmIzMTZBYzkyYjY3NTY5RWQ1YkU1MDBEOUE2OTE3NzMyMTEyZl0gPSA1MCBldGhlcjsKICAgICAgICB3aGl0ZWxpc3RbMHg3MzhDMDkwRDg3ZjY1MzkzNTBmODFjMDIyOTM3NmU0ODM4ZTZjMzYzXSA9IDUwIGV0aGVyOwogICAgICAgIC8vIGFub3RoZXJzIEtZQyB3aWxsIGJlIGFkZGVkIHVzaW5nIGFkZFdoaXRlbGlzdHMKICAgIH0KCiAgICBmdW5jdGlvbiBoYXJkQ2FwUmVhY2hlZCgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuICgoaGFyZENhcCAqIDk5OSkgLyAxMDAwKSA8PSB0b3RhbEV0aGVyczsKICAgIH0KCiAgICBmdW5jdGlvbiBzb2Z0Q2FwUmVhY2hlZCgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXR1cm4gdG90YWxFdGhlcnMgPj0gc29mdENhcDsKICAgIH0KCiAgICAvKgogICAgICogQGRldiBmYWxsYmFjayBmb3IgcHJvY2Vzc2luZyBldGhlcgogICAgICovCiAgICBmdW5jdGlvbigpIHBheWFibGUgewogICAgICAgIHJldHVybiBidXlUb2tlbnMobXNnLnNlbmRlcik7CiAgICB9CgogICAgLyoKICAgICAqIEBkZXYgY2FsY3VsYXRlIGFtb3VudAogICAgICogQHBhcmFtICBfdmFsdWUgLSBldGhlciB0byBiZSBjb252ZXJ0ZWQgdG8gdG9rZW5zCiAgICAgKiBAcGFyYW0gIGF0IC0gY3VycmVudCB0aW1lCiAgICAgKiBAcmV0dXJuIHRva2VuIGFtb3VudCB0aGF0IHdlIHNob3VsZCBzZW5kIHRvIG91ciBkZWFyIGludmVzdG9yCiAgICAgKi8KICAgIGZ1bmN0aW9uIGNhbGNBbW91bnRBdCh1aW50MjU2IF92YWx1ZSwgdWludDI1NiBhdCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICB1aW50IHJhdGU7CgogICAgICAgIGlmKHN0YXJ0VGltZSArIDIgZGF5cyA+PSBhdCkgewogICAgICAgICAgICByYXRlID0gMTQwOwogICAgICAgIH0gZWxzZSBpZihzdGFydFRpbWUgKyA3IGRheXMgPj0gYXQpIHsKICAgICAgICAgICAgcmF0ZSA9IDEzMDsKICAgICAgICB9IGVsc2UgaWYoc3RhcnRUaW1lICsgMTQgZGF5cyA+PSBhdCkgewogICAgICAgICAgICByYXRlID0gMTIwOwogICAgICAgIH0gZWxzZSBpZihzdGFydFRpbWUgKyAyMSBkYXlzID49IGF0KSB7CiAgICAgICAgICAgIHJhdGUgPSAxMTA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmF0ZSA9IDEwNTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICgoX3ZhbHVlICogcmF0ZSkgLyB3ZWlQZXJUb2tlbikgLyAxMDA7CiAgICB9CgogICAgLyoKICAgICAqIEBkZXYgY2hlY2sgY29udHJpYnV0b3IgaXMgd2hpdGVsaXN0ZWQgb3Igbm90IGZvciBidXkgdG9rZW4gCiAgICAgKiBAcGFyYW0gY29udHJpYnV0b3IKICAgICAqIEBwYXJhbSBhbW91bnQgJiMyMjY7woDClCBob3cgbXVjaCBldGhlcnMgY29udHJpYnV0b3Igd2FudHMgdG8gc3BlbmQKICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBhY2Nlc3MgYWxsb3dlZAogICAgICovCiAgICBmdW5jdGlvbiBjaGVja1doaXRlbGlzdChhZGRyZXNzIGNvbnRyaWJ1dG9yLCB1aW50MjU2IGFtb3VudCkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBldGhlckJhbGFuY2VzW2NvbnRyaWJ1dG9yXSArIGFtb3VudCA8PSB3aGl0ZWxpc3RbY29udHJpYnV0b3JdOwogICAgfQoKICAgIC8qCiAgICAgKiBAZGV2IGdyYW50IGJhY2tlciB1bnRpbCBmaXJzdCAyNCBob3VycwogICAgICogQHBhcmFtIGNvbnRyaWJ1dG9yIGFkZHJlc3MKICAgICAqLwogICAgZnVuY3Rpb24gYWRkV2hpdGVsaXN0KGFkZHJlc3MgY29udHJpYnV0b3IsIHVpbnQyNTYgYW1vdW50KSBvbmx5T3duZXIgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBXaGl0ZWxpc3QoY29udHJpYnV0b3IsIGFtb3VudCk7CiAgICAgICAgd2hpdGVsaXN0W2NvbnRyaWJ1dG9yXSA9IGFtb3VudDsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCgogICAgLyoKICAgICAqIEBkZXYgZ3JhbnQgYmFja2VycyB1bnRpbCBmaXJzdCAyNCBob3VycwogICAgICogQHBhcmFtIGNvbnRyaWJ1dG9yIGFkZHJlc3MKICAgICAqLwogICAgZnVuY3Rpb24gYWRkV2hpdGVsaXN0cyhhZGRyZXNzW10gY29udHJpYnV0b3JzLCB1aW50MjU2W10gYW1vdW50cykgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgYWRkcmVzcyBjb250cmlidXRvcjsKICAgICAgICB1aW50MjU2IGFtb3VudDsKCiAgICAgICAgcmVxdWlyZShjb250cmlidXRvcnMubGVuZ3RoID09IGFtb3VudHMubGVuZ3RoKTsKCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgY29udHJpYnV0b3JzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnRyaWJ1dG9yID0gY29udHJpYnV0b3JzW2ldOwogICAgICAgICAgICBhbW91bnQgPSBhbW91bnRzW2ldOwogICAgICAgICAgICByZXF1aXJlKGFkZFdoaXRlbGlzdChjb250cmlidXRvciwgYW1vdW50KSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qCiAgICAgKiBAZGV2IHNlbGwgdG9rZW4gYW5kIHNlbmQgdG8gY29udHJpYnV0b3IgYWRkcmVzcwogICAgICogQHBhcmFtIGNvbnRyaWJ1dG9yIGFkZHJlc3MKICAgICAqLwogICAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgY29udHJpYnV0b3IpIHBheWFibGUgdmFsaWRQdXJjaGFzZShjb250cmlidXRvcikgcHVibGljIHsKICAgICAgICB1aW50MjU2IGFtb3VudCA9IGNhbGNBbW91bnRBdChtc2cudmFsdWUsIGJsb2NrLnRpbWVzdGFtcCk7CiAgCiAgICAgICAgcmVxdWlyZShjb250cmlidXRvciAhPSAweDApIDsKICAgICAgICByZXF1aXJlKG1pbmltYWxFdGhlciA8PSBtc2cudmFsdWUpOwogICAgICAgIHJlcXVpcmUodG9rZW4udG90YWxTdXBwbHkoKSArIGFtb3VudCA8PSBtYXhpbXVtVG9rZW5zKTsKCiAgICAgICAgdG9rZW4ubWludChjb250cmlidXRvciwgYW1vdW50KTsKICAgICAgICBUb2tlblB1cmNoYXNlKGNvbnRyaWJ1dG9yLCBtc2cudmFsdWUsIGFtb3VudCk7CgogICAgICAgIGlmKHNvZnRDYXBSZWFjaGVkKCkpIHsKICAgICAgICAgICAgdG90YWxFdGhlcnMgPSB0b3RhbEV0aGVycyArIG1zZy52YWx1ZTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYmFsYW5jZSA+PSBzb2Z0Q2FwKSB7CiAgICAgICAgICAgIHRvdGFsRXRoZXJzID0gdGhpcy5iYWxhbmNlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGV0aGVyQmFsYW5jZXNbY29udHJpYnV0b3JdID0gZXRoZXJCYWxhbmNlc1tjb250cmlidXRvcl0gKyBtc2cudmFsdWU7CiAgICAgICAgfQoKICAgICAgICByZXF1aXJlKHRvdGFsRXRoZXJzIDw9IGhhcmRDYXApOwogICAgfQoKICAgIC8vIEB3aXRoZHJhdyB0byB3YWxsZXQKICAgIGZ1bmN0aW9uIHdpdGhkcmF3KCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShzb2Z0Q2FwUmVhY2hlZCgpKTsKICAgICAgICByZXF1aXJlKHRoaXMuYmFsYW5jZSA+IDApOwoKICAgICAgICB3YWxsZXQudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgIH0KCiAgICAvLyBAd2l0aGRyYXcgdG9rZW4gdG8gd2FsbGV0CiAgICBmdW5jdGlvbiB3aXRoZHJhd1Rva2VuVG9Gb3VuZGVyKCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZSh0b2tlbi5iYWxhbmNlT2YodGhpcykgPiAwKTsKICAgICAgICByZXF1aXJlKHNvZnRDYXBSZWFjaGVkKCkpOwogICAgICAgIHJlcXVpcmUoc3RhcnRUaW1lICsgMSB5ZWFycyA8IG5vdyk7CgogICAgICAgIHRva2VuLnRyYW5zZmVyKHdhbGxldCwgdG9rZW4uYmFsYW5jZU9mKHRoaXMpKTsKICAgIH0KCiAgICAvLyBAcmVmdW5kIHRvIGJhY2tlcnMsIGlmIHNvZnRDYXAgaXMgbm90IHJlYWNoZWQKICAgIGZ1bmN0aW9uIHJlZnVuZCgpIGlzRXhwaXJlZCBwdWJsaWMgewogICAgICAgIHJlcXVpcmUocmVmdW5kQWxsb3dlZCk7CiAgICAgICAgcmVxdWlyZSghc29mdENhcFJlYWNoZWQoKSk7CiAgICAgICAgcmVxdWlyZShldGhlckJhbGFuY2VzW21zZy5zZW5kZXJdID4gMCk7CiAgICAgICAgcmVxdWlyZSh0b2tlbi5iYWxhbmNlT2YobXNnLnNlbmRlcikgPiAwKTsKCiAgICAgICAgdWludDI1NiBjdXJyZW50X2JhbGFuY2UgPSBldGhlckJhbGFuY2VzW21zZy5zZW5kZXJdOwogICAgICAgIGV0aGVyQmFsYW5jZXNbbXNnLnNlbmRlcl0gPSAwOwogCiAgICAgICAgdG9rZW4uYnVybihtc2cuc2VuZGVyKTsKICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKGN1cnJlbnRfYmFsYW5jZSk7CiAgICB9CgogICAgZnVuY3Rpb24gZmluaXNoQ3Jvd2RzYWxlKCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShub3cgPiBlbmRUaW1lIHx8IGhhcmRDYXBSZWFjaGVkKCkpOwogICAgICAgIHJlcXVpcmUoIXRva2VuLm1pbnRpbmdGaW5pc2hlZCgpKTsKCiAgICAgICAgYm91bnR5UmV3YXJkID0gdG9rZW4udG90YWxTdXBwbHkoKSAqIDMgLyA4MzsgCiAgICAgICAgdGVhbVJld2FyZCA9IHRva2VuLnRvdGFsU3VwcGx5KCkgKiA3IC8gODM7IAogICAgICAgIGZvdW5kZXJSZXdhcmQgPSB0b2tlbi50b3RhbFN1cHBseSgpICogNyAvIDgzOyAKCiAgICAgICAgaWYoc29mdENhcFJlYWNoZWQoKSkgewogICAgICAgICAgICB0b2tlbi5taW50KHdhbGxldCwgYm91bnR5UmV3YXJkKTsKICAgICAgICAgICAgdG9rZW4ubWludCh3YWxsZXQsIHRlYW1SZXdhcmQpOwogICAgICAgICAgICB0b2tlbi5taW50KHRoaXMsIGZvdW5kZXJSZXdhcmQpOwoKICAgICAgICAgICAgdG9rZW4uZmluaXNoTWludGluZyh0cnVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWZ1bmRBbGxvd2VkID0gdHJ1ZTsKICAgICAgICAgICAgdG9rZW4uZmluaXNoTWludGluZyhmYWxzZSk7CiAgICAgICAgfQogICB9CgogICAgLy8gQHJldHVybiB0cnVlIGlmIGNyb3dkc2FsZSBldmVudCBoYXMgZW5kZWQKICAgIGZ1bmN0aW9uIHJ1bm5pbmcoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBub3cgPj0gc3RhcnRUaW1lICYmICEobm93ID4gZW5kVGltZSB8fCBoYXJkQ2FwUmVhY2hlZCgpKTsKICAgIH0KfQoKY29udHJhY3QgVG9rZW4gaXMgTWludGFibGVUb2tlbiB7CgogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gJ1ByaXZhdGl4JzsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gJ1BSSVgnOwogICAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gODsKICAgIGJvb2wgcHVibGljIHRyYW5zZmVyQWxsb3dlZDsKCiAgICBldmVudCBCdXJuKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCB1aW50MjU2IHZhbHVlKTsKICAgIGV2ZW50IFRyYW5zZmVyQWxsb3dlZChib29sKTsKCiAgICBtb2RpZmllciBjYW5UcmFuc2ZlcigpIHsKICAgICAgICByZXF1aXJlKG1pbnRpbmdGaW5pc2hlZCAmJiB0cmFuc2ZlckFsbG93ZWQpOwogICAgICAgIF87ICAgICAgICAKICAgIH0KICAgIAogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgY2FuVHJhbnNmZXIgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oZnJvbSwgdG8sIHZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBjYW5UcmFuc2ZlciByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKHRvLCB2YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gZmluaXNoTWludGluZyhib29sIF90cmFuc2ZlckFsbG93ZWQpIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICAgICAgdHJhbnNmZXJBbGxvd2VkID0gX3RyYW5zZmVyQWxsb3dlZDsKICAgICAgICBUcmFuc2ZlckFsbG93ZWQoX3RyYW5zZmVyQWxsb3dlZCk7CiAgICAgICAgcmV0dXJuIHN1cGVyLmZpbmlzaE1pbnRpbmcoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBidXJuKGFkZHJlc3MgZnJvbSkgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBUcmFuc2Zlcihmcm9tLCAweDAsIGJhbGFuY2VzW2Zyb21dKTsKICAgICAgICBCdXJuKGZyb20sIGJhbGFuY2VzW2Zyb21dKTsKCiAgICAgICAgYmFsYW5jZXNbMHgwXSArPSBiYWxhbmNlc1tmcm9tXTsKICAgICAgICBiYWxhbmNlc1tmcm9tXSA9IDA7CiAgICB9Cn0='.
	

]
