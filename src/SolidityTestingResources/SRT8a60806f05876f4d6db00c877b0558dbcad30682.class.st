Class {
	#name : #SRT8a60806f05876f4d6db00c877b0558dbcad30682,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT8a60806f05876f4d6db00c877b0558dbcad30682 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTY7CgovLyBjb3B5cmlnaHQgPHNwYW4gY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSI0ODJiMjcyNjNjMjkyYjNjMDgwZDNjMjAyZDNhMmQyNTI3MjY2NjJiMjcyNSI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4KCmNvbnRyYWN0IFNhZmVNYXRoIHsKCiAgICAvKiBmdW5jdGlvbiBhc3NlcnQoYm9vbCBhc3NlcnRpb24pIGludGVybmFsIHsgKi8KICAgIC8qICAgaWYgKCFhc3NlcnRpb24pIHsgKi8KICAgIC8qICAgICB0aHJvdzsgKi8KICAgIC8qICAgfSAqLwogICAgLyogfSAgICAgIC8vIGFzc2VydCBubyBsb25nZXIgbmVlZGVkIG9uY2Ugc29saWRpdHkgaXMgb24gMC40LjEwICovCgogICAgZnVuY3Rpb24gc2FmZUFkZCh1aW50MjU2IHgsIHVpbnQyNTYgeSkgcHVyZSBpbnRlcm5hbCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgdWludDI1NiB6ID0geCArIHk7CiAgICAgIGFzc2VydCgoeiA+PSB4KSAmJiAoeiA+PSB5KSk7CiAgICAgIHJldHVybiB6OwogICAgfQoKICAgIGZ1bmN0aW9uIHNhZmVTdWJ0cmFjdCh1aW50MjU2IHgsIHVpbnQyNTYgeSkgcHVyZSBpbnRlcm5hbCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgYXNzZXJ0KHggPj0geSk7CiAgICAgIHVpbnQyNTYgeiA9IHggLSB5OwogICAgICByZXR1cm4gejsKICAgIH0KCiAgICBmdW5jdGlvbiBzYWZlTXVsdCh1aW50MjU2IHgsIHVpbnQyNTYgeSkgcHVyZSBpbnRlcm5hbCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgdWludDI1NiB6ID0geCAqIHk7CiAgICAgIGFzc2VydCgoeCA9PSAwKXx8KHoveCA9PSB5KSk7CiAgICAgIHJldHVybiB6OwogICAgfQoKfQoKY29udHJhY3QgQmFzaWNBY2Nlc3NDb250cm9sIHsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwogICAgYWRkcmVzc1tdIHB1YmxpYyBtb2RlcmF0b3JzOwoKICAgIGZ1bmN0aW9uIEJhc2ljQWNjZXNzQ29udHJvbCgpIHB1YmxpYyB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlNb2RlcmF0b3JzKCkgewogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IG93bmVyKSB7CiAgICAgICAgICAgIGJvb2wgZm91bmQgPSBmYWxzZTsKICAgICAgICAgICAgZm9yICh1aW50IGluZGV4ID0gMDsgaW5kZXggPCBtb2RlcmF0b3JzLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgICAgICAgaWYgKG1vZGVyYXRvcnNbaW5kZXhdID09IG1zZy5zZW5kZXIpIHsKICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmVxdWlyZShmb3VuZCk7CiAgICAgICAgfQogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gQ2hhbmdlT3duZXIoYWRkcmVzcyBfbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGlmIChfbmV3T3duZXIgIT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICBvd25lciA9IF9uZXdPd25lcjsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gS2lsbCgpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHNlbGZkZXN0cnVjdChvd25lcik7CiAgICB9CgogICAgZnVuY3Rpb24gQWRkTW9kZXJhdG9yKGFkZHJlc3MgX25ld01vZGVyYXRvcikgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgaWYgKF9uZXdNb2RlcmF0b3IgIT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICBmb3IgKHVpbnQgaW5kZXggPSAwOyBpbmRleCA8IG1vZGVyYXRvcnMubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgICAgICAgICBpZiAobW9kZXJhdG9yc1tpbmRleF0gPT0gX25ld01vZGVyYXRvcikgewogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBtb2RlcmF0b3JzLnB1c2goX25ld01vZGVyYXRvcik7CiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jdGlvbiBSZW1vdmVNb2RlcmF0b3IoYWRkcmVzcyBfb2xkTW9kZXJhdG9yKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICB1aW50IGZvdW5kSW5kZXggPSAwOwogICAgICAgIGZvciAoOyBmb3VuZEluZGV4IDwgbW9kZXJhdG9ycy5sZW5ndGg7IGZvdW5kSW5kZXgrKykgewogICAgICAgICAgICBpZiAobW9kZXJhdG9yc1tmb3VuZEluZGV4XSA9PSBfb2xkTW9kZXJhdG9yKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoZm91bmRJbmRleCA8IG1vZGVyYXRvcnMubGVuZ3RoKSB7CiAgICAgICAgICAgIG1vZGVyYXRvcnNbZm91bmRJbmRleF0gPSBtb2RlcmF0b3JzW21vZGVyYXRvcnMubGVuZ3RoLTFdOwogICAgICAgICAgICBkZWxldGUgbW9kZXJhdG9yc1ttb2RlcmF0b3JzLmxlbmd0aC0xXTsKICAgICAgICAgICAgbW9kZXJhdG9ycy5sZW5ndGgtLTsKICAgICAgICB9CiAgICB9Cn0KCgpjb250cmFjdCBFdGhlcmVtb25FbnVtIHsKCiAgICBlbnVtIFJlc3VsdENvZGUgewogICAgICAgIFNVQ0NFU1MsCiAgICAgICAgRVJST1JfQ0xBU1NfTk9UX0ZPVU5ELAogICAgICAgIEVSUk9SX0xPV19CQUxBTkNFLAogICAgICAgIEVSUk9SX1NFTkRfRkFJTCwKICAgICAgICBFUlJPUl9OT1RfVFJBSU5FUiwKICAgICAgICBFUlJPUl9OT1RfRU5PVUdIX01PTkVZLAogICAgICAgIEVSUk9SX0lOVkFMSURfQU1PVU5UCiAgICB9CiAgICAKICAgIGVudW0gQXJyYXlUeXBlIHsKICAgICAgICBDTEFTU19UWVBFLAogICAgICAgIFNUQVRfU1RFUCwKICAgICAgICBTVEFUX1NUQVJULAogICAgICAgIFNUQVRfQkFTRSwKICAgICAgICBPQkpfU0tJTEwKICAgIH0KfQoKY29udHJhY3QgRXRoZXJlbW9uRGF0YUJhc2UgaXMgRXRoZXJlbW9uRW51bSwgQmFzaWNBY2Nlc3NDb250cm9sLCBTYWZlTWF0aCB7CiAgICAKICAgIHVpbnQ2NCBwdWJsaWMgdG90YWxNb25zdGVyOwogICAgdWludDMyIHB1YmxpYyB0b3RhbENsYXNzOwogICAgCiAgICAvLyB3cml0ZQogICAgZnVuY3Rpb24gYWRkRWxlbWVudFRvQXJyYXlUeXBlKEFycmF5VHlwZSBfdHlwZSwgdWludDY0IF9pZCwgdWludDggX3ZhbHVlKSBvbmx5TW9kZXJhdG9ycyBwdWJsaWMgcmV0dXJucyh1aW50KTsKICAgIGZ1bmN0aW9uIHJlbW92ZUVsZW1lbnRPZkFycmF5VHlwZShBcnJheVR5cGUgX3R5cGUsIHVpbnQ2NCBfaWQsIHVpbnQ4IF92YWx1ZSkgb25seU1vZGVyYXRvcnMgcHVibGljIHJldHVybnModWludCk7CiAgICBmdW5jdGlvbiBzZXRNb25zdGVyQ2xhc3ModWludDMyIF9jbGFzc0lkLCB1aW50MjU2IF9wcmljZSwgdWludDI1NiBfcmV0dXJuUHJpY2UsIGJvb2wgX2NhdGNoYWJsZSkgb25seU1vZGVyYXRvcnMgcHVibGljIHJldHVybnModWludDMyKTsKICAgIGZ1bmN0aW9uIGFkZE1vbnN0ZXJPYmoodWludDMyIF9jbGFzc0lkLCBhZGRyZXNzIF90cmFpbmVyLCBzdHJpbmcgX25hbWUpIG9ubHlNb2RlcmF0b3JzIHB1YmxpYyByZXR1cm5zKHVpbnQ2NCk7CiAgICBmdW5jdGlvbiBzZXRNb25zdGVyT2JqKHVpbnQ2NCBfb2JqSWQsIHN0cmluZyBfbmFtZSwgdWludDMyIF9leHAsIHVpbnQzMiBfY3JlYXRlSW5kZXgsIHVpbnQzMiBfbGFzdENsYWltSW5kZXgpIG9ubHlNb2RlcmF0b3JzIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGluY3JlYXNlTW9uc3RlckV4cCh1aW50NjQgX29iaklkLCB1aW50MzIgYW1vdW50KSBvbmx5TW9kZXJhdG9ycyBwdWJsaWM7CiAgICBmdW5jdGlvbiBkZWNyZWFzZU1vbnN0ZXJFeHAodWludDY0IF9vYmpJZCwgdWludDMyIGFtb3VudCkgb25seU1vZGVyYXRvcnMgcHVibGljOwogICAgZnVuY3Rpb24gcmVtb3ZlTW9uc3RlcklkTWFwcGluZyhhZGRyZXNzIF90cmFpbmVyLCB1aW50NjQgX21vbnN0ZXJJZCkgb25seU1vZGVyYXRvcnMgcHVibGljOwogICAgZnVuY3Rpb24gYWRkTW9uc3RlcklkTWFwcGluZyhhZGRyZXNzIF90cmFpbmVyLCB1aW50NjQgX21vbnN0ZXJJZCkgb25seU1vZGVyYXRvcnMgcHVibGljOwogICAgZnVuY3Rpb24gY2xlYXJNb25zdGVyUmV0dXJuQmFsYW5jZSh1aW50NjQgX21vbnN0ZXJJZCkgb25seU1vZGVyYXRvcnMgcHVibGljIHJldHVybnModWludDI1NiBhbW91bnQpOwogICAgZnVuY3Rpb24gY29sbGVjdEFsbFJldHVybkJhbGFuY2UoYWRkcmVzcyBfdHJhaW5lcikgb25seU1vZGVyYXRvcnMgcHVibGljIHJldHVybnModWludDI1NiBhbW91bnQpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJNb25zdGVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50NjQgX21vbnN0ZXJJZCkgb25seU1vZGVyYXRvcnMgcHVibGljIHJldHVybnMoUmVzdWx0Q29kZSk7CiAgICBmdW5jdGlvbiBhZGRFeHRyYUJhbGFuY2UoYWRkcmVzcyBfdHJhaW5lciwgdWludDI1NiBfYW1vdW50KSBvbmx5TW9kZXJhdG9ycyBwdWJsaWMgcmV0dXJucyh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGRlZHVjdEV4dHJhQmFsYW5jZShhZGRyZXNzIF90cmFpbmVyLCB1aW50MjU2IF9hbW91bnQpIG9ubHlNb2RlcmF0b3JzIHB1YmxpYyByZXR1cm5zKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gc2V0RXh0cmFCYWxhbmNlKGFkZHJlc3MgX3RyYWluZXIsIHVpbnQyNTYgX2Ftb3VudCkgb25seU1vZGVyYXRvcnMgcHVibGljOwogICAgCiAgICAvLyByZWFkCiAgICBmdW5jdGlvbiBnZXRTaXplQXJyYXlUeXBlKEFycmF5VHlwZSBfdHlwZSwgdWludDY0IF9pZCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludCk7CiAgICBmdW5jdGlvbiBnZXRFbGVtZW50SW5BcnJheVR5cGUoQXJyYXlUeXBlIF90eXBlLCB1aW50NjQgX2lkLCB1aW50IF9pbmRleCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludDgpOwogICAgZnVuY3Rpb24gZ2V0TW9uc3RlckNsYXNzKHVpbnQzMiBfY2xhc3NJZCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludDMyIGNsYXNzSWQsIHVpbnQyNTYgcHJpY2UsIHVpbnQyNTYgcmV0dXJuUHJpY2UsIHVpbnQzMiB0b3RhbCwgYm9vbCBjYXRjaGFibGUpOwogICAgZnVuY3Rpb24gZ2V0TW9uc3Rlck9iaih1aW50NjQgX29iaklkKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyh1aW50NjQgb2JqSWQsIHVpbnQzMiBjbGFzc0lkLCBhZGRyZXNzIHRyYWluZXIsIHVpbnQzMiBleHAsIHVpbnQzMiBjcmVhdGVJbmRleCwgdWludDMyIGxhc3RDbGFpbUluZGV4LCB1aW50IGNyZWF0ZVRpbWUpOwogICAgZnVuY3Rpb24gZ2V0TW9uc3Rlck5hbWUodWludDY0IF9vYmpJZCkgY29uc3RhbnQgcHVibGljIHJldHVybnMoc3RyaW5nIG5hbWUpOwogICAgZnVuY3Rpb24gZ2V0RXh0cmFCYWxhbmNlKGFkZHJlc3MgX3RyYWluZXIpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gZ2V0TW9uc3RlckRleFNpemUoYWRkcmVzcyBfdHJhaW5lcikgY29uc3RhbnQgcHVibGljIHJldHVybnModWludCk7CiAgICBmdW5jdGlvbiBnZXRNb25zdGVyT2JqSWQoYWRkcmVzcyBfdHJhaW5lciwgdWludCBpbmRleCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludDY0KTsKICAgIGZ1bmN0aW9uIGdldEV4cGVjdGVkQmFsYW5jZShhZGRyZXNzIF90cmFpbmVyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGdldE1vbnN0ZXJSZXR1cm4odWludDY0IF9vYmpJZCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludDI1NiBjdXJyZW50LCB1aW50MjU2IHRvdGFsKTsKfQoKY29udHJhY3QgRXRoZXJlbW9uUHJvY2Vzc29yIGlzIEV0aGVyZW1vbkVudW0sIEJhc2ljQWNjZXNzQ29udHJvbCwgU2FmZU1hdGggewogICAgCiAgICB1aW50OCBwdWJsaWMgU1RBVF9DT1VOVCA9IDY7CiAgICB1aW50OCBwdWJsaWMgU1RBVF9NQVggPSAzMjsKICAgIAogICAgc3RydWN0IE1vbnN0ZXJDbGFzc0FjYyB7CiAgICAgICAgdWludDMyIGNsYXNzSWQ7CiAgICAgICAgdWludDI1NiBwcmljZTsKICAgICAgICB1aW50MjU2IHJldHVyblByaWNlOwogICAgICAgIHVpbnQzMiB0b3RhbDsKICAgICAgICBib29sIGNhdGNoYWJsZTsKICAgIH0KCiAgICBzdHJ1Y3QgTW9uc3Rlck9iakFjYyB7CiAgICAgICAgdWludDY0IG1vbnN0ZXJJZDsKICAgICAgICB1aW50MzIgY2xhc3NJZDsKICAgICAgICBhZGRyZXNzIHRyYWluZXI7CiAgICAgICAgc3RyaW5nIG5hbWU7CiAgICAgICAgdWludDMyIGV4cDsKICAgICAgICB1aW50MzIgY3JlYXRlSW5kZXg7CiAgICAgICAgdWludDMyIGxhc3RDbGFpbUluZGV4OwogICAgICAgIHVpbnQgY3JlYXRlVGltZTsKICAgIH0KICAgIAogICAgLy8gZGF0YSBjb250cmFjdAogICAgYWRkcmVzcyBwdWJsaWMgZGF0YUNvbnRyYWN0OwogICAgCiAgICBmdW5jdGlvbiBFdGhlcmVtb25Qcm9jZXNzb3IoYWRkcmVzcyBfZGF0YUNvbnRyYWN0KSBwdWJsaWMgewogICAgICAgIGRhdGFDb250cmFjdCA9IF9kYXRhQ29udHJhY3Q7CiAgICB9CgogICAgLy8gaW50ZXJuYWwKICAgIG1vZGlmaWVyIHJlcXVpcmVEYXRhQ29udHJhY3QgewogICAgICAgIHJlcXVpcmUoZGF0YUNvbnRyYWN0ICE9IDB4MCk7CiAgICAgICAgXzsKICAgIH0KICAgIAoKICAgIC8vIGV2ZW50CiAgICBldmVudCBFdmVudENhdGNoTW9uc3RlcihhZGRyZXNzIGluZGV4ZWQgdHJhaW5lciwgUmVzdWx0Q29kZSByZXN1bHQsIHVpbnQ2NCBvYmpJZCk7CiAgICBldmVudCBFdmVudENhc2hPdXQoYWRkcmVzcyBpbmRleGVkIHRyYWluZXIsIFJlc3VsdENvZGUgcmVzdWx0LCB1aW50MjU2IGFtb3VudCk7CiAgICBldmVudCBFdmVudFdpdGhkcmF3RXRoZXIoYWRkcmVzcyBpbmRleGVkIHNlbmRUbywgUmVzdWx0Q29kZSByZXN1bHQsIHVpbnQyNTYgYW1vdW50KTsKIAogICAgIC8vIGFkbWluCiAgICBmdW5jdGlvbiB3aXRoZHJhd0V0aGVyKGFkZHJlc3MgX3NlbmRUbywgdWludCBfYW1vdW50KSBvbmx5T3duZXIgcHVibGljIHJldHVybnMoUmVzdWx0Q29kZSkgewogICAgICAgIGlmIChfYW1vdW50ID4gdGhpcy5iYWxhbmNlKSB7CiAgICAgICAgICAgIEV2ZW50V2l0aGRyYXdFdGhlcihfc2VuZFRvLCBSZXN1bHRDb2RlLkVSUk9SX0lOVkFMSURfQU1PVU5ULCAwKTsKICAgICAgICAgICAgcmV0dXJuIFJlc3VsdENvZGUuRVJST1JfSU5WQUxJRF9BTU9VTlQ7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIF9zZW5kVG8udHJhbnNmZXIoX2Ftb3VudCk7CiAgICAgICAgRXZlbnRXaXRoZHJhd0V0aGVyKF9zZW5kVG8sIFJlc3VsdENvZGUuU1VDQ0VTUywgX2Ftb3VudCk7CiAgICAgICAgcmV0dXJuIFJlc3VsdENvZGUuU1VDQ0VTUzsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gc2V0RGF0YUNvbnRyYWN0KGFkZHJlc3MgX2RhdGFDb250cmFjdCkgb25seU1vZGVyYXRvcnMgcHVibGljIHsKICAgICAgICBkYXRhQ29udHJhY3QgPSBfZGF0YUNvbnRyYWN0OwogICAgfQogICAgCiAgICBmdW5jdGlvbiBhZGRNb25zdGVyQ2xhc3NCYXNpYyh1aW50MzIgX2NsYXNzSWQsIHVpbnQ4IF90eXBlLCB1aW50MjU2IF9wcmljZSwgdWludDI1NiBfcmV0dXJuUHJpY2UsCiAgICAgICAgdWludDggX3NzMSwgdWludDggX3NzMiwgdWludDggX3NzMywgdWludDggX3NzNCwgdWludDggX3NzNSwgdWludDggX3NzNikgb25seU1vZGVyYXRvcnMgcHVibGljIHsKICAgICAgICAgICAgCiAgICAgICAgRXRoZXJlbW9uRGF0YUJhc2UgZGF0YSA9IEV0aGVyZW1vbkRhdGFCYXNlKGRhdGFDb250cmFjdCk7CiAgICAgICAgZGF0YS5zZXRNb25zdGVyQ2xhc3MoX2NsYXNzSWQsIF9wcmljZSwgX3JldHVyblByaWNlLCB0cnVlKTsKICAgICAgICBkYXRhLmFkZEVsZW1lbnRUb0FycmF5VHlwZShBcnJheVR5cGUuQ0xBU1NfVFlQRSwgdWludDY0KF9jbGFzc0lkKSwgX3R5cGUpOwogICAgICAgIAogICAgICAgIC8vIGFkZCBzdGF0IHN0ZXAKICAgICAgICBkYXRhLmFkZEVsZW1lbnRUb0FycmF5VHlwZShBcnJheVR5cGUuU1RBVF9TVEFSVCwgdWludDY0KF9jbGFzc0lkKSwgX3NzMSk7CiAgICAgICAgZGF0YS5hZGRFbGVtZW50VG9BcnJheVR5cGUoQXJyYXlUeXBlLlNUQVRfU1RBUlQsIHVpbnQ2NChfY2xhc3NJZCksIF9zczIpOwogICAgICAgIGRhdGEuYWRkRWxlbWVudFRvQXJyYXlUeXBlKEFycmF5VHlwZS5TVEFUX1NUQVJULCB1aW50NjQoX2NsYXNzSWQpLCBfc3MzKTsKICAgICAgICBkYXRhLmFkZEVsZW1lbnRUb0FycmF5VHlwZShBcnJheVR5cGUuU1RBVF9TVEFSVCwgdWludDY0KF9jbGFzc0lkKSwgX3NzNCk7CiAgICAgICAgZGF0YS5hZGRFbGVtZW50VG9BcnJheVR5cGUoQXJyYXlUeXBlLlNUQVRfU1RBUlQsIHVpbnQ2NChfY2xhc3NJZCksIF9zczUpOwogICAgICAgIGRhdGEuYWRkRWxlbWVudFRvQXJyYXlUeXBlKEFycmF5VHlwZS5TVEFUX1NUQVJULCB1aW50NjQoX2NsYXNzSWQpLCBfc3M2KTsKICAgICAgICAKICAgIH0KICAgIAogICAgZnVuY3Rpb24gYWRkTW9uc3RlckNsYXNzRXh0ZW5kKHVpbnQzMiBfY2xhc3NJZCwgdWludDggX3R5cGUyLCB1aW50OCBfdHlwZTMsIAogICAgICAgIHVpbnQ4IF9zdDEsIHVpbnQ4IF9zdDIsIHVpbnQ4IF9zdDMsIHVpbnQ4IF9zdDQsIHVpbnQ4IF9zdDUsIHVpbnQ4IF9zdDYgKSBvbmx5TW9kZXJhdG9ycyBwdWJsaWMgewogICAgICAgIAogICAgICAgIEV0aGVyZW1vbkRhdGFCYXNlIGRhdGEgPSBFdGhlcmVtb25EYXRhQmFzZShkYXRhQ29udHJhY3QpOwogICAgICAgIGlmIChfdHlwZTIgPiAwKSB7CiAgICAgICAgICAgIGRhdGEuYWRkRWxlbWVudFRvQXJyYXlUeXBlKEFycmF5VHlwZS5DTEFTU19UWVBFLCB1aW50NjQoX2NsYXNzSWQpLCBfdHlwZTIpOwogICAgICAgIH0KICAgICAgICBpZiAoX3R5cGUzID4gMCkgewogICAgICAgICAgICBkYXRhLmFkZEVsZW1lbnRUb0FycmF5VHlwZShBcnJheVR5cGUuQ0xBU1NfVFlQRSwgdWludDY0KF9jbGFzc0lkKSwgX3R5cGUzKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gYWRkIHN0YXQgYmFzZQogICAgICAgIGRhdGEuYWRkRWxlbWVudFRvQXJyYXlUeXBlKEFycmF5VHlwZS5TVEFUX1NURVAsIHVpbnQ2NChfY2xhc3NJZCksIF9zdDEpOwogICAgICAgIGRhdGEuYWRkRWxlbWVudFRvQXJyYXlUeXBlKEFycmF5VHlwZS5TVEFUX1NURVAsIHVpbnQ2NChfY2xhc3NJZCksIF9zdDIpOwogICAgICAgIGRhdGEuYWRkRWxlbWVudFRvQXJyYXlUeXBlKEFycmF5VHlwZS5TVEFUX1NURVAsIHVpbnQ2NChfY2xhc3NJZCksIF9zdDMpOwogICAgICAgIGRhdGEuYWRkRWxlbWVudFRvQXJyYXlUeXBlKEFycmF5VHlwZS5TVEFUX1NURVAsIHVpbnQ2NChfY2xhc3NJZCksIF9zdDQpOwogICAgICAgIGRhdGEuYWRkRWxlbWVudFRvQXJyYXlUeXBlKEFycmF5VHlwZS5TVEFUX1NURVAsIHVpbnQ2NChfY2xhc3NJZCksIF9zdDUpOwogICAgICAgIGRhdGEuYWRkRWxlbWVudFRvQXJyYXlUeXBlKEFycmF5VHlwZS5TVEFUX1NURVAsIHVpbnQ2NChfY2xhc3NJZCksIF9zdDYpOwogICAgICAgIAogICAgfQogICAgCiAgICAvLyBoZWxwZXIKICAgIGZ1bmN0aW9uIGdldFJhbmRvbSh1aW50OCBtYXhSYW4sIHVpbnQ4IGluZGV4KSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyh1aW50OCkgewogICAgICAgIHVpbnQyNTYgZ2VuTnVtID0gdWludDI1NihibG9jay5ibG9ja2hhc2goYmxvY2subnVtYmVyLTEpKTsKICAgICAgICBmb3IgKHVpbnQ4IGkgPSAwOyBpIDwgaW5kZXggJiYgaSA8IDY7IGkgKyspIHsKICAgICAgICAgICAgZ2VuTnVtIC89IDI1NjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHVpbnQ4KGdlbk51bSAlIG1heFJhbik7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uICgpIHBheWFibGUgcHVibGljIHsKICAgICAgICBFdGhlcmVtb25EYXRhQmFzZSBkYXRhID0gRXRoZXJlbW9uRGF0YUJhc2UoZGF0YUNvbnRyYWN0KTsKICAgICAgICBkYXRhLmFkZEV4dHJhQmFsYW5jZShtc2cuc2VuZGVyLCBtc2cudmFsdWUpOwogICAgfQogICAgCiAgICAvLyBwdWJsaWMKICAgIAogICAgZnVuY3Rpb24gY2F0Y2hNb25zdGVyKHVpbnQzMiBfY2xhc3NJZCwgc3RyaW5nIF9uYW1lKSByZXF1aXJlRGF0YUNvbnRyYWN0IHB1YmxpYyBwYXlhYmxlIHJldHVybnMoUmVzdWx0Q29kZSkgewogICAgICAgIEV0aGVyZW1vbkRhdGFCYXNlIGRhdGEgPSBFdGhlcmVtb25EYXRhQmFzZShkYXRhQ29udHJhY3QpOwogICAgICAgIE1vbnN0ZXJDbGFzc0FjYyBtZW1vcnkgY2xhc3M7CiAgICAgICAgKGNsYXNzLmNsYXNzSWQsIGNsYXNzLnByaWNlLCBjbGFzcy5yZXR1cm5QcmljZSwgY2xhc3MudG90YWwsIGNsYXNzLmNhdGNoYWJsZSkgPSBkYXRhLmdldE1vbnN0ZXJDbGFzcyhfY2xhc3NJZCk7CiAgICAgICAgCiAgICAgICAgaWYgKGNsYXNzLmNsYXNzSWQgPT0gMCB8fCBjbGFzcy5jYXRjaGFibGUgPT0gZmFsc2UpIHsKICAgICAgICAgICAgRXZlbnRDYXRjaE1vbnN0ZXIobXNnLnNlbmRlciwgUmVzdWx0Q29kZS5FUlJPUl9DTEFTU19OT1RfRk9VTkQsIDApOwogICAgICAgICAgICByZXR1cm4gUmVzdWx0Q29kZS5FUlJPUl9DTEFTU19OT1RfRk9VTkQ7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHVpbnQyNTYgdG90YWxCYWxhbmNlID0gc2FmZUFkZChtc2cudmFsdWUsIGRhdGEuZ2V0RXh0cmFCYWxhbmNlKG1zZy5zZW5kZXIpKTsKICAgICAgICB1aW50MjU2IHBheVByaWNlID0gY2xhc3MucHJpY2U7CiAgICAgICAgaWYgKHBheVByaWNlID4gdG90YWxCYWxhbmNlKSB7CiAgICAgICAgICAgIGRhdGEuYWRkRXh0cmFCYWxhbmNlKG1zZy5zZW5kZXIsIG1zZy52YWx1ZSk7CiAgICAgICAgICAgIEV2ZW50Q2F0Y2hNb25zdGVyKG1zZy5zZW5kZXIsIFJlc3VsdENvZGUuRVJST1JfTE9XX0JBTEFOQ0UsIDApOwogICAgICAgICAgICByZXR1cm4gUmVzdWx0Q29kZS5FUlJPUl9MT1dfQkFMQU5DRTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gZGVkdWN0IHRoZSBiYWxhbmNlCiAgICAgICAgZGF0YS5zZXRFeHRyYUJhbGFuY2UobXNnLnNlbmRlciwgc2FmZVN1YnRyYWN0KHRvdGFsQmFsYW5jZSwgcGF5UHJpY2UpKTsKICAgICAgICAKICAgICAgICAvLyBhZGQgbW9uc3RlcgogICAgICAgIHVpbnQ2NCBvYmpJZCA9IGRhdGEuYWRkTW9uc3Rlck9iaihfY2xhc3NJZCwgbXNnLnNlbmRlciwgX25hbWUpOwogICAgICAgIC8vIGdlbmVyYXRlIGJhc2Ugc3RhdAogICAgICAgIGZvciAodWludCBpPTA7IGkgPCBTVEFUX0NPVU5UOyBpKz0gMSkgewogICAgICAgICAgICB1aW50OCB2YWx1ZSA9IGdldFJhbmRvbShTVEFUX01BWCwgdWludDgoaSkpICsgZGF0YS5nZXRFbGVtZW50SW5BcnJheVR5cGUoQXJyYXlUeXBlLlNUQVRfU1RBUlQsIHVpbnQ2NChfY2xhc3NJZCksIGkpOwogICAgICAgICAgICBkYXRhLmFkZEVsZW1lbnRUb0FycmF5VHlwZShBcnJheVR5cGUuU1RBVF9CQVNFLCBvYmpJZCwgdmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgLy8gY2FsY3VsYXRlIHRoZSBwcmljZQogICAgICAgIHVpbnQyNTYgZGlzdHJpYnV0ZWRQcmljZSA9IHNhZmVNdWx0KGNsYXNzLnJldHVyblByaWNlLCBjbGFzcy50b3RhbCArIDIpOwogICAgICAgIGlmIChwYXlQcmljZSA8IGRpc3RyaWJ1dGVkUHJpY2UpIHsKICAgICAgICAgICAgcGF5UHJpY2UgPSBkaXN0cmlidXRlZFByaWNlOwogICAgICAgICAgICAvLyB1cGRhdGUgcHJpY2UKICAgICAgICAgICAgZGF0YS5zZXRNb25zdGVyQ2xhc3MoX2NsYXNzSWQsIGRpc3RyaWJ1dGVkUHJpY2UsIGNsYXNzLnJldHVyblByaWNlLCB0cnVlKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgRXZlbnRDYXRjaE1vbnN0ZXIobXNnLnNlbmRlciwgUmVzdWx0Q29kZS5TVUNDRVNTLCBvYmpJZCk7CiAgICAgICAgcmV0dXJuIFJlc3VsdENvZGUuU1VDQ0VTUzsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gY2FzaE91dCh1aW50MjU2IF9hbW91bnQpIHJlcXVpcmVEYXRhQ29udHJhY3QgcHVibGljIHJldHVybnMoUmVzdWx0Q29kZSkgewogICAgICAgIEV0aGVyZW1vbkRhdGFCYXNlIGRhdGEgPSBFdGhlcmVtb25EYXRhQmFzZShkYXRhQ29udHJhY3QpOwogICAgICAgIAogICAgICAgIHVpbnQyNTYgdG90YWxBbW91bnQgPSBkYXRhLmNvbGxlY3RBbGxSZXR1cm5CYWxhbmNlKG1zZy5zZW5kZXIpOwogICAgICAgIC8vIGRlZmF1bHQgdG8gY2FzaCBvdXQgYWxsCiAgICAgICAgaWYgKF9hbW91bnQgPT0gMCkgewogICAgICAgICAgICBfYW1vdW50ID0gdG90YWxBbW91bnQ7CiAgICAgICAgfQogICAgICAgIGlmIChfYW1vdW50ID4gdG90YWxBbW91bnQpIHsKICAgICAgICAgICAgRXZlbnRDYXNoT3V0KG1zZy5zZW5kZXIsIFJlc3VsdENvZGUuRVJST1JfTE9XX0JBTEFOQ0UsIDApOwogICAgICAgICAgICByZXR1cm4gUmVzdWx0Q29kZS5FUlJPUl9MT1dfQkFMQU5DRTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gY2hlY2sgY29udHJhY3QgaGFzIGVub3VnaCBtb25leQogICAgICAgIGlmICh0aGlzLmJhbGFuY2UgPCBfYW1vdW50KSB7CiAgICAgICAgICAgIEV2ZW50Q2FzaE91dChtc2cuc2VuZGVyLCBSZXN1bHRDb2RlLkVSUk9SX05PVF9FTk9VR0hfTU9ORVksIDApOwogICAgICAgICAgICByZXR1cm4gUmVzdWx0Q29kZS5FUlJPUl9OT1RfRU5PVUdIX01PTkVZOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAoX2Ftb3VudCA+IDApIHsKICAgICAgICAgICAgZGF0YS5kZWR1Y3RFeHRyYUJhbGFuY2UobXNnLnNlbmRlciwgX2Ftb3VudCk7CiAgICAgICAgICAgIGlmICghbXNnLnNlbmRlci5zZW5kKF9hbW91bnQpKSB7CiAgICAgICAgICAgICAgICBkYXRhLmFkZEV4dHJhQmFsYW5jZShtc2cuc2VuZGVyLCBfYW1vdW50KTsKICAgICAgICAgICAgICAgIEV2ZW50Q2FzaE91dChtc2cuc2VuZGVyLCBSZXN1bHRDb2RlLkVSUk9SX1NFTkRfRkFJTCwgMCk7CiAgICAgICAgICAgICAgICByZXR1cm4gUmVzdWx0Q29kZS5FUlJPUl9TRU5EX0ZBSUw7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgRXZlbnRDYXNoT3V0KG1zZy5zZW5kZXIsIFJlc3VsdENvZGUuU1VDQ0VTUywgX2Ftb3VudCk7CiAgICAgICAgcmV0dXJuIFJlc3VsdENvZGUuU1VDQ0VTUzsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0VHJhaW5lckJhbGFuY2UoYWRkcmVzcyBfdHJhaW5lcikgY29uc3RhbnQgcHVibGljIHJldHVybnModWludDI1NikgewogICAgICAgIEV0aGVyZW1vbkRhdGFCYXNlIGRhdGEgPSBFdGhlcmVtb25EYXRhQmFzZShkYXRhQ29udHJhY3QpOwogICAgICAgIHJldHVybiBkYXRhLmdldEV4cGVjdGVkQmFsYW5jZShfdHJhaW5lcik7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldE1vbnN0ZXJDbGFzc0Jhc2ljKHVpbnQzMiBfY2xhc3NJZCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludDI1NiwgdWludDI1NiwgdWludDI1NiwgYm9vbCkgewogICAgICAgIEV0aGVyZW1vbkRhdGFCYXNlIGRhdGEgPSBFdGhlcmVtb25EYXRhQmFzZShkYXRhQ29udHJhY3QpOwogICAgICAgIE1vbnN0ZXJDbGFzc0FjYyBtZW1vcnkgY2xhc3M7CiAgICAgICAgKGNsYXNzLmNsYXNzSWQsIGNsYXNzLnByaWNlLCBjbGFzcy5yZXR1cm5QcmljZSwgY2xhc3MudG90YWwsIGNsYXNzLmNhdGNoYWJsZSkgPSBkYXRhLmdldE1vbnN0ZXJDbGFzcyhfY2xhc3NJZCk7CiAgICAgICAgcmV0dXJuIChjbGFzcy5wcmljZSwgY2xhc3MucmV0dXJuUHJpY2UsIGNsYXNzLnRvdGFsLCBjbGFzcy5jYXRjaGFibGUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldExldmVsKHVpbnQzMiBleHApIHB1cmUgaW50ZXJuYWwgcmV0dXJucyAodWludDgpIHsKICAgICAgICB1aW50OCBsZXZlbCA9IDE7CiAgICAgICAgdWludDggcmVxdWlyZW1lbnQgPSAxMDA7CiAgICAgICAgd2hpbGUobGV2ZWwgPCAxMDAgJiYgZXhwID4gcmVxdWlyZW1lbnQpIHsKICAgICAgICAgICAgZXhwIC09IHJlcXVpcmVtZW50OwogICAgICAgICAgICBsZXZlbCArPSAxOwogICAgICAgICAgICByZXF1aXJlbWVudCA9IHJlcXVpcmVtZW50ICogMTIgLyAxMCArIDU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBsZXZlbDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRNb25zdGVyTGV2ZWwodWludDY0IF9vYmpJZCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludDgpIHsKICAgICAgICBFdGhlcmVtb25EYXRhQmFzZSBkYXRhID0gRXRoZXJlbW9uRGF0YUJhc2UoZGF0YUNvbnRyYWN0KTsKICAgICAgICBNb25zdGVyT2JqQWNjIG1lbW9yeSBvYmo7CiAgICAgICAgdWludDMyIF8gPSAwOwogICAgICAgIChvYmoubW9uc3RlcklkLCBvYmouY2xhc3NJZCwgb2JqLnRyYWluZXIsIG9iai5leHAsIF8sIF8sIG9iai5jcmVhdGVUaW1lKSA9IGRhdGEuZ2V0TW9uc3Rlck9iaihfb2JqSWQpOwogICAgIAogICAgICAgIHJldHVybiBnZXRMZXZlbChvYmouZXhwKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0TW9uc3RlckNQKHVpbnQ2NCBfb2JqSWQpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zKHVpbnQ2NCkgewogICAgICAgIEV0aGVyZW1vbkRhdGFCYXNlIGRhdGEgPSBFdGhlcmVtb25EYXRhQmFzZShkYXRhQ29udHJhY3QpOwogICAgICAgIE1vbnN0ZXJPYmpBY2MgbWVtb3J5IG9iajsKICAgICAgICB1aW50MzIgXyA9IDA7CiAgICAgICAgKG9iai5tb25zdGVySWQsIG9iai5jbGFzc0lkLCBvYmoudHJhaW5lciwgb2JqLmV4cCwgXywgXywgb2JqLmNyZWF0ZVRpbWUpID0gZGF0YS5nZXRNb25zdGVyT2JqKF9vYmpJZCk7CiAgICAgCiAgICAgICAgdWludCBiYXNlU2l6ZSA9IGRhdGEuZ2V0U2l6ZUFycmF5VHlwZShBcnJheVR5cGUuU1RBVF9CQVNFLCBvYmoubW9uc3RlcklkKTsKICAgICAgICBpZiAoYmFzZVNpemUgPT0gMCkKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgCiAgICAgICAgdWludDI1NiB0b3RhbCA9IDA7CiAgICAgICAgZm9yKHVpbnQgaT0wOyBpIDwgYmFzZVNpemU7IGkrPTEpIHsKICAgICAgICAgICAgdG90YWwgKz0gZGF0YS5nZXRFbGVtZW50SW5BcnJheVR5cGUoQXJyYXlUeXBlLlNUQVRfQkFTRSwgb2JqLm1vbnN0ZXJJZCwgaSk7CiAgICAgICAgICAgIHRvdGFsICs9IHNhZmVNdWx0KGRhdGEuZ2V0RWxlbWVudEluQXJyYXlUeXBlKEFycmF5VHlwZS5TVEFUX1NURVAsIHVpbnQ2NChvYmouY2xhc3NJZCksIGkpLCBnZXRMZXZlbChvYmouZXhwKSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVybiB1aW50NjQodG90YWwvYmFzZVNpemUpOwogICAgfQp9'.
	

]
