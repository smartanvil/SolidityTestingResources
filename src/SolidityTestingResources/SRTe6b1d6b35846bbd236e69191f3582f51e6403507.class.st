Class {
	#name : #SRTe6b1d6b35846bbd236e69191f3582f51e6403507,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTe6b1d6b35846bbd236e69191f3582f51e6403507 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTc7Cgpjb250cmFjdCBTYWZlTWF0aCB7CiAgICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQgeCwgdWludCB5KSBwdXJlIGludGVybmFsIHJldHVybnModWludCkgewogICAgICB1aW50IHogPSB4ICsgeTsKICAgICAgYXNzZXJ0KCh6ID49IHgpICYmICh6ID49IHkpKTsKICAgICAgcmV0dXJuIHo7CiAgICB9CgogICAgZnVuY3Rpb24gc2FmZVN1YnRyYWN0KHVpbnQgeCwgdWludCB5KSBwdXJlIGludGVybmFsIHJldHVybnModWludCkgewogICAgICBhc3NlcnQoeCA+PSB5KTsKICAgICAgdWludCB6ID0geCAtIHk7CiAgICAgIHJldHVybiB6OwogICAgfQoKICAgIGZ1bmN0aW9uIHNhZmVNdWx0KHVpbnQgeCwgdWludCB5KSBwdXJlIGludGVybmFsIHJldHVybnModWludCkgewogICAgICB1aW50IHogPSB4ICogeTsKICAgICAgYXNzZXJ0KCh4ID09IDApfHwoei94ID09IHkpKTsKICAgICAgcmV0dXJuIHo7CiAgICB9CiAgICAKICAgICAKCiAgICBmdW5jdGlvbiBnZXRSYW5kb21OdW1iZXIodWludDE2IG1heFJhbmRvbSwgdWludDggbWluLCBhZGRyZXNzIHByaXZhdGVBZGRyZXNzKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyh1aW50OCkgewogICAgICAgIHVpbnQyNTYgZ2VuTnVtID0gdWludDI1NihibG9jay5ibG9ja2hhc2goYmxvY2subnVtYmVyLTEpKSArIHVpbnQyNTYocHJpdmF0ZUFkZHJlc3MpOwogICAgICAgIHJldHVybiB1aW50OChnZW5OdW0gJSAobWF4UmFuZG9tIC0gbWluICsgMSkrbWluKTsKICAgIH0KfQoKY29udHJhY3QgRW51bXMgewogICAgZW51bSBSZXN1bHRDb2RlIHsKICAgICAgICBTVUNDRVNTLAogICAgICAgIEVSUk9SX0NMQVNTX05PVF9GT1VORCwKICAgICAgICBFUlJPUl9MT1dfQkFMQU5DRSwKICAgICAgICBFUlJPUl9TRU5EX0ZBSUwsCiAgICAgICAgRVJST1JfTk9UX09XTkVSLAogICAgICAgIEVSUk9SX05PVF9FTk9VR0hfTU9ORVksCiAgICAgICAgRVJST1JfSU5WQUxJRF9BTU9VTlQKICAgIH0KCiAgICBlbnVtIEFuZ2VsQXVyYSB7IAogICAgICAgIEJsdWUsIAogICAgICAgIFllbGxvdywgCiAgICAgICAgUHVycGxlLCAKICAgICAgICBPcmFuZ2UsIAogICAgICAgIFJlZCwgCiAgICAgICAgR3JlZW4gCiAgICB9Cn0KCmNvbnRyYWN0IEFjY2Vzc0NvbnRyb2wgewogICAgYWRkcmVzcyBwdWJsaWMgY3JlYXRvckFkZHJlc3M7CiAgICB1aW50MTYgcHVibGljIHRvdGFsU2VyYXBoaW1zID0gMDsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIHNlcmFwaGltczsKCiAgICBib29sIHB1YmxpYyBpc01haW50ZW5hbmNlTW9kZSA9IHRydWU7CiAKICAgIG1vZGlmaWVyIG9ubHlDUkVBVE9SKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjcmVhdG9yQWRkcmVzcyk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5U0VSQVBISU0oKSB7CiAgICAgICAgcmVxdWlyZShzZXJhcGhpbXNbbXNnLnNlbmRlcl0gPT0gdHJ1ZSk7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgbW9kaWZpZXIgaXNDb250cmFjdEFjdGl2ZSB7CiAgICAgICAgcmVxdWlyZSghaXNNYWludGVuYW5jZU1vZGUpOwogICAgICAgIF87CiAgICB9CiAgICAKICAgIC8vIENvbnN0cnVjdG9yCiAgICBmdW5jdGlvbiBBY2Nlc3NDb250cm9sKCkgcHVibGljIHsKICAgICAgICBjcmVhdG9yQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICB9CiAgICAKCiAgICBmdW5jdGlvbiBhZGRTRVJBUEhJTShhZGRyZXNzIF9uZXdTZXJhcGhpbSkgb25seUNSRUFUT1IgcHVibGljIHsKICAgICAgICBpZiAoc2VyYXBoaW1zW19uZXdTZXJhcGhpbV0gPT0gZmFsc2UpIHsKICAgICAgICAgICAgc2VyYXBoaW1zW19uZXdTZXJhcGhpbV0gPSB0cnVlOwogICAgICAgICAgICB0b3RhbFNlcmFwaGltcyArPSAxOwogICAgICAgIH0KICAgIH0KICAgIAogICAgZnVuY3Rpb24gcmVtb3ZlU0VSQVBISU0oYWRkcmVzcyBfb2xkU2VyYXBoaW0pIG9ubHlDUkVBVE9SIHB1YmxpYyB7CiAgICAgICAgaWYgKHNlcmFwaGltc1tfb2xkU2VyYXBoaW1dID09IHRydWUpIHsKICAgICAgICAgICAgc2VyYXBoaW1zW19vbGRTZXJhcGhpbV0gPSBmYWxzZTsKICAgICAgICAgICAgdG90YWxTZXJhcGhpbXMgLT0gMTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdXBkYXRlTWFpbnRlbmFuY2VNb2RlKGJvb2wgX2lzTWFpbnRhaW5pbmcpIG9ubHlDUkVBVE9SIHB1YmxpYyB7CiAgICAgICAgaXNNYWludGVuYW5jZU1vZGUgPSBfaXNNYWludGFpbmluZzsKICAgIH0KCiAgCn0gCmNvbnRyYWN0IElBbmdlbENhcmREYXRhIGlzIEFjY2Vzc0NvbnRyb2wsIEVudW1zIHsKICAgIHVpbnQ4IHB1YmxpYyB0b3RhbEFuZ2VsQ2FyZFNlcmllczsKICAgIHVpbnQ2NCBwdWJsaWMgdG90YWxBbmdlbHM7CgogICAgCiAgICAvLyB3cml0ZQogICAgLy8gYW5nZWxzCiAgICBmdW5jdGlvbiBjcmVhdGVBbmdlbENhcmRTZXJpZXModWludDggX2FuZ2VsQ2FyZFNlcmllc0lkLCB1aW50IF9iYXNlUHJpY2UsICB1aW50NjQgX21heFRvdGFsLCB1aW50OCBfYmFzZUF1cmEsIHVpbnQxNiBfYmFzZUJhdHRsZVBvd2VyLCB1aW50NjQgX2xpdmVUaW1lKSBvbmx5Q1JFQVRPUiBleHRlcm5hbCByZXR1cm5zKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIHVwZGF0ZUFuZ2VsQ2FyZFNlcmllcyh1aW50OCBfYW5nZWxDYXJkU2VyaWVzSWQsIHVpbnQ2NCBfbmV3UHJpY2UsIHVpbnQ2NCBfbmV3TWF4VG90YWwpIG9ubHlDUkVBVE9SIGV4dGVybmFsOwogICAgZnVuY3Rpb24gc2V0QW5nZWwodWludDggX2FuZ2VsQ2FyZFNlcmllc0lkLCBhZGRyZXNzIF9vd25lciwgdWludCBfcHJpY2UsIHVpbnQxNiBfYmF0dGxlUG93ZXIpIG9ubHlTRVJBUEhJTSBleHRlcm5hbCByZXR1cm5zKHVpbnQ2NCk7CiAgICBmdW5jdGlvbiBhZGRUb0FuZ2VsRXhwZXJpZW5jZUxldmVsKHVpbnQ2NCBfYW5nZWxJZCwgdWludCBfdmFsdWUpIG9ubHlTRVJBUEhJTSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIHNldEFuZ2VsTGFzdEJhdHRsZVRpbWUodWludDY0IF9hbmdlbElkKSBvbmx5U0VSQVBISU0gZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBzZXRBbmdlbExhc3RWc0JhdHRsZVRpbWUodWludDY0IF9hbmdlbElkKSBvbmx5U0VSQVBISU0gZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBzZXRMYXN0QmF0dGxlUmVzdWx0KHVpbnQ2NCBfYW5nZWxJZCwgdWludDE2IF92YWx1ZSkgb25seVNFUkFQSElNIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYWRkQW5nZWxJZE1hcHBpbmcoYWRkcmVzcyBfb3duZXIsIHVpbnQ2NCBfYW5nZWxJZCkgcHJpdmF0ZTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyQW5nZWwoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQ2NCBfYW5nZWxJZCkgb25seVNFUkFQSElNIHB1YmxpYyByZXR1cm5zKFJlc3VsdENvZGUpOwogICAgZnVuY3Rpb24gb3duZXJBbmdlbFRyYW5zZmVyIChhZGRyZXNzIF90bywgdWludDY0IF9hbmdlbElkKSAgcHVibGljOwogICAgZnVuY3Rpb24gdXBkYXRlQW5nZWxMb2NrICh1aW50NjQgX2FuZ2VsSWQsIGJvb2wgbmV3VmFsdWUpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIHJlbW92ZUNyZWF0b3IoKSBvbmx5Q1JFQVRPUiBleHRlcm5hbDsKCiAgICAvLyByZWFkCiAgICBmdW5jdGlvbiBnZXRBbmdlbENhcmRTZXJpZXModWludDggX2FuZ2VsQ2FyZFNlcmllc0lkKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyh1aW50OCBhbmdlbENhcmRTZXJpZXNJZCwgdWludDY0IGN1cnJlbnRBbmdlbFRvdGFsLCB1aW50IGJhc2VQcmljZSwgdWludDY0IG1heEFuZ2VsVG90YWwsIHVpbnQ4IGJhc2VBdXJhLCB1aW50IGJhc2VCYXR0bGVQb3dlciwgdWludDY0IGxhc3RTZWxsVGltZSwgdWludDY0IGxpdmVUaW1lKTsKICAgIGZ1bmN0aW9uIGdldEFuZ2VsKHVpbnQ2NCBfYW5nZWxJZCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludDY0IGFuZ2VsSWQsIHVpbnQ4IGFuZ2VsQ2FyZFNlcmllc0lkLCB1aW50MTYgYmF0dGxlUG93ZXIsIHVpbnQ4IGF1cmEsIHVpbnQxNiBleHBlcmllbmNlLCB1aW50IHByaWNlLCB1aW50NjQgY3JlYXRlZFRpbWUsIHVpbnQ2NCBsYXN0QmF0dGxlVGltZSwgdWludDY0IGxhc3RWc0JhdHRsZVRpbWUsIHVpbnQxNiBsYXN0QmF0dGxlUmVzdWx0LCBhZGRyZXNzIG93bmVyKTsKICAgIGZ1bmN0aW9uIGdldE93bmVyQW5nZWxDb3VudChhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcHVibGljIHJldHVybnModWludCk7CiAgICBmdW5jdGlvbiBnZXRBbmdlbEJ5SW5kZXgoYWRkcmVzcyBfb3duZXIsIHVpbnQgX2luZGV4KSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyh1aW50NjQpOwogICAgZnVuY3Rpb24gZ2V0VG90YWxBbmdlbENhcmRTZXJpZXMoKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gZ2V0VG90YWxBbmdlbHMoKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDY0KTsKICAgIGZ1bmN0aW9uIGdldEFuZ2VsTG9ja1N0YXR1cyh1aW50NjQgX2FuZ2VsSWQpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zIChib29sKTsKfQoKY29udHJhY3QgSVBldENhcmREYXRhIGlzIEFjY2Vzc0NvbnRyb2wsIEVudW1zIHsKICAgIHVpbnQ4IHB1YmxpYyB0b3RhbFBldENhcmRTZXJpZXM7ICAgIAogICAgdWludDY0IHB1YmxpYyB0b3RhbFBldHM7CiAgICAKICAgIC8vIHdyaXRlCiAgICBmdW5jdGlvbiBjcmVhdGVQZXRDYXJkU2VyaWVzKHVpbnQ4IF9wZXRDYXJkU2VyaWVzSWQsIHVpbnQzMiBfbWF4VG90YWwpIG9ubHlDUkVBVE9SIHB1YmxpYyByZXR1cm5zKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIHNldFBldCh1aW50OCBfcGV0Q2FyZFNlcmllc0lkLCBhZGRyZXNzIF9vd25lciwgc3RyaW5nIF9uYW1lLCB1aW50OCBfbHVjaywgdWludDE2IF9hdXJhUmVkLCB1aW50MTYgX2F1cmFZZWxsb3csIHVpbnQxNiBfYXVyYUJsdWUpIG9ubHlTRVJBUEhJTSBleHRlcm5hbCByZXR1cm5zKHVpbnQ2NCk7CiAgICBmdW5jdGlvbiBzZXRQZXRBdXJhcyh1aW50NjQgX3BldElkLCB1aW50OCBfYXVyYVJlZCwgdWludDggX2F1cmFCbHVlLCB1aW50OCBfYXVyYVllbGxvdykgb25seVNFUkFQSElNIGV4dGVybmFsOwogICAgZnVuY3Rpb24gc2V0UGV0TGFzdFRyYWluaW5nVGltZSh1aW50NjQgX3BldElkKSBvbmx5U0VSQVBISU0gZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBzZXRQZXRMYXN0QnJlZWRpbmdUaW1lKHVpbnQ2NCBfcGV0SWQpIG9ubHlTRVJBUEhJTSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIGFkZFBldElkTWFwcGluZyhhZGRyZXNzIF9vd25lciwgdWludDY0IF9wZXRJZCkgcHJpdmF0ZTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyUGV0KGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50NjQgX3BldElkKSBvbmx5U0VSQVBISU0gcHVibGljIHJldHVybnMoUmVzdWx0Q29kZSk7CiAgICBmdW5jdGlvbiBvd25lclBldFRyYW5zZmVyIChhZGRyZXNzIF90bywgdWludDY0IF9wZXRJZCkgIHB1YmxpYzsKICAgIGZ1bmN0aW9uIHNldFBldE5hbWUoc3RyaW5nIF9uYW1lLCB1aW50NjQgX3BldElkKSBwdWJsaWM7CgogICAgLy8gcmVhZAogICAgZnVuY3Rpb24gZ2V0UGV0Q2FyZFNlcmllcyh1aW50OCBfcGV0Q2FyZFNlcmllc0lkKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyh1aW50OCBwZXRDYXJkU2VyaWVzSWQsIHVpbnQzMiBjdXJyZW50UGV0VG90YWwsIHVpbnQzMiBtYXhQZXRUb3RhbCk7CiAgICBmdW5jdGlvbiBnZXRQZXQodWludCBfcGV0SWQpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zKHVpbnQgcGV0SWQsIHVpbnQ4IHBldENhcmRTZXJpZXNJZCwgc3RyaW5nIG5hbWUsIHVpbnQ4IGx1Y2ssIHVpbnQxNiBhdXJhUmVkLCB1aW50MTYgYXVyYUJsdWUsIHVpbnQxNiBhdXJhWWVsbG93LCB1aW50NjQgbGFzdFRyYWluaW5nVGltZSwgdWludDY0IGxhc3RCcmVlZGluZ1RpbWUsIGFkZHJlc3Mgb3duZXIpOwogICAgZnVuY3Rpb24gZ2V0T3duZXJQZXRDb3VudChhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcHVibGljIHJldHVybnModWludCk7CiAgICBmdW5jdGlvbiBnZXRQZXRCeUluZGV4KGFkZHJlc3MgX293bmVyLCB1aW50IF9pbmRleCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludCk7CiAgICBmdW5jdGlvbiBnZXRUb3RhbFBldENhcmRTZXJpZXMoKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gZ2V0VG90YWxQZXRzKCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQpOwp9CmNvbnRyYWN0IElBY2Nlc3NvcnlEYXRhIGlzIEFjY2Vzc0NvbnRyb2wsIEVudW1zIHsKICAgIHVpbnQ4IHB1YmxpYyB0b3RhbEFjY2Vzc29yeVNlcmllczsgICAgCiAgICB1aW50MzIgcHVibGljIHRvdGFsQWNjZXNzb3JpZXM7CiAgICAKIAogICAgLyoqKiBGVU5DVElPTlMgKioqLwogICAgLy8qKiogV3JpdGUgQWNjZXNzICoqKi8vCiAgICBmdW5jdGlvbiBjcmVhdGVBY2Nlc3NvcnlTZXJpZXModWludDggX0FjY2Vzc29yeVNlcmllc0lkLCB1aW50MzIgX21heFRvdGFsLCB1aW50IF9wcmljZSkgb25seUNSRUFUT1IgcHVibGljIHJldHVybnModWludDgpIDsKCWZ1bmN0aW9uIHNldEFjY2Vzc29yeSh1aW50OCBfQWNjZXNzb3J5U2VyaWVzSWQsIGFkZHJlc3MgX293bmVyKSBvbmx5U0VSQVBISU0gZXh0ZXJuYWwgcmV0dXJucyh1aW50NjQpOwogICBmdW5jdGlvbiBhZGRBY2Nlc3NvcnlJZE1hcHBpbmcoYWRkcmVzcyBfb3duZXIsIHVpbnQ2NCBfYWNjZXNzb3J5SWQpIHByaXZhdGU7CglmdW5jdGlvbiB0cmFuc2ZlckFjY2Vzc29yeShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDY0IF9fYWNjZXNzb3J5SWQpIG9ubHlTRVJBUEhJTSBwdWJsaWMgcmV0dXJucyhSZXN1bHRDb2RlKTsKICAgIGZ1bmN0aW9uIG93bmVyQWNjZXNzb3J5VHJhbnNmZXIgKGFkZHJlc3MgX3RvLCB1aW50NjQgX19hY2Nlc3NvcnlJZCkgIHB1YmxpYzsKICAgIGZ1bmN0aW9uIHVwZGF0ZUFjY2Vzc29yeUxvY2sgKHVpbnQ2NCBfYWNjZXNzb3J5SWQsIGJvb2wgbmV3VmFsdWUpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIHJlbW92ZUNyZWF0b3IoKSBvbmx5Q1JFQVRPUiBleHRlcm5hbDsKICAgIAogICAgLy8qKiogUmVhZCBBY2Nlc3MgKioqLy8KICAgIGZ1bmN0aW9uIGdldEFjY2Vzc29yeVNlcmllcyh1aW50OCBfYWNjZXNzb3J5U2VyaWVzSWQpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zKHVpbnQ4IGFjY2Vzc29yeVNlcmllc0lkLCB1aW50MzIgY3VycmVudFRvdGFsLCB1aW50MzIgbWF4VG90YWwsIHVpbnQgcHJpY2UpIDsKCWZ1bmN0aW9uIGdldEFjY2Vzc29yeSh1aW50IF9hY2Nlc3NvcnlJZCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludCBhY2Nlc3NvcnlJRCwgdWludDggQWNjZXNzb3J5U2VyaWVzSUQsIGFkZHJlc3Mgb3duZXIpOwoJZnVuY3Rpb24gZ2V0T3duZXJBY2Nlc3NvcnlDb3VudChhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcHVibGljIHJldHVybnModWludCk7CglmdW5jdGlvbiBnZXRBY2Nlc3NvcnlCeUluZGV4KGFkZHJlc3MgX293bmVyLCB1aW50IF9pbmRleCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludCkgOwogICAgZnVuY3Rpb24gZ2V0VG90YWxBY2Nlc3NvcnlTZXJpZXMoKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDgpIDsKICAgIGZ1bmN0aW9uIGdldFRvdGFsQWNjZXNzb3JpZXMoKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludCk7CiAgICBmdW5jdGlvbiBnZXRBY2Nlc3NvcnlMb2NrU3RhdHVzKHVpbnQ2NCBfYWNlc3NvcnlJZCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKGJvb2wpOwp9CgoKICAKCgpjb250cmFjdCBJTWVkYWxEYXRhIGlzIEFjY2Vzc0NvbnRyb2wgewogIAogICAgbW9kaWZpZXIgb25seU93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgewogICAgcmVxdWlyZShvd25lck9mKF90b2tlbklkKSA9PSBtc2cuc2VuZGVyKTsKICAgIF87CiAgfQogICAKZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKZnVuY3Rpb24gc2V0TWF4VG9rZW5OdW1iZXJzKCkgIG9ubHlDUkVBVE9SIGV4dGVybmFsOwpmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwpmdW5jdGlvbiB0b2tlbnNPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NltdKSA7CmZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyk7CmZ1bmN0aW9uIGFwcHJvdmVkRm9yKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3MpIDsKZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBvbmx5T3duZXJPZihfdG9rZW5JZCk7CmZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBvbmx5T3duZXJPZihfdG9rZW5JZCk7CmZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JZCkgcHVibGljOwpmdW5jdGlvbiBfY3JlYXRlTWVkYWwoYWRkcmVzcyBfdG8sIHVpbnQ4IF9zZXJpZXNJRCkgb25seVNFUkFQSElNIHB1YmxpYyA7CmZ1bmN0aW9uIGdldEN1cnJlbnRUb2tlbnNCeVR5cGUodWludDMyIF9zZXJpZXNJRCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQzMik7CmZ1bmN0aW9uIGdldE1lZGFsVHlwZSAodWludDI1NiBfdG9rZW5JZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4KTsKZnVuY3Rpb24gX2J1cm4odWludDI1NiBfdG9rZW5JZCkgb25seU93bmVyT2YoX3Rva2VuSWQpIGV4dGVybmFsOwpmdW5jdGlvbiBpc0FwcHJvdmVkRm9yKGFkZHJlc3MgX293bmVyLCB1aW50MjU2IF90b2tlbklkKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpIDsKZnVuY3Rpb24gY2xlYXJBcHByb3ZhbEFuZFRyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBpbnRlcm5hbDsKZnVuY3Rpb24gY2xlYXJBcHByb3ZhbChhZGRyZXNzIF9vd25lciwgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZTsKZnVuY3Rpb24gYWRkVG9rZW4oYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgOwpmdW5jdGlvbiByZW1vdmVUb2tlbihhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlOwp9CgovL0lOU1RVUkNUSU9OUzogWW91IGNhbiBhY2Nlc3MgdGhpcyBjb250cmFjdCB0aHJvdWdoIG91ciB3ZWJVSSBhdCBhbmdlbGJhdHRsZXMuY29tIChwcmVmZXJyZWQpCi8vWW91IGNhbiBhbHNvIGFjY2VzcyB0aGlzIGNvbnRyYWN0IGRpcmVjdGx5IGJ5IHNlbmRpbmcgYSB0cmFuc2FjdGlvbiB0aGUgdGhlIG1lZGFsIHlvdSB3aXNoIHRvIGNsYWltCi8vVmFyaWFibGUgbmFtZXMgYXJlIHNlbGYgZXhwbGFuYXRvcnksIGJ1dCBjb250YWN0IHVzIGlmIHlvdSBoYXZlIGFueSBxdWVzdGlvbnMuIAoKY29udHJhY3QgTWVkYWxDbGFpbTIgaXMgQWNjZXNzQ29udHJvbCwgU2FmZU1hdGggIHsKICAgIC8vIEFkZHJlc3NlcyBmb3Igb3RoZXIgY29udHJhY3RzIE1lZGFsQ2xhaW0gaW50ZXJhY3RzIHdpdGguIAogICAgYWRkcmVzcyBwdWJsaWMgYW5nZWxDYXJkRGF0YUNvbnRyYWN0ID0gMHg2RDJFNzYyMTM2MTU5MjVjNWZjNDM2NTY1QjVlZTc4OEVlMEU4NkRDOwogICAgYWRkcmVzcyBwdWJsaWMgcGV0Q2FyZERhdGFDb250cmFjdCA9IDB4QjM0MDY4NmRhOTk2YjhCM2Q0ODZiNEQyN0UzOEUzODUwMEE5RTkyNjsKICAgIGFkZHJlc3MgcHVibGljIGFjY2Vzc29yeURhdGFDb250cmFjdCA9IDB4NDY2YzQ0ODEyODM1ZjU3YjczNmVmOUY2MzU4MmI4YTY2OTNBMTREMDsKICAgIGFkZHJlc3MgcHVibGljIGxlYWRlcmJvYXJkRGF0YUNvbnRyYWN0ID0gMHg5QTFDNzU1MzA1YzZmYmYzNjFCNDg1NmM5YjZiNkJiZmUzYUNFNzM4OwogICAgYWRkcmVzcyBwdWJsaWMgbWVkYWxEYXRhQ29udHJhY3QgPSAgMHgzM0ExMDRkQ0JFZDgxOTYxNzAxOTAwYzA2ZkQxNDU4N0M5MDhFQWEzOwogICAgCiAgICAvLyBldmVudHMKICAgICBldmVudCBFdmVudE1lZGFsU3VjY2Vzc2Z1bChhZGRyZXNzIG93bmVyLHVpbnQ2NCBNZWRhbCk7CiAgCgogICAgLyoqKiBEQVRBIFRZUEVTICoqKi8KCiAgICBzdHJ1Y3QgQW5nZWwgewogICAgICAgIHVpbnQ2NCBhbmdlbElkOwogICAgICAgIHVpbnQ4IGFuZ2VsQ2FyZFNlcmllc0lkOwogICAgICAgIGFkZHJlc3Mgb3duZXI7CiAgICAgICAgdWludDE2IGJhdHRsZVBvd2VyOwogICAgICAgIHVpbnQ4IGF1cmE7CiAgICAgICAgdWludDE2IGV4cGVyaWVuY2U7CiAgICAgICAgdWludCBwcmljZTsKICAgICAgICB1aW50NjQgY3JlYXRlZFRpbWU7CiAgICAgICAgdWludDY0IGxhc3RCYXR0bGVUaW1lOwogICAgICAgIHVpbnQ2NCBsYXN0VnNCYXR0bGVUaW1lOwogICAgICAgIHVpbnQxNiBsYXN0QmF0dGxlUmVzdWx0OwogICAgfQoKICAgIHN0cnVjdCBQZXQgewogICAgICAgIHVpbnQ2NCBwZXRJZDsKICAgICAgICB1aW50OCBwZXRDYXJkU2VyaWVzSWQ7CiAgICAgICAgYWRkcmVzcyBvd25lcjsKICAgICAgICBzdHJpbmcgbmFtZTsKICAgICAgICB1aW50OCBsdWNrOwogICAgICAgIHVpbnQxNiBhdXJhUmVkOwogICAgICAgIHVpbnQxNiBhdXJhWWVsbG93OwogICAgICAgIHVpbnQxNiBhdXJhQmx1ZTsKICAgICAgICB1aW50NjQgbGFzdFRyYWluaW5nVGltZTsKICAgICAgICB1aW50NjQgbGFzdEJyZWVkaW5nVGltZTsKICAgICAgICB1aW50IHByaWNlOyAKICAgICAgICB1aW50NjQgbGl2ZVRpbWU7CiAgICB9CiAgICAKICAgICBzdHJ1Y3QgQWNjZXNzb3J5IHsKICAgICAgICB1aW50IGFjY2Vzc29yeUlkOwogICAgICAgIHVpbnQ4IGFjY2Vzc29yeVNlcmllc0lkOwogICAgICAgIGFkZHJlc3Mgb3duZXI7CiAgICB9CiAgICAKICAgICAgICAgLy8gU3RvcmVzIHdoaWNoIGFkZHJlc3MgaGF2ZSBjbGFpbWVkIHdoaWNoIHRva2VucywgdG8gYXZvaWQgb25lIGFkZHJlc3MgY2xhaW1pbmcgdGhlIHNhbWUgdG9rZW4gdHdpY2UuCiAgICAgICAgIC8vTm90ZSAtIHRoaXMgZG9lcyBOT1QgYWZmZWN0IG1lZGFscyB3b24gb24gdGhlIHNwb25zb3JlZCBsZWFkZXJib2FyZHM7CiAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sWzEyXSkgcHVibGljIGNsYWltZWRieUFkZHJlc3M7CiAgCiAgLy9TdG9yZXMgd2hpY2ggY2FyZHMgaGF2ZSBiZWVuIHVzZWQgdG8gY2xhaW0gbWVkYWxzLCB0byBhdm9pZCB0cmFuc2ZlcmluZyBhIGtleSBjYXJkIHRvIGFub3RoZXIgYWNjb3VudCBhbmQgY2xhaW1pbmcgYW5vdGhlciBtZWRhbC4gCgogIG1hcHBpbmcgKHVpbnQ2NCA9PiBib29sKSBwdWJsaWMgcGV0c0NsYWltZWREaWFtb25kOwogIG1hcHBpbmcgKHVpbnQ2NCA9PiBib29sKSBwdWJsaWMgcGV0c0NsYWltZWRaZXJvbml1bTsKICBtYXBwaW5nICh1aW50NjQgPT4gYm9vbCkgcHVibGljIGFuZ2Vsc0NsYWltZWRaZXJvbml1bTsKICBtYXBwaW5nICh1aW50NjQgPT4gYm9vbCkgcHVibGljIGFjY2Vzc29yaWVzQ2xhaW1lZFplcm9uaXVtOwoKICAgIC8vIHdyaXRlIGZ1bmN0aW9ucwogICAgZnVuY3Rpb24gRGF0YUNvbnRhY3RzKGFkZHJlc3MgX2FuZ2VsQ2FyZERhdGFDb250cmFjdCwgYWRkcmVzcyBfcGV0Q2FyZERhdGFDb250cmFjdCwgYWRkcmVzcyBfYWNjZXNzb3J5RGF0YUNvbnRyYWN0LCBhZGRyZXNzIF9sZWFkZXJib2FyZERhdGFDb250cmFjdCwgYWRkcmVzcyBfbWVkYWxEYXRhQ29udHJhY3QpIG9ubHlDUkVBVE9SIGV4dGVybmFsIHsKICAgICAgICBhbmdlbENhcmREYXRhQ29udHJhY3QgPSBfYW5nZWxDYXJkRGF0YUNvbnRyYWN0OwogICAgICAgIHBldENhcmREYXRhQ29udHJhY3QgPSBfcGV0Q2FyZERhdGFDb250cmFjdDsKICAgICAgICBhY2Nlc3NvcnlEYXRhQ29udHJhY3QgPSBfYWNjZXNzb3J5RGF0YUNvbnRyYWN0OwogICAgICAgIGxlYWRlcmJvYXJkRGF0YUNvbnRyYWN0ID0gX2xlYWRlcmJvYXJkRGF0YUNvbnRyYWN0OwogICAgICAgIG1lZGFsRGF0YUNvbnRyYWN0ID0gX21lZGFsRGF0YUNvbnRyYWN0OwogICAgfQogICAgICAgCiAgICBmdW5jdGlvbiBjaGVja0V4aXN0c093bmVkQW5nZWwgKHVpbnQ2NCBhbmdlbElkKSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICBJQW5nZWxDYXJkRGF0YSBhbmdlbENhcmREYXRhID0gSUFuZ2VsQ2FyZERhdGEoYW5nZWxDYXJkRGF0YUNvbnRyYWN0KTsKICAgICAgIAogICAgICAgIGlmICgoYW5nZWxJZCA8PSAwKSB8fCAoYW5nZWxJZCA+IGFuZ2VsQ2FyZERhdGEuZ2V0VG90YWxBbmdlbHMoKSkpIHtyZXR1cm4gZmFsc2U7fQogICAgICAgIGFkZHJlc3MgYW5nZWxvd25lcjsKICAgICAgICAoLCwsLCwsLCwsLGFuZ2Vsb3duZXIpID0gYW5nZWxDYXJkRGF0YS5nZXRBbmdlbChhbmdlbElkKTsKICAgICAgICBpZiAoYW5nZWxvd25lciA9PSBtc2cuc2VuZGVyKSB7cmV0dXJuIHRydWU7fQogICAgICAgIAogICAgICAgZWxzZSAgcmV0dXJuIGZhbHNlOwp9CgogICAgZnVuY3Rpb24gY2hlY2tFeGlzdHNPd25lZFBldCAodWludDY0IHBldElkKSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICAgIElQZXRDYXJkRGF0YSBwZXRDYXJkRGF0YSA9IElQZXRDYXJkRGF0YShwZXRDYXJkRGF0YUNvbnRyYWN0KTsKICAgICAgIAogICAgICAgIGlmICgocGV0SWQgPD0gMCkgfHwgKHBldElkID4gcGV0Q2FyZERhdGEuZ2V0VG90YWxQZXRzKCkpKSB7cmV0dXJuIGZhbHNlO30KICAgICAgICBhZGRyZXNzIHBldG93bmVyOwogICAgICAgICAoLCwsLCwsLHBldG93bmVyKSA9IHBldENhcmREYXRhLmdldFBldChwZXRJZCk7CiAgICAgICAgaWYgKHBldG93bmVyID09IG1zZy5zZW5kZXIpIHtyZXR1cm4gdHJ1ZTt9CiAgICAgICAgCiAgICAgICBlbHNlICByZXR1cm4gZmFsc2U7Cn0KCgogICAgZnVuY3Rpb24gZ2V0UGV0Q2FyZFNlcmllcyAodWludDY0IHBldElkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDgpIHsKICAgICAgICAgIElQZXRDYXJkRGF0YSBwZXRDYXJkRGF0YSA9IElQZXRDYXJkRGF0YShwZXRDYXJkRGF0YUNvbnRyYWN0KTsKICAgICAgIAogICAgICAgIGlmICgocGV0SWQgPD0gMCkgfHwgKHBldElkID4gcGV0Q2FyZERhdGEuZ2V0VG90YWxQZXRzKCkpKSB7cmV2ZXJ0KCk7fQogICAgICAgIHVpbnQ4IHNlcmllc0lkOwogICAgICAgICAoLHNlcmllc0lkLCwsLCwsLCwpID0gcGV0Q2FyZERhdGEuZ2V0UGV0KHBldElkKTsKICAgICAgICByZXR1cm4gdWludDgoc2VyaWVzSWQpOwogICAgICAgIH0KCiAgICAKICAgICAgICAgICAgZnVuY3Rpb24gYXdhcmRCcm9uemUoYWRkcmVzcyBfdG8xLCBhZGRyZXNzIF90bzIsIGFkZHJlc3MgX3RvMykgb25seUNSRUFUT1IgZXh0ZXJuYWwgIHsKICAgICAgICAgICAgLy9ObyBjaGVja3MgaGVyZSAtIHlvdSBjYW4gYmUgYXdhcmRlZCBtb3JlIHRoYW4gb25lIGJyb256ZSBtZWRhbC4gCiAgICAgICAgICAgIElNZWRhbERhdGEgbWVkYWxEYXRhID0gSU1lZGFsRGF0YShtZWRhbERhdGFDb250cmFjdCk7CiAgICAgICAgICBpZiAoX3RvMSAhPSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIG1lZGFsRGF0YS5fY3JlYXRlTWVkYWwoX3RvMSwgMyk7CiAgICAgICAgICAgIEV2ZW50TWVkYWxTdWNjZXNzZnVsKF90bzEsMyk7ICAKICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKF90bzIgIT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICBtZWRhbERhdGEuX2NyZWF0ZU1lZGFsKF90bzIsIDMpOwogICAgICAgICAgICBFdmVudE1lZGFsU3VjY2Vzc2Z1bChfdG8yLDMpOyAgCiAgICAgICAgICB9CiAgICAgICAgICAgaWYgKF90bzMgIT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICBtZWRhbERhdGEuX2NyZWF0ZU1lZGFsKF90bzMsIDMpOwogICAgICAgICAgICBFdmVudE1lZGFsU3VjY2Vzc2Z1bChfdG8zLDMpOyAgCiAgICAgICAgICB9CiAgICAgICAgICAKICAgICAgfQogICAgICAgICAgICAgCiAgICAKICAgICAKICAgICBmdW5jdGlvbiBjbGFpbURpYW1vbmQodWludDY0IHBldDFJZCwgdWludDY0IHBldDJJZCkgcHVibGljIHsKICAgICAgICAgLy9jYW4gb25seSBiZSBjbGFpbWVkIG9uY2UgcGVyIGFkZHJlc3M7CiAgICAgICAgaWYgKGNsYWltZWRieUFkZHJlc3NbbXNnLnNlbmRlcl1bOV0gPT0gdHJ1ZSkge3JldmVydCgpO30KICAgICAgICBpZiAoKGNoZWNrRXhpc3RzT3duZWRQZXQocGV0MUlkKSA9PSBmYWxzZSkgfHwgKGNoZWNrRXhpc3RzT3duZWRQZXQocGV0MklkKSA9PSBmYWxzZSkpIHtyZXZlcnQoKTt9CiAgICAgICAgSVBldENhcmREYXRhIHBldENhcmREYXRhID0gSVBldENhcmREYXRhKHBldENhcmREYXRhQ29udHJhY3QpOwogICAgICAgIFBldCBtZW1vcnkgcGV0MTsKICAgICAgICBQZXQgbWVtb3J5IHBldDI7CiAgICAgICAgICAgICgsLCwsIHBldDEuYXVyYVJlZCwgcGV0MS5hdXJhQmx1ZSwgcGV0MS5hdXJhWWVsbG93LCwgLCkgPSBwZXRDYXJkRGF0YS5nZXRQZXQocGV0MUlkKTsKICAgICAgICAgICAgKCwsLCwgcGV0Mi5hdXJhUmVkLCBwZXQyLmF1cmFCbHVlLCBwZXQyLmF1cmFZZWxsb3csLCAsKSA9IHBldENhcmREYXRhLmdldFBldChwZXQySWQpOwogICAgICAgICAgICAKICAgICAgICAgaWYgKChwZXQxLmF1cmFSZWQgPj0gMjQwKSB8fCAocGV0MS5hdXJhWWVsbG93ID49MjQwKSB8fCAocGV0MS5hdXJhQmx1ZSA+PSAyNDApKSB7CiAgICAgICAgICAgICBpZiAoKHBldDIuYXVyYVJlZCA+PSAyNDApIHx8IChwZXQyLmF1cmFZZWxsb3cgPj0yNDApIHx8IChwZXQyLmF1cmFCbHVlID49IDI0MCkpIHsKICAgICAgICAgICAgIGNsYWltZWRieUFkZHJlc3NbbXNnLnNlbmRlcl1bOV0gPSB0cnVlOwogICAgICAgICAgICAgSU1lZGFsRGF0YSBtZWRhbERhdGEgPSBJTWVkYWxEYXRhKG1lZGFsRGF0YUNvbnRyYWN0KTsgICAKICAgICAgICAgICAgIG1lZGFsRGF0YS5fY3JlYXRlTWVkYWwobXNnLnNlbmRlciwgOSk7CiAgICAgICAgICAgICBFdmVudE1lZGFsU3VjY2Vzc2Z1bChtc2cuc2VuZGVyLDkpOwogICAgICAgICAgICAgfQogICAgICAgICAgICAgCiAgICAgICAgIH0KICAgICB9CiAgCiAgICAgICAgZnVuY3Rpb24gYXdhcmRUaXRhbml1bShhZGRyZXNzIF90bzEsIGFkZHJlc3MgX3RvMiwgYWRkcmVzcyBfdG8zKSBvbmx5Q1JFQVRPUiBleHRlcm5hbCAgewogICAgICAgIElNZWRhbERhdGEgbWVkYWxEYXRhID0gSU1lZGFsRGF0YShtZWRhbERhdGFDb250cmFjdCk7CiAgICAgICAgICBpZiAoX3RvMSAhPSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIG1lZGFsRGF0YS5fY3JlYXRlTWVkYWwoX3RvMSwgMTApOwogICAgICAgICAgICBFdmVudE1lZGFsU3VjY2Vzc2Z1bChfdG8xLDEwKTsgIAogICAgICAgICAgfQogICAgICAgICAgICBpZiAoX3RvMiAhPSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIG1lZGFsRGF0YS5fY3JlYXRlTWVkYWwoX3RvMiwgMTApOwogICAgICAgICAgICBFdmVudE1lZGFsU3VjY2Vzc2Z1bChfdG8yLDEwKTsgIAogICAgICAgICAgfQogICAgICAgICAgIGlmIChfdG8zICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgbWVkYWxEYXRhLl9jcmVhdGVNZWRhbChfdG8zLCAxMCk7CiAgICAgICAgICAgIEV2ZW50TWVkYWxTdWNjZXNzZnVsKF90bzMsMTApOyAgCiAgICAgICAgICB9CiAgICAgICAgICAKICAgICAgfQogICAgICAKICAgICAgZnVuY3Rpb24gY2xhaW1aZXJvbml1bSh1aW50NjQgTWljaGFlbElkLCB1aW50NjQgSm9waGllbElkLCB1aW50NjQgZmlyZUVsZW1lbnRhbElkLCB1aW50NjQgd2F0ZXJFbGVtZW50YWxJZCwgdWludDY0IGxpZ2h0bmluZ1JvZElkLCB1aW50NjQgSG9seUxpZ2h0SWQpIGV4dGVybmFsIHsKICAgICAgICAgICAgICAgLy9jYW4gb25seSBiZSBjbGFpbWVkIG9uY2UgcGVyIGFkZHJlc3M7CiAgICAgICAgICAgICAgaWYgKGNsYWltZWRieUFkZHJlc3NbbXNnLnNlbmRlcl1bMTFdID09IHRydWUpIHtyZXZlcnQoKTt9CiAgICAgICAgICAgICAgaWYgKChhbmdlbHNDbGFpbWVkWmVyb25pdW1bTWljaGFlbElkXT09dHJ1ZSkgfHwgKGFuZ2Vsc0NsYWltZWRaZXJvbml1bVtKb3BoaWVsSWRdID09IHRydWUpKSB7cmV2ZXJ0KCk7fQogICAgICAgICAgICAgIGlmICgocGV0c0NsYWltZWRaZXJvbml1bVtmaXJlRWxlbWVudGFsSWRdPT0gdHJ1ZSkgfHwgKHBldHNDbGFpbWVkWmVyb25pdW1bd2F0ZXJFbGVtZW50YWxJZF0gPT0gdHJ1ZSkpIHtyZXZlcnQoKTt9CiAgICAgICAgICAgICAgaWYgKChhY2Nlc3Nvcmllc0NsYWltZWRaZXJvbml1bVtsaWdodG5pbmdSb2RJZF0gPT0gdHJ1ZSkgfHwgKGFjY2Vzc29yaWVzQ2xhaW1lZFplcm9uaXVtW0hvbHlMaWdodElkXSA9PSB0cnVlKSkge3JldmVydCgpO30KICAgICAgICAgICAgICBJQW5nZWxDYXJkRGF0YSBhbmdlbENhcmREYXRhID0gSUFuZ2VsQ2FyZERhdGEoYW5nZWxDYXJkRGF0YUNvbnRyYWN0KTsKICAgICAgICAgICAgICBJUGV0Q2FyZERhdGEgcGV0Q2FyZERhdGEgPSBJUGV0Q2FyZERhdGEocGV0Q2FyZERhdGFDb250cmFjdCk7CiAgICAgICAgICAgICAgSUFjY2Vzc29yeURhdGEgYWNjZXNzb3J5RGF0YSA9IElBY2Nlc3NvcnlEYXRhKGFjY2Vzc29yeURhdGFDb250cmFjdCk7CiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgdWludDY0WzZdIG1lbW9yeSBpZHM7CiAgICAgICAgICAgICAgYWRkcmVzc1s2XSBtZW1vcnkgb3duZXJzOwogICAgICAgICAgICAgIAogICAgICAgICAgICAgIAogICAgICAgICAgICAoLGlkc1swXSwsLCwsLCwgLG93bmVyc1swXSkgPSBwZXRDYXJkRGF0YS5nZXRQZXQoZmlyZUVsZW1lbnRhbElkKTsKICAgICAgICAgICAgKCxpZHNbMV0sLCwsLCwsICxvd25lcnNbMV0pID0gcGV0Q2FyZERhdGEuZ2V0UGV0KHdhdGVyRWxlbWVudGFsSWQpOwogICAgICAgICAgICAKICAgICAgICAgICAgICAoLGlkc1syXSwsLCwsLCwsLG93bmVyc1syXSkgPSBhbmdlbENhcmREYXRhLmdldEFuZ2VsKE1pY2hhZWxJZCk7CiAgICAgICAgICAgICAgKCxpZHNbM10sLCwsLCwsLCxvd25lcnNbM10pID0gYW5nZWxDYXJkRGF0YS5nZXRBbmdlbChKb3BoaWVsSWQpOwogICAgICAgICAgICAKICAgICAgICAgICAKICAgICAgICAgICAgICAoLGlkc1s0XSxvd25lcnNbNF0pID0gIGFjY2Vzc29yeURhdGEuZ2V0QWNjZXNzb3J5KGxpZ2h0bmluZ1JvZElkKTsKICAgICAgICAgICAgICAoLGlkc1s1XSxvd25lcnNbNV0pID0gIGFjY2Vzc29yeURhdGEuZ2V0QWNjZXNzb3J5KEhvbHlMaWdodElkKTsKICAgICAgICAgICAgICAKICAgICAgICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPDY7IGkrKykgewogICAgICAgICAgICAgICAgICBpZiAob3duZXJzW2ldICE9IG1zZy5zZW5kZXIpIHtyZXZlcnQoKTt9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIAogICAgICAgICAgICAgIAogICAgICAgICAgaWYgKChpZHNbMF0gPT0gMTcpICYmIChpZHNbMV0gPT0gMTgpICYmIChpZHNbMl0gPT0gMykgICYmIChpZHNbM10gPT0gMjMpICAmJiAoaWRzWzRdID09IDE3KSAgJiYgKGlkc1s1XSA9PSAxOCkgKSAgewogICAgICAgICAgICAgIGFuZ2Vsc0NsYWltZWRaZXJvbml1bVtNaWNoYWVsSWRdPXRydWU7CiAgICAgICAgICAgICAgYW5nZWxzQ2xhaW1lZFplcm9uaXVtW0pvcGhpZWxJZF0gPSB0cnVlOwogICAgICAgICAgICAgCiAgICAgICAgICAgICAgcGV0c0NsYWltZWRaZXJvbml1bVtmaXJlRWxlbWVudGFsSWRdPSB0cnVlOwogICAgICAgICAgICAgIHBldHNDbGFpbWVkWmVyb25pdW1bd2F0ZXJFbGVtZW50YWxJZF0gPSB0cnVlOwogICAgICAgICAgICAgIAogICAgICAgICAgCiAgICAgICAgICAgICAgYWNjZXNzb3JpZXNDbGFpbWVkWmVyb25pdW1bbGlnaHRuaW5nUm9kSWRdID0gdHJ1ZTsgCiAgICAgICAgICAgICAgYWNjZXNzb3JpZXNDbGFpbWVkWmVyb25pdW1bSG9seUxpZ2h0SWRdID0gdHJ1ZTsKICAgICAgICAgICAgICAKICAgICAgICAgICAgIGNsYWltZWRieUFkZHJlc3NbbXNnLnNlbmRlcl1bMTFdID0gdHJ1ZTsKICAgICAgICAgICAgIElNZWRhbERhdGEgbWVkYWxEYXRhID0gSU1lZGFsRGF0YShtZWRhbERhdGFDb250cmFjdCk7ICAgCiAgICAgICAgICAgICBtZWRhbERhdGEuX2NyZWF0ZU1lZGFsKG1zZy5zZW5kZXIsIDExKTsKICAgICAgICAgICAgIEV2ZW50TWVkYWxTdWNjZXNzZnVsKG1zZy5zZW5kZXIsMTEpOwogICAgICAgICAgfQogICAgICB9CiAgICAgIAogICAgICBmdW5jdGlvbiBnZXRBbmdlbENsYWltcyAodWludDY0IGFuZ2VsSWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sIGNsYWltZWRaZXJvbml1bSkgewogICAgICAgICAgLy9iZWZvcmUgcHVyY2hhc2luZyBhbiBhbmdlbCBjYXJkLCBhbnlvbmUgY2FuIHZlcmlmeSBpZiB0aGF0IGNhcmQgaGFzIGFscmVhZHkgYmVlbiB1c2VkIHRvIGNsYWltIG1lZGFscwogICAgICAgICAgaWYgKGFuZ2VsSWQgPCAwKSB7cmV2ZXJ0KCk7fQogICAgICAgICAgY2xhaW1lZFplcm9uaXVtID0gYW5nZWxzQ2xhaW1lZFplcm9uaXVtW2FuZ2VsSWRdOwogICAgICB9CiAgICAgIAogICAgICAgICAgZnVuY3Rpb24gZ2V0UGV0Q2xhaW1zICh1aW50NjQgcGV0SWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sIGNsYWltZWREaWFtb25kLCBib29sIGNsYWltZWRaZXJvbml1bSkgewogICAgICAgICAgLy9iZWZvcmUgcHVyY2hhc2luZyBhIHBldCBjYXJkLCBhbnlvbmUgY2FuIHZlcmlmeSBpZiB0aGF0IGNhcmQgaGFzIGFscmVhZHkgYmVlbiB1c2VkIHRvIGNsYWltIG1lZGFscwogICAgICAgICAgaWYgKHBldElkIDwgMCkge3JldmVydCgpO30KICAgICAgICAgIGNsYWltZWREaWFtb25kID0gcGV0c0NsYWltZWREaWFtb25kW3BldElkXTsKICAgICAgICAgIGNsYWltZWRaZXJvbml1bSA9IHBldHNDbGFpbWVkWmVyb25pdW1bcGV0SWRdOwogICAgICAgIAogICAgICB9CiAgICAgIAogICAgICAgIGZ1bmN0aW9uIGdldEFjY2Vzc29yeUNsYWltcyAodWludDY0IGFjY2Vzc29yeUlkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCBjbGFpbWVkWmVyb25pdW0pIHsKICAgICAgICAgIC8vYmVmb3JlIHB1cmNoYXNpbmcgYW4gYWNjZXNzb3J5IGNhcmQsIGFueW9uZSBjYW4gdmVyaWZ5IGlmIHRoYXQgY2FyZCBoYXMgYWxyZWFkeSBiZWVuIHVzZWQgdG8gY2xhaW0gbWVkYWxzCiAgICAgICAgICBpZiAoYWNjZXNzb3J5SWQgPCAwKSB7cmV2ZXJ0KCk7fQogICAgICAgICAgY2xhaW1lZFplcm9uaXVtID0gYWNjZXNzb3JpZXNDbGFpbWVkWmVyb25pdW1bYWNjZXNzb3J5SWRdOwogICAgICAgICAgCiAgICAgIH0KICAgICAKICAgICBmdW5jdGlvbiBnZXRBZGRyZXNzQ2xhaW1zKGFkZHJlc3MgX2FkZHJlc3MsIHVpbnQ4IF9tZWRhbCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICAgcmV0dXJuIGNsYWltZWRieUFkZHJlc3NbX2FkZHJlc3NdW19tZWRhbF07CiAgICAgfQogICAgIAogICAgIAogICAgICAKICAgICAgZnVuY3Rpb24ga2lsbCgpIG9ubHlDUkVBVE9SIGV4dGVybmFsIHsKICAgICAgICBzZWxmZGVzdHJ1Y3QoY3JlYXRvckFkZHJlc3MpOwogICAgfQp9'.
	

]
