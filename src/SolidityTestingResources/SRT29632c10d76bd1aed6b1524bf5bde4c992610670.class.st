Class {
	#name : #SRT29632c10d76bd1aed6b1524bf5bde4c992610670,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT29632c10d76bd1aed6b1524bf5bde4c992610670 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTc7CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBBcHBsaWNhdGlvbiBFbnRpdHkgR2VuZXJpYyBDb250cmFjdAogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PHNwYW4gY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSJiNWQ4ZGNkNmRlY2NmNWRiZGFjMmQ5ZGNjM2QwOWJjN2RhIj5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4KCiAgICBVc2VkIGZvciB0aGUgQUJJIGludGVyZmFjZSB3aGVuIGFzc2V0cyBuZWVkIHRvIGNhbGwgQXBwbGljYXRpb24gRW50aXR5LgoKICAgIFRoaXMgaXMgcmVxdWlyZWQsIG90aGVyd2lzZSB3ZSBlbmQgdXAgbG9hZGluZyB0aGUgYXNzZXRzIHRoZW1zZWx2ZXMgd2hlbiB3ZSBsb2FkIHRoZSBBcHBsaWNhdGlvbkVudGl0eSBjb250cmFjdAogICAgYW5kIGVuZCB1cCBpbiBhIGxvb3AKKi8KCgoKY29udHJhY3QgQXBwbGljYXRpb25FbnRpdHlBQkkgewoKICAgIGFkZHJlc3MgcHVibGljIFByb3Bvc2Fsc0VudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIEZ1bmRpbmdFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBNaWxlc3RvbmVzRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgTWVldGluZ3NFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBCb3VudHlNYW5hZ2VyRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgVG9rZW5NYW5hZ2VyRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgTGlzdGluZ0NvbnRyYWN0RW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgRnVuZGluZ01hbmFnZXJFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBOZXdzQ29udHJhY3RFbnRpdHk7CgogICAgYm9vbCBwdWJsaWMgX2luaXRpYWxpemVkID0gZmFsc2U7CiAgICBib29sIHB1YmxpYyBfbG9ja2VkID0gZmFsc2U7CiAgICB1aW50OCBwdWJsaWMgQ3VycmVudEVudGl0eVN0YXRlOwogICAgdWludDggcHVibGljIEFzc2V0Q29sbGVjdGlvbk51bTsKICAgIGFkZHJlc3MgcHVibGljIEdhdGV3YXlJbnRlcmZhY2VBZGRyZXNzOwogICAgYWRkcmVzcyBwdWJsaWMgZGVwbG95ZXJBZGRyZXNzOwogICAgYWRkcmVzcyB0ZXN0QWRkcmVzc0FsbG93VXBncmFkZUZyb207CiAgICBtYXBwaW5nIChieXRlczMyID0+IHVpbnQ4KSBwdWJsaWMgRW50aXR5U3RhdGVzOwogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiBhZGRyZXNzKSBwdWJsaWMgQXNzZXRDb2xsZWN0aW9uOwogICAgbWFwcGluZyAodWludDggPT4gYnl0ZXMzMikgcHVibGljIEFzc2V0Q29sbGVjdGlvbklkVG9OYW1lOwogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiB1aW50MjU2KSBwdWJsaWMgQnlsYXdzVWludDI1NjsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gYnl0ZXMzMikgcHVibGljIEJ5bGF3c0J5dGVzMzI7CgogICAgZnVuY3Rpb24gQXBwbGljYXRpb25FbnRpdHkoKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBnZXRFbnRpdHlTdGF0ZShieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGxpbmtUb0dhdGV3YXkoIGFkZHJlc3MgX0dhdGV3YXlJbnRlcmZhY2VBZGRyZXNzLCBieXRlczMyIF9zb3VyY2VDb2RlVXJsICkgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBzZXRVcGdyYWRlU3RhdGUodWludDggc3RhdGUpIHB1YmxpYyA7CiAgICBmdW5jdGlvbiBhZGRBc3NldFByb3Bvc2FscyhhZGRyZXNzIF9hc3NldEFkZHJlc3NlcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBhZGRBc3NldEZ1bmRpbmcoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYWRkQXNzZXRNaWxlc3RvbmVzKGFkZHJlc3MgX2Fzc2V0QWRkcmVzc2VzKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIGFkZEFzc2V0TWVldGluZ3MoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYWRkQXNzZXRCb3VudHlNYW5hZ2VyKGFkZHJlc3MgX2Fzc2V0QWRkcmVzc2VzKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIGFkZEFzc2V0VG9rZW5NYW5hZ2VyKGFkZHJlc3MgX2Fzc2V0QWRkcmVzc2VzKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIGFkZEFzc2V0RnVuZGluZ01hbmFnZXIoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYWRkQXNzZXRMaXN0aW5nQ29udHJhY3QoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYWRkQXNzZXROZXdzQ29udHJhY3QoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gZ2V0QXNzZXRBZGRyZXNzQnlOYW1lKGJ5dGVzMzIgX25hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3MpOwogICAgZnVuY3Rpb24gc2V0QnlsYXdVaW50MjU2KGJ5dGVzMzIgbmFtZSwgdWludDI1NiB2YWx1ZSkgcHVibGljOwogICAgZnVuY3Rpb24gZ2V0QnlsYXdVaW50MjU2KGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBzZXRCeWxhd0J5dGVzMzIoYnl0ZXMzMiBuYW1lLCBieXRlczMyIHZhbHVlKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBnZXRCeWxhd0J5dGVzMzIoYnl0ZXMzMiBuYW1lKSBwdWJsaWMgdmlldyByZXR1cm5zIChieXRlczMyKTsKICAgIGZ1bmN0aW9uIGluaXRpYWxpemUoKSBleHRlcm5hbCByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldFBhcmVudEFkZHJlc3MoKSBleHRlcm5hbCB2aWV3IHJldHVybnMoYWRkcmVzcyk7CiAgICBmdW5jdGlvbiBjcmVhdGVDb2RlVXBncmFkZVByb3Bvc2FsKCBhZGRyZXNzIF9uZXdBZGRyZXNzLCBieXRlczMyIF9zb3VyY2VDb2RlVXJsICkgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBhY2NlcHRDb2RlVXBncmFkZVByb3Bvc2FsKGFkZHJlc3MgX25ld0FkZHJlc3MpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gaW5pdGlhbGl6ZUFzc2V0c1RvVGhpc0FwcGxpY2F0aW9uKCkgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckFzc2V0c1RvTmV3QXBwbGljYXRpb24oYWRkcmVzcyBfbmV3QWRkcmVzcykgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBsb2NrKCkgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBjYW5Jbml0aWF0ZUNvZGVVcGdyYWRlKGFkZHJlc3MgX3NlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyhib29sKTsKICAgIGZ1bmN0aW9uIGRvU3RhdGVDaGFuZ2VzKCkgcHVibGljOwogICAgZnVuY3Rpb24gaGFzUmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGFueUFzc2V0SGFzQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZXh0ZW5kZWRBbnlBc3NldEhhc0NoYW5nZXMoKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0UmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCwgdWludDgpOwogICAgZnVuY3Rpb24gZ2V0VGltZXN0YW1wKCkgdmlldyBwdWJsaWMgcmV0dXJucyAodWludDI1Nik7Cgp9CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBHYXRld2F5IEludGVyZmFjZSBDb250cmFjdAogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PHNwYW4gY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSIxYTc3NzM3OTcxNjM1YTc0NzU2ZDc2NzM2YzdmMzQ2ODc1Ij5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4KCiBVc2VkIGFzIGEgcmVzb2x2ZXIgdG8gcmV0cmlldmUgdGhlIGxhdGVzdCBkZXBsb3llZCB2ZXJzaW9uIG9mIHRoZSBBcHBsaWNhdGlvbgoKIEVOUzogZ2F0ZXdheS5tYWluLmJsb2NrYml0cy5ldGggd2lsbCBwb2ludCBkaXJlY3RseSB0byB0aGlzIGNvbnRyYWN0LgoKICAgIEFERCBFTlMgZG9tYWluIG93bmVyc2hpcCAvIHRyYW5zZmVyIG1ldGhvZHMKCiovCgoKCgoKY29udHJhY3QgQUJJR2F0ZXdheUludGVyZmFjZSB7CiAgICBhZGRyZXNzIHB1YmxpYyBjdXJyZW50QXBwbGljYXRpb25FbnRpdHlBZGRyZXNzOwogICAgQXBwbGljYXRpb25FbnRpdHlBQkkgcHJpdmF0ZSBjdXJyZW50QXBwOwogICAgYWRkcmVzcyBwdWJsaWMgZGVwbG95ZXJBZGRyZXNzOwoKICAgIGZ1bmN0aW9uIGdldEFwcGxpY2F0aW9uQWRkcmVzcygpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYWRkcmVzcyk7CiAgICBmdW5jdGlvbiByZXF1ZXN0Q29kZVVwZ3JhZGUoIGFkZHJlc3MgX25ld0FkZHJlc3MsIGJ5dGVzMzIgX3NvdXJjZUNvZGVVcmwgKSBleHRlcm5hbCByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGFwcHJvdmVDb2RlVXBncmFkZSggYWRkcmVzcyBfbmV3QWRkcmVzcyApIGV4dGVybmFsIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gbGluayggYWRkcmVzcyBfbmV3QWRkcmVzcyApIGludGVybmFsIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0TmV3c0NvbnRyYWN0QWRkcmVzcygpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYWRkcmVzcyk7CiAgICBmdW5jdGlvbiBnZXRMaXN0aW5nQ29udHJhY3RBZGRyZXNzKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKfQoKLyoKCiAqIHNvdXJjZSAgICAgICBodHRwczovL2dpdGh1Yi5jb20vYmxvY2tiaXRzaW8vCgogKiBAbmFtZSAgICAgICAgQXBwbGljYXRpb24gQXNzZXQgQ29udHJhY3QgQUJJCiAqIEBwYWNrYWdlICAgICBCbG9ja0JpdHNJTwogKiBAYXV0aG9yICAgICAgTWlja3kgU29jYWNpIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjcyMWYxYjExMTkwYjMyMWMxZDA1MWUxYjA0MTc1YzAwMWQiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+PgoKIEFueSBjb250cmFjdCBpbmhlcml0aW5nIHRoaXMgd2lsbCBiZSB1c2FibGUgYXMgYW4gQXNzZXQgaW4gdGhlIEFwcGxpY2F0aW9uIEVudGl0eQoKKi8KCgoKY29udHJhY3QgQUJJQXBwbGljYXRpb25Bc3NldCB7CgogICAgYnl0ZXMzMiBwdWJsaWMgYXNzZXROYW1lOwogICAgdWludDggcHVibGljIEN1cnJlbnRFbnRpdHlTdGF0ZTsKICAgIHVpbnQ4IHB1YmxpYyBSZWNvcmROdW07CiAgICBib29sIHB1YmxpYyBfaW5pdGlhbGl6ZWQ7CiAgICBib29sIHB1YmxpYyBfc2V0dGluZ3NBcHBsaWVkOwogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICBhZGRyZXNzIHB1YmxpYyBkZXBsb3llckFkZHJlc3M7CiAgICBtYXBwaW5nIChieXRlczMyID0+IHVpbnQ4KSBwdWJsaWMgRW50aXR5U3RhdGVzOwogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiB1aW50OCkgcHVibGljIFJlY29yZFN0YXRlczsKCiAgICBmdW5jdGlvbiBzZXRJbml0aWFsQXBwbGljYXRpb25BZGRyZXNzKGFkZHJlc3MgX293bmVyQWRkcmVzcykgcHVibGljOwogICAgZnVuY3Rpb24gc2V0SW5pdGlhbE93bmVyQW5kTmFtZShieXRlczMyIF9uYW1lKSBleHRlcm5hbCByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldFJlY29yZFN0YXRlKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gZ2V0RW50aXR5U3RhdGUoYnl0ZXMzMiBuYW1lKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCk7CiAgICBmdW5jdGlvbiBhcHBseUFuZExvY2tTZXR0aW5ncygpIHB1YmxpYyByZXR1cm5zKGJvb2wpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJUb05ld093bmVyKGFkZHJlc3MgX25ld093bmVyKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvbkFzc2V0QWRkcmVzc0J5TmFtZShieXRlczMyIF9uYW1lKSBwdWJsaWMgcmV0dXJucyhhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIGdldEFwcGxpY2F0aW9uU3RhdGUoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCk7CiAgICBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvbkVudGl0eVN0YXRlKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gZ2V0QXBwQnlsYXdVaW50MjU2KGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBnZXRBcHBCeWxhd0J5dGVzMzIoYnl0ZXMzMiBuYW1lKSBwdWJsaWMgdmlldyByZXR1cm5zIChieXRlczMyKTsKICAgIGZ1bmN0aW9uIGdldFRpbWVzdGFtcCgpIHZpZXcgcHVibGljIHJldHVybnMgKHVpbnQyNTYpOwoKCn0KCi8qCgogKiBzb3VyY2UgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL2Jsb2NrYml0c2lvLwoKICogQG5hbWUgICAgICAgIFByb3Bvc2FscyBDb250cmFjdAogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PHNwYW4gY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSIxNjdiN2Y3NTdkNmY1Njc4Nzk2MTdhN2Y2MDczMzg2NDc5Ij5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4KCiBDb250YWlucyB0aGUgUHJvcG9zYWxzIENvbnRyYWN0IGNvZGUgZGVwbG95ZWQgYW5kIGxpbmtlZCB0byB0aGUgQXBwbGljYXRpb24gRW50aXR5CgoqLwoKCgoKCmNvbnRyYWN0IEFCSVByb3Bvc2FscyBpcyBBQklBcHBsaWNhdGlvbkFzc2V0IHsKCiAgICBhZGRyZXNzIHB1YmxpYyBBcHBsaWNhdGlvbjsKICAgIGFkZHJlc3MgcHVibGljIExpc3RpbmdDb250cmFjdEVudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIEZ1bmRpbmdFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBGdW5kaW5nTWFuYWdlckVudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIFRva2VuTWFuYWdlckVudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIFRva2VuRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgTWlsZXN0b25lc0VudGl0eTsKCiAgICBzdHJ1Y3QgUHJvcG9zYWxSZWNvcmQgewogICAgICAgIGFkZHJlc3MgY3JlYXRvcjsKICAgICAgICBieXRlczMyIG5hbWU7CiAgICAgICAgdWludDggYWN0aW9uVHlwZTsKICAgICAgICB1aW50OCBzdGF0ZTsKICAgICAgICBieXRlczMyIGhhc2g7ICAgICAgICAgICAgICAgICAgICAgICAvLyBhY3Rpb24gbmFtZSArIGFyZ3MgaGFzaAogICAgICAgIGFkZHJlc3MgYWRkcjsKICAgICAgICBieXRlczMyIHNvdXJjZUNvZGVVcmw7CiAgICAgICAgdWludDI1NiBleHRyYTsKICAgICAgICB1aW50MjU2IHRpbWVfc3RhcnQ7CiAgICAgICAgdWludDI1NiB0aW1lX2VuZDsKICAgICAgICB1aW50MjU2IGluZGV4OwogICAgfQoKICAgIHN0cnVjdCBWb3RlU3RydWN0IHsKICAgICAgICBhZGRyZXNzIHZvdGVyOwogICAgICAgIHVpbnQyNTYgdGltZTsKICAgICAgICBib29sICAgIHZvdGU7CiAgICAgICAgdWludDI1NiBwb3dlcjsKICAgICAgICBib29sICAgIGFubnVsbGVkOwogICAgICAgIHVpbnQyNTYgaW5kZXg7CiAgICB9CgogICAgc3RydWN0IFJlc3VsdFJlY29yZCB7CiAgICAgICAgdWludDI1NiB0b3RhbEF2YWlsYWJsZTsKICAgICAgICB1aW50MjU2IHJlcXVpcmVkRm9yUmVzdWx0OwogICAgICAgIHVpbnQyNTYgdG90YWxTb0ZhcjsKICAgICAgICB1aW50MjU2IHllczsKICAgICAgICB1aW50MjU2IG5vOwogICAgICAgIGJvb2wgICAgcmVxdWlyZXNDb3VudGluZzsKICAgIH0KCiAgICB1aW50OCBwdWJsaWMgQWN0aXZlUHJvcG9zYWxOdW07CiAgICB1aW50MjU2IHB1YmxpYyBWb3RlQ291bnRQZXJQcm9jZXNzOwogICAgYm9vbCBwdWJsaWMgRW1lcmdlbmN5RnVuZGluZ1JlbGVhc2VBcHByb3ZlZDsKCiAgICBtYXBwaW5nIChieXRlczMyID0+IHVpbnQ4KSBwdWJsaWMgQWN0aW9uVHlwZXM7CiAgICBtYXBwaW5nICh1aW50OCA9PiB1aW50MjU2KSBwdWJsaWMgQWN0aXZlUHJvcG9zYWxJZHM7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IGJvb2wpIHB1YmxpYyBFeHBpcmVkUHJvcG9zYWxJZHM7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IFByb3Bvc2FsUmVjb3JkKSBwdWJsaWMgUHJvcG9zYWxzQnlJZDsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludDI1NikgcHVibGljIFByb3Bvc2FsSWRCeUhhc2g7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IG1hcHBpbmcgKHVpbnQyNTYgPT4gVm90ZVN0cnVjdCkgKSBwdWJsaWMgVm90ZXNCeVByb3Bvc2FsSWQ7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gVm90ZVN0cnVjdCkgKSBwdWJsaWMgVm90ZXNCeUNhc3RlcjsKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gdWludDI1NikgcHVibGljIFZvdGVzTnVtQnlQcm9wb3NhbElkOwogICAgbWFwcGluZyAodWludDI1NiA9PiBSZXN1bHRSZWNvcmQgKSBwdWJsaWMgUmVzdWx0c0J5UHJvcG9zYWxJZDsKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gdWludDI1NikgcHVibGljIGxhc3RQcm9jZXNzZWRWb3RlSWRCeVByb3Bvc2FsOwogICAgbWFwcGluZyAodWludDI1NiA9PiB1aW50MjU2KSBwdWJsaWMgUHJvY2Vzc2VkVm90ZXNCeVByb3Bvc2FsOwogICAgbWFwcGluZyAodWludDI1NiA9PiB1aW50MjU2KSBwdWJsaWMgVm90ZUNvdW50QXRQcm9jZXNzaW5nU3RhcnRCeVByb3Bvc2FsOwoKICAgIGZ1bmN0aW9uIGdldFJlY29yZFN0YXRlKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gZ2V0QWN0aW9uVHlwZShieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGdldFByb3Bvc2FsU3RhdGUodWludDI1NiBfcHJvcG9zYWxJZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gZ2V0QnlsYXdzUHJvcG9zYWxWb3RpbmdEdXJhdGlvbigpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gZ2V0QnlsYXdzTWlsZXN0b25lTWluUG9zdHBvbmluZygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gZ2V0QnlsYXdzTWlsZXN0b25lTWF4UG9zdHBvbmluZygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gZ2V0SGFzaCh1aW50OCBhY3Rpb25UeXBlLCBieXRlczMyIGFyZzEsIGJ5dGVzMzIgYXJnMikgcHVibGljIHB1cmUgcmV0dXJucyAoIGJ5dGVzMzIgKTsKICAgIGZ1bmN0aW9uIHByb2Nlc3MoKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBoYXNSZXF1aXJlZFN0YXRlQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0UmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCk7CiAgICBmdW5jdGlvbiBhZGRDb2RlVXBncmFkZVByb3Bvc2FsKGFkZHJlc3MgX2FkZHIsIGJ5dGVzMzIgX3NvdXJjZUNvZGVVcmwpIGV4dGVybmFsIHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gY3JlYXRlTWlsZXN0b25lQWNjZXB0YW5jZVByb3Bvc2FsKCkgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBjcmVhdGVNaWxlc3RvbmVQb3N0cG9uaW5nUHJvcG9zYWwodWludDI1NiBfZHVyYXRpb24pIGV4dGVybmFsIHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gZ2V0Q3VycmVudE1pbGVzdG9uZVBvc3Rwb25pbmdQcm9wb3NhbER1cmF0aW9uKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBnZXRDdXJyZW50TWlsZXN0b25lUHJvcG9zYWxTdGF0dXNGb3JUeXBlKHVpbnQ4IF9hY3Rpb25UeXBlICkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gY3JlYXRlRW1lcmdlbmN5RnVuZFJlbGVhc2VQcm9wb3NhbCgpIGV4dGVybmFsIHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gY3JlYXRlRGVsaXN0aW5nUHJvcG9zYWwodWludDI1NiBfcHJvamVjdElkKSBleHRlcm5hbCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIFJlZ2lzdGVyVm90ZSh1aW50MjU2IF9wcm9wb3NhbElkLCBib29sIF9teVZvdGUpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGhhc1ByZXZpb3VzVm90ZSh1aW50MjU2IF9wcm9wb3NhbElkLCBhZGRyZXNzIF92b3RlcikgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRUb3RhbFRva2VuVm90aW5nUG93ZXIoYWRkcmVzcyBfdm90ZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKCB1aW50MjU2ICk7CiAgICBmdW5jdGlvbiBnZXRWb3RpbmdQb3dlcih1aW50MjU2IF9wcm9wb3NhbElkLCBhZGRyZXNzIF92b3RlcikgcHVibGljIHZpZXcgcmV0dXJucyAoIHVpbnQyNTYgKTsKICAgIGZ1bmN0aW9uIHNldFZvdGVDb3VudFBlclByb2Nlc3ModWludDI1NiBfcGVyUHJvY2VzcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBQcm9jZXNzVm90ZVRvdGFscyh1aW50MjU2IF9wcm9wb3NhbElkLCB1aW50MjU2IGxlbmd0aCkgcHVibGljOwogICAgZnVuY3Rpb24gY2FuRW5kVm90aW5nKHVpbnQyNTYgX3Byb3Bvc2FsSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0UHJvcG9zYWxUeXBlKHVpbnQyNTYgX3Byb3Bvc2FsSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGV4cGlyeUNoYW5nZXNTdGF0ZSh1aW50MjU2IF9wcm9wb3NhbElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIG5lZWRzUHJvY2Vzc2luZyh1aW50MjU2IF9wcm9wb3NhbElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldE15Vm90ZUZvckN1cnJlbnRNaWxlc3RvbmVSZWxlYXNlKGFkZHJlc3MgX3ZvdGVyKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldEhhc1ZvdGVGb3JDdXJyZW50TWlsZXN0b25lUmVsZWFzZShhZGRyZXNzIF92b3RlcikgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRNeVZvdGUodWludDI1NiBfcHJvcG9zYWxJZCwgYWRkcmVzcyBfdm90ZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwoKfQoKLyoKCiAqIHNvdXJjZSAgICAgICBodHRwczovL2dpdGh1Yi5jb20vYmxvY2tiaXRzaW8vCgogKiBAbmFtZSAgICAgICAgRnVuZGluZyBDb250cmFjdCBBQkkKICogQHBhY2thZ2UgICAgIEJsb2NrQml0c0lPCiAqIEBhdXRob3IgICAgICBNaWNreSBTb2NhY2kgPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iNTAzZDM5MzMzYjI5MTAzZTNmMjczYzM5MjYzNTdlMjIzZiI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+CgogQ29udGFpbnMgdGhlIEZ1bmRpbmcgQ29udHJhY3QgY29kZSBkZXBsb3llZCBhbmQgbGlua2VkIHRvIHRoZSBBcHBsaWNhdGlvbiBFbnRpdHkKCgogICAgISEhIExpbmtzIGRpcmVjdGx5IHRvIE1pbGVzdG9uZXMKCiovCgoKCgoKY29udHJhY3QgQUJJRnVuZGluZyBpcyBBQklBcHBsaWNhdGlvbkFzc2V0IHsKCiAgICBhZGRyZXNzIHB1YmxpYyBtdWx0aVNpZ091dHB1dEFkZHJlc3M7CiAgICBhZGRyZXNzIHB1YmxpYyBEaXJlY3RJbnB1dDsKICAgIGFkZHJlc3MgcHVibGljIE1pbGVzdG9uZUlucHV0OwogICAgYWRkcmVzcyBwdWJsaWMgVG9rZW5NYW5hZ2VyRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgRnVuZGluZ01hbmFnZXJFbnRpdHk7CgogICAgc3RydWN0IEZ1bmRpbmdTdGFnZSB7CiAgICAgICAgYnl0ZXMzMiBuYW1lOwogICAgICAgIHVpbnQ4ICAgc3RhdGU7CiAgICAgICAgdWludDI1NiB0aW1lX3N0YXJ0OwogICAgICAgIHVpbnQyNTYgdGltZV9lbmQ7CiAgICAgICAgdWludDI1NiBhbW91bnRfY2FwX3NvZnQ7ICAgICAgICAgICAgLy8gMCA9IG5vdCBlbmZvcmNlZAogICAgICAgIHVpbnQyNTYgYW1vdW50X2NhcF9oYXJkOyAgICAgICAgICAgIC8vIDAgPSBub3QgZW5mb3JjZWQKICAgICAgICB1aW50MjU2IGFtb3VudF9yYWlzZWQ7ICAgICAgICAgICAgICAvLyAwID0gbm90IGVuZm9yY2VkCiAgICAgICAgLy8gZnVuZGluZyBtZXRob2Qgc2V0dGluZ3MKICAgICAgICB1aW50MjU2IG1pbmltdW1fZW50cnk7CiAgICAgICAgdWludDggICBtZXRob2RzOyAgICAgICAgICAgICAgICAgICAgLy8gRnVuZGluZ01ldGhvZElkcwogICAgICAgIC8vIHRva2VuIHNldHRpbmdzCiAgICAgICAgdWludDI1NiBmaXhlZF90b2tlbnM7CiAgICAgICAgdWludDggICBwcmljZV9hZGRpdGlvbl9wZXJjZW50YWdlOyAgLy8KICAgICAgICB1aW50OCAgIHRva2VuX3NoYXJlX3BlcmNlbnRhZ2U7CiAgICAgICAgdWludDggICBpbmRleDsKICAgIH0KCiAgICBtYXBwaW5nICh1aW50OCA9PiBGdW5kaW5nU3RhZ2UpIHB1YmxpYyBDb2xsZWN0aW9uOwogICAgdWludDggcHVibGljIEZ1bmRpbmdTdGFnZU51bTsKICAgIHVpbnQ4IHB1YmxpYyBjdXJyZW50RnVuZGluZ1N0YWdlOwogICAgdWludDI1NiBwdWJsaWMgQW1vdW50UmFpc2VkOwogICAgdWludDI1NiBwdWJsaWMgTWlsZXN0b25lQW1vdW50UmFpc2VkOwogICAgdWludDI1NiBwdWJsaWMgR2xvYmFsQW1vdW50Q2FwU29mdDsKICAgIHVpbnQyNTYgcHVibGljIEdsb2JhbEFtb3VudENhcEhhcmQ7CiAgICB1aW50OCBwdWJsaWMgVG9rZW5TZWxsUGVyY2VudGFnZTsKICAgIHVpbnQyNTYgcHVibGljIEZ1bmRpbmdfU2V0dGluZ19mdW5kaW5nX3RpbWVfc3RhcnQ7CiAgICB1aW50MjU2IHB1YmxpYyBGdW5kaW5nX1NldHRpbmdfZnVuZGluZ190aW1lX2VuZDsKICAgIHVpbnQyNTYgcHVibGljIEZ1bmRpbmdfU2V0dGluZ19jYXNoYmFja190aW1lX3N0YXJ0OwogICAgdWludDI1NiBwdWJsaWMgRnVuZGluZ19TZXR0aW5nX2Nhc2hiYWNrX3RpbWVfZW5kOwogICAgdWludDI1NiBwdWJsaWMgRnVuZGluZ19TZXR0aW5nX2Nhc2hiYWNrX2JlZm9yZV9zdGFydF93YWl0X2R1cmF0aW9uOwogICAgdWludDI1NiBwdWJsaWMgRnVuZGluZ19TZXR0aW5nX2Nhc2hiYWNrX2R1cmF0aW9uOwoKCiAgICBmdW5jdGlvbiBhZGRGdW5kaW5nU3RhZ2UoCiAgICAgICAgYnl0ZXMzMiBfbmFtZSwKICAgICAgICB1aW50MjU2IF90aW1lX3N0YXJ0LAogICAgICAgIHVpbnQyNTYgX3RpbWVfZW5kLAogICAgICAgIHVpbnQyNTYgX2Ftb3VudF9jYXBfc29mdCwKICAgICAgICB1aW50MjU2IF9hbW91bnRfY2FwX2hhcmQsICAgLy8gcmVxdWlyZWQgPiAwCiAgICAgICAgdWludDggICBfbWV0aG9kcywKICAgICAgICB1aW50MjU2IF9taW5pbXVtX2VudHJ5LAogICAgICAgIHVpbnQyNTYgX2ZpeGVkX3Rva2VucywKICAgICAgICB1aW50OCAgIF9wcmljZV9hZGRpdGlvbl9wZXJjZW50YWdlLAogICAgICAgIHVpbnQ4ICAgX3Rva2VuX3NoYXJlX3BlcmNlbnRhZ2UKICAgICkKICAgIHB1YmxpYzsKCiAgICBmdW5jdGlvbiBhZGRTZXR0aW5ncyhhZGRyZXNzIF9vdXRwdXRBZGRyZXNzLCB1aW50MjU2IHNvZnRfY2FwLCB1aW50MjU2IGhhcmRfY2FwLCB1aW50OCBzYWxlX3BlcmNlbnRhZ2UsIGFkZHJlc3MgX2RpcmVjdCwgYWRkcmVzcyBfbWlsZXN0b25lICkgcHVibGljOwogICAgZnVuY3Rpb24gZ2V0U3RhZ2VBbW91bnQodWludDggU3RhZ2VJZCkgcHVibGljIHZpZXcgcmV0dXJucyAoIHVpbnQyNTYgKTsKICAgIGZ1bmN0aW9uIGFsbG93ZWRQYXltZW50TWV0aG9kKHVpbnQ4IF9wYXltZW50X21ldGhvZCkgcHVibGljIHB1cmUgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiByZWNlaXZlUGF5bWVudChhZGRyZXNzIF9zZW5kZXIsIHVpbnQ4IF9wYXltZW50X21ldGhvZCkgcGF5YWJsZSBwdWJsaWMgcmV0dXJucyhib29sKTsKICAgIGZ1bmN0aW9uIGNhbkFjY2VwdFBheW1lbnQodWludDI1NiBfYW1vdW50KSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldFZhbHVlT3ZlckN1cnJlbnRDYXAodWludDI1NiBfYW1vdW50KSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGlzRnVuZGluZ1N0YWdlVXBkYXRlQWxsb3dlZCh1aW50OCBfbmV3X3N0YXRlICkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRSZWNvcmRTdGF0ZVJlcXVpcmVkQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGRvU3RhdGVDaGFuZ2VzKCkgcHVibGljOwogICAgZnVuY3Rpb24gaGFzUmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldFJlcXVpcmVkU3RhdGVDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgsIHVpbnQ4LCB1aW50OCk7Cgp9CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBNZWV0aW5ncyBDb250cmFjdCBBQkkKICogQHBhY2thZ2UgICAgIEJsb2NrQml0c0lPCiAqIEBhdXRob3IgICAgICBNaWNreSBTb2NhY2kgPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iMmY0MjQ2NGM0NDU2NmY0MTQwNTg0MzQ2NTk0YTAxNWQ0MCI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+CgogQ29udGFpbnMgdGhlIE1lZXRpbmdzIENvbnRyYWN0IGNvZGUgZGVwbG95ZWQgYW5kIGxpbmtlZCB0byB0aGUgQXBwbGljYXRpb24gRW50aXR5CgoqLwoKCgoKCmNvbnRyYWN0IEFCSU1lZXRpbmdzIGlzIEFCSUFwcGxpY2F0aW9uQXNzZXQgewogICAgc3RydWN0IFJlY29yZCB7CiAgICAgICAgYnl0ZXMzMiBoYXNoOwogICAgICAgIGJ5dGVzMzIgbmFtZTsKICAgICAgICB1aW50OCBzdGF0ZTsKICAgICAgICB1aW50MjU2IHRpbWVfc3RhcnQ7ICAgICAgICAgICAgICAgICAgICAgLy8gc3RhcnQgYXQgdW5peHRpbWVzdGFtcAogICAgICAgIHVpbnQyNTYgZHVyYXRpb247CiAgICAgICAgdWludDggaW5kZXg7CiAgICB9CiAgICBtYXBwaW5nICh1aW50OCA9PiBSZWNvcmQpIHB1YmxpYyBDb2xsZWN0aW9uOwp9CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBNaWxlc3RvbmVzIENvbnRyYWN0CiAqIEBwYWNrYWdlICAgICBCbG9ja0JpdHNJTwogKiBAYXV0aG9yICAgICAgTWlja3kgU29jYWNpIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjBmNjI2NjZjNjQ3NjRmNjE2MDc4NjM2Njc5NmEyMTdkNjAiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+PgoKIENvbnRhaW5zIHRoZSBNaWxlc3RvbmVzIENvbnRyYWN0IGNvZGUgZGVwbG95ZWQgYW5kIGxpbmtlZCB0byB0aGUgQXBwbGljYXRpb24gRW50aXR5CgoqLwoKCgoKCmNvbnRyYWN0IEFCSU1pbGVzdG9uZXMgaXMgQUJJQXBwbGljYXRpb25Bc3NldCB7CgogICAgc3RydWN0IFJlY29yZCB7CiAgICAgICAgYnl0ZXMzMiBuYW1lOwogICAgICAgIHN0cmluZyBkZXNjcmlwdGlvbjsgICAgICAgICAgICAgICAgICAgICAvLyB3aWxsIGNoYW5nZSB0byBoYXNoIHBvaW50ZXIgKCBleHRlcm5hbCBzdG9yYWdlICkKICAgICAgICB1aW50OCBzdGF0ZTsKICAgICAgICB1aW50MjU2IGR1cmF0aW9uOwogICAgICAgIHVpbnQyNTYgdGltZV9zdGFydDsgICAgICAgICAgICAgICAgICAgICAvLyBzdGFydCBhdCB1bml4dGltZXN0YW1wCiAgICAgICAgdWludDI1NiBsYXN0X3N0YXRlX2NoYW5nZV90aW1lOyAgICAgICAgIC8vIHRpbWUgb2YgbGFzdCBzdGF0ZSBjaGFuZ2UKICAgICAgICB1aW50MjU2IHRpbWVfZW5kOyAgICAgICAgICAgICAgICAgICAgICAgLy8gZXN0aW1hdGVkIGVuZCB0aW1lID4+IGNhbiBiZSBpbmNyZWFzZWQgYnkgcHJvcG9zYWwKICAgICAgICB1aW50MjU2IHRpbWVfZW5kZWQ7ICAgICAgICAgICAgICAgICAgICAgLy8gYWN0dWFsIGVuZCB0aW1lCiAgICAgICAgdWludDI1NiBtZWV0aW5nX3RpbWU7CiAgICAgICAgdWludDggZnVuZGluZ19wZXJjZW50YWdlOwogICAgICAgIHVpbnQ4IGluZGV4OwogICAgfQoKICAgIHVpbnQ4IHB1YmxpYyBjdXJyZW50UmVjb3JkOwogICAgdWludDI1NiBwdWJsaWMgTWlsZXN0b25lQ2FzaEJhY2tUaW1lID0gMDsKICAgIG1hcHBpbmcgKHVpbnQ4ID0+IFJlY29yZCkgcHVibGljIENvbGxlY3Rpb247CiAgICBtYXBwaW5nIChieXRlczMyID0+IGJvb2wpIHB1YmxpYyBNaWxlc3RvbmVQb3N0cG9uaW5nSGFzaDsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludDI1NikgcHVibGljIFByb3Bvc2FsSWRCeUhhc2g7CgogICAgZnVuY3Rpb24gZ2V0QnlsYXdzUHJvamVjdERldmVsb3BtZW50U3RhcnQoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGdldEJ5bGF3c01pblRpbWVJblRoZUZ1dHVyZUZvck1lZXRpbmdDcmVhdGlvbigpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gZ2V0QnlsYXdzQ2FzaEJhY2tWb3RlUmVqZWN0ZWREdXJhdGlvbigpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gYWRkUmVjb3JkKCBieXRlczMyIF9uYW1lLCBzdHJpbmcgX2Rlc2NyaXB0aW9uLCB1aW50MjU2IF9kdXJhdGlvbiwgdWludDggX3BlcmMgKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBnZXRNaWxlc3RvbmVGdW5kaW5nUGVyY2VudGFnZSh1aW50OCByZWNvcmRJZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gZG9TdGF0ZUNoYW5nZXMoKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBnZXRSZWNvcmRTdGF0ZVJlcXVpcmVkQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGhhc1JlcXVpcmVkU3RhdGVDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBhZnRlclZvdGVOb0Nhc2hCYWNrVGltZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKCBib29sICk7CiAgICBmdW5jdGlvbiBnZXRIYXNoKHVpbnQ4IGFjdGlvblR5cGUsIGJ5dGVzMzIgYXJnMSwgYnl0ZXMzMiBhcmcyKSBwdWJsaWMgcHVyZSByZXR1cm5zICggYnl0ZXMzMiApOwogICAgZnVuY3Rpb24gZ2V0Q3VycmVudEhhc2goKSBwdWJsaWMgdmlldyByZXR1cm5zICggYnl0ZXMzMiApOwogICAgZnVuY3Rpb24gZ2V0Q3VycmVudFByb3Bvc2FsSWQoKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKCB1aW50MjU2ICk7CiAgICBmdW5jdGlvbiBzZXRDdXJyZW50TWlsZXN0b25lTWVldGluZ1RpbWUodWludDI1NiBfbWVldGluZ190aW1lKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBpc1JlY29yZFVwZGF0ZUFsbG93ZWQodWludDggX25ld19zdGF0ZSApIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0UmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCwgdWludDgsIHVpbnQ4KTsKICAgIGZ1bmN0aW9uIEFwcGxpY2F0aW9uSXNJbkRldmVsb3BtZW50KCkgcHVibGljIHZpZXcgcmV0dXJucyhib29sKTsKICAgIGZ1bmN0aW9uIE1lZXRpbmdUaW1lU2V0RmFpbHVyZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwoKfQoKLyoKCiAqIHNvdXJjZSAgICAgICBodHRwczovL2dpdGh1Yi5jb20vYmxvY2tiaXRzaW8vCgogKiBAbmFtZSAgICAgICAgQm91bnR5IFByb2dyYW0gQ29udHJhY3QgQUJJCiAqIEBwYWNrYWdlICAgICBCbG9ja0JpdHNJTwogKiBAYXV0aG9yICAgICAgTWlja3kgU29jYWNpIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjJhNDc0MzQ5NDE1MzZhNDQ0NTVkNDY0MzVjNGYwNDU4NDUiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+PgoKICBCb3VudHkgcHJvZ3JhbSBjb250cmFjdCB0aGF0IGhvbGRzIGFuZCBkaXN0cmlidXRlcyB0b2tlbnMgdXBvbiBzdWNjZXNzZnVsIGZ1bmRpbmcuCgoqLwoKCgoKCmNvbnRyYWN0IEFCSUJvdW50eU1hbmFnZXIgaXMgQUJJQXBwbGljYXRpb25Bc3NldCB7CiAgICBmdW5jdGlvbiBzZW5kQm91bnR5KCBhZGRyZXNzIF9yZWNlaXZlciwgdWludDI1NiBfYW1vdW50ICkgcHVibGljOwp9CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBUb2tlbiBNYW5hZ2VyIENvbnRyYWN0CiAqIEBwYWNrYWdlICAgICBCbG9ja0JpdHNJTwogKiBAYXV0aG9yICAgICAgTWlja3kgU29jYWNpIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjhjZTFlNWVmZTdmNWNjZTJlM2ZiZTBlNWZhZTlhMmZlZTMiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+PgoKKi8KCgoKCgpjb250cmFjdCBBQklUb2tlbk1hbmFnZXIgaXMgQUJJQXBwbGljYXRpb25Bc3NldCB7CgogICAgYWRkcmVzcyBwdWJsaWMgVG9rZW5TQ0FEQUVudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIFRva2VuRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgTWFya2V0aW5nTWV0aG9kQWRkcmVzczsKICAgIGJvb2wgT3duZXJUb2tlbkJhbGFuY2VzUmVsZWFzZWQgPSBmYWxzZTsKCiAgICBmdW5jdGlvbiBhZGRTZXR0aW5ncyhhZGRyZXNzIF9zY2FkYUFkZHJlc3MsIGFkZHJlc3MgX3Rva2VuQWRkcmVzcywgYWRkcmVzcyBfbWFya2V0aW5nICkgcHVibGljOwogICAgZnVuY3Rpb24gZ2V0VG9rZW5TQ0FEQVJlcXVpcmVzSGFyZENhcCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBmaW5pc2hNaW50aW5nKCkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gbWludEZvck1hcmtldGluZ1Bvb2woYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBSZWxlYXNlT3duZXJzTG9ja2VkVG9rZW5zKGFkZHJlc3MgX211bHRpU2lnT3V0cHV0QWRkcmVzcykgcHVibGljIHJldHVybnMgKGJvb2wpOwoKfQoKLyoKCiAqIHNvdXJjZSAgICAgICBodHRwczovL2dpdGh1Yi5jb20vYmxvY2tiaXRzaW8vCgogKiBAbmFtZSAgICAgICAgRnVuZGluZyBDb250cmFjdCBBQkkKICogQHBhY2thZ2UgICAgIEJsb2NrQml0c0lPCiAqIEBhdXRob3IgICAgICBNaWNreSBTb2NhY2kgPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iMGU2MzY3NmQ2NTc3NGU2MDYxNzk2MjY3Nzg2YjIwN2M2MSI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+CgogQ29udGFpbnMgdGhlIEZ1bmRpbmcgQ29udHJhY3QgY29kZSBkZXBsb3llZCBhbmQgbGlua2VkIHRvIHRoZSBBcHBsaWNhdGlvbiBFbnRpdHkKCiovCgoKCgoKY29udHJhY3QgQUJJRnVuZGluZ01hbmFnZXIgaXMgQUJJQXBwbGljYXRpb25Bc3NldCB7CgogICAgYm9vbCBwdWJsaWMgZnVuZGluZ1Byb2Nlc3NlZDsKICAgIGJvb2wgRnVuZGluZ1Bvb2xCYWxhbmNlc0FsbG9jYXRlZDsKICAgIHVpbnQ4IHB1YmxpYyBWYXVsdENvdW50UGVyUHJvY2VzczsKICAgIHVpbnQyNTYgcHVibGljIGxhc3RQcm9jZXNzZWRWYXVsdElkOwogICAgdWludDI1NiBwdWJsaWMgdmF1bHROdW07CiAgICB1aW50MjU2IHB1YmxpYyBMb2NrZWRWb3RpbmdUb2tlbnM7CiAgICBieXRlczMyIHB1YmxpYyBjdXJyZW50VGFzazsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gYm9vbCkgcHVibGljIHRhc2tCeUhhc2g7CiAgICBtYXBwaW5nICAoYWRkcmVzcyA9PiBhZGRyZXNzKSBwdWJsaWMgdmF1bHRMaXN0OwogICAgbWFwcGluZyAgKHVpbnQyNTYgPT4gYWRkcmVzcykgcHVibGljIHZhdWx0QnlJZDsKCiAgICBmdW5jdGlvbiByZWNlaXZlUGF5bWVudChhZGRyZXNzIF9zZW5kZXIsIHVpbnQ4IF9wYXltZW50X21ldGhvZCwgdWludDggX2Z1bmRpbmdfc3RhZ2UpIHBheWFibGUgcHVibGljIHJldHVybnMoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRNeVZhdWx0QWRkcmVzcyhhZGRyZXNzIF9zZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3MpOwogICAgZnVuY3Rpb24gc2V0VmF1bHRDb3VudFBlclByb2Nlc3ModWludDggX3BlclByb2Nlc3MpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gZ2V0SGFzaChieXRlczMyIGFjdGlvblR5cGUsIGJ5dGVzMzIgYXJnMSkgcHVibGljIHB1cmUgcmV0dXJucyAoIGJ5dGVzMzIgKTsKICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRNaWxlc3RvbmVQcm9jZXNzZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIHByb2Nlc3NGdW5kaW5nRmFpbGVkRmluaXNoZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIHByb2Nlc3NGdW5kaW5nU3VjY2Vzc2Z1bEZpbmlzaGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRDdXJyZW50TWlsZXN0b25lSWRIYXNoKCkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChieXRlczMyKTsKICAgIGZ1bmN0aW9uIHByb2Nlc3NNaWxlc3RvbmVGaW5pc2hlZCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gcHJvY2Vzc0VtZXJnZW5jeUZ1bmRSZWxlYXNlRmluaXNoZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldEFmdGVyVHJhbnNmZXJMb2NrZWRUb2tlbkJhbGFuY2VzKGFkZHJlc3MgdmF1bHRBZGRyZXNzLCBib29sIGV4Y2x1ZGVDdXJyZW50KSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIFZhdWx0UmVxdWVzdGVkVXBkYXRlRm9yTG9ja2VkVm90aW5nVG9rZW5zKGFkZHJlc3Mgb3duZXIpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGRvU3RhdGVDaGFuZ2VzKCkgcHVibGljOwogICAgZnVuY3Rpb24gaGFzUmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldFJlcXVpcmVkU3RhdGVDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgsIHVpbnQ4KTsKICAgIGZ1bmN0aW9uIEFwcGxpY2F0aW9uSW5GdW5kaW5nT3JEZXZlbG9wbWVudCgpIHB1YmxpYyB2aWV3IHJldHVybnMoYm9vbCk7Cgp9CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBMaXN0aW5nIENvbnRyYWN0IEFCSQogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PHNwYW4gY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSI5ZGYwZjRmZWY2ZTRkZGYzZjJlYWYxZjRlYmY4YjNlZmYyIj5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4KCiovCgoKCgoKY29udHJhY3QgQUJJTGlzdGluZ0NvbnRyYWN0IGlzIEFCSUFwcGxpY2F0aW9uQXNzZXQgewoKICAgIGFkZHJlc3MgcHVibGljIG1hbmFnZXJBZGRyZXNzOwogICAgLy8gY2hpbGQgaXRlbXMKICAgIHN0cnVjdCBpdGVtIHsKICAgICAgICBieXRlczMyIG5hbWU7CiAgICAgICAgYWRkcmVzcyBpdGVtQWRkcmVzczsKICAgICAgICBib29sICAgIHN0YXR1czsKICAgICAgICB1aW50MjU2IGluZGV4OwogICAgfQoKICAgIG1hcHBpbmcgKCB1aW50MjU2ID0+IGl0ZW0gKSBwdWJsaWMgaXRlbXM7CiAgICB1aW50MjU2IHB1YmxpYyBpdGVtTnVtOwoKICAgIGZ1bmN0aW9uIHNldE1hbmFnZXJBZGRyZXNzKGFkZHJlc3MgX21hbmFnZXIpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGFkZEl0ZW0oYnl0ZXMzMiBfbmFtZSwgYWRkcmVzcyBfYWRkcmVzcykgcHVibGljOwogICAgZnVuY3Rpb24gZ2V0TmV3c0NvbnRyYWN0QWRkcmVzcyh1aW50MjU2IF9jaGlsZElkKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGFkZHJlc3MpOwogICAgZnVuY3Rpb24gY2FuQmVEZWxpc3RlZCh1aW50MjU2IF9jaGlsZElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldENoaWxkU3RhdHVzKCB1aW50MjU2IF9jaGlsZElkICkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBkZWxpc3RDaGlsZCggdWludDI1NiBfY2hpbGRJZCApIHB1YmxpYzsKCn0KCi8qCgogKiBzb3VyY2UgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL2Jsb2NrYml0c2lvLwoKICogQG5hbWUgICAgICAgIE5ld3MgQ29udHJhY3QgQUJJCiAqIEBwYWNrYWdlICAgICBCbG9ja0JpdHNJTwogKiBAYXV0aG9yICAgICAgTWlja3kgU29jYWNpIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjkzZmVmYWYwZjhlYWQzZmRmY2U0ZmZmYWU1ZjZiZGUxZmMiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+PgoKKi8KCgoKCgpjb250cmFjdCBBQklOZXdzQ29udHJhY3QgaXMgQUJJQXBwbGljYXRpb25Bc3NldCB7CgogICAgc3RydWN0IGl0ZW0gewogICAgICAgIHN0cmluZyBoYXNoOwogICAgICAgIHVpbnQ4IGl0ZW1UeXBlOwogICAgICAgIHVpbnQyNTYgbGVuZ3RoOwogICAgfQoKICAgIHVpbnQyNTYgcHVibGljIGl0ZW1OdW0gPSAwOwogICAgbWFwcGluZyAoIHVpbnQyNTYgPT4gaXRlbSApIHB1YmxpYyBpdGVtczsKCiAgICBmdW5jdGlvbiBhZGRJbnRlcm5hbE1lc3NhZ2UodWludDggc3RhdGUpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGFkZEl0ZW0oc3RyaW5nIF9oYXNoLCB1aW50MjU2IF9sZW5ndGgpIHB1YmxpYzsKfQoKLyoKCiAqIHNvdXJjZSAgICAgICBodHRwczovL2dpdGh1Yi5jb20vYmxvY2tiaXRzaW8vCgogKiBAbmFtZSAgICAgICAgQXBwbGljYXRpb24gRW50aXR5IENvbnRyYWN0CiAqIEBwYWNrYWdlICAgICBCbG9ja0JpdHNJTwogKiBAYXV0aG9yICAgICAgTWlja3kgU29jYWNpIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjJmNDI0NjRjNDQ1NjZmNDE0MDU4NDM0NjU5NGEwMTVkNDAiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+PgoKIENvbnRhaW5zIHRoZSBtYWluIGNvbXBhbnkgRW50aXR5IENvbnRyYWN0IGNvZGUgZGVwbG95ZWQgYW5kIGxpbmtlZCB0byB0aGUgR2F0ZXdheSBJbnRlcmZhY2UuCgoqLwoKCgoKCgoKCgoKCgoKCmNvbnRyYWN0IEFwcGxpY2F0aW9uRW50aXR5IHsKCiAgICAvKiBTb3VyY2UgQ29kZSBVcmwgKi8KICAgIGJ5dGVzMzIgc291cmNlQ29kZVVybDsKCiAgICAvKiBFbnRpdHkgaW5pdGlhbGlzZWQgb3Igbm90ICovCiAgICBib29sIHB1YmxpYyBfaW5pdGlhbGl6ZWQgPSBmYWxzZTsKCiAgICAvKiBFbnRpdHkgbG9ja2VkIG9yIG5vdCAqLwogICAgYm9vbCBwdWJsaWMgX2xvY2tlZCA9IGZhbHNlOwoKICAgIC8qIEN1cnJlbnQgRW50aXR5IFN0YXRlICovCiAgICB1aW50OCBwdWJsaWMgQ3VycmVudEVudGl0eVN0YXRlOwoKICAgIC8qIEF2YWlsYWJsZSBFbnRpdHkgU3RhdGUgKi8KICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludDgpIHB1YmxpYyBFbnRpdHlTdGF0ZXM7CgogICAgLyogR2F0ZXdheUludGVyZmFjZSBhZGRyZXNzICovCiAgICBhZGRyZXNzIHB1YmxpYyBHYXRld2F5SW50ZXJmYWNlQWRkcmVzczsKCiAgICAvKiBQYXJlbnQgRW50aXR5IEluc3RhbmNlICovCiAgICBBQklHYXRld2F5SW50ZXJmYWNlIEdhdGV3YXlJbnRlcmZhY2VFbnRpdHk7CgogICAgLyogQXNzZXQgRW50aXRpZXMgKi8KICAgIEFCSVByb3Bvc2FscyBwdWJsaWMgUHJvcG9zYWxzRW50aXR5OwogICAgQUJJRnVuZGluZyBwdWJsaWMgRnVuZGluZ0VudGl0eTsKICAgIEFCSU1pbGVzdG9uZXMgcHVibGljIE1pbGVzdG9uZXNFbnRpdHk7CiAgICBBQklNZWV0aW5ncyBwdWJsaWMgTWVldGluZ3NFbnRpdHk7CiAgICBBQklCb3VudHlNYW5hZ2VyIHB1YmxpYyBCb3VudHlNYW5hZ2VyRW50aXR5OwogICAgQUJJVG9rZW5NYW5hZ2VyIHB1YmxpYyBUb2tlbk1hbmFnZXJFbnRpdHk7CiAgICBBQklMaXN0aW5nQ29udHJhY3QgcHVibGljIExpc3RpbmdDb250cmFjdEVudGl0eTsKICAgIEFCSUZ1bmRpbmdNYW5hZ2VyIHB1YmxpYyBGdW5kaW5nTWFuYWdlckVudGl0eTsKICAgIEFCSU5ld3NDb250cmFjdCBwdWJsaWMgTmV3c0NvbnRyYWN0RW50aXR5OwoKICAgIC8qIEFzc2V0IENvbGxlY3Rpb24gKi8KICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gYWRkcmVzcykgcHVibGljIEFzc2V0Q29sbGVjdGlvbjsKICAgIG1hcHBpbmcgKHVpbnQ4ID0+IGJ5dGVzMzIpIHB1YmxpYyBBc3NldENvbGxlY3Rpb25JZFRvTmFtZTsKICAgIHVpbnQ4IHB1YmxpYyBBc3NldENvbGxlY3Rpb25OdW0gPSAwOwoKICAgIGV2ZW50IEV2ZW50QXBwRW50aXR5UmVhZHkgKCBhZGRyZXNzIGluZGV4ZWQgX2FkZHJlc3MgKTsKICAgIGV2ZW50IEV2ZW50QXBwRW50aXR5Q29kZVVwZ3JhZGVQcm9wb3NhbCAoIGFkZHJlc3MgaW5kZXhlZCBfYWRkcmVzcywgYnl0ZXMzMiBpbmRleGVkIF9zb3VyY2VDb2RlVXJsICk7CiAgICBldmVudCBFdmVudEFwcEVudGl0eUluaXRBc3NldCAoIGJ5dGVzMzIgaW5kZXhlZCBfbmFtZSwgYWRkcmVzcyBpbmRleGVkIF9hZGRyZXNzICk7CiAgICBldmVudCBFdmVudEFwcEVudGl0eUluaXRBc3NldHNUb1RoaXMgKCB1aW50OCBpbmRleGVkIF9hc3NldE51bSApOwogICAgZXZlbnQgRXZlbnRBcHBFbnRpdHlBc3NldHNUb05ld0FwcGxpY2F0aW9uICggYWRkcmVzcyBpbmRleGVkIF9hZGRyZXNzICk7CiAgICBldmVudCBFdmVudEFwcEVudGl0eUxvY2tlZCAoIGFkZHJlc3MgaW5kZXhlZCBfYWRkcmVzcyApOwoKICAgIGFkZHJlc3MgcHVibGljIGRlcGxveWVyQWRkcmVzczsKCiAgICBmdW5jdGlvbiBBcHBsaWNhdGlvbkVudGl0eSgpIHB1YmxpYyB7CiAgICAgICAgZGVwbG95ZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICBzZXRFbnRpdHlTdGF0ZXMoKTsKICAgICAgICBDdXJyZW50RW50aXR5U3RhdGUgPSBnZXRFbnRpdHlTdGF0ZSgiTkVXIik7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0RW50aXR5U3RhdGVzKCkgaW50ZXJuYWwgewoKICAgICAgICAvLyBBcHBsaWNhdGlvbkVudGl0eSBTdGF0ZXMKICAgICAgICBFbnRpdHlTdGF0ZXNbIl9fSUdOT1JFRF9fIl0gICAgICAgICAgICAgICAgID0gMDsKICAgICAgICBFbnRpdHlTdGF0ZXNbIk5FVyJdICAgICAgICAgICAgICAgICAgICAgICAgID0gMTsKICAgICAgICBFbnRpdHlTdGF0ZXNbIldBSVRJTkciXSAgICAgICAgICAgICAgICAgICAgID0gMjsKCiAgICAgICAgRW50aXR5U3RhdGVzWyJJTl9GVU5ESU5HIl0gICAgICAgICAgICAgICAgICA9IDM7CgogICAgICAgIEVudGl0eVN0YXRlc1siSU5fREVWRUxPUE1FTlQiXSAgICAgICAgICAgICAgPSA1OwogICAgICAgIEVudGl0eVN0YXRlc1siSU5fQ09ERV9VUEdSQURFIl0gICAgICAgICAgICAgPSA1MDsKCiAgICAgICAgRW50aXR5U3RhdGVzWyJVUEdSQURFRCJdICAgICAgICAgICAgICAgICAgICA9IDEwMDsKCiAgICAgICAgRW50aXR5U3RhdGVzWyJJTl9HTE9CQUxfQ0FTSEJBQ0siXSAgICAgICAgICA9IDE1MDsKICAgICAgICBFbnRpdHlTdGF0ZXNbIkxPQ0tFRCJdICAgICAgICAgICAgICAgICAgICAgID0gMjAwOwoKICAgICAgICBFbnRpdHlTdGF0ZXNbIkRFVkVMT1BNRU5UX0NPTVBMRVRFIl0gICAgICAgID0gMjUwOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEVudGl0eVN0YXRlKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gRW50aXR5U3RhdGVzW25hbWVdOwogICAgfQoKICAgIC8qCiAgICAqIEluaXRpYWxpemUgQXBwbGljYXRpb24gYW5kIGl0J3MgYXNzZXRzCiAgICAqIElmIGdhdGV3YXkgaXMgZnJlc2hseSBkZXBsb3llZCwganVzdCBsaW5rCiAgICAqIGVsc2UsIGNyZWF0ZSBhIHZvdGluZyBwcm9wb3NhbCB0aGF0IG5lZWRzIHRvIGJlIGFjY2VwdGVkIGZvciB0aGUgbGlua2luZwogICAgKgogICAgKiBAcGFyYW0gICAgICAgIGFkZHJlc3MgX25ld0FkZHJlc3MKICAgICogQHBhcmFtICAgICAgICBieXRlczMyIF9zb3VyY2VDb2RlVXJsCiAgICAqCiAgICAqIEBtb2RpZmllcnMgICAgcmVxdWlyZU5vUGFyZW50LCByZXF1aXJlTm90SW5pdGlhbGlzZWQKICAgICovCiAgICBmdW5jdGlvbiBsaW5rVG9HYXRld2F5KAogICAgICAgIGFkZHJlc3MgX0dhdGV3YXlJbnRlcmZhY2VBZGRyZXNzLAogICAgICAgIGJ5dGVzMzIgX3NvdXJjZUNvZGVVcmwKICAgICkKICAgICAgICBleHRlcm5hbAogICAgICAgIHJlcXVpcmVOb1BhcmVudAogICAgICAgIHJlcXVpcmVOb3RJbml0aWFsaXNlZAogICAgICAgIG9ubHlEZXBsb3llcgogICAgewogICAgICAgIEdhdGV3YXlJbnRlcmZhY2VBZGRyZXNzID0gX0dhdGV3YXlJbnRlcmZhY2VBZGRyZXNzOwogICAgICAgIHNvdXJjZUNvZGVVcmwgPSBfc291cmNlQ29kZVVybDsKCiAgICAgICAgLy8gaW5pdCBnYXRld2F5IGVudGl0eSBhbmQgc2V0IGFwcCBhZGRyZXNzCiAgICAgICAgR2F0ZXdheUludGVyZmFjZUVudGl0eSA9IEFCSUdhdGV3YXlJbnRlcmZhY2UoR2F0ZXdheUludGVyZmFjZUFkZHJlc3MpOwogICAgICAgIEdhdGV3YXlJbnRlcmZhY2VFbnRpdHkucmVxdWVzdENvZGVVcGdyYWRlKCBhZGRyZXNzKHRoaXMpLCBzb3VyY2VDb2RlVXJsICk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0VXBncmFkZVN0YXRlKHVpbnQ4IHN0YXRlKSBwdWJsaWMgb25seUdhdGV3YXlJbnRlcmZhY2UgewogICAgICAgIEN1cnJlbnRFbnRpdHlTdGF0ZSA9IHN0YXRlOwogICAgfQoKICAgIC8qCiAgICAgICAgRm9yIHRoZSBzYWtlIG9mIHNpbXBsaWNpdHksIGFuZCBzb2xpZGl0eSB3YXJuaW5ncyBhYm91dCAidW5rbm93biBnYXMgdXNhZ2UiIGRvIHRoaXMuLiBpbnN0ZWFkIG9mIHNlbmRpbmcKICAgICAgICBhbiBhcnJheSBvZiBhZGRyZXNzZXMKICAgICovCiAgICBmdW5jdGlvbiBhZGRBc3NldFByb3Bvc2FscyhhZGRyZXNzIF9hc3NldEFkZHJlc3NlcykgZXh0ZXJuYWwgcmVxdWlyZU5vdEluaXRpYWxpc2VkIG9ubHlEZXBsb3llciB7CiAgICAgICAgUHJvcG9zYWxzRW50aXR5ID0gQUJJUHJvcG9zYWxzKF9hc3NldEFkZHJlc3Nlcyk7CiAgICAgICAgYXNzZXRJbml0aWFsaXplZCgiUHJvcG9zYWxzIiwgX2Fzc2V0QWRkcmVzc2VzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRBc3NldEZ1bmRpbmcoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsIHJlcXVpcmVOb3RJbml0aWFsaXNlZCBvbmx5RGVwbG95ZXIgewogICAgICAgIEZ1bmRpbmdFbnRpdHkgPSBBQklGdW5kaW5nKF9hc3NldEFkZHJlc3Nlcyk7CiAgICAgICAgYXNzZXRJbml0aWFsaXplZCgiRnVuZGluZyIsIF9hc3NldEFkZHJlc3Nlcyk7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkQXNzZXRNaWxlc3RvbmVzKGFkZHJlc3MgX2Fzc2V0QWRkcmVzc2VzKSBleHRlcm5hbCByZXF1aXJlTm90SW5pdGlhbGlzZWQgb25seURlcGxveWVyIHsKICAgICAgICBNaWxlc3RvbmVzRW50aXR5ID0gQUJJTWlsZXN0b25lcyhfYXNzZXRBZGRyZXNzZXMpOwogICAgICAgIGFzc2V0SW5pdGlhbGl6ZWQoIk1pbGVzdG9uZXMiLCBfYXNzZXRBZGRyZXNzZXMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZEFzc2V0TWVldGluZ3MoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsIHJlcXVpcmVOb3RJbml0aWFsaXNlZCBvbmx5RGVwbG95ZXIgewogICAgICAgIE1lZXRpbmdzRW50aXR5ID0gQUJJTWVldGluZ3MoX2Fzc2V0QWRkcmVzc2VzKTsKICAgICAgICBhc3NldEluaXRpYWxpemVkKCJNZWV0aW5ncyIsIF9hc3NldEFkZHJlc3Nlcyk7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkQXNzZXRCb3VudHlNYW5hZ2VyKGFkZHJlc3MgX2Fzc2V0QWRkcmVzc2VzKSBleHRlcm5hbCByZXF1aXJlTm90SW5pdGlhbGlzZWQgb25seURlcGxveWVyIHsKICAgICAgICBCb3VudHlNYW5hZ2VyRW50aXR5ID0gQUJJQm91bnR5TWFuYWdlcihfYXNzZXRBZGRyZXNzZXMpOwogICAgICAgIGFzc2V0SW5pdGlhbGl6ZWQoIkJvdW50eU1hbmFnZXIiLCBfYXNzZXRBZGRyZXNzZXMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZEFzc2V0VG9rZW5NYW5hZ2VyKGFkZHJlc3MgX2Fzc2V0QWRkcmVzc2VzKSBleHRlcm5hbCByZXF1aXJlTm90SW5pdGlhbGlzZWQgb25seURlcGxveWVyIHsKICAgICAgICBUb2tlbk1hbmFnZXJFbnRpdHkgPSBBQklUb2tlbk1hbmFnZXIoX2Fzc2V0QWRkcmVzc2VzKTsKICAgICAgICBhc3NldEluaXRpYWxpemVkKCJUb2tlbk1hbmFnZXIiLCBfYXNzZXRBZGRyZXNzZXMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZEFzc2V0RnVuZGluZ01hbmFnZXIoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsIHJlcXVpcmVOb3RJbml0aWFsaXNlZCBvbmx5RGVwbG95ZXIgewogICAgICAgIEZ1bmRpbmdNYW5hZ2VyRW50aXR5ID0gQUJJRnVuZGluZ01hbmFnZXIoX2Fzc2V0QWRkcmVzc2VzKTsKICAgICAgICBhc3NldEluaXRpYWxpemVkKCJGdW5kaW5nTWFuYWdlciIsIF9hc3NldEFkZHJlc3Nlcyk7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkQXNzZXRMaXN0aW5nQ29udHJhY3QoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsIHJlcXVpcmVOb3RJbml0aWFsaXNlZCBvbmx5RGVwbG95ZXIgewogICAgICAgIExpc3RpbmdDb250cmFjdEVudGl0eSA9IEFCSUxpc3RpbmdDb250cmFjdChfYXNzZXRBZGRyZXNzZXMpOwogICAgICAgIGFzc2V0SW5pdGlhbGl6ZWQoIkxpc3RpbmdDb250cmFjdCIsIF9hc3NldEFkZHJlc3Nlcyk7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkQXNzZXROZXdzQ29udHJhY3QoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsIHJlcXVpcmVOb3RJbml0aWFsaXNlZCBvbmx5RGVwbG95ZXIgewogICAgICAgIE5ld3NDb250cmFjdEVudGl0eSA9IEFCSU5ld3NDb250cmFjdChfYXNzZXRBZGRyZXNzZXMpOwogICAgICAgIGFzc2V0SW5pdGlhbGl6ZWQoIk5ld3NDb250cmFjdCIsIF9hc3NldEFkZHJlc3Nlcyk7CiAgICB9CgogICAgZnVuY3Rpb24gYXNzZXRJbml0aWFsaXplZChieXRlczMyIG5hbWUsIGFkZHJlc3MgX2Fzc2V0QWRkcmVzc2VzKSBpbnRlcm5hbCB7CiAgICAgICAgaWYoQXNzZXRDb2xsZWN0aW9uW25hbWVdID09IDB4MCkgewogICAgICAgICAgICBBc3NldENvbGxlY3Rpb25JZFRvTmFtZVtBc3NldENvbGxlY3Rpb25OdW1dID0gbmFtZTsKICAgICAgICAgICAgQXNzZXRDb2xsZWN0aW9uW25hbWVdID0gX2Fzc2V0QWRkcmVzc2VzOwogICAgICAgICAgICBBc3NldENvbGxlY3Rpb25OdW0rKzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBqdXN0IHJlcGxhY2UKICAgICAgICAgICAgQXNzZXRDb2xsZWN0aW9uW25hbWVdID0gX2Fzc2V0QWRkcmVzc2VzOwogICAgICAgIH0KICAgICAgICBFdmVudEFwcEVudGl0eUluaXRBc3NldChuYW1lLCBfYXNzZXRBZGRyZXNzZXMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEFzc2V0QWRkcmVzc0J5TmFtZShieXRlczMyIF9uYW1lKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICAgICAgcmV0dXJuIEFzc2V0Q29sbGVjdGlvbltfbmFtZV07CiAgICB9CgogICAgLyogQXBwbGljYXRpb24gQnlsYXdzIG1hcHBpbmcgKi8KICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludDI1NikgcHVibGljIEJ5bGF3c1VpbnQyNTY7CiAgICBtYXBwaW5nIChieXRlczMyID0+IGJ5dGVzMzIpIHB1YmxpYyBCeWxhd3NCeXRlczMyOwoKCiAgICBmdW5jdGlvbiBzZXRCeWxhd1VpbnQyNTYoYnl0ZXMzMiBuYW1lLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmVxdWlyZU5vdEluaXRpYWxpc2VkIG9ubHlEZXBsb3llciB7CiAgICAgICAgQnlsYXdzVWludDI1NltuYW1lXSA9IHZhbHVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEJ5bGF3VWludDI1NihieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJlcXVpcmVJbml0aWFsaXNlZCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIEJ5bGF3c1VpbnQyNTZbbmFtZV07CiAgICB9CgogICAgZnVuY3Rpb24gc2V0QnlsYXdCeXRlczMyKGJ5dGVzMzIgbmFtZSwgYnl0ZXMzMiB2YWx1ZSkgcHVibGljIHJlcXVpcmVOb3RJbml0aWFsaXNlZCBvbmx5RGVwbG95ZXIgewogICAgICAgIEJ5bGF3c0J5dGVzMzJbbmFtZV0gPSB2YWx1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRCeWxhd0J5dGVzMzIoYnl0ZXMzMiBuYW1lKSBwdWJsaWMgdmlldyByZXF1aXJlSW5pdGlhbGlzZWQgcmV0dXJucyAoYnl0ZXMzMikgewogICAgICAgIHJldHVybiBCeWxhd3NCeXRlczMyW25hbWVdOwogICAgfQoKICAgIGZ1bmN0aW9uIGluaXRpYWxpemUoKSBleHRlcm5hbCByZXF1aXJlTm90SW5pdGlhbGlzZWQgb25seUdhdGV3YXlJbnRlcmZhY2UgcmV0dXJucyAoYm9vbCkgewogICAgICAgIF9pbml0aWFsaXplZCA9IHRydWU7CiAgICAgICAgRXZlbnRBcHBFbnRpdHlSZWFkeSggYWRkcmVzcyh0aGlzKSApOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFBhcmVudEFkZHJlc3MoKSBleHRlcm5hbCB2aWV3IHJldHVybnMoYWRkcmVzcykgewogICAgICAgIHJldHVybiBHYXRld2F5SW50ZXJmYWNlQWRkcmVzczsKICAgIH0KCiAgICBmdW5jdGlvbiBjcmVhdGVDb2RlVXBncmFkZVByb3Bvc2FsKAogICAgICAgIGFkZHJlc3MgX25ld0FkZHJlc3MsCiAgICAgICAgYnl0ZXMzMiBfc291cmNlQ29kZVVybAogICAgKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgcmVxdWlyZUluaXRpYWxpc2VkCiAgICAgICAgb25seUdhdGV3YXlJbnRlcmZhY2UKICAgICAgICByZXR1cm5zICh1aW50MjU2KQogICAgewogICAgICAgIC8vIHByb3Bvc2FscyBjcmVhdGUgbmV3Li4gY29kZSB1cGdyYWRlIHByb3Bvc2FsCiAgICAgICAgRXZlbnRBcHBFbnRpdHlDb2RlVXBncmFkZVByb3Bvc2FsICggX25ld0FkZHJlc3MsIF9zb3VyY2VDb2RlVXJsICk7CgogICAgICAgIC8vIHJldHVybiB0cnVlOwogICAgICAgIHJldHVybiBQcm9wb3NhbHNFbnRpdHkuYWRkQ29kZVVwZ3JhZGVQcm9wb3NhbChfbmV3QWRkcmVzcywgX3NvdXJjZUNvZGVVcmwpOwogICAgfQoKICAgIC8qCiAgICAqIE9ubHkgYSBwcm9wb3NhbCBjYW4gdXBkYXRlIHRoZSBBcHBsaWNhdGlvbkVudGl0eSBDb250cmFjdCBhZGRyZXNzCiAgICAqCiAgICAqIEBwYXJhbSAgICAgICAgYWRkcmVzcyBfbmV3QWRkcmVzcwogICAgKiBAbW9kaWZpZXJzICAgIG9ubHlQcm9wb3NhbHNBc3NldAogICAgKi8KICAgIGZ1bmN0aW9uIGFjY2VwdENvZGVVcGdyYWRlUHJvcG9zYWwoYWRkcmVzcyBfbmV3QWRkcmVzcykgZXh0ZXJuYWwgb25seVByb3Bvc2Fsc0Fzc2V0ICB7CiAgICAgICAgR2F0ZXdheUludGVyZmFjZUVudGl0eS5hcHByb3ZlQ29kZVVwZ3JhZGUoIF9uZXdBZGRyZXNzICk7CiAgICB9CgogICAgZnVuY3Rpb24gaW5pdGlhbGl6ZUFzc2V0c1RvVGhpc0FwcGxpY2F0aW9uKCkgZXh0ZXJuYWwgb25seUdhdGV3YXlJbnRlcmZhY2UgcmV0dXJucyAoYm9vbCkgewoKICAgICAgICBmb3IodWludDggaSA9IDA7IGkgPCBBc3NldENvbGxlY3Rpb25OdW07IGkrKyApIHsKICAgICAgICAgICAgYnl0ZXMzMiBfbmFtZSA9IEFzc2V0Q29sbGVjdGlvbklkVG9OYW1lW2ldOwogICAgICAgICAgICBhZGRyZXNzIGN1cnJlbnQgPSBBc3NldENvbGxlY3Rpb25bX25hbWVdOwogICAgICAgICAgICBpZihjdXJyZW50ICE9IGFkZHJlc3MoMHgwKSkgewogICAgICAgICAgICAgICAgaWYoIWN1cnJlbnQuY2FsbChieXRlczQoa2VjY2FrMjU2KCJzZXRJbml0aWFsT3duZXJBbmROYW1lKGJ5dGVzMzIpIikpLCBfbmFtZSkgKSB7CiAgICAgICAgICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBFdmVudEFwcEVudGl0eUluaXRBc3NldHNUb1RoaXMoIEFzc2V0Q29sbGVjdGlvbk51bSApOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckFzc2V0c1RvTmV3QXBwbGljYXRpb24oYWRkcmVzcyBfbmV3QWRkcmVzcykgZXh0ZXJuYWwgb25seUdhdGV3YXlJbnRlcmZhY2UgcmV0dXJucyAoYm9vbCl7CiAgICAgICAgZm9yKHVpbnQ4IGkgPSAwOyBpIDwgQXNzZXRDb2xsZWN0aW9uTnVtOyBpKysgKSB7CiAgICAgICAgICAgIAogICAgICAgICAgICBieXRlczMyIF9uYW1lID0gQXNzZXRDb2xsZWN0aW9uSWRUb05hbWVbaV07CiAgICAgICAgICAgIGFkZHJlc3MgY3VycmVudCA9IEFzc2V0Q29sbGVjdGlvbltfbmFtZV07CiAgICAgICAgICAgIGlmKGN1cnJlbnQgIT0gYWRkcmVzcygweDApKSB7CiAgICAgICAgICAgICAgICBpZighY3VycmVudC5jYWxsKGJ5dGVzNChrZWNjYWsyNTYoInRyYW5zZmVyVG9OZXdPd25lcihhZGRyZXNzKSIpKSwgX25ld0FkZHJlc3MpICkgewogICAgICAgICAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgRXZlbnRBcHBFbnRpdHlBc3NldHNUb05ld0FwcGxpY2F0aW9uICggX25ld0FkZHJlc3MgKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKgogICAgKiBPbmx5IHRoZSBnYXRld2F5IGludGVyZmFjZSBjYW4gbG9jayBjdXJyZW50IGFwcCBhZnRlciBhIHN1Y2Nlc3NmdWwgY29kZSB1cGdyYWRlIHByb3Bvc2FsCiAgICAqCiAgICAqIEBtb2RpZmllcnMgICAgb25seUdhdGV3YXlJbnRlcmZhY2UKICAgICovCiAgICBmdW5jdGlvbiBsb2NrKCkgZXh0ZXJuYWwgb25seUdhdGV3YXlJbnRlcmZhY2UgcmV0dXJucyAoYm9vbCkgewogICAgICAgIF9sb2NrZWQgPSB0cnVlOwogICAgICAgIEN1cnJlbnRFbnRpdHlTdGF0ZSA9IGdldEVudGl0eVN0YXRlKCJVUEdSQURFRCIpOwogICAgICAgIEV2ZW50QXBwRW50aXR5TG9ja2VkKGFkZHJlc3ModGhpcykpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qCiAgICAgICAgRFVNTVkgTUVUSE9ELCB0byBiZSByZXBsYWNlZCBpbiBhIGZ1dHVyZSBDb2RlIFVwZ3JhZGUgd2l0aCBhIGNoZWNrIHRvIGRldGVybWluZSBpZiBzZW5kZXIgc2hvdWxkIGJlIGFibGUgdG8gaW5pdGlhdGUgYSBjb2RlIHVwZ3JhZGUKICAgICAgICBzcGVjaWZpY2FsbHkgdXNlZCBhZnRlciBtaWxlc3RvbmUgZGV2ZWxvcG1lbnQgY29tcGxldGVzCiAgICAqLwogICAgYWRkcmVzcyB0ZXN0QWRkcmVzc0FsbG93VXBncmFkZUZyb207CiAgICBmdW5jdGlvbiBjYW5Jbml0aWF0ZUNvZGVVcGdyYWRlKGFkZHJlc3MgX3NlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyhib29sKSB7CiAgICAgICAgLy8gc3VwcHJlc3Mgd2FybmluZwogICAgICAgIGlmKHRlc3RBZGRyZXNzQWxsb3dVcGdyYWRlRnJvbSAhPSAweDAgJiYgdGVzdEFkZHJlc3NBbGxvd1VwZ3JhZGVGcm9tID09IF9zZW5kZXIpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKgogICAgKiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBvdGhlciBlbnRpdHkgZXhjZXB0IEdhdGV3YXlJbnRlcmZhY2UKICAgICovCiAgICBtb2RpZmllciBvbmx5R2F0ZXdheUludGVyZmFjZSgpIHsKICAgICAgICByZXF1aXJlKEdhdGV3YXlJbnRlcmZhY2VBZGRyZXNzICE9IGFkZHJlc3MoMCkgJiYgbXNnLnNlbmRlciA9PSBHYXRld2F5SW50ZXJmYWNlQWRkcmVzcyk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKgogICAgKiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBvdGhlciBlbnRpdHkgZXhjZXB0IFByb3Bvc2FscyBBc3NldCBDb250cmFjdAogICAgKi8KICAgIG1vZGlmaWVyIG9ubHlQcm9wb3NhbHNBc3NldCgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYWRkcmVzcyhQcm9wb3NhbHNFbnRpdHkpKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIHJlcXVpcmVOb1BhcmVudCgpIHsKICAgICAgICByZXF1aXJlKEdhdGV3YXlJbnRlcmZhY2VBZGRyZXNzID09IGFkZHJlc3MoMHgwKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciByZXF1aXJlTm90SW5pdGlhbGlzZWQoKSB7CiAgICAgICAgcmVxdWlyZShfaW5pdGlhbGl6ZWQgPT0gZmFsc2UgJiYgX2xvY2tlZCA9PSBmYWxzZSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciByZXF1aXJlSW5pdGlhbGlzZWQoKSB7CiAgICAgICAgcmVxdWlyZShfaW5pdGlhbGl6ZWQgPT0gdHJ1ZSAmJiBfbG9ja2VkID09IGZhbHNlKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlEZXBsb3llcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gZGVwbG95ZXJBZGRyZXNzKTsKICAgICAgICBfOwogICAgfQoKICAgIGV2ZW50IERlYnVnQXBwbGljYXRpb25SZXF1aXJlZENoYW5nZXMoIHVpbnQ4IGluZGV4ZWQgX2N1cnJlbnQsIHVpbnQ4IGluZGV4ZWQgX3JlcXVpcmVkICk7CiAgICBldmVudCBFdmVudEFwcGxpY2F0aW9uRW50aXR5UHJvY2Vzc29yKHVpbnQ4IGluZGV4ZWQgX2N1cnJlbnQsIHVpbnQ4IGluZGV4ZWQgX3JlcXVpcmVkKTsKCiAgICAvKgogICAgICAgIFdlIGNvdWxkIGNyZWF0ZSBhIGdlbmVyaWMgbWV0aG9kIHRoYXQgaXRlcmF0ZXMgdGhyb3VnaCBhbGwgYXNzZXRzLCBhbmQgdXNpbmcgYXNzZW1ibHkgbGFuZ3VhZ2UgZ2V0IHRoZSByZXR1cm4KICAgICAgICB2YWx1ZSBvZiB0aGUgImhhc1JlcXVpcmVkU3RhdGVDaGFuZ2VzIiBtZXRob2Qgb24gZWFjaCBhc3NldC4gQmFzZWQgb24gcmV0dXJuLCBydW4gZG9TdGF0ZUNoYW5nZXMgb24gdGhlbSBvciBub3QuCgogICAgICAgIE9yIHdlIGNvdWxkIGJlIHVzaW5nIGEgZ2VuZXJpYyBBQkkgY29udHJhY3QgdGhhdCBvbmx5IGRlZmluZXMgdGhlICJoYXNSZXF1aXJlZFN0YXRlQ2hhbmdlcyIgYW5kICJkb1N0YXRlQ2hhbmdlcyIKICAgICAgICBtZXRob2RzIHRodXMgbm90IHJlcXVpcmluZyBhbnkgYXNzZW1ibHkgdmFyaWFibGUgLyBtZW1vcnkgbWFuYWdlbWVudAoKICAgICAgICBQcm9ibGVtIHdpdGggYm90aCBjYXNlcyBpcyB0aGUgZmFjdCB0aGF0IG91ciBhcHBsaWNhdGlvbiBuZWVkcyB0byBjaGFuZ2Ugb25seSBzcGVjaWZpYyBhc3NldCBzdGF0ZXMgZGVwZW5kaW5nCiAgICAgICAgb24gaXQncyBvd24gY3VycmVudCBzdGF0ZSwgdGh1cyBtYWtpbmcgYSBnZW5lcmljIGNhbGwgd2FzdGVmdWwgaW4gZ2FzIHVzYWdlLgoKICAgICAgICBMZXQncyBzdGF5IGF3YXkgZnJvbSB0aGF0IGFuZCBmb2xsb3cgdGhlIHNhbWUgYXBwcm9hY2ggYXMgd2UgZG8gaW5zaWRlIGFuIGFzc2V0LgogICAgICAgIC0gdmlldyBtZXRob2Q6IC0+IGdldCByZXF1aXJlZCBzdGF0ZSBjaGFuZ2VzCiAgICAgICAgLSB2aWV3IG1ldGhvZDogLT4gaGFzIHN0YXRlIGNoYW5nZXMKICAgICAgICAtIHByb2Nlc3NvciB0aGF0IGRvZXMgdGhlIGFjdHVhbCBjaGFuZ2VzLgogICAgICAgIC0gZG9TdGF0ZUNoYW5nZXMgcmVjdXJzaXZlIG1ldGhvZCB0aGF0IHJ1bnMgdGhlIHByb2Nlc3NvciBpZiB2aWV3cyByZXF1aXJlIGl0IHRvLgoKICAgICAgICAvLyBwcmV0dHkgc2ltaWxhciB0byBGdW5kaW5nTWFuYWdlcgogICAgKi8KCiAgICBmdW5jdGlvbiBkb1N0YXRlQ2hhbmdlcygpIHB1YmxpYyB7CgogICAgICAgIGlmKCFfbG9ja2VkKSB7CiAgICAgICAgICAgIC8vIHByb2Nlc3MgYXNzZXRzIGZpcnN0IHNvIHdlIGNhbiBpbml0aWFsaXplIHRoZW0gZnJvbSBORVcgdG8gV0FJVElORwogICAgICAgICAgICBBc3NldFByb2Nlc3NvcigpOwoKICAgICAgICAgICAgdmFyIChyZXR1cm5lZEN1cnJlbnRFbnRpdHlTdGF0ZSwgRW50aXR5U3RhdGVSZXF1aXJlZCkgPSBnZXRSZXF1aXJlZFN0YXRlQ2hhbmdlcygpOwogICAgICAgICAgICBib29sIGNhbGxBZ2FpbiA9IGZhbHNlOwoKICAgICAgICAgICAgRGVidWdBcHBsaWNhdGlvblJlcXVpcmVkQ2hhbmdlcyggcmV0dXJuZWRDdXJyZW50RW50aXR5U3RhdGUsIEVudGl0eVN0YXRlUmVxdWlyZWQgKTsKCiAgICAgICAgICAgIGlmKEVudGl0eVN0YXRlUmVxdWlyZWQgIT0gZ2V0RW50aXR5U3RhdGUoIl9fSUdOT1JFRF9fIikgKSB7CiAgICAgICAgICAgICAgICBFbnRpdHlQcm9jZXNzb3IoRW50aXR5U3RhdGVSZXF1aXJlZCk7CiAgICAgICAgICAgICAgICBjYWxsQWdhaW4gPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGhhc1JlcXVpcmVkU3RhdGVDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGJvb2wgaGFzQ2hhbmdlcyA9IGZhbHNlOwogICAgICAgIGlmKCFfbG9ja2VkKSB7CiAgICAgICAgICAgIHZhciAocmV0dXJuZWRDdXJyZW50RW50aXR5U3RhdGUsIEVudGl0eVN0YXRlUmVxdWlyZWQpID0gZ2V0UmVxdWlyZWRTdGF0ZUNoYW5nZXMoKTsKICAgICAgICAgICAgLy8gc3VwcHJlc3MgdW51c2VkIGxvY2FsIHZhcmlhYmxlIHdhcm5pbmcKICAgICAgICAgICAgcmV0dXJuZWRDdXJyZW50RW50aXR5U3RhdGUgPSAwOwogICAgICAgICAgICBpZihFbnRpdHlTdGF0ZVJlcXVpcmVkICE9IGdldEVudGl0eVN0YXRlKCJfX0lHTk9SRURfXyIpICkgewogICAgICAgICAgICAgICAgaGFzQ2hhbmdlcyA9IHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKGFueUFzc2V0SGFzQ2hhbmdlcygpKSB7CiAgICAgICAgICAgICAgICBoYXNDaGFuZ2VzID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gaGFzQ2hhbmdlczsKICAgIH0KCiAgICBmdW5jdGlvbiBhbnlBc3NldEhhc0NoYW5nZXMoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYoIEZ1bmRpbmdFbnRpdHkuaGFzUmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSApIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGlmKCBGdW5kaW5nTWFuYWdlckVudGl0eS5oYXNSZXF1aXJlZFN0YXRlQ2hhbmdlcygpICkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaWYoIE1pbGVzdG9uZXNFbnRpdHkuaGFzUmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSApIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGlmKCBQcm9wb3NhbHNFbnRpdHkuaGFzUmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSApIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZXh0ZW5kZWRBbnlBc3NldEhhc0NoYW5nZXMoKTsKICAgIH0KCiAgICAvLyB1c2UgdGhpcyB3aGVuIGV4dGVuZGluZyAiaGFzIGNoYW5nZXMiCiAgICBmdW5jdGlvbiBleHRlbmRlZEFueUFzc2V0SGFzQ2hhbmdlcygpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmKF9pbml0aWFsaXplZCkge30KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLy8gdXNlIHRoaXMgd2hlbiBleHRlbmRpbmcgImFzc2V0IHN0YXRlIHByb2Nlc3NvciIKICAgIGZ1bmN0aW9uIGV4dGVuZGVkQXNzZXRQcm9jZXNzb3IoKSBpbnRlcm5hbCAgewogICAgICAgIC8vIGRvZXMgbm90IGV4aXN0LCBidXQgd2UgY2hlY2sgYW55d2F5IHRvIGJ5cGFzcyBjb21waWVyIHdhcm5pbmcgYWJvdXQgZnVuY3Rpb24gc3RhdGUgbXV0YWJpbGl0eQogICAgICAgIGlmICggQ3VycmVudEVudGl0eVN0YXRlID09IDI1NSApIHsKICAgICAgICAgICAgUHJvcG9zYWxzRW50aXR5LnByb2Nlc3MoKTsKICAgICAgICB9CiAgICB9CgogICAgLy8gdmlldyBtZXRob2RzIGRlY2lkZSBpZiBjaGFuZ2VzIGFyZSB0byBiZSBtYWRlCiAgICAvLyBpbiBjYXNlIG9mIHRhc2tzLCB3ZSBkbyB0aGVtIGluIHRoZSBQcm9jZXNzb3JzLgoKICAgIGZ1bmN0aW9uIEFzc2V0UHJvY2Vzc29yKCkgaW50ZXJuYWwgewoKCiAgICAgICAgaWYgKCBDdXJyZW50RW50aXR5U3RhdGUgPT0gZ2V0RW50aXR5U3RhdGUoIk5FVyIpICkgewoKICAgICAgICAgICAgLy8gbW92ZSBhbGwgYXNzZXRzIHRoYXQgaGF2ZSBzdGF0ZXMgdG8gIldBSVRJTkciCiAgICAgICAgICAgIGlmKEZ1bmRpbmdFbnRpdHkuaGFzUmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSkgewogICAgICAgICAgICAgICAgRnVuZGluZ0VudGl0eS5kb1N0YXRlQ2hhbmdlcygpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZihGdW5kaW5nTWFuYWdlckVudGl0eS5oYXNSZXF1aXJlZFN0YXRlQ2hhbmdlcygpKSB7CiAgICAgICAgICAgICAgICBGdW5kaW5nTWFuYWdlckVudGl0eS5kb1N0YXRlQ2hhbmdlcygpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiggTWlsZXN0b25lc0VudGl0eS5oYXNSZXF1aXJlZFN0YXRlQ2hhbmdlcygpICkgewogICAgICAgICAgICAgICAgTWlsZXN0b25lc0VudGl0eS5kb1N0YXRlQ2hhbmdlcygpOwogICAgICAgICAgICB9CgogICAgICAgIH0gZWxzZSBpZiAoIEN1cnJlbnRFbnRpdHlTdGF0ZSA9PSBnZXRFbnRpdHlTdGF0ZSgiV0FJVElORyIpICkgewoKICAgICAgICAgICAgaWYoIEZ1bmRpbmdFbnRpdHkuaGFzUmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSApIHsKICAgICAgICAgICAgICAgIEZ1bmRpbmdFbnRpdHkuZG9TdGF0ZUNoYW5nZXMoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlIGlmICggQ3VycmVudEVudGl0eVN0YXRlID09IGdldEVudGl0eVN0YXRlKCJJTl9GVU5ESU5HIikgKSB7CgogICAgICAgICAgICBpZiggRnVuZGluZ0VudGl0eS5oYXNSZXF1aXJlZFN0YXRlQ2hhbmdlcygpICkgewogICAgICAgICAgICAgICAgRnVuZGluZ0VudGl0eS5kb1N0YXRlQ2hhbmdlcygpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiggRnVuZGluZ01hbmFnZXJFbnRpdHkuaGFzUmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSApIHsKICAgICAgICAgICAgICAgIEZ1bmRpbmdNYW5hZ2VyRW50aXR5LmRvU3RhdGVDaGFuZ2VzKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoIEN1cnJlbnRFbnRpdHlTdGF0ZSA9PSBnZXRFbnRpdHlTdGF0ZSgiSU5fREVWRUxPUE1FTlQiKSApIHsKCiAgICAgICAgICAgIGlmKCBGdW5kaW5nTWFuYWdlckVudGl0eS5oYXNSZXF1aXJlZFN0YXRlQ2hhbmdlcygpICkgewogICAgICAgICAgICAgICAgRnVuZGluZ01hbmFnZXJFbnRpdHkuZG9TdGF0ZUNoYW5nZXMoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYoTWlsZXN0b25lc0VudGl0eS5oYXNSZXF1aXJlZFN0YXRlQ2hhbmdlcygpKSB7CiAgICAgICAgICAgICAgICBNaWxlc3RvbmVzRW50aXR5LmRvU3RhdGVDaGFuZ2VzKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKFByb3Bvc2Fsc0VudGl0eS5oYXNSZXF1aXJlZFN0YXRlQ2hhbmdlcygpKSB7CiAgICAgICAgICAgICAgICBQcm9wb3NhbHNFbnRpdHkucHJvY2VzcygpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKCBDdXJyZW50RW50aXR5U3RhdGUgPT0gZ2V0RW50aXR5U3RhdGUoIkRFVkVMT1BNRU5UX0NPTVBMRVRFIikgKSB7CgogICAgICAgICAgICBpZihQcm9wb3NhbHNFbnRpdHkuaGFzUmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSkgewogICAgICAgICAgICAgICAgUHJvcG9zYWxzRW50aXR5LnByb2Nlc3MoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZXh0ZW5kZWRBc3NldFByb2Nlc3NvcigpOwogICAgfQoKICAgIGZ1bmN0aW9uIEVudGl0eVByb2Nlc3Nvcih1aW50OCBFbnRpdHlTdGF0ZVJlcXVpcmVkKSBpbnRlcm5hbCB7CgogICAgICAgIEV2ZW50QXBwbGljYXRpb25FbnRpdHlQcm9jZXNzb3IoIEN1cnJlbnRFbnRpdHlTdGF0ZSwgRW50aXR5U3RhdGVSZXF1aXJlZCApOwoKICAgICAgICAvLyBVcGRhdGUgb3VyIEVudGl0eSBTdGF0ZQogICAgICAgIEN1cnJlbnRFbnRpdHlTdGF0ZSA9IEVudGl0eVN0YXRlUmVxdWlyZWQ7CgogICAgICAgIC8vIERvIFN0YXRlIFNwZWNpZmljIFVwZGF0ZXMKCiAgICAgICAgaWYgKCBFbnRpdHlTdGF0ZVJlcXVpcmVkID09IGdldEVudGl0eVN0YXRlKCJJTl9GVU5ESU5HIikgKSB7CiAgICAgICAgICAgIC8vIHJ1biBGdW5kaW5nIHN0YXRlIGNoYW5nZXIKICAgICAgICAgICAgLy8gZG9TdGF0ZUNoYW5nZXMKICAgICAgICB9CgogICAgICAgIC8vIEVudGl0eVN0YXRlUmVxdWlyZWQgPSBnZXRFbnRpdHlTdGF0ZSgiSU5fRlVORElORyIpOwoKCiAgICAgICAgLy8gRnVuZGluZyBGYWlsZWQKICAgICAgICAvKgogICAgICAgIGlmICggRW50aXR5U3RhdGVSZXF1aXJlZCA9PSBnZXRFbnRpdHlTdGF0ZSgiRlVORElOR19GQUlMRURfU1RBUlQiKSApIHsKICAgICAgICAgICAgLy8gc2V0IFByb2Nlc3NWYXVsdExpc3QgVGFzawogICAgICAgICAgICBjdXJyZW50VGFzayA9IGdldEhhc2goIkZVTkRJTkdfRkFJTEVEX1NUQVJUIiwgIiIpOwogICAgICAgICAgICBDdXJyZW50RW50aXR5U3RhdGUgPSBnZXRFbnRpdHlTdGF0ZSgiRlVORElOR19GQUlMRURfUFJPR1JFU1MiKTsKICAgICAgICB9IGVsc2UgaWYgKCBFbnRpdHlTdGF0ZVJlcXVpcmVkID09IGdldEVudGl0eVN0YXRlKCJGVU5ESU5HX0ZBSUxFRF9QUk9HUkVTUyIpICkgewogICAgICAgICAgICBQcm9jZXNzVmF1bHRMaXN0KFZhdWx0Q291bnRQZXJQcm9jZXNzKTsKCiAgICAgICAgICAgIC8vIEZ1bmRpbmcgU3VjY2Vzc2Z1bAogICAgICAgIH0gZWxzZSBpZiAoIEVudGl0eVN0YXRlUmVxdWlyZWQgPT0gZ2V0RW50aXR5U3RhdGUoIkZVTkRJTkdfU1VDQ0VTU0ZVTF9TVEFSVCIpICkgewoKICAgICAgICAgICAgLy8gaW5pdCBTQ0FEQSB2YXJpYWJsZSBjYWNoZS4KICAgICAgICAgICAgaWYoVG9rZW5TQ0FEQUVudGl0eS5pbml0Q2FjaGVGb3JWYXJpYWJsZXMoKSkgewogICAgICAgICAgICAgICAgLy8gc3RhcnQgcHJvY2Vzc2luZyB2YXVsdHMKICAgICAgICAgICAgICAgIGN1cnJlbnRUYXNrID0gZ2V0SGFzaCgiRlVORElOR19TVUNDRVNTRlVMX1NUQVJUIiwgIiIpOwogICAgICAgICAgICAgICAgQ3VycmVudEVudGl0eVN0YXRlID0gZ2V0RW50aXR5U3RhdGUoIkZVTkRJTkdfU1VDQ0VTU0ZVTF9QUk9HUkVTUyIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gc29tZXRoaW5nIHdlbnQgcmVhbGx5IHdyb25nLCBqdXN0IGJhaWwgb3V0IGZvciBub3cKICAgICAgICAgICAgICAgIEN1cnJlbnRFbnRpdHlTdGF0ZSA9IGdldEVudGl0eVN0YXRlKCJGVU5ESU5HX0ZBSUxFRF9TVEFSVCIpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICggRW50aXR5U3RhdGVSZXF1aXJlZCA9PSBnZXRFbnRpdHlTdGF0ZSgiRlVORElOR19TVUNDRVNTRlVMX1BST0dSRVNTIikgKSB7CiAgICAgICAgICAgIFByb2Nlc3NWYXVsdExpc3QoVmF1bHRDb3VudFBlclByb2Nlc3MpOwogICAgICAgICAgICAvLyBNaWxlc3RvbmVzCiAgICAgICAgfSBlbHNlIGlmICggRW50aXR5U3RhdGVSZXF1aXJlZCA9PSBnZXRFbnRpdHlTdGF0ZSgiTUlMRVNUT05FX1BST0NFU1NfU1RBUlQiKSApIHsKICAgICAgICAgICAgY3VycmVudFRhc2sgPSBnZXRIYXNoKCJNSUxFU1RPTkVfUFJPQ0VTU19TVEFSVCIsIGdldEN1cnJlbnRNaWxlc3RvbmVJZCgpICk7CiAgICAgICAgICAgIEN1cnJlbnRFbnRpdHlTdGF0ZSA9IGdldEVudGl0eVN0YXRlKCJNSUxFU1RPTkVfUFJPQ0VTU19QUk9HUkVTUyIpOwogICAgICAgIH0gZWxzZSBpZiAoIEVudGl0eVN0YXRlUmVxdWlyZWQgPT0gZ2V0RW50aXR5U3RhdGUoIk1JTEVTVE9ORV9QUk9DRVNTX1BST0dSRVNTIikgKSB7CiAgICAgICAgICAgIFByb2Nlc3NWYXVsdExpc3QoVmF1bHRDb3VudFBlclByb2Nlc3MpOwoKICAgICAgICAgICAgLy8gQ29tcGxldGlvbgogICAgICAgIH0gZWxzZSBpZiAoIEVudGl0eVN0YXRlUmVxdWlyZWQgPT0gZ2V0RW50aXR5U3RhdGUoIkNPTVBMRVRFX1BST0NFU1NfU1RBUlQiKSApIHsKICAgICAgICAgICAgY3VycmVudFRhc2sgPSBnZXRIYXNoKCJDT01QTEVURV9QUk9DRVNTX1NUQVJUIiwgIiIpOwogICAgICAgICAgICBDdXJyZW50RW50aXR5U3RhdGUgPSBnZXRFbnRpdHlTdGF0ZSgiQ09NUExFVEVfUFJPQ0VTU19QUk9HUkVTUyIpOwogICAgICAgIH0gZWxzZSBpZiAoIEVudGl0eVN0YXRlUmVxdWlyZWQgPT0gZ2V0RW50aXR5U3RhdGUoIkNPTVBMRVRFX1BST0NFU1NfUFJPR1JFU1MiKSApIHsKICAgICAgICAgICAgUHJvY2Vzc1ZhdWx0TGlzdChWYXVsdENvdW50UGVyUHJvY2Vzcyk7CiAgICAgICAgfQogICAgICAgICovCiAgICB9CgogICAgLyoKICAgICAqIE1ldGhvZDogR2V0IEVudGl0eSBSZXF1aXJlZCBTdGF0ZSBDaGFuZ2VzCiAgICAgKgogICAgICogQGFjY2VzcyAgICAgICBwdWJsaWMKICAgICAqIEB0eXBlICAgICAgICAgbWV0aG9kCiAgICAgKgogICAgICogQHJldHVybiAgICAgICAoIHVpbnQ4IEN1cnJlbnRFbnRpdHlTdGF0ZSwgdWludDggRW50aXR5U3RhdGVSZXF1aXJlZCApCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFJlcXVpcmVkU3RhdGVDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgsIHVpbnQ4KSB7CgogICAgICAgIHVpbnQ4IEVudGl0eVN0YXRlUmVxdWlyZWQgPSBnZXRFbnRpdHlTdGF0ZSgiX19JR05PUkVEX18iKTsKCiAgICAgICAgaWYoIEN1cnJlbnRFbnRpdHlTdGF0ZSA9PSBnZXRFbnRpdHlTdGF0ZSgiTkVXIikgKSB7CiAgICAgICAgICAgIC8vIGdlbmVyYWwgc28gd2Uga25vdyB3ZSBpbml0aWFsaXplZAogICAgICAgICAgICBFbnRpdHlTdGF0ZVJlcXVpcmVkID0gZ2V0RW50aXR5U3RhdGUoIldBSVRJTkciKTsKCiAgICAgICAgfSBlbHNlIGlmICggQ3VycmVudEVudGl0eVN0YXRlID09IGdldEVudGl0eVN0YXRlKCJXQUlUSU5HIikgKSB7CgogICAgICAgICAgICAvLyBGdW5kaW5nIFN0YXJ0ZWQKICAgICAgICAgICAgaWYoIEZ1bmRpbmdFbnRpdHkuQ3VycmVudEVudGl0eVN0YXRlKCkgPT0gRnVuZGluZ0VudGl0eS5nZXRFbnRpdHlTdGF0ZSgiSU5fUFJPR1JFU1MiKSApIHsKICAgICAgICAgICAgICAgIEVudGl0eVN0YXRlUmVxdWlyZWQgPSBnZXRFbnRpdHlTdGF0ZSgiSU5fRlVORElORyIpOwogICAgICAgICAgICB9CgogICAgICAgIH0gZWxzZSBpZiAoIEN1cnJlbnRFbnRpdHlTdGF0ZSA9PSBnZXRFbnRpdHlTdGF0ZSgiSU5fRlVORElORyIpICkgewoKICAgICAgICAgICAgaWYoRnVuZGluZ0VudGl0eS5DdXJyZW50RW50aXR5U3RhdGUoKSA9PSBGdW5kaW5nRW50aXR5LmdldEVudGl0eVN0YXRlKCJTVUNDRVNTRlVMX0ZJTkFMIikpIHsKICAgICAgICAgICAgICAgIC8vIFNVQ0NFU1NGVUxfRklOQUwgbWVhbnMgRlVORElORyB3YXMgc3VjY2Vzc2Z1bCwgYW5kIEZ1bmRpbmdNYW5hZ2VyIGhhcyBmaW5pc2hlZCBkaXN0cmlidXRpbmcgdG9rZW5zIGFuZCBldGhlcgogICAgICAgICAgICAgICAgRW50aXR5U3RhdGVSZXF1aXJlZCA9IGdldEVudGl0eVN0YXRlKCJJTl9ERVZFTE9QTUVOVCIpOwoKICAgICAgICAgICAgfSBlbHNlIGlmKEZ1bmRpbmdFbnRpdHkuQ3VycmVudEVudGl0eVN0YXRlKCkgPT0gRnVuZGluZ0VudGl0eS5nZXRFbnRpdHlTdGF0ZSgiRkFJTEVEX0ZJTkFMIikpIHsKICAgICAgICAgICAgICAgIC8vIEZ1bmRpbmcgZmFpbGVkLi4KICAgICAgICAgICAgICAgIEVudGl0eVN0YXRlUmVxdWlyZWQgPSBnZXRFbnRpdHlTdGF0ZSgiSU5fR0xPQkFMX0NBU0hCQUNLIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgfSBlbHNlIGlmICggQ3VycmVudEVudGl0eVN0YXRlID09IGdldEVudGl0eVN0YXRlKCJJTl9ERVZFTE9QTUVOVCIpICkgewoKICAgICAgICAgICAgLy8gdGhpcyBpcyB3aGVyZSBtb3N0IHRoaW5ncyBoYXBwZW4KICAgICAgICAgICAgLy8gbWlsZXN0b25lcyBnZXQgZGV2ZWxvcGVkCiAgICAgICAgICAgIC8vIGNvZGUgdXBncmFkZXMgZ2V0IGluaXRpYXRlZAogICAgICAgICAgICAvLyBwcm9wb3NhbHMgZ2V0IGNyZWF0ZWQgYW5kIHZvdGVkCgogICAgICAgICAgICAvKgogICAgICAgICAgICBpZihQcm9wb3NhbHNFbnRpdHkuQ3VycmVudEVudGl0eVN0YXRlKCkgPT0gUHJvcG9zYWxzRW50aXR5LmdldEVudGl0eVN0YXRlKCJDT0RFX1VQR1JBREVfQUNDRVBURUQiKSkgewogICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgd2UgaGF2ZSBhbiB1cGdyYWRlIHByb3Bvc2FsIHRoYXQgaXMgYWNjZXB0ZWQgYW5kIG1vdmUgaW50byBzYWlkIHN0YXRlCiAgICAgICAgICAgICAgICBFbnRpdHlTdGF0ZVJlcXVpcmVkID0gZ2V0RW50aXR5U3RhdGUoIlNUQVJUX0NPREVfVVBHUkFERSIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgKi8KCiAgICAgICAgICAgIGlmKE1pbGVzdG9uZXNFbnRpdHkuQ3VycmVudEVudGl0eVN0YXRlKCkgPT0gTWlsZXN0b25lc0VudGl0eS5nZXRFbnRpdHlTdGF0ZSgiREVWRUxPUE1FTlRfQ09NUExFVEUiKSkgewogICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgd2UgZmluaXNoZWQgZGV2ZWxvcGluZyBhbGwgbWlsZXN0b25lcyAuLiBhbmQgaWYgc28gbW92ZSBzdGF0ZSB0byBjb21wbGV0ZS4KICAgICAgICAgICAgICAgIEVudGl0eVN0YXRlUmVxdWlyZWQgPSBnZXRFbnRpdHlTdGF0ZSgiREVWRUxPUE1FTlRfQ09NUExFVEUiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYoTWlsZXN0b25lc0VudGl0eS5DdXJyZW50RW50aXR5U3RhdGUoKSA9PSBNaWxlc3RvbmVzRW50aXR5LmdldEVudGl0eVN0YXRlKCJERUFETElORV9NRUVUSU5HX1RJTUVfRkFJTEVEIikpIHsKICAgICAgICAgICAgICAgIEVudGl0eVN0YXRlUmVxdWlyZWQgPSBnZXRFbnRpdHlTdGF0ZSgiSU5fR0xPQkFMX0NBU0hCQUNLIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgfSBlbHNlIGlmICggQ3VycmVudEVudGl0eVN0YXRlID09IGdldEVudGl0eVN0YXRlKCJTVEFSVF9DT0RFX1VQR1JBREUiKSApIHsKCiAgICAgICAgICAgIC8vIGNoZWNrIHN0dWZmIHRvIG1vdmUgaW50byBJTl9DT0RFX1VQR1JBREUKICAgICAgICAgICAgLy8gRW50aXR5U3RhdGVSZXF1aXJlZCA9IGdldEVudGl0eVN0YXRlKCJJTl9DT0RFX1VQR1JBREUiKTsKCiAgICAgICAgfSBlbHNlIGlmICggQ3VycmVudEVudGl0eVN0YXRlID09IGdldEVudGl0eVN0YXRlKCJJTl9DT0RFX1VQR1JBREUiKSApIHsKCiAgICAgICAgICAgIC8vIGNoZWNrIHN0dWZmIHRvIGZpbmlzaAogICAgICAgICAgICAvLyBFbnRpdHlTdGF0ZVJlcXVpcmVkID0gZ2V0RW50aXR5U3RhdGUoIkZJTklTSEVEX0NPREVfVVBHUkFERSIpOwoKICAgICAgICB9IGVsc2UgaWYgKCBDdXJyZW50RW50aXR5U3RhdGUgPT0gZ2V0RW50aXR5U3RhdGUoIkZJTklTSEVEX0NPREVfVVBHUkFERSIpICkgewoKICAgICAgICAgICAgLy8gbW92ZSB0byBJTl9ERVZFTE9QTUVOVCBvciBERVZFTE9QTUVOVF9DT01QTEVURSBiYXNlZCBvbiBzdGF0ZSBiZWZvcmUgU1RBUlRfQ09ERV9VUEdSQURFLgogICAgICAgICAgICAvLyBFbnRpdHlTdGF0ZVJlcXVpcmVkID0gZ2V0RW50aXR5U3RhdGUoIkRFVkVMT1BNRU5UX0NPTVBMRVRFIik7CiAgICAgICAgICAgIC8vIEVudGl0eVN0YXRlUmVxdWlyZWQgPSBnZXRFbnRpdHlTdGF0ZSgiRklOSVNIRURfQ09ERV9VUEdSQURFIik7CgogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIChDdXJyZW50RW50aXR5U3RhdGUsIEVudGl0eVN0YXRlUmVxdWlyZWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFRpbWVzdGFtcCgpIHZpZXcgcHVibGljIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gbm93OwogICAgfQoKfQ=='.
	

]
