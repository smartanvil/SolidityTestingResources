Class {
	#name : #SRT3e368966c54C606ef545cCafD43af8bE1deF734F,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT3e368966c54C606ef545cCafD43af8bE1deF734F >> base64 [
	^ 'LyoKCVdlZWtseUxvdHRlcnlCCglDb2RlZCBieTogaUZBCglodHRwOi8vd2xiLmV0aGVyZXVtbG90dGVyeS5uZXQKCXZlcjogMS4yCiovCmNvbnRyYWN0IFdMQkRyYXdzREIgewoJYWRkcmVzcyBwcml2YXRlIG93bmVyOwoJYWRkcmVzcyBwcml2YXRlIGdhbWU7CgkKCXN0cnVjdCBkcmF3c19zIHsKCQl1aW50IGRhdGU7CgkJdWludDhbM10gbnVtYmVyczsKCQl1aW50IGhpdDNDb3VudDsKCQl1aW50IGhpdDNWYWx1ZTsKCQl1aW50IGhpdDJDb3VudDsKCQl1aW50IGhpdDJWYWx1ZTsKCX0KCQoJZHJhd3Nfc1tdIHByaXZhdGUgZHJhd3M7CgkKCWZ1bmN0aW9uIFdMQkRyYXdzREIoKSB7CgkJb3duZXIgPSBtc2cuc2VuZGVyOwoJfQoJCglmdW5jdGlvbiBuZXdEcmF3KHVpbnQgZGF0ZSwgdWludDhbM10gbnVtYmVycywgdWludCBoaXQzQ291bnQsIHVpbnQgaGl0M1ZhbHVlLCB1aW50IGhpdDJDb3VudCwgdWludCBoaXQyVmFsdWUpIG5vRXRoZXIgewoJCWlmICggbXNnLnNlbmRlciAhPSBvd25lciAmJiBtc2cuc2VuZGVyICE9IGdhbWUgKSB7IHRocm93OyB9CgkJZHJhd3MucHVzaCggZHJhd3NfcyggZGF0ZSwgbnVtYmVycywgaGl0M0NvdW50LCBoaXQzVmFsdWUsIGhpdDJDb3VudCwgaGl0MlZhbHVlKSApOwoJfQoJCglmdW5jdGlvbiBnZXREcmF3KHVpbnQgaWQpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgZGF0ZSwgdWludDhbM10gbnVtYmVycywgdWludCBoaXQzQ291bnQsIHVpbnQgaGl0M1ZhbHVlLCB1aW50IGhpdDJDb3VudCwgdWludCBoaXQyVmFsdWUpIHsKCQlyZXR1cm4gKCBkcmF3c1tpZF0uZGF0ZSwgZHJhd3NbaWRdLm51bWJlcnMsIGRyYXdzW2lkXS5oaXQzQ291bnQsIGRyYXdzW2lkXS5oaXQzVmFsdWUsIGRyYXdzW2lkXS5oaXQyQ291bnQsIGRyYXdzW2lkXS5oaXQyVmFsdWUgKTsKCX0KCQoJZnVuY3Rpb24gc2V0R2FtZUFkZHJlc3MoYWRkcmVzcyBfZ2FtZSkgbm9FdGhlciBPbmx5T3duZXIgZXh0ZXJuYWwgewoJCWdhbWUgPSBfZ2FtZTsKCX0KCQoJbW9kaWZpZXIgbm9FdGhlcigpIHsgaWYgKG1zZy52YWx1ZSA+IDApIHsgdGhyb3c7IH0gXzsgfQltb2RpZmllciBPbmx5T3duZXIoKSB7IGlmIChvd25lciAhPSBtc2cuc2VuZGVyKSB7IHRocm93OyB9IF87IH19Cgpjb250cmFjdCBXZWVrbHlMb3R0ZXJ5QiB7CgkvKiBzdHJ1Y3R1cmVzICovCglzdHJ1Y3QgZ2FtZXNfcyB7CgkJdWludCB0aWNrZXRzQ291bnQ7CgkJbWFwcGluZyhieXRlczMyID0+IHVpbnQpIGhpdDNIYXNoOwoJCW1hcHBpbmcoYnl0ZXMzMiA9PiB1aW50KSBoaXQySGFzaDsKCQl1aW50IHN0YXJ0VGltZXN0YW1wOwoJCXVpbnQgZW5kVGltZXN0YW1wOwoJCWJ5dGVzMyB3aW5uaW5nTnVtYmVyc0J5dGVzOwoJCXVpbnQgcHJlcGFyZUJsb2NrOwoJCWJvb2wgZHJhd0RvbmU7CgkJdWludCBwcml6ZVBvdDsKCQl1aW50IGhpdDNDb3VudDsKCQl1aW50IGhpdDNWYWx1ZTsKCQl1aW50IGhpdDJDb3VudDsKCQl1aW50IGhpdDJWYWx1ZTsKCX0KCXN0cnVjdCBwbGF5ZXJHYW1lc19zIHsKCQlieXRlczNbXSBudW1iZXJzQnl0ZXM7CgkJbWFwcGluZyhieXRlczMyID0+IHVpbnQpIGhpdDNIYXNoOwoJCW1hcHBpbmcoYnl0ZXMzMiA9PiB1aW50KSBoaXQySGFzaDsKCQlib29sIGNoZWNrZWQ7Cgl9CglzdHJ1Y3QgcGxheWVyc19zIHsKCQltYXBwaW5nKHVpbnQgPT4gcGxheWVyR2FtZXNfcykgZ2FtZXM7Cgl9CglzdHJ1Y3QgaW52ZXN0b3JzX3MgewoJCWFkZHJlc3Mgb3duZXI7CgkJdWludCB2YWx1ZTsKCQl1aW50IGJhbGFuY2U7CgkJYm9vbCBsaXZlOwoJCWJvb2wgdmFsaWQ7CgkJdWludCBiZWdpbnM7Cgl9CglzdHJ1Y3QgZHJhd3NfcyB7CgkJdWludCBkYXRlOwoJCXVpbnQgZ2FtZUlEOwoJCWJ5dGVzMyBudW1iZXJzQnl0ZXM7CgkJdWludCBoaXQzQ291bnQ7CgkJdWludCBoaXQzVmFsdWU7CgkJdWludCBoaXQyQ291bnQ7CgkJdWludCBoaXQyVmFsdWU7Cgl9CgkvKiBjb25maWcgKi8KCXVpbnQgcHVibGljIGNvbnN0YW50IHRpY2tldFByaWNlID0gMTAwIGZpbm5leTsgLy8gMC4xIGV0aGVyCgl1aW50IHByaXZhdGUgY29uc3RhbnQgZHJhd01heE51bWJlciA9IDUwOwoJdWludCBwcml2YXRlIGNvbnN0YW50IGRyYXdCbG9ja0RlbGF5ID0gNTsKCXVpbnQgcHJpdmF0ZSBjb25zdGFudCBwcml6ZURpc21pc3NEZWxheSA9IDU7Cgl1aW50IHByaXZhdGUgY29uc3RhbnQgY29udHJhY3REaXNtaXNzRGVsYXkgPSA1IHdlZWtzOwoJdWludCBwcml2YXRlIGNvbnN0YW50IGludmVzdFVuaXQgPSAxIGV0aGVyOwoJdWludCBwcml2YXRlIGNvbnN0YW50IGludmVzdE1pbmltdW0gPSAxMCBldGhlcjsKCXVpbnQgcHJpdmF0ZSBjb25zdGFudCBpbnZlc3RVc2VyTGltaXQgPSAyMDA7Cgl1aW50IHByaXZhdGUgY29uc3RhbnQgaW52ZXN0TWluRHVyYXRpb24gPSA1OyAvLyA1IGRyYXchCgl1aW50IHByaXZhdGUgY29uc3RhbnQgaW52ZXN0SWRsZVRpbWUgPSAxIGRheXM7Cgl1aW50IHByaXZhdGUgY29uc3RhbnQgZm9yT3duZXIgPSAyOyAvLyUKCXVpbnQgcHJpdmF0ZSBjb25zdGFudCBmb3JJbnZlc3RvcnMgPSA0MDsgLy8lCgl1aW50IHByaXZhdGUgY29uc3RhbnQgZm9ySGl0MiA9IDMwOyAvLyUKCS8qIHZhcmlhYmxlcyAqLwoJYWRkcmVzcyBwcml2YXRlIFdMQmRyYXdzREJBZGRyOwoJYWRkcmVzcyBwcml2YXRlIG93bmVyOwoJdWludCBwcml2YXRlIGN1cnJlbnRKYWNrcG90OwoJdWludCBwcml2YXRlIGludmVzdG1lbnRzVmFsdWU7Cgl1aW50IHByaXZhdGUgZXh0cmFKYWNrcG90OwoJdWludCBwcml2YXRlIHRpY2tldENvdW50ZXI7Cgl1aW50IHByaXZhdGUgY3VycmVudEdhbWU7Cgl1aW50IHByaXZhdGUgb3duZXJCYWxhbmNlOwoJdWludCBwcml2YXRlIG9sZENvbnRyYWN0TGFzdEdhbWU7Cglib29sIHB1YmxpYyBjb250cmFjdEVuYWJsZWQgPSB0cnVlOwoJdWludCBwcml2YXRlIGNvbnRyYWN0RGlzYWJsZWRUaW1lU3RhbXA7CgltYXBwaW5nKGFkZHJlc3MgPT4gcGxheWVyc19zKSBwcml2YXRlIHBsYXllcnM7CglnYW1lc19zW10gcHJpdmF0ZSBnYW1lczsKCWludmVzdG9yc19zW10gcHJpdmF0ZSBpbnZlc3RvcnM7CgkvKiBldmVudHMgKi8KCWV2ZW50IE5ld1RpY2tldEV2ZW50KGFkZHJlc3MgUGxheWVyLCB1aW50OCBOdW1iZXIxLCB1aW50OCBOdW1iZXIyLCB1aW50OCBOdW1iZXIzKTsKCWV2ZW50IENvbnRyYWN0RGlzYWJsZWRFdmVudCh1aW50IERlYWRsaW5lVGltZSk7CglldmVudCBEcmF3UHJlcGFyZUV2ZW50KHVpbnQgQmxvY2tOdW1iZXIpOwoJZXZlbnQgRHJhd0V2ZW50KHVpbnQgR2FtZUlELCB1aW50OCBOdW1iZXIxLCB1aW50OCBOdW1iZXIyLCB1aW50OCBOdW1iZXIzLCB1aW50IEhpdDNDb3VudCwgdWludCBIaXQzVmFsdWUsIHVpbnQgSGl0MkNvdW50LCB1aW50IEhpdDJWYWx1ZSk7CglldmVudCBJbnZlc3RBZGRFdmVudChhZGRyZXNzIEludmVzdG9yLCB1aW50IFZhbHVlKTsKCWV2ZW50IEludmVzdENhbmNlbEV2ZW50KGFkZHJlc3MgSW52ZXN0b3IsIHVpbnQgVmFsdWUpOwoJLyogY29uc3RydWN0b3IgKi8KCWZ1bmN0aW9uIFdlZWtseUxvdHRlcnlCKGFkZHJlc3MgX1dMQmRyYXdzREJBZGRyLCB1aW50IF9vbGRDb250cmFjdExhc3RHYW1lKSB7CgkJV0xCZHJhd3NEQkFkZHIgPSBfV0xCZHJhd3NEQkFkZHI7CgkJb3duZXIgPSBtc2cuc2VuZGVyOwoJCWN1cnJlbnRHYW1lID0gMDsKCQlvbGRDb250cmFjdExhc3RHYW1lID0gX29sZENvbnRyYWN0TGFzdEdhbWU7CgkJZ2FtZXMubGVuZ3RoID0gMTsKCQlnYW1lc1swXS5zdGFydFRpbWVzdGFtcCA9IG5vdzsKCQl1aW50IHJldCA9IDE0NzA1NzEyMDA7CgkJd2hpbGUgKHJldCA8IG5vdykgewoJCQlyZXQgKz0gMSB3ZWVrczsKCQl9CgkJZ2FtZXNbMF0uZW5kVGltZXN0YW1wID0gcmV0OwoJfQoJLyogY29uc3RhbnQgZnVuY3Rpb25zICovCglmdW5jdGlvbiBWaXNpdCgpIGNvbnN0YW50IHJldHVybnMgKHN0cmluZykgeyByZXR1cm4gImh0dHA6Ly93bGIuZXRoZXJldW1sb3R0ZXJ5Lm5ldCI7IH0KCWZ1bmN0aW9uIERyYXdzKHVpbnQgaWQpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgZGF0ZSwgdWludDhbM10gTnVtYmVycywgdWludCBoaXQzQ291bnQsIHVpbnQgaGl0M1ZhbHVlLCB1aW50IGhpdDJDb3VudCwgdWludCBoaXQyVmFsdWUpIHsKCQlyZXR1cm4gV0xCRHJhd3NEQiggV0xCZHJhd3NEQkFkZHIgKS5nZXREcmF3KGlkKTsKCX0KCWZ1bmN0aW9uIEN1cnJlbnRHYW1lKCkgY29uc3RhbnQgcmV0dXJucyAodWludCBHYW1lSUQsIHVpbnQgSmFja3BvdCwgdWludCBTdGFydCwgdWludCBFbmQsIHVpbnQgVGlja2V0cykgewoJCXJldHVybiAoY3VycmVudEdhbWUrb2xkQ29udHJhY3RMYXN0R2FtZSwgY3VycmVudEphY2twb3QsIGdhbWVzW2N1cnJlbnRHYW1lXS5zdGFydFRpbWVzdGFtcCwgZ2FtZXNbY3VycmVudEdhbWVdLmVuZFRpbWVzdGFtcCwgZ2FtZXNbY3VycmVudEdhbWVdLnRpY2tldHNDb3VudCk7Cgl9CglmdW5jdGlvbiBQbGF5ZXJUaWNrZXRzKGFkZHJlc3MgUGxheWVyLCB1aW50IEdhbWVJRCwgdWludCBUaWNrZXRJRCkgY29uc3RhbnQgcmV0dXJucyAodWludDhbM10gbnVtYmVycywgYm9vbCBDaGVja2VkKSB7CgkJR2FtZUlEIC09IG9sZENvbnRyYWN0TGFzdEdhbWU7CgkJcmV0dXJuICggZ2V0TnVtYmVyc0Zyb21CeXRlcyggcGxheWVyc1tQbGF5ZXJdLmdhbWVzW0dhbWVJRF0ubnVtYmVyc0J5dGVzW1RpY2tldElEXSApLCBwbGF5ZXJzW1BsYXllcl0uZ2FtZXNbR2FtZUlEXS5jaGVja2VkKTsKCX0KCWZ1bmN0aW9uIEludmVzdG9ycyhhZGRyZXNzIEFkZHJlc3MpIGNvbnN0YW50IHJldHVybnModWludCBJbnZlc3RtZW50LCB1aW50IEJhbGFuY2UsIGJvb2wgTGl2ZSkgewoJCXZhciAoZm91bmQsIEludmVzdG9ySUQpID0gZ2V0SW52ZXN0b3JCeUFkZHJlc3MoQWRkcmVzcyk7CgkJaWYgKGZvdW5kID09IGZhbHNlIHx8ICEgaW52ZXN0b3JzW0ludmVzdG9ySURdLnZhbGlkKSB7CgkJCXJldHVybiAoMCwgMCwgZmFsc2UpOwoJCX0KCQlyZXR1cm4gKGludmVzdG9yc1tJbnZlc3RvcklEXS52YWx1ZSwgaW52ZXN0b3JzW0ludmVzdG9ySURdLmJhbGFuY2UsIGludmVzdG9yc1tJbnZlc3RvcklEXS5saXZlKTsKCX0KCWZ1bmN0aW9uIENoZWNrUHJpemUoYWRkcmVzcyBBZGRyZXNzKSBjb25zdGFudCByZXR1cm5zKHVpbnQgdmFsdWUpIHsKCQl1aW50IGdhbWVJRDsKCQl1aW50IGdhbWVMb3dJRDsKCQl1aW50OFszXSBtZW1vcnkgbnVtYmVyczsKCQl1aW50IGhpdDNDb3VudDsKCQl1aW50IGhpdDJDb3VudDsKCQlmb3IgKCBnYW1lSUQ9Y3VycmVudEdhbWUgOyBnYW1lSUQ+PTAgOyBnYW1lSUQtLSApIHsKCQkJaWYgKCAhIHBsYXllcnNbQWRkcmVzc10uZ2FtZXNbZ2FtZUlEXS5jaGVja2VkKSB7CgkJCQlpZiAoZ2FtZXNbZ2FtZUlEXS5kcmF3RG9uZSkgewoJCQkJCW51bWJlcnMgPSBnZXROdW1iZXJzRnJvbUJ5dGVzKGdhbWVzW2dhbWVJRF0ud2lubmluZ051bWJlcnNCeXRlcyk7CgkJCQkJaGl0M0NvdW50ID0gcGxheWVyc1tBZGRyZXNzXS5nYW1lc1tnYW1lSURdLmhpdDNIYXNoW3NoYTMoIG51bWJlcnNbMF0sIG51bWJlcnNbMV0sIG51bWJlcnNbMl0gKV07CgkJCQkJdmFsdWUgKz0gaGl0M0NvdW50ICogZ2FtZXNbZ2FtZUlEXS5oaXQzVmFsdWU7CgkJCQkJaGl0MkNvdW50ID0gcGxheWVyc1tBZGRyZXNzXS5nYW1lc1tnYW1lSURdLmhpdDJIYXNoW3NoYTMoIG51bWJlcnNbMF0sIG51bWJlcnNbMV0gKV07CgkJCQkJaGl0MkNvdW50ICs9IHBsYXllcnNbQWRkcmVzc10uZ2FtZXNbZ2FtZUlEXS5oaXQySGFzaFtzaGEzKCBudW1iZXJzWzBdLCBudW1iZXJzWzJdICldOwoJCQkJCWhpdDJDb3VudCArPSBwbGF5ZXJzW0FkZHJlc3NdLmdhbWVzW2dhbWVJRF0uaGl0Mkhhc2hbc2hhMyggbnVtYmVyc1sxXSwgbnVtYmVyc1syXSApXTsKCQkJCQloaXQyQ291bnQgLT0gaGl0M0NvdW50KjM7CgkJCQkJdmFsdWUgKz0gaGl0MkNvdW50ICogZ2FtZXNbZ2FtZUlEXS5oaXQyVmFsdWU7CgkJCQl9IGVsc2UgaWYgKCAhIGNvbnRyYWN0RW5hYmxlZCAmJiBnYW1lSUQgPT0gY3VycmVudEdhbWUpIHsKCQkJCQl2YWx1ZSArPSBwbGF5ZXJzW0FkZHJlc3NdLmdhbWVzW2dhbWVJRF0ubnVtYmVyc0J5dGVzLmxlbmd0aCAqIHRpY2tldFByaWNlOwoJCQkJfQoJCQl9CgkJCWlmIChnYW1lSUQgPT0gMCB8fCBnYW1lSUQtcHJpemVEaXNtaXNzRGVsYXkgPT0gZ2FtZUlEKSB7IGJyZWFrOyB9CgkJfQoJfQoJLyogY2FsbGJhY2sgZnVuY3Rpb24gKi8KCWZ1bmN0aW9uICgpIHsKCQl2YXIgTnVtYmVycyA9IGdldE51bWJlcnNGcm9tSGFzaChzaGEzKGJsb2NrLmNvaW5iYXNlLCBub3csIHRpY2tldENvdW50ZXIpKTsKCQlCdXlUaWNrZXQoTnVtYmVyc1swXSxOdW1iZXJzWzFdLE51bWJlcnNbMl0pOwoJfQoJLyogZXh0ZXJuYWwgZnVuY3Rpb25zIGZvciBwbGF5ZXJzICovCglmdW5jdGlvbiBCdXlUaWNrZXQodWludDggTnVtYmVyMSwgdWludDggTnVtYmVyMiwgdWludDggTnVtYmVyMykgbm9Db250cmFjdCBPbmx5RW5hYmxlZCB7CgkJdmFyIE51bWJlcnMgPSBbTnVtYmVyMSAsIE51bWJlcjIgLCBOdW1iZXIzXTsKCQlpZiAoICEgY2hlY2tOdW1iZXJzKCBOdW1iZXJzICkpIHsgdGhyb3c7IH0KCQlOdW1iZXJzID0gc29ydE51bWJlcnMoTnVtYmVycyk7CgkJaWYgKG1zZy52YWx1ZSA8IHRpY2tldFByaWNlKSB7IHRocm93OyB9CgkJaWYgKG1zZy52YWx1ZS10aWNrZXRQcmljZSA+IDApIHsgaWYgKCAhIG1zZy5zZW5kZXIuc2VuZCggbXNnLnZhbHVlLXRpY2tldFByaWNlICkpIHsgdGhyb3c7IH0gfQoJCWlmIChjdXJyZW50SmFja3BvdCA9PSAwKSB7IHRocm93OyB9CgkJaWYgKGdhbWVzW2N1cnJlbnRHYW1lXS5lbmRUaW1lc3RhbXAgPCBub3cpIHsgdGhyb3c7IH0KCQl0aWNrZXRDb3VudGVyKys7CgkJZ2FtZXNbY3VycmVudEdhbWVdLnRpY2tldHNDb3VudCsrOwoJCWJ5dGVzMzIgaGFzaDAgPSBzaGEzKCBOdW1iZXJzWzBdLCBOdW1iZXJzWzFdLCBOdW1iZXJzWzJdICk7CgkJYnl0ZXMzMiBoYXNoMSA9IHNoYTMoIE51bWJlcnNbMF0sIE51bWJlcnNbMV0pOwoJCWJ5dGVzMzIgaGFzaDIgPSBzaGEzKCBOdW1iZXJzWzBdLCBOdW1iZXJzWzJdKTsKCQlieXRlczMyIGhhc2gzID0gc2hhMyggTnVtYmVyc1sxXSwgTnVtYmVyc1syXSk7CgkJZ2FtZXNbY3VycmVudEdhbWVdLmhpdDNIYXNoW2hhc2gwXSsrOwoJCWdhbWVzW2N1cnJlbnRHYW1lXS5oaXQySGFzaFtoYXNoMV0rKzsKCQlnYW1lc1tjdXJyZW50R2FtZV0uaGl0Mkhhc2hbaGFzaDJdKys7CgkJZ2FtZXNbY3VycmVudEdhbWVdLmhpdDJIYXNoW2hhc2gzXSsrOwoJCXBsYXllcnNbbXNnLnNlbmRlcl0uZ2FtZXNbY3VycmVudEdhbWVdLm51bWJlcnNCeXRlcy5wdXNoICggZ2V0Qnl0ZXNGcm9tTnVtYmVycyhOdW1iZXJzKSApOwoJCXBsYXllcnNbbXNnLnNlbmRlcl0uZ2FtZXNbY3VycmVudEdhbWVdLmhpdDNIYXNoW2hhc2gwXSsrOwoJCXBsYXllcnNbbXNnLnNlbmRlcl0uZ2FtZXNbY3VycmVudEdhbWVdLmhpdDJIYXNoW2hhc2gxXSsrOwoJCXBsYXllcnNbbXNnLnNlbmRlcl0uZ2FtZXNbY3VycmVudEdhbWVdLmhpdDJIYXNoW2hhc2gyXSsrOwoJCXBsYXllcnNbbXNnLnNlbmRlcl0uZ2FtZXNbY3VycmVudEdhbWVdLmhpdDJIYXNoW2hhc2gzXSsrOwoJCU5ld1RpY2tldEV2ZW50KCBtc2cuc2VuZGVyLCBOdW1iZXJzWzBdLCBOdW1iZXJzWzFdLCBOdW1iZXJzWzJdICk7Cgl9CglmdW5jdGlvbiBDaGVja1RpY2tldHMoKSBleHRlcm5hbCBub0V0aGVyIG5vQ29udHJhY3QgewoJCXVpbnQgX3ZhbHVlOwoJCXVpbnQgX3N1YlZhbHVlOwoJCXVpbnQgZ2FtZUlEOwoJCXVpbnQgZ2FtZUxvd0lEOwoJCXVpbnQ4WzNdIG1lbW9yeSBudW1iZXJzOwoJCWJvb2wgY2hhbmdlZDsKCQl1aW50IGhpdDNDb3VudDsKCQl1aW50IGhpdDJDb3VudDsKCQlmb3IgKCBnYW1lSUQ9Y3VycmVudEdhbWUgOyBnYW1lSUQ+PTAgOyBnYW1lSUQtLSApIHsKCQkJaWYgKCAhIHBsYXllcnNbbXNnLnNlbmRlcl0uZ2FtZXNbZ2FtZUlEXS5jaGVja2VkKSB7CgkJCQlpZiAoZ2FtZXNbZ2FtZUlEXS5kcmF3RG9uZSkgewoJCQkJCW51bWJlcnMgPSBnZXROdW1iZXJzRnJvbUJ5dGVzKGdhbWVzW2dhbWVJRF0ud2lubmluZ051bWJlcnNCeXRlcyk7CgkJCQkJaGl0M0NvdW50ID0gcGxheWVyc1ttc2cuc2VuZGVyXS5nYW1lc1tnYW1lSURdLmhpdDNIYXNoW3NoYTMoIG51bWJlcnNbMF0sIG51bWJlcnNbMV0sIG51bWJlcnNbMl0gKV07CgkJCQkJX3N1YlZhbHVlICs9IGhpdDNDb3VudCAqIGdhbWVzW2dhbWVJRF0uaGl0M1ZhbHVlOwoJCQkJCWhpdDJDb3VudCA9IHBsYXllcnNbbXNnLnNlbmRlcl0uZ2FtZXNbZ2FtZUlEXS5oaXQySGFzaFtzaGEzKCBudW1iZXJzWzBdLCBudW1iZXJzWzFdICldOwoJCQkJCWhpdDJDb3VudCArPSBwbGF5ZXJzW21zZy5zZW5kZXJdLmdhbWVzW2dhbWVJRF0uaGl0Mkhhc2hbc2hhMyggbnVtYmVyc1swXSwgbnVtYmVyc1syXSApXTsKCQkJCQloaXQyQ291bnQgKz0gcGxheWVyc1ttc2cuc2VuZGVyXS5nYW1lc1tnYW1lSURdLmhpdDJIYXNoW3NoYTMoIG51bWJlcnNbMV0sIG51bWJlcnNbMl0gKV07CgkJCQkJaGl0MkNvdW50IC09IGhpdDNDb3VudCozOwoJCQkJCV9zdWJWYWx1ZSArPSBoaXQyQ291bnQgKiBnYW1lc1tnYW1lSURdLmhpdDJWYWx1ZTsKCQkJCQlnYW1lc1tnYW1lSURdLnByaXplUG90IC09IF9zdWJWYWx1ZTsKCQkJCQlfdmFsdWUgKz0gX3N1YlZhbHVlOwoJCQkJCXBsYXllcnNbbXNnLnNlbmRlcl0uZ2FtZXNbZ2FtZUlEXS5jaGVja2VkID0gdHJ1ZTsKCQkJCQljaGFuZ2VkID0gdHJ1ZTsKCQkJCX0gZWxzZSBpZiAoICEgY29udHJhY3RFbmFibGVkICYmIGdhbWVJRCA9PSBjdXJyZW50R2FtZSkgewoJCQkJCV92YWx1ZSArPSBwbGF5ZXJzW21zZy5zZW5kZXJdLmdhbWVzW2dhbWVJRF0ubnVtYmVyc0J5dGVzLmxlbmd0aCAqIHRpY2tldFByaWNlOwoJCQkJCXBsYXllcnNbbXNnLnNlbmRlcl0uZ2FtZXNbZ2FtZUlEXS5jaGVja2VkID0gdHJ1ZTsKCQkJCQljaGFuZ2VkID0gdHJ1ZTsKCQkJCX0KCQkJfQoJCQlpZiAoZ2FtZUlEID09IDAgfHwgZ2FtZUlELXByaXplRGlzbWlzc0RlbGF5ID09IGdhbWVJRCkgeyBicmVhazsgfQoJCX0KCQlpZiAoICEgY2hhbmdlZCkgeyB0aHJvdzsgfQoJCWlmIChfdmFsdWUgPiAwKSB7IGlmICggISBtc2cuc2VuZGVyLnNlbmQoX3ZhbHVlKSkgeyB0aHJvdzsgfSB9Cgl9CgkvKiBleHRlcm5hbCBmdW5jdGlvbnMgZm9yIGludmVzdG9ycyAqLwoJZnVuY3Rpb24gSW52ZXN0QWRkKCkgZXh0ZXJuYWwgT25seUVuYWJsZWQgbm9Db250cmFjdCB7CgkJdWludCB2YWx1ZV8gPSBtc2cudmFsdWU7CgkJaWYgKHZhbHVlXyA8IGludmVzdFVuaXQpIHsgdGhyb3c7IH0KCQlpZiAodmFsdWVfICUgaW52ZXN0VW5pdCA+IDApIHsgCgkJCWlmICggISBtc2cuc2VuZGVyLnNlbmQoIHZhbHVlXyAlIGludmVzdFVuaXQgKSkgeyB0aHJvdzsgfSAKCQkJdmFsdWVfID0gdmFsdWVfIC0gKHZhbHVlXyAlIGludmVzdFVuaXQpOwoJCX0KCQlpZiAodmFsdWVfIDwgaW52ZXN0TWluaW11bSkgeyB0aHJvdzsgfQoJCXZhciAoZm91bmQsIEludmVzdG9ySUQpID0gZ2V0SW52ZXN0b3JCeUFkZHJlc3MobXNnLnNlbmRlcik7CgkJaWYgKGZvdW5kID09IGZhbHNlKSB7CgkJCWlmIChpbnZlc3RvcnMubGVuZ3RoID09IGludmVzdFVzZXJMaW1pdCkgeyB0aHJvdzsgfQoJCQlJbnZlc3RvcklEID0gaW52ZXN0b3JzLmxlbmd0aDsKCQkJaW52ZXN0b3JzLmxlbmd0aCsrOwoJCX0KCQlpZiAoaW52ZXN0b3JzW0ludmVzdG9ySURdLnZhbGlkICYmIGludmVzdG9yc1tJbnZlc3RvcklEXS5saXZlKSB7CgkJCWludmVzdG9yc1tJbnZlc3RvcklEXS52YWx1ZSArPSB2YWx1ZV87CgkJfSBlbHNlIHsKCQkJaW52ZXN0b3JzW0ludmVzdG9ySURdLnZhbHVlID0gdmFsdWVfOwoJCX0KCQlpbnZlc3RvcnNbSW52ZXN0b3JJRF0uYmVnaW5zID0gY3VycmVudEdhbWU7CgkJaW52ZXN0b3JzW0ludmVzdG9ySURdLnZhbGlkID0gdHJ1ZTsKCQlpbnZlc3RvcnNbSW52ZXN0b3JJRF0ubGl2ZSA9IHRydWU7CgkJaW52ZXN0b3JzW0ludmVzdG9ySURdLm93bmVyID0gbXNnLnNlbmRlcjsKCQlpbnZlc3RtZW50c1ZhbHVlICs9IHZhbHVlXzsKCQlzZXRKYWNrcG90KCk7CgkJSW52ZXN0QWRkRXZlbnQobXNnLnNlbmRlciwgdmFsdWVfKTsKCX0KCWZ1bmN0aW9uIEludmVzdFdpdGhkcmF3KCkgZXh0ZXJuYWwgbm9FdGhlciB7CgkJdmFyIChmb3VuZCwgSW52ZXN0b3JJRCkgPSBnZXRJbnZlc3RvckJ5QWRkcmVzcyhtc2cuc2VuZGVyKTsKCQlpZiAoZm91bmQgPT0gZmFsc2UpIHsgdGhyb3c7IH0KCQlpZiAoICEgaW52ZXN0b3JzW0ludmVzdG9ySURdLnZhbGlkKSB7IHRocm93OyB9CgkJdWludCBfYmFsYW5jZSA9IGludmVzdG9yc1tJbnZlc3RvcklEXS5iYWxhbmNlOwoJCWlmIChfYmFsYW5jZSA9PSAwKSB7IHRocm93OyB9CgkJaW52ZXN0b3JzW0ludmVzdG9ySURdLmJhbGFuY2UgPSAwOwoJCWlmICggISBtc2cuc2VuZGVyLnNlbmQoIF9iYWxhbmNlICkpIHsgdGhyb3c7IH0KCX0KCWZ1bmN0aW9uIEludmVzdENhbmNlbCgpIGV4dGVybmFsIG5vRXRoZXIgewoJCXZhciAoZm91bmQsIEludmVzdG9ySUQpID0gZ2V0SW52ZXN0b3JCeUFkZHJlc3MobXNnLnNlbmRlcik7CgkJaWYgKGZvdW5kID09IGZhbHNlKSB7IHRocm93OyB9CgkJaWYgKCAhIGludmVzdG9yc1tJbnZlc3RvcklEXS52YWxpZCkgeyB0aHJvdzsgfQoJCWlmIChjb250cmFjdEVuYWJsZWQpIHsKCQkJaWYgKGludmVzdG9yc1tJbnZlc3RvcklEXS5iZWdpbnMraW52ZXN0TWluRHVyYXRpb24gPCBub3cpIHsgdGhyb3c7IH0KCQkJaWYgKGdhbWVzW2N1cnJlbnRHYW1lXS5zdGFydFRpbWVzdGFtcCtpbnZlc3RJZGxlVGltZSA8IG5vdykgeyB0aHJvdzsgfQoJCX0KCQl1aW50IGJhbGFuY2VfOwoJCWlmIChpbnZlc3RvcnNbSW52ZXN0b3JJRF0ubGl2ZSkgewoJCQlpbnZlc3RtZW50c1ZhbHVlIC09IGludmVzdG9yc1tJbnZlc3RvcklEXS52YWx1ZTsKCQkJYmFsYW5jZV8gPSBpbnZlc3RvcnNbSW52ZXN0b3JJRF0udmFsdWU7CgkJCXNldEphY2twb3QoKTsKCQkJSW52ZXN0Q2FuY2VsRXZlbnQobXNnLnNlbmRlciwgaW52ZXN0b3JzW0ludmVzdG9ySURdLnZhbHVlKTsKCQl9CgkJaWYgKGludmVzdG9yc1tJbnZlc3RvcklEXS5iYWxhbmNlID4gMCkgewoJCQliYWxhbmNlXyArPSBpbnZlc3RvcnNbSW52ZXN0b3JJRF0uYmFsYW5jZTsKCQl9CgkJZGVsZXRlIGludmVzdG9yc1tJbnZlc3RvcklEXTsKCQlpZiAoICEgbXNnLnNlbmRlci5zZW5kKCBiYWxhbmNlXyApKSB7IHRocm93OyB9Cgl9CgkvKiBkcmF3IGZ1bmN0aW9ucyBmb3IgZXZlcnlvbmUqLwoJZnVuY3Rpb24gRHJhd1ByZXBhcmUoKSBub0NvbnRyYWN0IE9ubHlFbmFibGVkIG5vRXRoZXIgewoJCWlmIChnYW1lc1tjdXJyZW50R2FtZV0uZW5kVGltZXN0YW1wID4gbm93IHx8IGdhbWVzW2N1cnJlbnRHYW1lXS5wcmVwYXJlQmxvY2sgIT0gMCkgeyB0aHJvdzsgfQoJCWdhbWVzW2N1cnJlbnRHYW1lXS5wcmVwYXJlQmxvY2sgPSBibG9jay5udW1iZXIrZHJhd0Jsb2NrRGVsYXk7CgkJRHJhd1ByZXBhcmVFdmVudChnYW1lc1tjdXJyZW50R2FtZV0ucHJlcGFyZUJsb2NrKTsKCX0KCWZ1bmN0aW9uIERyYXcoKSBub0NvbnRyYWN0IE9ubHlFbmFibGVkIG5vRXRoZXIgewoJCWlmIChnYW1lc1tjdXJyZW50R2FtZV0ucHJlcGFyZUJsb2NrID09IDAgfHwgZ2FtZXNbY3VycmVudEdhbWVdLnByZXBhcmVCbG9jayA+IGJsb2NrLm51bWJlcikgeyB0aHJvdzsgfQoJCWJ5dGVzMzIgX2hhc2g7CgkJdWludCBoaXQzVmFsdWU7CgkJdWludCBoaXQzQ291bnQ7CgkJdWludCBoaXQyVmFsdWU7CgkJdWludCBoaXQyQ291bnQ7CgkJdWludCBhOwoJCWZvciAoIGEgPSAxIDsgYSA8PSBkcmF3QmxvY2tEZWxheSA7IGErKyApIHsKCQkJX2hhc2ggPSBzaGEzKF9oYXNoLCBibG9jay5ibG9ja2hhc2goZ2FtZXNbY3VycmVudEdhbWVdLnByZXBhcmVCbG9jayAtIGRyYXdCbG9ja0RlbGF5K2EpKTsKCQl9CgkJdmFyIG51bWJlcnMgPSBnZXROdW1iZXJzRnJvbUhhc2goX2hhc2gpOwoJCWdhbWVzW2N1cnJlbnRHYW1lXS53aW5uaW5nTnVtYmVyc0J5dGVzID0gZ2V0Qnl0ZXNGcm9tTnVtYmVycyggbnVtYmVycyApOwoJCWhpdDNDb3VudCArPSBnYW1lc1tjdXJyZW50R2FtZV0uaGl0M0hhc2hbIHNoYTMoIG51bWJlcnNbMF0sIG51bWJlcnNbMV0sbnVtYmVyc1syXSApIF07CgkJaGl0MkNvdW50ICs9IGdhbWVzW2N1cnJlbnRHYW1lXS5oaXQySGFzaFsgc2hhMyggbnVtYmVyc1swXSwgbnVtYmVyc1sxXSkgXTsKCQloaXQyQ291bnQgKz0gZ2FtZXNbY3VycmVudEdhbWVdLmhpdDJIYXNoWyBzaGEzKCBudW1iZXJzWzBdLCBudW1iZXJzWzJdKSBdOwoJCWhpdDJDb3VudCArPSBnYW1lc1tjdXJyZW50R2FtZV0uaGl0Mkhhc2hbIHNoYTMoIG51bWJlcnNbMV0sIG51bWJlcnNbMl0pIF07CgkJaGl0MkNvdW50IC09IGhpdDNDb3VudCozOwoJCXVpbnQgdG90YWxQb3QgPSBnYW1lc1tjdXJyZW50R2FtZV0udGlja2V0c0NvdW50KnRpY2tldFByaWNlOwoJCWhpdDJWYWx1ZSA9ICggdG90YWxQb3QgKiBmb3JIaXQyIC8gMTAwICk7CgkJaWYgKGhpdDJDb3VudCA+IDApIHsKCQkJZ2FtZXNbY3VycmVudEdhbWVdLnByaXplUG90ID0gaGl0MlZhbHVlOwoJCX0KCQloaXQyVmFsdWUgPSBoaXQyVmFsdWUgLyBoaXQyQ291bnQ7CgkJdG90YWxQb3QgLT0gaGl0MlZhbHVlOwoJCXVpbnQgX293bmVyQmFsYW5jZSA9IHRvdGFsUG90ICogZm9yT3duZXIgLyAxMDA7CgkJdG90YWxQb3QgLT0gX293bmVyQmFsYW5jZTsKCQlvd25lckJhbGFuY2UgKz0gX293bmVyQmFsYW5jZTsKCQl1aW50IF9hZGRJbnZlc3RvcnNWYWx1ZSA9IHRvdGFsUG90ICogZm9ySW52ZXN0b3JzIC8gMTAwOwoJCWFkZEludmVzdG9yc1ZhbHVlKF9hZGRJbnZlc3RvcnNWYWx1ZSk7CgkJdG90YWxQb3QgLT0gX2FkZEludmVzdG9yc1ZhbHVlOwoJCWlmIChoaXQzQ291bnQgPiAwKSB7CgkJCWdhbWVzW2N1cnJlbnRHYW1lXS5wcml6ZVBvdCArPSBjdXJyZW50SmFja3BvdDsKCQkJZm9yICggYT0wIDsgYSA8IGludmVzdG9ycy5sZW5ndGggOyBhKysgKSB7CgkJCQlkZWxldGUgaW52ZXN0b3JzW2FdLmxpdmU7CgkJCX0KCQkJaGl0M1ZhbHVlID0gY3VycmVudEphY2twb3QgLyBoaXQzQ291bnQ7CgkJCWV4dHJhSmFja3BvdCA9IDA7CgkJCWludmVzdG1lbnRzVmFsdWUgPSAwOwoJCX0KCQlleHRyYUphY2twb3QgKz0gdG90YWxQb3Q7CgkJc2V0SmFja3BvdCgpOwoJCURyYXdFdmVudChjdXJyZW50R2FtZStvbGRDb250cmFjdExhc3RHYW1lLCBudW1iZXJzWzBdLCBudW1iZXJzWzFdLCBudW1iZXJzWzJdLCBoaXQzQ291bnQsIGhpdDNWYWx1ZSwgaGl0MkNvdW50LCBoaXQyVmFsdWUpOwoJCVdMQkRyYXdzREIoIFdMQmRyYXdzREJBZGRyICkubmV3RHJhdyggbm93LCBudW1iZXJzLCBoaXQzQ291bnQsIGhpdDNWYWx1ZSwgaGl0MkNvdW50LCBoaXQyVmFsdWUpOwoJCWdhbWVzW2N1cnJlbnRHYW1lXS5oaXQzQ291bnQgPSBoaXQzQ291bnQ7CgkJZ2FtZXNbY3VycmVudEdhbWVdLmhpdDNWYWx1ZSA9IGhpdDNWYWx1ZTsKCQlnYW1lc1tjdXJyZW50R2FtZV0uaGl0MkNvdW50ID0gaGl0MkNvdW50OwoJCWdhbWVzW2N1cnJlbnRHYW1lXS5oaXQyVmFsdWUgPSBoaXQyVmFsdWU7CgkJZ2FtZXNbY3VycmVudEdhbWVdLmRyYXdEb25lID0gdHJ1ZTsKCQluZXdHYW1lKCk7Cgl9CgkvKiBvd25lciBmdW5jdGlvbnMgKi8KCWZ1bmN0aW9uIE93bmVyR2V0RmVlKCkgZXh0ZXJuYWwgT25seU93bmVyIHsKCQlpZiAob3duZXJCYWxhbmNlID09IDApIHsgdGhyb3c7IH0KCQlpZiAob3duZXIuc2VuZChvd25lckJhbGFuY2UpID09IGZhbHNlKSB7IHRocm93OyB9CgkJb3duZXJCYWxhbmNlID0gMDsKCX0KCWZ1bmN0aW9uIE93bmVyQ2xvc2VDb250cmFjdCgpIGV4dGVybmFsIE9ubHlPd25lciBub0V0aGVyIHsKCQlpZiAoICEgY29udHJhY3RFbmFibGVkKSB7CgkJCWlmIChjb250cmFjdERpc2FibGVkVGltZVN0YW1wK2NvbnRyYWN0RGlzbWlzc0RlbGF5IDwgbm93KSB7CgkJCQlzdWljaWRlKG93bmVyKTsKCQkJfQoJCX0gZWxzZSB7CgkJCWNvbnRyYWN0RW5hYmxlZCA9IGZhbHNlOwoJCQljb250cmFjdERpc2FibGVkVGltZVN0YW1wID0gbm93OwoJCQlDb250cmFjdERpc2FibGVkRXZlbnQoY29udHJhY3REaXNhYmxlZFRpbWVTdGFtcCtjb250cmFjdERpc21pc3NEZWxheSk7CgkJCW93bmVyQmFsYW5jZSArPSBleHRyYUphY2twb3Q7CgkJCWV4dHJhSmFja3BvdCA9IDA7CgkJCWdhbWVzW2N1cnJlbnRHYW1lXS5wcml6ZVBvdCA9IGdhbWVzW2N1cnJlbnRHYW1lXS50aWNrZXRzQ291bnQqdGlja2V0UHJpY2U7CgkJfQoJfQoJLyogcHJpdmF0ZSBmdW5jdGlvbnMgKi8KCWZ1bmN0aW9uIGFkZEludmVzdG9yc1ZhbHVlKHVpbnQgdmFsdWUpIHByaXZhdGUgewoJCWJvb2wgZG9uZTsKCQl1aW50IGE7CgkJZm9yICggYT0wIDsgYSA8IGludmVzdG9ycy5sZW5ndGggOyBhKysgKSB7CgkJCWlmIChpbnZlc3RvcnNbYV0ubGl2ZSAmJiBpbnZlc3RvcnNbYV0udmFsaWQpIHsKCQkJCWludmVzdG9yc1thXS5iYWxhbmNlICs9IHZhbHVlICogaW52ZXN0b3JzW2FdLnZhbHVlIC8gaW52ZXN0bWVudHNWYWx1ZTsKCQkJCWRvbmUgPSB0cnVlOwoJCQl9CgkJfQoJCWlmICggISBkb25lKSB7CgkJCW93bmVyQmFsYW5jZSArPSB2YWx1ZTsKCQl9Cgl9CglmdW5jdGlvbiBuZXdHYW1lKCkgcHJpdmF0ZSB7CgkJdmFyIG5leHREcmF3ID0gZ2FtZXNbY3VycmVudEdhbWVdLmVuZFRpbWVzdGFtcCAgKyAxIHdlZWtzOwoJCWN1cnJlbnRHYW1lKys7CgkJdWludCBnYW1lc0lEID0gZ2FtZXMubGVuZ3RoOwoJCWdhbWVzLmxlbmd0aCsrOwoJCWdhbWVzW2dhbWVzSURdLnN0YXJ0VGltZXN0YW1wID0gbm93OwoJCWdhbWVzW2dhbWVzSURdLmVuZFRpbWVzdGFtcCA9IG5leHREcmF3OwoJCWlmIChnYW1lcy5sZW5ndGggPiBwcml6ZURpc21pc3NEZWxheSkgewoJCQlvd25lckJhbGFuY2UgKz0gZ2FtZXNbY3VycmVudEdhbWUtcHJpemVEaXNtaXNzRGVsYXldLnByaXplUG90OwoJCQlkZWxldGUgZ2FtZXNbY3VycmVudEdhbWUtcHJpemVEaXNtaXNzRGVsYXldOwoJCX0KCX0KCWZ1bmN0aW9uIGdldE51bWJlcnNGcm9tSGFzaChieXRlczMyIGhhc2gpIHByaXZhdGUgcmV0dXJucyAodWludDhbM10gbnVtYmVycykgewoJCWJvb2wgb2sgPSB0cnVlOwoJCXVpbnQ4IG51bSA9IDA7CgkJdWludCBoYXNocG9zID0gMDsKCQl1aW50OCBhOwoJCXVpbnQ4IGI7CgkJZm9yIChhID0gMCA7IGEgPCBudW1iZXJzLmxlbmd0aCA7IGErKykgewoJCQl3aGlsZSAodHJ1ZSkgewoJCQkJb2sgPSB0cnVlOwoJCQkJaWYgKGhhc2hwb3MgPT0gMzIpIHsKCQkJCQloYXNocG9zID0gMDsKCQkJCQloYXNoID0gc2hhMyhoYXNoKTsKCQkJCX0KCQkJCW51bSA9IGdldFBhcnQoIGhhc2gsIGhhc2hwb3MgKTsKCQkJCW51bSA9IG51bSAlIHVpbnQ4KGRyYXdNYXhOdW1iZXIpICsgMTsKCQkJCWhhc2hwb3MgKz0gMTsKCQkJCWZvciAoYiA9IDAgOyBiIDwgbnVtYmVycy5sZW5ndGggOyBiKyspIHsKCQkJCQlpZiAobnVtYmVyc1tiXSA9PSBudW0pIHsKCQkJCQkJb2sgPSBmYWxzZTsKCQkJCQkJYnJlYWs7IAoJCQkJCX0KCQkJCX0KCQkJCWlmIChvayA9PSB0cnVlKSB7CgkJCQkJbnVtYmVyc1thXSA9IG51bTsKCQkJCQlicmVhazsKCQkJCX0KCQkJfQoJCX0KCQludW1iZXJzID0gc29ydE51bWJlcnMoIG51bWJlcnMgKTsKCX0KCWZ1bmN0aW9uIGdldFBhcnQoYnl0ZXMzMiBhLCB1aW50IGkpIHByaXZhdGUgcmV0dXJucyAodWludDgpIHsgcmV0dXJuIHVpbnQ4KGJ5dGUoYnl0ZXMzMih1aW50KGEpICogMiAqKiAoOCAqIGkpKSkpOyB9CglmdW5jdGlvbiBzZXRKYWNrcG90KCkgcHJpdmF0ZSB7CgkJY3VycmVudEphY2twb3QgPSBpbnZlc3RtZW50c1ZhbHVlICsgZXh0cmFKYWNrcG90OwoJfQoJZnVuY3Rpb24gZ2V0SW52ZXN0b3JCeUFkZHJlc3MoYWRkcmVzcyBBZGRyZXNzKSBwcml2YXRlIHJldHVybnMgKGJvb2wgZm91bmQsIHVpbnQgaWQpIHsKCQlmb3IgKCBpZD0wIDsgaWQgPCBpbnZlc3RvcnMubGVuZ3RoIDsgaWQrKyApIHsKCQkJaWYgKGludmVzdG9yc1tpZF0ub3duZXIgPT0gQWRkcmVzcykgewoJCQkJcmV0dXJuICh0cnVlLCBpZCk7CgkJCX0KCQl9CgkJcmV0dXJuIChmYWxzZSwgMCk7Cgl9CglmdW5jdGlvbiBjaGVja051bWJlcnModWludDhbM10gTnVtYmVycykgcHJpdmF0ZSByZXR1cm5zIChib29sKSB7CgkJZm9yICggdWludCBhID0gMCA7IGEgPCBOdW1iZXJzLmxlbmd0aCA7IGErKyApIHsKCQkJaWYgKE51bWJlcnNbYV0gPiBkcmF3TWF4TnVtYmVyIHx8IE51bWJlcnNbYV0gPT0gMCkgeyByZXR1cm47IH0KCQkJZm9yICggdWludCBiID0gMCA7IGEgPCBOdW1iZXJzLmxlbmd0aCA7IGErKyApIHsKCQkJCWlmIChhICE9IGIgJiYgTnVtYmVyc1thXSA9PSBOdW1iZXJzW2JdKSB7IHJldHVybjsgfQoJCQl9CgkJfQoJCXJldHVybiB0cnVlOwoJfQoJZnVuY3Rpb24gc29ydE51bWJlcnModWludDhbM10gbnVtYmVycykgcHJpdmF0ZSByZXR1cm5zKHVpbnQ4WzNdIHNOdW1iZXJzKSB7CgkJc051bWJlcnMgPSBudW1iZXJzOwoJCWZvciAodWludDggaT0wOyBpPG51bWJlcnMubGVuZ3RoOyBpKyspIHsKCQkJZm9yICh1aW50OCBqPWkrMTsgajxudW1iZXJzLmxlbmd0aDsgaisrKSB7CgkJCQlpZiAoc051bWJlcnNbaV0gPiBzTnVtYmVyc1tqXSkgewoJCQkJCXVpbnQ4IHQgPSBzTnVtYmVyc1tpXTsKCQkJCQlzTnVtYmVyc1tpXSA9IHNOdW1iZXJzW2pdOwoJCQkJCXNOdW1iZXJzW2pdID0gdDsKCQkJCX0KCQkJfQoJCX0KCX0KCWZ1bmN0aW9uIGdldE51bWJlcnNGcm9tQnl0ZXMoYnl0ZXMzIEJ5dGVzKSBwcml2YXRlIHJldHVybnMgKHVpbnQ4WzNdIE51bWJlcnMpewoJCU51bWJlcnNbMF0gPSB1aW50OChCeXRlcyk7CgkJTnVtYmVyc1sxXSA9IHVpbnQ4KHVpbnQyNChCeXRlcykgLzI1Nik7CgkJTnVtYmVyc1syXSA9IHVpbnQ4KHVpbnQyNChCeXRlcykgLzI1Ni8yNTYpOwoJfQoJZnVuY3Rpb24gZ2V0Qnl0ZXNGcm9tTnVtYmVycyh1aW50OFszXSBOdW1iZXJzKSBwcml2YXRlIHJldHVybnMgKGJ5dGVzMyBCeXRlcykgewoJCXJldHVybiBieXRlczModWludChOdW1iZXJzWzBdKSt1aW50KE51bWJlcnNbMV0pKjI1Nit1aW50KE51bWJlcnNbMl0pKjI1NioyNTYpOwoJfQoJLyogbW9kaWZpZXJzICovCgltb2RpZmllciBub0NvbnRyYWN0KCkge2lmICh0eC5vcmlnaW4gIT0gbXNnLnNlbmRlcikgeyB0aHJvdzsgfSBfOyB9CW1vZGlmaWVyIG5vRXRoZXIoKSB7IGlmIChtc2cudmFsdWUgPiAwKSB7IHRocm93OyB9IF87IH0JbW9kaWZpZXIgT25seU93bmVyKCkgeyBpZiAob3duZXIgIT0gbXNnLnNlbmRlcikgeyB0aHJvdzsgfSBfOyB9CW1vZGlmaWVyIE9ubHlFbmFibGVkKCkgeyBpZiAoICEgY29udHJhY3RFbmFibGVkKSB7IHRocm93OyB9IF87IH19'.
	

]
