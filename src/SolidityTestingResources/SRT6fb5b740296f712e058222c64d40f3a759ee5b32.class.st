Class {
	#name : #SRT6fb5b740296f712e058222c64d40f3a759ee5b32,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT6fb5b740296f712e058222c64d40f3a759ee5b32 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovLyBGaWxlOiBzcmMvVG9rZW4vRmFsbGJhY2tUb2tlbi5zb2wKCi8qKgogKiBAdGl0bGUgRmFsbGJhY2tUb2tlbiB0b2tlbgogKgogKiBAZGV2IGFkZCBFUkMyMjMgc3RhbmRhcmQgYWJpbGl0eQogKiovCmNvbnRyYWN0IEZhbGxiYWNrVG9rZW4gewoKICBmdW5jdGlvbiBpc0NvbnRyYWN0KGFkZHJlc3MgX2FkZHIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgIHVpbnQgbGVuZ3RoOwogICAgX2FkZHIgPSBfYWRkcjsKICAgIGFzc2VtYmx5IHtsZW5ndGggOj0gZXh0Y29kZXNpemUoX2FkZHIpfQogICAgcmV0dXJuIChsZW5ndGggPiAwKTsKICB9Cn0KCgpjb250cmFjdCBSZWNlaXZlciB7CiAgZnVuY3Rpb24gdG9rZW5GYWxsYmFjayhhZGRyZXNzIGZyb20sIHVpbnQgdmFsdWUpIHB1YmxpYzsKfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL293bmVyc2hpcC9Pd25hYmxlLnNvbAoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL21hdGgvU2FmZU1hdGguc29sCgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKGEgPT0gMCkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgovLyBGaWxlOiB6ZXBwZWxpbi1zb2xpZGl0eS9jb250cmFjdHMvdG9rZW4vRVJDMjBCYXNpYy5zb2wKCi8qKgogKiBAdGl0bGUgRVJDMjBCYXNpYwogKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE3OQogKi8KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCi8vIEZpbGU6IHplcHBlbGluLXNvbGlkaXR5L2NvbnRyYWN0cy90b2tlbi9CYXNpY1Rva2VuLnNvbAoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cgp9CgovLyBGaWxlOiB6ZXBwZWxpbi1zb2xpZGl0eS9jb250cmFjdHMvdG9rZW4vRVJDMjAuc29sCgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgovLyBGaWxlOiB6ZXBwZWxpbi1zb2xpZGl0eS9jb250cmFjdHMvdG9rZW4vU3RhbmRhcmRUb2tlbi5zb2wKCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CgoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqLwogIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9CgovLyBGaWxlOiB6ZXBwZWxpbi1zb2xpZGl0eS9jb250cmFjdHMvdG9rZW4vTWludGFibGVUb2tlbi5zb2wKCi8qKgogKiBAdGl0bGUgTWludGFibGUgdG9rZW4KICogQGRldiBTaW1wbGUgRVJDMjAgVG9rZW4gZXhhbXBsZSwgd2l0aCBtaW50YWJsZSB0b2tlbiBjcmVhdGlvbgogKiBAZGV2IElzc3VlOiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvaXNzdWVzLzEyMAogKiBCYXNlZCBvbiBjb2RlIGJ5IFRva2VuTWFya2V0TmV0OiBodHRwczovL2dpdGh1Yi5jb20vVG9rZW5NYXJrZXROZXQvaWNvL2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy9NaW50YWJsZVRva2VuLnNvbAogKi8KCmNvbnRyYWN0IE1pbnRhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZSB7CiAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKICBldmVudCBNaW50RmluaXNoZWQoKTsKCiAgYm9vbCBwdWJsaWMgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CgoKICBtb2RpZmllciBjYW5NaW50KCkgewogICAgcmVxdWlyZSghbWludGluZ0ZpbmlzaGVkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIG1pbnQgdG9rZW5zCiAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgbWludGVkIHRva2Vucy4KICAgKiBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAqIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoX2Ftb3VudCk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICBNaW50KF90bywgX2Ftb3VudCk7CiAgICBUcmFuc2ZlcihhZGRyZXNzKDApLCBfdG8sIF9hbW91bnQpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHN0b3AgbWludGluZyBuZXcgdG9rZW5zLgogICAqIEByZXR1cm4gVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgIE1pbnRGaW5pc2hlZCgpOwogICAgcmV0dXJuIHRydWU7CiAgfQp9CgovLyBGaWxlOiBzcmMvVG9rZW4vVHJ1c3RhQml0VG9rZW4uc29sCgovKioKICogQHRpdGxlIFNpbXBsZVRva2VuCiAqIEBkZXYgVmVyeSBzaW1wbGUgRVJDMjAgVG9rZW4gZXhhbXBsZSwgd2hlcmUgYWxsIHRva2VucyBhcmUgcHJlLWFzc2lnbmVkIHRvIHRoZSBjcmVhdG9yLgogKiBOb3RlIHRoZXkgY2FuIGxhdGVyIGRpc3RyaWJ1dGUgdGhlc2UgdG9rZW5zIGFzIHRoZXkgd2lzaCB1c2luZyBgdHJhbnNmZXJgIGFuZCBvdGhlcgogKiBgU3RhbmRhcmRUb2tlbmAgZnVuY3Rpb25zLgogKi8KY29udHJhY3QgVHJ1c3RhQml0VG9rZW4gaXMgTWludGFibGVUb2tlbiwgRmFsbGJhY2tUb2tlbiB7CgogIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJUcnVzdGFCaXRzIjsKCiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiVEFCIjsKCiAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKCiAgYm9vbCBwdWJsaWMgcmVsZWFzZWQgPSBmYWxzZTsKCiAgZXZlbnQgUmVsZWFzZSgpOwoKICBtb2RpZmllciBpc1JlbGVhc2VkICgpIHsKICAgIHJlcXVpcmUobWludGluZ0ZpbmlzaGVkKTsKICAgIHJlcXVpcmUocmVsZWFzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAgKiBGaXggZm9yIHRoZSBFUkMyMCBzaG9ydCBhZGRyZXNzIGF0dGFjawogICAgKiBodHRwOi8vdmVzc2VuZXMuY29tL3RoZS1lcmMyMC1zaG9ydC1hZGRyZXNzLWF0dGFjay1leHBsYWluZWQvCiAgICAqLwogIG1vZGlmaWVyIG9ubHlQYXlsb2FkU2l6ZSh1aW50IHNpemUpIHsKICAgIGlmIChtc2cuZGF0YS5sZW5ndGggIT0gc2l6ZSArIDQpIHsKICAgICAgcmV2ZXJ0KCk7CiAgICB9CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBDb25zdHJ1Y3RvciB0aGF0IGdpdmVzIG1zZy5zZW5kZXIgYWxsIG9mIGV4aXN0aW5nIHRva2Vucy5LCiAgICovCiAgLy8vIGZ1bmN0aW9uIFRydXN0YUJpdHNUb2tlbigpIHB1YmxpYyB7fQoKICAvKioKICAgKiBAZGV2IEZhbGxiYWNrIG1ldGhvZCB3aWxsIGJ1eW91dCB0b2tlbnMKICAgKi8KICBmdW5jdGlvbigpIHB1YmxpYyBwYXlhYmxlIHsKICAgIHJldmVydCgpOwogIH0KCiAgZnVuY3Rpb24gcmVsZWFzZSgpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShtaW50aW5nRmluaXNoZWQpOwogICAgcmVxdWlyZSghcmVsZWFzZWQpOwogICAgcmVsZWFzZWQgPSB0cnVlOwogICAgUmVsZWFzZSgpOwoKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgaXNSZWxlYXNlZCBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKSk7CgogICAgaWYgKGlzQ29udHJhY3QoX3RvKSkgewogICAgICBSZWNlaXZlcihfdG8pLnRva2VuRmFsbGJhY2sobXNnLnNlbmRlciwgX3ZhbHVlKTsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyBpc1JlbGVhc2VkIHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyBpc1JlbGVhc2VkIHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBzdXBlci5hcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgaXNSZWxlYXNlZCBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJldHVybiBzdXBlci5pbmNyZWFzZUFwcHJvdmFsKF9zcGVuZGVyLCBfYWRkZWRWYWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIGlzUmVsZWFzZWQgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICByZXR1cm4gc3VwZXIuZGVjcmVhc2VBcHByb3ZhbChfc3BlbmRlciwgX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgfQoKfQoKLy8gRmlsZTogc3JjL0Nyb3dkc2FsZS9NaWxlc3RvbmVDcm93ZHNhbGUuc29sCgpjb250cmFjdCBNaWxlc3RvbmVDcm93ZHNhbGUgewoKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgLyogTnVtYmVyIG9mIGF2YWlsYWJsZSB0b2tlbnMgKi8KICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBBVkFJTEFCTEVfVE9LRU5TID0gMWU5OyAvLzEgYmlsbGlvbgoKICAvKiBUb3RhbCBUb2tlbnMgYXZhaWxhYmxlIGluIFByZVNhbGUgKi8KICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBBVkFJTEFCTEVfSU5fUFJFX1NBTEUgPSA0MGU2OyAvLyA0MCwwMDAsMDAwCgogIC8qIFRvdGFsIFRva2VucyBhdmFpbGFibGUgaW4gTWFpbiBJQ08gKi8KICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBBVkFJTEFCTEVfSU5fTUFJTiA9IDYxMGU2OyAvLyA2MTAsMDAwLDAwMDsKCiAgLyogRWFybHkgSW52ZXN0b3JzIHRva2VuIGF2YWlsYWJsZSAqLwogIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IEFWQUlMQUJMRV9GT1JfRUFSTFlfSU5WRVNUT1JTID0gMTAwZTY7IC8vIDEwMCwwMDAsMDAwOwoKICAvKiBQcmUtU2FsZSBTdGFydCBEYXRlICovCiAgdWludCBwdWJsaWMgcHJlU2FsZVN0YXJ0RGF0ZTsKCiAgLyogUHJlLVNhbGUgRW5kIERhdGUgKi8KICB1aW50IHB1YmxpYyBwcmVTYWxlRW5kRGF0ZTsKCiAgLyogTWFpbiBUb2tlbiBTYWxlIERhdGUgKi8KICB1aW50IHB1YmxpYyBtYWluU2FsZVN0YXJ0RGF0ZTsKCiAgLyogTWFpbiBUb2tlbiBTYWxlIEVuZCAqLwogIHVpbnQgcHVibGljIG1haW5TYWxlRW5kRGF0ZTsKCiAgc3RydWN0IE1pbGVzdG9uZSB7CiAgICB1aW50IHN0YXJ0OyAvLyBVTklYIHRpbWVzdGFtcAogICAgdWludCBlbmQ7IC8vIFVOSVggdGltZXN0YW1wCiAgICB1aW50MjU2IGJvbnVzOwogICAgdWludDI1NiBwcmljZTsKICB9CgogIE1pbGVzdG9uZVtdIHB1YmxpYyBtaWxlc3RvbmVzOwoKICB1aW50MjU2IHB1YmxpYyByYXRlVVNEOyAvLyAoY2VudHMpCgogIHVpbnQyNTYgcHVibGljIGVhcmx5SW52ZXN0b3JUb2tlblJhaXNlZDsKICB1aW50MjU2IHB1YmxpYyBwcmVTYWxlVG9rZW5SYWlzZWQ7CiAgdWludDI1NiBwdWJsaWMgbWFpblNhbGVUb2tlblJhaXNlZDsKCgogIGZ1bmN0aW9uIGluaXRNaWxlc3RvbmVzKHVpbnQgX3JhdGUsIHVpbnQgX3ByZVNhbGVTdGFydERhdGUsIHVpbnQgX3ByZVNhbGVFbmREYXRlLCB1aW50IF9tYWluU2FsZVN0YXJ0RGF0ZSwgdWludCBfbWFpblNhbGVFbmREYXRlKSBpbnRlcm5hbCB7CiAgICByYXRlVVNEID0gX3JhdGU7CiAgICBwcmVTYWxlU3RhcnREYXRlID0gX3ByZVNhbGVTdGFydERhdGU7CiAgICBwcmVTYWxlRW5kRGF0ZSA9IF9wcmVTYWxlRW5kRGF0ZTsKICAgIG1haW5TYWxlU3RhcnREYXRlID0gX21haW5TYWxlU3RhcnREYXRlOwogICAgbWFpblNhbGVFbmREYXRlID0gX21haW5TYWxlRW5kRGF0ZTsKCiAgICAvKioKICAgICAqIEVhcmx5IGludmVzdG9yIE1pbGVzdG9uZQogICAgICogUHJpc2U6ICQwLjAyNSBVU0QgKDIuNSBjZW50KQogICAgICogTm8gYm9udXNlcwogICAgICovCiAgICB1aW50MjU2IGVhcmx5SW52ZXN0b3JQcmljZSA9ICgoMjUgKiAxIGV0aGVyKSAvIChyYXRlVVNEICogMTApKTsKICAgIG1pbGVzdG9uZXMucHVzaChNaWxlc3RvbmUobm93LCBwcmVTYWxlU3RhcnREYXRlLCAwLCBlYXJseUludmVzdG9yUHJpY2UpKTsKCiAgICAvKioKICAgICAqIFByZS1TYWxlIE1pbGVzdG9uZQogICAgICogUHJpc2U6ICQwLjA1IFVTRCAoNSBjZW50KQogICAgICogQm9udXM6IDIwJQogICAgICovCiAgICB1aW50MjU2IHByZVNhbGVQcmljZSA9IHVzZFRvRXRoZXIoNSk7CiAgICBtaWxlc3RvbmVzLnB1c2goTWlsZXN0b25lKHByZVNhbGVTdGFydERhdGUsIHByZVNhbGVFbmREYXRlLCAyMCwgcHJlU2FsZVByaWNlKSk7CgogICAgLyoqCiAgICAgKiBNYWluIE1pbGVzdG9uZXMKICAgICAqIFByaXNlOiAkMC4xMCBVU0QgKDEwIGNlbnQpCiAgICAgKiBXZWVrIDEgQm9udXM6IDE1JQogICAgICogV2VlayAyIE1haW4gVG9rZW4gU2FsZSBCb251czogMTAlCiAgICAgKiBXZWVrIDMgTWFpbiBUb2tlbiBTYWxlIEJvbnVzOiA1JQogICAgICovCiAgICB1aW50MjU2IG1haW5TYWxlUHJpY2UgPSB1c2RUb0V0aGVyKDEwKTsKICAgIHVpbnQgbWFpblNhbGVTdGFydERhdGVXZWVrMSA9IG1haW5TYWxlU3RhcnREYXRlICsgMSB3ZWVrczsKICAgIHVpbnQgbWFpblNhbGVTdGFydERhdGVXZWVrMyA9IG1haW5TYWxlU3RhcnREYXRlICsgMyAqIDEgd2Vla3M7CiAgICB1aW50IG1haW5TYWxlU3RhcnREYXRlV2VlazIgPSBtYWluU2FsZVN0YXJ0RGF0ZSArIDIgKiAxIHdlZWtzOwoKICAgIG1pbGVzdG9uZXMucHVzaChNaWxlc3RvbmUobWFpblNhbGVTdGFydERhdGUsIG1haW5TYWxlU3RhcnREYXRlV2VlazEsIDE1LCBtYWluU2FsZVByaWNlKSk7CiAgICBtaWxlc3RvbmVzLnB1c2goTWlsZXN0b25lKG1haW5TYWxlU3RhcnREYXRlV2VlazEsIG1haW5TYWxlU3RhcnREYXRlV2VlazIsIDEwLCBtYWluU2FsZVByaWNlKSk7CiAgICBtaWxlc3RvbmVzLnB1c2goTWlsZXN0b25lKG1haW5TYWxlU3RhcnREYXRlV2VlazIsIG1haW5TYWxlU3RhcnREYXRlV2VlazMsIDUsIG1haW5TYWxlUHJpY2UpKTsKICAgIG1pbGVzdG9uZXMucHVzaChNaWxlc3RvbmUobWFpblNhbGVTdGFydERhdGVXZWVrMywgX21haW5TYWxlRW5kRGF0ZSwgMCwgbWFpblNhbGVQcmljZSkpOwogIH0KCiAgZnVuY3Rpb24gdXNkVG9FdGhlcih1aW50MjU2IHVzZFZhbHVlKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyAodXNkVmFsdWUgKiAxIGV0aGVyIC8gcmF0ZVVTRCkKICAgIHJldHVybiB1c2RWYWx1ZS5tdWwoMSBldGhlcikuZGl2KHJhdGVVU0QpOwogIH0KCiAgZnVuY3Rpb24gZ2V0Q3VycmVudE1pbGVzdG9uZSgpIGludGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NiwgdWludDI1NikgewogICAgZm9yICh1aW50IGkgPSAwOyBpIDwgbWlsZXN0b25lcy5sZW5ndGg7IGkrKykgewogICAgICBpZiAobm93ID49IG1pbGVzdG9uZXNbaV0uc3RhcnQgJiYgbm93IDwgbWlsZXN0b25lc1tpXS5lbmQpIHsKICAgICAgICB2YXIgbWlsZXN0b25lID0gbWlsZXN0b25lc1tpXTsKICAgICAgICByZXR1cm4gKG1pbGVzdG9uZS5ib251cywgbWlsZXN0b25lLnByaWNlKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiAoMCwgMCk7CiAgfQoKICBmdW5jdGlvbiBnZXRDdXJyZW50UHJpY2UoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICB2YXIgKCwgcHJpY2UpID0gZ2V0Q3VycmVudE1pbGVzdG9uZSgpOwoKICAgIHJldHVybiBwcmljZTsKICB9CgogIGZ1bmN0aW9uIGdldFRva2VuUmFpc2VkKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIG1haW5TYWxlVG9rZW5SYWlzZWQuYWRkKHByZVNhbGVUb2tlblJhaXNlZC5hZGQoZWFybHlJbnZlc3RvclRva2VuUmFpc2VkKSk7CiAgfQoKICBmdW5jdGlvbiBpc0Vhcmx5SW52ZXN0b3JzKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIG5vdyA8IHByZVNhbGVTdGFydERhdGU7CiAgfQoKICBmdW5jdGlvbiBpc1ByZVNhbGUoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gbm93ID49IHByZVNhbGVTdGFydERhdGUgJiYgbm93IDwgcHJlU2FsZUVuZERhdGU7CiAgfQoKICBmdW5jdGlvbiBpc01haW5TYWxlKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIG5vdyA+PSBtYWluU2FsZVN0YXJ0RGF0ZSAmJiBub3cgPCBtYWluU2FsZUVuZERhdGU7CiAgfQoKICBmdW5jdGlvbiBpc0VuZGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIG5vdyA+PSBtYWluU2FsZUVuZERhdGU7CiAgfQoKfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL2Nyb3dkc2FsZS9SZWZ1bmRWYXVsdC5zb2wKCi8qKgogKiBAdGl0bGUgUmVmdW5kVmF1bHQKICogQGRldiBUaGlzIGNvbnRyYWN0IGlzIHVzZWQgZm9yIHN0b3JpbmcgZnVuZHMgd2hpbGUgYSBjcm93ZHNhbGUKICogaXMgaW4gcHJvZ3Jlc3MuIFN1cHBvcnRzIHJlZnVuZGluZyB0aGUgbW9uZXkgaWYgY3Jvd2RzYWxlIGZhaWxzLAogKiBhbmQgZm9yd2FyZGluZyBpdCBpZiBjcm93ZHNhbGUgaXMgc3VjY2Vzc2Z1bC4KICovCmNvbnRyYWN0IFJlZnVuZFZhdWx0IGlzIE93bmFibGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBlbnVtIFN0YXRlIHsgQWN0aXZlLCBSZWZ1bmRpbmcsIENsb3NlZCB9CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGRlcG9zaXRlZDsKICBhZGRyZXNzIHB1YmxpYyB3YWxsZXQ7CiAgU3RhdGUgcHVibGljIHN0YXRlOwoKICBldmVudCBDbG9zZWQoKTsKICBldmVudCBSZWZ1bmRzRW5hYmxlZCgpOwogIGV2ZW50IFJlZnVuZGVkKGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB3ZWlBbW91bnQpOwoKICBmdW5jdGlvbiBSZWZ1bmRWYXVsdChhZGRyZXNzIF93YWxsZXQpIHB1YmxpYyB7CiAgICByZXF1aXJlKF93YWxsZXQgIT0gYWRkcmVzcygwKSk7CiAgICB3YWxsZXQgPSBfd2FsbGV0OwogICAgc3RhdGUgPSBTdGF0ZS5BY3RpdmU7CiAgfQoKICBmdW5jdGlvbiBkZXBvc2l0KGFkZHJlc3MgaW52ZXN0b3IpIG9ubHlPd25lciBwdWJsaWMgcGF5YWJsZSB7CiAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLkFjdGl2ZSk7CiAgICBkZXBvc2l0ZWRbaW52ZXN0b3JdID0gZGVwb3NpdGVkW2ludmVzdG9yXS5hZGQobXNnLnZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGNsb3NlKCkgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLkFjdGl2ZSk7CiAgICBzdGF0ZSA9IFN0YXRlLkNsb3NlZDsKICAgIENsb3NlZCgpOwogICAgd2FsbGV0LnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgfQoKICBmdW5jdGlvbiBlbmFibGVSZWZ1bmRzKCkgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLkFjdGl2ZSk7CiAgICBzdGF0ZSA9IFN0YXRlLlJlZnVuZGluZzsKICAgIFJlZnVuZHNFbmFibGVkKCk7CiAgfQoKICBmdW5jdGlvbiByZWZ1bmQoYWRkcmVzcyBpbnZlc3RvcikgcHVibGljIHsKICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuUmVmdW5kaW5nKTsKICAgIHVpbnQyNTYgZGVwb3NpdGVkVmFsdWUgPSBkZXBvc2l0ZWRbaW52ZXN0b3JdOwogICAgZGVwb3NpdGVkW2ludmVzdG9yXSA9IDA7CiAgICBpbnZlc3Rvci50cmFuc2ZlcihkZXBvc2l0ZWRWYWx1ZSk7CiAgICBSZWZ1bmRlZChpbnZlc3RvciwgZGVwb3NpdGVkVmFsdWUpOwogIH0KfQoKLy8gRmlsZTogc3JjL0Nyb3dkc2FsZS9UcnVzdGFCaXRDcm93ZHNhbGUuc29sCgpjb250cmFjdCBUcnVzdGFCaXRDcm93ZHNhbGUgaXMgTWlsZXN0b25lQ3Jvd2RzYWxlLCBPd25hYmxlIHsKCiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIC8qIE1pbmltdW0gY29udHJpYnV0aW9uICovCiAgdWludCBwdWJsaWMgY29uc3RhbnQgTUlOSU1VTV9DT05UUklCVVRJT04gPSAzIGV0aGVyOwoKICAvKiBTb2Z0IGNhcCAqLwogIHVpbnQgcHVibGljIGNvbnN0YW50IHNvZnRDYXBVU0QgPSAzZTY7IC8vJDMgTWlsbGlvbiBVU0QKICB1aW50IHB1YmxpYyBzb2Z0Q2FwOyAvLyQzIE1pbGxpb24gVVNEIGluIEVUSAoKICAvKiBIYXJkIENhcCAqLwogIHVpbnQgcHVibGljIGNvbnN0YW50IGhhcmRDYXBVU0QgPSA0OWU2OyAvLyQ0OSBNaWxsaW9uIFVTRAogIHVpbnQgcHVibGljIGhhcmRDYXA7IC8vJDQ5IE1pbGxpb24gVVNEIGluIEVUSAoKICAvKiBBZHZpc29yeSBCb3VudHkgVGVhbSAqLwogIGFkZHJlc3MgcHVibGljIGFkZHJlc3NBZHZpc29yeUJvdW50eVRlYW07CiAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgdG9rZW5BZHZpc29yeUJvdW50eVRlYW0gPSAyNTBlNjsKCiAgYWRkcmVzc1tdIHB1YmxpYyBpbnZlc3RvcnM7CgogIFRydXN0YUJpdFRva2VuIHB1YmxpYyB0b2tlbjsKCiAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0OwoKICB1aW50MjU2IHB1YmxpYyB3ZWlSYWlzZWQ7CgogIFJlZnVuZFZhdWx0IHB1YmxpYyB2YXVsdDsKCiAgYm9vbCBwdWJsaWMgaXNGaW5hbGl6ZWQgPSBmYWxzZTsKCiAgZXZlbnQgRmluYWxpemVkKCk7CgogIC8qKgogICAqIGV2ZW50IGZvciB0b2tlbiBwdXJjaGFzZSBsb2dnaW5nCiAgICogQHBhcmFtIGludmVzdG9yIHdobyBnb3QgdGhlIHRva2VucwogICAqIEBwYXJhbSB2YWx1ZSB3ZWlzIHBhaWQgZm9yIHB1cmNoYXNlCiAgICogQHBhcmFtIGFtb3VudCBhbW91bnQgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAqLwogIGV2ZW50IFRva2VuUHVyY2hhc2UoYWRkcmVzcyBpbmRleGVkIGludmVzdG9yLCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IGFtb3VudCk7CgogIG1vZGlmaWVyIGhhc01pbmltdW1Db250cmlidXRpb24oKSB7CiAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSBNSU5JTVVNX0NPTlRSSUJVVElPTik7CiAgICBfOwogIH0KCiAgZnVuY3Rpb24gVHJ1c3RhQml0Q3Jvd2RzYWxlKGFkZHJlc3MgX3dhbGxldCwgYWRkcmVzcyBfdG9rZW4sIHVpbnQgX3JhdGUsIHVpbnQgX3ByZVNhbGVTdGFydERhdGUsIHVpbnQgX3ByZVNhbGVFbmREYXRlLCB1aW50IF9tYWluU2FsZVN0YXJ0RGF0ZSwgdWludCBfbWFpblNhbGVFbmREYXRlLCBhZGRyZXNzIF9BZHZpc29yeUJvdW50eVRlYW0pIHB1YmxpYyB7CiAgICByZXF1aXJlKF90b2tlbiAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX0Fkdmlzb3J5Qm91bnR5VGVhbSAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3JhdGUgPiAwKTsKICAgIHJlcXVpcmUoX3ByZVNhbGVTdGFydERhdGUgPiAwKTsKICAgIHJlcXVpcmUoX3ByZVNhbGVFbmREYXRlID4gMCk7CiAgICByZXF1aXJlKF9wcmVTYWxlRW5kRGF0ZSA+IF9wcmVTYWxlU3RhcnREYXRlKTsKICAgIHJlcXVpcmUoX21haW5TYWxlU3RhcnREYXRlID4gMCk7CiAgICByZXF1aXJlKF9tYWluU2FsZVN0YXJ0RGF0ZSA+PSBfcHJlU2FsZUVuZERhdGUpOwogICAgcmVxdWlyZShfbWFpblNhbGVFbmREYXRlID4gMCk7CiAgICByZXF1aXJlKF9tYWluU2FsZUVuZERhdGUgPiBfbWFpblNhbGVTdGFydERhdGUpOwoKICAgIHdhbGxldCA9IF93YWxsZXQ7CiAgICB0b2tlbiA9IFRydXN0YUJpdFRva2VuKF90b2tlbik7CiAgICBhZGRyZXNzQWR2aXNvcnlCb3VudHlUZWFtID0gX0Fkdmlzb3J5Qm91bnR5VGVhbTsKCiAgICBpbml0TWlsZXN0b25lcyhfcmF0ZSwgX3ByZVNhbGVTdGFydERhdGUsIF9wcmVTYWxlRW5kRGF0ZSwgX21haW5TYWxlU3RhcnREYXRlLCBfbWFpblNhbGVFbmREYXRlKTsKCiAgICBzb2Z0Q2FwID0gdXNkVG9FdGhlcihzb2Z0Q2FwVVNELm11bCgxMDApKTsKICAgIGhhcmRDYXAgPSB1c2RUb0V0aGVyKGhhcmRDYXBVU0QubXVsKDEwMCkpOwoKICAgIHZhdWx0ID0gbmV3IFJlZnVuZFZhdWx0KHdhbGxldCk7CiAgfQoKICBmdW5jdGlvbiBpbnZlc3RvcnNDb3VudCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CiAgICByZXR1cm4gaW52ZXN0b3JzLmxlbmd0aDsKICB9CgogIC8vIGZhbGxiYWNrIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIGJ1eSB0b2tlbnMKICBmdW5jdGlvbigpIGV4dGVybmFsIHBheWFibGUgewogICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwogIH0KCiAgLy8gbG93IGxldmVsIHRva2VuIHB1cmNoYXNlIGZ1bmN0aW9uCiAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgaW52ZXN0b3IpIHB1YmxpYyBoYXNNaW5pbXVtQ29udHJpYnV0aW9uIHBheWFibGUgewogICAgcmVxdWlyZShpbnZlc3RvciAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoIWlzRW5kZWQoKSk7CgogICAgdWludDI1NiB3ZWlBbW91bnQgPSBtc2cudmFsdWU7CgogICAgcmVxdWlyZShnZXRDdXJyZW50UHJpY2UoKSA+IDApOwoKICAgIHVpbnQyNTYgdG9rZW5zQW1vdW50ID0gY2FsY3VsYXRlVG9rZW5zKHdlaUFtb3VudCk7CiAgICByZXF1aXJlKHRva2Vuc0Ftb3VudCA+IDApOwoKICAgIG1pbnRUb2tlbnMoaW52ZXN0b3IsIHdlaUFtb3VudCwgdG9rZW5zQW1vdW50KTsKICAgIGluY3JlYXNlUmFpc2VkKHdlaUFtb3VudCwgdG9rZW5zQW1vdW50KTsKCiAgICBpZiAodmF1bHQuZGVwb3NpdGVkKGludmVzdG9yKSA9PSAwKSB7CiAgICAgIGludmVzdG9ycy5wdXNoKGludmVzdG9yKTsKICAgIH0KICAgIC8vIHNlbmQgZXRoZXIgdG8gdGhlIGZ1bmQgY29sbGVjdGlvbiB3YWxsZXQKICAgIHZhdWx0LmRlcG9zaXQudmFsdWUod2VpQW1vdW50KShpbnZlc3Rvcik7CiAgfQoKICBmdW5jdGlvbiBjYWxjdWxhdGVUb2tlbnModWludDI1NiB3ZWlBbW91bnQpIGludGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKCh3ZWlSYWlzZWQuYWRkKHdlaUFtb3VudCkpID4gaGFyZENhcCkgcmV0dXJuIDA7CgogICAgdmFyIChib251cywgcHJpY2UpID0gZ2V0Q3VycmVudE1pbGVzdG9uZSgpOwoKICAgIHVpbnQyNTYgdG9rZW5zQW1vdW50ID0gd2VpQW1vdW50LmRpdihwcmljZSkubXVsKDEwICoqIHRva2VuLmRlY2ltYWxzKCkpOwogICAgdG9rZW5zQW1vdW50ID0gdG9rZW5zQW1vdW50LmFkZCh0b2tlbnNBbW91bnQubXVsKGJvbnVzKS5kaXYoMTAwKSk7CgogICAgaWYgKGlzRWFybHlJbnZlc3RvcnNUb2tlblJhaXNlZCh0b2tlbnNBbW91bnQpKSByZXR1cm4gMDsKICAgIGlmIChpc1ByZVNhbGVUb2tlblJhaXNlZCh0b2tlbnNBbW91bnQpKSByZXR1cm4gMDsKICAgIGlmIChpc01haW5TYWxlVG9rZW5SYWlzZWQodG9rZW5zQW1vdW50KSkgcmV0dXJuIDA7CiAgICBpZiAoaXNUb2tlbkF2YWlsYWJsZSh0b2tlbnNBbW91bnQpKSByZXR1cm4gMDsKCiAgICByZXR1cm4gdG9rZW5zQW1vdW50OwogIH0KCiAgZnVuY3Rpb24gaXNFYXJseUludmVzdG9yc1Rva2VuUmFpc2VkKHVpbnQyNTYgdG9rZW5zQW1vdW50KSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gaXNFYXJseUludmVzdG9ycygpICYmIChlYXJseUludmVzdG9yVG9rZW5SYWlzZWQuYWRkKHRva2Vuc0Ftb3VudCkgPiBBVkFJTEFCTEVfRk9SX0VBUkxZX0lOVkVTVE9SUy5tdWwoMTAgKiogdG9rZW4uZGVjaW1hbHMoKSkpOwogIH0KCiAgZnVuY3Rpb24gaXNQcmVTYWxlVG9rZW5SYWlzZWQodWludDI1NiB0b2tlbnNBbW91bnQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBpc1ByZVNhbGUoKSAmJiAocHJlU2FsZVRva2VuUmFpc2VkLmFkZCh0b2tlbnNBbW91bnQpID4gQVZBSUxBQkxFX0lOX1BSRV9TQUxFLm11bCgxMCAqKiB0b2tlbi5kZWNpbWFscygpKSk7CiAgfQoKICBmdW5jdGlvbiBpc01haW5TYWxlVG9rZW5SYWlzZWQodWludDI1NiB0b2tlbnNBbW91bnQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBpc01haW5TYWxlKCkgJiYgKG1haW5TYWxlVG9rZW5SYWlzZWQuYWRkKHRva2Vuc0Ftb3VudCkgPiBBVkFJTEFCTEVfSU5fTUFJTi5tdWwoMTAgKiogdG9rZW4uZGVjaW1hbHMoKSkpOwogIH0KCiAgZnVuY3Rpb24gaXNUb2tlbkF2YWlsYWJsZSh1aW50MjU2IHRva2Vuc0Ftb3VudCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIGdldFRva2VuUmFpc2VkKCkuYWRkKHRva2Vuc0Ftb3VudCkgPiBBVkFJTEFCTEVfVE9LRU5TLm11bCgxMCAqKiB0b2tlbi5kZWNpbWFscygpKTsKICB9CgogIGZ1bmN0aW9uIGluY3JlYXNlUmFpc2VkKHVpbnQyNTYgd2VpQW1vdW50LCB1aW50MjU2IHRva2Vuc0Ftb3VudCkgaW50ZXJuYWwgewogICAgd2VpUmFpc2VkID0gd2VpUmFpc2VkLmFkZCh3ZWlBbW91bnQpOwoKICAgIGlmIChpc0Vhcmx5SW52ZXN0b3JzKCkpIHsKICAgICAgZWFybHlJbnZlc3RvclRva2VuUmFpc2VkID0gZWFybHlJbnZlc3RvclRva2VuUmFpc2VkLmFkZCh0b2tlbnNBbW91bnQpOwogICAgfQoKICAgIGlmIChpc1ByZVNhbGUoKSkgewogICAgICBwcmVTYWxlVG9rZW5SYWlzZWQgPSBwcmVTYWxlVG9rZW5SYWlzZWQuYWRkKHRva2Vuc0Ftb3VudCk7CiAgICB9CgogICAgaWYgKGlzTWFpblNhbGUoKSkgewogICAgICBtYWluU2FsZVRva2VuUmFpc2VkID0gbWFpblNhbGVUb2tlblJhaXNlZC5hZGQodG9rZW5zQW1vdW50KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIG1pbnRUb2tlbnMoYWRkcmVzcyBpbnZlc3RvciwgdWludDI1NiB3ZWlBbW91bnQsIHVpbnQyNTYgdG9rZW5zKSBpbnRlcm5hbCB7CiAgICB0b2tlbi5taW50KGludmVzdG9yLCB0b2tlbnMpOwogICAgVG9rZW5QdXJjaGFzZShpbnZlc3Rvciwgd2VpQW1vdW50LCB0b2tlbnMpOwogIH0KCiAgZnVuY3Rpb24gZmluYWxpemUoKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUoIWlzRmluYWxpemVkKTsKICAgIHJlcXVpcmUoaXNFbmRlZCgpKTsKCiAgICBpZiAoc29mdENhcFJlYWNoZWQoKSkgewogICAgICB2YXVsdC5jbG9zZSgpOwogICAgICBtaW50QWR2aXNvcnlCb3VudHlUZWFtKCk7CiAgICAgIHRva2VuLmZpbmlzaE1pbnRpbmcoKTsKICAgIH0KICAgIGVsc2UgewogICAgICB2YXVsdC5lbmFibGVSZWZ1bmRzKCk7CiAgICAgIHRva2VuLmZpbmlzaE1pbnRpbmcoKTsKICAgIH0KCiAgICB0b2tlbi50cmFuc2Zlck93bmVyc2hpcChvd25lcik7CgogICAgaXNGaW5hbGl6ZWQgPSB0cnVlOwogICAgRmluYWxpemVkKCk7CiAgfQoKICBmdW5jdGlvbiBtaW50QWR2aXNvcnlCb3VudHlUZWFtKCkgaW50ZXJuYWwgewogICAgbWludFRva2VucyhhZGRyZXNzQWR2aXNvcnlCb3VudHlUZWFtLCAwLCB0b2tlbkFkdmlzb3J5Qm91bnR5VGVhbS5tdWwoMTAgKiogdG9rZW4uZGVjaW1hbHMoKSkpOwogIH0KCiAgLy8gaWYgY3Jvd2RzYWxlIGlzIHVuc3VjY2Vzc2Z1bCwgaW52ZXN0b3JzIGNhbiBjbGFpbSByZWZ1bmRzIGhlcmUKICBmdW5jdGlvbiBjbGFpbVJlZnVuZCgpIHB1YmxpYyB7CiAgICByZXF1aXJlKGlzRmluYWxpemVkKTsKICAgIHJlcXVpcmUoIXNvZnRDYXBSZWFjaGVkKCkpOwoKICAgIHZhdWx0LnJlZnVuZChtc2cuc2VuZGVyKTsKICB9CgogIGZ1bmN0aW9uIHJlZnVuZCgpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShpc0ZpbmFsaXplZCk7CiAgICByZXF1aXJlKCFzb2Z0Q2FwUmVhY2hlZCgpKTsKCiAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBpbnZlc3RvcnMubGVuZ3RoOyBpKyspIHsKICAgICAgYWRkcmVzcyBpbnZlc3RvciA9IGludmVzdG9yc1tpXTsKICAgICAgaWYgKHZhdWx0LmRlcG9zaXRlZChpbnZlc3RvcikgIT0gMCkgewogICAgICAgIHZhdWx0LnJlZnVuZChpbnZlc3Rvcik7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHNvZnRDYXBSZWFjaGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHdlaVJhaXNlZCA+PSBzb2Z0Q2FwOwogIH0KCiAgZnVuY3Rpb24gaGFyZENhcFJlYWNoZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gd2VpUmFpc2VkID49IGhhcmRDYXA7CiAgfQoKICBmdW5jdGlvbiBkZXN0cm95KCkgb25seU93bmVyIHB1YmxpYyB7CiAgICBzZWxmZGVzdHJ1Y3Qob3duZXIpOwogIH0KfQ=='.
	

]
