Class {
	#name : #SRTc9ecab309aef735586f45413d0aeaa4adcc4f654,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTc9ecab309aef735586f45413d0aeaa4adcc4f654 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuODsKCgovKioKICogTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcwogKiBCeSBPcGVuWmVwcGVsaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL1NhZmVNYXRoLnNvbAogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGlmKCEoYSA9PSAwIHx8IGMgLyBhID09IGIpKSB0aHJvdzsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZighKGIgPD0gYSkpIHRocm93OwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGlmKCEoYyA+PSBhKSkgdGhyb3c7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIG1heDY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7CiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7CiAgfQoKICBmdW5jdGlvbiBtaW42NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgewogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7CiAgfQoKICBmdW5jdGlvbiBtYXgyNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBhID49IGIgPyBhIDogYjsKICB9CgogIGZ1bmN0aW9uIG1pbjI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7CiAgfQoKfQoKY29udHJhY3QgQ29udHJhY3RSZWNlaXZlcnsKICAgIGZ1bmN0aW9uIHRva2VuRmFsbGJhY2soYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdmFsdWUsIGJ5dGVzICBfZGF0YSkgZXh0ZXJuYWw7Cn0KCgovL0Jhc2ljIEVSQzIzIHRva2VuLCBiYWNrd2FyZCBjb21wYXRpYmxlIHdpdGggRVJDMjAgdHJhbnNmZXIgZnVuY3Rpb24uCi8vQmFzZWQgaW4gcGFydCBvbiBjb2RlIGJ5IG9wZW4temVwcGVsaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkuZ2l0CmNvbnRyYWN0IEVSQzIzQmFzaWNUb2tlbiB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7CiAgICAKCiAgICAvKgogICAgICAgKiBGaXggZm9yIHRoZSBFUkMyMCBzaG9ydCBhZGRyZXNzIGF0dGFjayAgCiAgICAgICovCiAgICAgIG1vZGlmaWVyIG9ubHlQYXlsb2FkU2l6ZSh1aW50IHNpemUpIHsKICAgICAgICAgaWYobXNnLmRhdGEubGVuZ3RoIDwgc2l6ZSArIDQpIHsKICAgICAgICAgICB0aHJvdzsKICAgICAgICAgfQogICAgICAgICBfOwogICAgICB9CgoKICAgIGZ1bmN0aW9uIHRva2VuRmFsbGJhY2soYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdmFsdWUsIGJ5dGVzICBfZGF0YSkgZXh0ZXJuYWwgewogICAgICAgIF9mcm9tOwogICAgICAgIF92YWx1ZTsKICAgICAgICBfZGF0YTsKICAgICAgICB0aHJvdzsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9kYXRhKSAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CgogICAgICAgIC8vU3RhbmRhcmQgRVJDMjMgdHJhbnNmZXIgZnVuY3Rpb24KCiAgICAgICAgaWYoaXNDb250cmFjdChfdG8pKSB7CiAgICAgICAgICAgIHRyYW5zZmVyVG9Db250cmFjdChfdG8sIF92YWx1ZSwgX2RhdGEpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgdHJhbnNmZXJUb0FkZHJlc3MoX3RvLCBfdmFsdWUsIF9kYXRhKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSB7CgogICAgICAgIC8vc3RhbmRhcmQgZnVuY3Rpb24gdHJhbnNmZXIgc2ltaWxhciB0byBFUkMyMCB0cmFuc2ZlciB3aXRoIG5vIF9kYXRhCiAgICAgICAgLy9hZGRlZCBkdWUgdG8gYmFja3dhcmRzIGNvbXBhdGliaWxpdHkgcmVhc29ucwoKICAgICAgICBieXRlcyBtZW1vcnkgZW1wdHk7CiAgICAgICAgaWYoaXNDb250cmFjdChfdG8pKSB7CiAgICAgICAgICAgIHRyYW5zZmVyVG9Db250cmFjdChfdG8sIF92YWx1ZSwgZW1wdHkpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgdHJhbnNmZXJUb0FkZHJlc3MoX3RvLCBfdmFsdWUsIGVtcHR5KTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJUb0FkZHJlc3MoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSkgIGludGVybmFsIHsKICAgICAgICBfZGF0YTsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJUb0NvbnRyYWN0KGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2RhdGEpICBpbnRlcm5hbCB7CiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoIF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKCBfdmFsdWUpOwogICAgICAgIENvbnRyYWN0UmVjZWl2ZXIgcmVjZWl2ZXIgPSBDb250cmFjdFJlY2VpdmVyKF90byk7CiAgICAgICAgcmVjZWl2ZXIudG9rZW5GYWxsYmFjayhtc2cuc2VuZGVyLCBfdmFsdWUsIF9kYXRhKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7ICAgIH0KCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogICAgfQoKICAgIC8vYXNzZW1ibGUgdGhlIGdpdmVuIGFkZHJlc3MgYnl0ZWNvZGUuIElmIGJ5dGVjb2RlIGV4aXN0cyB0aGVuIHRoZSBfYWRkciBpcyBhIGNvbnRyYWN0LgogICAgZnVuY3Rpb24gaXNDb250cmFjdChhZGRyZXNzIF9hZGRyKSByZXR1cm5zIChib29sIGlzX2NvbnRyYWN0KSB7CiAgICAgICAgICAgIF9hZGRyOwogICAgICAgICAgdWludDI1NiBsZW5ndGg7CiAgICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgICAgLy9yZXRyaWV2ZSB0aGUgc2l6ZSBvZiB0aGUgY29kZSBvbiB0YXJnZXQgYWRkcmVzcywgdGhpcyBuZWVkcyBhc3NlbWJseQogICAgICAgICAgICAgIGxlbmd0aCA6PSBleHRjb2Rlc2l6ZShfYWRkcikKICAgICAgICAgIH0KICAgICAgICAgIGlmKGxlbmd0aD4wKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CiAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICB9Cn0KCmNvbnRyYWN0IEVSQzIzU3RhbmRhcmRUb2tlbiBpcyBFUkMyM0Jhc2ljVG9rZW4gewogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwogICAgZXZlbnQgQXBwcm92YWwgKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIG9ubHlQYXlsb2FkU2l6ZSgzICogMzIpIHsKICAgICAgICB2YXIgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOwoKICAgICAgICAvLyBDaGVjayBpcyBub3QgbmVlZGVkIGJlY2F1c2Ugc3ViKF9hbGxvd2FuY2UsIF92YWx1ZSkgd2lsbCBhbHJlYWR5IHRocm93IGlmIHRoaXMgY29uZGl0aW9uIGlzIG5vdCBtZXQKICAgICAgICAvLyBpZiAoX3ZhbHVlID4gX2FsbG93YW5jZSkgdGhyb3c7CgogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSB7CgogICAgICAgIC8vIFRvIGNoYW5nZSB0aGUgYXBwcm92ZSBhbW91bnQgeW91IGZpcnN0IGhhdmUgdG8gcmVkdWNlIHRoZSBhZGRyZXNzZXNgCiAgICAgICAgLy8gIGFsbG93YW5jZSB0byB6ZXJvIGJ5IGNhbGxpbmcgYGFwcHJvdmUoX3NwZW5kZXIsIDApYCBpZiBpdCBpcyBub3QKICAgICAgICAvLyAgYWxyZWFkeSAwIHRvIG1pdGlnYXRlIHRoZSByYWNlIGNvbmRpdGlvbiBkZXNjcmliZWQgaGVyZToKICAgICAgICAvLyAgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgICAgICBpZiAoKF92YWx1ZSAhPSAwKSAmJiAoYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gIT0gMCkpIHRocm93OwoKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgICB9Cgp9CgoKCgovLyBCYXNlZCBpbiBwYXJ0IG9uIGNvZGUgYnkgT3Blbi1aZXBwZWxpbjogaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXBwZWxpbi1zb2xpZGl0eS5naXQKLy8gQmFzZWQgaW4gcGFydCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbApjb250cmFjdCBQcm9maXQxMDAwIGlzIEVSQzIzU3RhbmRhcmRUb2tlbiB7CiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiUHJvZml0IDEwMDAgVG9rZW4iOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiMTAwMCI7CiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwogICAgYWRkcmVzcyBwdWJsaWMgbXVsdGlzaWc9YWRkcmVzcygweDg3MUQ5MjI1QzIzNzA0OWMyRkI4MkEzMjY0NzUxMTEyODc0MUE2MTYpOyAvL211bHRpc2lnIHdhbGxldCwgdG8gd2hpY2ggYWxsIGNvbnRyaWJ1dGlvbnMgd2lsbCBiZSBzZW50CiAgICBhZGRyZXNzIHB1YmxpYyBmb3VuZGF0aW9uOyAvL293bmVyIGFkZHJlc3MKICAgIGFkZHJlc3MgcHVibGljIGNhbmRpZGF0ZTsgLy9vd25lciBjYW5kaWRhdGUgaW4gMi1waGFzZSBvd25lcnNoaXAgdHJhbnNmZXIKICAgIHVpbnQyNTYgcHVibGljIGhvdXJfYmxvY2tzID0gMjEyOyAvLyBldmVyeSBob3VyIGJsb2NrcyAKICAgIHVpbnQyNTYgcHVibGljIGRheV9ibG9ja3MgPSBob3VyX2Jsb2NrcyAqIDI0IDsgLy8gZXZlcnkgZGF5IGJsb2NrcyAKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIGNvbnRyaWJ1dGlvbnM7IC8va2VlcHMgdHJhY2sgb2YgZXRoZXIgY29udHJpYnV0aW9ucyBpbiBXZWkgb2YgZWFjaCBjb250cmlidXRvciBhZGRyZXNzCiAgICB1aW50MjU2IHB1YmxpYyBzdGFydEJsb2NrID0gNDA3MDQ3MjsgLy9jcm93ZHNhbGUgc3RhcnQgYmxvY2sgCiAgICB1aW50MjU2IHB1YmxpYyBlbmRCbG9jayA9IHN0YXJ0QmxvY2sgKyBkYXlfYmxvY2tzICogMzA7IC8vIHdob2xlIGNyb3dkc2FsZSBlbmQgYmxvY2sgKDMwIGRheXMgLCAxIG1vbnRoKQogICAgdWludDI1NiBwdWJsaWMgY3Jvd2RzYWxlVG9rZW5TdXBwbHkgPSA4MDAgKiAoMTAqKjE4KTsgLy9BbW91bnQgb2YgdG9rZW5zIGZvciBzYWxlIGR1cmluZyBjcm93ZHNhbGUKICAgIHVpbnQyNTYgcHVibGljIGZvdW5kYXRpb25Ub2tlblN1cHBseSA9IDIwMCAqICgxMCoqMTgpOyAvL1Rva2VucyBmb3IgIHRlYW0KICAgIHVpbnQyNTYgcHVibGljIGNyb3dkc2FsZVRva2VuU29sZCA9IDA7IC8vS2VlcHMgdHJhY2sgb2YgdGhlIGFtb3VudCBvZiB0b2tlbnMgc29sZCBkdXJpbmcgdGhlIGNyb3dkc2FsZQogICAgdWludDI1NiBwdWJsaWMgcHJlc2FsZUV0aGVyUmFpc2VkID0gMDsgLy9LZWVwcyB0cmFjayBvZiB0aGUgRXRoZXIgcmFpc2VkIGR1cmluZyB0aGUgY3Jvd2RzYWxlCiAgICAKICAgIGJvb2wgcHVibGljIGhhbHRlZCA9IGZhbHNlOyAvL0hhbHQgY3Jvd2RzYWxlIGluIGVtZXJnZW5jeQogICAgZXZlbnQgSGFsdCgpOyAvL0hhbHQgZXZlbnQKICAgIGV2ZW50IFVuaGFsdCgpOyAvL1VuaGFsdCBldmVudAoKICAgIG1vZGlmaWVyIG9ubHlGb3VuZGF0aW9uKCkgewogICAgICAgIC8vb25seSBkbyBpZiBjYWxsIGlzIGZyb20gb3duZXIgbW9kaWZpZXIKICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBmb3VuZGF0aW9uKSB0aHJvdzsKICAgICAgICBfOwogICAgfQoKCiAgICBtb2RpZmllciB3aGVuTm90SGFsdGVkKCkgewogICAgICAgIC8vIG9ubHkgZG8gd2hlbiBub3QgaGFsdGVkIG1vZGlmaWVyCiAgICAgICAgaWYgKGhhbHRlZCkgdGhyb3c7CiAgICAgICAgXzsKICAgIH0KCiAgICAvL0NvbnN0cnVjdG9yOiBzZXQgbXVsdGlzaWcgY3Jvd2RzYWxlIHJlY2lwaWVudCB3YWxsZXQgYWRkcmVzcyBhbmQgZnVuZCB0aGUgZm91bmRhdGlvbgogICAgLy9Jbml0aWFsaXplIHRvdGFsIHN1cHBseSBhbmQgYWxsb2NhdGUgZWNvc3lzdGVtICYgZm91bmRhdGlvbiB0b2tlbnMKICAJZnVuY3Rpb24gUHJvZml0MTAwMCgpIHsKICAgICAgICBmb3VuZGF0aW9uID0gbXNnLnNlbmRlcjsKICAgICAgICB0b3RhbFN1cHBseSA9IGZvdW5kYXRpb25Ub2tlblN1cHBseTsKICAgICAgICBiYWxhbmNlc1tmb3VuZGF0aW9uXSA9IHRvdGFsU3VwcGx5OwogIAl9CgogICAgLy9GYWxsYmFjayBmdW5jdGlvbiB3aGVuIHJlY2VpdmluZyBFdGhlci4KICAgIGZ1bmN0aW9uKCkgcGF5YWJsZSB7CiAgICAgICAgYnV5KCk7CiAgICB9CgoKICAgIC8vSGFsdCBJQ08gaW4gY2FzZSBvZiBlbWVyZ2VuY3kuCiAgICBmdW5jdGlvbiBoYWx0KCkgb25seUZvdW5kYXRpb24gewogICAgICAgIGhhbHRlZCA9IHRydWU7CiAgICAgICAgSGFsdCgpOwogICAgfQoKICAgIGZ1bmN0aW9uIHVuaGFsdCgpIG9ubHlGb3VuZGF0aW9uIHsKICAgICAgICBoYWx0ZWQgPSBmYWxzZTsKICAgICAgICBVbmhhbHQoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBidXkoKSBwYXlhYmxlIHsKICAgICAgICBidXlSZWNpcGllbnQobXNnLnNlbmRlcik7CiAgICB9CgogICAgLy9BbGxvdyBhZGRyZXNzZXMgdG8gYnV5IHRva2VuIGZvciBhbm90aGVyIGFjY291bnQKICAgIGZ1bmN0aW9uIGJ1eVJlY2lwaWVudChhZGRyZXNzIHJlY2lwaWVudCkgcHVibGljIHBheWFibGUgd2hlbk5vdEhhbHRlZCB7CiAgICAgICAgaWYobXNnLnZhbHVlID09IDApIHRocm93OwogICAgICAgIGlmKCFjcm93ZHNhbGVPbigpKSB0aHJvdzsvL29ubHkgYWxsb3dzIGR1cmluZyBwcmVzYWxlL2Nyb3dkc2FsZQogICAgICAgIGlmKGNvbnRyaWJ1dGlvbnNbcmVjaXBpZW50XS5hZGQobXNnLnZhbHVlKT5wZXJBZGRyZXNzQ2FwKCkpIHRocm93Oy8vcGVyIGFkZHJlc3MgY2FwCiAgICAgICAgdWludDI1NiB0b2tlbnMgPSBtc2cudmFsdWUubXVsKHJldHVyblJhdGUoKSk7IC8vZGVjaW1hbHM9MTgsIHNvIG5vIG5lZWQgdG8gYWRqdXN0IGZvciB1bml0CiAgICAgICAgaWYoY3Jvd2RzYWxlVG9rZW5Tb2xkLmFkZCh0b2tlbnMpPmNyb3dkc2FsZVRva2VuU3VwcGx5KSB0aHJvdzsvL21heCBzdXBwbHkgbGltaXQKCiAgICAgICAgYmFsYW5jZXNbcmVjaXBpZW50XSA9IGJhbGFuY2VzW3JlY2lwaWVudF0uYWRkKHRva2Vucyk7CiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQodG9rZW5zKTsKICAgICAgICBwcmVzYWxlRXRoZXJSYWlzZWQgPSBwcmVzYWxlRXRoZXJSYWlzZWQuYWRkKG1zZy52YWx1ZSk7CiAgICAgICAgY29udHJpYnV0aW9uc1tyZWNpcGllbnRdID0gY29udHJpYnV0aW9uc1tyZWNpcGllbnRdLmFkZChtc2cudmFsdWUpOwogICAgICAgIGNyb3dkc2FsZVRva2VuU29sZCA9IGNyb3dkc2FsZVRva2VuU29sZC5hZGQodG9rZW5zKTsKICAgICAgICBpZihjcm93ZHNhbGVUb2tlblNvbGQgPT0gY3Jvd2RzYWxlVG9rZW5TdXBwbHkgKXsKICAgICAgICAgICAgLy9JZiBjcm93ZHNhbGUgdG9rZW4gc29sZCBvdXQsIGVuZCBjcm93ZHNhbGUKICAgICAgICAgICAgZW5kQmxvY2sgPSBibG9jay5udW1iZXI7CiAgICAgICAgfQogICAgICAgIGlmICghbXVsdGlzaWcuc2VuZChtc2cudmFsdWUpKSB0aHJvdzsgLy9pbW1lZGlhdGVseSBzZW5kIEV0aGVyIHRvIG11bHRpc2lnIGFkZHJlc3MKICAgICAgICBUcmFuc2Zlcih0aGlzLCByZWNpcGllbnQsIHRva2Vucyk7CiAgICB9CgogICAgLy9CdXJucyB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgZnJvbSB0aGUgZm91bmRhdGlvbgogICAgLy9Vc2VkIHRvIGJ1cm4gdW5zcGVudCBmdW5kcyBpbiBmb3VuZGF0aW9uIERBTwogICAgZnVuY3Rpb24gYnVybih1aW50MjU2IF92YWx1ZSkgZXh0ZXJuYWwgb25seUZvdW5kYXRpb24gcmV0dXJucyAoYm9vbCkgewogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5zdWIoX3ZhbHVlKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBhZGRyZXNzKDApLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vMi1waGFzZSBvd25lcnNoaXAgdHJhbnNmZXI7CiAgICAvL3ByZXZlbnQgdHJhbnNmZXJyaW5nIG93bmVyc2hpcCB0byBub24tZXhpc3RlbnQgYWRkcmVzc2VzIGJ5IGFjY2lkZW50LgogICAgZnVuY3Rpb24gcHJvcG9zZUZvdW5kYXRpb25UcmFuc2ZlcihhZGRyZXNzIG5ld0ZvdW5kYXRpb24pIGV4dGVybmFsIG9ubHlGb3VuZGF0aW9uIHsKICAgICAgICAvL3Byb3Bvc2UgbmV3IG93bmVyCiAgICAgICAgY2FuZGlkYXRlID0gbmV3Rm91bmRhdGlvbjsKICAgIH0KCiAgICBmdW5jdGlvbiBjYW5jZWxGb3VuZGF0aW9uVHJhbnNmZXIoKSBleHRlcm5hbCBvbmx5Rm91bmRhdGlvbiB7CiAgICAgICAgY2FuZGlkYXRlID0gYWRkcmVzcygwKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhY2NlcHRGb3VuZGF0aW9uVHJhbnNmZXIoKSBleHRlcm5hbCB7CiAgICAgICAgLy9uZXcgb3duZXIgYWNjZXB0IHRyYW5zZmVyIHRvIGNvbXBsZXRlIHRyYW5zZmVyCiAgICAgICAgaWYobXNnLnNlbmRlciAhPSBjYW5kaWRhdGUpIHRocm93OwogICAgICAgIGZvdW5kYXRpb24gPSBjYW5kaWRhdGU7CiAgICAgICAgY2FuZGlkYXRlID0gYWRkcmVzcygwKTsKICAgIH0KCiAgICAvL0FsbG93IHRvIGNoYW5nZSB0aGUgcmVjaXBpZW50IG11bHRpc2lnIGFkZHJlc3MKICAgIGZ1bmN0aW9uIHNldE11bHRpc2lnKGFkZHJlc3MgYWRkcikgZXh0ZXJuYWwgb25seUZvdW5kYXRpb24gewogICAgICAJaWYgKGFkZHIgPT0gYWRkcmVzcygwKSkgdGhyb3c7CiAgICAgIAltdWx0aXNpZyA9IGFkZHI7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUsIF9kYXRhKTsKICAgIH0KCgkgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljICB7CiAgICAgICAgc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwoJICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljICB7CiAgICAgICAgc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgLy9SZXR1cm4gcmF0ZSBvZiB0b2tlbiBhZ2FpbnN0IGV0aGVyLgogICAgZnVuY3Rpb24gcmV0dXJuUmF0ZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICBpZiAoYmxvY2subnVtYmVyPj1zdGFydEJsb2NrICYmIGJsb2NrLm51bWJlcjw9ZW5kQmxvY2spIHJldHVybiA0OyAvLyBJQ08KICAgICAgICByZXR1cm4gMDsvLyBvdXQgb2YgSUNPIAogICAgfQoKICAgIC8vcGVyIGFkZHJlc3MgY2FwIGluIFdlaTogMTAwMCBldGhlciArIDElIG9mIGV0aGVyIHJlY2VpdmVkIGF0IHRoZSBnaXZlbiB0aW1lLgogICAgZnVuY3Rpb24gcGVyQWRkcmVzc0NhcCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IGJhc2VsaW5lID0gMTAwMCAqICgxMCoqMTgpOwogICAgICAgIHJldHVybiBiYXNlbGluZS5hZGQocHJlc2FsZUV0aGVyUmFpc2VkLmRpdigxMDApKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjcm93ZHNhbGVPbigpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgLy9yZXR1cm4gd2hldGhlciBjcm93ZHNhbGUgaXMgb24gYWNjb3JkaW5nIHRvIGJsb2NrIG51bWJlcgogICAgICAgIHJldHVybiAoYmxvY2subnVtYmVyPj1zdGFydEJsb2NrICYmIGJsb2NrLm51bWJlcjw9ZW5kQmxvY2spOwogICAgfQoKCiAgICBmdW5jdGlvbiBnZXRFdGhlclJhaXNlZCgpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICAvL2dldHRlciBmdW5jdGlvbiBmb3IgZXRoZXJSYWlzZWQKICAgICAgICByZXR1cm4gcHJlc2FsZUV0aGVyUmFpc2VkOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFRva2VuU29sZCgpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICAvL2dldHRlciBmdW5jdGlvbiBmb3IgY3Jvd2RzYWxlVG9rZW5Tb2xkCiAgICAgICAgcmV0dXJuIGNyb3dkc2FsZVRva2VuU29sZDsKICAgIH0KCn0='.
	

]
