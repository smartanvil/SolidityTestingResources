Class {
	#name : #SRTb965a5f98b69cf4c421cf587942dee10c3734f74,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTb965a5f98b69cf4c421cf587942dee10c3734f74 >> base64 [
	^ 'LyoqCiAqIERldmVsb3BlciBUZWFtOiAKICogSGlyYSBTaWRkaXF1aQogKiBjb25uZWN0IG9uOiBodHRwczovL3d3dy5saW5rZWRpbi5jb20vaW4vaGlyYS1zaWRkaXF1aS05NmI2MGE3NC8KICogCiAqIE11anRhYmEgSWRyZWVzCiAqIGNvbm5lY3Qgb246IGh0dHBzOi8vd3d3LmxpbmtlZGluLmNvbS9pbi9tdWp0YWJhaWRyZWVzOTQvCiAqKi8KCnByYWdtYSBzb2xpZGl0eSBeMC40LjExOwoKLyoqCiAqIEB0aXRsZSBDcm93ZHNhbGUKICogQGRldiBDcm93ZHNhbGUgaXMgYSBiYXNlIGNvbnRyYWN0IGZvciBtYW5hZ2luZyBhIHRva2VuIGNyb3dkc2FsZS4KICogQ3Jvd2RzYWxlcyBoYXZlIGEgc3RhcnQgYW5kIGVuZCB0aW1lc3RhbXBzLCB3aGVyZSBpbnZlc3RvcnMgY2FuIG1ha2UKICogdG9rZW4gcHVyY2hhc2VzIGFuZCB0aGUgY3Jvd2RzYWxlIHdpbGwgYXNzaWduIHRoZW0gdG9rZW5zIGJhc2VkCiAqIG9uIGEgdG9rZW4gcGVyIEVUSCByYXRlLiBGdW5kcyBjb2xsZWN0ZWQgYXJlIGZvcndhcmRlZCB0byBhIHdhbGxldAogKiBhcyB0aGV5IGFycml2ZS4KICovCiAKIApsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5CiAqLwpjb250cmFjdCBFUkMyMEJhc2ljIHsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgdG9rZW5CYWxhbmNlczsKCiAgLyoqCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKHRva2VuQmFsYW5jZXNbbXNnLnNlbmRlcl0+PV92YWx1ZSk7CiAgICB0b2tlbkJhbGFuY2VzW21zZy5zZW5kZXJdID0gdG9rZW5CYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIHRva2VuQmFsYW5jZXNbX3RvXSA9IHRva2VuQmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiB0b2tlbkJhbGFuY2VzW19vd25lcl07CiAgfQoKfQpjb250cmFjdCBFdGhlZXJhVG9rZW4gaXMgQmFzaWNUb2tlbixPd25hYmxlIHsKCiAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogICAKICAgLy9UT0RPOiBDaGFuZ2UgdGhlIG5hbWUgYW5kIHRoZSBzeW1ib2wKICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIkVUSEVFUkEiOwogICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJFVEEiOwogICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwoKICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgSU5JVElBTF9TVVBQTFkgPSAzMDAwMDAwMDA7CiAgIGV2ZW50IERlYnVnKHN0cmluZyBtZXNzYWdlLCBhZGRyZXNzIGFkZHIsIHVpbnQyNTYgbnVtYmVyKTsKICAgLyoqCiAgICogQGRldiBDb250cnVjdG9yIHRoYXQgZ2l2ZXMgbXNnLnNlbmRlciBhbGwgb2YgZXhpc3RpbmcgdG9rZW5zLgogICAqLwogICAgZnVuY3Rpb24gRXRoZWVyYVRva2VuKGFkZHJlc3Mgd2FsbGV0KSBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgICAgICB0b3RhbFN1cHBseSA9IElOSVRJQUxfU1VQUExZOwogICAgICAgIHRva2VuQmFsYW5jZXNbd2FsbGV0XSA9IElOSVRJQUxfU1VQUExZICogMTAgKiogMTg7ICAgLy9TaW5jZSB3ZSBkaXZpZGVkIHRoZSB0b2tlbiBpbnRvIDEwXjE4IHBhcnRzCiAgICB9CgogICAgZnVuY3Rpb24gbWludChhZGRyZXNzIHdhbGxldCwgYWRkcmVzcyBidXllciwgdWludDI1NiB0b2tlbkFtb3VudCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgIHJlcXVpcmUodG9rZW5CYWxhbmNlc1t3YWxsZXRdID49IHRva2VuQW1vdW50KTsgICAgICAgICAgICAgICAvLyBjaGVja3MgaWYgaXQgaGFzIGVub3VnaCB0byBzZWxsCiAgICAgIHRva2VuQmFsYW5jZXNbYnV5ZXJdID0gdG9rZW5CYWxhbmNlc1tidXllcl0uYWRkKHRva2VuQW1vdW50KTsgICAgICAgICAgICAgICAgICAvLyBhZGRzIHRoZSBhbW91bnQgdG8gYnV5ZXIncyBiYWxhbmNlCiAgICAgIHRva2VuQmFsYW5jZXNbd2FsbGV0XSA9IHRva2VuQmFsYW5jZXNbd2FsbGV0XS5zdWIodG9rZW5BbW91bnQpOyAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN1YnRyYWN0cyBhbW91bnQgZnJvbSBzZWxsZXIncyBiYWxhbmNlCiAgICAgIFRyYW5zZmVyKHdhbGxldCwgYnV5ZXIsIHRva2VuQW1vdW50KTsgCiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHNob3dNeVRva2VuQmFsYW5jZShhZGRyZXNzIGFkZHIpIHB1YmxpYyB2aWV3IG9ubHlPd25lciByZXR1cm5zICh1aW50IHRva2VuQmFsYW5jZSkgewogICAgICAgIHRva2VuQmFsYW5jZSA9IHRva2VuQmFsYW5jZXNbYWRkcl07CiAgICAgICAgcmV0dXJuIHRva2VuQmFsYW5jZTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gc2hvd015RXRoZXJCYWxhbmNlKGFkZHJlc3MgYWRkcikgcHVibGljIHZpZXcgb25seU93bmVyIHJldHVybnMgKHVpbnQgZXRoZXJCYWxhbmNlKSB7CiAgICAgICAgZXRoZXJCYWxhbmNlID0gYWRkci5iYWxhbmNlOwogICAgfQp9CmNvbnRyYWN0IENyb3dkc2FsZSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CiAKICAvLyBUaGUgdG9rZW4gYmVpbmcgc29sZAogIEV0aGVlcmFUb2tlbiBwdWJsaWMgdG9rZW47CgogIC8vIHN0YXJ0IGFuZCBlbmQgdGltZXN0YW1wcyB3aGVyZSBpbnZlc3RtZW50cyBhcmUgYWxsb3dlZCAoYm90aCBpbmNsdXNpdmUpCiAgdWludDI1NiBwdWJsaWMgc3RhcnRUaW1lOwogIHVpbnQyNTYgcHVibGljIGVuZFRpbWU7CgogIC8vIGFkZHJlc3Mgd2hlcmUgZnVuZHMgYXJlIGNvbGxlY3RlZAogIC8vIGFkZHJlc3Mgd2hlcmUgdG9rZW5zIGFyZSBkZXBvc2l0ZWQgYW5kIGZyb20gd2hlcmUgd2Ugc2VuZCB0b2tlbnMgdG8gYnV5ZXJzCiAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0OwoKICAvLyBob3cgbWFueSB0b2tlbiB1bml0cyBhIGJ1eWVyIGdldHMgcGVyIHdlaQogIHVpbnQyNTYgcHVibGljIHJhdGVQZXJXZWkgPSAyMDAwOwoKICAvLyBhbW91bnQgb2YgcmFpc2VkIG1vbmV5IGluIHdlaQogIHVpbnQyNTYgcHVibGljIHdlaVJhaXNlZDsKCiAgLy8gZmxhZ3MgdG8gc2hvdyB3aGV0aGVyIHNvZnQgY2FwIC8gaGFyZCBjYXAgaXMgcmVhY2hlZAogIGJvb2wgcHVibGljIGlzU29mdENhcFJlYWNoZWQgPSBmYWxzZTsKICBib29sIHB1YmxpYyBpc0hhcmRDYXBSZWFjaGVkID0gZmFsc2U7CiAgICAKICAvL3RoaXMgZmxhZyBpcyBzZXQgdG8gdHJ1ZSB3aGVuIElDTyBkdXJhdGlvbiBpcyBvdmVyIGFuZCBzb2Z0IGNhcCBpcyBub3QgcmVhY2hlZCAgCiAgYm9vbCBwdWJsaWMgcmVmdW5kVG9CdXllcnMgPSBmYWxzZTsKICAgIAogIC8vIFNvZnQgY2FwIG9mIHRoZSBJQ08gaW4gZXRoZXJzICAKICB1aW50MjU2IHB1YmxpYyBzb2Z0Q2FwID0gNjAwMDsKICAgIAogIC8vSGFyZCBjYXAgb2YgdGhlIElDTyBpbiBldGhlcnMKICB1aW50MjU2IHB1YmxpYyBoYXJkQ2FwID0gMTAwMDAwOwogIAogIC8vdG90YWwgdG9rZW5zIHRoYXQgaGF2ZSBiZWVuIHNvbGQgIAogIHVpbnQyNTYgdG9rZW5zX3NvbGQgPSAwOwoKICAvL3RvdGFsIHRva2VucyB0aGF0IGFyZSB0byBiZSBzb2xkIC0gdGhpcyBpcyA3MCUgb2YgdGhlIHRvdGFsIHN1cHBseSBpLmUuIDMwMDAwMDAwMAogIHVpbnQgbWF4VG9rZW5zRm9yU2FsZSA9IDIxMDAwMDAwMDsKICAKICAvL3Rva2VucyB0aGF0IGFyZSByZXNlcnZlZCBmb3IgdGhlIGV0aGVlcmEgdGVhbSAtIHRoaXMgaXMgMzAlIG9mIHRoZSB0b3RhbCBzdXBwbHkgIAogIHVpbnQyNTYgdG9rZW5zRm9yUmVzZXJ2ZWRGdW5kID0gMDsKICB1aW50MjU2IHRva2Vuc0ZvckFkdmlzb3JzID0gMDsKICB1aW50MjU2IHRva2Vuc0ZvckZvdW5kZXJzQW5kVGVhbSA9IDA7CiAgdWludDI1NiB0b2tlbnNGb3JNYXJrZXRpbmcgPSAwOwogIHVpbnQyNTYgdG9rZW5zRm9yVG91cm5hbWVudCA9IDA7CgogIGJvb2wgZXRoZXJzU2VudEZvclJlZnVuZCA9IGZhbHNlOwogIHVpbnQyNTYgcHVibGljIGFtb3VudEZvclJlZnVuZElmU29mdENhcE5vdFJlYWNoZWQgPSAwOwogIC8vIHdoaXRlbGlzdGVkIGFkZHJlc3NlcyBhcmUgdGhvc2UgdGhhdCBoYXZlIHJlZ2lzdGVyZWQgb24gdGhlIHdlYnNpdGUKICBtYXBwaW5nKGFkZHJlc3M9PmJvb2wpIHdoaXRlTGlzdGVkQWRkcmVzc2VzOwoKICAvLyB0aGUgYnV5ZXJzIG9mIHRva2VucyBhbmQgdGhlIGFtb3VudCBvZiBldGhlcnMgdGhleSBzZW50IGluCiAgbWFwcGluZyhhZGRyZXNzPT51aW50KSB1c2Vyc1RoYXRCb3VnaHRFVEE7CiAKICAvKioKICAgKiBldmVudCBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAqIEBwYXJhbSBwdXJjaGFzZXIgd2hvIHBhaWQgZm9yIHRoZSB0b2tlbnMKICAgKiBAcGFyYW0gYmVuZWZpY2lhcnkgd2hvIGdvdCB0aGUgdG9rZW5zCiAgICogQHBhcmFtIHZhbHVlIHdlaXMgcGFpZCBmb3IgcHVyY2hhc2UKICAgKiBAcGFyYW0gYW1vdW50IGFtb3VudCBvZiB0b2tlbnMgcHVyY2hhc2VkCiAgICovCiAgZXZlbnQgVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgdmFsdWUsIHVpbnQyNTYgYW1vdW50KTsKCgogIGZ1bmN0aW9uIENyb3dkc2FsZSh1aW50MjU2IF9zdGFydFRpbWUsIGFkZHJlc3MgX3dhbGxldCkgcHVibGljIHsKICAgIAogICAgcmVxdWlyZShfc3RhcnRUaW1lID49IG5vdyk7CiAgICBzdGFydFRpbWUgPSBfc3RhcnRUaW1lOwogICAgZW5kVGltZSA9IHN0YXJ0VGltZSArIDYwIGRheXM7CiAgICAKICAgIHJlcXVpcmUoZW5kVGltZSA+PSBzdGFydFRpbWUpOwogICAgcmVxdWlyZShfd2FsbGV0ICE9IDB4MCk7CgogICAgd2FsbGV0ID0gX3dhbGxldDsKICAgIHRva2VuID0gY3JlYXRlVG9rZW5Db250cmFjdCh3YWxsZXQpOwogIH0KCiAgZnVuY3Rpb24gY3JlYXRlVG9rZW5Db250cmFjdChhZGRyZXNzIHdhbGwpIGludGVybmFsIHJldHVybnMgKEV0aGVlcmFUb2tlbikgewogICAgcmV0dXJuIG5ldyBFdGhlZXJhVG9rZW4od2FsbCk7CiAgfQoKICAvLyBmYWxsYmFjayBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBidXkgdG9rZW5zCiAgZnVuY3Rpb24gKCkgcHVibGljIHBheWFibGUgewogICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwogIH0KCiAgLy9kZXRlcm1pbmUgdGhlIGJvbnVzIHdpdGggcmVzcGVjdCB0byB0aW1lIGVsYXBzZWQKICBmdW5jdGlvbiBkZXRlcm1pbmVCb251cyh1aW50IHRva2VucykgaW50ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2IGJvbnVzKSB7CiAgICAKICAgIHVpbnQyNTYgdGltZUVsYXBzZWQgPSBub3cgLSBzdGFydFRpbWU7CiAgICB1aW50MjU2IHRpbWVFbGFwc2VkSW5XZWVrcyA9IHRpbWVFbGFwc2VkLmRpdig3IGRheXMpOwogICAgCiAgICBpZiAodGltZUVsYXBzZWRJbldlZWtzIDw9MSkKICAgIHsKICAgICAgICAvL2Vhcmx5IHNhbGUKICAgICAgICAvL3ZhbGlkIGZvciA3IGRheXMgKDFzdCB3ZWVrKQogICAgICAgIC8vMzAwMDArIFRPS0VOIFBVUkNIQVNFIEFNT1VOVCAvIDMzJSBCT05VUwogICAgICAgIGlmICh0b2tlbnM+MzAwMDAgKiAxMCAqKiAxOCkKICAgICAgICB7CiAgICAgICAgICAgIC8vMzMlIGJvbnVzCiAgICAgICAgICAgIGJvbnVzID0gdG9rZW5zLm11bCgzMyk7CiAgICAgICAgICAgIGJvbnVzID0gYm9udXMuZGl2KDEwMCk7CiAgICAgICAgfQogICAgICAgIC8vMTAwMDArIFRPS0VOIFBVUkNIQVNFIEFNT1VOVCAvIDI2JSBCT05VUwogICAgICAgIGVsc2UgaWYgKHRva2Vucz4xMDAwMCAqMTAgKiogMTggJiYgdG9rZW5zPD0gMzAwMDAgKiAxMCAqKiAxOCkKICAgICAgICB7CiAgICAgICAgICAgIC8vMjYlIGJvbnVzCiAgICAgICAgICAgIGJvbnVzID0gdG9rZW5zLm11bCgyNik7CiAgICAgICAgICAgIGJvbnVzID0gYm9udXMuZGl2KDEwMCk7CiAgICAgICAgfQogICAgICAgIC8vMzAwMCsgVE9LRU4gUFVSQ0hBU0UgQU1PVU5UIC8gMjMlIEJPTlVTCiAgICAgICAgZWxzZSBpZiAodG9rZW5zPjMwMDAgKjEwICoqIDE4ICYmIHRva2Vuczw9IDEwMDAwICogMTAgKiogMTgpCiAgICAgICAgewogICAgICAgICAgICAvLzIzJSBib251cwogICAgICAgICAgICBib251cyA9IHRva2Vucy5tdWwoMjMpOwogICAgICAgICAgICBib251cyA9IGJvbnVzLmRpdigxMDApOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLzc1KyBUT0tFTiBQVVJDSEFTRSBBTU9VTlQgLyAyMCUgQk9OVVMKICAgICAgICBlbHNlIGlmICh0b2tlbnM+PTc1ICoxMCAqKiAxOCAmJiB0b2tlbnM8PSAzMDAwICogMTAgKiogMTgpCiAgICAgICAgewogICAgICAgICAgICAvLzIwJSBib251cwogICAgICAgICAgICBib251cyA9IHRva2Vucy5tdWwoMjApOwogICAgICAgICAgICBib251cyA9IGJvbnVzLmRpdigxMDApOwogICAgICAgIH0KICAgIH0KICAgIGVsc2UgaWYgKHRpbWVFbGFwc2VkSW5XZWVrcz4xICYmIHRpbWVFbGFwc2VkSW5XZWVrcyA8PTYpCiAgICB7CiAgICAgICAgLy9zYWxlCiAgICAgICAgLy9mcm9tIDd0aCBkYXkgdGlsbCA0OXRoIGRheSAodG90YWwgNDIgZGF5cyBvciA2IHdlZWtzKQogICAgICAgIC8vMzAwMDArIFRPS0VOIFBVUkNIQVNFIEFNT1VOVCAvIDE1JSBCT05VUwogICAgICAgIGlmICh0b2tlbnM+MzAwMDAgKiAxMCAqKiAxOCkKICAgICAgICB7CiAgICAgICAgICAgIC8vMTUlIGJvbnVzCiAgICAgICAgICAgIGJvbnVzID0gdG9rZW5zLm11bCgxNSk7CiAgICAgICAgICAgIGJvbnVzID0gYm9udXMuZGl2KDEwMCk7CiAgICAgICAgfQogICAgICAgIC8vMTAwMDArIFRPS0VOIFBVUkNIQVNFIEFNT1VOVCAvIDEwJSBCT05VUwogICAgICAgIGVsc2UgaWYgKHRva2Vucz4xMDAwMCAqMTAgKiogMTggJiYgdG9rZW5zPD0gMzAwMDAgKiAxMCAqKiAxOCkKICAgICAgICB7CiAgICAgICAgICAgIC8vMTAlIGJvbnVzCiAgICAgICAgICAgIGJvbnVzID0gdG9rZW5zLm11bCgxMCk7CiAgICAgICAgICAgIGJvbnVzID0gYm9udXMuZGl2KDEwMCk7CiAgICAgICAgfQogICAgICAgIC8vMzAwMCsgVE9LRU4gUFVSQ0hBU0UgQU1PVU5UIC8gNSUgQk9OVVMKICAgICAgICBlbHNlIGlmICh0b2tlbnM+MzAwMCAqMTAgKiogMTggJiYgdG9rZW5zPD0gMTAwMDAgKiAxMCAqKiAxOCkKICAgICAgICB7CiAgICAgICAgICAgIC8vNSUgYm9udXMKICAgICAgICAgICAgYm9udXMgPSB0b2tlbnMubXVsKDUpOwogICAgICAgICAgICBib251cyA9IGJvbnVzLmRpdigxMDApOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLzc1KyBUT0tFTiBQVVJDSEFTRSBBTU9VTlQgLyAzJSBCT05VUwogICAgICAgIGVsc2UgaWYgKHRva2Vucz49NzUgKjEwICoqIDE4ICYmIHRva2Vuczw9IDMwMDAgKiAxMCAqKiAxOCkKICAgICAgICB7CiAgICAgICAgICAgIC8vMyUgYm9udXMKICAgICAgICAgICAgYm9udXMgPSB0b2tlbnMubXVsKDMpOwogICAgICAgICAgICBib251cyA9IGJvbnVzLmRpdigxMDApOwogICAgICAgIH0KICAgIH0KICAgIGVsc2UgaWYgKHRpbWVFbGFwc2VkSW5XZWVrcz42KQogICAgewogICAgICAgIC8vbm8gYm9udXNlcyBhZnRlciA3dGggd2VlayBpLmUuIDQ5IGRheXMKICAgICAgICBib251cyA9IDA7CiAgICB9CiAgfQoKICAvLyBsb3cgbGV2ZWwgdG9rZW4gcHVyY2hhc2UgZnVuY3Rpb24KICAvLyBNaW5pbXVtIHB1cmNoYXNlIGNhbiBiZSBvZiAxIEVUSAogIAogIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgcGF5YWJsZSB7CiAgICAKICAvL3Rva2VucyBub3QgdG8gYmUgc2VudCB0byAweDAKICByZXF1aXJlKGJlbmVmaWNpYXJ5ICE9IDB4MCk7CiAgCiAgYm9vbCBoYXNJQ09lbmRlZCA9IGhhc0VuZGVkKCk7CiAgCiAgaWYoaGFzSUNPZW5kZWQgJiYgd2VpUmFpc2VkIDwgc29mdENhcCAqIDEwICoqIDE4KQogICAgICByZWZ1bmRUb0J1eWVycyA9IHRydWU7CiAgICAgICAgCiAgaWYoaGFzSUNPZW5kZWQgJiYgd2VpUmFpc2VkIDwgaGFyZENhcCAqIDEwICoqIDE4KQogIHsKICAgICAgYnVyblJlbWFpbmluZ1Rva2VucygpOwogICAgICBiZW5lZmljaWFyeS50cmFuc2Zlcihtc2cudmFsdWUpOwogIH0KICBlbHNlCiAgewogIAogICAgLy90aGUgcHVyY2hhc2Ugc2hvdWxkIGJlIHdpdGhpbiBkdXJhdGlvbiBhbmQgbm9uIHplcm8KICAgIHJlcXVpcmUodmFsaWRQdXJjaGFzZSgpKTsKICAKICAgIC8vdGhlIElDTyBpcyBvdmVyIGlmIGhhcmQgY2FwIGhhcyBiZWVuIHJlYWNoZWQgZXZlbiBpZiB0aW1lIGlzIHN0aWxsIGxlZnQKICAgIHJlcXVpcmUoaXNIYXJkQ2FwUmVhY2hlZCA9PSBmYWxzZSk7CiAgICAKICAgIC8vIGFtb3VudCBzZW50IGJ5IHRoZSB1c2VyCiAgICB1aW50MjU2IHdlaUFtb3VudCA9IG1zZy52YWx1ZTsKICAgIAogICAgLy8gY2FsY3VsYXRlIHRva2VuIGFtb3VudCB0byBiZSBzb2xkCiAgICB1aW50MjU2IHRva2VucyA9IHdlaUFtb3VudC5tdWwocmF0ZVBlcldlaSk7CiAgCiAgICAvL0RldGVybWluZSBib251cwogICAgdWludCBib251cyA9IGRldGVybWluZUJvbnVzKHRva2Vucyk7CiAgICB0b2tlbnMgPSB0b2tlbnMuYWRkKGJvbnVzKTsKCiAgICByZXF1aXJlICh0b2tlbnM+PTc1ICogMTAgKiogMTgpOwogIAogICAgLy9jYW4ndCBzYWxlIHRva2VucyBtb3JlIHRoYW4gMjEwMDAwMDAwMDAKICAgIHJlcXVpcmUodG9rZW5zX3NvbGQgKyB0b2tlbnMgPD0gbWF4VG9rZW5zRm9yU2FsZSAqIDEwICoqIDE4KTsKICAKICAgIC8vMzAlIG9mIHRoZSB0b2tlbnMgYmVpbmcgc29sZCBhcmUgYmVpbmcgYWNjdW11bGF0ZWQgZm9yIHRoZSBldGhlZXJhIHRlYW0KICAgIHVwZGF0ZVRva2Vuc0ZvckV0aGVlcmFUZWFtKHRva2Vucyk7CiAgCiAgICAvLyB1cGRhdGUgc3RhdGUKICAgIHJlcXVpcmUod2VpUmFpc2VkLmFkZCh3ZWlBbW91bnQpIDw9IGhhcmRDYXAgKiAxMCAqKiAxOCk7CgogICAgd2VpUmFpc2VkID0gd2VpUmFpc2VkLmFkZCh3ZWlBbW91bnQpOwogICAgYW1vdW50Rm9yUmVmdW5kSWZTb2Z0Q2FwTm90UmVhY2hlZCA9IGFtb3VudEZvclJlZnVuZElmU29mdENhcE5vdFJlYWNoZWQuYWRkKHdlaUFtb3VudCk7CiAgICAKICAgIGlmICh3ZWlSYWlzZWQgPj0gc29mdENhcCAqIDEwICoqIDE4KQogICAgewogICAgICBpc1NvZnRDYXBSZWFjaGVkID0gdHJ1ZTsKICAgICAgYW1vdW50Rm9yUmVmdW5kSWZTb2Z0Q2FwTm90UmVhY2hlZCA9IDA7CiAgICB9CiAgCiAgICBpZiAod2VpUmFpc2VkID09IGhhcmRDYXAgKiAxMCAqKiAxOCkKICAgICAgaXNIYXJkQ2FwUmVhY2hlZCA9IHRydWU7CiAgICAKICAgIHRva2VuLm1pbnQod2FsbGV0LCBiZW5lZmljaWFyeSwgdG9rZW5zKTsgCiAgICB1c2Vyc1RoYXRCb3VnaHRFVEFbYmVuZWZpY2lhcnldID0gd2VpQW1vdW50OwogICAgVG9rZW5QdXJjaGFzZShtc2cuc2VuZGVyLCBiZW5lZmljaWFyeSwgd2VpQW1vdW50LCB0b2tlbnMpOwogICAgCiAgICB0b2tlbnNfc29sZCA9IHRva2Vuc19zb2xkLmFkZCh0b2tlbnMpOwogICAgCiAgICBmb3J3YXJkRnVuZHMoKTsKICB9CiB9CgogIC8vIHNlbmQgZXRoZXIgdG8gdGhlIGZ1bmQgY29sbGVjdGlvbiB3YWxsZXQKICAvLyBvdmVycmlkZSB0byBjcmVhdGUgY3VzdG9tIGZ1bmQgZm9yd2FyZGluZyBtZWNoYW5pc21zCiAgZnVuY3Rpb24gZm9yd2FyZEZ1bmRzKCkgaW50ZXJuYWwgewogICAgd2FsbGV0LnRyYW5zZmVyKG1zZy52YWx1ZSk7CiAgfQoKICAvLyBAcmV0dXJuIHRydWUgaWYgdGhlIHRyYW5zYWN0aW9uIGNhbiBidXkgdG9rZW5zCiAgZnVuY3Rpb24gdmFsaWRQdXJjaGFzZSgpIGludGVybmFsIHJldHVybnMgKGJvb2wpIHsKICAgIGJvb2wgd2l0aGluUGVyaW9kID0gbm93ID49IHN0YXJ0VGltZSAmJiBub3cgPD0gZW5kVGltZTsKICAgIGJvb2wgbm9uWmVyb1B1cmNoYXNlID0gbXNnLnZhbHVlICE9IDA7CiAgICByZXR1cm4gd2l0aGluUGVyaW9kICYmIG5vblplcm9QdXJjaGFzZTsKICB9CgogIC8vIEByZXR1cm4gdHJ1ZSBpZiBjcm93ZHNhbGUgZXZlbnQgaGFzIGVuZGVkCiAgZnVuY3Rpb24gaGFzRW5kZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIG5vdyA+IGVuZFRpbWU7CiAgfQogIAogICBmdW5jdGlvbiBzaG93TXlUb2tlbkJhbGFuY2UoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiB0b2tlbkJhbGFuY2UpIHsKICAgICAgICB0b2tlbkJhbGFuY2UgPSB0b2tlbi5zaG93TXlUb2tlbkJhbGFuY2UobXNnLnNlbmRlcik7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHNob3dNeUV0aGVyQmFsYW5jZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGV0aGVyQmFsYW5jZSkgewogICAgICAgIGV0aGVyQmFsYW5jZSA9IHRva2VuLnNob3dNeUV0aGVyQmFsYW5jZShtc2cuc2VuZGVyKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gYnVyblJlbWFpbmluZ1Rva2VucygpIGludGVybmFsCiAgICB7CiAgICAgICAgLy9idXJuIGFsbCB0aGUgdW5zb2xkIHRva2VucyBhcyBzb29uIGFzIHRoZSBJQ08gaXMgZW5kZWQKICAgICAgICB1aW50IGJhbGFuY2UgPSB0b2tlbi5zaG93TXlUb2tlbkJhbGFuY2Uod2FsbGV0KTsKICAgICAgICB1aW50IHRva2Vuc0lzc3VlZCA9IHRva2Vuc0ZvclJlc2VydmVkRnVuZCArIHRva2Vuc0ZvckZvdW5kZXJzQW5kVGVhbSArIHRva2Vuc0ZvckFkdmlzb3JzICt0b2tlbnNGb3JNYXJrZXRpbmcgKyB0b2tlbnNGb3JUb3VybmFtZW50OwogICAgICAgIHVpbnQgdG9rZW5zVG9CdXJuID0gYmFsYW5jZS5zdWIodG9rZW5zSXNzdWVkKTsKICAgICAgICByZXF1aXJlIChiYWxhbmNlID49dG9rZW5zVG9CdXJuKTsKICAgICAgICBhZGRyZXNzIGJ1cm5BZGRyZXNzID0gMHgwOwogICAgICAgIHRva2VuLm1pbnQod2FsbGV0LGJ1cm5BZGRyZXNzLHRva2Vuc1RvQnVybik7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGFkZEFkZHJlc3NUb1doaXRlTGlzdChhZGRyZXNzIHdoaXRlbGlzdGFkZHJlc3MpIHB1YmxpYyAKICAgIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gd2FsbGV0KTsKICAgICAgICB3aGl0ZUxpc3RlZEFkZHJlc3Nlc1t3aGl0ZWxpc3RhZGRyZXNzXSA9IHRydWU7CiAgICB9IAogICAgCiAgICBmdW5jdGlvbiBnZXRSZWZ1bmQoKSBwdWJsaWMgCiAgICB7CiAgICAgICAgcmVxdWlyZShyZWZ1bmRUb0J1eWVycyA9PSB0cnVlICYmIGV0aGVyc1NlbnRGb3JSZWZ1bmQgPT0gdHJ1ZSk7CiAgICAgICAgcmVxdWlyZSh1c2Vyc1RoYXRCb3VnaHRFVEFbbXNnLnNlbmRlcl0+MCk7CiAgICAgICAgdWludDI1NiBldGhlcnNTZW50ID0gdXNlcnNUaGF0Qm91Z2h0RVRBW21zZy5zZW5kZXJdOwogICAgICAgIHJlcXVpcmUgKHdhbGxldC5iYWxhbmNlID49IGV0aGVyc1NlbnQpOwogICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoZXRoZXJzU2VudCk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGRlYml0QW1vdW50VG9SZWZ1bmQoKSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZShoYXNFbmRlZCgpPT10cnVlKTsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gd2FsbGV0KTsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+PWFtb3VudEZvclJlZnVuZElmU29mdENhcE5vdFJlYWNoZWQpOwogICAgICAgIGV0aGVyc1NlbnRGb3JSZWZ1bmQgPSB0cnVlOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB1cGRhdGVUb2tlbnNGb3JFdGhlZXJhVGVhbSh1aW50MjU2IHRva2VucykgaW50ZXJuYWwgewogICAgICAgIAogICAgICAgIHVpbnQyNTYgcmVzZXJ2ZWRGdW5kVG9rZW5zOwogICAgICAgIHVpbnQyNTYgZm91bmRlcnNBbmRUZWFtVG9rZW5zOwogICAgICAgIHVpbnQyNTYgYWR2aXNvcnNUb2tlbnM7CiAgICAgICAgdWludDI1NiBtYXJrZXRpbmdUb2tlbnM7CiAgICAgICAgdWludDI1NiB0b3VybmFtZW50VG9rZW5zOwogICAgICAgIAogICAgICAgIC8vMTAlIG9mIHRva2VucyBmb3IgcmVzZXJ2ZWQgZnVuZAogICAgICAgIHJlc2VydmVkRnVuZFRva2VucyA9IHRva2Vucy5tdWwoMTApOwogICAgICAgIHJlc2VydmVkRnVuZFRva2VucyA9IHJlc2VydmVkRnVuZFRva2Vucy5kaXYoMTAwKTsKICAgICAgICB0b2tlbnNGb3JSZXNlcnZlZEZ1bmQgPSB0b2tlbnNGb3JSZXNlcnZlZEZ1bmQuYWRkKHJlc2VydmVkRnVuZFRva2Vucyk7CiAgICAKICAgICAgICAvLzE1JSBvZiB0b2tlbnMgZm9yIGZvdW5kZXJzIGFuZCB0ZWFtICAgIAogICAgICAgIGZvdW5kZXJzQW5kVGVhbVRva2Vucz10b2tlbnMubXVsKDE1KTsKICAgICAgICBmb3VuZGVyc0FuZFRlYW1Ub2tlbnM9IGZvdW5kZXJzQW5kVGVhbVRva2Vucy5kaXYoMTAwKTsKICAgICAgICB0b2tlbnNGb3JGb3VuZGVyc0FuZFRlYW0gPSB0b2tlbnNGb3JGb3VuZGVyc0FuZFRlYW0uYWRkKGZvdW5kZXJzQW5kVGVhbVRva2Vucyk7CiAgICAKICAgICAgICAvLzMlIG9mIHRva2VucyBmb3IgYWR2aXNvcnMKICAgICAgICBhZHZpc29yc1Rva2Vucz10b2tlbnMubXVsKDMpOwogICAgICAgIGFkdmlzb3JzVG9rZW5zPSBhZHZpc29yc1Rva2Vucy5kaXYoMTAwKTsKICAgICAgICB0b2tlbnNGb3JBZHZpc29ycz0gdG9rZW5zRm9yQWR2aXNvcnMuYWRkKGFkdmlzb3JzVG9rZW5zKTsKICAgIAogICAgICAgIC8vMSUgb2YgdG9rZW5zIGZvciBtYXJrZXRpbmcKICAgICAgICBtYXJrZXRpbmdUb2tlbnMgPSB0b2tlbnMubXVsKDEpOwogICAgICAgIG1hcmtldGluZ1Rva2Vucz0gbWFya2V0aW5nVG9rZW5zLmRpdigxMDApOwogICAgICAgIHRva2Vuc0Zvck1hcmtldGluZz0gdG9rZW5zRm9yTWFya2V0aW5nLmFkZChtYXJrZXRpbmdUb2tlbnMpOwogICAgICAgIAogICAgICAgIC8vMSUgb2YgdG9rZW5zIGZvciB0b3VybmFtZW50IAogICAgICAgIHRvdXJuYW1lbnRUb2tlbnM9dG9rZW5zLm11bCgxKTsKICAgICAgICB0b3VybmFtZW50VG9rZW5zPSB0b3VybmFtZW50VG9rZW5zLmRpdigxMDApOwogICAgICAgIHRva2Vuc0ZvclRvdXJuYW1lbnQ9IHRva2Vuc0ZvclRvdXJuYW1lbnQuYWRkKHRvdXJuYW1lbnRUb2tlbnMpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB3aXRoZHJhd1Rva2Vuc0ZvckV0aGVlcmFUZWFtKHVpbnQyNTYgd2hvc2VUb2tlbnNUb1dpdGhkcmF3LGFkZHJlc3NbXSB3aGVyZVRvU2VuZFRva2VucykgcHVibGljIHsKICAgICAgICAvLzEgcmVzZXJ2ZWQgZnVuZCwgMiBmb3IgZm91bmRlcnMgYW5kIHRlYW0sIDMgZm9yIGFkdmlzb3JzLCA0IGZvciBtYXJrZXRpbmcsIDUgZm9yIHRvdXJuYW1lbnQKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gd2FsbGV0KTsKICAgICAgICByZXF1aXJlKG5vdz49ZW5kVGltZSk7CiAgICAgICAgdWludDI1NiBsb2NrUGVyaW9kID0gMDsKICAgICAgICB1aW50MjU2IHRpbWVQYXNzZWQgPSBub3cgLSBlbmRUaW1lOwogICAgICAgIHVpbnQyNTYgdG9rZW5zVG9TZW5kID0gMDsKICAgICAgICB1aW50MjU2IGkgPSAwOwogICAgICAgIGlmICh3aG9zZVRva2Vuc1RvV2l0aGRyYXcgPT0gMSkKICAgICAgICB7CiAgICAgICAgICAvLzE1IG1vbnRocyBsb2NrdXAgcGVyaW9kCiAgICAgICAgICBsb2NrUGVyaW9kID0gMTUgZGF5cyAqIDMwOwogICAgICAgICAgcmVxdWlyZSh0aW1lUGFzc2VkID49IGxvY2tQZXJpb2QpOwogICAgICAgICAgLy9hbGxvdyB3aXRoZHJhd2FsCiAgICAgICAgICB0b2tlbnNUb1NlbmQgPSB0b2tlbnNGb3JSZXNlcnZlZEZ1bmQuZGl2KHdoZXJlVG9TZW5kVG9rZW5zLmxlbmd0aCk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgIGZvciAoaT0wO2k8d2hlcmVUb1NlbmRUb2tlbnMubGVuZ3RoO2krKykKICAgICAgICAgIHsKICAgICAgICAgICAgdG9rZW4ubWludCh3YWxsZXQsd2hlcmVUb1NlbmRUb2tlbnNbaV0sdG9rZW5zVG9TZW5kKTsKICAgICAgICAgIH0KICAgICAgICAgIHRva2Vuc0ZvclJlc2VydmVkRnVuZCA9IDA7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKHdob3NlVG9rZW5zVG9XaXRoZHJhdyA9PSAyKQogICAgICAgIHsKICAgICAgICAgIC8vMTAgbW9udGhzIGxvY2t1cCBwZXJpb2QKICAgICAgICAgIGxvY2tQZXJpb2QgPSAxMCBkYXlzICogMzA7CiAgICAgICAgICByZXF1aXJlKHRpbWVQYXNzZWQgPj0gbG9ja1BlcmlvZCk7CiAgICAgICAgICAvL2FsbG93IHdpdGhkcmF3YWwKICAgICAgICAgIHRva2Vuc1RvU2VuZCA9IHRva2Vuc0ZvckZvdW5kZXJzQW5kVGVhbS5kaXYod2hlcmVUb1NlbmRUb2tlbnMubGVuZ3RoKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgZm9yIChpPTA7aTx3aGVyZVRvU2VuZFRva2Vucy5sZW5ndGg7aSsrKQogICAgICAgICAgewogICAgICAgICAgICB0b2tlbi5taW50KHdhbGxldCx3aGVyZVRvU2VuZFRva2Vuc1tpXSx0b2tlbnNUb1NlbmQpOwogICAgICAgICAgfSAgICAgICAgICAgIAogICAgICAgICAgdG9rZW5zRm9yRm91bmRlcnNBbmRUZWFtID0gMDsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAod2hvc2VUb2tlbnNUb1dpdGhkcmF3ID09IDMpCiAgICAgICAgewogICAgICAgICAgLy9hbGxvdyB3aXRoZHJhd2FsCiAgICAgICAgICB0b2tlbnNUb1NlbmQgPSB0b2tlbnNGb3JBZHZpc29ycy5kaXYod2hlcmVUb1NlbmRUb2tlbnMubGVuZ3RoKTsgICAgICAgIAogICAgICAgICAgZm9yIChpPTA7aTx3aGVyZVRvU2VuZFRva2Vucy5sZW5ndGg7aSsrKQogICAgICAgICAgewogICAgICAgICAgICB0b2tlbi5taW50KHdhbGxldCx3aGVyZVRvU2VuZFRva2Vuc1tpXSx0b2tlbnNUb1NlbmQpOwogICAgICAgICAgfQogICAgICAgICAgdG9rZW5zRm9yQWR2aXNvcnMgPSAwOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmICh3aG9zZVRva2Vuc1RvV2l0aGRyYXcgPT0gNCkKICAgICAgICB7CiAgICAgICAgICAvL2FsbG93IHdpdGhkcmF3YWwKICAgICAgICAgIHRva2Vuc1RvU2VuZCA9IHRva2Vuc0Zvck1hcmtldGluZy5kaXYod2hlcmVUb1NlbmRUb2tlbnMubGVuZ3RoKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgZm9yIChpPTA7aTx3aGVyZVRvU2VuZFRva2Vucy5sZW5ndGg7aSsrKQogICAgICAgICAgewogICAgICAgICAgICB0b2tlbi5taW50KHdhbGxldCx3aGVyZVRvU2VuZFRva2Vuc1tpXSx0b2tlbnNUb1NlbmQpOwogICAgICAgICAgfQogICAgICAgICAgdG9rZW5zRm9yTWFya2V0aW5nID0gMDsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAod2hvc2VUb2tlbnNUb1dpdGhkcmF3ID09IDUpCiAgICAgICAgewogICAgICAgICAgLy9hbGxvdyB3aXRoZHJhd2FsCiAgICAgICAgICB0b2tlbnNUb1NlbmQgPSB0b2tlbnNGb3JUb3VybmFtZW50LmRpdih3aGVyZVRvU2VuZFRva2Vucy5sZW5ndGgpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICBmb3IgKGk9MDtpPHdoZXJlVG9TZW5kVG9rZW5zLmxlbmd0aDtpKyspCiAgICAgICAgICB7CiAgICAgICAgICAgIHRva2VuLm1pbnQod2FsbGV0LHdoZXJlVG9TZW5kVG9rZW5zW2ldLHRva2Vuc1RvU2VuZCk7CiAgICAgICAgICB9CiAgICAgICAgICB0b2tlbnNGb3JUb3VybmFtZW50ID0gMDsKICAgICAgICB9CiAgICAgICAgZWxzZSAKICAgICAgICB7CiAgICAgICAgICAvL3dyb25nIGlucHV0CiAgICAgICAgICByZXF1aXJlICgxIT0xKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8qKgogICAgICogZnVuY3Rpb24gdG8gc2V0IHRoZSBuZXcgcHJpY2UgCiAgICAgKiBjYW4gb25seSBiZSBjYWxsZWQgZnJvbSBvd25lciB3YWxsZXQKICAgICAqKi8gCiAgICBmdW5jdGlvbiBzZXRQcmljZVJhdGUodWludDI1NiBuZXdQcmljZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByYXRlUGVyV2VpID0gbmV3UHJpY2U7CiAgICB9Cn0='.
	

]
