Class {
	#name : #SRT0c507d48c0cd1232b82aa950d487d01cfc6442db,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT0c507d48c0cd1232b82aa950d487d01cfc6442db >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKioKICogQHRpdGxlIEVSQzcyMSBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL2VpcHMvaXNzdWVzLzcyMQogKi8KY29udHJhY3QgRVJDNzIxIHsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfYXBwcm92ZWQsIHVpbnQyNTYgX3Rva2VuSWQpOwoKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgX2JhbGFuY2UpOwogIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBfb3duZXIpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWM7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljOwogIGZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JZCkgcHVibGljOwp9CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgogIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQogIAogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBFUkM3MjFUb2tlbgogKiBHZW5lcmljIGltcGxlbWVudGF0aW9uIGZvciB0aGUgcmVxdWlyZWQgZnVuY3Rpb25hbGl0eSBvZiB0aGUgRVJDNzIxIHN0YW5kYXJkCiAqLwpjb250cmFjdCBDb3VudHJ5VG9rZW4gaXMgRVJDNzIxLCBPd25hYmxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgLy8gVG90YWwgYW1vdW50IG9mIHRva2VucwogIHVpbnQyNTYgcHJpdmF0ZSB0b3RhbFRva2VuczsKICB1aW50MjU2W10gcHJpdmF0ZSBsaXN0ZWRDb3VudHJpZXM7CiAgdWludDI1NiBwdWJsaWMgZGV2T3dlZDsKICB1aW50MjU2IHB1YmxpYyBwb29sVG90YWw7CiAgdWludDI1NiBwdWJsaWMgbGFzdFB1cmNoYXNlOwoKICAvLyBDb3VudHJ5IERhdGEKICBtYXBwaW5nICh1aW50MjU2ID0+IENvdW50cnkpIHB1YmxpYyBjb3VudHJ5RGF0YTsKCiAgLy8gTWFwcGluZyBmcm9tIHRva2VuIElEIHRvIG93bmVyCiAgbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSBwcml2YXRlIHRva2VuT3duZXI7CgogIC8vIE1hcHBpbmcgZnJvbSB0b2tlbiBJRCB0byBhcHByb3ZlZCBhZGRyZXNzCiAgbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSBwcml2YXRlIHRva2VuQXBwcm92YWxzOwoKICAvLyBNYXBwaW5nIGZyb20gb3duZXIgdG8gbGlzdCBvZiBvd25lZCB0b2tlbiBJRHMKICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTZbXSkgcHJpdmF0ZSBvd25lZFRva2VuczsKCiAgLy8gTWFwcGluZyBmcm9tIHRva2VuIElEIHRvIGluZGV4IG9mIHRoZSBvd25lciB0b2tlbnMgbGlzdAogIG1hcHBpbmcodWludDI1NiA9PiB1aW50MjU2KSBwcml2YXRlIG93bmVkVG9rZW5zSW5kZXg7CgogIC8vIEJhbGFuY2VzIGZyb20gJSBwYXlvdXRzLgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHJpdmF0ZSBwYXlvdXRCYWxhbmNlczsgCgogIC8vIEV2ZW50cwogIGV2ZW50IENvdW50cnlQdXJjaGFzZWQodWludDI1NiBpbmRleGVkIF90b2tlbklkLCBhZGRyZXNzIGluZGV4ZWQgX293bmVyLCB1aW50MjU2IF9wdXJjaGFzZVByaWNlKTsKCiAgLy8gUHVyY2hhc2luZyBDYXBzIGZvciBEZXRlcm1pbmluZyBOZXh0IFBvb2wgQ3V0CiAgdWludDI1NiBwcml2YXRlIGZpcnN0Q2FwICA9IDAuNSBldGhlcjsKICB1aW50MjU2IHByaXZhdGUgc2Vjb25kQ2FwID0gMS4wIGV0aGVyOwogIHVpbnQyNTYgcHJpdmF0ZSB0aGlyZENhcCAgPSAzLjAgZXRoZXI7CiAgdWludDI1NiBwcml2YXRlIGZpbmFsQ2FwICA9IDUuMCBldGhlcjsKCiAgLy8gU3RydWN0IHRvIHN0b3JlIENvdW50cnkgRGF0YQogIHN0cnVjdCBDb3VudHJ5IHsKICAgICAgdWludDI1NiBzdGFydGluZ1ByaWNlOyAvLyBQcmljZSB0aGUgaXRlbSBzdGFydGVkIGF0LgogICAgICB1aW50MjU2IHByaWNlOyAgICAgICAgIC8vIEN1cnJlbnQgcHJpY2Ugb2YgdGhlIGl0ZW0uCiAgICAgIHVpbnQyNTYgbGFzdFByaWNlOyAgICAgLy8gbGFzdFByaWNlIHRoaXMgd2FzIHNvbGQgZm9yLCB1c2VkIGZvciBhZGRpbmcgdG8gcG9vbC4KICAgICAgdWludDI1NiBwYXlvdXQ7ICAgICAgICAvLyBUaGUgcGVyY2VudCBvZiB0aGUgcG9vbCByZXdhcmRlZC4KICAgICAgdWludDI1NiB3aXRoZHJhd247ICAgICAvLyBUaGUgYW1vdW50IG9mIEV0aCB0aGlzIGNvdW50cnkgaGFzIHdpdGhkcmF3biBmcm9tIHRoZSBwb29sLgogICAgICBhZGRyZXNzIG93bmVyOyAgICAgICAgIC8vIEN1cnJlbnQgb3duZXIgb2YgdGhlIGl0ZW0uCiAgfQoKICAvKioKICAqIEBkZXYgY3JlYXRlTGlzdGluZyBBZGRzIG5ldyBFUkM3MjEgVG9rZW4KICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIG5ldyB0b2tlbgogICogQHBhcmFtIF9zdGFydGluZ1ByaWNlIHVpbnQyNTYgc3RhcnRpbmcgcHJpY2UgaW4gd2VpCiAgKiBAcGFyYW0gX3BheW91dFBlcmNlbnRhZ2UgdWludDI1NiBwYXlvdXQgcGVyY2VudGFnZSAoZGl2aXNpYmxlIGJ5IDEwKQogICogQHBhcmFtIF9vd25lciBhZGRyZXNzIG9mIG5ldyBvd25lcgogICovCiAgZnVuY3Rpb24gY3JlYXRlTGlzdGluZyh1aW50MjU2IF90b2tlbklkLCB1aW50MjU2IF9zdGFydGluZ1ByaWNlLCB1aW50MjU2IF9wYXlvdXRQZXJjZW50YWdlLCBhZGRyZXNzIF9vd25lcikgb25seU93bmVyKCkgcHVibGljIHsKCiAgICAvLyBtYWtlIHN1cmUgcHJpY2UgPiAwCiAgICByZXF1aXJlKF9zdGFydGluZ1ByaWNlID4gMCk7CiAgICAvLyBtYWtlIHN1cmUgdG9rZW4gaGFzbid0IGJlZW4gdXNlZCB5ZXQKICAgIHJlcXVpcmUoY291bnRyeURhdGFbX3Rva2VuSWRdLnByaWNlID09IDApOwogICAgCiAgICAvLyBjcmVhdGUgbmV3IHRva2VuCiAgICBDb3VudHJ5IHN0b3JhZ2UgbmV3Q291bnRyeSA9IGNvdW50cnlEYXRhW190b2tlbklkXTsKCiAgICBuZXdDb3VudHJ5Lm93bmVyID0gX293bmVyOwogICAgbmV3Q291bnRyeS5wcmljZSA9IGdldE5leHRQcmljZShfc3RhcnRpbmdQcmljZSk7CiAgICBuZXdDb3VudHJ5Lmxhc3RQcmljZSA9IF9zdGFydGluZ1ByaWNlOwogICAgbmV3Q291bnRyeS5wYXlvdXQgPSBfcGF5b3V0UGVyY2VudGFnZTsKICAgIG5ld0NvdW50cnkuc3RhcnRpbmdQcmljZSA9IF9zdGFydGluZ1ByaWNlOwoKICAgIC8vIHN0b3JlIGNvdW50cnkgaW4gc3RvcmFnZQogICAgbGlzdGVkQ291bnRyaWVzLnB1c2goX3Rva2VuSWQpOwogICAgCiAgICAvLyBtaW50IG5ldyB0b2tlbgogICAgX21pbnQoX293bmVyLCBfdG9rZW5JZCk7CiAgfQoKICBmdW5jdGlvbiBjcmVhdGVNdWx0aXBsZSAodWludDI1NltdIF9pdGVtSWRzLCB1aW50MjU2W10gX3ByaWNlcywgdWludDI1NltdIF9wYXlvdXRzLCBhZGRyZXNzW10gX293bmVycykgb25seU93bmVyKCkgZXh0ZXJuYWwgewogICAgZm9yICh1aW50MjU2IGkgPSAwOyBpIDwgX2l0ZW1JZHMubGVuZ3RoOyBpKyspIHsKICAgICAgY3JlYXRlTGlzdGluZyhfaXRlbUlkc1tpXSwgX3ByaWNlc1tpXSwgX3BheW91dHNbaV0sIF9vd25lcnNbaV0pOwogICAgfQogIH0KCiAgLyoqCiAgKiBAZGV2IERldGVybWluZXMgbmV4dCBwcmljZSBvZiB0b2tlbgogICogQHBhcmFtIF9wcmljZSB1aW50MjU2IElEIG9mIGN1cnJlbnQgcHJpY2UKICAqLwogIGZ1bmN0aW9uIGdldE5leHRQcmljZSAodWludDI1NiBfcHJpY2UpIHByaXZhdGUgdmlldyByZXR1cm5zICh1aW50MjU2IF9uZXh0UHJpY2UpIHsKICAgIGlmIChfcHJpY2UgPCBmaXJzdENhcCkgewogICAgICByZXR1cm4gX3ByaWNlLm11bCgyMDApLmRpdig5NSk7CiAgICB9IGVsc2UgaWYgKF9wcmljZSA8IHNlY29uZENhcCkgewogICAgICByZXR1cm4gX3ByaWNlLm11bCgxMzUpLmRpdig5Nik7CiAgICB9IGVsc2UgaWYgKF9wcmljZSA8IHRoaXJkQ2FwKSB7CiAgICAgIHJldHVybiBfcHJpY2UubXVsKDEyNSkuZGl2KDk3KTsKICAgIH0gZWxzZSBpZiAoX3ByaWNlIDwgZmluYWxDYXApIHsKICAgICAgcmV0dXJuIF9wcmljZS5tdWwoMTE3KS5kaXYoOTcpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIF9wcmljZS5tdWwoMTE1KS5kaXYoOTgpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gY2FsY3VsYXRlUG9vbEN1dCAodWludDI1NiBfcHJpY2UpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgX3Bvb2xDdXQpIHsKICAgIGlmIChfcHJpY2UgPCBmaXJzdENhcCkgewogICAgICByZXR1cm4gX3ByaWNlLm11bCgxMCkuZGl2KDEwMCk7IC8vIDUlCiAgICB9IGVsc2UgaWYgKF9wcmljZSA8IHNlY29uZENhcCkgewogICAgICByZXR1cm4gX3ByaWNlLm11bCg5KS5kaXYoMTAwKTsgLy8gNCUKICAgIH0gZWxzZSBpZiAoX3ByaWNlIDwgdGhpcmRDYXApIHsKICAgICAgcmV0dXJuIF9wcmljZS5tdWwoOCkuZGl2KDEwMCk7IC8vIDMlCiAgICB9IGVsc2UgaWYgKF9wcmljZSA8IGZpbmFsQ2FwKSB7CiAgICAgIHJldHVybiBfcHJpY2UubXVsKDcpLmRpdigxMDApOyAvLyAzJQogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIF9wcmljZS5tdWwoNSkuZGl2KDEwMCk7IC8vIDIlCiAgICB9CiAgfQoKICAvKioKICAqIEBkZXYgUHVyY2hhc2UgY291bnRyeSBmcm9tIHByZXZpb3VzIG93bmVyCiAgKiBAcGFyYW0gX3Rva2VuSWQgdWludDI1NiBvZiB0b2tlbgogICovCiAgZnVuY3Rpb24gcHVyY2hhc2VDb3VudHJ5KHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyAKICAgIHBheWFibGUKICAgIGlzTm90Q29udHJhY3QobXNnLnNlbmRlcikKICB7CgogICAgLy8gZ2V0IGRhdGEgZnJvbSBzdG9yYWdlCiAgICBDb3VudHJ5IHN0b3JhZ2UgY291bnRyeSA9IGNvdW50cnlEYXRhW190b2tlbklkXTsKICAgIHVpbnQyNTYgcHJpY2UgPSBjb3VudHJ5LnByaWNlOwogICAgYWRkcmVzcyBvbGRPd25lciA9IGNvdW50cnkub3duZXI7CiAgICBhZGRyZXNzIG5ld093bmVyID0gbXNnLnNlbmRlcjsKICAgIHVpbnQyNTYgZXhjZXNzID0gbXNnLnZhbHVlLnN1YihwcmljZSk7CgogICAgLy8gcmV2ZXJ0IGNoZWNrcwogICAgcmVxdWlyZShwcmljZSA+IDApOwogICAgcmVxdWlyZShtc2cudmFsdWUgPj0gcHJpY2UpOwogICAgcmVxdWlyZShvbGRPd25lciAhPSBtc2cuc2VuZGVyKTsKCiAgICAvLyBDYWxjdWxhdGUgcG9vbCBjdXQgZm9yIHRheGVzLgogICAgdWludDI1NiBwcm9maXQgPSBwcmljZS5zdWIoY291bnRyeS5sYXN0UHJpY2UpOwogICAgdWludDI1NiBwb29sQ3V0ID0gY2FsY3VsYXRlUG9vbEN1dChwcm9maXQpOwogICAgcG9vbFRvdGFsICs9IHBvb2xDdXQ7CiAgICAKICAgIC8vIDMlIGdvZXMgdG8gZGV2ZWxvcGVycwogICAgdWludDI1NiBkZXZDdXQgPSBwcmljZS5tdWwoMykuZGl2KDEwMCk7CiAgICBkZXZPd2VkID0gZGV2T3dlZC5hZGQoZGV2Q3V0KTsKCiAgICB0cmFuc2ZlckNvdW50cnkob2xkT3duZXIsIG5ld093bmVyLCBfdG9rZW5JZCk7CgogICAgLy8gc2V0IG5ldyBwcmljZXMKICAgIGNvdW50cnkubGFzdFByaWNlID0gcHJpY2U7CiAgICBjb3VudHJ5LnByaWNlID0gZ2V0TmV4dFByaWNlKHByaWNlKTsKCiAgICAvLyByYWlzZSBldmVudAogICAgQ291bnRyeVB1cmNoYXNlZChfdG9rZW5JZCwgbmV3T3duZXIsIHByaWNlKTsKCiAgICAvLyBUcmFuc2ZlciBwYXltZW50IHRvIG9sZCBvd25lciBtaW51cyB0aGUgZGV2ZWxvcGVyJ3MgYW5kIHBvb2wncyBjdXQuCiAgICBvbGRPd25lci50cmFuc2ZlcihwcmljZS5zdWIoZGV2Q3V0LmFkZChwb29sQ3V0KSkpOwoKICAgIC8vIFNlbmQgcmVmdW5kIHRvIG93bmVyIGlmIG5lZWRlZAogICAgaWYgKGV4Y2VzcyA+IDApIHsKICAgICAgbmV3T3duZXIudHJhbnNmZXIoZXhjZXNzKTsKICAgIH0KICAgIAogICAgLy8gc2V0IGxhc3QgcHVyY2hhc2UgcHJpY2UgdG8gc3RvcmFnZQogICAgbGFzdFB1cmNoYXNlID0gbm93OwoKICB9CgogIC8qKgogICogQGRldiBUcmFuc2ZlciBDb3VudHJ5IGZyb20gUHJldmlvdXMgT3duZXIgdG8gTmV3IE93bmVyCiAgKiBAcGFyYW0gX2Zyb20gcHJldmlvdXMgb3duZXIgYWRkcmVzcwogICogQHBhcmFtIF90byBuZXcgb3duZXIgYWRkcmVzcwogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdG9rZW4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyQ291bnRyeShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgaW50ZXJuYWwgewoKICAgIC8vIGNoZWNrIHRva2VuIGV4aXN0cwogICAgcmVxdWlyZSh0b2tlbkV4aXN0cyhfdG9rZW5JZCkpOwoKICAgIC8vIG1ha2Ugc3VyZSBwcmV2aW91cyBvd25lciBpcyBjb3JyZWN0CiAgICByZXF1aXJlKGNvdW50cnlEYXRhW190b2tlbklkXS5vd25lciA9PSBfZnJvbSk7CgogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKHRoaXMpKTsKCiAgICAvLyBwYXkgYW55IHVucGFpZCBwYXlvdXRzIHRvIHByZXZpb3VzIG93bmVyIG9mIGNvdW50cnkKICAgIHVwZGF0ZVNpbmdsZVBheW91dChfZnJvbSwgX3Rva2VuSWQpOwoKICAgIC8vIGNsZWFyIGFwcHJvdmFscyBsaW5rZWQgdG8gdGhpcyB0b2tlbgogICAgY2xlYXJBcHByb3ZhbChfZnJvbSwgX3Rva2VuSWQpOwoKICAgIC8vIHJlbW92ZSB0b2tlbiBmcm9tIHByZXZpb3VzIG93bmVyCiAgICByZW1vdmVUb2tlbihfZnJvbSwgX3Rva2VuSWQpOwoKICAgIC8vIHVwZGF0ZSBvd25lciBhbmQgYWRkIHRva2VuIHRvIG5ldyBvd25lcgogICAgY291bnRyeURhdGFbX3Rva2VuSWRdLm93bmVyID0gX3RvOwogICAgYWRkVG9rZW4oX3RvLCBfdG9rZW5JZCk7CgogICAvL3JhaXNlIGV2ZW50CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgfQoKICAvKioKICAqIEBkZXYgV2l0aGRyYXcgZGV2J3MgY3V0CiAgKi8KICBmdW5jdGlvbiB3aXRoZHJhdygpIG9ubHlPd25lciBwdWJsaWMgewogICAgb3duZXIudHJhbnNmZXIoZGV2T3dlZCk7CiAgICBkZXZPd2VkID0gMDsKICB9CgogIC8qKgogICogQGRldiBVcGRhdGVzIHRoZSBwYXlvdXQgZm9yIHRoZSBjb3VudHJ5cyB0aGUgb3duZXIgaGFzCiAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3Mgb2YgdG9rZW4gb3duZXIKICAqLwogIGZ1bmN0aW9uIHVwZGF0ZVBheW91dChhZGRyZXNzIF9vd25lcikgcHVibGljIHsKICAgIHVpbnQyNTZbXSBtZW1vcnkgY291bnRyeXMgPSBvd25lZFRva2Vuc1tfb3duZXJdOwogICAgdWludDI1NiBvd2VkOwogICAgZm9yICh1aW50MjU2IGkgPSAwOyBpIDwgY291bnRyeXMubGVuZ3RoOyBpKyspIHsKICAgICAgICB1aW50MjU2IHRvdGFsQ291bnRyeU93ZWQgPSBwb29sVG90YWwgKiBjb3VudHJ5RGF0YVtjb3VudHJ5c1tpXV0ucGF5b3V0IC8gMTAwMDA7CiAgICAgICAgdWludDI1NiBjb3VudHJ5T3dlZCA9IHRvdGFsQ291bnRyeU93ZWQuc3ViKGNvdW50cnlEYXRhW2NvdW50cnlzW2ldXS53aXRoZHJhd24pOwogICAgICAgIG93ZWQgKz0gY291bnRyeU93ZWQ7CiAgICAgICAgCiAgICAgICAgY291bnRyeURhdGFbY291bnRyeXNbaV1dLndpdGhkcmF3biArPSBjb3VudHJ5T3dlZDsKICAgIH0KICAgIHBheW91dEJhbGFuY2VzW19vd25lcl0gKz0gb3dlZDsKICB9CgogIC8qKgogICAqIEBkZXYgVXBkYXRlIGEgc2luZ2xlIGNvdW50cnkgcGF5b3V0IGZvciB0cmFuc2ZlcnMuCiAgICogQHBhcmFtIF9vd25lciBBZGRyZXNzIG9mIHRoZSBvd25lciBvZiB0aGUgY291bnRyeS4KICAgKiBAcGFyYW0gX2l0ZW1JZCBVbmlxdWUgSWQgb2YgdGhlIHRva2VuLgogICoqLwogIGZ1bmN0aW9uIHVwZGF0ZVNpbmdsZVBheW91dChhZGRyZXNzIF9vd25lciwgdWludDI1NiBfaXRlbUlkKSBpbnRlcm5hbCB7CiAgICB1aW50MjU2IHRvdGFsQ291bnRyeU93ZWQgPSBwb29sVG90YWwgKiBjb3VudHJ5RGF0YVtfaXRlbUlkXS5wYXlvdXQgLyAxMDAwMDsKICAgIHVpbnQyNTYgY291bnRyeU93ZWQgPSB0b3RhbENvdW50cnlPd2VkLnN1Yihjb3VudHJ5RGF0YVtfaXRlbUlkXS53aXRoZHJhd24pOwogICAgICAgIAogICAgY291bnRyeURhdGFbX2l0ZW1JZF0ud2l0aGRyYXduICs9IGNvdW50cnlPd2VkOwogICAgcGF5b3V0QmFsYW5jZXNbX293bmVyXSArPSBjb3VudHJ5T3dlZDsKICB9CgogIC8qKgogICogQGRldiBPd25lciBjYW4gd2l0aGRyYXcgdGhlaXIgYWNjdW11bGF0ZWQgcGF5b3V0cwogICogQHBhcmFtIF9vd25lciBhZGRyZXNzIG9mIHRva2VuIG93bmVyCiAgKi8KICBmdW5jdGlvbiB3aXRoZHJhd1JlbnQoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB7CiAgICAgIHVwZGF0ZVBheW91dChfb3duZXIpOwogICAgICB1aW50MjU2IHBheW91dCA9IHBheW91dEJhbGFuY2VzW19vd25lcl07CiAgICAgIHBheW91dEJhbGFuY2VzW19vd25lcl0gPSAwOwogICAgICBfb3duZXIudHJhbnNmZXIocGF5b3V0KTsKICB9CgogIGZ1bmN0aW9uIGdldFJlbnRPd2VkKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IG93ZWQpIHsKICAgIHVwZGF0ZVBheW91dChfb3duZXIpOwogICAgcmV0dXJuIHBheW91dEJhbGFuY2VzW19vd25lcl07CiAgfQoKICAvKioKICAqIEBkZXYgUmV0dXJuIGFsbCBjb3VudHJ5IGRhdGEKICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IG9mIHRva2VuCiAgKi8KICBmdW5jdGlvbiBnZXRDb3VudHJ5RGF0YSAodWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWwgdmlldyAKICByZXR1cm5zIChhZGRyZXNzIF9vd25lciwgdWludDI1NiBfc3RhcnRpbmdQcmljZSwgdWludDI1NiBfcHJpY2UsIHVpbnQyNTYgX25leHRQcmljZSwgdWludDI1NiBfcGF5b3V0KSAKICB7CiAgICBDb3VudHJ5IG1lbW9yeSBjb3VudHJ5ID0gY291bnRyeURhdGFbX3Rva2VuSWRdOwogICAgcmV0dXJuIChjb3VudHJ5Lm93bmVyLCBjb3VudHJ5LnN0YXJ0aW5nUHJpY2UsIGNvdW50cnkucHJpY2UsIGdldE5leHRQcmljZShjb3VudHJ5LnByaWNlKSwgY291bnRyeS5wYXlvdXQpOwogIH0KCiAgLyoqCiAgKiBAZGV2IERldGVybWluZXMgaWYgdG9rZW4gZXhpc3RzIGJ5IGNoZWNraW5nIGl0J3MgcHJpY2UKICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIHRva2VuCiAgKi8KICBmdW5jdGlvbiB0b2tlbkV4aXN0cyAodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCBfZXhpc3RzKSB7CiAgICByZXR1cm4gY291bnRyeURhdGFbX3Rva2VuSWRdLnByaWNlID4gMDsKICB9CgogIC8qKgogICogQGRldiBHdWFyYW50ZWVzIG1zZy5zZW5kZXIgaXMgb3duZXIgb2YgdGhlIGdpdmVuIHRva2VuCiAgKiBAcGFyYW0gX3Rva2VuSWQgdWludDI1NiBJRCBvZiB0aGUgdG9rZW4gdG8gdmFsaWRhdGUgaXRzIG93bmVyc2hpcCBiZWxvbmdzIHRvIG1zZy5zZW5kZXIKICAqLwogIG1vZGlmaWVyIG9ubHlPd25lck9mKHVpbnQyNTYgX3Rva2VuSWQpIHsKICAgIHJlcXVpcmUob3duZXJPZihfdG9rZW5JZCkgPT0gbXNnLnNlbmRlcik7CiAgICBfOwogIH0KCiAgLyoqCiAgKiBAZGV2IEd1YXJhbnRlZXMgbXNnLnNlbmRlciBpcyBub3QgYSBjb250cmFjdAogICogQHBhcmFtIF9idXllciBhZGRyZXNzIG9mIHBlcnNvbiBidXlpbmcgY291bnRyeQogICovCiAgbW9kaWZpZXIgaXNOb3RDb250cmFjdChhZGRyZXNzIF9idXllcikgewogICAgdWludCBzaXplOwogICAgYXNzZW1ibHkgeyBzaXplIDo9IGV4dGNvZGVzaXplKF9idXllcikgfQogICAgcmVxdWlyZShzaXplID09IDApOwogICAgXzsKICB9CgoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgdG90YWwgYW1vdW50IG9mIHRva2VucyBzdG9yZWQgYnkgdGhlIGNvbnRyYWN0CiAgKiBAcmV0dXJuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSB0b3RhbCBhbW91bnQgb2YgdG9rZW5zCiAgKi8KICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiB0b3RhbFRva2VuczsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF9vd25lciBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSBiYWxhbmNlIG9mCiAgKiBAcmV0dXJuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzCiAgKi8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBvd25lZFRva2Vuc1tfb3duZXJdLmxlbmd0aDsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBsaXN0IG9mIHRva2VucyBvd25lZCBieSBhIGdpdmVuIGFkZHJlc3MKICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyB0byBxdWVyeSB0aGUgdG9rZW5zIG9mCiAgKiBAcmV0dXJuIHVpbnQyNTZbXSByZXByZXNlbnRpbmcgdGhlIGxpc3Qgb2YgdG9rZW5zIG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcwogICovCiAgZnVuY3Rpb24gdG9rZW5zT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTZbXSkgewogICAgcmV0dXJuIG93bmVkVG9rZW5zW19vd25lcl07CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgb3duZXIgb2YgdGhlIHNwZWNpZmllZCB0b2tlbiBJRAogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIHF1ZXJ5IHRoZSBvd25lciBvZgogICogQHJldHVybiBvd25lciBhZGRyZXNzIGN1cnJlbnRseSBtYXJrZWQgYXMgdGhlIG93bmVyIG9mIHRoZSBnaXZlbiB0b2tlbiBJRAogICovCiAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICBhZGRyZXNzIG93bmVyID0gdG9rZW5Pd25lcltfdG9rZW5JZF07CiAgICByZXF1aXJlKG93bmVyICE9IGFkZHJlc3MoMCkpOwogICAgcmV0dXJuIG93bmVyOwogIH0KCiAgLyoqCiAgICogQGRldiBHZXRzIHRoZSBhcHByb3ZlZCBhZGRyZXNzIHRvIHRha2Ugb3duZXJzaGlwIG9mIGEgZ2l2ZW4gdG9rZW4gSUQKICAgKiBAcGFyYW0gX3Rva2VuSWQgdWludDI1NiBJRCBvZiB0aGUgdG9rZW4gdG8gcXVlcnkgdGhlIGFwcHJvdmFsIG9mCiAgICogQHJldHVybiBhZGRyZXNzIGN1cnJlbnRseSBhcHByb3ZlZCB0byB0YWtlIG93bmVyc2hpcCBvZiB0aGUgZ2l2ZW4gdG9rZW4gSUQKICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlZEZvcih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICByZXR1cm4gdG9rZW5BcHByb3ZhbHNbX3Rva2VuSWRdOwogIH0KCiAgLyoqCiAgKiBAZGV2IFRyYW5zZmVycyB0aGUgb3duZXJzaGlwIG9mIGEgZ2l2ZW4gdG9rZW4gSUQgdG8gYW5vdGhlciBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgdG8gcmVjZWl2ZSB0aGUgb3duZXJzaGlwIG9mIHRoZSBnaXZlbiB0b2tlbiBJRAogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIG9ubHlPd25lck9mKF90b2tlbklkKSB7CiAgICBjbGVhckFwcHJvdmFsQW5kVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdG9rZW5JZCk7CiAgfQoKICAvKioKICAqIEBkZXYgQXBwcm92ZXMgYW5vdGhlciBhZGRyZXNzIHRvIGNsYWltIGZvciB0aGUgb3duZXJzaGlwIG9mIHRoZSBnaXZlbiB0b2tlbiBJRAogICogQHBhcmFtIF90byBhZGRyZXNzIHRvIGJlIGFwcHJvdmVkIGZvciB0aGUgZ2l2ZW4gdG9rZW4gSUQKICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIHRoZSB0b2tlbiB0byBiZSBhcHByb3ZlZAogICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIG9ubHlPd25lck9mKF90b2tlbklkKSB7CiAgICBhZGRyZXNzIG93bmVyID0gb3duZXJPZihfdG9rZW5JZCk7CiAgICByZXF1aXJlKF90byAhPSBvd25lcik7CiAgICBpZiAoYXBwcm92ZWRGb3IoX3Rva2VuSWQpICE9IDAgfHwgX3RvICE9IDApIHsKICAgICAgdG9rZW5BcHByb3ZhbHNbX3Rva2VuSWRdID0gX3RvOwogICAgICBBcHByb3ZhbChvd25lciwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CiAgfQoKICAvKioKICAqIEBkZXYgQ2xhaW1zIHRoZSBvd25lcnNoaXAgb2YgYSBnaXZlbiB0b2tlbiBJRAogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIGJlaW5nIGNsYWltZWQgYnkgdGhlIG1zZy5zZW5kZXIKICAqLwogIGZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHsKICAgIHJlcXVpcmUoaXNBcHByb3ZlZEZvcihtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwogICAgY2xlYXJBcHByb3ZhbEFuZFRyYW5zZmVyKG93bmVyT2YoX3Rva2VuSWQpLCBtc2cuc2VuZGVyLCBfdG9rZW5JZCk7CiAgfQoKICAvKioKICAgKiBAZGV2IFRlbGxzIHdoZXRoZXIgdGhlIG1zZy5zZW5kZXIgaXMgYXBwcm92ZWQgZm9yIHRoZSBnaXZlbiB0b2tlbiBJRCBvciBub3QKICAgKiBUaGlzIGZ1bmN0aW9uIGlzIG5vdCBwcml2YXRlIHNvIGl0IGNhbiBiZSBleHRlbmRlZCBpbiBmdXJ0aGVyIGltcGxlbWVudGF0aW9ucyBsaWtlIHRoZSBvcGVyYXRhYmxlIEVSQzcyMQogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBvZiB0aGUgb3duZXIgdG8gcXVlcnkgdGhlIGFwcHJvdmFsIG9mCiAgICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIHF1ZXJ5IHRoZSBhcHByb3ZhbCBvZgogICAqIEByZXR1cm4gYm9vbCB3aGV0aGVyIHRoZSBtc2cuc2VuZGVyIGlzIGFwcHJvdmVkIGZvciB0aGUgZ2l2ZW4gdG9rZW4gSUQgb3Igbm90CiAgICovCiAgZnVuY3Rpb24gaXNBcHByb3ZlZEZvcihhZGRyZXNzIF9vd25lciwgdWludDI1NiBfdG9rZW5JZCkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gYXBwcm92ZWRGb3IoX3Rva2VuSWQpID09IF9vd25lcjsKICB9CiAgCiAgLyoqCiAgKiBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIGNsZWFyIGN1cnJlbnQgYXBwcm92YWwgYW5kIHRyYW5zZmVyIHRoZSBvd25lcnNoaXAgb2YgYSBnaXZlbiB0b2tlbiBJRAogICogQHBhcmFtIF9mcm9tIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICogQHBhcmFtIF90byBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRoZSB0b2tlbiB0bwogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkCiAgKi8KICBmdW5jdGlvbiBjbGVhckFwcHJvdmFsQW5kVHJhbnNmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIGludGVybmFsIGlzTm90Q29udHJhY3QoX3RvKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3RvICE9IG93bmVyT2YoX3Rva2VuSWQpKTsKICAgIHJlcXVpcmUob3duZXJPZihfdG9rZW5JZCkgPT0gX2Zyb20pOwoKICAgIGNsZWFyQXBwcm92YWwoX2Zyb20sIF90b2tlbklkKTsKICAgIHVwZGF0ZVNpbmdsZVBheW91dChfZnJvbSwgX3Rva2VuSWQpOwogICAgcmVtb3ZlVG9rZW4oX2Zyb20sIF90b2tlbklkKTsKICAgIGFkZFRva2VuKF90bywgX3Rva2VuSWQpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogIH0KCiAgLyoqCiAgKiBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIGNsZWFyIGN1cnJlbnQgYXBwcm92YWwgb2YgYSBnaXZlbiB0b2tlbiBJRAogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkCiAgKi8KICBmdW5jdGlvbiBjbGVhckFwcHJvdmFsKGFkZHJlc3MgX293bmVyLCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHsKICAgIHJlcXVpcmUob3duZXJPZihfdG9rZW5JZCkgPT0gX293bmVyKTsKICAgIHRva2VuQXBwcm92YWxzW190b2tlbklkXSA9IDA7CiAgICBBcHByb3ZhbChfb3duZXIsIDAsIF90b2tlbklkKTsKICB9CgoKICAgIC8qKgogICogQGRldiBNaW50IHRva2VuIGZ1bmN0aW9uCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCBvd24gdGhlIG1pbnRlZCB0b2tlbgogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIGJlIG1pbnRlZCBieSB0aGUgbXNnLnNlbmRlcgogICovCiAgZnVuY3Rpb24gX21pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIGludGVybmFsIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgYWRkVG9rZW4oX3RvLCBfdG9rZW5JZCk7CiAgICBUcmFuc2ZlcigweDAsIF90bywgX3Rva2VuSWQpOwogIH0KCiAgLyoqCiAgKiBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIGFkZCBhIHRva2VuIElEIHRvIHRoZSBsaXN0IG9mIGEgZ2l2ZW4gYWRkcmVzcwogICogQHBhcmFtIF90byBhZGRyZXNzIHJlcHJlc2VudGluZyB0aGUgbmV3IG93bmVyIG9mIHRoZSBnaXZlbiB0b2tlbiBJRAogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIGJlIGFkZGVkIHRvIHRoZSB0b2tlbnMgbGlzdCBvZiB0aGUgZ2l2ZW4gYWRkcmVzcwogICovCiAgZnVuY3Rpb24gYWRkVG9rZW4oYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgewogICAgcmVxdWlyZSh0b2tlbk93bmVyW190b2tlbklkXSA9PSBhZGRyZXNzKDApKTsKICAgIHRva2VuT3duZXJbX3Rva2VuSWRdID0gX3RvOwogICAgY291bnRyeURhdGFbX3Rva2VuSWRdLm93bmVyID0gX3RvOwogICAgdWludDI1NiBsZW5ndGggPSBiYWxhbmNlT2YoX3RvKTsKICAgIG93bmVkVG9rZW5zW190b10ucHVzaChfdG9rZW5JZCk7CiAgICBvd25lZFRva2Vuc0luZGV4W190b2tlbklkXSA9IGxlbmd0aDsKICAgIHRvdGFsVG9rZW5zID0gdG90YWxUb2tlbnMuYWRkKDEpOwogIH0KCiAgLyoqCiAgKiBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIHJlbW92ZSBhIHRva2VuIElEIGZyb20gdGhlIGxpc3Qgb2YgYSBnaXZlbiBhZGRyZXNzCiAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyByZXByZXNlbnRpbmcgdGhlIHByZXZpb3VzIG93bmVyIG9mIHRoZSBnaXZlbiB0b2tlbiBJRAogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIGJlIHJlbW92ZWQgZnJvbSB0aGUgdG9rZW5zIGxpc3Qgb2YgdGhlIGdpdmVuIGFkZHJlc3MKICAqLwogIGZ1bmN0aW9uIHJlbW92ZVRva2VuKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgewogICAgcmVxdWlyZShvd25lck9mKF90b2tlbklkKSA9PSBfZnJvbSk7CgogICAgdWludDI1NiB0b2tlbkluZGV4ID0gb3duZWRUb2tlbnNJbmRleFtfdG9rZW5JZF07CiAgICB1aW50MjU2IGxhc3RUb2tlbkluZGV4ID0gYmFsYW5jZU9mKF9mcm9tKS5zdWIoMSk7CiAgICB1aW50MjU2IGxhc3RUb2tlbiA9IG93bmVkVG9rZW5zW19mcm9tXVtsYXN0VG9rZW5JbmRleF07CgogICAgdG9rZW5Pd25lcltfdG9rZW5JZF0gPSAwOwogICAgb3duZWRUb2tlbnNbX2Zyb21dW3Rva2VuSW5kZXhdID0gbGFzdFRva2VuOwogICAgb3duZWRUb2tlbnNbX2Zyb21dW2xhc3RUb2tlbkluZGV4XSA9IDA7CiAgICAvLyBOb3RlIHRoYXQgdGhpcyB3aWxsIGhhbmRsZSBzaW5nbGUtZWxlbWVudCBhcnJheXMuIEluIHRoYXQgY2FzZSwgYm90aCB0b2tlbkluZGV4IGFuZCBsYXN0VG9rZW5JbmRleCBhcmUgZ29pbmcgdG8KICAgIC8vIGJlIHplcm8uIFRoZW4gd2UgY2FuIG1ha2Ugc3VyZSB0aGF0IHdlIHdpbGwgcmVtb3ZlIF90b2tlbklkIGZyb20gdGhlIG93bmVkVG9rZW5zIGxpc3Qgc2luY2Ugd2UgYXJlIGZpcnN0IHN3YXBwaW5nCiAgICAvLyB0aGUgbGFzdFRva2VuIHRvIHRoZSBmaXJzdCBwb3NpdGlvbiwgYW5kIHRoZW4gZHJvcHBpbmcgdGhlIGVsZW1lbnQgcGxhY2VkIGluIHRoZSBsYXN0IHBvc2l0aW9uIG9mIHRoZSBsaXN0CgogICAgb3duZWRUb2tlbnNbX2Zyb21dLmxlbmd0aC0tOwogICAgb3duZWRUb2tlbnNJbmRleFtfdG9rZW5JZF0gPSAwOwogICAgb3duZWRUb2tlbnNJbmRleFtsYXN0VG9rZW5dID0gdG9rZW5JbmRleDsKICAgIHRvdGFsVG9rZW5zID0gdG90YWxUb2tlbnMuc3ViKDEpOwogIH0KCiAgZnVuY3Rpb24gbmFtZSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKHN0cmluZyBfbmFtZSkgewogICAgcmV0dXJuICJFdGhlckNvdW50cmllcy5pbyBDb3VudHJ5IjsKICB9CgogIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyBwdXJlIHJldHVybnMgKHN0cmluZyBfc3ltYm9sKSB7CiAgICByZXR1cm4gIkVDIjsKICB9Cgp9'.
	

]
