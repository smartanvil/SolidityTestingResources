Class {
	#name : #SRT7f37472ee88062acc82f14ccfe6e7bf5f469dd05,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT7f37472ee88062acc82f14ccfe6e7bf5f469dd05 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuODsKCgovLwovLyBGT1IgUkVGRVJFTkNFIC0gSU5DTFVERSAgaUU0Um93RXNjcm93ICAoaW50ZXJmYWNlKSBDT05UUkFDVCBhdCB0aGUgdG9wIC4uLi4uCi8vCgpjb250cmFjdCBpRTRSb3dFc2Nyb3cgewogICAgICAgIGZ1bmN0aW9uIGdldE51bUdhbWVzU3RhcnRlZCgpIGNvbnN0YW50IHJldHVybnMgKGludCBuZ2FtZXMpOwp9CgovLyBBYnN0cmFjdCBjb250cmFjdCBmb3IgdGhlIGZ1bGwgRVJDIDIwIFRva2VuIHN0YW5kYXJkCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIEFCU1RSQUNUIHN0YW5kYXJkIHRva2VuIGNsYXNzCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpjb250cmFjdCBUb2tlbiB7IAogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHN1cHBseSk7CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOwoKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7Cn0KCgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyAgRTRSb3dSZXdhcmRzIC0gYWJzdHJhY3QgZTQgZGl2aWRlbmQgY29udHJhY3QKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KY29udHJhY3QgRTRSb3dSZXdhcmRzCnsKICAgICAgICBmdW5jdGlvbiBjaGVja0RpdmlkZW5kcyhhZGRyZXNzIF9hZGRyKSBjb25zdGFudCByZXR1cm5zKHVpbnQgX2Ftb3VudCk7CiAgICAgICAgZnVuY3Rpb24gd2l0aGRyYXdEaXZpZGVuZHMoKSBwdWJsaWMgcmV0dXJucyAodWludCBuYW1vdW50KTsKfQoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8gIEZpbm5leSBDaGlwIC0gdG9rZW4gY29udHJhY3QKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KY29udHJhY3QgRTRUb2tlbiBpcyBUb2tlbiwgRTRSb3dSZXdhcmRzIHsKICAgICAgICBldmVudCBTdGF0RXZlbnQoc3RyaW5nIG1zZyk7CiAgICAgICAgZXZlbnQgU3RhdEV2ZW50SShzdHJpbmcgbXNnLCB1aW50IHZhbCk7CgogICAgICAgIGVudW0gU2V0dGluZ1N0YXRlVmFsdWUgIHtkZWJ1ZywgcmVsZWFzZSwgbG9ja2VkUmVsZWFzZX0KICAgICAgICBlbnVtIEljb1N0YXR1c1ZhbHVlIHthbm91bmNlbWVudCwgc2FsZU9wZW4sIHNhbGVDbG9zZWQsIGZhaWxlZCwgc3VjY2VlZGVkfQoKCgoKICAgICAgICBzdHJ1Y3QgdG9rZW5BY2NvdW50IHsKICAgICAgICAgICAgICAgIGJvb2wgYWxsb2NlZDsgLy8gZmxhZyB0byBhc2NlcnQgcHJpb3IgYWxsb2NhdGlvbgogICAgICAgICAgICAgICAgdWludCB0b2tlbnM7IC8vIG51bSB0b2tlbnMKICAgICAgICAgICAgICAgIHVpbnQgYmFsYW5jZTsgLy8gcmV3YXJkcyBiYWxhbmNlCiAgICAgICAgfQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyAgZGF0YSBzdG9yYWdlCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBhZGRyZXNzIGRldmVsb3BlcnM7IC8vIGRldmVsb3BlcnMgdG9rZW4gaG9sZGluZyBhZGRyZXNzCiAgICAgICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7IC8vIGRlcGxveWVyIGV4ZWN1dG9yCiAgICAgICAgYWRkcmVzcyBmb3VuZGVyT3JnOyAvLyBmb3VuZGVyIG9yZ2luYWl6YXRpb24gY29udHJhY3QKICAgICAgICBhZGRyZXNzIGF1eFBhcnRuZXI7IC8vIGF1eCBwYXJ0bmVyIChwci9hdWRpdGluZykgLSAxIHBlcmNlbnQgdXBvbiBjbG9zZQogICAgICAgIGFkZHJlc3MgZTRfcGFydG5lcjsgLy8gZTRyb3cgIGNvbnRyYWN0IGFkZHJlc3NlcwoKCiAgICAgICAgbWFwcGluZyAoYWRkcmVzcyA9PiB0b2tlbkFjY291bnQpIGhvbGRlckFjY291bnRzIDsgLy8gd2hvIGhvbGRzIGhvdyBtYW55IHRva2VucyAoaGlnaCB0d28gYnl0ZXMgY29udGFpbiBjdXJQYXlJZCkKICAgICAgICBtYXBwaW5nICh1aW50ID0+IGFkZHJlc3MpIGhvbGRlckluZGV4ZXMgOyAvLyBmb3IgaXRlcmF0aW9uIHRocnUgaG9sZGVyCiAgICAgICAgdWludCBudW1BY2NvdW50czsKCiAgICAgICAgdWludCBwYXJ0bmVyQ3JlZGl0czsgLy8gYW1vdW50IHBhcnRuZXIgKGU0cm93KSAgaGFzIHBhaWQKICAgICAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7IC8vIGFwcHJvdmFscwoKCiAgICAgICAgdWludCBtYXhNaW50YWJsZVRva2VuczsgLy8gLi4uCiAgICAgICAgdWludCBtaW5JY29Ub2tlbkdvYWw7Ly8gdG9rZW4gZ29hbCBieSBzYWxlIGVuZAogICAgICAgIHVpbnQgbWluVXNhZ2VHb2FsOyAvLyAgbnVtIGdhbWVzIGdvYWwgYnkgdXNhZ2UgZGVhZGxpbmUKICAgICAgICB1aW50IHB1YmxpYyAgdG9rZW5QcmljZTsgLy8gcHJpY2UgcGVyIHRva2VuCiAgICAgICAgdWludCBwdWJsaWMgcGF5b3V0VGhyZXNob2xkOyAvLyB0aHJlc2hvbGQgdGlsbCBwYXlvdXQKCiAgICAgICAgdWludCB0b3RhbFRva2VuRnVuZHNSZWNlaXZlZDsgICAvLyBydW5uaW5nIHRvdGFsIG9mIHRva2VuIGZ1bmRzIHJlY2VpdmVkCiAgICAgICAgdWludCBwdWJsaWMgdG90YWxUb2tlbnNNaW50ZWQ7ICAvLyB0b3RhbCBudW1iZXIgb2YgdG9rZW5zIG1pbnRlZAogICAgICAgIHVpbnQgcHVibGljIGhvbGRvdmVyQmFsYW5jZTsgICAgICAgICAgICAvLyBob2xkIHRoaXMgYW1vdW50IHVudGlsIHRocmVzaGhvbGQgYmVmb3JlIHJld2FyZCBwYXlvdXQKICAgICAgICBpbnQgcHVibGljIHBheW91dEJhbGFuY2U7ICAgICAgICAgICAgICAgLy8gaG9sZCB0aGlzIGFtb3VudCB1bnRpbCB0aHJlc2hob2xkIGJlZm9yZSByZXdhcmQgcGF5b3V0CiAgICAgICAgaW50IHByT3JpZ1BheW91dEJhbDsgICAgICAgICAgICAgICAgICAgIC8vIG9yaWdpbmFsIHBheW91dCBiYWxhbmNlIGJlZm9yZSBydW4KICAgICAgICB1aW50IHByT3JpZ1Rva2Vuc01pbnQ7ICAgICAgICAgICAgICAgICAgLy8gdG9rZW5zIG1pbnRlZCBhdCBzdGFydCBvZiBwYXkgcnVuCiAgICAgICAgdWludCBwdWJsaWMgY3VyUGF5b3V0SWQ7ICAgICAgICAgICAgICAgIC8vIGN1cnJlbnQgcGF5b3V0IGlkCiAgICAgICAgdWludCBwdWJsaWMgbGFzdFBheW91dEluZGV4OyAgICAgICAgICAgIC8vIHBheW91dCBpZHggYmV0d2VlbiBydW4gc2VnbWVudHMKICAgICAgICB1aW50IHB1YmxpYyBtYXhQYXlzUGVyOyAgICAgICAgICAgICAgICAgLy8gbnVtIHBheXMgcGVyIHNlZ21lbnQKICAgICAgICB1aW50IHB1YmxpYyBtaW5QYXlJbnRlcnZhbDsgICAgICAgICAgICAgLy8gbWluIGludGVydmFsIGJldHdlZW4gc3RhcnQgcGF5IHJ1bgoKCiAgICAgICAgdWludCBmdW5kaW5nU3RhcnQ7ICAgICAgICAgICAgICAvLyBmdW5kaW5nIHN0YXJ0IHRpbWUgaW1tZWRpYXRlbHkgYWZ0ZXIgYW5vdW5jZW1lbnQKICAgICAgICB1aW50IGZ1bmRpbmdEZWFkbGluZTsgICAgICAgICAgIC8vIGZ1bmRpbmcgZW5kIHRpbWUKICAgICAgICB1aW50IHVzYWdlRGVhZGxpbmU7ICAgICAgICAgICAgIC8vIGRlYWRsaW5lIHdoZXJlIG1pbmltdW0gdXNhZ2UgbmVlZHMgdG8gYmUgbWV0IGJlZm9yZSBjb25zaWRlcmVkIHN1Y2Nlc3MKICAgICAgICB1aW50IHB1YmxpYyBsYXN0UGF5b3V0VGltZTsgICAgIC8vIHRpbWVzdGFtcCBvZiBsYXN0IHBheW91dCB0aW1lCiAgICAgICAgdWludCB2ZXN0VGltZTsgICAgICAgICAgLy8gMSB5ZWFyIHBhc3Qgc2FsZSB2ZXN0IGRldmVsb3BlciB0b2tlbnMKICAgICAgICB1aW50IG51bURldlRva2VuczsgICAgICAvLyAxMCBwZXIgY2VudCBvZiB0b2tlbnMgYWZ0ZXIgY2xvc2UgdG8gZGV2ZWxvcGVycwogICAgICAgIGJvb2wgZGV2ZWxvcGVyc0dyYW50ZWQ7ICAgICAgICAgICAgICAgICAvLyBmbGFnCiAgICAgICAgdWludCByZW11bmVyYXRpb25TdGFnZTsgICAgICAgICAvLyAwIGZvciBub3QgeWV0LCAxIGZvciAxMCBwZXJjZW50LCAyIGZvciByZW1haW5pbmcgIHVwb24gc3VjY2VlZGVkLgogICAgICAgIHVpbnQgcHVibGljIHJlbXVuZXJhdGlvbkJhbGFuY2U7ICAgICAgICAvLyByZW11bmVyYXRpb24gYmFsYW5jZSB0byByZWxlYXNlIHRva2VuIGZ1bmRzCiAgICAgICAgdWludCBhdXhQYXJ0bmVyQmFsYW5jZTsgICAgICAgICAvLyBhdXggcGFydG5lciBiYWxhbmNlIC0gMSBwZXJjZW50CiAgICAgICAgdWludCBybUdhczsgLy8gcmVtdW5lcmF0aW9uIGdhcwogICAgICAgIHVpbnQgcndHYXM7IC8vIHJld2FyZCBnYXMKICAgICAgICB1aW50IHJmR2FzOyAvLyByZWZ1bmQgZ2FzCgogICAgICAgIEljb1N0YXR1c1ZhbHVlIGljb1N0YXR1czsgIC8vIGN1cnJlbnQgc3RhdHVzIG9mIGljbwogICAgICAgIFNldHRpbmdTdGF0ZVZhbHVlIHB1YmxpYyBzZXR0aW5nc1N0YXRlOwoKCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAvLyBjb250cmFjdCBjb25zdHJ1Y3RvcgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgZnVuY3Rpb24gRTRUb2tlbigpIAogICAgICAgIHsKICAgICAgICAgICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgICAgICAgICAgICAgIGRldmVsb3BlcnMgPSBtc2cuc2VuZGVyOwogICAgICAgIH0KCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAvLyB1c2UgdGhpcyB0byByZXNldCBldmVyeXRoaW5nLCB3aWxsIG5ldmVyIGJlIGNhbGxlZCBhZnRlciBsb2NrUmVsZWFzZQogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgZnVuY3Rpb24gYXBwbHlTZXR0aW5ncyhTZXR0aW5nU3RhdGVWYWx1ZSBxU3RhdGUsIHVpbnQgX3NhbGVTdGFydCwgdWludCBfc2FsZUVuZCwgdWludCBfdXNhZ2VFbmQsIHVpbnQgX21pblVzYWdlLCB1aW50IF90b2tHb2FsLCB1aW50ICBfbWF4TWludGFibGUsIHVpbnQgX3RocmVzaG9sZCwgdWludCBfcHJpY2UsIHVpbnQgX21wcCwgdWludCBfbXBpICkKICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lcikgCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICAgICAgICAvLyB0aGVzZSBzZXR0aW5ncyBhcmUgcGVybWFuZW50bHkgdHdlYWthYmxlIGZvciBwZXJmb3JtYW5jZSBhZGp1c3RtZW50cwogICAgICAgICAgICAgICAgcGF5b3V0VGhyZXNob2xkID0gX3RocmVzaG9sZDsKICAgICAgICAgICAgICAgIG1heFBheXNQZXIgPSBfbXBwOwogICAgICAgICAgICAgICAgbWluUGF5SW50ZXJ2YWwgPSBfbXBpOwoKICAgICAgICAgICAgICAgIGlmIChzZXR0aW5nc1N0YXRlID09IFNldHRpbmdTdGF0ZVZhbHVlLmxvY2tlZFJlbGVhc2UpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICAgICAgICBzZXR0aW5nc1N0YXRlID0gcVN0YXRlOwogICAgICAgICAgICAgICAgaWNvU3RhdHVzID0gSWNvU3RhdHVzVmFsdWUuYW5vdW5jZW1lbnQ7CgogICAgICAgICAgICAgICAgcm1HYXMgPSAxMDAwMDA7IC8vIHJlbXVuZXJhdGlvbiBnYXMKICAgICAgICAgICAgICAgIHJ3R2FzID0gMTAwMDA7IC8vIHJld2FyZCBnYXMKICAgICAgICAgICAgICAgIHJmR2FzID0gMTAwMDA7IC8vIHJlZnVuZCBnYXMKCgogICAgICAgICAgICAgICAgLy8gemVybyBvdXQgYWxsIHRva2VuIGhvbGRlcnMuICAKICAgICAgICAgICAgICAgIC8vIGxlYXZlIGFsbG9jZWQgb24sIGxlYXZlIG51bSBhY2NvdW50cwogICAgICAgICAgICAgICAgLy8gY2FudCBkZWxldGUgdGhlbSBhbnl3YXlzCgogICAgICAgICAgICAgICAgaWYgKHRvdGFsVG9rZW5zTWludGVkID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBudW1BY2NvdW50czsgaSsrICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3MgYSA9IGhvbGRlckluZGV4ZXNbaV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEgIT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9sZGVyQWNjb3VudHNbYV0udG9rZW5zID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGRlckFjY291bnRzW2FdLmJhbGFuY2UgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gZG8gbm90IHJlc2V0IG51bUFjY291bnRzIQoKICAgICAgICAgICAgICAgIHRvdGFsVG9rZW5zTWludGVkID0gMDsgLy8gdGhpcyB3aWxsIGVyYXNlCiAgICAgICAgICAgICAgICB0b3RhbFRva2VuRnVuZHNSZWNlaXZlZCA9IDA7IC8vIHRoaXMgd2lsbCBlcmFzZS4KICAgICAgICAgICAgICAgIGU0X3BhcnRuZXIgPSBhZGRyZXNzKDApOyAvLyBtdXN0IGJlIHJlc2V0IGFnYWluCgogICAgICAgICAgICAgICAgZnVuZGluZ1N0YXJ0ID0gIF9zYWxlU3RhcnQ7CiAgICAgICAgICAgICAgICBmdW5kaW5nRGVhZGxpbmUgPSBfc2FsZUVuZDsKICAgICAgICAgICAgICAgIHVzYWdlRGVhZGxpbmUgPSBfdXNhZ2VFbmQ7CiAgICAgICAgICAgICAgICBtaW5Vc2FnZUdvYWwgPSBfbWluVXNhZ2U7CiAgICAgICAgICAgICAgICBtaW5JY29Ub2tlbkdvYWwgPSBfdG9rR29hbDsKICAgICAgICAgICAgICAgIG1heE1pbnRhYmxlVG9rZW5zID0gX21heE1pbnRhYmxlOwogICAgICAgICAgICAgICAgdG9rZW5QcmljZSA9IF9wcmljZTsKCiAgICAgICAgICAgICAgICB2ZXN0VGltZSA9IGZ1bmRpbmdTdGFydCArICgzNjUgZGF5cyk7CiAgICAgICAgICAgICAgICBudW1EZXZUb2tlbnMgPSAwOwoKICAgICAgICAgICAgICAgIGhvbGRvdmVyQmFsYW5jZSA9IDA7CiAgICAgICAgICAgICAgICBwYXlvdXRCYWxhbmNlID0gMDsKICAgICAgICAgICAgICAgIGN1clBheW91dElkID0gMTsKICAgICAgICAgICAgICAgIGxhc3RQYXlvdXRJbmRleCA9IDA7CiAgICAgICAgICAgICAgICByZW11bmVyYXRpb25TdGFnZSA9IDA7CiAgICAgICAgICAgICAgICByZW11bmVyYXRpb25CYWxhbmNlID0gMDsKCiAgICAgICAgICAgICAgICBhdXhQYXJ0bmVyQmFsYW5jZSA9IDA7CgogICAgICAgICAgICAgICAgaWYgKHRoaXMuYmFsYW5jZSA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFvd25lci5jYWxsLmdhcyhyZkdhcykudmFsdWUodGhpcy5iYWxhbmNlKSgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN0YXRFdmVudCgiRVJST1IhIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBTdGF0RXZlbnQoIm9rIik7CgogICAgICAgIH0KCgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIC8vIHRva2VucyBoZWxkIHJlc2VydmUgdGhlIHRvcCB0d28gYnl0ZXMgZm9yIHRoZSBwYXlpZCBsYXN0IHBhaWQuCiAgICAgICAgLy8gdGhpcyBpcyBzbyBob2xkZXJzIGF0IHRoZSB0b3Agb2YgdGhlIGxpc3QgZG9udCB0cmFuc2ZlciB0b2tlbnMgCiAgICAgICAgLy8gdG8gdGhlbXNlbHZlcyBvbiB0aGUgYm90dG9tIG9mIHRoZSBsaXN0IHRodXMgc2NhbW1pbmcgdGhlIAogICAgICAgIC8vIHN5c3RlbS4gdGhpcyBmdW5jdGlvbiBkZWNvbnN0cnVjdHMgdGhlIHRva2VuaGVsZCB2YWx1ZS4KICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBmdW5jdGlvbiBnZXRQYXlJZEFuZEhlbGQodWludCBfdG9rSGVsZCkgaW50ZXJuYWwgcmV0dXJucyAodWludCBfcGF5SWQsIHVpbnQgX2hlbGQpCiAgICAgICAgewogICAgICAgICAgICAgICAgX3BheUlkID0gKF90b2tIZWxkIC8gKDIgKiogNDgpKSAmIDB4ZmZmZjsKICAgICAgICAgICAgICAgIF9oZWxkID0gX3Rva0hlbGQgJiAweGZmZmZmZmZmZmZmZjsKICAgICAgICB9CiAgICAgICAgZnVuY3Rpb24gZ2V0SGVsZCh1aW50IF90b2tIZWxkKSBpbnRlcm5hbCAgcmV0dXJucyAodWludCBfaGVsZCkKICAgICAgICB7CiAgICAgICAgICAgICAgICBfaGVsZCA9IF90b2tIZWxkICYgMHhmZmZmZmZmZmZmZmY7CiAgICAgICAgfQogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIC8vIGFsbG9jYXRlIGEgbmV3IGFjY291bnQgYnkgc2V0dGluZyBhbGxvYyB0byB0cnVlCiAgICAgICAgLy8gc2V0IHRoZSB0b3AgdG8gYnl0ZXMgb2YgdG9rZW5zIHRvIGN1ciBwYXkgaWQgdG8gbGVhdmUgb3V0IG9mIGN1cnJlbnQgcm91bmQKICAgICAgICAvLyBhZGQgaG9sZGVyIGluZGV4LCBidW1wIHRoZSBudW0gYWNjb3VudHMKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBmdW5jdGlvbiBhZGRBY2NvdW50KGFkZHJlc3MgX2FkZHIpIGludGVybmFsICB7CiAgICAgICAgICAgICAgICBob2xkZXJBY2NvdW50c1tfYWRkcl0uYWxsb2NlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBob2xkZXJBY2NvdW50c1tfYWRkcl0udG9rZW5zID0gKGN1clBheW91dElkICogKDIgKiogNDgpKTsKICAgICAgICAgICAgICAgIGhvbGRlckluZGV4ZXNbbnVtQWNjb3VudHMrK10gPSBfYWRkcjsKICAgICAgICB9CgoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8gQkVHSU4gRVJDLTIwIGZyb20gU3RhbmRhcmRUb2tlbgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBzdXBwbHkpCiAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKGljb1N0YXR1cyA9PSBJY29TdGF0dXNWYWx1ZS5zYWxlT3BlbgogICAgICAgICAgICAgICAgICAgICAgICB8fCBpY29TdGF0dXMgPT0gSWNvU3RhdHVzVmFsdWUuYW5vdW5jZW1lbnQpCiAgICAgICAgICAgICAgICAgICAgICAgIHN1cHBseSA9IG1heE1pbnRhYmxlVG9rZW5zOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBzdXBwbHkgPSB0b3RhbFRva2Vuc01pbnRlZDsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CgogICAgICAgICAgICAgICAgaWYgKChtc2cuc2VuZGVyID09IGRldmVsb3BlcnMpIAogICAgICAgICAgICAgICAgICAgICAgICAmJiAgKG5vdyA8IHZlc3RUaW1lKSkgewogICAgICAgICAgICAgICAgICAgICAgICAvL3N0YXRFdmVudCgiVG9rZW5zIG5vdCB5ZXQgdmVzdGVkLiIpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CgoKICAgICAgICAgICAgICAgIC8vRGVmYXVsdCBhc3N1bWVzIHRvdGFsU3VwcGx5IGNhbid0IGJlIG92ZXIgbWF4ICgyXjI1NiAtIDEpLgogICAgICAgICAgICAgICAgLy9JZiB5b3VyIHRva2VuIGxlYXZlcyBvdXQgdG90YWxTdXBwbHkgYW5kIGNhbiBpc3N1ZSBtb3JlIHRva2VucyBhcyB0aW1lIGdvZXMgb24sIHlvdSBuZWVkIHRvIGNoZWNrIGlmIGl0IGRvZXNuJ3Qgd3JhcC4KICAgICAgICAgICAgICAgIC8vUmVwbGFjZSB0aGUgaWYgd2l0aCB0aGlzIG9uZSBpbnN0ZWFkLgogICAgICAgICAgICAgICAgLy9pZiAoaG9sZGVyQWNjb3VudHNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIGJhbGFuY2VzW190b10gKyBfdmFsdWUgPiBob2xkZXJBY2NvdW50c1tfdG9dKSB7CgogICAgICAgICAgICAgICAgdmFyIChwaWRGcm9tLCBoZWxkRnJvbSkgPSBnZXRQYXlJZEFuZEhlbGQoaG9sZGVyQWNjb3VudHNbbXNnLnNlbmRlcl0udG9rZW5zKTsKICAgICAgICAgICAgICAgIGlmIChoZWxkRnJvbSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgewoKICAgICAgICAgICAgICAgICAgICBob2xkZXJBY2NvdW50c1ttc2cuc2VuZGVyXS50b2tlbnMgLT0gX3ZhbHVlOwoKICAgICAgICAgICAgICAgICAgICBpZiAoIWhvbGRlckFjY291bnRzW190b10uYWxsb2NlZCkgewogICAgICAgICAgICAgICAgICAgICAgICBhZGRBY2NvdW50KF90byk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICB1aW50IG5ld0hlbGQgPSBfdmFsdWUgKyBnZXRIZWxkKGhvbGRlckFjY291bnRzW190b10udG9rZW5zKTsKICAgICAgICAgICAgICAgICAgICBob2xkZXJBY2NvdW50c1tfdG9dLnRva2VucyA9IG5ld0hlbGQgfCAocGlkRnJvbSAqICgyICoqIDQ4KSk7CiAgICAgICAgICAgICAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgfSBlbHNlIHsgCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsgCiAgICAgICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKCiAgICAgICAgICAgICAgICBpZiAoKF9mcm9tID09IGRldmVsb3BlcnMpIAogICAgICAgICAgICAgICAgICAgICAgICAmJiAgKG5vdyA8IHZlc3RUaW1lKSkgewogICAgICAgICAgICAgICAgICAgICAgICAvL3N0YXRFdmVudCgiVG9rZW5zIG5vdCB5ZXQgdmVzdGVkLiIpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CgoKICAgICAgICAvL3NhbWUgYXMgYWJvdmUuIFJlcGxhY2UgdGhpcyBsaW5lIHdpdGggdGhlIGZvbGxvd2luZyBpZiB5b3Ugd2FudCB0byBwcm90ZWN0IGFnYWluc3Qgd3JhcHBpbmcgdWludHMuCiAgICAgICAgLy9pZiAoYmFsYW5jZXNbX2Zyb21dID49IF92YWx1ZSAmJiBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+IGJhbGFuY2VzW190b10pIHsKCiAgICAgICAgICAgICAgICB2YXIgKHBpZEZyb20sIGhlbGRGcm9tKSA9IGdldFBheUlkQW5kSGVsZChob2xkZXJBY2NvdW50c1tfZnJvbV0udG9rZW5zKTsKICAgICAgICAgICAgICAgIGlmIChoZWxkRnJvbSA+PSBfdmFsdWUgJiYgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIF92YWx1ZSA+IDApIHsKICAgICAgICAgICAgICAgICAgICBob2xkZXJBY2NvdW50c1tfZnJvbV0udG9rZW5zIC09IF92YWx1ZTsKCiAgICAgICAgICAgICAgICAgICAgaWYgKCFob2xkZXJBY2NvdW50c1tfdG9dLmFsbG9jZWQpCiAgICAgICAgICAgICAgICAgICAgICAgIGFkZEFjY291bnQoX3RvKTsKCiAgICAgICAgICAgICAgICAgICAgdWludCBuZXdIZWxkID0gX3ZhbHVlICsgZ2V0SGVsZChob2xkZXJBY2NvdW50c1tfdG9dLnRva2Vucyk7CgogICAgICAgICAgICAgICAgICAgIGhvbGRlckFjY291bnRzW190b10udG9rZW5zID0gbmV3SGVsZCB8IChwaWRGcm9tICogKDIgKiogNDgpKTsKICAgICAgICAgICAgICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICAgICAgICAgICAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7IAogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsgCiAgICAgICAgICAgICAgICB9CiAgICAgICAgfQoKCiAgICAgICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICAgICAgICAgIC8vIHZhcnMgZGVmYXVsdCB0byAwCiAgICAgICAgICAgICAgICBpZiAoaG9sZGVyQWNjb3VudHNbX293bmVyXS5hbGxvY2VkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJhbGFuY2UgPSBnZXRIZWxkKGhvbGRlckFjY291bnRzW19vd25lcl0udG9rZW5zKTsKICAgICAgICAgICAgICAgIH0gCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgICAgICAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgICAgICAgICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgICAgIH0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyBFTkQgRVJDMjAKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgLy8gY2hlY2sgdGhlIGFsbG9jZWQKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgZnVuY3Rpb24gaG9sZGVyRXhpc3RzKGFkZHJlc3MgX2FkZHIpIHJldHVybnMoYm9vbCBfZXhpc3QpCiAgICAgICAgewogICAgICAgICAgICAgICAgX2V4aXN0ID0gaG9sZGVyQWNjb3VudHNbX2FkZHJdLmFsbG9jZWQ7CiAgICAgICAgfQoKCgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAvLyBkZWZhdWx0IHBheWFibGUgZnVuY3Rpb24uCiAgICAgICAgLy8gaWYgc2VuZGVyIGlzIGU0cm93ICBwYXJ0bmVyLCB0aGlzIGlzIGEgcmFrZSBmZWUgcGF5bWVudAogICAgICAgIC8vIG90aGVyd2lzZSB0aGlzIGlzIGEgdG9rZW4gcHVyY2hhc2UuCiAgICAgICAgLy8gdG9rZW5zIG9ubHkgcHVyY2hhc2VhYmxlIGJldHdlZW4gdG9rZW5mdW5kaW5nc3RhcnQgYW5kIGVuZAogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBmdW5jdGlvbiAoKSBwYXlhYmxlIHsKICAgICAgICAgICAgICAgIGlmIChtc2cuc2VuZGVyID09IGU0X3BhcnRuZXIpIHsKICAgICAgICAgICAgICAgICAgICAgZmVlUGF5bWVudCgpOyAvLyBmcm9tIGU0cm93IGdhbWUgZXNjcm93IGNvbnRyYWN0CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICBwdXJjaGFzZVRva2VuKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIC8vIHB1cmNoYXNlIHRva2VuIGZ1bmN0aW9uIC0gdG9rZW5zIG9ubHkgc29sZCBkdXJpbmcgc2FsZSBwZXJpb2QgdXAgdW50aWwgdGhlIG1heCB0b2tlbnMKICAgICAgICAvLyBwdXJjaGFzZSBwcmljZSBpcyB0b2tlblByaWNlLiAgYWxsIHVuaXRzIGluIHdlaS4KICAgICAgICAvLyBwdXJjaGFzZXIgd2lsbCBub3QgYmUgaW5jbHVkZWQgaW4gY3VycmVudCBwYXkgcnVuCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBmdW5jdGlvbiBwdXJjaGFzZVRva2VuKCkgcGF5YWJsZSB7CgogICAgICAgICAgICAgICAgdWludCBudmFsdWUgPSBtc2cudmFsdWU7IC8vIGJlaW5nIGNhcmVmdWwgdG8gcHJlc2VydmUgbXNnLnZhbHVlCiAgICAgICAgICAgICAgICBhZGRyZXNzIG5wdXJjaGFzZXIgPSBtc2cuc2VuZGVyOwogICAgICAgICAgICAgICAgaWYgKG52YWx1ZSA8IHRva2VuUHJpY2UpIAogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdzsKCiAgICAgICAgICAgICAgICB1aW50IHF0eSA9IG52YWx1ZS90b2tlblByaWNlOwogICAgICAgICAgICAgICAgdXBkYXRlSWNvU3RhdHVzKCk7CiAgICAgICAgICAgICAgICBpZiAoaWNvU3RhdHVzICE9IEljb1N0YXR1c1ZhbHVlLnNhbGVPcGVuKSAvLyBwdXJjaGFzZSBpcyBjbG9zZWQKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICAgICAgICBpZiAodG90YWxUb2tlbnNNaW50ZWQgKyBxdHkgPiBtYXhNaW50YWJsZVRva2VucykKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICAgICAgICBpZiAoIWhvbGRlckFjY291bnRzW25wdXJjaGFzZXJdLmFsbG9jZWQpCiAgICAgICAgICAgICAgICAgICAgICAgIGFkZEFjY291bnQobnB1cmNoYXNlcik7CgogICAgICAgICAgICAgICAgLy8gcHVyY2hhc2VyIHdhaXRzIGZvciBuZXh0IHBheXJ1bi4gb3RoZXJ3aXNlIGNhbiBkaXNydXB0IGN1ciBwYXkgcnVuCiAgICAgICAgICAgICAgICB1aW50IG5ld0hlbGQgPSBxdHkgKyBnZXRIZWxkKGhvbGRlckFjY291bnRzW25wdXJjaGFzZXJdLnRva2Vucyk7CiAgICAgICAgICAgICAgICBob2xkZXJBY2NvdW50c1tucHVyY2hhc2VyXS50b2tlbnMgPSBuZXdIZWxkIHwgKGN1clBheW91dElkICogKDIgKiogNDgpKTsKCiAgICAgICAgICAgICAgICB0b3RhbFRva2Vuc01pbnRlZCArPSBxdHk7CiAgICAgICAgICAgICAgICB0b3RhbFRva2VuRnVuZHNSZWNlaXZlZCArPSBudmFsdWU7CgogICAgICAgICAgICAgICAgaWYgKHRvdGFsVG9rZW5zTWludGVkID09IG1heE1pbnRhYmxlVG9rZW5zKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGljb1N0YXR1cyA9IEljb1N0YXR1c1ZhbHVlLnNhbGVDbG9zZWQ7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vdGVzdCB1bm5lY2Vzc2FyeSAtICBpZiAoZ2V0TnVtVG9rZW5zUHVyY2hhc2VkKCkgPj0gbWluSWNvVG9rZW5Hb2FsKQogICAgICAgICAgICAgICAgICAgICAgICBkb0RldmVsb3BlckdyYW50KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIFN0YXRFdmVudEkoIlB1cmNoYXNlZCxHcmFudGVkIiwgcXR5KTsKICAgICAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBTdGF0RXZlbnRJKCJQdXJjaGFzZWQiLCBxdHkpOwoKICAgICAgICB9CgoKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAvLyBhY2NlcHQgcGF5bWVudCBmcm9tIGU0cm93IGNvbnRyYWN0CiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgZnVuY3Rpb24gZmVlUGF5bWVudCgpIHBheWFibGUgIAogICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChtc2cuc2VuZGVyICE9IGU0X3BhcnRuZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgU3RhdEV2ZW50KCJmb3JiaWRkZW4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOyAvLyB0aGFuayB5b3UKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHVpbnQgbmZ2YWx1ZSA9IG1zZy52YWx1ZTsgLy8gcHJlc2VydmUgdmFsdWUgaW4gY2FzZSBjaGFuZ2VkIGluIGRldiBncmFudAoKICAgICAgICAgICAgICAgIHVwZGF0ZUljb1N0YXR1cygpOwoKICAgICAgICAgICAgICAgIGhvbGRvdmVyQmFsYW5jZSArPSBuZnZhbHVlOwogICAgICAgICAgICAgICAgcGFydG5lckNyZWRpdHMgKz0gbmZ2YWx1ZTsKICAgICAgICAgICAgICAgIFN0YXRFdmVudEkoIlBheW1lbnQiLCBuZnZhbHVlKTsKCiAgICAgICAgICAgICAgICBpZiAoaG9sZG92ZXJCYWxhbmNlID4gcGF5b3V0VGhyZXNob2xkCiAgICAgICAgICAgICAgICAgICAgICAgIHx8IHBheW91dEJhbGFuY2UgPiAwKQogICAgICAgICAgICAgICAgICAgICAgICBkb1BheW91dCgpOwoKCiAgICAgICAgfQoKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAvLyBzZXQgdGhlIGU0cm93IHBhcnRuZXIsIHRoaXMgaXMgb25seSBkb25lIG9uY2UKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBmdW5jdGlvbiBzZXRFNFJvd1BhcnRuZXIoYWRkcmVzcyBfYWRkcikgcHVibGljCiAgICAgICAgewogICAgICAgIC8vIE9OTFkgb3duZXIgY2FuIHNldCBhbmQgT05MWSBPTkNFISAodW5sZXNzICJ1bmxvY2tlZCIgZGVidWcpCiAgICAgICAgLy8gb25jZSBpdHMgbG9ja2VkLiBPTkxZIE9OQ0UhCiAgICAgICAgICAgICAgICBpZiAobXNnLnNlbmRlciA9PSBvd25lcikgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGU0X3BhcnRuZXIgPT0gYWRkcmVzcygwKSkgfHwgKHNldHRpbmdzU3RhdGUgPT0gU2V0dGluZ1N0YXRlVmFsdWUuZGVidWcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZTRfcGFydG5lciA9IF9hZGRyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRuZXJDcmVkaXRzID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1N0YXRFdmVudEkoIkU0LVNldCIsIDApOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN0YXRFdmVudCgiQWxyZWFkeSBTZXQiKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIC8vIHJldHVybiB0aGUgdG90YWwgdG9rZW5zIHB1cmNoYXNlZAogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBmdW5jdGlvbiBnZXROdW1Ub2tlbnNQdXJjaGFzZWQoKSBjb25zdGFudCByZXR1cm5zKHVpbnQgX3B1cmNoYXNlZCkKICAgICAgICB7CiAgICAgICAgICAgICAgICBfcHVyY2hhc2VkID0gdG90YWxUb2tlbnNNaW50ZWQtbnVtRGV2VG9rZW5zOwogICAgICAgIH0KCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIC8vIHJldHVybiB0aGUgbnVtIGdhbWVzIGFzIHJlcG9ydGVkIGZyb20gdGhlIGU0cm93ICBjb250cmFjdAogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBmdW5jdGlvbiBnZXROdW1HYW1lcygpIGNvbnN0YW50IHJldHVybnModWludCBfZ2FtZXMpCiAgICAgICAgewogICAgICAgICAgICAgICAgLy9fZ2FtZXMgPSAwOwogICAgICAgICAgICAgICAgaWYgKGU0X3BhcnRuZXIgIT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpRTRSb3dFc2Nyb3cgcGU0ID0gaUU0Um93RXNjcm93KGU0X3BhcnRuZXIpOwogICAgICAgICAgICAgICAgICAgICAgICBfZ2FtZXMgPSB1aW50KHBlNC5nZXROdW1HYW1lc1N0YXJ0ZWQoKSk7CiAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgLy9lbHNlCiAgICAgICAgICAgICAgICAvL1N0YXRFdmVudCgiRW1wdHkgRTQiKTsKICAgICAgICB9CgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIC8vIGdldCB0aGUgZm91bmRlcnMsIGF1eFBhcnRuZXIsIGRldmVsb3BlcgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgZnVuY3Rpb24gZ2V0U3BlY2lhbEFkZHJlc3NlcygpIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MgX2ZuZHIsIGFkZHJlc3MgX2F1eCwgYWRkcmVzcyBfZGV2LCBhZGRyZXNzIF9lNCkKICAgICAgICB7CiAgICAgICAgICAgICAgICAvL2lmIChfc2VuZGVyID09IG93bmVyKSB7IC8vIG5vIG1zZy5zZW5kZXIgb24gY29uc3RhbnQgZnVuY3Rpb25zIGF0IGxlYXN0IGluIG1ldwogICAgICAgICAgICAgICAgICAgICAgICBfZm5kciA9IGZvdW5kZXJPcmc7CiAgICAgICAgICAgICAgICAgICAgICAgIF9hdXggPSBhdXhQYXJ0bmVyOwogICAgICAgICAgICAgICAgICAgICAgICBfZGV2ID0gZGV2ZWxvcGVyczsKICAgICAgICAgICAgICAgICAgICAgICAgX2U0ICA9IGU0X3BhcnRuZXI7CiAgICAgICAgICAgICAgICAvL30KICAgICAgICB9CgoKCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIC8vIHVwZGF0ZSB0aGUgaWNvIHN0YXR1cwogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBmdW5jdGlvbiB1cGRhdGVJY29TdGF0dXMoKSBwdWJsaWMKICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoaWNvU3RhdHVzID09IEljb1N0YXR1c1ZhbHVlLnN1Y2NlZWRlZCAKICAgICAgICAgICAgICAgICAgICAgICAgfHwgaWNvU3RhdHVzID09IEljb1N0YXR1c1ZhbHVlLmZhaWxlZCkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgZWxzZSBpZiAoaWNvU3RhdHVzID09IEljb1N0YXR1c1ZhbHVlLmFub3VuY2VtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub3cgPiBmdW5kaW5nU3RhcnQgJiYgbm93IDw9IGZ1bmRpbmdEZWFkbGluZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb1N0YXR1cyA9IEljb1N0YXR1c1ZhbHVlLnNhbGVPcGVuOwoKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub3cgPiBmdW5kaW5nRGVhZGxpbmUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG91bGQgbm90IGJlIGhlcmUgLSB0aGlzIHdpbGwgZXZlbnR1YWxseSBmYWlsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvU3RhdHVzID0gSWNvU3RhdHVzVmFsdWUuc2FsZUNsb3NlZDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdWludCBudW1QID0gZ2V0TnVtVG9rZW5zUHVyY2hhc2VkKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQgbnVtRyA9IGdldE51bUdhbWVzKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgobm93ID4gZnVuZGluZ0RlYWRsaW5lICYmIG51bVAgPCBtaW5JY29Ub2tlbkdvYWwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgKG5vdyA+IHVzYWdlRGVhZGxpbmUgJiYgbnVtRyA8IG1pblVzYWdlR29hbCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29TdGF0dXMgPSBJY29TdGF0dXNWYWx1ZS5mYWlsZWQ7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKG5vdyA+IGZ1bmRpbmdEZWFkbGluZSkgLy8gZG9udCB3YW50IHRvIHByZXZlbnQgbW9yZSB0b2tlbiBzYWxlcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIChudW1QID49IG1pbkljb1Rva2VuR29hbCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiAobnVtRyA+PSBtaW5Vc2FnZUdvYWwpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvU3RhdHVzID0gSWNvU3RhdHVzVmFsdWUuc3VjY2VlZGVkOyAvLyBob29yYXkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWNvU3RhdHVzID09IEljb1N0YXR1c1ZhbHVlLnNhbGVPcGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgKChudW1QID49IG1heE1pbnRhYmxlVG9rZW5zKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IChub3cgPiBmdW5kaW5nRGVhZGxpbmUpKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvU3RhdHVzID0gSWNvU3RhdHVzVmFsdWUuc2FsZUNsb3NlZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCFkZXZlbG9wZXJzR3JhbnRlZAogICAgICAgICAgICAgICAgICAgICAgICAmJiBpY29TdGF0dXMgIT0gSWNvU3RhdHVzVmFsdWUuc2FsZU9wZW4gCiAgICAgICAgICAgICAgICAgICAgICAgICYmIGljb1N0YXR1cyAhPSBJY29TdGF0dXNWYWx1ZS5hbm91bmNlbWVudAogICAgICAgICAgICAgICAgICAgICAgICAmJiBnZXROdW1Ub2tlbnNQdXJjaGFzZWQoKSA+PSBtaW5JY29Ub2tlbkdvYWwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb0RldmVsb3BlckdyYW50KCk7IC8vIGdyYW50IHdoZW5ldmVyIHN0YXR1cyBnb2VzIGZyb20gb3BlbiB0byBhbnl0aGluZy4uLgogICAgICAgICAgICAgICAgfQoKCiAgICAgICAgfQoKCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIC8vIHJlcXVlc3QgcmVmdW5kLiBDYWxsZXIgbXVzdCBjYWxsIHRvIHJlcXVlc3QgYW5kIHJlY2VpdmUgcmVmdW5kIAogICAgICAgIC8vIFdBUk5JTkcgLSB3aXRoZHJhdyByZXdhcmRzL2RpdmlkZW5kcyBiZWZvcmUgY2FsbGluZy4KICAgICAgICAvLyBZT1UgSEFWRSBCRUVOIFdBUk5FRAogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBmdW5jdGlvbiByZXF1ZXN0UmVmdW5kKCkKICAgICAgICB7CiAgICAgICAgICAgICAgICBhZGRyZXNzIG5yZXF1ZXN0ZXIgPSBtc2cuc2VuZGVyOwogICAgICAgICAgICAgICAgdXBkYXRlSWNvU3RhdHVzKCk7CgogICAgICAgICAgICAgICAgdWludCBudG9rZW5zID0gZ2V0SGVsZChob2xkZXJBY2NvdW50c1tucmVxdWVzdGVyXS50b2tlbnMpOwogICAgICAgICAgICAgICAgaWYgKGljb1N0YXR1cyAhPSBJY29TdGF0dXNWYWx1ZS5mYWlsZWQpCiAgICAgICAgICAgICAgICAgICAgICAgIFN0YXRFdmVudCgiTm8gUmVmdW5kIik7CiAgICAgICAgICAgICAgICBlbHNlIGlmIChudG9rZW5zID09IDApCiAgICAgICAgICAgICAgICAgICAgICAgIFN0YXRFdmVudCgiTm8gVG9rZW5zIik7CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdWludCBucmVmdW5kID0gbnRva2VucyAqIHRva2VuUHJpY2U7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnZXROdW1Ub2tlbnNQdXJjaGFzZWQoKSA+PSBtaW5JY29Ub2tlbkdvYWwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnJlZnVuZCAtPSAobnJlZnVuZCAvMTApOyAvLyBvbmx5IDkwIHBlcmNlbnQgYi9jIDEwIHBlcmNlbnQgcGF5b3V0CgogICAgICAgICAgICAgICAgICAgICAgICBob2xkZXJBY2NvdW50c1tkZXZlbG9wZXJzXS50b2tlbnMgKz0gbnRva2VuczsKICAgICAgICAgICAgICAgICAgICAgICAgaG9sZGVyQWNjb3VudHNbbnJlcXVlc3Rlcl0udG9rZW5zID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhvbGRlckFjY291bnRzW25yZXF1ZXN0ZXJdLmJhbGFuY2UgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VlIGFib3ZlIHdhcm5pbmchIQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaG9sZGVyQWNjb3VudHNbZGV2ZWxvcGVyc10uYWxsb2NlZCkgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRBY2NvdW50KGRldmVsb3BlcnMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGRlckFjY291bnRzW2RldmVsb3BlcnNdLmJhbGFuY2UgKz0gaG9sZGVyQWNjb3VudHNbbnJlcXVlc3Rlcl0uYmFsYW5jZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2xkZXJBY2NvdW50c1tucmVxdWVzdGVyXS5iYWxhbmNlID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFucmVxdWVzdGVyLmNhbGwuZ2FzKHJmR2FzKS52YWx1ZShucmVmdW5kKSgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93OwogICAgICAgICAgICAgICAgICAgICAgICAvL1N0YXRFdmVudEkoIlJlZnVuZGVkIiwgbnJlZnVuZCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgfQoKCgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIC8vIHBheW91dCByZXdhcmRzIHRvIGFsbCB0b2tlbiBob2xkZXJzCiAgICAgICAgLy8gdXNlIGEgc2Vjb25kIGhvbGRpbmcgdmFyaWFibGUgY2FsbGVkIFBheW91dEJhbGFuY2UgdG8gZG8gCiAgICAgICAgLy8gdGhlIGFjdHVhbCBwYXlvdXQgZnJvbSBiL2MgdG9vIG11Y2ggZ2FzIHRvIGl0ZXJhdGUgdGhydSAKICAgICAgICAvLyBlYWNoIHBheWVlLiBPbmx5IHN0YXJ0IGEgbmV3IHJ1biBhdCBtb3N0IG9uY2UgcGVyICJtaW5wYXlpbnRlcnZhbCIuCiAgICAgICAgLy8gSXRzIGRvbmUgaW4gcnVucyBvZiAibWF4UGF5c1BlciIKICAgICAgICAvLyB3ZSB1c2Ugc3BlY2lhbCBjb2RpbmcgZm9yIHRoZSBob2xkZXJBY2NvdW50cyB0byBhdm9pZCBhIGhhY2sKICAgICAgICAvLyBvZiBnZXR0aW5nIHBhaWQgYXQgdGhlIHRvcCBvZiB0aGUgbGlzdCB0aGVuIHRyYW5zZmVyaW5nIHRva2VucwogICAgICAgIC8vIHRvIGFub3RoZXIgYWRkcmVzcyBhdCB0aGUgYm90dG9tIG9mIHRoZSBsaXN0LgogICAgICAgIC8vIGJlY2F1c2Ugb2YgdGhhdCBlYWNoIGhvbGRlckFjY291bnRzIGVudHJ5IGdldHMgdGhlIHBheW91dGlkIHN0YW1wZWQgdXBvbiBpdCAodG9wIHR3byBieXRlcykKICAgICAgICAvLyBhbHNvIGEgdG9rZW4gdHJhbnNmZXIgd2lsbCB0cmFuc2ZlciB0aGUgcGF5b3V0IGlkLgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIGZ1bmN0aW9uIGRvUGF5b3V0KCkgIGludGVybmFsCiAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKHRvdGFsVG9rZW5zTWludGVkID09IDApCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICAgICAgICBpZiAoKGhvbGRvdmVyQmFsYW5jZSA+IDApIAogICAgICAgICAgICAgICAgICAgICAgICAmJiAocGF5b3V0QmFsYW5jZSA9PSAwKQogICAgICAgICAgICAgICAgICAgICAgICAmJiAobm93ID4gKGxhc3RQYXlvdXRUaW1lK21pblBheUludGVydmFsKSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3RhcnQgYSBuZXcgcnVuCiAgICAgICAgICAgICAgICAgICAgICAgIGN1clBheW91dElkKys7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJQYXlvdXRJZCA+PSAzMjc2OCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJQYXlvdXRJZCA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQYXlvdXRUaW1lID0gbm93OwogICAgICAgICAgICAgICAgICAgICAgICBwYXlvdXRCYWxhbmNlID0gaW50KGhvbGRvdmVyQmFsYW5jZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHByT3JpZ1BheW91dEJhbCA9IHBheW91dEJhbGFuY2U7CiAgICAgICAgICAgICAgICAgICAgICAgIHByT3JpZ1Rva2Vuc01pbnQgPSB0b3RhbFRva2Vuc01pbnRlZDsKICAgICAgICAgICAgICAgICAgICAgICAgaG9sZG92ZXJCYWxhbmNlID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFBheW91dEluZGV4ID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgU3RhdEV2ZW50SSgiU3RhcnRSdW4iLCB1aW50KGN1clBheW91dElkKSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBheW91dEJhbGFuY2UgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdvcmsgZG93biB0aGUgcC5vLmIKICAgICAgICAgICAgICAgICAgICAgICAgdWludCBuQW1vdW50OwogICAgICAgICAgICAgICAgICAgICAgICB1aW50IG5QZXJUb2tEaXN0cmliID0gdWludChwck9yaWdQYXlvdXRCYWwpL3ByT3JpZ1Rva2Vuc01pbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQgcGFpZHMgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICB1aW50IGk7IC8vIGludGVudGlvbmFsCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IGxhc3RQYXlvdXRJbmRleDsgKHBhaWRzIDwgbWF4UGF5c1BlcikgJiYgKGkgPCBudW1BY2NvdW50cykgJiYgKHBheW91dEJhbGFuY2UgPiAwKTsgaSsrICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3MgYSA9IGhvbGRlckluZGV4ZXNbaV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEgPT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAocGlkLCBoZWxkKSA9IGdldFBheUlkQW5kSGVsZChob2xkZXJBY2NvdW50c1thXS50b2tlbnMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoaGVsZCA+IDApICYmIChwaWQgIT0gY3VyUGF5b3V0SWQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuQW1vdW50ID0gblBlclRva0Rpc3RyaWIgKiBoZWxkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGludChuQW1vdW50KSA8PSBwYXlvdXRCYWxhbmNlKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9sZGVyQWNjb3VudHNbYV0uYmFsYW5jZSArPSBuQW1vdW50OyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9sZGVyQWNjb3VudHNbYV0udG9rZW5zID0gKGN1clBheW91dElkICogKDIgKiogNDgpKSB8IGhlbGQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBheW91dEJhbGFuY2UgLT0gaW50KG5BbW91bnQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWlkcysrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBsYXN0UGF5b3V0SW5kZXggPSBpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAobGFzdFBheW91dEluZGV4ID49IG51bUFjY291bnRzIHx8IHBheW91dEJhbGFuY2UgPD0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQYXlvdXRJbmRleCA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBheW91dEJhbGFuY2UgPiAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9sZG92ZXJCYWxhbmNlICs9IHVpbnQocGF5b3V0QmFsYW5jZSk7Ly8gcHV0IGJhY2sgYW55IGxlZnRvdmVycwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBheW91dEJhbGFuY2UgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN0YXRFdmVudEkoIlJ1bkNvbXBsZXRlIiwgdWludChwck9yaWdQYXlvdXRCYWwpICk7CgogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN0YXRFdmVudEkoIlBheVJ1biIsIG5QZXJUb2tEaXN0cmliICk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgfQoKCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIC8vIHNlbmRlciB3aXRoZHJhdyBlbnRpcmUgcmV3YXJkcy9kaXZpZGVuZHMKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgZnVuY3Rpb24gd2l0aGRyYXdEaXZpZGVuZHMoKSBwdWJsaWMgcmV0dXJucyAodWludCBfYW1vdW50KQogICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChob2xkZXJBY2NvdW50c1ttc2cuc2VuZGVyXS5iYWxhbmNlID09IDApIHsgCiAgICAgICAgICAgICAgICAgICAgICAgIC8vX2Ftb3VudCA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgIFN0YXRFdmVudCgiMCBCYWxhbmNlIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgobXNnLnNlbmRlciA9PSBkZXZlbG9wZXJzKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiAgKG5vdyA8IHZlc3RUaW1lKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vc3RhdEV2ZW50KCJUb2tlbnMgbm90IHlldCB2ZXN0ZWQuIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9fYW1vdW50ID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIF9hbW91bnQgPSBob2xkZXJBY2NvdW50c1ttc2cuc2VuZGVyXS5iYWxhbmNlOyAKICAgICAgICAgICAgICAgICAgICAgICAgaG9sZGVyQWNjb3VudHNbbXNnLnNlbmRlcl0uYmFsYW5jZSA9IDA7IAogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1zZy5zZW5kZXIuY2FsbC5nYXMocndHYXMpLnZhbHVlKF9hbW91bnQpKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vU3RhdEV2ZW50SSgiUGFpZCIsIF9hbW91bnQpOwoKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgfQoKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgLy8gc2V0IGdhcyBmb3Igb3BlcmF0aW9ucwogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBmdW5jdGlvbiBzZXRPcEdhcyh1aW50IF9ybSwgdWludCBfcmYsIHVpbnQgX3J3KQogICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChtc2cuc2VuZGVyICE9IG93bmVyICYmIG1zZy5zZW5kZXIgIT0gZGV2ZWxvcGVycykgewogICAgICAgICAgICAgICAgICAgICAgICAvL1N0YXRFdmVudCgib25seSBvd25lciBjYWxscyIpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBybUdhcyA9IF9ybTsKICAgICAgICAgICAgICAgICAgICAgICAgcmZHYXMgPSBfcmY7CiAgICAgICAgICAgICAgICAgICAgICAgIHJ3R2FzID0gX3J3OwogICAgICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIC8vIGdldCBnYXMgZm9yIG9wZXJhdGlvbnMKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgZnVuY3Rpb24gZ2V0T3BHYXMoKSBjb25zdGFudCByZXR1cm5zICh1aW50IF9ybSwgdWludCBfcmYsIHVpbnQgX3J3KQogICAgICAgIHsKICAgICAgICAgICAgICAgIF9ybSA9IHJtR2FzOwogICAgICAgICAgICAgICAgX3JmID0gcmZHYXM7CiAgICAgICAgICAgICAgICBfcncgPSByd0dhczsKICAgICAgICB9CiAKCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIC8vIGNoZWNrIHJld2FyZHMuICBwYXNzIGluIGFkZHJlc3Mgb2YgdG9rZW4gaG9sZGVyCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIGZ1bmN0aW9uIGNoZWNrRGl2aWRlbmRzKGFkZHJlc3MgX2FkZHIpIGNvbnN0YW50IHJldHVybnModWludCBfYW1vdW50KQogICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChob2xkZXJBY2NvdW50c1tfYWRkcl0uYWxsb2NlZCkKICAgICAgICAgICAgICAgICAgICAgICAgX2Ftb3VudCA9IGhvbGRlckFjY291bnRzW19hZGRyXS5iYWxhbmNlOwogICAgICAgIH0KCgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIC8vIGljb0NoZWNrdXAgLSBjaGVjayB1cCBjYWxsIGZvciBhZG1pbmlzdHJhdG9ycwogICAgICAgIC8vIGFmdGVyIHNhbGUgaXMgY2xvc2VkIGlmIG1pbiBpY28gdG9rZW5zIHNvbGQsIDEwIHBlcmNlbnQgd2lsbCBiZSBkaXN0cmlidXRlZCB0byAKICAgICAgICAvLyBjb21wYW55IHRvIGNvdmVyIHZhcmlvdXMgb3BlcmF0aW5nIGV4cGVuc2VzCiAgICAgICAgLy8gYWZ0ZXIgc2FsZSBhbmQgdXNhZ2UgZGVhbGluZXMgaGF2ZSBiZWVuIG1ldCwgcmVtYWluaW5nIDkwIHBlcmNlbnQgd2lsbCBiZSBkaXN0cmlidXRlZCB0bwogICAgICAgIC8vIGNvbXBhbnkuCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgZnVuY3Rpb24gaWNvQ2hlY2t1cCgpIHB1YmxpYwogICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChtc2cuc2VuZGVyICE9IG93bmVyICYmIG1zZy5zZW5kZXIgIT0gZGV2ZWxvcGVycykKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3c7CgogICAgICAgICAgICAgICAgdWludCBubXNnbWFzazsKICAgICAgICAgICAgICAgIC8vbm1zZ21hc2sgPSAwOwoKICAgICAgICAgICAgICAgIGlmIChpY29TdGF0dXMgPT0gSWNvU3RhdHVzVmFsdWUuc2FsZUNsb3NlZCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGdldE51bVRva2Vuc1B1cmNoYXNlZCgpID49IG1pbkljb1Rva2VuR29hbCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiAocmVtdW5lcmF0aW9uU3RhZ2UgPT0gMCApKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtdW5lcmF0aW9uU3RhZ2UgPSAxOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbXVuZXJhdGlvbkJhbGFuY2UgPSAodG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQvMTAwKSo5OyAvLyA5IHBlcmNlbnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXhQYXJ0bmVyQmFsYW5jZSA9ICAodG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQvMTAwKTsgLy8gMSBwZXJjZW50CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm1zZ21hc2sgfD0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChpY29TdGF0dXMgPT0gSWNvU3RhdHVzVmFsdWUuc3VjY2VlZGVkKSB7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVtdW5lcmF0aW9uU3RhZ2UgPT0gMCApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW11bmVyYXRpb25TdGFnZSA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtdW5lcmF0aW9uQmFsYW5jZSA9ICh0b3RhbFRva2VuRnVuZHNSZWNlaXZlZC8xMDApKjk7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1eFBhcnRuZXJCYWxhbmNlID0gICh0b3RhbFRva2VuRnVuZHNSZWNlaXZlZC8xMDApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5tc2dtYXNrIHw9IDQ7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbXVuZXJhdGlvblN0YWdlID09IDEpIHsgLy8gd2UgaGF2ZSBhbHJlYWR5IHN1Y2VlZGVkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtdW5lcmF0aW9uU3RhZ2UgPSAyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbXVuZXJhdGlvbkJhbGFuY2UgKz0gdG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQgLSAodG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQvMTApOyAvLyA5MCBwZXJjZW50CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm1zZ21hc2sgfD0gODsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB1aW50IG50bXA7CgogICAgICAgICAgICAgICAgaWYgKHJlbXVuZXJhdGlvbkJhbGFuY2UgPiAwKSB7IAogICAgICAgICAgICAgICAgLy8gb25seSBwYXkgb25lIGVudGl0eSBwZXIgY2FsbCwgZG9udCB3YW50IHRvIHJ1biBvdXQgb2YgZ2FzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnRtcCA9IHJlbXVuZXJhdGlvbkJhbGFuY2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtdW5lcmF0aW9uQmFsYW5jZSA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmb3VuZGVyT3JnLmNhbGwuZ2FzKHJtR2FzKS52YWx1ZShudG1wKSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW11bmVyYXRpb25CYWxhbmNlID0gbnRtcDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5tc2dtYXNrIHw9IDMyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBubXNnbWFzayB8PSA2NDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgIGlmIChhdXhQYXJ0bmVyQmFsYW5jZSA+IDApIHsKICAgICAgICAgICAgICAgIC8vIG5vdGUgdGhlICJlbHNlIiBvbmx5IHBheSBvbmUgZW50aXR5IHBlciBjYWxsLCBkb250IHdhbnQgdG8gcnVuIG91dCBvZiBnYXMKICAgICAgICAgICAgICAgICAgICAgICAgbnRtcCA9IGF1eFBhcnRuZXJCYWxhbmNlOwogICAgICAgICAgICAgICAgICAgICAgICBhdXhQYXJ0bmVyQmFsYW5jZSA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYXV4UGFydG5lci5jYWxsLmdhcyhybUdhcykudmFsdWUobnRtcCkoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1eFBhcnRuZXJCYWxhbmNlID0gbnRtcDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBubXNnbWFzayB8PSAxMjg7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5tc2dtYXNrIHw9IDI1NjsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIH0gCgogICAgICAgICAgICAgICAgU3RhdEV2ZW50SSgiaWNvLWNoZWNrdXAiLCBubXNnbWFzayk7CiAgICAgICAgfQoKCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIC8vIHN3YXAgZXhlY3V0b3IKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgZnVuY3Rpb24gY2hhbmdlT3duZXIoYWRkcmVzcyBfYWRkcikgCiAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIKICAgICAgICAgICAgICAgICAgICAgICAgfHwgc2V0dGluZ3NTdGF0ZSA9PSBTZXR0aW5nU3RhdGVWYWx1ZS5sb2NrZWRSZWxlYXNlKQogICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3c7CgogICAgICAgICAgICAgICAgb3duZXIgPSBfYWRkcjsKICAgICAgICB9CgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAvLyBzd2FwIGRldmVsb3BlcnMgYWNjb3VudAogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBmdW5jdGlvbiBjaGFuZ2VEZXZldm9wZXJBY2NvbnQoYWRkcmVzcyBfYWRkcikgCiAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIKICAgICAgICAgICAgICAgICAgICAgICAgfHwgc2V0dGluZ3NTdGF0ZSA9PSBTZXR0aW5nU3RhdGVWYWx1ZS5sb2NrZWRSZWxlYXNlKQogICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICAgICAgICBkZXZlbG9wZXJzID0gX2FkZHI7CiAgICAgICAgfQoKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgLy8gY2hhbmdlIGZvdW5kZXIKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgZnVuY3Rpb24gY2hhbmdlRm91bmRlcihhZGRyZXNzIF9hZGRyKSAKICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lcgogICAgICAgICAgICAgICAgICAgICAgICB8fCBzZXR0aW5nc1N0YXRlID09IFNldHRpbmdTdGF0ZVZhbHVlLmxvY2tlZFJlbGVhc2UpCiAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdzsKICAgICAgICAgICAgICAgIGZvdW5kZXJPcmcgPSBfYWRkcjsKICAgICAgICB9CgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAvLyBjaGFuZ2UgYXV4UGFydG5lcgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBmdW5jdGlvbiBjaGFuZ2VBdXhQYXJ0bmVyKGFkZHJlc3MgX2F1eCkgCiAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIKICAgICAgICAgICAgICAgICAgICAgICAgfHwgc2V0dGluZ3NTdGF0ZSA9PSBTZXR0aW5nU3RhdGVWYWx1ZS5sb2NrZWRSZWxlYXNlKQogICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICAgICAgICBhdXhQYXJ0bmVyID0gX2F1eDsKICAgICAgICB9CgoKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgLy8gREVCVUcgT05MWSAtIGVuZCB0aGlzIGNvbnRyYWN0LCBzdWljaWRlIHRvIGRldmVsb3BlcnMKICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgZnVuY3Rpb24gaGFyYUtpcmkoKQogICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChzZXR0aW5nc1N0YXRlICE9IFNldHRpbmdTdGF0ZVZhbHVlLmRlYnVnKQogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdzsKICAgICAgICAgICAgICAgIGlmIChtc2cuc2VuZGVyICE9IG93bmVyKQogICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICAgICAgICBzdWljaWRlKGRldmVsb3BlcnMpOwogICAgICAgIH0KCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIC8vIGdldCBhbGwgaWNvIHN0YXR1cywgZnVuZGluZyBhbmQgdXNhZ2UgaW5mbwogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBmdW5jdGlvbiBnZXRJY29JbmZvKCkgY29uc3RhbnQgcmV0dXJucyhJY29TdGF0dXNWYWx1ZSBfc3RhdHVzLCB1aW50IF9zYWxlU3RhcnQsIHVpbnQgX3NhbGVFbmQsIHVpbnQgX3VzYWdlRW5kLCB1aW50IF9zYWxlR29hbCwgdWludCBfdXNhZ2VHb2FsLCB1aW50IF9zb2xkLCB1aW50IF91c2VkLCB1aW50IF9mdW5kcywgdWludCBfY3JlZGl0cywgdWludCBfcmVtdVN0YWdlLCB1aW50IF92ZXN0KQogICAgICAgIHsKICAgICAgICAgICAgICAgIF9zdGF0dXMgPSBpY29TdGF0dXM7CiAgICAgICAgICAgICAgICBfc2FsZVN0YXJ0ID0gZnVuZGluZ1N0YXJ0OwogICAgICAgICAgICAgICAgX3NhbGVFbmQgPSBmdW5kaW5nRGVhZGxpbmU7CiAgICAgICAgICAgICAgICBfdXNhZ2VFbmQgPSB1c2FnZURlYWRsaW5lOwogICAgICAgICAgICAgICAgX3Zlc3QgPSB2ZXN0VGltZTsKICAgICAgICAgICAgICAgIF9zYWxlR29hbCA9IG1pbkljb1Rva2VuR29hbDsKICAgICAgICAgICAgICAgIF91c2FnZUdvYWwgPSBtaW5Vc2FnZUdvYWw7CiAgICAgICAgICAgICAgICBfc29sZCA9IGdldE51bVRva2Vuc1B1cmNoYXNlZCgpOwogICAgICAgICAgICAgICAgX3VzZWQgPSBnZXROdW1HYW1lcygpOwogICAgICAgICAgICAgICAgX2Z1bmRzID0gdG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQ7CiAgICAgICAgICAgICAgICBfY3JlZGl0cyA9IHBhcnRuZXJDcmVkaXRzOwogICAgICAgICAgICAgICAgX3JlbXVTdGFnZSA9IHJlbXVuZXJhdGlvblN0YWdlOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZmx1c2hEaXZpZGVuZHMoKQogICAgICAgIHsKICAgICAgICAgICAgICAgIGlmICgobXNnLnNlbmRlciAhPSBvd25lcikgJiYgKG1zZy5zZW5kZXIgIT0gZGV2ZWxvcGVycykpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIGlmIChob2xkb3ZlckJhbGFuY2UgPiAwIHx8IHBheW91dEJhbGFuY2UgPiAwKQogICAgICAgICAgICAgICAgICAgICAgICBkb1BheW91dCgpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZG9EZXZlbG9wZXJHcmFudCgpIGludGVybmFsCiAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKCFkZXZlbG9wZXJzR3JhbnRlZCkgewogICAgICAgICAgICAgICAgICAgICAgICBkZXZlbG9wZXJzR3JhbnRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIG51bURldlRva2VucyA9IHRvdGFsVG9rZW5zTWludGVkLzEwOwogICAgICAgICAgICAgICAgICAgICAgICB0b3RhbFRva2Vuc01pbnRlZCArPSBudW1EZXZUb2tlbnM7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaG9sZGVyQWNjb3VudHNbZGV2ZWxvcGVyc10uYWxsb2NlZCkgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkQWNjb3VudChkZXZlbG9wZXJzKTsKICAgICAgICAgICAgICAgICAgICAgICAgdWludCBuZXdIZWxkID0gZ2V0SGVsZChob2xkZXJBY2NvdW50c1tkZXZlbG9wZXJzXS50b2tlbnMpICsgbnVtRGV2VG9rZW5zOwogICAgICAgICAgICAgICAgICAgICAgICBob2xkZXJBY2NvdW50c1tkZXZlbG9wZXJzXS50b2tlbnMgPSBuZXdIZWxkIHwgIChjdXJQYXlvdXRJZCAqICgyICoqIDQ4KSk7CgogICAgICAgICAgICAgICAgfQogICAgICAgIH0KCgp9'.
	

]
