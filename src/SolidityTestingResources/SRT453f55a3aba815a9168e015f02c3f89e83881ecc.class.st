Class {
	#name : #SRT453f55a3aba815a9168e015f02c3f89e83881ecc,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT453f55a3aba815a9168e015f02c3f89e83881ecc >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKfQoKY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9Cgpjb250cmFjdCBMaW1pdGVkVHJhbnNmZXJUb2tlbiBpcyBFUkMyMCB7CgogIC8qKgogICAqIEBkZXYgQ2hlY2tzIHdoZXRoZXIgaXQgY2FuIHRyYW5zZmVyIG9yIG90aGVyd2lzZSB0aHJvd3MuCiAgICovCiAgbW9kaWZpZXIgY2FuVHJhbnNmZXIoYWRkcmVzcyBfc2VuZGVyLCB1aW50MjU2IF92YWx1ZSkgewogICByZXF1aXJlKF92YWx1ZSA8PSB0cmFuc2ZlcmFibGVUb2tlbnMoX3NlbmRlciwgdWludDY0KG5vdykpKTsKICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgQ2hlY2tzIG1vZGlmaWVyIGFuZCBhbGxvd3MgdHJhbnNmZXIgaWYgdG9rZW5zIGFyZSBub3QgbG9ja2VkLgogICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIHRva2Vucy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgY2FuVHJhbnNmZXIobXNnLnNlbmRlciwgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICB9CgogIC8qKgogICogQGRldiBDaGVja3MgbW9kaWZpZXIgYW5kIGFsbG93cyB0cmFuc2ZlciBpZiB0b2tlbnMgYXJlIG5vdCBsb2NrZWQuCiAgKiBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHNlbmQgdGhlIHRva2Vucy4KICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIHRva2Vucy4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBjYW5UcmFuc2ZlcihfZnJvbSwgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogIH0KCiAgLyoqCiAgICogQGRldiBEZWZhdWx0IHRyYW5zZmVyYWJsZSB0b2tlbnMgZnVuY3Rpb24gcmV0dXJucyBhbGwgdG9rZW5zIGZvciBhIGhvbGRlciAobm8gbGltaXQpLgogICAqIEBkZXYgT3ZlcndyaXRpbmcgdHJhbnNmZXJhYmxlVG9rZW5zKGFkZHJlc3MgaG9sZGVyLCB1aW50NjQgdGltZSkgaXMgdGhlIHdheSB0byBwcm92aWRlIHRoZQogICAqIHNwZWNpZmljIGxvZ2ljIGZvciBsaW1pdGluZyB0b2tlbiB0cmFuc2ZlcmFiaWxpdHkgZm9yIGEgaG9sZGVyIG92ZXIgdGltZS4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcmFibGVUb2tlbnMoYWRkcmVzcyBob2xkZXIsIHVpbnQ2NCB0aW1lKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGJhbGFuY2VPZihob2xkZXIpOwogIH0KfQoKbGlicmFyeSBTYWZlRVJDMjAgewogIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlcihFUkMyMEJhc2ljIHRva2VuLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBpbnRlcm5hbCB7CiAgICBhc3NlcnQodG9rZW4udHJhbnNmZXIodG8sIHZhbHVlKSk7CiAgfQoKICBmdW5jdGlvbiBzYWZlVHJhbnNmZXJGcm9tKEVSQzIwIHRva2VuLCBhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHsKICAgIGFzc2VydCh0b2tlbi50cmFuc2ZlckZyb20oZnJvbSwgdG8sIHZhbHVlKSk7CiAgfQoKICBmdW5jdGlvbiBzYWZlQXBwcm92ZShFUkMyMCB0b2tlbiwgYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBpbnRlcm5hbCB7CiAgICBhc3NlcnQodG9rZW4uYXBwcm92ZShzcGVuZGVyLCB2YWx1ZSkpOwogIH0KfQoKY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CgogICAgdWludDI1NiBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07CgogICAgLy8gQ2hlY2sgaXMgbm90IG5lZWRlZCBiZWNhdXNlIHN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0CiAgICAvLyByZXF1aXJlIChfdmFsdWUgPD0gX2FsbG93YW5jZSk7CgogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CgogIC8qKgogICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAogICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICovCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCmNvbnRyYWN0IE1pbnRhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZSB7CiAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKICBldmVudCBNaW50RmluaXNoZWQoKTsKCiAgYm9vbCBwdWJsaWMgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CgoKICBtb2RpZmllciBjYW5NaW50KCkgewogICAgcmVxdWlyZSghbWludGluZ0ZpbmlzaGVkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIG1pbnQgdG9rZW5zCiAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgbWludGVkIHRva2Vucy4KICAgKiBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAqIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoX2Ftb3VudCk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICBNaW50KF90bywgX2Ftb3VudCk7CiAgICBUcmFuc2ZlcigweDAsIF90bywgX2Ftb3VudCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gc3RvcCBtaW50aW5nIG5ldyB0b2tlbnMuCiAgICogQHJldHVybiBUcnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gZmluaXNoTWludGluZygpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgIE1pbnRGaW5pc2hlZCgpOwogICAgcmV0dXJuIHRydWU7CiAgfQp9Cgpjb250cmFjdCBUb2tlblRpbWVsb2NrIHsKICB1c2luZyBTYWZlRVJDMjAgZm9yIEVSQzIwQmFzaWM7CgogIC8vIEVSQzIwIGJhc2ljIHRva2VuIGNvbnRyYWN0IGJlaW5nIGhlbGQKICBFUkMyMEJhc2ljIHB1YmxpYyB0b2tlbjsKCiAgLy8gYmVuZWZpY2lhcnkgb2YgdG9rZW5zIGFmdGVyIHRoZXkgYXJlIHJlbGVhc2VkCiAgYWRkcmVzcyBwdWJsaWMgYmVuZWZpY2lhcnk7CgogIC8vIHRpbWVzdGFtcCB3aGVuIHRva2VuIHJlbGVhc2UgaXMgZW5hYmxlZAogIHVpbnQ2NCBwdWJsaWMgcmVsZWFzZVRpbWU7CgogIGZ1bmN0aW9uIFRva2VuVGltZWxvY2soRVJDMjBCYXNpYyBfdG9rZW4sIGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCB1aW50NjQgX3JlbGVhc2VUaW1lKSB7CiAgICByZXF1aXJlKF9yZWxlYXNlVGltZSA+IG5vdyk7CiAgICB0b2tlbiA9IF90b2tlbjsKICAgIGJlbmVmaWNpYXJ5ID0gX2JlbmVmaWNpYXJ5OwogICAgcmVsZWFzZVRpbWUgPSBfcmVsZWFzZVRpbWU7CiAgfQoKICAvKioKICAgKiBAbm90aWNlIFRyYW5zZmVycyB0b2tlbnMgaGVsZCBieSB0aW1lbG9jayB0byBiZW5lZmljaWFyeS4KICAgKiBEZXByZWNhdGVkOiBwbGVhc2UgdXNlIFRva2VuVGltZWxvY2sjcmVsZWFzZSBpbnN0ZWFkLgogICAqLwogIGZ1bmN0aW9uIGNsYWltKCkgcHVibGljIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBiZW5lZmljaWFyeSk7CiAgICByZWxlYXNlKCk7CiAgfQoKICAvKioKICAgKiBAbm90aWNlIFRyYW5zZmVycyB0b2tlbnMgaGVsZCBieSB0aW1lbG9jayB0byBiZW5lZmljaWFyeS4KICAgKi8KICBmdW5jdGlvbiByZWxlYXNlKCkgcHVibGljIHsKICAgIHJlcXVpcmUobm93ID49IHJlbGVhc2VUaW1lKTsKCiAgICB1aW50MjU2IGFtb3VudCA9IHRva2VuLmJhbGFuY2VPZih0aGlzKTsKICAgIHJlcXVpcmUoYW1vdW50ID4gMCk7CgogICAgdG9rZW4uc2FmZVRyYW5zZmVyKGJlbmVmaWNpYXJ5LCBhbW91bnQpOwogIH0KfQoKY29udHJhY3QgU3RhcnRlckNvaW4gaXMgTWludGFibGVUb2tlbiwgTGltaXRlZFRyYW5zZmVyVG9rZW4gewoKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJTdGFydGVyQ29pbiI7CiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJTVEMiOwogICAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CgogICAgdWludDI1NiBlbmRUaW1lSUNPOwoKICAgIGZ1bmN0aW9uIFN0YXJ0ZXJDb2luKHVpbnQyNTYgX2VuZFRpbWVJQ08pIHsKICAgICAgICBlbmRUaW1lSUNPID0gX2VuZFRpbWVJQ087CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJhYmxlVG9rZW5zKGFkZHJlc3MgaG9sZGVyLCB1aW50NjQgdGltZSkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICAvLyBhbGxvdyB0cmFuc2ZlcnMgYWZ0ZXIgdGhlIGVuZCBvZiBJQ08KICAgICAgICByZXR1cm4gdGltZSA+IGVuZFRpbWVJQ08gPyBiYWxhbmNlT2YoaG9sZGVyKSA6IDA7CiAgICB9Cgp9Cgpjb250cmFjdCBTdGFydGVyQ29pbkNyb3dkc2FsZSBpcyBPd25hYmxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogICAgLy8gVGhlIHRva2VuIGJlaW5nIHNvbGQKICAgIE1pbnRhYmxlVG9rZW4gcHVibGljIHRva2VuOwoKICAgIC8vIHN0YXJ0IGFuZCBlbmQgdGltZXN0YW1wcyB3aGVyZSBpbnZlc3RtZW50cyBhcmUgYWxsb3dlZCAoYm90aCBpbmNsdXNpdmUpCiAgICB1aW50MjU2IHB1YmxpYyBzdGFydFRpbWU7CiAgICB1aW50MjU2IHB1YmxpYyBwcmVTYWxlRmlyc3REYXk7CiAgICB1aW50MjU2IHB1YmxpYyBwcmVJQ09zdGFydFRpbWU7CiAgICB1aW50MjU2IHB1YmxpYyBJQ09zdGFydFRpbWU7CiAgICB1aW50MjU2IHB1YmxpYyBJQ093ZWVrMUVuZDsKICAgIHVpbnQyNTYgcHVibGljIElDT3dlZWsyRW5kOwogICAgdWludDI1NiBwdWJsaWMgSUNPd2VlazNFbmQ7CiAgICB1aW50MjU2IHB1YmxpYyBJQ093ZWVrNEVuZDsKICAgIHVpbnQyNTYgcHVibGljIGVuZFRpbWU7CgogICAgLy8gYWRkcmVzcyB3aGVyZSBmdW5kcyBhcmUgY29sbGVjdGVkCiAgICBhZGRyZXNzIHB1YmxpYyB3YWxsZXQ7CgogICAgLy8gaG93IG1hbnkgdG9rZW4gdW5pdHMgYSBidXllciBnZXRzIHBlciB3ZWkKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IFJBVEUgPSA0NTAwOwoKICAgIC8vIGFtb3VudCBvZiByYWlzZWQgbW9uZXkgaW4gd2VpCiAgICB1aW50MjU2IHB1YmxpYyB3ZWlSYWlzZWQ7CiAgICB1aW50MjU2IHB1YmxpYyB0b2tlblNvbGRQcmVTYWxlOwogICAgdWludDI1NiBwdWJsaWMgdG9rZW5Tb2xkUHJlSUNPOwogICAgdWludDI1NiBwdWJsaWMgdG9rZW5Tb2xkOwoKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IENBUCA9IDE1NDYyMiBldGhlcjsKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IFRPS0VOX1BSRVNBTEVfQ0FQID0gNDUwMDAwMDAgKiAoMTAgKiogdWludDI1NigxOCkpOwogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgVE9LRU5fUFJFSUNPX0NBUCA9IDYyNzk3NTAwICogKDEwICoqIHVpbnQyNTYoMTgpKTsKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IFRPS0VOX0NBUCA9IDY5NTc5NzUwMCAqICgxMCAqKiB1aW50MjU2KDE4KSk7IC8vIDQ1MDAwMDAwKzYyNzk3NTAwKzU4ODAwMDAwMCBMSU5LCgogICAgVG9rZW5UaW1lbG9jayBwdWJsaWMgYm91bnR5VG9rZW5UaW1lbG9jazsKICAgIFRva2VuVGltZWxvY2sgcHVibGljIGRldlRva2VuVGltZWxvY2s7CiAgICBUb2tlblRpbWVsb2NrIHB1YmxpYyBmb3VuZGVyc1Rva2VuVGltZWxvY2s7CiAgICBUb2tlblRpbWVsb2NrIHB1YmxpYyB0ZWFtVG9rZW5UaW1lbG9jazsKICAgIFRva2VuVGltZWxvY2sgcHVibGljIGFkdmlzZXJzVG9rZW5UaW1lbG9jazsKCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBCT1VOVFlfU1VQUExZID0gNzg0MDAwMDAgKiAoMTAgKiogdWludDI1NigxOCkpOwogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgREVWX1NVUFBMWSA9IDc4NDAwMDAwICogKDEwICoqIHVpbnQyNTYoMTgpKTsKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IEZPVU5ERVJTX1NVUFBMWSA9IDU5NjAwMDAwICogKDEwICoqIHVpbnQyNTYoMTgpKTsKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IFRFQU1fU1VQUExZID0gMzkyMDAwMDAgKiAoMTAgKiogdWludDI1NigxOCkpOwogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgQURWSVNFUlNfU1VQUExZID0gMjk0MDAwMDAgKiAoMTAgKiogdWludDI1NigxOCkpOwoKCiAgICBmdW5jdGlvbiBTdGFydGVyQ29pbkNyb3dkc2FsZSgKICAgICAgICB1aW50MjU2IFs5XSB0aW1pbmcsCiAgICAgICAgYWRkcmVzcyBfd2FsbGV0LAogICAgICAgIGFkZHJlc3MgYm91bnR5V2FsbGV0LAogICAgICAgIHVpbnQ2NCBib3VudHlSZWxlYXNlVGltZSwKICAgICAgICBhZGRyZXNzIGRldldhbGxldCwKICAgICAgICB1aW50NjQgZGV2UmVsZWFzZVRpbWUsCiAgICAgICAgYWRkcmVzcyBmb3VuZGVyc1dhbGxldCwKICAgICAgICB1aW50NjQgZm91bmRlcnNSZWxlYXNlVGltZSwKICAgICAgICBhZGRyZXNzIHRlYW1XYWxsZXQsCiAgICAgICAgdWludDY0IHRlYW1SZWxlYXNlVGltZSwKICAgICAgICBhZGRyZXNzIGFkdmlzZXJzV2FsbGV0LAogICAgICAgIHVpbnQ2NCBhZHZpc2Vyc1JlbGVhc2VUaW1lCiAgICAgICAgKSB7CiAgICAgICAgICAgIHN0YXJ0VGltZSA9IHRpbWluZ1swXTsKICAgICAgICAgICAgcHJlU2FsZUZpcnN0RGF5ID0gdGltaW5nWzFdOwogICAgICAgICAgICBwcmVJQ09zdGFydFRpbWUgPSB0aW1pbmdbMl07CiAgICAgICAgICAgIElDT3N0YXJ0VGltZSA9IHRpbWluZ1szXTsKICAgICAgICAgICAgSUNPd2VlazFFbmQgPSB0aW1pbmdbNF07CiAgICAgICAgICAgIElDT3dlZWsyRW5kID0gdGltaW5nWzVdOwogICAgICAgICAgICBJQ093ZWVrM0VuZCA9IHRpbWluZ1s2XTsKICAgICAgICAgICAgSUNPd2VlazRFbmQgPSB0aW1pbmdbN107CiAgICAgICAgICAgIGVuZFRpbWUgPSB0aW1pbmdbOF07CgogICAgICAgICAgICByZXF1aXJlKHN0YXJ0VGltZSA+PSBub3cpOwogICAgICAgICAgICByZXF1aXJlKHByZVNhbGVGaXJzdERheSA+PSBzdGFydFRpbWUpOwogICAgICAgICAgICByZXF1aXJlKHByZUlDT3N0YXJ0VGltZSA+PSBwcmVTYWxlRmlyc3REYXkpOwogICAgICAgICAgICByZXF1aXJlKElDT3N0YXJ0VGltZSA+PSBwcmVJQ09zdGFydFRpbWUpOwogICAgICAgICAgICByZXF1aXJlKElDT3dlZWsxRW5kID49IElDT3N0YXJ0VGltZSk7CiAgICAgICAgICAgIHJlcXVpcmUoSUNPd2VlazJFbmQgPj0gSUNPd2VlazFFbmQpOwogICAgICAgICAgICByZXF1aXJlKElDT3dlZWszRW5kID49IElDT3dlZWsyRW5kKTsKICAgICAgICAgICAgcmVxdWlyZShJQ093ZWVrNEVuZCA+PSBJQ093ZWVrM0VuZCk7CiAgICAgICAgICAgIHJlcXVpcmUoZW5kVGltZSA+PSBJQ093ZWVrNEVuZCk7CgogICAgICAgICAgICByZXF1aXJlKGRldlJlbGVhc2VUaW1lID49IGVuZFRpbWUpOwogICAgICAgICAgICByZXF1aXJlKGZvdW5kZXJzUmVsZWFzZVRpbWUgPj0gZW5kVGltZSk7CiAgICAgICAgICAgIHJlcXVpcmUodGVhbVJlbGVhc2VUaW1lID49IGVuZFRpbWUpOwogICAgICAgICAgICByZXF1aXJlKGFkdmlzZXJzUmVsZWFzZVRpbWUgPj0gZW5kVGltZSk7CgogICAgICAgICAgICByZXF1aXJlKF93YWxsZXQgIT0gMHgwKTsKICAgICAgICAgICAgcmVxdWlyZShib3VudHlXYWxsZXQgIT0gMHgwKTsKICAgICAgICAgICAgcmVxdWlyZShkZXZXYWxsZXQgIT0gMHgwKTsKICAgICAgICAgICAgcmVxdWlyZShmb3VuZGVyc1dhbGxldCAhPSAweDApOwogICAgICAgICAgICByZXF1aXJlKHRlYW1XYWxsZXQgIT0gMHgwKTsKICAgICAgICAgICAgcmVxdWlyZShhZHZpc2Vyc1dhbGxldCAhPSAweDApOwoKICAgICAgICAgICAgd2FsbGV0ID0gX3dhbGxldDsKCiAgICAgICAgICAgIHRva2VuID0gbmV3IFN0YXJ0ZXJDb2luKGVuZFRpbWUpOwoKICAgICAgICAgICAgYm91bnR5VG9rZW5UaW1lbG9jayA9IG5ldyBUb2tlblRpbWVsb2NrKHRva2VuLCBib3VudHlXYWxsZXQsIGJvdW50eVJlbGVhc2VUaW1lKTsKICAgICAgICAgICAgdG9rZW4ubWludChib3VudHlUb2tlblRpbWVsb2NrLCBCT1VOVFlfU1VQUExZKTsKCiAgICAgICAgICAgIGRldlRva2VuVGltZWxvY2sgPSBuZXcgVG9rZW5UaW1lbG9jayh0b2tlbiwgZGV2V2FsbGV0LCBkZXZSZWxlYXNlVGltZSk7CiAgICAgICAgICAgIHRva2VuLm1pbnQoZGV2VG9rZW5UaW1lbG9jaywgREVWX1NVUFBMWSk7CgogICAgICAgICAgICBmb3VuZGVyc1Rva2VuVGltZWxvY2sgPSBuZXcgVG9rZW5UaW1lbG9jayh0b2tlbiwgZm91bmRlcnNXYWxsZXQsIGZvdW5kZXJzUmVsZWFzZVRpbWUpOwogICAgICAgICAgICB0b2tlbi5taW50KGZvdW5kZXJzVG9rZW5UaW1lbG9jaywgRk9VTkRFUlNfU1VQUExZKTsKCiAgICAgICAgICAgIHRlYW1Ub2tlblRpbWVsb2NrID0gbmV3IFRva2VuVGltZWxvY2sodG9rZW4sIHRlYW1XYWxsZXQsIHRlYW1SZWxlYXNlVGltZSk7CiAgICAgICAgICAgIHRva2VuLm1pbnQodGVhbVRva2VuVGltZWxvY2ssIFRFQU1fU1VQUExZKTsKCiAgICAgICAgICAgIGFkdmlzZXJzVG9rZW5UaW1lbG9jayA9IG5ldyBUb2tlblRpbWVsb2NrKHRva2VuLCBhZHZpc2Vyc1dhbGxldCwgYWR2aXNlcnNSZWxlYXNlVGltZSk7CiAgICAgICAgICAgIHRva2VuLm1pbnQoYWR2aXNlcnNUb2tlblRpbWVsb2NrLCBBRFZJU0VSU19TVVBQTFkpOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgKiBldmVudCBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAgICAgICogQHBhcmFtIHB1cmNoYXNlciB3aG8gcGFpZCBmb3IgdGhlIHRva2VucwogICAgICAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IHdobyBnb3QgdGhlIHRva2VucwogICAgICAgICogQHBhcmFtIHZhbHVlIHdlaXMgcGFpZCBmb3IgcHVyY2hhc2UKICAgICAgICAqIEBwYXJhbSBhbW91bnQgYW1vdW50IG9mIHRva2VucyBwdXJjaGFzZWQKICAgICAgICAqLwogICAgICAgIGV2ZW50IFRva2VuUHVyY2hhc2UoYWRkcmVzcyBpbmRleGVkIHB1cmNoYXNlciwgYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IGFtb3VudCk7CgogICAgICAgIC8vIGNyZWF0ZXMgdGhlIHRva2VuIHRvIGJlIHNvbGQuCiAgICAgICAgLy8gb3ZlcnJpZGUgdGhpcyBtZXRob2QgdG8gaGF2ZSBjcm93ZHNhbGUgb2YgYSBzcGVjaWZpYyBtaW50YWJsZSB0b2tlbi4KICAgICAgICBmdW5jdGlvbiBjcmVhdGVUb2tlbkNvbnRyYWN0KCkgaW50ZXJuYWwgcmV0dXJucyAoTWludGFibGVUb2tlbikgewogICAgICAgICAgICByZXR1cm4gbmV3IE1pbnRhYmxlVG9rZW4oKTsKICAgICAgICB9CgoKICAgICAgICAvLyBmYWxsYmFjayBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBidXkgdG9rZW5zCiAgICAgICAgZnVuY3Rpb24gKCkgcGF5YWJsZSB7CiAgICAgICAgICAgIGJ1eVRva2Vucyhtc2cuc2VuZGVyKTsKICAgICAgICB9CgogICAgICAgIC8vIGxvdyBsZXZlbCB0b2tlbiBwdXJjaGFzZSBmdW5jdGlvbgogICAgICAgIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgICAgIHJlcXVpcmUoYmVuZWZpY2lhcnkgIT0gMHgwKTsKICAgICAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgIT0gMCk7CgogICAgICAgICAgICB1aW50MjU2IHdlaUFtb3VudCA9IG1zZy52YWx1ZTsKCiAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSBwZXJpb2QgYm9udXMKICAgICAgICAgICAgdWludDI1NiBwZXJpb2RCb251czsKICAgICAgICAgICAgaWYgKG5vdyA8IHByZVNhbGVGaXJzdERheSkgewogICAgICAgICAgICBwZXJpb2RCb251cyA9IDIyNTA7IC8vIDUwJSBib251cyBmb3IgUkFURSA0NTAwCiAgICAgICAgICAgIH0gZWxzZSBpZiAobm93IDwgcHJlSUNPc3RhcnRUaW1lKSB7CiAgICAgICAgICAgIHBlcmlvZEJvbnVzID0gMTgwMDsgLy8gNDAlIGJvbnVzIGZvciBSQVRFIDQ1MDAKICAgICAgICAgICAgfSBlbHNlIGlmIChub3cgPCBJQ09zdGFydFRpbWUpIHsKICAgICAgICAgICAgcGVyaW9kQm9udXMgPSAxMzUwOyAvLyAzMCUgYm9udXMgZm9yIFJBVEUgNDUwMAogICAgICAgICAgICB9IGVsc2UgaWYgKG5vdyA8IElDT3dlZWsxRW5kKSB7CiAgICAgICAgICAgIHBlcmlvZEJvbnVzID0gMTEyNTsgLy8gMjUlIGJvbnVzIGZvciBSQVRFIDQ1MDAKICAgICAgICAgICAgfSBlbHNlIGlmIChub3cgPCBJQ093ZWVrMkVuZCkgewogICAgICAgICAgICBwZXJpb2RCb251cyA9IDkwMDsgLy8gMjAlIGJvbnVzIGZvciBSQVRFIDQ1MDAKICAgICAgICAgICAgfSBlbHNlIGlmIChub3cgPCBJQ093ZWVrM0VuZCkgewogICAgICAgICAgICBwZXJpb2RCb251cyA9IDY3NTsgLy8gMTUlIGJvbnVzIGZvciBSQVRFIDQ1MDAKICAgICAgICAgICAgfSBlbHNlIGlmIChub3cgPCBJQ093ZWVrNEVuZCkgewogICAgICAgICAgICBwZXJpb2RCb251cyA9IDQ1MDsgLy8gMTAlIGJvbnVzIGZvciBSQVRFIDQ1MDAKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcGVyaW9kQm9udXMgPSAyMjU7IC8vIDUlIGJvbnVzIGZvciBSQVRFIDQ1MDAKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gY2FsY3VsYXRlIGJ1bGsgcHVyY2hhc2UgYm9udXMKICAgICAgICAgICAgdWludDI1NiBidWxrUHVyY2hhc2VCb251czsKICAgICAgICAgICAgaWYgKHdlaUFtb3VudCA+PSA1MCBldGhlcikgewogICAgICAgICAgICBidWxrUHVyY2hhc2VCb251cyA9IDM2MDA7IC8vIDgwJSBib251cyBmb3IgUkFURSA0NTAwCiAgICAgICAgICAgIH0gZWxzZSBpZiAod2VpQW1vdW50ID49IDMwIGV0aGVyKSB7CiAgICAgICAgICAgIGJ1bGtQdXJjaGFzZUJvbnVzID0gMzE1MDsgLy8gNzAlIGJvbnVzIGZvciBSQVRFIDQ1MDAKICAgICAgICAgICAgfSBlbHNlIGlmICh3ZWlBbW91bnQgPj0gMTAgZXRoZXIpIHsKICAgICAgICAgICAgYnVsa1B1cmNoYXNlQm9udXMgPSAyMjUwOyAvLyA1MCUgYm9udXMgZm9yIFJBVEUgNDUwMAogICAgICAgICAgICB9IGVsc2UgaWYgKHdlaUFtb3VudCA+PSA1IGV0aGVyKSB7CiAgICAgICAgICAgIGJ1bGtQdXJjaGFzZUJvbnVzID0gMTM1MDsgLy8gMzAlIGJvbnVzIGZvciBSQVRFIDQ1MDAKICAgICAgICAgICAgfSBlbHNlIGlmICh3ZWlBbW91bnQgPj0gMyBldGhlcikgewogICAgICAgICAgICBidWxrUHVyY2hhc2VCb251cyA9IDQ1MDsgLy8gMTAlIGJvbnVzIGZvciBSQVRFIDQ1MDAKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdWludDI1NiBhY3R1YWxSYXRlID0gUkFURS5hZGQocGVyaW9kQm9udXMpLmFkZChidWxrUHVyY2hhc2VCb251cyk7CgogICAgICAgICAgICAvLyBjYWxjdWxhdGUgdG9rZW4gYW1vdW50IHRvIGJlIGNyZWF0ZWQKICAgICAgICAgICAgdWludDI1NiB0b2tlbnMgPSB3ZWlBbW91bnQubXVsKGFjdHVhbFJhdGUpOwoKICAgICAgICAgICAgLy8gdXBkYXRlIHN0YXRlCiAgICAgICAgICAgIHdlaVJhaXNlZCA9IHdlaVJhaXNlZC5hZGQod2VpQW1vdW50KTsKICAgICAgICAgICAgdG9rZW5Tb2xkID0gdG9rZW5Tb2xkLmFkZCh0b2tlbnMpOwoKICAgICAgICAgICAgLy8gY2hlY2sgZm9yIHRva2VuQ0FQCiAgICAgICAgICAgIGlmIChub3cgPCBwcmVJQ09zdGFydFRpbWUpIHsKICAgICAgICAgICAgLy8gcHJlc2FsZQogICAgICAgICAgICB0b2tlblNvbGRQcmVTYWxlID0gdG9rZW5Tb2xkUHJlU2FsZS5hZGQodG9rZW5zKTsKICAgICAgICAgICAgcmVxdWlyZSh0b2tlblNvbGRQcmVTYWxlIDw9IFRPS0VOX1BSRVNBTEVfQ0FQKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChub3cgPCBJQ09zdGFydFRpbWUpIHsKICAgICAgICAgICAgLy8gcHJlSUNPCiAgICAgICAgICAgIHRva2VuU29sZFByZUlDTyA9IHRva2VuU29sZFByZUlDTy5hZGQodG9rZW5zKTsKICAgICAgICAgICAgcmVxdWlyZSh0b2tlblNvbGRQcmVJQ08gPD0gVE9LRU5fUFJFSUNPX0NBUCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIElDTwogICAgICAgICAgICByZXF1aXJlKHRva2VuU29sZCA8PSBUT0tFTl9DQVApOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXF1aXJlKHZhbGlkUHVyY2hhc2UoKSk7CgogICAgICAgICAgICB0b2tlbi5taW50KGJlbmVmaWNpYXJ5LCB0b2tlbnMpOwogICAgICAgICAgICBUb2tlblB1cmNoYXNlKG1zZy5zZW5kZXIsIGJlbmVmaWNpYXJ5LCB3ZWlBbW91bnQsIHRva2Vucyk7CgogICAgICAgICAgICBmb3J3YXJkRnVuZHMoKTsKICAgICAgICB9CgogICAgICAgIC8vIHNlbmQgZXRoZXIgdG8gdGhlIGZ1bmQgY29sbGVjdGlvbiB3YWxsZXQKICAgICAgICAvLyBvdmVycmlkZSB0byBjcmVhdGUgY3VzdG9tIGZ1bmQgZm9yd2FyZGluZyBtZWNoYW5pc21zCiAgICAgICAgZnVuY3Rpb24gZm9yd2FyZEZ1bmRzKCkgaW50ZXJuYWwgewogICAgICAgICAgICB3YWxsZXQudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgICAgICB9CgogICAgICAgIC8vIGFkZCBvZmYgY2hhaW4gY29udHJpYnV0aW9uLiBCVEMgYWRkcmVzcyBvZiBjb250cmlidXRpb24gYWRkZWQgZm9yIHRyYW5zcGFyZW5jeQogICAgICAgIGZ1bmN0aW9uIGFkZE9mZkNoYWluQ29udHJpYnV0aW9uKGFkZHJlc3MgYmVuZWZpY2lhciwgdWludDI1NiB3ZWlBbW91bnQsIHVpbnQyNTYgdG9rZW5BbW91bnQsIHN0cmluZyBidGNBZGRyZXNzKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICAgICAgcmVxdWlyZShiZW5lZmljaWFyICE9IDB4MCk7CiAgICAgICAgICAgIHJlcXVpcmUod2VpQW1vdW50ID4gMCk7CiAgICAgICAgICAgIHJlcXVpcmUodG9rZW5BbW91bnQgPiAwKTsKICAgICAgICAgICAgd2VpUmFpc2VkICs9IHdlaUFtb3VudDsKICAgICAgICAgICAgdG9rZW5Tb2xkICs9IHRva2VuQW1vdW50OwogICAgICAgICAgICByZXF1aXJlKHZhbGlkUHVyY2hhc2UoKSk7CiAgICAgICAgICAgIHRva2VuLm1pbnQoYmVuZWZpY2lhciwgdG9rZW5BbW91bnQpOwogICAgICAgIH0KCgogICAgICAgIC8vIG92ZXJyaWRpbmcgQ3Jvd2RzYWxlI3ZhbGlkUHVyY2hhc2UgdG8gYWRkIGV4dHJhIENBUCBsb2dpYwogICAgICAgIC8vIEByZXR1cm4gdHJ1ZSBpZiBpbnZlc3RvcnMgY2FuIGJ1eSBhdCB0aGUgbW9tZW50CiAgICAgICAgZnVuY3Rpb24gdmFsaWRQdXJjaGFzZSgpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICAgICAgYm9vbCB3aXRoaW5DYXAgPSB3ZWlSYWlzZWQgPD0gQ0FQOwogICAgICAgICAgICBib29sIHdpdGhpblBlcmlvZCA9IG5vdyA+PSBzdGFydFRpbWUgJiYgbm93IDw9IGVuZFRpbWU7CiAgICAgICAgICAgIGJvb2wgd2l0aGluVG9rZW5DYXAgPSB0b2tlblNvbGQgPD0gVE9LRU5fQ0FQOwogICAgICAgICAgICByZXR1cm4gd2l0aGluUGVyaW9kICYmIHdpdGhpbkNhcCAmJiB3aXRoaW5Ub2tlbkNhcDsKICAgICAgICB9CgogICAgICAgIC8vIG92ZXJyaWRpbmcgQ3Jvd2RzYWxlI2hhc0VuZGVkIHRvIGFkZCBDQVAgbG9naWMKICAgICAgICAvLyBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBlbmRlZAogICAgICAgIGZ1bmN0aW9uIGhhc0VuZGVkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICAgICAgYm9vbCBjYXBSZWFjaGVkID0gd2VpUmFpc2VkID49IENBUDsKICAgICAgICAgICAgcmV0dXJuIG5vdyA+IGVuZFRpbWUgfHwgY2FwUmVhY2hlZDsKICAgICAgICB9CgogICAgfQ=='.
	

]
