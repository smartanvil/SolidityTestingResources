Class {
	#name : #SRTd9a2fce62e8a6d45b20b906aa2fb2de3f607c88a,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd9a2fce62e8a6d45b20b906aa2fb2de3f607c88a >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7CgpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKY29udHJhY3QgUGF1c2FibGUgaXMgT3duYWJsZSB7CiAgZXZlbnQgUGF1c2UoKTsKICBldmVudCBVbnBhdXNlKCk7CgogIGJvb2wgcHVibGljIHBhdXNlZCA9IGZhbHNlOwoKCiAgLyoqCiAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBub3QgcGF1c2VkLgogICAqLwogIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICByZXF1aXJlKCFwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgcGF1c2VkLgogICAqLwogIG1vZGlmaWVyIHdoZW5QYXVzZWQoKSB7CiAgICByZXF1aXJlKHBhdXNlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHBhdXNlLCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlCiAgICovCiAgZnVuY3Rpb24gcGF1c2UoKSBvbmx5T3duZXIgd2hlbk5vdFBhdXNlZCBwdWJsaWMgewogICAgcGF1c2VkID0gdHJ1ZTsKICAgIFBhdXNlKCk7CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gdW5wYXVzZSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgKi8KICBmdW5jdGlvbiB1bnBhdXNlKCkgb25seU93bmVyIHdoZW5QYXVzZWQgcHVibGljIHsKICAgIHBhdXNlZCA9IGZhbHNlOwogICAgVW5wYXVzZSgpOwogIH0KfQoKY29udHJhY3QgQ2FuUmVjbGFpbVRva2VuIGlzIE93bmFibGUgewogIHVzaW5nIFNhZmVFUkMyMCBmb3IgRVJDMjBCYXNpYzsKCiAgLyoqCiAgICogQGRldiBSZWNsYWltIGFsbCBFUkMyMEJhc2ljIGNvbXBhdGlibGUgdG9rZW5zCiAgICogQHBhcmFtIHRva2VuIEVSQzIwQmFzaWMgVGhlIGFkZHJlc3Mgb2YgdGhlIHRva2VuIGNvbnRyYWN0CiAgICovCiAgZnVuY3Rpb24gcmVjbGFpbVRva2VuKEVSQzIwQmFzaWMgdG9rZW4pIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICB1aW50MjU2IGJhbGFuY2UgPSB0b2tlbi5iYWxhbmNlT2YodGhpcyk7CiAgICB0b2tlbi5zYWZlVHJhbnNmZXIob3duZXIsIGJhbGFuY2UpOwogIH0KCn0KCmNvbnRyYWN0IENsYWltYWJsZSBpcyBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBwZW5kaW5nT3duZXI7CgogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBwZW5kaW5nT3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seVBlbmRpbmdPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBwZW5kaW5nT3duZXIpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHNldCB0aGUgcGVuZGluZ093bmVyIGFkZHJlc3MuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHBlbmRpbmdPd25lciA9IG5ld093bmVyOwogIH0KCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIHBlbmRpbmdPd25lciBhZGRyZXNzIHRvIGZpbmFsaXplIHRoZSB0cmFuc2Zlci4KICAgKi8KICBmdW5jdGlvbiBjbGFpbU93bmVyc2hpcCgpIG9ubHlQZW5kaW5nT3duZXIgcHVibGljIHsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBwZW5kaW5nT3duZXIpOwogICAgb3duZXIgPSBwZW5kaW5nT3duZXI7CiAgICBwZW5kaW5nT3duZXIgPSBhZGRyZXNzKDApOwogIH0KfQoKY29udHJhY3QgQWRkcmVzc0xpc3QgaXMgQ2xhaW1hYmxlIHsKICAgIHN0cmluZyBwdWJsaWMgbmFtZTsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIG9uTGlzdDsKCiAgICBmdW5jdGlvbiBBZGRyZXNzTGlzdChzdHJpbmcgX25hbWUsIGJvb2wgbnVsbFZhbHVlKSBwdWJsaWMgewogICAgICAgIG5hbWUgPSBfbmFtZTsKICAgICAgICBvbkxpc3RbMHgwXSA9IG51bGxWYWx1ZTsKICAgIH0KICAgIGV2ZW50IENoYW5nZVdoaXRlTGlzdChhZGRyZXNzIGluZGV4ZWQgdG8sIGJvb2wgb25MaXN0KTsKCiAgICAvLyBTZXQgd2hldGhlciBfdG8gaXMgb24gdGhlIGxpc3Qgb3Igbm90LiBXaGV0aGVyIDB4MCBpcyBvbiB0aGUgbGlzdAogICAgLy8gb3Igbm90IGNhbm5vdCBiZSBzZXQgaGVyZSAtIGl0IGlzIHNldCBvbmNlIGFuZCBmb3IgYWxsIGJ5IHRoZSBjb25zdHJ1Y3Rvci4KICAgIGZ1bmN0aW9uIGNoYW5nZUxpc3QoYWRkcmVzcyBfdG8sIGJvb2wgX29uTGlzdCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gMHgwKTsKICAgICAgICBpZiAob25MaXN0W190b10gIT0gX29uTGlzdCkgewogICAgICAgICAgICBvbkxpc3RbX3RvXSA9IF9vbkxpc3Q7CiAgICAgICAgICAgIENoYW5nZVdoaXRlTGlzdChfdG8sIF9vbkxpc3QpOwogICAgICAgIH0KICAgIH0KfQoKY29udHJhY3QgSGFzTm9Db250cmFjdHMgaXMgT3duYWJsZSB7CgogIC8qKgogICAqIEBkZXYgUmVjbGFpbSBvd25lcnNoaXAgb2YgT3duYWJsZSBjb250cmFjdHMKICAgKiBAcGFyYW0gY29udHJhY3RBZGRyIFRoZSBhZGRyZXNzIG9mIHRoZSBPd25hYmxlIHRvIGJlIHJlY2xhaW1lZC4KICAgKi8KICBmdW5jdGlvbiByZWNsYWltQ29udHJhY3QoYWRkcmVzcyBjb250cmFjdEFkZHIpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICBPd25hYmxlIGNvbnRyYWN0SW5zdCA9IE93bmFibGUoY29udHJhY3RBZGRyKTsKICAgIGNvbnRyYWN0SW5zdC50cmFuc2Zlck93bmVyc2hpcChvd25lcik7CiAgfQp9Cgpjb250cmFjdCBIYXNOb0V0aGVyIGlzIE93bmFibGUgewoKICAvKioKICAqIEBkZXYgQ29uc3RydWN0b3IgdGhhdCByZWplY3RzIGluY29taW5nIEV0aGVyCiAgKiBAZGV2IFRoZSBgcGF5YWJsZWAgZmxhZyBpcyBhZGRlZCBzbyB3ZSBjYW4gYWNjZXNzIGBtc2cudmFsdWVgIHdpdGhvdXQgY29tcGlsZXIgd2FybmluZy4gSWYgd2UKICAqIGxlYXZlIG91dCBwYXlhYmxlLCB0aGVuIFNvbGlkaXR5IHdpbGwgYWxsb3cgaW5oZXJpdGluZyBjb250cmFjdHMgdG8gaW1wbGVtZW50IGEgcGF5YWJsZQogICogY29uc3RydWN0b3IuIEJ5IGRvaW5nIGl0IHRoaXMgd2F5IHdlIHByZXZlbnQgYSBwYXlhYmxlIGNvbnN0cnVjdG9yIGZyb20gd29ya2luZy4gQWx0ZXJuYXRpdmVseQogICogd2UgY291bGQgdXNlIGFzc2VtYmx5IHRvIGFjY2VzcyBtc2cudmFsdWUuCiAgKi8KICBmdW5jdGlvbiBIYXNOb0V0aGVyKCkgcHVibGljIHBheWFibGUgewogICAgcmVxdWlyZShtc2cudmFsdWUgPT0gMCk7CiAgfQoKICAvKioKICAgKiBAZGV2IERpc2FsbG93cyBkaXJlY3Qgc2VuZCBieSBzZXR0aW5ncyBhIGRlZmF1bHQgZnVuY3Rpb24gd2l0aG91dCB0aGUgYHBheWFibGVgIGZsYWcuCiAgICovCiAgZnVuY3Rpb24oKSBleHRlcm5hbCB7CiAgfQoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIGFsbCBFdGhlciBoZWxkIGJ5IHRoZSBjb250cmFjdCB0byB0aGUgb3duZXIuCiAgICovCiAgZnVuY3Rpb24gcmVjbGFpbUV0aGVyKCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIGFzc2VydChvd25lci5zZW5kKHRoaXMuYmFsYW5jZSkpOwogIH0KfQoKY29udHJhY3QgSGFzTm9Ub2tlbnMgaXMgQ2FuUmVjbGFpbVRva2VuIHsKCiAvKioKICAqIEBkZXYgUmVqZWN0IGFsbCBFUkMyMjMgY29tcGF0aWJsZSB0b2tlbnMKICAqIEBwYXJhbSBmcm9tXyBhZGRyZXNzIFRoZSBhZGRyZXNzIHRoYXQgaXMgdHJhbnNmZXJyaW5nIHRoZSB0b2tlbnMKICAqIEBwYXJhbSB2YWx1ZV8gdWludDI1NiB0aGUgYW1vdW50IG9mIHRoZSBzcGVjaWZpZWQgdG9rZW4KICAqIEBwYXJhbSBkYXRhXyBCeXRlcyBUaGUgZGF0YSBwYXNzZWQgZnJvbSB0aGUgY2FsbGVyLgogICovCiAgZnVuY3Rpb24gdG9rZW5GYWxsYmFjayhhZGRyZXNzIGZyb21fLCB1aW50MjU2IHZhbHVlXywgYnl0ZXMgZGF0YV8pIGV4dGVybmFsIHsKICAgIGZyb21fOwogICAgdmFsdWVfOwogICAgZGF0YV87CiAgICByZXZlcnQoKTsKICB9Cgp9Cgpjb250cmFjdCBUaW1lTG9ja2VkQ29udHJvbGxlciBpcyBIYXNOb0V0aGVyLCBIYXNOb1Rva2VucywgQ2xhaW1hYmxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIC8vIDI0IGhvdXJzLCBhc3N1bWluZyBhIDE1IHNlY29uZCBibG9ja3RpbWUuCiAgICAvLyBBcyBsb25nIGFzIHRoaXMgaXNuJ3QgdG9vIGZhciBvZmYgZnJvbSByZWFsaXR5IGl0IGRvZXNuJ3QgcmVhbGx5IG1hdHRlci4KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IGJsb2Nrc0RlbGF5ID0gMjQqNjAqNjAvMTU7CgogICAgc3RydWN0IE1pbnRPcGVyYXRpb24gewogICAgICAgIGFkZHJlc3MgdG87CiAgICAgICAgdWludDI1NiBhbW91bnQ7CiAgICAgICAgYWRkcmVzcyBhZG1pbjsKICAgICAgICB1aW50IGRlZmVyQmxvY2s7CiAgICB9CgogICAgc3RydWN0IFRyYW5zZmVyT3duZXJzaGlwT3BlcmF0aW9uIHsKICAgICAgICBhZGRyZXNzIG5ld093bmVyOwogICAgICAgIGFkZHJlc3MgYWRtaW47CiAgICAgICAgdWludCBkZWZlckJsb2NrOwogICAgfQoKICAgIHN0cnVjdCBDaGFuZ2VCdXJuQm91bmRzT3BlcmF0aW9uIHsKICAgICAgICB1aW50IG5ld01pbjsKICAgICAgICB1aW50IG5ld01heDsKICAgICAgICBhZGRyZXNzIGFkbWluOwogICAgICAgIHVpbnQgZGVmZXJCbG9jazsKICAgIH0KCiAgICBzdHJ1Y3QgQ2hhbmdlSW5zdXJhbmNlRmVlc09wZXJhdGlvbiB7CiAgICAgICAgdWludDgwIF90cmFuc2ZlckZlZU51bWVyYXRvcjsKICAgICAgICB1aW50ODAgX3RyYW5zZmVyRmVlRGVub21pbmF0b3I7CiAgICAgICAgdWludDgwIF9taW50RmVlTnVtZXJhdG9yOwogICAgICAgIHVpbnQ4MCBfbWludEZlZURlbm9taW5hdG9yOwogICAgICAgIHVpbnQyNTYgX21pbnRGZWVGbGF0OwogICAgICAgIHVpbnQ4MCBfYnVybkZlZU51bWVyYXRvcjsKICAgICAgICB1aW50ODAgX2J1cm5GZWVEZW5vbWluYXRvcjsKICAgICAgICB1aW50MjU2IF9idXJuRmVlRmxhdDsKICAgICAgICBhZGRyZXNzIGFkbWluOwogICAgICAgIHVpbnQgZGVmZXJCbG9jazsKICAgIH0KCiAgICBzdHJ1Y3QgQ2hhbmdlSW5zdXJlck9wZXJhdGlvbiB7CiAgICAgICAgYWRkcmVzcyBuZXdJbnN1cmVyOwogICAgICAgIGFkZHJlc3MgYWRtaW47CiAgICAgICAgdWludCBkZWZlckJsb2NrOwogICAgfQoKICAgIGFkZHJlc3MgcHVibGljIGFkbWluOwogICAgVHJ1ZVVTRCBwdWJsaWMgY2hpbGQ7CiAgICBBZGRyZXNzTGlzdCBwdWJsaWMgY2FuQnVybldoaXRlTGlzdDsKICAgIEFkZHJlc3NMaXN0IHB1YmxpYyBjYW5SZWNlaXZlTWludFdoaXRlbGlzdDsKICAgIEFkZHJlc3NMaXN0IHB1YmxpYyBibGFja0xpc3Q7CiAgICBNaW50T3BlcmF0aW9uW10gcHVibGljIG1pbnRPcGVyYXRpb25zOwogICAgVHJhbnNmZXJPd25lcnNoaXBPcGVyYXRpb24gcHVibGljIHRyYW5zZmVyT3duZXJzaGlwT3BlcmF0aW9uOwogICAgQ2hhbmdlQnVybkJvdW5kc09wZXJhdGlvbiBwdWJsaWMgY2hhbmdlQnVybkJvdW5kc09wZXJhdGlvbjsKICAgIENoYW5nZUluc3VyYW5jZUZlZXNPcGVyYXRpb24gcHVibGljIGNoYW5nZUluc3VyYW5jZUZlZXNPcGVyYXRpb247CiAgICBDaGFuZ2VJbnN1cmVyT3BlcmF0aW9uIHB1YmxpYyBjaGFuZ2VJbnN1cmVyT3BlcmF0aW9uOwoKICAgIG1vZGlmaWVyIG9ubHlBZG1pbk9yT3duZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkbWluIHx8IG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gY29tcHV0ZURlZmVyQmxvY2soKSBwcml2YXRlIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIGlmIChtc2cuc2VuZGVyID09IG93bmVyKSB7CiAgICAgICAgICAgIHJldHVybiBibG9jay5udW1iZXI7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGJsb2NrLm51bWJlci5hZGQoYmxvY2tzRGVsYXkpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBzdGFydHMgd2l0aCBubyBhZG1pbgogICAgZnVuY3Rpb24gVGltZUxvY2tlZENvbnRyb2xsZXIoYWRkcmVzcyBfY2hpbGQsIGFkZHJlc3MgX2NhbkJ1cm5XaGl0ZUxpc3QsIGFkZHJlc3MgX2NhblJlY2VpdmVNaW50V2hpdGVsaXN0LCBhZGRyZXNzIF9ibGFja0xpc3QpIHB1YmxpYyB7CiAgICAgICAgY2hpbGQgPSBUcnVlVVNEKF9jaGlsZCk7CiAgICAgICAgY2FuQnVybldoaXRlTGlzdCA9IEFkZHJlc3NMaXN0KF9jYW5CdXJuV2hpdGVMaXN0KTsKICAgICAgICBjYW5SZWNlaXZlTWludFdoaXRlbGlzdCA9IEFkZHJlc3NMaXN0KF9jYW5SZWNlaXZlTWludFdoaXRlbGlzdCk7CiAgICAgICAgYmxhY2tMaXN0ID0gQWRkcmVzc0xpc3QoX2JsYWNrTGlzdCk7CiAgICB9CgogICAgZXZlbnQgTWludE9wZXJhdGlvbkV2ZW50KGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgYW1vdW50LCB1aW50IGRlZmVyQmxvY2ssIHVpbnQgb3BJbmRleCk7CiAgICBldmVudCBUcmFuc2Zlck93bmVyc2hpcE9wZXJhdGlvbkV2ZW50KGFkZHJlc3MgbmV3T3duZXIsIHVpbnQgZGVmZXJCbG9jayk7CiAgICBldmVudCBDaGFuZ2VCdXJuQm91bmRzT3BlcmF0aW9uRXZlbnQodWludCBuZXdNaW4sIHVpbnQgbmV3TWF4LCB1aW50IGRlZmVyQmxvY2spOwogICAgZXZlbnQgQ2hhbmdlSW5zdXJhbmNlRmVlc09wZXJhdGlvbkV2ZW50KHVpbnQ4MCBfdHJhbnNmZXJGZWVOdW1lcmF0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDgwIF90cmFuc2ZlckZlZURlbm9taW5hdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ4MCBfbWludEZlZU51bWVyYXRvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50ODAgX21pbnRGZWVEZW5vbWluYXRvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MjU2IF9taW50RmVlRmxhdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50ODAgX2J1cm5GZWVOdW1lcmF0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDgwIF9idXJuRmVlRGVub21pbmF0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDI1NiBfYnVybkZlZUZsYXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludCBkZWZlckJsb2NrKTsKICAgIGV2ZW50IENoYW5nZUluc3VyZXJPcGVyYXRpb25FdmVudChhZGRyZXNzIG5ld0luc3VyZXIsIHVpbnQgZGVmZXJCbG9jayk7CiAgICBldmVudCBBZG1pbnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNBZG1pbiwgYWRkcmVzcyBpbmRleGVkIG5ld0FkbWluKTsKCiAgICAvLyBhZG1pbiBpbml0aWF0ZXMgYSByZXF1ZXN0IHRvIG1pbnQgX2Ftb3VudCBUcnVlVVNEIGZvciBhY2NvdW50IF90bwogICAgZnVuY3Rpb24gcmVxdWVzdE1pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIG9ubHlBZG1pbk9yT3duZXIgewogICAgICAgIHVpbnQgZGVmZXJCbG9jayA9IGNvbXB1dGVEZWZlckJsb2NrKCk7CiAgICAgICAgTWludE9wZXJhdGlvbiBtZW1vcnkgb3AgPSBNaW50T3BlcmF0aW9uKF90bywgX2Ftb3VudCwgYWRtaW4sIGRlZmVyQmxvY2spOwogICAgICAgIE1pbnRPcGVyYXRpb25FdmVudChfdG8sIF9hbW91bnQsIGRlZmVyQmxvY2ssIG1pbnRPcGVyYXRpb25zLmxlbmd0aCk7CiAgICAgICAgbWludE9wZXJhdGlvbnMucHVzaChvcCk7CiAgICB9CgogICAgLy8gYWRtaW4gaW5pdGlhdGVzIGEgcmVxdWVzdCB0byB0cmFuc2ZlciBvd25lcnNoaXAgb2YgdGhlIFRydWVVU0QgY29udHJhY3QgYW5kIGFsbCBBZGRyZXNzTGlzdHMgdG8gbmV3T3duZXIuCiAgICAvLyBDYW4gYmUgdXNlZCBlLmcuIHRvIHVwZ3JhZGUgdGhpcyBUaW1lTG9ja2VkQ29udHJvbGxlciBjb250cmFjdC4KICAgIGZ1bmN0aW9uIHJlcXVlc3RUcmFuc2ZlckNoaWxkcmVuT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5QWRtaW5Pck93bmVyIHsKICAgICAgICB1aW50IGRlZmVyQmxvY2sgPSBjb21wdXRlRGVmZXJCbG9jaygpOwogICAgICAgIHRyYW5zZmVyT3duZXJzaGlwT3BlcmF0aW9uID0gVHJhbnNmZXJPd25lcnNoaXBPcGVyYXRpb24obmV3T3duZXIsIGFkbWluLCBkZWZlckJsb2NrKTsKICAgICAgICBUcmFuc2Zlck93bmVyc2hpcE9wZXJhdGlvbkV2ZW50KG5ld093bmVyLCBkZWZlckJsb2NrKTsKICAgIH0KCiAgICAvLyBhZG1pbiBpbml0aWF0ZXMgYSByZXF1ZXN0IHRoYXQgdGhlIG1pbmltdW0gYW5kIG1heGltdW0gYW1vdW50cyB0aGF0IGFueSBUcnVlVVNEIHVzZXIgY2FuCiAgICAvLyBidXJuIGJlY29tZSBuZXdNaW4gYW5kIG5ld01heAogICAgZnVuY3Rpb24gcmVxdWVzdENoYW5nZUJ1cm5Cb3VuZHModWludCBuZXdNaW4sIHVpbnQgbmV3TWF4KSBwdWJsaWMgb25seUFkbWluT3JPd25lciB7CiAgICAgICAgdWludCBkZWZlckJsb2NrID0gY29tcHV0ZURlZmVyQmxvY2soKTsKICAgICAgICBjaGFuZ2VCdXJuQm91bmRzT3BlcmF0aW9uID0gQ2hhbmdlQnVybkJvdW5kc09wZXJhdGlvbihuZXdNaW4sIG5ld01heCwgYWRtaW4sIGRlZmVyQmxvY2spOwogICAgICAgIENoYW5nZUJ1cm5Cb3VuZHNPcGVyYXRpb25FdmVudChuZXdNaW4sIG5ld01heCwgZGVmZXJCbG9jayk7CiAgICB9CgogICAgLy8gYWRtaW4gaW5pdGlhdGVzIGEgcmVxdWVzdCB0aGF0IHRoZSBpbnN1cmFuY2UgZmVlIGJlIGNoYW5nZWQKICAgIGZ1bmN0aW9uIHJlcXVlc3RDaGFuZ2VJbnN1cmFuY2VGZWVzKHVpbnQ4MCBfdHJhbnNmZXJGZWVOdW1lcmF0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50ODAgX3RyYW5zZmVyRmVlRGVub21pbmF0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50ODAgX21pbnRGZWVOdW1lcmF0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50ODAgX21pbnRGZWVEZW5vbWluYXRvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQyNTYgX21pbnRGZWVGbGF0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDgwIF9idXJuRmVlTnVtZXJhdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDgwIF9idXJuRmVlRGVub21pbmF0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MjU2IF9idXJuRmVlRmxhdCkgcHVibGljIG9ubHlBZG1pbk9yT3duZXIgewogICAgICAgIHVpbnQgZGVmZXJCbG9jayA9IGNvbXB1dGVEZWZlckJsb2NrKCk7CiAgICAgICAgY2hhbmdlSW5zdXJhbmNlRmVlc09wZXJhdGlvbiA9IENoYW5nZUluc3VyYW5jZUZlZXNPcGVyYXRpb24oX3RyYW5zZmVyRmVlTnVtZXJhdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90cmFuc2ZlckZlZURlbm9taW5hdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9taW50RmVlTnVtZXJhdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9taW50RmVlRGVub21pbmF0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX21pbnRGZWVGbGF0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9idXJuRmVlTnVtZXJhdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9idXJuRmVlRGVub21pbmF0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2J1cm5GZWVGbGF0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkbWluLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVyQmxvY2spOwogICAgICAgIENoYW5nZUluc3VyYW5jZUZlZXNPcGVyYXRpb25FdmVudChfdHJhbnNmZXJGZWVOdW1lcmF0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90cmFuc2ZlckZlZURlbm9taW5hdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbWludEZlZU51bWVyYXRvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX21pbnRGZWVEZW5vbWluYXRvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX21pbnRGZWVGbGF0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYnVybkZlZU51bWVyYXRvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2J1cm5GZWVEZW5vbWluYXRvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2J1cm5GZWVGbGF0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlckJsb2NrKTsKICAgIH0KCiAgICAvLyBhZG1pbiBpbml0aWF0ZXMgYSByZXF1ZXN0IHRoYXQgdGhlIHJlY2lwaWVudCBvZiB0aGUgaW5zdXJhbmNlIGZlZSBiZSBjaGFuZ2VkIHRvIG5ld0luc3VyZXIKICAgIGZ1bmN0aW9uIHJlcXVlc3RDaGFuZ2VJbnN1cmVyKGFkZHJlc3MgbmV3SW5zdXJlcikgcHVibGljIG9ubHlBZG1pbk9yT3duZXIgewogICAgICAgIHVpbnQgZGVmZXJCbG9jayA9IGNvbXB1dGVEZWZlckJsb2NrKCk7CiAgICAgICAgY2hhbmdlSW5zdXJlck9wZXJhdGlvbiA9IENoYW5nZUluc3VyZXJPcGVyYXRpb24obmV3SW5zdXJlciwgYWRtaW4sIGRlZmVyQmxvY2spOwogICAgICAgIENoYW5nZUluc3VyZXJPcGVyYXRpb25FdmVudChuZXdJbnN1cmVyLCBkZWZlckJsb2NrKTsKICAgIH0KCiAgICAvLyBhZnRlciBhIGRheSwgYmVuZWZpY2lhcnkgb2YgYSBtaW50IHJlcXVlc3QgZmluYWxpemVzIGl0IGJ5IHByb3ZpZGluZyB0aGUKICAgIC8vIGluZGV4IG9mIHRoZSByZXF1ZXN0ICh2aXNpYmxlIGluIHRoZSBNaW50T3BlcmF0aW9uRXZlbnQgYWNjb21wYW55aW5nIHRoZSBvcmlnaW5hbCByZXF1ZXN0KQogICAgZnVuY3Rpb24gZmluYWxpemVNaW50KHVpbnQgaW5kZXgpIHB1YmxpYyBvbmx5QWRtaW5Pck93bmVyIHsKICAgICAgICBNaW50T3BlcmF0aW9uIG1lbW9yeSBvcCA9IG1pbnRPcGVyYXRpb25zW2luZGV4XTsKICAgICAgICByZXF1aXJlKG9wLmFkbWluID09IGFkbWluKTsgLy9jaGVja3MgdGhhdCB0aGUgcmVxdWVzdGVyJ3MgYWRtaW5zaGlwIGhhcyBub3QgYmVlbiByZXZva2VkCiAgICAgICAgcmVxdWlyZShvcC5kZWZlckJsb2NrIDw9IGJsb2NrLm51bWJlcik7IC8vY2hlY2tzIHRoYXQgZW5vdWdoIHRpbWUgaGFzIGVsYXBzZWQKICAgICAgICBhZGRyZXNzIHRvID0gb3AudG87CiAgICAgICAgdWludDI1NiBhbW91bnQgPSBvcC5hbW91bnQ7CiAgICAgICAgZGVsZXRlIG1pbnRPcGVyYXRpb25zW2luZGV4XTsKICAgICAgICBjaGlsZC5taW50KHRvLCBhbW91bnQpOwogICAgfQoKICAgIC8vIGFmdGVyIGEgZGF5LCBhZG1pbiBmaW5hbGl6ZXMgdGhlIG93bmVyc2hpcCBjaGFuZ2UKICAgIGZ1bmN0aW9uIGZpbmFsaXplVHJhbnNmZXJDaGlsZHJlbk93bmVyc2hpcCgpIHB1YmxpYyBvbmx5QWRtaW5Pck93bmVyIHsKICAgICAgICByZXF1aXJlKHRyYW5zZmVyT3duZXJzaGlwT3BlcmF0aW9uLmFkbWluID09IGFkbWluKTsKICAgICAgICByZXF1aXJlKHRyYW5zZmVyT3duZXJzaGlwT3BlcmF0aW9uLmRlZmVyQmxvY2sgPD0gYmxvY2subnVtYmVyKTsKICAgICAgICBhZGRyZXNzIG5ld093bmVyID0gdHJhbnNmZXJPd25lcnNoaXBPcGVyYXRpb24ubmV3T3duZXI7CiAgICAgICAgZGVsZXRlIHRyYW5zZmVyT3duZXJzaGlwT3BlcmF0aW9uOwogICAgICAgIGNoaWxkLnRyYW5zZmVyT3duZXJzaGlwKG5ld093bmVyKTsKICAgICAgICBjYW5CdXJuV2hpdGVMaXN0LnRyYW5zZmVyT3duZXJzaGlwKG5ld093bmVyKTsKICAgICAgICBjYW5SZWNlaXZlTWludFdoaXRlbGlzdC50cmFuc2Zlck93bmVyc2hpcChuZXdPd25lcik7CiAgICAgICAgYmxhY2tMaXN0LnRyYW5zZmVyT3duZXJzaGlwKG5ld093bmVyKTsKICAgIH0KCiAgICAvLyBhZnRlciBhIGRheSwgYWRtaW4gZmluYWxpemVzIHRoZSBidXJuIGJvdW5kcyBjaGFuZ2UKICAgIGZ1bmN0aW9uIGZpbmFsaXplQ2hhbmdlQnVybkJvdW5kcygpIHB1YmxpYyBvbmx5QWRtaW5Pck93bmVyIHsKICAgICAgICByZXF1aXJlKGNoYW5nZUJ1cm5Cb3VuZHNPcGVyYXRpb24uYWRtaW4gPT0gYWRtaW4pOwogICAgICAgIHJlcXVpcmUoY2hhbmdlQnVybkJvdW5kc09wZXJhdGlvbi5kZWZlckJsb2NrIDw9IGJsb2NrLm51bWJlcik7CiAgICAgICAgdWludCBuZXdNaW4gPSBjaGFuZ2VCdXJuQm91bmRzT3BlcmF0aW9uLm5ld01pbjsKICAgICAgICB1aW50IG5ld01heCA9IGNoYW5nZUJ1cm5Cb3VuZHNPcGVyYXRpb24ubmV3TWF4OwogICAgICAgIGRlbGV0ZSBjaGFuZ2VCdXJuQm91bmRzT3BlcmF0aW9uOwogICAgICAgIGNoaWxkLmNoYW5nZUJ1cm5Cb3VuZHMobmV3TWluLCBuZXdNYXgpOwogICAgfQoKICAgIC8vIGFmdGVyIGEgZGF5LCBhZG1pbiBmaW5hbGl6ZXMgdGhlIGluc3VyYW5jZSBmZWUgY2hhbmdlCiAgICBmdW5jdGlvbiBmaW5hbGl6ZUNoYW5nZUluc3VyYW5jZUZlZXMoKSBwdWJsaWMgb25seUFkbWluT3JPd25lciB7CiAgICAgICAgcmVxdWlyZShjaGFuZ2VJbnN1cmFuY2VGZWVzT3BlcmF0aW9uLmFkbWluID09IGFkbWluKTsKICAgICAgICByZXF1aXJlKGNoYW5nZUluc3VyYW5jZUZlZXNPcGVyYXRpb24uZGVmZXJCbG9jayA8PSBibG9jay5udW1iZXIpOwogICAgICAgIHVpbnQ4MCBfdHJhbnNmZXJGZWVOdW1lcmF0b3IgPSBjaGFuZ2VJbnN1cmFuY2VGZWVzT3BlcmF0aW9uLl90cmFuc2ZlckZlZU51bWVyYXRvcjsKICAgICAgICB1aW50ODAgX3RyYW5zZmVyRmVlRGVub21pbmF0b3IgPSBjaGFuZ2VJbnN1cmFuY2VGZWVzT3BlcmF0aW9uLl90cmFuc2ZlckZlZURlbm9taW5hdG9yOwogICAgICAgIHVpbnQ4MCBfbWludEZlZU51bWVyYXRvciA9IGNoYW5nZUluc3VyYW5jZUZlZXNPcGVyYXRpb24uX21pbnRGZWVOdW1lcmF0b3I7CiAgICAgICAgdWludDgwIF9taW50RmVlRGVub21pbmF0b3IgPSBjaGFuZ2VJbnN1cmFuY2VGZWVzT3BlcmF0aW9uLl9taW50RmVlRGVub21pbmF0b3I7CiAgICAgICAgdWludDI1NiBfbWludEZlZUZsYXQgPSBjaGFuZ2VJbnN1cmFuY2VGZWVzT3BlcmF0aW9uLl9taW50RmVlRmxhdDsKICAgICAgICB1aW50ODAgX2J1cm5GZWVOdW1lcmF0b3IgPSBjaGFuZ2VJbnN1cmFuY2VGZWVzT3BlcmF0aW9uLl9idXJuRmVlTnVtZXJhdG9yOwogICAgICAgIHVpbnQ4MCBfYnVybkZlZURlbm9taW5hdG9yID0gY2hhbmdlSW5zdXJhbmNlRmVlc09wZXJhdGlvbi5fYnVybkZlZURlbm9taW5hdG9yOwogICAgICAgIHVpbnQyNTYgX2J1cm5GZWVGbGF0ID0gY2hhbmdlSW5zdXJhbmNlRmVlc09wZXJhdGlvbi5fYnVybkZlZUZsYXQ7CiAgICAgICAgZGVsZXRlIGNoYW5nZUluc3VyYW5jZUZlZXNPcGVyYXRpb247CiAgICAgICAgY2hpbGQuY2hhbmdlSW5zdXJhbmNlRmVlcyhfdHJhbnNmZXJGZWVOdW1lcmF0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdHJhbnNmZXJGZWVEZW5vbWluYXRvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9taW50RmVlTnVtZXJhdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX21pbnRGZWVEZW5vbWluYXRvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9taW50RmVlRmxhdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9idXJuRmVlTnVtZXJhdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2J1cm5GZWVEZW5vbWluYXRvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9idXJuRmVlRmxhdCk7CiAgICB9CgogICAgLy8gYWZ0ZXIgYSBkYXksIGFkbWluIGZpbmFsaXplcyB0aGUgaW5zdXJhbmNlIGZlZXMgcmVjaXBpZW50IGNoYW5nZQogICAgZnVuY3Rpb24gZmluYWxpemVDaGFuZ2VJbnN1cmVyKCkgcHVibGljIG9ubHlBZG1pbk9yT3duZXIgewogICAgICAgIHJlcXVpcmUoY2hhbmdlSW5zdXJlck9wZXJhdGlvbi5hZG1pbiA9PSBhZG1pbik7CiAgICAgICAgcmVxdWlyZShjaGFuZ2VJbnN1cmVyT3BlcmF0aW9uLmRlZmVyQmxvY2sgPD0gYmxvY2subnVtYmVyKTsKICAgICAgICBhZGRyZXNzIG5ld0luc3VyZXIgPSBjaGFuZ2VJbnN1cmVyT3BlcmF0aW9uLm5ld0luc3VyZXI7CiAgICAgICAgZGVsZXRlIGNoYW5nZUluc3VyZXJPcGVyYXRpb247CiAgICAgICAgY2hpbGQuY2hhbmdlSW5zdXJlcihuZXdJbnN1cmVyKTsKICAgIH0KCiAgICAvLyBPd25lciBvZiB0aGlzIGNvbnRyYWN0IChpbW1lZGlhdGVseSkgcmVwbGFjZXMgdGhlIGN1cnJlbnQgYWRtaW4gd2l0aCBuZXdBZG1pbgogICAgZnVuY3Rpb24gdHJhbnNmZXJBZG1pbnNoaXAoYWRkcmVzcyBuZXdBZG1pbikgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgQWRtaW5zaGlwVHJhbnNmZXJyZWQoYWRtaW4sIG5ld0FkbWluKTsKICAgICAgICBhZG1pbiA9IG5ld0FkbWluOwogICAgfQoKICAgIC8vIGFkbWluIChpbW1lZGlhdGVseSkgdXBkYXRlcyBhIHdoaXRlbGlzdC9ibGFja2xpc3QKICAgIGZ1bmN0aW9uIHVwZGF0ZUxpc3QoYWRkcmVzcyBsaXN0LCBhZGRyZXNzIGVudHJ5LCBib29sIGZsYWcpIHB1YmxpYyBvbmx5QWRtaW5Pck93bmVyIHsKICAgICAgICBBZGRyZXNzTGlzdChsaXN0KS5jaGFuZ2VMaXN0KGVudHJ5LCBmbGFnKTsKICAgIH0KCiAgICBmdW5jdGlvbiBpc3N1ZUNsYWltT3duZXJzaGlwKGFkZHJlc3MgX290aGVyKSBwdWJsaWMgb25seUFkbWluT3JPd25lciB7CiAgICAgICAgQ2xhaW1hYmxlIG90aGVyID0gQ2xhaW1hYmxlKF9vdGhlcik7CiAgICAgICAgb3RoZXIuY2xhaW1Pd25lcnNoaXAoKTsKICAgIH0KfQoKY29udHJhY3QgTm9Pd25lciBpcyBIYXNOb0V0aGVyLCBIYXNOb1Rva2VucywgSGFzTm9Db250cmFjdHMgewp9Cgpjb250cmFjdCBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9Cgpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogIHVpbnQyNTYgdG90YWxTdXBwbHlfOwoKICAvKioKICAqIEBkZXYgdG90YWwgbnVtYmVyIG9mIHRva2VucyBpbiBleGlzdGVuY2UKICAqLwogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIHRvdGFsU3VwcGx5XzsKICB9CgogIC8qKgogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCmNvbnRyYWN0IEJ1cm5hYmxlVG9rZW4gaXMgQmFzaWNUb2tlbiB7CgogIGV2ZW50IEJ1cm4oYWRkcmVzcyBpbmRleGVkIGJ1cm5lciwgdWludDI1NiB2YWx1ZSk7CgogIC8qKgogICAqIEBkZXYgQnVybnMgYSBzcGVjaWZpYyBhbW91bnQgb2YgdG9rZW5zLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbiB0byBiZSBidXJuZWQuCiAgICovCiAgZnVuY3Rpb24gYnVybih1aW50MjU2IF92YWx1ZSkgcHVibGljIHsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKICAgIC8vIG5vIG5lZWQgdG8gcmVxdWlyZSB2YWx1ZSA8PSB0b3RhbFN1cHBseSwgc2luY2UgdGhhdCB3b3VsZCBpbXBseSB0aGUKICAgIC8vIHNlbmRlcidzIGJhbGFuY2UgaXMgZ3JlYXRlciB0aGFuIHRoZSB0b3RhbFN1cHBseSwgd2hpY2ggKnNob3VsZCogYmUgYW4gYXNzZXJ0aW9uIGZhaWx1cmUKCiAgICBhZGRyZXNzIGJ1cm5lciA9IG1zZy5zZW5kZXI7CiAgICBiYWxhbmNlc1tidXJuZXJdID0gYmFsYW5jZXNbYnVybmVyXS5zdWIoX3ZhbHVlKTsKICAgIHRvdGFsU3VwcGx5XyA9IHRvdGFsU3VwcGx5Xy5zdWIoX3ZhbHVlKTsKICAgIEJ1cm4oYnVybmVyLCBfdmFsdWUpOwogIH0KfQoKY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCmxpYnJhcnkgU2FmZUVSQzIwIHsKICBmdW5jdGlvbiBzYWZlVHJhbnNmZXIoRVJDMjBCYXNpYyB0b2tlbiwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgaW50ZXJuYWwgewogICAgYXNzZXJ0KHRva2VuLnRyYW5zZmVyKHRvLCB2YWx1ZSkpOwogIH0KCiAgZnVuY3Rpb24gc2FmZVRyYW5zZmVyRnJvbShFUkMyMCB0b2tlbiwgYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBpbnRlcm5hbCB7CiAgICBhc3NlcnQodG9rZW4udHJhbnNmZXJGcm9tKGZyb20sIHRvLCB2YWx1ZSkpOwogIH0KCiAgZnVuY3Rpb24gc2FmZUFwcHJvdmUoRVJDMjAgdG9rZW4sIGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgaW50ZXJuYWwgewogICAgYXNzZXJ0KHRva2VuLmFwcHJvdmUoc3BlbmRlciwgdmFsdWUpKTsKICB9Cn0KCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CgoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBAZGV2IEluY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX2FkZGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gaW5jcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IERlY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBkZWNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3N1YnRyYWN0ZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBkZWNyZWFzZSB0aGUgYWxsb3dhbmNlIGJ5LgogICAqLwogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9Cgpjb250cmFjdCBQYXVzYWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIFBhdXNhYmxlIHsKCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLmFwcHJvdmUoX3NwZW5kZXIsIF92YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgcmV0dXJuIHN1cGVyLmluY3JlYXNlQXBwcm92YWwoX3NwZW5kZXIsIF9hZGRlZFZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJldHVybiBzdXBlci5kZWNyZWFzZUFwcHJvdmFsKF9zcGVuZGVyLCBfc3VidHJhY3RlZFZhbHVlKTsKICB9Cn0KCmNvbnRyYWN0IFRydWVVU0QgaXMgUGF1c2FibGVUb2tlbiwgQnVybmFibGVUb2tlbiwgTm9Pd25lciwgQ2xhaW1hYmxlIHsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJUcnVlVVNEIjsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIlRVU0QiOwogICAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CgogICAgQWRkcmVzc0xpc3QgcHVibGljIGNhblJlY2VpdmVNaW50V2hpdGVsaXN0OwogICAgQWRkcmVzc0xpc3QgcHVibGljIGNhbkJ1cm5XaGl0ZUxpc3Q7CiAgICBBZGRyZXNzTGlzdCBwdWJsaWMgYmxhY2tMaXN0OwogICAgdWludDI1NiBwdWJsaWMgYnVybk1pbiA9IDEwMDAwICogMTAqKnVpbnQyNTYoZGVjaW1hbHMpOwogICAgdWludDI1NiBwdWJsaWMgYnVybk1heCA9IDIwMDAwMDAwICogMTAqKnVpbnQyNTYoZGVjaW1hbHMpOwoKICAgIHVpbnQ4MCBwdWJsaWMgdHJhbnNmZXJGZWVOdW1lcmF0b3IgPSA3OwogICAgdWludDgwIHB1YmxpYyB0cmFuc2ZlckZlZURlbm9taW5hdG9yID0gMTAwMDA7CiAgICB1aW50ODAgcHVibGljIG1pbnRGZWVOdW1lcmF0b3IgPSAwOwogICAgdWludDgwIHB1YmxpYyBtaW50RmVlRGVub21pbmF0b3IgPSAxMDAwMDsKICAgIHVpbnQyNTYgcHVibGljIG1pbnRGZWVGbGF0ID0gMDsKICAgIHVpbnQ4MCBwdWJsaWMgYnVybkZlZU51bWVyYXRvciA9IDA7CiAgICB1aW50ODAgcHVibGljIGJ1cm5GZWVEZW5vbWluYXRvciA9IDEwMDAwOwogICAgdWludDI1NiBwdWJsaWMgYnVybkZlZUZsYXQgPSAwOwogICAgYWRkcmVzcyBwdWJsaWMgaW5zdXJlcjsKCiAgICBldmVudCBDaGFuZ2VCdXJuQm91bmRzRXZlbnQodWludDI1NiBuZXdNaW4sIHVpbnQyNTYgbmV3TWF4KTsKICAgIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGFtb3VudCk7CgogICAgZnVuY3Rpb24gVHJ1ZVVTRChhZGRyZXNzIF9jYW5NaW50V2hpdGVMaXN0LCBhZGRyZXNzIF9jYW5CdXJuV2hpdGVMaXN0LCBhZGRyZXNzIF9ibGFja0xpc3QpIHB1YmxpYyB7CiAgICAgICAgdG90YWxTdXBwbHlfID0gMDsKICAgICAgICBjYW5SZWNlaXZlTWludFdoaXRlbGlzdCA9IEFkZHJlc3NMaXN0KF9jYW5NaW50V2hpdGVMaXN0KTsKICAgICAgICBjYW5CdXJuV2hpdGVMaXN0ID0gQWRkcmVzc0xpc3QoX2NhbkJ1cm5XaGl0ZUxpc3QpOwogICAgICAgIGJsYWNrTGlzdCA9IEFkZHJlc3NMaXN0KF9ibGFja0xpc3QpOwogICAgICAgIGluc3VyZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIC8vQnVybmluZyBmdW5jdGlvbnMgYXMgd2l0aGRyYXdpbmcgbW9uZXkgZnJvbSB0aGUgc3lzdGVtLiBUaGUgcGxhdGZvcm0gd2lsbCBrZWVwIHRyYWNrIG9mIHdobyBidXJucyBjb2lucywKICAgIC8vYW5kIHdpbGwgc2VuZCB0aGVtIGJhY2sgdGhlIGVxdWl2YWxlbnQgYW1vdW50IG9mIG1vbmV5IChyb3VuZGVkIGRvd24gdG8gdGhlIG5lYXJlc3QgY2VudCkuCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoY2FuQnVybldoaXRlTGlzdC5vbkxpc3QobXNnLnNlbmRlcikpOwogICAgICAgIHJlcXVpcmUoX3ZhbHVlID49IGJ1cm5NaW4pOwogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJ1cm5NYXgpOwogICAgICAgIHVpbnQyNTYgZmVlID0gcGF5SW5zdXJhbmNlRmVlKG1zZy5zZW5kZXIsIF92YWx1ZSwgYnVybkZlZU51bWVyYXRvciwgYnVybkZlZURlbm9taW5hdG9yLCBidXJuRmVlRmxhdCk7CiAgICAgICAgdWludDI1NiByZW1haW5pbmcgPSBfdmFsdWUuc3ViKGZlZSk7CiAgICAgICAgc3VwZXIuYnVybihyZW1haW5pbmcpOwogICAgfQoKICAgIC8vQ3JlYXRlIF9hbW91bnQgbmV3IHRva2VucyBhbmQgdHJhbnNmZXIgdGhlbSB0byBfdG8uCiAgICAvL0Jhc2VkIG9uIGNvZGUgYnkgT3BlblplcHBlbGluOiBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5L2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy90b2tlbi9NaW50YWJsZVRva2VuLnNvbAogICAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKGNhblJlY2VpdmVNaW50V2hpdGVsaXN0Lm9uTGlzdChfdG8pKTsKICAgICAgICB0b3RhbFN1cHBseV8gPSB0b3RhbFN1cHBseV8uYWRkKF9hbW91bnQpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfYW1vdW50KTsKICAgICAgICBNaW50KF90bywgX2Ftb3VudCk7CiAgICAgICAgVHJhbnNmZXIoYWRkcmVzcygwKSwgX3RvLCBfYW1vdW50KTsKICAgICAgICBwYXlJbnN1cmFuY2VGZWUoX3RvLCBfYW1vdW50LCBtaW50RmVlTnVtZXJhdG9yLCBtaW50RmVlRGVub21pbmF0b3IsIG1pbnRGZWVGbGF0KTsKICAgIH0KCiAgICAvL0NoYW5nZSB0aGUgbWluaW11bSBhbmQgbWF4aW11bSBhbW91bnQgdGhhdCBjYW4gYmUgYnVybmVkIGF0IG9uY2UuIEJ1cm5pbmcKICAgIC8vbWF5IGJlIGRpc2FibGVkIGJ5IHNldHRpbmcgYm90aCB0byAwICh0aGlzIHdpbGwgbm90IGJlIGRvbmUgdW5kZXIgbm9ybWFsCiAgICAvL29wZXJhdGlvbiwgYnV0IHdlIGNhbid0IGFkZCBjaGVja3MgdG8gZGlzYWxsb3cgaXQgd2l0aG91dCBsb3NpbmcgYSBsb3Qgb2YKICAgIC8vZmxleGliaWxpdHkgc2luY2UgYnVybmluZyBjb3VsZCBhbHNvIGJlIGFzIGdvb2QgYXMgZGlzYWJsZWQKICAgIC8vYnkgc2V0dGluZyB0aGUgbWluaW11bSBleHRyZW1lbHkgaGlnaCwgYW5kIHdlIGRvbid0IHdhbnQgdG8gbG9jawogICAgLy9pbiBhbnkgcGFydGljdWxhciBjYXAgZm9yIHRoZSBtaW5pbXVtKQogICAgZnVuY3Rpb24gY2hhbmdlQnVybkJvdW5kcyh1aW50IG5ld01pbiwgdWludCBuZXdNYXgpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUobmV3TWluIDw9IG5ld01heCk7CiAgICAgICAgYnVybk1pbiA9IG5ld01pbjsKICAgICAgICBidXJuTWF4ID0gbmV3TWF4OwogICAgICAgIENoYW5nZUJ1cm5Cb3VuZHNFdmVudChuZXdNaW4sIG5ld01heCk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKCFibGFja0xpc3Qub25MaXN0KG1zZy5zZW5kZXIpKTsKICAgICAgICByZXF1aXJlKCFibGFja0xpc3Qub25MaXN0KHRvKSk7CiAgICAgICAgYm9vbCByZXN1bHQgPSBzdXBlci50cmFuc2Zlcih0bywgdmFsdWUpOwogICAgICAgIHBheUluc3VyYW5jZUZlZSh0bywgdmFsdWUsIHRyYW5zZmVyRmVlTnVtZXJhdG9yLCB0cmFuc2ZlckZlZURlbm9taW5hdG9yLCAwKTsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZSghYmxhY2tMaXN0Lm9uTGlzdChmcm9tKSk7CiAgICAgICAgcmVxdWlyZSghYmxhY2tMaXN0Lm9uTGlzdCh0bykpOwogICAgICAgIGJvb2wgcmVzdWx0ID0gc3VwZXIudHJhbnNmZXJGcm9tKGZyb20sIHRvLCB2YWx1ZSk7CiAgICAgICAgcGF5SW5zdXJhbmNlRmVlKHRvLCB2YWx1ZSwgdHJhbnNmZXJGZWVOdW1lcmF0b3IsIHRyYW5zZmVyRmVlRGVub21pbmF0b3IsIDApOwogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogICAgZnVuY3Rpb24gcGF5SW5zdXJhbmNlRmVlKGFkZHJlc3MgcGF5ZXIsIHVpbnQyNTYgdmFsdWUsIHVpbnQ4MCBudW1lcmF0b3IsIHVpbnQ4MCBkZW5vbWluYXRvciwgdWludDI1NiBmbGF0UmF0ZSkgcHJpdmF0ZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBpbnN1cmFuY2VGZWUgPSB2YWx1ZS5tdWwobnVtZXJhdG9yKS5kaXYoZGVub21pbmF0b3IpLmFkZChmbGF0UmF0ZSk7CiAgICAgICAgaWYgKGluc3VyYW5jZUZlZSA+IDApIHsKICAgICAgICAgICAgdHJhbnNmZXJGcm9tV2l0aG91dEFsbG93YW5jZShwYXllciwgaW5zdXJlciwgaW5zdXJhbmNlRmVlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGluc3VyYW5jZUZlZTsKICAgIH0KCiAgICAvLyBiYXNlZCBvbiAndHJhbnNmZXInIGluIGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvYmxvYi9tYXN0ZXIvY29udHJhY3RzL3Rva2VuL0VSQzIwL0Jhc2ljVG9rZW4uc29sCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb21XaXRob3V0QWxsb3dhbmNlKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwcml2YXRlIHsKICAgICAgICBhc3NlcnQoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIGFzc2VydChfdmFsdWUgPD0gYmFsYW5jZXNbZnJvbV0pOwogICAgICAgIGJhbGFuY2VzW2Zyb21dID0gYmFsYW5jZXNbZnJvbV0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIoZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYW5nZUluc3VyYW5jZUZlZXModWludDgwIF90cmFuc2ZlckZlZU51bWVyYXRvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDgwIF90cmFuc2ZlckZlZURlbm9taW5hdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50ODAgX21pbnRGZWVOdW1lcmF0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ4MCBfbWludEZlZURlbm9taW5hdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MjU2IF9taW50RmVlRmxhdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDgwIF9idXJuRmVlTnVtZXJhdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50ODAgX2J1cm5GZWVEZW5vbWluYXRvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDI1NiBfYnVybkZlZUZsYXQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoX3RyYW5zZmVyRmVlRGVub21pbmF0b3IgIT0gMCk7CiAgICAgICAgcmVxdWlyZShfbWludEZlZURlbm9taW5hdG9yICE9IDApOwogICAgICAgIHJlcXVpcmUoX2J1cm5GZWVEZW5vbWluYXRvciAhPSAwKTsKICAgICAgICB0cmFuc2ZlckZlZU51bWVyYXRvciA9IF90cmFuc2ZlckZlZU51bWVyYXRvcjsKICAgICAgICB0cmFuc2ZlckZlZURlbm9taW5hdG9yID0gX3RyYW5zZmVyRmVlRGVub21pbmF0b3I7CiAgICAgICAgbWludEZlZU51bWVyYXRvciA9IF9taW50RmVlTnVtZXJhdG9yOwogICAgICAgIG1pbnRGZWVEZW5vbWluYXRvciA9IF9taW50RmVlRGVub21pbmF0b3I7CiAgICAgICAgbWludEZlZUZsYXQgPSBfbWludEZlZUZsYXQ7CiAgICAgICAgYnVybkZlZU51bWVyYXRvciA9IF9idXJuRmVlTnVtZXJhdG9yOwogICAgICAgIGJ1cm5GZWVEZW5vbWluYXRvciA9IF9idXJuRmVlRGVub21pbmF0b3I7CiAgICAgICAgYnVybkZlZUZsYXQgPSBfYnVybkZlZUZsYXQ7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlSW5zdXJlcihhZGRyZXNzIG5ld0luc3VyZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUobmV3SW5zdXJlciAhPSBhZGRyZXNzKDApKTsKICAgICAgICBpbnN1cmVyID0gbmV3SW5zdXJlcjsKICAgIH0KfQ=='.
	

]
