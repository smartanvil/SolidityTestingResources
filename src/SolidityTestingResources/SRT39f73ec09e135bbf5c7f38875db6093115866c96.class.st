Class {
	#name : #SRT39f73ec09e135bbf5c7f38875db6093115866c96,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT39f73ec09e135bbf5c7f38875db6093115866c96 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMDsKCmNvbnRyYWN0IEVaVGFua3N7CiAgICAKICAgIC8vIFNUUlVDVFMgSEVSRQogICAgc3RydWN0IFRhbmtPYmplY3R7CiAgICAgICAgLy8gdHlwZSBvZiB0YW5rIAogICAgICAgIHVpbnQyNTYgdHlwZUlEOyAKCiAgICAgICAgLy8gdGFuayBxdWFsaXR5CiAgICAgICAgdWludDhbNF0gdXBncmFkZXM7CgogICAgICAgIGJvb2wgaW5CYXR0bGU7CiAgICAgICAgCiAgICAgICAgLy8gc3RhdHMKICAgICAgICBhZGRyZXNzIHRhbmtPd25lcjsKICAgICAgICB1aW50MjU2IGVhcm5pbmdzSW5kZXg7IAogICAgICAgIAogICAgICAgIC8vIGJ1eWluZyAmIHNlbGxpbmcgCiAgICAgICAgYm9vbCBpbkF1Y3Rpb247CiAgICAgICAgdWludDI1NiBjdXJyQXVjdGlvbjsKICAgIH0KCiAgICBzdHJ1Y3QgVGFua1R5cGV7CiAgICAgICAgdWludDI1NiBzdGFydFByaWNlOwogICAgICAgIHVpbnQyNTYgY3VyclByaWNlOwogICAgICAgIHVpbnQyNTYgZWFybmluZ3M7CgogICAgICAgIC8vIGJhdHRsZSBzdGF0cwogICAgICAgIHVpbnQzMiBiYXNlSGVhbHRoOwogICAgICAgIHVpbnQzMiBiYXNlQXR0YWNrOwogICAgICAgIHVpbnQzMiBiYXNlQXJtb3I7CiAgICAgICAgdWludDMyIGJhc2VTcGVlZDsKCiAgICAgICAgdWludDMyIG51bVRhbmtzOwogICAgfQogICAgCiAgICBzdHJ1Y3QgQXVjdGlvbk9iamVjdHsKICAgICAgICB1aW50IHRhbms7IC8vIHRhbmsgaWQKICAgICAgICB1aW50IHN0YXJ0UHJpY2U7CiAgICAgICAgdWludCBlbmRQcmljZTsKICAgICAgICB1aW50IHN0YXJ0VGltZTsKICAgICAgICB1aW50IGR1cmF0aW9uOwogICAgICAgIGJvb2wgYWxpdmU7CiAgICB9CiAgICAKICAgIC8vIEVWRU5UUyBIRVJFCiAgICBldmVudCBFdmVudFdpdGhkcmF3ICgKICAgICAgIGFkZHJlc3MgaW5kZXhlZCBwbGF5ZXIsCiAgICAgICB1aW50MjU2IGFtb3VudAogICAgKTsgCgogICAgZXZlbnQgRXZlbnRVcGdyYWRlVGFuayAoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIHBsYXllciwKICAgICAgICB1aW50MjU2IHRhbmtJRCwKICAgICAgICB1aW50OCB1cGdyYWRlQ2hvaWNlCiAgICApOyAKICAgIAogICAgZXZlbnQgRXZlbnRBdWN0aW9uICgKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgcGxheWVyLAogICAgICAgIHVpbnQyNTYgdGFua0lELAogICAgICAgIHVpbnQyNTYgc3RhcnRQcmljZSwKICAgICAgICB1aW50MjU2IGVuZFByaWNlLAogICAgICAgIHVpbnQyNTYgZHVyYXRpb24sCiAgICAgICAgdWludDI1NiBjdXJyZW50VGltZQogICAgKTsKICAgICAgICAKICAgIGV2ZW50IEV2ZW50Q2FuY2VsQXVjdGlvbiAoCiAgICAgICAgdWludDI1NiBpbmRleGVkIHRhbmtJRCwKICAgICAgICBhZGRyZXNzIG93bmVyCiAgICApOyAKICAgIAogICAgZXZlbnQgRXZlbnRCaWQgKAogICAgICAgIHVpbnQyNTYgaW5kZXhlZCB0YW5rSUQsCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIGJ1eWVyCiAgICApOyAKICAgIAogICAgZXZlbnQgRXZlbnRCdXlUYW5rICgKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgcGxheWVyLAogICAgICAgIHVpbnQyNTYgcHJvZHVjdElELAogICAgICAgIHVpbnQyNTYgdGFua0lELAogICAgICAgIHVpbnQyNTYgbmV3UHJpY2UKICAgICk7IAoKICAgIGV2ZW50IEV2ZW50Q2FzaE91dFRhbmsoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIHBsYXllciwKICAgICAgICB1aW50MjU2IGFtb3VudAogICAgKTsKCiAgICBldmVudCBFdmVudEpvaW5lZEJhdHRsZSgKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgcGxheWVyLAogICAgICAgIHVpbnQyNTYgaW5kZXhlZCB0YW5rSUQKICAgICk7CgogICAgZXZlbnQgRXZlbnRRdWl0QmF0dGxlKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBwbGF5ZXIsCiAgICAgICAgdWludDI1NiBpbmRleGVkIHRhbmtJRAogICAgKTsKICAgIAogICAgZXZlbnQgRXZlbnRCYXR0bGVPdmVyKCk7CiAgICAKICAgIC8vIEZJRUxEUyBIRVJFCiAgICAKICAgIC8vIGNvbnRyYWN0IGZpZWxkcyAKICAgIHVpbnQ4IGZlZUFtdCA9IDM7CiAgICB1aW50OCB0b3VybmFtZW50VGF4UmF0ZSA9IDU7CiAgICBhZGRyZXNzIG93bmVyOwoKCiAgICAvLyBiYXR0bGUhCiAgICB1aW50MjU2IHRvdXJuYW1lbnRBbXQgPSAwOwogICAgdWludDggdGVhbVNpemUgPSA1OwogICAgdWludDI1NiBiYXR0bGVGZWUgPSAxIGV0aGVyIC8gMTAwMDsKICAgIHVpbnQyNTZbXSBiYXR0bGVUZWFtczsKCiAgICAvLyB0YW5rIGZpZWxkcwogICAgdWludDI1NiBuZXdUeXBlSUQgPSAxOwogICAgdWludDI1NiBuZXdUYW5rSUQgPSAxOwogICAgdWludDI1NiBuZXdBdWN0aW9uSUQgPSAxOwogICAgCiAgICBtYXBwaW5nICh1aW50MjU2ID0+IFRhbmtUeXBlKSBiYXNlVGFua3M7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IFRhbmtPYmplY3QpIHRhbmtzOyAvL21hcHMgdGFua0lEIHRvIHRhbmtzCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTZbXSkgdXNlclRhbmtzOwogICAgbWFwcGluZyAodWludCA9PiBBdWN0aW9uT2JqZWN0KSBhdWN0aW9uczsgLy9tYXBzIGF1Y3Rpb25JRCB0byBhdWN0aW9uCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIGJhbGFuY2VzOyAKCiAgICAvLyBNT0RJRklFUlMgSEVSRQogICAgbW9kaWZpZXIgaXNPd25lciB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICAvLyBDVE9SCiAgICBmdW5jdGlvbiBFWlRhbmtzKCkgcHVibGljIHBheWFibGV7CiAgICAgICAgLy8gaW5pdCBvd25lcgogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgICAgICBiYWxhbmNlc1tvd25lcl0gKz0gbXNnLnZhbHVlOwoKICAgICAgICAvLyBiYXNpYyB0YW5rCiAgICAgICAgbmV3VGFua1R5cGUoMSBldGhlciAvIDgwLCAxIGV0aGVyIC8gMTAwMCwgMjUwMCwgNTAsIDQwLCAzKTsKCiAgICAgICAgLy8gYnVsa3kgdGFuawogICAgICAgIG5ld1RhbmtUeXBlKDEgZXRoZXIgLyA1MCwgMSBldGhlciAvIDEwMDAsIDU1MDAsIDUwLCA0MSwgMyk7CgogICAgICAgIC8vIHNwZWVkZXIgdGFuawogICAgICAgIG5ld1RhbmtUeXBlKDEgZXRoZXIgLyA1MCwgMSBldGhlciAvIDEwMDAsIDIwMDAsIDUwLCA0MCwgNSk7CgogICAgICAgIC8vIHBvd2VyZnVsIHRhbmsKICAgICAgICBuZXdUYW5rVHlwZSgxIGV0aGVyIC8gNTAsIDEgZXRoZXIgLyAxMDAwLCAzMDAwLCA1MywgMzksIDMpOwoKICAgICAgICAvLyBhcm1vciB0YW5rCiAgICAgICAgbmV3VGFua1R5cGUoMSBldGhlciAvIDUwLCAxIGV0aGVyIC8gMTAwMCwgNDAwMCwgNTEsIDQzLCAyKTsKCiAgICAgICAgLy8gYmV0dGVyIHRoYW4gYmFzaWMgdGFuawogICAgICAgIG5ld1RhbmtUeXBlKDEgZXRoZXIgLyA0MCwgMSBldGhlciAvIDIwMCwgMzAwMCwgNTIsIDQxLCA0KTsKICAgIH0KCiAgICAvLyBBRE1JTklTVFJBVElWRSBGVU5DVElPTlMKCiAgICBmdW5jdGlvbiBzZXROZXdPd25lcihhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgaXNPd25lcnsKICAgICAgICBvd25lciA9IG5ld093bmVyOwogICAgfQoKICAgIC8vIGNyZWF0ZSBhIG5ldyB0YW5rIHR5cGUgCiAgICBmdW5jdGlvbiBuZXdUYW5rVHlwZSAoIAogICAgICAgIHVpbnQyNTYgX3N0YXJ0UHJpY2UsCiAgICAgICAgdWludDI1NiBfZWFybmluZ3MsCiAgICAgICAgdWludDMyIF9iYXNlSGVhbHRoLAogICAgICAgIHVpbnQzMiBfYmFzZUF0dGFjaywKICAgICAgICB1aW50MzIgX2Jhc2VBcm1vciwKICAgICAgICB1aW50MzIgX2Jhc2VTcGVlZAogICAgKSBwdWJsaWMgaXNPd25lciB7CiAgICAgICAgYmFzZVRhbmtzW25ld1R5cGVJRCsrXSA9IFRhbmtUeXBlKHsKICAgICAgICAgICAgc3RhcnRQcmljZSA6IF9zdGFydFByaWNlLAogICAgICAgICAgICBjdXJyUHJpY2UgOiBfc3RhcnRQcmljZSwKICAgICAgICAgICAgZWFybmluZ3MgOiBfZWFybmluZ3MsCiAgICAgICAgICAgIGJhc2VBdHRhY2sgOiBfYmFzZUF0dGFjaywKICAgICAgICAgICAgYmFzZUFybW9yIDogX2Jhc2VBcm1vciwKICAgICAgICAgICAgYmFzZVNwZWVkIDogX2Jhc2VTcGVlZCwKICAgICAgICAgICAgYmFzZUhlYWx0aCA6IF9iYXNlSGVhbHRoLAogICAgICAgICAgICBudW1UYW5rcyA6IDAKICAgICAgICB9KTsKCiAgICB9CiAgICAKICAgIC8vIGZlZSBmcm9tIGF1Y3Rpb25pbmcKICAgIGZ1bmN0aW9uIGNoYW5nZUZlZUFtdCAodWludDggX2FtdCkgcHVibGljIGlzT3duZXIgewogICAgICAgIHJlcXVpcmUoX2FtdCA+IDAgJiYgX2FtdCA8IDEwMCk7CiAgICAgICAgZmVlQW10ID0gX2FtdDsKICAgIH0KCiAgICAvLyByYXRlIHRvIGZ1bmQgdG91cm5hbWVudAogICAgZnVuY3Rpb24gY2hhbmdlVG91cm5hbWVudFRheEFtdCAodWludDggX3JhdGUpIHB1YmxpYyBpc093bmVyIHsKICAgICAgICByZXF1aXJlKF9yYXRlID4gMCAmJiBfcmF0ZSA8IDEwMCk7CiAgICAgICAgdG91cm5hbWVudFRheFJhdGUgPSBfcmF0ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGFuZ2VUZWFtU2l6ZSh1aW50OCBfc2l6ZSkgcHVibGljIGlzT3duZXIgewogICAgICAgIHJlcXVpcmUoX3NpemUgPiAwKTsKICAgICAgICB0ZWFtU2l6ZSA9IF9zaXplOwogICAgfQoKICAgIC8vIGNvc3QgdG8gZW50ZXIgYmF0dGxlCiAgICBmdW5jdGlvbiBjaGFuZ2VCYXR0bGVGZWUodWludDI1NiBfZmVlKSBwdWJsaWMgaXNPd25lciB7CiAgICAgICAgcmVxdWlyZShfZmVlID4gMCk7CiAgICAgICAgYmF0dGxlRmVlID0gX2ZlZTsKICAgIH0KICAgIAogICAgLy8gSU5URVJOQUwgRlVOQ1RJT05TCgogICAgZnVuY3Rpb24gZGVsVGFua0Zyb21Vc2VyKGFkZHJlc3MgdXNlciwgdWludDI1NiB2YWx1ZSkgaW50ZXJuYWwgewogICAgICAgIHVpbnQgbCA9IHVzZXJUYW5rc1t1c2VyXS5sZW5ndGg7CgogICAgICAgIGZvcih1aW50IGk9MDsgaTxsOyBpKyspewogICAgICAgICAgICBpZih1c2VyVGFua3NbdXNlcl1baV0gPT0gdmFsdWUpewogICAgICAgICAgICAgICAgZGVsZXRlIHVzZXJUYW5rc1t1c2VyXVtpXTsKICAgICAgICAgICAgICAgIHVzZXJUYW5rc1t1c2VyXVtpXSA9IHVzZXJUYW5rc1t1c2VyXVtsLTFdOwogICAgICAgICAgICAgICAgdXNlclRhbmtzW3VzZXJdLmxlbmd0aCA9IGwtMTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvLyBVU0VSIEZVTkNUSU9OUwoKICAgIGZ1bmN0aW9uIHdpdGhkcmF3ICh1aW50MjU2IF9hbW91bnQpIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICAvLyB2YWxpZGl0eSBjaGVja3MKICAgICAgICByZXF1aXJlIChfYW1vdW50ID49IDApOyAKICAgICAgICByZXF1aXJlICh0aGlzLmJhbGFuY2UgPj0gX2Ftb3VudCk7IAogICAgICAgIHJlcXVpcmUgKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IF9hbW91bnQpOyAKICAgICAgICAKICAgICAgICAvLyByZXR1cm4gZXZlcnl0aGluZyBpcyB3aXRoZHJhd2luZyAwCiAgICAgICAgaWYgKF9hbW91bnQgPT0gMCl7CiAgICAgICAgICAgIF9hbW91bnQgPSBiYWxhbmNlc1ttc2cuc2VuZGVyXTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyLnNlbmQoX2Ftb3VudCkpOwogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdIC09IF9hbW91bnQ7IAogICAgICAgIAogICAgICAgIEV2ZW50V2l0aGRyYXcgKG1zZy5zZW5kZXIsIF9hbW91bnQpOwogICAgfQogICAgCiAgICAKICAgIGZ1bmN0aW9uIGF1Y3Rpb25UYW5rICh1aW50IF90YW5rSUQsIHVpbnQgX3N0YXJ0UHJpY2UsIHVpbnQgX2VuZFByaWNlLCB1aW50MjU2IF9kdXJhdGlvbikgcHVibGljIHsKICAgICAgICByZXF1aXJlIChfdGFua0lEID4gMCAmJiBfdGFua0lEIDwgbmV3VGFua0lEKTsKICAgICAgICByZXF1aXJlICh0YW5rc1tfdGFua0lEXS50YW5rT3duZXIgPT0gbXNnLnNlbmRlcik7CiAgICAgICAgcmVxdWlyZSAoIXRhbmtzW190YW5rSURdLmluQmF0dGxlKTsKICAgICAgICByZXF1aXJlICghdGFua3NbX3RhbmtJRF0uaW5BdWN0aW9uKTsKICAgICAgICByZXF1aXJlICh0YW5rc1tfdGFua0lEXS5jdXJyQXVjdGlvbiA9PSAwKTsKICAgICAgICByZXF1aXJlIChfc3RhcnRQcmljZSA+PSBfZW5kUHJpY2UpOwogICAgICAgIHJlcXVpcmUgKF9zdGFydFByaWNlID4gMCAmJiBfZW5kUHJpY2UgPj0gMCk7CiAgICAgICAgcmVxdWlyZSAoX2R1cmF0aW9uID4gMCk7CiAgICAgICAgCiAgICAgICAgYXVjdGlvbnNbbmV3QXVjdGlvbklEXSA9IEF1Y3Rpb25PYmplY3QoX3RhbmtJRCwgX3N0YXJ0UHJpY2UsIF9lbmRQcmljZSwgbm93LCBfZHVyYXRpb24sIHRydWUpOwogICAgICAgIHRhbmtzW190YW5rSURdLmluQXVjdGlvbiA9IHRydWU7CiAgICAgICAgdGFua3NbX3RhbmtJRF0uY3VyckF1Y3Rpb24gPSBuZXdBdWN0aW9uSUQ7CiAgICAgICAgCiAgICAgICAgbmV3QXVjdGlvbklEKys7CgogICAgICAgIEV2ZW50QXVjdGlvbiAobXNnLnNlbmRlciwgX3RhbmtJRCwgX3N0YXJ0UHJpY2UsIF9lbmRQcmljZSwgX2R1cmF0aW9uLCBub3cpOwogICAgfQogICAgCiAgICAvLyBidXkgdGFuayBmcm9tIGF1Y3Rpb24KICAgIGZ1bmN0aW9uIGJpZCAodWludDI1NiBfdGFua0lEKSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgLy8gdmFsaWRpdHkgY2hlY2tzCiAgICAgICAgcmVxdWlyZSAoX3RhbmtJRCA+IDAgJiYgX3RhbmtJRCA8IG5ld1RhbmtJRCk7IC8vIGNoZWNrIGlmIHRhbmsgaXMgdmFsaWQKICAgICAgICByZXF1aXJlICh0YW5rc1tfdGFua0lEXS5pbkF1Y3Rpb24gPT0gdHJ1ZSk7IC8vIGNoZWNrIGlmIHRhbmsgaXMgY3VycmVudGx5IGluIGF1Y3Rpb24KICAgICAgICAKICAgICAgICAKICAgICAgICB1aW50MjU2IGF1Y3Rpb25JRCA9IHRhbmtzW190YW5rSURdLmN1cnJBdWN0aW9uOwogICAgICAgIHVpbnQyNTYgY3VyclByaWNlID0gZ2V0Q3VyckF1Y3Rpb25QcmljZUF1Y3Rpb25JRChhdWN0aW9uSUQpOwogICAgICAgIAogICAgICAgIHJlcXVpcmUgKGN1cnJQcmljZSA+PSAwKTsgCiAgICAgICAgcmVxdWlyZSAobXNnLnZhbHVlID49IGN1cnJQcmljZSk7IAogICAgICAgIAogICAgICAgIGlmKG1zZy52YWx1ZSA+IGN1cnJQcmljZSl7CiAgICAgICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdICs9IChtc2cudmFsdWUgLSBjdXJyUHJpY2UpOwogICAgICAgIH0KCgogICAgICAgIC8vIGNhbGN1bGF0ZSBuZXcgYmFsYW5jZXMKICAgICAgICB1aW50MjU2IGZlZSA9IChjdXJyUHJpY2UqZmVlQW10KSAvIDEwMDsgCgogICAgICAgIC8vdXBkYXRlIHRvdXJuYW1lbnRBbXQKICAgICAgICB1aW50MjU2IHRvdXJuYW1lbnRUYXggPSAoZmVlKnRvdXJuYW1lbnRUYXhSYXRlKSAvIDEwMDsKICAgICAgICB0b3VybmFtZW50QW10ICs9IHRvdXJuYW1lbnRUYXg7CiAgICAKICAgICAgICBiYWxhbmNlc1t0YW5rc1tfdGFua0lEXS50YW5rT3duZXJdICs9IGN1cnJQcmljZSAtIGZlZTsKICAgICAgICBiYWxhbmNlc1tvd25lcl0gKz0gKGZlZSAtIHRvdXJuYW1lbnRUYXgpOyAKCiAgICAgICAgLy8gdXBkYXRlIG9iamVjdCBmaWVsZHMKICAgICAgICBhZGRyZXNzIGZvcm1lck93bmVyID0gdGFua3NbX3RhbmtJRF0udGFua093bmVyOwoKICAgICAgICB0YW5rc1tfdGFua0lEXS50YW5rT3duZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIHRhbmtzW190YW5rSURdLmluQXVjdGlvbiA9IGZhbHNlOyAKICAgICAgICBhdWN0aW9uc1t0YW5rc1tfdGFua0lEXS5jdXJyQXVjdGlvbl0uYWxpdmUgPSBmYWxzZTsgCiAgICAgICAgdGFua3NbX3RhbmtJRF0uY3VyckF1Y3Rpb24gPSAwOyAKCiAgICAgICAgLy8gdXBkYXRlIHVzZXJUYW5rcwogICAgICAgIHVzZXJUYW5rc1ttc2cuc2VuZGVyXS5wdXNoKF90YW5rSUQpOwogICAgICAgIGRlbFRhbmtGcm9tVXNlcihmb3JtZXJPd25lciwgX3RhbmtJRCk7CgogICAgICAgIEV2ZW50QmlkIChfdGFua0lELCBtc2cuc2VuZGVyKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gY2FuY2VsQXVjdGlvbiAodWludDI1NiBfdGFua0lEKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUgKF90YW5rSUQgPiAwICYmIF90YW5rSUQgPCBuZXdUYW5rSUQpOyAKICAgICAgICByZXF1aXJlICh0YW5rc1tfdGFua0lEXS5pbkF1Y3Rpb24pOyAKICAgICAgICByZXF1aXJlICh0YW5rc1tfdGFua0lEXS50YW5rT3duZXIgPT0gbXNnLnNlbmRlcik7IAogICAgICAgIAogICAgICAgIC8vIHVwZGF0ZSB0YW5rIG9iamVjdAogICAgICAgIHRhbmtzW190YW5rSURdLmluQXVjdGlvbiA9IGZhbHNlOyAKICAgICAgICBhdWN0aW9uc1t0YW5rc1tfdGFua0lEXS5jdXJyQXVjdGlvbl0uYWxpdmUgPSBmYWxzZTsgCiAgICAgICAgdGFua3NbX3RhbmtJRF0uY3VyckF1Y3Rpb24gPSAwOyAKCiAgICAgICAgRXZlbnRDYW5jZWxBdWN0aW9uIChfdGFua0lELCBtc2cuc2VuZGVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBidXlUYW5rICh1aW50MzIgX3R5cGVJRCkgcHVibGljIHBheWFibGUgewogICAgICAgIHJlcXVpcmUoX3R5cGVJRCA+IDAgJiYgX3R5cGVJRCA8IG5ld1R5cGVJRCk7CiAgICAgICAgcmVxdWlyZSAoYmFzZVRhbmtzW190eXBlSURdLmN1cnJQcmljZSA+IDAgJiYgbXNnLnZhbHVlID4gMCk7IAogICAgICAgIHJlcXVpcmUgKG1zZy52YWx1ZSA+PSBiYXNlVGFua3NbX3R5cGVJRF0uY3VyclByaWNlKTsgCiAgICAgICAgCiAgICAgICAgaWYgKG1zZy52YWx1ZSA+IGJhc2VUYW5rc1tfdHlwZUlEXS5jdXJyUHJpY2UpewogICAgICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSArPSBtc2cudmFsdWUgLSBiYXNlVGFua3NbX3R5cGVJRF0uY3VyclByaWNlOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBiYXNlVGFua3NbX3R5cGVJRF0uY3VyclByaWNlICs9IGJhc2VUYW5rc1tfdHlwZUlEXS5lYXJuaW5nczsKICAgICAgICAKICAgICAgICB1aW50MjU2IGVhcm5pbmdzSW5kZXggPSBiYXNlVGFua3NbX3R5cGVJRF0ubnVtVGFua3MgKyAxOwogICAgICAgIGJhc2VUYW5rc1tfdHlwZUlEXS5udW1UYW5rcyArPSAxOwoKICAgICAgICB0YW5rc1tuZXdUYW5rSUQrK10gPSBUYW5rT2JqZWN0ICh7CiAgICAgICAgICAgIHR5cGVJRCA6IF90eXBlSUQsCiAgICAgICAgICAgIHVwZ3JhZGVzIDogWzAsMCwwLDBdLAogICAgICAgICAgICBpbkJhdHRsZSA6IGZhbHNlLAogICAgICAgICAgICB0YW5rT3duZXIgOiBtc2cuc2VuZGVyLAogICAgICAgICAgICBlYXJuaW5nc0luZGV4IDogZWFybmluZ3NJbmRleCwKICAgICAgICAgICAgaW5BdWN0aW9uIDogZmFsc2UsCiAgICAgICAgICAgIGN1cnJBdWN0aW9uIDogMAogICAgICAgIH0pOwoKICAgICAgICB1aW50MjU2IHByaWNlID0gYmFzZVRhbmtzW190eXBlSURdLnN0YXJ0UHJpY2U7CiAgICAgICAgdWludDI1NiB0b3VybmFtZW50UHJvY2VlZHMgPSAocHJpY2UgKiB0b3VybmFtZW50VGF4UmF0ZSkgLyAxMDA7CgogICAgICAgIGJhbGFuY2VzW293bmVyXSArPSBiYXNlVGFua3NbX3R5cGVJRF0uc3RhcnRQcmljZSAtIHRvdXJuYW1lbnRQcm9jZWVkczsKICAgICAgICB0b3VybmFtZW50QW10ICs9IHRvdXJuYW1lbnRQcm9jZWVkczsKCiAgICAgICAgdXNlclRhbmtzW21zZy5zZW5kZXJdLnB1c2gobmV3VGFua0lELTEpOwogICAgICAgIAogICAgICAgIEV2ZW50QnV5VGFuayAobXNnLnNlbmRlciwgX3R5cGVJRCwgbmV3VGFua0lELTEsIGJhc2VUYW5rc1tfdHlwZUlEXS5jdXJyUHJpY2UpOwogICAgfQoKICAgIC8vY2FzaGluZyBvdXQgdGhlIG1vbmV5IHRoYXQgYSB0YW5rIGhhcyBlYXJuZWQKICAgIGZ1bmN0aW9uIGNhc2hPdXRUYW5rICh1aW50MjU2IF90YW5rSUQpIHB1YmxpYyB7CiAgICAgICAgLy8gdmFsaWRpdHkgY2hlY2tzCiAgICAgICAgcmVxdWlyZSAoX3RhbmtJRCA+IDAgJiYgX3RhbmtJRCA8IG5ld1RhbmtJRCk7IAogICAgICAgIHJlcXVpcmUgKHRhbmtzW190YW5rSURdLnRhbmtPd25lciA9PSBtc2cuc2VuZGVyKTsKICAgICAgICByZXF1aXJlICghdGFua3NbX3RhbmtJRF0uaW5BdWN0aW9uICYmIHRhbmtzW190YW5rSURdLmN1cnJBdWN0aW9uID09IDApOwogICAgICAgIHJlcXVpcmUgKCF0YW5rc1tfdGFua0lEXS5pbkJhdHRsZSk7CgogICAgICAgIAogICAgICAgIHVpbnQyNTYgdGFua1R5cGUgPSB0YW5rc1tfdGFua0lEXS50eXBlSUQ7CiAgICAgICAgdWludDI1NiBudW1UYW5rcyA9IGJhc2VUYW5rc1t0YW5rVHlwZV0ubnVtVGFua3M7CgogICAgICAgIHVpbnQyNTYgYW1vdW50ID0gZ2V0Q2FzaE91dEFtb3VudChfdGFua0lEKTsKCiAgICAgICAgcmVxdWlyZSAodGhpcy5iYWxhbmNlID49IGFtb3VudCk7IAogICAgICAgIHJlcXVpcmUgKGFtb3VudCA+IDApOwogICAgICAgIAogICAgICAgIHJlcXVpcmUodGFua3NbX3RhbmtJRF0udGFua093bmVyLnNlbmQoYW1vdW50KSk7CiAgICAgICAgdGFua3NbX3RhbmtJRF0uZWFybmluZ3NJbmRleCA9IG51bVRhbmtzOwogICAgICAgIAogICAgICAgIEV2ZW50Q2FzaE91dFRhbmsgKG1zZy5zZW5kZXIsIGFtb3VudCk7CiAgICB9CiAgICAKICAgIC8vIDAgLT4gaGVhbHRoLCAxIC0+IGF0dGFjaywgMiAtPiBhcm1vciwgMyAtPiBzcGVlZAogICAgZnVuY3Rpb24gdXBncmFkZVRhbmsgKHVpbnQyNTYgX3RhbmtJRCwgdWludDggX3VwZ3JhZGVDaG9pY2UpIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICAvLyB2YWxpZGl0eSBjaGVja3MKICAgICAgICByZXF1aXJlIChfdGFua0lEID4gMCAmJiBfdGFua0lEIDwgbmV3VGFua0lEKTsgCiAgICAgICAgcmVxdWlyZSAodGFua3NbX3RhbmtJRF0udGFua093bmVyID09IG1zZy5zZW5kZXIpOyAKICAgICAgICByZXF1aXJlICghdGFua3NbX3RhbmtJRF0uaW5BdWN0aW9uKTsKICAgICAgICByZXF1aXJlICghdGFua3NbX3RhbmtJRF0uaW5CYXR0bGUpOwogICAgICAgIHJlcXVpcmUgKF91cGdyYWRlQ2hvaWNlID49IDAgJiYgX3VwZ3JhZGVDaG9pY2UgPCA0KTsgCiAgICAgICAgCiAgICAgICAgLy8gbm8gb3ZlcmZsb3chCiAgICAgICAgcmVxdWlyZSh0YW5rc1tfdGFua0lEXS51cGdyYWRlc1tfdXBncmFkZUNob2ljZV0gKyAxID4gdGFua3NbX3RhbmtJRF0udXBncmFkZXNbX3VwZ3JhZGVDaG9pY2VdKTsKCiAgICAgICAgdWludDI1NiB1cGdyYWRlUHJpY2UgPSBiYXNlVGFua3NbdGFua3NbX3RhbmtJRF0udHlwZUlEXS5zdGFydFByaWNlIC8gNDsKICAgICAgICByZXF1aXJlIChtc2cudmFsdWUgPj0gdXBncmFkZVByaWNlKTsgCgogICAgICAgIHRhbmtzW190YW5rSURdLnVwZ3JhZGVzW191cGdyYWRlQ2hvaWNlXSsrOyAKCiAgICAgICAgaWYobXNnLnZhbHVlID4gdXBncmFkZVByaWNlKXsKICAgICAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gKz0gbXNnLnZhbHVlLXVwZ3JhZGVQcmljZTsgCiAgICAgICAgfQoKICAgICAgICB1aW50MjU2IHRvdXJuYW1lbnRQcm9jZWVkcyA9ICh1cGdyYWRlUHJpY2UgKiB0b3VybmFtZW50VGF4UmF0ZSkgLyAxMDA7CgogICAgICAgIGJhbGFuY2VzW293bmVyXSArPSAodXBncmFkZVByaWNlIC0gdG91cm5hbWVudFByb2NlZWRzKTsgCiAgICAgICAgdG91cm5hbWVudEFtdCArPSB0b3VybmFtZW50UHJvY2VlZHM7CiAgICAgICAgCiAgICAgICAgRXZlbnRVcGdyYWRlVGFuayAobXNnLnNlbmRlciwgX3RhbmtJRCwgX3VwZ3JhZGVDaG9pY2UpOwogICAgfQoKICAgIGZ1bmN0aW9uIGJhdHRsZSh1aW50MjU2IF90YW5rSUQpIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKF90YW5rSUQgPjAgJiYgX3RhbmtJRCA8IG5ld1RhbmtJRCk7CiAgICAgICAgcmVxdWlyZSh0YW5rc1tfdGFua0lEXS50YW5rT3duZXIgPT0gbXNnLnNlbmRlcik7CiAgICAgICAgcmVxdWlyZSghdGFua3NbX3RhbmtJRF0uaW5BdWN0aW9uKTsKICAgICAgICByZXF1aXJlKCF0YW5rc1tfdGFua0lEXS5pbkJhdHRsZSk7CiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPj0gYmF0dGxlRmVlKTsKCiAgICAgICAgaWYobXNnLnZhbHVlID4gYmF0dGxlRmVlKXsKICAgICAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gKz0gKG1zZy52YWx1ZSAtIGJhdHRsZUZlZSk7CiAgICAgICAgfQoKICAgICAgICB0b3VybmFtZW50QW10ICs9IGJhdHRsZUZlZTsKICAgICAgICAKICAgICAgICBFdmVudEpvaW5lZEJhdHRsZShtc2cuc2VuZGVyLCBfdGFua0lEKTsKCiAgICAgICAgLy8gYWRkIHRvIHRlYW1zCiAgICAgICAgaWYoYmF0dGxlVGVhbXMubGVuZ3RoIDwgMip0ZWFtU2l6ZSAtIDEpewogICAgICAgICAgICBiYXR0bGVUZWFtcy5wdXNoKF90YW5rSUQpOwogICAgICAgICAgICB0YW5rc1tfdGFua0lEXS5pbkJhdHRsZSA9IHRydWU7CgogICAgICAgIC8vIHRpbWUgdG8gYmF0dGxlIQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGJhdHRsZVRlYW1zLnB1c2goX3RhbmtJRCk7CgogICAgICAgICAgICB1aW50MjU2WzRdIG1lbW9yeSB0ZWFtQTsKICAgICAgICAgICAgdWludDI1Nls0XSBtZW1vcnkgdGVhbUI7CiAgICAgICAgICAgIHVpbnQyNTZbNF0gbWVtb3J5IHRlbXA7CgogICAgICAgICAgICBmb3IodWludCBpPTA7IGk8dGVhbVNpemU7IGkrKyl7CiAgICAgICAgICAgICAgICB0ZW1wID0gZ2V0Q3VycmVudFN0YXRzKGJhdHRsZVRlYW1zW2ldKTsKICAgICAgICAgICAgICAgIHRlYW1BWzBdICs9IHRlbXBbMF07CiAgICAgICAgICAgICAgICB0ZWFtQVsxXSArPSB0ZW1wWzFdOwogICAgICAgICAgICAgICAgdGVhbUFbMl0gKz0gdGVtcFsyXTsKICAgICAgICAgICAgICAgIHRlYW1BWzNdICs9IHRlbXBbM107CgogICAgICAgICAgICAgICAgdGVtcCA9IGdldEN1cnJlbnRTdGF0cyhiYXR0bGVUZWFtc1t0ZWFtU2l6ZStpXSk7CiAgICAgICAgICAgICAgICB0ZWFtQlswXSArPSB0ZW1wWzBdOwogICAgICAgICAgICAgICAgdGVhbUJbMV0gKz0gdGVtcFsxXTsKICAgICAgICAgICAgICAgIHRlYW1CWzJdICs9IHRlbXBbMl07CiAgICAgICAgICAgICAgICB0ZWFtQlszXSArPSB0ZW1wWzNdOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBsb3dlciBzY29yZSBpcyBiZXR0ZXIKICAgICAgICAgICAgdWludDI1NiBkaWZmQSA9IHRlYW1BWzFdIC0gdGVhbUJbMl07CiAgICAgICAgICAgIHVpbnQyNTYgZGlmZkIgPSB0ZWFtQlsxXSAtIHRlYW1BWzJdOwogICAgICAgICAgICAKICAgICAgICAgICAgZGlmZkEgPSBkaWZmQSA+IDAgPyBkaWZmQSA6IDE7CiAgICAgICAgICAgIGRpZmZCID0gZGlmZkIgPiAwID8gZGlmZkIgOiAxOwoKICAgICAgICAgICAgdWludDI1NiB0ZWFtQVNjb3JlID0gdGVhbUJbMF0gLyAoZGlmZkEgKiB0ZWFtQVszXSk7CiAgICAgICAgICAgIHVpbnQyNTYgdGVhbUJTY29yZSA9IHRlYW1BWzBdIC8gKGRpZmZCICogdGVhbUJbM10pOwoKICAgICAgICAgICAgaWYoKHRlYW1CWzBdICUgKGRpZmZBICogdGVhbUFbM10pKSAhPSAwKSB7CiAgICAgICAgICAgICAgICB0ZWFtQVNjb3JlICs9IDE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKCh0ZWFtQVswXSAlIChkaWZmQiAqIHRlYW1CWzNdKSkgIT0gMCkgewogICAgICAgICAgICAgICAgdGVhbUJTY29yZSArPSAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICB1aW50MjU2IHRvRGlzdHJpYnV0ZSA9IHRvdXJuYW1lbnRBbXQgLyB0ZWFtU2l6ZTsKICAgICAgICAgICAgdG91cm5hbWVudEFtdCAtPSB0ZWFtU2l6ZSp0b0Rpc3RyaWJ1dGU7CgogICAgICAgICAgICBpZih0ZWFtQVNjb3JlIDw9IHRlYW1CU2NvcmUpewogICAgICAgICAgICAgICAgZm9yKGk9MDsgaTx0ZWFtU2l6ZTsgaSsrKXsKICAgICAgICAgICAgICAgICAgICBiYWxhbmNlc1t0YW5rc1tiYXR0bGVUZWFtc1tpXV0udGFua093bmVyXSArPSB0b0Rpc3RyaWJ1dGU7ICAgCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBmb3IoaT0wOyBpPHRlYW1TaXplOyBpKyspewogICAgICAgICAgICAgICAgICAgIGJhbGFuY2VzW3RhbmtzW2JhdHRsZVRlYW1zW3RlYW1TaXplK2ldXS50YW5rT3duZXJdICs9IHRvRGlzdHJpYnV0ZTsgICAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICB9CgogICAgICAgICAgICBmb3IoaT0wOyBpPDIqdGVhbVNpemU7IGkrKyl7CiAgICAgICAgICAgICAgICB0YW5rc1tiYXR0bGVUZWFtc1tpXV0uaW5CYXR0bGUgPSBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgRXZlbnRCYXR0bGVPdmVyKCk7CgogICAgICAgICAgICBiYXR0bGVUZWFtcy5sZW5ndGggPSAwOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBxdWl0QmF0dGxlKHVpbnQyNTYgX3RhbmtJRCkgcHVibGljIHsKICAgICAgICByZXF1aXJlKF90YW5rSUQgPjAgJiYgX3RhbmtJRCA8IG5ld1RhbmtJRCk7CiAgICAgICAgcmVxdWlyZSh0YW5rc1tfdGFua0lEXS50YW5rT3duZXIgPT0gbXNnLnNlbmRlcik7CiAgICAgICAgcmVxdWlyZSh0YW5rc1tfdGFua0lEXS5pbkJhdHRsZSk7CiAgICAgICAgCiAgICAgICAgdWludCBsID0gYmF0dGxlVGVhbXMubGVuZ3RoOwoKICAgICAgICBmb3IodWludCBpPTA7IGk8bDsgaSsrKXsKICAgICAgICAgICAgaWYoYmF0dGxlVGVhbXNbaV0gPT0gX3RhbmtJRCl7CiAgICAgICAgICAgICAgICBFdmVudFF1aXRCYXR0bGUobXNnLnNlbmRlciwgX3RhbmtJRCk7CgogICAgICAgICAgICAgICAgZGVsZXRlIGJhdHRsZVRlYW1zW2ldOwogICAgICAgICAgICAgICAgYmF0dGxlVGVhbXNbaV0gPSBiYXR0bGVUZWFtc1tsLTFdOwogICAgICAgICAgICAgICAgYmF0dGxlVGVhbXMubGVuZ3RoID0gbC0xOwogICAgICAgICAgICAgICAgdGFua3NbX3RhbmtJRF0uaW5CYXR0bGUgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLy8gQ09OVkVOSUVOQ0UgR0VUVEVSIE1FVEhPRFMKICAgIAogICAgZnVuY3Rpb24gZ2V0Q3VyckF1Y3Rpb25QcmljZVRhbmtJRCAodWludDI1NiBfdGFua0lEKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBwcmljZSl7CiAgICAgICAgcmVxdWlyZSAodGFua3NbX3RhbmtJRF0uaW5BdWN0aW9uKTsKICAgICAgICB1aW50MjU2IGF1Y3Rpb25JRCA9IHRhbmtzW190YW5rSURdLmN1cnJBdWN0aW9uOwoKICAgICAgICByZXR1cm4gZ2V0Q3VyckF1Y3Rpb25QcmljZUF1Y3Rpb25JRChhdWN0aW9uSUQpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRQbGF5ZXJCYWxhbmNlKGFkZHJlc3MgX3BsYXllcklEKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKXsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX3BsYXllcklEXTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0Q29udHJhY3RCYWxhbmNlKCkgcHVibGljIGNvbnN0YW50IGlzT3duZXIgcmV0dXJucyAodWludDI1Nil7CiAgICAgICAgcmV0dXJuIHRoaXMuYmFsYW5jZTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRUYW5rT3duZXIodWludDI1NiBfdGFua0lEKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcykgewogICAgICAgIHJlcXVpcmUoX3RhbmtJRCA+IDAgJiYgX3RhbmtJRCA8IG5ld1RhbmtJRCk7CiAgICAgICAgcmV0dXJuIHRhbmtzW190YW5rSURdLnRhbmtPd25lcjsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRPd25lZFRhbmtzKGFkZHJlc3MgX2FkZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTZbXSl7CiAgICAgICAgcmV0dXJuIHVzZXJUYW5rc1tfYWRkXTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRUYW5rVHlwZSh1aW50MjU2IF90YW5rSUQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmVxdWlyZShfdGFua0lEID4gMCAmJiBfdGFua0lEIDwgbmV3VGFua0lEKTsKICAgICAgICByZXR1cm4gdGFua3NbX3RhbmtJRF0udHlwZUlEOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEN1cnJUeXBlUHJpY2UodWludDI1NiBfdHlwZUlEKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJlcXVpcmUoX3R5cGVJRCA+IDAgJiYgX3R5cGVJRCA8IG5ld1R5cGVJRCk7CiAgICAgICAgcmV0dXJuIGJhc2VUYW5rc1tfdHlwZUlEXS5jdXJyUHJpY2U7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0TnVtVGFua3NUeXBlKHVpbnQyNTYgX3R5cGVJRCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXF1aXJlKF90eXBlSUQgPiAwICYmIF90eXBlSUQgPCBuZXdUeXBlSUQpOwogICAgICAgIHJldHVybiBiYXNlVGFua3NbX3R5cGVJRF0ubnVtVGFua3M7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldE51bVRhbmtzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludDI1Nil7CiAgICAgICAgcmV0dXJuIG5ld1RhbmtJRC0xOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoZWNrVGFua0F1Y3Rpb24odWludDI1NiBfdGFua0lEKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoMCA8IF90YW5rSUQgJiYgX3RhbmtJRCA8IG5ld1RhbmtJRCk7CiAgICAgICAgcmV0dXJuIHRhbmtzW190YW5rSURdLmluQXVjdGlvbjsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRDdXJyQXVjdGlvblByaWNlQXVjdGlvbklEKHVpbnQyNTYgX2F1Y3Rpb25JRCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpewogICAgICAgIHJlcXVpcmUoX2F1Y3Rpb25JRCA+IDAgJiYgX2F1Y3Rpb25JRCA8IG5ld0F1Y3Rpb25JRCk7CgogICAgICAgIEF1Y3Rpb25PYmplY3QgbWVtb3J5IGN1cnJBdWN0aW9uID0gYXVjdGlvbnNbX2F1Y3Rpb25JRF07CgogICAgICAgIC8vIGNhbGN1bGF0ZSB0aGUgY3VycmVudCBhdWN0aW9uIHByaWNlICAgICAgIAogICAgICAgIHVpbnQyNTYgY3VyclByaWNlID0gY3VyckF1Y3Rpb24uc3RhcnRQcmljZTsKICAgICAgICB1aW50MjU2IGRpZmYgPSAoKGN1cnJBdWN0aW9uLnN0YXJ0UHJpY2UtY3VyckF1Y3Rpb24uZW5kUHJpY2UpIC8gKGN1cnJBdWN0aW9uLmR1cmF0aW9uKSkgKiAobm93LWN1cnJBdWN0aW9uLnN0YXJ0VGltZSk7CgoKICAgICAgICBpZiAoY3VyclByaWNlLWRpZmYgPCBjdXJyQXVjdGlvbi5lbmRQcmljZSB8fCBkaWZmID4gY3VyclByaWNlKXsgCiAgICAgICAgICAgIGN1cnJQcmljZSA9IGN1cnJBdWN0aW9uLmVuZFByaWNlOyAgCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY3VyclByaWNlIC09IGRpZmY7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gY3VyclByaWNlOwogICAgfQoKICAgIC8vIHJldHVybnMgW3RhbmtJRCwgY3VyclByaWNlLCBhbGl2ZV0KICAgIGZ1bmN0aW9uIGdldEF1Y3Rpb24odWludDI1NiBfYXVjdGlvbklEKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NlszXSl7CiAgICAgICAgcmVxdWlyZShfYXVjdGlvbklEID4gMCAmJiBfYXVjdGlvbklEIDwgbmV3QXVjdGlvbklEKTsKCiAgICAgICAgdWludDI1NiB0YW5rSUQgPSBhdWN0aW9uc1tfYXVjdGlvbklEXS50YW5rOwogICAgICAgIHVpbnQyNTYgY3VyclByaWNlID0gZ2V0Q3VyckF1Y3Rpb25QcmljZUF1Y3Rpb25JRChfYXVjdGlvbklEKTsKICAgICAgICBib29sIGFsaXZlID0gYXVjdGlvbnNbX2F1Y3Rpb25JRF0uYWxpdmU7CgogICAgICAgIHVpbnQyNTZbM10gbWVtb3J5IG91dDsKICAgICAgICBvdXRbMF0gPSB0YW5rSUQ7CiAgICAgICAgb3V0WzFdID0gY3VyclByaWNlOwogICAgICAgIG91dFsyXSA9IGFsaXZlID8gMSA6IDA7CgogICAgICAgIHJldHVybiBvdXQ7CiAgICB9CiAKICAgIGZ1bmN0aW9uIGdldFVwZ3JhZGVQcmljZSh1aW50MjU2IF90YW5rSUQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmVxdWlyZShfdGFua0lEID4wICYmIF90YW5rSUQgPCBuZXdUYW5rSUQpOwogICAgICAgIHJldHVybiBiYXNlVGFua3NbdGFua3NbX3RhbmtJRF0udHlwZUlEXS5zdGFydFByaWNlIC8gNDsKICAgIH0KCiAgICAvLyBbaGVhbHRoLCBhdHRhY2ssIGFybW9yLCBzcGVlZF0KICAgIGZ1bmN0aW9uIGdldFVwZ3JhZGVBbXQodWludDI1NiBfdGFua0lEKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDhbNF0pIHsKICAgICAgICByZXF1aXJlKF90YW5rSUQgPiAwICYmIF90YW5rSUQgPCBuZXdUYW5rSUQpOwoKICAgICAgICByZXR1cm4gdGFua3NbX3RhbmtJRF0udXBncmFkZXM7CiAgICB9CgogICAgLy8gW2hlYWx0aCwgYXR0YWNrLCBhcm1vciwgc3BlZWRdCiAgICBmdW5jdGlvbiBnZXRDdXJyZW50U3RhdHModWludDI1NiBfdGFua0lEKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nls0XSkgewogICAgICAgIHJlcXVpcmUoX3RhbmtJRCA+IDAgJiYgX3RhbmtJRCA8IG5ld1RhbmtJRCk7CgogICAgICAgIFRhbmtUeXBlIG1lbW9yeSBiYXNlVHlwZSA9IGJhc2VUYW5rc1t0YW5rc1tfdGFua0lEXS50eXBlSURdOwogICAgICAgIHVpbnQ4WzRdIG1lbW9yeSB1cGdyYWRlcyA9IHRhbmtzW190YW5rSURdLnVwZ3JhZGVzOwogICAgICAgIHVpbnQyNTZbNF0gbWVtb3J5IG91dDsKCiAgICAgICAgb3V0WzBdID0gYmFzZVR5cGUuYmFzZUhlYWx0aCArICh1cGdyYWRlc1swXSAqIGJhc2VUeXBlLmJhc2VIZWFsdGggLyA0KTsKICAgICAgICBvdXRbMV0gPSBiYXNlVHlwZS5iYXNlQXR0YWNrICsgdXBncmFkZXNbMV07IAogICAgICAgIG91dFsyXSA9IGJhc2VUeXBlLmJhc2VBcm1vciArIHVwZ3JhZGVzWzJdOwogICAgICAgIG91dFszXSA9IGJhc2VUeXBlLmJhc2VTcGVlZCArIHVwZ3JhZGVzWzNdOwogICAgICAgIAogICAgICAgIHJldHVybiBvdXQ7CiAgICB9CgogICAgZnVuY3Rpb24gaW5CYXR0bGUodWludDI1NiBfdGFua0lEKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3RhbmtJRCA+IDAgJiYgX3RhbmtJRCA8IG5ld1RhbmtJRCk7CiAgICAgICAgcmV0dXJuIHRhbmtzW190YW5rSURdLmluQmF0dGxlOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEN1cnJUZWFtU2l6ZXMoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBiYXR0bGVUZWFtcy5sZW5ndGg7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QmF0dGxlVGVhbVNpemUoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gdGVhbVNpemU7CiAgICB9CgogICAgZnVuY3Rpb24gZG9uYXRlKCkgcHVibGljIHBheWFibGUgewogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID4gMCk7CiAgICAgICAgdG91cm5hbWVudEFtdCArPSBtc2cudmFsdWU7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0VG91cm5hbWVudEFtdCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHRvdXJuYW1lbnRBbXQ7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QmF0dGxlRmVlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpewogICAgICAgIHJldHVybiBiYXR0bGVGZWU7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0VG91cm5hbWVudFJhdGUoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDgpewogICAgICAgIHJldHVybiB0b3VybmFtZW50VGF4UmF0ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRDdXJyRmVlUmF0ZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50OCkgewogICAgICAgIHJldHVybiBmZWVBbXQ7CiAgICB9CiAgICAKICAgIC8vIFtzdGFydFByaWNlLCBjdXJyUHJpY2UsIGVhcm5pbmdzLCBiYXNlSGVhbHRoLCBiYXNlQXR0YWNrLCBiYXNlQXJtb3IsIGJhc2VTcGVlZCwgbnVtVGFua3NdIAogICAgZnVuY3Rpb24gZ2V0QmFzZVR5cGVTdGF0cyh1aW50MjU2IF90eXBlSUQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2WzhdKXsKICAgICAgICByZXF1aXJlKDAgPCBfdHlwZUlEICYmIF90eXBlSUQgPCBuZXdUeXBlSUQpOwogICAgICAgIHVpbnQyNTZbOF0gbWVtb3J5IG91dDsKCiAgICAgICAgb3V0WzBdID0gYmFzZVRhbmtzW190eXBlSURdLnN0YXJ0UHJpY2U7CiAgICAgICAgb3V0WzFdID0gYmFzZVRhbmtzW190eXBlSURdLmN1cnJQcmljZTsKICAgICAgICBvdXRbMl0gPSBiYXNlVGFua3NbX3R5cGVJRF0uZWFybmluZ3M7CiAgICAgICAgb3V0WzNdID0gYmFzZVRhbmtzW190eXBlSURdLmJhc2VIZWFsdGg7CiAgICAgICAgb3V0WzRdID0gYmFzZVRhbmtzW190eXBlSURdLmJhc2VBdHRhY2s7CiAgICAgICAgb3V0WzVdID0gYmFzZVRhbmtzW190eXBlSURdLmJhc2VBcm1vcjsKICAgICAgICBvdXRbNl0gPSBiYXNlVGFua3NbX3R5cGVJRF0uYmFzZVNwZWVkOwogICAgICAgIG91dFs3XSA9IGJhc2VUYW5rc1tfdHlwZUlEXS5udW1UYW5rczsKCiAgICAgICAgcmV0dXJuIG91dDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRDYXNoT3V0QW1vdW50KHVpbnQyNTYgX3RhbmtJRCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXF1aXJlKDAgPCBfdGFua0lEICYmIF90YW5rSUQgPCBuZXdUYW5rSUQpOwoKICAgICAgICB1aW50MjU2IHRhbmtUeXBlID0gdGFua3NbX3RhbmtJRF0udHlwZUlEOwogICAgICAgIHVpbnQyNTYgZWFybmluZ3MgPSBiYXNlVGFua3NbdGFua1R5cGVdLmVhcm5pbmdzOwogICAgICAgIHVpbnQyNTYgZWFybmluZ3NJbmRleCA9IHRhbmtzW190YW5rSURdLmVhcm5pbmdzSW5kZXg7CiAgICAgICAgdWludDI1NiBudW1UYW5rcyA9IGJhc2VUYW5rc1t0YW5rVHlwZV0ubnVtVGFua3M7CgogICAgICAgIHJldHVybiBlYXJuaW5ncyAqIChudW1UYW5rcyAtIGVhcm5pbmdzSW5kZXgpOwogICAgfQp9'.
	

]
