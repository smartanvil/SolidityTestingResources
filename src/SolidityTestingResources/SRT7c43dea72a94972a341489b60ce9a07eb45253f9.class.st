Class {
	#name : #SRT7c43dea72a94972a341489b60ce9a07eb45253f9,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT7c43dea72a94972a341489b60ce9a07eb45253f9 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovLz09PT09PSBPcGVuIFplcHBlbGluIExpYnJhcnkgPT09PT0KLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5CiAqLwpjb250cmFjdCBFUkMyMEJhc2ljIHsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBTYWZlRVJDMjAKICogQGRldiBXcmFwcGVycyBhcm91bmQgRVJDMjAgb3BlcmF0aW9ucyB0aGF0IHRocm93IG9uIGZhaWx1cmUuCiAqIFRvIHVzZSB0aGlzIGxpYnJhcnkgeW91IGNhbiBhZGQgYSBgdXNpbmcgU2FmZUVSQzIwIGZvciBFUkMyMDtgIHN0YXRlbWVudCB0byB5b3VyIGNvbnRyYWN0LAogKiB3aGljaCBhbGxvd3MgeW91IHRvIGNhbGwgdGhlIHNhZmUgb3BlcmF0aW9ucyBhcyBgdG9rZW4uc2FmZVRyYW5zZmVyKC4uLilgLCBldGMuCiAqLwpsaWJyYXJ5IFNhZmVFUkMyMCB7CiAgZnVuY3Rpb24gc2FmZVRyYW5zZmVyKEVSQzIwQmFzaWMgdG9rZW4sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHsKICAgIGFzc2VydCh0b2tlbi50cmFuc2Zlcih0bywgdmFsdWUpKTsKICB9CgogIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlckZyb20oRVJDMjAgdG9rZW4sIGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgaW50ZXJuYWwgewogICAgYXNzZXJ0KHRva2VuLnRyYW5zZmVyRnJvbShmcm9tLCB0bywgdmFsdWUpKTsKICB9CgogIGZ1bmN0aW9uIHNhZmVBcHByb3ZlKEVSQzIwIHRva2VuLCBhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHsKICAgIGFzc2VydCh0b2tlbi5hcHByb3ZlKHNwZW5kZXIsIHZhbHVlKSk7CiAgfQp9CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9CgovKioKICogQHRpdGxlIENvbnRyYWN0cyB0aGF0IHNob3VsZCBub3Qgb3duIENvbnRyYWN0cwogKiBAYXV0aG9yIFJlbWNvIEJsb2VtZW4gPDxhIGhyZWY9Ii9jZG4tY2dpL2wvZW1haWwtcHJvdGVjdGlvbiIgY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSI1NjI0MzMzYjM1MzkxNjY0Ij5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9hPs+ALmNvbT4KICogQGRldiBTaG91bGQgY29udHJhY3RzIChhbnl0aGluZyBPd25hYmxlKSBlbmQgdXAgYmVpbmcgb3duZWQgYnkgdGhpcyBjb250cmFjdCwgaXQgYWxsb3dzIHRoZSBvd25lcgogKiBvZiB0aGlzIGNvbnRyYWN0IHRvIHJlY2xhaW0gb3duZXJzaGlwIG9mIHRoZSBjb250cmFjdHMuCiAqLwpjb250cmFjdCBIYXNOb0NvbnRyYWN0cyBpcyBPd25hYmxlIHsKCiAgLyoqCiAgICogQGRldiBSZWNsYWltIG93bmVyc2hpcCBvZiBPd25hYmxlIGNvbnRyYWN0cwogICAqIEBwYXJhbSBjb250cmFjdEFkZHIgVGhlIGFkZHJlc3Mgb2YgdGhlIE93bmFibGUgdG8gYmUgcmVjbGFpbWVkLgogICAqLwogIGZ1bmN0aW9uIHJlY2xhaW1Db250cmFjdChhZGRyZXNzIGNvbnRyYWN0QWRkcikgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIE93bmFibGUgY29udHJhY3RJbnN0ID0gT3duYWJsZShjb250cmFjdEFkZHIpOwogICAgY29udHJhY3RJbnN0LnRyYW5zZmVyT3duZXJzaGlwKG93bmVyKTsKICB9Cn0KCi8qKgogKiBAdGl0bGUgQ29udHJhY3RzIHRoYXQgc2hvdWxkIGJlIGFibGUgdG8gcmVjb3ZlciB0b2tlbnMKICogQGF1dGhvciBTeWxUaQogKiBAZGV2IFRoaXMgYWxsb3cgYSBjb250cmFjdCB0byByZWNvdmVyIGFueSBFUkMyMCB0b2tlbiByZWNlaXZlZCBpbiBhIGNvbnRyYWN0IGJ5IHRyYW5zZmVycmluZyB0aGUgYmFsYW5jZSB0byB0aGUgY29udHJhY3Qgb3duZXIuCiAqIFRoaXMgd2lsbCBwcmV2ZW50IGFueSBhY2NpZGVudGFsIGxvc3Mgb2YgdG9rZW5zLgogKi8KY29udHJhY3QgQ2FuUmVjbGFpbVRva2VuIGlzIE93bmFibGUgewogIHVzaW5nIFNhZmVFUkMyMCBmb3IgRVJDMjBCYXNpYzsKCiAgLyoqCiAgICogQGRldiBSZWNsYWltIGFsbCBFUkMyMEJhc2ljIGNvbXBhdGlibGUgdG9rZW5zCiAgICogQHBhcmFtIHRva2VuIEVSQzIwQmFzaWMgVGhlIGFkZHJlc3Mgb2YgdGhlIHRva2VuIGNvbnRyYWN0CiAgICovCiAgZnVuY3Rpb24gcmVjbGFpbVRva2VuKEVSQzIwQmFzaWMgdG9rZW4pIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICB1aW50MjU2IGJhbGFuY2UgPSB0b2tlbi5iYWxhbmNlT2YodGhpcyk7CiAgICB0b2tlbi5zYWZlVHJhbnNmZXIob3duZXIsIGJhbGFuY2UpOwogIH0KCn0KCi8qKgogKiBAdGl0bGUgQ29udHJhY3RzIHRoYXQgc2hvdWxkIG5vdCBvd24gVG9rZW5zCiAqIEBhdXRob3IgUmVtY28gQmxvZW1lbiA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjNiNDk1ZTU2NTg1NDdiMDkiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+z4AuY29tPgogKiBAZGV2IFRoaXMgYmxvY2tzIGluY29taW5nIEVSQzIzIHRva2VucyB0byBwcmV2ZW50IGFjY2lkZW50YWwgbG9zcyBvZiB0b2tlbnMuCiAqIFNob3VsZCB0b2tlbnMgKGFueSBFUkMyMEJhc2ljIGNvbXBhdGlibGUpIGVuZCB1cCBpbiB0aGUgY29udHJhY3QsIGl0IGFsbG93cyB0aGUKICogb3duZXIgdG8gcmVjbGFpbSB0aGUgdG9rZW5zLgogKi8KY29udHJhY3QgSGFzTm9Ub2tlbnMgaXMgQ2FuUmVjbGFpbVRva2VuIHsKCiAvKioKICAqIEBkZXYgUmVqZWN0IGFsbCBFUkMyMyBjb21wYXRpYmxlIHRva2VucwogICogQHBhcmFtIGZyb21fIGFkZHJlc3MgVGhlIGFkZHJlc3MgdGhhdCBpcyB0cmFuc2ZlcnJpbmcgdGhlIHRva2VucwogICogQHBhcmFtIHZhbHVlXyB1aW50MjU2IHRoZSBhbW91bnQgb2YgdGhlIHNwZWNpZmllZCB0b2tlbgogICogQHBhcmFtIGRhdGFfIEJ5dGVzIFRoZSBkYXRhIHBhc3NlZCBmcm9tIHRoZSBjYWxsZXIuCiAgKi8KICBmdW5jdGlvbiB0b2tlbkZhbGxiYWNrKGFkZHJlc3MgZnJvbV8sIHVpbnQyNTYgdmFsdWVfLCBieXRlcyBkYXRhXykgZXh0ZXJuYWwgewogICAgZnJvbV87CiAgICB2YWx1ZV87CiAgICBkYXRhXzsKICAgIHJldmVydCgpOwogIH0KCn0KCi8qKgogKiBAdGl0bGUgRGVzdHJ1Y3RpYmxlCiAqIEBkZXYgQmFzZSBjb250cmFjdCB0aGF0IGNhbiBiZSBkZXN0cm95ZWQgYnkgb3duZXIuIEFsbCBmdW5kcyBpbiBjb250cmFjdCB3aWxsIGJlIHNlbnQgdG8gdGhlIG93bmVyLgogKi8KY29udHJhY3QgRGVzdHJ1Y3RpYmxlIGlzIE93bmFibGUgewoKICBmdW5jdGlvbiBEZXN0cnVjdGlibGUoKSBwdWJsaWMgcGF5YWJsZSB7IH0KCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlcnMgdGhlIGN1cnJlbnQgYmFsYW5jZSB0byB0aGUgb3duZXIgYW5kIHRlcm1pbmF0ZXMgdGhlIGNvbnRyYWN0LgogICAqLwogIGZ1bmN0aW9uIGRlc3Ryb3koKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHNlbGZkZXN0cnVjdChvd25lcik7CiAgfQoKICBmdW5jdGlvbiBkZXN0cm95QW5kU2VuZChhZGRyZXNzIF9yZWNpcGllbnQpIG9ubHlPd25lciBwdWJsaWMgewogICAgc2VsZmRlc3RydWN0KF9yZWNpcGllbnQpOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cgp9CgovKioKICogQHRpdGxlIFN0YW5kYXJkIEVSQzIwIHRva2VuCiAqCiAqIEBkZXYgSW1wbGVtZW50YXRpb24gb2YgdGhlIGJhc2ljIHN0YW5kYXJkIHRva2VuLgogKiBAZGV2IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgRmlyc3RCbG9vZDogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sCiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBpbnRlcm5hbCBhbGxvd2VkOwoKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW19mcm9tXSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSk7CgogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICoKICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICogYW5kIHRoZSBuZXcgYWxsb3dhbmNlIGJ5IHVuZm9ydHVuYXRlIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcwogICAqIHJhY2UgY29uZGl0aW9uIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUgYWZ0ZXJ3YXJkczoKICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgKi8KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KCiAgLyoqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgfSBlbHNlIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBNaW50YWJsZSB0b2tlbgogKiBAZGV2IFNpbXBsZSBFUkMyMCBUb2tlbiBleGFtcGxlLCB3aXRoIG1pbnRhYmxlIHRva2VuIGNyZWF0aW9uCiAqIEBkZXYgSXNzdWU6ICogaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXBwZWxpbi1zb2xpZGl0eS9pc3N1ZXMvMTIwCiAqIEJhc2VkIG9uIGNvZGUgYnkgVG9rZW5NYXJrZXROZXQ6IGh0dHBzOi8vZ2l0aHViLmNvbS9Ub2tlbk1hcmtldE5ldC9pY28vYmxvYi9tYXN0ZXIvY29udHJhY3RzL01pbnRhYmxlVG9rZW4uc29sCiAqLwoKY29udHJhY3QgTWludGFibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwogIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwoKICBib29sIHB1YmxpYyBtaW50aW5nRmluaXNoZWQgPSBmYWxzZTsKCgogIG1vZGlmaWVyIGNhbk1pbnQoKSB7CiAgICByZXF1aXJlKCFtaW50aW5nRmluaXNoZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gbWludCB0b2tlbnMKICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCByZWNlaXZlIHRoZSBtaW50ZWQgdG9rZW5zLgogICAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIG1pbnQuCiAgICogQHJldHVybiBBIGJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIG9ubHlPd25lciBjYW5NaW50IHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfYW1vdW50KTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfYW1vdW50KTsKICAgIE1pbnQoX3RvLCBfYW1vdW50KTsKICAgIFRyYW5zZmVyKGFkZHJlc3MoMCksIF90bywgX2Ftb3VudCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gc3RvcCBtaW50aW5nIG5ldyB0b2tlbnMuCiAgICogQHJldHVybiBUcnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gZmluaXNoTWludGluZygpIG9ubHlPd25lciBjYW5NaW50IHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBtaW50aW5nRmluaXNoZWQgPSB0cnVlOwogICAgTWludEZpbmlzaGVkKCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCi8vPT09PT09IEFHUkUgQ29udHJhY3RzID09PT09CgovKioKKiBAdGl0bGUgVHJhZGVhYmxlVG9rZW4gY2FuIGJlIGJvdWdodCBhbmQgc29sZCBmcm9tL3RvIGl0J3Mgb3duIGNvbnRyYWN0IGR1cmluZyBpdCdzIGxpZmUgdGltZQoqIFNvbGQgdG9rZW5zIGFuZCBFdGhlciByZWNlaXZlZCB0byBidXkgdG9rZW5zIGFyZSBjb2xsZWN0ZWQgZHVyaW5nIHNwZWNpZmllZCBwZXJpb2QgYW5kIHRoZW4gdGltZSBjb21lcwoqIGNvbnRyYWN0IG93bmVyIHNob3VsZCBzcGVjaWZ5IHByaWNlIGZvciB0aGUgbGFzdCBwZXJpb2QgYW5kIHNlbmQgdG9rZW5zL2V0aGVyIHRvIHRoZWlyIG5ldyBvd25lcnMuCiovCmNvbnRyYWN0IFRyYWRlYWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIE93bmFibGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgZXZlbnQgU2FsZShhZGRyZXNzIGluZGV4ZWQgYnV5ZXIsIHVpbnQyNTYgYW1vdW50KTsKICAgIGV2ZW50IFJlZGVtcHRpb24oYWRkcmVzcyBpbmRleGVkIHNlbGxlciwgdWludDI1NiBhbW91bnQpOwogICAgZXZlbnQgRGlzdHJpYnV0aW9uRXJyb3IoYWRkcmVzcyBzZWxsZXIsIHVpbnQyNTYgYW1vdW50KTsKCiAgICAvKioKICAgICogU3RhdGUgb2YgdGhlIGNvbnRyYWN0OgogICAgKiBDb2xsZWN0aW5nIC0gY29sbGVjdGluZyBldGhlciBhbmQgdG9rZW5zCiAgICAqIERpc3RyaWJ1dGlvbiAtIGRpc3RyaWJ1dGlvbiBvZiBib3VnaHQgdG9rZW5zIGFuZCBldGhlciBpcyBpbiBwcm9jZXNzCiAgICAqLwogICAgZW51bSBTdGF0ZXtDb2xsZWN0aW5nLCBEaXN0cmlidXRpb259CgogICAgU3RhdGUgICBwdWJsaWMgY3VycmVudFN0YXRlOyAgICAgICAgICAgICAgICAvL0N1cnJlbnQgc3RhdGUgb2YgdGhlIGNvbnRyYWN0CiAgICB1aW50MjU2IHB1YmxpYyBwcmV2aW91c1BlcmlvZFJhdGU7ICAgICAgICAgIC8vUHJldmlvdXMgcmF0ZTogaG93IG1hbnkgdG9rZW5zIG9uZSBjb3VsZCByZWNlaXZlIGZvciAxIGV0aGVyIGluIHRoZSBsYXN0IHBlcmlvZAogICAgdWludDI1NiBwdWJsaWMgY3VycmVudFBlcmlvZEVuZFRpbWVzdGFtcDsgICAvL1RpbWVzdGFtcCBhZnRlciB3aGljaCBubyBtb3JlIHRyYWRlcyBhcmUgYWNjZXB0ZWQgYW5kIGNvbnRyYWN0IGlzIHdhaXRpbmcgdG8gc3RhcnQgZGlzdHJpYnV0aW9uCiAgICB1aW50MjU2IHB1YmxpYyBjdXJyZW50UGVyaW9kU3RhcnRCbG9jazsgICAgIC8vTnVtYmVyIG9mIGJsb2NrIHdoZW4gY3VycmVudCBwZXJpb25zIHdhcyBzdGFydGVkCgogICAgdWludDI1NiBwdWJsaWMgY3VycmVudFBlcmlvZFJhdGU7ICAgICAgICAgICAvL0N1cnJlbnQgcmF0ZTogaG93IG11Y2ggdG9rZW5zIG9uZSBzaG91bGQgcmVjZWl2ZSBmb3IgMSBldGhlciBpbiBjdXJyZW50IGRpc3RyaWJ1dGlvbiBwZXJpb2QKICAgIHVpbnQyNTYgcHVibGljIGN1cnJlbnRQZXJpb2RFdGhlckNvbGxlY3RlZDsgLy9Ib3cgbXVjaCBldGhlciB3YXMgY29sbGVjdGVkICh0byBidXkgdG9rZW5zKSBkdXJpbmcgY3VycmVudCBwZXJpb2QgYW5kIHdhaXRpbmcgZm9yIGRpc3RyaWJ1dGlvbgogICAgdWludDI1NiBwdWJsaWMgY3VycmVudFBlcmlvZFRva2VuQ29sbGVjdGVkOyAvL0hvdyBtdWNoIHRva2VucyB3YXMgY29sbGVjdGVkICh0byBzZWxsIHRva2VucykgZHVyaW5nIGN1cnJlbnQgcGVyaW9kIGFuZCB3YWl0aW5nIGZvciBkaXN0cmlidXRpb24KCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgcmVjZWl2ZWRFdGhlcjsgIC8vbWFwcyBhZGRyZXNzIG9mIGJ1eWVyIHRvIGFtb3VudCBvZiBldGhlciBoZSBzZW50CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1Nikgc29sZFRva2VuczsgICAgIC8vbWFwcyBhZGRyZXNzIG9mIHNlbGxlciB0byBhbW91bnQgb2YgdG9rZW5zIGhlIHNlbnQKCiAgICB1aW50MzIgY29uc3RhbnQgTUlMTElfUEVSQ0VOVF9ESVZJREVSID0gMTAwKjEwMDA7CiAgICB1aW50MzIgcHVibGljIGJ1eUZlZU1pbGxpUGVyY2VudDsgICAgICAgICAgIC8vVGhlIGJ1eWVyJ3MgZmVlIGluIGEgdGhvdXNhbmR0aCBvZiBwZXJjZW50LiBTbywgaWYgYnV5ZXIncyBmZWUgPSA1JSwgdGhlbiBidXlGZWVNaWxsaVBlcmNlbnQgPSA1MDAwIGFuZCBpZiB3aXRob3V0IGJ1eWVyIHNob3VkIHJlY2VpdmUgMjAwIHRva2VucyB3aXRoIGZlZSBpdCB3aWxsIHJlY2VpdmUgMjAwIC0gKDIwMCAqIDUwMDAgLyBNSUxMSV9QRVJDRU5UX0RJVklERVIpCiAgICB1aW50MzIgcHVibGljIHNlbGxGZWVNaWxsaVBlcmNlbnQ7ICAgICAgICAgIC8vVGhlIHNlbGxlcidzIGZlZSBpbiBhIHRob3VzYW5kdGggb2YgcGVyY2VudC4gKHNlZSBhYm92ZSkKCiAgICB1aW50MjU2IHB1YmxpYyBtaW5CdXlBbW91bnQ7ICAgICAgICAgICAgICAgIC8vTWluaW1hbCBhbW91bnQgb2YgZXRoZXIgdG8gYnV5CiAgICB1aW50MjU2IHB1YmxpYyBtaW5TZWxsQW1vdW50OyAgICAgICAgICAgICAgIC8vTWluaW1hbCBhbW91bnQgb2YgdG9rZW5zIHRvIHNlbGwKCiAgICBtb2RpZmllciBjYW5CdXlBbmRTZWxsKCkgewogICAgICAgIHJlcXVpcmUoY3VycmVudFN0YXRlID09IFN0YXRlLkNvbGxlY3RpbmcpOwogICAgICAgIHJlcXVpcmUobm93IDwgY3VycmVudFBlcmlvZEVuZFRpbWVzdGFtcCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBUcmFkZWFibGVUb2tlbigpIHB1YmxpYyB7CiAgICAgICAgY3VycmVudFN0YXRlID0gU3RhdGUuRGlzdHJpYnV0aW9uOwogICAgICAgIC8vY3VycmVudFBlcmlvZFN0YXJ0QmxvY2sgPSAwOwogICAgICAgIGN1cnJlbnRQZXJpb2RFbmRUaW1lc3RhbXAgPSBub3c7ICAgIC8vZW5zdXJlIHRoYXQgbm90aGluZyBjYW4gYmUgY29sbGVjdGVkIHVudGlsIG5ldyBwZXJpb2QgaXMgc3RhcnRlZCBieSBvd25lcgogICAgfQoKICAgIC8qKgogICAgKiBAbm90aWNlIFNlbmQgRXRoZXIgdG8gYnV5IHRva2VucwogICAgKi8KICAgIGZ1bmN0aW9uKCkgcGF5YWJsZSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID4gMCk7CiAgICAgICAgYnV5KG1zZy5zZW5kZXIsIG1zZy52YWx1ZSk7CiAgICB9ICAgIAoKICAgIC8qKgogICAgKiBAbm90aWNlIFRyYW5zZmVyIG9yIHNlbGwgdG9rZW5zCiAgICAqIFNlbGxzIHRva2VucyB0cmFuc2ZlcnJlZCB0byB0aGlzIGNvbnRyYWN0IGl0c2VsZiBvciB0byB6ZXJvIGFkZHJlc3MKICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0byBvciB0b2tlbiBjb250cmFjdCBhZGRyZXNzIHRvIGJ1cm4uCiAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYoIChfdG8gPT0gYWRkcmVzcyh0aGlzKSkgfHwgKF90byA9PSAwKSApewogICAgICAgICAgICByZXR1cm4gc2VsbChtc2cuc2VuZGVyLCBfdmFsdWUpOwogICAgICAgIH1lbHNlewogICAgICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICogQG5vdGljZSBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyICBvciBzZWxsIHRoZW0gaWYgX3RvIGlzIHRoaXMgY29udHJhY3Qgb3IgemVybyBhZGRyZXNzCiAgICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdXQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVyZWQKICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmKCAoX3RvID09IGFkZHJlc3ModGhpcykpIHx8IChfdG8gPT0gMCkgKXsKICAgICAgICAgICAgdmFyIF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKICAgICAgICAgICAgcmVxdWlyZSAoX3ZhbHVlIDw9IF9hbGxvd2FuY2UpOwogICAgICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7CiAgICAgICAgICAgIHJldHVybiBzZWxsKF9mcm9tLCBfdmFsdWUpOwogICAgICAgIH1lbHNlewogICAgICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEZ1Y3Rpb24gY2FsbGVkIHdoZW4gc29tZWJvZHkgaXMgYnV5aW5nIHRva2VucwogICAgKiBAcGFyYW0gd2hvIFRoZSBhZGRyZXNzIG9mIGJ1eWVyICh3aG8gd2lsbCBvd24gYm91Z2h0IHRva2VucykKICAgICogQHBhcmFtIGFtb3VudCBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICAgKi8KICAgIGZ1bmN0aW9uIGJ1eShhZGRyZXNzIHdobywgdWludDI1NiBhbW91bnQpIGNhbkJ1eUFuZFNlbGwgaW50ZXJuYWwgcmV0dXJucyhib29sKXsKICAgICAgICByZXF1aXJlKGFtb3VudCA+PSBtaW5CdXlBbW91bnQpOwogICAgICAgIGN1cnJlbnRQZXJpb2RFdGhlckNvbGxlY3RlZCA9IGN1cnJlbnRQZXJpb2RFdGhlckNvbGxlY3RlZC5hZGQoYW1vdW50KTsKICAgICAgICByZWNlaXZlZEV0aGVyW3dob10gPSByZWNlaXZlZEV0aGVyW3dob10uYWRkKGFtb3VudCk7ICAvL2lmIHRoaXMgaXMgZmlyc3Qgb3BlcmF0aW9uIGZyb20gdGhpcyBhZGRyZXNzLCBpbml0aWFsIHZhbHVlIG9mIHJlY2VpdmVkRXRoZXJbdG9dID09IDAKICAgICAgICBTYWxlKHdobywgYW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBGdWN0aW9uIGNhbGxlZCB3aGVuIHNvbWVib2R5IGlzIHNlbGxpbmcgaGlzIHRva2VucwogICAgKiBAcGFyYW0gd2hvIFRoZSBhZGRyZXNzIG9mIHNlbGxlciAod2hvc2UgdG9rZW5zIGFyZSBzb2xkKQogICAgKiBAcGFyYW0gYW1vdW50IFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgICAqLwogICAgZnVuY3Rpb24gc2VsbChhZGRyZXNzIHdobywgdWludDI1NiBhbW91bnQpIGNhbkJ1eUFuZFNlbGwgaW50ZXJuYWwgcmV0dXJucyhib29sKXsKICAgICAgICByZXF1aXJlKGFtb3VudCA+PSBtaW5TZWxsQW1vdW50KTsKICAgICAgICBjdXJyZW50UGVyaW9kVG9rZW5Db2xsZWN0ZWQgPSBjdXJyZW50UGVyaW9kVG9rZW5Db2xsZWN0ZWQuYWRkKGFtb3VudCk7CiAgICAgICAgc29sZFRva2Vuc1t3aG9dID0gc29sZFRva2Vuc1t3aG9dLmFkZChhbW91bnQpOyAgLy9pZiB0aGlzIGlzIGZpcnN0IG9wZXJhdGlvbiBmcm9tIHRoaXMgYWRkcmVzcywgaW5pdGlhbCB2YWx1ZSBvZiBzb2xkVG9rZW5zW3RvXSA9PSAwCiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5zdWIoYW1vdW50KTsKICAgICAgICBSZWRlbXB0aW9uKHdobywgYW1vdW50KTsKICAgICAgICBUcmFuc2Zlcih3aG8sIGFkZHJlc3MoMCksIGFtb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICogQG5vdGljZSBTZXQgZmVlIGFwcGxpZWQgd2hlbiBidXlpbmcgdG9rZW5zCiAgICAqIEBwYXJhbSBfYnV5RmVlTWlsbGlQZXJjZW50IGZlZSBpbiB0aG91c2FuZHRoIG9mIHBlcmNlbnQgKDUlID0gNTAwMCkKICAgICovCiAgICBmdW5jdGlvbiBzZXRCdXlGZWUodWludDMyIF9idXlGZWVNaWxsaVBlcmNlbnQpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX2J1eUZlZU1pbGxpUGVyY2VudCA8IE1JTExJX1BFUkNFTlRfRElWSURFUik7CiAgICAgICAgYnV5RmVlTWlsbGlQZXJjZW50ID0gX2J1eUZlZU1pbGxpUGVyY2VudDsKICAgIH0KICAgIC8qKgogICAgKiBAbm90aWNlIFNldCBmZWUgYXBwbGllZCB3aGVuIHNlbGxpbmcgdG9rZW5zCiAgICAqIEBwYXJhbSBfc2VsbEZlZU1pbGxpUGVyY2VudCBmZWUgaW4gdGhvdXNhbmR0aCBvZiBwZXJjZW50ICg1JSA9IDUwMDApCiAgICAqLwogICAgZnVuY3Rpb24gc2V0U2VsbEZlZSh1aW50MzIgX3NlbGxGZWVNaWxsaVBlcmNlbnQpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX3NlbGxGZWVNaWxsaVBlcmNlbnQgPCBNSUxMSV9QRVJDRU5UX0RJVklERVIpOwogICAgICAgIHNlbGxGZWVNaWxsaVBlcmNlbnQgPSBfc2VsbEZlZU1pbGxpUGVyY2VudDsKICAgIH0KICAgIC8qKgogICAgKiBAbm90aWNlIHNldCBtaW5pbWFsIGFtb3VudCBvZiBldGhlciB3aGljaCBjYW4gYmUgdXNlZCB0byBidXkgdG9rZW5zCiAgICAqIEBwYXJhbSBfbWluQnV5QW1vdW50IG1pbmltYWwgYW1vdW50IG9mIGV0aGVyCiAgICAqLwogICAgZnVuY3Rpb24gc2V0TWluQnV5QW1vdW50KHVpbnQyNTYgX21pbkJ1eUFtb3VudCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgbWluQnV5QW1vdW50ID0gX21pbkJ1eUFtb3VudDsKICAgIH0KICAgIC8qKgogICAgKiBAbm90aWNlIHNldCBtaW5pbWFsIGFtb3VudCBvZiBldGhlciB3aGljaCBjYW4gYmUgdXNlZCB0byBidXkgdG9rZW5zCiAgICAqIEBwYXJhbSBfbWluU2VsbEFtb3VudCBtaW5pbWFsIGFtb3VudCBvZiB0b2tlbnMKICAgICovCiAgICBmdW5jdGlvbiBzZXRNaW5TZWxsQW1vdW50KHVpbnQyNTYgX21pblNlbGxBbW91bnQpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIG1pblNlbGxBbW91bnQgPSBfbWluU2VsbEFtb3VudDsKICAgIH0KCiAgICAvKioKICAgICogQG5vdGljZSBDb2xsZWN0IGV0aGVyIHJlY2VpdmVkIGZvciB0b2tlbiBwdXJzaGFzZXMKICAgICogVGhpcyBpcyBwb3NzaWJsZSBib3RoIGR1cmluZyBDb2xsZWN0aW9uIGFuZCBEaXN0cmlidXRpb24gcGhhc2VzCiAgICAqLwogICAgZnVuY3Rpb24gY29sbGVjdEV0aGVyKHVpbnQyNTYgYW1vdW50KSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICBvd25lci50cmFuc2ZlcihhbW91bnQpOwogICAgfQoKICAgIC8qKgogICAgKiBAbm90aWNlIFN0YXJ0IGRpc3RyaWJ1dGlvbiBwaGFzZQogICAgKiBAcGFyYW0gX2N1cnJlbnRQZXJpb2RSYXRlIGV4Y2hhbmdlIHJhdGUgZm9yIGN1cnJlbnQgZGlzdHJpYnV0aW9uCiAgICAqLwogICAgZnVuY3Rpb24gc3RhcnREaXN0cmlidXRpb24odWludDI1NiBfY3VycmVudFBlcmlvZFJhdGUpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoY3VycmVudFN0YXRlICE9IFN0YXRlLkRpc3RyaWJ1dGlvbik7ICAgIC8vb3duZXIgc2hvdWxkIG5vdCBiZSBhYmxlIHRvIGNoYW5nZSByYXRlIGFmdGVyIGRpc3RyaWJ1dGlvbiBpcyBzdGFydGVkLCBlbnN1cmVzIHRoYXQgZXZlcnlvbmUgaGF2ZSB0aGUgc2FtZSByYXRlCiAgICAgICAgcmVxdWlyZShfY3VycmVudFBlcmlvZFJhdGUgIT0gMCk7ICAgICAgICAgICAgICAgIC8vc29tZXRoaW5nIGhhcyB0byBiZSBkaXN0cmlidXRlZCEKICAgICAgICAvL3JlcXVpcmUobm93ID49IGN1cnJlbnRQZXJpb2RFbmRUaW1lc3RhbXApICAgICAvL0RPIE5PVCByZXF1aXJlIHBlcmlvZCBlbmQgdGltZXN0YW1wIHBhc3NlZCwgYmVjYXVzZSB0aGVyZSBjYW4gYmUgc29tZSBzaXR1YXRpb25zIHdoZW4gaXQgaXMgbmVlZGUgdG8gZW5kIGl0IHNvb25lci4gQnV0IHRoaXMgc2hvdWxkIGJlIGRvbmUgd2l0aCBleHRyZW1hbCBjYXJlLCBiZWNhdXNlIG9mIHBvc3NpYmxlIHJhY2UgY29uZGl0aW9uIGJldHdlZW4gbmV3IHNhbGVzL3B1cnNoYXNlcyBhbmQgY3VycmVudFBlcmlvZFJhdGUgZGVmaW5pdGlvbgoKICAgICAgICBjdXJyZW50U3RhdGUgPSBTdGF0ZS5EaXN0cmlidXRpb247CiAgICAgICAgY3VycmVudFBlcmlvZFJhdGUgPSBfY3VycmVudFBlcmlvZFJhdGU7CiAgICB9CgogICAgLyoqCiAgICAqIEBub3RpY2UgRGlzdHJpYnV0ZSB0b2tlbnMgdG8gYnV5ZXJzCiAgICAqIEBwYXJhbSBidXllcnMgYW4gYXJyYXkgb2YgYWRkcmVzc2VzIHRvIHBheSB0b2tlbnMgZm9yIHRoZWlyIGV0aGVyLiBTaG91bGQgYmUgY29tcG9zZWQgZnJvbSBvdXRzaWRlIGJ5IHJlYWRpbmcgU2FsZSBldmVudHMgCiAgICAqLwogICAgZnVuY3Rpb24gZGlzdHJpYnV0ZVRva2VucyhhZGRyZXNzW10gYnV5ZXJzKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKGN1cnJlbnRTdGF0ZSA9PSBTdGF0ZS5EaXN0cmlidXRpb24pOwogICAgICAgIHJlcXVpcmUoY3VycmVudFBlcmlvZFJhdGUgPiAwKTsKICAgICAgICBmb3IodWludDI1NiBpPTA7IGkgPCBidXllcnMubGVuZ3RoOyBpKyspewogICAgICAgICAgICBhZGRyZXNzIGJ1eWVyID0gYnV5ZXJzW2ldOwogICAgICAgICAgICByZXF1aXJlKGJ1eWVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgICAgICB1aW50MjU2IGV0aGVyQW1vdW50ID0gcmVjZWl2ZWRFdGhlcltidXllcl07CiAgICAgICAgICAgIGlmKGV0aGVyQW1vdW50ID09IDApIGNvbnRpbnVlOyAvL2J1eWVyIG5vdCBmb3VuZCBvciBhbHJlYWR5IHBhaWQKICAgICAgICAgICAgdWludDI1NiB0b2tlbkFtb3VudCA9IGV0aGVyQW1vdW50Lm11bChjdXJyZW50UGVyaW9kUmF0ZSk7CiAgICAgICAgICAgIHVpbnQyNTYgZmVlID0gdG9rZW5BbW91bnQubXVsKGJ1eUZlZU1pbGxpUGVyY2VudCkuZGl2KE1JTExJX1BFUkNFTlRfRElWSURFUik7CiAgICAgICAgICAgIHRva2VuQW1vdW50ID0gdG9rZW5BbW91bnQuc3ViKGZlZSk7CiAgICAgICAgICAgIAogICAgICAgICAgICByZWNlaXZlZEV0aGVyW2J1eWVyXSA9IDA7CiAgICAgICAgICAgIGN1cnJlbnRQZXJpb2RFdGhlckNvbGxlY3RlZCA9IGN1cnJlbnRQZXJpb2RFdGhlckNvbGxlY3RlZC5zdWIoZXRoZXJBbW91bnQpOwogICAgICAgICAgICAvL21pbnQgdG9rZW5zCiAgICAgICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKHRva2VuQW1vdW50KTsKICAgICAgICAgICAgYmFsYW5jZXNbYnV5ZXJdID0gYmFsYW5jZXNbYnV5ZXJdLmFkZCh0b2tlbkFtb3VudCk7CiAgICAgICAgICAgIFRyYW5zZmVyKGFkZHJlc3MoMCksIGJ1eWVyLCB0b2tlbkFtb3VudCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgKiBAbm90aWNlIERpc3RyaWJ1dGUgZXRoZXIgdG8gc2VsbGVycwogICAgKiBJZiBub3QgZW5vdWdoIGV0aGVyIGlzIGF2YWlsYWJsZSBvbiBjb250cmFjdCBiYWxsYW5jZQogICAgKiBAcGFyYW0gc2VsbGVycyBhbiBhcnJheSBvZiBhZGRyZXNzZXMgdG8gcGF5IGV0aGVyIGZvciB0aGVpciB0b2tlbnMuIFNob3VsZCBiZSBjb21wb3NlZCBmcm9tIG91dHNpZGUgYnkgcmVhZGluZyBSZWRlbXB0aW9uIGV2ZW50cyAKICAgICovCiAgICBmdW5jdGlvbiBkaXN0cmlidXRlRXRoZXIoYWRkcmVzc1tdIHNlbGxlcnMpIG9ubHlPd25lciBwYXlhYmxlIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShjdXJyZW50U3RhdGUgPT0gU3RhdGUuRGlzdHJpYnV0aW9uKTsKICAgICAgICByZXF1aXJlKGN1cnJlbnRQZXJpb2RSYXRlID4gMCk7CiAgICAgICAgZm9yKHVpbnQyNTYgaT0wOyBpIDwgc2VsbGVycy5sZW5ndGg7IGkrKyl7CiAgICAgICAgICAgIGFkZHJlc3Mgc2VsbGVyID0gc2VsbGVyc1tpXTsKICAgICAgICAgICAgcmVxdWlyZShzZWxsZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgICAgIHVpbnQyNTYgdG9rZW5BbW91bnQgPSBzb2xkVG9rZW5zW3NlbGxlcl07CiAgICAgICAgICAgIGlmKHRva2VuQW1vdW50ID09IDApIGNvbnRpbnVlOyAvL3NlbGxlciBub3QgZm91bmQgb3IgYWxyZWFkeSBwYWlkCiAgICAgICAgICAgIHVpbnQyNTYgZXRoZXJBbW91bnQgPSB0b2tlbkFtb3VudC5kaXYoY3VycmVudFBlcmlvZFJhdGUpOwogICAgICAgICAgICB1aW50MjU2IGZlZSA9IGV0aGVyQW1vdW50Lm11bChzZWxsRmVlTWlsbGlQZXJjZW50KS5kaXYoTUlMTElfUEVSQ0VOVF9ESVZJREVSKTsKICAgICAgICAgICAgZXRoZXJBbW91bnQgPSBldGhlckFtb3VudC5zdWIoZmVlKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHNvbGRUb2tlbnNbc2VsbGVyXSA9IDA7CiAgICAgICAgICAgIGN1cnJlbnRQZXJpb2RUb2tlbkNvbGxlY3RlZCA9IGN1cnJlbnRQZXJpb2RUb2tlbkNvbGxlY3RlZC5zdWIodG9rZW5BbW91bnQpOwogICAgICAgICAgICBpZighc2VsbGVyLnNlbmQoZXRoZXJBbW91bnQpKXsKICAgICAgICAgICAgICAgIC8vaW4gdGhpcyBjYXNlIHdlIGNhbiBvbmx5IGxvZyBlcnJvciBhbmQgbGV0IG93bmVyIHRvIGhhbmRsZSBpdCBtYW51YWxseQogICAgICAgICAgICAgICAgRGlzdHJpYnV0aW9uRXJyb3Ioc2VsbGVyLCBldGhlckFtb3VudCk7CiAgICAgICAgICAgICAgICBvd25lci50cmFuc2ZlcihldGhlckFtb3VudCk7IC8vYXNzdW1lIHRoaXMgc2hvdWxkIG5vdCBmYWlsLi4uLCBvdmVyd2lzZSAtIGNoYW5nZSBvd25lcgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHN0YXJ0Q29sbGVjdGluZyh1aW50MjU2IF9jb2xsZWN0aW5nRW5kVGltZXN0YW1wKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKF9jb2xsZWN0aW5nRW5kVGltZXN0YW1wID4gbm93KTsgICAgICAvL05lZWQgc29tZSB0aW1lIGZvciBjb2xsZWN0aW9uCiAgICAgICAgcmVxdWlyZShjdXJyZW50U3RhdGUgPT0gU3RhdGUuRGlzdHJpYnV0aW9uKTsgICAgLy9EbyBub3QgYWxsb3cgdG8gY2hhbmdlIGNvbGxlY3Rpb24gdGVybXMgYWZ0ZXIgaXQgaXMgc3RhcnRlZAogICAgICAgIHJlcXVpcmUoY3VycmVudFBlcmlvZEV0aGVyQ29sbGVjdGVkID09IDApOyAgICAgIC8vQWxsIHNvbGQgdG9rZW5zIGFyZSBkaXN0cmlidXRlZAogICAgICAgIHJlcXVpcmUoY3VycmVudFBlcmlvZFRva2VuQ29sbGVjdGVkID09IDApOyAgICAgIC8vQWxsIHJlZGVlbWVkIHRva2VucyBhcmUgcGFpZAogICAgICAgIHByZXZpb3VzUGVyaW9kUmF0ZSA9IGN1cnJlbnRQZXJpb2RSYXRlOwogICAgICAgIGN1cnJlbnRQZXJpb2RSYXRlID0gMDsKICAgICAgICBjdXJyZW50UGVyaW9kU3RhcnRCbG9jayA9IGJsb2NrLm51bWJlcjsKICAgICAgICBjdXJyZW50UGVyaW9kRW5kVGltZXN0YW1wID0gX2NvbGxlY3RpbmdFbmRUaW1lc3RhbXA7CiAgICAgICAgY3VycmVudFN0YXRlID0gU3RhdGUuQ29sbGVjdGluZzsKICAgIH0KfQoKY29udHJhY3QgQUdSRVRva2VuIGlzIFRyYWRlYWJsZVRva2VuLCBNaW50YWJsZVRva2VuLCBIYXNOb0NvbnRyYWN0cywgSGFzTm9Ub2tlbnMgeyAvL01pbnRhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZQogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAiQUdSRSI7CiAgICBzdHJpbmcgcHVibGljIG5hbWUgPSAiQWdncmVnYXRlIENvaW4iOwogICAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CgogICAgYWRkcmVzcyBwdWJsaWMgZm91bmRlcjsgICAgLy9mb3VuZGVyIGFkZHJlc3MgdG8gYWxsb3cgaGltIHRyYW5zZmVyIHRva2VucyB3aGlsZSBtaW50aW5nCiAgICBmdW5jdGlvbiBpbml0KGFkZHJlc3MgX2ZvdW5kZXIsIHVpbnQzMiBfYnV5RmVlTWlsbGlQZXJjZW50LCB1aW50MzIgX3NlbGxGZWVNaWxsaVBlcmNlbnQsIHVpbnQyNTYgX21pbkJ1eUFtb3VudCwgdWludDI1NiBfbWluU2VsbEFtb3VudCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgZm91bmRlciA9IF9mb3VuZGVyOwogICAgICAgIHNldEJ1eUZlZShfYnV5RmVlTWlsbGlQZXJjZW50KTsKICAgICAgICBzZXRTZWxsRmVlKF9zZWxsRmVlTWlsbGlQZXJjZW50KTsKICAgICAgICBzZXRNaW5CdXlBbW91bnQoX21pbkJ1eUFtb3VudCk7CiAgICAgICAgc2V0TWluU2VsbEFtb3VudChfbWluU2VsbEFtb3VudCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBbGxvdyB0cmFuc2ZlciBvbmx5IGFmdGVyIGNyb3dkc2FsZSBmaW5pc2hlZAogICAgICovCiAgICBtb2RpZmllciBjYW5UcmFuc2ZlcigpIHsKICAgICAgICByZXF1aXJlKG1pbnRpbmdGaW5pc2hlZCB8fCBtc2cuc2VuZGVyID09IGZvdW5kZXIpOwogICAgICAgIF87CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgY2FuVHJhbnNmZXIgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgY2FuVHJhbnNmZXIgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIH0KfQoKY29udHJhY3QgQUdSRUNyb3dkc2FsZSBpcyBPd25hYmxlLCBEZXN0cnVjdGlibGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7ICAgIAoKICAgIHVpbnQyNTYgcHVibGljIG1heEdhc1ByaWNlICA9IDUwMDAwMDAwMDAwIHdlaTsgICAgICAvL01heGltdW0gZ2FzIHByaWNlIGZvciBjb250cmlidXRpb24gdHJhbnNhY3Rpb25zCgogICAgdWludDI1NiBwdWJsaWMgc3RhcnRUaW1lc3RhbXA7ICAgICAvL3doZW4gY3Jvd2RzYWwgc3RhcnRzCiAgICB1aW50MjU2IHB1YmxpYyBlbmRUaW1lc3RhbXA7ICAgICAgIC8vd2hlbiBjcm93ZHNhbCBlbmRzCiAgICB1aW50MjU2IHB1YmxpYyByYXRlOyAgICAgICAgICAgICAgIC8vaG93IG1hbnkgdG9rZW5zIHdpbGwgYmUgbWludGVkIGZvciAxIEVUSCAobGlrZSAzMDAgQ1BNIGZvciAxIEVUSCkKICAgIHVpbnQyNTYgcHVibGljIGhhcmRDYXA7ICAgICAgICAgICAgLy9tYXhpbXVtIGFtb3VudCBvZiBldGhlciB0byBjb2xsZWN0CgogICAgQUdSRVRva2VuIHB1YmxpYyB0b2tlbjsKICAgIHVpbnQyNTYgcHVibGljIGNvbGxlY3RlZEV0aGVyOwoKICAgIC8qKgogICAgKiB2ZXJpZmllcyB0aGF0IHRoZSBnYXMgcHJpY2UgaXMgbG93ZXIgdGhhbiBtYXhHYXNQcmljZQogICAgKi8KICAgIG1vZGlmaWVyIHZhbGlkR2FzUHJpY2UoKSB7CiAgICAgICAgcmVxdWlyZSh0eC5nYXNwcmljZSA8PSBtYXhHYXNQcmljZSk7CiAgICAgICAgXzsKICAgIH0KICAgIC8qKgogICAgKiBAbm90aWNlIENyZWF0ZSBhIGNyb3dkc2FsZSBjb250cmFjdCwgYSB0b2tlbiBhbmQgaW5pdGlhbGl6ZSB0aGVtCiAgICAqIEBwYXJhbSBfb3duZXJUb2tlbnMgQW1vdW50IG9mIHRva2VucyB0aGF0IHdpbGwgYmUgbWludCB0byBvd25lciBkdXJpbmcgdGhlIHNhbGUKICAgICovCiAgICBmdW5jdGlvbiBBR1JFQ3Jvd2RzYWxlKHVpbnQyNTYgX3N0YXJ0VGltZXN0YW1wLCB1aW50MjU2IF9lbmRUaW1lc3RhbXAsIHVpbnQyNTYgX3JhdGUsIHVpbnQyNTYgX2hhcmRDYXAsIAogICAgICAgIHVpbnQyNTYgX293bmVyVG9rZW5zLCB1aW50MzIgX2J1eUZlZU1pbGxpUGVyY2VudCwgdWludDMyIF9zZWxsRmVlTWlsbGlQZXJjZW50LCB1aW50MjU2IF9taW5CdXlBbW91bnQsIHVpbnQyNTYgX21pblNlbGxBbW91bnQpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfc3RhcnRUaW1lc3RhbXAgPCBfZW5kVGltZXN0YW1wKTsKICAgICAgICByZXF1aXJlKF9yYXRlID4gMCk7CgogICAgICAgIHN0YXJ0VGltZXN0YW1wID0gX3N0YXJ0VGltZXN0YW1wOwogICAgICAgIGVuZFRpbWVzdGFtcCA9IF9lbmRUaW1lc3RhbXA7CiAgICAgICAgcmF0ZSA9IF9yYXRlOwogICAgICAgIGhhcmRDYXAgPSBfaGFyZENhcDsKCiAgICAgICAgdG9rZW4gPSBuZXcgQUdSRVRva2VuKCk7CiAgICAgICAgdG9rZW4uaW5pdChtc2cuc2VuZGVyLCBfYnV5RmVlTWlsbGlQZXJjZW50LCBfc2VsbEZlZU1pbGxpUGVyY2VudCwgX21pbkJ1eUFtb3VudCwgX21pblNlbGxBbW91bnQpOwogICAgICAgIHRva2VuLm1pbnQobXNnLnNlbmRlciwgX293bmVyVG9rZW5zKTsKICAgIH0KCiAgICBmdW5jdGlvbiAoKSBwYXlhYmxlIHZhbGlkR2FzUHJpY2UgcHVibGljIHsKICAgICAgICByZXF1aXJlKGNyb3dkc2FsZU9wZW4oKSk7CiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPiAwKTsKICAgICAgICByZXF1aXJlKGNvbGxlY3RlZEV0aGVyLmFkZChtc2cudmFsdWUpIDw9IGhhcmRDYXApOwoKICAgICAgICBjb2xsZWN0ZWRFdGhlciA9IGNvbGxlY3RlZEV0aGVyLmFkZChtc2cudmFsdWUpOwogICAgICAgIHVpbnQyNTYgYnV5ZXJUb2tlbnMgPSByYXRlLm11bChtc2cudmFsdWUpOwogICAgICAgIHRva2VuLm1pbnQobXNnLnNlbmRlciwgYnV5ZXJUb2tlbnMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNyb3dkc2FsZU9wZW4oKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyhib29sKXsKICAgICAgICByZXR1cm4gKHJhdGUgPiAwKSAmJiAoY29sbGVjdGVkRXRoZXIgPCBoYXJkQ2FwKSAmJiAoc3RhcnRUaW1lc3RhbXAgPD0gbm93KSAmJiAobm93IDw9IGVuZFRpbWVzdGFtcCk7CiAgICB9CgogICAgLyoqCiAgICAqIEBub3RpY2UgVXBkYXRlcyBtYXggZ2FzIHByaWNlIGZvciBjcm93ZHNhbGUgdHJhbnNhY3Rpb25zCiAgICAqLwogICAgZnVuY3Rpb24gc2V0TWF4R2FzUHJpY2UodWludDI1NiBfbWF4R2FzUHJpY2UpIHB1YmxpYyBvbmx5T3duZXIgIHsKICAgICAgICBtYXhHYXNQcmljZSA9IF9tYXhHYXNQcmljZTsKICAgIH0KCiAgICAvKioKICAgICogQG5vdGljZSBDbG9zZXMgY3Jvd2RzYWxlLCBmaW5pc2hlcyBtaW50aW5nIChhbGxvd2luZyB0b2tlbiB0cmFuc2ZlcnMpLCB0cmFuc2ZlcnMgdG9rZW4gb3duZXJzaGlwIHRvIHRoZSBvd25lcgogICAgKi8KICAgIGZ1bmN0aW9uIGZpbmFsaXplQ3Jvd2RzYWxlKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmF0ZSA9IDA7ICAgLy90aGlzIG1ha2VzIGNyb3dkc2FsZU9wZW4oKSByZXR1cm4gZmFsc2U7CiAgICAgICAgdG9rZW4uZmluaXNoTWludGluZygpOwogICAgICAgIHRva2VuLnRyYW5zZmVyT3duZXJzaGlwKG93bmVyKTsKICAgICAgICBpZih0aGlzLmJhbGFuY2UgPiAwKSBvd25lci50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOyAgICAKICAgIH0KICAgIC8qKgogICAgKiBAbm90aWNlIENsYWltIGNvbGxlY3RlZCBldGhlciB3aXRob3V0IGNsb3NpbmcgY3Jvd2RzYWxlCiAgICAqLwogICAgZnVuY3Rpb24gY2xhaW1FdGhlcigpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIGlmKHRoaXMuYmFsYW5jZSA+IDApIG93bmVyLnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgICB9Cgp9'.
	

]
