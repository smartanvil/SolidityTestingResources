Class {
	#name : #SRTaac3090257be280087d8bdc530265203d105b120,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTaac3090257be280087d8bdc530265203d105b120 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgoKLyoqCiAqIE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MKICovCmxpYnJhcnkgU2FmZU1hdGggewogIGZ1bmN0aW9uIG11bCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgdWludCBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIGFzc2VydChiID4gMCk7CiAgICB1aW50IGMgPSBhIC8gYjsKICAgIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICB1aW50IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBtYXg2NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgewogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOwogIH0KCiAgZnVuY3Rpb24gbWluNjQodWludDY0IGEsIHVpbnQ2NCBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50NjQpIHsKICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOwogIH0KCiAgZnVuY3Rpb24gbWF4MjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7CiAgfQoKICBmdW5jdGlvbiBtaW4yNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOwogIH0KfQoKCi8vLyBAZGV2IGBPd25lZGAgaXMgYSBiYXNlIGxldmVsIGNvbnRyYWN0IHRoYXQgYXNzaWducyBhbiBgb3duZXJgIHRoYXQgY2FuIGJlCi8vLyAgbGF0ZXIgY2hhbmdlZApjb250cmFjdCBPd25lZCB7CgogICAgLy8vIEBkZXYgYG93bmVyYCBpcyB0aGUgb25seSBhZGRyZXNzIHRoYXQgY2FuIGNhbGwgYSBmdW5jdGlvbiB3aXRoIHRoaXMKICAgIC8vLyBtb2RpZmllcgogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgICAvLy8gQG5vdGljZSBUaGUgQ29uc3RydWN0b3IgYXNzaWducyB0aGUgbWVzc2FnZSBzZW5kZXIgdG8gYmUgYG93bmVyYAogICAgZnVuY3Rpb24gT3duZWQoKSB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIGFkZHJlc3MgcHVibGljIG5ld093bmVyOwoKICAgIC8vLyBAbm90aWNlIGBvd25lcmAgY2FuIHN0ZXAgZG93biBhbmQgYXNzaWduIHNvbWUgb3RoZXIgYWRkcmVzcyB0byB0aGlzIHJvbGUKICAgIC8vLyBAcGFyYW0gX25ld093bmVyIFRoZSBhZGRyZXNzIG9mIHRoZSBuZXcgb3duZXIuIDB4MCBjYW4gYmUgdXNlZCB0byBjcmVhdGUKICAgIC8vLyAgYW4gdW5vd25lZCBuZXV0cmFsIHZhdWx0LCBob3dldmVyIHRoYXQgY2Fubm90IGJlIHVuZG9uZQogICAgZnVuY3Rpb24gY2hhbmdlT3duZXIoYWRkcmVzcyBfbmV3T3duZXIpIG9ubHlPd25lciB7CiAgICAgICAgbmV3T3duZXIgPSBfbmV3T3duZXI7CiAgICB9CgoKICAgIGZ1bmN0aW9uIGFjY2VwdE93bmVyc2hpcCgpIHsKICAgICAgICBpZiAobXNnLnNlbmRlciA9PSBuZXdPd25lcikgewogICAgICAgICAgICBvd25lciA9IG5ld093bmVyOwogICAgICAgIH0KICAgIH0KfQoKCmNvbnRyYWN0IEVSQzIwUHJvdG9jb2wgewogICAgLyogVGhpcyBpcyBhIHNsaWdodCBjaGFuZ2UgdG8gdGhlIEVSQzIwIGJhc2Ugc3RhbmRhcmQuCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgc3VwcGx5KTsKICAgIGlzIHJlcGxhY2VkIHdpdGg6CiAgICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseTsKICAgIFRoaXMgYXV0b21hdGljYWxseSBjcmVhdGVzIGEgZ2V0dGVyIGZ1bmN0aW9uIGZvciB0aGUgdG90YWxTdXBwbHkuCiAgICBUaGlzIGlzIG1vdmVkIHRvIHRoZSBiYXNlIGNvbnRyYWN0IHNpbmNlIHB1YmxpYyBnZXR0ZXIgZnVuY3Rpb25zIGFyZSBub3QKICAgIGN1cnJlbnRseSByZWNvZ25pc2VkIGFzIGFuIGltcGxlbWVudGF0aW9uIG9mIHRoZSBtYXRjaGluZyBhYnN0cmFjdAogICAgZnVuY3Rpb24gYnkgdGhlIGNvbXBpbGVyLgogICAgKi8KICAgIC8vLyB0b3RhbCBhbW91bnQgb2YgdG9rZW5zCiAgICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBmcm9tIHdoaWNoIHRoZSBiYWxhbmNlIHdpbGwgYmUgcmV0cmlldmVkCiAgICAvLy8gQHJldHVybiBUaGUgYmFsYW5jZQogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IGJhbGFuY2UpOwoKICAgIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgbXNnLnNlbmRlcmAKICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQKICAgIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQKICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIHRyYW5zZmVyIHdhcyBzdWNjZXNzZnVsIG9yIG5vdAogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgX2Zyb21gIG9uIHRoZSBjb25kaXRpb24gaXQgaXMgYXBwcm92ZWQgYnkgYF9mcm9tYAogICAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyCiAgICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8vIEBub3RpY2UgYG1zZy5zZW5kZXJgIGFwcHJvdmVzIGBfc3BlbmRlcmAgdG8gc3BlbmQgYF92YWx1ZWAgdG9rZW5zCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2VucwogICAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgYXBwcm92ZWQgZm9yIHRyYW5zZmVyCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBhcHByb3ZhbCB3YXMgc3VjY2Vzc2Z1bCBvciBub3QKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgb3duaW5nIHRva2VucwogICAgLy8vIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBhYmxlIHRvIHRyYW5zZmVyIHRoZSB0b2tlbnMKICAgIC8vLyBAcmV0dXJuIEFtb3VudCBvZiByZW1haW5pbmcgdG9rZW5zIGFsbG93ZWQgdG8gc3BlbnQKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCByZW1haW5pbmcpOwoKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludCBfdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50IF92YWx1ZSk7Cn0KCgpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwUHJvdG9jb2wgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CgogICAgLyoqCiAgICAqIEBkZXYgRml4IGZvciB0aGUgRVJDMjAgc2hvcnQgYWRkcmVzcyBhdHRhY2suCiAgICAqLwogICAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgc2l6ZSkgewogICAgICAgIHJlcXVpcmUobXNnLmRhdGEubGVuZ3RoID49IHNpemUgKyA0KTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDIgKiAzMikgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgLy9EZWZhdWx0IGFzc3VtZXMgdG90YWxTdXBwbHkgY2FuJ3QgYmUgb3ZlciBtYXggKDJeMjU2IC0gMSkuCiAgICAgICAgLy9JZiB5b3VyIHRva2VuIGxlYXZlcyBvdXQgdG90YWxTdXBwbHkgYW5kIGNhbiBpc3N1ZSBtb3JlIHRva2VucyBhcyB0aW1lIGdvZXMgb24sIHlvdSBuZWVkIHRvIGNoZWNrIGlmIGl0IGRvZXNuJ3Qgd3JhcC4KICAgICAgICAvL1JlcGxhY2UgdGhlIGlmIHdpdGggdGhpcyBvbmUgaW5zdGVhZC4KICAgICAgICAvL2lmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+IGJhbGFuY2VzW190b10pIHsKICAgICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdIC09IF92YWx1ZTsKICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7CiAgICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDMgKiAzMikgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgLy9zYW1lIGFzIGFib3ZlLiBSZXBsYWNlIHRoaXMgbGluZSB3aXRoIHRoZSBmb2xsb3dpbmcgaWYgeW91IHdhbnQgdG8gcHJvdGVjdCBhZ2FpbnN0IHdyYXBwaW5nIHVpbnRzLgogICAgICAgIC8vaWYgKGJhbGFuY2VzW19mcm9tXSA+PSBfdmFsdWUgJiYgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIGJhbGFuY2VzW190b10gKyBfdmFsdWUgPiBiYWxhbmNlc1tfdG9dKSB7CiAgICAgICAgaWYgKGJhbGFuY2VzW19mcm9tXSA+PSBfdmFsdWUgJiYgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPj0gX3ZhbHVlKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW190b10gKz0gX3ZhbHVlOwogICAgICAgICAgICBiYWxhbmNlc1tfZnJvbV0gLT0gX3ZhbHVlOwogICAgICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICAgICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSB7IHJldHVybiBmYWxzZTsgfQogICAgfQoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDIgKiAzMikgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2AKICAgICAgICAvLyAgYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyBgYXBwcm92ZShfc3BlbmRlciwgMClgIGlmIGl0IGlzIG5vdAogICAgICAgIC8vICBhbHJlYWR5IDAgdG8gbWl0aWdhdGUgdGhlIHJhY2UgY29uZGl0aW9uIGRlc2NyaWJlZCBoZXJlOgogICAgICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgICAgIGFzc2VydCgoX3ZhbHVlID09IDApIHx8IChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9PSAwKSk7CgogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCByZW1haW5pbmcpIHsKICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgICB9CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBiYWxhbmNlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSkgYWxsb3dlZDsKfQoKLy8vIEB0aXRsZSBXYW5jaGFpbiBUb2tlbiBDb250cmFjdAovLy8gRm9yIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhpcyB0b2tlbiBzYWxlLCBwbGVhc2UgdmlzaXQgaHR0cHM6Ly93YW5jaGFpbi5vcmcKLy8vIEBhdXRob3IgQ2F0aHkgLSA8PHNwYW4gY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSI2YTA5MGIxZTAyMTMyYTFkMGIwNDA5MDIwYjAzMDQ0NDA1MTgwZCI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+CmNvbnRyYWN0IFdhblRva2VuIGlzIFN0YW5kYXJkVG9rZW4gewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CgogICAgLy8vIENvbnN0YW50IHRva2VuIHNwZWNpZmljIGZpZWxkcwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIldhbkNvaW4iOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiV0FOIjsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CgogICAgLy8vIFdhbmNoYWluIHRvdGFsIHRva2VucyBzdXBwbHkKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IE1BWF9UT1RBTF9UT0tFTl9BTU9VTlQgPSAyMTAwMDAwMDAgZXRoZXI7CgogICAgLy8vIEZpZWxkcyB0aGF0IGFyZSBvbmx5IGNoYW5nZWQgaW4gY29uc3RydWN0b3IKICAgIC8vLyBXYW5jaGFpbiBjb250cmlidXRpb24gY29udHJhY3QKICAgIGFkZHJlc3MgcHVibGljIG1pbnRlcjsgCiAgICAvLy8gSUNPIHN0YXJ0IHRpbWUKICAgIHVpbnQgcHVibGljIHN0YXJ0VGltZTsKICAgIC8vLyBJQ08gZW5kIHRpbWUKICAgIHVpbnQgcHVibGljIGVuZFRpbWU7CgogICAgLy8vIEZpZWxkcyB0aGF0IGNhbiBiZSBjaGFuZ2VkIGJ5IGZ1bmN0aW9ucwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgbG9ja2VkQmFsYW5jZXM7CiAgICAvKgogICAgICogTU9ESUZJRVJTCiAgICAgKi8KCiAgICBtb2RpZmllciBvbmx5TWludGVyIHsKICAgICAgICBhc3NlcnQobXNnLnNlbmRlciA9PSBtaW50ZXIpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgaXNMYXRlclRoYW4gKHVpbnQgeCl7CiAgICAgICAgYXNzZXJ0KG5vdyA+IHgpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgbWF4V2FuVG9rZW5BbW91bnROb3RSZWFjaGVkICh1aW50IGFtb3VudCl7CiAgICAgICAgYXNzZXJ0KHRvdGFsU3VwcGx5LmFkZChhbW91bnQpIDw9IE1BWF9UT1RBTF9UT0tFTl9BTU9VTlQpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBDT05TVFJVQ1RPUiAKICAgICAqIAogICAgICogQGRldiBJbml0aWFsaXplIHRoZSBXYW5jaGFpbiBUb2tlbgogICAgICogQHBhcmFtIF9taW50ZXIgVGhlIFdhbmNoYWluIENvbnRyaWJ1dGlvbiBDb250cmFjdCAgICAgCiAgICAgKiBAcGFyYW0gX3N0YXJ0VGltZSBJQ08gc3RhcnQgdGltZQogICAgICogQHBhcmFtIF9lbmRUaW1lIElDTyBFbmQgVGltZQogICAgICovCiAgICBmdW5jdGlvbiBXYW5Ub2tlbihhZGRyZXNzIF9taW50ZXIsIHVpbnQgX3N0YXJ0VGltZSwgdWludCBfZW5kVGltZSl7CiAgICAgICAgbWludGVyID0gX21pbnRlcjsKICAgICAgICBzdGFydFRpbWUgPSBfc3RhcnRUaW1lOwogICAgICAgIGVuZFRpbWUgPSBfZW5kVGltZTsKICAgIH0KCiAgICAvKioKICAgICAqIEVYVEVSTkFMIEZVTkNUSU9OIAogICAgICogCiAgICAgKiBAZGV2IENvbnRyaWJ1dGlvbiBjb250cmFjdCBpbnN0YW5jZSBtaW50IHRva2VuCiAgICAgKiBAcGFyYW0gcmVjZWlwZW50IFRoZSBkZXN0aW5hdGlvbiBhY2NvdW50IG93bmVkIG1pbnQgdG9rZW5zICAgIAogICAgICogQHBhcmFtIGFtb3VudCBUaGUgYW1vdW50IG9mIG1pbnQgdG9rZW4KICAgICAqIGJlIHNlbnQgdG8gdGhpcyBhZGRyZXNzLgogICAgICovICAgIAogICAgZnVuY3Rpb24gbWludFRva2VuKGFkZHJlc3MgcmVjZWlwZW50LCB1aW50IGFtb3VudCkKICAgICAgICBleHRlcm5hbAogICAgICAgIG9ubHlNaW50ZXIKICAgICAgICBtYXhXYW5Ub2tlbkFtb3VudE5vdFJlYWNoZWQoYW1vdW50KQogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmVxdWlyZShub3cgPD0gZW5kVGltZSk7CiAgICAgICAgbG9ja2VkQmFsYW5jZXNbcmVjZWlwZW50XSA9IGxvY2tlZEJhbGFuY2VzW3JlY2VpcGVudF0uYWRkKGFtb3VudCk7CiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoYW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKgogICAgICogUFVCTElDIEZVTkNUSU9OUwogICAgICovCgogICAgLy8vIEBkZXYgTG9ja2luZyBwZXJpb2QgaGFzIHBhc3NlZCAtIExvY2tlZCB0b2tlbnMgaGF2ZSB0dXJuZWQgaW50byB0cmFkZWFibGUKICAgIC8vLyAgICAgIEFsbCB0b2tlbnMgb3duZWQgYnkgcmVjZWlwZW50IHdpbGwgYmUgdHJhZGVhYmxlCiAgICBmdW5jdGlvbiBjbGFpbVRva2VucyhhZGRyZXNzIHJlY2VpcGVudCkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5TWludGVyCiAgICB7CiAgICAgICAgYmFsYW5jZXNbcmVjZWlwZW50XSA9IGJhbGFuY2VzW3JlY2VpcGVudF0uYWRkKGxvY2tlZEJhbGFuY2VzW3JlY2VpcGVudF0pOwogICAgICAgIGxvY2tlZEJhbGFuY2VzW3JlY2VpcGVudF0gPSAwOwogICAgfQoKICAgIC8qCiAgICAgKiBDT05TVEFOVCBNRVRIT0RTCiAgICAgKi8KICAgIGZ1bmN0aW9uIGxvY2tlZEJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGxvY2tlZEJhbGFuY2VzW19vd25lcl07CiAgICB9Cn0KCi8vLyBAdGl0bGUgV2FuY2hhaW4gQ29udHJpYnV0aW9uIENvbnRyYWN0Ci8vLyBJQ08gUnVsZXMgYWNjb3JkaW5nOiBodHRwczovL3d3dy53YW5jaGFpbi5vcmcvY3Jvd2RzYWxlCi8vLyBGb3IgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCB0aGlzIHRva2VuIHNhbGUsIHBsZWFzZSB2aXNpdCBodHRwczovL3dhbmNoYWluLm9yZwovLy8gQGF1dGhvciBaYW5lIExpYW5nIC0gPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iNmQxNzBjMDMwODAxMDQwYzAzMGEyZDFhMGMwMzBlMDUwYzA0MDM0MzAyMWYwYSI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+CmNvbnRyYWN0IFdhbmNoYWluQ29udHJpYnV0aW9uIGlzIE93bmVkIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwoKICAgIC8vLyBDb25zdGFudCBmaWVsZHMKICAgIC8vLyBXYW5jaGFpbiB0b3RhbCB0b2tlbnMgc3VwcGx5CiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBXQU5fVE9UQUxfU1VQUExZID0gMjEwMDAwMDAwIGV0aGVyOwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgRUFSTFlfQ09OVFJJQlVUSU9OX0RVUkFUSU9OID0gMjQgaG91cnM7CiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBNQVhfQ09OVFJJQlVUSU9OX0RVUkFUSU9OID0gMyB3ZWVrczsKCiAgICAvLy8gRXhjaGFuZ2UgcmF0ZXMgZm9yIGZpcnN0IHBoYXNlCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBQUklDRV9SQVRFX0ZJUlNUID0gODgwOwogICAgLy8vIEV4Y2hhbmdlIHJhdGVzIGZvciBzZWNvbmQgcGhhc2UKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFBSSUNFX1JBVEVfU0VDT05EID0gNzkwOwogICAgLy8vIEV4Y2hhbmdlIHJhdGVzIGZvciBsYXN0IHBoYXNlCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBQUklDRV9SQVRFX0xBU1QgPSA3NTA7CgogICAgLy8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vLyB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgICB8ICAgICAgICB8CiAgICAvLy8gfCAgICAgICAgUFVCTElDIFNBTEUgKFBSRVNBTEUgKyBPUEVOIFNBTEUpICAgICAgICAgfCAgICAgIERFViBURUFNICAgICAgfCAgICBGT1VOREFUSU9OICAgfCAgTUlORVIgfAogICAgLy8vIHwgICAgICAgICAgICAgICAgICAgICAgIDUxJSAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAyMCUgICAgICAgIHwgICAgICAgMTklICAgICAgIHwgICAxMCUgIHwgICAgCiAgICAvLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAvLy8gT1BFTl9TQUxFX1NUQUtFICsgUFJFU0FMRV9TVEFLRSA9IDUxOyA1MSUgc2FsZSBmb3IgcHVibGljCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBPUEVOX1NBTEVfU1RBS0UgPSA1MTA7ICAvLyA1MSUgZm9yIG9wZW4gc2FsZQoKICAgIC8vIFJlc2VydmVkIHN0YWtlcwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgREVWX1RFQU1fU1RBS0UgPSAyMDA7ICAgLy8gMjAlCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBGT1VOREFUSU9OX1NUQUtFID0gMTkwOyAvLyAxOSUKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IE1JTkVSU19TVEFLRSA9IDEwMDsgICAgIC8vIDEwJQoKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IERJVklTT1JfU1RBS0UgPSAxMDAwOwoKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFBSRVNBTEVfUkVTRVJWRVJFRF9BTU9VTlQgPSA0MTUwNjY1NSBldGhlcjsgLy9wcmVzYWxlIHByaXplIGFtb3VudCg0MDAwMCo4ODApCiAgCiAgICAvLy8gSG9sZGVyIGFkZHJlc3MgZm9yIHByZXNhbGUgYW5kIHJlc2VydmVkIHRva2VucwogICAgLy8vIFRPRE86IGNoYW5nZSBhZGRyZXNzZWQgYmVmb3JlIGRlcGxveWVkIHRvIG1haW4gbmV0CgogICAgLy8gQWRkcmVzc2VzIG9mIFBhdHJvbnMKICAgIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IERFVl9URUFNX0hPTERFUiA9IDB4MDAwMWNkQzY5YjFlYjhiQ0NFMjkzMTFDMDEwOTJCZGNjOTJmOGY4RjsKICAgIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IEZPVU5EQVRJT05fSE9MREVSID0gMHgwMGRCNDAyM2IzMjAwOEM0NUU2MkFkZDU3RGUyNTZhOTM5OTc1MkQ0OwogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgTUlORVJTX0hPTERFUiA9IDB4MDBmODcwRDExZUE0M0FBMWM0QzcxNWM2MWRDMDQ1RTMyZDIzMjc4NzsKICAgIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IFBSRVNBTEVfSE9MREVSID0gMHgwMDU3N2MyNUE4MWZBMjQwMUM1MjQ2RjRhN0Q1ZWJhRmZBNGIwMEFhOwogIAogICAgdWludCBwdWJsaWMgTUFYX09QRU5fU09MRCA9IFdBTl9UT1RBTF9TVVBQTFkgKiBPUEVOX1NBTEVfU1RBS0UgLyBESVZJU09SX1NUQUtFIC0gUFJFU0FMRV9SRVNFUlZFUkVEX0FNT1VOVDsKCiAgICAvLy8gRmllbGRzIHRoYXQgYXJlIG9ubHkgY2hhbmdlZCBpbiBjb25zdHJ1Y3RvciAgICAKICAgIC8vLyBBbGwgZGVwb3NpdGVkIEVUSCB3aWxsIGJlIGluc3RhbnRseSBmb3J3YXJkZWQgdG8gdGhpcyBhZGRyZXNzLgogICAgYWRkcmVzcyBwdWJsaWMgd2FucG9ydDsKICAgIC8vLyBFYXJseSBBZG9wdGVycyByZXNlcnZlZCBzdGFydCB0aW1lCiAgICB1aW50IHB1YmxpYyBlYXJseVJlc2VydmVCZWdpblRpbWU7CiAgICAvLy8gQ29udHJpYnV0aW9uIHN0YXJ0IHRpbWUKICAgIHVpbnQgcHVibGljIHN0YXJ0VGltZTsKICAgIC8vLyBDb250cmlidXRpb24gZW5kIHRpbWUKICAgIHVpbnQgcHVibGljIGVuZFRpbWU7CgogICAgLy8vIEZpZWxkcyB0aGF0IGNhbiBiZSBjaGFuZ2VkIGJ5IGZ1bmN0aW9ucwogICAgLy8vIEFjY3VtdWxhdG9yIGZvciBvcGVuIHNvbGQgdG9rZW5zCiAgICB1aW50IHB1YmxpYyBvcGVuU29sZFRva2VuczsKICAgIC8vLyBEdWUgdG8gYW4gZW1lcmdlbmN5LCBzZXQgdGhpcyB0byB0cnVlIHRvIGhhbHQgdGhlIGNvbnRyaWJ1dGlvbgogICAgYm9vbCBwdWJsaWMgaGFsdGVkOyAKICAgIC8vLyBFUkMyMCBjb21waWxhbnQgd2FuY2hhaW4gdG9rZW4gY29udGFjdCBpbnN0YW5jZQogICAgV2FuVG9rZW4gcHVibGljIHdhblRva2VuOyAKCiAgICAvLy8gUXVvdGEgZm9yIGVhcmx5IGFkb3B0ZXJzIHNhbGUsIFF1b3RhCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBlYXJseVVzZXJRdW90YXM7CiAgICAvLy8gdGFncyBzaG93IGFkZHJlc3MgY2FuIGpvaW4gaW4gb3BlbiBzYWxlCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBmdWxsV2hpdGVMaXN0OwoKICAgIHVpbnQyNTYgcHVibGljIG5vcm1hbEJ1eUxpbWl0ID0gNjUgZXRoZXI7CgogICAgLyoKICAgICAqIEVWRU5UUwogICAgICovCgogICAgZXZlbnQgTmV3U2FsZShhZGRyZXNzIGluZGV4ZWQgZGVzdEFkZHJlc3MsIHVpbnQgZXRoQ29zdCwgdWludCBnb3RUb2tlbnMpOwogICAgLy9ldmVudCBQYXJ0bmVyQWRkcmVzc1F1b3RhKGFkZHJlc3MgaW5kZXhlZCBwYXJ0bmVyQWRkcmVzcywgdWludCBxdW90YSk7CgogICAgLyoKICAgICAqIE1PRElGSUVSUwogICAgICovCgogICAgbW9kaWZpZXIgb25seVdhbGxldCB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHdhbnBvcnQpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgbm90SGFsdGVkKCkgewogICAgICAgIHJlcXVpcmUoIWhhbHRlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBpbml0aWFsaXplZCgpIHsKICAgICAgICByZXF1aXJlKGFkZHJlc3Mod2FucG9ydCkgIT0gMHgwKTsKICAgICAgICBfOwogICAgfSAgICAKCiAgICBtb2RpZmllciBub3RFYXJsaWVyVGhhbih1aW50IHgpIHsKICAgICAgICByZXF1aXJlKG5vdyA+PSB4KTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIGVhcmxpZXJUaGFuKHVpbnQgeCkgewogICAgICAgIHJlcXVpcmUobm93IDwgeCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBjZWlsaW5nTm90UmVhY2hlZCgpIHsKICAgICAgICByZXF1aXJlKG9wZW5Tb2xkVG9rZW5zIDwgTUFYX09QRU5fU09MRCk7CiAgICAgICAgXzsKICAgIH0gIAoKICAgIG1vZGlmaWVyIGlzU2FsZUVuZGVkKCkgewogICAgICAgIHJlcXVpcmUobm93ID4gZW5kVGltZSB8fCBvcGVuU29sZFRva2VucyA+PSBNQVhfT1BFTl9TT0xEKTsKICAgICAgICBfOwogICAgfQoKCiAgICAvKioKICAgICAqIENPTlNUUlVDVE9SIAogICAgICogCiAgICAgKiBAZGV2IEluaXRpYWxpemUgdGhlIFdhbmNoYWluIGNvbnRyaWJ1dGlvbiBjb250cmFjdAogICAgICogQHBhcmFtIF93YW5wb3J0IFRoZSBlc2Nyb3cgYWNjb3VudCBhZGRyZXNzLCBhbGwgZXRoZXJzIHdpbGwgYmUgc2VudCB0byB0aGlzIGFkZHJlc3MuCiAgICAgKiBAcGFyYW0gX2Jvb3RUaW1lIElDTyBib290IHRpbWUKICAgICAqLwogICAgZnVuY3Rpb24gV2FuY2hhaW5Db250cmlidXRpb24oYWRkcmVzcyBfd2FucG9ydCwgdWludCBfYm9vdFRpbWUpewogICAgICByZXF1aXJlKF93YW5wb3J0ICE9IDB4MCk7CgogICAgICAgIGhhbHRlZCA9IGZhbHNlOwogICAgICB3YW5wb3J0ID0gX3dhbnBvcnQ7CiAgICAgICAgZWFybHlSZXNlcnZlQmVnaW5UaW1lID0gX2Jvb3RUaW1lOwogICAgICBzdGFydFRpbWUgPSBlYXJseVJlc2VydmVCZWdpblRpbWUgKyBFQVJMWV9DT05UUklCVVRJT05fRFVSQVRJT047CiAgICAgIGVuZFRpbWUgPSBzdGFydFRpbWUgKyBNQVhfQ09OVFJJQlVUSU9OX0RVUkFUSU9OOwogICAgICAgIG9wZW5Tb2xkVG9rZW5zID0gMDsKICAgICAgICAvLy8gQ3JlYXRlIHdhbmNoYWluIHRva2VuIGNvbnRyYWN0IGluc3RhbmNlCiAgICAgIHdhblRva2VuID0gbmV3IFdhblRva2VuKHRoaXMsc3RhcnRUaW1lLCBlbmRUaW1lKTsKCiAgICAgICAgLy8vIFJlc2VydmUgdG9rZW5zIGFjY29yZGluZyB3YW5jaGFpbiBJQ08gcnVsZXMKICAgICAgdWludCBzdGFrZU11bHRpcGxpZXIgPSBXQU5fVE9UQUxfU1VQUExZIC8gRElWSVNPUl9TVEFLRTsKICAgIAogICAgICAgIHdhblRva2VuLm1pbnRUb2tlbihERVZfVEVBTV9IT0xERVIsIERFVl9URUFNX1NUQUtFICogc3Rha2VNdWx0aXBsaWVyKTsKICAgICAgICB3YW5Ub2tlbi5taW50VG9rZW4oRk9VTkRBVElPTl9IT0xERVIsIEZPVU5EQVRJT05fU1RBS0UgKiBzdGFrZU11bHRpcGxpZXIpOwogICAgICAgIHdhblRva2VuLm1pbnRUb2tlbihNSU5FUlNfSE9MREVSLCBNSU5FUlNfU1RBS0UgKiBzdGFrZU11bHRpcGxpZXIpOwogICAgCiAgICAgICAgd2FuVG9rZW4ubWludFRva2VuKFBSRVNBTEVfSE9MREVSLCBQUkVTQUxFX1JFU0VSVkVSRURfQU1PVU5UKTsgICAgCiAgICAKICAgIH0KCiAgICAvKioKICAgICAqIEZhbGxiYWNrIGZ1bmN0aW9uIAogICAgICogCiAgICAgKiBAZGV2IElmIGFueWJvZHkgc2VuZHMgRXRoZXIgZGlyZWN0bHkgdG8gdGhpcyAgY29udHJhY3QsIGNvbnNpZGVyIGhlIGlzIGdldHRpbmcgd2FuIHRva2VuCiAgICAgKi8KICAgIGZ1bmN0aW9uICgpIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgYnV5V2FuQ29pbihtc2cuc2VuZGVyKTsKICAgIH0KCiAgICAvKgogICAgICogUFVCTElDIEZVTkNUSU9OUwogICAgICovCgogICAgLy8vIEBkZXYgRXhjaGFuZ2UgbXNnLnZhbHVlIGV0aGVyIHRvIFdBTiBmb3IgYWNjb3VudCByZWNlcGllbnQKICAgIC8vLyBAcGFyYW0gcmVjZWlwaWVudCBXQU4gdG9rZW5zIHJlY2VpdmVyCiAgICBmdW5jdGlvbiBidXlXYW5Db2luKGFkZHJlc3MgcmVjZWlwaWVudCkgCiAgICAgICAgcHVibGljIAogICAgICAgIHBheWFibGUgCiAgICAgICAgbm90SGFsdGVkIAogICAgICAgIGluaXRpYWxpemVkIAogICAgICAgIGNlaWxpbmdOb3RSZWFjaGVkIAogICAgICAgIG5vdEVhcmxpZXJUaGFuKGVhcmx5UmVzZXJ2ZUJlZ2luVGltZSkKICAgICAgICBlYXJsaWVyVGhhbihlbmRUaW1lKQogICAgICAgIHJldHVybnMgKGJvb2wpIAogICAgewogICAgICAgIHJlcXVpcmUocmVjZWlwaWVudCAhPSAweDApOwogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID49IDAuMSBldGhlcik7CgogICAgICAgIC8vIERvIG5vdCBhbGxvdyBjb250cmFjdHMgdG8gZ2FtZSB0aGUgc3lzdGVtCiAgICAgICAgcmVxdWlyZSghaXNDb250cmFjdChtc2cuc2VuZGVyKSk7ICAgICAgICAKCiAgICAgICAgaWYoIG5vdyA8IHN0YXJ0VGltZSAmJiBub3cgPj0gZWFybHlSZXNlcnZlQmVnaW5UaW1lKQogICAgICAgICAgICBidXlFYXJseUFkb3B0ZXJzKHJlY2VpcGllbnQpOwogICAgICAgIGVsc2UgewogICAgICAgICAgICByZXF1aXJlKCB0eC5nYXNwcmljZSA8PSA1MDAwMDAwMDAwMCB3ZWkgKTsKICAgICAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPD0gbm9ybWFsQnV5TGltaXQpOwogICAgICAgICAgICBidXlOb3JtYWwocmVjZWlwaWVudCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXROb3JtYWxCdXlMaW1pdCh1aW50MjU2IGxpbWl0KQogICAgICAgIHB1YmxpYwogICAgICAgIGluaXRpYWxpemVkCiAgICAgICAgb25seU93bmVyCiAgICAgICAgZWFybGllclRoYW4oZW5kVGltZSkKICAgIHsKICAgICAgICBub3JtYWxCdXlMaW1pdCA9IGxpbWl0OwogICAgfQoKCiAgICAvLy8gQGRldiBiYXRjaCBzZXQgcXVvdGEgZm9yIGVhcmx5IHVzZXIgcXVvdGEKICAgIGZ1bmN0aW9uIHNldEVhcmx5V2hpdGVsaXN0UXVvdGFzKGFkZHJlc3NbXSB1c2VycywgdWludCBlYXJseUNhcCwgdWludCBvcGVuVGFnKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlPd25lcgogICAgICAgIGVhcmxpZXJUaGFuKGVhcmx5UmVzZXJ2ZUJlZ2luVGltZSkKICAgIHsKICAgICAgICBmb3IoIHVpbnQgaSA9IDA7IGkgPCB1c2Vycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBlYXJseVVzZXJRdW90YXNbdXNlcnNbaV1dID0gZWFybHlDYXA7CiAgICAgICAgICAgIGZ1bGxXaGl0ZUxpc3RbdXNlcnNbaV1dID0gb3BlblRhZzsKICAgICAgICB9CiAgICB9CgogICAgLy8vIEBkZXYgYmF0Y2ggc2V0IHF1b3RhIGZvciBlYXJseSB1c2VyIHF1b3RhCiAgICBmdW5jdGlvbiBzZXRMYXRlcldoaXRlTGlzdChhZGRyZXNzW10gdXNlcnMsIHVpbnQgb3BlblRhZykKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5T3duZXIKICAgICAgICBlYXJsaWVyVGhhbihlbmRUaW1lKQogICAgewogICAgICAgIHJlcXVpcmUoc2FsZU5vdEVuZCgpKTsKICAgICAgICBmb3IoIHVpbnQgaSA9IDA7IGkgPCB1c2Vycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBmdWxsV2hpdGVMaXN0W3VzZXJzW2ldXSA9IG9wZW5UYWc7CiAgICAgICAgfQogICAgfQoKICAgIC8vLyBAZGV2IEVtZXJnZW5jeSBzaXR1YXRpb24gdGhhdCByZXF1aXJlcyBjb250cmlidXRpb24gcGVyaW9kIHRvIHN0b3AuCiAgICAvLy8gQ29udHJpYnV0aW5nIG5vdCBwb3NzaWJsZSBhbnltb3JlLgogICAgZnVuY3Rpb24gaGFsdCgpIHB1YmxpYyBvbmx5V2FsbGV0ewogICAgICAgIGhhbHRlZCA9IHRydWU7CiAgICB9CgogICAgLy8vIEBkZXYgRW1lcmdlbmN5IHNpdHVhdGlvbiByZXNvbHZlZC4KICAgIC8vLyBDb250cmlidXRpbmcgYmVjb21lcyBwb3NzaWJsZSBhZ2FpbiB3aXRoaW5nIHRoZSBvdXRsaW5lZCByZXN0cmljdGlvbnMuCiAgICBmdW5jdGlvbiB1bkhhbHQoKSBwdWJsaWMgb25seVdhbGxldHsKICAgICAgICBoYWx0ZWQgPSBmYWxzZTsKICAgIH0KCiAgICAvLy8gQGRldiBFbWVyZ2VuY3kgc2l0dWF0aW9uCiAgICBmdW5jdGlvbiBjaGFuZ2VXYWxsZXRBZGRyZXNzKGFkZHJlc3MgbmV3QWRkcmVzcykgb25seVdhbGxldCB7IAogICAgICAgIHdhbnBvcnQgPSBuZXdBZGRyZXNzOyAKICAgIH0KCiAgICAvLy8gQHJldHVybiB0cnVlIGlmIHNhbGUgbm90IGVuZGVkLCBmYWxzZSBvdGhlcndpc2UuCiAgICBmdW5jdGlvbiBzYWxlTm90RW5kKCkgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBub3cgPCBlbmRUaW1lICYmIG9wZW5Tb2xkVG9rZW5zIDwgTUFYX09QRU5fU09MRDsKICAgIH0KCiAgICAvLy8gQ09OU1RBTlQgTUVUSE9EUwogICAgLy8vIEBkZXYgR2V0IGN1cnJlbnQgZXhjaGFuZ2UgcmF0ZQogICAgZnVuY3Rpb24gcHJpY2VSYXRlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICAvLyBUaHJlZSBwcmljZSB0aWVycwogICAgICAgIGlmIChlYXJseVJlc2VydmVCZWdpblRpbWUgPD0gbm93ICYmIG5vdyA8IHN0YXJ0VGltZSArIDEgd2Vla3MpCiAgICAgICAgICAgIHJldHVybiBQUklDRV9SQVRFX0ZJUlNUOwogICAgICAgIGlmIChzdGFydFRpbWUgKyAxIHdlZWtzIDw9IG5vdyAmJiBub3cgPCBzdGFydFRpbWUgKyAyIHdlZWtzKQogICAgICAgICAgICByZXR1cm4gUFJJQ0VfUkFURV9TRUNPTkQ7CiAgICAgICAgaWYgKHN0YXJ0VGltZSArIDIgd2Vla3MgPD0gbm93ICYmIG5vdyA8IGVuZFRpbWUpCiAgICAgICAgICAgIHJldHVybiBQUklDRV9SQVRFX0xBU1Q7CiAgICAgICAgLy8gU2hvdWxkIG5vdCBiZSBjYWxsZWQgYmVmb3JlIG9yIGFmdGVyIGNvbnRyaWJ1dGlvbiBwZXJpb2QKICAgICAgICBhc3NlcnQoZmFsc2UpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNsYWltVG9rZW5zKGFkZHJlc3MgcmVjZWlwZW50KQogICAgICAgIHB1YmxpYwogICAgICAgIGlzU2FsZUVuZGVkCiAgICB7CiAgICAgICAgd2FuVG9rZW4uY2xhaW1Ub2tlbnMocmVjZWlwZW50KTsKICAgIH0KCiAgICAvKgogICAgICogSU5URVJOQUwgRlVOQ1RJT05TCiAgICAgKi8KCiAgICAvLy8gQGRldiBCdXkgd2FuY2hhaW4gdG9rZW5zIGZvciBlYXJseSBhZG9wdGVycwogICAgZnVuY3Rpb24gYnV5RWFybHlBZG9wdGVycyhhZGRyZXNzIHJlY2VpcGllbnQpIGludGVybmFsIHsKICAgICAgdWludCBxdW90YUF2YWlsYWJsZSA9IGVhcmx5VXNlclF1b3Rhc1tyZWNlaXBpZW50XTsKICAgICAgcmVxdWlyZShxdW90YUF2YWlsYWJsZSA+IDApOwoKICAgICAgICB1aW50IHRvRnVuZCA9IHF1b3RhQXZhaWxhYmxlLm1pbjI1Nihtc2cudmFsdWUpOwogICAgICAgIHVpbnQgdG9rZW5BdmFpbGFibGU0QWRvcHRlciA9IHRvRnVuZC5tdWwoUFJJQ0VfUkFURV9GSVJTVCk7CgogICAgICBlYXJseVVzZXJRdW90YXNbcmVjZWlwaWVudF0gPSBlYXJseVVzZXJRdW90YXNbcmVjZWlwaWVudF0uc3ViKHRvRnVuZCk7CiAgICAgIGJ1eUNvbW1vbihyZWNlaXBpZW50LCB0b0Z1bmQsIHRva2VuQXZhaWxhYmxlNEFkb3B0ZXIpOwogICAgfQoKICAgIC8vLyBAZGV2IEJ1eSB3YW5jaGFpbiB0b2tlbiBub3JtYWxseQogICAgZnVuY3Rpb24gYnV5Tm9ybWFsKGFkZHJlc3MgcmVjZWlwaWVudCkgaW50ZXJuYWwgewogICAgICAgIHVpbnQgaW5XaGl0ZUxpc3RUYWcgPSBmdWxsV2hpdGVMaXN0W3JlY2VpcGllbnRdOwogICAgICAgIHJlcXVpcmUoaW5XaGl0ZUxpc3RUYWcgPiAwKTsKCiAgICAgICAgLy8gcHJvdGVjdCBwYXJ0bmVyIHF1b3RhIGluIHN0YWdlIG9uZQogICAgICAgIHVpbnQgdG9rZW5BdmFpbGFibGUgPSBNQVhfT1BFTl9TT0xELnN1YihvcGVuU29sZFRva2Vucyk7CiAgICAgICAgcmVxdWlyZSh0b2tlbkF2YWlsYWJsZSA+IDApOwoKICAgICAgdWludCB0b0Z1bmQ7CiAgICAgIHVpbnQgdG9Db2xsZWN0OwogICAgICAodG9GdW5kLCB0b0NvbGxlY3QpID0gY29zdEFuZEJ1eVRva2Vucyh0b2tlbkF2YWlsYWJsZSk7CiAgICAgICAgYnV5Q29tbW9uKHJlY2VpcGllbnQsIHRvRnVuZCwgdG9Db2xsZWN0KTsKICAgIH0KCiAgICAvLy8gQGRldiBVdGlsaXR5IGZ1bmN0aW9uIGZvciBidWcgd2FuY2hhaW4gdG9rZW4KICAgIGZ1bmN0aW9uIGJ1eUNvbW1vbihhZGRyZXNzIHJlY2VpcGllbnQsIHVpbnQgdG9GdW5kLCB1aW50IHdhblRva2VuQ29sbGVjdCkgaW50ZXJuYWwgewogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID49IHRvRnVuZCk7IC8vIGRvdWJsZSBjaGVjawoKICAgICAgICBpZih0b0Z1bmQgPiAwKSB7CiAgICAgICAgICAgIHJlcXVpcmUod2FuVG9rZW4ubWludFRva2VuKHJlY2VpcGllbnQsIHdhblRva2VuQ29sbGVjdCkpOyAgICAgICAgIAogICAgICAgICAgICB3YW5wb3J0LnRyYW5zZmVyKHRvRnVuZCk7CiAgICAgICAgICAgIG9wZW5Tb2xkVG9rZW5zID0gb3BlblNvbGRUb2tlbnMuYWRkKHdhblRva2VuQ29sbGVjdCk7CiAgICAgICAgICAgIE5ld1NhbGUocmVjZWlwaWVudCwgdG9GdW5kLCB3YW5Ub2tlbkNvbGxlY3QpOyAgICAgICAgICAgIAogICAgICAgIH0KCiAgICAgICAgdWludCB0b1JldHVybiA9IG1zZy52YWx1ZS5zdWIodG9GdW5kKTsKICAgICAgICBpZih0b1JldHVybiA+IDApIHsKICAgICAgICAgICAgbXNnLnNlbmRlci50cmFuc2Zlcih0b1JldHVybik7CiAgICAgICAgfQogICAgfQoKICAgIC8vLyBAZGV2IFV0aWxpdHkgZnVuY3Rpb24gZm9yIGNhbGN1bGF0ZSBhdmFpbGFibGUgdG9rZW5zIGFuZCBjb3N0IGV0aGVycwogICAgZnVuY3Rpb24gY29zdEFuZEJ1eVRva2Vucyh1aW50IGF2YWlsYWJsZVRva2VuKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50IGNvc3RWYWx1ZSwgdWludCBnZXRUb2tlbnMpewogICAgICAvLyBhbGwgY29uZGl0aW9ucyBoYXMgY2hlY2tlZCBpbiB0aGUgY2FsbGVyIGZ1bmN0aW9ucwogICAgICB1aW50IGV4Y2hhbmdlUmF0ZSA9IHByaWNlUmF0ZSgpOwogICAgICBnZXRUb2tlbnMgPSBleGNoYW5nZVJhdGUgKiBtc2cudmFsdWU7CgogICAgICBpZihhdmFpbGFibGVUb2tlbiA+PSBnZXRUb2tlbnMpewogICAgICAgIGNvc3RWYWx1ZSA9IG1zZy52YWx1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb3N0VmFsdWUgPSBhdmFpbGFibGVUb2tlbiAvIGV4Y2hhbmdlUmF0ZTsKICAgICAgICBnZXRUb2tlbnMgPSBhdmFpbGFibGVUb2tlbjsKICAgICAgfQogICAgfQoKICAgIC8vLyBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIGRldGVybWluZSBpZiBhbiBhZGRyZXNzIGlzIGEgY29udHJhY3QKICAgIC8vLyBAcGFyYW0gX2FkZHIgVGhlIGFkZHJlc3MgYmVpbmcgcXVlcmllZAogICAgLy8vIEByZXR1cm4gVHJ1ZSBpZiBgX2FkZHJgIGlzIGEgY29udHJhY3QKICAgIGZ1bmN0aW9uIGlzQ29udHJhY3QoYWRkcmVzcyBfYWRkcikgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyhib29sKSB7CiAgICAgICAgdWludCBzaXplOwogICAgICAgIGlmIChfYWRkciA9PSAwKSByZXR1cm4gZmFsc2U7CiAgICAgICAgYXNzZW1ibHkgewogICAgICAgICAgICBzaXplIDo9IGV4dGNvZGVzaXplKF9hZGRyKQogICAgICAgIH0KICAgICAgICByZXR1cm4gc2l6ZSA+IDA7CiAgICB9Cn0='.
	

]
