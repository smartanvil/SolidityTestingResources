Class {
	#name : #SRT95408930d6323ac7aa69e6c2cbfe58774d565fa8,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT95408930d6323ac7aa69e6c2cbfe58774d565fa8 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7CgovKgogICAgT3ZlcmZsb3cgcHJvdGVjdGVkIG1hdGggZnVuY3Rpb25zCiovCmNvbnRyYWN0IFNhZmVNYXRoIHsKICAgIC8qKgogICAgICAgIGNvbnN0cnVjdG9yCiAgICAqLwogICAgZnVuY3Rpb24gU2FmZU1hdGgoKSB7CiAgICB9CgogICAgLyoqCiAgICAgICAgQGRldiByZXR1cm5zIHRoZSBzdW0gb2YgX3ggYW5kIF95LCBhc3NlcnRzIGlmIHRoZSBjYWxjdWxhdGlvbiBvdmVyZmxvd3MKCiAgICAgICAgQHBhcmFtIF94ICAgdmFsdWUgMQogICAgICAgIEBwYXJhbSBfeSAgIHZhbHVlIDIKCiAgICAgICAgQHJldHVybiBzdW0KICAgICovCiAgICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQyNTYgX3gsIHVpbnQyNTYgX3kpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IHogPSBfeCArIF95OwogICAgICAgIGFzc2VydCh6ID49IF94KTsKICAgICAgICByZXR1cm4gejsKICAgIH0KCiAgICAvKioKICAgICAgICBAZGV2IHJldHVybnMgdGhlIGRpZmZlcmVuY2Ugb2YgX3ggbWludXMgX3ksIGFzc2VydHMgaWYgdGhlIHN1YnRyYWN0aW9uIHJlc3VsdHMgaW4gYSBuZWdhdGl2ZSBudW1iZXIKCiAgICAgICAgQHBhcmFtIF94ICAgbWludWVuZAogICAgICAgIEBwYXJhbSBfeSAgIHN1YnRyYWhlbmQKCiAgICAgICAgQHJldHVybiBkaWZmZXJlbmNlCiAgICAqLwogICAgZnVuY3Rpb24gc2FmZVN1Yih1aW50MjU2IF94LCB1aW50MjU2IF95KSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgYXNzZXJ0KF94ID49IF95KTsKICAgICAgICByZXR1cm4gX3ggLSBfeTsKICAgIH0KCiAgICAvKioKICAgICAgICBAZGV2IHJldHVybnMgdGhlIHByb2R1Y3Qgb2YgbXVsdGlwbHlpbmcgX3ggYnkgX3ksIGFzc2VydHMgaWYgdGhlIGNhbGN1bGF0aW9uIG92ZXJmbG93cwoKICAgICAgICBAcGFyYW0gX3ggICBmYWN0b3IgMQogICAgICAgIEBwYXJhbSBfeSAgIGZhY3RvciAyCgogICAgICAgIEByZXR1cm4gcHJvZHVjdAogICAgKi8KICAgIGZ1bmN0aW9uIHNhZmVNdWwodWludDI1NiBfeCwgdWludDI1NiBfeSkgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgeiA9IF94ICogX3k7CiAgICAgICAgYXNzZXJ0KF94ID09IDAgfHwgeiAvIF94ID09IF95KTsKICAgICAgICByZXR1cm4gejsKICAgIH0KfSAKCi8qCiAgICBPd25lZCBjb250cmFjdCBpbnRlcmZhY2UKKi8KY29udHJhY3QgSU93bmVkIHsKICAgIC8vIHRoaXMgZnVuY3Rpb24gaXNuJ3QgYWJzdHJhY3Qgc2luY2UgdGhlIGNvbXBpbGVyIGVtaXRzIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGVkIGdldHRlciBmdW5jdGlvbnMgYXMgZXh0ZXJuYWwKICAgIGZ1bmN0aW9uIG93bmVyKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3Mgb3duZXIpIHsgb3duZXI7IH0KCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIF9uZXdPd25lcikgcHVibGljOwogICAgZnVuY3Rpb24gYWNjZXB0T3duZXJzaGlwKCkgcHVibGljOwp9CgovKgogICAgUHJvdmlkZXMgc3VwcG9ydCBhbmQgdXRpbGl0aWVzIGZvciBjb250cmFjdCBvd25lcnNoaXAKKi8KY29udHJhY3QgT3duZWQgaXMgSU93bmVkIHsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwogICAgYWRkcmVzcyBwdWJsaWMgbmV3T3duZXI7CgogICAgZXZlbnQgT3duZXJVcGRhdGUoYWRkcmVzcyBfcHJldk93bmVyLCBhZGRyZXNzIF9uZXdPd25lcik7CgogICAgLyoqCiAgICAgICAgQGRldiBjb25zdHJ1Y3RvcgogICAgKi8KICAgIGZ1bmN0aW9uIE93bmVkKCkgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICAvLyBhbGxvd3MgZXhlY3V0aW9uIGJ5IHRoZSBvd25lciBvbmx5CiAgICBtb2RpZmllciBvd25lck9ubHkgewogICAgICAgIGFzc2VydChtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICAgIEBkZXYgYWxsb3dzIHRyYW5zZmVycmluZyB0aGUgY29udHJhY3Qgb3duZXJzaGlwCiAgICAgICAgdGhlIG5ldyBvd25lciBzdGlsbCBuZWVkIHRvIGFjY2VwdCB0aGUgdHJhbnNmZXIKICAgICAgICBjYW4gb25seSBiZSBjYWxsZWQgYnkgdGhlIGNvbnRyYWN0IG93bmVyCgogICAgICAgIEBwYXJhbSBfbmV3T3duZXIgICAgbmV3IGNvbnRyYWN0IG93bmVyCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBfbmV3T3duZXIpIHB1YmxpYyBvd25lck9ubHkgewogICAgICAgIHJlcXVpcmUoX25ld093bmVyICE9IG93bmVyKTsKICAgICAgICBuZXdPd25lciA9IF9uZXdPd25lcjsKICAgIH0KCiAgICAvKioKICAgICAgICBAZGV2IHVzZWQgYnkgYSBuZXcgb3duZXIgdG8gYWNjZXB0IGFuIG93bmVyc2hpcCB0cmFuc2ZlcgogICAgKi8KICAgIGZ1bmN0aW9uIGFjY2VwdE93bmVyc2hpcCgpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG5ld093bmVyKTsKICAgICAgICBPd25lclVwZGF0ZShvd25lciwgbmV3T3duZXIpOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICAgICAgbmV3T3duZXIgPSAweDA7CiAgICB9Cn0KCi8qCiAgICBUb2tlbiBIb2xkZXIgaW50ZXJmYWNlCiovCmNvbnRyYWN0IElUb2tlbkhvbGRlciBpcyBJT3duZWQgewogICAgZnVuY3Rpb24gd2l0aGRyYXdUb2tlbnMoSUVSQzIwVG9rZW4gX3Rva2VuLCBhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBwdWJsaWM7Cn0KCi8qCiAgICBXZSBjb25zaWRlciBldmVyeSBjb250cmFjdCB0byBiZSBhICd0b2tlbiBob2xkZXInIHNpbmNlIGl0J3MgY3VycmVudGx5IG5vdCBwb3NzaWJsZQogICAgZm9yIGEgY29udHJhY3QgdG8gZGVueSByZWNlaXZpbmcgdG9rZW5zLgoKICAgIFRoZSBUb2tlbkhvbGRlcidzIGNvbnRyYWN0IHNvbGUgcHVycG9zZSBpcyB0byBwcm92aWRlIGEgc2FmZXR5IG1lY2hhbmlzbSB0aGF0IGFsbG93cwogICAgdGhlIG93bmVyIHRvIHNlbmQgdG9rZW5zIHRoYXQgd2VyZSBzZW50IHRvIHRoZSBjb250cmFjdCBieSBtaXN0YWtlIGJhY2sgdG8gdGhlaXIgc2VuZGVyLgoqLwpjb250cmFjdCBUb2tlbkhvbGRlciBpcyBJVG9rZW5Ib2xkZXIsIE93bmVkIHsKICAgIC8qKgogICAgICAgIEBkZXYgY29uc3RydWN0b3IKICAgICovCiAgICBmdW5jdGlvbiBUb2tlbkhvbGRlcigpIHsKICAgIH0KCiAgICAvLyB2YWxpZGF0ZXMgYW4gYWRkcmVzcyAtIGN1cnJlbnRseSBvbmx5IGNoZWNrcyB0aGF0IGl0IGlzbid0IG51bGwKICAgIG1vZGlmaWVyIHZhbGlkQWRkcmVzcyhhZGRyZXNzIF9hZGRyZXNzKSB7CiAgICAgICAgcmVxdWlyZShfYWRkcmVzcyAhPSAweDApOwogICAgICAgIF87CiAgICB9CiAgICAvLyBzaW5jZSB2MC40LjEyIG9mIGNvbXBpbGVyIHdlIG5lZWQgdGhpcyAKICAgIG1vZGlmaWVyIHZhbGlkQWRkcmVzc0ZvclNlY29uZChhZGRyZXNzIF9hZGRyZXNzKSB7CiAgICAgICAgcmVxdWlyZShfYWRkcmVzcyAhPSAweDApOwogICAgICAgIF87CiAgICB9CgogICAgLy8gdmVyaWZpZXMgdGhhdCB0aGUgYWRkcmVzcyBpcyBkaWZmZXJlbnQgdGhhbiB0aGlzIGNvbnRyYWN0IGFkZHJlc3MKICAgIG1vZGlmaWVyIG5vdFRoaXMoYWRkcmVzcyBfYWRkcmVzcykgewogICAgICAgIHJlcXVpcmUoX2FkZHJlc3MgIT0gYWRkcmVzcyh0aGlzKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAgICBAZGV2IHdpdGhkcmF3cyB0b2tlbnMgaGVsZCBieSB0aGUgY29udHJhY3QgYW5kIHNlbmRzIHRoZW0gdG8gYW4gYWNjb3VudAogICAgICAgIGNhbiBvbmx5IGJlIGNhbGxlZCBieSB0aGUgb3duZXIKCiAgICAgICAgQHBhcmFtIF90b2tlbiAgIEVSQzIwIHRva2VuIGNvbnRyYWN0IGFkZHJlc3MKICAgICAgICBAcGFyYW0gX3RvICAgICAgYWNjb3VudCB0byByZWNlaXZlIHRoZSBuZXcgYW1vdW50CiAgICAgICAgQHBhcmFtIF9hbW91bnQgIGFtb3VudCB0byB3aXRoZHJhdwogICAgKi8KICAgIGZ1bmN0aW9uIHdpdGhkcmF3VG9rZW5zKElFUkMyMFRva2VuIF90b2tlbiwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICBvd25lck9ubHkKICAgICAgICB2YWxpZEFkZHJlc3MoX3Rva2VuKQogICAgICAgIHZhbGlkQWRkcmVzc0ZvclNlY29uZChfdG8pCiAgICAgICAgbm90VGhpcyhfdG8pCiAgICB7CiAgICAgICAgYXNzZXJ0KF90b2tlbi50cmFuc2ZlcihfdG8sIF9hbW91bnQpKTsKICAgIH0KfQoKLyoKICAgIEVSQzIwIFN0YW5kYXJkIFRva2VuIGludGVyZmFjZQoqLwpjb250cmFjdCBJRVJDMjBUb2tlbiB7CiAgICAvLyB0aGVzZSBmdW5jdGlvbnMgYXJlbid0IGFic3RyYWN0IHNpbmNlIHRoZSBjb21waWxlciBlbWl0cyBhdXRvbWF0aWNhbGx5IGdlbmVyYXRlZCBnZXR0ZXIgZnVuY3Rpb25zIGFzIGV4dGVybmFsCiAgICBmdW5jdGlvbiBuYW1lKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHN0cmluZyBuYW1lKSB7IG5hbWU7IH0KICAgIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChzdHJpbmcgc3ltYm9sKSB7IHN5bWJvbDsgfQogICAgZnVuY3Rpb24gZGVjaW1hbHMoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDggZGVjaW1hbHMpIHsgZGVjaW1hbHM7IH0KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgdG90YWxTdXBwbHkpIHsgdG90YWxTdXBwbHk7IH0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgeyBfb3duZXI7IGJhbGFuY2U7IH0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7IF9vd25lcjsgX3NwZW5kZXI7IHJlbWFpbmluZzsgfQogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7Cn0KCi8qKgogICAgRVJDMjAgU3RhbmRhcmQgVG9rZW4gaW1wbGVtZW50YXRpb24KKi8KY29udHJhY3QgRVJDMjBUb2tlbiBpcyBJRVJDMjBUb2tlbiwgU2FmZU1hdGggewogICAgc3RyaW5nIHB1YmxpYyBzdGFuZGFyZCA9ICdUb2tlbiAwLjEnOwogICAgc3RyaW5nIHB1YmxpYyBuYW1lID0gJ0RFQklUIENvaW4gVG9rZW4nOwogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAnREJDJzsKICAgIHVpbnQ4IHB1YmxpYyBkZWNpbWFscyA9IDg7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseSA9IDA7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBiYWxhbmNlT2Y7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIHB1YmxpYyBhbGxvd2FuY2U7CgogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKCiAgICAvKioKICAgICAgICBAZGV2IGNvbnN0cnVjdG9yCgogICAgICAgIEBwYXJhbSBfbmFtZSAgICAgICAgdG9rZW4gbmFtZQogICAgICAgIEBwYXJhbSBfc3ltYm9sICAgICAgdG9rZW4gc3ltYm9sCiAgICAgICAgQHBhcmFtIF9kZWNpbWFscyAgICBkZWNpbWFsIHBvaW50cywgZm9yIGRpc3BsYXkgcHVycG9zZXMKICAgICovCiAgICBmdW5jdGlvbiBFUkMyMFRva2VuKHN0cmluZyBfbmFtZSwgc3RyaW5nIF9zeW1ib2wsIHVpbnQ4IF9kZWNpbWFscykgewogICAgICAgIHJlcXVpcmUoYnl0ZXMoX25hbWUpLmxlbmd0aCA+IDAgJiYgYnl0ZXMoX3N5bWJvbCkubGVuZ3RoID4gMCk7IC8vIHZhbGlkYXRlIGlucHV0CgogICAgICAgIG5hbWUgPSBfbmFtZTsKICAgICAgICBzeW1ib2wgPSBfc3ltYm9sOwogICAgICAgIGRlY2ltYWxzID0gX2RlY2ltYWxzOwogICAgfQoKICAgIC8vIHZhbGlkYXRlcyBhbiBhZGRyZXNzIC0gY3VycmVudGx5IG9ubHkgY2hlY2tzIHRoYXQgaXQgaXNuJ3QgbnVsbAogICAgbW9kaWZpZXIgdmFsaWRBZGRyZXNzKGFkZHJlc3MgX2FkZHJlc3MpIHsKICAgICAgICByZXF1aXJlKF9hZGRyZXNzICE9IDB4MCk7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgLy8gc2luY2UgdjAuNC4xMiBjb21waWxlciB3ZSBuZWVkIHRoaXMgCiAgICBtb2RpZmllciB2YWxpZEFkZHJlc3NGb3JTZWNvbmQoYWRkcmVzcyBfYWRkcmVzcykgewogICAgICAgIHJlcXVpcmUoX2FkZHJlc3MgIT0gMHgwKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICAgIEBkZXYgc2VuZCBjb2lucwogICAgICAgIHRocm93cyBvbiBhbnkgZXJyb3IgcmF0aGVyIHRoZW4gcmV0dXJuIGEgZmFsc2UgZmxhZyB0byBtaW5pbWl6ZSB1c2VyIGVycm9ycwoKICAgICAgICBAcGFyYW0gX3RvICAgICAgdGFyZ2V0IGFkZHJlc3MKICAgICAgICBAcGFyYW0gX3ZhbHVlICAgdHJhbnNmZXIgYW1vdW50CgogICAgICAgIEByZXR1cm4gdHJ1ZSBpZiB0aGUgdHJhbnNmZXIgd2FzIHN1Y2Nlc3NmdWwsIGZhbHNlIGlmIGl0IHdhc24ndAogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkKICAgICAgICBwdWJsaWMKICAgICAgICB2YWxpZEFkZHJlc3MoX3RvKQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPSBzYWZlU3ViKGJhbGFuY2VPZlttc2cuc2VuZGVyXSwgX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlT2ZbX3RvXSA9IHNhZmVBZGQoYmFsYW5jZU9mW190b10sIF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICAgIEBkZXYgYW4gYWNjb3VudC9jb250cmFjdCBhdHRlbXB0cyB0byBnZXQgdGhlIGNvaW5zCiAgICAgICAgdGhyb3dzIG9uIGFueSBlcnJvciByYXRoZXIgdGhlbiByZXR1cm4gYSBmYWxzZSBmbGFnIHRvIG1pbmltaXplIHVzZXIgZXJyb3JzCgogICAgICAgIEBwYXJhbSBfZnJvbSAgICBzb3VyY2UgYWRkcmVzcwogICAgICAgIEBwYXJhbSBfdG8gICAgICB0YXJnZXQgYWRkcmVzcwogICAgICAgIEBwYXJhbSBfdmFsdWUgICB0cmFuc2ZlciBhbW91bnQKCiAgICAgICAgQHJldHVybiB0cnVlIGlmIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCwgZmFsc2UgaWYgaXQgd2Fzbid0CiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkKICAgICAgICBwdWJsaWMKICAgICAgICB2YWxpZEFkZHJlc3MoX2Zyb20pCiAgICAgICAgdmFsaWRBZGRyZXNzRm9yU2Vjb25kKF90bykKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgICAgYWxsb3dhbmNlW19mcm9tXVttc2cuc2VuZGVyXSA9IHNhZmVTdWIoYWxsb3dhbmNlW19mcm9tXVttc2cuc2VuZGVyXSwgX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlT2ZbX2Zyb21dID0gc2FmZVN1YihiYWxhbmNlT2ZbX2Zyb21dLCBfdmFsdWUpOwogICAgICAgIGJhbGFuY2VPZltfdG9dID0gc2FmZUFkZChiYWxhbmNlT2ZbX3RvXSwgX3ZhbHVlKTsKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICAgIEBkZXYgYWxsb3cgYW5vdGhlciBhY2NvdW50L2NvbnRyYWN0IHRvIHNwZW5kIHNvbWUgdG9rZW5zIG9uIHlvdXIgYmVoYWxmCiAgICAgICAgdGhyb3dzIG9uIGFueSBlcnJvciByYXRoZXIgdGhlbiByZXR1cm4gYSBmYWxzZSBmbGFnIHRvIG1pbmltaXplIHVzZXIgZXJyb3JzCgogICAgICAgIGFsc28sIHRvIG1pbmltaXplIHRoZSByaXNrIG9mIHRoZSBhcHByb3ZlL3RyYW5zZmVyRnJvbSBhdHRhY2sgdmVjdG9yCiAgICAgICAgKHNlZSBodHRwczovL2RvY3MuZ29vZ2xlLmNvbS9kb2N1bWVudC9kLzFZTFB0UXhadTFVQXZPOWNaMU8yUlBYQmJUMG1vb2g0RFlLakFfanAtUkxNLyksIGFwcHJvdmUgaGFzIHRvIGJlIGNhbGxlZCB0d2ljZQogICAgICAgIGluIDIgc2VwYXJhdGUgdHJhbnNhY3Rpb25zIC0gb25jZSB0byBjaGFuZ2UgdGhlIGFsbG93YW5jZSB0byAwIGFuZCBzZWNvbmRseSB0byBjaGFuZ2UgaXQgdG8gdGhlIG5ldyBhbGxvd2FuY2UgdmFsdWUKCiAgICAgICAgQHBhcmFtIF9zcGVuZGVyIGFwcHJvdmVkIGFkZHJlc3MKICAgICAgICBAcGFyYW0gX3ZhbHVlICAgYWxsb3dhbmNlIGFtb3VudAoKICAgICAgICBAcmV0dXJuIHRydWUgaWYgdGhlIGFwcHJvdmFsIHdhcyBzdWNjZXNzZnVsLCBmYWxzZSBpZiBpdCB3YXNuJ3QKICAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKQogICAgICAgIHB1YmxpYwogICAgICAgIHZhbGlkQWRkcmVzcyhfc3BlbmRlcikKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgICAgLy8gaWYgdGhlIGFsbG93YW5jZSBpc24ndCAwLCBpdCBjYW4gb25seSBiZSB1cGRhdGVkIHRvIDAgdG8gcHJldmVudCBhbiBhbGxvd2FuY2UgY2hhbmdlIGltbWVkaWF0ZWx5IGFmdGVyIHdpdGhkcmF3YWwKICAgICAgICByZXF1aXJlKF92YWx1ZSA9PSAwIHx8IGFsbG93YW5jZVttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPT0gMCk7CgogICAgICAgIGFsbG93YW5jZVttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0KCi8qCiAgICBERUJJVENvaW4gVG9rZW4gaW50ZXJmYWNlCiovCmNvbnRyYWN0IElEZWJpdENvaW5Ub2tlbiBpcyBJVG9rZW5Ib2xkZXIsIElFUkMyMFRva2VuIHsKICAgIGZ1bmN0aW9uIGRpc2FibGVUcmFuc2ZlcnMoYm9vbCBfZGlzYWJsZSkgcHVibGljOwogICAgZnVuY3Rpb24gaXNzdWUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgcHVibGljOwogICAgZnVuY3Rpb24gZGVzdHJveShhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYzsKfQoKLyoKICAgIERFQklUQ29pbiBUb2tlbiB2MC4yCgogICAgJ093bmVkJyBpcyBzcGVjaWZpZWQgaGVyZSBmb3IgcmVhZGFiaWxpdHkgcmVhc29ucwoqLwpjb250cmFjdCBEZWJpdENvaW5Ub2tlbiBpcyBJRGViaXRDb2luVG9rZW4sIEVSQzIwVG9rZW4sIE93bmVkLCBUb2tlbkhvbGRlciB7CiAgICBzdHJpbmcgcHVibGljIHZlcnNpb24gPSAnMC4yJzsKCiAgICBib29sIHB1YmxpYyB0cmFuc2ZlcnNFbmFibGVkID0gdHJ1ZTsgICAgLy8gdHJ1ZSBpZiB0cmFuc2Zlci90cmFuc2ZlckZyb20gYXJlIGVuYWJsZWQsIGZhbHNlIGlmIG5vdAogICAgdWludCBwdWJsaWMgTWluaW5nUmV3YXJkUGVyRVRIQmxvY2sgPSA1OyAgLy8gZGVmaW5lIGFtb3VudCBvZiByZWF3YXJkIGluIERFQklUQ29pbiwgZm9yIG1pbmVyIHRoYXQgZm91bmQgbGFzdCBibG9jayBpbiBFdGhlcmV1bSBCbG9ja0NoYWluCiAgICB1aW50IHB1YmxpYyBsYXN0QmxvY2tSZXdhcmRlZDsKICAgIAogICAgLy8gdHJpZ2dlcmVkIHdoZW4gYSBERUJJVENvaW4gdG9rZW4gaXMgZGVwbG95ZWQgLSB0aGUgX3Rva2VuIGFkZHJlc3MgaXMgZGVmaW5lZCBmb3IgZm9yd2FyZCBjb21wYXRpYmlsaXR5LCBpbiBjYXNlIHdlIHdhbnQgdG8gdHJpZ2dlciB0aGUgZXZlbnQgZnJvbSBhIGZhY3RvcnkKICAgIGV2ZW50IERlYml0Q29pblRva2VuR2VuZXNpcyhhZGRyZXNzIF90b2tlbik7CiAgICAvLyB0cmlnZ2VyZWQgd2hlbiB0aGUgdG90YWwgc3VwcGx5IGlzIGluY3JlYXNlZAogICAgZXZlbnQgSXNzdWFuY2UodWludDI1NiBfYW1vdW50KTsKICAgIC8vIHRyaWdnZXJlZCB3aGVuIHRoZSB0b3RhbCBzdXBwbHkgaXMgZGVjcmVhc2VkCiAgICBldmVudCBEZXN0cnVjdGlvbih1aW50MjU2IF9hbW91bnQpOwogICAgLy8gdHJpZ2dlcmVkIHdoZW4gdGhlIGFtb3VudCBvZiByZWF3YXJkIGZvciBtaW5pbmcgYXJlIGNoYW5nZXNkCiAgICBldmVudCBNaW5pbmdSZXdhcmRDaGFuZ2VkKHVpbnQyNTYgX2Ftb3VudCk7CiAgICAvLyB0cmlnZ2VyZWQgd2hlbiBtaW5lciBnZXQgYSByZXdhcmQKICAgIGV2ZW50IE1pbmluZ1Jld2FyZFNlbnQoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CgogICAgLyoqCiAgICAgICAgQGRldiBjb25zdHJ1Y3RvcgoKICAgICAgICBAcGFyYW0gX25hbWUgICAgICAgdG9rZW4gbmFtZQogICAgICAgIEBwYXJhbSBfc3ltYm9sICAgICB0b2tlbiBzaG9ydCBzeW1ib2wsIDEtNiBjaGFyYWN0ZXJzCiAgICAgICAgQHBhcmFtIF9kZWNpbWFscyAgIGZvciBkaXNwbGF5IHB1cnBvc2VzIG9ubHkKICAgICovCiAgICBmdW5jdGlvbiBEZWJpdENvaW5Ub2tlbihzdHJpbmcgX25hbWUsIHN0cmluZyBfc3ltYm9sLCB1aW50OCBfZGVjaW1hbHMpCiAgICAgICAgRVJDMjBUb2tlbihfbmFtZSwgX3N5bWJvbCwgX2RlY2ltYWxzKQogICAgewogICAgICAgIHJlcXVpcmUoYnl0ZXMoX3N5bWJvbCkubGVuZ3RoIDw9IDYpOyAvLyB2YWxpZGF0ZSBpbnB1dAogICAgICAgIERlYml0Q29pblRva2VuR2VuZXNpcyhhZGRyZXNzKHRoaXMpKTsKICAgIH0KCiAgICAvLyBhbGxvd3MgZXhlY3V0aW9uIG9ubHkgd2hlbiB0cmFuc2ZlcnMgYXJlbid0IGRpc2FibGVkCiAgICBtb2RpZmllciB0cmFuc2ZlcnNBbGxvd2VkIHsKICAgICAgICBhc3NlcnQodHJhbnNmZXJzRW5hYmxlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAgICBAZGV2IGRpc2FibGVzL2VuYWJsZXMgdHJhbnNmZXJzCiAgICAgICAgY2FuIG9ubHkgYmUgY2FsbGVkIGJ5IHRoZSBjb250cmFjdCBvd25lcgoKICAgICAgICBAcGFyYW0gX2Rpc2FibGUgICAgdHJ1ZSB0byBkaXNhYmxlIHRyYW5zZmVycywgZmFsc2UgdG8gZW5hYmxlIHRoZW0KICAgICovCiAgICBmdW5jdGlvbiBkaXNhYmxlVHJhbnNmZXJzKGJvb2wgX2Rpc2FibGUpIHB1YmxpYyBvd25lck9ubHkgewogICAgICAgIHRyYW5zZmVyc0VuYWJsZWQgPSAhX2Rpc2FibGU7CiAgICB9CgogICAgLyoqCiAgICAgICAgQGRldiBhbnlvbmUgd2hvIGZpbmRzIGEgYmxvY2sgb24gZXRoZXJldW0gd291bGQgYWxzbyBnZXQgYSByZXdhcmQgaW4gCiAgICAgICAgREVCSVRDb2luLCBnaXZlbiB0aGF0IGFueW9uZSBjYWxscyB0aGUgcmV3YXJkIGZ1bmN0aW9uIG9uIHRoYXQgYmxvY2sKICAgICovCiAgICBmdW5jdGlvbiBUcmFuc2Zlck1pbmVyc1Jld2FyZCgpIHsKICAgICAgICByZXF1aXJlKGxhc3RCbG9ja1Jld2FyZGVkIDwgYmxvY2subnVtYmVyKTsKICAgICAgICBsYXN0QmxvY2tSZXdhcmRlZCA9IGJsb2NrLm51bWJlcjsKICAgICAgICB0b3RhbFN1cHBseSA9IHNhZmVBZGQodG90YWxTdXBwbHksIE1pbmluZ1Jld2FyZFBlckVUSEJsb2NrKTsKICAgICAgICBiYWxhbmNlT2ZbYmxvY2suY29pbmJhc2VdID0gc2FmZUFkZChiYWxhbmNlT2ZbYmxvY2suY29pbmJhc2VdLCBNaW5pbmdSZXdhcmRQZXJFVEhCbG9jayk7CiAgICAgICAgTWluaW5nUmV3YXJkU2VudCh0aGlzLCBibG9jay5jb2luYmFzZSwgTWluaW5nUmV3YXJkUGVyRVRIQmxvY2spOwogICAgfQogICAgCiAgICAvKioKICAgICAgICBAZGV2IGNoYW5nZSBtaW5lcnMgcmV3YXJkCiAgICAgICAgY2FuIG9ubHkgYmUgY2FsbGVkIGJ5IHRoZSBjb250cmFjdCBvd25lcgoKICAgICAgICBAcGFyYW0gX2Ftb3VudCAgICBhbW91bnQgdG8gaW5jcmVhc2UgdGhlIHN1cHBseSBieQogICAgKi8KICAgIGZ1bmN0aW9uIENoYW5nZU1pbmluZ1Jld2FyZCh1aW50MjU2IF9hbW91bnQpIHB1YmxpYyBvd25lck9ubHkgewogICAgICAgIE1pbmluZ1Jld2FyZFBlckVUSEJsb2NrID0gX2Ftb3VudDsKICAgICAgICBNaW5pbmdSZXdhcmRDaGFuZ2VkKF9hbW91bnQpOwogICAgfQogICAgCiAgICAvKioKICAgICAgICBAZGV2IGluY3JlYXNlcyB0aGUgdG9rZW4gc3VwcGx5IGFuZCBzZW5kcyB0aGUgbmV3IHRva2VucyB0byBhbiBhY2NvdW50CiAgICAgICAgY2FuIG9ubHkgYmUgY2FsbGVkIGJ5IHRoZSBjb250cmFjdCBvd25lcgoKICAgICAgICBAcGFyYW0gX3RvICAgICAgICAgYWNjb3VudCB0byByZWNlaXZlIHRoZSBuZXcgYW1vdW50CiAgICAgICAgQHBhcmFtIF9hbW91bnQgICAgIGFtb3VudCB0byBpbmNyZWFzZSB0aGUgc3VwcGx5IGJ5CiAgICAqLwogICAgZnVuY3Rpb24gaXNzdWUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICBvd25lck9ubHkKICAgICAgICB2YWxpZEFkZHJlc3MoX3RvKQogICAgICAgIG5vdFRoaXMoX3RvKQogICAgewogICAgICAgIHRvdGFsU3VwcGx5ID0gc2FmZUFkZCh0b3RhbFN1cHBseSwgX2Ftb3VudCk7CiAgICAgICAgYmFsYW5jZU9mW190b10gPSBzYWZlQWRkKGJhbGFuY2VPZltfdG9dLCBfYW1vdW50KTsKCiAgICAgICAgSXNzdWFuY2UoX2Ftb3VudCk7CiAgICAgICAgVHJhbnNmZXIodGhpcywgX3RvLCBfYW1vdW50KTsKICAgIH0KCiAgICAvKioKICAgICAgICBAZGV2IHJlbW92ZXMgdG9rZW5zIGZyb20gYW4gYWNjb3VudCBhbmQgZGVjcmVhc2VzIHRoZSB0b2tlbiBzdXBwbHkKICAgICAgICBjYW4gb25seSBiZSBjYWxsZWQgYnkgdGhlIGNvbnRyYWN0IG93bmVyCgogICAgICAgIEBwYXJhbSBfZnJvbSAgICAgICBhY2NvdW50IHRvIHJlbW92ZSB0aGUgYW1vdW50IGZyb20KICAgICAgICBAcGFyYW0gX2Ftb3VudCAgICAgYW1vdW50IHRvIGRlY3JlYXNlIHRoZSBzdXBwbHkgYnkKICAgICovCiAgICBmdW5jdGlvbiBkZXN0cm95KGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX2Ftb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICBvd25lck9ubHkKICAgIHsKICAgICAgICBiYWxhbmNlT2ZbX2Zyb21dID0gc2FmZVN1YihiYWxhbmNlT2ZbX2Zyb21dLCBfYW1vdW50KTsKICAgICAgICB0b3RhbFN1cHBseSA9IHNhZmVTdWIodG90YWxTdXBwbHksIF9hbW91bnQpOwoKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgdGhpcywgX2Ftb3VudCk7CiAgICAgICAgRGVzdHJ1Y3Rpb24oX2Ftb3VudCk7CiAgICB9CgogICAgLy8gRVJDMjAgc3RhbmRhcmQgbWV0aG9kIG92ZXJyaWRlcyB3aXRoIHNvbWUgZXh0cmEgZnVuY3Rpb25hbGl0eQoKICAgIC8qKgogICAgICAgIEBkZXYgc2VuZCBjb2lucwogICAgICAgIHRocm93cyBvbiBhbnkgZXJyb3IgcmF0aGVyIHRoZW4gcmV0dXJuIGEgZmFsc2UgZmxhZyB0byBtaW5pbWl6ZSB1c2VyIGVycm9ycwogICAgICAgIG5vdGUgdGhhdCB3aGVuIHRyYW5zZmVycmluZyB0byB0aGUgc21hcnQgdG9rZW4ncyBhZGRyZXNzLCB0aGUgY29pbnMgYXJlIGFjdHVhbGx5IGRlc3Ryb3llZAoKICAgICAgICBAcGFyYW0gX3RvICAgICAgdGFyZ2V0IGFkZHJlc3MKICAgICAgICBAcGFyYW0gX3ZhbHVlICAgdHJhbnNmZXIgYW1vdW50CgogICAgICAgIEByZXR1cm4gdHJ1ZSBpZiB0aGUgdHJhbnNmZXIgd2FzIHN1Y2Nlc3NmdWwsIGZhbHNlIGlmIGl0IHdhc24ndAogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHRyYW5zZmVyc0FsbG93ZWQgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgYXNzZXJ0KHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKSk7CgogICAgICAgIC8vIHRyYW5zZmVycmluZyB0byB0aGUgY29udHJhY3QgYWRkcmVzcyBkZXN0cm95cyB0b2tlbnMKICAgICAgICBpZiAoX3RvID09IGFkZHJlc3ModGhpcykpIHsKICAgICAgICAgICAgYmFsYW5jZU9mW190b10gLT0gX3ZhbHVlOwogICAgICAgICAgICB0b3RhbFN1cHBseSAtPSBfdmFsdWU7CiAgICAgICAgICAgIERlc3RydWN0aW9uKF92YWx1ZSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAgICBAZGV2IGFuIGFjY291bnQvY29udHJhY3QgYXR0ZW1wdHMgdG8gZ2V0IHRoZSBjb2lucwogICAgICAgIHRocm93cyBvbiBhbnkgZXJyb3IgcmF0aGVyIHRoZW4gcmV0dXJuIGEgZmFsc2UgZmxhZyB0byBtaW5pbWl6ZSB1c2VyIGVycm9ycwogICAgICAgIG5vdGUgdGhhdCB3aGVuIHRyYW5zZmVycmluZyB0byB0aGUgc21hcnQgdG9rZW4ncyBhZGRyZXNzLCB0aGUgY29pbnMgYXJlIGFjdHVhbGx5IGRlc3Ryb3llZAoKICAgICAgICBAcGFyYW0gX2Zyb20gICAgc291cmNlIGFkZHJlc3MKICAgICAgICBAcGFyYW0gX3RvICAgICAgdGFyZ2V0IGFkZHJlc3MKICAgICAgICBAcGFyYW0gX3ZhbHVlICAgdHJhbnNmZXIgYW1vdW50CgogICAgICAgIEByZXR1cm4gdHJ1ZSBpZiB0aGUgdHJhbnNmZXIgd2FzIHN1Y2Nlc3NmdWwsIGZhbHNlIGlmIGl0IHdhc24ndAogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB0cmFuc2ZlcnNBbGxvd2VkIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGFzc2VydChzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKSk7CgogICAgICAgIC8vIHRyYW5zZmVycmluZyB0byB0aGUgY29udHJhY3QgYWRkcmVzcyBkZXN0cm95cyB0b2tlbnMKICAgICAgICBpZiAoX3RvID09IGFkZHJlc3ModGhpcykpIHsKICAgICAgICAgICAgYmFsYW5jZU9mW190b10gLT0gX3ZhbHVlOwogICAgICAgICAgICB0b3RhbFN1cHBseSAtPSBfdmFsdWU7CiAgICAgICAgICAgIERlc3RydWN0aW9uKF92YWx1ZSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQoKLyoqCiAqIFVwZ3JhZGUgYWdlbnQgaW50ZXJmYWNlIGluc3BpcmVkIGJ5IEx1bnlyLgogKgogKiBVcGdyYWRlIGFnZW50IHRyYW5zZmVycyB0b2tlbnMgdG8gYSBuZXcgY29udHJhY3QuCiAqIFVwZ3JhZGUgYWdlbnQgaXRzZWxmIGNhbiBiZSB0aGUgdG9rZW4gY29udHJhY3QsIG9yIGp1c3QgYSBtaWRkbGUgbWFuIGNvbnRyYWN0IGRvaW5nIHRoZSBoZWF2eSBsaWZ0aW5nLgogKi8KY29udHJhY3QgVXBncmFkZUFnZW50IHsKCiAgdWludCBwdWJsaWMgb3JpZ2luYWxTdXBwbHk7CgogIC8qKiBJbnRlcmZhY2UgbWFya2VyICovCiAgZnVuY3Rpb24gaXNVcGdyYWRlQWdlbnQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiB1cGdyYWRlRnJvbShhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF92YWx1ZSkgcHVibGljOwoKfQoKCi8qKgogKiBBIHRva2VuIHVwZ3JhZGUgbWVjaGFuaXNtIHdoZXJlIHVzZXJzIGNhbiBvcHQtaW4gYW1vdW50IG9mIHRva2VucyB0byB0aGUgbmV4dCBzbWFydCBjb250cmFjdCByZXZpc2lvbi4KICoKICogRmlyc3QgZW52aXNpb25lZCBieSBHb2xlbSBhbmQgTHVueXIgcHJvamVjdHMuCiAqLwpjb250cmFjdCBVcGdyYWRlYWJsZVRva2VuIGlzIERlYml0Q29pblRva2VuIHsKCiAgLyoqIENvbnRyYWN0IC8gcGVyc29uIHdobyBjYW4gc2V0IHRoZSB1cGdyYWRlIHBhdGguIFRoaXMgY2FuIGJlIHRoZSBzYW1lIGFzIHRlYW0gbXVsdGlzaWcgd2FsbGV0LCBhcyB3aGF0IGl0IGlzIHdpdGggaXRzIGRlZmF1bHQgdmFsdWUuICovCiAgYWRkcmVzcyBwdWJsaWMgdXBncmFkZU1hc3RlcjsKCiAgLyoqIFRoZSBuZXh0IGNvbnRyYWN0IHdoZXJlIHRoZSB0b2tlbnMgd2lsbCBiZSBtaWdyYXRlZC4gKi8KICBVcGdyYWRlQWdlbnQgcHVibGljIHVwZ3JhZGVBZ2VudDsKCiAgLyoqIEhvdyBtYW55IHRva2VucyB3ZSBoYXZlIHVwZ3JhZGVkIGJ5IG5vdy4gKi8KICB1aW50MjU2IHB1YmxpYyB0b3RhbFVwZ3JhZGVkOwoKICAvKioKICAgKiBVcGdyYWRlIHN0YXRlcy4KICAgKgogICAqIC0gTm90QWxsb3dlZDogVGhlIGNoaWxkIGNvbnRyYWN0IGhhcyBub3QgcmVhY2hlZCBhIGNvbmRpdGlvbiB3aGVyZSB0aGUgdXBncmFkZSBjYW4gYmd1bgogICAqIC0gV2FpdGluZ0ZvckFnZW50OiBUb2tlbiBhbGxvd3MgdXBncmFkZSwgYnV0IHdlIGRvbid0IGhhdmUgYSBuZXcgYWdlbnQgeWV0CiAgICogLSBSZWFkeVRvVXBncmFkZTogVGhlIGFnZW50IGlzIHNldCwgYnV0IG5vdCBhIHNpbmdsZSB0b2tlbiBoYXMgYmVlbiB1cGdyYWRlZCB5ZXQKICAgKiAtIFVwZ3JhZGluZzogVXBncmFkZSBhZ2VudCBpcyBzZXQgYW5kIHRoZSBiYWxhbmNlIGhvbGRlcnMgY2FuIHVwZ3JhZGUgdGhlaXIgdG9rZW5zCiAgICoKICAgKi8KICBlbnVtIFVwZ3JhZGVTdGF0ZSB7VW5rbm93biwgTm90QWxsb3dlZCwgV2FpdGluZ0ZvckFnZW50LCBSZWFkeVRvVXBncmFkZSwgVXBncmFkaW5nfQoKICAvKioKICAgKiBTb21lYm9keSBoYXMgdXBncmFkZWQgc29tZSBvZiBoaXMgdG9rZW5zLgogICAqLwogIGV2ZW50IFVwZ3JhZGUoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CgogIC8qKgogICAqIE5ldyB1cGdyYWRlIGFnZW50IGF2YWlsYWJsZS4KICAgKi8KICBldmVudCBVcGdyYWRlQWdlbnRTZXQoYWRkcmVzcyBhZ2VudCk7CgogIC8qKgogICAqIERvIG5vdCBhbGxvdyBjb25zdHJ1Y3Rpb24gd2l0aG91dCB1cGdyYWRlIG1hc3RlciBzZXQuCiAgICovCiAgZnVuY3Rpb24gVXBncmFkZWFibGVUb2tlbihhZGRyZXNzIF91cGdyYWRlTWFzdGVyKSB7CiAgICB1cGdyYWRlTWFzdGVyID0gX3VwZ3JhZGVNYXN0ZXI7CiAgfQoKICAvKioKICAgKiBBbGxvdyB0aGUgdG9rZW4gaG9sZGVyIHRvIHVwZ3JhZGUgc29tZSBvZiB0aGVpciB0b2tlbnMgdG8gYSBuZXcgY29udHJhY3QuCiAgICovCiAgZnVuY3Rpb24gdXBncmFkZSh1aW50MjU2IHZhbHVlKSBwdWJsaWMgewoKICAgICAgVXBncmFkZVN0YXRlIHN0YXRlID0gZ2V0VXBncmFkZVN0YXRlKCk7CiAgICAgIHJlcXVpcmUoc3RhdGUgPT0gVXBncmFkZVN0YXRlLlJlYWR5VG9VcGdyYWRlIHx8IHN0YXRlID09IFVwZ3JhZGVTdGF0ZS5VcGdyYWRpbmcpOwogICAgICAvLyBWYWxpZGF0ZSBpbnB1dCB2YWx1ZS4KICAgICAgcmVxdWlyZSh2YWx1ZSAhPSAwKTsKCiAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSA9IHNhZmVTdWIoYmFsYW5jZU9mW21zZy5zZW5kZXJdLCB2YWx1ZSk7CgogICAgICAvLyBUYWtlIHRva2VucyBvdXQgZnJvbSBjaXJjdWxhdGlvbgogICAgICB0b3RhbFN1cHBseSA9IHNhZmVTdWIodG90YWxTdXBwbHksIHZhbHVlKTsKICAgICAgdG90YWxVcGdyYWRlZCA9IHNhZmVBZGQodG90YWxVcGdyYWRlZCwgdmFsdWUpOwoKICAgICAgLy8gVXBncmFkZSBhZ2VudCByZWlzc3VlcyB0aGUgdG9rZW5zCiAgICAgIHVwZ3JhZGVBZ2VudC51cGdyYWRlRnJvbShtc2cuc2VuZGVyLCB2YWx1ZSk7CiAgICAgIFVwZ3JhZGUobXNnLnNlbmRlciwgdXBncmFkZUFnZW50LCB2YWx1ZSk7CiAgfQoKICAvKioKICAgKiBTZXQgYW4gdXBncmFkZSBhZ2VudCB0aGF0IGhhbmRsZXMKICAgKi8KICBmdW5jdGlvbiBzZXRVcGdyYWRlQWdlbnQoYWRkcmVzcyBhZ2VudCkgZXh0ZXJuYWwgewoKICAgICAgcmVxdWlyZShjYW5VcGdyYWRlKCkpOwoKICAgICAgcmVxdWlyZShhZ2VudCAhPSAweDApOwogICAgICAvLyBPbmx5IGEgbWFzdGVyIGNhbiBkZXNpZ25hdGUgdGhlIG5leHQgYWdlbnQKICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHVwZ3JhZGVNYXN0ZXIpOwogICAgICAvLyBVcGdyYWRlIGhhcyBhbHJlYWR5IGJlZ3VuIGZvciBhbiBhZ2VudAogICAgICByZXF1aXJlKGdldFVwZ3JhZGVTdGF0ZSgpICE9IFVwZ3JhZGVTdGF0ZS5VcGdyYWRpbmcpOwoKICAgICAgdXBncmFkZUFnZW50ID0gVXBncmFkZUFnZW50KGFnZW50KTsKCiAgICAgIC8vIEJhZCBpbnRlcmZhY2UKICAgICAgcmVxdWlyZSh1cGdyYWRlQWdlbnQuaXNVcGdyYWRlQWdlbnQoKSk7CiAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IHRva2VuIHN1cHBsaWVzIG1hdGNoIGluIHNvdXJjZSBhbmQgdGFyZ2V0CiAgICAgIHJlcXVpcmUodXBncmFkZUFnZW50Lm9yaWdpbmFsU3VwcGx5KCkgPT0gdG90YWxTdXBwbHkpOwoKICAgICAgVXBncmFkZUFnZW50U2V0KHVwZ3JhZGVBZ2VudCk7CiAgfQoKICAvKioKICAgKiBHZXQgdGhlIHN0YXRlIG9mIHRoZSB0b2tlbiB1cGdyYWRlLgogICAqLwogIGZ1bmN0aW9uIGdldFVwZ3JhZGVTdGF0ZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKFVwZ3JhZGVTdGF0ZSkgewogICAgaWYoIWNhblVwZ3JhZGUoKSkgcmV0dXJuIFVwZ3JhZGVTdGF0ZS5Ob3RBbGxvd2VkOwogICAgZWxzZSBpZihhZGRyZXNzKHVwZ3JhZGVBZ2VudCkgPT0gMHgwMCkgcmV0dXJuIFVwZ3JhZGVTdGF0ZS5XYWl0aW5nRm9yQWdlbnQ7CiAgICBlbHNlIGlmKHRvdGFsVXBncmFkZWQgPT0gMCkgcmV0dXJuIFVwZ3JhZGVTdGF0ZS5SZWFkeVRvVXBncmFkZTsKICAgIGVsc2UgcmV0dXJuIFVwZ3JhZGVTdGF0ZS5VcGdyYWRpbmc7CiAgfQoKICAvKioKICAgKiBDaGFuZ2UgdGhlIHVwZ3JhZGUgbWFzdGVyLgogICAqCiAgICogVGhpcyBhbGxvd3MgdXMgdG8gc2V0IGEgbmV3IG93bmVyIGZvciB0aGUgdXBncmFkZSBtZWNoYW5pc20uCiAgICovCiAgZnVuY3Rpb24gc2V0VXBncmFkZU1hc3RlcihhZGRyZXNzIG1hc3RlcikgcHVibGljIHsKICAgICAgcmVxdWlyZShtYXN0ZXIgIT0gMHgwKTsKICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHVwZ3JhZGVNYXN0ZXIpOwogICAgICB1cGdyYWRlTWFzdGVyID0gbWFzdGVyOwogIH0KCiAgLyoqCiAgICogQ2hpbGQgY29udHJhY3QgY2FuIGVuYWJsZSB0byBwcm92aWRlIHRoZSBjb25kaXRpb24gd2hlbiB0aGUgdXBncmFkZSBjYW4gYmVndW4uCiAgICovCiAgZnVuY3Rpb24gY2FuVXBncmFkZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKGJvb2wpIHsKICAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9'.
	

]
