Class {
	#name : #SRTd2a2691b44facbac43eeb4a7330180f14fa1431f,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd2a2691b44facbac43eeb4a7330180f14fa1431f >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7IC8vIHNvbGhpbnQtZGlzYWJsZS1saW5lCgoKCi8vLyBAdGl0bGUgSW50ZXJmYWNlIGZvciBjb250cmFjdHMgY29uZm9ybWluZyB0byBFUkMtNzIxOiBOb24tRnVuZ2libGUgVG9rZW5zCi8vLyBAYXV0aG9yIERpZXRlciBTaGlybGV5IDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9Ijg5ZWRlY2ZkZWNjOWU4ZjFlMGU2ZTRmM2VjZTdhN2VhZTYiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+PiAoaHR0cHM6Ly9naXRodWIuY29tL2RldGUpCmNvbnRyYWN0IEVSQzcyMSB7CiAgLy8gUmVxdWlyZWQgbWV0aG9kcwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYzsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7CiAgZnVuY3Rpb24gaW1wbGVtZW50c0VSQzcyMSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBhZGRyKTsKICBmdW5jdGlvbiB0YWtlT3duZXJzaGlwKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYzsKICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgdG90YWwpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWM7CgogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdG9rZW5JZCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgYXBwcm92ZWQsIHVpbnQyNTYgdG9rZW5JZCk7CgogIC8vIE9wdGlvbmFsCiAgLy8gZnVuY3Rpb24gbmFtZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZyBuYW1lKTsKICAvLyBmdW5jdGlvbiBzeW1ib2woKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcgc3ltYm9sKTsKICAvLyBmdW5jdGlvbiB0b2tlbk9mT3duZXJCeUluZGV4KGFkZHJlc3MgX293bmVyLCB1aW50MjU2IF9pbmRleCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2IHRva2VuSWQpOwogIC8vIGZ1bmN0aW9uIHRva2VuTWV0YWRhdGEodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nIGluZm9VcmwpOwp9CgovLy8gTW9kaWZpZWQgZnJvbSB0aGUgQ3J5cHRvQ2VsZWJyaXRpZXMgY29udHJhY3QKY29udHJhY3QgRW1vamlUb2tlbiBpcyBFUkM3MjEgewoKICAvKioqIEVWRU5UUyAqKiovCgogIC8vLyBAZGV2IFRoZSBCaXJ0aCBldmVudCBpcyBmaXJlZCB3aGVuZXZlciBhIG5ldyBlbW9qaSBjb21lcyBpbnRvIGV4aXN0ZW5jZS4KICBldmVudCBCaXJ0aCh1aW50MjU2IHRva2VuSWQsIHN0cmluZyBuYW1lLCBhZGRyZXNzIG93bmVyKTsKCiAgLy8vIEBkZXYgVGhlIFRva2VuU29sZCBldmVudCBpcyBmaXJlZCB3aGVuZXZlciBhIHRva2VuIGlzIHNvbGQuCiAgZXZlbnQgVG9rZW5Tb2xkKHVpbnQyNTYgdG9rZW5JZCwgdWludDI1NiBvbGRQcmljZSwgdWludDI1NiBuZXdQcmljZSwgYWRkcmVzcyBwcmV2T3duZXIsIGFkZHJlc3Mgd2lubmVyLCBzdHJpbmcgbmFtZSk7CgogIC8vLyBAZGV2IFRyYW5zZmVyIGV2ZW50IGFzIGRlZmluZWQgaW4gY3VycmVudCBkcmFmdCBvZiBFUkM3MjEuIAogIC8vLyAgb3duZXJzaGlwIGlzIGFzc2lnbmVkLCBpbmNsdWRpbmcgYmlydGhzLgogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB0b2tlbklkKTsKCiAgLyoqKiBDT05TVEFOVFMgKioqLwoKICAvLy8gQG5vdGljZSBOYW1lIGFuZCBzeW1ib2wgb2YgdGhlIG5vbiBmdW5naWJsZSB0b2tlbiwgYXMgZGVmaW5lZCBpbiBFUkM3MjEuCiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBOQU1FID0gIkVtb2ppQmxvY2tjaGFpbiI7IC8vIHNvbGhpbnQtZGlzYWJsZS1saW5lCiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBTWU1CT0wgPSAiRW1vamlUb2tlbiI7IC8vIHNvbGhpbnQtZGlzYWJsZS1saW5lCgogIHVpbnQyNTYgcHJpdmF0ZSBzdGFydGluZ1ByaWNlID0gMC4wMDEgZXRoZXI7CiAgdWludDI1NiBwcml2YXRlIGNvbnN0YW50IFBST01PX0NSRUFUSU9OX0xJTUlUID0gNzc7CiAgdWludDI1NiBwcml2YXRlIGZpcnN0U3RlcExpbWl0ID0gIDAuMDUgZXRoZXI7CiAgdWludDI1NiBwcml2YXRlIHNlY29uZFN0ZXBMaW1pdCA9IDAuNTUgZXRoZXI7CgogIC8qKiogU1RPUkFHRSAqKiovCgogIC8vLyBAZGV2IEEgbWFwcGluZyBmcm9tIGVtb2ppIElEcyB0byB0aGUgYWRkcmVzcyB0aGF0IG93bnMgdGhlbS4gQWxsIGVtb2ppcyBoYXZlCiAgLy8vICBzb21lIHZhbGlkIG93bmVyIGFkZHJlc3MuCiAgbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSBwdWJsaWMgZW1vamlJbmRleFRvT3duZXI7CgogIC8vIEBkZXYgQSBtYXBwaW5nIGZyb20gb3duZXIgYWRkcmVzcyB0byBjb3VudCBvZiB0b2tlbnMgdGhhdCBhZGRyZXNzIG93bnMuCiAgLy8gIFVzZWQgaW50ZXJuYWxseSBpbnNpZGUgYmFsYW5jZU9mKCkgdG8gcmVzb2x2ZSBvd25lcnNoaXAgY291bnQuCiAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwcml2YXRlIG93bmVyc2hpcFRva2VuQ291bnQ7CgogIC8vLyBAZGV2IEEgbWFwcGluZyBmcm9tIEVtb2ppSURzIHRvIGFuIGFkZHJlc3MgdGhhdCBoYXMgYmVlbiBhcHByb3ZlZCB0byBjYWxsCiAgLy8vICB0cmFuc2ZlckZyb20oKS4gRWFjaCBFbW9qaSBjYW4gb25seSBoYXZlIG9uZSBhcHByb3ZlZCBhZGRyZXNzIGZvciB0cmFuc2ZlcgogIC8vLyAgYXQgYW55IHRpbWUuIEEgemVybyB2YWx1ZSBtZWFucyBubyBhcHByb3ZhbCBpcyBvdXRzdGFuZGluZy4KICBtYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIHB1YmxpYyBlbW9qaUluZGV4VG9BcHByb3ZlZDsKCiAgLy8gQGRldiBBIG1hcHBpbmcgZnJvbSBFbW9qaUlEcyB0byB0aGUgcHJpY2Ugb2YgdGhlIHRva2VuLgogIG1hcHBpbmcgKHVpbnQyNTYgPT4gdWludDI1NikgcHJpdmF0ZSBlbW9qaUluZGV4VG9QcmljZTsKICAKICAvLy8gQGRldiBBIG1hcHBpbmcgZnJvbSBFbW9qaUlEcyB0byB0aGUgcHJldmlwdXMgcHJpY2Ugb2YgdGhlIHRva2VuLiBVc2VkCiAgLy8vIHRvIGNhbGN1bGF0ZSBwcmljZSBkZWx0YSBmb3IgcGF5b3V0cwogIG1hcHBpbmcgKHVpbnQyNTYgPT4gdWludDI1NikgcHJpdmF0ZSBlbW9qaUluZGV4VG9QcmV2aW91c1ByaWNlOwoKICAvLyBNWSBUSElORwogIC8vIEBkZXYgQSBtYXBwaW5nIGZyb20gZW1vamlJZCB0byB0aGUgY3VzdG9tIG1lc3NhZ2UgdGhlIG93bmVyIHNldC4KICBtYXBwaW5nICh1aW50MjU2ID0+IHN0cmluZykgcHJpdmF0ZSBlbW9qaUluZGV4VG9DdXN0b21NZXNzYWdlOwoKICAvLyBAZGV2IEEgbWFwcGluZyBmcm9tIGVtb2ppSWQgdG8gdGhlIDcgbGFzdCBvd25lcnMuCiAgbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzWzddKSBwcml2YXRlIGVtb2ppSW5kZXhUb1ByZXZpb3VzT3duZXJzOwoKCiAgLy8gVGhlIGFkZHJlc3NlcyBvZiB0aGUgYWNjb3VudHMgKG9yIGNvbnRyYWN0cykgdGhhdCBjYW4gZXhlY3V0ZSBhY3Rpb25zIHdpdGhpbiBlYWNoIHJvbGVzLgogIGFkZHJlc3MgcHVibGljIGNlb0FkZHJlc3M7CiAgYWRkcmVzcyBwdWJsaWMgY29vQWRkcmVzczsKCiAgdWludDI1NiBwdWJsaWMgcHJvbW9DcmVhdGVkQ291bnQ7CgogIC8qKiogREFUQVRZUEVTICoqKi8KICBzdHJ1Y3QgRW1vamkgewogICAgc3RyaW5nIG5hbWU7CiAgfQoKICBFbW9qaVtdIHByaXZhdGUgZW1vamlzOwoKICAvKioqIEFDQ0VTUyBNT0RJRklFUlMgKioqLwogIC8vLyBAZGV2IEFjY2VzcyBtb2RpZmllciBmb3IgQ0VPLW9ubHkgZnVuY3Rpb25hbGl0eQogIG1vZGlmaWVyIG9ubHlDRU8oKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY2VvQWRkcmVzcyk7CiAgICBfOwogIH0KCiAgLy8vIEBkZXYgQWNjZXNzIG1vZGlmaWVyIGZvciBDT08tb25seSBmdW5jdGlvbmFsaXR5CiAgbW9kaWZpZXIgb25seUNPTygpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjb29BZGRyZXNzKTsKICAgIF87CiAgfQoKICAvLy8gQWNjZXNzIG1vZGlmaWVyIGZvciBjb250cmFjdCBvd25lciBvbmx5IGZ1bmN0aW9uYWxpdHkKICBtb2RpZmllciBvbmx5Q0xldmVsKCkgewogICAgcmVxdWlyZSgKICAgICAgbXNnLnNlbmRlciA9PSBjZW9BZGRyZXNzIHx8CiAgICAgIG1zZy5zZW5kZXIgPT0gY29vQWRkcmVzcwogICAgKTsKICAgIF87CiAgfQoKICAvKioqIENPTlNUUlVDVE9SICoqKi8KICBmdW5jdGlvbiBFbW9qaVRva2VuKCkgcHVibGljIHsKICAgIGNlb0FkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgY29vQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgfQoKICAvKioqIFBVQkxJQyBGVU5DVElPTlMgKioqLwogIC8vLyBAbm90aWNlIEdyYW50IGFub3RoZXIgYWRkcmVzcyB0aGUgcmlnaHQgdG8gdHJhbnNmZXIgdG9rZW4gdmlhIHRha2VPd25lcnNoaXAoKSBhbmQgdHJhbnNmZXJGcm9tKCkuCiAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gYmUgZ3JhbnRlZCB0cmFuc2ZlciBhcHByb3ZhbC4gUGFzcyBhZGRyZXNzKDApIHRvCiAgLy8vICBjbGVhciBhbGwgYXBwcm92YWxzLgogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIElEIG9mIHRoZSBUb2tlbiB0aGF0IGNhbiBiZSB0cmFuc2ZlcnJlZCBpZiB0aGlzIGNhbGwgc3VjY2VlZHMuCiAgLy8vIEBkZXYgUmVxdWlyZWQgZm9yIEVSQy03MjEgY29tcGxpYW5jZS4KICBmdW5jdGlvbiBhcHByb3ZlKAogICAgYWRkcmVzcyBfdG8sCiAgICB1aW50MjU2IF90b2tlbklkCiAgKSBwdWJsaWMgewogICAgLy8gQ2FsbGVyIG11c3Qgb3duIHRva2VuLgogICAgcmVxdWlyZShfb3ducyhtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwoKICAgIGVtb2ppSW5kZXhUb0FwcHJvdmVkW190b2tlbklkXSA9IF90bzsKCiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfdG8sIF90b2tlbklkKTsKICB9CgogIC8vLyBGb3IgcXVlcnlpbmcgYmFsYW5jZSBvZiBhIHBhcnRpY3VsYXIgYWNjb3VudAogIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIGZvciBiYWxhbmNlIHF1ZXJ5CiAgLy8vIEBkZXYgUmVxdWlyZWQgZm9yIEVSQy03MjEgY29tcGxpYW5jZS4KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIG93bmVyc2hpcFRva2VuQ291bnRbX293bmVyXTsKICB9CgogIC8vLyBAZGV2IENyZWF0ZXMgYSBuZXcgcHJvbW8gRW1vamkgd2l0aCB0aGUgZ2l2ZW4gbmFtZSwgd2l0aCBnaXZlbiBfcHJpY2UgYW5kIGFzc2lnbmVzIGl0IHRvIGFuIGFkZHJlc3MuCiAgZnVuY3Rpb24gY3JlYXRlUHJvbW9FbW9qaShhZGRyZXNzIF9vd25lciwgc3RyaW5nIF9uYW1lLCB1aW50MjU2IF9wcmljZSkgcHVibGljIG9ubHlDT08gewogICAgcmVxdWlyZShwcm9tb0NyZWF0ZWRDb3VudCA8IFBST01PX0NSRUFUSU9OX0xJTUlUKTsKCiAgICBhZGRyZXNzIGVtb2ppT3duZXIgPSBfb3duZXI7CiAgICBpZiAoZW1vamlPd25lciA9PSBhZGRyZXNzKDApKSB7CiAgICAgIGVtb2ppT3duZXIgPSBjb29BZGRyZXNzOwogICAgfQoKICAgIGlmIChfcHJpY2UgPD0gMCkgewogICAgICBfcHJpY2UgPSBzdGFydGluZ1ByaWNlOwogICAgfQoKICAgIHByb21vQ3JlYXRlZENvdW50Kys7CiAgICBfY3JlYXRlRW1vamkoX25hbWUsIGVtb2ppT3duZXIsIF9wcmljZSk7CiAgfQoKICAvLy8gQGRldiBDcmVhdGVzIGEgbmV3IEVtb2ppIHdpdGggdGhlIGdpdmVuIG5hbWUuCiAgZnVuY3Rpb24gY3JlYXRlQ29udHJhY3RFbW9qaShzdHJpbmcgX25hbWUpIHB1YmxpYyBvbmx5Q09PIHsKICAgIF9jcmVhdGVFbW9qaShfbmFtZSwgYWRkcmVzcyh0aGlzKSwgc3RhcnRpbmdQcmljZSk7CiAgfQoKICAvLy8gQG5vdGljZSBSZXR1cm5zIGFsbCB0aGUgcmVsZXZhbnQgaW5mb3JtYXRpb24gYWJvdXQgYSBzcGVjaWZpYyBlbW9qaS4KICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSB0b2tlbklkIG9mIHRoZSBlbW9qaSBvZiBpbnRlcmVzdC4KICBmdW5jdGlvbiBnZXRFbW9qaSh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zICgKICAgIHN0cmluZyBlbW9qaU5hbWUsCiAgICB1aW50MjU2IHNlbGxpbmdQcmljZSwKICAgIGFkZHJlc3Mgb3duZXIsCiAgICBzdHJpbmcgbWVzc2FnZSwKICAgIHVpbnQyNTYgcHJldmlvdXNQcmljZSwKICAgIGFkZHJlc3NbN10gcHJldmlvdXNPd25lcnMKICApIHsKICAgIEVtb2ppIHN0b3JhZ2UgZW1vamkgPSBlbW9qaXNbX3Rva2VuSWRdOwogICAgZW1vamlOYW1lID0gZW1vamkubmFtZTsKICAgIHNlbGxpbmdQcmljZSA9IGVtb2ppSW5kZXhUb1ByaWNlW190b2tlbklkXTsKICAgIG93bmVyID0gZW1vamlJbmRleFRvT3duZXJbX3Rva2VuSWRdOwogICAgbWVzc2FnZSA9IGVtb2ppSW5kZXhUb0N1c3RvbU1lc3NhZ2VbX3Rva2VuSWRdOwogICAgcHJldmlvdXNQcmljZSA9IGVtb2ppSW5kZXhUb1ByZXZpb3VzUHJpY2VbX3Rva2VuSWRdOwogICAgcHJldmlvdXNPd25lcnMgPSBlbW9qaUluZGV4VG9QcmV2aW91c093bmVyc1tfdG9rZW5JZF07CiAgfQoKICBmdW5jdGlvbiBpbXBsZW1lbnRzRVJDNzIxKCkgcHVibGljIHB1cmUgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgcHVyZSByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBOQU1FOwogIH0KCiAgLy8vIEZvciBxdWVyeWluZyBvd25lciBvZiB0b2tlbgogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIHRva2VuSUQgZm9yIG93bmVyIGlucXVpcnkKICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkKICAgIHB1YmxpYwogICAgdmlldwogICAgcmV0dXJucyAoYWRkcmVzcyBvd25lcikKICB7CiAgICBvd25lciA9IGVtb2ppSW5kZXhUb093bmVyW190b2tlbklkXTsKICAgIHJlcXVpcmUob3duZXIgIT0gYWRkcmVzcygwKSk7CiAgfQoKICBmdW5jdGlvbiBwYXlvdXQoYWRkcmVzcyBfdG8pIHB1YmxpYyBvbmx5Q0xldmVsIHsKICAgIF9wYXlvdXQoX3RvKTsKICB9CgogIC8vIEFsbG93cyBvd25lciB0byBhZGQgc2hvcnQgbWVzc2FnZSB0byB0b2tlbgogIC8vIExpbWl0IGlzIGJhc2VkIG9uIFR3aXR0ZXIncyB0d2VldCBjaGFyYWN0ZXJsaW1pdAogIGZ1bmN0aW9uIGFkZE1lc3NhZ2UodWludDI1NiBfdG9rZW5JZCwgc3RyaW5nIF9tZXNzYWdlKSBwdWJsaWMgewogICAgcmVxdWlyZShfb3ducyhtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwogICAgcmVxdWlyZShieXRlcyhfbWVzc2FnZSkubGVuZ3RoPDI4MSk7CiAgICBlbW9qaUluZGV4VG9DdXN0b21NZXNzYWdlW190b2tlbklkXSA9IF9tZXNzYWdlOwogIH0KCiAgLy8gQWxsb3dzIHNvbWVvbmUgdG8gc2VuZCBldGhlciBhbmQgb2J0YWluIHRoZSB0b2tlbgogIGZ1bmN0aW9uIHB1cmNoYXNlKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBwYXlhYmxlIHsKICAgIGFkZHJlc3Mgb2xkT3duZXIgPSBlbW9qaUluZGV4VG9Pd25lcltfdG9rZW5JZF07CiAgICBhZGRyZXNzIG5ld093bmVyID0gbXNnLnNlbmRlcjsKICAgIAogICAgYWRkcmVzc1s3XSBzdG9yYWdlIHByZXZpb3VzT3duZXJzID0gZW1vamlJbmRleFRvUHJldmlvdXNPd25lcnNbX3Rva2VuSWRdOwoKICAgIHVpbnQyNTYgc2VsbGluZ1ByaWNlID0gZW1vamlJbmRleFRvUHJpY2VbX3Rva2VuSWRdOwogICAgdWludDI1NiBwcmV2aW91c1ByaWNlID0gZW1vamlJbmRleFRvUHJldmlvdXNQcmljZVtfdG9rZW5JZF07CgogICAgLy8gTWFraW5nIHN1cmUgdG9rZW4gb3duZXIgaXMgbm90IHNlbmRpbmcgdG8gc2VsZgogICAgcmVxdWlyZShvbGRPd25lciAhPSBuZXdPd25lcik7CgogICAgLy8gU2FmZXR5IGNoZWNrIHRvIHByZXZlbnQgYWdhaW5zdCBhbiB1bmV4cGVjdGVkIDB4MCBkZWZhdWx0LgogICAgcmVxdWlyZShfYWRkcmVzc05vdE51bGwobmV3T3duZXIpKTsKCiAgICAvLyBNYWtpbmcgc3VyZSBzZW50IGFtb3VudCBpcyBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gdGhlIHNlbGxpbmdQcmljZQogICAgcmVxdWlyZShtc2cudmFsdWUgPj0gc2VsbGluZ1ByaWNlKTsKCiAgICB1aW50MjU2IHByaWNlRGVsdGEgPSBTYWZlTWF0aC5zdWIoc2VsbGluZ1ByaWNlLCBwcmV2aW91c1ByaWNlKTsKICAgIHVpbnQyNTYgcGF5b3V0VG90YWwgPSB1aW50MjU2KFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwocHJpY2VEZWx0YSwgOTApLCAxMDApKTsKICAgIHVpbnQyNTYgcHVyY2hhc2VFeGNlc3MgPSBTYWZlTWF0aC5zdWIobXNnLnZhbHVlLCBzZWxsaW5nUHJpY2UpOwoKICAgIC8vIFVwZGF0ZSBwcmljZXMKICAgIGlmIChzZWxsaW5nUHJpY2UgPCBmaXJzdFN0ZXBMaW1pdCkgewogICAgICAvLyBmaXJzdCBzdGFnZQogICAgICBlbW9qaUluZGV4VG9QcmljZVtfdG9rZW5JZF0gPSBTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKHNlbGxpbmdQcmljZSwgMjAwKSwgOTApOwogICAgfSBlbHNlIGlmIChzZWxsaW5nUHJpY2UgPCBzZWNvbmRTdGVwTGltaXQpIHsKICAgICAgLy8gc2Vjb25kIHN0YWdlCiAgICAgIGVtb2ppSW5kZXhUb1ByaWNlW190b2tlbklkXSA9IFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoc2VsbGluZ1ByaWNlLCAxMjApLCA5MCk7CiAgICB9IGVsc2UgewogICAgICAvLyB0aGlyZCBzdGFnZQogICAgICBlbW9qaUluZGV4VG9QcmljZVtfdG9rZW5JZF0gPSBTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKHNlbGxpbmdQcmljZSwgMTE1KSwgOTApOwogICAgfQoKICAgIF90cmFuc2ZlcihvbGRPd25lciwgbmV3T3duZXIsIF90b2tlbklkKTsKCiAgICAvLyBQYXkgcHJldmlvdXMgdG9rZW5Pd25lciBpZiBvd25lciBpcyBub3QgY29udHJhY3QKICAgIC8vIGFuZCBpZiBwcmV2aW91cyBwcmljZSBpcyBub3QgMAogICAgaWYgKG9sZE93bmVyICE9IGFkZHJlc3ModGhpcykgJiYgcHJldmlvdXNQcmljZSA+IDApIHsKICAgICAgLy8gb2xkIG93bmVyIGdldHMgZW50aXJlIGluaXRpYWwgcGF5bWVudCBiYWNrCiAgICAgIG9sZE93bmVyLnRyYW5zZmVyKHByZXZpb3VzUHJpY2UpOwogICAgfQogICAgCiAgICAvLyBOZXh0IGRpc3RyaWJ1dGUgcGF5b3V0VG90YWwgYW1vbmcgcHJldmlvdXMgT3duZXJzCiAgICAvLyBEbyBub3QgZGlzdHJpYnV0ZSBpZiBwcmV2aW91cyBvd25lciBpcyBjb250cmFjdC4KICAgIC8vIFNwbGl0IGlzOiA3NSwgMTIsIDYsIDMsIDIsIDEuNSwgMC41CiAgICBpZiAocHJldmlvdXNPd25lcnNbMF0gIT0gYWRkcmVzcyh0aGlzKSAmJiBwYXlvdXRUb3RhbCA+IDApIHsKICAgICAgcHJldmlvdXNPd25lcnNbMF0udHJhbnNmZXIodWludDI1NihTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKHBheW91dFRvdGFsLCA3NSksIDEwMCkpKTsKICAgIH0KICAgIGlmIChwcmV2aW91c093bmVyc1sxXSAhPSBhZGRyZXNzKHRoaXMpICYmIHBheW91dFRvdGFsID4gMCkgewogICAgICBwcmV2aW91c093bmVyc1sxXS50cmFuc2Zlcih1aW50MjU2KFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwocGF5b3V0VG90YWwsIDEyKSwgMTAwKSkpOwogICAgfQogICAgaWYgKHByZXZpb3VzT3duZXJzWzJdICE9IGFkZHJlc3ModGhpcykgJiYgcGF5b3V0VG90YWwgPiAwKSB7CiAgICAgIHByZXZpb3VzT3duZXJzWzJdLnRyYW5zZmVyKHVpbnQyNTYoU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChwYXlvdXRUb3RhbCwgNiksIDEwMCkpKTsKICAgIH0KICAgIGlmIChwcmV2aW91c093bmVyc1szXSAhPSBhZGRyZXNzKHRoaXMpICYmIHBheW91dFRvdGFsID4gMCkgewogICAgICBwcmV2aW91c093bmVyc1szXS50cmFuc2Zlcih1aW50MjU2KFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwocGF5b3V0VG90YWwsIDMpLCAxMDApKSk7CiAgICB9CiAgICBpZiAocHJldmlvdXNPd25lcnNbNF0gIT0gYWRkcmVzcyh0aGlzKSAmJiBwYXlvdXRUb3RhbCA+IDApIHsKICAgICAgcHJldmlvdXNPd25lcnNbNF0udHJhbnNmZXIodWludDI1NihTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKHBheW91dFRvdGFsLCAyKSwgMTAwKSkpOwogICAgfQogICAgaWYgKHByZXZpb3VzT3duZXJzWzVdICE9IGFkZHJlc3ModGhpcykgJiYgcGF5b3V0VG90YWwgPiAwKSB7CiAgICAgIC8vIGRpdmlkZSBieSAxMDAwIHNpbmNlIHBlcmNlbnRhZ2UgaXMgMS41CiAgICAgIHByZXZpb3VzT3duZXJzWzVdLnRyYW5zZmVyKHVpbnQyNTYoU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChwYXlvdXRUb3RhbCwgMTUpLCAxMDAwKSkpOwogICAgfQogICAgaWYgKHByZXZpb3VzT3duZXJzWzZdICE9IGFkZHJlc3ModGhpcykgJiYgcGF5b3V0VG90YWwgPiAwKSB7CiAgICAgIC8vIGRpdmlkZSBieSAxMDAwIHNpbmNlIHBlcmNlbnRhZ2UgaXMgMC41CiAgICAgIHByZXZpb3VzT3duZXJzWzZdLnRyYW5zZmVyKHVpbnQyNTYoU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChwYXlvdXRUb3RhbCwgNSksIDEwMDApKSk7CiAgICB9CiAgICAKICAgIFRva2VuU29sZChfdG9rZW5JZCwgc2VsbGluZ1ByaWNlLCBlbW9qaUluZGV4VG9QcmljZVtfdG9rZW5JZF0sIG9sZE93bmVyLCBuZXdPd25lciwgZW1vamlzW190b2tlbklkXS5uYW1lKTsKCiAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHB1cmNoYXNlRXhjZXNzKTsKICB9CgogIGZ1bmN0aW9uIHByaWNlT2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBwcmljZSkgewogICAgcmV0dXJuIGVtb2ppSW5kZXhUb1ByaWNlW190b2tlbklkXTsKICB9CgogIC8vLyBAZGV2IEFzc2lnbnMgYSBuZXcgYWRkcmVzcyB0byBhY3QgYXMgdGhlIENFTy4gT25seSBhdmFpbGFibGUgdG8gdGhlIGN1cnJlbnQgQ0VPLgogIC8vLyBAcGFyYW0gX25ld0NFTyBUaGUgYWRkcmVzcyBvZiB0aGUgbmV3IENFTwogIGZ1bmN0aW9uIHNldENFTyhhZGRyZXNzIF9uZXdDRU8pIHB1YmxpYyBvbmx5Q0VPIHsKICAgIHJlcXVpcmUoX25ld0NFTyAhPSBhZGRyZXNzKDApKTsKCiAgICBjZW9BZGRyZXNzID0gX25ld0NFTzsKICB9CgogIC8vLyBAZGV2IEFzc2lnbnMgYSBuZXcgYWRkcmVzcyB0byBhY3QgYXMgdGhlIENPTy4gT25seSBhdmFpbGFibGUgdG8gdGhlIGN1cnJlbnQgQ09PLgogIC8vLyBAcGFyYW0gX25ld0NPTyBUaGUgYWRkcmVzcyBvZiB0aGUgbmV3IENPTwogIGZ1bmN0aW9uIHNldENPTyhhZGRyZXNzIF9uZXdDT08pIHB1YmxpYyBvbmx5Q0VPIHsKICAgIHJlcXVpcmUoX25ld0NPTyAhPSBhZGRyZXNzKDApKTsKICAgIGNvb0FkZHJlc3MgPSBfbmV3Q09POwogIH0KCiAgLy8vIEBkZXYgUmVxdWlyZWQgZm9yIEVSQy03MjEgY29tcGxpYW5jZS4KICBmdW5jdGlvbiBzeW1ib2woKSBwdWJsaWMgcHVyZSByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBTWU1CT0w7CiAgfQoKICAvLy8gQG5vdGljZSBBbGxvdyBwcmUtYXBwcm92ZWQgdXNlciB0byB0YWtlIG93bmVyc2hpcCBvZiBhIHRva2VuCiAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgSUQgb2YgdGhlIFRva2VuIHRoYXQgY2FuIGJlIHRyYW5zZmVycmVkIGlmIHRoaXMgY2FsbCBzdWNjZWVkcy4KICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHsKICAgIGFkZHJlc3MgbmV3T3duZXIgPSBtc2cuc2VuZGVyOwogICAgYWRkcmVzcyBvbGRPd25lciA9IGVtb2ppSW5kZXhUb093bmVyW190b2tlbklkXTsKCiAgICAvLyBTYWZldHkgY2hlY2sgdG8gcHJldmVudCBhZ2FpbnN0IGFuIHVuZXhwZWN0ZWQgMHgwIGRlZmF1bHQuCiAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChuZXdPd25lcikpOwoKICAgIC8vIE1ha2luZyBzdXJlIHRyYW5zZmVyIGlzIGFwcHJvdmVkCiAgICByZXF1aXJlKF9hcHByb3ZlZChuZXdPd25lciwgX3Rva2VuSWQpKTsKCiAgICBfdHJhbnNmZXIob2xkT3duZXIsIG5ld093bmVyLCBfdG9rZW5JZCk7CiAgfQoKICAvLy8gQHBhcmFtIF9vd25lciBUaGUgb3duZXIgd2hvc2UgZW1vamkgdG9rZW5zIHdlIGFyZSBpbnRlcmVzdGVkIGluLgogIC8vLyBAZGV2IFRoaXMgbWV0aG9kIE1VU1QgTkVWRVIgYmUgY2FsbGVkIGJ5IHNtYXJ0IGNvbnRyYWN0IGNvZGUuIEZpcnN0LCBpdCdzIGZhaXJseQogIC8vLyAgZXhwZW5zaXZlIChpdCB3YWxrcyB0aGUgZW50aXJlIEVtb2ppcyBhcnJheSBsb29raW5nIGZvciBlbW9qaXMgYmVsb25naW5nIHRvIG93bmVyKSwKICAvLy8gIGJ1dCBpdCBhbHNvIHJldHVybnMgYSBkeW5hbWljIGFycmF5LCB3aGljaCBpcyBvbmx5IHN1cHBvcnRlZCBmb3Igd2ViMyBjYWxscywgYW5kCiAgLy8vICBub3QgY29udHJhY3QtdG8tY29udHJhY3QgY2FsbHMuCiAgZnVuY3Rpb24gdG9rZW5zT2ZPd25lcihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyh1aW50MjU2W10gb3duZXJUb2tlbnMpIHsKICAgIHVpbnQyNTYgdG9rZW5Db3VudCA9IGJhbGFuY2VPZihfb3duZXIpOwogICAgaWYgKHRva2VuQ291bnQgPT0gMCkgewogICAgICAgIC8vIFJldHVybiBhbiBlbXB0eSBhcnJheQogICAgICByZXR1cm4gbmV3IHVpbnQyNTZbXSgwKTsKICAgIH0gZWxzZSB7CiAgICAgIHVpbnQyNTZbXSBtZW1vcnkgcmVzdWx0ID0gbmV3IHVpbnQyNTZbXSh0b2tlbkNvdW50KTsKICAgICAgdWludDI1NiB0b3RhbEVtb2ppcyA9IHRvdGFsU3VwcGx5KCk7CiAgICAgIHVpbnQyNTYgcmVzdWx0SW5kZXggPSAwOwogICAgICB1aW50MjU2IGVtb2ppSWQ7CiAgICAgIGZvciAoZW1vamlJZCA9IDA7IGVtb2ppSWQgPD0gdG90YWxFbW9qaXM7IGVtb2ppSWQrKykgewogICAgICAgIGlmIChlbW9qaUluZGV4VG9Pd25lcltlbW9qaUlkXSA9PSBfb3duZXIpIHsKICAgICAgICAgIHJlc3VsdFtyZXN1bHRJbmRleF0gPSBlbW9qaUlkOwogICAgICAgICAgcmVzdWx0SW5kZXgrKzsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICB9CgogIC8vLyBGb3IgcXVlcnlpbmcgdG90YWxTdXBwbHkgb2YgdG9rZW4KICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiB0b3RhbCkgewogICAgcmV0dXJuIGVtb2ppcy5sZW5ndGg7CiAgfQoKICAvLy8gT3duZXIgaW5pdGF0ZXMgdGhlIHRyYW5zZmVyIG9mIHRoZSB0b2tlbiB0byBhbm90aGVyIGFjY291bnQKICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBmb3IgdGhlIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkIHRvLgogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIElEIG9mIHRoZSBUb2tlbiB0aGF0IGNhbiBiZSB0cmFuc2ZlcnJlZCBpZiB0aGlzIGNhbGwgc3VjY2VlZHMuCiAgLy8vIEBkZXYgUmVxdWlyZWQgZm9yIEVSQy03MjEgY29tcGxpYW5jZS4KICBmdW5jdGlvbiB0cmFuc2ZlcigKICAgIGFkZHJlc3MgX3RvLAogICAgdWludDI1NiBfdG9rZW5JZAogICkgcHVibGljIHsKICAgIHJlcXVpcmUoX293bnMobXNnLnNlbmRlciwgX3Rva2VuSWQpKTsKICAgIHJlcXVpcmUoX2FkZHJlc3NOb3ROdWxsKF90bykpOwogICAgX3RyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3Rva2VuSWQpOwogIH0KCiAgLy8vIFRoaXJkLXBhcnR5IGluaXRpYXRlcyB0cmFuc2ZlciBvZiB0b2tlbiBmcm9tIGFkZHJlc3MgX2Zyb20gdG8gYWRkcmVzcyBfdG8KICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBhZGRyZXNzIGZvciB0aGUgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQgZnJvbS4KICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBmb3IgdGhlIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkIHRvLgogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIElEIG9mIHRoZSBUb2tlbiB0aGF0IGNhbiBiZSB0cmFuc2ZlcnJlZCBpZiB0aGlzIGNhbGwgc3VjY2VlZHMuCiAgLy8vIEBkZXYgUmVxdWlyZWQgZm9yIEVSQy03MjEgY29tcGxpYW5jZS4KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oCiAgICBhZGRyZXNzIF9mcm9tLAogICAgYWRkcmVzcyBfdG8sCiAgICB1aW50MjU2IF90b2tlbklkCiAgKSBwdWJsaWMgewogICAgcmVxdWlyZShfb3ducyhfZnJvbSwgX3Rva2VuSWQpKTsKICAgIHJlcXVpcmUoX2FwcHJvdmVkKF90bywgX3Rva2VuSWQpKTsKICAgIHJlcXVpcmUoX2FkZHJlc3NOb3ROdWxsKF90bykpOwogICAgX3RyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICB9CgogIC8qKiogUFJJVkFURSBGVU5DVElPTlMgKioqLwogIC8vLyBTYWZldHkgY2hlY2sgb24gX3RvIGFkZHJlc3MgdG8gcHJldmVudCBhZ2FpbnN0IGFuIHVuZXhwZWN0ZWQgMHgwIGRlZmF1bHQuCiAgZnVuY3Rpb24gX2FkZHJlc3NOb3ROdWxsKGFkZHJlc3MgX3RvKSBwcml2YXRlIHB1cmUgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIF90byAhPSBhZGRyZXNzKDApOwogIH0KCiAgLy8vIEZvciBjaGVja2luZyBhcHByb3ZhbCBvZiB0cmFuc2ZlciBmb3IgYWRkcmVzcyBfdG8KICBmdW5jdGlvbiBfYXBwcm92ZWQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gZW1vamlJbmRleFRvQXBwcm92ZWRbX3Rva2VuSWRdID09IF90bzsKICB9CgogIC8vLyBGb3IgY3JlYXRpbmcgRW1vamkKICBmdW5jdGlvbiBfY3JlYXRlRW1vamkoc3RyaW5nIF9uYW1lLCBhZGRyZXNzIF9vd25lciwgdWludDI1NiBfcHJpY2UpIHByaXZhdGUgewogICAgRW1vamkgbWVtb3J5IF9lbW9qaSA9IEVtb2ppKHsKICAgICAgbmFtZTogX25hbWUKICAgIH0pOwogICAgdWludDI1NiBuZXdFbW9qaUlkID0gZW1vamlzLnB1c2goX2Vtb2ppKSAtIDE7CgogICAgLy8gSXQncyBwcm9iYWJseSBuZXZlciBnb2luZyB0byBoYXBwZW4sIDQgYmlsbGlvbiB0b2tlbnMgYXJlIEEgTE9ULCBidXQKICAgIC8vIGxldCdzIGp1c3QgYmUgMTAwJSBzdXJlIHdlIG5ldmVyIGxldCB0aGlzIGhhcHBlbi4KICAgIHJlcXVpcmUobmV3RW1vamlJZCA9PSB1aW50MjU2KHVpbnQzMihuZXdFbW9qaUlkKSkpOwoKICAgIEJpcnRoKG5ld0Vtb2ppSWQsIF9uYW1lLCBfb3duZXIpOwoKICAgIGVtb2ppSW5kZXhUb1ByaWNlW25ld0Vtb2ppSWRdID0gX3ByaWNlOwogICAgZW1vamlJbmRleFRvUHJldmlvdXNQcmljZVtuZXdFbW9qaUlkXSA9IDA7CiAgICBlbW9qaUluZGV4VG9DdXN0b21NZXNzYWdlW25ld0Vtb2ppSWRdID0gJ2hpJzsKICAgIGVtb2ppSW5kZXhUb1ByZXZpb3VzT3duZXJzW25ld0Vtb2ppSWRdID0KICAgICAgICBbYWRkcmVzcyh0aGlzKSwgYWRkcmVzcyh0aGlzKSwgYWRkcmVzcyh0aGlzKSwgYWRkcmVzcyh0aGlzKSwgYWRkcmVzcyh0aGlzKSwgYWRkcmVzcyh0aGlzKSwgYWRkcmVzcyh0aGlzKV07CgogICAgLy8gVGhpcyB3aWxsIGFzc2lnbiBvd25lcnNoaXAsIGFuZCBhbHNvIGVtaXQgdGhlIFRyYW5zZmVyIGV2ZW50IGFzCiAgICAvLyBwZXIgRVJDNzIxIGRyYWZ0CiAgICBfdHJhbnNmZXIoYWRkcmVzcygwKSwgX293bmVyLCBuZXdFbW9qaUlkKTsKICB9CgogIC8vLyBDaGVjayBmb3IgdG9rZW4gb3duZXJzaGlwCiAgZnVuY3Rpb24gX293bnMoYWRkcmVzcyBjbGFpbWFudCwgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBjbGFpbWFudCA9PSBlbW9qaUluZGV4VG9Pd25lcltfdG9rZW5JZF07CiAgfQoKICAvLy8gRm9yIHBheWluZyBvdXQgYmFsYW5jZSBvbiBjb250cmFjdAogIGZ1bmN0aW9uIF9wYXlvdXQoYWRkcmVzcyBfdG8pIHByaXZhdGUgewogICAgaWYgKF90byA9PSBhZGRyZXNzKDApKSB7CiAgICAgIGNlb0FkZHJlc3MudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgIH0gZWxzZSB7CiAgICAgIF90by50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgfQogIH0KCiAgLy8vIEBkZXYgQXNzaWducyBvd25lcnNoaXAgb2YgYSBzcGVjaWZpYyBFbW9qaSB0byBhbiBhZGRyZXNzLgogIGZ1bmN0aW9uIF90cmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB7CiAgICAvLyBTaW5jZSB0aGUgbnVtYmVyIG9mIGVtb2ppcyBpcyBjYXBwZWQgdG8gMl4zMiB3ZSBjYW4ndCBvdmVyZmxvdyB0aGlzCiAgICBvd25lcnNoaXBUb2tlbkNvdW50W190b10rKzsKICAgIC8vdHJhbnNmZXIgb3duZXJzaGlwCiAgICBlbW9qaUluZGV4VG9Pd25lcltfdG9rZW5JZF0gPSBfdG87CiAgICAvLyBXaGVuIGNyZWF0aW5nIG5ldyBlbW9qaXMgX2Zyb20gaXMgMHgwLCBidXQgd2UgY2FuJ3QgYWNjb3VudCB0aGF0IGFkZHJlc3MuCiAgICBpZiAoX2Zyb20gIT0gYWRkcmVzcygwKSkgewogICAgICBvd25lcnNoaXBUb2tlbkNvdW50W19mcm9tXS0tOwogICAgICAvLyBjbGVhciBhbnkgcHJldmlvdXNseSBhcHByb3ZlZCBvd25lcnNoaXAgZXhjaGFuZ2UKICAgICAgZGVsZXRlIGVtb2ppSW5kZXhUb0FwcHJvdmVkW190b2tlbklkXTsKICAgIH0KICAgIC8vIFVwZGF0ZSB0aGUgZW1vamlJbmRleFRvUHJldmlvdXNPd25lcnMKICAgIGVtb2ppSW5kZXhUb1ByZXZpb3VzT3duZXJzW190b2tlbklkXVs2XT1lbW9qaUluZGV4VG9QcmV2aW91c093bmVyc1tfdG9rZW5JZF1bNV07CiAgICBlbW9qaUluZGV4VG9QcmV2aW91c093bmVyc1tfdG9rZW5JZF1bNV09ZW1vamlJbmRleFRvUHJldmlvdXNPd25lcnNbX3Rva2VuSWRdWzRdOwogICAgZW1vamlJbmRleFRvUHJldmlvdXNPd25lcnNbX3Rva2VuSWRdWzRdPWVtb2ppSW5kZXhUb1ByZXZpb3VzT3duZXJzW190b2tlbklkXVszXTsKICAgIGVtb2ppSW5kZXhUb1ByZXZpb3VzT3duZXJzW190b2tlbklkXVszXT1lbW9qaUluZGV4VG9QcmV2aW91c093bmVyc1tfdG9rZW5JZF1bMl07CiAgICBlbW9qaUluZGV4VG9QcmV2aW91c093bmVyc1tfdG9rZW5JZF1bMl09ZW1vamlJbmRleFRvUHJldmlvdXNPd25lcnNbX3Rva2VuSWRdWzFdOwogICAgZW1vamlJbmRleFRvUHJldmlvdXNPd25lcnNbX3Rva2VuSWRdWzFdPWVtb2ppSW5kZXhUb1ByZXZpb3VzT3duZXJzW190b2tlbklkXVswXTsKICAgIC8vIHRoZSBfZnJvbSBhZGRyZXNzIGZvciBjcmVhdGlvbiBpcyAwLCBzbyBpbnN0ZWFkIHNldCBpdCB0byB0aGUgY29udHJhY3QgYWRkcmVzcwogICAgaWYgKF9mcm9tICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICBlbW9qaUluZGV4VG9QcmV2aW91c093bmVyc1tfdG9rZW5JZF1bMF09X2Zyb207CiAgICB9IGVsc2UgewogICAgICAgIGVtb2ppSW5kZXhUb1ByZXZpb3VzT3duZXJzW190b2tlbklkXVswXT1hZGRyZXNzKHRoaXMpOwogICAgfQogICAgLy8gRW1pdCB0aGUgdHJhbnNmZXIgZXZlbnQuCiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgfQp9CmxpYnJhcnkgU2FmZU1hdGggewoKICAvKioKICAqIEBkZXYgTXVsdGlwbGllcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICovCiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IEludGVnZXIgZGl2aXNpb24gb2YgdHdvIG51bWJlcnMsIHRydW5jYXRpbmcgdGhlIHF1b3RpZW50LgogICovCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICAvKioKICAqIEBkZXYgU3Vic3RyYWN0cyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93IChpLmUuIGlmIHN1YnRyYWhlbmQgaXMgZ3JlYXRlciB0aGFuIG1pbnVlbmQpLgogICovCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgLyoqCiAgKiBAZGV2IEFkZHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9'.
	

]
