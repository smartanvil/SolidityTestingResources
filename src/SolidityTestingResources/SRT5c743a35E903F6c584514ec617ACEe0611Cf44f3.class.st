Class {
	#name : #SRT5c743a35E903F6c584514ec617ACEe0611Cf44f3,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT5c743a35E903F6c584514ec617ACEe0611Cf44f3 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7Cgpjb250cmFjdCBFUkMyMjNSZWNlaXZpbmdDb250cmFjdCB7CiAgZnVuY3Rpb24gdG9rZW5GYWxsYmFjayhhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2RhdGEpIHB1YmxpYzsKfQoKY29udHJhY3QgRVJDMjIzVG9rZW4gewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAvLyB0b2tlbiBjb25zdGFudHMKICBzdHJpbmcgcHVibGljIG5hbWU7CiAgYnl0ZXMzMiBwdWJsaWMgc3ltYm9sOwogIHVpbnQ4IHB1YmxpYyBkZWNpbWFsczsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgLy8gdG9rZW4gYmFsYW5jZXMKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGJhbGFuY2VPZjsKICAvLyB0b2tlbiBzcGVuZGluZyBhbGxvd2FuY2UsIHVzZWQgYnkgdHJhbnNmZXJGcm9tKCksIGZvciBjb21wbGlhbmNlIHdpdGggRVJDMjAKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSkgaW50ZXJuYWwgYWxsb3dhbmNlczsKCiAgLy8gRnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgd2hlbiBhIHVzZXIgb3IgYW5vdGhlciBjb250cmFjdCB3YW50cyB0byB0cmFuc2ZlciBmdW5kcy4KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlLCBieXRlcyBkYXRhKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPj0gdmFsdWUpOwogICAgdWludDI1NiBjb2RlTGVuZ3RoOwoKICAgIGFzc2VtYmx5IHsKICAgICAgLy8gUmV0cmlldmUgdGhlIHNpemUgb2YgdGhlIGNvZGUgb24gdGFyZ2V0IGFkZHJlc3MsIHRoaXMgbmVlZHMgYXNzZW1ibHkgLgogICAgICBjb2RlTGVuZ3RoIDo9IGV4dGNvZGVzaXplKHRvKQogICAgfQoKICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSAtPSB2YWx1ZTsgIC8vIHVuZGVyZmxvdyBjaGVja2VkIGJ5IHJlcXVpcmUoKSBhYm92ZQogICAgYmFsYW5jZU9mW3RvXSA9IGJhbGFuY2VPZlt0b10uYWRkKHZhbHVlKTsKICAgIGlmIChjb2RlTGVuZ3RoID4gMCkgewogICAgICBFUkMyMjNSZWNlaXZpbmdDb250cmFjdCByZWNlaXZlciA9IEVSQzIyM1JlY2VpdmluZ0NvbnRyYWN0KHRvKTsKICAgICAgcmVjZWl2ZXIudG9rZW5GYWxsYmFjayhtc2cuc2VuZGVyLCB2YWx1ZSwgZGF0YSk7CiAgICB9CiAgICBFUkMyMjNUcmFuc2Zlcihtc2cuc2VuZGVyLCB0bywgdmFsdWUsIGRhdGEpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLyBTdGFuZGFyZCBmdW5jdGlvbiB0cmFuc2ZlciBzaW1pbGFyIHRvIEVSQzIwIHRyYW5zZmVyIHdpdGggbm8gX2RhdGEuCiAgLy8gQWRkZWQgZHVlIHRvIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IHJlYXNvbnMuCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoYmFsYW5jZU9mW21zZy5zZW5kZXJdID49IHZhbHVlKTsKICAgIHVpbnQyNTYgY29kZUxlbmd0aDsKICAgIGJ5dGVzIG1lbW9yeSBlbXB0eTsKCiAgICBhc3NlbWJseSB7CiAgICAgIC8vIFJldHJpZXZlIHRoZSBzaXplIG9mIHRoZSBjb2RlIG9uIHRhcmdldCBhZGRyZXNzLCB0aGlzIG5lZWRzIGFzc2VtYmx5LgogICAgICBjb2RlTGVuZ3RoIDo9IGV4dGNvZGVzaXplKHRvKQogICAgfQoKICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSAtPSB2YWx1ZTsgIC8vIHVuZGVyZmxvdyBjaGVja2VkIGJ5IHJlcXVpcmUoKSBhYm92ZQogICAgYmFsYW5jZU9mW3RvXSA9IGJhbGFuY2VPZlt0b10uYWRkKHZhbHVlKTsKICAgIGlmIChjb2RlTGVuZ3RoID4gMCkgewogICAgICBFUkMyMjNSZWNlaXZpbmdDb250cmFjdCByZWNlaXZlciA9IEVSQzIyM1JlY2VpdmluZ0NvbnRyYWN0KHRvKTsKICAgICAgcmVjZWl2ZXIudG9rZW5GYWxsYmFjayhtc2cuc2VuZGVyLCB2YWx1ZSwgZW1wdHkpOwogICAgfQogICAgRVJDMjIzVHJhbnNmZXIobXNnLnNlbmRlciwgdG8sIHZhbHVlLCBlbXB0eSk7CiAgICAvLyBFUkMyMCBjb21wYXRpYmxlIGV2ZW50OgogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgdG8sIHZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLy8gU2VuZCBfdmFsdWUgdG9rZW5zIHRvIF90byBmcm9tIF9mcm9tIG9uIHRoZSBjb25kaXRpb24gaXQgaXMgYXBwcm92ZWQgYnkgX2Zyb20uCiAgLy8gQWRkZWQgZm9yIGZ1bGwgY29tcGxpYW5jZSB3aXRoIEVSQzIwCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlT2ZbX2Zyb21dKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93YW5jZXNbX2Zyb21dW21zZy5zZW5kZXJdKTsKICAgIGJ5dGVzIG1lbW9yeSBlbXB0eTsKCiAgICBiYWxhbmNlT2ZbX2Zyb21dID0gYmFsYW5jZU9mW19mcm9tXSAtPSBfdmFsdWU7CiAgICBhbGxvd2FuY2VzW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICBiYWxhbmNlT2ZbX3RvXSA9IGJhbGFuY2VPZltfdG9dLmFkZChfdmFsdWUpOwoKICAgIC8vIE5vIG5lZWQgdG8gY2FsbCB0b2tlbkZhbGxiYWNrKCksIGNhdXNlIHRoaXMgaXMgRVJDMjAncyBzb2x1dGlvbiB0byB0aGUgc2FtZSBwcm9ibGVtCiAgICAvLyB0b2tlbkZhbGxiYWNrIHNvbHZlcyBpbiBFUkMyMjMuIEp1c3QgZmlyZSB0aGUgRVJDMjIzIGV2ZW50IGZvciBsb2dzIGNvbnNpc3RlbmN5LgogICAgRVJDMjIzVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlLCBlbXB0eSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLyBBbGxvdyBfc3BlbmRlciB0byB3aXRoZHJhdyBmcm9tIHlvdXIgYWNjb3VudCwgbXVsdGlwbGUgdGltZXMsIHVwIHRvIHRoZSBfdmFsdWUgYW1vdW50LgogIC8vIElmIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGFnYWluIGl0IG92ZXJ3cml0ZXMgdGhlIGN1cnJlbnQgYWxsb3dhbmNlIHdpdGggX3ZhbHVlLgogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIGFsbG93YW5jZXNbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8vIFJldHVybnMgdGhlIGFtb3VudCB3aGljaCBfc3BlbmRlciBpcyBzdGlsbCBhbGxvd2VkIHRvIHdpdGhkcmF3IGZyb20gX293bmVyCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgcmV0dXJuIGFsbG93YW5jZXNbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICBldmVudCBFUkMyMjNUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlLCBieXRlcyBpbmRleGVkIGRhdGEpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCmNvbnRyYWN0IEVSQzIyM01pbnRhYmxlVG9rZW4gaXMgRVJDMjIzVG9rZW4gewogIHVpbnQyNTYgcHVibGljIGNpcmN1bGF0aW5nU3VwcGx5OwogIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgdWludDI1NiBjb2RlTGVuZ3RoOwoKICAgIGFzc2VtYmx5IHsKICAgICAgLy8gUmV0cmlldmUgdGhlIHNpemUgb2YgdGhlIGNvZGUgb24gdGFyZ2V0IGFkZHJlc3MsIHRoaXMgbmVlZHMgYXNzZW1ibHkgLgogICAgICBjb2RlTGVuZ3RoIDo9IGV4dGNvZGVzaXplKHRvKQogICAgfQoKICAgIGNpcmN1bGF0aW5nU3VwcGx5ICs9IHZhbHVlOwoKICAgIGJhbGFuY2VPZlt0b10gKz0gdmFsdWU7ICAvLyBObyBzYWZlIG1hdGggbmVlZGVkLCB3b24ndCBleGNlZWQgdG90YWxTdXBwbHkuCiAgICBpZiAoY29kZUxlbmd0aCA+IDApIHsKICAgICAgRVJDMjIzUmVjZWl2aW5nQ29udHJhY3QgcmVjZWl2ZXIgPSBFUkMyMjNSZWNlaXZpbmdDb250cmFjdCh0byk7CiAgICAgIGJ5dGVzIG1lbW9yeSBlbXB0eTsKICAgICAgcmVjZWl2ZXIudG9rZW5GYWxsYmFjayhtc2cuc2VuZGVyLCB2YWx1ZSwgZW1wdHkpOwogICAgfQogICAgTWludCh0bywgdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCmNvbnRyYWN0IEVSQzIwVG9rZW4gewogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIG93bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdG9rZW5zKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKfQoKY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9Cgp9Cgpjb250cmFjdCBCb3VudHlUb2tlbkFsbG9jYXRpb24gaXMgT3duYWJsZSB7CgogIC8vIFRoaXMgY29udHJhY3QgZGVzY3JpYmVzIGhvdyB0aGUgYm91bnR5IHRva2VucyBhcmUgYWxsb2NhdGVkLgogIC8vIEFmdGVyIGEgYm91bnR5IGFsbG9jYXRpb24gd2FzIHByb3Bvc2VkIGJ5IGEgc2lnbmF0b3J5LCBhbm90aGVyCiAgLy8gc2lnbmF0b3J5IG11c3QgYWNjZXB0IHRoaXMgYWxsb2NhdGlvbi4KCiAgLy8gVG90YWwgYW1vdW50IG9mIHJlbWFpbmluZyB0b2tlbnMgdG8gYmUgZGlzdHJpYnV0ZWQKICB1aW50MjU2IHB1YmxpYyByZW1haW5pbmdCb3VudHlUb2tlbnM7CgogIC8vIEFkZHJlc3NlcyB3aGljaCBoYXZlIGEgYm91bnR5IGFsbG9jYXRpb24sIGluIG9yZGVyIG9mIHByb3Bvc2FscwogIGFkZHJlc3NbXSBwdWJsaWMgYWxsb2NhdGlvbkFkZHJlc3NMaXN0OwoKICAvLyBQb3NzaWJsZSBzcGxpdCBzdGF0ZXM6IFByb3Bvc2VkLCBBcHByb3ZlZCwgUmVqZWN0ZWQKICAvLyBQcm9wb3NlZCBpcyB0aGUgaW5pdGlhbCBzdGF0ZS4KICAvLyBCb3RoIEFwcHJvdmVkIGFuZCBSZWplY3RlZCBhcmUgZmluYWwgc3RhdGVzLgogIC8vIFRoZSBvbmx5IHBvc3NpYmxlIHRyYW5zaXRpb25zIGFyZToKICAvLyBQcm9wb3NlZCA9PiBBcHByb3ZlZAogIC8vIFByb3Bvc2VkID0+IFJlamVjdGVkCgogIC8vIGtlZXAgbWFwIGhlcmUgb2YgYm91bnR5IHByb3Bvc2FscwogIG1hcHBpbmcgKGFkZHJlc3MgPT4gVHlwZXMuU3RydWN0Qm91bnR5QWxsb2NhdGlvbikgcHVibGljIGJvdW50eU9mOwoKICAvKioKICAgKiBCb3VudHkgdG9rZW4gYWxsb2NhdGlvbiBjb25zdHJ1Y3Rvci4KICAgKgogICAqIEBwYXJhbSBfcmVtYWluaW5nQm91bnR5VG9rZW5zIFRvdGFsIG51bWJlciBvZiBib3VudHkgdG9rZW5zIHRoYXQgd2lsbCBiZQogICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsbG9jYXRlZC4KICAgKi8KICBmdW5jdGlvbiBCb3VudHlUb2tlbkFsbG9jYXRpb24odWludDI1NiBfcmVtYWluaW5nQm91bnR5VG9rZW5zKSBPd25hYmxlKCkgcHVibGljIHsKICAgIHJlbWFpbmluZ0JvdW50eVRva2VucyA9IF9yZW1haW5pbmdCb3VudHlUb2tlbnM7CiAgfQoKICAvKioKICAgKiBQcm9wb3NlIGEgYm91bnR5IHRyYW5zZmVyCiAgICoKICAgKiBAcGFyYW0gX2Rlc3QgQWRkcmVzcyBvZiBib3VudHkgcmVjaWVwZW50CiAgICogQHBhcmFtIF9hbW91bnQgQW1vdW50IG9mIHRva2VucyBoZSB3aWxsIHJlY2VpdmUKICAgKi8KICBmdW5jdGlvbiBwcm9wb3NlQm91bnR5VHJhbnNmZXIoYWRkcmVzcyBfZGVzdCwgdWludDI1NiBfYW1vdW50KSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUoX2Ftb3VudCA+IDApOwogICAgcmVxdWlyZShfYW1vdW50IDw9IHJlbWFpbmluZ0JvdW50eVRva2Vucyk7CiAgICAgLy8gd2UgY2FuJ3Qgb3ZlcndyaXRlIGV4aXN0aW5nIHByb3Bvc2FsCiAgICAgLy8gYnV0IHdlIGNhbiBvdmVyd3JpdGUgcmVqZWN0ZWQgcHJvcG9zYWwgd2l0aCBuZXcgdmFsdWVzCiAgICByZXF1aXJlKGJvdW50eU9mW19kZXN0XS5wcm9wb3NhbEFkZHJlc3MgPT0gMHgwIHx8IGJvdW50eU9mW19kZXN0XS5ib3VudHlTdGF0ZSA9PSBUeXBlcy5Cb3VudHlTdGF0ZS5SZWplY3RlZCk7CgogICAgaWYgKGJvdW50eU9mW19kZXN0XS5ib3VudHlTdGF0ZSAhPSBUeXBlcy5Cb3VudHlTdGF0ZS5SZWplY3RlZCkgewogICAgICBhbGxvY2F0aW9uQWRkcmVzc0xpc3QucHVzaChfZGVzdCk7CiAgICB9CgogICAgcmVtYWluaW5nQm91bnR5VG9rZW5zID0gU2FmZU1hdGguc3ViKHJlbWFpbmluZ0JvdW50eVRva2VucywgX2Ftb3VudCk7CiAgICBib3VudHlPZltfZGVzdF0gPSBUeXBlcy5TdHJ1Y3RCb3VudHlBbGxvY2F0aW9uKHsKICAgICAgYW1vdW50OiBfYW1vdW50LAogICAgICBwcm9wb3NhbEFkZHJlc3M6IG1zZy5zZW5kZXIsCiAgICAgIGJvdW50eVN0YXRlOiBUeXBlcy5Cb3VudHlTdGF0ZS5Qcm9wb3NlZAogICAgfSk7CiAgfQoKICAvKioKICAgKiBBcHByb3ZlcyBhIGJvdW50eSB0cmFuc2ZlcgogICAqCiAgICogQHBhcmFtIF9kZXN0IEFkZHJlc3Mgb2YgYm91bnR5IHJlY2llcGVudAogICAqIEByZXR1cm4gYW1vdW50IG9mIHRva2VucyB3aGljaCB3ZSBhcHByb3ZlZAogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmVCb3VudHlUcmFuc2ZlcihhZGRyZXNzIF9hcHByb3ZlckFkZHJlc3MsIGFkZHJlc3MgX2Rlc3QpIHB1YmxpYyBvbmx5T3duZXIgcmV0dXJucyAodWludDI1NikgewogICAgcmVxdWlyZShib3VudHlPZltfZGVzdF0uYm91bnR5U3RhdGUgPT0gVHlwZXMuQm91bnR5U3RhdGUuUHJvcG9zZWQpOwogICAgcmVxdWlyZShib3VudHlPZltfZGVzdF0ucHJvcG9zYWxBZGRyZXNzICE9IF9hcHByb3ZlckFkZHJlc3MpOwoKICAgIGJvdW50eU9mW19kZXN0XS5ib3VudHlTdGF0ZSA9IFR5cGVzLkJvdW50eVN0YXRlLkFwcHJvdmVkOwogICAgcmV0dXJuIGJvdW50eU9mW19kZXN0XS5hbW91bnQ7CiAgfQoKICAvKioKICAgKiBSZWplY3RzIGEgYm91bnR5IHRyYW5zZmVyCiAgICoKICAgKiBAcGFyYW0gX2Rlc3QgQWRkcmVzcyBvZiBib3VudHkgcmVjaWVwZW50IGZvciB3aG9tIHdlIGFyZSByZWplY3RpbmcgYm91bnR5IHRyYW5zZmVyCiAgICovCiAgZnVuY3Rpb24gcmVqZWN0Qm91bnR5VHJhbnNmZXIoYWRkcmVzcyBfZGVzdCkgcHVibGljIG9ubHlPd25lciB7CiAgICB2YXIgdG1wID0gYm91bnR5T2ZbX2Rlc3RdOwogICAgcmVxdWlyZSh0bXAuYm91bnR5U3RhdGUgPT0gVHlwZXMuQm91bnR5U3RhdGUuUHJvcG9zZWQpOwoKICAgIGJvdW50eU9mW19kZXN0XS5ib3VudHlTdGF0ZSA9IFR5cGVzLkJvdW50eVN0YXRlLlJlamVjdGVkOwogICAgcmVtYWluaW5nQm91bnR5VG9rZW5zID0gcmVtYWluaW5nQm91bnR5VG9rZW5zICsgYm91bnR5T2ZbX2Rlc3RdLmFtb3VudDsKICB9Cgp9CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIHB1cmUgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIHB1cmUgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KICBmdW5jdGlvbiBtaW4odWludDI1NiBhLCB1aW50MjU2IGIpIHB1cmUgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgaWYoYSA+IGIpCiAgICAgIHJldHVybiBiOwogICAgZWxzZQogICAgICByZXR1cm4gYTsKICB9Cn0KCmNvbnRyYWN0IFNpZ25hdG9yeU93bmFibGUgewogIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIElTX1NJR05BVE9SWTsKCiAgZnVuY3Rpb24gU2lnbmF0b3J5T3duYWJsZShhZGRyZXNzIHNpZ25hdG9yeTAsIGFkZHJlc3Mgc2lnbmF0b3J5MSwgYWRkcmVzcyBzaWduYXRvcnkyKSBpbnRlcm5hbCB7CiAgICBJU19TSUdOQVRPUllbc2lnbmF0b3J5MF0gPSB0cnVlOwogICAgSVNfU0lHTkFUT1JZW3NpZ25hdG9yeTFdID0gdHJ1ZTsKICAgIElTX1NJR05BVE9SWVtzaWduYXRvcnkyXSA9IHRydWU7CiAgfQoKICBtb2RpZmllciBvbmx5U2lnbmF0b3J5KCkgewogICAgcmVxdWlyZShJU19TSUdOQVRPUllbbXNnLnNlbmRlcl0pOwogICAgXzsKICB9Cn0KCmNvbnRyYWN0IFNpZ25hdG9yeVBhdXNhYmxlIGlzIFNpZ25hdG9yeU93bmFibGUgewogIGJvb2wgcHVibGljIHBhdXNlZDsgIC8vID09IGZhbHNlIGJ5IGRlZmF1bHQKICBhZGRyZXNzIHB1YmxpYyBwYXVzZVByb3Bvc2VyOyAgLy8gPT0gMHgwIChubyBwcm9wb3NhbCkgYnkgZGVmYXVsdAoKICBmdW5jdGlvbiBTaWduYXRvcnlQYXVzYWJsZShhZGRyZXNzIHNpZ25hdG9yeTAsIGFkZHJlc3Mgc2lnbmF0b3J5MSwgYWRkcmVzcyBzaWduYXRvcnkyKQogICAgICBTaWduYXRvcnlPd25hYmxlKHNpZ25hdG9yeTAsIHNpZ25hdG9yeTEsIHNpZ25hdG9yeTIpCiAgICAgIGludGVybmFsIHt9CgogIG1vZGlmaWVyIHdoZW5QYXVzZWQoYm9vbCBzdGF0dXMpIHsKICAgIHJlcXVpcmUocGF1c2VkID09IHN0YXR1cyk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBGaXJzdCBzaWduYXRvcnkgY29uc2VudCBmb3IgY29udHJhY3QgcGF1c2Ugc3RhdGUgY2hhbmdlLgogICAqLwogIGZ1bmN0aW9uIHByb3Bvc2VQYXVzZUNoYW5nZShib29sIHN0YXR1cykgb25seVNpZ25hdG9yeSB3aGVuUGF1c2VkKCFzdGF0dXMpIHB1YmxpYyB7CiAgICByZXF1aXJlKHBhdXNlUHJvcG9zZXIgPT0gMHgwKTsgIC8vIHJlcXVpcmUgdGhlcmUncyBubyBwZW5kaW5nIHByb3Bvc2FsIGFscmVhZHkKICAgIHBhdXNlUHJvcG9zZXIgPSBtc2cuc2VuZGVyOwogIH0KCiAgLyoqCiAgICogQGRldiBTZWNvbmQgc2lnbmF0b3J5IGNvbnNlbnQgZm9yIGNvbnRyYWN0IHBhdXNlIHN0YXRlIGNoYW5nZSwgdHJpZ2dlcnMgdGhlIGNoYW5nZS4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlUGF1c2VDaGFuZ2UoYm9vbCBzdGF0dXMpIG9ubHlTaWduYXRvcnkgd2hlblBhdXNlZCghc3RhdHVzKSBwdWJsaWMgewogICAgcmVxdWlyZShwYXVzZVByb3Bvc2VyICE9IDB4MCk7ICAvLyByZXF1aXJlIHRoYXQgYSBjaGFuZ2Ugd2FzIGFscmVhZHkgcHJvcG9zZWQKICAgIHJlcXVpcmUocGF1c2VQcm9wb3NlciAhPSBtc2cuc2VuZGVyKTsgIC8vIGFwcHJvdmVyIG11c3QgYmUgZGlmZmVyZW50IHRoYW4gcHJvcG9zZXIKICAgIHBhdXNlUHJvcG9zZXIgPSAweDA7CiAgICBwYXVzZWQgPSBzdGF0dXM7CiAgICBMb2dQYXVzZShwYXVzZWQpOwogIH0KCiAgLyoqCiAgICogQGRldiBSZWplY3QgcGF1c2Ugc3RhdHVzIGNoYW5nZSBwcm9wb3NhbC4KICAgKiBDYW4gYWxzbyBiZSBjYWxsZWQgYnkgdGhlIHByb3Bvc2VyLCB0byBjYW5jZWwgaGlzIHByb3Bvc2FsLgogICAqLwogIGZ1bmN0aW9uIHJlamVjdFBhdXNlQ2hhbmdlKGJvb2wgc3RhdHVzKSBvbmx5U2lnbmF0b3J5IHdoZW5QYXVzZWQoIXN0YXR1cykgcHVibGljIHsKICAgIHBhdXNlUHJvcG9zZXIgPSAweDA7CiAgfQoKICBldmVudCBMb2dQYXVzZShib29sIHN0YXR1cyk7Cn0KCmNvbnRyYWN0IEV4eVRva2VuIGlzIEVSQzIyM01pbnRhYmxlVG9rZW4sIFNpZ25hdG9yeVBhdXNhYmxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgVmVzdGluZ0FsbG9jYXRpb24gcHJpdmF0ZSBwYXJ0bmVyVG9rZW5zQWxsb2NhdGlvbjsKICBWZXN0aW5nQWxsb2NhdGlvbiBwcml2YXRlIGNvbXBhbnlUb2tlbnNBbGxvY2F0aW9uOwogIEJvdW50eVRva2VuQWxsb2NhdGlvbiBwcml2YXRlIGJvdW50eVRva2Vuc0FsbG9jYXRpb247CgogIC8qCiAgICogSUNPIFRPS0VOUwogICAqIDMzJSAoaW5jbHVkaW5nIFNFRUQgVE9LRU5TKQogICAqCiAgICogSWNvIHRva2VucyBhcmUgc2VudCB0byB0aGUgSUNPX1RPS0VOX0FERFJFU1MgaW1tZWRpYXRlbHkKICAgKiBhZnRlciBFeHlUb2tlbiBpbml0aWFsaXphdGlvbgogICAqLwogIHVpbnQyNTYgcHJpdmF0ZSBjb25zdGFudCBJQ09fVE9LRU5TID0gMTQ1MDM1MDYxMTIyNDg1MDAwMDAwMDAwMDA7CiAgYWRkcmVzcyBwcml2YXRlIGNvbnN0YW50IElDT19UT0tFTlNfQUREUkVTUyA9IDB4OTdjOTY3NTI0ZDFlYWNBRWIzNzVkNDI2OWJFNDE3MTU4MWEyODlDNzsKICAvKgogICAqIFNFRUQgVE9LRU5TCiAgICogMzMlIChpbmNsdWRpbmcgSUNPIFRPS0VOUykKICAgKgogICAqIFNlZWQgdG9rZW5zIGFyZSBzZW50IHRvIHRoZSBTRUVEX1RPS0VOU19BRERSRVNTIGltbWVkaWF0ZWx5CiAgICogYWZ0ZXIgRXh5VG9rZW4gaW5pdGlhbGl6YXRpb24KICAgKi8KICB1aW50MjU2IHByaXZhdGUgY29uc3RhbnQgU0VFRF9UT0tFTlMgPSAxMTcwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDsKICBhZGRyZXNzIHByaXZhdGUgY29uc3RhbnQgU0VFRF9UT0tFTlNfQUREUkVTUyA9IDB4N0MzMmM3NjQ5YUExMzM1MjcxYUYwMGNkNDI4MGY4NzE2NjQ3NDc3ODsKCiAgLyoKICAgKiBDT01QQU5ZIFRPS0VOUwogICAqIDMzJQogICAqCiAgICogQ29tcGFueSB0b2tlbnMgYXJlIGJlaW5nIGRpc3RydWJpdGVkIGluIDM2IG1vbnRocwogICAqIFRvdGFsIHRva2VucyA9IENPTVBBTllfVE9LRU5TX1BFUl9QRVJJT0QgKiBDT01QQU5ZX1BFUklPRFMKICAgKi8KICB1aW50MjU2IHByaXZhdGUgY29uc3RhbnQgQ09NUEFOWV9UT0tFTlNfUEVSX1BFUklPRCA9IDcyNzg3NTE2OTc4NDY4MDAwMDAwMDAwMDsKICB1aW50MjU2IHByaXZhdGUgY29uc3RhbnQgQ09NUEFOWV9QRVJJT0RTID0gMzY7CiAgdWludDI1NiBwcml2YXRlIGNvbnN0YW50IE1JTlVURVNfSU5fQ09NUEFOWV9QRVJJT0QgPSA2MCAqIDI0ICogMzY1IC8gMTI7CgogIC8qCiAgICogUEFSVE5FUiBUT0tFTlMKICAgKiAzMCUKICAgKgogICAqIFBhcnRuZXIgdG9rZW5zIGFyZSBhdmFpbGFibGUgYWZ0ZXIgMTggbW9udGhzCiAgICogVG90YWwgdG9rZW5zID0gUEFSVE5FUl9UT0tFTlNfUEVSX1BFUklPRCAqIFBBUlRORVJfUEVSSU9EUwogICAqLwogIHVpbnQyNTYgcHJpdmF0ZSBjb25zdGFudCBQQVJUTkVSX1RPS0VOU19QRVJfUEVSSU9EID0gMjM4MjEzNjkxOTI5NTMyMDAwMDAwMDAwMDA7CiAgdWludDI1NiBwcml2YXRlIGNvbnN0YW50IFBBUlRORVJfUEVSSU9EUyA9IDE7CiAgdWludDI1NiBwcml2YXRlIGNvbnN0YW50IE1JTlVURVNfSU5fUEFSVE5FUl9QRVJJT0QgPSBNSU5VVEVTX0lOX0NPTVBBTllfUEVSSU9EICogMTg7IC8vIE1JTlVURVNfSU5fQ09NUEFOWV9QRVJJT0QgZXF1YWxzIG9uZSBtb250aCAoc2VlIGRlY2xhcmF0aW9uIG9mIE1JTlVURVNfSU5fQ09NUEFOWV9QRVJJT0QgY29uc3RhbnQpCgogIC8qCiAgICogQk9VTlRZIFRPS0VOUwogICAqIDMlCiAgICoKICAgKiBCb3VudHkgdG9rZW5zIGNhbiBiZSBzZW50IGltbWVkaWF0ZWx5IGFmdGVyIGluaXRpYWxpemF0aW9uCiAgICovCiAgdWludDI1NiBwcml2YXRlIGNvbnN0YW50IEJPVU5UWV9UT0tFTlMgPSAyMzgyMTM2OTE5Mjk1MzIwMDAwMDAwMDAwOwoKICAvKgogICAqIE1BUktFVElORyBDT1NUIFRPS0VOUwogICAqIDElCiAgICoKICAgKiBUb2tlbnMgYXJlIHNlbnQgdG8gdGhlIE1BUktFVElOR19DT1NUX0FERFJFU1MgaW1tZWRpYXRlbHkKICAgKiBhZnRlciBFeHlUb2tlbiBpbml0aWFsaXphdGlvbgogICAqLwogIHVpbnQyNTYgcHJpdmF0ZSBjb25zdGFudCBNQVJLRVRJTkdfQ09TVF9UT0tFTlMgPSA3OTQwNDU2Mzk3NjUxMDYwMDAwMDAwMDA7CiAgYWRkcmVzcyBwcml2YXRlIGNvbnN0YW50IE1BUktFVElOR19DT1NUX0FERFJFU1MgPSAweEYxMzNlZjNCRTY4MTI4YzlBZjE2RjVhRjhGODcwN2Y3QTdBNTE0NTI7CgogIHVpbnQyNTYgcHVibGljIElOSVRfREFURTsKCiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIkV4cGVydHkgVG9rZW4iOwogIGJ5dGVzMzIgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJFWFkiOwogIHVpbnQ4IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwogIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IHRvdGFsU3VwcGx5ID0gKAogICAgQ09NUEFOWV9UT0tFTlNfUEVSX1BFUklPRCAqIENPTVBBTllfUEVSSU9EUyArCiAgICBQQVJUTkVSX1RPS0VOU19QRVJfUEVSSU9EICogUEFSVE5FUl9QRVJJT0RTICsKICAgIEJPVU5UWV9UT0tFTlMgKyBNQVJLRVRJTkdfQ09TVF9UT0tFTlMgKwogICAgSUNPX1RPS0VOUyArIFNFRURfVE9LRU5TKTsKCiAgLyoqCiAgICogRXh5VG9rZW4gY29udHJ1Y3Rvci4KICAgKgogICAqIEV4eSB0b2tlbiBjb250YWlucyBhbGxvY2F0aW9ucyBvZjoKICAgKiAtIHBhcnRuZXJUb2tlbnNBbGxvY2F0aW9uCiAgICogLSBjb21wYW55VG9rZW5zQWxsb2NhdGlvbgogICAqIC0gYm91bnR5VG9rZW5zQWxsb2NhdGlvbgogICAqCiAgICogcGFyYW0gc2lnbmF0b3J5MCBBZGRyZXNzIG9mIGZpcnN0IHNpZ25hdG9yeS4KICAgKiBwYXJhbSBzaWduYXRvcnkxIEFkZHJlc3Mgb2Ygc2Vjb25kIHNpZ25hdG9yeS4KICAgKiBwYXJhbSBzaWduYXRvcnkyIEFkZHJlc3Mgb2YgdGhpcmQgc2lnbmF0b3J5LgogICAqCiAgICovCiAgZnVuY3Rpb24gRXh5VG9rZW4oYWRkcmVzcyBzaWduYXRvcnkwLCBhZGRyZXNzIHNpZ25hdG9yeTEsIGFkZHJlc3Mgc2lnbmF0b3J5MikKICAgICAgU2lnbmF0b3J5UGF1c2FibGUoc2lnbmF0b3J5MCwgc2lnbmF0b3J5MSwgc2lnbmF0b3J5MikKICAgICAgcHVibGljIHsKCiAgICAvLyBOT1RFOiB0aGUgY29udHJhY3QgaXMgc2FmZSBhcyBsb25nIGFzIHRoaXMgYXNzaWdubWVudCBpcyBub3QgY2hhbmdlZCBub3IgdXBkYXRlZC4KICAgIC8vIElmLCBpbiB0aGUgZnV0dXJlLCBJTklUX0RBVEUgY291bGQgaGF2ZSBhIGRpZmZlcmVudCB2YWx1ZSwgY2FsY3VsYXRpb25zIHVzaW5nIGl0cyB2YWx1ZQogICAgLy8gc2hvdWxkIG1vc3QgbGlrZWx5IHVzZSBTYWZlTWF0aC4KICAgIElOSVRfREFURSA9IGJsb2NrLnRpbWVzdGFtcDsKCiAgICBjb21wYW55VG9rZW5zQWxsb2NhdGlvbiA9IG5ldyBWZXN0aW5nQWxsb2NhdGlvbigKICAgICAgQ09NUEFOWV9UT0tFTlNfUEVSX1BFUklPRCwKICAgICAgQ09NUEFOWV9QRVJJT0RTLAogICAgICBNSU5VVEVTX0lOX0NPTVBBTllfUEVSSU9ELAogICAgICBJTklUX0RBVEUpOwoKICAgIHBhcnRuZXJUb2tlbnNBbGxvY2F0aW9uID0gbmV3IFZlc3RpbmdBbGxvY2F0aW9uKAogICAgICBQQVJUTkVSX1RPS0VOU19QRVJfUEVSSU9ELAogICAgICBQQVJUTkVSX1BFUklPRFMsCiAgICAgIE1JTlVURVNfSU5fUEFSVE5FUl9QRVJJT0QsCiAgICAgIElOSVRfREFURSk7CgogICAgYm91bnR5VG9rZW5zQWxsb2NhdGlvbiA9IG5ldyBCb3VudHlUb2tlbkFsbG9jYXRpb24oCiAgICAgIEJPVU5UWV9UT0tFTlMKICAgICk7CgogICAgLy8gbWludGluZyBtYXJrZXRpbmcgY29zdCB0b2tlbnMKICAgIG1pbnQoTUFSS0VUSU5HX0NPU1RfQUREUkVTUywgTUFSS0VUSU5HX0NPU1RfVE9LRU5TKTsKCiAgICAvLyBtaW50aW5nIElDTyB0b2tlbnMKICAgIG1pbnQoSUNPX1RPS0VOU19BRERSRVNTLCBJQ09fVE9LRU5TKTsKICAgIC8vIG1pbnRpbmcgU0VFRCB0b2tlbnMKICAgIG1pbnQoU0VFRF9UT0tFTlNfQUREUkVTUywgU0VFRF9UT0tFTlMpOwogIH0KCiAgLyoqCiAgICogVHJhbnNmZXIgRVJDMjAgdG9rZW5zIG91dCBvZiB0aGlzIGNvbnRyYWN0LCB0byBhdm9pZCB0aGVtIGJlaW5nIHN0dWNrIGhlcmUgZm9yZXZlci4KICAgKiBPbmx5IG9uZSBzaWduYXRvcnkgZGVjaXNpb24gbmVlZGVkLCB0byBtaW5pbWl6ZSBjb250cmFjdCBzaXplIHNpbmNlIHRoaXMgaXMgYSByYXJlIGNhc2UuCiAgICovCiAgZnVuY3Rpb24gZXJjMjBUb2tlblRyYW5zZmVyKGFkZHJlc3MgX3Rva2VuQWRkciwgYWRkcmVzcyBfZGVzdCkgcHVibGljIG9ubHlTaWduYXRvcnkgewogICAgRVJDMjBUb2tlbiB0b2tlbiA9IEVSQzIwVG9rZW4oX3Rva2VuQWRkcik7CiAgICB0b2tlbi50cmFuc2ZlcihfZGVzdCwgdG9rZW4uYmFsYW5jZU9mKGFkZHJlc3ModGhpcykpKTsKICB9CgogIC8qKgogICAqIEFkZHMgYSBwcm9wb3NpdGlvbiBvZiBhIGNvbXBhbnkgdG9rZW4gc3BsaXQgdG8gY29tcGFueVRva2Vuc0FsbG9jYXRpb24KICAgKi8KICBmdW5jdGlvbiBwcm9wb3NlQ29tcGFueUFsbG9jYXRpb24oYWRkcmVzcyBfZGVzdCwgdWludDI1NiBfdG9rZW5zUGVyUGVyaW9kKSBwdWJsaWMgb25seVNpZ25hdG9yeSBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSB7CiAgICBjb21wYW55VG9rZW5zQWxsb2NhdGlvbi5wcm9wb3NlQWxsb2NhdGlvbihtc2cuc2VuZGVyLCBfZGVzdCwgX3Rva2Vuc1BlclBlcmlvZCk7CiAgfQoKICAvKioKICAgKiBBcHByb3ZlcyBhIHByb3Bvc2l0aW9uIG9mIGEgY29tcGFueSB0b2tlbiBzcGxpdAogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmVDb21wYW55QWxsb2NhdGlvbihhZGRyZXNzIF9kZXN0KSBwdWJsaWMgb25seVNpZ25hdG9yeSB7CiAgICBjb21wYW55VG9rZW5zQWxsb2NhdGlvbi5hcHByb3ZlQWxsb2NhdGlvbihtc2cuc2VuZGVyLCBfZGVzdCk7CiAgfQoKICAvKioKICAgKiBSZWplY3RzIGEgcHJvcG9zaXRpb24gb2YgYSBjb21wYW55IHRva2VuIHNwbGl0LgogICAqIGl0IGNhbiByZWplY3Qgb25seSBub3QgYXBwcm92ZWQgbWV0aG9kCiAgICovCiAgZnVuY3Rpb24gcmVqZWN0Q29tcGFueUFsbG9jYXRpb24oYWRkcmVzcyBfZGVzdCkgcHVibGljIG9ubHlTaWduYXRvcnkgewogICAgY29tcGFueVRva2Vuc0FsbG9jYXRpb24ucmVqZWN0QWxsb2NhdGlvbihfZGVzdCk7CiAgfQoKICAvKioKICAgKiBSZXR1cm4gbnVtYmVyIG9mIHJlbWFpbmluZyBjb21wYW55IHRva2VucyBhbGxvY2F0aW9ucwogICAqIEByZXR1cm4gTGVuZ3RoIG9mIGNvbXBhbnkgYWxsb2NhdGlvbnMgcGVyIHBlcmlvZAogICAqLwogIGZ1bmN0aW9uIGdldFJlbWFpbmluZ0NvbXBhbnlUb2tlbnNBbGxvY2F0aW9uKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGNvbXBhbnlUb2tlbnNBbGxvY2F0aW9uLnJlbWFpbmluZ1Rva2Vuc1BlclBlcmlvZCgpOwogIH0KCiAgLyoqCiAgICogR2l2ZW4gdGhlIGluZGV4IG9mIHRoZSBjb21wYW55IGFsbG9jYXRpb24gaW4gYWxsb2NhdGlvbkFkZHJlc3NMaXN0CiAgICogd2UgZmluZCBpdHMgcmVjaWVwZW50IGFkZHJlc3MgYW5kIHJldHVybiBzdHJ1Y3Qgd2l0aCBpbmZvcm1hdGlvbnMKICAgKiBhYm91dCB0aGlzIGFsbG9jYXRpb24KICAgKgogICAqIEBwYXJhbSBuciBJbmRleCBvZiBhbGxvY2F0aW9uIGluIGFsbG9jYXRpb25BZGRyZXNzTGlzdAogICAqIEByZXR1cm4gSW5mb3JtYXRpb24gYWJvdXQgY29tcGFueSBhbGxvY3Rpb24KICAgKi8KICBmdW5jdGlvbiBnZXRDb21wYW55QWxsb2NhdGlvbih1aW50MjU2IG5yKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2LCBhZGRyZXNzLCB1aW50MjU2LCBUeXBlcy5BbGxvY2F0aW9uU3RhdGUsIGFkZHJlc3MpIHsKICAgIGFkZHJlc3MgcmVjaXBpZW50QWRkcmVzcyA9IGNvbXBhbnlUb2tlbnNBbGxvY2F0aW9uLmFsbG9jYXRpb25BZGRyZXNzTGlzdChucik7CiAgICB2YXIgKHRva2Vuc1BlclBlcmlvZCwgcHJvcG9zYWxBZGRyZXNzLCBjbGFpbWVkUGVyaW9kcywgYWxsb2NhdGlvblN0YXRlKSA9IGNvbXBhbnlUb2tlbnNBbGxvY2F0aW9uLmFsbG9jYXRpb25PZihyZWNpcGllbnRBZGRyZXNzKTsKICAgIHJldHVybiAodG9rZW5zUGVyUGVyaW9kLCBwcm9wb3NhbEFkZHJlc3MsIGNsYWltZWRQZXJpb2RzLCBhbGxvY2F0aW9uU3RhdGUsIHJlY2lwaWVudEFkZHJlc3MpOwogIH0KCiAgLyoqCiAgICogQWRkcyBhIHByb3Bvc2l0aW9uIG9mIGEgcGFydG5lciB0b2tlbiBzcGxpdCB0byBjb21wYW55VG9rZW5zQWxsb2NhdGlvbgogICAqLwogIGZ1bmN0aW9uIHByb3Bvc2VQYXJ0bmVyQWxsb2NhdGlvbihhZGRyZXNzIF9kZXN0LCB1aW50MjU2IF90b2tlbnNQZXJQZXJpb2QpIHB1YmxpYyBvbmx5U2lnbmF0b3J5IG9ubHlQYXlsb2FkU2l6ZSgyICogMzIpIHsKICAgIHBhcnRuZXJUb2tlbnNBbGxvY2F0aW9uLnByb3Bvc2VBbGxvY2F0aW9uKG1zZy5zZW5kZXIsIF9kZXN0LCBfdG9rZW5zUGVyUGVyaW9kKTsKICB9CgogIC8qKgogICAqIEFwcHJvdmVzIGEgcHJvcG9zaXRpb24gb2YgYSBwYXJ0bmVyIHRva2VuIHNwbGl0CiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZVBhcnRuZXJBbGxvY2F0aW9uKGFkZHJlc3MgX2Rlc3QpIHB1YmxpYyBvbmx5U2lnbmF0b3J5IHsKICAgIHBhcnRuZXJUb2tlbnNBbGxvY2F0aW9uLmFwcHJvdmVBbGxvY2F0aW9uKG1zZy5zZW5kZXIsIF9kZXN0KTsKICB9CgogIC8qKgogICAqIFJlamVjdHMgYSBwcm9wb3NpdGlvbiBvZiBhIHBhcnRuZXIgdG9rZW4gc3BsaXQuCiAgICogaXQgY2FuIHJlamVjdCBvbmx5IG5vdCBhcHByb3ZlZCBtZXRob2QKICAgKi8KICBmdW5jdGlvbiByZWplY3RQYXJ0bmVyQWxsb2NhdGlvbihhZGRyZXNzIF9kZXN0KSBwdWJsaWMgb25seVNpZ25hdG9yeSB7CiAgICBwYXJ0bmVyVG9rZW5zQWxsb2NhdGlvbi5yZWplY3RBbGxvY2F0aW9uKF9kZXN0KTsKICB9CgogIC8qKgogICAqIFJldHVybiBudW1iZXIgb2YgcmVtYWluaW5nIHBhcnRuZXIgdG9rZW5zIGFsbG9jYXRpb25zCiAgICogQHJldHVybiBMZW5ndGggb2YgcGFydG5lciBhbGxvY2F0aW9ucyBwZXIgcGVyaW9kCiAgICovCiAgZnVuY3Rpb24gZ2V0UmVtYWluaW5nUGFydG5lclRva2Vuc0FsbG9jYXRpb24oKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gcGFydG5lclRva2Vuc0FsbG9jYXRpb24ucmVtYWluaW5nVG9rZW5zUGVyUGVyaW9kKCk7CiAgfQoKICAvKioKICAgKiBHaXZlbiB0aGUgaW5kZXggb2YgdGhlIHBhcnRuZXIgYWxsb2NhdGlvbiBpbiBhbGxvY2F0aW9uQWRkcmVzc0xpc3QKICAgKiB3ZSBmaW5kIGl0cyByZWNpZXBlbnQgYWRkcmVzcyBhbmQgcmV0dXJuIHN0cnVjdCB3aXRoIGluZm9ybWF0aW9ucwogICAqIGFib3V0IHRoaXMgYWxsb2NhdGlvbgogICAqCiAgICogQHBhcmFtIG5yIEluZGV4IG9mIGFsbG9jYXRpb24gaW4gYWxsb2NhdGlvbkFkZHJlc3NMaXN0CiAgICogQHJldHVybiBJbmZvcm1hdGlvbiBhYm91dCBwYXJ0bmVyIGFsbG9jdGlvbgogICAqLwogIGZ1bmN0aW9uIGdldFBhcnRuZXJBbGxvY2F0aW9uKHVpbnQyNTYgbnIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYsIGFkZHJlc3MsIHVpbnQyNTYsIFR5cGVzLkFsbG9jYXRpb25TdGF0ZSwgYWRkcmVzcykgewogICAgYWRkcmVzcyByZWNpcGllbnRBZGRyZXNzID0gcGFydG5lclRva2Vuc0FsbG9jYXRpb24uYWxsb2NhdGlvbkFkZHJlc3NMaXN0KG5yKTsKICAgIHZhciAodG9rZW5zUGVyUGVyaW9kLCBwcm9wb3NhbEFkZHJlc3MsIGNsYWltZWRQZXJpb2RzLCBhbGxvY2F0aW9uU3RhdGUpID0gcGFydG5lclRva2Vuc0FsbG9jYXRpb24uYWxsb2NhdGlvbk9mKHJlY2lwaWVudEFkZHJlc3MpOwogICAgcmV0dXJuICh0b2tlbnNQZXJQZXJpb2QsIHByb3Bvc2FsQWRkcmVzcywgY2xhaW1lZFBlcmlvZHMsIGFsbG9jYXRpb25TdGF0ZSwgcmVjaXBpZW50QWRkcmVzcyk7CiAgfQoKICBmdW5jdGlvbiBwcm9wb3NlQm91bnR5VHJhbnNmZXIoYWRkcmVzcyBfZGVzdCwgdWludDI1NiBfYW1vdW50KSBwdWJsaWMgb25seVNpZ25hdG9yeSBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSB7CiAgICBib3VudHlUb2tlbnNBbGxvY2F0aW9uLnByb3Bvc2VCb3VudHlUcmFuc2ZlcihfZGVzdCwgX2Ftb3VudCk7CiAgfQoKICAvKioKICAgKiBBcHByb3ZlcyBhIGJvdW50eSB0cmFuc2ZlciBhbmQgbWludCB0b2tlbnMKICAgKgogICAqIEBwYXJhbSBfZGVzdCBBZGRyZXNzIG9mIHRoZSBib3VudHkgcmVjaWVwZW50IHRvIHdob20gd2Ugc2hvdWxkIG1pbnQgdG9rZW4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlQm91bnR5VHJhbnNmZXIoYWRkcmVzcyBfZGVzdCkgcHVibGljIG9ubHlTaWduYXRvcnkgewogICAgdWludDI1NiB0b2tlbnNUb01pbnQgPSBib3VudHlUb2tlbnNBbGxvY2F0aW9uLmFwcHJvdmVCb3VudHlUcmFuc2Zlcihtc2cuc2VuZGVyLCBfZGVzdCk7CiAgICBtaW50KF9kZXN0LCB0b2tlbnNUb01pbnQpOwogIH0KCiAgLyoqCiAgICogUmVqZWN0cyBhIHByb3Bvc2l0aW9uIG9mIGEgYm91bnR5IHRva2VuLgogICAqIGl0IGNhbiByZWplY3Qgb25seSBub3QgYXBwcm92ZWQgbWV0aG9kCiAgICovCiAgZnVuY3Rpb24gcmVqZWN0Qm91bnR5VHJhbnNmZXIoYWRkcmVzcyBfZGVzdCkgcHVibGljIG9ubHlTaWduYXRvcnkgewogICAgYm91bnR5VG9rZW5zQWxsb2NhdGlvbi5yZWplY3RCb3VudHlUcmFuc2ZlcihfZGVzdCk7CiAgfQoKICBmdW5jdGlvbiBnZXRCb3VudHlUcmFuc2ZlcnModWludDI1NiBucikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiwgYWRkcmVzcywgVHlwZXMuQm91bnR5U3RhdGUsIGFkZHJlc3MpIHsKICAgIGFkZHJlc3MgcmVjaXBpZW50QWRkcmVzcyA9IGJvdW50eVRva2Vuc0FsbG9jYXRpb24uYWxsb2NhdGlvbkFkZHJlc3NMaXN0KG5yKTsKICAgIHZhciAoYW1vdW50LCBwcm9wb3NhbEFkZHJlc3MsIGJvdW50eVN0YXRlKSA9IGJvdW50eVRva2Vuc0FsbG9jYXRpb24uYm91bnR5T2YocmVjaXBpZW50QWRkcmVzcyk7CiAgICByZXR1cm4gKGFtb3VudCwgcHJvcG9zYWxBZGRyZXNzLCBib3VudHlTdGF0ZSwgcmVjaXBpZW50QWRkcmVzcyk7CiAgfQoKICAvKioKICAgKiBSZXR1cm4gbnVtYmVyIG9mIHJlbWFpbmluZyBib3VudHkgdG9rZW5zIGFsbG9jYXRpb25zCiAgICogQHJldHVybiBMZW5ndGggb2YgY29tcGFueSBhbGxvY2F0aW9ucwogICAqLwogIGZ1bmN0aW9uIGdldFJlbWFpbmluZ0JvdW50eVRva2VucygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBib3VudHlUb2tlbnNBbGxvY2F0aW9uLnJlbWFpbmluZ0JvdW50eVRva2VucygpOwogIH0KCiAgZnVuY3Rpb24gY2xhaW1Ub2tlbnMoKSBwdWJsaWMgewogICAgbWludCgKICAgICAgbXNnLnNlbmRlciwKICAgICAgcGFydG5lclRva2Vuc0FsbG9jYXRpb24uY2xhaW1Ub2tlbnMobXNnLnNlbmRlcikgKwogICAgICBjb21wYW55VG9rZW5zQWxsb2NhdGlvbi5jbGFpbVRva2Vucyhtc2cuc2VuZGVyKQogICAgKTsKICB9CgogIC8qKgogICAqIE92ZXJyaWRlIHRoZSB0cmFuc2ZlciBhbmQgbWludCBmdW5jdGlvbnMgdG8gcmVzcGVjdCBwYXVzZSBzdGF0ZS4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlLCBieXRlcyBkYXRhKSBwdWJsaWMgd2hlblBhdXNlZChmYWxzZSkgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKHRvLCB2YWx1ZSwgZGF0YSk7CiAgfQoKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgd2hlblBhdXNlZChmYWxzZSkgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKHRvLCB2YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHdoZW5QYXVzZWQoZmFsc2UpIHJldHVybnMgKGJvb2wpIHsKICAgIGlmIChjaXJjdWxhdGluZ1N1cHBseS5hZGQodmFsdWUpID4gdG90YWxTdXBwbHkpIHsKICAgICAgcGF1c2VkID0gdHJ1ZTsgIC8vIGVtZXJnZW5jeSBwYXVzZSwgdGhpcyBzaG91bGQgbmV2ZXIgaGFwcGVuIQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gc3VwZXIubWludCh0bywgdmFsdWUpOwogIH0KCiAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgc2l6ZSkgewogICAgYXNzZXJ0KG1zZy5kYXRhLmxlbmd0aCA9PSBzaXplICsgNCk7CiAgICBfOwogIH0KCn0KCmNvbnRyYWN0IFR5cGVzIHsKCiAgLy8gUG9zc2libGUgc3BsaXQgc3RhdGVzOiBQcm9wb3NlZCwgQXBwcm92ZWQsIFJlamVjdGVkCiAgLy8gUHJvcG9zZWQgaXMgdGhlIGluaXRpYWwgc3RhdGUuCiAgLy8gQm90aCBBcHByb3ZlZCBhbmQgUmVqZWN0ZWQgYXJlIGZpbmFsIHN0YXRlcy4KICAvLyBUaGUgb25seSBwb3NzaWJsZSB0cmFuc2l0aW9ucyBhcmU6CiAgLy8gUHJvcG9zZWQgPT4gQXBwcm92ZWQKICAvLyBQcm9wb3NlZCA9PiBSZWplY3RlZAogIGVudW0gQWxsb2NhdGlvblN0YXRlIHsKICAgIFByb3Bvc2VkLAogICAgQXBwcm92ZWQsCiAgICBSZWplY3RlZAogIH0KCiAgLy8gU3RydWN0dXJlIHVzZWQgZm9yIHN0b3JpbmcgY29tcGFueSBhbmQgcGFydG5lciBhbGxvY2F0aW9ucwogIHN0cnVjdCBTdHJ1Y3RWZXN0aW5nQWxsb2NhdGlvbiB7CiAgICAvLyBIb3cgbWFueSB0b2tlbnMgcGVyIHBlcmlvZCB3ZSB3YW50IHRvIHBhc3MKICAgIHVpbnQyNTYgdG9rZW5zUGVyUGVyaW9kOwogICAgLy8gQnkgd2hvbSB3YXMgdGhpcyBzcGxpdCBwcm9wb3NlZC4gQW5vdGhlciBzaWduYXRvcnkgbXVzdCBhcHByb3ZlIHRvbwogICAgYWRkcmVzcyBwcm9wb3NlckFkZHJlc3M7CiAgICAvLyBIb3cgbWFueSB0aW1lcyBkaWQgd2UgcmVsZWFzZSB0b2tlbnMKICAgIHVpbnQyNTYgY2xhaW1lZFBlcmlvZHM7CiAgICAvLyBTdGF0ZSBvZiBhY3R1YWwgc3BsaXQuCiAgICBBbGxvY2F0aW9uU3RhdGUgYWxsb2NhdGlvblN0YXRlOwogIH0KCiAgZW51bSBCb3VudHlTdGF0ZSB7CiAgICBQcm9wb3NlZCwgLy8gMAogICAgQXBwcm92ZWQsIC8vIDEKICAgIFJlamVjdGVkICAvLyAyCiAgfQoKICBzdHJ1Y3QgU3RydWN0Qm91bnR5QWxsb2NhdGlvbiB7CiAgICAvLyBIb3cgbWFueSB0b2tlbnMgc2VuZCBoaW0gb3IgaGVyCiAgICB1aW50MjU2IGFtb3VudDsKICAgIC8vIEJ5IHdob20gd2FzIHRoaXMgYWxsb2NhdGlvbiBwcm9wb3NlZAogICAgYWRkcmVzcyBwcm9wb3NhbEFkZHJlc3M7CiAgICAvLyBTdGF0ZSBvZiBhY3R1YWwgc3BsaXQuCiAgICBCb3VudHlTdGF0ZSBib3VudHlTdGF0ZTsKICB9Cn0KCmNvbnRyYWN0IFZlc3RpbmdBbGxvY2F0aW9uIGlzIE93bmFibGUgewoKICAvLyBUaGlzIGNvbnRyYWN0IGRlc2NyaWJlcyBob3cgdGhlIHRva2VucyBhcmUgYmVpbmcgcmVsZWFzZWQgaW4gdGltZQoKICAvLyBBZGRyZXNzZXMgd2hpY2ggaGF2ZSBhIHZlc3RpbmcgYWxsb2NhdGlvbiwgaW4gb3JkZXIgb2YgcHJvcG9zYWxzCiAgYWRkcmVzc1tdIHB1YmxpYyBhbGxvY2F0aW9uQWRkcmVzc0xpc3Q7CgogIC8vIEhvdyBtYW55IGRpc3RyaWJ1dGlvbnMgcGVyaW9kcyB0aGVyZSBhcmUKICB1aW50MjU2IHB1YmxpYyBwZXJpb2RzOwogIC8vIEhvdyBsb25nIGlzIG9uZSBpbnRlcnZhbAogIHVpbnQyNTYgcHVibGljIG1pbnV0ZXNJblBlcmlvZDsKICAvLyBUb3RhbCBhbW91bnQgb2YgcmVtYWluaW5nIHRva2VucyB0byBiZSBkaXN0cmlidXRlZAogIHVpbnQyNTYgcHVibGljIHJlbWFpbmluZ1Rva2Vuc1BlclBlcmlvZDsKICAvLyBUb3RhbCBhbW91bnQgb2YgYWxsIHRva2VucwogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIC8vIEluaXRhbCB0aW1lc3RhbXAKICB1aW50MjU2IHB1YmxpYyBpbml0VGltZXN0YW1wOwoKICAvLyBGb3IgZWFjaCBhZGRyZXNzIHdlIGNhbiBhZGQgZXhhY3RseSBvbmUgcG9zc2libGUgc3BsaXQuCiAgLy8gSWYgd2UgdHJ5IHRvIGFkZCBhbm90aGVyIHByb3Bvc2FsIG9uIGV4aXN0aW5nIGFkZHJlc3MgaXQgd2lsbCBiZSByZWplY3RlZAogIG1hcHBpbmcgKGFkZHJlc3MgPT4gVHlwZXMuU3RydWN0VmVzdGluZ0FsbG9jYXRpb24pIHB1YmxpYyBhbGxvY2F0aW9uT2Y7CgogIC8qKgogICAqIFZlc3RpbmdBbGxvY2F0aW9uIGNvbnRydWN0b3IuCiAgICogUmVtYWluaW5nVG9rZW5zUGVyUGVyaW9kIHZhcmlhYmxlIHdoaWNoIHJlcHJlc2VudHMKICAgKiB0aGUgcmVtYWluaW5nIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgZGlzdHJpYnV0ZWQKICAgKgogICAqLwogIGZ1bmN0aW9uIFZlc3RpbmdBbGxvY2F0aW9uKHVpbnQyNTYgX3Rva2Vuc1BlclBlcmlvZCwgdWludDI1NiBfcGVyaW9kcywgdWludDI1NiBfbWludXRlc0luUGVyaW9kLCB1aW50MjU2IF9pbml0YWxUaW1lc3RhbXApIE93bmFibGUoKSBwdWJsaWMgewogICAgdG90YWxTdXBwbHkgPSBfdG9rZW5zUGVyUGVyaW9kICogX3BlcmlvZHM7CiAgICBwZXJpb2RzID0gX3BlcmlvZHM7CiAgICBtaW51dGVzSW5QZXJpb2QgPSBfbWludXRlc0luUGVyaW9kOwogICAgcmVtYWluaW5nVG9rZW5zUGVyUGVyaW9kID0gX3Rva2Vuc1BlclBlcmlvZDsKICAgIGluaXRUaW1lc3RhbXAgPSBfaW5pdGFsVGltZXN0YW1wOwogIH0KCiAgLyoqCiAgICogUHJvcG9zZSBzcGxpdCBtZXRob2QgYWRkcyBwcm9wb3NhbCB0byB0aGUgc3BsaXRzIEFycmF5LgogICAqCiAgICogQHBhcmFtIF9kZXN0ICAgICAgICAgICAgICAtIGFkZHJlc3Mgb2YgdGhlIG5ldyByZWNlaXZlcgogICAqIEBwYXJhbSBfdG9rZW5zUGVyUGVyaW9kICAgLSBob3cgbWFueSB0b2tlbnMgd2UgYXJlIGdpdmluZyB0byBkZXN0CiAgICovCiAgZnVuY3Rpb24gcHJvcG9zZUFsbG9jYXRpb24oYWRkcmVzcyBfcHJvcG9zZXJBZGRyZXNzLCBhZGRyZXNzIF9kZXN0LCB1aW50MjU2IF90b2tlbnNQZXJQZXJpb2QpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShfdG9rZW5zUGVyUGVyaW9kID4gMCk7CiAgICByZXF1aXJlKF90b2tlbnNQZXJQZXJpb2QgPD0gcmVtYWluaW5nVG9rZW5zUGVyUGVyaW9kKTsKICAgIC8vIEluIHNvbGlkaXR5IHRoZXJlIGlzIG5vICJleGlzdCIgbWV0aG9kIG9uIGEgbWFwIGtleS4KICAgIC8vIFdlIGNhbid0IG92ZXJ3cml0ZSBleGlzdGluZyBwcm9wb3NhbCwgc28gd2UgYXJlIGNoZWNraW5nIGlmIGl0IGlzIHRoZSBkZWZhdWx0IHZhbHVlICgweDApCiAgICAvLyBBZGQgYGFsbG9jYXRpb25PZltfZGVzdF0uYWxsb2NhdGlvblN0YXRlID09IFR5cGVzLkFsbG9jYXRpb25TdGF0ZS5SZWplY3RlZGAgZm9yIHBvc3NpYmlsaXR5IHRvIG92ZXJ3cml0ZSByZWplY3RlZCBhbGxvY2F0aW9uCiAgICByZXF1aXJlKGFsbG9jYXRpb25PZltfZGVzdF0ucHJvcG9zZXJBZGRyZXNzID09IDB4MCB8fCBhbGxvY2F0aW9uT2ZbX2Rlc3RdLmFsbG9jYXRpb25TdGF0ZSA9PSBUeXBlcy5BbGxvY2F0aW9uU3RhdGUuUmVqZWN0ZWQpOwoKICAgIGlmIChhbGxvY2F0aW9uT2ZbX2Rlc3RdLmFsbG9jYXRpb25TdGF0ZSAhPSBUeXBlcy5BbGxvY2F0aW9uU3RhdGUuUmVqZWN0ZWQpIHsKICAgICAgYWxsb2NhdGlvbkFkZHJlc3NMaXN0LnB1c2goX2Rlc3QpOwogICAgfQoKICAgIHJlbWFpbmluZ1Rva2Vuc1BlclBlcmlvZCA9IHJlbWFpbmluZ1Rva2Vuc1BlclBlcmlvZCAtIF90b2tlbnNQZXJQZXJpb2Q7CiAgICBhbGxvY2F0aW9uT2ZbX2Rlc3RdID0gVHlwZXMuU3RydWN0VmVzdGluZ0FsbG9jYXRpb24oewogICAgICB0b2tlbnNQZXJQZXJpb2Q6IF90b2tlbnNQZXJQZXJpb2QsCiAgICAgIGFsbG9jYXRpb25TdGF0ZTogVHlwZXMuQWxsb2NhdGlvblN0YXRlLlByb3Bvc2VkLAogICAgICBwcm9wb3NlckFkZHJlc3M6IF9wcm9wb3NlckFkZHJlc3MsCiAgICAgIGNsYWltZWRQZXJpb2RzOiAwCiAgICB9KTsKICB9CgogIC8qKgogICAqIEFwcHJvdmVzIHRoZSBzcGxpdCBhbGxvY2F0aW9uLCBzbyBpdCBjYW4gYmUgY2xhaW1lZCBhZnRlciBwZXJpb2RzCiAgICoKICAgKiBAcGFyYW0gX2FkZHJlc3MgLSBhZGRyZXNzIGZvciB0aGUgc3BsaXQKICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlQWxsb2NhdGlvbihhZGRyZXNzIF9hcHByb3ZlckFkZHJlc3MsIGFkZHJlc3MgX2FkZHJlc3MpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShhbGxvY2F0aW9uT2ZbX2FkZHJlc3NdLmFsbG9jYXRpb25TdGF0ZSA9PSBUeXBlcy5BbGxvY2F0aW9uU3RhdGUuUHJvcG9zZWQpOwogICAgcmVxdWlyZShhbGxvY2F0aW9uT2ZbX2FkZHJlc3NdLnByb3Bvc2VyQWRkcmVzcyAhPSBfYXBwcm92ZXJBZGRyZXNzKTsKICAgIGFsbG9jYXRpb25PZltfYWRkcmVzc10uYWxsb2NhdGlvblN0YXRlID0gVHlwZXMuQWxsb2NhdGlvblN0YXRlLkFwcHJvdmVkOwogIH0KCiAvKioKICAgKiBSZWplY3RzIHRoZSBzcGxpdCBhbGxvY2F0aW9uCiAgICoKICAgKiBAcGFyYW0gX2FkZHJlc3MgLSBhZGRyZXNzIGZvciB0aGUgc3BsaXQgdG8gYmUgcmVqZWN0ZWQKICAgKi8KICBmdW5jdGlvbiByZWplY3RBbGxvY2F0aW9uKGFkZHJlc3MgX2FkZHJlc3MpIHB1YmxpYyBvbmx5T3duZXIgewogICAgdmFyIHRtcCA9IGFsbG9jYXRpb25PZltfYWRkcmVzc107CiAgICByZXF1aXJlKHRtcC5hbGxvY2F0aW9uU3RhdGUgPT0gVHlwZXMuQWxsb2NhdGlvblN0YXRlLlByb3Bvc2VkKTsKICAgIGFsbG9jYXRpb25PZltfYWRkcmVzc10uYWxsb2NhdGlvblN0YXRlID0gVHlwZXMuQWxsb2NhdGlvblN0YXRlLlJlamVjdGVkOwogICAgcmVtYWluaW5nVG9rZW5zUGVyUGVyaW9kID0gcmVtYWluaW5nVG9rZW5zUGVyUGVyaW9kICsgdG1wLnRva2Vuc1BlclBlcmlvZDsKICB9CgogIGZ1bmN0aW9uIGNsYWltVG9rZW5zKGFkZHJlc3MgX2FkZHJlc3MpIHB1YmxpYyByZXR1cm5zICh1aW50MjU2KSB7CiAgICBUeXBlcy5TdHJ1Y3RWZXN0aW5nQWxsb2NhdGlvbiBzdG9yYWdlIGFsbG9jID0gYWxsb2NhdGlvbk9mW19hZGRyZXNzXTsKICAgIGlmIChhbGxvYy5hbGxvY2F0aW9uU3RhdGUgPT0gVHlwZXMuQWxsb2NhdGlvblN0YXRlLkFwcHJvdmVkKSB7CiAgICAgIHVpbnQyNTYgcGVyaW9kc0VsYXBzZWQgPSBTYWZlTWF0aC5taW4oKGJsb2NrLnRpbWVzdGFtcCAtIGluaXRUaW1lc3RhbXApIC8gKG1pbnV0ZXNJblBlcmlvZCAqIDEgbWludXRlcyksIHBlcmlvZHMpOwogICAgICB1aW50MjU2IHRva2VucyA9IChwZXJpb2RzRWxhcHNlZCAtIGFsbG9jLmNsYWltZWRQZXJpb2RzKSAqIGFsbG9jLnRva2Vuc1BlclBlcmlvZDsKICAgICAgYWxsb2MuY2xhaW1lZFBlcmlvZHMgPSBwZXJpb2RzRWxhcHNlZDsKICAgICAgcmV0dXJuIHRva2VuczsKICAgIH0KICAgIHJldHVybiAwOwogIH0KCn0='.
	

]
