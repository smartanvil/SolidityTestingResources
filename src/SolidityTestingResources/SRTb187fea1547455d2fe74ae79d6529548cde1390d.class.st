Class {
	#name : #SRTb187fea1547455d2fe74ae79d6529548cde1390d,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTb187fea1547455d2fe74ae79d6529548cde1390d >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTc7CgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCi8qKgogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKi8KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICAgIAogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQogIAp9CgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuIAogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICAgIAogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogIC8qKgogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCkgewogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4gCiAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3V0IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCkgewogICAgdmFyIF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKCiAgICAvLyBDaGVjayBpcyBub3QgbmVlZGVkIGJlY2F1c2Ugc3ViKF9hbGxvd2FuY2UsIF92YWx1ZSkgd2lsbCBhbHJlYWR5IHRocm93IGlmIHRoaXMgY29uZGl0aW9uIGlzIG5vdCBtZXQKICAgIC8vIHJlcXVpcmUgKF92YWx1ZSA8PSBfYWxsb3dhbmNlKTsKCiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgQXByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCkgewoKICAgIC8vIFRvIGNoYW5nZSB0aGUgYXBwcm92ZSBhbW91bnQgeW91IGZpcnN0IGhhdmUgdG8gcmVkdWNlIHRoZSBhZGRyZXNzZXNgCiAgICAvLyAgYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyBgYXBwcm92ZShfc3BlbmRlciwgMClgIGlmIGl0IGlzIG5vdAogICAgLy8gIGFscmVhZHkgMCB0byBtaXRpZ2F0ZSB0aGUgcmFjZSBjb25kaXRpb24gZGVzY3JpYmVkIGhlcmU6CiAgICAvLyAgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgIHJlcXVpcmUoKF92YWx1ZSA9PSAwKSB8fCAoYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPT0gMCkpOwoKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmaW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogICAgCiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsgICAgICAKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBNaW50YWJsZSB0b2tlbgogKiBAZGV2IFNpbXBsZSBFUkMyMCBUb2tlbiBleGFtcGxlLCB3aXRoIG1pbnRhYmxlIHRva2VuIGNyZWF0aW9uCiAqIEBkZXYgSXNzdWU6ICogaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXBwZWxpbi1zb2xpZGl0eS9pc3N1ZXMvMTIwCiAqIEJhc2VkIG9uIGNvZGUgYnkgVG9rZW5NYXJrZXROZXQ6IGh0dHBzOi8vZ2l0aHViLmNvbS9Ub2tlbk1hcmtldE5ldC9pY28vYmxvYi9tYXN0ZXIvY29udHJhY3RzL01pbnRhYmxlVG9rZW4uc29sCiAqLwoKY29udHJhY3QgTWludGFibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKICAgIAogIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGFtb3VudCk7CiAgCiAgZXZlbnQgTWludEZpbmlzaGVkKCk7CgogIGJvb2wgcHVibGljIG1pbnRpbmdGaW5pc2hlZCA9IGZhbHNlOwoKICBhZGRyZXNzIHB1YmxpYyBzYWxlQWdlbnQ7CgogIGZ1bmN0aW9uIHNldFNhbGVBZ2VudChhZGRyZXNzIG5ld1NhbGVBZ25ldCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHNhbGVBZ2VudCB8fCBtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIHNhbGVBZ2VudCA9IG5ld1NhbGVBZ25ldDsKICB9CgogIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHNhbGVBZ2VudCAmJiAhbWludGluZ0ZpbmlzaGVkKTsKICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKF9hbW91bnQpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF9hbW91bnQpOwogICAgTWludChfdG8sIF9hbW91bnQpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHN0b3AgbWludGluZyBuZXcgdG9rZW5zLgogICAqIEByZXR1cm4gVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKChtc2cuc2VuZGVyID09IHNhbGVBZ2VudCB8fCBtc2cuc2VuZGVyID09IG93bmVyKSAmJiAhbWludGluZ0ZpbmlzaGVkKTsKICAgIG1pbnRpbmdGaW5pc2hlZCA9IHRydWU7CiAgICBNaW50RmluaXNoZWQoKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgCn0KCi8qKgogKiBAdGl0bGUgUGF1c2FibGUKICogQGRldiBCYXNlIGNvbnRyYWN0IHdoaWNoIGFsbG93cyBjaGlsZHJlbiB0byBpbXBsZW1lbnQgYW4gZW1lcmdlbmN5IHN0b3AgbWVjaGFuaXNtLgogKi8KY29udHJhY3QgUGF1c2FibGUgaXMgT3duYWJsZSB7CiAgICAKICBldmVudCBQYXVzZSgpOwogIAogIGV2ZW50IFVucGF1c2UoKTsKCiAgYm9vbCBwdWJsaWMgcGF1c2VkID0gZmFsc2U7CgogIC8qKgogICAqIEBkZXYgbW9kaWZpZXIgdG8gYWxsb3cgYWN0aW9ucyBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IElTIHBhdXNlZAogICAqLwogIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICByZXF1aXJlKCFwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgbW9kaWZpZXIgdG8gYWxsb3cgYWN0aW9ucyBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IElTIE5PVCBwYXVzZWQKICAgKi8KICBtb2RpZmllciB3aGVuUGF1c2VkKCkgewogICAgcmVxdWlyZShwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byBwYXVzZSwgdHJpZ2dlcnMgc3RvcHBlZCBzdGF0ZQogICAqLwogIGZ1bmN0aW9uIHBhdXNlKCkgb25seU93bmVyIHdoZW5Ob3RQYXVzZWQgewogICAgcGF1c2VkID0gdHJ1ZTsKICAgIFBhdXNlKCk7CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gdW5wYXVzZSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgKi8KICBmdW5jdGlvbiB1bnBhdXNlKCkgb25seU93bmVyIHdoZW5QYXVzZWQgewogICAgcGF1c2VkID0gZmFsc2U7CiAgICBVbnBhdXNlKCk7CiAgfQogIAp9Cgpjb250cmFjdCBDb3Zlc3RpbmdUb2tlbiBpcyBNaW50YWJsZVRva2VuIHsJCiAgICAKICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiQ292ZXN0aW5nIjsKICAgCiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiQ09WIjsKICAgIAogIHVpbnQzMiBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgbG9ja2VkOwoKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUobG9ja2VkW21zZy5zZW5kZXJdIDwgbm93KTsKICAgIHJldHVybiBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKGxvY2tlZFtfZnJvbV0gPCBub3cpOwogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogIH0KICAKICBmdW5jdGlvbiBsb2NrKGFkZHJlc3MgYWRkciwgdWludCBwZXJpb2RJbkRheXMpIHsKICAgIHJlcXVpcmUobG9ja2VkW2FkZHJdIDwgbm93ICYmIChtc2cuc2VuZGVyID09IHNhbGVBZ2VudCB8fCBtc2cuc2VuZGVyID09IGFkZHIpKTsKICAgIGxvY2tlZFthZGRyXSA9IG5vdyArIHBlcmlvZEluRGF5cyAqIDEgZGF5czsKICB9CgogIGZ1bmN0aW9uICgpIHBheWFibGUgewogICAgcmV2ZXJ0KCk7CiAgfQoKfQoKY29udHJhY3QgU3RhZ2VkQ3Jvd2RzYWxlIGlzIFBhdXNhYmxlIHsKCiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CgogIHN0cnVjdCBTdGFnZSB7CiAgICB1aW50IGhhcmRjYXA7CiAgICB1aW50IHByaWNlOwogICAgdWludCBpbnZlc3RlZDsKICAgIHVpbnQgY2xvc2VkOwogIH0KCiAgdWludCBwdWJsaWMgc3RhcnQ7CgogIHVpbnQgcHVibGljIHBlcmlvZDsKCiAgdWludCBwdWJsaWMgdG90YWxIYXJkY2FwOwogCiAgdWludCBwdWJsaWMgdG90YWxJbnZlc3RlZDsKCiAgU3RhZ2VbXSBwdWJsaWMgc3RhZ2VzOwoKICBmdW5jdGlvbiBzdGFnZXNDb3VudCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsKICAgIHJldHVybiBzdGFnZXMubGVuZ3RoOwogIH0KCiAgZnVuY3Rpb24gc2V0U3RhcnQodWludCBuZXdTdGFydCkgcHVibGljIG9ubHlPd25lciB7CiAgICBzdGFydCA9IG5ld1N0YXJ0OwogIH0KCiAgZnVuY3Rpb24gc2V0UGVyaW9kKHVpbnQgbmV3UGVyaW9kKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHBlcmlvZCA9IG5ld1BlcmlvZDsKICB9CgogIGZ1bmN0aW9uIGFkZFN0YWdlKHVpbnQgaGFyZGNhcCwgdWludCBwcmljZSkgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKGhhcmRjYXAgPiAwICYmIHByaWNlID4gMCk7CiAgICBTdGFnZSBtZW1vcnkgc3RhZ2UgPSBTdGFnZShoYXJkY2FwLm11bCgxIGV0aGVyKSwgcHJpY2UsIDAsIDApOwogICAgc3RhZ2VzLnB1c2goc3RhZ2UpOwogICAgdG90YWxIYXJkY2FwID0gdG90YWxIYXJkY2FwLmFkZChzdGFnZS5oYXJkY2FwKTsKICB9CgogIGZ1bmN0aW9uIHJlbW92ZVN0YWdlKHVpbnQ4IG51bWJlcikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKG51bWJlciA+PTAgJiYgbnVtYmVyIDwgc3RhZ2VzLmxlbmd0aCk7CiAgICBTdGFnZSBzdG9yYWdlIHN0YWdlID0gc3RhZ2VzW251bWJlcl07CiAgICB0b3RhbEhhcmRjYXAgPSB0b3RhbEhhcmRjYXAuc3ViKHN0YWdlLmhhcmRjYXApOyAgICAKICAgIGRlbGV0ZSBzdGFnZXNbbnVtYmVyXTsKICAgIGZvciAodWludCBpID0gbnVtYmVyOyBpIDwgc3RhZ2VzLmxlbmd0aCAtIDE7IGkrKykgewogICAgICBzdGFnZXNbaV0gPSBzdGFnZXNbaSsxXTsKICAgIH0KICAgIHN0YWdlcy5sZW5ndGgtLTsKICB9CgogIGZ1bmN0aW9uIGNoYW5nZVN0YWdlKHVpbnQ4IG51bWJlciwgdWludCBoYXJkY2FwLCB1aW50IHByaWNlKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobnVtYmVyID49IDAgJiZudW1iZXIgPCBzdGFnZXMubGVuZ3RoKTsKICAgIFN0YWdlIHN0b3JhZ2Ugc3RhZ2UgPSBzdGFnZXNbbnVtYmVyXTsKICAgIHRvdGFsSGFyZGNhcCA9IHRvdGFsSGFyZGNhcC5zdWIoc3RhZ2UuaGFyZGNhcCk7ICAgIAogICAgc3RhZ2UuaGFyZGNhcCA9IGhhcmRjYXAubXVsKDEgZXRoZXIpOwogICAgc3RhZ2UucHJpY2UgPSBwcmljZTsKICAgIHRvdGFsSGFyZGNhcCA9IHRvdGFsSGFyZGNhcC5hZGQoc3RhZ2UuaGFyZGNhcCk7ICAgIAogIH0KCiAgZnVuY3Rpb24gaW5zZXJ0U3RhZ2UodWludDggbnVtYmVyQWZ0ZXIsIHVpbnQgaGFyZGNhcCwgdWludCBwcmljZSkgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKG51bWJlckFmdGVyIDwgc3RhZ2VzLmxlbmd0aCk7CiAgICBTdGFnZSBtZW1vcnkgc3RhZ2UgPSBTdGFnZShoYXJkY2FwLm11bCgxIGV0aGVyKSwgcHJpY2UsIDAsIDApOwogICAgdG90YWxIYXJkY2FwID0gdG90YWxIYXJkY2FwLmFkZChzdGFnZS5oYXJkY2FwKTsKICAgIHN0YWdlcy5sZW5ndGgrKzsKICAgIGZvciAodWludCBpID0gc3RhZ2VzLmxlbmd0aCAtIDI7IGkgPiBudW1iZXJBZnRlcjsgaS0tKSB7CiAgICAgIHN0YWdlc1tpICsgMV0gPSBzdGFnZXNbaV07CiAgICB9CiAgICBzdGFnZXNbbnVtYmVyQWZ0ZXIgKyAxXSA9IHN0YWdlOwogIH0KCiAgZnVuY3Rpb24gY2xlYXJTdGFnZXMoKSBwdWJsaWMgb25seU93bmVyIHsKICAgIGZvciAodWludCBpID0gMDsgaSA8IHN0YWdlcy5sZW5ndGg7IGkrKykgewogICAgICBkZWxldGUgc3RhZ2VzW2ldOwogICAgfQogICAgc3RhZ2VzLmxlbmd0aCAtPSBzdGFnZXMubGVuZ3RoOwogICAgdG90YWxIYXJkY2FwID0gMDsKICB9CgogIGZ1bmN0aW9uIGxhc3RTYWxlRGF0ZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsKICAgIHJldHVybiBzdGFydCArIHBlcmlvZCAqIDEgZGF5czsKICB9CgogIG1vZGlmaWVyIHNhbGVJc09uKCkgewogICAgcmVxdWlyZShzdGFnZXMubGVuZ3RoID4gMCAmJiBub3cgPj0gc3RhcnQgJiYgbm93IDwgbGFzdFNhbGVEYXRlKCkpOwogICAgXzsKICB9CiAgCiAgbW9kaWZpZXIgaXNVbmRlckhhcmRjYXAoKSB7CiAgICByZXF1aXJlKHRvdGFsSW52ZXN0ZWQgPD0gdG90YWxIYXJkY2FwKTsKICAgIF87CiAgfQoKICBmdW5jdGlvbiBjdXJyZW50U3RhZ2UoKSBwdWJsaWMgc2FsZUlzT24gaXNVbmRlckhhcmRjYXAgY29uc3RhbnQgcmV0dXJucyh1aW50KSB7CiAgICBmb3IodWludCBpPTA7IGkgPCBzdGFnZXMubGVuZ3RoOyBpKyspIHsKICAgICAgaWYoc3RhZ2VzW2ldLmNsb3NlZCA9PSAwKSB7CiAgICAgICAgcmV0dXJuIGk7CiAgICAgIH0KICAgIH0KICAgIHJldmVydCgpOwogIH0KCn0KCmNvbnRyYWN0IENvbW1vblNhbGUgaXMgU3RhZ2VkQ3Jvd2RzYWxlIHsKCiAgYWRkcmVzcyBwdWJsaWMgbXVsdGlzaWdXYWxsZXQ7CgogIHVpbnQgcHVibGljIG1pblByaWNlOwoKICB1aW50IHB1YmxpYyB0b3RhbFRva2Vuc01pbnRlZDsKCiAgQ292ZXN0aW5nVG9rZW4gcHVibGljIHRva2VuOwogIAogIGZ1bmN0aW9uIHNldE1pblByaWNlKHVpbnQgbmV3TWluUHJpY2UpIHB1YmxpYyBvbmx5T3duZXIgewogICAgbWluUHJpY2UgPSBuZXdNaW5QcmljZTsKICB9CgogIGZ1bmN0aW9uIHNldE11bHRpc2lnV2FsbGV0KGFkZHJlc3MgbmV3TXVsdGlzaWdXYWxsZXQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgbXVsdGlzaWdXYWxsZXQgPSBuZXdNdWx0aXNpZ1dhbGxldDsKICB9CiAgCiAgZnVuY3Rpb24gc2V0VG9rZW4oYWRkcmVzcyBuZXdUb2tlbikgcHVibGljIG9ubHlPd25lciB7CiAgICB0b2tlbiA9IENvdmVzdGluZ1Rva2VuKG5ld1Rva2VuKTsKICB9CgogIGZ1bmN0aW9uIGNyZWF0ZVRva2VucygpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHBheWFibGUgewogICAgcmVxdWlyZShtc2cudmFsdWUgPj0gbWluUHJpY2UpOwogICAgdWludCBzdGFnZUluZGV4ID0gY3VycmVudFN0YWdlKCk7CiAgICBtdWx0aXNpZ1dhbGxldC50cmFuc2Zlcihtc2cudmFsdWUpOwogICAgU3RhZ2Ugc3RvcmFnZSBzdGFnZSA9IHN0YWdlc1tzdGFnZUluZGV4XTsKICAgIHVpbnQgdG9rZW5zID0gbXNnLnZhbHVlLm11bChzdGFnZS5wcmljZSk7CiAgICB0b2tlbi5taW50KHRoaXMsIHRva2Vucyk7CiAgICB0b2tlbi50cmFuc2Zlcihtc2cuc2VuZGVyLCB0b2tlbnMpOwogICAgdG90YWxUb2tlbnNNaW50ZWQgPSB0b3RhbFRva2Vuc01pbnRlZC5hZGQodG9rZW5zKTsKICAgIHRvdGFsSW52ZXN0ZWQgPSB0b3RhbEludmVzdGVkLmFkZChtc2cudmFsdWUpOwogICAgc3RhZ2UuaW52ZXN0ZWQgPSBzdGFnZS5pbnZlc3RlZC5hZGQobXNnLnZhbHVlKTsKICAgIGlmKHN0YWdlLmludmVzdGVkID49IHN0YWdlLmhhcmRjYXApIHsKICAgICAgc3RhZ2UuY2xvc2VkID0gbm93OwogICAgfQogIH0KCiAgZnVuY3Rpb24oKSBleHRlcm5hbCBwYXlhYmxlIHsKICAgIGNyZWF0ZVRva2VucygpOwogIH0KCiAgZnVuY3Rpb24gcmV0cmlldmVUb2tlbnMoYWRkcmVzcyBhbm90aGVyVG9rZW4pIHB1YmxpYyBvbmx5T3duZXIgewogICAgRVJDMjAgYWxpZW5Ub2tlbiA9IEVSQzIwKGFub3RoZXJUb2tlbik7CiAgICBhbGllblRva2VuLnRyYW5zZmVyKG11bHRpc2lnV2FsbGV0LCB0b2tlbi5iYWxhbmNlT2YodGhpcykpOwogIH0KCn0KCmNvbnRyYWN0IFByZXNhbGUgaXMgQ29tbW9uU2FsZSB7CgogIE1haW5zYWxlIHB1YmxpYyBtYWluc2FsZTsKCiAgZnVuY3Rpb24gc2V0TWFpbnNhbGUoYWRkcmVzcyBuZXdNYWluc2FsZSkgcHVibGljIG9ubHlPd25lciB7CiAgICBtYWluc2FsZSA9IE1haW5zYWxlKG5ld01haW5zYWxlKTsKICB9CgogIGZ1bmN0aW9uIHNldE11bHRpc2lnV2FsbGV0KGFkZHJlc3MgbmV3TXVsdGlzaWdXYWxsZXQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgbXVsdGlzaWdXYWxsZXQgPSBuZXdNdWx0aXNpZ1dhbGxldDsKICB9CgogIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCBvbmx5T3duZXIgewogICAgdG9rZW4uc2V0U2FsZUFnZW50KG1haW5zYWxlKTsKICB9CgogIGZ1bmN0aW9uKCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICBjcmVhdGVUb2tlbnMoKTsKICB9CgogIGZ1bmN0aW9uIHJldHJpZXZlVG9rZW5zKGFkZHJlc3MgYW5vdGhlclRva2VuKSBwdWJsaWMgb25seU93bmVyIHsKICAgIEVSQzIwIGFsaWVuVG9rZW4gPSBFUkMyMChhbm90aGVyVG9rZW4pOwogICAgYWxpZW5Ub2tlbi50cmFuc2ZlcihtdWx0aXNpZ1dhbGxldCwgdG9rZW4uYmFsYW5jZU9mKHRoaXMpKTsKICB9Cgp9CgoKY29udHJhY3QgTWFpbnNhbGUgaXMgQ29tbW9uU2FsZSB7CgogIGFkZHJlc3MgcHVibGljIGZvdW5kZXJzVG9rZW5zV2FsbGV0OwogIAogIGFkZHJlc3MgcHVibGljIGJvdW50eVRva2Vuc1dhbGxldDsKICAKICB1aW50IHB1YmxpYyBmb3VuZGVyc1Rva2Vuc1BlcmNlbnQ7CiAgCiAgdWludCBwdWJsaWMgYm91bnR5VG9rZW5zUGVyY2VudDsKICAKICB1aW50IHB1YmxpYyBwZXJjZW50UmF0ZSA9IDEwMDsKCiAgdWludCBwdWJsaWMgbG9ja1BlcmlvZDsKCiAgZnVuY3Rpb24gc2V0TG9ja1BlcmlvZCh1aW50IG5ld0xvY2tQZXJpb2QpIHB1YmxpYyBvbmx5T3duZXIgewogICAgbG9ja1BlcmlvZCA9IG5ld0xvY2tQZXJpb2Q7CiAgfQoKICBmdW5jdGlvbiBzZXRGb3VuZGVyc1Rva2Vuc1BlcmNlbnQodWludCBuZXdGb3VuZGVyc1Rva2Vuc1BlcmNlbnQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgZm91bmRlcnNUb2tlbnNQZXJjZW50ID0gbmV3Rm91bmRlcnNUb2tlbnNQZXJjZW50OwogIH0KCiAgZnVuY3Rpb24gc2V0Qm91bnR5VG9rZW5zUGVyY2VudCh1aW50IG5ld0JvdW50eVRva2Vuc1BlcmNlbnQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgYm91bnR5VG9rZW5zUGVyY2VudCA9IG5ld0JvdW50eVRva2Vuc1BlcmNlbnQ7CiAgfQoKICBmdW5jdGlvbiBzZXRGb3VuZGVyc1Rva2Vuc1dhbGxldChhZGRyZXNzIG5ld0ZvdW5kZXJzVG9rZW5zV2FsbGV0KSBwdWJsaWMgb25seU93bmVyIHsKICAgIGZvdW5kZXJzVG9rZW5zV2FsbGV0ID0gbmV3Rm91bmRlcnNUb2tlbnNXYWxsZXQ7CiAgfQoKICBmdW5jdGlvbiBzZXRCb3VudHlUb2tlbnNXYWxsZXQoYWRkcmVzcyBuZXdCb3VudHlUb2tlbnNXYWxsZXQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgYm91bnR5VG9rZW5zV2FsbGV0ID0gbmV3Qm91bnR5VG9rZW5zV2FsbGV0OwogIH0KCiAgZnVuY3Rpb24gZmluaXNoTWludGluZygpIHB1YmxpYyB3aGVuTm90UGF1c2VkIG9ubHlPd25lciB7CiAgICB1aW50IHN1bW1hcnlUb2tlbnNQZXJjZW50ID0gYm91bnR5VG9rZW5zUGVyY2VudCArIGZvdW5kZXJzVG9rZW5zUGVyY2VudDsKICAgIHVpbnQgbWludGVkVG9rZW5zID0gdG9rZW4udG90YWxTdXBwbHkoKTsKICAgIHVpbnQgc3VtbWFyeUZvdW5kZXJzVG9rZW5zID0gbWludGVkVG9rZW5zLm11bChzdW1tYXJ5VG9rZW5zUGVyY2VudCkuZGl2KHBlcmNlbnRSYXRlIC0gc3VtbWFyeVRva2Vuc1BlcmNlbnQpOwogICAgdWludCB0b3RhbFN1cHBseSA9IHN1bW1hcnlGb3VuZGVyc1Rva2VucyArIG1pbnRlZFRva2VuczsKICAgIHVpbnQgZm91bmRlcnNUb2tlbnMgPSB0b3RhbFN1cHBseS5tdWwoZm91bmRlcnNUb2tlbnNQZXJjZW50KS5kaXYocGVyY2VudFJhdGUpOwogICAgdWludCBib3VudHlUb2tlbnMgPSB0b3RhbFN1cHBseS5tdWwoYm91bnR5VG9rZW5zUGVyY2VudCkuZGl2KHBlcmNlbnRSYXRlKTsKICAgIHRva2VuLm1pbnQodGhpcywgZm91bmRlcnNUb2tlbnMpOwogICAgdG9rZW4ubG9jayhmb3VuZGVyc1Rva2Vuc1dhbGxldCwgbG9ja1BlcmlvZCAqIDEgZGF5cyk7CiAgICB0b2tlbi50cmFuc2Zlcihmb3VuZGVyc1Rva2Vuc1dhbGxldCwgZm91bmRlcnNUb2tlbnMpOwogICAgdG9rZW4ubWludCh0aGlzLCBib3VudHlUb2tlbnMpOwogICAgdG9rZW4udHJhbnNmZXIoYm91bnR5VG9rZW5zV2FsbGV0LCBib3VudHlUb2tlbnMpOwogICAgdG90YWxUb2tlbnNNaW50ZWQgPSB0b3RhbFRva2Vuc01pbnRlZC5hZGQoZm91bmRlcnNUb2tlbnMpLmFkZChib3VudHlUb2tlbnMpOwogICAgdG9rZW4uZmluaXNoTWludGluZygpOwogIH0KCn0KCmNvbnRyYWN0IFRlc3RDb25maWd1cmF0b3IgaXMgT3duYWJsZSB7CgogIENvdmVzdGluZ1Rva2VuIHB1YmxpYyB0b2tlbjsgCgogIFByZXNhbGUgcHVibGljIHByZXNhbGU7CgogIE1haW5zYWxlIHB1YmxpYyBtYWluc2FsZTsKCiAgZnVuY3Rpb24gZGVwbG95KCkgcHVibGljIG9ubHlPd25lciB7CiAgICB0b2tlbiA9IG5ldyBDb3Zlc3RpbmdUb2tlbigpOwoKICAgIHByZXNhbGUgPSBuZXcgUHJlc2FsZSgpOwoKICAgIHByZXNhbGUuc2V0VG9rZW4odG9rZW4pOwogICAgcHJlc2FsZS5hZGRTdGFnZSg1LDMwMCk7CiAgICBwcmVzYWxlLnNldE11bHRpc2lnV2FsbGV0KDB4MDU1ZmEzZjJEQWMwYjlEYjY2MUE0NzQ1OTY1RERENjU0OTBkNTZBOCk7CiAgICBwcmVzYWxlLnNldFN0YXJ0KDE1MDcyMDg0MDApOwogICAgcHJlc2FsZS5zZXRQZXJpb2QoMik7CiAgICBwcmVzYWxlLnNldE1pblByaWNlKDEwMDAwMDAwMDAwMDAwMDAwMCk7CiAgICB0b2tlbi5zZXRTYWxlQWdlbnQocHJlc2FsZSk7CQoKICAgIG1haW5zYWxlID0gbmV3IE1haW5zYWxlKCk7CgogICAgbWFpbnNhbGUuc2V0VG9rZW4odG9rZW4pOwogICAgbWFpbnNhbGUuYWRkU3RhZ2UoMSwyMDApOwogICAgbWFpbnNhbGUuYWRkU3RhZ2UoMiwxMDApOwogICAgbWFpbnNhbGUuc2V0TXVsdGlzaWdXYWxsZXQoMHg0ZDkwMTRlRjlDM0NFNTc5MEEzMjY3NzVCZDlGNjA5OTY5ZDFCRjRmKTsKICAgIG1haW5zYWxlLnNldEZvdW5kZXJzVG9rZW5zV2FsbGV0KDB4NTliMzk4YkJFRDFDQzZjODJiMzM3QjNCZDBhZDdlNGRDQjdkNGRlMyk7CiAgICBtYWluc2FsZS5zZXRCb3VudHlUb2tlbnNXYWxsZXQoMHg1NTU2MzVGMmVhMDI2YWI2NWQ3QjQ0NTI2NTM5RTBhQjM4NzRBYjI0KTsKICAgIG1haW5zYWxlLnNldFN0YXJ0KDE1MDc0Njc2MDApOwogICAgbWFpbnNhbGUuc2V0UGVyaW9kKDIpOwogICAgbWFpbnNhbGUuc2V0TG9ja1BlcmlvZCgxKTsKICAgIG1haW5zYWxlLnNldE1pblByaWNlKDEwMDAwMDAwMDAwMDAwMDAwMCk7CiAgICBtYWluc2FsZS5zZXRGb3VuZGVyc1Rva2Vuc1BlcmNlbnQoMTMpOwogICAgbWFpbnNhbGUuc2V0Qm91bnR5VG9rZW5zUGVyY2VudCg1KTsKCiAgICBwcmVzYWxlLnNldE1haW5zYWxlKG1haW5zYWxlKTsKCiAgICB0b2tlbi50cmFuc2Zlck93bmVyc2hpcChvd25lcik7CiAgICBwcmVzYWxlLnRyYW5zZmVyT3duZXJzaGlwKG93bmVyKTsKICAgIG1haW5zYWxlLnRyYW5zZmVyT3duZXJzaGlwKG93bmVyKTsKICB9Cgp9Cgpjb250cmFjdCBDb25maWd1cmF0b3IgaXMgT3duYWJsZSB7CgogIENvdmVzdGluZ1Rva2VuIHB1YmxpYyB0b2tlbjsgCgogIFByZXNhbGUgcHVibGljIHByZXNhbGU7CgogIE1haW5zYWxlIHB1YmxpYyBtYWluc2FsZTsKCiAgZnVuY3Rpb24gZGVwbG95KCkgcHVibGljIG9ubHlPd25lciB7CiAgICB0b2tlbiA9IG5ldyBDb3Zlc3RpbmdUb2tlbigpOwoKICAgIHByZXNhbGUgPSBuZXcgUHJlc2FsZSgpOwoKICAgIHByZXNhbGUuc2V0VG9rZW4odG9rZW4pOwogICAgcHJlc2FsZS5hZGRTdGFnZSg1MDAwLDMwMCk7CiAgICBwcmVzYWxlLnNldE11bHRpc2lnV2FsbGV0KDB4NjI0NUMwNWE2ZmMyMDVkMjQ5ZDA3NzU3NjljZkU3M0NCNTk2ZTU3RCk7CiAgICBwcmVzYWxlLnNldFN0YXJ0KDE1MDg1MDQ0MDApOwogICAgcHJlc2FsZS5zZXRQZXJpb2QoMzApOwogICAgcHJlc2FsZS5zZXRNaW5QcmljZSgxMDAwMDAwMDAwMDAwMDAwMDApOwogICAgdG9rZW4uc2V0U2FsZUFnZW50KHByZXNhbGUpOwkKCiAgICBtYWluc2FsZSA9IG5ldyBNYWluc2FsZSgpOwoKICAgIG1haW5zYWxlLnNldFRva2VuKHRva2VuKTsKICAgIG1haW5zYWxlLmFkZFN0YWdlKDUwMDAsMjAwKTsKICAgIG1haW5zYWxlLmFkZFN0YWdlKDUwMDAsMTgwKTsKICAgIG1haW5zYWxlLmFkZFN0YWdlKDEwMDAwLDE3MCk7CiAgICBtYWluc2FsZS5hZGRTdGFnZSgyMDAwMCwxNjApOwogICAgbWFpbnNhbGUuYWRkU3RhZ2UoMjAwMDAsMTUwKTsKICAgIG1haW5zYWxlLmFkZFN0YWdlKDQwMDAwLDEzMCk7CiAgICBtYWluc2FsZS5zZXRNdWx0aXNpZ1dhbGxldCgweDE1QTA3MUI4MzM5NjU3N2NDYmQ4NkE5NzlBZjdkMmFCYTllMTg5NzApOwogICAgbWFpbnNhbGUuc2V0Rm91bmRlcnNUb2tlbnNXYWxsZXQoMHgyNUVENGYwRDI2MEQ1ZTUyMThEOTUzOTAwMzZiYzg4MTVGZjM4MjYyKTsKICAgIG1haW5zYWxlLnNldEJvdW50eVRva2Vuc1dhbGxldCgweDcxN2JmRDMwZjAzOTQyNEIwNDlEOTE4RjkzNURFZEQwNjlCNjY4MTApOwogICAgbWFpbnNhbGUuc2V0U3RhcnQoMTUxMTIyMjQwMCk7CiAgICBtYWluc2FsZS5zZXRQZXJpb2QoMzApOwogICAgbWFpbnNhbGUuc2V0TG9ja1BlcmlvZCg5MCk7CiAgICBtYWluc2FsZS5zZXRNaW5QcmljZSgxMDAwMDAwMDAwMDAwMDAwMDApOwogICAgbWFpbnNhbGUuc2V0Rm91bmRlcnNUb2tlbnNQZXJjZW50KDEzKTsKICAgIG1haW5zYWxlLnNldEJvdW50eVRva2Vuc1BlcmNlbnQoNSk7CgogICAgcHJlc2FsZS5zZXRNYWluc2FsZShtYWluc2FsZSk7CgogICAgdG9rZW4udHJhbnNmZXJPd25lcnNoaXAob3duZXIpOwogICAgcHJlc2FsZS50cmFuc2Zlck93bmVyc2hpcChvd25lcik7CiAgICBtYWluc2FsZS50cmFuc2Zlck93bmVyc2hpcChvd25lcik7CiAgfQoKfQoKY29udHJhY3QgVXBkYXRlTWFpbnNhbGUgaXMgQ29tbW9uU2FsZSB7CgogICAgZW51bSBDdXJyZW5jeSB7IEJUQywgTFRDLCBaRUMsIERBU0gsIFdBVkVTLCBVU0QsIEVVUiB9CgogICAgZXZlbnQgRXh0ZXJuYWxTYWxlKAogICAgICAgIEN1cnJlbmN5IF9jdXJyZW5jeSwKICAgICAgICBieXRlczMyIF90eElkU2hhMywKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgX2J1eWVyLAogICAgICAgIHVpbnQyNTYgX2Ftb3VudFdlaSwKICAgICAgICB1aW50MjU2IF90b2tlbnNFMTgKICAgICk7CgogICAgZXZlbnQgTm90aWZpZXJDaGFuZ2VkKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBfb2xkQWRkcmVzcywKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgX25ld0FkZHJlc3MKICAgICk7CgogICAgLy8gQWRkcmVzcyB0aGF0IGNhbiB0aGlzIGNyb3dkc2FsZSBhYm91dCBjaGFuZ2VkIGV4dGVybmFsIGNvbmRpdGlvbnMuCiAgICBhZGRyZXNzIHB1YmxpYyBub3RpZmllcjsKCiAgICAvLyBjdXJyZW5jeV9jb2RlID0+IChzaGEzX29mX3R4X2lkID0+IHRva2Vuc19lMTgpCiAgICBtYXBwaW5nKHVpbnQ4ID0+IG1hcHBpbmcoYnl0ZXMzMiA9PiB1aW50MjU2KSkgcHVibGljIGV4dGVybmFsVHhzOwoKICAgIC8vIFRvdGFsIGFtb3VudCBvZiBleHRlcm5hbCBjb250cmlidXRpb25zIChCVEMsIExUQywgVVNELCBldGMuKSBkdXJpbmcgdGhpcyBjcm93ZHNhbGUuCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbEV4dGVybmFsU2FsZXMgPSAwOwoKICAgIG1vZGlmaWVyIGNhbk5vdGlmeSgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIgfHwgbXNnLnNlbmRlciA9PSBub3RpZmllcik7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tCgogICAgYWRkcmVzcyBwdWJsaWMgZm91bmRlcnNUb2tlbnNXYWxsZXQ7CgogICAgYWRkcmVzcyBwdWJsaWMgYm91bnR5VG9rZW5zV2FsbGV0OwoKICAgIHVpbnQgcHVibGljIGZvdW5kZXJzVG9rZW5zUGVyY2VudDsKCiAgICB1aW50IHB1YmxpYyBib3VudHlUb2tlbnNQZXJjZW50OwoKICAgIHVpbnQgcHVibGljIHBlcmNlbnRSYXRlID0gMTAwOwoKICAgIHVpbnQgcHVibGljIGxvY2tQZXJpb2Q7CgogICAgZnVuY3Rpb24gc2V0TG9ja1BlcmlvZCh1aW50IG5ld0xvY2tQZXJpb2QpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIGxvY2tQZXJpb2QgPSBuZXdMb2NrUGVyaW9kOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEZvdW5kZXJzVG9rZW5zUGVyY2VudCh1aW50IG5ld0ZvdW5kZXJzVG9rZW5zUGVyY2VudCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgZm91bmRlcnNUb2tlbnNQZXJjZW50ID0gbmV3Rm91bmRlcnNUb2tlbnNQZXJjZW50OwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEJvdW50eVRva2Vuc1BlcmNlbnQodWludCBuZXdCb3VudHlUb2tlbnNQZXJjZW50KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBib3VudHlUb2tlbnNQZXJjZW50ID0gbmV3Qm91bnR5VG9rZW5zUGVyY2VudDsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRGb3VuZGVyc1Rva2Vuc1dhbGxldChhZGRyZXNzIG5ld0ZvdW5kZXJzVG9rZW5zV2FsbGV0KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBmb3VuZGVyc1Rva2Vuc1dhbGxldCA9IG5ld0ZvdW5kZXJzVG9rZW5zV2FsbGV0OwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEJvdW50eVRva2Vuc1dhbGxldChhZGRyZXNzIG5ld0JvdW50eVRva2Vuc1dhbGxldCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgYm91bnR5VG9rZW5zV2FsbGV0ID0gbmV3Qm91bnR5VG9rZW5zV2FsbGV0OwogICAgfQoKICAgIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCBvbmx5T3duZXIgewogICAgICAgIHVpbnQgc3VtbWFyeVRva2Vuc1BlcmNlbnQgPSBib3VudHlUb2tlbnNQZXJjZW50ICsgZm91bmRlcnNUb2tlbnNQZXJjZW50OwogICAgICAgIHVpbnQgbWludGVkVG9rZW5zID0gdG9rZW4udG90YWxTdXBwbHkoKTsKICAgICAgICB1aW50IHN1bW1hcnlGb3VuZGVyc1Rva2VucyA9IG1pbnRlZFRva2Vucy5tdWwoc3VtbWFyeVRva2Vuc1BlcmNlbnQpLmRpdihwZXJjZW50UmF0ZSAtIHN1bW1hcnlUb2tlbnNQZXJjZW50KTsKICAgICAgICB1aW50IHRvdGFsU3VwcGx5ID0gc3VtbWFyeUZvdW5kZXJzVG9rZW5zICsgbWludGVkVG9rZW5zOwogICAgICAgIHVpbnQgZm91bmRlcnNUb2tlbnMgPSB0b3RhbFN1cHBseS5tdWwoZm91bmRlcnNUb2tlbnNQZXJjZW50KS5kaXYocGVyY2VudFJhdGUpOwogICAgICAgIHVpbnQgYm91bnR5VG9rZW5zID0gdG90YWxTdXBwbHkubXVsKGJvdW50eVRva2Vuc1BlcmNlbnQpLmRpdihwZXJjZW50UmF0ZSk7CiAgICAgICAgdG9rZW4ubWludCh0aGlzLCBmb3VuZGVyc1Rva2Vucyk7CiAgICAgICAgdG9rZW4ubG9jayhmb3VuZGVyc1Rva2Vuc1dhbGxldCwgbG9ja1BlcmlvZCAqIDEgZGF5cyk7CiAgICAgICAgdG9rZW4udHJhbnNmZXIoZm91bmRlcnNUb2tlbnNXYWxsZXQsIGZvdW5kZXJzVG9rZW5zKTsKICAgICAgICB0b2tlbi5taW50KHRoaXMsIGJvdW50eVRva2Vucyk7CiAgICAgICAgdG9rZW4udHJhbnNmZXIoYm91bnR5VG9rZW5zV2FsbGV0LCBib3VudHlUb2tlbnMpOwogICAgICAgIHRvdGFsVG9rZW5zTWludGVkID0gdG90YWxUb2tlbnNNaW50ZWQuYWRkKGZvdW5kZXJzVG9rZW5zKS5hZGQoYm91bnR5VG9rZW5zKTsKICAgICAgICB0b2tlbi5maW5pc2hNaW50aW5nKCk7CiAgICB9CgogICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyBCZWdpbiBvZiBleHRlcm5hbCBzYWxlcy4KCiAgICBmdW5jdGlvbiBzZXROb3RpZmllcihhZGRyZXNzIF9ub3RpZmllcikgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgTm90aWZpZXJDaGFuZ2VkKG5vdGlmaWVyLCBfbm90aWZpZXIpOwogICAgICAgIG5vdGlmaWVyID0gX25vdGlmaWVyOwogICAgfQoKICAgIGZ1bmN0aW9uIGV4dGVybmFsU2FsZXMoCiAgICAgICAgdWludDhbXSBfY3VycmVuY2llcywKICAgICAgICBieXRlczMyW10gX3R4SWRTaGEzLAogICAgICAgIGFkZHJlc3NbXSBfYnV5ZXJzLAogICAgICAgIHVpbnQyNTZbXSBfYW1vdW50c1dlaSwKICAgICAgICB1aW50MjU2W10gX3Rva2Vuc0UxOAogICAgKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCBjYW5Ob3RpZnkgewoKICAgICAgICByZXF1aXJlKF9jdXJyZW5jaWVzLmxlbmd0aCA+IDApOwogICAgICAgIHJlcXVpcmUoX2N1cnJlbmNpZXMubGVuZ3RoID09IF90eElkU2hhMy5sZW5ndGgpOwogICAgICAgIHJlcXVpcmUoX2N1cnJlbmNpZXMubGVuZ3RoID09IF9idXllcnMubGVuZ3RoKTsKICAgICAgICByZXF1aXJlKF9jdXJyZW5jaWVzLmxlbmd0aCA9PSBfYW1vdW50c1dlaS5sZW5ndGgpOwogICAgICAgIHJlcXVpcmUoX2N1cnJlbmNpZXMubGVuZ3RoID09IF90b2tlbnNFMTgubGVuZ3RoKTsKCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgX3R4SWRTaGEzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIF9leHRlcm5hbFNhbGVTaGEzKAogICAgICAgICAgICAgICAgQ3VycmVuY3koX2N1cnJlbmNpZXNbaV0pLAogICAgICAgICAgICAgICAgX3R4SWRTaGEzW2ldLAogICAgICAgICAgICAgICAgX2J1eWVyc1tpXSwKICAgICAgICAgICAgICAgIF9hbW91bnRzV2VpW2ldLAogICAgICAgICAgICAgICAgX3Rva2Vuc0UxOFtpXQogICAgICAgICAgICApOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBfZXh0ZXJuYWxTYWxlU2hhMygKICAgICAgICBDdXJyZW5jeSBfY3VycmVuY3ksCiAgICAgICAgYnl0ZXMzMiBfdHhJZFNoYTMsIC8vIFRvIGdldCBieXRlczMyIHVzZSBrZWNjYWsyNTYodHhJZCkgT1Igc2hhMyh0eElkKQogICAgICAgIGFkZHJlc3MgX2J1eWVyLAogICAgICAgIHVpbnQyNTYgX2Ftb3VudFdlaSwKICAgICAgICB1aW50MjU2IF90b2tlbnNFMTgKICAgICkgaW50ZXJuYWwgewoKICAgICAgICByZXF1aXJlKF9idXllciA+IDAgJiYgX2Ftb3VudFdlaSA+IDAgJiYgX3Rva2Vuc0UxOCA+IDApOwoKICAgICAgICB2YXIgdHhzQnlDdXIgPSBleHRlcm5hbFR4c1t1aW50OChfY3VycmVuY3kpXTsKCiAgICAgICAgLy8gSWYgdGhpcyBmb3JlaWduIHRyYW5zYWN0aW9uIGhhcyBiZWVuIGFscmVhZHkgcHJvY2Vzc2VkIGluIHRoaXMgY29udHJhY3QuCiAgICAgICAgcmVxdWlyZSh0eHNCeUN1cltfdHhJZFNoYTNdID09IDApOwogICAgICAgIHR4c0J5Q3VyW190eElkU2hhM10gPSBfdG9rZW5zRTE4OwoKICAgICAgICB1aW50IHN0YWdlSW5kZXggPSBjdXJyZW50U3RhZ2UoKTsKICAgICAgICBTdGFnZSBzdG9yYWdlIHN0YWdlID0gc3RhZ2VzW3N0YWdlSW5kZXhdOwoKICAgICAgICB0b2tlbi5taW50KHRoaXMsIF90b2tlbnNFMTgpOwogICAgICAgIHRva2VuLnRyYW5zZmVyKF9idXllciwgX3Rva2Vuc0UxOCk7CiAgICAgICAgdG90YWxUb2tlbnNNaW50ZWQgPSB0b3RhbFRva2Vuc01pbnRlZC5hZGQoX3Rva2Vuc0UxOCk7CiAgICAgICAgdG90YWxFeHRlcm5hbFNhbGVzKys7CgogICAgICAgIHRvdGFsSW52ZXN0ZWQgPSB0b3RhbEludmVzdGVkLmFkZChfYW1vdW50V2VpKTsKICAgICAgICBzdGFnZS5pbnZlc3RlZCA9IHN0YWdlLmludmVzdGVkLmFkZChfYW1vdW50V2VpKTsKICAgICAgICBpZiAoc3RhZ2UuaW52ZXN0ZWQgPj0gc3RhZ2UuaGFyZGNhcCkgewogICAgICAgICAgICBzdGFnZS5jbG9zZWQgPSBub3c7CiAgICAgICAgfQoKICAgICAgICBFeHRlcm5hbFNhbGUoX2N1cnJlbmN5LCBfdHhJZFNoYTMsIF9idXllciwgX2Ftb3VudFdlaSwgX3Rva2Vuc0UxOCk7CiAgICB9CgogICAgLy8gR2V0IGlkIG9mIGN1cnJlbmN5IGVudW0uIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgZnVuY3Rpb24gYnRjSWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gdWludDgoQ3VycmVuY3kuQlRDKTsKICAgIH0KCiAgICBmdW5jdGlvbiBsdGNJZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50OCkgewogICAgICAgIHJldHVybiB1aW50OChDdXJyZW5jeS5MVEMpOwogICAgfQoKICAgIGZ1bmN0aW9uIHplY0lkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgcmV0dXJuIHVpbnQ4KEN1cnJlbmN5LlpFQyk7CiAgICB9CgogICAgZnVuY3Rpb24gZGFzaElkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgcmV0dXJuIHVpbnQ4KEN1cnJlbmN5LkRBU0gpOwogICAgfQoKICAgIGZ1bmN0aW9uIHdhdmVzSWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gdWludDgoQ3VycmVuY3kuV0FWRVMpOwogICAgfQoKICAgIGZ1bmN0aW9uIHVzZElkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgcmV0dXJuIHVpbnQ4KEN1cnJlbmN5LlVTRCk7CiAgICB9CgogICAgZnVuY3Rpb24gZXVySWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gdWludDgoQ3VycmVuY3kuRVVSKTsKICAgIH0KCiAgICAvLyBHZXQgdG9rZW4gY291bnQgYnkgdHJhbnNhY3Rpb24gaWQuIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBmdW5jdGlvbiBfdG9rZW5zQnlUeChDdXJyZW5jeSBfY3VycmVuY3ksIHN0cmluZyBfdHhJZCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiB0b2tlbnNCeVR4KHVpbnQ4KF9jdXJyZW5jeSksIF90eElkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b2tlbnNCeVR4KHVpbnQ4IF9jdXJyZW5jeSwgc3RyaW5nIF90eElkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBleHRlcm5hbFR4c1tfY3VycmVuY3ldW2tlY2NhazI1NihfdHhJZCldOwogICAgfQoKICAgIGZ1bmN0aW9uIHRva2Vuc0J5QnRjVHgoc3RyaW5nIF90eElkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBfdG9rZW5zQnlUeChDdXJyZW5jeS5CVEMsIF90eElkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b2tlbnNCeUx0Y1R4KHN0cmluZyBfdHhJZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gX3Rva2Vuc0J5VHgoQ3VycmVuY3kuTFRDLCBfdHhJZCk7CiAgICB9CgogICAgZnVuY3Rpb24gdG9rZW5zQnlaZWNUeChzdHJpbmcgX3R4SWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIF90b2tlbnNCeVR4KEN1cnJlbmN5LlpFQywgX3R4SWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRva2Vuc0J5RGFzaFR4KHN0cmluZyBfdHhJZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gX3Rva2Vuc0J5VHgoQ3VycmVuY3kuREFTSCwgX3R4SWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRva2Vuc0J5V2F2ZXNUeChzdHJpbmcgX3R4SWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIF90b2tlbnNCeVR4KEN1cnJlbmN5LldBVkVTLCBfdHhJZCk7CiAgICB9CgogICAgZnVuY3Rpb24gdG9rZW5zQnlVc2RUeChzdHJpbmcgX3R4SWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIF90b2tlbnNCeVR4KEN1cnJlbmN5LlVTRCwgX3R4SWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRva2Vuc0J5RXVyVHgoc3RyaW5nIF90eElkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBfdG9rZW5zQnlUeChDdXJyZW5jeS5FVVIsIF90eElkKTsKICAgIH0KCiAgICAvLyBFbmQgb2YgZXh0ZXJuYWwgc2FsZXMuCiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KfQoKY29udHJhY3QgVXBkYXRlQ29uZmlndXJhdG9yIGlzIE93bmFibGUgewoKICAgIENvdmVzdGluZ1Rva2VuIHB1YmxpYyB0b2tlbjsKCiAgICBVcGRhdGVNYWluc2FsZSBwdWJsaWMgbWFpbnNhbGU7CgogICAgZnVuY3Rpb24gZGVwbG95KCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgbWFpbnNhbGUgPSBuZXcgVXBkYXRlTWFpbnNhbGUoKTsKICAgICAgICB0b2tlbiA9IENvdmVzdGluZ1Rva2VuKDB4RTJGQjY1MjlFRjU2NmEwODBlNmQyM2RFMGJkMzUxMzExMDg3RDU2Nyk7CiAgICAgICAgbWFpbnNhbGUuc2V0VG9rZW4odG9rZW4pOwogICAgICAgIG1haW5zYWxlLmFkZFN0YWdlKDUwMDAsMjAwKTsKICAgICAgICBtYWluc2FsZS5hZGRTdGFnZSg1MDAwLDE4MCk7CiAgICAgICAgbWFpbnNhbGUuYWRkU3RhZ2UoMTAwMDAsMTcwKTsKICAgICAgICBtYWluc2FsZS5hZGRTdGFnZSgyMDAwMCwxNjApOwogICAgICAgIG1haW5zYWxlLmFkZFN0YWdlKDIwMDAwLDE1MCk7CiAgICAgICAgbWFpbnNhbGUuYWRkU3RhZ2UoNDAwMDAsMTMwKTsKICAgICAgICBtYWluc2FsZS5zZXRNdWx0aXNpZ1dhbGxldCgweDE1QTA3MUI4MzM5NjU3N2NDYmQ4NkE5NzlBZjdkMmFCYTllMTg5NzApOwogICAgICAgIG1haW5zYWxlLnNldEZvdW5kZXJzVG9rZW5zV2FsbGV0KDB4MjVFRDRmMEQyNjBENWU1MjE4RDk1MzkwMDM2YmM4ODE1RmYzODI2Mik7CiAgICAgICAgbWFpbnNhbGUuc2V0Qm91bnR5VG9rZW5zV2FsbGV0KDB4NzE3YmZEMzBmMDM5NDI0QjA0OUQ5MThGOTM1REVkRDA2OUI2NjgxMCk7CiAgICAgICAgbWFpbnNhbGUuc2V0U3RhcnQoMTUxMTUyODQwMCk7CiAgICAgICAgbWFpbnNhbGUuc2V0UGVyaW9kKDMwKTsKICAgICAgICBtYWluc2FsZS5zZXRMb2NrUGVyaW9kKDkwKTsKICAgICAgICBtYWluc2FsZS5zZXRNaW5QcmljZSgxMDAwMDAwMDAwMDAwMDAwMDApOwogICAgICAgIG1haW5zYWxlLnNldEZvdW5kZXJzVG9rZW5zUGVyY2VudCgxMyk7CiAgICAgICAgbWFpbnNhbGUuc2V0Qm91bnR5VG9rZW5zUGVyY2VudCg1KTsKICAgICAgICBtYWluc2FsZS5zZXROb3RpZmllcihvd25lcik7CiAgICAgICAgbWFpbnNhbGUudHJhbnNmZXJPd25lcnNoaXAob3duZXIpOwogICAgfQoKfQoKY29udHJhY3QgSW5jcmVhc2VUb2tlbnNPcGVyYXRvciBpcyBPd25hYmxlIHsKCiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIGF1dGhvcml6ZWQ7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIG1pbnRlZDsKCiAgYWRkcmVzc1tdIHB1YmxpYyBtaW50ZWRMaXN0OwoKICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBwZW5kaW5nOwoKICBhZGRyZXNzW10gcHVibGljIHBlbmRpbmdMaXN0OwoKICBDb3Zlc3RpbmdUb2tlbiBwdWJsaWMgdG9rZW4gPSBDb3Zlc3RpbmdUb2tlbigweEUyRkI2NTI5RUY1NjZhMDgwZTZkMjNkRTBiZDM1MTMxMTA4N0Q1NjcpOwoKICB1aW50IHB1YmxpYyBpbmNyZWFzZUsgPSA0OwoKICB1aW50IHB1YmxpYyBpbmRleDsKCiAgbW9kaWZpZXIgb25seUF1dGhvcml6ZWQoKSB7CiAgICByZXF1aXJlKG93bmVyID09IG1zZy5zZW5kZXIgfHwgYXV0aG9yaXplZFttc2cuc2VuZGVyXSk7CiAgICBfOwogIH0KCiAgZnVuY3Rpb24gaW52ZXN0b3JzQ291bnQoKSBwdWJsaWMgcmV0dXJucyh1aW50KSB7CiAgICB1aW50IGNvdW50ID0gcGVuZGluZ0xpc3QubGVuZ3RoOwogICAgcmV0dXJuIGNvdW50OwogIH0KCiAgZnVuY3Rpb24gZXh0cmFNaW50QXJyYXlQZW5kaW5nUHJvY2Vzcyh1aW50IGNvdW50KSBwdWJsaWMgb25seUF1dGhvcml6ZWQgewogICAgZm9yKHVpbnQgaSA9IDA7IGluZGV4IDwgcGVuZGluZ0xpc3QubGVuZ3RoICYmIGkgPCBjb3VudDsgaSsrKSB7CiAgICAgIGFkZHJlc3MgdG9rZW5Ib2xkZXIgPSBwZW5kaW5nTGlzdFtpbmRleF07CiAgICAgIHVpbnQgdmFsdWUgPSB0b2tlbi5iYWxhbmNlT2YodG9rZW5Ib2xkZXIpOwogICAgICBpZih2YWx1ZSAhPSAwKSB7CiAgICAgICAgdWludCB0YXJnZXRWYWx1ZSA9IHZhbHVlLm11bChpbmNyZWFzZUspOwogICAgICAgIHVpbnQgZGlmZlZhbHVlID0gdGFyZ2V0VmFsdWUuc3ViKHZhbHVlKTsKICAgICAgICB0b2tlbi5taW50KHRoaXMsIGRpZmZWYWx1ZSk7CiAgICAgICAgdG9rZW4udHJhbnNmZXIodG9rZW5Ib2xkZXIsIGRpZmZWYWx1ZSk7CiAgICAgIH0KICAgICAgbWludGVkW3Rva2VuSG9sZGVyXSA9IHRydWU7CiAgICAgIG1pbnRlZExpc3QucHVzaCh0b2tlbkhvbGRlcik7CiAgICAgIGluZGV4Kys7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBleHRyYU1pbnRBcnJheVBlbmRpbmcoYWRkcmVzc1tdIHRva2VuSG9sZGVycykgcHVibGljIG9ubHlBdXRob3JpemVkIHsKICAgIGZvcih1aW50IGkgPSAwOyBpIDwgdG9rZW5Ib2xkZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGFkZHJlc3MgdG9rZW5Ib2xkZXIgPSB0b2tlbkhvbGRlcnNbaV07CiAgICAgIHJlcXVpcmUoIXBlbmRpbmdbdG9rZW5Ib2xkZXJdKTsKICAgICAgcGVuZGluZ1t0b2tlbkhvbGRlcl0gPSB0cnVlOwogICAgICBwZW5kaW5nTGlzdC5wdXNoKHRva2VuSG9sZGVyKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGV4dHJhTWludChhZGRyZXNzIHRva2VuSG9sZGVyKSBwdWJsaWMgb25seUF1dGhvcml6ZWQgewogICAgdWludCB2YWx1ZSA9IHRva2VuLmJhbGFuY2VPZih0b2tlbkhvbGRlcik7CiAgICBpZih2YWx1ZSAhPSAwKSB7CiAgICAgIHVpbnQgdGFyZ2V0VmFsdWUgPSB2YWx1ZS5tdWwoaW5jcmVhc2VLKTsKICAgICAgdWludCBkaWZmVmFsdWUgPSB0YXJnZXRWYWx1ZS5zdWIodmFsdWUpOwogICAgICB0b2tlbi5taW50KHRoaXMsIGRpZmZWYWx1ZSk7CiAgICAgIHRva2VuLnRyYW5zZmVyKHRva2VuSG9sZGVyLCBkaWZmVmFsdWUpOwogICAgfQogICAgbWludGVkW3Rva2VuSG9sZGVyXSA9IHRydWU7CiAgICBtaW50ZWRMaXN0LnB1c2godG9rZW5Ib2xkZXIpOwogIH0KCiAgZnVuY3Rpb24gZXh0cmFNaW50QXJyYXkoYWRkcmVzc1tdIHRva2VuSG9sZGVycykgcHVibGljIG9ubHlBdXRob3JpemVkIHsKICAgIGZvcih1aW50IGkgPSAwOyBpIDwgdG9rZW5Ib2xkZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGFkZHJlc3MgdG9rZW5Ib2xkZXIgPSB0b2tlbkhvbGRlcnNbaV07CiAgICAgIHJlcXVpcmUoIW1pbnRlZFt0b2tlbkhvbGRlcl0pOwogICAgICB1aW50IHZhbHVlID0gdG9rZW4uYmFsYW5jZU9mKHRva2VuSG9sZGVyKTsKICAgICAgaWYodmFsdWUgIT0gMCkgewogICAgICAgIHVpbnQgdGFyZ2V0VmFsdWUgPSB2YWx1ZS5tdWwoaW5jcmVhc2VLKTsKICAgICAgICB1aW50IGRpZmZWYWx1ZSA9IHRhcmdldFZhbHVlLnN1Yih2YWx1ZSk7CiAgICAgICAgdG9rZW4ubWludCh0aGlzLCBkaWZmVmFsdWUpOwogICAgICAgIHRva2VuLnRyYW5zZmVyKHRva2VuSG9sZGVyLCBkaWZmVmFsdWUpOyAgICAgIAogICAgICB9CiAgICAgIG1pbnRlZFt0b2tlbkhvbGRlcl0gPSB0cnVlOwogICAgICBtaW50ZWRMaXN0LnB1c2godG9rZW5Ib2xkZXIpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gc2V0SW5jcmVhc2VLKHVpbnQgbmV3SW5jcmVhc2VLKSBwdWJsaWMgb25seU93bmVyIHsKICAgIGluY3JlYXNlSyA9IG5ld0luY3JlYXNlSzsKICB9CgogIGZ1bmN0aW9uIHNldFRva2VuKGFkZHJlc3MgbmV3VG9rZW4pIHB1YmxpYyBvbmx5T3duZXIgewogICAgdG9rZW4gPSBDb3Zlc3RpbmdUb2tlbihuZXdUb2tlbik7CiAgfQoKICBmdW5jdGlvbiBhdXRob3JpemUoYWRkcmVzcyB0bykgcHVibGljIG9ubHlBdXRob3JpemVkIHsKICAgIHJlcXVpcmUoIWF1dGhvcml6ZWRbdG9dKTsKICAgIGF1dGhvcml6ZWRbdG9dID0gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIHVuYXV0aG9yaXplKGFkZHJlc3MgdG8pIHB1YmxpYyBvbmx5QXV0aG9yaXplZCB7CiAgICByZXF1aXJlKGF1dGhvcml6ZWRbdG9dKTsKICAgIGF1dGhvcml6ZWRbdG9dID0gZmFsc2U7CiAgfQoKfQ=='.
	

]
