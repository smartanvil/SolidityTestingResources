Class {
	#name : #SRT30cefbcb5c26a5b19a019092ab8d09f8739c904f,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT30cefbcb5c26a5b19a019092ab8d09f8739c904f >> base64 [
	^ 'LyoKZmlsZTogICBWZW50YW5hVG9rZW4uc29sCnZlcjogICAgMC4xLjAKYXV0aG9yOiBEYXJyeWwgTW9ycmlzCmRhdGU6ICAgMTQtQXVnLTIwMTcKZW1haWw6ICBvMHJhZ21hbjBvIEFUIGdtYWlsLmNvbQooYykgRGFycnlsIE1vcnJpcyAyMDE3CgpBIGNvbGxhdGVkIGNvbnRyYWN0IHNldCBmb3IgYSB0b2tlbiBzYWxlIHNwZWNpZmljIHRvIHRoZSByZXF1aXJtZW50cyBvZgpWZXJlZGljdHVtJ3MgVmVudGFuYSB0b2tlbiBwcm9kdWN0LgoKVGhpcyBzb2Z0d2FyZSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLApidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgpNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICAKU2VlIE1JVCBMaWNlbmNlIGZvciBmdXJ0aGVyIGRldGFpbHMuCjxodHRwczovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL01JVD4uCgpSZWxlYXNlIE5vdGVzCi0tLS0tLS0tLS0tLS0KMC4xLjAKKiBSZWxlYXNlIHZlcnNpb24KKiB1cGRhdGVkIG93bmVyLCBmdW5kV2FsbGV0LCBVU0RfUEVSX0VUSCwgYW5kIFNUQVJUX0RBVEUgdG8gZmluYWwgdmFsdWVzIGluIFZlbnRhbmFUb2tlbkNvbmZpZwoKCiovCgoKcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7CgovKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXAoKIFZlbnRhbmEgdG9rZW4gc2FsZSBjb25maWd1cmF0aW9uCgpcKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKLy8gQ29udGFpbnMgdG9rZW4gc2FsZSBwYXJhbWV0ZXJzCmNvbnRyYWN0IFZlbnRhbmFUb2tlbkNvbmZpZwp7CiAgICAvLyBFUkMyMCB0cmFkZSBuYW1lIGFuZCBzeW1ib2wKICAgIHN0cmluZyBwdWJsaWMgICAgICAgICAgIG5hbWUgICAgICAgICAgICA9ICJWZW50YW5hIjsKICAgIHN0cmluZyBwdWJsaWMgICAgICAgICAgIHN5bWJvbCAgICAgICAgICA9ICJWTlQiOwoKICAgIC8vIE93bmVyIGhhcyBwb3dlciB0byBhYm9ydCwgZGlzY291bnQgYWRkcmVzc2VzLCBzd2VlcCBzdWNjZXNzZnVsIGZ1bmRzLAogICAgLy8gY2hhbmdlIG93bmVyLCBzd2VlcCBhbGllbiB0b2tlbnMuCiAgICBhZGRyZXNzIHB1YmxpYyAgICAgICAgICBvd25lciAgICAgICAgICAgPSAweEY0YjA4N0FkMjU2QUJDNUJFMTFFMDQzM0IxNUVkMDEyYzhBRUM4QjQ7IC8vIHZlcmVkaWN0dW1QcmltYXJ5IGFkZHJlc3MgY2hlY2tzdW1tZWQKICAgIAogICAgLy8gRnVuZCB3YWxsZXQgc2hvdWxkIGFsc28gYmUgYXVkaXRlZCBwcmlvciB0byBkZXBsb3ltZW50CiAgICAvLyBOT1RFOiBNdXN0IGJlIGNoZWNrc3VtbWVkIGFkZHJlc3MhCiAgICBhZGRyZXNzIHB1YmxpYyAgICAgICAgICBmdW5kV2FsbGV0ICAgICAgPSAweGQ2NTE0Mzg3MjM2NTk1ZTA4MEI5N2M4ZWFkMWNCRjEyZjlhNkFiNjU7IC8vIG11bHRpU2lnIGFkZHJlc3MgY2hlY2tzdW1tZWQKCiAgICAvLyBUb2tlbnMgYXdhcmRlZCBwZXIgVVNEIGNvbnRyaWJ1dGVkCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCAgICBUT0tFTlNfUEVSX1VTRCAgPSAzOwoKICAgIC8vIEV0aGVyIG1hcmtldCBwcmljZSBpbiBVU0QKICAgIHVpbnQgcHVibGljIGNvbnN0YW50ICAgIFVTRF9QRVJfRVRIICAgICA9IDI1ODsgLy8gY2FsY3VsYXRlZCBmcm9tIDYwIGRheSBtb3ZpbmcgYXZlcmFnZSBhcyBhdCAxNHRoIEF1Z3VzdCAyMDE3CiAgICAKICAgIC8vIE1pbmltdW0gYW5kIG1heGltdW0gdGFyZ2V0IGluIFVTRAogICAgdWludCBwdWJsaWMgY29uc3RhbnQgICAgTUlOX1VTRF9GVU5EICAgID0gMjAwMDAwMDsgIC8vICQybQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgICAgTUFYX1VTRF9GVU5EICAgID0gMjAwMDAwMDA7IC8vICQyMG0KICAgIAogICAgLy8gTm9uLUtZQyBjb250cmlidXRpb24gbGltaXQgaW4gVVNECiAgICB1aW50IHB1YmxpYyBjb25zdGFudCAgICBLWUNfVVNEX0xNVCAgICAgPSAxMDAwMDsKICAgIAogICAgLy8gVGhlcmUgd2lsbCBiZSBleGFjdGx5IDMwMCwwMDAsMDAwIHRva2VucyByZWdhcmRsZXNzIG9mIG51bWJlciBzb2xkCiAgICAvLyBVbnNvbGQgdG9rZW5zIGFyZSBwdXQgaW50byB0aGUgU3RyYXRlZ2ljIEdyb3d0aCB0b2tlbiBwb29sCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCAgICBNQVhfVE9LRU5TICAgICAgPSAzMDAwMDAwMDA7CiAgICAKICAgIC8vIEZ1bmRpbmcgYmVnaW5zIG9uIDE0dGggQXVndXN0IDIwMTcKICAgIC8vIGArIG5ldyBEYXRlKCcxOTowMCAxNCBBdWd1c3QgMjAxNycpLzEwMDBgCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCAgICBTVEFSVF9EQVRFICAgICAgPSAxNTAyNzAxMjAwOyAvLyBNb24gQXVnIDE0IDIwMTcgMTk6MDA6MDAgR01UKzEwMDAgKEFFU1QpCgogICAgLy8gUGVyaW9kIGZvciBmdW5kcmFpc2luZwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgICAgRlVORElOR19QRVJJT0QgID0gMjggZGF5czsKfQoKCmxpYnJhcnkgU2FmZU1hdGgKewogICAgLy8gYSBhZGQgdG8gYgogICAgZnVuY3Rpb24gYWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50IGMpIHsKICAgICAgICBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSk7CiAgICB9CiAgICAKICAgIC8vIGEgc3VidHJhY3QgYgogICAgZnVuY3Rpb24gc3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50IGMpIHsKICAgICAgICBjID0gYSAtIGI7CiAgICAgICAgYXNzZXJ0KGMgPD0gYSk7CiAgICB9CiAgICAKICAgIC8vIGEgbXVsdGlwbGllZCBieSBiCiAgICBmdW5jdGlvbiBtdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQgYykgewogICAgICAgIGMgPSBhICogYjsKICAgICAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgfQogICAgCiAgICAvLyBhIGRpdmlkZWQgYnkgYgogICAgZnVuY3Rpb24gZGl2KHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50IGMpIHsKICAgICAgICBjID0gYSAvIGI7CiAgICAgICAgLy8gTm8gYXNzZXJ0IHJlcXVpcmVkIGFzIG5vIG92ZXJmbG93cyBhcmUgcG9zaWJsZS4KICAgIH0KfQoKCmNvbnRyYWN0IFJlZW50cnlQcm90ZWN0ZWQKewogICAgLy8gVGhlIHJlZW50cnkgcHJvdGVjdGlvbiBzdGF0ZSBtdXRleC4KICAgIGJvb2wgX19yZU11dGV4OwoKICAgIC8vIFNldHMgYW5kIHJlc2V0cyBtdXRleCBpbiBvcmRlciB0byBibG9jayBmdW5jdGluIHJlZW50cnkKICAgIG1vZGlmaWVyIHByZXZlbnRSZWVudHJ5KCkgewogICAgICAgIHJlcXVpcmUoIV9fcmVNdXRleCk7CiAgICAgICAgX19yZU11dGV4ID0gdHJ1ZTsKICAgICAgICBfOwogICAgICAgIGRlbGV0ZSBfX3JlTXV0ZXg7CiAgICB9CgogICAgLy8gQmxvY2tzIGZ1bmN0aW9uIGVudHJ5IGlmIG11dGV4IGlzIHNldAogICAgbW9kaWZpZXIgbm9SZWVudHJ5KCkgewogICAgICAgIHJlcXVpcmUoIV9fcmVNdXRleCk7CiAgICAgICAgXzsKICAgIH0KfQoKY29udHJhY3QgRVJDMjBUb2tlbgp7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKCi8qIENvbnN0YW50cyAqLwoKICAgIC8vIG5vbmUKICAgIAovKiBTdGF0ZSB2YXJpYWJsZSAqLwoKICAgIC8vLyBAcmV0dXJuIFRoZSBUb3RhbCBzdXBwbHkgb2YgdG9rZW5zCiAgICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseTsKICAgIAogICAgLy8vIEByZXR1cm4gVG9rZW4gc3ltYm9sCiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsKICAgIAogICAgLy8gVG9rZW4gb3duZXJzaGlwIG1hcHBpbmcKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgYmFsYW5jZXM7CiAgICAKICAgIC8vIEFsbG93YW5jZXMgbWFwcGluZwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpKSBhbGxvd2VkOwoKLyogRXZlbnRzICovCgogICAgLy8gVHJpZ2dlcmVkIHdoZW4gdG9rZW5zIGFyZSB0cmFuc2ZlcnJlZC4KICAgIGV2ZW50IFRyYW5zZmVyKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgX3RvLAogICAgICAgIHVpbnQyNTYgX2Ftb3VudCk7CgogICAgLy8gVHJpZ2dlcmVkIHdoZW5ldmVyIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfYW1vdW50KSBpcyBjYWxsZWQuCiAgICBldmVudCBBcHByb3ZhbCgKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgX293bmVyLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwKICAgICAgICB1aW50MjU2IF9hbW91bnQpOwoKLyogTW9kaWZpZXJzICovCgogICAgLy8gbm9uZQogICAgCi8qIEZ1bmN0aW9ucyAqLwoKICAgIC8vIFVzaW5nIGFuIGV4cGxpY2l0IGdldHRlciBhbGxvd3MgZm9yIGZ1bmN0aW9uIG92ZXJsb2FkaW5nICAgIAogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX2FkZHIpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50KQogICAgewogICAgICAgIHJldHVybiBiYWxhbmNlc1tfYWRkcl07CiAgICB9CiAgICAKICAgIC8vIFVzaW5nIGFuIGV4cGxpY2l0IGdldHRlciBhbGxvd3MgZm9yIGZ1bmN0aW9uIG92ZXJsb2FkaW5nICAgIAogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCkKICAgIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KCiAgICAvLyBTZW5kIF92YWx1ZSBhbW91bnQgb2YgdG9rZW5zIHRvIGFkZHJlc3MgX3RvCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KQogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmV0dXJuIHhmZXIobXNnLnNlbmRlciwgX3RvLCBfYW1vdW50KTsKICAgIH0KCiAgICAvLyBTZW5kIF92YWx1ZSBhbW91bnQgb2YgdG9rZW5zIGZyb20gYWRkcmVzcyBfZnJvbSB0byBhZGRyZXNzIF90bwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXF1aXJlKF9hbW91bnQgPD0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0pOwogICAgICAgIAogICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF9hbW91bnQpOwogICAgICAgIHJldHVybiB4ZmVyKF9mcm9tLCBfdG8sIF9hbW91bnQpOwogICAgfQoKICAgIC8vIFByb2Nlc3MgYSB0cmFuc2ZlciBpbnRlcm5hbGx5LgogICAgZnVuY3Rpb24geGZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfYW1vdW50KQogICAgICAgIGludGVybmFsCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXF1aXJlKF9hbW91bnQgPD0gYmFsYW5jZXNbX2Zyb21dKTsKCiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX2Ftb3VudCk7CiAgICAgICAgCiAgICAgICAgLy8gYXZvaWQgd2FzdGluZyBnYXMgb24gMCB0b2tlbiB0cmFuc2ZlcnMKICAgICAgICBpZihfYW1vdW50ID09IDApIHJldHVybiB0cnVlOwogICAgICAgIAogICAgICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX2Ftb3VudCk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSAgID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICAgICAgCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gQXBwcm92ZXMgYSB0aGlyZC1wYXJ0eSBzcGVuZGVyCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX2Ftb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX2Ftb3VudDsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX2Ftb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0KCgoKLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVwKCiMjIENvbmRpdGlvbmFsIEVudHJ5IFRhYmxlCgpGdW5jdGlvbnMgbXVzdCB0aHJvdyBvbiBGIGNvbmRpdGlvbnMKCkNvbmRpdGlvbmFsIEVudHJ5IFRhYmxlIChmdW5jdGlvbnMgbXVzdCB0aHJvdyBvbiBGIGNvbmRpdGlvbnMpCgpyZW5ldHJ5IHByZXZlbnRpb24gb24gYWxsIHB1YmxpYyBtdXRhdGluZyBmdW5jdGlvbnMKUmVlbnRyeSBtdXRleCBzZXQgaW4gbW92ZUZ1bmRzVG9XYWxsZXQoKSwgcmVmdW5kKCkKCnxmdW5jdGlvbiAgICAgICAgICAgICAgICB8PFNUQVJUX0RBVEV8PEVORF9EQVRFIHxmdW5kRmFpbGVkICB8ZnVuZFN1Y2NlZWRlZHxpY29TdWNjZWVkZWQKfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXw6LS0tLS0tLS0tOnw6LS0tLS0tLS06fDotLS0tLS0tLS0tOnw6LS0tLS0tLS0tLS06fDotLS0tLS0tLS06fAp8KCkgICAgICAgICAgICAgICAgICAgICAgfEtZQyAgICAgICAgfFQgICAgICAgICB8RiAgICAgICAgICAgfFQgICAgICAgICAgICB8RiAgICAgICAgICB8CnxhYm9ydCgpICAgICAgICAgICAgICAgICB8VCAgICAgICAgICB8VCAgICAgICAgIHxUICAgICAgICAgICB8VCAgICAgICAgICAgIHxGICAgICAgICAgIHwKfHByb3h5UHVyY2hhc2UoKSAgICAgICAgIHxLWUMgICAgICAgIHxUICAgICAgICAgfEYgICAgICAgICAgIHxUICAgICAgICAgICAgfEYgICAgICAgICAgfAp8YWRkS3ljQWRkcmVzcygpICAgICAgICAgfFQgICAgICAgICAgfFQgICAgICAgICB8RiAgICAgICAgICAgfFQgICAgICAgICAgICB8VCAgICAgICAgICB8CnxmaW5hbGlzZUlDTygpICAgICAgICAgICB8RiAgICAgICAgICB8RiAgICAgICAgIHxGICAgICAgICAgICB8VCAgICAgICAgICAgIHxUICAgICAgICAgIHwKfHJlZnVuZCgpICAgICAgICAgICAgICAgIHxGICAgICAgICAgIHxGICAgICAgICAgfFQgICAgICAgICAgIHxGICAgICAgICAgICAgfEYgICAgICAgICAgfAp8dHJhbnNmZXIoKSAgICAgICAgICAgICAgfEYgICAgICAgICAgfEYgICAgICAgICB8RiAgICAgICAgICAgfEYgICAgICAgICAgICB8VCAgICAgICAgICB8Cnx0cmFuc2ZlckZyb20oKSAgICAgICAgICB8RiAgICAgICAgICB8RiAgICAgICAgIHxGICAgICAgICAgICB8RiAgICAgICAgICAgIHxUICAgICAgICAgIHwKfGFwcHJvdmUoKSAgICAgICAgICAgICAgIHxGICAgICAgICAgIHxGICAgICAgICAgfEYgICAgICAgICAgIHxGICAgICAgICAgICAgfFQgICAgICAgICAgfAp8Y2hhbmdlT3duZXIoKSAgICAgICAgICAgfFQgICAgICAgICAgfFQgICAgICAgICB8VCAgICAgICAgICAgfFQgICAgICAgICAgICB8VCAgICAgICAgICB8CnxhY2NlcHRPd25lcnNoaXAoKSAgICAgICB8VCAgICAgICAgICB8VCAgICAgICAgIHxUICAgICAgICAgICB8VCAgICAgICAgICAgIHxUICAgICAgICAgIHwKfGNoYW5nZVZlcmVkaWN0dW0oKSAgICAgIHxUICAgICAgICAgIHxUICAgICAgICAgfFQgICAgICAgICAgIHxUICAgICAgICAgICAgfFQgICAgICAgICAgfAp8ZGVzdHJveSgpICAgICAgICAgICAgICAgfEYgICAgICAgICAgfEYgICAgICAgICB8IV9fYWJvcnRGdXNlfEYgICAgICAgICAgICB8RiAgICAgICAgICB8Cnx0cmFuc2ZlckFueUVSQzIwVG9rZW5zKCl8VCAgICAgICAgICB8VCAgICAgICAgIHxUICAgICAgICAgICB8VCAgICAgICAgICAgIHxUICAgICAgICAgIHwKClwqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgpjb250cmFjdCBWZW50YW5hVG9rZW5BYnN0cmFjdAp7Ci8vIFRPRE8gY29tbWVudCBldmVudHMKICAgIGV2ZW50IEtZQ0FkZHJlc3MoYWRkcmVzcyBpbmRleGVkIF9hZGRyLCBib29sIGluZGV4ZWQgX2t5Yyk7CiAgICBldmVudCBSZWZ1bmRlZChhZGRyZXNzIGluZGV4ZWQgX2FkZHIsIHVpbnQgaW5kZXhlZCBfdmFsdWUpOwogICAgZXZlbnQgQ2hhbmdlZE93bmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90byk7CiAgICBldmVudCBDaGFuZ2VPd25lclRvKGFkZHJlc3MgaW5kZXhlZCBfdG8pOwogICAgZXZlbnQgRnVuZHNUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgX3dhbGxldCwgdWludCBpbmRleGVkIF92YWx1ZSk7CgogICAgLy8gVGhpcyBmdXNlIGJsb3dzIHVwb24gY2FsbGluZyBhYm9ydCgpIHdoaWNoIGZvcmNlcyBhIGZhaWwgc3RhdGUKICAgIGJvb2wgcHVibGljIF9fYWJvcnRGdXNlID0gdHJ1ZTsKICAgIAogICAgLy8gU2V0IHRvIHRydWUgYWZ0ZXIgdGhlIGZ1bmQgaXMgc3dlcHQgdG8gdGhlIGZ1bmQgd2FsbGV0LCBhbGxvd3MgdG9rZW4KICAgIC8vIHRyYW5zZmVycyBhbmQgcHJldmVudHMgYWJvcnQoKQogICAgYm9vbCBwdWJsaWMgaWNvU3VjY2Vzc2Z1bDsKCiAgICAvLyBUb2tlbiBjb252ZXJzaW9uIGZhY3RvcnMgYXJlIGNhbGN1bGF0ZWQgd2l0aCBkZWNpbWFsIHBsYWNlcyBhdCBwYXJpdHkgd2l0aCBldGhlcgogICAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CgogICAgLy8gQW4gYWRkcmVzcyBhdXRob3Jpc2VkIHRvIHRha2Ugb3duZXJzaGlwCiAgICBhZGRyZXNzIHB1YmxpYyBuZXdPd25lcjsKICAgIAogICAgLy8gVGhlIFZlcmVkaWN0dW0gc21hcnQgY29udHJhY3QgYWRkcmVzcwogICAgYWRkcmVzcyBwdWJsaWMgdmVyZWRpY3R1bTsKICAgIAogICAgLy8gVG90YWwgZXRoZXIgcmFpc2VkIGR1cmluZyBmdW5kaW5nCiAgICB1aW50IHB1YmxpYyBldGhlclJhaXNlZDsKICAgIAogICAgLy8gUHJlYXV0aG9yaXplZCB0cmFuY2ggZGlzY291bnQgYWRkcmVzc2VzCiAgICAvLyBob2xkZXIgPT4gZGlzY291bnQKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIGt5Y0FkZHJlc3NlczsKICAgIAogICAgLy8gUmVjb3JkIG9mIGV0aGVyIHBhaWQgcGVyIGFkZHJlc3MKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgcHVibGljIGV0aGVyQ29udHJpYnV0ZWQ7CgogICAgLy8gUmV0dXJuIGB0cnVlYCBpZiBNSU5fRlVORFMgd2VyZSByYWlzZWQKICAgIGZ1bmN0aW9uIGZ1bmRTdWNjZWVkZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCk7CiAgICAKICAgIC8vIFJldHVybiBgdHJ1ZWAgaWYgTUlOX0ZVTkRTIHdlcmUgbm90IHJhaXNlZCBiZWZvcmUgRU5EX0RBVEUKICAgIGZ1bmN0aW9uIGZ1bmRGYWlsZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCk7CgogICAgLy8gUmV0dXJucyBVU0QgcmFpc2VkIGZvciBzZXQgRVRIL1VTRCByYXRlCiAgICBmdW5jdGlvbiB1c2RSYWlzZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCk7CgogICAgLy8gUmV0dXJucyBhbiBhbW91bnQgaW4gZXRoIGVxdWl2aWxlbnQgdG8gVVNEIGF0IHRoZSBzZXQgcmF0ZQogICAgZnVuY3Rpb24gdXNkVG9FdGgodWludCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludCk7CiAgICAKICAgIC8vIFJldHVybnMgdGhlIFVTRCB2YWx1ZSBvZiBldGhlciBhdCB0aGUgc2V0IFVTRC9FVEggcmF0ZQogICAgZnVuY3Rpb24gZXRoVG9Vc2QodWludCBfd2VpKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCk7CgogICAgLy8gUmV0dXJucyB0b2tlbi9ldGhlciBjb252ZXJzaW9uIGdpdmVuIGV0aGVyIHZhbHVlIGFuZCBhZGRyZXNzLiAKICAgIGZ1bmN0aW9uIGV0aFRvVG9rZW5zKHVpbnQgX2V0aCkKICAgICAgICBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCk7CgogICAgLy8gUHJvY2Vzc2VzIGEgdG9rZW4gcHVyY2hhc2UgZm9yIGEgZ2l2ZW4gYWRkcmVzcwogICAgZnVuY3Rpb24gcHJveHlQdXJjaGFzZShhZGRyZXNzIF9hZGRyKSBwYXlhYmxlIHJldHVybnMgKGJvb2wpOwoKICAgIC8vIE93bmVyIGNhbiBtb3ZlIGZ1bmRzIG9mIHN1Y2Nlc3NmdWwgZnVuZCB0byBmdW5kV2FsbGV0IAogICAgZnVuY3Rpb24gZmluYWxpc2VJQ08oKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICAKICAgIC8vIFJlZ2lzdGVycyBhIGRpc2NvdW50ZWQgYWRkcmVzcwogICAgZnVuY3Rpb24gYWRkS3ljQWRkcmVzcyhhZGRyZXNzIF9hZGRyLCBib29sIF9reWMpCiAgICAgICAgcHVibGljIHJldHVybnMgKGJvb2wpOwoKICAgIC8vIFJlZnVuZCBvbiBmYWlsZWQgb3IgYWJvcnRlZCBzYWxlIAogICAgZnVuY3Rpb24gcmVmdW5kKGFkZHJlc3MgX2FkZHIpIHB1YmxpYyByZXR1cm5zIChib29sKTsKCiAgICAvLyBUbyBjYW5jZWwgdG9rZW4gc2FsZSBwcmlvciB0byBTVEFSVF9EQVRFCiAgICBmdW5jdGlvbiBhYm9ydCgpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIAogICAgLy8gQ2hhbmdlIHRoZSBWZXJlZGljdHVtIGJhY2tlbmQgY29udHJhY3QgYWRkcmVzcwogICAgZnVuY3Rpb24gY2hhbmdlVmVyZWRpY3R1bShhZGRyZXNzIF9hZGRyKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICAKICAgIC8vIEZvciBvd25lciB0byBzYWx2YWdlIHRva2VucyBzZW50IHRvIGNvbnRyYWN0CiAgICBmdW5jdGlvbiB0cmFuc2ZlckFueUVSQzIwVG9rZW4oYWRkcmVzcyB0b2tlbkFkZHJlc3MsIHVpbnQgYW1vdW50KQogICAgICAgIHJldHVybnMgKGJvb2wpOwp9CgoKLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVwKCiBWZW50YW5hIHRva2VuIGltcGxpbWVudGF0aW9uCgpcKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKY29udHJhY3QgVmVudGFuYVRva2VuIGlzIAogICAgUmVlbnRyeVByb3RlY3RlZCwKICAgIEVSQzIwVG9rZW4sCiAgICBWZW50YW5hVG9rZW5BYnN0cmFjdCwKICAgIFZlbnRhbmFUb2tlbkNvbmZpZwp7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKCi8vCi8vIENvbnN0YW50cwovLwoKICAgIC8vIFVTRCB0byBldGhlciBjb252ZXJzaW9uIGZhY3RvcnMgY2FsY3VsYXRlZCBmcm9tIGBWZW50YW5hVG9rZW5Db25maWdgIGNvbnN0YW50cyAKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFRPS0VOU19QRVJfRVRIID0gVE9LRU5TX1BFUl9VU0QgKiBVU0RfUEVSX0VUSDsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IE1JTl9FVEhfRlVORCAgID0gMSBldGhlciAqIE1JTl9VU0RfRlVORCAvIFVTRF9QRVJfRVRIOwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgTUFYX0VUSF9GVU5EICAgPSAxIGV0aGVyICogTUFYX1VTRF9GVU5EIC8gVVNEX1BFUl9FVEg7CiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBLWUNfRVRIX0xNVCAgICA9IDEgZXRoZXIgKiBLWUNfVVNEX0xNVCAgLyBVU0RfUEVSX0VUSDsKCiAgICAvLyBHZW5lcmFsIGZ1bmRpbmcgb3BlbnMgTEVBRF9JTl9QRVJJT0QgYWZ0ZXIgZGVwbG95bWVudCAodGltZXN0YW1wcyBjYW4ndCBiZSBjb25zdGFudCkKICAgIHVpbnQgcHVibGljIEVORF9EQVRFICA9IFNUQVJUX0RBVEUgKyBGVU5ESU5HX1BFUklPRDsKCi8vCi8vIE1vZGlmaWVycwovLwoKICAgIG1vZGlmaWVyIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKLy8KLy8gRnVuY3Rpb25zCi8vCgogICAgLy8gQ29uc3RydWN0b3IKICAgIGZ1bmN0aW9uIFZlbnRhbmFUb2tlbigpCiAgICB7CiAgICAgICAgLy8gSUNPIHBhcmFtZXRlcnMgYXJlIHNldCBpbiBWZW50YW5hVFNDb25maWcKICAgICAgICAvLyBJbnZhbGlkIGNvbmZpZ3VyYXRpb24gY2F0Y2hpbmcgaGVyZQogICAgICAgIHJlcXVpcmUoYnl0ZXMoc3ltYm9sKS5sZW5ndGggPiAwKTsKICAgICAgICByZXF1aXJlKGJ5dGVzKG5hbWUpLmxlbmd0aCA+IDApOwogICAgICAgIHJlcXVpcmUob3duZXIgIT0gMHgwKTsKICAgICAgICByZXF1aXJlKGZ1bmRXYWxsZXQgIT0gMHgwKTsKICAgICAgICByZXF1aXJlKFRPS0VOU19QRVJfVVNEID4gMCk7CiAgICAgICAgcmVxdWlyZShVU0RfUEVSX0VUSCA+IDApOwogICAgICAgIHJlcXVpcmUoTUlOX1VTRF9GVU5EID4gMCk7CiAgICAgICAgcmVxdWlyZShNQVhfVVNEX0ZVTkQgPiBNSU5fVVNEX0ZVTkQpOwogICAgICAgIHJlcXVpcmUoU1RBUlRfREFURSA+IDApOwogICAgICAgIHJlcXVpcmUoRlVORElOR19QRVJJT0QgPiAwKTsKICAgICAgICAKICAgICAgICAvLyBTZXR1cCBhbmQgYWxsb2NhdGUgdG9rZW4gc3VwcGx5IHRvIDE4IGRlY2ltYWwgcGxhY2VzCiAgICAgICAgdG90YWxTdXBwbHkgPSBNQVhfVE9LRU5TICogMWUxODsKICAgICAgICBiYWxhbmNlc1tmdW5kV2FsbGV0XSA9IHRvdGFsU3VwcGx5OwogICAgICAgIFRyYW5zZmVyKDB4MCwgZnVuZFdhbGxldCwgdG90YWxTdXBwbHkpOwogICAgfQogICAgCiAgICAvLyBEZWZhdWx0IGZ1bmN0aW9uCiAgICBmdW5jdGlvbiAoKQogICAgICAgIHBheWFibGUKICAgIHsKICAgICAgICAvLyBQYXNzIHRocm91Z2ggdG8gcHVyY2hhc2luZyBmdW5jdGlvbi4gV2lsbCB0aHJvdyBvbiBmYWlsZWQgb3IKICAgICAgICAvLyBzdWNjZXNzZnVsIElDTwogICAgICAgIHByb3h5UHVyY2hhc2UobXNnLnNlbmRlcik7CiAgICB9CgovLwovLyBHZXR0ZXJzCi8vCgogICAgLy8gSUNPIGZhaWxzIGlmIGFib3J0ZWQgb3IgbWluaW11bSBmdW5kcyBhcmUgbm90IHJhaXNlZCBieSB0aGUgZW5kIGRhdGUKICAgIGZ1bmN0aW9uIGZ1bmRGYWlsZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXR1cm4gIV9fYWJvcnRGdXNlCiAgICAgICAgICAgIHx8IChub3cgPiBFTkRfREFURSAmJiBldGhlclJhaXNlZCA8IE1JTl9FVEhfRlVORCk7CiAgICB9CiAgICAKICAgIC8vIEZ1bmRpbmcgc3VjY2VlZHMgaWYgbm90IGFib3J0ZWQsIG1pbmltdW0gZnVuZHMgYXJlIHJhaXNlZCBiZWZvcmUgZW5kIGRhdGUKICAgIGZ1bmN0aW9uIGZ1bmRTdWNjZWVkZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXR1cm4gIWZ1bmRGYWlsZWQoKQogICAgICAgICAgICAmJiBldGhlclJhaXNlZCA+PSBNSU5fRVRIX0ZVTkQ7CiAgICB9CgogICAgLy8gUmV0dXJucyB0aGUgVVNEIHZhbHVlIG9mIGV0aGVyIGF0IHRoZSBzZXQgVVNEL0VUSCByYXRlCiAgICBmdW5jdGlvbiBldGhUb1VzZCh1aW50IF93ZWkpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KQogICAgewogICAgICAgIHJldHVybiBVU0RfUEVSX0VUSC5tdWwoX3dlaSkuZGl2KDEgZXRoZXIpOwogICAgfQogICAgCiAgICAvLyBSZXR1cm5zIHRoZSBldGhlciB2YWx1ZSBvZiBVU0QgYXQgdGhlIHNldCBVU0QvRVRIIHJhdGUKICAgIGZ1bmN0aW9uIHVzZFRvRXRoKHVpbnQgX3VzZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpCiAgICB7CiAgICAgICAgcmV0dXJuIF91c2QubXVsKDEgZXRoZXIpLmRpdihVU0RfUEVSX0VUSCk7CiAgICB9CiAgICAKICAgIC8vIFJldHVybnMgdGhlIFVTRCB2YWx1ZSBvZiBldGhlciByYWlzZWQgYXQgdGhlIHNldCBVU0QvRVRIIHJhdGUKICAgIGZ1bmN0aW9uIHVzZFJhaXNlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KQogICAgewogICAgICAgIHJldHVybiBldGhUb1VzZChldGhlclJhaXNlZCk7CiAgICB9CiAgICAKICAgIC8vIFJldHVybnMgdGhlIG51bWJlciBvZiB0b2tlbnMgZm9yIGdpdmVuIGFtb3VudCBvZiBldGhlciBmb3IgYW4gYWRkcmVzcyAKICAgIGZ1bmN0aW9uIGV0aFRvVG9rZW5zKHVpbnQgX3dlaSkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpCiAgICB7CiAgICAgICAgdWludCB1c2QgPSBldGhUb1VzZChfd2VpKTsKICAgICAgICAKICAgICAgICAvLyBQZXJjZW50IGJvbnVzIGZ1bmRpbmcgdGllcnMgZm9yIFVTRCBmdW5kaW5nCiAgICAgICAgdWludCBib251cyA9CiAgICAgICAgICAgIHVzZCA+PSAyMDAwMDAwID8gMzUgOgogICAgICAgICAgICB1c2QgPj0gNTAwMDAwICA/IDMwIDoKICAgICAgICAgICAgdXNkID49IDEwMDAwMCAgPyAyMCA6CiAgICAgICAgICAgIHVzZCA+PSAyNTAwMCAgID8gMTUgOgogICAgICAgICAgICB1c2QgPj0gMTAwMDAgICA/IDEwIDoKICAgICAgICAgICAgdXNkID49IDUwMDAgICAgPyA1ICA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMDsgIAogICAgICAgIAogICAgICAgIC8vIHVzaW5nIG4uMiBmaXhlZCBwb2ludCBkZWNpbWFsIGZvciB3aG9sZSBudW1iZXIgcGVyY2VudGFnZS4KICAgICAgICByZXR1cm4gX3dlaS5tdWwoVE9LRU5TX1BFUl9FVEgpLm11bChib251cyArIDEwMCkuZGl2KDEwMCk7CiAgICB9CgovLwovLyBJQ08gZnVuY3Rpb25zCi8vCgogICAgLy8gVGhlIGZ1bmRyYWlzaW5nIGNhbiBiZSBhYm9ydGVkIGFueSB0aW1lIGJlZm9yZSBmdW5kcyBhcmUgc3dlcHQgdG8gdGhlCiAgICAvLyBmdW5kV2FsbGV0LgogICAgLy8gVGhpcyB3aWxsIGZvcmNlIGEgZmFpbCBzdGF0ZSBhbmQgYWxsb3cgcmVmdW5kcyB0byBiZSBjb2xsZWN0ZWQuCiAgICBmdW5jdGlvbiBhYm9ydCgpCiAgICAgICAgcHVibGljCiAgICAgICAgbm9SZWVudHJ5CiAgICAgICAgb25seU93bmVyCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXF1aXJlKCFpY29TdWNjZXNzZnVsKTsKICAgICAgICBkZWxldGUgX19hYm9ydEZ1c2U7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIC8vIEdlbmVyYWwgYWRkcmVzc2VzIGNhbiBwdXJjaGFzZSB0b2tlbnMgZHVyaW5nIGZ1bmRpbmcKICAgIGZ1bmN0aW9uIHByb3h5UHVyY2hhc2UoYWRkcmVzcyBfYWRkcikKICAgICAgICBwYXlhYmxlCiAgICAgICAgbm9SZWVudHJ5CiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXF1aXJlKCFmdW5kRmFpbGVkKCkpOwogICAgICAgIHJlcXVpcmUoIWljb1N1Y2Nlc3NmdWwpOwogICAgICAgIHJlcXVpcmUobm93IDw9IEVORF9EQVRFKTsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+IDApOwogICAgICAgIAogICAgICAgIC8vIE5vbi1LWUMnZWQgZnVuZGVycyBjYW4gb25seSBjb250cmlidXRlIHVwIHRvICQxMDAwMCBhZnRlciBwcmVmdW5kIHBlcmlvZAogICAgICAgIGlmKCFreWNBZGRyZXNzZXNbX2FkZHJdKQogICAgICAgIHsKICAgICAgICAgICAgcmVxdWlyZShub3cgPj0gU1RBUlRfREFURSk7CiAgICAgICAgICAgIHJlcXVpcmUoKGV0aGVyQ29udHJpYnV0ZWRbX2FkZHJdLmFkZChtc2cudmFsdWUpKSA8PSBLWUNfRVRIX0xNVCk7CiAgICAgICAgfQoKICAgICAgICAvLyBHZXQgZXRoZXIgdG8gdG9rZW4gY29udmVyc2lvbgogICAgICAgIHVpbnQgdG9rZW5zID0gZXRoVG9Ub2tlbnMobXNnLnZhbHVlKTsKICAgICAgICAKICAgICAgICAvLyB0cmFuc2ZlciB0b2tlbnMgZnJvbSBmdW5kIHdhbGxldAogICAgICAgIHhmZXIoZnVuZFdhbGxldCwgX2FkZHIsIHRva2Vucyk7CiAgICAgICAgCiAgICAgICAgLy8gVXBkYXRlIGhvbGRlciBwYXltZW50cwogICAgICAgIGV0aGVyQ29udHJpYnV0ZWRbX2FkZHJdID0gZXRoZXJDb250cmlidXRlZFtfYWRkcl0uYWRkKG1zZy52YWx1ZSk7CiAgICAgICAgCiAgICAgICAgLy8gVXBkYXRlIGZ1bmRzIHJhaXNlZAogICAgICAgIGV0aGVyUmFpc2VkID0gZXRoZXJSYWlzZWQuYWRkKG1zZy52YWx1ZSk7CiAgICAgICAgCiAgICAgICAgLy8gQmFpbCBpZiB0aGlzIHB1c2hlcyB0aGUgZnVuZCBvdmVyIHRoZSBVU0QgY2FwIG9yIFRva2VuIGNhcAogICAgICAgIHJlcXVpcmUoZXRoZXJSYWlzZWQgPD0gTUFYX0VUSF9GVU5EKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIC8vIE93bmVyIGNhbiBLWUMgKG9yIHJldm9rZSkgYWRkcmVzc2VzIHVudGlsIGNsb3NlIG9mIGZ1bmRpbmcKICAgIGZ1bmN0aW9uIGFkZEt5Y0FkZHJlc3MoYWRkcmVzcyBfYWRkciwgYm9vbCBfa3ljKQogICAgICAgIHB1YmxpYwogICAgICAgIG5vUmVlbnRyeQogICAgICAgIG9ubHlPd25lcgogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmVxdWlyZSghZnVuZEZhaWxlZCgpKTsKCiAgICAgICAga3ljQWRkcmVzc2VzW19hZGRyXSA9IF9reWM7CiAgICAgICAgS1lDQWRkcmVzcyhfYWRkciwgX2t5Yyk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIC8vIE93bmVyIGNhbiBzd2VlcCBhIHN1Y2Nlc3NmdWwgZnVuZGluZyB0byB0aGUgZnVuZFdhbGxldAogICAgLy8gQ29udHJhY3QgY2FuIGJlIGFib3J0ZWQgdXAgdW50aWwgdGhpcyBhY3Rpb24uCiAgICBmdW5jdGlvbiBmaW5hbGlzZUlDTygpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seU93bmVyCiAgICAgICAgcHJldmVudFJlZW50cnkoKQogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmVxdWlyZShmdW5kU3VjY2VlZGVkKCkpOwoKICAgICAgICBpY29TdWNjZXNzZnVsID0gdHJ1ZTsKCiAgICAgICAgRnVuZHNUcmFuc2ZlcnJlZChmdW5kV2FsbGV0LCB0aGlzLmJhbGFuY2UpOwogICAgICAgIGZ1bmRXYWxsZXQudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIAogICAgLy8gUmVmdW5kcyBjYW4gYmUgY2xhaW1lZCBmcm9tIGEgZmFpbGVkIElDTwogICAgZnVuY3Rpb24gcmVmdW5kKGFkZHJlc3MgX2FkZHIpCiAgICAgICAgcHVibGljCiAgICAgICAgcHJldmVudFJlZW50cnkoKQogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmVxdWlyZShmdW5kRmFpbGVkKCkpOwogICAgICAgIAogICAgICAgIHVpbnQgdmFsdWUgPSBldGhlckNvbnRyaWJ1dGVkW19hZGRyXTsKCiAgICAgICAgLy8gVHJhbnNmZXIgdG9rZW5zIGJhY2sgdG8gb3JpZ2luCiAgICAgICAgLy8gKE5vdCByZWFsbHkgbmVjZXNzYXJ5IGJ1dCBsb29raW5nIGZvciBncmFjZWZ1bCBleGl0KQogICAgICAgIHhmZXIoX2FkZHIsIGZ1bmRXYWxsZXQsIGJhbGFuY2VzW19hZGRyXSk7CgogICAgICAgIC8vIGdhcmJhZ2UgY29sbGVjdAogICAgICAgIGRlbGV0ZSBldGhlckNvbnRyaWJ1dGVkW19hZGRyXTsKICAgICAgICBkZWxldGUga3ljQWRkcmVzc2VzW19hZGRyXTsKICAgICAgICAKICAgICAgICBSZWZ1bmRlZChfYWRkciwgdmFsdWUpOwogICAgICAgIGlmICh2YWx1ZSA+IDApIHsKICAgICAgICAgICAgX2FkZHIudHJhbnNmZXIodmFsdWUpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCi8vCi8vIEVSQzIwIG92ZXJsb2FkZWQgZnVuY3Rpb25zCi8vCgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX2Ftb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICBwcmV2ZW50UmVlbnRyeQogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgLy8gSUNPIG11c3QgYmUgc3VjY2Vzc2Z1bAogICAgICAgIHJlcXVpcmUoaWNvU3VjY2Vzc2Z1bCk7CiAgICAgICAgc3VwZXIudHJhbnNmZXIoX3RvLCBfYW1vdW50KTsKCiAgICAgICAgaWYgKF90byA9PSB2ZXJlZGljdHVtKQogICAgICAgICAgICAvLyBOb3RpZnkgdGhlIFZlcmVkaWN0dW0gY29udHJhY3QgaXQgaGFzIGJlZW4gc2VudCB0b2tlbnMKICAgICAgICAgICAgcmVxdWlyZShOb3RpZnkodmVyZWRpY3R1bSkubm90aWZ5KG1zZy5zZW5kZXIsIF9hbW91bnQpKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX2Ftb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICBwcmV2ZW50UmVlbnRyeQogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgLy8gSUNPIG11c3QgYmUgc3VjY2Vzc2Z1bAogICAgICAgIHJlcXVpcmUoaWNvU3VjY2Vzc2Z1bCk7CiAgICAgICAgc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF9hbW91bnQpOwoKICAgICAgICBpZiAoX3RvID09IHZlcmVkaWN0dW0pCiAgICAgICAgICAgIC8vIE5vdGlmeSB0aGUgVmVyZWRpY3R1bSBjb250cmFjdCBpdCBoYXMgYmVlbiBzZW50IHRva2VucwogICAgICAgICAgICByZXF1aXJlKE5vdGlmeSh2ZXJlZGljdHVtKS5ub3RpZnkobXNnLnNlbmRlciwgX2Ftb3VudCkpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2Ftb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICBub1JlZW50cnkKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIC8vIElDTyBtdXN0IGJlIHN1Y2Nlc3NmdWwKICAgICAgICByZXF1aXJlKGljb1N1Y2Nlc3NmdWwpOwogICAgICAgIHN1cGVyLmFwcHJvdmUoX3NwZW5kZXIsIF9hbW91bnQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKLy8KLy8gQ29udHJhY3QgbWFuYWdtZW50IGZ1bmN0aW9ucwovLwoKICAgIC8vIFRvIGluaXRpYXRlIGFuIG93bmVyc2hpcCBjaGFuZ2UKICAgIGZ1bmN0aW9uIGNoYW5nZU93bmVyKGFkZHJlc3MgX25ld093bmVyKQogICAgICAgIHB1YmxpYwogICAgICAgIG5vUmVlbnRyeQogICAgICAgIG9ubHlPd25lcgogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgQ2hhbmdlT3duZXJUbyhfbmV3T3duZXIpOwogICAgICAgIG5ld093bmVyID0gX25ld093bmVyOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vIFRvIGFjY2VwdCBvd25lcnNoaXAuIFJlcXVpcmVkIHRvIHByb3ZlIG5ldyBhZGRyZXNzIGNhbiBjYWxsIHRoZSBjb250cmFjdC4KICAgIGZ1bmN0aW9uIGFjY2VwdE93bmVyc2hpcCgpCiAgICAgICAgcHVibGljCiAgICAgICAgbm9SZWVudHJ5CiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gbmV3T3duZXIpOwogICAgICAgIENoYW5nZWRPd25lcihvd25lciwgbmV3T3duZXIpOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gQ2hhbmdlIHRoZSBhZGRyZXNzIG9mIHRoZSBWZXJlZGljdHVtIGNvbnRyYWN0IGFkZHJlc3MuIFRoZSBjb250cmFjdAogICAgLy8gbXVzdCBpbXBsaW1lbnQgdGhlIGBOb3RpZnlgIGludGVyZmFjZS4KICAgIGZ1bmN0aW9uIGNoYW5nZVZlcmVkaWN0dW0oYWRkcmVzcyBfYWRkcikKICAgICAgICBwdWJsaWMKICAgICAgICBub1JlZW50cnkKICAgICAgICBvbmx5T3duZXIKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHZlcmVkaWN0dW0gPSBfYWRkcjsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIAogICAgLy8gVGhlIGNvbnRyYWN0IGNhbiBiZSBzZWxmZGVzdHJ1Y3RlZCBhZnRlciBhYm9ydCBhbmQgZXRoZXIgYmFsYW5jZSBpcyAwLgogICAgZnVuY3Rpb24gZGVzdHJveSgpCiAgICAgICAgcHVibGljCiAgICAgICAgbm9SZWVudHJ5CiAgICAgICAgb25seU93bmVyCiAgICB7CiAgICAgICAgcmVxdWlyZSghX19hYm9ydEZ1c2UpOwogICAgICAgIHJlcXVpcmUodGhpcy5iYWxhbmNlID09IDApOwogICAgICAgIHNlbGZkZXN0cnVjdChvd25lcik7CiAgICB9CiAgICAKICAgIC8vIE93bmVyIGNhbiBzYWx2YWdlIEVSQzIwIHRva2VucyB0aGF0IG1heSBoYXZlIGJlZW4gc2VudCB0byB0aGUgYWNjb3VudAogICAgZnVuY3Rpb24gdHJhbnNmZXJBbnlFUkMyMFRva2VuKGFkZHJlc3MgdG9rZW5BZGRyZXNzLCB1aW50IGFtb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5T3duZXIKICAgICAgICBwcmV2ZW50UmVlbnRyeQogICAgICAgIHJldHVybnMgKGJvb2wpIAogICAgewogICAgICAgIHJlcXVpcmUoRVJDMjBUb2tlbih0b2tlbkFkZHJlc3MpLnRyYW5zZmVyKG93bmVyLCBhbW91bnQpKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQoKCmludGVyZmFjZSBOb3RpZnkKewogICAgZXZlbnQgTm90aWZpZWQoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCB1aW50IGluZGV4ZWQgX2Ftb3VudCk7CiAgICAKICAgIGZ1bmN0aW9uIG5vdGlmeShhZGRyZXNzIF9mcm9tLCB1aW50IF9hbW91bnQpIHB1YmxpYyByZXR1cm5zIChib29sKTsKfQoKCmNvbnRyYWN0IFZlcmVkaWN0dW1UZXN0IGlzIE5vdGlmeQp7CiAgICBhZGRyZXNzIHB1YmxpYyB2bnQ7CiAgICAKICAgIGZ1bmN0aW9uIHNldFZudChhZGRyZXNzIF9hZGRyKSB7IHZudCA9IF9hZGRyOyB9CiAgICAKICAgIGZ1bmN0aW9uIG5vdGlmeShhZGRyZXNzIF9mcm9tLCB1aW50IF9hbW91bnQpIHB1YmxpYyByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSB2bnQpOwogICAgICAgIE5vdGlmaWVkKF9mcm9tLCBfYW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQ=='.
	

]
