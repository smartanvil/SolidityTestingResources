Class {
	#name : #SRT3a92b0fa21043e14a021821ba9371a8ed01ec5dc,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT3a92b0fa21043e14a021821ba9371a8ed01ec5dc >> base64 [
	^ 'LyoKICBDb3B5cmlnaHQgMjAxNyBTaGFyZGVyIEZvdW5kYXRpb24uCgogIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCiAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgogIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKi8KcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKioKICogTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcwogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgICBmdW5jdGlvbiBtdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCkgewogICAgICAgIHVpbnQgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gZGl2KHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQpIHsKICAgICAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgICAgICB1aW50IGMgPSBhIC8gYjsKICAgICAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIHN1Yih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50KSB7CiAgICAgICAgYXNzZXJ0KGIgPD0gYSk7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50KSB7CiAgICAgICAgdWludCBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSk7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gbWF4NjQodWludDY0IGEsIHVpbnQ2NCBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQ2NCkgewogICAgICAgIHJldHVybiBhID49IGIgPyBhIDogYjsKICAgIH0KCiAgICBmdW5jdGlvbiBtaW42NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDY0KSB7CiAgICAgICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7CiAgICB9CgogICAgZnVuY3Rpb24gbWF4MjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7CiAgICB9CgogICAgZnVuY3Rpb24gbWluMjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsKICAgIH0KfQoKLyoqCiogQHRpdGxlIFNoYXJkZXIgUHJvdG9jb2wgVG9rZW4uCiogRm9yIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhpcyB0b2tlbiBzYWxlLCBwbGVhc2UgdmlzaXQgaHR0cHM6Ly9zaGFyZGVyLm9yZwoqIEBhdXRob3IgQmVuIC0gPDxhIGhyZWY9Ii9jZG4tY2dpL2wvZW1haWwtcHJvdGVjdGlvbiIgY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSI4MmZhZmJjMmYxZWFlM2YwZTZlN2YwYWNlZGYwZTUiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+Pi4KKiBAZGV2IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAoqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKKi8KY29udHJhY3QgU2hhcmRlclRva2VuIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBOQU1FID0gIlNoYXJkZXIgU3RvcmFnZSI7CiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IFNZTUJPTCA9ICJTUyI7CiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBERUNJTUFMUyA9IDE4OwogICAgdWludCBwdWJsaWMgdG90YWxTdXBwbHk7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSAgcHVibGljIGFsbG93ZWQ7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBiYWxhbmNlczsKCiAgICAvLy8gVGhpcyBpcyB3aGVyZSB3ZSBob2xkIGV0aGVyIGR1cmluZyB0aGlzIGNyb3dkc2FsZS4gV2Ugd2lsbCBub3QgdHJhbnNmZXIgYW55IGV0aGVyCiAgICAvLy8gb3V0IG9mIHRoaXMgYWRkcmVzcyBiZWZvcmUgd2UgaW52b2NhdGUgdGhlIGBjbG9zZUNyb3dkc2FsZWAgZnVuY3Rpb24gdG8gZmluYWxpemUgdGhlIGNyb3dkc2FsZS4KICAgIC8vLyBUaGlzIHByb21pc2UgaXMgbm90IGd1YW5yYW50ZWVkIGJ5IHNtYXJ0IGNvbnRyYWN0IGJ5IGNhbiBiZSB2ZXJpZmllZCB3aXRoIHB1YmxpYwogICAgLy8vIEV0aGVyZXVtIHRyYW5zYWN0aW9ucyBkYXRhIGF2YWlsYWJsZSBvbiBzZXZlcmFsIGJsb2NrY2hhaW4gYnJvd3NlcnMuCiAgICAvLy8gVGhpcyBpcyB0aGUgb25seSBhZGRyZXNzIGZyb20gd2hpY2ggYHN0YXJ0Q3Jvd2RzYWxlYCBhbmQgYGNsb3NlQ3Jvd2RzYWxlYCBjYW4gYmUgaW52b2NhdGVkLgogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgogICAgLy8vIEFkbWluIGFjY291bnQgdXNlZCB0byBtYW5hZ2UgYWZ0ZXIgY3Jvd2RzYWxlCiAgICBhZGRyZXNzIHB1YmxpYyBhZG1pbjsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBhY2NvdW50TG9ja3VwOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgYWNjb3VudExvY2t1cFRpbWU7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBmcm96ZW5BY2NvdW50czsKCiAgICAvLy8gICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rCiAgICAvLy8gICB8ICAgICAgICAgICAgICAgICAgICAgICAgU1MgVG9rZW4gSXNzdWUgUGxhbiAtIEZpcnN0IFJvdW5kICAgICAgICAgICAgICAgICAgICAgICAgICB8CiAgICAvLy8gICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rCiAgICAvLy8gICB8ICBUb3RhbCBTYWxlICB8ICAgQWlyZHJvcCAgICB8ICBDb21tdW5pdHkgUmVzZXJ2ZSAgfCAgVGVhbSBSZXNlcnZlIHwgU3lzdGVtIFJld2FyZCB8CiAgICAvLy8gICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rCiAgICAvLy8gICB8ICAgICA1MCUgICAgICB8ICAgICAxMCUgICAgICB8ICAgICAgICAgMTAlICAgICAgICAgfCAgRG9uJ3QgSXNzdWVkIHwgRG9uJ3QgSXNzdWVkICB8CiAgICAvLy8gICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rCiAgICAvLy8gICB8IDI1MCwwMDAsMDAwICB8ICA1MCwwMDAsMDAwICB8ICAgICA1MCwwMDAsMDAwICAgICAgfCAgICAgIE5vbmUgICAgIHwgICAgICBOb25lICAgICB8CiAgICAvLy8gICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rCiAgICB1aW50MjU2IGludGVybmFsIGNvbnN0YW50IEZJUlNUX1JPVU5EX0lTU1VFRF9TUyA9IDM1MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDsKCiAgICAvLy8gTWF4aW11bSBhbW91bnQgb2YgZnVuZCB0byBiZSByYWlzZWQsIHRoZSBzYWxlIGVuZHMgb24gcmVhY2hpbmcgdGhpcyBhbW91bnQuCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBIQVJEX0NBUCA9IDE1MDAgZXRoZXI7CgogICAgLy8vIEl0IHdpbGwgYmUgcmVmdW5lZCBpZiBjcm93ZHNhbGUgY2FuJ3QgYWNoZWl2ZSB0aGUgc29mdCBjYXAsIGFsbCBldGhlcnMgd2lsbCBiZSByZWZ1bmVkLgogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgU09GVF9DQVAgPSAxMDAwIGV0aGVyOwoKICAgIC8vLyAxIGV0aGVyIGV4Y2hhbmdlIHJhdGUKICAgIC8vLyBiYXNlIHRoZSA3LWRheSBhdmVyYWdlIGNsb3NlIHByaWNlIChGZWIuMTUgdGhyb3VnaCBGZWIuMjEsIDIwMTgpIG9uIENvaW5NYXJrZXRDYXAuY29tIGF0IEZlYi4yMS4KICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IEJBU0VfUkFURSA9IDIwNzE5OwoKICAgIC8vLyAxIGV0aGVyID09IDEwMDAgZmlubmV5CiAgICAvLy8gTWluIGNvbnRyaWJ1dGlvbjogMC4xIGV0aGVyCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBDT05UUklCVVRJT05fTUlOID0gMTAwIGZpbm5leTsKCiAgICAvLy8gTWF4IGNvbnRyaWJ1dGlvbjogNSBldGhlcgogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgQ09OVFJJQlVUSU9OX01BWCA9IDUwMDAgZmlubmV5OwoKICAgIC8vLyBTb2xkIFNTIHRva2VucyBpbiBjcm93ZHNhbGUKICAgIHVpbnQyNTYgcHVibGljIHNvbGRTUyA9IDA7CgogICAgdWludDhbMl0gaW50ZXJuYWwgYm9udXNQZXJjZW50YWdlcyA9IFsKICAgIDAsCiAgICAwCiAgICBdOwoKICAgIHVpbnQyNTYgaW50ZXJuYWwgY29uc3RhbnQgTUFYX1BST01PVElPTl9TUyA9IDA7CiAgICB1aW50IGludGVybmFsIGNvbnN0YW50IE5VTV9PRl9QSEFTRSA9IDI7CiAgICAvLy8gRWFjaCBwaGFzZSBjb250YWlucyBleGFjdGx5IDc4Nzc2IEV0aGVyZXVtIGJsb2Nrcywgd2hpY2ggaXMgcm91Z2hseSAxNSBkYXlzLAogICAgLy8vIFNlZSBodHRwczovL3d3dy5ldGhlcmV1bS5vcmcvY3Jvd2RzYWxlI3NjaGVkdWxpbmctYS1jYWxsCiAgICB1aW50IGludGVybmFsIGNvbnN0YW50IEJMT0NLU19QRVJfUEhBU0UgPSA3ODc3NjsKCiAgICAvLy8gQ3Jvd2RzYWxlIHN0YXJ0IGJsb2NrIG51bWJlci4KICAgIHVpbnQgcHVibGljIHNhbGVTdGFydEF0QmxvY2sgPSAwOwoKICAgIC8vLyBDcm93ZHNhbGUgZW5kZWQgYmxvY2sgbnVtYmVyLgogICAgdWludCBwdWJsaWMgc2FsZUVuZEF0QmxvY2sgPSAwOwoKICAgIC8vLyBVbnNvbGQgc3MgdG9rZW4gd2hldGhlciBpc3NzdWVkLgogICAgYm9vbCBpbnRlcm5hbCB1bnNvbGRUb2tlbklzc3VlZCA9IGZhbHNlOwoKICAgIC8vLyBHb2FsIHdoZXRoZXIgYWNoaWV2ZWQKICAgIGJvb2wgaW50ZXJuYWwgaXNHb2FsQWNoaWV2ZWQgPSBmYWxzZTsKCiAgICAvLy8gUmVjZWl2ZWQgZXRoZXIKICAgIHVpbnQyNTYgaW50ZXJuYWwgdG90YWxFdGhSZWNlaXZlZCA9IDA7CgogICAgLy8vIElzc3VlIGV2ZW50IGluZGV4IHN0YXJ0aW5nIGZyb20gMC4KICAgIHVpbnQyNTYgaW50ZXJuYWwgaXNzdWVJbmRleCA9IDA7CgogICAgLyoKICAgICAqIEVWRU5UUwogICAgICovCiAgICAvLy8gRW1pdHRlZCBvbmx5IG9uY2UgYWZ0ZXIgdG9rZW4gc2FsZSBzdGFydHMuCiAgICBldmVudCBTYWxlU3RhcnRlZCgpOwoKICAgIC8vLyBFbWl0dGVkIG9ubHkgb25jZSBhZnRlciB0b2tlbiBzYWxlIGVuZGVkIChhbGwgdG9rZW4gaXNzdWVkKS4KICAgIGV2ZW50IFNhbGVFbmRlZCgpOwoKICAgIC8vLyBFbWl0dGVkIHdoZW4gYSBmdW5jdGlvbiBpcyBpbnZvY2F0ZWQgYnkgdW5hdXRob3JpemVkIGFkZHJlc3Nlcy4KICAgIGV2ZW50IEludmFsaWRDYWxsZXIoYWRkcmVzcyBjYWxsZXIpOwoKICAgIC8vLyBFbWl0dGVkIHdoZW4gYSBmdW5jdGlvbiBpcyBpbnZvY2F0ZWQgd2l0aG91dCB0aGUgc3BlY2lmaWVkIHByZWNvbmRpdGlvbnMuCiAgICAvLy8gVGhpcyBldmVudCB3aWxsIG5vdCBjb21lIGFsb25lIHdpdGggYW4gZXhjZXB0aW9uLgogICAgZXZlbnQgSW52YWxpZFN0YXRlKGJ5dGVzIG1zZyk7CgogICAgLy8vIEVtaXR0ZWQgZm9yIGVhY2ggc3VjdWVzc2Z1bCB0b2tlbiBwdXJjaGFzZS4KICAgIGV2ZW50IElzc3VlKHVpbnQgaXNzdWVJbmRleCwgYWRkcmVzcyBhZGRyLCB1aW50IGV0aEFtb3VudCwgdWludCB0b2tlbkFtb3VudCk7CgogICAgLy8vIEVtaXR0ZWQgaWYgdGhlIHRva2VuIHNhbGUgc3VjY2VlZGVkLgogICAgZXZlbnQgU2FsZVN1Y2NlZWRlZCgpOwoKICAgIC8vLyBFbWl0dGVkIGlmIHRoZSB0b2tlbiBzYWxlIGZhaWxlZC4KICAgIC8vLyBXaGVuIHRva2VuIHNhbGUgZmFpbGVkLCBhbGwgRXRoZXIgd2lsbCBiZSByZXR1cm4gdG8gdGhlIG9yaWdpbmFsIHB1cmNoYXNpbmcKICAgIC8vLyBhZGRyZXNzIHdpdGggYSBtaW5vciBkZWR1Y3Rpb24gb2YgdHJhbnNhY3Rpb24gZmVl77yIZ2FzKQogICAgZXZlbnQgU2FsZUZhaWxlZCgpOwoKICAgIC8vIFRoaXMgbm90aWZpZXMgY2xpZW50cyBhYm91dCB0aGUgYW1vdW50IHRvIHRyYW5zZmVyCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKCiAgICAvLyBUaGlzIG5vdGlmaWVzIGNsaWVudHMgYWJvdXQgdGhlIGFtb3VudCB0byBhcHByb3ZlCiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50IHZhbHVlKTsKCiAgICAvLyBUaGlzIG5vdGlmaWVzIGNsaWVudHMgYWJvdXQgdGhlIGFtb3VudCBidXJudAogICAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgdWludDI1NiB2YWx1ZSk7CgogICAgLyoqCiAgICAgKiBJbnRlcm5hbCB0cmFuc2Zlciwgb25seSBjYW4gYmUgY2FsbGVkIGJ5IHRoaXMgY29udHJhY3QKICAgICAqLwogICAgZnVuY3Rpb24gX3RyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgaW50ZXJuYWwgaXNOb3RGcm96ZW4gewogICAgICAgIC8vIFByZXZlbnQgdHJhbnNmZXIgdG8gMHgwIGFkZHJlc3MuIFVzZSBidXJuKCkgaW5zdGVhZAogICAgICAgIHJlcXVpcmUoX3RvICE9IDB4MCk7CiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHNlbmRlciBoYXMgZW5vdWdoCiAgICAgICAgcmVxdWlyZShiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlKTsKICAgICAgICAvLyBDaGVjayBmb3Igb3ZlcmZsb3dzCiAgICAgICAgcmVxdWlyZShiYWxhbmNlc1tfdG9dICsgX3ZhbHVlID4gYmFsYW5jZXNbX3RvXSk7CiAgICAgICAgLy8gU2F2ZSB0aGlzIGZvciBhbiBhc3NlcnRpb24gaW4gdGhlIGZ1dHVyZQogICAgICAgIHVpbnQgcHJldmlvdXNCYWxhbmNlcyA9IGJhbGFuY2VzW19mcm9tXSArIGJhbGFuY2VzW190b107CiAgICAgICAgLy8gU3VidHJhY3QgZnJvbSB0aGUgc2VuZGVyCiAgICAgICAgYmFsYW5jZXNbX2Zyb21dIC09IF92YWx1ZTsKICAgICAgICAvLyBBZGQgdGhlIHNhbWUgdG8gdGhlIHJlY2lwaWVudAogICAgICAgIGJhbGFuY2VzW190b10gKz0gX3ZhbHVlOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgLy8gQXNzZXJ0cyBhcmUgdXNlZCB0byB1c2Ugc3RhdGljIGFuYWx5c2lzIHRvIGZpbmQgYnVncyBpbiB5b3VyIGNvZGUuIFRoZXkgc2hvdWxkIG5ldmVyIGZhaWwKICAgICAgICBhc3NlcnQoYmFsYW5jZXNbX2Zyb21dICsgYmFsYW5jZXNbX3RvXSA9PSBwcmV2aW91c0JhbGFuY2VzKTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICAgKiBAcGFyYW0gX3RyYW5zZmVyVG9rZW5zV2l0aERlY2ltYWwgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdHJhbnNmZXJUb2tlbnNXaXRoRGVjaW1hbCkgcHVibGljIHsKICAgICAgICBfdHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdHJhbnNmZXJUb2tlbnNXaXRoRGVjaW1hbCk7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAgKiBAcGFyYW0gX3RyYW5zZmVyVG9rZW5zV2l0aERlY2ltYWwgdWludCB0aGUgYW1vdXQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVyZWQKICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3RyYW5zZmVyVG9rZW5zV2l0aERlY2ltYWwpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXF1aXJlKF90cmFuc2ZlclRva2Vuc1dpdGhEZWNpbWFsIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsgICAgIC8vIENoZWNrIGFsbG93YW5jZQogICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdIC09IF90cmFuc2ZlclRva2Vuc1dpdGhEZWNpbWFsOwogICAgICAgIF90cmFuc2ZlcihfZnJvbSwgX3RvLCBfdHJhbnNmZXJUb2tlbnNXaXRoRGVjaW1hbCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICAgKiBAcmV0dXJuIEFuIHVpbnQgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICAgKi8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQgYmFsYW5jZSkgewogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IGFsbG93YW5jZSBmb3Igb3RoZXIgYWRkcmVzcwogICAgICogQWxsb3dzIGBfc3BlbmRlcmAgdG8gc3BlbmQgbm8gbW9yZSB0aGFuIGBfYXBwcm92ZVRva2Vuc1dpdGhEZWNpbWFsYCB0b2tlbnMgaW4geW91ciBiZWhhbGYKICAgICAqCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3MgYXV0aG9yaXplZCB0byBzcGVuZAogICAgICogQHBhcmFtIF9hcHByb3ZlVG9rZW5zV2l0aERlY2ltYWwgdGhlIG1heCBhbW91bnQgdGhleSBjYW4gc3BlbmQKICAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF9hcHByb3ZlVG9rZW5zV2l0aERlY2ltYWwpIHB1YmxpYyBpc05vdEZyb3plbiByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF9hcHByb3ZlVG9rZW5zV2l0aERlY2ltYWw7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF9hcHByb3ZlVG9rZW5zV2l0aERlY2ltYWwpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGFuIGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcmV0dXJuIEEgdWludCBzcGVjaWZpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludCByZW1haW5pbmcpIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KCiAgICAvKioKICAgICAgICogRGVzdHJveSB0b2tlbnMKICAgICAgICogUmVtb3ZlIGBfdmFsdWVgIHRva2VucyBmcm9tIHRoZSBzeXN0ZW0gaXJyZXZlcnNpYmx5CiAgICAgICAqCiAgICAgICAqIEBwYXJhbSBfYnVybmVkVG9rZW5zV2l0aERlY2ltYWwgdGhlIGFtb3VudCBvZiByZXNlcnZlIHRva2Vucy4gISFJTVBPUlRBTlQgaXMgMTggREVDSU1BTFMKICAgICAgICovCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX2J1cm5lZFRva2Vuc1dpdGhEZWNpbWFsKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmVxdWlyZShiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfYnVybmVkVG9rZW5zV2l0aERlY2ltYWwpOyAgIC8vLyBDaGVjayBpZiB0aGUgc2VuZGVyIGhhcyBlbm91Z2gKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSBfYnVybmVkVG9rZW5zV2l0aERlY2ltYWw7ICAgICAgICAgICAgLy8vIFN1YnRyYWN0IGZyb20gdGhlIHNlbmRlcgogICAgICAgIHRvdGFsU3VwcGx5IC09IF9idXJuZWRUb2tlbnNXaXRoRGVjaW1hbDsgICAgICAgICAgICAgICAgICAgICAgLy8vIFVwZGF0ZXMgdG90YWxTdXBwbHkKICAgICAgICBCdXJuKG1zZy5zZW5kZXIsIF9idXJuZWRUb2tlbnNXaXRoRGVjaW1hbCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBEZXN0cm95IHRva2VucyBmcm9tIG90aGVyIGFjY291bnQKICAgICAqIFJlbW92ZSBgX3ZhbHVlYCB0b2tlbnMgZnJvbSB0aGUgc3lzdGVtIGlycmV2ZXJzaWJseSBvbiBiZWhhbGYgb2YgYF9mcm9tYC4KICAgICAqCiAgICAgKiBAcGFyYW0gX2Zyb20gdGhlIGFkZHJlc3Mgb2YgdGhlIHNlbmRlcgogICAgICogQHBhcmFtIF9idXJuZWRUb2tlbnNXaXRoRGVjaW1hbCB0aGUgYW1vdW50IG9mIHJlc2VydmUgdG9rZW5zLiAhIUlNUE9SVEFOVCBpcyAxOCBERUNJTUFMUwogICAgICovCiAgICBmdW5jdGlvbiBidXJuRnJvbShhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF9idXJuZWRUb2tlbnNXaXRoRGVjaW1hbCkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbX2Zyb21dID49IF9idXJuZWRUb2tlbnNXaXRoRGVjaW1hbCk7ICAgICAgICAgICAgICAgIC8vLyBDaGVjayBpZiB0aGUgdGFyZ2V0ZWQgYmFsYW5jZSBpcyBlbm91Z2gKICAgICAgICByZXF1aXJlKF9idXJuZWRUb2tlbnNXaXRoRGVjaW1hbCA8PSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSk7ICAgIC8vLyBDaGVjayBhbGxvd2FuY2UKICAgICAgICBiYWxhbmNlc1tfZnJvbV0gLT0gX2J1cm5lZFRva2Vuc1dpdGhEZWNpbWFsOyAgICAgICAgICAgICAgICAgICAgICAgIC8vLyBTdWJ0cmFjdCBmcm9tIHRoZSB0YXJnZXRlZCBiYWxhbmNlCiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gLT0gX2J1cm5lZFRva2Vuc1dpdGhEZWNpbWFsOyAgICAgICAgICAgICAvLy8gU3VidHJhY3QgZnJvbSB0aGUgc2VuZGVyJ3MgYWxsb3dhbmNlCiAgICAgICAgdG90YWxTdXBwbHkgLT0gX2J1cm5lZFRva2Vuc1dpdGhEZWNpbWFsOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLy8gVXBkYXRlIHRvdGFsU3VwcGx5CiAgICAgICAgQnVybihfZnJvbSwgX2J1cm5lZFRva2Vuc1dpdGhEZWNpbWFsKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKgogICAgICogTU9ESUZJRVJTCiAgICAgKi8KICAgIG1vZGlmaWVyIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlBZG1pbiB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyIHx8IG1zZy5zZW5kZXIgPT0gYWRtaW4pOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgYmVmb3JlU3RhcnQgewogICAgICAgIHJlcXVpcmUoIXNhbGVTdGFydGVkKCkpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgaW5Qcm9ncmVzcyB7CiAgICAgICAgcmVxdWlyZShzYWxlU3RhcnRlZCgpICYmICFzYWxlRW5kZWQoKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBhZnRlckVuZCB7CiAgICAgICAgcmVxdWlyZShzYWxlRW5kZWQoKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBpc05vdEZyb3plbiB7CiAgICAgICAgcmVxdWlyZSggZnJvemVuQWNjb3VudHNbbXNnLnNlbmRlcl0gIT0gdHJ1ZSAmJiBub3cgPiBhY2NvdW50TG9ja3VwVGltZVttc2cuc2VuZGVyXSApOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBDT05TVFJVQ1RPUgogICAgICoKICAgICAqIEBkZXYgSW5pdGlhbGl6ZSB0aGUgU2hhcmRlciBUb2tlbgogICAgICovCiAgICBmdW5jdGlvbiBTaGFyZGVyVG9rZW4oKSBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgICAgICBhZG1pbiA9IG1zZy5zZW5kZXI7CiAgICAgICAgdG90YWxTdXBwbHkgPSBGSVJTVF9ST1VORF9JU1NVRURfU1M7CiAgICB9CgogICAgLyoKICAgICAqIFBVQkxJQyBGVU5DVElPTlMKICAgICAqLwoKICAgIC8vL0BkZXYgU2V0IGFkbWluIGFjY291bnQuCiAgICBmdW5jdGlvbiBzZXRBZG1pbihhZGRyZXNzIF9hZGRyZXNzKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgIGFkbWluPV9hZGRyZXNzOwogICAgfQoKICAgIC8vL0BkZXYgU2V0IGZyb3plbiBzdGF0dXMgb2YgYWNjb3VudC4KICAgIGZ1bmN0aW9uIHNldEFjY291bnRGcm96ZW5TdGF0dXMoYWRkcmVzcyBfYWRkcmVzcywgYm9vbCBfZnJvemVuU3RhdHVzKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICByZXF1aXJlKHVuc29sZFRva2VuSXNzdWVkKTsKICAgICAgICBmcm96ZW5BY2NvdW50c1tfYWRkcmVzc10gPSBfZnJvemVuU3RhdHVzOwogICAgfQoKICAgIC8vLyBAZGV2IExvY2t1cCBhY2NvdW50IHRpbGwgdGhlIGRhdGUuIENhbid0IGxvY2t1cCBhZ2FpbiB3aGVuIHRoaXMgYWNjb3VudCBsb2NrZWQgYWxyZWFkeS4KICAgIC8vLyAxIHllYXIgPSAzMTUzNjAwMCBzZWNvbmRzCiAgICAvLy8gMC41IHllYXIgPSAxNTc2ODAwMCBzZWNvbmRzCiAgICBmdW5jdGlvbiBsb2NrdXBBY2NvdW50KGFkZHJlc3MgX2FkZHJlc3MsIHVpbnQgX2xvY2t1cFNlY29uZHMpIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIHJlcXVpcmUoKGFjY291bnRMb2NrdXBbX2FkZHJlc3NdICYmIG5vdyA+IGFjY291bnRMb2NrdXBUaW1lW19hZGRyZXNzXSkgfHwgIWFjY291bnRMb2NrdXBbX2FkZHJlc3NdKTsKCiAgICAgICAgLy8gZnJvemVuIHRpbWUgPSBub3cgKyBfbG9ja3VwU2Vjb25kcwogICAgICAgIGFjY291bnRMb2NrdXBUaW1lW19hZGRyZXNzXSA9IG5vdyArIF9sb2NrdXBTZWNvbmRzOwogICAgICAgIGFjY291bnRMb2NrdXBbX2FkZHJlc3NdID0gdHJ1ZTsKICAgIH0KCiAgICAvLy8gQGRldiBTdGFydCB0aGUgY3Jvd2RzYWxlLgogICAgZnVuY3Rpb24gc3RhcnRDcm93ZHNhbGUodWludCBfc2FsZVN0YXJ0QXRCbG9jaykgcHVibGljIG9ubHlPd25lciBiZWZvcmVTdGFydCB7CiAgICAgICAgcmVxdWlyZShfc2FsZVN0YXJ0QXRCbG9jayA+IGJsb2NrLm51bWJlcik7CiAgICAgICAgc2FsZVN0YXJ0QXRCbG9jayA9IF9zYWxlU3RhcnRBdEJsb2NrOwogICAgICAgIFNhbGVTdGFydGVkKCk7CiAgICB9CgogICAgLy8vIEBkZXYgQ2xvc2UgdGhlIGNyb3dkc2FsZSBhbmQgaXNzdWUgdW5zb2xkIHRva2VucyB0byBgb3duZXJgIGFkZHJlc3MuCiAgICBmdW5jdGlvbiBjbG9zZUNyb3dkc2FsZSgpIHB1YmxpYyBvbmx5T3duZXIgYWZ0ZXJFbmQgewogICAgICAgIHJlcXVpcmUoIXVuc29sZFRva2VuSXNzdWVkKTsKCiAgICAgICAgaWYgKHRvdGFsRXRoUmVjZWl2ZWQgPj0gU09GVF9DQVApIHsKICAgICAgICAgICAgc2FsZUVuZEF0QmxvY2sgPSBibG9jay5udW1iZXI7CiAgICAgICAgICAgIGlzc3VlVW5zb2xkVG9rZW4oKTsKICAgICAgICAgICAgU2FsZVN1Y2NlZWRlZCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFNhbGVGYWlsZWQoKTsKICAgICAgICB9CiAgICB9CgogICAgLy8vIEBkZXYgZ29hbCBhY2hpZXZlZCBhaGVhZCBvZiB0aW1lCiAgICBmdW5jdGlvbiBnb2FsQWNoaWV2ZWQoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKCFpc0dvYWxBY2hpZXZlZCAmJiBzb2Z0Q2FwUmVhY2hlZCgpKTsKICAgICAgICBpc0dvYWxBY2hpZXZlZCA9IHRydWU7CiAgICAgICAgY2xvc2VDcm93ZHNhbGUoKTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIHRoZSBjdXJyZW50IHByaWNlLgogICAgZnVuY3Rpb24gcHJpY2UoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCB0b2tlbnMpIHsKICAgICAgICByZXR1cm4gY29tcHV0ZVRva2VuQW1vdW50KDEgZXRoZXIpOwogICAgfQoKICAgIC8vLyBAZGV2IFRoaXMgZGVmYXVsdCBmdW5jdGlvbiBhbGxvd3MgdG9rZW4gdG8gYmUgcHVyY2hhc2VkIGJ5IGRpcmVjdGx5CiAgICAvLy8gc2VuZGluZyBldGhlciB0byB0aGlzIHNtYXJ0IGNvbnRyYWN0LgogICAgZnVuY3Rpb24gKCkgcHVibGljIHBheWFibGUgewogICAgICAgIGlzc3VlVG9rZW4obXNnLnNlbmRlcik7CiAgICB9CgogICAgLy8vIEBkZXYgSXNzdWUgdG9rZW4gYmFzZWQgb24gZXRoZXIgcmVjZWl2ZWQuCiAgICAvLy8gQHBhcmFtIHJlY2lwaWVudCBBZGRyZXNzIHRoYXQgbmV3bHkgaXNzdWVkIHRva2VuIHdpbGwgYmUgc2VudCB0by4KICAgIGZ1bmN0aW9uIGlzc3VlVG9rZW4oYWRkcmVzcyByZWNpcGllbnQpIHB1YmxpYyBwYXlhYmxlIGluUHJvZ3Jlc3MgewogICAgICAgIC8vIFBlcnNvbmFsIGNhcCBjaGVjawogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbcmVjaXBpZW50XS5kaXYoQkFTRV9SQVRFKS5hZGQobXNnLnZhbHVlKSA8PSBDT05UUklCVVRJT05fTUFYKTsKICAgICAgICAvLyBDb250cmlidXRpb24gY2FwIGNoZWNrCiAgICAgICAgcmVxdWlyZShDT05UUklCVVRJT05fTUlOIDw9IG1zZy52YWx1ZSAmJiBtc2cudmFsdWUgPD0gQ09OVFJJQlVUSU9OX01BWCk7CgogICAgICAgIHVpbnQgdG9rZW5zID0gY29tcHV0ZVRva2VuQW1vdW50KG1zZy52YWx1ZSk7CgogICAgICAgIHRvdGFsRXRoUmVjZWl2ZWQgPSB0b3RhbEV0aFJlY2VpdmVkLmFkZChtc2cudmFsdWUpOwogICAgICAgIHNvbGRTUyA9IHNvbGRTUy5hZGQodG9rZW5zKTsKCiAgICAgICAgYmFsYW5jZXNbcmVjaXBpZW50XSA9IGJhbGFuY2VzW3JlY2lwaWVudF0uYWRkKHRva2Vucyk7CiAgICAgICAgSXNzdWUoaXNzdWVJbmRleCsrLHJlY2lwaWVudCxtc2cudmFsdWUsdG9rZW5zKTsKCiAgICAgICAgcmVxdWlyZShvd25lci5zZW5kKG1zZy52YWx1ZSkpOwogICAgfQoKICAgIC8vLyBAZGV2IElzc3VlIHRva2VuIGZvciByZXNlcnZlLgogICAgLy8vIEBwYXJhbSByZWNpcGllbnQgQWRkcmVzcyB0aGF0IG5ld2x5IGlzc3VlZCByZXNlcnZlIHRva2VuIHdpbGwgYmUgc2VudCB0by4KICAgIC8vLyBAcGFyYW0gX2lzc3VlVG9rZW5zV2l0aERlY2ltYWwgdGhlIGFtb3VudCBvZiByZXNlcnZlIHRva2Vucy4gISFJTVBPUlRBTlQgaXMgMTggREVDSU1BTFMKICAgIGZ1bmN0aW9uIGlzc3VlUmVzZXJ2ZVRva2VuKGFkZHJlc3MgcmVjaXBpZW50LCB1aW50MjU2IF9pc3N1ZVRva2Vuc1dpdGhEZWNpbWFsKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICBiYWxhbmNlc1tyZWNpcGllbnRdID0gYmFsYW5jZXNbcmVjaXBpZW50XS5hZGQoX2lzc3VlVG9rZW5zV2l0aERlY2ltYWwpOwogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKF9pc3N1ZVRva2Vuc1dpdGhEZWNpbWFsKTsKICAgICAgICBJc3N1ZShpc3N1ZUluZGV4KysscmVjaXBpZW50LDAsX2lzc3VlVG9rZW5zV2l0aERlY2ltYWwpOwogICAgfQoKICAgIC8qCiAgICAgKiBJTlRFUk5BTCBGVU5DVElPTlMKICAgICAqLwogICAgLy8vIEBkZXYgQ29tcHV0ZSB0aGUgYW1vdW50IG9mIFNTIHRva2VuIHRoYXQgY2FuIGJlIHB1cmNoYXNlZC4KICAgIC8vLyBAcGFyYW0gZXRoQW1vdW50IEFtb3VudCBvZiBFdGhlciB0byBwdXJjaGFzZSBTUy4KICAgIC8vLyBAcmV0dXJuIEFtb3VudCBvZiBTUyB0b2tlbiB0byBwdXJjaGFzZQogICAgZnVuY3Rpb24gY29tcHV0ZVRva2VuQW1vdW50KHVpbnQgZXRoQW1vdW50KSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50IHRva2VucykgewogICAgICAgIHVpbnQgcGhhc2UgPSAoYmxvY2subnVtYmVyIC0gc2FsZVN0YXJ0QXRCbG9jaykuZGl2KEJMT0NLU19QRVJfUEhBU0UpOwoKICAgICAgICAvLyBBIHNhZmUgY2hlY2sKICAgICAgICBpZiAocGhhc2UgPj0gYm9udXNQZXJjZW50YWdlcy5sZW5ndGgpIHsKICAgICAgICAgICAgcGhhc2UgPSBib251c1BlcmNlbnRhZ2VzLmxlbmd0aCAtIDE7CiAgICAgICAgfQoKICAgICAgICB1aW50IHRva2VuQmFzZSA9IGV0aEFtb3VudC5tdWwoQkFTRV9SQVRFKTsKCiAgICAgICAgLy9DaGVjayBwcm9tb3Rpb24gc3VwcGx5IGFuZCBwaGFzZSBib251cwogICAgICAgIHVpbnQgdG9rZW5Cb251cyA9IDA7CiAgICAgICAgaWYodG90YWxFdGhSZWNlaXZlZCAqIEJBU0VfUkFURSA8IE1BWF9QUk9NT1RJT05fU1MpIHsKICAgICAgICAgICAgdG9rZW5Cb251cyA9IHRva2VuQmFzZS5tdWwoYm9udXNQZXJjZW50YWdlc1twaGFzZV0pLmRpdigxMDApOwogICAgICAgIH0KCiAgICAgICAgdG9rZW5zID0gdG9rZW5CYXNlLmFkZCh0b2tlbkJvbnVzKTsKICAgIH0KCiAgICAvLy8gQGRldiBJc3N1ZSB1bnNvbGQgdG9rZW4gdG8gYG93bmVyYCBhZGRyZXNzLgogICAgZnVuY3Rpb24gaXNzdWVVbnNvbGRUb2tlbigpIGludGVybmFsIHsKICAgICAgICBpZiAodW5zb2xkVG9rZW5Jc3N1ZWQpIHsKICAgICAgICAgICAgSW52YWxpZFN0YXRlKCJVbnNvbGQgdG9rZW4gaGFzIGJlZW4gaXNzdWVkIGFscmVhZHkiKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBBZGQgYW5vdGhlciBzYWZlIGd1YXJkCiAgICAgICAgICAgIHJlcXVpcmUoc29sZFNTID4gMCk7CgogICAgICAgICAgICB1aW50MjU2IHVuc29sZFNTID0gdG90YWxTdXBwbHkuc3ViKHNvbGRTUyk7CiAgICAgICAgICAgIC8vIElzc3VlICd1bnNvbGRUb2tlbicgdG8gdGhlIGFkbWluIGFjY291bnQuCiAgICAgICAgICAgIGJhbGFuY2VzW293bmVyXSA9IGJhbGFuY2VzW293bmVyXS5hZGQodW5zb2xkU1MpOwogICAgICAgICAgICBJc3N1ZShpc3N1ZUluZGV4Kyssb3duZXIsMCx1bnNvbGRTUyk7CgogICAgICAgICAgICB1bnNvbGRUb2tlbklzc3VlZCA9IHRydWU7CiAgICAgICAgfQogICAgfQoKICAgIC8vLyBAcmV0dXJuIHRydWUgaWYgc2FsZSBoYXMgc3RhcnRlZCwgZmFsc2Ugb3RoZXJ3aXNlLgogICAgZnVuY3Rpb24gc2FsZVN0YXJ0ZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiAoc2FsZVN0YXJ0QXRCbG9jayA+IDAgJiYgYmxvY2subnVtYmVyID49IHNhbGVTdGFydEF0QmxvY2spOwogICAgfQoKICAgIC8vLyBAcmV0dXJuIHRydWUgaWYgc2FsZSBoYXMgZW5kZWQsIGZhbHNlIG90aGVyd2lzZS4KICAgIC8vLyBTYWxlIGVuZGVkIGluOiBhKSBlbmQgdGltZSBvZiBjcm93ZHNhbGUgcmVhY2hlZCwgYikgaGFyZCBjYXAgcmVhY2hlZCwgYykgZ29hbCBhY2hpZXZlZCBhaGVhZCBvZiB0aW1lCiAgICBmdW5jdGlvbiBzYWxlRW5kZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzYWxlU3RhcnRBdEJsb2NrID4gMCAmJiAoc2FsZUR1ZSgpIHx8IGhhcmRDYXBSZWFjaGVkKCkgfHwgaXNHb2FsQWNoaWV2ZWQpOwogICAgfQoKICAgIC8vLyBAcmV0dXJuIHRydWUgaWYgc2FsZSBpcyBkdWUgd2hlbiB0aGUgbGFzdCBwaGFzZSBpcyBmaW5pc2hlZC4KICAgIGZ1bmN0aW9uIHNhbGVEdWUoKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIGJsb2NrLm51bWJlciA+PSBzYWxlU3RhcnRBdEJsb2NrICsgQkxPQ0tTX1BFUl9QSEFTRSAqIE5VTV9PRl9QSEFTRTsKICAgIH0KCiAgICAvLy8gQHJldHVybiB0cnVlIGlmIHRoZSBoYXJkIGNhcCBpcyByZWFjaGVkLgogICAgZnVuY3Rpb24gaGFyZENhcFJlYWNoZWQoKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHRvdGFsRXRoUmVjZWl2ZWQgPj0gSEFSRF9DQVA7CiAgICB9CgogICAgLy8vIEByZXR1cm4gdHJ1ZSBpZiB0aGUgc29mdCBjYXAgaXMgcmVhY2hlZC4KICAgIGZ1bmN0aW9uIHNvZnRDYXBSZWFjaGVkKCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiB0b3RhbEV0aFJlY2VpdmVkID49IFNPRlRfQ0FQOwogICAgfQp9'.
	

]
