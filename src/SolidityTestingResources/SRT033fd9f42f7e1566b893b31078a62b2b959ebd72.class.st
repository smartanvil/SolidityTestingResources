Class {
	#name : #SRT033fd9f42f7e1566b893b31078a62b2b959ebd72,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT033fd9f42f7e1566b893b31078a62b2b959ebd72 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjA7IAoKY29udHJhY3QgRVJDMjBJbnRlcmZhY2UgewogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBvd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKfQoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyBDb250cmFjdCBmdW5jdGlvbiB0byByZWNlaXZlIGFwcHJvdmFsIGFuZCBleGVjdXRlIGZ1bmN0aW9uIGluIG9uZSBjYWxsCi8vCi8vIEJvcnJvd2VkIGZyb20gTWluaU1lVG9rZW4KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKaW50ZXJmYWNlIEFwcHJvdmVBbmRDYWxsRmFsbEJhY2sgewogICAgZnVuY3Rpb24gcmVjZWl2ZUFwcHJvdmFsKGFkZHJlc3MgZnJvbSwgdWludDI1NiB0b2tlbnMsIGFkZHJlc3MgdG9rZW4pIGV4dGVybmFsOwp9Cgpjb250cmFjdCBUUkxDb2luU2FsZSBpcyBBcHByb3ZlQW5kQ2FsbEZhbGxCYWNrIHsKICAgIC8vIEluZm9ybWF0aW9uIGFib3V0IGEgc2luZ2xlIHBlcmlvZAogICAgc3RydWN0IFBlcmlvZCB7CiAgICAgICAgdWludCBzdGFydDsKICAgICAgICB1aW50IGVuZDsKICAgICAgICB1aW50IHByaWNlSW5XZWk7CiAgICAgICAgdWludCB0b2tlbnM7CiAgICB9CgogICAgLy8gSW5mb3JtYXRpb24gYWJvdXQgcGF5bWVudCBjb250cmlidXRpb24KICAgIHN0cnVjdCBQYXltZW50Q29udHJpYnV0aW9uIHsKICAgICAgICB1aW50IHdlaUNvbnRyaWJ1dGVkOwogICAgICAgIHVpbnQgdGltZUNvbnRyaWJ1dGlvbjsKICAgICAgICB1aW50IHJlY2VpdmVUb2tlbnM7CiAgICB9CgogICAgc3RydWN0IFRvdGFsQ29udHJpYnV0aW9uIHsKICAgICAgICAvLyB0b3RhbCB2YWx1ZSBvZiBjb250cmlidXRpb247CiAgICAgICAgLy8gZm9yIGVtcHR5IGFkZHJlc3MgaXQgd2lsbCBiZSB6ZXJvCiAgICAgICAgdWludCB0b3RhbFJlY2VpdmVUb2tlbnM7CiAgICAgICAgLy8gT25seSBuZWNlc3NhcnkgaWYgdXNlcnMgd2FudCB0byBiZSBhYmxlIHRvIHNlZSBjb250cmlidXRpb24gaGlzdG9yeS4gCiAgICAgICAgLy8gT3RoZXJ3aXNlLCB0ZWNobmljYWxseSBub3QgbmVjZXNzYXJ5IGZvciB0aGUgcHVycG9zZXMgb2YgdGhlIHNhbGUKICAgICAgICBQYXltZW50Q29udHJpYnV0aW9uW10gcGF5bWVudEhpc3Rvcnk7IAogICAgfQoKICAgIC8vIFNvbWUgY29uc3RhbnQgYWJvdXQgb3VyIGV4cGVjdGVkIHRva2VuIGRpc3RyaWJ1dGlvbgogICAgdWludCBwdWJsaWMgY29uc3RhbnQgVFJMQ09JTl9ERUNJTUFMUyA9IDA7CiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBUT1RBTF9UT0tFTlNfVE9fRElTVFJJQlVURSA9IDgwMDAwMDAwMCAqICgxMCAqKiBUUkxDT0lOX0RFQ0lNQUxTKTsgLy8gODAwMDAwMDAwICBUUkwgVG9rZW4gZm9yIGRpc3RyaWJ1dGlvbgogICAgdWludCBwdWJsaWMgY29uc3RhbnQgVE9UQUxfVE9LRU5TX0FWQUlMQUJMRSA9IDEwMDAwMDAwMDAgKiAoMTAgKiogVFJMQ09JTl9ERUNJTUFMUyk7ICAgIC8vIDEwMDAwMDAwMDAgVFJMIFRva2VuIHRvdGFscwoKICAgIC8vIEVSQzIwIENvbnRyYWN0IGFkZHJlc3MuCiAgICBFUkMyMEludGVyZmFjZSBwcml2YXRlIHRva2VuV2FsbGV0OyAvLyBUaGUgdG9rZW4gd2FsbGV0IGNvbnRyYWN0IHVzZWQgZm9yIHRoaXMgY3Jvd2RzYWxlCiAgICAKICAgIGFkZHJlc3MgcHJpdmF0ZSBvd25lcjsgIC8vIFRoZSBvd25lciBvZiB0aGUgY3Jvd2RzYWxlCiAgICAKICAgIHVpbnQgcHJpdmF0ZSBzbWFsbEJvbnVzOyAvL1RoZSBzbWFsbCBib251cyBmb3IgcHJlc2FsZQogICAgdWludCBwcml2YXRlIGxhcmdlQm9udXM7IC8vVGhlIGxhcmdlIGJvbnVzIGZvciBwcmVzYWxlCiAgICB1aW50IHByaXZhdGUgbGFyZ2VCb251c1N0b3BUaW1lOyAvL1RoZSBzdG9wIHRpbWUgZm9yIExhcmdlIGJvbnVzCgogICAgdWludCBwcml2YXRlIHRva2Vuc1JlbWFpbmluZ0ZvclNhbGU7IC8vUmVtYWluaW5nIHRvdGFsIGFtb3V0IG9mIHRva2VucyAgCiAgICB1aW50IHByaXZhdGUgdG9rZW5zQXdhcmRlZEZvclNhbGU7ICAgLy8gdG90YWwgYXdhcmRlZCB0b2tlbnMKCiAgICB1aW50IHByaXZhdGUgZGlzdHJpYnV0aW9uVGltZTsgLy8gdGltZSBhZnRlciB3ZSBjb3VsZCBzdGFydCBkaXN0cmlidXRpb24gdG9rZW5zCiAgICAKICAgIFBlcmlvZCBwcml2YXRlIHByZVNhbGU7IC8vIFRoZSBjb25maWd1cmVkIHBlcmlvZHMgZm9yIHRoaXMgY3Jvd2RzYWxlCiAgICBQZXJpb2QgcHJpdmF0ZSBzYWxlOyAgICAvLyBUaGUgY29uZmlndXJlZCBwZXJpb2RzIGZvciB0aGlzIGNyb3dkc2FsZQogICAgCiAgICAKICAgIC8vIHBhaXIgZm8gdmFyaWFibGVzIG9uZSBmb3IgbWFwcGluZyBvbmUgZm9yIGl0ZXJhdGlvbgogICAgbWFwcGluZyhhZGRyZXNzID0+IFRvdGFsQ29udHJpYnV0aW9uKSBwdWJsaWMgcGF5bWVudHM7IC8vIFRyYWNrIGNvbnRyaWJ1dGlvbnMgYnkgZWFjaCBhZGRyZXNzIAogICAgYWRkcmVzc1tdIHB1YmxpYyBwYXltZW50QWRkcmVzc2VzOwoKICAgIGJvb2wgcHJpdmF0ZSBoYXNTdGFydGVkOyAvLyBIYXMgdGhlIGNyb3dkc2FsZSBzdGFydGVkPwogICAgCiAgICAvLyBGaXJlZCBvbmNlIHRoZSB0cmFuc2ZlciB0b2tlbnMgdG8gY29udHJhY3Qgd2FzIHN1Y2Nlc3NmdWxsCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQgYW1vdW50KTsKCiAgICAvLyBGaXJlZCBvbmNlIHRoZSBzYWxlIHN0YXJ0cwogICAgZXZlbnQgU3RhcnQodWludCB0aW1lc3RhbXApOwoKICAgIC8vIEZpcmVkIHdoZW5ldmVyIGEgY29udHJpYnV0aW9uIGlzIG1hZGUKICAgIGV2ZW50IENvbnRyaWJ1dGUoYWRkcmVzcyBpbmRleGVkIGZyb20sIHVpbnQgd2VpQ29udHJpYnV0ZWQsIHVpbnQgdG9rZW5zUmVjZWl2ZWQpOwoKICAgIC8vIEZpcmVzIHdoZW5ldmVyIHdlIHNlbmQgdG9rZW4gdG8gY29udHJpYnV0b3IKICAgIGV2ZW50IERpc3RyaWJ1dGUoIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB0b2tlbnNTZW5kICk7CgogICAgZnVuY3Rpb24gYWRkQ29udHJpYnV0aW9uKGFkZHJlc3MgZnJvbSwgdWludCB3ZWlDb250cmlidXRlZCwgdWludCB0b2tlbnNSZWNlaXZlZCkgcHJpdmF0ZSByZXR1cm5zKGJvb2wpIHsKICAgICAgICAvL25ldyBjb250aWJ1dG9yCiAgICAgICAgcmVxdWlyZSh3ZWlDb250cmlidXRlZCA+IDApOwogICAgICAgIHJlcXVpcmUodG9rZW5zUmVjZWl2ZWQgPiAwKTsKICAgICAgICByZXF1aXJlKHRva2Vuc1JlbWFpbmluZ0ZvclNhbGUgPj0gdG9rZW5zUmVjZWl2ZWQpOwogICAgICAgIAogICAgICAgIFBheW1lbnRDb250cmlidXRpb24gbWVtb3J5IG5ld0NvbnRyaWJ1dGlvbjsKICAgICAgICBuZXdDb250cmlidXRpb24udGltZUNvbnRyaWJ1dGlvbiA9IGJsb2NrLnRpbWVzdGFtcDsKICAgICAgICBuZXdDb250cmlidXRpb24ud2VpQ29udHJpYnV0ZWQgPSB3ZWlDb250cmlidXRlZDsKICAgICAgICBuZXdDb250cmlidXRpb24ucmVjZWl2ZVRva2VucyA9IHRva2Vuc1JlY2VpdmVkOwoKICAgICAgICAvLyBTaW5jZSB3ZSBjYW5ub3QgY29udHJpYnV0ZSB6ZXJvIHRva2VucywgaWYgdG90YWxSZWNlaXZlVG9rZW5zIGlzIHplcm8sCiAgICAgICAgLy8gdGhlbiB0aGlzIGlzIHRoZSBmaXJzdCBjb250cmlidXRpb24gZm9yIHRoaXMgYWRkcmVzcwogICAgICAgIGlmIChwYXltZW50c1tmcm9tXS50b3RhbFJlY2VpdmVUb2tlbnMgPT0gMCkgewogICAgICAgICAgICAvLyBuZXcgdG90YWwgY29udHJpYnV0aW9uICAgICAgICAgICAKICAgICAgICAgICAgcGF5bWVudHNbZnJvbV0udG90YWxSZWNlaXZlVG9rZW5zID0gdG9rZW5zUmVjZWl2ZWQ7CiAgICAgICAgICAgIHBheW1lbnRzW2Zyb21dLnBheW1lbnRIaXN0b3J5LnB1c2gobmV3Q29udHJpYnV0aW9uKTsKICAgICAgICAgICAgCiAgICAgICAgICAgICAvLyBwdXNoIG5ldyBhZGRyZXNzIHRvIGFycmF5IGZvciBpdGVyYXRpb24gYnkgYWRkcmVzcyAgZHVyaW5nIGRpc3RpcmJ1dGlvbiBwcm9jZXNzCiAgICAgICAgICAgIHBheW1lbnRBZGRyZXNzZXMucHVzaChmcm9tKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwYXltZW50c1tmcm9tXS50b3RhbFJlY2VpdmVUb2tlbnMgKz0gdG9rZW5zUmVjZWl2ZWQ7CiAgICAgICAgICAgIHBheW1lbnRzW2Zyb21dLnBheW1lbnRIaXN0b3J5LnB1c2gobmV3Q29udHJpYnV0aW9uKTsKICAgICAgICB9CiAgICAgICAgdG9rZW5zUmVtYWluaW5nRm9yU2FsZSAtPSB0b2tlbnNSZWNlaXZlZDsKICAgICAgICB0b2tlbnNBd2FyZGVkRm9yU2FsZSArPSB0b2tlbnNSZWNlaXZlZDsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBwdWJsaWMgZ2V0dGVycyBmb3IgcHJpdmF0ZSBzdGF0ZSB2YXJpYWJsZXMKICAgIGZ1bmN0aW9uIGdldE93bmVyKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcykgeyByZXR1cm4gb3duZXI7IH0KICAgIGZ1bmN0aW9uIGdldEhhc1N0YXJ0ZWRTdGF0ZSgpIHB1YmxpYyB2aWV3ICByZXR1cm5zKGJvb2wpIHsgcmV0dXJuIGhhc1N0YXJ0ZWQ7IH0KICAgIGZ1bmN0aW9uIGdldFByZXNhbGUoKSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnQsIHVpbnQsIHVpbnQsIHVpbnQpIHsgCiAgICAgICAgcmV0dXJuIChwcmVTYWxlLnN0YXJ0LCBwcmVTYWxlLmVuZCwgcHJlU2FsZS5wcmljZUluV2VpLCBwcmVTYWxlLnRva2Vucyk7CiAgICB9CiAgICBmdW5jdGlvbiBnZXRTYWxlKCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50LCB1aW50LCB1aW50LCB1aW50KSB7IAogICAgICAgIHJldHVybiAoc2FsZS5zdGFydCwgc2FsZS5lbmQsIHNhbGUucHJpY2VJbldlaSwgc2FsZS50b2tlbnMpOwogICAgfQogICAgZnVuY3Rpb24gZ2V0RGlzdHJpYnV0aW9uVGltZSgpIHB1YmxpYyB2aWV3IHJldHVybnModWludCkgeyByZXR1cm4gZGlzdHJpYnV0aW9uVGltZTsgfQogICAgCiAgICBmdW5jdGlvbiBnZXRTbWFsbEJvbnVzKCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50KSB7IHJldHVybiBzbWFsbEJvbnVzOyB9CiAgICBmdW5jdGlvbiBnZXRMYXJnZUJvbnVzKCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50KSB7IHJldHVybiBsYXJnZUJvbnVzOyB9CiAgICBmdW5jdGlvbiBnZXRMYXJnZUJvbnVzU3RvcFRpbWUoKSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnQpIHsgcmV0dXJuICBsYXJnZUJvbnVzU3RvcFRpbWU7IH0KICAgIGZ1bmN0aW9uIGdldFRva2VuUmVtYWluaW5nKCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50KSB7IHJldHVybiB0b2tlbnNSZW1haW5pbmdGb3JTYWxlOyB9CiAgICBmdW5jdGlvbiBnZXRUb2tlbkF3YXJkZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnQpIHsgcmV0dXJuIHRva2Vuc0F3YXJkZWRGb3JTYWxlOyB9CgogICAgLy8gQWZ0ZXIgY3JlYXRlIHNhbGUgY29udHJhY3QgZmlyc3QgZnVuY3Rpb24gc2hvdWxkIGJlIGFwcHJvdmVBbmRDYWxsIG9uIFRva2VuIGNvbnRyYWN0CiAgICAvLyB3aXRoIHRoaXMgY29udHJhY3QgYXMgc3BlbmRlciBhbmQgVE9UQUxfVE9LRU5TX1RPX0RJU1RSSUJVVEUgZm9yIGFwcHJvdmFsCiAgICAvLyB0aGlzIGNhbGxiYWNrIGZ1bmN0aW9uIGNhbGxlZCBmb3JtIFRva2VuIGNvbnRyYWN0IGFmdGVyIGFwcHJvdmUgb24gVG9rZW4gY29udHJhY3QKICAgIC8vIGV2ZW50dWFsbHkgdG9rZW5zUmVtYWluaW5nRm9yU2FsZSA9IFRPVEFMX1RPS0VOU19UT19ESVNUUklCVVRFCiAgICBmdW5jdGlvbiByZWNlaXZlQXBwcm92YWwoYWRkcmVzcyBmcm9tLCB1aW50MjU2IHRva2VucywgYWRkcmVzcyB0b2tlbikgZXh0ZXJuYWwgewogICAgICAgIC8vIG1ha2Ugc3VyZSB0aGUgc2FsZXMgd2FzIG5vdCBzdGFydGVkCiAgICAgICAgcmVxdWlyZShoYXNTdGFydGVkID09IGZhbHNlKTsKICAgICAgICAKICAgICAgICAvLyBtYWtlIHN1cmUgdGhpcyB0b2tlbiBhZGRyZXNzIG1hdGNoZXMgb3VyIGNvbmZpZ3VyZWQgdG9rZW5XYWxsZXQgYWRkcmVzcwogICAgICAgIHJlcXVpcmUodG9rZW4gPT0gYWRkcmVzcyh0b2tlbldhbGxldCkpOyAKICAgICAgICAKICAgICAgICB0b2tlbnNSZW1haW5pbmdGb3JTYWxlICs9IHRva2VuczsKICAgICAgICBib29sIHJlc3VsdCA9IHRva2VuV2FsbGV0LnRyYW5zZmVyRnJvbShmcm9tLCB0aGlzLCB0b2tlbnMpOwogICAgICAgIC8vIE1ha2Ugc3VyZSB0cmFuc2ZlciBzdWNjZWVkZWQKICAgICAgICByZXF1aXJlKHJlc3VsdCA9PSB0cnVlKTsKICAgICAgICAKICAgICAgICBUcmFuc2ZlcihhZGRyZXNzKHRoaXMpLCB0b2tlbnMpOwogICAgfQoKICAgIC8vIGNvbnRyYWN0IGNvbnN0cnVjdG9yCiAgICBmdW5jdGlvbiBUUkxDb2luU2FsZShhZGRyZXNzIHdhbGxldEFkZHJlc3MpIHB1YmxpYyB7CiAgICAgICAgLy8gU2V0dXAgdGhlIG93bmVyIGFuZCB3YWxsZXQKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgdG9rZW5XYWxsZXQgPSBFUkMyMEludGVyZmFjZSh3YWxsZXRBZGRyZXNzKTsKCiAgICAgICAgLy8gTWFrZSBzdXJlIHRoZSBwcm92aWRlZCB0b2tlbiBoYXMgdGhlIGV4cGVjdGVkIG51bWJlciBvZiB0b2tlbnMgdG8gZGlzdHJpYnV0ZQogICAgICAgIHJlcXVpcmUodG9rZW5XYWxsZXQudG90YWxTdXBwbHkoKSA9PSBUT1RBTF9UT0tFTlNfQVZBSUxBQkxFKTsKCiAgICAgICAgLy8gTWFrZSBzdXJlIHRoZSBvd25lciBhY3R1YWxseSBjb250cm9scyBhbGwgdGhlIHRva2VucwogICAgICAgIHJlcXVpcmUodG9rZW5XYWxsZXQuYmFsYW5jZU9mKG93bmVyKSA+PSBUT1RBTF9UT0tFTlNfVE9fRElTVFJJQlVURSk7CgogICAgICAgIC8vIFRoZSBtdWx0aXBsaWVyIG5lY2Vzc2FyeSB0byBjaGFuZ2UgYSBjb2luIGFtb3VudCB0byB0aGUgdG9rZW4gYW1vdW50CiAgICAgICAgdWludCBjb2luVG9Ub2tlbkZhY3RvciA9IDEwICoqIFRSTENPSU5fREVDSU1BTFM7CgogICAgICAgIHByZVNhbGUuc3RhcnQgPSAxNTIwODEyODAwOyAvLyAwMDowMDowMCwgTWFyY2ggMTIsIDIwMTggVVRDIHVzZSBuZXh0IHNpdGUgaHR0cHM6Ly93d3cuZXBvY2hjb252ZXJ0ZXIuY29tLwogICAgICAgIHByZVNhbGUuZW5kID0gMTUyMzQ5MTE5OTsgLy8gMjM6NTk6NTksIEp1bHkgMTEsIDIwMTggVVRDCiAgICAgICAgcHJlU2FsZS5wcmljZUluV2VpID0gKDEgZXRoZXIpIC8gKDIwMDAwICogY29pblRvVG9rZW5GYWN0b3IpOyAvLyAxIEVUSCA9IDIwMDAwIFRSTAogICAgICAgIHByZVNhbGUudG9rZW5zID0gVE9UQUxfVE9LRU5TX1RPX0RJU1RSSUJVVEUgLyAyOwogICAgICAgCiAgICAgICAgc21hbGxCb251cyA9IDEwOwogICAgICAgIGxhcmdlQm9udXMgPSAyMDsKICAgICAgICBsYXJnZUJvbnVzU3RvcFRpbWUgPSAxNTIxNTA0MDAwOwogICAgCiAgICAgICAgc2FsZS5zdGFydCA9IDE1MjM0OTEyMDA7IC8vIDAwOjAwOjAwLCBKdWx5IDEyLCAyMDE4IFVUQyB1c2UgbmV4dCBzaXRlIGh0dHBzOi8vd3d3LmVwb2NoY29udmVydGVyLmNvbS8KICAgICAgICBzYWxlLmVuZCA9IDE1MzEzNzg3OTk7IC8vIDIzOjU5OjU5LCBKdWx5IDExLCAyMDE4IFVUQwogICAgICAgIHNhbGUucHJpY2VJbldlaSA9ICgxIGV0aGVyKSAvICgxMDAwMCAqIGNvaW5Ub1Rva2VuRmFjdG9yKTsgLy8gMSBFVEggPSAxMDAwMCBUUkwKICAgICAgICBzYWxlLnRva2VucyA9IFRPVEFMX1RPS0VOU19UT19ESVNUUklCVVRFIC8gMjsKICAgICAgICAKICAgICAgICBkaXN0cmlidXRpb25UaW1lID0gMTUzMTM3ODgwMDsgLy8gMDA6MDA6MDAsIEp1bmUgMTIsIDIwMTggVVRDCgogICAgICAgIHRva2Vuc1JlbWFpbmluZ0ZvclNhbGUgPSAwOwogICAgICAgIHRva2Vuc0F3YXJkZWRGb3JTYWxlID0gMDsKICAgIH0KCiAgICAvLyBjaGFuZ2UgZGVmYXVsdCBwcmVzYWxlIGRhdGVzIAogICAgZnVuY3Rpb24gc2V0UHJlc2FsZURhdGVzKHVpbnQgc3RhcnREYXRlLCB1aW50IHN0b3BEYXRlKSBwdWJsaWMgewogICAgICAgIC8vIE9ubHkgdGhlIG93bmVyIGNhbiBkbyB0aGlzCiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsgCiAgICAgICAgLy8gQ2Fubm90IGNoYW5nZSBpZiBhbHJlYWR5IHN0YXJ0ZWQKICAgICAgICByZXF1aXJlKGhhc1N0YXJ0ZWQgPT0gZmFsc2UpOwogICAgICAgIC8vaW5zYW5pdHkgY2hlY2sgc3RhcnQgPCBzdG9wIGFuZCBzdG9wIHJlc2FsZSA8IHN0YXJ0IG9mIHNhbGUKICAgICAgICByZXF1aXJlKHN0YXJ0RGF0ZSA8IHN0b3BEYXRlICYmIHN0b3BEYXRlIDwgc2FsZS5zdGFydCk7CiAgICAgICAgCiAgICAgICAgcHJlU2FsZS5zdGFydCA9IHN0YXJ0RGF0ZTsKICAgICAgICBwcmVTYWxlLmVuZCA9IHN0b3BEYXRlOwogICAgfQogICAgCiAgICAvLyBjaGFuZ2UgZGVmYXVsdCBwcmVzYWxlIGRhdGVzIAogICAgZnVuY3Rpb24gc2V0bGFyZ2VCb251c1N0b3BUaW1lKHVpbnQgYm9udXNTdG9wVGltZSkgcHVibGljIHsKICAgICAgICAvLyBPbmx5IHRoZSBvd25lciBjYW4gZG8gdGhpcwogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7IAogICAgICAgIC8vIENhbm5vdCBjaGFuZ2UgaWYgYWxyZWFkeSBzdGFydGVkCiAgICAgICAgcmVxdWlyZShoYXNTdGFydGVkID09IGZhbHNlKTsKICAgICAgICAvL2luc2FuaXR5IGNoZWNrIHN0YXJ0IDwgc3RvcCBhbmQgc3RvcCByZXNhbGUgPCBzdGFydCBvZiBzYWxlCiAgICAgICAgcmVxdWlyZShwcmVTYWxlLnN0YXJ0IDw9IGJvbnVzU3RvcFRpbWUgJiYgYm9udXNTdG9wVGltZSA8PSBwcmVTYWxlLmVuZCk7CiAgICAgICAgCiAgICAgICAgbGFyZ2VCb251c1N0b3BUaW1lID0gYm9udXNTdG9wVGltZTsKICAgIH0KICAgIAogICAgLy8gY2hhbmdlIGRlZmF1bHQgc2FsZSBkYXRlcyAKICAgIGZ1bmN0aW9uIHNldFNhbGUodWludCBzdGFydERhdGUsIHVpbnQgc3RvcERhdGUpIHB1YmxpYyB7CiAgICAgICAgLy8gT25seSB0aGUgb3duZXIgY2FuIGRvIHRoaXMKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOyAKICAgICAgICAvLyBDYW5ub3QgY2hhbmdlIGlmIGFscmVhZHkgc3RhcnRlZAogICAgICAgIHJlcXVpcmUoaGFzU3RhcnRlZCA9PSBmYWxzZSk7CiAgICAgICAgLy8gaW5zYW5pdHkgY2hlY2sgc3RhcnQgPCBzdG9wIGFuZCBzdG9wIHJlc2FsZSA8IHN0YXJ0IG9mIHNhbGUKICAgICAgICByZXF1aXJlKHN0YXJ0RGF0ZSA8IHN0b3BEYXRlICYmIHN0YXJ0RGF0ZSA+IHByZVNhbGUuZW5kKTsKICAgICAgICAvLyBpbnNhbml0eSBjaGVjayBzYWxlLmVuZCA8IGRpc3RpcmJ1dGlvbiB0b2tlbiB0aW1lCiAgICAgICAgcmVxdWlyZShzYWxlLmVuZCA8IGRpc3RyaWJ1dGlvblRpbWUpOwogICAgICAgIAogICAgICAgIHNhbGUuc3RhcnQgPSBzdGFydERhdGU7CiAgICAgICAgc2FsZS5lbmQgPSBzdG9wRGF0ZTsKICAgIH0KCiAgICAvLyBjaGFuZ2UgZGVmYXVsdCBkaXN0aWJ1dGlvbiB0aW1lCiAgICBmdW5jdGlvbiBzZXREaXN0cmlidXRpb25UaW1lKHVpbnQgdGltZU9mRGlzdHJpYnV0aW9uKSBwdWJsaWMgewogICAgICAgIC8vIE9ubHkgdGhlIG93bmVyIGNhbiBkbyB0aGlzCiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsgCiAgICAgICAgLy8gQ2Fubm90IGNoYW5nZSBpZiBhbHJlYWR5IHN0YXJ0ZWQKICAgICAgICByZXF1aXJlKGhhc1N0YXJ0ZWQgPT0gZmFsc2UpOwogICAgICAgIC8vIGluc2FuaXR5IGNoZWNrIHNhbGUuZW5kIDwgZGlzdGlyYnV0aW9uIHRva2VuIHRpbWUKICAgICAgICByZXF1aXJlKHNhbGUuZW5kIDwgdGltZU9mRGlzdHJpYnV0aW9uKTsKICAgICAgICAKICAgICAgICBkaXN0cmlidXRpb25UaW1lID0gdGltZU9mRGlzdHJpYnV0aW9uOwogICAgfQoKICAgIC8vIHRoaXMgZnVuY3Rpb24gYWRkZWQgQ29udHJpYnV0b3IgdGhhdCBhbHJlYWR5IG1hZGUgY29udHJpYnV0aW9uIGJlZm9yZSBwcmVzYWxlIHN0YXJ0ZWQgCiAgICAvLyBzaG91bGQgYmUgY2FsbGVkIG9ubHkgYWZ0ZXIgdG9rZW4gd2FzIHRyYW5zZmVyZWQgdG8gU2FsZSBjb250cmFjdAogICAgZnVuY3Rpb24gYWRkQ29udHJpYnV0b3JNYW51YWxseSggYWRkcmVzcyB3aG8sIHVpbnQgY29udHJpYnV0aW9uV2VpLCB1aW50IHRva2VucykgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIC8vIG9ubHkgb3duZXIKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOyAgIAogICAgICAgIC8vY29udHJhY3QgbXVzdCBiZSBub3QgYWN0aXZlCiAgICAgICAgcmVxdWlyZShoYXNTdGFydGVkID09IGZhbHNlKTsKICAgICAgICAvLyBhbGwgZW50cmllZCBtdXN0IGJlIGFkZGVkIGJlZm9yZSBwcmVzYWxlIHN0YXJ0ZWQKICAgICAgICByZXF1aXJlKGJsb2NrLnRpbWVzdGFtcCA8IHByZVNhbGUuc3RhcnQpOwogICAgICAgIC8vIGNvbnRyYWN0IG11c2ggaGF2ZSB0b3RhbCA9PSBUT1RBTF9UT0tFTlNfVE9fRElTVFJJQlVURQogICAgICAgIHJlcXVpcmUoKHRva2Vuc1JlbWFpbmluZ0ZvclNhbGUgKyB0b2tlbnNBd2FyZGVkRm9yU2FsZSkgPT0gVE9UQUxfVE9LRU5TX1RPX0RJU1RSSUJVVEUpOwogICAgICAgIAogICAgICAgIC8vIGRlY3JlbWVudCBwcmVzYWxlIC0gdG9rZW4gZm9yIG1hbnVhbCBjb250aWJ1dGlvbiBzaG91bGQgYmUgdGFrZW4gZnJvbSBwcmVzYWxlCiAgICAgICAgcHJlU2FsZS50b2tlbnMgLT0gdG9rZW5zOwoKICAgICAgICBhZGRDb250cmlidXRpb24od2hvLCBjb250cmlidXRpb25XZWksIHRva2Vucyk7CiAgICAgICAgQ29udHJpYnV0ZSh3aG8sIGNvbnRyaWJ1dGlvbldlaSwgdG9rZW5zKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBTdGFydCB0aGUgY3Jvd2RzYWxlCiAgICBmdW5jdGlvbiBzdGFydFNhbGUoKSBwdWJsaWMgewogICAgICAgIC8vIE9ubHkgdGhlIG93bmVyIGNhbiBkbyB0aGlzCiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsgCiAgICAgICAgLy8gQ2Fubm90IHN0YXJ0IGlmIGFscmVhZHkgc3RhcnRlZAogICAgICAgIHJlcXVpcmUoaGFzU3RhcnRlZCA9PSBmYWxzZSk7CiAgICAgICAgLy8gTWFrZSBzdXJlIHRoZSB0aW1lc3RhbXBzIGFsbCBtYWtlIHNlbnNlCiAgICAgICAgcmVxdWlyZShwcmVTYWxlLmVuZCA+IHByZVNhbGUuc3RhcnQpOwogICAgICAgIHJlcXVpcmUoc2FsZS5lbmQgPiBzYWxlLnN0YXJ0KTsKICAgICAgICByZXF1aXJlKHNhbGUuc3RhcnQgPiBwcmVTYWxlLmVuZCk7CiAgICAgICAgcmVxdWlyZShkaXN0cmlidXRpb25UaW1lID4gc2FsZS5lbmQpOwoKICAgICAgICAvLyBNYWtlIHN1cmUgdGhlIG93bmVyIGFjdHVhbGx5IGNvbnRyb2xzIGFsbCB0aGUgdG9rZW5zIGZvciBzYWxlcwogICAgICAgIHJlcXVpcmUodG9rZW5XYWxsZXQuYmFsYW5jZU9mKGFkZHJlc3ModGhpcykpID09IFRPVEFMX1RPS0VOU19UT19ESVNUUklCVVRFKTsKICAgICAgICByZXF1aXJlKCh0b2tlbnNSZW1haW5pbmdGb3JTYWxlICsgdG9rZW5zQXdhcmRlZEZvclNhbGUpID09IFRPVEFMX1RPS0VOU19UT19ESVNUUklCVVRFKTsKCiAgICAgICAgLy8gTWFrZSBzdXJlIHdlIGFsbG9jYXRlZCBhbGwgc2FsZSB0b2tlbnMKICAgICAgICByZXF1aXJlKChwcmVTYWxlLnRva2VucyArIHNhbGUudG9rZW5zKSA9PSB0b2tlbnNSZW1haW5pbmdGb3JTYWxlKTsgICAgICAgICAgCgogICAgICAgIC8vIFRoZSBzYWxlIGNhbiBiZWdpbgogICAgICAgIGhhc1N0YXJ0ZWQgPSB0cnVlOwoKICAgICAgICAvLyBGaXJlIGV2ZW50IHRoYXQgdGhlIHNhbGUgaGFzIGJlZ3VuCiAgICAgICAgU3RhcnQoYmxvY2sudGltZXN0YW1wKTsKICAgIH0gICAgCgogICAgLy8gQWxsb3cgdGhlIGN1cnJlbnQgb3duZXIgdG8gY2hhbmdlIHRoZSBvd25lciBvZiB0aGUgY3Jvd2RzYWxlCiAgICBmdW5jdGlvbiBjaGFuZ2VPd25lcihhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgewogICAgICAgIC8vIE9ubHkgdGhlIG93bmVyIGNhbiBkbyB0aGlzCiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKCiAgICAgICAgLy8gQ2hhbmdlIHRoZSBvd25lcgogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICB9CgogICAgZnVuY3Rpb24gcHJlU2FsZUZpbmlzaGVkUHJvY2VzcyggdWludCB0aW1lT2ZSZXF1ZXN0KSBwcml2YXRlIHJldHVybnMoYm9vbCkgewogICAgICAgIC8vIGlmIHdlIGhhdmUgU2FsZXMgZXZlbnQgYW5kIHRva2VucyBvZiBwcmVzYWxlIGlzIG5vdCAwIG1vdmUgdGhlbSB0byBzYWxlcwogICAgICAgIHJlcXVpcmUodGltZU9mUmVxdWVzdCA+PSBzYWxlLnN0YXJ0ICYmIHRpbWVPZlJlcXVlc3QgPD0gc2FsZS5lbmQpOwogICAgICAgIGlmIChwcmVTYWxlLnRva2VucyAhPSAwKSB7CiAgICAgICAgICAgIHVpbnQgc2F2ZVByZVNhbGVUb21lbnMgPSBwcmVTYWxlLnRva2VuczsKICAgICAgICAgICAgcHJlU2FsZS50b2tlbnMgPSAwOwogICAgICAgICAgICBzYWxlLnRva2VucyArPSBzYXZlUHJlU2FsZVRvbWVuczsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIC8vIENhbGN1bGF0ZSBob3cgbWFueSB0b2tlbnMgY2FuIGJlIGRpc3RyaWJ1dGVkIGZvciB0aGUgZ2l2ZW4gY29udHJpYnV0aW9uCiAgICBmdW5jdGlvbiBnZXRUb2tlbnNGb3JDb250cmlidXRpb24odWludCB3ZWlDb250cmlidXRpb24pIHByaXZhdGUgcmV0dXJucyh1aW50IHRpbWVPZlJlcXVlc3QsIHVpbnQgdG9rZW5BbW91bnQsIHVpbnQgd2VpUmVtYWluZGVyLCB1aW50IGJvbnVzKSB7IAogICAgICAgIC8vIEdldCBjdXJlbnQgdGltZQogICAgICAgIHRpbWVPZlJlcXVlc3QgPSBibG9jay50aW1lc3RhbXA7CiAgICAgICAgLy8ganVzdCBmb3Igc3VyZSB0aGF0IGJvbnVzIGlzIGluaXRpYWxpemVkCiAgICAgICAgYm9udXMgPSAwOwogICAgICAgICAgICAgICAgIAogICAgICAgIC8vIGNoZWNraW5nIHdoYXQgcGVyaW9kIGFyZSB3ZQogICAgICAgIGlmICh0aW1lT2ZSZXF1ZXN0IDw9IHByZVNhbGUuZW5kKSB7CiAgICAgICAgICAgIC8vIFJldHVybiB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGNhbiBiZSBwdXJjaGFzZWQKICAgICAgICAgICAgLy8gQW5kIHRoZSBhbW91bnQgb2Ygd2VpIHRoYXQgd291bGQgYmUgbGVmdCBvdmVyCiAgICAgICAgICAgIHRva2VuQW1vdW50ID0gd2VpQ29udHJpYnV0aW9uIC8gcHJlU2FsZS5wcmljZUluV2VpOwogICAgICAgICAgICB3ZWlSZW1haW5kZXIgPSB3ZWlDb250cmlidXRpb24gJSBwcmVTYWxlLnByaWNlSW5XZWk7CiAgICAgICAgICAgIC8vIGlmIHByZXNhbGUgLSBjaGVja2luZyBib251c2VzCiAgICAgICAgICAgIGlmICh0aW1lT2ZSZXF1ZXN0IDwgbGFyZ2VCb251c1N0b3BUaW1lKSB7CiAgICAgICAgICAgICAgICBib251cyA9ICggdG9rZW5BbW91bnQgKiBsYXJnZUJvbnVzICkgLyAxMDA7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBib251cyA9ICggdG9rZW5BbW91bnQgKiBzbWFsbEJvbnVzICkgLyAxMDA7CiAgICAgICAgICAgIH0gICAgICAgICAgICAgCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gaWYgc2FsZXMgcGVyaW9kIGp1c3Qgc3RhcnRlZCAtIHRyYW5zZmVyIGFsbCByZW1haW5pbmcgdG9rZW5zIGZyb20gcHJlc2FsZSB0byBzYWxlCiAgICAgICAgICAgIHByZVNhbGVGaW5pc2hlZFByb2Nlc3ModGltZU9mUmVxdWVzdCk7CiAgICAgICAgICAgIC8vIFJldHVybiB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGNhbiBiZSBwdXJjaGFzZWQKICAgICAgICAgICAgLy8gQW5kIHRoZSBhbW91bnQgb2Ygd2VpIHRoYXQgd291bGQgYmUgbGVmdCBvdmVyCiAgICAgICAgICAgIHRva2VuQW1vdW50ID0gd2VpQ29udHJpYnV0aW9uIC8gc2FsZS5wcmljZUluV2VpOwogICAgICAgICAgICB3ZWlSZW1haW5kZXIgPSB3ZWlDb250cmlidXRpb24gJSBzYWxlLnByaWNlSW5XZWk7CiAgICAgICAgfSAKICAgICAgICByZXR1cm4odGltZU9mUmVxdWVzdCwgdG9rZW5BbW91bnQsIHdlaVJlbWFpbmRlciwgYm9udXMpOwogICAgfQogICAgCiAgICBmdW5jdGlvbigpcHVibGljIHBheWFibGUgewogICAgICAgIC8vIENhbm5vdCBjb250cmlidXRlIGlmIHRoZSBzYWxlIGhhc24ndCBzdGFydGVkCiAgICAgICAgcmVxdWlyZShoYXNTdGFydGVkID09IHRydWUpOwogICAgICAgIC8vIENhbm5vdCBjb250cmlidXRlIGlmIHNhbGUgaXMgbm90IGluIHRoaXMgdGltZSByYW5nZQogICAgICAgIHJlcXVpcmUoKGJsb2NrLnRpbWVzdGFtcCA+PSBwcmVTYWxlLnN0YXJ0ICYmIGJsb2NrLnRpbWVzdGFtcCA8PSBwcmVTYWxlLmVuZCkKICAgICAgICAgICAgfHwgKGJsb2NrLnRpbWVzdGFtcCA+PSBzYWxlLnN0YXJ0ICYmIGJsb2NrLnRpbWVzdGFtcCA8PSBzYWxlLmVuZCkKICAgICAgICApOyAKCiAgICAgICAgLy8gQ2Fubm90IGNvbnRyaWJ1dGUgaWYgYW1vdW50IG9mIG1vbmV5IHNlbmQgaXMgbGVzIHRoZW4gMC4xIEVUSAogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID49IDEwMCBmaW5uZXkpOwogICAgICAgIAogICAgICAgIHVpbnQgdGltZU9mUmVxdWVzdDsKICAgICAgICB1aW50IHRva2VuQW1vdW50OwogICAgICAgIHVpbnQgd2VpUmVtYWluZGVyOwogICAgICAgIHVpbnQgYm9udXM7CiAgICAgICAgLy8gQ2FsY3VsYXRlIHRoZSB0b2tlbnMgdG8gYmUgZGlzdHJpYnV0ZWQgYmFzZWQgb24gdGhlIGNvbnRyaWJ1dGlvbiBhbW91bnQKICAgICAgICAodGltZU9mUmVxdWVzdCwgdG9rZW5BbW91bnQsIHdlaVJlbWFpbmRlciwgYm9udXMpID0gZ2V0VG9rZW5zRm9yQ29udHJpYnV0aW9uKG1zZy52YWx1ZSk7CgogICAgICAgIC8vIE1ha2Ugc3VyZSB0aGVyZSBhcmUgZW5vdWdoIHRva2VucyBsZWZ0IHRvIGJ1eQogICAgICAgIHJlcXVpcmUodG9rZW5zUmVtYWluaW5nRm9yU2FsZSA+PSB0b2tlbkFtb3VudCArIGJvbnVzKTsKICAgICAgICAKICAgICAgICAvLyBOZWVkIHRvIGNvbnRyaWJ1dGUgZW5vdWdoIGZvciBhdCBsZWFzdCAxIHRva2VuCiAgICAgICAgcmVxdWlyZSh0b2tlbkFtb3VudCA+IDApOwogICAgICAgIAogICAgICAgIC8vIFNhbml0eSBjaGVjazogbWFrZSBzdXJlIHRoZSByZW1haW5kZXIgaXMgbGVzcyBvciBlcXVhbCB0byB3aGF0IHdhcyBzZW50IHRvIHVzCiAgICAgICAgcmVxdWlyZSh3ZWlSZW1haW5kZXIgPD0gbXNnLnZhbHVlKTsKCiAgICAgICAgLy8gQ2hlY2sgd2hldGhlciBpbiBwcmVzYWxlIG9yIHNhbGUKICAgICAgICBpZiAodGltZU9mUmVxdWVzdCA8PSBwcmVTYWxlLmVuZCkgewogICAgICAgICAgICByZXF1aXJlKHRva2VuQW1vdW50IDw9IHByZVNhbGUudG9rZW5zKTsKICAgICAgICAgICAgcmVxdWlyZShib251cyA8PSBzYWxlLnRva2Vucyk7CiAgICAgICAgICAgIHByZVNhbGUudG9rZW5zIC09IHRva2VuQW1vdW50OwogICAgICAgICAgICBzYWxlLnRva2VucyAtPSBib251czsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXF1aXJlKHRva2VuQW1vdW50IDw9IHNhbGUudG9rZW5zKTsKICAgICAgICAgICAgLy8gdGhlcmUgc2hvdWxkIGJlIG5vIGJvbnVzIGF2YWlsYWJsZSBhZnRlciBwcmVzYWxlCiAgICAgICAgICAgIHJlcXVpcmUoYm9udXMgPT0gMCk7IAogICAgICAgICAgICBzYWxlLnRva2VucyAtPSB0b2tlbkFtb3VudDsKICAgICAgICB9CgogICAgICAgIC8vIHNldHVwIG5ldyBjb250cmlidXRpb24KICAgICAgICBhZGRDb250cmlidXRpb24obXNnLnNlbmRlciwgbXNnLnZhbHVlIC0gd2VpUmVtYWluZGVyLCB0b2tlbkFtb3VudCArIGJvbnVzKTsKCiAgICAgICAgLy8vIFRyYW5zZmVyIGNvbnRyaWJ1dGlvbiBhbW91bnQgdG8gb3duZXIKICAgICAgICBvd25lci50cmFuc2Zlcihtc2cudmFsdWUgLSB3ZWlSZW1haW5kZXIpOwogICAgICAgIC8vIFJldHVybiB0aGUgcmVtYWluZGVyIHRvIHRoZSBzZW5kZXIKICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHdlaVJlbWFpbmRlcik7CgogICAgICAgIC8vIFNpbmNlIHdlIHJlZnVuZGVkIHRoZSByZW1haW5kZXIsIHRoZSBhY3R1YWwgY29udHJpYnV0aW9uIGlzIHRoZSBhbW91bnQgc2VudAogICAgICAgIC8vIG1pbnVzIHRoZSByZW1haW5kZXIKICAgICAgICAKICAgICAgICAvLyBSZWNvcmQgdGhlIGV2ZW50CiAgICAgICAgQ29udHJpYnV0ZShtc2cuc2VuZGVyLCBtc2cudmFsdWUgLSB3ZWlSZW1haW5kZXIsIHRva2VuQW1vdW50ICsgYm9udXMpOwogICAgfSAKCiAgICAKICAgIC8vIEFsbG93IHRoZSBvd25lciB0byB3aXRoZHJhdyBhbGwgdGhlIHRva2VucyByZW1haW5pbmcgYWZ0ZXIgdGhlCiAgICAvLyBjcm93ZHNhbGUgaXMgb3ZlcgogICAgZnVuY3Rpb24gd2l0aGRyYXdUb2tlbnNSZW1haW5pbmcoKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIC8vIE9ubHkgdGhlIG93bmVyIGNhbiBkbyB0aGlzCiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICAvLyBUaGUgY3Jvd3NhbGUgbXVzdCBiZSBvdmVyIHRvIHBlcmZvcm0gdGhpcyBvcGVyYXRpb24KICAgICAgICByZXF1aXJlKGJsb2NrLnRpbWVzdGFtcCA+IHNhbGUuZW5kKTsKICAgICAgICAvLyBHZXQgdGhlIHJlbWFpbmluZyB0b2tlbnMgb3duZWQgYnkgdGhlIGNyb3dkc2FsZQogICAgICAgIHVpbnQgdG9rZW5Ub1NlbmQgPSB0b2tlbnNSZW1haW5pbmdGb3JTYWxlOwogICAgICAgIC8vIFNldCBhdmFpbGFibGUgdG9rZW5zIHRvIFplcm8KICAgICAgICB0b2tlbnNSZW1haW5pbmdGb3JTYWxlID0gMDsKICAgICAgICBzYWxlLnRva2VucyA9IDA7CiAgICAgICAgLy8gVHJhbnNmZXIgdGhlbSBhbGwgdG8gdGhlIG93bmVyCiAgICAgICAgYm9vbCByZXN1bHQgPSB0b2tlbldhbGxldC50cmFuc2Zlcihvd25lciwgdG9rZW5Ub1NlbmQpOwogICAgICAgIC8vIEJlIHN1cmUgdGhhdCB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bGwKICAgICAgICByZXF1aXJlKHJlc3VsdCA9PSB0cnVlKTsKICAgICAgICBEaXN0cmlidXRlKG93bmVyLCB0b2tlblRvU2VuZCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gQWxsb3cgdGhlIG93bmVyIHRvIHdpdGhkcmF3IGFsbCBldGhlciBmcm9tIHRoZSBjb250cmFjdCBhZnRlciB0aGUgY3Jvd2RzYWxlIGlzIG92ZXIuCiAgICAvLyBXZSBkb24ndCBuZWVkIHRoaXMgZnVuY3Rpb24oIHdlIHRyYW5zZmVyIGV0aGVyIGltbWVkaWF0ZWx5IHRvIG93bmVyIC0ganVzdCBpbiBjYXNlCiAgICBmdW5jdGlvbiB3aXRoZHJhd0V0aGVyUmVtYWluaW5nKCkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICAvLyBPbmx5IHRoZSBvd25lciBjYW4gZG8gdGhpcwogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgLy8gVGhlIGNyb3dzYWxlIG11c3QgYmUgb3ZlciB0byBwZXJmb3JtIHRoaXMgb3BlcmF0aW9uCiAgICAgICAgcmVxdWlyZShibG9jay50aW1lc3RhbXAgPiBzYWxlLmVuZCk7CgogICAgICAgIC8vIFRyYW5zZmVyIHRoZW0gYWxsIHRvIHRoZSBvd25lcgogICAgICAgIG93bmVyLnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gdGhpcyBmdW5jdGlvbiBpcyBpbnRlbnRpb25hbGx5IGludGVybmFsIGJlY2F1c2Ugd2UgZG8gbm90IGNoZWNrIGNvbmRpdGlvbnMgaGVyZQogICAgZnVuY3Rpb24gdHJhbnNmZXJUb2tlbnNUb0NvbnRyaWJ1dG9yKHVpbnQgaWR4KSBwcml2YXRlIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAocGF5bWVudHNbcGF5bWVudEFkZHJlc3Nlc1tpZHhdXS50b3RhbFJlY2VpdmVUb2tlbnMgPiAwKSB7CiAgICAgICAgICAgIC8vIHRoaXMgaXMgZm9yIHJhY2UgY29uZGl0aW9ucyAgICAgICAgICAgICAgIAogICAgICAgICAgICB1aW50IHRva2VuVG9TZW5kID0gcGF5bWVudHNbcGF5bWVudEFkZHJlc3Nlc1tpZHhdXS50b3RhbFJlY2VpdmVUb2tlbnM7CiAgICAgICAgICAgIHBheW1lbnRzW3BheW1lbnRBZGRyZXNzZXNbaWR4XV0udG90YWxSZWNlaXZlVG9rZW5zID0gMDsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vZGVjcmVtZW50IGF3YXJkZWQgdG9rZW4KICAgICAgICAgICAgcmVxdWlyZSh0b2tlbnNBd2FyZGVkRm9yU2FsZSA+PSB0b2tlblRvU2VuZCk7CiAgICAgICAgICAgIHRva2Vuc0F3YXJkZWRGb3JTYWxlIC09IHRva2VuVG9TZW5kOwogICAgICAgICAgICAvLyBUcmFuc2ZlciB0aGVtIGFsbCB0byB0aGUgb3duZXIKICAgICAgICAgICAgYm9vbCByZXN1bHQgPSB0b2tlbldhbGxldC50cmFuc2ZlcihwYXltZW50QWRkcmVzc2VzW2lkeF0sIHRva2VuVG9TZW5kKTsKICAgICAgICAgICAgLy8gQmUgc3VyZSB0aGF0IHRyYW5zZmVyIHdhcyBzdWNjZXNzZnVsbAogICAgICAgICAgICByZXF1aXJlKHJlc3VsdCA9PSB0cnVlKTsKICAgICAgICAgICAgRGlzdHJpYnV0ZShwYXltZW50QWRkcmVzc2VzW2lkeF0sIHRva2VuVG9TZW5kKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CgogICAgfQogICAgCiAgICAvLyBnZXQgbnVtYmVyIG9mIHJlYWwgY29udHJpYnV0b3JzCiAgICBmdW5jdGlvbiBnZXROdW1iZXJPZkNvbnRyaWJ1dG9ycyggKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIHBheW1lbnRBZGRyZXNzZXMubGVuZ3RoOwogICAgfQogICAgCiAgICAvLyBUaGlzIGZ1bmN0aW9uIGZvciB0cmFuc2ZlciB0b2tlbnMgb25lIGJ5IG9uZQogICAgZnVuY3Rpb24gZGlzdHJpYnV0ZVRva2Vuc1RvQ29udHJpYnV0b3JCeUluZGV4KCB1aW50IGluZGV4VmFsKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIC8vIHRoaXMgaXMgcmVndWxhciBjaGVjayBmb3IgdGhpcyBmdW5jdGlvbgogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgcmVxdWlyZShibG9jay50aW1lc3RhbXAgPj0gZGlzdHJpYnV0aW9uVGltZSk7CiAgICAgICAgcmVxdWlyZShpbmRleFZhbCA8IHBheW1lbnRBZGRyZXNzZXMubGVuZ3RoKTsKICAgICAgICAKICAgICAgICB0cmFuc2ZlclRva2Vuc1RvQ29udHJpYnV0b3IoaW5kZXhWYWwpOyAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIHRydWU7ICAgICAgICAKICAgIH0KCiAgICBmdW5jdGlvbiBkaXN0cmlidXRlVG9rZW5zVG9Db250cmlidXRvciggdWludCBzdGFydEluZGV4LCB1aW50IG51bWJlck9mQ29udHJpYnV0b3JzIClwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIC8vIHRoaXMgaXMgcmVndWxhciBjaGVjayBmb3IgdGhpcyBmdW5jdGlvbgogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgcmVxdWlyZShibG9jay50aW1lc3RhbXAgPj0gZGlzdHJpYnV0aW9uVGltZSk7CiAgICAgICAgcmVxdWlyZShzdGFydEluZGV4IDwgcGF5bWVudEFkZHJlc3Nlcy5sZW5ndGgpOwogICAgICAgIAogICAgICAgIHVpbnQgbGVuID0gcGF5bWVudEFkZHJlc3Nlcy5sZW5ndGggPCBzdGFydEluZGV4ICsgbnVtYmVyT2ZDb250cmlidXRvcnM/IHBheW1lbnRBZGRyZXNzZXMubGVuZ3RoIDogc3RhcnRJbmRleCArIG51bWJlck9mQ29udHJpYnV0b3JzOwogICAgICAgIGZvciAodWludCBpID0gc3RhcnRJbmRleDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICAgIHRyYW5zZmVyVG9rZW5zVG9Db250cmlidXRvcihpKTsgICAgICAgICAgICAgICAgICAgIAogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsgICAgICAgIAogICAgfQoKICAgIGZ1bmN0aW9uIGRpc3RyaWJ1dGVBbGxUb2tlbnNUb0NvbnRyaWJ1dG9yKCApcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICAvLyB0aGlzIGlzIHJlZ3VsYXIgY2hlY2sgZm9yIHRoaXMgZnVuY3Rpb24KICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIHJlcXVpcmUoYmxvY2sudGltZXN0YW1wID49IGRpc3RyaWJ1dGlvblRpbWUpOwogICAgICAgIAogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IHBheW1lbnRBZGRyZXNzZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdHJhbnNmZXJUb2tlbnNUb0NvbnRyaWJ1dG9yKGkpOyAKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7ICAgICAgICAKICAgIH0KICAgIAogICAgLy8gT3duZXIgY2FuIHRyYW5zZmVyIG91dCBhbnkgYWNjaWRlbnRhbGx5IHNlbnQgRVJDMjAgdG9rZW5zIGFzIGxvbmcgYXMgdGhleSBhcmUgbm90IHRoZSBzYWxlIHRva2VucwogICAgZnVuY3Rpb24gdHJhbnNmZXJBbnlFUkMyMFRva2VuKGFkZHJlc3MgdG9rZW5BZGRyZXNzLCB1aW50IHRva2VucykgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIHJlcXVpcmUodG9rZW5BZGRyZXNzICE9IGFkZHJlc3ModG9rZW5XYWxsZXQpKTsKICAgICAgICByZXR1cm4gRVJDMjBJbnRlcmZhY2UodG9rZW5BZGRyZXNzKS50cmFuc2Zlcihvd25lciwgdG9rZW5zKTsKICAgIH0KfQ=='.
	

]
