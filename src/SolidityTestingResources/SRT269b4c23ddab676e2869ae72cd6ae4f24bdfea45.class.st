Class {
	#name : #SRT269b4c23ddab676e2869ae72cd6ae4f24bdfea45,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT269b4c23ddab676e2869ae72cd6ae4f24bdfea45 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IGMgPSBhICogYjsKICAgICAgICBpZiAoYSAhPSAwICYmIGMgLyBhICE9IGIpIHJldmVydCgpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgaWYgKGIgPiBhKSByZXZlcnQoKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSArIGI7CiAgICAgICAgaWYgKGMgPCBhKSByZXZlcnQoKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KfQoKY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CgogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCi8qKgogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKi8KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CgogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCi8qKgogKiBAdGl0bGUgQmFzaWMgdG9rZW4KICogQGRldiBCYXNpYyB2ZXJzaW9uIG9mIFN0YW5kYXJkVG9rZW4sIHdpdGggbm8gYWxsb3dhbmNlcy4KICovCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAgIC8qKgogICAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CgogICAgICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAgICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgICAqLwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9Cgp9CgovKioKICogQHRpdGxlIFN0YW5kYXJkIEVSQzIwIHRva2VuCiAqCiAqIEBkZXYgSW1wbGVtZW50YXRpb24gb2YgdGhlIGJhc2ljIHN0YW5kYXJkIHRva2VuLgogKiBAZGV2IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgRmlyc3RCbG9vZDogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sCiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CgoKICAgIC8qKgogICAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICB1aW50MjU2IF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKCiAgICAgICAgLy8gQ2hlY2sgaXMgbm90IG5lZWRlZCBiZWNhdXNlIHN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0CiAgICAgICAgLy8gcmVxdWlyZSAoX3ZhbHVlIDw9IF9hbGxvd2FuY2UpOwoKICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBfYWxsb3dhbmNlLnN1YihfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgICAqCiAgICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAgICovCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQoKICAgIC8qKgogICAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgICAqLwogICAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICAgICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgICAgICB9CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCn0KCgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKICAgIC8qKgogICAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICAgKiBhY2NvdW50LgogICAgICovCiAgICBmdW5jdGlvbiBPd25hYmxlKCkgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgICAqLwogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgIH0KCn0KCi8qKgogKiBAdGl0bGUgUGF1c2FibGUKICogQGRldiBCYXNlIGNvbnRyYWN0IHdoaWNoIGFsbG93cyBjaGlsZHJlbiB0byBpbXBsZW1lbnQgYW4gZW1lcmdlbmN5IHN0b3AgbWVjaGFuaXNtLgogKi8KY29udHJhY3QgUGF1c2FibGUgaXMgT3duYWJsZSB7CiAgICBldmVudCBQYXVzZSgpOwoKICAgIGV2ZW50IFVucGF1c2UoKTsKCiAgICBib29sIHB1YmxpYyBwYXVzZWQgPSBmYWxzZTsKCgogICAgLyoqCiAgICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIG5vdCBwYXVzZWQuCiAgICAgKi8KICAgIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICAgICAgcmVxdWlyZSghcGF1c2VkKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBwYXVzZWQuCiAgICAgKi8KICAgIG1vZGlmaWVyIHdoZW5QYXVzZWQoKSB7CiAgICAgICAgcmVxdWlyZShwYXVzZWQpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gcGF1c2UsIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUKICAgICAqLwogICAgZnVuY3Rpb24gcGF1c2UoKSBvbmx5T3duZXIgd2hlbk5vdFBhdXNlZCBwdWJsaWMgewogICAgICAgIHBhdXNlZCA9IHRydWU7CiAgICAgICAgUGF1c2UoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byB1bnBhdXNlLCByZXR1cm5zIHRvIG5vcm1hbCBzdGF0ZQogICAgICovCiAgICBmdW5jdGlvbiB1bnBhdXNlKCkgb25seU93bmVyIHdoZW5QYXVzZWQgcHVibGljIHsKICAgICAgICBwYXVzZWQgPSBmYWxzZTsKICAgICAgICBVbnBhdXNlKCk7CiAgICB9Cn0KCi8qKgogKiBAdGl0bGUgSVJCVG9rZW5zCiAqIEBkZXYgSVJCIFRva2VuIGNvbnRyYWN0IGJhc2VkIG9uIFplcHBlbGluIFN0YW5kYXJkVG9rZW4gY29udHJhY3QKICovCmNvbnRyYWN0IElSQlRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIE93bmFibGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgLyoqCiAgICAgKiBAZGV2IEVSQzIwIGRlc2NyaXB0b3IgdmFyaWFibGVzCiAgICAgKi8KICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJJUkIgVG9rZW5zIjsKCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJJUkIiOwoKICAgIHVpbnQ4IHB1YmxpYyBkZWNpbWFscyA9IDE4OwoKICAgIC8qKgogICAgICogQGRldiA0ODkuNTggbWlsbGlvbnMgcyB0aGUgaW5pdGlhbCBUb2tlbiBzYWxlCiAgICAgKi8KICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IGNyb3dkc2FsZVRva2VucyA9IDQ4OTU4MCAqIDEwICoqIDIxOwoKICAgIC8qKgogICAgICogQGRldiAxMC40MiBtaWxsaW9ucyBpcyB0aGUgaW5pdGlhbCBUb2tlbiBwcmVzYWxlCiAgICAgKi8KICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IHByZUNyb3dkc2FsZVRva2VucyA9IDEwNDIwICogMTAgKiogMjE7CgogICAgLy8gVE9ETzogVGVzdFJQQyBhZGRyZXNzZXMsIHJlcGxhY2UgdG8gcmVhbAogICAgLy8gUFJFIENyb3dkc2FsZSBUb2tlbnMgV2FsbGV0CiAgICBhZGRyZXNzIHB1YmxpYyBjb25zdGFudCBwcmVDcm93ZHNhbGVUb2tlbnNXYWxsZXQgPSAweDBDRDk1YTU5ZkFkMDg5YzRFQkNDRUI1NGYzMzVlQzhmNjFDYWE4MGU7CiAgICAvLyBDcm93ZHNhbGUgVG9rZW5zIFdhbGxldAogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgY3Jvd2RzYWxlVG9rZW5zV2FsbGV0ID0gMHg0ODU0NUU0MTY5NkRjNTEwMjBDMzVjQThDMzZiNjc4MTAxYTk4NDM3OwoKICAgIC8qKgogICAgICogQGRldiBBZGRyZXNzIG9mIFBSRSBDcm93ZHNhbGUgY29udHJhY3Qgd2hpY2ggd2lsbCBiZSBjb21wYXJlZAogICAgICogICAgICAgYWdhaW5zdCBpbiB0aGUgYXBwcm9wcmlhdGUgbW9kaWZpZXIgY2hlY2sKICAgICAqLwogICAgYWRkcmVzcyBwdWJsaWMgcHJlQ3Jvd2RzYWxlQ29udHJhY3RBZGRyZXNzOwoKICAgIC8qKgogICAgICogQGRldiBBZGRyZXNzIG9mIENyb3dkc2FsZSBjb250cmFjdCB3aGljaCB3aWxsIGJlIGNvbXBhcmVkCiAgICAgKiAgICAgICBhZ2FpbnN0IGluIHRoZSBhcHByb3ByaWF0ZSBtb2RpZmllciBjaGVjawogICAgICovCiAgICBhZGRyZXNzIHB1YmxpYyBjcm93ZHNhbGVDb250cmFjdEFkZHJlc3M7CgogICAgLyoqCiAgICAgKiBAZGV2IHZhcmlhYmxlIHRoYXQgaG9sZHMgZmxhZyBvZiBlbmRlZCBwcmUgdG9rZW5zYWtlCiAgICAgKi8KICAgIGJvb2wgaXNQcmVGaW5pc2hlZCA9IGZhbHNlOwoKICAgIC8qKgogICAgICogQGRldiB2YXJpYWJsZSB0aGF0IGhvbGRzIGZsYWcgb2YgZW5kZWQgdG9rZW5zYWtlCiAgICAgKi8KICAgIGJvb2wgaXNGaW5pc2hlZCA9IGZhbHNlOwoKICAgIC8qKgogICAgICogQGRldiBNb2RpZmllciB0aGF0IGFsbG93IG9ubHkgdGhlIENyb3dkc2FsZSBjb250cmFjdCB0byBiZSBzZW5kZXIKICAgICAqLwogICAgbW9kaWZpZXIgb25seVByZUNyb3dkc2FsZUNvbnRyYWN0KCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBwcmVDcm93ZHNhbGVDb250cmFjdEFkZHJlc3MpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IE1vZGlmaWVyIHRoYXQgYWxsb3cgb25seSB0aGUgQ3Jvd2RzYWxlIGNvbnRyYWN0IHRvIGJlIHNlbmRlcgogICAgICovCiAgICBtb2RpZmllciBvbmx5Q3Jvd2RzYWxlQ29udHJhY3QoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNyb3dkc2FsZUNvbnRyYWN0QWRkcmVzcyk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgZXZlbnQgZm9yIHRoZSBidXJudCB0b2tlbnMgYWZ0ZXIgY3Jvd2RzYWxlIGxvZ2dpbmcKICAgICAqIEBwYXJhbSB0b2tlbnMgYW1vdW50IG9mIHRva2VucyBhdmFpbGFibGUgZm9yIGNyb3dkc2FsZQogICAgICovCiAgICBldmVudCBUb2tlbnNCdXJudCh1aW50MjU2IHRva2Vucyk7CgogICAgLyoqCiAgICAgKiBAZGV2IGV2ZW50IGZvciB0aGUgdG9rZW5zIGNvbnRyYWN0IG1vdmUgdG8gdGhlIGFjdGl2ZSBzdGF0ZSBsb2dnaW5nCiAgICAgKiBAcGFyYW0gc3VwcGx5IGFtb3VudCBvZiB0b2tlbnMgbGVmdCBhZnRlciBhbGwgdGhlIHVuc29sZCB3YXMgYnVybmVkCiAgICAgKi8KICAgIGV2ZW50IExpdmUodWludDI1NiBzdXBwbHkpOwoKICAgIC8qKgogICAgICogQGRldiBDb250cmFjdCBjb25zdHJ1Y3RvcgogICAgICovCiAgICBmdW5jdGlvbiBJUkJUb2tlbigpIHsKICAgICAgICAvLyBJc3N1ZSBwcmUgY3Jvd2RzYWxlIHRva2VucwogICAgICAgIGJhbGFuY2VzW3ByZUNyb3dkc2FsZVRva2Vuc1dhbGxldF0gPSBiYWxhbmNlT2YocHJlQ3Jvd2RzYWxlVG9rZW5zV2FsbGV0KS5hZGQocHJlQ3Jvd2RzYWxlVG9rZW5zKTsKICAgICAgICBUcmFuc2ZlcihhZGRyZXNzKDApLCBwcmVDcm93ZHNhbGVUb2tlbnNXYWxsZXQsIHByZUNyb3dkc2FsZVRva2Vucyk7CgogICAgICAgIC8vIElzc3VlIGNyb3dkc2FsZSB0b2tlbnMKICAgICAgICBiYWxhbmNlc1tjcm93ZHNhbGVUb2tlbnNXYWxsZXRdID0gYmFsYW5jZU9mKGNyb3dkc2FsZVRva2Vuc1dhbGxldCkuYWRkKGNyb3dkc2FsZVRva2Vucyk7CiAgICAgICAgVHJhbnNmZXIoYWRkcmVzcygwKSwgY3Jvd2RzYWxlVG9rZW5zV2FsbGV0LCBjcm93ZHNhbGVUb2tlbnMpOwoKICAgICAgICAvLyA1MDAgbWlsbGlvbnMgdG9rZW5zIG92ZXJhbGwKICAgICAgICB0b3RhbFN1cHBseSA9IGNyb3dkc2FsZVRva2Vucy5hZGQocHJlQ3Jvd2RzYWxlVG9rZW5zKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgYmFjayBsaW5rIElSQlRva2VuIGNvbnRyYWN0IHdpdGggSVJCUHJlQ3Jvd2RzYWxlIG9uZQogICAgICogQHBhcmFtIF9wcmVDcm93ZHNhbGVBZGRyZXNzIG5vbiB6ZXJvIGFkZHJlc3Mgb2YgSVJCUHJlQ3Jvd2RzYWxlIGNvbnRyYWN0CiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldFByZUNyb3dkc2FsZUFkZHJlc3MoYWRkcmVzcyBfcHJlQ3Jvd2RzYWxlQWRkcmVzcykgb25seU93bmVyIGV4dGVybmFsIHsKICAgICAgICByZXF1aXJlKF9wcmVDcm93ZHNhbGVBZGRyZXNzICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHByZUNyb3dkc2FsZUNvbnRyYWN0QWRkcmVzcyA9IF9wcmVDcm93ZHNhbGVBZGRyZXNzOwoKICAgICAgICAvLyBBbGxvdyBwcmUgY3Jvd2RzYWxlIGNvbnRyYWN0CiAgICAgICAgdWludDI1NiBiYWxhbmNlID0gYmFsYW5jZU9mKHByZUNyb3dkc2FsZVRva2Vuc1dhbGxldCk7CiAgICAgICAgYWxsb3dlZFtwcmVDcm93ZHNhbGVUb2tlbnNXYWxsZXRdW3ByZUNyb3dkc2FsZUNvbnRyYWN0QWRkcmVzc10gPSBiYWxhbmNlOwogICAgICAgIEFwcHJvdmFsKHByZUNyb3dkc2FsZVRva2Vuc1dhbGxldCwgcHJlQ3Jvd2RzYWxlQ29udHJhY3RBZGRyZXNzLCBiYWxhbmNlKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgYmFjayBsaW5rIElSQlRva2VuIGNvbnRyYWN0IHdpdGggSVJCQ3Jvd2RzYWxlIG9uZQogICAgICogQHBhcmFtIF9jcm93ZHNhbGVBZGRyZXNzIG5vbiB6ZXJvIGFkZHJlc3Mgb2YgSVJCQ3Jvd2RzYWxlIGNvbnRyYWN0CiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldENyb3dkc2FsZUFkZHJlc3MoYWRkcmVzcyBfY3Jvd2RzYWxlQWRkcmVzcykgb25seU93bmVyIGV4dGVybmFsIHsKICAgICAgICByZXF1aXJlKGlzUHJlRmluaXNoZWQpOwogICAgICAgIHJlcXVpcmUoX2Nyb3dkc2FsZUFkZHJlc3MgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgY3Jvd2RzYWxlQ29udHJhY3RBZGRyZXNzID0gX2Nyb3dkc2FsZUFkZHJlc3M7CgogICAgICAgIC8vIEFsbG93IGNyb3dkc2FsZSBjb250cmFjdAogICAgICAgIHVpbnQyNTYgYmFsYW5jZSA9IGJhbGFuY2VPZihjcm93ZHNhbGVUb2tlbnNXYWxsZXQpOwogICAgICAgIGFsbG93ZWRbY3Jvd2RzYWxlVG9rZW5zV2FsbGV0XVtjcm93ZHNhbGVDb250cmFjdEFkZHJlc3NdID0gYmFsYW5jZTsKICAgICAgICBBcHByb3ZhbChjcm93ZHNhbGVUb2tlbnNXYWxsZXQsIGNyb3dkc2FsZUNvbnRyYWN0QWRkcmVzcywgYmFsYW5jZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGNhbGxlZCBvbmx5IGJ5IGxpbmtlZCBJUkJQcmVDcm93ZHNhbGUgY29udHJhY3QgdG8gZW5kIHByZWNyb3dkc2FsZS4KICAgICAqLwogICAgZnVuY3Rpb24gZW5kUHJlVG9rZW5zYWxlKCkgb25seVByZUNyb3dkc2FsZUNvbnRyYWN0IGV4dGVybmFsIHsKICAgICAgICByZXF1aXJlKCFpc1ByZUZpbmlzaGVkKTsKICAgICAgICB1aW50MjU2IHByZUNyb3dkc2FsZUxlZnRvdmVycyA9IGJhbGFuY2VPZihwcmVDcm93ZHNhbGVUb2tlbnNXYWxsZXQpOwoKICAgICAgICBpZiAocHJlQ3Jvd2RzYWxlTGVmdG92ZXJzID4gMCkgewogICAgICAgICAgICBiYWxhbmNlc1twcmVDcm93ZHNhbGVUb2tlbnNXYWxsZXRdID0gMDsKICAgICAgICAgICAgYmFsYW5jZXNbY3Jvd2RzYWxlVG9rZW5zV2FsbGV0XSA9IGJhbGFuY2VzW2Nyb3dkc2FsZVRva2Vuc1dhbGxldF0uYWRkKHByZUNyb3dkc2FsZUxlZnRvdmVycyk7CiAgICAgICAgICAgIFRyYW5zZmVyKHByZUNyb3dkc2FsZVRva2Vuc1dhbGxldCwgY3Jvd2RzYWxlVG9rZW5zV2FsbGV0LCBwcmVDcm93ZHNhbGVMZWZ0b3ZlcnMpOwogICAgICAgIH0KCiAgICAgICAgaXNQcmVGaW5pc2hlZCA9IHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGNhbGxlZCBvbmx5IGJ5IGxpbmtlZCBJUkJDcm93ZHNhbGUgY29udHJhY3QgdG8gZW5kIGNyb3dkc2FsZS4KICAgICAqLwogICAgZnVuY3Rpb24gZW5kVG9rZW5zYWxlKCkgb25seUNyb3dkc2FsZUNvbnRyYWN0IGV4dGVybmFsIHsKICAgICAgICByZXF1aXJlKCFpc0ZpbmlzaGVkKTsKICAgICAgICB1aW50MjU2IGNyb3dkc2FsZUxlZnRvdmVycyA9IGJhbGFuY2VPZihjcm93ZHNhbGVUb2tlbnNXYWxsZXQpOwoKICAgICAgICBpZiAoY3Jvd2RzYWxlTGVmdG92ZXJzID4gMCkgewogICAgICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LnN1Yihjcm93ZHNhbGVMZWZ0b3ZlcnMpOwoKICAgICAgICAgICAgYmFsYW5jZXNbY3Jvd2RzYWxlVG9rZW5zV2FsbGV0XSA9IDA7CiAgICAgICAgICAgIFRyYW5zZmVyKGNyb3dkc2FsZVRva2Vuc1dhbGxldCwgYWRkcmVzcygwKSwgY3Jvd2RzYWxlTGVmdG92ZXJzKTsKICAgICAgICAgICAgVG9rZW5zQnVybnQoY3Jvd2RzYWxlTGVmdG92ZXJzKTsKICAgICAgICB9CgogICAgICAgIGlzRmluaXNoZWQgPSB0cnVlOwogICAgICAgIExpdmUodG90YWxTdXBwbHkpOwogICAgfQp9CgoKLyoqCiAqIEB0aXRsZSBSZWZ1bmRWYXVsdC4KICogQGRldiBUaGlzIGNvbnRyYWN0IGlzIHVzZWQgZm9yIHN0b3JpbmcgZnVuZHMgd2hpbGUgYSBjcm93ZHNhbGUKICogaXMgaW4gcHJvZ3Jlc3MuIFN1cHBvcnRzIHJlZnVuZGluZyB0aGUgbW9uZXkgaWYgY3Jvd2RzYWxlIGZhaWxzLAogKiBhbmQgZm9yd2FyZGluZyBpdCBpZiBjcm93ZHNhbGUgaXMgc3VjY2Vzc2Z1bC4KICovCmNvbnRyYWN0IElSQlByZVJlZnVuZFZhdWx0IGlzIE93bmFibGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgZW51bSBTdGF0ZSB7QWN0aXZlLCBSZWZ1bmRpbmcsIENsb3NlZH0KICAgIFN0YXRlIHB1YmxpYyBzdGF0ZTsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBkZXBvc2l0ZWQ7CgogICAgdWludDI1NiBwdWJsaWMgdG90YWxEZXBvc2l0ZWQ7CgogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgd2FsbGV0ID0gMHgyNmRCOWVGMzlCYmZlNDM3ZjViMzg0YzM5MTNFODA3ZTU2MzNFN2NFOwoKICAgIGFkZHJlc3MgcHJlQ3Jvd2RzYWxlQ29udHJhY3RBZGRyZXNzOwoKICAgIGV2ZW50IENsb3NlZCgpOwoKICAgIGV2ZW50IFJlZnVuZHNFbmFibGVkKCk7CgogICAgZXZlbnQgUmVmdW5kZWQoYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHdlaUFtb3VudCk7CgogICAgZXZlbnQgV2l0aGRyYXdhbChhZGRyZXNzIGluZGV4ZWQgcmVjZWl2ZXIsIHVpbnQyNTYgd2VpQW1vdW50KTsKCiAgICBmdW5jdGlvbiBJUkJQcmVSZWZ1bmRWYXVsdCgpIHsKICAgICAgICBzdGF0ZSA9IFN0YXRlLkFjdGl2ZTsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5Q3Jvd2RzYWxlQ29udHJhY3QoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHByZUNyb3dkc2FsZUNvbnRyYWN0QWRkcmVzcyk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRQcmVDcm93ZHNhbGVBZGRyZXNzKGFkZHJlc3MgX3ByZUNyb3dkc2FsZUFkZHJlc3MpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShfcHJlQ3Jvd2RzYWxlQWRkcmVzcyAhPSBhZGRyZXNzKDApKTsKICAgICAgICBwcmVDcm93ZHNhbGVDb250cmFjdEFkZHJlc3MgPSBfcHJlQ3Jvd2RzYWxlQWRkcmVzczsKICAgIH0KCiAgICBmdW5jdGlvbiBkZXBvc2l0KGFkZHJlc3MgaW52ZXN0b3IpIG9ubHlDcm93ZHNhbGVDb250cmFjdCBleHRlcm5hbCBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLkFjdGl2ZSk7CiAgICAgICAgdWludDI1NiBhbW91bnQgPSBtc2cudmFsdWU7CiAgICAgICAgZGVwb3NpdGVkW2ludmVzdG9yXSA9IGRlcG9zaXRlZFtpbnZlc3Rvcl0uYWRkKGFtb3VudCk7CiAgICAgICAgdG90YWxEZXBvc2l0ZWQgPSB0b3RhbERlcG9zaXRlZC5hZGQoYW1vdW50KTsKICAgIH0KCiAgICBmdW5jdGlvbiBjbG9zZSgpIG9ubHlDcm93ZHNhbGVDb250cmFjdCBleHRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5BY3RpdmUpOwogICAgICAgIHN0YXRlID0gU3RhdGUuQ2xvc2VkOwogICAgICAgIHRvdGFsRGVwb3NpdGVkID0gMDsKICAgICAgICBDbG9zZWQoKTsKICAgICAgICB3YWxsZXQudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBlbmFibGVSZWZ1bmRzKCkgb25seUNyb3dkc2FsZUNvbnRyYWN0IGV4dGVybmFsIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLkFjdGl2ZSk7CiAgICAgICAgc3RhdGUgPSBTdGF0ZS5SZWZ1bmRpbmc7CiAgICAgICAgUmVmdW5kc0VuYWJsZWQoKTsKICAgIH0KCiAgICBmdW5jdGlvbiByZWZ1bmQoYWRkcmVzcyBpbnZlc3RvcikgcHVibGljIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLlJlZnVuZGluZyk7CiAgICAgICAgdWludDI1NiBkZXBvc2l0ZWRWYWx1ZSA9IGRlcG9zaXRlZFtpbnZlc3Rvcl07CiAgICAgICAgZGVwb3NpdGVkW2ludmVzdG9yXSA9IDA7CiAgICAgICAgaW52ZXN0b3IudHJhbnNmZXIoZGVwb3NpdGVkVmFsdWUpOwogICAgICAgIFJlZnVuZGVkKGludmVzdG9yLCBkZXBvc2l0ZWRWYWx1ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IHdpdGhkcmF3IG1ldGhvZCB0aGF0IGNhbiBiZSB1c2VkIGJ5IGNyb3dkc2FsZSBjb250cmFjdCdzIG93bmVyCiAgICAgKiAgICAgIGZvciB0aGUgd2l0aGRyYXdhbCBmdW5kcyB0byB0aGUgb3duZXIKICAgICAqLwogICAgZnVuY3Rpb24gd2l0aGRyYXcodWludCB2YWx1ZSkgb25seUNyb3dkc2FsZUNvbnRyYWN0IGV4dGVybmFsIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuQWN0aXZlKTsKICAgICAgICByZXF1aXJlKHRvdGFsRGVwb3NpdGVkID49IHZhbHVlKTsKICAgICAgICB0b3RhbERlcG9zaXRlZCA9IHRvdGFsRGVwb3NpdGVkLnN1Yih2YWx1ZSk7CiAgICAgICAgd2FsbGV0LnRyYW5zZmVyKHZhbHVlKTsKICAgICAgICBXaXRoZHJhd2FsKHdhbGxldCwgdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBraWxsZXIgbWV0aG9kIHRoYXQgY2FuIGJlIHVzZWQgYnkgb3duZXIgdG8KICAgICAqICAgICAga2lsbCB0aGUgY29udHJhY3QgYW5kIHNlbmQgZnVuZHMgdG8gb3duZXIKICAgICAqLwogICAgZnVuY3Rpb24ga2lsbCgpIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5DbG9zZWQpOwogICAgICAgIHNlbGZkZXN0cnVjdChvd25lcik7CiAgICB9Cn0KCgoKLyoqCiAqIEB0aXRsZSBJUkJQcmVDcm93ZHNhbGUKICogQGRldiBJUkIgcHJlIGNyb3dkc2FsZSBjb250cmFjdCBib3Jyb3dzIFplcHBlbGluIEZpbmFsaXplZCwgQ2FwcGVkIGFuZCBSZWZ1bmRhYmxlIGNyb3dkc2FsZXMgaW1wbGVtZW50YXRpb25zCiAqLwpjb250cmFjdCBJUkJQcmVDcm93ZHNhbGUgaXMgT3duYWJsZSwgUGF1c2FibGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CgogICAgLyoqCiAgICAgKiBAZGV2IHRva2VuIGNvbnRyYWN0CiAgICAgKi8KICAgIElSQlRva2VuIHB1YmxpYyB0b2tlbjsKCiAgICAvKioKICAgICAqIEBkZXYgcmVmdW5kIHZhdWx0IHVzZWQgdG8gaG9sZCBmdW5kcyB3aGlsZSBjcm93ZHNhbGUgaXMgcnVubmluZwogICAgICovCiAgICBJUkJQcmVSZWZ1bmRWYXVsdCBwdWJsaWMgdmF1bHQ7CgogICAgLyoqCiAgICAgKiBAZGV2IHRva2Vuc2FsZShwcmVzYWxlKSBzdGFydCB0aW1lOiBEZWMgMTIsIDIwMTcsIDExOjAwOjAwICsgMwogICAgICovCiAgICB1aW50IHN0YXJ0VGltZSA9IDE1MTMwNjU2MDA7CgogICAgLyoqCiAgICAgKiBAZGV2IHRva2Vuc2FsZSBlbmQgdGltZTogSmFuIDE0LCAyMDE4IDIzOjU5OjU5ICszCiAgICAgKi8KICAgIHVpbnQgZW5kVGltZSA9IDE1MTU5NjM1OTk7CgogICAgLyoqCiAgICAgKiBAZGV2IG1pbmltdW0gcHVyY2hhc2UgYW1vdW50IGZvciBwcmVzYWxlCiAgICAgKi8KICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IG1pblByZXNhbGVBbW91bnQgPSAxMDggKiAxMCAqKiAxNTsgLy8gNDAwIElSQgoKICAgIC8qKgogICAgICogQGRldiBtaW5pbXVtIGFuZCBtYXhpbXVtIGFtb3VudCBvZiBmdW5kcyB0byBiZSByYWlzZWQgaW4gd2VpcwogICAgICovCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBnb2FsID0gMTEyNSAqIDEwICoqIDE4OyAgLy8gMS4xMjUgS2V0aGVyCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBjYXAgPSAyMjUwICogMTAgKiogMTg7IC8vIDIuMjUgS2V0aGVyCgogICAgLyoqCiAgICAgKiBAZGV2IGFtb3VudCBvZiByYWlzZWQgbW9uZXkgaW4gd2VpCiAgICAgKi8KICAgIHVpbnQyNTYgcHVibGljIHdlaVJhaXNlZDsKCiAgICAvKioKICAgICAqIEBkZXYgdG9rZW5zYWxlIGZpbmFsaXphdGlvbiBmbGFnCiAgICAgKi8KICAgIGJvb2wgcHVibGljIGlzRmluYWxpemVkID0gZmFsc2U7CgogICAgLyoqCiAgICAgKiBAZGV2IGV2ZW50IGZvciB0b2tlbiBwdXJjaGFzZSBsb2dnaW5nCiAgICAgKiBAcGFyYW0gcHVyY2hhc2VyIHdobyBwYWlkIGZvciB0aGUgdG9rZW5zCiAgICAgKiBAcGFyYW0gYmVuZWZpY2lhcnkgd2hvIGdvdCB0aGUgdG9rZW5zCiAgICAgKiBAcGFyYW0gdmFsdWUgd2VpcyBwYWlkIGZvciBwdXJjaGFzZQogICAgICogQHBhcmFtIGFtb3VudCBhbW91bnQgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAgICovCiAgICBldmVudCBUb2tlblB1cmNoYXNlKGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB2YWx1ZSwgdWludDI1NiBhbW91bnQpOwoKICAgIC8qKgogICAgICogQGRldiBldmVudCBmb3IgdG9rZW5zYWxlIGZpbmFsIGxvZ2dpbmcKICAgICAqLwogICAgZXZlbnQgRmluYWxpemVkKCk7CgogICAgLyoqCiAgICAgKiBAZGV2IFByZSBDcm93ZHNhbGUgaW4gdGhlIGNvbnN0cnVjdG9yIHRha2VzIGFkZHJlc3NlcyBvZgogICAgICogICAgICB0aGUganVzdCBkZXBsb3llZCBJUkJUb2tlbiBhbmQgSVJCUHJlUmVmdW5kVmF1bHQgY29udHJhY3RzCiAgICAgKiBAcGFyYW0gX3Rva2VuQWRkcmVzcyBhZGRyZXNzIG9mIHRoZSBJUkJUb2tlbiBkZXBsb3llZCBjb250cmFjdAogICAgICogQHBhcmFtIF92YXVsdEFkZHJlc3MgYWRkcmVzcyBvZiB0aGUgSVJCUHJlUmVmdW5kVmF1bHQgZGVwbG95ZWQgY29udHJhY3QKICAgICAqLwogICAgZnVuY3Rpb24gSVJCUHJlQ3Jvd2RzYWxlKGFkZHJlc3MgX3Rva2VuQWRkcmVzcywgYWRkcmVzcyBfdmF1bHRBZGRyZXNzKSB7CiAgICAgICAgcmVxdWlyZShfdG9rZW5BZGRyZXNzICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3ZhdWx0QWRkcmVzcyAhPSBhZGRyZXNzKDApKTsKCiAgICAgICAgLy8gSVJCVG9rZW4gYW5kIElSQlByZVJlZnVuZFZhdWx0IHdhcyBkZXBsb3llZCBzZXBhcmF0ZWx5CiAgICAgICAgdG9rZW4gPSBJUkJUb2tlbihfdG9rZW5BZGRyZXNzKTsKICAgICAgICB2YXVsdCA9IElSQlByZVJlZnVuZFZhdWx0KF92YXVsdEFkZHJlc3MpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBmYWxsYmFjayBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBidXkgdG9rZW5zCiAgICAgKi8KICAgIGZ1bmN0aW9uKCkgcGF5YWJsZSB7CiAgICAgICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBtYWluIGZ1bmN0aW9uIHRvIGJ1eSB0b2tlbnMKICAgICAqIEBwYXJhbSBiZW5lZmljaWFyeSB0YXJnZXQgd2FsbGV0IGZvciB0b2tlbnMgY2FuIHZhcnkgZnJvbSB0aGUgc2VuZGVyIG9uZQogICAgICovCiAgICBmdW5jdGlvbiBidXlUb2tlbnMoYWRkcmVzcyBiZW5lZmljaWFyeSkgd2hlbk5vdFBhdXNlZCBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZShiZW5lZmljaWFyeSAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKHZhbGlkUHVyY2hhc2UobXNnLnZhbHVlKSk7CgogICAgICAgIHVpbnQyNTYgd2VpQW1vdW50ID0gbXNnLnZhbHVlOwoKICAgICAgICAvLyBidXllciBhbmQgYmVuZWZpY2lhcnkgY291bGQgYmUgdHdvIGRpZmZlcmVudCB3YWxsZXRzCiAgICAgICAgYWRkcmVzcyBidXllciA9IG1zZy5zZW5kZXI7CgogICAgICAgIC8vIGNhbGN1bGF0ZSB0b2tlbiBhbW91bnQgdG8gYmUgY3JlYXRlZAogICAgICAgIHVpbnQyNTYgdG9rZW5zID0gY29udmVydEFtb3VudFRvVG9rZW5zKHdlaUFtb3VudCk7CgogICAgICAgIHdlaVJhaXNlZCA9IHdlaVJhaXNlZC5hZGQod2VpQW1vdW50KTsKCiAgICAgICAgaWYgKCF0b2tlbi50cmFuc2ZlckZyb20odG9rZW4ucHJlQ3Jvd2RzYWxlVG9rZW5zV2FsbGV0KCksIGJlbmVmaWNpYXJ5LCB0b2tlbnMpKSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KCiAgICAgICAgVG9rZW5QdXJjaGFzZShidXllciwgYmVuZWZpY2lhcnksIHdlaUFtb3VudCwgdG9rZW5zKTsKCiAgICAgICAgdmF1bHQuZGVwb3NpdC52YWx1ZSh3ZWlBbW91bnQpKGJ1eWVyKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgY2hlY2sgaWYgdGhlIGN1cnJlbnQgcHVyY2hhc2UgdmFsaWQgYmFzZWQgb24gdGltZSBhbmQgYW1vdW50IG9mIHBhc3NlZCBldGhlcgogICAgICogQHBhcmFtIF92YWx1ZSBhbW91bnQgb2YgcGFzc2VkIGV0aGVyCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgaW52ZXN0b3JzIGNhbiBidXkgYXQgdGhlIG1vbWVudAogICAgICovCiAgICBmdW5jdGlvbiB2YWxpZFB1cmNoYXNlKHVpbnQyNTYgX3ZhbHVlKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgYm9vbCBub25aZXJvUHVyY2hhc2UgPSBfdmFsdWUgIT0gMDsKICAgICAgICBib29sIHdpdGhpblBlcmlvZCA9IG5vdyA+PSBzdGFydFRpbWUgJiYgbm93IDw9IGVuZFRpbWU7CiAgICAgICAgYm9vbCB3aXRoaW5DYXAgPSB3ZWlSYWlzZWQuYWRkKF92YWx1ZSkgPD0gY2FwOwogICAgICAgIC8vIEZvciBwcmVzYWxlIHdlIHdhbnQgdG8gZGVjbGluZSBhbGwgcGF5bWVudHMgbGVzcyB0aGVuIG1pblByZXNhbGVBbW91bnQKICAgICAgICBib29sIHdpdGhpbkFtb3VudCA9IG1zZy52YWx1ZSA+PSBtaW5QcmVzYWxlQW1vdW50OwoKICAgICAgICByZXR1cm4gbm9uWmVyb1B1cmNoYXNlICYmIHdpdGhpblBlcmlvZCAmJiB3aXRoaW5DYXAgJiYgd2l0aGluQW1vdW50OwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBjaGVjayBpZiBjcm93ZHNhbGUgc3RpbGwgYWN0aXZlIGJhc2VkIG9uIGN1cnJlbnQgdGltZSBhbmQgY2FwCiAgICAgKiBjb25zaWRlciBtaW5QcmVzYWxlQW1vdW50CiAgICAgKiBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBlbmRlZAogICAgICovCiAgICBmdW5jdGlvbiBoYXNFbmRlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgYm9vbCBjYXBSZWFjaGVkID0gd2VpUmFpc2VkLmFkZChtaW5QcmVzYWxlQW1vdW50KSA+PSBjYXA7CiAgICAgICAgYm9vbCB0aW1lSXNVcCA9IG5vdyA+IGVuZFRpbWU7CiAgICAgICAgcmV0dXJuIHRpbWVJc1VwIHx8IGNhcFJlYWNoZWQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGlmIGNyb3dkc2FsZSBpcyB1bnN1Y2Nlc3NmdWwsIGludmVzdG9ycyBjYW4gY2xhaW0gcmVmdW5kcyBoZXJlCiAgICAgKi8KICAgIGZ1bmN0aW9uIGNsYWltUmVmdW5kKCkgcHVibGljIHsKICAgICAgICByZXF1aXJlKGlzRmluYWxpemVkKTsKICAgICAgICByZXF1aXJlKCFnb2FsUmVhY2hlZCgpKTsKCiAgICAgICAgdmF1bHQucmVmdW5kKG1zZy5zZW5kZXIpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBmaW5hbGl6ZSBjcm93ZHNhbGUuIHRoaXMgbWV0aG9kIHRyaWdnZXJzIHZhdWx0IGFuZCB0b2tlbiBmaW5hbGl6YXRpb24KICAgICAqLwogICAgZnVuY3Rpb24gZmluYWxpemUoKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKCFpc0ZpbmFsaXplZCk7CiAgICAgICAgcmVxdWlyZShoYXNFbmRlZCgpKTsKCiAgICAgICAgLy8gdHJpZ2dlciB2YXVsdCBhbmQgdG9rZW4gZmluYWxpemF0aW9uCiAgICAgICAgaWYgKGdvYWxSZWFjaGVkKCkpIHsKICAgICAgICAgICAgdmF1bHQuY2xvc2UoKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHZhdWx0LmVuYWJsZVJlZnVuZHMoKTsKICAgICAgICB9CgogICAgICAgIHRva2VuLmVuZFByZVRva2Vuc2FsZSgpOwoKICAgICAgICBpc0ZpbmFsaXplZCA9IHRydWU7CgogICAgICAgIEZpbmFsaXplZCgpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBjaGVjayBpZiBoYXJkIGNhcCBnb2FsIGlzIHJlYWNoZWQKICAgICAqLwogICAgZnVuY3Rpb24gZ29hbFJlYWNoZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiB3ZWlSYWlzZWQgPj0gZ29hbDsKICAgIH0KCiAgICAvKioKICAgICogQGRldiB3aXRoZHJhdyBtZXRob2QgdGhhdCBjYW4gYmUgdXNlZCBieSBvd25lciBmb3IKICAgICogICAgICB3aXRoZHJhdyBmdW5kcyBmcm9tIHZhdWx0IHRvIG93bmVyCiAgICAqLwogICAgZnVuY3Rpb24gd2l0aGRyYXcodWludDI1NiBhbW91bnQpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoIWlzRmluYWxpemVkKTsKICAgICAgICByZXF1aXJlKGdvYWxSZWFjaGVkKCkpOwogICAgICAgIHJlcXVpcmUoYW1vdW50ID4gMCk7CgogICAgICAgIHZhdWx0LndpdGhkcmF3KGFtb3VudCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IHJldHVybnMgY3VycmVudCB0b2tlbiBwcmljZQogICAgICovCiAgICBmdW5jdGlvbiBjb252ZXJ0QW1vdW50VG9Ub2tlbnModWludDI1NiBhbW91bnQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgLy8gMSB0b2tlbiA9IDAuMDAwMjcgRVRICiAgICAgICAgdWludDI1NiB0b2tlbnMgPSBhbW91bnQuZGl2KDI3KS5tdWwoMTAwMDAwKTsKICAgICAgICAvLyBib251cyArMjUlCiAgICAgICAgdWludDI1NiBib251cyA9IHRva2Vucy5kaXYoNCk7CgogICAgICAgIHJldHVybiB0b2tlbnMuYWRkKGJvbnVzKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYga2lsbGVyIG1ldGhvZCB0aGF0IGNhbiBidSB1c2VkIGJ5IG93bmVyIHRvCiAgICAgKiAgICAgIGtpbGwgdGhlIGNvbnRyYWN0IGFuZCBzZW5kIGZ1bmRzIHRvIG93bmVyCiAgICAgKi8KICAgIGZ1bmN0aW9uIGtpbGwoKSBvbmx5T3duZXIgd2hlblBhdXNlZCB7CiAgICAgICAgc2VsZmRlc3RydWN0KG93bmVyKTsKICAgIH0KfQ=='.
	

]
