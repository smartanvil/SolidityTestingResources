Class {
	#name : #SRT29880855d419c6fa0e8c7fdfd985c80f286d914e,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT29880855d419c6fa0e8c7fdfd985c80f286d914e >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICByZXF1aXJlKGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIHJlcXVpcmUoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gcmVxdWlyZShhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXF1aXJlKGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICByZXF1aXJlKGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCi8qKgogKiBAdGl0bGUgT3duYWJsZQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuCiAqLwpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCgogIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCi8qKgogKiBAdGl0bGUgRVJDMjBCYXNpYwogKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE3OQogKi8KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogIC8qKgogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwoKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cgp9CgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbgogKgogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICB1aW50MjU2IF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKCiAgICAvLyBDaGVjayBpcyBub3QgbmVlZGVkIGJlY2F1c2Ugc3ViKF9hbGxvd2FuY2UsIF92YWx1ZSkgd2lsbCBhbHJlYWR5IHRocm93IGlmIHRoaXMgY29uZGl0aW9uIGlzIG5vdCBtZXQKICAgIC8vIHJlcXVpcmUgKF92YWx1ZSA8PSBfYWxsb3dhbmNlKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAqCiAgICogQmV3YXJlIHRoYXQgY2hhbmdpbmcgYW4gYWxsb3dhbmNlIHdpdGggdGhpcyBtZXRob2QgYnJpbmdzIHRoZSByaXNrIHRoYXQgc29tZW9uZSBtYXkgdXNlIGJvdGggdGhlIG9sZAogICAqIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZSB0cmFuc2FjdGlvbiBvcmRlcmluZy4gT25lIHBvc3NpYmxlIHNvbHV0aW9uIHRvIG1pdGlnYXRlIHRoaXMKICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KCiAgLyoqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgfSBlbHNlIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQp9CgoKLyoqKioqCiogQHRpdGxlIFRoZSBEQURJIFB1YmxpYyBzYWxlIENvbnRyYWN0CiovCmNvbnRyYWN0IERhZGlQdWJsaWNTYWxlIGlzIE93bmFibGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgU3RhbmRhcmRUb2tlbiBwdWJsaWMgdG9rZW47ICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBEQURJIEVSQzIwIHRva2VuICovCgogICAgdWludDI1NiBwdWJsaWMgdG9rZW5TdXBwbHk7CiAgICB1aW50MjU2IHB1YmxpYyB0b2tlbnNQdXJjaGFzZWQgPSAwOwogICAgdWludDI1NiBwdWJsaWMgaW5kaXZpZHVhbENhcCA9IDUwMDAgKiAxMDAwOyAgICAgICAgIC8vIFVTRCQ1LDAwMAogICAgdWludDI1NiBwdWJsaWMgdG9rZW5QcmljZSA9IDUwMDsgICAgICAgICAgICAgICAgICAgIC8vIFVTRCQwLjUwCiAgICB1aW50MjU2IHB1YmxpYyBldGhSYXRlOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRVRIIHRvIFVTRCBSYXRlLCBzZXQgYnkgb3duZXI6IDEgRVRIID0gZXRoUmF0ZSBVU0QKICAgIHVpbnQyNTYgcHVibGljIG1heEdhc1ByaWNlOyAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNYXggZ2FzIHByaWNlIGZvciBjb250cmlidXRpbmcgdHJhbnNhY3Rpb25zLgogCiAgICBhZGRyZXNzW10gcHVibGljIHNhbGVXYWxsZXRzOwogICAgbWFwcGluZyhhZGRyZXNzID0+IEludmVzdG9yKSBwcml2YXRlIGludmVzdG9yczsKICAgIGFkZHJlc3NbXSBwcml2YXRlIGludmVzdG9ySW5kZXg7CgogICAgc3RydWN0IEludmVzdG9yIHsKICAgICAgdWludDI1NiB0b2tlbnM7CiAgICAgIHVpbnQyNTYgY29udHJpYnV0aW9uOwogICAgICBib29sIGRpc3RyaWJ1dGVkOwogICAgICB1aW50IGluZGV4OwogICAgfQoKICAgIC8qKioqKgogICAgKiBTdGF0ZSBmb3IgU2FsZSBNb2RlcwogICAgKiAgMCAtIFByZXBhcmluZzogICAgICAgICAgICBBbGwgY29udHJhY3QgaW5pdGlhbGl6YXRpb24gY2FsbHMKICAgICogIDEgLSBQdWJsaWNTYWxlOiAgICAgICAgICAgQ29udHJhY3QgaXMgaW4gdGhlIFNhbGUgUGVyaW9kCiAgICAqICAyIC0gUHVibGljU2FsZUZpbmFsaXplZCAgIFNhbGUgcGVyaW9kIGlzIGZpbmFsaXplZCwgbm8gbW9yZSBwYXltZW50cyBhcmUgYWxsb3dlZAogICAgKiAgMyAtIFN1Y2Nlc3M6ICAgICAgICAgICAgICBTYWxlIFN1Y2Nlc3NmdWwKICAgICogIDQgLSBUb2tlbkRpc3RyaWJ1dGlvbjogICAgU3NhbGUgZmluaXNoZWQsIHRva2VucyBjYW4gYmUgZGlzdHJpYnV0ZWQKICAgICogIDUgLSBDbG9zZWQ6ICAgICAgICAgICAgICAgU2FsZSBjbG9zZWQsIG5vIHRva2VucyBtb3JlIGNhbiBiZSBkaXN0cmlidXRlZAogICAgKi8KICAgIGVudW0gU2FsZVN0YXRlIHsgUHJlcGFyaW5nLCBQdWJsaWNTYWxlLCBQdWJsaWNTYWxlRmluYWxpemVkLCBTdWNjZXNzLCBUb2tlbkRpc3RyaWJ1dGlvbiwgQ2xvc2VkIH0KICAgIFNhbGVTdGF0ZSBwdWJsaWMgc3RhdGUgPSBTYWxlU3RhdGUuUHJlcGFyaW5nOwoKICAgIGV2ZW50IExvZ1Rva2VuUHVyY2hhc2UoYWRkcmVzcyBpbmRleGVkIHB1cmNoYXNlciwgYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IHRva2Vucyk7CiAgICBldmVudCBMb2dUb2tlbkRpc3RyaWJ1dGlvbihhZGRyZXNzIHJlY2lwaWVudCwgdWludDI1NiB0b2tlbnMpOwogICAgZXZlbnQgTG9nUmVkaXN0cmlidXRlVG9rZW5zKGFkZHJlc3MgcmVjaXBpZW50LCBTYWxlU3RhdGUgX3N0YXRlLCB1aW50MjU2IHRva2Vucyk7CiAgICBldmVudCBMb2dGdW5kVHJhbnNmZXIoYWRkcmVzcyB3YWxsZXQsIHVpbnQyNTYgdmFsdWUpOwogICAgZXZlbnQgTG9nUmVmdW5kKGFkZHJlc3Mgd2FsbGV0LCB1aW50MjU2IHZhbHVlKTsKICAgIGV2ZW50IExvZ1N0YXRlQ2hhbmdlKFNhbGVTdGF0ZSBfc3RhdGUpOwoKICAgIC8qKioqKgogICAgKiBAZGV2IE1vZGlmaWVyIHRvIGNoZWNrIHRoYXQgYW1vdW50IHRyYW5zZmVycmVkIGlzIG5vdCAwCiAgICAqLwogICAgbW9kaWZpZXIgbm9uWmVybygpIHsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSAhPSAwKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IFRoZSBjb25zdHJ1Y3RvciBmdW5jdGlvbiB0byBpbml0aWFsaXplIHRoZSBQdWJsaWMgc2FsZQogICAgKiBAcGFyYW0gX3Rva2VuICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3MgICB0aGUgYWRkcmVzcyBvZiB0aGUgRVJDMjAgdG9rZW4gZm9yIHRoZSBzYWxlCiAgICAqIEBwYXJhbSBfdG9rZW5TdXBwbHkgICAgICAgICAgICAgICAgICAgdWludDI1NiAgIHRoZSBhbW91bnQgb2YgdG9rZW5zIGF2YWlsYWJsZQogICAgKi8KICAgIGZ1bmN0aW9uIERhZGlQdWJsaWNTYWxlIChTdGFuZGFyZFRva2VuIF90b2tlbiwgdWludDI1NiBfdG9rZW5TdXBwbHkpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfdG9rZW4gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdG9rZW5TdXBwbHkgIT0gMCk7CgogICAgICAgIHRva2VuID0gU3RhbmRhcmRUb2tlbihfdG9rZW4pOwogICAgICAgIHRva2VuU3VwcGx5ID0gX3Rva2VuU3VwcGx5ICogKHVpbnQyNTYoMTApICoqIDE4KTsKICAgICAgICBtYXhHYXNQcmljZSA9IDYwMDAwMDAwMDAwOyAgICAgICAvLyA2MCBHd2VpCiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgRmFsbGJhY2sgRnVuY3Rpb24gdG8gYnV5IHRoZSB0b2tlbnMKICAgICovCiAgICBmdW5jdGlvbiAoKSBwdWJsaWMgbm9uWmVybyBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFNhbGVTdGF0ZS5QdWJsaWNTYWxlKTsKICAgICAgICBidXlUb2tlbnMobXNnLnNlbmRlciwgbXNnLnZhbHVlKTsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBBbGxvd3MgdGhlIGNvbnRyYWN0IG93bmVyIHRvIGFkZCBhIG5ldyBkaXN0cmlidXRpb24gd2FsbGV0LCB1c2VkIHRvIGhvbGQgZnVuZHMgc2FmZWx5CiAgICAqIEBwYXJhbSBfd2FsbGV0ICAgICAgICBhZGRyZXNzICAgICBUaGUgYWRkcmVzcyBvZiB0aGUgd2FsbGV0CiAgICAqIEByZXR1cm4gc3VjY2VzcyAgICAgICBib29sICAgICAgICBSZXR1cm5zIHRydWUgaWYgZXhlY3V0ZWQgc3VjY2Vzc2Z1bGx5CiAgICAqLwogICAgZnVuY3Rpb24gYWRkU2FsZVdhbGxldCAoYWRkcmVzcyBfd2FsbGV0KSBwdWJsaWMgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF93YWxsZXQgIT0gYWRkcmVzcygwKSk7CgogICAgICAgIHNhbGVXYWxsZXRzLnB1c2goX3dhbGxldCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgQ2FsY3VsYXRlcyB0aGUgbnVtYmVyIG9mIHRva2VucyB0aGF0IGNhbiBiZSBib3VnaHQgZm9yIHRoZSBhbW91bnQgb2YgV2VpIHRyYW5zZmVycmVkCiAgICAqIEBwYXJhbSBfYW1vdW50ICAgIHVpbnQyNTYgICAgIFRoZSBhbW91bnQgb2YgbW9uZXkgaW52ZXN0ZWQgYnkgdGhlIGludmVzdG9yCiAgICAqIEByZXR1cm4gdG9rZW5zICAgIHVpbnQyNTYgICAgIFRoZSBudW1iZXIgb2YgdG9rZW5zIHB1cmNoYXNlZCBmb3IgdGhlIGFtb3VudCBpbnZlc3RlZAogICAgKi8KICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZVRva2VucyAodWludDI1NiBfYW1vdW50KSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiB0b2tlbnMpIHsKICAgICAgICB0b2tlbnMgPSBfYW1vdW50ICogZXRoUmF0ZSAvIHRva2VuUHJpY2U7CiAgICAgICAgcmV0dXJuIHRva2VuczsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBDYWxsZWQgYnkgdGhlIG93bmVyIG9mIHRoZSBjb250cmFjdCB0byBtb2RpZnkgdGhlIHNhbGUgc3RhdGUKICAgICovCiAgICBmdW5jdGlvbiBzZXRTdGF0ZSAodWludDI1NiBfc3RhdGUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHN0YXRlID0gU2FsZVN0YXRlKHVpbnQoX3N0YXRlKSk7CiAgICAgICAgTG9nU3RhdGVDaGFuZ2Uoc3RhdGUpOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IENhbGxlZCBieSB0aGUgb3duZXIgb2YgdGhlIGNvbnRyYWN0IHRvIHN0YXJ0IHRoZSBQdWJsaWMgc2FsZQogICAgKiBAcGFyYW0gcmF0ZSAgIHVpbnQyNTYgIHRoZSBjdXJyZW50IEVUSCBVU0QgcmF0ZSwgbXVsdGlwbGllZCBieSAxMDAwCiAgICAqLwogICAgZnVuY3Rpb24gc3RhcnRQdWJsaWNTYWxlICh1aW50MjU2IHJhdGUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHN0YXRlID0gU2FsZVN0YXRlLlB1YmxpY1NhbGU7CiAgICAgICAgdXBkYXRlRXRoUmF0ZShyYXRlKTsKICAgICAgICBMb2dTdGF0ZUNoYW5nZShzdGF0ZSk7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgQWxsb3cgdXBkYXRpbmcgdGhlIEVUSCBVU0QgZXhjaGFuZ2UgcmF0ZQogICAgKiBAcGFyYW0gcmF0ZSAgIHVpbnQyNTYgIHRoZSBjdXJyZW50IEVUSCBVU0QgcmF0ZSwgbXVsdGlwbGllZCBieSAxMDAwCiAgICAqIEByZXR1cm4gYm9vbCAgUmV0dXJuIHRydWUgaWYgc3VjY2Vzc2Z1bAogICAgKi8KICAgIGZ1bmN0aW9uIHVwZGF0ZUV0aFJhdGUgKHVpbnQyNTYgcmF0ZSkgcHVibGljIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShyYXRlID49IDEwMDAwMCk7CiAgICAgICAgCiAgICAgICAgZXRoUmF0ZSA9IHJhdGU7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgQWxsb3cgdXBkYXRpbmcgdGhlIG1heCBnYXMgcHJpY2UKICAgICogQHBhcmFtIF9tYXhHYXNQcmljZSAgIHVpbnQyNTYgIHRoZSBtYXhpbXVtIGdhcyBwcmljZSBmb3IgYSB0cmFuc2FjdGlvbiwgaW4gR3dlaQogICAgKi8KICAgIGZ1bmN0aW9uIHVwZGF0ZU1heEdhc1ByaWNlKHVpbnQyNTYgX21heEdhc1ByaWNlKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKF9tYXhHYXNQcmljZSA+IDApOwoKICAgICAgICBtYXhHYXNQcmljZSA9IF9tYXhHYXNQcmljZTsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBBbGxvd3MgdHJhbnNmZXIgb2YgdG9rZW5zIHRvIGEgcmVjaXBpZW50IHdobyBoYXMgcHVyY2hhc2VkIG9mZmxpbmUsIGR1cmluZyB0aGUgUHVibGljU2FsZQogICAgKiBAcGFyYW0gX3JlY2lwaWVudCAgICAgYWRkcmVzcyAgICAgVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudCBvZiB0aGUgdG9rZW5zCiAgICAqIEBwYXJhbSBfdG9rZW5zICAgICAgICB1aW50MjU2ICAgICBUaGUgbnVtYmVyIG9mIHRva2VucyBwdXJjaGFzZWQgYnkgdGhlIHJlY2lwaWVudAogICAgKiBAcmV0dXJuIHN1Y2Nlc3MgICAgICAgYm9vbCAgICAgICAgUmV0dXJucyB0cnVlIGlmIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseQogICAgKi8KICAgIGZ1bmN0aW9uIG9mZmxpbmVUcmFuc2FjdGlvbiAoYWRkcmVzcyBfcmVjaXBpZW50LCB1aW50MjU2IF90b2tlbnMpIHB1YmxpYyBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3Rva2VucyA+IDApOwoKICAgICAgICAvLyBDb252ZXJ0IHRvIGEgdG9rZW4gd2l0aCBkZWNpbWFscyAKICAgICAgICB1aW50MjU2IHRva2VucyA9IF90b2tlbnMgKiAodWludDI1NigxMCkgKiogdWludDgoMTgpKTsKCiAgICAgICAgLy8gaWYgdGhlIG51bWJlciBvZiB0b2tlbnMgaXMgZ3JlYXRlciB0aGFuIGF2YWlsYWJsZSwgcmVqZWN0IHR4CiAgICAgICAgaWYgKHRva2VucyA+PSBnZXRUb2tlbnNBdmFpbGFibGUoKSkgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CgogICAgICAgIGFkZFRvSW52ZXN0b3IoX3JlY2lwaWVudCwgMCwgdG9rZW5zKTsKCiAgICAgICAgLy8gSW5jcmVhc2UgdGhlIGNvdW50IG9mIHRva2VucyBwdXJjaGFzZWQgaW4gdGhlIHNhbGUKICAgICAgICB1cGRhdGVTYWxlUGFyYW1ldGVycyh0b2tlbnMpOwoKICAgICAgICBMb2dUb2tlblB1cmNoYXNlKG1zZy5zZW5kZXIsIF9yZWNpcGllbnQsIDAsIHRva2Vucyk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IENhbGxlZCBieSB0aGUgb3duZXIgb2YgdGhlIGNvbnRyYWN0IHRvIGZpbmFsaXplIHRoZSBJQ08KICAgICogICAgICBhbmQgcmVkaXN0cmlidXRlIGZ1bmRzIChpZiBhbnkpCiAgICAqLwogICAgZnVuY3Rpb24gZmluYWxpemVTYWxlICgpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHN0YXRlID0gU2FsZVN0YXRlLlN1Y2Nlc3M7CiAgICAgICAgTG9nU3RhdGVDaGFuZ2Uoc3RhdGUpOwoKICAgICAgICAvLyBUcmFuc2ZlciBhbnkgRVRIIHRvIG9uZSBvZiB0aGUgc2FsZSB3YWxsZXRzCiAgICAgICAgaWYgKHRoaXMuYmFsYW5jZSA+IDApIHsKICAgICAgICAgICAgZm9yd2FyZEZ1bmRzKHRoaXMuYmFsYW5jZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IENhbGxlZCBieSB0aGUgb3duZXIgb2YgdGhlIGNvbnRyYWN0IHRvIGNsb3NlIHRoZSBTYWxlIGFuZCByZWRpc3RyaWJ1dGUgYW55IGNydW1icy4KICAgICogQHBhcmFtIHJlY2lwaWVudCAgICAgYWRkcmVzcyAgICAgVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudCBvZiB0aGUgdG9rZW5zCiAgICAqLwogICAgZnVuY3Rpb24gY2xvc2VTYWxlIChhZGRyZXNzIHJlY2lwaWVudCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgc3RhdGUgPSBTYWxlU3RhdGUuQ2xvc2VkOwogICAgICAgIExvZ1N0YXRlQ2hhbmdlKHN0YXRlKTsKCiAgICAgICAgLy8gcmVkaXN0cmlidXRlIHVuc29sZCB0b2tlbnMgdG8gREFESSBlY29zeXN0ZW0KICAgICAgICB1aW50MjU2IHJlbWFpbmluZyA9IGdldFRva2Vuc0F2YWlsYWJsZSgpOwogICAgICAgIHVwZGF0ZVNhbGVQYXJhbWV0ZXJzKHJlbWFpbmluZyk7CgogICAgICAgIGlmIChyZW1haW5pbmcgPiAwKSB7CiAgICAgICAgICAgIHRva2VuLnRyYW5zZmVyKHJlY2lwaWVudCwgcmVtYWluaW5nKTsKICAgICAgICAgICAgTG9nUmVkaXN0cmlidXRlVG9rZW5zKHJlY2lwaWVudCwgc3RhdGUsIHJlbWFpbmluZyk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IENhbGxlZCBieSB0aGUgb3duZXIgb2YgdGhlIGNvbnRyYWN0IHRvIGFsbG93IHRva2VucyB0byBiZSBkaXN0cmlidXRlZAogICAgKi8KICAgIGZ1bmN0aW9uIHNldFRva2VuRGlzdHJpYnV0aW9uICgpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHN0YXRlID0gU2FsZVN0YXRlLlRva2VuRGlzdHJpYnV0aW9uOwogICAgICAgIExvZ1N0YXRlQ2hhbmdlKHN0YXRlKTsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBDYWxsZWQgYnkgdGhlIG93bmVyIG9mIHRoZSBjb250cmFjdCB0byBkaXN0cmlidXRlIHRva2VucyB0byBpbnZlc3RvcnMKICAgICogQHBhcmFtIF9hZGRyZXNzICAgICAgIGFkZHJlc3MgICAgIFRoZSBhZGRyZXNzIG9mIHRoZSBpbnZlc3RvciBmb3Igd2hpY2ggdG8gZGlzdHJpYnV0ZSB0b2tlbnMKICAgICogQHJldHVybiBzdWNjZXNzICAgICAgIGJvb2wgICAgICAgIFJldHVybnMgdHJ1ZSBpZiBleGVjdXRlZCBzdWNjZXNzZnVsbHkKICAgICovCiAgICBmdW5jdGlvbiBkaXN0cmlidXRlVG9rZW5zIChhZGRyZXNzIF9hZGRyZXNzKSBwdWJsaWMgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFNhbGVTdGF0ZS5Ub2tlbkRpc3RyaWJ1dGlvbik7CiAgICAgICAgCiAgICAgICAgLy8gZ2V0IHRoZSB0b2tlbnMgYXZhaWxhYmxlIGZvciB0aGUgaW52ZXN0b3IKICAgICAgICB1aW50MjU2IHRva2VucyA9IGludmVzdG9yc1tfYWRkcmVzc10udG9rZW5zOwogICAgICAgIHJlcXVpcmUodG9rZW5zID4gMCk7CgogICAgICAgIHJlcXVpcmUoaW52ZXN0b3JzW19hZGRyZXNzXS5kaXN0cmlidXRlZCA9PSBmYWxzZSk7CgogICAgICAgIGludmVzdG9yc1tfYWRkcmVzc10uZGlzdHJpYnV0ZWQgPSB0cnVlOwogICAgICAgIC8vIGludmVzdG9yc1tfYWRkcmVzc10udG9rZW5zID0gMDsKICAgICAgICAvLyBpbnZlc3RvcnNbX2FkZHJlc3NdLmNvbnRyaWJ1dGlvbiA9IDA7CgogICAgICAgIHRva2VuLnRyYW5zZmVyKF9hZGRyZXNzLCB0b2tlbnMpOwogICAgICAKICAgICAgICBMb2dUb2tlbkRpc3RyaWJ1dGlvbihfYWRkcmVzcywgdG9rZW5zKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBDYWxsZWQgYnkgdGhlIG93bmVyIG9mIHRoZSBjb250cmFjdCB0byBkaXN0cmlidXRlIHRva2VucyB0byBpbnZlc3RvcnMgd2hvIHVzZWQgYSBub24tRVJDMjAgd2FsbGV0IGFkZHJlc3MKICAgICogQHBhcmFtIF9wdXJjaGFzZUFkZHJlc3MgICAgICAgIGFkZHJlc3MgICAgIFRoZSBhZGRyZXNzIHRoZSBpbnZlc3RvciB1c2VkIHRvIGJ1eSB0b2tlbnMKICAgICogQHBhcmFtIF90b2tlbkFkZHJlc3MgICAgICAgICAgIGFkZHJlc3MgICAgIFRoZSBhZGRyZXNzIHRvIHNlbmQgdGhlIHRva2VucyB0bwogICAgKiBAcmV0dXJuIHN1Y2Nlc3MgICAgICAgICAgICAgICAgYm9vbCAgICAgICAgUmV0dXJucyB0cnVlIGlmIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseQogICAgKi8KICAgIGZ1bmN0aW9uIGRpc3RyaWJ1dGVUb0FsdGVybmF0ZUFkZHJlc3MgKGFkZHJlc3MgX3B1cmNoYXNlQWRkcmVzcywgYWRkcmVzcyBfdG9rZW5BZGRyZXNzKSBwdWJsaWMgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFNhbGVTdGF0ZS5Ub2tlbkRpc3RyaWJ1dGlvbik7CiAgICAgICAgCiAgICAgICAgLy8gZ2V0IHRoZSB0b2tlbnMgYXZhaWxhYmxlIGZvciB0aGUgaW52ZXN0b3IKICAgICAgICB1aW50MjU2IHRva2VucyA9IGludmVzdG9yc1tfcHVyY2hhc2VBZGRyZXNzXS50b2tlbnM7CiAgICAgICAgcmVxdWlyZSh0b2tlbnMgPiAwKTsKCiAgICAgICAgcmVxdWlyZShpbnZlc3RvcnNbX3B1cmNoYXNlQWRkcmVzc10uZGlzdHJpYnV0ZWQgPT0gZmFsc2UpOwoKICAgICAgICBpbnZlc3RvcnNbX3B1cmNoYXNlQWRkcmVzc10uZGlzdHJpYnV0ZWQgPSB0cnVlOwoKICAgICAgICB0b2tlbi50cmFuc2ZlcihfdG9rZW5BZGRyZXNzLCB0b2tlbnMpOwogICAgICAKICAgICAgICBMb2dUb2tlbkRpc3RyaWJ1dGlvbihfdG9rZW5BZGRyZXNzLCB0b2tlbnMpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IENhbGxlZCBieSB0aGUgb3duZXIgb2YgdGhlIGNvbnRyYWN0IHRvIHJlZGlzdHJpYnV0ZSB0b2tlbnMgaWYgYW4gaW52ZXN0b3IgaGFzIGJlZW4gcmVmdW5kZWQgb2ZmbGluZQogICAgKiBAcGFyYW0gaW52ZXN0b3JBZGRyZXNzICAgICAgICAgYWRkcmVzcyAgICAgVGhlIGFkZHJlc3MgdGhlIGludmVzdG9yIHVzZWQgdG8gYnV5IHRva2VucwogICAgKiBAcGFyYW0gcmVjaXBpZW50ICAgICAgICAgICAgICAgYWRkcmVzcyAgICAgVGhlIGFkZHJlc3MgdG8gc2VuZCB0aGUgdG9rZW5zIHRvCiAgICAqLwogICAgZnVuY3Rpb24gcmVkaXN0cmlidXRlVG9rZW5zIChhZGRyZXNzIGludmVzdG9yQWRkcmVzcywgYWRkcmVzcyByZWNpcGllbnQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHVpbnQyNTYgdG9rZW5zID0gaW52ZXN0b3JzW2ludmVzdG9yQWRkcmVzc10udG9rZW5zOwogICAgICAgIHJlcXVpcmUodG9rZW5zID4gMCk7CiAgICAgICAgcmVxdWlyZShpbnZlc3RvcnNbaW52ZXN0b3JBZGRyZXNzXS5kaXN0cmlidXRlZCA9PSBmYWxzZSk7CiAgICAgICAgCiAgICAgICAgLy8gcmVtb3ZlIHRva2Vucywgc28gdGhleSBjYW4ndCBiZSByZWRpc3RyaWJ1dGVkCiAgICAgICAgLy8gaW52ZXN0b3JzW2ludmVzdG9yQWRkcmVzc10udG9rZW5zID0gMDsKICAgICAgICBpbnZlc3RvcnNbaW52ZXN0b3JBZGRyZXNzXS5kaXN0cmlidXRlZCA9IHRydWU7CiAgICAgICAgdG9rZW4udHJhbnNmZXIocmVjaXBpZW50LCB0b2tlbnMpOwoKICAgICAgICBMb2dSZWRpc3RyaWJ1dGVUb2tlbnMocmVjaXBpZW50LCBzdGF0ZSwgdG9rZW5zKTsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBHZXQgdGhlIGFtb3VudCBvZiB0b2tlbnMgbGVmdCBmb3IgcHVyY2hhc2UKICAgICogQHJldHVybiB1aW50MjU2IHRoZSBjb3VudCBvZiB0b2tlbnMgYXZhaWxhYmxlCiAgICAqLwogICAgZnVuY3Rpb24gZ2V0VG9rZW5zQXZhaWxhYmxlICgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHRva2VuU3VwcGx5IC0gdG9rZW5zUHVyY2hhc2VkOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IEdldCB0aGUgdG90YWwgY291bnQgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAgKiBAcmV0dXJuIHVpbnQyNTYgdGhlIGNvdW50IG9mIHRva2VucyBwdXJjaGFzZWQKICAgICovCiAgICBmdW5jdGlvbiBnZXRUb2tlbnNQdXJjaGFzZWQgKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gdG9rZW5zUHVyY2hhc2VkOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IENvbnZlcnRzIGFuIGFtb3VudCBzZW50IGluIFdlaSB0byB0aGUgZXF1aXZhbGVudCBpbiBVU0QKICAgICogQHBhcmFtIF9hbW91bnQgICAgICB1aW50MjU2ICAgICAgIHRoZSBhbW91bnQgc2VudCB0byB0aGUgY29udHJhY3QsIGluIFdlaQogICAgKiBAcmV0dXJuIHVpbnQyNTYgIHRoZSBhbW91bnQgc2VudCB0byB0aGlzIGNvbnRyYWN0LCBpbiBVU0QKICAgICovCiAgICBmdW5jdGlvbiBldGhUb1VzZCAodWludDI1NiBfYW1vdW50KSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiAoX2Ftb3VudCAqIGV0aFJhdGUpIC8gKHVpbnQyNTYoMTApICoqIDE4KTsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBHZXQgY291bnQgb2YgY29udHJpYnV0b3JzCiAgICAqIEByZXR1cm4gdWludCAgICAgdGhlIG51bWJlciBvZiB1bmlxdWUgY29udHJpYnV0b3JzCiAgICAqLwogICAgZnVuY3Rpb24gZ2V0SW52ZXN0b3JDb3VudCAoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCBjb3VudCkgewogICAgICAgIHJldHVybiBpbnZlc3RvckluZGV4Lmxlbmd0aDsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBHZXQgYW4gaW52ZXN0b3IKICAgICogQHBhcmFtIF9hZGRyZXNzICAgICAgYWRkcmVzcyAgICAgICB0aGUgd2FsbGV0IGFkZHJlc3Mgb2YgdGhlIGludmVzdG9yCiAgICAqIEByZXR1cm4gdWludDI1NiAgdGhlIGFtb3VudCBjb250cmlidXRlZCBieSB0aGUgdXNlcgogICAgKiBAcmV0dXJuIHVpbnQyNTYgIHRoZSBudW1iZXIgb2YgdG9rZW5zIGFzc2lnbmVkIHRvIHRoZSB1c2VyCiAgICAqIEByZXR1cm4gdWludCAgICAgdGhlIGluZGV4IG9mIHRoZSB1c2VyCiAgICAqLwogICAgZnVuY3Rpb24gZ2V0SW52ZXN0b3IgKGFkZHJlc3MgX2FkZHJlc3MpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGNvbnRyaWJ1dGlvbiwgdWludDI1NiB0b2tlbnMsIGJvb2wgZGlzdHJpYnV0ZWQsIHVpbnQgaW5kZXgpIHsKICAgICAgICByZXF1aXJlKGlzSW52ZXN0ZWQoX2FkZHJlc3MpKTsKICAgICAgICByZXR1cm4oaW52ZXN0b3JzW19hZGRyZXNzXS5jb250cmlidXRpb24sIGludmVzdG9yc1tfYWRkcmVzc10udG9rZW5zLCBpbnZlc3RvcnNbX2FkZHJlc3NdLmRpc3RyaWJ1dGVkLCBpbnZlc3RvcnNbX2FkZHJlc3NdLmluZGV4KTsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBHZXQgYSB1c2VyJ3MgaW52ZXN0ZWQgc3RhdGUKICAgICogQHBhcmFtIF9hZGRyZXNzICAgICAgYWRkcmVzcyAgICAgICB0aGUgd2FsbGV0IGFkZHJlc3Mgb2YgdGhlIHVzZXIKICAgICogQHJldHVybiBib29sICB0cnVlIGlmIHRoZSB1c2VyIGhhcyBhbHJlYWR5IGNvbnRyaWJ1dGVkCiAgICAqLwogICAgZnVuY3Rpb24gaXNJbnZlc3RlZCAoYWRkcmVzcyBfYWRkcmVzcykgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYm9vbCBpc0luZGVlZCkgewogICAgICAgIGlmIChpbnZlc3RvckluZGV4Lmxlbmd0aCA9PSAwKSByZXR1cm4gZmFsc2U7CiAgICAgICAgcmV0dXJuIChpbnZlc3RvckluZGV4W2ludmVzdG9yc1tfYWRkcmVzc10uaW5kZXhdID09IF9hZGRyZXNzKTsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBVcGRhdGUgYSB1c2VyJ3MgaW52ZXN0ZWQgc3RhdGUKICAgICogQHBhcmFtIF9hZGRyZXNzICAgICAgYWRkcmVzcyAgICAgICB0aGUgd2FsbGV0IGFkZHJlc3Mgb2YgdGhlIHVzZXIKICAgICogQHBhcmFtIF92YWx1ZSAgICAgICAgdWludDI1NiAgICAgICB0aGUgYW1vdW50IGNvbnRyaWJ1dGVkIGluIHRoaXMgdHJhbnNhY3Rpb24KICAgICogQHBhcmFtIF90b2tlbnMgICAgICAgdWludDI1NiAgICAgICB0aGUgbnVtYmVyIG9mIHRva2VucyBhc3NpZ25lZCBpbiB0aGlzIHRyYW5zYWN0aW9uCiAgICAqLwogICAgZnVuY3Rpb24gYWRkVG9JbnZlc3RvcihhZGRyZXNzIF9hZGRyZXNzLCB1aW50MjU2IF92YWx1ZSwgdWludDI1NiBfdG9rZW5zKSBpbnRlcm5hbCB7CiAgICAgICAgLy8gYWRkIHRoZSB1c2VyIHRvIHRoZSBpbnZlc3RvckluZGV4IGlmIHRoaXMgaXMgdGhlaXIgZmlyc3QgY29udHJpYnV0aW9uCiAgICAgICAgaWYgKCFpc0ludmVzdGVkKF9hZGRyZXNzKSkgewogICAgICAgICAgICBpbnZlc3RvcnNbX2FkZHJlc3NdLmluZGV4ID0gaW52ZXN0b3JJbmRleC5wdXNoKF9hZGRyZXNzKSAtIDE7CiAgICAgICAgfQogICAgICAKICAgICAgICBpbnZlc3RvcnNbX2FkZHJlc3NdLnRva2VucyA9IGludmVzdG9yc1tfYWRkcmVzc10udG9rZW5zLmFkZChfdG9rZW5zKTsKICAgICAgICBpbnZlc3RvcnNbX2FkZHJlc3NdLmNvbnRyaWJ1dGlvbiA9IGludmVzdG9yc1tfYWRkcmVzc10uY29udHJpYnV0aW9uLmFkZChfdmFsdWUpOwogICAgICAgIGludmVzdG9yc1tfYWRkcmVzc10uZGlzdHJpYnV0ZWQgPSBmYWxzZTsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBTZW5kIGV0aGVyIHRvIHRoZSBzYWxlIGNvbGxlY3Rpb24gd2FsbGV0cwogICAgKi8KICAgIGZ1bmN0aW9uIGZvcndhcmRGdW5kcyAodWludDI1NiBfdmFsdWUpIGludGVybmFsIHsKICAgICAgICB1aW50IGFjY291bnROdW1iZXI7CiAgICAgICAgYWRkcmVzcyBhY2NvdW50OwoKICAgICAgICAvLyBtb3ZlIGZ1bmRzIHRvIGEgcmFuZG9tIHNhbGVXYWxsZXQKICAgICAgICBpZiAoc2FsZVdhbGxldHMubGVuZ3RoID4gMCkgewogICAgICAgICAgICBhY2NvdW50TnVtYmVyID0gZ2V0UmFuZG9tKHNhbGVXYWxsZXRzLmxlbmd0aCkgLSAxOwogICAgICAgICAgICBhY2NvdW50ID0gc2FsZVdhbGxldHNbYWNjb3VudE51bWJlcl07CiAgICAgICAgICAgIGFjY291bnQudHJhbnNmZXIoX3ZhbHVlKTsKICAgICAgICAgICAgTG9nRnVuZFRyYW5zZmVyKGFjY291bnQsIF92YWx1ZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIGFzc2lnbiB0b2tlbnMgdG8gdGhlIGNvbnRyaWJ1dG9yCiAgICAqIEBwYXJhbSBfYWRkcmVzcyAgICAgICBhZGRyZXNzICAgICBUaGUgYWRkcmVzcyBvZiB0aGUgY29udHJpYnV0aW5nIGludmVzdG9yCiAgICAqIEBwYXJhbSBfdmFsdWUgICAgICAgICB1aW50MjU2ICAgICBUaGUgYW1vdW50IGludmVzdGVkIAogICAgKiBAcmV0dXJuIHN1Y2Nlc3MgICAgICAgYm9vbCAgICAgICAgUmV0dXJucyB0cnVlIGlmIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseQogICAgKi8KICAgIGZ1bmN0aW9uIGJ1eVRva2VucyAoYWRkcmVzcyBfYWRkcmVzcywgdWludDI1NiBfdmFsdWUpIGludGVybmFsIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKHR4Lmdhc3ByaWNlIDw9IG1heEdhc1ByaWNlKTsKCiAgICAgICAgcmVxdWlyZShpc1ZhbGlkQ29udHJpYnV0aW9uKF9hZGRyZXNzLCBfdmFsdWUpKTsKCiAgICAgICAgdWludDI1NiBib3VnaHRUb2tlbnMgPSBjYWxjdWxhdGVUb2tlbnMoX3ZhbHVlKTsKICAgICAgICByZXF1aXJlKGJvdWdodFRva2VucyAhPSAwKTsKCiAgICAgICAgLy8gaWYgdGhlIG51bWJlciBvZiB0b2tlbnMgY2FsY3VsYXRlZCBmb3IgdGhlIGdpdmVuIHZhbHVlIGlzIAogICAgICAgIC8vIGdyZWF0ZXIgdGhhbiB0aGUgdG9rZW5zIGF2YWlsYWJsZSwgcmVqZWN0IHRoZSBwYXltZW50CiAgICAgICAgcmVxdWlyZShib3VnaHRUb2tlbnMgPD0gZ2V0VG9rZW5zQXZhaWxhYmxlKCkpOwoKICAgICAgICAvLyB1cGRhdGUgaW52ZXN0b3Igc3RhdGUKICAgICAgICBhZGRUb0ludmVzdG9yKF9hZGRyZXNzLCBfdmFsdWUsIGJvdWdodFRva2Vucyk7CgogICAgICAgIGZvcndhcmRGdW5kcyhfdmFsdWUpOwoKICAgICAgICB1cGRhdGVTYWxlUGFyYW1ldGVycyhib3VnaHRUb2tlbnMpOwoKICAgICAgICBMb2dUb2tlblB1cmNoYXNlKG1zZy5zZW5kZXIsIF9hZGRyZXNzLCBfdmFsdWUsIGJvdWdodFRva2Vucyk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IENoZWNrIHRoYXQgdGhlIGFtb3VudCBzZW50IGluIHRoZSB0cmFuc2FjdGlvbiBpcyBiZWxvdyB0aGUgaW5kaXZpZHVhbCBjYXAKICAgICogRmFjdG9ycyBpbiBwcmV2aW91cyB0cmFuc2FjdGlvbnMgYnkgdGhlIHNhbWUgaW52ZXN0b3IKICAgICogQHBhcmFtIF9hZGRyZXNzICAgICAgICAgYWRkcmVzcyAgICAgVGhlIGFkZHJlc3Mgb2YgdGhlIHVzZXIgbWFraW5nIHRoZSB0cmFuc2FjdGlvbgogICAgKiBAcGFyYW0gX2Ftb3VudCAgICAgICAgICB1aW50MjU2ICAgICBUaGUgYW1vdW50IHNlbnQgaW4gdGhlIHRyYW5zYWN0aW9uCiAgICAqIEByZXR1cm4gICAgICAgIGJvb2wgICAgICAgIFJldHVybnMgdHJ1ZSBpZiB0aGUgYW1vdW50IGlzIHZhbGlkCiAgICAqLwogICAgZnVuY3Rpb24gaXNWYWxpZENvbnRyaWJ1dGlvbiAoYWRkcmVzcyBfYWRkcmVzcywgdWludDI1NiBfYW1vdW50KSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zIChib29sIHZhbGlkKSB7CiAgICAgICAgcmV0dXJuIGlzQmVsb3dDYXAoX2Ftb3VudCArIGludmVzdG9yc1tfYWRkcmVzc10uY29udHJpYnV0aW9uKTsgCiAgICB9CgogICAgLyoqKioqCiAgICAqIEBkZXYgQ2hlY2sgdGhhdCB0aGUgYW1vdW50IHNlbnQgaW4gdGhlIHRyYW5zYWN0aW9uIGlzIGJlbG93IHRoZSBpbmRpdmlkdWFsIGNhcAogICAgKiBAcGFyYW0gX2Ftb3VudCAgICAgICAgIHVpbnQyNTYgICAgIFRoZSBhbW91bnQgc2VudCBpbiB0aGUgdHJhbnNhY3Rpb24KICAgICogQHJldHVybiAgICAgICAgYm9vbCAgICAgICAgUmV0dXJucyB0cnVlIGlmIHRoZSBhbW91bnQgaXMgYmVsb3cgdGhlIGluZGl2aWR1YWwgY2FwCiAgICAqLwogICAgZnVuY3Rpb24gaXNCZWxvd0NhcCAodWludDI1NiBfYW1vdW50KSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIGV0aFRvVXNkKF9hbW91bnQpIDwgaW5kaXZpZHVhbENhcDsKICAgIH0KCiAgICAvKioqKioKICAgICogQGRldiBHZW5lcmF0ZXMgYSByYW5kb20gbnVtYmVyIGZyb20gMSB0byBtYXggYmFzZWQgb24gdGhlIGxhc3QgYmxvY2sgaGFzaAogICAgKiBAcGFyYW0gbWF4ICAgICB1aW50ICB0aGUgbWF4aW11bSB2YWx1ZSAKICAgICogQHJldHVybiBhIHJhbmRvbSBudW1iZXIKICAgICovCiAgICBmdW5jdGlvbiBnZXRSYW5kb20odWludCBtYXgpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcmFuZG9tTnVtYmVyKSB7CiAgICAgICAgcmV0dXJuICh1aW50KGtlY2NhazI1NihibG9jay5ibG9ja2hhc2goYmxvY2subnVtYmVyIC0gMSkpKSAlIG1heCkgKyAxOwogICAgfQoKICAgIC8qKioqKgogICAgKiBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIG1vZGlmeSBwYXJhbWV0ZXJzIGJhc2VkIG9uIHRva2VucyBib3VnaHQKICAgICogQHBhcmFtIF90b2tlbnMgICAgICAgIHVpbnQyNTYgICAgIFRoZSBudW1iZXIgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAgKi8KICAgIGZ1bmN0aW9uIHVwZGF0ZVNhbGVQYXJhbWV0ZXJzICh1aW50MjU2IF90b2tlbnMpIGludGVybmFsIHsKICAgICAgICB0b2tlbnNQdXJjaGFzZWQgPSB0b2tlbnNQdXJjaGFzZWQuYWRkKF90b2tlbnMpOwogICAgfQp9'.
	

]
