Class {
	#name : #SRTfb840fe0857587910cf0ec1bdbdb4f356f3cd566,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTfb840fe0857587910cf0ec1bdbdb4f356f3cd566 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKGEgPT0gMCkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9Cgpjb250cmFjdCBVc2VyUmVnaXN0cnlJbnRlcmZhY2UgewogIGV2ZW50IEFkZEFkZHJlc3MoYWRkcmVzcyBpbmRleGVkIHdobyk7CiAgZXZlbnQgQWRkSWRlbnRpdHkoYWRkcmVzcyBpbmRleGVkIHdobyk7CgogIGZ1bmN0aW9uIGtub3duQWRkcmVzcyhhZGRyZXNzIF93aG8pIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKGJvb2wpOwogIGZ1bmN0aW9uIGhhc0lkZW50aXR5KGFkZHJlc3MgX3dobykgcHVibGljIGNvbnN0YW50IHJldHVybnMoYm9vbCk7CiAgZnVuY3Rpb24gc3lzdGVtQWRkcmVzc2VzKGFkZHJlc3MgX3RvLCBhZGRyZXNzIF9mcm9tKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyhib29sKTsKfQoKY29udHJhY3QgTXVsdGlPd25lcnMgewoKICAgIGV2ZW50IEFjY2Vzc0dyYW50KGFkZHJlc3MgaW5kZXhlZCBvd25lcik7CiAgICBldmVudCBBY2Nlc3NSZXZva2UoYWRkcmVzcyBpbmRleGVkIG93bmVyKTsKICAgIAogICAgbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIG93bmVyczsKICAgIGFkZHJlc3MgcHVibGljIHB1Ymxpc2hlcjsKCiAgICBmdW5jdGlvbiBNdWx0aU93bmVycygpIHB1YmxpYyB7CiAgICAgICAgb3duZXJzW21zZy5zZW5kZXJdID0gdHJ1ZTsKICAgICAgICBwdWJsaXNoZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsgCiAgICAgICAgcmVxdWlyZShvd25lcnNbbXNnLnNlbmRlcl0gPT0gdHJ1ZSk7CiAgICAgICAgXzsgCiAgICB9CgogICAgZnVuY3Rpb24gaXNPd25lcigpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIG93bmVyc1ttc2cuc2VuZGVyXSA/IHRydWUgOiBmYWxzZTsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGVja093bmVyKGFkZHJlc3MgbWF5YmVfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIG93bmVyc1ttYXliZV9vd25lcl0gPyB0cnVlIDogZmFsc2U7CiAgICB9CgogICAgZnVuY3Rpb24gZ3JhbnQoYWRkcmVzcyBfb3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIG93bmVyc1tfb3duZXJdID0gdHJ1ZTsKICAgICAgICBBY2Nlc3NHcmFudChfb3duZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIHJldm9rZShhZGRyZXNzIF9vd25lcikgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfb3duZXIgIT0gcHVibGlzaGVyKTsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgIT0gX293bmVyKTsKCiAgICAgICAgb3duZXJzW19vd25lcl0gPSBmYWxzZTsKICAgICAgICBBY2Nlc3NSZXZva2UoX293bmVyKTsKICAgIH0KfQoKY29udHJhY3QgVG9rZW5SZWNpcGllbnQgewogIGZ1bmN0aW9uIHJlY2VpdmVBcHByb3ZhbChhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF92YWx1ZSwgYWRkcmVzcyBfdG9rZW4sIGJ5dGVzIF9leHRyYURhdGEpIHB1YmxpYzsgCn0KCmNvbnRyYWN0IFRva2VuSW50ZXJmYWNlIGlzIEVSQzIwIHsKICBzdHJpbmcgcHVibGljIG5hbWU7CiAgc3RyaW5nIHB1YmxpYyBzeW1ib2w7CiAgdWludCBwdWJsaWMgZGVjaW1hbHM7Cn0KCmNvbnRyYWN0IE1pbnRhYmxlVG9rZW5JbnRlcmZhY2UgaXMgVG9rZW5JbnRlcmZhY2UgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwogIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBiZW5lZmljaWFyeSwgdWludCBhbW91bnQpIHB1YmxpYyByZXR1cm5zKGJvb2wpOwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV4dE93bmVyKSBwdWJsaWM7Cn0KCi8qKgogKiBDb21wbGV4IGNyb3dkc2FsZSB3aXRoIGh1Z2UgcG9zaWJpbGl0aWVzCiAqIENvcmUgZmVhdHVyZXM6CiAqIC0gV2hpdGVsaXN0aW5nCiAqICAtIE1pblxtYXggaW52ZXN0IGFtb3VudHMKICogLSBPbmx5IGtub3duIHVzZXJzCiAqIC0gQnV5IHdpdGggYWxsb3dlZCB0b2tlbnMKICogIC0gT3JhY2xpemUgYmFzZWQgcGFpcnMgKEVUSCB0byBUT0tFTikKICogLSBSZXZlcnRccmVmdW5kCiAqIC0gUGVyc29uYWwgYm9udXNlcwogKiAtIEFtb3VudCBib251c2VzCiAqIC0gVG90YWwgc3VwcGx5IGJvbnVzZXMKICogLSBFYXJseSBiaXJkcyBib251c2VzCiAqIC0gRXh0cmEgZGlzdHJpYnV0aW9uICh0ZWFtLCBmb3VuZGF0aW9uIGFuZCBhbHNvKQogKiAtIFNvZnQgYW5kIGhhcmQgY2FwcwogKiAtIEZpbmFsaXphdGlvbiBsb2dpY3MKKiovCmNvbnRyYWN0IENyb3dkc2FsZSBpcyBNdWx0aU93bmVycywgVG9rZW5SZWNpcGllbnQgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwoKICAvLyAg4paI4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilZcgICDilojilojilZfilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilZcKICAvLyDilojilojilZTilZDilZDilZDilZDilZ3ilojilojilZTilZDilZDilZDilojilojilZfilojilojilojilojilZcgIOKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVkOKWiOKWiOKVlOKVkOKVkOKVneKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVnQogIC8vIOKWiOKWiOKVkSAgICAg4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWU4paI4paI4pWXIOKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlyAgIOKWiOKWiOKVkSAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlwogIC8vIOKWiOKWiOKVkSAgICAg4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWR4pWa4paI4paI4pWX4paI4paI4pWR4pWa4pWQ4pWQ4pWQ4pWQ4paI4paI4pWRICAg4paI4paI4pWRICAg4pWa4pWQ4pWQ4pWQ4pWQ4paI4paI4pWRCiAgLy8g4pWa4paI4paI4paI4paI4paI4paI4pWX4pWa4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4pWRIOKVmuKWiOKWiOKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkSAgIOKWiOKWiOKVkSAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkQogIC8vICDilZrilZDilZDilZDilZDilZDilZ0g4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVnSAg4pWa4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdICAg4pWa4pWQ4pWdICAg4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdCiAgdWludCBwdWJsaWMgY29uc3RhbnQgVkVSU0lPTiA9IDB4MTsKICBlbnVtIFN0YXRlIHsKICAgIFNldHVwLCAgICAgICAgICAvLyBOb24gYWN0aXZlIHlldCAocmVxdWlyZSB0byBiZSBzZXR1cGVkKQogICAgQWN0aXZlLCAgICAgICAgIC8vIENyb3dkc2FsZSBpbiBhIGxpdmUKICAgIENsYWltLCAgICAgICAgICAvLyBDbGFpbSBmdW5kcyBieSBvd25lcgogICAgUmVmdW5kLCAgICAgICAgIC8vIFVuc3VjY2VzZWZ1bCBjcm93ZHNhbGUgKHJlZnVuZCBldGhlcikKICAgIEhpc3RvcnkgICAgICAgICAvLyBDbG9zZSBhbmQgc3RvcmUgb25seSBoaXN0b3JpY2FsIGZhY3Qgb2YgZXhpc3RlbmNlCiAgfQoKCiAgc3RydWN0IFBlcnNvbmFsQm9udXNSZWNvcmQgewogICAgdWludCBib251czsKICAgIGFkZHJlc3MgcmVmZXJlckFkZHJlc3M7CiAgICB1aW50IHJlZmVyZXJCb251czsKICB9CgogIHN0cnVjdCBXaGl0ZWxpc3RSZWNvcmQgewogICAgYm9vbCBhbGxvdzsKICAgIHVpbnQgbWluOwogICAgdWludCBtYXg7CiAgfQoKCiAgLy8gIOKWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilojilojilojilZcg4paI4paI4paI4pWXICAg4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4pWX4paI4paI4paI4pWXICAg4paI4paI4pWXIOKWiOKWiOKWiOKWiOKWiOKWiOKVlyAKICAvLyDilojilojilZTilZDilZDilZDilZDilZ3ilojilojilZTilZDilZDilZDilojilojilZfilojilojilojilojilZcgIOKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKWiOKWiOKVkeKWiOKWiOKWiOKWiOKVlyAg4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWdIAogIC8vIOKWiOKWiOKVkSAgICAg4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWU4paI4paI4pWXIOKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKVlyAg4paI4paI4pWR4paI4paI4pWU4paI4paI4pWXIOKWiOKWiOKVkeKWiOKWiOKVkSAg4paI4paI4paI4pWXCiAgLy8g4paI4paI4pWRICAgICDilojilojilZEgICDilojilojilZHilojilojilZHilZrilojilojilZfilojilojilZHilojilojilZTilZDilZDilZ0gIOKWiOKWiOKVkeKWiOKWiOKVkeKVmuKWiOKWiOKVl+KWiOKWiOKVkeKWiOKWiOKVkSAgIOKWiOKWiOKVkQogIC8vIOKVmuKWiOKWiOKWiOKWiOKWiOKWiOKVl+KVmuKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVkSDilZrilojilojilojilojilZHilojilojilZEgICAgIOKWiOKWiOKVkeKWiOKWiOKVkSDilZrilojilojilojilojilZHilZrilojilojilojilojilojilojilZTilZ0KICAvLyAg4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVkOKVkOKVkOKVkOKVnSDilZrilZDilZ0gIOKVmuKVkOKVkOKVkOKVneKVmuKVkOKVnSAgICAg4pWa4pWQ4pWd4pWa4pWQ4pWdICDilZrilZDilZDilZDilZ0g4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogIGJvb2wgcHVibGljIGlzV2hpdGVsaXN0ZWQ7ICAgICAgICAgICAgLy8gU2hvdWxkIGJlIHdoaXRlbGlzdGVkIHRvIGJ1eSB0b2tlbnMKICBib29sIHB1YmxpYyBpc0tub3duT25seTsgICAgICAgICAgICAgIC8vIFNob3VsZCBiZSBrbm93biB1c2VyIHRvIGJ1eSB0b2tlbnMKICBib29sIHB1YmxpYyBpc0Ftb3VudEJvbnVzOyAgICAgICAgICAgIC8vIEVuYWJsZSBhbW91bnQgYm9udXNlcyBpbiBjcm93ZHNhbGU/CiAgYm9vbCBwdWJsaWMgaXNFYXJseUJvbnVzOyAgICAgICAgICAgICAvLyBFbmFibGUgZWFybHkgYmlyZCBib251cyBpbiBjcm93ZHNhbGU/CiAgYm9vbCBwdWJsaWMgaXNUb2tlbkV4Y2hhbmdlOyAgICAgICAgICAvLyBBbGxvdyB0byBidXkgdG9rZW5zIGZvciBhbm90aGVyIHRva2Vucz8KICBib29sIHB1YmxpYyBpc0FsbG93VG9Jc3N1ZTsgICAgICAgICAgIC8vIEFsbG93IHRvIGlzc3VlIHRva2VucyB3aXRoIHR4IGhhc2ggKGV4IGJpdGNvaW4pCiAgYm9vbCBwdWJsaWMgaXNEaXNhYmxlRXRoZXI7ICAgICAgICAgICAvLyBEaXNhYmxlIHB1cmNoYXNlIHdpdGggdGhlIEV0aGVyCiAgYm9vbCBwdWJsaWMgaXNFeHRyYURpc3RyaWJ1dGlvbjsgICAgICAvLyBTaG91bGQgZGlzdHJpYnV0ZSBleHRyYSB0b2tlbnMgdG8gc3BlY2lhbCBjb250cmFjdD8KICBib29sIHB1YmxpYyBpc1RyYW5zZmVyU2hpcG1lbnQ7ICAgICAgIC8vIFdpbGwgc2hpcCB0b2tlbiB2aWEgbWludGluZz8KICBib29sIHB1YmxpYyBpc0NhcHBlZEluRXRoZXI7ICAgICAgICAgIC8vIFNob3VsZCBiZSBjYXBwZWQgaW4gRXRoZXIgCiAgYm9vbCBwdWJsaWMgaXNQZXJzb25hbEJvbnVzZXM7ICAgICAgICAvLyBTaG91bGQgY2hlY2sgcGVyc29uYWwgYmVuZWZpY2lhcnkgYm9udXM/CiAgYm9vbCBwdWJsaWMgaXNBbGxvd0NsYWltQmVmb3JlRmluYWxpemF0aW9uOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2hvdWxkIGFsbG93IHRvIGNsYWltIGZ1bmRzIGJlZm9yZSBmaW5hbGl6YXRpb24/CiAgYm9vbCBwdWJsaWMgaXNNaW5pbXVtVmFsdWU7ICAgICAgICAgICAvLyBWYWxpZGF0ZSBtaW5pbXVtIGFtb3VudCB0byBwdXJjaGFzZQogIGJvb2wgcHVibGljIGlzTWluaW11bUluRXRoZXI7ICAgICAgICAgLy8gSXMgbWluaW11bSBhbW91bnQgc2V0dXBlZCBpbiBFdGhlciBvciBUb2tlbnM/CgogIHVpbnQgcHVibGljIG1pbmltdW1QdXJjaGFzZVZhbHVlOyAgICAgLy8gSG93IGxlc3MgYnV5ZXIgY291bGQgdG8gcHVyY2hhc2UKCiAgLy8gTGlzdCBvZiBhbGxvd2VkIGJlbmVmaWNpYXJpZXMKICBtYXBwaW5nIChhZGRyZXNzID0+IFdoaXRlbGlzdFJlY29yZCkgcHVibGljIHdoaXRlbGlzdDsKCiAgLy8gS25vd24gdXNlcnMgcmVnaXN0cnkgKHJlcXVpcmVkIHRvIGtub3duIHJ1bGVzKQogIFVzZXJSZWdpc3RyeUludGVyZmFjZSBwdWJsaWMgdXNlclJlZ2lzdHJ5OwoKICBtYXBwaW5nICh1aW50ID0+IHVpbnQpIHB1YmxpYyBhbW91bnRCb251c2VzOyAvLyBBbW91bnQgYm9udXNlcwogIHVpbnRbXSBwdWJsaWMgYW1vdW50U2xpY2VzOyAgICAgICAgICAgICAgICAgIC8vIEtleSBpcyBtaW4gYW1vdW50IG9mIGJ1eQogIHVpbnQgcHVibGljIGFtb3VudFNsaWNlc0NvdW50OyAgICAgICAgICAgICAgIC8vIDEwMDAwIC0gMTAwLjAwJSBib251cyBvdmVyIGJhc2UgcHJpY2V0b3RhbHkgZnJlZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICA1MDAwIC0gNTAuMDAlIGJvbnVzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIDAgLSBubyBib251cyBhdCBhbGwKICBtYXBwaW5nICh1aW50ID0+IHVpbnQpIHB1YmxpYyB0aW1lQm9udXNlczsgICAvLyBUaW1lIGJvbnVzZXMKICB1aW50W10gcHVibGljIHRpbWVTbGljZXM7ICAgICAgICAgICAgICAgICAgICAvLyBTYW1lIGFzIGFtb3VudCBidXQga2V5IGlzIHNlY29uZHMgYWZ0ZXIgc3RhcnQKICB1aW50IHB1YmxpYyB0aW1lU2xpY2VzQ291bnQ7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gUGVyc29uYWxCb251c1JlY29yZCkgcHVibGljIHBlcnNvbmFsQm9udXNlczsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwZXJzb25hbCBib251c2VzCiAgTWludGFibGVUb2tlbkludGVyZmFjZSBwdWJsaWMgdG9rZW47ICAvLyBUaGUgdG9rZW4gYmVpbmcgc29sZAogIHVpbnQgcHVibGljIHRva2VuRGVjaW1hbHM7ICAgICAgICAgICAgLy8gVG9rZW4gZGVjaW1hbHMKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBUb2tlbkludGVyZmFjZSkgcHVibGljIGFsbG93ZWRUb2tlbnM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhbGxvd2VkIHRva2VucyBsaXN0CiAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgdG9rZW5zVmFsdWVzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9LRU4gdG8gRVRIIGNvbnZlcnNpb24gcmF0ZSAob3JhY2xpemVkKQogIHVpbnQgcHVibGljIHN0YXJ0VGltZTsgICAgICAgICAgICAgICAgLy8gc3RhcnQgYW5kIGVuZCB0aW1lc3RhbXBzIHdoZXJlIAogIHVpbnQgcHVibGljIGVuZFRpbWU7ICAgICAgICAgICAgICAgICAgLy8gaW52ZXN0bWVudHMgYXJlIGFsbG93ZWQgKGJvdGggaW5jbHVzaXZlKQogIGFkZHJlc3MgcHVibGljIHdhbGxldDsgICAgICAgICAgICAgICAgLy8gYWRkcmVzcyB3aGVyZSBmdW5kcyBhcmUgY29sbGVjdGVkCiAgdWludCBwdWJsaWMgcHJpY2U7ICAgICAgICAgICAgICAgICAgICAvLyBob3cgbWFueSB0b2tlbiAoMSAqIDEwICoqIGRlY2ltYWxzKSBhIGJ1eWVyIGdldHMgcGVyIHdlaQogIHVpbnQgcHVibGljIGhhcmRDYXA7CiAgdWludCBwdWJsaWMgc29mdENhcDsKCiAgYWRkcmVzcyBwdWJsaWMgZXh0cmFUb2tlbnNIb2xkZXI7ICAgICAvLyBhZGRyZXNzIHRvIG1pbnQvdHJhbnNmZXIgZXh0cmEgdG9rZW5zICgwIOKAkyAwJSwgMTAwMCAtIDEwMC4wJSkKICB1aW50IHB1YmxpYyBleHRyYURpc3RyaWJ1dGlvblBhcnQ7ICAgIC8vICUgb2YgZXh0cmEgZGlzdHJpYnV0aW9uCgogIC8vIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilojilojilZcg4paI4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWXCiAgLy8g4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWQ4paI4paI4pWU4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4pWa4pWQ4pWQ4paI4paI4pWU4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWdCiAgLy8g4paI4paI4paI4paI4paI4paI4paI4pWXICAg4paI4paI4pWRICAg4paI4paI4paI4paI4paI4paI4paI4pWRICAg4paI4paI4pWRICAg4paI4paI4paI4paI4paI4pWXICAKICAvLyDilZrilZDilZDilZDilZDilojilojilZEgICDilojilojilZEgICDilojilojilZTilZDilZDilojilojilZEgICDilojilojilZEgICDilojilojilZTilZDilZDilZ0gIAogIC8vIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkSAgIOKWiOKWiOKVkSAgIOKWiOKWiOKVkSAg4paI4paI4pWRICAg4paI4paI4pWRICAg4paI4paI4paI4paI4paI4paI4paI4pWXCiAgLy8g4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdICAg4pWa4pWQ4pWdICAg4pWa4pWQ4pWdICDilZrilZDilZ0gICDilZrilZDilZ0gICDilZrilZDilZDilZDilZDilZDilZDilZ0KICAvLyBhbW91bnQgb2YgcmFpc2VkIG1vbmV5IGluIHdlaQogIHVpbnQgcHVibGljIHdlaVJhaXNlZDsKICAvLyBDdXJyZW50IGNyb3dkc2FsZSBzdGF0ZQogIFN0YXRlIHB1YmxpYyBzdGF0ZTsKICAvLyBUZW1wb3JhbCBiYWxhbmNlcyB0byBwdWxsIHRva2VucyBhZnRlciB0b2tlbiBzYWxlCiAgLy8gcmVxdWlyZXMgdG8gc2hpcCByZXF1aXJlZCBiYWxhbmNlIHRvIHNtYXJ0IGNvbnRyYWN0CiAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgYmVuZWZpY2lhcnlJbnZlc3Q7CiAgdWludCBwdWJsaWMgc29sZFRva2VuczsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgd2VpRGVwb3NpdDsKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50KSkgcHVibGljIGFsdERlcG9zaXQ7CgogIG1vZGlmaWVyIGluU3RhdGUoU3RhdGUgX3RhcmdldCkgewogICAgcmVxdWlyZShzdGF0ZSA9PSBfdGFyZ2V0KTsKICAgIF87CiAgfQoKICAvLyDilojilojilojilojilojilojilojilZfilojilojilZcgICDilojilojilZfilojilojilojilojilojilojilojilZfilojilojilojilZcgICDilojilojilZfilojilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilZcKICAvLyDilojilojilZTilZDilZDilZDilZDilZ3ilojilojilZEgICDilojilojilZHilojilojilZTilZDilZDilZDilZDilZ3ilojilojilojilojilZcgIOKWiOKWiOKVkeKVmuKVkOKVkOKWiOKWiOKVlOKVkOKVkOKVneKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVnQogIC8vIOKWiOKWiOKWiOKWiOKWiOKVlyAg4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4paI4paI4paI4pWXICDilojilojilZTilojilojilZcg4paI4paI4pWRICAg4paI4paI4pWRICAg4paI4paI4paI4paI4paI4paI4paI4pWXCiAgLy8g4paI4paI4pWU4pWQ4pWQ4pWdICDilZrilojilojilZcg4paI4paI4pWU4pWd4paI4paI4pWU4pWQ4pWQ4pWdICDilojilojilZHilZrilojilojilZfilojilojilZEgICDilojilojilZEgICDilZrilZDilZDilZDilZDilojilojilZEKICAvLyDilojilojilojilojilojilojilojilZcg4pWa4paI4paI4paI4paI4pWU4pWdIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKVkSDilZrilojilojilojilojilZEgICDilojilojilZEgICDilojilojilojilojilojilojilojilZEKICAvLyDilZrilZDilZDilZDilZDilZDilZDilZ0gIOKVmuKVkOKVkOKVkOKVnSAg4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWdICDilZrilZDilZDilZDilZ0gICDilZrilZDilZ0gICDilZrilZDilZDilZDilZDilZDilZDilZ0KICAKICBldmVudCBFdGhCdXkoCiAgICBhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCAKICAgIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgCiAgICB1aW50IHZhbHVlLCAKICAgIHVpbnQgYW1vdW50KTsKICBldmVudCBIYXNoQnV5KAogICAgYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCAKICAgIHVpbnQgdmFsdWUsIAogICAgdWludCBhbW91bnQsIAogICAgdWludCB0aW1lc3RhbXAsIAogICAgYnl0ZXMzMiBpbmRleGVkIGJpdGNvaW5IYXNoKTsKICBldmVudCBBbHRCdXkoCiAgICBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIAogICAgYWRkcmVzcyBpbmRleGVkIGFsbG93ZWRUb2tlbiwgCiAgICB1aW50IGFsbG93ZWRUb2tlblZhbHVlLCAKICAgIHVpbnQgZXRoVmFsdWUsIAogICAgdWludCBzaGlwQW1vdW50KTsKICAgIAogIGV2ZW50IFNoaXBUb2tlbnMoYWRkcmVzcyBpbmRleGVkIG93bmVyLCB1aW50IGFtb3VudCk7CgogIGV2ZW50IFNhbmV0aXplKCk7CiAgZXZlbnQgRmluYWxpemUoKTsKCiAgZXZlbnQgV2hpdGVsaXN0ZWQoYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50IG1pbiwgdWludCBtYXgpOwogIGV2ZW50IFBlcnNvbmFsQm9udXMoYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCBhZGRyZXNzIGluZGV4ZWQgcmVmZXJlciwgdWludCBib251cywgdWludCByZWZlcmVyQm9udXMpOwogIGV2ZW50IEZ1bmRzQ2xhaW1lZChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIHVpbnQgYW1vdW50KTsKCgogIC8vIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKVlyAgIOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKVlyAgICAg4paI4paI4paI4pWXICAg4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4pWXICDilojilojilZcg4paI4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilojilojilojilojilZcKICAvLyDilojilojilZTilZDilZDilZDilZDilZ3ilojilojilZTilZDilZDilZDilZDilZ3ilZrilZDilZDilojilojilZTilZDilZDilZ3ilojilojilZEgICDilojilojilZHilojilojilZTilZDilZDilojilojilZcgICAg4paI4paI4paI4paI4pWXIOKWiOKWiOKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVkOKWiOKWiOKVlOKVkOKVkOKVneKWiOKWiOKVkSAg4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWdCiAgLy8g4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4pWXICAgICDilojilojilZEgICDilojilojilZEgICDilojilojilZHilojilojilojilojilojilojilZTilZ0gICAg4paI4paI4pWU4paI4paI4paI4paI4pWU4paI4paI4pWR4paI4paI4paI4paI4paI4pWXICAgICDilojilojilZEgICDilojilojilojilojilojilojilojilZHilojilojilZEgICDilojilojilZHilojilojilZEgIOKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlwogIC8vIOKVmuKVkOKVkOKVkOKVkOKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVnSAgICAg4paI4paI4pWRICAg4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4pWQ4pWdICAgICDilojilojilZHilZrilojilojilZTilZ3ilojilojilZHilojilojilZTilZDilZDilZ0gICAgIOKWiOKWiOKVkSAgIOKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVkeKWiOKWiOKVkSAgIOKWiOKWiOKVkeKWiOKWiOKVkSAg4paI4paI4pWR4pWa4pWQ4pWQ4pWQ4pWQ4paI4paI4pWRCiAgLy8g4paI4paI4paI4paI4paI4paI4paI4pWR4paI4paI4paI4paI4paI4paI4paI4pWXICAg4paI4paI4pWRICAg4pWa4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4pWRICAgICAgICAg4paI4paI4pWRIOKVmuKVkOKVnSDilojilojilZHilojilojilojilojilojilojilojilZcgICDilojilojilZEgICDilojilojilZEgIOKWiOKWiOKVkeKVmuKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkQogIC8vIOKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVnSAgIOKVmuKVkOKVnSAgICDilZrilZDilZDilZDilZDilZDilZ0g4pWa4pWQ4pWdICAgICAgICAg4pWa4pWQ4pWdICAgICDilZrilZDilZ3ilZrilZDilZDilZDilZDilZDilZDilZ0gICDilZrilZDilZ0gICDilZrilZDilZ0gIOKVmuKVkOKVnSDilZrilZDilZDilZDilZDilZDilZ0g4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVnQoKICBmdW5jdGlvbiBzZXRGbGFncygKICAgIC8vIFNob3VsZCBiZSB3aGl0ZWxpc3RlZCB0byBidXkgdG9rZW5zCiAgICBib29sIF9pc1doaXRlbGlzdGVkLAogICAgLy8gU2hvdWxkIGJlIGtub3duIHVzZXIgdG8gYnV5IHRva2VucwogICAgYm9vbCBfaXNLbm93bk9ubHksCiAgICAvLyBFbmFibGUgYW1vdW50IGJvbnVzZXMgaW4gY3Jvd2RzYWxlPwogICAgYm9vbCBfaXNBbW91bnRCb251cywKICAgIC8vIEVuYWJsZSBlYXJseSBiaXJkIGJvbnVzIGluIGNyb3dkc2FsZT8KICAgIGJvb2wgX2lzRWFybHlCb251cywKICAgIC8vIEFsbG93IHRvIGJ1eSB0b2tlbnMgZm9yIGFub3RoZXIgdG9rZW5zPwogICAgYm9vbCBfaXNUb2tlbkV4Y2hhbmdlLAogICAgLy8gQWxsb3cgdG8gaXNzdWUgdG9rZW5zIHdpdGggdHggaGFzaCAoZXggYml0Y29pbikKICAgIGJvb2wgX2lzQWxsb3dUb0lzc3VlLAogICAgLy8gU2hvdWxkIHJlamVjdCBwdXJjaGFzZXMgd2l0aCBFdGhlcj8KICAgIGJvb2wgX2lzRGlzYWJsZUV0aGVyLAogICAgLy8gU2hvdWxkIG1pbnQgZXh0cmEgdG9rZW5zIGZvciBmdXR1cmUgZGlzdHJpYnV0aW9uPwogICAgYm9vbCBfaXNFeHRyYURpc3RyaWJ1dGlvbiwKICAgIC8vIFdpbGwgc2hpcCB0b2tlbiB2aWEgbWludGluZz8gCiAgICBib29sIF9pc1RyYW5zZmVyU2hpcG1lbnQsCiAgICAvLyBTaG91bGQgYmUgY2FwcGVkIGluIGV0aGVyCiAgICBib29sIF9pc0NhcHBlZEluRXRoZXIsCiAgICAvLyBTaG91bGQgYmVuZWZpY2lhcmllcyBwdWxsIHRoZWlyIHRva2Vucz8gCiAgICBib29sIF9pc1BlcnNvbmFsQm9udXNlcywKICAgIC8vIFNob3VsZCBhbGxvdyB0byBjbGFpbSBmdW5kcyBiZWZvcmUgZmluYWxpemF0aW9uPwogICAgYm9vbCBfaXNBbGxvd0NsYWltQmVmb3JlRmluYWxpemF0aW9uKQogICAgaW5TdGF0ZShTdGF0ZS5TZXR1cCkgb25seU93bmVyIHB1YmxpYyAKICB7CiAgICBpc1doaXRlbGlzdGVkID0gX2lzV2hpdGVsaXN0ZWQ7CiAgICBpc0tub3duT25seSA9IF9pc0tub3duT25seTsKICAgIGlzQW1vdW50Qm9udXMgPSBfaXNBbW91bnRCb251czsKICAgIGlzRWFybHlCb251cyA9IF9pc0Vhcmx5Qm9udXM7CiAgICBpc1Rva2VuRXhjaGFuZ2UgPSBfaXNUb2tlbkV4Y2hhbmdlOwogICAgaXNBbGxvd1RvSXNzdWUgPSBfaXNBbGxvd1RvSXNzdWU7CiAgICBpc0Rpc2FibGVFdGhlciA9IF9pc0Rpc2FibGVFdGhlcjsKICAgIGlzRXh0cmFEaXN0cmlidXRpb24gPSBfaXNFeHRyYURpc3RyaWJ1dGlvbjsKICAgIGlzVHJhbnNmZXJTaGlwbWVudCA9IF9pc1RyYW5zZmVyU2hpcG1lbnQ7CiAgICBpc0NhcHBlZEluRXRoZXIgPSBfaXNDYXBwZWRJbkV0aGVyOwogICAgaXNQZXJzb25hbEJvbnVzZXMgPSBfaXNQZXJzb25hbEJvbnVzZXM7CiAgICBpc0FsbG93Q2xhaW1CZWZvcmVGaW5hbGl6YXRpb24gPSBfaXNBbGxvd0NsYWltQmVmb3JlRmluYWxpemF0aW9uOwogIH0KCiAgLy8gISBDb3VsZCBiZSBjaGFuZ2VkIGluIHByb2Nlc3Mgb2Ygc2FsZSAoc2luY2UgMDIuMjAxOCkKICBmdW5jdGlvbiBzZXRNaW5pbXVtKHVpbnQgX2Ftb3VudCwgYm9vbCBfaW5Ub2tlbikgCiAgICBvbmx5T3duZXIgcHVibGljCiAgewogICAgaWYgKF9hbW91bnQgPT0gMCkgewogICAgICBpc01pbmltdW1WYWx1ZSA9IGZhbHNlOwogICAgICBtaW5pbXVtUHVyY2hhc2VWYWx1ZSA9IDA7CiAgICB9IGVsc2UgewogICAgICBpc01pbmltdW1WYWx1ZSA9IHRydWU7CiAgICAgIGlzTWluaW11bUluRXRoZXIgPSAhX2luVG9rZW47CiAgICAgIG1pbmltdW1QdXJjaGFzZVZhbHVlID0gX2Ftb3VudDsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHNldFByaWNlKHVpbnQgX3ByaWNlKQogICAgaW5TdGF0ZShTdGF0ZS5TZXR1cCkgb25seU93bmVyIHB1YmxpYwogIHsKICAgIHJlcXVpcmUoX3ByaWNlID4gMCk7CiAgICBwcmljZSA9IF9wcmljZTsKICB9CgogIGZ1bmN0aW9uIHNldFNvZnRIYXJkQ2Fwcyh1aW50IF9zb2Z0Q2FwLCB1aW50IF9oYXJkQ2FwKQogICAgaW5TdGF0ZShTdGF0ZS5TZXR1cCkgb25seU93bmVyIHB1YmxpYwogIHsKICAgIGhhcmRDYXAgPSBfaGFyZENhcDsKICAgIHNvZnRDYXAgPSBfc29mdENhcDsKICB9CgogIGZ1bmN0aW9uIHNldFRpbWUodWludCBfc3RhcnQsIHVpbnQgX2VuZCkKICAgIGluU3RhdGUoU3RhdGUuU2V0dXApIG9ubHlPd25lciBwdWJsaWMgCiAgewogICAgcmVxdWlyZShfc3RhcnQgPCBfZW5kKTsKICAgIHJlcXVpcmUoX2VuZCA+IGJsb2NrLnRpbWVzdGFtcCk7CiAgICBzdGFydFRpbWUgPSBfc3RhcnQ7CiAgICBlbmRUaW1lID0gX2VuZDsKICB9CgogIGZ1bmN0aW9uIHNldFRva2VuKGFkZHJlc3MgX3Rva2VuQWRkcmVzcykgCiAgICBpblN0YXRlKFN0YXRlLlNldHVwKSBvbmx5T3duZXIgcHVibGljCiAgewogICAgdG9rZW4gPSBNaW50YWJsZVRva2VuSW50ZXJmYWNlKF90b2tlbkFkZHJlc3MpOwogICAgdG9rZW5EZWNpbWFscyA9IHRva2VuLmRlY2ltYWxzKCk7CiAgfQoKICBmdW5jdGlvbiBzZXRXYWxsZXQoYWRkcmVzcyBfd2FsbGV0KSAKICAgIGluU3RhdGUoU3RhdGUuU2V0dXApIG9ubHlPd25lciBwdWJsaWMgCiAgewogICAgcmVxdWlyZShfd2FsbGV0ICE9IGFkZHJlc3MoMCkpOwogICAgd2FsbGV0ID0gX3dhbGxldDsKICB9CiAgCiAgZnVuY3Rpb24gc2V0UmVnaXN0cnkoYWRkcmVzcyBfcmVnaXN0cnkpIAogICAgaW5TdGF0ZShTdGF0ZS5TZXR1cCkgb25seU93bmVyIHB1YmxpYyAKICB7CiAgICByZXF1aXJlKF9yZWdpc3RyeSAhPSBhZGRyZXNzKDApKTsKICAgIHVzZXJSZWdpc3RyeSA9IFVzZXJSZWdpc3RyeUludGVyZmFjZShfcmVnaXN0cnkpOwogIH0KCiAgZnVuY3Rpb24gc2V0RXh0cmFEaXN0cmlidXRpb24oYWRkcmVzcyBfaG9sZGVyLCB1aW50IF9leHRyYVBhcnQpIAogICAgaW5TdGF0ZShTdGF0ZS5TZXR1cCkgb25seU93bmVyIHB1YmxpYwogIHsKICAgIHJlcXVpcmUoX2hvbGRlciAhPSBhZGRyZXNzKDApKTsKICAgIGV4dHJhVG9rZW5zSG9sZGVyID0gX2hvbGRlcjsKICAgIGV4dHJhRGlzdHJpYnV0aW9uUGFydCA9IF9leHRyYVBhcnQ7CiAgfQoKICBmdW5jdGlvbiBzZXRBbW91bnRCb251c2VzKHVpbnRbXSBfYW1vdW50U2xpY2VzLCB1aW50W10gX2JvbnVzZXMpIAogICAgaW5TdGF0ZShTdGF0ZS5TZXR1cCkgb25seU93bmVyIHB1YmxpYyAKICB7CiAgICByZXF1aXJlKF9hbW91bnRTbGljZXMubGVuZ3RoID4gMSk7CiAgICByZXF1aXJlKF9ib251c2VzLmxlbmd0aCA9PSBfYW1vdW50U2xpY2VzLmxlbmd0aCk7CiAgICB1aW50IGxhc3RTbGljZSA9IDA7CiAgICBmb3IgKHVpbnQgaW5kZXggPSAwOyBpbmRleCA8IF9hbW91bnRTbGljZXMubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgIHJlcXVpcmUoX2Ftb3VudFNsaWNlc1tpbmRleF0gPiBsYXN0U2xpY2UpOwogICAgICBsYXN0U2xpY2UgPSBfYW1vdW50U2xpY2VzW2luZGV4XTsKICAgICAgYW1vdW50U2xpY2VzLnB1c2gobGFzdFNsaWNlKTsKICAgICAgYW1vdW50Qm9udXNlc1tsYXN0U2xpY2VdID0gX2JvbnVzZXNbaW5kZXhdOwogICAgfQoKICAgIGFtb3VudFNsaWNlc0NvdW50ID0gYW1vdW50U2xpY2VzLmxlbmd0aDsKICB9CgogIGZ1bmN0aW9uIHNldFRpbWVCb251c2VzKHVpbnRbXSBfdGltZVNsaWNlcywgdWludFtdIF9ib251c2VzKSAKICAgIC8vICEgTm90IG5lZWQgdG8gY2hlY2sgc3RhdGUgc2luY2UgY2hhbmdlcyBhdCAwMi4yMDE4CiAgICAvLyBpblN0YXRlKFN0YXRlLlNldHVwKQogICAgb25seU93bmVyIAogICAgcHVibGljIAogIHsKICAgIC8vIE9ubHkgb25jZSBpbiBsaWZlIHRpbWUKICAgIC8vICEgVGltZSBib251c2VzIGlzIGNoYW5nYWJsZSBhZnRlciAwMi4yMDE4CiAgICAvLyByZXF1aXJlKHRpbWVTbGljZXNDb3VudCA9PSAwKTsKICAgIHJlcXVpcmUoX3RpbWVTbGljZXMubGVuZ3RoID4gMCk7CiAgICByZXF1aXJlKF9ib251c2VzLmxlbmd0aCA9PSBfdGltZVNsaWNlcy5sZW5ndGgpOwogICAgdWludCBsYXN0U2xpY2UgPSAwOwogICAgdWludCBsYXN0Qm9udXMgPSAxMDAwMDsKICAgIGlmICh0aW1lU2xpY2VzQ291bnQgPiAwKSB7CiAgICAgIC8vICEgU2luY2UgdGltZSBib251c2VzIGlzIGNoYW5nYWJsZSB3ZSBzaG91bGQgdGFrZSBsYXRlc3QgZmlyc3QKICAgICAgbGFzdFNsaWNlID0gdGltZVNsaWNlc1t0aW1lU2xpY2VzQ291bnQgLSAxXTsKICAgICAgbGFzdEJvbnVzID0gdGltZUJvbnVzZXNbbGFzdFNsaWNlXTsKICAgIH0KCiAgICBmb3IgKHVpbnQgaW5kZXggPSAwOyBpbmRleCA8IF90aW1lU2xpY2VzLmxlbmd0aDsgaW5kZXgrKykgewogICAgICByZXF1aXJlKF90aW1lU2xpY2VzW2luZGV4XSA+IGxhc3RTbGljZSk7CgogICAgICAvLyAhIEFkZCBjaGVjayBmb3IgbmV4dCBib251cyBpcyBlcXVhbCBvciBsZXNzIHRoYW4gcHJldmlvdXMKICAgICAgcmVxdWlyZShfYm9udXNlc1tpbmRleF0gPD0gbGFzdEJvbnVzKTsKCiAgICAgIC8vID8gU2hvdWxkIHdlIGNoZWNrIGJvbnVzIGluIGEgZnV0dXJlCiAgICAgIGxhc3RTbGljZSA9IF90aW1lU2xpY2VzW2luZGV4XTsKICAgICAgdGltZVNsaWNlcy5wdXNoKGxhc3RTbGljZSk7CiAgICAgIHRpbWVCb251c2VzW2xhc3RTbGljZV0gPSBfYm9udXNlc1tpbmRleF07CiAgICB9CiAgICB0aW1lU2xpY2VzQ291bnQgPSB0aW1lU2xpY2VzLmxlbmd0aDsKICB9CiAgCiAgZnVuY3Rpb24gc2V0VG9rZW5FeGNhbmdlKGFkZHJlc3MgX3Rva2VuLCB1aW50IF92YWx1ZSkKICAgIGluU3RhdGUoU3RhdGUuU2V0dXApIG9ubHlPd25lciBwdWJsaWMKICB7CiAgICBhbGxvd2VkVG9rZW5zW190b2tlbl0gPSBUb2tlbkludGVyZmFjZShfdG9rZW4pOwogICAgdXBkYXRlVG9rZW5WYWx1ZShfdG9rZW4sIF92YWx1ZSk7IAogIH0KCiAgZnVuY3Rpb24gc2FuZUl0KCkgCiAgICBpblN0YXRlKFN0YXRlLlNldHVwKSBvbmx5T3duZXIgcHVibGljIAogIHsKICAgIHJlcXVpcmUoc3RhcnRUaW1lIDwgZW5kVGltZSk7CiAgICByZXF1aXJlKGVuZFRpbWUgPiBub3cpOwoKICAgIHJlcXVpcmUocHJpY2UgPiAwKTsKCiAgICByZXF1aXJlKHdhbGxldCAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUodG9rZW4gIT0gYWRkcmVzcygwKSk7CgogICAgaWYgKGlzS25vd25Pbmx5KSB7CiAgICAgIHJlcXVpcmUodXNlclJlZ2lzdHJ5ICE9IGFkZHJlc3MoMCkpOwogICAgfQoKICAgIGlmIChpc0Ftb3VudEJvbnVzKSB7CiAgICAgIHJlcXVpcmUoYW1vdW50U2xpY2VzQ291bnQgPiAwKTsKICAgIH0KCiAgICBpZiAoaXNFeHRyYURpc3RyaWJ1dGlvbikgewogICAgICByZXF1aXJlKGV4dHJhVG9rZW5zSG9sZGVyICE9IGFkZHJlc3MoMCkpOwogICAgfQoKICAgIGlmIChpc1RyYW5zZmVyU2hpcG1lbnQpIHsKICAgICAgcmVxdWlyZSh0b2tlbi5iYWxhbmNlT2YoYWRkcmVzcyh0aGlzKSkgPj0gaGFyZENhcCk7CiAgICB9IGVsc2UgewogICAgICByZXF1aXJlKHRva2VuLm93bmVyKCkgPT0gYWRkcmVzcyh0aGlzKSk7CiAgICB9CgogICAgc3RhdGUgPSBTdGF0ZS5BY3RpdmU7CiAgfQoKICBmdW5jdGlvbiBmaW5hbGl6ZUl0KGFkZHJlc3MgX2Z1dHVyZU93bmVyKSBpblN0YXRlKFN0YXRlLkFjdGl2ZSkgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKGVuZGVkKCkpOwoKICAgIHRva2VuLnRyYW5zZmVyT3duZXJzaGlwKF9mdXR1cmVPd25lcik7CgogICAgaWYgKHN1Y2Nlc3MoKSkgewogICAgICBzdGF0ZSA9IFN0YXRlLkNsYWltOwogICAgfSBlbHNlIHsKICAgICAgc3RhdGUgPSBTdGF0ZS5SZWZ1bmQ7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBoaXN0b3J5SXQoKSBpblN0YXRlKFN0YXRlLkNsYWltKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUoYWRkcmVzcyh0aGlzKS5iYWxhbmNlID09IDApOwogICAgc3RhdGUgPSBTdGF0ZS5IaXN0b3J5OwogIH0KCiAgLy8g4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4pWXICDilojilojilZfilojilojilojilojilojilojilojilZcg4paI4paI4paI4paI4paI4paI4pWX4paI4paI4pWXICAg4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWXCiAgLy8g4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4pWa4paI4paI4pWX4paI4paI4pWU4pWd4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWRICAg4paI4paI4pWR4pWa4pWQ4pWQ4paI4paI4pWU4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWdCiAgLy8g4paI4paI4paI4paI4paI4pWXICAg4pWa4paI4paI4paI4pWU4pWdIOKWiOKWiOKWiOKWiOKWiOKVlyAg4paI4paI4pWRICAgICDilojilojilZEgICDilojilojilZEgICDilojilojilZEgICDilojilojilojilojilojilZcgIAogIC8vIOKWiOKWiOKVlOKVkOKVkOKVnSAgIOKWiOKWiOKVlOKWiOKWiOKVlyDilojilojilZTilZDilZDilZ0gIOKWiOKWiOKVkSAgICAg4paI4paI4pWRICAg4paI4paI4pWRICAg4paI4paI4pWRICAg4paI4paI4pWU4pWQ4pWQ4pWdICAKICAvLyDilojilojilojilojilojilojilojilZfilojilojilZTilZ0g4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWX4pWa4paI4paI4paI4paI4paI4paI4pWX4pWa4paI4paI4paI4paI4paI4paI4pWU4pWdICAg4paI4paI4pWRICAg4paI4paI4paI4paI4paI4paI4paI4pWXCiAgLy8g4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWdICDilZrilZDilZ3ilZrilZDilZDilZDilZDilZDilZDilZ0g4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVkOKVkOKVkOKVkOKVnSAgICDilZrilZDilZ0gICDilZrilZDilZDilZDilZDilZDilZDilZ0KCiAgZnVuY3Rpb24gY2FsY3VsYXRlRXRoQW1vdW50KAogICAgYWRkcmVzcyBfYmVuZWZpY2lhcnksCiAgICB1aW50IF93ZWlBbW91bnQsCiAgICB1aW50IF90aW1lLAogICAgdWludCBfdG90YWxTdXBwbHkKICApIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKAogICAgdWludCBjYWxjdWxhdGVkVG90YWwsIAogICAgdWludCBjYWxjdWxhdGVkQmVuZWZpY2lhcnksIAogICAgdWludCBjYWxjdWxhdGVkRXh0cmEsIAogICAgdWludCBjYWxjdWxhdGVkcmVmZXJlciwgCiAgICBhZGRyZXNzIHJlZmVyZXJBZGRyZXNzKSAKICB7CiAgICBfdG90YWxTdXBwbHk7CiAgICB1aW50IGJvbnVzID0gMDsKICAgIAogICAgaWYgKGlzQW1vdW50Qm9udXMpIHsKICAgICAgYm9udXMgPSBib251cy5hZGQoY2FsY3VsYXRlQW1vdW50Qm9udXMoX3dlaUFtb3VudCkpOwogICAgfQoKICAgIGlmIChpc0Vhcmx5Qm9udXMpIHsKICAgICAgYm9udXMgPSBib251cy5hZGQoY2FsY3VsYXRlVGltZUJvbnVzKF90aW1lLnN1YihzdGFydFRpbWUpKSk7CiAgICB9CgogICAgaWYgKGlzUGVyc29uYWxCb251c2VzICYmIHBlcnNvbmFsQm9udXNlc1tfYmVuZWZpY2lhcnldLmJvbnVzID4gMCkgewogICAgICBib251cyA9IGJvbnVzLmFkZChwZXJzb25hbEJvbnVzZXNbX2JlbmVmaWNpYXJ5XS5ib251cyk7CiAgICB9CgogICAgY2FsY3VsYXRlZEJlbmVmaWNpYXJ5ID0gX3dlaUFtb3VudC5tdWwoMTAgKiogdG9rZW5EZWNpbWFscykuZGl2KHByaWNlKTsKICAgIGlmIChib251cyA+IDApIHsKICAgICAgY2FsY3VsYXRlZEJlbmVmaWNpYXJ5ID0gY2FsY3VsYXRlZEJlbmVmaWNpYXJ5LmFkZChjYWxjdWxhdGVkQmVuZWZpY2lhcnkubXVsKGJvbnVzKS5kaXYoMTAwMDApKTsKICAgIH0KCiAgICBpZiAoaXNFeHRyYURpc3RyaWJ1dGlvbikgewogICAgICBjYWxjdWxhdGVkRXh0cmEgPSBjYWxjdWxhdGVkQmVuZWZpY2lhcnkubXVsKGV4dHJhRGlzdHJpYnV0aW9uUGFydCkuZGl2KDEwMDAwKTsKICAgIH0KCiAgICBpZiAoaXNQZXJzb25hbEJvbnVzZXMgJiYgCiAgICAgICAgcGVyc29uYWxCb251c2VzW19iZW5lZmljaWFyeV0ucmVmZXJlckFkZHJlc3MgIT0gYWRkcmVzcygwKSAmJiAKICAgICAgICBwZXJzb25hbEJvbnVzZXNbX2JlbmVmaWNpYXJ5XS5yZWZlcmVyQm9udXMgPiAwKSAKICAgIHsKICAgICAgY2FsY3VsYXRlZHJlZmVyZXIgPSBjYWxjdWxhdGVkQmVuZWZpY2lhcnkubXVsKHBlcnNvbmFsQm9udXNlc1tfYmVuZWZpY2lhcnldLnJlZmVyZXJCb251cykuZGl2KDEwMDAwKTsKICAgICAgcmVmZXJlckFkZHJlc3MgPSBwZXJzb25hbEJvbnVzZXNbX2JlbmVmaWNpYXJ5XS5yZWZlcmVyQWRkcmVzczsKICAgIH0KCiAgICBjYWxjdWxhdGVkVG90YWwgPSBjYWxjdWxhdGVkQmVuZWZpY2lhcnkuYWRkKGNhbGN1bGF0ZWRFeHRyYSkuYWRkKGNhbGN1bGF0ZWRyZWZlcmVyKTsKICB9CgogIGZ1bmN0aW9uIGNhbGN1bGF0ZUFtb3VudEJvbnVzKHVpbnQgX2NoYW5nZUFtb3VudCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludCkgewogICAgdWludCBib251cyA9IDA7CiAgICBmb3IgKHVpbnQgaW5kZXggPSAwOyBpbmRleCA8IGFtb3VudFNsaWNlcy5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgaWYoYW1vdW50U2xpY2VzW2luZGV4XSA+IF9jaGFuZ2VBbW91bnQpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgYm9udXMgPSBhbW91bnRCb251c2VzW2Ftb3VudFNsaWNlc1tpbmRleF1dOwogICAgfQogICAgcmV0dXJuIGJvbnVzOwogIH0KCiAgZnVuY3Rpb24gY2FsY3VsYXRlVGltZUJvbnVzKHVpbnQgX2F0KSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50KSB7CiAgICB1aW50IGJvbnVzID0gMDsKICAgIGZvciAodWludCBpbmRleCA9IHRpbWVTbGljZXMubGVuZ3RoOyBpbmRleCA+IDA7IGluZGV4LS0pIHsKICAgICAgaWYodGltZVNsaWNlc1tpbmRleCAtIDFdIDwgX2F0KSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgYm9udXMgPSB0aW1lQm9udXNlc1t0aW1lU2xpY2VzW2luZGV4IC0gMV1dOwogICAgfQoKICAgIHJldHVybiBib251czsKICB9CgogIGZ1bmN0aW9uIHZhbGlkUHVyY2hhc2UoCiAgICBhZGRyZXNzIF9iZW5lZmljaWFyeSwgCiAgICB1aW50IF93ZWlBbW91bnQsIAogICAgdWludCBfdG9rZW5BbW91bnQsCiAgICB1aW50IF9leHRyYUFtb3VudCwKICAgIHVpbnQgX3RvdGFsQW1vdW50LAogICAgdWludCBfdGltZSkgCiAgcHVibGljIGNvbnN0YW50IHJldHVybnMoYm9vbCkgCiAgewogICAgX3Rva2VuQW1vdW50OwogICAgX2V4dHJhQW1vdW50OwoKICAgIC8vICEgQ2hlY2sgbWluIHB1cmNoYXNlIHZhbHVlIChzaW5jZSAwMi4yMDE4KQogICAgaWYgKGlzTWluaW11bVZhbHVlKSB7CiAgICAgIC8vICEgQ2hlY2sgbWluIHB1cmNoYXNlIHZhbHVlIGluIGV0aGVyIChzaW5jZSAwMi4yMDE4KQogICAgICBpZiAoaXNNaW5pbXVtSW5FdGhlciAmJiBfd2VpQW1vdW50IDwgbWluaW11bVB1cmNoYXNlVmFsdWUpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIC8vICEgQ2hlY2sgbWluIHB1cmNoYXNlIHZhbHVlIGluIHRva2VucyAoc2luY2UgMDIuMjAxOCkKICAgICAgaWYgKCFpc01pbmltdW1JbkV0aGVyICYmIF90b2tlbkFtb3VudCA8IG1pbmltdW1QdXJjaGFzZVZhbHVlKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CgogICAgaWYgKF90aW1lIDwgc3RhcnRUaW1lIHx8IF90aW1lID4gZW5kVGltZSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgaWYgKGlzS25vd25Pbmx5ICYmICF1c2VyUmVnaXN0cnkua25vd25BZGRyZXNzKF9iZW5lZmljaWFyeSkpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHVpbnQgZmluYWxCZW5lZmljaWFyeUludmVzdCA9IGJlbmVmaWNpYXJ5SW52ZXN0W19iZW5lZmljaWFyeV0uYWRkKF93ZWlBbW91bnQpOwogICAgdWludCBmaW5hbFRvdGFsU3VwcGx5ID0gc29sZFRva2Vucy5hZGQoX3RvdGFsQW1vdW50KTsKCiAgICBpZiAoaXNXaGl0ZWxpc3RlZCkgewogICAgICBXaGl0ZWxpc3RSZWNvcmQgc3RvcmFnZSByZWNvcmQgPSB3aGl0ZWxpc3RbX2JlbmVmaWNpYXJ5XTsKICAgICAgaWYgKCFyZWNvcmQuYWxsb3cgfHwgCiAgICAgICAgICByZWNvcmQubWluID4gZmluYWxCZW5lZmljaWFyeUludmVzdCB8fAogICAgICAgICAgcmVjb3JkLm1heCA8IGZpbmFsQmVuZWZpY2lhcnlJbnZlc3QpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoaXNDYXBwZWRJbkV0aGVyKSB7CiAgICAgIGlmICh3ZWlSYWlzZWQuYWRkKF93ZWlBbW91bnQpID4gaGFyZENhcCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYgKGZpbmFsVG90YWxTdXBwbHkgPiBoYXJkQ2FwKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogIGZ1bmN0aW9uIHVwZGF0ZVRva2VuVmFsdWUoYWRkcmVzcyBfdG9rZW4sIHVpbnQgX3ZhbHVlKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUoYWRkcmVzcyhhbGxvd2VkVG9rZW5zW190b2tlbl0pICE9IGFkZHJlc3MoMHgwKSk7CiAgICB0b2tlbnNWYWx1ZXNbX3Rva2VuXSA9IF92YWx1ZTsKICB9CgogIC8vIOKWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilojilojilojilojilZcg4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKWiOKWiOKWiOKWiOKVlyAKICAvLyDilojilojilZTilZDilZDilojilojilZfilojilojilZTilZDilZDilZDilZDilZ3ilojilojilZTilZDilZDilojilojilZfilojilojilZTilZDilZDilojilojilZcKICAvLyDilojilojilojilojilojilojilZTilZ3ilojilojilojilojilojilZcgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkeKWiOKWiOKVkSAg4paI4paI4pWRCiAgLy8g4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4pWdICDilojilojilZTilZDilZDilojilojilZHilojilojilZEgIOKWiOKWiOKVkQogIC8vIOKWiOKWiOKVkSAg4paI4paI4pWR4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4pWRICDilojilojilZHilojilojilojilojilojilojilZTilZ0KICAvLyDilZrilZDilZ0gIOKVmuKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVnSAg4pWa4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIAogIGZ1bmN0aW9uIHN1Y2Nlc3MoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyhib29sKSB7CiAgICBpZiAoaXNDYXBwZWRJbkV0aGVyKSB7CiAgICAgIHJldHVybiB3ZWlSYWlzZWQgPj0gc29mdENhcDsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB0b2tlbi50b3RhbFN1cHBseSgpID49IHNvZnRDYXA7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjYXBwZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyhib29sKSB7CiAgICBpZiAoaXNDYXBwZWRJbkV0aGVyKSB7CiAgICAgIHJldHVybiB3ZWlSYWlzZWQgPj0gaGFyZENhcDsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB0b2tlbi50b3RhbFN1cHBseSgpID49IGhhcmRDYXA7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBlbmRlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKGJvb2wpIHsKICAgIHJldHVybiBjYXBwZWQoKSB8fCBibG9jay50aW1lc3RhbXAgPj0gZW5kVGltZTsKICB9CgoKICAvLyAg4paI4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKVlyAgIOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilojilojilojilojilZcKICAvLyDilojilojilZTilZDilZDilZDilojilojilZfilojilojilZEgICDilojilojilZHilZrilZDilZDilojilojilZTilZDilZDilZ3ilojilojilZTilZDilZDilZDilZDilZ3ilojilojilZHilojilojilZTilZDilZDilojilojilZfilojilojilZTilZDilZDilZDilZDilZ0KICAvLyDilojilojilZEgICDilojilojilZHilojilojilZEgICDilojilojilZEgICDilojilojilZEgICDilojilojilojilojilojilojilojilZfilojilojilZHilojilojilZEgIOKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKVlyAgCiAgLy8g4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWRICAg4paI4paI4pWRICAg4paI4paI4pWRICAg4pWa4pWQ4pWQ4pWQ4pWQ4paI4paI4pWR4paI4paI4pWR4paI4paI4pWRICDilojilojilZHilojilojilZTilZDilZDilZ0gIAogIC8vIOKVmuKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKVmuKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVnSAgIOKWiOKWiOKVkSAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlwogIC8vICDilZrilZDilZDilZDilZDilZDilZ0gIOKVmuKVkOKVkOKVkOKVkOKVkOKVnSAgICDilZrilZDilZ0gICDilZrilZDilZDilZDilZDilZDilZDilZ3ilZrilZDilZ3ilZrilZDilZDilZDilZDilZDilZ0g4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdCiAgLy8gZmFsbGJhY2sgZnVuY3Rpb24gY2FuIGJlIHVzZWQgdG8gYnV5IHRva2VucwogIGZ1bmN0aW9uICgpIGV4dGVybmFsIHBheWFibGUgewogICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwogIH0KCiAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgX2JlbmVmaWNpYXJ5KSBpblN0YXRlKFN0YXRlLkFjdGl2ZSkgcHVibGljIHBheWFibGUgewogICAgcmVxdWlyZSghaXNEaXNhYmxlRXRoZXIpOwogICAgdWludCBzaGlwQW1vdW50ID0gc2VsbFRva2VucyhfYmVuZWZpY2lhcnksIG1zZy52YWx1ZSwgYmxvY2sudGltZXN0YW1wKTsKICAgIHJlcXVpcmUoc2hpcEFtb3VudCA+IDApOwogICAgZm9yd2FyZEV0aGVyKCk7CiAgfQoKICBmdW5jdGlvbiBidXlXaXRoSGFzaChhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludCBfdmFsdWUsIHVpbnQgX3RpbWVzdGFtcCwgYnl0ZXMzMiBfaGFzaCkgCiAgICBpblN0YXRlKFN0YXRlLkFjdGl2ZSkgb25seU93bmVyIHB1YmxpYyAKICB7CiAgICByZXF1aXJlKGlzQWxsb3dUb0lzc3VlKTsKICAgIHVpbnQgc2hpcEFtb3VudCA9IHNlbGxUb2tlbnMoX2JlbmVmaWNpYXJ5LCBfdmFsdWUsIF90aW1lc3RhbXApOwogICAgcmVxdWlyZShzaGlwQW1vdW50ID4gMCk7CiAgICBIYXNoQnV5KF9iZW5lZmljaWFyeSwgX3ZhbHVlLCBzaGlwQW1vdW50LCBfdGltZXN0YW1wLCBfaGFzaCk7CiAgfQogIAogIGZ1bmN0aW9uIHJlY2VpdmVBcHByb3ZhbChhZGRyZXNzIF9mcm9tLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDI1NiBfdmFsdWUsIAogICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzIF90b2tlbiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ5dGVzIF9leHRyYURhdGEpIHB1YmxpYyAKICB7CiAgICBpZiAoX3Rva2VuID09IGFkZHJlc3ModG9rZW4pKSB7CiAgICAgIFRva2VuSW50ZXJmYWNlKF90b2tlbikudHJhbnNmZXJGcm9tKF9mcm9tLCBhZGRyZXNzKHRoaXMpLCBfdmFsdWUpOwogICAgICByZXR1cm47CiAgICB9CgogICAgcmVxdWlyZShpc1Rva2VuRXhjaGFuZ2UpOwogICAgCiAgICByZXF1aXJlKHRvVWludChfZXh0cmFEYXRhKSA9PSB0b2tlbnNWYWx1ZXNbX3Rva2VuXSk7CiAgICByZXF1aXJlKHRva2Vuc1ZhbHVlc1tfdG9rZW5dID4gMCk7CiAgICByZXF1aXJlKGZvcndhcmRUb2tlbnMoX2Zyb20sIF90b2tlbiwgX3ZhbHVlKSk7CgogICAgdWludCB3ZWlWYWx1ZSA9IF92YWx1ZS5tdWwodG9rZW5zVmFsdWVzW190b2tlbl0pLmRpdigxMCAqKiBhbGxvd2VkVG9rZW5zW190b2tlbl0uZGVjaW1hbHMoKSk7CiAgICByZXF1aXJlKHdlaVZhbHVlID4gMCk7CgogICAgdWludCBzaGlwQW1vdW50ID0gc2VsbFRva2VucyhfZnJvbSwgd2VpVmFsdWUsIGJsb2NrLnRpbWVzdGFtcCk7CiAgICByZXF1aXJlKHNoaXBBbW91bnQgPiAwKTsKCiAgICBBbHRCdXkoX2Zyb20sIF90b2tlbiwgX3ZhbHVlLCB3ZWlWYWx1ZSwgc2hpcEFtb3VudCk7CiAgfQoKICBmdW5jdGlvbiBjbGFpbUZ1bmRzKCkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zKGJvb2wpIHsKICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuQ2xhaW0gfHwgKGlzQWxsb3dDbGFpbUJlZm9yZUZpbmFsaXphdGlvbiAmJiBzdWNjZXNzKCkpKTsKICAgIHdhbGxldC50cmFuc2ZlcihhZGRyZXNzKHRoaXMpLmJhbGFuY2UpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBjbGFpbVRva2VuRnVuZHMoYWRkcmVzcyBfdG9rZW4pIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLkNsYWltIHx8IChpc0FsbG93Q2xhaW1CZWZvcmVGaW5hbGl6YXRpb24gJiYgc3VjY2VzcygpKSk7CiAgICB1aW50IGJhbGFuY2UgPSBhbGxvd2VkVG9rZW5zW190b2tlbl0uYmFsYW5jZU9mKGFkZHJlc3ModGhpcykpOwogICAgcmVxdWlyZShiYWxhbmNlID4gMCk7CiAgICByZXF1aXJlKGFsbG93ZWRUb2tlbnNbX3Rva2VuXS50cmFuc2Zlcih3YWxsZXQsIGJhbGFuY2UpKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gY2xhaW1SZWZ1bmRFdGhlcihhZGRyZXNzIF9iZW5lZmljaWFyeSkgaW5TdGF0ZShTdGF0ZS5SZWZ1bmQpIHB1YmxpYyByZXR1cm5zKGJvb2wpIHsKICAgIHJlcXVpcmUod2VpRGVwb3NpdFtfYmVuZWZpY2lhcnldID4gMCk7CiAgICBfYmVuZWZpY2lhcnkudHJhbnNmZXIod2VpRGVwb3NpdFtfYmVuZWZpY2lhcnldKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gY2xhaW1SZWZ1bmRUb2tlbnMoYWRkcmVzcyBfYmVuZWZpY2lhcnksIGFkZHJlc3MgX3Rva2VuKSBpblN0YXRlKFN0YXRlLlJlZnVuZCkgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgcmVxdWlyZShhbHREZXBvc2l0W190b2tlbl1bX2JlbmVmaWNpYXJ5XSA+IDApOwogICAgcmVxdWlyZShhbGxvd2VkVG9rZW5zW190b2tlbl0udHJhbnNmZXIoX2JlbmVmaWNpYXJ5LCBhbHREZXBvc2l0W190b2tlbl1bX2JlbmVmaWNpYXJ5XSkpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBhZGRUb1doaXRlbGlzdChhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludCBfbWluLCB1aW50IF9tYXgpIG9ubHlPd25lciBwdWJsaWMKICB7CiAgICByZXF1aXJlKF9iZW5lZmljaWFyeSAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX21pbiA8PSBfbWF4KTsKCiAgICBpZiAoX21heCA9PSAwKSB7CiAgICAgIF9tYXggPSAxMCAqKiA0MDsgLy8gc2hvdWxkIGJlIGh1Z2UgZW5vdWdoPyA6MAogICAgfQoKICAgIHdoaXRlbGlzdFtfYmVuZWZpY2lhcnldID0gV2hpdGVsaXN0UmVjb3JkKHRydWUsIF9taW4sIF9tYXgpOwogICAgV2hpdGVsaXN0ZWQoX2JlbmVmaWNpYXJ5LCBfbWluLCBfbWF4KTsKICB9CiAgCiAgZnVuY3Rpb24gc2V0UGVyc29uYWxCb251cygKICAgIGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCAKICAgIHVpbnQgX2JvbnVzLCAKICAgIGFkZHJlc3MgX3JlZmVyZXJBZGRyZXNzLCAKICAgIHVpbnQgX3JlZmVyZXJCb251cykgb25seU93bmVyIHB1YmxpYyB7CiAgICBwZXJzb25hbEJvbnVzZXNbX2JlbmVmaWNpYXJ5XSA9IFBlcnNvbmFsQm9udXNSZWNvcmQoCiAgICAgIF9ib251cywKICAgICAgX3JlZmVyZXJBZGRyZXNzLAogICAgICBfcmVmZXJlckJvbnVzCiAgICApOwoKICAgIFBlcnNvbmFsQm9udXMoX2JlbmVmaWNpYXJ5LCBfcmVmZXJlckFkZHJlc3MsIF9ib251cywgX3JlZmVyZXJCb251cyk7CiAgfQoKICAvLyDilojilojilZfilojilojilojilZcgICDilojilojilZfilojilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilZcg4paI4paI4paI4pWXICAg4paI4paI4pWXIOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilZcgICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlwogIC8vIOKWiOKWiOKVkeKWiOKWiOKWiOKWiOKVlyAg4paI4paI4pWR4pWa4pWQ4pWQ4paI4paI4pWU4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4paI4paI4pWXICDilojilojilZHilojilojilZTilZDilZDilojilojilZfilojilojilZEgICAgIOKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVnQogIC8vIOKWiOKWiOKVkeKWiOKWiOKVlOKWiOKWiOKVlyDilojilojilZEgICDilojilojilZEgICDilojilojilojilojilojilZcgIOKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVlOKWiOKWiOKVlyDilojilojilZHilojilojilojilojilojilojilojilZHilojilojilZEgICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlwogIC8vIOKWiOKWiOKVkeKWiOKWiOKVkeKVmuKWiOKWiOKVl+KWiOKWiOKVkSAgIOKWiOKWiOKVkSAgIOKWiOKWiOKVlOKVkOKVkOKVnSAg4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWR4pWa4paI4paI4pWX4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4paI4paI4pWR4paI4paI4pWRICAgICDilZrilZDilZDilZDilZDilojilojilZEKICAvLyDilojilojilZHilojilojilZEg4pWa4paI4paI4paI4paI4pWRICAg4paI4paI4pWRICAg4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4pWRICDilojilojilZHilojilojilZEg4pWa4paI4paI4paI4paI4pWR4paI4paI4pWRICDilojilojilZHilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilZEKICAvLyDilZrilZDilZ3ilZrilZDilZ0gIOKVmuKVkOKVkOKVkOKVnSAgIOKVmuKVkOKVnSAgIOKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVnSAg4pWa4pWQ4pWd4pWa4pWQ4pWdICDilZrilZDilZDilZDilZ3ilZrilZDilZ0gIOKVmuKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVnQogIC8vIGxvdyBsZXZlbCB0b2tlbiBwdXJjaGFzZSBmdW5jdGlvbgogIGZ1bmN0aW9uIHNlbGxUb2tlbnMoYWRkcmVzcyBfYmVuZWZpY2lhcnksIHVpbnQgX3dlaUFtb3VudCwgdWludCB0aW1lc3RhbXApIAogICAgaW5TdGF0ZShTdGF0ZS5BY3RpdmUpIGludGVybmFsIHJldHVybnModWludCkKICB7CiAgICB1aW50IGJlbmVmaWNpYXJ5VG9rZW5zOwogICAgdWludCBleHRyYVRva2VuczsKICAgIHVpbnQgdG90YWxUb2tlbnM7CiAgICB1aW50IHJlZmVyZXJUb2tlbnM7CiAgICBhZGRyZXNzIHJlZmVyZXJBZGRyZXNzOwogICAgKHRvdGFsVG9rZW5zLCBiZW5lZmljaWFyeVRva2VucywgZXh0cmFUb2tlbnMsIHJlZmVyZXJUb2tlbnMsIHJlZmVyZXJBZGRyZXNzKSA9IGNhbGN1bGF0ZUV0aEFtb3VudCgKICAgICAgX2JlbmVmaWNpYXJ5LCAKICAgICAgX3dlaUFtb3VudCwgCiAgICAgIHRpbWVzdGFtcCwgCiAgICAgIHRva2VuLnRvdGFsU3VwcGx5KCkpOwoKICAgIHJlcXVpcmUodmFsaWRQdXJjaGFzZShfYmVuZWZpY2lhcnksICAgLy8gQ2hlY2sgaWYgY3VycmVudCBwdXJjaGFzZSBpcyB2YWxpZAogICAgICAgICAgICAgICAgICAgICAgICAgIF93ZWlBbW91bnQsIAogICAgICAgICAgICAgICAgICAgICAgICAgIGJlbmVmaWNpYXJ5VG9rZW5zLAogICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhVG9rZW5zLAogICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsVG9rZW5zLAogICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcCkpOwoKICAgIHdlaVJhaXNlZCA9IHdlaVJhaXNlZC5hZGQoX3dlaUFtb3VudCk7IC8vIHVwZGF0ZSBzdGF0ZSAod2VpIGFtb3VudCkKICAgIGJlbmVmaWNpYXJ5SW52ZXN0W19iZW5lZmljaWFyeV0gPSBiZW5lZmljaWFyeUludmVzdFtfYmVuZWZpY2lhcnldLmFkZChfd2VpQW1vdW50KTsKICAgIHNoaXBUb2tlbnMoX2JlbmVmaWNpYXJ5LCBiZW5lZmljaWFyeVRva2Vucyk7ICAgICAvLyBzaGlwIHRva2VucyB0byBiZW5lZmljaWFyeQogICAgRXRoQnV5KG1zZy5zZW5kZXIsICAgICAgICAgICAgIC8vIEZpcmUgcHVyY2hhc2UgZXZlbnQKICAgICAgICAgICAgICAgICAgX2JlbmVmaWNpYXJ5LCAKICAgICAgICAgICAgICAgICAgX3dlaUFtb3VudCwgCiAgICAgICAgICAgICAgICAgIGJlbmVmaWNpYXJ5VG9rZW5zKTsKICAgIFNoaXBUb2tlbnMoX2JlbmVmaWNpYXJ5LCBiZW5lZmljaWFyeVRva2Vucyk7CgogICAgaWYgKGlzRXh0cmFEaXN0cmlidXRpb24pIHsgICAgICAgICAgICAvLyBjYWxjdWxhdGUgYW5kCiAgICAgIHNoaXBUb2tlbnMoZXh0cmFUb2tlbnNIb2xkZXIsIGV4dHJhVG9rZW5zKTsKICAgICAgU2hpcFRva2VucyhleHRyYVRva2Vuc0hvbGRlciwgZXh0cmFUb2tlbnMpOwogICAgfQoKICAgIGlmIChpc1BlcnNvbmFsQm9udXNlcykgewogICAgICBQZXJzb25hbEJvbnVzUmVjb3JkIHN0b3JhZ2UgcmVjb3JkID0gcGVyc29uYWxCb251c2VzW19iZW5lZmljaWFyeV07CiAgICAgIGlmIChyZWNvcmQucmVmZXJlckFkZHJlc3MgIT0gYWRkcmVzcygwKSAmJiByZWNvcmQucmVmZXJlckJvbnVzID4gMCkgewogICAgICAgIHNoaXBUb2tlbnMocmVjb3JkLnJlZmVyZXJBZGRyZXNzLCByZWZlcmVyVG9rZW5zKTsKICAgICAgICBTaGlwVG9rZW5zKHJlY29yZC5yZWZlcmVyQWRkcmVzcywgcmVmZXJlclRva2Vucyk7CiAgICAgIH0KICAgIH0KCiAgICBzb2xkVG9rZW5zID0gc29sZFRva2Vucy5hZGQodG90YWxUb2tlbnMpOwogICAgcmV0dXJuIGJlbmVmaWNpYXJ5VG9rZW5zOwogIH0KCiAgZnVuY3Rpb24gc2hpcFRva2VucyhhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludCBfYW1vdW50KSAKICAgIGluU3RhdGUoU3RhdGUuQWN0aXZlKSBpbnRlcm5hbCAKICB7CiAgICBpZiAoaXNUcmFuc2ZlclNoaXBtZW50KSB7CiAgICAgIHRva2VuLnRyYW5zZmVyKF9iZW5lZmljaWFyeSwgX2Ftb3VudCk7CiAgICB9IGVsc2UgewogICAgICB0b2tlbi5taW50KGFkZHJlc3ModGhpcyksIF9hbW91bnQpOwogICAgICB0b2tlbi50cmFuc2ZlcihfYmVuZWZpY2lhcnksIF9hbW91bnQpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gZm9yd2FyZEV0aGVyKCkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgd2VpRGVwb3NpdFttc2cuc2VuZGVyXSA9IG1zZy52YWx1ZTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gZm9yd2FyZFRva2VucyhhZGRyZXNzIF9iZW5lZmljaWFyeSwgYWRkcmVzcyBfdG9rZW5BZGRyZXNzLCB1aW50IF9hbW91bnQpIGludGVybmFsIHJldHVybnMgKGJvb2wpIHsKICAgIFRva2VuSW50ZXJmYWNlIGFsbG93ZWRUb2tlbiA9IGFsbG93ZWRUb2tlbnNbX3Rva2VuQWRkcmVzc107CiAgICBhbGxvd2VkVG9rZW4udHJhbnNmZXJGcm9tKF9iZW5lZmljaWFyeSwgYWRkcmVzcyh0aGlzKSwgX2Ftb3VudCk7CiAgICBhbHREZXBvc2l0W190b2tlbkFkZHJlc3NdW19iZW5lZmljaWFyeV0gPSBfYW1vdW50OwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLyDilojilojilZcgICDilojilojilZfilojilojilojilojilojilojilojilojilZfilojilojilZfilojilojilZcgICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlwogIC8vIOKWiOKWiOKVkSAgIOKWiOKWiOKVkeKVmuKVkOKVkOKWiOKWiOKVlOKVkOKVkOKVneKWiOKWiOKVkeKWiOKWiOKVkSAgICAg4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWdCiAgLy8g4paI4paI4pWRICAg4paI4paI4pWRICAg4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWRICAgICDilojilojilojilojilojilojilojilZcKICAvLyDilojilojilZEgICDilojilojilZEgICDilojilojilZEgICDilojilojilZHilojilojilZEgICAgIOKVmuKVkOKVkOKVkOKVkOKWiOKWiOKVkQogIC8vIOKVmuKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVnSAgIOKWiOKWiOKVkSAgIOKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkQogIC8vICDilZrilZDilZDilZDilZDilZDilZ0gICAg4pWa4pWQ4pWdICAg4pWa4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdCiAgZnVuY3Rpb24gdG9VaW50KGJ5dGVzIGxlZnQpIHB1YmxpYyBwdXJlIHJldHVybnMgKHVpbnQpIHsKICAgICAgdWludCBvdXQ7CiAgICAgIGZvciAodWludCBpID0gMDsgaSA8IDMyOyBpKyspIHsKICAgICAgICAgIG91dCB8PSB1aW50KGxlZnRbaV0pIDw8ICgzMSAqIDggLSBpICogOCk7CiAgICAgIH0KICAgICAgCiAgICAgIHJldHVybiBvdXQ7CiAgfQp9Cgpjb250cmFjdCBCYXNlQWx0Q3Jvd2RzYWxlIGlzIENyb3dkc2FsZSB7CiAgZnVuY3Rpb24gQmFzZUFsdENyb3dkc2FsZSgKICAgIGFkZHJlc3MgX3JlZ2lzdHJ5LAogICAgYWRkcmVzcyBfdG9rZW4sCiAgICBhZGRyZXNzIF9leHRyYVRva2Vuc0hvbGRlciwKICAgIGFkZHJlc3MgX3dhbGxldCwKICAgIGJvb2wgX2lzV2hpdGVsaXN0ZWQsCiAgICB1aW50IF9wcmljZSwKICAgIHVpbnQgX3N0YXJ0LAogICAgdWludCBfZW5kLAogICAgdWludCBfc29mdENhcCwKICAgIHVpbnQgX2hhcmRDYXAKICApIHB1YmxpYyB7CiAgICBzZXRGbGFncygKICAgICAgLy8gU2hvdWxkIGJlIHdoaXRlbGlzdGVkIHRvIGJ1eSB0b2tlbnMKICAgICAgLy8gX2lzV2hpdGVsaXN0ZWQsCiAgICAgIF9pc1doaXRlbGlzdGVkLAogICAgICAvLyBTaG91bGQgYmUga25vd24gdXNlciB0byBidXkgdG9rZW5zCiAgICAgIC8vIF9pc0tub3duT25seSwKICAgICAgdHJ1ZSwKICAgICAgLy8gRW5hYmxlIGFtb3VudCBib251c2VzIGluIGNyb3dkc2FsZT8gCiAgICAgIC8vIF9pc0Ftb3VudEJvbnVzLAogICAgICB0cnVlLAogICAgICAvLyBFbmFibGUgZWFybHkgYmlyZCBib251cyBpbiBjcm93ZHNhbGU/CiAgICAgIC8vIF9pc0Vhcmx5Qm9udXMsCiAgICAgIHRydWUsCiAgICAgIC8vIEFsbG93IHRvIGJ1eSB0b2tlbnMgZm9yIGFub3RoZXIgdG9rZW5zPwogICAgICAvLyBfaXNUb2tlbkV4Y2FuZ2UsCiAgICAgIGZhbHNlLAogICAgICAvLyBBbGxvdyB0byBpc3N1ZSB0b2tlbnMgd2l0aCB0eCBoYXNoIChleCBiaXRjb2luKQogICAgICAvLyBfaXNBbGxvd1RvSXNzdWUsCiAgICAgIHRydWUsCiAgICAgIC8vIFNob3VsZCByZWplY3QgcHVyY2hhc2VzIHdpdGggRXRoZXI/CiAgICAgIC8vIF9pc0Rpc2FibGVFdGhlciwKICAgICAgZmFsc2UsCiAgICAgIC8vIFNob3VsZCBtaW50IGV4dHJhIHRva2VucyBmb3IgZnV0dXJlIGRpc3RyaWJ1dGlvbj8KICAgICAgLy8gX2lzRXh0cmFEaXN0cmlidXRpb24sCiAgICAgIHRydWUsCiAgICAgIC8vIFdpbGwgc2hpcCB0b2tlbiB2aWEgbWludGluZz8gCiAgICAgIC8vIF9pc1RyYW5zZmVyU2hpcG1lbnQsCiAgICAgIGZhbHNlLAogICAgICAvLyBTaG91bGQgYmUgY2FwcGVkIGluIGV0aGVyCiAgICAgIC8vIGJvb2wgX2lzQ2FwcGVkSW5FdGhlciwKICAgICAgdHJ1ZSwKICAgICAgLy8gU2hvdWxkIGNoZWNrIHBlcnNvbmFsIGJvbnVzZXM/CiAgICAgIC8vIF9pc1BlcnNvbmFsQm9udXNlcwogICAgICB0cnVlLAogICAgICAvLyBTaG91bGQgYWxsb3cgdG8gY2xhaW1GdW5kcyBiZWZvcmUgZmluYWxpemF0aW9ucz8KICAgICAgZmFsc2UKICAgICk7CgogICAgc2V0VG9rZW4oX3Rva2VuKTsgCiAgICBzZXRUaW1lKF9zdGFydCwgX2VuZCk7CiAgICBzZXRSZWdpc3RyeShfcmVnaXN0cnkpOwogICAgc2V0V2FsbGV0KF93YWxsZXQpOwogICAgc2V0RXh0cmFEaXN0cmlidXRpb24oCiAgICAgIF9leHRyYVRva2Vuc0hvbGRlciwKICAgICAgNjY2NyAvLyA2Ni42NyUKICAgICk7CgogICAgc2V0U29mdEhhcmRDYXBzKAogICAgICBfc29mdENhcCwgLy8gc29mdAogICAgICBfaGFyZENhcCAgLy8gaGFyZAogICAgKTsKCiAgICAvLyAyMDAgQUxUIHBlciAxIEVUSAogICAgc2V0UHJpY2UoX3ByaWNlKTsKICB9Cn0KCmNvbnRyYWN0IEFsdENyb3dkc2FsZVBoYXNlT25lIGlzIEJhc2VBbHRDcm93ZHNhbGUgewogIGZ1bmN0aW9uIEFsdENyb3dkc2FsZVBoYXNlT25lICgKICAgIGFkZHJlc3MgX3JlZ2lzdHJ5LAogICAgYWRkcmVzcyBfdG9rZW4sCiAgICBhZGRyZXNzIF9leHRyYVRva2Vuc0hvbGRlciwKICAgIGFkZHJlc3MgX3dhbGxldAogICkKICBCYXNlQWx0Q3Jvd2RzYWxlKAogICAgX3JlZ2lzdHJ5LAogICAgX3Rva2VuLAogICAgX2V4dHJhVG9rZW5zSG9sZGVyLAogICAgX3dhbGxldCwKCiAgICAvLyBXaGl0ZWxpc3RlZAogICAgZmFsc2UsCgogICAgLy8gcHJpY2UgMSBFVEggLT4gMTAwMDAwIEFMVAogICAgdWludCgxIGV0aGVyKS5kaXYoMTAwMDAwKSwgCgogICAgLy8gc3RhcnQKICAgIGJsb2NrLnRpbWVzdGFtcCwKICAgIC8vIGVuZCAKICAgIDE1Mjc3NjQ0MDAsCgogICAgLy8gX3NvZnRDYXAsCiAgICAyNTAwIGV0aGVyLAogICAgLy8gX2hhcmRDYXAKICAgIDc1MDAgZXRoZXIKICApIAogIHB1YmxpYyB7CiAgfSAKfQ=='.
	

]
