Class {
	#name : #SRT78e24e3c9c81d75b22dd1326987089ce537886e9,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT78e24e3c9c81d75b22dd1326987089ce537886e9 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKfQoKY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9Cgpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwoKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICB1aW50MjU2IF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKCiAgICAvLyBDaGVjayBpcyBub3QgbmVlZGVkIGJlY2F1c2Ugc3ViKF9hbGxvd2FuY2UsIF92YWx1ZSkgd2lsbCBhbHJlYWR5IHRocm93IGlmIHRoaXMgY29uZGl0aW9uIGlzIG5vdCBtZXQKICAgIC8vIHJlcXVpcmUgKF92YWx1ZSA8PSBfYWxsb3dhbmNlKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAqCiAgICogQmV3YXJlIHRoYXQgY2hhbmdpbmcgYW4gYWxsb3dhbmNlIHdpdGggdGhpcyBtZXRob2QgYnJpbmdzIHRoZSByaXNrIHRoYXQgc29tZW9uZSBtYXkgdXNlIGJvdGggdGhlIG9sZAogICAqIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZSB0cmFuc2FjdGlvbiBvcmRlcmluZy4gT25lIHBvc3NpYmxlIHNvbHV0aW9uIHRvIG1pdGlnYXRlIHRoaXMKICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KCiAgLyoqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgfSBlbHNlIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKfQoKY29udHJhY3QgTWludGFibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwogIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwoKICBib29sIHB1YmxpYyBtaW50aW5nRmluaXNoZWQgPSBmYWxzZTsKCgogIG1vZGlmaWVyIGNhbk1pbnQoKSB7CiAgICByZXF1aXJlKCFtaW50aW5nRmluaXNoZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gbWludCB0b2tlbnMKICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCByZWNlaXZlIHRoZSBtaW50ZWQgdG9rZW5zLgogICAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIG1pbnQuCiAgICogQHJldHVybiBBIGJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIG9ubHlPd25lciBjYW5NaW50IHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfYW1vdW50KTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfYW1vdW50KTsKICAgIE1pbnQoX3RvLCBfYW1vdW50KTsKICAgIFRyYW5zZmVyKDB4MCwgX3RvLCBfYW1vdW50KTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBzdG9wIG1pbnRpbmcgbmV3IHRva2Vucy4KICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBmaW5pc2hNaW50aW5nKCkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBtaW50aW5nRmluaXNoZWQgPSB0cnVlOwogICAgTWludEZpbmlzaGVkKCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCmNvbnRyYWN0IE11bHRpT3duZXJzIHsKCiAgICBldmVudCBBY2Nlc3NHcmFudChhZGRyZXNzIGluZGV4ZWQgb3duZXIpOwogICAgZXZlbnQgQWNjZXNzUmV2b2tlKGFkZHJlc3MgaW5kZXhlZCBvd25lcik7CiAgICAKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBvd25lcnM7CiAgICBhZGRyZXNzIHB1YmxpYyBwdWJsaXNoZXI7CgoKICAgIGZ1bmN0aW9uIE11bHRpT3duZXJzKCkgewogICAgICAgIG93bmVyc1ttc2cuc2VuZGVyXSA9IHRydWU7CiAgICAgICAgcHVibGlzaGVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5T3duZXIoKSB7IAogICAgICAgIHJlcXVpcmUob3duZXJzW21zZy5zZW5kZXJdID09IHRydWUpOwogICAgICAgIF87IAogICAgfQoKICAgIGZ1bmN0aW9uIGlzT3duZXIoKSBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIG93bmVyc1ttc2cuc2VuZGVyXSA/IHRydWUgOiBmYWxzZTsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGVja093bmVyKGFkZHJlc3MgbWF5YmVfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gb3duZXJzW21heWJlX293bmVyXSA/IHRydWUgOiBmYWxzZTsKICAgIH0KCgogICAgZnVuY3Rpb24gZ3JhbnQoYWRkcmVzcyBfb3duZXIpIG9ubHlPd25lciB7CiAgICAgICAgb3duZXJzW19vd25lcl0gPSB0cnVlOwogICAgICAgIEFjY2Vzc0dyYW50KF9vd25lcik7CiAgICB9CgogICAgZnVuY3Rpb24gcmV2b2tlKGFkZHJlc3MgX293bmVyKSBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoX293bmVyICE9IHB1Ymxpc2hlcik7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyICE9IF9vd25lcik7CgogICAgICAgIG93bmVyc1tfb3duZXJdID0gZmFsc2U7CiAgICAgICAgQWNjZXNzUmV2b2tlKF9vd25lcik7CiAgICB9Cn0KCmNvbnRyYWN0IEhhbHRhYmxlIGlzIE11bHRpT3duZXJzIHsKICAgIGJvb2wgcHVibGljIGhhbHRlZDsKCiAgICBtb2RpZmllciBzdG9wSW5FbWVyZ2VuY3kgewogICAgICAgIHJlcXVpcmUoIWhhbHRlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5SW5FbWVyZ2VuY3kgewogICAgICAgIHJlcXVpcmUoaGFsdGVkKTsKICAgICAgICBfOwogICAgfQoKICAgIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW1lcmdlbmN5LCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlCiAgICBmdW5jdGlvbiBoYWx0KCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICBoYWx0ZWQgPSB0cnVlOwogICAgfQoKICAgIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW5kIG9mIGVtZXJnZW5jeSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgIGZ1bmN0aW9uIHVuaGFsdCgpIGV4dGVybmFsIG9ubHlPd25lciBvbmx5SW5FbWVyZ2VuY3kgewogICAgICAgIGhhbHRlZCA9IGZhbHNlOwogICAgfQoKfQoKY29udHJhY3QgVHJpcGxlQWxwaGFDcm93ZHNhbGUgaXMgTXVsdGlPd25lcnMsIEhhbHRhYmxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIC8vIEdsb2JhbAogICAgLy8gRVRIVVNEIGNoYW5nZSByYXRlCiAgICB1aW50MjU2IHB1YmxpYyByYXRlRVRIVVNEID0gMzAwZTI7CgogICAgLy8gbWluaW1hbCB0b2tlbiBzZWxsZWQgcGVyIHRpbWUKICAgIHVpbnQyNTYgcHVibGljIG1pbmltYWxUb2tlbnMgPSAxZTE4OwoKICAgIC8vIFNhbGUgdG9rZW4KICAgIFRyaXBsZUFscGhhVG9rZW4gcHVibGljIHRva2VuOwoKICAgIC8vIFdpdGhkcmF3IHdhbGxldAogICAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0OwoKCiAgICAvLyBQcmUtSUNPCiAgICAvLyBNYXhpbXVtIHBvc3NpYmxlIGNhcCBpbiBVU0Qgb24gcGVyaW9kUHJlSVRPCiAgICB1aW50MjU2IHB1YmxpYyBwZXJpb2RQcmVJVE9fbWFpbkNhcEluVVNEID0gMTAwMDAwMGUyOwoKICAgIC8vIE1heGltdW0gcG9zc2libGUgY2FwIGluIFVTRCBvbiBwZXJpb2RQcmVJVE8KICAgIHVpbnQyNTYgcHVibGljIHBlcmlvZFByZUlUT19oYXJkQ2FwSW5VU0QgPSBwZXJpb2RQcmVJVE9fbWFpbkNhcEluVVNEOwoKICAgIC8vIFByZUlUTyBwZXJpb2QgaW4gZGF5cwogICAgdWludDI1NiBwdWJsaWMgcGVyaW9kUHJlSVRPX3BlcmlvZCA9IDMwIGRheXM7CgogICAgLy8gVG9rZW4gUHJpY2UgaW4gVVNECiAgICB1aW50MjU2IHB1YmxpYyBwZXJpb2RQcmVJVE9fdG9rZW5QcmljZVVTRCA9IDUwOwoKICAgIC8vIFdFSSBwZXIgdG9rZW4KICAgIHVpbnQyNTYgcHVibGljIHBlcmlvZFByZUlUT193ZWlQZXJUb2tlbiA9IHBlcmlvZFByZUlUT190b2tlblByaWNlVVNELm11bCgxIGV0aGVyKS5kaXYocmF0ZUVUSFVTRCk7CiAgICAKICAgIC8vIHN0YXJ0IGFuZCBlbmQgdGltZXN0YW1wIHdoZXJlIGludmVzdG1lbnRzIGFyZSBhbGxvd2VkIChib3RoIGluY2x1c2l2ZSkKICAgIHVpbnQyNTYgcHVibGljIHBlcmlvZFByZUlUT19zdGFydFRpbWU7CiAgICB1aW50MjU2IHB1YmxpYyBwZXJpb2RQcmVJVE9fZW5kVGltZTsKCiAgICAvLyB0b3RhbCB3ZWkgcmVjZWl2ZWQgZHVyaW5nIHBoYXNlIG9uZQogICAgdWludDI1NiBwdWJsaWMgcGVyaW9kUHJlSVRPX3dlaTsKCiAgICAvLyBNYXhpbXVtIHBvc3NpYmxlIGNhcCBpbiB3ZWkgZm9yIHBoYXNlIG9uZQogICAgdWludDI1NiBwdWJsaWMgcGVyaW9kUHJlSVRPX21haW5DYXBJbldlaSA9IHBlcmlvZFByZUlUT19tYWluQ2FwSW5VU0QubXVsKDEgZXRoZXIpLmRpdihyYXRlRVRIVVNEKTsKICAgIC8vIE1heGltdW0gcG9zc2libGUgY2FwIGluIHdlaQogICAgdWludDI1NiBwdWJsaWMgcGVyaW9kUHJlSVRPX2hhcmRDYXBJbldlaSA9IHBlcmlvZFByZUlUT19tYWluQ2FwSW5XZWk7CgoKICAgIC8vIElDTwogICAgLy8gTWluaW1hbCBwb3NzaWJsZSBjYXAgaW4gVVNEIG9uIHBlcmlvZElUTwogICAgdWludDI1NiBwdWJsaWMgcGVyaW9kSVRPX3NvZnRDYXBJblVTRCA9IDEwMDAwMDBlMjsKCiAgICAvLyBNYXhpbXVtIHBvc3NpYmxlIGNhcCBpbiBVU0Qgb24gcGVyaW9kSVRPCiAgICB1aW50MjU2IHB1YmxpYyBwZXJpb2RJVE9fbWFpbkNhcEluVVNEID0gODAwMDAwMGUyOwoKICAgIHVpbnQyNTYgcHVibGljIHBlcmlvZElUT19wZXJpb2QgPSA2MCBkYXlzOwoKICAgIC8vIE1heGltdW0gcG9zc2libGUgY2FwIGluIFVTRCBvbiBwZXJpb2RJVE8KICAgIHVpbnQyNTYgcHVibGljIHBlcmlvZElUT19oYXJkQ2FwSW5VU0QgPSBwZXJpb2RJVE9fc29mdENhcEluVVNEICsgcGVyaW9kSVRPX21haW5DYXBJblVTRDsKCiAgICAvLyBUb2tlbiBQcmljZSBpbiBVU0QKICAgIHVpbnQyNTYgcHVibGljIHBlcmlvZElUT190b2tlblByaWNlVVNEID0gMTAwOwoKICAgIC8vIFdFSSBwZXIgdG9rZW4KICAgIHVpbnQyNTYgcHVibGljIHBlcmlvZElUT193ZWlQZXJUb2tlbiA9IHBlcmlvZElUT190b2tlblByaWNlVVNELm11bCgxIGV0aGVyKS5kaXYocmF0ZUVUSFVTRCk7CgogICAgLy8gc3RhcnQgYW5kIGVuZCB0aW1lc3RhbXAgd2hlcmUgaW52ZXN0bWVudHMgYXJlIGFsbG93ZWQgKGJvdGggaW5jbHVzaXZlKQogICAgdWludDI1NiBwdWJsaWMgcGVyaW9kSVRPX3N0YXJ0VGltZTsKICAgIHVpbnQyNTYgcHVibGljIHBlcmlvZElUT19lbmRUaW1lOwoKICAgIC8vIHRvdGFsIHdlaSByZWNlaXZlZCBkdXJpbmcgcGhhc2UgdHdvCiAgICB1aW50MjU2IHB1YmxpYyBwZXJpb2RJVE9fd2VpOwogICAgCiAgICAvLyByZWZ1bmQgaWYgc29mdENhcCBpcyBub3QgcmVhY2hlZAogICAgYm9vbCBwdWJsaWMgcmVmdW5kQWxsb3dlZCA9IGZhbHNlOwoKICAgIC8vIG5lZWQgZm9yIHJlZnVuZAogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyByZWNlaXZlZF9ldGhlcnM7CgoKICAgIC8vIEhhcmQgcG9zc2libGUgY2FwIC0gc29mdCBjYXAgaW4gd2VpIGZvciBwaGFzZSB0d28KICAgIHVpbnQyNTYgcHVibGljIHBlcmlvZElUT19tYWluQ2FwSW5XZWkgPSBwZXJpb2RJVE9fbWFpbkNhcEluVVNELm11bCgxIGV0aGVyKS5kaXYocmF0ZUVUSFVTRCk7CgogICAgLy8gU29mdCBjYXAgaW4gd2VpCiAgICB1aW50MjU2IHB1YmxpYyBwZXJpb2RJVE9fc29mdENhcEluV2VpID0gcGVyaW9kSVRPX3NvZnRDYXBJblVTRC5tdWwoMSBldGhlcikuZGl2KHJhdGVFVEhVU0QpOwoKICAgIC8vIEhhcmQgcG9zc2libGUgY2FwIC0gc29mdCBjYXAgaW4gd2VpIGZvciBwaGFzZSB0d28KICAgIHVpbnQyNTYgcHVibGljIHBlcmlvZElUT19oYXJkQ2FwSW5XZWkgPSBwZXJpb2RJVE9fc29mdENhcEluV2VpICsgcGVyaW9kSVRPX21haW5DYXBJbldlaTsKCgogICAgLy8gRXZlbnRzCiAgICBldmVudCBUb2tlblB1cmNoYXNlKGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB2YWx1ZSwgdWludDI1NiBhbW91bnQpOwogICAgZXZlbnQgT2RkTW9uZXkoYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHZhbHVlKTsKICAgIGV2ZW50IFNldFBlcmlvZFByZUlUT19zdGFydFRpbWUodWludDI1NiBuZXdfc3RhcnRUaW1lUGVyaW9kUHJlSVRPKTsKICAgIGV2ZW50IFNldFBlcmlvZElUT19zdGFydFRpbWUodWludDI1NiBuZXdfc3RhcnRUaW1lUGVyaW9kSVRPKTsKCiAgICBtb2RpZmllciB2YWxpZFB1cmNoYXNlKCkgewogICAgICAgIGJvb2wgbm9uWmVyb1B1cmNoYXNlID0gbXNnLnZhbHVlICE9IDA7CgogICAgICAgIHJlcXVpcmUod2l0aGluUGVyaW9kKCkgJiYgbm9uWmVyb1B1cmNoYXNlKTsKCiAgICAgICAgXzsgICAgICAgIAogICAgfQoKICAgIG1vZGlmaWVyIGlzRXhwaXJlZCgpIHsKICAgICAgICByZXF1aXJlKG5vdyA+IHBlcmlvZElUT19lbmRUaW1lKTsKCiAgICAgICAgXzsgICAgICAgIAogICAgfQoKICAgIC8qKgogICAgICogQHJldHVybiB0cnVlIGlmIGluIHBlcmlvZCBvciBmYWxzZSBpZiBub3QKICAgICAqLwogICAgZnVuY3Rpb24gd2l0aGluUGVyaW9kKCkgY29uc3RhbnQgcmV0dXJucyhib29sIHJlcykgewogICAgICAgIGJvb2wgd2l0aGluUGVyaW9kUHJlSVRPID0gKG5vdyA+PSBwZXJpb2RQcmVJVE9fc3RhcnRUaW1lICYmIG5vdyA8PSBwZXJpb2RQcmVJVE9fZW5kVGltZSk7CiAgICAgICAgYm9vbCB3aXRoaW5QZXJpb2RJVE8gPSAobm93ID49IHBlcmlvZElUT19zdGFydFRpbWUgJiYgbm93IDw9IHBlcmlvZElUT19lbmRUaW1lKTsKICAgICAgICByZXR1cm4gKHdpdGhpblBlcmlvZFByZUlUTyB8fCB3aXRoaW5QZXJpb2RJVE8pOwogICAgfQogICAgCgogICAgLyoqCiAgICAgKiBAcGFyYW0gX3BlcmlvZFByZUlUT19zdGFydFRpbWUgUHJlLUlUTyBzdGFydCB0aW1lCiAgICAgKiBAcGFyYW0gX3BlcmlvZElUT19zdGFydFRpbWUgSVRPIHN0YXJ0IHRpbWUKICAgICAqIEBwYXJhbSBfd2FsbGV0IGRlc3RpbmF0aW9uIGZ1bmQgYWRkcmVzcyAoaSBob3BlIGl0IHdpbGwgYmUgbXVsdGktc2lnKQogICAgICovCiAgICBmdW5jdGlvbiBUcmlwbGVBbHBoYUNyb3dkc2FsZSh1aW50MjU2IF9wZXJpb2RQcmVJVE9fc3RhcnRUaW1lLCB1aW50MjU2IF9wZXJpb2RJVE9fc3RhcnRUaW1lLCBhZGRyZXNzIF93YWxsZXQpIHsKICAgICAgICByZXF1aXJlKF9wZXJpb2RQcmVJVE9fc3RhcnRUaW1lID49IG5vdyk7CiAgICAgICAgcmVxdWlyZShfcGVyaW9kSVRPX3N0YXJ0VGltZSA+IF9wZXJpb2RQcmVJVE9fc3RhcnRUaW1lKTsKICAgICAgICByZXF1aXJlKF93YWxsZXQgIT0gMHgwKTsKCiAgICAgICAgdG9rZW4gPSBuZXcgVHJpcGxlQWxwaGFUb2tlbigpOwogICAgICAgIHdhbGxldCA9IF93YWxsZXQ7CgogICAgICAgIHNldFBlcmlvZFByZUlUT19zdGFydFRpbWUoX3BlcmlvZFByZUlUT19zdGFydFRpbWUpOwogICAgICAgIHNldFBlcmlvZElUT19zdGFydFRpbWUoX3BlcmlvZElUT19zdGFydFRpbWUpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBIdW1hbiByZWFkYWJsZSBwZXJpb2QgTmFtZSAKICAgICAqIEByZXR1cm4gY3VycmVudCBzdGFnZSBuYW1lCiAgICAgKi8KICAgIGZ1bmN0aW9uIHN0YWdlTmFtZSgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zIChzdHJpbmcpIHsKICAgICAgICBib29sIGJlZm9yZVByZUlUTyA9IChub3cgPCBwZXJpb2RQcmVJVE9fc3RhcnRUaW1lKTsKICAgICAgICBib29sIHdpdGhpblByZUlUTyA9IChub3cgPj0gcGVyaW9kUHJlSVRPX3N0YXJ0VGltZSAmJiBub3cgPD0gcGVyaW9kUHJlSVRPX2VuZFRpbWUpOwogICAgICAgIGJvb2wgYmV0d2VlblByZUlUT0FuZElUTyA9IChub3cgPj0gcGVyaW9kUHJlSVRPX2VuZFRpbWUgJiYgbm93IDw9IHBlcmlvZElUT19zdGFydFRpbWUpOwogICAgICAgIGJvb2wgd2l0aGluSVRPID0gKG5vdyA+PSBwZXJpb2RJVE9fc3RhcnRUaW1lICYmIG5vdyA8PSBwZXJpb2RJVE9fZW5kVGltZSk7CgogICAgICAgIGlmKGJlZm9yZVByZUlUTykgewogICAgICAgICAgICByZXR1cm4gJ05vdCBzdGFydGVkJzsKICAgICAgICB9CgogICAgICAgIGlmKHdpdGhpblByZUlUTykgewogICAgICAgICAgICByZXR1cm4gJ1ByZS1JVE8nOwogICAgICAgIH0gCgogICAgICAgIGlmKGJldHdlZW5QcmVJVE9BbmRJVE8pIHsKICAgICAgICAgICAgcmV0dXJuICdCZXR3ZWVuIFByZS1JVE8gYW5kIElUTyc7CiAgICAgICAgfQoKICAgICAgICBpZih3aXRoaW5JVE8pIHsKICAgICAgICAgICAgcmV0dXJuICdJVE8nOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuICdGaW5pc2hlZCc7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEh1bWFuIHJlYWRhYmxlIHBlcmlvZCBOYW1lIAogICAgICogQHJldHVybiBjdXJyZW50IHN0YWdlIG5hbWUKICAgICAqLwogICAgZnVuY3Rpb24gdG90YWxXZWkoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHBlcmlvZFByZUlUT193ZWkgKyBwZXJpb2RJVE9fd2VpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB0b3RhbEV0aGVyKCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludDI1NikgewogICAgICAgIHJldHVybiB0b3RhbFdlaSgpLmRpdigxZTE4KTsKICAgIH0KCiAgICAvKgogICAgICogQGRldiB1cGRhdGUgUHJlSVRPIHN0YXJ0IHRpbWUKICAgICAqIEBwYXJhbSBfYXQgbmV3IHN0YXJ0IGRhdGUKICAgICAqLwogICAgZnVuY3Rpb24gc2V0UGVyaW9kUHJlSVRPX3N0YXJ0VGltZSh1aW50MjU2IF9hdCkgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKHBlcmlvZFByZUlUT19zdGFydFRpbWUgPT0gMCB8fCBibG9jay50aW1lc3RhbXAgPCBwZXJpb2RQcmVJVE9fc3RhcnRUaW1lKTsgLy8gZm9yYmlkIGNoYW5nZSB0aW1lIHdoZW4gZmlyc3QgcGhhc2UgaXMgYWN0aXZlCiAgICAgICAgcmVxdWlyZShibG9jay50aW1lc3RhbXAgPCBfYXQpOyAvLyBzaG91bGQgYmUgZ3JlYXQgdGhhbiBjdXJyZW50IGJsb2NrIHRpbWVzdGFtcAogICAgICAgIHJlcXVpcmUocGVyaW9kSVRPX3N0YXJ0VGltZSA9PSAwIHx8IF9hdCA8IHBlcmlvZElUT19zdGFydFRpbWUpOyAvLyBzaG91bGQgYmUgbG93ZXIgdGhhbiBzdGFydCBvZiBzZWNvbmQgcGhhc2UKCiAgICAgICAgcGVyaW9kUHJlSVRPX3N0YXJ0VGltZSA9IF9hdDsKICAgICAgICBwZXJpb2RQcmVJVE9fZW5kVGltZSA9IHBlcmlvZFByZUlUT19zdGFydFRpbWUuYWRkKHBlcmlvZFByZUlUT19wZXJpb2QpOwogICAgICAgIFNldFBlcmlvZFByZUlUT19zdGFydFRpbWUoX2F0KTsKICAgIH0KCiAgICAvKgogICAgICogQGRldiB1cGRhdGUgSVRPIHN0YXJ0IGRhdGUKICAgICAqIEBwYXJhbSBfYXQgbmV3IHN0YXJ0IGRhdGUKICAgICAqLwogICAgZnVuY3Rpb24gc2V0UGVyaW9kSVRPX3N0YXJ0VGltZSh1aW50MjU2IF9hdCkgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKHBlcmlvZElUT19zdGFydFRpbWUgPT0gMCB8fCBibG9jay50aW1lc3RhbXAgPCBwZXJpb2RJVE9fc3RhcnRUaW1lKTsgLy8gZm9yYmlkIGNoYW5nZSB0aW1lIHdoZW4gc2Vjb25kIHBoYXNlIGlzIGFjdGl2ZQogICAgICAgIHJlcXVpcmUoYmxvY2sudGltZXN0YW1wIDwgX2F0KTsgLy8gc2hvdWxkIGJlIGdyZWF0IHRoYW4gY3VycmVudCBibG9jayB0aW1lc3RhbXAKICAgICAgICByZXF1aXJlKHBlcmlvZFByZUlUT19lbmRUaW1lIDwgX2F0KTsgLy8gc2hvdWxkIGJlIGdyZWF0IHRoYW4gZW5kIGZpcnN0IHBoYXNlCgogICAgICAgIHBlcmlvZElUT19zdGFydFRpbWUgPSBfYXQ7CiAgICAgICAgcGVyaW9kSVRPX2VuZFRpbWUgPSBwZXJpb2RJVE9fc3RhcnRUaW1lLmFkZChwZXJpb2RJVE9fcGVyaW9kKTsKICAgICAgICBTZXRQZXJpb2RJVE9fc3RhcnRUaW1lKF9hdCk7CiAgICB9CgogICAgZnVuY3Rpb24gcGVyaW9kSVRPX3NvZnRDYXBSZWFjaGVkKCkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBwZXJpb2RJVE9fd2VpID49IHBlcmlvZElUT19zb2Z0Q2FwSW5XZWk7CiAgICB9CgogICAgLyoKICAgICAqIEBkZXYgZmFsbGJhY2sgZm9yIHByb2Nlc3NpbmcgZXRoZXIKICAgICAqLwogICAgZnVuY3Rpb24oKSBwYXlhYmxlIHsKICAgICAgICByZXR1cm4gYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwogICAgfQoKICAgIC8qCiAgICAgKiBAZGV2IGFtb3VudCBjYWxjdWxhdGlvbiwgZGVwZW5kcyBvZiBjdXJyZW50IHBlcmlvZAogICAgICogQHBhcmFtIF92YWx1ZSBFVEggaW4gd2VpCiAgICAgKiBAcGFyYW0gX2F0IHRpbWUKICAgICAqLwogICAgZnVuY3Rpb24gY2FsY0Ftb3VudEF0KHVpbnQyNTYgX3ZhbHVlLCB1aW50MjU2IF9hdCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQyNTYsIHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IGVzdGltYXRlOwogICAgICAgIHVpbnQyNTYgb2RkOwoKICAgICAgICBpZihfYXQgPCBwZXJpb2RQcmVJVE9fZW5kVGltZSkgewogICAgICAgICAgICBpZihfdmFsdWUuYWRkKHBlcmlvZFByZUlUT193ZWkpID4gcGVyaW9kUHJlSVRPX2hhcmRDYXBJbldlaSkgewogICAgICAgICAgICAgICAgb2RkID0gX3ZhbHVlLmFkZChwZXJpb2RQcmVJVE9fd2VpKS5zdWIocGVyaW9kUHJlSVRPX2hhcmRDYXBJbldlaSk7CiAgICAgICAgICAgICAgICBfdmFsdWUgPSBwZXJpb2RQcmVJVE9faGFyZENhcEluV2VpLnN1YihwZXJpb2RQcmVJVE9fd2VpKTsKICAgICAgICAgICAgfSAKICAgICAgICAgICAgZXN0aW1hdGUgPSBfdmFsdWUubXVsKDEgZXRoZXIpLmRpdihwZXJpb2RQcmVJVE9fd2VpUGVyVG9rZW4pOwogICAgICAgICAgICByZXF1aXJlKF92YWx1ZSArIHBlcmlvZFByZUlUT193ZWkgPD0gcGVyaW9kUHJlSVRPX2hhcmRDYXBJbldlaSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYoX3ZhbHVlLmFkZChwZXJpb2RJVE9fd2VpKSA+IHBlcmlvZElUT19oYXJkQ2FwSW5XZWkpIHsKICAgICAgICAgICAgICAgIG9kZCA9IF92YWx1ZS5hZGQocGVyaW9kSVRPX3dlaSkuc3ViKHBlcmlvZElUT19oYXJkQ2FwSW5XZWkpOwogICAgICAgICAgICAgICAgX3ZhbHVlID0gcGVyaW9kSVRPX2hhcmRDYXBJbldlaS5zdWIocGVyaW9kSVRPX3dlaSk7CiAgICAgICAgICAgIH0gICAgICAgICAgICAgCiAgICAgICAgICAgIGVzdGltYXRlID0gX3ZhbHVlLm11bCgxIGV0aGVyKS5kaXYocGVyaW9kSVRPX3dlaVBlclRva2VuKTsKICAgICAgICAgICAgcmVxdWlyZShfdmFsdWUgKyBwZXJpb2RJVE9fd2VpIDw9IHBlcmlvZElUT19oYXJkQ2FwSW5XZWkpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIChlc3RpbWF0ZSwgb2RkKTsKICAgIH0KCiAgICAvKgogICAgICogQGRldiBzZWxsIHRva2VuIGFuZCBzZW5kIHRvIGNvbnRyaWJ1dG9yIGFkZHJlc3MKICAgICAqIEBwYXJhbSBjb250cmlidXRvciBhZGRyZXNzCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGNvbnRyaWJ1dG9yKSBwYXlhYmxlIHN0b3BJbkVtZXJnZW5jeSB2YWxpZFB1cmNoYXNlIHB1YmxpYyB7CiAgICAgICAgdWludDI1NiBhbW91bnQ7CiAgICAgICAgdWludDI1NiBvZGRfZXRoZXJzOwogICAgICAgIGJvb2wgdHJhbnNmZXJfYWxsb3dlZCA9IHRydWU7CiAgICAgICAgCiAgICAgICAgKGFtb3VudCwgb2RkX2V0aGVycykgPSBjYWxjQW1vdW50QXQobXNnLnZhbHVlLCBub3cpOwogIAogICAgICAgIHJlcXVpcmUoY29udHJpYnV0b3IgIT0gMHgwKSA7CiAgICAgICAgcmVxdWlyZShtaW5pbWFsVG9rZW5zIDw9IGFtb3VudCk7CgogICAgICAgIHRva2VuLm1pbnQoY29udHJpYnV0b3IsIGFtb3VudCk7CiAgICAgICAgVG9rZW5QdXJjaGFzZShjb250cmlidXRvciwgbXNnLnZhbHVlLCBhbW91bnQpOwoKICAgICAgICBpZihub3cgPCBwZXJpb2RQcmVJVE9fZW5kVGltZSkgewogICAgICAgICAgICAvLyBQcmUtSVRPCiAgICAgICAgICAgIHBlcmlvZFByZUlUT193ZWkgPSBwZXJpb2RQcmVJVE9fd2VpLmFkZChtc2cudmFsdWUpOwoKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBJVE8KICAgICAgICAgICAgaWYocGVyaW9kSVRPX3NvZnRDYXBSZWFjaGVkKCkpIHsKICAgICAgICAgICAgICAgIHBlcmlvZElUT193ZWkgPSBwZXJpb2RJVE9fd2VpLmFkZChtc2cudmFsdWUpLnN1YihvZGRfZXRoZXJzKTsKICAgICAgICAgICAgfSBlbHNlIGlmKHRoaXMuYmFsYW5jZSA+PSBwZXJpb2RJVE9fc29mdENhcEluV2VpKSB7CiAgICAgICAgICAgICAgICBwZXJpb2RJVE9fd2VpID0gdGhpcy5iYWxhbmNlLnN1YihvZGRfZXRoZXJzKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJlY2VpdmVkX2V0aGVyc1tjb250cmlidXRvcl0gPSByZWNlaXZlZF9ldGhlcnNbY29udHJpYnV0b3JdLmFkZChtc2cudmFsdWUpOwogICAgICAgICAgICAgICAgdHJhbnNmZXJfYWxsb3dlZCA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZihvZGRfZXRoZXJzID4gMCkgewogICAgICAgICAgICByZXF1aXJlKG9kZF9ldGhlcnMgPCBtc2cudmFsdWUpOwogICAgICAgICAgICBPZGRNb25leShjb250cmlidXRvciwgb2RkX2V0aGVycyk7CiAgICAgICAgICAgIGNvbnRyaWJ1dG9yLnRyYW5zZmVyKG9kZF9ldGhlcnMpOwogICAgICAgIH0KCiAgICAgICAgaWYodHJhbnNmZXJfYWxsb3dlZCkgewogICAgICAgICAgICB3YWxsZXQudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgICAgICB9CiAgICB9CgogICAgLyoKICAgICAqIEBkZXYgc2VsbCB0b2tlbiBhbmQgc2VuZCB0byBjb250cmlidXRvciBhZGRyZXNzCiAgICAgKiBAcGFyYW0gY29udHJpYnV0b3IgYWRkcmVzcwogICAgICovCiAgICBmdW5jdGlvbiByZWZ1bmQoKSBpc0V4cGlyZWQgcHVibGljIHsKICAgICAgICByZXF1aXJlKHJlZnVuZEFsbG93ZWQpOwogICAgICAgIHJlcXVpcmUoIXBlcmlvZElUT19zb2Z0Q2FwUmVhY2hlZCgpKTsKICAgICAgICByZXF1aXJlKHJlY2VpdmVkX2V0aGVyc1ttc2cuc2VuZGVyXSA+IDApOwogICAgICAgIHJlcXVpcmUodG9rZW4uYmFsYW5jZU9mKG1zZy5zZW5kZXIpID4gMCk7CgogICAgICAgIHVpbnQyNTYgY3VycmVudF9iYWxhbmNlID0gcmVjZWl2ZWRfZXRoZXJzW21zZy5zZW5kZXJdOwogICAgICAgIHJlY2VpdmVkX2V0aGVyc1ttc2cuc2VuZGVyXSA9IDA7CiAgICAgICAgdG9rZW4uYnVybihtc2cuc2VuZGVyKTsKICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKGN1cnJlbnRfYmFsYW5jZSk7CiAgICB9CgogICAgLyoKICAgICAqIEBkZXYgZmluaXNoIGNyb3dkc2FsZQogICAgICovCiAgICBmdW5jdGlvbiBmaW5pc2hDcm93ZHNhbGUoKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKG5vdyA+IHBlcmlvZElUT19lbmRUaW1lIHx8IHBlcmlvZElUT193ZWkgPT0gcGVyaW9kSVRPX2hhcmRDYXBJbldlaSk7CiAgICAgICAgcmVxdWlyZSghdG9rZW4ubWludGluZ0ZpbmlzaGVkKCkpOwoKICAgICAgICBpZihwZXJpb2RJVE9fc29mdENhcFJlYWNoZWQoKSkgewogICAgICAgICAgICB0b2tlbi5maW5pc2hNaW50aW5nKHRydWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlZnVuZEFsbG93ZWQgPSB0cnVlOwogICAgICAgICAgICB0b2tlbi5maW5pc2hNaW50aW5nKGZhbHNlKTsKICAgICAgICB9CiAgIH0KCiAgICAvLyBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBlbmRlZAogICAgZnVuY3Rpb24gcnVubmluZygpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHdpdGhpblBlcmlvZCgpICYmICF0b2tlbi5taW50aW5nRmluaXNoZWQoKTsKICAgIH0KfQoKY29udHJhY3QgVHJpcGxlQWxwaGFUb2tlbiBpcyBNaW50YWJsZVRva2VuIHsKCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAnVHJpcGxlIEFscGhhIFRva2VuJzsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gJ1RSSUEnOwogICAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CiAgICBib29sIHB1YmxpYyB0cmFuc2ZlckFsbG93ZWQ7CgogICAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgdWludDI1NiB2YWx1ZSk7CiAgICBldmVudCBUcmFuc2ZlckFsbG93ZWQoYm9vbCk7CgogICAgbW9kaWZpZXIgY2FuVHJhbnNmZXIoKSB7CiAgICAgICAgcmVxdWlyZShtaW50aW5nRmluaXNoZWQgJiYgdHJhbnNmZXJBbGxvd2VkKTsKICAgICAgICBfOyAgICAgICAgCiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgY2FuVHJhbnNmZXIgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oZnJvbSwgdG8sIHZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBjYW5UcmFuc2ZlciByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKHRvLCB2YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gZmluaXNoTWludGluZyhib29sIF90cmFuc2ZlckFsbG93ZWQpIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICAgICAgdHJhbnNmZXJBbGxvd2VkID0gX3RyYW5zZmVyQWxsb3dlZDsKICAgICAgICBUcmFuc2ZlckFsbG93ZWQoX3RyYW5zZmVyQWxsb3dlZCk7CiAgICAgICAgcmV0dXJuIHN1cGVyLmZpbmlzaE1pbnRpbmcoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBidXJuKGFkZHJlc3MgZnJvbSkgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBUcmFuc2Zlcihmcm9tLCAweDAsIGJhbGFuY2VzW2Zyb21dKTsKICAgICAgICBCdXJuKGZyb20sIGJhbGFuY2VzW2Zyb21dKTsKCiAgICAgICAgYmFsYW5jZXNbMHgwXSArPSBiYWxhbmNlc1tmcm9tXTsKICAgICAgICBiYWxhbmNlc1tmcm9tXSA9IDA7CiAgICB9Cn0='.
	

]
