Class {
	#name : #SRTd7e011ad27b6128934e2afd1763120ede1274ae4,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd7e011ad27b6128934e2afd1763120ede1274ae4 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgoKCgoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgogICAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CiAgICAvKioKICAgICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAgICogYWNjb3VudC4KICAgICAqLwogICAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICAgKi8KICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgICAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICB9Cgp9CgoKLyoqCiAqIEB0aXRsZSBQYXVzYWJsZQogKiBAZGV2IEJhc2UgY29udHJhY3Qgd2hpY2ggYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uCiAqLwpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKICAgIGV2ZW50IFBhdXNlKCk7CgogICAgZXZlbnQgVW5wYXVzZSgpOwoKICAgIGJvb2wgcHVibGljIHBhdXNlZCA9IGZhbHNlOwoKCiAgICAvKioKICAgICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgbm90IHBhdXNlZC4KICAgICAqLwogICAgbW9kaWZpZXIgd2hlbk5vdFBhdXNlZCgpIHsKICAgICAgICByZXF1aXJlKCFwYXVzZWQpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIHBhdXNlZC4KICAgICAqLwogICAgbW9kaWZpZXIgd2hlblBhdXNlZCgpIHsKICAgICAgICByZXF1aXJlKHBhdXNlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byBwYXVzZSwgdHJpZ2dlcnMgc3RvcHBlZCBzdGF0ZQogICAgICovCiAgICBmdW5jdGlvbiBwYXVzZSgpIG9ubHlPd25lciB3aGVuTm90UGF1c2VkIHB1YmxpYyB7CiAgICAgICAgcGF1c2VkID0gdHJ1ZTsKICAgICAgICBQYXVzZSgpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHVucGF1c2UsIHJldHVybnMgdG8gbm9ybWFsIHN0YXRlCiAgICAgKi8KICAgIGZ1bmN0aW9uIHVucGF1c2UoKSBvbmx5T3duZXIgd2hlblBhdXNlZCBwdWJsaWMgewogICAgICAgIHBhdXNlZCA9IGZhbHNlOwogICAgICAgIFVucGF1c2UoKTsKICAgIH0KfQoKCgoKCgoKCi8qKgogKiBAdGl0bGUgRVJDMjBCYXNpYwogKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE3OQogKi8KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CgogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCgoKCgoKCgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwoKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgoKCgoKCgoKCi8qKgogKiBAdGl0bGUgQmFzaWMgdG9rZW4KICogQGRldiBCYXNpYyB2ZXJzaW9uIG9mIFN0YW5kYXJkVG9rZW4sIHdpdGggbm8gYWxsb3dhbmNlcy4KICovCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAgIC8qKgogICAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CgogICAgICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAgICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgICAqLwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9Cgp9CgoKCgoKCgoKLyoqCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbgogKgogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwoKCiAgICAvKioKICAgICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICAgICAgdWludDI1NiBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07CgogICAgICAgIC8vIENoZWNrIGlzIG5vdCBuZWVkZWQgYmVjYXVzZSBzdWIoX2FsbG93YW5jZSwgX3ZhbHVlKSB3aWxsIGFscmVhZHkgdGhyb3cgaWYgdGhpcyBjb25kaXRpb24gaXMgbm90IG1ldAogICAgICAgIC8vIHJlcXVpcmUgKF92YWx1ZSA8PSBfYWxsb3dhbmNlKTsKCiAgICAgICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICAgKgogICAgICogQmV3YXJlIHRoYXQgY2hhbmdpbmcgYW4gYWxsb3dhbmNlIHdpdGggdGhpcyBtZXRob2QgYnJpbmdzIHRoZSByaXNrIHRoYXQgc29tZW9uZSBtYXkgdXNlIGJvdGggdGhlIG9sZAogICAgICogYW5kIHRoZSBuZXcgYWxsb3dhbmNlIGJ5IHVuZm9ydHVuYXRlIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcwogICAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAgICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgICAqLwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KCiAgICAvKioKICAgICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAogICAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICAgKi8KICAgIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICAgICAgfQogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cgp9CgoKCgoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IGMgPSBhICogYjsKICAgICAgICBpZiAoYSAhPSAwICYmIGMgLyBhICE9IGIpIHJldmVydCgpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgaWYgKGIgPiBhKSByZXZlcnQoKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSArIGI7CiAgICAgICAgaWYgKGMgPCBhKSByZXZlcnQoKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KfQoKCi8qKgogKiBAdGl0bGUgVkxCVG9rZW5zCiAqIEBkZXYgVkxCIFRva2VuIGNvbnRyYWN0IGJhc2VkIG9uIFplcHBlbGluIFN0YW5kYXJkVG9rZW4gY29udHJhY3QKICovCmNvbnRyYWN0IFZMQlRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIE93bmFibGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgLyoqCiAgICAgKiBAZGV2IEVSQzIwIGRlc2NyaXB0b3IgdmFyaWFibGVzCiAgICAgKi8KICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJWTEIgVG9rZW5zIjsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIlZMQiI7CiAgICB1aW50OCBwdWJsaWMgZGVjaW1hbHMgPSAxODsKCiAgICAvKioKICAgICAqIEBkZXYgMjIwIG1pbGxpb25zIGlzIHRoZSBpbml0aWFsIFRva2Vuc2FsZSBzdXBwbHkKICAgICAqLwogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgcHVibGljVG9rZW5zID0gMjIwICogMTAgKiogMjQ7CgogICAgLyoqCiAgICAgKiBAZGV2IDIwIG1pbGxpb25zIGZvciB0aGUgdGVhbQogICAgICovCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCB0ZWFtVG9rZW5zID0gMjAgKiAxMCAqKiAyNDsKCiAgICAvKioKICAgICAqIEBkZXYgMTAgbWlsbGlvbnMgYXMgYSBib3VudHkgcmV3YXJkCiAgICAgKi8KICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IGJvdW50eVRva2VucyA9IDEwICogMTAgKiogMjQ7CgogICAgLyoqCiAgICAgKiBAZGV2IDIuNSBtaWxsaW9ucyBhcyBhbiBpbml0aWFsIHdpbmdzLmFpIHJld2FyZCByZXNlcnYKICAgICAqLwogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgd2luZ3NUb2tlbnNSZXNlcnYgPSAyNSAqIDEwICoqIDIzOwogICAgCiAgICAvKioKICAgICAqIEBkZXYgd2luZ3MuYWkgcmV3YXJkIGNhbGN1bGF0ZWQgb24gdG9rZW5zYWxlIGZpbmFsaXphdGlvbgogICAgICovCiAgICB1aW50MjU2IHB1YmxpYyB3aW5nc1Rva2Vuc1Jld2FyZCA9IDA7CgogICAgLy8gVE9ETzogVGVzdFJQQyBhZGRyZXNzZXMsIHJlcGxhY2UgdG8gcmVhbAogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgdGVhbVRva2Vuc1dhbGxldCA9IDB4NmE2QWNBNzQ0Y2FEQjhDNTZhRUM1MUE4Y2U4NkVGQ2FENTk5ODlDRjsKICAgIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IGJvdW50eVRva2Vuc1dhbGxldCA9IDB4OTFBN0RFNGNlOGU4ZGE2ODg5ZDc5MEI3OTExMjQ2QjcxQjRjODJjYTsKICAgIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IGNyb3dkc2FsZVRva2Vuc1dhbGxldCA9IDB4NWU2NzFjZUQ3MDNmM2REY0U3OUIxM0Y4MkViNzNGMjViYWQ5MzQwZTsKICAgIAogICAgLyoqCiAgICAgKiBAZGV2IHdpbmdzLmFpIHdhbGxldCBmb3IgcmV3YXJkIGNvbGxlY3RpbmcKICAgICAqLwogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgd2luZ3NXYWxsZXQgPSAweGNiRjU2N0QzOUE3Mzc2NTNDNTY5QThCN2RGQWI2MTdFMzI3YTdhQkQ7CgoKICAgIC8qKgogICAgICogQGRldiBBZGRyZXNzIG9mIENyb3dkc2FsZSBjb250cmFjdCB3aGljaCB3aWxsIGJlIGNvbXBhcmVkCiAgICAgKiAgICAgICBhZ2FpbnN0IGluIHRoZSBhcHByb3ByaWF0ZSBtb2RpZmllciBjaGVjawogICAgICovCiAgICBhZGRyZXNzIHB1YmxpYyBjcm93ZHNhbGVDb250cmFjdEFkZHJlc3M7CgogICAgLyoqCiAgICAgKiBAZGV2IHZhcmlhYmxlIHRoYXQgaG9sZHMgZmxhZyBvZiBlbmRlZCB0b2tlbnNha2UgCiAgICAgKi8KICAgIGJvb2wgaXNGaW5pc2hlZCA9IGZhbHNlOwoKICAgIC8qKgogICAgICogQGRldiBNb2RpZmllciB0aGF0IGFsbG93IG9ubHkgdGhlIENyb3dkc2FsZSBjb250cmFjdCB0byBiZSBzZW5kZXIKICAgICAqLwogICAgbW9kaWZpZXIgb25seUNyb3dkc2FsZUNvbnRyYWN0KCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjcm93ZHNhbGVDb250cmFjdEFkZHJlc3MpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGV2ZW50IGZvciB0aGUgYnVybnQgdG9rZW5zIGFmdGVyIGNyb3dkc2FsZSBsb2dnaW5nCiAgICAgKiBAcGFyYW0gdG9rZW5zIGFtb3VudCBvZiB0b2tlbnMgYXZhaWxhYmxlIGZvciBjcm93ZHNhbGUKICAgICAqLwogICAgZXZlbnQgVG9rZW5zQnVybnQodWludDI1NiB0b2tlbnMpOwoKICAgIC8qKgogICAgICogQGRldiBldmVudCBmb3IgdGhlIHRva2VucyBjb250cmFjdCBtb3ZlIHRvIHRoZSBhY3RpdmUgc3RhdGUgbG9nZ2luZwogICAgICogQHBhcmFtIHN1cHBseSBhbW91bnQgb2YgdG9rZW5zIGxlZnQgYWZ0ZXIgYWxsIHRoZSB1bnNvbGQgd2FzIGJ1cm5lZAogICAgICovCiAgICBldmVudCBMaXZlKHVpbnQyNTYgc3VwcGx5KTsKCiAgICAvKioKICAgICAqIEBkZXYgZXZlbnQgZm9yIGJvdW50eSB0b25lIHRyYW5zZmVyIGxvZ2dpbmcKICAgICAqIEBwYXJhbSBmcm9tIHRoZSBhZGRyZXNzIG9mIGJvdW50eSB0b2tlbnMgd2FsbGV0CiAgICAgKiBAcGFyYW0gdG8gdGhlIGFkZHJlc3Mgb2YgYmVuZWZpY2lhcnkgdG9rZW5zIHdhbGxldAogICAgICogQHBhcmFtIHZhbHVlIGFtb3VudCBvZiB0b2tlbnMKICAgICAqLwogICAgZXZlbnQgQm91bnR5VHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7CgogICAgLyoqCiAgICAgKiBAZGV2IENvbnRyYWN0IGNvbnN0cnVjdG9yCiAgICAgKi8KICAgIGZ1bmN0aW9uIFZMQlRva2VuKCkgewogICAgICAgIC8vIElzc3VlIHRlYW0gdG9rZW5zCiAgICAgICAgYmFsYW5jZXNbdGVhbVRva2Vuc1dhbGxldF0gPSBiYWxhbmNlT2YodGVhbVRva2Vuc1dhbGxldCkuYWRkKHRlYW1Ub2tlbnMpOwogICAgICAgIFRyYW5zZmVyKGFkZHJlc3MoMCksIHRlYW1Ub2tlbnNXYWxsZXQsIHRlYW1Ub2tlbnMpOwoKICAgICAgICAvLyBJc3N1ZSBib3VudHkgdG9rZW5zCiAgICAgICAgYmFsYW5jZXNbYm91bnR5VG9rZW5zV2FsbGV0XSA9IGJhbGFuY2VPZihib3VudHlUb2tlbnNXYWxsZXQpLmFkZChib3VudHlUb2tlbnMpOwogICAgICAgIFRyYW5zZmVyKGFkZHJlc3MoMCksIGJvdW50eVRva2Vuc1dhbGxldCwgYm91bnR5VG9rZW5zKTsKCiAgICAgICAgLy8gSXNzdWUgY3Jvd2RzYWxlIHRva2VucyBtaW51cyBpbml0aWFsIHdpbmdzIHJld2FyZC4KICAgICAgICAvLyBzZWUgZW5kVG9rZW5zYWxlIGZvciBtb3JlIGRldGFpbHMgYWJvdXQgZmluYWwgd2luZ3MuYWkgcmV3YXJkCiAgICAgICAgdWludDI1NiBjcm93ZHNhbGVUb2tlbnMgPSBwdWJsaWNUb2tlbnMuc3ViKHdpbmdzVG9rZW5zUmVzZXJ2KTsKICAgICAgICBiYWxhbmNlc1tjcm93ZHNhbGVUb2tlbnNXYWxsZXRdID0gYmFsYW5jZU9mKGNyb3dkc2FsZVRva2Vuc1dhbGxldCkuYWRkKGNyb3dkc2FsZVRva2Vucyk7CiAgICAgICAgVHJhbnNmZXIoYWRkcmVzcygwKSwgY3Jvd2RzYWxlVG9rZW5zV2FsbGV0LCBjcm93ZHNhbGVUb2tlbnMpOwoKICAgICAgICAvLyAyNTAgbWlsbGlvbnMgdG9rZW5zIG92ZXJhbGwKICAgICAgICB0b3RhbFN1cHBseSA9IHB1YmxpY1Rva2Vucy5hZGQoYm91bnR5VG9rZW5zKS5hZGQodGVhbVRva2Vucyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGJhY2sgbGluayBWTEJUb2tlbiBjb250cmFjdCB3aXRoIFZMQkNyb3dkc2FsZSBvbmUKICAgICAqIEBwYXJhbSBfY3Jvd2RzYWxlQWRkcmVzcyBub24gemVybyBhZGRyZXNzIG9mIFZMQkNyb3dkc2FsZSBjb250cmFjdAogICAgICovCiAgICBmdW5jdGlvbiBzZXRDcm93ZHNhbGVBZGRyZXNzKGFkZHJlc3MgX2Nyb3dkc2FsZUFkZHJlc3MpIG9ubHlPd25lciBleHRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShfY3Jvd2RzYWxlQWRkcmVzcyAhPSBhZGRyZXNzKDApKTsKICAgICAgICBjcm93ZHNhbGVDb250cmFjdEFkZHJlc3MgPSBfY3Jvd2RzYWxlQWRkcmVzczsKCiAgICAgICAgLy8gQWxsb3cgY3Jvd2RzYWxlIGNvbnRyYWN0IAogICAgICAgIHVpbnQyNTYgYmFsYW5jZSA9IGJhbGFuY2VPZihjcm93ZHNhbGVUb2tlbnNXYWxsZXQpOwogICAgICAgIGFsbG93ZWRbY3Jvd2RzYWxlVG9rZW5zV2FsbGV0XVtjcm93ZHNhbGVDb250cmFjdEFkZHJlc3NdID0gYmFsYW5jZTsKICAgICAgICBBcHByb3ZhbChjcm93ZHNhbGVUb2tlbnNXYWxsZXQsIGNyb3dkc2FsZUNvbnRyYWN0QWRkcmVzcywgYmFsYW5jZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGNhbGxlZCBvbmx5IGJ5IGxpbmtlZCBWTEJDcm93ZHNhbGUgY29udHJhY3QgdG8gZW5kIGNyb3dkc2FsZS4KICAgICAqICAgICAgYWxsIHRoZSB1bnNvbGQgdG9rZW5zIHdpbGwgYmUgYnVybmVkIGFuZCB0b3RhbFN1cHBseSB1cGRhdGVkCiAgICAgKiAgICAgIGJ1dCB3aW5ncy5haSByZXdhcmQgd2lsbCBiZSBzZWN1cmVkIGluIGFkdmFuY2UKICAgICAqLwogICAgZnVuY3Rpb24gZW5kVG9rZW5zYWxlKCkgb25seUNyb3dkc2FsZUNvbnRyYWN0IGV4dGVybmFsIHsKICAgICAgICByZXF1aXJlKCFpc0ZpbmlzaGVkKTsKICAgICAgICB1aW50MjU2IGNyb3dkc2FsZUxlZnRvdmVycyA9IGJhbGFuY2VPZihjcm93ZHNhbGVUb2tlbnNXYWxsZXQpOwogICAgICAgIAogICAgICAgIGlmIChjcm93ZHNhbGVMZWZ0b3ZlcnMgPiAwKSB7CiAgICAgICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuc3ViKGNyb3dkc2FsZUxlZnRvdmVycykuc3ViKHdpbmdzVG9rZW5zUmVzZXJ2KTsKICAgICAgICAgICAgd2luZ3NUb2tlbnNSZXdhcmQgPSB0b3RhbFN1cHBseS5kaXYoMTAwKTsKICAgICAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQod2luZ3NUb2tlbnNSZXdhcmQpOwoKICAgICAgICAgICAgYmFsYW5jZXNbY3Jvd2RzYWxlVG9rZW5zV2FsbGV0XSA9IDA7CiAgICAgICAgICAgIFRyYW5zZmVyKGNyb3dkc2FsZVRva2Vuc1dhbGxldCwgYWRkcmVzcygwKSwgY3Jvd2RzYWxlTGVmdG92ZXJzKTsKICAgICAgICAgICAgVG9rZW5zQnVybnQoY3Jvd2RzYWxlTGVmdG92ZXJzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB3aW5nc1Rva2Vuc1Jld2FyZCA9IHdpbmdzVG9rZW5zUmVzZXJ2OwogICAgICAgIH0KICAgICAgICAKICAgICAgICBiYWxhbmNlc1t3aW5nc1dhbGxldF0gPSBiYWxhbmNlT2Yod2luZ3NXYWxsZXQpLmFkZCh3aW5nc1Rva2Vuc1Jld2FyZCk7CiAgICAgICAgVHJhbnNmZXIoY3Jvd2RzYWxlVG9rZW5zV2FsbGV0LCB3aW5nc1dhbGxldCwgd2luZ3NUb2tlbnNSZXdhcmQpOwoKICAgICAgICBpc0ZpbmlzaGVkID0gdHJ1ZTsKCiAgICAgICAgTGl2ZSh0b3RhbFN1cHBseSk7CiAgICB9Cn0KCgoKCgoKCgovKgogKiAhISFJTVBPUlRBTlQhISEKICogQmFzZWQgb24gT3BlbiBaZXBwZWxpbiBSZWZ1bmQgVmF1bHQgY29udHJhY3QKICogaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXBwZWxpbi1zb2xpZGl0eS9ibG9iL21hc3Rlci9jb250cmFjdHMvY3Jvd2RzYWxlL1JlZnVuZFZhdWx0LnNvbAogKiB0aGUgb25seSB0aGluZyB0aGF0IGRpZmZlcnMgaXMgYSBoYXJkY29kZWQgd2FsbGV0IGFkZHJlc3MKICovCgovKioKICogQHRpdGxlIFJlZnVuZFZhdWx0LgogKiBAZGV2IFRoaXMgY29udHJhY3QgaXMgdXNlZCBmb3Igc3RvcmluZyBmdW5kcyB3aGlsZSBhIGNyb3dkc2FsZQogKiBpcyBpbiBwcm9ncmVzcy4gU3VwcG9ydHMgcmVmdW5kaW5nIHRoZSBtb25leSBpZiBjcm93ZHNhbGUgZmFpbHMsCiAqIGFuZCBmb3J3YXJkaW5nIGl0IGlmIGNyb3dkc2FsZSBpcyBzdWNjZXNzZnVsLgogKi8KY29udHJhY3QgVkxCUmVmdW5kVmF1bHQgaXMgT3duYWJsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICBlbnVtIFN0YXRlIHtBY3RpdmUsIFJlZnVuZGluZywgQ2xvc2VkfQogICAgU3RhdGUgcHVibGljIHN0YXRlOwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGRlcG9zaXRlZDsKCiAgICBhZGRyZXNzIHB1YmxpYyBjb25zdGFudCB3YWxsZXQgPSAweDAyRDQwOGJjMjAzOTIxNjQ2RUNBNjliNTU1NTI0REYzYzdmM2E4ZDc7CgogICAgYWRkcmVzcyBjcm93ZHNhbGVDb250cmFjdEFkZHJlc3M7CgogICAgZXZlbnQgQ2xvc2VkKCk7CiAgICBldmVudCBSZWZ1bmRzRW5hYmxlZCgpOwogICAgZXZlbnQgUmVmdW5kZWQoYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHdlaUFtb3VudCk7CgogICAgZnVuY3Rpb24gVkxCUmVmdW5kVmF1bHQoKSB7CiAgICAgICAgc3RhdGUgPSBTdGF0ZS5BY3RpdmU7CiAgICB9CgogICAgbW9kaWZpZXIgb25seUNyb3dkc2FsZUNvbnRyYWN0KCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjcm93ZHNhbGVDb250cmFjdEFkZHJlc3MpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gc2V0Q3Jvd2RzYWxlQWRkcmVzcyhhZGRyZXNzIF9jcm93ZHNhbGVBZGRyZXNzKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoX2Nyb3dkc2FsZUFkZHJlc3MgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgY3Jvd2RzYWxlQ29udHJhY3RBZGRyZXNzID0gX2Nyb3dkc2FsZUFkZHJlc3M7CiAgICB9CgogICAgZnVuY3Rpb24gZGVwb3NpdChhZGRyZXNzIGludmVzdG9yKSBvbmx5Q3Jvd2RzYWxlQ29udHJhY3QgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5BY3RpdmUpOwogICAgICAgIGRlcG9zaXRlZFtpbnZlc3Rvcl0gPSBkZXBvc2l0ZWRbaW52ZXN0b3JdLmFkZChtc2cudmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNsb3NlKGFkZHJlc3MgX3dpbmdzV2FsbGV0KSBvbmx5Q3Jvd2RzYWxlQ29udHJhY3QgZXh0ZXJuYWwgewogICAgICAgIHJlcXVpcmUoX3dpbmdzV2FsbGV0ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuQWN0aXZlKTsKICAgICAgICBzdGF0ZSA9IFN0YXRlLkNsb3NlZDsKICAgICAgICBDbG9zZWQoKTsKICAgICAgICB1aW50MjU2IHdpbmdzUmV3YXJkID0gdGhpcy5iYWxhbmNlLmRpdigxMDApOwogICAgICAgIF93aW5nc1dhbGxldC50cmFuc2Zlcih3aW5nc1Jld2FyZCk7CiAgICAgICAgd2FsbGV0LnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgICB9CgogICAgZnVuY3Rpb24gZW5hYmxlUmVmdW5kcygpIG9ubHlDcm93ZHNhbGVDb250cmFjdCBleHRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5BY3RpdmUpOwogICAgICAgIHN0YXRlID0gU3RhdGUuUmVmdW5kaW5nOwogICAgICAgIFJlZnVuZHNFbmFibGVkKCk7CiAgICB9CgogICAgZnVuY3Rpb24gcmVmdW5kKGFkZHJlc3MgaW52ZXN0b3IpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5SZWZ1bmRpbmcpOwogICAgICAgIHVpbnQyNTYgZGVwb3NpdGVkVmFsdWUgPSBkZXBvc2l0ZWRbaW52ZXN0b3JdOwogICAgICAgIGRlcG9zaXRlZFtpbnZlc3Rvcl0gPSAwOwogICAgICAgIGludmVzdG9yLnRyYW5zZmVyKGRlcG9zaXRlZFZhbHVlKTsKICAgICAgICBSZWZ1bmRlZChpbnZlc3RvciwgZGVwb3NpdGVkVmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBraWxsZXIgbWV0aG9kIHRoYXQgY2FuIGJ1IHVzZWQgYnkgb3duZXIgdG8KICAgICAqICAgICAga2lsbCB0aGUgY29udHJhY3QgYW5kIHNlbmQgZnVuZHMgdG8gb3duZXIKICAgICAqLwogICAgZnVuY3Rpb24ga2lsbCgpIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5DbG9zZWQpOwogICAgICAgIHNlbGZkZXN0cnVjdChvd25lcik7CiAgICB9Cn0KCgoKLyoqCiAqIEB0aXRsZSBWTEJDcm93ZHNhbGUKICogQGRldiBWTEIgY3Jvd2RzYWxlIGNvbnRyYWN0IGJvcnJvd3MgWmVwcGVsaW4gRmluYWxpemVkLCBDYXBwZWQgYW5kIFJlZnVuZGFibGUgY3Jvd2RzYWxlcyBpbXBsZW1lbnRhdGlvbnMKICovCmNvbnRyYWN0IFZMQkNyb3dkc2FsZSBpcyBPd25hYmxlLCBQYXVzYWJsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKCiAgICAvKioKICAgICAqIEBkZXYgdG9rZW4gY29udHJhY3QKICAgICAqLwogICAgVkxCVG9rZW4gcHVibGljIHRva2VuOwoKICAgIC8qKgogICAgICogQGRldiByZWZ1bmQgdmF1bHQgdXNlZCB0byBob2xkIGZ1bmRzIHdoaWxlIGNyb3dkc2FsZSBpcyBydW5uaW5nCiAgICAgKi8KICAgIFZMQlJlZnVuZFZhdWx0IHB1YmxpYyB2YXVsdDsKCiAgICAvKioKICAgICAqIEBkZXYgdG9rZW5zYWxlKHByZXNhbGUpIHN0YXJ0IHRpbWU6IE5vdiAyMiwgMjAxNywgMTI6MDA6MDAgVVRDICgxNTExMzUyMDAwKQogICAgICovCiAgICB1aW50IHN0YXJ0VGltZSA9IDE1MTEzNTIwMDA7CgogICAgLyoqCiAgICAgKiBAZGV2IHRva2Vuc2FsZSBlbmQgdGltZTogRGVjIDE3LCAyMDE3IDEyOjAwOjAwIFVUQyAoMTUxMzUxMjAwMCksIG9yIHRoZSBkYXRlIHdoZW4KICAgICAqICAgICAgIDMwMOKAmTAwMCBldGhlciBoYXZlIGJlZW4gY29sbGVjdGVkLCB3aGljaGV2ZXIgb2NjdXJzIGZpcnN0LiBzZWUgaGFzRW5kZWQoKQogICAgICogICAgICAgZm9yIG1vcmUgZGV0YWlscwogICAgICovCiAgICB1aW50IGVuZFRpbWUgPSAxNTEzNTEyMDAwOwoKICAgIC8qKgogICAgICogQGRldiBtaW5pbXVtIHB1cmNoYXNlIGFtb3VudCBmb3IgcHJlc2FsZQogICAgICovCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBtaW5QcmVzYWxlQW1vdW50ID0gMTAwICogMTAqKjE4OyAvLyAxMDAgZXRoZXIKCiAgICAvKioKICAgICAqIEBkZXYgbWluaW11bSBhbmQgbWF4aW11bSBhbW91bnQgb2YgZnVuZHMgdG8gYmUgcmFpc2VkIGluIHdlaXMKICAgICAqLwogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgZ29hbCA9IDI1ICogMTAqKjIxOyAgLy8gMjUgS2V0aGVyCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBjYXAgID0gMzAwICogMTAqKjIxOyAvLyAzMDAgS2V0aGVyCgogICAgLyoqCiAgICAgKiBAZGV2IGFtb3VudCBvZiByYWlzZWQgbW9uZXkgaW4gd2VpCiAgICAgKi8KICAgIHVpbnQyNTYgcHVibGljIHdlaVJhaXNlZDsKCiAgICAvKioKICAgICAqIEBkZXYgdG9rZW5zYWxlIGZpbmFsaXphdGlvbiBmbGFnCiAgICAgKi8KICAgIGJvb2wgcHVibGljIGlzRmluYWxpemVkID0gZmFsc2U7CgogICAgLyoqCiAgICAgKiBAZGV2IGV2ZW50IGZvciB0b2tlbiBwdXJjaGFzZSBsb2dnaW5nCiAgICAgKiBAcGFyYW0gcHVyY2hhc2VyIHdobyBwYWlkIGZvciB0aGUgdG9rZW5zCiAgICAgKiBAcGFyYW0gYmVuZWZpY2lhcnkgd2hvIGdvdCB0aGUgdG9rZW5zCiAgICAgKiBAcGFyYW0gdmFsdWUgd2VpcyBwYWlkIGZvciBwdXJjaGFzZQogICAgICogQHBhcmFtIGFtb3VudCBhbW91bnQgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAgICovCiAgICBldmVudCBUb2tlblB1cmNoYXNlKGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB2YWx1ZSwgdWludDI1NiBhbW91bnQpOwoKICAgIC8qKgogICAgICogQGRldiBldmVudCBmb3IgdG9rZW5zYWxlIGZpbmFsIGxvZ2dpbmcKICAgICAqLwogICAgZXZlbnQgRmluYWxpemVkKCk7CgogICAgLyoqCiAgICAgKiBAZGV2IENyb3dkc2FsZSBpbiB0aGUgY29uc3RydWN0b3IgdGFrZXMgYWRkcmVzc2VzIG9mCiAgICAgKiAgICAgIHRoZSBqdXN0IGRlcGxveWVkIFZMQlRva2VuIGFuZCBWTEJSZWZ1bmRWYXVsdCBjb250cmFjdHMKICAgICAqIEBwYXJhbSBfdG9rZW5BZGRyZXNzIGFkZHJlc3Mgb2YgdGhlIFZMQlRva2VuIGRlcGxveWVkIGNvbnRyYWN0CiAgICAgKiBAcGFyYW0gX3ZhdWx0QWRkcmVzcyBhZGRyZXNzIG9mIHRoZSBWTEJSZWZ1bmRWYXVsdCBkZXBsb3llZCBjb250cmFjdAogICAgICovCiAgICBmdW5jdGlvbiBWTEJDcm93ZHNhbGUoYWRkcmVzcyBfdG9rZW5BZGRyZXNzLCBhZGRyZXNzIF92YXVsdEFkZHJlc3MpIHsKICAgICAgICByZXF1aXJlKF90b2tlbkFkZHJlc3MgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdmF1bHRBZGRyZXNzICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICAvLyBWTEJUb2tlbiBhbmQgVkxCUmVmdW5kVmF1bHQgd2FzIGRlcGxveWVkIHNlcGFyYXRlbHkKICAgICAgICB0b2tlbiA9IFZMQlRva2VuKF90b2tlbkFkZHJlc3MpOwogICAgICAgIHZhdWx0ID0gVkxCUmVmdW5kVmF1bHQoX3ZhdWx0QWRkcmVzcyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGZhbGxiYWNrIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIGJ1eSB0b2tlbnMKICAgICAqLwogICAgZnVuY3Rpb24oKSBwYXlhYmxlIHsKICAgICAgICBidXlUb2tlbnMobXNnLnNlbmRlcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IG1haW4gZnVuY3Rpb24gdG8gYnV5IHRva2VucwogICAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IHRhcmdldCB3YWxsZXQgZm9yIHRva2VucyBjYW4gdmFyeSBmcm9tIHRoZSBzZW5kZXIgb25lCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KSB3aGVuTm90UGF1c2VkIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKGJlbmVmaWNpYXJ5ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUodmFsaWRQdXJjaGFzZShtc2cudmFsdWUpKTsKCiAgICAgICAgdWludDI1NiB3ZWlBbW91bnQgPSBtc2cudmFsdWU7CgogICAgICAgIC8vIGJ1eWVyIGFuZCBiZW5lZmljaWFyeSBjb3VsZCBiZSB0d28gZGlmZmVyZW50IHdhbGxldHMKICAgICAgICBhZGRyZXNzIGJ1eWVyID0gbXNnLnNlbmRlcjsKCiAgICAgICAgLy8gY2FsY3VsYXRlIHRva2VuIGFtb3VudCB0byBiZSBjcmVhdGVkCiAgICAgICAgdWludDI1NiB0b2tlbnMgPSB3ZWlBbW91bnQubXVsKGdldENvbnZlcnNpb25SYXRlKCkpOwoKICAgICAgICB3ZWlSYWlzZWQgPSB3ZWlSYWlzZWQuYWRkKHdlaUFtb3VudCk7CgogICAgICAgIGlmICghdG9rZW4udHJhbnNmZXJGcm9tKHRva2VuLmNyb3dkc2FsZVRva2Vuc1dhbGxldCgpLCBiZW5lZmljaWFyeSwgdG9rZW5zKSkgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CgogICAgICAgIFRva2VuUHVyY2hhc2UoYnV5ZXIsIGJlbmVmaWNpYXJ5LCB3ZWlBbW91bnQsIHRva2Vucyk7CgogICAgICAgIHZhdWx0LmRlcG9zaXQudmFsdWUod2VpQW1vdW50KShidXllcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGNoZWNrIGlmIHRoZSBjdXJyZW50IHB1cmNoYXNlIHZhbGlkIGJhc2VkIG9uIHRpbWUgYW5kIGFtb3VudCBvZiBwYXNzZWQgZXRoZXIKICAgICAqIEBwYXJhbSBfdmFsdWUgYW1vdW50IG9mIHBhc3NlZCBldGhlcgogICAgICogQHJldHVybiB0cnVlIGlmIGludmVzdG9ycyBjYW4gYnV5IGF0IHRoZSBtb21lbnQKICAgICAqLwogICAgZnVuY3Rpb24gdmFsaWRQdXJjaGFzZSh1aW50MjU2IF92YWx1ZSkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGJvb2wgbm9uWmVyb1B1cmNoYXNlID0gX3ZhbHVlICE9IDA7CiAgICAgICAgYm9vbCB3aXRoaW5QZXJpb2QgPSBub3cgPj0gc3RhcnRUaW1lICYmIG5vdyA8PSBlbmRUaW1lOwogICAgICAgIGJvb2wgd2l0aGluQ2FwID0gd2VpUmFpc2VkLmFkZChfdmFsdWUpIDw9IGNhcDsKICAgICAgICAvLyBGb3IgcHJlc2FsZSB3ZSB3YW50IHRvIGRlY2xpbmUgYWxsIHBheW1lbnRzIGxlc3MgdGhlbiBtaW5QcmVzYWxlQW1vdW50CiAgICAgICAgYm9vbCB3aXRoaW5BbW91bnQgPSBub3cgPj0gc3RhcnRUaW1lICsgNSBkYXlzIHx8IG1zZy52YWx1ZSA+PSBtaW5QcmVzYWxlQW1vdW50OwoKICAgICAgICByZXR1cm4gbm9uWmVyb1B1cmNoYXNlICYmIHdpdGhpblBlcmlvZCAmJiB3aXRoaW5DYXAgJiYgd2l0aGluQW1vdW50OwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBjaGVjayBpZiBjcm93ZHNhbGUgc3RpbGwgYWN0aXZlIGJhc2VkIG9uIGN1cnJlbnQgdGltZSBhbmQgY2FwCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBlbmRlZAogICAgICovCiAgICBmdW5jdGlvbiBoYXNFbmRlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgYm9vbCBjYXBSZWFjaGVkID0gd2VpUmFpc2VkID49IGNhcDsKICAgICAgICBib29sIHRpbWVJc1VwID0gbm93ID4gZW5kVGltZTsKICAgICAgICByZXR1cm4gdGltZUlzVXAgfHwgY2FwUmVhY2hlZDsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgaWYgY3Jvd2RzYWxlIGlzIHVuc3VjY2Vzc2Z1bCwgaW52ZXN0b3JzIGNhbiBjbGFpbSByZWZ1bmRzIGhlcmUKICAgICAqLwogICAgZnVuY3Rpb24gY2xhaW1SZWZ1bmQoKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoaXNGaW5hbGl6ZWQpOwogICAgICAgIHJlcXVpcmUoIWdvYWxSZWFjaGVkKCkpOwoKICAgICAgICB2YXVsdC5yZWZ1bmQobXNnLnNlbmRlcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGZpbmFsaXplIGNyb3dkc2FsZS4gdGhpcyBtZXRob2QgdHJpZ2dlcnMgdmF1bHQgYW5kIHRva2VuIGZpbmFsaXphdGlvbgogICAgICovCiAgICBmdW5jdGlvbiBmaW5hbGl6ZSgpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoIWlzRmluYWxpemVkKTsKICAgICAgICByZXF1aXJlKGhhc0VuZGVkKCkpOwoKICAgICAgICAvLyB0cmlnZ2VyIHZhdWx0IGFuZCB0b2tlbiBmaW5hbGl6YXRpb24KICAgICAgICBpZiAoZ29hbFJlYWNoZWQoKSkgewogICAgICAgICAgICB2YXVsdC5jbG9zZSh0b2tlbi53aW5nc1dhbGxldCgpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YXVsdC5lbmFibGVSZWZ1bmRzKCk7CiAgICAgICAgfQoKICAgICAgICB0b2tlbi5lbmRUb2tlbnNhbGUoKTsKICAgICAgICBpc0ZpbmFsaXplZCA9IHRydWU7CgogICAgICAgIEZpbmFsaXplZCgpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBjaGVjayBpZiBoYXJkIGNhcCBnb2FsIGlzIHJlYWNoZWQKICAgICAqLwogICAgZnVuY3Rpb24gZ29hbFJlYWNoZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiB3ZWlSYWlzZWQgPj0gZ29hbDsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgcmV0dXJucyBjdXJyZW50IHRva2VuIHByaWNlIGJhc2VkIG9uIGN1cnJlbnQgcHJlc2FsZSB0aW1lIGZyYW1lCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldENvbnZlcnNpb25SYXRlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBpZiAobm93ID49IHN0YXJ0VGltZSArIDIwIGRheXMpIHsKICAgICAgICAgICAgcmV0dXJuIDY1MDsKICAgICAgICAgICAgLy8gNjUwICAgICAgICBDcm93ZGFzbGUgUGFydCA0CiAgICAgICAgfSBlbHNlIGlmIChub3cgPj0gc3RhcnRUaW1lICsgMTUgZGF5cykgewogICAgICAgICAgICByZXR1cm4gNzE1OwogICAgICAgICAgICAvLyA2NTAgKyAxMCUuIENyb3dkYXNsZSBQYXJ0IDMKICAgICAgICB9IGVsc2UgaWYgKG5vdyA+PSBzdGFydFRpbWUgKyAxMCBkYXlzKSB7CiAgICAgICAgICAgIHJldHVybiA3ODA7CiAgICAgICAgICAgIC8vIDY1MCArIDIwJS4gQ3Jvd2Rhc2xlIFBhcnQgMgogICAgICAgIH0gZWxzZSBpZiAobm93ID49IHN0YXJ0VGltZSArIDUgZGF5cykgewogICAgICAgICAgICByZXR1cm4gODQ1OwogICAgICAgICAgICAvLyA2NTAgKyAzMCUuIENyb3dkYXNsZSBQYXJ0IDEKICAgICAgICB9IGVsc2UgaWYgKG5vdyA+PSBzdGFydFRpbWUpIHsKICAgICAgICAgICAgcmV0dXJuIDkxMDsKICAgICAgICAgICAgLy8gNjUwICsgNDAlLiBQcmVzYWxlCiAgICAgICAgfQogICAgICAgIHJldHVybiAwOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBraWxsZXIgbWV0aG9kIHRoYXQgY2FuIGJ1IHVzZWQgYnkgb3duZXIgdG8KICAgICAqICAgICAga2lsbCB0aGUgY29udHJhY3QgYW5kIHNlbmQgZnVuZHMgdG8gb3duZXIKICAgICAqLwogICAgZnVuY3Rpb24ga2lsbCgpIG9ubHlPd25lciB3aGVuUGF1c2VkIHsKICAgICAgICBzZWxmZGVzdHJ1Y3Qob3duZXIpOwogICAgfQp9'.
	

]
