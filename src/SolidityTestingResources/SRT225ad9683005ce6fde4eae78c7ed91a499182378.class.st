Class {
	#name : #SRT225ad9683005ce6fde4eae78c7ed91a499182378,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT225ad9683005ce6fde4eae78c7ed91a499182378 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7IC8vCgovLyBNb2JTcXVhZHMuaW8KCgpjb250cmFjdCBFUkM3MjEgewogIC8vIFJlcXVpcmVkIG1ldGhvZHMKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWM7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwogIGZ1bmN0aW9uIGltcGxlbWVudHNFUkM3MjEoKSBwdWJsaWMgcHVyZSByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBvd25lck9mKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3MgYWRkcik7CiAgZnVuY3Rpb24gdGFrZU93bmVyc2hpcCh1aW50MjU2IF90b2tlbklkKSBwdWJsaWM7CiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHRvdGFsKTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYzsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljOwoKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHRva2VuSWQpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIGFwcHJvdmVkLCB1aW50MjU2IHRva2VuSWQpOwoKICAvLyBPcHRpb25hbAogIC8vIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcgbmFtZSk7CiAgLy8gZnVuY3Rpb24gc3ltYm9sKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nIHN5bWJvbCk7CiAgLy8gZnVuY3Rpb24gdG9rZW5PZk93bmVyQnlJbmRleChhZGRyZXNzIF9vd25lciwgdWludDI1NiBfaW5kZXgpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NiB0b2tlbklkKTsKICAvLyBmdW5jdGlvbiB0b2tlbk1ldGFkYXRhKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZyBpbmZvVXJsKTsKfQoKY29udHJhY3QgTW9iU3F1YWRzIGlzIEVSQzcyMSB7CgogIC8qKiogRVZFTlRTICoqKi8KCiAgLy8vIEBkZXYgVGhlIEJpcnRoIGV2ZW50IGlzIGZpcmVkIHdoZW5ldmVyIGEgbmV3IG1vYnN0ZXIgY29tZXMgaW50byBleGlzdGVuY2UuCiAgZXZlbnQgQmlydGgodWludDI1NiB0b2tlbklkLCBzdHJpbmcgbmFtZSwgYWRkcmVzcyBvd25lcik7CgogIC8vLyBAZGV2IFRoZSBUb2tlblNvbGQgZXZlbnQgaXMgZmlyZWQgd2hlbmV2ZXIgYSB0b2tlbiBpcyBzb2xkLgogIGV2ZW50IFRva2VuU29sZCh1aW50MjU2IHRva2VuSWQsIHVpbnQyNTYgb2xkUHJpY2UsIHVpbnQyNTYgbmV3UHJpY2UsIGFkZHJlc3MgcHJldk93bmVyLCBhZGRyZXNzIHdpbm5lcik7CgogIC8vLyBAZGV2IFRyYW5zZmVyIGV2ZW50IGFzIGRlZmluZWQgaW4gY3VycmVudCBkcmFmdCBvZiBFUkM3MjEuCiAgLy8vICBvd25lcnNoaXAgaXMgYXNzaWduZWQsIGluY2x1ZGluZyBiaXJ0aHMuCiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHRva2VuSWQpOwoKICAvKioqIENPTlNUQU5UUyAqKiovCgogIC8vLyBAbm90aWNlIE5hbWUgYW5kIHN5bWJvbCBvZiB0aGUgbm9uIGZ1bmdpYmxlIHRva2VuLCBhcyBkZWZpbmVkIGluIEVSQzcyMS4KICBzdHJpbmcgcHVibGljIGNvbnN0YW50IE5BTUUgPSAiTW9iU3F1YWRzIjsgLy8KICBzdHJpbmcgcHVibGljIGNvbnN0YW50IFNZTUJPTCA9ICJNT0JTIjsgLy8KCiAgdWludDI1NiBwdWJsaWMgcHJlY2lzaW9uID0gMTAwMDAwMDAwMDAwMDsgLy8wLjAwMDAwMSBFdGgKCiAgdWludDI1NiBwdWJsaWMgaGl0UHJpY2UgPSAgMC4wMDUgZXRoZXI7CgogIC8qKiogU1RPUkFHRSAqKiovCgogIC8vLyBAZGV2IEEgbWFwcGluZyBmcm9tIG1vYnN0ZXIgSURzIHRvIHRoZSBhZGRyZXNzIHRoYXQgb3ducyB0aGVtLiBBbGwgdmlsbGlhbnMgaGF2ZQogIC8vLyAgc29tZSB2YWxpZCBvd25lciBhZGRyZXNzLgogIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgcHVibGljIG1vYnN0ZXJJbmRleFRvT3duZXI7CgogIC8vIEBkZXYgQSBtYXBwaW5nIGZyb20gb3duZXIgYWRkcmVzcyB0byBjb3VudCBvZiB0b2tlbnMgdGhhdCBhZGRyZXNzIG93bnMuCiAgLy8gIFVzZWQgaW50ZXJuYWxseSBpbnNpZGUgYmFsYW5jZU9mKCkgdG8gcmVzb2x2ZSBvd25lcnNoaXAgY291bnQuCiAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwcml2YXRlIG93bmVyc2hpcFRva2VuQ291bnQ7CgogIC8vLyBAZGV2IEEgbWFwcGluZyBmcm9tIG1vYnN0ZXJzIHRvIGFuIGFkZHJlc3MgdGhhdCBoYXMgYmVlbiBhcHByb3ZlZCB0byBjYWxsCiAgLy8vICB0cmFuc2ZlckZyb20oKS4gRWFjaCBtb2JzdGVyIGNhbiBvbmx5IGhhdmUgb25lIGFwcHJvdmVkIGFkZHJlc3MgZm9yIHRyYW5zZmVyCiAgLy8vICBhdCBhbnkgdGltZS4gQSB6ZXJvIHZhbHVlIG1lYW5zIG5vIGFwcHJvdmFsIGlzIG91dHN0YW5kaW5nLgogIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgcHVibGljIG1vYnN0ZXJJbmRleFRvQXBwcm92ZWQ7CgogIC8vIEBkZXYgQSBtYXBwaW5nIGZyb20gbW9ic3RlcnMgdG8gdGhlIHByaWNlIG9mIHRoZSB0b2tlbi4KICBtYXBwaW5nICh1aW50MjU2ID0+IHVpbnQyNTYpIHByaXZhdGUgbW9ic3RlckluZGV4VG9QcmljZTsKCiAgLy8gVGhlIGFkZHJlc3NlcyBvZiB0aGUgYWNjb3VudHMgKG9yIGNvbnRyYWN0cykgdGhhdCBjYW4gZXhlY3V0ZSBhY3Rpb25zIHdpdGhpbiBlYWNoIHJvbGVzLgogIGFkZHJlc3MgcHVibGljIGNlb0FkZHJlc3M7CiAgYWRkcmVzcyBwdWJsaWMgY29vQWRkcmVzczsKCiAgLy8gbWluaW11bSB0b2tlbnMgYmVmb3JlIHNhbGVzCiAgdWludDI1NiBwdWJsaWMgbWluaW11bVRva2Vuc0JlZm9yZVNhbGUgPSAxMzsKCiAgLyoqKiBEQVRBVFlQRVMgKioqLwogIHN0cnVjdCBNb2JzdGVyIHsKICAgIHVpbnQyNTYgaWQ7IC8vIG5lZWRlZCBmb3IgZ25hcmx5IGZyb250IGVuZAogICAgc3RyaW5nIG5hbWU7CiAgICB1aW50MjU2IGJvc3M7IC8vIHdoaWNoIGdhbmcgbWVtYmVyIG9mCiAgICB1aW50MjU2IHN0YXRlOyAvLyAwID0gbm9ybWFsICwgMSA9IGRhemVkCiAgICB1aW50MjU2IGRhemVkRXhpcHJ5VGltZTsgLy8gaWYgdGhpcyBtb2JzdGVyIHdhcyBkaXNhcm1lZCwgd2hlbiBkb2VzIGl0IGV4cGlyZQogICAgdWludDI1NiBidXlQcmljZTsgLy8gdGhlIHByaWNlIGF0IHdoaWNoIHRoaXMgbW9ic3RlciB3YXMgYm9zc2QKICB9CgogIE1vYnN0ZXJbXSBwcml2YXRlIG1vYnN0ZXJzOwogIHVpbnQyNTYgcHVibGljIGxlYWRpbmdHYW5nOwogIHVpbnQyNTYgcHVibGljIGxlYWRpbmdIaXRDb3VudDsKICB1aW50MjU2W10gcHVibGljIGdhbmdIaXRzOyAgLy8gbnVtYmVyIG9mIGhpdHMgYSBnYW5nIGhhcyBkb25lCiAgdWludDI1NiBwdWJsaWMgY3VycmVudEhpdFRvdGFsOwogIHVpbnQyNTYgcHVibGljIGxldGhhbEJvbnVzQXRIaXRzID0gMjAwOwoKCiAgLy8gQGRldiBBIG1hcHBpbmcgZnJvbSBtb2JzdGVycyB0byB0aGUgcHJpY2Ugb2YgdGhlIHRva2VuLgogIG1hcHBpbmcgKHVpbnQyNTYgPT4gdWludDI1NikgcHJpdmF0ZSBib3NzSW5kZXhUb0dhbmc7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIG1vYnN0ZXJCYWxhbmNlczsKCgogIC8qKiogQUNDRVNTIE1PRElGSUVSUyAqKiovCiAgLy8vIEBkZXYgQWNjZXNzIG1vZGlmaWVyIGZvciBDRU8tb25seSBmdW5jdGlvbmFsaXR5CiAgbW9kaWZpZXIgb25seUNFTygpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjZW9BZGRyZXNzKTsKICAgIF87CiAgfQoKICAvLy8gQGRldiBBY2Nlc3MgbW9kaWZpZXIgZm9yIENPTy1vbmx5IGZ1bmN0aW9uYWxpdHkKICBtb2RpZmllciBvbmx5Q09PKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNvb0FkZHJlc3MpOwogICAgXzsKICB9CgogIC8vLyBBY2Nlc3MgbW9kaWZpZXIgZm9yIGNvbnRyYWN0IG93bmVyIG9ubHkgZnVuY3Rpb25hbGl0eQogIG1vZGlmaWVyIG9ubHlDTGV2ZWwoKSB7CiAgICByZXF1aXJlKAogICAgICBtc2cuc2VuZGVyID09IGNlb0FkZHJlc3MgfHwKICAgICAgbXNnLnNlbmRlciA9PSBjb29BZGRyZXNzCiAgICApOwogICAgXzsKICB9CgogIC8qKiogQ09OU1RSVUNUT1IgKioqLwogIGZ1bmN0aW9uIE1vYlNxdWFkcygpIHB1YmxpYyB7CiAgICBjZW9BZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgIGNvb0FkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgbGVhZGluZ0hpdENvdW50ID0gMDsKICAgICBnYW5nSGl0cy5sZW5ndGgrKzsKICAvLyAgX2NyZWF0ZU1vYnN0ZXIoIlRoZSBHb2RmYXRoZXIiLGFkZHJlc3ModGhpcyksMjAwMDAwMDAwMDAwMDAwMCwwKTsKICB9CgogIC8qKiogUFVCTElDIEZVTkNUSU9OUyAqKiovCiAgLy8vIEBub3RpY2UgR3JhbnQgYW5vdGhlciBhZGRyZXNzIHRoZSByaWdodCB0byB0cmFuc2ZlciB0b2tlbiB2aWEgdGFrZU93bmVyc2hpcCgpIGFuZCB0cmFuc2ZlckZyb20oKS4KICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byBiZSBncmFudGVkIHRyYW5zZmVyIGFwcHJvdmFsLiBQYXNzIGFkZHJlc3MoMCkgdG8KICAvLy8gIGNsZWFyIGFsbCBhcHByb3ZhbHMuCiAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgSUQgb2YgdGhlIFRva2VuIHRoYXQgY2FuIGJlIHRyYW5zZmVycmVkIGlmIHRoaXMgY2FsbCBzdWNjZWVkcy4KICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIGFwcHJvdmUoCiAgICBhZGRyZXNzIF90bywKICAgIHVpbnQyNTYgX3Rva2VuSWQKICApIHB1YmxpYyB7CiAgICAvLyBDYWxsZXIgbXVzdCBvd24gdG9rZW4uCiAgICByZXF1aXJlKF9vd25zKG1zZy5zZW5kZXIsIF90b2tlbklkKSk7CgogICAgbW9ic3RlckluZGV4VG9BcHByb3ZlZFtfdG9rZW5JZF0gPSBfdG87CgogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3RvLCBfdG9rZW5JZCk7CiAgfQoKICAvLy8gRm9yIHF1ZXJ5aW5nIGJhbGFuY2Ugb2YgYSBwYXJ0aWN1bGFyIGFjY291bnQKICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBmb3IgYmFsYW5jZSBxdWVyeQogIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBvd25lcnNoaXBUb2tlbkNvdW50W19vd25lcl07CiAgfQoKICAvLy8gQGRldiBDcmVhdGVzIGEgbmV3IG1vYnN0ZXIgd2l0aCB0aGUgZ2l2ZW4gbmFtZS4KICBmdW5jdGlvbiBjcmVhdGVNb2JzdGVyKHN0cmluZyBfbmFtZSwgdWludDI1NiBfc3RhcnRQcmljZSwgdWludDI1NiBfYm9zcykgcHVibGljIG9ubHlDTGV2ZWwgewogICAgX2NyZWF0ZU1vYnN0ZXIoX25hbWUsIGFkZHJlc3ModGhpcyksIF9zdGFydFByaWNlLF9ib3NzKTsKICB9CgogIC8vLyBAbm90aWNlIFJldHVybnMgYWxsIHRoZSByZWxldmFudCBpbmZvcm1hdGlvbiBhYm91dCBhIHNwZWNpZmljIG1vYnN0ZXIuCiAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgdG9rZW5JZCBvZiB0aGUgbW9ic3RlciBvZiBpbnRlcmVzdC4KICBmdW5jdGlvbiBnZXRNb2JzdGVyKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKAogICAgdWludDI1NiBpZCwKICAgIHN0cmluZyBuYW1lLAogICAgdWludDI1NiBib3NzLAogICAgdWludDI1NiBzZWxsaW5nUHJpY2UsCiAgICBhZGRyZXNzIG93bmVyLAogICAgdWludDI1NiBzdGF0ZSwKICAgIHVpbnQyNTYgZGF6ZWRFeGlwcnlUaW1lLAogICAgdWludDI1NiBidXlQcmljZSwKICAgIHVpbnQyNTYgbmV4dFByaWNlCiAgKSB7CiAgICBpZCA9IF90b2tlbklkOwogICAgTW9ic3RlciBzdG9yYWdlIG1vYnN0ZXIgPSBtb2JzdGVyc1tfdG9rZW5JZF07CiAgICBuYW1lID0gbW9ic3Rlci5uYW1lOwogICAgYm9zcyA9IG1vYnN0ZXIuYm9zczsKICAgIHNlbGxpbmdQcmljZSA9bW9ic3RlckluZGV4VG9QcmljZVtfdG9rZW5JZF07CiAgICBvd25lciA9IG1vYnN0ZXJJbmRleFRvT3duZXJbX3Rva2VuSWRdOwogICAgc3RhdGUgPSBtb2JzdGVyLnN0YXRlOwogICAgaWYgKG1vYnN0ZXIuc3RhdGU9PTEgJiYgbm93Pm1vYnN0ZXIuZGF6ZWRFeGlwcnlUaW1lKXsKICAgICAgICBzdGF0ZT0wOyAvLyB0aW1lIGV4cGlyZWQgc28gc2F5IHRoZXkgYXJlIGFybWVkCiAgICB9CiAgICBkYXplZEV4aXByeVRpbWU9bW9ic3Rlci5kYXplZEV4aXByeVRpbWU7CiAgICBidXlQcmljZT1tb2JzdGVyLmJ1eVByaWNlOwogICAgbmV4dFByaWNlPWNhbGN1bGF0ZU5ld1ByaWNlKF90b2tlbklkKTsKICB9CgoKICBmdW5jdGlvbiBzZXRMZXRoYWxCb251c0F0SGl0cyAodWludDI1NiBfY291bnQpIHB1YmxpYyBvbmx5Q0xldmVsIHsKICAgICAgICBsZXRoYWxCb251c0F0SGl0cyA9IF9jb3VudDsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRIaXRQcmljZSAodWludDI1NiBfcHJpY2UpIHB1YmxpYyBvbmx5Q0xldmVsIHsKICAgICAgICAgIGhpdFByaWNlID0gX3ByaWNlOwogICAgICB9CgogIC8vLyBoaXQgYSBtb2JzdGVyCiAgZnVuY3Rpb24gaGl0TW9ic3Rlcih1aW50MjU2IF92aWN0aW0gICwgdWludDI1NiBfaGl0dGVyKSBwdWJsaWMgcGF5YWJsZSByZXR1cm5zIChib29sKXsKICAgIGFkZHJlc3MgbW9ic3Rlck93bmVyID0gbW9ic3RlckluZGV4VG9Pd25lcltfdmljdGltXTsKICAgIHJlcXVpcmUobXNnLnNlbmRlciAhPSBtb2JzdGVyT3duZXIpOyAvLyBpdCBkb2Vzbid0IG1ha2Ugc2Vuc2UsIGJ1dCBoZXkKICAgIHJlcXVpcmUobXNnLnNlbmRlcj09bW9ic3RlckluZGV4VG9Pd25lcltfaGl0dGVyXSk7IC8vIHRoZXkgbXVzdCBiZSBhIGhpdHRlciBvd25lcgoKICAgIC8vIEdvZGZhdGhlciBjYW5ub3QgYmUgaGl0CiAgICBpZiAobXNnLnZhbHVlPj1oaXRQcmljZSAmJiBfdmljdGltIT0wICYmIF9oaXR0ZXIhPTApewogICAgICAgIC8vIHphcCBtb2JzdGVyCiAgICAgICAgbW9ic3RlcnNbX3ZpY3RpbV0uc3RhdGU9MTsKICAgICAgICBtb2JzdGVyc1tfdmljdGltXS5kYXplZEV4aXByeVRpbWUgPSBub3cgKyAoMiAqIDEgbWludXRlcyk7CgogICAgICAgIHVpbnQyNTYgZ2FuZ051bWJlcj1TYWZlTWF0aC5kaXYobW9ic3RlcnNbX2hpdHRlcl0uYm9zcyw2KSsxOwoKICAgICAgICBnYW5nSGl0c1tnYW5nTnVtYmVyXSsrOyAvLyBpbmNyZWFzZSB0aGUgaGl0IGNvdW50IGZvciB0aGlzIGdhbmcKICAgICAgICBjdXJyZW50SGl0VG90YWwrKzsKCiAgICAgICAgaWYgIChnYW5nSGl0c1tnYW5nTnVtYmVyXT5sZWFkaW5nSGl0Q291bnQpewogICAgICAgICAgICBsZWFkaW5nSGl0Q291bnQ9Z2FuZ0hpdHNbZ2FuZ051bWJlcl07CiAgICAgICAgICAgIGxlYWRpbmdHYW5nPWdhbmdOdW1iZXI7CiAgICAgICAgfQoKICAgICAgLy8gTGV0aGFsIEJvbnVzIFRpbWUKICAgICBpZiAoY3VycmVudEhpdFRvdGFsPT1sZXRoYWxCb251c0F0SGl0cyl7CiAgICAgICB1aW50MjU2IGxldGhhbEJvbnVzID0gU2FmZU1hdGgubXVsKFNhZmVNYXRoLmRpdihjdXJyZW50SGl0VG90YWwgKiBoaXRQcmljZSwxMDApLDE1KTsgLy8gMTUlID0gOTAlIGZvciBtb2JzdGVycy9ib3NzZXMKCiAgICAgICAgIC8vIGVhY2ggb2YgdGhlIDYgbWVtYmVycyBvZiB0aGUgZ2FuZyB3aXRoIHRoZSBtb3N0IGhpdHMgcmVjZWl2ZXMgMTAlIG9mIHRoZSBIaXQgUG9vbAogICAgICAgICB1aW50MjU2IHdpbm5pbmdNb2JzdGVySW5kZXggID0gKDYqKGxlYWRpbmdHYW5nLTEpKSsxOyAvLyBpbmNsdWRlIHRoZSBib3NzCiAgICAgICAgIGZvciAodWludDI1NiB4ID0gd2lubmluZ01vYnN0ZXJJbmRleDt4PDYrd2lubmluZ01vYnN0ZXJJbmRleDt4KyspewogICAgICAgICAgICAgaWYobW9ic3RlckluZGV4VG9Pd25lclt4XSE9MCAmJiBtb2JzdGVySW5kZXhUb093bmVyW3hdIT1hZGRyZXNzKHRoaXMpKXsKICAgICAgICAgICAgICAgICAgICAgICAgIG1vYnN0ZXJCYWxhbmNlc1sgbW9ic3RlckluZGV4VG9Pd25lclt4XV0rPWxldGhhbEJvbnVzOyAvLyBhdmFpbGFibGUgZm9yIHdpdGhkcmF3YWwKICAgICAgICAgICAgICB9CiAgICAgICAgIH0gLy8gZW5kIGZvciB0aGlzIGdhbmcKCiAgICAgICAgIGN1cnJlbnRIaXRUb3RhbD0wOyAvLyByZXNldCB0aGUgY291bnRlcgoKICAgICAgICAgLy8gbmVlZCB0byByZXNldCB0aGUgZ2FuZ0hpdHMKICAgICAgICAgZm9yICh1aW50MjU2IHkgPSAwIDsgeTxnYW5nSGl0cy5sZW5ndGg7eSsrKXsKICAgICAgICAgICBnYW5nSGl0c1t5XT0wOwogICAgICAgICAgIGxlYWRpbmdIaXRDb3VudD0wOwogICAgICAgICAgIGxlYWRpbmdHYW5nPTA7CiAgICAgICAgIH0KCiAgICAgfSAvLyBlbmQgaWYgYm9udXMgdGltZQoKCiAgIH0gLy8gZW5kIGlmIHRoaXMgaXMgYSBoaXQKCn0KCgogIGZ1bmN0aW9uIGltcGxlbWVudHNFUkM3MjEoKSBwdWJsaWMgcHVyZSByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgZnVuY3Rpb24gbmFtZSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKHN0cmluZykgewogICAgcmV0dXJuIE5BTUU7CiAgfQoKICAvLy8gRm9yIHF1ZXJ5aW5nIG93bmVyIG9mIHRva2VuCiAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgdG9rZW5JRCBmb3Igb3duZXIgaW5xdWlyeQogIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF90b2tlbklkKQogICAgcHVibGljCiAgICB2aWV3CiAgICByZXR1cm5zIChhZGRyZXNzIG93bmVyKQogIHsKICAgIG93bmVyID0gbW9ic3RlckluZGV4VG9Pd25lcltfdG9rZW5JZF07CiAgICByZXF1aXJlKG93bmVyICE9IGFkZHJlc3MoMCkpOwogIH0KCiAgZnVuY3Rpb24gcGF5b3V0KGFkZHJlc3MgX3RvKSBwdWJsaWMgb25seUNMZXZlbCB7CiAgICBfcGF5b3V0KF90byk7CiAgfQoKCgogIC8vIEFsbG93cyBzb21lb25lIHRvIHNlbmQgZXRoZXIgYW5kIG9idGFpbiB0aGUgdG9rZW4KICBmdW5jdGlvbiBwdXJjaGFzZSh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgcGF5YWJsZSB7CiAgICBhZGRyZXNzIG9sZE93bmVyID0gbW9ic3RlckluZGV4VG9Pd25lcltfdG9rZW5JZF07CgogICAgdWludDI1NiBzZWxsaW5nUHJpY2UgPSBtb2JzdGVySW5kZXhUb1ByaWNlW190b2tlbklkXTsKICAgIC8vIG5vIHNhbGVzIHVudGlsIHdlIHJlYWNoIGEgbWluaW11bSBhbW91bnQKICAgIHJlcXVpcmUodG90YWxTdXBwbHkoKT49bWluaW11bVRva2Vuc0JlZm9yZVNhbGUpOwoKICAgIC8vIE1ha2luZyBzdXJlIHRva2VuIG93bmVyIGlzIG5vdCBzZW5kaW5nIHRvIHNlbGYKICAgIHJlcXVpcmUob2xkT3duZXIgIT0gbXNnLnNlbmRlcik7CgogICAgLy8gU2FmZXR5IGNoZWNrIHRvIHByZXZlbnQgYWdhaW5zdCBhbiB1bmV4cGVjdGVkIDB4MCBkZWZhdWx0LgogICAgcmVxdWlyZShfYWRkcmVzc05vdE51bGwobXNnLnNlbmRlcikpOwoKICAgIC8vIE1ha2luZyBzdXJlIHNlbnQgYW1vdW50IGlzIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byB0aGUgc2VsbGluZ1ByaWNlCiAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSBzZWxsaW5nUHJpY2UpOwoKLy8gR29kZmF0aGVyIHdoZW4gc29sZCB3aWxsIHJhaXNlIGJ5IDE3JSAoMTAlIHByZXZpb3VzIG93bmVyICwgMy41JSB0byBjb250cmFjdCwgMyw1JSB0byBwb29sIGZvciBtb2JzdGVycykKLy8gQm9zc2VzIHdoZW4gc29sZCB3aWxsIHJhaXNlIGJ5IDE3JSAoMTAlIHByZXZpb3VzIG93bmVyICwgMy41JSB0byBjb250cmFjdCAsIDMuNSUgdG8gR29kZmF0aGVyIG93bmVyKQovLyBNb2JzdGVycyB3aGVuIHNvbGQgd2lsbCByYWlzZSBieSAyMiUgKDEwJSBwcmV2aW91cyBvd25lciwgMy41JSB0byBHb2RmYXRoZXIsIDMuNSUgdG8gY29udHJhY3QsIDUlIHRvIHRoZWlyIGJvc3Mgb3duZXIpCiAgICB1aW50MjU2IGNvbnRyYWN0RmVlID0gcm91bmRJdCh1aW50MjU2KFNhZmVNYXRoLm11bChTYWZlTWF0aC5kaXYobW9ic3RlcnNbX3Rva2VuSWRdLmJ1eVByaWNlLDEwMDApLDM1KSkpOyAvLyAzLjUlCgogICAgIC8vIGdvZGZhdGhlciBpcyBmbGlwcGVkCiAgICBpZiAoX3Rva2VuSWQ9PTApewogICAgICAgIHVpbnQyNTYgcG9vbFBheW1lbnQgPSByb3VuZEl0KHVpbnQyNTYoU2FmZU1hdGguZGl2KGNvbnRyYWN0RmVlLDUpKSk7IC8vIDIwJQogICAgICAgIC8vIGVhY2ggb2YgdGhlIDUgbWVtYmVycyBvZiB0aGUgZ2FuZyB3aXRoIHRoZSBtb3N0IGhpdHMgcmVjZWl2ZXMgMjAlIG9mIHRoZSBtb2JzdGVyUG9vbAoKICAgICAgICAvL2xlYWRpbmdHYW5nIDAsMSwyLDMsNCA9IGdhbmdzCiAgICAgICAgLy8gbGVhZGVycyBhcmUgIGFsd2F5cyAxLDcsMTMsMTksMjUgLCwsLCBzbyBtb2JzdGVycyBhcmUgKDYqbGVhZGluZ0dhbmcpKzI7IC0tPgogICAgICAgIHVpbnQyNTYgd2lubmluZ01vYnN0ZXJJbmRleCAgPSAoNioobGVhZGluZ0dhbmctMSkpKzI7IC8vIGJvc3Mgbm90IGluY2x1ZGVkIGluIG1vYnN0ZXIgcGF5bWVudHMKICAgICAgICBmb3IgKHVpbnQyNTYgeCA9IHdpbm5pbmdNb2JzdGVySW5kZXg7eDw1K3dpbm5pbmdNb2JzdGVySW5kZXg7eCsrKXsKICAgICAgICAgICAgaWYobW9ic3RlckluZGV4VG9Pd25lclt4XSE9MCAmJiAgbW9ic3RlckluZGV4VG9Pd25lclt4XSE9YWRkcmVzcyh0aGlzKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIG1vYnN0ZXJCYWxhbmNlc1sgbW9ic3RlckluZGV4VG9Pd25lclt4XV0rPXBvb2xQYXltZW50OyAvLyBhdmFpbGFibGUgZm9yIHdpdGhkcmF3YWwKICAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIG5lZWQgdG8gcmVzZXQgdGhlIGdhbmdIaXRzCiAgICAgICAgZm9yICh1aW50MjU2IHkgPSAwIDsgeTxnYW5nSGl0cy5sZW5ndGg7eSsrKXsKICAgICAgICAgIGdhbmdIaXRzW3ldPTA7CiAgICAgICAgICBsZWFkaW5nSGl0Q291bnQ9MDsKICAgICAgICAgIGxlYWRpbmdHYW5nPTA7CiAgICAgICAgfQoKICAgIH0KCgogICAgLy8gYm9zcwogICAgdWludDI1NiBnb2RGYXRoZXJGZWUgPSAwOwogICAgaWYgKF90b2tlbklkIT0wKXsKICAgICAgICBnb2RGYXRoZXJGZWUgPSBjb250cmFjdEZlZTsgLy8gMy41JQogICAgfQogICAgLy8gbW9ic3RlcgogICAgdWludDI1NiBib3NzRmVlID0gMDsKICAgIGlmIChtb2JzdGVyc1tfdG9rZW5JZF0uYm9zcyE9X3Rva2VuSWQgJiYgX3Rva2VuSWQhPTApewogICAgICAgIGJvc3NGZWUgPSAgcm91bmRJdCh1aW50MjU2KFNhZmVNYXRoLmRpdihtb2JzdGVyc1tfdG9rZW5JZF0uYnV5UHJpY2UsMjApKSk7IC8vIDUlCiAgICB9CiAgICAvLyBwYXkgdGhlIGdvZGZhdGhlciBpZiBub3Qgb3duZWQgYnkgY29udHJhY3QKICAgIGlmIChnb2RGYXRoZXJGZWU+MCAmJiBtb2JzdGVySW5kZXhUb093bmVyWzBdIT1hZGRyZXNzKHRoaXMpKXsKICAgICAgICBtb2JzdGVySW5kZXhUb093bmVyWzBdLnRyYW5zZmVyKGdvZEZhdGhlckZlZSk7CiAgICB9CgogICAgIC8vIHBheSB0aGUgYm9zc0ZlZSBpZiBub3Qgb3duZWQgYnkgdGhlIGNvbnRyYWN0CiAgICBpZiAoX3Rva2VuSWQhPTAgJiYgYm9zc0ZlZT4wICYmIG1vYnN0ZXJJbmRleFRvT3duZXJbbW9ic3RlcnNbX3Rva2VuSWRdLmJvc3NdIT1hZGRyZXNzKHRoaXMpKXsKICAgICAgICBtb2JzdGVySW5kZXhUb093bmVyW21vYnN0ZXJzW190b2tlbklkXS5ib3NzXS50cmFuc2Zlcihib3NzRmVlKTsKICAgIH0KCiAgICAgdWludDI1NiBwcmV2aW91c093bmVyUGF5b3V0ID0gcm91bmRJdChTYWZlTWF0aC5tdWwoU2FmZU1hdGguZGl2KG1vYnN0ZXJzW190b2tlbklkXS5idXlQcmljZSwgMTAwKSwgMTEwKSk7IC8vIDExMCUgdG8gcHJldmlvdXMgb3duZXIKCiAgICAgbW9ic3RlckluZGV4VG9QcmljZVtfdG9rZW5JZF0gID0gY2FsY3VsYXRlTmV3UHJpY2UoX3Rva2VuSWQpOwogICAgIG1vYnN0ZXJzW190b2tlbklkXS5zdGF0ZT0wOwogICAgIG1vYnN0ZXJzW190b2tlbklkXS5idXlQcmljZT1zZWxsaW5nUHJpY2U7CgogICAgX3RyYW5zZmVyKG9sZE93bmVyLCBtc2cuc2VuZGVyLCBfdG9rZW5JZCk7CgogICAgLy8gUGF5IHByZXZpb3VzIHRva2VuT3duZXIgaWYgb3duZXIgaXMgbm90IGNvbnRyYWN0CiAgICBpZiAob2xkT3duZXIgIT0gYWRkcmVzcyh0aGlzKSkgewogICAgICBvbGRPd25lci50cmFuc2ZlcihwcmV2aW91c093bmVyUGF5b3V0KTsgLy8gMTEwJSB0byBwcmV2aW91cyBvd25lcgogICAgfQoKICAgIFRva2VuU29sZChfdG9rZW5JZCwgc2VsbGluZ1ByaWNlLCBtb2JzdGVySW5kZXhUb1ByaWNlW190b2tlbklkXSwgb2xkT3duZXIsIG1zZy5zZW5kZXIpOwoKICAgIGlmKFNhZmVNYXRoLnN1Yihtc2cudmFsdWUsIHNlbGxpbmdQcmljZSk+MCl7CiAgICAgICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKFNhZmVNYXRoLnN1Yihtc2cudmFsdWUsIHNlbGxpbmdQcmljZSkpOyAvLyByZXR1cm4gYW55IGFkZGl0aW9uYWwgYW1vdW50CiAgICB9CgogIH0KCiAgZnVuY3Rpb24gcHJpY2VPZih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHByaWNlKSB7CiAgICByZXR1cm4gbW9ic3RlckluZGV4VG9QcmljZVtfdG9rZW5JZF07CiAgfQoKICBmdW5jdGlvbiBuZXh0UHJpY2UodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBuUHJpY2UpIHsKICAgIHJldHVybiBjYWxjdWxhdGVOZXdQcmljZShfdG9rZW5JZCk7CiAgfQoKCiAgICBmdW5jdGlvbiBjbGFpbU1vYnN0ZXJGdW5kcygpIHB1YmxpYyB7CiAgICAgIGlmIChtb2JzdGVyQmFsYW5jZXNbbXNnLnNlbmRlcl09PTApIHJldmVydCgpOwogICAgICB1aW50MjU2IGFtb3VudCA9IG1vYnN0ZXJCYWxhbmNlc1ttc2cuc2VuZGVyXTsKICAgICAgaWYgKGFtb3VudD4wKXsKICAgICAgICBtb2JzdGVyQmFsYW5jZXNbbXNnLnNlbmRlcl0gPSAwOwogICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoYW1vdW50KTsKICAgICAgfQogICAgfQoKCiBmdW5jdGlvbiBjYWxjdWxhdGVOZXdQcmljZSh1aW50MjU2IF90b2tlbklkKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYgcHJpY2UpewogICB1aW50MjU2IHNlbGxpbmdQcmljZSA9IG1vYnN0ZXJJbmRleFRvUHJpY2VbX3Rva2VuSWRdOwogICB1aW50MjU2IG5ld1ByaWNlOwoKICAgLy8gbGV2ZWwgMAogICAvLyBHb2RmYXRoZXIgd2hlbiBzb2xkIHdpbGwgcmFpc2UgYnkgMTclCiAgIGlmIChfdG9rZW5JZD09MCl7CiAgICAgICAgIG5ld1ByaWNlID0gcm91bmRJdChTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKHNlbGxpbmdQcmljZSwgMTE3KSwgMTAwKSk7CiAgIH0KICAgLy8gbGV2ZWwgMQogICAgLy9Cb3NzZXMgd2hlbiBzb2xkIHdpbGwgcmFpc2UgYnkgMTclCiAgaWYgKG1vYnN0ZXJzW190b2tlbklkXS5ib3NzPT1fdG9rZW5JZCAmJiBfdG9rZW5JZCE9MCl7CiAgICAgICAgbmV3UHJpY2UgPSByb3VuZEl0KFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoc2VsbGluZ1ByaWNlLCAxMTcpLCAxMDApKTsKICAgfQogICAvLyBsZXZlbCAyCiAgIC8vIE1vYnN0ZXJzIHdoZW4gc29sZCB3aWxsIHJhaXNlIGJ5IDIyJQogIGlmIChtb2JzdGVyc1tfdG9rZW5JZF0uYm9zcyE9X3Rva2VuSWQpewogICAgICAgIG5ld1ByaWNlPSByb3VuZEl0KFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoc2VsbGluZ1ByaWNlLCAxMjIpLCAxMDApKTsKICAgfQogICByZXR1cm4gbmV3UHJpY2U7CiB9CgogIC8vLyBAZGV2IEFzc2lnbnMgYSBuZXcgYWRkcmVzcyB0byBhY3QgYXMgdGhlIENFTy4gT25seSBhdmFpbGFibGUgdG8gdGhlIGN1cnJlbnQgQ0VPLgogIC8vLyBAcGFyYW0gX25ld0NFTyBUaGUgYWRkcmVzcyBvZiB0aGUgbmV3IENFTwogIGZ1bmN0aW9uIHNldENFTyhhZGRyZXNzIF9uZXdDRU8pIHB1YmxpYyBvbmx5Q0VPIHsKICAgIHJlcXVpcmUoX25ld0NFTyAhPSBhZGRyZXNzKDApKTsKCiAgICBjZW9BZGRyZXNzID0gX25ld0NFTzsKICB9CgogIC8vLyBAZGV2IEFzc2lnbnMgYSBuZXcgYWRkcmVzcyB0byBhY3QgYXMgdGhlIENPTy4gT25seSBhdmFpbGFibGUgdG8gdGhlIGN1cnJlbnQgQ09PLgogIC8vLyBAcGFyYW0gX25ld0NPTyBUaGUgYWRkcmVzcyBvZiB0aGUgbmV3IENPTwogIGZ1bmN0aW9uIHNldENPTyhhZGRyZXNzIF9uZXdDT08pIHB1YmxpYyBvbmx5Q0VPIHsKICAgIHJlcXVpcmUoX25ld0NPTyAhPSBhZGRyZXNzKDApKTsKCiAgICBjb29BZGRyZXNzID0gX25ld0NPTzsKICB9CgogIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgZnVuY3Rpb24gc3ltYm9sKCkgcHVibGljIHB1cmUgcmV0dXJucyAoc3RyaW5nKSB7CiAgICByZXR1cm4gU1lNQk9MOwogIH0KCiAgLy8vIEBub3RpY2UgQWxsb3cgcHJlLWFwcHJvdmVkIHVzZXIgdG8gdGFrZSBvd25lcnNoaXAgb2YgYSB0b2tlbgogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIElEIG9mIHRoZSBUb2tlbiB0aGF0IGNhbiBiZSB0cmFuc2ZlcnJlZCBpZiB0aGlzIGNhbGwgc3VjY2VlZHMuCiAgLy8vIEBkZXYgUmVxdWlyZWQgZm9yIEVSQy03MjEgY29tcGxpYW5jZS4KICBmdW5jdGlvbiB0YWtlT3duZXJzaGlwKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB7CiAgICBhZGRyZXNzIG5ld093bmVyID0gbXNnLnNlbmRlcjsKICAgIGFkZHJlc3Mgb2xkT3duZXIgPSBtb2JzdGVySW5kZXhUb093bmVyW190b2tlbklkXTsKCiAgICAvLyBTYWZldHkgY2hlY2sgdG8gcHJldmVudCBhZ2FpbnN0IGFuIHVuZXhwZWN0ZWQgMHgwIGRlZmF1bHQuCiAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChuZXdPd25lcikpOwoKICAgIC8vIE1ha2luZyBzdXJlIHRyYW5zZmVyIGlzIGFwcHJvdmVkCiAgICByZXF1aXJlKF9hcHByb3ZlZChuZXdPd25lciwgX3Rva2VuSWQpKTsKCiAgICBfdHJhbnNmZXIob2xkT3duZXIsIG5ld093bmVyLCBfdG9rZW5JZCk7CiAgfQoKICAvLy8gQHBhcmFtIF9vd25lciBUaGUgb3duZXIgd2hvc2UgdG9rZW5zIHdlIGFyZSBpbnRlcmVzdGVkIGluLgogIGZ1bmN0aW9uIHRva2Vuc09mT3duZXIoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnModWludDI1NltdIG93bmVyVG9rZW5zKSB7CiAgICB1aW50MjU2IHRva2VuQ291bnQgPSBiYWxhbmNlT2YoX293bmVyKTsKICAgIGlmICh0b2tlbkNvdW50ID09IDApIHsKICAgICAgICAvLyBSZXR1cm4gYW4gZW1wdHkgYXJyYXkKICAgICAgcmV0dXJuIG5ldyB1aW50MjU2W10oMCk7CiAgICB9IGVsc2UgewogICAgICB1aW50MjU2W10gbWVtb3J5IHJlc3VsdCA9IG5ldyB1aW50MjU2W10odG9rZW5Db3VudCk7CiAgICAgIHVpbnQyNTYgdG90YWxtb2JzdGVycyA9IHRvdGFsU3VwcGx5KCk7CiAgICAgIHVpbnQyNTYgcmVzdWx0SW5kZXggPSAwOwoKICAgICAgdWludDI1NiBtb2JzdGVySWQ7CiAgICAgIGZvciAobW9ic3RlcklkID0gMDsgbW9ic3RlcklkIDw9IHRvdGFsbW9ic3RlcnM7IG1vYnN0ZXJJZCsrKSB7CiAgICAgICAgaWYgKG1vYnN0ZXJJbmRleFRvT3duZXJbbW9ic3RlcklkXSA9PSBfb3duZXIpIHsKICAgICAgICAgIHJlc3VsdFtyZXN1bHRJbmRleF0gPSBtb2JzdGVySWQ7CiAgICAgICAgICByZXN1bHRJbmRleCsrOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH0KCiAgLy8vIEZvciBxdWVyeWluZyB0b3RhbFN1cHBseSBvZiB0b2tlbgogIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHRvdGFsKSB7CiAgICByZXR1cm4gbW9ic3RlcnMubGVuZ3RoOwogIH0KCiAgLy8vIE93bmVyIGluaXRhdGVzIHRoZSB0cmFuc2ZlciBvZiB0aGUgdG9rZW4gdG8gYW5vdGhlciBhY2NvdW50CiAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgZm9yIHRoZSB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZCB0by4KICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSBJRCBvZiB0aGUgVG9rZW4gdGhhdCBjYW4gYmUgdHJhbnNmZXJyZWQgaWYgdGhpcyBjYWxsIHN1Y2NlZWRzLgogIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgZnVuY3Rpb24gdHJhbnNmZXIoCiAgICBhZGRyZXNzIF90bywKICAgIHVpbnQyNTYgX3Rva2VuSWQKICApIHB1YmxpYyB7CiAgICByZXF1aXJlKF9vd25zKG1zZy5zZW5kZXIsIF90b2tlbklkKSk7CiAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChfdG8pKTsKCiAgICBfdHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdG9rZW5JZCk7CiAgfQoKICAvLy8gVGhpcmQtcGFydHkgaW5pdGlhdGVzIHRyYW5zZmVyIG9mIHRva2VuIGZyb20gYWRkcmVzcyBfZnJvbSB0byBhZGRyZXNzIF90bwogIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3MgZm9yIHRoZSB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZCBmcm9tLgogIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIGZvciB0aGUgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQgdG8uCiAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgSUQgb2YgdGhlIFRva2VuIHRoYXQgY2FuIGJlIHRyYW5zZmVycmVkIGlmIHRoaXMgY2FsbCBzdWNjZWVkcy4KICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbSgKICAgIGFkZHJlc3MgX2Zyb20sCiAgICBhZGRyZXNzIF90bywKICAgIHVpbnQyNTYgX3Rva2VuSWQKICApIHB1YmxpYyB7CiAgICByZXF1aXJlKF9vd25zKF9mcm9tLCBfdG9rZW5JZCkpOwogICAgcmVxdWlyZShfYXBwcm92ZWQoX3RvLCBfdG9rZW5JZCkpOwogICAgcmVxdWlyZShfYWRkcmVzc05vdE51bGwoX3RvKSk7CgogICAgX3RyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICB9CgogIC8qKiogUFJJVkFURSBGVU5DVElPTlMgKioqLwogIC8vLyBTYWZldHkgY2hlY2sgb24gX3RvIGFkZHJlc3MgdG8gcHJldmVudCBhZ2FpbnN0IGFuIHVuZXhwZWN0ZWQgMHgwIGRlZmF1bHQuCiAgZnVuY3Rpb24gX2FkZHJlc3NOb3ROdWxsKGFkZHJlc3MgX3RvKSBwcml2YXRlIHB1cmUgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIF90byAhPSBhZGRyZXNzKDApOwogIH0KCiAgLy8vIEZvciBjaGVja2luZyBhcHByb3ZhbCBvZiB0cmFuc2ZlciBmb3IgYWRkcmVzcyBfdG8KICBmdW5jdGlvbiBfYXBwcm92ZWQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gbW9ic3RlckluZGV4VG9BcHByb3ZlZFtfdG9rZW5JZF0gPT0gX3RvOwogIH0KCgogIC8vLyBGb3IgY3JlYXRpbmcgbW9ic3RlcnMKICBmdW5jdGlvbiBfY3JlYXRlTW9ic3RlcihzdHJpbmcgX25hbWUsIGFkZHJlc3MgX293bmVyLCB1aW50MjU2IF9wcmljZSwgdWludDI1NiBfYm9zcykgcHJpdmF0ZSB7CgogICAgTW9ic3RlciBtZW1vcnkgX21vYnN0ZXIgPSBNb2JzdGVyKHsKICAgICAgbmFtZTogX25hbWUsCiAgICAgIGJvc3M6IF9ib3NzLAogICAgICBzdGF0ZTogMCwKICAgICAgZGF6ZWRFeGlwcnlUaW1lOiAwLAogICAgICBidXlQcmljZTogX3ByaWNlLAogICAgICBpZDogbW9ic3RlcnMubGVuZ3RoLTEKICAgIH0pOwogICAgdWludDI1NiBuZXdNb2JzdGVySWQgPSBtb2JzdGVycy5wdXNoKF9tb2JzdGVyKSAtIDE7CiAgICBtb2JzdGVyc1tuZXdNb2JzdGVySWRdLmlkPW5ld01vYnN0ZXJJZDsKCgogICAgaWYgKG5ld01vYnN0ZXJJZCAlIDYgPT0wIHx8IG5ld01vYnN0ZXJJZD09MSkKICAgIHsKICAgICAgICBnYW5nSGl0cy5sZW5ndGgrKzsKICAgIH0KCiAgICAvLyBJdCdzIHByb2JhYmx5IG5ldmVyIGdvaW5nIHRvIGhhcHBlbiwgNCBiaWxsaW9uIHRva2VucyBhcmUgQSBMT1QsIGJ1dAogICAgLy8gbGV0J3MganVzdCBiZSAxMDAlIHN1cmUgd2UgbmV2ZXIgbGV0IHRoaXMgaGFwcGVuLgogICAgcmVxdWlyZShuZXdNb2JzdGVySWQgPT0gdWludDI1Nih1aW50MzIobmV3TW9ic3RlcklkKSkpOwoKICAgIEJpcnRoKG5ld01vYnN0ZXJJZCwgX25hbWUsIF9vd25lcik7CgogICAgbW9ic3RlckluZGV4VG9QcmljZVtuZXdNb2JzdGVySWRdID0gX3ByaWNlOwoKICAgIC8vIFRoaXMgd2lsbCBhc3NpZ24gb3duZXJzaGlwLCBhbmQgYWxzbyBlbWl0IHRoZSBUcmFuc2ZlciBldmVudCBhcwogICAgLy8gcGVyIEVSQzcyMSBkcmFmdAogICAgX3RyYW5zZmVyKGFkZHJlc3MoMCksIF9vd25lciwgbmV3TW9ic3RlcklkKTsKICB9CgogIC8vLyBDaGVjayBmb3IgdG9rZW4gb3duZXJzaGlwCiAgZnVuY3Rpb24gX293bnMoYWRkcmVzcyBjbGFpbWFudCwgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBjbGFpbWFudCA9PSBtb2JzdGVySW5kZXhUb093bmVyW190b2tlbklkXTsKICB9CgogIC8vLyBGb3IgcGF5aW5nIG91dCBiYWxhbmNlIG9uIGNvbnRyYWN0CiAgZnVuY3Rpb24gX3BheW91dChhZGRyZXNzIF90bykgcHJpdmF0ZSB7CiAgICBpZiAoX3RvID09IGFkZHJlc3MoMCkpIHsKICAgICAgY2VvQWRkcmVzcy50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgfSBlbHNlIHsKICAgICAgX3RvLnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgICB9CiAgfQoKICAvLy8gQGRldiBBc3NpZ25zIG93bmVyc2hpcCBvZiBhIHNwZWNpZmljIG1vYnN0ZXIgdG8gYW4gYWRkcmVzcy4KICBmdW5jdGlvbiBfdHJhbnNmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgewogICAgLy8gU2luY2UgdGhlIG51bWJlciBvZiBtb2JzdGVycyBpcyBjYXBwZWQgdG8gMl4zMiB3ZSBjYW4ndCBvdmVyZmxvdyB0aGlzCiAgICBvd25lcnNoaXBUb2tlbkNvdW50W190b10rKzsKICAgIC8vdHJhbnNmZXIgb3duZXJzaGlwCiAgICBtb2JzdGVySW5kZXhUb093bmVyW190b2tlbklkXSA9IF90bzsKCiAgICAvLyBXaGVuIGNyZWF0aW5nIG5ldyBtb2JzdGVycyBfZnJvbSBpcyAweDAsIGJ1dCB3ZSBjYW4ndCBhY2NvdW50IHRoYXQgYWRkcmVzcy4KICAgIGlmIChfZnJvbSAhPSBhZGRyZXNzKDApKSB7CiAgICAgIG93bmVyc2hpcFRva2VuQ291bnRbX2Zyb21dLS07CiAgICAgIC8vIGNsZWFyIGFueSBwcmV2aW91c2x5IGFwcHJvdmVkIG93bmVyc2hpcCBleGNoYW5nZQogICAgICBkZWxldGUgbW9ic3RlckluZGV4VG9BcHByb3ZlZFtfdG9rZW5JZF07CiAgICB9CgogICAgLy8gRW1pdCB0aGUgdHJhbnNmZXIgZXZlbnQuCiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgfQoKICAgIC8vIHV0aWxpdHkgdG8gcm91bmQgdG8gdGhlIGdhbWUgcHJlY2lzaW9uCiAgICBmdW5jdGlvbiByb3VuZEl0KHVpbnQyNTYgYW1vdW50KSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KQogICAgewogICAgICAgIC8vIHJvdW5kIGRvd24gdG8gY29ycmVjdCBwcmVpY2lzaW9uCiAgICAgICAgdWludDI1NiByZXN1bHQgPSAoYW1vdW50L3ByZWNpc2lvbikqcHJlY2lzaW9uOwogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9Cgp9CgoKCmxpYnJhcnkgU2FmZU1hdGggewoKICAvKioKICAqIEBkZXYgTXVsdGlwbGllcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICovCiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IEludGVnZXIgZGl2aXNpb24gb2YgdHdvIG51bWJlcnMsIHRydW5jYXRpbmcgdGhlIHF1b3RpZW50LgogICovCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICAvKioKICAqIEBkZXYgU3Vic3RyYWN0cyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93IChpLmUuIGlmIHN1YnRyYWhlbmQgaXMgZ3JlYXRlciB0aGFuIG1pbnVlbmQpLgogICovCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgLyoqCiAgKiBAZGV2IEFkZHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9'.
	

]
