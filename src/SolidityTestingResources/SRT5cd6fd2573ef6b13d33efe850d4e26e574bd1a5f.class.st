Class {
	#name : #SRT5cd6fd2573ef6b13d33efe850d4e26e574bd1a5f,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT5cd6fd2573ef6b13d33efe850d4e26e574bd1a5f >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgICAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgICAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgYXNzZXJ0KGIgPD0gYSk7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSk7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9Cn0KCgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHkgPSA5MDAwMDAwMCAqIDEwICoqIDE4OwoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKCi8qKgogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKi8KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CgogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgYmFsYW5jZXM7CgogICAgLyoqCiAgICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICAgICAgLy8gU2FmZU1hdGguc3ViIHdpbGwgdGhyb3cgaWYgdGhlcmUgaXMgbm90IGVub3VnaCBiYWxhbmNlLgogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAgICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAgICovCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KCn0KCgovKioKICogQHRpdGxlIFN0YW5kYXJkIEVSQzIwIHRva2VuCiAqCiAqIEBkZXYgSW1wbGVtZW50YXRpb24gb2YgdGhlIGJhc2ljIHN0YW5kYXJkIHRva2VuLgogKiBAZGV2IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgRmlyc3RCbG9vZDogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sCiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CgoKICAgIC8qKgogICAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICB1aW50MjU2IF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKCiAgICAgICAgLy8gQ2hlY2sgaXMgbm90IG5lZWRlZCBiZWNhdXNlIHN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0CiAgICAgICAgLy8gcmVxdWlyZSAoX3ZhbHVlIDw9IF9hbGxvd2FuY2UpOwoKICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBfYWxsb3dhbmNlLnN1YihfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgICAqCiAgICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAgICovCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQoKICAgIC8qKgogICAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgICAqLwogICAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpCiAgICBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICAgICAgfQogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cgp9CgoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewoKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwoKICAgIC8qKgogICAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICAgKiBhY2NvdW50LgogICAgICovCiAgICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICAgKi8KICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgICAgICBvd25lciA9IG5ld093bmVyOwogICAgfQp9CgoKLyoKICogQ2hhcmdDb2luQ29udHJhY3QKICoKICogU2ltcGxlIEVSQzIwIFRva2VuIGV4YW1wbGUsIHdpdGggY3Jvd2RzYWxlIHRva2VuIGNyZWF0aW9uCiAqLwpjb250cmFjdCBDaGFyZ0NvaW5Db250cmFjdCBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKCiAgICBzdHJpbmcgcHVibGljIHN0YW5kYXJkID0gIkNIRyI7CiAgICBzdHJpbmcgcHVibGljIG5hbWUgPSAiQ2hhcmcgQ29pbiI7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbCA9ICJDSEciOwoKICAgIHVpbnQgcHVibGljIGRlY2ltYWxzID0gMTg7CgogICAgYWRkcmVzcyBwdWJsaWMgbXVsdGlzaWcgPSAweDQ4MkVGZDQ0N2JFODg3NDhlNzYyNWUyYjdjNTIyYzM4ODk3MEI3OTA7CgogICAgc3RydWN0IENoYXJnaW5nRGF0YSB7CiAgICBhZGRyZXNzIG5vZGU7CiAgICB1aW50IHN0YXJ0VGltZTsKICAgIHVpbnQgZW5kVGltZTsKICAgIHVpbnQyNTYgZml4ZWRSYXRlOwogICAgYm9vbCBpbml0aWFsaXplZDsKICAgIHVpbnQyNTYgcHJlZGVmaW5lZEFtb3VudDsKICAgIH0KCiAgICBzdHJ1Y3QgUGFya2luZ0RhdGEgewogICAgYWRkcmVzcyBub2RlOwogICAgdWludCBzdGFydFRpbWU7CiAgICB1aW50IGVuZFRpbWU7CiAgICB1aW50MjU2IGZpeGVkUmF0ZTsKICAgIGJvb2wgaW5pdGlhbGl6ZWQ7CiAgICB1aW50MjU2IHByZWRlZmluZWRBbW91bnQ7CiAgICB9CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgYXV0aG9yaXplZDsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyByYXRlT2ZDaGFyZ2luZzsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIHJhdGVPZlBhcmtpbmc7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBDaGFyZ2luZ0RhdGEpIHB1YmxpYyBjaGFyZ2luZ1N3aXRjaGVzOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBQYXJraW5nRGF0YSkgcHVibGljIHBhcmtpbmdTd2l0Y2hlczsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyByZXNlcnZlZEZ1bmRzQ2hhcmdpbmc7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyByZXNlcnZlZEZ1bmRzUGFya2luZzsKCiAgICAvLyAxIEVUSCA9IDUwMCBDSEFSRyB0b2tlbnMgKDEgQ0hBUkcgPSAwLjU5IFVTRCkKICAgIHVpbnQgUFJJQ0UgPSA1MDA7CgogICAgc3RydWN0IENvbnRyaWJ1dG9yRGF0YSB7CiAgICB1aW50IGNvbnRyaWJ1dGlvbkFtb3VudDsKICAgIHVpbnQgdG9rZW5zSXNzdWVkOwogICAgfQoKICAgIGZ1bmN0aW9uIENoYXJnQ29pbkNvbnRyYWN0KCkgcHVibGljIHsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHRvdGFsU3VwcGx5OwogICAgfQoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gQ29udHJpYnV0b3JEYXRhKSBwdWJsaWMgY29udHJpYnV0b3JMaXN0OwoKICAgIHVpbnQgbmV4dENvbnRyaWJ1dG9ySW5kZXg7CgogICAgbWFwcGluZyAodWludCA9PiBhZGRyZXNzKSBjb250cmlidXRvckluZGV4ZXM7CgogICAgc3RhdGUgcHVibGljIGNyb3dkc2FsZVN0YXRlID0gc3RhdGUucGVuZGluZ1N0YXJ0OwogICAgZW51bSBzdGF0ZSB7cGVuZGluZ1N0YXJ0LCBjcm93ZHNhbGUsIGNyb3dkc2FsZUVuZGVkfQoKICAgIGV2ZW50IENyb3dkc2FsZVN0YXJ0ZWQodWludCBibG9ja051bWJlcik7CgogICAgZXZlbnQgQ3Jvd2RzYWxlRW5kZWQodWludCBibG9ja051bWJlcik7CgogICAgZXZlbnQgRXJyb3JTZW5kaW5nRVRIKGFkZHJlc3MgdG8sIHVpbnQgYW1vdW50KTsKCiAgICBldmVudCBNaW5DYXBSZWFjaGVkKHVpbnQgYmxvY2tOdW1iZXIpOwoKICAgIGV2ZW50IE1heENhcFJlYWNoZWQodWludCBibG9ja051bWJlcik7CgogICAgdWludCBwdWJsaWMgY29uc3RhbnQgQkVHSU5fVElNRSA9IDE1MTM4OTY5ODI7CgogICAgdWludCBwdWJsaWMgY29uc3RhbnQgRU5EX1RJTUUgPSAxNTQ1NDMyOTgxOwoKICAgIHVpbnQgcHVibGljIG1pbkNhcCA9IDEgZXRoZXI7CgogICAgdWludCBwdWJsaWMgbWF4Q2FwID0gNzAyMDAgZXRoZXI7CgogICAgdWludCBwdWJsaWMgZXRoUmFpc2VkID0gMDsKCiAgICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseSA9IDkwMDAwMDAwICogMTAgKiogZGVjaW1hbHM7CgogICAgdWludCBjcm93ZHNhbGVUb2tlbkNhcCA9IDEwMDAwMDAwICogMTAgKiogZGVjaW1hbHM7IC8vIDM5JQogICAgdWludCBmb3VuZGVyc0FuZFRlYW1Ub2tlbnMgPSA5MDAwMDAwICogMTAgKiogZGVjaW1hbHM7IC8vIDEwJQogICAgdWludCBzbHVzaEZ1bmRUb2tlbnMgPSA0NTkwMDAwMCAqIDEwICoqIGRlY2ltYWxzOyAvLyA1MSUKCiAgICBib29sIGZvdW5kZXJzQW5kVGVhbVRva2Vuc0NsYWltZWQgPSBmYWxzZTsKICAgIGJvb2wgc2x1c2hGdW5kVG9rZW5zQ2xhaW1lZCA9IGZhbHNlOwoKICAgIHVpbnQgbmV4dENvbnRyaWJ1dG9yVG9DbGFpbTsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIGhhc0NsYWltZWRFdGhXaGVuRmFpbDsKCiAgICBmdW5jdGlvbigpIHBheWFibGUgcHVibGljIHsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSAhPSAwKTsKICAgICAgICByZXF1aXJlKGNyb3dkc2FsZVN0YXRlICE9IHN0YXRlLmNyb3dkc2FsZUVuZGVkKTsKICAgICAgICAvLyBDaGVjayBpZiBjcm93ZHNhbGUgaGFzIGVuZGVkCgogICAgICAgIGJvb2wgc3RhdGVDaGFuZ2VkID0gY2hlY2tDcm93ZHNhbGVTdGF0ZSgpOwogICAgICAgIC8vIENoZWNrIGJsb2NrcyBhbmQgY2FsaWJyYXRlIGNyb3dkc2FsZSBzdGF0ZQoKICAgICAgICBpZiAoY3Jvd2RzYWxlU3RhdGUgPT0gc3RhdGUuY3Jvd2RzYWxlKSB7CiAgICAgICAgICAgIGNyZWF0ZVRva2Vucyhtc2cuc2VuZGVyKTsKICAgICAgICAgICAgLy8gUHJvY2VzcyB0cmFuc2FjdGlvbiBhbmQgaXNzdWUgdG9rZW5zCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICByZWZ1bmRUcmFuc2FjdGlvbihzdGF0ZUNoYW5nZWQpOwogICAgICAgICAgICAvLyBTZXQgc3RhdGUgYW5kIHJldHVybiBmdW5kcyBvciB0aHJvdwogICAgICAgIH0KICAgIH0KCiAgICAvLwogICAgLy8gQ2hlY2sgY3Jvd2RzYWxlIHN0YXRlIGFuZCBjYWxpYnJhdGUgaXQKICAgIC8vCiAgICBmdW5jdGlvbiBjaGVja0Nyb3dkc2FsZVN0YXRlKCkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmIChldGhSYWlzZWQgPj0gbWF4Q2FwICYmIGNyb3dkc2FsZVN0YXRlICE9IHN0YXRlLmNyb3dkc2FsZUVuZGVkKSB7Ly8gQ2hlY2sgaWYgbWF4IGNhcCBpcyByZWFjaGVkCiAgICAgICAgICAgIGNyb3dkc2FsZVN0YXRlID0gc3RhdGUuY3Jvd2RzYWxlRW5kZWQ7CiAgICAgICAgICAgIENyb3dkc2FsZUVuZGVkKGJsb2NrLm51bWJlcik7CiAgICAgICAgICAgIC8vIFJhaXNlIGV2ZW50CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKG5vdyA+PSBFTkRfVElNRSkgewogICAgICAgICAgICBjcm93ZHNhbGVTdGF0ZSA9IHN0YXRlLmNyb3dkc2FsZUVuZGVkOwogICAgICAgICAgICBDcm93ZHNhbGVFbmRlZChibG9jay5udW1iZXIpOwogICAgICAgICAgICAvLyBSYWlzZSBldmVudAogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIGlmIChub3cgPj0gQkVHSU5fVElNRSAmJiBub3cgPCBFTkRfVElNRSkgey8vIENoZWNrIGlmIHdlIGFyZSBpbiBjcm93ZHNhbGUgc3RhdGUKICAgICAgICAgICAgaWYgKGNyb3dkc2FsZVN0YXRlICE9IHN0YXRlLmNyb3dkc2FsZSkgey8vIENoZWNrIGlmIHN0YXRlIG5lZWRzIHRvIGJlIGNoYW5nZWQKICAgICAgICAgICAgICAgIGNyb3dkc2FsZVN0YXRlID0gc3RhdGUuY3Jvd2RzYWxlOwogICAgICAgICAgICAgICAgLy8gU2V0IG5ldyBzdGF0ZQogICAgICAgICAgICAgICAgQ3Jvd2RzYWxlU3RhcnRlZChibG9jay5udW1iZXIpOwogICAgICAgICAgICAgICAgLy8gUmFpc2UgZXZlbnQKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLy8KICAgIC8vIERlY2lkZSBpZiB0aHJvdyBvciBvbmx5IHJldHVybiBldGhlcgogICAgLy8KICAgIGZ1bmN0aW9uIHJlZnVuZFRyYW5zYWN0aW9uKGJvb2wgX3N0YXRlQ2hhbmdlZCkgaW50ZXJuYWwgewogICAgICAgIGlmIChfc3RhdGVDaGFuZ2VkKSB7CiAgICAgICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBjcmVhdGVUb2tlbnMoYWRkcmVzcyBfY29udHJpYnV0b3IpIHBheWFibGUgcHVibGljIHsKCiAgICAgICAgdWludCBfYW1vdW50ID0gbXNnLnZhbHVlOwoKICAgICAgICB1aW50IGNvbnRyaWJ1dGlvbkFtb3VudCA9IF9hbW91bnQ7CiAgICAgICAgdWludCByZXR1cm5BbW91bnQgPSAwOwoKICAgICAgICBpZiAoX2Ftb3VudCA+IChtYXhDYXAgLSBldGhSYWlzZWQpKSB7Ly8gQ2hlY2sgaWYgbWF4IGNvbnRyaWJ1dGlvbiBpcyBsb3dlciB0aGFuIF9hbW91bnQgc2VudAogICAgICAgICAgICBjb250cmlidXRpb25BbW91bnQgPSBtYXhDYXAgLSBldGhSYWlzZWQ7CiAgICAgICAgICAgIC8vIFNldCB0aGF0IHVzZXIgY29udGlidXRlcyBoaXMgbWF4aW11bSBhbG93ZWQgY29udHJpYnV0aW9uCiAgICAgICAgICAgIHJldHVybkFtb3VudCA9IF9hbW91bnQgLSBjb250cmlidXRpb25BbW91bnQ7CiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBob3cgbXVjaCBoZSBtdXN0IGdldCBiYWNrCiAgICAgICAgfQoKICAgICAgICBpZiAoZXRoUmFpc2VkICsgY29udHJpYnV0aW9uQW1vdW50ID4gbWluQ2FwICYmIG1pbkNhcCA+IGV0aFJhaXNlZCkgewogICAgICAgICAgICBNaW5DYXBSZWFjaGVkKGJsb2NrLm51bWJlcik7CiAgICAgICAgfQoKICAgICAgICBpZiAoZXRoUmFpc2VkICsgY29udHJpYnV0aW9uQW1vdW50ID09IG1heENhcCAmJiBldGhSYWlzZWQgPCBtYXhDYXApIHsKICAgICAgICAgICAgTWF4Q2FwUmVhY2hlZChibG9jay5udW1iZXIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGNvbnRyaWJ1dG9yTGlzdFtfY29udHJpYnV0b3JdLmNvbnRyaWJ1dGlvbkFtb3VudCA9PSAwKSB7CiAgICAgICAgICAgIGNvbnRyaWJ1dG9ySW5kZXhlc1tuZXh0Q29udHJpYnV0b3JJbmRleF0gPSBfY29udHJpYnV0b3I7CiAgICAgICAgICAgIG5leHRDb250cmlidXRvckluZGV4ICs9IDE7CiAgICAgICAgfQoKICAgICAgICBjb250cmlidXRvckxpc3RbX2NvbnRyaWJ1dG9yXS5jb250cmlidXRpb25BbW91bnQgKz0gY29udHJpYnV0aW9uQW1vdW50OwogICAgICAgIGV0aFJhaXNlZCArPSBjb250cmlidXRpb25BbW91bnQ7CiAgICAgICAgLy8gQWRkIHRvIGV0aCByYWlzZWQKCiAgICAgICAgdWludDI1NiB0b2tlbkFtb3VudCA9IGNhbGN1bGF0ZUV0aFRvQ2hhcmdjb2luKGNvbnRyaWJ1dGlvbkFtb3VudCk7CiAgICAgICAgLy8gQ2FsY3VsYXRlIGhvdyBtdWNoIHRva2VucyBtdXN0IGNvbnRyaWJ1dG9yIGdldAogICAgICAgIGlmICh0b2tlbkFtb3VudCA+IDApIHsKICAgICAgICAgICAgdHJhbnNmZXJUb0NvbnRyaWJ1dG9yKF9jb250cmlidXRvciwgdG9rZW5BbW91bnQpOwogICAgICAgICAgICBjb250cmlidXRvckxpc3RbX2NvbnRyaWJ1dG9yXS50b2tlbnNJc3N1ZWQgKz0gdG9rZW5BbW91bnQ7CiAgICAgICAgICAgIC8vIGxvZyB0b2tlbiBpc3N1YW5jZQogICAgICAgIH0KCiAgICAgICAgaWYgKCFtdWx0aXNpZy5zZW5kKG1zZy52YWx1ZSkpIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQogICAgfQoKCiAgICBmdW5jdGlvbiB0cmFuc2ZlclRvQ29udHJpYnV0b3IoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSAgcHVibGljIHsKICAgICAgICBiYWxhbmNlc1tvd25lcl0gPSBiYWxhbmNlc1tvd25lcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gY2FsY3VsYXRlRXRoVG9DaGFyZ2NvaW4odWludCBfZXRoKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDI1NikgewoKICAgICAgICB1aW50IHRva2VucyA9IF9ldGgubXVsKGdldFByaWNlKCkpOwogICAgICAgIHVpbnQgcGVyY2VudGFnZSA9IDA7CgogICAgICAgIGlmIChldGhSYWlzZWQgPiAwKSB7CiAgICAgICAgICAgIHBlcmNlbnRhZ2UgPSBldGhSYWlzZWQgKiAxMDAgLyBtYXhDYXA7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdG9rZW5zICsgZ2V0QW1vdW50Qm9udXModG9rZW5zKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRBbW91bnRCb251cyh1aW50IHRva2VucykgcHVyZSBwdWJsaWMgcmV0dXJucyAodWludCkgewogICAgICAgIHVpbnQgYW1vdW50Qm9udXMgPSAwOwoKICAgICAgICBpZiAodG9rZW5zID49IDEwMDAwKSBhbW91bnRCb251cyA9IHRva2VuczsKICAgICAgICBlbHNlIGlmICh0b2tlbnMgPj0gNTAwMCkgYW1vdW50Qm9udXMgPSB0b2tlbnMgKiA2MCAvIDEwMDsKICAgICAgICBlbHNlIGlmICh0b2tlbnMgPj0gMTAwMCkgYW1vdW50Qm9udXMgPSB0b2tlbnMgKiAzMCAvIDEwMDsKICAgICAgICBlbHNlIGlmICh0b2tlbnMgPj0gNTAwKSBhbW91bnRCb251cyA9IHRva2VucyAqIDEwIC8gMTAwOwogICAgICAgIGVsc2UgaWYgKHRva2VucyA+PSAxMDApIGFtb3VudEJvbnVzID0gdG9rZW5zICogNSAvIDEwMDsKICAgICAgICBlbHNlIGlmICh0b2tlbnMgPj0gMTApIGFtb3VudEJvbnVzID0gdG9rZW5zICogMSAvIDEwMDsKCiAgICAgICAgcmV0dXJuIGFtb3VudEJvbnVzOwogICAgfQoKICAgIC8vIHJlcGxhY2UgdGhpcyB3aXRoIGFueSBvdGhlciBwcmljZSBmdW5jdGlvbgogICAgZnVuY3Rpb24gZ2V0UHJpY2UoKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludCByZXN1bHQpIHsKICAgICAgICByZXR1cm4gUFJJQ0U7CiAgICB9CgogICAgLy8KICAgIC8vIE93bmVyIGNhbiBiYXRjaCByZXR1cm4gY29udHJpYnV0b3JzIGNvbnRyaWJ1dGlvbnMoZXRoKQogICAgLy8KICAgIGZ1bmN0aW9uIGJhdGNoUmV0dXJuRXRoSWZGYWlsZWQodWludCBfbnVtYmVyT2ZSZXR1cm5zKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKGNyb3dkc2FsZVN0YXRlICE9IHN0YXRlLmNyb3dkc2FsZUVuZGVkKTsKICAgICAgICAvLyBDaGVjayBpZiBjcm93ZHNhbGUgaGFzIGVuZGVkCiAgICAgICAgcmVxdWlyZShldGhSYWlzZWQgPCBtaW5DYXApOwogICAgICAgIC8vIENoZWNrIGlmIGNyb3dkc2FsZSBoYXMgZmFpbGVkCiAgICAgICAgYWRkcmVzcyBjdXJyZW50UGFydGljaXBhbnRBZGRyZXNzOwogICAgICAgIHVpbnQgY29udHJpYnV0aW9uOwogICAgICAgIGZvciAodWludCBjbnQgPSAwOyBjbnQgPCBfbnVtYmVyT2ZSZXR1cm5zOyBjbnQrKykgewogICAgICAgICAgICBjdXJyZW50UGFydGljaXBhbnRBZGRyZXNzID0gY29udHJpYnV0b3JJbmRleGVzW25leHRDb250cmlidXRvclRvQ2xhaW1dOwogICAgICAgICAgICAvLyBHZXQgbmV4dCB1bmNsYWltZWQgcGFydGljaXBhbnQKICAgICAgICAgICAgaWYgKGN1cnJlbnRQYXJ0aWNpcGFudEFkZHJlc3MgPT0gMHgwKSByZXR1cm47CiAgICAgICAgICAgIC8vIENoZWNrIGlmIGFsbCB0aGUgcGFydGljaXBhbnRzIHdlcmUgY29tcGVuc2F0ZWQKICAgICAgICAgICAgaWYgKCFoYXNDbGFpbWVkRXRoV2hlbkZhaWxbY3VycmVudFBhcnRpY2lwYW50QWRkcmVzc10pIHsvLyBDaGVjayBpZiBwYXJ0aWNpcGFudCBoYXMgYWxyZWFkeSBjbGFpbWVkCiAgICAgICAgICAgICAgICBjb250cmlidXRpb24gPSBjb250cmlidXRvckxpc3RbY3VycmVudFBhcnRpY2lwYW50QWRkcmVzc10uY29udHJpYnV0aW9uQW1vdW50OwogICAgICAgICAgICAgICAgLy8gR2V0IGNvbnRyaWJ1dGlvbiBvZiBwYXJ0aWNpcGFudAogICAgICAgICAgICAgICAgaGFzQ2xhaW1lZEV0aFdoZW5GYWlsW2N1cnJlbnRQYXJ0aWNpcGFudEFkZHJlc3NdID0gdHJ1ZTsKICAgICAgICAgICAgICAgIC8vIFNldCB0aGF0IGhlIGhhcyBjbGFpbWVkCiAgICAgICAgICAgICAgICBiYWxhbmNlc1tjdXJyZW50UGFydGljaXBhbnRBZGRyZXNzXSA9IDA7CiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRQYXJ0aWNpcGFudEFkZHJlc3Muc2VuZChjb250cmlidXRpb24pKSB7Ly8gUmVmdW5kIGV0aAogICAgICAgICAgICAgICAgICAgIEVycm9yU2VuZGluZ0VUSChjdXJyZW50UGFydGljaXBhbnRBZGRyZXNzLCBjb250cmlidXRpb24pOwogICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZXJlIGlzIGFuIGlzc3VlIHJhaXNlIGV2ZW50IGZvciBtYW51YWwgcmVjb3ZlcnkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBuZXh0Q29udHJpYnV0b3JUb0NsYWltICs9IDE7CiAgICAgICAgICAgIC8vIFJlcGVhdAogICAgICAgIH0KICAgIH0KCiAgICAvLwogICAgLy8gT3duZXIgY2FuIHNldCBtdWx0aXNpZyBhZGRyZXNzIGZvciBjcm93ZHNhbGUKICAgIC8vCiAgICBmdW5jdGlvbiBzZXRNdWx0aXNpZ0FkZHJlc3MoYWRkcmVzcyBfbmV3QWRkcmVzcykgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgbXVsdGlzaWcgPSBfbmV3QWRkcmVzczsKICAgIH0KCiAgICAvLwogICAgLy8gUmVnaXN0ZXJzIG5vZGUgd2l0aCByYXRlCiAgICAvLwogICAgZnVuY3Rpb24gcmVnaXN0ZXJOb2RlKHVpbnQyNTYgY2hhcmdpbmdSYXRlLCB1aW50MjU2IHBhcmtpbmdSYXRlKSBwdWJsaWMgewogICAgICAgIGlmIChhdXRob3JpemVkW21zZy5zZW5kZXJdID09IDEpIHJldmVydCgpOwoKICAgICAgICByYXRlT2ZDaGFyZ2luZ1ttc2cuc2VuZGVyXSA9IGNoYXJnaW5nUmF0ZTsKICAgICAgICByYXRlT2ZQYXJraW5nW21zZy5zZW5kZXJdID0gcGFya2luZ1JhdGU7CiAgICAgICAgYXV0aG9yaXplZFttc2cuc2VuZGVyXSA9IDE7CiAgICB9CgogICAgLy8gCiAgICAvLyBCbG9jayBub2RlCiAgICAvLwogICAgZnVuY3Rpb24gYmxvY2tOb2RlIChhZGRyZXNzIG5vZGUpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGF1dGhvcml6ZWRbbm9kZV0gPSAwOwogICAgfQoKICAgIC8vCiAgICAvLyBVcGRhdGVzIG5vZGUgY2hhcmdpbmcgcmF0ZQogICAgLy8gCiAgICBmdW5jdGlvbiB1cGRhdGVDaGFyZ2luZ1JhdGUgKHVpbnQyNTYgcmF0ZSkgcHVibGljIHsKICAgICAgICByYXRlT2ZDaGFyZ2luZ1ttc2cuc2VuZGVyXSA9IHJhdGU7CiAgICB9CgogICAgLy8KICAgIC8vIFVwZGF0ZXMgbm9kZSBwYXJraW5nIHJhdGUKICAgIC8vIAogICAgZnVuY3Rpb24gdXBkYXRlUGFya2luZ1JhdGUgKHVpbnQyNTYgcmF0ZSkgcHVibGljIHsKICAgICAgICByYXRlT2ZDaGFyZ2luZ1ttc2cuc2VuZGVyXSA9IHJhdGU7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhcmdlT24gKGFkZHJlc3Mgbm9kZSwgdWludCB0aW1lKSBwdWJsaWMgewogICAgICAgIC8vIFByZXZlbnQgZnJvbSBub3QgYXV0aG9yaXplZCBub2RlcwogICAgICAgIGlmIChhdXRob3JpemVkW25vZGVdID09IDApIHJldmVydCgpOwogICAgICAgIC8vIFByZXZlbnQgZnJvbSBkb3VibGUgY2hhcmdpbmcKICAgICAgICBpZiAoY2hhcmdpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5pbml0aWFsaXplZCkgcmV2ZXJ0KCk7CgogICAgICAgIC8vIERldGVybWluZSBlbmRUaW1lCiAgICAgICAgdWludCBlbmRUaW1lID0gbm93ICsgdGltZTsKCiAgICAgICAgLy8gUHJldmVudCBmcm9tIHBhc3QgZGF0ZXMKICAgICAgICBpZiAoZW5kVGltZSA8PSBub3cpIHJldmVydCgpOwoKICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIGFtb3VudCBvZiB0b2tlbnMgaGFzIHRvIGJlIHRha2VuIGZyb20gdXNlcnMgYWNjb3VudAogICAgICAgIHVpbnQyNTYgcHJlZGVmaW5lZEFtb3VudCA9IChlbmRUaW1lIC0gbm93KSAqIHJhdGVPZkNoYXJnaW5nW25vZGVdOwoKICAgICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPCBwcmVkZWZpbmVkQW1vdW50KSByZXZlcnQoKTsKCiAgICAgICAgY2hhcmdpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXSA9IENoYXJnaW5nRGF0YShub2RlLCBub3csIGVuZFRpbWUsIHJhdGVPZkNoYXJnaW5nW25vZGVdLCB0cnVlLCBwcmVkZWZpbmVkQW1vdW50KTsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihwcmVkZWZpbmVkQW1vdW50KTsKICAgICAgICByZXNlcnZlZEZ1bmRzQ2hhcmdpbmdbbXNnLnNlbmRlcl0gPSByZXNlcnZlZEZ1bmRzQ2hhcmdpbmdbbXNnLnNlbmRlcl0uYWRkKHByZWRlZmluZWRBbW91bnQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYXJnZU9mZiAoYWRkcmVzcyBub2RlKSBwdWJsaWMgewogICAgICAgIC8vIENoZWNrIHRoYXQgaW5pdGlhbGl6YXRpb24gaGFwcGVuZWQKICAgICAgICBpZiAoIWNoYXJnaW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0uaW5pdGlhbGl6ZWQpIHJldmVydCgpOwogICAgICAgIC8vIENhbGN1bGF0ZSB0aGUgYW1vdW50IGRlcGVuZGluZyBvbiByYXRlCiAgICAgICAgdWludDI1NiBhbW91bnQgPSAobm93IC0gY2hhcmdpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5zdGFydFRpbWUpICogY2hhcmdpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5maXhlZFJhdGU7CiAgICAgICAgLy8gTWF4aW11bSBjYW4gYmUgcHJlZGVmaW5lZEFtb3VudCwgaWYgaXQgbGVzcyB0aGFuIHRoYXQsIHJldHVybiB0b2tlbnMKICAgICAgICBhbW91bnQgPSBhbW91bnQgPiBjaGFyZ2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLnByZWRlZmluZWRBbW91bnQgPyBjaGFyZ2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLnByZWRlZmluZWRBbW91bnQgOiBhbW91bnQ7CgogICAgICAgIC8vIFRha2UgdG9rZW5zIGZyb20gcmVzZXJGdW5kcyBhbmQgcHV0IGl0IG9uIGJhbGFuY2UKICAgICAgICBiYWxhbmNlc1tub2RlXSA9IGJhbGFuY2VzW25vZGVdICsgYW1vdW50OwogICAgICAgIHJlc2VydmVkRnVuZHNDaGFyZ2luZ1ttc2cuc2VuZGVyXSA9IHJlc2VydmVkRnVuZHNDaGFyZ2luZ1ttc2cuc2VuZGVyXSAtIGFtb3VudDsKCiAgICAgICAgLy8gV2hlbiBhbW91bnQgaXMgbGVzcyB0aGFuIHByZWRlZmluZWRBbW91bnQsIHJldHVybiBvdGhlciB0b2tlbnMgdG8gdXNlcgogICAgICAgIGlmIChyZXNlcnZlZEZ1bmRzQ2hhcmdpbmdbbXNnLnNlbmRlcl0gPiAwKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0gKyByZXNlcnZlZEZ1bmRzQ2hhcmdpbmdbbXNnLnNlbmRlcl07CiAgICAgICAgICAgIHJlc2VydmVkRnVuZHNDaGFyZ2luZ1ttc2cuc2VuZGVyXSA9IDA7CiAgICAgICAgfQoKICAgICAgICAvLyBVbmluaXRpYWxpemUKICAgICAgICBjaGFyZ2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLm5vZGUgPSAwOwogICAgICAgIGNoYXJnaW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0uc3RhcnRUaW1lID0gMDsKICAgICAgICBjaGFyZ2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLmVuZFRpbWUgPSAwOwogICAgICAgIGNoYXJnaW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0uZml4ZWRSYXRlID0gMDsKICAgICAgICBjaGFyZ2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLmluaXRpYWxpemVkID0gZmFsc2U7CiAgICAgICAgY2hhcmdpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5wcmVkZWZpbmVkQW1vdW50ID0gMDsKICAgIH0KCiAgICBmdW5jdGlvbiBwYXJraW5nT24gKGFkZHJlc3Mgbm9kZSwgdWludCB0aW1lKSBwdWJsaWMgewogICAgICAgIC8vIFByZXZlbnQgZnJvbSBub3QgYXV0aG9yaXplZCBub2RlcwogICAgICAgIGlmIChhdXRob3JpemVkW25vZGVdID09IDApIHJldmVydCgpOwogICAgICAgIC8vIFByZXZlbnQgZnJvbSBkb3VibGUgY2hhcmdpbmcKICAgICAgICBpZiAocGFya2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLmluaXRpYWxpemVkKSByZXZlcnQoKTsKCiAgICAgICAgaWYgKGJhbGFuY2VzW21zZy5zZW5kZXJdIDwgcHJlZGVmaW5lZEFtb3VudCkgcmV2ZXJ0KCk7CgogICAgICAgIHVpbnQgZW5kVGltZSA9IG5vdyArIHRpbWU7CgogICAgICAgIC8vIFByZXZlbnQgZnJvbSBwYXN0IGRhdGVzCiAgICAgICAgaWYgKGVuZFRpbWUgPD0gbm93KSByZXZlcnQoKTsKCiAgICAgICAgdWludDI1NiBwcmVkZWZpbmVkQW1vdW50ID0gKGVuZFRpbWUgLSBub3cpICogcmF0ZU9mUGFya2luZ1tub2RlXTsKCiAgICAgICAgcGFya2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdID0gUGFya2luZ0RhdGEobm9kZSwgbm93LCBlbmRUaW1lLCByYXRlT2ZQYXJraW5nW25vZGVdLCB0cnVlLCBwcmVkZWZpbmVkQW1vdW50KTsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihwcmVkZWZpbmVkQW1vdW50KTsKICAgICAgICByZXNlcnZlZEZ1bmRzUGFya2luZ1ttc2cuc2VuZGVyXSA9IHJlc2VydmVkRnVuZHNQYXJraW5nW21zZy5zZW5kZXJdLmFkZChwcmVkZWZpbmVkQW1vdW50KTsKICAgIH0KCiAgICAvLyBQYXJraW5nIG9mZiAgICAgCiAgICBmdW5jdGlvbiBwYXJraW5nT2ZmIChhZGRyZXNzIG5vZGUpIHB1YmxpYyB7CiAgICAgICAgaWYgKCFwYXJraW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0uaW5pdGlhbGl6ZWQpIHJldmVydCgpOwoKICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIGFtb3VudCBkZXBlbmRpbmcgb24gcmF0ZQogICAgICAgIHVpbnQyNTYgYW1vdW50ID0gKG5vdyAtIHBhcmtpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5zdGFydFRpbWUpICogcGFya2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLmZpeGVkUmF0ZTsKICAgICAgICAvLyBNYXhpbXVtIGNhbiBiZSBwcmVkZWZpbmVkQW1vdW50LCBpZiBpdCBsZXNzIHRoYW4gdGhhdCwgcmV0dXJuIHRva2VucwogICAgICAgIGFtb3VudCA9IGFtb3VudCA+IHBhcmtpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5wcmVkZWZpbmVkQW1vdW50ID8gcGFya2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLnByZWRlZmluZWRBbW91bnQgOiBhbW91bnQ7CgogICAgICAgIGJhbGFuY2VzW25vZGVdID0gYmFsYW5jZXNbbm9kZV0gKyBhbW91bnQ7CiAgICAgICAgcmVzZXJ2ZWRGdW5kc1BhcmtpbmdbbXNnLnNlbmRlcl0gPSByZXNlcnZlZEZ1bmRzUGFya2luZ1ttc2cuc2VuZGVyXSAtIGFtb3VudDsKCiAgICAgICAgLy8gIAogICAgICAgIGlmIChyZXNlcnZlZEZ1bmRzUGFya2luZ1ttc2cuc2VuZGVyXSA+IDApIHsKICAgICAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXSArIHJlc2VydmVkRnVuZHNQYXJraW5nW21zZy5zZW5kZXJdOwogICAgICAgICAgICAvLyBhbGwgdG9rZW5zIHRha2VuLCBzZXQgdG8gMAogICAgICAgICAgICByZXNlcnZlZEZ1bmRzUGFya2luZ1ttc2cuc2VuZGVyXSA9IDA7CiAgICAgICAgfQoKICAgICAgICAvLyBVbmluaXRpYWxpemUKICAgICAgICBwYXJraW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0ubm9kZSA9IDA7CiAgICAgICAgcGFya2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLnN0YXJ0VGltZSA9IDA7CiAgICAgICAgcGFya2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLmVuZFRpbWUgPSAwOwogICAgICAgIHBhcmtpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5maXhlZFJhdGUgPSAwOwogICAgICAgIHBhcmtpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5pbml0aWFsaXplZCA9IGZhbHNlOwogICAgICAgIHBhcmtpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5wcmVkZWZpbmVkQW1vdW50ID0gMDsKICAgIH0KfQoKY29udHJhY3QgQ2hnVXNkQ29udmVydGVyIGlzIE93bmFibGV7CiAgICBhZGRyZXNzIHB1YmxpYyBjb250cmFjdEFkZHJlc3MgPSAweEM0QTg2NTYxY2IwYjdFQTEyMTQ5MDRmMjZFNkQ1MEZEMzU3Qzc5ODY7CiAgICBhZGRyZXNzIHB1YmxpYyBkYXNoYm9hcmRBZGRyZXNzID0gMHg0ODJFRmQ0NDdiRTg4NzQ4ZTc2MjVlMmI3YzUyMmMzODg5NzBCNzkwOwogICAgdWludCBwdWJsaWMgRVRIVVNEUFJJQ0UgPSA4MTA7CiAgICB1aW50IHB1YmxpYyBDSEdVU0RQUklDRSA9IDQ7IC8vICQwLjQKCiAgICBmdW5jdGlvbiBzZXRFVEhVU0RQcmljZSh1aW50IG5ld1ByaWNlKSBwdWJsaWMgewogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IGRhc2hib2FyZEFkZHJlc3MpIHJldmVydCgpOwogICAgICAgIAogICAgICAgIEVUSFVTRFBSSUNFID0gbmV3UHJpY2U7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0Q0hHVVNEUHJpY2UodWludCBuZXdQcmljZSkgcHVibGljIHsKICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBkYXNoYm9hcmRBZGRyZXNzKSByZXZlcnQoKTsKCiAgICAgICAgQ0hHVVNEUFJJQ0UgPSBuZXdQcmljZTsKICAgIH0KCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVDSEdBbW91bnRUb0V0aGVyKHVpbnQgZXRoZXJBbW91bnQpIHZpZXcgcHVibGljIHJldHVybnMgKHVpbnQpewogICAgICAgIHJldHVybiAoKGV0aGVyQW1vdW50ICogRVRIVVNEUFJJQ0UpIC8gQ0hHVVNEUFJJQ0UpICogMTA7CiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZXMoYWRkcmVzcyBhKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgQ2hhcmdDb2luQ29udHJhY3QgYyA9IENoYXJnQ29pbkNvbnRyYWN0KGNvbnRyYWN0QWRkcmVzcyk7CiAgICAgICAgcmV0dXJuIGMuYmFsYW5jZXMoYSk7CiAgICB9CgogICAgZnVuY3Rpb24gY3VycmVudEJhbGFuY2UoKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgQ2hhcmdDb2luQ29udHJhY3QgYyA9IENoYXJnQ29pbkNvbnRyYWN0KGNvbnRyYWN0QWRkcmVzcyk7CiAgICAgICAgcmV0dXJuIGMuYmFsYW5jZXMoYWRkcmVzcyh0aGlzKSk7CiAgICB9CgogICAgZnVuY3Rpb24oKSBwYXlhYmxlIHB1YmxpYyB7CiAgICAgICAgdWludCBjYWxjdWxhdGVkQW1vdW50ID0gY2FsY3VsYXRlQ0hHQW1vdW50VG9FdGhlcihtc2cudmFsdWUpOwoKICAgICAgICBDaGFyZ0NvaW5Db250cmFjdCBjID0gQ2hhcmdDb2luQ29udHJhY3QoY29udHJhY3RBZGRyZXNzKTsKCiAgICAgICAgaWYgKGN1cnJlbnRCYWxhbmNlKCkgPCBjYWxjdWxhdGVkQW1vdW50KSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFjLnRyYW5zZmVyKG1zZy5zZW5kZXIsIGNhbGN1bGF0ZWRBbW91bnQpKSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KCiAgICB9Cn0='.
	

]
