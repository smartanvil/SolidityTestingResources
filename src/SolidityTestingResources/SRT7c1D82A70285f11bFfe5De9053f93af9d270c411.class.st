Class {
	#name : #SRT7c1D82A70285f11bFfe5De9053f93af9d270c411,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT7c1D82A70285f11bFfe5De9053f93af9d270c411 >> base64 [
	^ 'Ly8vIGF1dGguc29sIC0tIHdpZGVseS11c2VkIGFjY2VzcyBjb250cm9sIHBhdHRlcm4gZm9yIEV0aGVyZXVtCgovLyBDb3B5cmlnaHQgKEMpIDIwMTUsIDIwMTYsIDIwMTcgIERhcHBIdWIsIExMQwoKLy8gTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIikuCi8vIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKLy8gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQgKGV4cHJlc3Mgb3IgaW1wbGllZCkuCgpwcmFnbWEgc29saWRpdHkgXjAuNC4xMzsKCmNvbnRyYWN0IEF1dGhvcml0eSB7CiAgICBmdW5jdGlvbiBjYW5DYWxsKGFkZHJlc3Mgc3JjLCBhZGRyZXNzIGRzdCwgYnl0ZXM0IHNpZykgY29uc3RhbnQgcmV0dXJucyAoYm9vbCk7Cn0KCmNvbnRyYWN0IEF1dGhFdmVudHMgewogICAgZXZlbnQgTG9nU2V0QXV0aG9yaXR5IChhZGRyZXNzIGluZGV4ZWQgYXV0aG9yaXR5KTsKICAgIGV2ZW50IExvZ1NldE93bmVyICAgICAoYWRkcmVzcyBpbmRleGVkIG93bmVyKTsKICAgIGV2ZW50IFVuYXV0aG9yaXplZEFjY2VzcyAoYWRkcmVzcyBjYWxsZXIsIGJ5dGVzNCBzaWcpOwp9Cgpjb250cmFjdCBBdXRoIGlzIEF1dGhFdmVudHMgewogICAgQXV0aG9yaXR5ICBwdWJsaWMgIGF1dGhvcml0eTsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwoKICAgIGZ1bmN0aW9uIEF1dGgoKSB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIExvZ1NldE93bmVyKG1zZy5zZW5kZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldE93bmVyKGFkZHJlc3Mgb3duZXJfKSBhdXRoIHsKICAgICAgICBvd25lciA9IG93bmVyXzsKICAgICAgICBMb2dTZXRPd25lcihvd25lcik7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0QXV0aG9yaXR5KEF1dGhvcml0eSBhdXRob3JpdHlfKSBhdXRoIHsKICAgICAgICBhdXRob3JpdHkgPSBhdXRob3JpdHlfOwogICAgICAgIExvZ1NldEF1dGhvcml0eShhdXRob3JpdHkpOwogICAgfQoKICAgIG1vZGlmaWVyIGF1dGggewogICAgICAgIHJlcXVpcmUoaXNBdXRob3JpemVkKG1zZy5zZW5kZXIsIG1zZy5zaWcpKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzQXV0aG9yaXplZChhZGRyZXNzIHNyYywgYnl0ZXM0IHNpZykgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmIChzcmMgPT0gYWRkcmVzcyh0aGlzKSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgaWYgKHNyYyA9PSBvd25lciAmJiBhdXRob3JpdHkgPT0gQXV0aG9yaXR5KDApKSB7CiAgICAgICAgICAgIC8qdGhlIG93bmVyIGhhcyBwcml2aWxlZ2VzIG9ubHkgYXMgbG9uZyBhcyBubyBBdXRob3JpdHkgaGFzIGJlZW4gZGVmaW5lZCovCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSBpZiAoYXV0aG9yaXR5ID09IEF1dGhvcml0eSgwKSkgewogICAgICAgICAgICBVbmF1dGhvcml6ZWRBY2Nlc3Moc3JjLCBzaWcpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGF1dGhvcml0eS5jYW5DYWxsKHNyYywgdGhpcywgc2lnKTsKICAgICAgICB9CiAgICB9Cn0KLyoKICAgQ29weXJpZ2h0IDIwMTcgRGFwcEh1YiwgTExDCgogICBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICAgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCiAgICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCiAgIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICAgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiovCgoKLy8gVG9rZW4gc3RhbmRhcmQgQVBJCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAoKY29udHJhY3QgRVJDMjBFdmVudHMgewogICAgZXZlbnQgVHJhbnNmZXIoIGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQgdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoIGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOwp9Cgpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEV2ZW50c3sKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludCBzdXBwbHkpOwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKCBhZGRyZXNzIHdobyApIGNvbnN0YW50IHJldHVybnMgKHVpbnQgdmFsdWUpOwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKCBhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIgKSBjb25zdGFudCByZXR1cm5zICh1aW50IF9hbGxvd2FuY2UpOwoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKCBhZGRyZXNzIHRvLCB1aW50IHZhbHVlKSByZXR1cm5zIChib29sIG9rKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbSggYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50IHZhbHVlKSByZXR1cm5zIChib29sIG9rKTsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoIGFkZHJlc3Mgc3BlbmRlciwgdWludCB2YWx1ZSApIHJldHVybnMgKGJvb2wgb2spOwoKfQovLy8gbWF0aC5zb2wgLS0gbWl4aW4gZm9yIGlubGluZSBudW1lcmljYWwgd2l6YXJkcnkKCi8vIENvcHlyaWdodCAoQykgMjAxNSwgMjAxNiwgMjAxNyAgRGFwcEh1YiwgTExDCgovLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKS4KLy8gWW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoKLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQovLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAovLyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCAoZXhwcmVzcyBvciBpbXBsaWVkKS4KCgpjb250cmFjdCBNYXRoIHsKICAgIAogICAgLyoKICAgIHN0YW5kYXJkIHVpbnQyNTYgZnVuY3Rpb25zCiAgICAgKi8KCiAgICBmdW5jdGlvbiBhZGQodWludDI1NiB4LCB1aW50MjU2IHkpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQyNTYgeikgewogICAgICAgIHJlcXVpcmUoKHogPSB4ICsgeSkgPj0geCk7CiAgICB9CgogICAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgeCwgdWludDI1NiB5KSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2IHopIHsKICAgICAgICByZXF1aXJlKCh6ID0geCAtIHkpIDw9IHgpOwogICAgfQoKICAgIGZ1bmN0aW9uIG11bCh1aW50MjU2IHgsIHVpbnQyNTYgeSkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NiB6KSB7CiAgICAgICAgeiA9IHggKiB5OwogICAgICAgIHJlcXVpcmUoeiA9PSAwIHx8IHogPj0gKHggPiB5ID8geCA6IHkpKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkaXYodWludDI1NiB4LCB1aW50MjU2IHkpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQyNTYgeikgewogICAgICAgIHJlcXVpcmUoeSA+IDApOwogICAgICAgIHogPSB4IC8geTsKICAgIH0KCiAgICBmdW5jdGlvbiBtaW4odWludDI1NiB4LCB1aW50MjU2IHkpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQyNTYgeikgewogICAgICAgIHJldHVybiB4IDw9IHkgPyB4IDogeTsKICAgIH0KICAgIGZ1bmN0aW9uIG1heCh1aW50MjU2IHgsIHVpbnQyNTYgeSkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NiB6KSB7CiAgICAgICAgcmV0dXJuIHggPj0geSA/IHggOiB5OwogICAgfQoKICAgIC8qCiAgICB1aW50MTI4IGZ1bmN0aW9ucyAoaCBpcyBmb3IgaGFsZikKICAgICAqLwoKCiAgICBmdW5jdGlvbiBoYWRkKHVpbnQxMjggeCwgdWludDEyOCB5KSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MTI4IHopIHsKICAgICAgICByZXF1aXJlKCh6ID0geCArIHkpID49IHgpOwogICAgfQoKICAgIGZ1bmN0aW9uIGhzdWIodWludDEyOCB4LCB1aW50MTI4IHkpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQxMjggeikgewogICAgICAgIHJlcXVpcmUoKHogPSB4IC0geSkgPD0geCk7CiAgICB9CgogICAgZnVuY3Rpb24gaG11bCh1aW50MTI4IHgsIHVpbnQxMjggeSkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludDEyOCB6KSB7CiAgICAgICAgcmVxdWlyZSgoeiA9IHggKiB5KSA+PSB4KTsKICAgIH0KCiAgICBmdW5jdGlvbiBoZGl2KHVpbnQxMjggeCwgdWludDEyOCB5KSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MTI4IHopIHsKICAgICAgICByZXF1aXJlKHkgPiAwKTsKICAgICAgICB6ID0geCAvIHk7CiAgICB9CgogICAgZnVuY3Rpb24gaG1pbih1aW50MTI4IHgsIHVpbnQxMjggeSkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludDEyOCB6KSB7CiAgICAgICAgcmV0dXJuIHggPD0geSA/IHggOiB5OwogICAgfQogICAgZnVuY3Rpb24gaG1heCh1aW50MTI4IHgsIHVpbnQxMjggeSkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludDEyOCB6KSB7CiAgICAgICAgcmV0dXJuIHggPj0geSA/IHggOiB5OwogICAgfQoKCiAgICAvKgogICAgaW50MjU2IGZ1bmN0aW9ucwogICAgICovCgogICAgZnVuY3Rpb24gaW1pbihpbnQyNTYgeCwgaW50MjU2IHkpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKGludDI1NiB6KSB7CiAgICAgICAgcmV0dXJuIHggPD0geSA/IHggOiB5OwogICAgfQogICAgZnVuY3Rpb24gaW1heChpbnQyNTYgeCwgaW50MjU2IHkpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKGludDI1NiB6KSB7CiAgICAgICAgcmV0dXJuIHggPj0geSA/IHggOiB5OwogICAgfQoKICAgIC8qCiAgICBXQUQgbWF0aAogICAgICovCgogICAgdWludDEyOCBjb25zdGFudCBXQUQgPSAxMCAqKiAxODsKCiAgICBmdW5jdGlvbiB3YWRkKHVpbnQxMjggeCwgdWludDEyOCB5KSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MTI4KSB7CiAgICAgICAgcmV0dXJuIGhhZGQoeCwgeSk7CiAgICB9CgogICAgZnVuY3Rpb24gd3N1Yih1aW50MTI4IHgsIHVpbnQxMjggeSkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludDEyOCkgewogICAgICAgIHJldHVybiBoc3ViKHgsIHkpOwogICAgfQoKICAgIGZ1bmN0aW9uIHdtdWwodWludDEyOCB4LCB1aW50MTI4IHkpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQxMjggeikgewogICAgICAgIHogPSBjYXN0KCh1aW50MjU2KHgpICogeSArIFdBRCAvIDIpIC8gV0FEKTsKICAgIH0KCiAgICBmdW5jdGlvbiB3ZGl2KHVpbnQxMjggeCwgdWludDEyOCB5KSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MTI4IHopIHsKICAgICAgICB6ID0gY2FzdCgodWludDI1Nih4KSAqIFdBRCArIHkgLyAyKSAvIHkpOwogICAgfQoKICAgIGZ1bmN0aW9uIHdtaW4odWludDEyOCB4LCB1aW50MTI4IHkpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQxMjgpIHsKICAgICAgICByZXR1cm4gaG1pbih4LCB5KTsKICAgIH0KICAgIGZ1bmN0aW9uIHdtYXgodWludDEyOCB4LCB1aW50MTI4IHkpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQxMjgpIHsKICAgICAgICByZXR1cm4gaG1heCh4LCB5KTsKICAgIH0KCiAgICAvKgogICAgUkFZIG1hdGgKICAgICAqLwoKICAgIHVpbnQxMjggY29uc3RhbnQgUkFZID0gMTAgKiogMjc7CgogICAgZnVuY3Rpb24gcmFkZCh1aW50MTI4IHgsIHVpbnQxMjggeSkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludDEyOCkgewogICAgICAgIHJldHVybiBoYWRkKHgsIHkpOwogICAgfQoKICAgIGZ1bmN0aW9uIHJzdWIodWludDEyOCB4LCB1aW50MTI4IHkpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQxMjgpIHsKICAgICAgICByZXR1cm4gaHN1Yih4LCB5KTsKICAgIH0KCiAgICBmdW5jdGlvbiBybXVsKHVpbnQxMjggeCwgdWludDEyOCB5KSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MTI4IHopIHsKICAgICAgICB6ID0gY2FzdCgodWludDI1Nih4KSAqIHkgKyBSQVkgLyAyKSAvIFJBWSk7CiAgICB9CgogICAgZnVuY3Rpb24gcmRpdih1aW50MTI4IHgsIHVpbnQxMjggeSkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludDEyOCB6KSB7CiAgICAgICAgeiA9IGNhc3QoKHVpbnQyNTYoeCkgKiBSQVkgKyB5IC8gMikgLyB5KTsKICAgIH0KCiAgICBmdW5jdGlvbiBycG93KHVpbnQxMjggeCwgdWludDY0IG4pIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQxMjggeikgewogICAgICAgIC8vIFRoaXMgZmFtb3VzIGFsZ29yaXRobSBpcyBjYWxsZWQgImV4cG9uZW50aWF0aW9uIGJ5IHNxdWFyaW5nIgogICAgICAgIC8vIGFuZCBjYWxjdWxhdGVzIHhebiB3aXRoIHggYXMgZml4ZWQtcG9pbnQgYW5kIG4gYXMgcmVndWxhciB1bnNpZ25lZC4KICAgICAgICAvLwogICAgICAgIC8vIEl0J3MgTyhsb2cgbiksIGluc3RlYWQgb2YgTyhuKSBmb3IgbmFpdmUgcmVwZWF0ZWQgbXVsdGlwbGljYXRpb24uCiAgICAgICAgLy8KICAgICAgICAvLyBUaGVzZSBmYWN0cyBhcmUgd2h5IGl0IHdvcmtzOgogICAgICAgIC8vCiAgICAgICAgLy8gIElmIG4gaXMgZXZlbiwgdGhlbiB4Xm4gPSAoeF4yKV4obi8yKS4KICAgICAgICAvLyAgSWYgbiBpcyBvZGQsICB0aGVuIHhebiA9IHggKiB4XihuLTEpLAogICAgICAgIC8vICAgYW5kIGFwcGx5aW5nIHRoZSBlcXVhdGlvbiBmb3IgZXZlbiB4IGdpdmVzCiAgICAgICAgLy8gICAgeF5uID0geCAqICh4XjIpXigobi0xKSAvIDIpLgogICAgICAgIC8vCiAgICAgICAgLy8gIEFsc28sIEVWTSBkaXZpc2lvbiBpcyBmbG9vcmluZyBhbmQKICAgICAgICAvLyAgICBmbG9vclsobi0xKSAvIDJdID0gZmxvb3JbbiAvIDJdLgoKICAgICAgICB6ID0gbiAlIDIgIT0gMCA/IHggOiBSQVk7CgogICAgICAgIGZvciAobiAvPSAyOyBuICE9IDA7IG4gLz0gMikgewogICAgICAgICAgICB4ID0gcm11bCh4LCB4KTsKCiAgICAgICAgICAgIGlmIChuICUgMiAhPSAwKSB7CiAgICAgICAgICAgICAgICB6ID0gcm11bCh6LCB4KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBybWluKHVpbnQxMjggeCwgdWludDEyOCB5KSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MTI4KSB7CiAgICAgICAgcmV0dXJuIGhtaW4oeCwgeSk7CiAgICB9CiAgICBmdW5jdGlvbiBybWF4KHVpbnQxMjggeCwgdWludDEyOCB5KSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MTI4KSB7CiAgICAgICAgcmV0dXJuIGhtYXgoeCwgeSk7CiAgICB9CgogICAgZnVuY3Rpb24gY2FzdCh1aW50MjU2IHgpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQxMjggeikgewogICAgICAgIHJlcXVpcmUoKHogPSB1aW50MTI4KHgpKSA9PSB4KTsKICAgIH0KCn0KCgpjb250cmFjdCBNaWdyYXRpb25zIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKICB1aW50IHB1YmxpYyBsYXN0X2NvbXBsZXRlZF9taWdyYXRpb247CgogIG1vZGlmaWVyIHJlc3RyaWN0ZWQoKSB7CiAgICBpZiAobXNnLnNlbmRlciA9PSBvd25lcikgXzsKICB9CgogIGZ1bmN0aW9uIE1pZ3JhdGlvbnMoKSB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKICBmdW5jdGlvbiBzZXRDb21wbGV0ZWQodWludCBjb21wbGV0ZWQpIHJlc3RyaWN0ZWQgewogICAgbGFzdF9jb21wbGV0ZWRfbWlncmF0aW9uID0gY29tcGxldGVkOwogIH0KCiAgZnVuY3Rpb24gdXBncmFkZShhZGRyZXNzIG5ld19hZGRyZXNzKSByZXN0cmljdGVkIHsKICAgIE1pZ3JhdGlvbnMgdXBncmFkZWQgPSBNaWdyYXRpb25zKG5ld19hZGRyZXNzKTsKICAgIHVwZ3JhZGVkLnNldENvbXBsZXRlZChsYXN0X2NvbXBsZXRlZF9taWdyYXRpb24pOwogIH0KfQovLy8gbm90ZS5zb2wgLS0gdGhlIGBub3RlJyBtb2RpZmllciwgZm9yIGxvZ2dpbmcgY2FsbHMgYXMgZXZlbnRzCgovLyBDb3B5cmlnaHQgKEMpIDIwMTcgIERhcHBIdWIsIExMQwovLwovLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKS4KLy8gWW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgovLwovLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCi8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCi8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5EIChleHByZXNzIG9yIGltcGxpZWQpLgoKCgoKY29udHJhY3QgTm90ZSB7CiAgICBldmVudCBMb2dOb3RlKAogICAgICAgIGJ5dGVzNCAgIGluZGV4ZWQgc2lnLAogICAgICAgIGFkZHJlc3MgIGluZGV4ZWQgZ3V5LAogICAgICAgIGJ5dGVzMzIgIGluZGV4ZWQgZm9vLAogICAgICAgIGJ5dGVzMzIgIGluZGV4ZWQgYmFyLAogICAgICAgIHVpbnQgd2FkLAogICAgICAgIGJ5dGVzIGZheAogICAgKSBhbm9ueW1vdXM7CgogICAgbW9kaWZpZXIgbm90ZSB7CiAgICAgICAgYnl0ZXMzMiBmb287CiAgICAgICAgYnl0ZXMzMiBiYXI7CgogICAgICAgIGFzc2VtYmx5IHsKICAgICAgICBmb28gOj0gY2FsbGRhdGFsb2FkKDQpCiAgICAgICAgYmFyIDo9IGNhbGxkYXRhbG9hZCgzNikKICAgICAgICB9CgogICAgICAgIExvZ05vdGUobXNnLnNpZywgbXNnLnNlbmRlciwgZm9vLCBiYXIsIG1zZy52YWx1ZSwgbXNnLmRhdGEpOwoKICAgICAgICBfOwogICAgfQp9Ci8vLyBzdG9wLnNvbCAtLSBtaXhpbiBmb3IgZW5hYmxlL2Rpc2FibGUgZnVuY3Rpb25hbGl0eQoKLy8gQ29weXJpZ2h0IChDKSAyMDE3ICBEYXBwSHViLCBMTEMKCi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpLgovLyBZb3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgovLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCi8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCi8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5EIChleHByZXNzIG9yIGltcGxpZWQpLgoKCmNvbnRyYWN0IFN0b3BwYWJsZSBpcyBBdXRoLCBOb3RlIHsKCiAgICBib29sIHB1YmxpYyBzdG9wcGVkOwoKICAgIG1vZGlmaWVyIHN0b3BwYWJsZSB7CiAgICAgICAgcmVxdWlyZSAoIXN0b3BwZWQpOwogICAgICAgIF87CiAgICB9CiAgICBmdW5jdGlvbiBzdG9wKCkgYXV0aCBub3RlIHsKICAgICAgICBzdG9wcGVkID0gdHJ1ZTsKICAgIH0KICAgIGZ1bmN0aW9uIHN0YXJ0KCkgYXV0aCBub3RlIHsKICAgICAgICBzdG9wcGVkID0gZmFsc2U7CiAgICB9Cgp9Ly8gdG9rZW4uc29sIC0tIEVSQzIwIGltcGxlbWVudGF0aW9uIHdpdGggbWludGluZyBhbmQgYnVybmluZwoKLy8gQ29weXJpZ2h0IChDKSAyMDE1LCAyMDE2LCAyMDE3ICBEYXBwSHViLCBMTEMKCi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpLgovLyBZb3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgovLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCi8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCi8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5EIChleHByZXNzIG9yIGltcGxpZWQpLgoKCmNvbnRyYWN0IFRva2VuIGlzIEVSQzIwLCBTdG9wcGFibGUgewoKICAgIGJ5dGVzMzIgcHVibGljIHN5bWJvbDsgICAgCiAgICBzdHJpbmcgcHVibGljIG5hbWU7IC8vIE9wdGlvbmFsIHRva2VuIG5hbWUKICAgIHVpbnQyNTYgcHVibGljIGRlY2ltYWxzID0gMTg7IC8vIHN0YW5kYXJkIHRva2VuIHByZWNpc2lvbi4gb3ZlcnJpZGUgdG8gY3VzdG9taXplCiAgICBUb2tlbkxvZ2ljIHB1YmxpYyBsb2dpYzsKCiAgICBmdW5jdGlvbiBUb2tlbihzdHJpbmcgbmFtZV8sIGJ5dGVzMzIgc3ltYm9sXykgewogICAgICAgIG5hbWUgPSBuYW1lXzsKICAgICAgICBzeW1ib2wgPSBzeW1ib2xfOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldExvZ2ljKFRva2VuTG9naWMgbG9naWNfKSBhdXRoIG5vdGUgcmV0dXJucyhib29sKXsKICAgICAgICBsb2dpYyA9IGxvZ2ljXzsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRPd25lcihhZGRyZXNzIG93bmVyXykgYXV0aCB7CiAgICAgICAgdWludCB3YWQgPSBiYWxhbmNlT2Yob3duZXIpOwogICAgICAgIGxvZ2ljLnRyYW5zZmVyKG93bmVyLCBvd25lcl8sIHdhZCk7CiAgICAgICAgVHJhbnNmZXIob3duZXIsIG93bmVyXywgd2FkKTsKICAgICAgICBsb2dpYy5zZXRPd25lcihvd25lcl8pOwogICAgICAgIHN1cGVyLnNldE93bmVyKG93bmVyXyk7CiAgICB9CgoKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nil7CiAgICAgICAgcmV0dXJuIGxvZ2ljLnRvdGFsU3VwcGx5KCk7CiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKCBhZGRyZXNzIHdobyApIGNvbnN0YW50IHJldHVybnMgKHVpbnQgdmFsdWUpIHsKICAgICAgICByZXR1cm4gbG9naWMuYmFsYW5jZU9mKHdobyk7CiAgICB9CgogICAgZnVuY3Rpb24gYWxsb3dhbmNlKCBhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIgKSBjb25zdGFudCByZXR1cm5zICh1aW50IF9hbGxvd2FuY2UpIHsKICAgICAgICByZXR1cm4gbG9naWMuYWxsb3dhbmNlKG93bmVyLCBzcGVuZGVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIGRzdCwgdWludCB3YWQpIHN0b3BwYWJsZSBub3RlIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBib29sIHJldFZhbCA9IGxvZ2ljLnRyYW5zZmVyKG1zZy5zZW5kZXIsIGRzdCwgd2FkKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBkc3QsIHdhZCk7CiAgICAgICAgcmV0dXJuIHJldFZhbDsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3Mgc3JjLCBhZGRyZXNzIGRzdCwgdWludCB3YWQpIHN0b3BwYWJsZSBub3RlIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBib29sIHJldFZhbCA9IGxvZ2ljLnRyYW5zZmVyRnJvbShzcmMsIGRzdCwgd2FkKTsKICAgICAgICBUcmFuc2ZlcihzcmMsIGRzdCwgd2FkKTsKICAgICAgICByZXR1cm4gcmV0VmFsOwogICAgfQoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBndXksIHVpbnQgd2FkKSBzdG9wcGFibGUgbm90ZSByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIGxvZ2ljLmFwcHJvdmUobXNnLnNlbmRlciwgZ3V5LCB3YWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHB1c2goYWRkcmVzcyBkc3QsIHVpbnQxMjggd2FkKSByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHRyYW5zZmVyKGRzdCwgd2FkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwdWxsKGFkZHJlc3Mgc3JjLCB1aW50MTI4IHdhZCkgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiB0cmFuc2ZlckZyb20oc3JjLCBtc2cuc2VuZGVyLCB3YWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIG1pbnQodWludDEyOCB3YWQpIGF1dGggc3RvcHBhYmxlIG5vdGUgewogICAgICAgIGxvZ2ljLm1pbnQod2FkKTsKICAgICAgICBUcmFuc2Zlcih0aGlzLCBtc2cuc2VuZGVyLCB3YWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGJ1cm4odWludDEyOCB3YWQpIGF1dGggc3RvcHBhYmxlIG5vdGUgewogICAgICAgIGxvZ2ljLmJ1cm4obXNnLnNlbmRlciwgd2FkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXROYW1lKHN0cmluZyBuYW1lXykgYXV0aCB7CiAgICAgICAgbmFtZSA9IG5hbWVfOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFN5bWJvbChieXRlczMyIHN5bWJvbF8pIGF1dGggewogICAgICAgIHN5bWJvbCA9IHN5bWJvbF87CiAgICB9CgogICAgZnVuY3Rpb24gKCkgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPiAwKTsKICAgICAgICB1aW50IHdhZCA9IGxvZ2ljLmhhbmRsZVBheW1lbnQobXNnLnNlbmRlciwgbXNnLnZhbHVlKTsKICAgICAgICBUcmFuc2Zlcih0aGlzLCBtc2cuc2VuZGVyLCB3YWQpOwogICAgfQoKLypzcGVjaWFsIGZ1bmN0aW9ucyBmb3IgSUNPKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRXRoKGFkZHJlc3MgZHN0LCB1aW50IHdhZCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBhZGRyZXNzKGxvZ2ljKSk7CiAgICAgICAgcmVxdWlyZSh3YWQgPCB0aGlzLmJhbGFuY2UpOwogICAgICAgIGRzdC50cmFuc2Zlcih3YWQpOwogICAgfQoKLyp0aGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBmcm9tIGxvZ2ljIHRvIHRyaWdnZXIgdGhlIGNvcnJlY3QgZXZlbnQgdXBvbiByZWNlaXZpbmcgRVRIKi8KICAgIGZ1bmN0aW9uIHRyaWdnZXJUYW5zZmVyRXZlbnQoYWRkcmVzcyBzcmMsICBhZGRyZXNzIGRzdCwgdWludCB3YWQpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYWRkcmVzcyhsb2dpYykpOwogICAgICAgIFRyYW5zZmVyKHNyYywgZHN0LCB3YWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHBheW91dChhZGRyZXNzIGRzdCkgYXV0aCB7CiAgICAgICAgcmVxdWlyZShkc3QgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgZHN0LnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgICB9Cgp9Cgpjb250cmFjdCBUb2tlbkRhdGEgaXMgQXV0aCB7CiAgICB1aW50MjU2IHB1YmxpYyBzdXBwbHk7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBiYWxhbmNlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgcHVibGljIGFwcHJvdmFsczsKICAgIGFkZHJlc3MgdG9rZW47CgogICAgbW9kaWZpZXIgdG9rZW5Pbmx5IHsKICAgICAgICBhc3NlcnQobXNnLnNlbmRlciA9PSB0b2tlbik7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBUb2tlbkRhdGEoYWRkcmVzcyB0b2tlbl8sIHVpbnQgc3VwcGx5XywgYWRkcmVzcyBvd25lcl8pIHsKICAgICAgICB0b2tlbiA9IHRva2VuXzsKICAgICAgICBzdXBwbHkgPSBzdXBwbHlfOwogICAgICAgIG93bmVyID0gb3duZXJfOwogICAgICAgIGJhbGFuY2VzW293bmVyXSA9IHN1cHBseTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRPd25lcihhZGRyZXNzIG93bmVyXykgdG9rZW5Pbmx5IHsKICAgICAgICBvd25lciA9IG93bmVyXzsKICAgICAgICBMb2dTZXRPd25lcihvd25lcik7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0VG9rZW4oYWRkcmVzcyB0b2tlbl8pIGF1dGggewogICAgICAgIHRva2VuID0gdG9rZW5fOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFN1cHBseSh1aW50IHN1cHBseV8pIHRva2VuT25seSB7CiAgICAgICAgc3VwcGx5ID0gc3VwcGx5XzsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRCYWxhbmNlcyhhZGRyZXNzIGd1eSwgdWludCBiYWxhbmNlKSB0b2tlbk9ubHkgewogICAgICAgIGJhbGFuY2VzW2d1eV0gPSBiYWxhbmNlOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEFwcHJvdmFscyhhZGRyZXNzIHNyYywgYWRkcmVzcyBndXksIHVpbnQgd2FkKSB0b2tlbk9ubHkgewogICAgICAgIGFwcHJvdmFsc1tzcmNdW2d1eV0gPSB3YWQ7CiAgICB9Cgp9Ly8vIGJhc2Uuc29sIC0tIGJhc2ljIEVSQzIwIGltcGxlbWVudGF0aW9uCgovLyBDb3B5cmlnaHQgKEMpIDIwMTUsIDIwMTYsIDIwMTcgIERhcHBIdWIsIExMQwoKLy8gTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIikuCi8vIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKLy8gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQgKGV4cHJlc3Mgb3IgaW1wbGllZCkuCgoKY29udHJhY3QgVG9rZW5Mb2dpYyBpcyBFUkMyMEV2ZW50cywgTWF0aCwgU3RvcHBhYmxlIHsKCiAgICBUb2tlbkRhdGEgcHVibGljIGRhdGE7CiAgICBUb2tlbiBwdWJsaWMgdG9rZW47CiAgICB1aW50IHB1YmxpYyB0b2tlbnNQZXJXZWk9MzAwMDsKICAgIGJvb2wgcHVibGljIHByZXNhbGUgPSB0cnVlOwogICAgdWludCBwdWJsaWMgaWNvU3RhcnQ9MTUwMzc1NjAwMDsgLy8gPSBBdWcgMjYgMjAxNyAycG0gR01UCiAgICB1aW50IHB1YmxpYyBpY29FbmQ7ICAgLy8xNTA0MTg4MDAwID0gQXVnIDMxIDIwMTcgMnBtIEdNVAogICAgdWludCBwdWJsaWMgaWNvU2FsZTsgLy90aGUgbnVtYmVyIG9mIHRva2VucyBzb2xkIGR1cmluZyB0aGUgSUNPCiAgICB1aW50IHB1YmxpYyBtYXhJY28gPSA5MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDsgLy8gdGhlIG1heGltdW0gbnVtYmVyIG9mIHRva2VucyBzb2xkIGR1cmluZyBJQ08KCiAgICBhZGRyZXNzW10gY29udHJpYnV0b3JzOwoKICAgIGZ1bmN0aW9uIFRva2VuTG9naWMoVG9rZW4gdG9rZW5fLCBUb2tlbkRhdGEgZGF0YV8sIHVpbnQgaWNvU3RhcnRfLCB1aW50IGljb0hvdXJzXykgewogICAgICAgIHJlcXVpcmUodG9rZW5fICE9IFRva2VuKDB4MCkpOwoKICAgICAgICBpZihkYXRhXyA9PSBhZGRyZXNzKDB4MCkpIHsKICAgICAgICAgICAgZGF0YSA9IG5ldyBUb2tlbkRhdGEodGhpcywgMTIwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwLCBtc2cuc2VuZGVyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkYXRhID0gZGF0YV87CiAgICAgICAgfQogICAgICAgIHRva2VuID0gdG9rZW5fOwogICAgICAgIGljb1N0YXJ0ID0gaWNvU3RhcnRfOwogICAgICAgIGljb0VuZCA9IGljb1N0YXJ0ICsgaWNvSG91cnNfICogMzYwMDsKICAgIH0KCiAgICBtb2RpZmllciB0b2tlbk9ubHkgewogICAgICAgIGFzc2VydChtc2cuc2VuZGVyID09IGFkZHJlc3ModG9rZW4pIHx8IG1zZy5zZW5kZXIgPT0gYWRkcmVzcyh0aGlzKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBjb250cmlidXRvckNvdW50KCkgY29uc3RhbnQgcmV0dXJucyh1aW50KSB7CiAgICAgICAgcmV0dXJuIGNvbnRyaWJ1dG9ycy5sZW5ndGg7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0T3duZXIoYWRkcmVzcyBvd25lcl8pIHRva2VuT25seSB7CiAgICAgICAgb3duZXIgPSBvd25lcl87CiAgICAgICAgTG9nU2V0T3duZXIob3duZXIpOwogICAgICAgIGRhdGEuc2V0T3duZXIob3duZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFRva2VuKFRva2VuIHRva2VuXykgYXV0aCB7CiAgICAgICAgdG9rZW4gPSB0b2tlbl87CiAgICB9CgogICAgZnVuY3Rpb24gc2V0SWNvU3RhcnQodWludCBpY29TdGFydF8sIHVpbnQgaWNvSG91cnNfKSBhdXRoIHsKICAgICAgICBpY29TdGFydCA9IGljb1N0YXJ0XzsKICAgICAgICBpY29FbmQgPSBpY29TdGFydCArIGljb0hvdXJzXyAqIDM2MDA7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0UHJlc2FsZShib29sIHByZXNhbGVfKSBhdXRoIHsKICAgICAgICBwcmVzYWxlID0gcHJlc2FsZV87CiAgICB9CgogICAgZnVuY3Rpb24gc2V0VG9rZW5zUGVyV2VpKHVpbnQgdG9rZW5zUGVyV2VpXykgYXV0aCB7CiAgICAgICAgcmVxdWlyZSh0b2tlbnNQZXJXZWlfID4gMCk7CiAgICAgICAgdG9rZW5zUGVyV2VpID0gdG9rZW5zUGVyV2VpXzsKICAgIH0KCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gZGF0YS5zdXBwbHkoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBzcmMpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gZGF0YS5iYWxhbmNlcyhzcmMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIHNyYywgYWRkcmVzcyBndXkpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gZGF0YS5hcHByb3ZhbHMoc3JjLCBndXkpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHNyYywgYWRkcmVzcyBkc3QsIHVpbnQgd2FkKSB0b2tlbk9ubHkgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoYmFsYW5jZU9mKHNyYykgPj0gd2FkKTsKICAgICAgICAKICAgICAgICBkYXRhLnNldEJhbGFuY2VzKHNyYywgc3ViKGRhdGEuYmFsYW5jZXMoc3JjKSwgd2FkKSk7CiAgICAgICAgZGF0YS5zZXRCYWxhbmNlcyhkc3QsIGFkZChkYXRhLmJhbGFuY2VzKGRzdCksIHdhZCkpOwogICAgICAgIAogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBzcmMsIGFkZHJlc3MgZHN0LCB1aW50IHdhZCkgdG9rZW5Pbmx5IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKGRhdGEuYmFsYW5jZXMoc3JjKSA+PSB3YWQpOwogICAgICAgIHJlcXVpcmUoZGF0YS5hcHByb3ZhbHMoc3JjLCBkc3QpID49IHdhZCk7CiAgICAgICAgCiAgICAgICAgZGF0YS5zZXRBcHByb3ZhbHMoc3JjLCBkc3QsIHN1YihkYXRhLmFwcHJvdmFscyhzcmMsIGRzdCksIHdhZCkpOwogICAgICAgIGRhdGEuc2V0QmFsYW5jZXMoc3JjLCBzdWIoZGF0YS5iYWxhbmNlcyhzcmMpLCB3YWQpKTsKICAgICAgICBkYXRhLnNldEJhbGFuY2VzKGRzdCwgYWRkKGRhdGEuYmFsYW5jZXMoZHN0KSwgd2FkKSk7CiAgICAgICAgCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcmMsIGFkZHJlc3MgZ3V5LCB1aW50MjU2IHdhZCkgdG9rZW5Pbmx5IHJldHVybnMgKGJvb2wpIHsKCiAgICAgICAgZGF0YS5zZXRBcHByb3ZhbHMoc3JjLCBndXksIHdhZCk7CiAgICAgICAgCiAgICAgICAgQXBwcm92YWwoc3JjLCBndXksIHdhZCk7CiAgICAgICAgCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gbWludCh1aW50MTI4IHdhZCkgdG9rZW5Pbmx5IHsKICAgICAgICBkYXRhLnNldEJhbGFuY2VzKGRhdGEub3duZXIoKSwgYWRkKGRhdGEuYmFsYW5jZXMoZGF0YS5vd25lcigpKSwgd2FkKSk7CiAgICAgICAgZGF0YS5zZXRTdXBwbHkoYWRkKGRhdGEuc3VwcGx5KCksIHdhZCkpOwogICAgfQoKICAgIGZ1bmN0aW9uIGJ1cm4oYWRkcmVzcyBzcmMsIHVpbnQxMjggd2FkKSB0b2tlbk9ubHkgewogICAgICAgIHJlcXVpcmUoYmFsYW5jZU9mKHNyYykgPj0gd2FkKTsKICAgICAgICBkYXRhLnNldEJhbGFuY2VzKHNyYywgc3ViKGRhdGEuYmFsYW5jZXMoc3JjKSwgd2FkKSk7CiAgICAgICAgZGF0YS5zZXRTdXBwbHkoc3ViKGRhdGEuc3VwcGx5KCksIHdhZCkpOwogICAgfQoKICAgIGZ1bmN0aW9uIHJldHVybkljb0ludmVzdG1lbnRzKHVpbnQgY29udHJpYnV0b3JJbmRleCkgYXV0aCB7CiAgICAgICAgLyp0aGlzIGNhbiBvbmx5IGJlIGRvbmUgYWZ0ZXIgdGhlIElDTyBjbG9zZSBkYXRlIGFuZCBpZiBsZXNzIHRoYW4gMjBtaW8gdG9rZW5zIHdlcmUgc29sZCovCiAgICAgICAgcmVxdWlyZShub3cgPiBpY29FbmQgJiYgaWNvU2FsZSA8IDIwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwKTsKCiAgICAgICAgYWRkcmVzcyBzcmMgPSBjb250cmlidXRvcnNbY29udHJpYnV0b3JJbmRleF07CiAgICAgICAgcmVxdWlyZShzcmMgIT0gYWRkcmVzcygwKSk7CgogICAgICAgIHVpbnQgc3JjQmFsYW5jZSA9IGJhbGFuY2VPZihzcmMpOwoKICAgICAgICAvKnRyYW5zZmVyIHRoZSBzZW50IEVUSCBhbW91bnQgbWludXMgYSA1IGZpbm5leSAoMC4wMDUgRVRIIH4gMVVTRCkgdGF4IHRvIHBheSBmb3IgR2FzKi8KICAgICAgICB0b2tlbi50cmFuc2ZlckV0aChzcmMsIHN1YihkaXYoc3JjQmFsYW5jZSwgdG9rZW5zUGVyV2VpKSwgNSBmaW5uZXkpKTsKCiAgICAgICAgLypnaXZlIGJhY2sgdGhlIHRva2VucyovCiAgICAgICAgZGF0YS5zZXRCYWxhbmNlcyhzcmMsIHN1YihkYXRhLmJhbGFuY2VzKHNyYyksIHNyY0JhbGFuY2UpKTsKICAgICAgICBkYXRhLnNldEJhbGFuY2VzKG93bmVyLCBhZGQoZGF0YS5iYWxhbmNlcyhvd25lciksIHNyY0JhbGFuY2UpKTsKICAgICAgICB0b2tlbi50cmlnZ2VyVGFuc2ZlckV2ZW50KHNyYywgb3duZXIsIHNyY0JhbGFuY2UpOwoKICAgICAgICAvKnJlc2V0IHRoZSBhZGRyZXNzIGFmdGVyIHRoZSB0cmFuc2ZlciB0byBhdm9pZCBlcnJvcnMqLwogICAgICAgIGNvbnRyaWJ1dG9yc1tjb250cmlidXRvckluZGV4XSA9IGFkZHJlc3MoMCk7CiAgICB9CgogICAgZnVuY3Rpb24gaGFuZGxlUGF5bWVudChhZGRyZXNzIHNyYywgdWludCBldGgpIHRva2VuT25seSByZXR1cm5zICh1aW50KXsKICAgICAgICByZXF1aXJlKGV0aCA+IDApOwogICAgICAgIC8qdGhlIHRpbWUgc3RhbXAgaGFzIHRvIGJlIGJldHdlZW4gdGhlIHN0YXJ0IGFuZCBlbmQgdGltZXMgb2YgdGhlIElDTyovCiAgICAgICAgcmVxdWlyZShub3cgPj0gaWNvU3RhcnQgJiYgbm93IDw9IGljb0VuZCk7CiAgICAgICAgLypubyBtb3JlIHRoYW4gOTAgbWlvIHRva2VucyBzaGFsbCBiZSBzb2xkIGluIHRoZSBJQ08qLwogICAgICAgIHJlcXVpcmUoaWNvU2FsZSA8IG1heEljbyk7CgogICAgICAgIHVpbnQgdG9rZW5BbW91bnQgPSBtdWwodG9rZW5zUGVyV2VpLCBldGgpOwogICAgICAgIGlmICghcHJlc2FsZSkgewogICAgICAgICAgICAvL2ZpcnN0IDE2OCBob3VycwogICAgICAgICAgICBpZiAobm93IDwgaWNvU3RhcnQgKyAoMTY4ICogMzYwMCkpIHsKICAgICAgICAgICAgICAgIHRva2VuQW1vdW50ID0gdG9rZW5BbW91bnQgKiAxNTAgLyAxMDA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8xNjggdG8gMzEyIGhvdXJzCiAgICAgICAgICAgIGVsc2UgaWYgKG5vdyA8IGljb1N0YXJ0ICsgKDMxMiAqIDM2MDApKSB7CiAgICAgICAgICAgICAgICB0b2tlbkFtb3VudCA9IHRva2VuQW1vdW50ICogMTMwIC8gMTAwOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vMzEyIHRvIDQ1NiBob3VycwogICAgICAgICAgICBlbHNlIGlmIChub3cgPCBpY29TdGFydCArICg0NTYgKiAzNjAwKSkgewogICAgICAgICAgICAgICAgdG9rZW5BbW91bnQgPSB0b2tlbkFtb3VudCAqIDExMCAvIDEwMDsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWNvU2FsZSArPSB0b2tlbkFtb3VudDsKICAgICAgICBpZihpY29TYWxlID4gbWF4SWNvKSB7CiAgICAgICAgICAgIHVpbnQgZXhjZXNzID0gc3ViKGljb1NhbGUsIG1heEljbyk7CiAgICAgICAgICAgIHRva2VuQW1vdW50ID0gc3ViKHRva2VuQW1vdW50LCBleGNlc3MpOwogICAgICAgICAgICB0b2tlbi50cmFuc2ZlckV0aChzcmMsIGRpdihleGNlc3MsIHRva2Vuc1BlcldlaSkpOwogICAgICAgICAgICBpY29TYWxlID0gbWF4SWNvOwogICAgICAgIH0KCiAgICAgICAgcmVxdWlyZShiYWxhbmNlT2Yob3duZXIpID49IHRva2VuQW1vdW50KTsKCiAgICAgICAgZGF0YS5zZXRCYWxhbmNlcyhvd25lciwgc3ViKGRhdGEuYmFsYW5jZXMob3duZXIpLCB0b2tlbkFtb3VudCkpOwogICAgICAgIGRhdGEuc2V0QmFsYW5jZXMoc3JjLCBhZGQoZGF0YS5iYWxhbmNlcyhzcmMpLCB0b2tlbkFtb3VudCkpOwogICAgICAgIGNvbnRyaWJ1dG9ycy5wdXNoKHNyYyk7CgogICAgICAgIHRva2VuLnRyaWdnZXJUYW5zZmVyRXZlbnQob3duZXIsIHNyYywgdG9rZW5BbW91bnQpOwoKICAgICAgICByZXR1cm4gdG9rZW5BbW91bnQ7CiAgICB9Cn0='.
	

]
