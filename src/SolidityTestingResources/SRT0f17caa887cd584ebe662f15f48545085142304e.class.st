Class {
	#name : #SRT0f17caa887cd584ebe662f15f48545085142304e,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT0f17caa887cd584ebe662f15f48545085142304e >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IDAuNC4yMTsKCi8vIFdvbGYgQ3J5cHRvIHByZXNhbGUgcG9vbGluZyBjb250cmFjdAovLyB3cml0dGVuIGJ5IEBpYW1kZWZpbml0ZWx5YWh1bWFuCgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKGEgPT0gMCkgcmV0dXJuIDA7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBhIC8gYjsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgppbnRlcmZhY2UgRVJDMjAgewogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIGV4dGVybmFsIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7Cn0KCmludGVyZmFjZSBXaGl0ZUxpc3QgewogICBmdW5jdGlvbiBjaGVja01lbWJlckxldmVsIChhZGRyZXNzIGFkZHIpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludCk7Cn0KCmxpYnJhcnkgUHJlc2FsZUxpYiB7CgkKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKICAKICBXaGl0ZUxpc3QgY29uc3RhbnQgd2hpdGVsaXN0Q29udHJhY3QgPSBXaGl0ZUxpc3QoMHg4RDk1QjAzOGNBODBBOTg2NDI1RkEyNDBDM0MxN0ZiMkI2ZTliYzYzKTsKICB1aW50IGNvbnN0YW50IGNvbnRyaWJ1dGlvbk1pbiA9IDEwMDAwMDAwMDAwMDAwMDAwMDsKICB1aW50IGNvbnN0YW50IG1heEdhc1ByaWNlID0gNTAwMDAwMDAwMDA7CiAgCiAgc3RydWN0IENvbnRyaWJ1dG9yIHsKICAgIHVpbnQxNiBjbGFpbWVkVG9rZW5zSW5kZXg7CiAgICB1aW50IGJhbGFuY2U7CiAgfQogIAogIHN0cnVjdCBEYXRhIHsKICAgIGFkZHJlc3Mgb3duZXI7CiAgICBhZGRyZXNzIHJlY2VpdmVyOwogICAgYWRkcmVzc1tdIHdpdGhkcmF3VG9rZW47CiAgICBib29sIHBvb2xTdWJtaXR0ZWQ7CiAgICBib29sIGxvY2tlZDsKICAgIHVpbnQgYWRkcmVzc1NldFRpbWU7CiAgICB1aW50IGZlZTsKICAgIHVpbnQgY29udHJhY3RDYXA7CiAgICB1aW50IGZpbmFsQmFsYW5jZTsKICAgIHVpbnRbXSB3aXRoZHJhd0Ftb3VudDsKICAgIHVpbnRbXSBjYXBBbW91bnRzOwogICAgdWludDMyW10gY2FwVGltZXM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHRva2VuQmFsYW5jZXM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIGluZGl2aWR1YWxDYXBzOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBDb250cmlidXRvcikgY29udHJpYnV0b3JNYXA7CiAgfQogIAogIGV2ZW50IENvbnRyaWJ1dG9yQmFsYW5jZUNoYW5nZWQgKGFkZHJlc3MgY29udHJpYnV0b3IsIHVpbnQgdG90YWxCYWxhbmNlKTsKICBldmVudCBSZWNlaXZlckFkZHJlc3NTZXQgKCBhZGRyZXNzIGFkZHIpOwogIGV2ZW50IFBvb2xTdWJtaXR0ZWQgKGFkZHJlc3MgcmVjZWl2ZXIsIHVpbnQgYW1vdW50KTsKICBldmVudCBXaXRoZHJhd2FsQXZhaWxhYmxlIChhZGRyZXNzIHRva2VuKTsKICBldmVudCBXaXRoZHJhd2FsQ2xhaW1lZCAoYWRkcmVzcyByZWNlaXZlciwgYWRkcmVzcyB0b2tlbiwgdWludCBhbW91bnQpOwogIAogIG1vZGlmaWVyIG9ubHlPd25lciAoRGF0YSBzdG9yYWdlIHNlbGYpIHsKICAgIHJlcXVpcmUgKG1zZy5zZW5kZXIgPT0gc2VsZi5vd25lcik7CiAgICBfOwogIH0KICAKICBtb2RpZmllciBub1JlZW50cmFuY3koRGF0YSBzdG9yYWdlIHNlbGYpIHsKICAgIHJlcXVpcmUoIXNlbGYubG9ja2VkKTsKICAgIHNlbGYubG9ja2VkID0gdHJ1ZTsKICAgIF87CiAgICBzZWxmLmxvY2tlZCA9IGZhbHNlOwogIH0KICAKICBmdW5jdGlvbiBfdG9QY3QgKHVpbnQgbnVtZXJhdG9yLCB1aW50IGRlbm9taW5hdG9yICkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50KSB7CiAgICByZXR1cm4gbnVtZXJhdG9yLm11bCgxMCAqKiAyMCkuZGl2KGRlbm9taW5hdG9yKTsKICB9CiAgCiAgZnVuY3Rpb24gX2FwcGx5UGN0ICh1aW50IG51bWVyYXRvciwgdWludCBwY3QpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCkgewogICAgcmV0dXJuIG51bWVyYXRvci5tdWwocGN0KS5kaXYoMTAgKiogMjApOwogIH0KICAKICBmdW5jdGlvbiBuZXdQb29sIChEYXRhIHN0b3JhZ2Ugc2VsZiwgdWludCBfZmVlLCBhZGRyZXNzIF9yZWNlaXZlciwgdWludCBfY29udHJhY3RDYXAsIHVpbnQgX2luZGl2aWR1YWxDYXApIHB1YmxpYyB7CiAgICByZXF1aXJlIChfZmVlIDwgMTAwMCk7CiAgICBzZWxmLm93bmVyID0gbXNnLnNlbmRlcjsKICAgIHNlbGYucmVjZWl2ZXIgPSBfcmVjZWl2ZXI7CiAgICBzZWxmLmNvbnRyYWN0Q2FwID0gX2NvbnRyYWN0Q2FwOwogICAgc2VsZi5jYXBUaW1lcy5wdXNoKDApOwogICAgc2VsZi5jYXBBbW91bnRzLnB1c2goX2luZGl2aWR1YWxDYXApOwogICAgc2VsZi5mZWUgPSBfdG9QY3QoX2ZlZSwxMDAwKTsKICB9CgkKICBmdW5jdGlvbiBkZXBvc2l0IChEYXRhIHN0b3JhZ2Ugc2VsZikgcHVibGljIHsKCSAgYXNzZXJ0ICghc2VsZi5wb29sU3VibWl0dGVkKTsKICAgIHJlcXVpcmUgKHR4Lmdhc3ByaWNlIDw9IG1heEdhc1ByaWNlKTsKICAgIENvbnRyaWJ1dG9yIHN0b3JhZ2UgYyA9IHNlbGYuY29udHJpYnV0b3JNYXBbbXNnLnNlbmRlcl07CiAgICB1aW50IGNhcCA9IF9nZXRDYXAoc2VsZiwgbXNnLnNlbmRlcik7CiAgICByZXF1aXJlIChjYXAgPj0gYy5iYWxhbmNlLmFkZChtc2cudmFsdWUpKTsKICAgIGlmIChzZWxmLmNvbnRyYWN0Q2FwIDwgYWRkcmVzcyh0aGlzKS5iYWxhbmNlKSB7CiAgICAgIHJlcXVpcmUgKGFkZHJlc3ModGhpcykuYmFsYW5jZS5zdWIobXNnLnZhbHVlKSA8IHNlbGYuY29udHJhY3RDYXApOwogICAgICB1aW50IGV4Y2VzcyA9IGFkZHJlc3ModGhpcykuYmFsYW5jZS5zdWIoc2VsZi5jb250cmFjdENhcCk7CiAgICAgIGMuYmFsYW5jZSA9IGMuYmFsYW5jZS5hZGQobXNnLnZhbHVlLnN1YihleGNlc3MpKTsKICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihleGNlc3MpOwogICAgfSBlbHNlIHsKICAgICAgYy5iYWxhbmNlID0gYy5iYWxhbmNlLmFkZChtc2cudmFsdWUpOwogICAgfQogICAgcmVxdWlyZSAoYy5iYWxhbmNlID49IGNvbnRyaWJ1dGlvbk1pbik7CiAgICBlbWl0IENvbnRyaWJ1dG9yQmFsYW5jZUNoYW5nZWQobXNnLnNlbmRlciwgYy5iYWxhbmNlKTsKICB9CiAgCiAgZnVuY3Rpb24gcmVjZWl2ZVJlZnVuZCAoRGF0YSBzdG9yYWdlIHNlbGYpIHB1YmxpYyB7CiAgICBhc3NlcnQgKHNlbGYucG9vbFN1Ym1pdHRlZCk7CiAgICByZXF1aXJlIChtc2cuc2VuZGVyID09IHNlbGYucmVjZWl2ZXIgfHwgbXNnLnNlbmRlciA9PSBzZWxmLm93bmVyKTsKICAgIHJlcXVpcmUgKG1zZy52YWx1ZSA+PSAxIGV0aGVyKTsKICAgIHNlbGYud2l0aGRyYXdUb2tlbi5wdXNoKDB4MDApOwogICAgc2VsZi53aXRoZHJhd0Ftb3VudC5wdXNoKG1zZy52YWx1ZSk7CiAgICBlbWl0IFdpdGhkcmF3YWxBdmFpbGFibGUoMHgwMCk7CiAgfQogIAogIGZ1bmN0aW9uIHdpdGhkcmF3IChEYXRhIHN0b3JhZ2Ugc2VsZikgcHVibGljIHsKICAgIGFzc2VydCAobXNnLnZhbHVlID09IDApOwogICAgQ29udHJpYnV0b3Igc3RvcmFnZSBjID0gc2VsZi5jb250cmlidXRvck1hcFttc2cuc2VuZGVyXTsKICAgIHJlcXVpcmUgKGMuYmFsYW5jZSA+IDApOwogICAgaWYgKCFzZWxmLnBvb2xTdWJtaXR0ZWQpIHsKICAgICAgdWludCBiYWxhbmNlID0gYy5iYWxhbmNlOwogICAgICBjLmJhbGFuY2UgPSAwOwogICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKGJhbGFuY2UpOwogICAgICBlbWl0IENvbnRyaWJ1dG9yQmFsYW5jZUNoYW5nZWQobXNnLnNlbmRlciwgMCk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHJlcXVpcmUgKGMuY2xhaW1lZFRva2Vuc0luZGV4IDwgc2VsZi53aXRoZHJhd1Rva2VuLmxlbmd0aCk7CiAgICB1aW50IHBjdCA9IF90b1BjdChjLmJhbGFuY2Usc2VsZi5maW5hbEJhbGFuY2UpOwogICAgdWludCBhbW91bnQ7CiAgICBhZGRyZXNzIHRva2VuOwogICAgZm9yICh1aW50MTYgaSA9IGMuY2xhaW1lZFRva2Vuc0luZGV4OyBpIDwgc2VsZi53aXRoZHJhd1Rva2VuLmxlbmd0aDsgaSsrKSB7CiAgICAgIGFtb3VudCA9IF9hcHBseVBjdChzZWxmLndpdGhkcmF3QW1vdW50W2ldLHBjdCk7CiAgICAgIHRva2VuID0gc2VsZi53aXRoZHJhd1Rva2VuW2ldOwogICAgICBjLmNsYWltZWRUb2tlbnNJbmRleCsrOwogICAgICBpZiAoYW1vdW50ID4gMCkgeyAgCiAgICAgICAgaWYgKHRva2VuID09IDB4MDApIHsKICAgICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoYW1vdW50KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVxdWlyZSAoRVJDMjAodG9rZW4pLnRyYW5zZmVyKG1zZy5zZW5kZXIsIGFtb3VudCkpOwogICAgICAgICAgc2VsZi50b2tlbkJhbGFuY2VzW3Rva2VuXSA9IHNlbGYudG9rZW5CYWxhbmNlc1t0b2tlbl0uc3ViKGFtb3VudCk7ICAKICAgICAgICB9CiAgICAgICAgZW1pdCBXaXRoZHJhd2FsQ2xhaW1lZChtc2cuc2VuZGVyLCB0b2tlbiwgYW1vdW50KTsKICAgICAgfQogICAgfQogIH0KICAKICBmdW5jdGlvbiBzZXRJbmRpdmlkdWFsQ2FwcyAoRGF0YSBzdG9yYWdlIHNlbGYsIGFkZHJlc3NbXSBhZGRyLCB1aW50W10gY2FwKSBwdWJsaWMgb25seU93bmVyKHNlbGYpIHsKICAgIHJlcXVpcmUgKGFkZHIubGVuZ3RoID09IGNhcC5sZW5ndGgpOwogICAgZm9yICh1aW50OCBpID0gMDsgaSA8IGFkZHIubGVuZ3RoOyBpKyspIHsKICAgICAgc2VsZi5pbmRpdmlkdWFsQ2Fwc1thZGRyW2ldXSA9IGNhcFtpXTsKICAgIH0gIAogIH0KICAKICBmdW5jdGlvbiBzZXRDYXBzIChEYXRhIHN0b3JhZ2Ugc2VsZiwgdWludDMyW10gdGltZXMsIHVpbnRbXSBjYXBzKSBwdWJsaWMgb25seU93bmVyKHNlbGYpIHsKICAgIHJlcXVpcmUgKGNhcHMubGVuZ3RoID4gMCk7CiAgICByZXF1aXJlIChjYXBzLmxlbmd0aCA9PSB0aW1lcy5sZW5ndGgpOwogICAgc2VsZi5jYXBUaW1lcyA9IFswXTsKICAgIHNlbGYuY2FwQW1vdW50cyA9IFtzZWxmLmNhcEFtb3VudHNbMF1dOwogICAgZm9yICh1aW50OCBpID0gMDsgaSA8IGNhcHMubGVuZ3RoOyBpKyspIHsKICAgICAgcmVxdWlyZSAodGltZXNbaV0gPiBzZWxmLmNhcFRpbWVzW3NlbGYuY2FwVGltZXMubGVuZ3RoLnN1YigxKV0pOwogICAgICBzZWxmLmNhcFRpbWVzLnB1c2godGltZXNbaV0pOwogICAgICBzZWxmLmNhcEFtb3VudHMucHVzaChjYXBzW2ldKTsKICAgIH0KICB9CiAgCiAgZnVuY3Rpb24gc2V0Q29udHJhY3RDYXAgKERhdGEgc3RvcmFnZSBzZWxmLCB1aW50IGFtb3VudCkgcHVibGljIG9ubHlPd25lcihzZWxmKSB7CiAgICByZXF1aXJlIChhbW91bnQgPj0gYWRkcmVzcyh0aGlzKS5iYWxhbmNlKTsKICAgIHNlbGYuY29udHJhY3RDYXAgPSBhbW91bnQ7CiAgfQogIAogIGZ1bmN0aW9uIF9nZXRDYXAgKERhdGEgc3RvcmFnZSBzZWxmLCBhZGRyZXNzIGFkZHIpIGludGVybmFsIHZpZXcgcmV0dXJucyAodWludCkgewogICAgaWYgKHNlbGYuaW5kaXZpZHVhbENhcHNbYWRkcl0gPiAwKSByZXR1cm4gc2VsZi5pbmRpdmlkdWFsQ2Fwc1thZGRyXTsKICAgIGlmICh3aGl0ZWxpc3RDb250cmFjdC5jaGVja01lbWJlckxldmVsKG1zZy5zZW5kZXIpID09IDApIHJldHVybiAwOwogICAgcmV0dXJuIGdldENhcEF0VGltZShzZWxmLG5vdyk7CiAgfQogIAogIGZ1bmN0aW9uIGdldENhcEF0VGltZSAoRGF0YSBzdG9yYWdlIHNlbGYsIHVpbnQgdGltZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgaWYgKHRpbWUgPT0gMCkgdGltZSA9IG5vdzsKICAgIGZvciAodWludCBpID0gMTsgaSA8IHNlbGYuY2FwVGltZXMubGVuZ3RoOyBpKyspIHsKICAgICAgaWYgKHNlbGYuY2FwVGltZXNbaV0gPiB0aW1lKSByZXR1cm4gc2VsZi5jYXBBbW91bnRzW2ktMV07CiAgICB9CiAgICByZXR1cm4gc2VsZi5jYXBBbW91bnRzW3NlbGYuY2FwQW1vdW50cy5sZW5ndGgtMV07CiAgfQogIAogIGZ1bmN0aW9uIGdldFBvb2xJbmZvIChEYXRhIHN0b3JhZ2Ugc2VsZikgdmlldyBwdWJsaWMgcmV0dXJucyAodWludCBiYWxhbmNlLCB1aW50IHJlbWFpbmluZywgdWludCBjYXApIHsKICAgIGlmICghc2VsZi5wb29sU3VibWl0dGVkKSByZXR1cm4gKGFkZHJlc3ModGhpcykuYmFsYW5jZSwgc2VsZi5jb250cmFjdENhcC5zdWIoYWRkcmVzcyh0aGlzKS5iYWxhbmNlKSwgc2VsZi5jb250cmFjdENhcCk7CiAgICByZXR1cm4gKGFkZHJlc3ModGhpcykuYmFsYW5jZSwgMCwgc2VsZi5jb250cmFjdENhcCk7CiAgfQogIAogIGZ1bmN0aW9uIGdldENvbnRyaWJ1dG9ySW5mbyAoRGF0YSBzdG9yYWdlIHNlbGYsIGFkZHJlc3MgYWRkcikgdmlldyBwdWJsaWMgcmV0dXJucyAodWludCBiYWxhbmNlLCB1aW50IHJlbWFpbmluZywgdWludCBjYXApIHsKICAgIGNhcCA9IF9nZXRDYXAoc2VsZiwgYWRkcik7CiAgICBDb250cmlidXRvciBzdG9yYWdlIGMgPSBzZWxmLmNvbnRyaWJ1dG9yTWFwW2FkZHJdOwogICAgaWYgKHNlbGYucG9vbFN1Ym1pdHRlZCB8fCBjYXAgPD0gYy5iYWxhbmNlKSByZXR1cm4gKGMuYmFsYW5jZSwgMCwgY2FwKTsKICAgIGlmIChjYXAuc3ViKGMuYmFsYW5jZSkgPiBzZWxmLmNvbnRyYWN0Q2FwLnN1YihhZGRyZXNzKHRoaXMpLmJhbGFuY2UpKSByZXR1cm4gKGMuYmFsYW5jZSwgc2VsZi5jb250cmFjdENhcC5zdWIoYWRkcmVzcyh0aGlzKS5iYWxhbmNlKSwgY2FwKTsKICAgIHJldHVybiAoYy5iYWxhbmNlLCBjYXAuc3ViKGMuYmFsYW5jZSksIGNhcCk7CiAgfQogIAogIGZ1bmN0aW9uIGNoZWNrV2l0aGRyYXdhbEF2YWlsYWJsZSAoRGF0YSBzdG9yYWdlIHNlbGYsIGFkZHJlc3MgYWRkcikgdmlldyBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHNlbGYuY29udHJpYnV0b3JNYXBbYWRkcl0uY2xhaW1lZFRva2Vuc0luZGV4IDwgc2VsZi53aXRoZHJhd1Rva2VuLmxlbmd0aDsKICB9CiAgCiAgZnVuY3Rpb24gc2V0UmVjZWl2ZXJBZGRyZXNzIChEYXRhIHN0b3JhZ2Ugc2VsZiwgYWRkcmVzcyBfcmVjZWl2ZXIpIHB1YmxpYyBvbmx5T3duZXIoc2VsZikgewogICAgcmVxdWlyZSAoIXNlbGYucG9vbFN1Ym1pdHRlZCk7CiAgICBzZWxmLnJlY2VpdmVyID0gX3JlY2VpdmVyOwogICAgc2VsZi5hZGRyZXNzU2V0VGltZSA9IG5vdzsKICAgIGVtaXQgUmVjZWl2ZXJBZGRyZXNzU2V0KF9yZWNlaXZlcik7CiAgfQogIAogIGZ1bmN0aW9uIHN1Ym1pdFBvb2wgKERhdGEgc3RvcmFnZSBzZWxmLCB1aW50IGFtb3VudEluV2VpKSBwdWJsaWMgb25seU93bmVyKHNlbGYpIG5vUmVlbnRyYW5jeShzZWxmKSB7CiAgICByZXF1aXJlICghc2VsZi5wb29sU3VibWl0dGVkKTsKICAgIHJlcXVpcmUgKG5vdyA+IHNlbGYuYWRkcmVzc1NldFRpbWUuYWRkKDg2NDAwKSk7CiAgICBpZiAoYW1vdW50SW5XZWkgPT0gMCkgYW1vdW50SW5XZWkgPSBhZGRyZXNzKHRoaXMpLmJhbGFuY2U7CiAgICBzZWxmLmZpbmFsQmFsYW5jZSA9IGFkZHJlc3ModGhpcykuYmFsYW5jZTsKICAgIHNlbGYucG9vbFN1Ym1pdHRlZCA9IHRydWU7CiAgICByZXF1aXJlIChzZWxmLnJlY2VpdmVyLmNhbGwudmFsdWUoYW1vdW50SW5XZWkpLmdhcyhnYXNsZWZ0KCkuc3ViKDUwMDApKSgpKTsKICAgIGlmIChhZGRyZXNzKHRoaXMpLmJhbGFuY2UgPiAwKSB7CiAgICAgIHNlbGYud2l0aGRyYXdUb2tlbi5wdXNoKDB4MDApOwogICAgICBzZWxmLndpdGhkcmF3QW1vdW50LnB1c2goYWRkcmVzcyh0aGlzKS5iYWxhbmNlKTsKICAgICAgZW1pdCBXaXRoZHJhd2FsQXZhaWxhYmxlKDB4MDApOwogICAgfQogICAgZW1pdCBQb29sU3VibWl0dGVkKHNlbGYucmVjZWl2ZXIsIGFtb3VudEluV2VpKTsKICB9CiAgCiAgZnVuY3Rpb24gZW5hYmxlV2l0aGRyYXdhbHMgKERhdGEgc3RvcmFnZSBzZWxmLCBhZGRyZXNzIHRva2VuQWRkcmVzcywgYWRkcmVzcyBmZWVBZGRyZXNzKSBwdWJsaWMgb25seU93bmVyKHNlbGYpIG5vUmVlbnRyYW5jeShzZWxmKSB7CiAgICByZXF1aXJlIChzZWxmLnBvb2xTdWJtaXR0ZWQpOwogICAgaWYgKGZlZUFkZHJlc3MgPT0gMHgwMCkgZmVlQWRkcmVzcyA9IHNlbGYub3duZXI7CiAgICBFUkMyMCB0b2tlbiA9IEVSQzIwKHRva2VuQWRkcmVzcyk7CiAgICB1aW50IGFtb3VudCA9IHRva2VuLmJhbGFuY2VPZih0aGlzKS5zdWIoc2VsZi50b2tlbkJhbGFuY2VzW3Rva2VuQWRkcmVzc10pOwogICAgcmVxdWlyZSAoYW1vdW50ID4gMCk7CiAgICBpZiAoc2VsZi5mZWUgPiAwKSB7CiAgICAgIHJlcXVpcmUgKHRva2VuLnRyYW5zZmVyKGZlZUFkZHJlc3MsIF9hcHBseVBjdChhbW91bnQsc2VsZi5mZWUpKSk7CiAgICAgIGFtb3VudCA9IHRva2VuLmJhbGFuY2VPZih0aGlzKS5zdWIoc2VsZi50b2tlbkJhbGFuY2VzW3Rva2VuQWRkcmVzc10pOwogICAgfQogICAgc2VsZi50b2tlbkJhbGFuY2VzW3Rva2VuQWRkcmVzc10gPSB0b2tlbi5iYWxhbmNlT2YodGhpcyk7CiAgICBzZWxmLndpdGhkcmF3VG9rZW4ucHVzaCh0b2tlbkFkZHJlc3MpOwogICAgc2VsZi53aXRoZHJhd0Ftb3VudC5wdXNoKGFtb3VudCk7CiAgICBlbWl0IFdpdGhkcmF3YWxBdmFpbGFibGUodG9rZW5BZGRyZXNzKTsKICB9Cgp9CmNvbnRyYWN0IFByZXNhbGVQb29sIHsKCQoJdXNpbmcgUHJlc2FsZUxpYiBmb3IgUHJlc2FsZUxpYi5EYXRhOwoJUHJlc2FsZUxpYi5EYXRhIGRhdGE7CiAgCiAgZXZlbnQgRVJDMjIzUmVjZWl2ZWQgKGFkZHJlc3MgdG9rZW4sIHVpbnQgdmFsdWUsIGJ5dGVzIGRhdGEpOwoJCglmdW5jdGlvbiBQcmVzYWxlUG9vbCAodWludCBmZWUsIGFkZHJlc3MgcmVjZWl2ZXIsIHVpbnQgY29udHJhY3RDYXAsIHVpbnQgaW5kaXZpZHVhbENhcCkgcHVibGljIHsKICAgIGRhdGEubmV3UG9vbChmZWUsIHJlY2VpdmVyLCBjb250cmFjdENhcCwgaW5kaXZpZHVhbENhcCk7Cgl9CgkKCWZ1bmN0aW9uICgpIHB1YmxpYyBwYXlhYmxlIHsKICAgIGlmIChtc2cudmFsdWUgPiAwKSB7CiAgICAgIGlmICghZGF0YS5wb29sU3VibWl0dGVkKSB7CiAgICAgICAgZGF0YS5kZXBvc2l0KCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGF0YS5yZWNlaXZlUmVmdW5kKCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGRhdGEud2l0aGRyYXcoKTsKICAgIH0KCX0KICAKICBmdW5jdGlvbiBzZXRJbmRpdmlkdWFsQ2FwcyAoYWRkcmVzc1tdIGFkZHIsIHVpbnRbXSBjYXApIHB1YmxpYyB7CiAgICBkYXRhLnNldEluZGl2aWR1YWxDYXBzKGFkZHIsIGNhcCk7IAogIH0KICAKICBmdW5jdGlvbiBzZXRDYXBzICh1aW50MzJbXSB0aW1lcywgdWludFtdIGNhcHMpIHB1YmxpYyB7CiAgICBkYXRhLnNldENhcHModGltZXMsY2Fwcyk7CiAgfQogIAogIGZ1bmN0aW9uIHNldENvbnRyYWN0Q2FwICh1aW50IGFtb3VudCkgcHVibGljIHsKICAgIGRhdGEuc2V0Q29udHJhY3RDYXAoYW1vdW50KTsKICB9CiAgCiAgZnVuY3Rpb24gZ2V0UG9vbEluZm8gKCkgdmlldyBwdWJsaWMgcmV0dXJucyAodWludCBiYWxhbmNlLCB1aW50IHJlbWFpbmluZywgdWludCBjYXApIHsKICAgIHJldHVybiBkYXRhLmdldFBvb2xJbmZvKCk7CiAgfQogIAogIGZ1bmN0aW9uIGdldENvbnRyaWJ1dG9ySW5mbyAoYWRkcmVzcyBhZGRyKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50IGJhbGFuY2UsIHVpbnQgcmVtYWluaW5nLCB1aW50IGNhcCkgewogICAgcmV0dXJuIGRhdGEuZ2V0Q29udHJpYnV0b3JJbmZvKGFkZHIpOwogIH0KICAKICBmdW5jdGlvbiBnZXRDYXBBdFRpbWUgKHVpbnQzMiB0aW1lKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50KSB7CiAgICByZXR1cm4gZGF0YS5nZXRDYXBBdFRpbWUodGltZSk7CiAgfQogIAogIGZ1bmN0aW9uIGNoZWNrV2l0aGRyYXdhbEF2YWlsYWJsZSAoYWRkcmVzcyBhZGRyKSB2aWV3IHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gZGF0YS5jaGVja1dpdGhkcmF3YWxBdmFpbGFibGUoYWRkcik7CiAgfQogIAogIGZ1bmN0aW9uIGdldFJlY2VpdmVyQWRkcmVzcyAoKSB2aWV3IHB1YmxpYyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICByZXR1cm4gZGF0YS5yZWNlaXZlcjsKICB9CiAgCiAgZnVuY3Rpb24gc2V0UmVjZWl2ZXJBZGRyZXNzIChhZGRyZXNzIHJlY2VpdmVyKSBwdWJsaWMgewogICAgZGF0YS5zZXRSZWNlaXZlckFkZHJlc3MocmVjZWl2ZXIpOwogIH0KICAKICBmdW5jdGlvbiBzdWJtaXRQb29sICh1aW50IGFtb3VudEluV2VpKSBwdWJsaWMgewogICAgZGF0YS5zdWJtaXRQb29sKGFtb3VudEluV2VpKTsKICB9CiAgCiAgZnVuY3Rpb24gZW5hYmxlV2l0aGRyYXdhbHMgKGFkZHJlc3MgdG9rZW5BZGRyZXNzLCBhZGRyZXNzIGZlZUFkZHJlc3MpIHB1YmxpYyB7CiAgICBkYXRhLmVuYWJsZVdpdGhkcmF3YWxzKHRva2VuQWRkcmVzcywgZmVlQWRkcmVzcyk7CiAgfQogIAogIGZ1bmN0aW9uIHRva2VuRmFsbGJhY2sgKGFkZHJlc3MgZnJvbSwgdWludCB2YWx1ZSwgYnl0ZXMgY2FsbGRhdGEpIHB1YmxpYyB7CiAgICBlbWl0IEVSQzIyM1JlY2VpdmVkKGZyb20sIHZhbHVlLCBjYWxsZGF0YSk7CiAgfQoJCn0='.
	

]
