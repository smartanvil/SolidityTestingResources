Class {
	#name : #SRT8e2a84d6ade1e7fffee039a35ef5f19f13057152,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT8e2a84d6ade1e7fffee039a35ef5f19f13057152 >> base64 [
	^ 'Ly8gaGV2bTogZmxhdHRlbmVkIHNvdXJjZXMgb2Ygc3JjL2NoaWVmLnNvbApwcmFnbWEgc29saWRpdHkgXjAuNC4xNzsKCi8vLy8vLyBsaWIvZHMtcm9sZXMvbGliL2RzLWF1dGgvc3JjL2F1dGguc29sCi8vIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5Ci8vIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5Ci8vIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCi8vIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgovLyBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKLy8gYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKLy8gTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQovLyBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgoKLy8gWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKLy8gYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0uICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCgovKiBwcmFnbWEgc29saWRpdHkgXjAuNC4xMzsgKi8KCmNvbnRyYWN0IERTQXV0aG9yaXR5IHsKICAgIGZ1bmN0aW9uIGNhbkNhbGwoCiAgICAgICAgYWRkcmVzcyBzcmMsIGFkZHJlc3MgZHN0LCBieXRlczQgc2lnCiAgICApIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwp9Cgpjb250cmFjdCBEU0F1dGhFdmVudHMgewogICAgZXZlbnQgTG9nU2V0QXV0aG9yaXR5IChhZGRyZXNzIGluZGV4ZWQgYXV0aG9yaXR5KTsKICAgIGV2ZW50IExvZ1NldE93bmVyICAgICAoYWRkcmVzcyBpbmRleGVkIG93bmVyKTsKfQoKY29udHJhY3QgRFNBdXRoIGlzIERTQXV0aEV2ZW50cyB7CiAgICBEU0F1dGhvcml0eSAgcHVibGljICBhdXRob3JpdHk7CiAgICBhZGRyZXNzICAgICAgcHVibGljICBvd25lcjsKCiAgICBmdW5jdGlvbiBEU0F1dGgoKSBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgICAgICBMb2dTZXRPd25lcihtc2cuc2VuZGVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRPd25lcihhZGRyZXNzIG93bmVyXykKICAgICAgICBwdWJsaWMKICAgICAgICBhdXRoCiAgICB7CiAgICAgICAgb3duZXIgPSBvd25lcl87CiAgICAgICAgTG9nU2V0T3duZXIob3duZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEF1dGhvcml0eShEU0F1dGhvcml0eSBhdXRob3JpdHlfKQogICAgICAgIHB1YmxpYwogICAgICAgIGF1dGgKICAgIHsKICAgICAgICBhdXRob3JpdHkgPSBhdXRob3JpdHlfOwogICAgICAgIExvZ1NldEF1dGhvcml0eShhdXRob3JpdHkpOwogICAgfQoKICAgIG1vZGlmaWVyIGF1dGggewogICAgICAgIHJlcXVpcmUoaXNBdXRob3JpemVkKG1zZy5zZW5kZXIsIG1zZy5zaWcpKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzQXV0aG9yaXplZChhZGRyZXNzIHNyYywgYnl0ZXM0IHNpZykgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYgKHNyYyA9PSBhZGRyZXNzKHRoaXMpKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSBpZiAoc3JjID09IG93bmVyKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSBpZiAoYXV0aG9yaXR5ID09IERTQXV0aG9yaXR5KDApKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gYXV0aG9yaXR5LmNhbkNhbGwoc3JjLCB0aGlzLCBzaWcpOwogICAgICAgIH0KICAgIH0KfQoKLy8vLy8vIGxpYi9kcy1yb2xlcy9zcmMvcm9sZXMuc29sCi8vIHJvbGVzLnNvbCAtIHJvbGVkIGJhc2VkIGF1dGhlbnRpY2F0aW9uCgovLyBDb3B5cmlnaHQgKEMpIDIwMTcgIERhcHBIdWIsIExMQwoKLy8gVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKLy8gaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKLy8gdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3IKLy8gKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KCi8vIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAovLyBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgovLyBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCi8vIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCgovLyBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQovLyBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KCi8qIHByYWdtYSBzb2xpZGl0eSBeMC40LjEzOyAqLwoKLyogaW1wb3J0ICdkcy1hdXRoL2F1dGguc29sJzsgKi8KCmNvbnRyYWN0IERTUm9sZXMgaXMgRFNBdXRoLCBEU0F1dGhvcml0eQp7CiAgICBtYXBwaW5nKGFkZHJlc3M9PmJvb2wpIF9yb290X3VzZXJzOwogICAgbWFwcGluZyhhZGRyZXNzPT5ieXRlczMyKSBfdXNlcl9yb2xlczsKICAgIG1hcHBpbmcoYWRkcmVzcz0+bWFwcGluZyhieXRlczQ9PmJ5dGVzMzIpKSBfY2FwYWJpbGl0eV9yb2xlczsKICAgIG1hcHBpbmcoYWRkcmVzcz0+bWFwcGluZyhieXRlczQ9PmJvb2wpKSBfcHVibGljX2NhcGFiaWxpdGllczsKCiAgICBmdW5jdGlvbiBnZXRVc2VyUm9sZXMoYWRkcmVzcyB3aG8pCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnMgKGJ5dGVzMzIpCiAgICB7CiAgICAgICAgcmV0dXJuIF91c2VyX3JvbGVzW3dob107CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0Q2FwYWJpbGl0eVJvbGVzKGFkZHJlc3MgY29kZSwgYnl0ZXM0IHNpZykKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyAoYnl0ZXMzMikKICAgIHsKICAgICAgICByZXR1cm4gX2NhcGFiaWxpdHlfcm9sZXNbY29kZV1bc2lnXTsKICAgIH0KCiAgICBmdW5jdGlvbiBpc1VzZXJSb290KGFkZHJlc3Mgd2hvKQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHJldHVybiBfcm9vdF91c2Vyc1t3aG9dOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzQ2FwYWJpbGl0eVB1YmxpYyhhZGRyZXNzIGNvZGUsIGJ5dGVzNCBzaWcpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmV0dXJuIF9wdWJsaWNfY2FwYWJpbGl0aWVzW2NvZGVdW3NpZ107CiAgICB9CgogICAgZnVuY3Rpb24gaGFzVXNlclJvbGUoYWRkcmVzcyB3aG8sIHVpbnQ4IHJvbGUpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgYnl0ZXMzMiByb2xlcyA9IGdldFVzZXJSb2xlcyh3aG8pOwogICAgICAgIGJ5dGVzMzIgc2hpZnRlZCA9IGJ5dGVzMzIodWludDI1Nih1aW50MjU2KDIpICoqIHVpbnQyNTYocm9sZSkpKTsKICAgICAgICByZXR1cm4gYnl0ZXMzMigwKSAhPSByb2xlcyAmIHNoaWZ0ZWQ7CiAgICB9CgogICAgZnVuY3Rpb24gY2FuQ2FsbChhZGRyZXNzIGNhbGxlciwgYWRkcmVzcyBjb2RlLCBieXRlczQgc2lnKQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIGlmKCBpc1VzZXJSb290KGNhbGxlcikgfHwgaXNDYXBhYmlsaXR5UHVibGljKGNvZGUsIHNpZykgKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZhciBoYXNfcm9sZXMgPSBnZXRVc2VyUm9sZXMoY2FsbGVyKTsKICAgICAgICAgICAgdmFyIG5lZWRzX29uZV9vZiA9IGdldENhcGFiaWxpdHlSb2xlcyhjb2RlLCBzaWcpOwogICAgICAgICAgICByZXR1cm4gYnl0ZXMzMigwKSAhPSBoYXNfcm9sZXMgJiBuZWVkc19vbmVfb2Y7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIEJJVE5PVChieXRlczMyIGlucHV0KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKGJ5dGVzMzIgb3V0cHV0KSB7CiAgICAgICAgcmV0dXJuIChpbnB1dCBeIGJ5dGVzMzIodWludCgtMSkpKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRSb290VXNlcihhZGRyZXNzIHdobywgYm9vbCBlbmFibGVkKQogICAgICAgIHB1YmxpYwogICAgICAgIGF1dGgKICAgIHsKICAgICAgICBfcm9vdF91c2Vyc1t3aG9dID0gZW5hYmxlZDsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRVc2VyUm9sZShhZGRyZXNzIHdobywgdWludDggcm9sZSwgYm9vbCBlbmFibGVkKQogICAgICAgIHB1YmxpYwogICAgICAgIGF1dGgKICAgIHsKICAgICAgICB2YXIgbGFzdF9yb2xlcyA9IF91c2VyX3JvbGVzW3dob107CiAgICAgICAgYnl0ZXMzMiBzaGlmdGVkID0gYnl0ZXMzMih1aW50MjU2KHVpbnQyNTYoMikgKiogdWludDI1Nihyb2xlKSkpOwogICAgICAgIGlmKCBlbmFibGVkICkgewogICAgICAgICAgICBfdXNlcl9yb2xlc1t3aG9dID0gbGFzdF9yb2xlcyB8IHNoaWZ0ZWQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3VzZXJfcm9sZXNbd2hvXSA9IGxhc3Rfcm9sZXMgJiBCSVROT1Qoc2hpZnRlZCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHNldFB1YmxpY0NhcGFiaWxpdHkoYWRkcmVzcyBjb2RlLCBieXRlczQgc2lnLCBib29sIGVuYWJsZWQpCiAgICAgICAgcHVibGljCiAgICAgICAgYXV0aAogICAgewogICAgICAgIF9wdWJsaWNfY2FwYWJpbGl0aWVzW2NvZGVdW3NpZ10gPSBlbmFibGVkOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFJvbGVDYXBhYmlsaXR5KHVpbnQ4IHJvbGUsIGFkZHJlc3MgY29kZSwgYnl0ZXM0IHNpZywgYm9vbCBlbmFibGVkKQogICAgICAgIHB1YmxpYwogICAgICAgIGF1dGgKICAgIHsKICAgICAgICB2YXIgbGFzdF9yb2xlcyA9IF9jYXBhYmlsaXR5X3JvbGVzW2NvZGVdW3NpZ107CiAgICAgICAgYnl0ZXMzMiBzaGlmdGVkID0gYnl0ZXMzMih1aW50MjU2KHVpbnQyNTYoMikgKiogdWludDI1Nihyb2xlKSkpOwogICAgICAgIGlmKCBlbmFibGVkICkgewogICAgICAgICAgICBfY2FwYWJpbGl0eV9yb2xlc1tjb2RlXVtzaWddID0gbGFzdF9yb2xlcyB8IHNoaWZ0ZWQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX2NhcGFiaWxpdHlfcm9sZXNbY29kZV1bc2lnXSA9IGxhc3Rfcm9sZXMgJiBCSVROT1Qoc2hpZnRlZCk7CiAgICAgICAgfQoKICAgIH0KCn0KCi8vLy8vLyBsaWIvZHMtdGhpbmcvbGliL2RzLW1hdGgvc3JjL21hdGguc29sCi8vLyBtYXRoLnNvbCAtLSBtaXhpbiBmb3IgaW5saW5lIG51bWVyaWNhbCB3aXphcmRyeQoKLy8gVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKLy8gaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKLy8gdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3IKLy8gKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KCi8vIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAovLyBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgovLyBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCi8vIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCgovLyBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQovLyBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KCi8qIHByYWdtYSBzb2xpZGl0eSBeMC40LjEzOyAqLwoKY29udHJhY3QgRFNNYXRoIHsKICAgIGZ1bmN0aW9uIGFkZCh1aW50IHgsIHVpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICByZXF1aXJlKCh6ID0geCArIHkpID49IHgpOwogICAgfQogICAgZnVuY3Rpb24gc3ViKHVpbnQgeCwgdWludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHJlcXVpcmUoKHogPSB4IC0geSkgPD0geCk7CiAgICB9CiAgICBmdW5jdGlvbiBtdWwodWludCB4LCB1aW50IHkpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCB6KSB7CiAgICAgICAgcmVxdWlyZSh5ID09IDAgfHwgKHogPSB4ICogeSkgLyB5ID09IHgpOwogICAgfQoKICAgIGZ1bmN0aW9uIG1pbih1aW50IHgsIHVpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICByZXR1cm4geCA8PSB5ID8geCA6IHk7CiAgICB9CiAgICBmdW5jdGlvbiBtYXgodWludCB4LCB1aW50IHkpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCB6KSB7CiAgICAgICAgcmV0dXJuIHggPj0geSA/IHggOiB5OwogICAgfQogICAgZnVuY3Rpb24gaW1pbihpbnQgeCwgaW50IHkpIGludGVybmFsIHB1cmUgcmV0dXJucyAoaW50IHopIHsKICAgICAgICByZXR1cm4geCA8PSB5ID8geCA6IHk7CiAgICB9CiAgICBmdW5jdGlvbiBpbWF4KGludCB4LCBpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChpbnQgeikgewogICAgICAgIHJldHVybiB4ID49IHkgPyB4IDogeTsKICAgIH0KCiAgICB1aW50IGNvbnN0YW50IFdBRCA9IDEwICoqIDE4OwogICAgdWludCBjb25zdGFudCBSQVkgPSAxMCAqKiAyNzsKCiAgICBmdW5jdGlvbiB3bXVsKHVpbnQgeCwgdWludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHogPSBhZGQobXVsKHgsIHkpLCBXQUQgLyAyKSAvIFdBRDsKICAgIH0KICAgIGZ1bmN0aW9uIHJtdWwodWludCB4LCB1aW50IHkpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCB6KSB7CiAgICAgICAgeiA9IGFkZChtdWwoeCwgeSksIFJBWSAvIDIpIC8gUkFZOwogICAgfQogICAgZnVuY3Rpb24gd2Rpdih1aW50IHgsIHVpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICB6ID0gYWRkKG11bCh4LCBXQUQpLCB5IC8gMikgLyB5OwogICAgfQogICAgZnVuY3Rpb24gcmRpdih1aW50IHgsIHVpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICB6ID0gYWRkKG11bCh4LCBSQVkpLCB5IC8gMikgLyB5OwogICAgfQoKICAgIC8vIFRoaXMgZmFtb3VzIGFsZ29yaXRobSBpcyBjYWxsZWQgImV4cG9uZW50aWF0aW9uIGJ5IHNxdWFyaW5nIgogICAgLy8gYW5kIGNhbGN1bGF0ZXMgeF5uIHdpdGggeCBhcyBmaXhlZC1wb2ludCBhbmQgbiBhcyByZWd1bGFyIHVuc2lnbmVkLgogICAgLy8KICAgIC8vIEl0J3MgTyhsb2cgbiksIGluc3RlYWQgb2YgTyhuKSBmb3IgbmFpdmUgcmVwZWF0ZWQgbXVsdGlwbGljYXRpb24uCiAgICAvLwogICAgLy8gVGhlc2UgZmFjdHMgYXJlIHdoeSBpdCB3b3JrczoKICAgIC8vCiAgICAvLyAgSWYgbiBpcyBldmVuLCB0aGVuIHhebiA9ICh4XjIpXihuLzIpLgogICAgLy8gIElmIG4gaXMgb2RkLCAgdGhlbiB4Xm4gPSB4ICogeF4obi0xKSwKICAgIC8vICAgYW5kIGFwcGx5aW5nIHRoZSBlcXVhdGlvbiBmb3IgZXZlbiB4IGdpdmVzCiAgICAvLyAgICB4Xm4gPSB4ICogKHheMileKChuLTEpIC8gMikuCiAgICAvLwogICAgLy8gIEFsc28sIEVWTSBkaXZpc2lvbiBpcyBmbG9vcmluZyBhbmQKICAgIC8vICAgIGZsb29yWyhuLTEpIC8gMl0gPSBmbG9vcltuIC8gMl0uCiAgICAvLwogICAgZnVuY3Rpb24gcnBvdyh1aW50IHgsIHVpbnQgbikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICB6ID0gbiAlIDIgIT0gMCA/IHggOiBSQVk7CgogICAgICAgIGZvciAobiAvPSAyOyBuICE9IDA7IG4gLz0gMikgewogICAgICAgICAgICB4ID0gcm11bCh4LCB4KTsKCiAgICAgICAgICAgIGlmIChuICUgMiAhPSAwKSB7CiAgICAgICAgICAgICAgICB6ID0gcm11bCh6LCB4KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKLy8vLy8vIGxpYi9kcy10aGluZy9saWIvZHMtbm90ZS9zcmMvbm90ZS5zb2wKLy8vIG5vdGUuc29sIC0tIHRoZSBgbm90ZScgbW9kaWZpZXIsIGZvciBsb2dnaW5nIGNhbGxzIGFzIGV2ZW50cwoKLy8gVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKLy8gaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKLy8gdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3IKLy8gKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KCi8vIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAovLyBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgovLyBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCi8vIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCgovLyBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQovLyBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KCi8qIHByYWdtYSBzb2xpZGl0eSBeMC40LjEzOyAqLwoKY29udHJhY3QgRFNOb3RlIHsKICAgIGV2ZW50IExvZ05vdGUoCiAgICAgICAgYnl0ZXM0ICAgaW5kZXhlZCAgc2lnLAogICAgICAgIGFkZHJlc3MgIGluZGV4ZWQgIGd1eSwKICAgICAgICBieXRlczMyICBpbmRleGVkICBmb28sCiAgICAgICAgYnl0ZXMzMiAgaW5kZXhlZCAgYmFyLAogICAgICAgIHVpbnQgICAgICAgICAgICAgIHdhZCwKICAgICAgICBieXRlcyAgICAgICAgICAgICBmYXgKICAgICkgYW5vbnltb3VzOwoKICAgIG1vZGlmaWVyIG5vdGUgewogICAgICAgIGJ5dGVzMzIgZm9vOwogICAgICAgIGJ5dGVzMzIgYmFyOwoKICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgIGZvbyA6PSBjYWxsZGF0YWxvYWQoNCkKICAgICAgICAgICAgYmFyIDo9IGNhbGxkYXRhbG9hZCgzNikKICAgICAgICB9CgogICAgICAgIExvZ05vdGUobXNnLnNpZywgbXNnLnNlbmRlciwgZm9vLCBiYXIsIG1zZy52YWx1ZSwgbXNnLmRhdGEpOwoKICAgICAgICBfOwogICAgfQp9CgovLy8vLy8gbGliL2RzLXRoaW5nL3NyYy90aGluZy5zb2wKLy8gdGhpbmcuc29sIC0gYGF1dGhgIHdpdGggaGFuZHkgbWl4aW5zLiB5b3VyIHRoaW5ncyBzaG91bGQgYmUgRFNUaGluZ3MKCi8vIENvcHlyaWdodCAoQykgMjAxNyAgRGFwcEh1YiwgTExDCgovLyBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQovLyBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQovLyB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcgovLyAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgoKLy8gVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCi8vIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCi8vIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKLy8gR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KCi8vIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCi8vIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgoKLyogcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7ICovCgovKiBpbXBvcnQgJ2RzLWF1dGgvYXV0aC5zb2wnOyAqLwovKiBpbXBvcnQgJ2RzLW5vdGUvbm90ZS5zb2wnOyAqLwovKiBpbXBvcnQgJ2RzLW1hdGgvbWF0aC5zb2wnOyAqLwoKY29udHJhY3QgRFNUaGluZyBpcyBEU0F1dGgsIERTTm90ZSwgRFNNYXRoIHsKCiAgICBmdW5jdGlvbiBTKHN0cmluZyBzKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKGJ5dGVzNCkgewogICAgICAgIHJldHVybiBieXRlczQoa2VjY2FrMjU2KHMpKTsKICAgIH0KCn0KCi8vLy8vLyBsaWIvZHMtdG9rZW4vbGliL2RzLXN0b3Avc3JjL3N0b3Auc29sCi8vLyBzdG9wLnNvbCAtLSBtaXhpbiBmb3IgZW5hYmxlL2Rpc2FibGUgZnVuY3Rpb25hbGl0eQoKLy8gQ29weXJpZ2h0IChDKSAyMDE3ICBEYXBwSHViLCBMTEMKCi8vIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5Ci8vIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5Ci8vIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCi8vIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgovLyBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKLy8gYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKLy8gTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQovLyBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgoKLy8gWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKLy8gYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0uICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCgovKiBwcmFnbWEgc29saWRpdHkgXjAuNC4xMzsgKi8KCi8qIGltcG9ydCAiZHMtYXV0aC9hdXRoLnNvbCI7ICovCi8qIGltcG9ydCAiZHMtbm90ZS9ub3RlLnNvbCI7ICovCgpjb250cmFjdCBEU1N0b3AgaXMgRFNOb3RlLCBEU0F1dGggewoKICAgIGJvb2wgcHVibGljIHN0b3BwZWQ7CgogICAgbW9kaWZpZXIgc3RvcHBhYmxlIHsKICAgICAgICByZXF1aXJlKCFzdG9wcGVkKTsKICAgICAgICBfOwogICAgfQogICAgZnVuY3Rpb24gc3RvcCgpIHB1YmxpYyBhdXRoIG5vdGUgewogICAgICAgIHN0b3BwZWQgPSB0cnVlOwogICAgfQogICAgZnVuY3Rpb24gc3RhcnQoKSBwdWJsaWMgYXV0aCBub3RlIHsKICAgICAgICBzdG9wcGVkID0gZmFsc2U7CiAgICB9Cgp9CgovLy8vLy8gbGliL2RzLXRva2VuL2xpYi9lcmMyMC9zcmMvZXJjMjAuc29sCi8vLyBlcmMyMC5zb2wgLS0gQVBJIGZvciB0aGUgRVJDMjAgdG9rZW4gc3RhbmRhcmQKCi8vIFNlZSA8aHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwPi4KCi8vIFRoaXMgZmlsZSBsaWtlbHkgZG9lcyBub3QgbWVldCB0aGUgdGhyZXNob2xkIG9mIG9yaWdpbmFsaXR5Ci8vIHJlcXVpcmVkIGZvciBjb3B5cmlnaHQgdG8gYXBwbHkuICBBcyBhIHJlc3VsdCwgdGhpcyBpcyBmcmVlIGFuZAovLyB1bmVuY3VtYmVyZWQgc29mdHdhcmUgYmVsb25naW5nIHRvIHRoZSBwdWJsaWMgZG9tYWluLgoKLyogcHJhZ21hIHNvbGlkaXR5IF4wLjQuODsgKi8KCmNvbnRyYWN0IEVSQzIwRXZlbnRzIHsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBzcmMsIGFkZHJlc3MgaW5kZXhlZCBndXksIHVpbnQgd2FkKTsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBzcmMsIGFkZHJlc3MgaW5kZXhlZCBkc3QsIHVpbnQgd2FkKTsKfQoKY29udHJhY3QgRVJDMjAgaXMgRVJDMjBFdmVudHMgewogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIGd1eSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCk7CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBzcmMsIGFkZHJlc3MgZ3V5KSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KTsKCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgZ3V5LCB1aW50IHdhZCkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBkc3QsIHVpbnQgd2FkKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oCiAgICAgICAgYWRkcmVzcyBzcmMsIGFkZHJlc3MgZHN0LCB1aW50IHdhZAogICAgKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7Cn0KCi8vLy8vLyBsaWIvZHMtdG9rZW4vc3JjL2Jhc2Uuc29sCi8vLyBiYXNlLnNvbCAtLSBiYXNpYyBFUkMyMCBpbXBsZW1lbnRhdGlvbgoKLy8gQ29weXJpZ2h0IChDKSAyMDE1LCAyMDE2LCAyMDE3ICBEYXBwSHViLCBMTEMKCi8vIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5Ci8vIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5Ci8vIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCi8vIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgovLyBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKLy8gYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKLy8gTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQovLyBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgoKLy8gWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKLy8gYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0uICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCgovKiBwcmFnbWEgc29saWRpdHkgXjAuNC4xMzsgKi8KCi8qIGltcG9ydCAiZXJjMjAvZXJjMjAuc29sIjsgKi8KLyogaW1wb3J0ICJkcy1tYXRoL21hdGguc29sIjsgKi8KCmNvbnRyYWN0IERTVG9rZW5CYXNlIGlzIEVSQzIwLCBEU01hdGggewogICAgdWludDI1NiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3N1cHBseTsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgICAgICAgICAgICAgICAgICAgICAgIF9iYWxhbmNlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgIF9hcHByb3ZhbHM7CgogICAgZnVuY3Rpb24gRFNUb2tlbkJhc2UodWludCBzdXBwbHkpIHB1YmxpYyB7CiAgICAgICAgX2JhbGFuY2VzW21zZy5zZW5kZXJdID0gc3VwcGx5OwogICAgICAgIF9zdXBwbHkgPSBzdXBwbHk7CiAgICB9CgogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIF9zdXBwbHk7CiAgICB9CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBzcmMpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gX2JhbGFuY2VzW3NyY107CiAgICB9CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBzcmMsIGFkZHJlc3MgZ3V5KSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIF9hcHByb3ZhbHNbc3JjXVtndXldOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgZHN0LCB1aW50IHdhZCkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gdHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIGRzdCwgd2FkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBzcmMsIGFkZHJlc3MgZHN0LCB1aW50IHdhZCkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIGlmIChzcmMgIT0gbXNnLnNlbmRlcikgewogICAgICAgICAgICBfYXBwcm92YWxzW3NyY11bbXNnLnNlbmRlcl0gPSBzdWIoX2FwcHJvdmFsc1tzcmNdW21zZy5zZW5kZXJdLCB3YWQpOwogICAgICAgIH0KCiAgICAgICAgX2JhbGFuY2VzW3NyY10gPSBzdWIoX2JhbGFuY2VzW3NyY10sIHdhZCk7CiAgICAgICAgX2JhbGFuY2VzW2RzdF0gPSBhZGQoX2JhbGFuY2VzW2RzdF0sIHdhZCk7CgogICAgICAgIFRyYW5zZmVyKHNyYywgZHN0LCB3YWQpOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgZ3V5LCB1aW50IHdhZCkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBfYXBwcm92YWxzW21zZy5zZW5kZXJdW2d1eV0gPSB3YWQ7CgogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIGd1eSwgd2FkKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0KCi8vLy8vLyBsaWIvZHMtdG9rZW4vc3JjL3Rva2VuLnNvbAovLy8gdG9rZW4uc29sIC0tIEVSQzIwIGltcGxlbWVudGF0aW9uIHdpdGggbWludGluZyBhbmQgYnVybmluZwoKLy8gQ29weXJpZ2h0IChDKSAyMDE1LCAyMDE2LCAyMDE3ICBEYXBwSHViLCBMTEMKCi8vIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5Ci8vIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5Ci8vIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCi8vIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgovLyBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKLy8gYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKLy8gTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQovLyBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgoKLy8gWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKLy8gYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0uICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCgovKiBwcmFnbWEgc29saWRpdHkgXjAuNC4xMzsgKi8KCi8qIGltcG9ydCAiZHMtc3RvcC9zdG9wLnNvbCI7ICovCgovKiBpbXBvcnQgIi4vYmFzZS5zb2wiOyAqLwoKY29udHJhY3QgRFNUb2tlbiBpcyBEU1Rva2VuQmFzZSgwKSwgRFNTdG9wIHsKCiAgICBieXRlczMyICBwdWJsaWMgIHN5bWJvbDsKICAgIHVpbnQyNTYgIHB1YmxpYyAgZGVjaW1hbHMgPSAxODsgLy8gc3RhbmRhcmQgdG9rZW4gcHJlY2lzaW9uLiBvdmVycmlkZSB0byBjdXN0b21pemUKCiAgICBmdW5jdGlvbiBEU1Rva2VuKGJ5dGVzMzIgc3ltYm9sXykgcHVibGljIHsKICAgICAgICBzeW1ib2wgPSBzeW1ib2xfOwogICAgfQoKICAgIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIGd1eSwgdWludCB3YWQpOwogICAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgZ3V5LCB1aW50IHdhZCk7CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIGd1eSkgcHVibGljIHN0b3BwYWJsZSByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLmFwcHJvdmUoZ3V5LCB1aW50KC0xKSk7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIGd1eSwgdWludCB3YWQpIHB1YmxpYyBzdG9wcGFibGUgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci5hcHByb3ZlKGd1eSwgd2FkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBzcmMsIGFkZHJlc3MgZHN0LCB1aW50IHdhZCkKICAgICAgICBwdWJsaWMKICAgICAgICBzdG9wcGFibGUKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIGlmIChzcmMgIT0gbXNnLnNlbmRlciAmJiBfYXBwcm92YWxzW3NyY11bbXNnLnNlbmRlcl0gIT0gdWludCgtMSkpIHsKICAgICAgICAgICAgX2FwcHJvdmFsc1tzcmNdW21zZy5zZW5kZXJdID0gc3ViKF9hcHByb3ZhbHNbc3JjXVttc2cuc2VuZGVyXSwgd2FkKTsKICAgICAgICB9CgogICAgICAgIF9iYWxhbmNlc1tzcmNdID0gc3ViKF9iYWxhbmNlc1tzcmNdLCB3YWQpOwogICAgICAgIF9iYWxhbmNlc1tkc3RdID0gYWRkKF9iYWxhbmNlc1tkc3RdLCB3YWQpOwoKICAgICAgICBUcmFuc2ZlcihzcmMsIGRzdCwgd2FkKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gcHVzaChhZGRyZXNzIGRzdCwgdWludCB3YWQpIHB1YmxpYyB7CiAgICAgICAgdHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIGRzdCwgd2FkKTsKICAgIH0KICAgIGZ1bmN0aW9uIHB1bGwoYWRkcmVzcyBzcmMsIHVpbnQgd2FkKSBwdWJsaWMgewogICAgICAgIHRyYW5zZmVyRnJvbShzcmMsIG1zZy5zZW5kZXIsIHdhZCk7CiAgICB9CiAgICBmdW5jdGlvbiBtb3ZlKGFkZHJlc3Mgc3JjLCBhZGRyZXNzIGRzdCwgdWludCB3YWQpIHB1YmxpYyB7CiAgICAgICAgdHJhbnNmZXJGcm9tKHNyYywgZHN0LCB3YWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIG1pbnQodWludCB3YWQpIHB1YmxpYyB7CiAgICAgICAgbWludChtc2cuc2VuZGVyLCB3YWQpOwogICAgfQogICAgZnVuY3Rpb24gYnVybih1aW50IHdhZCkgcHVibGljIHsKICAgICAgICBidXJuKG1zZy5zZW5kZXIsIHdhZCk7CiAgICB9CiAgICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgZ3V5LCB1aW50IHdhZCkgcHVibGljIGF1dGggc3RvcHBhYmxlIHsKICAgICAgICBfYmFsYW5jZXNbZ3V5XSA9IGFkZChfYmFsYW5jZXNbZ3V5XSwgd2FkKTsKICAgICAgICBfc3VwcGx5ID0gYWRkKF9zdXBwbHksIHdhZCk7CiAgICAgICAgTWludChndXksIHdhZCk7CiAgICB9CiAgICBmdW5jdGlvbiBidXJuKGFkZHJlc3MgZ3V5LCB1aW50IHdhZCkgcHVibGljIGF1dGggc3RvcHBhYmxlIHsKICAgICAgICBpZiAoZ3V5ICE9IG1zZy5zZW5kZXIgJiYgX2FwcHJvdmFsc1tndXldW21zZy5zZW5kZXJdICE9IHVpbnQoLTEpKSB7CiAgICAgICAgICAgIF9hcHByb3ZhbHNbZ3V5XVttc2cuc2VuZGVyXSA9IHN1YihfYXBwcm92YWxzW2d1eV1bbXNnLnNlbmRlcl0sIHdhZCk7CiAgICAgICAgfQoKICAgICAgICBfYmFsYW5jZXNbZ3V5XSA9IHN1YihfYmFsYW5jZXNbZ3V5XSwgd2FkKTsKICAgICAgICBfc3VwcGx5ID0gc3ViKF9zdXBwbHksIHdhZCk7CiAgICAgICAgQnVybihndXksIHdhZCk7CiAgICB9CgogICAgLy8gT3B0aW9uYWwgdG9rZW4gbmFtZQogICAgYnl0ZXMzMiAgIHB1YmxpYyAgbmFtZSA9ICIiOwoKICAgIGZ1bmN0aW9uIHNldE5hbWUoYnl0ZXMzMiBuYW1lXykgcHVibGljIGF1dGggewogICAgICAgIG5hbWUgPSBuYW1lXzsKICAgIH0KfQoKLy8vLy8vIHNyYy9jaGllZi5zb2wKLy8gY2hpZWYuc29sIC0gc2VsZWN0IGFuIGF1dGhvcml0eSBieSBjb25zZW5zdXMKCi8vIENvcHlyaWdodCAoQykgMjAxNyAgRGFwcEh1YiwgTExDCgovLyBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQovLyBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQovLyB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcgovLyAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgoKLy8gVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCi8vIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCi8vIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKLy8gR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KCi8vIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCi8vIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgoKLyogcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTc7ICovCgovKiBpbXBvcnQgJ2RzLXRva2VuL3Rva2VuLnNvbCc7ICovCi8qIGltcG9ydCAnZHMtcm9sZXMvcm9sZXMuc29sJzsgKi8KLyogaW1wb3J0ICdkcy10aGluZy90aGluZy5zb2wnOyAqLwoKLy8gVGhlIHJpZ2h0IHdheSB0byB1c2UgdGhpcyBjb250cmFjdCBpcyBwcm9iYWJseSB0byBtaXggaXQgd2l0aCBzb21lIGtpbmQKLy8gb2YgYERTQXV0aG9yaXR5YCwgbGlrZSB3aXRoIGBkcy1yb2xlc2AuCi8vICAgU0VFIERTQ2hpZWYKY29udHJhY3QgRFNDaGllZkFwcHJvdmFscyBpcyBEU1RoaW5nIHsKICAgIG1hcHBpbmcoYnl0ZXMzMj0+YWRkcmVzc1tdKSBwdWJsaWMgc2xhdGVzOwogICAgbWFwcGluZyhhZGRyZXNzPT5ieXRlczMyKSBwdWJsaWMgdm90ZXM7CiAgICBtYXBwaW5nKGFkZHJlc3M9PnVpbnQyNTYpIHB1YmxpYyBhcHByb3ZhbHM7CiAgICBtYXBwaW5nKGFkZHJlc3M9PnVpbnQyNTYpIHB1YmxpYyBkZXBvc2l0czsKICAgIERTVG9rZW4gcHVibGljIEdPVjsgLy8gdm90aW5nIHRva2VuIHRoYXQgZ2V0cyBsb2NrZWQgdXAKICAgIERTVG9rZW4gcHVibGljIElPVTsgLy8gbm9uLXZvdGluZyByZXByZXNlbnRhdGlvbiBvZiBhIHRva2VuLCBmb3IgZS5nLiBzZWNvbmRhcnkgdm90aW5nIG1lY2hhbmlzbXMKICAgIGFkZHJlc3MgcHVibGljIGhhdDsgLy8gdGhlIGNoaWVmdGFpbidzIGhhdAoKICAgIHVpbnQyNTYgcHVibGljIE1BWF9ZQVlTOwoKICAgIGV2ZW50IEV0Y2goYnl0ZXMzMiBpbmRleGVkIHNsYXRlKTsKCiAgICAvLyBJT1UgY29uc3RydWN0ZWQgb3V0c2lkZSB0aGlzIGNvbnRyYWN0IHJlZHVjZXMgZGVwbG95bWVudCBjb3N0cyBzaWduaWZpY2FudGx5CiAgICAvLyBsb2NrL2ZyZWUvdm90ZSBhcmUgcXVpdGUgc2Vuc2l0aXZlIHRvIHRva2VuIGludmFyaWFudHMuIENhdXRpb24gaXMgYWR2aXNlZC4KICAgIGZ1bmN0aW9uIERTQ2hpZWZBcHByb3ZhbHMoRFNUb2tlbiBHT1ZfLCBEU1Rva2VuIElPVV8sIHVpbnQgTUFYX1lBWVNfKSBwdWJsaWMKICAgIHsKICAgICAgICBHT1YgPSBHT1ZfOwogICAgICAgIElPVSA9IElPVV87CiAgICAgICAgTUFYX1lBWVMgPSBNQVhfWUFZU187CiAgICB9CgogICAgZnVuY3Rpb24gbG9jayh1aW50IHdhZCkKICAgICAgICBwdWJsaWMKICAgICAgICBub3RlCiAgICB7CiAgICAgICAgR09WLnB1bGwobXNnLnNlbmRlciwgd2FkKTsKICAgICAgICBJT1UubWludChtc2cuc2VuZGVyLCB3YWQpOwogICAgICAgIGRlcG9zaXRzW21zZy5zZW5kZXJdID0gYWRkKGRlcG9zaXRzW21zZy5zZW5kZXJdLCB3YWQpOwogICAgICAgIGFkZFdlaWdodCh3YWQsIHZvdGVzW21zZy5zZW5kZXJdKTsKICAgIH0KCiAgICBmdW5jdGlvbiBmcmVlKHVpbnQgd2FkKQogICAgICAgIHB1YmxpYwogICAgICAgIG5vdGUKICAgIHsKICAgICAgICBkZXBvc2l0c1ttc2cuc2VuZGVyXSA9IHN1YihkZXBvc2l0c1ttc2cuc2VuZGVyXSwgd2FkKTsKICAgICAgICBzdWJXZWlnaHQod2FkLCB2b3Rlc1ttc2cuc2VuZGVyXSk7CiAgICAgICAgSU9VLmJ1cm4obXNnLnNlbmRlciwgd2FkKTsKICAgICAgICBHT1YucHVzaChtc2cuc2VuZGVyLCB3YWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGV0Y2goYWRkcmVzc1tdIHlheXMpCiAgICAgICAgcHVibGljCiAgICAgICAgbm90ZQogICAgICAgIHJldHVybnMgKGJ5dGVzMzIgc2xhdGUpCiAgICB7CiAgICAgICAgcmVxdWlyZSggeWF5cy5sZW5ndGggPD0gTUFYX1lBWVMgKTsKICAgICAgICByZXF1aXJlQnl0ZU9yZGVyZWRTZXQoeWF5cyk7CgogICAgICAgIGJ5dGVzMzIgaGFzaCA9IGtlY2NhazI1Nih5YXlzKTsKICAgICAgICBzbGF0ZXNbaGFzaF0gPSB5YXlzOwogICAgICAgIEV0Y2goaGFzaCk7CiAgICAgICAgcmV0dXJuIGhhc2g7CiAgICB9CgogICAgZnVuY3Rpb24gdm90ZShhZGRyZXNzW10geWF5cykgcHVibGljIHJldHVybnMgKGJ5dGVzMzIpCiAgICAgICAgLy8gbm90ZSAgYm90aCBzdWItY2FsbHMgbm90ZQogICAgewogICAgICAgIHZhciBzbGF0ZSA9IGV0Y2goeWF5cyk7CiAgICAgICAgdm90ZShzbGF0ZSk7CiAgICAgICAgcmV0dXJuIHNsYXRlOwogICAgfQoKICAgIGZ1bmN0aW9uIHZvdGUoYnl0ZXMzMiBzbGF0ZSkKICAgICAgICBwdWJsaWMKICAgICAgICBub3RlCiAgICB7CiAgICAgICAgdWludCB3ZWlnaHQgPSBkZXBvc2l0c1ttc2cuc2VuZGVyXTsKICAgICAgICBzdWJXZWlnaHQod2VpZ2h0LCB2b3Rlc1ttc2cuc2VuZGVyXSk7CiAgICAgICAgdm90ZXNbbXNnLnNlbmRlcl0gPSBzbGF0ZTsKICAgICAgICBhZGRXZWlnaHQod2VpZ2h0LCB2b3Rlc1ttc2cuc2VuZGVyXSk7CiAgICB9CgogICAgLy8gbGlrZSBgZHJvcGAvYHN3YXBgIGV4Y2VwdCBzaW1wbHkgImVsZWN0IHRoaXMgYWRkcmVzcyBpZiBpdCBpcyBoaWdoZXIgdGhhbiBjdXJyZW50IGhhdCIKICAgIGZ1bmN0aW9uIGxpZnQoYWRkcmVzcyB3aG9tKQogICAgICAgIHB1YmxpYwogICAgICAgIG5vdGUKICAgIHsKICAgICAgICByZXF1aXJlKGFwcHJvdmFsc1t3aG9tXSA+IGFwcHJvdmFsc1toYXRdKTsKICAgICAgICBoYXQgPSB3aG9tOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZFdlaWdodCh1aW50IHdlaWdodCwgYnl0ZXMzMiBzbGF0ZSkKICAgICAgICBpbnRlcm5hbAogICAgewogICAgICAgIHZhciB5YXlzID0gc2xhdGVzW3NsYXRlXTsKICAgICAgICBmb3IoIHVpbnQgaSA9IDA7IGkgPCB5YXlzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGFwcHJvdmFsc1t5YXlzW2ldXSA9IGFkZChhcHByb3ZhbHNbeWF5c1tpXV0sIHdlaWdodCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHN1YldlaWdodCh1aW50IHdlaWdodCwgYnl0ZXMzMiBzbGF0ZSkKICAgICAgICBpbnRlcm5hbAogICAgewogICAgICAgIHZhciB5YXlzID0gc2xhdGVzW3NsYXRlXTsKICAgICAgICBmb3IoIHVpbnQgaSA9IDA7IGkgPCB5YXlzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGFwcHJvdmFsc1t5YXlzW2ldXSA9IHN1YihhcHByb3ZhbHNbeWF5c1tpXV0sIHdlaWdodCk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIFRocm93cyB1bmxlc3MgdGhlIGFycmF5IG9mIGFkZHJlc3NlcyBpcyBhIG9yZGVyZWQgc2V0LgogICAgZnVuY3Rpb24gcmVxdWlyZUJ5dGVPcmRlcmVkU2V0KGFkZHJlc3NbXSB5YXlzKQogICAgICAgIGludGVybmFsCiAgICAgICAgcHVyZQogICAgewogICAgICAgIGlmKCB5YXlzLmxlbmd0aCA9PSAwIHx8IHlheXMubGVuZ3RoID09IDEgKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgZm9yKCB1aW50IGkgPSAwOyBpIDwgeWF5cy5sZW5ndGggLSAxOyBpKysgKSB7CiAgICAgICAgICAgIC8vIHN0cmljdCBpbmVxdWFsaXR5IGVuc3VyZXMgYm90aCBvcmRlcmluZyBhbmQgdW5pcXVlbmVzcwogICAgICAgICAgICByZXF1aXJlKHVpbnQoYnl0ZXMzMih5YXlzW2ldKSkgPCB1aW50MjU2KGJ5dGVzMzIoeWF5c1tpKzFdKSkpOwogICAgICAgIH0KICAgIH0KfQoKCi8vIGBoYXRgIGFkZHJlc3MgaXMgdW5pcXVlIHJvb3QgdXNlciAoaGFzIGV2ZXJ5IHJvbGUpIGFuZCB0aGUKLy8gdW5pcXVlIG93bmVyIG9mIHJvbGUgMCAodHlwaWNhbGx5ICdzeXMnIG9yICdpbnRlcm5hbCcpCmNvbnRyYWN0IERTQ2hpZWYgaXMgRFNSb2xlcywgRFNDaGllZkFwcHJvdmFscyB7CgogICAgZnVuY3Rpb24gRFNDaGllZihEU1Rva2VuIEdPViwgRFNUb2tlbiBJT1UsIHVpbnQgTUFYX1lBWVMpCiAgICAgICAgICAgICBEU0NoaWVmQXBwcm92YWxzIChHT1YsIElPVSwgTUFYX1lBWVMpCiAgICAgICAgcHVibGljCiAgICB7CiAgICAgICAgYXV0aG9yaXR5ID0gdGhpczsKICAgICAgICBvd25lciA9IDA7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0T3duZXIoYWRkcmVzcyBvd25lcl8pIHB1YmxpYyB7CiAgICAgICAgb3duZXJfOwogICAgICAgIHJldmVydCgpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEF1dGhvcml0eShEU0F1dGhvcml0eSBhdXRob3JpdHlfKSBwdWJsaWMgewogICAgICAgIGF1dGhvcml0eV87CiAgICAgICAgcmV2ZXJ0KCk7CiAgICB9CgogICAgZnVuY3Rpb24gaXNVc2VyUm9vdChhZGRyZXNzIHdobykKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmV0dXJuICh3aG8gPT0gaGF0KTsKICAgIH0KICAgIGZ1bmN0aW9uIHNldFJvb3RVc2VyKGFkZHJlc3Mgd2hvLCBib29sIGVuYWJsZWQpIHB1YmxpYyB7CiAgICAgICAgd2hvOyBlbmFibGVkOwogICAgICAgIHJldmVydCgpOwogICAgfQp9Cgpjb250cmFjdCBEU0NoaWVmRmFiIHsKICAgIGZ1bmN0aW9uIG5ld0NoaWVmKERTVG9rZW4gZ292LCB1aW50IE1BWF9ZQVlTKSBwdWJsaWMgcmV0dXJucyAoRFNDaGllZiBjaGllZikgewogICAgICAgIERTVG9rZW4gaW91ID0gbmV3IERTVG9rZW4oJ0lPVScpOwogICAgICAgIGNoaWVmID0gbmV3IERTQ2hpZWYoZ292LCBpb3UsIE1BWF9ZQVlTKTsKICAgICAgICBpb3Uuc2V0T3duZXIoY2hpZWYpOwogICAgfQp9'.
	

]
