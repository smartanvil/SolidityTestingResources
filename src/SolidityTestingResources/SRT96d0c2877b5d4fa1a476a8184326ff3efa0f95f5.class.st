Class {
	#name : #SRT96d0c2877b5d4fa1a476a8184326ff3efa0f95f5,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT96d0c2877b5d4fa1a476a8184326ff3efa0f95f5 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7IC8vIHNvbGhpbnQtZGlzYWJsZS1saW5lCgpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGlmIChhID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgYXNzZXJ0KGIgPD0gYSk7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSk7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9Cn0KCmNvbnRyYWN0IEVSQzcyMSB7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklEKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7CiAgICBmdW5jdGlvbiBpbXBsZW1lbnRzRVJDNzIxKCkgcHVibGljIHB1cmUgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBvd25lck9mKHVpbnQyNTYgX3Rva2VuSUQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3MgYWRkcik7CiAgICBmdW5jdGlvbiB0YWtlT3duZXJzaGlwKHVpbnQyNTYgX3Rva2VuSUQpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiB0b3RhbCk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSUQpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklEKSBwdWJsaWM7CgogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB0b2tlbklEKTsgLy8gc29saGludC1kaXNhYmxlLWxpbmUKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIGFwcHJvdmVkLCB1aW50MjU2IHRva2VuSUQpOwoKICAgIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgcHVyZSByZXR1cm5zIChzdHJpbmcpOwogICAgZnVuY3Rpb24gc3ltYm9sKCkgcHVibGljIHB1cmUgcmV0dXJucyAoc3RyaW5nKTsKfQoKY29udHJhY3QgT3duYWJsZSB7CiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCiAgICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgIH0KfQoKY29udHJhY3QgTWFuYWdlYWJsZSBpcyBPd25hYmxlIHsKCiAgICBhZGRyZXNzIHB1YmxpYyBtYW5hZ2VyOwogICAgYm9vbCBwdWJsaWMgY29udHJhY3RMb2NrOwoKICAgIGV2ZW50IE1hbmFnZXJUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNNYW5hZ2VyLCBhZGRyZXNzIGluZGV4ZWQgbmV3TWFuYWdlcik7CiAgICBldmVudCBDb250cmFjdExvY2tDaGFuZ2VkKGFkZHJlc3MgYWRtaW4sIGJvb2wgc3RhdGUpOwoKICAgIGZ1bmN0aW9uIE1hbmFnZWFibGUoKSBwdWJsaWMgewogICAgICAgIG1hbmFnZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIGNvbnRyYWN0TG9jayA9IGZhbHNlOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlNYW5hZ2VyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBtYW5hZ2VyKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlBZG1pbigpIHsKICAgICAgICByZXF1aXJlKChtc2cuc2VuZGVyID09IG1hbmFnZXIpIHx8IChtc2cuc2VuZGVyID09IG93bmVyKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBpc1VubG9ja2VkKCkgewogICAgICAgIHJlcXVpcmUoIWNvbnRyYWN0TG9jayk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2Zlck1hbmFnZXIoYWRkcmVzcyBuZXdNYW5hZ2VyKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICByZXF1aXJlKG5ld01hbmFnZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgTWFuYWdlclRyYW5zZmVycmVkKG1hbmFnZXIsIG5ld01hbmFnZXIpOwogICAgICAgIG1hbmFnZXIgPSBuZXdNYW5hZ2VyOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldENvbnRyYWN0TG9jayhib29sIHNldHRpbmcpIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIGNvbnRyYWN0TG9jayA9IHNldHRpbmc7CiAgICAgICAgQ29udHJhY3RMb2NrQ2hhbmdlZChtc2cuc2VuZGVyLCBzZXR0aW5nKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwYXlvdXQoYWRkcmVzcyBfdG8pIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIGlmIChfdG8gPT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICBvd25lci50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90by50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiB3aXRoZHJhd0Z1bmRzKGFkZHJlc3MgX3RvLCB1aW50MjU2IGFtb3VudCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZSh0aGlzLmJhbGFuY2UgPj0gYW1vdW50KTsKICAgICAgICBpZiAoX3RvID09IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgb3duZXIudHJhbnNmZXIoYW1vdW50KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfdG8udHJhbnNmZXIoYW1vdW50KTsKICAgICAgICB9CiAgICB9Cn0KCmNvbnRyYWN0IFRva2VuTGF5ZXIgaXMgRVJDNzIxLCBNYW5hZ2VhYmxlIHsKCiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBFVkVOVFMgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAgIGV2ZW50IFRva2VuQ3JlYXRlZCh1aW50MjU2IHRva2VuSWQsIGJ5dGVzMzIgbmFtZSwgdWludDI1NiBwYXJlbnRJZCwgYWRkcmVzcyBvd25lcik7CiAgICBldmVudCBUb2tlbkRlbGV0ZWQodWludDI1NiB0b2tlbklkKTsKCiAgICBldmVudCBUb2tlblNvbGQoCiAgICAgICAgdWludDI1NiB0b2tlbklkLCB1aW50MjU2IG9sZFByaWNlLAogICAgICAgIHVpbnQyNTYgbmV3UHJpY2UsIGFkZHJlc3MgcHJldk93bmVyLAogICAgICAgIGFkZHJlc3Mgd2lubmVyLCBieXRlczMyIG5hbWUsCiAgICAgICAgdWludDI1NiBwYXJlbnRJZAogICAgKTsKCiAgICBldmVudCBQcmljZUNoYW5nZWQodWludDI1NiB0b2tlbklkLCB1aW50MjU2IG9sZFByaWNlLCB1aW50MjU2IG5ld1ByaWNlKTsKICAgIGV2ZW50IFBhcmVudENoYW5nZWQodWludDI1NiB0b2tlbklkLCB1aW50MjU2IG9sZFBhcmVudElkLCB1aW50MjU2IG5ld1BhcmVudElkKTsKICAgIGV2ZW50IE5hbWVDaGFuZ2VkKHVpbnQyNTYgdG9rZW5JZCwgYnl0ZXMzMiBvbGROYW1lLCBieXRlczMyIG5ld05hbWUpOwogICAgZXZlbnQgTWV0YURhdGFDaGFuZ2VkKHVpbnQyNTYgdG9rZW5JZCwgYnl0ZXMzMiBvbGRNZXRhLCBieXRlczMyIG5ld01ldGEpOwoKICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBTVE9SQUdFICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgdWludDI1NiBwcml2YXRlIGNvbnN0YW50IERFRkFVTFRQQVJFTlQgPSAxMjM0NTY3ODk7CgogICAgbWFwcGluZyAodWludDI1NiA9PiBUb2tlbikgICBwcml2YXRlIHRva2VuSW5kZXhUb1Rva2VuOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwcml2YXRlIG93bmVyc2hpcFRva2VuQ291bnQ7CgogICAgYWRkcmVzcyBwdWJsaWMgZ2FtZUFkZHJlc3M7CiAgICBhZGRyZXNzIHB1YmxpYyBwYXJlbnRBZGRyOwoKICAgIHVpbnQyNTYgcHJpdmF0ZSB0b3RhbFRva2VuczsKICAgIHVpbnQyNTYgcHVibGljIGRldkZlZSA9IDUwOwogICAgdWludDI1NiBwdWJsaWMgb3duZXJGZWUgPSAyMDA7CiAgICB1aW50MjU2WzEwXSBwcml2YXRlIGNoYWluRmVlcyA9IFsxMF07CgogICAgc3RydWN0IFRva2VuIHsKICAgICAgICBib29sIGV4aXN0czsKICAgICAgICBhZGRyZXNzIGFwcHJvdmVkOwogICAgICAgIGFkZHJlc3Mgb3duZXI7CiAgICAgICAgYnl0ZXMzMiBtZXRhZGF0YTsKICAgICAgICBieXRlczMyIG5hbWU7CiAgICAgICAgdWludDI1NiBsYXN0QmxvY2s7CiAgICAgICAgdWludDI1NiBwYXJlbnRJZDsKICAgICAgICB1aW50MjU2IHByaWNlOwogICAgfQoKICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIE1PRElGSUVSUyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgbW9kaWZpZXIgb25seVN5c3RlbSgpIHsKICAgICAgICByZXF1aXJlKChtc2cuc2VuZGVyID09IGdhbWVBZGRyZXNzKSB8fCAobXNnLnNlbmRlciA9PSBtYW5hZ2VyKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIENPTlNUUlVDVE9SICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAgIGZ1bmN0aW9uIFRva2VuTGF5ZXIoYWRkcmVzcyBfZ2FtZUFkZHJlc3MsIGFkZHJlc3MgX3BhcmVudEFkZHIpIHB1YmxpYyB7CiAgICAgICAgZ2FtZUFkZHJlc3MgPSBfZ2FtZUFkZHJlc3M7CiAgICAgICAgcGFyZW50QWRkciA9IF9wYXJlbnRBZGRyOwogICAgfQoKICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIFBVQkxJQyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgZnVuY3Rpb24gaW1wbGVtZW50c0VSQzcyMSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBuYW1lKCkgcHVibGljIHB1cmUgcmV0dXJucyAoc3RyaW5nKSB7CiAgICAgICAgcmV0dXJuICJDcnlwdG9KaW50b3JpIjsKICAgIH0KCiAgICBmdW5jdGlvbiBzeW1ib2woKSBwdWJsaWMgcHVyZSByZXR1cm5zIChzdHJpbmcpIHsKICAgICAgICByZXR1cm4gIlJlZ2lvblRva2VuIjsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkLCBhZGRyZXNzIF9mcm9tKSBwdWJsaWMgb25seVN5c3RlbSB7CiAgICAgICAgX2FwcHJvdmUoX3RvLCBfdG9rZW5JZCwgX2Zyb20pOwogICAgfQoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBpc1VubG9ja2VkIHsKICAgICAgICBfYXBwcm92ZShfdG8sIF90b2tlbklkLCBtc2cuc2VuZGVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgICAgIHJldHVybiBvd25lcnNoaXBUb2tlbkNvdW50W19vd25lcl07CiAgICB9CgogICAgZnVuY3Rpb24gYnVuZGxlVG9rZW4odWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50MjU2WzhdIF90b2tlbkRhdGEpIHsKICAgICAgICBUb2tlbiBzdG9yYWdlIHRva2VuID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdOwoKICAgICAgICB1aW50MjU2WzhdIG1lbW9yeSB0b2tlbkRhdGE7CgogICAgICAgIHRva2VuRGF0YVswXSA9IHVpbnQyNTYodG9rZW4ubmFtZSk7CiAgICAgICAgdG9rZW5EYXRhWzFdID0gdG9rZW4ucGFyZW50SWQ7CiAgICAgICAgdG9rZW5EYXRhWzJdID0gdG9rZW4ucHJpY2U7CiAgICAgICAgdG9rZW5EYXRhWzNdID0gdWludDI1Nih0b2tlbi5vd25lcik7CiAgICAgICAgdG9rZW5EYXRhWzRdID0gX2dldE5leHRQcmljZShfdG9rZW5JZCk7CiAgICAgICAgdG9rZW5EYXRhWzVdID0gZGV2RmVlK2dldENoYWluRmVlcyhfdG9rZW5JZCk7CiAgICAgICAgdG9rZW5EYXRhWzZdID0gdWludDI1Nih0b2tlbi5hcHByb3ZlZCk7CiAgICAgICAgdG9rZW5EYXRhWzddID0gdWludDI1Nih0b2tlbi5tZXRhZGF0YSk7CiAgICAgICAgcmV0dXJuIHRva2VuRGF0YTsKICAgIH0KCiAgICBmdW5jdGlvbiB0YWtlT3duZXJzaGlwKHVpbnQyNTYgX3Rva2VuSWQsIGFkZHJlc3MgX3RvKSBwdWJsaWMgb25seVN5c3RlbSB7CiAgICAgICAgX3Rha2VPd25lcnNoaXAoX3Rva2VuSWQsIF90byk7CiAgICB9CgogICAgZnVuY3Rpb24gdGFrZU93bmVyc2hpcCh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgaXNVbmxvY2tlZCB7CiAgICAgICAgX3Rha2VPd25lcnNoaXAoX3Rva2VuSWQsIG1zZy5zZW5kZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRva2Vuc09mT3duZXIoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTZbXSBvd25lclRva2VucykgewogICAgICAgIHVpbnQyNTYgdG9rZW5Db3VudCA9IGJhbGFuY2VPZihfb3duZXIpOwogICAgICAgIGlmICh0b2tlbkNvdW50ID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyB1aW50MjU2W10oMCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdWludDI1NltdIG1lbW9yeSByZXN1bHQgPSBuZXcgdWludDI1NltdKHRva2VuQ291bnQpOwogICAgICAgICAgICB1aW50MjU2IF90b3RhbFRva2VucyA9IHRvdGFsU3VwcGx5KCk7CiAgICAgICAgICAgIHVpbnQyNTYgcmVzdWx0SW5kZXggPSAwOwoKICAgICAgICAgICAgdWludDI1NiB0b2tlbklkID0gMDsKICAgICAgICAgICAgdWludDI1NiB0b2tlbkluZGV4ID0gMDsKICAgICAgICAgICAgd2hpbGUgKHRva2VuSW5kZXggPD0gX3RvdGFsVG9rZW5zKSB7CiAgICAgICAgICAgICAgICBpZiAoZXhpc3RzKHRva2VuSWQpKSB7CiAgICAgICAgICAgICAgICAgICAgdG9rZW5JbmRleCsrOwogICAgICAgICAgICAgICAgICAgIGlmICh0b2tlbkluZGV4VG9Ub2tlblt0b2tlbklkXS5vd25lciA9PSBfb3duZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3Jlc3VsdEluZGV4XSA9IHRva2VuSWQ7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdEluZGV4Kys7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdG9rZW5JZCsrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiB0b3RhbCkgewogICAgICAgIHJldHVybiB0b3RhbFRva2VuczsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIG9ubHlTeXN0ZW0gewogICAgICAgIF9jaGVja1RoZW5UcmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBpc1VubG9ja2VkIHsKICAgICAgICBfY2hlY2tUaGVuVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgb25seVN5c3RlbSB7CiAgICAgICAgX3RyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBpc1VubG9ja2VkIHsKICAgICAgICBfdHJhbnNmZXJGcm9tKF9mcm9tLCBtc2cuc2VuZGVyLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gY3JlYXRlVG9rZW4oCiAgICAgICAgdWludDI1NiBfdG9rZW5JZCwgYWRkcmVzcyBfb3duZXIsCiAgICAgICAgYnl0ZXMzMiBfbmFtZSwgdWludDI1NiBfcGFyZW50SWQsCiAgICAgICAgdWludDI1NiBfcHJpY2UsIGJ5dGVzMzIgX21ldGFkYXRhCiAgICApIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIHJlcXVpcmUoX3ByaWNlID4gMCk7CiAgICAgICAgcmVxdWlyZShfYWRkcmVzc05vdE51bGwoX293bmVyKSk7CiAgICAgICAgcmVxdWlyZShfdG9rZW5JZCA9PSB1aW50MjU2KHVpbnQzMihfdG9rZW5JZCkpKTsKICAgICAgICByZXF1aXJlKCFleGlzdHMoX3Rva2VuSWQpKTsKCiAgICAgICAgdG90YWxUb2tlbnMrKzsKCiAgICAgICAgVG9rZW4gbWVtb3J5IF90b2tlbiA9IFRva2VuKHsKICAgICAgICAgICAgbmFtZTogX25hbWUsCiAgICAgICAgICAgIHBhcmVudElkOiBfcGFyZW50SWQsCiAgICAgICAgICAgIGV4aXN0czogdHJ1ZSwKICAgICAgICAgICAgcHJpY2U6IF9wcmljZSwKICAgICAgICAgICAgb3duZXI6IF9vd25lciwKICAgICAgICAgICAgYXBwcm92ZWQgOiAwLAogICAgICAgICAgICBsYXN0QmxvY2sgOiBibG9jay5udW1iZXIsCiAgICAgICAgICAgIG1ldGFkYXRhIDogX21ldGFkYXRhCiAgICAgICAgfSk7CgogICAgICAgIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXSA9IF90b2tlbjsKCiAgICAgICAgVG9rZW5DcmVhdGVkKF90b2tlbklkLCBfbmFtZSwgX3BhcmVudElkLCBfb3duZXIpOwoKICAgICAgICBfdHJhbnNmZXIoYWRkcmVzcygwKSwgX293bmVyLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gY3JlYXRlVG9rZW5zKAogICAgICAgIHVpbnQyNTZbXSBfdG9rZW5JZHMsIGFkZHJlc3NbXSBfb3duZXJzLAogICAgICAgIGJ5dGVzMzJbXSBfbmFtZXMsIHVpbnQyNTZbXSBfcGFyZW50SWRzLAogICAgICAgIHVpbnQyNTZbXSBfcHJpY2VzLCBieXRlczMyW10gX21ldGFkYXRhcwogICAgKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICBmb3IgKHVpbnQyNTYgaWQgPSAwOyBpZCA8IF90b2tlbklkcy5sZW5ndGg7IGlkKyspIHsKICAgICAgICAgICAgY3JlYXRlVG9rZW4oCiAgICAgICAgICAgICAgICBfdG9rZW5JZHNbaWRdLCBfb3duZXJzW2lkXSwgX25hbWVzW2lkXSwKICAgICAgICAgICAgICAgIF9wYXJlbnRJZHNbaWRdLCBfcHJpY2VzW2lkXSwgX21ldGFkYXRhc1tpZF0KICAgICAgICAgICAgICAgICk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGRlbGV0ZVRva2VuKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIHJlcXVpcmUoX3Rva2VuSWQgPT0gdWludDI1Nih1aW50MzIoX3Rva2VuSWQpKSk7CiAgICAgICAgcmVxdWlyZShleGlzdHMoX3Rva2VuSWQpKTsKICAgICAgICB0b3RhbFRva2Vucy0tOwoKICAgICAgICBhZGRyZXNzIG9sZE93bmVyID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm93bmVyOwoKICAgICAgICBvd25lcnNoaXBUb2tlbkNvdW50W29sZE93bmVyXSA9IG93bmVyc2hpcFRva2VuQ291bnRbb2xkT3duZXJdLS07CiAgICAgICAgZGVsZXRlIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXTsKICAgICAgICBUb2tlbkRlbGV0ZWQoX3Rva2VuSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGluY3JlbWVudFByaWNlKHVpbnQyNTYgX3Rva2VuSWQsIGFkZHJlc3MgX3RvKSBwdWJsaWMgb25seVN5c3RlbSB7CiAgICAgICAgcmVxdWlyZShleGlzdHMoX3Rva2VuSWQpKTsKICAgICAgICB1aW50MjU2IF9wcmljZSA9IHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5wcmljZTsKICAgICAgICBhZGRyZXNzIF9vd25lciA9IHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5vd25lcjsKICAgICAgICB1aW50MjU2IF90b3RhbEZlZXMgPSBnZXRDaGFpbkZlZXMoX3Rva2VuSWQpOwogICAgICAgIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5wcmljZSA9IF9wcmljZS5tdWwoMTAwMCtvd25lckZlZSkuZGl2KDEwMDAtKGRldkZlZStfdG90YWxGZWVzKSk7CgogICAgICAgIFRva2VuU29sZCgKICAgICAgICAgICAgX3Rva2VuSWQsIF9wcmljZSwgdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLnByaWNlLAogICAgICAgICAgICBfb3duZXIsIF90bywgdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm5hbWUsCiAgICAgICAgICAgIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5wYXJlbnRJZAogICAgICAgICk7CiAgICB9CgogICAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzIF9vd25lcikgewogICAgICAgIHJlcXVpcmUoZXhpc3RzKF90b2tlbklkKSk7CiAgICAgICAgX293bmVyID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm93bmVyOwogICAgfQoKICAgIGZ1bmN0aW9uIGJsb2NrZWQodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCBfYmxvY2tlZCkgewogICAgICAgIHJldHVybiAodG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLmxhc3RCbG9jayA9PSBibG9jay5udW1iZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIGV4aXN0cyh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXR1cm4gKHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5leGlzdHMpOwogICAgfQoKICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgZnVuY3Rpb24gc2V0TGF5ZXJQYXJlbnQoYWRkcmVzcyBfcGFyZW50KSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICBwYXJlbnRBZGRyID0gX3BhcmVudDsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRHYW1lKGFkZHJlc3MgX2dhbWVBZGRyZXNzKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICBnYW1lQWRkcmVzcyA9IF9nYW1lQWRkcmVzczsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRQcmljZSh1aW50MjU2IF90b2tlbklkLCB1aW50MjU2IF9wcmljZSwgYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBvbmx5U3lzdGVtIHsKICAgICAgICByZXF1aXJlKF9vd25zKF9vd25lciwgX3Rva2VuSWQpKTsKICAgICAgICB1aW50MjU2IG9sZFByaWNlID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLnByaWNlOwogICAgICAgIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5wcmljZSA9IF9wcmljZTsKICAgICAgICBQcmljZUNoYW5nZWQoX3Rva2VuSWQsIG9sZFByaWNlLCBfcHJpY2UpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFBhcmVudCh1aW50MjU2IF90b2tlbklkLCB1aW50MjU2IF9wYXJlbnRJZCkgcHVibGljIG9ubHlBZG1pbiB7CiAgICAgICAgcmVxdWlyZShleGlzdHMoX3Rva2VuSWQpKTsKICAgICAgICB1aW50MjU2IG9sZFBhcmVudElkID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLnBhcmVudElkOwogICAgICAgIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5wYXJlbnRJZCA9IF9wYXJlbnRJZDsKICAgICAgICBQYXJlbnRDaGFuZ2VkKF90b2tlbklkLCBvbGRQYXJlbnRJZCwgX3BhcmVudElkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXROYW1lKHVpbnQyNTYgX3Rva2VuSWQsIGJ5dGVzMzIgX25hbWUpIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIHJlcXVpcmUoZXhpc3RzKF90b2tlbklkKSk7CiAgICAgICAgYnl0ZXMzMiBvbGROYW1lID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm5hbWU7CiAgICAgICAgdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm5hbWUgPSBfbmFtZTsKICAgICAgICBOYW1lQ2hhbmdlZChfdG9rZW5JZCwgb2xkTmFtZSwgX25hbWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldE1ldGFkYXRhKHVpbnQyNTYgX3Rva2VuSWQsIGJ5dGVzMzIgX21ldGFkYXRhKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICByZXF1aXJlKGV4aXN0cyhfdG9rZW5JZCkpOwogICAgICAgIGJ5dGVzMzIgb2xkTWV0YSA9IHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5tZXRhZGF0YTsKICAgICAgICB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ubWV0YWRhdGEgPSBfbWV0YWRhdGE7CiAgICAgICAgTWV0YURhdGFDaGFuZ2VkKF90b2tlbklkLCBvbGRNZXRhLCBfbWV0YWRhdGEpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldERldkZlZSh1aW50MjU2IF9kZXZGZWUpIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIGRldkZlZSA9IF9kZXZGZWU7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0T3duZXJGZWUodWludDI1NiBfb3duZXJGZWUpIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIG93bmVyRmVlID0gX293bmVyRmVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldENoYWluRmVlcyh1aW50MjU2WzEwXSBfY2hhaW5GZWVzKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICBjaGFpbkZlZXMgPSBfY2hhaW5GZWVzOwogICAgfQoKICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIEdFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgZnVuY3Rpb24gZ2V0VG9rZW4odWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucwogICAgKAogICAgICAgIGJ5dGVzMzIgdG9rZW5OYW1lLCB1aW50MjU2IHBhcmVudElkLCB1aW50MjU2IHByaWNlLAogICAgICAgIGFkZHJlc3MgX293bmVyLCB1aW50MjU2IG5leHRQcmljZSwgdWludDI1NiBuZXh0UHJpY2VGZWVzLAogICAgICAgIGFkZHJlc3MgYXBwcm92ZWQsIGJ5dGVzMzIgbWV0YWRhdGEKICAgICkgewogICAgICAgIFRva2VuIHN0b3JhZ2UgdG9rZW4gPSB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF07CgogICAgICAgIHRva2VuTmFtZSA9IHRva2VuLm5hbWU7CiAgICAgICAgcGFyZW50SWQgPSB0b2tlbi5wYXJlbnRJZDsKICAgICAgICBwcmljZSA9IHRva2VuLnByaWNlOwogICAgICAgIF9vd25lciA9IHRva2VuLm93bmVyOwogICAgICAgIG5leHRQcmljZSA9IF9nZXROZXh0UHJpY2UoX3Rva2VuSWQpOwogICAgICAgIG5leHRQcmljZUZlZXMgPSBkZXZGZWUrZ2V0Q2hhaW5GZWVzKF90b2tlbklkKTsKICAgICAgICBtZXRhZGF0YSA9IHRva2VuLm1ldGFkYXRhOwogICAgICAgIGFwcHJvdmVkID0gdG9rZW4uYXBwcm92ZWQ7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0Q2hhaW5GZWVzKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgX3RvdGFsKSB7CiAgICAgICAgdWludDI1NiBjaGFpbkxlbmd0aCA9IF9nZXRDaGFpbkxlbmd0aChfdG9rZW5JZCk7CiAgICAgICAgdWludDI1NiB0b3RhbEZlZSA9IDA7CiAgICAgICAgZm9yICh1aW50IGlkID0gMDsgaWQgPCBjaGFpbkxlbmd0aDsgaWQrKykgewogICAgICAgICAgICB0b3RhbEZlZSA9IHRvdGFsRmVlICsgY2hhaW5GZWVzW2lkXTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuKHRvdGFsRmVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRDaGFpbkZlZUFycmF5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NlsxMF0gbWVtb3J5IF9jaGFpbkZlZXMpIHsKICAgICAgICByZXR1cm4oY2hhaW5GZWVzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRQcmljZU9mKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgcHJpY2UpIHsKICAgICAgICByZXF1aXJlKGV4aXN0cyhfdG9rZW5JZCkpOwogICAgICAgIHJldHVybiB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ucHJpY2U7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0UGFyZW50T2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBwYXJlbnRJZCkgewogICAgICAgIHJlcXVpcmUoZXhpc3RzKF90b2tlbklkKSk7CiAgICAgICAgcmV0dXJuIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5wYXJlbnRJZDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRNZXRhZGF0YU9mKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJ5dGVzMzIgbWV0YWRhdGEpIHsKICAgICAgICByZXF1aXJlKGV4aXN0cyhfdG9rZW5JZCkpOwogICAgICAgIHJldHVybiAodG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm1ldGFkYXRhKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRDaGFpbih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzWzEwXSBtZW1vcnkgX293bmVycykgewogICAgICAgIHJlcXVpcmUoZXhpc3RzKF90b2tlbklkKSk7CgogICAgICAgIHVpbnQyNTYgX3BhcmVudElkID0gZ2V0UGFyZW50T2YoX3Rva2VuSWQpOwogICAgICAgIGFkZHJlc3MgX3BhcmVudEFkZHIgPSBwYXJlbnRBZGRyOwoKICAgICAgICBhZGRyZXNzWzEwXSBtZW1vcnkgcmVzdWx0OwoKICAgICAgICBpZiAoX3BhcmVudElkICE9IERFRkFVTFRQQVJFTlQgJiYgX2FkZHJlc3NOb3ROdWxsKF9wYXJlbnRBZGRyKSkgewogICAgICAgICAgICB1aW50MjU2IHJlc3VsdEluZGV4ID0gMDsKCiAgICAgICAgICAgIFRva2VuTGF5ZXIgbGF5ZXIgPSBUb2tlbkxheWVyKF9wYXJlbnRBZGRyKTsKICAgICAgICAgICAgYm9vbCBwYXJlbnRFeGlzdHMgPSBsYXllci5leGlzdHMoX3BhcmVudElkKTsKCiAgICAgICAgICAgIHdoaWxlICgoX3BhcmVudElkICE9IERFRkFVTFRQQVJFTlQpICYmIF9hZGRyZXNzTm90TnVsbChfcGFyZW50QWRkcikgJiYgcGFyZW50RXhpc3RzKSB7CiAgICAgICAgICAgICAgICBwYXJlbnRFeGlzdHMgPSBsYXllci5leGlzdHMoX3BhcmVudElkKTsKICAgICAgICAgICAgICAgIGlmICghcGFyZW50RXhpc3RzKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuKHJlc3VsdCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXN1bHRbcmVzdWx0SW5kZXhdID0gbGF5ZXIub3duZXJPZihfcGFyZW50SWQpOwogICAgICAgICAgICAgICAgcmVzdWx0SW5kZXgrKzsKCiAgICAgICAgICAgICAgICBfcGFyZW50SWQgPSBsYXllci5nZXRQYXJlbnRPZihfcGFyZW50SWQpOwogICAgICAgICAgICAgICAgX3BhcmVudEFkZHIgPSBsYXllci5wYXJlbnRBZGRyKCk7CgogICAgICAgICAgICAgICAgbGF5ZXIgPSBUb2tlbkxheWVyKF9wYXJlbnRBZGRyKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuKHJlc3VsdCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBQUklWQVRFICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgZnVuY3Rpb24gX2FkZHJlc3NOb3ROdWxsKGFkZHJlc3MgX3RvKSBwcml2YXRlIHB1cmUgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBfdG8gIT0gYWRkcmVzcygwKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfYXBwcm92ZWQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuICh0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0uYXBwcm92ZWQgPT0gX3RvKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfb3ducyhhZGRyZXNzIGNsYWltYW50LCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBjbGFpbWFudCA9PSB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ub3duZXI7CiAgICB9CgogICAgZnVuY3Rpb24gX2NoZWNrVGhlblRyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHsKICAgICAgICByZXF1aXJlKF9vd25zKF9mcm9tLCBfdG9rZW5JZCkpOwogICAgICAgIHJlcXVpcmUoX2FkZHJlc3NOb3ROdWxsKF90bykpOwogICAgICAgIHJlcXVpcmUoZXhpc3RzKF90b2tlbklkKSk7CiAgICAgICAgX3RyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfdHJhbnNmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgewogICAgICAgIG93bmVyc2hpcFRva2VuQ291bnRbX3RvXSsrOwogICAgICAgIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5vd25lciA9IF90bzsKICAgICAgICB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ubGFzdEJsb2NrID0gYmxvY2subnVtYmVyOwoKICAgICAgICBpZiAoX2Zyb20gIT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICBvd25lcnNoaXBUb2tlbkNvdW50W19mcm9tXS0tOwogICAgICAgICAgICB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0uYXBwcm92ZWQgPSAwOwogICAgICAgIH0KCiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIF9hcHByb3ZlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkLCBhZGRyZXNzIF9mcm9tKSBwcml2YXRlIHsKICAgICAgICByZXF1aXJlKF9vd25zKF9mcm9tLCBfdG9rZW5JZCkpOwoKICAgICAgICB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0uYXBwcm92ZWQgPSBfdG87CgogICAgICAgIEFwcHJvdmFsKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfdGFrZU93bmVyc2hpcCh1aW50MjU2IF90b2tlbklkLCBhZGRyZXNzIF90bykgcHJpdmF0ZSB7CiAgICAgICAgYWRkcmVzcyBuZXdPd25lciA9IF90bzsKICAgICAgICBhZGRyZXNzIG9sZE93bmVyID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm93bmVyOwoKICAgICAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChuZXdPd25lcikpOwogICAgICAgIHJlcXVpcmUoX2FwcHJvdmVkKG5ld093bmVyLCBfdG9rZW5JZCkpOwoKICAgICAgICBfdHJhbnNmZXIob2xkT3duZXIsIG5ld093bmVyLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gX3RyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB7CiAgICAgICAgcmVxdWlyZShfb3ducyhfZnJvbSwgX3Rva2VuSWQpKTsKICAgICAgICByZXF1aXJlKF9hcHByb3ZlZChfdG8sIF90b2tlbklkKSk7CiAgICAgICAgcmVxdWlyZShfYWRkcmVzc05vdE51bGwoX3RvKSk7CgogICAgICAgIF90cmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gX2dldENoYWluTGVuZ3RoKHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgdmlldyByZXR1cm5zICh1aW50MjU2IF9sZW5ndGgpIHsKICAgICAgICB1aW50MjU2IGxlbmd0aDsKCiAgICAgICAgdWludDI1NiBfcGFyZW50SWQgPSBnZXRQYXJlbnRPZihfdG9rZW5JZCk7CiAgICAgICAgYWRkcmVzcyBfcGFyZW50QWRkciA9IHBhcmVudEFkZHI7CiAgICAgICAgaWYgKF9wYXJlbnRJZCA9PSBERUZBVUxUUEFSRU5UIHx8ICFfYWRkcmVzc05vdE51bGwoX3BhcmVudEFkZHIpKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KCiAgICAgICAgVG9rZW5MYXllciBsYXllciA9IFRva2VuTGF5ZXIoX3BhcmVudEFkZHIpOwogICAgICAgIGJvb2wgcGFyZW50RXhpc3RzID0gbGF5ZXIuZXhpc3RzKF9wYXJlbnRJZCk7CgogICAgICAgIHdoaWxlICgoX3BhcmVudElkICE9IERFRkFVTFRQQVJFTlQpICYmIF9hZGRyZXNzTm90TnVsbChfcGFyZW50QWRkcikgJiYgcGFyZW50RXhpc3RzKSB7CiAgICAgICAgICAgIHBhcmVudEV4aXN0cyA9IGxheWVyLmV4aXN0cyhfcGFyZW50SWQpOwogICAgICAgICAgICBpZighcGFyZW50RXhpc3RzKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuKGxlbmd0aCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX3BhcmVudElkID0gbGF5ZXIuZ2V0UGFyZW50T2YoX3BhcmVudElkKTsKICAgICAgICAgICAgX3BhcmVudEFkZHIgPSBsYXllci5wYXJlbnRBZGRyKCk7CiAgICAgICAgICAgIGxheWVyID0gVG9rZW5MYXllcihfcGFyZW50QWRkcik7CiAgICAgICAgICAgIGxlbmd0aCsrOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuKGxlbmd0aCk7CiAgICB9CgogICAgZnVuY3Rpb24gX2dldE5leHRQcmljZSh1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHZpZXcgcmV0dXJucyAodWludDI1NiBfbmV4dFByaWNlKSB7CiAgICAgICAgdWludDI1NiBfcHJpY2UgPSB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ucHJpY2U7CiAgICAgICAgdWludDI1NiBfdG90YWxGZWVzID0gZ2V0Q2hhaW5GZWVzKF90b2tlbklkKTsKICAgICAgICBfcHJpY2UgPSBfcHJpY2UubXVsKDEwMDArb3duZXJGZWUpLmRpdigxMDAwLShkZXZGZWUrX3RvdGFsRmVlcykpOwogICAgICAgIHJldHVybihfcHJpY2UpOwogICAgfQp9'.
	

]
