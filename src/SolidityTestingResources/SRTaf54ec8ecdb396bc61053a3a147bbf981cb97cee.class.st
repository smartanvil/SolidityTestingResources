Class {
	#name : #SRTaf54ec8ecdb396bc61053a3a147bbf981cb97cee,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTaf54ec8ecdb396bc61053a3a147bbf981cb97cee >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CglmdW5jdGlvbiBtdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKCQl1aW50IGMgPSBhICogYjsKCQlhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwoJCXJldHVybiBjOwoJfQoJZnVuY3Rpb24gc2FmZVN1Yih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewoJCWFzc2VydChiIDw9IGEpOwoJCXJldHVybiBhIC0gYjsKCX0KCWZ1bmN0aW9uIGRpdih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewoJCWFzc2VydChiID4gMCk7CgkJdWludCBjID0gYSAvIGI7CgkJYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7CgkJcmV0dXJuIGM7Cgl9CglmdW5jdGlvbiBzdWIodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKCQlhc3NlcnQoYiA8PSBhKTsKCQlyZXR1cm4gYSAtIGI7Cgl9CglmdW5jdGlvbiBhZGQodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKCQl1aW50IGMgPSBhICsgYjsKCQlhc3NlcnQoYyA+PSBhKTsKCQlyZXR1cm4gYzsKCX0KCWZ1bmN0aW9uIG1heDY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7CgkJcmV0dXJuIGEgPj0gYiA/IGEgOiBiOwoJfQoJZnVuY3Rpb24gbWluNjQodWludDY0IGEsIHVpbnQ2NCBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50NjQpIHsKCQlyZXR1cm4gYSA8IGIgPyBhIDogYjsKCX0KCWZ1bmN0aW9uIG1heDI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewoJCXJldHVybiBhID49IGIgPyBhIDogYjsKCX0KCWZ1bmN0aW9uIG1pbjI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewoJCXJldHVybiBhIDwgYiA/IGEgOiBiOwoJfQoJZnVuY3Rpb24gYXNzZXJ0KGJvb2wgYXNzZXJ0aW9uKSBpbnRlcm5hbCB7CgkJaWYgKCFhc3NlcnRpb24pIHsKCQkJdGhyb3c7CgkJfQoJfQp9CgoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICBmdW5jdGlvbiBPd25hYmxlKCkgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KICAgIG1vZGlmaWVyIG9ubHlPd25lciB7CiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIpIHRocm93OwogICAgICAgIF87CiAgICB9CiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgewogICAgICAgIGlmIChuZXdPd25lciAhPSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICAgICAgfQogICAgfQp9CgoKLyoqCiAqIEB0aXRsZSBQYXVzYWJsZQogKiBAZGV2IEJhc2UgY29udHJhY3Qgd2hpY2ggYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uCiAqLwpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKCWJvb2wgcHVibGljIHN0b3BwZWQ7Cgltb2RpZmllciBzdG9wSW5FbWVyZ2VuY3kgewoJCWlmIChzdG9wcGVkKSB7CgkJCXRocm93OwoJCX0KCQlfOwoJfQoKCW1vZGlmaWVyIG9ubHlJbkVtZXJnZW5jeSB7CgkJaWYgKCFzdG9wcGVkKSB7CgkJICB0aHJvdzsKCQl9CglfOwoJfQoJLy8gY2FsbGVkIGJ5IHRoZSBvd25lciBvbiBlbWVyZ2VuY3ksIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUKCWZ1bmN0aW9uIGVtZXJnZW5jeVN0b3AoKSBleHRlcm5hbCBvbmx5T3duZXIgewoJCXN0b3BwZWQgPSB0cnVlOwoJfQoJLy8gY2FsbGVkIGJ5IHRoZSBvd25lciBvbiBlbmQgb2YgZW1lcmdlbmN5LCByZXR1cm5zIHRvIG5vcm1hbCBzdGF0ZQoJZnVuY3Rpb24gcmVsZWFzZSgpIGV4dGVybmFsIG9ubHlPd25lciBvbmx5SW5FbWVyZ2VuY3kgewoJCXN0b3BwZWQgPSBmYWxzZTsKCX0KfQoKCgovKioKICogQHRpdGxlIFB1bGxQYXltZW50CiAqIEBkZXYgQmFzZSBjb250cmFjdCBzdXBwb3J0aW5nIGFzeW5jIHNlbmQgZm9yIHB1bGwgcGF5bWVudHMuIEluaGVyaXQgZnJvbSB0aGlzCiAqIGNvbnRyYWN0IGFuZCB1c2UgYXN5bmNTZW5kIGluc3RlYWQgb2Ygc2VuZC4KICovCmNvbnRyYWN0IFB1bGxQYXltZW50IHsKCXVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwoKCW1hcHBpbmcoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgcGF5bWVudHM7CglldmVudCBMb2dSZWZ1bmRFVEgoYWRkcmVzcyB0bywgdWludCB2YWx1ZSk7CgkvKioKCSogIFN0b3JlIHNlbnQgYW1vdW50IGFzIGNyZWRpdCB0byBiZSBwdWxsZWQsIGNhbGxlZCBieSBwYXllciAKCSoqLwoJZnVuY3Rpb24gYXN5bmNTZW5kKGFkZHJlc3MgZGVzdCwgdWludCBhbW91bnQpIGludGVybmFsIHsKCQlwYXltZW50c1tkZXN0XSA9IHBheW1lbnRzW2Rlc3RdLmFkZChhbW91bnQpOwoJfQoJLy8gd2l0aGRyYXcgYWNjdW11bGF0ZWQgYmFsYW5jZSwgY2FsbGVkIGJ5IHBheWVlCglmdW5jdGlvbiB3aXRoZHJhd1BheW1lbnRzKCkgewoJCWFkZHJlc3MgcGF5ZWUgPSBtc2cuc2VuZGVyOwoJCXVpbnQgcGF5bWVudCA9IHBheW1lbnRzW3BheWVlXTsKCgkJaWYgKHBheW1lbnQgPT0gMCkgewoJCQl0aHJvdzsKCQl9CgkJaWYgKHRoaXMuYmFsYW5jZSA8IHBheW1lbnQpIHsKCQkgICAgdGhyb3c7CgkJfQoJCXBheW1lbnRzW3BheWVlXSA9IDA7CgkJaWYgKCFwYXllZS5zZW5kKHBheW1lbnQpKSB7CgkJICAgIHRocm93OwoJCX0KCQlMb2dSZWZ1bmRFVEgocGF5ZWUscGF5bWVudCk7Cgl9Cn0KCgoKLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5CiAqLwpjb250cmFjdCBFUkMyMEJhc2ljIHsKCXVpbnQgcHVibGljIHRvdGFsU3VwcGx5OwoJZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBjb25zdGFudCByZXR1cm5zICh1aW50KTsKCWZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQgdmFsdWUpOwoJZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSk7Cn0KCgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewoJZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCk7CglmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50IHZhbHVlKTsKCWZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50IHZhbHVlKTsKCWV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOwp9CgoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLiAKICovCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgCgl1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKCgltYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgYmFsYW5jZXM7CgoJLyoKCSogRml4IGZvciB0aGUgRVJDMjAgc2hvcnQgYWRkcmVzcyBhdHRhY2sgIAoJKi8KCW1vZGlmaWVyIG9ubHlQYXlsb2FkU2l6ZSh1aW50IHNpemUpIHsKCSAgIGlmKG1zZy5kYXRhLmxlbmd0aCA8IHNpemUgKyA0KSB7CgkgICAgIHRocm93OwoJICAgfQoJIF87Cgl9CglmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIG9ubHlQYXlsb2FkU2l6ZSgyICogMzIpIHsKCQliYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwoJCWJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwoJCVRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKCX0KCWZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKSB7CgkJcmV0dXJuIGJhbGFuY2VzW19vd25lcl07Cgl9Cn0KCgovKioKICogQHRpdGxlIFN0YW5kYXJkIEVSQzIwIHRva2VuCiAqCiAqIEBkZXYgSW1wbGVtZW50YXRpb24gb2YgdGhlIGJhc2ljIHN0YW5kYXJkIHRva2VuLgogKiBAZGV2IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgRmlyc3RCbG9vZDogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sCiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEJhc2ljVG9rZW4sIEVSQzIwIHsKCW1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSkgYWxsb3dlZDsKCWZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIG9ubHlQYXlsb2FkU2l6ZSgzICogMzIpIHsKCQl2YXIgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOwoJCWJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwoJCWJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKCQlhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7CgkJVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIH0KCWZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfdmFsdWUpIHsKCQlpZiAoKF92YWx1ZSAhPSAwKSAmJiAoYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gIT0gMCkpIHRocm93OwoJCWFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwoJCUFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwoJfQoJZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlbWFpbmluZykgewoJCXJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwoJfQp9CgoKLyoqCiAqICBEZXZ2b3RlIHRva2VucyBjb250cmFjdC4KICovCmNvbnRyYWN0IERldm90dGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKCQogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwogIAoKICAgIC8qKgogICAgICogVmFyaWFibGVzCiAgICAqLwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIkRFVlZPVEUiOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiVlZFIjsKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMDsKCiAgIAogICAgLyoqCiAgICAgKiBAZGV2IENvbnRyYWN0IGNvbnN0cnVjdG9yCiAgICAgKi8gCiAgICBmdW5jdGlvbiBEZXZvdHRlVG9rZW4oKSB7CiAgICB0b3RhbFN1cHBseSA9IDEwMDAwMDAwMDsKICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gdG90YWxTdXBwbHk7CiAgICB9CiAgICAKICAgIAogICAgLyoqCiAgICAqICBCdXJuIGF3YXkgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgQ2x1c3RlclRva2VuIHRva2Vucy4KICAgICogQHJldHVybiBSZXR1cm5zIHN1Y2Nlc3MgYm9vbGVhbi4KICAgICovCiAgICBmdW5jdGlvbiBidXJuKHVpbnQgX3ZhbHVlKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5zdWIoX3ZhbHVlKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCAweDAsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKfQoKCmNvbnRyYWN0IERldnZvdGVQcmVmdW5kIGlzIFBhdXNhYmxlLCBQdWxsUGF5bWVudCB7CiAgICAKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwogICAgCiAgICAKICAgIGVudW0gbWVtYmVyUmFua2luZyB7IEV4ZWN1dGl2ZSwgYm9hcmRNZW1iZXIsIEFjdGl2ZU1lbWJlciwgc3VwcG9ydGluZ01lbWJlciB9CiAgICBtZW1iZXJSYW5raW5nIHJhbmtpbmc7CgoKICAJc3RydWN0IEJhY2tlciB7CgkJdWludCB3ZWlSZWNlaXZlZDsKCQl1aW50IGNvaW5TZW50OwoJCW1lbWJlclJhbmtpbmcgdXNlclJhbms7Cgl9CgoJLyoKCSogQ29uc3RhbnRzCgkqLwoKCXVpbnQgcHVibGljIGNvbnN0YW50IE1JTl9DQVAgPSA1MDAwOyAvLyAKCXVpbnQgcHVibGljIGNvbnN0YW50IE1BWF9DQVAgPSAyNTAwMDA7IC8vIAoJCgkvKiBNaW5pbXVtIGFtb3VudCB0byBpbnZlc3QgKi8KCXVpbnQgcHVibGljIGNvbnN0YW50IE1JTl9JTlZFU1RfRVRIRVIgPSAxMDAgZmlubmV5OwoJdWludCBwdWJsaWMgY29uc3RhbnQgTUlOX0lOVkVTVF9CT0FSRCA9IDEwIGV0aGVyIDsKCXVpbnQgcHVibGljIGNvbnN0YW50IE1JTl9JTlZFU1RfQUNUSVZFID0gMyBldGhlcjsKCXVpbnQgcHVibGljIGNvbnN0YW50IE1JTl9JTlZFU1RfU1VQUE9SVCA9IDEwMCBmaW5uZXk7CgoJdWludCBwcml2YXRlIGNvbnN0YW50IERldnZvdGVQcmVmdW5kX1BFUklPRCA9IDMwIGRheXM7CgoJdWludCBwdWJsaWMgY29uc3RhbnQgQ09JTl9QRVJfRVRIRVIgPSAxMDAwOwoJdWludCBwdWJsaWMgY29uc3RhbnQgQ09JTl9QRVJfRVRIRVJfQk9BUkQgPSAyNTAwOwoJdWludCBwdWJsaWMgY29uc3RhbnQgQ09JTl9QRVJfRVRIRVJfQUNUSVZFID0gMTUwMDsKCXVpbnQgcHVibGljIGNvbnN0YW50IENPSU5fUEVSX0VUSEVSX1NVUFBPUlQgPSAxMDAwOwoKCgkvKgoJKiBWYXJpYWJsZXMKCSovCgoJRGV2b3R0ZVRva2VuIHB1YmxpYyBjb2luOwoJYWRkcmVzcyBwdWJsaWMgbXVsdGlzaWdFdGhlcjsKCXVpbnQgcHVibGljIGV0aGVyUmVjZWl2ZWQ7Cgl1aW50IHB1YmxpYyBjb2luU2VudFRvRXRoZXI7CgoJdWludCBwdWJsaWMgc3RhcnRUaW1lOwoJdWludCBwdWJsaWMgZW5kVGltZTsKCWJvb2wgcHVibGljIERldnZvdGVQcmVmdW5kQ2xvc2VkOwoKCS8qIEJhY2tlcnMgRXRoZXIgaW5kZXhlZCBieSB0aGVpciBFdGhlcmV1bSBhZGRyZXNzICovCgltYXBwaW5nKGFkZHJlc3MgPT4gQmFja2VyKSBwdWJsaWMgYmFja2VyczsKCgoJLyoKCSogTW9kaWZpZXJzCgkqLwoJbW9kaWZpZXIgbWluQ2FwTm90UmVhY2hlZCgpIHsKCQlpZiAoKG5vdyA8IGVuZFRpbWUpIHx8IGNvaW5TZW50VG9FdGhlciA+PSBNSU5fQ0FQICkgdGhyb3c7CgkJXzsKCX0KCgltb2RpZmllciByZXNwZWN0VGltZUZyYW1lKCkgewoJCWlmICgobm93IDwgc3RhcnRUaW1lKSB8fCAobm93ID4gZW5kVGltZSApKSB0aHJvdzsKCQlfOwoJfQoKCS8qCgkgKiBFdmVudAoJKi8KCWV2ZW50IExvZ1JlY2VpdmVkRVRIKGFkZHJlc3MgYWRkciwgdWludCB2YWx1ZSk7CglldmVudCBMb2dDb2luc0VtaXRlZChhZGRyZXNzIGluZGV4ZWQgZnJvbSwgdWludCBhbW91bnQpOwoKCS8qCgkgKiBDb25zdHJ1Y3RvcgoJKi8KCWZ1bmN0aW9uIERldnZvdGVQcmVmdW5kKGFkZHJlc3MgX2RldnZvdGVBZGRyZXNzLCBhZGRyZXNzIF90bykgewoJCWNvaW4gPSBEZXZvdHRlVG9rZW4oX2RldnZvdGVBZGRyZXNzKTsKCQltdWx0aXNpZ0V0aGVyID0gX3RvOwoJCXN0YXJ0KCk7Cgl9CgoJLyogCgkgKiBUaGUgZmFsbGJhY2sgZnVuY3Rpb24gY29ycmVzcG9uZHMgdG8gYSBkb25hdGlvbiBpbiBFVEgKCSAqLwoJZnVuY3Rpb24oKSBzdG9wSW5FbWVyZ2VuY3kgcmVzcGVjdFRpbWVGcmFtZSBwYXlhYmxlIHsKCQlyZWNlaXZlRVRIKG1zZy5zZW5kZXIpOwoJfQoKCS8qIAoJICogVG8gY2FsbCB0byBzdGFydCB0aGUgRGV2dm90ZVByZWZ1bmQKCSAqLwoJZnVuY3Rpb24gc3RhcnQoKSBvbmx5T3duZXIgewoJCWlmIChzdGFydFRpbWUgIT0gMCkgdGhyb3c7IC8vIERldnZvdGVQcmVmdW5kIHdhcyBhbHJlYWR5IHN0YXJ0ZWQKCgkJc3RhcnRUaW1lID0gbm93IDsgICAgICAgICAgICAKCQllbmRUaW1lID0gIG5vdyArIERldnZvdGVQcmVmdW5kX1BFUklPRDsgICAgCgl9CgoJLyoKCSAqCVJlY2VpdmVzIGEgZG9uYXRpb24gaW4gRXRoZXIKCSovCglmdW5jdGlvbiByZWNlaXZlRVRIKGFkZHJlc3MgYmVuZWZpY2lhcnkpIGludGVybmFsIHsKCSAgICAKCSAgICBtZW1iZXJSYW5raW5nIHNldFJhbms7CgkgICAgdWludCBjb2luVG9TZW5kOwoJICAgIAoJCWlmIChtc2cudmFsdWUgPCBNSU5fSU5WRVNUX0VUSEVSKSB0aHJvdzsgCgkJCgkJCgkJaWYgKG1zZy52YWx1ZSA8IE1JTl9JTlZFU1RfQUNUSVZFICYmIG1zZy52YWx1ZSA+PSBNSU5fSU5WRVNUX0VUSEVSICkgeyAKCQkgICAgc2V0UmFuayA9IG1lbWJlclJhbmtpbmcuc3VwcG9ydGluZ01lbWJlcjsKCQkgICAgY29pblRvU2VuZCA9IGJvbnVzKG1zZy52YWx1ZS5tdWwoQ09JTl9QRVJfRVRIRVJfU1VQUE9SVCkuZGl2KDEgZXRoZXIpKTsKCQl9CgkJaWYgKG1zZy52YWx1ZSA8IE1JTl9JTlZFU1RfQk9BUkQgICYmIG1zZy52YWx1ZSA+PSBNSU5fSU5WRVNUX0FDVElWRSkgewoJCSAgICBzZXRSYW5rID0gbWVtYmVyUmFua2luZy5BY3RpdmVNZW1iZXI7CgkJICAgIGNvaW5Ub1NlbmQgPSBib251cyhtc2cudmFsdWUubXVsKENPSU5fUEVSX0VUSEVSX0FDVElWRSkuZGl2KDEgZXRoZXIpKTsKCQl9CgkJaWYgKG1zZy52YWx1ZSA+PSBNSU5fSU5WRVNUX0JPQVJEICkgewoJCSAgICBzZXRSYW5rID0gbWVtYmVyUmFua2luZy5ib2FyZE1lbWJlcjsKCQkgICAgY29pblRvU2VuZCA9IGJvbnVzKG1zZy52YWx1ZS5tdWwoQ09JTl9QRVJfRVRIRVJfQk9BUkQpLmRpdigxIGV0aGVyKSk7CgkJfQoJCQoJCQoJCWlmIChjb2luVG9TZW5kLmFkZChjb2luU2VudFRvRXRoZXIpID4gTUFYX0NBUCkgdGhyb3c7CQoKCQlCYWNrZXIgYmFja2VyID0gYmFja2Vyc1tiZW5lZmljaWFyeV07CgkJY29pbi50cmFuc2ZlcihiZW5lZmljaWFyeSwgY29pblRvU2VuZCk7IAoJCWJhY2tlci5jb2luU2VudCA9IGJhY2tlci5jb2luU2VudC5hZGQoY29pblRvU2VuZCk7CgkJYmFja2VyLndlaVJlY2VpdmVkID0gYmFja2VyLndlaVJlY2VpdmVkLmFkZChtc2cudmFsdWUpOyAgICAKCQliYWNrZXIudXNlclJhbmsgPSBzZXRSYW5rOwoKCQlldGhlclJlY2VpdmVkID0gZXRoZXJSZWNlaXZlZC5hZGQobXNnLnZhbHVlKTsKCQljb2luU2VudFRvRXRoZXIgPSBjb2luU2VudFRvRXRoZXIuYWRkKGNvaW5Ub1NlbmQpOwoKCQlMb2dDb2luc0VtaXRlZChtc2cuc2VuZGVyICxjb2luVG9TZW5kKTsKCQlMb2dSZWNlaXZlZEVUSChiZW5lZmljaWFyeSwgZXRoZXJSZWNlaXZlZCk7IAoJfQoJCgoJLyoKCSAqQ29tcHV0ZSB0aGUgRGV2dm90ZSBib251cyBhY2NvcmRpbmcgdG8gdGhlIGludmVzdG1lbnQgcGVyaW9kCgkgKi8KCWZ1bmN0aW9uIGJvbnVzKHVpbnQgYW1vdW50KSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CgkJcmV0dXJuIGFtb3VudC5hZGQoYW1vdW50LmRpdig1KSk7ICAgLy8gYm9udXMgMjAlCgl9CgoJLyoJCgkgKiBGaW5hbGl6ZSB0aGUgRGV2dm90ZVByZWZ1bmQsIHNob3VsZCBiZSBjYWxsZWQgYWZ0ZXIgdGhlIHJlZnVuZCBwZXJpb2QKCSovCglmdW5jdGlvbiBmaW5hbGl6ZSgpIG9ubHlPd25lciBwdWJsaWMgewoKCQlpZiAobm93IDwgZW5kVGltZSkgeyAvLyBDYW5ub3QgZmluYWxpc2UgYmVmb3JlIERldnZvdGVQcmVmdW5kX1BFUklPRCBvciBiZWZvcmUgc2VsbGluZyBhbGwgY29pbnMKCQkJaWYgKGNvaW5TZW50VG9FdGhlciA9PSBNQVhfQ0FQKSB7CgkJCX0gZWxzZSB7CgkJCQl0aHJvdzsKCQkJfQoJCX0KCgkJaWYgKGNvaW5TZW50VG9FdGhlciA8IE1JTl9DQVAgJiYgbm93IDwgZW5kVGltZSArIDE1IGRheXMpIHRocm93OyAvLyBJZiBNSU5fQ0FQIGlzIG5vdCByZWFjaGVkIGRvbm9ycyBoYXZlIDE1ZGF5cyB0byBnZXQgcmVmdW5kIGJlZm9yZSB3ZSBjYW4gZmluYWxpc2UKCgkJaWYgKCFtdWx0aXNpZ0V0aGVyLnNlbmQodGhpcy5iYWxhbmNlKSkgdGhyb3c7IC8vIE1vdmUgdGhlIHJlbWFpbmluZyBFdGhlciB0byB0aGUgbXVsdGlzaWcgYWRkcmVzcwoJCQoJCXVpbnQgcmVtYWlucyA9IGNvaW4uYmFsYW5jZU9mKHRoaXMpOwoJCWlmIChyZW1haW5zID4gMCkgeyAvLyBCdXJuIHRoZSByZXN0IG9mIERldnZvdGVzCgkJCWlmICghY29pbi5idXJuKHJlbWFpbnMpKSB0aHJvdyA7CgkJfQoJCURldnZvdGVQcmVmdW5kQ2xvc2VkID0gdHJ1ZTsKCX0KCgkvKgkKCSogRmFpbHNhZmUgZHJhaW4KCSovCglmdW5jdGlvbiBkcmFpbigpIG9ubHlPd25lciB7CgkJaWYgKCFvd25lci5zZW5kKHRoaXMuYmFsYW5jZSkpIHRocm93OwoJfQoKCS8qKgoJICogQWxsb3cgdG8gY2hhbmdlIHRoZSB0ZWFtIG11bHRpc2lnIGFkZHJlc3MgaW4gdGhlIGNhc2Ugb2YgZW1lcmdlbmN5LgoJICovCglmdW5jdGlvbiBzZXRNdWx0aXNpZyhhZGRyZXNzIGFkZHIpIG9ubHlPd25lciBwdWJsaWMgewoJCWlmIChhZGRyID09IGFkZHJlc3MoMCkpIHRocm93OwoJCW11bHRpc2lnRXRoZXIgPSBhZGRyOwoJfQoKCS8qKgoJICogTWFudWFsbHkgYmFjayBEZXZ2b3RlIG93bmVyIGFkZHJlc3MuCgkgKi8KCWZ1bmN0aW9uIGJhY2tEZXZ2b3RlT3duZXIoKSBvbmx5T3duZXIgcHVibGljIHsKCQljb2luLnRyYW5zZmVyT3duZXJzaGlwKG93bmVyKTsKCX0KCgkvKioKCSAqIFRyYW5zZmVyIHJlbWFpbnMgdG8gb3duZXIgaW4gY2FzZSBpZiBpbXBvc3NpYmxlIHRvIGRvIG1pbiBpbnZlc3QKCSAqLwoJZnVuY3Rpb24gZ2V0UmVtYWluQ29pbnMoKSBvbmx5T3duZXIgcHVibGljIHsKCQl2YXIgcmVtYWlucyA9IE1BWF9DQVAgLSBjb2luU2VudFRvRXRoZXI7CgkJdWludCBtaW5Db2luc1RvU2VsbCA9IGJvbnVzKE1JTl9JTlZFU1RfRVRIRVIubXVsKENPSU5fUEVSX0VUSEVSKSAvICgxIGV0aGVyKSk7CgoJCWlmKHJlbWFpbnMgPiBtaW5Db2luc1RvU2VsbCkgdGhyb3c7CgoJCUJhY2tlciBiYWNrZXIgPSBiYWNrZXJzW293bmVyXTsKCQljb2luLnRyYW5zZmVyKG93bmVyLCByZW1haW5zKTsgLy8gVHJhbnNmZXIgRGV2dm90ZXMgcmlnaHQgbm93IAoKCQliYWNrZXIuY29pblNlbnQgPSBiYWNrZXIuY29pblNlbnQuYWRkKHJlbWFpbnMpOwoKCQljb2luU2VudFRvRXRoZXIgPSBjb2luU2VudFRvRXRoZXIuYWRkKHJlbWFpbnMpOwoKCQkvLyBTZW5kIGV2ZW50cwoJCUxvZ0NvaW5zRW1pdGVkKHRoaXMgLHJlbWFpbnMpOwoJCUxvZ1JlY2VpdmVkRVRIKG93bmVyLCBldGhlclJlY2VpdmVkKTsgCgl9CgoKCS8qIAogIAkgKiBXaGVuIE1JTl9DQVAgaXMgbm90IHJlYWNoOgogIAkgKiAxKSBiYWNrZXIgY2FsbCB0aGUgImFwcHJvdmUiIGZ1bmN0aW9uIG9mIHRoZSBEZXZ2b3RlIHRva2VuIGNvbnRyYWN0IHdpdGggdGhlIGFtb3VudCBvZiBhbGwgRGV2dm90ZXMgdGhleSBnb3QgaW4gb3JkZXIgdG8gYmUgcmVmdW5kCiAgCSAqIDIpIGJhY2tlciBjYWxsIHRoZSAicmVmdW5kIiBmdW5jdGlvbiBvZiB0aGUgRGV2dm90ZVByZWZ1bmQgY29udHJhY3Qgd2l0aCB0aGUgc2FtZSBhbW91bnQgb2YgRGV2dm90ZXMKICAgCSAqIDMpIGJhY2tlciBjYWxsIHRoZSAid2l0aGRyYXdQYXltZW50cyIgZnVuY3Rpb24gb2YgdGhlIERldnZvdGVQcmVmdW5kIGNvbnRyYWN0IHRvIGdldCBhIHJlZnVuZCBpbiBFVEgKICAgCSAqLwoJZnVuY3Rpb24gcmVmdW5kKHVpbnQgX3ZhbHVlKSBtaW5DYXBOb3RSZWFjaGVkIHB1YmxpYyB7CgkJCgkJaWYgKF92YWx1ZSAhPSBiYWNrZXJzW21zZy5zZW5kZXJdLmNvaW5TZW50KSB0aHJvdzsgLy8gY29tcGFyZSB2YWx1ZSBmcm9tIGJhY2tlciBiYWxhbmNlCgoJCWNvaW4udHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIGFkZHJlc3ModGhpcyksIF92YWx1ZSk7IC8vIGdldCB0aGUgdG9rZW4gYmFjayB0byB0aGUgRGV2dm90ZVByZWZ1bmQgY29udHJhY3QKCgkJaWYgKCFjb2luLmJ1cm4oX3ZhbHVlKSkgdGhyb3cgOyAvLyB0b2tlbiBzZW50IGZvciByZWZ1bmQgYXJlIGJ1cm50CgoJCXVpbnQgRVRIVG9TZW5kID0gYmFja2Vyc1ttc2cuc2VuZGVyXS53ZWlSZWNlaXZlZDsKCQliYWNrZXJzW21zZy5zZW5kZXJdLndlaVJlY2VpdmVkPTA7CgoJCWlmIChFVEhUb1NlbmQgPiAwKSB7CgkJCWFzeW5jU2VuZChtc2cuc2VuZGVyLCBFVEhUb1NlbmQpOyAvLyBwdWxsIHBheW1lbnQgdG8gZ2V0IHJlZnVuZCBpbiBFVEgKCQl9Cgl9Cgp9'.
	

]
