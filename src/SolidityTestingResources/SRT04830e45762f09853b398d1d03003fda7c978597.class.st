Class {
	#name : #SRT04830e45762f09853b398d1d03003fda7c978597,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT04830e45762f09853b398d1d03003fda7c978597 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7Cgpjb250cmFjdCBFUkMyMEJhc2ljIHsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9Cgpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHsKICAgIGlmIChuZXdPd25lciAhPSBhZGRyZXNzKDApKSB7CiAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICB9CiAgfQoKfQoKbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCmNvbnRyYWN0IENyb3dkc2FsZSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIC8vIFRoZSB0b2tlbiBiZWluZyBzb2xkCiAgTWludGFibGVUb2tlbiBwdWJsaWMgdG9rZW47CgogIC8vIHN0YXJ0IGFuZCBlbmQgYmxvY2sgd2hlcmUgaW52ZXN0bWVudHMgYXJlIGFsbG93ZWQgKGJvdGggaW5jbHVzaXZlKQogIHVpbnQyNTYgcHVibGljIHN0YXJ0QmxvY2s7CiAgdWludDI1NiBwdWJsaWMgZW5kQmxvY2s7CgogIC8vIGFkZHJlc3Mgd2hlcmUgZnVuZHMgYXJlIGNvbGxlY3RlZAogIGFkZHJlc3MgcHVibGljIHdhbGxldDsKCiAgLy8gaG93IG1hbnkgdG9rZW4gdW5pdHMgYSBidXllciBnZXRzIHBlciB3ZWkKICB1aW50MjU2IHB1YmxpYyByYXRlOwoKICAvLyBhbW91bnQgb2YgcmFpc2VkIG1vbmV5IGluIHdlaQogIHVpbnQyNTYgcHVibGljIHdlaVJhaXNlZDsKCiAgLyoqCiAgICogZXZlbnQgZm9yIHRva2VuIHB1cmNoYXNlIGxvZ2dpbmcKICAgKiBAcGFyYW0gcHVyY2hhc2VyIHdobyBwYWlkIGZvciB0aGUgdG9rZW5zCiAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IHdobyBnb3QgdGhlIHRva2VucwogICAqIEBwYXJhbSB2YWx1ZSB3ZWlzIHBhaWQgZm9yIHB1cmNoYXNlCiAgICogQHBhcmFtIGFtb3VudCBhbW91bnQgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAqLyAKICBldmVudCBUb2tlblB1cmNoYXNlKGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB2YWx1ZSwgdWludDI1NiBhbW91bnQpOwoKCiAgZnVuY3Rpb24gQ3Jvd2RzYWxlKHVpbnQyNTYgX3N0YXJ0QmxvY2ssIHVpbnQyNTYgX2VuZEJsb2NrLCB1aW50MjU2IF9yYXRlLCBhZGRyZXNzIF93YWxsZXQpIHsKICAgIHJlcXVpcmUoX3N0YXJ0QmxvY2sgPj0gYmxvY2subnVtYmVyKTsKICAgIHJlcXVpcmUoX2VuZEJsb2NrID49IF9zdGFydEJsb2NrKTsKICAgIHJlcXVpcmUoX3JhdGUgPiAwKTsKICAgIHJlcXVpcmUoX3dhbGxldCAhPSAweDApOwoKICAgIHRva2VuID0gY3JlYXRlVG9rZW5Db250cmFjdCgpOwogICAgc3RhcnRCbG9jayA9IF9zdGFydEJsb2NrOwogICAgZW5kQmxvY2sgPSBfZW5kQmxvY2s7CiAgICByYXRlID0gX3JhdGU7CiAgICB3YWxsZXQgPSBfd2FsbGV0OwogIH0KCiAgLy8gY3JlYXRlcyB0aGUgdG9rZW4gdG8gYmUgc29sZC4gCiAgLy8gb3ZlcnJpZGUgdGhpcyBtZXRob2QgdG8gaGF2ZSBjcm93ZHNhbGUgb2YgYSBzcGVjaWZpYyBtaW50YWJsZSB0b2tlbi4KICBmdW5jdGlvbiBjcmVhdGVUb2tlbkNvbnRyYWN0KCkgaW50ZXJuYWwgcmV0dXJucyAoTWludGFibGVUb2tlbikgewogICAgcmV0dXJuIG5ldyBNaW50YWJsZVRva2VuKCk7CiAgfQoKCiAgLy8gZmFsbGJhY2sgZnVuY3Rpb24gY2FuIGJlIHVzZWQgdG8gYnV5IHRva2VucwogIGZ1bmN0aW9uICgpIHBheWFibGUgewogICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwogIH0KCiAgLy8gbG93IGxldmVsIHRva2VuIHB1cmNoYXNlIGZ1bmN0aW9uCiAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnkpIHBheWFibGUgewogICAgcmVxdWlyZShiZW5lZmljaWFyeSAhPSAweDApOwogICAgcmVxdWlyZSh2YWxpZFB1cmNoYXNlKCkpOwoKICAgIHVpbnQyNTYgd2VpQW1vdW50ID0gbXNnLnZhbHVlOwoKICAgIC8vIGNhbGN1bGF0ZSB0b2tlbiBhbW91bnQgdG8gYmUgY3JlYXRlZAogICAgdWludDI1NiB0b2tlbnMgPSB3ZWlBbW91bnQubXVsKHJhdGUpOwoKICAgIC8vIHVwZGF0ZSBzdGF0ZQogICAgd2VpUmFpc2VkID0gd2VpUmFpc2VkLmFkZCh3ZWlBbW91bnQpOwoKICAgIHRva2VuLm1pbnQoYmVuZWZpY2lhcnksIHRva2Vucyk7CiAgICBUb2tlblB1cmNoYXNlKG1zZy5zZW5kZXIsIGJlbmVmaWNpYXJ5LCB3ZWlBbW91bnQsIHRva2Vucyk7CgogICAgZm9yd2FyZEZ1bmRzKCk7CiAgfQoKICAvLyBzZW5kIGV0aGVyIHRvIHRoZSBmdW5kIGNvbGxlY3Rpb24gd2FsbGV0CiAgLy8gb3ZlcnJpZGUgdG8gY3JlYXRlIGN1c3RvbSBmdW5kIGZvcndhcmRpbmcgbWVjaGFuaXNtcwogIGZ1bmN0aW9uIGZvcndhcmRGdW5kcygpIGludGVybmFsIHsKICAgIHdhbGxldC50cmFuc2Zlcihtc2cudmFsdWUpOwogIH0KCiAgLy8gQHJldHVybiB0cnVlIGlmIHRoZSB0cmFuc2FjdGlvbiBjYW4gYnV5IHRva2VucwogIGZ1bmN0aW9uIHZhbGlkUHVyY2hhc2UoKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICB1aW50MjU2IGN1cnJlbnQgPSBibG9jay5udW1iZXI7CiAgICBib29sIHdpdGhpblBlcmlvZCA9IGN1cnJlbnQgPj0gc3RhcnRCbG9jayAmJiBjdXJyZW50IDw9IGVuZEJsb2NrOwogICAgYm9vbCBub25aZXJvUHVyY2hhc2UgPSBtc2cudmFsdWUgIT0gMDsKICAgIHJldHVybiB3aXRoaW5QZXJpb2QgJiYgbm9uWmVyb1B1cmNoYXNlOwogIH0KCiAgLy8gQHJldHVybiB0cnVlIGlmIGNyb3dkc2FsZSBldmVudCBoYXMgZW5kZWQKICBmdW5jdGlvbiBoYXNFbmRlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gYmxvY2subnVtYmVyID4gZW5kQmxvY2s7CiAgfQoKCn0KCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgLyoqCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLiAKICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgKi8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKfQoKY29udHJhY3QgV2hpdGVsaXN0ZWRDcm93ZHNhbGUgaXMgQ3Jvd2RzYWxlLCBPd25hYmxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIC8vIGxpc3Qgb2YgYWRkcmVzc2VzIHRoYXQgY2FuIHB1cmNoYXNlIGJlZm9yZSBjcm93ZHNhbGUgb3BlbnMKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIHdoaXRlbGlzdDsKCiAgICBmdW5jdGlvbiBhZGRUb1doaXRlbGlzdChhZGRyZXNzIGJ1eWVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKGJ1eWVyICE9IDB4MCk7CiAgICAgICAgd2hpdGVsaXN0W2J1eWVyXSA9IHRydWU7IAogICAgfQoKICAgIC8vIEByZXR1cm4gdHJ1ZSBpZiBidXllciBpcyB3aGl0ZWxpc3RlZAogICAgZnVuY3Rpb24gaXNXaGl0ZWxpc3RlZChhZGRyZXNzIGJ1eWVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiB3aGl0ZWxpc3RbYnV5ZXJdOwogICAgfQoKICAgIC8vIG92ZXJyaWRpbmcgQ3Jvd2RzYWxlI3ZhbGlkUHVyY2hhc2UgdG8gYWRkIHdoaXRlbGlzdCBsb2dpYwogICAgLy8gQHJldHVybiB0cnVlIGlmIGJ1eWVycyBjYW4gYnV5IGF0IHRoZSBtb21lbnQKICAgIGZ1bmN0aW9uIHZhbGlkUHVyY2hhc2UoKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgLy8gW1RPRE9dIGlzc3VlIHdpdGggb3ZlcnJpZGluZyBhbmQgYXNzb2NpYXRpdml0eSBvZiBsb2dpY2FsIG9wZXJhdG9ycwogICAgICAgIHJldHVybiBzdXBlci52YWxpZFB1cmNoYXNlKCkgfHwgKCFoYXNFbmRlZCgpICYmIGlzV2hpdGVsaXN0ZWQobXNnLnNlbmRlcikpOyAKICAgIH0KCn0KCmNvbnRyYWN0IENvbnRpbnVvdXNTYWxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIC8vIHRpbWUgYnVja2V0IHNpemUKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IEJVQ0tFVF9TSVpFID0gMTIgaG91cnM7CgogICAgLy8gdGhlIHRva2VuIGJlaW5nIHNvbGQKICAgIE1pbnRhYmxlVG9rZW4gcHVibGljIHRva2VuOwoKICAgIC8vIGFkZHJlc3Mgd2hlcmUgZnVuZHMgYXJlIGNvbGxlY3RlZAogICAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0OwoKICAgIC8vIGFtb3VudCBvZiB0b2tlbnMgZW1pdHRlZCBwZXIgd2VpCiAgICB1aW50MjU2IHB1YmxpYyByYXRlOwoKICAgIC8vIGFtb3VudCBvZiByYWlzZWQgbW9uZXkgaW4gd2VpCiAgICB1aW50MjU2IHB1YmxpYyB3ZWlSYWlzZWQ7CgogICAgLy8gbWF4IGFtb3VudCBvZiB0b2tlbnMgdG8gbWludCBwZXIgdGltZSBidWNrZXQKICAgIHVpbnQyNTYgcHVibGljIGlzc3VhbmNlOwoKICAgIC8vIGxhc3QgdGltZSBidWNrZXQgZnJvbSB3aGljaCB0b2tlbnMgaGF2ZSBiZWVuIHB1cmNoYXNlZAogICAgdWludDI1NiBwdWJsaWMgbGFzdEJ1Y2tldCA9IDA7CgogICAgLy8gYW1vdW50IGlzc3VlZCBpbiB0aGUgbGFzdCBidWNrZXQKICAgIHVpbnQyNTYgcHVibGljIGJ1Y2tldEFtb3VudCA9IDA7CgogICAgZXZlbnQgVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgaW52ZXN0b3IsIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB3ZWlBbW91bnQsIHVpbnQyNTYgdG9rZW5zKTsKCiAgICBmdW5jdGlvbiBDb250aW51b3VzU2FsZSgKICAgICAgICB1aW50MjU2IF9yYXRlLAogICAgICAgIGFkZHJlc3MgX3dhbGxldCwKICAgICAgICBNaW50YWJsZVRva2VuIF90b2tlbgogICAgKSB7CiAgICAgICAgcmVxdWlyZShfcmF0ZSAhPSAwKTsKICAgICAgICByZXF1aXJlKF93YWxsZXQgIT0gMCk7CiAgICAgICAgLy8gcmVxdWlyZShhZGRyZXNzKHRva2VuKSAhPSAweDApOwoKICAgICAgICByYXRlID0gX3JhdGU7CiAgICAgICAgd2FsbGV0ID0gX3dhbGxldDsKICAgICAgICB0b2tlbiA9IF90b2tlbjsKICAgIH0KCiAgICBmdW5jdGlvbigpIHBheWFibGUgewogICAgICAgIGJ1eVRva2Vucyhtc2cuc2VuZGVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBidXlUb2tlbnMoYWRkcmVzcyBiZW5lZmljaWFyeSkgcHVibGljIHBheWFibGUgewogICAgICAgIHJlcXVpcmUoYmVuZWZpY2lhcnkgIT0gMHgwKTsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSAhPSAwKTsKCiAgICAgICAgcHJlcGFyZUNvbnRpbnVvdXNQdXJjaGFzZSgpOwogICAgICAgIHVpbnQyNTYgdG9rZW5zID0gcHJvY2Vzc1B1cmNoYXNlKGJlbmVmaWNpYXJ5KTsKICAgICAgICBjaGVja0NvbnRpbnVvdXNQdXJjaGFzZSh0b2tlbnMpOwogICAgfQoKICAgIGZ1bmN0aW9uIHByZXBhcmVDb250aW51b3VzUHVyY2hhc2UoKSBpbnRlcm5hbCB7CiAgICAgICAgdWludDI1NiB0aW1lc3RhbXAgPSBibG9jay50aW1lc3RhbXA7CiAgICAgICAgdWludDI1NiBidWNrZXQgPSB0aW1lc3RhbXAgLSAodGltZXN0YW1wICUgQlVDS0VUX1NJWkUpOwoKICAgICAgICBpZiAoYnVja2V0ID4gbGFzdEJ1Y2tldCkgewogICAgICAgICAgICBsYXN0QnVja2V0ID0gYnVja2V0OwogICAgICAgICAgICBidWNrZXRBbW91bnQgPSAwOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBjaGVja0NvbnRpbnVvdXNQdXJjaGFzZSh1aW50MjU2IHRva2VucykgaW50ZXJuYWwgewogICAgICAgIHVpbnQyNTYgdXBkYXRlZEJ1Y2tldEFtb3VudCA9IGJ1Y2tldEFtb3VudC5hZGQodG9rZW5zKTsKICAgICAgICByZXF1aXJlKHVwZGF0ZWRCdWNrZXRBbW91bnQgPD0gaXNzdWFuY2UpOwoKICAgICAgICBidWNrZXRBbW91bnQgPSB1cGRhdGVkQnVja2V0QW1vdW50OwogICAgfQoKICAgIGZ1bmN0aW9uIHByb2Nlc3NQdXJjaGFzZShhZGRyZXNzIGJlbmVmaWNpYXJ5KSBpbnRlcm5hbCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IHdlaUFtb3VudCA9IG1zZy52YWx1ZTsKCiAgICAgICAgLy8gY2FsY3VsYXRlIHRva2VuIGFtb3VudCB0byBiZSBjcmVhdGVkCiAgICAgICAgdWludDI1NiB0b2tlbnMgPSB3ZWlBbW91bnQubXVsKHJhdGUpOwoKICAgICAgICAvLyB1cGRhdGUgc3RhdGUKICAgICAgICB3ZWlSYWlzZWQgPSB3ZWlSYWlzZWQuYWRkKHdlaUFtb3VudCk7CgogICAgICAgIHRva2VuLm1pbnQoYmVuZWZpY2lhcnksIHRva2Vucyk7CiAgICAgICAgVG9rZW5QdXJjaGFzZShtc2cuc2VuZGVyLCBiZW5lZmljaWFyeSwgd2VpQW1vdW50LCB0b2tlbnMpOwoKICAgICAgICBmb3J3YXJkRnVuZHMoKTsKCiAgICAgICAgcmV0dXJuIHRva2VuczsKICAgIH0KCiAgICBmdW5jdGlvbiBmb3J3YXJkRnVuZHMoKSBpbnRlcm5hbCB7CiAgICAgICAgd2FsbGV0LnRyYW5zZmVyKG1zZy52YWx1ZSk7CiAgICB9Cn0KCmNvbnRyYWN0IENhcHBlZENyb3dkc2FsZSBpcyBDcm93ZHNhbGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICB1aW50MjU2IHB1YmxpYyBjYXA7CgogIGZ1bmN0aW9uIENhcHBlZENyb3dkc2FsZSh1aW50MjU2IF9jYXApIHsKICAgIHJlcXVpcmUoX2NhcCA+IDApOwogICAgY2FwID0gX2NhcDsKICB9CgogIC8vIG92ZXJyaWRpbmcgQ3Jvd2RzYWxlI3ZhbGlkUHVyY2hhc2UgdG8gYWRkIGV4dHJhIGNhcCBsb2dpYwogIC8vIEByZXR1cm4gdHJ1ZSBpZiBpbnZlc3RvcnMgY2FuIGJ1eSBhdCB0aGUgbW9tZW50CiAgZnVuY3Rpb24gdmFsaWRQdXJjaGFzZSgpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgIGJvb2wgd2l0aGluQ2FwID0gd2VpUmFpc2VkLmFkZChtc2cudmFsdWUpIDw9IGNhcDsKICAgIHJldHVybiBzdXBlci52YWxpZFB1cmNoYXNlKCkgJiYgd2l0aGluQ2FwOwogIH0KCiAgLy8gb3ZlcnJpZGluZyBDcm93ZHNhbGUjaGFzRW5kZWQgdG8gYWRkIGNhcCBsb2dpYwogIC8vIEByZXR1cm4gdHJ1ZSBpZiBjcm93ZHNhbGUgZXZlbnQgaGFzIGVuZGVkCiAgZnVuY3Rpb24gaGFzRW5kZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgYm9vbCBjYXBSZWFjaGVkID0gd2VpUmFpc2VkID49IGNhcDsKICAgIHJldHVybiBzdXBlci5oYXNFbmRlZCgpIHx8IGNhcFJlYWNoZWQ7CiAgfQoKfQoKY29udHJhY3QgTUFOQUNvbnRpbnVvdXNTYWxlIGlzIENvbnRpbnVvdXNTYWxlLCBPd25hYmxlIHsKCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBJTkZMQVRJT04gPSA4OwoKICAgIGJvb2wgcHVibGljIHN0YXJ0ZWQgPSBmYWxzZTsKCiAgICBldmVudCBSYXRlQ2hhbmdlKHVpbnQyNTYgYW1vdW50KTsKCiAgICBldmVudCBXYWxsZXRDaGFuZ2UoYWRkcmVzcyB3YWxsZXQpOwoKICAgIGZ1bmN0aW9uIE1BTkFDb250aW51b3VzU2FsZSgKICAgICAgICB1aW50MjU2IF9yYXRlLAogICAgICAgIGFkZHJlc3MgX3dhbGxldCwKICAgICAgICBNaW50YWJsZVRva2VuIF90b2tlbgogICAgKSBDb250aW51b3VzU2FsZShfcmF0ZSwgX3dhbGxldCwgX3Rva2VuKSB7CiAgICB9CgogICAgbW9kaWZpZXIgd2hlblN0YXJ0ZWQoKSB7CiAgICAgICAgcmVxdWlyZShzdGFydGVkKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHN0YXJ0KCkgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKCFzdGFydGVkKTsKCiAgICAgICAgLy8gaW5pdGlhbGl6ZSBpc3N1YW5jZQogICAgICAgIHVpbnQyNTYgZmluYWxTdXBwbHkgPSB0b2tlbi50b3RhbFN1cHBseSgpOwogICAgICAgIHVpbnQyNTYgYW5udWFsSXNzdWFuY2UgPSBmaW5hbFN1cHBseS5tdWwoSU5GTEFUSU9OKS5kaXYoMTAwKTsKICAgICAgICBpc3N1YW5jZSA9IGFubnVhbElzc3VhbmNlLm11bChCVUNLRVRfU0laRSkuZGl2KDEgeWVhcnMpOwoKICAgICAgICBzdGFydGVkID0gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBidXlUb2tlbnMoYWRkcmVzcyBiZW5lZmljaWFyeSkgd2hlblN0YXJ0ZWQgcHVibGljIHBheWFibGUgewogICAgICAgIHN1cGVyLmJ1eVRva2VucyhiZW5lZmljaWFyeSk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0V2FsbGV0KGFkZHJlc3MgX3dhbGxldCkgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKF93YWxsZXQgIT0gMHgwKTsKICAgICAgICB3YWxsZXQgPSBfd2FsbGV0OwogICAgICAgIFdhbGxldENoYW5nZShfd2FsbGV0KTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRSYXRlKHVpbnQyNTYgX3JhdGUpIG9ubHlPd25lciB7CiAgICAgICAgcmF0ZSA9IF9yYXRlOwogICAgICAgIFJhdGVDaGFuZ2UoX3JhdGUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHVucGF1c2VUb2tlbigpIG9ubHlPd25lciB7CiAgICAgICAgTUFOQVRva2VuKHRva2VuKS51bnBhdXNlKCk7CiAgICB9CgogICAgZnVuY3Rpb24gcGF1c2VUb2tlbigpIG9ubHlPd25lciB7CiAgICAgICAgTUFOQVRva2VuKHRva2VuKS5wYXVzZSgpOwogICAgfQp9Cgpjb250cmFjdCBGaW5hbGl6YWJsZUNyb3dkc2FsZSBpcyBDcm93ZHNhbGUsIE93bmFibGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBib29sIHB1YmxpYyBpc0ZpbmFsaXplZCA9IGZhbHNlOwoKICBldmVudCBGaW5hbGl6ZWQoKTsKCiAgLy8gc2hvdWxkIGJlIGNhbGxlZCBhZnRlciBjcm93ZHNhbGUgZW5kcywgdG8gZG8KICAvLyBzb21lIGV4dHJhIGZpbmFsaXphdGlvbiB3b3JrCiAgZnVuY3Rpb24gZmluYWxpemUoKSBvbmx5T3duZXIgewogICAgcmVxdWlyZSghaXNGaW5hbGl6ZWQpOwogICAgcmVxdWlyZShoYXNFbmRlZCgpKTsKCiAgICBmaW5hbGl6YXRpb24oKTsKICAgIEZpbmFsaXplZCgpOwogICAgCiAgICBpc0ZpbmFsaXplZCA9IHRydWU7CiAgfQoKICAvLyBlbmQgdG9rZW4gbWludGluZyBvbiBmaW5hbGl6YXRpb24KICAvLyBvdmVycmlkZSB0aGlzIHdpdGggY3VzdG9tIGxvZ2ljIGlmIG5lZWRlZAogIGZ1bmN0aW9uIGZpbmFsaXphdGlvbigpIGludGVybmFsIHsKICAgIHRva2VuLmZpbmlzaE1pbnRpbmcoKTsKICB9CgoKCn0KCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CgoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91dCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJlZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsKICAgIHZhciBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07CgogICAgLy8gQ2hlY2sgaXMgbm90IG5lZWRlZCBiZWNhdXNlIHN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0CiAgICAvLyByZXF1aXJlIChfdmFsdWUgPD0gX2FsbG93YW5jZSk7CgogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsKCiAgICAvLyBUbyBjaGFuZ2UgdGhlIGFwcHJvdmUgYW1vdW50IHlvdSBmaXJzdCBoYXZlIHRvIHJlZHVjZSB0aGUgYWRkcmVzc2VzYAogICAgLy8gIGFsbG93YW5jZSB0byB6ZXJvIGJ5IGNhbGxpbmcgYGFwcHJvdmUoX3NwZW5kZXIsIDApYCBpZiBpdCBpcyBub3QKICAgIC8vICBhbHJlYWR5IDAgdG8gbWl0aWdhdGUgdGhlIHJhY2UgY29uZGl0aW9uIGRlc2NyaWJlZCBoZXJlOgogICAgLy8gIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICByZXF1aXJlKChfdmFsdWUgPT0gMCkgfHwgKGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID09IDApKTsKCiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZmluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpYmxlIGZvciB0aGUgc3BlbmRlci4KICAgKi8KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9Cgp9Cgpjb250cmFjdCBCdXJuYWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4gewoKICAgIGV2ZW50IEJ1cm4oYWRkcmVzcyBpbmRleGVkIGJ1cm5lciwgdWludDI1NiB2YWx1ZSk7CgogICAgLyoqCiAgICAgKiBAZGV2IEJ1cm5zIGEgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMuCiAgICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJ1cm4uIAogICAgICovCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX3ZhbHVlID4gMCk7CgogICAgICAgIGFkZHJlc3MgYnVybmVyID0gbXNnLnNlbmRlcjsKICAgICAgICBiYWxhbmNlc1tidXJuZXJdID0gYmFsYW5jZXNbYnVybmVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LnN1YihfdmFsdWUpOwogICAgICAgIEJ1cm4obXNnLnNlbmRlciwgX3ZhbHVlKTsKICAgIH0KCn0KCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgewogIGV2ZW50IFBhdXNlKCk7CiAgZXZlbnQgVW5wYXVzZSgpOwoKICBib29sIHB1YmxpYyBwYXVzZWQgPSBmYWxzZTsKCgogIC8qKgogICAqIEBkZXYgbW9kaWZpZXIgdG8gYWxsb3cgYWN0aW9ucyBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IElTIHBhdXNlZAogICAqLwogIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICByZXF1aXJlKCFwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgbW9kaWZpZXIgdG8gYWxsb3cgYWN0aW9ucyBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IElTIE5PVCBwYXVzZWQKICAgKi8KICBtb2RpZmllciB3aGVuUGF1c2VkIHsKICAgIHJlcXVpcmUocGF1c2VkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gcGF1c2UsIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUKICAgKi8KICBmdW5jdGlvbiBwYXVzZSgpIG9ubHlPd25lciB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wpIHsKICAgIHBhdXNlZCA9IHRydWU7CiAgICBQYXVzZSgpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gdW5wYXVzZSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgKi8KICBmdW5jdGlvbiB1bnBhdXNlKCkgb25seU93bmVyIHdoZW5QYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcGF1c2VkID0gZmFsc2U7CiAgICBVbnBhdXNlKCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCmNvbnRyYWN0IFBhdXNhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgUGF1c2FibGUgewoKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogIH0KfQoKY29udHJhY3QgTWludGFibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwogIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwoKICBib29sIHB1YmxpYyBtaW50aW5nRmluaXNoZWQgPSBmYWxzZTsKCgogIG1vZGlmaWVyIGNhbk1pbnQoKSB7CiAgICByZXF1aXJlKCFtaW50aW5nRmluaXNoZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gbWludCB0b2tlbnMKICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCByZWNpZXZlIHRoZSBtaW50ZWQgdG9rZW5zLgogICAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIG1pbnQuCiAgICogQHJldHVybiBBIGJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIG9ubHlPd25lciBjYW5NaW50IHJldHVybnMgKGJvb2wpIHsKICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKF9hbW91bnQpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF9hbW91bnQpOwogICAgTWludChfdG8sIF9hbW91bnQpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHN0b3AgbWludGluZyBuZXcgdG9rZW5zLgogICAqIEByZXR1cm4gVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgIE1pbnRGaW5pc2hlZCgpOwogICAgcmV0dXJuIHRydWU7CiAgfQp9Cgpjb250cmFjdCBNQU5BVG9rZW4gaXMgQnVybmFibGVUb2tlbiwgUGF1c2FibGVUb2tlbiwgTWludGFibGVUb2tlbiB7CgogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiTUFOQSI7CgogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIkRlY2VudHJhbGFuZCBNQU5BIjsKCiAgICB1aW50OCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSB3aGVuTm90UGF1c2VkIHB1YmxpYyB7CiAgICAgICAgc3VwZXIuYnVybihfdmFsdWUpOwogICAgfQp9Cgpjb250cmFjdCBNQU5BQ3Jvd2RzYWxlIGlzIFdoaXRlbGlzdGVkQ3Jvd2RzYWxlLCBDYXBwZWRDcm93ZHNhbGUsIEZpbmFsaXphYmxlQ3Jvd2RzYWxlIHsKCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBUT1RBTF9TSEFSRSA9IDEwMDsKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IENST1dEU0FMRV9TSEFSRSA9IDQwOwogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgRk9VTkRBVElPTl9TSEFSRSA9IDYwOwoKICAgIC8vIHByaWNlIGF0IHdoaWNoIHdoaXRlbGlzdGVkIGJ1eWVycyB3aWxsIGJlIGFibGUgdG8gYnV5IHRva2VucwogICAgdWludDI1NiBwdWJsaWMgcHJlZmVyZW50aWFsUmF0ZTsKCiAgICAvLyBjdXN0b21pemUgdGhlIHJhdGUgZm9yIGVhY2ggd2hpdGVsaXN0ZWQgYnV5ZXIKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGJ1eWVyUmF0ZTsKCiAgICAvLyBpbml0aWFsIHJhdGUgYXQgd2hpY2ggdG9rZW5zIGFyZSBvZmZlcmVkCiAgICB1aW50MjU2IHB1YmxpYyBpbml0aWFsUmF0ZTsKCiAgICAvLyBlbmQgcmF0ZSBhdCB3aGljaCB0b2tlbnMgYXJlIG9mZmVyZWQKICAgIHVpbnQyNTYgcHVibGljIGVuZFJhdGU7CgogICAgLy8gY29udGludW91cyBjcm93ZHNhbGUgY29udHJhY3QKICAgIE1BTkFDb250aW51b3VzU2FsZSBwdWJsaWMgY29udGludW91c1NhbGU7CgogICAgZXZlbnQgV2FsbGV0Q2hhbmdlKGFkZHJlc3Mgd2FsbGV0KTsKCiAgICBldmVudCBQcmVmZXJlbnRpYWxSYXRlQ2hhbmdlKGFkZHJlc3MgaW5kZXhlZCBidXllciwgdWludDI1NiByYXRlKTsKCiAgICBldmVudCBJbml0aWFsUmF0ZUNoYW5nZSh1aW50MjU2IHJhdGUpOwoKICAgIGV2ZW50IEVuZFJhdGVDaGFuZ2UodWludDI1NiByYXRlKTsKCiAgICBmdW5jdGlvbiBNQU5BQ3Jvd2RzYWxlKAogICAgICAgIHVpbnQyNTYgX3N0YXJ0QmxvY2ssCiAgICAgICAgdWludDI1NiBfZW5kQmxvY2ssCiAgICAgICAgdWludDI1NiBfaW5pdGlhbFJhdGUsCiAgICAgICAgdWludDI1NiBfZW5kUmF0ZSwKICAgICAgICB1aW50MjU2IF9wcmVmZXJlbnRpYWxSYXRlLAogICAgICAgIGFkZHJlc3MgX3dhbGxldAogICAgKQogICAgICAgIENhcHBlZENyb3dkc2FsZSg4Mjg4OCBldGhlcikKICAgICAgICBXaGl0ZWxpc3RlZENyb3dkc2FsZSgpCiAgICAgICAgRmluYWxpemFibGVDcm93ZHNhbGUoKQogICAgICAgIENyb3dkc2FsZShfc3RhcnRCbG9jaywgX2VuZEJsb2NrLCBfaW5pdGlhbFJhdGUsIF93YWxsZXQpCiAgICB7CiAgICAgICAgcmVxdWlyZShfaW5pdGlhbFJhdGUgPiAwKTsKICAgICAgICByZXF1aXJlKF9lbmRSYXRlID4gMCk7CiAgICAgICAgcmVxdWlyZShfcHJlZmVyZW50aWFsUmF0ZSA+IDApOwoKICAgICAgICBpbml0aWFsUmF0ZSA9IF9pbml0aWFsUmF0ZTsKICAgICAgICBlbmRSYXRlID0gX2VuZFJhdGU7CiAgICAgICAgcHJlZmVyZW50aWFsUmF0ZSA9IF9wcmVmZXJlbnRpYWxSYXRlOwoKICAgICAgICBjb250aW51b3VzU2FsZSA9IGNyZWF0ZUNvbnRpbnVvdXNTYWxlQ29udHJhY3QoKTsKCiAgICAgICAgTUFOQVRva2VuKHRva2VuKS5wYXVzZSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNyZWF0ZVRva2VuQ29udHJhY3QoKSBpbnRlcm5hbCByZXR1cm5zKE1pbnRhYmxlVG9rZW4pIHsKICAgICAgICByZXR1cm4gbmV3IE1BTkFUb2tlbigpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNyZWF0ZUNvbnRpbnVvdXNTYWxlQ29udHJhY3QoKSBpbnRlcm5hbCByZXR1cm5zKE1BTkFDb250aW51b3VzU2FsZSkgewogICAgICAgIHJldHVybiBuZXcgTUFOQUNvbnRpbnVvdXNTYWxlKHJhdGUsIHdhbGxldCwgdG9rZW4pOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEJ1eWVyUmF0ZShhZGRyZXNzIGJ1eWVyLCB1aW50MjU2IHJhdGUpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUocmF0ZSAhPSAwKTsKICAgICAgICByZXF1aXJlKGlzV2hpdGVsaXN0ZWQoYnV5ZXIpKTsKICAgICAgICByZXF1aXJlKGJsb2NrLm51bWJlciA8IHN0YXJ0QmxvY2spOwoKICAgICAgICBidXllclJhdGVbYnV5ZXJdID0gcmF0ZTsKCiAgICAgICAgUHJlZmVyZW50aWFsUmF0ZUNoYW5nZShidXllciwgcmF0ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0SW5pdGlhbFJhdGUodWludDI1NiByYXRlKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKHJhdGUgIT0gMCk7CiAgICAgICAgcmVxdWlyZShibG9jay5udW1iZXIgPCBzdGFydEJsb2NrKTsKCiAgICAgICAgaW5pdGlhbFJhdGUgPSByYXRlOwoKICAgICAgICBJbml0aWFsUmF0ZUNoYW5nZShyYXRlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRFbmRSYXRlKHVpbnQyNTYgcmF0ZSkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShyYXRlICE9IDApOwogICAgICAgIHJlcXVpcmUoYmxvY2subnVtYmVyIDwgc3RhcnRCbG9jayk7CgogICAgICAgIGVuZFJhdGUgPSByYXRlOwoKICAgICAgICBFbmRSYXRlQ2hhbmdlKHJhdGUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFJhdGUoKSBpbnRlcm5hbCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICAvLyBzb21lIGVhcmx5IGJ1eWVycyBhcmUgb2ZmZXJlZCBhIGRpc2NvdW50IG9uIHRoZSBjcm93ZHNhbGUgcHJpY2UKICAgICAgICBpZiAoYnV5ZXJSYXRlW21zZy5zZW5kZXJdICE9IDApIHsKICAgICAgICAgICAgcmV0dXJuIGJ1eWVyUmF0ZVttc2cuc2VuZGVyXTsKICAgICAgICB9CgogICAgICAgIC8vIHdoaXRlbGlzdGVkIGJ1eWVycyBjYW4gcHVyY2hhc2UgYXQgcHJlZmVyZW50aWFsIHByaWNlIGJlZm9yZSBjcm93ZHNhbGUgZW5kcwogICAgICAgIGlmIChpc1doaXRlbGlzdGVkKG1zZy5zZW5kZXIpKSB7CiAgICAgICAgICAgIHJldHVybiBwcmVmZXJlbnRpYWxSYXRlOwogICAgICAgIH0KCiAgICAgICAgLy8gb3RoZXJ3aXNlIGNvbXB1dGUgdGhlIHByaWNlIGZvciB0aGUgYXVjdGlvbgogICAgICAgIHVpbnQyNTYgZWxhcHNlZCA9IGJsb2NrLm51bWJlciAtIHN0YXJ0QmxvY2s7CiAgICAgICAgdWludDI1NiByYXRlUmFuZ2UgPSBpbml0aWFsUmF0ZSAtIGVuZFJhdGU7CiAgICAgICAgdWludDI1NiBibG9ja1JhbmdlID0gZW5kQmxvY2sgLSBzdGFydEJsb2NrOwoKICAgICAgICByZXR1cm4gaW5pdGlhbFJhdGUuc3ViKHJhdGVSYW5nZS5tdWwoZWxhcHNlZCkuZGl2KGJsb2NrUmFuZ2UpKTsKICAgIH0KCiAgICAvLyBsb3cgbGV2ZWwgdG9rZW4gcHVyY2hhc2UgZnVuY3Rpb24KICAgIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKGJlbmVmaWNpYXJ5ICE9IDB4MCk7CiAgICAgICAgcmVxdWlyZSh2YWxpZFB1cmNoYXNlKCkpOwoKICAgICAgICB1aW50MjU2IHdlaUFtb3VudCA9IG1zZy52YWx1ZTsKICAgICAgICB1aW50MjU2IHVwZGF0ZWRXZWlSYWlzZWQgPSB3ZWlSYWlzZWQuYWRkKHdlaUFtb3VudCk7CgogICAgICAgIHVpbnQyNTYgcmF0ZSA9IGdldFJhdGUoKTsKICAgICAgICAvLyBjYWxjdWxhdGUgdG9rZW4gYW1vdW50IHRvIGJlIGNyZWF0ZWQKICAgICAgICB1aW50MjU2IHRva2VucyA9IHdlaUFtb3VudC5tdWwocmF0ZSk7CgogICAgICAgIC8vIHVwZGF0ZSBzdGF0ZQogICAgICAgIHdlaVJhaXNlZCA9IHVwZGF0ZWRXZWlSYWlzZWQ7CgogICAgICAgIHRva2VuLm1pbnQoYmVuZWZpY2lhcnksIHRva2Vucyk7CiAgICAgICAgVG9rZW5QdXJjaGFzZShtc2cuc2VuZGVyLCBiZW5lZmljaWFyeSwgd2VpQW1vdW50LCB0b2tlbnMpOwoKICAgICAgICBmb3J3YXJkRnVuZHMoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRXYWxsZXQoYWRkcmVzcyBfd2FsbGV0KSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKF93YWxsZXQgIT0gMHgwKTsKICAgICAgICB3YWxsZXQgPSBfd2FsbGV0OwogICAgICAgIGNvbnRpbnVvdXNTYWxlLnNldFdhbGxldChfd2FsbGV0KTsKICAgICAgICBXYWxsZXRDaGFuZ2UoX3dhbGxldCk7CiAgICB9CgogICAgZnVuY3Rpb24gdW5wYXVzZVRva2VuKCkgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKGlzRmluYWxpemVkKTsKICAgICAgICBNQU5BVG9rZW4odG9rZW4pLnVucGF1c2UoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwYXVzZVRva2VuKCkgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKGlzRmluYWxpemVkKTsKICAgICAgICBNQU5BVG9rZW4odG9rZW4pLnBhdXNlKCk7CiAgICB9CgoKICAgIGZ1bmN0aW9uIGJlZ2luQ29udGludW91c1NhbGUoKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKGlzRmluYWxpemVkKTsKCiAgICAgICAgdG9rZW4udHJhbnNmZXJPd25lcnNoaXAoY29udGludW91c1NhbGUpOwoKICAgICAgICBjb250aW51b3VzU2FsZS5zdGFydCgpOwogICAgICAgIGNvbnRpbnVvdXNTYWxlLnRyYW5zZmVyT3duZXJzaGlwKG93bmVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBmaW5hbGl6YXRpb24oKSBpbnRlcm5hbCB7CiAgICAgICAgdWludDI1NiB0b3RhbFN1cHBseSA9IHRva2VuLnRvdGFsU3VwcGx5KCk7CiAgICAgICAgdWludDI1NiBmaW5hbFN1cHBseSA9IFRPVEFMX1NIQVJFLm11bCh0b3RhbFN1cHBseSkuZGl2KENST1dEU0FMRV9TSEFSRSk7CgogICAgICAgIC8vIGVtaXQgdG9rZW5zIGZvciB0aGUgZm91bmRhdGlvbgogICAgICAgIHRva2VuLm1pbnQod2FsbGV0LCBGT1VOREFUSU9OX1NIQVJFLm11bChmaW5hbFN1cHBseSkuZGl2KFRPVEFMX1NIQVJFKSk7CgogICAgICAgIC8vIE5PVEU6IGNhbm5vdCBjYWxsIHN1cGVyIGhlcmUgYmVjYXVzZSBpdCB3b3VsZCBmaW5pc2ggbWludGluZyBhbmQKICAgICAgICAvLyB0aGUgY29udGludW91cyBzYWxlIHdvdWxkIG5vdCBiZSBhYmxlIHRvIHByb2NlZWQKICAgIH0KCn0='.
	

]
