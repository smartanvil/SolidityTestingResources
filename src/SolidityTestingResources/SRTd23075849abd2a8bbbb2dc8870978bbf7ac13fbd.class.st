Class {
	#name : #SRTd23075849abd2a8bbbb2dc8870978bbf7ac13fbd,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd23075849abd2a8bbbb2dc8870978bbf7ac13fbd >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTY7CgppbnRlcmZhY2UgR2FtZSB7CiAgICBldmVudCBHYW1lU3RhcnRlZCh1aW50IGJldEFtb3VudCk7CiAgICBldmVudCBOZXdQbGF5ZXJBZGRlZCh1aW50IG51bVBsYXllcnMsIHVpbnQgcHJpemVBbW91bnQpOwogICAgZXZlbnQgR2FtZUZpbmlzaGVkKGFkZHJlc3Mgd2lubmVyKTsKICAgIAogICAgZnVuY3Rpb24gKCkgcHVibGljIHBheWFibGU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1BhcnRpY2lwYXRlIGluIGdhbWUuIFByb3h5IGZvciBwbGF5IG1ldGhvZAogICAgZnVuY3Rpb24gcGxheSgpIHB1YmxpYyBwYXlhYmxlOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1BhcnRpY2lwYXRlIGluIGdhbWUuCiAgICBmdW5jdGlvbiBnZXRQcml6ZUFtb3VudCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KTsgICAgIC8vR2V0IHBvdGVudGlhbCBvciBhY3R1YWwgcHJpemUgYW1vdW50CiAgICBmdW5jdGlvbiBnZXROdW1XaW5uZXJzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludCwgdWludCk7CiAgICBmdW5jdGlvbiBnZXRQbGF5ZXJzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMoYWRkcmVzc1tdKTsgICAgICAgICAgIC8vR2V0IGZ1bGwgbGlzdCBvZiBwbGF5ZXJzCiAgICBmdW5jdGlvbiBnZXRXaW5uZXJzKCkgcHVibGljIHZpZXcgcmV0dXJucyhhZGRyZXNzW10gbWVtb3J5IHBsYXllcnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnRbXSBtZW1vcnkgcHJpemVzKTsgIC8vR2V0IHdpbm5lcnMuIEFjY2Vzc2FibGUgb25seSB3aGVuIGZpbmlzaGVkCiAgICBmdW5jdGlvbiBnZXRTdGF0KCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludCwgdWludCwgdWludCk7ICAgICAgIC8vU2hvcnQgc3RhdCBvbiBnYW1lCiAgICAKICAgIGZ1bmN0aW9uIGNhbGNhdWx0ZVByaXplcygpIHB1YmxpYyByZXR1cm5zICh1aW50W10pOwogICAgCiAgICBmdW5jdGlvbiBmaW5pc2goKSBwdWJsaWM7ICAgICAgICAgICAgICAgICAgICAgICAgLy9DbG9zZXMgZ2FtZSBjaG9vc2VzIHdpbm5lcgogICAgCiAgICBmdW5jdGlvbiByZXZva2UoKSBwdWJsaWM7ICAgICAgICAgICAgICAgICAgICAgICAgLy9TdG9wIGdhbWUgYW5kIHJldHVybiBtb25leSB0byBwbGF5ZXJzCiAgICAvLyBmdW5jdGlvbiBtb3ZlKGFkZHJlc3MgbmV4dEdhbWUpOyAgICAgICAgICAgICAgLy9Nb3ZlIHBsYXllcnMgYmV0cyB0byBhbm90aGVyIGdhbWUKfQoKbGlicmFyeSBUaWNrZXRMaWIgewogICAgc3RydWN0IFRpY2tldCB7CiAgICAgICAgYm9vbCBpc193aW5uZXI7CiAgICAgICAgYm9vbCBpc19hY3RpdmU7CiAgICAgICAgdWludCBibG9ja19udW1iZXI7CiAgICAgICAgdWludCBibG9ja190aW1lOwogICAgICAgIHVpbnQgbnVtX3ZvdGVzOwogICAgICAgIHVpbnQgcHJpemU7CiAgICB9Cn0KCmNvbnRyYWN0IFVuaWxvdFByaXplQ2FsY3VsYXRvciB7CiAgICAvL0NhbGN1bGF0aW9uIGNvbnN0YW50cwogICAgdWludCAgY29uc3RhbnQgYWNjdXJhY3kgICAgICAgICAgICAgICAgICAgPSAxMDAwMDAwMDAwMDAwMDAwMDAwOwogICAgdWludCAgY29uc3RhbnQgTUFYX1hfRk9SX1kgICAgICAgICAgICAgICAgPSAxOTU7ICAvLyAxOS41CiAgICAKICAgIHVpbnQgIGNvbnN0YW50IG1pblByaXplQ29lZmljZW50ICAgICAgICAgID0gMTsKICAgIHVpbnQgIGNvbnN0YW50IHBlcmNlbnRPZldpbm5lcnMgICAgICAgICAgID0gNTsgICAgLy8gNSUKICAgIHVpbnQgIGNvbnN0YW50IHBlcmNlbnRPZkZpeGVkUHJpemVXaW5uZXJzID0gMjA7ICAgLy8gMjAlCiAgICB1aW50ICBjb25zdGFudCBnYW1lQ29tbWlzaW9uICAgICAgICAgICAgICA9IDIwOyAgIC8vIDIwJQogICAgdWludCAgY29uc3RhbnQgYm9udXNHYW1lQ29tbWlzaW9uICAgICAgICAgPSA1OyAgICAvLyA1JQogICAgdWludCAgY29uc3RhbnQgdG9rZW5Ib2xlckdhbWVDb21taXNpb24gICAgPSA1OyAgICAvLyA1JQogICAgLy8gRW5kIENhbGN1bGF0aW9uIGNvbnN0YW50cwogICAgCiAgICBldmVudCBEZWJ1Zyh1aW50KTsKICAgIAogICAgZnVuY3Rpb24gZ2V0UHJpemVBbW91bnQodWludCB0b3RhbEFtb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICBwdXJlCiAgICAgICAgcmV0dXJucyAodWludCByZXN1bHQpCiAgICB7CiAgICAgICAgdWludCB0b3RhbENvbW1pc2lvbiA9IGdhbWVDb21taXNpb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgYm9udXNHYW1lQ29tbWlzaW9uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArIHRva2VuSG9sZXJHYW1lQ29tbWlzaW9uOwogICAgICAgIAogICAgICAgIC8vQ2FsY3VsYXRpb24gaXMgb2RkIG9uIHB1cnBvc2UuICBJdCBpcyBhIHNvcnQgb2YgY2VpbGluZyBlZmZlY3QgdG8KICAgICAgICAvLyBtYXhpbWl6ZSBhbW91bnQgb2YgcHJpemUKICAgICAgICByZXN1bHQgPSAoIHRvdGFsQW1vdW50IC0gKCAoIHRvdGFsQW1vdW50ICogdG90YWxDb21taXNpb24pIC8gMTAwKSApOwogICAgICAgIAogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldE51bVdpbm5lcnModWludCBudW1QbGF5ZXJzKQogICAgICAgIHB1YmxpYwogICAgICAgIHB1cmUKICAgICAgICByZXR1cm5zICh1aW50IG51bVdpbm5lcnMsIHVpbnQgbnVtRml4ZWRBbW91bnRXaW5uZXJzKQogICAgewogICAgICAgIC8vIENhbGN1bGF0aW9uIGlzIG9kZCBvbiBwdXJwb3NlLiBJdCBpcyBhIHNvcnQgb2YgY2VpbGluZyBlZmZlY3QgdG8KICAgICAgICAvLyBtYXhpbWl6ZSBudW1iZXIgb2Ygd2lubmVycwogICAgICAgIHVpbnQgdG90YU51bWxXaW5uZXJzID0gKCBudW1QbGF5ZXJzIC0gKCAobnVtUGxheWVycyAqICggMTAwIC0gcGVyY2VudE9mV2lubmVycyApICkgLyAxMDAgKSApOwogICAgICAgIAogICAgICAgIAogICAgICAgIG51bUZpeGVkQW1vdW50V2lubmVycyA9ICh0b3RhTnVtbFdpbm5lcnMgKiBwZXJjZW50T2ZGaXhlZFByaXplV2lubmVycykgLyAxMDA7CiAgICAgICAgbnVtV2lubmVycyA9IHRvdGFOdW1sV2lubmVycyAtIG51bUZpeGVkQW1vdW50V2lubmVyczsKICAgICAgICAKICAgICAgICByZXR1cm4gKG51bVdpbm5lcnMsIG51bUZpeGVkQW1vdW50V2lubmVycyk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNhbGNhdWx0ZVByaXplcyh1aW50IGJldCwgdWludCBudW1QbGF5ZXJzKQogICAgICAgIHB1YmxpYwogICAgICAgIHB1cmUKICAgICAgICByZXR1cm5zICh1aW50WzUwXSBtZW1vcnkgcHJpemVzKQogICAgewogICAgICAgIHZhciAobnVtV2lubmVycywgbnVtRml4ZWRBbW91bnRXaW5uZXJzKSA9IGdldE51bVdpbm5lcnMobnVtUGxheWVycyk7CiAgICAgICAgCiAgICAgICAgcmVxdWlyZSggdWludChudW1XaW5uZXJzICsgbnVtRml4ZWRBbW91bnRXaW5uZXJzKSA8PSBwcml6ZXMubGVuZ3RoICk7CiAgICAgICAgCiAgICAgICAgdWludFtdIG1lbW9yeSB5ID0gbmV3IHVpbnRbXSgobnVtV2lubmVycyAtIDEpKTsKICAgICAgICB1aW50IHogPSAwOyAvLyBTdW0gb2YgYWxsIFkgdmFsdWVzCiAgICAgICAgCiAgICAgICAgaWYgKCBudW1XaW5uZXJzID09IDEgKSB7CiAgICAgICAgICAgIHByaXplc1swXSA9IGdldFByaXplQW1vdW50KHVpbnQoYmV0Km51bVBsYXllcnMpKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiBwcml6ZXM7CiAgICAgICAgfSBlbHNlIGlmICggbnVtV2lubmVycyA8IDEgKSB7CiAgICAgICAgICAgIHJldHVybiBwcml6ZXM7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IHkubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgeVtpXSA9IGZvcm11bGEoIChjYWxjdWxhdGVTdGVwKG51bVdpbm5lcnMpICogaSkgKTsKICAgICAgICAgICAgeiArPSB5W2ldOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBib29sIHN0b3AgPSBmYWxzZTsKICAgICAgICAKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMTA7IGkrKykgewogICAgICAgICAgICB1aW50WzVdIG1lbW9yeSBjaHVuayA9IGRpc3RyaWJ1dGVQcml6ZUNhbGN1bGF0aW9uKAogICAgICAgICAgICAgICAgaSwgeiwgeSwgbnVtUGxheWVycywgYmV0KTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGZvciAoIHVpbnQgaiA9IDA7IGogPCBjaHVuay5sZW5ndGg7IGorKyApIHsKICAgICAgICAgICAgICAgIGlmICggKCAoaSAqIGNodW5rLmxlbmd0aCkgKyBqICkgPj0gKCBudW1XaW5uZXJzICsgbnVtRml4ZWRBbW91bnRXaW5uZXJzICkgKSB7CiAgICAgICAgICAgICAgICAgICAgc3RvcCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHByaXplc1sgKGkgKiBjaHVuay5sZW5ndGgpICsgaiBdID0gY2h1bmtbal07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGlmICggc3RvcCApIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVybiBwcml6ZXM7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGRpc3RyaWJ1dGVQcml6ZUNhbGN1bGF0aW9uICh1aW50IGNodW5rTnVtYmVyLCB1aW50IHosIHVpbnRbXSBtZW1vcnkgeSwgdWludCB0b3RhbE51bVBsYXllcnMsIHVpbnQgYmV0KQogICAgICAgIHByaXZhdGUKICAgICAgICBwdXJlCiAgICAgICAgcmV0dXJucyAodWludFs1XSBtZW1vcnkgcHJpemVzKQogICAgewogICAgICAgIHZhcihudW1XaW5uZXJzLCBudW1GaXhlZEFtb3VudFdpbm5lcnMpID0gZ2V0TnVtV2lubmVycyh0b3RhbE51bVBsYXllcnMpOwogICAgICAgIHVpbnQgcHJpemVBbW91bnRGb3JEZWxpZ2F0aW9uID0gZ2V0UHJpemVBbW91bnQoICh0b3RhbE51bVBsYXllcnMgKiBiZXQpICk7CiAgICAgICAgcHJpemVBbW91bnRGb3JEZWxpZ2F0aW9uIC09IHVpbnQoICggYmV0ICogbWluUHJpemVDb2VmaWNlbnQgKSAqIHVpbnQoIG51bVdpbm5lcnMgKyBudW1GaXhlZEFtb3VudFdpbm5lcnMgKSApOwogICAgICAgIAogICAgICAgIHVpbnQgbWFpbldpbm5lckJhc2VBbW91bnQgPSAoIChwcml6ZUFtb3VudEZvckRlbGlnYXRpb24gKiBhY2N1cmFjeSkgLyAoICggKCB6ICogYWNjdXJhY3kgKSAvICggMiAqIHlbMF0gKSApICsgKCAxICogYWNjdXJhY3kgKSApICk7CiAgICAgICAgdWludCB1bmRlbGlnYXRlZEFtb3VudCAgICA9IHByaXplQW1vdW50Rm9yRGVsaWdhdGlvbjsKICAgICAgICAKICAgICAgICB1aW50IHN0YXJ0UG9pbnQgPSBjaHVua051bWJlciAqIHByaXplcy5sZW5ndGg7CiAgICAgICAgCiAgICAgICAgZm9yICggdWludCBpID0gMDsgaSA8IHByaXplcy5sZW5ndGg7IGkrKyApIHsKICAgICAgICAgICAgaWYgKCBpID49IHVpbnQobnVtV2lubmVycyArIG51bUZpeGVkQW1vdW50V2lubmVycykgKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBwcml6ZXNbIGkgXSA9IChiZXQgKiBtaW5Qcml6ZUNvZWZpY2VudCk7CiAgICAgICAgICAgIHVpbnQgZXh0cmFQcml6ZSA9IDA7CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoIGkgPT0gKCBudW1XaW5uZXJzIC0gMSApICkgewogICAgICAgICAgICAgICAgZXh0cmFQcml6ZSA9IHVuZGVsaWdhdGVkQW1vdW50OwogICAgICAgICAgICB9IGVsc2UgaWYgKCBpID09IDAgJiYgY2h1bmtOdW1iZXIgPT0gMCApIHsKICAgICAgICAgICAgICAgIGV4dHJhUHJpemUgPSBtYWluV2lubmVyQmFzZUFtb3VudDsKICAgICAgICAgICAgfSBlbHNlIGlmICggKCBzdGFydFBvaW50ICsgaSApIDwgbnVtV2lubmVycyApIHsKICAgICAgICAgICAgICAgIGV4dHJhUHJpemUgPSAoICggeVsgKCBzdGFydFBvaW50ICsgaSApIC0gMSBdICogKHByaXplQW1vdW50Rm9yRGVsaWdhdGlvbiAtIG1haW5XaW5uZXJCYXNlQW1vdW50KSApIC8geik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIHByaXplc1sgaSBdICs9IGV4dHJhUHJpemU7CiAgICAgICAgICAgIHVuZGVsaWdhdGVkQW1vdW50IC09IGV4dHJhUHJpemU7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVybiBwcml6ZXM7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGZvcm11bGEodWludCB4KQogICAgICAgIHB1YmxpYwogICAgICAgIHB1cmUKICAgICAgICByZXR1cm5zICh1aW50IHkpCiAgICB7CiAgICAgICAgeSA9ICggKDEgKiBhY2N1cmFjeSoqMikgLyAoeCArICg1KmFjY3VyYWN5LzEwKSkpIC0gKCg1ICogYWNjdXJhY3kpIC8gMTAwKTsKICAgICAgICAKICAgICAgICByZXR1cm4geTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gY2FsY3VsYXRlU3RlcCh1aW50IG51bVdpbm5lcnMpCiAgICAgICAgcHVibGljCiAgICAgICAgcHVyZQogICAgICAgIHJldHVybnModWludCBzdGVwKQogICAgewogICAgICAgIHN0ZXAgPSAoIE1BWF9YX0ZPUl9ZICogYWNjdXJhY3kgLyAxMCApIC8gbnVtV2lubmVyczsKICAgICAgICAKICAgICAgICByZXR1cm4gc3RlcDsKICAgIH0KfQoKY29udHJhY3QgQmFzZVVuaWxvdEdhbWUgaXMgR2FtZSB7CiAgICBlbnVtIFN0YXRlIHsKICAgICAgICBBQ1RJVkUsCiAgICAgICAgRU5ERUQsCiAgICAgICAgUkVWT0tJTkcsCiAgICAgICAgUkVWT0tFRCwKICAgICAgICBNT1ZFRAogICAgfQogICAgCiAgICBldmVudCBQcml6ZVJlc3VsdENhbGN1bGF0ZWQodWludCBzaXplLCB1aW50W10gcHJpemVzKTsKICAgIAogICAgU3RhdGUgc3RhdGU7CiAgICBhZGRyZXNzIGFkbWluaXN0cmF0b3I7CiAgICB1aW50IGJldDsKICAgIAogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBUaWNrZXRMaWIuVGlja2V0KSBpbnRlcm5hbCB0aWNrZXRzOwogICAgYWRkcmVzc1tdIGludGVybmFsIHRpY2tldEluZGV4OwogICAgCiAgICBVbmlsb3RQcml6ZUNhbGN1bGF0b3IgY2FsY3VsYXRvcjsKICAgIAogICAgLy9Nb2RpZmllcnMKICAgIG1vZGlmaWVyIG9ubHlBZG1pbmlzdHJhdG9yKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBhZG1pbmlzdHJhdG9yKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICBtb2RpZmllciBvbmx5UGxheWVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciAhPSBhZG1pbmlzdHJhdG9yKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICBtb2RpZmllciB2YWxpZEJldCgpIHsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA9PSBiZXQpOwogICAgICAgIF87CiAgICB9CiAgICAKICAgIG1vZGlmaWVyIGFjdGl2ZUdhbWUoKSB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5BQ1RJVkUpOwogICAgICAgIF87CiAgICB9CiAgICAKICAgIG1vZGlmaWVyIGluYWN0aXZlR2FtZSgpIHsKICAgICAgICByZXF1aXJlKHN0YXRlICE9IFN0YXRlLkFDVElWRSk7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgbW9kaWZpZXIgZmluaXNoZWRHYW1lKCkgewogICAgICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuRU5ERUQpOwogICAgICAgIF87CiAgICB9CiAgICAKICAgIC8vUHJpdmF0ZSBtZXRob2RzCiAgICAKICAgIAogICAgZnVuY3Rpb24gKCkKICAgICAgICBwdWJsaWMKICAgICAgICBwYXlhYmxlCiAgICAgICAgdmFsaWRCZXQKICAgICAgICBvbmx5UGxheWVyCiAgICB7CiAgICAgICAgcGxheSgpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBwbGF5KCkgcHVibGljIHBheWFibGU7CiAgICAKICAgIGZ1bmN0aW9uIGdldFN0YXRlKCkKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyhTdGF0ZSkKICAgIHsKICAgICAgICByZXR1cm4gc3RhdGU7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldEJldCgpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnMgKHVpbnQpCiAgICB7CiAgICAgICAgcmV0dXJuIGJldDsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0UGxheWVycygpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zKGFkZHJlc3NbXSkKICAgIHsKICAgICAgICByZXR1cm4gdGlja2V0SW5kZXg7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldFBsYXllckRldGFpbHMoYWRkcmVzcyBwbGF5ZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIGluYWN0aXZlR2FtZQogICAgICAgIHJldHVybnMgKGJvb2wsIGJvb2wsIHVpbnQsIHVpbnQsIHVpbnQsIHVpbnQpCiAgICB7CiAgICAgICAgVGlja2V0TGliLlRpY2tldCBtZW1vcnkgdGlja2V0ID0gdGlja2V0c1twbGF5ZXJdOwogICAgICAgIAogICAgICAgIHJldHVybiAodGlja2V0LmlzX3dpbm5lciwgdGlja2V0LmlzX2FjdGl2ZSwKICAgICAgICB0aWNrZXQuYmxvY2tfbnVtYmVyLCB0aWNrZXQuYmxvY2tfdGltZSwgdGlja2V0Lm51bV92b3RlcywgdGlja2V0LnByaXplKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0V2lubmVycygpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIGZpbmlzaGVkR2FtZQogICAgICAgIHJldHVybnMoYWRkcmVzc1tdIG1lbW9yeSBwbGF5ZXJzLCB1aW50W10gbWVtb3J5IHByaXplcykKICAgIHsKICAgICAgICB2YXIobnVtV2lubmVycywgbnVtRml4ZWRBbW91bnRXaW5uZXJzKSA9IGdldE51bVdpbm5lcnMoKTsKICAgICAgICB1aW50IHRvdGFsTnVtV2lubmVycyA9IG51bVdpbm5lcnMgKyBudW1GaXhlZEFtb3VudFdpbm5lcnM7CiAgICAgICAgcGxheWVycyA9IG5ldyBhZGRyZXNzW10odG90YWxOdW1XaW5uZXJzKTsKICAgICAgICBwcml6ZXMgPSBuZXcgdWludFtdKHRvdGFsTnVtV2lubmVycyk7CiAgICAgICAgCiAgICAgICAgdWludCBpbmRleCA9IDA7CiAgICAgICAgCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgdGlja2V0SW5kZXgubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKHRpY2tldHNbdGlja2V0SW5kZXhbaV1dLmlzX3dpbm5lciA9PSB0cnVlKSB7CiAgICAgICAgICAgICAgICBwbGF5ZXJzW2luZGV4XSA9IHRpY2tldEluZGV4W2ldOwogICAgICAgICAgICAgICAgcHJpemVzW2luZGV4XSA9IHRpY2tldHNbdGlja2V0SW5kZXhbaV1dLnByaXplOwogICAgICAgICAgICAgICAgaW5kZXgrKzsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICByZXR1cm4gKHBsYXllcnMsIHByaXplcyk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldE51bVdpbm5lcnMoKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCwgdWludCkKICAgIHsKICAgICAgICB2YXIobnVtV2lubmVycywgbnVtRml4ZWRBbW91bnRXaW5uZXJzKSA9IGNhbGN1bGF0b3IuZ2V0TnVtV2lubmVycyh0aWNrZXRJbmRleC5sZW5ndGgpOwoKICAgICAgICByZXR1cm4gKG51bVdpbm5lcnMsIG51bUZpeGVkQW1vdW50V2lubmVycyk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldFByaXplQW1vdW50KCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQgcmVzdWx0KQogICAgewogICAgICAgIHVpbnQgdG90YWxBbW91bnQgPSB0aGlzLmJhbGFuY2U7CiAgICAgICAgCiAgICAgICAgaWYgKCBzdGF0ZSA9PSBTdGF0ZS5FTkRFRCApIHsKICAgICAgICAgICAgdG90YWxBbW91bnQgPSBiZXQgKiB0aWNrZXRJbmRleC5sZW5ndGg7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJlc3VsdCA9IGNhbGN1bGF0b3IuZ2V0UHJpemVBbW91bnQodG90YWxBbW91bnQpOwogICAgICAgIAogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldFN0YXQoKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoIHVpbnQsIHVpbnQsIHVpbnQgKQogICAgewogICAgICAgIHZhciAobnVtV2lubmVycywgbnVtRml4ZWRBbW91bnRXaW5uZXJzKSA9IGdldE51bVdpbm5lcnMoKTsKICAgICAgICByZXR1cm4gKHRpY2tldEluZGV4Lmxlbmd0aCwgZ2V0UHJpemVBbW91bnQoKSwgdWludChudW1XaW5uZXJzICsgbnVtRml4ZWRBbW91bnRXaW5uZXJzKSk7CiAgICB9CgogICAgZnVuY3Rpb24gY2FsY2F1bHRlUHJpemVzKCkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zKHVpbnRbXSBtZW1vcnkgcmVzdWx0KQogICAgewogICAgICAgIHZhcihudW1XaW5uZXJzLCBudW1GaXhlZEFtb3VudFdpbm5lcnMpID0gZ2V0TnVtV2lubmVycygpOwogICAgICAgIHVpbnQgdG90YWxOdW1XaW5uZXJzID0gKCBudW1XaW5uZXJzICsgbnVtRml4ZWRBbW91bnRXaW5uZXJzICk7CiAgICAgICAgcmVzdWx0ID0gbmV3IHVpbnRbXSggdG90YWxOdW1XaW5uZXJzICk7CiAgICAgICAgCiAgICAgICAgCiAgICAgICAgdWludFs1MF0gbWVtb3J5IHByaXplcyA9IGNhbGN1bGF0b3IuY2FsY2F1bHRlUHJpemVzKAogICAgICAgIGJldCwgdGlja2V0SW5kZXgubGVuZ3RoKTsKICAgICAgICAKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCB0b3RhbE51bVdpbm5lcnM7IGkrKykgewogICAgICAgICAgICByZXN1bHRbaV0gPSBwcml6ZXNbaV07CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHJldm9rZSgpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IKICAgICAgICBhY3RpdmVHYW1lCiAgICB7CiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgdGlja2V0SW5kZXgubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdGlja2V0c1t0aWNrZXRJbmRleFtpXV0uaXNfYWN0aXZlID0gZmFsc2U7CiAgICAgICAgICAgIHRpY2tldEluZGV4W2ldLnRyYW5zZmVyKGJldCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHN0YXRlID0gU3RhdGUuUkVWT0tFRDsKICAgIH0KfQoKY29udHJhY3QgVW5pbG90VGFpbEV0aGVyIGlzIEJhc2VVbmlsb3RHYW1lIHsKICAgIAogICAgdWludCB3aW5uZXJJbmRleDsKICAgIAogICAgLy9QdWJsaWMgbWV0aG9kcwogICAgZnVuY3Rpb24gVW5pbG90VGFpbEV0aGVyKHVpbnQgYmV0QW1vdW50LCBhZGRyZXNzIGNhbGN1bGF0b3JDb250cmFjdEFkZHJlc3MpCiAgICAgICAgcHVibGljCiAgICB7CiAgICAgICAgc3RhdGUgPSBTdGF0ZS5BQ1RJVkU7CiAgICAgICAgYWRtaW5pc3RyYXRvciA9IG1zZy5zZW5kZXI7CiAgICAgICAgYmV0ID0gYmV0QW1vdW50OwogICAgICAgIAogICAgICAgIGNhbGN1bGF0b3IgPSBVbmlsb3RQcml6ZUNhbGN1bGF0b3IoY2FsY3VsYXRvckNvbnRyYWN0QWRkcmVzcyk7CiAgICAgICAgCiAgICAgICAgR2FtZVN0YXJ0ZWQoYmV0QW1vdW50KTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gcGxheSgpCiAgICAgICAgcHVibGljCiAgICAgICAgcGF5YWJsZQogICAgICAgIHZhbGlkQmV0CiAgICAgICAgb25seVBsYXllcgogICAgewogICAgICAgIHJlcXVpcmUodGlja2V0c1ttc2cuc2VuZGVyXS5ibG9ja19udW1iZXIgPT0gMCk7CiAgICAgICAgcmVxdWlyZSh0aWNrZXRJbmRleC5sZW5ndGggPCAyMDApOwogICAgICAgIAogICAgICAgIHRpY2tldHNbbXNnLnNlbmRlcl0uaXNfd2lubmVyICAgID0gZmFsc2U7CiAgICAgICAgdGlja2V0c1ttc2cuc2VuZGVyXS5pc19hY3RpdmUgICAgPSB0cnVlOwogICAgICAgIHRpY2tldHNbbXNnLnNlbmRlcl0uYmxvY2tfbnVtYmVyID0gYmxvY2subnVtYmVyOwogICAgICAgIHRpY2tldHNbbXNnLnNlbmRlcl0uYmxvY2tfdGltZSAgID0gYmxvY2sudGltZXN0YW1wOwogICAgICAgIHRpY2tldHNbbXNnLnNlbmRlcl0ubnVtX3ZvdGVzICAgID0gMDsKICAgICAgICAKICAgICAgICB0aWNrZXRJbmRleC5wdXNoKG1zZy5zZW5kZXIpOwogICAgICAgIAogICAgICAgIE5ld1BsYXllckFkZGVkKHRpY2tldEluZGV4Lmxlbmd0aCwgZ2V0UHJpemVBbW91bnQoKSk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGZpbmlzaCgpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IKICAgICAgICBhY3RpdmVHYW1lCiAgICB7CiAgICAgICAgdWludCBtYXhfdm90ZXM7CiAgICAgICAgCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgdGlja2V0SW5kZXgubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgVGlja2V0TGliLlRpY2tldCBtZW1vcnkgdGlja2V0ID0gdGlja2V0c1t0aWNrZXRJbmRleFtpXV07CiAgICAgICAgICAgIHVpbnQgdm90ZSA9ICggKCB0aWNrZXQuYmxvY2tfbnVtYmVyICogdGlja2V0LmJsb2NrX3RpbWUgKSArIHVpbnQodGlja2V0SW5kZXhbaV0pICkgJSB0aWNrZXRJbmRleC5sZW5ndGg7CiAgICAgICAgICAgIAogICAgICAgICAgICB0aWNrZXRzW3RpY2tldEluZGV4W3ZvdGVdXS5udW1fdm90ZXMgKz0gMTsKICAgICAgICAgICAgdWludCB0aWNrZXROdW1Wb3RlcyA9IHRpY2tldHNbdGlja2V0SW5kZXhbdm90ZV1dLm51bV92b3RlczsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmICggdGlja2V0TnVtVm90ZXMgPiBtYXhfdm90ZXMgKSB7CiAgICAgICAgICAgICAgICBtYXhfdm90ZXMgPSB0aWNrZXROdW1Wb3RlczsKICAgICAgICAgICAgICAgIHdpbm5lckluZGV4ID0gdm90ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICB1aW50W10gbWVtb3J5IHByaXplcyA9IGNhbGNhdWx0ZVByaXplcygpOwogICAgICAgIAogICAgICAgIHVpbnQgbGFzdElkID0gd2lubmVySW5kZXg7CiAgICAgICAgCiAgICAgICAgZm9yICggaSA9IDA7IGkgPCBwcml6ZXMubGVuZ3RoOyBpKysgKSB7CiAgICAgICAgICAgIGlmICh0aWNrZXRzW3RpY2tldEluZGV4W2xhc3RJZF1dLmlzX2FjdGl2ZSkgewogICAgICAgICAgICAgICAgdGlja2V0c1t0aWNrZXRJbmRleFtsYXN0SWRdXS5wcml6ZSA9IHByaXplc1tpXTsKICAgICAgICAgICAgICAgIHRpY2tldHNbdGlja2V0SW5kZXhbbGFzdElkXV0uaXNfd2lubmVyID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHRpY2tldEluZGV4W2xhc3RJZF0udHJhbnNmZXIocHJpemVzW2ldKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGktLTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKCBsYXN0SWQgPD0gMCApIHsKICAgICAgICAgICAgICAgIGxhc3RJZCA9IHRpY2tldEluZGV4Lmxlbmd0aDsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgbGFzdElkIC09IDE7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGFkbWluaXN0cmF0b3IudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgICAgICAKICAgICAgICBzdGF0ZSA9IFN0YXRlLkVOREVEOwogICAgICAgIAogICAgICAgIEdhbWVGaW5pc2hlZCh0aWNrZXRJbmRleFt3aW5uZXJJbmRleF0pOwogICAgfQp9'.
	

]
