Class {
	#name : #SRTbcff2d15c698d3874bc29aa170c89fd7a6146a4b,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTbcff2d15c698d3874bc29aa170c89fd7a6146a4b >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTI7Ci8qKgogKiBPdmVyZmxvdyBhd2FyZSB1aW50IG1hdGggZnVuY3Rpb25zLgogKi8KY29udHJhY3QgU2FmZU1hdGggewogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBwY3QodWludCBudW1lcmF0b3IsIHVpbnQgZGVub21pbmF0b3IsIHVpbnQgcHJlY2lzaW9uKSBpbnRlcm5hbCByZXR1cm5zKHVpbnQgcXVvdGllbnQpIHsKICAgIHVpbnQgX251bWVyYXRvciA9IG51bWVyYXRvciAqIDEwICoqIChwcmVjaXNpb24rMSk7CiAgICB1aW50IF9xdW90aWVudCA9ICgoX251bWVyYXRvciAvIGRlbm9taW5hdG9yKSArIDUpIC8gMTA7CiAgICByZXR1cm4gKF9xdW90aWVudCk7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBtYXg2NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgewogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOwogIH0KCiAgZnVuY3Rpb24gbWluNjQodWludDY0IGEsIHVpbnQ2NCBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50NjQpIHsKICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOwogIH0KCiAgZnVuY3Rpb24gbWF4MjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7CiAgfQoKICBmdW5jdGlvbiBtaW4yNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOwogIH0KCn0KCi8qKgogKiBFUkMgMjAgdG9rZW4KICovCmNvbnRyYWN0IFRva2VuIGlzIFNhZmVNYXRoIHsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgaWYgKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gc3ViKGJhbGFuY2VzW21zZy5zZW5kZXJdLCBfdmFsdWUpOwogICAgICAgICAgICBiYWxhbmNlc1tfdG9dID0gYWRkKGJhbGFuY2VzW190b10sIF92YWx1ZSk7CiAgICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgaWYgKGJhbGFuY2VzW19mcm9tXSA+PSBfdmFsdWUgJiYgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIF92YWx1ZSA+IDApIHsKICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOwogICAgICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBzdWIoYmFsYW5jZXNbX2Zyb21dLCBfdmFsdWUpOwogICAgICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IHN1YihhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSwgX3ZhbHVlKTsKICAgICAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9CiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQoKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CgogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CgogICAgLy8gQSB2dWxlcm5hYmlsaXR5IG9mIHRoZSBhcHByb3ZlIG1ldGhvZCBpbiB0aGUgRVJDMjAgc3RhbmRhcmQgd2FzIGlkZW50aWZpZWQgYnkKICAgIC8vIE1pa2hhaWwgVmxhZGltaXJvdiBhbmQgRG1pdHJ5IEtob3ZyYXRvdmljaCBoZXJlOgogICAgLy8gaHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vZG9jdW1lbnQvZC8xWUxQdFF4WnUxVUF2TzljWjFPMlJQWEJiVDBtb29oNERZS2pBX2pwLVJMTQogICAgLy8gSXQncyBiZXR0ZXIgdG8gdXNlIHRoaXMgbWV0aG9kIHdoaWNoIGlzIG5vdCBzdXNjZXB0aWJsZSB0byBvdmVyLXdpdGhkcmF3aW5nIGJ5IHRoZSBhcHByb3ZlZS4KICAgIC8vLyBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3MgdG8gYXBwcm92ZQogICAgLy8vIEBwYXJhbSBfY3VycmVudFZhbHVlIFRoZSBwcmV2aW91cyB2YWx1ZSBhcHByb3ZlZCwgd2hpY2ggY2FuIGJlIHJldHJpZXZlZCB3aXRoIGFsbG93YW5jZShtc2cuc2VuZGVyLCBfc3BlbmRlcikKICAgIC8vLyBAcGFyYW0gX25ld1ZhbHVlIFRoZSBuZXcgdmFsdWUgdG8gYXBwcm92ZSwgdGhpcyB3aWxsIHJlcGxhY2UgdGhlIF9jdXJyZW50VmFsdWUKICAgIC8vLyBAcmV0dXJuIGJvb2wgV2hldGhlciB0aGUgYXBwcm92YWwgd2FzIGEgc3VjY2VzcyAoc2VlIEVSQzIwJ3MgYGFwcHJvdmVgKQogICAgZnVuY3Rpb24gY29tcGFyZUFuZEFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfY3VycmVudFZhbHVlLCB1aW50MjU2IF9uZXdWYWx1ZSkgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIGlmIChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSAhPSBfY3VycmVudFZhbHVlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBhcHByb3ZlKF9zcGVuZGVyLCBfbmV3VmFsdWUpOwogICAgfQp9Cgpjb250cmFjdCBDSEVYVG9rZW4gaXMgVG9rZW4gewoKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJDSEVYIFRva2VuIjsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIkNIWCI7CiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwogICAgdWludCBwdWJsaWMgc3RhcnRCbG9jazsgLy9jcm93ZHNhbGUgc3RhcnQgYmxvY2sKICAgIHVpbnQgcHVibGljIGVuZEJsb2NrOyAvL2Nyb3dkc2FsZSBlbmQgYmxvY2sKCiAgICBhZGRyZXNzIHB1YmxpYyBmb3VuZGVyOwogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICAKICAgIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5ID0gMjAwMDAwMDAwMCAqIDEwKipkZWNpbWFsczsgLy8gMmIgdG9rZW5zLCBlYWNoIGRpdmlkZWQgdG8gdXAgdG8gMTBeZGVjaW1hbHMgdW5pdHMuCiAgICAKICAgIHVpbnQgcHVibGljIHRvdGFsVG9rZW5zID0gMDsKICAgIHVpbnQgcHVibGljIHByZXNhbGVTdXBwbHkgPSAwOwogICAgdWludCBwdWJsaWMgcHJlc2FsZUV0aGVyUmFpc2VkID0gMDsKCiAgICBldmVudCBCdXkoYWRkcmVzcyBpbmRleGVkIHJlY2lwaWVudCwgdWludCBldGgsIHVpbnQgY2h4KTsKCiAgICB1aW50IHB1YmxpYyBwcmVzYWxlQWxsb2NhdGlvbiA9IHRvdGFsU3VwcGx5IC8gMjsgLy81MCUgb2YgdG9rZW4gc3VwcGx5IGFsbG9jYXRlZCBmb3IgY3Jvd2RzYWxlCiAgICB1aW50IHB1YmxpYyBzdHJhdGVnaWNBbGxvY2F0aW9uID0gdG90YWxTdXBwbHkgLyA0OyAvLzI1JSBvZiB0b2tlbiBzdXBwbHkgYWxsb2NhdGVkIHBvc3QtY3Jvd2RzYWxlIGZvciBzdHJhdGVnaWMgc3VwcGx5CiAgICB1aW50IHB1YmxpYyByZXNlcnZlQWxsb2NhdGlvbiA9IHRvdGFsU3VwcGx5IC8gNDsgLy8yNSUgb2YgdG9rZW4gc3VwcGx5IGFsbG9jYXRlZCBwb3N0LWNyb3dkc2FsZSBmb3IgaW50ZXJuYWwKICAgIGJvb2wgcHVibGljIHN0cmF0ZWdpY0FsbG9jYXRlZCA9IGZhbHNlOwogICAgYm9vbCBwdWJsaWMgcmVzZXJ2ZUFsbG9jYXRlZCA9IGZhbHNlOwoKICAgIHVpbnQgcHVibGljIHRyYW5zZmVyTG9ja3VwID0gMTcyODAwOyAvL25vIHRyYW5zZmVycyB1bnRpbCAzMCBkYXlzIGFmdGVyIGNyb3dkc2FsZSBiZWdpbnMgKGFzc3VtZXMgMTAwIGRheSBjcm93ZHNhbGUpCiAgICB1aW50IHB1YmxpYyByZXNlcnZlTG9ja3VwID0gMjQxOTIwOyAvL2ZpcnN0IHdhdmUgb2YgcmVzZXJ2ZSBsb2NrZWQgdW50aWwgNDIgZGF5cyBhZnRlciBzYWxlIGlzIG92ZXIKCiAgICB1aW50IHB1YmxpYyByZXNlcnZlV2F2ZSA9IDA7IC8vaW5jcmVtZW50cyBlYWNoIHRpbWUgMTAlIG9mIHJlc2VydmUgaXMgYWxsb2NhdGVkLCB0byBhIG1heCBvZiAxMAogICAgdWludCBwdWJsaWMgcmVzZXJ2ZVdhdmVUb2tlbnMgPSByZXNlcnZlQWxsb2NhdGlvbiAvIDEwOyAvLzEwJSBvZiByZXNlcnZlIHdpbGwgYmUgcmVsZWFzZWQgb24gZWFjaCB3YXZlCiAgICB1aW50IHB1YmxpYyByZXNlcnZlV2F2ZUxvY2t1cCA9IDE3MjgwMDsgLy8zMCBkYXkgaW50ZXJ2YWxzIGJlZm9yZSBzdWJzZXF1ZW50IHdhdmUgb2YgcmVzZXJ2ZSB0b2tlbnMgY2FuIGJlIHJlbGVhc2VkCgogICAgdWludCBwdWJsaWMgY29uc3RhbnQgTUlOX0VUSEVSID0gMSBmaW5uZXk7CgogICAgZW51bSBUb2tlblNhbGVTdGF0ZSB7CiAgICAgICAgSW5pdGlhbCwgICAgLy9jb250cmFjdCBpbml0aWFsaXplZCwgYm9udXMgdG9rZW4KICAgICAgICBQcmVzYWxlLCAgICAvL2xpbWl0ZWQgdGltZSBjcm93ZHNhbGUKICAgICAgICBMaXZlLCAgICAgICAvL2RlZmF1bHQgcHJpY2UKICAgICAgICBGcm96ZW4gICAgICAvL3ByZXZlbnQgc2FsZSBvZiB0b2tlbnMKICAgIH0KCiAgICBUb2tlblNhbGVTdGF0ZSBwdWJsaWMgX3NhbGVTdGF0ZSA9IFRva2VuU2FsZVN0YXRlLkluaXRpYWw7CgogICAgZnVuY3Rpb24gQ0hFWFRva2VuKGFkZHJlc3MgZm91bmRlcklucHV0LCBhZGRyZXNzIG93bmVySW5wdXQsIHVpbnQgc3RhcnRCbG9ja0lucHV0LCB1aW50IGVuZEJsb2NrSW5wdXQpIHsKICAgICAgICBmb3VuZGVyID0gZm91bmRlcklucHV0OwogICAgICAgIG93bmVyID0gb3duZXJJbnB1dDsKICAgICAgICBzdGFydEJsb2NrID0gc3RhcnRCbG9ja0lucHV0OwogICAgICAgIGVuZEJsb2NrID0gZW5kQmxvY2tJbnB1dDsKICAgICAgICAKICAgICAgICB1cGRhdGVUb2tlblNhbGVTdGF0ZSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIHByaWNlKCkgY29uc3RhbnQgcmV0dXJucyh1aW50KSB7CiAgICAgICAgaWYgKF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuSW5pdGlhbCkgcmV0dXJuIDEyMDAyOwogICAgICAgIGlmIChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLlByZXNhbGUpIHsKICAgICAgICAgICAgdWludCBwZXJjZW50UmVtYWluaW5nID0gcGN0KChlbmRCbG9jayAtIGJsb2NrLm51bWJlciksIChlbmRCbG9jayAtIHN0YXJ0QmxvY2spLCAzKTsKICAgICAgICAgICAgcmV0dXJuIDYwMDAgKyA2ICogcGVyY2VudFJlbWFpbmluZzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIDYwMDA7CiAgICB9CgogICAgZnVuY3Rpb24oKSBwYXlhYmxlIHsKICAgICAgICBidXkobXNnLnNlbmRlcik7CiAgICB9CgogICAgZnVuY3Rpb24gYnV5KGFkZHJlc3MgcmVjaXBpZW50KSBwYXlhYmxlIHsKICAgICAgICBpZiAocmVjaXBpZW50ID09IDB4MCkgdGhyb3c7CiAgICAgICAgaWYgKG1zZy52YWx1ZSA8IE1JTl9FVEhFUikgdGhyb3c7CiAgICAgICAgaWYgKF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuRnJvemVuKSB0aHJvdzsKICAgICAgICAKICAgICAgICB1cGRhdGVUb2tlblNhbGVTdGF0ZSgpOwoKICAgICAgICB1aW50IHRva2VucyA9IG11bChtc2cudmFsdWUsIHByaWNlKCkpOwogICAgICAgIHVpbnQgbmV4dFRvdGFsID0gYWRkKHRvdGFsVG9rZW5zLCB0b2tlbnMpOwogICAgICAgIHVpbnQgbmV4dFByZXNhbGVUb3RhbCA9IGFkZChwcmVzYWxlU3VwcGx5LCB0b2tlbnMpOwoKICAgICAgICBpZiAobmV4dFRvdGFsID49IHRvdGFsU3VwcGx5KSB0aHJvdzsKICAgICAgICBpZiAobmV4dFByZXNhbGVUb3RhbCA+PSBwcmVzYWxlQWxsb2NhdGlvbikgdGhyb3c7CiAgICAgICAgCiAgICAgICAgYmFsYW5jZXNbcmVjaXBpZW50XSA9IGFkZChiYWxhbmNlc1tyZWNpcGllbnRdLCB0b2tlbnMpOwogICAgICAgIHByZXNhbGVTdXBwbHkgPSBuZXh0UHJlc2FsZVRvdGFsOwogICAgICAgIHRvdGFsVG9rZW5zID0gbmV4dFRvdGFsOwoKICAgICAgICBpZiAoX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5Jbml0aWFsIHx8IF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuUHJlc2FsZSkgewogICAgICAgICAgICBwcmVzYWxlRXRoZXJSYWlzZWQgPSBhZGQocHJlc2FsZUV0aGVyUmFpc2VkLCBtc2cudmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgZm91bmRlci50cmFuc2Zlcihtc2cudmFsdWUpOwogICAgICAgIAogICAgICAgIFRyYW5zZmVyKDAsIHJlY2lwaWVudCwgdG9rZW5zKTsKICAgICAgICBCdXkocmVjaXBpZW50LCBtc2cudmFsdWUsIHRva2Vucyk7CiAgICB9CgogICAgZnVuY3Rpb24gdXBkYXRlVG9rZW5TYWxlU3RhdGUgKCkgewogICAgICAgIGlmIChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLkZyb3plbikgcmV0dXJuOwoKICAgICAgICBpZiAoX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5MaXZlICYmIGJsb2NrLm51bWJlciA+IGVuZEJsb2NrKSByZXR1cm47CiAgICAgICAgCiAgICAgICAgaWYgKF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuSW5pdGlhbCAmJiBibG9jay5udW1iZXIgPj0gc3RhcnRCbG9jaykgewogICAgICAgICAgICBfc2FsZVN0YXRlID0gVG9rZW5TYWxlU3RhdGUuUHJlc2FsZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuUHJlc2FsZSAmJiBibG9jay5udW1iZXIgPiBlbmRCbG9jaykgewogICAgICAgICAgICBfc2FsZVN0YXRlID0gVG9rZW5TYWxlU3RhdGUuTGl2ZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBpZiAoYmxvY2subnVtYmVyIDw9IHN0YXJ0QmxvY2sgKyB0cmFuc2ZlckxvY2t1cCAmJiBtc2cuc2VuZGVyICE9IGZvdW5kZXIgJiYgbXNnLnNlbmRlciAhPSBvd25lcikgdGhyb3c7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBpZiAoYmxvY2subnVtYmVyIDw9IHN0YXJ0QmxvY2sgKyB0cmFuc2ZlckxvY2t1cCAmJiBtc2cuc2VuZGVyICE9IGZvdW5kZXIgJiYgbXNnLnNlbmRlciAhPSBvd25lcikgdGhyb3c7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlJbnRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyIHx8IG1zZy5zZW5kZXIgPT0gZm91bmRlcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBhbGxvY2F0ZVN0cmF0ZWdpY1Rva2VucygpIG9ubHlJbnRlcm5hbCB7CiAgICAgICAgaWYgKHN0cmF0ZWdpY0FsbG9jYXRlZCkgdGhyb3c7CgogICAgICAgIGJhbGFuY2VzW293bmVyXSA9IGFkZChiYWxhbmNlc1tvd25lcl0sIHN0cmF0ZWdpY0FsbG9jYXRpb24pOwogICAgICAgIHRvdGFsVG9rZW5zID0gYWRkKHRvdGFsVG9rZW5zLCBzdHJhdGVnaWNBbGxvY2F0aW9uKTsKCiAgICAgICAgc3RyYXRlZ2ljQWxsb2NhdGVkID0gdHJ1ZTsKCiAgICAgICAgVHJhbnNmZXIoMCwgb3duZXIsIHN0cmF0ZWdpY0FsbG9jYXRpb24pOwogICAgfQoKICAgIGZ1bmN0aW9uIGFsbG9jYXRlUmVzZXJ2ZVRva2VucygpIG9ubHlJbnRlcm5hbCB7CiAgICAgICAgaWYgKGJsb2NrLm51bWJlciA8PSBlbmRCbG9jayArIHJlc2VydmVMb2NrdXAgKyAocmVzZXJ2ZVdhdmVMb2NrdXAgKiByZXNlcnZlV2F2ZSkpIHRocm93OwogICAgICAgIGlmIChyZXNlcnZlQWxsb2NhdGVkKSB0aHJvdzsKCiAgICAgICAgYmFsYW5jZXNbZm91bmRlcl0gPSBhZGQoYmFsYW5jZXNbZm91bmRlcl0sIHJlc2VydmVXYXZlVG9rZW5zKTsKICAgICAgICB0b3RhbFRva2VucyA9IGFkZCh0b3RhbFRva2VucywgcmVzZXJ2ZVdhdmVUb2tlbnMpOwoKICAgICAgICByZXNlcnZlV2F2ZSsrOwogICAgICAgIGlmIChyZXNlcnZlV2F2ZSA+PSAxMCkgewogICAgICAgICAgICByZXNlcnZlQWxsb2NhdGVkID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIFRyYW5zZmVyKDAsIGZvdW5kZXIsIHJlc2VydmVXYXZlVG9rZW5zKTsKICAgIH0KCiAgICBmdW5jdGlvbiBmcmVlemUoKSBvbmx5SW50ZXJuYWwgewogICAgICAgIF9zYWxlU3RhdGUgPSBUb2tlblNhbGVTdGF0ZS5Gcm96ZW47CiAgICB9CgogICAgZnVuY3Rpb24gdW5mcmVlemUoKSBvbmx5SW50ZXJuYWwgewogICAgICAgIF9zYWxlU3RhdGUgPSBUb2tlblNhbGVTdGF0ZS5QcmVzYWxlOwogICAgICAgIHVwZGF0ZVRva2VuU2FsZVN0YXRlKCk7CiAgICB9Cgp9'.
	

]
