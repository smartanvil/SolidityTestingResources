Class {
	#name : #SRT4a479d44678c68Ee7f193610B53DEC6Cc514d643,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT4a479d44678c68Ee7f193610B53DEC6Cc514d643 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7Cgpjb250cmFjdCBUb2tlbiB7IC8vIEVSQzIwIHN0YW5kYXJkCgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOwogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKfQoKCi8qKgogKiBPdmVyZmxvdyBhd2FyZSB1aW50IG1hdGggZnVuY3Rpb25zLgogKgogKiBJbnNwaXJlZCBieSBodHRwczovL2dpdGh1Yi5jb20vbWFrZXJkYW8vbWFrZXItb3RjL2Jsb2IvbWFzdGVyL3NyYy9zaW1wbGVfbWFya2V0LnNvbAogKi8KCmNvbnRyYWN0IFNhZmVNYXRoIHsKCiAgZnVuY3Rpb24gc2FmZU11bCh1aW50IGEsIHVpbnQgYikgcHVyZSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICB1aW50IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CiAgZnVuY3Rpb24gc2FmZVN1Yih1aW50IGEsIHVpbnQgYikgcHVyZSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CiAgZnVuY3Rpb24gc2FmZUFkZCh1aW50IGEsIHVpbnQgYikgcHVyZSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICB1aW50IGMgPSBhICsgYjsKICAgIGFzc2VydChjPj1hICYmIGM+PWIpOwogICAgcmV0dXJuIGM7CiAgfQogIGZ1bmN0aW9uIHNhZmVOdW1EaWdpdHModWludCBudW1iZXIpIHB1cmUgaW50ZXJuYWwgcmV0dXJucyAodWludDgpIHsKICAgIHVpbnQ4IGRpZ2l0cyA9IDA7CiAgICB3aGlsZSAobnVtYmVyICE9IDApIHsKICAgICAgICBudW1iZXIgLz0gMTA7CiAgICAgICAgZGlnaXRzKys7CiAgICB9CiAgICByZXR1cm4gZGlnaXRzOwp9CgogIC8vIG1pdGlnYXRlIHNob3J0IGFkZHJlc3MgYXR0YWNrCiAgLy8gdGhhbmtzIHRvIGh0dHBzOi8vZ2l0aHViLmNvbS9udW1lcmFpL2NvbnRyYWN0L2Jsb2IvYzE4MjQ2NWY4MmU1MGNlZDhkYWNiMzk3N2VjMzc0YTg5MmY1ZmE4Yy9jb250cmFjdHMvU2FmZS5zb2wjTDMwLUwzNC4KICAvLyBUT0RPOiBkb3VibGVjaGVjayBpbXBsaWNhdGlvbiBvZiA+PSBjb21wYXJlZCB0byA9PQogIG1vZGlmaWVyIG9ubHlQYXlsb2FkU2l6ZSh1aW50IG51bVdvcmRzKSB7CiAgICAgYXNzZXJ0KG1zZy5kYXRhLmxlbmd0aCA+PSBudW1Xb3JkcyAqIDMyICsgNCk7CiAgICAgXzsKICB9Cgp9Cgpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIFRva2VuLCBTYWZlTWF0aCB7CgogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMikgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIF92YWx1ZSA+IDApOwogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gc2FmZVN1YihiYWxhbmNlc1ttc2cuc2VuZGVyXSwgX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gc2FmZUFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDMpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKGJhbGFuY2VzW19mcm9tXSA+PSBfdmFsdWUgJiYgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIF92YWx1ZSA+IDApOwogICAgICAgIGJhbGFuY2VzW19mcm9tXSA9IHNhZmVTdWIoYmFsYW5jZXNbX2Zyb21dLCBfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBzYWZlQWRkKGJhbGFuY2VzW190b10sIF92YWx1ZSk7CiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBzYWZlU3ViKGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLCBfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogICAgfQoKICAgIC8vIFRvIGNoYW5nZSB0aGUgYXBwcm92ZSBhbW91bnQgeW91IGZpcnN0IGhhdmUgdG8gcmVkdWNlIHRoZSBhZGRyZXNzZXMnCiAgICAvLyAgYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyAnYXBwcm92ZShfc3BlbmRlciwgMCknIGlmIGl0IGlzIG5vdAogICAgLy8gIGFscmVhZHkgMCB0byBtaXRpZ2F0ZSB0aGUgcmFjZSBjb25kaXRpb24gZGVzY3JpYmVkIGhlcmU6CiAgICAvLyAgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyBvbmx5UGF5bG9hZFNpemUoMikgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmVxdWlyZSgoX3ZhbHVlID09IDApIHx8IChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9PSAwKSk7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYW5nZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX29sZFZhbHVlLCB1aW50MjU2IF9uZXdWYWx1ZSkgcHVibGljIG9ubHlQYXlsb2FkU2l6ZSgzKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXF1aXJlKGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID09IF9vbGRWYWx1ZSk7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfbmV3VmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF9uZXdWYWx1ZSk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7Cgp9Cgpjb250cmFjdCBHUk8gaXMgU3RhbmRhcmRUb2tlbiB7CiAgICAvLyBGSUVMRFMKICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICJHcm9uIERpZ2l0YWwiOwogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAiR1JPIjsKICAgIHVpbnQyNTYgcHVibGljIGRlY2ltYWxzID0gMTg7CiAgICBzdHJpbmcgcHVibGljIHZlcnNpb24gPSAiOS4wIjsKCiAgICB1aW50MjU2IHB1YmxpYyB0b2tlbkNhcCA9IDk1MDAwMDAwMCAqIDEwKioxODsKCiAgICAvLyBjcm93ZHNhbGUgcGFyYW1ldGVycwogICAgdWludDI1NiBwdWJsaWMgZnVuZGluZ1N0YXJ0QmxvY2s7CiAgICB1aW50MjU2IHB1YmxpYyBmdW5kaW5nRW5kQmxvY2s7CgogICAgLy8gdmVzdGluZyBmaWVsZHMKICAgIGFkZHJlc3MgcHVibGljIHZlc3RpbmdDb250cmFjdDsKICAgIGJvb2wgcHJpdmF0ZSB2ZXN0aW5nU2V0ID0gZmFsc2U7CgogICAgLy8gcm9vdCBjb250cm9sCiAgICBhZGRyZXNzIHB1YmxpYyBmdW5kV2FsbGV0OwogICAgLy8gY29udHJvbCBvZiBsaXF1aWRpdHkgYW5kIGxpbWl0ZWQgY29udHJvbCBvZiB1cGRhdGVQcmljZQogICAgYWRkcmVzcyBwdWJsaWMgY29udHJvbFdhbGxldDsKICAgIC8vIHRpbWUgdG8gd2FpdCBiZXR3ZWVuIGNvbnRyb2xXYWxsZXQgcHJpY2UgdXBkYXRlcwogICAgdWludDI1NiBwdWJsaWMgd2FpdFRpbWUgPSA1IGhvdXJzOwoKICAgIC8vIGZ1bmRXYWxsZXQgY29udHJvbGxlZCBzdGF0ZSB2YXJpYWJsZXMKICAgIC8vIGhhbHRlZDogaGFsdCBidXlpbmcgZHVlIHRvIGVtZXJnZW5jeSwgdHJhZGVhYmxlOiBzaWduYWwgdGhhdCBHUk9OIHBsYXRmb3JtIGlzIHVwIGFuZCBydW5uaW5nCiAgICBib29sIHB1YmxpYyBoYWx0ZWQgPSBmYWxzZTsKICAgIGJvb2wgcHVibGljIHRyYWRlYWJsZSA9IGZhbHNlOwoKICAgIC8vIC0tIHRvdGFsU3VwcGx5IGRlZmluZWQgaW4gU3RhbmRhcmRUb2tlbgogICAgLy8gLS0gbWFwcGluZyB0byB0b2tlbiBiYWxhbmNlcyBkb25lIGluIFN0YW5kYXJkVG9rZW4KCiAgICB1aW50MjU2IHB1YmxpYyBwcmV2aW91c1VwZGF0ZVRpbWUgPSAwOwogICAgUHJpY2UgcHVibGljIGN1cnJlbnRQcmljZTsKICAgIHVpbnQyNTYgcHVibGljIG1pbkFtb3VudCA9IDAuMDUgZXRoZXI7IC8vIDUwMCBHUk8KCiAgICAvLyBtYXAgcGFydGljaXBhbnQgYWRkcmVzcyB0byBhIHdpdGhkcmF3YWwgcmVxdWVzdAogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBXaXRoZHJhd2FsKSBwdWJsaWMgd2l0aGRyYXdhbHM7CiAgICAvLyBtYXBzIHByZXZpb3VzVXBkYXRlVGltZSB0byB0aGUgbmV4dCBwcmljZQogICAgbWFwcGluZyAodWludDI1NiA9PiBQcmljZSkgcHVibGljIHByaWNlczsKICAgIC8vIG1hcHMgYWRkcmVzc2VzCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyB3aGl0ZWxpc3Q7CgogICAgLy8gVFlQRVMKCiAgICBzdHJ1Y3QgUHJpY2UgeyAvLyB0b2tlbnNQZXJFdGgKICAgICAgICB1aW50MjU2IG51bWVyYXRvcjsKICAgIH0KCiAgICBzdHJ1Y3QgV2l0aGRyYXdhbCB7CiAgICAgICAgdWludDI1NiB0b2tlbnM7CiAgICAgICAgdWludDI1NiB0aW1lOyAvLyB0aW1lIGZvciBlYWNoIHdpdGhkcmF3YWwgaXMgc2V0IHRvIHRoZSBwcmV2aW91c1VwZGF0ZVRpbWUKICAgIH0KCiAgICAvLyBFVkVOVFMKCiAgICBldmVudCBCdXkoYWRkcmVzcyBpbmRleGVkIHBhcnRpY2lwYW50LCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgd2VpVmFsdWUsIHVpbnQyNTYgYW1vdW50VG9rZW5zKTsKICAgIGV2ZW50IEFsbG9jYXRlUHJlc2FsZShhZGRyZXNzIGluZGV4ZWQgcGFydGljaXBhbnQsIHVpbnQyNTYgYW1vdW50VG9rZW5zKTsKICAgIGV2ZW50IEJvbnVzQWxsb2NhdGlvbihhZGRyZXNzIGluZGV4ZWQgcGFydGljaXBhbnQsIHN0cmluZyBwYXJ0aWNpcGFudF9hZGRyLCB1aW50MjU2IGJvbnVzVG9rZW5zKTsgICAgCiAgICBldmVudCBXaGl0ZWxpc3QoYWRkcmVzcyBpbmRleGVkIHBhcnRpY2lwYW50KTsKICAgIGV2ZW50IFByaWNlVXBkYXRlKHVpbnQyNTYgbnVtZXJhdG9yKTsKICAgIGV2ZW50IEFkZExpcXVpZGl0eSh1aW50MjU2IGV0aEFtb3VudCk7CiAgICBldmVudCBSZW1vdmVMaXF1aWRpdHkodWludDI1NiBldGhBbW91bnQpOwogICAgZXZlbnQgV2l0aGRyYXdSZXF1ZXN0KGFkZHJlc3MgaW5kZXhlZCBwYXJ0aWNpcGFudCwgdWludDI1NiBhbW91bnRUb2tlbnMpOwogICAgZXZlbnQgV2l0aGRyYXcoYWRkcmVzcyBpbmRleGVkIHBhcnRpY2lwYW50LCB1aW50MjU2IGFtb3VudFRva2VucywgdWludDI1NiBldGhlckFtb3VudCk7CgogICAgLy8gTU9ESUZJRVJTCgogICAgbW9kaWZpZXIgaXNUcmFkZWFibGUgeyAvLyBleGVtcHQgdmVzdGluZ0NvbnRyYWN0IGFuZCBmdW5kV2FsbGV0IHRvIGFsbG93IGRldiBhbGxvY2F0aW9ucwogICAgICAgIHJlcXVpcmUodHJhZGVhYmxlIHx8IG1zZy5zZW5kZXIgPT0gZnVuZFdhbGxldCB8fCBtc2cuc2VuZGVyID09IHZlc3RpbmdDb250cmFjdCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5V2hpdGVsaXN0IHsKICAgICAgICByZXF1aXJlKHdoaXRlbGlzdFttc2cuc2VuZGVyXSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5RnVuZFdhbGxldCB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGZ1bmRXYWxsZXQpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seU1hbmFnaW5nV2FsbGV0cyB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNvbnRyb2xXYWxsZXQgfHwgbXNnLnNlbmRlciA9PSBmdW5kV2FsbGV0KTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlfaWZfY29udHJvbFdhbGxldCB7CiAgICAgICAgaWYgKG1zZy5zZW5kZXIgPT0gY29udHJvbFdhbGxldCkgXzsKICAgIH0KICAgIG1vZGlmaWVyIHJlcXVpcmVfd2FpdGVkIHsKICAgICAgcmVxdWlyZShzYWZlU3ViKGN1cnJlbnRUaW1lKCksIHdhaXRUaW1lKSA+PSBwcmV2aW91c1VwZGF0ZVRpbWUpOwogICAgICAgIF87CiAgICB9CiAgICBtb2RpZmllciBvbmx5X2lmX2RlY3JlYXNlICh1aW50MjU2IG5ld051bWVyYXRvcikgewogICAgICAgIGlmIChuZXdOdW1lcmF0b3IgPCBjdXJyZW50UHJpY2UubnVtZXJhdG9yKSBfOwogICAgfQoKICAgIC8vIENPTlNUUlVDVE9SCiAgICBmdW5jdGlvbiBHUk8oKSBwdWJsaWMgewogICAgICAgIGZ1bmRXYWxsZXQgPSBtc2cuc2VuZGVyOwogICAgICAgIHdoaXRlbGlzdFtmdW5kV2FsbGV0XSA9IHRydWU7CiAgICAgICAgcHJldmlvdXNVcGRhdGVUaW1lID0gY3VycmVudFRpbWUoKTsKICAgIH0KCiAgICAvLyBDYWxsZWQgYWZ0ZXIgZGVwbG95bWVudAogICAgLy8gTm90IGFsbCBkZXBsb3ltZW50IGNsaWVudHMgc3VwcG9ydCBjb25zdHJ1Y3RvciBhcmd1bWVudHMuCiAgICAvLyBUaGlzIGZ1bmN0aW9uIGlzIHByb3ZpZGVkIGZvciBtYXhpbXVtIGNvbXBhdGliaWxpdHkuIAogICAgZnVuY3Rpb24gaW5pdGlhbGlzZUNvbnRyYWN0KGFkZHJlc3MgY29udHJvbFdhbGxldElucHV0LCB1aW50MjU2IHByaWNlTnVtZXJhdG9ySW5wdXQsIHVpbnQyNTYgc3RhcnRCbG9ja0lucHV0LCB1aW50MjU2IGVuZEJsb2NrSW5wdXQpIGV4dGVybmFsIG9ubHlGdW5kV2FsbGV0IHsKICAgICAgcmVxdWlyZShjb250cm9sV2FsbGV0SW5wdXQgIT0gYWRkcmVzcygwKSk7CiAgICAgIHJlcXVpcmUocHJpY2VOdW1lcmF0b3JJbnB1dCA+IDApOwogICAgICByZXF1aXJlKGVuZEJsb2NrSW5wdXQgPiBzdGFydEJsb2NrSW5wdXQpOwogICAgICBjb250cm9sV2FsbGV0ID0gY29udHJvbFdhbGxldElucHV0OwogICAgICB3aGl0ZWxpc3RbY29udHJvbFdhbGxldF0gPSB0cnVlOwogICAgICBjdXJyZW50UHJpY2UgPSBQcmljZShwcmljZU51bWVyYXRvcklucHV0KTsKICAgICAgZnVuZGluZ1N0YXJ0QmxvY2sgPSBzdGFydEJsb2NrSW5wdXQ7CiAgICAgIGZ1bmRpbmdFbmRCbG9jayA9IGVuZEJsb2NrSW5wdXQ7CiAgICAgIHByZXZpb3VzVXBkYXRlVGltZSA9IGN1cnJlbnRUaW1lKCk7CiAgICB9CgogICAgLy8gTUVUSE9EUwoKICAgIGZ1bmN0aW9uIHNldFZlc3RpbmdDb250cmFjdChhZGRyZXNzIHZlc3RpbmdDb250cmFjdElucHV0KSBleHRlcm5hbCBvbmx5RnVuZFdhbGxldCB7CiAgICAgICAgcmVxdWlyZSh2ZXN0aW5nQ29udHJhY3RJbnB1dCAhPSBhZGRyZXNzKDApKTsKICAgICAgICB2ZXN0aW5nQ29udHJhY3QgPSB2ZXN0aW5nQ29udHJhY3RJbnB1dDsKICAgICAgICB3aGl0ZWxpc3RbdmVzdGluZ0NvbnRyYWN0XSA9IHRydWU7CiAgICAgICAgdmVzdGluZ1NldCA9IHRydWU7CiAgICB9CgogICAgLy8gYWxsb3dzIGNvbnRyb2xXYWxsZXQgdG8gdXBkYXRlIHRoZSBwcmljZSB3aXRoaW4gYSB0aW1lIGNvbnRzdHJhaW50LCBhbGxvd3MgZnVuZFdhbGxldCBjb21wbGV0ZSBjb250cm9sCiAgICBmdW5jdGlvbiB1cGRhdGVQcmljZSh1aW50MjU2IG5ld051bWVyYXRvcikgZXh0ZXJuYWwgb25seU1hbmFnaW5nV2FsbGV0cyB7CiAgICAgICAgcmVxdWlyZShuZXdOdW1lcmF0b3IgPiAwKTsKICAgICAgICByZXF1aXJlX2xpbWl0ZWRfY2hhbmdlKG5ld051bWVyYXRvcik7CiAgICAgICAgLy8gZWl0aGVyIGNvbnRyb2xXYWxsZXQgY29tbWFuZCBpcyBjb21wbGlhbnQgb3IgdHJhbnNhY3Rpb24gY2FtZSBmcm9tIGZ1bmRXYWxsZXQKICAgICAgICBjdXJyZW50UHJpY2UubnVtZXJhdG9yID0gbmV3TnVtZXJhdG9yOwogICAgICAgIC8vIG1hcHMgdGltZSB0byBuZXcgUHJpY2UgKGlmIG5vdCBkdXJpbmcgSUNPKQogICAgICAgIHByaWNlc1twcmV2aW91c1VwZGF0ZVRpbWVdID0gY3VycmVudFByaWNlOwogICAgICAgIHByZXZpb3VzVXBkYXRlVGltZSA9IGN1cnJlbnRUaW1lKCk7CiAgICAgICAgUHJpY2VVcGRhdGUobmV3TnVtZXJhdG9yKTsKICAgIH0KCiAgICBmdW5jdGlvbiByZXF1aXJlX2xpbWl0ZWRfY2hhbmdlICh1aW50MjU2IG5ld051bWVyYXRvcikKICAgICAgcHJpdmF0ZQogICAgICB2aWV3CiAgICAgIG9ubHlfaWZfY29udHJvbFdhbGxldAogICAgICByZXF1aXJlX3dhaXRlZAogICAgICBvbmx5X2lmX2RlY3JlYXNlKG5ld051bWVyYXRvcikKICAgIHsKICAgICAgICB1aW50MjU2IHBlcmNlbnRhZ2VfZGlmZiA9IDA7CiAgICAgICAgcGVyY2VudGFnZV9kaWZmID0gc2FmZU11bChuZXdOdW1lcmF0b3IsIDEwMCkgLyBjdXJyZW50UHJpY2UubnVtZXJhdG9yOwogICAgICAgIHBlcmNlbnRhZ2VfZGlmZiA9IHNhZmVTdWIoMTAwLCBwZXJjZW50YWdlX2RpZmYpOwogICAgICAgIC8vIGNvbnRyb2xXYWxsZXQgY2FuIG9ubHkgaW5jcmVhc2UgcHJpY2UgYnkgbWF4IDIwJSBhbmQgb25seSBldmVyeSB3YWl0VGltZQogICAgICAgIHJlcXVpcmUocGVyY2VudGFnZV9kaWZmIDw9IDIwKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhbGxvY2F0ZVRva2VucyhhZGRyZXNzIHBhcnRpY2lwYW50LCB1aW50MjU2IGFtb3VudFRva2VucykgcHJpdmF0ZSB7CiAgICAgICAgcmVxdWlyZSh2ZXN0aW5nU2V0KTsKICAgICAgICAvLyA0MCUgb2YgdG90YWwgYWxsb2NhdGVkIGZvciBGb3VuZGVycywgVGVhbSBpbmNlbnRpdmVzICYgQm9udXNlcy4KCgkvLyBTb2xpZGl0eSB2MC40LjE4IC0gZmxvYXRpbmcgcG9pbnQgaXMgbm90IGZ1bGx5IHN1cHBvcnRlZCwKCS8vIHNvIG9mdGVuIGludGVnZXIgZGl2aXNpb24gcmVzdWx0cyBpbiB0cnVuY2F0ZWQgdmFsdWVzLgoJLy8gVGhlcmVmb3JlIHdlIGFyZSBtdWx0aXBseWluZyBvdXQgYnkgMTAwMDAwMCBmb3IKCS8vIHByZWNpc2lvbi4gVGhpcyBhbGxvd3MgcmF0aW9zIHZhbHVlcyB1cCB0byAwLjAwMDB4IG9yIDAuMDB4IHBlcmNlbnQKCXVpbnQyNTYgcHJlY2lzaW9uID0gMTAqKjE4OwoJdWludDI1NiBhbGxvY2F0aW9uUmF0aW8gPSBzYWZlTXVsKGFtb3VudFRva2VucywgcHJlY2lzaW9uKSAvIDU3MDAwMDAwMDsKICAgICAgICB1aW50MjU2IGRldmVsb3BtZW50QWxsb2NhdGlvbiA9IHNhZmVNdWwoYWxsb2NhdGlvblJhdGlvLCAzODAwMDAwMDApIC8gcHJlY2lzaW9uOwogICAgICAgIC8vIGNoZWNrIHRoYXQgdG9rZW4gY2FwIGlzIG5vdCBleGNlZWRlZAogICAgICAgIHVpbnQyNTYgbmV3VG9rZW5zID0gc2FmZUFkZChhbW91bnRUb2tlbnMsIGRldmVsb3BtZW50QWxsb2NhdGlvbik7CiAgICAgICAgcmVxdWlyZShzYWZlQWRkKHRvdGFsU3VwcGx5LCBuZXdUb2tlbnMpIDw9IHRva2VuQ2FwKTsKICAgICAgICAvLyBpbmNyZWFzZSB0b2tlbiBzdXBwbHksIGFzc2lnbiB0b2tlbnMgdG8gcGFydGljaXBhbnQKICAgICAgICB0b3RhbFN1cHBseSA9IHNhZmVBZGQodG90YWxTdXBwbHksIG5ld1Rva2Vucyk7CiAgICAgICAgYmFsYW5jZXNbcGFydGljaXBhbnRdID0gc2FmZUFkZChiYWxhbmNlc1twYXJ0aWNpcGFudF0sIGFtb3VudFRva2Vucyk7CiAgICAgICAgYmFsYW5jZXNbdmVzdGluZ0NvbnRyYWN0XSA9IHNhZmVBZGQoYmFsYW5jZXNbdmVzdGluZ0NvbnRyYWN0XSwgZGV2ZWxvcG1lbnRBbGxvY2F0aW9uKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gYWxsb2NhdGVQcmVzYWxlVG9rZW5zKAoJCQkgICAgICAgYWRkcmVzcyBwYXJ0aWNpcGFudF9hZGRyZXNzLAoJCQkgICAgICAgc3RyaW5nIHBhcnRpY2lwYW50X3N0ciwKCQkJICAgICAgIHVpbnQyNTYgYW1vdW50VG9rZW5zLAoJCQkgICAgICAgc3RyaW5nIHR4bkhhc2gKCQkJICAgICAgICkKICAgICAgZXh0ZXJuYWwgb25seUZ1bmRXYWxsZXQgewoKICAgICAgcmVxdWlyZShjdXJyZW50QmxvY2soKSA8IGZ1bmRpbmdFbmRCbG9jayk7CiAgICAgIHJlcXVpcmUocGFydGljaXBhbnRfYWRkcmVzcyAhPSBhZGRyZXNzKDApKTsKICAgICAKICAgICAgdWludDI1NiBib251c1Rva2VucyA9IDA7CiAgICAgIHVpbnQyNTYgdG90YWxUb2tlbnMgPSBhbW91bnRUb2tlbnM7CgogICAgICBpZiAoZmlyc3REaWdpdCh0eG5IYXNoKSA9PSBmaXJzdERpZ2l0KHBhcnRpY2lwYW50X3N0cikpIHsKCSAgLy8gQ2FsY3VsYXRlIDEwJSBib251cwoJICBib251c1Rva2VucyA9IHNhZmVNdWwodG90YWxUb2tlbnMsIDEwKSAvIDEwMDsKCSAgdG90YWxUb2tlbnMgPSBzYWZlQWRkKHRvdGFsVG9rZW5zLCBib251c1Rva2Vucyk7CiAgICAgIH0KCiAgICAgICAgd2hpdGVsaXN0W3BhcnRpY2lwYW50X2FkZHJlc3NdID0gdHJ1ZTsKICAgICAgICBhbGxvY2F0ZVRva2VucyhwYXJ0aWNpcGFudF9hZGRyZXNzLCB0b3RhbFRva2Vucyk7CiAgICAgICAgV2hpdGVsaXN0KHBhcnRpY2lwYW50X2FkZHJlc3MpOwogICAgICAgIEFsbG9jYXRlUHJlc2FsZShwYXJ0aWNpcGFudF9hZGRyZXNzLCB0b3RhbFRva2Vucyk7CglCb251c0FsbG9jYXRpb24ocGFydGljaXBhbnRfYWRkcmVzcywgcGFydGljaXBhbnRfc3RyLCBib251c1Rva2Vucyk7CiAgICB9CgogICAgLy8gcmV0dXJucyB0aGUgZmlyc3QgY2hhcmFjdGVyIGFzIGEgYnl0ZSBpbiBhIGdpdmVuIHN0cmluZyBhZGRyZXNzCiAgICAvLyBHaXZlbiAweDFhYmNkLi4uIHJldHVybnMgMSAKICAgIGZ1bmN0aW9uIGZpcnN0RGlnaXQoc3RyaW5nIHMpIHB1cmUgcHVibGljIHJldHVybnMoYnl0ZSl7CglieXRlcyBtZW1vcnkgc3RyQnl0ZXMgPSBieXRlcyhzKTsKCXJldHVybiBzdHJCeXRlc1syXTsKICAgICAgfQoKICAgIGZ1bmN0aW9uIHZlcmlmeVBhcnRpY2lwYW50KGFkZHJlc3MgcGFydGljaXBhbnQpIGV4dGVybmFsIG9ubHlNYW5hZ2luZ1dhbGxldHMgewogICAgICAgIHdoaXRlbGlzdFtwYXJ0aWNpcGFudF0gPSB0cnVlOwogICAgICAgIFdoaXRlbGlzdChwYXJ0aWNpcGFudCk7CiAgICB9CgogICAgZnVuY3Rpb24gYnV5KCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgYnV5VG8obXNnLnNlbmRlcik7CiAgICB9CgogICAgZnVuY3Rpb24gYnV5VG8oYWRkcmVzcyBwYXJ0aWNpcGFudCkgcHVibGljIHBheWFibGUgb25seVdoaXRlbGlzdCB7CiAgICAgICAgcmVxdWlyZSghaGFsdGVkKTsKICAgICAgICByZXF1aXJlKHBhcnRpY2lwYW50ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID49IG1pbkFtb3VudCk7CiAgICAgICAgcmVxdWlyZShjdXJyZW50QmxvY2soKSA+PSBmdW5kaW5nU3RhcnRCbG9jayAmJiBjdXJyZW50QmxvY2soKSA8IGZ1bmRpbmdFbmRCbG9jayk7CgkvLyBtc2cudmFsdWUgaW4gd2VpIC0gc2NhbGUgdG8gZXRoZXIgYWZ0ZXIgYXBwbHlpbmcgcHJpY2UgbnVtZXJhdG9yCiAgICAgICAgdWludDI1NiB0b2tlbnNUb0J1eSA9IHNhZmVNdWwobXNnLnZhbHVlLCBjdXJyZW50UHJpY2UubnVtZXJhdG9yKSAvICgxIGV0aGVyKTsKICAgICAgICBhbGxvY2F0ZVRva2VucyhwYXJ0aWNpcGFudCwgdG9rZW5zVG9CdXkpOwogICAgICAgIC8vIHNlbmQgZXRoZXIgdG8gZnVuZFdhbGxldAogICAgICAgIGZ1bmRXYWxsZXQudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgICAgICBCdXkobXNnLnNlbmRlciwgcGFydGljaXBhbnQsIG1zZy52YWx1ZSwgdG9rZW5zVG9CdXkpOwogICAgfQoKICAgIC8vIHRpbWUgYmFzZWQgb24gYmxvY2tudW1iZXJzLCBhc3N1bWluZyBhIGJsb2NrdGltZSBvZiAxNXMKICAgIGZ1bmN0aW9uIGljb051bWVyYXRvclByaWNlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IGljb0R1cmF0aW9uID0gc2FmZVN1YihjdXJyZW50QmxvY2soKSwgZnVuZGluZ1N0YXJ0QmxvY2spOwogICAgICAgIHVpbnQyNTYgbnVtZXJhdG9yOwoKICAgICAgICB1aW50MjU2IGZpcnN0QmxvY2tQaGFzZSA9IDgwNjQwOyAvLyAjYmxvY2tzID0gMio3KjI0KjYwKjYwLzE1ID0gODA2NDAKICAgICAgICB1aW50MjU2IHNlY29uZEJsb2NrUGhhc2UgPSAxNjEyODA7IC8vIC8vICNibG9ja3MgPSA0KjcqMjQqNjAqNjAvMTUgPSAxNjEyODAKICAgICAgICB1aW50MjU2IHRoaXJkQmxvY2tQaGFzZSA9IDI0MTkyMDsgLy8gLy8gI2Jsb2NrcyA9IDYqNyoyNCo2MCo2MC8xNSA9IDI0MTkyMAogICAgICAgIC8vdWludDI1NiBmb3VydGhCbG9jayA9IDMyMjU2MDsgLy8gI2Jsb2NrcyA9IEdyZWF0ZXIgVGhhbiB0aGlyZEJsb2NrCgogICAgICAgIGlmIChpY29EdXJhdGlvbiA8IGZpcnN0QmxvY2tQaGFzZSApIHsKICAgICAgICAgICAgbnVtZXJhdG9yID0gMTMwMDA7CgkgICAgcmV0dXJuIG51bWVyYXRvcjsKICAgICAgICB9IGVsc2UgaWYgKGljb0R1cmF0aW9uIDwgc2Vjb25kQmxvY2tQaGFzZSApIHsgCiAgICAgICAgICAgIG51bWVyYXRvciA9IDEyMDAwOwoJICAgIHJldHVybiBudW1lcmF0b3I7CiAgICAgICAgfSBlbHNlIGlmIChpY29EdXJhdGlvbiA8IHRoaXJkQmxvY2tQaGFzZSApIHsgCiAgICAgICAgICAgIG51bWVyYXRvciA9IDExMDAwOwoJICAgIHJldHVybiBudW1lcmF0b3I7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbnVtZXJhdG9yID0gMTAwMDA7CgkgICAgcmV0dXJuIG51bWVyYXRvcjsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gY3VycmVudEJsb2NrKCkgcHJpdmF0ZSBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYgX2N1cnJlbnRCbG9jaykgewogICAgICByZXR1cm4gYmxvY2subnVtYmVyOwogICAgfQoKICAgIGZ1bmN0aW9uIGN1cnJlbnRUaW1lKCkgcHJpdmF0ZSBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYgX2N1cnJlbnRUaW1lKSB7CiAgICAgIHJldHVybiBub3c7CiAgICB9ICAgICAgCgogICAgZnVuY3Rpb24gcmVxdWVzdFdpdGhkcmF3YWwodWludDI1NiBhbW91bnRUb2tlbnNUb1dpdGhkcmF3KSBleHRlcm5hbCBpc1RyYWRlYWJsZSBvbmx5V2hpdGVsaXN0IHsKICAgICAgcmVxdWlyZShjdXJyZW50QmxvY2soKSA+IGZ1bmRpbmdFbmRCbG9jayk7CiAgICAgICAgcmVxdWlyZShhbW91bnRUb2tlbnNUb1dpdGhkcmF3ID4gMCk7CiAgICAgICAgYWRkcmVzcyBwYXJ0aWNpcGFudCA9IG1zZy5zZW5kZXI7CiAgICAgICAgcmVxdWlyZShiYWxhbmNlT2YocGFydGljaXBhbnQpID49IGFtb3VudFRva2Vuc1RvV2l0aGRyYXcpOwogICAgICAgIHJlcXVpcmUod2l0aGRyYXdhbHNbcGFydGljaXBhbnRdLnRva2VucyA9PSAwKTsgLy8gcGFydGljaXBhbnQgY2Fubm90IGhhdmUgb3V0c3RhbmRpbmcgd2l0aGRyYXdhbHMKICAgICAgICBiYWxhbmNlc1twYXJ0aWNpcGFudF0gPSBzYWZlU3ViKGJhbGFuY2VzW3BhcnRpY2lwYW50XSwgYW1vdW50VG9rZW5zVG9XaXRoZHJhdyk7CiAgICAgICAgd2l0aGRyYXdhbHNbcGFydGljaXBhbnRdID0gV2l0aGRyYXdhbCh7dG9rZW5zOiBhbW91bnRUb2tlbnNUb1dpdGhkcmF3LCB0aW1lOiBwcmV2aW91c1VwZGF0ZVRpbWV9KTsKICAgICAgICBXaXRoZHJhd1JlcXVlc3QocGFydGljaXBhbnQsIGFtb3VudFRva2Vuc1RvV2l0aGRyYXcpOwogICAgfQoKICAgIGZ1bmN0aW9uIHdpdGhkcmF3KCkgZXh0ZXJuYWwgewogICAgICAgIGFkZHJlc3MgcGFydGljaXBhbnQgPSBtc2cuc2VuZGVyOwogICAgICAgIHVpbnQyNTYgdG9rZW5zID0gd2l0aGRyYXdhbHNbcGFydGljaXBhbnRdLnRva2VuczsKICAgICAgICByZXF1aXJlKHRva2VucyA+IDApOyAvLyBwYXJ0aWNpcGFudCBtdXN0IGhhdmUgcmVxdWVzdGVkIGEgd2l0aGRyYXdhbAogICAgICAgIHVpbnQyNTYgcmVxdWVzdFRpbWUgPSB3aXRoZHJhd2Fsc1twYXJ0aWNpcGFudF0udGltZTsKICAgICAgICAvLyBvYnRhaW4gdGhlIG5leHQgcHJpY2UgdGhhdCB3YXMgc2V0IGFmdGVyIHRoZSByZXF1ZXN0CiAgICAgICAgUHJpY2UgcHJpY2UgPSBwcmljZXNbcmVxdWVzdFRpbWVdOwogICAgICAgIHJlcXVpcmUocHJpY2UubnVtZXJhdG9yID4gMCk7IC8vIHByaWNlIG11c3QgaGF2ZSBiZWVuIHNldAogICAgICAgIHVpbnQyNTYgd2l0aGRyYXdWYWx1ZSA9IHNhZmVNdWwodG9rZW5zLCBwcmljZS5udW1lcmF0b3IpOwogICAgICAgIC8vIGlmIGNvbnRyYWN0IGV0aGJhbCA+IHRoZW4gc2VuZCArIHRyYW5zZmVyIHRva2VucyB0byBmdW5kV2FsbGV0LCBvdGhlcndpc2UgZ2l2ZSB0b2tlbnMgYmFjawogICAgICAgIHdpdGhkcmF3YWxzW3BhcnRpY2lwYW50XS50b2tlbnMgPSAwOwogICAgICAgIGlmICh0aGlzLmJhbGFuY2UgPj0gd2l0aGRyYXdWYWx1ZSkKICAgICAgICAgICAgZW5hY3Rfd2l0aGRyYXdhbF9ncmVhdGVyX2VxdWFsKHBhcnRpY2lwYW50LCB3aXRoZHJhd1ZhbHVlLCB0b2tlbnMpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgZW5hY3Rfd2l0aGRyYXdhbF9sZXNzKHBhcnRpY2lwYW50LCB3aXRoZHJhd1ZhbHVlLCB0b2tlbnMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGVuYWN0X3dpdGhkcmF3YWxfZ3JlYXRlcl9lcXVhbChhZGRyZXNzIHBhcnRpY2lwYW50LCB1aW50MjU2IHdpdGhkcmF3VmFsdWUsIHVpbnQyNTYgdG9rZW5zKQogICAgICAgIHByaXZhdGUKICAgIHsKICAgICAgICBhc3NlcnQodGhpcy5iYWxhbmNlID49IHdpdGhkcmF3VmFsdWUpOwogICAgICAgIGJhbGFuY2VzW2Z1bmRXYWxsZXRdID0gc2FmZUFkZChiYWxhbmNlc1tmdW5kV2FsbGV0XSwgdG9rZW5zKTsKICAgICAgICBwYXJ0aWNpcGFudC50cmFuc2Zlcih3aXRoZHJhd1ZhbHVlKTsKICAgICAgICBXaXRoZHJhdyhwYXJ0aWNpcGFudCwgdG9rZW5zLCB3aXRoZHJhd1ZhbHVlKTsKICAgIH0KICAgIGZ1bmN0aW9uIGVuYWN0X3dpdGhkcmF3YWxfbGVzcyhhZGRyZXNzIHBhcnRpY2lwYW50LCB1aW50MjU2IHdpdGhkcmF3VmFsdWUsIHVpbnQyNTYgdG9rZW5zKQogICAgICAgIHByaXZhdGUKICAgIHsKICAgICAgICBhc3NlcnQodGhpcy5iYWxhbmNlIDwgd2l0aGRyYXdWYWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbcGFydGljaXBhbnRdID0gc2FmZUFkZChiYWxhbmNlc1twYXJ0aWNpcGFudF0sIHRva2Vucyk7CiAgICAgICAgV2l0aGRyYXcocGFydGljaXBhbnQsIHRva2VucywgMCk7IC8vIGluZGljYXRlIGEgZmFpbGVkIHdpdGhkcmF3YWwKICAgIH0KCgogICAgZnVuY3Rpb24gY2hlY2tXaXRoZHJhd1ZhbHVlKHVpbnQyNTYgYW1vdW50VG9rZW5zVG9XaXRoZHJhdykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgZXRoZXJWYWx1ZSkgewogICAgICAgIHJlcXVpcmUoYW1vdW50VG9rZW5zVG9XaXRoZHJhdyA+IDApOwogICAgICAgIHJlcXVpcmUoYmFsYW5jZU9mKG1zZy5zZW5kZXIpID49IGFtb3VudFRva2Vuc1RvV2l0aGRyYXcpOwogICAgICAgIHVpbnQyNTYgd2l0aGRyYXdWYWx1ZSA9IHNhZmVNdWwoYW1vdW50VG9rZW5zVG9XaXRoZHJhdywgY3VycmVudFByaWNlLm51bWVyYXRvcik7CiAgICAgICAgcmVxdWlyZSh0aGlzLmJhbGFuY2UgPj0gd2l0aGRyYXdWYWx1ZSk7CiAgICAgICAgcmV0dXJuIHdpdGhkcmF3VmFsdWU7CiAgICB9CgogICAgLy8gYWxsb3cgZnVuZFdhbGxldCBvciBjb250cm9sV2FsbGV0IHRvIGFkZCBldGhlciB0byBjb250cmFjdAogICAgZnVuY3Rpb24gYWRkTGlxdWlkaXR5KCkgZXh0ZXJuYWwgb25seU1hbmFnaW5nV2FsbGV0cyBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+IDApOwogICAgICAgIEFkZExpcXVpZGl0eShtc2cudmFsdWUpOwogICAgfQoKICAgIC8vIGFsbG93IGZ1bmRXYWxsZXQgdG8gcmVtb3ZlIGV0aGVyIGZyb20gY29udHJhY3QKICAgIGZ1bmN0aW9uIHJlbW92ZUxpcXVpZGl0eSh1aW50MjU2IGFtb3VudCkgZXh0ZXJuYWwgb25seU1hbmFnaW5nV2FsbGV0cyB7CiAgICAgICAgcmVxdWlyZShhbW91bnQgPD0gdGhpcy5iYWxhbmNlKTsKICAgICAgICBmdW5kV2FsbGV0LnRyYW5zZmVyKGFtb3VudCk7CiAgICAgICAgUmVtb3ZlTGlxdWlkaXR5KGFtb3VudCk7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlRnVuZFdhbGxldChhZGRyZXNzIG5ld0Z1bmRXYWxsZXQpIGV4dGVybmFsIG9ubHlGdW5kV2FsbGV0IHsKICAgICAgICByZXF1aXJlKG5ld0Z1bmRXYWxsZXQgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgZnVuZFdhbGxldCA9IG5ld0Z1bmRXYWxsZXQ7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlQ29udHJvbFdhbGxldChhZGRyZXNzIG5ld0NvbnRyb2xXYWxsZXQpIGV4dGVybmFsIG9ubHlGdW5kV2FsbGV0IHsKICAgICAgICByZXF1aXJlKG5ld0NvbnRyb2xXYWxsZXQgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgY29udHJvbFdhbGxldCA9IG5ld0NvbnRyb2xXYWxsZXQ7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlV2FpdFRpbWUodWludDI1NiBuZXdXYWl0VGltZSkgZXh0ZXJuYWwgb25seUZ1bmRXYWxsZXQgewogICAgICAgIHdhaXRUaW1lID0gbmV3V2FpdFRpbWU7CiAgICB9CgogICAgZnVuY3Rpb24gdXBkYXRlRnVuZGluZ1N0YXJ0QmxvY2sodWludDI1NiBuZXdGdW5kaW5nU3RhcnRCbG9jaykgZXh0ZXJuYWwgb25seUZ1bmRXYWxsZXQgewogICAgICByZXF1aXJlKGN1cnJlbnRCbG9jaygpIDwgZnVuZGluZ1N0YXJ0QmxvY2spOwogICAgICAgIHJlcXVpcmUoY3VycmVudEJsb2NrKCkgPCBuZXdGdW5kaW5nU3RhcnRCbG9jayk7CiAgICAgICAgZnVuZGluZ1N0YXJ0QmxvY2sgPSBuZXdGdW5kaW5nU3RhcnRCbG9jazsKICAgIH0KCiAgICBmdW5jdGlvbiB1cGRhdGVGdW5kaW5nRW5kQmxvY2sodWludDI1NiBuZXdGdW5kaW5nRW5kQmxvY2spIGV4dGVybmFsIG9ubHlGdW5kV2FsbGV0IHsKICAgICAgICByZXF1aXJlKGN1cnJlbnRCbG9jaygpIDwgZnVuZGluZ0VuZEJsb2NrKTsKICAgICAgICByZXF1aXJlKGN1cnJlbnRCbG9jaygpIDwgbmV3RnVuZGluZ0VuZEJsb2NrKTsKICAgICAgICBmdW5kaW5nRW5kQmxvY2sgPSBuZXdGdW5kaW5nRW5kQmxvY2s7CiAgICB9CgogICAgZnVuY3Rpb24gaGFsdCgpIGV4dGVybmFsIG9ubHlGdW5kV2FsbGV0IHsKICAgICAgICBoYWx0ZWQgPSB0cnVlOwogICAgfQogICAgZnVuY3Rpb24gdW5oYWx0KCkgZXh0ZXJuYWwgb25seUZ1bmRXYWxsZXQgewogICAgICAgIGhhbHRlZCA9IGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIGVuYWJsZVRyYWRpbmcoKSBleHRlcm5hbCBvbmx5RnVuZFdhbGxldCB7CiAgICAgICAgcmVxdWlyZShjdXJyZW50QmxvY2soKSA+IGZ1bmRpbmdFbmRCbG9jayk7CiAgICAgICAgdHJhZGVhYmxlID0gdHJ1ZTsKICAgIH0KCiAgICAvLyBmYWxsYmFjayBmdW5jdGlvbgogICAgZnVuY3Rpb24oKSBwYXlhYmxlIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZSh0eC5vcmlnaW4gPT0gbXNnLnNlbmRlcik7CiAgICAgICAgYnV5VG8obXNnLnNlbmRlcik7CiAgICB9CgogICAgZnVuY3Rpb24gY2xhaW1Ub2tlbnMoYWRkcmVzcyBfdG9rZW4pIGV4dGVybmFsIG9ubHlGdW5kV2FsbGV0IHsKICAgICAgICByZXF1aXJlKF90b2tlbiAhPSBhZGRyZXNzKDApKTsKICAgICAgICBUb2tlbiB0b2tlbiA9IFRva2VuKF90b2tlbik7CiAgICAgICAgdWludDI1NiBiYWxhbmNlID0gdG9rZW4uYmFsYW5jZU9mKHRoaXMpOwogICAgICAgIHRva2VuLnRyYW5zZmVyKGZ1bmRXYWxsZXQsIGJhbGFuY2UpOwogICAgIH0KCiAgICAvLyBwcmV2ZW50IHRyYW5zZmVycyB1bnRpbCB0cmFkaW5nIGFsbG93ZWQKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIGlzVHJhZGVhYmxlIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgICB9CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgaXNUcmFkZWFibGUgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQp9'.
	

]
