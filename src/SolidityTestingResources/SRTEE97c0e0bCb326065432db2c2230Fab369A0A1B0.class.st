Class {
	#name : #SRTEE97c0e0bCb326065432db2c2230Fab369A0A1B0,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTEE97c0e0bCb326065432db2c2230Fab369A0A1B0 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKY29udHJhY3QgQ3Jvd2RzYWxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgLy8gVGhlIHRva2VuIGJlaW5nIHNvbGQKICBNaW50YWJsZVRva2VuIHB1YmxpYyB0b2tlbjsKCiAgLy8gc3RhcnQgYW5kIGVuZCB0aW1lc3RhbXBzIHdoZXJlIGludmVzdG1lbnRzIGFyZSBhbGxvd2VkIChib3RoIGluY2x1c2l2ZSkKICB1aW50MjU2IHB1YmxpYyBzdGFydFRpbWU7CiAgdWludDI1NiBwdWJsaWMgZW5kVGltZTsKCiAgLy8gYWRkcmVzcyB3aGVyZSBmdW5kcyBhcmUgY29sbGVjdGVkCiAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0OwoKICAvLyBob3cgbWFueSB0b2tlbiB1bml0cyBhIGJ1eWVyIGdldHMgcGVyIHdlaQogIHVpbnQyNTYgcHVibGljIHJhdGU7CgogIC8vIGFtb3VudCBvZiByYWlzZWQgbW9uZXkgaW4gd2VpCiAgdWludDI1NiBwdWJsaWMgd2VpUmFpc2VkOwoKICAvKioKICAgKiBldmVudCBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAqIEBwYXJhbSBwdXJjaGFzZXIgd2hvIHBhaWQgZm9yIHRoZSB0b2tlbnMKICAgKiBAcGFyYW0gYmVuZWZpY2lhcnkgd2hvIGdvdCB0aGUgdG9rZW5zCiAgICogQHBhcmFtIHZhbHVlIHdlaXMgcGFpZCBmb3IgcHVyY2hhc2UKICAgKiBAcGFyYW0gYW1vdW50IGFtb3VudCBvZiB0b2tlbnMgcHVyY2hhc2VkCiAgICovCiAgZXZlbnQgVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgdmFsdWUsIHVpbnQyNTYgYW1vdW50KTsKCgogIGZ1bmN0aW9uIENyb3dkc2FsZSh1aW50MjU2IF9zdGFydFRpbWUsIHVpbnQyNTYgX2VuZFRpbWUsIHVpbnQyNTYgX3JhdGUsIGFkZHJlc3MgX3dhbGxldCkgewogICAgcmVxdWlyZShfc3RhcnRUaW1lID49IG5vdyk7CiAgICByZXF1aXJlKF9lbmRUaW1lID49IF9zdGFydFRpbWUpOwogICAgcmVxdWlyZShfcmF0ZSA+IDApOwogICAgcmVxdWlyZShfd2FsbGV0ICE9IDB4MCk7CgogICAgdG9rZW4gPSBjcmVhdGVUb2tlbkNvbnRyYWN0KCk7CiAgICBzdGFydFRpbWUgPSBfc3RhcnRUaW1lOwogICAgZW5kVGltZSA9IF9lbmRUaW1lOwogICAgcmF0ZSA9IF9yYXRlOwogICAgd2FsbGV0ID0gX3dhbGxldDsKICB9CgogIC8vIGNyZWF0ZXMgdGhlIHRva2VuIHRvIGJlIHNvbGQuCiAgLy8gb3ZlcnJpZGUgdGhpcyBtZXRob2QgdG8gaGF2ZSBjcm93ZHNhbGUgb2YgYSBzcGVjaWZpYyBtaW50YWJsZSB0b2tlbi4KICBmdW5jdGlvbiBjcmVhdGVUb2tlbkNvbnRyYWN0KCkgaW50ZXJuYWwgcmV0dXJucyAoTWludGFibGVUb2tlbikgewogICAgcmV0dXJuIG5ldyBNaW50YWJsZVRva2VuKCk7CiAgfQoKCiAgLy8gZmFsbGJhY2sgZnVuY3Rpb24gY2FuIGJlIHVzZWQgdG8gYnV5IHRva2VucwogIGZ1bmN0aW9uICgpIHBheWFibGUgewogICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwogIH0KCiAgLy8gbG93IGxldmVsIHRva2VuIHB1cmNoYXNlIGZ1bmN0aW9uCiAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnkpIHB1YmxpYyBwYXlhYmxlIHsKICAgIHJlcXVpcmUoYmVuZWZpY2lhcnkgIT0gMHgwKTsKICAgIHJlcXVpcmUodmFsaWRQdXJjaGFzZSgpKTsKCiAgICB1aW50MjU2IHdlaUFtb3VudCA9IG1zZy52YWx1ZTsKCiAgICAvLyBjYWxjdWxhdGUgdG9rZW4gYW1vdW50IHRvIGJlIGNyZWF0ZWQKICAgIHVpbnQyNTYgdG9rZW5zID0gd2VpQW1vdW50Lm11bChyYXRlKTsKCiAgICAvLyB1cGRhdGUgc3RhdGUKICAgIHdlaVJhaXNlZCA9IHdlaVJhaXNlZC5hZGQod2VpQW1vdW50KTsKCiAgICB0b2tlbi5taW50KGJlbmVmaWNpYXJ5LCB0b2tlbnMpOwogICAgVG9rZW5QdXJjaGFzZShtc2cuc2VuZGVyLCBiZW5lZmljaWFyeSwgd2VpQW1vdW50LCB0b2tlbnMpOwoKICAgIGZvcndhcmRGdW5kcygpOwogIH0KCiAgLy8gc2VuZCBldGhlciB0byB0aGUgZnVuZCBjb2xsZWN0aW9uIHdhbGxldAogIC8vIG92ZXJyaWRlIHRvIGNyZWF0ZSBjdXN0b20gZnVuZCBmb3J3YXJkaW5nIG1lY2hhbmlzbXMKICBmdW5jdGlvbiBmb3J3YXJkRnVuZHMoKSBpbnRlcm5hbCB7CiAgICB3YWxsZXQudHJhbnNmZXIobXNnLnZhbHVlKTsKICB9CgogIC8vIEByZXR1cm4gdHJ1ZSBpZiB0aGUgdHJhbnNhY3Rpb24gY2FuIGJ1eSB0b2tlbnMKICBmdW5jdGlvbiB2YWxpZFB1cmNoYXNlKCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgYm9vbCB3aXRoaW5QZXJpb2QgPSBub3cgPj0gc3RhcnRUaW1lICYmIG5vdyA8PSBlbmRUaW1lOwogICAgYm9vbCBub25aZXJvUHVyY2hhc2UgPSBtc2cudmFsdWUgIT0gMDsKICAgIHJldHVybiB3aXRoaW5QZXJpb2QgJiYgbm9uWmVyb1B1cmNoYXNlOwogIH0KCiAgLy8gQHJldHVybiB0cnVlIGlmIGNyb3dkc2FsZSBldmVudCBoYXMgZW5kZWQKICBmdW5jdGlvbiBoYXNFbmRlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gbm93ID4gZW5kVGltZTsKICB9CgoKfQoKY29udHJhY3QgQ2FwcGVkQ3Jvd2RzYWxlIGlzIENyb3dkc2FsZSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIHVpbnQyNTYgcHVibGljIGNhcDsKCiAgZnVuY3Rpb24gQ2FwcGVkQ3Jvd2RzYWxlKHVpbnQyNTYgX2NhcCkgewogICAgcmVxdWlyZShfY2FwID4gMCk7CiAgICBjYXAgPSBfY2FwOwogIH0KCiAgLy8gb3ZlcnJpZGluZyBDcm93ZHNhbGUjdmFsaWRQdXJjaGFzZSB0byBhZGQgZXh0cmEgY2FwIGxvZ2ljCiAgLy8gQHJldHVybiB0cnVlIGlmIGludmVzdG9ycyBjYW4gYnV5IGF0IHRoZSBtb21lbnQKICBmdW5jdGlvbiB2YWxpZFB1cmNoYXNlKCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgYm9vbCB3aXRoaW5DYXAgPSB3ZWlSYWlzZWQuYWRkKG1zZy52YWx1ZSkgPD0gY2FwOwogICAgcmV0dXJuIHN1cGVyLnZhbGlkUHVyY2hhc2UoKSAmJiB3aXRoaW5DYXA7CiAgfQoKICAvLyBvdmVycmlkaW5nIENyb3dkc2FsZSNoYXNFbmRlZCB0byBhZGQgY2FwIGxvZ2ljCiAgLy8gQHJldHVybiB0cnVlIGlmIGNyb3dkc2FsZSBldmVudCBoYXMgZW5kZWQKICBmdW5jdGlvbiBoYXNFbmRlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICBib29sIGNhcFJlYWNoZWQgPSB3ZWlSYWlzZWQgPj0gY2FwOwogICAgcmV0dXJuIHN1cGVyLmhhc0VuZGVkKCkgfHwgY2FwUmVhY2hlZDsKICB9Cgp9Cgpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCgogIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKY29udHJhY3QgRmluYWxpemFibGVDcm93ZHNhbGUgaXMgQ3Jvd2RzYWxlLCBPd25hYmxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgYm9vbCBwdWJsaWMgaXNGaW5hbGl6ZWQgPSBmYWxzZTsKCiAgZXZlbnQgRmluYWxpemVkKCk7CgogIC8qKgogICAqIEBkZXYgTXVzdCBiZSBjYWxsZWQgYWZ0ZXIgY3Jvd2RzYWxlIGVuZHMsIHRvIGRvIHNvbWUgZXh0cmEgZmluYWxpemF0aW9uCiAgICogd29yay4gQ2FsbHMgdGhlIGNvbnRyYWN0J3MgZmluYWxpemF0aW9uIGZ1bmN0aW9uLgogICAqLwogIGZ1bmN0aW9uIGZpbmFsaXplKCkgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKCFpc0ZpbmFsaXplZCk7CiAgICByZXF1aXJlKGhhc0VuZGVkKCkpOwoKICAgIGZpbmFsaXphdGlvbigpOwogICAgRmluYWxpemVkKCk7CgogICAgaXNGaW5hbGl6ZWQgPSB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBDYW4gYmUgb3ZlcnJpZGRlbiB0byBhZGQgZmluYWxpemF0aW9uIGxvZ2ljLiBUaGUgb3ZlcnJpZGluZyBmdW5jdGlvbgogICAqIHNob3VsZCBjYWxsIHN1cGVyLmZpbmFsaXphdGlvbigpIHRvIGVuc3VyZSB0aGUgY2hhaW4gb2YgZmluYWxpemF0aW9uIGlzCiAgICogZXhlY3V0ZWQgZW50aXJlbHkuCiAgICovCiAgZnVuY3Rpb24gZmluYWxpemF0aW9uKCkgaW50ZXJuYWwgewogIH0KfQoKY29udHJhY3QgUGF1c2FibGUgaXMgT3duYWJsZSB7CiAgZXZlbnQgUGF1c2UoKTsKICBldmVudCBVbnBhdXNlKCk7CgogIGJvb2wgcHVibGljIHBhdXNlZCA9IGZhbHNlOwoKCiAgLyoqCiAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBub3QgcGF1c2VkLgogICAqLwogIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICByZXF1aXJlKCFwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgcGF1c2VkLgogICAqLwogIG1vZGlmaWVyIHdoZW5QYXVzZWQoKSB7CiAgICByZXF1aXJlKHBhdXNlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHBhdXNlLCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlCiAgICovCiAgZnVuY3Rpb24gcGF1c2UoKSBvbmx5T3duZXIgd2hlbk5vdFBhdXNlZCBwdWJsaWMgewogICAgcGF1c2VkID0gdHJ1ZTsKICAgIFBhdXNlKCk7CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gdW5wYXVzZSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgKi8KICBmdW5jdGlvbiB1bnBhdXNlKCkgb25seU93bmVyIHdoZW5QYXVzZWQgcHVibGljIHsKICAgIHBhdXNlZCA9IGZhbHNlOwogICAgVW5wYXVzZSgpOwogIH0KfQoKY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9Cgpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogIC8qKgogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwoKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cgp9Cgpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CgoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwoKICAgIHVpbnQyNTYgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOwoKICAgIC8vIENoZWNrIGlzIG5vdCBuZWVkZWQgYmVjYXVzZSBzdWIoX2FsbG93YW5jZSwgX3ZhbHVlKSB3aWxsIGFscmVhZHkgdGhyb3cgaWYgdGhpcyBjb25kaXRpb24gaXMgbm90IG1ldAogICAgLy8gcmVxdWlyZSAoX3ZhbHVlIDw9IF9hbGxvd2FuY2UpOwoKICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBfYWxsb3dhbmNlLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICoKICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICogYW5kIHRoZSBuZXcgYWxsb3dhbmNlIGJ5IHVuZm9ydHVuYXRlIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcwogICAqIHJhY2UgY29uZGl0aW9uIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUgYWZ0ZXJ3YXJkczoKICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgKi8KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqLwogIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9Cgpjb250cmFjdCBNaW50YWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIE93bmFibGUgewogIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGFtb3VudCk7CiAgZXZlbnQgTWludEZpbmlzaGVkKCk7CgogIGJvb2wgcHVibGljIG1pbnRpbmdGaW5pc2hlZCA9IGZhbHNlOwoKCiAgbW9kaWZpZXIgY2FuTWludCgpIHsKICAgIHJlcXVpcmUoIW1pbnRpbmdGaW5pc2hlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBtaW50IHRva2VucwogICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIG1pbnRlZCB0b2tlbnMuCiAgICogQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gbWludC4KICAgKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgb25seU93bmVyIGNhbk1pbnQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKF9hbW91bnQpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF9hbW91bnQpOwogICAgTWludChfdG8sIF9hbW91bnQpOwogICAgVHJhbnNmZXIoMHgwLCBfdG8sIF9hbW91bnQpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHN0b3AgbWludGluZyBuZXcgdG9rZW5zLgogICAqIEByZXR1cm4gVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBvbmx5T3duZXIgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIG1pbnRpbmdGaW5pc2hlZCA9IHRydWU7CiAgICBNaW50RmluaXNoZWQoKTsKICAgIHJldHVybiB0cnVlOwogIH0KfQoKY29udHJhY3QgUWlpYmVlVG9rZW5JbnRlcmZhY2UgewogIGZ1bmN0aW9uIG1pbnRWZXN0ZWRUb2tlbnMoYWRkcmVzcyBfdG8sCiAgICB1aW50MjU2IF92YWx1ZSwKICAgIHVpbnQ2NCBfc3RhcnQsCiAgICB1aW50NjQgX2NsaWZmLAogICAgdWludDY0IF92ZXN0aW5nLAogICAgYm9vbCBfcmV2b2thYmxlLAogICAgYm9vbCBfYnVybnNPblJldm9rZSwKICAgIGFkZHJlc3MgX3dhbGxldAogICkgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIF93YWxsZXQpOwogIGZ1bmN0aW9uIHBhdXNlKCk7CiAgZnVuY3Rpb24gdW5wYXVzZSgpOwogIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSByZXR1cm5zIChib29sKTsKfQoKY29udHJhY3QgUWlpYmVlUHJlc2FsZSBpcyBDYXBwZWRDcm93ZHNhbGUsIEZpbmFsaXphYmxlQ3Jvd2RzYWxlLCBQYXVzYWJsZSB7CgogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgc3RydWN0IEFjY3JlZGl0ZWRJbnZlc3RvciB7CiAgICAgIHVpbnQ2NCBjbGlmZjsKICAgICAgdWludDY0IHZlc3Rpbmc7CiAgICAgIGJvb2wgcmV2b2thYmxlOwogICAgICBib29sIGJ1cm5zT25SZXZva2U7CiAgICAgIHVpbnQyNTYgbWluSW52ZXN0OyAvLyBtaW5pbXVtIGludmVzdCBpbiB3ZWkgZm9yIGEgZ2l2ZW4gaW52ZXN0b3IKICAgICAgdWludDI1NiBtYXhDdW11bGF0aXZlSW52ZXN0OyAvLyBtYXhpbXVtIGN1bXVsYXRpdmUgaW52ZXN0IGluIHdlaSBmb3IgYSBnaXZlbiBpbnZlc3RvcgogICAgfQoKICAgIFFpaWJlZVRva2VuSW50ZXJmYWNlIHB1YmxpYyB0b2tlbjsgLy8gdG9rZW4gYmVpbmcgc29sZAoKICAgIHVpbnQyNTYgcHVibGljIGRpc3RyaWJ1dGlvbkNhcDsgLy8gY2FwIGluIHRva2VucyB0aGF0IGNhbiBiZSBkaXN0cmlidXRlZCB0byB0aGUgcG9vbHMKICAgIHVpbnQyNTYgcHVibGljIHRva2Vuc0Rpc3RyaWJ1dGVkOyAvLyB0b2tlbnMgZGlzdHJpYnV0ZWQgdG8gcG9vbHMKICAgIHVpbnQyNTYgcHVibGljIHRva2Vuc1NvbGQ7IC8vIHFieCBtaW50ZWQgKGFuZCBzb2xkKQoKICAgIHVpbnQ2NCBwdWJsaWMgdmVzdEZyb21UaW1lID0gMTUzMDMxNjgwMDsgLy8gc3RhcnQgdGltZSBmb3IgdmVzdGVkIHRva2VucyAoZXF1aXYuIHRvIDMwLzA2LzIwMTggMTI6MDA6MDAgQU0gR01UKQoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGJhbGFuY2VzOyAvLyBiYWxhbmNlIG9mIHdlaSBpbnZlc3RlZCBwZXIgaW52ZXN0b3IKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gQWNjcmVkaXRlZEludmVzdG9yKSBwdWJsaWMgYWNjcmVkaXRlZDsgLy8gd2hpdGVsaXN0IG9mIGludmVzdG9ycwoKICAgIC8vIHNwYW0gcHJldmVudGlvbgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgbGFzdENhbGxUaW1lOyAvLyBsYXN0IGNhbGwgdGltZXMgYnkgYWRkcmVzcwogICAgdWludDI1NiBwdWJsaWMgbWF4R2FzUHJpY2U7IC8vIG1heCBnYXMgcHJpY2UgcGVyIHRyYW5zYWN0aW9uCiAgICB1aW50MjU2IHB1YmxpYyBtaW5CdXlpbmdSZXF1ZXN0SW50ZXJ2YWw7IC8vIG1pbiByZXF1ZXN0IGludGVydmFsIGZvciBwdXJjaGFzZXMgZnJvbSBhIHNpbmdsZSBzb3VyY2UgKGluIHNlY29uZHMpCgogICAgYm9vbCBwdWJsaWMgaXNGaW5hbGl6ZWQgPSBmYWxzZTsKCiAgICBldmVudCBOZXdBY2NyZWRpdGVkSW52ZXN0b3IoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCBidXllcik7CiAgICBldmVudCBUb2tlbkRpc3RyaWJ1dGVkKGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB0b2tlbnMpOwoKICAgIC8qCiAgICAgKiBAZGV2IENvbnN0cnVjdG9yLgogICAgICogQHBhcmFtIF9zdGFydFRpbWUgc2VlIGBzdGFydFRpbWVzdGFtcGAKICAgICAqIEBwYXJhbSBfZW5kVGltZSBzZWUgYGVuZFRpbWVzdGFtcGAKICAgICAqIEBwYXJhbSBfcmF0ZSBzZWUgYHNlZSByYXRlYAogICAgICogQHBhcmFtIF9jYXAgc2VlIGBzZWUgY2FwYAogICAgICogQHBhcmFtIF9kaXN0cmlidXRpb25DYXAgc2VlIGBzZWUgZGlzdHJpYnV0aW9uQ2FwYAogICAgICogQHBhcmFtIF9tYXhHYXNQcmljZSBzZWUgYHNlZSBtYXhHYXNQcmljZWAKICAgICAqIEBwYXJhbSBfbWluQnV5aW5nUmVxdWVzdEludGVydmFsIHNlZSBgc2VlIG1pbkJ1eWluZ1JlcXVlc3RJbnRlcnZhbGAKICAgICAqIEBwYXJhbSBfd2FsbGV0IHNlZSBgd2FsbGV0YAogICAgICovCiAgICBmdW5jdGlvbiBRaWliZWVQcmVzYWxlKAogICAgICAgIHVpbnQyNTYgX3N0YXJ0VGltZSwKICAgICAgICB1aW50MjU2IF9lbmRUaW1lLAogICAgICAgIGFkZHJlc3MgX3Rva2VuLAogICAgICAgIHVpbnQyNTYgX3JhdGUsCiAgICAgICAgdWludDI1NiBfY2FwLAogICAgICAgIHVpbnQyNTYgX2Rpc3RyaWJ1dGlvbkNhcCwKICAgICAgICB1aW50MjU2IF9tYXhHYXNQcmljZSwKICAgICAgICB1aW50MjU2IF9taW5CdXlpbmdSZXF1ZXN0SW50ZXJ2YWwsCiAgICAgICAgYWRkcmVzcyBfd2FsbGV0CiAgICApCiAgICAgIENyb3dkc2FsZShfc3RhcnRUaW1lLCBfZW5kVGltZSwgX3JhdGUsIF93YWxsZXQpCiAgICAgIENhcHBlZENyb3dkc2FsZShfY2FwKQogICAgewogICAgICByZXF1aXJlKF9kaXN0cmlidXRpb25DYXAgPiAwKTsKICAgICAgcmVxdWlyZShfbWF4R2FzUHJpY2UgPiAwKTsKICAgICAgcmVxdWlyZShfbWluQnV5aW5nUmVxdWVzdEludGVydmFsID4gMCk7CiAgICAgIHJlcXVpcmUoX3Rva2VuICE9IGFkZHJlc3MoMCkpOwoKICAgICAgZGlzdHJpYnV0aW9uQ2FwID0gX2Rpc3RyaWJ1dGlvbkNhcDsKICAgICAgbWF4R2FzUHJpY2UgPSBfbWF4R2FzUHJpY2U7CiAgICAgIG1pbkJ1eWluZ1JlcXVlc3RJbnRlcnZhbCA9IF9taW5CdXlpbmdSZXF1ZXN0SW50ZXJ2YWw7CiAgICAgIHRva2VuID0gUWlpYmVlVG9rZW5JbnRlcmZhY2UoX3Rva2VuKTsKICAgIH0KCiAgICAvKgogICAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IGFkZHJlc3Mgd2hlcmUgdG9rZW5zIGFyZSBzZW50IHRvCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgcGF5YWJsZSB3aGVuTm90UGF1c2VkIHsKICAgICAgcmVxdWlyZShiZW5lZmljaWFyeSAhPSBhZGRyZXNzKDApKTsKICAgICAgcmVxdWlyZSh2YWxpZFB1cmNoYXNlKCkpOwoKICAgICAgQWNjcmVkaXRlZEludmVzdG9yIHN0b3JhZ2UgZGF0YSA9IGFjY3JlZGl0ZWRbbXNnLnNlbmRlcl07CgogICAgICAvLyBpbnZlc3RvcidzIGRhdGEKICAgICAgdWludDI1NiBtaW5JbnZlc3QgPSBkYXRhLm1pbkludmVzdDsKICAgICAgdWludDI1NiBtYXhDdW11bGF0aXZlSW52ZXN0ID0gZGF0YS5tYXhDdW11bGF0aXZlSW52ZXN0OwogICAgICB1aW50NjQgZnJvbSA9IHZlc3RGcm9tVGltZTsKICAgICAgdWludDY0IGNsaWZmID0gZnJvbSArIGRhdGEuY2xpZmY7CiAgICAgIHVpbnQ2NCB2ZXN0aW5nID0gY2xpZmYgKyBkYXRhLnZlc3Rpbmc7CiAgICAgIGJvb2wgcmV2b2thYmxlID0gZGF0YS5yZXZva2FibGU7CiAgICAgIGJvb2wgYnVybnNPblJldm9rZSA9IGRhdGEuYnVybnNPblJldm9rZTsKCiAgICAgIHVpbnQyNTYgdG9rZW5zID0gbXNnLnZhbHVlLm11bChyYXRlKTsKCiAgICAgIC8vIGNoZWNrIGludmVzdG9yJ3MgbGltaXRzCiAgICAgIHVpbnQyNTYgbmV3QmFsYW5jZSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLmFkZChtc2cudmFsdWUpOwogICAgICByZXF1aXJlKG5ld0JhbGFuY2UgPD0gbWF4Q3VtdWxhdGl2ZUludmVzdCAmJiBtc2cudmFsdWUgPj0gbWluSW52ZXN0KTsKCiAgICAgIGlmIChkYXRhLmNsaWZmID4gMCAmJiBkYXRhLnZlc3RpbmcgPiAwKSB7CiAgICAgICAgcmVxdWlyZShRaWliZWVUb2tlbkludGVyZmFjZSh0b2tlbikubWludFZlc3RlZFRva2VucyhiZW5lZmljaWFyeSwgdG9rZW5zLCBmcm9tLCBjbGlmZiwgdmVzdGluZywgcmV2b2thYmxlLCBidXJuc09uUmV2b2tlLCB3YWxsZXQpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXF1aXJlKFFpaWJlZVRva2VuSW50ZXJmYWNlKHRva2VuKS5taW50KGJlbmVmaWNpYXJ5LCB0b2tlbnMpKTsKICAgICAgfQoKICAgICAgLy8gdXBkYXRlIHN0YXRlCiAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gbmV3QmFsYW5jZTsKICAgICAgd2VpUmFpc2VkID0gd2VpUmFpc2VkLmFkZChtc2cudmFsdWUpOwogICAgICB0b2tlbnNTb2xkID0gdG9rZW5zU29sZC5hZGQodG9rZW5zKTsKCiAgICAgIFRva2VuUHVyY2hhc2UobXNnLnNlbmRlciwgYmVuZWZpY2lhcnksIG1zZy52YWx1ZSwgdG9rZW5zKTsKCiAgICAgIGZvcndhcmRGdW5kcygpOwogICAgfQoKICAgIC8qCiAgICAgKiBAZGV2IFRoaXMgZnVuY3Rpb25zIGlzIHVzZWQgdG8gbWFudWFsbHkgZGlzdHJpYnV0ZSB0b2tlbnMuIEl0IHdvcmtzIGFmdGVyIHRoZSBmdW5kcmFpc2luZywgY2FuCiAgICAgKiBvbmx5IGJlIGNhbGxlZCBieSB0aGUgb3duZXIgYW5kIHdoZW4gdGhlIHByZXNhbGUgaXMgbm90IHBhdXNlZC4gSXQgaGFzIGEgY2FwIG9uIHRoZSBhbW91bnQKICAgICAqIG9mIHRva2VucyB0aGF0IGNhbiBiZSBtYW51YWxseSBkaXN0cmlidXRlZC4KICAgICAqCiAgICAgKiBAcGFyYW0gX2JlbmVmaWNpYXJ5IGFkZHJlc3Mgd2hlcmUgdG9rZW5zIGFyZSBzZW50IHRvCiAgICAgKiBAcGFyYW0gX3Rva2VucyBhbW91bnQgb2YgdG9rZW5zIChpbiBhdHRvKSB0byBkaXN0cmlidXRlCiAgICAgKiBAcGFyYW0gX2NsaWZmIGR1cmF0aW9uIGluIHNlY29uZHMgb2YgdGhlIGNsaWZmIGluIHdoaWNoIHRva2VucyB3aWxsIGJlZ2luIHRvIHZlc3QuCiAgICAgKiBAcGFyYW0gX3Zlc3RpbmcgZHVyYXRpb24gaW4gc2Vjb25kcyBvZiB0aGUgdmVzdGluZyBpbiB3aGljaCB0b2tlbnMgd2lsbCB2ZXN0LgogICAgICovCiAgICBmdW5jdGlvbiBkaXN0cmlidXRlVG9rZW5zKGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCB1aW50MjU2IF90b2tlbnMsIHVpbnQ2NCBfY2xpZmYsIHVpbnQ2NCBfdmVzdGluZywgYm9vbCBfcmV2b2thYmxlLCBib29sIF9idXJuc09uUmV2b2tlKSBwdWJsaWMgb25seU93bmVyIHdoZW5Ob3RQYXVzZWQgewogICAgICByZXF1aXJlKF9iZW5lZmljaWFyeSAhPSBhZGRyZXNzKDApKTsKICAgICAgcmVxdWlyZShfdG9rZW5zID4gMCk7CiAgICAgIHJlcXVpcmUoX3Zlc3RpbmcgPj0gX2NsaWZmKTsKICAgICAgcmVxdWlyZSghaXNGaW5hbGl6ZWQpOwogICAgICByZXF1aXJlKGhhc0VuZGVkKCkpOwoKICAgICAgLy8gY2hlY2sgZGlzdHJpYnV0aW9uIGNhcCBsaW1pdAogICAgICB1aW50MjU2IHRvdGFsRGlzdHJpYnV0ZWQgPSB0b2tlbnNEaXN0cmlidXRlZC5hZGQoX3Rva2Vucyk7CiAgICAgIGFzc2VydCh0b3RhbERpc3RyaWJ1dGVkIDw9IGRpc3RyaWJ1dGlvbkNhcCk7CgogICAgICBpZiAoX2NsaWZmID4gMCAmJiBfdmVzdGluZyA+IDApIHsKICAgICAgICB1aW50NjQgZnJvbSA9IHZlc3RGcm9tVGltZTsKICAgICAgICB1aW50NjQgY2xpZmYgPSBmcm9tICsgX2NsaWZmOwogICAgICAgIHVpbnQ2NCB2ZXN0aW5nID0gY2xpZmYgKyBfdmVzdGluZzsKICAgICAgICBhc3NlcnQoUWlpYmVlVG9rZW5JbnRlcmZhY2UodG9rZW4pLm1pbnRWZXN0ZWRUb2tlbnMoX2JlbmVmaWNpYXJ5LCBfdG9rZW5zLCBmcm9tLCBjbGlmZiwgdmVzdGluZywgX3Jldm9rYWJsZSwgX2J1cm5zT25SZXZva2UsIHdhbGxldCkpOwogICAgICB9IGVsc2UgewogICAgICAgIGFzc2VydChRaWliZWVUb2tlbkludGVyZmFjZSh0b2tlbikubWludChfYmVuZWZpY2lhcnksIF90b2tlbnMpKTsKICAgICAgfQoKICAgICAgLy8gdXBkYXRlIHN0YXRlCiAgICAgIHRva2Vuc0Rpc3RyaWJ1dGVkID0gdG9rZW5zRGlzdHJpYnV0ZWQuYWRkKF90b2tlbnMpOwoKICAgICAgVG9rZW5EaXN0cmlidXRlZChfYmVuZWZpY2lhcnksIF90b2tlbnMpOwogICAgfQoKICAgIC8qCiAgICAgKiBAZGV2IEFkZCBhbiBhZGRyZXNzIHRvIHRoZSBhY2NyZWRpdGVkIGxpc3QuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFkZEFjY3JlZGl0ZWRJbnZlc3RvcihhZGRyZXNzIGludmVzdG9yLCB1aW50NjQgY2xpZmYsIHVpbnQ2NCB2ZXN0aW5nLCBib29sIHJldm9rYWJsZSwgYm9vbCBidXJuc09uUmV2b2tlLCB1aW50MjU2IG1pbkludmVzdCwgdWludDI1NiBtYXhDdW11bGF0aXZlSW52ZXN0KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKGludmVzdG9yICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUodmVzdGluZyA+PSBjbGlmZik7CiAgICAgICAgcmVxdWlyZShtaW5JbnZlc3QgPiAwKTsKICAgICAgICByZXF1aXJlKG1heEN1bXVsYXRpdmVJbnZlc3QgPiAwKTsKICAgICAgICByZXF1aXJlKG1pbkludmVzdCA8PSBtYXhDdW11bGF0aXZlSW52ZXN0KTsKCiAgICAgICAgYWNjcmVkaXRlZFtpbnZlc3Rvcl0gPSBBY2NyZWRpdGVkSW52ZXN0b3IoY2xpZmYsIHZlc3RpbmcsIHJldm9rYWJsZSwgYnVybnNPblJldm9rZSwgbWluSW52ZXN0LCBtYXhDdW11bGF0aXZlSW52ZXN0KTsKCiAgICAgICAgTmV3QWNjcmVkaXRlZEludmVzdG9yKG1zZy5zZW5kZXIsIGludmVzdG9yKTsKICAgIH0KCiAgICAvKgogICAgICogQGRldiBjaGVja3MgaWYgYW4gYWRkcmVzcyBpcyBhY2NyZWRpdGVkCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgaW52ZXN0b3IgaXMgYWNjcmVkaXRlZAogICAgICovCiAgICBmdW5jdGlvbiBpc0FjY3JlZGl0ZWQoYWRkcmVzcyBpbnZlc3RvcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICBBY2NyZWRpdGVkSW52ZXN0b3Igc3RvcmFnZSBkYXRhID0gYWNjcmVkaXRlZFtpbnZlc3Rvcl07CiAgICAgICAgcmV0dXJuIGRhdGEubWluSW52ZXN0ID4gMDsKICAgIH0KCiAgICAvKgogICAgICogQGRldiBSZW1vdmUgYW4gYWRkcmVzcyBmcm9tIHRoZSBhY2NyZWRpdGVkIGxpc3QuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHJlbW92ZUFjY3JlZGl0ZWRJbnZlc3RvcihhZGRyZXNzIGludmVzdG9yKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKGludmVzdG9yICE9IGFkZHJlc3MoMCkpOwogICAgICAgIGRlbGV0ZSBhY2NyZWRpdGVkW2ludmVzdG9yXTsKICAgIH0KCgogICAgLyoKICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBpbnZlc3RvcnMgY2FuIGJ1eSBhdCB0aGUgbW9tZW50CiAgICAgKi8KICAgIGZ1bmN0aW9uIHZhbGlkUHVyY2hhc2UoKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgIHJlcXVpcmUoaXNBY2NyZWRpdGVkKG1zZy5zZW5kZXIpKTsKICAgICAgYm9vbCB3aXRoaW5GcmVxdWVuY3kgPSBub3cuc3ViKGxhc3RDYWxsVGltZVttc2cuc2VuZGVyXSkgPj0gbWluQnV5aW5nUmVxdWVzdEludGVydmFsOwogICAgICBib29sIHdpdGhpbkdhc1ByaWNlID0gdHguZ2FzcHJpY2UgPD0gbWF4R2FzUHJpY2U7CiAgICAgIHJldHVybiBzdXBlci52YWxpZFB1cmNoYXNlKCkgJiYgd2l0aGluRnJlcXVlbmN5ICYmIHdpdGhpbkdhc1ByaWNlOwogICAgfQoKICAgIC8qCiAgICAgKiBAZGV2IE11c3QgYmUgY2FsbGVkIGFmdGVyIGNyb3dkc2FsZSBlbmRzLCB0byBkbyBzb21lIGV4dHJhIGZpbmFsaXphdGlvbgogICAgICogd29yay4gQ2FsbHMgdGhlIGNvbnRyYWN0J3MgZmluYWxpemF0aW9uIGZ1bmN0aW9uLiBPbmx5IG93bmVyIGNhbiBjYWxsIGl0LgogICAgICovCiAgICBmdW5jdGlvbiBmaW5hbGl6ZSgpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICByZXF1aXJlKCFpc0ZpbmFsaXplZCk7CiAgICAgIHJlcXVpcmUoaGFzRW5kZWQoKSk7CgogICAgICBmaW5hbGl6YXRpb24oKTsKICAgICAgRmluYWxpemVkKCk7CgogICAgICBpc0ZpbmFsaXplZCA9IHRydWU7CgogICAgICAvLyB0cmFuc2ZlciB0aGUgb3duZXJzaGlwIG9mIHRoZSB0b2tlbiB0byB0aGUgZm91bmRhdGlvbgogICAgICBRaWliZWVUb2tlbkludGVyZmFjZSh0b2tlbikudHJhbnNmZXJPd25lcnNoaXAod2FsbGV0KTsKICAgIH0KCiAgICAvKgogICAgICogQGRldiBzZXRzIHRoZSB0b2tlbiB0aGF0IHRoZSBwcmVzYWxlIHdpbGwgdXNlLiBDYW4gb25seSBiZSBjYWxsZWQgYnkgdGhlIG93bmVyIGFuZAogICAgICogYmVmb3JlIHRoZSBwcmVzYWxlIHN0YXJ0cy4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0VG9rZW4oYWRkcmVzcyB0b2tlbkFkZHJlc3MpIG9ubHlPd25lciB7CiAgICAgIHJlcXVpcmUobm93IDwgc3RhcnRUaW1lKTsKICAgICAgdG9rZW4gPSBRaWliZWVUb2tlbkludGVyZmFjZSh0b2tlbkFkZHJlc3MpOwogICAgfQoKfQ=='.
	

]
