Class {
	#name : #SRTab29470ee3eb017ed2e60cec6a28133124f3e5e2,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTab29470ee3eb017ed2e60cec6a28133124f3e5e2 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7CgovKgoqIExvb2tzQ29pbiB0b2tlbiBzYWxlIGNvbnRyYWN0CioKKiBSZWZlciB0byBodHRwczovL2xvb2tzY29pbi5jb20gZm9yIG1vcmUgaW5mb3JtYXRpb24uCiogCiogRGV2ZWxvcGVyOiBMb29rUmV2CioKKi8KCi8qCiAqIEVSQzIwIFRva2VuIFN0YW5kYXJkCiAqLwpjb250cmFjdCBFUkMyMCB7CmV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwpldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKCnVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwpmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwpmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwpmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CmZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKTsKfQoKLyoqCiogUHJvdmlkZXMgbWV0aG9kcyB0byBzYWZlbHkgYWRkLCBzdWJ0cmFjdCBhbmQgbXVsdGlwbHkgdWludDI1NiBudW1iZXJzLgoqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICAgIC8qKgogICAgICogQWRkIHR3byB1aW50MjU2IHZhbHVlcywgcmV2ZXJ0IGluIGNhc2Ugb2Ygb3ZlcmZsb3cuCiAgICAgKgogICAgICogQHBhcmFtIGEgZmlyc3QgdmFsdWUgdG8gYWRkCiAgICAgKiBAcGFyYW0gYiBzZWNvbmQgdmFsdWUgdG8gYWRkCiAgICAgKiBAcmV0dXJuIGEgKyBiCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgICAgIGFzc2VydChjID49IGEpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIC8qKgogICAgICogU3VidHJhY3Qgb25lIHVpbnQyNTYgdmFsdWUgZnJvbSBhbm90aGVyLCB0aHJvdyBpbiBjYXNlIG9mIHVuZGVyZmxvdy4KICAgICAqCiAgICAgKiBAcGFyYW0gYSB2YWx1ZSB0byBzdWJ0cmFjdCBmcm9tCiAgICAgKiBAcGFyYW0gYiB2YWx1ZSB0byBzdWJ0cmFjdAogICAgICogQHJldHVybiBhIC0gYgogICAgICovCiAgICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoYSA+PSBiKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgLyoqCiAgICAgKiBNdWx0aXBseSB0d28gdWludDI1NiB2YWx1ZXMsIHRocm93IGluIGNhc2Ugb2Ygb3ZlcmZsb3cuCiAgICAgKgogICAgICogQHBhcmFtIGEgZmlyc3QgdmFsdWUgdG8gbXVsdGlwbHkKICAgICAqIEBwYXJhbSBiIHNlY29uZCB2YWx1ZSB0byBtdWx0aXBseQogICAgICogQHJldHVybiBhICogYgogICAgICovCiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBpZiAoYSA9PSAwIHx8IGIgPT0gMCkgcmV0dXJuIDA7CiAgICAgICAgdWludDI1NiBjID0gYSAqIGI7CiAgICAgICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIC8qKgogICAgICogRGl2aWQgdWludDI1NiB2YWx1ZXMsIHRocm93IGluIGNhc2Ugb2Ygb3ZlcmZsb3cuCiAgICAgKgogICAgICogQHBhcmFtIGEgZmlyc3QgdmFsdWUgbnVtZXJhdG9yCiAgICAgKiBAcGFyYW0gYiBzZWNvbmQgdmFsdWUgZGVub21pbmF0b3IKICAgICAqIEByZXR1cm4gYSAvIGIKICAgICAqLwogICAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgYXNzZXJ0KGIgIT0gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgICAgIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICAgICAgcmV0dXJuIGM7CiAgICB9Cn0KCi8qCiAgICBQcm92aWRlcyBzdXBwb3J0IGFuZCB1dGlsaXRpZXMgZm9yIGNvbnRyYWN0IG93bmVyc2hpcAoqLwpjb250cmFjdCBPd25hYmxlIHsKICAgIGFkZHJlc3Mgb3duZXI7CiAgICBhZGRyZXNzIG5ld093bmVyOwoKICAgIGZ1bmN0aW9uIE93bmFibGUoKSB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIC8qKgogICAgICogQWxsb3dzIGV4ZWN1dGlvbiBieSB0aGUgb3duZXIgb25seS4KICAgICAqLwogICAgbW9kaWZpZXIgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBUcmFuc2ZlcnJpbmcgdGhlIGNvbnRyYWN0IG93bmVyc2hpcCB0byB0aGUgbmV3IG93bmVyLgogICAgICoKICAgICAqIEBwYXJhbSBfbmV3T3duZXIgbmV3IGNvbnRyYWN0b3Igb3duZXIKICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBfbmV3T3duZXIpIG9ubHlPd25lciB7CiAgICAgICAgaWYgKF9uZXdPd25lciAhPSAweDApIHsKICAgICAgICAgIG5ld093bmVyID0gX25ld093bmVyOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEFjY2VwdCB0aGUgY29udHJhY3Qgb3duZXJzaGlwIGJ5IHRoZSBuZXcgb3duZXIuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFjY2VwdE93bmVyc2hpcCgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gbmV3T3duZXIpOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICAgICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgICAgICBuZXdPd25lciA9IDB4MDsKICAgIH0KICAgIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90byk7Cn0KCi8qKgoqIFN0YW5kYXJkIFRva2VuIFNtYXJ0IENvbnRyYWN0CiovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgLyoqCiAgICAgKiBNYXBwaW5nIGZyb20gYWRkcmVzc2VzIG9mIHRva2VuIGhvbGRlcnMgdG8gdGhlIG51bWJlcnMgb2YgdG9rZW5zIGJlbG9uZ2luZwogICAgICogdG8gdGhlc2UgdG9rZW4gaG9sZGVycy4KICAgICAqLwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgICAvKioKICAgICAqIE1hcHBpbmcgZnJvbSBhZGRyZXNzZXMgb2YgdG9rZW4gaG9sZGVycyB0byB0aGUgbWFwcGluZyBvZiBhZGRyZXNzZXMgb2YKICAgICAqIHNwZW5kZXJzIHRvIHRoZSBhbGxvd2FuY2VzIHNldCBieSB0aGVzZSB0b2tlbiBob2xkZXJzIHRvIHRoZXNlIHNwZW5kZXJzLgogICAgICovCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CgogICAgLyoqCiAgICAgKiBNYXBwaW5nIGZyb20gYWRkcmVzc2VzIG9mIHRva2VuIGhvbGRlcnMgdG8gdGhlIG1hcHBpbmcgb2YgdG9rZW4gYW1vdW50IHNwZW50LgogICAgICogVXNlIGJ5IHRoZSB0b2tlbiBob2xkZXJzIHRvIHNwZW5kIHRoZWlyIHV0aWxpdHkgdG9rZW5zLgogICAgICovCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIHNwZW50YW1vdW50OwoKICAgIC8qKgogICAgICogTWFwcGluZyBvZiB0aGUgYWRkaXRpb24gb2YgcGF0cm9ucy4KICAgICAqLwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwYXRyb25BcHBlbmRlZDsKCiAgICAvKioKICAgICAqIE1hcHBpbmcgb2YgdGhlIGFkZHJlc3NlcyBvZiBwYXRyb25zLgogICAgICovCiAgICBhZGRyZXNzW10gcGF0cm9uczsKCiAgICAvKioKICAgICAqIE1hcHBpbmcgb2YgdGhlIGFkZHJlc3NlcyBvZiBWSVAgdG9rZW4gaG9sZGVycy4KICAgICAqLwogICAgYWRkcmVzc1tdIHZpcHM7CgogICAgLyoqCiAgICAqIE1hcHBpbmcgZm9yIFZJUCByYW5rIGZvciBxdWFsaWZpZWQgdG9rZW4gaG9sZGVycwogICAgKiBIaWdoZXIgVklQIHJhbmsgKHdpdGggZWFybGllciB0aW1lc3RhbXApIGhhcyBoaWdoZXIgYmlkZGluZyBwcmlvcml0eSB3aGVuCiAgICAqIGNvbXBldGluZyBmb3IgdGhlIHNhbWUgcHJvZHVjdCBvciBzZXJ2aWNlIG9uIHBsYXRmb3JtLgogICAgKi8KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgdmlwcmFuazsKCiAgICAvKioKICAgICAqIEdldCBudW1iZXIgb2YgdG9rZW5zIGN1cnJlbnRseSBiZWxvbmdpbmcgdG8gZ2l2ZW4gb3duZXIuCiAgICAgKgogICAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIHRvIGdldCBudW1iZXIgb2YgdG9rZW5zIGN1cnJlbnRseSBiZWxvbmdpbmcgdG8gaXRzIG93bmVyCiAgICAgKgogICAgICogQHJldHVybiBudW1iZXIgb2YgdG9rZW5zIGN1cnJlbnRseSBiZWxvbmdpbmcgdG8gdGhlIG93bmVyIG9mIGdpdmVuIGFkZHJlc3MKICAgICAqLwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KCiAgICAvKioKICAgICAqIFRyYW5zZmVyIGdpdmVuIG51bWJlciBvZiB0b2tlbnMgZnJvbSBtZXNzYWdlIHNlbmRlciB0byBnaXZlbiByZWNpcGllbnQuCiAgICAgKgogICAgICogQHBhcmFtIF90byBhZGRyZXNzIHRvIHRyYW5zZmVyIHRva2VucyB0byB0aGUgb3duZXIgb2YKICAgICAqIEBwYXJhbSBfdmFsdWUgbnVtYmVyIG9mIHRva2VucyB0byB0cmFuc2ZlciB0byB0aGUgb3duZXIgb2YgZ2l2ZW4gYWRkcmVzcwogICAgICogQHJldHVybiB0cnVlIGlmIHRva2VucyB3ZXJlIHRyYW5zZmVycmVkIHN1Y2Nlc3NmdWxseSwgZmFsc2Ugb3RoZXJ3aXNlCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gMHgwKTsKICAgICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPCBfdmFsdWUpIHJldHVybiBmYWxzZTsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRyYW5zZmVyIGdpdmVuIG51bWJlciBvZiB0b2tlbnMgZnJvbSBnaXZlbiBvd25lciB0byBnaXZlbiByZWNpcGllbnQuCiAgICAgKgogICAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG9rZW5zIGZyb20gdGhlIG93bmVyIG9mCiAgICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG9rZW5zIHRvIHRoZSBvd25lciBvZgogICAgICogQHBhcmFtIF92YWx1ZSBudW1iZXIgb2YgdG9rZW5zIHRvIHRyYW5zZmVyIGZyb20gZ2l2ZW4gb3duZXIgdG8gZ2l2ZW4KICAgICAqICAgICAgICByZWNpcGllbnQKICAgICAqIEByZXR1cm4gdHJ1ZSBpZiB0b2tlbnMgd2VyZSB0cmFuc2ZlcnJlZCBzdWNjZXNzZnVsbHksIGZhbHNlIG90aGVyd2lzZQogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSAKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXF1aXJlKF90byAhPSAweDApOwogICAgICAgIGlmKF9mcm9tID09IF90bykgcmV0dXJuIGZhbHNlOwogICAgICAgIGlmIChiYWxhbmNlc1tfZnJvbV0gPCBfdmFsdWUpIHJldHVybiBmYWxzZTsKICAgICAgICBpZiAoX3ZhbHVlID4gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0pIHJldHVybiBmYWxzZTsKCiAgICAgICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEFsbG93IGdpdmVuIHNwZW5kZXIgdG8gdHJhbnNmZXIgZ2l2ZW4gbnVtYmVyIG9mIHRva2VucyBmcm9tIG1lc3NhZ2Ugc2VuZGVyLgogICAgICoKICAgICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIHRvIGFsbG93IHRoZSBvd25lciBvZiB0byB0cmFuc2ZlciB0b2tlbnMgZnJvbQogICAgICogICAgICAgIG1lc3NhZ2Ugc2VuZGVyCiAgICAgKiBAcGFyYW0gX3ZhbHVlIG51bWJlciBvZiB0b2tlbnMgdG8gYWxsb3cgdG8gdHJhbnNmZXIKICAgICAqIEByZXR1cm4gdHJ1ZSBpZiB0b2tlbiB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bGx5IGFwcHJvdmVkLCBmYWxzZSBvdGhlcndpc2UKICAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CgogICAgICAgIC8vIFRvIGNoYW5nZSB0aGUgYXBwcm92ZSBhbW91bnQgeW91IGZpcnN0IGhhdmUgdG8gcmVkdWNlIHRoZSBhZGRyZXNzZXNgCiAgICAgICAgLy8gIGFsbG93YW5jZSB0byB6ZXJvIGJ5IGNhbGxpbmcgYXBwcm92ZShfc3BlbmRlciwgMCkgaWYgaXQgaXMgbm90CiAgICAgICAgLy8gIGFscmVhZHkgMCB0byBtaXRpZ2F0ZSB0aGUgcmFjZSBjb25kaXRpb24gZGVzY3JpYmVkIGhlcmU6CiAgICAgICAgLy8gIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICAgICAgaWYgKChfdmFsdWUgIT0gMCkgJiYgKGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdICE9IDApKSB7CiAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPCBfdmFsdWUpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICB9CgogICAgLyoqCiAgICAgKiBUZWxsIGhvdyBtYW55IHRva2VucyBnaXZlbiBzcGVuZGVyIGlzIGN1cnJlbnRseSBhbGxvd2VkIHRvIHRyYW5zZmVyIGZyb20KICAgICAqIGdpdmVuIG93bmVyLgogICAgICoKICAgICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyB0byBnZXQgbnVtYmVyIG9mIHRva2VucyBhbGxvd2VkIHRvIGJlIHRyYW5zZmVycmVkCiAgICAgKiAgICAgICAgZnJvbSB0aGUgb3duZXIgb2YKICAgICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIHRvIGdldCBudW1iZXIgb2YgdG9rZW5zIGFsbG93ZWQgdG8gYmUgdHJhbnNmZXJyZWQKICAgICAqICAgICAgICBieSB0aGUgb3duZXIgb2YKICAgICAqIEByZXR1cm4gbnVtYmVyIG9mIHRva2VucyBnaXZlbiBzcGVuZGVyIGlzIGN1cnJlbnRseSBhbGxvd2VkIHRvIHRyYW5zZmVyCiAgICAgKiAgICAgICAgIGZyb20gZ2l2ZW4gb3duZXIKICAgICAqLwogICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgCiAgICAgICAgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgIH0KfQoKLyoqCiAqIExvb2tzQ29pbiBUb2tlbgogKgogKiBMb29rc0NvaW4gVG9rZW4gaXMgYW4gdXRpbGl0eSB0b2tlbiB0aGF0IGNhbiBiZSBwdXJjaGFzZWQgdGhyb3VnaCBjcm93ZHNhbGUgb3IgZWFybmVkIG9uCiAqIHRoZSBMb29rUmV2IHBsYXRmb3JtLiBJdCBjYW4gYmUgc3BlbnQgdG8gcHVyY2hhc2UgY3JlYXRpdmUgcHJvZHVjdHMgYW5kIHNlcnZpY2VzIG9uCiAqIExvb2tSZXYgcGxhdGZvcm0uCiAqCiAqIFZJUCByYW5rIGlzIHVzZWQgdG8gY2FsY3VsYXRlIHByaW9yaXR5IHdoZW4gY29tcGV0aW5nIHdpdGggb3RoZXIgYmlkcwogKiBmb3IgdGhlIHNhbWUgcHJvZHVjdCBvciBzZXJ2aWNlIG9uIHRoZSBwbGF0Zm9ybS4gCiAqIEhpZ2hlciBWSVAgcmFuayAod2l0aCBlYXJsaWVyIHRpbWVzdGFtcCkgaGFzIGhpZ2hlciBwcmlvcml0eS4KICogSGlnaGVyIFZJUCByYW5rIHdhbGxldCBhZGRyZXNzIG93bmVyIGNhbiBvdXRiaWQgb3RoZXIgbG93ZXIgcmFua2luZyBvd25lcnMgb25seSBvbmNlCiAqIHBlciBzZWxsaW5nIHdpbmRvdyBvciBwcm9tb3Rpb24gcGVyaW9kLgogKiBWSVAgcmFuayBpcyByZWNvcmRlZCBhdCB0aGUgdGltZSB3aGVuIHRoZSB3YWxsZXQgYWRkcmVzcyBmaXJzdCByZWFjaCBWSVAgTG9va3NDb2luIAogKiBob2xkaW5nIGxldmVsIGZvciBhIHRva2VuIHB1cmNoYXNlci4KICogVklQIHJhbmsgaXMgdmFsaWQgZm9yIHRoZSBsaWZldGltZSBvZiBhIHdhbGxldCBhZGRyZXNzIG9uIHRoZSBwbGF0Zm9ybSwgYXMgbG9uZyBhcyBpdCAKICogbWVldHMgdGhlIFZJUCBob2xkaW5nIGxldmVsLgoKICogVXNhZ2Ugb2YgdGhlIExvb2tzQ29pbiwgVklQIHJhbmsgYW5kIHRva2VuIHV0aWxpdGllcyBhcmUgZGVzY3JpYmVkIG9uIHRoZSB3ZWJzaXRlCiAqIGh0dHBzOi8vbG9va3Njb2luLmNvbS4KICoKICovCmNvbnRyYWN0IExvb2tzQ29pbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKCiAgICAvKioKICAgICAqIE51bWJlciBvZiBkZWNpbWFscyBvZiB0aGUgc21hbGxlc3QgdW5pdAogICAgICovCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwoKICAgIC8qKgogICAgICogVklQIEhvbGRpbmcgTGV2ZWwuIE1pbmltaXVtIHRva2VuIGhvbGRpbmcgYW1vdW50IHRvIHJlY29yZCBhIFZJUCByYW5rLgogICAgICogVG9rZW4gaG9sZGluZyBhZGRyZXNzIG5lZWRzIGhhdmUgYXQgbGVhc3QgMjQwMDAgTG9va3NDb2luIHRvIGJlIHJhbmtlZCBhcyBWSVAKICAgICAqIFZJUCByYW5rIGNhbiBvbmx5IGJlIHNldCB0aHJvdWdoIHB1cmNoYXNpbmcgdG9rZW5zCiAgICAgKi8KICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IFZJUF9NSU5JTVVNID0gMjQwMDBlMTg7CgogICAgLyoqCiAgICAgKiBJbml0aWFsIG51bWJlciBvZiB0b2tlbnMuCiAgICAgKi8KICAgIHVpbnQyNTYgY29uc3RhbnQgSU5JVElBTF9UT0tFTlNfQ09VTlQgPSAxMDAwMDAwMDBlMTg7CgogICAgLyoqCiAgICAgKiBDcm93ZHNhbGUgY29udHJhY3QgYWRkcmVzcy4KICAgICAqLwogICAgYWRkcmVzcyBwdWJsaWMgdG9rZW5TYWxlQ29udHJhY3QgPSAweDA7CgogICAgLyoqCiAgICAgKiBJbml0IFBsYWNlaG9sZGVyCiAgICAgKi8KICAgIGFkZHJlc3MgY29pbm1hc3RlciA9IGFkZHJlc3MoMHhkM2M3OWU0QUQ2NTQ0MzZkNTlBZkQ2MTM2M0JjMkI5MjdkMmZiNjgwKTsKCiAgICAvKioKICAgICAqIENyZWF0ZSBuZXcgTG9va3NDb2luIHRva2VuIHNtYXJ0IGNvbnRyYWN0LgogICAgICovCiAgICBmdW5jdGlvbiBMb29rc0NvaW4oKSB7CiAgICAgICAgb3duZXIgPSBjb2lubWFzdGVyOwogICAgICAgIGJhbGFuY2VzW293bmVyXSA9IElOSVRJQUxfVE9LRU5TX0NPVU5UOwogICAgICAgIHRvdGFsU3VwcGx5ID0gSU5JVElBTF9UT0tFTlNfQ09VTlQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgbmFtZSBvZiB0aGlzIHRva2VuLgogICAgICoKICAgICAqIEByZXR1cm4gbmFtZSBvZiB0aGlzIHRva2VuCiAgICAgKi8KICAgIGZ1bmN0aW9uIG5hbWUoKSBjb25zdGFudCByZXR1cm5zIChzdHJpbmcgbmFtZSkgewogICAgICByZXR1cm4gIkxvb2tzQ29pbiI7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgc3ltYm9sIG9mIHRoaXMgdG9rZW4uCiAgICAgKgogICAgICogQHJldHVybiBzeW1ib2wgb2YgdGhpcyB0b2tlbgogICAgICovCiAgICBmdW5jdGlvbiBzeW1ib2woKSBjb25zdGFudCByZXR1cm5zIChzdHJpbmcgc3ltYm9sKSB7CiAgICAgIHJldHVybiAiTE9PS1MiOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBTZXQgbmV3IHRva2VuIHNhbGUgY29udHJhY3QuCiAgICAgKiBNYXkgb25seSBiZSBjYWxsZWQgYnkgb3duZXIuCiAgICAgKgogICAgICogQHBhcmFtIF9uZXdUb2tlblNhbGVDb250cmFjdCBuZXcgdG9rZW4gc2FsZSBtYW5hZ2UgY29udHJhY3QuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldFRva2VuU2FsZUNvbnRyYWN0KGFkZHJlc3MgX25ld1Rva2VuU2FsZUNvbnRyYWN0KSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBhc3NlcnQoX25ld1Rva2VuU2FsZUNvbnRyYWN0ICE9IDB4MCk7CiAgICAgICAgdG9rZW5TYWxlQ29udHJhY3QgPSBfbmV3VG9rZW5TYWxlQ29udHJhY3Q7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgVklQIHJhbmsgb2YgYSBnaXZlbiBvd25lci4KICAgICAqIFZJUCByYW5rIGlzIHZhbGlkIGZvciB0aGUgbGlmZXRpbWUgb2YgYSB0b2tlbiB3YWxsZXQgYWRkcmVzcywgCiAgICAgKiBhcyBsb25nIGFzIGl0IG1lZXRzIFZJUCBob2xkaW5nIGxldmVsLgogICAgICoKICAgICAqIEBwYXJhbSBfdG8gcGFydGljaXBhbnQgYWRkcmVzcyB0byBnZXQgdGhlIHZpcCByYW5rCiAgICAgKiBAcmV0dXJuIHZpcCByYW5rIG9mIHRoZSBvd25lciBvZiBnaXZlbiBhZGRyZXNzCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFZJUFJhbmsoYWRkcmVzcyBfdG8pIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2IHJhbmspIHsKICAgICAgICBpZiAoYmFsYW5jZXNbX3RvXSA8IFZJUF9NSU5JTVVNKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdmlwcmFua1tfdG9dOwogICAgfQoKICAgIC8qKgogICAgICogQ2hlY2sgYW5kIHVwZGF0ZSBWSVAgcmFuayBvZiBhIGdpdmVuIHRva2VuIGJ1eWVyLgogICAgICogQ29udHJpYnV0aW9uIHRpbWVzdGFtcCBpcyByZWNvcmRlZCBmb3IgVklQIHJhbmsuCiAgICAgKiBSZWNvcmRlZCB0aW1lc3RhbXAgZm9yIFZJUCByYW5rIHNob3VsZCBhbHdheXMgYmUgZWFybGllciB0aGFuIHRoZSBjdXJyZW50IHRpbWUuCiAgICAgKgogICAgICogQHBhcmFtIF90byBhZGRyZXNzIHRvIGNoZWNrIHRoZSB2aXAgcmFuay4KICAgICAqIEByZXR1cm4gcmFuayB2aXAgcmFuayBvZiB0aGUgb3duZXIgb2YgZ2l2ZW4gYWRkcmVzcyBpZiBhbnkKICAgICAqLwogICAgZnVuY3Rpb24gdXBkYXRlVklQUmFuayhhZGRyZXNzIF90bykgcmV0dXJucyAodWludDI1NiByYW5rKSB7CiAgICAgICAgLy8gQ29udHJpYnV0aW9uIHRpbWVzdGFtcCBpcyByZWNvcmRlZCBmb3IgVklQIHJhbmsKICAgICAgICAvLyBSZWNvcmRlZCB0aW1lc3RhbXAgZm9yIFZJUCByYW5rIHNob3VsZCBhbHdheXMgYmUgZWFybGllciB0aGFuIGN1cnJlbnQgdGltZQogICAgICAgIGlmIChiYWxhbmNlc1tfdG9dID49IFZJUF9NSU5JTVVNICYmIHZpcHJhbmtbX3RvXSA9PSAwKSB7CiAgICAgICAgICAgIHZpcHJhbmtbX3RvXSA9IG5vdzsKICAgICAgICAgICAgdmlwcy5wdXNoKF90byk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB2aXByYW5rW190b107CiAgICB9CgogICAgZXZlbnQgVG9rZW5SZXdhcmRzQWRkZWQoYWRkcmVzcyBpbmRleGVkIHBhcnRpY2lwYW50LCB1aW50MjU2IGJhbGFuY2UpOwogICAgLyoqCiAgICAgKiBSZXdhcmQgcGFydGljaXBhbnQgdGhlIHRva2VucyB0aGV5IHB1cmNoYXNlZCBvciBlYXJuZWQKICAgICAqCiAgICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgdG8gY3JlZGl0IHRva2VucyB0byB0aGUgCiAgICAgKiBAcGFyYW0gX3ZhbHVlIG51bWJlciBvZiB0b2tlbnMgdG8gdHJhbnNmZXIgdG8gZ2l2ZW4gcmVjaXBpZW50CiAgICAgKgogICAgICogQHJldHVybiB0cnVlIGlmIHRva2VucyB3ZXJlIHRyYW5zZmVycmVkIHN1Y2Nlc3NmdWxseSwgZmFsc2Ugb3RoZXJ3aXNlCiAgICAgKi8KICAgIGZ1bmN0aW9uIHJld2FyZFRva2VucyhhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gdG9rZW5TYWxlQ29udHJhY3QgfHwgbXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgYXNzZXJ0KF90byAhPSAweDApOwogICAgICAgIHJlcXVpcmUoX3ZhbHVlID4gMCk7CgogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKF92YWx1ZSk7CiAgICAgICAgdXBkYXRlVklQUmFuayhfdG8pOwogICAgICAgIFRva2VuUmV3YXJkc0FkZGVkKF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICBldmVudCBTcGVudFRva2VucyhhZGRyZXNzIGluZGV4ZWQgcGFydGljaXBhbnQsIGFkZHJlc3MgaW5kZXhlZCByZWNpcGllbnQsIHVpbnQyNTYgYW1vdW50KTsKICAgIC8qKgogICAgICogU3BlbmQgZ2l2ZW4gbnVtYmVyIG9mIHRva2VucyBmb3IgYSB1c2FnZS4KICAgICAqCiAgICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgdG8gc3BlbmQgdXRpbGl0eSB0b2tlbnMgYXQKICAgICAqIEBwYXJhbSBfdmFsdWUgbnVtYmVyIG9mIHRva2VucyB0byBzcGVuZAogICAgICogQHJldHVybiB0cnVlIG9uIHN1Y2Nlc3MsIGZhbHNlIG9uIGVycm9yCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNwZW5kKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoX3ZhbHVlID4gMCk7CiAgICAgICAgYXNzZXJ0KF90byAhPSAweDApOwogICAgICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA8IF92YWx1ZSkgcmV0dXJuIGZhbHNlOwoKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIHNwZW50YW1vdW50W21zZy5zZW5kZXJdW190b10gPSBzcGVudGFtb3VudFttc2cuc2VuZGVyXVtfdG9dLmFkZChfdmFsdWUpOwoKICAgICAgICBTcGVudFRva2Vucyhtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgaWYoIXBhdHJvbkFwcGVuZGVkW21zZy5zZW5kZXJdKSB7CiAgICAgICAgICAgIHBhdHJvbkFwcGVuZGVkW21zZy5zZW5kZXJdID0gdHJ1ZTsKICAgICAgICAgICAgcGF0cm9ucy5wdXNoKG1zZy5zZW5kZXIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBldmVudCBCdXJuKGFkZHJlc3MgaW5kZXhlZCBidXJuZXIsIHVpbnQyNTYgdmFsdWUpOwogICAgLyoqCiAgICAgKiBCdXJuIGdpdmVuIG51bWJlciBvZiB0b2tlbnMgYmVsb25naW5nIHRvIG1lc3NhZ2Ugc2VuZGVyLgogICAgICogSXQgY2FuIGJlIGFwcGxpZWQgYnkgYWNjb3VudCB3aXRoIGFkZHJlc3MgdGhpcy50b2tlbnNhbGVDb250cmFjdAogICAgICoKICAgICAqIEBwYXJhbSBfdmFsdWUgbnVtYmVyIG9mIHRva2VucyB0byBidXJuCiAgICAgKiBAcmV0dXJuIHRydWUgb24gc3VjY2VzcywgZmFsc2Ugb24gZXJyb3IKICAgICAqLwogICAgZnVuY3Rpb24gYnVyblRva2VucyhhZGRyZXNzIGJ1cm5lciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYnVybmVyIHx8IG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIGFzc2VydChidXJuZXIgIT0gMHgwKTsKICAgICAgICBpZiAoX3ZhbHVlID4gdG90YWxTdXBwbHkpIHJldHVybiBmYWxzZTsKICAgICAgICBpZiAoX3ZhbHVlID4gYmFsYW5jZXNbYnVybmVyXSkgcmV0dXJuIGZhbHNlOwogICAgICAgIAogICAgICAgIGJhbGFuY2VzW2J1cm5lcl0gPSBiYWxhbmNlc1tidXJuZXJdLnN1YihfdmFsdWUpOwogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuc3ViKF92YWx1ZSk7CiAgICAgICAgQnVybihidXJuZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgdGhlIFZJUCBvd25lciBhdCB0aGUgaW5kZXguCiAgICAgKgogICAgICogQHBhcmFtIGluZGV4IG9mIHRoZSBWSVAgb3duZXIgb24gdGhlIFZJUCBsaXN0CiAgICAgKiBAcmV0dXJuIGFkZHJlc3Mgb2YgdGhlIFZJUCBvd25lcgogICAgICovCiAgICBmdW5jdGlvbiBnZXRWSVBPd25lcih1aW50MjU2IGluZGV4KSBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzIHZpcG93bmVyKSB7CiAgICAgICAgcmV0dXJuICh2aXBzW2luZGV4XSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgdGhlIGNvdW50IG9mIFZJUCBvd25lcnMuCiAgICAgKgogICAgICogQHJldHVybiBjb3VudCBvZiBWSVAgb3duZXJzIGxpc3QuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFZJUENvdW50KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBjb3VudCkgewogICAgICAgIHJldHVybiB2aXBzLmxlbmd0aDsKICAgIH0KCiAgICAvKioKICAgICAqIEdldCB0aGUgcGF0cm9uIGF0IHRoZSBpbmRleC4KICAgICAqCiAgICAgKiBAcGFyYW0gaW5kZXggb2YgdGhlIHBhdHJvbiBvbiB0aGUgcGF0cm9uIGxpc3QKICAgICAqIEByZXR1cm4gYWRkcmVzcyBvZiB0aGUgcGF0cm9uCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFBhdHJvbih1aW50MjU2IGluZGV4KSBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzIHBhdHJvbikgewogICAgICAgIHJldHVybiAocGF0cm9uc1tpbmRleF0pOwogICAgfQoKICAgIC8qKgogICAgICogR2V0IHRoZSBjb3VudCBvZiBwYXRyb25zLgogICAgICoKICAgICAqIEByZXR1cm4gbnVtYmVyIG9mIHBhdHJvbnMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFBhdHJvbnNDb3VudCgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgY291bnQpIHsKICAgICAgICByZXR1cm4gcGF0cm9ucy5sZW5ndGg7CiAgICB9Cn0KCi8qKgogKiBMb29rc0NvaW4gQ3Jvd2RTYWxlIENvbnRyYWN0CiAqCiAqIFRoZSB0b2tlbiBzYWxlIGNvbnRyb2xsZXIsIGFsbG93cyBjb250cmlidXRpbmcgZXRoZXIgaW4gZXhjaGFuZ2UgZm9yIExvb2tzQ29pbi4KICogVGhlIHByaWNlIChleGNoYW5nZSByYXRlIHdpdGggRVRIKSBpcyAyNDAwIExvb2tzQ29pbiBwZXIgRVRIIGF0IGNyb3dkc2FsZS4KICoKICogVklQIHJhbmsgaXMgdXNlZCB0byBjYWxjdWxhdGUgcHJpb3JpdHkgd2hlbiBjb21wZXRpbmcgd2l0aCBvdGhlciBiaWRzCiAqIGZvciB0aGUgc2FtZSBwcm9kdWN0IG9yIHNlcnZpY2Ugb24gdGhlIHBsYXRmb3JtLiAKICogSGlnaGVyIFZJUCByYW5rICh3aXRoIGVhcmxpZXIgdGltZXN0YW1wKSBoYXMgaGlnaGVyIHByaW9yaXR5LgogKiBIaWdoZXIgVklQIHJhbmsgd2FsbGV0IGFkZHJlc3Mgb3duZXIgY2FuIG91dGJpZCBvdGhlciBsb3dlciByYW5raW5nIG93bmVycyBvbmx5IG9uY2UKICogcGVyIHNlbGxpbmcgd2luZG93IG9yIHByb21vdGlvbiBwZXJpb2QuCiAqIFZJUCByYW5rIGlzIHJlY29yZGVkIGF0IHRoZSB0aW1lIHdoZW4gdGhlIHdhbGxldCBhZGRyZXNzIGZpcnN0IHJlYWNoIFZJUCBMb29rc0NvaW4gCiAqIGhvbGRpbmcgbGV2ZWwgZm9yIGEgdG9rZW4gcHVyY2hhc2VyLgogKiBWSVAgcmFuayBpcyB2YWxpZCBmb3IgdGhlIGxpZmV0aW1lIG9mIGEgd2FsbGV0IGFkZHJlc3Mgb24gdGhlIHBsYXRmb3JtLCBhcyBsb25nIGFzIGl0IAogKiBtZWV0cyB0aGUgVklQIGhvbGRpbmcgbGV2ZWwuCiAqCiAqCiAqIExvb2tzQ29pbiBDcm93ZFNhbGUgQm9udXMKICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKICogRmlyc3QgVGVuICgxc3QgdG8gMTB0aCkgVklQIG93bmVycyBnZXQgMjAlIGJvbnVzIExvb2tzQ29pbiBpbiB0aGVpciBWSVAgd2FsbGV0IGFkZHJlc3NlcwogKiBFbGV2ZW4gKDExdGgpIHRvIEZpZnR5ICg1MHRoKSBWSVAgb3duZXJzIGdldCAxMCUgYm9udXMgb2YgdGhlIExvb2tzQ29pbiBpbiB0aGVpciBWSVAgd2FsbGV0IGFkZHJlc3NlcwogKiBGaWZ0eSBPbmUgKDUxdGgpIHRvIE9uZSBIdW5kcmVkICgxMDB0aCkgVklQIG93bmVycyBnZXQgNSUgYm9udXMgb2YgdGhlIExvb2tzQ29pbiBpbiB0aGVpciBWSVAgd2FsbGV0IGFkZHJlc3NlcwogKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogKgogKiBCb251cyBMb29rc0NvaW4gd2lsbCBiZSBkaXN0cmlidXRlZCBieSBjb2luIG1hc3RlciB3aGVuIExvb2tzQ29pbiBoYXMgMTAwIFZJUCB3YWxsZXQgYWRkcmVzc2VzCiAqIEJvbnVzIGlzIGNhbGN1bGF0ZWQgYXM6CiAqICAgUGVyY2VudGFnZSBvZiBCb251cyAqIEFtb3VudCBvZiBMb29rc0NvaW4gYXQgdGhlIHdhbGxldCBhZGRyZXNzIGF0IHRoZSB0aW1lIHJlY29yZGVkIG9uIHRoZSBWSVAgcmFuayB0aW1lc3RhbXAKICogCiAqLwpjb250cmFjdCBMb29rc0NvaW5Dcm93ZFNhbGUgewogICAgTG9va3NDb2luIHB1YmxpYyBsb29rc0NvaW47CiAgICBFUkMyMCBwdWJsaWMgcHJlU2FsZVRva2VuOwoKICAgIC8vIGluaXRpYWwgcHJpY2UgaW4gd2VpIChudW1lcmF0b3IpCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBUT0tFTl9QUklDRV9OID0gMTsKICAgIC8vIGluaXRpYWwgcHJpY2UgaW4gd2VpIChkZW5vbWluYXRvcikKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IFRPS0VOX1BSSUNFX0QgPSAyNDAwOwogICAgLy8gMSBFVEggPSAyLDQwMCBMT09LUyB0b2tlbnMKCiAgICBhZGRyZXNzIHB1YmxpYyBzYWxlQ29udHJvbGxlciA9IDB4MDsKCiAgICAvLyBBbW91bnQgb2YgaW1wb3J0ZWQgdG9rZW5zIGZyb20gcHJlU2FsZQogICAgdWludDI1NiBwdWJsaWMgaW1wb3J0ZWRUb2tlbnMgPSAwOwoKICAgIC8vIEFtb3VudCBvZiB0b2tlbnMgc29sZAogICAgdWludDI1NiBwdWJsaWMgdG9rZW5zU29sZCA9IDA7CgogICAgLyoqCiAgICAgKiBBZGRyZXNzIG9mIHRoZSBvd25lciBvZiB0aGlzIHNtYXJ0IGNvbnRyYWN0LgogICAgICovCiAgICBhZGRyZXNzIGZ1bmRzdG9yYWdlID0gMHgwOwoKICAgIC8qKgogICAgICogU3RhdGVzIG9mIHRoZSBjcm93ZHNhbGUgY29udHJhY3QuCiAgICAgKi8KICAgIGVudW0gU3RhdGV7CiAgICAgICAgUGF1c2UsCiAgICAgICAgSW5pdCwKICAgICAgICBSdW5uaW5nLAogICAgICAgIFN0b3BwZWQsCiAgICAgICAgTWlncmF0ZWQKICAgIH0KCiAgICBTdGF0ZSBwdWJsaWMgY3VycmVudFN0YXRlID0gU3RhdGUuUnVubmluZzsgICAgCgogICAgLyoqCiAgICAgKiBNb2RpZmllci4KICAgICAqLwogICAgbW9kaWZpZXIgb25Dcm93ZFNhbGVSdW5uaW5nKCkgewogICAgICAgIC8vIENoZWNrcywgaWYgQ3Jvd2RTYWxlIGlzIHJ1bm5pbmcgYW5kIGhhcyBub3QgYmVlbiBwYXVzZWQKICAgICAgICByZXF1aXJlKGN1cnJlbnRTdGF0ZSA9PSBTdGF0ZS5SdW5uaW5nKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIG5ldyBjcm93ZHNhbGUgc21hcnQgY29udHJhY3QsIG1ha2UgbWVzc2FnZSBzZW5kZXIgdG8gYmUgdGhlCiAgICAgKiBvd25lciBvZiBzbWFydCBjb250cmFjdC4KICAgICAqLwogICAgZnVuY3Rpb24gTG9va3NDb2luQ3Jvd2RTYWxlKCkgewogICAgICAgIHNhbGVDb250cm9sbGVyID0gbXNnLnNlbmRlcjsKICAgICAgICBmdW5kc3RvcmFnZSA9IG1zZy5zZW5kZXI7CgogICAgICAgIHByZVNhbGVUb2tlbiA9IEVSQzIwKDB4MjUzQzdkZDA3NGY0QmFDYjMwNTM4N0Y5MjIyMjVBNGY3MzdDMDhiZCk7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgU2V0IG5ldyBzdGF0ZQogICAgKiBAcGFyYW0gX25ld1N0YXRlIFZhbHVlIG9mIG5ldyBzdGF0ZQogICAgKi8KICAgIGZ1bmN0aW9uIHNldFN0YXRlKFN0YXRlIF9uZXdTdGF0ZSkKICAgIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gc2FsZUNvbnRyb2xsZXIpOwogICAgICAgIGN1cnJlbnRTdGF0ZSA9IF9uZXdTdGF0ZTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBTZXQgdG9rZW4gY29udHJhY3QgYWRkcmVzcwogICAgKiBAcGFyYW0gX3Rva2VuQ29udHJhY3QgYWRkcmVzcyBvZiBMb29rc0NvaW4gdG9rZW4gY29udHJhY3QKICAgICovCiAgICBmdW5jdGlvbiBzZXRUb2tlbkNvbnRyYWN0KGFkZHJlc3MgX3Rva2VuQ29udHJhY3QpCiAgICB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHNhbGVDb250cm9sbGVyKTsKICAgICAgICBhc3NlcnQoX3Rva2VuQ29udHJhY3QgIT0gMHgwKTsKICAgICAgICBsb29rc0NvaW4gPSBMb29rc0NvaW4oX3Rva2VuQ29udHJhY3QpOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IFNldCB0b2tlbiBjb250cmFjdCBhZGRyZXNzIGZvciBtaWdyYXRpb24KICAgICogQHBhcmFtIF9wcmV2VG9rZW5Db250cmFjdCBhZGRyZXNzIG9mIHRva2VuIGNvbnRyYWN0IGZvciBtaWdyYXRpb24KICAgICovCiAgICBmdW5jdGlvbiBzZXRNaWdyYXRlVG9rZW5Db250cmFjdChhZGRyZXNzIF9wcmV2VG9rZW5Db250cmFjdCkKICAgIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gc2FsZUNvbnRyb2xsZXIpOwogICAgICAgIGFzc2VydChfcHJldlRva2VuQ29udHJhY3QgIT0gMHgwKTsKICAgICAgICBwcmVTYWxlVG9rZW4gPSBFUkMyMChfcHJldlRva2VuQ29udHJhY3QpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBTZXQgbmV3IHRva2VuIHNhbGUgY29udHJvbGxlci4KICAgICAqIE1heSBvbmx5IGJlIGNhbGxlZCBieSBzYWxlIGNvbnRyb2xsZXIuCiAgICAgKgogICAgICogQHBhcmFtIF9uZXdTYWxlQ29udHJvbGxlciBuZXcgdG9rZW4gc2FsZSBjb250cm9sbGVyLgogICAgICovCiAgICBmdW5jdGlvbiBzZXRTYWxlQ29udHJvbGxlcihhZGRyZXNzIF9uZXdTYWxlQ29udHJvbGxlcikgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBzYWxlQ29udHJvbGxlcik7CiAgICAgICAgYXNzZXJ0KF9uZXdTYWxlQ29udHJvbGxlciAhPSAweDApOwogICAgICAgIHNhbGVDb250cm9sbGVyID0gX25ld1NhbGVDb250cm9sbGVyOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IG5ldyB3YWxsZXQgYWRkcmVzcyBmb3IgdGhlIHNtYXJ0IGNvbnRyYWN0LgogICAgICogTWF5IG9ubHkgYmUgY2FsbGVkIGJ5IHNtYXJ0IGNvbnRyYWN0IG93bmVyLgogICAgICoKICAgICAqIEBwYXJhbSBfZnVuZHN0b3JhZ2UgbmV3IHdhbGxldCBhZGRyZXNzIG9mIHRoZSBzbWFydCBjb250cmFjdC4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0V2FsbGV0KGFkZHJlc3MgX2Z1bmRzdG9yYWdlKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHNhbGVDb250cm9sbGVyKTsKICAgICAgICBhc3NlcnQoX2Z1bmRzdG9yYWdlICE9IDB4MCk7CiAgICAgICAgZnVuZHN0b3JhZ2UgPSBfZnVuZHN0b3JhZ2U7CiAgICB9CgogICAgLyoqCiAgICAqIHNhdmVzIGluZm8gaWYgYWNjb3VudCdzIHRva2VucyB3ZXJlIGltcG9ydGVkIGZyb20gcHJldmlvdXMgc2FsZS4KICAgICovCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHByaXZhdGUgaW1wb3J0ZWRGcm9tUHJlU2FsZTsKCiAgICBldmVudCBUb2tlbnNJbXBvcnQoYWRkcmVzcyBpbmRleGVkIHBhcnRpY2lwYW50LCB1aW50MjU2IHRva2VucywgdWludDI1NiB0b3RhbEltcG9ydCk7CiAgICAvKioKICAgICogSW1wb3J0cyBhY2NvdW50J3MgdG9rZW5zIGZyb20gcHJldmlvdXMgc2FsZQogICAgKiBJdCBjYW4gYmUgZG9uZSBvbmx5IGJ5IGFjY291bnQgb3duZXIgb3Igc2FsZSBjb250cm9sbGVyCiAgICAqIEBwYXJhbSBfYWNjb3VudCBBZGRyZXNzIG9mIGFjY291bnQgd2hpY2ggdG9rZW5zIHdpbGwgYmUgaW1wb3J0ZWQKICAgICovCiAgICBmdW5jdGlvbiBpbXBvcnRUb2tlbnMoYWRkcmVzcyBfYWNjb3VudCkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgLy8gb25seSB0b2tlbiBob2xkZXIgb3Igc2FsZSBjb250cm9sbGVyIGNhbiBkbyBpbXBvcnQKICAgICAgICByZXF1aXJlKGN1cnJlbnRTdGF0ZSA9PSBTdGF0ZS5SdW5uaW5nKTsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gc2FsZUNvbnRyb2xsZXIgfHwgbXNnLnNlbmRlciA9PSBfYWNjb3VudCk7CiAgICAgICAgcmVxdWlyZSghaW1wb3J0ZWRGcm9tUHJlU2FsZVtfYWNjb3VudF0pOwoKICAgICAgICB1aW50MjU2IHByZVNhbGVCYWxhbmNlID0gcHJlU2FsZVRva2VuLmJhbGFuY2VPZihfYWNjb3VudCk7CgogICAgICAgIGlmIChwcmVTYWxlQmFsYW5jZSA9PSAwKSByZXR1cm4gZmFsc2U7CgogICAgICAgIGxvb2tzQ29pbi5yZXdhcmRUb2tlbnMoX2FjY291bnQsIHByZVNhbGVCYWxhbmNlKTsKICAgICAgICBpbXBvcnRlZFRva2VucyA9IGltcG9ydGVkVG9rZW5zICsgcHJlU2FsZUJhbGFuY2U7CiAgICAgICAgaW1wb3J0ZWRGcm9tUHJlU2FsZVtfYWNjb3VudF0gPSB0cnVlOwogICAgICAgIFRva2Vuc0ltcG9ydChfYWNjb3VudCwgcHJlU2FsZUJhbGFuY2UsIGltcG9ydGVkVG9rZW5zKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBmYWxsYmFjawogICAgZnVuY3Rpb24oKSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgYnV5VG9rZW5zKCk7CiAgICB9CgogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50IF92YWx1ZSk7CiAgICBldmVudCBUb2tlbnNCb3VnaHQoYWRkcmVzcyBpbmRleGVkIGJ1eWVyLCB1aW50MjU2IGV0aGVycywgdWludDI1NiB0b2tlbnMsIHVpbnQyNTYgdG9rZW5zU29sZCk7CiAgICAvKioKICAgICAqIEFjY2VwdCBldGhlcnMgdG8gYnV5IHRva2VucyBkdXJpbmcgdGhlIHRva2VuIHNhbGUKICAgICAqIE1pbmltaXVtIGhvbGRpbmdzIHRvIHJlY2VpdmUgYSBWSVAgcmFuayBpcyAyNDAwMCBMb29rc0NvaW4KICAgICAqLwogICAgZnVuY3Rpb24gYnV5VG9rZW5zKCkgcGF5YWJsZSByZXR1cm5zICh1aW50MjU2IGFtb3VudCkKICAgIHsKICAgICAgICByZXF1aXJlKGN1cnJlbnRTdGF0ZSA9PSBTdGF0ZS5SdW5uaW5nKTsKICAgICAgICBhc3NlcnQobXNnLnNlbmRlciAhPSAweDApOwogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID4gMCk7CgogICAgICAgIC8vIENhbGN1bGF0ZSBudW1iZXIgb2YgdG9rZW5zIGZvciBjb250cmlidXRlZCB3ZWkKICAgICAgICB1aW50MjU2IHRva2VucyA9IG1zZy52YWx1ZSAqIFRPS0VOX1BSSUNFX0QgLyBUT0tFTl9QUklDRV9OOwogICAgICAgIGlmICh0b2tlbnMgPT0gMCkgcmV0dXJuIDA7CgogICAgICAgIGxvb2tzQ29pbi5yZXdhcmRUb2tlbnMobXNnLnNlbmRlciwgdG9rZW5zKTsKICAgICAgICB0b2tlbnNTb2xkID0gdG9rZW5zU29sZCArIHRva2VuczsKCiAgICAgICAgLy8gTG9nIHRoZSB0b2tlbnMgcHVyY2hhc2VkIAogICAgICAgIFRyYW5zZmVyKDB4MCwgbXNnLnNlbmRlciwgdG9rZW5zKTsKICAgICAgICBUb2tlbnNCb3VnaHQobXNnLnNlbmRlciwgbXNnLnZhbHVlLCB0b2tlbnMsIHRva2Vuc1NvbGQpOwoKICAgICAgICBhc3NlcnQoZnVuZHN0b3JhZ2Uuc2VuZChtc2cudmFsdWUpKTsKICAgICAgICByZXR1cm4gdG9rZW5zOwogICAgfQp9'.
	

]
