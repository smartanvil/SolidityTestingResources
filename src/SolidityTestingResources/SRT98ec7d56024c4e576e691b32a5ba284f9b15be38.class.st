Class {
	#name : #SRT98ec7d56024c4e576e691b32a5ba284f9b15be38,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT98ec7d56024c4e576e691b32a5ba284f9b15be38 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKioKICogQHRpdGxlIEVSQzcyMSBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL2VpcHMvaXNzdWVzLzcyMQogKi8KY29udHJhY3QgRVJDNzIxIHsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfYXBwcm92ZWQsIHVpbnQyNTYgX3Rva2VuSWQpOwoKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgX2JhbGFuY2UpOwogIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBfb3duZXIpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWM7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljOwogIGZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JZCkgcHVibGljOwp9CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgogIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQogIAogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKY29udHJhY3QgQ291bnRyeVRva2VuIHsKICBmdW5jdGlvbiBnZXRDb3VudHJ5RGF0YSAodWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChhZGRyZXNzIF9vd25lciwgdWludDI1NiBfc3RhcnRpbmdQcmljZSwgdWludDI1NiBfcHJpY2UsIHVpbnQyNTYgX25leHRQcmljZSwgdWludDI1NiBfcGF5b3V0KTsKfQoKLyoqCiAqIEB0aXRsZSBFUkM3MjFUb2tlbgogKiBHZW5lcmljIGltcGxlbWVudGF0aW9uIGZvciB0aGUgcmVxdWlyZWQgZnVuY3Rpb25hbGl0eSBvZiB0aGUgRVJDNzIxIHN0YW5kYXJkCiAqLwpjb250cmFjdCBDaXR5VG9rZW4gaXMgRVJDNzIxLCBPd25hYmxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgYWRkcmVzcyBjQWRkcmVzcyA9IDB4MGM1MDdENDhDMGNkMTIzMkI4MmFBOTUwZDQ4N2QwMUNmYzY0NDJEYjsKICAKICBDb3VudHJ5VG9rZW4gY291bnRyeUNvbnRyYWN0ID0gQ291bnRyeVRva2VuKGNBZGRyZXNzKTsKCiAgLy9Db3VudHJ5VG9rZW4gcHJpdmF0ZSBjb3VudHJ5Q29udHJhY3Q7CiAgdWludDMyIGNvbnN0YW50IENPVU5UUllfSURYID0gMTAwOwogIHVpbnQyNTYgY29uc3RhbnQgQ09VTlRSWV9QQVlPVVQgPSAxNTsgLy8gMTUlCgogIC8vIFRvdGFsIGFtb3VudCBvZiB0b2tlbnMKICB1aW50MjU2IHByaXZhdGUgdG90YWxUb2tlbnM7CiAgdWludDI1NltdIHByaXZhdGUgbGlzdGVkQ2l0aWVzOwogIHVpbnQyNTYgcHVibGljIGRldk93ZWQ7CiAgdWludDI1NiBwdWJsaWMgcG9vbFRvdGFsOwogIHVpbnQyNTYgcHVibGljIGxhc3RQdXJjaGFzZTsKCiAgLy8gQ2l0eSBEYXRhCiAgbWFwcGluZyAodWludDI1NiA9PiBDaXR5KSBwdWJsaWMgY2l0eURhdGE7CgogIC8vIE1hcHBpbmcgZnJvbSB0b2tlbiBJRCB0byBvd25lcgogIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgcHJpdmF0ZSB0b2tlbk93bmVyOwoKICAvLyBNYXBwaW5nIGZyb20gdG9rZW4gSUQgdG8gYXBwcm92ZWQgYWRkcmVzcwogIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgcHJpdmF0ZSB0b2tlbkFwcHJvdmFsczsKCiAgLy8gTWFwcGluZyBmcm9tIG93bmVyIHRvIGxpc3Qgb2Ygb3duZWQgdG9rZW4gSURzCiAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2W10pIHByaXZhdGUgb3duZWRUb2tlbnM7CgogIC8vIE1hcHBpbmcgZnJvbSB0b2tlbiBJRCB0byBpbmRleCBvZiB0aGUgb3duZXIgdG9rZW5zIGxpc3QKICBtYXBwaW5nKHVpbnQyNTYgPT4gdWludDI1NikgcHJpdmF0ZSBvd25lZFRva2Vuc0luZGV4OwoKICAvLyBCYWxhbmNlcyBmcm9tICUgcGF5b3V0cy4KICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHByaXZhdGUgcGF5b3V0QmFsYW5jZXM7IAoKICAvLyBUaGUgYW1vdW50IG9mIEV0aCB0aGlzIGNvdW50cnkgaGFzIHdpdGhkcmF3biBmcm9tIHRoZSBwb29sLgogIG1hcHBpbmcgKHVpbnQyNTYgPT4gdWludDI1NikgcHJpdmF0ZSBjb3VudHJ5V2l0aGRyYXduOwoKICAvLyBFdmVudHMKICBldmVudCBDaXR5UHVyY2hhc2VkKHVpbnQyNTYgaW5kZXhlZCBfdG9rZW5JZCwgYWRkcmVzcyBpbmRleGVkIF9vd25lciwgdWludDI1NiBfcHVyY2hhc2VQcmljZSk7CgogIC8vIFB1cmNoYXNpbmcgQ2FwcyBmb3IgRGV0ZXJtaW5pbmcgTmV4dCBQb29sIEN1dAogIHVpbnQyNTYgcHJpdmF0ZSBmaXJzdENhcCAgPSAwLjEyIGV0aGVyOwogIHVpbnQyNTYgcHJpdmF0ZSBzZWNvbmRDYXAgPSAwLjUgZXRoZXI7CiAgdWludDI1NiBwcml2YXRlIHRoaXJkQ2FwICA9IDEuNSBldGhlcjsKCiAgLy8gU3RydWN0IHRvIHN0b3JlIENpdHkgRGF0YQogIHN0cnVjdCBDaXR5IHsKICAgICAgdWludDI1NiBwcmljZTsgICAgICAgICAvLyBDdXJyZW50IHByaWNlIG9mIHRoZSBpdGVtLgogICAgICB1aW50MjU2IGxhc3RQcmljZTsgICAgIC8vIGxhc3RQcmljZSB0aGlzIHdhcyBzb2xkIGZvciwgdXNlZCBmb3IgYWRkaW5nIHRvIHBvb2wuCiAgICAgIHVpbnQyNTYgcGF5b3V0OyAgICAgICAgLy8gVGhlIHBlcmNlbnQgb2YgdGhlIHBvb2wgcmV3YXJkZWQuCiAgICAgIHVpbnQyNTYgd2l0aGRyYXduOyAgICAgLy8gVGhlIGFtb3VudCBvZiBFdGggdGhpcyBjaXR5IGhhcyB3aXRoZHJhd24gZnJvbSB0aGUgcG9vbC4KICAgICAgYWRkcmVzcyBvd25lcjsgICAgICAgICAvLyBDdXJyZW50IG93bmVyIG9mIHRoZSBpdGVtLgogIH0KCiAgLyoqCiAgICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgbmV3IHRva2VuCiAgICogQHBhcmFtIF9wYXlvdXRQZXJjZW50YWdlIHVpbnQyNTYgcGF5b3V0IHBlcmNlbnRhZ2UgKGRpdmlzaWJsZSBieSAxMCkKICAgKi8KICAgZnVuY3Rpb24gY3JlYXRlUHJvbW9MaXN0aW5nKHVpbnQyNTYgX3Rva2VuSWQsIHVpbnQyNTYgX3N0YXJ0aW5nUHJpY2UsIHVpbnQyNTYgX3BheW91dFBlcmNlbnRhZ2UpIG9ubHlPd25lcigpIHB1YmxpYyB7CiAgICAgdWludDI1NiBjb3VudHJ5SWQgPSBfdG9rZW5JZCAlIENPVU5UUllfSURYOwogICAgIGFkZHJlc3MgY291bnRyeU93bmVyOwogICAgIHVpbnQyNTYgcHJpY2U7CiAgICAgKGNvdW50cnlPd25lciwscHJpY2UsLCkgPSBjb3VudHJ5Q29udHJhY3QuZ2V0Q291bnRyeURhdGEoY291bnRyeUlkKTsKICAgICByZXF1aXJlIChjb3VudHJ5T3duZXIgIT0gYWRkcmVzcygwKSk7CgogICAgIGlmIChfc3RhcnRpbmdQcmljZSA9PSAwKSB7CiAgICAgICBpZiAocHJpY2UgPj0gdGhpcmRDYXApIF9zdGFydGluZ1ByaWNlID0gcHJpY2UuZGl2KDgwKTsKICAgICAgIGVsc2UgaWYgKHByaWNlID49IHNlY29uZENhcCkgX3N0YXJ0aW5nUHJpY2UgPSBwcmljZS5kaXYoNzUpOwogICAgICAgZWxzZSBfc3RhcnRpbmdQcmljZSA9IDAuMDAyIGV0aGVyOwogICAgIH0KCiAgICAgY3JlYXRlTGlzdGluZyhfdG9rZW5JZCwgX3N0YXJ0aW5nUHJpY2UsIF9wYXlvdXRQZXJjZW50YWdlLCBjb3VudHJ5T3duZXIpOwogICB9CgogIC8qKgogICogQGRldiBjcmVhdGVMaXN0aW5nIEFkZHMgbmV3IEVSQzcyMSBUb2tlbgogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgbmV3IHRva2VuCiAgKiBAcGFyYW0gX3BheW91dFBlcmNlbnRhZ2UgdWludDI1NiBwYXlvdXQgcGVyY2VudGFnZSAoZGl2aXNpYmxlIGJ5IDEwKQogICogQHBhcmFtIF9vd25lciBhZGRyZXNzIG9mIG5ldyBvd25lcgogICovCiAgZnVuY3Rpb24gY3JlYXRlTGlzdGluZyh1aW50MjU2IF90b2tlbklkLCB1aW50MjU2IF9zdGFydGluZ1ByaWNlLCB1aW50MjU2IF9wYXlvdXRQZXJjZW50YWdlLCBhZGRyZXNzIF9vd25lcikgb25seU93bmVyKCkgcHVibGljIHsKCiAgICAvLyBtYWtlIHN1cmUgcHJpY2UgPiAwCiAgICByZXF1aXJlKF9zdGFydGluZ1ByaWNlID4gMCk7CiAgICAvLyBtYWtlIHN1cmUgdG9rZW4gaGFzbid0IGJlZW4gdXNlZCB5ZXQKICAgIHJlcXVpcmUoY2l0eURhdGFbX3Rva2VuSWRdLnByaWNlID09IDApOwogICAgCiAgICAvLyBjcmVhdGUgbmV3IHRva2VuCiAgICBDaXR5IHN0b3JhZ2UgbmV3Q2l0eSA9IGNpdHlEYXRhW190b2tlbklkXTsKCiAgICBuZXdDaXR5Lm93bmVyID0gX293bmVyOwogICAgbmV3Q2l0eS5wcmljZSA9IF9zdGFydGluZ1ByaWNlOwogICAgbmV3Q2l0eS5sYXN0UHJpY2UgPSAwOwogICAgbmV3Q2l0eS5wYXlvdXQgPSBfcGF5b3V0UGVyY2VudGFnZTsKCiAgICAvLyBzdG9yZSBjaXR5IGluIHN0b3JhZ2UKICAgIGxpc3RlZENpdGllcy5wdXNoKF90b2tlbklkKTsKICAgIAogICAgLy8gbWludCBuZXcgdG9rZW4KICAgIF9taW50KF9vd25lciwgX3Rva2VuSWQpOwogIH0KCiAgZnVuY3Rpb24gY3JlYXRlTXVsdGlwbGUgKHVpbnQyNTZbXSBfaXRlbUlkcywgdWludDI1NltdIF9wcmljZXMsIHVpbnQyNTZbXSBfcGF5b3V0cywgYWRkcmVzcyBfb3duZXIpIG9ubHlPd25lcigpIGV4dGVybmFsIHsKICAgIGZvciAodWludDI1NiBpID0gMDsgaSA8IF9pdGVtSWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNyZWF0ZUxpc3RpbmcoX2l0ZW1JZHNbaV0sIF9wcmljZXNbaV0sIF9wYXlvdXRzW2ldLCBfb3duZXIpOwogICAgfQogIH0KCiAgLyoqCiAgKiBAZGV2IERldGVybWluZXMgbmV4dCBwcmljZSBvZiB0b2tlbgogICogQHBhcmFtIF9wcmljZSB1aW50MjU2IElEIG9mIGN1cnJlbnQgcHJpY2UKICAqLwogIGZ1bmN0aW9uIGdldE5leHRQcmljZSAodWludDI1NiBfcHJpY2UpIHByaXZhdGUgdmlldyByZXR1cm5zICh1aW50MjU2IF9uZXh0UHJpY2UpIHsKICAgIGlmIChfcHJpY2UgPCBmaXJzdENhcCkgewogICAgICByZXR1cm4gX3ByaWNlLm11bCgyMDApLmRpdig5NCk7CiAgICB9IGVsc2UgaWYgKF9wcmljZSA8IHNlY29uZENhcCkgewogICAgICByZXR1cm4gX3ByaWNlLm11bCgxMzUpLmRpdig5NSk7CiAgICB9IGVsc2UgaWYgKF9wcmljZSA8IHRoaXJkQ2FwKSB7CiAgICAgIHJldHVybiBfcHJpY2UubXVsKDExOCkuZGl2KDk2KTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBfcHJpY2UubXVsKDExNSkuZGl2KDk3KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGNhbGN1bGF0ZVBvb2xDdXQgKHVpbnQyNTYgX3ByaWNlKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IF9wb29sQ3V0KSB7CiAgICBpZiAoX3ByaWNlIDwgZmlyc3RDYXApIHsKICAgICAgcmV0dXJuIF9wcmljZS5tdWwoMTApLmRpdigxMDApOyAvLyAxMCUKICAgIH0gZWxzZSBpZiAoX3ByaWNlIDwgc2Vjb25kQ2FwKSB7CiAgICAgIHJldHVybiBfcHJpY2UubXVsKDkpLmRpdigxMDApOyAvLyA5JQogICAgfSBlbHNlIGlmIChfcHJpY2UgPCB0aGlyZENhcCkgewogICAgICByZXR1cm4gX3ByaWNlLm11bCg4KS5kaXYoMTAwKTsgLy8gOCUKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBfcHJpY2UubXVsKDcpLmRpdigxMDApOyAvLyA3JQogICAgfQogIH0KCiAgLyoqCiAgKiBAZGV2IFB1cmNoYXNlIGNpdHkgZnJvbSBwcmV2aW91cyBvd25lcgogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgb2YgdG9rZW4KICAqLwogIGZ1bmN0aW9uIHB1cmNoYXNlQ2l0eSh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgCiAgICBwYXlhYmxlCiAgICBpc05vdENvbnRyYWN0KG1zZy5zZW5kZXIpCiAgewoKICAgIC8vIGdldCBkYXRhIGZyb20gc3RvcmFnZQogICAgQ2l0eSBzdG9yYWdlIGNpdHkgPSBjaXR5RGF0YVtfdG9rZW5JZF07CiAgICB1aW50MjU2IHByaWNlID0gY2l0eS5wcmljZTsKICAgIGFkZHJlc3Mgb2xkT3duZXIgPSBjaXR5Lm93bmVyOwogICAgYWRkcmVzcyBuZXdPd25lciA9IG1zZy5zZW5kZXI7CgogICAgLy8gcmV2ZXJ0IGNoZWNrcwogICAgcmVxdWlyZShwcmljZSA+IDApOwogICAgcmVxdWlyZShtc2cudmFsdWUgPj0gcHJpY2UpOwogICAgcmVxdWlyZShvbGRPd25lciAhPSBtc2cuc2VuZGVyKTsKCiAgICB1aW50MjU2IGV4Y2VzcyA9IG1zZy52YWx1ZS5zdWIocHJpY2UpOwoKICAgIC8vIENhbGN1bGF0ZSBwb29sIGN1dCBmb3IgdGF4ZXMuCiAgICB1aW50MjU2IHByb2ZpdCA9IHByaWNlLnN1YihjaXR5Lmxhc3RQcmljZSk7CiAgICB1aW50MjU2IHBvb2xDdXQgPSBjYWxjdWxhdGVQb29sQ3V0KHByb2ZpdCk7CiAgICBwb29sVG90YWwgKz0gcG9vbEN1dDsKCiAgICAvLyAzJSBnb2VzIHRvIGRldmVsb3BlcnMKICAgIHVpbnQyNTYgZGV2Q3V0ID0gcHJpY2UubXVsKDMpLmRpdigxMDApOwogICAgZGV2T3dlZCA9IGRldk93ZWQuYWRkKGRldkN1dCk7CgogICAgdHJhbnNmZXJDaXR5KG9sZE93bmVyLCBuZXdPd25lciwgX3Rva2VuSWQpOwoKICAgIC8vIHNldCBuZXcgcHJpY2VzCiAgICBjaXR5Lmxhc3RQcmljZSA9IHByaWNlOwogICAgY2l0eS5wcmljZSA9IGdldE5leHRQcmljZShwcmljZSk7CgogICAgLy8gcmFpc2UgZXZlbnQKICAgIENpdHlQdXJjaGFzZWQoX3Rva2VuSWQsIG5ld093bmVyLCBwcmljZSk7CgogICAgLy8gVHJhbnNmZXIgcGF5bWVudCB0byBvbGQgb3duZXIgbWludXMgdGhlIGRldmVsb3BlcidzIGFuZCBwb29sJ3MgY3V0LgogICAgb2xkT3duZXIudHJhbnNmZXIocHJpY2Uuc3ViKGRldkN1dC5hZGQocG9vbEN1dCkpKTsKCiAgICAvLyBUcmFuc2ZlciAxMCUgcHJvZml0IHRvIGN1cnJlbnQgY291bnRyeSBvd25lcgogICAgdWludDI1NiBjb3VudHJ5SWQgPSBfdG9rZW5JZCAlIENPVU5UUllfSURYOwogICAgYWRkcmVzcyBjb3VudHJ5T3duZXI7CiAgICAoY291bnRyeU93bmVyLCwsLCkgPSBjb3VudHJ5Q29udHJhY3QuZ2V0Q291bnRyeURhdGEoY291bnRyeUlkKTsKICAgIHJlcXVpcmUgKGNvdW50cnlPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIGNvdW50cnlPd25lci50cmFuc2Zlcihwb29sQ3V0Lm11bChDT1VOVFJZX1BBWU9VVCkuZGl2KDEwMCkpOwoKICAgIC8vIFNlbmQgcmVmdW5kIHRvIG93bmVyIGlmIG5lZWRlZAogICAgaWYgKGV4Y2VzcyA+IDApIHsKICAgICAgbmV3T3duZXIudHJhbnNmZXIoZXhjZXNzKTsKICAgIH0KCiAgICAvLyBzZXQgbGFzdCBwdXJjaGFzZSBwcmljZSB0byBzdG9yYWdlCiAgICBsYXN0UHVyY2hhc2UgPSBub3c7CgogIH0KCiAgLyoqCiAgKiBAZGV2IFRyYW5zZmVyIENpdHkgZnJvbSBQcmV2aW91cyBPd25lciB0byBOZXcgT3duZXIKICAqIEBwYXJhbSBfZnJvbSBwcmV2aW91cyBvd25lciBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIG5ldyBvd25lciBhZGRyZXNzCiAgKiBAcGFyYW0gX3Rva2VuSWQgdWludDI1NiBJRCBvZiB0b2tlbgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXJDaXR5KGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBpbnRlcm5hbCB7CgogICAgLy8gY2hlY2sgdG9rZW4gZXhpc3RzCiAgICByZXF1aXJlKHRva2VuRXhpc3RzKF90b2tlbklkKSk7CgogICAgLy8gbWFrZSBzdXJlIHByZXZpb3VzIG93bmVyIGlzIGNvcnJlY3QKICAgIHJlcXVpcmUoY2l0eURhdGFbX3Rva2VuSWRdLm93bmVyID09IF9mcm9tKTsKCiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3ModGhpcykpOwoKICAgIC8vIHBheSBhbnkgdW5wYWlkIHBheW91dHMgdG8gcHJldmlvdXMgb3duZXIgb2YgY2l0eQogICAgdXBkYXRlU2luZ2xlUGF5b3V0KF9mcm9tLCBfdG9rZW5JZCk7CgogICAgLy8gY2xlYXIgYXBwcm92YWxzIGxpbmtlZCB0byB0aGlzIHRva2VuCiAgICBjbGVhckFwcHJvdmFsKF9mcm9tLCBfdG9rZW5JZCk7CgogICAgLy8gcmVtb3ZlIHRva2VuIGZyb20gcHJldmlvdXMgb3duZXIKICAgIHJlbW92ZVRva2VuKF9mcm9tLCBfdG9rZW5JZCk7CgogICAgLy8gdXBkYXRlIG93bmVyIGFuZCBhZGQgdG9rZW4gdG8gbmV3IG93bmVyCiAgICBjaXR5RGF0YVtfdG9rZW5JZF0ub3duZXIgPSBfdG87CiAgICBhZGRUb2tlbihfdG8sIF90b2tlbklkKTsKCiAgIC8vcmFpc2UgZXZlbnQKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICB9CgogIC8qKgogICogQGRldiBXaXRoZHJhdyBkZXYncyBjdXQKICAqLwogIGZ1bmN0aW9uIHdpdGhkcmF3KCkgb25seU93bmVyIHB1YmxpYyB7CiAgICBvd25lci50cmFuc2ZlcihkZXZPd2VkKTsKICAgIGRldk93ZWQgPSAwOwogIH0KCiAgLyoqCiAgKiBAZGV2IFNldHMgaXRlbSdzIHBheW91dAogICogQHBhcmFtIF9pdGVtSWQgaXRlbUlkIHRvIGJlIGNoYW5nZWQKICAqLwogIGZ1bmN0aW9uIHNldFBheW91dCh1aW50MjU2IF9pdGVtSWQsIHVpbnQyNTYgX25ld1BheW91dCkgb25seU93bmVyIHB1YmxpYyB7CiAgICBDaXR5IHN0b3JhZ2UgY2l0eSA9IGNpdHlEYXRhW19pdGVtSWRdOwogICAgY2l0eS5wYXlvdXQgPSBfbmV3UGF5b3V0OwogIH0KCiAgLyoqCiAgKiBAZGV2IFVwZGF0ZXMgdGhlIHBheW91dCBmb3IgdGhlIGNpdGllcyB0aGUgb3duZXIgaGFzCiAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3Mgb2YgdG9rZW4gb3duZXIKICAqLwogIGZ1bmN0aW9uIHVwZGF0ZVBheW91dChhZGRyZXNzIF9vd25lcikgcHVibGljIHsKICAgIHVpbnQyNTZbXSBtZW1vcnkgY2l0aWVzID0gb3duZWRUb2tlbnNbX293bmVyXTsKICAgIHVpbnQyNTYgb3dlZDsKICAgIGZvciAodWludDI1NiBpID0gMDsgaSA8IGNpdGllcy5sZW5ndGg7IGkrKykgewogICAgICAgIHVpbnQyNTYgdG90YWxDaXR5T3dlZCA9IHBvb2xUb3RhbCAqIGNpdHlEYXRhW2NpdGllc1tpXV0ucGF5b3V0IC8gMTAwMDA7CiAgICAgICAgdWludDI1NiBjaXR5T3dlZCA9IHRvdGFsQ2l0eU93ZWQuc3ViKGNpdHlEYXRhW2NpdGllc1tpXV0ud2l0aGRyYXduKTsKICAgICAgICBvd2VkICs9IGNpdHlPd2VkOwogICAgICAgIAogICAgICAgIGNpdHlEYXRhW2NpdGllc1tpXV0ud2l0aGRyYXduICs9IGNpdHlPd2VkOwogICAgfQogICAgcGF5b3V0QmFsYW5jZXNbX293bmVyXSArPSBvd2VkOwogIH0KCiAgLyoqCiAgICogQGRldiBVcGRhdGUgYSBzaW5nbGUgY2l0eSBwYXlvdXQgZm9yIHRyYW5zZmVycy4KICAgKiBAcGFyYW0gX293bmVyIEFkZHJlc3Mgb2YgdGhlIG93bmVyIG9mIHRoZSBjaXR5LgogICAqIEBwYXJhbSBfaXRlbUlkIFVuaXF1ZSBJZCBvZiB0aGUgdG9rZW4uCiAgKiovCiAgZnVuY3Rpb24gdXBkYXRlU2luZ2xlUGF5b3V0KGFkZHJlc3MgX293bmVyLCB1aW50MjU2IF9pdGVtSWQpIGludGVybmFsIHsKICAgIHVpbnQyNTYgdG90YWxDaXR5T3dlZCA9IHBvb2xUb3RhbCAqIGNpdHlEYXRhW19pdGVtSWRdLnBheW91dCAvIDEwMDAwOwogICAgdWludDI1NiBjaXR5T3dlZCA9IHRvdGFsQ2l0eU93ZWQuc3ViKGNpdHlEYXRhW19pdGVtSWRdLndpdGhkcmF3bik7CiAgICAgICAgCiAgICBjaXR5RGF0YVtfaXRlbUlkXS53aXRoZHJhd24gKz0gY2l0eU93ZWQ7CiAgICBwYXlvdXRCYWxhbmNlc1tfb3duZXJdICs9IGNpdHlPd2VkOwogIH0KCiAgLyoqCiAgKiBAZGV2IE93bmVyIGNhbiB3aXRoZHJhdyB0aGVpciBhY2N1bXVsYXRlZCBwYXlvdXRzCiAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3Mgb2YgdG9rZW4gb3duZXIKICAqLwogIGZ1bmN0aW9uIHdpdGhkcmF3UmVudChhZGRyZXNzIF9vd25lcikgcHVibGljIHsKICAgICAgdXBkYXRlUGF5b3V0KF9vd25lcik7CiAgICAgIHVpbnQyNTYgcGF5b3V0ID0gcGF5b3V0QmFsYW5jZXNbX293bmVyXTsKICAgICAgcGF5b3V0QmFsYW5jZXNbX293bmVyXSA9IDA7CiAgICAgIF9vd25lci50cmFuc2ZlcihwYXlvdXQpOwogIH0KCiAgZnVuY3Rpb24gZ2V0UmVudE93ZWQoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgb3dlZCkgewogICAgdXBkYXRlUGF5b3V0KF9vd25lcik7CiAgICByZXR1cm4gcGF5b3V0QmFsYW5jZXNbX293bmVyXTsKICB9CgogIC8qKgogICogQGRldiBSZXR1cm4gYWxsIGNpdHkgZGF0YQogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgb2YgdG9rZW4KICAqLwogIGZ1bmN0aW9uIGdldENpdHlEYXRhICh1aW50MjU2IF90b2tlbklkKSBleHRlcm5hbCB2aWV3IAogIHJldHVybnMgKGFkZHJlc3MgX293bmVyLCB1aW50MjU2IF9wcmljZSwgdWludDI1NiBfbmV4dFByaWNlLCB1aW50MjU2IF9wYXlvdXQsIGFkZHJlc3MgX2NPd25lciwgdWludDI1NiBfY1ByaWNlLCB1aW50MjU2IF9jUGF5b3V0KSAKICB7CiAgICBDaXR5IG1lbW9yeSBjaXR5ID0gY2l0eURhdGFbX3Rva2VuSWRdOwogICAgYWRkcmVzcyBjb3VudHJ5T3duZXI7CiAgICB1aW50MjU2IGNvdW50cnlQcmljZTsKICAgIHVpbnQyNTYgY291bnRyeVBheW91dDsKICAgIChjb3VudHJ5T3duZXIsLGNvdW50cnlQcmljZSwsY291bnRyeVBheW91dCkgPSBjb3VudHJ5Q29udHJhY3QuZ2V0Q291bnRyeURhdGEoX3Rva2VuSWQgJSBDT1VOVFJZX0lEWCk7CiAgICByZXR1cm4gKGNpdHkub3duZXIsIGNpdHkucHJpY2UsIGdldE5leHRQcmljZShjaXR5LnByaWNlKSwgY2l0eS5wYXlvdXQsIGNvdW50cnlPd25lciwgY291bnRyeVByaWNlLCBjb3VudHJ5UGF5b3V0KTsKICB9CgogIC8qKgogICogQGRldiBEZXRlcm1pbmVzIGlmIHRva2VuIGV4aXN0cyBieSBjaGVja2luZyBpdCdzIHByaWNlCiAgKiBAcGFyYW0gX3Rva2VuSWQgdWludDI1NiBJRCBvZiB0b2tlbgogICovCiAgZnVuY3Rpb24gdG9rZW5FeGlzdHMgKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wgX2V4aXN0cykgewogICAgcmV0dXJuIGNpdHlEYXRhW190b2tlbklkXS5wcmljZSA+IDA7CiAgfQoKICAvKioKICAqIEBkZXYgR3VhcmFudGVlcyBtc2cuc2VuZGVyIGlzIG93bmVyIG9mIHRoZSBnaXZlbiB0b2tlbgogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIHZhbGlkYXRlIGl0cyBvd25lcnNoaXAgYmVsb25ncyB0byBtc2cuc2VuZGVyCiAgKi8KICBtb2RpZmllciBvbmx5T3duZXJPZih1aW50MjU2IF90b2tlbklkKSB7CiAgICByZXF1aXJlKG93bmVyT2YoX3Rva2VuSWQpID09IG1zZy5zZW5kZXIpOwogICAgXzsKICB9CgogIC8qKgogICogQGRldiBHdWFyYW50ZWVzIG1zZy5zZW5kZXIgaXMgbm90IGEgY29udHJhY3QKICAqIEBwYXJhbSBfYnV5ZXIgYWRkcmVzcyBvZiBwZXJzb24gYnV5aW5nIGNpdHkKICAqLwogIG1vZGlmaWVyIGlzTm90Q29udHJhY3QoYWRkcmVzcyBfYnV5ZXIpIHsKICAgIHVpbnQgc2l6ZTsKICAgIGFzc2VtYmx5IHsgc2l6ZSA6PSBleHRjb2Rlc2l6ZShfYnV5ZXIpIH0KICAgIHJlcXVpcmUoc2l6ZSA9PSAwKTsKICAgIF87CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgdG90YWwgYW1vdW50IG9mIHRva2VucyBzdG9yZWQgYnkgdGhlIGNvbnRyYWN0CiAgKiBAcmV0dXJuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSB0b3RhbCBhbW91bnQgb2YgdG9rZW5zCiAgKi8KICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiB0b3RhbFRva2VuczsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF9vd25lciBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSBiYWxhbmNlIG9mCiAgKiBAcmV0dXJuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzCiAgKi8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBvd25lZFRva2Vuc1tfb3duZXJdLmxlbmd0aDsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBsaXN0IG9mIHRva2VucyBvd25lZCBieSBhIGdpdmVuIGFkZHJlc3MKICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyB0byBxdWVyeSB0aGUgdG9rZW5zIG9mCiAgKiBAcmV0dXJuIHVpbnQyNTZbXSByZXByZXNlbnRpbmcgdGhlIGxpc3Qgb2YgdG9rZW5zIG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcwogICovCiAgZnVuY3Rpb24gdG9rZW5zT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTZbXSkgewogICAgcmV0dXJuIG93bmVkVG9rZW5zW19vd25lcl07CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgb3duZXIgb2YgdGhlIHNwZWNpZmllZCB0b2tlbiBJRAogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIHF1ZXJ5IHRoZSBvd25lciBvZgogICogQHJldHVybiBvd25lciBhZGRyZXNzIGN1cnJlbnRseSBtYXJrZWQgYXMgdGhlIG93bmVyIG9mIHRoZSBnaXZlbiB0b2tlbiBJRAogICovCiAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICBhZGRyZXNzIG93bmVyID0gdG9rZW5Pd25lcltfdG9rZW5JZF07CiAgICByZXF1aXJlKG93bmVyICE9IGFkZHJlc3MoMCkpOwogICAgcmV0dXJuIG93bmVyOwogIH0KCiAgLyoqCiAgICogQGRldiBHZXRzIHRoZSBhcHByb3ZlZCBhZGRyZXNzIHRvIHRha2Ugb3duZXJzaGlwIG9mIGEgZ2l2ZW4gdG9rZW4gSUQKICAgKiBAcGFyYW0gX3Rva2VuSWQgdWludDI1NiBJRCBvZiB0aGUgdG9rZW4gdG8gcXVlcnkgdGhlIGFwcHJvdmFsIG9mCiAgICogQHJldHVybiBhZGRyZXNzIGN1cnJlbnRseSBhcHByb3ZlZCB0byB0YWtlIG93bmVyc2hpcCBvZiB0aGUgZ2l2ZW4gdG9rZW4gSUQKICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlZEZvcih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICByZXR1cm4gdG9rZW5BcHByb3ZhbHNbX3Rva2VuSWRdOwogIH0KCiAgLyoqCiAgKiBAZGV2IFRyYW5zZmVycyB0aGUgb3duZXJzaGlwIG9mIGEgZ2l2ZW4gdG9rZW4gSUQgdG8gYW5vdGhlciBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgdG8gcmVjZWl2ZSB0aGUgb3duZXJzaGlwIG9mIHRoZSBnaXZlbiB0b2tlbiBJRAogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIG9ubHlPd25lck9mKF90b2tlbklkKSB7CiAgICBjbGVhckFwcHJvdmFsQW5kVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdG9rZW5JZCk7CiAgfQoKICAvKioKICAqIEBkZXYgQXBwcm92ZXMgYW5vdGhlciBhZGRyZXNzIHRvIGNsYWltIGZvciB0aGUgb3duZXJzaGlwIG9mIHRoZSBnaXZlbiB0b2tlbiBJRAogICogQHBhcmFtIF90byBhZGRyZXNzIHRvIGJlIGFwcHJvdmVkIGZvciB0aGUgZ2l2ZW4gdG9rZW4gSUQKICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIHRoZSB0b2tlbiB0byBiZSBhcHByb3ZlZAogICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIG9ubHlPd25lck9mKF90b2tlbklkKSB7CiAgICBhZGRyZXNzIG93bmVyID0gb3duZXJPZihfdG9rZW5JZCk7CiAgICByZXF1aXJlKF90byAhPSBvd25lcik7CiAgICBpZiAoYXBwcm92ZWRGb3IoX3Rva2VuSWQpICE9IDAgfHwgX3RvICE9IDApIHsKICAgICAgdG9rZW5BcHByb3ZhbHNbX3Rva2VuSWRdID0gX3RvOwogICAgICBBcHByb3ZhbChvd25lciwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CiAgfQoKICAvKioKICAqIEBkZXYgQ2xhaW1zIHRoZSBvd25lcnNoaXAgb2YgYSBnaXZlbiB0b2tlbiBJRAogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIGJlaW5nIGNsYWltZWQgYnkgdGhlIG1zZy5zZW5kZXIKICAqLwogIGZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHsKICAgIHJlcXVpcmUoaXNBcHByb3ZlZEZvcihtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwogICAgY2xlYXJBcHByb3ZhbEFuZFRyYW5zZmVyKG93bmVyT2YoX3Rva2VuSWQpLCBtc2cuc2VuZGVyLCBfdG9rZW5JZCk7CiAgfQoKICAvKioKICAgKiBAZGV2IFRlbGxzIHdoZXRoZXIgdGhlIG1zZy5zZW5kZXIgaXMgYXBwcm92ZWQgZm9yIHRoZSBnaXZlbiB0b2tlbiBJRCBvciBub3QKICAgKiBUaGlzIGZ1bmN0aW9uIGlzIG5vdCBwcml2YXRlIHNvIGl0IGNhbiBiZSBleHRlbmRlZCBpbiBmdXJ0aGVyIGltcGxlbWVudGF0aW9ucyBsaWtlIHRoZSBvcGVyYXRhYmxlIEVSQzcyMQogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBvZiB0aGUgb3duZXIgdG8gcXVlcnkgdGhlIGFwcHJvdmFsIG9mCiAgICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIHF1ZXJ5IHRoZSBhcHByb3ZhbCBvZgogICAqIEByZXR1cm4gYm9vbCB3aGV0aGVyIHRoZSBtc2cuc2VuZGVyIGlzIGFwcHJvdmVkIGZvciB0aGUgZ2l2ZW4gdG9rZW4gSUQgb3Igbm90CiAgICovCiAgZnVuY3Rpb24gaXNBcHByb3ZlZEZvcihhZGRyZXNzIF9vd25lciwgdWludDI1NiBfdG9rZW5JZCkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gYXBwcm92ZWRGb3IoX3Rva2VuSWQpID09IF9vd25lcjsKICB9CiAgCiAgLyoqCiAgKiBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIGNsZWFyIGN1cnJlbnQgYXBwcm92YWwgYW5kIHRyYW5zZmVyIHRoZSBvd25lcnNoaXAgb2YgYSBnaXZlbiB0b2tlbiBJRAogICogQHBhcmFtIF9mcm9tIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICogQHBhcmFtIF90byBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRoZSB0b2tlbiB0bwogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkCiAgKi8KICBmdW5jdGlvbiBjbGVhckFwcHJvdmFsQW5kVHJhbnNmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIGludGVybmFsIGlzTm90Q29udHJhY3QoX3RvKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3RvICE9IG93bmVyT2YoX3Rva2VuSWQpKTsKICAgIHJlcXVpcmUob3duZXJPZihfdG9rZW5JZCkgPT0gX2Zyb20pOwoKICAgIGNsZWFyQXBwcm92YWwoX2Zyb20sIF90b2tlbklkKTsKICAgIHVwZGF0ZVNpbmdsZVBheW91dChfZnJvbSwgX3Rva2VuSWQpOwogICAgcmVtb3ZlVG9rZW4oX2Zyb20sIF90b2tlbklkKTsKICAgIGFkZFRva2VuKF90bywgX3Rva2VuSWQpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogIH0KCiAgLyoqCiAgKiBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIGNsZWFyIGN1cnJlbnQgYXBwcm92YWwgb2YgYSBnaXZlbiB0b2tlbiBJRAogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkCiAgKi8KICBmdW5jdGlvbiBjbGVhckFwcHJvdmFsKGFkZHJlc3MgX293bmVyLCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHsKICAgIHJlcXVpcmUob3duZXJPZihfdG9rZW5JZCkgPT0gX293bmVyKTsKICAgIHRva2VuQXBwcm92YWxzW190b2tlbklkXSA9IDA7CiAgICBBcHByb3ZhbChfb3duZXIsIDAsIF90b2tlbklkKTsKICB9CgoKICAgIC8qKgogICogQGRldiBNaW50IHRva2VuIGZ1bmN0aW9uCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCBvd24gdGhlIG1pbnRlZCB0b2tlbgogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIGJlIG1pbnRlZCBieSB0aGUgbXNnLnNlbmRlcgogICovCiAgZnVuY3Rpb24gX21pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIGludGVybmFsIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgYWRkVG9rZW4oX3RvLCBfdG9rZW5JZCk7CiAgICBUcmFuc2ZlcigweDAsIF90bywgX3Rva2VuSWQpOwogIH0KCiAgLyoqCiAgKiBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIGFkZCBhIHRva2VuIElEIHRvIHRoZSBsaXN0IG9mIGEgZ2l2ZW4gYWRkcmVzcwogICogQHBhcmFtIF90byBhZGRyZXNzIHJlcHJlc2VudGluZyB0aGUgbmV3IG93bmVyIG9mIHRoZSBnaXZlbiB0b2tlbiBJRAogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIGJlIGFkZGVkIHRvIHRoZSB0b2tlbnMgbGlzdCBvZiB0aGUgZ2l2ZW4gYWRkcmVzcwogICovCiAgZnVuY3Rpb24gYWRkVG9rZW4oYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgewogICAgcmVxdWlyZSh0b2tlbk93bmVyW190b2tlbklkXSA9PSBhZGRyZXNzKDApKTsKICAgIHRva2VuT3duZXJbX3Rva2VuSWRdID0gX3RvOwogICAgY2l0eURhdGFbX3Rva2VuSWRdLm93bmVyID0gX3RvOwogICAgdWludDI1NiBsZW5ndGggPSBiYWxhbmNlT2YoX3RvKTsKICAgIG93bmVkVG9rZW5zW190b10ucHVzaChfdG9rZW5JZCk7CiAgICBvd25lZFRva2Vuc0luZGV4W190b2tlbklkXSA9IGxlbmd0aDsKICAgIHRvdGFsVG9rZW5zID0gdG90YWxUb2tlbnMuYWRkKDEpOwogIH0KCiAgLyoqCiAgKiBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIHJlbW92ZSBhIHRva2VuIElEIGZyb20gdGhlIGxpc3Qgb2YgYSBnaXZlbiBhZGRyZXNzCiAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyByZXByZXNlbnRpbmcgdGhlIHByZXZpb3VzIG93bmVyIG9mIHRoZSBnaXZlbiB0b2tlbiBJRAogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIGJlIHJlbW92ZWQgZnJvbSB0aGUgdG9rZW5zIGxpc3Qgb2YgdGhlIGdpdmVuIGFkZHJlc3MKICAqLwogIGZ1bmN0aW9uIHJlbW92ZVRva2VuKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgewogICAgcmVxdWlyZShvd25lck9mKF90b2tlbklkKSA9PSBfZnJvbSk7CgogICAgdWludDI1NiB0b2tlbkluZGV4ID0gb3duZWRUb2tlbnNJbmRleFtfdG9rZW5JZF07CiAgICB1aW50MjU2IGxhc3RUb2tlbkluZGV4ID0gYmFsYW5jZU9mKF9mcm9tKS5zdWIoMSk7CiAgICB1aW50MjU2IGxhc3RUb2tlbiA9IG93bmVkVG9rZW5zW19mcm9tXVtsYXN0VG9rZW5JbmRleF07CgogICAgdG9rZW5Pd25lcltfdG9rZW5JZF0gPSAwOwogICAgb3duZWRUb2tlbnNbX2Zyb21dW3Rva2VuSW5kZXhdID0gbGFzdFRva2VuOwogICAgb3duZWRUb2tlbnNbX2Zyb21dW2xhc3RUb2tlbkluZGV4XSA9IDA7CiAgICAvLyBOb3RlIHRoYXQgdGhpcyB3aWxsIGhhbmRsZSBzaW5nbGUtZWxlbWVudCBhcnJheXMuIEluIHRoYXQgY2FzZSwgYm90aCB0b2tlbkluZGV4IGFuZCBsYXN0VG9rZW5JbmRleCBhcmUgZ29pbmcgdG8KICAgIC8vIGJlIHplcm8uIFRoZW4gd2UgY2FuIG1ha2Ugc3VyZSB0aGF0IHdlIHdpbGwgcmVtb3ZlIF90b2tlbklkIGZyb20gdGhlIG93bmVkVG9rZW5zIGxpc3Qgc2luY2Ugd2UgYXJlIGZpcnN0IHN3YXBwaW5nCiAgICAvLyB0aGUgbGFzdFRva2VuIHRvIHRoZSBmaXJzdCBwb3NpdGlvbiwgYW5kIHRoZW4gZHJvcHBpbmcgdGhlIGVsZW1lbnQgcGxhY2VkIGluIHRoZSBsYXN0IHBvc2l0aW9uIG9mIHRoZSBsaXN0CgogICAgb3duZWRUb2tlbnNbX2Zyb21dLmxlbmd0aC0tOwogICAgb3duZWRUb2tlbnNJbmRleFtfdG9rZW5JZF0gPSAwOwogICAgb3duZWRUb2tlbnNJbmRleFtsYXN0VG9rZW5dID0gdG9rZW5JbmRleDsKICAgIHRvdGFsVG9rZW5zID0gdG90YWxUb2tlbnMuc3ViKDEpOwogIH0KCiAgZnVuY3Rpb24gbmFtZSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKHN0cmluZyBfbmFtZSkgewogICAgcmV0dXJuICJFdGhlckNpdGllcy5pbyBDaXR5IjsKICB9CgogIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyBwdXJlIHJldHVybnMgKHN0cmluZyBfc3ltYm9sKSB7CiAgICByZXR1cm4gIkVDIjsKICB9Cgp9'.
	

]
