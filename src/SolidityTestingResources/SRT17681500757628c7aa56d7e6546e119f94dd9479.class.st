Class {
	#name : #SRT17681500757628c7aa56d7e6546e119f94dd9479,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT17681500757628c7aa56d7e6546e119f94dd9479 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7Cgpjb250cmFjdCBSZWVudHJhbmN5R3VhcmQgewoKICAvKioKICAgKiBAZGV2IFdlIHVzZSBhIHNpbmdsZSBsb2NrIGZvciB0aGUgd2hvbGUgY29udHJhY3QuCiAgICovCiAgYm9vbCBwcml2YXRlIHJlbnRyYW5jeV9sb2NrID0gZmFsc2U7CgogIC8qKgogICAqIEBkZXYgUHJldmVudHMgYSBjb250cmFjdCBmcm9tIGNhbGxpbmcgaXRzZWxmLCBkaXJlY3RseSBvciBpbmRpcmVjdGx5LgogICAqIEBub3RpY2UgSWYgeW91IG1hcmsgYSBmdW5jdGlvbiBgbm9uUmVlbnRyYW50YCwgeW91IHNob3VsZCBhbHNvCiAgICogbWFyayBpdCBgZXh0ZXJuYWxgLiBDYWxsaW5nIG9uZSBub25SZWVudHJhbnQgZnVuY3Rpb24gZnJvbQogICAqIGFub3RoZXIgaXMgbm90IHN1cHBvcnRlZC4gSW5zdGVhZCwgeW91IGNhbiBpbXBsZW1lbnQgYQogICAqIGBwcml2YXRlYCBmdW5jdGlvbiBkb2luZyB0aGUgYWN0dWFsIHdvcmssIGFuZCBhIGBleHRlcm5hbGAKICAgKiB3cmFwcGVyIG1hcmtlZCBhcyBgbm9uUmVlbnRyYW50YC4KICAgKi8KICBtb2RpZmllciBub25SZWVudHJhbnQoKSB7CiAgICByZXF1aXJlKCFyZW50cmFuY3lfbG9jayk7CiAgICByZW50cmFuY3lfbG9jayA9IHRydWU7CiAgICBfOwogICAgcmVudHJhbmN5X2xvY2sgPSBmYWxzZTsKICB9Cgp9CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCmNvbnRyYWN0IENsYWltYWJsZSBpcyBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBwZW5kaW5nT3duZXI7CgogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBwZW5kaW5nT3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seVBlbmRpbmdPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBwZW5kaW5nT3duZXIpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHNldCB0aGUgcGVuZGluZ093bmVyIGFkZHJlc3MuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHBlbmRpbmdPd25lciA9IG5ld093bmVyOwogIH0KCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIHBlbmRpbmdPd25lciBhZGRyZXNzIHRvIGZpbmFsaXplIHRoZSB0cmFuc2Zlci4KICAgKi8KICBmdW5jdGlvbiBjbGFpbU93bmVyc2hpcCgpIG9ubHlQZW5kaW5nT3duZXIgcHVibGljIHsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBwZW5kaW5nT3duZXIpOwogICAgb3duZXIgPSBwZW5kaW5nT3duZXI7CiAgICBwZW5kaW5nT3duZXIgPSAweDA7CiAgfQp9Cgpjb250cmFjdCBIYXNOb0NvbnRyYWN0cyBpcyBPd25hYmxlIHsKCiAgLyoqCiAgICogQGRldiBSZWNsYWltIG93bmVyc2hpcCBvZiBPd25hYmxlIGNvbnRyYWN0cwogICAqIEBwYXJhbSBjb250cmFjdEFkZHIgVGhlIGFkZHJlc3Mgb2YgdGhlIE93bmFibGUgdG8gYmUgcmVjbGFpbWVkLgogICAqLwogIGZ1bmN0aW9uIHJlY2xhaW1Db250cmFjdChhZGRyZXNzIGNvbnRyYWN0QWRkcikgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIE93bmFibGUgY29udHJhY3RJbnN0ID0gT3duYWJsZShjb250cmFjdEFkZHIpOwogICAgY29udHJhY3RJbnN0LnRyYW5zZmVyT3duZXJzaGlwKG93bmVyKTsKICB9Cn0KCmNvbnRyYWN0IEhhc05vRXRoZXIgaXMgT3duYWJsZSB7CgogIC8qKgogICogQGRldiBDb25zdHJ1Y3RvciB0aGF0IHJlamVjdHMgaW5jb21pbmcgRXRoZXIKICAqIEBkZXYgVGhlIGBwYXlhYmxlYCBmbGFnIGlzIGFkZGVkIHNvIHdlIGNhbiBhY2Nlc3MgYG1zZy52YWx1ZWAgd2l0aG91dCBjb21waWxlciB3YXJuaW5nLiBJZiB3ZQogICogbGVhdmUgb3V0IHBheWFibGUsIHRoZW4gU29saWRpdHkgd2lsbCBhbGxvdyBpbmhlcml0aW5nIGNvbnRyYWN0cyB0byBpbXBsZW1lbnQgYSBwYXlhYmxlCiAgKiBjb25zdHJ1Y3Rvci4gQnkgZG9pbmcgaXQgdGhpcyB3YXkgd2UgcHJldmVudCBhIHBheWFibGUgY29uc3RydWN0b3IgZnJvbSB3b3JraW5nLiBBbHRlcm5hdGl2ZWx5CiAgKiB3ZSBjb3VsZCB1c2UgYXNzZW1ibHkgdG8gYWNjZXNzIG1zZy52YWx1ZS4KICAqLwogIGZ1bmN0aW9uIEhhc05vRXRoZXIoKSBwYXlhYmxlIHsKICAgIHJlcXVpcmUobXNnLnZhbHVlID09IDApOwogIH0KCiAgLyoqCiAgICogQGRldiBEaXNhbGxvd3MgZGlyZWN0IHNlbmQgYnkgc2V0dGluZ3MgYSBkZWZhdWx0IGZ1bmN0aW9uIHdpdGhvdXQgdGhlIGBwYXlhYmxlYCBmbGFnLgogICAqLwogIGZ1bmN0aW9uKCkgZXh0ZXJuYWwgewogIH0KCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciBhbGwgRXRoZXIgaGVsZCBieSB0aGUgY29udHJhY3QgdG8gdGhlIG93bmVyLgogICAqLwogIGZ1bmN0aW9uIHJlY2xhaW1FdGhlcigpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICBhc3NlcnQob3duZXIuc2VuZCh0aGlzLmJhbGFuY2UpKTsKICB9Cn0KCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKfQoKY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgpsaWJyYXJ5IFNhZmVFUkMyMCB7CiAgZnVuY3Rpb24gc2FmZVRyYW5zZmVyKEVSQzIwQmFzaWMgdG9rZW4sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHsKICAgIGFzc2VydCh0b2tlbi50cmFuc2Zlcih0bywgdmFsdWUpKTsKICB9CgogIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlckZyb20oRVJDMjAgdG9rZW4sIGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgaW50ZXJuYWwgewogICAgYXNzZXJ0KHRva2VuLnRyYW5zZmVyRnJvbShmcm9tLCB0bywgdmFsdWUpKTsKICB9CgogIGZ1bmN0aW9uIHNhZmVBcHByb3ZlKEVSQzIwIHRva2VuLCBhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHsKICAgIGFzc2VydCh0b2tlbi5hcHByb3ZlKHNwZW5kZXIsIHZhbHVlKSk7CiAgfQp9Cgpjb250cmFjdCBDYW5SZWNsYWltVG9rZW4gaXMgT3duYWJsZSB7CiAgdXNpbmcgU2FmZUVSQzIwIGZvciBFUkMyMEJhc2ljOwoKICAvKioKICAgKiBAZGV2IFJlY2xhaW0gYWxsIEVSQzIwQmFzaWMgY29tcGF0aWJsZSB0b2tlbnMKICAgKiBAcGFyYW0gdG9rZW4gRVJDMjBCYXNpYyBUaGUgYWRkcmVzcyBvZiB0aGUgdG9rZW4gY29udHJhY3QKICAgKi8KICBmdW5jdGlvbiByZWNsYWltVG9rZW4oRVJDMjBCYXNpYyB0b2tlbikgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIHVpbnQyNTYgYmFsYW5jZSA9IHRva2VuLmJhbGFuY2VPZih0aGlzKTsKICAgIHRva2VuLnNhZmVUcmFuc2Zlcihvd25lciwgYmFsYW5jZSk7CiAgfQoKfQoKY29udHJhY3QgSGFzTm9Ub2tlbnMgaXMgQ2FuUmVjbGFpbVRva2VuIHsKCiAvKioKICAqIEBkZXYgUmVqZWN0IGFsbCBFUkMyMyBjb21wYXRpYmxlIHRva2VucwogICogQHBhcmFtIGZyb21fIGFkZHJlc3MgVGhlIGFkZHJlc3MgdGhhdCBpcyB0cmFuc2ZlcnJpbmcgdGhlIHRva2VucwogICogQHBhcmFtIHZhbHVlXyB1aW50MjU2IHRoZSBhbW91bnQgb2YgdGhlIHNwZWNpZmllZCB0b2tlbgogICogQHBhcmFtIGRhdGFfIEJ5dGVzIFRoZSBkYXRhIHBhc3NlZCBmcm9tIHRoZSBjYWxsZXIuCiAgKi8KICBmdW5jdGlvbiB0b2tlbkZhbGxiYWNrKGFkZHJlc3MgZnJvbV8sIHVpbnQyNTYgdmFsdWVfLCBieXRlcyBkYXRhXykgZXh0ZXJuYWwgewogICAgcmV2ZXJ0KCk7CiAgfQoKfQoKY29udHJhY3QgTm9Pd25lciBpcyBIYXNOb0V0aGVyLCBIYXNOb1Rva2VucywgSGFzTm9Db250cmFjdHMgewp9Cgpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwoKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICB1aW50MjU2IF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKCiAgICAvLyBDaGVjayBpcyBub3QgbmVlZGVkIGJlY2F1c2Ugc3ViKF9hbGxvd2FuY2UsIF92YWx1ZSkgd2lsbCBhbHJlYWR5IHRocm93IGlmIHRoaXMgY29uZGl0aW9uIGlzIG5vdCBtZXQKICAgIC8vIHJlcXVpcmUgKF92YWx1ZSA8PSBfYWxsb3dhbmNlKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAqCiAgICogQmV3YXJlIHRoYXQgY2hhbmdpbmcgYW4gYWxsb3dhbmNlIHdpdGggdGhpcyBtZXRob2QgYnJpbmdzIHRoZSByaXNrIHRoYXQgc29tZW9uZSBtYXkgdXNlIGJvdGggdGhlIG9sZAogICAqIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZSB0cmFuc2FjdGlvbiBvcmRlcmluZy4gT25lIHBvc3NpYmxlIHNvbHV0aW9uIHRvIG1pdGlnYXRlIHRoaXMKICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KCiAgLyoqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgfSBlbHNlIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKfQoKY29udHJhY3QgTWludGFibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwogIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwoKICBib29sIHB1YmxpYyBtaW50aW5nRmluaXNoZWQgPSBmYWxzZTsKCgogIG1vZGlmaWVyIGNhbk1pbnQoKSB7CiAgICByZXF1aXJlKCFtaW50aW5nRmluaXNoZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gbWludCB0b2tlbnMKICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCByZWNlaXZlIHRoZSBtaW50ZWQgdG9rZW5zLgogICAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIG1pbnQuCiAgICogQHJldHVybiBBIGJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIG9ubHlPd25lciBjYW5NaW50IHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfYW1vdW50KTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfYW1vdW50KTsKICAgIE1pbnQoX3RvLCBfYW1vdW50KTsKICAgIFRyYW5zZmVyKDB4MCwgX3RvLCBfYW1vdW50KTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBzdG9wIG1pbnRpbmcgbmV3IHRva2Vucy4KICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBmaW5pc2hNaW50aW5nKCkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBtaW50aW5nRmluaXNoZWQgPSB0cnVlOwogICAgTWludEZpbmlzaGVkKCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCmNvbnRyYWN0IENhbXBhaWduIGlzIENsYWltYWJsZSwgSGFzTm9Ub2tlbnMsIFJlZW50cmFuY3lHdWFyZCB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICBzdHJpbmcgY29uc3RhbnQgcHVibGljIHZlcnNpb24gPSAiMS4wLjAiOwoKICAgIHN0cmluZyBwdWJsaWMgaWQ7CgogICAgc3RyaW5nIHB1YmxpYyBuYW1lOwoKICAgIHN0cmluZyBwdWJsaWMgd2Vic2l0ZTsKCiAgICBieXRlczMyIHB1YmxpYyB3aGl0ZVBhcGVySGFzaDsKCiAgICB1aW50MjU2IHB1YmxpYyBmdW5kaW5nVGhyZXNob2xkOwoKICAgIHVpbnQyNTYgcHVibGljIGZ1bmRpbmdHb2FsOwoKICAgIHVpbnQyNTYgcHVibGljIHRva2VuUHJpY2U7CgogICAgZW51bSBUaW1lTW9kZSB7CiAgICAgICAgQmxvY2ssCiAgICAgICAgVGltZXN0YW1wCiAgICB9CgogICAgVGltZU1vZGUgcHVibGljIHRpbWVNb2RlOwoKICAgIHVpbnQyNTYgcHVibGljIHN0YXJ0VGltZTsKCiAgICB1aW50MjU2IHB1YmxpYyBmaW5pc2hUaW1lOwoKICAgIGVudW0gQm9udXNNb2RlIHsKICAgICAgICBGbGF0LAogICAgICAgIEJsb2NrLAogICAgICAgIFRpbWVzdGFtcCwKICAgICAgICBBbW91bnRSYWlzZWQsCiAgICAgICAgQ29udHJpYnV0aW9uQW1vdW50CiAgICB9CgogICAgQm9udXNNb2RlIHB1YmxpYyBib251c01vZGU7CgogICAgdWludDI1NltdIHB1YmxpYyBib251c0xldmVsczsKCiAgICB1aW50MjU2W10gcHVibGljIGJvbnVzUmF0ZXM7IC8vIGNvZWZmaWNpZW50cyBpbiBldGhlcgoKICAgIGFkZHJlc3MgcHVibGljIGJlbmVmaWNpYXJ5OwoKICAgIHVpbnQyNTYgcHVibGljIGFtb3VudFJhaXNlZDsKCiAgICB1aW50MjU2IHB1YmxpYyBtaW5Db250cmlidXRpb247CgogICAgdWludDI1NiBwdWJsaWMgZWFybHlTdWNjZXNzVGltZXN0YW1wOwoKICAgIHVpbnQyNTYgcHVibGljIGVhcmx5U3VjY2Vzc0Jsb2NrOwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGNvbnRyaWJ1dGlvbnM7CgogICAgVG9rZW4gcHVibGljIHRva2VuOwoKICAgIGVudW0gU3RhZ2UgewogICAgICAgIEluaXQsCiAgICAgICAgUmVhZHksCiAgICAgICAgSW5Qcm9ncmVzcywKICAgICAgICBGYWlsdXJlLAogICAgICAgIFN1Y2Nlc3MKICAgIH0KCiAgICBmdW5jdGlvbiBzdGFnZSgpCiAgICBwdWJsaWMKICAgIGNvbnN0YW50CiAgICByZXR1cm5zIChTdGFnZSkKICAgIHsKICAgICAgICBpZiAodG9rZW4gPT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICByZXR1cm4gU3RhZ2UuSW5pdDsKICAgICAgICB9CgogICAgICAgIHZhciBfdGltZSA9IHRpbWVNb2RlID09IFRpbWVNb2RlLlRpbWVzdGFtcCA/IGJsb2NrLnRpbWVzdGFtcCA6IGJsb2NrLm51bWJlcjsKCiAgICAgICAgaWYgKF90aW1lIDwgc3RhcnRUaW1lKSB7CiAgICAgICAgICAgIHJldHVybiBTdGFnZS5SZWFkeTsKICAgICAgICB9CgogICAgICAgIGlmIChmaW5pc2hUaW1lIDw9IF90aW1lKSB7CiAgICAgICAgICAgIGlmIChhbW91bnRSYWlzZWQgPCBmdW5kaW5nVGhyZXNob2xkKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gU3RhZ2UuRmFpbHVyZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gU3RhZ2UuU3VjY2VzczsKICAgICAgICB9CgogICAgICAgIGlmIChmdW5kaW5nR29hbCA8PSBhbW91bnRSYWlzZWQpIHsKICAgICAgICAgICAgcmV0dXJuIFN0YWdlLlN1Y2Nlc3M7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gU3RhZ2UuSW5Qcm9ncmVzczsKICAgIH0KCiAgICBtb2RpZmllciBhdFN0YWdlKFN0YWdlIF9zdGFnZSkgewogICAgICAgIHJlcXVpcmUoc3RhZ2UoKSA9PSBfc3RhZ2UpOwogICAgICAgIF87CiAgICB9CgogICAgZXZlbnQgQ29udHJpYnV0aW9uKGFkZHJlc3Mgc2VuZGVyLCB1aW50MjU2IGFtb3VudCk7CgogICAgZXZlbnQgUmVmdW5kKGFkZHJlc3MgcmVjaXBpZW50LCB1aW50MjU2IGFtb3VudCk7CgogICAgZXZlbnQgUGF5b3V0KGFkZHJlc3MgcmVjaXBpZW50LCB1aW50MjU2IGFtb3VudCk7CgogICAgZXZlbnQgRWFybHlTdWNjZXNzKCk7CgogICAgZnVuY3Rpb24gQ2FtcGFpZ24oCiAgICAgICAgc3RyaW5nIF9pZCwKICAgICAgICBhZGRyZXNzIF9iZW5lZmljaWFyeSwKICAgICAgICBzdHJpbmcgX25hbWUsCiAgICAgICAgc3RyaW5nIF93ZWJzaXRlLAogICAgICAgIGJ5dGVzMzIgX3doaXRlUGFwZXJIYXNoCiAgICApCiAgICBwdWJsaWMKICAgIHsKICAgICAgICBpZCA9IF9pZDsKICAgICAgICBiZW5lZmljaWFyeSA9IF9iZW5lZmljaWFyeTsKICAgICAgICBuYW1lID0gX25hbWU7CiAgICAgICAgd2Vic2l0ZSA9IF93ZWJzaXRlOwogICAgICAgIHdoaXRlUGFwZXJIYXNoID0gX3doaXRlUGFwZXJIYXNoOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFBhcmFtcygKICAgICAgICAvLyBQYXJhbXMgYXJlIGNvbWJpbmVkIHRvIHRoZSBhcnJheSB0byBhdm9pZCB0aGUg4oCcU3RhY2sgdG9vIGRlZXDigJ0gZXJyb3IKICAgICAgICB1aW50MjU2W10gX2Z1bmRpbmdUaHJlc2hvbGRfZnVuZGluZ0dvYWxfdG9rZW5QcmljZV9zdGFydFRpbWVfZmluaXNoVGltZSwKICAgICAgICB1aW50OFtdIF90aW1lTW9kZV9ib251c01vZGUsCiAgICAgICAgdWludDI1NltdIF9ib251c0xldmVscywKICAgICAgICB1aW50MjU2W10gX2JvbnVzUmF0ZXMKICAgICkKICAgIHB1YmxpYwogICAgb25seU93bmVyCiAgICBhdFN0YWdlKFN0YWdlLkluaXQpCiAgICB7CiAgICAgICAgYXNzZXJ0KGZ1bmRpbmdHb2FsID09IDApOwoKICAgICAgICBmdW5kaW5nVGhyZXNob2xkID0gX2Z1bmRpbmdUaHJlc2hvbGRfZnVuZGluZ0dvYWxfdG9rZW5QcmljZV9zdGFydFRpbWVfZmluaXNoVGltZVswXTsKICAgICAgICBmdW5kaW5nR29hbCA9IF9mdW5kaW5nVGhyZXNob2xkX2Z1bmRpbmdHb2FsX3Rva2VuUHJpY2Vfc3RhcnRUaW1lX2ZpbmlzaFRpbWVbMV07CiAgICAgICAgdG9rZW5QcmljZSA9IF9mdW5kaW5nVGhyZXNob2xkX2Z1bmRpbmdHb2FsX3Rva2VuUHJpY2Vfc3RhcnRUaW1lX2ZpbmlzaFRpbWVbMl07CiAgICAgICAgdGltZU1vZGUgPSBUaW1lTW9kZShfdGltZU1vZGVfYm9udXNNb2RlWzBdKTsKICAgICAgICBzdGFydFRpbWUgPSBfZnVuZGluZ1RocmVzaG9sZF9mdW5kaW5nR29hbF90b2tlblByaWNlX3N0YXJ0VGltZV9maW5pc2hUaW1lWzNdOwogICAgICAgIGZpbmlzaFRpbWUgPSBfZnVuZGluZ1RocmVzaG9sZF9mdW5kaW5nR29hbF90b2tlblByaWNlX3N0YXJ0VGltZV9maW5pc2hUaW1lWzRdOwogICAgICAgIGJvbnVzTW9kZSA9IEJvbnVzTW9kZShfdGltZU1vZGVfYm9udXNNb2RlWzFdKTsKICAgICAgICBib251c0xldmVscyA9IF9ib251c0xldmVsczsKICAgICAgICBib251c1JhdGVzID0gX2JvbnVzUmF0ZXM7CgogICAgICAgIHJlcXVpcmUoZnVuZGluZ1RocmVzaG9sZCA+IDApOwogICAgICAgIHJlcXVpcmUoZnVuZGluZ1RocmVzaG9sZCA8PSBmdW5kaW5nR29hbCk7CiAgICAgICAgcmVxdWlyZShzdGFydFRpbWUgPCBmaW5pc2hUaW1lKTsKICAgICAgICByZXF1aXJlKCh0aW1lTW9kZSA9PSBUaW1lTW9kZS5CbG9jayA/IGJsb2NrLm51bWJlciA6IGJsb2NrLnRpbWVzdGFtcCkgPCBzdGFydFRpbWUpOwogICAgICAgIHJlcXVpcmUoYm9udXNMZXZlbHMubGVuZ3RoID09IGJvbnVzUmF0ZXMubGVuZ3RoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjcmVhdGVUb2tlbigKICAgICAgICBzdHJpbmcgX3Rva2VuTmFtZSwKICAgICAgICBzdHJpbmcgX3Rva2VuU3ltYm9sLAogICAgICAgIHVpbnQ4IF90b2tlbkRlY2ltYWxzLAogICAgICAgIGFkZHJlc3NbXSBfZGlzdHJpYnV0aW9uUmVjaXBpZW50cywKICAgICAgICB1aW50MjU2W10gX2Rpc3RyaWJ1dGlvbkFtb3VudHMsCiAgICAgICAgdWludDI1NltdIF9yZWxlYXNlVGltZXMKICAgICkKICAgIHB1YmxpYwogICAgb25seU93bmVyCiAgICBhdFN0YWdlKFN0YWdlLkluaXQpCiAgICB7CiAgICAgICAgYXNzZXJ0KGZ1bmRpbmdHb2FsID4gMCk7CgogICAgICAgIHRva2VuID0gbmV3IFRva2VuKAogICAgICAgIF90b2tlbk5hbWUsCiAgICAgICAgX3Rva2VuU3ltYm9sLAogICAgICAgIF90b2tlbkRlY2ltYWxzLAogICAgICAgIF9kaXN0cmlidXRpb25SZWNpcGllbnRzLAogICAgICAgIF9kaXN0cmlidXRpb25BbW91bnRzLAogICAgICAgIF9yZWxlYXNlVGltZXMsCiAgICAgICAgdWludDgodGltZU1vZGUpCiAgICAgICAgKTsKCiAgICAgICAgbWluQ29udHJpYnV0aW9uID0gdG9rZW5QcmljZS5kaXYoMTAgKiogdWludDI1Nih0b2tlbi5kZWNpbWFscygpKSk7CiAgICAgICAgaWYgKG1pbkNvbnRyaWJ1dGlvbiA8IDEgd2VpKSB7CiAgICAgICAgICAgIG1pbkNvbnRyaWJ1dGlvbiA9IDEgd2VpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbigpCiAgICBwdWJsaWMKICAgIHBheWFibGUKICAgIGF0U3RhZ2UoU3RhZ2UuSW5Qcm9ncmVzcykKICAgIHsKICAgICAgICByZXF1aXJlKG1pbkNvbnRyaWJ1dGlvbiA8PSBtc2cudmFsdWUpOwoKICAgICAgICBjb250cmlidXRpb25zW21zZy5zZW5kZXJdID0gY29udHJpYnV0aW9uc1ttc2cuc2VuZGVyXS5hZGQobXNnLnZhbHVlKTsKCiAgICAgICAgLy8gQ2FsY3VsYXRlIGJvbnVzCiAgICAgICAgdWludDI1NiBfbGV2ZWw7CiAgICAgICAgdWludDI1NiBfdG9rZW5zQW1vdW50OwogICAgICAgIHVpbnQgaTsKICAgICAgICBpZiAoYm9udXNNb2RlID09IEJvbnVzTW9kZS5BbW91bnRSYWlzZWQpIHsKICAgICAgICAgICAgX2xldmVsID0gYW1vdW50UmFpc2VkOwogICAgICAgICAgICB1aW50MjU2IF92YWx1ZSA9IG1zZy52YWx1ZTsKICAgICAgICAgICAgdWludDI1NiBfd2VpZ2h0ZWRSYXRlU3VtID0gMDsKICAgICAgICAgICAgdWludDI1NiBfc3RlcEFtb3VudDsKICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGJvbnVzTGV2ZWxzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoX2xldmVsIDw9IGJvbnVzTGV2ZWxzW2ldKSB7CiAgICAgICAgICAgICAgICAgICAgX3N0ZXBBbW91bnQgPSBib251c0xldmVsc1tpXS5zdWIoX2xldmVsKTsKICAgICAgICAgICAgICAgICAgICBpZiAoX3ZhbHVlIDw9IF9zdGVwQW1vdW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIF9sZXZlbCA9IF9sZXZlbC5hZGQoX3ZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgX3dlaWdodGVkUmF0ZVN1bSA9IF93ZWlnaHRlZFJhdGVTdW0uYWRkKF92YWx1ZS5tdWwoYm9udXNSYXRlc1tpXSkpOwogICAgICAgICAgICAgICAgICAgICAgICBfdmFsdWUgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBfbGV2ZWwgPSBfbGV2ZWwuYWRkKF9zdGVwQW1vdW50KTsKICAgICAgICAgICAgICAgICAgICAgICAgX3dlaWdodGVkUmF0ZVN1bSA9IF93ZWlnaHRlZFJhdGVTdW0uYWRkKF9zdGVwQW1vdW50Lm11bChib251c1JhdGVzW2ldKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIF92YWx1ZSA9IF92YWx1ZS5zdWIoX3N0ZXBBbW91bnQpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBfd2VpZ2h0ZWRSYXRlU3VtID0gX3dlaWdodGVkUmF0ZVN1bS5hZGQoX3ZhbHVlLm11bCgxIGV0aGVyKSk7CgogICAgICAgICAgICBfdG9rZW5zQW1vdW50ID0gX3dlaWdodGVkUmF0ZVN1bS5kaXYoMSBldGhlcikubXVsKDEwICoqIHVpbnQyNTYodG9rZW4uZGVjaW1hbHMoKSkpLmRpdih0b2tlblByaWNlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfdG9rZW5zQW1vdW50ID0gbXNnLnZhbHVlLm11bCgxMCAqKiB1aW50MjU2KHRva2VuLmRlY2ltYWxzKCkpKS5kaXYodG9rZW5QcmljZSk7CgogICAgICAgICAgICBpZiAoYm9udXNNb2RlID09IEJvbnVzTW9kZS5CbG9jaykgewogICAgICAgICAgICAgICAgX2xldmVsID0gYmxvY2subnVtYmVyOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChib251c01vZGUgPT0gQm9udXNNb2RlLlRpbWVzdGFtcCkgewogICAgICAgICAgICAgICAgX2xldmVsID0gYmxvY2sudGltZXN0YW1wOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChib251c01vZGUgPT0gQm9udXNNb2RlLkNvbnRyaWJ1dGlvbkFtb3VudCkgewogICAgICAgICAgICAgICAgX2xldmVsID0gbXNnLnZhbHVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgYm9udXNMZXZlbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmIChfbGV2ZWwgPD0gYm9udXNMZXZlbHNbaV0pIHsKICAgICAgICAgICAgICAgICAgICBfdG9rZW5zQW1vdW50ID0gX3Rva2Vuc0Ftb3VudC5tdWwoYm9udXNSYXRlc1tpXSkuZGl2KDEgZXRoZXIpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBhbW91bnRSYWlzZWQgPSBhbW91bnRSYWlzZWQuYWRkKG1zZy52YWx1ZSk7CgogICAgICAgIC8vIFdlIGRvbuKAmXQgd2FudCBtb3JlIHRoYW4gdGhlIGZ1bmRpbmcgZ29hbAogICAgICAgIHJlcXVpcmUoYW1vdW50UmFpc2VkIDw9IGZ1bmRpbmdHb2FsKTsKCiAgICAgICAgcmVxdWlyZSh0b2tlbi5taW50KG1zZy5zZW5kZXIsIF90b2tlbnNBbW91bnQpKTsKCiAgICAgICAgQ29udHJpYnV0aW9uKG1zZy5zZW5kZXIsIG1zZy52YWx1ZSk7CgogICAgICAgIGlmIChmdW5kaW5nR29hbCA8PSBhbW91bnRSYWlzZWQpIHsKICAgICAgICAgICAgZWFybHlTdWNjZXNzVGltZXN0YW1wID0gYmxvY2sudGltZXN0YW1wOwogICAgICAgICAgICBlYXJseVN1Y2Nlc3NCbG9jayA9IGJsb2NrLm51bWJlcjsKICAgICAgICAgICAgdG9rZW4uZmluaXNoTWludGluZygpOwogICAgICAgICAgICBFYXJseVN1Y2Nlc3MoKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gd2l0aGRyYXdQYXlvdXQoKQogICAgcHVibGljCiAgICBhdFN0YWdlKFN0YWdlLlN1Y2Nlc3MpCiAgICB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGJlbmVmaWNpYXJ5KTsKCiAgICAgICAgaWYgKCF0b2tlbi5taW50aW5nRmluaXNoZWQoKSkgewogICAgICAgICAgICB0b2tlbi5maW5pc2hNaW50aW5nKCk7CiAgICAgICAgfQoKICAgICAgICB2YXIgX2Ftb3VudCA9IHRoaXMuYmFsYW5jZTsKICAgICAgICByZXF1aXJlKGJlbmVmaWNpYXJ5LmNhbGwudmFsdWUoX2Ftb3VudCkoKSk7CiAgICAgICAgUGF5b3V0KGJlbmVmaWNpYXJ5LCBfYW1vdW50KTsKICAgIH0KCiAgICAvLyBBbnlvbmUgY2FuIG1ha2UgdG9rZW5zIGF2YWlsYWJsZSB3aGVuIHRoZSBjYW1wYWlnbiBpcyBzdWNjZXNzZnVsCiAgICBmdW5jdGlvbiByZWxlYXNlVG9rZW5zKCkKICAgIHB1YmxpYwogICAgYXRTdGFnZShTdGFnZS5TdWNjZXNzKQogICAgewogICAgICAgIHJlcXVpcmUoIXRva2VuLm1pbnRpbmdGaW5pc2hlZCgpKTsKICAgICAgICB0b2tlbi5maW5pc2hNaW50aW5nKCk7CiAgICB9CgogICAgZnVuY3Rpb24gd2l0aGRyYXdSZWZ1bmQoKQogICAgcHVibGljCiAgICBhdFN0YWdlKFN0YWdlLkZhaWx1cmUpCiAgICBub25SZWVudHJhbnQKICAgIHsKICAgICAgICB2YXIgX2Ftb3VudCA9IGNvbnRyaWJ1dGlvbnNbbXNnLnNlbmRlcl07CgogICAgICAgIHJlcXVpcmUoX2Ftb3VudCA+IDApOwoKICAgICAgICBjb250cmlidXRpb25zW21zZy5zZW5kZXJdID0gMDsKCiAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihfYW1vdW50KTsKICAgICAgICBSZWZ1bmQobXNnLnNlbmRlciwgX2Ftb3VudCk7CiAgICB9Cn0KCmNvbnRyYWN0IFRva2VuIGlzIE1pbnRhYmxlVG9rZW4sIE5vT3duZXIgewogICAgc3RyaW5nIGNvbnN0YW50IHB1YmxpYyB2ZXJzaW9uID0gIjEuMC4wIjsKCiAgICBzdHJpbmcgcHVibGljIG5hbWU7CgogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2w7CgogICAgdWludDggcHVibGljIGRlY2ltYWxzOwoKICAgIGVudW0gVGltZU1vZGUgewogICAgICAgIEJsb2NrLAogICAgICAgIFRpbWVzdGFtcAogICAgfQoKICAgIFRpbWVNb2RlIHB1YmxpYyB0aW1lTW9kZTsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyByZWxlYXNlVGltZXM7CgogICAgZnVuY3Rpb24gVG9rZW4oCiAgICAgICAgc3RyaW5nIF9uYW1lLAogICAgICAgIHN0cmluZyBfc3ltYm9sLAogICAgICAgIHVpbnQ4IF9kZWNpbWFscywKICAgICAgICBhZGRyZXNzW10gX3JlY2lwaWVudHMsCiAgICAgICAgdWludDI1NltdIF9hbW91bnRzLAogICAgICAgIHVpbnQyNTZbXSBfcmVsZWFzZVRpbWVzLAogICAgICAgIHVpbnQ4IF90aW1lTW9kZQogICAgKQogICAgcHVibGljCiAgICB7CiAgICAgICAgcmVxdWlyZShfcmVjaXBpZW50cy5sZW5ndGggPT0gX2Ftb3VudHMubGVuZ3RoKTsKICAgICAgICByZXF1aXJlKF9yZWNpcGllbnRzLmxlbmd0aCA9PSBfcmVsZWFzZVRpbWVzLmxlbmd0aCk7CgogICAgICAgIG5hbWUgPSBfbmFtZTsKICAgICAgICBzeW1ib2wgPSBfc3ltYm9sOwogICAgICAgIGRlY2ltYWxzID0gX2RlY2ltYWxzOwogICAgICAgIHRpbWVNb2RlID0gVGltZU1vZGUoX3RpbWVNb2RlKTsKCiAgICAgICAgLy8gTWludCBwcmUtZGlzdHJpYnV0ZWQgdG9rZW5zCiAgICAgICAgZm9yICh1aW50OCBpID0gMDsgaSA8IF9yZWNpcGllbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIG1pbnQoX3JlY2lwaWVudHNbaV0sIF9hbW91bnRzW2ldKTsKICAgICAgICAgICAgaWYgKF9yZWxlYXNlVGltZXNbaV0gPiAwKSB7CiAgICAgICAgICAgICAgICByZWxlYXNlVGltZXNbX3JlY2lwaWVudHNbaV1dID0gX3JlbGVhc2VUaW1lc1tpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpCiAgICBwdWJsaWMKICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgLy8gVHJhbnNmZXIgaXMgZm9yYmlkZGVuIHVudGlsIG1pbnRpbmcgaXMgZmluaXNoZWQKICAgICAgICByZXF1aXJlKG1pbnRpbmdGaW5pc2hlZCk7CgogICAgICAgIC8vIFRyYW5zZmVyIG9mIHRpbWUtbG9ja2VkIGZ1bmRzIGlzIGZvcmJpZGRlbgogICAgICAgIHJlcXVpcmUoIXRpbWVMb2NrZWQobXNnLnNlbmRlcikpOwoKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpCiAgICBwdWJsaWMKICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgLy8gVHJhbnNmZXIgaXMgZm9yYmlkZGVuIHVudGlsIG1pbnRpbmcgaXMgZmluaXNoZWQKICAgICAgICByZXF1aXJlKG1pbnRpbmdGaW5pc2hlZCk7CgogICAgICAgIC8vIFRyYW5zZmVyIG9mIHRpbWUtbG9ja2VkIGZ1bmRzIGlzIGZvcmJpZGRlbgogICAgICAgIHJlcXVpcmUoIXRpbWVMb2NrZWQoX2Zyb20pKTsKCiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIC8vIENoZWNrcyBpZiBmdW5kcyBvZiBhIGdpdmVuIGFkZHJlc3MgYXJlIHRpbWUtbG9ja2VkCiAgICBmdW5jdGlvbiB0aW1lTG9ja2VkKGFkZHJlc3MgX3NwZW5kZXIpCiAgICBwdWJsaWMKICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgaWYgKHJlbGVhc2VUaW1lc1tfc3BlbmRlcl0gPT0gMCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICAvLyBJZiB0aW1lLWxvY2sgaXMgZXhwaXJlZCwgZGVsZXRlIGl0CiAgICAgICAgdmFyIF90aW1lID0gdGltZU1vZGUgPT0gVGltZU1vZGUuVGltZXN0YW1wID8gYmxvY2sudGltZXN0YW1wIDogYmxvY2subnVtYmVyOwogICAgICAgIGlmIChyZWxlYXNlVGltZXNbX3NwZW5kZXJdIDw9IF90aW1lKSB7CiAgICAgICAgICAgIGRlbGV0ZSByZWxlYXNlVGltZXNbX3NwZW5kZXJdOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQ=='.
	

]
