Class {
	#name : #SRT8338005b31bf37dadea7f76a7778dcf9150d8f02,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT8338005b31bf37dadea7f76a7778dcf9150d8f02 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIFNlbmNUb2tlblNhbGUgLSBTRU5DIFRva2VuIFNhbGUgQ29udHJhY3QKLy8KLy8gQ29weXJpZ2h0IChjKSAyMDE4IEluZm9Db3JwIFRlY2hub2xvZ2llcyBQdGUgTHRkLgovLyBodHRwOi8vd3d3LnNlbnRpbmVsLWNoYWluLm9yZy8KLy8KLy8gVGhlIE1JVCBMaWNlbmNlLgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIFRoZSBTRU5DIFRva2VuIFNhbGUgaXMgb3JnYW5pc2VkIGFzIGZvbGxvd3M6Ci8vIDEuIDEwJSAoNTAsMDAwLDAwMCkgb2YgdG90YWwgc3VwcGx5IHdpbGwgYmUgbWludGVkIGFuZCBzZW50IHRvIGZvdW5kaW5nIHRlYW0gd2VhbGxldC4KLy8gMi4gMjAlICgxMDAsMDAwLDAwMCkgb2YgdG90YWwgc3VwcGx5IHdpbGwgYmUgbWludGVkIGFuZCBzZW50IHRvIGVhcmx5IHN1cHBvcnRlciB3YWxsZXQuCi8vIDMuIDIwJSAoMTAwLDAwMCwwMDApIG9mIHRvdGFsIHN1cHBseSB3aWxsIGJlIG1pbnRlZCBhbmQgc2VudCB0byBwcmVzYWxlIHdhbGxldC4KLy8gNC4gMjAlICgxMDAsMDAwLDAwMCkgb2YgdG90YWwgc3VwcGx5IHdpbGwgYmUgYXZhaWxhYmxlIGZvciBtaW50aW5nIGFuZCBwdXJjaGFzZSBieSBwdWJsaWMuCi8vIDUuIDMwJSAoMTUwLDAwMCwwMDApIG9mIHRvdGFsIHN1cHBseSB3aWxsIGJlIG1pbnRlZCBhbmQgc2VudCB0byB0cmVhdXJ5IHdhbGxldC4KLy8gNi4gUHVibGljIHNhbGUgaXMgZGVzaWduZWQgdG8gYmUgbWFkZSBhdmFpbGFibGUgaW4gYmF0Y2hlcy4KLy8gCi8vIFRva2VucyBjYW4gb25seSBiZSBwdXJjaGFzZWQgYnkgY29udHJpYnV0b3JzIGRlcGVuZGluZyBvbiB0aGUgYmF0Y2ggdGhhdAovLyBjb250cmlidXRvcnMgYXJlIGFzc2lnbmVkIHRvIGluIHRoZSBXaGl0ZUxpc3RlZCBzbWFydCBjb250cmFjdCB0byBwcmV2ZW50IGEKLy8gZ2FzIHdhci4gRWFjaCBiYXRjaCB3aWxsIGJlIGFzc2lnbmVkIGEgdGltZXN0YW1wLiBDb250cmlidXRvcnMgY2FuIG9ubHkgCi8vIG1ha2UgcHVyY2hhc2Ugb25jZSB0aGUgY3VycmVudCB0aW1lc3RhbXAgb24gdGhlIG1haW4gbmV0IGlzIGFib3ZlIHRoZSAKLy8gYmF0Y2gncyBhc3NpZ25lZCB0aW1lc3RhbXAuCi8vICAgIC0gYmF0Y2ggMDogc3RhcnRfZGF0ZSAwMDowMSAgIChndWFyYW50ZWVkIGFsbG9jYXRpb25zKQovLyAgICAtIGJhdGNoIDE6IHN0YXJ0X2RhdGUrMSAwMDowMSAoZ3VhcmFudGVlZCBhbGxvY2F0aW9ucykKLy8gICAgLSBiYXRjaCAyOiBzdGFydF9kYXRlKzIgMDA6MDEgKGd1YXJhbnRlZWQgYW5kIG5vbi1ndWFyYW50ZWVkIGFsbG9jYXRpb25zKQovLyAgICAtIGJhdGNoIDM6IHN0YXJ0X2RhdGUrMiAxMjowMSAoZ3VhcmFudGVlZCBhbmQgbm9uLWd1YXJhbnRlZWQgYWxsb2NhdGlvbnMpCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9Cgpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKICBldmVudCBQYXVzZSgpOwogIGV2ZW50IFVucGF1c2UoKTsKCiAgYm9vbCBwdWJsaWMgcGF1c2VkID0gZmFsc2U7CgogIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICByZXF1aXJlKCFwYXVzZWQpOwogICAgXzsKICB9CgogIG1vZGlmaWVyIHdoZW5QYXVzZWQoKSB7CiAgICByZXF1aXJlKHBhdXNlZCk7CiAgICBfOwogIH0KCiAgZnVuY3Rpb24gcGF1c2UoKSBvbmx5T3duZXIgd2hlbk5vdFBhdXNlZCBwdWJsaWMgewogICAgcGF1c2VkID0gdHJ1ZTsKICAgIFBhdXNlKCk7CiAgfQoKICBmdW5jdGlvbiB1bnBhdXNlKCkgb25seU93bmVyIHdoZW5QYXVzZWQgcHVibGljIHsKICAgIHBhdXNlZCA9IGZhbHNlOwogICAgVW5wYXVzZSgpOwogIH0KfQoKY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgdWludDI1NiB0b3RhbFN1cHBseV87CgogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIHRvdGFsU3VwcGx5XzsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW19mcm9tXSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSk7CgogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCmNvbnRyYWN0IFBhdXNhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgUGF1c2FibGUgewoKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gc3VwZXIuYXBwcm92ZShfc3BlbmRlciwgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICByZXR1cm4gc3VwZXIuaW5jcmVhc2VBcHByb3ZhbChfc3BlbmRlciwgX2FkZGVkVmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgcmV0dXJuIHN1cGVyLmRlY3JlYXNlQXBwcm92YWwoX3NwZW5kZXIsIF9zdWJ0cmFjdGVkVmFsdWUpOwogIH0KfQoKY29udHJhY3QgT3BlcmF0YWJsZUJhc2ljIHsKICAgIGZ1bmN0aW9uIHNldFByaW1hcnlPcGVyYXRvciAoYWRkcmVzcyBhZGRyKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBzZXRTZWNvbmRhcnlPcGVyYXRvciAoYWRkcmVzcyBhZGRyKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBpc1ByaW1hcnlPcGVyYXRvcihhZGRyZXNzIGFkZHIpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gaXNTZWNvbmRhcnlPcGVyYXRvcihhZGRyZXNzIGFkZHIpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwp9Cgpjb250cmFjdCBPcGVyYXRhYmxlIGlzIE93bmFibGUsIE9wZXJhdGFibGVCYXNpYyB7CiAgICBhZGRyZXNzIHB1YmxpYyBwcmltYXJ5T3BlcmF0b3I7CiAgICBhZGRyZXNzIHB1YmxpYyBzZWNvbmRhcnlPcGVyYXRvcjsKCiAgICBtb2RpZmllciBjYW5PcGVyYXRlKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBwcmltYXJ5T3BlcmF0b3IgfHwgbXNnLnNlbmRlciA9PSBzZWNvbmRhcnlPcGVyYXRvciB8fCBtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIE9wZXJhdGFibGUoKSBwdWJsaWMgewogICAgICAgIHByaW1hcnlPcGVyYXRvciA9IG93bmVyOwogICAgICAgIHNlY29uZGFyeU9wZXJhdG9yID0gb3duZXI7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0UHJpbWFyeU9wZXJhdG9yIChhZGRyZXNzIGFkZHIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHByaW1hcnlPcGVyYXRvciA9IGFkZHI7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0U2Vjb25kYXJ5T3BlcmF0b3IgKGFkZHJlc3MgYWRkcikgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgc2Vjb25kYXJ5T3BlcmF0b3IgPSBhZGRyOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzUHJpbWFyeU9wZXJhdG9yKGFkZHJlc3MgYWRkcikgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiAoYWRkciA9PSBwcmltYXJ5T3BlcmF0b3IpOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzU2Vjb25kYXJ5T3BlcmF0b3IoYWRkcmVzcyBhZGRyKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIChhZGRyID09IHNlY29uZGFyeU9wZXJhdG9yKTsKICAgIH0KfQoKY29udHJhY3QgU2FsdmFnZWFibGUgaXMgT3BlcmF0YWJsZSB7CiAgICAvLyBTYWx2YWdlIG90aGVyIHRva2VucyB0aGF0IGFyZSBhY2NpZGVudGFsbHkgc2VudCBpbnRvIHRoaXMgdG9rZW4KICAgIGZ1bmN0aW9uIGVtZXJnZW5jeUVSQzIwRHJhaW4oRVJDMjAgb2RkVG9rZW4sIHVpbnQgYW1vdW50KSBwdWJsaWMgY2FuT3BlcmF0ZSB7CiAgICAgICAgaWYgKGFkZHJlc3Mob2RkVG9rZW4pID09IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgb3duZXIudHJhbnNmZXIoYW1vdW50KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBvZGRUb2tlbi50cmFuc2Zlcihvd25lciwgYW1vdW50KTsKICAgIH0KfQoKY29udHJhY3QgV2hpdGVMaXN0ZWRCYXNpYyBpcyBPcGVyYXRhYmxlQmFzaWMgewogICAgZnVuY3Rpb24gYWRkV2hpdGVMaXN0ZWQoYWRkcmVzc1tdIGFkZHJzLCB1aW50W10gYmF0Y2hlcywgdWludFtdIHdlaUFsbG9jYXRpb24pIGV4dGVybmFsOwogICAgZnVuY3Rpb24gZ2V0QWxsb2NhdGVkKGFkZHJlc3MgYWRkcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludCk7CiAgICBmdW5jdGlvbiBnZXRCYXRjaE51bWJlcihhZGRyZXNzIGFkZHIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQpOwogICAgZnVuY3Rpb24gZ2V0V2hpdGVMaXN0Q291bnQoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KTsKICAgIGZ1bmN0aW9uIGlzV2hpdGVMaXN0ZWQoYWRkcmVzcyBhZGRyKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIHJlbW92ZVdoaXRlTGlzdGVkKGFkZHJlc3MgYWRkcikgcHVibGljOwogICAgZnVuY3Rpb24gc2V0QWxsb2NhdGlvbihhZGRyZXNzW10gYWRkcnMsIHVpbnRbXSBhbGxvY2F0aW9uKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBzZXRCYXRjaE51bWJlcihhZGRyZXNzW10gYWRkcnMsIHVpbnRbXSBiYXRjaCkgcHVibGljOwp9CgpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKCmNvbnRyYWN0IFNlbmNUb2tlbkNvbmZpZyB7CiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IE5BTUUgPSAiU2VudGluZWwgQ2hhaW4gVG9rZW4iOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBTWU1CT0wgPSAiU0VOQyI7CiAgICB1aW50OCBwdWJsaWMgY29uc3RhbnQgREVDSU1BTFMgPSAxODsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IERFQ0lNQUxTRkFDVE9SID0gMTAgKiogdWludChERUNJTUFMUyk7CiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBUT1RBTFNVUFBMWSA9IDUwMDAwMDAwMCAqIERFQ0lNQUxTRkFDVE9SOwp9Cgpjb250cmFjdCBTZW5jVG9rZW4gaXMgUGF1c2FibGVUb2tlbiwgU2VuY1Rva2VuQ29uZmlnLCBTYWx2YWdlYWJsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKCiAgICBzdHJpbmcgcHVibGljIG5hbWUgPSBOQU1FOwogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSBTWU1CT0w7CiAgICB1aW50OCBwdWJsaWMgZGVjaW1hbHMgPSBERUNJTUFMUzsKICAgIGJvb2wgcHVibGljIG1pbnRpbmdGaW5pc2hlZCA9IGZhbHNlOwoKICAgIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50IGFtb3VudCk7CiAgICBldmVudCBNaW50RmluaXNoZWQoKTsKCiAgICBtb2RpZmllciBjYW5NaW50KCkgewogICAgICAgIHJlcXVpcmUoIW1pbnRpbmdGaW5pc2hlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBTZW5jVG9rZW4oKSBwdWJsaWMgewogICAgICAgIHBhdXNlZCA9IHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gcGF1c2UoKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXZlcnQoKTsKICAgIH0KCiAgICBmdW5jdGlvbiB1bnBhdXNlKCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgc3VwZXIudW5wYXVzZSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfdG8sIHVpbnQgX2Ftb3VudCkgb25seU93bmVyIGNhbk1pbnQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKHRvdGFsU3VwcGx5Xy5hZGQoX2Ftb3VudCkgPD0gVE9UQUxTVVBQTFkpOwogICAgICAgIHRvdGFsU3VwcGx5XyA9IHRvdGFsU3VwcGx5Xy5hZGQoX2Ftb3VudCk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF9hbW91bnQpOwogICAgICAgIE1pbnQoX3RvLCBfYW1vdW50KTsKICAgICAgICBUcmFuc2ZlcihhZGRyZXNzKDApLCBfdG8sIF9hbW91bnQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIG1pbnRpbmdGaW5pc2hlZCA9IHRydWU7CiAgICAgICAgTWludEZpbmlzaGVkKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gQWlyZHJvcCB0b2tlbnMgZnJvbSBib3VudHkgd2FsbGV0IHRvIGNvbnRyaWJ1dG9ycyBhcyBsb25nIGFzIHRoZXJlIGFyZSBlbm91Z2ggYmFsYW5jZQogICAgZnVuY3Rpb24gYWlyZHJvcChhZGRyZXNzIGJvdW50eVdhbGxldCwgYWRkcmVzc1tdIGRlc3RzLCB1aW50W10gdmFsdWVzKSBwdWJsaWMgb25seU93bmVyIHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXF1aXJlKGRlc3RzLmxlbmd0aCA9PSB2YWx1ZXMubGVuZ3RoKTsKICAgICAgICB1aW50IGkgPSAwOwogICAgICAgIHdoaWxlIChpIDwgZGVzdHMubGVuZ3RoICYmIGJhbGFuY2VzW2JvdW50eVdhbGxldF0gPj0gdmFsdWVzW2ldKSB7CiAgICAgICAgICAgIHRoaXMudHJhbnNmZXJGcm9tKGJvdW50eVdhbGxldCwgZGVzdHNbaV0sIHZhbHVlc1tpXSk7CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuKGkpOwogICAgfQp9Cgpjb250cmFjdCBTZW5jVG9rZW5TYWxlQ29uZmlnIGlzIFNlbmNUb2tlbkNvbmZpZyB7CiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBUT0tFTl9GT1VORElOR1RFQU0gPSAgNTAwMDAwMDAgKiBERUNJTUFMU0ZBQ1RPUjsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFRPS0VOX0VBUkxZU1VQUE9SVEVSUyA9IDEwMDAwMDAwMCAqIERFQ0lNQUxTRkFDVE9SOwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgVE9LRU5fUFJFU0FMRSA9IDEwMDAwMDAwMCAqIERFQ0lNQUxTRkFDVE9SOwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgVE9LRU5fVFJFQVNVUlkgPSAxNTAwMDAwMDAgKiBERUNJTUFMU0ZBQ1RPUjsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IE1JTExJT04gPSAxMDAwMDAwOwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgUFVCTElDU0FMRV9VU0RfUEVSX01TRU5DID0gIDgwMDAwOwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgUFJJVkFURVNBTEVfVVNEX1BFUl9NU0VOQyA9ICA2NDAwMDsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IE1JTl9DT05UUklCVVRJT04gICAgICA9IDEyMCBmaW5uZXk7Cn0KCmNvbnRyYWN0IFNlbmNUb2tlblNhbGUgaXMgU2VuY1Rva2VuU2FsZUNvbmZpZywgT3duYWJsZSwgUGF1c2FibGUsIFNhbHZhZ2VhYmxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwogICAgYm9vbCBwdWJsaWMgaXNGaW5hbGl6ZWQgPSBmYWxzZTsKCiAgICBTZW5jVG9rZW4gcHVibGljIHRva2VuOwogICAgdWludFtdIHB1YmxpYyBiYXRjaFN0YXJ0VGltZXM7CiAgICB1aW50IHB1YmxpYyBlbmRUaW1lOwogICAgdWludCBwdWJsaWMgc3RhcnRUaW1lOwogICAgYWRkcmVzcyBwdWJsaWMgYWdUZWNoV2FsbGV0OyAgICAgICAgLy8gSW5mb0NvcnAgQWdUZWNoIFdhbGxldCBBZGRyZXNzIHRvIHJlY2VpdmUgRVRICiAgICB1aW50IHB1YmxpYyB1c2RQZXJNRXRoOyAgICAgICAgICAgICAvLyBVU0QgcGVyIG1pbGxpb24gRVRILiBFLmcuIEVUSFVTRCA4NDQuODEgaXMgc3BlY2lmaWVkIGFzIDg0NCw4MTAsMDAwCiAgICB1aW50IHB1YmxpYyBwdWJsaWNTYWxlU2VuY1Blck1FdGg7ICAvLyBBbW91bnQgb2YgdG9rZW4gMSBtaWxsaW9uIEVUSCBjYW4gYnV5IGluIHB1YmxpYyBzYWxlCiAgICB1aW50IHB1YmxpYyBwcml2YXRlU2FsZVNlbmNQZXJNRXRoOyAvLyBBbW91bnQgb2YgdG9rZW4gMSBtaWxsaW9uIEVUSCBjYW4gYnV5IGluIHByaXZhdGUgc2FsZQogICAgdWludCBwdWJsaWMgd2VpUmFpc2VkOyAgICAgICAgICAgICAgLy8gQW1vdW50IG9mIHJhaXNlZCBtb25leSBpbiBXRUkKICAgIFdoaXRlTGlzdGVkQmFzaWMgcHVibGljIHdoaXRlTGlzdGVkOwogICAgdWludCBwdWJsaWMgbnVtQ29udHJpYnV0b3JzOyAgICAgICAgLy8gRGlzY3JldGUgbnVtYmVyIG9mIGNvbnRyaWJ1dG9ycwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgcHVibGljIGNvbnRyaWJ1dGlvbnM7IC8vIHRvIGFsbG93IHRoZW0gdG8gaGF2ZSBtdWx0aXBsZSBzcGVuZHMKCiAgICBldmVudCBGaW5hbGl6ZWQoKTsKICAgIGV2ZW50IFRva2VuUHVyY2hhc2UoYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50IHZhbHVlLCB1aW50IGFtb3VudCk7CiAgICBldmVudCBUb2tlblByZXNhbGUoYWRkcmVzcyBpbmRleGVkIHB1cmNoYXNlciwgdWludCBhbW91bnQpOwogICAgZXZlbnQgVG9rZW5Gb3VuZGluZ1RlYW0oYWRkcmVzcyBwdXJjaGFzZXIsIHVpbnQgYW1vdW50KTsKICAgIGV2ZW50IFRva2VuVHJlYXN1cnkoYWRkcmVzcyBwdXJjaGFzZXIsIHVpbnQgYW1vdW50KTsKICAgIGV2ZW50IEVhcmx5U3VwcG9ydGVycyhhZGRyZXNzIHB1cmNoYXNlciwgdWludCBhbW91bnQpOwoKICAgIGZ1bmN0aW9uIFNlbmNUb2tlblNhbGUodWludFtdIF9iYXRjaFN0YXJ0VGltZXMsIHVpbnQgX2VuZFRpbWUsIHVpbnQgX3VzZFBlck1FdGgsIHVpbnQgX3ByZXNhbGVXZWksCiAgICAgICAgV2hpdGVMaXN0ZWRCYXNpYyBfd2hpdGVMaXN0ZWQsIGFkZHJlc3MgX2FnVGVjaFdhbGxldCwgIGFkZHJlc3MgX2ZvdW5kaW5nVGVhbVdhbGxldCwKICAgICAgICBhZGRyZXNzIF9lYXJseVN1cHBvcnRlcnNXYWxsZXQsIGFkZHJlc3MgX3RyZWFzdXJ5V2FsbGV0LCBhZGRyZXNzIF9wcmVzYWxlV2FsbGV0LCBhZGRyZXNzIF90b2tlbklzc3VlcgogICAgKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX2JhdGNoU3RhcnRUaW1lcy5sZW5ndGggPiAwKTsKICAgICAgICAvLyByZXF1aXJlIChub3cgPCBiYXRjaFN0YXJ0VGltZXNbMF0pOwogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IF9iYXRjaFN0YXJ0VGltZXMubGVuZ3RoIC0gMTsgaSsrKSB7CiAgICAgICAgICAgIHJlcXVpcmUoX2JhdGNoU3RhcnRUaW1lc1tpKzFdID4gX2JhdGNoU3RhcnRUaW1lc1tpXSk7CiAgICAgICAgfQogICAgICAgIHJlcXVpcmUoX2VuZFRpbWUgPj0gX2JhdGNoU3RhcnRUaW1lc1tfYmF0Y2hTdGFydFRpbWVzLmxlbmd0aCAtIDFdKTsKICAgICAgICByZXF1aXJlKF91c2RQZXJNRXRoID4gMCk7CiAgICAgICAgcmVxdWlyZShfd2hpdGVMaXN0ZWQgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfYWdUZWNoV2FsbGV0ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX2ZvdW5kaW5nVGVhbVdhbGxldCAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF9lYXJseVN1cHBvcnRlcnNXYWxsZXQgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfcHJlc2FsZVdhbGxldCAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF90cmVhc3VyeVdhbGxldCAhPSBhZGRyZXNzKDApKTsKICAgICAgICBvd25lciA9IF90b2tlbklzc3VlcjsKCiAgICAgICAgYmF0Y2hTdGFydFRpbWVzID0gX2JhdGNoU3RhcnRUaW1lczsKICAgICAgICBzdGFydFRpbWUgPSBfYmF0Y2hTdGFydFRpbWVzWzBdOwogICAgICAgIGVuZFRpbWUgPSBfZW5kVGltZTsKICAgICAgICBhZ1RlY2hXYWxsZXQgPSBfYWdUZWNoV2FsbGV0OwogICAgICAgIHdoaXRlTGlzdGVkID0gX3doaXRlTGlzdGVkOwogICAgICAgIHdlaVJhaXNlZCA9IF9wcmVzYWxlV2VpOwogICAgICAgIHVzZFBlck1FdGggPSBfdXNkUGVyTUV0aDsKICAgICAgICBwdWJsaWNTYWxlU2VuY1Blck1FdGggPSB1c2RQZXJNRXRoLm11bChNSUxMSU9OKS5kaXYoUFVCTElDU0FMRV9VU0RfUEVSX01TRU5DKTsKICAgICAgICBwcml2YXRlU2FsZVNlbmNQZXJNRXRoID0gdXNkUGVyTUV0aC5tdWwoTUlMTElPTikuZGl2KFBSSVZBVEVTQUxFX1VTRF9QRVJfTVNFTkMpOwoKICAgICAgICAvLyBMZXQgdGhlIHRva2VuIHN0dWZmIGJlZ2luCiAgICAgICAgdG9rZW4gPSBuZXcgU2VuY1Rva2VuKCk7CgogICAgICAgIC8vIE1pbnQgaW5pdGlhbCB0b2tlbnMKICAgICAgICBtaW50RWFybHlTdXBwb3J0ZXJzVG9rZW5zKF9lYXJseVN1cHBvcnRlcnNXYWxsZXQsIFRPS0VOX0VBUkxZU1VQUE9SVEVSUyk7CiAgICAgICAgbWludFByZXNhbGVUb2tlbnMoX3ByZXNhbGVXYWxsZXQsIFRPS0VOX1BSRVNBTEUpOwogICAgICAgIG1pbnRUcmVhc3VyeVRva2VucyhfdHJlYXN1cnlXYWxsZXQsIFRPS0VOX1RSRUFTVVJZKTsKICAgICAgICBtaW50Rm91bmRpbmdUZWFtVG9rZW5zKF9mb3VuZGluZ1RlYW1XYWxsZXQsIFRPS0VOX0ZPVU5ESU5HVEVBTSk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QmF0Y2hTdGFydFRpbWVzTGVuZ3RoKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBiYXRjaFN0YXJ0VGltZXMubGVuZ3RoOwogICAgfQoKICAgIGZ1bmN0aW9uIHVwZGF0ZUJhdGNoU3RhcnRUaW1lKHVpbnQgX2JhdGNoTnVtYmVyLCB1aW50IF9iYXRjaFN0YXJ0VGltZSkgcHVibGljIGNhbk9wZXJhdGUgewogICAgICAgIGJhdGNoU3RhcnRUaW1lc1tfYmF0Y2hOdW1iZXJdID0gX2JhdGNoU3RhcnRUaW1lOwoJZm9yICh1aW50IGkgPSAwOyBpIDwgYmF0Y2hTdGFydFRpbWVzLmxlbmd0aCAtIDE7IGkrKykgewogICAgICAgICAgICByZXF1aXJlKGJhdGNoU3RhcnRUaW1lc1tpKzFdID4gYmF0Y2hTdGFydFRpbWVzW2ldKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdXBkYXRlRW5kVGltZSh1aW50IF9lbmRUaW1lKSBwdWJsaWMgY2FuT3BlcmF0ZSB7CglyZXF1aXJlKF9lbmRUaW1lID49IGJhdGNoU3RhcnRUaW1lc1tiYXRjaFN0YXJ0VGltZXMubGVuZ3RoIC0gMV0pOwogICAgICAgIGVuZFRpbWUgPSBfZW5kVGltZTsKICAgIH0KCiAgICBmdW5jdGlvbiB1cGRhdGVVc2RQZXJNRXRoKHVpbnQgX3VzZFBlck1FdGgpIHB1YmxpYyBjYW5PcGVyYXRlIHsKICAgICAgICByZXF1aXJlKG5vdyA8IGJhdGNoU3RhcnRUaW1lc1swXSk7CiAgICAgICAgdXNkUGVyTUV0aCA9IF91c2RQZXJNRXRoOwogICAgICAgIHB1YmxpY1NhbGVTZW5jUGVyTUV0aCA9IHVzZFBlck1FdGgubXVsKE1JTExJT04pLmRpdihQVUJMSUNTQUxFX1VTRF9QRVJfTVNFTkMpOwogICAgICAgIHByaXZhdGVTYWxlU2VuY1Blck1FdGggPSB1c2RQZXJNRXRoLm11bChNSUxMSU9OKS5kaXYoUFJJVkFURVNBTEVfVVNEX1BFUl9NU0VOQyk7CiAgICB9CgogICAgZnVuY3Rpb24gbWludEVhcmx5U3VwcG9ydGVyc1Rva2VucyhhZGRyZXNzIGFkZHIsIHVpbnQgYW1vdW50KSBpbnRlcm5hbCB7CiAgICAgICAgdG9rZW4ubWludChhZGRyLCBhbW91bnQpOwogICAgICAgIEVhcmx5U3VwcG9ydGVycyhhZGRyLCBhbW91bnQpOwogICAgfQoKICAgIGZ1bmN0aW9uIG1pbnRUcmVhc3VyeVRva2VucyhhZGRyZXNzIGFkZHIsIHVpbnQgYW1vdW50KSBpbnRlcm5hbCB7CiAgICAgICAgdG9rZW4ubWludChhZGRyLCBhbW91bnQpOwogICAgICAgIFRva2VuVHJlYXN1cnkoYWRkciwgYW1vdW50KTsKICAgIH0KCiAgICBmdW5jdGlvbiBtaW50Rm91bmRpbmdUZWFtVG9rZW5zKGFkZHJlc3MgYWRkciwgdWludCBhbW91bnQpIGludGVybmFsIHsKICAgICAgICB0b2tlbi5taW50KGFkZHIsIGFtb3VudCk7CiAgICAgICAgVG9rZW5Gb3VuZGluZ1RlYW0oYWRkciwgYW1vdW50KTsKICAgIH0KCiAgICBmdW5jdGlvbiBtaW50UHJlc2FsZVRva2VucyhhZGRyZXNzIGFkZHIsIHVpbnQgYW1vdW50KSBpbnRlcm5hbCB7CiAgICAgICAgdG9rZW4ubWludChhZGRyLCBhbW91bnQpOwogICAgICAgIFRva2VuUHJlc2FsZShhZGRyLCBhbW91bnQpOwogICAgfQoKICAgIC8vIE9ubHkgZmFsbGJhY2sgZnVuY3Rpb24gY2FuIGJlIHVzZWQgdG8gYnV5IHRva2VucwogICAgZnVuY3Rpb24gKCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIsIG1zZy52YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQgd2VpQW1vdW50KSBpbnRlcm5hbCB3aGVuTm90UGF1c2VkIHsKICAgICAgICByZXF1aXJlKGJlbmVmaWNpYXJ5ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoaXNXaGl0ZUxpc3RlZChiZW5lZmljaWFyeSkpOwogICAgICAgIHJlcXVpcmUoaXNXaXRoaW5QZXJpb2QoYmVuZWZpY2lhcnkpKTsKICAgICAgICByZXF1aXJlKGlzV2l0aGluQWxsb2NhdGlvbihiZW5lZmljaWFyeSwgd2VpQW1vdW50KSk7CgogICAgICAgIHVpbnQgdG9rZW5zID0gd2VpQW1vdW50Lm11bChwdWJsaWNTYWxlU2VuY1Blck1FdGgpLmRpdihNSUxMSU9OKTsKICAgICAgICB3ZWlSYWlzZWQgPSB3ZWlSYWlzZWQuYWRkKHdlaUFtb3VudCk7CgogICAgICAgIGlmIChjb250cmlidXRpb25zW2JlbmVmaWNpYXJ5XSA9PSAwKSB7CiAgICAgICAgICAgIG51bUNvbnRyaWJ1dG9ycysrOwogICAgICAgIH0KCiAgICAgICAgY29udHJpYnV0aW9uc1tiZW5lZmljaWFyeV0gPSBjb250cmlidXRpb25zW2JlbmVmaWNpYXJ5XS5hZGQod2VpQW1vdW50KTsKICAgICAgICB0b2tlbi5taW50KGJlbmVmaWNpYXJ5LCB0b2tlbnMpOwogICAgICAgIFRva2VuUHVyY2hhc2UoYmVuZWZpY2lhcnksIHdlaUFtb3VudCwgdG9rZW5zKTsKCiAgICAgICAgZm9yd2FyZEZ1bmRzKCk7CiAgICB9CgogICAgZnVuY3Rpb24gZXRoUmFpc2VkKCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50KSB7CiAgICAgICAgcmV0dXJuIHdlaVJhaXNlZC5kaXYoMTAgKiogMTgpOwogICAgfQoKICAgIGZ1bmN0aW9uIHVzZFJhaXNlZCgpIHB1YmxpYyB2aWV3IHJldHVybnModWludCkgewogICAgICAgIHJldHVybiB3ZWlSYWlzZWQubXVsKHVzZFBlck1FdGgpLmRpdihNSUxMSU9OKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZW5jU29sZCgpIHB1YmxpYyB2aWV3IHJldHVybnModWludCkgewogICAgICAgIHJldHVybiB0b2tlbi50b3RhbFN1cHBseSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNlbmNCYWxhbmNlKCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50KSB7CiAgICAgICAgcmV0dXJuIHRva2VuLlRPVEFMU1VQUExZKCkuc3ViKHRva2VuLnRvdGFsU3VwcGx5KCkpOwogICAgfQoKICAgIC8vIFRoaXMgY2FuIGJlIHVzZWQgYWZ0ZXIgdGhlIHNhbGUgaXMgb3ZlciBhbmQgdG9rZW5zIGFyZSB1bnBhdXNlZAogICAgZnVuY3Rpb24gcmVjbGFpbVRva2VucygpIGV4dGVybmFsIGNhbk9wZXJhdGUgewogICAgICAgIHVpbnQgYmFsYW5jZSA9IHRva2VuLmJhbGFuY2VPZih0aGlzKTsKICAgICAgICB0b2tlbi50cmFuc2Zlcihvd25lciwgYmFsYW5jZSk7CiAgICB9CgogICAgLy8gQmF0Y2ggaXMgaW4gMC4ubi0xIGZvcm1hdAogICAgZnVuY3Rpb24gaXNCYXRjaEFjdGl2ZSh1aW50IGJhdGNoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYgKG5vdyA+IGVuZFRpbWUpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBpZiAodWludChiYXRjaCkgPj0gYmF0Y2hTdGFydFRpbWVzLmxlbmd0aCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGlmIChub3cgPiBiYXRjaFN0YXJ0VGltZXNbYmF0Y2hdKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLy8gUmV0dXJucwogICAgLy8gMCAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gbm90IHN0YXJ0ZWQKICAgIC8vIDEuLmJhdGNoU3RhcnRUaW1lcy5sZW5ndGggICAtIGJhdGNoIHBsdXMgMQogICAgLy8gYmF0Y2hTdGFydFRpbWVzLmxlbmd0aCArIDEgIC0gZW5kZWQKICAgIGZ1bmN0aW9uIGJhdGNoQWN0aXZlKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIGlmIChub3cgPiBlbmRUaW1lKSB7CiAgICAgICAgICAgIHJldHVybiBiYXRjaFN0YXJ0VGltZXMubGVuZ3RoICsgMTsKICAgICAgICB9CiAgICAgICAgZm9yICh1aW50IGkgPSBiYXRjaFN0YXJ0VGltZXMubGVuZ3RoOyBpID4gMDsgaS0tKSB7CiAgICAgICAgICAgIGlmIChub3cgPiBiYXRjaFN0YXJ0VGltZXNbaS0xXSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgLy8gUmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBlbmRlZAogICAgZnVuY3Rpb24gaGFzRW5kZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIG5vdyA+IGVuZFRpbWU7CiAgICB9CgogICAgLy8gU2VuZCBldGhlciB0byB0aGUgZnVuZCBjb2xsZWN0aW9uIHdhbGxldAogICAgZnVuY3Rpb24gZm9yd2FyZEZ1bmRzKCkgaW50ZXJuYWwgewogICAgICAgIGFnVGVjaFdhbGxldC50cmFuc2Zlcihtc2cudmFsdWUpOwogICAgfQoKICAgIC8vIEJ1eWVyIG11c3QgYmUgd2hpdGVsaXN0ZWQKICAgIGZ1bmN0aW9uIGlzV2hpdGVMaXN0ZWQoYWRkcmVzcyBiZW5lZmljaWFyeSkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHdoaXRlTGlzdGVkLmlzV2hpdGVMaXN0ZWQoYmVuZWZpY2lhcnkpOwogICAgfQoKICAgIC8vIEJ1eWVyIG11c3QgYnkgd2l0aGluIGFzc2lnbmVkIGJhdGNoIHBlcmlvZAogICAgZnVuY3Rpb24gaXNXaXRoaW5QZXJpb2QoYWRkcmVzcyBiZW5lZmljaWFyeSkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgdWludCBiYXRjaE51bWJlciA9IHdoaXRlTGlzdGVkLmdldEJhdGNoTnVtYmVyKGJlbmVmaWNpYXJ5KTsKICAgICAgICByZXR1cm4gbm93ID49IGJhdGNoU3RhcnRUaW1lc1tiYXRjaE51bWJlcl0gJiYgbm93IDw9IGVuZFRpbWU7CiAgICB9CgogICAgLy8gQnV5ZXIgbXVzdCBieSB3aXRoaW50IGFsbG9jYXRlZCBhbW91bnQKICAgIGZ1bmN0aW9uIGlzV2l0aGluQWxsb2NhdGlvbihhZGRyZXNzIGJlbmVmaWNpYXJ5LCB1aW50IHdlaUFtb3VudCkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgdWludCBhbGxvY2F0aW9uID0gd2hpdGVMaXN0ZWQuZ2V0QWxsb2NhdGVkKGJlbmVmaWNpYXJ5KTsKICAgICAgICByZXR1cm4gKHdlaUFtb3VudCA+PSBNSU5fQ09OVFJJQlVUSU9OKSAmJiAod2VpQW1vdW50LmFkZChjb250cmlidXRpb25zW2JlbmVmaWNpYXJ5XSkgPD0gYWxsb2NhdGlvbik7CiAgICB9CgogICAgLy8gTXVzdCBiZSBjYWxsZWQgYWZ0ZXIgY3Jvd2RzYWxlIGVuZHMsIHRvIGRvIHNvbWUgZXh0cmEgZmluYWxpemF0aW9uCiAgICBmdW5jdGlvbiBmaW5hbGl6ZSgpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoIWlzRmluYWxpemVkKTsKICAgICAgICByZXF1aXJlKGhhc0VuZGVkKCkpOwoKICAgICAgICBmaW5hbGl6YXRpb24oKTsKICAgICAgICBGaW5hbGl6ZWQoKTsKCiAgICAgICAgaXNGaW5hbGl6ZWQgPSB0cnVlOwogICAgfQoKICAgIC8vIFN0b3BzIHRoZSBtaW50aW5nIGFuZCB0cmFuc2ZlciB0b2tlbiBvd25lcnNoaXAgdG8gc2FsZSBvd25lci4gTWludHMgdW5zb2xkIHRva2VucyB0byBvd25lcgogICAgZnVuY3Rpb24gZmluYWxpemF0aW9uKCkgaW50ZXJuYWwgewogICAgICAgIHRva2VuLm1pbnQob3duZXIsc2VuY0JhbGFuY2UoKSk7CiAgICAgICAgdG9rZW4uZmluaXNoTWludGluZygpOwogICAgICAgIHRva2VuLnRyYW5zZmVyT3duZXJzaGlwKG93bmVyKTsKICAgIH0KfQ=='.
	

]
