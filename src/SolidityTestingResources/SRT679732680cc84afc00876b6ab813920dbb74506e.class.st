Class {
	#name : #SRT679732680cc84afc00876b6ab813920dbb74506e,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT679732680cc84afc00876b6ab813920dbb74506e >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7IC8vIHNvbGhpbnQtZGlzYWJsZS1saW5lCgpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKY29udHJhY3QgRVJDNzIxIHsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSUQpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKICAgIGZ1bmN0aW9uIGltcGxlbWVudHNFUkM3MjEoKSBwdWJsaWMgcHVyZSByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JRCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBhZGRyKTsKICAgIGZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JRCkgcHVibGljOwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHRvdGFsKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JRCkgcHVibGljOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSUQpIHB1YmxpYzsKCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHRva2VuSUQpOyAvLyBzb2xoaW50LWRpc2FibGUtbGluZQogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgYXBwcm92ZWQsIHVpbnQyNTYgdG9rZW5JRCk7CgogICAgZnVuY3Rpb24gbmFtZSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKHN0cmluZyk7CiAgICBmdW5jdGlvbiBzeW1ib2woKSBwdWJsaWMgcHVyZSByZXR1cm5zIChzdHJpbmcpOwp9Cgpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cn0KCmNvbnRyYWN0IE1hbmFnZWFibGUgaXMgT3duYWJsZSB7CgogICAgYWRkcmVzcyBwdWJsaWMgbWFuYWdlcjsKICAgIGJvb2wgcHVibGljIGNvbnRyYWN0TG9jazsKCiAgICBldmVudCBNYW5hZ2VyVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzTWFuYWdlciwgYWRkcmVzcyBpbmRleGVkIG5ld01hbmFnZXIpOwogICAgZXZlbnQgQ29udHJhY3RMb2NrQ2hhbmdlZChhZGRyZXNzIGFkbWluLCBib29sIHN0YXRlKTsKCiAgICBmdW5jdGlvbiBNYW5hZ2VhYmxlKCkgcHVibGljIHsKICAgICAgICBtYW5hZ2VyID0gbXNnLnNlbmRlcjsKICAgICAgICBjb250cmFjdExvY2sgPSBmYWxzZTsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5TWFuYWdlcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gbWFuYWdlcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5QWRtaW4oKSB7CiAgICAgICAgcmVxdWlyZSgobXNnLnNlbmRlciA9PSBtYW5hZ2VyKSB8fCAobXNnLnNlbmRlciA9PSBvd25lcikpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgaXNVbmxvY2tlZCgpIHsKICAgICAgICByZXF1aXJlKCFjb250cmFjdExvY2spOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJNYW5hZ2VyKGFkZHJlc3MgbmV3TWFuYWdlcikgcHVibGljIG9ubHlBZG1pbiB7CiAgICAgICAgcmVxdWlyZShuZXdNYW5hZ2VyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIE1hbmFnZXJUcmFuc2ZlcnJlZChtYW5hZ2VyLCBuZXdNYW5hZ2VyKTsKICAgICAgICBtYW5hZ2VyID0gbmV3TWFuYWdlcjsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRDb250cmFjdExvY2soYm9vbCBzZXR0aW5nKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICBjb250cmFjdExvY2sgPSBzZXR0aW5nOwogICAgICAgIENvbnRyYWN0TG9ja0NoYW5nZWQobXNnLnNlbmRlciwgc2V0dGluZyk7CiAgICB9CgogICAgZnVuY3Rpb24gcGF5b3V0KGFkZHJlc3MgX3RvKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBpZiAoX3RvID09IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgb3duZXIudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfdG8udHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gd2l0aGRyYXdGdW5kcyhhZGRyZXNzIF90bywgdWludDI1NiBhbW91bnQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUodGhpcy5iYWxhbmNlID49IGFtb3VudCk7CiAgICAgICAgaWYgKF90byA9PSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIG93bmVyLnRyYW5zZmVyKGFtb3VudCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3RvLnRyYW5zZmVyKGFtb3VudCk7CiAgICAgICAgfQogICAgfQp9Cgpjb250cmFjdCBUb2tlbkxheWVyIGlzIEVSQzcyMSwgTWFuYWdlYWJsZSB7CgogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBFVkVOVFMgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAgIGV2ZW50IFRva2VuQ3JlYXRlZCh1aW50MjU2IHRva2VuSWQsIGJ5dGVzMzIgbmFtZSwgdWludDI1NiBwYXJlbnRJZCwgYWRkcmVzcyBvd25lcik7CiAgICBldmVudCBUb2tlbkRlbGV0ZWQodWludDI1NiB0b2tlbklkKTsKCiAgICBldmVudCBUb2tlblNvbGQoCiAgICAgICAgdWludDI1NiB0b2tlbklkLCB1aW50MjU2IG9sZFByaWNlLAogICAgICAgIHVpbnQyNTYgbmV3UHJpY2UsIGFkZHJlc3MgcHJldk93bmVyLAogICAgICAgIGFkZHJlc3Mgd2lubmVyLCBieXRlczMyIG5hbWUsCiAgICAgICAgdWludDI1NiBwYXJlbnRJZAogICAgKTsKCiAgICBldmVudCBQcmljZUNoYW5nZWQodWludDI1NiB0b2tlbklkLCB1aW50MjU2IG9sZFByaWNlLCB1aW50MjU2IG5ld1ByaWNlKTsKICAgIGV2ZW50IFBhcmVudENoYW5nZWQodWludDI1NiB0b2tlbklkLCB1aW50MjU2IG9sZFBhcmVudElkLCB1aW50MjU2IG5ld1BhcmVudElkKTsKICAgIGV2ZW50IE5hbWVDaGFuZ2VkKHVpbnQyNTYgdG9rZW5JZCwgYnl0ZXMzMiBvbGROYW1lLCBieXRlczMyIG5ld05hbWUpOwogICAgZXZlbnQgTWV0YURhdGFDaGFuZ2VkKHVpbnQyNTYgdG9rZW5JZCwgYnl0ZXMzMiBvbGRNZXRhLCBieXRlczMyIG5ld01ldGEpOwovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBTVE9SQUdFICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgdWludDI1NiBwcml2YXRlIGNvbnN0YW50IERFRkFVTFRQQVJFTlQgPSAxMjM0NTY3ODk7CgogICAgbWFwcGluZyAodWludDI1NiA9PiBUb2tlbikgICBwcml2YXRlIHRva2VuSW5kZXhUb1Rva2VuOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwcml2YXRlIG93bmVyc2hpcFRva2VuQ291bnQ7CgogICAgYWRkcmVzcyBwdWJsaWMgZ2FtZUFkZHJlc3M7CiAgICBhZGRyZXNzIHB1YmxpYyBwYXJlbnRBZGRyOwoKICAgIHVpbnQyNTYgcHJpdmF0ZSB0b3RhbFRva2VuczsKICAgIHVpbnQyNTYgcHVibGljIGRldkZlZSA9IDUwOwogICAgdWludDI1NiBwdWJsaWMgb3duZXJGZWUgPSAyMDA7CiAgICB1aW50MjU2WzEwXSBwcml2YXRlIGNoYWluRmVlcyA9IFsxMF07CgogICAgc3RydWN0IFRva2VuIHsKICAgICAgICBib29sIGV4aXN0czsKICAgICAgICBhZGRyZXNzIGFwcHJvdmVkOwogICAgICAgIGFkZHJlc3Mgb3duZXI7CiAgICAgICAgYnl0ZXMzMiBtZXRhZGF0YTsKICAgICAgICBieXRlczMyIG5hbWU7CiAgICAgICAgdWludDI1NiBsYXN0QmxvY2s7CiAgICAgICAgdWludDI1NiBwYXJlbnRJZDsKICAgICAgICB1aW50MjU2IHByaWNlOwogICAgfQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIE1PRElGSUVSUyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgbW9kaWZpZXIgb25seVN5c3RlbSgpIHsKICAgICAgICByZXF1aXJlKChtc2cuc2VuZGVyID09IGdhbWVBZGRyZXNzKSB8fCAobXNnLnNlbmRlciA9PSBtYW5hZ2VyKSk7CiAgICAgICAgXzsKICAgIH0KLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIENPTlNUUlVDVE9SICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAgIGZ1bmN0aW9uIFRva2VuTGF5ZXIoYWRkcmVzcyBfZ2FtZUFkZHJlc3MsIGFkZHJlc3MgX3BhcmVudEFkZHIpIHB1YmxpYyB7CiAgICAgICAgZ2FtZUFkZHJlc3MgPSBfZ2FtZUFkZHJlc3M7CiAgICAgICAgcGFyZW50QWRkciA9IF9wYXJlbnRBZGRyOwogICAgfQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIFBVQkxJQyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgZnVuY3Rpb24gaW1wbGVtZW50c0VSQzcyMSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBuYW1lKCkgcHVibGljIHB1cmUgcmV0dXJucyAoc3RyaW5nKSB7CiAgICAgICAgcmV0dXJuICJDcnlwdG9DaXRpZXMiOwogICAgfQoKICAgIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyBwdXJlIHJldHVybnMgKHN0cmluZykgewogICAgICAgIHJldHVybiAiUmVzb3VyY2VUb2tlbiI7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCwgYWRkcmVzcyBfZnJvbSkgcHVibGljIG9ubHlTeXN0ZW0gewogICAgICAgIF9hcHByb3ZlKF90bywgX3Rva2VuSWQsIF9mcm9tKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgaXNVbmxvY2tlZCB7CiAgICAgICAgX2FwcHJvdmUoX3RvLCBfdG9rZW5JZCwgbXNnLnNlbmRlcik7CiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gb3duZXJzaGlwVG9rZW5Db3VudFtfb3duZXJdOwogICAgfQoKICAgIGZ1bmN0aW9uIGJ1bmRsZVRva2VuKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnModWludDI1Nls4XSBfdG9rZW5EYXRhKSB7CiAgICAgICAgVG9rZW4gc3RvcmFnZSB0b2tlbiA9IHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXTsKCiAgICAgICAgdWludDI1Nls4XSBtZW1vcnkgdG9rZW5EYXRhOwoKICAgICAgICB0b2tlbkRhdGFbMF0gPSB1aW50MjU2KHRva2VuLm5hbWUpOwogICAgICAgIHRva2VuRGF0YVsxXSA9IHRva2VuLnBhcmVudElkOwogICAgICAgIHRva2VuRGF0YVsyXSA9IHRva2VuLnByaWNlOwogICAgICAgIHRva2VuRGF0YVszXSA9IHVpbnQyNTYodG9rZW4ub3duZXIpOwogICAgICAgIHRva2VuRGF0YVs0XSA9IF9nZXROZXh0UHJpY2UoX3Rva2VuSWQpOwogICAgICAgIHRva2VuRGF0YVs1XSA9IGRldkZlZStnZXRDaGFpbkZlZXMoX3Rva2VuSWQpOwogICAgICAgIHRva2VuRGF0YVs2XSA9IHVpbnQyNTYodG9rZW4uYXBwcm92ZWQpOwogICAgICAgIHRva2VuRGF0YVs3XSA9IHVpbnQyNTYodG9rZW4ubWV0YWRhdGEpOwogICAgICAgIHJldHVybiB0b2tlbkRhdGE7CiAgICB9CgogICAgZnVuY3Rpb24gdGFrZU93bmVyc2hpcCh1aW50MjU2IF90b2tlbklkLCBhZGRyZXNzIF90bykgcHVibGljIG9ubHlTeXN0ZW0gewogICAgICAgIF90YWtlT3duZXJzaGlwKF90b2tlbklkLCBfdG8pOwogICAgfQoKICAgIGZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JZCkgcHVibGljIGlzVW5sb2NrZWQgewogICAgICAgIF90YWtlT3duZXJzaGlwKF90b2tlbklkLCBtc2cuc2VuZGVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b2tlbnNPZk93bmVyKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2W10gb3duZXJUb2tlbnMpIHsKICAgICAgICB1aW50MjU2IHRva2VuQ291bnQgPSBiYWxhbmNlT2YoX293bmVyKTsKICAgICAgICBpZiAodG9rZW5Db3VudCA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgdWludDI1NltdKDApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHVpbnQyNTZbXSBtZW1vcnkgcmVzdWx0ID0gbmV3IHVpbnQyNTZbXSh0b2tlbkNvdW50KTsKICAgICAgICAgICAgdWludDI1NiBfdG90YWxUb2tlbnMgPSB0b3RhbFN1cHBseSgpOwogICAgICAgICAgICB1aW50MjU2IHJlc3VsdEluZGV4ID0gMDsKCiAgICAgICAgICAgIHVpbnQyNTYgdG9rZW5JZCA9IDA7CiAgICAgICAgICAgIHVpbnQyNTYgdG9rZW5JbmRleCA9IDA7CiAgICAgICAgICAgIHdoaWxlICh0b2tlbkluZGV4IDw9IF90b3RhbFRva2VucykgewogICAgICAgICAgICAgICAgaWYgKGV4aXN0cyh0b2tlbklkKSkgewogICAgICAgICAgICAgICAgICAgIHRva2VuSW5kZXgrKzsKICAgICAgICAgICAgICAgICAgICBpZiAodG9rZW5JbmRleFRvVG9rZW5bdG9rZW5JZF0ub3duZXIgPT0gX293bmVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHRJbmRleF0gPSB0b2tlbklkOwogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRJbmRleCsrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRva2VuSWQrKzsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgdG90YWwpIHsKICAgICAgICByZXR1cm4gdG90YWxUb2tlbnM7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBvbmx5U3lzdGVtIHsKICAgICAgICBfY2hlY2tUaGVuVHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgaXNVbmxvY2tlZCB7CiAgICAgICAgX2NoZWNrVGhlblRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3Rva2VuSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIG9ubHlTeXN0ZW0gewogICAgICAgIF90cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3Rva2VuSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgaXNVbmxvY2tlZCB7CiAgICAgICAgX3RyYW5zZmVyRnJvbShfZnJvbSwgbXNnLnNlbmRlciwgX3Rva2VuSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNyZWF0ZVRva2VuKAogICAgICAgIHVpbnQyNTYgX3Rva2VuSWQsIGFkZHJlc3MgX293bmVyLAogICAgICAgIGJ5dGVzMzIgX25hbWUsIHVpbnQyNTYgX3BhcmVudElkLAogICAgICAgIHVpbnQyNTYgX3ByaWNlLCBieXRlczMyIF9tZXRhZGF0YQogICAgKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICByZXF1aXJlKF9wcmljZSA+IDApOwogICAgICAgIHJlcXVpcmUoX2FkZHJlc3NOb3ROdWxsKF9vd25lcikpOwogICAgICAgIHJlcXVpcmUoX3Rva2VuSWQgPT0gdWludDI1Nih1aW50MzIoX3Rva2VuSWQpKSk7CiAgICAgICAgcmVxdWlyZSghZXhpc3RzKF90b2tlbklkKSk7CgogICAgICAgIHRvdGFsVG9rZW5zKys7CgogICAgICAgIFRva2VuIG1lbW9yeSBfdG9rZW4gPSBUb2tlbih7CiAgICAgICAgICAgIG5hbWU6IF9uYW1lLAogICAgICAgICAgICBwYXJlbnRJZDogX3BhcmVudElkLAogICAgICAgICAgICBleGlzdHM6IHRydWUsCiAgICAgICAgICAgIHByaWNlOiBfcHJpY2UsCiAgICAgICAgICAgIG93bmVyOiBfb3duZXIsCiAgICAgICAgICAgIGFwcHJvdmVkIDogMCwKICAgICAgICAgICAgbGFzdEJsb2NrIDogYmxvY2subnVtYmVyLAogICAgICAgICAgICBtZXRhZGF0YSA6IF9tZXRhZGF0YQogICAgICAgIH0pOwoKICAgICAgICB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0gPSBfdG9rZW47CgogICAgICAgIFRva2VuQ3JlYXRlZChfdG9rZW5JZCwgX25hbWUsIF9wYXJlbnRJZCwgX293bmVyKTsKCiAgICAgICAgX3RyYW5zZmVyKGFkZHJlc3MoMCksIF9vd25lciwgX3Rva2VuSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNyZWF0ZVRva2VucygKICAgICAgICB1aW50MjU2W10gX3Rva2VuSWRzLCBhZGRyZXNzW10gX293bmVycywKICAgICAgICBieXRlczMyW10gX25hbWVzLCB1aW50MjU2W10gX3BhcmVudElkcywKICAgICAgICB1aW50MjU2W10gX3ByaWNlcywgYnl0ZXMzMltdIF9tZXRhZGF0YXMKICAgICkgcHVibGljIG9ubHlBZG1pbiB7CiAgICAgICAgZm9yICh1aW50MjU2IGlkID0gMDsgaWQgPCBfdG9rZW5JZHMubGVuZ3RoOyBpZCsrKSB7CiAgICAgICAgICAgIGNyZWF0ZVRva2VuKAogICAgICAgICAgICAgICAgX3Rva2VuSWRzW2lkXSwgX293bmVyc1tpZF0sIF9uYW1lc1tpZF0sCiAgICAgICAgICAgICAgICBfcGFyZW50SWRzW2lkXSwgX3ByaWNlc1tpZF0sIF9tZXRhZGF0YXNbaWRdCiAgICAgICAgICAgICAgICApOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBkZWxldGVUb2tlbih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICByZXF1aXJlKF90b2tlbklkID09IHVpbnQyNTYodWludDMyKF90b2tlbklkKSkpOwogICAgICAgIHJlcXVpcmUoZXhpc3RzKF90b2tlbklkKSk7CiAgICAgICAgdG90YWxUb2tlbnMtLTsKCiAgICAgICAgYWRkcmVzcyBvbGRPd25lciA9IHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5vd25lcjsKCiAgICAgICAgb3duZXJzaGlwVG9rZW5Db3VudFtvbGRPd25lcl0gPSBvd25lcnNoaXBUb2tlbkNvdW50W29sZE93bmVyXS0tOwogICAgICAgIGRlbGV0ZSB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF07CiAgICAgICAgVG9rZW5EZWxldGVkKF90b2tlbklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBpbmNyZW1lbnRQcmljZSh1aW50MjU2IF90b2tlbklkLCBhZGRyZXNzIF90bykgcHVibGljIG9ubHlTeXN0ZW0gewogICAgICAgIHJlcXVpcmUoZXhpc3RzKF90b2tlbklkKSk7CiAgICAgICAgdWludDI1NiBfcHJpY2UgPSB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ucHJpY2U7CiAgICAgICAgYWRkcmVzcyBfb3duZXIgPSB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ub3duZXI7CiAgICAgICAgdWludDI1NiBfdG90YWxGZWVzID0gZ2V0Q2hhaW5GZWVzKF90b2tlbklkKTsKICAgICAgICB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ucHJpY2UgPSBfcHJpY2UubXVsKDEwMDArb3duZXJGZWUpLmRpdigxMDAwLShkZXZGZWUrX3RvdGFsRmVlcykpOwoKICAgICAgICBUb2tlblNvbGQoCiAgICAgICAgICAgIF90b2tlbklkLCBfcHJpY2UsIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5wcmljZSwKICAgICAgICAgICAgX293bmVyLCBfdG8sIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5uYW1lLAogICAgICAgICAgICB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ucGFyZW50SWQKICAgICAgICApOwogICAgfQoKICAgIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBfb3duZXIpIHsKICAgICAgICByZXF1aXJlKGV4aXN0cyhfdG9rZW5JZCkpOwogICAgICAgIF9vd25lciA9IHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5vd25lcjsKICAgIH0KCiAgICBmdW5jdGlvbiBibG9ja2VkKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wgX2Jsb2NrZWQpIHsKICAgICAgICByZXR1cm4gKHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5sYXN0QmxvY2sgPT0gYmxvY2subnVtYmVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBleGlzdHModWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmV0dXJuICh0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0uZXhpc3RzKTsKICAgIH0KLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAgIGZ1bmN0aW9uIHNldExheWVyUGFyZW50KGFkZHJlc3MgX3BhcmVudCkgcHVibGljIG9ubHlBZG1pbiB7CiAgICAgICAgcGFyZW50QWRkciA9IF9wYXJlbnQ7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0R2FtZShhZGRyZXNzIF9nYW1lQWRkcmVzcykgcHVibGljIG9ubHlBZG1pbiB7CiAgICAgICAgZ2FtZUFkZHJlc3MgPSBfZ2FtZUFkZHJlc3M7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0UHJpY2UodWludDI1NiBfdG9rZW5JZCwgdWludDI1NiBfcHJpY2UsIGFkZHJlc3MgX293bmVyKSBwdWJsaWMgb25seVN5c3RlbSB7CiAgICAgICAgcmVxdWlyZShfb3ducyhfb3duZXIsIF90b2tlbklkKSk7CiAgICAgICAgdWludDI1NiBvbGRQcmljZSA9IHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5wcmljZTsKICAgICAgICB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ucHJpY2UgPSBfcHJpY2U7CiAgICAgICAgUHJpY2VDaGFuZ2VkKF90b2tlbklkLCBvbGRQcmljZSwgX3ByaWNlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRQYXJlbnQodWludDI1NiBfdG9rZW5JZCwgdWludDI1NiBfcGFyZW50SWQpIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIHJlcXVpcmUoZXhpc3RzKF90b2tlbklkKSk7CiAgICAgICAgdWludDI1NiBvbGRQYXJlbnRJZCA9IHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5wYXJlbnRJZDsKICAgICAgICB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ucGFyZW50SWQgPSBfcGFyZW50SWQ7CiAgICAgICAgUGFyZW50Q2hhbmdlZChfdG9rZW5JZCwgb2xkUGFyZW50SWQsIF9wYXJlbnRJZCk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0TmFtZSh1aW50MjU2IF90b2tlbklkLCBieXRlczMyIF9uYW1lKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICByZXF1aXJlKGV4aXN0cyhfdG9rZW5JZCkpOwogICAgICAgIGJ5dGVzMzIgb2xkTmFtZSA9IHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5uYW1lOwogICAgICAgIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5uYW1lID0gX25hbWU7CiAgICAgICAgTmFtZUNoYW5nZWQoX3Rva2VuSWQsIG9sZE5hbWUsIF9uYW1lKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRNZXRhZGF0YSh1aW50MjU2IF90b2tlbklkLCBieXRlczMyIF9tZXRhZGF0YSkgcHVibGljIG9ubHlBZG1pbiB7CiAgICAgICAgcmVxdWlyZShleGlzdHMoX3Rva2VuSWQpKTsKICAgICAgICBieXRlczMyIG9sZE1ldGEgPSB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ubWV0YWRhdGE7CiAgICAgICAgdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm1ldGFkYXRhID0gX21ldGFkYXRhOwogICAgICAgIE1ldGFEYXRhQ2hhbmdlZChfdG9rZW5JZCwgb2xkTWV0YSwgX21ldGFkYXRhKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXREZXZGZWUodWludDI1NiBfZGV2RmVlKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICBkZXZGZWUgPSBfZGV2RmVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldE93bmVyRmVlKHVpbnQyNTYgX293bmVyRmVlKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICBvd25lckZlZSA9IF9vd25lckZlZTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRDaGFpbkZlZXModWludDI1NlsxMF0gX2NoYWluRmVlcykgcHVibGljIG9ubHlBZG1pbiB7CiAgICAgICAgY2hhaW5GZWVzID0gX2NoYWluRmVlczsKICAgIH0KLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBHRVRURVJTICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAgIGZ1bmN0aW9uIGdldFRva2VuKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMKICAgICgKICAgICAgICBieXRlczMyIHRva2VuTmFtZSwgdWludDI1NiBwYXJlbnRJZCwgdWludDI1NiBwcmljZSwKICAgICAgICBhZGRyZXNzIF9vd25lciwgdWludDI1NiBuZXh0UHJpY2UsIHVpbnQyNTYgbmV4dFByaWNlRmVlcywKICAgICAgICBhZGRyZXNzIGFwcHJvdmVkLCBieXRlczMyIG1ldGFkYXRhCiAgICApIHsKICAgICAgICBUb2tlbiBzdG9yYWdlIHRva2VuID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdOwoKICAgICAgICB0b2tlbk5hbWUgPSB0b2tlbi5uYW1lOwogICAgICAgIHBhcmVudElkID0gdG9rZW4ucGFyZW50SWQ7CiAgICAgICAgcHJpY2UgPSB0b2tlbi5wcmljZTsKICAgICAgICBfb3duZXIgPSB0b2tlbi5vd25lcjsKICAgICAgICBuZXh0UHJpY2UgPSBfZ2V0TmV4dFByaWNlKF90b2tlbklkKTsKICAgICAgICBuZXh0UHJpY2VGZWVzID0gZGV2RmVlK2dldENoYWluRmVlcyhfdG9rZW5JZCk7CiAgICAgICAgbWV0YWRhdGEgPSB0b2tlbi5tZXRhZGF0YTsKICAgICAgICBhcHByb3ZlZCA9IHRva2VuLmFwcHJvdmVkOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldENoYWluRmVlcyh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IF90b3RhbCkgewogICAgICAgIHVpbnQyNTYgY2hhaW5MZW5ndGggPSBfZ2V0Q2hhaW5MZW5ndGgoX3Rva2VuSWQpOwogICAgICAgIHVpbnQyNTYgdG90YWxGZWUgPSAwOwogICAgICAgIGZvciAodWludCBpZCA9IDA7IGlkIDwgY2hhaW5MZW5ndGg7IGlkKyspIHsKICAgICAgICAgICAgdG90YWxGZWUgPSB0b3RhbEZlZSArIGNoYWluRmVlc1tpZF07CiAgICAgICAgfQogICAgICAgIHJldHVybih0b3RhbEZlZSk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0Q2hhaW5GZWVBcnJheSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTZbMTBdIG1lbW9yeSBfY2hhaW5GZWVzKSB7CiAgICAgICAgcmV0dXJuKGNoYWluRmVlcyk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0UHJpY2VPZih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHByaWNlKSB7CiAgICAgICAgcmVxdWlyZShleGlzdHMoX3Rva2VuSWQpKTsKICAgICAgICByZXR1cm4gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLnByaWNlOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFBhcmVudE9mKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgcGFyZW50SWQpIHsKICAgICAgICByZXF1aXJlKGV4aXN0cyhfdG9rZW5JZCkpOwogICAgICAgIHJldHVybiB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ucGFyZW50SWQ7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0TWV0YWRhdGFPZih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChieXRlczMyIG1ldGFkYXRhKSB7CiAgICAgICAgcmVxdWlyZShleGlzdHMoX3Rva2VuSWQpKTsKICAgICAgICByZXR1cm4gKHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5tZXRhZGF0YSk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0Q2hhaW4odWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzc1sxMF0gbWVtb3J5IF9vd25lcnMpIHsKICAgICAgICByZXF1aXJlKGV4aXN0cyhfdG9rZW5JZCkpOwoKICAgICAgICB1aW50MjU2IF9wYXJlbnRJZCA9IGdldFBhcmVudE9mKF90b2tlbklkKTsKICAgICAgICBhZGRyZXNzIF9wYXJlbnRBZGRyID0gcGFyZW50QWRkcjsKCiAgICAgICAgYWRkcmVzc1sxMF0gbWVtb3J5IHJlc3VsdDsKCiAgICAgICAgaWYgKF9wYXJlbnRJZCAhPSBERUZBVUxUUEFSRU5UICYmIF9hZGRyZXNzTm90TnVsbChfcGFyZW50QWRkcikpIHsKICAgICAgICAgICAgdWludDI1NiByZXN1bHRJbmRleCA9IDA7CgogICAgICAgICAgICBUb2tlbkxheWVyIGxheWVyID0gVG9rZW5MYXllcihfcGFyZW50QWRkcik7CiAgICAgICAgICAgIGJvb2wgcGFyZW50RXhpc3RzID0gbGF5ZXIuZXhpc3RzKF9wYXJlbnRJZCk7CgogICAgICAgICAgICB3aGlsZSAoKF9wYXJlbnRJZCAhPSBERUZBVUxUUEFSRU5UKSAmJiBfYWRkcmVzc05vdE51bGwoX3BhcmVudEFkZHIpICYmIHBhcmVudEV4aXN0cykgewogICAgICAgICAgICAgICAgcGFyZW50RXhpc3RzID0gbGF5ZXIuZXhpc3RzKF9wYXJlbnRJZCk7CiAgICAgICAgICAgICAgICBpZiAoIXBhcmVudEV4aXN0cykgewogICAgICAgICAgICAgICAgICAgIHJldHVybihyZXN1bHQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmVzdWx0W3Jlc3VsdEluZGV4XSA9IGxheWVyLm93bmVyT2YoX3BhcmVudElkKTsKICAgICAgICAgICAgICAgIHJlc3VsdEluZGV4Kys7CgogICAgICAgICAgICAgICAgX3BhcmVudElkID0gbGF5ZXIuZ2V0UGFyZW50T2YoX3BhcmVudElkKTsKICAgICAgICAgICAgICAgIF9wYXJlbnRBZGRyID0gbGF5ZXIucGFyZW50QWRkcigpOwoKICAgICAgICAgICAgICAgIGxheWVyID0gVG9rZW5MYXllcihfcGFyZW50QWRkcik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybihyZXN1bHQpOwogICAgICAgIH0KICAgIH0KLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogUFJJVkFURSAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAgIGZ1bmN0aW9uIF9hZGRyZXNzTm90TnVsbChhZGRyZXNzIF90bykgcHJpdmF0ZSBwdXJlIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gX3RvICE9IGFkZHJlc3MoMCk7CiAgICB9CgogICAgZnVuY3Rpb24gX2FwcHJvdmVkKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiAodG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLmFwcHJvdmVkID09IF90byk7CiAgICB9CgogICAgZnVuY3Rpb24gX293bnMoYWRkcmVzcyBjbGFpbWFudCwgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gY2xhaW1hbnQgPT0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm93bmVyOwogICAgfQoKICAgIGZ1bmN0aW9uIF9jaGVja1RoZW5UcmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB7CiAgICAgICAgcmVxdWlyZShfb3ducyhfZnJvbSwgX3Rva2VuSWQpKTsKICAgICAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChfdG8pKTsKICAgICAgICByZXF1aXJlKGV4aXN0cyhfdG9rZW5JZCkpOwogICAgICAgIF90cmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gX3RyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHsKICAgICAgICBvd25lcnNoaXBUb2tlbkNvdW50W190b10rKzsKICAgICAgICB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ub3duZXIgPSBfdG87CiAgICAgICAgdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLmxhc3RCbG9jayA9IGJsb2NrLm51bWJlcjsKCiAgICAgICAgaWYgKF9mcm9tICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgb3duZXJzaGlwVG9rZW5Db3VudFtfZnJvbV0tLTsKICAgICAgICAgICAgdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLmFwcHJvdmVkID0gMDsKICAgICAgICB9CgogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfYXBwcm92ZShhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCwgYWRkcmVzcyBfZnJvbSkgcHJpdmF0ZSB7CiAgICAgICAgcmVxdWlyZShfb3ducyhfZnJvbSwgX3Rva2VuSWQpKTsKCiAgICAgICAgdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLmFwcHJvdmVkID0gX3RvOwoKICAgICAgICBBcHByb3ZhbChfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gX3Rha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JZCwgYWRkcmVzcyBfdG8pIHByaXZhdGUgewogICAgICAgIGFkZHJlc3MgbmV3T3duZXIgPSBfdG87CiAgICAgICAgYWRkcmVzcyBvbGRPd25lciA9IHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5vd25lcjsKCiAgICAgICAgcmVxdWlyZShfYWRkcmVzc05vdE51bGwobmV3T3duZXIpKTsKICAgICAgICByZXF1aXJlKF9hcHByb3ZlZChuZXdPd25lciwgX3Rva2VuSWQpKTsKCiAgICAgICAgX3RyYW5zZmVyKG9sZE93bmVyLCBuZXdPd25lciwgX3Rva2VuSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIF90cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgewogICAgICAgIHJlcXVpcmUoX293bnMoX2Zyb20sIF90b2tlbklkKSk7CiAgICAgICAgcmVxdWlyZShfYXBwcm92ZWQoX3RvLCBfdG9rZW5JZCkpOwogICAgICAgIHJlcXVpcmUoX2FkZHJlc3NOb3ROdWxsKF90bykpOwoKICAgICAgICBfdHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIF9nZXRDaGFpbkxlbmd0aCh1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHZpZXcgcmV0dXJucyAodWludDI1NiBfbGVuZ3RoKSB7CiAgICAgICAgdWludDI1NiBsZW5ndGg7CgogICAgICAgIHVpbnQyNTYgX3BhcmVudElkID0gZ2V0UGFyZW50T2YoX3Rva2VuSWQpOwogICAgICAgIGFkZHJlc3MgX3BhcmVudEFkZHIgPSBwYXJlbnRBZGRyOwogICAgICAgIGlmIChfcGFyZW50SWQgPT0gREVGQVVMVFBBUkVOVCB8fCAhX2FkZHJlc3NOb3ROdWxsKF9wYXJlbnRBZGRyKSkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CgogICAgICAgIFRva2VuTGF5ZXIgbGF5ZXIgPSBUb2tlbkxheWVyKF9wYXJlbnRBZGRyKTsKICAgICAgICBib29sIHBhcmVudEV4aXN0cyA9IGxheWVyLmV4aXN0cyhfcGFyZW50SWQpOwoKICAgICAgICB3aGlsZSAoKF9wYXJlbnRJZCAhPSBERUZBVUxUUEFSRU5UKSAmJiBfYWRkcmVzc05vdE51bGwoX3BhcmVudEFkZHIpICYmIHBhcmVudEV4aXN0cykgewogICAgICAgICAgICBwYXJlbnRFeGlzdHMgPSBsYXllci5leGlzdHMoX3BhcmVudElkKTsKICAgICAgICAgICAgaWYoIXBhcmVudEV4aXN0cykgewogICAgICAgICAgICAgICAgICAgIHJldHVybihsZW5ndGgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF9wYXJlbnRJZCA9IGxheWVyLmdldFBhcmVudE9mKF9wYXJlbnRJZCk7CiAgICAgICAgICAgIF9wYXJlbnRBZGRyID0gbGF5ZXIucGFyZW50QWRkcigpOwogICAgICAgICAgICBsYXllciA9IFRva2VuTGF5ZXIoX3BhcmVudEFkZHIpOwogICAgICAgICAgICBsZW5ndGgrKzsKICAgICAgICB9CgogICAgICAgIHJldHVybihsZW5ndGgpOwogICAgfQoKICAgIGZ1bmN0aW9uIF9nZXROZXh0UHJpY2UodWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB2aWV3IHJldHVybnMgKHVpbnQyNTYgX25leHRQcmljZSkgewogICAgICAgIHVpbnQyNTYgX3ByaWNlID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLnByaWNlOwogICAgICAgIHVpbnQyNTYgX3RvdGFsRmVlcyA9IGdldENoYWluRmVlcyhfdG9rZW5JZCk7CiAgICAgICAgX3ByaWNlID0gX3ByaWNlLm11bCgxMDAwK293bmVyRmVlKS5kaXYoMTAwMC0oZGV2RmVlK190b3RhbEZlZXMpKTsKICAgICAgICByZXR1cm4oX3ByaWNlKTsKICAgIH0KfQ=='.
	

]
