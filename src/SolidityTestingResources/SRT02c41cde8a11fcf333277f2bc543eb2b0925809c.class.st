Class {
	#name : #SRT02c41cde8a11fcf333277f2bc543eb2b0925809c,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT02c41cde8a11fcf333277f2bc543eb2b0925809c >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjE7CgoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KIApsaWJyYXJ5IFNhZmVNYXRoIHsKICAgIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgaWYgKGEgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgICAgdWludDI1NiBjID0gYSAqIGI7CiAgICAgICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICAgICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAgICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGFzc2VydChiIDw9IGEpOwogICAgICAgIHJldHVybiBhIC0gYjsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgICAgIGFzc2VydChjID49IGEpOwogICAgICAgIHJldHVybiBjOwogICAgfQp9CgoKCi8qKgogKiBAdGl0bGUgT3duYWJsZQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbgogKiAgICAgIGNvbnRyb2wgZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCiAKY29udHJhY3QgT3duYWJsZSB7CiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCiAgICAvKioKICAgICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlCiAgICAgKiAgICAgIHNlbmRlciBhY2NvdW50LgogICAgICovCiAgICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICAgKi8KICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgICAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICB9Cn0KCgoKLyoqCiAqIAogKiBAdGl0bGUgRVJDMjIzCiAqIEBkZXYgRVJDMjIzIGNvbnRyYWN0IGludGVyZmFjZSB3aXRoIEVSQzIwIGZ1bmN0aW9ucyBhbmQgZXZlbnRzCiAqICAgICAgRnVsbHkgYmFja3dhcmQgY29tcGF0aWJsZSB3aXRoIEVSQzIwCiAqICAgICAgUmVjb21tZW5kZWQgaW1wbGVtZW50YXRpb24gdXNlZCBhdCBodHRwczovL2dpdGh1Yi5jb20vRGV4YXJhbi9FUkMyMjMtdG9rZW4tc3RhbmRhcmQvdHJlZS9SZWNvbW1lbmRlZAogKi8KIApjb250cmFjdCBFUkMyMjMgewogICAgdWludCBwdWJsaWMgdG90YWxTdXBwbHk7CgogICAgLy8gRVJDMjIzIGFuZCBFUkMyMCBmdW5jdGlvbnMgYW5kIGV2ZW50cwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KTsKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBfc3VwcGx5KTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIG9rKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQgdmFsdWUsIGJ5dGVzIGRhdGEpIHB1YmxpYyByZXR1cm5zIChib29sIG9rKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQgdmFsdWUsIGJ5dGVzIGRhdGEsIHN0cmluZyBjdXN0b21GYWxsYmFjaykgcHVibGljIHJldHVybnMgKGJvb2wgb2spOwogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSwgYnl0ZXMgaW5kZXhlZCBkYXRhKTsKCiAgICAvLyBFUkMyMjMgZnVuY3Rpb25zCiAgICBmdW5jdGlvbiBuYW1lKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nIF9uYW1lKTsKICAgIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZyBfc3ltYm9sKTsKICAgIGZ1bmN0aW9uIGRlY2ltYWxzKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDggX2RlY2ltYWxzKTsKCiAgICAvLyBFUkMyMCBmdW5jdGlvbnMgYW5kIGV2ZW50cwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOwogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKTsKfQoKCgovKioKICogQHRpdGxlIENvbnRyYWN0UmVjZWl2ZXIKICogQGRldiBDb250cmFjdCB0aGF0IGlzIHdvcmtpbmcgd2l0aCBFUkMyMjMgdG9rZW5zCiAqLwogY29udHJhY3QgQ29udHJhY3RSZWNlaXZlciB7CgogICAgc3RydWN0IFRLTiB7CiAgICAgICAgYWRkcmVzcyBzZW5kZXI7CiAgICAgICAgdWludCB2YWx1ZTsKICAgICAgICBieXRlcyBkYXRhOwogICAgICAgIGJ5dGVzNCBzaWc7CiAgICB9CgogICAgZnVuY3Rpb24gdG9rZW5GYWxsYmFjayhhZGRyZXNzIF9mcm9tLCB1aW50IF92YWx1ZSwgYnl0ZXMgX2RhdGEpIHB1YmxpYyBwdXJlIHsKICAgICAgICBUS04gbWVtb3J5IHRrbjsKICAgICAgICB0a24uc2VuZGVyID0gX2Zyb207CiAgICAgICAgdGtuLnZhbHVlID0gX3ZhbHVlOwogICAgICAgIHRrbi5kYXRhID0gX2RhdGE7CiAgICAgICAgdWludDMyIHUgPSB1aW50MzIoX2RhdGFbM10pICsgKHVpbnQzMihfZGF0YVsyXSkgPDwgOCkgKyAodWludDMyKF9kYXRhWzFdKSA8PCAxNikgKyAodWludDMyKF9kYXRhWzBdKSA8PCAyNCk7CiAgICAgICAgdGtuLnNpZyA9IGJ5dGVzNCh1KTsKICAgICAgICAKICAgICAgICAvKgogICAgICAgICAqIHRrbiB2YXJpYWJsZSBpcyBhbmFsb2d1ZSBvZiBtc2cgdmFyaWFibGUgb2YgRXRoZXIgdHJhbnNhY3Rpb24KICAgICAgICAgKiB0a24uc2VuZGVyIGlzIHBlcnNvbiB3aG8gaW5pdGlhdGVkIHRoaXMgdG9rZW4gdHJhbnNhY3Rpb24gICAoYW5hbG9ndWUgb2YgbXNnLnNlbmRlcikKICAgICAgICAgKiB0a24udmFsdWUgdGhlIG51bWJlciBvZiB0b2tlbnMgdGhhdCB3ZXJlIHNlbnQgICAoYW5hbG9ndWUgb2YgbXNnLnZhbHVlKQogICAgICAgICAqIHRrbi5kYXRhIGlzIGRhdGEgb2YgdG9rZW4gdHJhbnNhY3Rpb24gICAoYW5hbG9ndWUgb2YgbXNnLmRhdGEpCiAgICAgICAgICogdGtuLnNpZyBpcyA0IGJ5dGVzIHNpZ25hdHVyZSBvZiBmdW5jdGlvbiBpZiBkYXRhIG9mIHRva2VuIHRyYW5zYWN0aW9uIGlzIGEgZnVuY3Rpb24gZXhlY3V0aW9uCiAgICAgICAgICovCiAgICB9Cn0KCgoKIApjb250cmFjdCBESEFNQVIgaXMgRVJDMjIzLCBPd25hYmxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICJESEFNQVIiOwogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAiREhBTSI7CiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IEFBY29udHJpYnV0b3JzID0gIkRoYW1hciBUb2tlbiI7CiAgICB1aW50OCBwdWJsaWMgZGVjaW1hbHMgPSA4OwogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHkgPSAzMGUzICogMWUyOwogICAgdWludDI1NiBwdWJsaWMgZGlzdHJpYnV0ZUFtb3VudCA9IDA7CiAgICBib29sIHB1YmxpYyBtaW50aW5nRmluaXNoZWQgPSBmYWxzZTsKICAgIAogICAgYWRkcmVzcyBwdWJsaWMgZm91bmRlciA9IDB4Yjk1QjE2RWJFNEJBYkQ3M2JkYjY2OTdEOWQwMEQ2NTViMGE3OTA4MzsKICAgIGFkZHJlc3MgcHVibGljIHByZVNlYXNvbkdhbWUgPSAweGI5NUIxNkViRTRCQWJENzNiZGI2Njk3RDlkMDBENjU1YjBhNzkwODM7CiAgICBhZGRyZXNzIHB1YmxpYyBhY3Rpdml0eUZ1bmRzID0gMHhiOTVCMTZFYkU0QkFiRDczYmRiNjY5N0Q5ZDAwRDY1NWIwYTc5MDgzOwogICAgYWRkcmVzcyBwdWJsaWMgbG9ja2VkRnVuZHNGb3J0aGVmdXR1cmUgPSAweGI5NUIxNkViRTRCQWJENzNiZGI2Njk3RDlkMDBENjU1YjBhNzkwODM7CgogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBiYWxhbmNlT2Y7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgcHVibGljIGFsbG93YW5jZTsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIGZyb3plbkFjY291bnQ7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyB1bmxvY2tVbml4VGltZTsKICAgIAogICAgZXZlbnQgRnJvemVuRnVuZHMoYWRkcmVzcyBpbmRleGVkIHRhcmdldCwgYm9vbCBmcm96ZW4pOwogICAgZXZlbnQgTG9ja2VkRnVuZHMoYWRkcmVzcyBpbmRleGVkIHRhcmdldCwgdWludDI1NiBsb2NrZWQpOwogICAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgdWludDI1NiBhbW91bnQpOwogICAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKICAgIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwoKCiAgICAvKiogCiAgICAgKiBAZGV2IENvbnN0cnVjdG9yIGlzIGNhbGxlZCBvbmx5IG9uY2UgYW5kIGNhbiBub3QgYmUgY2FsbGVkIGFnYWluCiAgICAgKi8KICAgIGZ1bmN0aW9uIERIQU1BUigpIHB1YmxpYyB7CiAgICAgICAgb3duZXIgPSBhY3Rpdml0eUZ1bmRzOwogICAgICAgIAogICAgICAgIGJhbGFuY2VPZltmb3VuZGVyXSA9IHRvdGFsU3VwcGx5Lm11bCgyNSkuZGl2KDEwMCk7CiAgICAgICAgYmFsYW5jZU9mW3ByZVNlYXNvbkdhbWVdID0gdG90YWxTdXBwbHkubXVsKDU1KS5kaXYoMTAwKTsKICAgICAgICBiYWxhbmNlT2ZbYWN0aXZpdHlGdW5kc10gPSB0b3RhbFN1cHBseS5tdWwoMTApLmRpdigxMDApOwogICAgICAgIGJhbGFuY2VPZltsb2NrZWRGdW5kc0ZvcnRoZWZ1dHVyZV0gPSB0b3RhbFN1cHBseS5tdWwoMTApLmRpdigxMDApOwogICAgfQoKCiAgICBmdW5jdGlvbiBuYW1lKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nIF9uYW1lKSB7CiAgICAgICAgcmV0dXJuIG5hbWU7CiAgICB9CgogICAgZnVuY3Rpb24gc3ltYm9sKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nIF9zeW1ib2wpIHsKICAgICAgICByZXR1cm4gc3ltYm9sOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlY2ltYWxzKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDggX2RlY2ltYWxzKSB7CiAgICAgICAgcmV0dXJuIGRlY2ltYWxzOwogICAgfQoKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBfdG90YWxTdXBwbHkpIHsKICAgICAgICByZXR1cm4gdG90YWxTdXBwbHk7CiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZU9mW19vd25lcl07CiAgICB9CgoKICAgIC8qKgogICAgICogQGRldiBQcmV2ZW50IHRhcmdldHMgZnJvbSBzZW5kaW5nIG9yIHJlY2VpdmluZyB0b2tlbnMKICAgICAqIEBwYXJhbSB0YXJnZXRzIEFkZHJlc3NlcyB0byBiZSBmcm96ZW4KICAgICAqIEBwYXJhbSBpc0Zyb3plbiBlaXRoZXIgdG8gZnJlZXplIGl0IG9yIG5vdAogICAgICovCiAgICBmdW5jdGlvbiBmcmVlemVBY2NvdW50cyhhZGRyZXNzW10gdGFyZ2V0cywgYm9vbCBpc0Zyb3plbikgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZSh0YXJnZXRzLmxlbmd0aCA+IDApOwoKICAgICAgICBmb3IgKHVpbnQgaiA9IDA7IGogPCB0YXJnZXRzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIHJlcXVpcmUodGFyZ2V0c1tqXSAhPSAweDApOwogICAgICAgICAgICBmcm96ZW5BY2NvdW50W3RhcmdldHNbal1dID0gaXNGcm96ZW47CiAgICAgICAgICAgIEZyb3plbkZ1bmRzKHRhcmdldHNbal0sIGlzRnJvemVuKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IFByZXZlbnQgdGFyZ2V0cyBmcm9tIHNlbmRpbmcgb3IgcmVjZWl2aW5nIHRva2VucyBieSBzZXR0aW5nIFVuaXggdGltZXMKICAgICAqIEBwYXJhbSB0YXJnZXRzIEFkZHJlc3NlcyB0byBiZSBsb2NrZWQgZnVuZHMKICAgICAqIEBwYXJhbSB1bml4VGltZXMgVW5peCB0aW1lcyB3aGVuIGxvY2tpbmcgdXAgd2lsbCBiZSBmaW5pc2hlZAogICAgICovCiAgICBmdW5jdGlvbiBsb2NrdXBBY2NvdW50cyhhZGRyZXNzW10gdGFyZ2V0cywgdWludFtdIHVuaXhUaW1lcykgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZSh0YXJnZXRzLmxlbmd0aCA+IDAKICAgICAgICAgICAgICAgICYmIHRhcmdldHMubGVuZ3RoID09IHVuaXhUaW1lcy5sZW5ndGgpOwogICAgICAgICAgICAgICAgCiAgICAgICAgZm9yKHVpbnQgaiA9IDA7IGogPCB0YXJnZXRzLmxlbmd0aDsgaisrKXsKICAgICAgICAgICAgcmVxdWlyZSh1bmxvY2tVbml4VGltZVt0YXJnZXRzW2pdXSA8IHVuaXhUaW1lc1tqXSk7CiAgICAgICAgICAgIHVubG9ja1VuaXhUaW1lW3RhcmdldHNbal1dID0gdW5peFRpbWVzW2pdOwogICAgICAgICAgICBMb2NrZWRGdW5kcyh0YXJnZXRzW2pdLCB1bml4VGltZXNbal0pOwogICAgICAgIH0KICAgIH0KCgogICAgLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIHdoZW4gYSB1c2VyIG9yIGFub3RoZXIgY29udHJhY3Qgd2FudHMgdG8gdHJhbnNmZXIgZnVuZHMKICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBieXRlcyBfZGF0YSwgc3RyaW5nIF9jdXN0b21fZmFsbGJhY2spIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXF1aXJlKF92YWx1ZSA+IDAKICAgICAgICAgICAgICAgICYmIGZyb3plbkFjY291bnRbbXNnLnNlbmRlcl0gPT0gZmFsc2UgCiAgICAgICAgICAgICAgICAmJiBmcm96ZW5BY2NvdW50W190b10gPT0gZmFsc2UKICAgICAgICAgICAgICAgICYmIG5vdyA+IHVubG9ja1VuaXhUaW1lW21zZy5zZW5kZXJdIAogICAgICAgICAgICAgICAgJiYgbm93ID4gdW5sb2NrVW5peFRpbWVbX3RvXSk7CgogICAgICAgIGlmIChpc0NvbnRyYWN0KF90bykpIHsKICAgICAgICAgICAgcmVxdWlyZShiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlKTsKICAgICAgICAgICAgYmFsYW5jZU9mW21zZy5zZW5kZXJdID0gYmFsYW5jZU9mW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgICAgICBiYWxhbmNlT2ZbX3RvXSA9IGJhbGFuY2VPZltfdG9dLmFkZChfdmFsdWUpOwogICAgICAgICAgICBhc3NlcnQoX3RvLmNhbGwudmFsdWUoMCkoYnl0ZXM0KGtlY2NhazI1NihfY3VzdG9tX2ZhbGxiYWNrKSksIG1zZy5zZW5kZXIsIF92YWx1ZSwgX2RhdGEpKTsKICAgICAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUsIF9kYXRhKTsKICAgICAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gdHJhbnNmZXJUb0FkZHJlc3MoX3RvLCBfdmFsdWUsIF9kYXRhKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXF1aXJlKF92YWx1ZSA+IDAKICAgICAgICAgICAgICAgICYmIGZyb3plbkFjY291bnRbbXNnLnNlbmRlcl0gPT0gZmFsc2UgCiAgICAgICAgICAgICAgICAmJiBmcm96ZW5BY2NvdW50W190b10gPT0gZmFsc2UKICAgICAgICAgICAgICAgICYmIG5vdyA+IHVubG9ja1VuaXhUaW1lW21zZy5zZW5kZXJdIAogICAgICAgICAgICAgICAgJiYgbm93ID4gdW5sb2NrVW5peFRpbWVbX3RvXSk7CgogICAgICAgIGlmIChpc0NvbnRyYWN0KF90bykpIHsKICAgICAgICAgICAgcmV0dXJuIHRyYW5zZmVyVG9Db250cmFjdChfdG8sIF92YWx1ZSwgX2RhdGEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiB0cmFuc2ZlclRvQWRkcmVzcyhfdG8sIF92YWx1ZSwgX2RhdGEpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgU3RhbmRhcmQgZnVuY3Rpb24gdHJhbnNmZXIgc2ltaWxhciB0byBFUkMyMCB0cmFuc2ZlciB3aXRoIG5vIF9kYXRhCiAgICAgKiAgICAgIEFkZGVkIGR1ZSB0byBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSByZWFzb25zCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoX3ZhbHVlID4gMAogICAgICAgICAgICAgICAgJiYgZnJvemVuQWNjb3VudFttc2cuc2VuZGVyXSA9PSBmYWxzZSAKICAgICAgICAgICAgICAgICYmIGZyb3plbkFjY291bnRbX3RvXSA9PSBmYWxzZQogICAgICAgICAgICAgICAgJiYgbm93ID4gdW5sb2NrVW5peFRpbWVbbXNnLnNlbmRlcl0gCiAgICAgICAgICAgICAgICAmJiBub3cgPiB1bmxvY2tVbml4VGltZVtfdG9dKTsKCiAgICAgICAgYnl0ZXMgbWVtb3J5IGVtcHR5OwogICAgICAgIGlmIChpc0NvbnRyYWN0KF90bykpIHsKICAgICAgICAgICAgcmV0dXJuIHRyYW5zZmVyVG9Db250cmFjdChfdG8sIF92YWx1ZSwgZW1wdHkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiB0cmFuc2ZlclRvQWRkcmVzcyhfdG8sIF92YWx1ZSwgZW1wdHkpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBhc3NlbWJsZSB0aGUgZ2l2ZW4gYWRkcmVzcyBieXRlY29kZS4gSWYgYnl0ZWNvZGUgZXhpc3RzIHRoZW4gdGhlIF9hZGRyIGlzIGEgY29udHJhY3QuCiAgICBmdW5jdGlvbiBpc0NvbnRyYWN0KGFkZHJlc3MgX2FkZHIpIHByaXZhdGUgdmlldyByZXR1cm5zIChib29sIGlzX2NvbnRyYWN0KSB7CiAgICAgICAgdWludCBsZW5ndGg7CiAgICAgICAgYXNzZW1ibHkgewogICAgICAgICAgICAvL3JldHJpZXZlIHRoZSBzaXplIG9mIHRoZSBjb2RlIG9uIHRhcmdldCBhZGRyZXNzLCB0aGlzIG5lZWRzIGFzc2VtYmx5CiAgICAgICAgICAgIGxlbmd0aCA6PSBleHRjb2Rlc2l6ZShfYWRkcikKICAgICAgICB9CiAgICAgICAgcmV0dXJuIChsZW5ndGggPiAwKTsKICAgIH0KCiAgICAvLyBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCB3aGVuIHRyYW5zYWN0aW9uIHRhcmdldCBpcyBhbiBhZGRyZXNzCiAgICBmdW5jdGlvbiB0cmFuc2ZlclRvQWRkcmVzcyhhZGRyZXNzIF90bywgdWludCBfdmFsdWUsIGJ5dGVzIF9kYXRhKSBwcml2YXRlIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoYmFsYW5jZU9mW21zZy5zZW5kZXJdID49IF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZU9mW21zZy5zZW5kZXJdID0gYmFsYW5jZU9mW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VPZltfdG9dID0gYmFsYW5jZU9mW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUsIF9kYXRhKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gZnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgd2hlbiB0cmFuc2FjdGlvbiB0YXJnZXQgaXMgYSBjb250cmFjdAogICAgZnVuY3Rpb24gdHJhbnNmZXJUb0NvbnRyYWN0KGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSwgYnl0ZXMgX2RhdGEpIHByaXZhdGUgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmVxdWlyZShiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPSBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZU9mW190b10gPSBiYWxhbmNlT2ZbX3RvXS5hZGQoX3ZhbHVlKTsKICAgICAgICBDb250cmFjdFJlY2VpdmVyIHJlY2VpdmVyID0gQ29udHJhY3RSZWNlaXZlcihfdG8pOwogICAgICAgIHJlY2VpdmVyLnRva2VuRmFsbGJhY2sobXNnLnNlbmRlciwgX3ZhbHVlLCBfZGF0YSk7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUsIF9kYXRhKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgoKCiAgICAvKioKICAgICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAgICogICAgICBBZGRlZCBkdWUgdG8gYmFja3dhcmRzIGNvbXBhdGliaWxpdHkgd2l0aCBFUkMyMAogICAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkKICAgICAgICAgICAgICAgICYmIF92YWx1ZSA+IDAKICAgICAgICAgICAgICAgICYmIGJhbGFuY2VPZltfZnJvbV0gPj0gX3ZhbHVlCiAgICAgICAgICAgICAgICAmJiBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZQogICAgICAgICAgICAgICAgJiYgZnJvemVuQWNjb3VudFtfZnJvbV0gPT0gZmFsc2UgCiAgICAgICAgICAgICAgICAmJiBmcm96ZW5BY2NvdW50W190b10gPT0gZmFsc2UKICAgICAgICAgICAgICAgICYmIG5vdyA+IHVubG9ja1VuaXhUaW1lW19mcm9tXSAKICAgICAgICAgICAgICAgICYmIG5vdyA+IHVubG9ja1VuaXhUaW1lW190b10pOwoKICAgICAgICBiYWxhbmNlT2ZbX2Zyb21dID0gYmFsYW5jZU9mW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlT2ZbX3RvXSA9IGJhbGFuY2VPZltfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIGFsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0gPSBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFsbG93cyBfc3BlbmRlciB0byBzcGVuZCBubyBtb3JlIHRoYW4gX3ZhbHVlIHRva2VucyBpbiB5b3VyIGJlaGFsZgogICAgICogICAgICBBZGRlZCBkdWUgdG8gYmFja3dhcmRzIGNvbXBhdGliaWxpdHkgd2l0aCBFUkMyMAogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIGF1dGhvcml6ZWQgdG8gc3BlbmQKICAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIG1heCBhbW91bnQgdGhleSBjYW4gc3BlbmQKICAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGFsbG93YW5jZVttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIKICAgICAqICAgICAgQWRkZWQgZHVlIHRvIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IHdpdGggRVJDMjAKICAgICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcwogICAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMKICAgICAqLwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgICAgIHJldHVybiBhbGxvd2FuY2VbX293bmVyXVtfc3BlbmRlcl07CiAgICB9CgoKCiAgICAvKioKICAgICAqIEBkZXYgQnVybnMgYSBzcGVjaWZpYyBhbW91bnQgb2YgdG9rZW5zLgogICAgICogQHBhcmFtIF9mcm9tIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCBidXJuIHRoZSB0b2tlbnMuCiAgICAgKiBAcGFyYW0gX3VuaXRBbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbiB0byBiZSBidXJuZWQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJ1cm4oYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdW5pdEFtb3VudCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfdW5pdEFtb3VudCA+IDAKICAgICAgICAgICAgICAgICYmIGJhbGFuY2VPZltfZnJvbV0gPj0gX3VuaXRBbW91bnQpOwoKICAgICAgICBiYWxhbmNlT2ZbX2Zyb21dID0gYmFsYW5jZU9mW19mcm9tXS5zdWIoX3VuaXRBbW91bnQpOwogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuc3ViKF91bml0QW1vdW50KTsKICAgICAgICBCdXJuKF9mcm9tLCBfdW5pdEFtb3VudCk7CiAgICB9CgoKICAgIG1vZGlmaWVyIGNhbk1pbnQoKSB7CiAgICAgICAgcmVxdWlyZSghbWludGluZ0ZpbmlzaGVkKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBtaW50IHRva2VucwogICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgbWludGVkIHRva2Vucy4KICAgICAqIEBwYXJhbSBfdW5pdEFtb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAgICovCiAgICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF91bml0QW1vdW50KSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3VuaXRBbW91bnQgPiAwKTsKICAgICAgICAKICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfdW5pdEFtb3VudCk7CiAgICAgICAgYmFsYW5jZU9mW190b10gPSBiYWxhbmNlT2ZbX3RvXS5hZGQoX3VuaXRBbW91bnQpOwogICAgICAgIE1pbnQoX3RvLCBfdW5pdEFtb3VudCk7CiAgICAgICAgVHJhbnNmZXIoYWRkcmVzcygwKSwgX3RvLCBfdW5pdEFtb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHN0b3AgbWludGluZyBuZXcgdG9rZW5zLgogICAgICovCiAgICBmdW5jdGlvbiBmaW5pc2hNaW50aW5nKCkgb25seU93bmVyIGNhbk1pbnQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBtaW50aW5nRmluaXNoZWQgPSB0cnVlOwogICAgICAgIE1pbnRGaW5pc2hlZCgpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKCgogICAgLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGRpc3RyaWJ1dGUgdG9rZW5zIHRvIHRoZSBsaXN0IG9mIGFkZHJlc3NlcyBieSB0aGUgcHJvdmlkZWQgYW1vdW50CiAgICAgKi8KICAgIGZ1bmN0aW9uIGRpc3RyaWJ1dGVBaXJkcm9wKGFkZHJlc3NbXSBhZGRyZXNzZXMsIHVpbnQyNTYgYW1vdW50KSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoYW1vdW50ID4gMCAKICAgICAgICAgICAgICAgICYmIGFkZHJlc3Nlcy5sZW5ndGggPiAwCiAgICAgICAgICAgICAgICAmJiBmcm96ZW5BY2NvdW50W21zZy5zZW5kZXJdID09IGZhbHNlCiAgICAgICAgICAgICAgICAmJiBub3cgPiB1bmxvY2tVbml4VGltZVttc2cuc2VuZGVyXSk7CgogICAgICAgIGFtb3VudCA9IGFtb3VudC5tdWwoMWU4KTsKICAgICAgICB1aW50MjU2IHRvdGFsQW1vdW50ID0gYW1vdW50Lm11bChhZGRyZXNzZXMubGVuZ3RoKTsKICAgICAgICByZXF1aXJlKGJhbGFuY2VPZlttc2cuc2VuZGVyXSA+PSB0b3RhbEFtb3VudCk7CiAgICAgICAgCiAgICAgICAgZm9yICh1aW50IGogPSAwOyBqIDwgYWRkcmVzc2VzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIHJlcXVpcmUoYWRkcmVzc2VzW2pdICE9IDB4MAogICAgICAgICAgICAgICAgICAgICYmIGZyb3plbkFjY291bnRbYWRkcmVzc2VzW2pdXSA9PSBmYWxzZQogICAgICAgICAgICAgICAgICAgICYmIG5vdyA+IHVubG9ja1VuaXhUaW1lW2FkZHJlc3Nlc1tqXV0pOwoKICAgICAgICAgICAgYmFsYW5jZU9mW2FkZHJlc3Nlc1tqXV0gPSBiYWxhbmNlT2ZbYWRkcmVzc2VzW2pdXS5hZGQoYW1vdW50KTsKICAgICAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgYWRkcmVzc2VzW2pdLCBhbW91bnQpOwogICAgICAgIH0KICAgICAgICBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPSBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0uc3ViKHRvdGFsQW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBkaXN0cmlidXRlQWlyZHJvcChhZGRyZXNzW10gYWRkcmVzc2VzLCB1aW50W10gYW1vdW50cykgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKGFkZHJlc3Nlcy5sZW5ndGggPiAwCiAgICAgICAgICAgICAgICAmJiBhZGRyZXNzZXMubGVuZ3RoID09IGFtb3VudHMubGVuZ3RoCiAgICAgICAgICAgICAgICAmJiBmcm96ZW5BY2NvdW50W21zZy5zZW5kZXJdID09IGZhbHNlCiAgICAgICAgICAgICAgICAmJiBub3cgPiB1bmxvY2tVbml4VGltZVttc2cuc2VuZGVyXSk7CiAgICAgICAgICAgICAgICAKICAgICAgICB1aW50MjU2IHRvdGFsQW1vdW50ID0gMDsKICAgICAgICAKICAgICAgICBmb3IodWludCBqID0gMDsgaiA8IGFkZHJlc3Nlcy5sZW5ndGg7IGorKyl7CiAgICAgICAgICAgIHJlcXVpcmUoYW1vdW50c1tqXSA+IDAKICAgICAgICAgICAgICAgICAgICAmJiBhZGRyZXNzZXNbal0gIT0gMHgwCiAgICAgICAgICAgICAgICAgICAgJiYgZnJvemVuQWNjb3VudFthZGRyZXNzZXNbal1dID09IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgJiYgbm93ID4gdW5sb2NrVW5peFRpbWVbYWRkcmVzc2VzW2pdXSk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGFtb3VudHNbal0gPSBhbW91bnRzW2pdLm11bCgxZTgpOwogICAgICAgICAgICB0b3RhbEFtb3VudCA9IHRvdGFsQW1vdW50LmFkZChhbW91bnRzW2pdKTsKICAgICAgICB9CiAgICAgICAgcmVxdWlyZShiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPj0gdG90YWxBbW91bnQpOwogICAgICAgIAogICAgICAgIGZvciAoaiA9IDA7IGogPCBhZGRyZXNzZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgYmFsYW5jZU9mW2FkZHJlc3Nlc1tqXV0gPSBiYWxhbmNlT2ZbYWRkcmVzc2VzW2pdXS5hZGQoYW1vdW50c1tqXSk7CiAgICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIGFkZHJlc3Nlc1tqXSwgYW1vdW50c1tqXSk7CiAgICAgICAgfQogICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSA9IGJhbGFuY2VPZlttc2cuc2VuZGVyXS5zdWIodG90YWxBbW91bnQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBjb2xsZWN0IHRva2VucyBmcm9tIHRoZSBsaXN0IG9mIGFkZHJlc3NlcwogICAgICovCiAgICBmdW5jdGlvbiBjb2xsZWN0VG9rZW5zKGFkZHJlc3NbXSBhZGRyZXNzZXMsIHVpbnRbXSBhbW91bnRzKSBvbmx5T3duZXIgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKGFkZHJlc3Nlcy5sZW5ndGggPiAwCiAgICAgICAgICAgICAgICAmJiBhZGRyZXNzZXMubGVuZ3RoID09IGFtb3VudHMubGVuZ3RoKTsKCiAgICAgICAgdWludDI1NiB0b3RhbEFtb3VudCA9IDA7CiAgICAgICAgCiAgICAgICAgZm9yICh1aW50IGogPSAwOyBqIDwgYWRkcmVzc2VzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIHJlcXVpcmUoYW1vdW50c1tqXSA+IDAKICAgICAgICAgICAgICAgICAgICAmJiBhZGRyZXNzZXNbal0gIT0gMHgwCiAgICAgICAgICAgICAgICAgICAgJiYgZnJvemVuQWNjb3VudFthZGRyZXNzZXNbal1dID09IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgJiYgbm93ID4gdW5sb2NrVW5peFRpbWVbYWRkcmVzc2VzW2pdXSk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGFtb3VudHNbal0gPSBhbW91bnRzW2pdLm11bCgxZTgpOwogICAgICAgICAgICByZXF1aXJlKGJhbGFuY2VPZlthZGRyZXNzZXNbal1dID49IGFtb3VudHNbal0pOwogICAgICAgICAgICBiYWxhbmNlT2ZbYWRkcmVzc2VzW2pdXSA9IGJhbGFuY2VPZlthZGRyZXNzZXNbal1dLnN1YihhbW91bnRzW2pdKTsKICAgICAgICAgICAgdG90YWxBbW91bnQgPSB0b3RhbEFtb3VudC5hZGQoYW1vdW50c1tqXSk7CiAgICAgICAgICAgIFRyYW5zZmVyKGFkZHJlc3Nlc1tqXSwgbXNnLnNlbmRlciwgYW1vdW50c1tqXSk7CiAgICAgICAgfQogICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSA9IGJhbGFuY2VPZlttc2cuc2VuZGVyXS5hZGQodG90YWxBbW91bnQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKCiAgICBmdW5jdGlvbiBzZXREaXN0cmlidXRlQW1vdW50KHVpbnQyNTYgX3VuaXRBbW91bnQpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGRpc3RyaWJ1dGVBbW91bnQgPSBfdW5pdEFtb3VudDsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGRpc3RyaWJ1dGUgdG9rZW5zIHRvIHRoZSBtc2cuc2VuZGVyIGF1dG9tYXRpY2FsbHkKICAgICAqICAgICAgSWYgZGlzdHJpYnV0ZUFtb3VudCBpcyAwLCB0aGlzIGZ1bmN0aW9uIGRvZXNuJ3Qgd29yawogICAgICovCiAgICBmdW5jdGlvbiBhdXRvRGlzdHJpYnV0ZSgpIHBheWFibGUgcHVibGljIHsKICAgICAgICByZXF1aXJlKGRpc3RyaWJ1dGVBbW91bnQgPiAwCiAgICAgICAgICAgICAgICAmJiBiYWxhbmNlT2ZbYWN0aXZpdHlGdW5kc10gPj0gZGlzdHJpYnV0ZUFtb3VudAogICAgICAgICAgICAgICAgJiYgZnJvemVuQWNjb3VudFttc2cuc2VuZGVyXSA9PSBmYWxzZQogICAgICAgICAgICAgICAgJiYgbm93ID4gdW5sb2NrVW5peFRpbWVbbXNnLnNlbmRlcl0pOwogICAgICAgIGlmKG1zZy52YWx1ZSA+IDApIGFjdGl2aXR5RnVuZHMudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgICAgICAKICAgICAgICBiYWxhbmNlT2ZbYWN0aXZpdHlGdW5kc10gPSBiYWxhbmNlT2ZbYWN0aXZpdHlGdW5kc10uc3ViKGRpc3RyaWJ1dGVBbW91bnQpOwogICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSA9IGJhbGFuY2VPZlttc2cuc2VuZGVyXS5hZGQoZGlzdHJpYnV0ZUFtb3VudCk7CiAgICAgICAgVHJhbnNmZXIoYWN0aXZpdHlGdW5kcywgbXNnLnNlbmRlciwgZGlzdHJpYnV0ZUFtb3VudCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGZhbGxiYWNrIGZ1bmN0aW9uCiAgICAgKi8KICAgIGZ1bmN0aW9uKCkgcGF5YWJsZSBwdWJsaWMgewogICAgICAgIGF1dG9EaXN0cmlidXRlKCk7CiAgICAgfQoKfQ=='.
	

]
