Class {
	#name : #SRT52d3ec187457a106d2ec546be4cb8a11d9be2527,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT52d3ec187457a106d2ec546be4cb8a11d9be2527 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovLy8gQHRpdGxlIEludGVyZmFjZSBmb3IgY29udHJhY3RzIGNvbmZvcm1pbmcgdG8gRVJDLTcyMTogRGVlZCBTdGFuZGFyZAovLy8gQGF1dGhvciBXaWxsaWFtIEVudHJpa2VuIChodHRwczovL3Bob3IubmV0KSwgZXQuIGFsLgovLy8gQGRldiBTcGVjaWZpY2F0aW9uIGF0IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9laXBzL1hYWEZpbmFsVXJsWFhYCmludGVyZmFjZSBFUkM3MjEgewoKICAgIC8vIENPTVBMSUFOQ0UgV0lUSCBFUkMtMTY1IChEUkFGVCkgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvLy8gQGRldiBFUkMtMTY1IChkcmFmdCkgaW50ZXJmYWNlIHNpZ25hdHVyZSBmb3IgaXRzZWxmCiAgICAvLyBieXRlczQgaW50ZXJuYWwgY29uc3RhbnQgSU5URVJGQUNFX1NJR05BVFVSRV9FUkMxNjUgPSAvLyAweDAxZmZjOWE3CiAgICAvLyAgICAgYnl0ZXM0KGtlY2NhazI1Nignc3VwcG9ydHNJbnRlcmZhY2UoYnl0ZXM0KScpKTsKCiAgICAvLy8gQGRldiBFUkMtMTY1IChkcmFmdCkgaW50ZXJmYWNlIHNpZ25hdHVyZSBmb3IgRVJDNzIxCiAgICAvLyBieXRlczQgaW50ZXJuYWwgY29uc3RhbnQgSU5URVJGQUNFX1NJR05BVFVSRV9FUkM3MjEgPSAvLyAweGRhNjcxYjliCiAgICAvLyAgICAgYnl0ZXM0KGtlY2NhazI1Nignb3duZXJPZih1aW50MjU2KScpKSBeCiAgICAvLyAgICAgYnl0ZXM0KGtlY2NhazI1NignY291bnRPZkRlZWRzKCknKSkgXgogICAgLy8gICAgIGJ5dGVzNChrZWNjYWsyNTYoJ2NvdW50T2ZEZWVkc0J5T3duZXIoYWRkcmVzcyknKSkgXgogICAgLy8gICAgIGJ5dGVzNChrZWNjYWsyNTYoJ2RlZWRPZk93bmVyQnlJbmRleChhZGRyZXNzLHVpbnQyNTYpJykpIF4KICAgIC8vICAgICBieXRlczQoa2VjY2FrMjU2KCdhcHByb3ZlKGFkZHJlc3MsdWludDI1NiknKSkgXgogICAgLy8gICAgIGJ5dGVzNChrZWNjYWsyNTYoJ3Rha2VPd25lcnNoaXAodWludDI1NiknKSk7CgogICAgLy8vIEBub3RpY2UgUXVlcnkgYSBjb250cmFjdCB0byBzZWUgaWYgaXQgc3VwcG9ydHMgYSBjZXJ0YWluIGludGVyZmFjZQogICAgLy8vIEBkZXYgUmV0dXJucyBgdHJ1ZWAgdGhlIGludGVyZmFjZSBpcyBzdXBwb3J0ZWQgYW5kIGBmYWxzZWAgb3RoZXJ3aXNlLAogICAgLy8vICByZXR1cm5zIGB0cnVlYCBmb3IgSU5URVJGQUNFX1NJR05BVFVSRV9FUkMxNjUgYW5kCiAgICAvLy8gIElOVEVSRkFDRV9TSUdOQVRVUkVfRVJDNzIxLCBzZWUgRVJDLTE2NSBmb3Igb3RoZXIgaW50ZXJmYWNlIHNpZ25hdHVyZXMuCiAgICBmdW5jdGlvbiBzdXBwb3J0c0ludGVyZmFjZShieXRlczQgX2ludGVyZmFjZUlEKSBleHRlcm5hbCBwdXJlIHJldHVybnMgKGJvb2wpOwoKICAgIC8vIFBVQkxJQyBRVUVSWSBGVU5DVElPTlMgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvLy8gQG5vdGljZSBGaW5kIHRoZSBvd25lciBvZiBhIGRlZWQKICAgIC8vLyBAcGFyYW0gX2RlZWRJZCBUaGUgaWRlbnRpZmllciBmb3IgYSBkZWVkIHdlIGFyZSBpbnNwZWN0aW5nCiAgICAvLy8gQGRldiBEZWVkcyBhc3NpZ25lZCB0byB6ZXJvIGFkZHJlc3MgYXJlIGNvbnNpZGVyZWQgaW52YWxpZCwgYW5kCiAgICAvLy8gIHF1ZXJpZXMgYWJvdXQgdGhlbSBkbyB0aHJvdy4KICAgIC8vLyBAcmV0dXJuIFRoZSBub24temVybyBhZGRyZXNzIG9mIHRoZSBvd25lciBvZiBkZWVkIGBfZGVlZElkYCwgb3IgYHRocm93YAogICAgLy8vICBpZiBkZWVkIGBfZGVlZElkYCBpcyBub3QgdHJhY2tlZCBieSB0aGlzIGNvbnRyYWN0CiAgICBmdW5jdGlvbiBvd25lck9mKHVpbnQyNTYgX2RlZWRJZCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChhZGRyZXNzIF9vd25lcik7CgogICAgLy8vIEBub3RpY2UgQ291bnQgZGVlZHMgdHJhY2tlZCBieSB0aGlzIGNvbnRyYWN0CiAgICAvLy8gQHJldHVybiBBIGNvdW50IG9mIHZhbGlkIGRlZWRzIHRyYWNrZWQgYnkgdGhpcyBjb250cmFjdCwgd2hlcmUgZWFjaCBvbmUgb2YKICAgIC8vLyAgdGhlbSBoYXMgYW4gYXNzaWduZWQgYW5kIHF1ZXJ5YWJsZSBvd25lciBub3QgZXF1YWwgdG8gdGhlIHplcm8gYWRkcmVzcwogICAgZnVuY3Rpb24gY291bnRPZkRlZWRzKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2IF9jb3VudCk7CgogICAgLy8vIEBub3RpY2UgQ291bnQgYWxsIGRlZWRzIGFzc2lnbmVkIHRvIGFuIG93bmVyCiAgICAvLy8gQGRldiBUaHJvd3MgaWYgYF9vd25lcmAgaXMgdGhlIHplcm8gYWRkcmVzcywgcmVwcmVzZW50aW5nIGludmFsaWQgZGVlZHMuCiAgICAvLy8gQHBhcmFtIF9vd25lciBBbiBhZGRyZXNzIHdoZXJlIHdlIGFyZSBpbnRlcmVzdGVkIGluIGRlZWRzIG93bmVkIGJ5IHRoZW0KICAgIC8vLyBAcmV0dXJuIFRoZSBudW1iZXIgb2YgZGVlZHMgb3duZWQgYnkgYF9vd25lcmAsIHBvc3NpYmx5IHplcm8KICAgIGZ1bmN0aW9uIGNvdW50T2ZEZWVkc0J5T3duZXIoYWRkcmVzcyBfb3duZXIpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NiBfY291bnQpOwoKICAgIC8vLyBAbm90aWNlIEVudW1lcmF0ZSBkZWVkcyBhc3NpZ25lZCB0byBhbiBvd25lcgogICAgLy8vIEBkZXYgVGhyb3dzIGlmIGBfaW5kZXhgID49IGBjb3VudE9mRGVlZHNCeU93bmVyKF9vd25lcilgIG9yIGlmCiAgICAvLy8gIGBfb3duZXJgIGlzIHRoZSB6ZXJvIGFkZHJlc3MsIHJlcHJlc2VudGluZyBpbnZhbGlkIGRlZWRzLgogICAgLy8vIEBwYXJhbSBfb3duZXIgQW4gYWRkcmVzcyB3aGVyZSB3ZSBhcmUgaW50ZXJlc3RlZCBpbiBkZWVkcyBvd25lZCBieSB0aGVtCiAgICAvLy8gQHBhcmFtIF9pbmRleCBBIGNvdW50ZXIgbGVzcyB0aGFuIGBjb3VudE9mRGVlZHNCeU93bmVyKF9vd25lcilgCiAgICAvLy8gQHJldHVybiBUaGUgaWRlbnRpZmllciBmb3IgdGhlIGBfaW5kZXhgdGggZGVlZCBhc3NpZ25lZCB0byBgX293bmVyYCwKICAgIC8vLyAgIChzb3J0IG9yZGVyIG5vdCBzcGVjaWZpZWQpCiAgICBmdW5jdGlvbiBkZWVkT2ZPd25lckJ5SW5kZXgoYWRkcmVzcyBfb3duZXIsIHVpbnQyNTYgX2luZGV4KSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYgX2RlZWRJZCk7CgogICAgLy8gVFJBTlNGRVIgTUVDSEFOSVNNIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8vLyBAZGV2IFRoaXMgZXZlbnQgZW1pdHMgd2hlbiBvd25lcnNoaXAgb2YgYW55IGRlZWQgY2hhbmdlcyBieSBhbnkKICAgIC8vLyAgbWVjaGFuaXNtLiBUaGlzIGV2ZW50IGVtaXRzIHdoZW4gZGVlZHMgYXJlIGNyZWF0ZWQgKGBmcm9tYCA9PSAwKSBhbmQKICAgIC8vLyAgZGVzdHJveWVkIChgdG9gID09IDApLiBFeGNlcHRpb246IGR1cmluZyBjb250cmFjdCBjcmVhdGlvbiwgYW55CiAgICAvLy8gIHRyYW5zZmVycyBtYXkgb2NjdXIgd2l0aG91dCBlbWl0dGluZyBgVHJhbnNmZXJgLiBBdCB0aGUgdGltZSBvZiBhbnkgdHJhbnNmZXIsCiAgICAvLy8gIHRoZSAiYXBwcm92ZWQgdGFrZXIiIGlzIGltcGxpY2l0bHkgcmVzZXQgdG8gdGhlIHplcm8gYWRkcmVzcy4KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgaW5kZXhlZCBkZWVkSWQpOwoKICAgIC8vLyBAZGV2IFRoZSBBcHByb3ZlIGV2ZW50IGVtaXRzIHRvIGxvZyB0aGUgImFwcHJvdmVkIHRha2VyIiBmb3IgYSBkZWVkIC0tIHdoZXRoZXIKICAgIC8vLyAgc2V0IGZvciB0aGUgZmlyc3QgdGltZSwgcmVhZmZpcm1lZCBieSBzZXR0aW5nIHRoZSBzYW1lIHZhbHVlLCBvciBzZXR0aW5nIHRvCiAgICAvLy8gIGEgbmV3IHZhbHVlLiBUaGUgImFwcHJvdmVkIHRha2VyIiBpcyB0aGUgemVybyBhZGRyZXNzIGlmIG5vYm9keSBjYW4gdGFrZSB0aGUKICAgIC8vLyAgZGVlZCBub3cgb3IgaXQgaXMgYW4gYWRkcmVzcyBpZiB0aGF0IGFkZHJlc3MgY2FuIGNhbGwgYHRha2VPd25lcnNoaXBgIHRvIGF0dGVtcHQKICAgIC8vLyAgdGFraW5nIHRoZSBkZWVkLiBBbnkgY2hhbmdlIHRvIHRoZSAiYXBwcm92ZWQgdGFrZXIiIGZvciBhIGRlZWQgU0hBTEwgY2F1c2UKICAgIC8vLyAgQXBwcm92ZSB0byBlbWl0LiBIb3dldmVyLCBhbiBleGNlcHRpb24sIHRoZSBBcHByb3ZlIGV2ZW50IHdpbGwgbm90IGVtaXQgd2hlbgogICAgLy8vICBUcmFuc2ZlciBlbWl0cywgdGhpcyBpcyBiZWNhdXNlIFRyYW5zZmVyIGltcGxpY2l0bHkgZGVub3RlcyB0aGUgImFwcHJvdmVkIHRha2VyIgogICAgLy8vICBpcyByZXNldCB0byB0aGUgemVybyBhZGRyZXNzLgogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgYXBwcm92ZWQsIHVpbnQyNTYgaW5kZXhlZCBkZWVkSWQpOwoKICAgIC8vLyBAbm90aWNlIFNldCB0aGUgImFwcHJvdmVkIHRha2VyIiBmb3IgeW91ciBkZWVkLCBvciByZXZva2UgYXBwcm92YWwgYnkKICAgIC8vLyAgc2V0dGluZyB0aGUgemVybyBhZGRyZXNzLiBZb3UgbWF5IGBhcHByb3ZlYCBhbnkgbnVtYmVyIG9mIHRpbWVzIHdoaWxlCiAgICAvLy8gIHRoZSBkZWVkIGlzIGFzc2lnbmVkIHRvIHlvdSwgb25seSB0aGUgbW9zdCByZWNlbnQgYXBwcm92YWwgbWF0dGVycy4gRW1pdHMKICAgIC8vLyAgYW4gQXBwcm92YWwgZXZlbnQuCiAgICAvLy8gQGRldiBUaHJvd3MgaWYgYG1zZy5zZW5kZXJgIGRvZXMgbm90IG93biBkZWVkIGBfZGVlZElkYCBvciBpZiBgX3RvYCA9PQogICAgLy8vICBgbXNnLnNlbmRlcmAgb3IgaWYgYF9kZWVkSWRgIGlzIG5vdCBhIHZhbGlkIGRlZWQuCiAgICAvLy8gQHBhcmFtIF9kZWVkSWQgVGhlIGRlZWQgZm9yIHdoaWNoIHlvdSBhcmUgZ3JhbnRpbmcgYXBwcm92YWwKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2RlZWRJZCkgZXh0ZXJuYWwgcGF5YWJsZTsKCiAgICAvLy8gQG5vdGljZSBCZWNvbWUgb3duZXIgb2YgYSBkZWVkIGZvciB3aGljaCB5b3UgYXJlIGN1cnJlbnRseSBhcHByb3ZlZAogICAgLy8vIEBkZXYgVGhyb3dzIGlmIGBtc2cuc2VuZGVyYCBpcyBub3QgYXBwcm92ZWQgdG8gYmVjb21lIHRoZSBvd25lciBvZgogICAgLy8vICBgZGVlZElkYCBvciBpZiBgbXNnLnNlbmRlcmAgY3VycmVudGx5IG93bnMgYF9kZWVkSWRgIG9yIGlmIGBfZGVlZElkIGlzIG5vdCBhCiAgICAvLy8gIHZhbGlkIGRlZWQuCiAgICAvLy8gQHBhcmFtIF9kZWVkSWQgVGhlIGRlZWQgdGhhdCBpcyBiZWluZyB0cmFuc2ZlcnJlZAogICAgZnVuY3Rpb24gdGFrZU93bmVyc2hpcCh1aW50MjU2IF9kZWVkSWQpIGV4dGVybmFsIHBheWFibGU7Cn0KCmNvbnRyYWN0IE93bmFibGUgewogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgogICAgLyoqCiAgICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAgKiBhY2NvdW50LgogICAgKi8KICAgIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAgKi8KICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgaWYgKG5ld093bmVyICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgICAgICB9CiAgICB9Cn0KCmNvbnRyYWN0IE1vbnN0ZXJBY2Nlc3NDb250cm9sIHsKICAgIGV2ZW50IENvbnRyYWN0VXBncmFkZShhZGRyZXNzIG5ld0NvbnRyYWN0KTsKCiAgICAgLy8gVGhlIGFkZHJlc3NlcyBvZiB0aGUgYWNjb3VudHMgKG9yIGNvbnRyYWN0cykgdGhhdCBjYW4gZXhlY3V0ZSBhY3Rpb25zIHdpdGhpbiBlYWNoIHJvbGVzLgogICAgYWRkcmVzcyBwdWJsaWMgYWRtaW5BZGRyZXNzOwoKICAgIC8vLyBAZGV2IEFjY2VzcyBtb2RpZmllciBmb3IgQ0VPLW9ubHkgZnVuY3Rpb25hbGl0eQogICAgbW9kaWZpZXIgb25seUFkbWluKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBhZG1pbkFkZHJlc3MpOwogICAgICAgIF87CiAgICB9Cn0KCi8vIFRoaXMgY29udHJhY3Qgc3RvcmVzIGFsbCBkYXRhIG9uIHRoZSBibG9ja2NoYWluCi8vIG9ubHkgb3VyIG90aGVyIGNvbnRyYWN0cyBjYW4gaW50ZXJhY3Qgd2l0aCB0aGlzCi8vIHRoZSBkYXRhIGhlcmUgd2lsbCBiZSB2YWxpZCBmb3IgYWxsIGV0ZXJuaXR5IGV2ZW4gaWYgb3RoZXIgY29udHJhY3RzIGdldCB1cGRhdGVkCi8vIHRoaXMgd2F5IHdlIGNhbiBtYWtlIHN1cmUgdGhhdCBvdXIgTW9uc3RlcnMgaGF2ZSBhIGhhcmQtY29kZWQgdmFsdWUgYXR0YWNoZWQgdG8gdGhlbQovLyB0aGF0IG5vIG9uZSBpbmNsdWRpbmcgdXMgY2FuIGNoYW5nZSghKQpjb250cmFjdCBNb25zdGVyc0RhdGEgewogICAgYWRkcmVzcyBjb3JlQ29udHJhY3Q7CgogICAgc3RydWN0IE1vbnN0ZXIgewogICAgICAgIC8vIHRpbWVzdGFtcCBvZiBibG9jayB3aGVuIHRoaXMgbW9uc3RlciB3YXMgc3Bhd25lZC9jcmVhdGVkCiAgICAgICAgdWludDY0IGJpcnRoVGltZTsKCiAgICAgICAgLy8gZ2VuZXJhdGlvbiBudW1iZXIKICAgICAgICAvLyBnZW4wIGlzIHRoZSB2ZXJ5IGZpcnN0IGdlbmVyYXRpb24gLSB0aGUgbGF0ZXIgbW9uc3RlciBzcGF3biB0aGUgbGVzcyBsaWtlbHkgdGhleSBhcmUgdG8gaGF2ZQogICAgICAgIC8vIHNwZWNpYWwgYXR0cmlidXRlcyBhbmQgc3RhdHMKICAgICAgICB1aW50MTYgZ2VuZXJhdGlvbjsKCiAgICAgICAgdWludDE2IG1JRDsgLy8gdGhpcyBpZCAoZnJvbSAxIHRvIDE1MSkgaXMgcmVzcG9uc2libGUgZm9yIGV2ZXJ5dGhpbmcgdmlzdWFsbHkgbGlrZSBzaG93aW5nIHRoZSByZWFsIGRlYWwhCiAgICAgICAgYm9vbCB0cmFkZWFibGU7CgogICAgICAgIC8vIGJyZWVkaW5nCiAgICAgICAgYm9vbCBmZW1hbGU7CgogICAgICAgIC8vIGlzIHRoaXMgbW9uc3RlciBleGNlcHRpb25hbGx5IHJhcmU/CiAgICAgICAgYm9vbCBzaGlueTsKICAgIH0KCiAgICAvLyBsdjEgYmFzZSBzdGF0cwogICAgc3RydWN0IE1vbnN0ZXJCYXNlU3RhdHMgewogICAgICAgIHVpbnQxNiBocDsKICAgICAgICB1aW50MTYgYXR0YWNrOwogICAgICAgIHVpbnQxNiBkZWZlbnNlOwogICAgICAgIHVpbnQxNiBzcEF0dGFjazsKICAgICAgICB1aW50MTYgc3BEZWZlbnNlOwogICAgICAgIHVpbnQxNiBzcGVlZDsKICAgIH0KCiAgICBzdHJ1Y3QgVHJhaW5lciB7CiAgICAgICAgLy8gdGltZXN0YW1wIG9mIGJsb2NrIHdoZW4gdGhpcyBwbGF5ZXIvdHJhaW5lciB3YXMgY3JlYXRlZAogICAgICAgIHVpbnQ2NCBiaXJ0aFRpbWU7CgogICAgICAgIC8vIGFkZCB1c2VybmFtZQogICAgICAgIHN0cmluZyB1c2VybmFtZTsKCiAgICAgICAgLy8gY3VycmVudCBhcmVhIGluIHRoZSAid29ybGQiCiAgICAgICAgdWludDE2IGN1cnJBcmVhOwoKICAgICAgICBhZGRyZXNzIG93bmVyOwogICAgfQoKICAgIC8vIHRha2UgdGltZXN0YW1wIG9mIGJsb2NrIHRoaXMgZ2FtZSB3YXMgY3JlYXRlZCBvbiB0aGUgYmxvY2tjaGFpbgogICAgdWludDY0IGNyZWF0aW9uQmxvY2sgPSB1aW50NjQobm93KTsKfQoKY29udHJhY3QgTW9uc3RlcnNCYXNlIGlzIE1vbnN0ZXJBY2Nlc3NDb250cm9sLCBNb25zdGVyc0RhdGEgewogICAgLy8vIEBkZXYgVHJhbnNmZXIgZXZlbnQgYXMgZGVmaW5lZCBpbiBjdXJyZW50IGRyYWZ0IG9mIEVSQzcyMS4gRW1pdHRlZCBldmVyeSB0aW1lIGEgbW9uc3RlcgogICAgLy8vICBvd25lcnNoaXAgaXMgYXNzaWduZWQsIGluY2x1ZGluZyBiaXJ0aHMuCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdG9rZW5JZCk7CgogICAgYm9vbCBsb2NrZWRNb25zdGVyQ3JlYXRvciA9IGZhbHNlOwoKICAgIE1vbnN0ZXJBdWN0aW9uIHB1YmxpYyBtb25zdGVyQXVjdGlvbjsKICAgIE1vbnN0ZXJDcmVhdG9ySW50ZXJmYWNlIHB1YmxpYyBtb25zdGVyQ3JlYXRvcjsKCiAgICBmdW5jdGlvbiBzZXRNb25zdGVyQ3JlYXRvckFkZHJlc3MoYWRkcmVzcyBfYWRkcmVzcykgZXh0ZXJuYWwgb25seUFkbWluIHsKICAgICAgICAvLyBvbmx5IHNldCB0aGlzIG9uY2Ugc28gd2UgKHRoZSBkZXZzKSBjYW4ndCBjaGVhdCEKICAgICAgICByZXF1aXJlKCFsb2NrZWRNb25zdGVyQ3JlYXRvcik7CiAgICAgICAgTW9uc3RlckNyZWF0b3JJbnRlcmZhY2UgY2FuZGlkYXRlQ29udHJhY3QgPSBNb25zdGVyQ3JlYXRvckludGVyZmFjZShfYWRkcmVzcyk7CgogICAgICAgIG1vbnN0ZXJDcmVhdG9yID0gY2FuZGlkYXRlQ29udHJhY3Q7CiAgICAgICAgbG9ja2VkTW9uc3RlckNyZWF0b3IgPSB0cnVlOwogICAgfQoKICAgIC8vIEFuIGFwcHJveGltYXRpb24gb2YgY3VycmVudGx5IGhvdyBtYW55IHNlY29uZHMgYXJlIGluIGJldHdlZW4gYmxvY2tzLgogICAgdWludDI1NiBwdWJsaWMgc2Vjb25kc1BlckJsb2NrID0gMTU7CgogICAgLy8gYXJyYXkgY29udGFpbmluZyBhbGwgbW9uc3RlcnMgaW4gZXhpc3RlbmNlCiAgICBNb25zdGVyW10gbW9uc3RlcnM7CgogICAgdWludDhbXSBhcmVhczsKICAgIHVpbnQ4IGFyZWFJbmRleCA9IDA7CgogICAgbWFwcGluZyhhZGRyZXNzID0+IFRyYWluZXIpIHB1YmxpYyBhZGRyZXNzVG9UcmFpbmVyOwogICAgLy8vIEBkZXYgQSBtYXBwaW5nIGZyb20gbW9uc3RlciBJRHMgdG8gdGhlIGFkZHJlc3MgdGhhdCBvd25zIHRoZW0uIEFsbCBtb25zdGVyIGhhdmUKICAgIC8vLyAgc29tZSB2YWxpZCBvd25lciBhZGRyZXNzLCBldmVuIGdlbjAgbW9uc3RlciBhcmUgY3JlYXRlZCB3aXRoIGEgbm9uLXplcm8gb3duZXIuCiAgICBtYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIHB1YmxpYyBtb25zdGVySW5kZXhUb093bmVyOwogICAgLy8gQGRldiBBIG1hcHBpbmcgZnJvbSBvd25lciBhZGRyZXNzIHRvIGNvdW50IG9mIHRva2VucyB0aGF0IGFkZHJlc3Mgb3ducy4KICAgIC8vIFVzZWQgaW50ZXJuYWxseSBpbnNpZGUgYmFsYW5jZU9mKCkgdG8gcmVzb2x2ZSBvd25lcnNoaXAgY291bnQuCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIG93bmVyc2hpcFRva2VuQ291bnQ7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIHB1YmxpYyBtb25zdGVySW5kZXhUb0FwcHJvdmVkOwogICAgbWFwcGluZyAodWludDI1NiA9PiBzdHJpbmcpIHB1YmxpYyBtb25zdGVySWRUb05pY2tuYW1lOwogICAgbWFwcGluZyAodWludDI1NiA9PiBib29sKSBwdWJsaWMgbW9uc3RlcklkVG9UcmFkZWFibGU7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IHVpbnQyNTYpIHB1YmxpYyBtb25zdGVySWRUb0dlbmVyYXRpb247CiAgICAKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gdWludDhbN10pIHB1YmxpYyBtb25zdGVySWRUb0lWczsKCiAgICAvLyBhZGRzIG5ldyBhcmVhIHRvIHdvcmxkCiAgICBmdW5jdGlvbiBfY3JlYXRlQXJlYSgpIGludGVybmFsIHsKICAgICAgICBhcmVhSW5kZXgrKzsKICAgICAgICBhcmVhcy5wdXNoKGFyZWFJbmRleCk7CiAgICB9CgogICAgZnVuY3Rpb24gX2NyZWF0ZU1vbnN0ZXIodWludDI1NiBfZ2VuZXJhdGlvbiwgYWRkcmVzcyBfb3duZXIsIHVpbnQyNTYgX21JRCwgYm9vbCBfdHJhZGVhYmxlLAogICAgICAgIGJvb2wgX2ZlbWFsZSwgYm9vbCBfc2hpbnkpIGludGVybmFsIHJldHVybnMgKHVpbnQpCiAgICB7CgogICAgICAgIE1vbnN0ZXIgbWVtb3J5IF9tb25zdGVyID0gTW9uc3Rlcih7CiAgICAgICAgICAgIGdlbmVyYXRpb246IHVpbnQxNihfZ2VuZXJhdGlvbiksCiAgICAgICAgICAgIGJpcnRoVGltZTogdWludDY0KG5vdyksCiAgICAgICAgICAgIG1JRDogdWludDE2KF9tSUQpLAogICAgICAgICAgICB0cmFkZWFibGU6IF90cmFkZWFibGUsCiAgICAgICAgICAgIGZlbWFsZTogX2ZlbWFsZSwKICAgICAgICAgICAgc2hpbnk6IF9zaGlueQogICAgICAgIH0pOwoKICAgICAgICB1aW50MjU2IG5ld01vbnN0ZXJJZCA9IG1vbnN0ZXJzLnB1c2goX21vbnN0ZXIpIC0gMTsKCiAgICAgICAgcmVxdWlyZShuZXdNb25zdGVySWQgPT0gdWludDI1Nih1aW50MzIobmV3TW9uc3RlcklkKSkpOwoKICAgICAgICBtb25zdGVySWRUb05pY2tuYW1lW25ld01vbnN0ZXJJZF0gPSAiIjsKCiAgICAgICAgX3RyYW5zZmVyKDAsIF9vd25lciwgbmV3TW9uc3RlcklkKTsKCiAgICAgICAgcmV0dXJuIG5ld01vbnN0ZXJJZDsKICAgIH0KCiAgICBmdW5jdGlvbiBfY3JlYXRlVHJhaW5lcihzdHJpbmcgX3VzZXJuYW1lLCB1aW50MTYgX3N0YXJ0ZXJJZCwgYWRkcmVzcyBfb3duZXIpIGludGVybmFsIHJldHVybnMgKHVpbnQgbW9uKSB7CiAgICAgICAgVHJhaW5lciBtZW1vcnkgX3RyYWluZXIgPSBUcmFpbmVyKHsKICAgICAgICAgICAgYmlydGhUaW1lOiB1aW50NjQobm93KSwKICAgICAgICAgICAgdXNlcm5hbWU6IHN0cmluZyhfdXNlcm5hbWUpLAogICAgICAgICAgICAgLy8gc2V0cyB0byBmaXJzdCBhcmVhISwKICAgICAgICAgICAgY3VyckFyZWE6IHVpbnQxNigxKSwKICAgICAgICAgICAgb3duZXI6IGFkZHJlc3MoX293bmVyKQogICAgICAgIH0pOwoKICAgICAgICBhZGRyZXNzVG9UcmFpbmVyW19vd25lcl0gPSBfdHJhaW5lcjsKCiAgICAgICAgYm9vbCBnZW5kZXIgPSBtb25zdGVyQ3JlYXRvci5nZXRNb25zdGVyR2VuZGVyKCk7CgogICAgICAgIC8vIHN0YXJ0ZXJzIGNhbm5vdCBiZSB0cmFkZWQgYW5kIGFyZSBub3Qgc2hpbnkKICAgICAgICBpZiAoX3N0YXJ0ZXJJZCA9PSAxKSB7CiAgICAgICAgICAgIG1vbiA9IF9jcmVhdGVNb25zdGVyKDAsIF9vd25lciwgMSwgZmFsc2UsIGdlbmRlciwgZmFsc2UpOwogICAgICAgIH0gZWxzZSBpZiAoX3N0YXJ0ZXJJZCA9PSAyKSB7CiAgICAgICAgICAgIG1vbiA9IF9jcmVhdGVNb25zdGVyKDAsIF9vd25lciwgNCwgZmFsc2UsIGdlbmRlciwgZmFsc2UpOwogICAgICAgIH0gZWxzZSBpZiAoX3N0YXJ0ZXJJZCA9PSAzKSB7CiAgICAgICAgICAgIG1vbiA9IF9jcmVhdGVNb25zdGVyKDAsIF9vd25lciwgNywgZmFsc2UsIGdlbmRlciwgZmFsc2UpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBfbW92ZVRvQXJlYSh1aW50MTYgX25ld0FyZWEsIGFkZHJlc3MgcGxheWVyKSBpbnRlcm5hbCB7CiAgICAgICAgYWRkcmVzc1RvVHJhaW5lcltwbGF5ZXJdLmN1cnJBcmVhID0gX25ld0FyZWE7CiAgICB9CgogICAgLy8gYXNzaWducyBvd25lcnNoaXAgb2YgbW9uc3RlciB0byBhZGRyZXNzCiAgICBmdW5jdGlvbiBfdHJhbnNmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIGludGVybmFsIHsKICAgICAgICBvd25lcnNoaXBUb2tlbkNvdW50W190b10rKzsKICAgICAgICBtb25zdGVySW5kZXhUb093bmVyW190b2tlbklkXSA9IF90bzsKCiAgICAgICAgaWYgKF9mcm9tICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgb3duZXJzaGlwVG9rZW5Db3VudFtfZnJvbV0tLTsKCiAgICAgICAgICAgIC8vIGNsZWFyIGFueSBwcmV2aW91c2x5IGFwcHJvdmVkIG93bmVyc2hpcCBleGNoYW5nZQogICAgICAgICAgICBkZWxldGUgbW9uc3RlckluZGV4VG9BcHByb3ZlZFtfdG9rZW5JZF07CiAgICAgICAgfQoKICAgICAgICAvLyBFbWl0IFRyYW5zZmVyIGV2ZW50CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogICAgfQoKICAgIC8vIE9ubHkgYWRtaW4gY2FuIGZpeCBob3cgbWFueSBzZWNvbmRzIHBlciBibG9ja3MgYXJlIGN1cnJlbnRseSBvYnNlcnZlZC4KICAgIGZ1bmN0aW9uIHNldFNlY29uZHNQZXJCbG9jayh1aW50MjU2IHNlY3MpIGV4dGVybmFsIG9ubHlBZG1pbiB7CiAgICAgICAgLy9yZXF1aXJlKHNlY3MgPCBjb29sZG93bnNbMF0pOwogICAgICAgIHNlY29uZHNQZXJCbG9jayA9IHNlY3M7CiAgICB9Cn0KCmNvbnRyYWN0IE1vbnN0ZXJPd25lcnNoaXAgaXMgTW9uc3RlcnNCYXNlLCBFUkM3MjEgewogICAgZnVuY3Rpb24gX293bnMoYWRkcmVzcyBfY2xhaW1hbnQsIHVpbnQyNTYgX3Rva2VuSWQpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBtb25zdGVySW5kZXhUb093bmVyW190b2tlbklkXSA9PSBfY2xhaW1hbnQ7CiAgICB9CgogICAgZnVuY3Rpb24gX2lzVHJhZGVhYmxlKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gbW9uc3RlcklkVG9UcmFkZWFibGVbX3Rva2VuSWRdOwogICAgfQoKICAgIC8vLyBAZGV2IENoZWNrcyBpZiBhIGdpdmVuIGFkZHJlc3MgY3VycmVudGx5IGhhcyB0cmFuc2ZlckFwcHJvdmFsIGZvciBhIHBhcnRpY3VsYXIgbW9uc3Rlci4KICAgIC8vLyBAcGFyYW0gX2NsYWltYW50IHRoZSBhZGRyZXNzIHdlIGFyZSBjb25maXJtaW5nIG1vbnN0ZXIgaXMgYXBwcm92ZWQgZm9yLgogICAgLy8vIEBwYXJhbSBfdG9rZW5JZCBtb25zdGVyIGlkLCBvbmx5IHZhbGlkIHdoZW4gPiAwCiAgICBmdW5jdGlvbiBfYXBwcm92ZWRGb3IoYWRkcmVzcyBfY2xhaW1hbnQsIHVpbnQyNTYgX3Rva2VuSWQpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBtb25zdGVySW5kZXhUb0FwcHJvdmVkW190b2tlbklkXSA9PSBfY2xhaW1hbnQ7CiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGNvdW50KSB7CiAgICAgICAgcmV0dXJuIG93bmVyc2hpcFRva2VuQ291bnRbX293bmVyXTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIHBheWFibGUgewogICAgICAgIHRyYW5zZmVyRnJvbShtc2cuc2VuZGVyLCBfdG8sIF90b2tlbklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKG1vbnN0ZXJJZFRvVHJhZGVhYmxlW190b2tlbklkXSk7CiAgICAgICAgLy8gU2FmZXR5IGNoZWNrIHRvIHByZXZlbnQgYWdhaW5zdCBhbiB1bmV4cGVjdGVkIDB4MCBkZWZhdWx0LgogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIC8vIERpc2FsbG93IHRyYW5zZmVycyB0byB0aGlzIGNvbnRyYWN0IHRvIHByZXZlbnQgYWNjaWRlbnRhbCBtaXN1c2UuCiAgICAgICAgLy8gVGhlIGNvbnRyYWN0IHNob3VsZCBuZXZlciBvd24gYW55IG1vbnN0ZXJzIChleGNlcHQgdmVyeSBicmllZmx5CiAgICAgICAgLy8gYWZ0ZXIgYSBnZW4wIG1vbnN0ZXIgaXMgY3JlYXRlZCBhbmQgYmVmb3JlIGl0IGdvZXMgb24gYXVjdGlvbikuCiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcyh0aGlzKSk7CiAgICAgICAgLy8gQ2hlY2sgZm9yIGFwcHJvdmFsIGFuZCB2YWxpZCBvd25lcnNoaXAKICAgICAgICAKICAgICAgICByZXF1aXJlKF9vd25zKF9mcm9tLCBfdG9rZW5JZCkpOwogICAgICAgIC8vIGNoZWNrcyBpZiBfdG8gd2FzIGFwcm92ZWQKICAgICAgICByZXF1aXJlKF9mcm9tID09IG1zZy5zZW5kZXIgfHwgbXNnLnNlbmRlciA9PSBhZGRyZXNzKG1vbnN0ZXJBdWN0aW9uKSB8fCBfYXBwcm92ZWRGb3IoX3RvLCBfdG9rZW5JZCkpOwoKICAgICAgICAvLyBSZWFzc2lnbiBvd25lcnNoaXAgKGFsc28gY2xlYXJzIHBlbmRpbmcgYXBwcm92YWxzIGFuZCBlbWl0cyBUcmFuc2ZlciBldmVudCkuCiAgICAgICAgX3RyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gbW9uc3RlcnMubGVuZ3RoOwogICAgfQoKICAgIGZ1bmN0aW9uIHRva2Vuc09mT3duZXIoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTZbXSBvd25lclRva2VucykgewogICAgICAgIHVpbnQyNTYgdG9rZW5Db3VudCA9IGJhbGFuY2VPZihfb3duZXIpOwoKICAgICAgICBpZiAodG9rZW5Db3VudCA+IDApIHsKICAgICAgICAgICAgdWludDI1NltdIG1lbW9yeSByZXN1bHQgPSBuZXcgdWludDI1NltdKHRva2VuQ291bnQpOwogICAgICAgICAgICB1aW50MjU2IHRvdGFsTW9uc3RlcnMgPSB0b3RhbFN1cHBseSgpOwogICAgICAgICAgICB1aW50MjU2IHJlc3VsdEluZGV4ID0gMDsKCiAgICAgICAgICAgIHVpbnQyNTYgbW9uc3RlcklkOwoKICAgICAgICAgICAgZm9yIChtb25zdGVySWQgPSAwOyBtb25zdGVySWQgPD0gdG90YWxNb25zdGVyczsgbW9uc3RlcklkKyspIHsKICAgICAgICAgICAgICAgIGlmIChtb25zdGVySW5kZXhUb093bmVyW21vbnN0ZXJJZF0gPT0gX293bmVyKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3Jlc3VsdEluZGV4XSA9IG1vbnN0ZXJJZDsKICAgICAgICAgICAgICAgICAgICByZXN1bHRJbmRleCsrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG5ldyB1aW50MjU2W10oMCk7CiAgICB9CgogICAgYnl0ZXM0IGludGVybmFsIGNvbnN0YW50IElOVEVSRkFDRV9TSUdOQVRVUkVfRVJDMTY1ID0KICAgICAgICBieXRlczQoa2VjY2FrMjU2KCJzdXBwb3J0c0ludGVyZmFjZShieXRlczQpIikpOwoKICAgIGJ5dGVzNCBpbnRlcm5hbCBjb25zdGFudCBJTlRFUkZBQ0VfU0lHTkFUVVJFX0VSQzcyMSA9CiAgICAgICAgYnl0ZXM0KGtlY2NhazI1Nigib3duZXJPZih1aW50MjU2KSIpKSBeCiAgICAgICAgYnl0ZXM0KGtlY2NhazI1NigiY291bnRPZkRlZWRzKCkiKSkgXgogICAgICAgIGJ5dGVzNChrZWNjYWsyNTYoImNvdW50T2ZEZWVkc0J5T3duZXIoYWRkcmVzcykiKSkgXgogICAgICAgIGJ5dGVzNChrZWNjYWsyNTYoImRlZWRPZk93bmVyQnlJbmRleChhZGRyZXNzLHVpbnQyNTYpIikpIF4KICAgICAgICBieXRlczQoa2VjY2FrMjU2KCJhcHByb3ZlKGFkZHJlc3MsdWludDI1NikiKSkgXgogICAgICAgIGJ5dGVzNChrZWNjYWsyNTYoInRha2VPd25lcnNoaXAodWludDI1NikiKSk7CgogICAgZnVuY3Rpb24gc3VwcG9ydHNJbnRlcmZhY2UoYnl0ZXM0IF9pbnRlcmZhY2VJRCkgZXh0ZXJuYWwgcHVyZSByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIF9pbnRlcmZhY2VJRCA9PSBJTlRFUkZBQ0VfU0lHTkFUVVJFX0VSQzE2NSB8fCBfaW50ZXJmYWNlSUQgPT0gSU5URVJGQUNFX1NJR05BVFVSRV9FUkM3MjE7CiAgICB9CgogICAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF9kZWVkSWQpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBfb3duZXIpIHsKICAgICAgICB2YXIgb3duZXIgPSBtb25zdGVySW5kZXhUb093bmVyW19kZWVkSWRdOwogICAgICAgIHJlcXVpcmUob3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmV0dXJuIG93bmVyOwogICAgfQoKICAgIGZ1bmN0aW9uIF9hcHByb3ZlKHVpbnQyNTYgX3Rva2VuSWQsIGFkZHJlc3MgX2FwcHJvdmVkKSBpbnRlcm5hbCB7CiAgICAgICAgbW9uc3RlckluZGV4VG9BcHByb3ZlZFtfdG9rZW5JZF0gPSBfYXBwcm92ZWQ7CiAgICB9CgogICAgZnVuY3Rpb24gY291bnRPZkRlZWRzKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2IF9jb3VudCkgewogICAgICAgIHJldHVybiB0b3RhbFN1cHBseSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNvdW50T2ZEZWVkc0J5T3duZXIoYWRkcmVzcyBfb3duZXIpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NiBfY291bnQpIHsKICAgICAgICB2YXIgYXJyID0gdG9rZW5zT2ZPd25lcihfb3duZXIpOwogICAgICAgIHJldHVybiBhcnIubGVuZ3RoOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlZWRPZk93bmVyQnlJbmRleChhZGRyZXNzIF9vd25lciwgdWludDI1NiBfaW5kZXgpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NiBfZGVlZElkKSB7CiAgICAgICAgcmV0dXJuIHRva2Vuc09mT3duZXIoX293bmVyKVtfaW5kZXhdOwogICAgfQoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsIHBheWFibGUgewogICAgICAgIC8vIE9ubHkgYW4gb3duZXIgY2FuIGdyYW50IHRyYW5zZmVyIGFwcHJvdmFsLgogICAgICAgIHJlcXVpcmUoX293bnMobXNnLnNlbmRlciwgX3Rva2VuSWQpKTsKCiAgICAgICAgLy8gUmVnaXN0ZXIgdGhlIGFwcHJvdmFsIChyZXBsYWNpbmcgYW55IHByZXZpb3VzIGFwcHJvdmFsKS4KICAgICAgICBtb25zdGVySW5kZXhUb0FwcHJvdmVkW190b2tlbklkXSA9IF90bzsKCiAgICAgICAgLy8gRW1pdCBhcHByb3ZhbCBldmVudC4KICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfdG8sIF90b2tlbklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0YWtlT3duZXJzaGlwKHVpbnQyNTYgX2RlZWRJZCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgdHJhbnNmZXJGcm9tKHRoaXMub3duZXJPZihfZGVlZElkKSwgbXNnLnNlbmRlciwgX2RlZWRJZCk7CiAgICB9Cn0KCmNvbnRyYWN0IE1vbnN0ZXJBdWN0aW9uQmFzZSB7CgogICAgLy8gUmVmZXJlbmNlIHRvIGNvbnRyYWN0IHRyYWNraW5nIE5GVCBvd25lcnNoaXAKICAgIE1vbnN0ZXJPd25lcnNoaXAgcHVibGljIG5vbkZ1bmdpYmxlQ29udHJhY3Q7CiAgICBDaGFpbk1vbnN0ZXJzQ29yZSBwdWJsaWMgY29yZTsKCiAgICBzdHJ1Y3QgQXVjdGlvbiB7CiAgICAgICAgLy8gY3VycmVudCBvd25lcgogICAgICAgIGFkZHJlc3Mgc2VsbGVyOwogICAgICAgIC8vIHByaWNlIGluIHdlaQogICAgICAgIHVpbnQyNTYgcHJpY2U7CiAgICAgICAgLy8gdGltZSB3aGVuIGF1Y3Rpb24gc3RhcnRlZAogICAgICAgIHVpbnQ2NCBzdGFydGVkQXQ7CiAgICAgICAgdWludDI1NiBpZDsKICAgIH0KCiAgICAvLyBDdXQgb3duZXIgdGFrZXMgb24gZWFjaCBhdWN0aW9uLCBtZWFzdXJlZCBpbiBiYXNpcyBwb2ludHMgKDEvMTAwIG9mIGEgcGVyY2VudCkuCiAgICAvLyBWYWx1ZXMgMC0xMCwwMDAgbWFwIHRvIDAlLTEwMCUKICAgIHVpbnQyNTYgcHVibGljIG93bmVyQ3V0OwoKICAgIC8vIE1hcCBmcm9tIHRva2VuIElEIHRvIHRoZWlyIGNvcnJlc3BvbmRpbmcgYXVjdGlvbi4KICAgIG1hcHBpbmcodWludDI1NiA9PiBBdWN0aW9uKSB0b2tlbklkVG9BdWN0aW9uOwogICAgbWFwcGluZyh1aW50MjU2ID0+IGFkZHJlc3MpIHB1YmxpYyBhdWN0aW9uSWRUb1NlbGxlcjsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIG93bmVyc2hpcEF1Y3Rpb25Db3VudDsKCiAgICBldmVudCBBdWN0aW9uQ3JlYXRlZCh1aW50MjU2IHRva2VuSWQsIHVpbnQyNTYgcHJpY2UsIHVpbnQyNTYgdUlELCBhZGRyZXNzIHNlbGxlcik7CiAgICBldmVudCBBdWN0aW9uU3VjY2Vzc2Z1bCh1aW50MjU2IHRva2VuSWQsIHVpbnQyNTYgcHJpY2UsIGFkZHJlc3MgbmV3T3duZXIsIHVpbnQyNTYgdUlEKTsKICAgIGV2ZW50IEF1Y3Rpb25DYW5jZWxsZWQodWludDI1NiB0b2tlbklkLCB1aW50MjU2IHVJRCk7CgogICAgZnVuY3Rpb24gX3RyYW5zZmVyKGFkZHJlc3MgX3JlY2VpdmVyLCB1aW50MjU2IF90b2tlbklkKSBpbnRlcm5hbCB7CiAgICAgICAgLy8gaXQgd2lsbCB0aHJvdyBpZiB0cmFuc2ZlciBmYWlscwogICAgICAgIG5vbkZ1bmdpYmxlQ29udHJhY3QudHJhbnNmZXIoX3JlY2VpdmVyLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gX2FkZEF1Y3Rpb24odWludDI1NiBfdG9rZW5JZCwgQXVjdGlvbiBfYXVjdGlvbikgaW50ZXJuYWwgewogICAgICAgIHRva2VuSWRUb0F1Y3Rpb25bX3Rva2VuSWRdID0gX2F1Y3Rpb247CgogICAgICAgIEF1Y3Rpb25DcmVhdGVkKAogICAgICAgICAgICB1aW50MjU2KF90b2tlbklkKSwKICAgICAgICAgICAgdWludDI1NihfYXVjdGlvbi5wcmljZSksCiAgICAgICAgICAgIHVpbnQyNTYoX2F1Y3Rpb24uaWQpLAogICAgICAgICAgICBhZGRyZXNzKF9hdWN0aW9uLnNlbGxlcikKICAgICAgICApOwogICAgfQoKICAgIGZ1bmN0aW9uIF9jYW5jZWxBdWN0aW9uKHVpbnQyNTYgX3Rva2VuSWQsIGFkZHJlc3MgX3NlbGxlcikgaW50ZXJuYWwgewogICAgICAgIEF1Y3Rpb24gc3RvcmFnZSBfYXVjdGlvbiA9IHRva2VuSWRUb0F1Y3Rpb25bX3Rva2VuSWRdOwoKICAgICAgICB1aW50MjU2IHVJRCA9IF9hdWN0aW9uLmlkOwoKICAgICAgICBfcmVtb3ZlQXVjdGlvbihfdG9rZW5JZCk7CiAgICAgICAgb3duZXJzaGlwQXVjdGlvbkNvdW50W19zZWxsZXJdLS07CiAgICAgICAgX3RyYW5zZmVyKF9zZWxsZXIsIF90b2tlbklkKTsKCiAgICAgICAgQXVjdGlvbkNhbmNlbGxlZChfdG9rZW5JZCwgdUlEKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfYnV5KHVpbnQyNTYgX3Rva2VuSWQsIHVpbnQyNTYgX2JpZEFtb3VudCkgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgICAgIEF1Y3Rpb24gc3RvcmFnZSBhdWN0aW9uID0gdG9rZW5JZFRvQXVjdGlvbltfdG9rZW5JZF07CgogICAgICAgIHJlcXVpcmUoX2lzT25BdWN0aW9uKGF1Y3Rpb24pKTsKCiAgICAgICAgdWludDI1NiBwcmljZSA9IGF1Y3Rpb24ucHJpY2U7CiAgICAgICAgcmVxdWlyZShfYmlkQW1vdW50ID49IHByaWNlKTsKCiAgICAgICAgYWRkcmVzcyBzZWxsZXIgPSBhdWN0aW9uLnNlbGxlcjsKICAgICAgICB1aW50MjU2IHVJRCA9IGF1Y3Rpb24uaWQ7CgogICAgICAgIC8vIEF1Y3Rpb24gQmlkIGxvb2tzIGZpbmUhIHNvIHJlbW92ZQogICAgICAgIF9yZW1vdmVBdWN0aW9uKF90b2tlbklkKTsKCiAgICAgICAgb3duZXJzaGlwQXVjdGlvbkNvdW50W3NlbGxlcl0tLTsKCiAgICAgICAgaWYgKHByaWNlID4gMCkgewogICAgICAgICAgICB1aW50MjU2IGF1Y3Rpb25lZXJDdXQgPSBfY29tcHV0ZUN1dChwcmljZSk7CiAgICAgICAgICAgIHVpbnQyNTYgc2VsbGVyUHJvY2VlZHMgPSBwcmljZSAtIGF1Y3Rpb25lZXJDdXQ7CgogICAgICAgICAgICAvLyBOT1RFOiBEb2luZyBhIHRyYW5zZmVyKCkgaW4gdGhlIG1pZGRsZSBvZiBhIGNvbXBsZXgKICAgICAgICAgICAgLy8gbWV0aG9kIGxpa2UgdGhpcyBpcyBnZW5lcmFsbHkgZGlzY291cmFnZWQgYmVjYXVzZSBvZgogICAgICAgICAgICAvLyByZWVudHJhbmN5IGF0dGFja3MgYW5kIERvUyBhdHRhY2tzIGlmIHRoZSBzZWxsZXIgaXMKICAgICAgICAgICAgLy8gYSBjb250cmFjdCB3aXRoIGFuIGludmFsaWQgZmFsbGJhY2sgZnVuY3Rpb24uIFdlIGV4cGxpY2l0bHkKICAgICAgICAgICAgLy8gZ3VhcmQgYWdhaW5zdCByZWVudHJhbmN5IGF0dGFja3MgYnkgcmVtb3ZpbmcgdGhlIGF1Y3Rpb24KICAgICAgICAgICAgLy8gYmVmb3JlIGNhbGxpbmcgdHJhbnNmZXIoKSwgYW5kIHRoZSBvbmx5IHRoaW5nIHRoZSBzZWxsZXIKICAgICAgICAgICAgLy8gY2FuIERvUyBpcyB0aGUgc2FsZSBvZiB0aGVpciBvd24gYXNzZXQhIChBbmQgaWYgaXQncyBhbgogICAgICAgICAgICAvLyBhY2NpZGVudCwgdGhleSBjYW4gY2FsbCBjYW5jZWxBdWN0aW9uKCkuICkKICAgICAgICAgICAgaWYgKHNlbGxlciAhPSBhZGRyZXNzKGNvcmUpKSB7CiAgICAgICAgICAgICAgICBzZWxsZXIudHJhbnNmZXIoc2VsbGVyUHJvY2VlZHMpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBDYWxjdWxhdGUgYW55IGV4Y2VzcyBmdW5kcyBpbmNsdWRlZCB3aXRoIHRoZSBiaWQuIElmIHRoZSBleGNlc3MKICAgICAgICAvLyBpcyBhbnl0aGluZyB3b3J0aCB3b3JyeWluZyBhYm91dCwgdHJhbnNmZXIgaXQgYmFjayB0byBiaWRkZXIuCiAgICAgICAgLy8gTk9URTogV2UgY2hlY2tlZCBhYm92ZSB0aGF0IHRoZSBiaWQgYW1vdW50IGlzIGdyZWF0ZXIgdGhhbiBvcgogICAgICAgIC8vIGVxdWFsIHRvIHRoZSBwcmljZSBzbyB0aGlzIGNhbm5vdCB1bmRlcmZsb3cuCiAgICAgICAgdWludDI1NiBiaWRFeGNlc3MgPSBfYmlkQW1vdW50IC0gcHJpY2U7CgogICAgICAgIC8vIFJldHVybiB0aGUgZnVuZHMuIFNpbWlsYXIgdG8gdGhlIHByZXZpb3VzIHRyYW5zZmVyLCB0aGlzIGlzCiAgICAgICAgLy8gbm90IHN1c2NlcHRpYmxlIHRvIGEgcmUtZW50cnkgYXR0YWNrIGJlY2F1c2UgdGhlIGF1Y3Rpb24gaXMKICAgICAgICAvLyByZW1vdmVkIGJlZm9yZSBhbnkgdHJhbnNmZXJzIG9jY3VyLgogICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoYmlkRXhjZXNzKTsKCiAgICAgICAgLy8gVGVsbCB0aGUgd29ybGQhCiAgICAgICAgQXVjdGlvblN1Y2Nlc3NmdWwoX3Rva2VuSWQsIHByaWNlLCBtc2cuc2VuZGVyLCB1SUQpOwoKICAgICAgICByZXR1cm4gcHJpY2U7CiAgICB9CgogICAgZnVuY3Rpb24gX3JlbW92ZUF1Y3Rpb24odWludDI1NiBfdG9rZW5JZCkgaW50ZXJuYWwgewogICAgICAgIGRlbGV0ZSB0b2tlbklkVG9BdWN0aW9uW190b2tlbklkXTsKICAgIH0KCiAgICBmdW5jdGlvbiBfaXNPbkF1Y3Rpb24oQXVjdGlvbiBzdG9yYWdlIF9hdWN0aW9uKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gKF9hdWN0aW9uLnN0YXJ0ZWRBdCA+IDApOwogICAgfQoKICAgICBmdW5jdGlvbiBfY29tcHV0ZUN1dCh1aW50MjU2IF9wcmljZSkgaW50ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgLy8gTk9URTogV2UgZG9uJ3QgdXNlIFNhZmVNYXRoIChvciBzaW1pbGFyKSBpbiB0aGlzIGZ1bmN0aW9uIGJlY2F1c2UKICAgICAgICAvLyAgYWxsIG9mIG91ciBlbnRyeSBmdW5jdGlvbnMgY2FyZWZ1bGx5IGNhcCB0aGUgbWF4aW11bSB2YWx1ZXMgZm9yCiAgICAgICAgLy8gIGN1cnJlbmN5IChhdCAxMjgtYml0cyksIGFuZCBvd25lckN1dCA8PSAxMDAwMCAoc2VlIHRoZSByZXF1aXJlKCkKICAgICAgICAvLyAgc3RhdGVtZW50IGluIHRoZSBDbG9ja0F1Y3Rpb24gY29uc3RydWN0b3IpLiBUaGUgcmVzdWx0IG9mIHRoaXMKICAgICAgICAvLyAgZnVuY3Rpb24gaXMgYWx3YXlzIGd1YXJhbnRlZWQgdG8gYmUgPD0gX3ByaWNlLgogICAgICAgIHJldHVybiBfcHJpY2UgKiBvd25lckN1dCAvIDEwMDAwOwogICAgfQp9Cgpjb250cmFjdCBNb25zdGVyQXVjdGlvbiBpcyAgTW9uc3RlckF1Y3Rpb25CYXNlLCBPd25hYmxlIHsKICAgIGJvb2wgcHVibGljIGlzTW9uc3RlckF1Y3Rpb24gPSB0cnVlOwogICAgdWludDI1NiBwdWJsaWMgYXVjdGlvbkluZGV4ID0gMDsKCiAgICBmdW5jdGlvbiBNb25zdGVyQXVjdGlvbihhZGRyZXNzIF9uZnRBZGRyZXNzLCB1aW50MjU2IF9jdXQpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfY3V0IDw9IDEwMDAwKTsKICAgICAgICBvd25lckN1dCA9IF9jdXQ7CgogICAgICAgIHZhciBjYW5kaWRhdGVDb250cmFjdCA9IE1vbnN0ZXJPd25lcnNoaXAoX25mdEFkZHJlc3MpOwoKICAgICAgICBub25GdW5naWJsZUNvbnRyYWN0ID0gY2FuZGlkYXRlQ29udHJhY3Q7CiAgICAgICAgQ2hhaW5Nb25zdGVyc0NvcmUgY2FuZGlkYXRlQ29yZUNvbnRyYWN0ID0gQ2hhaW5Nb25zdGVyc0NvcmUoX25mdEFkZHJlc3MpOwogICAgICAgIGNvcmUgPSBjYW5kaWRhdGVDb3JlQ29udHJhY3Q7CiAgICB9CgogICAgLy8gb25seSBwb3NzaWJsZSB0byBkZWNyZWFzZSBvd25lckN1dCEKICAgIGZ1bmN0aW9uIHNldE93bmVyQ3V0KHVpbnQyNTYgX2N1dCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKF9jdXQgPD0gb3duZXJDdXQpOwogICAgICAgIG93bmVyQ3V0ID0gX2N1dDsKICAgIH0KCiAgICBmdW5jdGlvbiBfb3ducyhhZGRyZXNzIF9jbGFpbWFudCwgdWludDI1NiBfdG9rZW5JZCkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIChub25GdW5naWJsZUNvbnRyYWN0Lm93bmVyT2YoX3Rva2VuSWQpID09IF9jbGFpbWFudCk7CiAgICB9CgogICAgZnVuY3Rpb24gX2VzY3JvdyhhZGRyZXNzIF9vd25lciwgdWludDI1NiBfdG9rZW5JZCkgaW50ZXJuYWwgewogICAgICAgIC8vIGl0IHdpbGwgdGhyb3cgaWYgdHJhbnNmZXIgZmFpbHMKICAgICAgICBub25GdW5naWJsZUNvbnRyYWN0LnRyYW5zZmVyRnJvbShfb3duZXIsIHRoaXMsIF90b2tlbklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB3aXRoZHJhd0JhbGFuY2UoKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIHVpbnQyNTYgYmFsYW5jZSA9IHRoaXMuYmFsYW5jZTsKICAgICAgICBvd25lci50cmFuc2ZlcihiYWxhbmNlKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b2tlbnNJbkF1Y3Rpb25zT2ZPd25lcihhZGRyZXNzIF9vd25lcikgZXh0ZXJuYWwgdmlldyByZXR1cm5zKHVpbnQyNTZbXSBhdWN0aW9uVG9rZW5zKSB7CiAgICAgICAgdWludDI1NiBudW1BdWN0aW9ucyA9IG93bmVyc2hpcEF1Y3Rpb25Db3VudFtfb3duZXJdOwoKICAgICAgICB1aW50MjU2W10gbWVtb3J5IHJlc3VsdCA9IG5ldyB1aW50MjU2W10obnVtQXVjdGlvbnMpOwogICAgICAgIHVpbnQyNTYgdG90YWxBdWN0aW9ucyA9IGNvcmUudG90YWxTdXBwbHkoKTsKICAgICAgICB1aW50MjU2IHJlc3VsdEluZGV4ID0gMDsKCiAgICAgICAgdWludDI1NiBhdWN0aW9uSWQ7CgogICAgICAgIGZvciAoYXVjdGlvbklkID0gMDsgYXVjdGlvbklkIDw9IHRvdGFsQXVjdGlvbnM7IGF1Y3Rpb25JZCsrKSB7CiAgICAgICAgICAgIEF1Y3Rpb24gc3RvcmFnZSBhdWN0aW9uID0gdG9rZW5JZFRvQXVjdGlvblthdWN0aW9uSWRdOwogICAgICAgICAgICBpZiAoYXVjdGlvbi5zZWxsZXIgPT0gX293bmVyKSB7CiAgICAgICAgICAgICAgICByZXN1bHRbcmVzdWx0SW5kZXhdID0gYXVjdGlvbklkOwogICAgICAgICAgICAgICAgcmVzdWx0SW5kZXgrKzsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgICBmdW5jdGlvbiBjcmVhdGVBdWN0aW9uKHVpbnQyNTYgX3Rva2VuSWQsIHVpbnQyNTYgX3ByaWNlLCBhZGRyZXNzIF9zZWxsZXIpIGV4dGVybmFsIHsKICAgICAgICByZXF1aXJlKF9zZWxsZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfcHJpY2UgPT0gdWludDI1NihfcHJpY2UpKTsKICAgICAgICByZXF1aXJlKGNvcmUuX2lzVHJhZGVhYmxlKF90b2tlbklkKSk7CiAgICAgICAgcmVxdWlyZShfb3ducyhtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwoKICAgICAgICAKICAgICAgICBfZXNjcm93KG1zZy5zZW5kZXIsIF90b2tlbklkKTsKCiAgICAgICAgQXVjdGlvbiBtZW1vcnkgYXVjdGlvbiA9IEF1Y3Rpb24oCiAgICAgICAgICAgIF9zZWxsZXIsCiAgICAgICAgICAgIHVpbnQyNTYoX3ByaWNlKSwKICAgICAgICAgICAgdWludDY0KG5vdyksCiAgICAgICAgICAgIHVpbnQyNTYoYXVjdGlvbkluZGV4KQogICAgICAgICk7CgogICAgICAgIGF1Y3Rpb25JZFRvU2VsbGVyW2F1Y3Rpb25JbmRleF0gPSBfc2VsbGVyOwogICAgICAgIG93bmVyc2hpcEF1Y3Rpb25Db3VudFtfc2VsbGVyXSsrOwoKICAgICAgICBhdWN0aW9uSW5kZXgrKzsKICAgICAgICBfYWRkQXVjdGlvbihfdG9rZW5JZCwgYXVjdGlvbik7CiAgICB9CgogICAgZnVuY3Rpb24gYnV5KHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsIHBheWFibGUgewogICAgICAgIC8vZGVsZXRlIGF1Y3Rpb25JZFRvU2VsbGVyW190b2tlbklkXTsKICAgICAgICAvLyBidXkgd2lsbCB0aHJvdyBpZiB0aGUgYmlkIG9yIGZ1bmRzIHRyYW5zZmVyIGZhaWxzCiAgICAgICAgX2J1eSAoX3Rva2VuSWQsIG1zZy52YWx1ZSk7CiAgICAgICAgX3RyYW5zZmVyKG1zZy5zZW5kZXIsIF90b2tlbklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjYW5jZWxBdWN0aW9uKHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsIHsKICAgICAgICBBdWN0aW9uIHN0b3JhZ2UgYXVjdGlvbiA9IHRva2VuSWRUb0F1Y3Rpb25bX3Rva2VuSWRdOwogICAgICAgIHJlcXVpcmUoX2lzT25BdWN0aW9uKGF1Y3Rpb24pKTsKCiAgICAgICAgYWRkcmVzcyBzZWxsZXIgPSBhdWN0aW9uLnNlbGxlcjsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gc2VsbGVyKTsKCiAgICAgICAgX2NhbmNlbEF1Y3Rpb24oX3Rva2VuSWQsIHNlbGxlcik7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QXVjdGlvbih1aW50MjU2IF90b2tlbklkKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGFkZHJlc3Mgc2VsbGVyLCB1aW50MjU2IHByaWNlLCB1aW50MjU2IHN0YXJ0ZWRBdCkgewogICAgICAgIEF1Y3Rpb24gc3RvcmFnZSBhdWN0aW9uID0gdG9rZW5JZFRvQXVjdGlvbltfdG9rZW5JZF07CiAgICAgICAgcmVxdWlyZShfaXNPbkF1Y3Rpb24oYXVjdGlvbikpOwoKICAgICAgICByZXR1cm4gKAogICAgICAgICAgICBhdWN0aW9uLnNlbGxlciwKICAgICAgICAgICAgYXVjdGlvbi5wcmljZSwKICAgICAgICAgICAgYXVjdGlvbi5zdGFydGVkQXQKICAgICAgICApOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFByaWNlKHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIEF1Y3Rpb24gc3RvcmFnZSBhdWN0aW9uID0gdG9rZW5JZFRvQXVjdGlvbltfdG9rZW5JZF07CiAgICAgICAgcmVxdWlyZShfaXNPbkF1Y3Rpb24oYXVjdGlvbikpOwogICAgICAgIHJldHVybiBhdWN0aW9uLnByaWNlOwogICAgfQp9Cgpjb250cmFjdCBDaGFpbk1vbnN0ZXJzQXVjdGlvbiBpcyBNb25zdGVyT3duZXJzaGlwIHsKICAgIGJvb2wgbG9ja2VkTW9uc3RlckF1Y3Rpb24gPSBmYWxzZTsKCiAgICBmdW5jdGlvbiBzZXRNb25zdGVyQXVjdGlvbkFkZHJlc3MoYWRkcmVzcyBfYWRkcmVzcykgZXh0ZXJuYWwgb25seUFkbWluIHsKICAgICAgICByZXF1aXJlKCFsb2NrZWRNb25zdGVyQXVjdGlvbik7CiAgICAgICAgTW9uc3RlckF1Y3Rpb24gY2FuZGlkYXRlQ29udHJhY3QgPSBNb25zdGVyQXVjdGlvbihfYWRkcmVzcyk7CgogICAgICAgIHJlcXVpcmUoY2FuZGlkYXRlQ29udHJhY3QuaXNNb25zdGVyQXVjdGlvbigpKTsKCiAgICAgICAgbW9uc3RlckF1Y3Rpb24gPSBjYW5kaWRhdGVDb250cmFjdDsKICAgICAgICBsb2NrZWRNb25zdGVyQXVjdGlvbiA9IHRydWU7CiAgICB9CgogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgUFJPTU9fQ1JFQVRJT05fTElNSVQgPSA1MDAwOwogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgR0VOMF9DUkVBVElPTl9MSU1JVCA9IDUwMDA7CgogICAgLy8gQ291bnRzIHRoZSBudW1iZXIgb2YgbW9uc3RlciB0aGUgY29udHJhY3Qgb3duZXIgaGFzIGNyZWF0ZWQuCiAgICB1aW50MjU2IHB1YmxpYyBwcm9tb0NyZWF0ZWRDb3VudDsKICAgIHVpbnQyNTYgcHVibGljIGdlbjBDcmVhdGVkQ291bnQ7CgogICAgLy8gaXRzIHN0YXRzIGFyZSBjb21wbGV0ZWx5IGRlcGVuZGVudCBvbiB0aGUgc3Bhd24gYWxnaG9yaXRobQogICAgZnVuY3Rpb24gY3JlYXRlUHJvbW9Nb25zdGVyKHVpbnQyNTYgX21JZCwgYWRkcmVzcyBfb3duZXIpIGV4dGVybmFsIG9ubHlBZG1pbiB7CiAgICAgICAgLy8gZHVyaW5nIGdlbmVyYXRpb24gd2UgaGF2ZSB0byBrZWVwIGluIG1pbmQgdGhhdCB3ZSBoYXZlIG9ubHkgMTAsMDAwIHRva2VucyBhdmFpbGFibGUKICAgICAgICAvLyB3aGljaCBoYXZlIHRvIGJlIGRpdmlkZWQgYnkgMTUxIG1vbnN0ZXJzLCBzb21lIHJhcmVyIHRoYW4gb3RoZXJzCiAgICAgICAgLy8gc2VlIFdoaXRlUGFwZXIgZm9yIGdlbjAvcHJvbW8gbW9uc3RlciBwbGFuCiAgICAgICAgCiAgICAgICAgLy8gc2FuaXR5IGNoZWNrIHRoYXQgdGhpcyBtb25zdGVyIElEIGlzIGFjdHVhbGx5IGluIGdhbWUgeWV0CiAgICAgICAgcmVxdWlyZShtb25zdGVyQ3JlYXRvci5iYXNlU3RhdHMoX21JZCwgMSkgPiAwKTsKICAgICAgICAKICAgICAgICByZXF1aXJlKHByb21vQ3JlYXRlZENvdW50IDwgUFJPTU9fQ1JFQVRJT05fTElNSVQpOwoKICAgICAgICBwcm9tb0NyZWF0ZWRDb3VudCsrOwoKICAgICAgICB1aW50OFs3XSBtZW1vcnkgaXZzID0gdWludDhbN10obW9uc3RlckNyZWF0b3IuZ2V0R2VuMElWcygpKTsKCiAgICAgICAgYm9vbCBnZW5kZXIgPSBtb25zdGVyQ3JlYXRvci5nZXRNb25zdGVyR2VuZGVyKCk7CiAgICAgICAgCiAgICAgICAgYm9vbCBzaGlueSA9IGZhbHNlOwogICAgICAgIGlmIChpdnNbNl0gPT0gMSkgewogICAgICAgICAgICBzaGlueSA9IHRydWU7CiAgICAgICAgfQogICAgICAgIHVpbnQyNTYgbW9uc3RlcklkID0gX2NyZWF0ZU1vbnN0ZXIoMCwgX293bmVyLCBfbUlkLCB0cnVlLCBnZW5kZXIsIHNoaW55KTsKICAgICAgICBtb25zdGVySWRUb1RyYWRlYWJsZVttb25zdGVySWRdID0gdHJ1ZTsKCiAgICAgICAgbW9uc3RlcklkVG9JVnNbbW9uc3RlcklkXSA9IGl2czsKICAgIH0KCiAgICBmdW5jdGlvbiBjcmVhdGVHZW4wQXVjdGlvbih1aW50MjU2IF9tSWQsIHVpbnQyNTYgcHJpY2UpIGV4dGVybmFsIG9ubHlBZG1pbiB7CiAgICAgICAgIC8vIHNhbml0eSBjaGVjayB0aGF0IHRoaXMgbW9uc3RlciBJRCBpcyBhY3R1YWxseSBpbiBnYW1lIHlldAogICAgICAgIHJlcXVpcmUobW9uc3RlckNyZWF0b3IuYmFzZVN0YXRzKF9tSWQsIDEpID4gMCk7CiAgICAgICAgCiAgICAgICAgcmVxdWlyZShnZW4wQ3JlYXRlZENvdW50IDwgR0VOMF9DUkVBVElPTl9MSU1JVCk7CgogICAgICAgIHVpbnQ4WzddIG1lbW9yeSBpdnMgPSB1aW50OFs3XShtb25zdGVyQ3JlYXRvci5nZXRHZW4wSVZzKCkpOwoKICAgICAgICBib29sIGdlbmRlciA9IG1vbnN0ZXJDcmVhdG9yLmdldE1vbnN0ZXJHZW5kZXIoKTsKICAgICAgICAKICAgICAgICBib29sIHNoaW55ID0gZmFsc2U7CiAgICAgICAgaWYgKGl2c1s2XSA9PSAxKSB7CiAgICAgICAgICAgIHNoaW55ID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgdWludDI1NiBtb25zdGVySWQgPSBfY3JlYXRlTW9uc3RlcigwLCB0aGlzLCBfbUlkLCB0cnVlLCBnZW5kZXIsIHNoaW55KTsKICAgICAgICBtb25zdGVySWRUb1RyYWRlYWJsZVttb25zdGVySWRdID0gdHJ1ZTsKCiAgICAgICAgX2FwcHJvdmUobW9uc3RlcklkLCBtb25zdGVyQXVjdGlvbik7CgogICAgICAgIG1vbnN0ZXJJZFRvSVZzW21vbnN0ZXJJZF0gPSBpdnM7CgogICAgICAgIG1vbnN0ZXJBdWN0aW9uLmNyZWF0ZUF1Y3Rpb24obW9uc3RlcklkLCBwcmljZSwgYWRkcmVzcyh0aGlzKSk7CgogICAgICAgIGdlbjBDcmVhdGVkQ291bnQrKzsKICAgIH0KfQoKLy8gdXNlZCBkdXJpbmcgbGF1bmNoIGZvciB3b3JsZCBjaGFtcGlvbnNoaXAKLy8gY2FuIGFuZCB3aWxsIGJlIHVwZ3JhZGVkIGR1cmluZyBkZXZlbG9wbWVudCB3aXRoIG5ldyBiYXR0bGUgc3lzdGVtIQovLyB0aGlzIGlzIGp1c3QgdG8gZ2l2ZSBwbGF5ZXJzIHNvbWV0aGluZyB0byBkbyBhbmQgdGVzdCB0aGVpciBtb25zdGVycwovLyBhbHNvIGRlbW9uc3RyYXRlcyBob3cgd2UgY2FuIGJ1aWxkIHVwIG1vcmUgbWVjaGFuaWNzIG9uIHRvcCBvZiBvdXIgbG9ja2VkIGNvcmUgY29udHJhY3QhCmNvbnRyYWN0IE1vbnN0ZXJDaGFtcGlvbnNoaXAgaXMgT3duYWJsZSB7CgogICAgYm9vbCBwdWJsaWMgaXNNb25zdGVyQ2hhbXBpb25zaGlwID0gdHJ1ZTsKCiAgICBDaGFpbk1vbnN0ZXJzQ29yZSBjb3JlOwoKICAgIC8vIGxpc3Qgb2YgdG9wIHRlbgogICAgYWRkcmVzc1sxMF0gdG9wVGVuOwoKICAgIC8vIGhvbGRzIHRoZSBhZGRyZXNzIGN1cnJlbnQgIndvcmxkIiBjaGFtcGlvbgogICAgYWRkcmVzcyBwdWJsaWMgY3VyckNoYW1waW9uOwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGFkZHJlc3NUb1Bvd2VybGV2ZWw7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIHB1YmxpYyByYW5rVG9BZGRyZXNzOwogICAgCiAgICAvLyB0cnkgdG8gYmVhdCBldmVyeSBvdGhlciBwbGF5ZXIgaW4gdGhlIHRvcDEwIHdpdGggeW91ciBzdHJvbmdlc3QgbW9uc3RlciEKICAgIC8vIGVmZmVjdGl2ZWx5IGxvb3BpbmcgdGhyb3VnaCBhbGwgdG9wMTAgcGxheWVycywgYmVhdGluZyB0aGVtIG9uZSBieSBvbmUKICAgIC8vIGFuZCBpZiBzdHJvbmcgZW5vdWdoIHBsYWNpbmcgeW91ciBpbiB0aGUgdG9wMTAgYXMgd2VsbAogICAgZnVuY3Rpb24gY29udGVzdENoYW1waW9uKHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsIHsKICAgICAgICAvL3VpbnQgbWF4SW5kZXggPSA5OwoKICAgICAgICAvLyBmYWlsIHR4IGlmIHBsYXllciBpcyBhbHJlYWR5IGNoYW1waW9uIQogICAgICAgIC8vIGluIHRoZW9yeSBwbGF5ZXJzIGNvdWxkIGluY3JlYXNlIHRoZWlyIHBvd2VybGV2ZWwgYnkgY29udGVzdGluZyB0aGVtc2VsdmVzIGJ1dAogICAgICAgIC8vIHRoaXMgY2hlY2sgc3RvcHMgdGhhdCBmcm9tIGhhcHBlbmluZyBzbyBvdGhlciBwbGF5ZXJzIGhhdmUgdGhlIGNoYW5jZSB0bwogICAgICAgIC8vIGJlY29tZSB0aGUgdGVtcG9yYXJ5IGNoYW1waW9uIQogICAgICAgIGlmIChjdXJyQ2hhbXBpb24gPT0gbXNnLnNlbmRlcikgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CgogICAgICAgIHJlcXVpcmUoY29yZS5pc1RyYWluZXIobXNnLnNlbmRlcikpOwogICAgICAgIHJlcXVpcmUoY29yZS5tb25zdGVySW5kZXhUb093bmVyKF90b2tlbklkKSA9PSBtc2cuc2VuZGVyKTsKCiAgICAgICAKICAgICAgICAKICAgICAgICB2YXIgKG4sIG0sIHN0YXRzLCBsLCBrLCBkKSA9ICBjb3JlLmdldE1vbnN0ZXIoX3Rva2VuSWQpOwogICAgICAgIC8vdWludDhbN10gaXZzID0gY29yZS5tb25zdGVySWRUb0lWcyhfdG9rZW5JZCk7CiAgICAgICAgCiAgICAgICAgdWludDI1NiBteVBvd2VybGV2ZWwgPSB1aW50MjU2KHN0YXRzWzBdKSArIHVpbnQyNTYoc3RhdHNbMV0pICsgdWludDI1NihzdGF0c1syXSkgKyB1aW50MjU2KHN0YXRzWzNdKSArIHVpbnQyNTYoc3RhdHNbNF0pICsgdWludDI1NihzdGF0c1s1XSk7CiAgICAgICAgCgogICAgICAgIC8vIGNoZWNrcyBpZiB0aGlzIHRyYW5zYWN0aW9uIGlzIHVzZWxlc3MKICAgICAgICAvLyBzaW5jZSB3ZSBjYW4ndCBmaWdodCBhZ2FpbnN0IG91cnNlbGYhCiAgICAgICAgLy8gYWxzbyBzdG9wcyByZWVudHJhbmN5IGF0dGFja3MKICAgICAgICByZXF1aXJlKG15UG93ZXJsZXZlbCA+IGFkZHJlc3NUb1Bvd2VybGV2ZWxbbXNnLnNlbmRlcl0pOwoKICAgICAgICB1aW50IG15UmFuayA9IDA7CgogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8PSA5OyBpKyspIHsKICAgICAgICAgICAgaWYgKG15UG93ZXJsZXZlbCA+IGFkZHJlc3NUb1Bvd2VybGV2ZWxbdG9wVGVuW2ldXSkgewogICAgICAgICAgICAgICAgLy8geW91IGhhdmUgYmVhdGVuIHRoaXMgb25lIHNvIGluY3JlYXNlIHRlbXBvcmFyeSByYW5rCiAgICAgICAgICAgICAgICBteVJhbmsgPSBpOwoKICAgICAgICAgICAgICAgIGlmIChteVJhbmsgPT0gOSkgewogICAgICAgICAgICAgICAgICAgIGN1cnJDaGFtcGlvbiA9IG1zZy5zZW5kZXI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGFkZHJlc3NUb1Bvd2VybGV2ZWxbbXNnLnNlbmRlcl0gPSBteVBvd2VybGV2ZWw7CgogICAgICAgIGFkZHJlc3NbMTBdIHN0b3JhZ2UgbmV3VG9wVGVuID0gdG9wVGVuOwoKICAgICAgICBpZiAoY3VyckNoYW1waW9uID09IG1zZy5zZW5kZXIpIHsKICAgICAgICAgICAgZm9yICh1aW50IGogPSAwOyBqIDwgOTsgaisrKSB7CiAgICAgICAgICAgICAgICAvLyByZW1vdmUgb3Vyc2VsdmVzIGZyb20gdGhpcyBsaXN0IGluIGNhc2UKICAgICAgICAgICAgICAgIGlmIChuZXdUb3BUZW5bal0gPT0gbXNnLnNlbmRlcikgewogICAgICAgICAgICAgICAgICAgIG5ld1RvcFRlbltqXSA9IDB4MDsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZm9yICh1aW50IHggPSAwOyB4IDw9IG15UmFuazsgeCsrKSB7CiAgICAgICAgICAgIGlmICh4ID09IG15UmFuaykgewogICAgICAgICAgICAgICAgbmV3VG9wVGVuW3hdID0gbXNnLnNlbmRlcjsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmICh4IDwgOSkKICAgICAgICAgICAgICAgICAgICBuZXdUb3BUZW5beF0gPSB0b3BUZW5beCsxXTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdG9wVGVuID0gbmV3VG9wVGVuOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFRvcFBsYXllcnMoKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGFkZHJlc3NbMTBdIHBsYXllcnMpIHsKICAgICAgICBwbGF5ZXJzID0gdG9wVGVuOwogICAgfQoKICAgIGZ1bmN0aW9uIE1vbnN0ZXJDaGFtcGlvbnNoaXAoYWRkcmVzcyBjb3JlQ29udHJhY3QpIHB1YmxpYyB7CiAgICAgICAgY29yZSA9IENoYWluTW9uc3RlcnNDb3JlKGNvcmVDb250cmFjdCk7CiAgICB9CgogICAgZnVuY3Rpb24gd2l0aGRyYXdCYWxhbmNlKCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICB1aW50MjU2IGJhbGFuY2UgPSB0aGlzLmJhbGFuY2U7CiAgICAgICAgb3duZXIudHJhbnNmZXIoYmFsYW5jZSk7CiAgICB9Cn0KCgovLyB3aGVyZSB0aGUgbm90LXNvLW11Y2ggImhpZGRlbiIgbWFnaWMgaGFwcGVucwpjb250cmFjdCBNb25zdGVyQ3JlYXRvckludGVyZmFjZSBpcyBPd25hYmxlIHsKICAgIHVpbnQ4IHB1YmxpYyBsb2NrZWRNb25zdGVyU3RhdHNDb3VudCA9IDA7CiAgICB1aW50IG5vbmNlID0gMDsKCiAgICBmdW5jdGlvbiByYW5kKHVpbnQxNiBtaW4sIHVpbnQxNiBtYXgpIHB1YmxpYyByZXR1cm5zICh1aW50MTYpIHsKICAgICAgICBub25jZSsrOwogICAgICAgIHVpbnQxNiByZXN1bHQgPSAodWludDE2KGtlY2NhazI1NihibG9jay5ibG9ja2hhc2goYmxvY2subnVtYmVyLTEpLCBub25jZSkpJW1heCk7CgogICAgICAgIGlmIChyZXN1bHQgPCBtaW4pIHsKICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0K21pbjsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogICAgbWFwcGluZyh1aW50MjU2ID0+IHVpbnQ4WzhdKSBwdWJsaWMgYmFzZVN0YXRzOwoKICAgIGZ1bmN0aW9uIGFkZEJhc2VTdGF0cyh1aW50MjU2IF9tSWQsIHVpbnQ4WzhdIGRhdGEpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgLy8gbG9jayIgdGhlIHN0YXRzIGRvd24gZm9yZXZlcgogICAgICAgIC8vIHNpbmNlIGhwIGlzIG5ldmVyIGdvaW5nIHRvIGJlIDAgdGhpcyBpcyBhIHZhbGlkIGNoZWNrCiAgICAgICAgLy8gc28gd2UgaGF2ZSB0byBiZSBleHRyYSBjYXJlZnVsIHdoZW4gYWRkaW5nIG5ldyBiYXNlU3RhdHMhCiAgICAgICAgcmVxdWlyZShkYXRhWzBdID4gMCk7CiAgICAgICAgcmVxdWlyZShiYXNlU3RhdHNbX21JZF1bMF0gPT0gMCk7CiAgICAgICAgYmFzZVN0YXRzW19tSWRdID0gZGF0YTsKICAgIH0KCiAgICBmdW5jdGlvbiBfYWRkQmFzZVN0YXRzKHVpbnQyNTYgX21JZCwgdWludDhbOF0gZGF0YSkgaW50ZXJuYWwgewogICAgICAgIGJhc2VTdGF0c1tfbUlkXSA9IGRhdGE7CiAgICAgICAgbG9ja2VkTW9uc3RlclN0YXRzQ291bnQrKzsKICAgIH0KCiAgICBmdW5jdGlvbiBNb25zdGVyQ3JlYXRvckludGVyZmFjZSgpIHB1YmxpYyB7CiAgICAgICAvLyB0aGVzZSBtb25zdGVycyBhcmUgYWxyZWFkeSBkb3duIGFuZCAibG9ja2VkIiBkb3duIHN0YXRzL2Rlc2lnbiB3aXNlCiAgICAgICAgX2FkZEJhc2VTdGF0cygxLCBbNDUsIDQ5LCA0OSwgNjUsIDY1LCA0NSwgMTIsIDRdKTsKICAgICAgICBfYWRkQmFzZVN0YXRzKDIsIFs2MCwgNjIsIDYzLCA4MCwgODAsIDYwLCAxMiwgNF0pOwogICAgICAgIF9hZGRCYXNlU3RhdHMoMywgWzgwLCA4MiwgODMsIDEwMCwgMTAwLCA4MCwgMTIsIDRdKTsKICAgICAgICBfYWRkQmFzZVN0YXRzKDQsIFszOSwgNTIsIDQzLCA2MCwgNTAsIDY1LCAxMCwgNl0pOwogICAgICAgIF9hZGRCYXNlU3RhdHMoNSwgWzU4LCA2NCwgNTgsIDgwLCA2NSwgODAsIDEwLCA2XSk7CiAgICAgICAgX2FkZEJhc2VTdGF0cyg2LCBbNzgsIDg0LCA3OCwgMTA5LCA4NSwgMTAwLCAxMCwgNl0pOwogICAgICAgIF9hZGRCYXNlU3RhdHMoNywgWzQ0LCA0OCwgNjUsIDUwLCA2NCwgNDMsIDExLCAxNF0pOwogICAgICAgIF9hZGRCYXNlU3RhdHMoOCwgWzU5LCA2MywgODAsIDY1LCA4MCwgNTgsIDExLCAxNF0pOwogICAgICAgIF9hZGRCYXNlU3RhdHMoOSwgWzc5LCA4MywgMTAwLCA4NSwgMTA1LCA3OCwgMTEsIDE0XSk7CiAgICAgICAgX2FkZEJhc2VTdGF0cygxMCwgWzQwLCAzNSwgMzAsIDIwLCAyMCwgNTAsIDcsIDRdKTsKCiAgICAgICAgX2FkZEJhc2VTdGF0cygxNDksIFs1NSwgNTAsIDQ1LCAxMzUsIDk1LCAxMjAsIDgsIDE0XSk7CiAgICAgICAgX2FkZEJhc2VTdGF0cygxNTAsIFs5MSwgMTM0LCA5NSwgMTAwLCAxMDAsIDgwLCAyLCA1XSk7CiAgICAgICAgX2FkZEJhc2VTdGF0cygxNTEsIFsxMDAsIDEwMCwgMTAwLCAxMDAsIDEwMCwgMTAwLCA1LCAxOV0pOwogICAgfQoKICAgIC8vIHRoaXMgc2VydmVzIGFzIGEgbG9va3VwIGZvciBuZXcgbW9uc3RlcnMgdG8gYmUgZ2VuZXJhdGVkIHNpbmNlIGFsbCBtb25zdGVycwogICAgLy8gb2YgdGhlIHNhbWUgaWQgc2hhcmUgdGhlIGJhc2Ugc3RhdHMKICAgIC8vIGFsc28gbWFrZXMgaXQgcG9zc2libGUgdG8gb25seSBzdG9yZSB0aGUgbW9uc3RlcklkIG9uIGNvcmUgYW5kIGNoYW5nZSB0aGlzIG9uZQogICAgLy8gZHVyaW5nIGV2b2x1dGlvbiBwcm9jZXNzIHRvIHNhdmUgZ2FzIGFuZCBhZGRpdGlvbmFsIHRyYW5zYWN0aW9ucwogICAgZnVuY3Rpb24gZ2V0TW9uc3RlclN0YXRzKCB1aW50MjU2IF9tSUQpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnModWludDhbOF0gc3RhdHMpIHsKICAgICAgICBzdGF0c1swXSA9IGJhc2VTdGF0c1tfbUlEXVswXTsKICAgICAgICBzdGF0c1sxXSA9IGJhc2VTdGF0c1tfbUlEXVsxXTsKICAgICAgICBzdGF0c1syXSA9IGJhc2VTdGF0c1tfbUlEXVsyXTsKICAgICAgICBzdGF0c1szXSA9IGJhc2VTdGF0c1tfbUlEXVszXTsKICAgICAgICBzdGF0c1s0XSA9IGJhc2VTdGF0c1tfbUlEXVs0XTsKICAgICAgICBzdGF0c1s1XSA9IGJhc2VTdGF0c1tfbUlEXVs1XTsKICAgICAgICBzdGF0c1s2XSA9IGJhc2VTdGF0c1tfbUlEXVs2XTsKICAgICAgICBzdGF0c1s3XSA9IGJhc2VTdGF0c1tfbUlEXVs3XTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRNb25zdGVyR2VuZGVyICgpIGV4dGVybmFsIHJldHVybnMoYm9vbCBmZW1hbGUpIHsKICAgICAgICB1aW50MTYgZmVtYWxlQ2hhbmNlID0gcmFuZCgwLCAxMDApOwoKICAgICAgICBpZiAoZmVtYWxlQ2hhbmNlID49IDUwKSB7CiAgICAgICAgICAgIGZlbWFsZSA9IHRydWU7CiAgICAgICAgfQogICAgfQoKICAgIC8vIGdlbmVyYXRlcyByYW5kb21pemVkIElWcyBmb3IgYSBuZXcgbW9uc3RlcgogICAgZnVuY3Rpb24gZ2V0TW9uc3RlcklWcygpIGV4dGVybmFsIHJldHVybnModWludDhbN10gaXZzKSB7CiAgICAgICAgYm9vbCBzaGlueSA9IGZhbHNlOwoKICAgICAgICB1aW50MTYgY2hhbmNlID0gcmFuZCgxLCA4MTkyKTsKCiAgICAgICAgaWYgKGNoYW5jZSA9PSA0MikgewogICAgICAgICAgICBzaGlueSA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICAvLyBJVnMgcmFuZ2UgYmV0d2VlbiAwIGFuZCAzMQogICAgICAgIC8vIHN0YXQgcmFuZ2UgbW9kaWZpZWQgZm9yIHNoaW55IG1vbnN0ZXJzIQogICAgICAgIGlmIChzaGlueSkgewogICAgICAgICAgICBpdnNbMF0gPSB1aW50OChyYW5kKDEwLCAzMSkpOwogICAgICAgICAgICBpdnNbMV0gPSB1aW50OChyYW5kKDEwLCAzMSkpOwogICAgICAgICAgICBpdnNbMl0gPSB1aW50OChyYW5kKDEwLCAzMSkpOwogICAgICAgICAgICBpdnNbM10gPSB1aW50OChyYW5kKDEwLCAzMSkpOwogICAgICAgICAgICBpdnNbNF0gPSB1aW50OChyYW5kKDEwLCAzMSkpOwogICAgICAgICAgICBpdnNbNV0gPSB1aW50OChyYW5kKDEwLCAzMSkpOwogICAgICAgICAgICBpdnNbNl0gPSAxOwoKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpdnNbMF0gPSB1aW50OChyYW5kKDAsIDMxKSk7CiAgICAgICAgICAgIGl2c1sxXSA9IHVpbnQ4KHJhbmQoMCwgMzEpKTsKICAgICAgICAgICAgaXZzWzJdID0gdWludDgocmFuZCgwLCAzMSkpOwogICAgICAgICAgICBpdnNbM10gPSB1aW50OChyYW5kKDAsIDMxKSk7CiAgICAgICAgICAgIGl2c1s0XSA9IHVpbnQ4KHJhbmQoMCwgMzEpKTsKICAgICAgICAgICAgaXZzWzVdID0gdWludDgocmFuZCgwLCAzMSkpOwogICAgICAgICAgICBpdnNbNl0gPSAwOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBnZW4wIG1vbnN0ZXJzIHByb2ZpdCBmcm9tIHNoaW55IGJvb3N0IHdoaWxlIHNoaW55IGdlbjBzIGhhdmUgcG90ZW50aWFsbHkgZXZlbiBoaWdoZXIgSVZzIQogICAgLy8gZnVydGhlciBpbmNyZWFzaW5nIHRoZSByYXJpdHkgYnkgYWxzbyBkb3VibGluZyB0aGUgc2hpbnkgY2hhbmNlIQogICAgZnVuY3Rpb24gZ2V0R2VuMElWcygpIGV4dGVybmFsIHJldHVybnMgKHVpbnQ4WzddIGl2cykgewogICAgICAgIGJvb2wgc2hpbnkgPSBmYWxzZTsKCiAgICAgICAgdWludDE2IGNoYW5jZSA9IHJhbmQoMSwgNDA5Nik7CgogICAgICAgIGlmIChjaGFuY2UgPT0gNDIpIHsKICAgICAgICAgICAgc2hpbnkgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHNoaW55KSB7CiAgICAgICAgICAgIGl2c1swXSA9IHVpbnQ4KHJhbmQoMTUsIDMxKSk7CiAgICAgICAgICAgIGl2c1sxXSA9IHVpbnQ4KHJhbmQoMTUsIDMxKSk7CiAgICAgICAgICAgIGl2c1syXSA9IHVpbnQ4KHJhbmQoMTUsIDMxKSk7CiAgICAgICAgICAgIGl2c1szXSA9IHVpbnQ4KHJhbmQoMTUsIDMxKSk7CiAgICAgICAgICAgIGl2c1s0XSA9IHVpbnQ4KHJhbmQoMTUsIDMxKSk7CiAgICAgICAgICAgIGl2c1s1XSA9IHVpbnQ4KHJhbmQoMTUsIDMxKSk7CiAgICAgICAgICAgIGl2c1s2XSA9IDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaXZzWzBdID0gdWludDgocmFuZCgxMCwgMzEpKTsKICAgICAgICAgICAgaXZzWzFdID0gdWludDgocmFuZCgxMCwgMzEpKTsKICAgICAgICAgICAgaXZzWzJdID0gdWludDgocmFuZCgxMCwgMzEpKTsKICAgICAgICAgICAgaXZzWzNdID0gdWludDgocmFuZCgxMCwgMzEpKTsKICAgICAgICAgICAgaXZzWzRdID0gdWludDgocmFuZCgxMCwgMzEpKTsKICAgICAgICAgICAgaXZzWzVdID0gdWludDgocmFuZCgxMCwgMzEpKTsKICAgICAgICAgICAgaXZzWzZdID0gMDsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gd2l0aGRyYXdCYWxhbmNlKCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICB1aW50MjU2IGJhbGFuY2UgPSB0aGlzLmJhbGFuY2U7CiAgICAgICAgb3duZXIudHJhbnNmZXIoYmFsYW5jZSk7CiAgICB9Cn0KCmNvbnRyYWN0IEdhbWVMb2dpY0NvbnRyYWN0IHsKICAgIGJvb2wgcHVibGljIGlzR2FtZUxvZ2ljQ29udHJhY3QgPSB0cnVlOwoKICAgIGZ1bmN0aW9uIEdhbWVMb2dpY0NvbnRyYWN0KCkgcHVibGljIHsKCiAgICB9Cn0KCgpjb250cmFjdCBPbWVnYUNvbnRyYWN0IHsKICAgIGJvb2wgcHVibGljIGlzT21lZ2FDb250cmFjdCA9IHRydWU7CgogICAgZnVuY3Rpb24gT21lZ2FDb250cmFjdCgpIHB1YmxpYyB7CgogICAgfQp9Cgpjb250cmFjdCBDaGFpbk1vbnN0ZXJzQ29yZSBpcyBDaGFpbk1vbnN0ZXJzQXVjdGlvbiwgT3duYWJsZSB7CiAgICAvLyB1c2luZyBhIGJvb2wgdG8gZW5hYmxlIHVzIHRvIHByZXBhcmUgdGhlIGdhbWUKICAgIGJvb2wgaGFzTGF1bmNoZWQgPSBmYWxzZTsKCiAgICAvLyB0aGlzIGFkZHJlc3Mgd2lsbCBob2xkIGZ1dHVyZSBnYW1lbG9naWMgaW4gcGxhY2UKICAgIGFkZHJlc3MgZ2FtZUNvbnRyYWN0OwoKICAgIC8vIHRoaXMgY29udHJhY3QKICAgIGFkZHJlc3Mgb21lZ2FDb250cmFjdDsKCiAgICBmdW5jdGlvbiBDaGFpbk1vbnN0ZXJzQ29yZSgpIHB1YmxpYyB7CiAgICAgICAgYWRtaW5BZGRyZXNzID0gbXNnLnNlbmRlcjsKCiAgICAgICAgX2NyZWF0ZUFyZWEoKTsgLy8gYXJlYSAxCiAgICAgICAgX2NyZWF0ZUFyZWEoKTsgLy8gYXJlYSAyCiAgICB9CgogICAgLy8gd2UgZG9uJ3Qga25vdyB0aGUgZXhhY3QgaW50ZXJmYWNlcyB5ZXQgc28gdXNlIHRoZSBsb2NrZWRNb25zdGVyU3RhdHMgdmFsdWUgdG8gZGV0ZXJtaW5lIGlmIHRoZSBnYW1lIGlzICJyZWFkeSIKICAgIC8vIHNlZSBXaGl0ZVBhcGVyIGZvciBleHBsYWluYXRpb24gZm9yIG91ciB1cGdyYWRlIGFuZCBkZXZlbG9wbWVudCByb2FkbWFwCiAgICBmdW5jdGlvbiBzZXRHYW1lTG9naWNDb250cmFjdChhZGRyZXNzIF9jYW5kaWRhdGVDb250cmFjdCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG1vbnN0ZXJDcmVhdG9yLmxvY2tlZE1vbnN0ZXJTdGF0c0NvdW50KCkgPT0gMTUxKTsKCiAgICAgICAgcmVxdWlyZShHYW1lTG9naWNDb250cmFjdChfY2FuZGlkYXRlQ29udHJhY3QpLmlzR2FtZUxvZ2ljQ29udHJhY3QoKSk7CgogICAgICAgIGdhbWVDb250cmFjdCA9IF9jYW5kaWRhdGVDb250cmFjdDsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRPbWVnYUNvbnRyYWN0KGFkZHJlc3MgX2NhbmRpZGF0ZUNvbnRyYWN0KSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoT21lZ2FDb250cmFjdChfY2FuZGlkYXRlQ29udHJhY3QpLmlzT21lZ2FDb250cmFjdCgpKTsKICAgICAgICBvbWVnYUNvbnRyYWN0ID0gX2NhbmRpZGF0ZUNvbnRyYWN0OwogICAgfQoKICAgIC8vIG9tZWdhIGNvbnRyYWN0IHRha2VzIGNhcmUgb2YgYWxsIG5lY2Nlc3NhcnkgY2hlY2tzIHNvIGFzc3VtZSB0aGF0IHRoaXMgaXMgY29ycmVjdCghKQogICAgZnVuY3Rpb24gZXZvbHZlTW9uc3Rlcih1aW50MjU2IF90b2tlbklkLCB1aW50MTYgX3RvTW9uc3RlcklkKSBleHRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG9tZWdhQ29udHJhY3QpOwoKICAgICAgICAvLyByZXRyaWV2ZSBjdXJyZW50IG1vbnN0ZXIgc3RydWN0CiAgICAgICAgTW9uc3RlciBzdG9yYWdlIG1vbiA9IG1vbnN0ZXJzW190b2tlbklkXTsKCiAgICAgICAgLy8gZXZvbHZpbmcgb25seSBjaGFuZ2VzIG1vbnN0ZXIgSUQgc2luY2UgdGhpcyBpcyByZXNwb25zaWJsZSBmb3IgYmFzZSBTdGF0cwogICAgICAgIC8vIGFuIGV2b2x2ZWQgbW9uc3RlciBrZWVwcyBpdHMgZ2VuZGVyLCBnZW5lcmF0aW9uLCBJVnMgYW5kIEVWcwogICAgICAgIG1vbi5tSUQgPSBfdG9Nb25zdGVySWQ7CiAgICB9CgogICAgLy8gb25seSBjYWxsYWJsZSBieSBnYW1lQ29udHJhY3QgYWZ0ZXIgdGhlIGZ1bGwgZ2FtZSBpcyBsYXVuY2hlZAogICAgLy8gc2luY2UgYWxsIGFkZGl0aW9uYWwgbW9uc3RlcnMgYWZ0ZXIgdGhlIHByb21vL2dlbjAgb25lcyBuZWVkIHRvIHVzZSB0aGlzIGNvcmVDb250cmFjdAogICAgLy8gY29udHJhY3QgYXMgd2VsbCB3ZSBoYXZlIHRvIHByZXBhcmUgdGhpcyBjb3JlIGZvciBvdXIgZnV0dXJlIHVwZGF0ZXMgd2hlcmUKICAgIC8vIHBsYXllcnMgY2FuIGZyZWVseSByb2FtIHRoZSB3b3JsZCBhbmQgaHVudCBDaGFpbk1vbnN0ZXJzIHRodXMgZ2VuZXJhdGluZyBtb3JlCiAgICBmdW5jdGlvbiBzcGF3bk1vbnN0ZXIodWludDI1NiBfbUlkLCBhZGRyZXNzIF9vd25lcikgZXh0ZXJuYWwgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBnYW1lQ29udHJhY3QpOwoKICAgICAgICB1aW50OFs3XSBtZW1vcnkgaXZzID0gdWludDhbN10obW9uc3RlckNyZWF0b3IuZ2V0TW9uc3RlcklWcygpKTsKCiAgICAgICAgYm9vbCBnZW5kZXIgPSBtb25zdGVyQ3JlYXRvci5nZXRNb25zdGVyR2VuZGVyKCk7CgogICAgICAgIGJvb2wgc2hpbnkgPSBmYWxzZTsKICAgICAgICBpZiAoaXZzWzZdID09IDEpIHsKICAgICAgICAgICAgc2hpbnkgPSB0cnVlOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBpbXBvcnRhbnQgdG8gbm90ZSB0aGF0IHRoZSBJViBnZW5lcmF0b3JzIGRvIG5vdCB1c2UgR2VuMCBtZXRob2RzIGFuZCBhcmUgR2VuZXJhdGlvbiAxCiAgICAgICAgLy8gdGhpcyBtZWFucyB0aGVyZSB3b24ndCBiZSBtb3JlIHRoYW4gdGhlIDEwLDAwMCBHZW4wIG1vbnN0ZXJzIHNvbGQgZHVyaW5nIHRoZSBkZXZlbG9wbWVudCB0aHJvdWdoIHRoZSBtYXJrZXRwbGFjZQogICAgICAgIHVpbnQyNTYgbW9uc3RlcklkID0gX2NyZWF0ZU1vbnN0ZXIoMSwgX293bmVyLCBfbUlkLCBmYWxzZSwgZ2VuZGVyLCBzaGlueSk7CiAgICAgICAgbW9uc3RlcklkVG9UcmFkZWFibGVbbW9uc3RlcklkXSA9IHRydWU7CgogICAgICAgIG1vbnN0ZXJJZFRvSVZzW21vbnN0ZXJJZF0gPSBpdnM7CiAgICB9CgogICAgLy8gdXNlZCB0byBhZGQgcGxheWFibGUgY29udGVudCB0byB0aGUgZ2FtZQogICAgLy8gbW9uc3RlcnMgd2lsbCBvbmx5IHNwYXduIGluIGNlcnRhaW4gYXJlYXMgc28gc29tZSBhcmUgbG9ja2VkIG9uIHJlbGVhc2UKICAgIC8vIGR1ZSB0byB0aGUgZ2FtZSBiZWluZyBpbiBhY3RpdmUgZGV2ZWxvcG1lbnQgb24gImxhdW5jaCIKICAgIC8vIGVhY2ggbW9uc3RlciBoYXMgYSBtYXhpbXVtIG51bWJlciBvZiAzIGFyZWFzIHdoZXJlIGl0IGNhbiBhcHBlYXIKICAgIGZ1bmN0aW9uIGNyZWF0ZUFyZWEoKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICBfY3JlYXRlQXJlYSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNyZWF0ZVRyYWluZXIoc3RyaW5nIF91c2VybmFtZSwgdWludDE2IF9zdGFydGVySWQpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShoYXNMYXVuY2hlZCk7CgogICAgICAgIC8vIG9ubHkgb25lIHRyYWluZXIvYWNjb3VudCBwZXIgZXRoZXJldW0gYWRkcmVzcwogICAgICAgIHJlcXVpcmUoYWRkcmVzc1RvVHJhaW5lclttc2cuc2VuZGVyXS5vd25lciA9PSAwKTsKCiAgICAgICAgLy8gdmFsaWQgaW5wdXQgY2hlY2sKICAgICAgICByZXF1aXJlKF9zdGFydGVySWQgPT0gMSB8fCBfc3RhcnRlcklkID09IDIgfHwgX3N0YXJ0ZXJJZCA9PSAzKTsKCiAgICAgICAgdWludDI1NiBtb24gPSBfY3JlYXRlVHJhaW5lcihfdXNlcm5hbWUsIF9zdGFydGVySWQsIG1zZy5zZW5kZXIpOwoKICAgICAgICAvLyBkdWUgdG8gc3RhY2sgbGltaXRhdGlvbnMgd2UgaGF2ZSB0byBhc3NpZ24gdGhlIElWcyBoZXJlOgogICAgICAgIG1vbnN0ZXJJZFRvSVZzW21vbl0gPSBtb25zdGVyQ3JlYXRvci5nZXRNb25zdGVySVZzKCk7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlVXNlcm5hbWUoc3RyaW5nIF9uYW1lKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoYWRkcmVzc1RvVHJhaW5lclttc2cuc2VuZGVyXS5vd25lciA9PSBtc2cuc2VuZGVyKTsKICAgICAgICBhZGRyZXNzVG9UcmFpbmVyW21zZy5zZW5kZXJdLnVzZXJuYW1lID0gX25hbWU7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlTW9uc3Rlck5pY2tuYW1lKHVpbnQyNTYgX3Rva2VuSWQsIHN0cmluZyBfbmFtZSkgcHVibGljIHsKICAgICAgICAvLyB1c2VycyB3b24ndCBiZSBhYmxlIHRvIHJlbmFtZSBhIG1vbnN0ZXIgdGhhdCBpcyBwYXJ0IG9mIGFuIGF1Y3Rpb24KICAgICAgICByZXF1aXJlKF9vd25zKG1zZy5zZW5kZXIsIF90b2tlbklkKSk7CgogICAgICAgIC8vIHNvbWUgc3RyaW5nIGNoZWNrcy4uLj8KICAgICAgICBtb25zdGVySWRUb05pY2tuYW1lW190b2tlbklkXSA9IF9uYW1lOwogICAgfQoKICAgIGZ1bmN0aW9uIG1vdmVUb0FyZWEodWludDE2IF9uZXdBcmVhKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoYWRkcmVzc1RvVHJhaW5lclttc2cuc2VuZGVyXS5jdXJyQXJlYSA+IDApOwoKICAgICAgICAvLyBuZXZlciBhbGxvdyBhbnlvbmUgdG8gbW92ZSB0byBhcmVhIDAgb3IgYmVsb3cgc2luY2UgdGhpcyBpcyB1c2VkCiAgICAgICAgLy8gdG8gZGV0ZXJtaW5lIGlmIGEgdHJhaW5lciBwcm9maWxlIGV4aXN0cyBpbiBhbm90aGVyIG1ldGhvZCEKICAgICAgICByZXF1aXJlKF9uZXdBcmVhID4gMCk7CgogICAgICAgIC8vIG1ha2Ugc3VyZSB0aGF0IHRoaXMgYXJlYSBleGlzdHMgeWV0IQogICAgICAgIHJlcXVpcmUoYXJlYXMubGVuZ3RoID49IF9uZXdBcmVhKTsKCiAgICAgICAgLy8gd2hlbiBwbGF5ZXIgaXMgbm90IHN0dWNrIGRvaW5nIHNvbWV0aGluZyBlbHNlIGhlIGNhbiBtb3ZlIGZyZWVseSEKICAgICAgICBfbW92ZVRvQXJlYShfbmV3QXJlYSwgbXNnLnNlbmRlcik7CiAgICB9CgogICAgLy8gdG8gYmUgY2hhbmdlZCB0byByZXRyaWV2ZSBjdXJyZW50IHN0YXRzIQogICAgZnVuY3Rpb24gZ2V0TW9uc3Rlcih1aW50MjU2IF9pZCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICgKICAgICAgICB1aW50MjU2IGJpcnRoVGltZSwgdWludDI1NiBnZW5lcmF0aW9uLCB1aW50OFs4XSBzdGF0cywKICAgICAgICB1aW50MjU2IG1JRCwgYm9vbCB0cmFkZWFibGUsIHVpbnQyNTYgdUlEKQogICAgewogICAgICAgIE1vbnN0ZXIgc3RvcmFnZSBtb24gPSBtb25zdGVyc1tfaWRdOwogICAgICAgIGJpcnRoVGltZSA9IHVpbnQyNTYobW9uLmJpcnRoVGltZSk7CiAgICAgICAgZ2VuZXJhdGlvbiA9IG1vbi5nZW5lcmF0aW9uOyAvLyBoYXJkY29kaW5nIGR1ZSB0byBzdGFjayB0b28gZGVlcCBlcnJvcgogICAgICAgIG1JRCA9IHVpbnQyNTYobW9uLm1JRCk7CiAgICAgICAgdHJhZGVhYmxlID0gYm9vbChtb24udHJhZGVhYmxlKTsKCiAgICAgICAgLy8gdGhlc2UgdmFsdWVzIGFyZSByZXRyaWV2ZWQgZnJvbSBtb25zdGVyQ3JlYXRvcgogICAgICAgIHN0YXRzID0gdWludDhbOF0obW9uc3RlckNyZWF0b3IuZ2V0TW9uc3RlclN0YXRzKHVpbnQyNTYobW9uLm1JRCkpKTsKCiAgICAgICAgLy8gaGFjayB0byBvdmVyY29tZSBzb2xpZGl0eSdzIHN0YWNrIGxpbWl0YXRpb24gaW4gbW9uc3RlciBzdHJ1Y3QuLi4uCiAgICAgICAgdUlEID0gX2lkOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzVHJhaW5lcihhZGRyZXNzIF9jaGVjaykgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChib29sIGlzVHJhaW5lcikgewogICAgICAgIFRyYWluZXIgc3RvcmFnZSB0cmFpbmVyID0gYWRkcmVzc1RvVHJhaW5lcltfY2hlY2tdOwoKICAgICAgICByZXR1cm4gKHRyYWluZXIuY3VyckFyZWEgPiAwKTsKICAgIH0KCiAgICBmdW5jdGlvbiB3aXRoZHJhd0JhbGFuY2UoKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIHVpbnQyNTYgYmFsYW5jZSA9IHRoaXMuYmFsYW5jZTsKCiAgICAgICAgb3duZXIudHJhbnNmZXIoYmFsYW5jZSk7CiAgICB9CgogICAgLy8gYWZ0ZXIgd2UgaGF2ZSBzZXR1cCBldmVyeXRoaW5nIHdlIGNhbiB1bmxvY2sgdGhlIGdhbWUKICAgIC8vIGZvciBwdWJsaWMKICAgIGZ1bmN0aW9uIGxhdW5jaEdhbWUoKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIGhhc0xhdW5jaGVkID0gdHJ1ZTsKICAgIH0KfQ=='.
	

]
