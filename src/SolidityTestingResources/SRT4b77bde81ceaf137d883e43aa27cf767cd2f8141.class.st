Class {
	#name : #SRT4b77bde81ceaf137d883e43aa27cf767cd2f8141,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT4b77bde81ceaf137d883e43aa27cf767cd2f8141 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjA7CgovKgoqIFRlYW0gVG9wIEtlayBwcmVzZW50cy4uCiogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09KgoqICBLRUssIEtFSywgS0VLLCBLRUssIEtFSywgS0VLLCBLRUsgKCA3IEtFS1MgKSAgICAKKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qCioKKiBQUk9PRiBPRiBLZWsKKiAtPiBXaGF0PwoqICBUaGUgbGFzdCBFdGhlcmV1bSBweXJhbWlkZSB3aGljaCBlYXJucyB5b3UgRVRIISEhCiogW3hdIEtlayBEaXZpZGVuZHM6IDE1JSBvZiBldmVyeSBidXkgYW5kIDE1JSBzZWxsIHdpbGwgYmUgcmV3YXJkZWQgdG8gdG9rZW4gaG9sZGVycy4gRG9uJ3Qgc2VsbCwgZG9uJ3QgYmUgd2Vlay4KKiBbeF0gS2VrIE1hc3Rlcm5vZGVzOiBIb2xkaW5nIDUwIFBPVyBUb2tlbnMgYWxsb3cgeW91IHRvIGdlbmVyYXRlIGEgTWFzdGVybm9kZSBsaW5rLCBNYXN0ZXJub2RlIGxpbmtzIGFyZSB1c2VkIGFzIHVuaXF1ZSBlbnRyeSBwb2ludHMgdG8gdGhlIGNvbnRyYWN0IQoqIFt4XSBLZWsgTWFzdGVybm9kZXM6IEFsbCBwbGF5ZXJzIHdobyBlbnRlciB0aGUgY29udHJhY3QgdGhyb3VnaCB5b3VyIE1hc3Rlcm5vZGUgaGF2ZSAzNSUgb2YgdGhlaXIgMjAlIGRpdmlkZW5kcyBmZWUgcmVyb3V0ZWQgZnJvbSB0aGUgbWFzdGVyLW5vZGUsIHRvIHRoZSBub2RlLW1hc3RlciEKKgoqIFRoZSBlbnRpcmUgY3J5cHRvY3VycmVuY3kgY29tbXVuaXR5IHN1ZmZlcnMgZnJvbSBvbmUgYWlsbWVudCwgdGhlIGFpbG1lbnQgb2YgZGlzbG95YWx0eS4gSXQncyB0aGUgcHJvYmxlbSB0aGF0IGlzIGVhdGluZyBhd2F5IGF0IG91ciB2ZXJ5IHN1cnZpdmFsLgoqIFRoaXMgY29pbiBzb2x2ZXMgdGhhdCBwcm9ibGVtLiBJZiB5b3UgZG9uJ3QgaGF2ZSBLZWsgaW4geW91cnNlbGYsIHRoaXMgY29pbiBpcyBub3QgZm9yIHlvdS4gSWYgeW91IGNhbiBiZWxpdmUgaW4gZGl2aW5pdHkgY3JhbmsgdXAgdGhlIG1pbmVycyBhbmQgZ2V0IHRvIHdvcmshCiovCgpjb250cmFjdCBTdHJvbmdLZWsgewogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgID0gICAgICAgICAgICBNT0RJRklFUlMgICAgICAgICAgICA9CiAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgLy8gb25seSBwZW9wbGUgd2l0aCB0b2tlbnMKICAgIG1vZGlmaWVyIG9ubHlCYWdob2xkZXJzKCkgewogICAgICAgIHJlcXVpcmUobXlUb2tlbnMoKSA+IDApOwogICAgICAgIF87CiAgICB9CgogICAgLy8gb25seSBwZW9wbGUgd2l0aCBwcm9maXRzCiAgICBtb2RpZmllciBvbmx5U3Ryb25naGFuZHMoKSB7CiAgICAgICAgcmVxdWlyZShteURpdmlkZW5kcyh0cnVlKSA+IDApOwogICAgICAgIF87CiAgICB9CgogICAgLy8gYWRtaW5pc3RyYXRvcnMgY2FuOgogICAgLy8gLT4gY2hhbmdlIHRoZSBuYW1lIG9mIHRoZSBjb250cmFjdAogICAgLy8gLT4gY2hhbmdlIHRoZSBuYW1lIG9mIHRoZSB0b2tlbgogICAgLy8gLT4gY2hhbmdlIHRoZSBQb1MgZGlmZmljdWx0eSAoSG93IG1hbnkgdG9rZW5zIGl0IGNvc3RzIHRvIGhvbGQgYSBtYXN0ZXJub2RlLCBpbiBjYXNlIGl0IGdldHMgY3JhenkgaGlnaCBsYXRlcikKICAgIC8vIHRoZXkgQ0FOTk9UOgogICAgLy8gLT4gdGFrZSBmdW5kcwogICAgLy8gLT4gZGlzYWJsZSB3aXRoZHJhd2FscwogICAgLy8gLT4ga2lsbCB0aGUgY29udHJhY3QKICAgIC8vIC0+IGNoYW5nZSB0aGUgcHJpY2Ugb2YgdG9rZW5zCiAgICBtb2RpZmllciBvbmx5QWRtaW5pc3RyYXRvcigpewogICAgICAgIGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgcmVxdWlyZShhZG1pbmlzdHJhdG9yc1trZWNjYWsyNTYoX2N1c3RvbWVyQWRkcmVzcyldKTsKICAgICAgICBfOwogICAgfQoKCiAgICAvLyBlbnN1cmVzIHRoYXQgdGhlIGZpcnN0IHRva2VucyBpbiB0aGUgY29udHJhY3Qgd2lsbCBiZSBlcXVhbGx5IGRpc3RyaWJ1dGVkCiAgICAvLyBtZWFuaW5nLCBubyBkaXZpbmUgZHVtcCB3aWxsIGJlIGV2ZXIgcG9zc2libGUKICAgIC8vIHJlc3VsdDogaGVhbHRoeSBsb25nZXZpdHkuCiAgICBtb2RpZmllciBhbnRpRWFybHlXaGFsZSh1aW50MjU2IF9hbW91bnRPZkV0aGVyZXVtKXsKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwoKICAgICAgICAvLyBhcmUgd2Ugc3RpbGwgaW4gdGhlIHZ1bG5lcmFibGUgcGhhc2U/CiAgICAgICAgLy8gaWYgc28sIGVuYWN0IGFudGkgZWFybHkgd2hhbGUgcHJvdG9jb2wKICAgICAgICBpZiggb25seUFtYmFzc2Fkb3JzICYmICgodG90YWxFdGhlcmV1bUJhbGFuY2UoKSAtIF9hbW91bnRPZkV0aGVyZXVtKSA8PSBhbWJhc3NhZG9yUXVvdGFfICkpewogICAgICAgICAgICByZXF1aXJlKAogICAgICAgICAgICAgICAgLy8gaXMgdGhlIGN1c3RvbWVyIGluIHRoZSBhbWJhc3NhZG9yIGxpc3Q/CiAgICAgICAgICAgICAgICBhbWJhc3NhZG9yc19bX2N1c3RvbWVyQWRkcmVzc10gPT0gdHJ1ZSAmJgoKICAgICAgICAgICAgICAgIC8vIGRvZXMgdGhlIGN1c3RvbWVyIHB1cmNoYXNlIGV4Y2VlZCB0aGUgbWF4IGFtYmFzc2Fkb3IgcXVvdGE/CiAgICAgICAgICAgICAgICAoYW1iYXNzYWRvckFjY3VtdWxhdGVkUXVvdGFfW19jdXN0b21lckFkZHJlc3NdICsgX2Ftb3VudE9mRXRoZXJldW0pIDw9IGFtYmFzc2Fkb3JNYXhQdXJjaGFzZV8KCiAgICAgICAgICAgICk7CgogICAgICAgICAgICAvLyB1cGRhdGVkIHRoZSBhY2N1bXVsYXRlZCBxdW90YQogICAgICAgICAgICBhbWJhc3NhZG9yQWNjdW11bGF0ZWRRdW90YV9bX2N1c3RvbWVyQWRkcmVzc10gPSBTYWZlTWF0aC5hZGQoYW1iYXNzYWRvckFjY3VtdWxhdGVkUXVvdGFfW19jdXN0b21lckFkZHJlc3NdLCBfYW1vdW50T2ZFdGhlcmV1bSk7CgogICAgICAgICAgICAvLyBleGVjdXRlCiAgICAgICAgICAgIF87CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gaW4gY2FzZSB0aGUgZXRoZXIgY291bnQgZHJvcHMgbG93LCB0aGUgYW1iYXNzYWRvciBwaGFzZSB3b24ndCByZWluaXRpYXRlCiAgICAgICAgICAgIG9ubHlBbWJhc3NhZG9ycyA9IGZhbHNlOwogICAgICAgICAgICBfOwogICAgICAgIH0KICAgIH0KCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgPSAgICAgICAgICAgIEVWRU5UUyAgICAgICAgICAgID0KICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgICBldmVudCBvblRva2VuUHVyY2hhc2UoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIGN1c3RvbWVyQWRkcmVzcywKICAgICAgICB1aW50MjU2IGluY29taW5nRXRoZXJldW0sCiAgICAgICAgdWludDI1NiB0b2tlbnNNaW50ZWQsCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIHJlZmVycmVkQnkKICAgICk7CgogICAgZXZlbnQgb25Ub2tlblNlbGwoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIGN1c3RvbWVyQWRkcmVzcywKICAgICAgICB1aW50MjU2IHRva2Vuc0J1cm5lZCwKICAgICAgICB1aW50MjU2IGV0aGVyZXVtRWFybmVkCiAgICApOwoKICAgIGV2ZW50IG9uUmVpbnZlc3RtZW50KAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBjdXN0b21lckFkZHJlc3MsCiAgICAgICAgdWludDI1NiBldGhlcmV1bVJlaW52ZXN0ZWQsCiAgICAgICAgdWludDI1NiB0b2tlbnNNaW50ZWQKICAgICk7CgogICAgZXZlbnQgb25XaXRoZHJhdygKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgY3VzdG9tZXJBZGRyZXNzLAogICAgICAgIHVpbnQyNTYgZXRoZXJldW1XaXRoZHJhd24KICAgICk7CgogICAgLy8gRVJDMjAKICAgIGV2ZW50IFRyYW5zZmVyKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBmcm9tLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCB0bywKICAgICAgICB1aW50MjU2IHRva2VucwogICAgKTsKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgID0gICAgICAgICAgICBDT05GSUdVUkFCTEVTICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgICBzdHJpbmcgcHVibGljIG5hbWUgPSAiUHJvcGhlY3lPZktlayI7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbCA9ICJQT0siOwogICAgdWludDggY29uc3RhbnQgcHVibGljIGRlY2ltYWxzID0gMTg7CiAgICB1aW50OCBjb25zdGFudCBpbnRlcm5hbCBlbnRyeUZlZV8gPSAxNTsgLy8gMTUlIHRvIGVudGVyIHRoZSBLZWsgY29udGVzdAogICAgdWludDggY29uc3RhbnQgaW50ZXJuYWwgdHJhbnNmZXJGZWVfID0gMTA7IC8vIDEwJSB0cmFuc2ZlciBmZWUKICAgIHVpbnQ4IGNvbnN0YW50IGludGVybmFsIHJlZmZlcmFsRmVlXyA9IDQ3OyAvLyA0NyUgZnJvbSBlbnRlciBmZWUgZGl2cyBvciA3JSBmb3IgZWFjaCBpbnZpdGUsIGdyZWF0IGZvciBpbnZpdGluZyBzdHJvbmcgbmV3IEtla3MKICAgIHVpbnQ4IGNvbnN0YW50IGludGVybmFsIGV4aXRGZWVfID0gMTU7IC8vIDE1JSBmb3Igc2VsbGluZywgd2VhayBrZWtzIG91dAogICAgdWludDI1NiBjb25zdGFudCBpbnRlcm5hbCB0b2tlblByaWNlSW5pdGlhbF8gPSAwLjAwMDAwMDEgZXRoZXI7CiAgICB1aW50MjU2IGNvbnN0YW50IGludGVybmFsIHRva2VuUHJpY2VJbmNyZW1lbnRhbF8gPSAwLjAwMDAwMDAxIGV0aGVyOwogICAgdWludDI1NiBjb25zdGFudCBpbnRlcm5hbCBtYWduaXR1ZGUgPSAyKio2NDsKCiAgICAvLyBwcm9vZiBvZiBzdGFrZSAoZGVmYXVsdHMgYXQgNTAgdG9rZW5zKQogICAgdWludDI1NiBwdWJsaWMgc3Rha2luZ1JlcXVpcmVtZW50ID0gNTBlMTg7CgogICAgLy8gYW1iYXNzYWRvciBwcm9ncmFtCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgaW50ZXJuYWwgYW1iYXNzYWRvcnNfOwogICAgdWludDI1NiBjb25zdGFudCBpbnRlcm5hbCBhbWJhc3NhZG9yTWF4UHVyY2hhc2VfID0gMSBldGhlcjsKICAgIHVpbnQyNTYgY29uc3RhbnQgaW50ZXJuYWwgYW1iYXNzYWRvclF1b3RhXyA9IDIwIGV0aGVyOwoKICAgIC8vIHJlZmVycmFsIHByb2dyYW0KICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBpbnRlcm5hbCByZWZlcnJhbHM7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgaW50ZXJuYWwgaXNVc2VyOwogICAgYWRkcmVzc1tdIHB1YmxpYyB1c2Vyc0FkZHJlc3NlczsKCiAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgID0gICAgICAgICAgICBEQVRBU0VUUyAgICAgICAgICAgID0KICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIC8vIGFtb3VudCBvZiBzaGFyZXMgZm9yIGVhY2ggYWRkcmVzcyAoc2NhbGVkIG51bWJlcikKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBpbnRlcm5hbCB0b2tlbkJhbGFuY2VMZWRnZXJfOwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGludGVybmFsIHJlZmVycmFsQmFsYW5jZV87CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gaW50MjU2KSBpbnRlcm5hbCBwYXlvdXRzVG9fOwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGludGVybmFsIGFtYmFzc2Fkb3JBY2N1bXVsYXRlZFF1b3RhXzsKICAgIHVpbnQyNTYgaW50ZXJuYWwgdG9rZW5TdXBwbHlfID0gMDsKICAgIHVpbnQyNTYgaW50ZXJuYWwgcHJvZml0UGVyU2hhcmVfOwoKICAgIC8vIGFkbWluaXN0cmF0b3IgbGlzdCAoc2VlIGFib3ZlIG9uIHdoYXQgdGhleSBjYW4gZG8pCiAgICBtYXBwaW5nKGJ5dGVzMzIgPT4gYm9vbCkgcHVibGljIGFkbWluaXN0cmF0b3JzOwoKICAgIC8vIHdoZW4gdGhpcyBpcyBzZXQgdG8gdHJ1ZSwgb25seSBhbWJhc3NhZG9ycyBjYW4gcHVyY2hhc2UgdG9rZW5zICh0aGlzIHByZXZlbnRzIGEgd2hhbGUgcHJlbWluZSwgaXQgZW5zdXJlcyBhIGZhaXJseSBkaXN0cmlidXRlZCB1cHBlciBweXJhbWlkKQogICAgYm9vbCBwdWJsaWMgb25seUFtYmFzc2Fkb3JzID0gZmFsc2U7CgoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICA9ICAgICAgICAgICAgUFVCTElDIEZVTkNUSU9OUyAgICAgICAgICAgID0KICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgICAvKgogICAgKiAtLSBBUFBMSUNBVElPTiBFTlRSWSBQT0lOVFMgLS0KICAgICovCiAgICBmdW5jdGlvbiBTdHJvbmdLZWsoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIC8vIGFkZCBhZG1pbmlzdHJhdG9ycyBoZXJlCiAgICAgICAgYWRtaW5pc3RyYXRvcnNbMHg3MjY3MmY1YTVmMWYwZDFiZDUxZDc1ZGE4YTYxYjNiY2JmNmVmZGQ0MDg4OGU3YWRiNTk4NjliZDQ2Yjc0OTBlXSA9IGZhbHNlOwogICAgfQoKCiAgICAvKioKICAgICAqIENvbnZlcnRzIGFsbCBpbmNvbWluZyBldGhlcmV1bSB0byB0b2tlbnMgZm9yIHRoZSBjYWxsZXIsIGFuZCBwYXNzZXMgZG93biB0aGUgcmVmZXJyYWwgYWRkeSAoaWYgYW55KQogICAgICovCiAgICBmdW5jdGlvbiBidXkoYWRkcmVzcyBfcmVmZXJyZWRCeSkKICAgICAgICBwdWJsaWMKICAgICAgICBwYXlhYmxlCiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIHB1cmNoYXNlVG9rZW5zKG1zZy52YWx1ZSwgX3JlZmVycmVkQnkpOwogICAgfQoKICAgIC8qKgogICAgICogRmFsbGJhY2sgZnVuY3Rpb24gdG8gaGFuZGxlIGV0aGVyZXVtIHRoYXQgd2FzIHNlbmQgc3RyYWlnaHQgdG8gdGhlIGNvbnRyYWN0CiAgICAgKiBVbmZvcnR1bmF0ZWx5IHdlIGNhbm5vdCB1c2UgYSByZWZlcnJhbCBhZGRyZXNzIHRoaXMgd2F5LgogICAgICovCiAgICBmdW5jdGlvbigpCiAgICAgICAgcGF5YWJsZQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIHB1cmNoYXNlVG9rZW5zKG1zZy52YWx1ZSwgMHgwKTsKICAgIH0KCiAgICAvKiBDb252ZXJ0cyBhbGwgb2YgY2FsbGVyJ3MgZGl2aWRlbmRzIHRvIHRva2Vucy4gKi8KICAgIGZ1bmN0aW9uIHJlaW52ZXN0KCkgb25seVN0cm9uZ2hhbmRzKCkgcHVibGljIHsKICAgICAgICAvLyBmZXRjaCBkaXZpZGVuZHMKICAgICAgICB1aW50MjU2IF9kaXZpZGVuZHMgPSBteURpdmlkZW5kcyhmYWxzZSk7IC8vIHJldHJpZXZlIHJlZi4gYm9udXMgbGF0ZXIgaW4gdGhlIGNvZGUKCiAgICAgICAgLy8gcGF5IG91dCB0aGUgZGl2aWRlbmRzIHZpcnR1YWxseQogICAgICAgIGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgcGF5b3V0c1RvX1tfY3VzdG9tZXJBZGRyZXNzXSArPSAgKGludDI1NikgKF9kaXZpZGVuZHMgKiBtYWduaXR1ZGUpOwoKICAgICAgICAvLyByZXRyaWV2ZSByZWYuIGJvbnVzCiAgICAgICAgX2RpdmlkZW5kcyArPSByZWZlcnJhbEJhbGFuY2VfW19jdXN0b21lckFkZHJlc3NdOwogICAgICAgIHJlZmVycmFsQmFsYW5jZV9bX2N1c3RvbWVyQWRkcmVzc10gPSAwOwoKICAgICAgICAvLyBkaXNwYXRjaCBhIGJ1eSBvcmRlciB3aXRoIHRoZSB2aXJ0dWFsaXplZCAid2l0aGRyYXduIGRpdmlkZW5kcyIKICAgICAgICB1aW50MjU2IF90b2tlbnMgPSBwdXJjaGFzZVRva2VucyhfZGl2aWRlbmRzLCAweDApOwoKICAgICAgICAvLyBmaXJlIGV2ZW50CiAgICAgICAgb25SZWludmVzdG1lbnQoX2N1c3RvbWVyQWRkcmVzcywgX2RpdmlkZW5kcywgX3Rva2Vucyk7CiAgICB9CgogICAgLyogQWxpYXMgb2Ygc2VsbCgpIGFuZCB3aXRoZHJhdygpLiAqLwogICAgZnVuY3Rpb24gZXhpdCgpIHB1YmxpYyB7CiAgICAgICAgLy8gZ2V0IHRva2VuIGNvdW50IGZvciBjYWxsZXIgJiBzZWxsIHRoZW0gYWxsCiAgICAgICAgYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICB1aW50MjU2IF90b2tlbnMgPSB0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdOwogICAgICAgIGlmKF90b2tlbnMgPiAwKSBzZWxsKF90b2tlbnMpOwoKICAgICAgICAvLyBsYW1ibyBkZWxpdmVyeSBzZXJ2aWNlCiAgICAgICAgd2l0aGRyYXcoKTsKICAgIH0KCiAgICAvKiBXaXRoZHJhd3MgYWxsIG9mIHRoZSBjYWxsZXJzIGVhcm5pbmdzLiAqLwogICAgZnVuY3Rpb24gd2l0aGRyYXcoKSBvbmx5U3Ryb25naGFuZHMoKSBwdWJsaWMgewogICAgICAgIC8vIHNldHVwIGRhdGEKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IG15RGl2aWRlbmRzKGZhbHNlKTsgLy8gZ2V0IHJlZi4gYm9udXMgbGF0ZXIgaW4gdGhlIGNvZGUKCiAgICAgICAgLy8gdXBkYXRlIGRpdmlkZW5kIHRyYWNrZXIKICAgICAgICBwYXlvdXRzVG9fW19jdXN0b21lckFkZHJlc3NdICs9ICAoaW50MjU2KSAoX2RpdmlkZW5kcyAqIG1hZ25pdHVkZSk7CgogICAgICAgIC8vIGFkZCByZWYuIGJvbnVzCiAgICAgICAgX2RpdmlkZW5kcyArPSByZWZlcnJhbEJhbGFuY2VfW19jdXN0b21lckFkZHJlc3NdOwogICAgICAgIHJlZmVycmFsQmFsYW5jZV9bX2N1c3RvbWVyQWRkcmVzc10gPSAwOwoKICAgICAgICAvLyBsYW1ibyBkZWxpdmVyeSBzZXJ2aWNlCiAgICAgICAgX2N1c3RvbWVyQWRkcmVzcy50cmFuc2ZlcihfZGl2aWRlbmRzKTsKCiAgICAgICAgLy8gZmlyZSBldmVudAogICAgICAgIG9uV2l0aGRyYXcoX2N1c3RvbWVyQWRkcmVzcywgX2RpdmlkZW5kcyk7CiAgICB9CgogICAgLyogTGlxdWlmaWVzIHRva2VucyB0byBldGhlcmV1bS4gKi8KICAgIGZ1bmN0aW9uIHNlbGwodWludDI1NiBfYW1vdW50T2ZUb2tlbnMpIG9ubHlCYWdob2xkZXJzKCkgcHVibGljIHsKICAgICAgICAvLyBzZXR1cCBkYXRhCiAgICAgICAgYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICAvLyBydXNzaWFuIGhhY2tlcnMgQlRGTwogICAgICAgIHJlcXVpcmUoX2Ftb3VudE9mVG9rZW5zIDw9IHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc10pOwogICAgICAgIHVpbnQyNTYgX3Rva2VucyA9IF9hbW91bnRPZlRva2VuczsKICAgICAgICB1aW50MjU2IF9ldGhlcmV1bSA9IHRva2Vuc1RvRXRoZXJldW1fKF90b2tlbnMpOwogICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoX2V0aGVyZXVtLCBleGl0RmVlXyksIDEwMCk7CiAgICAgICAgdWludDI1NiBfdGF4ZWRFdGhlcmV1bSA9IFNhZmVNYXRoLnN1YihfZXRoZXJldW0sIF9kaXZpZGVuZHMpOwoKICAgICAgICAvLyBidXJuIHRoZSBzb2xkIHRva2VucwogICAgICAgIHRva2VuU3VwcGx5XyA9IFNhZmVNYXRoLnN1Yih0b2tlblN1cHBseV8sIF90b2tlbnMpOwogICAgICAgIHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc10gPSBTYWZlTWF0aC5zdWIodG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSwgX3Rva2Vucyk7CgogICAgICAgIC8vIHVwZGF0ZSBkaXZpZGVuZHMgdHJhY2tlcgogICAgICAgIGludDI1NiBfdXBkYXRlZFBheW91dHMgPSAoaW50MjU2KSAocHJvZml0UGVyU2hhcmVfICogX3Rva2VucyArIChfdGF4ZWRFdGhlcmV1bSAqIG1hZ25pdHVkZSkpOwogICAgICAgIHBheW91dHNUb19bX2N1c3RvbWVyQWRkcmVzc10gLT0gX3VwZGF0ZWRQYXlvdXRzOwoKICAgICAgICAvLyBkaXZpZGluZyBieSB6ZXJvIGlzIGEgYmFkIGlkZWEKICAgICAgICBpZiAodG9rZW5TdXBwbHlfID4gMCkgewogICAgICAgICAgICAvLyB1cGRhdGUgdGhlIGFtb3VudCBvZiBkaXZpZGVuZHMgcGVyIHRva2VuCiAgICAgICAgICAgIHByb2ZpdFBlclNoYXJlXyA9IFNhZmVNYXRoLmFkZChwcm9maXRQZXJTaGFyZV8sIChfZGl2aWRlbmRzICogbWFnbml0dWRlKSAvIHRva2VuU3VwcGx5Xyk7CiAgICAgICAgfQoKICAgICAgICAvLyBmaXJlIGV2ZW50CiAgICAgICAgb25Ub2tlblNlbGwoX2N1c3RvbWVyQWRkcmVzcywgX3Rva2VucywgX3RheGVkRXRoZXJldW0pOwogICAgfQoKCiAgICAvKiBUcmFuc2ZlciB0b2tlbnMgZnJvbSB0aGUgY2FsbGVyIHRvIGEgbmV3IGhvbGRlci4gKiBSZW1lbWJlciwgdGhlcmUncyBhIDEwJSBmZWUgaGVyZSBhcyB3ZWxsLiAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG9BZGRyZXNzLCB1aW50MjU2IF9hbW91bnRPZlRva2Vucykgb25seUJhZ2hvbGRlcnMoKSBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgLy8gc2V0dXAKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwoKICAgICAgICAvLyBtYWtlIHN1cmUgd2UgaGF2ZSB0aGUgcmVxdWVzdGVkIHRva2VucwogICAgICAgIC8vIGFsc28gZGlzYWJsZXMgdHJhbnNmZXJzIHVudGlsIGFtYmFzc2Fkb3IgcGhhc2UgaXMgb3ZlcgogICAgICAgIC8vICggd2UgZG9udCB3YW50IHdoYWxlIHByZW1pbmVzICkKICAgICAgICByZXF1aXJlKCFvbmx5QW1iYXNzYWRvcnMgJiYgX2Ftb3VudE9mVG9rZW5zIDw9IHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc10pOwoKICAgICAgICAvLyB3aXRoZHJhdyBhbGwgb3V0c3RhbmRpbmcgZGl2aWRlbmRzIGZpcnN0CiAgICAgICAgaWYobXlEaXZpZGVuZHModHJ1ZSkgPiAwKSB3aXRoZHJhdygpOwoKICAgICAgICAvLyBsaXF1aWZ5IDEwJSBvZiB0aGUgdG9rZW5zIHRoYXQgYXJlIHRyYW5zZmVyZWQKICAgICAgICAvLyB0aGVzZSBhcmUgZGlzcGVyc2VkIHRvIHNoYXJlaG9sZGVycwogICAgICAgIHVpbnQyNTYgX3Rva2VuRmVlID0gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChfYW1vdW50T2ZUb2tlbnMsIHRyYW5zZmVyRmVlXyksIDEwMCk7CiAgICAgICAgdWludDI1NiBfdGF4ZWRUb2tlbnMgPSBTYWZlTWF0aC5zdWIoX2Ftb3VudE9mVG9rZW5zLCBfdG9rZW5GZWUpOwogICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IHRva2Vuc1RvRXRoZXJldW1fKF90b2tlbkZlZSk7CgogICAgICAgIC8vIGJ1cm4gdGhlIGZlZSB0b2tlbnMKICAgICAgICB0b2tlblN1cHBseV8gPSBTYWZlTWF0aC5zdWIodG9rZW5TdXBwbHlfLCBfdG9rZW5GZWUpOwoKICAgICAgICAvLyBleGNoYW5nZSB0b2tlbnMKICAgICAgICB0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdID0gU2FmZU1hdGguc3ViKHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc10sIF9hbW91bnRPZlRva2Vucyk7CiAgICAgICAgdG9rZW5CYWxhbmNlTGVkZ2VyX1tfdG9BZGRyZXNzXSA9IFNhZmVNYXRoLmFkZCh0b2tlbkJhbGFuY2VMZWRnZXJfW190b0FkZHJlc3NdLCBfdGF4ZWRUb2tlbnMpOwoKICAgICAgICAvLyB1cGRhdGUgZGl2aWRlbmQgdHJhY2tlcnMKICAgICAgICBwYXlvdXRzVG9fW19jdXN0b21lckFkZHJlc3NdIC09IChpbnQyNTYpIChwcm9maXRQZXJTaGFyZV8gKiBfYW1vdW50T2ZUb2tlbnMpOwogICAgICAgIHBheW91dHNUb19bX3RvQWRkcmVzc10gKz0gKGludDI1NikgKHByb2ZpdFBlclNoYXJlXyAqIF90YXhlZFRva2Vucyk7CgogICAgICAgIC8vIGRpc3BlcnNlIGRpdmlkZW5kcyBhbW9uZyBob2xkZXJzCiAgICAgICAgcHJvZml0UGVyU2hhcmVfID0gU2FmZU1hdGguYWRkKHByb2ZpdFBlclNoYXJlXywgKF9kaXZpZGVuZHMgKiBtYWduaXR1ZGUpIC8gdG9rZW5TdXBwbHlfKTsKCiAgICAgICAgLy8gZmlyZSBldmVudAogICAgICAgIFRyYW5zZmVyKF9jdXN0b21lckFkZHJlc3MsIF90b0FkZHJlc3MsIF90YXhlZFRva2Vucyk7CgogICAgICAgIC8vIEVSQzIwCiAgICAgICAgcmV0dXJuIHRydWU7CgogICAgfQoKICAgIC8qLS0tLS0tLS0tLSAgQURNSU5JU1RSQVRPUiBPTkxZIEZVTkNUSU9OUyAgLS0tLS0tLS0tLSovCiAgICAvKioKICAgICAqIEluIGNhc2UgdGhlIGFtYXNzYWRvciBxdW90YSBpcyBub3QgbWV0LCB0aGUgYWRtaW5pc3RyYXRvciBjYW4gbWFudWFsbHkgZGlzYWJsZSB0aGUgYW1iYXNzYWRvciBwaGFzZS4KICAgICAqLwogICAgZnVuY3Rpb24gZGlzYWJsZUluaXRpYWxTdGFnZSgpCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIG9ubHlBbWJhc3NhZG9ycyA9IGZhbHNlOwogICAgfQoKICAgIC8qKgogICAgICogSW4gY2FzZSBvbmUgb2YgdXMgZGllcywgd2UgbmVlZCB0byByZXBsYWNlIG91cnNlbHZlcy4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0QWRtaW5pc3RyYXRvcihieXRlczMyIF9pZGVudGlmaWVyLCBib29sIF9zdGF0dXMpCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIGFkbWluaXN0cmF0b3JzW19pZGVudGlmaWVyXSA9IF9zdGF0dXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBQcmVjYXV0aW9uYXJ5IG1lYXN1cmVzIGluIGNhc2Ugd2UgbmVlZCB0byBhZGp1c3QgdGhlIG1hc3Rlcm5vZGUgcmF0ZS4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0U3Rha2luZ1JlcXVpcmVtZW50KHVpbnQyNTYgX2Ftb3VudE9mVG9rZW5zKQogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yKCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICBzdGFraW5nUmVxdWlyZW1lbnQgPSBfYW1vdW50T2ZUb2tlbnM7CiAgICB9CgogICAgLyoqCiAgICAgKiBJZiB3ZSB3YW50IHRvIHJlYnJhbmQsIHdlIGNhbi4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0TmFtZShzdHJpbmcgX25hbWUpCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIG5hbWUgPSBfbmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIElmIHdlIHdhbnQgdG8gcmVicmFuZCwgd2UgY2FuLgogICAgICovCiAgICBmdW5jdGlvbiBzZXRTeW1ib2woc3RyaW5nIF9zeW1ib2wpCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIHN5bWJvbCA9IF9zeW1ib2w7CiAgICB9CgoKICAgIC8qLS0tLS0tLS0tLSAgSEVMUEVSUyBBTkQgQ0FMQ1VMQVRPUlMgIC0tLS0tLS0tLS0qLwogICAgLyoqCiAgICAgKiBNZXRob2QgdG8gdmlldyB0aGUgY3VycmVudCBFdGhlcmV1bSBzdG9yZWQgaW4gdGhlIGNvbnRyYWN0CiAgICAgKiBFeGFtcGxlOiB0b3RhbEV0aGVyZXVtQmFsYW5jZSgpCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRvdGFsRXRoZXJldW1CYWxhbmNlKCkKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyh1aW50KQogICAgewogICAgICAgIHJldHVybiB0aGlzLmJhbGFuY2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXRyaWV2ZSB0aGUgdG90YWwgdG9rZW4gc3VwcGx5LgogICAgICovCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICByZXR1cm4gdG9rZW5TdXBwbHlfOwogICAgfQoKICAgIC8qKgogICAgICogUmV0cmlldmUgdGhlIHRva2VucyBvd25lZCBieSB0aGUgY2FsbGVyLgogICAgICovCiAgICBmdW5jdGlvbiBteVRva2VucygpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIHJldHVybiBiYWxhbmNlT2YoX2N1c3RvbWVyQWRkcmVzcyk7CiAgICB9CgogICAgZnVuY3Rpb24gcmVmZXJyYWxzT2YoYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzKQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgcmV0dXJuIHJlZmVycmFsc1tfY3VzdG9tZXJBZGRyZXNzXTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b3RhbFVzZXJzKCkKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIHJldHVybiB1c2Vyc0FkZHJlc3Nlcy5sZW5ndGg7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXRyaWV2ZSB0aGUgZGl2aWRlbmRzIG93bmVkIGJ5IHRoZSBjYWxsZXIuCiAgICAgKiBJZiBgX2luY2x1ZGVSZWZlcnJhbEJvbnVzYCBpcyB0byB0byAxL3RydWUsIHRoZSByZWZlcnJhbCBib251cyB3aWxsIGJlIGluY2x1ZGVkIGluIHRoZSBjYWxjdWxhdGlvbnMuCiAgICAgKiBUaGUgcmVhc29uIGZvciB0aGlzLCBpcyB0aGF0IGluIHRoZSBmcm9udGVuZCwgd2Ugd2lsbCB3YW50IHRvIGdldCB0aGUgdG90YWwgZGl2cyAoZ2xvYmFsICsgcmVmKQogICAgICogQnV0IGluIHRoZSBpbnRlcm5hbCBjYWxjdWxhdGlvbnMsIHdlIHdhbnQgdGhlbSBzZXBhcmF0ZS4KICAgICAqLwogICAgZnVuY3Rpb24gbXlEaXZpZGVuZHMoYm9vbCBfaW5jbHVkZVJlZmVycmFsQm9udXMpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIHJldHVybiBfaW5jbHVkZVJlZmVycmFsQm9udXMgPyBkaXZpZGVuZHNPZihfY3VzdG9tZXJBZGRyZXNzKSArIHJlZmVycmFsQmFsYW5jZV9bX2N1c3RvbWVyQWRkcmVzc10gOiBkaXZpZGVuZHNPZihfY3VzdG9tZXJBZGRyZXNzKSA7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXRyaWV2ZSB0aGUgdG9rZW4gYmFsYW5jZSBvZiBhbnkgc2luZ2xlIGFkZHJlc3MuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MpCiAgICAgICAgdmlldwogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICByZXR1cm4gdG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHJpZXZlIHRoZSBkaXZpZGVuZCBiYWxhbmNlIG9mIGFueSBzaW5nbGUgYWRkcmVzcy4KICAgICAqLwogICAgZnVuY3Rpb24gZGl2aWRlbmRzT2YoYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzKQogICAgICAgIHZpZXcKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgcmV0dXJuICh1aW50MjU2KSAoKGludDI1NikocHJvZml0UGVyU2hhcmVfICogdG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSkgLSBwYXlvdXRzVG9fW19jdXN0b21lckFkZHJlc3NdKSAvIG1hZ25pdHVkZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgYnV5IHByaWNlIG9mIDEgaW5kaXZpZHVhbCB0b2tlbi4KICAgICAqLwogICAgZnVuY3Rpb24gc2VsbFByaWNlKCkKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIC8vIG91ciBjYWxjdWxhdGlvbiByZWxpZXMgb24gdGhlIHRva2VuIHN1cHBseSwgc28gd2UgbmVlZCBzdXBwbHkuIERvaC4KICAgICAgICBpZih0b2tlblN1cHBseV8gPT0gMCl7CiAgICAgICAgICAgIHJldHVybiB0b2tlblByaWNlSW5pdGlhbF8gLSB0b2tlblByaWNlSW5jcmVtZW50YWxfOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHVpbnQyNTYgX2V0aGVyZXVtID0gdG9rZW5zVG9FdGhlcmV1bV8oMWUxOCk7CiAgICAgICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoX2V0aGVyZXVtLCBleGl0RmVlXyksIDEwMCk7CiAgICAgICAgICAgIHVpbnQyNTYgX3RheGVkRXRoZXJldW0gPSBTYWZlTWF0aC5zdWIoX2V0aGVyZXVtLCBfZGl2aWRlbmRzKTsKICAgICAgICAgICAgcmV0dXJuIF90YXhlZEV0aGVyZXVtOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgc2VsbCBwcmljZSBvZiAxIGluZGl2aWR1YWwgdG9rZW4uCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJ1eVByaWNlKCkKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIC8vIG91ciBjYWxjdWxhdGlvbiByZWxpZXMgb24gdGhlIHRva2VuIHN1cHBseSwgc28gd2UgbmVlZCBzdXBwbHkuIERvaC4KICAgICAgICBpZih0b2tlblN1cHBseV8gPT0gMCl7CiAgICAgICAgICAgIHJldHVybiB0b2tlblByaWNlSW5pdGlhbF8gKyB0b2tlblByaWNlSW5jcmVtZW50YWxfOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHVpbnQyNTYgX2V0aGVyZXVtID0gdG9rZW5zVG9FdGhlcmV1bV8oMWUxOCk7CiAgICAgICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoX2V0aGVyZXVtLCBlbnRyeUZlZV8pLCAxMDApOwogICAgICAgICAgICB1aW50MjU2IF90YXhlZEV0aGVyZXVtID0gU2FmZU1hdGguYWRkKF9ldGhlcmV1bSwgX2RpdmlkZW5kcyk7CiAgICAgICAgICAgIHJldHVybiBfdGF4ZWRFdGhlcmV1bTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBGdW5jdGlvbiBmb3IgdGhlIGZyb250ZW5kIHRvIGR5bmFtaWNhbGx5IHJldHJpZXZlIHRoZSBwcmljZSBzY2FsaW5nIG9mIGJ1eSBvcmRlcnMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZVRva2Vuc1JlY2VpdmVkKHVpbnQyNTYgX2V0aGVyZXVtVG9TcGVuZCkKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoX2V0aGVyZXVtVG9TcGVuZCwgZW50cnlGZWVfKSwgMTAwKTsKICAgICAgICB1aW50MjU2IF90YXhlZEV0aGVyZXVtID0gU2FmZU1hdGguc3ViKF9ldGhlcmV1bVRvU3BlbmQsIF9kaXZpZGVuZHMpOwogICAgICAgIHVpbnQyNTYgX2Ftb3VudE9mVG9rZW5zID0gZXRoZXJldW1Ub1Rva2Vuc18oX3RheGVkRXRoZXJldW0pOwoKICAgICAgICByZXR1cm4gX2Ftb3VudE9mVG9rZW5zOwogICAgfQoKICAgIC8qKgogICAgICogRnVuY3Rpb24gZm9yIHRoZSBmcm9udGVuZCB0byBkeW5hbWljYWxseSByZXRyaWV2ZSB0aGUgcHJpY2Ugc2NhbGluZyBvZiBzZWxsIG9yZGVycy4KICAgICAqLwogICAgZnVuY3Rpb24gY2FsY3VsYXRlRXRoZXJldW1SZWNlaXZlZCh1aW50MjU2IF90b2tlbnNUb1NlbGwpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICByZXF1aXJlKF90b2tlbnNUb1NlbGwgPD0gdG9rZW5TdXBwbHlfKTsKICAgICAgICB1aW50MjU2IF9ldGhlcmV1bSA9IHRva2Vuc1RvRXRoZXJldW1fKF90b2tlbnNUb1NlbGwpOwogICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoX2V0aGVyZXVtLCBleGl0RmVlXyksIDEwMCk7CiAgICAgICAgdWludDI1NiBfdGF4ZWRFdGhlcmV1bSA9IFNhZmVNYXRoLnN1YihfZXRoZXJldW0sIF9kaXZpZGVuZHMpOwogICAgICAgIHJldHVybiBfdGF4ZWRFdGhlcmV1bTsKICAgIH0KCgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgID0gICAgICAgICAgICBJTlRFUk5BTCBGVU5DVElPTlMgICAgICAgICAgICA9CiAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgZnVuY3Rpb24gcHVyY2hhc2VUb2tlbnModWludDI1NiBfaW5jb21pbmdFdGhlcmV1bSwgYWRkcmVzcyBfcmVmZXJyZWRCeSkKICAgICAgICBhbnRpRWFybHlXaGFsZShfaW5jb21pbmdFdGhlcmV1bSkKICAgICAgICBpbnRlcm5hbAogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICAvLyBkYXRhIHNldHVwCiAgICAgICAgYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICB1aW50MjU2IF91bmRpdmlkZWREaXZpZGVuZHMgPSBTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKF9pbmNvbWluZ0V0aGVyZXVtLCBlbnRyeUZlZV8pLCAxMDApOwogICAgICAgIHVpbnQyNTYgX3JlZmVycmFsQm9udXMgPSBTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKF91bmRpdmlkZWREaXZpZGVuZHMsIHJlZmZlcmFsRmVlXyksIDEwMCk7CiAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gU2FmZU1hdGguc3ViKF91bmRpdmlkZWREaXZpZGVuZHMsIF9yZWZlcnJhbEJvbnVzKTsKICAgICAgICB1aW50MjU2IF90YXhlZEV0aGVyZXVtID0gU2FmZU1hdGguc3ViKF9pbmNvbWluZ0V0aGVyZXVtLCBfdW5kaXZpZGVkRGl2aWRlbmRzKTsKICAgICAgICB1aW50MjU2IF9hbW91bnRPZlRva2VucyA9IGV0aGVyZXVtVG9Ub2tlbnNfKF90YXhlZEV0aGVyZXVtKTsKICAgICAgICB1aW50MjU2IF9mZWUgPSBfZGl2aWRlbmRzICogbWFnbml0dWRlOwoKICAgICAgICAvLyBubyBwb2ludCBpbiBjb250aW51aW5nIGV4ZWN1dGlvbiBpZiBPUCBpcyBhIHBvb3JmYWcgcnVzc2lhbiBoYWNrZXIKICAgICAgICAvLyBwcmV2ZW50cyBvdmVyZmxvdyBpbiB0aGUgY2FzZSB0aGF0IHRoZSBweXJhbWlkIHNvbWVob3cgbWFnaWNhbGx5IHN0YXJ0cyBiZWluZyB1c2VkIGJ5IGV2ZXJ5b25lIGluIHRoZSB3b3JsZAogICAgICAgIC8vIChvciBoYWNrZXJzKQogICAgICAgIC8vIGFuZCB5ZXMgd2Uga25vdyB0aGF0IHRoZSBzYWZlbWF0aCBmdW5jdGlvbiBhdXRvbWF0aWNhbGx5IHJ1bGVzIG91dCB0aGUgImdyZWF0ZXIgdGhlbiIgZXF1YXNpb24uCiAgICAgICAgcmVxdWlyZShfYW1vdW50T2ZUb2tlbnMgPiAwICYmIChTYWZlTWF0aC5hZGQoX2Ftb3VudE9mVG9rZW5zLHRva2VuU3VwcGx5XykgPiB0b2tlblN1cHBseV8pKTsKCiAgICAgICAgaWYgKGlzVXNlcltfY3VzdG9tZXJBZGRyZXNzXSA9PSBmYWxzZSApIHsKICAgICAgICAJaXNVc2VyW19jdXN0b21lckFkZHJlc3NdID0gdHJ1ZTsKICAgICAgICAJdXNlcnNBZGRyZXNzZXMucHVzaChfY3VzdG9tZXJBZGRyZXNzKTsKICAgICAgICB9CgogICAgICAgIC8vIGlzIHRoZSB1c2VyIHJlZmVycmVkIGJ5IGEgbWFzdGVybm9kZT8KICAgICAgICBpZigKICAgICAgICAgICAgLy8gaXMgdGhpcyBhIHJlZmVycmVkIHB1cmNoYXNlPwogICAgICAgICAgICBfcmVmZXJyZWRCeSAhPSAweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAgJiYKCiAgICAgICAgICAgIC8vIG5vIGNoZWF0aW5nIQogICAgICAgICAgICBfcmVmZXJyZWRCeSAhPSBfY3VzdG9tZXJBZGRyZXNzICYmCgogICAgICAgICAgICAvLyBkb2VzIHRoZSByZWZlcnJlciBoYXZlIGF0IGxlYXN0IFggd2hvbGUgdG9rZW5zPwogICAgICAgICAgICAvLyBpLmUgaXMgdGhlIHJlZmVycmVyIGEgS2VrbHkgY2hhZCBtYXN0ZXJub2RlCiAgICAgICAgICAgIHRva2VuQmFsYW5jZUxlZGdlcl9bX3JlZmVycmVkQnldID49IHN0YWtpbmdSZXF1aXJlbWVudAogICAgICAgICl7CiAgICAgICAgICAgIC8vIHdlYWx0aCByZWRpc3RyaWJ1dGlvbgogICAgICAgICAgICByZWZlcnJhbEJhbGFuY2VfW19yZWZlcnJlZEJ5XSA9IFNhZmVNYXRoLmFkZChyZWZlcnJhbEJhbGFuY2VfW19yZWZlcnJlZEJ5XSwgX3JlZmVycmFsQm9udXMpOwogICAgICAgICAgICByZWZlcnJhbHNbX3JlZmVycmVkQnldKys7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gbm8gcmVmIHB1cmNoYXNlCiAgICAgICAgICAgIC8vIGFkZCB0aGUgcmVmZXJyYWwgYm9udXMgYmFjayB0byB0aGUgZ2xvYmFsIGRpdmlkZW5kcyBjYWtlCiAgICAgICAgICAgIF9kaXZpZGVuZHMgPSBTYWZlTWF0aC5hZGQoX2RpdmlkZW5kcywgX3JlZmVycmFsQm9udXMpOwogICAgICAgICAgICBfZmVlID0gX2RpdmlkZW5kcyAqIG1hZ25pdHVkZTsKICAgICAgICB9CgogICAgICAgIC8vIHdlIGNhbid0IGdpdmUgcGVvcGxlIGluZmluaXRlIGV0aGVyZXVtCiAgICAgICAgaWYodG9rZW5TdXBwbHlfID4gMCl7CgogICAgICAgICAgICAvLyBhZGQgdG9rZW5zIHRvIHRoZSBwb29sCiAgICAgICAgICAgIHRva2VuU3VwcGx5XyA9IFNhZmVNYXRoLmFkZCh0b2tlblN1cHBseV8sIF9hbW91bnRPZlRva2Vucyk7CgogICAgICAgICAgICAvLyB0YWtlIHRoZSBhbW91bnQgb2YgZGl2aWRlbmRzIGdhaW5lZCB0aHJvdWdoIHRoaXMgdHJhbnNhY3Rpb24sIGFuZCBhbGxvY2F0ZXMgdGhlbSBldmVubHkgdG8gZWFjaCBzaGFyZWhvbGRlcgogICAgICAgICAgICBwcm9maXRQZXJTaGFyZV8gKz0gKF9kaXZpZGVuZHMgKiBtYWduaXR1ZGUgLyAodG9rZW5TdXBwbHlfKSk7CgogICAgICAgICAgICAvLyBjYWxjdWxhdGUgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhlIGN1c3RvbWVyIHJlY2VpdmVzIG92ZXIgaGlzIHB1cmNoYXNlCiAgICAgICAgICAgIF9mZWUgPSBfZmVlIC0gKF9mZWUtKF9hbW91bnRPZlRva2VucyAqIChfZGl2aWRlbmRzICogbWFnbml0dWRlIC8gKHRva2VuU3VwcGx5XykpKSk7CgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIGFkZCB0b2tlbnMgdG8gdGhlIHBvb2wKICAgICAgICAgICAgdG9rZW5TdXBwbHlfID0gX2Ftb3VudE9mVG9rZW5zOwogICAgICAgIH0KCiAgICAgICAgLy8gdXBkYXRlIGNpcmN1bGF0aW5nIHN1cHBseSAmIHRoZSBsZWRnZXIgYWRkcmVzcyBmb3IgdGhlIGN1c3RvbWVyCiAgICAgICAgdG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSA9IFNhZmVNYXRoLmFkZCh0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdLCBfYW1vdW50T2ZUb2tlbnMpOwoKICAgICAgICAvLyBUZWxscyB0aGUgY29udHJhY3QgdGhhdCB0aGUgYnV5ZXIgZG9lc24ndCBkZXNlcnZlIGRpdmlkZW5kcyBmb3IgdGhlIHRva2VucyBiZWZvcmUgdGhleSBvd25lZCB0aGVtOwogICAgICAgIC8vcmVhbGx5IGkga25vdyB5b3UgdGhpbmsgeW91IGRvIGJ1dCB5b3UgZG9uJ3QKICAgICAgICBpbnQyNTYgX3VwZGF0ZWRQYXlvdXRzID0gKGludDI1NikgKChwcm9maXRQZXJTaGFyZV8gKiBfYW1vdW50T2ZUb2tlbnMpIC0gX2ZlZSk7CiAgICAgICAgcGF5b3V0c1RvX1tfY3VzdG9tZXJBZGRyZXNzXSArPSBfdXBkYXRlZFBheW91dHM7CgogICAgICAgIC8vIGZpcmUgZXZlbnQKICAgICAgICBvblRva2VuUHVyY2hhc2UoX2N1c3RvbWVyQWRkcmVzcywgX2luY29taW5nRXRoZXJldW0sIF9hbW91bnRPZlRva2VucywgX3JlZmVycmVkQnkpOwoKICAgICAgICByZXR1cm4gX2Ftb3VudE9mVG9rZW5zOwogICAgfQoKICAgIC8qKgogICAgICogQ2FsY3VsYXRlIFRva2VuIHByaWNlIGJhc2VkIG9uIGFuIGFtb3VudCBvZiBpbmNvbWluZyBldGhlcmV1bQogICAgICogSXQncyBhbiBhbGdvcml0aG0sIGhvcGVmdWxseSB3ZSBnYXZlIHlvdSB0aGUgd2hpdGVwYXBlciB3aXRoIGl0IGluIHNjaWVudGlmaWMgbm90YXRpb247CiAgICAgKiBTb21lIGNvbnZlcnNpb25zIG9jY3VycmVkIHRvIHByZXZlbnQgZGVjaW1hbCBlcnJvcnMgb3IgdW5kZXJmbG93cyAvIG92ZXJmbG93cyBpbiBzb2xpZGl0eSBjb2RlLgogICAgICovCiAgICBmdW5jdGlvbiBldGhlcmV1bVRvVG9rZW5zXyh1aW50MjU2IF9ldGhlcmV1bSkKICAgICAgICBpbnRlcm5hbAogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgdWludDI1NiBfdG9rZW5QcmljZUluaXRpYWwgPSB0b2tlblByaWNlSW5pdGlhbF8gKiAxZTE4OwogICAgICAgIHVpbnQyNTYgX3Rva2Vuc1JlY2VpdmVkID0KICAgICAgICAgKAogICAgICAgICAgICAoCiAgICAgICAgICAgICAgICAvLyB1bmRlcmZsb3cgYXR0ZW1wdHMgQlRGTwogICAgICAgICAgICAgICAgU2FmZU1hdGguc3ViKAogICAgICAgICAgICAgICAgICAgIChzcXJ0CiAgICAgICAgICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfdG9rZW5QcmljZUluaXRpYWwqKjIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoMioodG9rZW5QcmljZUluY3JlbWVudGFsXyAqIDFlMTgpKihfZXRoZXJldW0gKiAxZTE4KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICgoKHRva2VuUHJpY2VJbmNyZW1lbnRhbF8pKioyKSoodG9rZW5TdXBwbHlfKioyKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICgyKih0b2tlblByaWNlSW5jcmVtZW50YWxfKSpfdG9rZW5QcmljZUluaXRpYWwqdG9rZW5TdXBwbHlfKQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgKSwgX3Rva2VuUHJpY2VJbml0aWFsCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkvKHRva2VuUHJpY2VJbmNyZW1lbnRhbF8pCiAgICAgICAgKS0odG9rZW5TdXBwbHlfKQogICAgICAgIDsKCiAgICAgICAgcmV0dXJuIF90b2tlbnNSZWNlaXZlZDsKICAgIH0KCiAgICAvKioKICAgICAqIENhbGN1bGF0ZSB0b2tlbiBzZWxsIHZhbHVlLgogICAgICogSXQncyBhbiBhbGdvcml0aG0sIGhvcGVmdWxseSB3ZSBnYXZlIHlvdSB0aGUgd2hpdGVwYXBlciB3aXRoIGl0IGluIHNjaWVudGlmaWMgbm90YXRpb247CiAgICAgKiBTb21lIGNvbnZlcnNpb25zIG9jY3VycmVkIHRvIHByZXZlbnQgZGVjaW1hbCBlcnJvcnMgb3IgdW5kZXJmbG93cyAvIG92ZXJmbG93cyBpbiBzb2xpZGl0eSBjb2RlLgogICAgICovCiAgICAgZnVuY3Rpb24gdG9rZW5zVG9FdGhlcmV1bV8odWludDI1NiBfdG9rZW5zKQogICAgICAgIGludGVybmFsCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKCiAgICAgICAgdWludDI1NiB0b2tlbnNfID0gKF90b2tlbnMgKyAxZTE4KTsKICAgICAgICB1aW50MjU2IF90b2tlblN1cHBseSA9ICh0b2tlblN1cHBseV8gKyAxZTE4KTsKICAgICAgICB1aW50MjU2IF9ldGhlclJlY2VpdmVkID0KICAgICAgICAoCiAgICAgICAgICAgIC8vIHVuZGVyZmxvdyBhdHRlbXB0cyBCVEZPCiAgICAgICAgICAgIFNhZmVNYXRoLnN1YigKICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAoCiAgICAgICAgICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRva2VuUHJpY2VJbml0aWFsXyArKHRva2VuUHJpY2VJbmNyZW1lbnRhbF8gKiAoX3Rva2VuU3VwcGx5LzFlMTgpKQogICAgICAgICAgICAgICAgICAgICAgICApLXRva2VuUHJpY2VJbmNyZW1lbnRhbF8KICAgICAgICAgICAgICAgICAgICApKih0b2tlbnNfIC0gMWUxOCkKICAgICAgICAgICAgICAgICksKHRva2VuUHJpY2VJbmNyZW1lbnRhbF8qKCh0b2tlbnNfKioyLXRva2Vuc18pLzFlMTgpKS8yCiAgICAgICAgICAgICkKICAgICAgICAvMWUxOCk7CiAgICAgICAgcmV0dXJuIF9ldGhlclJlY2VpdmVkOwogICAgfQoKCiAgICAvL1RoaXMgaXMgd2hlcmUgYWxsIHlvdXIgZ2FzIGdvZXMsIHNvcnJ5CiAgICAvL05vdCBzb3JyeSwgeW91IHByb2JhYmx5IG9ubHkgcGFpZCAxIGd3ZWkKICAgIGZ1bmN0aW9uIHNxcnQodWludCB4KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeSkgewogICAgICAgIHVpbnQgeiA9ICh4ICsgMSkgLyAyOwogICAgICAgIHkgPSB4OwogICAgICAgIHdoaWxlICh6IDwgeSkgewogICAgICAgICAgICB5ID0gejsKICAgICAgICAgICAgeiA9ICh4IC8geiArIHopIC8gMjsKICAgICAgICB9CiAgICB9Cn0KCi8qKgogKiBAdGl0bGUgU2FmZU1hdGgKICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCmxpYnJhcnkgU2FmZU1hdGggewoKICAgIC8qKgogICAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAgICovCiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGlmIChhID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAgICovCiAgICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgU3Vic3RyYWN0cyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93IChpLmUuIGlmIHN1YnRyYWhlbmQgaXMgZ3JlYXRlciB0aGFuIG1pbnVlbmQpLgogICAgKi8KICAgIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgYXNzZXJ0KGIgPD0gYSk7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEFkZHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAgICovCiAgICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgICAgIGFzc2VydChjID49IGEpOwogICAgICAgIHJldHVybiBjOwogICAgfQp9'.
	

]
