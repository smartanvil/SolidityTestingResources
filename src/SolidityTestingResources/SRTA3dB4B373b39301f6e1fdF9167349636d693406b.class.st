Class {
	#name : #SRTA3dB4B373b39301f6e1fdF9167349636d693406b,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTA3dB4B373b39301f6e1fdF9167349636d693406b >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7Cgpjb250cmFjdCBGdWxsRVJDMjAgewogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwogIAogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIHVpbnQ4IHB1YmxpYyBkZWNpbWFsczsKCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7Cn0KCmNvbnRyYWN0IFJld2FyZERpc3RyaWJ1dGFibGUgewogICAgZXZlbnQgVG9rZW5zUmV3YXJkZWQoYWRkcmVzcyBpbmRleGVkIHBsYXllciwgYWRkcmVzcyByZXdhcmRUb2tlbiwgdWludCByZXdhcmRzLCBhZGRyZXNzIHJlcXVlc3RlciwgdWludCBnYW1lSWQsIHVpbnQgYmxvY2spOwogICAgZXZlbnQgUmVmZXJyYWxSZXdhcmRlZChhZGRyZXNzIGluZGV4ZWQgcmVmZXJyZXIsIGFkZHJlc3MgaW5kZXhlZCBwbGF5ZXIsIGFkZHJlc3MgcmV3YXJkVG9rZW4sIHVpbnQgcmV3YXJkcywgdWludCBnYW1lSWQsIHVpbnQgYmxvY2spOwogICAgZXZlbnQgUmVmZXJyYWxSZWdpc3RlcmVkKGFkZHJlc3MgaW5kZXhlZCBwbGF5ZXIsIGFkZHJlc3MgaW5kZXhlZCByZWZlcnJlcik7CgogICAgLy8vIEBkZXYgQ2FsY3VsYXRlcyBhbmQgdHJhbnNmZXJzIHRoZSByZXdhcmRzIHRvIHRoZSBwbGF5ZXIuCiAgICBmdW5jdGlvbiB0cmFuc2ZlclJld2FyZHMoYWRkcmVzcyBwbGF5ZXIsIHVpbnQgZW50cnlBbW91bnQsIHVpbnQgZ2FtZUlkKSBwdWJsaWM7CgogICAgLy8vIEBkZXYgUmV0dXJucyB0aGUgdG90YWwgbnVtYmVyIG9mIHRva2VucywgYWNyb3NzIGFsbCBhcHByb3ZhbHMuCiAgICBmdW5jdGlvbiBnZXRUb3RhbFRva2VucyhhZGRyZXNzIHRva2VuQWRkcmVzcykgcHVibGljIGNvbnN0YW50IHJldHVybnModWludCk7CgogICAgLy8vIEBkZXYgUmV0dXJucyB0aGUgdG90YWwgbnVtYmVyIG9mIHN1cHBvcnRlZCByZXdhcmQgdG9rZW4gY29udHJhY3RzLgogICAgZnVuY3Rpb24gZ2V0UmV3YXJkVG9rZW5Db3VudCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQpOwoKICAgIC8vLyBAZGV2IEdldHMgdGhlIHRvdGFsIG51bWJlciBvZiBhcHByb3ZlcnMuCiAgICBmdW5jdGlvbiBnZXRUb3RhbEFwcHJvdmVycygpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQpOwoKICAgIC8vLyBAZGV2IEdldHMgdGhlIHJld2FyZCByYXRlIGluY2x1c2l2ZSBvZiByZWZlcnJhbCBib251cy4KICAgIGZ1bmN0aW9uIGdldFJld2FyZFJhdGUoYWRkcmVzcyBwbGF5ZXIsIGFkZHJlc3MgdG9rZW5BZGRyZXNzKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50KTsKCiAgICAvLy8gQGRldiBBZGRzIGEgcmVxdWVzdGVyIHRvIHRoZSB3aGl0ZWxpc3QuCiAgICAvLy8gQHBhcmFtIHJlcXVlc3RlciBUaGUgYWRkcmVzcyBvZiBhIGNvbnRyYWN0IHdoaWNoIHdpbGwgcmVxdWVzdCByZXdhcmQgdHJhbnNmZXJzCiAgICBmdW5jdGlvbiBhZGRSZXF1ZXN0ZXIoYWRkcmVzcyByZXF1ZXN0ZXIpIHB1YmxpYzsKCiAgICAvLy8gQGRldiBSZW1vdmVzIGEgcmVxdWVzdGVyIGZyb20gdGhlIHdoaXRlbGlzdC4KICAgIC8vLyBAcGFyYW0gcmVxdWVzdGVyIFRoZSBhZGRyZXNzIG9mIGEgY29udHJhY3Qgd2hpY2ggd2lsbCByZXF1ZXN0IHJld2FyZCB0cmFuc2ZlcnMKICAgIGZ1bmN0aW9uIHJlbW92ZVJlcXVlc3RlcihhZGRyZXNzIHJlcXVlc3RlcikgcHVibGljOwoKICAgIC8vLyBAZGV2IEFkZHMgYSBhcHByb3ZlciBhZGRyZXNzLiAgQXBwcm92YWwgaGFwcGVucyB3aXRoIHRoZSB0b2tlbiBjb250cmFjdC4KICAgIC8vLyBAcGFyYW0gYXBwcm92ZXIgVGhlIGFwcHJvdmVyIGFkZHJlc3MgdG8gYWRkIHRvIHRoZSBwb29sLgogICAgZnVuY3Rpb24gYWRkQXBwcm92ZXIoYWRkcmVzcyBhcHByb3ZlcikgcHVibGljOwoKICAgIC8vLyBAZGV2IFJlbW92ZXMgYW4gYXBwcm92ZXIgYWRkcmVzcy4gCiAgICAvLy8gQHBhcmFtIGFwcHJvdmVyIFRoZSBhcHByb3ZlciBhZGRyZXNzIHRvIHJlbW92ZSBmcm9tIHRoZSBwb29sLgogICAgZnVuY3Rpb24gcmVtb3ZlQXBwcm92ZXIoYWRkcmVzcyBhcHByb3ZlcikgcHVibGljOwoKICAgIC8vLyBAZGV2IFVwZGF0ZXMgdGhlIHJld2FyZCByYXRlCiAgICBmdW5jdGlvbiB1cGRhdGVSZXdhcmRSYXRlKGFkZHJlc3MgdG9rZW5BZGRyZXNzLCB1aW50IG5ld1Jld2FyZFJhdGUpIHB1YmxpYzsKCiAgICAvLy8gQGRldiBVcGRhdGVzIHRoZSB0b2tlbiBhZGRyZXNzIG9mIHRoZSBwYXltZW50IHR5cGUuCiAgICBmdW5jdGlvbiBhZGRSZXdhcmRUb2tlbihhZGRyZXNzIHRva2VuQWRkcmVzcywgdWludCBuZXdSZXdhcmRSYXRlKSBwdWJsaWM7CgogICAgLy8vIEBkZXYgVXBkYXRlcyB0aGUgdG9rZW4gYWRkcmVzcyBvZiB0aGUgcGF5bWVudCB0eXBlLgogICAgZnVuY3Rpb24gcmVtb3ZlUmV3YXJkVG9rZW4oYWRkcmVzcyB0b2tlbkFkZHJlc3MpIHB1YmxpYzsKCiAgICAvLy8gQGRldiBVcGRhdGVzIHRoZSByZWZlcnJhbCBib251cyByYXRlCiAgICBmdW5jdGlvbiB1cGRhdGVSZWZlcnJhbEJvbnVzUmF0ZSh1aW50IG5ld1JlZmVycmFsQm9udXNSYXRlKSBwdWJsaWM7CgogICAgLy8vIEBkZXYgUmVnaXN0ZXJzIHRoZSBwbGF5ZXIgd2l0aCB0aGUgZ2l2ZW4gcmVmZXJyYWwgY29kZQogICAgLy8vIEBwYXJhbSBwbGF5ZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIHBsYXllcgogICAgLy8vIEBwYXJhbSByZWZlcnJlciBUaGUgYWRkcmVzcyBvZiB0aGUgcmVmZXJyZXIKICAgIGZ1bmN0aW9uIHJlZ2lzdGVyUmVmZXJyYWwoYWRkcmVzcyBwbGF5ZXIsIGFkZHJlc3MgcmVmZXJyZXIpIHB1YmxpYzsKCiAgICAvLy8gQGRldiBUcmFuc2ZlcnMgYW55IHRva2VucyB0byB0aGUgb3duZXIKICAgIGZ1bmN0aW9uIGRlc3Ryb3lSZXdhcmRzKCkgcHVibGljOwp9CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKGEgPT0gMCkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9Cgpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCgogIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCmNvbnRyYWN0IFJld2FyZERpc3RyaWJ1dG9yIGlzIFJld2FyZERpc3RyaWJ1dGFibGUsIE93bmFibGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgc3RydWN0IFJld2FyZFNvdXJjZSB7CiAgICAgICAgYWRkcmVzcyByZXdhcmRUb2tlbkFkZHJlc3M7CiAgICAgICAgdWludDk2IHJld2FyZFJhdGU7IC8vIDEgdG9rZW4gZm9yIGV2ZXJ5IHJld2FyZCByYXRlIChpbiB3ZWkpCiAgICB9CgogICAgUmV3YXJkU291cmNlW10gcHVibGljIHJld2FyZFNvdXJjZXM7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIGFwcHJvdmVkUmV3YXJkU291cmNlczsKICAgIAogICAgbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyByZXF1ZXN0ZXJzOyAvLyBkaXN0cmlidXRpb24gcmVxdWVzdGVycwogICAgYWRkcmVzc1tdIHB1YmxpYyBhcHByb3ZlcnM7IC8vIGRpc3RyaWJ1dGlvbiBhcHByb3ZlcnMKCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYWRkcmVzcykgcHVibGljIHJlZmVycmVyczsgLy8gcGxheWVyIC0+IHJlZmVycmVyCiAgICAKICAgIHVpbnQgcHVibGljIHJlZmVycmFsQm9udXNSYXRlOwoKICAgIG1vZGlmaWVyIG9ubHlSZXF1ZXN0ZXJzKCkgewogICAgICAgIHJlcXVpcmUocmVxdWVzdGVyc1ttc2cuc2VuZGVyXSB8fCAobXNnLnNlbmRlciA9PSBvd25lcikpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgdmFsaWRSZXdhcmRTb3VyY2UoYWRkcmVzcyB0b2tlbkFkZHJlc3MpIHsKICAgICAgICByZXF1aXJlKGFwcHJvdmVkUmV3YXJkU291cmNlc1t0b2tlbkFkZHJlc3NdKTsKICAgICAgICBfOyAgICAgICAgCiAgICB9CgogICAgZnVuY3Rpb24gUmV3YXJkRGlzdHJpYnV0b3IodWludDI1NiByZXdhcmRSYXRlLCBhZGRyZXNzIHRva2VuQWRkcmVzcykgcHVibGljIHsKICAgICAgICByZWZlcnJhbEJvbnVzUmF0ZSA9IDEwOwogICAgICAgIGFkZFJld2FyZFRva2VuKHRva2VuQWRkcmVzcywgcmV3YXJkUmF0ZSk7CiAgICB9CgogICAgLy8vIEBkZXYgQ2FsY3VsYXRlcyBhbmQgdHJhbnNmZXJzIHRoZSByZXdhcmRzIHRvIHRoZSBwbGF5ZXIuCiAgICBmdW5jdGlvbiB0cmFuc2ZlclJld2FyZHMoYWRkcmVzcyBwbGF5ZXIsIHVpbnQgZW50cnlBbW91bnQsIHVpbnQgZ2FtZUlkKSBwdWJsaWMgb25seVJlcXVlc3RlcnMgewogICAgICAgIC8vIGxvb3AgdGhyb3VnaCBhbGwgcmV3YXJkIHRva2Vucywgc2luY2Ugd2UgbmV2ZXIgcmVhbGx5IGV4cGVjdCBtb3JlIHRoYW4gMiwgdGhpcyBzaG91bGQgYmUgb2sgd3J0IGdhcwogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IHJld2FyZFNvdXJjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdHJhbnNmZXJSZXdhcmRzSW50ZXJuYWwocGxheWVyLCBlbnRyeUFtb3VudCwgZ2FtZUlkLCByZXdhcmRTb3VyY2VzW2ldKTsKICAgICAgICB9CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyB0aGUgdG90YWwgbnVtYmVyIG9mIHRva2VucywgYWNyb3NzIGFsbCBhcHByb3ZhbHMuCiAgICBmdW5jdGlvbiBnZXRUb3RhbFRva2VucyhhZGRyZXNzIHRva2VuQWRkcmVzcykgcHVibGljIGNvbnN0YW50IHZhbGlkUmV3YXJkU291cmNlKHRva2VuQWRkcmVzcykgcmV0dXJucyh1aW50KSB7CiAgICAgICAgZm9yICh1aW50IGogPSAwOyBqIDwgcmV3YXJkU291cmNlcy5sZW5ndGg7IGorKykgewogICAgICAgICAgICBpZiAocmV3YXJkU291cmNlc1tqXS5yZXdhcmRUb2tlbkFkZHJlc3MgPT0gdG9rZW5BZGRyZXNzKSB7CiAgICAgICAgICAgICAgICBGdWxsRVJDMjAgcmV3YXJkVG9rZW4gPSBGdWxsRVJDMjAocmV3YXJkU291cmNlc1tqXS5yZXdhcmRUb2tlbkFkZHJlc3MpOwogICAgICAgICAgICAgICAgdWludCB0b3RhbCA9IHJld2FyZFRva2VuLmJhbGFuY2VPZih0aGlzKTsKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBhcHByb3ZlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBhZGRyZXNzIGFwcHJvdmVyID0gYXBwcm92ZXJzW2ldOwogICAgICAgICAgICAgICAgICAgIHVpbnQgYWxsb3dhbmNlID0gcmV3YXJkVG9rZW4uYWxsb3dhbmNlKGFwcHJvdmVyLCB0aGlzKTsKICAgICAgICAgICAgICAgICAgICB0b3RhbCA9IHRvdGFsLmFkZChhbGxvd2FuY2UpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiB0b3RhbDsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgLy8vIEBkZXYgR2V0IHJld2FyZCB0b2tlbiBjb3VudAogICAgZnVuY3Rpb24gZ2V0UmV3YXJkVG9rZW5Db3VudCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsKICAgICAgICByZXR1cm4gcmV3YXJkU291cmNlcy5sZW5ndGg7CiAgICB9CgoKICAgIC8vLyBAZGV2IEdldHMgdGhlIHRvdGFsIG51bWJlciBvZiBhcHByb3ZlcnMuCiAgICBmdW5jdGlvbiBnZXRUb3RhbEFwcHJvdmVycygpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsKICAgICAgICByZXR1cm4gYXBwcm92ZXJzLmxlbmd0aDsKICAgIH0KCiAgICAvLy8gQGRldiBHZXRzIHRoZSByZXdhcmQgcmF0ZSBpbmNsdXNpdmUgb2YgYm9udXMuCiAgICAvLy8gVGhpcyBpcyBtZWFudCB0byBiZSB1c2VkIGJ5IGRpdmlkaW5nIHRoZSB0b3RhbCBwdXJjaGFzZSBhbW91bnQgaW4gd2VpIGJ5IHRoaXMgYW1vdW50LgogICAgZnVuY3Rpb24gZ2V0UmV3YXJkUmF0ZShhZGRyZXNzIHBsYXllciwgYWRkcmVzcyB0b2tlbkFkZHJlc3MpIHB1YmxpYyBjb25zdGFudCB2YWxpZFJld2FyZFNvdXJjZSh0b2tlbkFkZHJlc3MpIHJldHVybnModWludCkgewogICAgICAgIGZvciAodWludCBqID0gMDsgaiA8IHJld2FyZFNvdXJjZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgaWYgKHJld2FyZFNvdXJjZXNbal0ucmV3YXJkVG9rZW5BZGRyZXNzID09IHRva2VuQWRkcmVzcykgewogICAgICAgICAgICAgICAgUmV3YXJkU291cmNlIHN0b3JhZ2UgcmV3YXJkU291cmNlID0gcmV3YXJkU291cmNlc1tqXTsKICAgICAgICAgICAgICAgIHVpbnQyNTYgcmV3YXJkUmF0ZSA9IHJld2FyZFNvdXJjZS5yZXdhcmRSYXRlOwogICAgICAgICAgICAgICAgdWludCBib251c1JhdGUgPSByZWZlcnJlcnNbcGxheWVyXSA9PSBhZGRyZXNzKDApID8gMCA6IHJlZmVycmFsQm9udXNSYXRlOwogICAgICAgICAgICAgICAgcmV0dXJuIHJld2FyZFJhdGUubXVsKDEwMCkuZGl2KDEwMCArIGJvbnVzUmF0ZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiAwOwogICAgfQoKICAgIC8vLyBAZGV2IEFkZHMgYSByZXF1ZXN0ZXIgdG8gdGhlIHdoaXRlbGlzdC4KICAgIC8vLyBAcGFyYW0gcmVxdWVzdGVyIFRoZSBhZGRyZXNzIG9mIGEgY29udHJhY3Qgd2hpY2ggd2lsbCByZXF1ZXN0IHJld2FyZCB0cmFuc2ZlcnMKICAgIGZ1bmN0aW9uIGFkZFJlcXVlc3RlcihhZGRyZXNzIHJlcXVlc3RlcikgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZSghcmVxdWVzdGVyc1tyZXF1ZXN0ZXJdKTsgICAgCiAgICAgICAgcmVxdWVzdGVyc1tyZXF1ZXN0ZXJdID0gdHJ1ZTsKICAgIH0KCiAgICAvLy8gQGRldiBSZW1vdmVzIGEgcmVxdWVzdGVyIGZyb20gdGhlIHdoaXRlbGlzdC4KICAgIC8vLyBAcGFyYW0gcmVxdWVzdGVyIFRoZSBhZGRyZXNzIG9mIGEgY29udHJhY3Qgd2hpY2ggd2lsbCByZXF1ZXN0IHJld2FyZCB0cmFuc2ZlcnMKICAgIGZ1bmN0aW9uIHJlbW92ZVJlcXVlc3RlcihhZGRyZXNzIHJlcXVlc3RlcikgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShyZXF1ZXN0ZXJzW3JlcXVlc3Rlcl0pOwogICAgICAgIHJlcXVlc3RlcnNbcmVxdWVzdGVyXSA9IGZhbHNlOwogICAgfQoKICAgIC8vLyBAZGV2IEFkZHMgYSBhcHByb3ZlciBhZGRyZXNzLiAgQXBwcm92YWwgaGFwcGVucyB3aXRoIHRoZSB0b2tlbiBjb250cmFjdC4KICAgIC8vLyBAcGFyYW0gYXBwcm92ZXIgVGhlIGFwcHJvdmVyIGFkZHJlc3MgdG8gYWRkIHRvIHRoZSBwb29sLgogICAgZnVuY3Rpb24gYWRkQXBwcm92ZXIoYWRkcmVzcyBhcHByb3ZlcikgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgYXBwcm92ZXJzLnB1c2goYXBwcm92ZXIpOwogICAgfQoKICAgIC8vLyBAZGV2IFJlbW92ZXMgYW4gYXBwcm92ZXIgYWRkcmVzcy4gCiAgICAvLy8gQHBhcmFtIGFwcHJvdmVyIFRoZSBhcHByb3ZlciBhZGRyZXNzIHRvIHJlbW92ZSBmcm9tIHRoZSBwb29sLgogICAgZnVuY3Rpb24gcmVtb3ZlQXBwcm92ZXIoYWRkcmVzcyBhcHByb3ZlcikgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgdWludCBnb29kID0gMDsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBhcHByb3ZlcnMubGVuZ3RoOyBpID0gaS5hZGQoMSkpIHsKICAgICAgICAgICAgYm9vbCBpc1ZhbGlkID0gYXBwcm92ZXJzW2ldICE9IGFwcHJvdmVyOwogICAgICAgICAgICBpZiAoaXNWYWxpZCkgewogICAgICAgICAgICAgICAgaWYgKGdvb2QgIT0gaSkgewogICAgICAgICAgICAgICAgICAgIGFwcHJvdmVyc1tnb29kXSA9IGFwcHJvdmVyc1tpXTsgICAgICAgICAgICAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGdvb2QgPSBnb29kLmFkZCgxKTsKICAgICAgICAgICAgfSAKICAgICAgICB9CgogICAgICAgIC8vIFRPRE8gRGVsZXRlIHRoZSBwcmV2aW91cyBlbnRyaWVzLgogICAgICAgIGFwcHJvdmVycy5sZW5ndGggPSBnb29kOwogICAgfQoKICAgIC8vLyBAZGV2IFVwZGF0ZXMgdGhlIHJld2FyZCByYXRlCiAgICBmdW5jdGlvbiB1cGRhdGVSZXdhcmRSYXRlKGFkZHJlc3MgdG9rZW5BZGRyZXNzLCB1aW50IG5ld1Jld2FyZFJhdGUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUobmV3UmV3YXJkUmF0ZSA+IDApOwogICAgICAgIHJlcXVpcmUodG9rZW5BZGRyZXNzICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCByZXdhcmRTb3VyY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChyZXdhcmRTb3VyY2VzW2ldLnJld2FyZFRva2VuQWRkcmVzcyA9PSB0b2tlbkFkZHJlc3MpIHsKICAgICAgICAgICAgICAgIHJld2FyZFNvdXJjZXNbaV0ucmV3YXJkUmF0ZSA9IHVpbnQ5NihuZXdSZXdhcmRSYXRlKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvLy8gQGRldiBBZGRzIHRoZSB0b2tlbiBhZGRyZXNzIG9mIHRoZSBwYXltZW50IHR5cGUuCiAgICBmdW5jdGlvbiBhZGRSZXdhcmRUb2tlbihhZGRyZXNzIHRva2VuQWRkcmVzcywgdWludCBuZXdSZXdhcmRSYXRlKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKHRva2VuQWRkcmVzcyAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKCFhcHByb3ZlZFJld2FyZFNvdXJjZXNbdG9rZW5BZGRyZXNzXSk7CiAgICAgICAgCiAgICAgICAgcmV3YXJkU291cmNlcy5wdXNoKFJld2FyZFNvdXJjZSh0b2tlbkFkZHJlc3MsIHVpbnQ5NihuZXdSZXdhcmRSYXRlKSkpOwogICAgICAgIGFwcHJvdmVkUmV3YXJkU291cmNlc1t0b2tlbkFkZHJlc3NdID0gdHJ1ZTsKICAgIH0KCiAgICAvLy8gQGRldiBSZW1vdmVzIHRoZSBnaXZlbiB0b2tlbiBhZGRyZXNzIGZyb20gdGhlIGFwcHJvdmVkIHNvdXJjZXMuCiAgICAvLy8gQHBhcmFtIHRva2VuQWRkcmVzcyB0aGUgYWRkcmVzcyBvZiB0aGUgdG9rZW4KICAgIGZ1bmN0aW9uIHJlbW92ZVJld2FyZFRva2VuKGFkZHJlc3MgdG9rZW5BZGRyZXNzKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKHRva2VuQWRkcmVzcyAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKGFwcHJvdmVkUmV3YXJkU291cmNlc1t0b2tlbkFkZHJlc3NdKTsKCiAgICAgICAgYXBwcm92ZWRSZXdhcmRTb3VyY2VzW3Rva2VuQWRkcmVzc10gPSBmYWxzZTsKCiAgICAgICAgLy8gU2hpZnRpbmcgY29zdHMgc2lnbmlmaWNhbnQgZ2FzIHdpdGggZXZlcnkgd3JpdGUuCiAgICAgICAgLy8gVUkgc2hvdWxkIHVwZGF0ZSB0aGUgcmV3YXJkIHNvdXJjZXMgYWZ0ZXIgdGhpcyBmdW5jdGlvbiBjYWxsLgogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IHJld2FyZFNvdXJjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKHJld2FyZFNvdXJjZXNbaV0ucmV3YXJkVG9rZW5BZGRyZXNzID09IHRva2VuQWRkcmVzcykgewogICAgICAgICAgICAgICAgcmV3YXJkU291cmNlc1tpXSA9IHJld2FyZFNvdXJjZXNbcmV3YXJkU291cmNlcy5sZW5ndGggLSAxXTsKICAgICAgICAgICAgICAgIGRlbGV0ZSByZXdhcmRTb3VyY2VzW3Jld2FyZFNvdXJjZXMubGVuZ3RoIC0gMV07CiAgICAgICAgICAgICAgICByZXdhcmRTb3VyY2VzLmxlbmd0aC0tOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8vLyBAZGV2IFRyYW5zZmVycyBhbnkgdG9rZW5zIHRvIHRoZSBvd25lcgogICAgZnVuY3Rpb24gZGVzdHJveVJld2FyZHMoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCByZXdhcmRTb3VyY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIEZ1bGxFUkMyMCByZXdhcmRUb2tlbiA9IEZ1bGxFUkMyMChyZXdhcmRTb3VyY2VzW2ldLnJld2FyZFRva2VuQWRkcmVzcyk7CiAgICAgICAgICAgIHVpbnQgdG9rZW5CYWxhbmNlID0gcmV3YXJkVG9rZW4uYmFsYW5jZU9mKHRoaXMpOwogICAgICAgICAgICBhc3NlcnQocmV3YXJkVG9rZW4udHJhbnNmZXIob3duZXIsIHRva2VuQmFsYW5jZSkpOwogICAgICAgICAgICBhcHByb3ZlZFJld2FyZFNvdXJjZXNbcmV3YXJkU291cmNlc1tpXS5yZXdhcmRUb2tlbkFkZHJlc3NdID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICByZXdhcmRTb3VyY2VzLmxlbmd0aCA9IDA7CiAgICB9CgogICAgLy8vIEBkZXYgVXBkYXRlcyB0aGUgcmVmZXJyYWwgYm9udXMgcGVyY2VudGFnZQogICAgZnVuY3Rpb24gdXBkYXRlUmVmZXJyYWxCb251c1JhdGUodWludCBuZXdSZWZlcnJhbEJvbnVzUmF0ZSkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShuZXdSZWZlcnJhbEJvbnVzUmF0ZSA8IDEwMCk7CiAgICAgICAgcmVmZXJyYWxCb251c1JhdGUgPSBuZXdSZWZlcnJhbEJvbnVzUmF0ZTsKICAgIH0KCiAgICAvLy8gQGRldiBSZWdpc3RlcnMgdGhlIHBsYXllciB3aXRoIHRoZSBnaXZlbiByZWZlcnJhbCBjb2RlCiAgICAvLy8gQHBhcmFtIHBsYXllciBUaGUgYWRkcmVzcyBvZiB0aGUgcGxheWVyCiAgICAvLy8gQHBhcmFtIHJlZmVycmVyIFRoZSBhZGRyZXNzIG9mIHRoZSByZWZlcnJlcgogICAgZnVuY3Rpb24gcmVnaXN0ZXJSZWZlcnJhbChhZGRyZXNzIHBsYXllciwgYWRkcmVzcyByZWZlcnJlcikgcHVibGljIG9ubHlSZXF1ZXN0ZXJzIHsKICAgICAgICBpZiAocmVmZXJyZXIgIT0gYWRkcmVzcygwKSAmJiBwbGF5ZXIgIT0gcmVmZXJyZXIpIHsKICAgICAgICAgICAgcmVmZXJyZXJzW3BsYXllcl0gPSByZWZlcnJlcjsKICAgICAgICAgICAgUmVmZXJyYWxSZWdpc3RlcmVkKHBsYXllciwgcmVmZXJyZXIpOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8gQGRldiBUcmFuc2ZlcnMgdGhlIHJld2FyZHMgdG8gdGhlIHBsYXllciBmb3IgdGhlIHByb3ZpZGVkIHJld2FyZCBzb3VyY2UKICAgIGZ1bmN0aW9uIHRyYW5zZmVyUmV3YXJkc0ludGVybmFsKGFkZHJlc3MgcGxheWVyLCB1aW50IGVudHJ5QW1vdW50LCB1aW50IGdhbWVJZCwgUmV3YXJkU291cmNlIHN0b3JhZ2UgcmV3YXJkU291cmNlKSBpbnRlcm5hbCB7CiAgICAgICAgaWYgKHJld2FyZFNvdXJjZS5yZXdhcmRUb2tlbkFkZHJlc3MgPT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEZ1bGxFUkMyMCByZXdhcmRUb2tlbiA9IEZ1bGxFUkMyMChyZXdhcmRTb3VyY2UucmV3YXJkVG9rZW5BZGRyZXNzKTsKICAgICAgICB1aW50IHJld2FyZHMgPSBlbnRyeUFtb3VudC5kaXYocmV3YXJkU291cmNlLnJld2FyZFJhdGUpLm11bCgxMCoqdWludDI1NihyZXdhcmRUb2tlbi5kZWNpbWFscygpKSk7CiAgICAgICAgaWYgKHJld2FyZHMgPT0gMCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBhZGRyZXNzIHJlZmVycmVyID0gcmVmZXJyZXJzW3BsYXllcl07CiAgICAgICAgdWludCByZWZlcnJhbEJvbnVzID0gcmVmZXJyZXIgPT0gYWRkcmVzcygwKSA/IDAgOiByZXdhcmRzLm11bChyZWZlcnJhbEJvbnVzUmF0ZSkuZGl2KDEwMCk7CiAgICAgICAgdWludCB0b3RhbFJld2FyZHMgPSByZWZlcnJhbEJvbnVzLm11bCgyKS5hZGQocmV3YXJkcyk7CiAgICAgICAgdWludCBwbGF5ZXJSZXdhcmRzID0gcmV3YXJkcy5hZGQocmVmZXJyYWxCb251cyk7CgogICAgICAgIC8vIEZpcnN0IGNoZWNrIGlmIHRoZSBjb250cmFjdCBpdHNlbGYgaGFzIGVub3VnaCB0b2tlbnMgdG8gcmV3YXJkLgogICAgICAgIGlmIChyZXdhcmRUb2tlbi5iYWxhbmNlT2YodGhpcykgPj0gdG90YWxSZXdhcmRzKSB7CiAgICAgICAgICAgIGFzc2VydChyZXdhcmRUb2tlbi50cmFuc2ZlcihwbGF5ZXIsIHBsYXllclJld2FyZHMpKTsKICAgICAgICAgICAgVG9rZW5zUmV3YXJkZWQocGxheWVyLCByZXdhcmRUb2tlbiwgcGxheWVyUmV3YXJkcywgbXNnLnNlbmRlciwgZ2FtZUlkLCBibG9jay5udW1iZXIpOwoKICAgICAgICAgICAgaWYgKHJlZmVycmFsQm9udXMgPiAwKSB7CiAgICAgICAgICAgICAgICBhc3NlcnQocmV3YXJkVG9rZW4udHJhbnNmZXIocmVmZXJyZXIsIHJlZmVycmFsQm9udXMpKTsKICAgICAgICAgICAgICAgIFJlZmVycmFsUmV3YXJkZWQocmVmZXJyZXIsIHJld2FyZFRva2VuLCBwbGF5ZXIsIHJlZmVycmFsQm9udXMsIGdhbWVJZCwgYmxvY2subnVtYmVyKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgLy8gSXRlcmF0ZSB0aHJvdWdoIHRoZSBhcHByb3ZlcnMgdG8gZmluZCBmaXJzdCB3aXRoIGVub3VnaCByZXdhcmRzIGFuZCBzdWNjZXNzZnVsIHRyYW5zZmVyCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgYXBwcm92ZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGFkZHJlc3MgYXBwcm92ZXIgPSBhcHByb3ZlcnNbaV07CiAgICAgICAgICAgIHVpbnQgYWxsb3dhbmNlID0gcmV3YXJkVG9rZW4uYWxsb3dhbmNlKGFwcHJvdmVyLCB0aGlzKTsKICAgICAgICAgICAgaWYgKGFsbG93YW5jZSA+PSB0b3RhbFJld2FyZHMpIHsKICAgICAgICAgICAgICAgIGFzc2VydChyZXdhcmRUb2tlbi50cmFuc2ZlckZyb20oYXBwcm92ZXIsIHBsYXllciwgcGxheWVyUmV3YXJkcykpOwogICAgICAgICAgICAgICAgVG9rZW5zUmV3YXJkZWQocGxheWVyLCByZXdhcmRUb2tlbiwgcGxheWVyUmV3YXJkcywgbXNnLnNlbmRlciwgZ2FtZUlkLCBibG9jay5udW1iZXIpOwogICAgICAgICAgICAgICAgaWYgKHJlZmVycmFsQm9udXMgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KHJld2FyZFRva2VuLnRyYW5zZmVyKHJlZmVycmVyLCByZWZlcnJhbEJvbnVzKSk7CiAgICAgICAgICAgICAgICAgICAgUmVmZXJyYWxSZXdhcmRlZChyZWZlcnJlciwgcmV3YXJkVG9rZW4sIHBsYXllciwgcmVmZXJyYWxCb251cywgZ2FtZUlkLCBibG9jay5udW1iZXIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9'.
	

]
