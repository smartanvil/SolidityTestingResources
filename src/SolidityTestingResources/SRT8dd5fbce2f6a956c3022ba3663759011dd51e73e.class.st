Class {
	#name : #SRT8dd5fbce2f6a956c3022ba3663759011dd51e73e,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT8dd5fbce2f6a956c3022ba3663759011dd51e73e >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7Cgpjb250cmFjdCBEZWxlZ2F0ZUVSQzIwIHsKICBmdW5jdGlvbiBkZWxlZ2F0ZVRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gZGVsZWdhdGVCYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIGRlbGVnYXRlVHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSwgYWRkcmVzcyBvcmlnU2VuZGVyKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gZGVsZWdhdGVBbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiBkZWxlZ2F0ZVRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUsIGFkZHJlc3Mgb3JpZ1NlbmRlcikgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGRlbGVnYXRlQXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUsIGFkZHJlc3Mgb3JpZ1NlbmRlcikgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGRlbGVnYXRlSW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIHNwZW5kZXIsIHVpbnQgYWRkZWRWYWx1ZSwgYWRkcmVzcyBvcmlnU2VuZGVyKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gZGVsZWdhdGVEZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3Mgc3BlbmRlciwgdWludCBzdWJ0cmFjdGVkVmFsdWUsIGFkZHJlc3Mgb3JpZ1NlbmRlcikgcHVibGljIHJldHVybnMgKGJvb2wpOwp9CgpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKY29udHJhY3QgUGF1c2FibGUgaXMgT3duYWJsZSB7CiAgZXZlbnQgUGF1c2UoKTsKICBldmVudCBVbnBhdXNlKCk7CgogIGJvb2wgcHVibGljIHBhdXNlZCA9IGZhbHNlOwoKCiAgLyoqCiAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBub3QgcGF1c2VkLgogICAqLwogIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICByZXF1aXJlKCFwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgcGF1c2VkLgogICAqLwogIG1vZGlmaWVyIHdoZW5QYXVzZWQoKSB7CiAgICByZXF1aXJlKHBhdXNlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHBhdXNlLCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlCiAgICovCiAgZnVuY3Rpb24gcGF1c2UoKSBvbmx5T3duZXIgd2hlbk5vdFBhdXNlZCBwdWJsaWMgewogICAgcGF1c2VkID0gdHJ1ZTsKICAgIFBhdXNlKCk7CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gdW5wYXVzZSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgKi8KICBmdW5jdGlvbiB1bnBhdXNlKCkgb25seU93bmVyIHdoZW5QYXVzZWQgcHVibGljIHsKICAgIHBhdXNlZCA9IGZhbHNlOwogICAgVW5wYXVzZSgpOwogIH0KfQoKY29udHJhY3QgQ2FuUmVjbGFpbVRva2VuIGlzIE93bmFibGUgewogIHVzaW5nIFNhZmVFUkMyMCBmb3IgRVJDMjBCYXNpYzsKCiAgLyoqCiAgICogQGRldiBSZWNsYWltIGFsbCBFUkMyMEJhc2ljIGNvbXBhdGlibGUgdG9rZW5zCiAgICogQHBhcmFtIHRva2VuIEVSQzIwQmFzaWMgVGhlIGFkZHJlc3Mgb2YgdGhlIHRva2VuIGNvbnRyYWN0CiAgICovCiAgZnVuY3Rpb24gcmVjbGFpbVRva2VuKEVSQzIwQmFzaWMgdG9rZW4pIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICB1aW50MjU2IGJhbGFuY2UgPSB0b2tlbi5iYWxhbmNlT2YodGhpcyk7CiAgICB0b2tlbi5zYWZlVHJhbnNmZXIob3duZXIsIGJhbGFuY2UpOwogIH0KCn0KCmNvbnRyYWN0IENsYWltYWJsZSBpcyBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBwZW5kaW5nT3duZXI7CgogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBwZW5kaW5nT3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seVBlbmRpbmdPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBwZW5kaW5nT3duZXIpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHNldCB0aGUgcGVuZGluZ093bmVyIGFkZHJlc3MuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHBlbmRpbmdPd25lciA9IG5ld093bmVyOwogIH0KCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIHBlbmRpbmdPd25lciBhZGRyZXNzIHRvIGZpbmFsaXplIHRoZSB0cmFuc2Zlci4KICAgKi8KICBmdW5jdGlvbiBjbGFpbU93bmVyc2hpcCgpIG9ubHlQZW5kaW5nT3duZXIgcHVibGljIHsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBwZW5kaW5nT3duZXIpOwogICAgb3duZXIgPSBwZW5kaW5nT3duZXI7CiAgICBwZW5kaW5nT3duZXIgPSBhZGRyZXNzKDApOwogIH0KfQoKY29udHJhY3QgQWRkcmVzc0xpc3QgaXMgQ2xhaW1hYmxlIHsKICAgIHN0cmluZyBwdWJsaWMgbmFtZTsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIG9uTGlzdDsKCiAgICBmdW5jdGlvbiBBZGRyZXNzTGlzdChzdHJpbmcgX25hbWUsIGJvb2wgbnVsbFZhbHVlKSBwdWJsaWMgewogICAgICAgIG5hbWUgPSBfbmFtZTsKICAgICAgICBvbkxpc3RbMHgwXSA9IG51bGxWYWx1ZTsKICAgIH0KICAgIGV2ZW50IENoYW5nZVdoaXRlTGlzdChhZGRyZXNzIGluZGV4ZWQgdG8sIGJvb2wgb25MaXN0KTsKCiAgICAvLyBTZXQgd2hldGhlciBfdG8gaXMgb24gdGhlIGxpc3Qgb3Igbm90LiBXaGV0aGVyIDB4MCBpcyBvbiB0aGUgbGlzdAogICAgLy8gb3Igbm90IGNhbm5vdCBiZSBzZXQgaGVyZSAtIGl0IGlzIHNldCBvbmNlIGFuZCBmb3IgYWxsIGJ5IHRoZSBjb25zdHJ1Y3Rvci4KICAgIGZ1bmN0aW9uIGNoYW5nZUxpc3QoYWRkcmVzcyBfdG8sIGJvb2wgX29uTGlzdCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gMHgwKTsKICAgICAgICBpZiAob25MaXN0W190b10gIT0gX29uTGlzdCkgewogICAgICAgICAgICBvbkxpc3RbX3RvXSA9IF9vbkxpc3Q7CiAgICAgICAgICAgIENoYW5nZVdoaXRlTGlzdChfdG8sIF9vbkxpc3QpOwogICAgICAgIH0KICAgIH0KfQoKY29udHJhY3QgSGFzTm9Db250cmFjdHMgaXMgT3duYWJsZSB7CgogIC8qKgogICAqIEBkZXYgUmVjbGFpbSBvd25lcnNoaXAgb2YgT3duYWJsZSBjb250cmFjdHMKICAgKiBAcGFyYW0gY29udHJhY3RBZGRyIFRoZSBhZGRyZXNzIG9mIHRoZSBPd25hYmxlIHRvIGJlIHJlY2xhaW1lZC4KICAgKi8KICBmdW5jdGlvbiByZWNsYWltQ29udHJhY3QoYWRkcmVzcyBjb250cmFjdEFkZHIpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICBPd25hYmxlIGNvbnRyYWN0SW5zdCA9IE93bmFibGUoY29udHJhY3RBZGRyKTsKICAgIGNvbnRyYWN0SW5zdC50cmFuc2Zlck93bmVyc2hpcChvd25lcik7CiAgfQp9Cgpjb250cmFjdCBIYXNOb0V0aGVyIGlzIE93bmFibGUgewoKICAvKioKICAqIEBkZXYgQ29uc3RydWN0b3IgdGhhdCByZWplY3RzIGluY29taW5nIEV0aGVyCiAgKiBAZGV2IFRoZSBgcGF5YWJsZWAgZmxhZyBpcyBhZGRlZCBzbyB3ZSBjYW4gYWNjZXNzIGBtc2cudmFsdWVgIHdpdGhvdXQgY29tcGlsZXIgd2FybmluZy4gSWYgd2UKICAqIGxlYXZlIG91dCBwYXlhYmxlLCB0aGVuIFNvbGlkaXR5IHdpbGwgYWxsb3cgaW5oZXJpdGluZyBjb250cmFjdHMgdG8gaW1wbGVtZW50IGEgcGF5YWJsZQogICogY29uc3RydWN0b3IuIEJ5IGRvaW5nIGl0IHRoaXMgd2F5IHdlIHByZXZlbnQgYSBwYXlhYmxlIGNvbnN0cnVjdG9yIGZyb20gd29ya2luZy4gQWx0ZXJuYXRpdmVseQogICogd2UgY291bGQgdXNlIGFzc2VtYmx5IHRvIGFjY2VzcyBtc2cudmFsdWUuCiAgKi8KICBmdW5jdGlvbiBIYXNOb0V0aGVyKCkgcHVibGljIHBheWFibGUgewogICAgcmVxdWlyZShtc2cudmFsdWUgPT0gMCk7CiAgfQoKICAvKioKICAgKiBAZGV2IERpc2FsbG93cyBkaXJlY3Qgc2VuZCBieSBzZXR0aW5ncyBhIGRlZmF1bHQgZnVuY3Rpb24gd2l0aG91dCB0aGUgYHBheWFibGVgIGZsYWcuCiAgICovCiAgZnVuY3Rpb24oKSBleHRlcm5hbCB7CiAgfQoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIGFsbCBFdGhlciBoZWxkIGJ5IHRoZSBjb250cmFjdCB0byB0aGUgb3duZXIuCiAgICovCiAgZnVuY3Rpb24gcmVjbGFpbUV0aGVyKCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIGFzc2VydChvd25lci5zZW5kKHRoaXMuYmFsYW5jZSkpOwogIH0KfQoKY29udHJhY3QgSGFzTm9Ub2tlbnMgaXMgQ2FuUmVjbGFpbVRva2VuIHsKCiAvKioKICAqIEBkZXYgUmVqZWN0IGFsbCBFUkMyMjMgY29tcGF0aWJsZSB0b2tlbnMKICAqIEBwYXJhbSBmcm9tXyBhZGRyZXNzIFRoZSBhZGRyZXNzIHRoYXQgaXMgdHJhbnNmZXJyaW5nIHRoZSB0b2tlbnMKICAqIEBwYXJhbSB2YWx1ZV8gdWludDI1NiB0aGUgYW1vdW50IG9mIHRoZSBzcGVjaWZpZWQgdG9rZW4KICAqIEBwYXJhbSBkYXRhXyBCeXRlcyBUaGUgZGF0YSBwYXNzZWQgZnJvbSB0aGUgY2FsbGVyLgogICovCiAgZnVuY3Rpb24gdG9rZW5GYWxsYmFjayhhZGRyZXNzIGZyb21fLCB1aW50MjU2IHZhbHVlXywgYnl0ZXMgZGF0YV8pIGV4dGVybmFsIHsKICAgIGZyb21fOwogICAgdmFsdWVfOwogICAgZGF0YV87CiAgICByZXZlcnQoKTsKICB9Cgp9Cgpjb250cmFjdCBOb093bmVyIGlzIEhhc05vRXRoZXIsIEhhc05vVG9rZW5zLCBIYXNOb0NvbnRyYWN0cyB7Cn0KCmNvbnRyYWN0IEFsbG93YW5jZVNoZWV0IGlzIENsYWltYWJsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIHB1YmxpYyBhbGxvd2FuY2VPZjsKCiAgICBmdW5jdGlvbiBhZGRBbGxvd2FuY2UoYWRkcmVzcyB0b2tlbkhvbGRlciwgYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBhbGxvd2FuY2VPZlt0b2tlbkhvbGRlcl1bc3BlbmRlcl0gPSBhbGxvd2FuY2VPZlt0b2tlbkhvbGRlcl1bc3BlbmRlcl0uYWRkKHZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzdWJBbGxvd2FuY2UoYWRkcmVzcyB0b2tlbkhvbGRlciwgYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBhbGxvd2FuY2VPZlt0b2tlbkhvbGRlcl1bc3BlbmRlcl0gPSBhbGxvd2FuY2VPZlt0b2tlbkhvbGRlcl1bc3BlbmRlcl0uc3ViKHZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRBbGxvd2FuY2UoYWRkcmVzcyB0b2tlbkhvbGRlciwgYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBhbGxvd2FuY2VPZlt0b2tlbkhvbGRlcl1bc3BlbmRlcl0gPSB2YWx1ZTsKICAgIH0KfQoKY29udHJhY3QgQmFsYW5jZVNoZWV0IGlzIENsYWltYWJsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBiYWxhbmNlT2Y7CgogICAgZnVuY3Rpb24gYWRkQmFsYW5jZShhZGRyZXNzIGFkZHIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIGJhbGFuY2VPZlthZGRyXSA9IGJhbGFuY2VPZlthZGRyXS5hZGQodmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHN1YkJhbGFuY2UoYWRkcmVzcyBhZGRyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBiYWxhbmNlT2ZbYWRkcl0gPSBiYWxhbmNlT2ZbYWRkcl0uc3ViKHZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRCYWxhbmNlKGFkZHJlc3MgYWRkciwgdWludDI1NiB2YWx1ZSkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgYmFsYW5jZU9mW2FkZHJdID0gdmFsdWU7CiAgICB9Cn0KCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYywgQ2xhaW1hYmxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgQmFsYW5jZVNoZWV0IHB1YmxpYyBiYWxhbmNlczsKCiAgdWludDI1NiB0b3RhbFN1cHBseV87CgogIGZ1bmN0aW9uIHNldEJhbGFuY2VTaGVldChhZGRyZXNzIHNoZWV0KSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgYmFsYW5jZXMgPSBCYWxhbmNlU2hlZXQoc2hlZXQpOwogICAgYmFsYW5jZXMuY2xhaW1Pd25lcnNoaXAoKTsKICB9CgogIC8qKgogICogQGRldiB0b3RhbCBudW1iZXIgb2YgdG9rZW5zIGluIGV4aXN0ZW5jZQogICovCiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gdG90YWxTdXBwbHlfOwogIH0KCiAgLyoqCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdHJhbnNmZXJBbGxBcmdzTm9BbGxvd2FuY2UobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiB0cmFuc2ZlckFsbEFyZ3NOb0FsbG93YW5jZShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIGludGVybmFsIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfZnJvbSAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzLmJhbGFuY2VPZihfZnJvbSkpOwoKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgIGJhbGFuY2VzLnN1YkJhbGFuY2UoX2Zyb20sIF92YWx1ZSk7CiAgICBiYWxhbmNlcy5hZGRCYWxhbmNlKF90bywgX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgKi8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzLmJhbGFuY2VPZihfb3duZXIpOwogIH0KfQoKY29udHJhY3QgQnVybmFibGVUb2tlbiBpcyBCYXNpY1Rva2VuIHsKCiAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgYnVybmVyLCB1aW50MjU2IHZhbHVlKTsKCiAgLyoqCiAgICogQGRldiBCdXJucyBhIHNwZWNpZmljIGFtb3VudCBvZiB0b2tlbnMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VuIHRvIGJlIGJ1cm5lZC4KICAgKi8KICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgewogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXMuYmFsYW5jZU9mKG1zZy5zZW5kZXIpKTsKICAgIC8vIG5vIG5lZWQgdG8gcmVxdWlyZSB2YWx1ZSA8PSB0b3RhbFN1cHBseSwgc2luY2UgdGhhdCB3b3VsZCBpbXBseSB0aGUKICAgIC8vIHNlbmRlcidzIGJhbGFuY2UgaXMgZ3JlYXRlciB0aGFuIHRoZSB0b3RhbFN1cHBseSwgd2hpY2ggKnNob3VsZCogYmUgYW4gYXNzZXJ0aW9uIGZhaWx1cmUKCiAgICBhZGRyZXNzIGJ1cm5lciA9IG1zZy5zZW5kZXI7CiAgICBiYWxhbmNlcy5zdWJCYWxhbmNlKGJ1cm5lciwgX3ZhbHVlKTsKICAgIHRvdGFsU3VwcGx5XyA9IHRvdGFsU3VwcGx5Xy5zdWIoX3ZhbHVlKTsKICAgIEJ1cm4oYnVybmVyLCBfdmFsdWUpOwogICAgVHJhbnNmZXIoYnVybmVyLCBhZGRyZXNzKDApLCBfdmFsdWUpOwogIH0KfQoKY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCmxpYnJhcnkgU2FmZUVSQzIwIHsKICBmdW5jdGlvbiBzYWZlVHJhbnNmZXIoRVJDMjBCYXNpYyB0b2tlbiwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgaW50ZXJuYWwgewogICAgYXNzZXJ0KHRva2VuLnRyYW5zZmVyKHRvLCB2YWx1ZSkpOwogIH0KCiAgZnVuY3Rpb24gc2FmZVRyYW5zZmVyRnJvbShFUkMyMCB0b2tlbiwgYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBpbnRlcm5hbCB7CiAgICBhc3NlcnQodG9rZW4udHJhbnNmZXJGcm9tKGZyb20sIHRvLCB2YWx1ZSkpOwogIH0KCiAgZnVuY3Rpb24gc2FmZUFwcHJvdmUoRVJDMjAgdG9rZW4sIGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgaW50ZXJuYWwgewogICAgYXNzZXJ0KHRva2VuLmFwcHJvdmUoc3BlbmRlciwgdmFsdWUpKTsKICB9Cn0KCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBBbGxvd2FuY2VTaGVldCBwdWJsaWMgYWxsb3dhbmNlczsKCiAgZnVuY3Rpb24gc2V0QWxsb3dhbmNlU2hlZXQoYWRkcmVzcyBzaGVldCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIGFsbG93YW5jZXMgPSBBbGxvd2FuY2VTaGVldChzaGVldCk7CiAgICBhbGxvd2FuY2VzLmNsYWltT3duZXJzaGlwKCk7CiAgfQoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHRyYW5zZmVyQWxsQXJnc1llc0FsbG93YW5jZShfZnJvbSwgX3RvLCBfdmFsdWUsIG1zZy5zZW5kZXIpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiB0cmFuc2ZlckFsbEFyZ3NZZXNBbGxvd2FuY2UoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlLCBhZGRyZXNzIHNwZW5kZXIpIGludGVybmFsIHsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93YW5jZXMuYWxsb3dhbmNlT2YoX2Zyb20sIHNwZW5kZXIpKTsKCiAgICBhbGxvd2FuY2VzLnN1YkFsbG93YW5jZShfZnJvbSwgc3BlbmRlciwgX3ZhbHVlKTsKICAgIHRyYW5zZmVyQWxsQXJnc05vQWxsb3dhbmNlKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFwcHJvdmVBbGxBcmdzKF9zcGVuZGVyLCBfdmFsdWUsIG1zZy5zZW5kZXIpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBhcHByb3ZlQWxsQXJncyhhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSwgYWRkcmVzcyBfdG9rZW5Ib2xkZXIpIGludGVybmFsIHsKICAgIGFsbG93YW5jZXMuc2V0QWxsb3dhbmNlKF90b2tlbkhvbGRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICBBcHByb3ZhbChfdG9rZW5Ib2xkZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gYWxsb3dhbmNlcy5hbGxvd2FuY2VPZihfb3duZXIsIF9zcGVuZGVyKTsKICB9CgogIC8qKgogICAqIEBkZXYgSW5jcmVhc2UgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKgogICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAogICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfYWRkZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBpbmNyZWFzZSB0aGUgYWxsb3dhbmNlIGJ5LgogICAqLwogIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGluY3JlYXNlQXBwcm92YWxBbGxBcmdzKF9zcGVuZGVyLCBfYWRkZWRWYWx1ZSwgbXNnLnNlbmRlcik7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWxBbGxBcmdzKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUsIGFkZHJlc3MgdG9rZW5Ib2xkZXIpIGludGVybmFsIHsKICAgIGFsbG93YW5jZXMuYWRkQWxsb3dhbmNlKHRva2VuSG9sZGVyLCBfc3BlbmRlciwgX2FkZGVkVmFsdWUpOwogICAgQXBwcm92YWwodG9rZW5Ib2xkZXIsIF9zcGVuZGVyLCBhbGxvd2FuY2VzLmFsbG93YW5jZU9mKHRva2VuSG9sZGVyLCBfc3BlbmRlcikpOwogIH0KCiAgLyoqCiAgICogQGRldiBEZWNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gZGVjcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zdWJ0cmFjdGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gZGVjcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKi8KICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGRlY3JlYXNlQXBwcm92YWxBbGxBcmdzKF9zcGVuZGVyLCBfc3VidHJhY3RlZFZhbHVlLCBtc2cuc2VuZGVyKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbEFsbEFyZ3MoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlLCBhZGRyZXNzIHRva2VuSG9sZGVyKSBpbnRlcm5hbCB7CiAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dhbmNlcy5hbGxvd2FuY2VPZih0b2tlbkhvbGRlciwgX3NwZW5kZXIpOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2FuY2VzLnNldEFsbG93YW5jZSh0b2tlbkhvbGRlciwgX3NwZW5kZXIsIDApOwogICAgfSBlbHNlIHsKICAgICAgYWxsb3dhbmNlcy5zdWJBbGxvd2FuY2UodG9rZW5Ib2xkZXIsIF9zcGVuZGVyLCBfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKHRva2VuSG9sZGVyLCBfc3BlbmRlciwgYWxsb3dhbmNlcy5hbGxvd2FuY2VPZih0b2tlbkhvbGRlciwgX3NwZW5kZXIpKTsKICB9Cgp9Cgpjb250cmFjdCBDYW5EZWxlZ2F0ZSBpcyBTdGFuZGFyZFRva2VuIHsKICAgIC8vIElmIHRoaXMgY29udHJhY3QgbmVlZHMgdG8gYmUgdXBncmFkZWQsIHRoZSBuZXcgY29udHJhY3Qgd2lsbCBiZSBzdG9yZWQKICAgIC8vIGluICdkZWxlZ2F0ZScgYW5kIGFueSBFUkMyMCBjYWxscyB0byB0aGlzIGNvbnRyYWN0IHdpbGwgYmUgZGVsZWdhdGVkIHRvIHRoYXQgb25lLgogICAgRGVsZWdhdGVFUkMyMCBwdWJsaWMgZGVsZWdhdGU7CgogICAgZXZlbnQgRGVsZWdhdGVkVG8oYWRkcmVzcyBpbmRleGVkIG5ld0NvbnRyYWN0KTsKCiAgICAvLyBDYW4gdW5kZWxlZ2F0ZSBieSBwYXNzaW5nIGluIG5ld0NvbnRyYWN0ID0gYWRkcmVzcygwKQogICAgZnVuY3Rpb24gZGVsZWdhdGVUb05ld0NvbnRyYWN0KERlbGVnYXRlRVJDMjAgbmV3Q29udHJhY3QpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIGRlbGVnYXRlID0gbmV3Q29udHJhY3Q7CiAgICAgICAgRGVsZWdhdGVkVG8oZGVsZWdhdGUpOwogICAgfQoKICAgIC8vIElmIGEgZGVsZWdhdGUgaGFzIGJlZW4gZGVzaWduYXRlZCwgYWxsIEVSQzIwIGNhbGxzIGFyZSBmb3J3YXJkZWQgdG8gaXQKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYgKGRlbGVnYXRlID09IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKHRvLCB2YWx1ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGRlbGVnYXRlLmRlbGVnYXRlVHJhbnNmZXIodG8sIHZhbHVlLCBtc2cuc2VuZGVyKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAoZGVsZWdhdGUgPT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKGZyb20sIHRvLCB2YWx1ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGRlbGVnYXRlLmRlbGVnYXRlVHJhbnNmZXJGcm9tKGZyb20sIHRvLCB2YWx1ZSwgbXNnLnNlbmRlcik7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGlmIChkZWxlZ2F0ZSA9PSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIHJldHVybiBzdXBlci5iYWxhbmNlT2Yod2hvKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZGVsZWdhdGUuZGVsZWdhdGVCYWxhbmNlT2Yod2hvKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYgKGRlbGVnYXRlID09IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmFwcHJvdmUoc3BlbmRlciwgdmFsdWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBkZWxlZ2F0ZS5kZWxlZ2F0ZUFwcHJvdmUoc3BlbmRlciwgdmFsdWUsIG1zZy5zZW5kZXIpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGlmIChkZWxlZ2F0ZSA9PSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIHJldHVybiBzdXBlci5hbGxvd2FuY2UoX293bmVyLCBzcGVuZGVyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZGVsZWdhdGUuZGVsZWdhdGVBbGxvd2FuY2UoX293bmVyLCBzcGVuZGVyKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgaWYgKGRlbGVnYXRlID09IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgcmV0dXJuIHN1cGVyLnRvdGFsU3VwcGx5KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGRlbGVnYXRlLmRlbGVnYXRlVG90YWxTdXBwbHkoKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIHNwZW5kZXIsIHVpbnQgYWRkZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAoZGVsZWdhdGUgPT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICByZXR1cm4gc3VwZXIuaW5jcmVhc2VBcHByb3ZhbChzcGVuZGVyLCBhZGRlZFZhbHVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZGVsZWdhdGUuZGVsZWdhdGVJbmNyZWFzZUFwcHJvdmFsKHNwZW5kZXIsIGFkZGVkVmFsdWUsIG1zZy5zZW5kZXIpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3Mgc3BlbmRlciwgdWludCBzdWJ0cmFjdGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYgKGRlbGVnYXRlID09IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlY3JlYXNlQXBwcm92YWwoc3BlbmRlciwgc3VidHJhY3RlZFZhbHVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZGVsZWdhdGUuZGVsZWdhdGVEZWNyZWFzZUFwcHJvdmFsKHNwZW5kZXIsIHN1YnRyYWN0ZWRWYWx1ZSwgbXNnLnNlbmRlcik7CiAgICAgICAgfQogICAgfQp9Cgpjb250cmFjdCBTdGFuZGFyZERlbGVnYXRlIGlzIFN0YW5kYXJkVG9rZW4sIERlbGVnYXRlRVJDMjAgewogICAgYWRkcmVzcyBwdWJsaWMgZGVsZWdhdGVkRnJvbTsKCiAgICBtb2RpZmllciBvbmx5U2VuZGVyKGFkZHJlc3Mgc291cmNlKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHNvdXJjZSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXREZWxlZ2F0ZWRGcm9tKGFkZHJlc3MgYWRkcikgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgZGVsZWdhdGVkRnJvbSA9IGFkZHI7CiAgICB9CgogICAgLy8gQWxsIGRlbGVnYXRlIEVSQzIwIGZ1bmN0aW9ucyBhcmUgZm9yd2FyZGVkIHRvIGNvcnJlc3BvbmRpbmcgbm9ybWFsIGZ1bmN0aW9ucwogICAgZnVuY3Rpb24gZGVsZWdhdGVUb3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gdG90YWxTdXBwbHkoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWxlZ2F0ZUJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBiYWxhbmNlT2Yod2hvKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWxlZ2F0ZVRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUsIGFkZHJlc3Mgb3JpZ1NlbmRlcikgb25seVNlbmRlcihkZWxlZ2F0ZWRGcm9tKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHRyYW5zZmVyQWxsQXJnc05vQWxsb3dhbmNlKG9yaWdTZW5kZXIsIHRvLCB2YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gZGVsZWdhdGVBbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGFsbG93YW5jZShvd25lciwgc3BlbmRlcik7CiAgICB9CgogICAgZnVuY3Rpb24gZGVsZWdhdGVUcmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlLCBhZGRyZXNzIG9yaWdTZW5kZXIpIG9ubHlTZW5kZXIoZGVsZWdhdGVkRnJvbSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICB0cmFuc2ZlckFsbEFyZ3NZZXNBbGxvd2FuY2UoZnJvbSwgdG8sIHZhbHVlLCBvcmlnU2VuZGVyKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWxlZ2F0ZUFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlLCBhZGRyZXNzIG9yaWdTZW5kZXIpIG9ubHlTZW5kZXIoZGVsZWdhdGVkRnJvbSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBhcHByb3ZlQWxsQXJncyhzcGVuZGVyLCB2YWx1ZSwgb3JpZ1NlbmRlcik7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gZGVsZWdhdGVJbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3Mgc3BlbmRlciwgdWludCBhZGRlZFZhbHVlLCBhZGRyZXNzIG9yaWdTZW5kZXIpIG9ubHlTZW5kZXIoZGVsZWdhdGVkRnJvbSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpbmNyZWFzZUFwcHJvdmFsQWxsQXJncyhzcGVuZGVyLCBhZGRlZFZhbHVlLCBvcmlnU2VuZGVyKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWxlZ2F0ZURlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBzcGVuZGVyLCB1aW50IHN1YnRyYWN0ZWRWYWx1ZSwgYWRkcmVzcyBvcmlnU2VuZGVyKSBvbmx5U2VuZGVyKGRlbGVnYXRlZEZyb20pIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgZGVjcmVhc2VBcHByb3ZhbEFsbEFyZ3Moc3BlbmRlciwgc3VidHJhY3RlZFZhbHVlLCBvcmlnU2VuZGVyKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQoKY29udHJhY3QgUGF1c2FibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBQYXVzYWJsZSB7CgogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBzdXBlci5hcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJldHVybiBzdXBlci5pbmNyZWFzZUFwcHJvdmFsKF9zcGVuZGVyLCBfYWRkZWRWYWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICByZXR1cm4gc3VwZXIuZGVjcmVhc2VBcHByb3ZhbChfc3BlbmRlciwgX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgfQp9Cgpjb250cmFjdCBUcnVlVVNEIGlzIFN0YW5kYXJkRGVsZWdhdGUsIFBhdXNhYmxlVG9rZW4sIEJ1cm5hYmxlVG9rZW4sIE5vT3duZXIsIENhbkRlbGVnYXRlIHsKICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICJUcnVlVVNEIjsKICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIlRVU0QiOwogICAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CgogICAgQWRkcmVzc0xpc3QgcHVibGljIGNhblJlY2VpdmVNaW50V2hpdGVMaXN0OwogICAgQWRkcmVzc0xpc3QgcHVibGljIGNhbkJ1cm5XaGl0ZUxpc3Q7CiAgICBBZGRyZXNzTGlzdCBwdWJsaWMgYmxhY2tMaXN0OwogICAgQWRkcmVzc0xpc3QgcHVibGljIG5vRmVlc0xpc3Q7CiAgICB1aW50MjU2IHB1YmxpYyBidXJuTWluID0gMTAwMDAgKiAxMCoqdWludDI1NihkZWNpbWFscyk7CiAgICB1aW50MjU2IHB1YmxpYyBidXJuTWF4ID0gMjAwMDAwMDAgKiAxMCoqdWludDI1NihkZWNpbWFscyk7CgogICAgdWludDgwIHB1YmxpYyB0cmFuc2ZlckZlZU51bWVyYXRvciA9IDc7CiAgICB1aW50ODAgcHVibGljIHRyYW5zZmVyRmVlRGVub21pbmF0b3IgPSAxMDAwMDsKICAgIHVpbnQ4MCBwdWJsaWMgbWludEZlZU51bWVyYXRvciA9IDA7CiAgICB1aW50ODAgcHVibGljIG1pbnRGZWVEZW5vbWluYXRvciA9IDEwMDAwOwogICAgdWludDI1NiBwdWJsaWMgbWludEZlZUZsYXQgPSAwOwogICAgdWludDgwIHB1YmxpYyBidXJuRmVlTnVtZXJhdG9yID0gMDsKICAgIHVpbnQ4MCBwdWJsaWMgYnVybkZlZURlbm9taW5hdG9yID0gMTAwMDA7CiAgICB1aW50MjU2IHB1YmxpYyBidXJuRmVlRmxhdCA9IDA7CiAgICBhZGRyZXNzIHB1YmxpYyBzdGFrZXI7CgogICAgZXZlbnQgQ2hhbmdlQnVybkJvdW5kc0V2ZW50KHVpbnQyNTYgbmV3TWluLCB1aW50MjU2IG5ld01heCk7CiAgICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwogICAgZXZlbnQgV2lwZWRBY2NvdW50KGFkZHJlc3MgaW5kZXhlZCBhY2NvdW50LCB1aW50MjU2IGJhbGFuY2UpOwoKICAgIGZ1bmN0aW9uIFRydWVVU0QoKSBwdWJsaWMgewogICAgICAgIHRvdGFsU3VwcGx5XyA9IDA7CiAgICAgICAgc3Rha2VyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRMaXN0cyhBZGRyZXNzTGlzdCBfY2FuUmVjZWl2ZU1pbnRXaGl0ZUxpc3QsIEFkZHJlc3NMaXN0IF9jYW5CdXJuV2hpdGVMaXN0LCBBZGRyZXNzTGlzdCBfYmxhY2tMaXN0LCBBZGRyZXNzTGlzdCBfbm9GZWVzTGlzdCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgY2FuUmVjZWl2ZU1pbnRXaGl0ZUxpc3QgPSBfY2FuUmVjZWl2ZU1pbnRXaGl0ZUxpc3Q7CiAgICAgICAgY2FuQnVybldoaXRlTGlzdCA9IF9jYW5CdXJuV2hpdGVMaXN0OwogICAgICAgIGJsYWNrTGlzdCA9IF9ibGFja0xpc3Q7CiAgICAgICAgbm9GZWVzTGlzdCA9IF9ub0ZlZXNMaXN0OwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYW5nZU5hbWUoc3RyaW5nIF9uYW1lLCBzdHJpbmcgX3N5bWJvbCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgbmFtZSA9IF9uYW1lOwogICAgICAgIHN5bWJvbCA9IF9zeW1ib2w7CiAgICB9CgogICAgLy9CdXJuaW5nIGZ1bmN0aW9ucyBhcyB3aXRoZHJhd2luZyBtb25leSBmcm9tIHRoZSBzeXN0ZW0uIFRoZSBwbGF0Zm9ybSB3aWxsIGtlZXAgdHJhY2sgb2Ygd2hvIGJ1cm5zIGNvaW5zLAogICAgLy9hbmQgd2lsbCBzZW5kIHRoZW0gYmFjayB0aGUgZXF1aXZhbGVudCBhbW91bnQgb2YgbW9uZXkgKHJvdW5kZWQgZG93biB0byB0aGUgbmVhcmVzdCBjZW50KS4KICAgIGZ1bmN0aW9uIGJ1cm4odWludDI1NiBfdmFsdWUpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShjYW5CdXJuV2hpdGVMaXN0Lm9uTGlzdChtc2cuc2VuZGVyKSk7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPj0gYnVybk1pbik7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYnVybk1heCk7CiAgICAgICAgdWludDI1NiBmZWUgPSBwYXlTdGFraW5nRmVlKG1zZy5zZW5kZXIsIF92YWx1ZSwgYnVybkZlZU51bWVyYXRvciwgYnVybkZlZURlbm9taW5hdG9yLCBidXJuRmVlRmxhdCwgMHgwKTsKICAgICAgICB1aW50MjU2IHJlbWFpbmluZyA9IF92YWx1ZS5zdWIoZmVlKTsKICAgICAgICBzdXBlci5idXJuKHJlbWFpbmluZyk7CiAgICB9CgogICAgLy9DcmVhdGUgX2Ftb3VudCBuZXcgdG9rZW5zIGFuZCB0cmFuc2ZlciB0aGVtIHRvIF90by4KICAgIC8vQmFzZWQgb24gY29kZSBieSBPcGVuWmVwcGVsaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvYmxvYi9tYXN0ZXIvY29udHJhY3RzL3Rva2VuL01pbnRhYmxlVG9rZW4uc29sCiAgICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoY2FuUmVjZWl2ZU1pbnRXaGl0ZUxpc3Qub25MaXN0KF90bykpOwogICAgICAgIHRvdGFsU3VwcGx5XyA9IHRvdGFsU3VwcGx5Xy5hZGQoX2Ftb3VudCk7CiAgICAgICAgYmFsYW5jZXMuYWRkQmFsYW5jZShfdG8sIF9hbW91bnQpOwogICAgICAgIE1pbnQoX3RvLCBfYW1vdW50KTsKICAgICAgICBUcmFuc2ZlcihhZGRyZXNzKDApLCBfdG8sIF9hbW91bnQpOwogICAgICAgIHBheVN0YWtpbmdGZWUoX3RvLCBfYW1vdW50LCBtaW50RmVlTnVtZXJhdG9yLCBtaW50RmVlRGVub21pbmF0b3IsIG1pbnRGZWVGbGF0LCAweDApOwogICAgfQoKICAgIC8vQ2hhbmdlIHRoZSBtaW5pbXVtIGFuZCBtYXhpbXVtIGFtb3VudCB0aGF0IGNhbiBiZSBidXJuZWQgYXQgb25jZS4gQnVybmluZwogICAgLy9tYXkgYmUgZGlzYWJsZWQgYnkgc2V0dGluZyBib3RoIHRvIDAgKHRoaXMgd2lsbCBub3QgYmUgZG9uZSB1bmRlciBub3JtYWwKICAgIC8vb3BlcmF0aW9uLCBidXQgd2UgY2FuJ3QgYWRkIGNoZWNrcyB0byBkaXNhbGxvdyBpdCB3aXRob3V0IGxvc2luZyBhIGxvdCBvZgogICAgLy9mbGV4aWJpbGl0eSBzaW5jZSBidXJuaW5nIGNvdWxkIGFsc28gYmUgYXMgZ29vZCBhcyBkaXNhYmxlZAogICAgLy9ieSBzZXR0aW5nIHRoZSBtaW5pbXVtIGV4dHJlbWVseSBoaWdoLCBhbmQgd2UgZG9uJ3Qgd2FudCB0byBsb2NrCiAgICAvL2luIGFueSBwYXJ0aWN1bGFyIGNhcCBmb3IgdGhlIG1pbmltdW0pCiAgICBmdW5jdGlvbiBjaGFuZ2VCdXJuQm91bmRzKHVpbnQgbmV3TWluLCB1aW50IG5ld01heCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShuZXdNaW4gPD0gbmV3TWF4KTsKICAgICAgICBidXJuTWluID0gbmV3TWluOwogICAgICAgIGJ1cm5NYXggPSBuZXdNYXg7CiAgICAgICAgQ2hhbmdlQnVybkJvdW5kc0V2ZW50KG5ld01pbiwgbmV3TWF4KTsKICAgIH0KCiAgICAvLyB0cmFuc2ZlciBhbmQgdHJhbnNmZXJGcm9tIGFyZSBib3RoIGRpc3BhdGNoZWQgdG8gdGhpcyBmdW5jdGlvbiwgc28gd2UKICAgIC8vIGNoZWNrIGJsYWNrbGlzdCBhbmQgcGF5IHN0YWtpbmcgZmVlIGhlcmUuCiAgICBmdW5jdGlvbiB0cmFuc2ZlckFsbEFyZ3NOb0FsbG93YW5jZShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIGludGVybmFsIHsKICAgICAgICByZXF1aXJlKCFibGFja0xpc3Qub25MaXN0KF9mcm9tKSk7CiAgICAgICAgcmVxdWlyZSghYmxhY2tMaXN0Lm9uTGlzdChfdG8pKTsKICAgICAgICBzdXBlci50cmFuc2ZlckFsbEFyZ3NOb0FsbG93YW5jZShfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgICAgIHBheVN0YWtpbmdGZWUoX3RvLCBfdmFsdWUsIHRyYW5zZmVyRmVlTnVtZXJhdG9yLCB0cmFuc2ZlckZlZURlbm9taW5hdG9yLCAwLCBfZnJvbSk7CiAgICB9CgogICAgZnVuY3Rpb24gd2lwZUJsYWNrbGlzdGVkQWNjb3VudChhZGRyZXNzIGFjY291bnQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoYmxhY2tMaXN0Lm9uTGlzdChhY2NvdW50KSk7CiAgICAgICAgdWludDI1NiBvbGRWYWx1ZSA9IGJhbGFuY2VPZihhY2NvdW50KTsKICAgICAgICBiYWxhbmNlcy5zZXRCYWxhbmNlKGFjY291bnQsIDApOwogICAgICAgIHRvdGFsU3VwcGx5XyA9IHRvdGFsU3VwcGx5Xy5zdWIob2xkVmFsdWUpOwogICAgICAgIFdpcGVkQWNjb3VudChhY2NvdW50LCBvbGRWYWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gcGF5U3Rha2luZ0ZlZShhZGRyZXNzIHBheWVyLCB1aW50MjU2IHZhbHVlLCB1aW50ODAgbnVtZXJhdG9yLCB1aW50ODAgZGVub21pbmF0b3IsIHVpbnQyNTYgZmxhdFJhdGUsIGFkZHJlc3Mgb3RoZXJQYXJ0aWNpcGFudCkgcHJpdmF0ZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgaWYgKG5vRmVlc0xpc3Qub25MaXN0KHBheWVyKSB8fCBub0ZlZXNMaXN0Lm9uTGlzdChvdGhlclBhcnRpY2lwYW50KSkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgICAgdWludDI1NiBzdGFraW5nRmVlID0gdmFsdWUubXVsKG51bWVyYXRvcikuZGl2KGRlbm9taW5hdG9yKS5hZGQoZmxhdFJhdGUpOwogICAgICAgIGlmIChzdGFraW5nRmVlID4gMCkgewogICAgICAgICAgICBzdXBlci50cmFuc2ZlckFsbEFyZ3NOb0FsbG93YW5jZShwYXllciwgc3Rha2VyLCBzdGFraW5nRmVlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN0YWtpbmdGZWU7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlU3Rha2luZ0ZlZXModWludDgwIF90cmFuc2ZlckZlZU51bWVyYXRvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDgwIF90cmFuc2ZlckZlZURlbm9taW5hdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50ODAgX21pbnRGZWVOdW1lcmF0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ4MCBfbWludEZlZURlbm9taW5hdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MjU2IF9taW50RmVlRmxhdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDgwIF9idXJuRmVlTnVtZXJhdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50ODAgX2J1cm5GZWVEZW5vbWluYXRvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDI1NiBfYnVybkZlZUZsYXQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoX3RyYW5zZmVyRmVlRGVub21pbmF0b3IgIT0gMCk7CiAgICAgICAgcmVxdWlyZShfbWludEZlZURlbm9taW5hdG9yICE9IDApOwogICAgICAgIHJlcXVpcmUoX2J1cm5GZWVEZW5vbWluYXRvciAhPSAwKTsKICAgICAgICB0cmFuc2ZlckZlZU51bWVyYXRvciA9IF90cmFuc2ZlckZlZU51bWVyYXRvcjsKICAgICAgICB0cmFuc2ZlckZlZURlbm9taW5hdG9yID0gX3RyYW5zZmVyRmVlRGVub21pbmF0b3I7CiAgICAgICAgbWludEZlZU51bWVyYXRvciA9IF9taW50RmVlTnVtZXJhdG9yOwogICAgICAgIG1pbnRGZWVEZW5vbWluYXRvciA9IF9taW50RmVlRGVub21pbmF0b3I7CiAgICAgICAgbWludEZlZUZsYXQgPSBfbWludEZlZUZsYXQ7CiAgICAgICAgYnVybkZlZU51bWVyYXRvciA9IF9idXJuRmVlTnVtZXJhdG9yOwogICAgICAgIGJ1cm5GZWVEZW5vbWluYXRvciA9IF9idXJuRmVlRGVub21pbmF0b3I7CiAgICAgICAgYnVybkZlZUZsYXQgPSBfYnVybkZlZUZsYXQ7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlU3Rha2VyKGFkZHJlc3MgbmV3U3Rha2VyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG5ld1N0YWtlciAhPSBhZGRyZXNzKDApKTsKICAgICAgICBzdGFrZXIgPSBuZXdTdGFrZXI7CiAgICB9Cn0='.
	

]
