Class {
	#name : #SRT833882e76f4967b9b18f52d70640bfcc82aa91e9,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT833882e76f4967b9b18f52d70640bfcc82aa91e9 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMDsKCi8qCiAqIFRva2VuIC0gaXMgYSBzbWFydCBjb250cmFjdCBpbnRlcmZhY2UgCiAqIGZvciBtYW5hZ2luZyBjb21tb24gZnVuY3Rpb25hbGl0eSBvZiAKICogYSB0b2tlbi4KICoKICogRVJDLjIwIFRva2VuIHN0YW5kYXJkOiBodHRwczovL2dpdGh1Yi5jb20vZXRoIGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBUb2tlbkludGVyZmFjZSB7CgogICAgICAgIAogICAgLy8gdG90YWwgYW1vdW50IG9mIHRva2VucwogICAgdWludCB0b3RhbFN1cHBseTsKCiAgICAKICAgIC8qKgogICAgICoKICAgICAqIGJhbGFuY2VPZigpIC0gY29uc3RhbnQgZnVuY3Rpb24gY2hlY2sgY29uY3JldGUgdG9rZW5zIGJhbGFuY2UgIAogICAgICoKICAgICAqICBAcGFyYW0gb3duZXIgLSBhY2NvdW50IG93bmVyCiAgICAgKiAgCiAgICAgKiAgQHJldHVybiB0aGUgdmFsdWUgb2YgYmFsYW5jZSAKICAgICAqLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIG93bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwogICAgCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLyoqCiAgICAgKgogICAgICogYXBwcm92ZSgpIC0gZnVuY3Rpb24gYXBwcm92ZXMgdG8gYSBwZXJzb24gdG8gc3BlbmQgc29tZSB0b2tlbnMgZnJvbSAKICAgICAqICAgICAgICAgICBvd25lciBiYWxhbmNlLiAKICAgICAqCiAgICAgKiAgQHBhcmFtIHNwZW5kZXIgLSBwZXJzb24gd2hvbSB0aGlzIHJpZ2h0IGJlZW4gZ3JhbnRlZC4KICAgICAqICBAcGFyYW0gdmFsdWUgICAtIHZhbHVlIHRvIHNwZW5kLgogICAgICogCiAgICAgKiAgQHJldHVybiB0cnVlIGluIGNhc2Ugb2Ygc3VjY2VzLCBvdGhlcndpc2UgZmFpbHVyZQogICAgICogCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8qKgogICAgICoKICAgICAqIGFsbG93YW5jZSgpIC0gY29uc3RhbnQgZnVuY3Rpb24gdG8gY2hlY2sgaG93IG11Y2ggaXMgCiAgICAgKiAgICAgICAgICAgICAgIHBlcm1pdHRlZCB0byBzcGVuZCB0byAzcmQgcGVyc29uIGZyb20gb3duZXIgYmFsYW5jZQogICAgICoKICAgICAqICBAcGFyYW0gb3duZXIgICAtIG93bmVyIG9mIHRoZSBiYWxhbmNlCiAgICAgKiAgQHBhcmFtIHNwZW5kZXIgLSBwZXJtaXR0ZWQgdG8gc3BlbmQgZnJvbSB0aGlzIGJhbGFuY2UgcGVyc29uIAogICAgICogIAogICAgICogIEByZXR1cm4gLSByZW1haW5pbmcgcmlnaHQgdG8gc3BlbmQgCiAgICAgKiAKICAgICAqLwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOwoKICAgIC8vIGV2ZW50cyBub3RpZmljYXRpb25zCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgoKLyoKICogU3RhbmRhcmRUb2tlbiAtIGlzIGEgc21hcnQgY29udHJhY3QgIAogKiBmb3IgbWFuYWdpbmcgY29tbW9uIGZ1bmN0aW9uYWxpdHkgb2YgCiAqIGEgdG9rZW4uCiAqCiAqIEVSQy4yMCBUb2tlbiBzdGFuZGFyZDogCiAqICAgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL2V0aCBlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBUb2tlbkludGVyZmFjZSB7CgoKICAgIC8vIHRva2VuIG93bmVyc2hpcAogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgICAvLyBzcGVuZGluZyBwZXJtaXNpb24gbWFuYWdlbWVudAogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwogICAgCiAgICAKICAgIAogICAgZnVuY3Rpb24gU3RhbmRhcmRUb2tlbigpewogICAgfQogICAgCiAgICAKICAgIC8qKgogICAgICogdHJhbnNmZXIoKSAtIHRyYW5zZmVyIHRva2VucyBmcm9tIG1zZy5zZW5kZXIgYmFsYW5jZSAKICAgICAqICAgICAgICAgICAgICB0byByZXF1ZXN0ZWQgYWNjb3VudAogICAgICoKICAgICAqICBAcGFyYW0gdG8gICAgLSB0YXJnZXQgYWRkcmVzcyB0byB0cmFuc2ZlciB0b2tlbnMKICAgICAqICBAcGFyYW0gdmFsdWUgLSBhbW1vdW50IG9mIHRva2VucyB0byB0cmFuc2ZlcgogICAgICoKICAgICAqICBAcmV0dXJuIC0gc3VjY2VzcyAvIGZhaWx1cmUgb2YgdGhlIHRyYW5zYWN0aW9uCiAgICAgKi8gICAgCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICAKICAgICAgICAKICAgICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gdmFsdWUgJiYgdmFsdWUgPiAwKSB7CgogICAgICAgICAgICAvLyBkbyBhY3R1YWwgdG9rZW5zIHRyYW5zZmVyICAgICAgIAogICAgICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSB2YWx1ZTsKICAgICAgICAgICAgYmFsYW5jZXNbdG9dICAgICAgICAgKz0gdmFsdWU7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyByaXNlIHRoZSBUcmFuc2ZlciBldmVudAogICAgICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCB0bywgdmFsdWUpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOyAKICAgICAgICB9CiAgICB9CiAgICAKICAgIAoKICAgIAogICAgLyoqCiAgICAgKiB0cmFuc2ZlckZyb20oKSAtIAogICAgICoKICAgICAqICBAcGFyYW0gZnJvbSAgLSAKICAgICAqICBAcGFyYW0gdG8gICAgLSAKICAgICAqICBAcGFyYW0gdmFsdWUgLSAKICAgICAqCiAgICAgKiAgQHJldHVybiAKICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAKICAgICAgICBpZiAoIGJhbGFuY2VzW2Zyb21dID49IHZhbHVlICYmIAogICAgICAgICAgICAgYWxsb3dlZFtmcm9tXVttc2cuc2VuZGVyXSA+PSB2YWx1ZSAmJiAKICAgICAgICAgICAgIHZhbHVlID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgIAogICAgICAgICAgICAvLyBkbyB0aGUgYWN0dWFsIHRyYW5zZmVyCiAgICAgICAgICAgIGJhbGFuY2VzW2Zyb21dIC09IHZhbHVlOyAgICAKICAgICAgICAgICAgYmFsYW5jZXNbdG9dID0rIHZhbHVlOyAgICAgICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIC8vIGFkZGp1c3QgdGhlIHBlcm1pc2lvbiwgYWZ0ZXIgcGFydCBvZiAKICAgICAgICAgICAgLy8gcGVybWl0ZWQgdG8gc3BlbmQgdmFsdWUgd2FzIHVzZWQKICAgICAgICAgICAgYWxsb3dlZFtmcm9tXVttc2cuc2VuZGVyXSAtPSB2YWx1ZTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIHJpc2UgdGhlIFRyYW5zZmVyIGV2ZW50CiAgICAgICAgICAgIFRyYW5zZmVyKGZyb20sIHRvLCB2YWx1ZSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSB7IAogICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOyAKICAgICAgICB9CiAgICB9CgogICAgCgogICAgCiAgICAvKioKICAgICAqCiAgICAgKiBiYWxhbmNlT2YoKSAtIGNvbnN0YW50IGZ1bmN0aW9uIGNoZWNrIGNvbmNyZXRlIHRva2VucyBiYWxhbmNlICAKICAgICAqCiAgICAgKiAgQHBhcmFtIG93bmVyIC0gYWNjb3VudCBvd25lcgogICAgICogIAogICAgICogIEByZXR1cm4gdGhlIHZhbHVlIG9mIGJhbGFuY2UgCiAgICAgKi8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBvd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW293bmVyXTsKICAgIH0KCiAgICAKICAgIAogICAgLyoqCiAgICAgKgogICAgICogYXBwcm92ZSgpIC0gZnVuY3Rpb24gYXBwcm92ZXMgdG8gYSBwZXJzb24gdG8gc3BlbmQgc29tZSB0b2tlbnMgZnJvbSAKICAgICAqICAgICAgICAgICBvd25lciBiYWxhbmNlLiAKICAgICAqCiAgICAgKiAgQHBhcmFtIHNwZW5kZXIgLSBwZXJzb24gd2hvbSB0aGlzIHJpZ2h0IGJlZW4gZ3JhbnRlZC4KICAgICAqICBAcGFyYW0gdmFsdWUgICAtIHZhbHVlIHRvIHNwZW5kLgogICAgICogCiAgICAgKiAgQHJldHVybiB0cnVlIGluIGNhc2Ugb2Ygc3VjY2VzLCBvdGhlcndpc2UgZmFpbHVyZQogICAgICogCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICAKICAgICAgICAvLyBub3cgc3BlbmRlciBjYW4gdXNlIGJhbGFuY2UgaW4gCiAgICAgICAgLy8gYW1tb3VudCBvZiB2YWx1ZSBmcm9tIG93bmVyIGJhbGFuY2UKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW3NwZW5kZXJdID0gdmFsdWU7CiAgICAgICAgCiAgICAgICAgLy8gcmlzZSBldmVudCBhYm91dCB0aGUgdHJhbnNhY3Rpb24KICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBzcGVuZGVyLCB2YWx1ZSk7CiAgICAgICAgCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKgogICAgICogYWxsb3dhbmNlKCkgLSBjb25zdGFudCBmdW5jdGlvbiB0byBjaGVjayBob3cgbW91Y2ggaXMgCiAgICAgKiAgICAgICAgICAgICAgIHBlcm1pdGVkIHRvIHNwZW5kIHRvIDNyZCBwZXJzb24gZnJvbSBvd25lciBiYWxhbmNlCiAgICAgKgogICAgICogIEBwYXJhbSBvd25lciAgIC0gb3duZXIgb2YgdGhlIGJhbGFuY2UKICAgICAqICBAcGFyYW0gc3BlbmRlciAtIHBlcm1pdGVkIHRvIHNwZW5kIGZyb20gdGhpcyBiYWxhbmNlIHBlcnNvbiAKICAgICAqICAKICAgICAqICBAcmV0dXJuIC0gcmVtYWluaW5nIHJpZ2h0IHRvIHNwZW5kIAogICAgICogCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICAgIHJldHVybiBhbGxvd2VkW293bmVyXVtzcGVuZGVyXTsKICAgIH0KCn0KCgovKioKICoKICogQHRpdGxlIEhhY2tlciBHb2xkCiAqIAogKiBUaGUgb2ZmaWNpYWwgdG9rZW4gcG93ZXJpbmcgdGhlIGhhY2suZXRoZXIuY2FtcCB2aXJ0dWFsIGFjY2VsZXJhdG9yLgogKiBUaGlzIGlzIHRoZSBvbmx5IHdheSB0byBhY3F1aXJlIHRva2VucyBmcm9tIHN0YXJ0dXBzIGR1cmluZyB0aGUgZXZlbnQuCiAqCiAqIFdoaXRlcGFwZXIgaHR0cHM6Ly9oYWNrLmV0aGVyLmNhbXAvd2hpdGVwYXBlcgogKgogKi8KY29udHJhY3QgSGFja2VyR29sZCBpcyBTdGFuZGFyZFRva2VuIHsKCiAgICAvLyBOYW1lIG9mIHRoZSB0b2tlbiAgICAKICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICJIYWNrZXJHb2xkIjsKCiAgICAvLyBEZWNpbWFsIHBsYWNlcwogICAgdWludDggIHB1YmxpYyBkZWNpbWFscyA9IDM7CiAgICAvLyBUb2tlbiBhYmJyZXZpYXRpb24gICAgICAgIAogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAiSEtHIjsKICAgIAogICAgLy8gMSBldGhlciA9IDIwMCBoa2cKICAgIHVpbnQgQkFTRV9QUklDRSA9IDIwMDsKICAgIC8vIDEgZXRoZXIgPSAxNTAgaGtnCiAgICB1aW50IE1JRF9QUklDRSA9IDE1MDsKICAgIC8vIDEgZXRoZXIgPSAxMDAgaGtnCiAgICB1aW50IEZJTl9QUklDRSA9IDEwMDsKICAgIC8vIFNhZmV0eSBjYXAKICAgIHVpbnQgU0FGRVRZX0xJTUlUID0gNDAwMDAwMCBldGhlcjsKICAgIC8vIFplcm9zIGFmdGVyIHRoZSBwb2ludAogICAgdWludCBERUNJTUFMX1pFUk9TID0gMTAwMDsKICAgIAogICAgLy8gVG90YWwgdmFsdWUgaW4gd2VpCiAgICB1aW50IHRvdGFsVmFsdWU7CiAgICAKICAgIC8vIEFkZHJlc3Mgb2YgbXVsdGlzaWcgd2FsbGV0IGhvbGRpbmcgZXRoZXIgZnJvbSBzYWxlCiAgICBhZGRyZXNzIHdhbGxldDsKCiAgICAvLyBTdHJ1Y3R1cmUgb2Ygc2FsZSBpbmNyZWFzZSBtaWxlc3RvbmVzCiAgICBzdHJ1Y3QgbWlsZXN0b25lc19zdHJ1Y3QgewogICAgICB1aW50IHAxOwogICAgICB1aW50IHAyOyAKICAgICAgdWludCBwMzsKICAgICAgdWludCBwNDsKICAgICAgdWludCBwNTsKICAgICAgdWludCBwNjsKICAgIH0KICAgIC8vIE1pbGVzdG9uZXMgaW5zdGFuY2UKICAgIG1pbGVzdG9uZXNfc3RydWN0IG1pbGVzdG9uZXM7CiAgICAKICAgIC8qKgogICAgICogQ29uc3RydWN0b3Igb2YgdGhlIGNvbnRyYWN0LgogICAgICogCiAgICAgKiBQYXNzZXMgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBob2xkaW5nIHRoZSB2YWx1ZS4KICAgICAqIEhhY2tlckdvbGQgY29udHJhY3QgaXRzZWxmIGRvZXMgbm90IGhvbGQgYW55IHZhbHVlCiAgICAgKiAKICAgICAqIEBwYXJhbSBtdWx0aXNpZyBhZGRyZXNzIG9mIE11bHRpU2lnIHdhbGxldCB3aGljaCB3aWxsIGhvbGQgdGhlIHZhbHVlCiAgICAgKi8KICAgIGZ1bmN0aW9uIEhhY2tlckdvbGQoYWRkcmVzcyBtdWx0aXNpZykgewogICAgICAgIAogICAgICAgIHdhbGxldCA9IG11bHRpc2lnOwoKICAgICAgICAvLyBzZXQgdGltZSBwZXJpb2RzIGZvciBzYWxlCiAgICAgICAgbWlsZXN0b25lcyA9IG1pbGVzdG9uZXNfc3RydWN0KAogICAgICAgIAogICAgICAgICAgMTQ3Njk3MjAwMCwgIC8vIFAxOiBHTVQ6IDIwLU9jdC0yMDE2IDE0OjAwICA9PiBUaGUgU2FsZSBTdGFydHMKICAgICAgICAgIDE0NzgxODE2MDAsICAvLyBQMjogR01UOiAwMy1Ob3YtMjAxNiAxNDowMCAgPT4gMXN0IFByaWNlIExhZGRlciAKICAgICAgICAgIDE0NzkzOTEyMDAsICAvLyBQMzogR01UOiAxNy1Ob3YtMjAxNiAxNDowMCAgPT4gUHJpY2UgU3RhYmxlLCAKICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSGFja2F0aG9uIFN0YXJ0cwogICAgICAgICAgMTQ4MDYwMDgwMCwgIC8vIFA0OiBHTVQ6IDAxLURlYy0yMDE2IDE0OjAwICA9PiAybmQgUHJpY2UgTGFkZGVyCiAgICAgICAgICAxNDgxODEwNDAwLCAgLy8gUDU6IEdNVDogMTUtRGVjLTIwMTYgMTQ6MDAgID0+IFByaWNlIFN0YWJsZQogICAgICAgICAgMTQ4MjQxNTIwMCAgIC8vIFA2OiBHTVQ6IDIyLURlYy0yMDE2IDE0OjAwICA9PiBTYWxlIEVuZHMsIEhhY2thdGhvbiBFbmRzCiAgICAgICAgKTsKICAgICAgICAgICAgICAgIAogICAgfQogICAgCiAgICAKICAgIC8qKgogICAgICogRmFsbGJhY2sgZnVuY3Rpb246IGNhbGxlZCBvbiBldGhlciBzZW50LgogICAgICogCiAgICAgKiBJdCBjYWxscyB0byBjcmVhdGVIS0cgZnVuY3Rpb24gd2l0aCBtc2cuc2VuZGVyIAogICAgICogYXMgYSB2YWx1ZSBmb3IgaG9sZGVyIGFyZ3VtZW50CiAgICAgKi8KICAgIGZ1bmN0aW9uICgpIHBheWFibGUgewogICAgICAgIGNyZWF0ZUhLRyhtc2cuc2VuZGVyKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBDcmVhdGVzIEhLRyB0b2tlbnMuCiAgICAgKiAKICAgICAqIFJ1bnMgc2FuaXR5IGNoZWNrcyBpbmNsdWRpbmcgc2FmZXR5IGNhcAogICAgICogVGhlbiBjYWxjdWxhdGVzIGN1cnJlbnQgcHJpY2UgYnkgZ2V0UHJpY2UoKSBmdW5jdGlvbiwgY3JlYXRlcyBIS0cgdG9rZW5zCiAgICAgKiBGaW5hbGx5IHNlbmRzIGEgdmFsdWUgb2YgdHJhbnNhY3Rpb24gdG8gdGhlIHdhbGxldAogICAgICogCiAgICAgKiBOb3RlOiBkdWUgdG8gbGFjayBvZiBmbG9hdGluZyBwb2ludCB0eXBlcyBpbiBTb2xpZGl0eSwKICAgICAqIGNvbnRyYWN0IGFzc3VtZXMgdGhhdCBsYXN0IDMgZGlnaXRzIGluIHRva2VucyBhbW91bnQgYXJlIHN0b29kIGFmdGVyIHRoZSBwb2ludC4KICAgICAqIEl0IG1lYW5zIHRoYXQgaWYgc3RvcmVkIEhLRyBiYWxhbmNlIGlzIDEwMDAwMCwgdGhlbiBpdHMgcmVhbCB2YWx1ZSBpcyAxMDAgSEtHCiAgICAgKiAKICAgICAqIEBwYXJhbSBob2xkZXIgdG9rZW4gaG9sZGVyCiAgICAgKi8KICAgIGZ1bmN0aW9uIGNyZWF0ZUhLRyhhZGRyZXNzIGhvbGRlcikgcGF5YWJsZSB7CiAgICAgICAgCiAgICAgICAgaWYgKG5vdyA8IG1pbGVzdG9uZXMucDEpIHRocm93OwogICAgICAgIGlmIChub3cgPj0gbWlsZXN0b25lcy5wNikgdGhyb3c7CiAgICAgICAgaWYgKG1zZy52YWx1ZSA9PSAwKSB0aHJvdzsKICAgIAogICAgICAgIC8vIHNhZmV0eSBjYXAKICAgICAgICBpZiAoZ2V0VG90YWxWYWx1ZSgpICsgbXNnLnZhbHVlID4gU0FGRVRZX0xJTUlUKSB0aHJvdzsgCiAgICAKICAgICAgICB1aW50IHRva2VucyA9IG1zZy52YWx1ZSAqIGdldFByaWNlKCkgKiBERUNJTUFMX1pFUk9TIC8gMSBldGhlcjsKCiAgICAgICAgdG90YWxTdXBwbHkgKz0gdG9rZW5zOwogICAgICAgIGJhbGFuY2VzW2hvbGRlcl0gKz0gdG9rZW5zOwogICAgICAgIHRvdGFsVmFsdWUgKz0gbXNnLnZhbHVlOwogICAgICAgIAogICAgICAgIGlmICghd2FsbGV0LnNlbmQobXNnLnZhbHVlKSkgdGhyb3c7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogRGVub3RlcyBjb21wbGV0ZSBwcmljZSBzdHJ1Y3R1cmUgZHVyaW5nIHRoZSBzYWxlLgogICAgICoKICAgICAqIEByZXR1cm4gSEtHIGFtb3VudCBwZXIgMSBFVEggZm9yIHRoZSBjdXJyZW50IG1vbWVudCBpbiB0aW1lCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFByaWNlKCkgY29uc3RhbnQgcmV0dXJucyAodWludCByZXN1bHQpIHsKICAgICAgICAKICAgICAgICBpZiAobm93IDwgbWlsZXN0b25lcy5wMSkgcmV0dXJuIDA7CiAgICAgICAgCiAgICAgICAgaWYgKG5vdyA+PSBtaWxlc3RvbmVzLnAxICYmIG5vdyA8IG1pbGVzdG9uZXMucDIpIHsKICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIEJBU0VfUFJJQ0U7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGlmIChub3cgPj0gbWlsZXN0b25lcy5wMiAmJiBub3cgPCBtaWxlc3RvbmVzLnAzKSB7CiAgICAgICAgICAgIAogICAgICAgICAgICB1aW50IGRheXNfaW4gPSAxICsgKG5vdyAtIG1pbGVzdG9uZXMucDIpIC8gMSBkYXlzOyAKICAgICAgICAgICAgcmV0dXJuIEJBU0VfUFJJQ0UgLSBkYXlzX2luICogMjUgLyA3OyAgLy8gZGFpbHkgZGVjcmVhc2UgMy41CiAgICAgICAgfQoKICAgICAgICBpZiAobm93ID49IG1pbGVzdG9uZXMucDMgJiYgbm93IDwgbWlsZXN0b25lcy5wNCkgewogICAgICAgIAogICAgICAgICAgICByZXR1cm4gTUlEX1BSSUNFOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAobm93ID49IG1pbGVzdG9uZXMucDQgJiYgbm93IDwgbWlsZXN0b25lcy5wNSkgewogICAgICAgICAgICAKICAgICAgICAgICAgZGF5c19pbiA9IDEgKyAobm93IC0gbWlsZXN0b25lcy5wNCkgLyAxIGRheXM7IAogICAgICAgICAgICByZXR1cm4gTUlEX1BSSUNFIC0gZGF5c19pbiAqIDI1IC8gNzsgIC8vIGRhaWx5IGRlY3JlYXNlIDMuNQogICAgICAgIH0KCiAgICAgICAgaWYgKG5vdyA+PSBtaWxlc3RvbmVzLnA1ICYmIG5vdyA8IG1pbGVzdG9uZXMucDYpIHsKICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIEZJTl9QUklDRTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKG5vdyA+PSBtaWxlc3RvbmVzLnA2KXsKCiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KCiAgICAgfQogICAgCiAgICAvKioKICAgICAqIFJldHVybnMgdG90YWwgc3RvcmVkIEhLRyBhbW91bnQuCiAgICAgKiAKICAgICAqIENvbnRyYWN0IGFzc3VtZXMgdGhhdCBsYXN0IDMgZGlnaXRzIG9mIHRoaXMgdmFsdWUgYXJlIGJlaGluZCB0aGUgZGVjaW1hbCBwbGFjZS4gaS5lLiAxMDAwMSBpcyAxMC4wMDEKICAgICAqIFRodXMsIHJlc3VsdCBvZiB0aGlzIGZ1bmN0aW9uIHNob3VsZCBiZSBkaXZpZGVkIGJ5IDEwMDAgdG8gZ2V0IEhLRyB2YWx1ZQogICAgICogCiAgICAgKiBAcmV0dXJuIHJlc3VsdCBzdG9yZWQgSEtHIGFtb3VudAogICAgICovCiAgICBmdW5jdGlvbiBnZXRUb3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcmVzdWx0KSB7CiAgICAgICAgcmV0dXJuIHRvdGFsU3VwcGx5OwogICAgfSAKCiAgICAvKioKICAgICAqIEl0IGlzIHVzZWQgZm9yIHRlc3QgcHVycG9zZXMuCiAgICAgKiAKICAgICAqIFJldHVybnMgdGhlIHJlc3VsdCBvZiAnbm93JyBzdGF0ZW1lbnQgb2YgU29saWRpdHkgbGFuZ3VhZ2UKICAgICAqIAogICAgICogQHJldHVybiB1bml4IHRpbWVzdGFtcCBmb3IgY3VycmVudCBtb21lbnQgaW4gdGltZQogICAgICovCiAgICBmdW5jdGlvbiBnZXROb3coKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlc3VsdCkgewogICAgICAgIHJldHVybiBub3c7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRvdGFsIHZhbHVlIHBhc3NlZCB0aHJvdWdoIHRoZSBjb250cmFjdAogICAgICogCiAgICAgKiBAcmV0dXJuIHJlc3VsdCB0b3RhbCB2YWx1ZSBpbiB3ZWkKICAgICAqLwogICAgZnVuY3Rpb24gZ2V0VG90YWxWYWx1ZSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcmVzdWx0KSB7CiAgICAgICAgcmV0dXJuIHRvdGFsVmFsdWU7ICAKICAgIH0KfQoKY29udHJhY3QgRFNUQ29udHJhY3QgaXMgU3RhbmRhcmRUb2tlbnsKCiAgICAvLyBaZXJvcyBhZnRlciB0aGUgcG9pbnQKICAgIHVpbnQgREVDSU1BTF9aRVJPUyA9IDEwMDA7CiAgICAvLyBQcm9wb3NhbCBsaWZldGltZQogICAgdWludCBQUk9QT1NBTF9MSUZFVElNRSA9IDEwIGRheXM7CiAgICAvLyBQcm9wb3NhbCBmdW5kcyB0aHJlc2hvbGQsIGluIHBlcmNlbnRzCiAgICB1aW50IFBST1BPU0FMX0ZVTkRTX1RIID0gMjA7CgogICAgYWRkcmVzcyAgIGV4ZWN1dGl2ZTsgCiAgICAgICAgCiAgICBFdmVudEluZm8gZXZlbnRJbmZvOwogICAgCiAgICAvLyBJbmRpY2F0ZWQgd2hlcmUgdGhlIERTVCBpcyB0cmFkZWQKICAgIGFkZHJlc3MgdmlydHVhbEV4Y2hhbmdlQWRkcmVzczsKICAgIAogICAgSGFja2VyR29sZCBoYWNrZXJHb2xkOwogICAgICAgIAogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSB2b3RpbmdSaWdodHM7CgoKICAgIC8vIDEgLSBIS0cgPT4gRFNUIHF0eTsgdG9rZW5zIGZvciAxIEhLRwogICAgdWludCBoa2dQcmljZTsKICAgIAogICAgLy8gMSAtIEV0aGVyID0+IERTVCBxdHk7IHRva2VucyBmb3IgMSBFdGhlcgogICAgdWludCBldGhlclByaWNlOwogICAgCiAgICBzdHJpbmcgcHVibGljIG5hbWUgPSAiLi4uIjsgICAgICAgICAgICAgICAgICAgCiAgICB1aW50OCAgcHVibGljIGRlY2ltYWxzID0gMzsgICAgICAgICAgICAgICAgIAogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAiLi4uIjsKICAgIAogICAgYm9vbCBhYmxlVG9Jc3N1ZVRva2VucyA9IHRydWU7IAogICAgCiAgICB1aW50IHByZWZlcmVkUXR5U29sZDsKCiAgICB1aW50IGNvbGxlY3RlZEhLRzsgCiAgICB1aW50IGNvbGxlY3RlZEV0aGVyOyAgICAKICAgIAogICAgLy8gUHJvcG9zYWwgb2YgdGhlIGZ1bmRzIHNwZW5kaW5nCiAgICBtYXBwaW5nIChieXRlczMyID0+IFByb3Bvc2FsKSBwcm9wb3NhbHM7CgogICAgZW51bSBQcm9wb3NhbEN1cnJlbmN5IHsgSEtHLCBFVEhFUiB9CiAgICBQcm9wb3NhbEN1cnJlbmN5IGVudW1EZWNsYXJhdGlvbjsKICAgICAgICAgICAgICAgICAgCiAgICAgICAKICAgIHN0cnVjdCBQcm9wb3NhbHsKICAgICAgICAKICAgICAgICBieXRlczMyIGlkOwogICAgICAgIHVpbnQgdmFsdWU7CgogICAgICAgIHN0cmluZyB1cmxEZXRhaWxzOwoKICAgICAgICB1aW50IHZvdGluZEVuZFRTOwogICAgICAgICAgICAgICAgCiAgICAgICAgdWludCB2b3Rlc09iamVjdGluZzsKICAgICAgICAKICAgICAgICBhZGRyZXNzIHN1Ym1pdHRlcjsKICAgICAgICBib29sIHJlZGVlbWVkOwoKICAgICAgICBQcm9wb3NhbEN1cnJlbmN5IHByb3Bvc2FsQ3VycmVuY3k7CiAgICAgICAgCiAgICAgICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSB2b3RlZDsKICAgIH0KICAgIHVpbnQgY291bnRlclByb3Bvc2FsczsKICAgIHVpbnQgdGltZU9mTGFzdFByb3Bvc2FsOwogICAgCiAgICBQcm9wb3NhbFtdIGxpc3RQcm9wb3NhbHM7CiAgICAKCiAgICAvKioKICAgICAqIEltcGVhY2htZW50IHByb2Nlc3MgcHJvcG9zYWxzCiAgICAgKi8gICAgCiAgICBzdHJ1Y3QgSW1wZWFjaG1lbnRQcm9wb3NhbHsKICAgICAgICAKICAgICAgICBzdHJpbmcgdXJsRGV0YWlsczsKICAgICAgICAKICAgICAgICBhZGRyZXNzIG5ld0V4ZWN1dGl2ZTsKCiAgICAgICAgdWludCB2b3RpbmRFbmRUUzsgICAgICAgIAogICAgICAgIHVpbnQgdm90ZXNTdXBwb3J0aW5nOwogICAgICAgIAogICAgICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgdm90ZWQ7ICAgICAgICAKICAgIH0KICAgIEltcGVhY2htZW50UHJvcG9zYWwgbGFzdEltcGVhY2htZW50UHJvcG9zYWw7CgogICAgICAgIAogICAgLyoqCiAgICAgKiAKICAgICAqICBEU1RDb250cmFjdDogY3RvciBmb3IgRFNUIHRva2VuIGFuZCBnb3Zlcm5lbmNlIGNvbnRyYWN0CiAgICAgKgogICAgICogIEBwYXJhbSBldmVudEluZm9BZGRyIEV2ZW50SW5mbzogYWRkcmVzcyBvZiBvYmplY3QgZGVub3RlcyBldmVudHMgCiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaWxlc3RvbmVzICAgICAgCiAgICAgKiAgQHBhcmFtIGhhY2tlckdvbGRBZGRyIEhhY2tlckdvbGQ6IGFkZHJlc3Mgb2YgSGFja2VyR29sZCB0b2tlbgogICAgICoKICAgICAqICBAcGFyYW0gZHN0TmFtZSBzdHJpbmc6IGRzdE5hbWU6IHJlYWwgbmFtZSBvZiB0aGUgdGVhbQogICAgICoKICAgICAqICBAcGFyYW0gZHN0U3ltYm9sIHN0cmluZzogMyBsZXR0ZXIgc3ltYm9sZCBvZiB0aGUgdGVhbQogICAgICoKICAgICAqLyAKICAgIGZ1bmN0aW9uIERTVENvbnRyYWN0KEV2ZW50SW5mbyBldmVudEluZm9BZGRyLCBIYWNrZXJHb2xkIGhhY2tlckdvbGRBZGRyLCBzdHJpbmcgZHN0TmFtZSwgc3RyaW5nIGRzdFN5bWJvbCl7CiAgICAKICAgICAgZXhlY3V0aXZlICAgPSBtc2cuc2VuZGVyOyAgCiAgICAgIG5hbWUgICAgICAgID0gZHN0TmFtZTsKICAgICAgc3ltYm9sICAgICAgPSBkc3RTeW1ib2w7CgogICAgICBoYWNrZXJHb2xkID0gSGFja2VyR29sZChoYWNrZXJHb2xkQWRkcik7CiAgICAgIGV2ZW50SW5mbyAgPSBFdmVudEluZm8oZXZlbnRJbmZvQWRkcik7CiAgICB9CiAgICAKCiAgICBmdW5jdGlvbigpIHBheWFibGUKICAgICAgICAgICAgICAgb25seUFmdGVyRW5kIHsKICAgICAgICAKICAgICAgICAvLyB0aGVyZSBpcyB0b2tlbnMgbGVmdCBmcm9tIGhhY2thdGhvbiAKICAgICAgICBpZiAoZXRoZXJQcmljZSA9PSAwKSB0aHJvdzsKICAgICAgICAKICAgICAgICB1aW50IHRva2VucyA9IG1zZy52YWx1ZSAqIGV0aGVyUHJpY2UgKiBERUNJTUFMX1pFUk9TIC8gKDEgZXRoZXIpOwogICAgICAgIAogICAgICAgIC8vIGNoZWNrIGlmIGRlbWFuZCBvZiB0b2tlbnMgaXMgCiAgICAgICAgLy8gb3ZlcmZsb3cgdGhlIHN1cHBseSAKICAgICAgICB1aW50IHJldEV0aGVyID0gMDsKICAgICAgICBpZiAoYmFsYW5jZXNbdGhpc10gPCB0b2tlbnMpIHsKICAgICAgICAgICAgCiAgICAgICAgICAgIHRva2VucyA9IGJhbGFuY2VzW3RoaXNdOwogICAgICAgICAgICByZXRFdGhlciA9IG1zZy52YWx1ZSAtIHRva2VucyAvIGV0aGVyUHJpY2UgKiAoMSBmaW5uZXkpOwogICAgICAgIAogICAgICAgICAgICAvLyByZXR1cm4gbGVmdCBldGhlciAKICAgICAgICAgICAgaWYgKCFtc2cuc2VuZGVyLnNlbmQocmV0RXRoZXIpKSB0aHJvdzsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgCiAgICAgICAgLy8gZG8gdHJhbnNmZXIKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSArPSB0b2tlbnM7CiAgICAgICAgYmFsYW5jZXNbdGhpc10gLT0gdG9rZW5zOwogICAgICAgIAogICAgICAgIC8vIGNvdW50IGNvbGxlY3RlZCBldGhlciAKICAgICAgICBjb2xsZWN0ZWRFdGhlciArPSBtc2cudmFsdWUgLSByZXRFdGhlcjsgCiAgICAgICAgCiAgICAgICAgLy8gcmlzZSBldmVudAogICAgICAgIEJ1eUZvckV0aGVyVHJhbnNhY3Rpb24obXNnLnNlbmRlciwgY29sbGVjdGVkRXRoZXIsIHRvdGFsU3VwcGx5LCBldGhlclByaWNlLCB0b2tlbnMpOwogICAgICAgIAogICAgfQoKICAgIAogICAgCiAgICAvKioKICAgICAqIHNldEhLR1ByaWNlIC0gc2V0IHByaWNlOiAxSEtHID0+IERTVCB0b2tlbnMgcXR5CiAgICAgKgogICAgICogIEBwYXJhbSBxdHlGb3JPbmVIS0cgdWludDogRFNUIHRva2VucyBmb3IgMSBIS0cKICAgICAqIAogICAgICovICAgIAogICAgIGZ1bmN0aW9uIHNldEhLR1ByaWNlKHVpbnQgcXR5Rm9yT25lSEtHKSBvbmx5RXhlY3V0aXZlICB7CiAgICAgICAgIAogICAgICAgICBoa2dQcmljZSA9IHF0eUZvck9uZUhLRzsKICAgICAgICAgUHJpY2VIS0dDaGFuZ2UocXR5Rm9yT25lSEtHLCBwcmVmZXJlZFF0eVNvbGQsIHRvdGFsU3VwcGx5KTsKICAgICB9CiAgICAgCiAgICAgCiAgICAKICAgIC8qKgogICAgICogCiAgICAgKiBpc3N1ZVByZWZlcmVkVG9rZW5zIC0gcHJlZmVyZWQgdG9rZW5zIGlzc3VlZCBvbiB0aGUgaGFja2F0aG9uIGV2ZW50CiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgZ3JhbnQgc3BlY2lhbCByaWdodHMKICAgICAqCiAgICAgKiAgQHBhcmFtIHF0eUZvck9uZUhLRyB1aW50OiBwcmljZSBEU1QgdG9rZW5zIGZvciBvbmUgMSBIS0cKICAgICAqICBAcGFyYW0gcXR5VG9FbWl0IHVpbnQ6IG5ldyBzdXBwbHkgb2YgdG9rZW5zIAogICAgICogCiAgICAgKi8KICAgIGZ1bmN0aW9uIGlzc3VlUHJlZmVyZWRUb2tlbnModWludCBxdHlGb3JPbmVIS0csIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50IHF0eVRvRW1pdCkgb25seUV4ZWN1dGl2ZSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ubHlJZkFibGVUb0lzc3VlVG9rZW5zCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbmx5QmVmb3JlRW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbmx5QWZ0ZXJUcmFkaW5nU3RhcnQgewogICAgICAgICAgICAgICAgCiAgICAgICAgLy8gbm8gaXNzdWVuY2UgaXMgYWxsb3dlZCBiZWZvcmUgZW5saXN0ZWQgb24gdGhlCiAgICAgICAgLy8gZXhjaGFuZ2UgCiAgICAgICAgaWYgKHZpcnR1YWxFeGNoYW5nZUFkZHJlc3MgPT0gMHgwKSB0aHJvdzsKICAgICAgICAgICAgCiAgICAgICAgdG90YWxTdXBwbHkgICAgKz0gcXR5VG9FbWl0OwogICAgICAgIGJhbGFuY2VzW3RoaXNdICs9IHF0eVRvRW1pdDsKICAgICAgICBoa2dQcmljZSA9IHF0eUZvck9uZUhLRzsKICAgICAgICAKICAgICAgICAKICAgICAgICAvLyBub3cgc3BlbmRlciBjYW4gdXNlIGJhbGFuY2UgaW4gCiAgICAgICAgLy8gYW1vdW50IG9mIHZhbHVlIGZyb20gb3duZXIgYmFsYW5jZQogICAgICAgIGFsbG93ZWRbdGhpc11bdmlydHVhbEV4Y2hhbmdlQWRkcmVzc10gKz0gcXR5VG9FbWl0OwogICAgICAgIAogICAgICAgIC8vIHJpc2UgZXZlbnQgYWJvdXQgdGhlIHRyYW5zYWN0aW9uCiAgICAgICAgQXBwcm92YWwodGhpcywgdmlydHVhbEV4Y2hhbmdlQWRkcmVzcywgcXR5VG9FbWl0KTsKICAgICAgICAKICAgICAgICAvLyByaXNlIGV2ZW50IAogICAgICAgIERzdFRva2Vuc0lzc3VlZChoa2dQcmljZSwgcHJlZmVyZWRRdHlTb2xkLCB0b3RhbFN1cHBseSwgcXR5VG9FbWl0KTsKICAgIH0KCiAgICAKICAgIAogICAgCiAgICAvKioKICAgICAqIAogICAgICogYnV5Rm9ySGFja2VyR29sZCAtIG9uIHRoZSBoYWNrIGV2ZW50IHRoaXMgZnVuY3Rpb24gaXMgYXZhaWxhYmxlIAogICAgICogICAgICAgICAgICAgICAgICAgIHRoZSBidXllciBmb3IgaGFja2VyIGdvbGQgd2lsbCBnYWluIHZvdGVzIHRvIAogICAgICogICAgICAgICAgICAgICAgICAgIGluZmx1ZW5jZSBmdXR1cmUgcHJvcG9zYWxzIG9uIHRoZSBEU1QKICAgICAqICAgIAogICAgICogIEBwYXJhbSBoa2dWYWx1ZSAtIHF0eSBvZiB0aGlzIERTVCB0b2tlbnMgZm9yIDEgSEtHICAgICAKICAgICAqIAogICAgICovCiAgICBmdW5jdGlvbiBidXlGb3JIYWNrZXJHb2xkKHVpbnQgaGtnVmFsdWUpIG9ubHlCZWZvcmVFbmQgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgCiAgICAgIC8vIHZhbGlkYXRlIHRoYXQgdGhlIGNhbGxlciBpcyBvZmZpY2lhbCBhY2NlbGVyYXRvciBIS0cgRXhjaGFuZ2UKICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gdmlydHVhbEV4Y2hhbmdlQWRkcmVzcykgdGhyb3c7CiAgICAgIAogICAgICAKICAgICAgLy8gdHJhbnNmZXIgdG9rZW4gCiAgICAgIGFkZHJlc3Mgc2VuZGVyID0gdHgub3JpZ2luOwogICAgICB1aW50IHRva2Vuc1F0eSA9IGhrZ1ZhbHVlICogaGtnUHJpY2U7CgogICAgICAvLyBnYWluIHZvdGluZyByaWdodHMKICAgICAgdm90aW5nUmlnaHRzW3NlbmRlcl0gKz10b2tlbnNRdHk7CiAgICAgIHByZWZlcmVkUXR5U29sZCArPSB0b2tlbnNRdHk7CiAgICAgIGNvbGxlY3RlZEhLRyArPSBoa2dWYWx1ZTsKCiAgICAgIC8vIGRvIGFjdHVhbCB0cmFuc2ZlcgogICAgICB0cmFuc2ZlckZyb20odGhpcywgCiAgICAgICAgICAgICAgICAgICB2aXJ0dWFsRXhjaGFuZ2VBZGRyZXNzLCB0b2tlbnNRdHkpOwogICAgICB0cmFuc2ZlcihzZW5kZXIsIHRva2Vuc1F0eSk7ICAgICAgICAKICAgICAgICAgICAgCiAgICAgIC8vIHJpc2UgZXZlbnQgICAgICAgCiAgICAgIEJ1eUZvckhLR1RyYW5zYWN0aW9uKHNlbmRlciwgcHJlZmVyZWRRdHlTb2xkLCB0b3RhbFN1cHBseSwgaGtnUHJpY2UsIHRva2Vuc1F0eSk7CiAgICAgICAgCiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgICAgIAogICAgCiAgICAvKioKICAgICAqIAogICAgICogaXNzdWVUb2tlbnMgLSBmdW5jdGlvbiB3aWxsIGlzc3VlIHRva2VucyBhZnRlciB0aGUgCiAgICAgKiAgICAgICAgICAgICAgIGV2ZW50LCBhYmxlIHRvIHNlbGwgZm9yIDEgZXRoZXIgCiAgICAgKiAKICAgICAqICBAcGFyYW0gcXR5Rm9yT25lRXRoZXIgdWludDogRFNUIHRva2VucyBmb3IgMSBFVEgKICAgICAqICBAcGFyYW0gcXR5VG9FbWl0IHVpbnQ6IG5ldyB0b2tlbnMgc3VwcGx5CiAgICAgKgogICAgICovCiAgICBmdW5jdGlvbiBpc3N1ZVRva2Vucyh1aW50IHF0eUZvck9uZUV0aGVyLCAKICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQgcXR5VG9FbWl0KSBvbmx5QWZ0ZXJFbmQgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25seUV4ZWN1dGl2ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ubHlJZkFibGVUb0lzc3VlVG9rZW5zIHsKICAgICAgICAgCiAgICAgICAgIGJhbGFuY2VzW3RoaXNdICs9IHF0eVRvRW1pdDsKICAgICAgICAgZXRoZXJQcmljZSA9IHF0eUZvck9uZUV0aGVyOwogICAgICAgICB0b3RhbFN1cHBseSAgICArPSBxdHlUb0VtaXQ7CiAgICAgICAgIAogICAgICAgICAvLyByaXNlIGV2ZW50ICAKICAgICAgICAgRHN0VG9rZW5zSXNzdWVkKHF0eUZvck9uZUV0aGVyLCB0b3RhbFN1cHBseSwgdG90YWxTdXBwbHksIHF0eVRvRW1pdCk7CiAgICB9CiAgICAgCiAgICAKICAgIC8qKgogICAgICogc2V0RXRoZXJQcmljZSAtIGNoYW5nZSB0aGUgdG9rZW4gcHJpY2UKICAgICAqCiAgICAgKiAgQHBhcmFtIHF0eUZvck9uZUV0aGVyIHVpbnQ6IG5ldyBwcmljZSAtIERTVCB0b2tlbnMgZm9yIDEgRVRICiAgICAgKi8gICAgIAogICAgZnVuY3Rpb24gc2V0RXRoZXJQcmljZSh1aW50IHF0eUZvck9uZUV0aGVyKSBvbmx5QWZ0ZXJFbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25seUV4ZWN1dGl2ZSB7CiAgICAgICAgIGV0aGVyUHJpY2UgPSBxdHlGb3JPbmVFdGhlcjsgCgogICAgICAgICAvLyByaXNlIGV2ZW50IGZvciB0aGlzCiAgICAgICAgIE5ld0V0aGVyUHJpY2UocXR5Rm9yT25lRXRoZXIpOwogICAgfSAgICAKICAgIAoKICAgIC8qKgogICAgICogIGRpc2FibGVUb2tlbklzc3VhbmNlIC0gZnVuY3Rpb24gd2lsbCBkaXNhYmxlIGFueSAKICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbiBmb3IgZnV0dXJlIHRva2VuIAogICAgICogICAgICAgICAgICAgICAgICAgICAgICAgaXNzdWVuY2UKICAgICAqLwogICAgZnVuY3Rpb24gZGlzYWJsZVRva2VuSXNzdWFuY2UoKSBvbmx5RXhlY3V0aXZlIHsKICAgICAgICBhYmxlVG9Jc3N1ZVRva2VucyA9IGZhbHNlOwogICAgICAgIAogICAgICAgIERpc2FibGVUb2tlbklzc3VhbmNlKCk7CiAgICB9CgogICAgCiAgICAvKioKICAgICAqICBidXJuUmVtYWluVG9rZW4gLSAgZWxpbWluYXRlZCBhbGwgYXZhaWxhYmxlIGZvciBzYWxlCiAgICAgKiAgICAgICAgICAgICAgICAgICAgIHRva2Vucy4gCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJ1cm5SZW1haW5Ub2tlbigpIG9ubHlFeGVjdXRpdmUgewogICAgCiAgICAgICAgdG90YWxTdXBwbHkgLT0gYmFsYW5jZXNbdGhpc107CiAgICAgICAgYmFsYW5jZXNbdGhpc10gPSAwOwogICAgICAgIAogICAgICAgIC8vIHJpc2UgZXZlbnQgZm9yIHRoaXMKICAgICAgICBCdXJuZWRBbGxSZW1haW5lZFRva2VucygpOwogICAgfQogICAgCiAgICAvKioKICAgICAqICBzdWJtaXRFdGhlclByb3Bvc2FsOiBzdWJtaXQgcHJvcG9zYWwgdG8gdXNlIHBhcnQgb2YgdGhlIAogICAgICogICAgICAgICAgICAgICAgICAgICAgIGNvbGxlY3RlZCBldGhlciBmdW5kcwogICAgICoKICAgICAqICAgQHBhcmFtIHJlcXVlc3RWYWx1ZSB1aW50OiB2YWx1ZSBpbiB3ZWkgCiAgICAgKiAgIEBwYXJhbSB1cmwgc3RyaW5nOiBkZXRhaWxzIG9mIHRoZSBwcm9wb3NhbCAKICAgICAqLyAKICAgIGZ1bmN0aW9uIHN1Ym1pdEV0aGVyUHJvcG9zYWwodWludCByZXF1ZXN0VmFsdWUsIHN0cmluZyB1cmwpIG9ubHlBZnRlckVuZCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ubHlFeGVjdXRpdmUgcmV0dXJucyAoYnl0ZXMzMiByZXN1bHRJZCwgYm9vbCByZXN1bHRTdWNjZXMpIHsgICAgICAgCiAgICAKICAgICAgICAvLyBlbnN1cmUgdGhlcmUgaXMgbm8gbW9yZSBpc3N1ZW5jZSBhdmFpbGFibGUgCiAgICAgICAgaWYgKGFibGVUb0lzc3VlVG9rZW5zKSB0aHJvdzsKICAgICAgICAgICAgCiAgICAgICAgLy8gZW5zdXJlIHRoZXJlIGlzIG5vIG1vcmUgdG9rZW5zIGF2YWlsYWJsZSAKICAgICAgICBpZiAoYmFsYW5jZU9mKHRoaXMpID4gMCkgdGhyb3c7CgogICAgICAgIC8vIFBvc3NpYmxlIHRvIHN1Ym1pdCBhIHByb3Bvc2FsIG9uY2UgMiB3ZWVrcyAKICAgICAgICBpZiAobm93IDwgKHRpbWVPZkxhc3RQcm9wb3NhbCArIDIgd2Vla3MpKSB0aHJvdzsKICAgICAgICAgICAgCiAgICAgICAgdWludCBwZXJjZW50ID0gY29sbGVjdGVkRXRoZXIgLyAxMDA7CiAgICAgICAgICAgIAogICAgICAgIGlmIChyZXF1ZXN0VmFsdWUgPiBQUk9QT1NBTF9GVU5EU19USCAqIHBlcmNlbnQpIHRocm93OwoKICAgICAgICAvLyBpZiByZW1haW5lZCB2YWx1ZSBpcyBsZXNzIHRoYW4gcmVxdWVzdGVkIGdhaW4gYWxsLgogICAgICAgIGlmIChyZXF1ZXN0VmFsdWUgPiB0aGlzLmJhbGFuY2UpIAogICAgICAgICAgICByZXF1ZXN0VmFsdWUgPSB0aGlzLmJhbGFuY2U7ICAgIAogICAgICAgICAgICAKICAgICAgICAvLyBzZXQgaWQgb2YgdGhlIHByb3Bvc2FsCiAgICAgICAgLy8gc3VibWl0IHByb3Bvc2FsIHRvIHRoZSBtYXAKICAgICAgICBieXRlczMyIGlkID0gc2hhMyhtc2cuZGF0YSwgbm93KTsKICAgICAgICB1aW50IHRpbWVFbmRzID0gbm93ICsgUFJPUE9TQUxfTElGRVRJTUU7IAogICAgICAgICAgICAKICAgICAgICBQcm9wb3NhbCBtZW1vcnkgbmV3UHJvcG9zYWwgPSBQcm9wb3NhbChpZCwgcmVxdWVzdFZhbHVlLCB1cmwsIHRpbWVFbmRzLCAwLCBtc2cuc2VuZGVyLCBmYWxzZSwgUHJvcG9zYWxDdXJyZW5jeS5FVEhFUik7CiAgICAgICAgcHJvcG9zYWxzW2lkXSA9IG5ld1Byb3Bvc2FsOwogICAgICAgIGxpc3RQcm9wb3NhbHMucHVzaChuZXdQcm9wb3NhbCk7CiAgICAgICAgICAgIAogICAgICAgIHRpbWVPZkxhc3RQcm9wb3NhbCA9IG5vdzsgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICBQcm9wb3NhbFJlcXVlc3RTdWJtaXR0ZWQoaWQsIHJlcXVlc3RWYWx1ZSwgdGltZUVuZHMsIHVybCwgbXNnLnNlbmRlcik7CiAgICAgICAgCiAgICAgICAgcmV0dXJuIChpZCwgdHJ1ZSk7CiAgICB9CiAgICAKICAgIAogICAgIAogICAgLyoqCiAgICAgKiAKICAgICAqIHN1Ym1pdEhLR1Byb3Bvc2FsIC0gc3VibWl0IHByb3Bvc2FsIHRvIHJlcXVlc3QgZm9yIAogICAgICogICAgICAgICAgICAgICAgICAgICBwYXJ0aWFsIEhLRyBmdW5kcyBjb2xsZWN0ZWQgCiAgICAgKiAKICAgICAqICBAcGFyYW0gcmVxdWVzdFZhbHVlIHVpbnQ6IHZhbHVlIGluIEhLRyB0byByZXF1ZXN0LiAKICAgICAqICBAcGFyYW0gdXJsIHN0cmluZzogdXJsIHdpdGggZGV0YWlscyBvbiB0aGUgcHJvcG9zaXRpb24gCiAgICAgKi8KICAgIGZ1bmN0aW9uIHN1Ym1pdEhLR1Byb3Bvc2FsKHVpbnQgcmVxdWVzdFZhbHVlLCBzdHJpbmcgdXJsKSBvbmx5QWZ0ZXJFbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbmx5RXhlY3V0aXZlIHJldHVybnMgKGJ5dGVzMzIgcmVzdWx0SWQsIGJvb2wgcmVzdWx0U3VjY2VzKXsKICAgICAgICAKCiAgICAgICAgLy8gSWYgdGhlcmUgaXMgbm8gMiBtb250aHMgb3ZlciBzaW5jZSB0aGUgbGFzdCBldmVudC4KICAgICAgICAvLyBUaGVyZSBpcyBubyBwb3NpYmxlIHRvIGdldCBhbnkgSEtHLiBBZnRlciAyIG1vbnRocwogICAgICAgIC8vIGFsbCB0aGUgSEtHIGlzIGF2YWlsYWJsZS4gCiAgICAgICAgaWYgKG5vdyA8IChldmVudEluZm8uZ2V0RXZlbnRFbmQoKSArIDggd2Vla3MpKSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KCiAgICAgICAgLy8gUG9zc2libGUgdG8gc3VibWl0IGEgcHJvcG9zYWwgb25jZSAyIHdlZWtzIAogICAgICAgIGlmIChub3cgPCAodGltZU9mTGFzdFByb3Bvc2FsICsgMiB3ZWVrcykpIHRocm93OwoKICAgICAgICB1aW50IHBlcmNlbnQgPSBwcmVmZXJlZFF0eVNvbGQgLyAxMDA7CiAgICAgICAgCiAgICAgICAgLy8gdmFsaWRhdGUgdGhlIGFtb3VudCBpcyBsZWdpdAogICAgICAgIC8vIGZpcnN0IDUgcHJvcG9zYWxzIHNob3VsZCBiZSBsZXNzIHRoYW4gMjAlIAogICAgICAgIGlmIChjb3VudGVyUHJvcG9zYWxzIDw9IDUgJiYgCiAgICAgICAgICAgIHJlcXVlc3RWYWx1ZSAgICAgPiAgUFJPUE9TQUxfRlVORFNfVEggKiBwZXJjZW50KSB0aHJvdzsKICAgICAgICAgICAgICAgIAogICAgICAgIC8vIGlmIHJlbWFpbmVkIHZhbHVlIGlzIGxlc3MgdGhhbiByZXF1ZXN0ZWQgCiAgICAgICAgLy8gZ2FpbiBhbGwuCiAgICAgICAgaWYgKHJlcXVlc3RWYWx1ZSA+IGdldEhLR093bmVkKCkpIAogICAgICAgICAgICByZXF1ZXN0VmFsdWUgPSBnZXRIS0dPd25lZCgpOwogICAgICAgIAogICAgICAgIAogICAgICAgIC8vIHNldCBpZCBvZiB0aGUgcHJvcG9zYWwKICAgICAgICAvLyBzdWJtaXQgcHJvcG9zYWwgdG8gdGhlIG1hcAogICAgICAgIGJ5dGVzMzIgaWQgPSBzaGEzKG1zZy5kYXRhLCBub3cpOwogICAgICAgIHVpbnQgdGltZUVuZHMgPSBub3cgKyBQUk9QT1NBTF9MSUZFVElNRTsgCiAgICAgICAgCiAgICAgICAgUHJvcG9zYWwgbWVtb3J5IG5ld1Byb3Bvc2FsID0gUHJvcG9zYWwoaWQsIHJlcXVlc3RWYWx1ZSwgdXJsLCB0aW1lRW5kcywgMCwgbXNnLnNlbmRlciwgZmFsc2UsIFByb3Bvc2FsQ3VycmVuY3kuSEtHKTsKICAgICAgICBwcm9wb3NhbHNbaWRdID0gbmV3UHJvcG9zYWw7CiAgICAgICAgbGlzdFByb3Bvc2Fscy5wdXNoKG5ld1Byb3Bvc2FsKTsKICAgICAgICAKICAgICAgICArK2NvdW50ZXJQcm9wb3NhbHM7CiAgICAgICAgdGltZU9mTGFzdFByb3Bvc2FsID0gbm93OyAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIAogICAgICAgIFByb3Bvc2FsUmVxdWVzdFN1Ym1pdHRlZChpZCwgcmVxdWVzdFZhbHVlLCB0aW1lRW5kcywgdXJsLCBtc2cuc2VuZGVyKTsKICAgICAgICAKICAgICAgICByZXR1cm4gKGlkLCB0cnVlKTsgICAgICAgIAogICAgfSAgCiAgICAKICAgIAogICAgCiAgICAvKioKICAgICAqIG9iamVjdFByb3Bvc2FsIC0gb2JqZWN0IHByZXZpb3VzbHkgc3VibWl0dGVkIHByb3Bvc2FsLCAKICAgICAqICAgICAgICAgICAgICAgICAgdGhlIG9iamVjdGlvbiByaWdodCBpcyBvYnRhaW5lZCBieSAKICAgICAqICAgICAgICAgICAgICAgICAgcHVyY2hhc2luZyBwcmVmZXJlZCB0b2tlbnMgb24gdGltZSBvZiAKICAgICAqICAgICAgICAgICAgICAgICAgdGhlIGhhY2thdGhvbi4KICAgICAqIAogICAgICogIEBwYXJhbSBpZCBieXRlczMyIDogdGhlIGlkIG9mIHRoZSBwcm9wb3NsYSB0byByZWRlZW0KICAgICAqLwogICAgIGZ1bmN0aW9uIG9iamVjdFByb3Bvc2FsKGJ5dGVzMzIgaWQpewogICAgICAgICAKICAgICAgICBQcm9wb3NhbCBtZW1vcnkgcHJvcG9zYWwgPSBwcm9wb3NhbHNbaWRdOwogICAgICAgICAKICAgICAgICAvLyBjaGVjayBwcm9wb3NhbCBleGlzdCAKICAgICAgICBpZiAocHJvcG9zYWxzW2lkXS5pZCA9PSAwKSB0aHJvdzsKCiAgICAgICAgLy8gY2hlY2sgYWxyZWFkeSByZWRlZW1lZAogICAgICAgIGlmIChwcm9wb3NhbHNbaWRdLnJlZGVlbWVkKSB0aHJvdzsKICAgICAgICAgCiAgICAgICAgLy8gZW5zdXJlIG9iamVjdGlvbiB0aW1lCiAgICAgICAgaWYgKG5vdyA+PSBwcm9wb3NhbHNbaWRdLnZvdGluZEVuZFRTKSB0aHJvdzsKICAgICAgICAgCiAgICAgICAgLy8gZW5zdXJlIG5vdCB2b3RlZCAgCiAgICAgICAgaWYgKHByb3Bvc2Fsc1tpZF0udm90ZWRbbXNnLnNlbmRlcl0pIHRocm93OwogICAgICAgICAKICAgICAgICAgLy8gc3VibWl0IHZvdGVzCiAgICAgICAgIHVpbnQgdm90ZXMgPSB2b3RpbmdSaWdodHNbbXNnLnNlbmRlcl07CiAgICAgICAgIHByb3Bvc2Fsc1tpZF0udm90ZXNPYmplY3RpbmcgKz0gdm90ZXM7CiAgICAgICAgIAogICAgICAgICAvLyBtYXJrIHZvdGVkIAogICAgICAgICBwcm9wb3NhbHNbaWRdLnZvdGVkW21zZy5zZW5kZXJdID0gdHJ1ZTsgCiAgICAgICAgIAogICAgICAgICB1aW50IGlkeCA9IGdldEluZGV4QnlQcm9wb3NhbElkKGlkKTsKICAgICAgICAgbGlzdFByb3Bvc2Fsc1tpZHhdID0gcHJvcG9zYWxzW2lkXTsgICAKCiAgICAgICAgIE9iamVjdGVkVm90ZShpZCwgbXNnLnNlbmRlciwgdm90ZXMpOyAgICAgICAgIAogICAgIH0KICAgICAKICAgICAKICAgICBmdW5jdGlvbiBnZXRJbmRleEJ5UHJvcG9zYWxJZChieXRlczMyIGlkKSByZXR1cm5zICh1aW50IHJlc3VsdCl7CiAgICAgICAgIAogICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBsaXN0UHJvcG9zYWxzLmxlbmd0aDsgKytpKXsKICAgICAgICAgICAgIGlmIChpZCA9PSBsaXN0UHJvcG9zYWxzW2ldLmlkKSByZXR1cm4gaTsKICAgICAgICAgfQogICAgIH0KICAgIAogICAgCiAgIAogICAgLyoqCiAgICAgKiByZWRlZW1Qcm9wb3NhbEZ1bmRzIC0gcmVkZWVtIGZ1bmRzIHJlcXVlc3RlZCBieSBwcmlvciAKICAgICAqICAgICAgICAgICAgICAgICAgICAgICBzdWJtaXR0ZWQgcHJvcG9zYWwgICAgIAogICAgICogCiAgICAgKiBAcGFyYW0gaWQgYnl0ZXMzMjogdGhlIGlkIG9mIHRoZSBwcm9wb3NhbCB0byByZWRlZW0KICAgICAqLwogICAgZnVuY3Rpb24gcmVkZWVtUHJvcG9zYWxGdW5kcyhieXRlczMyIGlkKSBvbmx5RXhlY3V0aXZlIHsKCiAgICAgICAgaWYgKHByb3Bvc2Fsc1tpZF0uaWQgPT0gMCkgdGhyb3c7CiAgICAgICAgaWYgKHByb3Bvc2Fsc1tpZF0uc3VibWl0dGVyICE9IG1zZy5zZW5kZXIpIHRocm93OwoKICAgICAgICAvLyBlbnN1cmUgb2JqZWN0aW9uIHRpbWUKICAgICAgICBpZiAobm93IDwgcHJvcG9zYWxzW2lkXS52b3RpbmRFbmRUUykgdGhyb3c7CiAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIC8vIGNoZWNrIGFscmVhZHkgcmVkZWVtZWQKICAgICAgICBpZiAocHJvcG9zYWxzW2lkXS5yZWRlZW1lZCkgdGhyb3c7CgogICAgICAgIC8vIGNoZWNrIHZvdGVzIG9iamVjdGlvbiA9PiA1NSUgb2YgdG90YWwgdm90ZXMKICAgICAgICB1aW50IG9iamVjdGlvblRocmVzaG9sZCA9IHByZWZlcmVkUXR5U29sZCAvIDEwMCAqIDU1OwogICAgICAgIGlmIChwcm9wb3NhbHNbaWRdLnZvdGVzT2JqZWN0aW5nICA+IG9iamVjdGlvblRocmVzaG9sZCkgdGhyb3c7CiAgICAKICAgIAogICAgICAgIGlmIChwcm9wb3NhbHNbaWRdLnByb3Bvc2FsQ3VycmVuY3kgPT0gUHJvcG9zYWxDdXJyZW5jeS5IS0cpewogICAgICAgICAgICAKICAgICAgICAgICAgLy8gc2VuZCBoYWNrZXIgZ29sZCAKICAgICAgICAgICAgaGFja2VyR29sZC50cmFuc2Zlcihwcm9wb3NhbHNbaWRdLnN1Ym1pdHRlciwgcHJvcG9zYWxzW2lkXS52YWx1ZSk7ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgIC8vIHNlbmQgZXRoZXIgICAgICAgICAgICAgIAogICAgICAgICAgIGJvb2wgc3VjY2VzcyA9IHByb3Bvc2Fsc1tpZF0uc3VibWl0dGVyLnNlbmQocHJvcG9zYWxzW2lkXS52YWx1ZSk7IAoKICAgICAgICAgICAvLyByaXNlIGV2ZW50CiAgICAgICAgICAgRXRoZXJSZWRlZW1BY2NlcHRlZChwcm9wb3NhbHNbaWRdLnN1Ym1pdHRlciwgcHJvcG9zYWxzW2lkXS52YWx1ZSk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIGV4ZWN1dGUgdGhlIHByb3Bvc2FsIAogICAgICAgIHByb3Bvc2Fsc1tpZF0ucmVkZWVtZWQgPSB0cnVlOyAKICAgIH0KICAgIAogICAgCiAgICAvKioKICAgICAqICBnZXRBbGxUaGVGdW5kcyAtIHRvIGVuc3VyZSB0aGVyZSBpcyBubyBkZWFkbG9jayBjYW4gCiAgICAgKiAgICAgICAgICAgICAgICAgICBjYW4gaGFwcGVuLCBhbmQgbm8gY2FzZSB0aGF0IHZvdGluZyAKICAgICAqICAgICAgICAgICAgICAgICAgIHN0cnVjdHVyZSB3aWxsIGZyZWV6ZSB0aGUgZnVuZHMgZm9yZXZlcgogICAgICogICAgICAgICAgICAgICAgICAgdGhlIHN0YXJ0dXAgd2lsbCBiZSBhYmxlIHRvIGdldCBhbGwgdGhlCiAgICAgKiAgICAgICAgICAgICAgICAgICBmdW5kcyB3aXRob3V0IGEgcHJvcG9zYWwgcmVxdWlyZWQgYWZ0ZXIKICAgICAqICAgICAgICAgICAgICAgICAgIDYgbW9udGhzLgogICAgICogCiAgICAgKiAKICAgICAqLyAgICAgICAgICAgICAKICAgIGZ1bmN0aW9uIGdldEFsbFRoZUZ1bmRzKCkgb25seUV4ZWN1dGl2ZSB7CiAgICAgICAgCiAgICAgICAgLy8gSWYgdGhlcmUgaXMgYSBkZWFkbG9jayBpbiB2b3RpbmcgcGFydGljaXBhdGVzCiAgICAgICAgLy8gdGhlIGZ1bmRzIGNhbiBiZSByZWRlZW1lZCBjb21wbGV0ZWxseSBpbiA2IG1vbnRocwogICAgICAgIGlmIChub3cgPCAoZXZlbnRJbmZvLmdldEV2ZW50RW5kKCkgKyAyNCB3ZWVrcykpIHsKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgfSAgCiAgICAgICAgCiAgICAgICAgLy8gYWxsIHRoZSBFdGhlcgogICAgICAgIGJvb2wgc3VjY2VzcyA9IG1zZy5zZW5kZXIuc2VuZCh0aGlzLmJhbGFuY2UpOyAgICAgICAgCiAgICAgICAgCiAgICAgICAgLy8gYWxsIHRoZSBIS0cKICAgICAgICBoYWNrZXJHb2xkLnRyYW5zZmVyKG1zZy5zZW5kZXIsIGdldEhLR093bmVkKCkpOyAgICAgICAgICAgICAgCiAgICB9CiAgICAKICAgIAogICAgLyoqCiAgICAgKiBzdWJtaXRJbXBlYWNobWVudFByb3Bvc2FsIC0gc3VibWl0IHJlcXVlc3QgdG8gc3dpdGNoIAogICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4ZWN1dGl2ZS4KICAgICAqIAogICAgICogIEBwYXJhbSB1cmxEZXRhaWxzICAtIGRldGFpbHMgb2YgdGhlIGltcGVhY2htZW50IHByb3Bvc2FsIAogICAgICogIEBwYXJhbSBuZXdFeGVjdXRpdmUgLSBhZGRyZXNzIG9mIHRoZSBuZXcgZXhlY3V0aXZlIAogICAgICogCiAgICAgKi8gICAgICAgICAgICAgCiAgICAgZnVuY3Rpb24gc3VibWl0SW1wZWFjaG1lbnRQcm9wb3NhbChzdHJpbmcgdXJsRGV0YWlscywgYWRkcmVzcyBuZXdFeGVjdXRpdmUpewogICAgICAgICAKICAgICAgICAvLyB0byBvZmZlciBpbXBlYWNobWVudCB5b3Ugc2hvdWxkIGhhdmUgCiAgICAgICAgLy8gdm90aW5nIHJpZ2h0cwogICAgICAgIGlmICh2b3RpbmdSaWdodHNbbXNnLnNlbmRlcl0gPT0gMCkgdGhyb3c7CiAgICAgICAgIAogICAgICAgIC8vIHRoZSBzdWJtaXNzaW9uIG9mIHRoZSBmaXJzdCBpbXBlYWNobWVudCAKICAgICAgICAvLyBwcm9wb3NhbCBpcyBwb3NzaWJsZSBvbmx5IGFmdGVyIDMgbW9udGhzCiAgICAgICAgLy8gc2luY2UgdGhlIGhhY2thdGhvbiBpcyBvdmVyCiAgICAgICAgaWYgKG5vdyA8IChldmVudEluZm8uZ2V0RXZlbnRFbmQoKSArIDEyIHdlZWtzKSkgdGhyb3c7CiAgICAgICAgCiAgICAgICAgICAgICAgICAKICAgICAgICAvLyBjaGVjayB0aGVyZSBpcyAxIG1vbnRocyBvdmVyIHNpbmNlIGxhc3Qgb25lCiAgICAgICAgaWYgKGxhc3RJbXBlYWNobWVudFByb3Bvc2FsLnZvdGluZEVuZFRTICE9IDAgJiYgCiAgICAgICAgICAgIGxhc3RJbXBlYWNobWVudFByb3Bvc2FsLnZvdGluZEVuZFRTICsgIDIgd2Vla3MgPiBub3cpIHRocm93OwoKCiAgICAgICAgLy8gc3VibWl0IGltcGVhY2htZW50IHByb3Bvc2FsCiAgICAgICAgLy8gYWRkIHRoZSB2b3RlcyBvZiB0aGUgc3VibWl0dGVyIAogICAgICAgIC8vIHRvIHRoZSBwcm9wb3NhbCByaWdodCBhd2F5CiAgICAgICAgbGFzdEltcGVhY2htZW50UHJvcG9zYWwgPSBJbXBlYWNobWVudFByb3Bvc2FsKHVybERldGFpbHMsIG5ld0V4ZWN1dGl2ZSwgbm93ICsgMiB3ZWVrcywgdm90aW5nUmlnaHRzW21zZy5zZW5kZXJdKTsKICAgICAgICBsYXN0SW1wZWFjaG1lbnRQcm9wb3NhbC52b3RlZFttc2cuc2VuZGVyXSA9IHRydWU7CiAgICAgICAgIAogICAgICAgIC8vIHJpc2UgZXZlbnQKICAgICAgICBJbXBlYWNobWVudFByb3Bvc2VkKG1zZy5zZW5kZXIsIHVybERldGFpbHMsIG5vdyArIDIgd2Vla3MsIG5ld0V4ZWN1dGl2ZSk7CiAgICAgfQogICAgCiAgICAKICAgIC8qKgogICAgICogc3VwcG9ydEltcGVhY2htZW50IC0gdm90ZSBmb3IgaW1wZWFjaG1lbnQgcHJvcG9zYWwgCiAgICAgKiAgICAgICAgICAgICAgICAgICAgICB0aGF0IGlzIGN1cnJlbnRseSBpbiBwcm9ncmVzcwogICAgICoKICAgICAqLwogICAgZnVuY3Rpb24gc3VwcG9ydEltcGVhY2htZW50KCl7CgogICAgICAgIC8vIGVuc3VyZSB0aGF0IHN1cHBvcnQgaXMgZm9yIGV4aXN0IHByb3Bvc2FsIAogICAgICAgIGlmIChsYXN0SW1wZWFjaG1lbnRQcm9wb3NhbC5uZXdFeGVjdXRpdmUgPT0gMHgwKSB0aHJvdzsKICAgIAogICAgICAgIC8vIHRvIG9mZmVyIGltcGVhY2htZW50IHlvdSBzaG91bGQgaGF2ZSAKICAgICAgICAvLyB2b3RpbmcgcmlnaHRzCiAgICAgICAgaWYgKHZvdGluZ1JpZ2h0c1ttc2cuc2VuZGVyXSA9PSAwKSB0aHJvdzsKICAgICAgICAKICAgICAgICAvLyBjaGVjayBpZiBub3Qgdm90ZWQgYWxyZWFkeSAKICAgICAgICBpZiAobGFzdEltcGVhY2htZW50UHJvcG9zYWwudm90ZWRbbXNnLnNlbmRlcl0pIHRocm93OwogICAgICAgIAogICAgICAgIC8vIGNoZWNrIGlmIG5vdCBmaW5pc2hlZCB0aGUgMiB3ZWVrcyBvZiB2b3RpbmcgCiAgICAgICAgaWYgKGxhc3RJbXBlYWNobWVudFByb3Bvc2FsLnZvdGluZEVuZFRTICsgMiB3ZWVrcyA8PSBub3cpIHRocm93OwogICAgICAgICAgICAgICAgCiAgICAgICAgLy8gc3VwcG9ydCB0aGUgaW1wZWFjaG1lbnQKICAgICAgICBsYXN0SW1wZWFjaG1lbnRQcm9wb3NhbC52b3RlZFttc2cuc2VuZGVyXSA9IHRydWU7CiAgICAgICAgbGFzdEltcGVhY2htZW50UHJvcG9zYWwudm90ZXNTdXBwb3J0aW5nICs9IHZvdGluZ1JpZ2h0c1ttc2cuc2VuZGVyXTsKCiAgICAgICAgLy8gcmlzZSBpbXBlYWNobWVudCBzdXBwcG9ydGluZyBldmVudAogICAgICAgIEltcGVhY2htZW50U3VwcG9ydChtc2cuc2VuZGVyLCB2b3RpbmdSaWdodHNbbXNnLnNlbmRlcl0pOwogICAgICAgIAogICAgICAgIC8vIGlmIHRoZSB2b3RlIGlzIG92ZXIgNzAlIGV4ZWN1dGUgdGhlIHN3aXRjaCAKICAgICAgICB1aW50IHBlcmNlbnQgPSBwcmVmZXJlZFF0eVNvbGQgLyAxMDA7IAogICAgICAgIAogICAgICAgIGlmIChsYXN0SW1wZWFjaG1lbnRQcm9wb3NhbC52b3Rlc1N1cHBvcnRpbmcgPj0gNzAgKiBwZXJjZW50KXsKICAgICAgICAgICAgZXhlY3V0aXZlID0gbGFzdEltcGVhY2htZW50UHJvcG9zYWwubmV3RXhlY3V0aXZlOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gaW1wZWFjaG1lbnQgZXZlbnQKICAgICAgICAgICAgSW1wZWFjaG1lbnRBY2NlcHRlZChleGVjdXRpdmUpOwogICAgICAgIH0KICAgICAgICAKICAgIH0gCiAgICAKICAgICAgCiAgICAKICAgIC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKiogLy8KICAgIC8vICogICAgIENvbnN0YW50IEdldHRlcnMgICAgICogLy8KICAgIC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKiogLy8KICAgIAogICAgZnVuY3Rpb24gdm90aW5nUmlnaHRzT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVzdWx0KSB7CiAgICAgICAgcmVzdWx0ID0gdm90aW5nUmlnaHRzW19vd25lcl07CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldFByZWZlcmVkUXR5U29sZCgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcmVzdWx0KXsKICAgICAgICByZXR1cm4gcHJlZmVyZWRRdHlTb2xkOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBzZXRWaXJ0dWFsRXhjaGFuZ2UoYWRkcmVzcyB2aXJ0dWFsRXhjaGFuZ2VBZGRyKXsKICAgICAgICBpZiAodmlydHVhbEV4Y2hhbmdlQWRkcmVzcyAhPSAweDApIHRocm93OwogICAgICAgIHZpcnR1YWxFeGNoYW5nZUFkZHJlc3MgPSB2aXJ0dWFsRXhjaGFuZ2VBZGRyOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEhLR093bmVkKCkgY29uc3RhbnQgcmV0dXJucyAodWludCByZXN1bHQpewogICAgICAgIHJldHVybiBoYWNrZXJHb2xkLmJhbGFuY2VPZih0aGlzKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0RXRoZXJWYWx1ZSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcmVzdWx0KXsKICAgICAgICByZXR1cm4gdGhpcy5iYWxhbmNlOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRFeGVjdXRpdmUoKSBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzIHJlc3VsdCl7CiAgICAgICAgcmV0dXJuIGV4ZWN1dGl2ZTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0SEtHUHJpY2UoKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlc3VsdCl7CiAgICAgICAgcmV0dXJuIGhrZ1ByaWNlOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEV0aGVyUHJpY2UoKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlc3VsdCl7CiAgICAgICAgcmV0dXJuIGV0aGVyUHJpY2U7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldERTVE5hbWUoKSBjb25zdGFudCByZXR1cm5zKHN0cmluZyByZXN1bHQpewogICAgICAgIHJldHVybiBuYW1lOwogICAgfSAgICAKICAgIAogICAgZnVuY3Rpb24gZ2V0RFNUTmFtZUJ5dGVzKCkgY29uc3RhbnQgcmV0dXJucyhieXRlczMyIHJlc3VsdCl7CiAgICAgICAgcmV0dXJuIGNvbnZlcnQobmFtZSk7CiAgICB9ICAgIAoKICAgIGZ1bmN0aW9uIGdldERTVFN5bWJvbCgpIGNvbnN0YW50IHJldHVybnMoc3RyaW5nIHJlc3VsdCl7CiAgICAgICAgcmV0dXJuIHN5bWJvbDsKICAgIH0gICAgCiAgICAKICAgIGZ1bmN0aW9uIGdldERTVFN5bWJvbEJ5dGVzKCkgY29uc3RhbnQgcmV0dXJucyhieXRlczMyIHJlc3VsdCl7CiAgICAgICAgcmV0dXJuIGNvbnZlcnQoc3ltYm9sKTsKICAgIH0gICAgCgogICAgZnVuY3Rpb24gZ2V0QWRkcmVzcygpIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MgcmVzdWx0KSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldFRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludCByZXN1bHQpIHsKICAgICAgICByZXR1cm4gdG90YWxTdXBwbHk7CiAgICB9IAogICAgICAgIAogICAgZnVuY3Rpb24gZ2V0Q29sbGVjdGVkRXRoZXIoKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlc3VsdHMpIHsgICAgICAgIAogICAgICAgIHJldHVybiBjb2xsZWN0ZWRFdGhlcjsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0Q291bnRlclByb3Bvc2FscygpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcmVzdWx0KXsKICAgICAgICByZXR1cm4gY291bnRlclByb3Bvc2FsczsKICAgIH0KICAgICAgICAKICAgIGZ1bmN0aW9uIGdldFByb3Bvc2FsSWRCeUluZGV4KHVpbnQgaSkgY29uc3RhbnQgcmV0dXJucyAoYnl0ZXMzMiByZXN1bHQpewogICAgICAgIHJldHVybiBsaXN0UHJvcG9zYWxzW2ldLmlkOwogICAgfSAgICAKCiAgICBmdW5jdGlvbiBnZXRQcm9wb3NhbE9iamVjdGlvbkJ5SW5kZXgodWludCBpKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlc3VsdCl7CiAgICAgICAgcmV0dXJuIGxpc3RQcm9wb3NhbHNbaV0udm90ZXNPYmplY3Rpbmc7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0UHJvcG9zYWxWYWx1ZUJ5SW5kZXgodWludCBpKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlc3VsdCl7CiAgICAgICAgcmV0dXJuIGxpc3RQcm9wb3NhbHNbaV0udmFsdWU7CiAgICB9ICAgICAgICAgICAgICAgICAgCiAgICAKICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRJbXBlYWNobWVudFVybERldGFpbHMoKSBjb25zdGFudCByZXR1cm5zIChzdHJpbmcgcmVzdWx0KXsKICAgICAgICByZXR1cm4gbGFzdEltcGVhY2htZW50UHJvcG9zYWwudXJsRGV0YWlsczsKICAgIH0KICAgIAogICAgCiAgICBmdW5jdGlvbiBnZXRDdXJyZW50SW1wZWFjaG1lbnRWb3Rlc1N1cHBvcnRpbmcoKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlc3VsdCl7CiAgICAgICAgcmV0dXJuIGxhc3RJbXBlYWNobWVudFByb3Bvc2FsLnZvdGVzU3VwcG9ydGluZzsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gY29udmVydChzdHJpbmcga2V5KSByZXR1cm5zIChieXRlczMyIHJldCkgewogICAgICAgICAgICBpZiAoYnl0ZXMoa2V5KS5sZW5ndGggPiAzMikgewogICAgICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICAgIH0gICAgICAKCiAgICAgICAgICAgIGFzc2VtYmx5IHsKICAgICAgICAgICAgICAgIHJldCA6PSBtbG9hZChhZGQoa2V5LCAzMikpCiAgICAgICAgICAgIH0KICAgIH0gICAgCiAgICAKICAgIAogICAgCiAgICAvLyAqKioqKioqKioqKioqKioqKioqKiogLy8KICAgIC8vICogICAgIE1vZGlmaWVycyAgICAgKiAvLwogICAgLy8gKioqKioqKioqKioqKioqKioqKioqIC8vICAgIAogCiAgICBtb2RpZmllciBvbmx5QmVmb3JlRW5kKCkgeyBpZiAobm93ICA+PSAgZXZlbnRJbmZvLmdldEV2ZW50RW5kKCkpIHRocm93OyBfOyB9CiAgICBtb2RpZmllciBvbmx5QWZ0ZXJFbmQoKSAgeyBpZiAobm93ICA8ICAgZXZlbnRJbmZvLmdldEV2ZW50RW5kKCkpIHRocm93OyBfOyB9CiAgICAKICAgIG1vZGlmaWVyIG9ubHlBZnRlclRyYWRpbmdTdGFydCgpICB7IGlmIChub3cgIDwgZXZlbnRJbmZvLmdldFRyYWRpbmdTdGFydCgpKSB0aHJvdzsgXzsgfQogICAgCiAgICBtb2RpZmllciBvbmx5RXhlY3V0aXZlKCkgICAgIHsgaWYgKG1zZy5zZW5kZXIgIT0gZXhlY3V0aXZlKSB0aHJvdzsgXzsgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgIG1vZGlmaWVyIG9ubHlJZkFibGVUb0lzc3VlVG9rZW5zKCkgIHsgaWYgKCFhYmxlVG9Jc3N1ZVRva2VucykgdGhyb3c7IF87IH0gCiAgICAKCiAgICAvLyAqKioqKioqKioqKioqKioqKiogLy8KICAgIC8vICogICAgIEV2ZW50cyAgICAgKiAvLwogICAgLy8gKioqKioqKioqKioqKioqKioqIC8vICAgICAgICAKCiAgICAKICAgIGV2ZW50IFByaWNlSEtHQ2hhbmdlKHVpbnQgaW5kZXhlZCBxdHlGb3JPbmVIS0csIHVpbnQgaW5kZXhlZCB0b2tlbnNTb2xkLCB1aW50IGluZGV4ZWQgdG90YWxTdXBwbHkpOwogICAgZXZlbnQgQnV5Rm9ySEtHVHJhbnNhY3Rpb24oYWRkcmVzcyBpbmRleGVkIGJ1eWVyLCB1aW50IGluZGV4ZWQgdG9rZW5zU29sZCwgdWludCBpbmRleGVkIHRvdGFsU3VwcGx5LCB1aW50IHF0eUZvck9uZUhLRywgdWludCB0b2tlbnNBbW91bnQpOwogICAgZXZlbnQgQnV5Rm9yRXRoZXJUcmFuc2FjdGlvbihhZGRyZXNzIGluZGV4ZWQgYnV5ZXIsIHVpbnQgaW5kZXhlZCB0b2tlbnNTb2xkLCB1aW50IGluZGV4ZWQgdG90YWxTdXBwbHksIHVpbnQgcXR5Rm9yT25lRXRoZXIsIHVpbnQgdG9rZW5zQW1vdW50KTsKCiAgICBldmVudCBEc3RUb2tlbnNJc3N1ZWQodWludCBpbmRleGVkIHF0eUZvck9uZUhLRywgdWludCBpbmRleGVkIHRva2Vuc1NvbGQsIHVpbnQgaW5kZXhlZCB0b3RhbFN1cHBseSwgdWludCBxdHlUb0VtaXQpOwogICAgCiAgICBldmVudCBQcm9wb3NhbFJlcXVlc3RTdWJtaXR0ZWQoYnl0ZXMzMiBpZCwgdWludCB2YWx1ZSwgdWludCB0aW1lRW5kcywgc3RyaW5nIHVybCwgYWRkcmVzcyBzZW5kZXIpOwogICAgCiAgICBldmVudCBFdGhlclJlZGVlbUFjY2VwdGVkKGFkZHJlc3Mgc2VuZGVyLCB1aW50IHZhbHVlKTsKICAgIAogICAgZXZlbnQgT2JqZWN0ZWRWb3RlKGJ5dGVzMzIgaWQsIGFkZHJlc3Mgdm90ZXIsIHVpbnQgdm90ZXMpOwogICAgCiAgICBldmVudCBJbXBlYWNobWVudFByb3Bvc2VkKGFkZHJlc3Mgc3VibWl0dGVyLCBzdHJpbmcgdXJsRGV0YWlscywgdWludCB2b3RpbmRFbmRUUywgYWRkcmVzcyBuZXdFeGVjdXRpdmUpOwogICAgZXZlbnQgSW1wZWFjaG1lbnRTdXBwb3J0KGFkZHJlc3Mgc3VwcG9ydHRlciwgdWludCB2b3Rlcyk7CiAgICAKICAgIGV2ZW50IEltcGVhY2htZW50QWNjZXB0ZWQoYWRkcmVzcyBuZXdFeGVjdXRpdmUpOwoKICAgIGV2ZW50IE5ld0V0aGVyUHJpY2UodWludCBuZXdRdHlGb3JPbmVFdGhlcik7CiAgICBldmVudCBEaXNhYmxlVG9rZW5Jc3N1YW5jZSgpOwogICAgCiAgICBldmVudCBCdXJuZWRBbGxSZW1haW5lZFRva2VucygpOwogICAgCn0KCgogCmNvbnRyYWN0IEV2ZW50SW5mb3sKICAgIAogICAgCiAgICB1aW50IGNvbnN0YW50IEhBQ0tBVEhPTl81X1dFRUtTID0gNjAgKiA2MCAqIDI0ICogNyAqIDU7CiAgICB1aW50IGNvbnN0YW50IFRfMV9XRUVLID0gNjAgKiA2MCAqIDI0ICogNzsKCiAgICB1aW50IGV2ZW50U3RhcnQgPSAxNDc5MzkxMjAwOyAvLyBUaHUsIDE3IE5vdiAyMDE2IDE0OjAwOjAwIEdNVAogICAgdWludCBldmVudEVuZCA9IGV2ZW50U3RhcnQgKyBIQUNLQVRIT05fNV9XRUVLUzsKICAgIAogICAgCiAgICAvKioKICAgICAqIGdldEV2ZW50U3RhcnQgLSByZXR1cm4gdGhlIHN0YXJ0IG9mIHRoZSBldmVudCB0aW1lCiAgICAgKi8gCiAgICBmdW5jdGlvbiBnZXRFdmVudFN0YXJ0KCkgY29uc3RhbnQgcmV0dXJucyAodWludCByZXN1bHQpeyAgICAgICAgCiAgICAgICByZXR1cm4gZXZlbnRTdGFydDsKICAgIH0gCiAgICAKICAgIC8qKgogICAgICogZ2V0RXZlbnRFbmQgLSByZXR1cm4gdGhlIGVuZCBvZiB0aGUgZXZlbnQgdGltZQogICAgICovIAogICAgZnVuY3Rpb24gZ2V0RXZlbnRFbmQoKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlc3VsdCl7ICAgICAgICAKICAgICAgIHJldHVybiBldmVudEVuZDsKICAgIH0gCiAgICAKICAgIAogICAgLyoqCiAgICAgKiBnZXRWb3RpbmdTdGFydCAtIHRoZSB2b3Rpbmcgc3RhcnRzIDEgd2VlayBhZnRlciB0aGUgCiAgICAgKiAgICAgICAgICAgICAgICAgIGV2ZW50IHN0YXJ0cwogICAgICovIAogICAgZnVuY3Rpb24gZ2V0Vm90aW5nU3RhcnQoKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlc3VsdCl7CiAgICAgICAgcmV0dXJuIGV2ZW50U3RhcnQrIFRfMV9XRUVLOwogICAgfQoKICAgIC8qKgogICAgICogZ2V0VHJhZGluZ1N0YXJ0IC0gdGhlIERTVCB0b2tlbnMgdHJhZGluZyBzdGFydHMgMSB3ZWVrIAogICAgICogICAgICAgICAgICAgICAgICAgYWZ0ZXIgdGhlIGV2ZW50IHN0YXJ0cwogICAgICovIAogICAgZnVuY3Rpb24gZ2V0VHJhZGluZ1N0YXJ0KCkgY29uc3RhbnQgcmV0dXJucyAodWludCByZXN1bHQpewogICAgICAgIHJldHVybiBldmVudFN0YXJ0KyBUXzFfV0VFSzsKICAgIH0KCiAgICAvKioKICAgICAqIGdldE5vdyAtIGhlbHBlciBjbGFzcyB0byBjaGVjayB3aGF0IHRpbWUgdGhlIGNvbnRyYWN0IHNlZQogICAgICovCiAgICBmdW5jdGlvbiBnZXROb3coKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlc3VsdCl7ICAgICAgICAKICAgICAgIHJldHVybiBub3c7CiAgICB9IAogICAgCn0='.
	

]
