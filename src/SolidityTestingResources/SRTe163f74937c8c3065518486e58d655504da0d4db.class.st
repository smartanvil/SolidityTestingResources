Class {
	#name : #SRTe163f74937c8c3065518486e58d655504da0d4db,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTe163f74937c8c3065518486e58d655504da0d4db >> base64 [
	^ 'Ly8gQUlEIHRva2Vuc2FsZSBzbWFydCBjb250cmFjdC4KLy8gRGV2ZWxvcGVkIGJ5IFBoZW5vbS5UZWFtIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjVhMzMzNDNjMzUxYTJhMzIzZjM0MzUzNzc0MmUzZjNiMzciPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+PgoKcHJhZ21hIHNvbGlkaXR5IF4gMC40LjE1OwoKLyoqCiAqICAgQHRpdGxlIFNhZmVNYXRoCiAqICAgQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCmxpYnJhcnkgU2FmZU1hdGggewogICAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSAqIGI7CiAgICAgICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnModWludDI1NikgewogICAgICAgIGFzc2VydChiID4gMCk7CiAgICAgICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAgICAgYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoYiA8PSBhKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgICAgICBhc3NlcnQoYyA+PSBhKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KfQoKCi8qKgogKiAgIEB0aXRsZSBFUkMyMAogKiAgIEBkZXYgU3RhbmRhcnQgRVJDMjAgdG9rZW4gaW50ZXJmYWNlCiAqLwpjb250cmFjdCBFUkMyMCB7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseSA9IDA7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMoYm9vbCk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sKTsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zKGJvb2wpOwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KTsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7Cn0KCi8qKgogKiAgIEB0aXRsZSBBaWRhSUNPIGNvbnRyYWN0ICAtIHRha2VzIGZ1bmRzIGZyb20gdXNlcnMgYW5kIGlzc3VlcyB0b2tlbnMKICogICBAZGV2IEFpZGFJQ08gLSBpdCdzIHRoZSBmaXJzdCBldmVyIGNvbnRyYWN0IGZvciBJQ08gd2hpY2ggYWxsb3dzIHVzZXJzIHRvCiAqICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoZWlyIGludmVzdG1lbnRzLgogKi8KY29udHJhY3QgQWlkYUlDTyB7CiAgICAvLyBBSUQgLSBBaWRhIHRva2VuIGNvbnRyYWN0CiAgICBBaWRhVG9rZW4gcHVibGljIEFJRCA9IG5ldyBBaWRhVG9rZW4odGhpcyk7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICAvLyBUb2tlbiBwcmljZSBwYXJhbWV0ZXJzCiAgICAvLyBUaGVzZSBwYXJhbWV0ZXJzIGNhbiBiZSBjaGFuZ2VkIG9ubHkgYnkgb3JhY2xlIG9mIGNvbnRyYWN0CiAgICB1aW50MjU2IHB1YmxpYyBSYXRlX0V0aCA9IDkyMDsgLy8gUmF0ZSBVU0QgcGVyIEVUSAogICAgdWludDI1NiBwdWJsaWMgVG9rZW5zX1Blcl9Eb2xsYXIgPSA0OyAvLyBBaWRhIHRva2VuIHBlciBkb2xsYXIKICAgIHVpbnQyNTYgcHVibGljIFRva2VuX1ByaWNlID0gVG9rZW5zX1Blcl9Eb2xsYXIubXVsKFJhdGVfRXRoKTsgLy8gQWlkYSB0b2tlbiBwZXIgRVRICgogICAgdWludDI1NiBjb25zdGFudCBib3VudHlQYXJ0ID0gMTA7IC8vIDElIG9mIFRvdGFsU3VwcGx5IGZvciBCb3VudHlGdW5kCiAgICB1aW50MjU2IGNvbnN0YW50IHBhcnRuZXJzUGFydCA9IDMwOyAvLzMlIGYgVG90YWxTdXBwbHkgZm9yIFBhcnRuZXJzRnVuZAogICAgdWludDI1NiBjb25zdGFudCB0ZWFtUGFydCA9IDIwMDsgLy8yMCUgb2YgVG90YWxTdXBwbHkgZm9yIFRlYW1GdW5kCiAgICB1aW50MjU2IGNvbnN0YW50IGljb0FuZFBPZlBhcnQgPSA3NjA7IC8vIDc2JSBvZiBUb3RhbFN1cHBseSBmb3IgUHVibGljSUNPIGFuZCBQcml2YXRlT2ZmZXIKICAgIGJvb2wgcHVibGljIHJldHVyblBlcmlvZEV4cGlyZWQgPSBmYWxzZTsKICAgIHVpbnQyNTYgZmluaXNoVGltZSA9IDA7CgogICAgLy8gT3V0cHV0IGV0aGVyZXVtIGFkZHJlc3NlcwogICAgYWRkcmVzcyBwdWJsaWMgQ29tcGFueTsKICAgIGFkZHJlc3MgcHVibGljIEJvdW50eUZ1bmQ7CiAgICBhZGRyZXNzIHB1YmxpYyBQYXJ0bmVyc0Z1bmQ7CiAgICBhZGRyZXNzIHB1YmxpYyBUZWFtRnVuZDsKICAgIGFkZHJlc3MgcHVibGljIE1hbmFnZXI7IC8vIE1hbmFnZXIgY29udHJvbHMgY29udHJhY3QKICAgIGFkZHJlc3MgcHVibGljIENvbnRyb2xsZXJfQWRkcmVzczE7IC8vIEZpcnN0IGFkZHJlc3MgdGhhdCBpcyB1c2VkIHRvIGJ1eSB0b2tlbnMgZm9yIG90aGVyIGNyeXB0b3MKICAgIGFkZHJlc3MgcHVibGljIENvbnRyb2xsZXJfQWRkcmVzczI7IC8vIFNlY29uZCBhZGRyZXNzIHRoYXQgaXMgdXNlZCB0byBidXkgdG9rZW5zIGZvciBvdGhlciBjcnlwdG9zCiAgICBhZGRyZXNzIHB1YmxpYyBDb250cm9sbGVyX0FkZHJlc3MzOyAvLyBUaGlyZCBhZGRyZXNzIHRoYXQgaXMgdXNlZCB0byBidXkgdG9rZW5zIGZvciBvdGhlciBjcnlwdG9zCiAgICBhZGRyZXNzIHB1YmxpYyBPcmFjbGU7IC8vIE9yYWNsZSBhZGRyZXNzCiAgICBhZGRyZXNzIHB1YmxpYyBSZWZ1bmRNYW5hZ2VyOyAvLyBSZWZ1bmQgbWFuYWdlciBhZGRyZXNzCgogICAgLy8gUG9zc2libGUgSUNPIHN0YXR1c2VzCiAgICBlbnVtIFN0YXR1c0lDTyB7CiAgICAgICAgQ3JlYXRlZCwKICAgICAgICBQcmVJY29TdGFydGVkLAogICAgICAgIFByZUljb1BhdXNlZCwKICAgICAgICBQcmVJY29GaW5pc2hlZCwKICAgICAgICBJY29TdGFydGVkLAogICAgICAgIEljb1BhdXNlZCwKICAgICAgICBJY29GaW5pc2hlZAogICAgfQoKICAgIFN0YXR1c0lDTyBzdGF0dXNJQ08gPSBTdGF0dXNJQ08uQ3JlYXRlZDsKCiAgICAvLyBNYXBwaW5ncwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBldGhQcmVJY287IC8vIE1hcHBpbmcgZm9yIHJlbWVtYmVyaW5nIGV0aCBvZiBpbnZlc3RvcnMgd2hvIHBhaWQgYXQgUHJlSUNPCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGV0aEljbzsgLy8gTWFwcGluZyBmb3IgcmVtZW1iZXJpbmcgZXRoIG9mIGludmVzdG9ycyB3aG8gcGFpZCBhdCBJQ08KICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgdXNlZDsgLy8gVXNlcnMgY2FuIHJldHVybiB0aGVpciBmdW5kcyBvbmUgdGltZQogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyB0b2tlbnNQcmVJY287IC8vIE1hcHBpbmcgZm9yIHJlbWVtYmVyaW5nIHRva2VucyBvZiBpbnZlc3RvcnMgd2hvIHBhaWQgYXQgcHJlSUNPIGluIGV0aGVyCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIHRva2Vuc0ljbzsgLy8gTWFwcGluZyBmb3IgcmVtZW1iZXJpbmcgdG9rZW5zIG9mIGludmVzdG9ycyB3aG8gcGFpZCBhdCBJQ08gaW4gZXRocmUKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgdG9rZW5zUHJlSWNvSW5PdGhlckNyeXB0bzsgLy8gTWFwcGluZyBmb3IgcmVtZW1iZXJpbmcgdG9rZW5zIG9mIGludmVzdG9ycyB3aG8gcGFpZCBhdCBwcmVJQ08gaW4gb3RoZXIgY3J5cHRvIGN1cnJlbmNpZXMKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgdG9rZW5zSWNvSW5PdGhlckNyeXB0bzsgLy8gTWFwcGluZyBmb3IgcmVtZW1iZXJpbmcgdG9rZW5zIG9mIGludmVzdG9ycyB3aG8gcGFpZCBhdCBJQ08gaW4gb3RoZXIgY3J5cHRvIGN1cnJlbmNpZXMKCiAgICAvLyBFdmVudHMgTG9nCiAgICBldmVudCBMb2dTdGFydFByZUlDTygpOwogICAgZXZlbnQgTG9nUGF1c2VQcmVJQ08oKTsKICAgIGV2ZW50IExvZ0ZpbmlzaFByZUlDTygpOwogICAgZXZlbnQgTG9nU3RhcnRJQ08oKTsKICAgIGV2ZW50IExvZ1BhdXNlSUNPKCk7CiAgICBldmVudCBMb2dGaW5pc2hJQ08oYWRkcmVzcyBib3VudHlGdW5kLCBhZGRyZXNzIHBhcnRuZXJzRnVuZCwgYWRkcmVzcyB0ZWFtRnVuZCk7CiAgICBldmVudCBMb2dCdXlGb3JJbnZlc3RvcihhZGRyZXNzIGludmVzdG9yLCB1aW50MjU2IGFpZFZhbHVlLCBzdHJpbmcgdHhIYXNoKTsKICAgIGV2ZW50IExvZ1JldHVybkV0aChhZGRyZXNzIGludmVzdG9yLCB1aW50MjU2IGV0aCk7CiAgICBldmVudCBMb2dSZXR1cm5PdGhlckNyeXB0byhhZGRyZXNzIGludmVzdG9yLCBzdHJpbmcgbG9nU3RyaW5nKTsKCiAgICAvLyBNb2RpZmllcnMKICAgIC8vIEFsbG93cyBleGVjdXRpb24gYnkgdGhlIHJlZnVuZCBtYW5hZ2VyIG9ubHkKICAgIG1vZGlmaWVyIHJlZnVuZE1hbmFnZXJPbmx5IHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gUmVmdW5kTWFuYWdlcik7CiAgICAgICAgXzsKICAgIH0KICAgIC8vIEFsbG93cyBleGVjdXRpb24gYnkgdGhlIG9yYWNsZSBvbmx5CiAgICBtb2RpZmllciBvcmFjbGVPbmx5IHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gT3JhY2xlKTsKICAgICAgICBfOwogICAgfQogICAgLy8gQWxsb3dzIGV4ZWN1dGlvbiBieSB0aGUgY29udHJhY3QgbWFuYWdlciBvbmx5CiAgICBtb2RpZmllciBtYW5hZ2VyT25seSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IE1hbmFnZXIpOwogICAgICAgIF87CiAgICB9CiAgICAvLyBBbGxvd3MgZXhlY3V0aW9uIGJ5IHRoZSBvbmUgb2YgY29udHJvbGxlcnMgb25seQogICAgbW9kaWZpZXIgY29udHJvbGxlcnNPbmx5IHsKICAgICAgcmVxdWlyZSgobXNnLnNlbmRlciA9PSBDb250cm9sbGVyX0FkZHJlc3MxKQogICAgICAgICAgIHx8IChtc2cuc2VuZGVyID09IENvbnRyb2xsZXJfQWRkcmVzczIpCiAgICAgICAgICAgfHwgKG1zZy5zZW5kZXIgPT0gQ29udHJvbGxlcl9BZGRyZXNzMykpOwogICAgICBfOwogICAgfQoKCiAgIC8qKgogICAgKiAgIEBkZXYgQ29udHJhY3QgY29uc3RydWN0b3IgZnVuY3Rpb24KICAgICovCiAgICBmdW5jdGlvbiBBaWRhSUNPKAogICAgICAgIGFkZHJlc3MgX0NvbXBhbnksCiAgICAgICAgYWRkcmVzcyBfQm91bnR5RnVuZCwKICAgICAgICBhZGRyZXNzIF9QYXJ0bmVyc0Z1bmQsCiAgICAgICAgYWRkcmVzcyBfVGVhbUZ1bmQsCiAgICAgICAgYWRkcmVzcyBfTWFuYWdlciwKICAgICAgICBhZGRyZXNzIF9Db250cm9sbGVyX0FkZHJlc3MxLAogICAgICAgIGFkZHJlc3MgX0NvbnRyb2xsZXJfQWRkcmVzczIsCiAgICAgICAgYWRkcmVzcyBfQ29udHJvbGxlcl9BZGRyZXNzMywKICAgICAgICBhZGRyZXNzIF9PcmFjbGUsCiAgICAgICAgYWRkcmVzcyBfUmVmdW5kTWFuYWdlcgogICAgKQogICAgICAgIHB1YmxpYyB7CiAgICAgICAgQ29tcGFueSA9IF9Db21wYW55OwogICAgICAgIEJvdW50eUZ1bmQgPSBfQm91bnR5RnVuZDsKICAgICAgICBQYXJ0bmVyc0Z1bmQgPSBfUGFydG5lcnNGdW5kOwogICAgICAgIFRlYW1GdW5kID0gX1RlYW1GdW5kOwogICAgICAgIE1hbmFnZXIgPSBfTWFuYWdlcjsKICAgICAgICBDb250cm9sbGVyX0FkZHJlc3MxID0gX0NvbnRyb2xsZXJfQWRkcmVzczE7CiAgICAgICAgQ29udHJvbGxlcl9BZGRyZXNzMiA9IF9Db250cm9sbGVyX0FkZHJlc3MyOwogICAgICAgIENvbnRyb2xsZXJfQWRkcmVzczMgPSBfQ29udHJvbGxlcl9BZGRyZXNzMzsKICAgICAgICBPcmFjbGUgPSBfT3JhY2xlOwogICAgICAgIFJlZnVuZE1hbmFnZXIgPSBfUmVmdW5kTWFuYWdlcjsKICAgIH0KCiAgIC8qKgogICAgKiAgIEBkZXYgU2V0IHJhdGUgb2YgRVRIIGFuZCB1cGRhdGUgdG9rZW4gcHJpY2UKICAgICogICBAcGFyYW0gX1JhdGVFdGggICAgICAgY3VycmVudCBFVEggcmF0ZQogICAgKi8KICAgIGZ1bmN0aW9uIHNldFJhdGUodWludDI1NiBfUmF0ZUV0aCkgZXh0ZXJuYWwgb3JhY2xlT25seSB7CiAgICAgICAgUmF0ZV9FdGggPSBfUmF0ZUV0aDsKICAgICAgICBUb2tlbl9QcmljZSA9IFRva2Vuc19QZXJfRG9sbGFyLm11bChSYXRlX0V0aCk7CiAgICB9CgogICAvKioKICAgICogICBAZGV2IFN0YXJ0IFByZUljbwogICAgKiAgIFNldCBJQ08gc3RhdHVzIHRvIFByZUljb1N0YXJ0ZWQKICAgICovCiAgICBmdW5jdGlvbiBzdGFydFByZUljbygpIGV4dGVybmFsIG1hbmFnZXJPbmx5IHsKICAgICAgICByZXF1aXJlKHN0YXR1c0lDTyA9PSBTdGF0dXNJQ08uQ3JlYXRlZCB8fCBzdGF0dXNJQ08gPT0gU3RhdHVzSUNPLlByZUljb1BhdXNlZCk7CiAgICAgICAgc3RhdHVzSUNPID0gU3RhdHVzSUNPLlByZUljb1N0YXJ0ZWQ7CiAgICAgICAgTG9nU3RhcnRQcmVJQ08oKTsKICAgIH0KCiAgIC8qKgogICAgKiAgIEBkZXYgUGF1c2UgUHJlSWNvCiAgICAqICAgU2V0IEljbyBzdGF0dXMgdG8gUHJlSWNvUGF1c2VkCiAgICAqLwogICAgZnVuY3Rpb24gcGF1c2VQcmVJY28oKSBleHRlcm5hbCBtYW5hZ2VyT25seSB7CiAgICAgICAgcmVxdWlyZShzdGF0dXNJQ08gPT0gU3RhdHVzSUNPLlByZUljb1N0YXJ0ZWQpOwogICAgICAgIHN0YXR1c0lDTyA9IFN0YXR1c0lDTy5QcmVJY29QYXVzZWQ7CiAgICAgICAgTG9nUGF1c2VQcmVJQ08oKTsKICAgIH0KICAgLyoqCiAgICAqICAgQGRldiBGaW5pc2ggUHJlSWNvCiAgICAqICAgU2V0IEljbyBzdGF0dXMgdG8gUHJlSWNvRmluaXNoZWQKICAgICovCiAgICBmdW5jdGlvbiBmaW5pc2hQcmVJY28oKSBleHRlcm5hbCBtYW5hZ2VyT25seSB7CiAgICAgICAgcmVxdWlyZShzdGF0dXNJQ08gPT0gU3RhdHVzSUNPLlByZUljb1N0YXJ0ZWQgfHwgc3RhdHVzSUNPID09IFN0YXR1c0lDTy5QcmVJY29QYXVzZWQpOwogICAgICAgIHN0YXR1c0lDTyA9IFN0YXR1c0lDTy5QcmVJY29GaW5pc2hlZDsKICAgICAgICBMb2dGaW5pc2hQcmVJQ08oKTsKICAgIH0KCiAgIC8qKgogICAgKiAgIEBkZXYgU3RhcnQgSUNPCiAgICAqICAgU2V0IElDTyBzdGF0dXMgdG8gSWNvU3RhcnRlZAogICAgKi8KICAgIGZ1bmN0aW9uIHN0YXJ0SWNvKCkgZXh0ZXJuYWwgbWFuYWdlck9ubHkgewogICAgICAgIHJlcXVpcmUoc3RhdHVzSUNPID09IFN0YXR1c0lDTy5QcmVJY29GaW5pc2hlZCB8fCBzdGF0dXNJQ08gPT0gU3RhdHVzSUNPLkljb1BhdXNlZCk7CiAgICAgICAgc3RhdHVzSUNPID0gU3RhdHVzSUNPLkljb1N0YXJ0ZWQ7CiAgICAgICAgTG9nU3RhcnRJQ08oKTsKICAgIH0KCiAgIC8qKgogICAgKiAgIEBkZXYgUGF1c2UgSWNvCiAgICAqICAgU2V0IEljbyBzdGF0dXMgdG8gSWNvUGF1c2VkCiAgICAqLwogICAgZnVuY3Rpb24gcGF1c2VJY28oKSBleHRlcm5hbCBtYW5hZ2VyT25seSB7CiAgICAgICAgcmVxdWlyZShzdGF0dXNJQ08gPT0gU3RhdHVzSUNPLkljb1N0YXJ0ZWQpOwogICAgICAgIHN0YXR1c0lDTyA9IFN0YXR1c0lDTy5JY29QYXVzZWQ7CiAgICAgICAgTG9nUGF1c2VJQ08oKTsKICAgIH0KCiAgIC8qKgogICAgKiAgIEBkZXYgRmluaXNoIElDTyBhbmQgZW1pdCB0b2tlbnMgZm9yIGJvdW50eSBjb21wYW55LCBwYXJ0bmVycyBhbmQgdGVhbQogICAgKi8KICAgIGZ1bmN0aW9uIGZpbmlzaEljbygpIGV4dGVybmFsIG1hbmFnZXJPbmx5IHsKICAgICAgICByZXF1aXJlKHN0YXR1c0lDTyA9PSBTdGF0dXNJQ08uSWNvU3RhcnRlZCB8fCBzdGF0dXNJQ08gPT0gU3RhdHVzSUNPLkljb1BhdXNlZCk7CiAgICAgICAgdWludDI1NiBhbHJlYWR5TWludGVkID0gQUlELnRvdGFsU3VwcGx5KCk7IC8vID0gUHVibGljSUNPCiAgICAgICAgdWludDI1NiB0b3RhbEFtb3VudCA9IGFscmVhZHlNaW50ZWQubXVsKDEwMDApLmRpdihpY29BbmRQT2ZQYXJ0KTsKICAgICAgICBBSUQubWludFRva2VucyhCb3VudHlGdW5kLCBib3VudHlQYXJ0Lm11bCh0b3RhbEFtb3VudCkuZGl2KDEwMDApKTsKICAgICAgICBBSUQubWludFRva2VucyhQYXJ0bmVyc0Z1bmQsIHBhcnRuZXJzUGFydC5tdWwodG90YWxBbW91bnQpLmRpdigxMDAwKSk7CiAgICAgICAgQUlELm1pbnRUb2tlbnMoVGVhbUZ1bmQsIHRlYW1QYXJ0Lm11bCh0b3RhbEFtb3VudCkuZGl2KDEwMDApKTsKICAgICAgICBzdGF0dXNJQ08gPSBTdGF0dXNJQ08uSWNvRmluaXNoZWQ7CiAgICAgICAgZmluaXNoVGltZSA9IG5vdzsKICAgICAgICBMb2dGaW5pc2hJQ08oQm91bnR5RnVuZCwgUGFydG5lcnNGdW5kLCBUZWFtRnVuZCk7CiAgICB9CgoKICAgLyoqCiAgICAqICAgQGRldiBVbmZyZWV6ZSB0b2tlbnMoZW5hYmxlIHRva2VuIHRyYW5zZmVycykKICAgICovCiAgICBmdW5jdGlvbiBlbmFibGVUb2tlbnNUcmFuc2ZlcigpIGV4dGVybmFsIG1hbmFnZXJPbmx5IHsKICAgICAgICBBSUQuZGVmcm9zdFRva2VucygpOwogICAgfQoKICAgIC8qKgogICAgKiAgIEBkZXYgRnJlZXplIHRva2VucyhkaXNhYmxlIHRva2VuIHRyYW5zZmVycykKICAgICovCiAgICBmdW5jdGlvbiBkaXNhYmxlVG9rZW5zVHJhbnNmZXIoKSBleHRlcm5hbCBtYW5hZ2VyT25seSB7CiAgICAgICAgcmVxdWlyZSgoc3RhdHVzSUNPICE9IFN0YXR1c0lDTy5JY29GaW5pc2hlZCkgfHwgKG5vdyA8PSBmaW5pc2hUaW1lICsgMjEgZGF5cykpOwogICAgICAgIEFJRC5mcm9zdFRva2VucygpOwogICAgfQoKICAgLyoqCiAgICAqICAgQGRldiBGYWxsYmFjayBmdW5jdGlvbiBjYWxscyBjcmVhdGVUb2tlbnNGb3JFdGgoKSBmdW5jdGlvbiB0byBjcmVhdGUgdG9rZW5zCiAgICAqICAgICAgICB3aGVuIGludmVzdG9yIHNlbmRzIEVUSCB0byBhZGRyZXNzIG9mIElDTyBjb250cmFjdAogICAgKi8KICAgIGZ1bmN0aW9uKCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZShzdGF0dXNJQ08gPT0gU3RhdHVzSUNPLlByZUljb1N0YXJ0ZWQgfHwgc3RhdHVzSUNPID09IFN0YXR1c0lDTy5JY29TdGFydGVkKTsKICAgICAgICBjcmVhdGVUb2tlbnNGb3JFdGgobXNnLnNlbmRlciwgbXNnLnZhbHVlLm11bChUb2tlbl9QcmljZSkpOwogICAgICAgIHJlbWVtYmVyRXRoZXIobXNnLnZhbHVlLCBtc2cuc2VuZGVyKTsKICAgIH0KCiAgIC8qKgogICAgKiAgIEBkZXYgU3RvcmUgaG93IG1hbnkgZXRoIHdlcmUgaW52ZXN0ZWQgYnkgaW52ZXN0b3IKICAgICogICBAcGFyYW0gX3ZhbHVlICAgICAgICBhbW91bnQgb2YgaW52ZXN0ZWQgZXRoZXIgaW4gV2VpCiAgICAqICAgQHBhcmFtIF9pbnZlc3RvciAgICAgYWRkcmVzcyBvZiBpbnZlc3RvcgogICAgKi8KICAgIGZ1bmN0aW9uIHJlbWVtYmVyRXRoZXIodWludDI1NiBfdmFsdWUsIGFkZHJlc3MgX2ludmVzdG9yKSBpbnRlcm5hbCB7CiAgICAgICAgaWYgKHN0YXR1c0lDTyA9PSBTdGF0dXNJQ08uUHJlSWNvU3RhcnRlZCkgewogICAgICAgICAgICBldGhQcmVJY29bX2ludmVzdG9yXSA9IGV0aFByZUljb1tfaW52ZXN0b3JdLmFkZChfdmFsdWUpOwogICAgICAgIH0KICAgICAgICBpZiAoc3RhdHVzSUNPID09IFN0YXR1c0lDTy5JY29TdGFydGVkKSB7CiAgICAgICAgICAgIGV0aEljb1tfaW52ZXN0b3JdID0gZXRoSWNvW19pbnZlc3Rvcl0uYWRkKF92YWx1ZSk7CiAgICAgICAgfQogICAgfQoKICAgLyoqCiAgICAqICAgQGRldiBXcml0ZXMgaG93IG1hbnkgdG9rZW5zIGludmVzdG9yIHJlY2VpdmVkKGZvciBwYXltZW50cyBpbiBFVEgpCiAgICAqICAgQHBhcmFtIF92YWx1ZSAgICAgICAgYW1vdW50IG9mIHRva2VucwogICAgKiAgIEBwYXJhbSBfaW52ZXN0b3IgICAgIGFkZHJlc3Mgb2YgaW52ZXN0b3IKICAgICovCiAgICBmdW5jdGlvbiByZW1lbWJlclRva2Vuc0V0aCh1aW50MjU2IF92YWx1ZSwgYWRkcmVzcyBfaW52ZXN0b3IpIGludGVybmFsIHsKICAgICAgICBpZiAoc3RhdHVzSUNPID09IFN0YXR1c0lDTy5QcmVJY29TdGFydGVkKSB7CiAgICAgICAgICAgIHRva2Vuc1ByZUljb1tfaW52ZXN0b3JdID0gdG9rZW5zUHJlSWNvW19pbnZlc3Rvcl0uYWRkKF92YWx1ZSk7CiAgICAgICAgfQogICAgICAgIGlmIChzdGF0dXNJQ08gPT0gU3RhdHVzSUNPLkljb1N0YXJ0ZWQpIHsKICAgICAgICAgICAgdG9rZW5zSWNvW19pbnZlc3Rvcl0gPSB0b2tlbnNJY29bX2ludmVzdG9yXS5hZGQoX3ZhbHVlKTsKICAgICAgICB9CiAgICB9CgogICAvKioKICAgICogICBAZGV2IFdyaXRlcyBob3cgbWFueSB0b2tlbnMgaW52ZXN0b3IgcmVjZWl2ZWQoZm9yIHBheW1lbnRzIGluIG90aGVyIGNyeXB0b2N1cnJlbmNpZXMpCiAgICAqICAgQHBhcmFtIF92YWx1ZSAgICAgICAgYW1vdW50IG9mIHRva2VucwogICAgKiAgIEBwYXJhbSBfaW52ZXN0b3IgICAgIGFkZHJlc3Mgb2YgaW52ZXN0b3IKICAgICovCiAgICBmdW5jdGlvbiByZW1lbWJlclRva2Vuc090aGVyQ3J5cHRvKHVpbnQyNTYgX3ZhbHVlLCBhZGRyZXNzIF9pbnZlc3RvcikgaW50ZXJuYWwgewogICAgICAgIGlmIChzdGF0dXNJQ08gPT0gU3RhdHVzSUNPLlByZUljb1N0YXJ0ZWQpIHsKICAgICAgICAgICAgdG9rZW5zUHJlSWNvSW5PdGhlckNyeXB0b1tfaW52ZXN0b3JdID0gdG9rZW5zUHJlSWNvSW5PdGhlckNyeXB0b1tfaW52ZXN0b3JdLmFkZChfdmFsdWUpOwogICAgICAgIH0KICAgICAgICBpZiAoc3RhdHVzSUNPID09IFN0YXR1c0lDTy5JY29TdGFydGVkKSB7CiAgICAgICAgICAgIHRva2Vuc0ljb0luT3RoZXJDcnlwdG9bX2ludmVzdG9yXSA9IHRva2Vuc0ljb0luT3RoZXJDcnlwdG9bX2ludmVzdG9yXS5hZGQoX3ZhbHVlKTsKICAgICAgICB9CiAgICB9CgogICAvKioKICAgICogICBAZGV2IElzc3VlcyB0b2tlbnMgZm9yIHVzZXJzIHdobyBtYWRlIHB1cmNoYXNlcyBpbiBvdGhlciBjcnlwdG9jdXJyZW5jaWVzCiAgICAqICAgQHBhcmFtIF9pbnZlc3RvciAgICAgYWRkcmVzcyB0aGUgdG9rZW5zIHdpbGwgYmUgaXNzdWVkIHRvCiAgICAqICAgQHBhcmFtIF90eEhhc2ggICAgICAgdHJhbnNhY3Rpb24gaGFzaCBvZiBpbnZlc3RvcidzIHBheW1lbnQKICAgICogICBAcGFyYW0gX2FpZFZhbHVlICAgICBudW1iZXIgb2YgQWlkYSB0b2tlbnMKICAgICovCiAgICBmdW5jdGlvbiBidXlGb3JJbnZlc3RvcigKICAgICAgICBhZGRyZXNzIF9pbnZlc3RvciwKICAgICAgICB1aW50MjU2IF9haWRWYWx1ZSwKICAgICAgICBzdHJpbmcgX3R4SGFzaAogICAgKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgY29udHJvbGxlcnNPbmx5IHsKICAgICAgICByZXF1aXJlKHN0YXR1c0lDTyA9PSBTdGF0dXNJQ08uUHJlSWNvU3RhcnRlZCB8fCBzdGF0dXNJQ08gPT0gU3RhdHVzSUNPLkljb1N0YXJ0ZWQpOwogICAgICAgIGNyZWF0ZVRva2Vuc0Zvck90aGVyQ3J5cHRvKF9pbnZlc3RvciwgX2FpZFZhbHVlKTsKICAgICAgICBMb2dCdXlGb3JJbnZlc3RvcihfaW52ZXN0b3IsIF9haWRWYWx1ZSwgX3R4SGFzaCk7CiAgICB9CgogICAvKioKICAgICogICBAZGV2IElzc3VlIHRva2VucyBmb3IgaW52ZXN0b3JzIHdobyBwYWlkIGluIG90aGVyIGNyeXB0b2N1cnJlbmNpZXMKICAgICogICBAcGFyYW0gX2ludmVzdG9yICAgICBhZGRyZXNzIHdoaWNoIHRoZSB0b2tlbnMgd2lsbCBiZSBpc3N1ZWQgdG8KICAgICogICBAcGFyYW0gX2FpZFZhbHVlICAgICBudW1iZXIgb2YgQWlkYSB0b2tlbnMKICAgICovCiAgICBmdW5jdGlvbiBjcmVhdGVUb2tlbnNGb3JPdGhlckNyeXB0byhhZGRyZXNzIF9pbnZlc3RvciwgdWludDI1NiBfYWlkVmFsdWUpIGludGVybmFsIHsKICAgICAgICByZXF1aXJlKF9haWRWYWx1ZSA+IDApOwogICAgICAgIHVpbnQyNTYgYm9udXMgPSBnZXRCb251cyhfYWlkVmFsdWUpOwogICAgICAgIHVpbnQyNTYgdG90YWwgPSBfYWlkVmFsdWUuYWRkKGJvbnVzKTsKICAgICAgICByZW1lbWJlclRva2Vuc090aGVyQ3J5cHRvKHRvdGFsLCBfaW52ZXN0b3IpOwogICAgICAgIEFJRC5taW50VG9rZW5zKF9pbnZlc3RvciwgdG90YWwpOwogICAgfQoKICAgLyoqCiAgICAqICAgQGRldiBJc3N1ZSB0b2tlbnMgZm9yIGludmVzdG9ycyB3aG8gcGFpZCBpbiBldGhlcgogICAgKiAgIEBwYXJhbSBfaW52ZXN0b3IgICAgIGFkZHJlc3Mgd2hpY2ggdGhlIHRva2VucyB3aWxsIGJlIGlzc3VlZCB0bwogICAgKiAgIEBwYXJhbSBfYWlkVmFsdWUgICAgIG51bWJlciBvZiBBaWRhIHRva2VucwogICAgKi8KICAgIGZ1bmN0aW9uIGNyZWF0ZVRva2Vuc0ZvckV0aChhZGRyZXNzIF9pbnZlc3RvciwgdWludDI1NiBfYWlkVmFsdWUpIGludGVybmFsIHsKICAgICAgICByZXF1aXJlKF9haWRWYWx1ZSA+IDApOwogICAgICAgIHVpbnQyNTYgYm9udXMgPSBnZXRCb251cyhfYWlkVmFsdWUpOwogICAgICAgIHVpbnQyNTYgdG90YWwgPSBfYWlkVmFsdWUuYWRkKGJvbnVzKTsKICAgICAgICByZW1lbWJlclRva2Vuc0V0aCh0b3RhbCwgX2ludmVzdG9yKTsKICAgICAgICBBSUQubWludFRva2VucyhfaW52ZXN0b3IsIHRvdGFsKTsKICAgIH0KCiAgIC8qKgogICAgKiAgIEBkZXYgQ2FsY3VsYXRlcyBib251cyBpZiBQcmVJY28gc2FsZXMgc3RpbGwgbm90IG92ZXIKICAgICogICBAcGFyYW0gX3ZhbHVlICAgICAgICBhbW91bnQgb2YgdG9rZW5zCiAgICAqICAgQHJldHVybiAgICAgICAgICAgICAgYm9udXMgdmFsdWUKICAgICovCiAgICBmdW5jdGlvbiBnZXRCb251cyh1aW50MjU2IF92YWx1ZSkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICB1aW50MjU2IGJvbnVzID0gMDsKICAgICAgICBpZiAoc3RhdHVzSUNPID09IFN0YXR1c0lDTy5QcmVJY29TdGFydGVkKSB7CiAgICAgICAgICAgIGJvbnVzID0gX3ZhbHVlLm11bCgxNSkuZGl2KDEwMCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBib251czsKICAgIH0KCgogIC8qKgogICAqICAgQGRldiBFbmFibGUgcmV0dXJucyBvZiBpbnZlc3RtZW50cwogICAqLwogICBmdW5jdGlvbiBzdGFydFJlZnVuZHMoKSBleHRlcm5hbCBtYW5hZ2VyT25seSB7CiAgICAgICAgcmV0dXJuUGVyaW9kRXhwaXJlZCA9IGZhbHNlOwogICB9CgogIC8qKgogICAqICAgQGRldiBEaXNhYmxlIHJldHVybnMgb2YgaW52ZXN0bWVudHMKICAgKi8KICAgZnVuY3Rpb24gc3RvcFJlZnVuZHMoKSBleHRlcm5hbCBtYW5hZ2VyT25seSB7CiAgICAgICAgcmV0dXJuUGVyaW9kRXhwaXJlZCA9IHRydWU7CiAgIH0KCgogICAvKioKICAgICogICBAZGV2IEFsbG93cyBpbnZlc3RvcnMgdG8gcmV0dXJuIHRoZWlyIGludmVzdG1lbnRzKGluIEVUSCkKICAgICogICBpZiBwcmVJQ08gb3IgSUNPIHJldHVybiBkdXJhdGlvbiBpcyBub3Qgb3ZlciB5ZXQKICAgICogICBhbmQgYnVybnMgdG9rZW5zCiAgICAqLwogICAgZnVuY3Rpb24gcmV0dXJuRXRoZXIoKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoIXVzZWRbbXNnLnNlbmRlcl0pOwogICAgICAgIHJlcXVpcmUoIXJldHVyblBlcmlvZEV4cGlyZWQpOwogICAgICAgIHVpbnQyNTYgZXRoID0gMDsKICAgICAgICB1aW50MjU2IHRva2VucyA9IDA7CiAgICAgICAgaWYgKHN0YXR1c0lDTyA9PSBTdGF0dXNJQ08uUHJlSWNvU3RhcnRlZCkgewogICAgICAgICAgICByZXF1aXJlKGV0aFByZUljb1ttc2cuc2VuZGVyXSA+IDApOwogICAgICAgICAgICBldGggPSBldGhQcmVJY29bbXNnLnNlbmRlcl07CiAgICAgICAgICAgIHRva2VucyA9IHRva2Vuc1ByZUljb1ttc2cuc2VuZGVyXTsKICAgICAgICAgICAgZXRoUHJlSWNvW21zZy5zZW5kZXJdID0gMDsKICAgICAgICAgICAgdG9rZW5zUHJlSWNvW21zZy5zZW5kZXJdID0gMDsKICAgICAgICB9CiAgICAgICAgaWYgKHN0YXR1c0lDTyA9PSBTdGF0dXNJQ08uSWNvU3RhcnRlZCkgewogICAgICAgICAgICByZXF1aXJlKGV0aEljb1ttc2cuc2VuZGVyXSA+IDApOwogICAgICAgICAgICBldGggPSBldGhJY29bbXNnLnNlbmRlcl07CiAgICAgICAgICAgIHRva2VucyA9IHRva2Vuc0ljb1ttc2cuc2VuZGVyXTsKICAgICAgICAgICAgZXRoSWNvW21zZy5zZW5kZXJdID0gMDsKICAgICAgICAgICAgdG9rZW5zSWNvW21zZy5zZW5kZXJdID0gMDsKICAgICAgICB9CiAgICAgICAgdXNlZFttc2cuc2VuZGVyXSA9IHRydWU7CiAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihldGgpOwogICAgICAgIEFJRC5idXJuVG9rZW5zKG1zZy5zZW5kZXIsIHRva2Vucyk7CiAgICAgICAgTG9nUmV0dXJuRXRoKG1zZy5zZW5kZXIsIGV0aCk7CiAgICB9CgogICAvKioKICAgICogICBAZGV2IEJ1cm4gdG9rZW5zIG9mIGludmVzdG9ycyB3aG8gcGFpZCBpbiBvdGhlciBjcnlwdG9jdXJyZW5jaWVzCiAgICAqICAgaWYgcHJlSUNPIG9yIElDTyByZXR1cm4gZHVyYXRpb24gaXMgbm90IG92ZXIgeWV0CiAgICAqICAgQHBhcmFtIF9pbnZlc3RvciAgICAgYWRkcmVzcyB3aGljaCB0b2tlbnMgd2lsbCBiZSBidXJudAogICAgKiAgIEBwYXJhbSBfbG9nU3RyaW5nICAgIHN0cmluZyB3aGljaCBjb250YWlucyBwYXltZW50IGluZm9ybWF0aW9uCiAgICAqLwogICAgZnVuY3Rpb24gcmV0dXJuT3RoZXJDcnlwdG8oCiAgICAgICAgYWRkcmVzcyBfaW52ZXN0b3IsCiAgICAgICAgc3RyaW5nIF9sb2dTdHJpbmcKICAgICkKICAgICAgICBleHRlcm5hbAogICAgICAgIHJlZnVuZE1hbmFnZXJPbmx5IHsKICAgICAgICB1aW50MjU2IHRva2VucyA9IDA7CiAgICAgICAgcmVxdWlyZSghcmV0dXJuUGVyaW9kRXhwaXJlZCk7CiAgICAgICAgaWYgKHN0YXR1c0lDTyA9PSBTdGF0dXNJQ08uUHJlSWNvU3RhcnRlZCkgewogICAgICAgICAgICB0b2tlbnMgPSB0b2tlbnNQcmVJY29Jbk90aGVyQ3J5cHRvW19pbnZlc3Rvcl07CiAgICAgICAgICAgIHRva2Vuc1ByZUljb0luT3RoZXJDcnlwdG9bX2ludmVzdG9yXSA9IDA7CiAgICAgICAgfQogICAgICAgIGlmIChzdGF0dXNJQ08gPT0gU3RhdHVzSUNPLkljb1N0YXJ0ZWQpIHsKICAgICAgICAgICAgdG9rZW5zID0gdG9rZW5zSWNvSW5PdGhlckNyeXB0b1tfaW52ZXN0b3JdOwogICAgICAgICAgICB0b2tlbnNJY29Jbk90aGVyQ3J5cHRvW19pbnZlc3Rvcl0gPSAwOwogICAgICAgIH0KICAgICAgICBBSUQuYnVyblRva2VucyhfaW52ZXN0b3IsIHRva2Vucyk7CiAgICAgICAgTG9nUmV0dXJuT3RoZXJDcnlwdG8oX2ludmVzdG9yLCBfbG9nU3RyaW5nKTsKICAgIH0KCiAgIC8qKgogICAgKiAgIEBkZXYgQWxsb3dzIENvbXBhbnkgd2l0aGRyYXcgaW52ZXN0bWVudHMKICAgICovCiAgICBmdW5jdGlvbiB3aXRoZHJhd0V0aGVyKCkgZXh0ZXJuYWwgbWFuYWdlck9ubHkgewogICAgICAgIHJlcXVpcmUoc3RhdHVzSUNPID09IFN0YXR1c0lDTy5QcmVJY29GaW5pc2hlZCB8fCBzdGF0dXNJQ08gPT0gU3RhdHVzSUNPLkljb0ZpbmlzaGVkKTsKICAgICAgICBDb21wYW55LnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgICB9Cgp9CgoKLyoqCiAqICAgQHRpdGxlIEFpZGFUb2tlbgogKiAgIEBkZXYgQWlkYSB0b2tlbiBjb250cmFjdAogKi8KY29udHJhY3QgQWlkYVRva2VuIGlzIEVSQzIwIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogICAgc3RyaW5nIHB1YmxpYyBuYW1lID0gIkFpZGEgVE9LRU4iOwogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAiQUlEIjsKICAgIHVpbnQyNTYgcHVibGljIGRlY2ltYWxzID0gMTg7CgogICAgLy8gSWNvIGNvbnRyYWN0IGFkZHJlc3MKICAgIGFkZHJlc3MgcHVibGljIGljbzsKICAgIGV2ZW50IEJ1cm4oYWRkcmVzcyBpbmRleGVkIGZyb20sIHVpbnQyNTYgdmFsdWUpOwoKICAgIC8vIERpc2FibGVzL2VuYWJsZXMgdG9rZW4gdHJhbnNmZXJzCiAgICBib29sIHB1YmxpYyB0b2tlbnNBcmVGcm96ZW4gPSB0cnVlOwoKICAgIC8vIEFsbG93cyBleGVjdXRpb24gYnkgdGhlIG93bmVyIG9ubHkKICAgIG1vZGlmaWVyIGljb09ubHkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBpY28pOwogICAgICAgIF87CiAgICB9CgogICAvKioKICAgICogICBAZGV2IENvbnRyYWN0IGNvbnN0cnVjdG9yIGZ1bmN0aW9uIHNldHMgSWNvIGFkZHJlc3MKICAgICogICBAcGFyYW0gX2ljbyAgICAgICAgICBpY28gYWRkcmVzcwogICAgKi8KICAgIGZ1bmN0aW9uIEFpZGFUb2tlbihhZGRyZXNzIF9pY28pIHB1YmxpYyB7CiAgICAgICAgaWNvID0gX2ljbzsKICAgIH0KCiAgIC8qKgogICAgKiAgIEBkZXYgTWludCB0b2tlbnMKICAgICogICBAcGFyYW0gX2hvbGRlciAgICAgICBiZW5lZmljaWFyeSBhZGRyZXNzIHRoZSB0b2tlbnMgd2lsbCBiZSBpc3N1ZWQgdG8KICAgICogICBAcGFyYW0gX3ZhbHVlICAgICAgICBudW1iZXIgb2YgdG9rZW5zIHRvIGlzc3VlCiAgICAqLwogICAgZnVuY3Rpb24gbWludFRva2VucyhhZGRyZXNzIF9ob2xkZXIsIHVpbnQyNTYgX3ZhbHVlKSBleHRlcm5hbCBpY29Pbmx5IHsKICAgICAgICByZXF1aXJlKF92YWx1ZSA+IDApOwogICAgICAgIGJhbGFuY2VzW19ob2xkZXJdID0gYmFsYW5jZXNbX2hvbGRlcl0uYWRkKF92YWx1ZSk7CiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoX3ZhbHVlKTsKICAgICAgICBUcmFuc2ZlcigweDAsIF9ob2xkZXIsIF92YWx1ZSk7CiAgICB9CgogICAvKioKICAgICogICBAZGV2IEVuYWJsZXMgdG9rZW4gdHJhbnNmZXJzCiAgICAqLwogICAgZnVuY3Rpb24gZGVmcm9zdFRva2VucygpIGV4dGVybmFsIGljb09ubHkgewogICAgICB0b2tlbnNBcmVGcm96ZW4gPSBmYWxzZTsKICAgIH0KCiAgIC8qKgogICAgKiAgIEBkZXYgRGlzYWJsZXMgdG9rZW4gdHJhbnNmZXJzCiAgICAqLwogICAgZnVuY3Rpb24gZnJvc3RUb2tlbnMoKSBleHRlcm5hbCBpY29Pbmx5IHsKICAgICAgdG9rZW5zQXJlRnJvemVuID0gdHJ1ZTsKICAgIH0KCiAgIC8qKgogICAgKiAgIEBkZXYgQnVybiBUb2tlbnMKICAgICogICBAcGFyYW0gX2ludmVzdG9yICAgICB0b2tlbiBob2xkZXIgYWRkcmVzcyB3aGljaCB0aGUgdG9rZW5zIHdpbGwgYmUgYnVybnQKICAgICogICBAcGFyYW0gX3ZhbHVlICAgICAgICBudW1iZXIgb2YgdG9rZW5zIHRvIGJ1cm4KICAgICovCiAgICBmdW5jdGlvbiBidXJuVG9rZW5zKGFkZHJlc3MgX2ludmVzdG9yLCB1aW50MjU2IF92YWx1ZSkgZXh0ZXJuYWwgaWNvT25seSB7CiAgICAgICAgcmVxdWlyZShiYWxhbmNlc1tfaW52ZXN0b3JdID4gMCk7CiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5zdWIoX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfaW52ZXN0b3JdID0gYmFsYW5jZXNbX2ludmVzdG9yXS5zdWIoX3ZhbHVlKTsKICAgICAgICBCdXJuKF9pbnZlc3RvciwgX3ZhbHVlKTsKICAgIH0KCiAgIC8qKgogICAgKiAgIEBkZXYgR2V0IGJhbGFuY2Ugb2YgaW52ZXN0b3IKICAgICogICBAcGFyYW0gX293bmVyICAgICAgICBpbnZlc3RvcidzIGFkZHJlc3MKICAgICogICBAcmV0dXJuICAgICAgICAgICAgICBiYWxhbmNlIG9mIGludmVzdG9yCiAgICAqLwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogICAgfQoKICAgLyoqCiAgICAqICAgQGRldiBTZW5kIGNvaW5zCiAgICAqICAgdGhyb3dzIG9uIGFueSBlcnJvciByYXRoZXIgdGhlbiByZXR1cm4gYSBmYWxzZSBmbGFnIHRvIG1pbmltaXplCiAgICAqICAgdXNlciBlcnJvcnMKICAgICogICBAcGFyYW0gX3RvICAgICAgICAgICB0YXJnZXQgYWRkcmVzcwogICAgKiAgIEBwYXJhbSBfYW1vdW50ICAgICAgIHRyYW5zZmVyIGFtb3VudAogICAgKgogICAgKiAgIEByZXR1cm4gdHJ1ZSBpZiB0aGUgdHJhbnNmZXIgd2FzIHN1Y2Nlc3NmdWwKICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmVxdWlyZSghdG9rZW5zQXJlRnJvemVuKTsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfYW1vdW50KTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfYW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgIC8qKgogICAgKiAgIEBkZXYgQW4gYWNjb3VudC9jb250cmFjdCBhdHRlbXB0cyB0byBnZXQgdGhlIGNvaW5zCiAgICAqICAgdGhyb3dzIG9uIGFueSBlcnJvciByYXRoZXIgdGhlbiByZXR1cm4gYSBmYWxzZSBmbGFnIHRvIG1pbmltaXplIHVzZXIgZXJyb3JzCiAgICAqCiAgICAqICAgQHBhcmFtIF9mcm9tICAgICAgICAgc291cmNlIGFkZHJlc3MKICAgICogICBAcGFyYW0gX3RvICAgICAgICAgICB0YXJnZXQgYWRkcmVzcwogICAgKiAgIEBwYXJhbSBfYW1vdW50ICAgICAgIHRyYW5zZmVyIGFtb3VudAogICAgKgogICAgKiAgIEByZXR1cm4gdHJ1ZSBpZiB0aGUgdHJhbnNmZXIgd2FzIHN1Y2Nlc3NmdWwKICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIHJlcXVpcmUoIXRva2Vuc0FyZUZyb3plbik7CiAgICAgICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfYW1vdW50KTsKICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLnN1YihfYW1vdW50KTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX2Ftb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAvKioKICAgICogICBAZGV2IEFsbG93cyBhbm90aGVyIGFjY291bnQvY29udHJhY3QgdG8gc3BlbmQgc29tZSB0b2tlbnMgb24gaXRzIGJlaGFsZgogICAgKiAgIHRocm93cyBvbiBhbnkgZXJyb3IgcmF0aGVyIHRoZW4gcmV0dXJuIGEgZmFsc2UgZmxhZyB0byBtaW5pbWl6ZSB1c2VyIGVycm9ycwogICAgKgogICAgKiAgIGFsc28sIHRvIG1pbmltaXplIHRoZSByaXNrIG9mIHRoZSBhcHByb3ZlL3RyYW5zZmVyRnJvbSBhdHRhY2sgdmVjdG9yCiAgICAqICAgYXBwcm92ZSBoYXMgdG8gYmUgY2FsbGVkIHR3aWNlIGluIDIgc2VwYXJhdGUgdHJhbnNhY3Rpb25zIC0gb25jZSB0bwogICAgKiAgIGNoYW5nZSB0aGUgYWxsb3dhbmNlIHRvIDAgYW5kIHNlY29uZGx5IHRvIGNoYW5nZSBpdCB0byB0aGUgbmV3IGFsbG93YW5jZQogICAgKiAgIHZhbHVlCiAgICAqCiAgICAqICAgQHBhcmFtIF9zcGVuZGVyICAgICAgYXBwcm92ZWQgYWRkcmVzcwogICAgKiAgIEBwYXJhbSBfYW1vdW50ICAgICAgIGFsbG93YW5jZSBhbW91bnQKICAgICoKICAgICogICBAcmV0dXJuIHRydWUgaWYgdGhlIGFwcHJvdmFsIHdhcyBzdWNjZXNzZnVsCiAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXF1aXJlKChfYW1vdW50ID09IDApIHx8IChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9PSAwKSk7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfYW1vdW50OwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfYW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgIC8qKgogICAgKiAgIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgICoKICAgICogICBAcGFyYW0gX293bmVyICAgICAgICB0aGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcwogICAgKiAgIEBwYXJhbSBfc3BlbmRlciAgICAgIHRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzCiAgICAqCiAgICAqICAgQHJldHVybiAgICAgICAgICAgICAgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWJsZSBmb3IgdGhlIHNwZW5kZXIKICAgICovCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KfQ=='.
	

]
