Class {
	#name : #SRT024cb480c6bf81eea0067c2682a706e5da5c6024,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT024cb480c6bf81eea0067c2682a706e5da5c6024 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgovKioKICogQHRpdGxlIE93bmVkIGNvbnRyYWN0IHdpdGggc2FmZSBvd25lcnNoaXAgcGFzcy4KICoKICogTm90ZTogYWxsIHRoZSBub24gY29uc3RhbnQgZnVuY3Rpb25zIHJldHVybiBmYWxzZSBpbnN0ZWFkIG9mIHRocm93aW5nIGluIGNhc2UgaWYgc3RhdGUgY2hhbmdlCiAqIGRpZG4ndCBoYXBwZW4geWV0LgogKi8KY29udHJhY3QgT3duZWQgewogICAgLyoqCiAgICAgKiBDb250cmFjdCBvd25lciBhZGRyZXNzCiAgICAgKi8KICAgIGFkZHJlc3MgcHVibGljIGNvbnRyYWN0T3duZXI7CgogICAgLyoqCiAgICAgKiBDb250cmFjdCBvd25lciBhZGRyZXNzCiAgICAgKi8KICAgIGFkZHJlc3MgcHVibGljIHBlbmRpbmdDb250cmFjdE93bmVyOwoKICAgIGZ1bmN0aW9uIE93bmVkKCkgewogICAgICAgIGNvbnRyYWN0T3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IE93bmVyIGNoZWNrIG1vZGlmaWVyCiAgICAqLwogICAgbW9kaWZpZXIgb25seUNvbnRyYWN0T3duZXIoKSB7CiAgICAgICAgaWYgKGNvbnRyYWN0T3duZXIgPT0gbXNnLnNlbmRlcikgewogICAgICAgICAgICBfOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgRGVzdHJveSBjb250cmFjdCBhbmQgc2NydWIgYSBkYXRhCiAgICAgKiBAbm90aWNlIE9ubHkgb3duZXIgY2FuIGNhbGwgaXQKICAgICAqLwogICAgZnVuY3Rpb24gZGVzdHJveSgpIG9ubHlDb250cmFjdE93bmVyIHsKICAgICAgICBzdWljaWRlKG1zZy5zZW5kZXIpOwogICAgfQoKICAgIC8qKgogICAgICogUHJlcGFyZXMgb3duZXJzaGlwIHBhc3MuCiAgICAgKgogICAgICogQ2FuIG9ubHkgYmUgY2FsbGVkIGJ5IGN1cnJlbnQgb3duZXIuCiAgICAgKgogICAgICogQHBhcmFtIF90byBhZGRyZXNzIG9mIHRoZSBuZXh0IG93bmVyLiAweDAgaXMgbm90IGFsbG93ZWQuCiAgICAgKgogICAgICogQHJldHVybiBzdWNjZXNzLgogICAgICovCiAgICBmdW5jdGlvbiBjaGFuZ2VDb250cmFjdE93bmVyc2hpcChhZGRyZXNzIF90bykgb25seUNvbnRyYWN0T3duZXIoKSByZXR1cm5zKGJvb2wpIHsKICAgICAgICBpZiAoX3RvICA9PSAweDApIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgcGVuZGluZ0NvbnRyYWN0T3duZXIgPSBfdG87CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBGaW5hbGl6ZSBvd25lcnNoaXAgcGFzcy4KICAgICAqCiAgICAgKiBDYW4gb25seSBiZSBjYWxsZWQgYnkgcGVuZGluZyBvd25lci4KICAgICAqCiAgICAgKiBAcmV0dXJuIHN1Y2Nlc3MuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGNsYWltQ29udHJhY3RPd25lcnNoaXAoKSByZXR1cm5zKGJvb2wpIHsKICAgICAgICBpZiAocGVuZGluZ0NvbnRyYWN0T3duZXIgIT0gbXNnLnNlbmRlcikgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBjb250cmFjdE93bmVyID0gcGVuZGluZ0NvbnRyYWN0T3duZXI7CiAgICAgICAgZGVsZXRlIHBlbmRpbmdDb250cmFjdE93bmVyOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQoKCmNvbnRyYWN0IEVSQzIwSW50ZXJmYWNlIHsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sOwoKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBzdXBwbHkpOwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKTsKfQoKLyoqCiAqIEB0aXRsZSBHZW5lcmljIG93bmVkIGRlc3Ryb3lhYmxlIGNvbnRyYWN0CiAqLwpjb250cmFjdCBPYmplY3QgaXMgT3duZWQgewogICAgLyoqCiAgICAqICBDb21tb24gcmVzdWx0IGNvZGUuIE1lYW5zIGV2ZXJ5dGhpbmcgaXMgZmluZS4KICAgICovCiAgICB1aW50IGNvbnN0YW50IE9LID0gMTsKICAgIHVpbnQgY29uc3RhbnQgT1dORURfQUNDRVNTX0RFTklFRF9PTkxZX0NPTlRSQUNUX09XTkVSID0gODsKCiAgICBmdW5jdGlvbiB3aXRoZHJhd25Ub2tlbnMoYWRkcmVzc1tdIHRva2VucywgYWRkcmVzcyBfdG8pIG9ubHlDb250cmFjdE93bmVyIHJldHVybnModWludCkgewogICAgICAgIGZvcih1aW50IGk9MDtpPHRva2Vucy5sZW5ndGg7aSsrKSB7CiAgICAgICAgICAgIGFkZHJlc3MgdG9rZW4gPSB0b2tlbnNbaV07CiAgICAgICAgICAgIHVpbnQgYmFsYW5jZSA9IEVSQzIwSW50ZXJmYWNlKHRva2VuKS5iYWxhbmNlT2YodGhpcyk7CiAgICAgICAgICAgIGlmKGJhbGFuY2UgIT0gMCkKICAgICAgICAgICAgICAgIEVSQzIwSW50ZXJmYWNlKHRva2VuKS50cmFuc2ZlcihfdG8sYmFsYW5jZSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBPSzsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGVja09ubHlDb250cmFjdE93bmVyKCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyh1aW50KSB7CiAgICAgICAgaWYgKGNvbnRyYWN0T3duZXIgPT0gbXNnLnNlbmRlcikgewogICAgICAgICAgICByZXR1cm4gT0s7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gT1dORURfQUNDRVNTX0RFTklFRF9PTkxZX0NPTlRSQUNUX09XTkVSOwogICAgfQp9CgoKLyoqCiAqIEB0aXRsZSBHZW5lcmFsIE11bHRpRXZlbnRzSGlzdG9yeSB1c2VyLgogKgogKi8KY29udHJhY3QgTXVsdGlFdmVudHNIaXN0b3J5QWRhcHRlciB7CgogICAgLyoqCiAgICAqICAgQGRldiBJdCBpcyBhZGRyZXNzIG9mIE11bHRpRXZlbnRzSGlzdG9yeSBjYWxsZXIgYXNzdW1pbmcgd2UgYXJlIGluc2lkZSBvZiBkZWxlZ2F0ZSBjYWxsLgogICAgKi8KICAgIGZ1bmN0aW9uIF9zZWxmKCkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAoYWRkcmVzcykgewogICAgICAgIHJldHVybiBtc2cuc2VuZGVyOwogICAgfQp9Cgpjb250cmFjdCBEZWxheWVkUGF5bWVudHNFbWl0dGVyIGlzIE11bHRpRXZlbnRzSGlzdG9yeUFkYXB0ZXIgewogICAgZXZlbnQgRXJyb3IoYnl0ZXMzMiBtZXNzYWdlKTsKCiAgICBmdW5jdGlvbiBlbWl0RXJyb3IoYnl0ZXMzMiBfbWVzc2FnZSkgewogICAgICAgIEVycm9yKF9tZXNzYWdlKTsKICAgIH0KfQoKY29udHJhY3QgRGVsYXllZFBheW1lbnRzIGlzIE9iamVjdCB7CiAgIAogICAgdWludCBjb25zdGFudCBERUxBWUVEX1BBWU1FTlRTX1NDT1BFID0gNTIwMDA7CiAgICB1aW50IGNvbnN0YW50IERFTEFZRURfUEFZTUVOVFNfSU5WQUxJRF9JTlZPQ0FUSU9OID0gREVMQVlFRF9QQVlNRU5UU19TQ09QRSArIDE3OwoKICAgIC8vLyBAZGV2IGBQYXltZW50YCBpcyBhIHB1YmxpYyBzdHJ1Y3R1cmUgdGhhdCBkZXNjcmliZXMgdGhlIGRldGFpbHMgb2YKICAgIC8vLyAgZWFjaCBwYXltZW50IG1ha2luZyBpdCBlYXN5IHRvIHRyYWNrIHRoZSBtb3ZlbWVudCBvZiBmdW5kcwogICAgLy8vICB0cmFuc3BhcmVudGx5CiAgICBzdHJ1Y3QgUGF5bWVudCB7CiAgICAgICAgYWRkcmVzcyBzcGVuZGVyOyAgICAgICAgLy8gV2hvIGlzIHNlbmRpbmcgdGhlIGZ1bmRzCiAgICAgICAgdWludCBlYXJsaWVzdFBheVRpbWU7ICAgLy8gVGhlIGVhcmxpZXN0IGEgcGF5bWVudCBjYW4gYmUgbWFkZSAoVW5peCBUaW1lKQogICAgICAgIGJvb2wgY2FuY2VsZWQ7ICAgICAgICAgLy8gSWYgVHJ1ZSB0aGVuIHRoZSBwYXltZW50IGhhcyBiZWVuIGNhbmNlbGVkCiAgICAgICAgYm9vbCBwYWlkOyAgICAgICAgICAgICAgLy8gSWYgVHJ1ZSB0aGVuIHRoZSBwYXltZW50IGhhcyBiZWVuIHBhaWQKICAgICAgICBhZGRyZXNzIHJlY2lwaWVudDsgICAgICAvLyBXaG8gaXMgcmVjZWl2aW5nIHRoZSBmdW5kcwogICAgICAgIHVpbnQgYW1vdW50OyAgICAgICAgICAgIC8vIFRoZSBhbW91bnQgb2Ygd2VpIHNlbnQgaW4gdGhlIHBheW1lbnQKICAgICAgICB1aW50IHNlY3VyaXR5R3VhcmREZWxheTsvLyBUaGUgc2Vjb25kcyBgc2VjdXJpdHlHdWFyZGAgY2FuIGRlbGF5IHBheW1lbnQKICAgIH0KCiAgICBQYXltZW50W10gcHVibGljIGF1dGhvcml6ZWRQYXltZW50czsKCiAgICBhZGRyZXNzIHB1YmxpYyBzZWN1cml0eUd1YXJkOwogICAgdWludCBwdWJsaWMgYWJzb2x1dGVNaW5UaW1lTG9jazsKICAgIHVpbnQgcHVibGljIHRpbWVMb2NrOwogICAgdWludCBwdWJsaWMgbWF4U2VjdXJpdHlHdWFyZERlbGF5OwoKICAgIC8vIFNob3VsZCB1c2UgaW50ZXJmYWNlIG9mIHRoZSBlbWl0dGVyLCBidXQgYWRkcmVzcyBvZiBldmVudHMgaGlzdG9yeS4KICAgIGFkZHJlc3MgcHVibGljIGV2ZW50c0hpc3Rvcnk7CgogICAgLy8vIEBkZXYgVGhlIHdoaXRlIGxpc3Qgb2YgYXBwcm92ZWQgYWRkcmVzc2VzIGFsbG93ZWQgdG8gc2V0IHVwICYmIHJlY2VpdmUKICAgIC8vLyAgcGF5bWVudHMgZnJvbSB0aGlzIHZhdWx0CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBhbGxvd2VkU3BlbmRlcnM7CgogICAgLy8vIEBkZXYgVGhlIGFkZHJlc3MgYXNzaWduZWQgdGhlIHJvbGUgb2YgYHNlY3VyaXR5R3VhcmRgIGlzIHRoZSBvbmx5CiAgICAvLy8gIGFkZHJlc3NlcyB0aGF0IGNhbiBjYWxsIGEgZnVuY3Rpb24gd2l0aCB0aGlzIG1vZGlmaWVyCiAgICBtb2RpZmllciBvbmx5U2VjdXJpdHlHdWFyZCB7IGlmIChtc2cuc2VuZGVyICE9IHNlY3VyaXR5R3VhcmQpIHRocm93OyBfOyB9CgogICAgLy8gQGRldiBFdmVudHMgdG8gbWFrZSB0aGUgcGF5bWVudCBtb3ZlbWVudHMgZWFzeSB0byBmaW5kIG9uIHRoZSBibG9ja2NoYWluCiAgICBldmVudCBQYXltZW50QXV0aG9yaXplZCh1aW50IGluZGV4ZWQgaWRQYXltZW50LCBhZGRyZXNzIGluZGV4ZWQgcmVjaXBpZW50LCB1aW50IGFtb3VudCk7CiAgICBldmVudCBQYXltZW50RXhlY3V0ZWQodWludCBpbmRleGVkIGlkUGF5bWVudCwgYWRkcmVzcyBpbmRleGVkIHJlY2lwaWVudCwgdWludCBhbW91bnQpOwogICAgZXZlbnQgUGF5bWVudENhbmNlbGVkKHVpbnQgaW5kZXhlZCBpZFBheW1lbnQpOwogICAgZXZlbnQgRXRoZXJSZWNlaXZlZChhZGRyZXNzIGluZGV4ZWQgZnJvbSwgdWludCBhbW91bnQpOwogICAgZXZlbnQgU3BlbmRlckF1dGhvcml6YXRpb24oYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIGJvb2wgYXV0aG9yaXplZCk7CgovLy8vLy8vLy8KLy8gQ29uc3RydWN0b3IKLy8vLy8vLy8vCgogICAgLy8vIEBub3RpY2UgVGhlIENvbnN0cnVjdG9yIGNyZWF0ZXMgdGhlIFZhdWx0IG9uIHRoZSBibG9ja2NoYWluCiAgICAvLy8gQHBhcmFtIF9hYnNvbHV0ZU1pblRpbWVMb2NrIFRoZSBtaW5pbXVtIG51bWJlciBvZiBzZWNvbmRzIGB0aW1lbG9ja2AgY2FuCiAgICAvLy8gIGJlIHNldCB0bywgaWYgc2V0IHRvIDAgdGhlIGBvd25lcmAgY2FuIHJlbW92ZSB0aGUgYHRpbWVMb2NrYCBjb21wbGV0ZWx5CiAgICAvLy8gQHBhcmFtIF90aW1lTG9jayBJbml0aWFsIG51bWJlciBvZiBzZWNvbmRzIHRoYXQgcGF5bWVudHMgYXJlIGRlbGF5ZWQKICAgIC8vLyAgYWZ0ZXIgdGhleSBhcmUgYXV0aG9yaXplZCAoYSBzZWN1cml0eSBwcmVjYXV0aW9uKQogICAgLy8vIEBwYXJhbSBfbWF4U2VjdXJpdHlHdWFyZERlbGF5IFRoZSBtYXhpbXVtIG51bWJlciBvZiBzZWNvbmRzIGluIHRvdGFsCiAgICAvLy8gICB0aGF0IGBzZWN1cml0eUd1YXJkYCBjYW4gZGVsYXkgYSBwYXltZW50IHNvIHRoYXQgdGhlIG93bmVyIGNhbiBjYW5jZWwKICAgIC8vLyAgIHRoZSBwYXltZW50IGlmIG5lZWRlZAogICAgZnVuY3Rpb24gRGVsYXllZFBheW1lbnRzKAogICAgICAgIHVpbnQgX2Fic29sdXRlTWluVGltZUxvY2ssCiAgICAgICAgdWludCBfdGltZUxvY2ssCiAgICAgICAgdWludCBfbWF4U2VjdXJpdHlHdWFyZERlbGF5KSAKICAgIHsKICAgICAgICBhYnNvbHV0ZU1pblRpbWVMb2NrID0gX2Fic29sdXRlTWluVGltZUxvY2s7CiAgICAgICAgdGltZUxvY2sgPSBfdGltZUxvY2s7CiAgICAgICAgc2VjdXJpdHlHdWFyZCA9IG1zZy5zZW5kZXI7CiAgICAgICAgbWF4U2VjdXJpdHlHdWFyZERlbGF5ID0gX21heFNlY3VyaXR5R3VhcmREZWxheTsKICAgIH0KCiAgICAvKioKICAgICAqIEVtaXRzIEVycm9yIGV2ZW50IHdpdGggc3BlY2lmaWVkIGVycm9yIG1lc3NhZ2UuCiAgICAgKgogICAgICogU2hvdWxkIG9ubHkgYmUgdXNlZCBpZiBubyBzdGF0ZSBjaGFuZ2VzIGhhcHBlbmVkLgogICAgICoKICAgICAqIEBwYXJhbSBfZXJyb3JDb2RlIGNvZGUgb2YgYW4gZXJyb3IKICAgICAqIEBwYXJhbSBfbWVzc2FnZSBlcnJvciBtZXNzYWdlLgogICAgICovCiAgICBmdW5jdGlvbiBfZXJyb3IodWludCBfZXJyb3JDb2RlLCBieXRlczMyIF9tZXNzYWdlKSBpbnRlcm5hbCByZXR1cm5zKHVpbnQpIHsKICAgICAgICBEZWxheWVkUGF5bWVudHNFbWl0dGVyKGV2ZW50c0hpc3RvcnkpLmVtaXRFcnJvcihfbWVzc2FnZSk7CiAgICAgICAgcmV0dXJuIF9lcnJvckNvZGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXRzIEV2ZW50c0hzdG9yeSBjb250cmFjdCBhZGRyZXNzLgogICAgICoKICAgICAqIENhbiBiZSBzZXQgb25seSBvbmNlLCBhbmQgb25seSBieSBjb250cmFjdCBvd25lci4KICAgICAqCiAgICAgKiBAcGFyYW0gX2V2ZW50c0hpc3RvcnkgTXVsdGlFdmVudHNIaXN0b3J5IGNvbnRyYWN0IGFkZHJlc3MuCiAgICAgKgogICAgICogQHJldHVybiBzdWNjZXNzLgogICAgICovCiAgICBmdW5jdGlvbiBzZXR1cEV2ZW50c0hpc3RvcnkoYWRkcmVzcyBfZXZlbnRzSGlzdG9yeSkgcmV0dXJucyh1aW50IGVycm9yQ29kZSkgewogICAgICAgIGVycm9yQ29kZSA9IGNoZWNrT25seUNvbnRyYWN0T3duZXIoKTsKICAgICAgICBpZiAoZXJyb3JDb2RlICE9IE9LKSB7CiAgICAgICAgICAgIHJldHVybiBlcnJvckNvZGU7CiAgICAgICAgfQogICAgICAgIGlmIChldmVudHNIaXN0b3J5ICE9IDB4MCAmJiBldmVudHNIaXN0b3J5ICE9IF9ldmVudHNIaXN0b3J5KSB7CiAgICAgICAgICAgIHJldHVybiBERUxBWUVEX1BBWU1FTlRTX0lOVkFMSURfSU5WT0NBVElPTjsKICAgICAgICB9CiAgICAgICAgZXZlbnRzSGlzdG9yeSA9IF9ldmVudHNIaXN0b3J5OwogICAgICAgIHJldHVybiBPSzsKICAgIH0KCi8vLy8vLy8vLwovLyBIZWxwZXIgZnVuY3Rpb25zCi8vLy8vLy8vLwoKICAgIC8vLyBAbm90aWNlIFN0YXRlcyB0aGUgdG90YWwgbnVtYmVyIG9mIGF1dGhvcml6ZWQgcGF5bWVudHMgaW4gdGhpcyBjb250cmFjdAogICAgLy8vIEByZXR1cm4gVGhlIG51bWJlciBvZiBwYXltZW50cyBldmVyIGF1dGhvcml6ZWQgZXZlbiBpZiB0aGV5IHdlcmUgY2FuY2VsZWQKICAgIGZ1bmN0aW9uIG51bWJlck9mQXV0aG9yaXplZFBheW1lbnRzKCkgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBhdXRob3JpemVkUGF5bWVudHMubGVuZ3RoOwogICAgfQoKLy8vLy8vCi8vIFJlY2VpdmUgRXRoZXIKLy8vLy8vCgogICAgLy8vIEBub3RpY2UgQ2FsbGVkIGFueXRpbWUgZXRoZXIgaXMgc2VudCB0byB0aGUgY29udHJhY3QgJiYgY3JlYXRlcyBhbiBldmVudAogICAgLy8vIHRvIG1vcmUgZWFzaWx5IHRyYWNrIHRoZSBpbmNvbWluZyB0cmFuc2FjdGlvbnMKICAgIGZ1bmN0aW9uIHJlY2VpdmVFdGhlcigpIHBheWFibGUgewogICAgICAgIEV0aGVyUmVjZWl2ZWQobXNnLnNlbmRlciwgbXNnLnZhbHVlKTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBUaGUgZmFsbCBiYWNrIGZ1bmN0aW9uIGlzIGNhbGxlZCB3aGVuZXZlciBldGhlciBpcyBzZW50IHRvIHRoaXMKICAgIC8vLyAgY29udHJhY3QKICAgIGZ1bmN0aW9uICgpIHBheWFibGUgewogICAgICAgIHJlY2VpdmVFdGhlcigpOwogICAgfQoKLy8vLy8vLy8KLy8gU3BlbmRlciBJbnRlcmZhY2UKLy8vLy8vLy8KCiAgICAvLy8gQG5vdGljZSBvbmx5IGBhbGxvd2VkU3BlbmRlcnNbXWAgQ3JlYXRlcyBhIG5ldyBgUGF5bWVudGAKICAgIC8vLyBAcGFyYW0gX3JlY2lwaWVudCBEZXN0aW5hdGlvbiBvZiB0aGUgcGF5bWVudAogICAgLy8vIEBwYXJhbSBfYW1vdW50IEFtb3VudCB0byBiZSBwYWlkIGluIHdlaQogICAgLy8vIEBwYXJhbSBfcGF5bWVudERlbGF5IE51bWJlciBvZiBzZWNvbmRzIHRoZSBwYXltZW50IGlzIHRvIGJlIGRlbGF5ZWQsIGlmCiAgICAvLy8gIHRoaXMgdmFsdWUgaXMgYmVsb3cgYHRpbWVMb2NrYCB0aGVuIHRoZSBgdGltZUxvY2tgIGRldGVybWluZXMgdGhlIGRlbGF5CiAgICAvLy8gQHJldHVybiBUaGUgUGF5bWVudCBJRCBudW1iZXIgZm9yIHRoZSBuZXcgYXV0aG9yaXplZCBwYXltZW50CiAgICBmdW5jdGlvbiBhdXRob3JpemVQYXltZW50KAogICAgICAgIGFkZHJlc3MgX3JlY2lwaWVudCwKICAgICAgICB1aW50IF9hbW91bnQsCiAgICAgICAgdWludCBfcGF5bWVudERlbGF5CiAgICApIHJldHVybnModWludCkgewoKICAgICAgICAvLyBGYWlsIGlmIHlvdSBhcmVudCBvbiB0aGUgYGFsbG93ZWRTcGVuZGVyc2Agd2hpdGUgbGlzdAogICAgICAgIGlmICghYWxsb3dlZFNwZW5kZXJzW21zZy5zZW5kZXJdKSB0aHJvdzsKICAgICAgICB1aW50IGlkUGF5bWVudCA9IGF1dGhvcml6ZWRQYXltZW50cy5sZW5ndGg7ICAgICAgIC8vIFVuaXF1ZSBQYXltZW50IElECiAgICAgICAgYXV0aG9yaXplZFBheW1lbnRzLmxlbmd0aCsrOwoKICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGxpbmVzIGZpbGwgb3V0IHRoZSBwYXltZW50IHN0cnVjdAogICAgICAgIFBheW1lbnQgcCA9IGF1dGhvcml6ZWRQYXltZW50c1tpZFBheW1lbnRdOwogICAgICAgIHAuc3BlbmRlciA9IG1zZy5zZW5kZXI7CgogICAgICAgIC8vIE92ZXJmbG93IHByb3RlY3Rpb24KICAgICAgICBpZiAoX3BheW1lbnREZWxheSA+IDEwKioxOCkgdGhyb3c7CgogICAgICAgIC8vIERldGVybWluZXMgdGhlIGVhcmxpZXN0IHRoZSByZWNpcGllbnQgY2FuIHJlY2VpdmUgcGF5bWVudCAoVW5peCB0aW1lKQogICAgICAgIHAuZWFybGllc3RQYXlUaW1lID0gX3BheW1lbnREZWxheSA+PSB0aW1lTG9jayA/CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm93ICsgX3BheW1lbnREZWxheSA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm93ICsgdGltZUxvY2s7CiAgICAgICAgcC5yZWNpcGllbnQgPSBfcmVjaXBpZW50OwogICAgICAgIHAuYW1vdW50ID0gX2Ftb3VudDsKICAgICAgICBQYXltZW50QXV0aG9yaXplZChpZFBheW1lbnQsIHAucmVjaXBpZW50LCBwLmFtb3VudCk7CiAgICAgICAgcmV0dXJuIGlkUGF5bWVudDsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBvbmx5IGBhbGxvd2VkU3BlbmRlcnNbXWAgVGhlIHJlY2lwaWVudCBvZiBhIHBheW1lbnQgY2FsbHMgdGhpcwogICAgLy8vICBmdW5jdGlvbiB0byBzZW5kIHRoZW1zZWx2ZXMgdGhlIGV0aGVyIGFmdGVyIHRoZSBgZWFybGllc3RQYXlUaW1lYCBoYXMKICAgIC8vLyAgZXhwaXJlZAogICAgLy8vIEBwYXJhbSBfaWRQYXltZW50IFRoZSBwYXltZW50IElEIHRvIGJlIGV4ZWN1dGVkCiAgICBmdW5jdGlvbiBjb2xsZWN0QXV0aG9yaXplZFBheW1lbnQodWludCBfaWRQYXltZW50KSB7CgogICAgICAgIC8vIENoZWNrIHRoYXQgdGhlIGBfaWRQYXltZW50YCBoYXMgYmVlbiBhZGRlZCB0byB0aGUgcGF5bWVudHMgc3RydWN0CiAgICAgICAgaWYgKF9pZFBheW1lbnQgPj0gYXV0aG9yaXplZFBheW1lbnRzLmxlbmd0aCkgcmV0dXJuOwoKICAgICAgICBQYXltZW50IHAgPSBhdXRob3JpemVkUGF5bWVudHNbX2lkUGF5bWVudF07CgogICAgICAgIC8vIENoZWNraW5nIGZvciByZWFzb25zIG5vdCB0byBleGVjdXRlIHRoZSBwYXltZW50CiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gcC5yZWNpcGllbnQpIHJldHVybjsKICAgICAgICBpZiAobm93IDwgcC5lYXJsaWVzdFBheVRpbWUpIHJldHVybjsKICAgICAgICBpZiAocC5jYW5jZWxlZCkgcmV0dXJuOwogICAgICAgIGlmIChwLnBhaWQpIHJldHVybjsKICAgICAgICBpZiAodGhpcy5iYWxhbmNlIDwgcC5hbW91bnQpIHJldHVybjsKCiAgICAgICAgcC5wYWlkID0gdHJ1ZTsgLy8gU2V0IHRoZSBwYXltZW50IHRvIGJlaW5nIHBhaWQKICAgICAgICBpZiAoIXAucmVjaXBpZW50LnNlbmQocC5hbW91bnQpKSB7ICAvLyBNYWtlIHRoZSBwYXltZW50CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgUGF5bWVudEV4ZWN1dGVkKF9pZFBheW1lbnQsIHAucmVjaXBpZW50LCBwLmFtb3VudCk7CiAgICAgfQoKLy8vLy8vLy8vCi8vIFNlY3VyaXR5R3VhcmQgSW50ZXJmYWNlCi8vLy8vLy8vLwoKICAgIC8vLyBAbm90aWNlIGBvbmx5U2VjdXJpdHlHdWFyZGAgRGVsYXlzIGEgcGF5bWVudCBmb3IgYSBzZXQgbnVtYmVyIG9mIHNlY29uZHMKICAgIC8vLyBAcGFyYW0gX2lkUGF5bWVudCBJRCBvZiB0aGUgcGF5bWVudCB0byBiZSBkZWxheWVkCiAgICAvLy8gQHBhcmFtIF9kZWxheSBUaGUgbnVtYmVyIG9mIHNlY29uZHMgdG8gZGVsYXkgdGhlIHBheW1lbnQKICAgIGZ1bmN0aW9uIGRlbGF5UGF5bWVudCh1aW50IF9pZFBheW1lbnQsIHVpbnQgX2RlbGF5KSBvbmx5U2VjdXJpdHlHdWFyZCB7CiAgICAgICAgaWYgKF9pZFBheW1lbnQgPj0gYXV0aG9yaXplZFBheW1lbnRzLmxlbmd0aCkgdGhyb3c7CgogICAgICAgIC8vIE92ZXJmbG93IHRlc3QKICAgICAgICBpZiAoX2RlbGF5ID4gMTAqKjE4KSB0aHJvdzsKCiAgICAgICAgUGF5bWVudCBwID0gYXV0aG9yaXplZFBheW1lbnRzW19pZFBheW1lbnRdOwoKICAgICAgICBpZiAoKHAuc2VjdXJpdHlHdWFyZERlbGF5ICsgX2RlbGF5ID4gbWF4U2VjdXJpdHlHdWFyZERlbGF5KSB8fAogICAgICAgICAgICAocC5wYWlkKSB8fAogICAgICAgICAgICAocC5jYW5jZWxlZCkpCiAgICAgICAgICAgIHRocm93OwoKICAgICAgICBwLnNlY3VyaXR5R3VhcmREZWxheSArPSBfZGVsYXk7CiAgICAgICAgcC5lYXJsaWVzdFBheVRpbWUgKz0gX2RlbGF5OwogICAgfQoKLy8vLy8vLy8KLy8gT3duZXIgSW50ZXJmYWNlCi8vLy8vLy8KCiAgICAvLy8gQG5vdGljZSBgb25seU93bmVyYCBDYW5jZWwgYSBwYXltZW50IGFsbCB0b2dldGhlcgogICAgLy8vIEBwYXJhbSBfaWRQYXltZW50IElEIG9mIHRoZSBwYXltZW50IHRvIGJlIGNhbmNlbGVkLgogICAgZnVuY3Rpb24gY2FuY2VsUGF5bWVudCh1aW50IF9pZFBheW1lbnQpIG9ubHlDb250cmFjdE93bmVyIHsKICAgICAgICBpZiAoX2lkUGF5bWVudCA+PSBhdXRob3JpemVkUGF5bWVudHMubGVuZ3RoKSB0aHJvdzsKCiAgICAgICAgUGF5bWVudCBwID0gYXV0aG9yaXplZFBheW1lbnRzW19pZFBheW1lbnRdOwoKCiAgICAgICAgaWYgKHAuY2FuY2VsZWQpIHRocm93OwogICAgICAgIGlmIChwLnBhaWQpIHRocm93OwoKICAgICAgICBwLmNhbmNlbGVkID0gdHJ1ZTsKICAgICAgICBQYXltZW50Q2FuY2VsZWQoX2lkUGF5bWVudCk7CiAgICB9CgogICAgLy8vIEBub3RpY2UgYG9ubHlPd25lcmAgQWRkcyBhIHNwZW5kZXIgdG8gdGhlIGBhbGxvd2VkU3BlbmRlcnNbXWAgd2hpdGUgbGlzdAogICAgLy8vIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBvZiB0aGUgY29udHJhY3QgYmVpbmcgYXV0aG9yaXplZC91bmF1dGhvcml6ZWQKICAgIC8vLyBAcGFyYW0gX2F1dGhvcml6ZSBgdHJ1ZWAgaWYgYXV0aG9yaXppbmcgYW5kIGBmYWxzZWAgaWYgdW5hdXRob3JpemluZwogICAgZnVuY3Rpb24gYXV0aG9yaXplU3BlbmRlcihhZGRyZXNzIF9zcGVuZGVyLCBib29sIF9hdXRob3JpemUpIG9ubHlDb250cmFjdE93bmVyIHsKICAgICAgICBhbGxvd2VkU3BlbmRlcnNbX3NwZW5kZXJdID0gX2F1dGhvcml6ZTsKICAgICAgICBTcGVuZGVyQXV0aG9yaXphdGlvbihfc3BlbmRlciwgX2F1dGhvcml6ZSk7CiAgICB9CgogICAgLy8vIEBub3RpY2UgYG9ubHlPd25lcmAgU2V0cyB0aGUgYWRkcmVzcyBvZiBgc2VjdXJpdHlHdWFyZGAKICAgIC8vLyBAcGFyYW0gX25ld1NlY3VyaXR5R3VhcmQgQWRkcmVzcyBvZiB0aGUgbmV3IHNlY3VyaXR5IGd1YXJkCiAgICBmdW5jdGlvbiBzZXRTZWN1cml0eUd1YXJkKGFkZHJlc3MgX25ld1NlY3VyaXR5R3VhcmQpIG9ubHlDb250cmFjdE93bmVyIHsKICAgICAgICBzZWN1cml0eUd1YXJkID0gX25ld1NlY3VyaXR5R3VhcmQ7CiAgICB9CgogICAgLy8vIEBub3RpY2UgYG9ubHlPd25lcmAgQ2hhbmdlcyBgdGltZUxvY2tgOyB0aGUgbmV3IGB0aW1lTG9ja2AgY2Fubm90IGJlCiAgICAvLy8gIGxvd2VyIHRoYW4gYGFic29sdXRlTWluVGltZUxvY2tgCiAgICAvLy8gQHBhcmFtIF9uZXdUaW1lTG9jayBTZXRzIHRoZSBuZXcgbWluaW11bSBkZWZhdWx0IGB0aW1lTG9ja2AgaW4gc2Vjb25kczsKICAgIC8vLyAgcGVuZGluZyBwYXltZW50cyBtYWludGFpbiB0aGVpciBgZWFybGllc3RQYXlUaW1lYAogICAgZnVuY3Rpb24gc2V0VGltZWxvY2sodWludCBfbmV3VGltZUxvY2spIG9ubHlDb250cmFjdE93bmVyIHsKICAgICAgICBpZiAoX25ld1RpbWVMb2NrIDwgYWJzb2x1dGVNaW5UaW1lTG9jaykgdGhyb3c7CiAgICAgICAgdGltZUxvY2sgPSBfbmV3VGltZUxvY2s7CiAgICB9CgogICAgLy8vIEBub3RpY2UgYG9ubHlPd25lcmAgQ2hhbmdlcyB0aGUgbWF4aW11bSBudW1iZXIgb2Ygc2Vjb25kcwogICAgLy8vIGBzZWN1cml0eUd1YXJkYCBjYW4gZGVsYXkgYSBwYXltZW50CiAgICAvLy8gQHBhcmFtIF9tYXhTZWN1cml0eUd1YXJkRGVsYXkgVGhlIG5ldyBtYXhpbXVtIGRlbGF5IGluIHNlY29uZHMgdGhhdAogICAgLy8vICBgc2VjdXJpdHlHdWFyZGAgY2FuIGRlbGF5IHRoZSBwYXltZW50J3MgZXhlY3V0aW9uIGluIHRvdGFsCiAgICBmdW5jdGlvbiBzZXRNYXhTZWN1cml0eUd1YXJkRGVsYXkodWludCBfbWF4U2VjdXJpdHlHdWFyZERlbGF5KSBvbmx5Q29udHJhY3RPd25lciB7CiAgICAgICAgbWF4U2VjdXJpdHlHdWFyZERlbGF5ID0gX21heFNlY3VyaXR5R3VhcmREZWxheTsKICAgIH0KfQoKCmNvbnRyYWN0IEFzc2V0IHsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sOwoKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBzdXBwbHkpOwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKTsKfQoKY29udHJhY3QgQnV5QmFja0VtaXR0ZXIgewogICAgZnVuY3Rpb24gZW1pdEVycm9yKHVpbnQgZXJyb3JDb2RlKTsKICAgIGZ1bmN0aW9uIGVtaXRQcmljZXNVcGRhdGVkKHVpbnQgYnV5UHJpY2UsIHVpbnQgc2VsbFByaWNlKTsKICAgIGZ1bmN0aW9uIGVtaXRBY3RpdmVDaGFuZ2VkKGJvb2wgaXNBY3RpdmUpOwp9CgoKY29udHJhY3QgQnV5QmFjayBpcyBPYmplY3QgewoKICAgIHVpbnQgY29uc3RhbnQgRVJST1JfRVhDSEFOR0VfSU5WQUxJRF9QQVJBTUVURVIgPSA2MDAwOwogICAgdWludCBjb25zdGFudCBFUlJPUl9FWENIQU5HRV9JTlZBTElEX0lOVk9DQVRJT04gPSA2MDAxOwogICAgdWludCBjb25zdGFudCBFUlJPUl9FWENIQU5HRV9JTlZBTElEX0ZFRV9QRVJDRU5UID0gNjAwMjsKICAgIHVpbnQgY29uc3RhbnQgRVJST1JfRVhDSEFOR0VfSU5WQUxJRF9QUklDRSA9IDYwMDM7CiAgICB1aW50IGNvbnN0YW50IEVSUk9SX0VYQ0hBTkdFX01BSU5URU5BTkNFX01PREUgPSA2MDA0OwogICAgdWludCBjb25zdGFudCBFUlJPUl9FWENIQU5HRV9UT09fSElHSF9QUklDRSA9IDYwMDU7CiAgICB1aW50IGNvbnN0YW50IEVSUk9SX0VYQ0hBTkdFX1RPT19MT1dfUFJJQ0UgPSA2MDA2OwogICAgdWludCBjb25zdGFudCBFUlJPUl9FWENIQU5HRV9JTlNVRkZJQ0lFTlRfQkFMQU5DRSA9IDYwMDc7CiAgICB1aW50IGNvbnN0YW50IEVSUk9SX0VYQ0hBTkdFX0lOU1VGRklDSUVOVF9FVEhFUl9TVVBQTFkgPSA2MDA4OwogICAgdWludCBjb25zdGFudCBFUlJPUl9FWENIQU5HRV9QQVlNRU5UX0ZBSUxFRCA9IDYwMDk7CiAgICB1aW50IGNvbnN0YW50IEVSUk9SX0VYQ0hBTkdFX1RSQU5TRkVSX0ZBSUxFRCA9IDYwMTA7CiAgICB1aW50IGNvbnN0YW50IEVSUk9SX0VYQ0hBTkdFX0ZFRV9UUkFOU0ZFUl9GQUlMRUQgPSA2MDExOwogICAgdWludCBjb25zdGFudCBFUlJPUl9FWENIQU5HRV9ERUxBWUVEUEFZTUVOVFNfQUNDRVNTID0gNjAxMjsKCiAgICAvLyBBc3NpZ25lZCBFUkMyMCB0b2tlbi4KICAgIEFzc2V0IHB1YmxpYyBhc3NldDsKICAgIERlbGF5ZWRQYXltZW50cyBwdWJsaWMgZGVsYXllZFBheW1lbnRzOwogICAgLy9Td2l0Y2ggZm9yIHR1cm4gb24gYW5kIG9mZiB0aGUgZXhjaGFuZ2Ugb3BlcmF0aW9ucwogICAgYm9vbCBwdWJsaWMgaXNBY3RpdmU7CiAgICAvLyBQcmljZSBpbiB3ZWkgYXQgd2hpY2ggZXhjaGFuZ2UgYnV5cyB0b2tlbnMuCiAgICB1aW50IHB1YmxpYyBidXlQcmljZSA9IDE7CiAgICAvLyBQcmljZSBpbiB3ZWkgYXQgd2hpY2ggZXhjaGFuZ2Ugc2VsbHMgdG9rZW5zLgogICAgdWludCBwdWJsaWMgc2VsbFByaWNlID0gMjU3MDczNTM5MTAwMDAwMDsgLy8gODAlIGZyb20gRVRIL1VTRD0zMTEuMTk1MAogICAgdWludCBwdWJsaWMgbWluQW1vdW50OwogICAgdWludCBwdWJsaWMgbWF4QW1vdW50OwogICAgLy8gVXNlciBzb2xkIHRva2VucyBhbmQgcmVjZWl2ZWQgd2VpLgogICAgZXZlbnQgU2VsbChhZGRyZXNzIGluZGV4ZWQgd2hvLCB1aW50IHRva2VuLCB1aW50IGV0aCk7CiAgICAvLyBVc2VyIGJvdWdodCB0b2tlbnMgYW5kIHBheWVkIHdlaS4KICAgIGV2ZW50IEJ1eShhZGRyZXNzIGluZGV4ZWQgd2hvLCB1aW50IHRva2VuLCB1aW50IGV0aCk7CiAgICBldmVudCBXaXRoZHJhd1Rva2VucyhhZGRyZXNzIGluZGV4ZWQgcmVjaXBpZW50LCB1aW50IGFtb3VudCk7CiAgICBldmVudCBXaXRoZHJhd0V0aChhZGRyZXNzIGluZGV4ZWQgcmVjaXBpZW50LCB1aW50IGFtb3VudCk7CiAgICBldmVudCBQcmljZXNVcGRhdGVkKGFkZHJlc3MgaW5kZXhlZCBzZWxmLCB1aW50IGJ1eVByaWNlLCB1aW50IHNlbGxQcmljZSk7CiAgICBldmVudCBBY3RpdmVDaGFuZ2VkKGFkZHJlc3MgaW5kZXhlZCBzZWxmLCBib29sIGlzQWN0aXZlKTsKICAgIGV2ZW50IEVycm9yKHVpbnQgZXJyb3JDb2RlKTsKCiAgICAvKioKICAgICAqIEBkZXYgT24gcmVjZWl2ZWQgZXRoZXJzCiAgICAgKiBAcGFyYW0gc2VuZGVyIEV0aGVyIHNlbmRlcgogICAgICogQHBhcmFtIGFtb3VudCBFdGhlciB2YWx1ZQogICAgICovCiAgICBldmVudCBSZWNlaXZlZEV0aGVyKGFkZHJlc3MgaW5kZXhlZCBzZW5kZXIsIHVpbnQyNTYgaW5kZXhlZCBhbW91bnQpOwoKICAgIC8vIFNob3VsZCB1c2UgaW50ZXJmYWNlIG9mIHRoZSBlbWl0dGVyLCBidXQgYWRkcmVzcyBvZiBldmVudHMgaGlzdG9yeS4KICAgIEJ1eUJhY2tFbWl0dGVyIHB1YmxpYyBldmVudHNIaXN0b3J5OwoKICAgIC8qKgogICAgICogRW1pdHMgRXJyb3IgZXZlbnQgd2l0aCBzcGVjaWZpZWQgZXJyb3IgbWVzc2FnZS4KICAgICAqCiAgICAgKiBTaG91bGQgb25seSBiZSB1c2VkIGlmIG5vIHN0YXRlIGNoYW5nZXMgaGFwcGVuZWQuCiAgICAgKgogICAgICogQHBhcmFtIGVycm9yIGVycm9yIGZyb20gRXJyb3JzIGxpYnJhcnkuCiAgICAgKi8KICAgIGZ1bmN0aW9uIF9lcnJvcih1aW50IGVycm9yKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgZ2V0RXZlbnRzSGlzdG9yeSgpLmVtaXRFcnJvcihlcnJvcik7CiAgICAgICAgcmV0dXJuIGVycm9yOwogICAgfQoKICAgIGZ1bmN0aW9uIF9lbWl0UHJpY2VzVXBkYXRlZCh1aW50IGJ1eVByaWNlLCB1aW50IHNlbGxQcmljZSkgaW50ZXJuYWwgewogICAgICAgIGdldEV2ZW50c0hpc3RvcnkoKS5lbWl0UHJpY2VzVXBkYXRlZChidXlQcmljZSwgc2VsbFByaWNlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfZW1pdEFjdGl2ZUNoYW5nZWQoYm9vbCBpc0FjdGl2ZSkgaW50ZXJuYWwgewogICAgICAgIGdldEV2ZW50c0hpc3RvcnkoKS5lbWl0QWN0aXZlQ2hhbmdlZChpc0FjdGl2ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXRzIEV2ZW50c0hzdG9yeSBjb250cmFjdCBhZGRyZXNzLgogICAgICoKICAgICAqIENhbiBiZSBzZXQgb25seSBvbmNlLCBhbmQgb25seSBieSBjb250cmFjdCBvd25lci4KICAgICAqCiAgICAgKiBAcGFyYW0gX2V2ZW50c0hpc3RvcnkgTXVsdGlFdmVudHNIaXN0b3J5IGNvbnRyYWN0IGFkZHJlc3MuCiAgICAgKgogICAgICogQHJldHVybiBzdWNjZXNzLgogICAgICovCiAgICBmdW5jdGlvbiBzZXR1cEV2ZW50c0hpc3RvcnkoYWRkcmVzcyBfZXZlbnRzSGlzdG9yeSkgb25seUNvbnRyYWN0T3duZXIgcmV0dXJucyAodWludCkgewogICAgICAgIGlmIChhZGRyZXNzKGV2ZW50c0hpc3RvcnkpICE9IDB4MCkgewogICAgICAgICAgICByZXR1cm4gX2Vycm9yKEVSUk9SX0VYQ0hBTkdFX0lOVkFMSURfSU5WT0NBVElPTik7CiAgICAgICAgfQoKICAgICAgICBldmVudHNIaXN0b3J5ID0gQnV5QmFja0VtaXR0ZXIoX2V2ZW50c0hpc3RvcnkpOwogICAgICAgIHJldHVybiBPSzsKICAgIH0KCiAgICAvKioKICAgICAqIEFzc2lnbnMgRVJDMjAgdG9rZW4gZm9yIGV4Y2hhbmdlLgogICAgICoKICAgICAqIENhbiBiZSBzZXQgb25seSBvbmNlLCBhbmQgb25seSBieSBjb250cmFjdCBvd25lci4KICAgICAqCiAgICAgKiBAcGFyYW0gX2Fzc2V0IEVSQzIwIHRva2VuIGFkZHJlc3MuCiAgICAgKgogICAgICogQHJldHVybiBzdWNjZXNzLgogICAgICovCiAgICBmdW5jdGlvbiBpbml0KEFzc2V0IF9hc3NldCwgRGVsYXllZFBheW1lbnRzIF9kZWxheWVkUGF5bWVudHMpIG9ubHlDb250cmFjdE93bmVyIHJldHVybnMgKHVpbnQgZXJyb3JDb2RlKSB7CiAgICAgICAgaWYgKGFkZHJlc3MoYXNzZXQpICE9IDB4MCB8fCBhZGRyZXNzKGRlbGF5ZWRQYXltZW50cykgIT0gMHgwKSB7CiAgICAgICAgICAgIHJldHVybiBfZXJyb3IoRVJST1JfRVhDSEFOR0VfSU5WQUxJRF9JTlZPQ0FUSU9OKTsKICAgICAgICB9CgogICAgICAgIGFzc2V0ID0gX2Fzc2V0OwogICAgICAgIGRlbGF5ZWRQYXltZW50cyA9IF9kZWxheWVkUGF5bWVudHM7CiAgICAgICAgaXNBY3RpdmUgPSB0cnVlOwogICAgICAgIHJldHVybiBPSzsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRBY3RpdmUoYm9vbCBfYWN0aXZlKSBvbmx5Q29udHJhY3RPd25lciByZXR1cm5zICh1aW50KSB7CiAgICAgICAgaWYgKGlzQWN0aXZlICE9IF9hY3RpdmUpIHsKICAgICAgICAgICAgX2VtaXRBY3RpdmVDaGFuZ2VkKF9hY3RpdmUpOwogICAgICAgIH0KCiAgICAgICAgaXNBY3RpdmUgPSBfYWN0aXZlOwogICAgICAgIHJldHVybiBPSzsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCBleGNoYW5nZSBvcGVyYXRpb24gcHJpY2VzLgogICAgICogU2VsbCBwcmljZSBjYW5ub3QgYmUgbGVzcyB0aGFuIGJ1eSBwcmljZS4KICAgICAqCiAgICAgKiBDYW4gYmUgc2V0IG9ubHkgYnkgY29udHJhY3Qgb3duZXIuCiAgICAgKgogICAgICogQHBhcmFtIF9idXlQcmljZSBwcmljZSBpbiB3ZWkgYXQgd2hpY2ggZXhjaGFuZ2UgYnV5cyB0b2tlbnMuCiAgICAgKiBAcGFyYW0gX3NlbGxQcmljZSBwcmljZSBpbiB3ZWkgYXQgd2hpY2ggZXhjaGFuZ2Ugc2VsbHMgdG9rZW5zLgogICAgICoKICAgICAqIEByZXR1cm4gc3VjY2Vzcy4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0UHJpY2VzKHVpbnQgX2J1eVByaWNlLCB1aW50IF9zZWxsUHJpY2UpIG9ubHlDb250cmFjdE93bmVyIHJldHVybnMgKHVpbnQpIHsKICAgICAgICBpZiAoX3NlbGxQcmljZSA8IF9idXlQcmljZSkgewogICAgICAgICAgICByZXR1cm4gX2Vycm9yKEVSUk9SX0VYQ0hBTkdFX0lOVkFMSURfUFJJQ0UpOwogICAgICAgIH0KCiAgICAgICAgYnV5UHJpY2UgPSBfYnV5UHJpY2U7CiAgICAgICAgc2VsbFByaWNlID0gX3NlbGxQcmljZTsKICAgICAgICBfZW1pdFByaWNlc1VwZGF0ZWQoX2J1eVByaWNlLCBfc2VsbFByaWNlKTsKCiAgICAgICAgcmV0dXJuIE9LOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyBhc3NpZ25lZCB0b2tlbiBhZGRyZXNzIGJhbGFuY2UuCiAgICAgKgogICAgICogQHBhcmFtIF9hZGRyZXNzIGFkZHJlc3MgdG8gZ2V0IGJhbGFuY2UuCiAgICAgKgogICAgICogQHJldHVybiB0b2tlbiBiYWxhbmNlLgogICAgICovCiAgICBmdW5jdGlvbiBfYmFsYW5jZU9mKGFkZHJlc3MgX2FkZHJlc3MpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gYXNzZXQuYmFsYW5jZU9mKF9hZGRyZXNzKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNlbGwgdG9rZW5zIGZvciBldGhlciBhdCBzcGVjaWZpZWQgcHJpY2UuIFRva2VucyBhcmUgdGFrZW4gZnJvbSBjYWxsZXIKICAgICAqIHRob3VnaCBhbiBhbGxvd2FuY2UgbG9naWMuCiAgICAgKiBBbW91bnQgc2hvdWxkIGJlIGxlc3MgdGhhbiBvciBlcXVhbCB0byBjdXJyZW50IGFsbG93YW5jZSB2YWx1ZS4KICAgICAqIFByaWNlIHNob3VsZCBiZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gY3VycmVudCBleGNoYW5nZSBidXlQcmljZS4KICAgICAqCiAgICAgKiBAcGFyYW0gX2Ftb3VudCBhbW91bnQgb2YgdG9rZW5zIHRvIHNlbGwuCiAgICAgKiBAcGFyYW0gX3ByaWNlIHByaWNlIGluIHdlaSBhdCB3aGljaCBzZWxsIHdpbGwgaGFwcGVuLgogICAgICoKICAgICAqIEByZXR1cm4gc3VjY2Vzcy4KICAgICAqLwogICAgZnVuY3Rpb24gc2VsbCh1aW50IF9hbW91bnQsIHVpbnQgX3ByaWNlKSByZXR1cm5zICh1aW50KSB7CiAgICAgICAgaWYgKCFpc0FjdGl2ZSkgewogICAgICAgICAgICByZXR1cm4gX2Vycm9yKEVSUk9SX0VYQ0hBTkdFX01BSU5URU5BTkNFX01PREUpOwogICAgICAgIH0KCiAgICAgICAgaWYgKF9wcmljZSA+IGJ1eVByaWNlKSB7CiAgICAgICAgICAgIHJldHVybiBfZXJyb3IoRVJST1JfRVhDSEFOR0VfVE9PX0hJR0hfUFJJQ0UpOwogICAgICAgIH0KCiAgICAgICAgaWYgKF9iYWxhbmNlT2YobXNnLnNlbmRlcikgPCBfYW1vdW50KSB7CiAgICAgICAgICAgIHJldHVybiBfZXJyb3IoRVJST1JfRVhDSEFOR0VfSU5TVUZGSUNJRU5UX0JBTEFOQ0UpOwogICAgICAgIH0KCiAgICAgICAgdWludCB0b3RhbCA9IF9tdWwoX2Ftb3VudCwgX3ByaWNlKTsKICAgICAgICBpZiAodGhpcy5iYWxhbmNlIDwgdG90YWwpIHsKICAgICAgICAgICAgcmV0dXJuIF9lcnJvcihFUlJPUl9FWENIQU5HRV9JTlNVRkZJQ0lFTlRfRVRIRVJfU1VQUExZKTsKICAgICAgICB9CgogICAgICAgIGlmICghYXNzZXQudHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIHRoaXMsIF9hbW91bnQpKSB7CiAgICAgICAgICAgIHJldHVybiBfZXJyb3IoRVJST1JfRVhDSEFOR0VfUEFZTUVOVF9GQUlMRUQpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFkZWxheWVkUGF5bWVudHMuc2VuZCh0b3RhbCkpIHsKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgfQogICAgICAgIGlmICghZGVsYXllZFBheW1lbnRzLmFsbG93ZWRTcGVuZGVycyh0aGlzKSkgewogICAgICAgICAgICB0aHJvdzsKICAgICAgICB9CiAgICAgICAgZGVsYXllZFBheW1lbnRzLmF1dGhvcml6ZVBheW1lbnQobXNnLnNlbmRlcix0b3RhbCwxIGhvdXJzKTsgCiAgICAgICAgU2VsbChtc2cuc2VuZGVyLCBfYW1vdW50LCB0b3RhbCk7CgogICAgICAgIHJldHVybiBPSzsKICAgIH0KCiAgICAvKioKICAgICAqIFRyYW5zZmVyIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIGZyb20gZXhjaGFuZ2UgdG8gc3BlY2lmaWVkIGFkZHJlc3MuCiAgICAgKgogICAgICogQ2FuIGJlIGNhbGxlZCBvbmx5IGJ5IGNvbnRyYWN0IG93bmVyLgogICAgICoKICAgICAqIEBwYXJhbSBfcmVjaXBpZW50IGFkZHJlc3MgdG8gdHJhbnNmZXIgdG9rZW5zIHRvLgogICAgICogQHBhcmFtIF9hbW91bnQgYW1vdW50IG9mIHRva2VucyB0byB0cmFuc2Zlci4KICAgICAqCiAgICAgKiBAcmV0dXJuIHN1Y2Nlc3MuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHdpdGhkcmF3VG9rZW5zKGFkZHJlc3MgX3JlY2lwaWVudCwgdWludCBfYW1vdW50KSBvbmx5Q29udHJhY3RPd25lciByZXR1cm5zICh1aW50KSB7CiAgICAgICAgaWYgKF9iYWxhbmNlT2YodGhpcykgPCBfYW1vdW50KSB7CiAgICAgICAgICAgIHJldHVybiBfZXJyb3IoRVJST1JfRVhDSEFOR0VfSU5TVUZGSUNJRU5UX0JBTEFOQ0UpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFhc3NldC50cmFuc2ZlcihfcmVjaXBpZW50LCBfYW1vdW50KSkgewogICAgICAgICAgICByZXR1cm4gX2Vycm9yKEVSUk9SX0VYQ0hBTkdFX1RSQU5TRkVSX0ZBSUxFRCk7CiAgICAgICAgfQoKICAgICAgICBXaXRoZHJhd1Rva2VucyhfcmVjaXBpZW50LCBfYW1vdW50KTsKCiAgICAgICAgcmV0dXJuIE9LOwogICAgfQoKICAgIC8qKgogICAgICogVHJhbnNmZXIgYWxsIHRva2VucyBmcm9tIGV4Y2hhbmdlIHRvIHNwZWNpZmllZCBhZGRyZXNzLgogICAgICoKICAgICAqIENhbiBiZSBjYWxsZWQgb25seSBieSBjb250cmFjdCBvd25lci4KICAgICAqCiAgICAgKiBAcGFyYW0gX3JlY2lwaWVudCBhZGRyZXNzIHRvIHRyYW5zZmVyIHRva2VucyB0by4KICAgICAqCiAgICAgKiBAcmV0dXJuIHN1Y2Nlc3MuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHdpdGhkcmF3QWxsVG9rZW5zKGFkZHJlc3MgX3JlY2lwaWVudCkgb25seUNvbnRyYWN0T3duZXIgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiB3aXRoZHJhd1Rva2VucyhfcmVjaXBpZW50LCBfYmFsYW5jZU9mKHRoaXMpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRyYW5zZmVyIHNwZWNpZmllZCBhbW91bnQgb2Ygd2VpIGZyb20gZXhjaGFuZ2UgdG8gc3BlY2lmaWVkIGFkZHJlc3MuCiAgICAgKgogICAgICogQ2FuIGJlIGNhbGxlZCBvbmx5IGJ5IGNvbnRyYWN0IG93bmVyLgogICAgICoKICAgICAqIEBwYXJhbSBfcmVjaXBpZW50IGFkZHJlc3MgdG8gdHJhbnNmZXIgd2VpIHRvLgogICAgICogQHBhcmFtIF9hbW91bnQgYW1vdW50IG9mIHdlaSB0byB0cmFuc2Zlci4KICAgICAqCiAgICAgKiBAcmV0dXJuIHN1Y2Nlc3MuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHdpdGhkcmF3RXRoKGFkZHJlc3MgX3JlY2lwaWVudCwgdWludCBfYW1vdW50KSBvbmx5Q29udHJhY3RPd25lciByZXR1cm5zICh1aW50KSB7CiAgICAgICAgaWYgKHRoaXMuYmFsYW5jZSA8IF9hbW91bnQpIHsKICAgICAgICAgICAgcmV0dXJuIF9lcnJvcihFUlJPUl9FWENIQU5HRV9JTlNVRkZJQ0lFTlRfRVRIRVJfU1VQUExZKTsKICAgICAgICB9CgogICAgICAgIGlmICghX3JlY2lwaWVudC5zZW5kKF9hbW91bnQpKSB7CiAgICAgICAgICAgIHJldHVybiBfZXJyb3IoRVJST1JfRVhDSEFOR0VfVFJBTlNGRVJfRkFJTEVEKTsKICAgICAgICB9CgogICAgICAgIFdpdGhkcmF3RXRoKF9yZWNpcGllbnQsIF9hbW91bnQpOwoKICAgICAgICByZXR1cm4gT0s7CiAgICB9CgogICAgLyoqCiAgICAgKiBUcmFuc2ZlciBhbGwgd2VpIGZyb20gZXhjaGFuZ2UgdG8gc3BlY2lmaWVkIGFkZHJlc3MuCiAgICAgKgogICAgICogQ2FuIGJlIGNhbGxlZCBvbmx5IGJ5IGNvbnRyYWN0IG93bmVyLgogICAgICoKICAgICAqIEBwYXJhbSBfcmVjaXBpZW50IGFkZHJlc3MgdG8gdHJhbnNmZXIgd2VpIHRvLgogICAgICoKICAgICAqIEByZXR1cm4gc3VjY2Vzcy4KICAgICAqLwogICAgZnVuY3Rpb24gd2l0aGRyYXdBbGxFdGgoYWRkcmVzcyBfcmVjaXBpZW50KSBvbmx5Q29udHJhY3RPd25lcigpIHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gd2l0aGRyYXdFdGgoX3JlY2lwaWVudCwgdGhpcy5iYWxhbmNlKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRyYW5zZmVyIGFsbCB0b2tlbnMgYW5kIHdlaSBmcm9tIGV4Y2hhbmdlIHRvIHNwZWNpZmllZCBhZGRyZXNzLgogICAgICoKICAgICAqIENhbiBiZSBjYWxsZWQgb25seSBieSBjb250cmFjdCBvd25lci4KICAgICAqCiAgICAgKiBAcGFyYW0gX3JlY2lwaWVudCBhZGRyZXNzIHRvIHRyYW5zZmVyIHRva2VucyBhbmQgd2VpIHRvLgogICAgICoKICAgICAqIEByZXR1cm4gc3VjY2Vzcy4KICAgICAqLwogICAgZnVuY3Rpb24gd2l0aGRyYXdBbGwoYWRkcmVzcyBfcmVjaXBpZW50KSBvbmx5Q29udHJhY3RPd25lciByZXR1cm5zICh1aW50KSB7CiAgICAgICAgdWludCB3aXRoZHJhd0FsbFRva2Vuc1Jlc3VsdCA9IHdpdGhkcmF3QWxsVG9rZW5zKF9yZWNpcGllbnQpOwogICAgICAgIGlmICh3aXRoZHJhd0FsbFRva2Vuc1Jlc3VsdCAhPSBPSykgewogICAgICAgICAgICByZXR1cm4gd2l0aGRyYXdBbGxUb2tlbnNSZXN1bHQ7CiAgICAgICAgfQoKICAgICAgICB1aW50IHdpdGhkcmF3QWxsRXRoUmVzdWx0ID0gd2l0aGRyYXdBbGxFdGgoX3JlY2lwaWVudCk7CiAgICAgICAgaWYgKHdpdGhkcmF3QWxsRXRoUmVzdWx0ICE9IE9LKSB7CiAgICAgICAgICAgIHJldHVybiB3aXRoZHJhd0FsbEV0aFJlc3VsdDsKICAgICAgICB9CgogICAgICAgIHJldHVybiBPSzsKICAgIH0KCiAgICBmdW5jdGlvbiBlbWl0RXJyb3IodWludCBlcnJvckNvZGUpIHsKICAgICAgICBFcnJvcihlcnJvckNvZGUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGVtaXRQcmljZXNVcGRhdGVkKHVpbnQgYnV5UHJpY2UsIHVpbnQgc2VsbFByaWNlKSB7CiAgICAgICAgUHJpY2VzVXBkYXRlZChtc2cuc2VuZGVyLCBidXlQcmljZSwgc2VsbFByaWNlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBlbWl0QWN0aXZlQ2hhbmdlZChib29sIGlzQWN0aXZlKSB7CiAgICAgICAgQWN0aXZlQ2hhbmdlZChtc2cuc2VuZGVyLCBpc0FjdGl2ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RXZlbnRzSGlzdG9yeSgpIGNvbnN0YW50IHJldHVybnMgKEJ1eUJhY2tFbWl0dGVyKSB7CiAgICAgICAgcmV0dXJuIGFkZHJlc3MoZXZlbnRzSGlzdG9yeSkgIT0gMHgwID8gZXZlbnRzSGlzdG9yeSA6IEJ1eUJhY2tFbWl0dGVyKHRoaXMpOwogICAgfQogICAgLyoqCiAgICAgKiBPdmVyZmxvdy1zYWZlIG11bHRpcGxpY2F0aW9uLgogICAgICoKICAgICAqIFRocm93cyBpbiBjYXNlIG9mIHZhbHVlIG92ZXJmbG93LgogICAgICoKICAgICAqIEBwYXJhbSBfYSBmaXJzdCBvcGVyYW5kLgogICAgICogQHBhcmFtIF9iIHNlY29uZCBvcGVyYW5kLgogICAgICoKICAgICAqIEByZXR1cm4gbXVsdGlwbGljYXRpb24gcmVzdWx0LgogICAgICovCiAgICBmdW5jdGlvbiBfbXVsKHVpbnQgX2EsIHVpbnQgX2IpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICB1aW50IHJlc3VsdCA9IF9hICogX2I7CiAgICAgICAgaWYgKF9hICE9IDAgJiYgcmVzdWx0IC8gX2EgIT0gX2IpIHsKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBBY2NlcHQgYWxsIGV0aGVyIHRvIG1haW50YWluIGV4Y2hhbmdlIHN1cHBseS4KICAgICAqLwogICAgZnVuY3Rpb24oKSBwYXlhYmxlIHsKICAgICAgICBpZiAobXNnLnZhbHVlICE9IDApIHsKICAgICAgICAgICAgUmVjZWl2ZWRFdGhlcihtc2cuc2VuZGVyLCBtc2cudmFsdWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KICAgIH0KfQ=='.
	

]
