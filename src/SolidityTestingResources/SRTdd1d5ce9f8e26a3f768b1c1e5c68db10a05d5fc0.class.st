Class {
	#name : #SRTdd1d5ce9f8e26a3f768b1c1e5c68db10a05d5fc0,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTdd1d5ce9f8e26a3f768b1c1e5c68db10a05d5fc0 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTY7CgoKLyoqCiAqIEB0aXRsZSBXZUJldENyeXB0bwogKiBAYXV0aG9yIEFMX1gKICogQGRldiBUaGUgV0JDIEVSQy0yMjMgVG9rZW4gQ29udHJhY3QKICovCmNvbnRyYWN0IFdlQmV0Q3J5cHRvIHsKICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICJXZSBCZXQgQ3J5cHRvIjsKICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIldCQyI7CgkKICAgIGFkZHJlc3MgcHVibGljIHNlbGZBZGRyZXNzOwogICAgYWRkcmVzcyBwdWJsaWMgYWRtaW47CiAgICBhZGRyZXNzW10gcHJpdmF0ZSB1c2VyczsKCQogICAgdWludDggcHVibGljIGRlY2ltYWxzID0gNzsKICAgIHVpbnQyNTYgcHVibGljIHJlbGF0aXZlRGF0ZVNhdmU7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbEZ1bmRzOwogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHkgPSAzMDAwMDAwMDAwMDAwMDA7CiAgICB1aW50MjU2IHB1YmxpYyBwcmljZVBlckV0aGVyOwogICAgdWludDI1NiBwcml2YXRlIGFtb3VudEluQ2lyY3VsYXRpb247CiAgICB1aW50MjU2IHByaXZhdGUgY3VycmVudFByb2ZpdHM7CiAgICB1aW50MjU2IHByaXZhdGUgY3VycmVudEl0ZXJhdGlvbjsKCXVpbnQyNTYgcHJpdmF0ZSBhY3R1YWxQcm9maXRTcGxpdDsKCQogICAgYm9vbCBwdWJsaWMgREFwcFJlYWR5OwogICAgYm9vbCBwdWJsaWMgaXNGcm96ZW47Cglib29sIHB1YmxpYyBzcGxpdEluU2VydmljZSA9IHRydWU7Cglib29sIHByaXZhdGUgaGFzSUNPUnVuOwogICAgYm9vbCBwcml2YXRlIHJ1bm5pbmc7Cglib29sWzRdIHByaXZhdGUgZGV2QXBwcm92YWxzOwoJCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgbW9udGhseUxpbWl0OwoJCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgaXNBZGRlZDsKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBmcmVlemVVc2VyOwoJCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CgltYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGNvb2xkb3duOwoJCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKICAgIGV2ZW50IEN1cnJlbnRUTFNOUHJvb2YoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBzdHJpbmcgX3Byb29mKTsKICAgIAoJLyoqCgkgKiBAbm90aWNlIEVuc3VyZXMgYWRtaW4gaXMgY2FsbGVyCgkgKi8KICAgIG1vZGlmaWVyIGlzQWRtaW4oKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkbWluKTsKICAgICAgICAvL0NvbnRpbnVlIGV4ZWN1dGluZyByZXN0IG9mIG1ldGhvZCBib2R5CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgLyoqCgkgKiBAbm90aWNlIFJlLWVudHJ5IHByb3RlY3Rpb24KCSAqLwogICAgbW9kaWZpZXIgaXNSdW5uaW5nKCkgewogICAgICAgIHJlcXVpcmUoIXJ1bm5pbmcpOwogICAgICAgIHJ1bm5pbmcgPSB0cnVlOwogICAgICAgIF87CiAgICAgICAgcnVubmluZyA9IGZhbHNlOwogICAgfQogICAgCgkvKioKCSAqIEBub3RpY2UgRW5zdXJlcyBzeXN0ZW0gaXNuJ3QgZnJvemVuCgkgKi8KICAgIG1vZGlmaWVyIHJlcXVpcmVUaGF3KCkgewogICAgICAgIHJlcXVpcmUoIWlzRnJvemVuKTsKICAgICAgICBfOwogICAgfQogICAgCgkvKioKCSAqIEBub3RpY2UgRW5zdXJlcyBwbGF5ZXIgaXNuJ3QgbG9nZ2VkIGluIG9uIHBsYXRmb3JtCgkgKi8KICAgIG1vZGlmaWVyIHVzZXJOb3RQbGF5aW5nKGFkZHJlc3MgX3VzZXIpIHsKICAgICAgICByZXF1aXJlKCFmcmVlemVVc2VyW191c2VyXSk7CiAgICAgICAgXzsKICAgIH0KCQoJLyoqCgkgKiBAbm90aWNlIEVuc3VyZXMgZnVuY3Rpb24gcnVucyBvbmx5IG9uY2UKCSAqLwoJbW9kaWZpZXIgb25lVGltZSgpIHsKCQlyZXF1aXJlKCFoYXNJQ09SdW4pOwoJCV87Cgl9CiAgICAKCS8qKgoJICogQG5vdGljZSBFbnN1cmVzIFdCQyBEQXBwIGlzIG9ubGluZQoJICovCiAgICBtb2RpZmllciBEQXBwT25saW5lKCkgewogICAgICAgIHJlcXVpcmUoREFwcFJlYWR5KTsKICAgICAgICBfOwogICAgfQogICAgCiAgICAvKioKCSAqIEBub3RpY2UgU2FmZU1hdGggTGlicmFyeSBzYWZlU3ViIEltcG9ydAoJICogQGRldiAKCSAgICAgICAgU2luY2Ugd2UgYXJlIGRlYWxpbmcgd2l0aCBhIGxpbWl0ZWQgY3VycmVuY3kKCSAgICAgICAgY2lyY3VsYXRpb24gb2YgMzAgbWlsbGlvbiB0b2tlbnMgYW5kIHZhbHVlcwoJICAgICAgICB0aGF0IHdpbGwgbm90IHN1cnBhc3MgdGhlIHVpbnQyNTYgbGltaXQsIG9ubHkKCSAgICAgICAgc2FmZVN1YiBpcyByZXF1aXJlZCB0byBwcmV2ZW50IHVuZGVyZmxvd3MuCgkgKi8KICAgIGZ1bmN0aW9uIHNhZmVTdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgeikgewogICAgICAgIGFzc2VydCgoeiA9IGEgLSBiKSA8PSBhKTsKICAgIH0KCQoJLyoqCgkgKiBAbm90aWNlIFdCQyBDb25zdHJ1Y3RvcgoJICogQGRldiAKCSAgICAgICAgQ29uc3RydWN0b3IgZnVuY3Rpb24gY29udGFpbmluZyBwcm9wZXIgaW5pdGlhbGl6YXRpb25zIHN1Y2ggYXMgCgkgICAgICAgIHRva2VuIGRpc3RyaWJ1dGlvbiB0byB0aGUgdGVhbSBtZW1iZXJzIGFuZCBwdXNoaW5nIHRoZSBmaXJzdCAKCSAgICAgICAgcHJvZml0IHNwbGl0IHRvIDYgbW9udGhzIHdoZW4gdGhlIERBcHAgd2lsbCBhbHJlYWR5IGJlIGxpdmUuCgkgKi8KICAgIGZ1bmN0aW9uIFdlQmV0Q3J5cHRvKCkgewogICAgICAgIGFkbWluID0gbXNnLnNlbmRlcjsKICAgICAgICBiYWxhbmNlc1sweDE2NkNiNDg5NzNDMjQ0N2RhZkZBOEVGZDM1MjZkYTE4MDc2MDg4ZGVdID0gMjI1MDAwMDAwMDAwMDA7CiAgICAgICAgYWRkVXNlcigweDE2NkNiNDg5NzNDMjQ0N2RhZkZBOEVGZDM1MjZkYTE4MDc2MDg4ZGUpOwogICAgICAgIGJhbGFuY2VzWzB4RTU5Q2JEMDI4ZjcxNDQ3QjgwNEYzMUNmMGZDNDFGMGU1RTEzZjRiRl0gPSAxNTAwMDAwMDAwMDAwMDsKICAgICAgICBhZGRVc2VyKDB4RTU5Q2JEMDI4ZjcxNDQ3QjgwNEYzMUNmMGZDNDFGMGU1RTEzZjRiRik7CiAgICAgICAgYmFsYW5jZXNbMHgxYWIxM0QyQzFBQzQzMDM3Mzc5ODFDZThCOGJENTExNkM4NGM3NDRkXSA9IDUwMDAwMDAwMDAwMDA7CiAgICAgICAgYWRkVXNlcigweDFhYjEzRDJDMUFDNDMwMzczNzk4MUNlOEI4YkQ1MTE2Qzg0Yzc0NGQpOwogICAgICAgIGJhbGFuY2VzWzB4MDY5MDhEZjM4OUNmMjU4OTM3NWI2OTA4RDBiMWM4RmNDMzQ3MjFCNV0gPSAyNTAwMDAwMDAwMDAwOwogICAgICAgIGFkZFVzZXIoMHgwNjkwOERmMzg5Q2YyNTg5Mzc1YjY5MDhEMGIxYzhGY0MzNDcyMUI1KTsKICAgICAgICBiYWxhbmNlc1sweEVkQmQ0YzY3NTdEQzQyNTMyMTU4NGE5MWJEQjM1NUNlNjVjNDJiMTNdID0gMjUwMDAwMDAwMDAwMDsKICAgICAgICBhZGRVc2VyKDB4RWRCZDRjNjc1N0RDNDI1MzIxNTg0YTkxYkRCMzU1Q2U2NWM0MmIxMyk7CiAgICAgICAgYmFsYW5jZXNbMHg0MzA5RmI0QjMxYUE2Njc2NzNkNjlkYjEwNzJFNmRjRDUwRmQ4ODU4XSA9IDI1MDAwMDAwMDAwMDA7CiAgICAgICAgYWRkVXNlcigweDQzMDlGYjRCMzFhQTY2NzY3M2Q2OWRiMTA3MkU2ZGNENTBGZDg4NTgpOwogICAgICAgIHNlbGZBZGRyZXNzID0gdGhpczsKICAgICAgICByZWxhdGl2ZURhdGVTYXZlID0gbm93ICsgMTgwIGRheXM7CiAgICAgICAgcHJpY2VQZXJFdGhlciA9IDMzMjA5OwogICAgICAgIGJhbGFuY2VzW3NlbGZBZGRyZXNzXSA9IDI1MDAwMDAwMDAwMDAwMDsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBAbm90aWNlIENoZWNrIHRoZSBuYW1lIG9mIHRoZSB0b2tlbiB+IEVSQy0yMCBTdGFuZGFyZAogICAgICogQHJldHVybiB7CgkJCQkJIl9uYW1lIjogIlRoZSB0b2tlbiBuYW1lIgoJCQkJfQogICAgICovCiAgICBmdW5jdGlvbiBuYW1lKCkgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoc3RyaW5nIF9uYW1lKSB7CiAgICAgICAgcmV0dXJuIG5hbWU7CiAgICB9CiAgICAKCS8qKgogICAgICogQG5vdGljZSBDaGVjayB0aGUgc3ltYm9sIG9mIHRoZSB0b2tlbiB+IEVSQy0yMCBTdGFuZGFyZAogICAgICogQHJldHVybiB7CgkJCQkJIl9zeW1ib2wiOiAiVGhlIHRva2VuIHN5bWJvbCIKCQkJCX0KICAgICAqLwogICAgZnVuY3Rpb24gc3ltYm9sKCkgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoc3RyaW5nIF9zeW1ib2wpIHsKICAgICAgICByZXR1cm4gc3ltYm9sOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEBub3RpY2UgQ2hlY2sgdGhlIGRlY2ltYWxzIG9mIHRoZSB0b2tlbiB+IEVSQy0yMCBTdGFuZGFyZAogICAgICogQHJldHVybiB7CgkJCQkJIl9kZWNpbWFscyI6ICJUaGUgdG9rZW4gZGVjaW1hbHMiCgkJCQl9CiAgICAgKi8KICAgIGZ1bmN0aW9uIGRlY2ltYWxzKCkgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDggX2RlY2ltYWxzKSB7CiAgICAgICAgcmV0dXJuIGRlY2ltYWxzOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEBub3RpY2UgQ2hlY2sgdGhlIHRvdGFsIHN1cHBseSBvZiB0aGUgdG9rZW4gfiBFUkMtMjAgU3RhbmRhcmQKICAgICAqIEByZXR1cm4gewoJCQkJCSJfdG90YWxTdXBwbHkiOiAiVG90YWwgc3VwcGx5IG9mIHRva2VucyIKCQkJCX0KICAgICAqLwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBleHRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IF90b3RhbFN1cHBseSkgewogICAgICAgIHJldHVybiB0b3RhbFN1cHBseTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBAbm90aWNlIFF1ZXJ5IHRoZSBhdmFpbGFibGUgYmFsYW5jZSBvZiBhbiBhZGRyZXNzIH4gRVJDLTIwIFN0YW5kYXJkCgkgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHdob3NlIGJhbGFuY2Ugd2Ugd2lzaCB0byByZXRyaWV2ZQogICAgICogQHJldHVybiB7CgkJCQkJImJhbGFuY2UiOiAiQmFsYW5jZSBvZiB0aGUgYWRkcmVzcyIKCQkJCX0KICAgICAqLwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBleHRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KCQoJLyoqCgkgKiBAbm90aWNlIFF1ZXJ5IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoZSBzcGVuZGVyIGFkZHJlc3MgY2FuIHdpdGhkcmF3IGZyb20gdGhlIG93bmVyIGFkZHJlc3MgfiBFUkMtMjAgU3RhbmRhcmQKCSAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3Mgd2hvIG93bnMgdGhlIHRva2VucwoJICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdobyBjYW4gd2l0aGRyYXcgdGhlIHRva2VucwoJICogQHJldHVybiB7CgkJCQkJInJlbWFpbmluZyI6ICJSZW1haW5pbmcgd2l0aGRyYXdhbCBhbW91bnQiCgkJCQl9CiAgICAgKi8KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBAbm90aWNlIFRyYW5zZmVyIHRva2VucyBmcm9tIGFuIGFkZHJlc3MgdG8gYW5vdGhlciB+IEVSQy0yMCBTdGFuZGFyZAoJICogQGRldiAKCSAgICAgICAgQWRqdXN0cyB0aGUgbW9udGhseSBsaW1pdCBpbiBjYXNlIHRoZSBfZnJvbSBhZGRyZXNzIGlzIHRoZSBDYXNpbm8KCSAgICAgICAgYW5kIGVuc3VyZXMgdGhhdCB0aGUgdXNlciBpc24ndCBsb2dnZWQgaW4gd2hlbiByZXRyaWV2aW5nIGZ1bmRzCgkgICAgICAgIHNvIGFzIHRvIHByZXZlbnQgYWdhaW5zdCBhIHJhY2UgYXR0YWNrIHdpdGggdGhlIENhc2luby4KICAgICAqIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyB3aG9zZSBiYWxhbmNlIHdlIHdpbGwgdHJhbnNmZXIKICAgICAqIEBwYXJhbSBfdG8gVGhlIHJlY2lwaWVudCBhZGRyZXNzCgkgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIGV4dGVybmFsIHJlcXVpcmVUaGF3IHVzZXJOb3RQbGF5aW5nKF90bykgewoJCXJlcXVpcmUoY29vbGRvd25bX2Zyb21dW190b10gPD0gbm93KTsKICAgICAgICB2YXIgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW190b107CiAgICAgICAgaWYgKF9mcm9tID09IHNlbGZBZGRyZXNzKSB7CiAgICAgICAgICAgIG1vbnRobHlMaW1pdFtfdG9dID0gc2FmZVN1Yihtb250aGx5TGltaXRbX3RvXSwgX3ZhbHVlKTsKICAgICAgICB9CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10rX3ZhbHVlOwogICAgICAgIGJhbGFuY2VzW19mcm9tXSA9IHNhZmVTdWIoYmFsYW5jZXNbX2Zyb21dLCBfdmFsdWUpOwogICAgICAgIGFsbG93ZWRbX2Zyb21dW190b10gPSBzYWZlU3ViKF9hbGxvd2FuY2UsIF92YWx1ZSk7CiAgICAgICAgYWRkVXNlcihfdG8pOwogICAgICAgIGJ5dGVzIG1lbW9yeSBlbXB0eTsKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUsIGVtcHR5KTsKICAgIH0KICAgIAogICAgLyoqCgkgKiBAbm90aWNlIEF1dGhvcml6ZSBhbiBhZGRyZXNzIHRvIHJldHJpZXZlIGZ1bmRzIGZyb20geW91IH4gRVJDLTIwIFN0YW5kYXJkCgkgKiBAZGV2IAoJICAgICAgICBFYWNoIGFwcHJvdmFsIGNvbWVzIHdpdGggYSBkZWZhdWx0IGNvb2xkb3duIG9mIDMwIG1pbnV0ZXMKCSAgICAgICAgdG8gcHJldmVudCBhZ2FpbnN0IHRoZSBFUkMtMjAgcmFjZSBhdHRhY2suCgkgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3MgeW91IHdpc2ggdG8gYXV0aG9yaXplCgkgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHlvdSB3aXNoIHRvIGF1dGhvcml6ZQoJICovCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBleHRlcm5hbCB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CgkJY29vbGRvd25bbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gbm93ICsgMzAgbWludXRlczsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIH0KCQoJLyoqCgkgKiBAbm90aWNlIEF1dGhvcml6ZSBhbiBhZGRyZXNzIHRvIHJldHJpZXZlIGZ1bmRzIGZyb20geW91IHdpdGggYSBjdXN0b20gY29vbGRvd24gfiBFUkMtMjAgU3RhbmRhcmQKCSAqIEBkZXYgQWxsb3dpbmcgY3VzdG9tIGNvb2xkb3duIGZvciB0aGUgRVJDLTIwIHJhY2UgYXR0YWNrIHByZXZlbnRpb24uCgkgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3MgeW91IHdpc2ggdG8gYXV0aG9yaXplCgkgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHlvdSB3aXNoIHRvIGF1dGhvcml6ZQoJICogQHBhcmFtIF9jb29sZG93biBUaGUgYW1vdW50IG9mIHNlY29uZHMgdGhlIHJlY2lwaWVudCBuZWVkcyB0byB3YWl0IGJlZm9yZSB3aXRoZHJhd2luZyB0aGUgYmFsYW5jZQoJICovCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlLCB1aW50MjU2IF9jb29sZG93bikgZXh0ZXJuYWwgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwoJCWNvb2xkb3duW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG5vdyArIF9jb29sZG93bjsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIH0KICAgIAogICAgLyoqCgkgKiBAbm90aWNlIFRyYW5zZmVyIHRoZSBzcGVjaWZpZWQgYW1vdW50IHRvIHRoZSB0YXJnZXQgYWRkcmVzcyB+IEVSQy0yMCBTdGFuZGFyZAoJICogQGRldiAKCSAgICAgICAgQSBib29sZWFuIGlzIHJldHVybmVkIHNvIHRoYXQgY2FsbGVycyBvZiB0aGUgZnVuY3Rpb24gCgkgICAgICAgIHdpbGwga25vdyBpZiB0aGVpciB0cmFuc2FjdGlvbiB3ZW50IHRocm91Z2guCgkgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHlvdSB3aXNoIHRvIHNlbmQgdGhlIHRva2VucyB0bwoJICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB5b3Ugd2lzaCB0byBzZW5kCgkgKiBAcmV0dXJuIHsKCQkJCQkic3VjY2VzcyI6ICJUcmFuc2FjdGlvbiBzdWNjZXNzIgoJCQkJfQogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIGV4dGVybmFsIGlzUnVubmluZyByZXF1aXJlVGhhdyByZXR1cm5zIChib29sIHN1Y2Nlc3MpewogICAgICAgIGJ5dGVzIG1lbW9yeSBlbXB0eTsKICAgICAgICBpZiAoX3RvID09IHNlbGZBZGRyZXNzKSB7CiAgICAgICAgICAgIHJldHVybiB0cmFuc2ZlclRvU2VsZihfdmFsdWUsIGVtcHR5KTsKICAgICAgICB9IGVsc2UgaWYgKGlzQ29udHJhY3QoX3RvKSkgewogICAgICAgICAgICByZXR1cm4gdHJhbnNmZXJUb0NvbnRyYWN0KF90bywgX3ZhbHVlLCBlbXB0eSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIHRyYW5zZmVyVG9BZGRyZXNzKF90bywgX3ZhbHVlLCBlbXB0eSk7CiAgICAgICAgfQogICAgfQogICAgCiAgICAvKioKCSAqIEBub3RpY2UgQ2hlY2sgd2hldGhlciBhZGRyZXNzIGlzIGEgY29udHJhY3QgfiBFUkMtMjIzIFByb3Bvc2VkIFN0YW5kYXJkCgkgKiBAcGFyYW0gX2FkZHJlc3MgVGhlIGFkZHJlc3MgdG8gY2hlY2sKCSAqIEByZXR1cm4gewoJCQkJCSJpc19jb250cmFjdCI6ICJSZXN1bHQgb2YgcXVlcnkiCgkJCQl9CiAgICAgKi8KICAgIGZ1bmN0aW9uIGlzQ29udHJhY3QoYWRkcmVzcyBfYWRkcmVzcykgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCBpc19jb250cmFjdCkgewogICAgICAgIHVpbnQgbGVuZ3RoOwogICAgICAgIGFzc2VtYmx5IHsKICAgICAgICAgICAgbGVuZ3RoIDo9IGV4dGNvZGVzaXplKF9hZGRyZXNzKQogICAgICAgIH0KICAgICAgICByZXR1cm4gbGVuZ3RoID4gMDsKICAgIH0KICAgIAogICAgLyoqCgkgKiBAbm90aWNlIFRyYW5zZmVyIHRoZSBzcGVjaWZpZWQgYW1vdW50IHRvIHRoZSB0YXJnZXQgYWRkcmVzcyB3aXRoIGVtYmVkZGVkIGJ5dGVzIGRhdGEgfiBFUkMtMjIzIFByb3Bvc2VkIFN0YW5kYXJkCgkgKiBAZGV2IEluY2x1ZGVzIGFuIGV4dHJhIHRyYW5zZmVyVG9TZWxmIGZ1bmN0aW9uIHRvIGhhbmRsZSBDYXNpbm8gZGVwb3NpdHMKCSAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8KCSAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gdHJhbnNmZXIKCSAqIEBwYXJhbSBfZGF0YSBBbnkgZXh0cmEgZW1iZWRkZWQgZGF0YSBvZiB0aGUgdHJhbnNhY3Rpb24KCSAqIEByZXR1cm4gewoJCQkJCSJzdWNjZXNzIjogIlRyYW5zYWN0aW9uIHN1Y2Nlc3MiCgkJCQl9CiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2RhdGEpIGV4dGVybmFsIGlzUnVubmluZyByZXF1aXJlVGhhdyByZXR1cm5zIChib29sIHN1Y2Nlc3MpewogICAgICAgIGlmIChfdG8gPT0gc2VsZkFkZHJlc3MpIHsKICAgICAgICAgICAgcmV0dXJuIHRyYW5zZmVyVG9TZWxmKF92YWx1ZSwgX2RhdGEpOwogICAgICAgIH0gZWxzZSBpZiAoaXNDb250cmFjdChfdG8pKSB7CiAgICAgICAgICAgIHJldHVybiB0cmFuc2ZlclRvQ29udHJhY3QoX3RvLCBfdmFsdWUsIF9kYXRhKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gdHJhbnNmZXJUb0FkZHJlc3MoX3RvLCBfdmFsdWUsIF9kYXRhKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8qKgoJICogQG5vdGljZSBIYW5kbGVzIHRyYW5zZmVyIHRvIGFuIEVDQSAoRXh0ZXJuYWxseSBDb250cm9sbGVkIEFjY291bnQpLCBhIG5vcm1hbCBhY2NvdW50IH4gRVJDLTIyMyBQcm9wb3NlZCBTdGFuZGFyZAoJICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0bwoJICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byB0cmFuc2ZlcgoJICogQHBhcmFtIF9kYXRhIEFueSBleHRyYSBlbWJlZGRlZCBkYXRhIG9mIHRoZSB0cmFuc2FjdGlvbgoJICogQHJldHVybiB7CgkJCQkJInN1Y2Nlc3MiOiAiVHJhbnNhY3Rpb24gc3VjY2VzcyIKCQkJCX0KICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJUb0FkZHJlc3MoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBzYWZlU3ViKGJhbGFuY2VzW21zZy5zZW5kZXJdLCBfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dK192YWx1ZTsKICAgICAgICBhZGRVc2VyKF90byk7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUsIF9kYXRhKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIAogICAgLyoqCgkgKiBAbm90aWNlIEhhbmRsZXMgdHJhbnNmZXIgdG8gYSBjb250cmFjdCB+IEVSQy0yMjMgUHJvcG9zZWQgU3RhbmRhcmQKCSAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8KCSAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gdHJhbnNmZXIKCSAqIEBwYXJhbSBfZGF0YSBBbnkgZXh0cmEgZW1iZWRkZWQgZGF0YSBvZiB0aGUgdHJhbnNhY3Rpb24KCSAqIEByZXR1cm4gewoJCQkJCSJzdWNjZXNzIjogIlRyYW5zYWN0aW9uIHN1Y2Nlc3MiCgkJCQl9CiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyVG9Db250cmFjdChhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9kYXRhKSBpbnRlcm5hbCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHNhZmVTdWIoYmFsYW5jZXNbbXNnLnNlbmRlcl0sIF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10rX3ZhbHVlOwogICAgICAgIFdlQmV0Q3J5cHRvIHJlYyA9IFdlQmV0Q3J5cHRvKF90byk7CiAgICAgICAgcmVjLnRva2VuRmFsbGJhY2sobXNnLnNlbmRlciwgX3ZhbHVlLCBfZGF0YSk7CiAgICAgICAgYWRkVXNlcihfdG8pOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlLCBfZGF0YSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIC8qKgoJICogQG5vdGljZSBIYW5kbGVzIENhc2lubyBkZXBvc2l0cyB+IEN1c3RvbSBFUkMtMjIzIFByb3Bvc2VkIFN0YW5kYXJkIEFkZGl0aW9uCgkgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIHRyYW5zZmVyCgkgKiBAcGFyYW0gX2RhdGEgQW55IGV4dHJhIGVtYmVkZGVkIGRhdGEgb2YgdGhlIHRyYW5zYWN0aW9uCgkgKiBAcmV0dXJuIHsKCQkJCQkic3VjY2VzcyI6ICJUcmFuc2FjdGlvbiBzdWNjZXNzIgoJCQkJfQogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlclRvU2VsZih1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2RhdGEpIGludGVybmFsIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gc2FmZVN1YihiYWxhbmNlc1ttc2cuc2VuZGVyXSwgX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tzZWxmQWRkcmVzc10gPSBiYWxhbmNlc1tzZWxmQWRkcmVzc10rX3ZhbHVlOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIHNlbGZBZGRyZXNzLCBfdmFsdWUsIF9kYXRhKTsKCQlhbGxvd2VkW3NlbGZBZGRyZXNzXVttc2cuc2VuZGVyXSA9IF92YWx1ZSArIGFsbG93ZWRbc2VsZkFkZHJlc3NdW21zZy5zZW5kZXJdOwoJCUFwcHJvdmFsKHNlbGZBZGRyZXNzLCBtc2cuc2VuZGVyLCBhbGxvd2VkW3NlbGZBZGRyZXNzXVttc2cuc2VuZGVyXSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgkKCS8qKgoJICogQG5vdGljZSBFbXB0eSB0b2tlbkZhbGxiYWNrIG1ldGhvZCB0byBlbnN1cmUgRVJDLTIyMyBjb21wYXRpYmlsaXR5CgkgKiBAcGFyYW0gX3NlbmRlciBUaGUgYWRkcmVzcyB3aG8gc2VudCB0aGUgRVJDLTIyMyB0b2tlbnMKCSAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdGhlIGFkZHJlc3Mgc2VudCB0byB0aGlzIGNvbnRyYWN0CgkgKiBAcGFyYW0gX2RhdGEgQW55IGVtYmVkZGVkIGRhdGEgb2YgdGhlIHRyYW5zYWN0aW9uCgkgKi8KCWZ1bmN0aW9uIHRva2VuRmFsbGJhY2soYWRkcmVzcyBfc2VuZGVyLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2RhdGEpIHt9CgkKCS8qKgoJICogQG5vdGljZSBDaGVjayB0aGUgY29vbGRvd24gcmVtYWluaW5nIHVudGlsIHRoZSBhbGxvd2VlIGNhbiB3aXRoZHJhdyB0aGUgYmFsYW5jZQoJICogQHBhcmFtIF9hbGxvd2VyIFRoZSBob2xkZXIgb2YgdGhlIGJhbGFuY2UKCSAqIEBwYXJhbSBfYWxsb3dlZSBUaGUgcmVjaXBpZW50IG9mIHRoZSBiYWxhbmNlCgkgKiBAcmV0dXJuIHsKCQkJCQkicmVtYWluaW5nIjogIkNvb2xkb3duIHJlbWFpbmluZyBpbiBzZWNvbmRzIgoJCQkJfQogICAgICovCglmdW5jdGlvbiBjaGVja0Nvb2xkb3duKGFkZHJlc3MgX2FsbG93ZXIsIGFkZHJlc3MgX2FsbG93ZWUpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CgkJaWYgKGNvb2xkb3duW19hbGxvd2VyXVtfYWxsb3dlZV0gPiBub3cpIHsKCQkJcmV0dXJuIChjb29sZG93bltfYWxsb3dlcl1bX2FsbG93ZWVdIC0gbm93KTsKCQl9IGVsc2UgewoJCQlyZXR1cm4gMDsKCQl9Cgl9CgkKCS8qKgoJICogQG5vdGljZSBDaGVjayBob3cgbXVjaCBDYXNpbm8gd2l0aGRyYXdhbCBiYWxhbmNlIHJlbWFpbnMgZm9yIGFkZHJlc3MKCSAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gY2hlY2sKCSAqIEByZXR1cm4gewoJCQkJCSJyZW1haW5pbmciOiAiV2l0aGRyYXdhbCBiYWxhbmNlIHJlbWFpbmluZyIKCQkJCX0KICAgICAqLwogICAgZnVuY3Rpb24gY2hlY2tNb250aGx5TGltaXQoYWRkcmVzcyBfb3duZXIpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICAgICAgcmV0dXJuIG1vbnRobHlMaW1pdFtfb3duZXJdOwogICAgfQoJCgkvKioKCSAqIEBub3RpY2UgUmV0cmlldmUgRVJDIFRva2VucyBzZW50IHRvIGNvbnRyYWN0CgkgKiBAZGV2IEZlZWwgZnJlZSB0byBjb250YWN0IHVzIGFuZCByZXRyaWV2ZSB5b3VyIEVSQyB0b2tlbnMgc2hvdWxkIHlvdSB3aXNoIHNvLgoJICogQHBhcmFtIF90b2tlbiBUaGUgdG9rZW4gY29udHJhY3QgYWRkcmVzcwoJICovCiAgICBmdW5jdGlvbiBjbGFpbVRva2VucyhhZGRyZXNzIF90b2tlbikgaXNBZG1pbiBleHRlcm5hbCB7IAoJCXJlcXVpcmUoX3Rva2VuICE9IHNlbGZBZGRyZXNzKTsKICAgICAgICBXZUJldENyeXB0byB0b2tlbiA9IFdlQmV0Q3J5cHRvKF90b2tlbik7IAogICAgICAgIHVpbnQgYmFsYW5jZSA9IHRva2VuLmJhbGFuY2VPZihzZWxmQWRkcmVzcyk7IAogICAgICAgIHRva2VuLnRyYW5zZmVyKGFkbWluLCBiYWxhbmNlKTsgCiAgICB9CiAgICAKCS8qKgoJICogQG5vdGljZSBGcmVlemUgdG9rZW4gY2lyY3VsYXRpb24gLSBzcGxpdFByb2ZpdHMgaW50ZXJuYWwKCSAqIEBkZXYgCgkgICAgICAgIEVuc3VyZXMgdGhhdCBvbmUgZG9lc24ndCB0cmFuc2ZlciBoaXMgdG90YWwgYmFsYW5jZSBtaWQtc3BsaXQgdG8gCgkgICAgICAgIGFuIGFjY291bnQgbGF0ZXIgaW4gdGhlIHNwbGl0IHF1ZXVlIGluIG9yZGVyIHRvIHJlY2VpdmUgdHdpY2UgdGhlCgkgICAgICAgIG1vbnRobHkgcHJvZml0cwoJICovCiAgICBmdW5jdGlvbiBhc3NldEZyZWV6ZSgpIGludGVybmFsIHsKICAgICAgICBpc0Zyb3plbiA9IHRydWU7CiAgICB9CiAgICAKCS8qKgoJICogQG5vdGljZSBSZS1lbmFibGUgdG9rZW4gY2lyY3VsYXRpb24gLSBzcGxpdFByb2ZpdHMgaW50ZXJuYWwKCSAqLwogICAgZnVuY3Rpb24gYXNzZXRUaGF3KCkgaW50ZXJuYWwgewogICAgICAgIGlzRnJvemVuID0gZmFsc2U7CiAgICB9CiAgICAKCS8qKgoJICogQG5vdGljZSBGcmVlemUgdG9rZW4gY2lyY3VsYXRpb24KCSAqIEBkZXYgVG8gYmUgdXNlZCBvbmx5IGluIGV4dHJlbWUgY2lyY3Vtc3RhbmNlcy4KCSAqLwogICAgZnVuY3Rpb24gZW1lcmdlbmN5RnJlZXplKCkgaXNBZG1pbiBleHRlcm5hbCB7CiAgICAgICAgaXNGcm96ZW4gPSB0cnVlOwogICAgfQogICAgCgkvKioKCSAqIEBub3RpY2UgUmUtZW5hYmxlIHRva2VuIGNpcmN1bGF0aW9uCgkgKiBAZGV2IFRvIGJlIHVzZWQgb25seSBpbiBleHRyZW1lIGNpcmN1bXN0YW5jZXMKCSAqLwogICAgZnVuY3Rpb24gZW1lcmdlbmN5VGhhdygpIGlzQWRtaW4gZXh0ZXJuYWwgewogICAgICAgIGlzRnJvemVuID0gZmFsc2U7CiAgICB9CgkKCS8qKgoJICogQG5vdGljZSBEaXNhYmxlIHRoZSBzcGxpdHRpbmcgZnVuY3Rpb24KCSAqIEBkZXYgCgkgICAgICAgIFRvIGJlIHVzZWQgaW4gY2FzZSB0aGUgc3lzdGVtIGlzIHVwZ3JhZGVkIHRvIGEgCgkgICAgICAgIG5vZGUuanMgb3BlcmF0ZWQgcHJvZml0IHJld2FyZCBzeXN0ZW0gdmlhIHRoZSAKCQkJYWx0ZXJCYW5rQmFsYW5jZSBmdW5jdGlvbi4gRW5zdXJlcyBzY2FsYWJpbGl0eSAKCQkJaW4gY2FzZSB1c2VyYmFzZSBnZXRzIHRvbyBiaWcuCgkgKi8KCWZ1bmN0aW9uIGVtZXJnZW5jeVNwbGl0VG9nZ2xlKCkgZXh0ZXJuYWwgewoJCXNwbGl0SW5TZXJ2aWNlID0gIXNwbGl0SW5TZXJ2aWNlOwoJfQogICAgCgkvKioKCSAqIEBub3RpY2UgQWRqdXN0IHRoZSBwcmljZSBvZiBFdGhlciBhY2NvcmRpbmcgdG8gQ29pbiBNYXJrZXQgQ2FwJ3MgQVBJCgkgKiBAZGV2IAoJICAgICAgICBUaGUgc3ViZm9sZGVyIGlzIHB1YmxpYyBkb21haW4gc28gYW55b25lIGNhbiB2ZXJpZnkgdGhhdCB3ZSBpbmRlZWQgZ290IHRoZSBwcmljZQoJICAgICAgICBmcm9tIGEgdHJ1c3RlZCBzb3VyY2UgYXQgdGhlIHRpbWUgd2UgdXBkYXRlZCBpdC4gMiBkZWNpbWFsIHByZWNpc2lvbiBpcyBhY2hpZXZlZAoJICAgICAgICBieSBtdWx0aXBseWluZyB0aGUgcHJpY2Ugb2YgRXRoZXIgYnkgMTAwIGFuZCB0aGVuIG9mZnNldHRpbmcgdGhlIG11bHRpcGxpY2F0aW9uCgkgICAgICAgIGluIHRoZSBjYWxjdWxhdGlvbiB0aGUgcHJpY2UgaXMgdXNlZCBpbi4gVGhlIFRMU05vdGFyeVByb29mIHN0cmluZyBjYW4gYmUgYWRkZWQKCSAgICAgICAgdG8gdGhlIGVuZCBvZiBodHRwczovL3dlYmV0Y3J5cHRvLmlvL1RMU05vdGFyeS8gdG8gZ2V0IHRoZSBwZXJzcGVjdGl2ZSBUTFMgcHJvb2YuCgkgKiBAcGFyYW0gbmV3UHJpY2UgVGhlIG5ldyBFdGhlcmV1bSBwcmljZSB3aXRoIDIgZGVjaW1hbCBwcmVjaXNpb24KCSAqIEBwYXJhbSBUTFNOb3RhcnlQcm9vZiBUaGUgd2ViZXRjcnlwdG8uaW8gc3ViZm9sZGVyIHRoZSBUTFNOb3RhcnkgcHJvb2YgaXMgc3RvcmVkCgkgKi8KICAgIGZ1bmN0aW9uIHNldFByaWNlT2ZFdGhlcih1aW50MjU2IG5ld1ByaWNlLCBzdHJpbmcgVExTTm90YXJ5UHJvb2YpIGV4dGVybmFsIGlzQWRtaW4gewogICAgICAgIHByaWNlUGVyRXRoZXIgPSBuZXdQcmljZTsKICAgICAgICBDdXJyZW50VExTTlByb29mKHNlbGZBZGRyZXNzLCBUTFNOb3RhcnlQcm9vZik7CiAgICB9CgkKCS8qKgoJICogQG5vdGljZSBHZXQgdGhlIGN1cnJlbnQgMi1kZWNpbWFsIHByZWNpc2lvbiBwcmljZSBwZXIgdG9rZW4KCSAqIEBkZXYgCgkgICAgICAgIFRoZSBwcmljZSByZXRhaW5zIHRoZSAyIGRlY2ltYWwgcHJlY2lzaW9uIGJ5IG11bHRpcGx5aW5nIGl0IHdpdGgKCSAgICAgICAgMTAwIGFuZCBvZmZzZXR0aW5nIHRoYXQgaW4gdGhlIGNhbGN1bGF0aW9ucyB0aGUgcHJpY2UgaXMgdXNlZCBpbi4KCSAgICAgICAgRm9yIGV4YW1wbGUgNTAgbWVhbnMgZWFjaCB0b2tlbiBjb3N0cyAwLjUwJC4KCSAqIEByZXR1cm4gewoJCQkJCSJwcmljZSI6ICJQcmljZSBvZiBhIHNpbmdsZSBXQkMgVG9rZW4iCgkJCQl9CiAgICAgKi8KCWZ1bmN0aW9uIGdldFByaWNlUGVyVG9rZW4oKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBwcmljZSkgewogICAgICAgIGlmIChiYWxhbmNlc1tzZWxmQWRkcmVzc10gPiAyMDAwMDAwMDAwMDAwMDApIHsKICAgICAgICAgICAgcmV0dXJuIDUwOwogICAgICAgIH0gZWxzZSBpZiAoYmFsYW5jZXNbc2VsZkFkZHJlc3NdID4gMTUwMDAwMDAwMDAwMDAwKSB7CgkJCXJldHVybiAyMDA7CgkJfSBlbHNlIGlmIChiYWxhbmNlc1tzZWxmQWRkcmVzc10gPiAxMDAwMDAwMDAwMDAwMDApIHsKCQkJcmV0dXJuIDQwMDsKCQl9IGVsc2UgewoJCQlyZXR1cm4gNTUwOwogICAgICAgIH0KICAgIH0KCQoJLyoqCgkgKiBAbm90aWNlIENvbnZlcnQgV2VpIHRvIFdCQyB0b2tlbnMKCSAqIEBkZXYgCgkJICAgIFRoZSBfdmFsdWUgaXMgbXVsdGlwbGllZCBieSAxMF43IGJlY2F1c2Ugb2YgdGhlIDcgZGVjaW1hbCBwcmVjaXNpb24KCQkJb2YgV0JDIGFuZCB0byBlbnN1cmUgdGhhdCBhIHVzZXIgY2FuIGludmVzdCBsZXNzIHRoYW4gMSBldGhlciBhbmQgCgkJCXN0aWxsIGdldCBoaXMgV0JDIHRva2VucywgcHJldmVudGluZyByb3VuZGluZyBlcnJvcnMuIEEgaGFyZCBjYXAKCQkJb2YgNTAwayBXQkMgdG9rZW5zIHBlciBwdXJjaGFzZSBpcyBlbmZvcmNlZCBzbyBhcyB0byBwcmV2ZW50IHVzZXJzCgkJCWZyb20gYnV5aW5nIGxhcmdlIGFtb3VudHMgYXQgYSBoaWdoZXIgb3IgbG93ZXIgRXRoZXIgcHJpY2UgZHVlIHRvIAoJCQlob3VybHkgcHJpY2UgdXBkYXRlcy4KCSAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiBXZWkgdG8gY29udmVydAoJICogQHJldHVybiB7CgkJCQkJInRva2VuQW1vdW50IjogIkFtb3VudCBvZiBXQkMgVG9rZW5zIGlucHV0IGlzIHdvcnRoIgoJCQkJfQogICAgICovCglmdW5jdGlvbiBjYWxjdWxhdGVUb2tlbkFtb3VudCh1aW50MjU2IF92YWx1ZSkgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NiB0b2tlbkFtb3VudCkgewoJCXRva2VuQW1vdW50ID0gKChfdmFsdWUqKDEwKio3KS8xIGV0aGVyKSpwcmljZVBlckV0aGVyKS9nZXRQcmljZVBlclRva2VuKCk7CgkJYXNzZXJ0KHRva2VuQW1vdW50IDw9IDUwMDAwMDAwMDAwMDApOwoJfQoJCgkvKioKCSAqIEBub3RpY2UgQWRkIHRoZSBhZGRyZXNzIHRvIHRoZSB1c2VyIGxpc3QgCgkgKiBAZGV2IFVzZWQgZm9yIHRoZSBzcGxpdHRpbmcgZnVuY3Rpb24gdG8gdGFrZSBpdCBpbnRvIGFjY291bnQKCSAqIEBwYXJhbSBfdXNlciBVc2VyIHRvIGFkZCB0byBkYXRhYmFzZQoJICovCglmdW5jdGlvbiBhZGRVc2VyKGFkZHJlc3MgX3VzZXIpIGludGVybmFsIHsKCQlpZiAoIWlzQWRkZWRbX3VzZXJdKSB7CiAgICAgICAgICAgIHVzZXJzLnB1c2goX3VzZXIpOwogICAgICAgICAgICBtb250aGx5TGltaXRbX3VzZXJdID0gNTAwMDAwMDAwMDAwMDsKICAgICAgICAgICAgaXNBZGRlZFtfdXNlcl0gPSB0cnVlOwogICAgICAgIH0KCX0KICAgIAoJLyoqCgkgKiBAbm90aWNlIFNwbGl0IHRoZSBtb250aGx5IHByb2ZpdHMgb2YgdGhlIENhc2lubyB0byB0aGUgdXNlcnMKCSAqIEBkZXYgCgkJCVRoZSBmb3JtdWxhIHRoYXQgY2FsY3VsYXRlcyB0aGUgcHJvZml0IGEgdXNlciBpcyBvd2VkIGNhbiBiZSBzZWVuIG9uIAoJCQl0aGUgd2hpdGUgcGFwZXIuIFRoZSBhY3R1YWxQcm9maXRTcGxpdCB2YXJpYWJsZSBzdG9yZXMgdGhlIGFjdHVhbCB2YWx1ZXMKCSAgIAkJdGhhdCBhcmUgZGlzdHJpYnV0ZWQgdG8gdGhlIHVzZXJzIHRvIHByZXZlbnQgcm91bmRpbmcgZXJyb3JzIGZyb20gYnVybmluZyAKCQkJdG9rZW5zLiBTaW5jZSBnYXMgcmVxdWlyZW1lbnRzIHdpbGwgc3Bpa2UgdGhlIG1vcmUgdXNlcnMgdXNlIG91ciBwbGF0Zm9ybSwKCQkJYSBsb29wLXN0YXRlLXNhdmUgaXMgaW1wbGVtZW50ZWQgdG8gZW5zdXJlIHNjYWxhYmlsaXR5LgoJICovCiAgICBmdW5jdGlvbiBzcGxpdFByb2ZpdHMoKSBleHRlcm5hbCB7CgkJcmVxdWlyZShzcGxpdEluU2VydmljZSk7CiAgICAgICAgYnl0ZXMgbWVtb3J5IGVtcHR5OwogICAgICAgIHVpbnQgaTsKICAgICAgICBpZiAoIWlzRnJvemVuKSB7CiAgICAgICAgICAgIHJlcXVpcmUobm93ID49IHJlbGF0aXZlRGF0ZVNhdmUpOwogICAgICAgICAgICBhc3NldEZyZWV6ZSgpOwogICAgICAgICAgICByZXF1aXJlKGJhbGFuY2VzW3NlbGZBZGRyZXNzXSA+IDMwMDAwMDAwMDAwMDAwKTsKICAgICAgICAgICAgcmVsYXRpdmVEYXRlU2F2ZSA9IG5vdyArIDMwIGRheXM7CiAgICAgICAgICAgIGN1cnJlbnRQcm9maXRzID0gKChiYWxhbmNlc1tzZWxmQWRkcmVzc10tMzAwMDAwMDAwMDAwMDApLzEwKSo3OyAKICAgICAgICAgICAgYW1vdW50SW5DaXJjdWxhdGlvbiA9IHNhZmVTdWIoMzAwMDAwMDAwMDAwMDAwLCBiYWxhbmNlc1tzZWxmQWRkcmVzc10pOwogICAgICAgICAgICBjdXJyZW50SXRlcmF0aW9uID0gMDsKCQkJYWN0dWFsUHJvZml0U3BsaXQgPSAwOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGZvciAoaSA9IGN1cnJlbnRJdGVyYXRpb247IGkgPCB1c2Vycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgbW9udGhseUxpbWl0W3VzZXJzW2ldXSA9IDUwMDAwMDAwMDAwMDA7CiAgICAgICAgICAgICAgICBpZiAobXNnLmdhcyA8IDI0MDAwMCkgewogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRJdGVyYXRpb24gPSBpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoJCQkJaWYgKGFsbG93ZWRbc2VsZkFkZHJlc3NdW3VzZXJzW2ldXSA9PSAwKSB7CgkJCQkJY2hlY2tTcGxpdEVuZChpKTsKCQkJCQljb250aW51ZTsKCQkJCX0gZWxzZSBpZiAoKGJhbGFuY2VzW3VzZXJzW2ldXS9hbGxvd2VkW3NlbGZBZGRyZXNzXVt1c2Vyc1tpXV0pIDwgMTkpIHsKCQkJCQljaGVja1NwbGl0RW5kKGkpOwogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYmFsYW5jZXNbdXNlcnNbaV1dICs9IChiYWxhbmNlc1t1c2Vyc1tpXV0qY3VycmVudFByb2ZpdHMpL2Ftb3VudEluQ2lyY3VsYXRpb247CgkJCQlhY3R1YWxQcm9maXRTcGxpdCArPSAoYmFsYW5jZXNbdXNlcnNbaV1dKmN1cnJlbnRQcm9maXRzKS9hbW91bnRJbkNpcmN1bGF0aW9uOwoJCQkJY2hlY2tTcGxpdEVuZChpKTsKICAgICAgICAgICAgICAgIFRyYW5zZmVyKHNlbGZBZGRyZXNzLCB1c2Vyc1tpXSwgKGJhbGFuY2VzW3VzZXJzW2ldXS9hbW91bnRJbkNpcmN1bGF0aW9uKSpjdXJyZW50UHJvZml0cywgZW1wdHkpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoJCgkvKioKCSAqIEBub3RpY2UgQ2hhbmdlIHZhcmlhYmxlcyBvbiBzcGxpdCBlbmQKCSAqIEBwYXJhbSBpIFRoZSBjdXJyZW50IGluZGV4IG9mIHRoZSBzcGxpdCBsb29wCgkgKi8KCWZ1bmN0aW9uIGNoZWNrU3BsaXRFbmQodWludDI1NiBpKSBpbnRlcm5hbCB7CgkJaWYgKGkgPT0gdXNlcnMubGVuZ3RoLTEpIHsKCQkJYXNzZXRUaGF3KCk7CgkJCWJhbGFuY2VzWzB4MTY2Q2I0ODk3M0MyNDQ3ZGFmRkE4RUZkMzUyNmRhMTgwNzYwODhkZV0gPSBiYWxhbmNlc1sweDE2NkNiNDg5NzNDMjQ0N2RhZkZBOEVGZDM1MjZkYTE4MDc2MDg4ZGVdICsgY3VycmVudFByb2ZpdHMvMjI7CgkJCWJhbGFuY2VzW3NlbGZBZGRyZXNzXSA9IGJhbGFuY2VzW3NlbGZBZGRyZXNzXSAtIGFjdHVhbFByb2ZpdFNwbGl0IC0gY3VycmVudFByb2ZpdHMvMjI7CgkJfQoJfQoJCgkvKioKCSAqIEBub3RpY2UgU3BsaXQgdGhlIHVuc29sZCBXQkMgb2YgdGhlIElDTwoJICogQGRldiAKCQkJT25lIHRpbWUgZnVuY3Rpb24gdG8gZGlzdHJpYnV0ZSB0aGUgdW5zb2xkIHRva2Vucy4KCSAqLwogICAgZnVuY3Rpb24gSUNPU3BsaXQoKSBleHRlcm5hbCBpc0FkbWluIG9uZVRpbWUgewogICAgICAgIGJ5dGVzIG1lbW9yeSBlbXB0eTsKICAgICAgICB1aW50IGk7CiAgICAgICAgaWYgKCFpc0Zyb3plbikgewogICAgICAgICAgICByZXF1aXJlKChyZWxhdGl2ZURhdGVTYXZlIC0gbm93KSA+PSAocmVsYXRpdmVEYXRlU2F2ZSAtIDE1MCBkYXlzKSk7CiAgICAgICAgICAgIGFzc2V0RnJlZXplKCk7CiAgICAgICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbc2VsZkFkZHJlc3NdID4gNTAwMDAwMDAwMDAwMDApOwogICAgICAgICAgICBjdXJyZW50UHJvZml0cyA9ICgoYmFsYW5jZXNbc2VsZkFkZHJlc3NdIC0gNTAwMDAwMDAwMDAwMDApIC8gMTApICogNzsgCiAgICAgICAgICAgIGFtb3VudEluQ2lyY3VsYXRpb24gPSBzYWZlU3ViKDMwMDAwMDAwMDAwMDAwMCwgYmFsYW5jZXNbc2VsZkFkZHJlc3NdKTsKICAgICAgICAgICAgY3VycmVudEl0ZXJhdGlvbiA9IDA7CgkJCWFjdHVhbFByb2ZpdFNwbGl0ID0gMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmb3IgKGkgPSBjdXJyZW50SXRlcmF0aW9uOyBpIDwgdXNlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmIChtc2cuZ2FzIDwgMjQwMDAwKSB7CiAgICAgICAgICAgICAgICAgICAgY3VycmVudEl0ZXJhdGlvbiA9IGk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBiYWxhbmNlc1t1c2Vyc1tpXV0gKz0gKGJhbGFuY2VzW3VzZXJzW2ldXSpjdXJyZW50UHJvZml0cykvYW1vdW50SW5DaXJjdWxhdGlvbjsKCQkJCWFjdHVhbFByb2ZpdFNwbGl0ICs9IChiYWxhbmNlc1t1c2Vyc1tpXV0qY3VycmVudFByb2ZpdHMpL2Ftb3VudEluQ2lyY3VsYXRpb247CiAgICAgICAgICAgICAgICBpZiAoaSA9PSB1c2Vycy5sZW5ndGgtMSkgewogICAgICAgICAgICAgICAgICAgIGFzc2V0VGhhdygpOwogICAgICAgICAgICAgICAgICAgIGJhbGFuY2VzW3NlbGZBZGRyZXNzXSA9IGJhbGFuY2VzW3NlbGZBZGRyZXNzXSAtIGFjdHVhbFByb2ZpdFNwbGl0OwoJCQkJCWhhc0lDT1J1biA9IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBUcmFuc2ZlcihzZWxmQWRkcmVzcywgdXNlcnNbaV0sIChiYWxhbmNlc1t1c2Vyc1tpXV0vYW1vdW50SW5DaXJjdWxhdGlvbikqY3VycmVudFByb2ZpdHMsIGVtcHR5KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCQoJLyoqCgkgKiBAbm90aWNlIFNpZ24gdGhhdCB0aGUgREFwcCBpcyByZWFkeQoJICogQGRldiAKCSAgICAgICAgT25seSB0aGUgY29yZSB0ZWFtIG1lbWJlcnMgaGF2ZSBhY2Nlc3MgdG8gdGhpcyBmdW5jdGlvbi4gVGhpcyBpcyAKCSAgICAgICAgY3JlYXRlZCBhcyBhbiBleHRyYSBsYXllciBvZiBzZWN1cml0eSBmb3IgaW52ZXN0b3JzIGFuZCB1c2VycyBvZiAKCQkJdGhlIGNvaW4sIHNpbmNlIGEgbXVsdGktc2lnbmF0dXJlIGFwcHJvdmFsIGlzIHJlcXVpcmVkIGJlZm9yZSB0aGUgCgkJCWZ1bmN0aW9uIHRoYXQgYWx0ZXJzIHRoZSBDYXNpbm8gYmFsYW5jZSBpcyB1c2VkLgoJICovCiAgICBmdW5jdGlvbiBhc3N1cmVEQXBwSXNSZWFkeSgpIGV4dGVybmFsIHsKICAgICAgICBpZiAobXNnLnNlbmRlciA9PSAweDE2NkNiNDg5NzNDMjQ0N2RhZkZBOEVGZDM1MjZkYTE4MDc2MDg4ZGUpIHsKICAgICAgICAgICAgZGV2QXBwcm92YWxzWzBdID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgaWYgKG1zZy5zZW5kZXIgPT0gMHgxYWIxM0QyQzFBQzQzMDM3Mzc5ODFDZThCOGJENTExNkM4NGM3NDRkKSB7CiAgICAgICAgICAgIGRldkFwcHJvdmFsc1sxXSA9IHRydWU7CiAgICAgICAgfSBlbHNlIGlmIChtc2cuc2VuZGVyID09IDB4RUM1YTQ4ZDZGMTFGOGE5ODFhYTNEOTEzREEwQTY5MTk0MjgwY0RCYykgewogICAgICAgICAgICBkZXZBcHByb3ZhbHNbMl0gPSB0cnVlOwogICAgICAgIH0gZWxzZSBpZiAobXNnLnNlbmRlciA9PSAweEU1OUNiRDAyOGY3MTQ0N0I4MDRGMzFDZjBmQzQxRjBlNUUxM2Y0YkYpIHsKICAgICAgICAgICAgZGV2QXBwcm92YWxzWzNdID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewoJCQlyZXZlcnQoKTsKCQl9CiAgICB9CgkKCS8qKgogICAgICogQG5vdGljZSBWZXJpZnkgdGhhdCB0aGUgREFwcCBpcyByZWFkeQoJICogQGRldiAKCQkJU2luY2UgaXRlcmF0aW5nIHRocm91Z2ggdGhlIGRldkFwcHJvdmFscyBhcnJheSBjb3N0cyBnYXMKCQkJYW5kIHRoZSBmdW5jdGlvbnMgd2l0aCB0aGUgREFwcE9ubGluZSBtb2RpZmllciBhcmUgZ29pbmcKCQkJdG8gYmUgcmVwZXRpdGl2ZWx5IHVzZWQsIGl0IGlzIGJldHRlciB0byBzdG9yZSB0aGUgREFwcAoJCQlzdGF0ZSBpbiBhIHZhcmlhYmxlIHRoYXQgbmVlZHMgdG8gYmUgYWx0ZXJlZCBvbmNlLgoJICovCiAgICBmdW5jdGlvbiBpc0RBcHBSZWFkeSgpIGV4dGVybmFsIGlzQWRtaW4gewogICAgICAgIHVpbnQ4IG51bU9mQXBwcm92YWxzID0gMDsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBkZXZBcHByb3ZhbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGRldkFwcHJvdmFsc1tpXSkgewogICAgICAgICAgICAgICAgbnVtT2ZBcHByb3ZhbHMrKzsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBEQXBwUmVhZHkgPSAobnVtT2ZBcHByb3ZhbHM+PTIpOwogICAgfQogICAgCgkvKioKCSAqIEBub3RpY2UgUmlzZSBvciBsb3dlciB1c2VyIGJhbmsgYmFsYW5jZSAtIEJhY2tlbmQgRnVuY3Rpb24KCSAqIEBkZXYgCgkgICAgICAgIFRoaXMgYWxsb3dzIHJlYWwtdGltZSBhZGp1c3RtZW50IG9mIHRoZSBiYWxhbmNlIGEgdXNlciBoYXMgd2l0aGluIHRoZSBDYXNpbm8gdG8KCQkJcmVwcmVzZW50IGVhcm5pbmdzIGFuZCBsb3NzZXMuIFVuZGVyZmxvdyBpbXBvc3NpYmxlIHNpbmNlIG9ubHkgYmV0cyBjYW4gbG93ZXIgdGhlCgkJCWJhbGFuY2UuCgkgKiBAcGFyYW0gX3RvQWx0ZXIgVGhlIGFkZHJlc3Mgd2hvc2UgQ2FzaW5vIGJhbGFuY2UgdG8gYWx0ZXIKCSAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgdG8gYWx0ZXIgaXQgYnkKCSAqLwogICAgZnVuY3Rpb24gYWx0ZXJCYW5rQmFsYW5jZShhZGRyZXNzIF90b0FsdGVyLCB1aW50MjU2IF9hbW91bnQsIGJvb2wgc2lnbikgZXh0ZXJuYWwgREFwcE9ubGluZSBpc0FkbWluIHsKICAgICAgICBpZiAoc2lnbiAmJiAoX2Ftb3VudCthbGxvd2VkW3NlbGZBZGRyZXNzXVtfdG9BbHRlcl0pID4gYWxsb3dlZFtzZWxmQWRkcmVzc11bX3RvQWx0ZXJdKSB7CgkJCWFsbG93ZWRbc2VsZkFkZHJlc3NdW190b0FsdGVyXSA9IF9hbW91bnQgKyBhbGxvd2VkW3NlbGZBZGRyZXNzXVtfdG9BbHRlcl07CgkJCUFwcHJvdmFsKHNlbGZBZGRyZXNzLCBfdG9BbHRlciwgYWxsb3dlZFtzZWxmQWRkcmVzc11bX3RvQWx0ZXJdKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhbGxvd2VkW3NlbGZBZGRyZXNzXVtfdG9BbHRlcl0gPSBzYWZlU3ViKGFsbG93ZWRbc2VsZkFkZHJlc3NdW190b0FsdGVyXSwgX2Ftb3VudCk7CgkJCUFwcHJvdmFsKHNlbGZBZGRyZXNzLCBfdG9BbHRlciwgYWxsb3dlZFtzZWxmQWRkcmVzc11bX3RvQWx0ZXJdKTsKICAgICAgICB9CiAgICB9CiAgICAKCS8qKgoJICogQG5vdGljZSBGcmVlemUgdXNlciBkdXJpbmcgcGxhdGZvcm0gdXNlIC0gQmFja2VuZCBGdW5jdGlvbgoJICogQGRldiBQcmV2ZW50cyBhZ2FpbnN0IHRoZSBFUkMtMjAgcmFjZSBhdHRhY2sgb24gdGhlIENhc2lubwoJICogQHBhcmFtIF91c2VyIFRoZSB1c2VyIHRvIGZyZWV6ZQoJICovCiAgICBmdW5jdGlvbiBsb2dpblVzZXIoYWRkcmVzcyBfdXNlcikgZXh0ZXJuYWwgREFwcE9ubGluZSBpc0FkbWluIHsKICAgICAgICBmcmVlemVVc2VyW191c2VyXSA9IHRydWU7CiAgICB9CgkKCS8qKgoJICogQG5vdGljZSBEZS1GcmVlemUgdXNlciAtIEJhY2tlbmQgRnVuY3Rpb24KICAgICAqIEBkZXYgVXNlZCB3aGVuIGEgdXNlciBsb2dzIG91dCBvciBsb3NlcyBjb25uZWN0aW9uIHdpdGggdGhlIERBcHAKCSAqIEBwYXJhbSBfdXNlciBUaGUgdXNlciB0byBkZS1mcmVlemUKCSAqLwoJZnVuY3Rpb24gbG9nb3V0VXNlcihhZGRyZXNzIF91c2VyKSBleHRlcm5hbCBEQXBwT25saW5lIGlzQWRtaW4gewoJCWZyZWV6ZVVzZXJbX3VzZXJdID0gZmFsc2U7Cgl9CiAgICAKICAgIC8qKgoJICogQG5vdGljZSBGYWxsYmFjayBmdW5jdGlvbiAKCSAqIEBkZXYgVHJpZ2dlcmVkIHdoZW4gRXRoZXIgaXMgc2VudCB0byB0aGUgY29udHJhY3QuIFRocm93cyBpbnRlbnRpb25hbGx5IHRvIHJlZnVuZCB0aGUgc2VuZGVyLgoJICovCiAgICBmdW5jdGlvbigpIHBheWFibGUgewoJCXJldmVydCgpOwogICAgfQoJCgkvKioKCSAqIEBub3RpY2UgUHVyY2hhc2UgV0JDIFRva2VucyBmb3IgQWRkcmVzcyAtIElDTwoJICogQHBhcmFtIF9yZWNpcGllbnQgVGhlIHJlY2lwaWVudCBvZiB0aGUgV0JDIHRva2VucwoJICovCglmdW5jdGlvbiBidXlUb2tlbnNGb3JBZGRyZXNzKGFkZHJlc3MgX3JlY2lwaWVudCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgdG90YWxGdW5kcyA9IHRvdGFsRnVuZHMgKyBtc2cudmFsdWU7CiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPiAwKTsKCQlyZXF1aXJlKF9yZWNpcGllbnQgIT0gYWRtaW4pOwoJCXJlcXVpcmUoKHRvdGFsRnVuZHMvMSBldGhlcikqcHJpY2VQZXJFdGhlciA8IDYwMDAwMDAwMDApOwogICAgICAgIGFkZFVzZXIoX3JlY2lwaWVudCk7CiAgICAgICAgYnl0ZXMgbWVtb3J5IGVtcHR5OwoJCXVpbnQgdG9rZW5BbW91bnQgPSBjYWxjdWxhdGVUb2tlbkFtb3VudChtc2cudmFsdWUpOwoJCWJhbGFuY2VzW3NlbGZBZGRyZXNzXSA9IGJhbGFuY2VzW3NlbGZBZGRyZXNzXSAtIHRva2VuQW1vdW50OwoJCWFzc2VydChiYWxhbmNlc1tzZWxmQWRkcmVzc10gPj0gNTAwMDAwMDAwMDAwMDApOwogICAgICAgIGJhbGFuY2VzW19yZWNpcGllbnRdID0gYmFsYW5jZXNbX3JlY2lwaWVudF0gKyB0b2tlbkFtb3VudDsKICAgICAgICBUcmFuc2ZlcihzZWxmQWRkcmVzcywgX3JlY2lwaWVudCwgdG9rZW5BbW91bnQsIGVtcHR5KTsKICAgICAgICBhZGRyZXNzIGV0aGVyVHJhbnNmZXIgPSAweDE2NkNiNDg5NzNDMjQ0N2RhZkZBOEVGZDM1MjZkYTE4MDc2MDg4ZGU7CiAgICAgICAgZXRoZXJUcmFuc2Zlci50cmFuc2Zlcihtc2cudmFsdWUpOwogICAgfQoJCgkvKioKCSAqIEBub3RpY2UgUHVyY2hhc2UgV0JDIFRva2VucyBmb3IgU2VsZiAtIElDTwoJICovCglmdW5jdGlvbiBidXlUb2tlbnNGb3JTZWxmKCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgdG90YWxGdW5kcyA9IHRvdGFsRnVuZHMgKyBtc2cudmFsdWU7CgkJYWRkcmVzcyBldGhlclRyYW5zZmVyID0gMHgxNjZDYjQ4OTczQzI0NDdkYWZGQThFRmQzNTI2ZGExODA3NjA4OGRlOwogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID4gMCk7CgkJcmVxdWlyZShtc2cuc2VuZGVyICE9IGV0aGVyVHJhbnNmZXIpOwoJCXJlcXVpcmUoKHRvdGFsRnVuZHMvMSBldGhlcikqcHJpY2VQZXJFdGhlciA8IDYwMDAwMDAwMDApOwogICAgICAgIGFkZFVzZXIobXNnLnNlbmRlcik7CiAgICAgICAgYnl0ZXMgbWVtb3J5IGVtcHR5OwoJCXVpbnQgdG9rZW5BbW91bnQgPSBjYWxjdWxhdGVUb2tlbkFtb3VudChtc2cudmFsdWUpOwoJCWJhbGFuY2VzW3NlbGZBZGRyZXNzXSA9IGJhbGFuY2VzW3NlbGZBZGRyZXNzXSAtIHRva2VuQW1vdW50OwoJCWFzc2VydChiYWxhbmNlc1tzZWxmQWRkcmVzc10gPj0gNTAwMDAwMDAwMDAwMDApOwogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0gKyB0b2tlbkFtb3VudDsKICAgICAgICBUcmFuc2ZlcihzZWxmQWRkcmVzcywgbXNnLnNlbmRlciwgdG9rZW5BbW91bnQsIGVtcHR5KTsKICAgICAgICBldGhlclRyYW5zZmVyLnRyYW5zZmVyKG1zZy52YWx1ZSk7CiAgICB9Cn0='.
	

]
