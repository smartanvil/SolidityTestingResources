Class {
	#name : #SRTb48690d52fdd201895b349bc610fa61028588349,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTb48690d52fdd201895b349bc610fa61028588349 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5CiAqLwpjb250cmFjdCBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKCi8qKgogKiBAdGl0bGUgUG9TVG9rZW5TdGFuZGFyZAogKiBAZGV2IHRoZSBpbnRlcmZhY2Ugb2YgUG9TVG9rZW5TdGFuZGFyZAogKi8KY29udHJhY3QgUG9TVG9rZW5TdGFuZGFyZCB7CiAgICB1aW50MjU2IHB1YmxpYyBzdGFrZVN0YXJ0VGltZTsKICAgIHVpbnQyNTYgcHVibGljIHN0YWtlTWluQWdlOwogICAgdWludDI1NiBwdWJsaWMgc3Rha2VNYXhBZ2U7CiAgICBmdW5jdGlvbiBtaW50KCkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gY29pbkFnZSgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGFubnVhbEludGVyZXN0KCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQyNTYpOwogICAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgX2FkZHJlc3MsIHVpbnQgX3Jld2FyZCk7Cn0KCgpjb250cmFjdCBCSVRUT1Rva2VuIGlzIEVSQzIwLFBvU1Rva2VuU3RhbmRhcmQsT3duYWJsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICBzdHJpbmcgcHVibGljIG5hbWUgPSAiQklUVE8gVG9rZW4iOwogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAiQklUVE8iOwogICAgdWludCBwdWJsaWMgZGVjaW1hbHMgPSAxODsKCiAgICB1aW50IHB1YmxpYyBjaGFpblN0YXJ0VGltZTsgLy9jaGFpbiBzdGFydCB0aW1lCiAgICB1aW50IHB1YmxpYyBjaGFpblN0YXJ0QmxvY2tOdW1iZXI7IC8vY2hhaW4gc3RhcnQgYmxvY2sgbnVtYmVyCiAgICB1aW50IHB1YmxpYyBzdGFrZVN0YXJ0VGltZTsgLy9zdGFrZSBzdGFydCB0aW1lCiAgICB1aW50IHB1YmxpYyBzdGFrZU1pbkFnZSA9IDE1IGRheXM7IC8vIG1pbmltdW0gYWdlIGZvciBjb2luIGFnZTogM0QKICAgIHVpbnQgcHVibGljIHN0YWtlTWF4QWdlID0gOTAgZGF5czsgLy8gc3Rha2UgYWdlIG9mIGZ1bGwgd2VpZ2h0OiA5MEQKICAgIC8vIHVpbnQgcHVibGljIG1heE1pbnRQcm9vZk9mU3Rha2UgPSAxMCoqMTc7IC8vIGRlZmF1bHQgMTAlIGFubnVhbCBpbnRlcmVzdAogICAgdWludCBjb25zdGFudCBSRVdBUkRTX1BFUl9BR0UgPSA2MjI2NjUwMDYyMjcwMDA7ICAvLyB0b2tlbiByZXdhcmRzIHBlciBjb2luIGFnZS4KCiAgICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseTsKICAgIHVpbnQgcHVibGljIG1heFRvdGFsU3VwcGx5OwogICAgdWludCBwdWJsaWMgdG90YWxJbml0aWFsU3VwcGx5OwoKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgbm9QT1NSZXdhcmRzOwoKICAgIHN0cnVjdCB0cmFuc2ZlckluU3RydWN0IHsKICAgICAgICB1aW50MTI4IGFtb3VudDsKICAgICAgICB1aW50NjQgdGltZTsKICAgIH0KCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB0cmFuc2ZlckluU3RydWN0W10pIHRyYW5zZmVySW5zOwoKICAgIGV2ZW50IEJ1cm4oYWRkcmVzcyBpbmRleGVkIGJ1cm5lciwgdWludDI1NiB2YWx1ZSk7CgogICAgLyoqCiAgICAgKiBAZGV2IEZpeCBmb3IgdGhlIEVSQzIwIHNob3J0IGFkZHJlc3MgYXR0YWNrLgogICAgICovCiAgICBtb2RpZmllciBvbmx5UGF5bG9hZFNpemUodWludCBzaXplKSB7CiAgICAgICAgcmVxdWlyZShtc2cuZGF0YS5sZW5ndGggPj0gc2l6ZSArIDQpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgY2FuUG9TTWludCgpIHsKICAgICAgICByZXF1aXJlKHRvdGFsU3VwcGx5IDwgbWF4VG90YWxTdXBwbHkpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gQklUVE9Ub2tlbigpIHB1YmxpYyB7CiAgICAgICAgLy8gNSBtaWwgaXMgcmVzZXJ2ZWQgZm9yIFBPUyByZXdhcmRzCiAgICAgICAgbWF4VG90YWxTdXBwbHkgPSAyMjMgKiAxMCoqMjM7IC8vIDIyLjMgTWlsLgogICAgICAgIHRvdGFsSW5pdGlhbFN1cHBseSA9IDE3MyAqIDEwKioyMzsgLy8gMTcuMyBNaWwuIDEwIG1pbCA9IGNyb3dkc2FsZSwgNy4zIHRlYW0gYWNjb3VudAoKICAgICAgICBjaGFpblN0YXJ0VGltZSA9IG5vdzsKICAgICAgICBjaGFpblN0YXJ0QmxvY2tOdW1iZXIgPSBibG9jay5udW1iZXI7CgogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gdG90YWxJbml0aWFsU3VwcGx5OwogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxJbml0aWFsU3VwcGx5OwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDIgKiAzMikgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAobXNnLnNlbmRlciA9PSBfdG8pCiAgICAgICAgICAgIHJldHVybiBtaW50KCk7CiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgaWYgKHRyYW5zZmVySW5zW21zZy5zZW5kZXJdLmxlbmd0aCA+IDApCiAgICAgICAgICAgIGRlbGV0ZSB0cmFuc2Zlckluc1ttc2cuc2VuZGVyXTsKICAgICAgICB1aW50NjQgX25vdyA9IHVpbnQ2NChub3cpOwogICAgICAgIHRyYW5zZmVySW5zW21zZy5zZW5kZXJdLnB1c2godHJhbnNmZXJJblN0cnVjdCh1aW50MTI4KGJhbGFuY2VzW21zZy5zZW5kZXJdKSxfbm93KSk7CiAgICAgICAgdHJhbnNmZXJJbnNbX3RvXS5wdXNoKHRyYW5zZmVySW5TdHJ1Y3QodWludDEyOChfdmFsdWUpLF9ub3cpKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gdG90YWxTdXBwbHk7CiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDMgKiAzMikgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICAgICAgdWludDI1NiBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07CgogICAgICAgIC8vIENoZWNrIGlzIG5vdCBuZWVkZWQgYmVjYXVzZSBzdWIoX2FsbG93YW5jZSwgX3ZhbHVlKSB3aWxsIGFscmVhZHkgdGhyb3cgaWYgdGhpcyBjb25kaXRpb24gaXMgbm90IG1ldAogICAgICAgIC8vIHJlcXVpcmUgKF92YWx1ZSA8PSBfYWxsb3dhbmNlKTsKCiAgICAgICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgICAgIGlmICh0cmFuc2Zlckluc1tfZnJvbV0ubGVuZ3RoID4gMCkKICAgICAgICAgICAgZGVsZXRlIHRyYW5zZmVySW5zW19mcm9tXTsKICAgICAgICB1aW50NjQgX25vdyA9IHVpbnQ2NChub3cpOwogICAgICAgIHRyYW5zZmVySW5zW19mcm9tXS5wdXNoKHRyYW5zZmVySW5TdHJ1Y3QodWludDEyOChiYWxhbmNlc1tfZnJvbV0pLF9ub3cpKTsKICAgICAgICB0cmFuc2Zlckluc1tfdG9dLnB1c2godHJhbnNmZXJJblN0cnVjdCh1aW50MTI4KF92YWx1ZSksX25vdykpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZSgoX3ZhbHVlID09IDApIHx8IChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9PSAwKSk7CgogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgICB9CgogICAgZnVuY3Rpb24gbWludCgpIGNhblBvU01pbnQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICAvLyBtaW5pbXVtIHN0YWtlIG9mIDUwMDAgQklUVE8gaXMgcmVxdWlyZWQgdG8gZWFybiBzdGFraW5nLgogICAgICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA8IDUwMDAgZXRoZXIpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBpZiAodHJhbnNmZXJJbnNbbXNnLnNlbmRlcl0ubGVuZ3RoIDw9IDApCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgdWludCByZXdhcmQgPSBnZXRQcm9vZk9mU3Rha2VSZXdhcmQobXNnLnNlbmRlcik7CiAgICAgICAgaWYgKHJld2FyZCA8PSAwKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKHJld2FyZCk7CiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5hZGQocmV3YXJkKTsKICAgICAgICBkZWxldGUgdHJhbnNmZXJJbnNbbXNnLnNlbmRlcl07CiAgICAgICAgdHJhbnNmZXJJbnNbbXNnLnNlbmRlcl0ucHVzaCh0cmFuc2ZlckluU3RydWN0KHVpbnQxMjgoYmFsYW5jZXNbbXNnLnNlbmRlcl0pLHVpbnQ2NChub3cpKSk7CgogICAgICAgIFRyYW5zZmVyKGFkZHJlc3MoMCksIG1zZy5zZW5kZXIsIHJld2FyZCk7CiAgICAgICAgTWludChtc2cuc2VuZGVyLCByZXdhcmQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEJsb2NrTnVtYmVyKCkgdmlldyBwdWJsaWMgcmV0dXJucyAodWludCBibG9ja051bWJlcikgewogICAgICAgIGJsb2NrTnVtYmVyID0gYmxvY2subnVtYmVyLnN1YihjaGFpblN0YXJ0QmxvY2tOdW1iZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNvaW5BZ2UoKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludCBteUNvaW5BZ2UpIHsKICAgICAgICBteUNvaW5BZ2UgPSBnZXRDb2luQWdlKG1zZy5zZW5kZXIsbm93KTsKICAgIH0KCiAgICBmdW5jdGlvbiBhbm51YWxJbnRlcmVzdCgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50IGludGVyZXN0KSB7CiAgICAgICAgLy8gdWludCBfbm93ID0gbm93OwogICAgICAgIC8vIGludGVyZXN0ID0gbWF4TWludFByb29mT2ZTdGFrZTsKICAgICAgICAvLyBpZiAoKF9ub3cuc3ViKHN0YWtlU3RhcnRUaW1lKSkuZGl2KDEgeWVhcnMpID09IDApIHsKICAgICAgICAvLyAgICAgaW50ZXJlc3QgPSAoNzcwICogbWF4TWludFByb29mT2ZTdGFrZSkuZGl2KDEwMCk7CiAgICAgICAgLy8gfSBlbHNlIGlmICgoX25vdy5zdWIoc3Rha2VTdGFydFRpbWUpKS5kaXYoMSB5ZWFycykgPT0gMSkgewogICAgICAgIC8vICAgICBpbnRlcmVzdCA9ICg0MzUgKiBtYXhNaW50UHJvb2ZPZlN0YWtlKS5kaXYoMTAwKTsKICAgICAgICAvLyB9CgogICAgICAgIHJldHVybiBSRVdBUkRTX1BFUl9BR0U7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0UHJvb2ZPZlN0YWtlUmV3YXJkKGFkZHJlc3MgX2FkZHJlc3MpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXF1aXJlKChub3cgPj0gc3Rha2VTdGFydFRpbWUpICYmIChzdGFrZVN0YXJ0VGltZSA+IDApKTsKICAgICAgICByZXF1aXJlKCFub1BPU1Jld2FyZHNbX2FkZHJlc3NdKTsKCiAgICAgICAgdWludCBfbm93ID0gbm93OwogICAgICAgIHVpbnQgX2NvaW5BZ2UgPSBnZXRDb2luQWdlKF9hZGRyZXNzLCBfbm93KTsKICAgICAgICBpZiAoX2NvaW5BZ2UgPD0gMCkKICAgICAgICAgICAgcmV0dXJuIDA7CgogICAgICAgIC8vIHVpbnQgaW50ZXJlc3QgPSBtYXhNaW50UHJvb2ZPZlN0YWtlOwogICAgICAgIC8vIC8vIER1ZSB0byB0aGUgaGlnaCBpbnRlcmVzdCByYXRlIGZvciB0aGUgZmlyc3QgdHdvIHllYXJzLCBjb21wb3VuZGluZyBzaG91bGQgYmUgdGFrZW4gaW50byBhY2NvdW50LgogICAgICAgIC8vIC8vIEVmZmVjdGl2ZSBhbm51YWwgaW50ZXJlc3QgcmF0ZSA9ICgxICsgKG5vbWluYWwgcmF0ZSAvIG51bWJlciBvZiBjb21wb3VuZGluZyBwZXJpb2RzKSkgXiAobnVtYmVyIG9mIGNvbXBvdW5kaW5nIHBlcmlvZHMpIC0gMQogICAgICAgIC8vIGlmICgoX25vdy5zdWIoc3Rha2VTdGFydFRpbWUpKS5kaXYoMSB5ZWFycykgPT0gMCkgewogICAgICAgIC8vICAgICAvLyAxc3QgeWVhciBlZmZlY3RpdmUgYW5udWFsIGludGVyZXN0IHJhdGUgaXMgMTAwJSB3aGVuIHdlIHNlbGVjdCB0aGUgc3Rha2VNYXhBZ2UgKDkwIGRheXMpIGFzIHRoZSBjb21wb3VuZGluZyBwZXJpb2QuCiAgICAgICAgLy8gICAgIGludGVyZXN0ID0gKDc3MCAqIG1heE1pbnRQcm9vZk9mU3Rha2UpLmRpdigxMDApOwogICAgICAgIC8vIH0gZWxzZSBpZiAoKF9ub3cuc3ViKHN0YWtlU3RhcnRUaW1lKSkuZGl2KDEgeWVhcnMpID09IDEpIHsKICAgICAgICAvLyAgICAgLy8gMm5kIHllYXIgZWZmZWN0aXZlIGFubnVhbCBpbnRlcmVzdCByYXRlIGlzIDUwJQogICAgICAgIC8vICAgICBpbnRlcmVzdCA9ICg0MzUgKiBtYXhNaW50UHJvb2ZPZlN0YWtlKS5kaXYoMTAwKTsKICAgICAgICAvLyB9CgogICAgICAgIC8vIHJldHVybiAoX2NvaW5BZ2UgKiBpbnRlcmVzdCkuZGl2KDM2NSAqICgxMCoqZGVjaW1hbHMpKTsKICAgICAgICByZXR1cm4gX2NvaW5BZ2UubXVsKFJFV0FSRFNfUEVSX0FHRSk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0Q29pbkFnZShhZGRyZXNzIF9hZGRyZXNzLCB1aW50IF9ub3cpIGludGVybmFsIHJldHVybnMgKHVpbnQgX2NvaW5BZ2UpIHsKICAgICAgICBpZiAodHJhbnNmZXJJbnNbX2FkZHJlc3NdLmxlbmd0aCA8PSAwKQogICAgICAgICAgICByZXR1cm4gMDsKCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgdHJhbnNmZXJJbnNbX2FkZHJlc3NdLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChfbm93IDwgdWludCh0cmFuc2Zlckluc1tfYWRkcmVzc11baV0udGltZSkuYWRkKHN0YWtlTWluQWdlKSkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgdWludCBuQ29pblNlY29uZHMgPSBfbm93LnN1Yih1aW50KHRyYW5zZmVySW5zW19hZGRyZXNzXVtpXS50aW1lKSk7CiAgICAgICAgICAgIGlmICggbkNvaW5TZWNvbmRzID4gc3Rha2VNYXhBZ2UgKQogICAgICAgICAgICAgICAgbkNvaW5TZWNvbmRzID0gc3Rha2VNYXhBZ2U7CgogICAgICAgICAgICBfY29pbkFnZSA9IF9jb2luQWdlLmFkZCh1aW50KHRyYW5zZmVySW5zW19hZGRyZXNzXVtpXS5hbW91bnQpICogbkNvaW5TZWNvbmRzLmRpdigxIGRheXMpKTsKICAgICAgICB9CiAgICAgICAgX2NvaW5BZ2UgPSBfY29pbkFnZS5kaXYoNTAwMCBldGhlcik7CiAgICB9CgogICAgZnVuY3Rpb24gb3duZXJTZXRTdGFrZVN0YXJ0VGltZSh1aW50IHRpbWVzdGFtcCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZSgoc3Rha2VTdGFydFRpbWUgPD0gMCkgJiYgKHRpbWVzdGFtcCA+PSBjaGFpblN0YXJ0VGltZSkpOwogICAgICAgIHN0YWtlU3RhcnRUaW1lID0gdGltZXN0YW1wOwogICAgfQoKICAgIGZ1bmN0aW9uIG93bmVyQnVyblRva2VuKHVpbnQgX3ZhbHVlKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKF92YWx1ZSA+IDApOwoKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIGRlbGV0ZSB0cmFuc2Zlckluc1ttc2cuc2VuZGVyXTsKICAgICAgICB0cmFuc2Zlckluc1ttc2cuc2VuZGVyXS5wdXNoKHRyYW5zZmVySW5TdHJ1Y3QodWludDEyOChiYWxhbmNlc1ttc2cuc2VuZGVyXSksdWludDY0KG5vdykpKTsKCiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5zdWIoX3ZhbHVlKTsKICAgICAgICB0b3RhbEluaXRpYWxTdXBwbHkgPSB0b3RhbEluaXRpYWxTdXBwbHkuc3ViKF92YWx1ZSk7CiAgICAgICAgbWF4VG90YWxTdXBwbHkgPSBtYXhUb3RhbFN1cHBseS5zdWIoX3ZhbHVlKjEwKTsKCiAgICAgICAgQnVybihtc2cuc2VuZGVyLCBfdmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEJ1cm5zIGEgc3BlY2lmaWMgYW1vdW50IG9mIHRva2Vucy4KICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VuIHRvIGJlIGJ1cm5lZC4KICAgICovCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKICAgICAgICAvLyBubyBuZWVkIHRvIHJlcXVpcmUgdmFsdWUgPD0gdG90YWxTdXBwbHksIHNpbmNlIHRoYXQgd291bGQgaW1wbHkgdGhlCiAgICAgICAgLy8gc2VuZGVyJ3MgYmFsYW5jZSBpcyBncmVhdGVyIHRoYW4gdGhlIHRvdGFsU3VwcGx5LCB3aGljaCAqc2hvdWxkKiBiZSBhbiBhc3NlcnRpb24gZmFpbHVyZQoKICAgICAgICBhZGRyZXNzIGJ1cm5lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgYmFsYW5jZXNbYnVybmVyXSA9IGJhbGFuY2VzW2J1cm5lcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgZGVsZXRlIHRyYW5zZmVySW5zW21zZy5zZW5kZXJdOwogICAgICAgIHRyYW5zZmVySW5zW21zZy5zZW5kZXJdLnB1c2godHJhbnNmZXJJblN0cnVjdCh1aW50MTI4KGJhbGFuY2VzW21zZy5zZW5kZXJdKSx1aW50NjQobm93KSkpOwogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuc3ViKF92YWx1ZSk7CiAgICAgICAgQnVybihidXJuZXIsIF92YWx1ZSk7CiAgICB9CgogICAgLyogQmF0Y2ggdG9rZW4gdHJhbnNmZXIuIFVzZWQgYnkgY29udHJhY3QgY3JlYXRvciB0byBkaXN0cmlidXRlIGluaXRpYWwgdG9rZW5zIHRvIGhvbGRlcnMgKi8KICAgIGZ1bmN0aW9uIGJhdGNoVHJhbnNmZXIoYWRkcmVzc1tdIF9yZWNpcGllbnRzLCB1aW50W10gX3ZhbHVlcykgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShfcmVjaXBpZW50cy5sZW5ndGggPiAwICYmIF9yZWNpcGllbnRzLmxlbmd0aCA9PSBfdmFsdWVzLmxlbmd0aCk7CgogICAgICAgIHVpbnQgdG90YWwgPSAwOwogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IF92YWx1ZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdG90YWwgPSB0b3RhbC5hZGQoX3ZhbHVlc1tpXSk7CiAgICAgICAgfQogICAgICAgIHJlcXVpcmUodG90YWwgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoKICAgICAgICB1aW50NjQgX25vdyA9IHVpbnQ2NChub3cpOwogICAgICAgIGZvciAodWludCBqID0gMDsgaiA8IF9yZWNpcGllbnRzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW19yZWNpcGllbnRzW2pdXSA9IGJhbGFuY2VzW19yZWNpcGllbnRzW2pdXS5hZGQoX3ZhbHVlc1tqXSk7CiAgICAgICAgICAgIHRyYW5zZmVySW5zW19yZWNpcGllbnRzW2pdXS5wdXNoKHRyYW5zZmVySW5TdHJ1Y3QodWludDEyOChfdmFsdWVzW2pdKSxfbm93KSk7CiAgICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF9yZWNpcGllbnRzW2pdLCBfdmFsdWVzW2pdKTsKICAgICAgICB9CgogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKHRvdGFsKTsKICAgICAgICBpZiAodHJhbnNmZXJJbnNbbXNnLnNlbmRlcl0ubGVuZ3RoID4gMCkKICAgICAgICAgICAgZGVsZXRlIHRyYW5zZmVySW5zW21zZy5zZW5kZXJdOwogICAgICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+IDApCiAgICAgICAgICAgIHRyYW5zZmVySW5zW21zZy5zZW5kZXJdLnB1c2godHJhbnNmZXJJblN0cnVjdCh1aW50MTI4KGJhbGFuY2VzW21zZy5zZW5kZXJdKSxfbm93KSk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGRpc2FibGVQT1NSZXdhcmQoYWRkcmVzcyBfYWNjb3VudCwgYm9vbCBfZW5hYmxlZCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgbm9QT1NSZXdhcmRzW19hY2NvdW50XSA9IF9lbmFibGVkOwogICAgfQp9'.
	

]
