Class {
	#name : #SRTc8e12d15592d7366cf8d9aa8fb0202faf5c00ab2,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTc8e12d15592d7366cf8d9aa8fb0202faf5c00ab2 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7Ci8qKgogKiBAdGl0bGUgRVJDMjBCYXNpYwogKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE3OQogKi8KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9Ci8qKgogKiBAdGl0bGUgT3duYWJsZQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuCiAqLwpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KfQovKioKICogQHRpdGxlIEJlbmViaXRJQ08KICogQGF1dGhvciBIYW16YSBZYXNpbiB8fCBKdW5haWQgTXVzaHRhcQogKiBAZGV2IEJlbmliaXRDcm93ZHNhbGUgaXMgYSBiYXNlIGNvbnRyYWN0IGZvciBtYW5hZ2luZyBhIHRva2VuIGNyb3dkc2FsZS4KICogQ3Jvd2RzYWxlcyBoYXZlIGEgc3RhcnQgYW5kIGVuZCB0aW1lc3RhbXBzLCB3aGVyZSBpbnZlc3RvcnMgY2FuIG1ha2UKICogdG9rZW4gcHVyY2hhc2VzIGFuZCB0aGUgY3Jvd2RzYWxlIHdpbGwgYXNzaWduIHRoZW0gQk5FIHRva2VucyBiYXNlZAogKiBvbiBhIEJORSB0b2tlbiBwZXIgRVRIIHJhdGUuIEZ1bmRzIGNvbGxlY3RlZCBhcmUgZm9yd2FyZGVkIHRvIGEgd2FsbGV0CiAqIGFzIHRoZXkgYXJyaXZlLgogKi8KLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CiAgLyoqCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cn0KLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KLyoqCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbgogKgogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwogIC8qKgogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICB1aW50MjU2IF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKICAgIC8vIENoZWNrIGlzIG5vdCBuZWVkZWQgYmVjYXVzZSBzdWIoX2FsbG93YW5jZSwgX3ZhbHVlKSB3aWxsIGFscmVhZHkgdGhyb3cgaWYgdGhpcyBjb25kaXRpb24gaXMgbm90IG1ldAogICAgLy8gcmVxdWlyZSAoX3ZhbHVlIDw9IF9hbGxvd2FuY2UpOwogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQogIC8qKgogICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAqCiAgICogQmV3YXJlIHRoYXQgY2hhbmdpbmcgYW4gYWxsb3dhbmNlIHdpdGggdGhpcyBtZXRob2QgYnJpbmdzIHRoZSByaXNrIHRoYXQgc29tZW9uZSBtYXkgdXNlIGJvdGggdGhlIG9sZAogICAqIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZSB0cmFuc2FjdGlvbiBvcmRlcmluZy4gT25lIHBvc3NpYmxlIHNvbHV0aW9uIHRvIG1pdGlnYXRlIHRoaXMKICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgKi8KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQogIC8qKgogICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAogICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICovCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgfSBlbHNlIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQp9Ci8qKgogKiBAdGl0bGUgTWludGFibGUgdG9rZW4KICogQGRldiBTaW1wbGUgRVJDMjAgVG9rZW4gZXhhbXBsZSwgd2l0aCBtaW50YWJsZSB0b2tlbiBjcmVhdGlvbgogKiBAZGV2IElzc3VlOiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvaXNzdWVzLzEyMAogKiBCYXNlZCBvbiBjb2RlIGJ5IFRva2VuTWFya2V0TmV0OiBodHRwczovL2dpdGh1Yi5jb20vVG9rZW5NYXJrZXROZXQvaWNvL2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy9NaW50YWJsZVRva2VuLnNvbAogKi8KY29udHJhY3QgTWludGFibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwogIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwogIGJvb2wgcHVibGljIG1pbnRpbmdGaW5pc2hlZCA9IGZhbHNlOwogIG1vZGlmaWVyIGNhbk1pbnQoKSB7CiAgICByZXF1aXJlKCFtaW50aW5nRmluaXNoZWQpOwogICAgXzsKICB9CiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBtaW50IHRva2VucwogICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIG1pbnRlZCB0b2tlbnMuCiAgICogQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gbWludC4KICAgKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgb25seU93bmVyIGNhbk1pbnQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIC8vdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoX2Ftb3VudCk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICBNaW50KF90bywgX2Ftb3VudCk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF9hbW91bnQpOwogICAgcmV0dXJuIHRydWU7CiAgfQogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gc3RvcCBtaW50aW5nIG5ldyB0b2tlbnMuCiAgICogQHJldHVybiBUcnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gZmluaXNoTWludGluZygpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgIE1pbnRGaW5pc2hlZCgpOwogICAgcmV0dXJuIHRydWU7CiAgfQogIGZ1bmN0aW9uIGJ1cm5Ub2tlbnModWludDI1NiBfdW5zb2xkVG9rZW5zKSBvbmx5T3duZXIgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHRvdGFsU3VwcGx5ID0gU2FmZU1hdGguc3ViKHRvdGFsU3VwcGx5LCBfdW5zb2xkVG9rZW5zKTsKICB9Cn0KLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KLyoqCiAqIEB0aXRsZSBCZW5lYml0IENyb3dkc2FsZQogKiBAYXV0aG9yIEhhbXphIFlhc2luIHx8IEp1bmFpZCBNdXNodGFxCiAqIEBkZXYgQ3Jvd2RzYWxlIGlzIGEgYmFzZSBjb250cmFjdCBmb3IgbWFuYWdpbmcgYSB0b2tlbiBjcm93ZHNhbGUuCiAqIENyb3dkc2FsZXMgaGF2ZSBhIHN0YXJ0IGFuZCBlbmQgdGltZXN0YW1wcywgd2hlcmUgaW52ZXN0b3JzIGNhbiBtYWtlCiAqIHRva2VuIHB1cmNoYXNlcyBhbmQgdGhlIGNyb3dkc2FsZSB3aWxsIGFzc2lnbiB0aGVtIHRva2VucyBiYXNlZAogKiBvbiBhIHRva2VuIHBlciBFVEggcmF0ZS4gRnVuZHMgY29sbGVjdGVkIGFyZSBmb3J3YXJkZWQgdG8gYSB3YWxsZXQKICogYXMgdGhleSBhcnJpdmUuCiAqLwpjb250cmFjdCBDcm93ZHNhbGUgaXMgT3duYWJsZSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CiAgLy8gVGhlIHRva2VuIGJlaW5nIHNvbGQKICBNaW50YWJsZVRva2VuIHByaXZhdGUgdG9rZW47CiAgLy8gc3RhcnQgYW5kIGVuZCB0aW1lc3RhbXBzIHdoZXJlIGludmVzdG1lbnRzIGFyZSBhbGxvd2VkIChib3RoIGluY2x1c2l2ZSkKICB1aW50MjU2IHB1YmxpYyBwcmVTdGFydFRpbWU7CiAgdWludDI1NiBwdWJsaWMgcHJlRW5kVGltZTsKICB1aW50MjU2IHB1YmxpYyBJQ09zdGFydFRpbWU7CiAgdWludDI1NiBwdWJsaWMgSUNPRW5kVGltZTsKICAKICAvLyBCb251c2VzIHdpbGwgYmUgY2FsY3VsYXRlZCBoZXJlIG9mIElDTyBhbmQgUHJlLUlDTyAoYm90aCBpbmNsdXNpdmUpCiAgdWludDI1NiBwcml2YXRlIHByZUlDT0JvbnVzOwogIHVpbnQyNTYgcHJpdmF0ZSBmaXJzdFdlZWtCb251czsKICB1aW50MjU2IHByaXZhdGUgc2Vjb25kV2Vla0JvbnVzOwogIHVpbnQyNTYgcHJpdmF0ZSB0aGlyZFdlZWtCb251czsKICB1aW50MjU2IHByaXZhdGUgZm9ydGhXZWVrQm9udXM7CiAgCiAgCiAgLy8gd2FsbGV0IGFkZHJlc3Mgd2hlcmUgZnVuZHMgd2lsbCBiZSBzYXZlZAogIGFkZHJlc3MgaW50ZXJuYWwgd2FsbGV0OwogIAogIC8vIGJhc2UtcmF0ZSBvZiBhIHBhcnRpY3VsYXIgQmVuZWJpdCB0b2tlbgogIHVpbnQyNTYgcHVibGljIHJhdGU7CiAgLy8gYW1vdW50IG9mIHJhaXNlZCBtb25leSBpbiB3ZWkKICB1aW50MjU2IGludGVybmFsIHdlaVJhaXNlZDsKICAvLyBib251cyBkaXN0cmlidXRpb24gb24gYmVoYWxmIG9mIHdlZWtzCiAgdWludDI1NiB3ZWVrT25lOwogIHVpbnQyNTYgd2Vla1R3bzsKICB1aW50MjU2IHdlZWtUaHJlZTsKICB1aW50MjU2IHdlZWtGb3J0aDsKICAKICAvLyB0b3RhbCBzdXBwbHkgb2YgdG9rZW4gCiAgdWludDI1NiBwcml2YXRlIHRvdGFsU3VwcGx5ID0gMzAwMDAwMDAwICogKDEwKioxOCk7CiAgLy8gcHVibGljIHN1cHBseSBvZiB0b2tlbiAKICB1aW50MjU2IHByaXZhdGUgcHVibGljU3VwcGx5ID0gU2FmZU1hdGgubXVsKFNhZmVNYXRoLmRpdih0b3RhbFN1cHBseSwxMDApLDc1KTsKICAvLyByZXdhcmRzIHN1cHBseSBvZiB0b2tlbiAKICB1aW50MjU2IHByaXZhdGUgcmV3YXJkc1N1cHBseSA9IFNhZmVNYXRoLm11bChTYWZlTWF0aC5kaXYodG90YWxTdXBwbHksMTAwKSwxNSk7CiAgLy8gdGVhbSBzdXBwbHkgb2YgdG9rZW4gCiAgdWludDI1NiBwcml2YXRlIHRlYW1TdXBwbHkgPSBTYWZlTWF0aC5tdWwoU2FmZU1hdGguZGl2KHRvdGFsU3VwcGx5LDEwMCksNSk7CiAgLy8gYWR2aXNvciBzdXBwbHkgb2YgdG9rZW4gCiAgdWludDI1NiBwcml2YXRlIGFkdmlzb3JTdXBwbHkgPSBTYWZlTWF0aC5tdWwoU2FmZU1hdGguZGl2KHRvdGFsU3VwcGx5LDEwMCksMyk7CiAgLy8gYm91bnR5IHN1cHBseSBvZiB0b2tlbiAKICB1aW50MjU2IHByaXZhdGUgYm91bnR5U3VwcGx5ID0gU2FmZU1hdGgubXVsKFNhZmVNYXRoLmRpdih0b3RhbFN1cHBseSwxMDApLDIpOwogIC8vIHByZUlDTyBzdXBwbHkgb2YgdG9rZW4gCiAgdWludDI1NiBwcml2YXRlIHByZWljb1N1cHBseSA9IFNhZmVNYXRoLm11bChTYWZlTWF0aC5kaXYocHVibGljU3VwcGx5LDEwMCksMTUpOwogIC8vIElDTyBzdXBwbHkgb2YgdG9rZW4gCiAgdWludDI1NiBwcml2YXRlIGljb1N1cHBseSA9IFNhZmVNYXRoLm11bChTYWZlTWF0aC5kaXYocHVibGljU3VwcGx5LDEwMCksODUpOwogIC8vIFJlbWFpbmluZyBQdWJsaWMgU3VwcGx5IG9mIHRva2VuIAogIHVpbnQyNTYgcHJpdmF0ZSByZW1haW5pbmdQdWJsaWNTdXBwbHkgPSBwdWJsaWNTdXBwbHk7CiAgLy8gUmVtYWluaW5nIFJld2FyZCBTdXBwbHkgb2YgdG9rZW4gCiAgdWludDI1NiBwcml2YXRlIHJlbWFpbmluZ1Jld2FyZHNTdXBwbHkgPSByZXdhcmRzU3VwcGx5OwogIC8vIFJlbWFpbmluZyBCb3VudHkgU3VwcGx5IG9mIHRva2VuIAogIHVpbnQyNTYgcHJpdmF0ZSByZW1haW5pbmdCb3VudHlTdXBwbHkgPSBib3VudHlTdXBwbHk7CiAgLy8gUmVtYWluaW5nIEFkdmlzb3IgU3VwcGx5IG9mIHRva2VuIAogIHVpbnQyNTYgcHJpdmF0ZSByZW1haW5pbmdBZHZpc29yU3VwcGx5ID0gYWR2aXNvclN1cHBseTsKICAvLyBSZW1haW5pbmcgVGVhbSBTdXBwbHkgb2YgdG9rZW4gCiAgdWludDI1NiBwcml2YXRlIHJlbWFpbmluZ1RlYW1TdXBwbHkgPSB0ZWFtU3VwcGx5OwogIC8vIFRpbWUgbG9jayBvciB2ZXN0ZWQgcGVyaW9kIG9mIHRva2VuIGZvciB0ZWFtIGFsbG9jYXRlZCB0b2tlbgogIHVpbnQyNTYgcHJpdmF0ZSB0ZWFtVGltZUxvY2s7CiAgLy8gVGltZSBsb2NrIG9yIHZlc3RlZCBwZXJpb2Qgb2YgdG9rZW4gZm9yIEFkdmlzb3IgYWxsb2NhdGVkIHRva2VuCiAgdWludDI1NiBwcml2YXRlIGFkdmlzb3JUaW1lTG9jazsKICAvKioKICAgKiAgQGJvb2wgY2hlY2tCdXJuVG9rZW5zCiAgICogIEBib29sIHVwZ3JhZGVJQ09TdXBwbHkKICAgKiAgQGJvb2wgZ3JhbnRUZWFtU3VwcGx5CiAgICogIEBib29sIGdyYW50QWR2aXNvclN1cHBseSAgICAgCiAgKi8KICBib29sIHByaXZhdGUgY2hlY2tCdXJuVG9rZW5zOwogIGJvb2wgcHJpdmF0ZSB1cGdyYWRlSUNPU3VwcGx5OwogIGJvb2wgcHJpdmF0ZSBncmFudFRlYW1TdXBwbHk7CiAgYm9vbCBwcml2YXRlIGdyYW50QWR2aXNvclN1cHBseTsKICAvKioKICAgKiBldmVudCBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAqIEBwYXJhbSBwdXJjaGFzZXIgd2hvIHBhaWQgZm9yIHRoZSB0b2tlbnMKICAgKiBAcGFyYW0gYmVuZWZpY2lhcnkgd2hvIGdvdCB0aGUgdG9rZW5zCiAgICogQHBhcmFtIHZhbHVlIHdlaXMgcGFpZCBmb3IgcHVyY2hhc2UKICAgKiBAcGFyYW0gYW1vdW50IGFtb3VudCBvZiB0b2tlbnMgcHVyY2hhc2VkCiAgICovCiAgZXZlbnQgVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgdmFsdWUsIHVpbnQyNTYgYW1vdW50KTsKICAvLyBCZW5lYml0IENyb3dkc2FsZSBjb25zdHJ1Y3RvcgogIGZ1bmN0aW9uIENyb3dkc2FsZSh1aW50MjU2IF9zdGFydFRpbWUsIHVpbnQyNTYgX2VuZFRpbWUsIHVpbnQyNTYgX3JhdGUsIGFkZHJlc3MgX3dhbGxldCkgewogICAgcmVxdWlyZShfc3RhcnRUaW1lID49IG5vdyk7CiAgICByZXF1aXJlKF9lbmRUaW1lID49IF9zdGFydFRpbWUpOwogICAgcmVxdWlyZShfcmF0ZSA+IDApOwogICAgcmVxdWlyZShfd2FsbGV0ICE9IDB4MCk7CiAgICAvLyBCZW5lYml0IHRva2VuIGNyZWF0aW9uIAogICAgdG9rZW4gPSBjcmVhdGVUb2tlbkNvbnRyYWN0KCk7CiAgICAvLyBQcmUtSUNPIHN0YXJ0IFRpbWUKICAgIHByZVN0YXJ0VGltZSA9IF9zdGFydFRpbWU7CiAgICAvLyBQcmUtSUNPIGVuZCB0aW1lCiAgICBwcmVFbmRUaW1lID0gMTUxNjI4MDQwMDsKICAgIC8vIElDTyBzdGFydCBUaW1lCiAgICBJQ09zdGFydFRpbWUgPSAxNTE2NjI2MDAwOwogICAgLy8gSUNPIGVuZCBUaW1lCiAgICBJQ09FbmRUaW1lID0gX2VuZFRpbWU7CiAgICAvLyBCYXNlIFJhdGUgb2YgQk5FIFRva2VuCiAgICByYXRlID0gX3JhdGU7CiAgICAvLyBNdWx0aS1zaWcgd2FsbGV0IHdoZXJlIGZ1bmRzIHdpbGwgYmUgc2F2ZWQKICAgIHdhbGxldCA9IF93YWxsZXQ7CiAgICAvKiogQ2FsY3VsYXRpb25zIG9mIEJvbnVzZXMgaW4gSUNPIG9yIFByZS1JQ08gKi8KICAgIHByZUlDT0JvbnVzID0gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChyYXRlLDMwKSwxMDApOwogICAgZmlyc3RXZWVrQm9udXMgPSBTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKHJhdGUsMjApLDEwMCk7CiAgICBzZWNvbmRXZWVrQm9udXMgPSBTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKHJhdGUsMTUpLDEwMCk7CiAgICB0aGlyZFdlZWtCb251cyA9IFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwocmF0ZSwxMCksMTAwKTsKICAgIGZvcnRoV2Vla0JvbnVzID0gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChyYXRlLDUpLDEwMCk7CiAgICAvKiogSUNPIGJvbnVzZXMgd2VlayBjYWxjdWxhdGlvbnMgKi8KICAgIHdlZWtPbmUgPSBTYWZlTWF0aC5hZGQoSUNPc3RhcnRUaW1lLCA2MDQ4MDApOwogICAgd2Vla1R3byA9IFNhZmVNYXRoLmFkZCh3ZWVrT25lLCA2MDQ4MDApOwogICAgd2Vla1RocmVlID0gU2FmZU1hdGguYWRkKHdlZWtUd28sIDYwNDgwMCk7CiAgICB3ZWVrRm9ydGggPSBTYWZlTWF0aC5hZGQod2Vla1RocmVlLCA2MDQ4MDApOwogICAgLyoqIFZlc3RlZCBQZXJpb2QgY2FsY3VsYXRpb25zIGZvciB0ZWFtIGFuZCBhZHZpc29ycyovCiAgICB0ZWFtVGltZUxvY2sgPSBTYWZlTWF0aC5hZGQoSUNPRW5kVGltZSwgMzE1MzYwMDApOwogICAgYWR2aXNvclRpbWVMb2NrID0gU2FmZU1hdGguYWRkKElDT0VuZFRpbWUsIDUzNTY4MDApOwogICAgCiAgICBjaGVja0J1cm5Ub2tlbnMgPSBmYWxzZTsKICAgIHVwZ3JhZGVJQ09TdXBwbHkgPSBmYWxzZTsKICAgIGdyYW50QWR2aXNvclN1cHBseSA9IGZhbHNlOwogICAgZ3JhbnRUZWFtU3VwcGx5ID0gZmFsc2U7CiAgfQogIC8vIGNyZWF0ZXMgdGhlIHRva2VuIHRvIGJlIHNvbGQuCiAgLy8gb3ZlcnJpZGUgdGhpcyBtZXRob2QgdG8gaGF2ZSBjcm93ZHNhbGUgb2YgYSBzcGVjaWZpYyBtaW50YWJsZSB0b2tlbi4KICBmdW5jdGlvbiBjcmVhdGVUb2tlbkNvbnRyYWN0KCkgaW50ZXJuYWwgcmV0dXJucyAoTWludGFibGVUb2tlbikgewogICAgcmV0dXJuIG5ldyBNaW50YWJsZVRva2VuKCk7CiAgfQogIAogIC8vIGZhbGxiYWNrIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIGJ1eSB0b2tlbnMKICBmdW5jdGlvbiAoKSBwYXlhYmxlIHsKICAgIGJ1eVRva2Vucyhtc2cuc2VuZGVyKTsKICAgIAogIH0KICAvLyBIaWdoIGxldmVsIHRva2VuIHB1cmNoYXNlIGZ1bmN0aW9uCiAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnkpIHB1YmxpYyBwYXlhYmxlIHsKICAgIHJlcXVpcmUoYmVuZWZpY2lhcnkgIT0gMHgwKTsKICAgIHJlcXVpcmUodmFsaWRQdXJjaGFzZSgpKTsKICAgIHVpbnQyNTYgd2VpQW1vdW50ID0gbXNnLnZhbHVlOwogICAgLy8gbWluaW11bSBpbnZlc3RtZW50IHNob3VsZCBiZSAwLjA1IEVUSAogICAgcmVxdWlyZSh3ZWlBbW91bnQgPj0gKDAuMDUgKiAxIGV0aGVyKSk7CiAgICAKICAgIHVpbnQyNTYgYWNjZXNzVGltZSA9IG5vdzsKICAgIHVpbnQyNTYgdG9rZW5zID0gMDsKICAvLyBjYWxjdWxhdGluZyB0aGUgSUNPIGFuZCBQcmUtSUNPIGJvbnVzZXMgb24gdGhlIGJhc2lzIG9mIHRpbWluZwogICAgaWYgKChhY2Nlc3NUaW1lID49IHByZVN0YXJ0VGltZSkgJiYgKGFjY2Vzc1RpbWUgPCBwcmVFbmRUaW1lKSkgewogICAgICAgIHJlcXVpcmUocHJlaWNvU3VwcGx5ID4gMCk7CiAgICAgICAgdG9rZW5zID0gU2FmZU1hdGguYWRkKHRva2Vucywgd2VpQW1vdW50Lm11bChwcmVJQ09Cb251cykpOwogICAgICAgIHRva2VucyA9IFNhZmVNYXRoLmFkZCh0b2tlbnMsIHdlaUFtb3VudC5tdWwocmF0ZSkpOwogICAgICAgIAogICAgICAgIHJlcXVpcmUocHJlaWNvU3VwcGx5ID49IHRva2Vucyk7CiAgICAgICAgCiAgICAgICAgcHJlaWNvU3VwcGx5ID0gcHJlaWNvU3VwcGx5LnN1Yih0b2tlbnMpOyAgICAgICAgCiAgICAgICAgcmVtYWluaW5nUHVibGljU3VwcGx5ID0gcmVtYWluaW5nUHVibGljU3VwcGx5LnN1Yih0b2tlbnMpOwogICAgfSBlbHNlIGlmICgoYWNjZXNzVGltZSA+PSBJQ09zdGFydFRpbWUpICYmIChhY2Nlc3NUaW1lIDw9IElDT0VuZFRpbWUpKSB7CiAgICAgICAgaWYgKCF1cGdyYWRlSUNPU3VwcGx5KSB7CiAgICAgICAgICBpY29TdXBwbHkgPSBTYWZlTWF0aC5hZGQoaWNvU3VwcGx5LHByZWljb1N1cHBseSk7CiAgICAgICAgICB1cGdyYWRlSUNPU3VwcGx5ID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKCBhY2Nlc3NUaW1lIDw9IHdlZWtPbmUgKSB7CiAgICAgICAgICB0b2tlbnMgPSBTYWZlTWF0aC5hZGQodG9rZW5zLCB3ZWlBbW91bnQubXVsKGZpcnN0V2Vla0JvbnVzKSk7CiAgICAgICAgfSBlbHNlIGlmIChhY2Nlc3NUaW1lIDw9IHdlZWtUd28pIHsKICAgICAgICAgIHRva2VucyA9IFNhZmVNYXRoLmFkZCh0b2tlbnMsIHdlaUFtb3VudC5tdWwoc2Vjb25kV2Vla0JvbnVzKSk7CiAgICAgICAgfSBlbHNlIGlmICggYWNjZXNzVGltZSA8IHdlZWtUaHJlZSApIHsKICAgICAgICAgIHRva2VucyA9IFNhZmVNYXRoLmFkZCh0b2tlbnMsIHdlaUFtb3VudC5tdWwodGhpcmRXZWVrQm9udXMpKTsKICAgICAgICB9IGVsc2UgaWYgKCBhY2Nlc3NUaW1lIDwgd2Vla0ZvcnRoICkgewogICAgICAgICAgdG9rZW5zID0gU2FmZU1hdGguYWRkKHRva2Vucywgd2VpQW1vdW50Lm11bChmb3J0aFdlZWtCb251cykpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICB0b2tlbnMgPSBTYWZlTWF0aC5hZGQodG9rZW5zLCB3ZWlBbW91bnQubXVsKHJhdGUpKTsKICAgICAgICBpY29TdXBwbHkgPSBpY29TdXBwbHkuc3ViKHRva2Vucyk7ICAgICAgICAKICAgICAgICByZW1haW5pbmdQdWJsaWNTdXBwbHkgPSByZW1haW5pbmdQdWJsaWNTdXBwbHkuc3ViKHRva2Vucyk7CiAgICB9IGVsc2UgaWYgKChhY2Nlc3NUaW1lID4gcHJlRW5kVGltZSkgJiYgKGFjY2Vzc1RpbWUgPCBJQ09zdGFydFRpbWUpKXsKICAgICAgcmV2ZXJ0KCk7CiAgICB9CiAgICAvLyB1cGRhdGUgc3RhdGUKICAgIHdlaVJhaXNlZCA9IHdlaVJhaXNlZC5hZGQod2VpQW1vdW50KTsKICAgIC8vIHRva2VucyBhcmUgbWludGluZyBoZXJlCiAgICB0b2tlbi5taW50KGJlbmVmaWNpYXJ5LCB0b2tlbnMpOwogICAgVG9rZW5QdXJjaGFzZShtc2cuc2VuZGVyLCBiZW5lZmljaWFyeSwgd2VpQW1vdW50LCB0b2tlbnMpOwogICAgLy8gZnVuZHMgYXJlIGZvcndhcmRpbmcKICAgIGZvcndhcmRGdW5kcygpOwogIH0KICAvLyBzZW5kIGV0aGVyIHRvIHRoZSBmdW5kIGNvbGxlY3Rpb24gd2FsbGV0CiAgLy8gb3ZlcnJpZGUgdG8gY3JlYXRlIGN1c3RvbSBmdW5kIGZvcndhcmRpbmcgbWVjaGFuaXNtcwogIGZ1bmN0aW9uIGZvcndhcmRGdW5kcygpIGludGVybmFsIHsKICAgIHdhbGxldC50cmFuc2Zlcihtc2cudmFsdWUpOwogIH0KICAvLyBAcmV0dXJuIHRydWUgaWYgdGhlIHRyYW5zYWN0aW9uIGNhbiBidXkgdG9rZW5zCiAgZnVuY3Rpb24gdmFsaWRQdXJjaGFzZSgpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgIGJvb2wgd2l0aGluUGVyaW9kID0gbm93ID49IHByZVN0YXJ0VGltZSAmJiBub3cgPD0gSUNPRW5kVGltZTsKICAgIGJvb2wgbm9uWmVyb1B1cmNoYXNlID0gbXNnLnZhbHVlICE9IDA7CiAgICByZXR1cm4gd2l0aGluUGVyaW9kICYmIG5vblplcm9QdXJjaGFzZTsKICB9CiAgLy8gQHJldHVybiB0cnVlIGlmIGNyb3dkc2FsZSBldmVudCBoYXMgZW5kZWQKICBmdW5jdGlvbiBoYXNFbmRlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgIHJldHVybiBub3cgPiBJQ09FbmRUaW1lOwogIH0KICAvLyBAcmV0dXJuIHRydWUgaWYgYnVyblRva2VuIGZ1bmN0aW9uIGhhcyBlbmRlZAogIGZ1bmN0aW9uIGJ1cm5Ub2tlbigpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShoYXNFbmRlZCgpKTsKICAgIHJlcXVpcmUoIWNoZWNrQnVyblRva2Vucyk7CiAgICB0b2tlbi5idXJuVG9rZW5zKHJlbWFpbmluZ1B1YmxpY1N1cHBseSk7CiAgICB0b3RhbFN1cHBseSA9IFNhZmVNYXRoLnN1Yih0b3RhbFN1cHBseSwgcmVtYWluaW5nUHVibGljU3VwcGx5KTsKICAgIHJlbWFpbmluZ1B1YmxpY1N1cHBseSA9IDA7CiAgICBjaGVja0J1cm5Ub2tlbnMgPSB0cnVlOwogICAgcmV0dXJuIHRydWU7CiAgfQogIC8qKiAKICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBib3VudHlGdW5kcyBmdW5jdGlvbiBoYXMgZW5kZWQKICAgICAqIEBwYXJhbSBiZW5lZmljaWFyeSBhZGRyZXNzIHdoZXJlIG93bmVyIHdhbnRzIHRvIHRyYW5zZmVyIHRva2VucwogICAgICogQHBhcmFtIHZhbHVlVG9rZW4gdmFsdWUgb2YgdG9rZW4KICAqLwogIGZ1bmN0aW9uIGJvdW50eUZ1bmRzKGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQyNTYgdmFsdWVUb2tlbikgb25seU93bmVyIHB1YmxpYyBwYXlhYmxlIHsgCiAgICB2YWx1ZVRva2VuID0gU2FmZU1hdGgubXVsKHZhbHVlVG9rZW4sIDEgZXRoZXIpOwogICAgcmVxdWlyZShyZW1haW5pbmdCb3VudHlTdXBwbHkgPj0gdmFsdWVUb2tlbik7CiAgICByZW1haW5pbmdCb3VudHlTdXBwbHkgPSBTYWZlTWF0aC5zdWIocmVtYWluaW5nQm91bnR5U3VwcGx5LHZhbHVlVG9rZW4pOwogICAgdG9rZW4ubWludChiZW5lZmljaWFyeSwgdmFsdWVUb2tlbik7CiAgfQogIC8qKiAKICAgICAqIEByZXR1cm4gdHJ1ZSBpZiByZXdhcmRzRnVuZHMgZnVuY3Rpb24gaGFzIGVuZGVkCiAgICAgKiBAcGFyYW0gYmVuZWZpY2lhcnkgYWRkcmVzcyB3aGVyZSBvd25lciB3YW50cyB0byB0cmFuc2ZlciB0b2tlbnMKICAgICAqIEBwYXJhbSB2YWx1ZVRva2VuIHZhbHVlIG9mIHRva2VuCiAgKi8KICBmdW5jdGlvbiByZXdhcmRzRnVuZHMoYWRkcmVzcyBiZW5lZmljaWFyeSwgdWludDI1NiB2YWx1ZVRva2VuKSBvbmx5T3duZXIgcHVibGljIHBheWFibGUgeyAKICAgIHZhbHVlVG9rZW4gPSBTYWZlTWF0aC5tdWwodmFsdWVUb2tlbiwgMSBldGhlcik7CiAgICByZXF1aXJlKHJlbWFpbmluZ1Jld2FyZHNTdXBwbHkgPj0gdmFsdWVUb2tlbik7CiAgICByZW1haW5pbmdSZXdhcmRzU3VwcGx5ID0gU2FmZU1hdGguc3ViKHJlbWFpbmluZ1Jld2FyZHNTdXBwbHksdmFsdWVUb2tlbik7CiAgICB0b2tlbi5taW50KGJlbmVmaWNpYXJ5LCB2YWx1ZVRva2VuKTsKICB9IAogIC8qKgogICAgICBAcmV0dXJuIHRydWUgaWYgZ3JhbnRBZHZpc29yVG9rZW4gZnVuY3Rpb24gaGFzIGVuZGVkICAKICAqLwogIGZ1bmN0aW9uIGdyYW50QWR2aXNvclRva2VuKCkgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKCFncmFudEFkdmlzb3JTdXBwbHkpOwogICAgcmVxdWlyZShub3cgPiBhZHZpc29yVGltZUxvY2spOwogICAgdWludDI1NiB2YWx1ZVRva2VuID0gU2FmZU1hdGguZGl2KHJlbWFpbmluZ0Fkdmlzb3JTdXBwbHksMyk7CiAgICByZXF1aXJlKHJlbWFpbmluZ0Fkdmlzb3JTdXBwbHkgPj0gdmFsdWVUb2tlbik7CiAgICBncmFudEFkdmlzb3JTdXBwbHkgPSB0cnVlOwogICAgdG9rZW4ubWludCgweEFBODU1ZjZEODdkNUQ0NDNlRGE0OWFBMDM0ZkE5OUQ5RWVlQTAzMzcsIHZhbHVlVG9rZW4pOwogICAgdG9rZW4ubWludCgweDRCMmUzRTFCQkViMTE3Yjc4MWU3MUExMDM3NkE5Njk4NjBGQmNFQjMsIHZhbHVlVG9rZW4pOwogICAgdG9rZW4ubWludCgweGJiM2IzNzk5RDFiMzExODliNDkxQzI2QjFEN2MxNzMwN2ZiODdGNWQsIHZhbHVlVG9rZW4pOwogICAgcmVtYWluaW5nQWR2aXNvclN1cHBseSA9IDA7CiAgfQogIC8qKgogICAgICBAcmV0dXJuIHRydWUgaWYgZ3JhbnRUZWFtVG9rZW4gZnVuY3Rpb24gaGFzIGVuZGVkICAKICAqLwogICAgZnVuY3Rpb24gZ3JhbnRUZWFtVG9rZW4oKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUoIWdyYW50VGVhbVN1cHBseSk7CiAgICByZXF1aXJlKG5vdyA+IHRlYW1UaW1lTG9jayk7CiAgICB1aW50MjU2IHZhbHVlVG9rZW4gPSBTYWZlTWF0aC5kaXYocmVtYWluaW5nVGVhbVN1cHBseSwgNSk7CiAgICByZXF1aXJlKHJlbWFpbmluZ1RlYW1TdXBwbHkgPj0gdmFsdWVUb2tlbik7CiAgICBncmFudFRlYW1TdXBwbHkgPSB0cnVlOwogICAgdG9rZW4ubWludCgweEJFQjllNDA1N2Y5NTNBYUJkRjE0RGM0MDE4MDU2ODg4QzY3RTQwYjAsIHZhbHVlVG9rZW4pOwogICAgdG9rZW4ubWludCgweDcwZmNkMDc2MjllQjliNDA2MjIzMTY4QUVCOERlMDZFMjU2NEY1NTgsIHZhbHVlVG9rZW4pOwogICAgdG9rZW4ubWludCgweDBlNTYyZjEyMjM5QzY2MDYyN2JFMTg2ZGU2NTM1YzA1OTgzNTc5RTksIHZhbHVlVG9rZW4pOwogICAgdG9rZW4ubWludCgweDQyZTA0NWY0RDExOTIxMkFDMUNGNTgyMDQ4OEU2OUFBOTE2NERDNzAsIHZhbHVlVG9rZW4pOwogICAgdG9rZW4ubWludCgweDJmNTM2NzhhMzNDMGZFRThmMzBmYzVjZmFDNEU1RTE0MDM5N2I0MEQsIHZhbHVlVG9rZW4pOwogICAgcmVtYWluaW5nVGVhbVN1cHBseSA9IDA7CiAgICAKICB9Ci8qKiAKICAgKiBGdW5jdGlvbiB0cmFuc2ZlclRva2VuIHdvcmtzIHRvIHRyYW5zZmVyIHRva2VucyB0byB0aGUgc3BlY2lmaWVkIGFkZHJlc3Mgb24gdGhlCiAgICAgY2FsbCBvZiBvd25lciB3aXRoaW4gdGhlIGNyb3dkc2FsZSB0aW1lc3RhbXAuCiAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IGFkZHJlc3Mgd2hlcmUgb3duZXIgd2FudHMgdG8gdHJhbnNmZXIgdG9rZW5zCiAgICogQHBhcmFtIHRva2VucyB2YWx1ZSBvZiB0b2tlbgogKi8KICBmdW5jdGlvbiB0cmFuc2ZlclRva2VuKGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQyNTYgdG9rZW5zKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUoSUNPRW5kVGltZSA+IG5vdyk7CiAgICB0b2tlbnMgPSBTYWZlTWF0aC5tdWwodG9rZW5zLDEgZXRoZXIpOwogICAgcmVxdWlyZShyZW1haW5pbmdQdWJsaWNTdXBwbHkgPj0gdG9rZW5zKTsKICAgIHJlbWFpbmluZ1B1YmxpY1N1cHBseSA9IFNhZmVNYXRoLnN1YihyZW1haW5pbmdQdWJsaWNTdXBwbHksdG9rZW5zKTsKICAgIHRva2VuLm1pbnQoYmVuZWZpY2lhcnksIHRva2Vucyk7CiAgfQogIGZ1bmN0aW9uIGdldFRva2VuQWRkcmVzcygpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYWRkcmVzcykgewogICAgcmV0dXJuIHRva2VuOwogIH0KICBmdW5jdGlvbiBnZXRQdWJsaWNTdXBwbHkoKSBvbmx5T3duZXIgcHVibGljIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiByZW1haW5pbmdQdWJsaWNTdXBwbHk7CiAgfQp9Ci8qKgogKiBAdGl0bGUgQ2FwcGVkQ3Jvd2RzYWxlCiAqIEBkZXYgRXh0ZW5zaW9uIG9mIENyb3dkc2FsZSB3aXRoIGEgbWF4IGFtb3VudCBvZiBmdW5kcyByYWlzZWQKICovCmNvbnRyYWN0IENhcHBlZENyb3dkc2FsZSBpcyBDcm93ZHNhbGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogIHVpbnQyNTYgcHVibGljIGNhcDsKICBmdW5jdGlvbiBDYXBwZWRDcm93ZHNhbGUodWludDI1NiBfY2FwKSB7CiAgICByZXF1aXJlKF9jYXAgPiAwKTsKICAgIGNhcCA9IF9jYXA7CiAgfQogIC8vIG92ZXJyaWRpbmcgQ3Jvd2RzYWxlI3ZhbGlkUHVyY2hhc2UgdG8gYWRkIGV4dHJhIGNhcCBsb2dpYwogIC8vIEByZXR1cm4gdHJ1ZSBpZiBpbnZlc3RvcnMgY2FuIGJ1eSBhdCB0aGUgbW9tZW50CiAgZnVuY3Rpb24gdmFsaWRQdXJjaGFzZSgpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgIGJvb2wgd2l0aGluQ2FwID0gd2VpUmFpc2VkLmFkZChtc2cudmFsdWUpIDw9IGNhcDsKICAgIHJldHVybiBzdXBlci52YWxpZFB1cmNoYXNlKCkgJiYgd2l0aGluQ2FwOwogIH0KICAvLyBvdmVycmlkaW5nIENyb3dkc2FsZSNoYXNFbmRlZCB0byBhZGQgY2FwIGxvZ2ljCiAgLy8gQHJldHVybiB0cnVlIGlmIGNyb3dkc2FsZSBldmVudCBoYXMgZW5kZWQKICBmdW5jdGlvbiBoYXNFbmRlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICBib29sIGNhcFJlYWNoZWQgPSB3ZWlSYWlzZWQgPj0gY2FwOwogICAgcmV0dXJuIHN1cGVyLmhhc0VuZGVkKCkgfHwgY2FwUmVhY2hlZDsKICB9Cn0KLyoqCiAqIEB0aXRsZSBGaW5hbGl6YWJsZUNyb3dkc2FsZQogKiBAZGV2IEV4dGVuc2lvbiBvZiBDcm93ZHNhbGUgd2hlcmUgYW4gb3duZXIgY2FuIGRvIGV4dHJhIHdvcmsKICogYWZ0ZXIgZmluaXNoaW5nLgogKi8KY29udHJhY3QgRmluYWxpemFibGVDcm93ZHNhbGUgaXMgQ3Jvd2RzYWxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKICBib29sIGlzRmluYWxpemVkID0gZmFsc2U7CiAgZXZlbnQgRmluYWxpemVkKCk7CiAgLyoqCiAgICogQGRldiBNdXN0IGJlIGNhbGxlZCBhZnRlciBjcm93ZHNhbGUgZW5kcywgdG8gZG8gc29tZSBleHRyYSBmaW5hbGl6YXRpb24KICAgKiB3b3JrLiBDYWxscyB0aGUgY29udHJhY3QncyBmaW5hbGl6YXRpb24gZnVuY3Rpb24uCiAgICovCiAgZnVuY3Rpb24gZmluYWxpemUoKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUoIWlzRmluYWxpemVkKTsKICAgIHJlcXVpcmUoaGFzRW5kZWQoKSk7CiAgICBmaW5hbGl6YXRpb24oKTsKICAgIEZpbmFsaXplZCgpOwogICAgaXNGaW5hbGl6ZWQgPSB0cnVlOwogIH0KICAvKioKICAgKiBAZGV2IENhbiBiZSBvdmVycmlkZGVuIHRvIGFkZCBmaW5hbGl6YXRpb24gbG9naWMuIFRoZSBvdmVycmlkaW5nIGZ1bmN0aW9uCiAgICogc2hvdWxkIGNhbGwgc3VwZXIuZmluYWxpemF0aW9uKCkgdG8gZW5zdXJlIHRoZSBjaGFpbiBvZiBmaW5hbGl6YXRpb24gaXMKICAgKiBleGVjdXRlZCBlbnRpcmVseS4KICAgKi8KICBmdW5jdGlvbiBmaW5hbGl6YXRpb24oKSBpbnRlcm5hbCB7CiAgfQp9Ci8qKgogKiBAdGl0bGUgUmVmdW5kVmF1bHQKICogQGRldiBUaGlzIGNvbnRyYWN0IGlzIHVzZWQgZm9yIHN0b3JpbmcgZnVuZHMgd2hpbGUgYSBjcm93ZHNhbGUKICogaXMgaW4gcHJvZ3Jlc3MuIFN1cHBvcnRzIHJlZnVuZGluZyB0aGUgbW9uZXkgaWYgY3Jvd2RzYWxlIGZhaWxzLAogKiBhbmQgZm9yd2FyZGluZyBpdCBpZiBjcm93ZHNhbGUgaXMgc3VjY2Vzc2Z1bC4KICovCmNvbnRyYWN0IFJlZnVuZFZhdWx0IGlzIE93bmFibGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogIGVudW0gU3RhdGUgeyBBY3RpdmUsIFJlZnVuZGluZywgQ2xvc2VkIH0KICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBkZXBvc2l0ZWQ7CiAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0OwogIFN0YXRlIHB1YmxpYyBzdGF0ZTsKICBldmVudCBDbG9zZWQoKTsKICBldmVudCBSZWZ1bmRzRW5hYmxlZCgpOwogIGV2ZW50IFJlZnVuZGVkKGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB3ZWlBbW91bnQpOwogIGZ1bmN0aW9uIFJlZnVuZFZhdWx0KGFkZHJlc3MgX3dhbGxldCkgewogICAgcmVxdWlyZShfd2FsbGV0ICE9IDB4MCk7CiAgICB3YWxsZXQgPSBfd2FsbGV0OwogICAgc3RhdGUgPSBTdGF0ZS5BY3RpdmU7CiAgfQogIGZ1bmN0aW9uIGRlcG9zaXQoYWRkcmVzcyBpbnZlc3Rvcikgb25seU93bmVyIHB1YmxpYyBwYXlhYmxlIHsKICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuQWN0aXZlKTsKICAgIGRlcG9zaXRlZFtpbnZlc3Rvcl0gPSBkZXBvc2l0ZWRbaW52ZXN0b3JdLmFkZChtc2cudmFsdWUpOwogIH0KICBmdW5jdGlvbiBjbG9zZSgpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5BY3RpdmUpOwogICAgc3RhdGUgPSBTdGF0ZS5DbG9zZWQ7CiAgICBDbG9zZWQoKTsKICAgIHdhbGxldC50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogIH0KICBmdW5jdGlvbiBlbmFibGVSZWZ1bmRzKCkgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLkFjdGl2ZSk7CiAgICBzdGF0ZSA9IFN0YXRlLlJlZnVuZGluZzsKICAgIFJlZnVuZHNFbmFibGVkKCk7CiAgfQogIGZ1bmN0aW9uIHJlZnVuZChhZGRyZXNzIGludmVzdG9yKSBwdWJsaWMgewogICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5SZWZ1bmRpbmcpOwogICAgdWludDI1NiBkZXBvc2l0ZWRWYWx1ZSA9IGRlcG9zaXRlZFtpbnZlc3Rvcl07CiAgICBkZXBvc2l0ZWRbaW52ZXN0b3JdID0gMDsKICAgIGludmVzdG9yLnRyYW5zZmVyKGRlcG9zaXRlZFZhbHVlKTsKICAgIFJlZnVuZGVkKGludmVzdG9yLCBkZXBvc2l0ZWRWYWx1ZSk7CiAgfQp9Ci8qKgogKiBAdGl0bGUgUmVmdW5kYWJsZUNyb3dkc2FsZQogKiBAZGV2IEV4dGVuc2lvbiBvZiBDcm93ZHNhbGUgY29udHJhY3QgdGhhdCBhZGRzIGEgZnVuZGluZyBnb2FsLCBhbmQKICogdGhlIHBvc3NpYmlsaXR5IG9mIHVzZXJzIGdldHRpbmcgYSByZWZ1bmQgaWYgZ29hbCBpcyBub3QgbWV0LgogKiBVc2VzIGEgUmVmdW5kVmF1bHQgYXMgdGhlIGNyb3dkc2FsZSdzIHZhdWx0LgogKi8KY29udHJhY3QgUmVmdW5kYWJsZUNyb3dkc2FsZSBpcyBGaW5hbGl6YWJsZUNyb3dkc2FsZSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CiAgLy8gbWluaW11bSBhbW91bnQgb2YgZnVuZHMgdG8gYmUgcmFpc2VkIGluIHdlaXMKICB1aW50MjU2IHB1YmxpYyBnb2FsOwogIGJvb2wgcHJpdmF0ZSBfZ29hbFJlYWNoZWQgPSBmYWxzZTsKICAvLyByZWZ1bmQgdmF1bHQgdXNlZCB0byBob2xkIGZ1bmRzIHdoaWxlIGNyb3dkc2FsZSBpcyBydW5uaW5nCiAgUmVmdW5kVmF1bHQgcHJpdmF0ZSB2YXVsdDsKICBmdW5jdGlvbiBSZWZ1bmRhYmxlQ3Jvd2RzYWxlKHVpbnQyNTYgX2dvYWwpIHsKICAgIHJlcXVpcmUoX2dvYWwgPiAwKTsKICAgIHZhdWx0ID0gbmV3IFJlZnVuZFZhdWx0KHdhbGxldCk7CiAgICBnb2FsID0gX2dvYWw7CiAgfQogIC8vIFdlJ3JlIG92ZXJyaWRpbmcgdGhlIGZ1bmQgZm9yd2FyZGluZyBmcm9tIENyb3dkc2FsZS4KICAvLyBJbiBhZGRpdGlvbiB0byBzZW5kaW5nIHRoZSBmdW5kcywgd2Ugd2FudCB0byBjYWxsCiAgLy8gdGhlIFJlZnVuZFZhdWx0IGRlcG9zaXQgZnVuY3Rpb24KICBmdW5jdGlvbiBmb3J3YXJkRnVuZHMoKSBpbnRlcm5hbCB7CiAgICB2YXVsdC5kZXBvc2l0LnZhbHVlKG1zZy52YWx1ZSkobXNnLnNlbmRlcik7CiAgfQogIC8vIGlmIGNyb3dkc2FsZSBpcyB1bnN1Y2Nlc3NmdWwsIGludmVzdG9ycyBjYW4gY2xhaW0gcmVmdW5kcyBoZXJlCiAgZnVuY3Rpb24gY2xhaW1SZWZ1bmQoKSBwdWJsaWMgewogICAgcmVxdWlyZShpc0ZpbmFsaXplZCk7CiAgICByZXF1aXJlKCFnb2FsUmVhY2hlZCgpKTsKICAgIHZhdWx0LnJlZnVuZChtc2cuc2VuZGVyKTsKICB9CiAgLy8gdmF1bHQgZmluYWxpemF0aW9uIHRhc2ssIGNhbGxlZCB3aGVuIG93bmVyIGNhbGxzIGZpbmFsaXplKCkKICBmdW5jdGlvbiBmaW5hbGl6YXRpb24oKSBpbnRlcm5hbCB7CiAgICBpZiAoZ29hbFJlYWNoZWQoKSkgewogICAgICB2YXVsdC5jbG9zZSgpOwogICAgfSBlbHNlIHsKICAgICAgdmF1bHQuZW5hYmxlUmVmdW5kcygpOwogICAgfQogICAgc3VwZXIuZmluYWxpemF0aW9uKCk7CiAgfQogIGZ1bmN0aW9uIGdvYWxSZWFjaGVkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgIGlmICh3ZWlSYWlzZWQgPj0gZ29hbCkgewogICAgICBfZ29hbFJlYWNoZWQgPSB0cnVlOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gZWxzZSBpZiAoX2dvYWxSZWFjaGVkKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSAKICAgIGVsc2UgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHVwZGF0ZUdvYWxDaGVjaygpIG9ubHlPd25lciBwdWJsaWMgewogICAgX2dvYWxSZWFjaGVkID0gdHJ1ZTsKICB9CiAgZnVuY3Rpb24gZ2V0VmF1bHRBZGRyZXNzKCkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICByZXR1cm4gdmF1bHQ7CiAgfQp9Ci8qKgogKiBAdGl0bGUgQmVuZWJpdFRva2VuCiAqIEBhdXRob3IgSGFtemEgWWFzaW4gfHwgSnVuYWlkIE11c2h0YXEKICovCmNvbnRyYWN0IEJlbmViaXRUb2tlbiBpcyBNaW50YWJsZVRva2VuIHsKICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiQmVuZWJpdFRva2VuIjsKICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJCTkUiOwogIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CiAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgX3RvdGFsU3VwcGx5ID0gMzAwMDAwMDAwICogMSBldGhlcjsKICAKLyoqIENvbnN0cnVjdG9yIEJlbmViaXRUb2tlbiAqLwogIGZ1bmN0aW9uIEJlbmViaXRUb2tlbigpIHsKICAgIHRvdGFsU3VwcGx5ID0gX3RvdGFsU3VwcGx5OwogIH0KfQpjb250cmFjdCBCZW5lYml0SUNPIGlzIENyb3dkc2FsZSwgQ2FwcGVkQ3Jvd2RzYWxlLCBSZWZ1bmRhYmxlQ3Jvd2RzYWxlIHsKICAgIHVpbnQyNTYgX3N0YXJ0VGltZSA9IDE1MTQyMDY4MDA7CiAgICB1aW50MjU2IF9lbmRUaW1lID0gMTUxOTgyMjgwMDsgCiAgICB1aW50MjU2IF9yYXRlID0gMzAwMDsKICAgIHVpbnQyNTYgX2dvYWwgPSA1MDAwICogMSBldGhlcjsKICAgIHVpbnQyNTYgX2NhcCA9IDc1MDAwICogMSBldGhlcjsKICAgIGFkZHJlc3MgX3dhbGxldCAgPSAweDg4QmZCZDJCNDY0QzE1YjI0NUE5ZjdhNTYzRDIwN2JkOEExNjEwNTQ7ICAgCiAgICAvKiogQ29uc3RydWN0b3IgQmVuZWJpdElDTyAqLwogICAgZnVuY3Rpb24gQmVuZWJpdElDTygpIAogICAgQ2FwcGVkQ3Jvd2RzYWxlKF9jYXApCiAgICBGaW5hbGl6YWJsZUNyb3dkc2FsZSgpCiAgICBSZWZ1bmRhYmxlQ3Jvd2RzYWxlKF9nb2FsKQogICAgQ3Jvd2RzYWxlKF9zdGFydFRpbWUsX2VuZFRpbWUsX3JhdGUsX3dhbGxldCkgCiAgICB7CiAgICAgICAgCiAgICB9CiAgICAvKiogQmVuZWJpdFRva2VuIENvbnRyYWN0IGlzIGdlbmVyYXRpbmcgZnJvbSBoZXJlICovCiAgICBmdW5jdGlvbiBjcmVhdGVUb2tlbkNvbnRyYWN0KCkgaW50ZXJuYWwgcmV0dXJucyAoTWludGFibGVUb2tlbikgewogICAgICAgIHJldHVybiBuZXcgQmVuZWJpdFRva2VuKCk7CiAgICB9Cn0='.
	

]
