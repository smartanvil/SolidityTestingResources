Class {
	#name : #SRT615ed6779507f223d04722d43ccc0cd871964e2a,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT615ed6779507f223d04722d43ccc0cd871964e2a >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIEdpZnRvIFRva2VuIGJ5IEdpZnRvIExpbWl0ZWQuCi8vIEFuIEVSQzIwIHN0YW5kYXJkCi8vCi8vIGF1dGhvcjogR2lmdG8gVGVhbQovLyBDb250YWN0OiA8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjM5NWQ1ODRkNGU1MTU3NWU0YzQwNWM1Nzc5NWU1NDU4NTA1NTE3NWE1NjU0Ij5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPgoKY29udHJhY3QgRVJDMjBJbnRlcmZhY2UgewogICAgLy8gR2V0IHRoZSB0b3RhbCB0b2tlbiBzdXBwbHkKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgX3RvdGFsU3VwcGx5KTsKIAogICAgLy8gR2V0IHRoZSBhY2NvdW50IGJhbGFuY2Ugb2YgYW5vdGhlciBhY2NvdW50IHdpdGggYWRkcmVzcyBfb3duZXIKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7CiAKICAgIC8vIFNlbmQgX3ZhbHVlIGFtb3VudCBvZiB0b2tlbnMgdG8gYWRkcmVzcyBfdG8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICAKICAgIC8vIHRyYW5zZmVyIF92YWx1ZSBhbW91bnQgb2YgdG9rZW4gYXBwcm92ZWQgYnkgYWRkcmVzcyBfZnJvbQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8gYXBwcm92ZSBhbiBhZGRyZXNzIHdpdGggX3ZhbHVlIGFtb3VudCBvZiB0b2tlbnMKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8vIGdldCByZW1haW5pbmcgdG9rZW4gYXBwcm92ZWQgYnkgX293bmVyIHRvIF9zcGVuZGVyCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZyk7CiAgCiAgICAvLyBUcmlnZ2VyZWQgd2hlbiB0b2tlbnMgYXJlIHRyYW5zZmVycmVkLgogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CiAKICAgIC8vIFRyaWdnZXJlZCB3aGVuZXZlciBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBpcyBjYWxsZWQuCiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKfQogCmNvbnRyYWN0IEdpZnRvIGlzIEVSQzIwSW50ZXJmYWNlIHsKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gNTsKCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJHVE8iOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIkdpZnRvIjsKCiAgICBib29sIHB1YmxpYyBfc2VsbGluZyA9IHRydWU7Ly9pbml0aWFsIHNlbGxpbmcKICAgIHVpbnQyNTYgcHVibGljIF90b3RhbFN1cHBseSA9IDEwICoqIDE0OyAvLyB0b3RhbCBzdXBwbHkgaXMgMTBeMTQgdW5pdCwgZXF1aXZhbGVudCB0byAxMF45IEdpZnRvCiAgICB1aW50MjU2IHB1YmxpYyBfb3JpZ2luYWxCdXlQcmljZSA9IDQzICogMTAqKjc7IC8vIG9yaWdpbmFsIGJ1eSAxRVRIID0gNDMwMCBHaWZ0byA9IDQzICogMTAqKjcgdW5pdAoKICAgIC8vIE93bmVyIG9mIHRoaXMgY29udHJhY3QKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwogCiAgICAvLyBCYWxhbmNlcyBHaWZ0byBmb3IgZWFjaCBhY2NvdW50CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgcHJpdmF0ZSBiYWxhbmNlczsKICAgIAogICAgLy8gT3duZXIgb2YgYWNjb3VudCBhcHByb3ZlcyB0aGUgdHJhbnNmZXIgb2YgYW4gYW1vdW50IHRvIGFub3RoZXIgYWNjb3VudAogICAgbWFwcGluZyhhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIHByaXZhdGUgYWxsb3dlZDsKCiAgICAvLyBMaXN0IG9mIGFwcHJvdmVkIGludmVzdG9ycwogICAgbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIHByaXZhdGUgYXBwcm92ZWRJbnZlc3Rvckxpc3Q7CiAgICAKICAgIC8vIGRlcG9zaXQKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBwcml2YXRlIGRlcG9zaXQ7CiAgICAKICAgIC8vIGljb1BlcmNlbnQKICAgIHVpbnQyNTYgcHVibGljIF9pY29QZXJjZW50ID0gMTA7CiAgICAKICAgIC8vIF9pY29TdXBwbHkgaXMgdGhlIGF2YWxhYmxlIHVuaXQuIEluaXRpYWxseSwgaXQgaXMgX3RvdGFsU3VwcGx5CiAgICB1aW50MjU2IHB1YmxpYyBfaWNvU3VwcGx5ID0gX3RvdGFsU3VwcGx5ICogX2ljb1BlcmNlbnQgLyAxMDA7CiAgICAKICAgIC8vIG1pbmltdW0gYnV5IDAuMyBFVEgKICAgIHVpbnQyNTYgcHVibGljIF9taW5pbXVtQnV5ID0gMyAqIDEwICoqIDE3OwogICAgCiAgICAvLyBtYXhpbXVtIGJ1eSAyNSBFVEgKICAgIHVpbnQyNTYgcHVibGljIF9tYXhpbXVtQnV5ID0gMjUgKiAxMCAqKiAxODsKCiAgICAvLyB0b3RhbFRva2VuU29sZAogICAgdWludDI1NiBwdWJsaWMgdG90YWxUb2tlblNvbGQgPSAwOwogICAgCiAgICAvLyB0cmFkYWJsZQogICAgYm9vbCBwdWJsaWMgdHJhZGFibGUgPSBmYWxzZTsKICAgIAogICAgLyoqCiAgICAgKiBGdW5jdGlvbnMgd2l0aCB0aGlzIG1vZGlmaWVyIGNhbiBvbmx5IGJlIGV4ZWN1dGVkIGJ5IHRoZSBvd25lcgogICAgICovCiAgICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICogRnVuY3Rpb25zIHdpdGggdGhpcyBtb2RpZmllciBjaGVjayBvbiBzYWxlIHN0YXR1cwogICAgICogT25seSBhbGxvdyBzYWxlIGlmIF9zZWxsaW5nIGlzIG9uCiAgICAgKi8KICAgIG1vZGlmaWVyIG9uU2FsZSgpIHsKICAgICAgICByZXF1aXJlKF9zZWxsaW5nKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEZ1bmN0aW9ucyB3aXRoIHRoaXMgbW9kaWZpZXIgY2hlY2sgdGhlIHZhbGlkaXR5IG9mIGFkZHJlc3MgaXMgaW52ZXN0b3IKICAgICAqLwogICAgbW9kaWZpZXIgdmFsaWRJbnZlc3RvcigpIHsKICAgICAgICByZXF1aXJlKGFwcHJvdmVkSW52ZXN0b3JMaXN0W21zZy5zZW5kZXJdKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEZ1bmN0aW9ucyB3aXRoIHRoaXMgbW9kaWZpZXIgY2hlY2sgdGhlIHZhbGlkaXR5IG9mIG1zZyB2YWx1ZQogICAgICogdmFsdWUgbXVzdCBncmVhdGVyIHRoYW4gZXF1YWwgbWluaW11bUJ1eVByaWNlCiAgICAgKiB0b3RhbCBkZXBvc2l0IG11c3QgbGVzcyB0aGFuIGVxdWFsIG1heGltdW1CdXlQcmljZQogICAgICovCiAgICBtb2RpZmllciB2YWxpZFZhbHVlKCl7CiAgICAgICAgLy8gcmVxdWlyZSB2YWx1ZSA+PSBfbWluaW11bUJ1eSBBTkQgdG90YWwgZGVwb3NpdCBvZiBtc2cuc2VuZGVyIDw9IG1heGltdW1CdXlQcmljZQogICAgICAgIHJlcXVpcmUgKCAobXNnLnZhbHVlID49IF9taW5pbXVtQnV5KSAmJgogICAgICAgICAgICAgICAgKCAoZGVwb3NpdFttc2cuc2VuZGVyXSArIG1zZy52YWx1ZSkgPD0gX21heGltdW1CdXkpICk7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiAKICAgICAqLwogICAgbW9kaWZpZXIgaXNUcmFkYWJsZSgpewogICAgICAgIHJlcXVpcmUodHJhZGFibGUgPT0gdHJ1ZSB8fCBtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIC8vLyBAZGV2IEZhbGxiYWNrIGZ1bmN0aW9uIGFsbG93cyB0byBidXkgZXRoZXIuCiAgICBmdW5jdGlvbigpCiAgICAgICAgcHVibGljCiAgICAgICAgcGF5YWJsZSB7CiAgICAgICAgYnV5R2lmdG8oKTsKICAgIH0KICAgIAogICAgLy8vIEBkZXYgYnV5IGZ1bmN0aW9uIGFsbG93cyB0byBidXkgZXRoZXIuIGZvciB1c2luZyBvcHRpb25hbCBkYXRhCiAgICBmdW5jdGlvbiBidXlHaWZ0bygpCiAgICAgICAgcHVibGljCiAgICAgICAgcGF5YWJsZQogICAgICAgIG9uU2FsZQogICAgICAgIHZhbGlkVmFsdWUKICAgICAgICB2YWxpZEludmVzdG9yIHsKICAgICAgICB1aW50MjU2IHJlcXVlc3RlZFVuaXRzID0gKG1zZy52YWx1ZSAqIF9vcmlnaW5hbEJ1eVByaWNlKSAvIDEwKioxODsKICAgICAgICByZXF1aXJlKGJhbGFuY2VzW293bmVyXSA+PSByZXF1ZXN0ZWRVbml0cyk7CiAgICAgICAgLy8gcHJlcGFyZSB0cmFuc2ZlciBkYXRhCiAgICAgICAgYmFsYW5jZXNbb3duZXJdIC09IHJlcXVlc3RlZFVuaXRzOwogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdICs9IHJlcXVlc3RlZFVuaXRzOwogICAgICAgIAogICAgICAgIC8vIGluY3JlYXNlIHRvdGFsIGRlcG9zaXQgYW1vdW50CiAgICAgICAgZGVwb3NpdFttc2cuc2VuZGVyXSArPSBtc2cudmFsdWU7CiAgICAgICAgCiAgICAgICAgLy8gY2hlY2sgdG90YWwgYW5kIGF1dG8gdHVybk9mZlNhbGUKICAgICAgICB0b3RhbFRva2VuU29sZCArPSByZXF1ZXN0ZWRVbml0czsKICAgICAgICBpZiAodG90YWxUb2tlblNvbGQgPj0gX2ljb1N1cHBseSl7CiAgICAgICAgICAgIF9zZWxsaW5nID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIHN1Ym1pdCB0cmFuc2ZlcgogICAgICAgIFRyYW5zZmVyKG93bmVyLCBtc2cuc2VuZGVyLCByZXF1ZXN0ZWRVbml0cyk7CiAgICAgICAgb3duZXIudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgIH0KCiAgICAvLy8gQGRldiBDb25zdHJ1Y3RvcgogICAgZnVuY3Rpb24gR2lmdG8oKSAKICAgICAgICBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgICAgICBzZXRCdXlQcmljZShfb3JpZ2luYWxCdXlQcmljZSk7CiAgICAgICAgYmFsYW5jZXNbb3duZXJdID0gX3RvdGFsU3VwcGx5OwogICAgICAgIFRyYW5zZmVyKDB4MCwgb3duZXIsIF90b3RhbFN1cHBseSk7CiAgICB9CiAgICAKICAgIC8vLyBAZGV2IEdldHMgdG90YWxTdXBwbHkKICAgIC8vLyBAcmV0dXJuIFRvdGFsIHN1cHBseQogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKQogICAgICAgIHB1YmxpYyAKICAgICAgICBjb25zdGFudCAKICAgICAgICByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIF90b3RhbFN1cHBseTsKICAgIH0KICAgIAogICAgLy8vIEBkZXYgRW5hYmxlcyBzYWxlIAogICAgZnVuY3Rpb24gdHVybk9uU2FsZSgpIG9ubHlPd25lciAKICAgICAgICBwdWJsaWMgewogICAgICAgIF9zZWxsaW5nID0gdHJ1ZTsKICAgIH0KCiAgICAvLy8gQGRldiBEaXNhYmxlcyBzYWxlCiAgICBmdW5jdGlvbiB0dXJuT2ZmU2FsZSgpIG9ubHlPd25lciAKICAgICAgICBwdWJsaWMgewogICAgICAgIF9zZWxsaW5nID0gZmFsc2U7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHR1cm5PblRyYWRhYmxlKCkgCiAgICAgICAgcHVibGljCiAgICAgICAgb25seU93bmVyewogICAgICAgIHRyYWRhYmxlID0gdHJ1ZTsKICAgIH0KICAgIAogICAgLy8vIEBkZXYgc2V0IG5ldyBpY29QZXJjZW50CiAgICAvLy8gQHBhcmFtIG5ld0ljb1BlcmNlbnQgbmV3IHZhbHVlIG9mIGljb1BlcmNlbnQKICAgIGZ1bmN0aW9uIHNldEljb1BlcmNlbnQodWludDI1NiBuZXdJY29QZXJjZW50KQogICAgICAgIHB1YmxpYyAKICAgICAgICBvbmx5T3duZXIgewogICAgICAgIF9pY29QZXJjZW50ID0gbmV3SWNvUGVyY2VudDsKICAgICAgICBfaWNvU3VwcGx5ID0gX3RvdGFsU3VwcGx5ICogX2ljb1BlcmNlbnQgLyAxMDA7CiAgICB9CiAgICAKICAgIC8vLyBAZGV2IHNldCBuZXcgX21heGltdW1CdXkKICAgIC8vLyBAcGFyYW0gbmV3TWF4aW11bUJ1eSBuZXcgdmFsdWUgb2YgX21heGltdW1CdXkKICAgIGZ1bmN0aW9uIHNldE1heGltdW1CdXkodWludDI1NiBuZXdNYXhpbXVtQnV5KQogICAgICAgIHB1YmxpYyAKICAgICAgICBvbmx5T3duZXIgewogICAgICAgIF9tYXhpbXVtQnV5ID0gbmV3TWF4aW11bUJ1eTsKICAgIH0KCiAgICAvLy8gQGRldiBVcGRhdGVzIGJ1eSBwcmljZSAob3duZXIgT05MWSkKICAgIC8vLyBAcGFyYW0gbmV3QnV5UHJpY2UgTmV3IGJ1eSBwcmljZSAoaW4gdW5pdCkKICAgIGZ1bmN0aW9uIHNldEJ1eVByaWNlKHVpbnQyNTYgbmV3QnV5UHJpY2UpIAogICAgICAgIG9ubHlPd25lciAKICAgICAgICBwdWJsaWMgewogICAgICAgIHJlcXVpcmUobmV3QnV5UHJpY2U+MCk7CiAgICAgICAgX29yaWdpbmFsQnV5UHJpY2UgPSBuZXdCdXlQcmljZTsgLy8gMzAwMCBHaWZ0byA9IDMwMDAgMDAwMDAgdW5pdAogICAgICAgIC8vIGNvbnRyb2wgX21heGltdW1CdXlfVVNEID0gMTAsMDAwIFVTRCwgR2lmdG8gcHJpY2UgaXMgMC4xVVNECiAgICAgICAgLy8gbWF4aW11bUJ1eV9HaWZ0byA9IDEwMCwwMDAgR2lmdG8gPSAxMDAsMDAwLDAwMDAwIHVuaXQKICAgICAgICAvLyAzMDAwIEdpZnRvID0gMUVUSCA9PiBtYXhpbXVtRVRIID0gMTAwLDAwMCwwMDAwMCAvIF9vcmlnaW5hbEJ1eVByaWNlCiAgICAgICAgLy8gMTAwLDAwMCwwMDAwMC8zMDAwIDAwMDAgfiAzM0VUSCA9PiBjaGFuZ2UgdG8gd2VpCiAgICAgICAgX21heGltdW1CdXkgPSAxMCoqMTggKiAxMDAwMDAwMDAwMCAvX29yaWdpbmFsQnV5UHJpY2U7CiAgICB9CiAgICAgICAgCiAgICAvLy8gQGRldiBHZXRzIGFjY291bnQncyBiYWxhbmNlCiAgICAvLy8gQHBhcmFtIF9hZGRyIEFkZHJlc3Mgb2YgdGhlIGFjY291bnQKICAgIC8vLyBAcmV0dXJuIEFjY291bnQgYmFsYW5jZQogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX2FkZHIpIAogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50IAogICAgICAgIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX2FkZHJdOwogICAgfQogICAgCiAgICAvLy8gQGRldiBjaGVjayBhZGRyZXNzIGlzIGFwcHJvdmVkIGludmVzdG9yCiAgICAvLy8gQHBhcmFtIF9hZGRyIGFkZHJlc3MKICAgIGZ1bmN0aW9uIGlzQXBwcm92ZWRJbnZlc3RvcihhZGRyZXNzIF9hZGRyKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBhcHByb3ZlZEludmVzdG9yTGlzdFtfYWRkcl07CiAgICB9CiAgICAKICAgIC8vLyBAZGV2IGdldCBFVEggZGVwb3NpdAogICAgLy8vIEBwYXJhbSBfYWRkciBhZGRyZXNzIGdldCBkZXBvc2l0CiAgICAvLy8gQHJldHVybiBhbW91bnQgZGVwb3NpdCBvZiBhbiBidXllcgogICAgZnVuY3Rpb24gZ2V0RGVwb3NpdChhZGRyZXNzIF9hZGRyKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyh1aW50MjU2KXsKICAgICAgICByZXR1cm4gZGVwb3NpdFtfYWRkcl07Cn0KICAgIAogICAgLy8vIEBkZXYgQWRkcyBsaXN0IG9mIG5ldyBpbnZlc3RvcnMgdG8gdGhlIGludmVzdG9ycyBsaXN0IGFuZCBhcHByb3ZlIGFsbAogICAgLy8vIEBwYXJhbSBuZXdJbnZlc3Rvckxpc3QgQXJyYXkgb2YgbmV3IGludmVzdG9ycyBhZGRyZXNzZXMgdG8gYmUgYWRkZWQKICAgIGZ1bmN0aW9uIGFkZEludmVzdG9yTGlzdChhZGRyZXNzW10gbmV3SW52ZXN0b3JMaXN0KQogICAgICAgIG9ubHlPd25lcgogICAgICAgIHB1YmxpYyB7CiAgICAgICAgZm9yICh1aW50MjU2IGkgPSAwOyBpIDwgbmV3SW52ZXN0b3JMaXN0Lmxlbmd0aDsgaSsrKXsKICAgICAgICAgICAgYXBwcm92ZWRJbnZlc3Rvckxpc3RbbmV3SW52ZXN0b3JMaXN0W2ldXSA9IHRydWU7CiAgICAgICAgfQogICAgfQoKICAgIC8vLyBAZGV2IFJlbW92ZXMgbGlzdCBvZiBpbnZlc3RvcnMgZnJvbSBsaXN0CiAgICAvLy8gQHBhcmFtIGludmVzdG9yTGlzdCBBcnJheSBvZiBhZGRyZXNzZXMgb2YgaW52ZXN0b3JzIHRvIGJlIHJlbW92ZWQKICAgIGZ1bmN0aW9uIHJlbW92ZUludmVzdG9yTGlzdChhZGRyZXNzW10gaW52ZXN0b3JMaXN0KQogICAgICAgIG9ubHlPd25lcgogICAgICAgIHB1YmxpYyB7CiAgICAgICAgZm9yICh1aW50MjU2IGkgPSAwOyBpIDwgaW52ZXN0b3JMaXN0Lmxlbmd0aDsgaSsrKXsKICAgICAgICAgICAgYXBwcm92ZWRJbnZlc3Rvckxpc3RbaW52ZXN0b3JMaXN0W2ldXSA9IGZhbHNlOwogICAgICAgIH0KICAgIH0KIAogICAgLy8vIEBkZXYgVHJhbnNmZXJzIHRoZSBiYWxhbmNlIGZyb20gbXNnLnNlbmRlciB0byBhbiBhY2NvdW50CiAgICAvLy8gQHBhcmFtIF90byBSZWNpcGllbnQgYWRkcmVzcwogICAgLy8vIEBwYXJhbSBfYW1vdW50IFRyYW5zZmVyZWQgYW1vdW50IGluIHVuaXQKICAgIC8vLyBAcmV0dXJuIFRyYW5zZmVyIHN0YXR1cwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkKICAgICAgICBwdWJsaWMgCiAgICAgICAgaXNUcmFkYWJsZQogICAgICAgIHJldHVybnMgKGJvb2wpIHsKICAgICAgICAvLyBpZiBzZW5kZXIncyBiYWxhbmNlIGhhcyBlbm91Z2ggdW5pdCBhbmQgYW1vdW50ID49IDAsIAogICAgICAgIC8vICAgICAgYW5kIHRoZSBzdW0gaXMgbm90IG92ZXJmbG93LAogICAgICAgIC8vIHRoZW4gZG8gdHJhbnNmZXIgCiAgICAgICAgaWYgKCAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX2Ftb3VudCkgJiYKICAgICAgICAgICAgIChfYW1vdW50ID49IDApICYmIAogICAgICAgICAgICAgKGJhbGFuY2VzW190b10gKyBfYW1vdW50ID4gYmFsYW5jZXNbX3RvXSkgKSB7ICAKCiAgICAgICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdIC09IF9hbW91bnQ7CiAgICAgICAgICAgIGJhbGFuY2VzW190b10gKz0gX2Ftb3VudDsKICAgICAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfYW1vdW50KTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KICAgICAKICAgIC8vIFNlbmQgX3ZhbHVlIGFtb3VudCBvZiB0b2tlbnMgZnJvbSBhZGRyZXNzIF9mcm9tIHRvIGFkZHJlc3MgX3RvCiAgICAvLyBUaGUgdHJhbnNmZXJGcm9tIG1ldGhvZCBpcyB1c2VkIGZvciBhIHdpdGhkcmF3IHdvcmtmbG93LCBhbGxvd2luZyBjb250cmFjdHMgdG8gc2VuZAogICAgLy8gdG9rZW5zIG9uIHlvdXIgYmVoYWxmLCBmb3IgZXhhbXBsZSB0byAiZGVwb3NpdCIgdG8gYSBjb250cmFjdCBhZGRyZXNzIGFuZC9vciB0byBjaGFyZ2UKICAgIC8vIGZlZXMgaW4gc3ViLWN1cnJlbmNpZXM7IHRoZSBjb21tYW5kIHNob3VsZCBmYWlsIHVubGVzcyB0aGUgX2Zyb20gYWNjb3VudCBoYXMKICAgIC8vIGRlbGliZXJhdGVseSBhdXRob3JpemVkIHRoZSBzZW5kZXIgb2YgdGhlIG1lc3NhZ2UgdmlhIHNvbWUgbWVjaGFuaXNtOyB3ZSBwcm9wb3NlCiAgICAvLyB0aGVzZSBzdGFuZGFyZGl6ZWQgQVBJcyBmb3IgYXBwcm92YWw6CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oCiAgICAgICAgYWRkcmVzcyBfZnJvbSwKICAgICAgICBhZGRyZXNzIF90bywKICAgICAgICB1aW50MjU2IF9hbW91bnQKICAgICkKICAgIHB1YmxpYwogICAgaXNUcmFkYWJsZQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgaWYgKGJhbGFuY2VzW19mcm9tXSA+PSBfYW1vdW50CiAgICAgICAgICAgICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF9hbW91bnQKICAgICAgICAgICAgJiYgX2Ftb3VudCA+IDAKICAgICAgICAgICAgJiYgYmFsYW5jZXNbX3RvXSArIF9hbW91bnQgPiBiYWxhbmNlc1tfdG9dKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW19mcm9tXSAtPSBfYW1vdW50OwogICAgICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfYW1vdW50OwogICAgICAgICAgICBiYWxhbmNlc1tfdG9dICs9IF9hbW91bnQ7CiAgICAgICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF9hbW91bnQpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQogICAgCiAgICAvLyBBbGxvdyBfc3BlbmRlciB0byB3aXRoZHJhdyBmcm9tIHlvdXIgYWNjb3VudCwgbXVsdGlwbGUgdGltZXMsIHVwIHRvIHRoZSBfdmFsdWUgYW1vdW50LgogICAgLy8gSWYgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgYWdhaW4gaXQgb3ZlcndyaXRlcyB0aGUgY3VycmVudCBhbGxvd2FuY2Ugd2l0aCBfdmFsdWUuCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX2Ftb3VudCkgCiAgICAgICAgcHVibGljCiAgICAgICAgaXNUcmFkYWJsZQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX2Ftb3VudDsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX2Ftb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIC8vIGdldCBhbGxvd2FuY2UKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQgCiAgICAgICAgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KICAgIAogICAgLy8vIEBkZXYgV2l0aGRyYXdzIEV0aGVyIGluIGNvbnRyYWN0IChPd25lciBvbmx5KQogICAgLy8vIEByZXR1cm4gU3RhdHVzIG9mIHdpdGhkcmF3YWwKICAgIGZ1bmN0aW9uIHdpdGhkcmF3KCkgb25seU93bmVyIAogICAgICAgIHB1YmxpYyAKICAgICAgICByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIG93bmVyLnNlbmQodGhpcy5iYWxhbmNlKTsKICAgIH0KfQoKLy8vIEB0aXRsZSBNdWx0aXNpZ25hdHVyZSB3YWxsZXQgLSBBbGxvd3MgbXVsdGlwbGUgcGFydGllcyB0byBhZ3JlZSBvbiB0cmFuc2FjdGlvbnMgYmVmb3JlIGV4ZWN1dGlvbi4KLy8vIEBhdXRob3IgU3RlZmFuIEdlb3JnZSAtIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjNkNGU0OTU4NWI1YzUzMTM1YTU4NTI0ZjVhNTg3ZDVlNTI1MzRlNTg1MzRlNDQ0ZTEzNTM1ODQ5Ij5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4KY29udHJhY3QgTXVsdGlTaWdXYWxsZXQgewoKICAgIHVpbnQgY29uc3RhbnQgcHVibGljIE1BWF9PV05FUl9DT1VOVCA9IDUwOwoKICAgIGV2ZW50IENvbmZpcm1hdGlvbihhZGRyZXNzIGluZGV4ZWQgc2VuZGVyLCB1aW50IGluZGV4ZWQgdHJhbnNhY3Rpb25JZCk7CiAgICBldmVudCBSZXZvY2F0aW9uKGFkZHJlc3MgaW5kZXhlZCBzZW5kZXIsIHVpbnQgaW5kZXhlZCB0cmFuc2FjdGlvbklkKTsKICAgIGV2ZW50IFN1Ym1pc3Npb24odWludCBpbmRleGVkIHRyYW5zYWN0aW9uSWQpOwogICAgZXZlbnQgRXhlY3V0aW9uKHVpbnQgaW5kZXhlZCB0cmFuc2FjdGlvbklkKTsKICAgIGV2ZW50IEV4ZWN1dGlvbkZhaWx1cmUodWludCBpbmRleGVkIHRyYW5zYWN0aW9uSWQpOwogICAgZXZlbnQgRGVwb3NpdChhZGRyZXNzIGluZGV4ZWQgc2VuZGVyLCB1aW50IHZhbHVlKTsKICAgIGV2ZW50IE93bmVyQWRkaXRpb24oYWRkcmVzcyBpbmRleGVkIG93bmVyKTsKICAgIGV2ZW50IE93bmVyUmVtb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIpOwogICAgZXZlbnQgUmVxdWlyZW1lbnRDaGFuZ2UodWludCByZXF1aXJlZCk7CiAgICBldmVudCBDb2luQ3JlYXRpb24oYWRkcmVzcyBjb2luKTsKCiAgICBtYXBwaW5nICh1aW50ID0+IFRyYW5zYWN0aW9uKSBwdWJsaWMgdHJhbnNhY3Rpb25zOwogICAgbWFwcGluZyAodWludCA9PiBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpKSBwdWJsaWMgY29uZmlybWF0aW9uczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIGlzT3duZXI7CiAgICBhZGRyZXNzW10gcHVibGljIG93bmVyczsKICAgIHVpbnQgcHVibGljIHJlcXVpcmVkOwogICAgdWludCBwdWJsaWMgdHJhbnNhY3Rpb25Db3VudDsKICAgIGJvb2wgZmxhZyA9IHRydWU7CgogICAgc3RydWN0IFRyYW5zYWN0aW9uIHsKICAgICAgICBhZGRyZXNzIGRlc3RpbmF0aW9uOwogICAgICAgIHVpbnQgdmFsdWU7CiAgICAgICAgYnl0ZXMgZGF0YTsKICAgICAgICBib29sIGV4ZWN1dGVkOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlXYWxsZXQoKSB7CiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gYWRkcmVzcyh0aGlzKSkKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvd25lckRvZXNOb3RFeGlzdChhZGRyZXNzIG93bmVyKSB7CiAgICAgICAgaWYgKGlzT3duZXJbb3duZXJdKQogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG93bmVyRXhpc3RzKGFkZHJlc3Mgb3duZXIpIHsKICAgICAgICBpZiAoIWlzT3duZXJbb3duZXJdKQogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIHRyYW5zYWN0aW9uRXhpc3RzKHVpbnQgdHJhbnNhY3Rpb25JZCkgewogICAgICAgIGlmICh0cmFuc2FjdGlvbnNbdHJhbnNhY3Rpb25JZF0uZGVzdGluYXRpb24gPT0gMCkKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBjb25maXJtZWQodWludCB0cmFuc2FjdGlvbklkLCBhZGRyZXNzIG93bmVyKSB7CiAgICAgICAgaWYgKCFjb25maXJtYXRpb25zW3RyYW5zYWN0aW9uSWRdW293bmVyXSkKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBub3RDb25maXJtZWQodWludCB0cmFuc2FjdGlvbklkLCBhZGRyZXNzIG93bmVyKSB7CiAgICAgICAgaWYgKGNvbmZpcm1hdGlvbnNbdHJhbnNhY3Rpb25JZF1bb3duZXJdKQogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG5vdEV4ZWN1dGVkKHVpbnQgdHJhbnNhY3Rpb25JZCkgewogICAgICAgIGlmICh0cmFuc2FjdGlvbnNbdHJhbnNhY3Rpb25JZF0uZXhlY3V0ZWQpCiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgbm90TnVsbChhZGRyZXNzIF9hZGRyZXNzKSB7CiAgICAgICAgaWYgKF9hZGRyZXNzID09IDApCiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgdmFsaWRSZXF1aXJlbWVudCh1aW50IG93bmVyQ291bnQsIHVpbnQgX3JlcXVpcmVkKSB7CiAgICAgICAgaWYgKCAgIG93bmVyQ291bnQgPiBNQVhfT1dORVJfQ09VTlQKICAgICAgICAgICAgfHwgX3JlcXVpcmVkID4gb3duZXJDb3VudAogICAgICAgICAgICB8fCBfcmVxdWlyZWQgPT0gMAogICAgICAgICAgICB8fCBvd25lckNvdW50ID09IDApCiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIF87CiAgICB9CgogICAgLy8vIEBkZXYgRmFsbGJhY2sgZnVuY3Rpb24gYWxsb3dzIHRvIGRlcG9zaXQgZXRoZXIuCiAgICBmdW5jdGlvbigpCiAgICAgICAgcGF5YWJsZQogICAgewogICAgICAgIGlmIChtc2cudmFsdWUgPiAwKQogICAgICAgICAgICBEZXBvc2l0KG1zZy5zZW5kZXIsIG1zZy52YWx1ZSk7CiAgICB9CgogICAgLyoKICAgICAqIFB1YmxpYyBmdW5jdGlvbnMKICAgICAqLwogICAgLy8vIEBkZXYgQ29udHJhY3QgY29uc3RydWN0b3Igc2V0cyBpbml0aWFsIG93bmVycyBhbmQgcmVxdWlyZWQgbnVtYmVyIG9mIGNvbmZpcm1hdGlvbnMuCiAgICAvLy8gQHBhcmFtIF9vd25lcnMgTGlzdCBvZiBpbml0aWFsIG93bmVycy4KICAgIC8vLyBAcGFyYW0gX3JlcXVpcmVkIE51bWJlciBvZiByZXF1aXJlZCBjb25maXJtYXRpb25zLgogICAgZnVuY3Rpb24gTXVsdGlTaWdXYWxsZXQoYWRkcmVzc1tdIF9vd25lcnMsIHVpbnQgX3JlcXVpcmVkKQogICAgICAgIHB1YmxpYwogICAgICAgIHZhbGlkUmVxdWlyZW1lbnQoX293bmVycy5sZW5ndGgsIF9yZXF1aXJlZCkKICAgIHsKICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPF9vd25lcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGlzT3duZXJbX293bmVyc1tpXV0gfHwgX293bmVyc1tpXSA9PSAwKQogICAgICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgICAgIGlzT3duZXJbX293bmVyc1tpXV0gPSB0cnVlOwogICAgICAgIH0KICAgICAgICBvd25lcnMgPSBfb3duZXJzOwogICAgICAgIHJlcXVpcmVkID0gX3JlcXVpcmVkOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyB0byBhZGQgYSBuZXcgb3duZXIuIFRyYW5zYWN0aW9uIGhhcyB0byBiZSBzZW50IGJ5IHdhbGxldC4KICAgIC8vLyBAcGFyYW0gb3duZXIgQWRkcmVzcyBvZiBuZXcgb3duZXIuCiAgICBmdW5jdGlvbiBhZGRPd25lcihhZGRyZXNzIG93bmVyKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlXYWxsZXQKICAgICAgICBvd25lckRvZXNOb3RFeGlzdChvd25lcikKICAgICAgICBub3ROdWxsKG93bmVyKQogICAgICAgIHZhbGlkUmVxdWlyZW1lbnQob3duZXJzLmxlbmd0aCArIDEsIHJlcXVpcmVkKQogICAgewogICAgICAgIGlzT3duZXJbb3duZXJdID0gdHJ1ZTsKICAgICAgICBvd25lcnMucHVzaChvd25lcik7CiAgICAgICAgT3duZXJBZGRpdGlvbihvd25lcik7CiAgICB9CgogICAgLy8vIEBkZXYgQWxsb3dzIHRvIHJlbW92ZSBhbiBvd25lci4gVHJhbnNhY3Rpb24gaGFzIHRvIGJlIHNlbnQgYnkgd2FsbGV0LgogICAgLy8vIEBwYXJhbSBvd25lciBBZGRyZXNzIG9mIG93bmVyLgogICAgZnVuY3Rpb24gcmVtb3ZlT3duZXIoYWRkcmVzcyBvd25lcikKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5V2FsbGV0CiAgICAgICAgb3duZXJFeGlzdHMob3duZXIpCiAgICB7CiAgICAgICAgaXNPd25lcltvd25lcl0gPSBmYWxzZTsKICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPG93bmVycy5sZW5ndGggLSAxOyBpKyspCiAgICAgICAgICAgIGlmIChvd25lcnNbaV0gPT0gb3duZXIpIHsKICAgICAgICAgICAgICAgIG93bmVyc1tpXSA9IG93bmVyc1tvd25lcnMubGVuZ3RoIC0gMV07CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIG93bmVycy5sZW5ndGggLT0gMTsKICAgICAgICBpZiAocmVxdWlyZWQgPiBvd25lcnMubGVuZ3RoKQogICAgICAgICAgICBjaGFuZ2VSZXF1aXJlbWVudChvd25lcnMubGVuZ3RoKTsKICAgICAgICBPd25lclJlbW92YWwob3duZXIpOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyB0byByZXBsYWNlIGFuIG93bmVyIHdpdGggYSBuZXcgb3duZXIuIFRyYW5zYWN0aW9uIGhhcyB0byBiZSBzZW50IGJ5IHdhbGxldC4KICAgIC8vLyBAcGFyYW0gb3duZXIgQWRkcmVzcyBvZiBvd25lciB0byBiZSByZXBsYWNlZC4KICAgIC8vLyBAcGFyYW0gb3duZXIgQWRkcmVzcyBvZiBuZXcgb3duZXIuCiAgICBmdW5jdGlvbiByZXBsYWNlT3duZXIoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBuZXdPd25lcikKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5V2FsbGV0CiAgICAgICAgb3duZXJFeGlzdHMob3duZXIpCiAgICAgICAgb3duZXJEb2VzTm90RXhpc3QobmV3T3duZXIpCiAgICB7CiAgICAgICAgZm9yICh1aW50IGk9MDsgaTxvd25lcnMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlmIChvd25lcnNbaV0gPT0gb3duZXIpIHsKICAgICAgICAgICAgICAgIG93bmVyc1tpXSA9IG5ld093bmVyOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICBpc093bmVyW293bmVyXSA9IGZhbHNlOwogICAgICAgIGlzT3duZXJbbmV3T3duZXJdID0gdHJ1ZTsKICAgICAgICBPd25lclJlbW92YWwob3duZXIpOwogICAgICAgIE93bmVyQWRkaXRpb24obmV3T3duZXIpOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyB0byBjaGFuZ2UgdGhlIG51bWJlciBvZiByZXF1aXJlZCBjb25maXJtYXRpb25zLiBUcmFuc2FjdGlvbiBoYXMgdG8gYmUgc2VudCBieSB3YWxsZXQuCiAgICAvLy8gQHBhcmFtIF9yZXF1aXJlZCBOdW1iZXIgb2YgcmVxdWlyZWQgY29uZmlybWF0aW9ucy4KICAgIGZ1bmN0aW9uIGNoYW5nZVJlcXVpcmVtZW50KHVpbnQgX3JlcXVpcmVkKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlXYWxsZXQKICAgICAgICB2YWxpZFJlcXVpcmVtZW50KG93bmVycy5sZW5ndGgsIF9yZXF1aXJlZCkKICAgIHsKICAgICAgICByZXF1aXJlZCA9IF9yZXF1aXJlZDsKICAgICAgICBSZXF1aXJlbWVudENoYW5nZShfcmVxdWlyZWQpOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyBhbiBvd25lciB0byBzdWJtaXQgYW5kIGNvbmZpcm0gYSB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gZGVzdGluYXRpb24gVHJhbnNhY3Rpb24gdGFyZ2V0IGFkZHJlc3MuCiAgICAvLy8gQHBhcmFtIHZhbHVlIFRyYW5zYWN0aW9uIGV0aGVyIHZhbHVlLgogICAgLy8vIEBwYXJhbSBkYXRhIFRyYW5zYWN0aW9uIGRhdGEgcGF5bG9hZC4KICAgIC8vLyBAcmV0dXJuIFJldHVybnMgdHJhbnNhY3Rpb24gSUQuCiAgICBmdW5jdGlvbiBzdWJtaXRUcmFuc2FjdGlvbihhZGRyZXNzIGRlc3RpbmF0aW9uLCB1aW50IHZhbHVlLCBieXRlcyBkYXRhKQogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnMgKHVpbnQgdHJhbnNhY3Rpb25JZCkKICAgIHsKICAgICAgICB0cmFuc2FjdGlvbklkID0gYWRkVHJhbnNhY3Rpb24oZGVzdGluYXRpb24sIHZhbHVlLCBkYXRhKTsKICAgICAgICBjb25maXJtVHJhbnNhY3Rpb24odHJhbnNhY3Rpb25JZCk7CiAgICB9CgogICAgLy8vIEBkZXYgQWxsb3dzIGFuIG93bmVyIHRvIGNvbmZpcm0gYSB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRC4KICAgIGZ1bmN0aW9uIGNvbmZpcm1UcmFuc2FjdGlvbih1aW50IHRyYW5zYWN0aW9uSWQpCiAgICAgICAgcHVibGljCiAgICAgICAgb3duZXJFeGlzdHMobXNnLnNlbmRlcikKICAgICAgICB0cmFuc2FjdGlvbkV4aXN0cyh0cmFuc2FjdGlvbklkKQogICAgICAgIG5vdENvbmZpcm1lZCh0cmFuc2FjdGlvbklkLCBtc2cuc2VuZGVyKQogICAgewogICAgICAgIGNvbmZpcm1hdGlvbnNbdHJhbnNhY3Rpb25JZF1bbXNnLnNlbmRlcl0gPSB0cnVlOwogICAgICAgIENvbmZpcm1hdGlvbihtc2cuc2VuZGVyLCB0cmFuc2FjdGlvbklkKTsKICAgICAgICBleGVjdXRlVHJhbnNhY3Rpb24odHJhbnNhY3Rpb25JZCk7CiAgICB9CgogICAgLy8vIEBkZXYgQWxsb3dzIGFuIG93bmVyIHRvIHJldm9rZSBhIGNvbmZpcm1hdGlvbiBmb3IgYSB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRC4KICAgIGZ1bmN0aW9uIHJldm9rZUNvbmZpcm1hdGlvbih1aW50IHRyYW5zYWN0aW9uSWQpCiAgICAgICAgcHVibGljCiAgICAgICAgb3duZXJFeGlzdHMobXNnLnNlbmRlcikKICAgICAgICBjb25maXJtZWQodHJhbnNhY3Rpb25JZCwgbXNnLnNlbmRlcikKICAgICAgICBub3RFeGVjdXRlZCh0cmFuc2FjdGlvbklkKQogICAgewogICAgICAgIGNvbmZpcm1hdGlvbnNbdHJhbnNhY3Rpb25JZF1bbXNnLnNlbmRlcl0gPSBmYWxzZTsKICAgICAgICBSZXZvY2F0aW9uKG1zZy5zZW5kZXIsIHRyYW5zYWN0aW9uSWQpOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyBhbnlvbmUgdG8gZXhlY3V0ZSBhIGNvbmZpcm1lZCB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRC4KICAgIGZ1bmN0aW9uIGV4ZWN1dGVUcmFuc2FjdGlvbih1aW50IHRyYW5zYWN0aW9uSWQpCiAgICAgICAgcHVibGljCiAgICAgICAgbm90RXhlY3V0ZWQodHJhbnNhY3Rpb25JZCkKICAgIHsKICAgICAgICBpZiAoaXNDb25maXJtZWQodHJhbnNhY3Rpb25JZCkpIHsKICAgICAgICAgICAgVHJhbnNhY3Rpb24gdHggPSB0cmFuc2FjdGlvbnNbdHJhbnNhY3Rpb25JZF07CiAgICAgICAgICAgIHR4LmV4ZWN1dGVkID0gdHJ1ZTsKICAgICAgICAgICAgaWYgKHR4LmRlc3RpbmF0aW9uLmNhbGwudmFsdWUodHgudmFsdWUpKHR4LmRhdGEpKQogICAgICAgICAgICAgICAgRXhlY3V0aW9uKHRyYW5zYWN0aW9uSWQpOwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIEV4ZWN1dGlvbkZhaWx1cmUodHJhbnNhY3Rpb25JZCk7CiAgICAgICAgICAgICAgICB0eC5leGVjdXRlZCA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgdGhlIGNvbmZpcm1hdGlvbiBzdGF0dXMgb2YgYSB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRC4KICAgIC8vLyBAcmV0dXJuIENvbmZpcm1hdGlvbiBzdGF0dXMuCiAgICBmdW5jdGlvbiBpc0NvbmZpcm1lZCh1aW50IHRyYW5zYWN0aW9uSWQpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHVpbnQgY291bnQgPSAwOwogICAgICAgIGZvciAodWludCBpPTA7IGk8b3duZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChjb25maXJtYXRpb25zW3RyYW5zYWN0aW9uSWRdW293bmVyc1tpXV0pCiAgICAgICAgICAgICAgICBjb3VudCArPSAxOwogICAgICAgICAgICBpZiAoY291bnQgPT0gcmVxdWlyZWQpCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgLyoKICAgICAqIEludGVybmFsIGZ1bmN0aW9ucwogICAgICovCiAgICAvLy8gQGRldiBBZGRzIGEgbmV3IHRyYW5zYWN0aW9uIHRvIHRoZSB0cmFuc2FjdGlvbiBtYXBwaW5nLCBpZiB0cmFuc2FjdGlvbiBkb2VzIG5vdCBleGlzdCB5ZXQuCiAgICAvLy8gQHBhcmFtIGRlc3RpbmF0aW9uIFRyYW5zYWN0aW9uIHRhcmdldCBhZGRyZXNzLgogICAgLy8vIEBwYXJhbSB2YWx1ZSBUcmFuc2FjdGlvbiBldGhlciB2YWx1ZS4KICAgIC8vLyBAcGFyYW0gZGF0YSBUcmFuc2FjdGlvbiBkYXRhIHBheWxvYWQuCiAgICAvLy8gQHJldHVybiBSZXR1cm5zIHRyYW5zYWN0aW9uIElELgogICAgZnVuY3Rpb24gYWRkVHJhbnNhY3Rpb24oYWRkcmVzcyBkZXN0aW5hdGlvbiwgdWludCB2YWx1ZSwgYnl0ZXMgZGF0YSkKICAgICAgICBpbnRlcm5hbAogICAgICAgIG5vdE51bGwoZGVzdGluYXRpb24pCiAgICAgICAgcmV0dXJucyAodWludCB0cmFuc2FjdGlvbklkKQogICAgewogICAgICAgIHRyYW5zYWN0aW9uSWQgPSB0cmFuc2FjdGlvbkNvdW50OwogICAgICAgIHRyYW5zYWN0aW9uc1t0cmFuc2FjdGlvbklkXSA9IFRyYW5zYWN0aW9uKHsKICAgICAgICAgICAgZGVzdGluYXRpb246IGRlc3RpbmF0aW9uLAogICAgICAgICAgICB2YWx1ZTogdmFsdWUsCiAgICAgICAgICAgIGRhdGE6IGRhdGEsCiAgICAgICAgICAgIGV4ZWN1dGVkOiBmYWxzZQogICAgICAgIH0pOwogICAgICAgIHRyYW5zYWN0aW9uQ291bnQgKz0gMTsKICAgICAgICBTdWJtaXNzaW9uKHRyYW5zYWN0aW9uSWQpOwogICAgfQoKICAgIC8qCiAgICAgKiBXZWIzIGNhbGwgZnVuY3Rpb25zCiAgICAgKi8KICAgIC8vLyBAZGV2IFJldHVybnMgbnVtYmVyIG9mIGNvbmZpcm1hdGlvbnMgb2YgYSB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRC4KICAgIC8vLyBAcmV0dXJuIE51bWJlciBvZiBjb25maXJtYXRpb25zLgogICAgZnVuY3Rpb24gZ2V0Q29uZmlybWF0aW9uQ291bnQodWludCB0cmFuc2FjdGlvbklkKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCBjb3VudCkKICAgIHsKICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPG93bmVycy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKGNvbmZpcm1hdGlvbnNbdHJhbnNhY3Rpb25JZF1bb3duZXJzW2ldXSkKICAgICAgICAgICAgICAgIGNvdW50ICs9IDE7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyB0b3RhbCBudW1iZXIgb2YgdHJhbnNhY3Rpb25zIGFmdGVyIGZpbGVycyBhcmUgYXBwbGllZC4KICAgIC8vLyBAcGFyYW0gcGVuZGluZyBJbmNsdWRlIHBlbmRpbmcgdHJhbnNhY3Rpb25zLgogICAgLy8vIEBwYXJhbSBleGVjdXRlZCBJbmNsdWRlIGV4ZWN1dGVkIHRyYW5zYWN0aW9ucy4KICAgIC8vLyBAcmV0dXJuIFRvdGFsIG51bWJlciBvZiB0cmFuc2FjdGlvbnMgYWZ0ZXIgZmlsdGVycyBhcmUgYXBwbGllZC4KICAgIGZ1bmN0aW9uIGdldFRyYW5zYWN0aW9uQ291bnQoYm9vbCBwZW5kaW5nLCBib29sIGV4ZWN1dGVkKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCBjb3VudCkKICAgIHsKICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPHRyYW5zYWN0aW9uQ291bnQ7IGkrKykKICAgICAgICAgICAgaWYgKCAgIHBlbmRpbmcgJiYgIXRyYW5zYWN0aW9uc1tpXS5leGVjdXRlZAogICAgICAgICAgICAgICAgfHwgZXhlY3V0ZWQgJiYgdHJhbnNhY3Rpb25zW2ldLmV4ZWN1dGVkKQogICAgICAgICAgICAgICAgY291bnQgKz0gMTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIGxpc3Qgb2Ygb3duZXJzLgogICAgLy8vIEByZXR1cm4gTGlzdCBvZiBvd25lciBhZGRyZXNzZXMuCiAgICBmdW5jdGlvbiBnZXRPd25lcnMoKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoYWRkcmVzc1tdKQogICAgewogICAgICAgIHJldHVybiBvd25lcnM7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyBhcnJheSB3aXRoIG93bmVyIGFkZHJlc3Nlcywgd2hpY2ggY29uZmlybWVkIHRyYW5zYWN0aW9uLgogICAgLy8vIEBwYXJhbSB0cmFuc2FjdGlvbklkIFRyYW5zYWN0aW9uIElELgogICAgLy8vIEByZXR1cm4gUmV0dXJucyBhcnJheSBvZiBvd25lciBhZGRyZXNzZXMuCiAgICBmdW5jdGlvbiBnZXRDb25maXJtYXRpb25zKHVpbnQgdHJhbnNhY3Rpb25JZCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKGFkZHJlc3NbXSBfY29uZmlybWF0aW9ucykKICAgIHsKICAgICAgICBhZGRyZXNzW10gbWVtb3J5IGNvbmZpcm1hdGlvbnNUZW1wID0gbmV3IGFkZHJlc3NbXShvd25lcnMubGVuZ3RoKTsKICAgICAgICB1aW50IGNvdW50ID0gMDsKICAgICAgICB1aW50IGk7CiAgICAgICAgZm9yIChpPTA7IGk8b3duZXJzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBpZiAoY29uZmlybWF0aW9uc1t0cmFuc2FjdGlvbklkXVtvd25lcnNbaV1dKSB7CiAgICAgICAgICAgICAgICBjb25maXJtYXRpb25zVGVtcFtjb3VudF0gPSBvd25lcnNbaV07CiAgICAgICAgICAgICAgICBjb3VudCArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgX2NvbmZpcm1hdGlvbnMgPSBuZXcgYWRkcmVzc1tdKGNvdW50KTsKICAgICAgICBmb3IgKGk9MDsgaTxjb3VudDsgaSsrKQogICAgICAgICAgICBfY29uZmlybWF0aW9uc1tpXSA9IGNvbmZpcm1hdGlvbnNUZW1wW2ldOwogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgbGlzdCBvZiB0cmFuc2FjdGlvbiBJRHMgaW4gZGVmaW5lZCByYW5nZS4KICAgIC8vLyBAcGFyYW0gZnJvbSBJbmRleCBzdGFydCBwb3NpdGlvbiBvZiB0cmFuc2FjdGlvbiBhcnJheS4KICAgIC8vLyBAcGFyYW0gdG8gSW5kZXggZW5kIHBvc2l0aW9uIG9mIHRyYW5zYWN0aW9uIGFycmF5LgogICAgLy8vIEBwYXJhbSBwZW5kaW5nIEluY2x1ZGUgcGVuZGluZyB0cmFuc2FjdGlvbnMuCiAgICAvLy8gQHBhcmFtIGV4ZWN1dGVkIEluY2x1ZGUgZXhlY3V0ZWQgdHJhbnNhY3Rpb25zLgogICAgLy8vIEByZXR1cm4gUmV0dXJucyBhcnJheSBvZiB0cmFuc2FjdGlvbiBJRHMuCiAgICBmdW5jdGlvbiBnZXRUcmFuc2FjdGlvbklkcyh1aW50IGZyb20sIHVpbnQgdG8sIGJvb2wgcGVuZGluZywgYm9vbCBleGVjdXRlZCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnRbXSBfdHJhbnNhY3Rpb25JZHMpCiAgICB7CiAgICAgICAgdWludFtdIG1lbW9yeSB0cmFuc2FjdGlvbklkc1RlbXAgPSBuZXcgdWludFtdKHRyYW5zYWN0aW9uQ291bnQpOwogICAgICAgIHVpbnQgY291bnQgPSAwOwogICAgICAgIHVpbnQgaTsKICAgICAgICBmb3IgKGk9MDsgaTx0cmFuc2FjdGlvbkNvdW50OyBpKyspCiAgICAgICAgICAgIGlmICggICBwZW5kaW5nICYmICF0cmFuc2FjdGlvbnNbaV0uZXhlY3V0ZWQKICAgICAgICAgICAgICAgIHx8IGV4ZWN1dGVkICYmIHRyYW5zYWN0aW9uc1tpXS5leGVjdXRlZCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25JZHNUZW1wW2NvdW50XSA9IGk7CiAgICAgICAgICAgICAgICBjb3VudCArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgX3RyYW5zYWN0aW9uSWRzID0gbmV3IHVpbnRbXSh0byAtIGZyb20pOwogICAgICAgIGZvciAoaT1mcm9tOyBpPHRvOyBpKyspCiAgICAgICAgICAgIF90cmFuc2FjdGlvbklkc1tpIC0gZnJvbV0gPSB0cmFuc2FjdGlvbklkc1RlbXBbaV07CiAgICB9CiAgICAKICAgIC8vLyBAZGV2IENyZWF0ZSBuZXcgY29pbi4KICAgIGZ1bmN0aW9uIGNyZWF0ZUNvaW4oKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgb25seVdhbGxldAogICAgewogICAgICAgIHJlcXVpcmUoZmxhZyA9PSB0cnVlKTsKICAgICAgICBDb2luQ3JlYXRpb24obmV3IEdpZnRvKCkpOwogICAgICAgIGZsYWcgPSBmYWxzZTsKICAgIH0KfQ=='.
	

]
