Class {
	#name : #SRTc70afb5612b16d36d2204052f81932064fd084c5,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTc70afb5612b16d36d2204052f81932064fd084c5 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjA7CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBQYXVzYWJsZQogKiBAZGV2IEJhc2UgY29udHJhY3Qgd2hpY2ggYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uCiAqLwpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKICBldmVudCBQYXVzZSgpOwogIGV2ZW50IFVucGF1c2UoKTsKCiAgYm9vbCBwdWJsaWMgcGF1c2VkID0gZmFsc2U7CgoKICAvKioKICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIG5vdCBwYXVzZWQuCiAgICovCiAgbW9kaWZpZXIgd2hlbk5vdFBhdXNlZCgpIHsKICAgIHJlcXVpcmUoIXBhdXNlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBwYXVzZWQuCiAgICovCiAgbW9kaWZpZXIgd2hlblBhdXNlZCgpIHsKICAgIHJlcXVpcmUocGF1c2VkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gcGF1c2UsIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUKICAgKi8KICBmdW5jdGlvbiBwYXVzZSgpIG9ubHlPd25lciB3aGVuTm90UGF1c2VkIHB1YmxpYyB7CiAgICBwYXVzZWQgPSB0cnVlOwogICAgUGF1c2UoKTsKICB9CgogIC8qKgogICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byB1bnBhdXNlLCByZXR1cm5zIHRvIG5vcm1hbCBzdGF0ZQogICAqLwogIGZ1bmN0aW9uIHVucGF1c2UoKSBvbmx5T3duZXIgd2hlblBhdXNlZCBwdWJsaWMgewogICAgcGF1c2VkID0gZmFsc2U7CiAgICBVbnBhdXNlKCk7CiAgfQp9Cgpjb250cmFjdCBNaW50YWJsZVRva2VuIHsKICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwogIGZ1bmN0aW9uIGxlYXZlKCkgcHVibGljOwogIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIHJldHVybnMgKGJvb2wpOwp9Cgpjb250cmFjdCBDcnlwdG9Db2xvcnMgaXMgUGF1c2FibGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAvLyBDT05TVEFOVAoKICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiUGl4aW5jaCBDb2xvciI7CiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiUENMUiI7CiAgdWludCBwdWJsaWMgY29uc3RhbnQgdG90YWxTdXBwbHkgPSAxNjc3NzIxNjsKCiAgLy8gUFVCTElDIFZBUnMKICAvLyB0aGUgdG90YWwgbnVtYmVyIG9mIGNvbG9ycyBib3VnaHQKICB1aW50MjU2IHB1YmxpYyB0b3RhbEJvdWdodENvbG9yOwogIC8vIHN0YXJ0IGFuZCBlbmQgdGltZXN0YW1wcyB3aGVyZSBpbnZlc3RtZW50cyBhcmUgYWxsb3dlZCAoYm90aCBpbmNsdXNpdmUpCiAgdWludDI1NiBwdWJsaWMgc3RhcnRUaW1lOwogIHVpbnQyNTYgcHVibGljIGVuZFRpbWU7CiAgCiAgLy8gYWRkcmVzcyB3aGVyZSBmdW5kcyBhcmUgY29sbGVjdGVkCiAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0OwogIC8vIHByaWNlIGZvciBhIGNvbG9yCiAgdWludDI1NiBwdWJsaWMgY29sb3JQcmljZTsKICAvLyBuYiB0b2tlbiBzdXBwbHkgd2hlbiBhIGNvbG9yIGlzIGJvdWdodAogIHVpbnQgcHVibGljIHN1cHBseVBlckNvbG9yOwogIC8vIHRoZSBwYXJ0IG9uIHRoZSBzdXBwbHkgdGhhdCBpcyBjb2xsZWN0ZWQgYnkgUGl4aW5jaAogIHVpbnQ4IHB1YmxpYyBvd25lclBhcnQ7CgogIHVpbnQ4IHB1YmxpYyBib251c1N0ZXA7CiAgdWludCBwdWJsaWMgbmV4dEJvbnVzU3RlcExpbWl0ID0gNTAwMDAwOwoKICAvLyBNT0RJRklFUgogIAogIC8qKgogICogQGRldiBHdWFyYW50ZWVzIG1zZy5zZW5kZXIgaXMgb3duZXIgb2YgdGhlIGdpdmVuIHRva2VuCiAgKiBAcGFyYW0gX2luZGV4IHVpbnQyNTYgSW5kZXggb2YgdGhlIHRva2VuIHRvIHZhbGlkYXRlIGl0cyBvd25lcnNoaXAgYmVsb25ncyB0byBtc2cuc2VuZGVyCiAgKi8KICBtb2RpZmllciBvbmx5T3duZXJPZih1aW50IF9pbmRleCkgewogICAgcmVxdWlyZSh0cmVlW19pbmRleF0ub3duZXIgPT0gbXNnLnNlbmRlcik7CiAgICBfOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdhcmFudGVlIGluZGV4IGFuZCB0b2tlbiBhcmUgdmFsaWQgdmFsdWUKICAqLwogIG1vZGlmaWVyIGlzVmFsaWQodWludCBfdG9rZW5JZCwgdWludCBfaW5kZXgpIHsKICAgIHJlcXVpcmUoX3ZhbGlkVG9rZW4oX3Rva2VuSWQpICYmIF92YWxpZEluZGV4KF9pbmRleCkpOwogICAgXzsKICB9CgogIC8qKgogICogQGRldiBHdWFyYW50ZWVzIGFsbCBjb2xvciBoYXZlIGJlZW4gc29sZAogICovCiAgbW9kaWZpZXIgd2hlbkFjdGl2ZSgpIHsKICAgIHJlcXVpcmUoaXNDcm93ZFNhbGVBY3RpdmUoKSk7CiAgICBfOwogIH0KCiAgLyoqCiAgKiBAZGV2IEd1YXJhbnRlZXMgYWxsIGNvbG9yIGhhdmUgYmVlbiBzb2xkCiAgKi8KICBtb2RpZmllciB3aGVuR2FtZUFjdGl2ZSgpIHsKICAgIHJlcXVpcmUoaXNHYW1lQWN0aXZhdGVkKCkpOwogICAgXzsKICB9CgogIC8vIEVWRU5UUwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdG9rZW5JZCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9hcHByb3ZlZCwgdWludDI1NiBfdG9rZW5JZCk7CiAgZXZlbnQgQ29sb3JQdXJjaGFzZWQoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBjb2xvciwgdWludDI1NiB2YWx1ZSk7CiAgZXZlbnQgQ29sb3JSZXNlcnZlZChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgcXR5KTsKCgogIC8vIFBSSVZBVEUKICAvLyBhbW91bnQgb2YgcmFpc2VkIG1vbmV5IGluIHdlaSBhbmQgY2FwIGluIHdlaQogIHVpbnQyNTYgd2VpUmFpc2VkOwogIHVpbnQyNTYgY2FwOwogIC8vIHBhcnQgb2YgbWludCB0b2tlbiBmb3IgdGhlIHdhbGxldAogIHVpbnQ4IHdhbGxldFBhcnQ7CiAgLy8gYWRkcmVzcyBvZiB0aGUgbWludGFibGUgdG9rZW4KICBNaW50YWJsZVRva2VuIHRva2VuOwogIC8vIHN0YXJ0aW5nIGNvbG9yIHByaWNlCiAgdWludCBzdGFydFByaWNlID0gMTAgZmlubmV5OwoKICBzdHJ1Y3QgQmxvY2tSYW5nZSB7CiAgICB1aW50IHN0YXJ0OwogICAgdWludCBlbmQ7CiAgICB1aW50IG5leHQ7CiAgICBhZGRyZXNzIG93bmVyOwogICAgdWludCBwcmljZTsKICB9CgogIEJsb2NrUmFuZ2VbdG90YWxTdXBwbHkrMV0gdHJlZTsKICAvLyBtaW5JZCBhdmFpbGFibGUgaW4gdGhlIHRyZWUKICB1aW50IG1pbklkID0gMTsKICAvLyBtaW4gYmxvY2sgaW5kZXggYXZhaWxhYmxlIGluIHRoZSB0cmVlOwogIHVpbnQgbGFzdEJsb2NrSWQgPSAwOwogIC8vIG1hcHBpbmcgb2Ygb3duZXIgYW5kIHJhbmdlIGluZGV4IGluIHRoZSB0cmVlCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTZbXSkgb3duZXJSYW5nZUluZGV4OwogIC8vIE1hcHBpbmcgZnJvbSB0b2tlbiBJRCB0byBhcHByb3ZlZCBhZGRyZXNzCiAgbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSB0b2tlbkFwcHJvdmFsczsKICAvLyBwZW5kaW5nIHBheW1lbnRzCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIHByaXZhdGUgcGF5bWVudHM7CiAgLy8gbWFwcGluZyBvd25lciBiYWxhbmNlCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIHByaXZhdGUgb3duZXJCYWxhbmNlOwogIAoKICAvLyBDT05TVFJVQ1RPUgoKICBmdW5jdGlvbiBDcnlwdG9Db2xvcnModWludDI1NiBfc3RhcnRUaW1lLCB1aW50MjU2IF9lbmRUaW1lLCBhZGRyZXNzIF90b2tlbiwgYWRkcmVzcyBfd2FsbGV0KSBwdWJsaWMgewogICAgcmVxdWlyZShfdG9rZW4gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF93YWxsZXQgIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF9zdGFydFRpbWUgPiAwKTsKICAgIHJlcXVpcmUoX2VuZFRpbWUgPiBub3cpOwoKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIAogICAgY29sb3JQcmljZSA9IDAuMDAxIGV0aGVyOwogICAgc3VwcGx5UGVyQ29sb3IgPSA0OwogICAgb3duZXJQYXJ0ID0gNTA7CiAgICB3YWxsZXRQYXJ0ID0gNTA7CgogICAgc3RhcnRUaW1lID0gX3N0YXJ0VGltZTsKICAgIGVuZFRpbWUgPSBfZW5kVGltZTsKICAgIGNhcCA9IDk4MDAwIGV0aGVyOwogICAgCiAgICB0b2tlbiA9IE1pbnRhYmxlVG9rZW4oX3Rva2VuKTsKICAgIHdhbGxldCA9IF93YWxsZXQ7CiAgICAKICAgIC8vIGJvb2tlZCBmb3IgYWlyZHJvcCBhbmQgcmV3YXJkcwogICAgcmVzZXJ2ZVJhbmdlKG93bmVyLCAxNjc3NzApOwogIH0KCiAgLy8gZmFsbGJhY2sgZnVuY3Rpb24gY2FuIGJlIHVzZWQgdG8gYnV5IHRva2VucwogIGZ1bmN0aW9uICgpIGV4dGVybmFsIHBheWFibGUgewogICAgYnV5KCk7CiAgfQoKICAvLyBWSUVXUwogIAogIGZ1bmN0aW9uIG15UGVuZGluZ1BheW1lbnQoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KSB7CiAgICByZXR1cm4gcGF5bWVudHNbbXNnLnNlbmRlcl07CiAgfQoKICBmdW5jdGlvbiBpc0dhbWVBY3RpdmF0ZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gdG90YWxTdXBwbHkgPT0gdG90YWxCb3VnaHRDb2xvciB8fCBub3cgPiBlbmRUaW1lOwogIH0KCiAgZnVuY3Rpb24gaXNDcm93ZFNhbGVBY3RpdmUoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gbm93IDwgZW5kVGltZSAmJiBub3cgPj0gc3RhcnRUaW1lICYmIHdlaVJhaXNlZCA8IGNhcDsKICB9CgogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gb3duZXJCYWxhbmNlW19vd25lcl07CiAgfQoKICBmdW5jdGlvbiBvd25lck9mKHVpbnQyNTYgX3Rva2VuSWQpIHdoZW5HYW1lQWN0aXZlIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3Mgb3duZXIpIHsKICAgIHJlcXVpcmUoX3ZhbGlkVG9rZW4oX3Rva2VuSWQpKTsKICAgIHVpbnQgaW5kZXggPSBsb29rdXBJbmRleChfdG9rZW5JZCk7CiAgICByZXR1cm4gdHJlZVtpbmRleF0ub3duZXI7CiAgfQoKICAvLyByZXR1cm4gdG9rZW5zIGluZGV4IG93biBieSBhZGRyZXNzIChpbmNsdWRpbmcgaGlzdG9yeSkKICBmdW5jdGlvbiB0b2tlbnNJbmRleE9mKGFkZHJlc3MgX293bmVyLCBib29sIF93aXRoSGlzdG9yeSkgd2hlbkdhbWVBY3RpdmUgcHVibGljIHZpZXcgcmV0dXJucyAodWludFtdIHJlc3VsdCkgewogICAgcmVxdWlyZShfb3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBpZiAoX3dpdGhIaXN0b3J5KSB7CiAgICAgIHJldHVybiBvd25lclJhbmdlSW5kZXhbX293bmVyXTsKICAgIH0gZWxzZSB7CiAgICAgIHVpbnRbXSBtZW1vcnkgaW5kZXhlcyA9IG93bmVyUmFuZ2VJbmRleFtfb3duZXJdOwogICAgICByZXN1bHQgPSBuZXcgdWludFtdKGluZGV4ZXMubGVuZ3RoKTsKICAgICAgdWludCBpID0gMDsKICAgICAgZm9yICh1aW50IGluZGV4ID0gMDsgaW5kZXggPCBpbmRleGVzLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgIEJsb2NrUmFuZ2Ugc3RvcmFnZSBiciA9IHRyZWVbaW5kZXhlc1tpbmRleF1dOwogICAgICAgIGlmIChici5vd25lciA9PSBfb3duZXIpIHsKICAgICAgICAgIHJlc3VsdFtpXSA9IGluZGV4ZXNbaW5kZXhdOwogICAgICAgICAgaSsrOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm47CiAgICB9CiAgfQoKICBmdW5jdGlvbiBhcHByb3ZlZEZvcih1aW50MjU2IF90b2tlbklkKSB3aGVuR2FtZUFjdGl2ZSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICByZXF1aXJlKF92YWxpZFRva2VuKF90b2tlbklkKSk7CiAgICByZXR1cm4gdG9rZW5BcHByb3ZhbHNbX3Rva2VuSWRdOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIHJhbmdlIHN0b3JlIGF0IHRoZSBzcGVjaWZpZWQgaW5kZXguCiAgKiBAcGFyYW0gX2luZGV4IFRoZSBpbmRleCB0byBxdWVyeSB0aGUgdHJlZSBvZi4KICAqIEByZXR1cm4gQW4gQXJyYXkgb2YgdmFsdWUgaXMgdGhpcyBvcmRlcjogc3RhcnQsIGVuZCwgb3duZXIsIG5leHQsIHByaWNlLgogICovCiAgZnVuY3Rpb24gZ2V0UmFuZ2UodWludCBfaW5kZXgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQsIHVpbnQsIGFkZHJlc3MsIHVpbnQsIHVpbnQpIHsKICAgIEJsb2NrUmFuZ2Ugc3RvcmFnZSByYW5nZSA9IHRyZWVbX2luZGV4XTsKICAgIHJlcXVpcmUocmFuZ2Uub3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICByZXR1cm4gKHJhbmdlLnN0YXJ0LCByYW5nZS5lbmQsIHJhbmdlLm93bmVyLCByYW5nZS5uZXh0LCByYW5nZS5wcmljZSk7CiAgfQoKICBmdW5jdGlvbiBsb29rdXBJbmRleCh1aW50IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50IGluZGV4KSB7CiAgICByZXR1cm4gbG9va3VwSW5kZXgoX3Rva2VuSWQsIDEpOwogIH0KCiAgZnVuY3Rpb24gbG9va3VwSW5kZXgodWludCBfdG9rZW5JZCwgdWludCBfc3RhcnQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQgaW5kZXgpIHsKICAgIGlmIChfdG9rZW5JZCA+IHRvdGFsU3VwcGx5IHx8IF90b2tlbklkID4gbWluSWQpIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICBCbG9ja1JhbmdlIHN0b3JhZ2Ugc3RhcnRCbG9jayA9IHRyZWVbX3Rva2VuSWRdOwogICAgaWYgKHN0YXJ0QmxvY2sub3duZXIgIT0gYWRkcmVzcygwKSkgewogICAgICByZXR1cm4gX3Rva2VuSWQ7CiAgICB9CiAgICBpbmRleCA9IF9zdGFydDsKICAgIHN0YXJ0QmxvY2sgPSB0cmVlW2luZGV4XTsKICAgIHJlcXVpcmUoc3RhcnRCbG9jay5vd25lciAhPSBhZGRyZXNzKDApKTsKICAgIHdoaWxlIChzdGFydEJsb2NrLmVuZCA8IF90b2tlbklkICYmIHN0YXJ0QmxvY2submV4dCAhPSAwICkgewogICAgICBpbmRleCA9IHN0YXJ0QmxvY2submV4dDsKICAgICAgc3RhcnRCbG9jayA9IHRyZWVbaW5kZXhdOwogICAgfQogICAgcmV0dXJuOwogIH0KCiAgLy8gUEFZQUJMRQoKICBmdW5jdGlvbiBidXkoKSBwdWJsaWMgcGF5YWJsZSB3aGVuQWN0aXZlIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoc3RyaW5nIHRoYW5rcykgewogICAgcmVxdWlyZShtc2cuc2VuZGVyICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShtc2cudmFsdWUuZGl2KGNvbG9yUHJpY2UpID4gMCk7CiAgICB1aW50IF9uYkNvbG9ycyA9IDA7CiAgICB1aW50IHZhbHVlID0gbXNnLnZhbHVlOwogICAgaWYgKHRvdGFsU3VwcGx5ID4gdG90YWxCb3VnaHRDb2xvcikgewogICAgICAoX25iQ29sb3JzLCB2YWx1ZSkgPSBidXlDb2xvcnMobXNnLnNlbmRlciwgdmFsdWUpOwogICAgfQogICAgaWYgKHRvdGFsU3VwcGx5ID09IHRvdGFsQm91Z2h0Q29sb3IpIHsKICAgICAgLy8gcmVxdWlyZSh2YWx1ZSA+PSBjb2xvclByaWNlICYmIHdlaVJhaXNlZC5hZGQodmFsdWUpIDw9IGNhcCk7CiAgICAgIGlmICh3ZWlSYWlzZWQuYWRkKHZhbHVlKSA+IGNhcCkgewogICAgICAgIHZhbHVlID0gY2FwLnN1Yih3ZWlSYWlzZWQpOwogICAgICB9CiAgICAgIF9uYkNvbG9ycyA9IF9uYkNvbG9ycy5hZGQodmFsdWUuZGl2KGNvbG9yUHJpY2UpKTsKICAgICAgbWludFBpbihtc2cuc2VuZGVyLCBfbmJDb2xvcnMpOwogICAgICBpZiAod2VpUmFpc2VkID09IGNhcCApIHsKICAgICAgICBlbmRUaW1lID0gbm93OwogICAgICAgIHRva2VuLmxlYXZlKCk7CiAgICAgIH0KICAgIH0KICAgIGZvcndhcmRGdW5kcyh2YWx1ZSk7CiAgICByZXR1cm4gInRoYW5rIHlvdSBmb3IgeW91ciBwYXJ0aWNpcGF0aW9uLiI7CiAgfQoKICBmdW5jdGlvbiBwdXJjaGFzZSh1aW50IF90b2tlbklkKSBwdWJsaWMgcGF5YWJsZSB3aGVuR2FtZUFjdGl2ZSB7CiAgICB1aW50IF9pbmRleCA9IGxvb2t1cEluZGV4KF90b2tlbklkKTsKICAgIHJldHVybiBwdXJjaGFzZVdpdGhJbmRleChfdG9rZW5JZCwgX2luZGV4KTsKICB9CiAgCiAgZnVuY3Rpb24gcHVyY2hhc2VXaXRoSW5kZXgodWludCBfdG9rZW5JZCwgdWludCBfaW5kZXgpIHB1YmxpYyBwYXlhYmxlIHdoZW5HYW1lQWN0aXZlIGlzVmFsaWQoX3Rva2VuSWQsIF9pbmRleCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyICE9IGFkZHJlc3MoMCkpOwoKICAgIEJsb2NrUmFuZ2Ugc3RvcmFnZSBiUmFuZ2UgPSB0cmVlW19pbmRleF07CiAgICByZXF1aXJlKGJSYW5nZS5zdGFydCA8PSBfdG9rZW5JZCAmJiBfdG9rZW5JZCA8PSBiUmFuZ2UuZW5kKTsKICAgIGlmIChiUmFuZ2Uuc3RhcnQgPCBiUmFuZ2UuZW5kKSB7CiAgICAgIC8vIHNwbGl0IGFuZCB1cGRhdGUgaW5kZXg7CiAgICAgIF9pbmRleCA9IHNwbGl0UmFuZ2UoX2luZGV4LCBfdG9rZW5JZCwgX3Rva2VuSWQpOwogICAgICBiUmFuZ2UgPSB0cmVlW19pbmRleF07CiAgICB9CgogICAgdWludCBwcmljZSA9IGJSYW5nZS5wcmljZTsKICAgIGFkZHJlc3MgcHJldk93bmVyID0gYlJhbmdlLm93bmVyOwogICAgcmVxdWlyZShtc2cudmFsdWUgPj0gcHJpY2UgJiYgcHJldk93bmVyICE9IG1zZy5zZW5kZXIpOwogICAgaWYgKHByZXZPd25lciAhPSBhZGRyZXNzKDApKSB7CiAgICAgIHBheW1lbnRzW3ByZXZPd25lcl0gPSBwYXltZW50c1twcmV2T3duZXJdLmFkZChwcmljZSk7CiAgICAgIG93bmVyQmFsYW5jZVtwcmV2T3duZXJdLS07CiAgICB9CiAgICAvLyBhZGQgaXMgbGVzcyBleHBlbnNpdmUgdGhhbiBtdWwKICAgIGJSYW5nZS5wcmljZSA9IGJSYW5nZS5wcmljZS5hZGQoYlJhbmdlLnByaWNlKTsKICAgIGJSYW5nZS5vd25lciA9IG1zZy5zZW5kZXI7CgogICAgLy8gdXBkYXRlIG93bmVkQ29sb3JzCiAgICBvd25lclJhbmdlSW5kZXhbbXNnLnNlbmRlcl0ucHVzaChfaW5kZXgpOwogICAgb3duZXJCYWxhbmNlW21zZy5zZW5kZXJdKys7CgogICAgQ29sb3JQdXJjaGFzZWQocHJldk93bmVyLCBtc2cuc2VuZGVyLCBfdG9rZW5JZCwgcHJpY2UpOwogICAgbXNnLnNlbmRlci50cmFuc2Zlcihtc2cudmFsdWUuc3ViKHByaWNlKSk7CiAgfQoKICAvLyBQVUJMSUMKCiAgZnVuY3Rpb24gdXBkYXRlVG9rZW4oYWRkcmVzcyBfdG9rZW4pIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShfdG9rZW4gIT0gYWRkcmVzcygwKSk7CiAgICB0b2tlbiA9IE1pbnRhYmxlVG9rZW4oX3Rva2VuKTsKICB9CgogIGZ1bmN0aW9uIHVwZGF0ZVdhbGxldChhZGRyZXNzIF93YWxsZXQpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShfd2FsbGV0ICE9IGFkZHJlc3MoMCkpOwogICAgd2FsbGV0ID0gX3dhbGxldDsKICB9CgogIGZ1bmN0aW9uIHdpdGhkcmF3UGF5bWVudCgpIHB1YmxpYyB3aGVuR2FtZUFjdGl2ZSB7CiAgICB1aW50IHJlZnVuZCA9IHBheW1lbnRzW21zZy5zZW5kZXJdOwogICAgcGF5bWVudHNbbXNnLnNlbmRlcl0gPSAwOwogICAgbXNnLnNlbmRlci50cmFuc2ZlcihyZWZ1bmQpOwogIH0KCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB7CiAgICB1aW50IF9pbmRleCA9IGxvb2t1cEluZGV4KF90b2tlbklkKTsKICAgIHJldHVybiB0cmFuc2ZlcldpdGhJbmRleChfdG8sIF90b2tlbklkLCBfaW5kZXgpOwogIH0KICAKICBmdW5jdGlvbiB0cmFuc2ZlcldpdGhJbmRleChhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCwgdWludCBfaW5kZXgpIHB1YmxpYyBpc1ZhbGlkKF90b2tlbklkLCBfaW5kZXgpIG9ubHlPd25lck9mKF9pbmRleCkgewogICAgQmxvY2tSYW5nZSBzdG9yYWdlIGJSYW5nZSA9IHRyZWVbX2luZGV4XTsKICAgIGlmIChiUmFuZ2Uuc3RhcnQgPiBfdG9rZW5JZCB8fCBfdG9rZW5JZCA+IGJSYW5nZS5lbmQpIHsKICAgICAgX2luZGV4ID0gbG9va3VwSW5kZXgoX3Rva2VuSWQsIF9pbmRleCk7CiAgICAgIHJlcXVpcmUoX2luZGV4ID4gMCk7CiAgICAgIGJSYW5nZSA9IHRyZWVbX2luZGV4XTsKICAgIH0KICAgIGlmIChiUmFuZ2Uuc3RhcnQgPCBiUmFuZ2UuZW5kKSB7CiAgICAgIF9pbmRleCA9IHNwbGl0UmFuZ2UoX2luZGV4LCBfdG9rZW5JZCwgX3Rva2VuSWQpOwogICAgICBiUmFuZ2UgPSB0cmVlW19pbmRleF07CiAgICB9CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApICYmIGJSYW5nZS5vd25lciAhPSBfdG8pOwogICAgYlJhbmdlLm93bmVyID0gX3RvOwogICAgb3duZXJSYW5nZUluZGV4W21zZy5zZW5kZXJdLnB1c2goX2luZGV4KTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3Rva2VuSWQpOwogICAgb3duZXJCYWxhbmNlW190b10rKzsKICAgIG93bmVyQmFsYW5jZVttc2cuc2VuZGVyXS0tOwogIH0KCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIHsKICAgIHVpbnQgX2luZGV4ID0gbG9va3VwSW5kZXgoX3Rva2VuSWQpOwogICAgcmV0dXJuIGFwcHJvdmVXaXRoSW5kZXgoX3RvLCBfdG9rZW5JZCwgX2luZGV4KTsKICB9CiAgCiAgZnVuY3Rpb24gYXBwcm92ZVdpdGhJbmRleChhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCwgdWludCBfaW5kZXgpIHB1YmxpYyBpc1ZhbGlkKF90b2tlbklkLCBfaW5kZXgpIG9ubHlPd25lck9mKF9pbmRleCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICBCbG9ja1JhbmdlIHN0b3JhZ2UgYlJhbmdlID0gdHJlZVtfaW5kZXhdOwogICAgaWYgKGJSYW5nZS5zdGFydCA+IF90b2tlbklkIHx8IF90b2tlbklkID4gYlJhbmdlLmVuZCkgewogICAgICBfaW5kZXggPSBsb29rdXBJbmRleChfdG9rZW5JZCwgX2luZGV4KTsKICAgICAgcmVxdWlyZShfaW5kZXggPiAwKTsKICAgICAgYlJhbmdlID0gdHJlZVtfaW5kZXhdOwogICAgfQogICAgcmVxdWlyZShfdG8gIT0gYlJhbmdlLm93bmVyKTsKICAgIGlmIChiUmFuZ2Uuc3RhcnQgPCBiUmFuZ2UuZW5kKSB7CiAgICAgIHNwbGl0UmFuZ2UoX2luZGV4LCBfdG9rZW5JZCwgX3Rva2VuSWQpOwogICAgfQogICAgdG9rZW5BcHByb3ZhbHNbX3Rva2VuSWRdID0gX3RvOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3RvLCBfdG9rZW5JZCk7CiAgfQoKICBmdW5jdGlvbiB0YWtlT3duZXJzaGlwKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB7CiAgICB1aW50IGluZGV4ID0gbG9va3VwSW5kZXgoX3Rva2VuSWQpOwogICAgcmV0dXJuIHRha2VPd25lcnNoaXBXaXRoSW5kZXgoX3Rva2VuSWQsIGluZGV4KTsKICB9CgogIGZ1bmN0aW9uIHRha2VPd25lcnNoaXBXaXRoSW5kZXgodWludDI1NiBfdG9rZW5JZCwgdWludCBfaW5kZXgpIHB1YmxpYyBpc1ZhbGlkKF90b2tlbklkLCBfaW5kZXgpIHsKICAgIHJlcXVpcmUodG9rZW5BcHByb3ZhbHNbX3Rva2VuSWRdID09IG1zZy5zZW5kZXIpOwogICAgQmxvY2tSYW5nZSBzdG9yYWdlIGJSYW5nZSA9IHRyZWVbX2luZGV4XTsKICAgIHJlcXVpcmUoYlJhbmdlLnN0YXJ0IDw9IF90b2tlbklkICYmIF90b2tlbklkIDw9IGJSYW5nZS5lbmQpOwogICAgb3duZXJCYWxhbmNlW2JSYW5nZS5vd25lcl0tLTsKICAgIGJSYW5nZS5vd25lciA9IG1zZy5zZW5kZXI7CiAgICBvd25lclJhbmdlSW5kZXhbbXNnLnNlbmRlcl0ucHVzaChfaW5kZXgpOyAKICAgIG93bmVyQmFsYW5jZVttc2cuc2VuZGVyXSsrOwogICAgVHJhbnNmZXIoYlJhbmdlLm93bmVyLCBtc2cuc2VuZGVyLCBfdG9rZW5JZCk7CiAgICBkZWxldGUgdG9rZW5BcHByb3ZhbHNbX3Rva2VuSWRdOwogIH0KCgogIC8vIElOVEVSTkFMCiAgZnVuY3Rpb24gZm9yd2FyZEZ1bmRzKHVpbnQyNTYgdmFsdWUpIHByaXZhdGUgewogICAgd2FsbGV0LnRyYW5zZmVyKHZhbHVlKTsKICAgIHdlaVJhaXNlZCA9IHdlaVJhaXNlZC5hZGQodmFsdWUpOwogICAgbXNnLnNlbmRlci50cmFuc2Zlcihtc2cudmFsdWUuc3ViKHZhbHVlKSk7CiAgfQoKICBmdW5jdGlvbiBtaW50UGluKGFkZHJlc3MgX3RvLCB1aW50IF9uYkNvbG9ycykgcHJpdmF0ZSB7CiAgICB1aW50IF9zdXBwbHkgPSBzdXBwbHlQZXJDb2xvci5tdWwoX25iQ29sb3JzKTsKICAgIGlmIChfc3VwcGx5ID09IDApIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgdWludCBfb3duZXJQYXJ0ID0gX3N1cHBseS5tdWwob3duZXJQYXJ0KS8xMDA7CiAgICB0b2tlbi5taW50KF90bywgdWludDI1Nihfb3duZXJQYXJ0Lm11bCgxMDAwMDAwMDApKSk7CiAgICB1aW50IF93YWxsZXRQYXJ0ID0gX3N1cHBseS5tdWwod2FsbGV0UGFydCkvMTAwOwogICAgdG9rZW4ubWludCh3YWxsZXQsIHVpbnQyNTYoX3dhbGxldFBhcnQubXVsKDEwMDAwMDAwMCkpKTsKICB9CgogIGZ1bmN0aW9uIGJ1eUNvbG9ycyhhZGRyZXNzIF90bywgdWludDI1NiB2YWx1ZSkgcHJpdmF0ZSByZXR1cm5zICh1aW50IF9uYkNvbG9ycywgdWludCB2YWx1ZVJlc3QpIHsKICAgIF9uYkNvbG9ycyA9IHZhbHVlLmRpdihjb2xvclByaWNlKTsKICAgIGlmIChib251c1N0ZXAgPCAzICYmIHRvdGFsQm91Z2h0Q29sb3IuYWRkKF9uYkNvbG9ycykgPiBuZXh0Qm9udXNTdGVwTGltaXQpIHsKICAgICAgdWludCBtYXggPSBuZXh0Qm9udXNTdGVwTGltaXQuc3ViKHRvdGFsQm91Z2h0Q29sb3IpOwogICAgICB1aW50IHZhbCA9IG1heC5tdWwoY29sb3JQcmljZSk7CiAgICAgIGlmIChtYXggPT0gMCB8fCB2YWwgPiB2YWx1ZSkgewogICAgICAgIHJldHVybiAoMCwgdmFsdWUpOwogICAgICB9CiAgICAgIHZhbHVlUmVzdCA9IHZhbHVlLnN1Yih2YWwpOwogICAgICByZXNlcnZlQ29sb3JzKF90bywgbWF4KTsKICAgICAgdWludCBfYzsKICAgICAgdWludCBfdjsKICAgICAgKF9jLCBfdikgPSBidXlDb2xvcnMoX3RvLCB2YWx1ZVJlc3QpOwogICAgICByZXR1cm4gKF9jLmFkZChtYXgpLCBfdi5hZGQodmFsKSk7CiAgICB9CiAgICByZXNlcnZlQ29sb3JzKF90bywgX25iQ29sb3JzKTsKICAgIHJldHVybiAoX25iQ29sb3JzLCB2YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiByZXNlcnZlQ29sb3JzKGFkZHJlc3MgX3RvLCB1aW50IF9uYkNvbG9ycykgcHJpdmF0ZSByZXR1cm5zICh1aW50KSB7CiAgICBpZiAoX25iQ29sb3JzID4gdG90YWxTdXBwbHkgLSB0b3RhbEJvdWdodENvbG9yKSB7CiAgICAgIF9uYkNvbG9ycyA9IHRvdGFsU3VwcGx5IC0gdG90YWxCb3VnaHRDb2xvcjsKICAgIH0KICAgIGlmIChfbmJDb2xvcnMgPT0gMCkgewogICAgICByZXR1cm47CiAgICB9CiAgICByZXNlcnZlUmFuZ2UoX3RvLCBfbmJDb2xvcnMpOwogICAgQ29sb3JSZXNlcnZlZChfdG8sIF9uYkNvbG9ycyk7CiAgICBtaW50UGluKF90bywgX25iQ29sb3JzKTsKICAgIGNoZWNrRm9yU3RlcHMoKTsKICAgIHJldHVybiBfbmJDb2xvcnM7CiAgfQoKICBmdW5jdGlvbiBjaGVja0ZvclN0ZXBzKCkgcHJpdmF0ZSB7CiAgICBpZiAoYm9udXNTdGVwIDwgMyAmJiB0b3RhbEJvdWdodENvbG9yID49IG5leHRCb251c1N0ZXBMaW1pdCkgewogICAgICBpZiAoIGJvbnVzU3RlcCA9PSAwKSB7CiAgICAgICAgY29sb3JQcmljZSA9IGNvbG9yUHJpY2UgKyBjb2xvclByaWNlOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbG9yUHJpY2UgPSBjb2xvclByaWNlICsgY29sb3JQcmljZSAtICgxICogMC4wMDEgZmlubmV5KTsKICAgICAgfQogICAgICBib251c1N0ZXAgPSBib251c1N0ZXAgKyAxOwogICAgICBuZXh0Qm9udXNTdGVwTGltaXQgPSBuZXh0Qm9udXNTdGVwTGltaXQgKyAoNTAwMDAgKyAoYm9udXNTdGVwKzEpICogMTAwMDAwKTsKICAgIH0KICAgIGlmIChpc0dhbWVBY3RpdmF0ZWQoKSkgewogICAgICBjb2xvclByaWNlID0gMSBmaW5uZXk7CiAgICAgIG93bmVyUGFydCA9IDcwOwogICAgICB3YWxsZXRQYXJ0ID0gMzA7CiAgICAgIGVuZFRpbWUgPSBub3cuYWRkKDEyMCBob3Vycyk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBfdmFsaWRJbmRleCh1aW50IF9pbmRleCkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gX2luZGV4ID4gMCAmJiBfaW5kZXggPCB0cmVlLmxlbmd0aDsKICB9CgogIGZ1bmN0aW9uIF92YWxpZFRva2VuKHVpbnQgX3Rva2VuSWQpIGludGVybmFsIHB1cmUgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIF90b2tlbklkID4gMCAmJiBfdG9rZW5JZCA8PSB0b3RhbFN1cHBseTsKICB9CgogIGZ1bmN0aW9uIHJlc2VydmVSYW5nZShhZGRyZXNzIF90bywgdWludCBfbmJUb2tlbnMpIGludGVybmFsIHsKICAgIHJlcXVpcmUoX25iVG9rZW5zIDw9IHRvdGFsU3VwcGx5KTsKICAgIEJsb2NrUmFuZ2Ugc3RvcmFnZSByYmxvY2sgPSB0cmVlW21pbklkXTsKICAgIHJibG9jay5zdGFydCA9IG1pbklkOwogICAgcmJsb2NrLmVuZCA9IG1pbklkLmFkZChfbmJUb2tlbnMpLnN1YigxKTsKICAgIHJibG9jay5vd25lciA9IF90bzsKICAgIHJibG9jay5wcmljZSA9IHN0YXJ0UHJpY2U7CiAgICAKICAgIHJibG9jayA9IHRyZWVbbGFzdEJsb2NrSWRdOwogICAgcmJsb2NrLm5leHQgPSBtaW5JZDsKICAgIAogICAgbGFzdEJsb2NrSWQgPSBtaW5JZDsKICAgIG93bmVyUmFuZ2VJbmRleFtfdG9dLnB1c2gobWluSWQpOwogICAgCiAgICBvd25lckJhbGFuY2VbX3RvXSA9IG93bmVyQmFsYW5jZVtfdG9dLmFkZChfbmJUb2tlbnMpOwogICAgbWluSWQgPSBtaW5JZC5hZGQoX25iVG9rZW5zKTsKICAgIHRvdGFsQm91Z2h0Q29sb3IgPSB0b3RhbEJvdWdodENvbG9yLmFkZChfbmJUb2tlbnMpOwogIH0KCiAgZnVuY3Rpb24gc3BsaXRSYW5nZSh1aW50IGluZGV4LCB1aW50IHN0YXJ0LCB1aW50IGVuZCkgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgcmVxdWlyZShpbmRleCA+IDApOwogICAgcmVxdWlyZShzdGFydCA8PSBlbmQpOwogICAgQmxvY2tSYW5nZSBzdG9yYWdlIHN0YXJ0QmxvY2sgPSB0cmVlW2luZGV4XTsKICAgIHJlcXVpcmUoc3RhcnRCbG9jay5zdGFydCA8IHN0YXJ0QmxvY2suZW5kICYmIHN0YXJ0QmxvY2suc3RhcnQgPD0gc3RhcnQgJiYgc3RhcnRCbG9jay5lbmQgPj0gZW5kKTsKCiAgICBCbG9ja1JhbmdlIG1lbW9yeSByYmxvY2tVbmlxdWUgPSB0cmVlW3N0YXJ0XTsKICAgIHJibG9ja1VuaXF1ZS5zdGFydCA9IHN0YXJ0OwogICAgcmJsb2NrVW5pcXVlLmVuZCA9IGVuZDsKICAgIHJibG9ja1VuaXF1ZS5vd25lciA9IHN0YXJ0QmxvY2sub3duZXI7CiAgICByYmxvY2tVbmlxdWUucHJpY2UgPSBzdGFydEJsb2NrLnByaWNlOwogICAgCiAgICB1aW50IG5leHRTdGFydCA9IGVuZC5hZGQoMSk7CiAgICBpZiAobmV4dFN0YXJ0IDw9IHRvdGFsU3VwcGx5KSB7CiAgICAgIHJibG9ja1VuaXF1ZS5uZXh0ID0gbmV4dFN0YXJ0OwoKICAgICAgQmxvY2tSYW5nZSBzdG9yYWdlIHJibG9ja0VuZCA9IHRyZWVbbmV4dFN0YXJ0XTsKICAgICAgcmJsb2NrRW5kLnN0YXJ0ID0gbmV4dFN0YXJ0OwogICAgICByYmxvY2tFbmQuZW5kID0gc3RhcnRCbG9jay5lbmQ7CiAgICAgIHJibG9ja0VuZC5vd25lciA9IHN0YXJ0QmxvY2sub3duZXI7CiAgICAgIHJibG9ja0VuZC5uZXh0ID0gc3RhcnRCbG9jay5uZXh0OwogICAgICByYmxvY2tFbmQucHJpY2UgPSBzdGFydEJsb2NrLnByaWNlOwogICAgfQoKICAgIGlmIChzdGFydEJsb2NrLnN0YXJ0IDwgc3RhcnQpIHsKICAgICAgc3RhcnRCbG9jay5lbmQgPSBzdGFydC5zdWIoMSk7CiAgICB9IGVsc2UgewogICAgICBzdGFydEJsb2NrLmVuZCA9IHN0YXJ0OwogICAgfQogICAgc3RhcnRCbG9jay5uZXh0ID0gc3RhcnQ7CiAgICB0cmVlW3N0YXJ0XSA9IHJibG9ja1VuaXF1ZTsKICAgIC8vIHVwZGF0ZSBvd24gY29sb3IKICAgIGlmIChyYmxvY2tVbmlxdWUubmV4dCAhPSBzdGFydEJsb2NrLm5leHQpIHsKICAgICAgb3duZXJSYW5nZUluZGV4W3N0YXJ0QmxvY2sub3duZXJdLnB1c2goc3RhcnRCbG9jay5uZXh0KTsKICAgIH0KICAgIGlmIChyYmxvY2tVbmlxdWUubmV4dCAhPSAwKSB7CiAgICAgIG93bmVyUmFuZ2VJbmRleFtzdGFydEJsb2NrLm93bmVyXS5wdXNoKHJibG9ja1VuaXF1ZS5uZXh0KTsKICAgIH0KICAgIAogICAgcmV0dXJuIHN0YXJ0QmxvY2submV4dDsKICB9Cn0KCi8qKgogKiBAdGl0bGUgU2FmZU1hdGgKICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCmxpYnJhcnkgU2FmZU1hdGggewoKICAvKioKICAqIEBkZXYgTXVsdGlwbGllcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICovCiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IEludGVnZXIgZGl2aXNpb24gb2YgdHdvIG51bWJlcnMsIHRydW5jYXRpbmcgdGhlIHF1b3RpZW50LgogICovCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICAvKioKICAqIEBkZXYgU3Vic3RyYWN0cyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93IChpLmUuIGlmIHN1YnRyYWhlbmQgaXMgZ3JlYXRlciB0aGFuIG1pbnVlbmQpLgogICovCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgLyoqCiAgKiBAZGV2IEFkZHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9'.
	

]
