Class {
	#name : #SRT4C29d75cc423E8Adaa3839892feb66977e295829,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT4C29d75cc423E8Adaa3839892feb66977e295829 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjA7CgovKgoqIAoqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSoKKiAgX19fX18gICBfX19fICAgX19fXyAgXyAgICBfICAgICAgICAqCiogfCAgX18gXCAvIF9fIFwgLyBfXyBcfCB8ICB8IHwgICAgICAgKgoqIHwgfF9fKSB8IHwgIHwgfCB8ICB8IHwgfF9ffCB8ICAgICAgICoKKiB8ICBfX18vfCB8ICB8IHwgfCAgfCB8ICBfXyAgfCAgICAgICAqCiogfCB8ICAgIHwgfF9ffCB8IHwgIHwgfCB8ICB8IHwgICAgICAgKgoqIHxffCAgICAgXF9fX18vIFxfX19fL3xffCAgfF98ICAgICAgICoKKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qCiogLT4gV2hhdD8KKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGNvcHkgb2YgUHJvb2Ygb2YgV2VhayBIYW5kcyAoUE9XSDNEKQoqIElmIFBPV0wgY2FuIGRvIGl0LCBzaGl0LCB3aHkgY2FuJ3Qgd2U/CiogQ2FsbCB1cyBzaGl0aGVhZHMsIGJlY2F1c2Ugd2UgbG92ZSBQT09IIDopCiovCgpjb250cmFjdCBQT09IIHsKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICA9ICAgICAgICAgICAgTU9ESUZJRVJTICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIC8vIG9ubHkgcGVvcGxlIHdpdGggdG9rZW5zCiAgICBtb2RpZmllciBvbmx5QmFnaG9sZGVycygpIHsKICAgICAgICByZXF1aXJlKG15VG9rZW5zKCkgPiAwKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICAvLyBvbmx5IHBlb3BsZSB3aXRoIHByb2ZpdHMKICAgIG1vZGlmaWVyIG9ubHlTdHJvbmdoYW5kcygpIHsKICAgICAgICByZXF1aXJlKG15RGl2aWRlbmRzKHRydWUpID4gMCk7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgLy8gYWRtaW5pc3RyYXRvcnMgY2FuOgogICAgLy8gLT4gY2hhbmdlIHRoZSBuYW1lIG9mIHRoZSBjb250cmFjdAogICAgLy8gLT4gY2hhbmdlIHRoZSBuYW1lIG9mIHRoZSB0b2tlbgogICAgLy8gLT4gY2hhbmdlIHRoZSBQb1MgZGlmZmljdWx0eSAoSG93IG1hbnkgdG9rZW5zIGl0IGNvc3RzIHRvIGhvbGQgYSBtYXN0ZXJub2RlLCBpbiBjYXNlIGl0IGdldHMgY3JhenkgaGlnaCBsYXRlcikKICAgIC8vIHRoZXkgQ0FOTk9UOgogICAgLy8gLT4gdGFrZSBmdW5kcwogICAgLy8gLT4gZGlzYWJsZSB3aXRoZHJhd2FscwogICAgLy8gLT4ga2lsbCB0aGUgY29udHJhY3QKICAgIC8vIC0+IGNoYW5nZSB0aGUgcHJpY2Ugb2YgdG9rZW5zCiAgICBtb2RpZmllciBvbmx5QWRtaW5pc3RyYXRvcigpewogICAgICAgIGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgcmVxdWlyZShhZG1pbmlzdHJhdG9yc1trZWNjYWsyNTYoX2N1c3RvbWVyQWRkcmVzcyldKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICAKICAgIC8vIGVuc3VyZXMgdGhhdCB0aGUgZmlyc3QgdG9rZW5zIGluIHRoZSBjb250cmFjdCB3aWxsIGJlIGVxdWFsbHkgZGlzdHJpYnV0ZWQKICAgIC8vIG1lYW5pbmcsIG5vIGRpdmluZSBkdW1wIHdpbGwgYmUgZXZlciBwb3NzaWJsZQogICAgLy8gcmVzdWx0OiBoZWFsdGh5IGxvbmdldml0eS4KICAgIG1vZGlmaWVyIGFudGlFYXJseVdoYWxlKHVpbnQyNTYgX2Ftb3VudE9mRXRoZXJldW0pewogICAgICAgIGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgCiAgICAgICAgLy8gYXJlIHdlIHN0aWxsIGluIHRoZSB2dWxuZXJhYmxlIHBoYXNlPwogICAgICAgIC8vIGlmIHNvLCBlbmFjdCBhbnRpIGVhcmx5IHdoYWxlIHByb3RvY29sIAogICAgICAgIGlmKCBvbmx5QW1iYXNzYWRvcnMgJiYgKCh0b3RhbEV0aGVyZXVtQmFsYW5jZSgpIC0gX2Ftb3VudE9mRXRoZXJldW0pIDw9IGFtYmFzc2Fkb3JRdW90YV8gKSl7CiAgICAgICAgICAgIHJlcXVpcmUoCiAgICAgICAgICAgICAgICAvLyBpcyB0aGUgY3VzdG9tZXIgaW4gdGhlIGFtYmFzc2Fkb3IgbGlzdD8KICAgICAgICAgICAgICAgIGFtYmFzc2Fkb3JzX1tfY3VzdG9tZXJBZGRyZXNzXSA9PSB0cnVlICYmCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIGRvZXMgdGhlIGN1c3RvbWVyIHB1cmNoYXNlIGV4Y2VlZCB0aGUgbWF4IGFtYmFzc2Fkb3IgcXVvdGE/CiAgICAgICAgICAgICAgICAoYW1iYXNzYWRvckFjY3VtdWxhdGVkUXVvdGFfW19jdXN0b21lckFkZHJlc3NdICsgX2Ftb3VudE9mRXRoZXJldW0pIDw9IGFtYmFzc2Fkb3JNYXhQdXJjaGFzZV8KICAgICAgICAgICAgICAgIAogICAgICAgICAgICApOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gdXBkYXRlZCB0aGUgYWNjdW11bGF0ZWQgcXVvdGEgICAgCiAgICAgICAgICAgIGFtYmFzc2Fkb3JBY2N1bXVsYXRlZFF1b3RhX1tfY3VzdG9tZXJBZGRyZXNzXSA9IFNhZmVNYXRoLmFkZChhbWJhc3NhZG9yQWNjdW11bGF0ZWRRdW90YV9bX2N1c3RvbWVyQWRkcmVzc10sIF9hbW91bnRPZkV0aGVyZXVtKTsKICAgICAgICAKICAgICAgICAgICAgLy8gZXhlY3V0ZQogICAgICAgICAgICBfOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIGluIGNhc2UgdGhlIGV0aGVyIGNvdW50IGRyb3BzIGxvdywgdGhlIGFtYmFzc2Fkb3IgcGhhc2Ugd29uJ3QgcmVpbml0aWF0ZQogICAgICAgICAgICBvbmx5QW1iYXNzYWRvcnMgPSBmYWxzZTsKICAgICAgICAgICAgXzsgICAgCiAgICAgICAgfQogICAgICAgIAogICAgfQogICAgCiAgICAKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICA9ICAgICAgICAgICAgRVZFTlRTICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIGV2ZW50IG9uVG9rZW5QdXJjaGFzZSgKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgY3VzdG9tZXJBZGRyZXNzLAogICAgICAgIHVpbnQyNTYgaW5jb21pbmdFdGhlcmV1bSwKICAgICAgICB1aW50MjU2IHRva2Vuc01pbnRlZCwKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgcmVmZXJyZWRCeQogICAgKTsKICAgIAogICAgZXZlbnQgb25Ub2tlblNlbGwoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIGN1c3RvbWVyQWRkcmVzcywKICAgICAgICB1aW50MjU2IHRva2Vuc0J1cm5lZCwKICAgICAgICB1aW50MjU2IGV0aGVyZXVtRWFybmVkCiAgICApOwogICAgCiAgICBldmVudCBvblJlaW52ZXN0bWVudCgKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgY3VzdG9tZXJBZGRyZXNzLAogICAgICAgIHVpbnQyNTYgZXRoZXJldW1SZWludmVzdGVkLAogICAgICAgIHVpbnQyNTYgdG9rZW5zTWludGVkCiAgICApOwogICAgCiAgICBldmVudCBvbldpdGhkcmF3KAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBjdXN0b21lckFkZHJlc3MsCiAgICAgICAgdWludDI1NiBldGhlcmV1bVdpdGhkcmF3bgogICAgKTsKICAgIAogICAgLy8gRVJDMjAKICAgIGV2ZW50IFRyYW5zZmVyKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBmcm9tLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCB0bywKICAgICAgICB1aW50MjU2IHRva2VucwogICAgKTsKICAgIAogICAgCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgID0gICAgICAgICAgICBDT05GSUdVUkFCTEVTICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgICBzdHJpbmcgcHVibGljIG5hbWUgPSAiUE9PSCI7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbCA9ICJQT09IIjsKICAgIHVpbnQ4IGNvbnN0YW50IHB1YmxpYyBkZWNpbWFscyA9IDE4OwogICAgdWludDggY29uc3RhbnQgaW50ZXJuYWwgZGl2aWRlbmRGZWVfID0gMTA7CiAgICB1aW50MjU2IGNvbnN0YW50IGludGVybmFsIHRva2VuUHJpY2VJbml0aWFsXyA9IDAuMDAwMDAwMSBldGhlcjsKICAgIHVpbnQyNTYgY29uc3RhbnQgaW50ZXJuYWwgdG9rZW5QcmljZUluY3JlbWVudGFsXyA9IDAuMDAwMDAwMDEgZXRoZXI7CiAgICB1aW50MjU2IGNvbnN0YW50IGludGVybmFsIG1hZ25pdHVkZSA9IDIqKjY0OwogICAgCiAgICAvLyBwcm9vZiBvZiBzdGFrZSAoZGVmYXVsdHMgYXQgMTAwIHRva2VucykKICAgIHVpbnQyNTYgcHVibGljIHN0YWtpbmdSZXF1aXJlbWVudCA9IDVlMTg7CiAgICAKICAgIC8vIGFtYmFzc2Fkb3IgcHJvZ3JhbQogICAgbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIGludGVybmFsIGFtYmFzc2Fkb3JzXzsKICAgIHVpbnQyNTYgY29uc3RhbnQgaW50ZXJuYWwgYW1iYXNzYWRvck1heFB1cmNoYXNlXyA9IDIgZXRoZXI7CiAgICB1aW50MjU2IGNvbnN0YW50IGludGVybmFsIGFtYmFzc2Fkb3JRdW90YV8gPSAzIGV0aGVyOwogICAgCiAgICAKICAgIAogICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICA9ICAgICAgICAgICAgREFUQVNFVFMgICAgICAgICAgICA9CiAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgICAvLyBhbW91bnQgb2Ygc2hhcmVzIGZvciBlYWNoIGFkZHJlc3MgKHNjYWxlZCBudW1iZXIpCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgaW50ZXJuYWwgdG9rZW5CYWxhbmNlTGVkZ2VyXzsKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBpbnRlcm5hbCByZWZlcnJhbEJhbGFuY2VfOwogICAgbWFwcGluZyhhZGRyZXNzID0+IGludDI1NikgaW50ZXJuYWwgcGF5b3V0c1RvXzsKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBpbnRlcm5hbCBhbWJhc3NhZG9yQWNjdW11bGF0ZWRRdW90YV87CiAgICB1aW50MjU2IGludGVybmFsIHRva2VuU3VwcGx5XyA9IDA7CiAgICB1aW50MjU2IGludGVybmFsIHByb2ZpdFBlclNoYXJlXzsKICAgIAogICAgLy8gYWRtaW5pc3RyYXRvciBsaXN0IChzZWUgYWJvdmUgb24gd2hhdCB0aGV5IGNhbiBkbykKICAgIG1hcHBpbmcoYnl0ZXMzMiA9PiBib29sKSBwdWJsaWMgYWRtaW5pc3RyYXRvcnM7CiAgICAKICAgIC8vIHdoZW4gdGhpcyBpcyBzZXQgdG8gdHJ1ZSwgb25seSBhbWJhc3NhZG9ycyBjYW4gcHVyY2hhc2UgdG9rZW5zICh0aGlzIHByZXZlbnRzIGEgd2hhbGUgcHJlbWluZSwgaXQgZW5zdXJlcyBhIGZhaXJseSBkaXN0cmlidXRlZCB1cHBlciBweXJhbWlkKQogICAgYm9vbCBwdWJsaWMgb25seUFtYmFzc2Fkb3JzID0gdHJ1ZTsKICAgIAoKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgPSAgICAgICAgICAgIFBVQkxJQyBGVU5DVElPTlMgICAgICAgICAgICA9CiAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgLyoKICAgICogLS0gQVBQTElDQVRJT04gRU5UUlkgUE9JTlRTIC0tICAKICAgICovCiAgICBmdW5jdGlvbiBQT09IKCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICAvLyBhZGQgYWRtaW5pc3RyYXRvcnMgaGVyZQogICAgICAgIC8vZnVjayBhZG1pbiEgRHJpdmUgaXQgbGlrZSB5b3Ugc3RvbGUgaXQhCiAgICAgICAgYWRtaW5pc3RyYXRvcnNbMHhjZDkzMzQ1MzMyZGNhY2NmMGI1YjE5ZGIxNzE0ZWU4MzI2NTU2NmQ3NjA2MDI5NGQ2NTk1NmFjNzhjMTM0ODgyXSA9IHRydWU7IC8vSwoKICAgICAgICAvLyBhZGQgdGhlIGFtYmFzc2Fkb3JzIGhlcmUuIAogICAgICAgIGFtYmFzc2Fkb3JzX1sweDdlNDc0ZmU1Q2ZiNzIwODA0ODYwMjE1ZjQwNzExMTE4M2NiYzJmODVdID0gdHJ1ZTsgLy9LCiAgICAgICAgYW1iYXNzYWRvcnNfWzB4ODdBN2U3MUQxNDUxODdlRTlhQWRjODY5NTRkMzljZjBlOTQ0Njc1MV0gPSB0cnVlOyAvL0oKICAgICAgICBhbWJhc3NhZG9yc19bMHhlNDBEMjllZjJkN2E1NzhlNzBCNzVEMDU3Qzc4YzYwRGM5NWZDYjQ3XSA9IHRydWU7IC8vTQogICAgICAgIGFtYmFzc2Fkb3JzX1sweDUxMzgyNDBFOTYzNjBhZDY0MDEwQzI3ZUIwYzY4NUE4YjJlREU0RjJdID0gdHJ1ZTsgLy9CCiAgICAgICAgYW1iYXNzYWRvcnNfWzB4MzVGMTAxQjlGMjNkQjY3M0I3RmRBMDY2RjFhZTg2QzE0ZUJFZjg1RF0gPSB0cnVlOyAvL0oKCiAgICB9CiAgICAKICAgICAKICAgIC8qKgogICAgICogQ29udmVydHMgYWxsIGluY29taW5nIGV0aGVyZXVtIHRvIHRva2VucyBmb3IgdGhlIGNhbGxlciwgYW5kIHBhc3NlcyBkb3duIHRoZSByZWZlcnJhbCBhZGR5IChpZiBhbnkpCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJ1eShhZGRyZXNzIF9yZWZlcnJlZEJ5KQogICAgICAgIHB1YmxpYwogICAgICAgIHBheWFibGUKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgcHVyY2hhc2VUb2tlbnMobXNnLnZhbHVlLCBfcmVmZXJyZWRCeSk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogRmFsbGJhY2sgZnVuY3Rpb24gdG8gaGFuZGxlIGV0aGVyZXVtIHRoYXQgd2FzIHNlbmQgc3RyYWlnaHQgdG8gdGhlIGNvbnRyYWN0CiAgICAgKiBVbmZvcnR1bmF0ZWx5IHdlIGNhbm5vdCB1c2UgYSByZWZlcnJhbCBhZGRyZXNzIHRoaXMgd2F5LgogICAgICovCiAgICBmdW5jdGlvbigpCiAgICAgICAgcGF5YWJsZQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIHB1cmNoYXNlVG9rZW5zKG1zZy52YWx1ZSwgMHgwKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBDb252ZXJ0cyBhbGwgb2YgY2FsbGVyJ3MgZGl2aWRlbmRzIHRvIHRva2Vucy4KICAgICAqLwogICAgZnVuY3Rpb24gcmVpbnZlc3QoKQogICAgICAgIG9ubHlTdHJvbmdoYW5kcygpCiAgICAgICAgcHVibGljCiAgICB7CiAgICAgICAgLy8gZmV0Y2ggZGl2aWRlbmRzCiAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gbXlEaXZpZGVuZHMoZmFsc2UpOyAvLyByZXRyaWV2ZSByZWYuIGJvbnVzIGxhdGVyIGluIHRoZSBjb2RlCiAgICAgICAgCiAgICAgICAgLy8gcGF5IG91dCB0aGUgZGl2aWRlbmRzIHZpcnR1YWxseQogICAgICAgIGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgcGF5b3V0c1RvX1tfY3VzdG9tZXJBZGRyZXNzXSArPSAgKGludDI1NikgKF9kaXZpZGVuZHMgKiBtYWduaXR1ZGUpOwogICAgICAgIAogICAgICAgIC8vIHJldHJpZXZlIHJlZi4gYm9udXMKICAgICAgICBfZGl2aWRlbmRzICs9IHJlZmVycmFsQmFsYW5jZV9bX2N1c3RvbWVyQWRkcmVzc107CiAgICAgICAgcmVmZXJyYWxCYWxhbmNlX1tfY3VzdG9tZXJBZGRyZXNzXSA9IDA7CiAgICAgICAgCiAgICAgICAgLy8gZGlzcGF0Y2ggYSBidXkgb3JkZXIgd2l0aCB0aGUgdmlydHVhbGl6ZWQgIndpdGhkcmF3biBkaXZpZGVuZHMiCiAgICAgICAgdWludDI1NiBfdG9rZW5zID0gcHVyY2hhc2VUb2tlbnMoX2RpdmlkZW5kcywgMHgwKTsKICAgICAgICAKICAgICAgICAvLyBmaXJlIGV2ZW50CiAgICAgICAgb25SZWludmVzdG1lbnQoX2N1c3RvbWVyQWRkcmVzcywgX2RpdmlkZW5kcywgX3Rva2Vucyk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogQWxpYXMgb2Ygc2VsbCgpIGFuZCB3aXRoZHJhdygpLgogICAgICovCiAgICBmdW5jdGlvbiBleGl0KCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICAvLyBnZXQgdG9rZW4gY291bnQgZm9yIGNhbGxlciAmIHNlbGwgdGhlbSBhbGwKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIHVpbnQyNTYgX3Rva2VucyA9IHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc107CiAgICAgICAgaWYoX3Rva2VucyA+IDApIHNlbGwoX3Rva2Vucyk7CiAgICAgICAgCiAgICAgICAgLy8gbGFtYm8gZGVsaXZlcnkgc2VydmljZQogICAgICAgIHdpdGhkcmF3KCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaXRoZHJhd3MgYWxsIG9mIHRoZSBjYWxsZXJzIGVhcm5pbmdzLgogICAgICovCiAgICBmdW5jdGlvbiB3aXRoZHJhdygpCiAgICAgICAgb25seVN0cm9uZ2hhbmRzKCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICAvLyBzZXR1cCBkYXRhCiAgICAgICAgYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICB1aW50MjU2IF9kaXZpZGVuZHMgPSBteURpdmlkZW5kcyhmYWxzZSk7IC8vIGdldCByZWYuIGJvbnVzIGxhdGVyIGluIHRoZSBjb2RlCiAgICAgICAgCiAgICAgICAgLy8gdXBkYXRlIGRpdmlkZW5kIHRyYWNrZXIKICAgICAgICBwYXlvdXRzVG9fW19jdXN0b21lckFkZHJlc3NdICs9ICAoaW50MjU2KSAoX2RpdmlkZW5kcyAqIG1hZ25pdHVkZSk7CiAgICAgICAgCiAgICAgICAgLy8gYWRkIHJlZi4gYm9udXMKICAgICAgICBfZGl2aWRlbmRzICs9IHJlZmVycmFsQmFsYW5jZV9bX2N1c3RvbWVyQWRkcmVzc107CiAgICAgICAgcmVmZXJyYWxCYWxhbmNlX1tfY3VzdG9tZXJBZGRyZXNzXSA9IDA7CiAgICAgICAgCiAgICAgICAgLy8gbGFtYm8gZGVsaXZlcnkgc2VydmljZQogICAgICAgIF9jdXN0b21lckFkZHJlc3MudHJhbnNmZXIoX2RpdmlkZW5kcyk7CiAgICAgICAgCiAgICAgICAgLy8gZmlyZSBldmVudAogICAgICAgIG9uV2l0aGRyYXcoX2N1c3RvbWVyQWRkcmVzcywgX2RpdmlkZW5kcyk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogTGlxdWlmaWVzIHRva2VucyB0byBldGhlcmV1bS4KICAgICAqLwogICAgZnVuY3Rpb24gc2VsbCh1aW50MjU2IF9hbW91bnRPZlRva2VucykKICAgICAgICBvbmx5QmFnaG9sZGVycygpCiAgICAgICAgcHVibGljCiAgICB7CiAgICAgICAgLy8gc2V0dXAgZGF0YQogICAgICAgIGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgLy8gcnVzc2lhbiBoYWNrZXJzIEJURk8KICAgICAgICByZXF1aXJlKF9hbW91bnRPZlRva2VucyA8PSB0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdKTsKICAgICAgICB1aW50MjU2IF90b2tlbnMgPSBfYW1vdW50T2ZUb2tlbnM7CiAgICAgICAgdWludDI1NiBfZXRoZXJldW0gPSB0b2tlbnNUb0V0aGVyZXVtXyhfdG9rZW5zKTsKICAgICAgICB1aW50MjU2IF9kaXZpZGVuZHMgPSBTYWZlTWF0aC5kaXYoX2V0aGVyZXVtLCBkaXZpZGVuZEZlZV8pOwogICAgICAgIHVpbnQyNTYgX3RheGVkRXRoZXJldW0gPSBTYWZlTWF0aC5zdWIoX2V0aGVyZXVtLCBfZGl2aWRlbmRzKTsKICAgICAgICAKICAgICAgICAvLyBidXJuIHRoZSBzb2xkIHRva2VucwogICAgICAgIHRva2VuU3VwcGx5XyA9IFNhZmVNYXRoLnN1Yih0b2tlblN1cHBseV8sIF90b2tlbnMpOwogICAgICAgIHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc10gPSBTYWZlTWF0aC5zdWIodG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSwgX3Rva2Vucyk7CiAgICAgICAgCiAgICAgICAgLy8gdXBkYXRlIGRpdmlkZW5kcyB0cmFja2VyCiAgICAgICAgaW50MjU2IF91cGRhdGVkUGF5b3V0cyA9IChpbnQyNTYpIChwcm9maXRQZXJTaGFyZV8gKiBfdG9rZW5zICsgKF90YXhlZEV0aGVyZXVtICogbWFnbml0dWRlKSk7CiAgICAgICAgcGF5b3V0c1RvX1tfY3VzdG9tZXJBZGRyZXNzXSAtPSBfdXBkYXRlZFBheW91dHM7ICAgICAgIAogICAgICAgIAogICAgICAgIC8vIGRpdmlkaW5nIGJ5IHplcm8gaXMgYSBiYWQgaWRlYQogICAgICAgIGlmICh0b2tlblN1cHBseV8gPiAwKSB7CiAgICAgICAgICAgIC8vIHVwZGF0ZSB0aGUgYW1vdW50IG9mIGRpdmlkZW5kcyBwZXIgdG9rZW4KICAgICAgICAgICAgcHJvZml0UGVyU2hhcmVfID0gU2FmZU1hdGguYWRkKHByb2ZpdFBlclNoYXJlXywgKF9kaXZpZGVuZHMgKiBtYWduaXR1ZGUpIC8gdG9rZW5TdXBwbHlfKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gZmlyZSBldmVudAogICAgICAgIG9uVG9rZW5TZWxsKF9jdXN0b21lckFkZHJlc3MsIF90b2tlbnMsIF90YXhlZEV0aGVyZXVtKTsKICAgIH0KICAgIAogICAgCiAgICAvKioKICAgICAqIFRyYW5zZmVyIHRva2VucyBmcm9tIHRoZSBjYWxsZXIgdG8gYSBuZXcgaG9sZGVyLgogICAgICogUmVtZW1iZXIsIHRoZXJlJ3MgYSAxMCUgZmVlIGhlcmUgYXMgd2VsbC4KICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG9BZGRyZXNzLCB1aW50MjU2IF9hbW91bnRPZlRva2VucykKICAgICAgICBvbmx5QmFnaG9sZGVycygpCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyhib29sKQogICAgewogICAgICAgIC8vIHNldHVwCiAgICAgICAgYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICAKICAgICAgICAvLyBtYWtlIHN1cmUgd2UgaGF2ZSB0aGUgcmVxdWVzdGVkIHRva2VucwogICAgICAgIC8vIGFsc28gZGlzYWJsZXMgdHJhbnNmZXJzIHVudGlsIGFtYmFzc2Fkb3IgcGhhc2UgaXMgb3ZlcgogICAgICAgIC8vICggd2UgZG9udCB3YW50IHdoYWxlIHByZW1pbmVzICkKICAgICAgICByZXF1aXJlKCFvbmx5QW1iYXNzYWRvcnMgJiYgX2Ftb3VudE9mVG9rZW5zIDw9IHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc10pOwogICAgICAgIAogICAgICAgIC8vIHdpdGhkcmF3IGFsbCBvdXRzdGFuZGluZyBkaXZpZGVuZHMgZmlyc3QKICAgICAgICBpZihteURpdmlkZW5kcyh0cnVlKSA+IDApIHdpdGhkcmF3KCk7CiAgICAgICAgCiAgICAgICAgLy8gbGlxdWlmeSAxMCUgb2YgdGhlIHRva2VucyB0aGF0IGFyZSB0cmFuc2ZlcmVkCiAgICAgICAgLy8gdGhlc2UgYXJlIGRpc3BlcnNlZCB0byBzaGFyZWhvbGRlcnMKICAgICAgICB1aW50MjU2IF90b2tlbkZlZSA9IFNhZmVNYXRoLmRpdihfYW1vdW50T2ZUb2tlbnMsIGRpdmlkZW5kRmVlXyk7CiAgICAgICAgdWludDI1NiBfdGF4ZWRUb2tlbnMgPSBTYWZlTWF0aC5zdWIoX2Ftb3VudE9mVG9rZW5zLCBfdG9rZW5GZWUpOwogICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IHRva2Vuc1RvRXRoZXJldW1fKF90b2tlbkZlZSk7CiAgCiAgICAgICAgLy8gYnVybiB0aGUgZmVlIHRva2VucwogICAgICAgIHRva2VuU3VwcGx5XyA9IFNhZmVNYXRoLnN1Yih0b2tlblN1cHBseV8sIF90b2tlbkZlZSk7CgogICAgICAgIC8vIGV4Y2hhbmdlIHRva2VucwogICAgICAgIHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc10gPSBTYWZlTWF0aC5zdWIodG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSwgX2Ftb3VudE9mVG9rZW5zKTsKICAgICAgICB0b2tlbkJhbGFuY2VMZWRnZXJfW190b0FkZHJlc3NdID0gU2FmZU1hdGguYWRkKHRva2VuQmFsYW5jZUxlZGdlcl9bX3RvQWRkcmVzc10sIF90YXhlZFRva2Vucyk7CiAgICAgICAgCiAgICAgICAgLy8gdXBkYXRlIGRpdmlkZW5kIHRyYWNrZXJzCiAgICAgICAgcGF5b3V0c1RvX1tfY3VzdG9tZXJBZGRyZXNzXSAtPSAoaW50MjU2KSAocHJvZml0UGVyU2hhcmVfICogX2Ftb3VudE9mVG9rZW5zKTsKICAgICAgICBwYXlvdXRzVG9fW190b0FkZHJlc3NdICs9IChpbnQyNTYpIChwcm9maXRQZXJTaGFyZV8gKiBfdGF4ZWRUb2tlbnMpOwogICAgICAgIAogICAgICAgIC8vIGRpc3BlcnNlIGRpdmlkZW5kcyBhbW9uZyBob2xkZXJzCiAgICAgICAgcHJvZml0UGVyU2hhcmVfID0gU2FmZU1hdGguYWRkKHByb2ZpdFBlclNoYXJlXywgKF9kaXZpZGVuZHMgKiBtYWduaXR1ZGUpIC8gdG9rZW5TdXBwbHlfKTsKICAgICAgICAKICAgICAgICAvLyBmaXJlIGV2ZW50CiAgICAgICAgVHJhbnNmZXIoX2N1c3RvbWVyQWRkcmVzcywgX3RvQWRkcmVzcywgX3RheGVkVG9rZW5zKTsKICAgICAgICAKICAgICAgICAvLyBFUkMyMAogICAgICAgIHJldHVybiB0cnVlOwogICAgICAgCiAgICB9CiAgICAKICAgIC8qLS0tLS0tLS0tLSAgQURNSU5JU1RSQVRPUiBPTkxZIEZVTkNUSU9OUyAgLS0tLS0tLS0tLSovCiAgICAvKioKICAgICAqIEluIGNhc2UgdGhlIGFtYXNzYWRvciBxdW90YSBpcyBub3QgbWV0LCB0aGUgYWRtaW5pc3RyYXRvciBjYW4gbWFudWFsbHkgZGlzYWJsZSB0aGUgYW1iYXNzYWRvciBwaGFzZS4KICAgICAqLwogICAgZnVuY3Rpb24gZGlzYWJsZUluaXRpYWxTdGFnZSgpCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIG9ubHlBbWJhc3NhZG9ycyA9IGZhbHNlOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEluIGNhc2Ugb25lIG9mIHVzIGRpZXMsIHdlIG5lZWQgdG8gcmVwbGFjZSBvdXJzZWx2ZXMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldEFkbWluaXN0cmF0b3IoYnl0ZXMzMiBfaWRlbnRpZmllciwgYm9vbCBfc3RhdHVzKQogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yKCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICBhZG1pbmlzdHJhdG9yc1tfaWRlbnRpZmllcl0gPSBfc3RhdHVzOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFByZWNhdXRpb25hcnkgbWVhc3VyZXMgaW4gY2FzZSB3ZSBuZWVkIHRvIGFkanVzdCB0aGUgbWFzdGVybm9kZSByYXRlLgogICAgICovCiAgICBmdW5jdGlvbiBzZXRTdGFraW5nUmVxdWlyZW1lbnQodWludDI1NiBfYW1vdW50T2ZUb2tlbnMpCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIHN0YWtpbmdSZXF1aXJlbWVudCA9IF9hbW91bnRPZlRva2VuczsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBJZiB3ZSB3YW50IHRvIHJlYnJhbmQsIHdlIGNhbi4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0TmFtZShzdHJpbmcgX25hbWUpCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIG5hbWUgPSBfbmFtZTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBJZiB3ZSB3YW50IHRvIHJlYnJhbmQsIHdlIGNhbi4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0U3ltYm9sKHN0cmluZyBfc3ltYm9sKQogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yKCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICBzeW1ib2wgPSBfc3ltYm9sOwogICAgfQoKICAgIAogICAgLyotLS0tLS0tLS0tICBIRUxQRVJTIEFORCBDQUxDVUxBVE9SUyAgLS0tLS0tLS0tLSovCiAgICAvKioKICAgICAqIE1ldGhvZCB0byB2aWV3IHRoZSBjdXJyZW50IEV0aGVyZXVtIHN0b3JlZCBpbiB0aGUgY29udHJhY3QKICAgICAqIEV4YW1wbGU6IHRvdGFsRXRoZXJldW1CYWxhbmNlKCkKICAgICAqLwogICAgZnVuY3Rpb24gdG90YWxFdGhlcmV1bUJhbGFuY2UoKQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zKHVpbnQpCiAgICB7CiAgICAgICAgcmV0dXJuIGFkZHJlc3MgKHRoaXMpLmJhbGFuY2U7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogUmV0cmlldmUgdGhlIHRvdGFsIHRva2VuIHN1cHBseS4KICAgICAqLwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgcmV0dXJuIHRva2VuU3VwcGx5XzsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBSZXRyaWV2ZSB0aGUgdG9rZW5zIG93bmVkIGJ5IHRoZSBjYWxsZXIuCiAgICAgKi8KICAgIGZ1bmN0aW9uIG15VG9rZW5zKCkKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VPZihfY3VzdG9tZXJBZGRyZXNzKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBSZXRyaWV2ZSB0aGUgZGl2aWRlbmRzIG93bmVkIGJ5IHRoZSBjYWxsZXIuCiAgICAgKiBJZiBgX2luY2x1ZGVSZWZlcnJhbEJvbnVzYCBpcyB0byB0byAxL3RydWUsIHRoZSByZWZlcnJhbCBib251cyB3aWxsIGJlIGluY2x1ZGVkIGluIHRoZSBjYWxjdWxhdGlvbnMuCiAgICAgKiBUaGUgcmVhc29uIGZvciB0aGlzLCBpcyB0aGF0IGluIHRoZSBmcm9udGVuZCwgd2Ugd2lsbCB3YW50IHRvIGdldCB0aGUgdG90YWwgZGl2cyAoZ2xvYmFsICsgcmVmKQogICAgICogQnV0IGluIHRoZSBpbnRlcm5hbCBjYWxjdWxhdGlvbnMsIHdlIHdhbnQgdGhlbSBzZXBhcmF0ZS4gCiAgICAgKi8gCiAgICBmdW5jdGlvbiBteURpdmlkZW5kcyhib29sIF9pbmNsdWRlUmVmZXJyYWxCb251cykgCiAgICAgICAgcHVibGljIAogICAgICAgIHZpZXcgCiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgcmV0dXJuIF9pbmNsdWRlUmVmZXJyYWxCb251cyA/IGRpdmlkZW5kc09mKF9jdXN0b21lckFkZHJlc3MpICsgcmVmZXJyYWxCYWxhbmNlX1tfY3VzdG9tZXJBZGRyZXNzXSA6IGRpdmlkZW5kc09mKF9jdXN0b21lckFkZHJlc3MpIDsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBSZXRyaWV2ZSB0aGUgdG9rZW4gYmFsYW5jZSBvZiBhbnkgc2luZ2xlIGFkZHJlc3MuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MpCiAgICAgICAgdmlldwogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICByZXR1cm4gdG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBSZXRyaWV2ZSB0aGUgZGl2aWRlbmQgYmFsYW5jZSBvZiBhbnkgc2luZ2xlIGFkZHJlc3MuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGRpdmlkZW5kc09mKGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcykKICAgICAgICB2aWV3CiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIHJldHVybiAodWludDI1NikgKChpbnQyNTYpKHByb2ZpdFBlclNoYXJlXyAqIHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc10pIC0gcGF5b3V0c1RvX1tfY3VzdG9tZXJBZGRyZXNzXSkgLyBtYWduaXR1ZGU7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBidXkgcHJpY2Ugb2YgMSBpbmRpdmlkdWFsIHRva2VuLgogICAgICovCiAgICBmdW5jdGlvbiBzZWxsUHJpY2UoKSAKICAgICAgICBwdWJsaWMgCiAgICAgICAgdmlldyAKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgLy8gb3VyIGNhbGN1bGF0aW9uIHJlbGllcyBvbiB0aGUgdG9rZW4gc3VwcGx5LCBzbyB3ZSBuZWVkIHN1cHBseS4gRG9oLgogICAgICAgIGlmKHRva2VuU3VwcGx5XyA9PSAwKXsKICAgICAgICAgICAgcmV0dXJuIHRva2VuUHJpY2VJbml0aWFsXyAtIHRva2VuUHJpY2VJbmNyZW1lbnRhbF87CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdWludDI1NiBfZXRoZXJldW0gPSB0b2tlbnNUb0V0aGVyZXVtXygxZTE4KTsKICAgICAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gU2FmZU1hdGguZGl2KF9ldGhlcmV1bSwgZGl2aWRlbmRGZWVfICApOwogICAgICAgICAgICB1aW50MjU2IF90YXhlZEV0aGVyZXVtID0gU2FmZU1hdGguc3ViKF9ldGhlcmV1bSwgX2RpdmlkZW5kcyk7CiAgICAgICAgICAgIHJldHVybiBfdGF4ZWRFdGhlcmV1bTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBzZWxsIHByaWNlIG9mIDEgaW5kaXZpZHVhbCB0b2tlbi4KICAgICAqLwogICAgZnVuY3Rpb24gYnV5UHJpY2UoKSAKICAgICAgICBwdWJsaWMgCiAgICAgICAgdmlldyAKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgLy8gb3VyIGNhbGN1bGF0aW9uIHJlbGllcyBvbiB0aGUgdG9rZW4gc3VwcGx5LCBzbyB3ZSBuZWVkIHN1cHBseS4gRG9oLgogICAgICAgIGlmKHRva2VuU3VwcGx5XyA9PSAwKXsKICAgICAgICAgICAgcmV0dXJuIHRva2VuUHJpY2VJbml0aWFsXyArIHRva2VuUHJpY2VJbmNyZW1lbnRhbF87CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdWludDI1NiBfZXRoZXJldW0gPSB0b2tlbnNUb0V0aGVyZXVtXygxZTE4KTsKICAgICAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gU2FmZU1hdGguZGl2KF9ldGhlcmV1bSwgZGl2aWRlbmRGZWVfICApOwogICAgICAgICAgICB1aW50MjU2IF90YXhlZEV0aGVyZXVtID0gU2FmZU1hdGguYWRkKF9ldGhlcmV1bSwgX2RpdmlkZW5kcyk7CiAgICAgICAgICAgIHJldHVybiBfdGF4ZWRFdGhlcmV1bTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8qKgogICAgICogRnVuY3Rpb24gZm9yIHRoZSBmcm9udGVuZCB0byBkeW5hbWljYWxseSByZXRyaWV2ZSB0aGUgcHJpY2Ugc2NhbGluZyBvZiBidXkgb3JkZXJzLgogICAgICovCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVUb2tlbnNSZWNlaXZlZCh1aW50MjU2IF9ldGhlcmV1bVRvU3BlbmQpIAogICAgICAgIHB1YmxpYyAKICAgICAgICB2aWV3IAogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICB1aW50MjU2IF9kaXZpZGVuZHMgPSBTYWZlTWF0aC5kaXYoX2V0aGVyZXVtVG9TcGVuZCwgZGl2aWRlbmRGZWVfKTsKICAgICAgICB1aW50MjU2IF90YXhlZEV0aGVyZXVtID0gU2FmZU1hdGguc3ViKF9ldGhlcmV1bVRvU3BlbmQsIF9kaXZpZGVuZHMpOwogICAgICAgIHVpbnQyNTYgX2Ftb3VudE9mVG9rZW5zID0gZXRoZXJldW1Ub1Rva2Vuc18oX3RheGVkRXRoZXJldW0pOwogICAgICAgIAogICAgICAgIHJldHVybiBfYW1vdW50T2ZUb2tlbnM7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogRnVuY3Rpb24gZm9yIHRoZSBmcm9udGVuZCB0byBkeW5hbWljYWxseSByZXRyaWV2ZSB0aGUgcHJpY2Ugc2NhbGluZyBvZiBzZWxsIG9yZGVycy4KICAgICAqLwogICAgZnVuY3Rpb24gY2FsY3VsYXRlRXRoZXJldW1SZWNlaXZlZCh1aW50MjU2IF90b2tlbnNUb1NlbGwpIAogICAgICAgIHB1YmxpYyAKICAgICAgICB2aWV3IAogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICByZXF1aXJlKF90b2tlbnNUb1NlbGwgPD0gdG9rZW5TdXBwbHlfKTsKICAgICAgICB1aW50MjU2IF9ldGhlcmV1bSA9IHRva2Vuc1RvRXRoZXJldW1fKF90b2tlbnNUb1NlbGwpOwogICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IFNhZmVNYXRoLmRpdihfZXRoZXJldW0sIGRpdmlkZW5kRmVlXyk7CiAgICAgICAgdWludDI1NiBfdGF4ZWRFdGhlcmV1bSA9IFNhZmVNYXRoLnN1YihfZXRoZXJldW0sIF9kaXZpZGVuZHMpOwogICAgICAgIHJldHVybiBfdGF4ZWRFdGhlcmV1bTsKICAgIH0KICAgIAogICAgCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgPSAgICAgICAgICAgIElOVEVSTkFMIEZVTkNUSU9OUyAgICAgICAgICAgID0KICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgICBmdW5jdGlvbiBwdXJjaGFzZVRva2Vucyh1aW50MjU2IF9pbmNvbWluZ0V0aGVyZXVtLCBhZGRyZXNzIF9yZWZlcnJlZEJ5KQogICAgICAgIGFudGlFYXJseVdoYWxlKF9pbmNvbWluZ0V0aGVyZXVtKQogICAgICAgIGludGVybmFsCiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIC8vIGRhdGEgc2V0dXAKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIHVpbnQyNTYgX3VuZGl2aWRlZERpdmlkZW5kcyA9IFNhZmVNYXRoLmRpdihfaW5jb21pbmdFdGhlcmV1bSwgZGl2aWRlbmRGZWVfKTsKICAgICAgICB1aW50MjU2IF9yZWZlcnJhbEJvbnVzID0gU2FmZU1hdGguZGl2KF91bmRpdmlkZWREaXZpZGVuZHMsIDMpOwogICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IFNhZmVNYXRoLnN1YihfdW5kaXZpZGVkRGl2aWRlbmRzLCBfcmVmZXJyYWxCb251cyk7CiAgICAgICAgdWludDI1NiBfdGF4ZWRFdGhlcmV1bSA9IFNhZmVNYXRoLnN1YihfaW5jb21pbmdFdGhlcmV1bSwgX3VuZGl2aWRlZERpdmlkZW5kcyk7CiAgICAgICAgdWludDI1NiBfYW1vdW50T2ZUb2tlbnMgPSBldGhlcmV1bVRvVG9rZW5zXyhfdGF4ZWRFdGhlcmV1bSk7CiAgICAgICAgdWludDI1NiBfZmVlID0gX2RpdmlkZW5kcyAqIG1hZ25pdHVkZTsKIAogICAgICAgIC8vIG5vIHBvaW50IGluIGNvbnRpbnVpbmcgZXhlY3V0aW9uIGlmIE9QIGlzIGEgcG9vcmZhZyBydXNzaWFuIGhhY2tlcgogICAgICAgIC8vIHByZXZlbnRzIG92ZXJmbG93IGluIHRoZSBjYXNlIHRoYXQgdGhlIHB5cmFtaWQgc29tZWhvdyBtYWdpY2FsbHkgc3RhcnRzIGJlaW5nIHVzZWQgYnkgZXZlcnlvbmUgaW4gdGhlIHdvcmxkCiAgICAgICAgLy8gKG9yIGhhY2tlcnMpCiAgICAgICAgLy8gYW5kIHllcyB3ZSBrbm93IHRoYXQgdGhlIHNhZmVtYXRoIGZ1bmN0aW9uIGF1dG9tYXRpY2FsbHkgcnVsZXMgb3V0IHRoZSAiZ3JlYXRlciB0aGVuIiBlcXVhc2lvbi4KICAgICAgICByZXF1aXJlKF9hbW91bnRPZlRva2VucyA+IDAgJiYgKFNhZmVNYXRoLmFkZChfYW1vdW50T2ZUb2tlbnMsdG9rZW5TdXBwbHlfKSA+IHRva2VuU3VwcGx5XykpOwogICAgICAgIAogICAgICAgIC8vIGlzIHRoZSB1c2VyIHJlZmVycmVkIGJ5IGEgbWFzdGVybm9kZT8KICAgICAgICBpZigKICAgICAgICAgICAgLy8gaXMgdGhpcyBhIHJlZmVycmVkIHB1cmNoYXNlPwogICAgICAgICAgICBfcmVmZXJyZWRCeSAhPSAweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAgJiYKCiAgICAgICAgICAgIC8vIG5vIGNoZWF0aW5nIQogICAgICAgICAgICBfcmVmZXJyZWRCeSAhPSBfY3VzdG9tZXJBZGRyZXNzICYmCiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBkb2VzIHRoZSByZWZlcnJlciBoYXZlIGF0IGxlYXN0IFggd2hvbGUgdG9rZW5zPwogICAgICAgICAgICAvLyBpLmUgaXMgdGhlIHJlZmVycmVyIGEgZ29kbHkgY2hhZCBtYXN0ZXJub2RlCiAgICAgICAgICAgIHRva2VuQmFsYW5jZUxlZGdlcl9bX3JlZmVycmVkQnldID49IHN0YWtpbmdSZXF1aXJlbWVudAogICAgICAgICl7CiAgICAgICAgICAgIC8vIHdlYWx0aCByZWRpc3RyaWJ1dGlvbgogICAgICAgICAgICByZWZlcnJhbEJhbGFuY2VfW19yZWZlcnJlZEJ5XSA9IFNhZmVNYXRoLmFkZChyZWZlcnJhbEJhbGFuY2VfW19yZWZlcnJlZEJ5XSwgX3JlZmVycmFsQm9udXMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIG5vIHJlZiBwdXJjaGFzZQogICAgICAgICAgICAvLyBhZGQgdGhlIHJlZmVycmFsIGJvbnVzIGJhY2sgdG8gdGhlIGdsb2JhbCBkaXZpZGVuZHMgY2FrZQogICAgICAgICAgICBfZGl2aWRlbmRzID0gU2FmZU1hdGguYWRkKF9kaXZpZGVuZHMsIF9yZWZlcnJhbEJvbnVzKTsKICAgICAgICAgICAgX2ZlZSA9IF9kaXZpZGVuZHMgKiBtYWduaXR1ZGU7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIHdlIGNhbid0IGdpdmUgcGVvcGxlIGluZmluaXRlIGV0aGVyZXVtCiAgICAgICAgaWYodG9rZW5TdXBwbHlfID4gMCl7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBhZGQgdG9rZW5zIHRvIHRoZSBwb29sCiAgICAgICAgICAgIHRva2VuU3VwcGx5XyA9IFNhZmVNYXRoLmFkZCh0b2tlblN1cHBseV8sIF9hbW91bnRPZlRva2Vucyk7CiAKICAgICAgICAgICAgLy8gdGFrZSB0aGUgYW1vdW50IG9mIGRpdmlkZW5kcyBnYWluZWQgdGhyb3VnaCB0aGlzIHRyYW5zYWN0aW9uLCBhbmQgYWxsb2NhdGVzIHRoZW0gZXZlbmx5IHRvIGVhY2ggc2hhcmVob2xkZXIKICAgICAgICAgICAgcHJvZml0UGVyU2hhcmVfICs9IChfZGl2aWRlbmRzICogbWFnbml0dWRlIC8gKHRva2VuU3VwcGx5XykpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gY2FsY3VsYXRlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoZSBjdXN0b21lciByZWNlaXZlcyBvdmVyIGhpcyBwdXJjaGFzZSAKICAgICAgICAgICAgX2ZlZSA9IF9mZWUgLSAoX2ZlZS0oX2Ftb3VudE9mVG9rZW5zICogKF9kaXZpZGVuZHMgKiBtYWduaXR1ZGUgLyAodG9rZW5TdXBwbHlfKSkpKTsKICAgICAgICAKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBhZGQgdG9rZW5zIHRvIHRoZSBwb29sCiAgICAgICAgICAgIHRva2VuU3VwcGx5XyA9IF9hbW91bnRPZlRva2VuczsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gdXBkYXRlIGNpcmN1bGF0aW5nIHN1cHBseSAmIHRoZSBsZWRnZXIgYWRkcmVzcyBmb3IgdGhlIGN1c3RvbWVyCiAgICAgICAgdG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSA9IFNhZmVNYXRoLmFkZCh0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdLCBfYW1vdW50T2ZUb2tlbnMpOwogICAgICAgIAogICAgICAgIC8vIFRlbGxzIHRoZSBjb250cmFjdCB0aGF0IHRoZSBidXllciBkb2Vzbid0IGRlc2VydmUgZGl2aWRlbmRzIGZvciB0aGUgdG9rZW5zIGJlZm9yZSB0aGV5IG93bmVkIHRoZW07CiAgICAgICAgLy9yZWFsbHkgaSBrbm93IHlvdSB0aGluayB5b3UgZG8gYnV0IHlvdSBkb24ndAogICAgICAgIGludDI1NiBfdXBkYXRlZFBheW91dHMgPSAoaW50MjU2KSAoKHByb2ZpdFBlclNoYXJlXyAqIF9hbW91bnRPZlRva2VucykgLSBfZmVlKTsKICAgICAgICBwYXlvdXRzVG9fW19jdXN0b21lckFkZHJlc3NdICs9IF91cGRhdGVkUGF5b3V0czsKICAgICAgICAKICAgICAgICAvLyBmaXJlIGV2ZW50CiAgICAgICAgb25Ub2tlblB1cmNoYXNlKF9jdXN0b21lckFkZHJlc3MsIF9pbmNvbWluZ0V0aGVyZXVtLCBfYW1vdW50T2ZUb2tlbnMsIF9yZWZlcnJlZEJ5KTsKICAgICAgICAKICAgICAgICByZXR1cm4gX2Ftb3VudE9mVG9rZW5zOwogICAgfQoKICAgIC8qKgogICAgICogQ2FsY3VsYXRlIFRva2VuIHByaWNlIGJhc2VkIG9uIGFuIGFtb3VudCBvZiBpbmNvbWluZyBldGhlcmV1bQogICAgICogSXQncyBhbiBhbGdvcml0aG0sIGhvcGVmdWxseSB3ZSBnYXZlIHlvdSB0aGUgd2hpdGVwYXBlciB3aXRoIGl0IGluIHNjaWVudGlmaWMgbm90YXRpb247CiAgICAgKiBTb21lIGNvbnZlcnNpb25zIG9jY3VycmVkIHRvIHByZXZlbnQgZGVjaW1hbCBlcnJvcnMgb3IgdW5kZXJmbG93cyAvIG92ZXJmbG93cyBpbiBzb2xpZGl0eSBjb2RlLgogICAgICovCiAgICBmdW5jdGlvbiBldGhlcmV1bVRvVG9rZW5zXyh1aW50MjU2IF9ldGhlcmV1bSkKICAgICAgICBpbnRlcm5hbAogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgdWludDI1NiBfdG9rZW5QcmljZUluaXRpYWwgPSB0b2tlblByaWNlSW5pdGlhbF8gKiAxZTE4OwogICAgICAgIHVpbnQyNTYgX3Rva2Vuc1JlY2VpdmVkID0gCiAgICAgICAgICgKICAgICAgICAgICAgKAogICAgICAgICAgICAgICAgLy8gdW5kZXJmbG93IGF0dGVtcHRzIEJURk8KICAgICAgICAgICAgICAgIFNhZmVNYXRoLnN1YigKICAgICAgICAgICAgICAgICAgICAoc3FydAogICAgICAgICAgICAgICAgICAgICAgICAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoX3Rva2VuUHJpY2VJbml0aWFsKioyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgKDIqKHRva2VuUHJpY2VJbmNyZW1lbnRhbF8gKiAxZTE4KSooX2V0aGVyZXVtICogMWUxOCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoKCh0b2tlblByaWNlSW5jcmVtZW50YWxfKSoqMikqKHRva2VuU3VwcGx5XyoqMikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoMioodG9rZW5QcmljZUluY3JlbWVudGFsXykqX3Rva2VuUHJpY2VJbml0aWFsKnRva2VuU3VwcGx5XykKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICksIF90b2tlblByaWNlSW5pdGlhbAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApLyh0b2tlblByaWNlSW5jcmVtZW50YWxfKQogICAgICAgICktKHRva2VuU3VwcGx5XykKICAgICAgICA7CiAgCiAgICAgICAgcmV0dXJuIF90b2tlbnNSZWNlaXZlZDsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBDYWxjdWxhdGUgdG9rZW4gc2VsbCB2YWx1ZS4KICAgICAqIEl0J3MgYW4gYWxnb3JpdGhtLCBob3BlZnVsbHkgd2UgZ2F2ZSB5b3UgdGhlIHdoaXRlcGFwZXIgd2l0aCBpdCBpbiBzY2llbnRpZmljIG5vdGF0aW9uOwogICAgICogU29tZSBjb252ZXJzaW9ucyBvY2N1cnJlZCB0byBwcmV2ZW50IGRlY2ltYWwgZXJyb3JzIG9yIHVuZGVyZmxvd3MgLyBvdmVyZmxvd3MgaW4gc29saWRpdHkgY29kZS4KICAgICAqLwogICAgIGZ1bmN0aW9uIHRva2Vuc1RvRXRoZXJldW1fKHVpbnQyNTYgX3Rva2VucykKICAgICAgICBpbnRlcm5hbAogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CgogICAgICAgIHVpbnQyNTYgdG9rZW5zXyA9IChfdG9rZW5zICsgMWUxOCk7CiAgICAgICAgdWludDI1NiBfdG9rZW5TdXBwbHkgPSAodG9rZW5TdXBwbHlfICsgMWUxOCk7CiAgICAgICAgdWludDI1NiBfZXRoZXJSZWNlaXZlZCA9CiAgICAgICAgKAogICAgICAgICAgICAvLyB1bmRlcmZsb3cgYXR0ZW1wdHMgQlRGTwogICAgICAgICAgICBTYWZlTWF0aC5zdWIoCiAgICAgICAgICAgICAgICAoCiAgICAgICAgICAgICAgICAgICAgKAogICAgICAgICAgICAgICAgICAgICAgICAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2tlblByaWNlSW5pdGlhbF8gKyh0b2tlblByaWNlSW5jcmVtZW50YWxfICogKF90b2tlblN1cHBseS8xZTE4KSkKICAgICAgICAgICAgICAgICAgICAgICAgKS10b2tlblByaWNlSW5jcmVtZW50YWxfCiAgICAgICAgICAgICAgICAgICAgKSoodG9rZW5zXyAtIDFlMTgpCiAgICAgICAgICAgICAgICApLCh0b2tlblByaWNlSW5jcmVtZW50YWxfKigodG9rZW5zXyoqMi10b2tlbnNfKS8xZTE4KSkvMgogICAgICAgICAgICApCiAgICAgICAgLzFlMTgpOwogICAgICAgIHJldHVybiBfZXRoZXJSZWNlaXZlZDsKICAgIH0KICAgIAogICAgCiAgICAvL1RoaXMgaXMgd2hlcmUgYWxsIHlvdXIgZ2FzIGdvZXMsIHNvcnJ5CiAgICAvL05vdCBzb3JyeSwgeW91IHByb2JhYmx5IG9ubHkgcGFpZCAxIGd3ZWkKICAgIGZ1bmN0aW9uIHNxcnQodWludCB4KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeSkgewogICAgICAgIHVpbnQgeiA9ICh4ICsgMSkgLyAyOwogICAgICAgIHkgPSB4OwogICAgICAgIHdoaWxlICh6IDwgeSkgewogICAgICAgICAgICB5ID0gejsKICAgICAgICAgICAgeiA9ICh4IC8geiArIHopIC8gMjsKICAgICAgICB9CiAgICB9Cn0KCi8qKgogKiBAdGl0bGUgU2FmZU1hdGgKICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCmxpYnJhcnkgU2FmZU1hdGggewoKICAgIC8qKgogICAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAgICovCiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGlmIChhID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAgICovCiAgICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgU3Vic3RyYWN0cyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93IChpLmUuIGlmIHN1YnRyYWhlbmQgaXMgZ3JlYXRlciB0aGFuIG1pbnVlbmQpLgogICAgKi8KICAgIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgYXNzZXJ0KGIgPD0gYSk7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEFkZHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAgICovCiAgICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgICAgIGFzc2VydChjID49IGEpOwogICAgICAgIHJldHVybiBjOwogICAgfQp9'.
	

]
