Class {
	#name : #SRT880d6adb5bb4c8a7f578d31a4ddb0c48bc590fa3,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT880d6adb5bb4c8a7f578d31a4ddb0c48bc590fa3 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgoKLyoqCiAqCiAqICBTVEVBSyBUT0tFTiAoQk9WKQogKgogKiAgTWFrZSBiYW5rIGJ5IGVhdGluZyBmbGFuay4gU2VlIGh0dHBzOi8vc3RlYWt0b2tlbi5jb20uCiAqCiAqLwoKCi8qKgogKiBAdGl0bGUgU2FmZU1hdGgKICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCiBsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKCgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KIGNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciB7CiAgICBpZiAobmV3T3duZXIgIT0gYWRkcmVzcygwKSkgewogICAgICBvd25lciA9IG5ld093bmVyOwogICAgfQogIH0KCn0KCgoKCmNvbnRyYWN0IFN0ZWFrVG9rZW4gaXMgT3duYWJsZSB7CgogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBzdHJpbmcgcHVibGljIG5hbWUgPSAiU3RlYWsgVG9rZW4iOwogIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIkJPViI7CiAgdWludCBwdWJsaWMgZGVjaW1hbHMgPSAxODsKICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseTsgICAgICAvLyBUb3RhbCBCT1YgaW4gY2lyY3VsYXRpb24uCgogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CgogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lckFkZHJlc3MsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyQWRkcmVzcywgdWludDI1NiB2YWx1ZSk7CiAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKICBldmVudCBNaW5lRmluaXNoZWQoKTsKCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICBpZihtc2cuZGF0YS5sZW5ndGggPCAoMiAqIDMyKSArIDQpIHsgcmV2ZXJ0KCk7IH0gLy8gcHJvdGVjdCBhZ2FpbnN0IHNob3J0IGFkZHJlc3MgYXR0YWNrCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgoKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICB2YXIgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOwoKICAgIC8vIENoZWNrIGlzIG5vdCBuZWVkZWQgYmVjYXVzZSBzdWIoX2FsbG93YW5jZSwgX3ZhbHVlKSB3aWxsIGFscmVhZHkgdGhyb3cgaWYgdGhpcyBjb25kaXRpb24gaXMgbm90IG1ldAogICAgLy8gcmVxdWlyZSAoX3ZhbHVlIDw9IF9hbGxvd2FuY2UpOwoKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBfYWxsb3dhbmNlLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCkgewoKICAgIC8vIFRvIGNoYW5nZSB0aGUgYXBwcm92ZSBhbW91bnQgeW91IGZpcnN0IGhhdmUgdG8gcmVkdWNlIHRoZSBhZGRyZXNzZXNgCiAgICAvLyAgYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyBgYXBwcm92ZShfc3BlbmRlciwgMClgIGlmIGl0IGlzIG5vdAogICAgLy8gIGFscmVhZHkgMCB0byBtaXRpZ2F0ZSB0aGUgcmFjZSBjb25kaXRpb24gZGVzY3JpYmVkIGhlcmU6CiAgICAvLyAgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgIHJlcXVpcmUoKF92YWx1ZSA9PSAwKSB8fCAoYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPT0gMCkpOwoKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmaW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CgogICAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBtaW50IHRva2VucwogICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2lldmUgdGhlIG1pbnRlZCB0b2tlbnMuCiAgICogQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gbWludC4KICAgKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIGludGVybmFsIHJldHVybnMgKGJvb2wpIHsKICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKF9hbW91bnQpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF9hbW91bnQpOwogICAgTWludChfdG8sIF9hbW91bnQpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKCn0KCgoKCgoKCgovKioKICogQHRpdGxlIEF1Y3Rpb25Dcm93ZHNhbGUgCiAqIEBkZXYgVGhlIG93bmVyIHN0YXJ0cyBhbmQgZW5kcyB0aGUgY3Jvd2RzYWxlIG1hbnVhbGx5LgogKiBQbGF5ZXJzIGNhbiBtYWtlIHRva2VuIHB1cmNoYXNlcyBkdXJpbmcgdGhlIGNyb3dkc2FsZQogKiBhbmQgdGhlaXIgdG9rZW5zIGNhbiBiZSBjbGFpbWVkIGFmdGVyIHRoZSBzYWxlIGVuZHMuCiAqIFBsYXllcnMgcmVjZWl2ZSBhbiBhbW91bnQgcHJvcG9ydGlvbmFsIHRvIHRoZWlyIGludmVzdG1lbnQuCiAqLwogY29udHJhY3QgQXVjdGlvbkNyb3dkc2FsZSBpcyBTdGVha1Rva2VuIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKCiAgdWludCBwdWJsaWMgaW5pdGlhbFNhbGU7ICAgICAgICAgICAgICAgICAgLy8gQW1vdW50IG9mIEJPViB0b2tlbnMgYmVpbmcgc29sZCBkdXJpbmcgY3Jvd2RzYWxlLgoKICBib29sIHB1YmxpYyBzYWxlU3RhcnRlZDsKICBib29sIHB1YmxpYyBzYWxlRW5kZWQ7CgogIHVpbnQgcHVibGljIGFic29sdXRlRW5kQmxvY2s7ICAgICAgICAgICAgIC8vIEFueWJvZHkgY2FuIGVuZCB0aGUgY3Jvd2RzYWxlIGFuZCB0cmlnZ2VyIHRva2VuIGRpc3RyaWJ1dGlvbiBpZiBiZXlvbmQgdGhpcyBibG9jayBudW1iZXIuCgogIHVpbnQyNTYgcHVibGljIHdlaVJhaXNlZDsgICAgICAgICAgICAgICAgIC8vIFRvdGFsIGFtb3VudCByYWlzZWQgaW4gY3Jvd2RzYWxlLgoKICBhZGRyZXNzW10gcHVibGljIGludmVzdG9yczsgICAgICAgICAgICAgICAvLyBJbnZlc3RvciBhZGRyZXNzZXMKICB1aW50IHB1YmxpYyBudW1iZXJPZkludmVzdG9yczsKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGludmVzdG1lbnRzOyAvLyBIb3cgbXVjaCBlYWNoIGFkZHJlc3MgaGFzIGludmVzdGVkLgoKICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIGNsYWltZWQ7ICAgICAgLy8gS2VlcCB0cmFjayBvZiB3aGV0aGVyIGVhY2ggaW52ZXN0b3IgaGFzIGJlZW4gYXdhcmRlZCB0aGVpciBCT1YgdG9rZW5zLgoKCiAgYm9vbCBwdWJsaWMgYm92QmF0Y2hEaXN0cmlidXRlZDsgICAgICAgICAgICAgIC8vIFRPRE86IHRoaXMgY2FuIGJlIHJlbW92ZWQgd2l0aCBtYW51YWwgY3Jvd2RzYWxlIGVuZC10aW1lCgogIHVpbnQgcHVibGljIGluaXRpYWxQcml6ZVdlaVZhbHVlOyAgICAgICAgICAgICAvLyBUaGUgZmlyc3Qgc3RlYWtzIG1pbmVkIHdpbGwgYmUgYXdhcmRlZCBCT1YgZXF1aXZhbGVudCB0byB0aGlzIEVUSCB2YWx1ZS4gU2V0IGluIFN0ZWFrKCkgaW5pdGlhbGl6ZXIuCiAgdWludCBwdWJsaWMgaW5pdGlhbFByaXplQm92OyAgICAgICAgICAgICAgICAgIC8vIEluaXRpYWwgbWluaW5nIHByaXplIGluIEJPViB1bml0cy4gU2V0IGluIGVuZENyb3dkc2FsZSgpIG9yIGVuZENyb3dkc2FsZVB1YmxpYygpLgoKICB1aW50IHB1YmxpYyBkYWlseUhhc2hFeHBpcmVzOyAgICAgICAgLy8gV2hlbiB0aGUgZGFpbHlIYXNoIGV4cGlyZXMuIFdpbGwgYmUgcm91Z2hseSBhcm91bmQgM2FtIEVTVC4KCgoKCgogIC8qKgogICAqIGV2ZW50IGZvciB0b2tlbiBwdXJjaGFzZSBsb2dnaW5nCiAgICogQHBhcmFtIHB1cmNoYXNlciB3aG8gcGFpZCBmb3IgdGhlIHRva2VucwogICAqIEBwYXJhbSBiZW5lZmljaWFyeSB3aG8gZ290IHRoZSB0b2tlbnMKICAgKiBAcGFyYW0gdmFsdWUgd2VpcyBwYWlkIGZvciBwdXJjaGFzZQogICAqLyAKICAgZXZlbnQgVG9rZW5JbnZlc3RtZW50KGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB2YWx1ZSk7CgoKCiAgIC8vIFNlbmRpbmcgRVRIIHRvIHRoaXMgY29udHJhY3QncyBhZGRyZXNzIHJlZ2lzdGVycyB0aGUgaW52ZXN0bWVudC4KICAgZnVuY3Rpb24gKCkgcGF5YWJsZSB7CiAgICBpbnZlc3QobXNnLnNlbmRlcik7CiAgfQoKCiAgLy8gUGFydGljaXBhdGUgaW4gdGhlIGNyb3dkc2FsZS4KICAvLyBSZWNvcmRzIGhvdyBtdWNoIGVhY2ggYWRkcmVzcyBoYXMgaW52ZXN0ZWQuCiAgZnVuY3Rpb24gaW52ZXN0KGFkZHJlc3MgYmVuZWZpY2lhcnkpIHBheWFibGUgewogICAgcmVxdWlyZShiZW5lZmljaWFyeSAhPSAweDApOwogICAgcmVxdWlyZSh2YWxpZEludmVzdG1lbnQoKSk7CgogICAgdWludDI1NiB3ZWlBbW91bnQgPSBtc2cudmFsdWU7CgogICAgdWludCBpbnZlc3RlZEFtb3VudCA9IGludmVzdG1lbnRzW2JlbmVmaWNpYXJ5XTsKCiAgICBmb3J3YXJkRnVuZHMoKTsKCiAgICBpZiAoaW52ZXN0ZWRBbW91bnQgPiAwKSB7IC8vIElmIHRoZXkndmUgYWxyZWFkeSBpbnZlc3RlZCwgaW5jcmVhc2UgdGhlaXIgYmFsYW5jZS4KICAgICAgaW52ZXN0bWVudHNbYmVuZWZpY2lhcnldID0gaW52ZXN0ZWRBbW91bnQgKyB3ZWlBbW91bnQ7IC8vIGludmVzdGVkQW1vdW50LmFkZCh3ZWlBbW91bnQpOwogICAgfSBlbHNlIHsgLy8gSWYgbmV3IGludmVzdG9yCiAgICAgIGludmVzdG9ycy5wdXNoKGJlbmVmaWNpYXJ5KTsKICAgICAgbnVtYmVyT2ZJbnZlc3RvcnMgKz0gMTsKICAgICAgaW52ZXN0bWVudHNbYmVuZWZpY2lhcnldID0gd2VpQW1vdW50OwogICAgfQogICAgd2VpUmFpc2VkID0gd2VpUmFpc2VkLmFkZCh3ZWlBbW91bnQpOwogICAgVG9rZW5JbnZlc3RtZW50KG1zZy5zZW5kZXIsIGJlbmVmaWNpYXJ5LCB3ZWlBbW91bnQpOwogIH0KCgoKICAvLyBAcmV0dXJuIHRydWUgaWYgdGhlIHRyYW5zYWN0aW9uIGNhbiBpbnZlc3QKICBmdW5jdGlvbiB2YWxpZEludmVzdG1lbnQoKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICBib29sIHdpdGhpblBlcmlvZCA9IHNhbGVTdGFydGVkICYmICFzYWxlRW5kZWQ7CiAgICBib29sIG5vblplcm9QdXJjaGFzZSA9IChtc2cudmFsdWUgPiAwKTsKICAgIHJldHVybiB3aXRoaW5QZXJpb2QgJiYgbm9uWmVyb1B1cmNoYXNlOwogIH0KCgoKCiAgLy8gRGlzdHJpYnV0ZSAxME0gdG9rZW5zIHByb3BvcnRpb25hbGx5IGFtb25nc3QgYWxsIGludmVzdG9ycy4gQ2FuIGJlIGNhbGxlZCBieSBhbnlvbmUgYWZ0ZXIgdGhlIGNyb3dkc2FsZSBlbmRzLgogIC8vIENsYWltVG9rZW5zKCkgY2FuIGJlIHJ1biBieSBpbmRpdmlkdWFscyB0byBjbGFpbSB0aGVpciB0b2tlbnMuCiAgZnVuY3Rpb24gZGlzdHJpYnV0ZUFsbFRva2VucygpIHB1YmxpYyB7CgogICAgcmVxdWlyZSghYm92QmF0Y2hEaXN0cmlidXRlZCk7CiAgICByZXF1aXJlKGNyb3dkc2FsZUhhc0VuZGVkKCkpOwoKICAgIC8vIEFsbG9jYXRlIEJPViBwcm9wb3J0aW9uYWxseSB0byBlYWNoIGludmVzdG9yLgoKICAgIGZvciAodWludCBpPTA7IGkgPCBudW1iZXJPZkludmVzdG9yczsgaSsrKSB7CiAgICAgIGFkZHJlc3MgaW52ZXN0b3JBZGRyID0gaW52ZXN0b3JzW2ldOwogICAgICBpZiAoIWNsYWltZWRbaW52ZXN0b3JBZGRyXSkgeyAvLyBJZiB0aGUgaW52ZXN0b3IgaGFzbid0IGFscmVhZHkgY2xhaW1lZCB0aGVpciBCT1YuCiAgICAgICAgY2xhaW1lZFtpbnZlc3RvckFkZHJdID0gdHJ1ZTsKICAgICAgICB1aW50IGFtb3VudEludmVzdGVkID0gaW52ZXN0bWVudHNbaW52ZXN0b3JBZGRyXTsKICAgICAgICB1aW50IGJvdkVhcm5lZCA9IGFtb3VudEludmVzdGVkLm11bChpbml0aWFsU2FsZSkuZGl2KHdlaVJhaXNlZCk7CiAgICAgICAgbWludChpbnZlc3RvckFkZHIsIGJvdkVhcm5lZCk7CiAgICAgIH0KICAgIH0KCiAgICBib3ZCYXRjaERpc3RyaWJ1dGVkID0gdHJ1ZTsKICB9CgoKICAvLyBDbGFpbSB5b3VyIEJPVjsgYWxsb2NhdGVzIEJPViBwcm9wb3J0aW9uYWxseSB0byB0aGlzIGludmVzdG9yLgogIC8vIENhbiBiZSBjYWxsZWQgYnkgaW52ZXN0b3JzIHRvIGNsYWltIHRoZWlyIEJPViBhZnRlciB0aGUgY3Jvd2RzYWxlIGVuZHMuCiAgLy8gZGlzdHJpYnV0ZUFsbFRva2VucygpIGlzIGEgYmF0Y2ggYWx0ZXJuYXRpdmUgdG8gdGhpcy4KICBmdW5jdGlvbiBjbGFpbVRva2VucyhhZGRyZXNzIG9yaWdBZGRyZXNzKSBwdWJsaWMgewogICAgcmVxdWlyZShjcm93ZHNhbGVIYXNFbmRlZCgpKTsKICAgIHJlcXVpcmUoY2xhaW1lZFtvcmlnQWRkcmVzc10gPT0gZmFsc2UpOwogICAgdWludCBhbW91bnRJbnZlc3RlZCA9IGludmVzdG1lbnRzW29yaWdBZGRyZXNzXTsKICAgIHVpbnQgYm92RWFybmVkID0gYW1vdW50SW52ZXN0ZWQubXVsKGluaXRpYWxTYWxlKS5kaXYod2VpUmFpc2VkKTsKICAgIGNsYWltZWRbb3JpZ0FkZHJlc3NdID0gdHJ1ZTsKICAgIG1pbnQob3JpZ0FkZHJlc3MsIGJvdkVhcm5lZCk7CiAgfQoKCiAgLy8gSW52ZXN0b3JzOiBzZWUgaG93IG1hbnkgQk9WIHlvdSBhcmUgY3VycmVudGx5IGVudGl0bGVkIHRvIChiZWZvcmUgdGhlIGVuZCBvZiB0aGUgY3Jvd2RzYWxlIGFuZCBkaXN0cmlidXRpb24gb2YgdG9rZW5zKS4KICBmdW5jdGlvbiBnZXRDdXJyZW50U2hhcmUoYWRkcmVzcyBhZGRyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgcmVxdWlyZSghYm92QmF0Y2hEaXN0cmlidXRlZCAmJiAhY2xhaW1lZFthZGRyXSk7IC8vIFRva2VucyBjYW5ub3QgaGF2ZSBhbHJlYWR5IGJlZW4gZGlzdHJpYnV0ZWQuCiAgICB1aW50IGFtb3VudEludmVzdGVkID0gaW52ZXN0bWVudHNbYWRkcl07CiAgICB1aW50IGN1cnJlbnRCb3ZTaGFyZSA9IGFtb3VudEludmVzdGVkLm11bChpbml0aWFsU2FsZSkuZGl2KHdlaVJhaXNlZCk7CiAgICByZXR1cm4gY3VycmVudEJvdlNoYXJlOwogIH0KCgoKICAvLyBzZW5kIGV0aGVyIHRvIHRoZSBmdW5kIGNvbGxlY3Rpb24gd2FsbGV0CiAgZnVuY3Rpb24gZm9yd2FyZEZ1bmRzKCkgaW50ZXJuYWwgewogICAgb3duZXIudHJhbnNmZXIobXNnLnZhbHVlKTsKICB9CgoKICAvLyBUaGUgb3duZXIgbWFudWFsbHkgc3RhcnRzIHRoZSBjcm93ZHNhbGUgYXQgYSBwcmUtZGV0ZXJtaW5lZCB0aW1lLgogIGZ1bmN0aW9uIHN0YXJ0Q3Jvd2RzYWxlKCkgb25seU93bmVyIHsKICAgIHJlcXVpcmUoIXNhbGVTdGFydGVkICYmICFzYWxlRW5kZWQpOwogICAgc2FsZVN0YXJ0ZWQgPSB0cnVlOwogIH0KCiAgLy8gZW5kQ3Jvd2RzYWxlKCkgYW5kIGVuZENyb3dkc2FsZVB1YmxpYygpIG1vdmVkIHRvIFN0ZWFrIGNvbnRyYWN0CiAgICAvLyBOb3JtYWxseSwgdGhlIG93bmVyIHdpbGwgZW5kIHRoZSBjcm93ZHNhbGUgYXQgdGhlIHByZS1kZXRlcm1pbmVkIHRpbWUuCiAgZnVuY3Rpb24gZW5kQ3Jvd2RzYWxlKCkgb25seU93bmVyIHsKICAgIHJlcXVpcmUoc2FsZVN0YXJ0ZWQgJiYgIXNhbGVFbmRlZCk7CiAgICBkYWlseUhhc2hFeHBpcmVzID0gbm93OyAvLyBXaWxsIGVuZCBjcm93ZHNhbGUgYXQgM2FtIEVTVCwgc28gZXhwaXJhdGlvbiB0aW1lIHdpbGwgcm91Z2hseSBiZSBhcm91bmQgM2FtLgogICAgc2FsZUVuZGVkID0gdHJ1ZTsKICAgIHNldEluaXRpYWxQcml6ZSgpOwogIH0KCiAgLy8gTm9ybWFsbHksIE1hZGFtZSBCT1YgZW5kcyB0aGUgY3Jvd2RzYWxlIGF0IHRoZSBwcmUtZGV0ZXJtaW5lZCB0aW1lLCBidXQgaWYgTWFkYW1lIEJPViBmYWlscyB0byBkbyBzbywgYW55Ym9keSBjYW4gdHJpZ2dlciBlbmRDcm93ZHNhbGVQdWJsaWMoKSBhZnRlciBhYnNvbHV0ZUVuZEJsb2NrLgogIGZ1bmN0aW9uIGVuZENyb3dkc2FsZVB1YmxpYygpIHB1YmxpYyB7CiAgICByZXF1aXJlKGJsb2NrLm51bWJlciA+IGFic29sdXRlRW5kQmxvY2spOwogICAgcmVxdWlyZShzYWxlU3RhcnRlZCAmJiAhc2FsZUVuZGVkKTsKICAgIGRhaWx5SGFzaEV4cGlyZXMgPSBub3c7CiAgICBzYWxlRW5kZWQgPSB0cnVlOwogICAgc2V0SW5pdGlhbFByaXplKCk7CiAgfQoKCiAgLy8gQ2FsY3VsYXRlIGluaXRpYWwgbWluaW5nIHByaXplICgwLjAzNTcgZXRoZXIncyB3b3J0aCBvZiBCT1YpLiBUaGlzIGlzIGNhbGxlZCBpbiBlbmRDcm93ZHNhbGUoKS4KICBmdW5jdGlvbiBzZXRJbml0aWFsUHJpemUoKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICByZXF1aXJlKGNyb3dkc2FsZUhhc0VuZGVkKCkpOwogICAgcmVxdWlyZShpbml0aWFsUHJpemVCb3YgPT0gMCk7IC8vIENhbiBvbmx5IGJlIHNldCBvbmNlCiAgICB1aW50IHRva2VuVW5pdHNQZXJXZWkgPSBpbml0aWFsU2FsZS5kaXYod2VpUmFpc2VkKTsKICAgIGluaXRpYWxQcml6ZUJvdiA9IHRva2VuVW5pdHNQZXJXZWkubXVsKGluaXRpYWxQcml6ZVdlaVZhbHVlKTsKICAgIHJldHVybiBpbml0aWFsUHJpemVCb3Y7CiAgfQoKCiAgLy8gQHJldHVybiB0cnVlIGlmIGNyb3dkc2FsZSBldmVudCBoYXMgZW5kZWQKICBmdW5jdGlvbiBjcm93ZHNhbGVIYXNFbmRlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gc2FsZVN0YXJ0ZWQgJiYgc2FsZUVuZGVkOwogIH0KCiAgZnVuY3Rpb24gZ2V0SW52ZXN0b3JzKCkgcHVibGljIHJldHVybnMgKGFkZHJlc3NbXSkgewogICAgcmV0dXJuIGludmVzdG9yczsKICB9CgoKfQoKCgoKCgoKY29udHJhY3QgU3RlYWsgaXMgQXVjdGlvbkNyb3dkc2FsZSB7CiAgLy8gdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CgogIGJ5dGVzMzIgcHVibGljIGRhaWx5SGFzaDsgICAgICAgICAgICAvLyBUaGUgbGFzdCBmaXZlIGRpZ2l0cyBvZiB0aGUgZGFpbHlIYXNoIG11c3QgYmUgaW5jbHVkZWQgaW4gc3RlYWsgcGljdHVyZXMuCgoKICBTdWJtaXNzaW9uW10gcHVibGljIHN1Ym1pc3Npb25zOyAgICAgICAgICAvLyBBbGwgc3RlYWsgcGljcwogIHVpbnQgcHVibGljIG51bVN1Ym1pc3Npb25zOwoKICBTdWJtaXNzaW9uW10gcHVibGljIGFwcHJvdmVkU3VibWlzc2lvbnM7CiAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgbWVtYmVySWQ7ICAgIC8vIEdldCBtZW1iZXIgSUQgZnJvbSBhZGRyZXNzLgogIE1lbWJlcltdIHB1YmxpYyBtZW1iZXJzOyAgICAgICAgICAgICAgICAgICAgICAvLyBJbmRleCBpcyBtZW1iZXJJZAoKICB1aW50IHB1YmxpYyBoYWx2aW5nSW50ZXJ2YWw7ICAgICAgICAgICAgICAgICAgLy8gQk9WIGF3YXJkIGlzIGhhbHZlZCBldmVyeSB4IHN0ZWFrcwogIHVpbnQgcHVibGljIG51bWJlck9mSGFsdmluZ3M7ICAgICAgICAgICAgICAgICAvLyBIb3cgbWFueSB0aW1lcyB0aGUgQk9WIHJld2FyZCBwZXIgc3RlYWsgaXMgaGFsdmVkIGJlZm9yZSBpdCByZXR1cm5zIDAuIAoKCgogIHVpbnQgcHVibGljIGxhc3RNaW5pbmdCbG9jazsgICAgICAgICAgICAgICAgICAvLyBObyBtaW5pbmcgYWZ0ZXIgdGhpcyBibG9jay4gU2V0IGluIGluaXRpYWxpemVyLgoKICBib29sIHB1YmxpYyBvd25lckNyZWRpdGVkOyAgICAvLyBIYXMgdGhlIG93bmVyIGJlZW4gY3JlZGl0ZWQgQk9WIHlldD8KCiAgZXZlbnQgUGljQWRkZWQoYWRkcmVzcyBtc2dTZW5kZXIsIHVpbnQgc3VibWlzc2lvbklELCBhZGRyZXNzIHJlY2lwaWVudCwgYnl0ZXMzMiBwcm9wVXJsKTsgLy8gTmVlZCBtc2dTZW5kZXIgc28gd2UgY2FuIHdhdGNoIGZvciB0aGlzIGV2ZW50LgogIGV2ZW50IEp1ZGdlZCh1aW50IHN1Ym1pc3Npb25JRCwgYm9vbCBwb3NpdGlvbiwgYWRkcmVzcyB2b3RlciwgYnl0ZXMzMiBqdXN0aWZpY2F0aW9uKTsKICBldmVudCBNZW1iZXJzaGlwQ2hhbmdlZChhZGRyZXNzIG1lbWJlciwgYm9vbCBpc01lbWJlcik7CgogIHN0cnVjdCBTdWJtaXNzaW9uIHsKICAgIGFkZHJlc3MgcmVjaXBpZW50OyAgICAvLyBXb3VsZC1iZSBCT1YgcmVjaXBpZW50CiAgICBieXRlczMyIHVybDsgICAgICAgICAgIC8vIElNR1VSIHVybDsgMzItY2hhciBtYXgKICAgIGJvb2wganVkZ2VkOyAgICAgICAgICAvLyBIYXMgYW4gYWRtaW4gdm90ZWQ/CiAgICBib29sIHN1Ym1pc3Npb25BcHByb3ZlZDsvLyBIYXMgaXQgYmVlbiBhcHByb3ZlZD8KICAgIGFkZHJlc3MganVkZ2VkQnk7ICAgICAvLyBBZG1pbiB3aG8ganVkZ2VkIHRoaXMgc3RlYWsKICAgIGJ5dGVzMzIgYWRtaW5Db21tZW50czsgLy8gQWRtaW4gc2hvdWxkIGxlYXZlIGZlZWRiYWNrIG9uIG5vbi1hcHByb3ZlZCBzdGVha3MuIDMyLWNoYXIgbWF4LgogICAgYnl0ZXMzMiB0b2RheXNIYXNoOyAgIC8vIFRoZSBoYXNoIGluIHRoZSBpbWFnZSBzaG91bGQgbWF0Y2ggdGhpcyBoYXNoLgogICAgdWludCBhd2FyZGVkOyAgICAgICAgIC8vIEFtb3VudCBhd2FyZGVkCiAgfQoKICAvLyBNZW1iZXJzIGNhbiB2b3RlIG9uIHN0ZWFrCiAgc3RydWN0IE1lbWJlciB7CiAgICBhZGRyZXNzIG1lbWJlcjsKICAgIGJ5dGVzMzIgbmFtZTsKICAgIHVpbnQgbWVtYmVyU2luY2U7CiAgfQoKCiAgbW9kaWZpZXIgb25seU1lbWJlcnMgewogICAgcmVxdWlyZShtZW1iZXJJZFttc2cuc2VuZGVyXSAhPSAwKTsgLy8gbWVtYmVyIGlkIG11c3QgYmUgaW4gdGhlIG1hcHBpbmcKICAgIF87CiAgfQoKCiAgZnVuY3Rpb24gU3RlYWsoKSB7CgogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgaW5pdGlhbFNhbGUgPSAxMDAwMDAwMCAqIDEwMDAwMDAwMDAwMDAwMDAwMDA7IC8vIDEwTSBCT1YgdW5pdHMgYXJlIGF3YXJkZWQgaW4gdGhlIGNyb3dkc2FsZS4KCiAgICAvLyBOb3JtYWxseSwgdGhlIG93bmVyIGJvdGggc3RhcnRzIGFuZCBlbmRzIHRoZSBjcm93ZHNhbGUuCiAgICAvLyBUbyBndWFyYW50ZWUgdGhhdCB0aGUgY3Jvd2RzYWxlIGVuZHMgYXQgc29tZSBtYXhpbXVtIHBvaW50IChhdCB0aGF0IHRva2VucyBhcmUgZGlzdHJpYnV0ZWQpLAogICAgLy8gd2UgY2FsY3VsYXRlIHRoZSBhYnNvbHV0ZUVuZEJsb2NrLCB0aGUgYmxvY2sgYmV5b25kIHdoaWNoIGFueWJvZHkgY2FuIGVuZCB0aGUgY3Jvd2RzYWxlIGFuZCBkaXN0cmlidXRlIHRva2Vucy4KICAgIHVpbnQgYmxvY2tzUGVySG91ciA9IDIxMjsKICAgIHVpbnQgbWF4Q3Jvd2RzYWxlTGlmZUZyb21MYXVuY2hEYXlzID0gNDA7IC8vIEFmdGVyIGFib3V0IHRoaXMgbWFueSBkYXlzIGZyb20gbGF1bmNoLCBhbnlib2R5IGNhbiBlbmQgdGhlIGNyb3dkc2FsZSBhbmQgZGlzdHJpYnV0ZSAvIGNsYWltIHRoZWlyIHRva2Vucy4gCiAgICBhYnNvbHV0ZUVuZEJsb2NrID0gYmxvY2subnVtYmVyICsgKGJsb2Nrc1BlckhvdXIgKiAyNCAqIG1heENyb3dkc2FsZUxpZmVGcm9tTGF1bmNoRGF5cyk7CgogICAgdWludCBtaW5pbmdEYXlzID0gMzY1OyAvLyBBcHByb3hpbWF0ZWx5IGhvdyBtYW55IGRheXMgQk9WIGNhbiBiZSBtaW5lZCBmcm9tIHRoZSBsYXVuY2ggb2YgdGhlIGNvbnRyYWN0LgogICAgbGFzdE1pbmluZ0Jsb2NrID0gYmxvY2subnVtYmVyICsgKGJsb2Nrc1BlckhvdXIgKiAyNCAqIG1pbmluZ0RheXMpOwoKICAgIGRhaWx5SGFzaEV4cGlyZXMgPSBub3c7CgogICAgaGFsdmluZ0ludGVydmFsID0gNTAwOyAgICAvLyBIb3cgbWFueSBzdGVha3MgZ2V0IGF3YXJkZWQgdGhlIGdpdmVuIGdldFN0ZWFrUHJpemUoKSBhbW91bnQgYmVmb3JlIHRoZSByZXdhcmQgaXMgaGFsdmVkLgogICAgbnVtYmVyT2ZIYWx2aW5ncyA9IDg7ICAgICAgLy8gSG93IG1hbnkgdGltZXMgdGhlIHN0ZWFrIHByaXplIGdldHMgaGFsdmVkIGJlZm9yZSBubyBtb3JlIHByaXplIGlzIGF3YXJkZWQuCgogICAgLy8gaW5pdGlhbFByaXplV2VpVmFsdWUgPSA1MCBmaW5uZXk7IC8vIDAuMDUgZXRoZXIgPT0gNTAgZmlubmV5ID09IDIuODAgVVNEICogNSA9PSAxNCBVU0QKICAgIGluaXRpYWxQcml6ZVdlaVZhbHVlID0gKDM1NyBmaW5uZXkgLyAxMCk7IC8vIDAuMDM1NyBldGhlciA9PSAzNS43IGZpbm5leSA9PSAyLjgwIFVTRCAqIDMuNTcgPT0gOS45OTYgVVNECgogICAgLy8gVG8gZmluaXNoIGluaXRpYWxpemluZywgb3duZXIgY2FsbHMgaW5pdE1lbWJlcnMoKSBhbmQgY3JlZGl0T3duZXIoKSBhZnRlciBsYXVuY2guCiAgfQoKCiAgLy8gQWRkIE1hZGFtZSBCT1YgYXMgYSBiZWVmIGp1ZGdlLgogIGZ1bmN0aW9uIGluaXRNZW1iZXJzKCkgb25seU93bmVyIHsKICAgIGFkZE1lbWJlcigwLCAnJyk7ICAgICAgICAgICAgICAgICAgICAgICAgLy8gTXVzdCBhZGQgYW4gZW1wdHkgZmlyc3QgbWVtYmVyCiAgICBhZGRNZW1iZXIobXNnLnNlbmRlciwgJ01hZGFtZSBCT1YnKTsKICB9CgoKCiAgLy8gU2VuZCAxTSBCT1YgdG8gTWFkYW1lIEJPVi4gCiAgZnVuY3Rpb24gY3JlZGl0T3duZXIoKSBvbmx5T3duZXIgewogICAgcmVxdWlyZSghb3duZXJDcmVkaXRlZCk7CiAgICB1aW50IG93bmVyQXdhcmQgPSBpbml0aWFsU2FsZSAvIDEwOyAgLy8gMTAlIG9mIHRoZSBjcm93ZHNhbGUgYW1vdW50LgogICAgb3duZXJDcmVkaXRlZCA9IHRydWU7ICAgLy8gQ2FuIG9ubHkgYmUgcnVuIG9uY2UuCiAgICBtaW50KG93bmVyLCBvd25lckF3YXJkKTsKICB9CgoKCgoKCiAgLyogQWRkIGJlZWYganVkZ2UgKi8KICBmdW5jdGlvbiBhZGRNZW1iZXIoYWRkcmVzcyB0YXJnZXRNZW1iZXIsIGJ5dGVzMzIgbWVtYmVyTmFtZSkgb25seU93bmVyIHsKICAgIHVpbnQgaWQ7CiAgICBpZiAobWVtYmVySWRbdGFyZ2V0TWVtYmVyXSA9PSAwKSB7CiAgICAgIG1lbWJlcklkW3RhcmdldE1lbWJlcl0gPSBtZW1iZXJzLmxlbmd0aDsKICAgICAgaWQgPSBtZW1iZXJzLmxlbmd0aCsrOwogICAgICBtZW1iZXJzW2lkXSA9IE1lbWJlcih7bWVtYmVyOiB0YXJnZXRNZW1iZXIsIG1lbWJlclNpbmNlOiBub3csIG5hbWU6IG1lbWJlck5hbWV9KTsKICAgIH0gZWxzZSB7CiAgICAgIGlkID0gbWVtYmVySWRbdGFyZ2V0TWVtYmVyXTsKICAgICAgLy8gTWVtYmVyIG0gPSBtZW1iZXJzW2lkXTsKICAgIH0KICAgIE1lbWJlcnNoaXBDaGFuZ2VkKHRhcmdldE1lbWJlciwgdHJ1ZSk7CiAgfQoKICBmdW5jdGlvbiByZW1vdmVNZW1iZXIoYWRkcmVzcyB0YXJnZXRNZW1iZXIpIG9ubHlPd25lciB7CiAgICBpZiAobWVtYmVySWRbdGFyZ2V0TWVtYmVyXSA9PSAwKSByZXZlcnQoKTsKCiAgICBtZW1iZXJJZFt0YXJnZXRNZW1iZXJdID0gMDsKCiAgICBmb3IgKHVpbnQgaSA9IG1lbWJlcklkW3RhcmdldE1lbWJlcl07IGk8bWVtYmVycy5sZW5ndGgtMTsgaSsrKXsKICAgICAgbWVtYmVyc1tpXSA9IG1lbWJlcnNbaSsxXTsKICAgIH0KICAgIGRlbGV0ZSBtZW1iZXJzW21lbWJlcnMubGVuZ3RoLTFdOwogICAgbWVtYmVycy5sZW5ndGgtLTsKICB9CgoKCiAgLyogU3VibWl0IGEgc3RlYWsgcGljdHVyZS4gKEFmdGVyIGNyb3dkc2FsZSBoYXMgZW5kZWQuKQogICogIFdBUk5JTkc6IEJlZm9yZSB0YWtpbmcgdGhlIHBpY3R1cmUsIGNhbGwgZ2V0RGFpbHlIYXNoKCkgYW5kICBtaW51dGVzVG9Qb3N0KCkKICAqICBzbyB5b3UgY2FuIGJlIHN1cmUgdGhhdCB5b3UgaGF2ZSB0aGUgY29ycmVjdCBkYWlseUhhc2ggYW5kIHRoYXQgaXQgd29uJ3QgZXhwaXJlIGJlZm9yZSB5b3UgcG9zdCBpdC4KICAqLwogIGZ1bmN0aW9uIHN1Ym1pdFN0ZWFrKGFkZHJlc3MgYWRkcmVzc1RvQXdhcmQsIGJ5dGVzMzIgc3RlYWtQaWNVcmwpICByZXR1cm5zICh1aW50IHN1Ym1pc3Npb25JRCkgewogICAgcmVxdWlyZShjcm93ZHNhbGVIYXNFbmRlZCgpKTsKICAgIHJlcXVpcmUoYmxvY2subnVtYmVyIDw9IGxhc3RNaW5pbmdCbG9jayk7IC8vIENhbm5vdCBzdWJtaXQgYmV5b25kIHRoaXMgYmxvY2suCiAgICBzdWJtaXNzaW9uSUQgPSBzdWJtaXNzaW9ucy5sZW5ndGgrKzsgLy8gSW5jcmVhc2UgbGVuZ3RoIG9mIGFycmF5CiAgICBTdWJtaXNzaW9uIHN0b3JhZ2UgcyA9IHN1Ym1pc3Npb25zW3N1Ym1pc3Npb25JRF07CiAgICBzLnJlY2lwaWVudCA9IGFkZHJlc3NUb0F3YXJkOwogICAgcy51cmwgPSBzdGVha1BpY1VybDsKICAgIHMuanVkZ2VkID0gZmFsc2U7CiAgICBzLnN1Ym1pc3Npb25BcHByb3ZlZCA9IGZhbHNlOwogICAgcy50b2RheXNIYXNoID0gZ2V0RGFpbHlIYXNoKCk7IC8vIEVhY2ggc3VibWlzc2lvbiBzYXZlcyB0aGUgaGFzaCBjb2RlIHRoZSB1c2VyIHNob3VsZCB0YWtlIHBpY3R1cmUgb2YgaW4gc3RlYWsgcGljdHVyZS4KCiAgICBQaWNBZGRlZChtc2cuc2VuZGVyLCBzdWJtaXNzaW9uSUQsIGFkZHJlc3NUb0F3YXJkLCBzdGVha1BpY1VybCk7CiAgICBudW1TdWJtaXNzaW9ucyA9IHN1Ym1pc3Npb25JRCsxOwoKICAgIHJldHVybiBzdWJtaXNzaW9uSUQ7CiAgfQoKICAvLyBSZXRyaWV2aW5nIGFueSBTdWJtaXNzaW9uIG11c3QgYmUgZG9uZSB2aWEgdGhpcyBmdW5jdGlvbiwgbm90IGBzdWJtaXNzaW9ucygpYAogIGZ1bmN0aW9uIGdldFN1Ym1pc3Npb24odWludCBzdWJtaXNzaW9uSUQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzIHJlY2lwaWVudCwgYnl0ZXMzMiB1cmwsIGJvb2wganVkZ2VkLCBib29sIHN1Ym1pc3Npb25BcHByb3ZlZCwgYWRkcmVzcyBqdWRnZWRCeSwgYnl0ZXMzMiBhZG1pbkNvbW1lbnRzLCBieXRlczMyIHRvZGF5c0hhc2gsIHVpbnQgYXdhcmRlZCkgewogICAgU3VibWlzc2lvbiBzdG9yYWdlIHMgPSBzdWJtaXNzaW9uc1tzdWJtaXNzaW9uSURdOwogICAgcmVjaXBpZW50ID0gcy5yZWNpcGllbnQ7CiAgICB1cmwgPSBzLnVybDsgICAgICAgICAgICAgICAgIC8vIElNR1VSIHVybAogICAganVkZ2VkID0gcy5qdWRnZWQ7ICAgICAgICAgICAvLyBIYXMgYW4gYWRtaW4gdm90ZWQ/CiAgICBzdWJtaXNzaW9uQXBwcm92ZWQgPSBzLnN1Ym1pc3Npb25BcHByb3ZlZDsgIC8vIEhhcyBpdCBiZWVuIGFwcHJvdmVkPwogICAganVkZ2VkQnkgPSBzLmp1ZGdlZEJ5OyAgICAgICAgICAgLy8gQWRtaW4gd2hvIGp1ZGdlZCB0aGlzIHN0ZWFrCiAgICBhZG1pbkNvbW1lbnRzID0gcy5hZG1pbkNvbW1lbnRzOyAvLyBBZG1pbiBzaG91bGQgbGVhdmUgZmVlZGJhY2sgb24gbm9uLWFwcHJvdmVkIHN0ZWFrcwogICAgdG9kYXlzSGFzaCA9IHMudG9kYXlzSGFzaDsgICAgICAgLy8gVGhlIGhhc2ggaW4gdGhlIGltYWdlIHNob3VsZCBtYXRjaCB0aGlzIGhhc2guCiAgICBhd2FyZGVkID0gcy5hd2FyZGVkOyAgICAgICAgIC8vIEFtb3VudCBhd2FyZGVkICAgLy8gcmV0dXJuICh1c2Vyc1tpbmRleF0uc2FsYXJ5SWQsIHVzZXJzW2luZGV4XS5uYW1lLCB1c2Vyc1tpbmRleF0udXNlckFkZHJlc3MsIHVzZXJzW2luZGV4XS5zYWxhcnkpOwogICAgLy8gcmV0dXJuIChyZWNpcGllbnQsIHVybCwganVkZ2VkLCBzdWJtaXNzaW9uQXBwcm92ZWQsIGp1ZGdlZEJ5LCBhZG1pbkNvbW1lbnRzLCB0b2RheXNIYXNoLCBhd2FyZGVkKTsKICB9CgoKCiAgLy8gTWVtYmVycyBqdWRnZSBzdGVhayBwaWNzLCBwcm92aWRpbmcganVzdGlmaWNhdGlvbiBpZiBuZWNlc3NhcnkuCiAgZnVuY3Rpb24ganVkZ2UodWludCBzdWJtaXNzaW9uTnVtYmVyLCBib29sIHN1cHBvcnRzU3VibWlzc2lvbiwgYnl0ZXMzMiBqdXN0aWZpY2F0aW9uVGV4dCkgb25seU1lbWJlcnMgewogICAgU3VibWlzc2lvbiBzdG9yYWdlIHMgPSBzdWJtaXNzaW9uc1tzdWJtaXNzaW9uTnVtYmVyXTsgICAgICAgICAvLyBHZXQgdGhlIHN1Ym1pc3Npb24uCiAgICByZXF1aXJlKCFzLmp1ZGdlZCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE11c24ndCBiZSBqdWRnZWQuCgogICAgcy5qdWRnZWQgPSB0cnVlOwogICAgcy5qdWRnZWRCeSA9IG1zZy5zZW5kZXI7CiAgICBzLnN1Ym1pc3Npb25BcHByb3ZlZCA9IHN1cHBvcnRzU3VibWlzc2lvbjsKICAgIHMuYWRtaW5Db21tZW50cyA9IGp1c3RpZmljYXRpb25UZXh0OyAgICAvLyBBZG1pbiBjYW4gYWRkIGNvbW1lbnRzIHdoZXRoZXIgYXBwcm92ZWQgb3Igbm90CgogICAgaWYgKHN1cHBvcnRzU3VibWlzc2lvbikgeyAvLyBJZiBpdCBwYXNzZWQgbXVzdGVyLCBjcmVkaXQgdGhlIHVzZXIgYW5kIGFkbWluLgogICAgICB1aW50IHByaXplQW1vdW50ID0gZ2V0U3RlYWtQcml6ZSgpOyAvLyBDYWxjdWxhdGUgQk9WIHByaXplCiAgICAgIHMuYXdhcmRlZCA9IHByaXplQW1vdW50OyAgICAgICAgICAgIC8vIFJlY29yZCBhbW91bnQgaW4gdGhlIFN1Ym1pc3Npb24KICAgICAgbWludChzLnJlY2lwaWVudCwgcHJpemVBbW91bnQpOyAgICAgLy8gQ3JlZGl0IHRoZSB1c2VyJ3MgYWNjb3VudAoKICAgICAgLy8gQ3JlZGl0IHRoZSBtZW1iZXIgb25lLXRoaXJkIG9mIHRoZSBwcml6ZSBhbW91bnQuCiAgICAgIHVpbnQgYWRtaW5Bd2FyZCA9IHByaXplQW1vdW50LmRpdigzKTsKICAgICAgbWludChtc2cuc2VuZGVyLCBhZG1pbkF3YXJkKTsKCiAgICAgIGFwcHJvdmVkU3VibWlzc2lvbnMucHVzaChzKTsKICAgIH0KCiAgICBKdWRnZWQoc3VibWlzc2lvbk51bWJlciwgc3VwcG9ydHNTdWJtaXNzaW9uLCBtc2cuc2VuZGVyLCBqdXN0aWZpY2F0aW9uVGV4dCk7CiAgfQoKCiAgLy8gQ2FsY3VsYXRlIGhvdyBtYW55IEJPViBhcmUgcmV3YXJkZWQgcGVyIGFwcHJvdmVkIHN0ZWFrIHBpYy4KICBmdW5jdGlvbiBnZXRTdGVha1ByaXplKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgIHJlcXVpcmUoaW5pdGlhbFByaXplQm92ID4gMCk7IC8vIGNyb3dkc2FsZSBtdXN0IGJlIG92ZXIgKGVuZENyb3dkc2FsZSgpIGNhbGxzIHNldEluaXRpYWxQcml6ZSgpKQogICAgdWludCBoYWx2aW5ncyA9IG51bWJlck9mQXBwcm92ZWRTdGVha3MoKS5kaXYoaGFsdmluZ0ludGVydmFsKTsKICAgIGlmIChoYWx2aW5ncyA+IG51bWJlck9mSGFsdmluZ3MpIHsgIC8vIEFmdGVyIDggaGFsdmluZ3MsIG5vIG1vcmUgQk9WIGlzIGF3YXJkZWQuCiAgICAgIHJldHVybiAwOwogICAgfQoKICAgIHVpbnQgcHJpemUgPSBpbml0aWFsUHJpemVCb3Y7CgogICAgcHJpemUgPSBwcml6ZSA+PiBoYWx2aW5nczsgLy8gSGFsdmUgdGhlIGluaXRpYWwgcHJpemUgImhhbHZpbmdzIi1udW1iZXIgb2YgdGltZXMuCiAgICByZXR1cm4gcHJpemU7CiAgfQoKCiAgZnVuY3Rpb24gbnVtYmVyT2ZBcHByb3ZlZFN0ZWFrcygpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CiAgICByZXR1cm4gYXBwcm92ZWRTdWJtaXNzaW9ucy5sZW5ndGg7CiAgfQoKCiAgLy8gQWx3YXlzIGNhbGwgdGhpcyBiZWZvcmUgY2FsbGluZyBkYWlseUhhc2ggYW5kIHN1Ym1pdHRpbmcgYSBzdGVhay4KICAvLyBJZiBleHBpcmVkLCB0aGUgbmV3IGhhc2ggaXMgc2V0IHRvIHRoZSBsYXN0IGJsb2NrJ3MgaGFzaC4KICBmdW5jdGlvbiBnZXREYWlseUhhc2goKSBwdWJsaWMgcmV0dXJucyAoYnl0ZXMzMikgewogICAgaWYgKGRhaWx5SGFzaEV4cGlyZXMgPiBub3cpIHsgLy8gSWYgdGhlIGhhc2ggaGFzbid0IGV4cGlyZWQgeWV0LCByZXR1cm4gaXQuCiAgICAgIHJldHVybiBkYWlseUhhc2g7CiAgICB9IGVsc2UgeyAvLyBVZGRlcndpc2UsIHNldCB0aGUgbmV3IGRhaWx5SGFzaCBhbmQgZGFpbHlIYXNoRXhwaXJhdGlvbi4KCiAgICAgIC8vIEdldCBoYXNoIGZyb20gdGhlIGxhc3QgYmxvY2suCiAgICAgIGJ5dGVzMzIgbmV3SGFzaCA9IGJsb2NrLmJsb2NraGFzaChibG9jay5udW1iZXItMSk7CiAgICAgIGRhaWx5SGFzaCA9IG5ld0hhc2g7CgogICAgICAvLyBTZXQgdGhlIG5ldyBleHBpcmF0aW9uLCBqdW1waW5nIGFoZWFkIGluIDI0LWhvdXIgaW5jcmVtZW50cyBzbyB0aGUgZXhwaXJhdGlvbiB0aW1lIHJlbWFpbnMgcm91Z2hseSBjb25zdGFudCBmcm9tIGRheSB0byBkYXkgKGUuZy4gM2FtKS4KICAgICAgdWludCBuZXh0RXhwaXJhdGlvbiA9IGRhaWx5SGFzaEV4cGlyZXMgKyAyNCBob3VyczsgLy8gSXQgd2lsbCBhbHJlYWR5IGJlIGV4cGlyZWQsIHNvIHNldCBpdCB0byBuZXh0IHBvc3NpYmxlIGRhdGUuCiAgICAgIHdoaWxlIChuZXh0RXhwaXJhdGlvbiA8IG5vdykgeyAvLyBpZiBpdCdzIHN0aWxsIGluIHRoZSBwYXN0LCBhZHZhbmNlIGJ5IDI0IGhvdXJzLgogICAgICAgIG5leHRFeHBpcmF0aW9uICs9IDI0IGhvdXJzOwogICAgICB9CiAgICAgIGRhaWx5SGFzaEV4cGlyZXMgPSBuZXh0RXhwaXJhdGlvbjsKICAgICAgcmV0dXJuIG5ld0hhc2g7CiAgICB9CiAgfQoKICAvLyBSZXR1cm5zIHRoZSBhbW91bnQgb2YgbWludXRlcyB0byBwb3N0IHdpdGggdGhlIGN1cnJlbnQgZGFpbHlIYXNoCiAgZnVuY3Rpb24gbWludXRlc1RvUG9zdCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CiAgICBpZiAoZGFpbHlIYXNoRXhwaXJlcyA+IG5vdykgewogICAgICByZXR1cm4gKGRhaWx5SGFzaEV4cGlyZXMgLSBub3cpIC8gNjA7IC8vIHJldHVybnMgbWludXRlcwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjdXJyZW50QmxvY2soKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgcmV0dXJuIGJsb2NrLm51bWJlcjsKICB9Cn0='.
	

]
