Class {
	#name : #SRTb8e392da7abb836cff06d827531a7e5f1b00bed2,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTb8e392da7abb836cff06d827531a7e5f1b00bed2 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7Cgpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9Cgpjb250cmFjdCBFUkM3MjEgewogICAgZnVuY3Rpb24gaW1wbGVtZW50c0VSQzcyMSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHRvdGFsKTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKICAgIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBvd25lcik7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWM7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWM7CiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGluZGV4ZWQgdG9rZW5JZCk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBhcHByb3ZlZCwgdWludDI1NiBpbmRleGVkIHRva2VuSWQpOwp9Cgpjb250cmFjdCBTYW1wbGVTdG9yYWdlIGlzIE93bmFibGUgewogICAgCiAgICBzdHJ1Y3QgU2FtcGxlIHsKICAgICAgICBzdHJpbmcgaXBmc0hhc2g7CiAgICAgICAgdWludCByYXJpdHk7CiAgICB9CiAgICAKICAgIG1hcHBpbmcgKHVpbnQgPT4gU2FtcGxlKSBzYW1wbGVUeXBlczsKICAgIAogICAgdWludCBwdWJsaWMgbnVtT2ZTYW1wbGVUeXBlczsKICAgIAogICAgdWludCBwdWJsaWMgbnVtT2ZDb21tb247CiAgICB1aW50IHB1YmxpYyBudW1PZlJhcmU7CiAgICB1aW50IHB1YmxpYyBudW1PZkxlZ2VuZGFyeTsKICAgIHVpbnQgcHVibGljIG51bU9mTXl0aGljYWw7CiAgICAKICAgIGZ1bmN0aW9uIGFkZE5ld1NhbXBsZVR5cGUoc3RyaW5nIF9pcGZzSGFzaCwgdWludCBfcmFyaXR5VHlwZSkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgCiAgICAgICAgaWYgKF9yYXJpdHlUeXBlID09IDApIHsKICAgICAgICAgICAgbnVtT2ZDb21tb24rKzsKICAgICAgICB9IGVsc2UgaWYgKF9yYXJpdHlUeXBlID09IDEpIHsKICAgICAgICAgICAgbnVtT2ZSYXJlKys7CiAgICAgICAgfSBlbHNlIGlmKF9yYXJpdHlUeXBlID09IDIpIHsKICAgICAgICAgICAgbnVtT2ZMZWdlbmRhcnkrKzsKICAgICAgICB9IGVsc2UgaWYoX3Jhcml0eVR5cGUgPT0gMykgewogICAgICAgICAgICBudW1PZk15dGhpY2FsKys7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHNhbXBsZVR5cGVzW251bU9mU2FtcGxlVHlwZXNdID0gU2FtcGxlKHsKICAgICAgICAgICBpcGZzSGFzaDogX2lwZnNIYXNoLAogICAgICAgICAgIHJhcml0eTogX3Jhcml0eVR5cGUKICAgICAgICB9KTsKICAgICAgICAKICAgICAgICBudW1PZlNhbXBsZVR5cGVzKys7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldFR5cGUodWludCBfcmFuZG9tTnVtKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgdWludCByYW5nZSA9IDA7CiAgICAgICAgCiAgICAgICAgaWYgKF9yYW5kb21OdW0gPiAwICYmIF9yYW5kb21OdW0gPCA2MDApIHsKICAgICAgICAgICAgcmFuZ2UgPSA2MDAgLyBudW1PZkNvbW1vbjsKICAgICAgICAgICAgcmV0dXJuIF9yYW5kb21OdW0gLyByYW5nZTsKICAgICAgICAgICAgCiAgICAgICAgfSBlbHNlIGlmKF9yYW5kb21OdW0gPj0gNjAwICYmIF9yYW5kb21OdW0gPCA5MDApIHsKICAgICAgICAgICAgcmFuZ2UgPSAzMDAgLyBudW1PZlJhcmU7CiAgICAgICAgICAgIHJldHVybiBfcmFuZG9tTnVtIC8gcmFuZ2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmFuZ2UgPSAxMDAgLyBudW1PZkxlZ2VuZGFyeTsKICAgICAgICAgICAgcmV0dXJuIF9yYW5kb21OdW0gLyByYW5nZTsKICAgICAgICB9CiAgICB9CiAgICAKfQoKY29udHJhY3QgSmluZ2xlIGlzIE93bmFibGUsIEVSQzcyMSB7CiAgICAKICAgIHN0cnVjdCBNZXRhSW5mbyB7CiAgICAgICAgc3RyaW5nIG5hbWU7CiAgICAgICAgc3RyaW5nIGF1dGhvcjsKICAgIH0KICAgIAogICAgbWFwcGluZyAodWludCA9PiBhZGRyZXNzKSBpbnRlcm5hbCB0b2tlbnNGb3JPd25lcjsKICAgIG1hcHBpbmcgKHVpbnQgPT4gYWRkcmVzcykgaW50ZXJuYWwgdG9rZW5zRm9yQXBwcm92ZWQ7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnRbXSkgaW50ZXJuYWwgdG9rZW5zT3duZWQ7CiAgICBtYXBwaW5nICh1aW50ID0+IHVpbnQpIGludGVybmFsIHRva2VuUG9zSW5BcnI7CiAgICAKICAgIG1hcHBpbmcodWludCA9PiB1aW50W10pIGludGVybmFsIHNhbXBsZXNJbkppbmdsZTsKICAgIG1hcHBpbmcodWludCA9PiBNZXRhSW5mbykgcHVibGljIGppbmdsZXNJbmZvOwogICAgCiAgICBtYXBwaW5nKGJ5dGVzMzIgPT4gYm9vbCkgcHVibGljIHVuaXF1ZUppbmdsZXM7CiAgICAKICAgIG1hcHBpbmcodWludCA9PiB1aW50W10pIHB1YmxpYyBzb3VuZEVmZmVjdHM7CiAgICAKICAgIHVpbnQgcHVibGljIG51bU9mSmluZ2xlczsKICAgIAogICAgYWRkcmVzcyBwdWJsaWMgY3J5cHRvSmluZ2xlczsKICAgIE1hcmtldHBsYWNlIHB1YmxpYyBtYXJrZXRwbGFjZUNvbnRyYWN0OwogICAgCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGluZGV4ZWQgdG9rZW5JZCk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBhcHByb3ZlZCwgdWludDI1NiBpbmRleGVkIHRva2VuSWQpOwogICAgZXZlbnQgRWZmZWN0QWRkZWQodWludCBpbmRleGVkIGppbmdsZUlkLCB1aW50W10gZWZmZWN0UGFyYW1zKTsKICAgIGV2ZW50IENvbXBvc2VkKHVpbnQgaW5kZXhlZCBqaW5nbGVJZCwgYWRkcmVzcyBpbmRleGVkIG93bmVyLCAKICAgICAgICAgICAgICAgIHVpbnRbNV0gc2FtcGxlcywgdWludFs1XSBqaW5nbGVUeXBlcywgc3RyaW5nIG5hbWUsIHN0cmluZyBhdXRob3IpOwogICAgCiAgICBtb2RpZmllciBvbmx5Q3J5cHRvSmluZ2xlcygpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY3J5cHRvSmluZ2xlcyk7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gSmluZ2xlKCkgcHVibGljIHsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2ppbmdsZUlkKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUodG9rZW5zRm9yT3duZXJbX2ppbmdsZUlkXSAhPSAweDApOwogICAgICAgIHJlcXVpcmUodG9rZW5zRm9yT3duZXJbX2ppbmdsZUlkXSA9PSBtc2cuc2VuZGVyKTsKICAgICAgICAKICAgICAgICB0b2tlbnNGb3JBcHByb3ZlZFtfamluZ2xlSWRdID0gMHgwOwogICAgICAgIAogICAgICAgIHJlbW92ZUppbmdsZShtc2cuc2VuZGVyLCBfamluZ2xlSWQpOwogICAgICAgIGFkZEppbmdsZShfdG8sIF9qaW5nbGVJZCk7CiAgICAgICAgCiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgMCwgX2ppbmdsZUlkKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF9qaW5nbGVJZCk7CiAgICB9CiAgICAKICAgIAogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF90bywgdWludDI1NiBfamluZ2xlSWQpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZSh0b2tlbnNGb3JPd25lcltfamluZ2xlSWRdICE9IDB4MCk7CiAgICAgICAgcmVxdWlyZShvd25lck9mKF9qaW5nbGVJZCkgPT0gbXNnLnNlbmRlcik7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gbXNnLnNlbmRlcik7CiAgICAgICAgCiAgICAgICAgaWYgKF9nZXRBcHByb3ZlZChfamluZ2xlSWQpICE9IDB4MCB8fCBfdG8gIT0gMHgwKSB7CiAgICAgICAgICAgIHRva2Vuc0ZvckFwcHJvdmVkW19qaW5nbGVJZF0gPSBfdG87CiAgICAgICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF90bywgX2ppbmdsZUlkKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfamluZ2xlSWQpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZSh0b2tlbnNGb3JPd25lcltfamluZ2xlSWRdICE9IDB4MCk7CiAgICAgICAgcmVxdWlyZShfZ2V0QXBwcm92ZWQoX2ppbmdsZUlkKSA9PSBtc2cuc2VuZGVyKTsKICAgICAgICByZXF1aXJlKG93bmVyT2YoX2ppbmdsZUlkKSA9PSBfZnJvbSk7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gMHgwKTsKICAgICAgICAKICAgICAgICB0b2tlbnNGb3JBcHByb3ZlZFtfamluZ2xlSWRdID0gMHgwOwogICAgICAgIAogICAgICAgIHJlbW92ZUppbmdsZShfZnJvbSwgX2ppbmdsZUlkKTsKICAgICAgICBhZGRKaW5nbGUoX3RvLCBfamluZ2xlSWQpOwogICAgICAgIAogICAgICAgIEFwcHJvdmFsKF9mcm9tLCAwLCBfamluZ2xlSWQpOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF9qaW5nbGVJZCk7CiAgICAgICAgCiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGFwcHJvdmVBbmRTZWxsKHVpbnQgX2ppbmdsZUlkLCB1aW50IF9hbW91bnQpIHB1YmxpYyB7CiAgICAgICAgYXBwcm92ZShhZGRyZXNzKG1hcmtldHBsYWNlQ29udHJhY3QpLCBfamluZ2xlSWQpOwogICAgICAgIAogICAgICAgIG1hcmtldHBsYWNlQ29udHJhY3Quc2VsbChtc2cuc2VuZGVyLCBfamluZ2xlSWQsIF9hbW91bnQpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBjb21wb3NlSmluZ2xlKGFkZHJlc3MgX293bmVyLCB1aW50WzVdIGppbmdsZXMsIAogICAgICAgICAgICB1aW50WzVdIGppbmdsZVR5cGVzLCBzdHJpbmcgbmFtZSwgc3RyaW5nIGF1dGhvcikgcHVibGljIG9ubHlDcnlwdG9KaW5nbGVzIHsKICAgICAgICAKICAgICAgICB1aW50IF9qaW5nbGVJZCA9IG51bU9mSmluZ2xlczsKICAgICAgICAKICAgICAgICB1bmlxdWVKaW5nbGVzW2tlY2NhazI1NihqaW5nbGVzKV0gPSB0cnVlOwogICAgICAgIAogICAgICAgIHRva2Vuc0Zvck93bmVyW19qaW5nbGVJZF0gPSBfb3duZXI7CiAgICAgICAgCiAgICAgICAgdG9rZW5zT3duZWRbX293bmVyXS5wdXNoKF9qaW5nbGVJZCk7CiAgICAgICAgCiAgICAgICAgc2FtcGxlc0luSmluZ2xlW19qaW5nbGVJZF0gPSBqaW5nbGVzOwogICAgICAgIAogICAgICAgIHRva2VuUG9zSW5BcnJbX2ppbmdsZUlkXSA9IHRva2Vuc093bmVkW19vd25lcl0ubGVuZ3RoIC0gMTsKICAgICAgICAKICAgICAgICBpZiAoYnl0ZXMoYXV0aG9yKS5sZW5ndGggPT0gMCkgewogICAgICAgICAgICBhdXRob3IgPSAiU291bmR0b3NoaSBOYWthamluZ2xlcyI7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGppbmdsZXNJbmZvW251bU9mSmluZ2xlc10gPSBNZXRhSW5mbyh7CiAgICAgICAgICAgIG5hbWU6IG5hbWUsCiAgICAgICAgICAgIGF1dGhvcjogYXV0aG9yCiAgICAgICAgfSk7CiAgICAgICAgCiAgICAgICAgQ29tcG9zZWQobnVtT2ZKaW5nbGVzLCBfb3duZXIsIGppbmdsZXMsIGppbmdsZVR5cGVzLCBuYW1lLCBhdXRob3IpOwogICAgICAgIAogICAgICAgIG51bU9mSmluZ2xlcysrOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBhZGRTb3VuZEVmZmVjdCh1aW50IF9qaW5nbGVJZCwgdWludFtdIF9lZmZlY3RQYXJhbXMpIGV4dGVybmFsIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXJPZihfamluZ2xlSWQpKTsKICAgICAgICAKICAgICAgICBzb3VuZEVmZmVjdHNbX2ppbmdsZUlkXSA9IF9lZmZlY3RQYXJhbXM7CiAgICAgICAgCiAgICAgICAgRWZmZWN0QWRkZWQoX2ppbmdsZUlkLCBfZWZmZWN0UGFyYW1zKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gaW1wbGVtZW50c0VSQzcyMSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIG51bU9mSmluZ2xlczsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gdG9rZW5zT3duZWRbX293bmVyXS5sZW5ndGg7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfamluZ2xlSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3MpIHsKICAgICAgICByZXR1cm4gdG9rZW5zRm9yT3duZXJbX2ppbmdsZUlkXTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gdG9rZW5PZk93bmVyQnlJbmRleChhZGRyZXNzIF9vd25lciwgdWludDI1NiBfaW5kZXgpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiB0b2tlbnNPd25lZFtfb3duZXJdW19pbmRleF07CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldFNhbXBsZXNGb3JKaW5nbGUodWludCBfamluZ2xlSWQpIGV4dGVybmFsIHZpZXcgcmV0dXJucyh1aW50W10pIHsKICAgICAgICByZXR1cm4gc2FtcGxlc0luSmluZ2xlW19qaW5nbGVJZF07CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldEFsbEppbmdsZXMoYWRkcmVzcyBfb3duZXIpIGV4dGVybmFsIHZpZXcgcmV0dXJucyh1aW50W10pIHsKICAgICAgICByZXR1cm4gdG9rZW5zT3duZWRbX293bmVyXTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0TWV0YUluZm8odWludCBfamluZ2xlSWQpIGV4dGVybmFsIHZpZXcgcmV0dXJucyhzdHJpbmcsIHN0cmluZykgewogICAgICAgIHJldHVybiAoamluZ2xlc0luZm9bX2ppbmdsZUlkXS5uYW1lLCBqaW5nbGVzSW5mb1tfamluZ2xlSWRdLmF1dGhvcik7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIF9nZXRBcHByb3ZlZCh1aW50IF9qaW5nbGVJZCkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICAgICAgcmV0dXJuIHRva2Vuc0ZvckFwcHJvdmVkW19qaW5nbGVJZF07CiAgICB9CiAgICAKICAgICAvLyBJbnRlcm5hbCBmdW5jdGlvbnMgb2YgdGhlIGNvbnRyYWN0CiAgICAKICAgIGZ1bmN0aW9uIGFkZEppbmdsZShhZGRyZXNzIF9vd25lciwgdWludCBfamluZ2xlSWQpIGludGVybmFsIHsKICAgICAgICB0b2tlbnNGb3JPd25lcltfamluZ2xlSWRdID0gX293bmVyOwogICAgICAgIAogICAgICAgIHRva2Vuc093bmVkW19vd25lcl0ucHVzaChfamluZ2xlSWQpOwogICAgICAgIAogICAgICAgIHRva2VuUG9zSW5BcnJbX2ppbmdsZUlkXSA9IHRva2Vuc093bmVkW19vd25lcl0ubGVuZ3RoIC0gMTsKICAgIH0KICAgIAogICAgLy8gZmluZCB3aG8gb3ducyB0aGF0IGppbmdsZSBhbmQgYXQgd2hhdCBwb3NpdGlvbiBpcyBpdCBpbiB0aGUgb3duZXJzIGFyciAKICAgIC8vIFN3YXAgdGhhdCB0b2tlbiB3aXRoIHRoZSBsYXN0IG9uZSBpbiBhcnIgYW5kIGRlbGV0ZSB0aGUgZW5kIG9mIGFycgogICAgZnVuY3Rpb24gcmVtb3ZlSmluZ2xlKGFkZHJlc3MgX293bmVyLCB1aW50IF9qaW5nbGVJZCkgaW50ZXJuYWwgewogICAgICAgIHVpbnQgbGVuZ3RoID0gdG9rZW5zT3duZWRbX293bmVyXS5sZW5ndGg7CiAgICAgICAgdWludCBpbmRleCA9IHRva2VuUG9zSW5BcnJbX2ppbmdsZUlkXTsKICAgICAgICB1aW50IHN3YXBUb2tlbiA9IHRva2Vuc093bmVkW19vd25lcl1bbGVuZ3RoIC0gMV07CgogICAgICAgIHRva2Vuc093bmVkW19vd25lcl1baW5kZXhdID0gc3dhcFRva2VuOwogICAgICAgIHRva2VuUG9zSW5BcnJbc3dhcFRva2VuXSA9IGluZGV4OwoKICAgICAgICBkZWxldGUgdG9rZW5zT3duZWRbX293bmVyXVtsZW5ndGggLSAxXTsKICAgICAgICB0b2tlbnNPd25lZFtfb3duZXJdLmxlbmd0aC0tOwogICAgfQogICAgCiAgICAvLyBPd25lciBmdW5jdGlvbnMgCiAgICBmdW5jdGlvbiBzZXRDcnlwdG9KaW5nbGVzQ29udHJhY3QoYWRkcmVzcyBfY3J5cHRvSmluZ2xlcykgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShjcnlwdG9KaW5nbGVzID09IDB4MCk7CiAgICAgICAgCiAgICAgICAgY3J5cHRvSmluZ2xlcyA9IF9jcnlwdG9KaW5nbGVzOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBzZXRNYXJrZXRwbGFjZUNvbnRyYWN0KGFkZHJlc3MgX21hcmtldHBsYWNlKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKGFkZHJlc3MobWFya2V0cGxhY2VDb250cmFjdCkgPT0gMHgwKTsKICAgICAgICAKICAgICAgICBtYXJrZXRwbGFjZUNvbnRyYWN0ID0gTWFya2V0cGxhY2UoX21hcmtldHBsYWNlKTsKICAgIH0KfQoKY29udHJhY3QgU2FtcGxlIGlzIE93bmFibGUgewogICAgCiAgICBtYXBwaW5nICh1aW50ID0+IGFkZHJlc3MpIGludGVybmFsIHRva2Vuc0Zvck93bmVyOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50W10pIGludGVybmFsIHRva2Vuc093bmVkOwogICAgbWFwcGluZyAodWludCA9PiB1aW50KSBpbnRlcm5hbCB0b2tlblBvc0luQXJyOwogICAgCiAgICBtYXBwaW5nICh1aW50ID0+IHVpbnQpIHB1YmxpYyB0b2tlblR5cGU7CiAgICAKICAgIHVpbnQgcHVibGljIG51bU9mU2FtcGxlczsKICAgIAogICAgYWRkcmVzcyBwdWJsaWMgY3J5cHRvSmluZ2xlczsKCiAgICBTYW1wbGVTdG9yYWdlIHB1YmxpYyBzYW1wbGVTdG9yYWdlOwogICAgCiAgICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgaW5kZXhlZCBfdG9rZW5JZCk7CiAgICAKICAgIG1vZGlmaWVyIG9ubHlDcnlwdG9KaW5nbGVzKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjcnlwdG9KaW5nbGVzKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBTYW1wbGUoYWRkcmVzcyBfc2FtcGxlU3RvcmFnZSkgcHVibGljIHsKICAgICAgICBzYW1wbGVTdG9yYWdlID0gU2FtcGxlU3RvcmFnZShfc2FtcGxlU3RvcmFnZSk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfb3duZXIsIHVpbnQgX3JhbmRvbU51bSkgcHVibGljIG9ubHlDcnlwdG9KaW5nbGVzIHsKICAgICAgICAKICAgICAgICB1aW50IHNhbXBsZVR5cGUgPSBzYW1wbGVTdG9yYWdlLmdldFR5cGUoX3JhbmRvbU51bSk7CiAgICAgICAgCiAgICAgICAgYWRkU2FtcGxlKF9vd25lciwgc2FtcGxlVHlwZSwgbnVtT2ZTYW1wbGVzKTsKICAgICAgICAKICAgICAgICBNaW50KF9vd25lciwgbnVtT2ZTYW1wbGVzKTsKICAgICAgICAKICAgICAgICBudW1PZlNhbXBsZXMrKzsKICAgIH0KICAgIAogICAgLy9UT0RPOiBjaGVjayB0aGlzIGFnYWluCiAgICAvLyBmaW5kIHdobyBvd25zIHRoYXQgc2FtcGxlIGFuZCBhdCB3aGF0IHBvc2l0aW9uIGlzIGl0IGluIHRoZSBvd25lcnMgYXJyIAogICAgLy8gU3dhcCB0aGF0IHRva2VuIHdpdGggdGhlIGxhc3Qgb25lIGluIGFyciBhbmQgZGVsZXRlIHRoZSBlbmQgb2YgYXJyCiAgICBmdW5jdGlvbiByZW1vdmVTYW1wbGUoYWRkcmVzcyBfb3duZXIsIHVpbnQgX3NhbXBsZUlkKSBwdWJsaWMgb25seUNyeXB0b0ppbmdsZXMgewogICAgICAgIHVpbnQgbGVuZ3RoID0gdG9rZW5zT3duZWRbX293bmVyXS5sZW5ndGg7CiAgICAgICAgdWludCBpbmRleCA9IHRva2VuUG9zSW5BcnJbX3NhbXBsZUlkXTsKICAgICAgICB1aW50IHN3YXBUb2tlbiA9IHRva2Vuc093bmVkW19vd25lcl1bbGVuZ3RoIC0gMV07CgogICAgICAgIHRva2Vuc093bmVkW19vd25lcl1baW5kZXhdID0gc3dhcFRva2VuOwogICAgICAgIHRva2VuUG9zSW5BcnJbc3dhcFRva2VuXSA9IGluZGV4OwoKICAgICAgICBkZWxldGUgdG9rZW5zT3duZWRbX293bmVyXVtsZW5ndGggLSAxXTsKICAgICAgICB0b2tlbnNPd25lZFtfb3duZXJdLmxlbmd0aC0tOwogICAgICAgIAogICAgICAgIHRva2Vuc0Zvck93bmVyW19zYW1wbGVJZF0gPSAweDA7CiAgICAgICAgCiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldFNhbXBsZXNGb3JPd25lcihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnRbXSkgewogICAgICAgIHJldHVybiB0b2tlbnNPd25lZFtfb3duZXJdOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRUb2tlblR5cGUodWludCBfc2FtcGxlSWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIHRva2VuVHlwZVtfc2FtcGxlSWRdOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBpc1Rva2VuT3duZXIodWludCBfdG9rZW5JZCwgYWRkcmVzcyBfdXNlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMoYm9vbCkgewogICAgICAgIHJldHVybiB0b2tlbnNGb3JPd25lcltfdG9rZW5JZF0gPT0gX3VzZXI7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldEFsbFNhbXBsZXNGb3JPd25lcihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnModWludFtdKSB7CiAgICAgICAgdWludFtdIG1lbW9yeSBzYW1wbGVzID0gdG9rZW5zT3duZWRbX293bmVyXTsKICAgICAgICAKICAgICAgICB1aW50W10gbWVtb3J5IHVzZXJzU2FtcGxlcyA9IG5ldyB1aW50W10oc2FtcGxlcy5sZW5ndGggKiAyKTsKICAgICAgICAKICAgICAgICB1aW50IGogPSAwOwogICAgICAgIAogICAgICAgIGZvcih1aW50IGkgPSAwOyBpIDwgc2FtcGxlcy5sZW5ndGg7ICsraSkgewogICAgICAgICAgICB1c2Vyc1NhbXBsZXNbal0gPSBzYW1wbGVzW2ldOwogICAgICAgICAgICB1c2Vyc1NhbXBsZXNbaiArIDFdID0gdG9rZW5UeXBlW3NhbXBsZXNbaV1dOwogICAgICAgICAgICBqICs9IDI7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVybiB1c2Vyc1NhbXBsZXM7CiAgICB9CiAgICAKICAgIC8vIEludGVybmFsIGZ1bmN0aW9ucyBvZiB0aGUgY29udHJhY3QKICAgIAogICAgZnVuY3Rpb24gYWRkU2FtcGxlKGFkZHJlc3MgX293bmVyLCB1aW50IF9zYW1wbGVUeXBlLCB1aW50IF9zYW1wbGVJZCkgaW50ZXJuYWwgewogICAgICAgIHRva2Vuc0Zvck93bmVyW19zYW1wbGVJZF0gPSBfb3duZXI7CiAgICAgICAgCiAgICAgICAgdG9rZW5zT3duZWRbX293bmVyXS5wdXNoKF9zYW1wbGVJZCk7CiAgICAgICAgCiAgICAgICAgdG9rZW5UeXBlW19zYW1wbGVJZF0gPSBfc2FtcGxlVHlwZTsKICAgICAgICAKICAgICAgICB0b2tlblBvc0luQXJyW19zYW1wbGVJZF0gPSB0b2tlbnNPd25lZFtfb3duZXJdLmxlbmd0aCAtIDE7CiAgICB9CiAgICAKICAgICAvLyBPd25lciBmdW5jdGlvbnMgCiAgICAvLyBTZXQgdGhlIGNyeXB0byBqaW5nbGVzIGNvbnRyYWN0IGNhbiAKICAgIGZ1bmN0aW9uIHNldENyeXB0b0ppbmdsZXNDb250cmFjdChhZGRyZXNzIF9jcnlwdG9KaW5nbGVzKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKGNyeXB0b0ppbmdsZXMgPT0gMHgwKTsKICAgICAgICAKICAgICAgICBjcnlwdG9KaW5nbGVzID0gX2NyeXB0b0ppbmdsZXM7CiAgICB9Cn0KCmNvbnRyYWN0IENyeXB0b0ppbmdsZXMgaXMgT3duYWJsZSB7CiAgICAKICAgIHN0cnVjdCBQdXJjaGFzZSB7CiAgICAgICAgYWRkcmVzcyB1c2VyOwogICAgICAgIHVpbnQgYmxvY2tOdW1iZXI7CiAgICAgICAgYm9vbCByZXZlYWxlZDsKICAgICAgICB1aW50IG51bVNhbXBsZXM7CiAgICAgICAgYm9vbCBleGlzdHM7CiAgICB9CiAgICAKICAgIGV2ZW50IFB1cmNoYXNlZChhZGRyZXNzIGluZGV4ZWQgdXNlciwgdWludCBibG9ja051bWJlciwgdWludCBudW1KaW5nbGVzLCB1aW50IG51bU9mUHVyY2hhc2VzKTsKICAgIGV2ZW50IEppbmdsZXNPcGVuZWQoYWRkcmVzcyBieVdob20sIGFkZHJlc3MgamluZ2xlT3duZXIsIHVpbnQgY3VyckJsb2NrTnVtYmVyKTsKICAgIAogICAgbWFwcGluZyAodWludCA9PiBib29sKSBwdWJsaWMgaXNBbHJlYWR5VXNlZDsKICAgIAogICAgbWFwcGluZyhhZGRyZXNzID0+IHN0cmluZykgcHVibGljIGF1dGhvcnM7CgogICAgdWludCBudW1PZlB1cmNoYXNlczsKICAgIAogICAgdWludCBNQVhfU0FNUExFU19QRVJfUFVSQ0hBU0UgPSAxNTsKICAgIHVpbnQgU0FNUExFX1BSSUNFID0gMTAgKiogMTU7CiAgICB1aW50IFNBTVBMRVNfUEVSX0pJTkdMRSA9IDU7CiAgICB1aW50IE5VTV9TQU1QTEVfUkFOR0UgPSAxMDAwOwogICAgCiAgICBTYW1wbGUgcHVibGljIHNhbXBsZUNvbnRyYWN0OwogICAgSmluZ2xlIHB1YmxpYyBqaW5nbGVDb250cmFjdDsKICAgIAogICAgZnVuY3Rpb24gQ3J5cHRvSmluZ2xlcyhhZGRyZXNzIF9zYW1wbGUsIGFkZHJlc3MgX2ppbmdsZSkgcHVibGljIHsKICAgICAgICBudW1PZlB1cmNoYXNlcyA9IDA7CiAgICAgICAgc2FtcGxlQ29udHJhY3QgPSBTYW1wbGUoX3NhbXBsZSk7CiAgICAgICAgamluZ2xlQ29udHJhY3QgPSBKaW5nbGUoX2ppbmdsZSk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGJ1eVNhbXBsZXModWludCBfbnVtU2FtcGxlcywgYWRkcmVzcyBfdG8pIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKF9udW1TYW1wbGVzIDw9IE1BWF9TQU1QTEVTX1BFUl9QVVJDSEFTRSk7CiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPj0gKFNBTVBMRV9QUklDRSAqIF9udW1TYW1wbGVzKSk7CiAgICAgICAgCiAgICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IF9udW1TYW1wbGVzOyArK2kpIHsKICAgICAgICAgICAgCiAgICAgICAgICAgIGJ5dGVzMzIgYmxvY2tIYXNoID0gYmxvY2suYmxvY2toYXNoKGJsb2NrLm51bWJlciAtIDEpOwogICAgICAgICAgICAKICAgICAgICAgICAgdWludCByYW5kb21OdW0gPSByYW5kb21HZW4oYmxvY2tIYXNoLCBpKTsKICAgICAgICAgICAgc2FtcGxlQ29udHJhY3QubWludChfdG8sIHJhbmRvbU51bSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIFB1cmNoYXNlZChfdG8sIGJsb2NrLm51bWJlciwgX251bVNhbXBsZXMsIG51bU9mUHVyY2hhc2VzKTsKICAgICAgICAKICAgICAgICBudW1PZlB1cmNoYXNlcysrOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBjb21wb3NlSmluZ2xlKHN0cmluZyBuYW1lLCB1aW50WzVdIHNhbXBsZXMpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShqaW5nbGVDb250cmFjdC51bmlxdWVKaW5nbGVzKGtlY2NhazI1NihzYW1wbGVzKSkgPT0gZmFsc2UpOwogICAgICAgIAogICAgICAgIC8vY2hlY2sgaWYgeW91IG93biBhbGwgdGhlIDUgc2FtcGxlcyAKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBTQU1QTEVTX1BFUl9KSU5HTEU7ICsraSkgewogICAgICAgICAgICBib29sIGlzT3duZXIgPSBzYW1wbGVDb250cmFjdC5pc1Rva2VuT3duZXIoc2FtcGxlc1tpXSwgbXNnLnNlbmRlcik7CiAgICAgICAgICAgIAogICAgICAgICAgICByZXF1aXJlKGlzT3duZXIgPT0gdHJ1ZSAmJiBpc0FscmVhZHlVc2VkW3NhbXBsZXNbaV1dID09IGZhbHNlKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlzQWxyZWFkeVVzZWRbc2FtcGxlc1tpXV0gPSB0cnVlOwogICAgICAgIH0KICAgICAgICAKICAgICAgICB1aW50WzVdIG1lbW9yeSBzYW1wbGVUeXBlczsKICAgICAgICAKICAgICAgICAvLyByZW1vdmUgYWxsIHRoZSBzYW1wbGVzIGZyb20geW91ciBPd25lcnNoaXAKICAgICAgICBmb3IgKHVpbnQgaiA9IDA7IGogPCBTQU1QTEVTX1BFUl9KSU5HTEU7ICsraikgewogICAgICAgICAgICBzYW1wbGVUeXBlc1tqXSA9IHNhbXBsZUNvbnRyYWN0LnRva2VuVHlwZShzYW1wbGVzW2pdKTsKICAgICAgICAgICAgc2FtcGxlQ29udHJhY3QucmVtb3ZlU2FtcGxlKG1zZy5zZW5kZXIsIHNhbXBsZXNbal0pOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvL2NyZWF0ZSBhIG5ldyBqaW5nbGUgY29udGFpbmluZyB0aG9zZSA1IHNhbXBsZXMKICAgICAgICBqaW5nbGVDb250cmFjdC5jb21wb3NlSmluZ2xlKG1zZy5zZW5kZXIsIHNhbXBsZXMsIHNhbXBsZVR5cGVzLCBuYW1lLCBhdXRob3JzW21zZy5zZW5kZXJdKTsKICAgIH0KICAgIAogICAgLy8gQWRkcmVzc2VzIGNhbiBzZXQgdGhlaXIgbmFtZSB3aGVuIGNvbXBvc2luZyBqaW5nbGVzCiAgICBmdW5jdGlvbiBzZXRBdXRob3JOYW1lKHN0cmluZyBfbmFtZSkgcHVibGljIHsKICAgICAgICBhdXRob3JzW21zZy5zZW5kZXJdID0gX25hbWU7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHJhbmRvbUdlbihieXRlczMyIGJsb2NrSGFzaCwgdWludCBzZWVkKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludCByYW5kb21OdW1iZXIpIHsKICAgICAgICByZXR1cm4gKHVpbnQoa2VjY2FrMjU2KGJsb2NrSGFzaCwgYmxvY2sudGltZXN0YW1wLCBudW1PZlB1cmNoYXNlcywgc2VlZCApKSAlIE5VTV9TQU1QTEVfUkFOR0UpOwogICAgfQogICAgCiAgICAvLyBUaGUgb25seSBldGhlciBrZXB0IG9uIHRoaXMgY29udHJhY3QgYXJlIG93bmVyIG1vbmV5IGZvciBzYW1wbGVzCiAgICBmdW5jdGlvbiB3aXRoZHJhdyh1aW50IF9hbW91bnQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoX2Ftb3VudCA8PSB0aGlzLmJhbGFuY2UpOwogICAgICAgIAogICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoX2Ftb3VudCk7CiAgICB9CiAgICAKfQoKY29udHJhY3QgTWFya2V0cGxhY2UgaXMgT3duYWJsZSB7CiAgICAKICAgIG1vZGlmaWVyIG9ubHlKaW5nbGUoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkZHJlc3MoamluZ2xlQ29udHJhY3QpKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICBzdHJ1Y3QgT3JkZXIgewogICAgICAgIHVpbnQgcHJpY2U7CiAgICAgICAgYWRkcmVzcyBzZWxsZXI7CiAgICAgICAgdWludCB0aW1lc3RhbXA7CiAgICAgICAgYm9vbCBleGlzdHM7CiAgICB9CiAgICAKICAgIGV2ZW50IFNlbGxPcmRlcihhZGRyZXNzIG93bmVyLCB1aW50IGppbmdsZUlkLCB1aW50IHByaWNlKTsKICAgIGV2ZW50IEJvdWdodCh1aW50IGppbmdsZUlkLCBhZGRyZXNzIGJ1eWVyLCB1aW50IHByaWNlKTsKICAgIGV2ZW50IENhbmNlbGVkKGFkZHJlc3Mgb3duZXIsIHVpbnQgamluZ2xlSWQpOwogICAgCiAgICB1aW50IHB1YmxpYyBudW1PcmRlcnM7CiAgICB1aW50IHB1YmxpYyBvd25lckJhbGFuY2U7CiAgICAKICAgIHVpbnQgT1dORVJTX0NVVCA9IDM7IC8vIDMgcGVyY2VudCBvZiBldmVyeSBzYWxlIGdvZXMgdG8gb3duZXIKICAgIAogICAgbWFwcGluZyAodWludCA9PiBPcmRlcikgcHVibGljIHNlbGxPcmRlcnM7CiAgICBtYXBwaW5nKHVpbnQgPT4gdWludCkgcHVibGljIHBvc2l0aW9uT2ZKaW5nbGU7CiAgICAKICAgIHVpbnRbXSBwdWJsaWMgamluZ2xlc09uU2FsZTsKICAgIAogICAgSmluZ2xlIHB1YmxpYyBqaW5nbGVDb250cmFjdDsKICAgIAogICAgZnVuY3Rpb24gTWFya2V0cGxhY2UoYWRkcmVzcyBfamluZ2xlKSBwdWJsaWMgewogICAgICAgIGppbmdsZUNvbnRyYWN0ID0gSmluZ2xlKF9qaW5nbGUpOwogICAgICAgIG93bmVyQmFsYW5jZSA9IDA7CiAgICB9CgogICAgZnVuY3Rpb24gc2VsbChhZGRyZXNzIF9vd25lciwgdWludCBfamluZ2xlSWQsIHVpbnQgX2Ftb3VudCkgcHVibGljIG9ubHlKaW5nbGUgewogICAgICAgIHJlcXVpcmUoX2Ftb3VudCA+IDEwMCk7CiAgICAgICAgcmVxdWlyZShzZWxsT3JkZXJzW19qaW5nbGVJZF0uZXhpc3RzID09IGZhbHNlKTsKICAgICAgICAKICAgICAgICBzZWxsT3JkZXJzW19qaW5nbGVJZF0gPSBPcmRlcih7CiAgICAgICAgICAgcHJpY2U6IF9hbW91bnQsCiAgICAgICAgICAgc2VsbGVyOiBfb3duZXIsCiAgICAgICAgICAgdGltZXN0YW1wOiBub3csCiAgICAgICAgICAgZXhpc3RzOiB0cnVlCiAgICAgICAgfSk7CiAgICAgICAgCiAgICAgICAgbnVtT3JkZXJzKys7CiAgICAgICAgCiAgICAgICAgLy8gc2V0IGZvciBpdGVyYXRpbmcKICAgICAgICBqaW5nbGVzT25TYWxlLnB1c2goX2ppbmdsZUlkKTsKICAgICAgICBwb3NpdGlvbk9mSmluZ2xlW19qaW5nbGVJZF0gPSBqaW5nbGVzT25TYWxlLmxlbmd0aCAtIDE7CiAgICAgICAgCiAgICAgICAgLy90cmFuc2ZlciBvd25lcnNoaXAgCiAgICAgICAgamluZ2xlQ29udHJhY3QudHJhbnNmZXJGcm9tKF9vd25lciwgdGhpcywgX2ppbmdsZUlkKTsKICAgICAgICAKICAgICAgICAvL0ZpcmUgYW4gc2VsbCBldmVudAogICAgICAgIFNlbGxPcmRlcihfb3duZXIsIF9qaW5nbGVJZCwgX2Ftb3VudCk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGJ1eSh1aW50IF9qaW5nbGVJZCkgcHVibGljIHBheWFibGUgewogICAgICAgIHJlcXVpcmUoc2VsbE9yZGVyc1tfamluZ2xlSWRdLmV4aXN0cyA9PSB0cnVlKTsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSBzZWxsT3JkZXJzW19qaW5nbGVJZF0ucHJpY2UpOwogICAgICAgIAogICAgICAgIHNlbGxPcmRlcnNbX2ppbmdsZUlkXS5leGlzdHMgPSBmYWxzZTsKICAgICAgICAKICAgICAgICBudW1PcmRlcnMtLTsKICAgICAgICAKICAgICAgICAvL2RlbGV0ZSBzdHVmZiBmb3IgaXRlcmF0aW5nIAogICAgICAgIHJlbW92ZU9yZGVyKF9qaW5nbGVJZCk7CiAgICAgICAgCiAgICAgICAgLy90cmFuc2ZlciBvd25lcnNoaXAgCiAgICAgICAgamluZ2xlQ29udHJhY3QudHJhbnNmZXIobXNnLnNlbmRlciwgX2ppbmdsZUlkKTsKICAgICAgICAKICAgICAgICAvLyB0cmFuc2ZlciBtb25leSB0byBzZWxsZXIKICAgICAgICB1aW50IHByaWNlID0gc2VsbE9yZGVyc1tfamluZ2xlSWRdLnByaWNlOwogICAgICAgIAogICAgICAgIHVpbnQgdGhyZWVQZXJjZW50ID0gKHByaWNlIC8gMTAwKSAqIE9XTkVSU19DVVQ7CiAgICAgICAgCiAgICAgICAgc2VsbE9yZGVyc1tfamluZ2xlSWRdLnNlbGxlci50cmFuc2ZlcihwcmljZSAtIHRocmVlUGVyY2VudCk7CiAgICAgICAgCiAgICAgICAgb3duZXJCYWxhbmNlICs9IHRocmVlUGVyY2VudDsKICAgICAgICAKICAgICAgICAvL2ZpcmUgYW5kIGV2ZW50CiAgICAgICAgQm91Z2h0KF9qaW5nbGVJZCwgbXNnLnNlbmRlciwgbXNnLnZhbHVlKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gY2FuY2VsKHVpbnQgX2ppbmdsZUlkKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoc2VsbE9yZGVyc1tfamluZ2xlSWRdLmV4aXN0cyA9PSB0cnVlKTsKICAgICAgICByZXF1aXJlKHNlbGxPcmRlcnNbX2ppbmdsZUlkXS5zZWxsZXIgPT0gbXNnLnNlbmRlcik7CiAgICAgICAgCiAgICAgICAgc2VsbE9yZGVyc1tfamluZ2xlSWRdLmV4aXN0cyA9IGZhbHNlOwogICAgICAgIAogICAgICAgIG51bU9yZGVycy0tOwogICAgICAgIAogICAgICAgIC8vZGVsZXRlIHN0dWZmIGZvciBpdGVyYXRpbmcgCiAgICAgICAgcmVtb3ZlT3JkZXIoX2ppbmdsZUlkKTsKICAgICAgICAKICAgICAgICBqaW5nbGVDb250cmFjdC50cmFuc2Zlcihtc2cuc2VuZGVyLCBfamluZ2xlSWQpOwogICAgICAgIAogICAgICAgIC8vZmlyZSBhbmQgZXZlbnQKICAgICAgICBDYW5jZWxlZChtc2cuc2VuZGVyLCBfamluZ2xlSWQpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiByZW1vdmVPcmRlcih1aW50IF9qaW5nbGVJZCkgaW50ZXJuYWwgewogICAgICAgIHVpbnQgbGVuZ3RoID0gamluZ2xlc09uU2FsZS5sZW5ndGg7CiAgICAgICAgdWludCBpbmRleCA9IHBvc2l0aW9uT2ZKaW5nbGVbX2ppbmdsZUlkXTsKICAgICAgICB1aW50IGxhc3RPbmUgPSBqaW5nbGVzT25TYWxlW2xlbmd0aCAtIDFdOwoKICAgICAgICBqaW5nbGVzT25TYWxlW2luZGV4XSA9IGxhc3RPbmU7CiAgICAgICAgcG9zaXRpb25PZkppbmdsZVtsYXN0T25lXSA9IGluZGV4OwoKICAgICAgICBkZWxldGUgamluZ2xlc09uU2FsZVtsZW5ndGggLSAxXTsKICAgICAgICBqaW5nbGVzT25TYWxlLmxlbmd0aC0tOwogICAgfQogICAgCiAgICAvL093bmVycyBmdW5jdGlvbnMgCiAgICBmdW5jdGlvbiB3aXRoZHJhdyh1aW50IF9hbW91bnQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoX2Ftb3VudCA8PSBvd25lckJhbGFuY2UpOwogICAgICAgIAogICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoX2Ftb3VudCk7CiAgICB9CiAgICAKfQ=='.
	

]
