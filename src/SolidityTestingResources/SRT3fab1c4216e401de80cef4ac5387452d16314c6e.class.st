Class {
	#name : #SRT3fab1c4216e401de80cef4ac5387452d16314c6e,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT3fab1c4216e401de80cef4ac5387452d16314c6e >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKioKICogQHRpdGxlIEVSQzcyMSBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL2VpcHMvaXNzdWVzLzcyMQogKi8KY29udHJhY3QgRVJDNzIxIHsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfYXBwcm92ZWQsIHVpbnQyNTYgX3Rva2VuSWQpOwoKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgX2JhbGFuY2UpOwogIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBfb3duZXIpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWM7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljOwogIGZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JZCkgcHVibGljOwp9CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CiAgCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgovKioKICogQHRpdGxlIEVSQzcyMVRva2VuCiAqIEdlbmVyaWMgaW1wbGVtZW50YXRpb24gZm9yIHRoZSByZXF1aXJlZCBmdW5jdGlvbmFsaXR5IG9mIHRoZSBFUkM3MjEgc3RhbmRhcmQKICovCmNvbnRyYWN0IEJ1cnJpdG9Ub2tlbiBpcyBFUkM3MjEsIE93bmFibGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAvLyBUb3RhbCBhbW91bnQgb2YgdG9rZW5zCiAgdWludDI1NiBwcml2YXRlIHRvdGFsVG9rZW5zOwogIHVpbnQyNTZbXSBwcml2YXRlIGxpc3RlZDsKICB1aW50MjU2IHB1YmxpYyBkZXZPd2VkOwogIHVpbnQyNTYgcHVibGljIHBvb2xUb3RhbDsKICB1aW50MjU2IHB1YmxpYyBsYXN0UHVyY2hhc2U7CgogIC8vIEJ1cnJpdG8gRGF0YQogIG1hcHBpbmcgKHVpbnQyNTYgPT4gQnVycml0bykgcHVibGljIGJ1cnJpdG9EYXRhOwoKICAvLyBNYXBwaW5nIGZyb20gdG9rZW4gSUQgdG8gb3duZXIKICBtYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIHByaXZhdGUgdG9rZW5Pd25lcjsKCiAgLy8gTWFwcGluZyBmcm9tIHRva2VuIElEIHRvIGFwcHJvdmVkIGFkZHJlc3MKICBtYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIHByaXZhdGUgdG9rZW5BcHByb3ZhbHM7CgogIC8vIE1hcHBpbmcgZnJvbSBvd25lciB0byBsaXN0IG9mIG93bmVkIHRva2VuIElEcwogIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NltdKSBwcml2YXRlIG93bmVkVG9rZW5zOwoKICAvLyBNYXBwaW5nIGZyb20gdG9rZW4gSUQgdG8gaW5kZXggb2YgdGhlIG93bmVyIHRva2VucyBsaXN0CiAgbWFwcGluZyh1aW50MjU2ID0+IHVpbnQyNTYpIHByaXZhdGUgb3duZWRUb2tlbnNJbmRleDsKCiAgLy8gQmFsYW5jZXMgZnJvbSAlIHBheW91dHMuCiAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwcml2YXRlIHBheW91dEJhbGFuY2VzOyAKCiAgLy8gRXZlbnRzCiAgZXZlbnQgQnVycml0b1B1cmNoYXNlZCh1aW50MjU2IGluZGV4ZWQgX3Rva2VuSWQsIGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIHVpbnQyNTYgX3B1cmNoYXNlUHJpY2UpOwoKICAvLyBQdXJjaGFzaW5nIENhcHMgZm9yIERldGVybWluaW5nIE5leHQgUG9vbCBDdXQKICB1aW50MjU2IHByaXZhdGUgZmlyc3RDYXAgID0gMC41IGV0aGVyOwogIHVpbnQyNTYgcHJpdmF0ZSBzZWNvbmRDYXAgPSAxLjAgZXRoZXI7CiAgdWludDI1NiBwcml2YXRlIHRoaXJkQ2FwICA9IDMuMCBldGhlcjsKICB1aW50MjU2IHByaXZhdGUgZmluYWxDYXAgID0gNS4wIGV0aGVyOwoKICAvLyBEZXYKICB1aW50MjU2IHB1YmxpYyBkZXZDdXRQZXJjZW50YWdlID0gNDsKCiAgLy8gU3RydWN0IHRvIHN0b3JlIEJ1cnJpdG8gRGF0YQogIHN0cnVjdCBCdXJyaXRvIHsKICAgICAgdWludDI1NiBzdGFydGluZ1ByaWNlOyAvLyBQcmljZSB0aGUgaXRlbSBzdGFydGVkIGF0LgogICAgICB1aW50MjU2IHByaWNlOyAgICAgICAgIC8vIEN1cnJlbnQgcHJpY2Ugb2YgdGhlIGl0ZW0uCiAgICAgIHVpbnQyNTYgbGFzdFByaWNlOyAgICAgLy8gbGFzdFByaWNlIHRoaXMgd2FzIHNvbGQgZm9yLCB1c2VkIGZvciBhZGRpbmcgdG8gcG9vbC4KICAgICAgdWludDI1NiBwYXlvdXQ7ICAgICAgICAvLyBUaGUgcGVyY2VudCBvZiB0aGUgcG9vbCByZXdhcmRlZC4KICAgICAgdWludDI1NiB3aXRoZHJhd247ICAgICAvLyBUaGUgYW1vdW50IG9mIEV0aCB0aGlzIGJ1cnJpdG8gaGFzIHdpdGhkcmF3biBmcm9tIHRoZSBwb29sLgogICAgICBhZGRyZXNzIG93bmVyOyAgICAgICAgIC8vIEN1cnJlbnQgb3duZXIgb2YgdGhlIGl0ZW0uCiAgfQoKICAvKioKICAqIEBkZXYgY3JlYXRlTGlzdGluZyBBZGRzIG5ldyBFUkM3MjEgVG9rZW4KICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIG5ldyB0b2tlbgogICogQHBhcmFtIF9zdGFydGluZ1ByaWNlIHVpbnQyNTYgc3RhcnRpbmcgcHJpY2UgaW4gd2VpCiAgKiBAcGFyYW0gX3BheW91dFBlcmNlbnRhZ2UgdWludDI1NiBwYXlvdXQgcGVyY2VudGFnZSAoZGl2aXNpYmxlIGJ5IDEwKQogICogQHBhcmFtIF9vd25lciBhZGRyZXNzIG9mIG5ldyBvd25lcgogICovCiAgZnVuY3Rpb24gY3JlYXRlTGlzdGluZyh1aW50MjU2IF90b2tlbklkLCB1aW50MjU2IF9zdGFydGluZ1ByaWNlLCB1aW50MjU2IF9wYXlvdXRQZXJjZW50YWdlLCBhZGRyZXNzIF9vd25lcikgb25seU93bmVyKCkgcHVibGljIHsKCiAgICAvLyBtYWtlIHN1cmUgcHJpY2UgPiAwCiAgICByZXF1aXJlKF9zdGFydGluZ1ByaWNlID4gMCk7CiAgICAvLyBtYWtlIHN1cmUgdG9rZW4gaGFzbid0IGJlZW4gdXNlZCB5ZXQKICAgIHJlcXVpcmUoYnVycml0b0RhdGFbX3Rva2VuSWRdLnByaWNlID09IDApOwogICAgCiAgICAvLyBjcmVhdGUgbmV3IHRva2VuCiAgICBCdXJyaXRvIHN0b3JhZ2UgbmV3QnVycml0byA9IGJ1cnJpdG9EYXRhW190b2tlbklkXTsKCiAgICBuZXdCdXJyaXRvLm93bmVyID0gX293bmVyOwogICAgbmV3QnVycml0by5wcmljZSA9IGdldE5leHRQcmljZShfc3RhcnRpbmdQcmljZSk7CiAgICBuZXdCdXJyaXRvLmxhc3RQcmljZSA9IF9zdGFydGluZ1ByaWNlOwogICAgbmV3QnVycml0by5wYXlvdXQgPSBfcGF5b3V0UGVyY2VudGFnZTsKICAgIG5ld0J1cnJpdG8uc3RhcnRpbmdQcmljZSA9IF9zdGFydGluZ1ByaWNlOwoKICAgIC8vIHN0b3JlIGJ1cnJpdG8gaW4gc3RvcmFnZQogICAgbGlzdGVkLnB1c2goX3Rva2VuSWQpOwogICAgCiAgICAvLyBtaW50IG5ldyB0b2tlbgogICAgX21pbnQoX293bmVyLCBfdG9rZW5JZCk7CiAgfQoKICBmdW5jdGlvbiBjcmVhdGVNdWx0aXBsZSAodWludDI1NltdIF9pdGVtSWRzLCB1aW50MjU2W10gX3ByaWNlcywgdWludDI1NltdIF9wYXlvdXRzLCBhZGRyZXNzW10gX293bmVycykgb25seU93bmVyKCkgZXh0ZXJuYWwgewogICAgZm9yICh1aW50MjU2IGkgPSAwOyBpIDwgX2l0ZW1JZHMubGVuZ3RoOyBpKyspIHsKICAgICAgY3JlYXRlTGlzdGluZyhfaXRlbUlkc1tpXSwgX3ByaWNlc1tpXSwgX3BheW91dHNbaV0sIF9vd25lcnNbaV0pOwogICAgfQogIH0KCiAgLyoqCiAgKiBAZGV2IERldGVybWluZXMgbmV4dCBwcmljZSBvZiB0b2tlbgogICogQHBhcmFtIF9wcmljZSB1aW50MjU2IElEIG9mIGN1cnJlbnQgcHJpY2UKICAqLwogIGZ1bmN0aW9uIGdldE5leHRQcmljZSAodWludDI1NiBfcHJpY2UpIHByaXZhdGUgdmlldyByZXR1cm5zICh1aW50MjU2IF9uZXh0UHJpY2UpIHsKICAgIGlmIChfcHJpY2UgPCBmaXJzdENhcCkgewogICAgICByZXR1cm4gX3ByaWNlLm11bCgyMDApLmRpdig5NSk7CiAgICB9IGVsc2UgaWYgKF9wcmljZSA8IHNlY29uZENhcCkgewogICAgICByZXR1cm4gX3ByaWNlLm11bCgxMzUpLmRpdig5Nik7CiAgICB9IGVsc2UgaWYgKF9wcmljZSA8IHRoaXJkQ2FwKSB7CiAgICAgIHJldHVybiBfcHJpY2UubXVsKDEyNSkuZGl2KDk3KTsKICAgIH0gZWxzZSBpZiAoX3ByaWNlIDwgZmluYWxDYXApIHsKICAgICAgcmV0dXJuIF9wcmljZS5tdWwoMTE3KS5kaXYoOTcpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIF9wcmljZS5tdWwoMTE1KS5kaXYoOTgpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gY2FsY3VsYXRlUG9vbEN1dCAodWludDI1NiBfcHJpY2UpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgX3Bvb2xDdXQpIHsKICAgIGlmIChfcHJpY2UgPCBmaXJzdENhcCkgewogICAgICByZXR1cm4gX3ByaWNlLm11bCgxMCkuZGl2KDEwMCk7IC8vIDUlCiAgICB9IGVsc2UgaWYgKF9wcmljZSA8IHNlY29uZENhcCkgewogICAgICByZXR1cm4gX3ByaWNlLm11bCg5KS5kaXYoMTAwKTsgLy8gNCUKICAgIH0gZWxzZSBpZiAoX3ByaWNlIDwgdGhpcmRDYXApIHsKICAgICAgcmV0dXJuIF9wcmljZS5tdWwoOCkuZGl2KDEwMCk7IC8vIDMlCiAgICB9IGVsc2UgaWYgKF9wcmljZSA8IGZpbmFsQ2FwKSB7CiAgICAgIHJldHVybiBfcHJpY2UubXVsKDcpLmRpdigxMDApOyAvLyAzJQogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIF9wcmljZS5tdWwoNSkuZGl2KDEwMCk7IC8vIDIlCiAgICB9CiAgfQoKICAvKioKICAqIEBkZXYgUHVyY2hhc2UgYnVycml0byBmcm9tIHByZXZpb3VzIG93bmVyCiAgKiBAcGFyYW0gX3Rva2VuSWQgdWludDI1NiBvZiB0b2tlbgogICovCiAgZnVuY3Rpb24gcHVyY2hhc2UodWludDI1NiBfdG9rZW5JZCkgcHVibGljIAogICAgcGF5YWJsZQogICAgaXNOb3RDb250cmFjdChtc2cuc2VuZGVyKQogIHsKCiAgICAvLyBnZXQgZGF0YSBmcm9tIHN0b3JhZ2UKICAgIEJ1cnJpdG8gc3RvcmFnZSBidXJyaXRvID0gYnVycml0b0RhdGFbX3Rva2VuSWRdOwogICAgdWludDI1NiBwcmljZSA9IGJ1cnJpdG8ucHJpY2U7CiAgICBhZGRyZXNzIG9sZE93bmVyID0gYnVycml0by5vd25lcjsKICAgIGFkZHJlc3MgbmV3T3duZXIgPSBtc2cuc2VuZGVyOwogICAgdWludDI1NiBleGNlc3MgPSBtc2cudmFsdWUuc3ViKHByaWNlKTsKCiAgICAvLyByZXZlcnQgY2hlY2tzCiAgICByZXF1aXJlKHByaWNlID4gMCk7CiAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSBwcmljZSk7CiAgICByZXF1aXJlKG9sZE93bmVyICE9IG1zZy5zZW5kZXIpOwoKICAgIC8vIENhbGN1bGF0ZSBwb29sIGN1dCBmb3IgdGF4ZXMuCiAgICB1aW50MjU2IHByb2ZpdCA9IHByaWNlLnN1YihidXJyaXRvLmxhc3RQcmljZSk7CiAgICB1aW50MjU2IHBvb2xDdXQgPSBjYWxjdWxhdGVQb29sQ3V0KHByb2ZpdCk7CiAgICBwb29sVG90YWwgKz0gcG9vbEN1dDsKICAgIAogICAgLy8gJSBnb2VzIHRvIGRldmVsb3BlcnMKICAgIHVpbnQyNTYgZGV2Q3V0ID0gcHJpY2UubXVsKGRldkN1dFBlcmNlbnRhZ2UpLmRpdigxMDApOwogICAgZGV2T3dlZCA9IGRldk93ZWQuYWRkKGRldkN1dCk7CgogICAgdHJhbnNmZXJCdXJyaXRvKG9sZE93bmVyLCBuZXdPd25lciwgX3Rva2VuSWQpOwoKICAgIC8vIHNldCBuZXcgcHJpY2VzCiAgICBidXJyaXRvLmxhc3RQcmljZSA9IHByaWNlOwogICAgYnVycml0by5wcmljZSA9IGdldE5leHRQcmljZShwcmljZSk7CgogICAgLy8gcmFpc2UgZXZlbnQKICAgIEJ1cnJpdG9QdXJjaGFzZWQoX3Rva2VuSWQsIG5ld093bmVyLCBwcmljZSk7CgogICAgLy8gVHJhbnNmZXIgcGF5bWVudCB0byBvbGQgb3duZXIgbWludXMgdGhlIGRldmVsb3BlcidzIGFuZCBwb29sJ3MgY3V0LgogICAgb2xkT3duZXIudHJhbnNmZXIocHJpY2Uuc3ViKGRldkN1dC5hZGQocG9vbEN1dCkpKTsKCiAgICAvLyBTZW5kIHJlZnVuZCB0byBvd25lciBpZiBuZWVkZWQKICAgIGlmIChleGNlc3MgPiAwKSB7CiAgICAgIG5ld093bmVyLnRyYW5zZmVyKGV4Y2Vzcyk7CiAgICB9CiAgICAKICAgIC8vIHNldCBsYXN0IHB1cmNoYXNlIHByaWNlIHRvIHN0b3JhZ2UKICAgIGxhc3RQdXJjaGFzZSA9IG5vdzsKCiAgfQoKICAvKioKICAqIEBkZXYgVHJhbnNmZXIgQnVycml0byBmcm9tIFByZXZpb3VzIE93bmVyIHRvIE5ldyBPd25lcgogICogQHBhcmFtIF9mcm9tIHByZXZpb3VzIG93bmVyIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gbmV3IG93bmVyIGFkZHJlc3MKICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIHRva2VuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckJ1cnJpdG8oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIGludGVybmFsIHsKCiAgICAvLyBjaGVjayB0b2tlbiBleGlzdHMKICAgIHJlcXVpcmUodG9rZW5FeGlzdHMoX3Rva2VuSWQpKTsKCiAgICAvLyBtYWtlIHN1cmUgcHJldmlvdXMgb3duZXIgaXMgY29ycmVjdAogICAgcmVxdWlyZShidXJyaXRvRGF0YVtfdG9rZW5JZF0ub3duZXIgPT0gX2Zyb20pOwoKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcyh0aGlzKSk7CgogICAgLy8gcGF5IGFueSB1bnBhaWQgcGF5b3V0cyB0byBwcmV2aW91cyBvd25lciBvZiBidXJyaXRvCiAgICB1cGRhdGVTaW5nbGVQYXlvdXQoX2Zyb20sIF90b2tlbklkKTsKCiAgICAvLyBjbGVhciBhcHByb3ZhbHMgbGlua2VkIHRvIHRoaXMgdG9rZW4KICAgIGNsZWFyQXBwcm92YWwoX2Zyb20sIF90b2tlbklkKTsKCiAgICAvLyByZW1vdmUgdG9rZW4gZnJvbSBwcmV2aW91cyBvd25lcgogICAgcmVtb3ZlVG9rZW4oX2Zyb20sIF90b2tlbklkKTsKCiAgICAvLyB1cGRhdGUgb3duZXIgYW5kIGFkZCB0b2tlbiB0byBuZXcgb3duZXIKICAgIGJ1cnJpdG9EYXRhW190b2tlbklkXS5vd25lciA9IF90bzsKICAgIGFkZFRva2VuKF90bywgX3Rva2VuSWQpOwoKICAgLy9yYWlzZSBldmVudAogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogIH0KCiAgLyoqCiAgKiBAZGV2IFdpdGhkcmF3IGRldidzIGN1dAogICovCiAgZnVuY3Rpb24gd2l0aGRyYXcoKSBvbmx5T3duZXIgcHVibGljIHsKICAgIG93bmVyLnRyYW5zZmVyKGRldk93ZWQpOwogICAgZGV2T3dlZCA9IDA7CiAgfQoKICAvKioKICAqIEBkZXYgVXBkYXRlcyB0aGUgcGF5b3V0IGZvciB0aGUgYnVycml0b3MgdGhlIG93bmVyIGhhcwogICogQHBhcmFtIF9vd25lciBhZGRyZXNzIG9mIHRva2VuIG93bmVyCiAgKi8KICBmdW5jdGlvbiB1cGRhdGVQYXlvdXQoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB7CiAgICB1aW50MjU2W10gbWVtb3J5IGJ1cnJpdG9zID0gb3duZWRUb2tlbnNbX293bmVyXTsKICAgIHVpbnQyNTYgb3dlZDsKICAgIGZvciAodWludDI1NiBpID0gMDsgaSA8IGJ1cnJpdG9zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdWludDI1NiB0b3RhbEJ1cnJpdG9Pd2VkID0gcG9vbFRvdGFsICogYnVycml0b0RhdGFbYnVycml0b3NbaV1dLnBheW91dCAvIDEwMDAwOwogICAgICAgIHVpbnQyNTYgYnVycml0b093ZWQgPSB0b3RhbEJ1cnJpdG9Pd2VkLnN1YihidXJyaXRvRGF0YVtidXJyaXRvc1tpXV0ud2l0aGRyYXduKTsKICAgICAgICBvd2VkICs9IGJ1cnJpdG9Pd2VkOwogICAgICAgIAogICAgICAgIGJ1cnJpdG9EYXRhW2J1cnJpdG9zW2ldXS53aXRoZHJhd24gKz0gYnVycml0b093ZWQ7CiAgICB9CiAgICBwYXlvdXRCYWxhbmNlc1tfb3duZXJdICs9IG93ZWQ7CiAgfQoKICAvKioKICAgKiBAZGV2IFVwZGF0ZSBhIHNpbmdsZSBidXJyaXRvIHBheW91dCBmb3IgdHJhbnNmZXJzLgogICAqIEBwYXJhbSBfb3duZXIgQWRkcmVzcyBvZiB0aGUgb3duZXIgb2YgdGhlIGJ1cnJpdG8uCiAgICogQHBhcmFtIF9pdGVtSWQgVW5pcXVlIElkIG9mIHRoZSB0b2tlbi4KICAqKi8KICBmdW5jdGlvbiB1cGRhdGVTaW5nbGVQYXlvdXQoYWRkcmVzcyBfb3duZXIsIHVpbnQyNTYgX2l0ZW1JZCkgaW50ZXJuYWwgewogICAgdWludDI1NiB0b3RhbEJ1cnJpdG9Pd2VkID0gcG9vbFRvdGFsICogYnVycml0b0RhdGFbX2l0ZW1JZF0ucGF5b3V0IC8gMTAwMDA7CiAgICB1aW50MjU2IGJ1cnJpdG9Pd2VkID0gdG90YWxCdXJyaXRvT3dlZC5zdWIoYnVycml0b0RhdGFbX2l0ZW1JZF0ud2l0aGRyYXduKTsKICAgICAgICAKICAgIGJ1cnJpdG9EYXRhW19pdGVtSWRdLndpdGhkcmF3biArPSBidXJyaXRvT3dlZDsKICAgIHBheW91dEJhbGFuY2VzW19vd25lcl0gKz0gYnVycml0b093ZWQ7CiAgfQoKICAvKioKICAqIEBkZXYgT3duZXIgY2FuIHdpdGhkcmF3IHRoZWlyIGFjY3VtdWxhdGVkIHBheW91dHMKICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBvZiB0b2tlbiBvd25lcgogICovCiAgZnVuY3Rpb24gd2l0aGRyYXdSZW50KGFkZHJlc3MgX293bmVyKSBwdWJsaWMgewogICAgICB1cGRhdGVQYXlvdXQoX293bmVyKTsKICAgICAgdWludDI1NiBwYXlvdXQgPSBwYXlvdXRCYWxhbmNlc1tfb3duZXJdOwogICAgICBwYXlvdXRCYWxhbmNlc1tfb3duZXJdID0gMDsKICAgICAgX293bmVyLnRyYW5zZmVyKHBheW91dCk7CiAgfQoKICBmdW5jdGlvbiBnZXRSZW50T3dlZChhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBvd2VkKSB7CiAgICB1cGRhdGVQYXlvdXQoX293bmVyKTsKICAgIHJldHVybiBwYXlvdXRCYWxhbmNlc1tfb3duZXJdOwogIH0KCiAgLyoqCiAgKiBAZGV2IFJldHVybiBhbGwgYnVycml0byBkYXRhCiAgKiBAcGFyYW0gX3Rva2VuSWQgdWludDI1NiBvZiB0b2tlbgogICovCiAgZnVuY3Rpb24gZ2V0QnVycml0b0RhdGEgKHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsIHZpZXcgCiAgcmV0dXJucyAoYWRkcmVzcyBfb3duZXIsIHVpbnQyNTYgX3N0YXJ0aW5nUHJpY2UsIHVpbnQyNTYgX3ByaWNlLCB1aW50MjU2IF9uZXh0UHJpY2UsIHVpbnQyNTYgX3BheW91dCkgCiAgewogICAgQnVycml0byBtZW1vcnkgYnVycml0byA9IGJ1cnJpdG9EYXRhW190b2tlbklkXTsKICAgIHJldHVybiAoYnVycml0by5vd25lciwgYnVycml0by5zdGFydGluZ1ByaWNlLCBidXJyaXRvLnByaWNlLCBnZXROZXh0UHJpY2UoYnVycml0by5wcmljZSksIGJ1cnJpdG8ucGF5b3V0KTsKICB9CgogIC8qKgogICogQGRldiBEZXRlcm1pbmVzIGlmIHRva2VuIGV4aXN0cyBieSBjaGVja2luZyBpdCdzIHByaWNlCiAgKiBAcGFyYW0gX3Rva2VuSWQgdWludDI1NiBJRCBvZiB0b2tlbgogICovCiAgZnVuY3Rpb24gdG9rZW5FeGlzdHMgKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wgX2V4aXN0cykgewogICAgcmV0dXJuIGJ1cnJpdG9EYXRhW190b2tlbklkXS5wcmljZSA+IDA7CiAgfQoKICAvKioKICAqIEBkZXYgR3VhcmFudGVlcyBtc2cuc2VuZGVyIGlzIG93bmVyIG9mIHRoZSBnaXZlbiB0b2tlbgogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIHZhbGlkYXRlIGl0cyBvd25lcnNoaXAgYmVsb25ncyB0byBtc2cuc2VuZGVyCiAgKi8KICBtb2RpZmllciBvbmx5T3duZXJPZih1aW50MjU2IF90b2tlbklkKSB7CiAgICByZXF1aXJlKG93bmVyT2YoX3Rva2VuSWQpID09IG1zZy5zZW5kZXIpOwogICAgXzsKICB9CgogIC8qKgogICogQGRldiBHdWFyYW50ZWVzIG1zZy5zZW5kZXIgaXMgbm90IGEgY29udHJhY3QKICAqIEBwYXJhbSBfYnV5ZXIgYWRkcmVzcyBvZiBwZXJzb24gYnV5aW5nIGJ1cnJpdG8KICAqLwogIG1vZGlmaWVyIGlzTm90Q29udHJhY3QoYWRkcmVzcyBfYnV5ZXIpIHsKICAgIHVpbnQgc2l6ZTsKICAgIGFzc2VtYmx5IHsgc2l6ZSA6PSBleHRjb2Rlc2l6ZShfYnV5ZXIpIH0KICAgIHJlcXVpcmUoc2l6ZSA9PSAwKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIHRvdGFsIGFtb3VudCBvZiB0b2tlbnMgc3RvcmVkIGJ5IHRoZSBjb250cmFjdAogICogQHJldHVybiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgdG90YWwgYW1vdW50IG9mIHRva2VucwogICovCiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gdG90YWxUb2tlbnM7CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyB0byBxdWVyeSB0aGUgYmFsYW5jZSBvZgogICogQHJldHVybiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcwogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gb3duZWRUb2tlbnNbX293bmVyXS5sZW5ndGg7CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgbGlzdCBvZiB0b2tlbnMgb3duZWQgYnkgYSBnaXZlbiBhZGRyZXNzCiAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRva2VucyBvZgogICogQHJldHVybiB1aW50MjU2W10gcmVwcmVzZW50aW5nIHRoZSBsaXN0IG9mIHRva2VucyBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MKICAqLwogIGZ1bmN0aW9uIHRva2Vuc09mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2W10pIHsKICAgIHJldHVybiBvd25lZFRva2Vuc1tfb3duZXJdOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIG93bmVyIG9mIHRoZSBzcGVjaWZpZWQgdG9rZW4gSUQKICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIHRoZSB0b2tlbiB0byBxdWVyeSB0aGUgb3duZXIgb2YKICAqIEByZXR1cm4gb3duZXIgYWRkcmVzcyBjdXJyZW50bHkgbWFya2VkIGFzIHRoZSBvd25lciBvZiB0aGUgZ2l2ZW4gdG9rZW4gSUQKICAqLwogIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcykgewogICAgYWRkcmVzcyBvd25lciA9IHRva2VuT3duZXJbX3Rva2VuSWRdOwogICAgcmVxdWlyZShvd25lciAhPSBhZGRyZXNzKDApKTsKICAgIHJldHVybiBvd25lcjsKICB9CgogIC8qKgogICAqIEBkZXYgR2V0cyB0aGUgYXBwcm92ZWQgYWRkcmVzcyB0byB0YWtlIG93bmVyc2hpcCBvZiBhIGdpdmVuIHRva2VuIElECiAgICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIHF1ZXJ5IHRoZSBhcHByb3ZhbCBvZgogICAqIEByZXR1cm4gYWRkcmVzcyBjdXJyZW50bHkgYXBwcm92ZWQgdG8gdGFrZSBvd25lcnNoaXAgb2YgdGhlIGdpdmVuIHRva2VuIElECiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZWRGb3IodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcykgewogICAgcmV0dXJuIHRva2VuQXBwcm92YWxzW190b2tlbklkXTsKICB9CgogIC8qKgogICogQGRldiBUcmFuc2ZlcnMgdGhlIG93bmVyc2hpcCBvZiBhIGdpdmVuIHRva2VuIElEIHRvIGFub3RoZXIgYWRkcmVzcwogICogQHBhcmFtIF90byBhZGRyZXNzIHRvIHJlY2VpdmUgdGhlIG93bmVyc2hpcCBvZiB0aGUgZ2l2ZW4gdG9rZW4gSUQKICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIHRoZSB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZAogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBvbmx5T3duZXJPZihfdG9rZW5JZCkgewogICAgY2xlYXJBcHByb3ZhbEFuZFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3Rva2VuSWQpOwogIH0KCiAgLyoqCiAgKiBAZGV2IEFwcHJvdmVzIGFub3RoZXIgYWRkcmVzcyB0byBjbGFpbSBmb3IgdGhlIG93bmVyc2hpcCBvZiB0aGUgZ2l2ZW4gdG9rZW4gSUQKICAqIEBwYXJhbSBfdG8gYWRkcmVzcyB0byBiZSBhcHByb3ZlZCBmb3IgdGhlIGdpdmVuIHRva2VuIElECiAgKiBAcGFyYW0gX3Rva2VuSWQgdWludDI1NiBJRCBvZiB0aGUgdG9rZW4gdG8gYmUgYXBwcm92ZWQKICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBvbmx5T3duZXJPZihfdG9rZW5JZCkgewogICAgYWRkcmVzcyBvd25lciA9IG93bmVyT2YoX3Rva2VuSWQpOwogICAgcmVxdWlyZShfdG8gIT0gb3duZXIpOwogICAgaWYgKGFwcHJvdmVkRm9yKF90b2tlbklkKSAhPSAwIHx8IF90byAhPSAwKSB7CiAgICAgIHRva2VuQXBwcm92YWxzW190b2tlbklkXSA9IF90bzsKICAgICAgQXBwcm92YWwob3duZXIsIF90bywgX3Rva2VuSWQpOwogICAgfQogIH0KCiAgLyoqCiAgKiBAZGV2IENsYWltcyB0aGUgb3duZXJzaGlwIG9mIGEgZ2l2ZW4gdG9rZW4gSUQKICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIHRoZSB0b2tlbiBiZWluZyBjbGFpbWVkIGJ5IHRoZSBtc2cuc2VuZGVyCiAgKi8KICBmdW5jdGlvbiB0YWtlT3duZXJzaGlwKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB7CiAgICByZXF1aXJlKGlzQXBwcm92ZWRGb3IobXNnLnNlbmRlciwgX3Rva2VuSWQpKTsKICAgIGNsZWFyQXBwcm92YWxBbmRUcmFuc2Zlcihvd25lck9mKF90b2tlbklkKSwgbXNnLnNlbmRlciwgX3Rva2VuSWQpOwogIH0KCiAgLyoqCiAgICogQGRldiBUZWxscyB3aGV0aGVyIHRoZSBtc2cuc2VuZGVyIGlzIGFwcHJvdmVkIGZvciB0aGUgZ2l2ZW4gdG9rZW4gSUQgb3Igbm90CiAgICogVGhpcyBmdW5jdGlvbiBpcyBub3QgcHJpdmF0ZSBzbyBpdCBjYW4gYmUgZXh0ZW5kZWQgaW4gZnVydGhlciBpbXBsZW1lbnRhdGlvbnMgbGlrZSB0aGUgb3BlcmF0YWJsZSBFUkM3MjEKICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3Mgb2YgdGhlIG93bmVyIHRvIHF1ZXJ5IHRoZSBhcHByb3ZhbCBvZgogICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIHRoZSB0b2tlbiB0byBxdWVyeSB0aGUgYXBwcm92YWwgb2YKICAgKiBAcmV0dXJuIGJvb2wgd2hldGhlciB0aGUgbXNnLnNlbmRlciBpcyBhcHByb3ZlZCBmb3IgdGhlIGdpdmVuIHRva2VuIElEIG9yIG5vdAogICAqLwogIGZ1bmN0aW9uIGlzQXBwcm92ZWRGb3IoYWRkcmVzcyBfb3duZXIsIHVpbnQyNTYgX3Rva2VuSWQpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIGFwcHJvdmVkRm9yKF90b2tlbklkKSA9PSBfb3duZXI7CiAgfQogIAogIC8qKgogICogQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byBjbGVhciBjdXJyZW50IGFwcHJvdmFsIGFuZCB0cmFuc2ZlciB0aGUgb3duZXJzaGlwIG9mIGEgZ2l2ZW4gdG9rZW4gSUQKICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAqIEBwYXJhbSBfdG8gYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0aGUgdG9rZW4gdG8KICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIHRoZSB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZAogICovCiAgZnVuY3Rpb24gY2xlYXJBcHByb3ZhbEFuZFRyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBpbnRlcm5hbCBpc05vdENvbnRyYWN0KF90bykgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF90byAhPSBvd25lck9mKF90b2tlbklkKSk7CiAgICByZXF1aXJlKG93bmVyT2YoX3Rva2VuSWQpID09IF9mcm9tKTsKCiAgICBjbGVhckFwcHJvdmFsKF9mcm9tLCBfdG9rZW5JZCk7CiAgICB1cGRhdGVTaW5nbGVQYXlvdXQoX2Zyb20sIF90b2tlbklkKTsKICAgIHJlbW92ZVRva2VuKF9mcm9tLCBfdG9rZW5JZCk7CiAgICBhZGRUb2tlbihfdG8sIF90b2tlbklkKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICB9CgogIC8qKgogICogQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byBjbGVhciBjdXJyZW50IGFwcHJvdmFsIG9mIGEgZ2l2ZW4gdG9rZW4gSUQKICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIHRoZSB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZAogICovCiAgZnVuY3Rpb24gY2xlYXJBcHByb3ZhbChhZGRyZXNzIF9vd25lciwgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB7CiAgICByZXF1aXJlKG93bmVyT2YoX3Rva2VuSWQpID09IF9vd25lcik7CiAgICB0b2tlbkFwcHJvdmFsc1tfdG9rZW5JZF0gPSAwOwogICAgQXBwcm92YWwoX293bmVyLCAwLCBfdG9rZW5JZCk7CiAgfQoKCiAgICAvKioKICAqIEBkZXYgTWludCB0b2tlbiBmdW5jdGlvbgogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgb3duIHRoZSBtaW50ZWQgdG9rZW4KICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIHRoZSB0b2tlbiB0byBiZSBtaW50ZWQgYnkgdGhlIG1zZy5zZW5kZXIKICAqLwogIGZ1bmN0aW9uIF9taW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBpbnRlcm5hbCB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIGFkZFRva2VuKF90bywgX3Rva2VuSWQpOwogICAgVHJhbnNmZXIoMHgwLCBfdG8sIF90b2tlbklkKTsKICB9CgogIC8qKgogICogQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byBhZGQgYSB0b2tlbiBJRCB0byB0aGUgbGlzdCBvZiBhIGdpdmVuIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gYWRkcmVzcyByZXByZXNlbnRpbmcgdGhlIG5ldyBvd25lciBvZiB0aGUgZ2l2ZW4gdG9rZW4gSUQKICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIHRoZSB0b2tlbiB0byBiZSBhZGRlZCB0byB0aGUgdG9rZW5zIGxpc3Qgb2YgdGhlIGdpdmVuIGFkZHJlc3MKICAqLwogIGZ1bmN0aW9uIGFkZFRva2VuKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHsKICAgIHJlcXVpcmUodG9rZW5Pd25lcltfdG9rZW5JZF0gPT0gYWRkcmVzcygwKSk7CiAgICB0b2tlbk93bmVyW190b2tlbklkXSA9IF90bzsKICAgIGJ1cnJpdG9EYXRhW190b2tlbklkXS5vd25lciA9IF90bzsKICAgIHVpbnQyNTYgbGVuZ3RoID0gYmFsYW5jZU9mKF90byk7CiAgICBvd25lZFRva2Vuc1tfdG9dLnB1c2goX3Rva2VuSWQpOwogICAgb3duZWRUb2tlbnNJbmRleFtfdG9rZW5JZF0gPSBsZW5ndGg7CiAgICB0b3RhbFRva2VucyA9IHRvdGFsVG9rZW5zLmFkZCgxKTsKICB9CgogIC8qKgogICogQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byByZW1vdmUgYSB0b2tlbiBJRCBmcm9tIHRoZSBsaXN0IG9mIGEgZ2l2ZW4gYWRkcmVzcwogICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgcmVwcmVzZW50aW5nIHRoZSBwcmV2aW91cyBvd25lciBvZiB0aGUgZ2l2ZW4gdG9rZW4gSUQKICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIHRoZSB0b2tlbiB0byBiZSByZW1vdmVkIGZyb20gdGhlIHRva2VucyBsaXN0IG9mIHRoZSBnaXZlbiBhZGRyZXNzCiAgKi8KICBmdW5jdGlvbiByZW1vdmVUb2tlbihhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHsKICAgIHJlcXVpcmUob3duZXJPZihfdG9rZW5JZCkgPT0gX2Zyb20pOwoKICAgIHVpbnQyNTYgdG9rZW5JbmRleCA9IG93bmVkVG9rZW5zSW5kZXhbX3Rva2VuSWRdOwogICAgdWludDI1NiBsYXN0VG9rZW5JbmRleCA9IGJhbGFuY2VPZihfZnJvbSkuc3ViKDEpOwogICAgdWludDI1NiBsYXN0VG9rZW4gPSBvd25lZFRva2Vuc1tfZnJvbV1bbGFzdFRva2VuSW5kZXhdOwoKICAgIHRva2VuT3duZXJbX3Rva2VuSWRdID0gMDsKICAgIG93bmVkVG9rZW5zW19mcm9tXVt0b2tlbkluZGV4XSA9IGxhc3RUb2tlbjsKICAgIG93bmVkVG9rZW5zW19mcm9tXVtsYXN0VG9rZW5JbmRleF0gPSAwOwogICAgLy8gTm90ZSB0aGF0IHRoaXMgd2lsbCBoYW5kbGUgc2luZ2xlLWVsZW1lbnQgYXJyYXlzLiBJbiB0aGF0IGNhc2UsIGJvdGggdG9rZW5JbmRleCBhbmQgbGFzdFRva2VuSW5kZXggYXJlIGdvaW5nIHRvCiAgICAvLyBiZSB6ZXJvLiBUaGVuIHdlIGNhbiBtYWtlIHN1cmUgdGhhdCB3ZSB3aWxsIHJlbW92ZSBfdG9rZW5JZCBmcm9tIHRoZSBvd25lZFRva2VucyBsaXN0IHNpbmNlIHdlIGFyZSBmaXJzdCBzd2FwcGluZwogICAgLy8gdGhlIGxhc3RUb2tlbiB0byB0aGUgZmlyc3QgcG9zaXRpb24sIGFuZCB0aGVuIGRyb3BwaW5nIHRoZSBlbGVtZW50IHBsYWNlZCBpbiB0aGUgbGFzdCBwb3NpdGlvbiBvZiB0aGUgbGlzdAoKICAgIG93bmVkVG9rZW5zW19mcm9tXS5sZW5ndGgtLTsKICAgIG93bmVkVG9rZW5zSW5kZXhbX3Rva2VuSWRdID0gMDsKICAgIG93bmVkVG9rZW5zSW5kZXhbbGFzdFRva2VuXSA9IHRva2VuSW5kZXg7CiAgICB0b3RhbFRva2VucyA9IHRvdGFsVG9rZW5zLnN1YigxKTsKICB9CgogIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgcHVyZSByZXR1cm5zIChzdHJpbmcgX25hbWUpIHsKICAgIHJldHVybiAiQ3J5cHRvQnVycml0by5jbyBCdXJyaXRvIjsKICB9CgogIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyBwdXJlIHJldHVybnMgKHN0cmluZyBfc3ltYm9sKSB7CiAgICByZXR1cm4gIkJVUlJJVE8iOwogIH0KCiAgZnVuY3Rpb24gc2V0RGV2Q3V0UGVyY2VudGFnZSh1aW50MjU2IF9uZXdDdXQpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShfbmV3Q3V0IDw9IDYpOwogICAgcmVxdWlyZShfbmV3Q3V0ID49IDMpOwoKICAgIGRldkN1dFBlcmNlbnRhZ2UgPSBfbmV3Q3V0OwogIH0KfQ=='.
	

]
