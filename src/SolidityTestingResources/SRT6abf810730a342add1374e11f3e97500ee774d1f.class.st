Class {
	#name : #SRT6abf810730a342add1374e11f3e97500ee774d1f,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT6abf810730a342add1374e11f3e97500ee774d1f >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7Cgpjb250cmFjdCBCQ0ZCYXNlIHsKCiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKICAgIGFkZHJlc3MgcHVibGljIGVkaXRvcjsKCiAgICBib29sIHB1YmxpYyBwYXVzZWQgPSBmYWxzZTsKCiAgICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlFZGl0b3IoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGVkaXRvcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRPd25lcihhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0RWRpdG9yKGFkZHJlc3MgbmV3RWRpdG9yKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG5ld0VkaXRvciAhPSBhZGRyZXNzKDApKTsKICAgICAgICBlZGl0b3IgPSBuZXdFZGl0b3I7CiAgICB9CiAgICAKICAgIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICAgICAgcmVxdWlyZSghcGF1c2VkKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICBtb2RpZmllciB3aGVuUGF1c2VkKCkgewogICAgICAgIHJlcXVpcmUocGF1c2VkKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBwYXVzZSgpIG9ubHlPd25lciB3aGVuTm90UGF1c2VkIHB1YmxpYyB7CiAgICAgICAgcGF1c2VkID0gdHJ1ZTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gdW5wYXVzZSgpIG9ubHlPd25lciB3aGVuUGF1c2VkIHB1YmxpYyB7CiAgICAgICAgcGF1c2VkID0gZmFsc2U7CiAgICB9Cn0KCmNvbnRyYWN0IEVSQzcyMSB7CgogICAgLy8gRXZlbnRzCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGluZGV4ZWQgdG9rZW5JZCk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBhcHByb3ZlZCwgdWludDI1NiBpbmRleGVkIHRva2VuSWQpOwoKICAgIC8vIFJlcXVpcmVkCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgdG90YWwpOwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwogICAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzIG93bmVyKTsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGdldEFwcHJvdmVkKHVpbnQgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3MgYXBwcm92ZWQpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWM7CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljOwogICAgZnVuY3Rpb24gaW1wbGVtZW50c0VSQzcyMSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKGJvb2wpOwoKICAgIC8vIE9wdGlvbmFsCiAgICAvLyBmdW5jdGlvbiBuYW1lKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nIG5hbWUpOwogICAgLy8gZnVuY3Rpb24gc3ltYm9sKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nIHN5bWJvbCk7CiAgICAvLyBmdW5jdGlvbiB0b2tlbnNPZk93bmVyKGFkZHJlc3MgX293bmVyKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTZbXSB0b2tlbklkcyk7CiAgICAvLyBmdW5jdGlvbiB0b2tlbk1ldGFkYXRhKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZyBpbmZvVXJsKTsKfQoKY29udHJhY3QgQkNGRGF0YSBpcyBCQ0ZCYXNlLCBFUkM3MjEgewoKICAgIC8vIE1ldGFEYXRhCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IE5BTUUgPSAiQmxvY2tjaGFpbkZvb3RiYWxsIjsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgU1lNQk9MID0gIkJDRiI7CgogICAgc3RydWN0IFBsYXllciB7CgogICAgICAgIC8vIEF0dHJpYnV0ZSByYXRpbmdzCiAgICAgICAgdWludDggb3ZlcmFsbDsKICAgICAgICB1aW50OCBwYWNlOwogICAgICAgIHVpbnQ4IHNob290aW5nOwogICAgICAgIHVpbnQ4IHBhc3Npbmc7CiAgICAgICAgdWludDggZHJpYmJsaW5nOwogICAgICAgIHVpbnQ4IGRlZmVuZGluZzsKICAgICAgICB1aW50OCBwaHlzaWNhbDsKICAgICAgICB1aW50OCBmb3JtOyAvLyBObyBwbGFucyB0byB1c2UgdGhpcyBhdG0gYnV0IG9mZmVycyB1c2VmdWwgZHluYW1pYyBhdHRyaWJ1dGUgLS0gTk9UIHVzZWQgaW4gdjEgb2YgbWF0Y2ggZW5naW5lCgogICAgICAgIC8vIExldmVsIGNvdWxkIGJlIHN0b3JlZCBhcyBhbiBlbnVtIGJ1dCBwbGFpbiBvbCcgdWludCBnaXZlcyB1cyBtb3JlIGZsZXhpYmlsaXR5IHRvIGludHJvZHVjZSBuZXcgbGV2ZWxzIGluIGZ1dHVyZQogICAgICAgIHVpbnQ4IGxldmVsOyAvLyAxID0gU3VwZXJzdGFyLCAyID0gTGVnZW5kLCAzID0gR29sZCwgNCA9IFNpbHZlcgogICAgICAgIGJ5dGVzIHBvc2l0aW9uOyAvLyBTaG9ydGNvZGUgLSBHSywgTEIsIENCLCBSQiwgUlcsIFJNLCBMVywgTE0sIENNLCBDRE0sIENBTSwgU1QKICAgICAgICBzdHJpbmcgbmFtZTsgLy8gRmlyc3QgYW5kIGxhc3QgLSBhcmJpdHJhcnktbGVuZ3RoLCBoZW5jZSBzdHJpbmcgb3ZlciBieXRlczMyCiAgICB9CiAgICAKICAgIHN0cnVjdCBQbGF5ZXJDYXJkIHsKICAgICAgICB1aW50IHBsYXllcklkOyAvLyBSZWZlcmVuY2VzIHRoZSBpbmRleCBvZiBhIHBsYXllciwgaS5lIHBsYXllcnNbcGxheWVySWRdIC0tIHBsYXllcklkID0gMCBpbnZhbGlkIChub24tZXhpc3RhbnQpCiAgICAgICAgYWRkcmVzcyBvd25lcjsKICAgICAgICBhZGRyZXNzIGFwcHJvdmVkRm9yVHJhbnNmZXI7CiAgICAgICAgYm9vbCBpc0ZpcnN0R2VuZXJhdGlvbjsKICAgIH0KICAgIAogICAgLy8gUGxheWVyICsgUGxheWVyQ2FyZHMgRGF0YWJhc2UKICAgIFBsYXllcltdIHB1YmxpYyBwbGF5ZXJzOyAvLyBDZW50cmFsIERCIG9mIHBsYXllciBhdHRyaWJ1dGVzCiAgICBQbGF5ZXJDYXJkW10gcHVibGljIHBsYXllckNhcmRzOwoKICAgIC8vIFV0aWxpdHkgbWFwcGluZ3MgdG8gbWFrZSB0cmFkaW5nIHBsYXllcnMgYW5kIGNoZWNraW5nIG93bmVyc2hpcCBnYXMtZWZmaWNpZW50CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludFtdKSBpbnRlcm5hbCBvd25lclRvQ2FyZHNPd25lZDsKICAgIG1hcHBpbmcodWludCA9PiB1aW50KSBpbnRlcm5hbCBjYXJkSWRUb093bmVyQXJyYXlJbmRleDsKCiAgICAvLyBFeHRlbmRlZCBhdHRyaWJ1dGVzIC0tIGZvciBub3cgdGhlc2UgYXJlIGp1c3QgYW4gaW5kZXhlZCBsaXN0IG9mIHZhbHVlcy4gTWV0YWRhdGEgd2lsbCBkZXNjcmliZSB3aGF0IGVhY2ggaW5kZXggcmVwcmVzZW50cy4KICAgIG1hcHBpbmcodWludCA9PiB1aW50OFtdKSBwdWJsaWMgcGxheWVySWRUb0V4dGVuZGVkQXR0cmlidXRlczsgLy8gRWFjaCBpbmRleCBhIHNpbmdsZSB1bmlxdWUgdmFsdWUgPiAwIGFuZCA8IDEwMAoKICAgIC8vIEVSQzcyMQogICAgLy8gTm90ZTogVGhlIHN0YW5kYXJkIGlzIHN0aWxsIGluIGRyYWZ0IG1vZGUsIHNvIHRoZXNlIGFyZSBiZXN0IGVmZm9ydHMgaW1wbGVtZW50YXRpb24gYmFzZWQKICAgIC8vIG9uIGN1cnJlbnRseSBkaXJlY3Rpb24gb2YgdGhlIGNvbW11bml0eSBhbmQgZXhpc3RpbmcgY29udHJhY3RzIHdoaWNoIHJlc2lkZSBpbiB0aGUgIndpbGQiCiAgICBmdW5jdGlvbiBpbXBsZW1lbnRzRVJDNzIxKCkgcHVibGljIHB1cmUgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBwbGF5ZXJDYXJkcy5sZW5ndGg7CiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gb3duZXJUb0NhcmRzT3duZWRbX293bmVyXS5sZW5ndGg7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QXBwcm92ZWQodWludCBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBhcHByb3ZlZCkgewogICAgICAgIGFwcHJvdmVkID0gcGxheWVyQ2FyZHNbX3Rva2VuSWRdLmFwcHJvdmVkRm9yVHJhbnNmZXI7CiAgICB9CgogICAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzIF9vd25lcikgewogICAgICAgIF9vd25lciA9IHBsYXllckNhcmRzW190b2tlbklkXS5vd25lcjsKICAgICAgICByZXF1aXJlKF9vd25lciAhPSBhZGRyZXNzKDApKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCB7CiAgICAgICAgcmVxdWlyZShvd25zUGxheWVyQ2FyZChtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwogICAgICAgIGFwcHJvdmVGb3JUcmFuc2ZlclRvKF90bywgX3Rva2VuSWQpOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF90bywgX3Rva2VuSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIHdoZW5Ob3RQYXVzZWQgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3ModGhpcykpOwogICAgICAgIHJlcXVpcmUob3duc1BsYXllckNhcmQoX2Zyb20sIF90b2tlbklkKSk7CiAgICAgICAgcmVxdWlyZShpc0FwcHJvdmVkRm9yVHJhbnNmZXJUbyhfdG8sIF90b2tlbklkKSk7CiAgICAgICAgCiAgICAgICAgLy8gQXMgd2UndmUgdmFsaWRhdGUgd2UgY2FuIG5vdyBjYWxsIHRoZSB1bml2ZXJzYWwgdHJhbnNmZXIgbWV0aG9kCiAgICAgICAgdHJhbnNmZXJVbmNvbmRpdGlvbmFsbHkoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcyh0aGlzKSk7CiAgICAgICAgcmVxdWlyZShvd25zUGxheWVyQ2FyZChtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwogICAgCiAgICAgICAgLy8gQXMgd2UndmUgdmFsaWRhdGUgd2UgY2FuIG5vdyBjYWxsIHRoZSB1bml2ZXJzYWwgdHJhbnNmZXIgbWV0aG9kCiAgICAgICAgdHJhbnNmZXJVbmNvbmRpdGlvbmFsbHkobXNnLnNlbmRlciwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gbmFtZSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKHN0cmluZykgewogICAgICAgIHJldHVybiBOQU1FOwogICAgfQoKICAgIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyBwdXJlIHJldHVybnMgKHN0cmluZykgewogICAgICAgIHJldHVybiBTWU1CT0w7CiAgICB9CgogICAgZnVuY3Rpb24gdG9rZW5zT2ZPd25lcihhZGRyZXNzIF9vd25lcikgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2W10gdG9rZW5JZHMpIHsKICAgICAgICByZXR1cm4gb3duZXJUb0NhcmRzT3duZWRbX293bmVyXTsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRDYXJkVG9Pd25lcnNMaXN0KGFkZHJlc3MgX293bmVyLCB1aW50IF9jYXJkSWQpIGludGVybmFsIHsKICAgICAgICBvd25lclRvQ2FyZHNPd25lZFtfb3duZXJdLnB1c2goX2NhcmRJZCk7CiAgICAgICAgY2FyZElkVG9Pd25lckFycmF5SW5kZXhbX2NhcmRJZF0gPSBvd25lclRvQ2FyZHNPd25lZFtfb3duZXJdLmxlbmd0aCAtIDE7CiAgICB9CgogICAgZnVuY3Rpb24gcmVtb3ZlQ2FyZEZyb21Pd25lcnNMaXN0KGFkZHJlc3MgX293bmVyLCB1aW50IF9jYXJkSWQpIGludGVybmFsIHsKICAgICAgICB1aW50IGxlbmd0aCA9IG93bmVyVG9DYXJkc093bmVkW19vd25lcl0ubGVuZ3RoOwogICAgICAgIHVpbnQgaW5kZXggPSBjYXJkSWRUb093bmVyQXJyYXlJbmRleFtfY2FyZElkXTsKICAgICAgICB1aW50IHN3YXBDYXJkID0gb3duZXJUb0NhcmRzT3duZWRbX293bmVyXVtsZW5ndGggLSAxXTsKCiAgICAgICAgb3duZXJUb0NhcmRzT3duZWRbX293bmVyXVtpbmRleF0gPSBzd2FwQ2FyZDsKICAgICAgICBjYXJkSWRUb093bmVyQXJyYXlJbmRleFtzd2FwQ2FyZF0gPSBpbmRleDsKCiAgICAgICAgZGVsZXRlIG93bmVyVG9DYXJkc093bmVkW19vd25lcl1bbGVuZ3RoIC0gMV07CiAgICAgICAgb3duZXJUb0NhcmRzT3duZWRbX293bmVyXS5sZW5ndGgtLTsKICAgIH0KCiAgICAvLyBJbnRlcm5hbCBmdW5jdGlvbiB0byB0cmFuc2ZlciB3aXRob3V0IHByaW9yIHZhbGlkYXRpb24sIHJlcXVpcmVzIGNhbGxlcnMgdG8gcGVyZm9ybSBkdWUtZGlsaWdlbmNlCiAgICBmdW5jdGlvbiB0cmFuc2ZlclVuY29uZGl0aW9uYWxseShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfY2FyZElkKSBpbnRlcm5hbCB7CiAgICAgICAgCiAgICAgICAgaWYgKF9mcm9tICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgLy8gUmVtb3ZlIGZyb20gY3VycmVudCBvd25lciBsaXN0IGZpcnN0LCBvdGhlcndpc2Ugd2UnbGwgZW5kIHVwIHdpdGggaW52YWxpZCBpbmRleGVzCiAgICAgICAgICAgIHBsYXllckNhcmRzW19jYXJkSWRdLmFwcHJvdmVkRm9yVHJhbnNmZXIgPSBhZGRyZXNzKDApOwogICAgICAgICAgICByZW1vdmVDYXJkRnJvbU93bmVyc0xpc3QoX2Zyb20sIF9jYXJkSWQpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwbGF5ZXJDYXJkc1tfY2FyZElkXS5vd25lciA9IF90bzsKICAgICAgICBhZGRDYXJkVG9Pd25lcnNMaXN0KF90bywgX2NhcmRJZCk7CgogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF9jYXJkSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzQXBwcm92ZWRGb3JUcmFuc2ZlclRvKGFkZHJlc3MgX2FwcHJvdmVkLCB1aW50IF9jYXJkSWQpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBwbGF5ZXJDYXJkc1tfY2FyZElkXS5hcHByb3ZlZEZvclRyYW5zZmVyID09IF9hcHByb3ZlZDsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlRm9yVHJhbnNmZXJUbyhhZGRyZXNzIF9hcHByb3ZlZCwgdWludCBfY2FyZElkKSBpbnRlcm5hbCB7CiAgICAgICAgcGxheWVyQ2FyZHNbX2NhcmRJZF0uYXBwcm92ZWRGb3JUcmFuc2ZlciA9IF9hcHByb3ZlZDsKICAgIH0KCiAgICBmdW5jdGlvbiBvd25zUGxheWVyQ2FyZChhZGRyZXNzIF9jYXJkT3duZXIsIHVpbnQgX2NhcmRJZCkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHBsYXllckNhcmRzW19jYXJkSWRdLm93bmVyID09IF9jYXJkT3duZXI7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0UGxheWVyRm9ybSh1aW50IF9wbGF5ZXJJZCwgdWludDggX2Zvcm0pIGV4dGVybmFsIHdoZW5Ob3RQYXVzZWQgb25seUVkaXRvciB7CiAgICAgICAgcmVxdWlyZShwbGF5ZXJzW19wbGF5ZXJJZF0uZm9ybSA+IDApOyAvLyBDaGVjayB0aGUgcGxheWVyIGFuZCBmb3JtIGV4aXN0CiAgICAgICAgcmVxdWlyZShfZm9ybSA+IDAgJiYgX2Zvcm0gPD0gMjAwKTsgLy8gTWF4IHZhbHVlIGlzIHBsYXllcnMgY2FuIGRvdWJsZSB0aGVpciBmb3JtCiAgICAgICAgcGxheWVyc1tfcGxheWVySWRdLmZvcm0gPSBfZm9ybTsKICAgIH0KCiAgICBmdW5jdGlvbiBjcmVhdGVQbGF5ZXJDYXJkKHVpbnQgX3BsYXllcklkLCBhZGRyZXNzIF9uZXdPd25lciwgYm9vbCBpc0ZpcnN0T2ZLaW5kKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmVxdWlyZShfcGxheWVySWQgPiAwKTsgLy8gZGlzYWxsb3cgcGxheWVyIGNhcmRzIGZvciB0aGUgZmlyc3QgY2FyZCAtIFRoaWFnbyBNZXNzaQogICAgICAgIFBsYXllciBzdG9yYWdlIF9wbGF5ZXIgPSBwbGF5ZXJzW19wbGF5ZXJJZF07CiAgICAgICAgcmVxdWlyZShfcGxheWVyLm92ZXJhbGwgPiAwKTsgLy8gTWFrZSBzdXJlIHRoZSBwbGF5ZXIgZXhpc3RzCgogICAgICAgIFBsYXllckNhcmQgbWVtb3J5IF9jYXJkSW5zdGFuY2UgPSBQbGF5ZXJDYXJkKHsKICAgICAgICAgICAgIHBsYXllcklkOiBfcGxheWVySWQsCiAgICAgICAgICAgICBvd25lcjogX25ld093bmVyLAogICAgICAgICAgICAgYXBwcm92ZWRGb3JUcmFuc2ZlcjogYWRkcmVzcygwKSwKICAgICAgICAgICAgIGlzRmlyc3RHZW5lcmF0aW9uOiBpc0ZpcnN0T2ZLaW5kCiAgICAgICAgfSk7CgogICAgICAgIHVpbnQgY2FyZElkID0gcGxheWVyQ2FyZHMucHVzaChfY2FyZEluc3RhbmNlKSAtIDE7CgogICAgICAgIC8vIFdlIHNlbmQgaXQgd2l0aCAweDAgRlJPTSBhZGRyZXNzIHNvIHdlIGRvbid0IHJlZHVjZSB0aGUgdG90YWwgbnVtYmVyIG9mIGNhcmRzIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGFkZHJlc3MgCiAgICAgICAgdHJhbnNmZXJVbmNvbmRpdGlvbmFsbHkoMCwgX25ld093bmVyLCBjYXJkSWQpOwoKICAgICAgICByZXR1cm4gY2FyZElkOwogICAgfQoKICAgIC8vIFB1YmxpYyBGdW5jdGlvbnMgLSBOb24gRVJDNzIxIHNwZWNpZmljCiAgICBmdW5jdGlvbiB0b3RhbFBsYXllckNvdW50KCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50KSB7CiAgICAgICAgcmV0dXJuIHBsYXllcnMubGVuZ3RoOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRQbGF5ZXJGb3JDYXJkKHVpbnQgX2NhcmRJZCkgCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyAoCiAgICAgICAgdWludDggX292ZXJhbGwsCiAgICAgICAgdWludDggX3BhY2UsCiAgICAgICAgdWludDggX3Nob290aW5nLAogICAgICAgIHVpbnQ4IF9wYXNzaW5nLAogICAgICAgIHVpbnQ4IF9kcmliYmxpbmcsCiAgICAgICAgdWludDggX2RlZmVuZGluZywKICAgICAgICB1aW50OCBfcGh5c2ljYWwsCiAgICAgICAgdWludDggX2xldmVsLAogICAgICAgIGJ5dGVzIF9wb3NpdGlvbiwKICAgICAgICBzdHJpbmcgX2Z1bGxOYW1lLAogICAgICAgIHVpbnQ4IF9mb3JtCiAgICApIHsKICAgICAgICAvLyBGZXRjaCB0aGUgY2FyZCBmaXJzdAogICAgICAgIFBsYXllckNhcmQgc3RvcmFnZSBfcGxheWVyQ2FyZCA9IHBsYXllckNhcmRzW19jYXJkSWRdOwogICAgICAgIAogICAgICAgIC8vIFJldHVybiB0aGUgcGxheWVyIHJldHVybmVkIGhlcmUKICAgICAgICAvLyBOT1RFOiBpZiBhbiBpbnZhbGlkIGNhcmQgaXMgc3BlY2lmaWVkIHRoaXMgbWF5IHJldHVybiBpbmRleCAwIHJlc3VsdCAoVGhpYWdvIE1lc3NpKQogICAgICAgIFBsYXllciBzdG9yYWdlIHBsYXllciA9IHBsYXllcnNbX3BsYXllckNhcmQucGxheWVySWRdOwogICAgICAgIF9vdmVyYWxsID0gcGxheWVyLm92ZXJhbGw7CiAgICAgICAgX3BhY2UgPSBwbGF5ZXIucGFjZTsKICAgICAgICBfc2hvb3RpbmcgPSBwbGF5ZXIuc2hvb3Rpbmc7CiAgICAgICAgX3Bhc3NpbmcgPSBwbGF5ZXIucGFzc2luZzsKICAgICAgICBfZHJpYmJsaW5nID0gcGxheWVyLmRyaWJibGluZzsKICAgICAgICBfZGVmZW5kaW5nID0gcGxheWVyLmRlZmVuZGluZzsKICAgICAgICBfcGh5c2ljYWwgPSBwbGF5ZXIucGh5c2ljYWw7CiAgICAgICAgX2xldmVsID0gcGxheWVyLmxldmVsOwogICAgICAgIF9wb3NpdGlvbiA9IHBsYXllci5wb3NpdGlvbjsKICAgICAgICBfZnVsbE5hbWUgPSBwbGF5ZXIubmFtZTsKICAgICAgICBfZm9ybSA9IHBsYXllci5mb3JtOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzT3duZXJPZkFsbFBsYXllckNhcmRzKHVpbnQyNTZbXSBfY2FyZElkcywgYWRkcmVzcyBvd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUob3duZXIgIT0gYWRkcmVzcygwKSk7CgogICAgICAgIC8vIFRoaXMgZnVuY3Rpb24gd2lsbCByZXR1cm4gZWFybHkgaWYgaXQgZmluZHMgYW55IGluc3RhbmNlIG9mIGEgY2FyZElkIG5vdCBvd25lZAogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IF9jYXJkSWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmICghb3duc1BsYXllckNhcmQob3duZXIsIF9jYXJkSWRzW2ldKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBHZXQncyBoZXJlLCBtdXN0IG93biBhbGwgY2FyZElkcwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vIEV4dGVuZGVkIGF0dHJpYnV0ZXMKICAgIGZ1bmN0aW9uIHNldEV4dGVuZGVkUGxheWVyQXR0cmlidXRlc0ZvclBsYXllcih1aW50IHBsYXllcklkLCB1aW50OFtdIGF0dHJpYnV0ZXMpIGV4dGVybmFsIHdoZW5Ob3RQYXVzZWQgb25seUVkaXRvciB7CiAgICAgICAgcmVxdWlyZShwbGF5ZXJJZCA+IDApOwogICAgICAgIHBsYXllcklkVG9FeHRlbmRlZEF0dHJpYnV0ZXNbcGxheWVySWRdID0gYXR0cmlidXRlczsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRFeHRlbmRlZEF0dHJpYnV0ZXNGb3JQbGF5ZXIodWludCBwbGF5ZXJJZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDhbXSkgewogICAgICAgIHJlcXVpcmUocGxheWVySWQgPiAwKTsKICAgICAgICByZXR1cm4gcGxheWVySWRUb0V4dGVuZGVkQXR0cmlidXRlc1twbGF5ZXJJZF07CiAgICB9Cn0KCmNvbnRyYWN0IEJDRkJ1eU1hcmtldCBpcyBCQ0ZEYXRhIHsKCiAgICBhZGRyZXNzIHB1YmxpYyBidXlpbmdFc2Nyb3dBZGRyZXNzOwogICAgYm9vbCBwdWJsaWMgaXNCQ0ZCdXlNYXJrZXQgPSB0cnVlOwoKICAgIGZ1bmN0aW9uIHNldEJ1eWluZ0VzY3Jvd0FkZHJlc3MoYWRkcmVzcyBfYWRkcmVzcykgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICBidXlpbmdFc2Nyb3dBZGRyZXNzID0gX2FkZHJlc3M7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNyZWF0ZUNhcmRGb3JBY3F1aXJlZFBsYXllcih1aW50IHBsYXllcklkLCBhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmVxdWlyZShidXlpbmdFc2Nyb3dBZGRyZXNzICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShidXlpbmdFc2Nyb3dBZGRyZXNzID09IG1zZy5zZW5kZXIpOwogICAgICAgIAogICAgICAgIHVpbnQgY2FyZElkID0gY3JlYXRlUGxheWVyQ2FyZChwbGF5ZXJJZCwgbmV3T3duZXIsIGZhbHNlKTsKCiAgICAgICAgcmV0dXJuIGNhcmRJZDsKICAgIH0KCiAgICBmdW5jdGlvbiBjcmVhdGVDYXJkRm9yQWNxdWlyZWRQbGF5ZXJzKHVpbnRbXSBwbGF5ZXJJZHMsIGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKHVpbnRbXSkgewogICAgICAgIHJlcXVpcmUoYnV5aW5nRXNjcm93QWRkcmVzcyAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoYnV5aW5nRXNjcm93QWRkcmVzcyA9PSBtc2cuc2VuZGVyKTsKCiAgICAgICAgdWludFtdIG1lbW9yeSBjYXJkSWRzID0gbmV3IHVpbnRbXShwbGF5ZXJJZHMubGVuZ3RoKTsKCiAgICAgICAgLy8gQ3JlYXRlIHRoZSBwbGF5ZXJzIGFuZCBzdG9yZSBhbiBhcnJheSBvZiB0aGVpciBJZHMKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBwbGF5ZXJJZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdWludCBjYXJkSWQgPSBjcmVhdGVQbGF5ZXJDYXJkKHBsYXllcklkc1tpXSwgbmV3T3duZXIsIGZhbHNlKTsKICAgICAgICAgICAgY2FyZElkc1tpXSA9IGNhcmRJZDsKICAgICAgICB9CgogICAgICAgIHJldHVybiBjYXJkSWRzOwogICAgfQp9Cgpjb250cmFjdCBPd25hYmxlIHsKCiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgICAvKioKICAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICAqIGFjY291bnQuCiAgICAqLwogICAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKCiAgICAvKioKICAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAgKi8KICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgICAgICBvd25lciA9IG5ld093bmVyOwogIH0KfQoKY29udHJhY3QgUGF1c2FibGUgaXMgT3duYWJsZSB7CiAgICBldmVudCBQYXVzZSgpOwogICAgZXZlbnQgVW5wYXVzZSgpOwoKICAgIGJvb2wgcHVibGljIHBhdXNlZCA9IGZhbHNlOwoKICAgIC8qKgogICAgKiBAZGV2IG1vZGlmaWVyIHRvIGFsbG93IGFjdGlvbnMgb25seSB3aGVuIHRoZSBjb250cmFjdCBJUyBwYXVzZWQKICAgICovCiAgICBtb2RpZmllciB3aGVuTm90UGF1c2VkKCkgewogICAgICAgIHJlcXVpcmUoIXBhdXNlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBtb2RpZmllciB0byBhbGxvdyBhY3Rpb25zIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgSVMgTk9UIHBhdXNlZAogICAgKi8KICAgIG1vZGlmaWVyIHdoZW5QYXVzZWQgewogICAgICAgIHJlcXVpcmUocGF1c2VkKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gcGF1c2UsIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUKICAgICovCiAgICBmdW5jdGlvbiBwYXVzZSgpIG9ubHlPd25lciB3aGVuTm90UGF1c2VkIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcGF1c2VkID0gdHJ1ZTsKICAgICAgICBQYXVzZSgpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gdW5wYXVzZSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgICovCiAgICBmdW5jdGlvbiB1bnBhdXNlKCkgb25seU93bmVyIHdoZW5QYXVzZWQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBwYXVzZWQgPSBmYWxzZTsKICAgICAgICBVbnBhdXNlKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0KCmNvbnRyYWN0IEJDRkF1Y3Rpb24gaXMgUGF1c2FibGUgewoKICAgIHN0cnVjdCBDYXJkQXVjdGlvbiB7CiAgICAgICAgYWRkcmVzcyBzZWxsZXI7CiAgICAgICAgdWludDEyOCBzdGFydFByaWNlOyAvLyBpbiB3ZWkKICAgICAgICB1aW50MTI4IGVuZFByaWNlOwogICAgICAgIHVpbnQ2NCBkdXJhdGlvbjsKICAgICAgICB1aW50NjQgc3RhcnRlZEF0OwogICAgfQoKICAgIC8vIFRvIGxvb2t1cCBvd25lcnMgCiAgICBFUkM3MjEgcHVibGljIGRhdGFTdG9yZTsKICAgIHVpbnQyNTYgcHVibGljIGF1Y3Rpb25lZXJDdXQ7CgogICAgbWFwcGluZyAodWludDI1NiA9PiBDYXJkQXVjdGlvbikgcGxheWVyQ2FyZElkVG9BdWN0aW9uOwoKICAgIGV2ZW50IEF1Y3Rpb25DcmVhdGVkKHVpbnQyNTYgY2FyZElkLCB1aW50MjU2IHN0YXJ0UHJpY2UsIHVpbnQyNTYgZW5kUHJpY2UsIHVpbnQyNTYgZHVyYXRpb24pOwogICAgZXZlbnQgQXVjdGlvblN1Y2Nlc3NmdWwodWludDI1NiBjYXJkSWQsIHVpbnQyNTYgZmluYWxQcmljZSwgYWRkcmVzcyB3aW5uZXIpOwogICAgZXZlbnQgQXVjdGlvbkNhbmNlbGxlZCh1aW50MjU2IGNhcmRJZCk7CgogICAgZnVuY3Rpb24gQkNGQXVjdGlvbihhZGRyZXNzIGRhdGFTdG9yZUFkZHJlc3MsIHVpbnQgY3V0VmFsdWUpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShjdXRWYWx1ZSA8PSAxMDAwMCk7IC8vIDEwMCUgPT0gMTAsMDAwCiAgICAgICAgYXVjdGlvbmVlckN1dCA9IGN1dFZhbHVlOwoKICAgICAgICBFUkM3MjEgY2FuZGlkYXRlRGF0YVN0b3JlQ29udHJhY3QgPSBFUkM3MjEoZGF0YVN0b3JlQWRkcmVzcyk7CiAgICAgICAgcmVxdWlyZShjYW5kaWRhdGVEYXRhU3RvcmVDb250cmFjdC5pbXBsZW1lbnRzRVJDNzIxKCkpOwogICAgICAgIGRhdGFTdG9yZSA9IGNhbmRpZGF0ZURhdGFTdG9yZUNvbnRyYWN0OwogICAgfQoKICAgIGZ1bmN0aW9uIHdpdGhkcmF3QmFsYW5jZSgpIGV4dGVybmFsIHsKICAgICAgICBhZGRyZXNzIHN0b3JhZ2VBZGRyZXNzID0gYWRkcmVzcyhkYXRhU3RvcmUpOwogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lciB8fCBtc2cuc2VuZGVyID09IHN0b3JhZ2VBZGRyZXNzKTsKICAgICAgICBzdG9yYWdlQWRkcmVzcy50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNyZWF0ZUF1Y3Rpb24oCiAgICAgICAgdWludDI1NiBjYXJkSWQsIAogICAgICAgIHVpbnQyNTYgc3RhcnRQcmljZSwgCiAgICAgICAgdWludDI1NiBlbmRQcmljZSwgCiAgICAgICAgdWludDI1NiBkdXJhdGlvbiwgCiAgICAgICAgYWRkcmVzcyBzZWxsZXIKICAgICkKICAgICAgICBleHRlcm5hbAogICAgICAgIHdoZW5Ob3RQYXVzZWQKICAgIHsKICAgICAgICByZXF1aXJlKHN0YXJ0UHJpY2UgPT0gdWludDI1Nih1aW50MTI4KHN0YXJ0UHJpY2UpKSk7CiAgICAgICAgcmVxdWlyZShlbmRQcmljZSA9PSB1aW50MjU2KHVpbnQxMjgoZW5kUHJpY2UpKSk7CiAgICAgICAgcmVxdWlyZShkdXJhdGlvbiA9PSB1aW50MjU2KHVpbnQ2NChkdXJhdGlvbikpKTsKICAgICAgICByZXF1aXJlKHNlbGxlciAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKGFkZHJlc3MoZGF0YVN0b3JlKSAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYWRkcmVzcyhkYXRhU3RvcmUpKTsKCiAgICAgICAgX2VzY3JvdyhzZWxsZXIsIGNhcmRJZCk7CiAgICAgICAgQ2FyZEF1Y3Rpb24gbWVtb3J5IGF1Y3Rpb24gPSBDYXJkQXVjdGlvbigKICAgICAgICAgICAgc2VsbGVyLAogICAgICAgICAgICB1aW50MTI4KHN0YXJ0UHJpY2UpLAogICAgICAgICAgICB1aW50MTI4KGVuZFByaWNlKSwKICAgICAgICAgICAgdWludDY0KGR1cmF0aW9uKSwKICAgICAgICAgICAgdWludDY0KG5vdykKICAgICAgICApOwogICAgICAgIF9hZGRBdWN0aW9uKGNhcmRJZCwgYXVjdGlvbik7CiAgICB9CgogICAgZnVuY3Rpb24gYmlkKHVpbnQyNTYgY2FyZElkKSBleHRlcm5hbCBwYXlhYmxlIHdoZW5Ob3RQYXVzZWQgewogICAgICAgIF9iaWQoY2FyZElkLCBtc2cudmFsdWUpOyAvLyBUaGlzIGZ1bmN0aW9uIGhhbmRsZXMgdmFsaWRhdGlvbiBhbmQgdGhyb3dzCiAgICAgICAgX3RyYW5zZmVyKG1zZy5zZW5kZXIsIGNhcmRJZCk7CiAgICB9CgogICAgZnVuY3Rpb24gY2FuY2VsQXVjdGlvbih1aW50MjU2IGNhcmRJZCkgZXh0ZXJuYWwgewogICAgICAgIENhcmRBdWN0aW9uIHN0b3JhZ2UgYXVjdGlvbiA9IHBsYXllckNhcmRJZFRvQXVjdGlvbltjYXJkSWRdOwogICAgICAgIHJlcXVpcmUoaXNPbkF1Y3Rpb24oYXVjdGlvbikpOwogICAgICAgIGFkZHJlc3Mgc2VsbGVyID0gYXVjdGlvbi5zZWxsZXI7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHNlbGxlcik7CiAgICAgICAgX2NhbmNlbEF1Y3Rpb24oY2FyZElkLCBzZWxsZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEF1Y3Rpb24odWludDI1NiBjYXJkSWQpIGV4dGVybmFsIHZpZXcgcmV0dXJucwogICAgKAogICAgICAgIGFkZHJlc3Mgc2VsbGVyLAogICAgICAgIHVpbnQyNTYgc3RhcnRpbmdQcmljZSwKICAgICAgICB1aW50MjU2IGVuZGluZ1ByaWNlLAogICAgICAgIHVpbnQyNTYgZHVyYXRpb24sCiAgICAgICAgdWludDI1NiBzdGFydGVkQXQKICAgICkgewogICAgICAgIENhcmRBdWN0aW9uIHN0b3JhZ2UgYXVjdGlvbiA9IHBsYXllckNhcmRJZFRvQXVjdGlvbltjYXJkSWRdOwogICAgICAgIHJlcXVpcmUoaXNPbkF1Y3Rpb24oYXVjdGlvbikpOwogICAgICAgIHJldHVybiAoYXVjdGlvbi5zZWxsZXIsIGF1Y3Rpb24uc3RhcnRQcmljZSwgYXVjdGlvbi5lbmRQcmljZSwgYXVjdGlvbi5kdXJhdGlvbiwgYXVjdGlvbi5zdGFydGVkQXQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRQcmljZSh1aW50MjU2IGNhcmRJZCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgQ2FyZEF1Y3Rpb24gc3RvcmFnZSBhdWN0aW9uID0gcGxheWVyQ2FyZElkVG9BdWN0aW9uW2NhcmRJZF07CiAgICAgICAgcmVxdWlyZShpc09uQXVjdGlvbihhdWN0aW9uKSk7CiAgICAgICAgcmV0dXJuIGN1cnJlbnRQcmljZShhdWN0aW9uKTsKICAgIH0KCiAgICAvLyBJbnRlcm5hbCB1dGlsaXR5IGZ1bmN0aW9ucwogICAgZnVuY3Rpb24gb3duc1BsYXllckNhcmQoYWRkcmVzcyBjYXJkT3duZXIsIHVpbnQyNTYgY2FyZElkKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gKGRhdGFTdG9yZS5vd25lck9mKGNhcmRJZCkgPT0gY2FyZE93bmVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfZXNjcm93KGFkZHJlc3Mgb3duZXIsIHVpbnQyNTYgY2FyZElkKSBpbnRlcm5hbCB7CiAgICAgICAgZGF0YVN0b3JlLnRyYW5zZmVyRnJvbShvd25lciwgdGhpcywgY2FyZElkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfdHJhbnNmZXIoYWRkcmVzcyByZWNlaXZlciwgdWludDI1NiBjYXJkSWQpIGludGVybmFsIHsKICAgICAgICBkYXRhU3RvcmUudHJhbnNmZXIocmVjZWl2ZXIsIGNhcmRJZCk7CiAgICB9CgogICAgZnVuY3Rpb24gX2FkZEF1Y3Rpb24odWludDI1NiBjYXJkSWQsIENhcmRBdWN0aW9uIGF1Y3Rpb24pIGludGVybmFsIHsKICAgICAgICByZXF1aXJlKGF1Y3Rpb24uZHVyYXRpb24gPj0gMSBtaW51dGVzICYmIGF1Y3Rpb24uZHVyYXRpb24gPD0gMTQgZGF5cyk7CiAgICAgICAgcGxheWVyQ2FyZElkVG9BdWN0aW9uW2NhcmRJZF0gPSBhdWN0aW9uOwogICAgICAgIEF1Y3Rpb25DcmVhdGVkKGNhcmRJZCwgYXVjdGlvbi5zdGFydFByaWNlLCBhdWN0aW9uLmVuZFByaWNlLCBhdWN0aW9uLmR1cmF0aW9uKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfcmVtb3ZlQXVjdGlvbih1aW50MjU2IGNhcmRJZCkgaW50ZXJuYWwgewogICAgICAgIGRlbGV0ZSBwbGF5ZXJDYXJkSWRUb0F1Y3Rpb25bY2FyZElkXTsKICAgIH0KCiAgICBmdW5jdGlvbiBfY2FuY2VsQXVjdGlvbih1aW50MjU2IGNhcmRJZCwgYWRkcmVzcyBzZWxsZXIpIGludGVybmFsIHsKICAgICAgICBfcmVtb3ZlQXVjdGlvbihjYXJkSWQpOwogICAgICAgIF90cmFuc2ZlcihzZWxsZXIsIGNhcmRJZCk7CiAgICAgICAgQXVjdGlvbkNhbmNlbGxlZChjYXJkSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzT25BdWN0aW9uKENhcmRBdWN0aW9uIHN0b3JhZ2UgYXVjdGlvbikgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIChhdWN0aW9uLnN0YXJ0ZWRBdCA+IDApOwogICAgfQoKICAgIGZ1bmN0aW9uIF9iaWQodWludDI1NiBjYXJkSWQsIHVpbnQyNTYgYmlkQW1vdW50KSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgQ2FyZEF1Y3Rpb24gc3RvcmFnZSBhdWN0aW9uID0gcGxheWVyQ2FyZElkVG9BdWN0aW9uW2NhcmRJZF07CiAgICAgICAgcmVxdWlyZShpc09uQXVjdGlvbihhdWN0aW9uKSk7CgogICAgICAgIHVpbnQyNTYgcHJpY2UgPSBjdXJyZW50UHJpY2UoYXVjdGlvbik7CiAgICAgICAgcmVxdWlyZShiaWRBbW91bnQgPj0gcHJpY2UpOwoKICAgICAgICBhZGRyZXNzIHNlbGxlciA9IGF1Y3Rpb24uc2VsbGVyOwogICAgICAgIF9yZW1vdmVBdWN0aW9uKGNhcmRJZCk7CgogICAgICAgIGlmIChwcmljZSA+IDApIHsKICAgICAgICAgICAgdWludDI1NiBoYW5kbGVyQ3V0ID0gY2FsY3VsYXRlQXVjdGlvbmVlckN1dChwcmljZSk7CiAgICAgICAgICAgIHVpbnQyNTYgc2VsbGVyUHJvY2VlZHMgPSBwcmljZSAtIGhhbmRsZXJDdXQ7CiAgICAgICAgICAgIHNlbGxlci50cmFuc2ZlcihzZWxsZXJQcm9jZWVkcyk7CiAgICAgICAgfSAKCiAgICAgICAgdWludDI1NiBiaWRFeGNlc3MgPSBiaWRBbW91bnQgLSBwcmljZTsKICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKGJpZEV4Y2Vzcyk7CgogICAgICAgIEF1Y3Rpb25TdWNjZXNzZnVsKGNhcmRJZCwgcHJpY2UsIG1zZy5zZW5kZXIpOyAvLyBFbWl0IGV2ZW50L2xvZwoKICAgICAgICByZXR1cm4gcHJpY2U7CiAgICB9CgogICAgZnVuY3Rpb24gY3VycmVudFByaWNlKENhcmRBdWN0aW9uIHN0b3JhZ2UgYXVjdGlvbikgaW50ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBzZWNvbmRzUGFzc2VkID0gMDsKICAgICAgICBpZiAobm93ID4gYXVjdGlvbi5zdGFydGVkQXQpIHsKICAgICAgICAgICAgc2Vjb25kc1Bhc3NlZCA9IG5vdyAtIGF1Y3Rpb24uc3RhcnRlZEF0OwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGNhbGN1bGF0ZUN1cnJlbnRQcmljZShhdWN0aW9uLnN0YXJ0UHJpY2UsIGF1Y3Rpb24uZW5kUHJpY2UsIGF1Y3Rpb24uZHVyYXRpb24sIHNlY29uZHNQYXNzZWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZUN1cnJlbnRQcmljZSh1aW50MjU2IHN0YXJ0UHJpY2UsIHVpbnQyNTYgZW5kUHJpY2UsIHVpbnQyNTYgZHVyYXRpb24sIHVpbnQyNTYgc2Vjb25kc0VsYXBzZWQpCiAgICAgICAgaW50ZXJuYWwKICAgICAgICBwdXJlCiAgICAgICAgcmV0dXJucyAodWludDI1NikKICAgIHsKICAgICAgICBpZiAoc2Vjb25kc0VsYXBzZWQgPj0gZHVyYXRpb24pIHsKICAgICAgICAgICAgcmV0dXJuIGVuZFByaWNlOwogICAgICAgIH0gCgogICAgICAgIGludDI1NiB0b3RhbFByaWNlQ2hhbmdlID0gaW50MjU2KGVuZFByaWNlKSAtIGludDI1NihzdGFydFByaWNlKTsKICAgICAgICBpbnQyNTYgY3VycmVudFByaWNlQ2hhbmdlID0gdG90YWxQcmljZUNoYW5nZSAqIGludDI1NihzZWNvbmRzRWxhcHNlZCkgLyBpbnQyNTYoZHVyYXRpb24pOwogICAgICAgIGludDI1NiBfY3VycmVudFByaWNlID0gaW50MjU2KHN0YXJ0UHJpY2UpICsgY3VycmVudFByaWNlQ2hhbmdlOwoKICAgICAgICByZXR1cm4gdWludDI1NihfY3VycmVudFByaWNlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVBdWN0aW9uZWVyQ3V0KHVpbnQyNTYgc2VsbFByaWNlKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICAvLyAxMCwwMDAgPSAxMDAlLCBvd25lckN1dCByZXF1aXJlZCdkIDw9IDEwLDAwMCBpbiB0aGUgY29uc3RydWN0b3Igc28gbm8gcmVxdWlyZW1lbnQgdG8gdmFsaWRhdGUgaGVyZQogICAgICAgIHVpbnQgZmluYWxDdXQgPSBzZWxsUHJpY2UgKiBhdWN0aW9uZWVyQ3V0IC8gMTAwMDA7CiAgICAgICAgcmV0dXJuIGZpbmFsQ3V0OwogICAgfSAgICAKfQoKY29udHJhY3QgQkNGVHJhbnNmZXJNYXJrZXQgaXMgQkNGQnV5TWFya2V0IHsKCiAgICBCQ0ZBdWN0aW9uIHB1YmxpYyBhdWN0aW9uQWRkcmVzczsKCiAgICBmdW5jdGlvbiBzZXRBdWN0aW9uQWRkcmVzcyhhZGRyZXNzIG5ld0FkZHJlc3MpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUobmV3QWRkcmVzcyAhPSBhZGRyZXNzKDApKTsKICAgICAgICBCQ0ZBdWN0aW9uIGNhbmRpZGF0ZUNvbnRyYWN0ID0gQkNGQXVjdGlvbihuZXdBZGRyZXNzKTsKICAgICAgICBhdWN0aW9uQWRkcmVzcyA9IGNhbmRpZGF0ZUNvbnRyYWN0OwogICAgfQoKICAgIGZ1bmN0aW9uIGNyZWF0ZVRyYW5zZmVyQXVjdGlvbigKICAgICAgICB1aW50IHBsYXllckNhcmRJZCwKICAgICAgICB1aW50IHN0YXJ0UHJpY2UsCiAgICAgICAgdWludCBlbmRQcmljZSwKICAgICAgICB1aW50IGR1cmF0aW9uCiAgICApCiAgICAgICAgcHVibGljCiAgICAgICAgd2hlbk5vdFBhdXNlZAogICAgewogICAgICAgIHJlcXVpcmUoYXVjdGlvbkFkZHJlc3MgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShvd25zUGxheWVyQ2FyZChtc2cuc2VuZGVyLCBwbGF5ZXJDYXJkSWQpKTsKICAgICAgICBhcHByb3ZlRm9yVHJhbnNmZXJUbyhhdWN0aW9uQWRkcmVzcywgcGxheWVyQ2FyZElkKTsKICAgICAgICBhdWN0aW9uQWRkcmVzcy5jcmVhdGVBdWN0aW9uKAogICAgICAgICAgICBwbGF5ZXJDYXJkSWQsCiAgICAgICAgICAgIHN0YXJ0UHJpY2UsCiAgICAgICAgICAgIGVuZFByaWNlLAogICAgICAgICAgICBkdXJhdGlvbiwKICAgICAgICAgICAgbXNnLnNlbmRlcgogICAgICAgICk7CiAgICB9CgogICAgZnVuY3Rpb24gd2l0aGRyYXdBdWN0aW9uQmFsYW5jZSgpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgYXVjdGlvbkFkZHJlc3Mud2l0aGRyYXdCYWxhbmNlKCk7CiAgICB9Cn0KCmNvbnRyYWN0IEJDRlNlZWRpbmcgaXMgQkNGVHJhbnNmZXJNYXJrZXQgewoKICAgIGZ1bmN0aW9uIGNyZWF0ZVBsYXllcigKICAgICAgICB1aW50OCBfb3ZlcmFsbCwKICAgICAgICB1aW50OCBfcGFjZSwKICAgICAgICB1aW50OCBfc2hvb3RpbmcsCiAgICAgICAgdWludDggX3Bhc3NpbmcsCiAgICAgICAgdWludDggX2RyaWJibGluZywKICAgICAgICB1aW50OCBfZGVmZW5kaW5nLAogICAgICAgIHVpbnQ4IF9waHlzaWNhbCwKICAgICAgICB1aW50OCBfbGV2ZWwsCiAgICAgICAgYnl0ZXMgX3Bvc2l0aW9uLAogICAgICAgIHN0cmluZyBfZnVsbE5hbWUKICAgICkgCiAgICAgICAgaW50ZXJuYWwgCiAgICAgICAgcmV0dXJucyAodWludCkgCiAgICB7CiAgICAgICAgcmVxdWlyZShfb3ZlcmFsbCA+IDAgJiYgX292ZXJhbGwgPCAxMDApOwogICAgICAgIHJlcXVpcmUoX3BhY2UgPiAwICYmIF9wYWNlIDwgMTAwKTsKICAgICAgICByZXF1aXJlKF9zaG9vdGluZyA+IDAgJiYgX3Nob290aW5nIDwgMTAwKTsKICAgICAgICByZXF1aXJlKF9wYXNzaW5nID4gMCAmJiBfcGFzc2luZyA8IDEwMCk7CiAgICAgICAgcmVxdWlyZShfZHJpYmJsaW5nID4gMCAmJiBfZHJpYmJsaW5nIDwgMTAwKTsKICAgICAgICByZXF1aXJlKF9kZWZlbmRpbmcgPiAwICYmIF9kZWZlbmRpbmcgPCAxMDApOwogICAgICAgIHJlcXVpcmUoX3BoeXNpY2FsID4gMCAmJiBfcGh5c2ljYWwgPCAxMDApOwogICAgICAgIHJlcXVpcmUoX2xldmVsID4gMCAmJiBfbGV2ZWwgPCAxMDApOwogICAgICAgIHJlcXVpcmUoX3Bvc2l0aW9uLmxlbmd0aCA+IDApOwogICAgICAgIHJlcXVpcmUoYnl0ZXMoX2Z1bGxOYW1lKS5sZW5ndGggPiAwKTsKICAgICAgICAKICAgICAgICBQbGF5ZXIgbWVtb3J5IF9wbGF5ZXJJbnN0YW5jZSA9IFBsYXllcih7CiAgICAgICAgICAgIG92ZXJhbGw6IF9vdmVyYWxsLAogICAgICAgICAgICBwYWNlOiBfcGFjZSwKICAgICAgICAgICAgc2hvb3Rpbmc6IF9zaG9vdGluZywKICAgICAgICAgICAgcGFzc2luZzogX3Bhc3NpbmcsCiAgICAgICAgICAgIGRyaWJibGluZzogX2RyaWJibGluZywKICAgICAgICAgICAgZGVmZW5kaW5nOiBfZGVmZW5kaW5nLAogICAgICAgICAgICBwaHlzaWNhbDogX3BoeXNpY2FsLAogICAgICAgICAgICBmb3JtOiAxMDAsCiAgICAgICAgICAgIGxldmVsOiBfbGV2ZWwsCiAgICAgICAgICAgIHBvc2l0aW9uOiBfcG9zaXRpb24sCiAgICAgICAgICAgIG5hbWU6IF9mdWxsTmFtZQogICAgICAgIH0pOwoKICAgICAgICByZXR1cm4gcGxheWVycy5wdXNoKF9wbGF5ZXJJbnN0YW5jZSkgLSAxOwogICAgfQoKICAgIGZ1bmN0aW9uIGNyZWF0ZVBsYXllck9uQXVjdGlvbigKICAgICAgICB1aW50OCBfb3ZlcmFsbCwKICAgICAgICB1aW50OCBfcGFjZSwKICAgICAgICB1aW50OCBfc2hvb3RpbmcsCiAgICAgICAgdWludDggX3Bhc3NpbmcsCiAgICAgICAgdWludDggX2RyaWJibGluZywKICAgICAgICB1aW50OCBfZGVmZW5kaW5nLAogICAgICAgIHVpbnQ4IF9waHlzaWNhbCwKICAgICAgICB1aW50OCBfbGV2ZWwsCiAgICAgICAgYnl0ZXMgX3Bvc2l0aW9uLAogICAgICAgIHN0cmluZyBfZnVsbE5hbWUsCiAgICAgICAgdWludCBfc3RhcnRQcmljZQogICAgKSAKICAgICAgICBwdWJsaWMgd2hlbk5vdFBhdXNlZCBvbmx5RWRpdG9yCiAgICAgICAgcmV0dXJucyh1aW50KQogICAgewogICAgICAgIHVpbnQgcGxheWVySWQgPSBjcmVhdGVQbGF5ZXIoCiAgICAgICAgICAgIF9vdmVyYWxsLCAKICAgICAgICAgICAgX3BhY2UsIAogICAgICAgICAgICBfc2hvb3RpbmcsIAogICAgICAgICAgICBfcGFzc2luZywgCiAgICAgICAgICAgIF9kcmliYmxpbmcsCiAgICAgICAgICAgIF9kZWZlbmRpbmcsCiAgICAgICAgICAgIF9waHlzaWNhbCwKICAgICAgICAgICAgX2xldmVsLAogICAgICAgICAgICBfcG9zaXRpb24sCiAgICAgICAgICAgIF9mdWxsTmFtZSk7CgogICAgICAgIHVpbnQgY2FyZElkID0gY3JlYXRlUGxheWVyQ2FyZChwbGF5ZXJJZCwgYWRkcmVzcyh0aGlzKSwgdHJ1ZSk7CiAgICAgICAgYXBwcm92ZUZvclRyYW5zZmVyVG8oYXVjdGlvbkFkZHJlc3MsIGNhcmRJZCk7CgogICAgICAgIGF1Y3Rpb25BZGRyZXNzLmNyZWF0ZUF1Y3Rpb24oCiAgICAgICAgICAgIGNhcmRJZCwgLy8gaWQKICAgICAgICAgICAgX3N0YXJ0UHJpY2UsIC8vIHN0YXJ0IHByaWNlCiAgICAgICAgICAgIDEgZmlubmV5LCAvLyBlbmQgcHJpY2UKICAgICAgICAgICAgNyBkYXlzLCAvLyBkdXJhdGlvbgogICAgICAgICAgICBhZGRyZXNzKHRoaXMpIC8vIHNlbGxlcgogICAgICAgICk7CgogICAgICAgIHJldHVybiBjYXJkSWQ7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNyZWF0ZVBsYXllckFuZEFzc2lnbigKICAgICAgICB1aW50OCBfb3ZlcmFsbCwKICAgICAgICB1aW50OCBfcGFjZSwKICAgICAgICB1aW50OCBfc2hvb3RpbmcsCiAgICAgICAgdWludDggX3Bhc3NpbmcsCiAgICAgICAgdWludDggX2RyaWJibGluZywKICAgICAgICB1aW50OCBfZGVmZW5kaW5nLAogICAgICAgIHVpbnQ4IF9waHlzaWNhbCwKICAgICAgICB1aW50OCBfbGV2ZWwsCiAgICAgICAgYnl0ZXMgX3Bvc2l0aW9uLAogICAgICAgIHN0cmluZyBfZnVsbE5hbWUsCiAgICAgICAgYWRkcmVzcyBhc3NpZ25lZQogICAgKSAKICAgICAgICBwdWJsaWMgd2hlbk5vdFBhdXNlZCBvbmx5RWRpdG9yCiAgICAgICAgcmV0dXJucyh1aW50KSAKICAgIHsKICAgICAgICByZXF1aXJlKGFzc2lnbmVlICE9IGFkZHJlc3MoMCkpOwogICAgICAgIAogICAgICAgIHVpbnQgcGxheWVySWQgPSBjcmVhdGVQbGF5ZXIoCiAgICAgICAgICAgIF9vdmVyYWxsLCAKICAgICAgICAgICAgX3BhY2UsIAogICAgICAgICAgICBfc2hvb3RpbmcsIAogICAgICAgICAgICBfcGFzc2luZywgCiAgICAgICAgICAgIF9kcmliYmxpbmcsCiAgICAgICAgICAgIF9kZWZlbmRpbmcsCiAgICAgICAgICAgIF9waHlzaWNhbCwKICAgICAgICAgICAgX2xldmVsLAogICAgICAgICAgICBfcG9zaXRpb24sCiAgICAgICAgICAgIF9mdWxsTmFtZSk7CgogICAgICAgIHVpbnQgY2FyZElkID0gY3JlYXRlUGxheWVyQ2FyZChwbGF5ZXJJZCwgYXNzaWduZWUsIHRydWUpOwoKICAgICAgICByZXR1cm4gY2FyZElkOwogICAgfQp9Cgpjb250cmFjdCBCQ0ZNYWluIGlzIEJDRlNlZWRpbmcgewoKICAgIGZ1bmN0aW9uIEJDRk1haW4oKSBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgICAgICBlZGl0b3IgPSBtc2cuc2VuZGVyOwogICAgICAgIHBhdXNlZCA9IHRydWU7CgogICAgICAgIC8vIFdlIG5lZWQgdG8gY3JlYXRlIGFuIHVuYWNxdWlyYWJsZSBpbmRleCAwIHBsYXllciBzbyB3ZSBjYW4gdXNlIHBsYXllcklkID4gMCBjaGVjayBmb3IgdmFsaWQgcGxheWVyQ2FyZCBzdHJ1Y3RzCiAgICAgICAgY3JlYXRlUGxheWVyKDEsIDQsIDQsIDIsIDMsIDUsIDIsIDExLCAiQ0FNIiwgIlRoaWFnbyBNZXNzaSIpOwogICAgfQoKICAgIGZ1bmN0aW9uKCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkZHJlc3MoYXVjdGlvbkFkZHJlc3MpIHx8IG1zZy5zZW5kZXIgPT0gb3duZXIgfHwgbXNnLnNlbmRlciA9PSBidXlpbmdFc2Nyb3dBZGRyZXNzKTsKICAgIH0KCiAgICBmdW5jdGlvbiB3aXRoZHJhd0JhbGFuY2UoKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIG93bmVyLnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgICB9Cn0='.
	

]
