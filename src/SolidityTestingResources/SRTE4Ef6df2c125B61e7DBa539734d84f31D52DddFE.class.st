Class {
	#name : #SRTE4Ef6df2c125B61e7DBa539734d84f31D52DddFE,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTE4Ef6df2c125B61e7DBa539734d84f31D52DddFE >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgoKCi8qKgogKiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIHVpbnQgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgdWludCBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gbWF4NjQodWludDY0IGEsIHVpbnQ2NCBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50NjQpIHsKICAgIHJldHVybiBhID49IGIgPyBhIDogYjsKICB9CgogIGZ1bmN0aW9uIG1pbjY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7CiAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsKICB9CgogIGZ1bmN0aW9uIG1heDI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOwogIH0KCiAgZnVuY3Rpb24gbWluMjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsKICB9CgogIGZ1bmN0aW9uIGFzc2VydChib29sIGFzc2VydGlvbikgaW50ZXJuYWwgewogICAgaWYgKCFhc3NlcnRpb24pIHsKICAgICAgdGhyb3c7CiAgICB9CiAgfQp9CgoKLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgY29uc3RhbnQgcmV0dXJucyAodWludCk7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludCB2YWx1ZSk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSk7Cn0KCgoKCi8qKgogKiBAdGl0bGUgQmFzaWMgdG9rZW4KICogQGRldiBCYXNpYyB2ZXJzaW9uIG9mIFN0YW5kYXJkVG9rZW4sIHdpdGggbm8gYWxsb3dhbmNlcy4gCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgYmFsYW5jZXM7CgogIC8qKgogICAqIEBkZXYgRml4IGZvciB0aGUgRVJDMjAgc2hvcnQgYWRkcmVzcyBhdHRhY2suCiAgICovCiAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgc2l6ZSkgewogICAgIGlmKG1zZy5kYXRhLmxlbmd0aCA8IHNpemUgKyA0KSB7CiAgICAgICB0aHJvdzsKICAgICB9CiAgICAgXzsKICB9CgogIC8qKgogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDIgKiAzMikgewogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuIAogICogQHJldHVybiBBbiB1aW50IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cgp9CgoKCgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQgdmFsdWUpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50IHZhbHVlKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50IHZhbHVlKTsKfQoKCgoKLyoqCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbgogKgogKiBAZGV2IEltcGxlbWFudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFydCB0b2tlbi4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBCYXNpY1Rva2VuLCBFUkMyMCB7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSkgYWxsb3dlZDsKCgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQgdGhlIGFtb3V0IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDMgKiAzMikgewogICAgdmFyIF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKCiAgICAvLyBDaGVjayBpcyBub3QgbmVlZGVkIGJlY2F1c2Ugc3ViKF9hbGxvd2FuY2UsIF92YWx1ZSkgd2lsbCBhbHJlYWR5IHRocm93IGlmIHRoaXMgY29uZGl0aW9uIGlzIG5vdCBtZXQKICAgIC8vIGlmIChfdmFsdWUgPiBfYWxsb3dhbmNlKSB0aHJvdzsKCiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlYWhsZiBvZiBtc2cuc2VuZGVyLgogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfdmFsdWUpIHsKCiAgICAvLyBUbyBjaGFuZ2UgdGhlIGFwcHJvdmUgYW1vdW50IHlvdSBmaXJzdCBoYXZlIHRvIHJlZHVjZSB0aGUgYWRkcmVzc2VzYAogICAgLy8gIGFsbG93YW5jZSB0byB6ZXJvIGJ5IGNhbGxpbmcgYGFwcHJvdmUoX3NwZW5kZXIsIDApYCBpZiBpdCBpcyBub3QKICAgIC8vICBhbHJlYWR5IDAgdG8gbWl0aWdhdGUgdGhlIHJhY2UgY29uZGl0aW9uIGRlc2NyaWJlZCBoZXJlOgogICAgLy8gIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICBpZiAoKF92YWx1ZSAhPSAwKSAmJiAoYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gIT0gMCkpIHRocm93OwoKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYW4gYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEByZXR1cm4gQSB1aW50IHNwZWNpZmluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpYmxlIGZvciB0aGUgc3BlbmRlci4KICAgKi8KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9Cgp9CgoKLyoqCiAqIEB0aXRsZSBMaW1pdGVkVHJhbnNmZXJUb2tlbgogKiBAZGV2IExpbWl0ZWRUcmFuc2ZlclRva2VuIGRlZmluZXMgdGhlIGdlbmVyaWMgaW50ZXJmYWNlIGFuZCB0aGUgaW1wbGVtZW50YXRpb24gdG8gbGltaXQgdG9rZW4gCiAqIHRyYW5zZmVyYWJpbGl0eSBmb3IgZGlmZmVyZW50IGV2ZW50cy4gSXQgaXMgaW50ZW5kZWQgdG8gYmUgdXNlZCBhcyBhIGJhc2UgY2xhc3MgZm9yIG90aGVyIHRva2VuIAogKiBjb250cmFjdHMuIAogKiBMaW1pdGVkVHJhbnNmZXJUb2tlbiBoYXMgYmVlbiBkZXNpZ25lZCB0byBhbGxvdyBmb3IgZGlmZmVyZW50IGxpbWl0aW5nIGZhY3RvcnMsCiAqIHRoaXMgY2FuIGJlIGFjaGlldmVkIGJ5IHJlY3Vyc2l2ZWx5IGNhbGxpbmcgc3VwZXIudHJhbnNmZXJhYmxlVG9rZW5zKCkgdW50aWwgdGhlIGJhc2UgY2xhc3MgaXMgCiAqIGhpdC4gRm9yIGV4YW1wbGU6CiAqICAgICBmdW5jdGlvbiB0cmFuc2ZlcmFibGVUb2tlbnMoYWRkcmVzcyBob2xkZXIsIHVpbnQ2NCB0aW1lKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDI1NikgewogKiAgICAgICByZXR1cm4gbWluMjU2KHVubG9ja2VkVG9rZW5zLCBzdXBlci50cmFuc2ZlcmFibGVUb2tlbnMoaG9sZGVyLCB0aW1lKSk7CiAqICAgICB9CiAqIEEgd29ya2luZyBleGFtcGxlIGlzIFZlc3RlZFRva2VuLnNvbDoKICogaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXBwZWxpbi1zb2xpZGl0eS9ibG9iL21hc3Rlci9jb250cmFjdHMvdG9rZW4vVmVzdGVkVG9rZW4uc29sCiAqLwoKY29udHJhY3QgTGltaXRlZFRyYW5zZmVyVG9rZW4gaXMgRVJDMjAgewoKICAvKioKICAgKiBAZGV2IENoZWNrcyB3aGV0aGVyIGl0IGNhbiB0cmFuc2ZlciBvciBvdGhlcndpc2UgdGhyb3dzLgogICAqLwogIG1vZGlmaWVyIGNhblRyYW5zZmVyKGFkZHJlc3MgX3NlbmRlciwgdWludCBfdmFsdWUpIHsKICAgaWYgKF92YWx1ZSA+IHRyYW5zZmVyYWJsZVRva2Vucyhfc2VuZGVyLCB1aW50NjQobm93KSkpIHRocm93OwogICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBDaGVja3MgbW9kaWZpZXIgYW5kIGFsbG93cyB0cmFuc2ZlciBpZiB0b2tlbnMgYXJlIG5vdCBsb2NrZWQuCiAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjaWV2ZSB0aGUgdG9rZW5zLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQuCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBjYW5UcmFuc2Zlcihtc2cuc2VuZGVyLCBfdmFsdWUpIHsKICAgIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICB9CgogIC8qKgogICogQGRldiBDaGVja3MgbW9kaWZpZXIgYW5kIGFsbG93cyB0cmFuc2ZlciBpZiB0b2tlbnMgYXJlIG5vdCBsb2NrZWQuCiAgKiBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHNlbmQgdGhlIHRva2Vucy4KICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2lldmUgdGhlIHRva2Vucy4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBjYW5UcmFuc2ZlcihfZnJvbSwgX3ZhbHVlKSB7CiAgICBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICB9CgogIC8qKgogICAqIEBkZXYgRGVmYXVsdCB0cmFuc2ZlcmFibGUgdG9rZW5zIGZ1bmN0aW9uIHJldHVybnMgYWxsIHRva2VucyBmb3IgYSBob2xkZXIgKG5vIGxpbWl0KS4KICAgKiBAZGV2IE92ZXJ3cml0aW5nIHRyYW5zZmVyYWJsZVRva2VucyhhZGRyZXNzIGhvbGRlciwgdWludDY0IHRpbWUpIGlzIHRoZSB3YXkgdG8gcHJvdmlkZSB0aGUgCiAgICogc3BlY2lmaWMgbG9naWMgZm9yIGxpbWl0aW5nIHRva2VuIHRyYW5zZmVyYWJpbGl0eSBmb3IgYSBob2xkZXIgb3ZlciB0aW1lLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyYWJsZVRva2VucyhhZGRyZXNzIGhvbGRlciwgdWludDY0IHRpbWUpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gYmFsYW5jZU9mKGhvbGRlcik7CiAgfQp9CgoKLyoqCiAqIEB0aXRsZSBWZXN0ZWQgdG9rZW4KICogQGRldiBUb2tlbnMgdGhhdCBjYW4gYmUgdmVzdGVkIGZvciBhIGdyb3VwIG9mIGFkZHJlc3Nlcy4KICovCmNvbnRyYWN0IFZlc3RlZFRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIExpbWl0ZWRUcmFuc2ZlclRva2VuIHsKCiAgdWludDI1NiBNQVhfR1JBTlRTX1BFUl9BRERSRVNTID0gMjA7CgogIHN0cnVjdCBUb2tlbkdyYW50IHsKICAgIGFkZHJlc3MgZ3JhbnRlcjsgICAgIC8vIDIwIGJ5dGVzCiAgICB1aW50MjU2IHZhbHVlOyAgICAgICAvLyAzMiBieXRlcwogICAgdWludDY0IGNsaWZmOwogICAgdWludDY0IHZlc3Rpbmc7CiAgICB1aW50NjQgc3RhcnQ7ICAgICAgICAvLyAzICogOCA9IDI0IGJ5dGVzCiAgICBib29sIHJldm9rYWJsZTsKICAgIGJvb2wgYnVybnNPblJldm9rZTsgIC8vIDIgKiAxID0gMiBiaXRzPyBvciAyIGJ5dGVzPwogIH0gLy8gdG90YWwgNzggYnl0ZXMgPSAzIHNzdG9yZSBwZXIgb3BlcmF0aW9uICgzMiBwZXIgc3N0b3JlKQoKICBtYXBwaW5nIChhZGRyZXNzID0+IFRva2VuR3JhbnRbXSkgcHVibGljIGdyYW50czsKCiAgZXZlbnQgTmV3VG9rZW5HcmFudChhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IGdyYW50SWQpOwoKICAvKioKICAgKiBAZGV2IEdyYW50IHRva2VucyB0byBhIHNwZWNpZmllZCBhZGRyZXNzCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHRoZSB0b2tlbnMgd2lsbCBiZSBncmFudGVkIHRvLgogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBncmFudGVkLgogICAqIEBwYXJhbSBfc3RhcnQgdWludDY0IFRpbWUgb2YgdGhlIGJlZ2lubmluZyBvZiB0aGUgZ3JhbnQuCiAgICogQHBhcmFtIF9jbGlmZiB1aW50NjQgVGltZSBvZiB0aGUgY2xpZmYgcGVyaW9kLgogICAqIEBwYXJhbSBfdmVzdGluZyB1aW50NjQgVGhlIHZlc3RpbmcgcGVyaW9kLgogICAqLwogIGZ1bmN0aW9uIGdyYW50VmVzdGVkVG9rZW5zKAogICAgYWRkcmVzcyBfdG8sCiAgICB1aW50MjU2IF92YWx1ZSwKICAgIHVpbnQ2NCBfc3RhcnQsCiAgICB1aW50NjQgX2NsaWZmLAogICAgdWludDY0IF92ZXN0aW5nLAogICAgYm9vbCBfcmV2b2thYmxlLAogICAgYm9vbCBfYnVybnNPblJldm9rZQogICkgcHVibGljIHsKCiAgICAvLyBDaGVjayBmb3IgZGF0ZSBpbmNvbnNpc3RlbmNpZXMgdGhhdCBtYXkgY2F1c2UgdW5leHBlY3RlZCBiZWhhdmlvcgogICAgaWYgKF9jbGlmZiA8IF9zdGFydCB8fCBfdmVzdGluZyA8IF9jbGlmZikgewogICAgICB0aHJvdzsKICAgIH0KCiAgICBpZiAodG9rZW5HcmFudHNDb3VudChfdG8pID4gTUFYX0dSQU5UU19QRVJfQUREUkVTUykgdGhyb3c7ICAgLy8gVG8gcHJldmVudCBhIHVzZXIgYmVpbmcgc3BhbW1lZCBhbmQgaGF2ZSBoaXMgYmFsYW5jZSBsb2NrZWQgKG91dCBvZiBnYXMgYXR0YWNrIHdoZW4gY2FsY3VsYXRpbmcgdmVzdGluZykuCgogICAgdWludCBjb3VudCA9IGdyYW50c1tfdG9dLnB1c2goCiAgICAgICAgICAgICAgICBUb2tlbkdyYW50KAogICAgICAgICAgICAgICAgICBfcmV2b2thYmxlID8gbXNnLnNlbmRlciA6IDAsIC8vIGF2b2lkIHN0b3JpbmcgYW4gZXh0cmEgMjAgYnl0ZXMgd2hlbiBpdCBpcyBub24tcmV2b2thYmxlCiAgICAgICAgICAgICAgICAgIF92YWx1ZSwKICAgICAgICAgICAgICAgICAgX2NsaWZmLAogICAgICAgICAgICAgICAgICBfdmVzdGluZywKICAgICAgICAgICAgICAgICAgX3N0YXJ0LAogICAgICAgICAgICAgICAgICBfcmV2b2thYmxlLAogICAgICAgICAgICAgICAgICBfYnVybnNPblJldm9rZQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICk7CgogICAgdHJhbnNmZXIoX3RvLCBfdmFsdWUpOwoKICAgIE5ld1Rva2VuR3JhbnQobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUsIGNvdW50IC0gMSk7CiAgfQoKICAvKioKICAgKiBAZGV2IFJldm9rZSB0aGUgZ3JhbnQgb2YgdG9rZW5zIG9mIGEgc3BlY2lmZWQgYWRkcmVzcy4KICAgKiBAcGFyYW0gX2hvbGRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIGhhdmUgaXRzIHRva2VucyByZXZva2VkLgogICAqIEBwYXJhbSBfZ3JhbnRJZCBUaGUgaWQgb2YgdGhlIHRva2VuIGdyYW50LgogICAqLwogIGZ1bmN0aW9uIHJldm9rZVRva2VuR3JhbnQoYWRkcmVzcyBfaG9sZGVyLCB1aW50IF9ncmFudElkKSBwdWJsaWMgewogICAgVG9rZW5HcmFudCBncmFudCA9IGdyYW50c1tfaG9sZGVyXVtfZ3JhbnRJZF07CgogICAgaWYgKCFncmFudC5yZXZva2FibGUpIHsgLy8gQ2hlY2sgaWYgZ3JhbnQgd2FzIHJldm9rYWJsZQogICAgICB0aHJvdzsKICAgIH0KCiAgICBpZiAoZ3JhbnQuZ3JhbnRlciAhPSBtc2cuc2VuZGVyKSB7IC8vIE9ubHkgZ3JhbnRlciBjYW4gcmV2b2tlIGl0CiAgICAgIHRocm93OwogICAgfQoKICAgIGFkZHJlc3MgcmVjZWl2ZXIgPSBncmFudC5idXJuc09uUmV2b2tlID8gMHhkZWFkIDogbXNnLnNlbmRlcjsKCiAgICB1aW50MjU2IG5vblZlc3RlZCA9IG5vblZlc3RlZFRva2VucyhncmFudCwgdWludDY0KG5vdykpOwoKICAgIC8vIHJlbW92ZSBncmFudCBmcm9tIGFycmF5CiAgICBkZWxldGUgZ3JhbnRzW19ob2xkZXJdW19ncmFudElkXTsKICAgIGdyYW50c1tfaG9sZGVyXVtfZ3JhbnRJZF0gPSBncmFudHNbX2hvbGRlcl1bZ3JhbnRzW19ob2xkZXJdLmxlbmd0aC5zdWIoMSldOwogICAgZ3JhbnRzW19ob2xkZXJdLmxlbmd0aCAtPSAxOwoKICAgIGJhbGFuY2VzW3JlY2VpdmVyXSA9IGJhbGFuY2VzW3JlY2VpdmVyXS5hZGQobm9uVmVzdGVkKTsKICAgIGJhbGFuY2VzW19ob2xkZXJdID0gYmFsYW5jZXNbX2hvbGRlcl0uc3ViKG5vblZlc3RlZCk7CgogICAgVHJhbnNmZXIoX2hvbGRlciwgcmVjZWl2ZXIsIG5vblZlc3RlZCk7CiAgfQoKCiAgLyoqCiAgICogQGRldiBDYWxjdWxhdGUgdGhlIHRvdGFsIGFtb3VudCBvZiB0cmFuc2ZlcmFibGUgdG9rZW5zIG9mIGEgaG9sZGVyIGF0IGEgZ2l2ZW4gdGltZQogICAqIEBwYXJhbSBob2xkZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyBvZiB0aGUgaG9sZGVyCiAgICogQHBhcmFtIHRpbWUgdWludDY0IFRoZSBzcGVjaWZpYyB0aW1lLgogICAqIEByZXR1cm4gQW4gdWludCByZXByZXNlbnRpbmcgYSBob2xkZXIncyB0b3RhbCBhbW91bnQgb2YgdHJhbnNmZXJhYmxlIHRva2Vucy4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcmFibGVUb2tlbnMoYWRkcmVzcyBob2xkZXIsIHVpbnQ2NCB0aW1lKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBncmFudEluZGV4ID0gdG9rZW5HcmFudHNDb3VudChob2xkZXIpOwoKICAgIGlmIChncmFudEluZGV4ID09IDApIHJldHVybiBiYWxhbmNlT2YoaG9sZGVyKTsgLy8gc2hvcnRjdXQgZm9yIGhvbGRlciB3aXRob3V0IGdyYW50cwoKICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCBhbGwgdGhlIGdyYW50cyB0aGUgaG9sZGVyIGhhcywgYW5kIGFkZCBhbGwgbm9uLXZlc3RlZCB0b2tlbnMKICAgIHVpbnQyNTYgbm9uVmVzdGVkID0gMDsKICAgIGZvciAodWludDI1NiBpID0gMDsgaSA8IGdyYW50SW5kZXg7IGkrKykgewogICAgICBub25WZXN0ZWQgPSBTYWZlTWF0aC5hZGQobm9uVmVzdGVkLCBub25WZXN0ZWRUb2tlbnMoZ3JhbnRzW2hvbGRlcl1baV0sIHRpbWUpKTsKICAgIH0KCiAgICAvLyBCYWxhbmNlIC0gdG90YWxOb25WZXN0ZWQgaXMgdGhlIGFtb3VudCBvZiB0b2tlbnMgYSBob2xkZXIgY2FuIHRyYW5zZmVyIGF0IGFueSBnaXZlbiB0aW1lCiAgICB1aW50MjU2IHZlc3RlZFRyYW5zZmVyYWJsZSA9IFNhZmVNYXRoLnN1YihiYWxhbmNlT2YoaG9sZGVyKSwgbm9uVmVzdGVkKTsKCiAgICAvLyBSZXR1cm4gdGhlIG1pbmltdW0gb2YgaG93IG1hbnkgdmVzdGVkIGNhbiB0cmFuc2ZlciBhbmQgb3RoZXIgdmFsdWUKICAgIC8vIGluIGNhc2UgdGhlcmUgYXJlIG90aGVyIGxpbWl0aW5nIHRyYW5zZmVyYWJpbGl0eSBmYWN0b3JzIChkZWZhdWx0IGlzIGJhbGFuY2VPZikKICAgIHJldHVybiBTYWZlTWF0aC5taW4yNTYodmVzdGVkVHJhbnNmZXJhYmxlLCBzdXBlci50cmFuc2ZlcmFibGVUb2tlbnMoaG9sZGVyLCB0aW1lKSk7CiAgfQoKICAvKioKICAgKiBAZGV2IENoZWNrIHRoZSBhbW91bnQgb2YgZ3JhbnRzIHRoYXQgYW4gYWRkcmVzcyBoYXMuCiAgICogQHBhcmFtIF9ob2xkZXIgVGhlIGhvbGRlciBvZiB0aGUgZ3JhbnRzLgogICAqIEByZXR1cm4gQSB1aW50IHJlcHJlc2VudGluZyB0aGUgdG90YWwgYW1vdW50IG9mIGdyYW50cy4KICAgKi8KICBmdW5jdGlvbiB0b2tlbkdyYW50c0NvdW50KGFkZHJlc3MgX2hvbGRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCBpbmRleCkgewogICAgcmV0dXJuIGdyYW50c1tfaG9sZGVyXS5sZW5ndGg7CiAgfQoKICAvKioKICAgKiBAZGV2IENhbGN1bGF0ZSBhbW91bnQgb2YgdmVzdGVkIHRva2VucyBhdCBhIHNwZWNpZmMgdGltZS4KICAgKiBAcGFyYW0gdG9rZW5zIHVpbnQyNTYgVGhlIGFtb3VudCBvZiB0b2tlbnMgZ3JhbnR0ZWQuCiAgICogQHBhcmFtIHRpbWUgdWludDY0IFRoZSB0aW1lIHRvIGJlIGNoZWNrZWQKICAgKiBAcGFyYW0gc3RhcnQgdWludDY0IEEgdGltZSByZXByZXNlbnRpbmcgdGhlIGJlZ2luaW5nIG9mIHRoZSBncmFudAogICAqIEBwYXJhbSBjbGlmZiB1aW50NjQgVGhlIGNsaWZmIHBlcmlvZC4KICAgKiBAcGFyYW0gdmVzdGluZyB1aW50NjQgVGhlIHZlc3RpbmcgcGVyaW9kLgogICAqIEByZXR1cm4gQW4gdWludCByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvZiB2ZXN0ZWQgdG9rZW5zb2YgYSBzcGVjaWYgZ3JhbnQuCiAgICogIHRyYW5zZmVyYWJsZVRva2VucwogICAqICAgfCAgICAgICAgICAgICAgICAgICAgICAgICBfLy0tLS0tLS0tICAgdmVzdGVkVG9rZW5zIHJlY3QKICAgKiAgIHwgICAgICAgICAgICAgICAgICAgICAgIF8vCiAgICogICB8ICAgICAgICAgICAgICAgICAgICAgXy8KICAgKiAgIHwgICAgICAgICAgICAgICAgICAgXy8KICAgKiAgIHwgICAgICAgICAgICAgICAgIF8vCiAgICogICB8ICAgICAgICAgICAgICAgIC8KICAgKiAgIHwgICAgICAgICAgICAgIC58CiAgICogICB8ICAgICAgICAgICAgLiAgfAogICAqICAgfCAgICAgICAgICAuICAgIHwKICAgKiAgIHwgICAgICAgIC4gICAgICB8CiAgICogICB8ICAgICAgLiAgICAgICAgfAogICAqICAgfCAgICAuICAgICAgICAgIHwKICAgKiAgICs9PT0rPT09PT09PT09PT0rLS0tLS0tLS0tKy0tLS0tLS0tLS0+IHRpbWUKICAgKiAgICAgIFN0YXJ0ICAgICAgIENsaWZ0ICAgIFZlc3RpbmcKICAgKi8KICBmdW5jdGlvbiBjYWxjdWxhdGVWZXN0ZWRUb2tlbnMoCiAgICB1aW50MjU2IHRva2VucywKICAgIHVpbnQyNTYgdGltZSwKICAgIHVpbnQyNTYgc3RhcnQsCiAgICB1aW50MjU2IGNsaWZmLAogICAgdWludDI1NiB2ZXN0aW5nKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KQogICAgewogICAgICAvLyBTaG9ydGN1dHMgZm9yIGJlZm9yZSBjbGlmZiBhbmQgYWZ0ZXIgdmVzdGluZyBjYXNlcy4KICAgICAgaWYgKHRpbWUgPCBjbGlmZikgcmV0dXJuIDA7CiAgICAgIGlmICh0aW1lID49IHZlc3RpbmcpIHJldHVybiB0b2tlbnM7CgogICAgICAvLyBJbnRlcnBvbGF0ZSBhbGwgdmVzdGVkIHRva2Vucy4KICAgICAgLy8gQXMgYmVmb3JlIGNsaWZmIHRoZSBzaG9ydGN1dCByZXR1cm5zIDAsIHdlIGNhbiB1c2UganVzdCBjYWxjdWxhdGUgYSB2YWx1ZQogICAgICAvLyBpbiB0aGUgdmVzdGluZyByZWN0IChhcyBzaG93biBpbiBhYm92ZSdzIGZpZ3VyZSkKCiAgICAgIC8vIHZlc3RlZFRva2VucyA9IHRva2VucyAqICh0aW1lIC0gc3RhcnQpIC8gKHZlc3RpbmcgLSBzdGFydCkKICAgICAgdWludDI1NiB2ZXN0ZWRUb2tlbnMgPSBTYWZlTWF0aC5kaXYoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNhZmVNYXRoLm11bCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2tlbnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2FmZU1hdGguc3ViKHRpbWUsIHN0YXJ0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNhZmVNYXRoLnN1Yih2ZXN0aW5nLCBzdGFydCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTsKCiAgICAgIHJldHVybiB2ZXN0ZWRUb2tlbnM7CiAgfQoKICAvKioKICAgKiBAZGV2IEdldCBhbGwgaW5mb3JtYXRpb24gYWJvdXQgYSBzcGVjaWZjIGdyYW50LgogICAqIEBwYXJhbSBfaG9sZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgaGF2ZSBpdHMgdG9rZW5zIHJldm9rZWQuCiAgICogQHBhcmFtIF9ncmFudElkIFRoZSBpZCBvZiB0aGUgdG9rZW4gZ3JhbnQuCiAgICogQHJldHVybiBSZXR1cm5zIGFsbCB0aGUgdmFsdWVzIHRoYXQgcmVwcmVzZW50IGEgVG9rZW5HcmFudChhZGRyZXNzLCB2YWx1ZSwgc3RhcnQsIGNsaWZmLAogICAqIHJldm9rYWJpbGl0eSwgYnVybnNPblJldm9rZSwgYW5kIHZlc3RpbmcpIHBsdXMgdGhlIHZlc3RlZCB2YWx1ZSBhdCB0aGUgY3VycmVudCB0aW1lLgogICAqLwogIGZ1bmN0aW9uIHRva2VuR3JhbnQoYWRkcmVzcyBfaG9sZGVyLCB1aW50IF9ncmFudElkKSBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzIGdyYW50ZXIsIHVpbnQyNTYgdmFsdWUsIHVpbnQyNTYgdmVzdGVkLCB1aW50NjQgc3RhcnQsIHVpbnQ2NCBjbGlmZiwgdWludDY0IHZlc3RpbmcsIGJvb2wgcmV2b2thYmxlLCBib29sIGJ1cm5zT25SZXZva2UpIHsKICAgIFRva2VuR3JhbnQgZ3JhbnQgPSBncmFudHNbX2hvbGRlcl1bX2dyYW50SWRdOwoKICAgIGdyYW50ZXIgPSBncmFudC5ncmFudGVyOwogICAgdmFsdWUgPSBncmFudC52YWx1ZTsKICAgIHN0YXJ0ID0gZ3JhbnQuc3RhcnQ7CiAgICBjbGlmZiA9IGdyYW50LmNsaWZmOwogICAgdmVzdGluZyA9IGdyYW50LnZlc3Rpbmc7CiAgICByZXZva2FibGUgPSBncmFudC5yZXZva2FibGU7CiAgICBidXJuc09uUmV2b2tlID0gZ3JhbnQuYnVybnNPblJldm9rZTsKCiAgICB2ZXN0ZWQgPSB2ZXN0ZWRUb2tlbnMoZ3JhbnQsIHVpbnQ2NChub3cpKTsKICB9CgogIC8qKgogICAqIEBkZXYgR2V0IHRoZSBhbW91bnQgb2YgdmVzdGVkIHRva2VucyBhdCBhIHNwZWNpZmljIHRpbWUuCiAgICogQHBhcmFtIGdyYW50IFRva2VuR3JhbnQgVGhlIGdyYW50IHRvIGJlIGNoZWNrZWQuCiAgICogQHBhcmFtIHRpbWUgVGhlIHRpbWUgdG8gYmUgY2hlY2tlZAogICAqIEByZXR1cm4gQW4gdWludCByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvZiB2ZXN0ZWQgdG9rZW5zIG9mIGEgc3BlY2lmaWMgZ3JhbnQgYXQgYSBzcGVjaWZpYyB0aW1lLgogICAqLwogIGZ1bmN0aW9uIHZlc3RlZFRva2VucyhUb2tlbkdyYW50IGdyYW50LCB1aW50NjQgdGltZSkgcHJpdmF0ZSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gY2FsY3VsYXRlVmVzdGVkVG9rZW5zKAogICAgICBncmFudC52YWx1ZSwKICAgICAgdWludDI1Nih0aW1lKSwKICAgICAgdWludDI1NihncmFudC5zdGFydCksCiAgICAgIHVpbnQyNTYoZ3JhbnQuY2xpZmYpLAogICAgICB1aW50MjU2KGdyYW50LnZlc3RpbmcpCiAgICApOwogIH0KCiAgLyoqCiAgICogQGRldiBDYWxjdWxhdGUgdGhlIGFtb3VudCBvZiBub24gdmVzdGVkIHRva2VucyBhdCBhIHNwZWNpZmljIHRpbWUuCiAgICogQHBhcmFtIGdyYW50IFRva2VuR3JhbnQgVGhlIGdyYW50IHRvIGJlIGNoZWNrZWQuCiAgICogQHBhcmFtIHRpbWUgdWludDY0IFRoZSB0aW1lIHRvIGJlIGNoZWNrZWQKICAgKiBAcmV0dXJuIEFuIHVpbnQgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb2Ygbm9uIHZlc3RlZCB0b2tlbnMgb2YgYSBzcGVjaWZjIGdyYW50IG9uIHRoZSAKICAgKiBwYXNzZWQgdGltZSBmcmFtZS4KICAgKi8KICBmdW5jdGlvbiBub25WZXN0ZWRUb2tlbnMoVG9rZW5HcmFudCBncmFudCwgdWludDY0IHRpbWUpIHByaXZhdGUgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGdyYW50LnZhbHVlLnN1Yih2ZXN0ZWRUb2tlbnMoZ3JhbnQsIHRpbWUpKTsKICB9CgogIC8qKgogICAqIEBkZXYgQ2FsY3VsYXRlIHRoZSBkYXRlIHdoZW4gdGhlIGhvbGRlciBjYW4gdHJhc2ZlciBhbGwgaXRzIHRva2VucwogICAqIEBwYXJhbSBob2xkZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyBvZiB0aGUgaG9sZGVyCiAgICogQHJldHVybiBBbiB1aW50IHJlcHJlc2VudGluZyB0aGUgZGF0ZSBvZiB0aGUgbGFzdCB0cmFuc2ZlcmFibGUgdG9rZW5zLgogICAqLwogIGZ1bmN0aW9uIGxhc3RUb2tlbklzVHJhbnNmZXJhYmxlRGF0ZShhZGRyZXNzIGhvbGRlcikgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQ2NCBkYXRlKSB7CiAgICBkYXRlID0gdWludDY0KG5vdyk7CiAgICB1aW50MjU2IGdyYW50SW5kZXggPSBncmFudHNbaG9sZGVyXS5sZW5ndGg7CiAgICBmb3IgKHVpbnQyNTYgaSA9IDA7IGkgPCBncmFudEluZGV4OyBpKyspIHsKICAgICAgZGF0ZSA9IFNhZmVNYXRoLm1heDY0KGdyYW50c1tob2xkZXJdW2ldLnZlc3RpbmcsIGRhdGUpOwogICAgfQogIH0KfQoKLy8gUVVFU1RJT05TIEZPUiBBVURJVE9SUzoKLy8gLSBDb25zaWRlcmluZyB3ZSBpbmhlcml0IGZyb20gVmVzdGVkVG9rZW4sIGhvdyBtdWNoIGRvZXMgdGhhdCBoaXQgYXQgb3VyIGdhcyBwcmljZT8KLy8gLSBFbnN1cmUgbWF4IHN1cHBseSBpcyAxMDAsMDAwLDAwMAovLyAtIEVuc3VyZSB0aGF0IGV2ZW4gaWYgbm90IHRvdGFsU3VwcGx5IGlzIHNvbGQsIHRva2VucyB3b3VsZCBzdGlsbCBiZSB0cmFuc2ZlcnJhYmxlIGFmdGVyICh3ZSB3aWxsIHVwIHRvIHRvdGFsU3VwcGx5IGJ5IGNyZWF0aW5nIGFkRXggdG9rZW5zKQoKLy8gdmVzdGluZzogMzY1IGRheXMsIDM2NSBkYXlzIC8gNCB2ZXN0aW5nCgoKY29udHJhY3QgQURYVG9rZW4gaXMgVmVzdGVkVG9rZW4gewogIC8vRklFTERTCiAgc3RyaW5nIHB1YmxpYyBuYW1lID0gIkFkRXgiOwogIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIkFEWCI7CiAgdWludCBwdWJsaWMgZGVjaW1hbHMgPSA0OwoKICAvL0NPTlNUQU5UUwogIC8vVGltZSBsaW1pdHMKICB1aW50IHB1YmxpYyBjb25zdGFudCBTVEFHRV9PTkVfVElNRV9FTkQgPSAyNCBob3VyczsgLy8gZmlyc3QgZGF5IGJvbnVzCiAgdWludCBwdWJsaWMgY29uc3RhbnQgU1RBR0VfVFdPX1RJTUVfRU5EID0gMSB3ZWVrczsgLy8gZmlyc3Qgd2VlayBib251cwogIHVpbnQgcHVibGljIGNvbnN0YW50IFNUQUdFX1RIUkVFX1RJTUVfRU5EID0gNCB3ZWVrczsKICAKICAvLyBNdWx0aXBsaWVyIGZvciB0aGUgZGVjaW1hbHMKICB1aW50IHByaXZhdGUgY29uc3RhbnQgREVDSU1BTFMgPSAxMDAwMDsKCiAgLy9QcmljZXMgb2YgQURYCiAgdWludCBwdWJsaWMgY29uc3RhbnQgUFJJQ0VfU1RBTkRBUkQgICAgPSA5MDAqREVDSU1BTFM7IC8vIEFEWCByZWNlaXZlZCBwZXIgb25lIEVUSDsgTUFYX1NVUFBMWSAvICh2YWx1YXRpb24gLyBldGhQcmljZSkKICB1aW50IHB1YmxpYyBjb25zdGFudCBQUklDRV9TVEFHRV9PTkUgICA9IFBSSUNFX1NUQU5EQVJEICogMTMwLzEwMDsgLy8gMUVUSCA9IDMwJSBtb3JlIEFEWAogIHVpbnQgcHVibGljIGNvbnN0YW50IFBSSUNFX1NUQUdFX1RXTyAgID0gUFJJQ0VfU1RBTkRBUkQgKiAxMTUvMTAwOyAvLyAxRVRIID0gMTUlIG1vcmUgQURYCiAgdWludCBwdWJsaWMgY29uc3RhbnQgUFJJQ0VfU1RBR0VfVEhSRUUgPSBQUklDRV9TVEFOREFSRDsKCiAgLy9BRFggVG9rZW4gTGltaXRzCiAgdWludCBwdWJsaWMgY29uc3RhbnQgQUxMT0NfVEVBTSA9ICAgICAgICAgMTYwMDAwMDAqREVDSU1BTFM7IC8vIHRlYW0gKyBhZHZpc29ycwogIHVpbnQgcHVibGljIGNvbnN0YW50IEFMTE9DX0JPVU5USUVTID0gICAgICAyMDAwMDAwKkRFQ0lNQUxTOwogIHVpbnQgcHVibGljIGNvbnN0YW50IEFMTE9DX1dJTkdTID0gICAgICAgICAyMDAwMDAwKkRFQ0lNQUxTOwogIHVpbnQgcHVibGljIGNvbnN0YW50IEFMTE9DX0NST1dEU0FMRSA9ICAgIDgwMDAwMDAwKkRFQ0lNQUxTOwogIHVpbnQgcHVibGljIGNvbnN0YW50IFBSRUJVWV9QT1JUSU9OX01BWCA9IDIwMDAwMDAwKkRFQ0lNQUxTOyAvLyB0aGlzIGlzIHJlZHVuZGFudGx5IG1vcmUgdGhhbiB3aGF0IHdpbGwgYmUgcHJlLXNvbGQKICAKICAvL0FTU0lHTkVEIElOIElOSVRJQUxJWkFUSU9OCiAgLy9TdGFydCBhbmQgZW5kIHRpbWVzCiAgdWludCBwdWJsaWMgcHVibGljU3RhcnRUaW1lOyAvLyBUaW1lIGluIHNlY29uZHMgcHVibGljIGNyb3dkIGZ1bmQgc3RhcnRzLgogIHVpbnQgcHVibGljIHByaXZhdGVTdGFydFRpbWU7IC8vIFRpbWUgaW4gc2Vjb25kcyB3aGVuIHByZS1idXkgY2FuIHB1cmNoYXNlIHVwIHRvIDMxMjUwIEVUSCB3b3J0aCBvZiBBRFg7CiAgdWludCBwdWJsaWMgcHVibGljRW5kVGltZTsgLy8gVGltZSBpbiBzZWNvbmRzIGNyb3dkc2FsZSBlbmRzCiAgdWludCBwdWJsaWMgaGFyZGNhcEluRXRoOwoKICAvL1NwZWNpYWwgQWRkcmVzc2VzCiAgYWRkcmVzcyBwdWJsaWMgbXVsdGlzaWdBZGRyZXNzOyAvLyBBZGRyZXNzIHRvIHdoaWNoIGFsbCBldGhlciBmbG93cy4KICBhZGRyZXNzIHB1YmxpYyBhZGV4VGVhbUFkZHJlc3M7IC8vIEFkZHJlc3MgdG8gd2hpY2ggQUxMT0NfVEVBTSwgQUxMT0NfQk9VTlRJRVMsIEFMTE9DX1dJTkdTIGlzICh1bHRpbWF0ZWx5KSBzZW50IHRvLgogIGFkZHJlc3MgcHVibGljIG93bmVyQWRkcmVzczsgLy8gQWRkcmVzcyBvZiB0aGUgY29udHJhY3Qgb3duZXIuIENhbiBoYWx0IHRoZSBjcm93ZHNhbGUuCiAgYWRkcmVzcyBwdWJsaWMgcHJlQnV5MTsgLy8gQWRkcmVzcyB1c2VkIGJ5IHByZS1idXkKICBhZGRyZXNzIHB1YmxpYyBwcmVCdXkyOyAvLyBBZGRyZXNzIHVzZWQgYnkgcHJlLWJ1eQogIGFkZHJlc3MgcHVibGljIHByZUJ1eTM7IC8vIEFkZHJlc3MgdXNlZCBieSBwcmUtYnV5CiAgdWludCBwdWJsaWMgcHJlQnV5UHJpY2UxOyAvLyBwcmljZSBmb3IgcHJlLWJ1eQogIHVpbnQgcHVibGljIHByZUJ1eVByaWNlMjsgLy8gcHJpY2UgZm9yIHByZS1idXkKICB1aW50IHB1YmxpYyBwcmVCdXlQcmljZTM7IC8vIHByaWNlIGZvciBwcmUtYnV5CgogIC8vUnVubmluZyB0b3RhbHMKICB1aW50IHB1YmxpYyBldGhlclJhaXNlZDsgLy8gVG90YWwgRXRoZXIgcmFpc2VkLgogIHVpbnQgcHVibGljIEFEWFNvbGQ7IC8vIFRvdGFsIEFEWCBjcmVhdGVkCiAgdWludCBwdWJsaWMgcHJlYnV5UG9ydGlvblRvdGFsOyAvLyBUb3RhbCBvZiBUb2tlbnMgcHVyY2hhc2VkIGJ5IHByZS1idXkuIE5vdCB0byBleGNlZWQgUFJFQlVZX1BPUlRJT05fTUFYLgogIAogIC8vYm9vbGVhbnMKICBib29sIHB1YmxpYyBoYWx0ZWQ7IC8vIGhhbHRzIHRoZSBjcm93ZCBzYWxlIGlmIHRydWUuCgogIC8vIE1PRElGSUVSUwogIC8vSXMgY3VycmVudGx5IGluIHRoZSBwZXJpb2QgYWZ0ZXIgdGhlIHByaXZhdGUgc3RhcnQgdGltZSBhbmQgYmVmb3JlIHRoZSBwdWJsaWMgc3RhcnQgdGltZS4KICBtb2RpZmllciBpc19wcmVfY3Jvd2RmdW5kX3BlcmlvZCgpIHsKICAgIGlmIChub3cgPj0gcHVibGljU3RhcnRUaW1lIHx8IG5vdyA8IHByaXZhdGVTdGFydFRpbWUpIHRocm93OwogICAgXzsKICB9CgogIC8vSXMgY3VycmVudGx5IHRoZSBjcm93ZGZ1bmQgcGVyaW9kCiAgbW9kaWZpZXIgaXNfY3Jvd2RmdW5kX3BlcmlvZCgpIHsKICAgIGlmIChub3cgPCBwdWJsaWNTdGFydFRpbWUpIHRocm93OwogICAgaWYgKGlzQ3Jvd2RmdW5kQ29tcGxldGVkKCkpIHRocm93OwogICAgXzsKICB9CgogIC8vIElzIGNvbXBsZXRlZAogIG1vZGlmaWVyIGlzX2Nyb3dkZnVuZF9jb21wbGV0ZWQoKSB7CiAgICBpZiAoIWlzQ3Jvd2RmdW5kQ29tcGxldGVkKCkpIHRocm93OwogICAgXzsKICB9CiAgZnVuY3Rpb24gaXNDcm93ZGZ1bmRDb21wbGV0ZWQoKSBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7CiAgICBpZiAobm93ID4gcHVibGljRW5kVGltZSB8fCBBRFhTb2xkID49IEFMTE9DX0NST1dEU0FMRSB8fCBldGhlclJhaXNlZCA+PSBoYXJkY2FwSW5FdGgpIHJldHVybiB0cnVlOwogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgLy9NYXkgb25seSBiZSBjYWxsZWQgYnkgdGhlIG93bmVyIGFkZHJlc3MKICBtb2RpZmllciBvbmx5X293bmVyKCkgewogICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXJBZGRyZXNzKSB0aHJvdzsKICAgIF87CiAgfQoKICAvL01heSBvbmx5IGJlIGNhbGxlZCBpZiB0aGUgY3Jvd2RmdW5kIGhhcyBub3QgYmVlbiBoYWx0ZWQKICBtb2RpZmllciBpc19ub3RfaGFsdGVkKCkgewogICAgaWYgKGhhbHRlZCkgdGhyb3c7CiAgICBfOwogIH0KCiAgLy8gRVZFTlRTCiAgZXZlbnQgUHJlQnV5KHVpbnQgX2Ftb3VudCk7CiAgZXZlbnQgQnV5KGFkZHJlc3MgaW5kZXhlZCBfcmVjaXBpZW50LCB1aW50IF9hbW91bnQpOwoKICAvLyBJbml0aWFsaXphdGlvbiBjb250cmFjdCBhc3NpZ25zIGFkZHJlc3Mgb2YgY3Jvd2RmdW5kIGNvbnRyYWN0IGFuZCBlbmQgdGltZS4KICBmdW5jdGlvbiBBRFhUb2tlbigKICAgIGFkZHJlc3MgX211bHRpc2lnLAogICAgYWRkcmVzcyBfYWRleFRlYW0sCiAgICB1aW50IF9wdWJsaWNTdGFydFRpbWUsCiAgICB1aW50IF9wcml2YXRlU3RhcnRUaW1lLAogICAgdWludCBfaGFyZGNhcEluRXRoLAogICAgYWRkcmVzcyBfcHJlYnV5MSwgdWludCBfcHJlQnV5UHJpY2UxLAogICAgYWRkcmVzcyBfcHJlYnV5MiwgdWludCBfcHJlQnV5UHJpY2UyLAogICAgYWRkcmVzcyBfcHJlYnV5MywgdWludCBfcHJlQnV5UHJpY2UzCiAgKSB7CiAgICBvd25lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgcHVibGljU3RhcnRUaW1lID0gX3B1YmxpY1N0YXJ0VGltZTsKICAgIHByaXZhdGVTdGFydFRpbWUgPSBfcHJpdmF0ZVN0YXJ0VGltZTsKICAgIHB1YmxpY0VuZFRpbWUgPSBfcHVibGljU3RhcnRUaW1lICsgNCB3ZWVrczsKICAgIG11bHRpc2lnQWRkcmVzcyA9IF9tdWx0aXNpZzsKICAgIGFkZXhUZWFtQWRkcmVzcyA9IF9hZGV4VGVhbTsKCiAgICBoYXJkY2FwSW5FdGggPSBfaGFyZGNhcEluRXRoOwoKICAgIHByZUJ1eTEgPSBfcHJlYnV5MTsKICAgIHByZUJ1eVByaWNlMSA9IF9wcmVCdXlQcmljZTE7CiAgICBwcmVCdXkyID0gX3ByZWJ1eTI7CiAgICBwcmVCdXlQcmljZTIgPSBfcHJlQnV5UHJpY2UyOwogICAgcHJlQnV5MyA9IF9wcmVidXkzOwogICAgcHJlQnV5UHJpY2UzID0gX3ByZUJ1eVByaWNlMzsKCiAgICBiYWxhbmNlc1thZGV4VGVhbUFkZHJlc3NdICs9IEFMTE9DX0JPVU5USUVTOwogICAgYmFsYW5jZXNbYWRleFRlYW1BZGRyZXNzXSArPSBBTExPQ19XSU5HUzsKCiAgICBiYWxhbmNlc1tvd25lckFkZHJlc3NdICs9IEFMTE9DX1RFQU07CgogICAgYmFsYW5jZXNbb3duZXJBZGRyZXNzXSArPSBBTExPQ19DUk9XRFNBTEU7CiAgfQoKICAvLyBUcmFuc2ZlciBhbW91bnQgb2YgdG9rZW5zIGZyb20gc2VuZGVyIGFjY291bnQgdG8gcmVjaXBpZW50LgogIC8vIE9ubHkgY2FsbGFibGUgYWZ0ZXIgdGhlIGNyb3dkIGZ1bmQgaXMgY29tcGxldGVkCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKQogIHsKICAgIGlmIChfdG8gPT0gbXNnLnNlbmRlcikgcmV0dXJuOyAvLyBuby1vcCwgYWxsb3cgZXZlbiBkdXJpbmcgY3Jvd2RzYWxlLCBpbiBvcmRlciB0byB3b3JrIGFyb3VuZCB1c2luZyBncmFudFZlc3RlZFRva2VucygpIHdoaWxlIGluIGNyb3dkc2FsZQogICAgaWYgKCFpc0Nyb3dkZnVuZENvbXBsZXRlZCgpKSB0aHJvdzsKICAgIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICB9CgogIC8vIFRyYW5zZmVyIGFtb3VudCBvZiB0b2tlbnMgZnJvbSBhIHNwZWNpZmllZCBhZGRyZXNzIHRvIGEgcmVjaXBpZW50LgogIC8vIFRyYW5zZmVyIGFtb3VudCBvZiB0b2tlbnMgZnJvbSBzZW5kZXIgYWNjb3VudCB0byByZWNpcGllbnQuCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkKICAgIGlzX2Nyb3dkZnVuZF9jb21wbGV0ZWQKICB7CiAgICBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICB9CgogIC8vY29uc3RhbnQgZnVuY3Rpb24gcmV0dXJucyB0aGUgY3VycmVudCBBRFggcHJpY2UuCiAgZnVuY3Rpb24gZ2V0UHJpY2VSYXRlKCkKICAgICAgY29uc3RhbnQKICAgICAgcmV0dXJucyAodWludCBvX3JhdGUpCiAgewogICAgICB1aW50IGRlbHRhID0gU2FmZU1hdGguc3ViKG5vdywgcHVibGljU3RhcnRUaW1lKTsKCiAgICAgIGlmIChkZWx0YSA+IFNUQUdFX1RXT19USU1FX0VORCkgcmV0dXJuIFBSSUNFX1NUQUdFX1RIUkVFOwogICAgICBpZiAoZGVsdGEgPiBTVEFHRV9PTkVfVElNRV9FTkQpIHJldHVybiBQUklDRV9TVEFHRV9UV087CgogICAgICByZXR1cm4gKFBSSUNFX1NUQUdFX09ORSk7CiAgfQoKICAvLyBjYWxjdWxhdGVzIHdtb3VudCBvZiBBRFggd2UgZ2V0LCBnaXZlbiB0aGUgd2VpIGFuZCB0aGUgcmF0ZXMgd2UndmUgZGVmaW5lZCBwZXIgMSBldGgKICBmdW5jdGlvbiBjYWxjQW1vdW50KHVpbnQgX3dlaSwgdWludCBfcmF0ZSkgCiAgICBjb25zdGFudAogICAgcmV0dXJucyAodWludCkgCiAgewogICAgcmV0dXJuIFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoX3dlaSwgX3JhdGUpLCAxIGV0aGVyKTsKICB9IAogIAogIC8vIEdpdmVuIHRoZSByYXRlIG9mIGEgcHVyY2hhc2UgYW5kIHRoZSByZW1haW5pbmcgdG9rZW5zIGluIHRoaXMgdHJhbmNoZSwgaXQKICAvLyB3aWxsIHRocm93IGlmIHRoZSBzYWxlIHdvdWxkIHRha2UgaXQgcGFzdCB0aGUgbGltaXQgb2YgdGhlIHRyYW5jaGUuCiAgLy8gUmV0dXJucyBgYW1vdW50YCBpbiBzY29wZSBhcyB0aGUgbnVtYmVyIG9mIEFEWCB0b2tlbnMgdGhhdCBpdCB3aWxsIHB1cmNoYXNlLgogIGZ1bmN0aW9uIHByb2Nlc3NQdXJjaGFzZSh1aW50IF9yYXRlLCB1aW50IF9yZW1haW5pbmcpCiAgICBpbnRlcm5hbAogICAgcmV0dXJucyAodWludCBvX2Ftb3VudCkKICB7CiAgICBvX2Ftb3VudCA9IGNhbGNBbW91bnQobXNnLnZhbHVlLCBfcmF0ZSk7CgogICAgaWYgKG9fYW1vdW50ID4gX3JlbWFpbmluZykgdGhyb3c7CiAgICBpZiAoIW11bHRpc2lnQWRkcmVzcy5zZW5kKG1zZy52YWx1ZSkpIHRocm93OwoKICAgIGJhbGFuY2VzW293bmVyQWRkcmVzc10gPSBiYWxhbmNlc1tvd25lckFkZHJlc3NdLnN1YihvX2Ftb3VudCk7CiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLmFkZChvX2Ftb3VudCk7CgogICAgQURYU29sZCArPSBvX2Ftb3VudDsKICAgIGV0aGVyUmFpc2VkICs9IG1zZy52YWx1ZTsKICB9CgogIC8vU3BlY2lhbCBGdW5jdGlvbiBjYW4gb25seSBiZSBjYWxsZWQgYnkgcHJlLWJ1eSBhbmQgb25seSBkdXJpbmcgdGhlIHByZS1jcm93ZHNhbGUgcGVyaW9kLgogIGZ1bmN0aW9uIHByZUJ1eSgpCiAgICBwYXlhYmxlCiAgICBpc19wcmVfY3Jvd2RmdW5kX3BlcmlvZAogICAgaXNfbm90X2hhbHRlZAogIHsKICAgIC8vIFByZS1idXkgcGFydGljaXBhbnRzIHdvdWxkIGdldCB0aGUgZmlyc3QtZGF5IHByaWNlLCBhcyB3ZWxsIGFzIGEgYm9udXMgb2YgdmVzdGVkIHRva2VucwogICAgdWludCBwcmljZVZlc3RlZCA9IDA7CgogICAgaWYgKG1zZy5zZW5kZXIgPT0gcHJlQnV5MSkgcHJpY2VWZXN0ZWQgPSBwcmVCdXlQcmljZTE7CiAgICBpZiAobXNnLnNlbmRlciA9PSBwcmVCdXkyKSBwcmljZVZlc3RlZCA9IHByZUJ1eVByaWNlMjsKICAgIGlmIChtc2cuc2VuZGVyID09IHByZUJ1eTMpIHByaWNlVmVzdGVkID0gcHJlQnV5UHJpY2UzOwoKICAgIGlmIChwcmljZVZlc3RlZCA9PSAwKSB0aHJvdzsKCiAgICB1aW50IGFtb3VudCA9IHByb2Nlc3NQdXJjaGFzZShQUklDRV9TVEFHRV9PTkUgKyBwcmljZVZlc3RlZCwgU2FmZU1hdGguc3ViKFBSRUJVWV9QT1JUSU9OX01BWCwgcHJlYnV5UG9ydGlvblRvdGFsKSk7CiAgICBncmFudFZlc3RlZFRva2Vucyhtc2cuc2VuZGVyLCBjYWxjQW1vdW50KG1zZy52YWx1ZSwgcHJpY2VWZXN0ZWQpLCAKICAgICAgdWludDY0KG5vdyksIHVpbnQ2NChub3cpICsgOTEgZGF5cywgdWludDY0KG5vdykgKyAzNjUgZGF5cywgCiAgICAgIGZhbHNlLCBmYWxzZQogICAgKTsKICAgIHByZWJ1eVBvcnRpb25Ub3RhbCArPSBhbW91bnQ7CiAgICBQcmVCdXkoYW1vdW50KTsKICB9CgogIC8vRGVmYXVsdCBmdW5jdGlvbiBjYWxsZWQgYnkgc2VuZGluZyBFdGhlciB0byB0aGlzIGFkZHJlc3Mgd2l0aCBubyBhcmd1bWVudHMuCiAgLy9SZXN1bHRzIGluIGNyZWF0aW9uIG9mIG5ldyBBRFggVG9rZW5zIGlmIHRyYW5zYWN0aW9uIHdvdWxkIG5vdCBleGNlZWQgaGFyZCBsaW1pdCBvZiBBRFggVG9rZW4uCiAgZnVuY3Rpb24oKQogICAgcGF5YWJsZQogICAgaXNfY3Jvd2RmdW5kX3BlcmlvZAogICAgaXNfbm90X2hhbHRlZAogIHsKICAgIHVpbnQgYW1vdW50ID0gcHJvY2Vzc1B1cmNoYXNlKGdldFByaWNlUmF0ZSgpLCBTYWZlTWF0aC5zdWIoQUxMT0NfQ1JPV0RTQUxFLCBBRFhTb2xkKSk7CiAgICBCdXkobXNnLnNlbmRlciwgYW1vdW50KTsKICB9CgogIC8vIFRvIGJlIGNhbGxlZCBhdCB0aGUgZW5kIG9mIGNyb3dkZnVuZCBwZXJpb2QKICAvLyBXQVJOSU5HOiB0cmFuc2ZlcigpLCB3aGljaCBpcyBjYWxsZWQgYnkgZ3JhbnRWZXN0ZWRUb2tlbnMoKSwgd2FudHMgYSBtaW5pbXVtIG1lc3NhZ2UgbGVuZ3RoCiAgZnVuY3Rpb24gZ3JhbnRWZXN0ZWQoYWRkcmVzcyBfYWRleFRlYW1BZGRyZXNzLCBhZGRyZXNzIF9hZGV4RnVuZEFkZHJlc3MpCiAgICBpc19jcm93ZGZ1bmRfY29tcGxldGVkCiAgICBvbmx5X293bmVyCiAgICBpc19ub3RfaGFsdGVkCiAgewogICAgLy8gR3JhbnQgdG9rZW5zIHByZS1hbGxvY2F0ZWQgZm9yIHRoZSB0ZWFtCiAgICBncmFudFZlc3RlZFRva2VucygKICAgICAgX2FkZXhUZWFtQWRkcmVzcywgQUxMT0NfVEVBTSwKICAgICAgdWludDY0KG5vdyksIHVpbnQ2NChub3cpICsgOTEgZGF5cyAsIHVpbnQ2NChub3cpICsgMzY1IGRheXMsIAogICAgICBmYWxzZSwgZmFsc2UKICAgICk7CgogICAgLy8gR3JhbnQgdG9rZW5zIHRoYXQgcmVtYWluIGFmdGVyIGNyb3dkc2FsZSB0byB0aGUgQWRFeCBmdW5kLCB2ZXN0ZWQgZm9yIDIgeWVhcnMKICAgIGdyYW50VmVzdGVkVG9rZW5zKAogICAgICBfYWRleEZ1bmRBZGRyZXNzLCBiYWxhbmNlc1tvd25lckFkZHJlc3NdLAogICAgICB1aW50NjQobm93KSwgdWludDY0KG5vdykgKyAxODIgZGF5cyAsIHVpbnQ2NChub3cpICsgNzMwIGRheXMsIAogICAgICBmYWxzZSwgZmFsc2UKICAgICk7CiAgfQoKICAvL01heSBiZSB1c2VkIGJ5IG93bmVyIG9mIGNvbnRyYWN0IHRvIGhhbHQgY3Jvd2RzYWxlIGFuZCBubyBsb25nZXIgZXhjZXB0IGV0aGVyLgogIGZ1bmN0aW9uIHRvZ2dsZUhhbHQoYm9vbCBfaGFsdGVkKQogICAgb25seV9vd25lcgogIHsKICAgIGhhbHRlZCA9IF9oYWx0ZWQ7CiAgfQoKICAvL2ZhaWxzYWZlIGRyYWluCiAgZnVuY3Rpb24gZHJhaW4oKQogICAgb25seV9vd25lcgogIHsKICAgIGlmICghb3duZXJBZGRyZXNzLnNlbmQodGhpcy5iYWxhbmNlKSkgdGhyb3c7CiAgfQp9'.
	

]
