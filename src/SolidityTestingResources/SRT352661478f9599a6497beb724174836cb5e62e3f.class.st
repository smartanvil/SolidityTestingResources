Class {
	#name : #SRT352661478f9599a6497beb724174836cb5e62e3f,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT352661478f9599a6497beb724174836cb5e62e3f >> base64 [
	^ 'LyoKCVdlZWtseUxvdHRlcnlCCglDb2RlZCBieTogaUZBCglodHRwOi8vd2xiLmV0aGVyZXVtbG90dGVyeS5uZXQKCXZlcjogMS4zCiovCmNvbnRyYWN0IFdMQkRyYXdzREIgewoJYWRkcmVzcyBwcml2YXRlIG93bmVyOwoJYWRkcmVzcyBwcml2YXRlIGdhbWU7CgkKCXN0cnVjdCBkcmF3c19zIHsKCQl1aW50IGRhdGU7CgkJdWludDhbM10gbnVtYmVyczsKCQl1aW50IGhpdDNDb3VudDsKCQl1aW50IGhpdDNWYWx1ZTsKCQl1aW50IGhpdDJDb3VudDsKCQl1aW50IGhpdDJWYWx1ZTsKCX0KCQoJZHJhd3Nfc1tdIHByaXZhdGUgZHJhd3M7CgkKCWZ1bmN0aW9uIFdMQkRyYXdzREIoKSB7CgkJb3duZXIgPSBtc2cuc2VuZGVyOwoJfQoJCglmdW5jdGlvbiBuZXdEcmF3KHVpbnQgZGF0ZSwgdWludDhbM10gbnVtYmVycywgdWludCBoaXQzQ291bnQsIHVpbnQgaGl0M1ZhbHVlLCB1aW50IGhpdDJDb3VudCwgdWludCBoaXQyVmFsdWUpIG5vRXRoZXIgewoJCWlmICggbXNnLnNlbmRlciAhPSBvd25lciAmJiBtc2cuc2VuZGVyICE9IGdhbWUgKSB7IHRocm93OyB9CgkJZHJhd3MucHVzaCggZHJhd3NfcyggZGF0ZSwgbnVtYmVycywgaGl0M0NvdW50LCBoaXQzVmFsdWUsIGhpdDJDb3VudCwgaGl0MlZhbHVlKSApOwoJfQoJCglmdW5jdGlvbiBnZXREcmF3KHVpbnQgaWQpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgZGF0ZSwgdWludDhbM10gbnVtYmVycywgdWludCBoaXQzQ291bnQsIHVpbnQgaGl0M1ZhbHVlLCB1aW50IGhpdDJDb3VudCwgdWludCBoaXQyVmFsdWUpIHsKCQlyZXR1cm4gKCBkcmF3c1tpZF0uZGF0ZSwgZHJhd3NbaWRdLm51bWJlcnMsIGRyYXdzW2lkXS5oaXQzQ291bnQsIGRyYXdzW2lkXS5oaXQzVmFsdWUsIGRyYXdzW2lkXS5oaXQyQ291bnQsIGRyYXdzW2lkXS5oaXQyVmFsdWUgKTsKCX0KCQoJZnVuY3Rpb24gc2V0R2FtZUFkZHJlc3MoYWRkcmVzcyBfZ2FtZSkgbm9FdGhlciBPbmx5T3duZXIgZXh0ZXJuYWwgewoJCWdhbWUgPSBfZ2FtZTsKCX0KCQoJbW9kaWZpZXIgbm9FdGhlcigpIHsgaWYgKG1zZy52YWx1ZSA+IDApIHsgdGhyb3c7IH0gXzsgfQltb2RpZmllciBPbmx5T3duZXIoKSB7IGlmIChvd25lciAhPSBtc2cuc2VuZGVyKSB7IHRocm93OyB9IF87IH19Cgpjb250cmFjdCBXZWVrbHlMb3R0ZXJ5QiB7CgkvKiBzdHJ1Y3R1cmVzICovCglzdHJ1Y3QgZ2FtZXNfcyB7CgkJdWludCB0aWNrZXRzQ291bnQ7CgkJbWFwcGluZyhieXRlczMyID0+IHVpbnQpIGhpdDNIYXNoOwoJCW1hcHBpbmcoYnl0ZXMzMiA9PiB1aW50KSBoaXQySGFzaDsKCQl1aW50IHN0YXJ0VGltZXN0YW1wOwoJCXVpbnQgZW5kVGltZXN0YW1wOwoJCWJ5dGVzMyB3aW5uaW5nTnVtYmVyc0J5dGVzOwoJCXVpbnQgcHJlcGFyZUJsb2NrOwoJCWJvb2wgZHJhd0RvbmU7CgkJdWludCBwcml6ZVBvdDsKCQl1aW50IGhpdDNDb3VudDsKCQl1aW50IGhpdDNWYWx1ZTsKCQl1aW50IGhpdDJDb3VudDsKCQl1aW50IGhpdDJWYWx1ZTsKCX0KCXN0cnVjdCBwbGF5ZXJHYW1lc19zIHsKCQlieXRlczNbXSBudW1iZXJzQnl0ZXM7CgkJbWFwcGluZyhieXRlczMyID0+IHVpbnQpIGhpdDNIYXNoOwoJCW1hcHBpbmcoYnl0ZXMzMiA9PiB1aW50KSBoaXQySGFzaDsKCQlib29sIGNoZWNrZWQ7Cgl9CglzdHJ1Y3QgcGxheWVyc19zIHsKCQltYXBwaW5nKHVpbnQgPT4gcGxheWVyR2FtZXNfcykgZ2FtZXM7Cgl9CglzdHJ1Y3QgaW52ZXN0b3JzX3MgewoJCWFkZHJlc3Mgb3duZXI7CgkJdWludCB2YWx1ZTsKCQl1aW50IGJhbGFuY2U7CgkJYm9vbCBsaXZlOwoJCWJvb2wgdmFsaWQ7CgkJdWludCBiZWdpbnM7Cgl9CglzdHJ1Y3QgZHJhd3NfcyB7CgkJdWludCBkYXRlOwoJCXVpbnQgZ2FtZUlEOwoJCWJ5dGVzMyBudW1iZXJzQnl0ZXM7CgkJdWludCBoaXQzQ291bnQ7CgkJdWludCBoaXQzVmFsdWU7CgkJdWludCBoaXQyQ291bnQ7CgkJdWludCBoaXQyVmFsdWU7Cgl9CgkvKiBjb25maWcgKi8KCXVpbnQgcHVibGljIGNvbnN0YW50IHRpY2tldFByaWNlID0gMTAwIGZpbm5leTsgLy8gMC4xIGV0aGVyCgl1aW50IHByaXZhdGUgY29uc3RhbnQgZHJhd01heE51bWJlciA9IDUwOwoJdWludCBwcml2YXRlIGNvbnN0YW50IGRyYXdCbG9ja0RlbGF5ID0gNTsKCXVpbnQgcHJpdmF0ZSBjb25zdGFudCBwcml6ZURpc21pc3NEZWxheSA9IDU7Cgl1aW50IHByaXZhdGUgY29uc3RhbnQgZHJhd0Jsb2NrTGltaXQgPSAxMjg7Cgl1aW50IHByaXZhdGUgY29uc3RhbnQgY29udHJhY3REaXNtaXNzRGVsYXkgPSA1IHdlZWtzOwoJdWludCBwcml2YXRlIGNvbnN0YW50IGludmVzdFVuaXQgPSAxIGV0aGVyOwoJdWludCBwcml2YXRlIGNvbnN0YW50IGludmVzdE1pbmltdW0gPSAxMCBldGhlcjsKCXVpbnQgcHJpdmF0ZSBjb25zdGFudCBpbnZlc3RVc2VyTGltaXQgPSAyMDA7Cgl1aW50IHByaXZhdGUgY29uc3RhbnQgaW52ZXN0TWluRHVyYXRpb24gPSA1OyAvLyA1IGRyYXchCgl1aW50IHByaXZhdGUgY29uc3RhbnQgaW52ZXN0SWRsZVRpbWUgPSAxIGRheXM7Cgl1aW50IHByaXZhdGUgY29uc3RhbnQgZm9yT3duZXIgPSAyOyAvLyUKCXVpbnQgcHJpdmF0ZSBjb25zdGFudCBmb3JJbnZlc3RvcnMgPSA0MDsgLy8lCgl1aW50IHByaXZhdGUgY29uc3RhbnQgZm9ySGl0MiA9IDMwOyAvLyUKCS8qIHZhcmlhYmxlcyAqLwoJYWRkcmVzcyBwcml2YXRlIFdMQmRyYXdzREJBZGRyOwoJYWRkcmVzcyBwcml2YXRlIG93bmVyOwoJdWludCBwcml2YXRlIGN1cnJlbnRKYWNrcG90OwoJdWludCBwcml2YXRlIGludmVzdG1lbnRzVmFsdWU7Cgl1aW50IHByaXZhdGUgZXh0cmFKYWNrcG90OwoJdWludCBwcml2YXRlIHRpY2tldENvdW50ZXI7Cgl1aW50IHByaXZhdGUgY3VycmVudEdhbWU7Cgl1aW50IHByaXZhdGUgb3duZXJCYWxhbmNlOwoJdWludCBwcml2YXRlIG9sZENvbnRyYWN0TGFzdEdhbWU7Cglib29sIHB1YmxpYyBjb250cmFjdEVuYWJsZWQgPSB0cnVlOwoJdWludCBwcml2YXRlIGNvbnRyYWN0RGlzYWJsZWRUaW1lU3RhbXA7CgltYXBwaW5nKGFkZHJlc3MgPT4gcGxheWVyc19zKSBwcml2YXRlIHBsYXllcnM7CglnYW1lc19zW10gcHJpdmF0ZSBnYW1lczsKCWludmVzdG9yc19zW10gcHJpdmF0ZSBpbnZlc3RvcnM7CgkvKiBldmVudHMgKi8KCWV2ZW50IE5ld1RpY2tldEV2ZW50KGFkZHJlc3MgUGxheWVyLCB1aW50OCBOdW1iZXIxLCB1aW50OCBOdW1iZXIyLCB1aW50OCBOdW1iZXIzKTsKCWV2ZW50IENvbnRyYWN0RGlzYWJsZWRFdmVudCh1aW50IERlYWRsaW5lVGltZSk7CglldmVudCBEcmF3UHJlcGFyZUV2ZW50KHVpbnQgQmxvY2tOdW1iZXIpOwoJZXZlbnQgRHJhd0V2ZW50KHVpbnQgR2FtZUlELCB1aW50OCBOdW1iZXIxLCB1aW50OCBOdW1iZXIyLCB1aW50OCBOdW1iZXIzLCB1aW50IEhpdDNDb3VudCwgdWludCBIaXQzVmFsdWUsIHVpbnQgSGl0MkNvdW50LCB1aW50IEhpdDJWYWx1ZSk7CglldmVudCBJbnZlc3RBZGRFdmVudChhZGRyZXNzIEludmVzdG9yLCB1aW50IFZhbHVlKTsKCWV2ZW50IEludmVzdENhbmNlbEV2ZW50KGFkZHJlc3MgSW52ZXN0b3IsIHVpbnQgVmFsdWUpOwoJLyogY29uc3RydWN0b3IgKi8KCWZ1bmN0aW9uIFdlZWtseUxvdHRlcnlCKGFkZHJlc3MgX1dMQmRyYXdzREJBZGRyLCB1aW50IF9vbGRDb250cmFjdExhc3RHYW1lKSB7CgkJV0xCZHJhd3NEQkFkZHIgPSBfV0xCZHJhd3NEQkFkZHI7CgkJb3duZXIgPSBtc2cuc2VuZGVyOwoJCWN1cnJlbnRHYW1lID0gMDsKCQlvbGRDb250cmFjdExhc3RHYW1lID0gX29sZENvbnRyYWN0TGFzdEdhbWU7CgkJZ2FtZXMubGVuZ3RoID0gMTsKCQlnYW1lc1swXS5zdGFydFRpbWVzdGFtcCA9IG5vdzsKCQl1aW50IHJldCA9IDE0NzA1NzEyMDA7CgkJd2hpbGUgKHJldCA8IG5vdykgewoJCQlyZXQgKz0gMSB3ZWVrczsKCQl9CgkJZ2FtZXNbMF0uZW5kVGltZXN0YW1wID0gcmV0OwoJfQoJLyogY29uc3RhbnQgZnVuY3Rpb25zICovCglmdW5jdGlvbiBWaXNpdCgpIGNvbnN0YW50IHJldHVybnMgKHN0cmluZykgeyByZXR1cm4gImh0dHA6Ly93bGIuZXRoZXJldW1sb3R0ZXJ5Lm5ldCI7IH0KCWZ1bmN0aW9uIERyYXdzKHVpbnQgaWQpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgZGF0ZSwgdWludDhbM10gTnVtYmVycywgdWludCBoaXQzQ291bnQsIHVpbnQgaGl0M1ZhbHVlLCB1aW50IGhpdDJDb3VudCwgdWludCBoaXQyVmFsdWUpIHsKCQlyZXR1cm4gV0xCRHJhd3NEQiggV0xCZHJhd3NEQkFkZHIgKS5nZXREcmF3KGlkKTsKCX0KCWZ1bmN0aW9uIEN1cnJlbnRHYW1lKCkgY29uc3RhbnQgcmV0dXJucyAodWludCBHYW1lSUQsIHVpbnQgSmFja3BvdCwgdWludCBTdGFydCwgdWludCBFbmQsIHVpbnQgVGlja2V0cykgewoJCXJldHVybiAoY3VycmVudEdhbWUrb2xkQ29udHJhY3RMYXN0R2FtZSwgY3VycmVudEphY2twb3QsIGdhbWVzW2N1cnJlbnRHYW1lXS5zdGFydFRpbWVzdGFtcCwgZ2FtZXNbY3VycmVudEdhbWVdLmVuZFRpbWVzdGFtcCwgZ2FtZXNbY3VycmVudEdhbWVdLnRpY2tldHNDb3VudCk7Cgl9CglmdW5jdGlvbiBQbGF5ZXJUaWNrZXRzKGFkZHJlc3MgUGxheWVyLCB1aW50IEdhbWVJRCwgdWludCBUaWNrZXRJRCkgY29uc3RhbnQgcmV0dXJucyAodWludDhbM10gbnVtYmVycywgYm9vbCBDaGVja2VkKSB7CgkJR2FtZUlEIC09IG9sZENvbnRyYWN0TGFzdEdhbWU7CgkJcmV0dXJuICggZ2V0TnVtYmVyc0Zyb21CeXRlcyggcGxheWVyc1tQbGF5ZXJdLmdhbWVzW0dhbWVJRF0ubnVtYmVyc0J5dGVzW1RpY2tldElEXSApLCBwbGF5ZXJzW1BsYXllcl0uZ2FtZXNbR2FtZUlEXS5jaGVja2VkKTsKCX0KCWZ1bmN0aW9uIEludmVzdG9ycyhhZGRyZXNzIEFkZHJlc3MpIGNvbnN0YW50IHJldHVybnModWludCBJbnZlc3RtZW50LCB1aW50IEJhbGFuY2UsIGJvb2wgTGl2ZSkgewoJCXZhciAoZm91bmQsIEludmVzdG9ySUQpID0gZ2V0SW52ZXN0b3JCeUFkZHJlc3MoQWRkcmVzcyk7CgkJaWYgKGZvdW5kID09IGZhbHNlIHx8ICEgaW52ZXN0b3JzW0ludmVzdG9ySURdLnZhbGlkKSB7CgkJCXJldHVybiAoMCwgMCwgZmFsc2UpOwoJCX0KCQlyZXR1cm4gKGludmVzdG9yc1tJbnZlc3RvcklEXS52YWx1ZSwgaW52ZXN0b3JzW0ludmVzdG9ySURdLmJhbGFuY2UsIGludmVzdG9yc1tJbnZlc3RvcklEXS5saXZlKTsKCX0KCWZ1bmN0aW9uIENoZWNrUHJpemUoYWRkcmVzcyBBZGRyZXNzKSBjb25zdGFudCByZXR1cm5zKHVpbnQgdmFsdWUpIHsKCQl1aW50IGdhbWVJRDsKCQl1aW50IGdhbWVMb3dJRDsKCQl1aW50OFszXSBtZW1vcnkgbnVtYmVyczsKCQl1aW50IGhpdDNDb3VudDsKCQl1aW50IGhpdDJDb3VudDsKCQlmb3IgKCBnYW1lSUQ9Y3VycmVudEdhbWUgOyBnYW1lSUQ+PTAgOyBnYW1lSUQtLSApIHsKCQkJaWYgKCAhIHBsYXllcnNbQWRkcmVzc10uZ2FtZXNbZ2FtZUlEXS5jaGVja2VkKSB7CgkJCQlpZiAoZ2FtZXNbZ2FtZUlEXS5kcmF3RG9uZSkgewoJCQkJCW51bWJlcnMgPSBnZXROdW1iZXJzRnJvbUJ5dGVzKGdhbWVzW2dhbWVJRF0ud2lubmluZ051bWJlcnNCeXRlcyk7CgkJCQkJaGl0M0NvdW50ID0gcGxheWVyc1tBZGRyZXNzXS5nYW1lc1tnYW1lSURdLmhpdDNIYXNoW3NoYTMoIG51bWJlcnNbMF0sIG51bWJlcnNbMV0sIG51bWJlcnNbMl0gKV07CgkJCQkJdmFsdWUgKz0gaGl0M0NvdW50ICogZ2FtZXNbZ2FtZUlEXS5oaXQzVmFsdWU7CgkJCQkJaGl0MkNvdW50ID0gcGxheWVyc1tBZGRyZXNzXS5nYW1lc1tnYW1lSURdLmhpdDJIYXNoW3NoYTMoIG51bWJlcnNbMF0sIG51bWJlcnNbMV0gKV07CgkJCQkJaGl0MkNvdW50ICs9IHBsYXllcnNbQWRkcmVzc10uZ2FtZXNbZ2FtZUlEXS5oaXQySGFzaFtzaGEzKCBudW1iZXJzWzBdLCBudW1iZXJzWzJdICldOwoJCQkJCWhpdDJDb3VudCArPSBwbGF5ZXJzW0FkZHJlc3NdLmdhbWVzW2dhbWVJRF0uaGl0Mkhhc2hbc2hhMyggbnVtYmVyc1sxXSwgbnVtYmVyc1syXSApXTsKCQkJCQloaXQyQ291bnQgLT0gaGl0M0NvdW50KjM7CgkJCQkJdmFsdWUgKz0gaGl0MkNvdW50ICogZ2FtZXNbZ2FtZUlEXS5oaXQyVmFsdWU7CgkJCQl9IGVsc2UgaWYgKCAhIGNvbnRyYWN0RW5hYmxlZCAmJiBnYW1lSUQgPT0gY3VycmVudEdhbWUpIHsKCQkJCQl2YWx1ZSArPSBwbGF5ZXJzW0FkZHJlc3NdLmdhbWVzW2dhbWVJRF0ubnVtYmVyc0J5dGVzLmxlbmd0aCAqIHRpY2tldFByaWNlOwoJCQkJfQoJCQl9CgkJCWlmIChnYW1lSUQgPT0gMCB8fCBnYW1lSUQtcHJpemVEaXNtaXNzRGVsYXkgPT0gZ2FtZUlEKSB7IGJyZWFrOyB9CgkJfQoJfQoJLyogY2FsbGJhY2sgZnVuY3Rpb24gKi8KCWZ1bmN0aW9uICgpIHsKCQl2YXIgTnVtYmVycyA9IGdldE51bWJlcnNGcm9tSGFzaChzaGEzKGJsb2NrLmNvaW5iYXNlLCBub3csIHRpY2tldENvdW50ZXIpKTsKCQlDcmVhdGVUaWNrZXQobXNnLnNlbmRlciwgTnVtYmVyc1swXSwgTnVtYmVyc1sxXSwgTnVtYmVyc1syXSk7Cgl9CgkvKiBleHRlcm5hbCBmdW5jdGlvbnMgZm9yIHBsYXllcnMgKi8KCWZ1bmN0aW9uIEJ1eVRpY2tldCh1aW50OCBOdW1iZXIxLCB1aW50OCBOdW1iZXIyLCB1aW50OCBOdW1iZXIzKSBleHRlcm5hbCB7CgkgICAgQ3JlYXRlVGlja2V0KG1zZy5zZW5kZXIsIE51bWJlcjEsIE51bWJlcjIsIE51bWJlcjMpOwoJfQoJZnVuY3Rpb24gQ2hlY2tUaWNrZXRzKCkgZXh0ZXJuYWwgbm9FdGhlciBub0NvbnRyYWN0IHsKCQl1aW50IF92YWx1ZTsKCQl1aW50IF9zdWJWYWx1ZTsKCQl1aW50IGdhbWVJRDsKCQl1aW50IGdhbWVMb3dJRDsKCQl1aW50OFszXSBtZW1vcnkgbnVtYmVyczsKCQlib29sIGNoYW5nZWQ7CgkJdWludCBoaXQzQ291bnQ7CgkJdWludCBoaXQyQ291bnQ7CgkJZm9yICggZ2FtZUlEPWN1cnJlbnRHYW1lIDsgZ2FtZUlEPj0wIDsgZ2FtZUlELS0gKSB7CgkJCWlmICggISBwbGF5ZXJzW21zZy5zZW5kZXJdLmdhbWVzW2dhbWVJRF0uY2hlY2tlZCkgewoJCQkJaWYgKGdhbWVzW2dhbWVJRF0uZHJhd0RvbmUpIHsKCQkJCQludW1iZXJzID0gZ2V0TnVtYmVyc0Zyb21CeXRlcyhnYW1lc1tnYW1lSURdLndpbm5pbmdOdW1iZXJzQnl0ZXMpOwoJCQkJCWhpdDNDb3VudCA9IHBsYXllcnNbbXNnLnNlbmRlcl0uZ2FtZXNbZ2FtZUlEXS5oaXQzSGFzaFtzaGEzKCBudW1iZXJzWzBdLCBudW1iZXJzWzFdLCBudW1iZXJzWzJdICldOwoJCQkJCV9zdWJWYWx1ZSArPSBoaXQzQ291bnQgKiBnYW1lc1tnYW1lSURdLmhpdDNWYWx1ZTsKCQkJCQloaXQyQ291bnQgPSBwbGF5ZXJzW21zZy5zZW5kZXJdLmdhbWVzW2dhbWVJRF0uaGl0Mkhhc2hbc2hhMyggbnVtYmVyc1swXSwgbnVtYmVyc1sxXSApXTsKCQkJCQloaXQyQ291bnQgKz0gcGxheWVyc1ttc2cuc2VuZGVyXS5nYW1lc1tnYW1lSURdLmhpdDJIYXNoW3NoYTMoIG51bWJlcnNbMF0sIG51bWJlcnNbMl0gKV07CgkJCQkJaGl0MkNvdW50ICs9IHBsYXllcnNbbXNnLnNlbmRlcl0uZ2FtZXNbZ2FtZUlEXS5oaXQySGFzaFtzaGEzKCBudW1iZXJzWzFdLCBudW1iZXJzWzJdICldOwoJCQkJCWhpdDJDb3VudCAtPSBoaXQzQ291bnQqMzsKCQkJCQlfc3ViVmFsdWUgKz0gaGl0MkNvdW50ICogZ2FtZXNbZ2FtZUlEXS5oaXQyVmFsdWU7CgkJCQkJZ2FtZXNbZ2FtZUlEXS5wcml6ZVBvdCAtPSBfc3ViVmFsdWU7CgkJCQkJX3ZhbHVlICs9IF9zdWJWYWx1ZTsKCQkJCQlwbGF5ZXJzW21zZy5zZW5kZXJdLmdhbWVzW2dhbWVJRF0uY2hlY2tlZCA9IHRydWU7CgkJCQkJY2hhbmdlZCA9IHRydWU7CgkJCQl9IGVsc2UgaWYgKCAhIGNvbnRyYWN0RW5hYmxlZCAmJiBnYW1lSUQgPT0gY3VycmVudEdhbWUpIHsKCQkJCQlfdmFsdWUgKz0gcGxheWVyc1ttc2cuc2VuZGVyXS5nYW1lc1tnYW1lSURdLm51bWJlcnNCeXRlcy5sZW5ndGggKiB0aWNrZXRQcmljZTsKCQkJCQlwbGF5ZXJzW21zZy5zZW5kZXJdLmdhbWVzW2dhbWVJRF0uY2hlY2tlZCA9IHRydWU7CgkJCQkJY2hhbmdlZCA9IHRydWU7CgkJCQl9CgkJCX0KCQkJaWYgKGdhbWVJRCA9PSAwIHx8IGdhbWVJRC1wcml6ZURpc21pc3NEZWxheSA9PSBnYW1lSUQpIHsgYnJlYWs7IH0KCQl9CgkJaWYgKCAhIGNoYW5nZWQpIHsgdGhyb3c7IH0KCQlpZiAoX3ZhbHVlID4gMCkgeyBpZiAoICEgbXNnLnNlbmRlci5zZW5kKF92YWx1ZSkpIHsgdGhyb3c7IH0gfQoJfQoJZnVuY3Rpb24gQnV5VGlja2V0Rm9yT3RoZXIoYWRkcmVzcyBBZGRyZXNzLCB1aW50OCBOdW1iZXIxLCB1aW50OCBOdW1iZXIyLCB1aW50OCBOdW1iZXIzKSBleHRlcm5hbCB7CgkgICAgaWYgKEFkZHJlc3MgPT0gMHgwKSB7IHRocm93OyB9CgkgICAgQ3JlYXRlVGlja2V0KEFkZHJlc3MsIE51bWJlcjEsIE51bWJlcjIsIE51bWJlcjMpOwoJfQoJLyogZXh0ZXJuYWwgZnVuY3Rpb25zIGZvciBpbnZlc3RvcnMgKi8KCWZ1bmN0aW9uIEludmVzdEFkZCgpIGV4dGVybmFsIE9ubHlFbmFibGVkIG5vQ29udHJhY3QgewoJCXVpbnQgdmFsdWVfID0gbXNnLnZhbHVlOwoJCWlmICh2YWx1ZV8gPCBpbnZlc3RVbml0KSB7IHRocm93OyB9CgkJaWYgKHZhbHVlXyAlIGludmVzdFVuaXQgPiAwKSB7IAoJCQlpZiAoICEgbXNnLnNlbmRlci5zZW5kKCB2YWx1ZV8gJSBpbnZlc3RVbml0ICkpIHsgdGhyb3c7IH0gCgkJCXZhbHVlXyA9IHZhbHVlXyAtICh2YWx1ZV8gJSBpbnZlc3RVbml0KTsKCQl9CgkJaWYgKHZhbHVlXyA8IGludmVzdE1pbmltdW0pIHsgdGhyb3c7IH0KCQl2YXIgKGZvdW5kLCBJbnZlc3RvcklEKSA9IGdldEludmVzdG9yQnlBZGRyZXNzKG1zZy5zZW5kZXIpOwoJCWlmIChmb3VuZCA9PSBmYWxzZSkgewoJCQlpZiAoaW52ZXN0b3JzLmxlbmd0aCA9PSBpbnZlc3RVc2VyTGltaXQpIHsgdGhyb3c7IH0KCQkJSW52ZXN0b3JJRCA9IGludmVzdG9ycy5sZW5ndGg7CgkJCWludmVzdG9ycy5sZW5ndGgrKzsKCQl9CgkJaWYgKGludmVzdG9yc1tJbnZlc3RvcklEXS52YWxpZCAmJiBpbnZlc3RvcnNbSW52ZXN0b3JJRF0ubGl2ZSkgewoJCQlpbnZlc3RvcnNbSW52ZXN0b3JJRF0udmFsdWUgKz0gdmFsdWVfOwoJCX0gZWxzZSB7CgkJCWludmVzdG9yc1tJbnZlc3RvcklEXS52YWx1ZSA9IHZhbHVlXzsKCQl9CgkJaW52ZXN0b3JzW0ludmVzdG9ySURdLmJlZ2lucyA9IGN1cnJlbnRHYW1lOwoJCWludmVzdG9yc1tJbnZlc3RvcklEXS52YWxpZCA9IHRydWU7CgkJaW52ZXN0b3JzW0ludmVzdG9ySURdLmxpdmUgPSB0cnVlOwoJCWludmVzdG9yc1tJbnZlc3RvcklEXS5vd25lciA9IG1zZy5zZW5kZXI7CgkJaW52ZXN0bWVudHNWYWx1ZSArPSB2YWx1ZV87CgkJc2V0SmFja3BvdCgpOwoJCUludmVzdEFkZEV2ZW50KG1zZy5zZW5kZXIsIHZhbHVlXyk7Cgl9CglmdW5jdGlvbiBJbnZlc3RXaXRoZHJhdygpIGV4dGVybmFsIG5vRXRoZXIgewoJCXZhciAoZm91bmQsIEludmVzdG9ySUQpID0gZ2V0SW52ZXN0b3JCeUFkZHJlc3MobXNnLnNlbmRlcik7CgkJaWYgKGZvdW5kID09IGZhbHNlKSB7IHRocm93OyB9CgkJaWYgKCAhIGludmVzdG9yc1tJbnZlc3RvcklEXS52YWxpZCkgeyB0aHJvdzsgfQoJCXVpbnQgX2JhbGFuY2UgPSBpbnZlc3RvcnNbSW52ZXN0b3JJRF0uYmFsYW5jZTsKCQlpZiAoX2JhbGFuY2UgPT0gMCkgeyB0aHJvdzsgfQoJCWludmVzdG9yc1tJbnZlc3RvcklEXS5iYWxhbmNlID0gMDsKCQlpZiAoICEgbXNnLnNlbmRlci5zZW5kKCBfYmFsYW5jZSApKSB7IHRocm93OyB9Cgl9CglmdW5jdGlvbiBJbnZlc3RDYW5jZWwoKSBleHRlcm5hbCBub0V0aGVyIHsKCQl2YXIgKGZvdW5kLCBJbnZlc3RvcklEKSA9IGdldEludmVzdG9yQnlBZGRyZXNzKG1zZy5zZW5kZXIpOwoJCWlmIChmb3VuZCA9PSBmYWxzZSkgeyB0aHJvdzsgfQoJCWlmICggISBpbnZlc3RvcnNbSW52ZXN0b3JJRF0udmFsaWQpIHsgdGhyb3c7IH0KCQlpZiAoY29udHJhY3RFbmFibGVkKSB7CgkJCWlmIChpbnZlc3RvcnNbSW52ZXN0b3JJRF0uYmVnaW5zK2ludmVzdE1pbkR1cmF0aW9uIDwgbm93KSB7IHRocm93OyB9CgkJCWlmIChnYW1lc1tjdXJyZW50R2FtZV0uc3RhcnRUaW1lc3RhbXAraW52ZXN0SWRsZVRpbWUgPCBub3cpIHsgdGhyb3c7IH0KCQl9CgkJdWludCBiYWxhbmNlXzsKCQlpZiAoaW52ZXN0b3JzW0ludmVzdG9ySURdLmxpdmUpIHsKCQkJaW52ZXN0bWVudHNWYWx1ZSAtPSBpbnZlc3RvcnNbSW52ZXN0b3JJRF0udmFsdWU7CgkJCWJhbGFuY2VfID0gaW52ZXN0b3JzW0ludmVzdG9ySURdLnZhbHVlOwoJCQlzZXRKYWNrcG90KCk7CgkJCUludmVzdENhbmNlbEV2ZW50KG1zZy5zZW5kZXIsIGludmVzdG9yc1tJbnZlc3RvcklEXS52YWx1ZSk7CgkJfQoJCWlmIChpbnZlc3RvcnNbSW52ZXN0b3JJRF0uYmFsYW5jZSA+IDApIHsKCQkJYmFsYW5jZV8gKz0gaW52ZXN0b3JzW0ludmVzdG9ySURdLmJhbGFuY2U7CgkJfQoJCWRlbGV0ZSBpbnZlc3RvcnNbSW52ZXN0b3JJRF07CgkJaWYgKCAhIG1zZy5zZW5kZXIuc2VuZCggYmFsYW5jZV8gKSkgeyB0aHJvdzsgfQoJfQoJLyogZHJhdyBmdW5jdGlvbnMgZm9yIGV2ZXJ5b25lKi8KCWZ1bmN0aW9uIERyYXdQcmVwYXJlKCkgbm9Db250cmFjdCBPbmx5RW5hYmxlZCBub0V0aGVyIHsKCQlpZiAoZ2FtZXNbY3VycmVudEdhbWVdLmVuZFRpbWVzdGFtcCA+IG5vdyB8fCAoZ2FtZXNbY3VycmVudEdhbWVdLnByZXBhcmVCbG9jayAhPSAwICYmIGdhbWVzW2N1cnJlbnRHYW1lXS5wcmVwYXJlQmxvY2srKGRyYXdCbG9ja0xpbWl0LWRyYXdCbG9ja0RlbGF5KSA+IGJsb2NrLm51bWJlcikpIHsgdGhyb3c7IH0KCQlnYW1lc1tjdXJyZW50R2FtZV0ucHJlcGFyZUJsb2NrID0gYmxvY2subnVtYmVyK2RyYXdCbG9ja0RlbGF5OwoJCURyYXdQcmVwYXJlRXZlbnQoZ2FtZXNbY3VycmVudEdhbWVdLnByZXBhcmVCbG9jayk7Cgl9CglmdW5jdGlvbiBEcmF3KCkgbm9Db250cmFjdCBPbmx5RW5hYmxlZCBub0V0aGVyIHsKCQlpZiAoZ2FtZXNbY3VycmVudEdhbWVdLnByZXBhcmVCbG9jayA9PSAwIHx8IGdhbWVzW2N1cnJlbnRHYW1lXS5wcmVwYXJlQmxvY2sgPiBibG9jay5udW1iZXIgfHwgZ2FtZXNbY3VycmVudEdhbWVdLnByZXBhcmVCbG9jaysoZHJhd0Jsb2NrTGltaXQtZHJhd0Jsb2NrRGVsYXkpIDw9IGJsb2NrLm51bWJlcikgeyB0aHJvdzsgfQoJCWJ5dGVzMzIgX2hhc2g7CgkJdWludCBoaXQzVmFsdWU7CgkJdWludCBoaXQzQ291bnQ7CgkJdWludCBoaXQyVmFsdWU7CgkJdWludCBoaXQyQ291bnQ7CgkJdWludCBhOwoJCWZvciAoIGEgPSAxIDsgYSA8PSBkcmF3QmxvY2tEZWxheSA7IGErKyApIHsKCQkJX2hhc2ggPSBzaGEzKF9oYXNoLCBibG9jay5ibG9ja2hhc2goZ2FtZXNbY3VycmVudEdhbWVdLnByZXBhcmVCbG9jayAtIGRyYXdCbG9ja0RlbGF5K2EpKTsKCQl9CgkJdmFyIG51bWJlcnMgPSBnZXROdW1iZXJzRnJvbUhhc2goX2hhc2gpOwoJCWdhbWVzW2N1cnJlbnRHYW1lXS53aW5uaW5nTnVtYmVyc0J5dGVzID0gZ2V0Qnl0ZXNGcm9tTnVtYmVycyggbnVtYmVycyApOwoJCWhpdDNDb3VudCArPSBnYW1lc1tjdXJyZW50R2FtZV0uaGl0M0hhc2hbIHNoYTMoIG51bWJlcnNbMF0sIG51bWJlcnNbMV0sbnVtYmVyc1syXSApIF07CgkJaGl0MkNvdW50ICs9IGdhbWVzW2N1cnJlbnRHYW1lXS5oaXQySGFzaFsgc2hhMyggbnVtYmVyc1swXSwgbnVtYmVyc1sxXSkgXTsKCQloaXQyQ291bnQgKz0gZ2FtZXNbY3VycmVudEdhbWVdLmhpdDJIYXNoWyBzaGEzKCBudW1iZXJzWzBdLCBudW1iZXJzWzJdKSBdOwoJCWhpdDJDb3VudCArPSBnYW1lc1tjdXJyZW50R2FtZV0uaGl0Mkhhc2hbIHNoYTMoIG51bWJlcnNbMV0sIG51bWJlcnNbMl0pIF07CgkJaGl0MkNvdW50IC09IGhpdDNDb3VudCozOwoJCXVpbnQgdG90YWxQb3QgPSBnYW1lc1tjdXJyZW50R2FtZV0udGlja2V0c0NvdW50KnRpY2tldFByaWNlOwoJCWhpdDJWYWx1ZSA9ICggdG90YWxQb3QgKiBmb3JIaXQyIC8gMTAwICk7CgkJaWYgKGhpdDJDb3VudCA+IDApIHsKCQkJZ2FtZXNbY3VycmVudEdhbWVdLnByaXplUG90ID0gaGl0MlZhbHVlOwoJCX0KCQloaXQyVmFsdWUgPSBoaXQyVmFsdWUgLyBoaXQyQ291bnQ7CgkJdG90YWxQb3QgLT0gaGl0MlZhbHVlOwoJCXVpbnQgX293bmVyQmFsYW5jZSA9IHRvdGFsUG90ICogZm9yT3duZXIgLyAxMDA7CgkJdG90YWxQb3QgLT0gX293bmVyQmFsYW5jZTsKCQlvd25lckJhbGFuY2UgKz0gX293bmVyQmFsYW5jZTsKCQl1aW50IF9hZGRJbnZlc3RvcnNWYWx1ZSA9IHRvdGFsUG90ICogZm9ySW52ZXN0b3JzIC8gMTAwOwoJCWFkZEludmVzdG9yc1ZhbHVlKF9hZGRJbnZlc3RvcnNWYWx1ZSk7CgkJdG90YWxQb3QgLT0gX2FkZEludmVzdG9yc1ZhbHVlOwoJCWlmIChoaXQzQ291bnQgPiAwKSB7CgkJCWdhbWVzW2N1cnJlbnRHYW1lXS5wcml6ZVBvdCArPSBjdXJyZW50SmFja3BvdDsKCQkJZm9yICggYT0wIDsgYSA8IGludmVzdG9ycy5sZW5ndGggOyBhKysgKSB7CgkJCQlkZWxldGUgaW52ZXN0b3JzW2FdLmxpdmU7CgkJCX0KCQkJaGl0M1ZhbHVlID0gY3VycmVudEphY2twb3QgLyBoaXQzQ291bnQ7CgkJCWV4dHJhSmFja3BvdCA9IDA7CgkJCWludmVzdG1lbnRzVmFsdWUgPSAwOwoJCX0KCQlleHRyYUphY2twb3QgKz0gdG90YWxQb3Q7CgkJRHJhd0V2ZW50KGN1cnJlbnRHYW1lK29sZENvbnRyYWN0TGFzdEdhbWUsIG51bWJlcnNbMF0sIG51bWJlcnNbMV0sIG51bWJlcnNbMl0sIGhpdDNDb3VudCwgaGl0M1ZhbHVlLCBoaXQyQ291bnQsIGhpdDJWYWx1ZSk7CgkJV0xCRHJhd3NEQiggV0xCZHJhd3NEQkFkZHIgKS5uZXdEcmF3KCBub3csIG51bWJlcnMsIGhpdDNDb3VudCwgaGl0M1ZhbHVlLCBoaXQyQ291bnQsIGhpdDJWYWx1ZSk7CgkJZ2FtZXNbY3VycmVudEdhbWVdLmhpdDNDb3VudCA9IGhpdDNDb3VudDsKCQlnYW1lc1tjdXJyZW50R2FtZV0uaGl0M1ZhbHVlID0gaGl0M1ZhbHVlOwoJCWdhbWVzW2N1cnJlbnRHYW1lXS5oaXQyQ291bnQgPSBoaXQyQ291bnQ7CgkJZ2FtZXNbY3VycmVudEdhbWVdLmhpdDJWYWx1ZSA9IGhpdDJWYWx1ZTsKCQlnYW1lc1tjdXJyZW50R2FtZV0uZHJhd0RvbmUgPSB0cnVlOwoJCW5ld0dhbWUoKTsKCQlzZXRKYWNrcG90KCk7Cgl9CgkvKiBvd25lciBmdW5jdGlvbnMgKi8KCWZ1bmN0aW9uIE93bmVyR2V0RmVlKCkgZXh0ZXJuYWwgT25seU93bmVyIHsKCQlpZiAob3duZXJCYWxhbmNlID09IDApIHsgdGhyb3c7IH0KCQlpZiAob3duZXIuc2VuZChvd25lckJhbGFuY2UpID09IGZhbHNlKSB7IHRocm93OyB9CgkJb3duZXJCYWxhbmNlID0gMDsKCX0KCWZ1bmN0aW9uIE93bmVyQ2xvc2VDb250cmFjdCgpIGV4dGVybmFsIE9ubHlPd25lciBub0V0aGVyIHsKCQlpZiAoICEgY29udHJhY3RFbmFibGVkKSB7CgkJCWlmIChjb250cmFjdERpc2FibGVkVGltZVN0YW1wK2NvbnRyYWN0RGlzbWlzc0RlbGF5IDwgbm93KSB7CgkJCQlzdWljaWRlKG93bmVyKTsKCQkJfQoJCX0gZWxzZSB7CgkJCWNvbnRyYWN0RW5hYmxlZCA9IGZhbHNlOwoJCQljb250cmFjdERpc2FibGVkVGltZVN0YW1wID0gbm93OwoJCQlDb250cmFjdERpc2FibGVkRXZlbnQoY29udHJhY3REaXNhYmxlZFRpbWVTdGFtcCtjb250cmFjdERpc21pc3NEZWxheSk7CgkJCW93bmVyQmFsYW5jZSArPSBleHRyYUphY2twb3Q7CgkJCWV4dHJhSmFja3BvdCA9IDA7CgkJCWdhbWVzW2N1cnJlbnRHYW1lXS5wcml6ZVBvdCA9IGdhbWVzW2N1cnJlbnRHYW1lXS50aWNrZXRzQ291bnQqdGlja2V0UHJpY2U7CgkJfQoJfQoJLyogcHJpdmF0ZSBmdW5jdGlvbnMgKi8KICAgIGZ1bmN0aW9uIENyZWF0ZVRpY2tldChhZGRyZXNzIEFkZHIsIHVpbnQ4IE51bWJlcjEsIHVpbnQ4IE51bWJlcjIsIHVpbnQ4IE51bWJlcjMpIHByaXZhdGUgbm9Db250cmFjdCBPbmx5RW5hYmxlZCB7CgkJdmFyIE51bWJlcnMgPSBbTnVtYmVyMSAsIE51bWJlcjIgLCBOdW1iZXIzXTsKCQlpZiAoICEgY2hlY2tOdW1iZXJzKCBOdW1iZXJzICkpIHsgdGhyb3c7IH0KCQlOdW1iZXJzID0gc29ydE51bWJlcnMoTnVtYmVycyk7CgkJaWYgKG1zZy52YWx1ZSA8IHRpY2tldFByaWNlKSB7IHRocm93OyB9CgkJaWYgKG1zZy52YWx1ZS10aWNrZXRQcmljZSA+IDApIHsgaWYgKCAhIEFkZHIuc2VuZCggbXNnLnZhbHVlLXRpY2tldFByaWNlICkpIHsgdGhyb3c7IH0gfQoJCWlmIChjdXJyZW50SmFja3BvdCA9PSAwKSB7IHRocm93OyB9CgkJaWYgKGdhbWVzW2N1cnJlbnRHYW1lXS5lbmRUaW1lc3RhbXAgPCBub3cpIHsgdGhyb3c7IH0KCQl0aWNrZXRDb3VudGVyKys7CgkJZ2FtZXNbY3VycmVudEdhbWVdLnRpY2tldHNDb3VudCsrOwoJCWJ5dGVzMzIgaGFzaDAgPSBzaGEzKCBOdW1iZXJzWzBdLCBOdW1iZXJzWzFdLCBOdW1iZXJzWzJdICk7CgkJYnl0ZXMzMiBoYXNoMSA9IHNoYTMoIE51bWJlcnNbMF0sIE51bWJlcnNbMV0pOwoJCWJ5dGVzMzIgaGFzaDIgPSBzaGEzKCBOdW1iZXJzWzBdLCBOdW1iZXJzWzJdKTsKCQlieXRlczMyIGhhc2gzID0gc2hhMyggTnVtYmVyc1sxXSwgTnVtYmVyc1syXSk7CgkJZ2FtZXNbY3VycmVudEdhbWVdLmhpdDNIYXNoW2hhc2gwXSsrOwoJCWdhbWVzW2N1cnJlbnRHYW1lXS5oaXQySGFzaFtoYXNoMV0rKzsKCQlnYW1lc1tjdXJyZW50R2FtZV0uaGl0Mkhhc2hbaGFzaDJdKys7CgkJZ2FtZXNbY3VycmVudEdhbWVdLmhpdDJIYXNoW2hhc2gzXSsrOwoJCXBsYXllcnNbQWRkcl0uZ2FtZXNbY3VycmVudEdhbWVdLm51bWJlcnNCeXRlcy5wdXNoICggZ2V0Qnl0ZXNGcm9tTnVtYmVycyhOdW1iZXJzKSApOwoJCXBsYXllcnNbQWRkcl0uZ2FtZXNbY3VycmVudEdhbWVdLmhpdDNIYXNoW2hhc2gwXSsrOwoJCXBsYXllcnNbQWRkcl0uZ2FtZXNbY3VycmVudEdhbWVdLmhpdDJIYXNoW2hhc2gxXSsrOwoJCXBsYXllcnNbQWRkcl0uZ2FtZXNbY3VycmVudEdhbWVdLmhpdDJIYXNoW2hhc2gyXSsrOwoJCXBsYXllcnNbQWRkcl0uZ2FtZXNbY3VycmVudEdhbWVdLmhpdDJIYXNoW2hhc2gzXSsrOwoJCU5ld1RpY2tldEV2ZW50KCBBZGRyLCBOdW1iZXJzWzBdLCBOdW1iZXJzWzFdLCBOdW1iZXJzWzJdICk7Cgl9CglmdW5jdGlvbiBhZGRJbnZlc3RvcnNWYWx1ZSh1aW50IHZhbHVlKSBwcml2YXRlIHsKCQlib29sIGRvbmU7CgkJdWludCBhOwoJCWZvciAoIGE9MCA7IGEgPCBpbnZlc3RvcnMubGVuZ3RoIDsgYSsrICkgewoJCQlpZiAoaW52ZXN0b3JzW2FdLmxpdmUgJiYgaW52ZXN0b3JzW2FdLnZhbGlkKSB7CgkJCQlpbnZlc3RvcnNbYV0uYmFsYW5jZSArPSB2YWx1ZSAqIGludmVzdG9yc1thXS52YWx1ZSAvIGludmVzdG1lbnRzVmFsdWU7CgkJCQlkb25lID0gdHJ1ZTsKCQkJfQoJCX0KCQlpZiAoICEgZG9uZSkgewoJCQlvd25lckJhbGFuY2UgKz0gdmFsdWU7CgkJfQoJfQoJZnVuY3Rpb24gbmV3R2FtZSgpIHByaXZhdGUgewoJCXZhciBuZXh0RHJhdyA9IGdhbWVzW2N1cnJlbnRHYW1lXS5lbmRUaW1lc3RhbXAgICsgMSB3ZWVrczsKCQljdXJyZW50R2FtZSsrOwoJCXVpbnQgZ2FtZXNJRCA9IGdhbWVzLmxlbmd0aDsKCQlnYW1lcy5sZW5ndGgrKzsKCQlnYW1lc1tnYW1lc0lEXS5zdGFydFRpbWVzdGFtcCA9IG5vdzsKCQlnYW1lc1tnYW1lc0lEXS5lbmRUaW1lc3RhbXAgPSBuZXh0RHJhdzsKCQlpZiAoZ2FtZXMubGVuZ3RoID4gcHJpemVEaXNtaXNzRGVsYXkpIHsKICAgICAgICAgICAgZXh0cmFKYWNrcG90ICs9IGdhbWVzW2N1cnJlbnRHYW1lLXByaXplRGlzbWlzc0RlbGF5XS5wcml6ZVBvdDsKCQkJZGVsZXRlIGdhbWVzW2N1cnJlbnRHYW1lLXByaXplRGlzbWlzc0RlbGF5XTsKCQl9Cgl9CglmdW5jdGlvbiBnZXROdW1iZXJzRnJvbUhhc2goYnl0ZXMzMiBoYXNoKSBwcml2YXRlIHJldHVybnMgKHVpbnQ4WzNdIG51bWJlcnMpIHsKCQlib29sIG9rID0gdHJ1ZTsKCQl1aW50OCBudW0gPSAwOwoJCXVpbnQgaGFzaHBvcyA9IDA7CgkJdWludDggYTsKCQl1aW50OCBiOwoJCWZvciAoYSA9IDAgOyBhIDwgbnVtYmVycy5sZW5ndGggOyBhKyspIHsKCQkJd2hpbGUgKHRydWUpIHsKCQkJCW9rID0gdHJ1ZTsKCQkJCWlmIChoYXNocG9zID09IDMyKSB7CgkJCQkJaGFzaHBvcyA9IDA7CgkJCQkJaGFzaCA9IHNoYTMoaGFzaCk7CgkJCQl9CgkJCQludW0gPSBnZXRQYXJ0KCBoYXNoLCBoYXNocG9zICk7CgkJCQludW0gPSBudW0gJSB1aW50OChkcmF3TWF4TnVtYmVyKSArIDE7CgkJCQloYXNocG9zICs9IDE7CgkJCQlmb3IgKGIgPSAwIDsgYiA8IG51bWJlcnMubGVuZ3RoIDsgYisrKSB7CgkJCQkJaWYgKG51bWJlcnNbYl0gPT0gbnVtKSB7CgkJCQkJCW9rID0gZmFsc2U7CgkJCQkJCWJyZWFrOyAKCQkJCQl9CgkJCQl9CgkJCQlpZiAob2sgPT0gdHJ1ZSkgewoJCQkJCW51bWJlcnNbYV0gPSBudW07CgkJCQkJYnJlYWs7CgkJCQl9CgkJCX0KCQl9CgkJbnVtYmVycyA9IHNvcnROdW1iZXJzKCBudW1iZXJzICk7Cgl9CglmdW5jdGlvbiBnZXRQYXJ0KGJ5dGVzMzIgYSwgdWludCBpKSBwcml2YXRlIHJldHVybnMgKHVpbnQ4KSB7IHJldHVybiB1aW50OChieXRlKGJ5dGVzMzIodWludChhKSAqIDIgKiogKDggKiBpKSkpKTsgfQoJZnVuY3Rpb24gc2V0SmFja3BvdCgpIHByaXZhdGUgewoJCWN1cnJlbnRKYWNrcG90ID0gaW52ZXN0bWVudHNWYWx1ZSArIGV4dHJhSmFja3BvdDsKCX0KCWZ1bmN0aW9uIGdldEludmVzdG9yQnlBZGRyZXNzKGFkZHJlc3MgQWRkcmVzcykgcHJpdmF0ZSByZXR1cm5zIChib29sIGZvdW5kLCB1aW50IGlkKSB7CgkJZm9yICggaWQ9MCA7IGlkIDwgaW52ZXN0b3JzLmxlbmd0aCA7IGlkKysgKSB7CgkJCWlmIChpbnZlc3RvcnNbaWRdLm93bmVyID09IEFkZHJlc3MpIHsKCQkJCXJldHVybiAodHJ1ZSwgaWQpOwoJCQl9CgkJfQoJCXJldHVybiAoZmFsc2UsIDApOwoJfQoJZnVuY3Rpb24gY2hlY2tOdW1iZXJzKHVpbnQ4WzNdIE51bWJlcnMpIHByaXZhdGUgcmV0dXJucyAoYm9vbCkgewoJCWZvciAoIHVpbnQgYSA9IDAgOyBhIDwgTnVtYmVycy5sZW5ndGggOyBhKysgKSB7CgkJCWlmIChOdW1iZXJzW2FdID4gZHJhd01heE51bWJlciB8fCBOdW1iZXJzW2FdID09IDApIHsgcmV0dXJuOyB9CgkJCWZvciAoIHVpbnQgYiA9IDAgOyBhIDwgTnVtYmVycy5sZW5ndGggOyBhKysgKSB7CgkJCQlpZiAoYSAhPSBiICYmIE51bWJlcnNbYV0gPT0gTnVtYmVyc1tiXSkgeyByZXR1cm47IH0KCQkJfQoJCX0KCQlyZXR1cm4gdHJ1ZTsKCX0KCWZ1bmN0aW9uIHNvcnROdW1iZXJzKHVpbnQ4WzNdIG51bWJlcnMpIHByaXZhdGUgcmV0dXJucyh1aW50OFszXSBzTnVtYmVycykgewoJCXNOdW1iZXJzID0gbnVtYmVyczsKCQlmb3IgKHVpbnQ4IGk9MDsgaTxudW1iZXJzLmxlbmd0aDsgaSsrKSB7CgkJCWZvciAodWludDggaj1pKzE7IGo8bnVtYmVycy5sZW5ndGg7IGorKykgewoJCQkJaWYgKHNOdW1iZXJzW2ldID4gc051bWJlcnNbal0pIHsKCQkJCQl1aW50OCB0ID0gc051bWJlcnNbaV07CgkJCQkJc051bWJlcnNbaV0gPSBzTnVtYmVyc1tqXTsKCQkJCQlzTnVtYmVyc1tqXSA9IHQ7CgkJCQl9CgkJCX0KCQl9Cgl9CglmdW5jdGlvbiBnZXROdW1iZXJzRnJvbUJ5dGVzKGJ5dGVzMyBCeXRlcykgcHJpdmF0ZSByZXR1cm5zICh1aW50OFszXSBOdW1iZXJzKXsKCQlOdW1iZXJzWzBdID0gdWludDgoQnl0ZXMpOwoJCU51bWJlcnNbMV0gPSB1aW50OCh1aW50MjQoQnl0ZXMpIC8yNTYpOwoJCU51bWJlcnNbMl0gPSB1aW50OCh1aW50MjQoQnl0ZXMpIC8yNTYvMjU2KTsKCX0KCWZ1bmN0aW9uIGdldEJ5dGVzRnJvbU51bWJlcnModWludDhbM10gTnVtYmVycykgcHJpdmF0ZSByZXR1cm5zIChieXRlczMgQnl0ZXMpIHsKCQlyZXR1cm4gYnl0ZXMzKHVpbnQoTnVtYmVyc1swXSkrdWludChOdW1iZXJzWzFdKSoyNTYrdWludChOdW1iZXJzWzJdKSoyNTYqMjU2KTsKCX0KCS8qIG1vZGlmaWVycyAqLwoJbW9kaWZpZXIgbm9Db250cmFjdCgpIHtpZiAodHgub3JpZ2luICE9IG1zZy5zZW5kZXIpIHsgdGhyb3c7IH0gXzsgfQltb2RpZmllciBub0V0aGVyKCkgeyBpZiAobXNnLnZhbHVlID4gMCkgeyB0aHJvdzsgfSBfOyB9CW1vZGlmaWVyIE9ubHlPd25lcigpIHsgaWYgKG93bmVyICE9IG1zZy5zZW5kZXIpIHsgdGhyb3c7IH0gXzsgfQltb2RpZmllciBPbmx5RW5hYmxlZCgpIHsgaWYgKCAhIGNvbnRyYWN0RW5hYmxlZCkgeyB0aHJvdzsgfSBfOyB9fQ=='.
	

]
