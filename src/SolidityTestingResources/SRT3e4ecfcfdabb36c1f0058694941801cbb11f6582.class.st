Class {
	#name : #SRT3e4ecfcfdabb36c1f0058694941801cbb11f6582,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT3e4ecfcfdabb36c1f0058694941801cbb11f6582 >> base64 [
	^ 'Ly8gV0VMQ09NRSBUTyBUSEUgRU9TQkVULklPIEJVRyBCT1VOVFkgQ09OVFJBQ1RTIQovLyBHT09EIExVQ0suLi4gWU9VJ0xMIE5FRUQgSVQhCgpwcmFnbWEgc29saWRpdHkgXjAuNC4yMTsKCi8vIDxPUkFDTElaRV9BUEk+Ci8qCkNvcHlyaWdodCAoYykgMjAxNS0yMDE2IE9yYWNsaXplIFNSTApDb3B5cmlnaHQgKGMpIDIwMTYgT3JhY2xpemUgTFRECgoKClBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkKb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksIHRvIGRlYWwKaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cwp0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsCmNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcwpmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgoKCgpUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbgphbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KCgoKVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksCkZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEUKQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUgpMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLApPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOClRIRSBTT0ZUV0FSRS4KKi8KCi8vIFRoaXMgYXBpIGlzIGN1cnJlbnRseSB0YXJnZXRlZCBhdCAwLjQuMTgsIHBsZWFzZSBpbXBvcnQgb3JhY2xpemVBUElfcHJlMC40LnNvbCBvciBvcmFjbGl6ZUFQSV8wLjQgd2hlcmUgbmVjZXNzYXJ5CnByYWdtYSBzb2xpZGl0eSBeMC40LjE4OwoKY29udHJhY3QgT3JhY2xpemVJIHsKICAgIGFkZHJlc3MgcHVibGljIGNiQWRkcmVzczsKICAgIGZ1bmN0aW9uIHF1ZXJ5KHVpbnQgX3RpbWVzdGFtcCwgc3RyaW5nIF9kYXRhc291cmNlLCBzdHJpbmcgX2FyZykgZXh0ZXJuYWwgcGF5YWJsZSByZXR1cm5zIChieXRlczMyIF9pZCk7CiAgICBmdW5jdGlvbiBxdWVyeV93aXRoR2FzTGltaXQodWludCBfdGltZXN0YW1wLCBzdHJpbmcgX2RhdGFzb3VyY2UsIHN0cmluZyBfYXJnLCB1aW50IF9nYXNsaW1pdCkgZXh0ZXJuYWwgcGF5YWJsZSByZXR1cm5zIChieXRlczMyIF9pZCk7CiAgICBmdW5jdGlvbiBxdWVyeTIodWludCBfdGltZXN0YW1wLCBzdHJpbmcgX2RhdGFzb3VyY2UsIHN0cmluZyBfYXJnMSwgc3RyaW5nIF9hcmcyKSBwdWJsaWMgcGF5YWJsZSByZXR1cm5zIChieXRlczMyIF9pZCk7CiAgICBmdW5jdGlvbiBxdWVyeTJfd2l0aEdhc0xpbWl0KHVpbnQgX3RpbWVzdGFtcCwgc3RyaW5nIF9kYXRhc291cmNlLCBzdHJpbmcgX2FyZzEsIHN0cmluZyBfYXJnMiwgdWludCBfZ2FzbGltaXQpIGV4dGVybmFsIHBheWFibGUgcmV0dXJucyAoYnl0ZXMzMiBfaWQpOwogICAgZnVuY3Rpb24gcXVlcnlOKHVpbnQgX3RpbWVzdGFtcCwgc3RyaW5nIF9kYXRhc291cmNlLCBieXRlcyBfYXJnTikgcHVibGljIHBheWFibGUgcmV0dXJucyAoYnl0ZXMzMiBfaWQpOwogICAgZnVuY3Rpb24gcXVlcnlOX3dpdGhHYXNMaW1pdCh1aW50IF90aW1lc3RhbXAsIHN0cmluZyBfZGF0YXNvdXJjZSwgYnl0ZXMgX2FyZ04sIHVpbnQgX2dhc2xpbWl0KSBleHRlcm5hbCBwYXlhYmxlIHJldHVybnMgKGJ5dGVzMzIgX2lkKTsKICAgIGZ1bmN0aW9uIGdldFByaWNlKHN0cmluZyBfZGF0YXNvdXJjZSkgcHVibGljIHJldHVybnMgKHVpbnQgX2RzcHJpY2UpOwogICAgZnVuY3Rpb24gZ2V0UHJpY2Uoc3RyaW5nIF9kYXRhc291cmNlLCB1aW50IGdhc2xpbWl0KSBwdWJsaWMgcmV0dXJucyAodWludCBfZHNwcmljZSk7CiAgICBmdW5jdGlvbiBzZXRQcm9vZlR5cGUoYnl0ZSBfcHJvb2ZUeXBlKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIHNldEN1c3RvbUdhc1ByaWNlKHVpbnQgX2dhc1ByaWNlKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIHJhbmRvbURTX2dldFNlc3Npb25QdWJLZXlIYXNoKCkgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyhieXRlczMyKTsKfQpjb250cmFjdCBPcmFjbGl6ZUFkZHJSZXNvbHZlckkgewogICAgZnVuY3Rpb24gZ2V0QWRkcmVzcygpIHB1YmxpYyByZXR1cm5zIChhZGRyZXNzIF9hZGRyKTsKfQpjb250cmFjdCB1c2luZ09yYWNsaXplIHsKICAgIHVpbnQgY29uc3RhbnQgZGF5ID0gNjAqNjAqMjQ7CiAgICB1aW50IGNvbnN0YW50IHdlZWsgPSA2MCo2MCoyNCo3OwogICAgdWludCBjb25zdGFudCBtb250aCA9IDYwKjYwKjI0KjMwOwogICAgYnl0ZSBjb25zdGFudCBwcm9vZlR5cGVfTk9ORSA9IDB4MDA7CiAgICBieXRlIGNvbnN0YW50IHByb29mVHlwZV9UTFNOb3RhcnkgPSAweDEwOwogICAgYnl0ZSBjb25zdGFudCBwcm9vZlR5cGVfQW5kcm9pZCA9IDB4MjA7CiAgICBieXRlIGNvbnN0YW50IHByb29mVHlwZV9MZWRnZXIgPSAweDMwOwogICAgYnl0ZSBjb25zdGFudCBwcm9vZlR5cGVfTmF0aXZlID0gMHhGMDsKICAgIGJ5dGUgY29uc3RhbnQgcHJvb2ZTdG9yYWdlX0lQRlMgPSAweDAxOwogICAgdWludDggY29uc3RhbnQgbmV0d29ya0lEX2F1dG8gPSAwOwogICAgdWludDggY29uc3RhbnQgbmV0d29ya0lEX21haW5uZXQgPSAxOwogICAgdWludDggY29uc3RhbnQgbmV0d29ya0lEX3Rlc3RuZXQgPSAyOwogICAgdWludDggY29uc3RhbnQgbmV0d29ya0lEX21vcmRlbiA9IDI7CiAgICB1aW50OCBjb25zdGFudCBuZXR3b3JrSURfY29uc2Vuc3lzID0gMTYxOwoKICAgIE9yYWNsaXplQWRkclJlc29sdmVySSBPQVI7CgogICAgT3JhY2xpemVJIG9yYWNsaXplOwogICAgbW9kaWZpZXIgb3JhY2xpemVBUEkgewogICAgICAgIGlmKChhZGRyZXNzKE9BUik9PTApfHwoZ2V0Q29kZVNpemUoYWRkcmVzcyhPQVIpKT09MCkpCiAgICAgICAgICAgIG9yYWNsaXplX3NldE5ldHdvcmsobmV0d29ya0lEX2F1dG8pOwoKICAgICAgICBpZihhZGRyZXNzKG9yYWNsaXplKSAhPSBPQVIuZ2V0QWRkcmVzcygpKQogICAgICAgICAgICBvcmFjbGl6ZSA9IE9yYWNsaXplSShPQVIuZ2V0QWRkcmVzcygpKTsKCiAgICAgICAgXzsKICAgIH0KICAgIG1vZGlmaWVyIGNvdXBvbihzdHJpbmcgY29kZSl7CiAgICAgICAgb3JhY2xpemUgPSBPcmFjbGl6ZUkoT0FSLmdldEFkZHJlc3MoKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9zZXROZXR3b3JrKHVpbnQ4IG5ldHdvcmtJRCkgaW50ZXJuYWwgcmV0dXJucyhib29sKXsKICAgICAgcmV0dXJuIG9yYWNsaXplX3NldE5ldHdvcmsoKTsKICAgICAgbmV0d29ya0lEOyAvLyBzaWxlbmNlIHRoZSB3YXJuaW5nIGFuZCByZW1haW4gYmFja3dhcmRzIGNvbXBhdGlibGUKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3NldE5ldHdvcmsoKSBpbnRlcm5hbCByZXR1cm5zKGJvb2wpewogICAgICAgIGlmIChnZXRDb2RlU2l6ZSgweDFkM0IyNjM4YTdjQzlmMkNCM0QyOThBM0RBN2E5MEI2N0U1NTA2ZWQpPjApeyAvL21haW5uZXQKICAgICAgICAgICAgT0FSID0gT3JhY2xpemVBZGRyUmVzb2x2ZXJJKDB4MWQzQjI2MzhhN2NDOWYyQ0IzRDI5OEEzREE3YTkwQjY3RTU1MDZlZCk7CiAgICAgICAgICAgIG9yYWNsaXplX3NldE5ldHdvcmtOYW1lKCJldGhfbWFpbm5ldCIpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKGdldENvZGVTaXplKDB4YzAzQTI2MTVENWVmYWY1RjQ5RjYwQjdCQjY1ODNlYWVjMjEyZmRmMSk+MCl7IC8vcm9wc3RlbiB0ZXN0bmV0CiAgICAgICAgICAgIE9BUiA9IE9yYWNsaXplQWRkclJlc29sdmVySSgweGMwM0EyNjE1RDVlZmFmNUY0OUY2MEI3QkI2NTgzZWFlYzIxMmZkZjEpOwogICAgICAgICAgICBvcmFjbGl6ZV9zZXROZXR3b3JrTmFtZSgiZXRoX3JvcHN0ZW4zIik7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICBpZiAoZ2V0Q29kZVNpemUoMHhCN0EwN0JjRjJCYTJmMjcwM2IyNEMwNjkxYjUyNzg5OTlDNTlBQzdlKT4wKXsgLy9rb3ZhbiB0ZXN0bmV0CiAgICAgICAgICAgIE9BUiA9IE9yYWNsaXplQWRkclJlc29sdmVySSgweEI3QTA3QmNGMkJhMmYyNzAzYjI0QzA2OTFiNTI3ODk5OUM1OUFDN2UpOwogICAgICAgICAgICBvcmFjbGl6ZV9zZXROZXR3b3JrTmFtZSgiZXRoX2tvdmFuIik7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICBpZiAoZ2V0Q29kZVNpemUoMHgxNDY1MDBjZmQzNUIyMkU0QTM5MkZlMGFEYzA2RGUxYTEzNjhFZDQ4KT4wKXsgLy9yaW5rZWJ5IHRlc3RuZXQKICAgICAgICAgICAgT0FSID0gT3JhY2xpemVBZGRyUmVzb2x2ZXJJKDB4MTQ2NTAwY2ZkMzVCMjJFNEEzOTJGZTBhRGMwNkRlMWExMzY4RWQ0OCk7CiAgICAgICAgICAgIG9yYWNsaXplX3NldE5ldHdvcmtOYW1lKCJldGhfcmlua2VieSIpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKGdldENvZGVTaXplKDB4NmY0ODVDOEJGNmZjNDNlQTIxMkU5M0JCRjhjZTA0NkM3ZjFjYjQ3NSk+MCl7IC8vZXRoZXJldW0tYnJpZGdlCiAgICAgICAgICAgIE9BUiA9IE9yYWNsaXplQWRkclJlc29sdmVySSgweDZmNDg1QzhCRjZmYzQzZUEyMTJFOTNCQkY4Y2UwNDZDN2YxY2I0NzUpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKGdldENvZGVTaXplKDB4MjBlMTJBMUY4NTlCM0ZlYUU1RmIyQTBBMzJDMThGNWE2NTU1NWJCRik+MCl7IC8vZXRoZXIuY2FtcCBpZGUKICAgICAgICAgICAgT0FSID0gT3JhY2xpemVBZGRyUmVzb2x2ZXJJKDB4MjBlMTJBMUY4NTlCM0ZlYUU1RmIyQTBBMzJDMThGNWE2NTU1NWJCRik7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICBpZiAoZ2V0Q29kZVNpemUoMHg1MWVmYUY0YzhCM0M5QWZCRDVhQjlGNGJiQzgyNzg0QWI2ZWY4ZkFBKT4wKXsgLy9icm93c2VyLXNvbGlkaXR5CiAgICAgICAgICAgIE9BUiA9IE9yYWNsaXplQWRkclJlc29sdmVySSgweDUxZWZhRjRjOEIzQzlBZkJENWFCOUY0YmJDODI3ODRBYjZlZjhmQUEpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIF9fY2FsbGJhY2soYnl0ZXMzMiBteWlkLCBzdHJpbmcgcmVzdWx0KSBwdWJsaWMgewogICAgICAgIF9fY2FsbGJhY2sobXlpZCwgcmVzdWx0LCBuZXcgYnl0ZXMoMCkpOwogICAgfQogICAgZnVuY3Rpb24gX19jYWxsYmFjayhieXRlczMyIG15aWQsIHN0cmluZyByZXN1bHQsIGJ5dGVzIHByb29mKSBwdWJsaWMgewogICAgICByZXR1cm47CiAgICAgIG15aWQ7IHJlc3VsdDsgcHJvb2Y7IC8vIFNpbGVuY2UgY29tcGlsZXIgd2FybmluZ3MKICAgIH0KCiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9nZXRQcmljZShzdHJpbmcgZGF0YXNvdXJjZSkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAodWludCl7CiAgICAgICAgcmV0dXJuIG9yYWNsaXplLmdldFByaWNlKGRhdGFzb3VyY2UpOwogICAgfQoKICAgIGZ1bmN0aW9uIG9yYWNsaXplX2dldFByaWNlKHN0cmluZyBkYXRhc291cmNlLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zICh1aW50KXsKICAgICAgICByZXR1cm4gb3JhY2xpemUuZ2V0UHJpY2UoZGF0YXNvdXJjZSwgZ2FzbGltaXQpOwogICAgfQoKICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmcgYXJnKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKXsKICAgICAgICB1aW50IHByaWNlID0gb3JhY2xpemUuZ2V0UHJpY2UoZGF0YXNvdXJjZSk7CiAgICAgICAgaWYgKHByaWNlID4gMSBldGhlciArIHR4Lmdhc3ByaWNlKjIwMDAwMCkgcmV0dXJuIDA7IC8vIHVuZXhwZWN0ZWRseSBoaWdoIHByaWNlCiAgICAgICAgcmV0dXJuIG9yYWNsaXplLnF1ZXJ5LnZhbHVlKHByaWNlKSgwLCBkYXRhc291cmNlLCBhcmcpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmcgYXJnKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKXsKICAgICAgICB1aW50IHByaWNlID0gb3JhY2xpemUuZ2V0UHJpY2UoZGF0YXNvdXJjZSk7CiAgICAgICAgaWYgKHByaWNlID4gMSBldGhlciArIHR4Lmdhc3ByaWNlKjIwMDAwMCkgcmV0dXJuIDA7IC8vIHVuZXhwZWN0ZWRseSBoaWdoIHByaWNlCiAgICAgICAgcmV0dXJuIG9yYWNsaXplLnF1ZXJ5LnZhbHVlKHByaWNlKSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGFyZyk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeSh1aW50IHRpbWVzdGFtcCwgc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZyBhcmcsIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpewogICAgICAgIHVpbnQgcHJpY2UgPSBvcmFjbGl6ZS5nZXRQcmljZShkYXRhc291cmNlLCBnYXNsaW1pdCk7CiAgICAgICAgaWYgKHByaWNlID4gMSBldGhlciArIHR4Lmdhc3ByaWNlKmdhc2xpbWl0KSByZXR1cm4gMDsgLy8gdW5leHBlY3RlZGx5IGhpZ2ggcHJpY2UKICAgICAgICByZXR1cm4gb3JhY2xpemUucXVlcnlfd2l0aEdhc0xpbWl0LnZhbHVlKHByaWNlKSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGFyZywgZ2FzbGltaXQpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkoc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZyBhcmcsIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpewogICAgICAgIHVpbnQgcHJpY2UgPSBvcmFjbGl6ZS5nZXRQcmljZShkYXRhc291cmNlLCBnYXNsaW1pdCk7CiAgICAgICAgaWYgKHByaWNlID4gMSBldGhlciArIHR4Lmdhc3ByaWNlKmdhc2xpbWl0KSByZXR1cm4gMDsgLy8gdW5leHBlY3RlZGx5IGhpZ2ggcHJpY2UKICAgICAgICByZXR1cm4gb3JhY2xpemUucXVlcnlfd2l0aEdhc0xpbWl0LnZhbHVlKHByaWNlKSgwLCBkYXRhc291cmNlLCBhcmcsIGdhc2xpbWl0KTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmcgYXJnMSwgc3RyaW5nIGFyZzIpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpewogICAgICAgIHVpbnQgcHJpY2UgPSBvcmFjbGl6ZS5nZXRQcmljZShkYXRhc291cmNlKTsKICAgICAgICBpZiAocHJpY2UgPiAxIGV0aGVyICsgdHguZ2FzcHJpY2UqMjAwMDAwKSByZXR1cm4gMDsgLy8gdW5leHBlY3RlZGx5IGhpZ2ggcHJpY2UKICAgICAgICByZXR1cm4gb3JhY2xpemUucXVlcnkyLnZhbHVlKHByaWNlKSgwLCBkYXRhc291cmNlLCBhcmcxLCBhcmcyKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nIGFyZzEsIHN0cmluZyBhcmcyKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKXsKICAgICAgICB1aW50IHByaWNlID0gb3JhY2xpemUuZ2V0UHJpY2UoZGF0YXNvdXJjZSk7CiAgICAgICAgaWYgKHByaWNlID4gMSBldGhlciArIHR4Lmdhc3ByaWNlKjIwMDAwMCkgcmV0dXJuIDA7IC8vIHVuZXhwZWN0ZWRseSBoaWdoIHByaWNlCiAgICAgICAgcmV0dXJuIG9yYWNsaXplLnF1ZXJ5Mi52YWx1ZShwcmljZSkodGltZXN0YW1wLCBkYXRhc291cmNlLCBhcmcxLCBhcmcyKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nIGFyZzEsIHN0cmluZyBhcmcyLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKXsKICAgICAgICB1aW50IHByaWNlID0gb3JhY2xpemUuZ2V0UHJpY2UoZGF0YXNvdXJjZSwgZ2FzbGltaXQpOwogICAgICAgIGlmIChwcmljZSA+IDEgZXRoZXIgKyB0eC5nYXNwcmljZSpnYXNsaW1pdCkgcmV0dXJuIDA7IC8vIHVuZXhwZWN0ZWRseSBoaWdoIHByaWNlCiAgICAgICAgcmV0dXJuIG9yYWNsaXplLnF1ZXJ5Ml93aXRoR2FzTGltaXQudmFsdWUocHJpY2UpKHRpbWVzdGFtcCwgZGF0YXNvdXJjZSwgYXJnMSwgYXJnMiwgZ2FzbGltaXQpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkoc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZyBhcmcxLCBzdHJpbmcgYXJnMiwgdWludCBnYXNsaW1pdCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCl7CiAgICAgICAgdWludCBwcmljZSA9IG9yYWNsaXplLmdldFByaWNlKGRhdGFzb3VyY2UsIGdhc2xpbWl0KTsKICAgICAgICBpZiAocHJpY2UgPiAxIGV0aGVyICsgdHguZ2FzcHJpY2UqZ2FzbGltaXQpIHJldHVybiAwOyAvLyB1bmV4cGVjdGVkbHkgaGlnaCBwcmljZQogICAgICAgIHJldHVybiBvcmFjbGl6ZS5xdWVyeTJfd2l0aEdhc0xpbWl0LnZhbHVlKHByaWNlKSgwLCBkYXRhc291cmNlLCBhcmcxLCBhcmcyLCBnYXNsaW1pdCk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeShzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nW10gYXJnTikgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCl7CiAgICAgICAgdWludCBwcmljZSA9IG9yYWNsaXplLmdldFByaWNlKGRhdGFzb3VyY2UpOwogICAgICAgIGlmIChwcmljZSA+IDEgZXRoZXIgKyB0eC5nYXNwcmljZSoyMDAwMDApIHJldHVybiAwOyAvLyB1bmV4cGVjdGVkbHkgaGlnaCBwcmljZQogICAgICAgIGJ5dGVzIG1lbW9yeSBhcmdzID0gc3RyYTJjYm9yKGFyZ04pOwogICAgICAgIHJldHVybiBvcmFjbGl6ZS5xdWVyeU4udmFsdWUocHJpY2UpKDAsIGRhdGFzb3VyY2UsIGFyZ3MpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmdbXSBhcmdOKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKXsKICAgICAgICB1aW50IHByaWNlID0gb3JhY2xpemUuZ2V0UHJpY2UoZGF0YXNvdXJjZSk7CiAgICAgICAgaWYgKHByaWNlID4gMSBldGhlciArIHR4Lmdhc3ByaWNlKjIwMDAwMCkgcmV0dXJuIDA7IC8vIHVuZXhwZWN0ZWRseSBoaWdoIHByaWNlCiAgICAgICAgYnl0ZXMgbWVtb3J5IGFyZ3MgPSBzdHJhMmNib3IoYXJnTik7CiAgICAgICAgcmV0dXJuIG9yYWNsaXplLnF1ZXJ5Ti52YWx1ZShwcmljZSkodGltZXN0YW1wLCBkYXRhc291cmNlLCBhcmdzKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nW10gYXJnTiwgdWludCBnYXNsaW1pdCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCl7CiAgICAgICAgdWludCBwcmljZSA9IG9yYWNsaXplLmdldFByaWNlKGRhdGFzb3VyY2UsIGdhc2xpbWl0KTsKICAgICAgICBpZiAocHJpY2UgPiAxIGV0aGVyICsgdHguZ2FzcHJpY2UqZ2FzbGltaXQpIHJldHVybiAwOyAvLyB1bmV4cGVjdGVkbHkgaGlnaCBwcmljZQogICAgICAgIGJ5dGVzIG1lbW9yeSBhcmdzID0gc3RyYTJjYm9yKGFyZ04pOwogICAgICAgIHJldHVybiBvcmFjbGl6ZS5xdWVyeU5fd2l0aEdhc0xpbWl0LnZhbHVlKHByaWNlKSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGFyZ3MsIGdhc2xpbWl0KTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmdbXSBhcmdOLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKXsKICAgICAgICB1aW50IHByaWNlID0gb3JhY2xpemUuZ2V0UHJpY2UoZGF0YXNvdXJjZSwgZ2FzbGltaXQpOwogICAgICAgIGlmIChwcmljZSA+IDEgZXRoZXIgKyB0eC5nYXNwcmljZSpnYXNsaW1pdCkgcmV0dXJuIDA7IC8vIHVuZXhwZWN0ZWRseSBoaWdoIHByaWNlCiAgICAgICAgYnl0ZXMgbWVtb3J5IGFyZ3MgPSBzdHJhMmNib3IoYXJnTik7CiAgICAgICAgcmV0dXJuIG9yYWNsaXplLnF1ZXJ5Tl93aXRoR2FzTGltaXQudmFsdWUocHJpY2UpKDAsIGRhdGFzb3VyY2UsIGFyZ3MsIGdhc2xpbWl0KTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmdbMV0gYXJncykgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIHN0cmluZ1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IHN0cmluZ1tdKDEpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeShkYXRhc291cmNlLCBkeW5hcmdzKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nWzFdIGFyZ3MpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBzdHJpbmdbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBzdHJpbmdbXSgxKTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkodGltZXN0YW1wLCBkYXRhc291cmNlLCBkeW5hcmdzKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nWzFdIGFyZ3MsIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBzdHJpbmdbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBzdHJpbmdbXSgxKTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkodGltZXN0YW1wLCBkYXRhc291cmNlLCBkeW5hcmdzLCBnYXNsaW1pdCk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeShzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nWzFdIGFyZ3MsIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBzdHJpbmdbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBzdHJpbmdbXSgxKTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkoZGF0YXNvdXJjZSwgZHluYXJncywgZ2FzbGltaXQpOwogICAgfQoKICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmdbMl0gYXJncykgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIHN0cmluZ1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IHN0cmluZ1tdKDIpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeShkYXRhc291cmNlLCBkeW5hcmdzKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nWzJdIGFyZ3MpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBzdHJpbmdbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBzdHJpbmdbXSgyKTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkodGltZXN0YW1wLCBkYXRhc291cmNlLCBkeW5hcmdzKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nWzJdIGFyZ3MsIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBzdHJpbmdbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBzdHJpbmdbXSgyKTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkodGltZXN0YW1wLCBkYXRhc291cmNlLCBkeW5hcmdzLCBnYXNsaW1pdCk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeShzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nWzJdIGFyZ3MsIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBzdHJpbmdbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBzdHJpbmdbXSgyKTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkoZGF0YXNvdXJjZSwgZHluYXJncywgZ2FzbGltaXQpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkoc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZ1szXSBhcmdzKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgc3RyaW5nW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgc3RyaW5nW10oMyk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgZHluYXJnc1syXSA9IGFyZ3NbMl07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KGRhdGFzb3VyY2UsIGR5bmFyZ3MpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmdbM10gYXJncykgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIHN0cmluZ1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IHN0cmluZ1tdKDMpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIGR5bmFyZ3NbMl0gPSBhcmdzWzJdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGR5bmFyZ3MpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmdbM10gYXJncywgdWludCBnYXNsaW1pdCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIHN0cmluZ1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IHN0cmluZ1tdKDMpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIGR5bmFyZ3NbMl0gPSBhcmdzWzJdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGR5bmFyZ3MsIGdhc2xpbWl0KTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmdbM10gYXJncywgdWludCBnYXNsaW1pdCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIHN0cmluZ1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IHN0cmluZ1tdKDMpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIGR5bmFyZ3NbMl0gPSBhcmdzWzJdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeShkYXRhc291cmNlLCBkeW5hcmdzLCBnYXNsaW1pdCk7CiAgICB9CgogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkoc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZ1s0XSBhcmdzKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgc3RyaW5nW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgc3RyaW5nW10oNCk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgZHluYXJnc1syXSA9IGFyZ3NbMl07CiAgICAgICAgZHluYXJnc1szXSA9IGFyZ3NbM107CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KGRhdGFzb3VyY2UsIGR5bmFyZ3MpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmdbNF0gYXJncykgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIHN0cmluZ1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IHN0cmluZ1tdKDQpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIGR5bmFyZ3NbMl0gPSBhcmdzWzJdOwogICAgICAgIGR5bmFyZ3NbM10gPSBhcmdzWzNdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGR5bmFyZ3MpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmdbNF0gYXJncywgdWludCBnYXNsaW1pdCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIHN0cmluZ1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IHN0cmluZ1tdKDQpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIGR5bmFyZ3NbMl0gPSBhcmdzWzJdOwogICAgICAgIGR5bmFyZ3NbM10gPSBhcmdzWzNdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGR5bmFyZ3MsIGdhc2xpbWl0KTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBzdHJpbmdbNF0gYXJncywgdWludCBnYXNsaW1pdCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIHN0cmluZ1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IHN0cmluZ1tdKDQpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIGR5bmFyZ3NbMl0gPSBhcmdzWzJdOwogICAgICAgIGR5bmFyZ3NbM10gPSBhcmdzWzNdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeShkYXRhc291cmNlLCBkeW5hcmdzLCBnYXNsaW1pdCk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeShzdHJpbmcgZGF0YXNvdXJjZSwgc3RyaW5nWzVdIGFyZ3MpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBzdHJpbmdbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBzdHJpbmdbXSg1KTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICBkeW5hcmdzWzJdID0gYXJnc1syXTsKICAgICAgICBkeW5hcmdzWzNdID0gYXJnc1szXTsKICAgICAgICBkeW5hcmdzWzRdID0gYXJnc1s0XTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkoZGF0YXNvdXJjZSwgZHluYXJncyk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeSh1aW50IHRpbWVzdGFtcCwgc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZ1s1XSBhcmdzKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgc3RyaW5nW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgc3RyaW5nW10oNSk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgZHluYXJnc1syXSA9IGFyZ3NbMl07CiAgICAgICAgZHluYXJnc1szXSA9IGFyZ3NbM107CiAgICAgICAgZHluYXJnc1s0XSA9IGFyZ3NbNF07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KHRpbWVzdGFtcCwgZGF0YXNvdXJjZSwgZHluYXJncyk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeSh1aW50IHRpbWVzdGFtcCwgc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZ1s1XSBhcmdzLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgc3RyaW5nW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgc3RyaW5nW10oNSk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgZHluYXJnc1syXSA9IGFyZ3NbMl07CiAgICAgICAgZHluYXJnc1szXSA9IGFyZ3NbM107CiAgICAgICAgZHluYXJnc1s0XSA9IGFyZ3NbNF07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KHRpbWVzdGFtcCwgZGF0YXNvdXJjZSwgZHluYXJncywgZ2FzbGltaXQpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkoc3RyaW5nIGRhdGFzb3VyY2UsIHN0cmluZ1s1XSBhcmdzLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgc3RyaW5nW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgc3RyaW5nW10oNSk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgZHluYXJnc1syXSA9IGFyZ3NbMl07CiAgICAgICAgZHluYXJnc1szXSA9IGFyZ3NbM107CiAgICAgICAgZHluYXJnc1s0XSA9IGFyZ3NbNF07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KGRhdGFzb3VyY2UsIGR5bmFyZ3MsIGdhc2xpbWl0KTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBieXRlc1tdIGFyZ04pIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpewogICAgICAgIHVpbnQgcHJpY2UgPSBvcmFjbGl6ZS5nZXRQcmljZShkYXRhc291cmNlKTsKICAgICAgICBpZiAocHJpY2UgPiAxIGV0aGVyICsgdHguZ2FzcHJpY2UqMjAwMDAwKSByZXR1cm4gMDsgLy8gdW5leHBlY3RlZGx5IGhpZ2ggcHJpY2UKICAgICAgICBieXRlcyBtZW1vcnkgYXJncyA9IGJhMmNib3IoYXJnTik7CiAgICAgICAgcmV0dXJuIG9yYWNsaXplLnF1ZXJ5Ti52YWx1ZShwcmljZSkoMCwgZGF0YXNvdXJjZSwgYXJncyk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeSh1aW50IHRpbWVzdGFtcCwgc3RyaW5nIGRhdGFzb3VyY2UsIGJ5dGVzW10gYXJnTikgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCl7CiAgICAgICAgdWludCBwcmljZSA9IG9yYWNsaXplLmdldFByaWNlKGRhdGFzb3VyY2UpOwogICAgICAgIGlmIChwcmljZSA+IDEgZXRoZXIgKyB0eC5nYXNwcmljZSoyMDAwMDApIHJldHVybiAwOyAvLyB1bmV4cGVjdGVkbHkgaGlnaCBwcmljZQogICAgICAgIGJ5dGVzIG1lbW9yeSBhcmdzID0gYmEyY2JvcihhcmdOKTsKICAgICAgICByZXR1cm4gb3JhY2xpemUucXVlcnlOLnZhbHVlKHByaWNlKSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGFyZ3MpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBieXRlc1tdIGFyZ04sIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpewogICAgICAgIHVpbnQgcHJpY2UgPSBvcmFjbGl6ZS5nZXRQcmljZShkYXRhc291cmNlLCBnYXNsaW1pdCk7CiAgICAgICAgaWYgKHByaWNlID4gMSBldGhlciArIHR4Lmdhc3ByaWNlKmdhc2xpbWl0KSByZXR1cm4gMDsgLy8gdW5leHBlY3RlZGx5IGhpZ2ggcHJpY2UKICAgICAgICBieXRlcyBtZW1vcnkgYXJncyA9IGJhMmNib3IoYXJnTik7CiAgICAgICAgcmV0dXJuIG9yYWNsaXplLnF1ZXJ5Tl93aXRoR2FzTGltaXQudmFsdWUocHJpY2UpKHRpbWVzdGFtcCwgZGF0YXNvdXJjZSwgYXJncywgZ2FzbGltaXQpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkoc3RyaW5nIGRhdGFzb3VyY2UsIGJ5dGVzW10gYXJnTiwgdWludCBnYXNsaW1pdCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCl7CiAgICAgICAgdWludCBwcmljZSA9IG9yYWNsaXplLmdldFByaWNlKGRhdGFzb3VyY2UsIGdhc2xpbWl0KTsKICAgICAgICBpZiAocHJpY2UgPiAxIGV0aGVyICsgdHguZ2FzcHJpY2UqZ2FzbGltaXQpIHJldHVybiAwOyAvLyB1bmV4cGVjdGVkbHkgaGlnaCBwcmljZQogICAgICAgIGJ5dGVzIG1lbW9yeSBhcmdzID0gYmEyY2JvcihhcmdOKTsKICAgICAgICByZXR1cm4gb3JhY2xpemUucXVlcnlOX3dpdGhHYXNMaW1pdC52YWx1ZShwcmljZSkoMCwgZGF0YXNvdXJjZSwgYXJncywgZ2FzbGltaXQpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkoc3RyaW5nIGRhdGFzb3VyY2UsIGJ5dGVzWzFdIGFyZ3MpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBieXRlc1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IGJ5dGVzW10oMSk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KGRhdGFzb3VyY2UsIGR5bmFyZ3MpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBieXRlc1sxXSBhcmdzKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgYnl0ZXNbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBieXRlc1tdKDEpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGR5bmFyZ3MpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBieXRlc1sxXSBhcmdzLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgYnl0ZXNbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBieXRlc1tdKDEpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGR5bmFyZ3MsIGdhc2xpbWl0KTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBieXRlc1sxXSBhcmdzLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgYnl0ZXNbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBieXRlc1tdKDEpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeShkYXRhc291cmNlLCBkeW5hcmdzLCBnYXNsaW1pdCk7CiAgICB9CgogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkoc3RyaW5nIGRhdGFzb3VyY2UsIGJ5dGVzWzJdIGFyZ3MpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBieXRlc1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IGJ5dGVzW10oMik7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KGRhdGFzb3VyY2UsIGR5bmFyZ3MpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBieXRlc1syXSBhcmdzKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgYnl0ZXNbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBieXRlc1tdKDIpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGR5bmFyZ3MpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkodWludCB0aW1lc3RhbXAsIHN0cmluZyBkYXRhc291cmNlLCBieXRlc1syXSBhcmdzLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgYnl0ZXNbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBieXRlc1tdKDIpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeSh0aW1lc3RhbXAsIGRhdGFzb3VyY2UsIGR5bmFyZ3MsIGdhc2xpbWl0KTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBieXRlc1syXSBhcmdzLCB1aW50IGdhc2xpbWl0KSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgYnl0ZXNbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBieXRlc1tdKDIpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeShkYXRhc291cmNlLCBkeW5hcmdzLCBnYXNsaW1pdCk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeShzdHJpbmcgZGF0YXNvdXJjZSwgYnl0ZXNbM10gYXJncykgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIGJ5dGVzW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgYnl0ZXNbXSgzKTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICBkeW5hcmdzWzJdID0gYXJnc1syXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkoZGF0YXNvdXJjZSwgZHluYXJncyk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeSh1aW50IHRpbWVzdGFtcCwgc3RyaW5nIGRhdGFzb3VyY2UsIGJ5dGVzWzNdIGFyZ3MpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBieXRlc1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IGJ5dGVzW10oMyk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgZHluYXJnc1syXSA9IGFyZ3NbMl07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KHRpbWVzdGFtcCwgZGF0YXNvdXJjZSwgZHluYXJncyk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeSh1aW50IHRpbWVzdGFtcCwgc3RyaW5nIGRhdGFzb3VyY2UsIGJ5dGVzWzNdIGFyZ3MsIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBieXRlc1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IGJ5dGVzW10oMyk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgZHluYXJnc1syXSA9IGFyZ3NbMl07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KHRpbWVzdGFtcCwgZGF0YXNvdXJjZSwgZHluYXJncywgZ2FzbGltaXQpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkoc3RyaW5nIGRhdGFzb3VyY2UsIGJ5dGVzWzNdIGFyZ3MsIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBieXRlc1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IGJ5dGVzW10oMyk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgZHluYXJnc1syXSA9IGFyZ3NbMl07CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KGRhdGFzb3VyY2UsIGR5bmFyZ3MsIGdhc2xpbWl0KTsKICAgIH0KCiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeShzdHJpbmcgZGF0YXNvdXJjZSwgYnl0ZXNbNF0gYXJncykgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIGJ5dGVzW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgYnl0ZXNbXSg0KTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICBkeW5hcmdzWzJdID0gYXJnc1syXTsKICAgICAgICBkeW5hcmdzWzNdID0gYXJnc1szXTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkoZGF0YXNvdXJjZSwgZHluYXJncyk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeSh1aW50IHRpbWVzdGFtcCwgc3RyaW5nIGRhdGFzb3VyY2UsIGJ5dGVzWzRdIGFyZ3MpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBieXRlc1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IGJ5dGVzW10oNCk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgZHluYXJnc1syXSA9IGFyZ3NbMl07CiAgICAgICAgZHluYXJnc1szXSA9IGFyZ3NbM107CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KHRpbWVzdGFtcCwgZGF0YXNvdXJjZSwgZHluYXJncyk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeSh1aW50IHRpbWVzdGFtcCwgc3RyaW5nIGRhdGFzb3VyY2UsIGJ5dGVzWzRdIGFyZ3MsIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBieXRlc1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IGJ5dGVzW10oNCk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgZHluYXJnc1syXSA9IGFyZ3NbMl07CiAgICAgICAgZHluYXJnc1szXSA9IGFyZ3NbM107CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KHRpbWVzdGFtcCwgZGF0YXNvdXJjZSwgZHluYXJncywgZ2FzbGltaXQpOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfcXVlcnkoc3RyaW5nIGRhdGFzb3VyY2UsIGJ5dGVzWzRdIGFyZ3MsIHVpbnQgZ2FzbGltaXQpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIgaWQpIHsKICAgICAgICBieXRlc1tdIG1lbW9yeSBkeW5hcmdzID0gbmV3IGJ5dGVzW10oNCk7CiAgICAgICAgZHluYXJnc1swXSA9IGFyZ3NbMF07CiAgICAgICAgZHluYXJnc1sxXSA9IGFyZ3NbMV07CiAgICAgICAgZHluYXJnc1syXSA9IGFyZ3NbMl07CiAgICAgICAgZHluYXJnc1szXSA9IGFyZ3NbM107CiAgICAgICAgcmV0dXJuIG9yYWNsaXplX3F1ZXJ5KGRhdGFzb3VyY2UsIGR5bmFyZ3MsIGdhc2xpbWl0KTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHN0cmluZyBkYXRhc291cmNlLCBieXRlc1s1XSBhcmdzKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgYnl0ZXNbXSBtZW1vcnkgZHluYXJncyA9IG5ldyBieXRlc1tdKDUpOwogICAgICAgIGR5bmFyZ3NbMF0gPSBhcmdzWzBdOwogICAgICAgIGR5bmFyZ3NbMV0gPSBhcmdzWzFdOwogICAgICAgIGR5bmFyZ3NbMl0gPSBhcmdzWzJdOwogICAgICAgIGR5bmFyZ3NbM10gPSBhcmdzWzNdOwogICAgICAgIGR5bmFyZ3NbNF0gPSBhcmdzWzRdOwogICAgICAgIHJldHVybiBvcmFjbGl6ZV9xdWVyeShkYXRhc291cmNlLCBkeW5hcmdzKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgYnl0ZXNbNV0gYXJncykgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIGJ5dGVzW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgYnl0ZXNbXSg1KTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICBkeW5hcmdzWzJdID0gYXJnc1syXTsKICAgICAgICBkeW5hcmdzWzNdID0gYXJnc1szXTsKICAgICAgICBkeW5hcmdzWzRdID0gYXJnc1s0XTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkodGltZXN0YW1wLCBkYXRhc291cmNlLCBkeW5hcmdzKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3F1ZXJ5KHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgZGF0YXNvdXJjZSwgYnl0ZXNbNV0gYXJncywgdWludCBnYXNsaW1pdCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIGJ5dGVzW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgYnl0ZXNbXSg1KTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICBkeW5hcmdzWzJdID0gYXJnc1syXTsKICAgICAgICBkeW5hcmdzWzNdID0gYXJnc1szXTsKICAgICAgICBkeW5hcmdzWzRdID0gYXJnc1s0XTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkodGltZXN0YW1wLCBkYXRhc291cmNlLCBkeW5hcmdzLCBnYXNsaW1pdCk7CiAgICB9CiAgICBmdW5jdGlvbiBvcmFjbGl6ZV9xdWVyeShzdHJpbmcgZGF0YXNvdXJjZSwgYnl0ZXNbNV0gYXJncywgdWludCBnYXNsaW1pdCkgb3JhY2xpemVBUEkgaW50ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMiBpZCkgewogICAgICAgIGJ5dGVzW10gbWVtb3J5IGR5bmFyZ3MgPSBuZXcgYnl0ZXNbXSg1KTsKICAgICAgICBkeW5hcmdzWzBdID0gYXJnc1swXTsKICAgICAgICBkeW5hcmdzWzFdID0gYXJnc1sxXTsKICAgICAgICBkeW5hcmdzWzJdID0gYXJnc1syXTsKICAgICAgICBkeW5hcmdzWzNdID0gYXJnc1szXTsKICAgICAgICBkeW5hcmdzWzRdID0gYXJnc1s0XTsKICAgICAgICByZXR1cm4gb3JhY2xpemVfcXVlcnkoZGF0YXNvdXJjZSwgZHluYXJncywgZ2FzbGltaXQpOwogICAgfQoKICAgIGZ1bmN0aW9uIG9yYWNsaXplX2NiQWRkcmVzcygpIG9yYWNsaXplQVBJIGludGVybmFsIHJldHVybnMgKGFkZHJlc3MpewogICAgICAgIHJldHVybiBvcmFjbGl6ZS5jYkFkZHJlc3MoKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9yYWNsaXplX3NldFByb29mKGJ5dGUgcHJvb2ZQKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCB7CiAgICAgICAgcmV0dXJuIG9yYWNsaXplLnNldFByb29mVHlwZShwcm9vZlApOwogICAgfQogICAgZnVuY3Rpb24gb3JhY2xpemVfc2V0Q3VzdG9tR2FzUHJpY2UodWludCBnYXNQcmljZSkgb3JhY2xpemVBUEkgaW50ZXJuYWwgewogICAgICAgIHJldHVybiBvcmFjbGl6ZS5zZXRDdXN0b21HYXNQcmljZShnYXNQcmljZSk7CiAgICB9CgogICAgZnVuY3Rpb24gb3JhY2xpemVfcmFuZG9tRFNfZ2V0U2Vzc2lvblB1YktleUhhc2goKSBvcmFjbGl6ZUFQSSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyKXsKICAgICAgICByZXR1cm4gb3JhY2xpemUucmFuZG9tRFNfZ2V0U2Vzc2lvblB1YktleUhhc2goKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRDb2RlU2l6ZShhZGRyZXNzIF9hZGRyKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zKHVpbnQgX3NpemUpIHsKICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgIF9zaXplIDo9IGV4dGNvZGVzaXplKF9hZGRyKQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBwYXJzZUFkZHIoc3RyaW5nIF9hKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKGFkZHJlc3MpewogICAgICAgIGJ5dGVzIG1lbW9yeSB0bXAgPSBieXRlcyhfYSk7CiAgICAgICAgdWludDE2MCBpYWRkciA9IDA7CiAgICAgICAgdWludDE2MCBiMTsKICAgICAgICB1aW50MTYwIGIyOwogICAgICAgIGZvciAodWludCBpPTI7IGk8MisyKjIwOyBpKz0yKXsKICAgICAgICAgICAgaWFkZHIgKj0gMjU2OwogICAgICAgICAgICBiMSA9IHVpbnQxNjAodG1wW2ldKTsKICAgICAgICAgICAgYjIgPSB1aW50MTYwKHRtcFtpKzFdKTsKICAgICAgICAgICAgaWYgKChiMSA+PSA5NykmJihiMSA8PSAxMDIpKSBiMSAtPSA4NzsKICAgICAgICAgICAgZWxzZSBpZiAoKGIxID49IDY1KSYmKGIxIDw9IDcwKSkgYjEgLT0gNTU7CiAgICAgICAgICAgIGVsc2UgaWYgKChiMSA+PSA0OCkmJihiMSA8PSA1NykpIGIxIC09IDQ4OwogICAgICAgICAgICBpZiAoKGIyID49IDk3KSYmKGIyIDw9IDEwMikpIGIyIC09IDg3OwogICAgICAgICAgICBlbHNlIGlmICgoYjIgPj0gNjUpJiYoYjIgPD0gNzApKSBiMiAtPSA1NTsKICAgICAgICAgICAgZWxzZSBpZiAoKGIyID49IDQ4KSYmKGIyIDw9IDU3KSkgYjIgLT0gNDg7CiAgICAgICAgICAgIGlhZGRyICs9IChiMSoxNitiMik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBhZGRyZXNzKGlhZGRyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzdHJDb21wYXJlKHN0cmluZyBfYSwgc3RyaW5nIF9iKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKGludCkgewogICAgICAgIGJ5dGVzIG1lbW9yeSBhID0gYnl0ZXMoX2EpOwogICAgICAgIGJ5dGVzIG1lbW9yeSBiID0gYnl0ZXMoX2IpOwogICAgICAgIHVpbnQgbWluTGVuZ3RoID0gYS5sZW5ndGg7CiAgICAgICAgaWYgKGIubGVuZ3RoIDwgbWluTGVuZ3RoKSBtaW5MZW5ndGggPSBiLmxlbmd0aDsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBtaW5MZW5ndGg7IGkgKyspCiAgICAgICAgICAgIGlmIChhW2ldIDwgYltpXSkKICAgICAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAgZWxzZSBpZiAoYVtpXSA+IGJbaV0pCiAgICAgICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICBpZiAoYS5sZW5ndGggPCBiLmxlbmd0aCkKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIGVsc2UgaWYgKGEubGVuZ3RoID4gYi5sZW5ndGgpCiAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgIGVsc2UKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgZnVuY3Rpb24gaW5kZXhPZihzdHJpbmcgX2hheXN0YWNrLCBzdHJpbmcgX25lZWRsZSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChpbnQpIHsKICAgICAgICBieXRlcyBtZW1vcnkgaCA9IGJ5dGVzKF9oYXlzdGFjayk7CiAgICAgICAgYnl0ZXMgbWVtb3J5IG4gPSBieXRlcyhfbmVlZGxlKTsKICAgICAgICBpZihoLmxlbmd0aCA8IDEgfHwgbi5sZW5ndGggPCAxIHx8IChuLmxlbmd0aCA+IGgubGVuZ3RoKSkKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIGVsc2UgaWYoaC5sZW5ndGggPiAoMioqMTI4IC0xKSkKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIHVpbnQgc3ViaW5kZXggPSAwOwogICAgICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBoLmxlbmd0aDsgaSArKykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKGhbaV0gPT0gblswXSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBzdWJpbmRleCA9IDE7CiAgICAgICAgICAgICAgICAgICAgd2hpbGUoc3ViaW5kZXggPCBuLmxlbmd0aCAmJiAoaSArIHN1YmluZGV4KSA8IGgubGVuZ3RoICYmIGhbaSArIHN1YmluZGV4XSA9PSBuW3N1YmluZGV4XSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN1YmluZGV4Kys7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKHN1YmluZGV4ID09IG4ubGVuZ3RoKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW50KGkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gc3RyQ29uY2F0KHN0cmluZyBfYSwgc3RyaW5nIF9iLCBzdHJpbmcgX2MsIHN0cmluZyBfZCwgc3RyaW5nIF9lKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHN0cmluZykgewogICAgICAgIGJ5dGVzIG1lbW9yeSBfYmEgPSBieXRlcyhfYSk7CiAgICAgICAgYnl0ZXMgbWVtb3J5IF9iYiA9IGJ5dGVzKF9iKTsKICAgICAgICBieXRlcyBtZW1vcnkgX2JjID0gYnl0ZXMoX2MpOwogICAgICAgIGJ5dGVzIG1lbW9yeSBfYmQgPSBieXRlcyhfZCk7CiAgICAgICAgYnl0ZXMgbWVtb3J5IF9iZSA9IGJ5dGVzKF9lKTsKICAgICAgICBzdHJpbmcgbWVtb3J5IGFiY2RlID0gbmV3IHN0cmluZyhfYmEubGVuZ3RoICsgX2JiLmxlbmd0aCArIF9iYy5sZW5ndGggKyBfYmQubGVuZ3RoICsgX2JlLmxlbmd0aCk7CiAgICAgICAgYnl0ZXMgbWVtb3J5IGJhYmNkZSA9IGJ5dGVzKGFiY2RlKTsKICAgICAgICB1aW50IGsgPSAwOwogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IF9iYS5sZW5ndGg7IGkrKykgYmFiY2RlW2srK10gPSBfYmFbaV07CiAgICAgICAgZm9yIChpID0gMDsgaSA8IF9iYi5sZW5ndGg7IGkrKykgYmFiY2RlW2srK10gPSBfYmJbaV07CiAgICAgICAgZm9yIChpID0gMDsgaSA8IF9iYy5sZW5ndGg7IGkrKykgYmFiY2RlW2srK10gPSBfYmNbaV07CiAgICAgICAgZm9yIChpID0gMDsgaSA8IF9iZC5sZW5ndGg7IGkrKykgYmFiY2RlW2srK10gPSBfYmRbaV07CiAgICAgICAgZm9yIChpID0gMDsgaSA8IF9iZS5sZW5ndGg7IGkrKykgYmFiY2RlW2srK10gPSBfYmVbaV07CiAgICAgICAgcmV0dXJuIHN0cmluZyhiYWJjZGUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHN0ckNvbmNhdChzdHJpbmcgX2EsIHN0cmluZyBfYiwgc3RyaW5nIF9jLCBzdHJpbmcgX2QpIGludGVybmFsIHB1cmUgcmV0dXJucyAoc3RyaW5nKSB7CiAgICAgICAgcmV0dXJuIHN0ckNvbmNhdChfYSwgX2IsIF9jLCBfZCwgIiIpOwogICAgfQoKICAgIGZ1bmN0aW9uIHN0ckNvbmNhdChzdHJpbmcgX2EsIHN0cmluZyBfYiwgc3RyaW5nIF9jKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHN0cmluZykgewogICAgICAgIHJldHVybiBzdHJDb25jYXQoX2EsIF9iLCBfYywgIiIsICIiKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzdHJDb25jYXQoc3RyaW5nIF9hLCBzdHJpbmcgX2IpIGludGVybmFsIHB1cmUgcmV0dXJucyAoc3RyaW5nKSB7CiAgICAgICAgcmV0dXJuIHN0ckNvbmNhdChfYSwgX2IsICIiLCAiIiwgIiIpOwogICAgfQoKICAgIC8vIHBhcnNlSW50CiAgICBmdW5jdGlvbiBwYXJzZUludChzdHJpbmcgX2EpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBwYXJzZUludChfYSwgMCk7CiAgICB9CgogICAgLy8gcGFyc2VJbnQocGFyc2VGbG9hdCoxMF5fYikKICAgIGZ1bmN0aW9uIHBhcnNlSW50KHN0cmluZyBfYSwgdWludCBfYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50KSB7CiAgICAgICAgYnl0ZXMgbWVtb3J5IGJyZXN1bHQgPSBieXRlcyhfYSk7CiAgICAgICAgdWludCBtaW50ID0gMDsKICAgICAgICBib29sIGRlY2ltYWxzID0gZmFsc2U7CiAgICAgICAgZm9yICh1aW50IGk9MDsgaTxicmVzdWx0Lmxlbmd0aDsgaSsrKXsKICAgICAgICAgICAgaWYgKChicmVzdWx0W2ldID49IDQ4KSYmKGJyZXN1bHRbaV0gPD0gNTcpKXsKICAgICAgICAgICAgICAgIGlmIChkZWNpbWFscyl7CiAgICAgICAgICAgICAgICAgICBpZiAoX2IgPT0gMCkgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgZWxzZSBfYi0tOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbWludCAqPSAxMDsKICAgICAgICAgICAgICAgIG1pbnQgKz0gdWludChicmVzdWx0W2ldKSAtIDQ4OwogICAgICAgICAgICB9IGVsc2UgaWYgKGJyZXN1bHRbaV0gPT0gNDYpIGRlY2ltYWxzID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKF9iID4gMCkgbWludCAqPSAxMCoqX2I7CiAgICAgICAgcmV0dXJuIG1pbnQ7CiAgICB9CgogICAgZnVuY3Rpb24gdWludDJzdHIodWludCBpKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHN0cmluZyl7CiAgICAgICAgaWYgKGkgPT0gMCkgcmV0dXJuICIwIjsKICAgICAgICB1aW50IGogPSBpOwogICAgICAgIHVpbnQgbGVuOwogICAgICAgIHdoaWxlIChqICE9IDApewogICAgICAgICAgICBsZW4rKzsKICAgICAgICAgICAgaiAvPSAxMDsKICAgICAgICB9CiAgICAgICAgYnl0ZXMgbWVtb3J5IGJzdHIgPSBuZXcgYnl0ZXMobGVuKTsKICAgICAgICB1aW50IGsgPSBsZW4gLSAxOwogICAgICAgIHdoaWxlIChpICE9IDApewogICAgICAgICAgICBic3RyW2stLV0gPSBieXRlKDQ4ICsgaSAlIDEwKTsKICAgICAgICAgICAgaSAvPSAxMDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN0cmluZyhic3RyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzdHJhMmNib3Ioc3RyaW5nW10gYXJyKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKGJ5dGVzKSB7CiAgICAgICAgICAgIHVpbnQgYXJybGVuID0gYXJyLmxlbmd0aDsKCiAgICAgICAgICAgIC8vIGdldCBjb3JyZWN0IGNib3Igb3V0cHV0IGxlbmd0aAogICAgICAgICAgICB1aW50IG91dHB1dGxlbiA9IDA7CiAgICAgICAgICAgIGJ5dGVzW10gbWVtb3J5IGVsZW1BcnJheSA9IG5ldyBieXRlc1tdKGFycmxlbik7CiAgICAgICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IGFycmxlbjsgaSsrKSB7CiAgICAgICAgICAgICAgICBlbGVtQXJyYXlbaV0gPSAoYnl0ZXMoYXJyW2ldKSk7CiAgICAgICAgICAgICAgICBvdXRwdXRsZW4gKz0gZWxlbUFycmF5W2ldLmxlbmd0aCArIChlbGVtQXJyYXlbaV0ubGVuZ3RoIC0gMSkvMjMgKyAzOyAvLyszIGFjY291bnRzIGZvciBwYWlyZWQgaWRlbnRpZmllciB0eXBlcwogICAgICAgICAgICB9CiAgICAgICAgICAgIHVpbnQgY3RyID0gMDsKICAgICAgICAgICAgdWludCBjYm9ybGVuID0gYXJybGVuICsgMHg4MDsKICAgICAgICAgICAgb3V0cHV0bGVuICs9IGJ5dGUoY2JvcmxlbikubGVuZ3RoOwogICAgICAgICAgICBieXRlcyBtZW1vcnkgcmVzID0gbmV3IGJ5dGVzKG91dHB1dGxlbik7CgogICAgICAgICAgICB3aGlsZSAoYnl0ZShjYm9ybGVuKS5sZW5ndGggPiBjdHIpIHsKICAgICAgICAgICAgICAgIHJlc1tjdHJdID0gYnl0ZShjYm9ybGVuKVtjdHJdOwogICAgICAgICAgICAgICAgY3RyKys7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGFycmxlbjsgaSsrKSB7CiAgICAgICAgICAgICAgICByZXNbY3RyXSA9IDB4NUY7CiAgICAgICAgICAgICAgICBjdHIrKzsKICAgICAgICAgICAgICAgIGZvciAodWludCB4ID0gMDsgeCA8IGVsZW1BcnJheVtpXS5sZW5ndGg7IHgrKykgewogICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZXJlJ3MgYSBidWcgd2l0aCBsYXJnZXIgc3RyaW5ncywgdGhpcyBtYXkgYmUgdGhlIGN1bHByaXQKICAgICAgICAgICAgICAgICAgICBpZiAoeCAlIDIzID09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgdWludCBlbGVtY2JvcmxlbiA9IGVsZW1BcnJheVtpXS5sZW5ndGggLSB4ID49IDI0ID8gMjMgOiBlbGVtQXJyYXlbaV0ubGVuZ3RoIC0geDsKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWNib3JsZW4gKz0gMHg0MDsKICAgICAgICAgICAgICAgICAgICAgICAgdWludCBsY3RyID0gY3RyOwogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoYnl0ZShlbGVtY2JvcmxlbikubGVuZ3RoID4gY3RyIC0gbGN0cikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzW2N0cl0gPSBieXRlKGVsZW1jYm9ybGVuKVtjdHIgLSBsY3RyXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0cisrOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHJlc1tjdHJdID0gZWxlbUFycmF5W2ldW3hdOwogICAgICAgICAgICAgICAgICAgIGN0cisrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmVzW2N0cl0gPSAweEZGOwogICAgICAgICAgICAgICAgY3RyKys7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHJlczsKICAgICAgICB9CgogICAgZnVuY3Rpb24gYmEyY2JvcihieXRlc1tdIGFycikgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChieXRlcykgewogICAgICAgICAgICB1aW50IGFycmxlbiA9IGFyci5sZW5ndGg7CgogICAgICAgICAgICAvLyBnZXQgY29ycmVjdCBjYm9yIG91dHB1dCBsZW5ndGgKICAgICAgICAgICAgdWludCBvdXRwdXRsZW4gPSAwOwogICAgICAgICAgICBieXRlc1tdIG1lbW9yeSBlbGVtQXJyYXkgPSBuZXcgYnl0ZXNbXShhcnJsZW4pOwogICAgICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBhcnJsZW47IGkrKykgewogICAgICAgICAgICAgICAgZWxlbUFycmF5W2ldID0gKGJ5dGVzKGFycltpXSkpOwogICAgICAgICAgICAgICAgb3V0cHV0bGVuICs9IGVsZW1BcnJheVtpXS5sZW5ndGggKyAoZWxlbUFycmF5W2ldLmxlbmd0aCAtIDEpLzIzICsgMzsgLy8rMyBhY2NvdW50cyBmb3IgcGFpcmVkIGlkZW50aWZpZXIgdHlwZXMKICAgICAgICAgICAgfQogICAgICAgICAgICB1aW50IGN0ciA9IDA7CiAgICAgICAgICAgIHVpbnQgY2JvcmxlbiA9IGFycmxlbiArIDB4ODA7CiAgICAgICAgICAgIG91dHB1dGxlbiArPSBieXRlKGNib3JsZW4pLmxlbmd0aDsKICAgICAgICAgICAgYnl0ZXMgbWVtb3J5IHJlcyA9IG5ldyBieXRlcyhvdXRwdXRsZW4pOwoKICAgICAgICAgICAgd2hpbGUgKGJ5dGUoY2JvcmxlbikubGVuZ3RoID4gY3RyKSB7CiAgICAgICAgICAgICAgICByZXNbY3RyXSA9IGJ5dGUoY2JvcmxlbilbY3RyXTsKICAgICAgICAgICAgICAgIGN0cisrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBhcnJsZW47IGkrKykgewogICAgICAgICAgICAgICAgcmVzW2N0cl0gPSAweDVGOwogICAgICAgICAgICAgICAgY3RyKys7CiAgICAgICAgICAgICAgICBmb3IgKHVpbnQgeCA9IDA7IHggPCBlbGVtQXJyYXlbaV0ubGVuZ3RoOyB4KyspIHsKICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGVyZSdzIGEgYnVnIHdpdGggbGFyZ2VyIHN0cmluZ3MsIHRoaXMgbWF5IGJlIHRoZSBjdWxwcml0CiAgICAgICAgICAgICAgICAgICAgaWYgKHggJSAyMyA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQgZWxlbWNib3JsZW4gPSBlbGVtQXJyYXlbaV0ubGVuZ3RoIC0geCA+PSAyNCA/IDIzIDogZWxlbUFycmF5W2ldLmxlbmd0aCAtIHg7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1jYm9ybGVuICs9IDB4NDA7CiAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQgbGN0ciA9IGN0cjsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGJ5dGUoZWxlbWNib3JsZW4pLmxlbmd0aCA+IGN0ciAtIGxjdHIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc1tjdHJdID0gYnl0ZShlbGVtY2JvcmxlbilbY3RyIC0gbGN0cl07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHIrKzsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXNbY3RyXSA9IGVsZW1BcnJheVtpXVt4XTsKICAgICAgICAgICAgICAgICAgICBjdHIrKzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJlc1tjdHJdID0gMHhGRjsKICAgICAgICAgICAgICAgIGN0cisrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgfQoKCiAgICBzdHJpbmcgb3JhY2xpemVfbmV0d29ya19uYW1lOwogICAgZnVuY3Rpb24gb3JhY2xpemVfc2V0TmV0d29ya05hbWUoc3RyaW5nIF9uZXR3b3JrX25hbWUpIGludGVybmFsIHsKICAgICAgICBvcmFjbGl6ZV9uZXR3b3JrX25hbWUgPSBfbmV0d29ya19uYW1lOwogICAgfQoKICAgIGZ1bmN0aW9uIG9yYWNsaXplX2dldE5ldHdvcmtOYW1lKCkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChzdHJpbmcpIHsKICAgICAgICByZXR1cm4gb3JhY2xpemVfbmV0d29ya19uYW1lOwogICAgfQoKICAgIGZ1bmN0aW9uIG9yYWNsaXplX25ld1JhbmRvbURTUXVlcnkodWludCBfZGVsYXksIHVpbnQgX25ieXRlcywgdWludCBfY3VzdG9tR2FzTGltaXQpIGludGVybmFsIHJldHVybnMgKGJ5dGVzMzIpewogICAgICAgIHJlcXVpcmUoKF9uYnl0ZXMgPiAwKSAmJiAoX25ieXRlcyA8PSAzMikpOwogICAgICAgIC8vIENvbnZlcnQgZnJvbSBzZWNvbmRzIHRvIGxlZGdlciB0aW1lciB0aWNrcwogICAgICAgIF9kZWxheSAqPSAxMDsgCiAgICAgICAgYnl0ZXMgbWVtb3J5IG5ieXRlcyA9IG5ldyBieXRlcygxKTsKICAgICAgICBuYnl0ZXNbMF0gPSBieXRlKF9uYnl0ZXMpOwogICAgICAgIGJ5dGVzIG1lbW9yeSB1bm9uY2UgPSBuZXcgYnl0ZXMoMzIpOwogICAgICAgIGJ5dGVzIG1lbW9yeSBzZXNzaW9uS2V5SGFzaCA9IG5ldyBieXRlcygzMik7CiAgICAgICAgYnl0ZXMzMiBzZXNzaW9uS2V5SGFzaF9ieXRlczMyID0gb3JhY2xpemVfcmFuZG9tRFNfZ2V0U2Vzc2lvblB1YktleUhhc2goKTsKICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgIG1zdG9yZSh1bm9uY2UsIDB4MjApCiAgICAgICAgICAgIG1zdG9yZShhZGQodW5vbmNlLCAweDIwKSwgeG9yKGJsb2NraGFzaChzdWIobnVtYmVyLCAxKSksIHhvcihjb2luYmFzZSwgdGltZXN0YW1wKSkpCiAgICAgICAgICAgIG1zdG9yZShzZXNzaW9uS2V5SGFzaCwgMHgyMCkKICAgICAgICAgICAgbXN0b3JlKGFkZChzZXNzaW9uS2V5SGFzaCwgMHgyMCksIHNlc3Npb25LZXlIYXNoX2J5dGVzMzIpCiAgICAgICAgfQogICAgICAgIGJ5dGVzIG1lbW9yeSBkZWxheSA9IG5ldyBieXRlcygzMik7CiAgICAgICAgYXNzZW1ibHkgeyAKICAgICAgICAgICAgbXN0b3JlKGFkZChkZWxheSwgMHgyMCksIF9kZWxheSkgCiAgICAgICAgfQogICAgICAgIAogICAgICAgIGJ5dGVzIG1lbW9yeSBkZWxheV9ieXRlczggPSBuZXcgYnl0ZXMoOCk7CiAgICAgICAgY29weUJ5dGVzKGRlbGF5LCAyNCwgOCwgZGVsYXlfYnl0ZXM4LCAwKTsKCiAgICAgICAgYnl0ZXNbNF0gbWVtb3J5IGFyZ3MgPSBbdW5vbmNlLCBuYnl0ZXMsIHNlc3Npb25LZXlIYXNoLCBkZWxheV07CiAgICAgICAgYnl0ZXMzMiBxdWVyeUlkID0gb3JhY2xpemVfcXVlcnkoInJhbmRvbSIsIGFyZ3MsIF9jdXN0b21HYXNMaW1pdCk7CiAgICAgICAgCiAgICAgICAgYnl0ZXMgbWVtb3J5IGRlbGF5X2J5dGVzOF9sZWZ0ID0gbmV3IGJ5dGVzKDgpOwogICAgICAgIAogICAgICAgIGFzc2VtYmx5IHsKICAgICAgICAgICAgbGV0IHggOj0gbWxvYWQoYWRkKGRlbGF5X2J5dGVzOCwgMHgyMCkpCiAgICAgICAgICAgIG1zdG9yZTgoYWRkKGRlbGF5X2J5dGVzOF9sZWZ0LCAweDI3KSwgZGl2KHgsIDB4MTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwKSkKICAgICAgICAgICAgbXN0b3JlOChhZGQoZGVsYXlfYnl0ZXM4X2xlZnQsIDB4MjYpLCBkaXYoeCwgMHgxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwKSkKICAgICAgICAgICAgbXN0b3JlOChhZGQoZGVsYXlfYnl0ZXM4X2xlZnQsIDB4MjUpLCBkaXYoeCwgMHgxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCkpCiAgICAgICAgICAgIG1zdG9yZTgoYWRkKGRlbGF5X2J5dGVzOF9sZWZ0LCAweDI0KSwgZGl2KHgsIDB4MTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwKSkKICAgICAgICAgICAgbXN0b3JlOChhZGQoZGVsYXlfYnl0ZXM4X2xlZnQsIDB4MjMpLCBkaXYoeCwgMHgxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwKSkKICAgICAgICAgICAgbXN0b3JlOChhZGQoZGVsYXlfYnl0ZXM4X2xlZnQsIDB4MjIpLCBkaXYoeCwgMHgxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCkpCiAgICAgICAgICAgIG1zdG9yZTgoYWRkKGRlbGF5X2J5dGVzOF9sZWZ0LCAweDIxKSwgZGl2KHgsIDB4MTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwKSkKICAgICAgICAgICAgbXN0b3JlOChhZGQoZGVsYXlfYnl0ZXM4X2xlZnQsIDB4MjApLCBkaXYoeCwgMHgxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwKSkKCiAgICAgICAgfQogICAgICAgIAogICAgICAgIG9yYWNsaXplX3JhbmRvbURTX3NldENvbW1pdG1lbnQocXVlcnlJZCwga2VjY2FrMjU2KGRlbGF5X2J5dGVzOF9sZWZ0LCBhcmdzWzFdLCBzaGEyNTYoYXJnc1swXSksIGFyZ3NbMl0pKTsKICAgICAgICByZXR1cm4gcXVlcnlJZDsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gb3JhY2xpemVfcmFuZG9tRFNfc2V0Q29tbWl0bWVudChieXRlczMyIHF1ZXJ5SWQsIGJ5dGVzMzIgY29tbWl0bWVudCkgaW50ZXJuYWwgewogICAgICAgIG9yYWNsaXplX3JhbmRvbURTX2FyZ3NbcXVlcnlJZF0gPSBjb21taXRtZW50OwogICAgfQoKICAgIG1hcHBpbmcoYnl0ZXMzMj0+Ynl0ZXMzMikgb3JhY2xpemVfcmFuZG9tRFNfYXJnczsKICAgIG1hcHBpbmcoYnl0ZXMzMj0+Ym9vbCkgb3JhY2xpemVfcmFuZG9tRFNfc2Vzc2lvbktleXNIYXNoVmVyaWZpZWQ7CgogICAgZnVuY3Rpb24gdmVyaWZ5U2lnKGJ5dGVzMzIgdG9zaWduaCwgYnl0ZXMgZGVyc2lnLCBieXRlcyBwdWJrZXkpIGludGVybmFsIHJldHVybnMgKGJvb2wpewogICAgICAgIGJvb2wgc2lnb2s7CiAgICAgICAgYWRkcmVzcyBzaWduZXI7CgogICAgICAgIGJ5dGVzMzIgc2lncjsKICAgICAgICBieXRlczMyIHNpZ3M7CgogICAgICAgIGJ5dGVzIG1lbW9yeSBzaWdyXyA9IG5ldyBieXRlcygzMik7CiAgICAgICAgdWludCBvZmZzZXQgPSA0Kyh1aW50KGRlcnNpZ1szXSkgLSAweDIwKTsKICAgICAgICBzaWdyXyA9IGNvcHlCeXRlcyhkZXJzaWcsIG9mZnNldCwgMzIsIHNpZ3JfLCAwKTsKICAgICAgICBieXRlcyBtZW1vcnkgc2lnc18gPSBuZXcgYnl0ZXMoMzIpOwogICAgICAgIG9mZnNldCArPSAzMiArIDI7CiAgICAgICAgc2lnc18gPSBjb3B5Qnl0ZXMoZGVyc2lnLCBvZmZzZXQrKHVpbnQoZGVyc2lnW29mZnNldC0xXSkgLSAweDIwKSwgMzIsIHNpZ3NfLCAwKTsKCiAgICAgICAgYXNzZW1ibHkgewogICAgICAgICAgICBzaWdyIDo9IG1sb2FkKGFkZChzaWdyXywgMzIpKQogICAgICAgICAgICBzaWdzIDo9IG1sb2FkKGFkZChzaWdzXywgMzIpKQogICAgICAgIH0KCgogICAgICAgIChzaWdvaywgc2lnbmVyKSA9IHNhZmVyX2VjcmVjb3Zlcih0b3NpZ25oLCAyNywgc2lnciwgc2lncyk7CiAgICAgICAgaWYgKGFkZHJlc3Moa2VjY2FrMjU2KHB1YmtleSkpID09IHNpZ25lcikgcmV0dXJuIHRydWU7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIChzaWdvaywgc2lnbmVyKSA9IHNhZmVyX2VjcmVjb3Zlcih0b3NpZ25oLCAyOCwgc2lnciwgc2lncyk7CiAgICAgICAgICAgIHJldHVybiAoYWRkcmVzcyhrZWNjYWsyNTYocHVia2V5KSkgPT0gc2lnbmVyKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gb3JhY2xpemVfcmFuZG9tRFNfcHJvb2ZWZXJpZnlfX3Nlc3Npb25LZXlWYWxpZGl0eShieXRlcyBwcm9vZiwgdWludCBzaWcyb2Zmc2V0KSBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7CiAgICAgICAgYm9vbCBzaWdvazsKCiAgICAgICAgLy8gU3RlcCA2OiB2ZXJpZnkgdGhlIGF0dGVzdGF0aW9uIHNpZ25hdHVyZSwgQVBQS0VZMSBtdXN0IHNpZ24gdGhlIHNlc3Npb25LZXkgZnJvbSB0aGUgY29ycmVjdCBsZWRnZXIgYXBwIChDT0RFSEFTSCkKICAgICAgICBieXRlcyBtZW1vcnkgc2lnMiA9IG5ldyBieXRlcyh1aW50KHByb29mW3NpZzJvZmZzZXQrMV0pKzIpOwogICAgICAgIGNvcHlCeXRlcyhwcm9vZiwgc2lnMm9mZnNldCwgc2lnMi5sZW5ndGgsIHNpZzIsIDApOwoKICAgICAgICBieXRlcyBtZW1vcnkgYXBwa2V5MV9wdWJrZXkgPSBuZXcgYnl0ZXMoNjQpOwogICAgICAgIGNvcHlCeXRlcyhwcm9vZiwgMysxLCA2NCwgYXBwa2V5MV9wdWJrZXksIDApOwoKICAgICAgICBieXRlcyBtZW1vcnkgdG9zaWduMiA9IG5ldyBieXRlcygxKzY1KzMyKTsKICAgICAgICB0b3NpZ24yWzBdID0gYnl0ZSgxKTsgLy9yb2xlCiAgICAgICAgY29weUJ5dGVzKHByb29mLCBzaWcyb2Zmc2V0LTY1LCA2NSwgdG9zaWduMiwgMSk7CiAgICAgICAgYnl0ZXMgbWVtb3J5IENPREVIQVNIID0gaGV4ImZkOTRmYTcxYmMwYmExMGQzOWQ0NjRkMGQ4ZjQ2NWVmZWVmMGEyNzY0ZTM4ODdmY2M5ZGY0MWRlZDIwZjUwNWMiOwogICAgICAgIGNvcHlCeXRlcyhDT0RFSEFTSCwgMCwgMzIsIHRvc2lnbjIsIDErNjUpOwogICAgICAgIHNpZ29rID0gdmVyaWZ5U2lnKHNoYTI1Nih0b3NpZ24yKSwgc2lnMiwgYXBwa2V5MV9wdWJrZXkpOwoKICAgICAgICBpZiAoc2lnb2sgPT0gZmFsc2UpIHJldHVybiBmYWxzZTsKCgogICAgICAgIC8vIFN0ZXAgNzogdmVyaWZ5IHRoZSBBUFBLRVkxIHByb3ZlbmFuY2UgKG11c3QgYmUgc2lnbmVkIGJ5IExlZGdlcikKICAgICAgICBieXRlcyBtZW1vcnkgTEVER0VSS0VZID0gaGV4IjdmYjk1NjQ2OWM1YzliODk4NDBkNTViNDM1MzdlNjZhOThkZDQ4MTFlYTBhMjcyMjQyNzJjMmU1NjIyOTExZTg1MzdhMmY4ZTg2YTQ2YmFlYzgyODY0ZTk4ZGQwMWU5Y2NjMmY4YmM1ZGZjOWNiZTVhOTFhMjkwNDk4ZGQ5NmU0IjsKCiAgICAgICAgYnl0ZXMgbWVtb3J5IHRvc2lnbjMgPSBuZXcgYnl0ZXMoMSs2NSk7CiAgICAgICAgdG9zaWduM1swXSA9IDB4RkU7CiAgICAgICAgY29weUJ5dGVzKHByb29mLCAzLCA2NSwgdG9zaWduMywgMSk7CgogICAgICAgIGJ5dGVzIG1lbW9yeSBzaWczID0gbmV3IGJ5dGVzKHVpbnQocHJvb2ZbMys2NSsxXSkrMik7CiAgICAgICAgY29weUJ5dGVzKHByb29mLCAzKzY1LCBzaWczLmxlbmd0aCwgc2lnMywgMCk7CgogICAgICAgIHNpZ29rID0gdmVyaWZ5U2lnKHNoYTI1Nih0b3NpZ24zKSwgc2lnMywgTEVER0VSS0VZKTsKCiAgICAgICAgcmV0dXJuIHNpZ29rOwogICAgfQoKICAgIG1vZGlmaWVyIG9yYWNsaXplX3JhbmRvbURTX3Byb29mVmVyaWZ5KGJ5dGVzMzIgX3F1ZXJ5SWQsIHN0cmluZyBfcmVzdWx0LCBieXRlcyBfcHJvb2YpIHsKICAgICAgICAvLyBTdGVwIDE6IHRoZSBwcmVmaXggaGFzIHRvIG1hdGNoICdMUFx4MDEnIChMZWRnZXIgUHJvb2YgdmVyc2lvbiAxKQogICAgICAgIHJlcXVpcmUoKF9wcm9vZlswXSA9PSAiTCIpICYmIChfcHJvb2ZbMV0gPT0gIlAiKSAmJiAoX3Byb29mWzJdID09IDEpKTsKCiAgICAgICAgYm9vbCBwcm9vZlZlcmlmaWVkID0gb3JhY2xpemVfcmFuZG9tRFNfcHJvb2ZWZXJpZnlfX21haW4oX3Byb29mLCBfcXVlcnlJZCwgYnl0ZXMoX3Jlc3VsdCksIG9yYWNsaXplX2dldE5ldHdvcmtOYW1lKCkpOwogICAgICAgIHJlcXVpcmUocHJvb2ZWZXJpZmllZCk7CgogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gb3JhY2xpemVfcmFuZG9tRFNfcHJvb2ZWZXJpZnlfX3JldHVybkNvZGUoYnl0ZXMzMiBfcXVlcnlJZCwgc3RyaW5nIF9yZXN1bHQsIGJ5dGVzIF9wcm9vZikgaW50ZXJuYWwgcmV0dXJucyAodWludDgpewogICAgICAgIC8vIFN0ZXAgMTogdGhlIHByZWZpeCBoYXMgdG8gbWF0Y2ggJ0xQXHgwMScgKExlZGdlciBQcm9vZiB2ZXJzaW9uIDEpCiAgICAgICAgaWYgKChfcHJvb2ZbMF0gIT0gIkwiKXx8KF9wcm9vZlsxXSAhPSAiUCIpfHwoX3Byb29mWzJdICE9IDEpKSByZXR1cm4gMTsKCiAgICAgICAgYm9vbCBwcm9vZlZlcmlmaWVkID0gb3JhY2xpemVfcmFuZG9tRFNfcHJvb2ZWZXJpZnlfX21haW4oX3Byb29mLCBfcXVlcnlJZCwgYnl0ZXMoX3Jlc3VsdCksIG9yYWNsaXplX2dldE5ldHdvcmtOYW1lKCkpOwogICAgICAgIGlmIChwcm9vZlZlcmlmaWVkID09IGZhbHNlKSByZXR1cm4gMjsKCiAgICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgZnVuY3Rpb24gbWF0Y2hCeXRlczMyUHJlZml4KGJ5dGVzMzIgY29udGVudCwgYnl0ZXMgcHJlZml4LCB1aW50IG5fcmFuZG9tX2J5dGVzKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKGJvb2wpewogICAgICAgIGJvb2wgbWF0Y2hfID0gdHJ1ZTsKICAgICAgICAKICAgICAgICByZXF1aXJlKHByZWZpeC5sZW5ndGggPT0gbl9yYW5kb21fYnl0ZXMpOwoKICAgICAgICBmb3IgKHVpbnQyNTYgaT0wOyBpPCBuX3JhbmRvbV9ieXRlczsgaSsrKSB7CiAgICAgICAgICAgIGlmIChjb250ZW50W2ldICE9IHByZWZpeFtpXSkgbWF0Y2hfID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbWF0Y2hfOwogICAgfQoKICAgIGZ1bmN0aW9uIG9yYWNsaXplX3JhbmRvbURTX3Byb29mVmVyaWZ5X19tYWluKGJ5dGVzIHByb29mLCBieXRlczMyIHF1ZXJ5SWQsIGJ5dGVzIHJlc3VsdCwgc3RyaW5nIGNvbnRleHRfbmFtZSkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCl7CgogICAgICAgIC8vIFN0ZXAgMjogdGhlIHVuaXF1ZSBrZXloYXNoIGhhcyB0byBtYXRjaCB3aXRoIHRoZSBzaGEyNTYgb2YgKGNvbnRleHQgbmFtZSArIHF1ZXJ5SWQpCiAgICAgICAgdWludCBsZWRnZXJQcm9vZkxlbmd0aCA9IDMrNjUrKHVpbnQocHJvb2ZbMys2NSsxXSkrMikrMzI7CiAgICAgICAgYnl0ZXMgbWVtb3J5IGtleWhhc2ggPSBuZXcgYnl0ZXMoMzIpOwogICAgICAgIGNvcHlCeXRlcyhwcm9vZiwgbGVkZ2VyUHJvb2ZMZW5ndGgsIDMyLCBrZXloYXNoLCAwKTsKICAgICAgICBpZiAoIShrZWNjYWsyNTYoa2V5aGFzaCkgPT0ga2VjY2FrMjU2KHNoYTI1Nihjb250ZXh0X25hbWUsIHF1ZXJ5SWQpKSkpIHJldHVybiBmYWxzZTsKCiAgICAgICAgYnl0ZXMgbWVtb3J5IHNpZzEgPSBuZXcgYnl0ZXModWludChwcm9vZltsZWRnZXJQcm9vZkxlbmd0aCsoMzIrOCsxKzMyKSsxXSkrMik7CiAgICAgICAgY29weUJ5dGVzKHByb29mLCBsZWRnZXJQcm9vZkxlbmd0aCsoMzIrOCsxKzMyKSwgc2lnMS5sZW5ndGgsIHNpZzEsIDApOwoKICAgICAgICAvLyBTdGVwIDM6IHdlIGFzc3VtZSBzaWcxIGlzIHZhbGlkIChpdCB3aWxsIGJlIHZlcmlmaWVkIGR1cmluZyBzdGVwIDUpIGFuZCB3ZSB2ZXJpZnkgaWYgJ3Jlc3VsdCcgaXMgdGhlIHByZWZpeCBvZiBzaGEyNTYoc2lnMSkKICAgICAgICBpZiAoIW1hdGNoQnl0ZXMzMlByZWZpeChzaGEyNTYoc2lnMSksIHJlc3VsdCwgdWludChwcm9vZltsZWRnZXJQcm9vZkxlbmd0aCszMis4XSkpKSByZXR1cm4gZmFsc2U7CgogICAgICAgIC8vIFN0ZXAgNDogY29tbWl0bWVudCBtYXRjaCB2ZXJpZmljYXRpb24sIGtlY2NhazI1NihkZWxheSwgbmJ5dGVzLCB1bm9uY2UsIHNlc3Npb25LZXlIYXNoKSA9PSBjb21taXRtZW50IGluIHN0b3JhZ2UuCiAgICAgICAgLy8gVGhpcyBpcyB0byB2ZXJpZnkgdGhhdCB0aGUgY29tcHV0ZWQgYXJncyBtYXRjaCB3aXRoIHRoZSBvbmVzIHNwZWNpZmllZCBpbiB0aGUgcXVlcnkuCiAgICAgICAgYnl0ZXMgbWVtb3J5IGNvbW1pdG1lbnRTbGljZTEgPSBuZXcgYnl0ZXMoOCsxKzMyKTsKICAgICAgICBjb3B5Qnl0ZXMocHJvb2YsIGxlZGdlclByb29mTGVuZ3RoKzMyLCA4KzErMzIsIGNvbW1pdG1lbnRTbGljZTEsIDApOwoKICAgICAgICBieXRlcyBtZW1vcnkgc2Vzc2lvblB1YmtleSA9IG5ldyBieXRlcyg2NCk7CiAgICAgICAgdWludCBzaWcyb2Zmc2V0ID0gbGVkZ2VyUHJvb2ZMZW5ndGgrMzIrKDgrMSszMikrc2lnMS5sZW5ndGgrNjU7CiAgICAgICAgY29weUJ5dGVzKHByb29mLCBzaWcyb2Zmc2V0LTY0LCA2NCwgc2Vzc2lvblB1YmtleSwgMCk7CgogICAgICAgIGJ5dGVzMzIgc2Vzc2lvblB1YmtleUhhc2ggPSBzaGEyNTYoc2Vzc2lvblB1YmtleSk7CiAgICAgICAgaWYgKG9yYWNsaXplX3JhbmRvbURTX2FyZ3NbcXVlcnlJZF0gPT0ga2VjY2FrMjU2KGNvbW1pdG1lbnRTbGljZTEsIHNlc3Npb25QdWJrZXlIYXNoKSl7IC8vdW5vbmNlLCBuYnl0ZXMgYW5kIHNlc3Npb25LZXlIYXNoIG1hdGNoCiAgICAgICAgICAgIGRlbGV0ZSBvcmFjbGl6ZV9yYW5kb21EU19hcmdzW3F1ZXJ5SWRdOwogICAgICAgIH0gZWxzZSByZXR1cm4gZmFsc2U7CgoKICAgICAgICAvLyBTdGVwIDU6IHZhbGlkaXR5IHZlcmlmaWNhdGlvbiBmb3Igc2lnMSAoa2V5aGFzaCBhbmQgYXJncyBzaWduZWQgd2l0aCB0aGUgc2Vzc2lvbktleSkKICAgICAgICBieXRlcyBtZW1vcnkgdG9zaWduMSA9IG5ldyBieXRlcygzMis4KzErMzIpOwogICAgICAgIGNvcHlCeXRlcyhwcm9vZiwgbGVkZ2VyUHJvb2ZMZW5ndGgsIDMyKzgrMSszMiwgdG9zaWduMSwgMCk7CiAgICAgICAgaWYgKCF2ZXJpZnlTaWcoc2hhMjU2KHRvc2lnbjEpLCBzaWcxLCBzZXNzaW9uUHVia2V5KSkgcmV0dXJuIGZhbHNlOwoKICAgICAgICAvLyB2ZXJpZnkgaWYgc2Vzc2lvblB1YmtleUhhc2ggd2FzIHZlcmlmaWVkIGFscmVhZHksIGlmIG5vdC4uIGxldCdzIGRvIGl0IQogICAgICAgIGlmIChvcmFjbGl6ZV9yYW5kb21EU19zZXNzaW9uS2V5c0hhc2hWZXJpZmllZFtzZXNzaW9uUHVia2V5SGFzaF0gPT0gZmFsc2UpewogICAgICAgICAgICBvcmFjbGl6ZV9yYW5kb21EU19zZXNzaW9uS2V5c0hhc2hWZXJpZmllZFtzZXNzaW9uUHVia2V5SGFzaF0gPSBvcmFjbGl6ZV9yYW5kb21EU19wcm9vZlZlcmlmeV9fc2Vzc2lvbktleVZhbGlkaXR5KHByb29mLCBzaWcyb2Zmc2V0KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBvcmFjbGl6ZV9yYW5kb21EU19zZXNzaW9uS2V5c0hhc2hWZXJpZmllZFtzZXNzaW9uUHVia2V5SGFzaF07CiAgICB9CgogICAgLy8gdGhlIGZvbGxvd2luZyBmdW5jdGlvbiBoYXMgYmVlbiB3cml0dGVuIGJ5IEFsZXggQmVyZWdzemFzemkgKEBheGljKSwgdXNlIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgTUlUIGxpY2Vuc2UKICAgIGZ1bmN0aW9uIGNvcHlCeXRlcyhieXRlcyBmcm9tLCB1aW50IGZyb21PZmZzZXQsIHVpbnQgbGVuZ3RoLCBieXRlcyB0bywgdWludCB0b09mZnNldCkgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChieXRlcykgewogICAgICAgIHVpbnQgbWluTGVuZ3RoID0gbGVuZ3RoICsgdG9PZmZzZXQ7CgogICAgICAgIC8vIEJ1ZmZlciB0b28gc21hbGwKICAgICAgICByZXF1aXJlKHRvLmxlbmd0aCA+PSBtaW5MZW5ndGgpOyAvLyBTaG91bGQgYmUgYSBiZXR0ZXIgd2F5PwoKICAgICAgICAvLyBOT1RFOiB0aGUgb2Zmc2V0IDMyIGlzIGFkZGVkIHRvIHNraXAgdGhlIGBzaXplYCBmaWVsZCBvZiBib3RoIGJ5dGVzIHZhcmlhYmxlcwogICAgICAgIHVpbnQgaSA9IDMyICsgZnJvbU9mZnNldDsKICAgICAgICB1aW50IGogPSAzMiArIHRvT2Zmc2V0OwoKICAgICAgICB3aGlsZSAoaSA8ICgzMiArIGZyb21PZmZzZXQgKyBsZW5ndGgpKSB7CiAgICAgICAgICAgIGFzc2VtYmx5IHsKICAgICAgICAgICAgICAgIGxldCB0bXAgOj0gbWxvYWQoYWRkKGZyb20sIGkpKQogICAgICAgICAgICAgICAgbXN0b3JlKGFkZCh0bywgaiksIHRtcCkKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDMyOwogICAgICAgICAgICBqICs9IDMyOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRvOwogICAgfQoKICAgIC8vIHRoZSBmb2xsb3dpbmcgZnVuY3Rpb24gaGFzIGJlZW4gd3JpdHRlbiBieSBBbGV4IEJlcmVnc3phc3ppIChAYXhpYyksIHVzZSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIE1JVCBsaWNlbnNlCiAgICAvLyBEdXBsaWNhdGUgU29saWRpdHkncyBlY3JlY292ZXIsIGJ1dCBjYXRjaGluZyB0aGUgQ0FMTCByZXR1cm4gdmFsdWUKICAgIGZ1bmN0aW9uIHNhZmVyX2VjcmVjb3ZlcihieXRlczMyIGhhc2gsIHVpbnQ4IHYsIGJ5dGVzMzIgciwgYnl0ZXMzMiBzKSBpbnRlcm5hbCByZXR1cm5zIChib29sLCBhZGRyZXNzKSB7CiAgICAgICAgLy8gV2UgZG8gb3VyIG93biBtZW1vcnkgbWFuYWdlbWVudCBoZXJlLiBTb2xpZGl0eSB1c2VzIG1lbW9yeSBvZmZzZXQKICAgICAgICAvLyAweDQwIHRvIHN0b3JlIHRoZSBjdXJyZW50IGVuZCBvZiBtZW1vcnkuIFdlIHdyaXRlIHBhc3QgaXQgKGFzCiAgICAgICAgLy8gd3JpdGVzIGFyZSBtZW1vcnkgZXh0ZW5zaW9ucyksIGJ1dCBkb24ndCB1cGRhdGUgdGhlIG9mZnNldCBzbwogICAgICAgIC8vIFNvbGlkaXR5IHdpbGwgcmV1c2UgaXQuIFRoZSBtZW1vcnkgdXNlZCBoZXJlIGlzIG9ubHkgbmVlZGVkIGZvcgogICAgICAgIC8vIHRoaXMgY29udGV4dC4KCiAgICAgICAgLy8gRklYTUU6IGlubGluZSBhc3NlbWJseSBjYW4ndCBhY2Nlc3MgcmV0dXJuIHZhbHVlcwogICAgICAgIGJvb2wgcmV0OwogICAgICAgIGFkZHJlc3MgYWRkcjsKCiAgICAgICAgYXNzZW1ibHkgewogICAgICAgICAgICBsZXQgc2l6ZSA6PSBtbG9hZCgweDQwKQogICAgICAgICAgICBtc3RvcmUoc2l6ZSwgaGFzaCkKICAgICAgICAgICAgbXN0b3JlKGFkZChzaXplLCAzMiksIHYpCiAgICAgICAgICAgIG1zdG9yZShhZGQoc2l6ZSwgNjQpLCByKQogICAgICAgICAgICBtc3RvcmUoYWRkKHNpemUsIDk2KSwgcykKCiAgICAgICAgICAgIC8vIE5PVEU6IHdlIGNhbiByZXVzZSB0aGUgcmVxdWVzdCBtZW1vcnkgYmVjYXVzZSB3ZSBkZWFsIHdpdGgKICAgICAgICAgICAgLy8gICAgICAgdGhlIHJldHVybiBjb2RlCiAgICAgICAgICAgIHJldCA6PSBjYWxsKDMwMDAsIDEsIDAsIHNpemUsIDEyOCwgc2l6ZSwgMzIpCiAgICAgICAgICAgIGFkZHIgOj0gbWxvYWQoc2l6ZSkKICAgICAgICB9CgogICAgICAgIHJldHVybiAocmV0LCBhZGRyKTsKICAgIH0KCiAgICAvLyB0aGUgZm9sbG93aW5nIGZ1bmN0aW9uIGhhcyBiZWVuIHdyaXR0ZW4gYnkgQWxleCBCZXJlZ3N6YXN6aSAoQGF4aWMpLCB1c2UgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBNSVQgbGljZW5zZQogICAgZnVuY3Rpb24gZWNyZWNvdmVyeShieXRlczMyIGhhc2gsIGJ5dGVzIHNpZykgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCwgYWRkcmVzcykgewogICAgICAgIGJ5dGVzMzIgcjsKICAgICAgICBieXRlczMyIHM7CiAgICAgICAgdWludDggdjsKCiAgICAgICAgaWYgKHNpZy5sZW5ndGggIT0gNjUpCiAgICAgICAgICByZXR1cm4gKGZhbHNlLCAwKTsKCiAgICAgICAgLy8gVGhlIHNpZ25hdHVyZSBmb3JtYXQgaXMgYSBjb21wYWN0IGZvcm0gb2Y6CiAgICAgICAgLy8gICB7Ynl0ZXMzMiByfXtieXRlczMyIHN9e3VpbnQ4IHZ9CiAgICAgICAgLy8gQ29tcGFjdCBtZWFucywgdWludDggaXMgbm90IHBhZGRlZCB0byAzMiBieXRlcy4KICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgIHIgOj0gbWxvYWQoYWRkKHNpZywgMzIpKQogICAgICAgICAgICBzIDo9IG1sb2FkKGFkZChzaWcsIDY0KSkKCiAgICAgICAgICAgIC8vIEhlcmUgd2UgYXJlIGxvYWRpbmcgdGhlIGxhc3QgMzIgYnl0ZXMuIFdlIGV4cGxvaXQgdGhlIGZhY3QgdGhhdAogICAgICAgICAgICAvLyAnbWxvYWQnIHdpbGwgcGFkIHdpdGggemVyb2VzIGlmIHdlIG92ZXJyZWFkLgogICAgICAgICAgICAvLyBUaGVyZSBpcyBubyAnbWxvYWQ4JyB0byBkbyB0aGlzLCBidXQgdGhhdCB3b3VsZCBiZSBuaWNlci4KICAgICAgICAgICAgdiA6PSBieXRlKDAsIG1sb2FkKGFkZChzaWcsIDk2KSkpCgogICAgICAgICAgICAvLyBBbHRlcm5hdGl2ZSBzb2x1dGlvbjoKICAgICAgICAgICAgLy8gJ2J5dGUnIGlzIG5vdCB3b3JraW5nIGR1ZSB0byB0aGUgU29saWRpdHkgcGFyc2VyLCBzbyBsZXRzCiAgICAgICAgICAgIC8vIHVzZSB0aGUgc2Vjb25kIGJlc3Qgb3B0aW9uLCAnYW5kJwogICAgICAgICAgICAvLyB2IDo9IGFuZChtbG9hZChhZGQoc2lnLCA2NSkpLCAyNTUpCiAgICAgICAgfQoKICAgICAgICAvLyBhbGJlaXQgbm9uLXRyYW5zYWN0aW9uYWwgc2lnbmF0dXJlcyBhcmUgbm90IHNwZWNpZmllZCBieSB0aGUgWVAsIG9uZSB3b3VsZCBleHBlY3QgaXQKICAgICAgICAvLyB0byBtYXRjaCB0aGUgWVAgcmFuZ2Ugb2YgWzI3LCAyOF0KICAgICAgICAvLwogICAgICAgIC8vIGdldGggdXNlcyBbMCwgMV0gYW5kIHNvbWUgY2xpZW50cyBoYXZlIGZvbGxvd2VkLiBUaGlzIG1pZ2h0IGNoYW5nZSwgc2VlOgogICAgICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vZ28tZXRoZXJldW0vaXNzdWVzLzIwNTMKICAgICAgICBpZiAodiA8IDI3KQogICAgICAgICAgdiArPSAyNzsKCiAgICAgICAgaWYgKHYgIT0gMjcgJiYgdiAhPSAyOCkKICAgICAgICAgICAgcmV0dXJuIChmYWxzZSwgMCk7CgogICAgICAgIHJldHVybiBzYWZlcl9lY3JlY292ZXIoaGFzaCwgdiwgciwgcyk7CiAgICB9Cgp9Ci8vIDwvT1JBQ0xJWkVfQVBJPgoKY29udHJhY3QgRU9TQmV0R2FtZUludGVyZmFjZSB7Cgl1aW50MjU2IHB1YmxpYyBERVZFTE9QRVJTRlVORDsKCXVpbnQyNTYgcHVibGljIExJQUJJTElUSUVTOwoJZnVuY3Rpb24gcGF5RGV2ZWxvcGVyc0Z1bmQoYWRkcmVzcyBkZXZlbG9wZXIpIHB1YmxpYzsKCWZ1bmN0aW9uIHJlY2VpdmVQYXltZW50Rm9yT3JhY2xpemUoKSBwYXlhYmxlIHB1YmxpYzsKCWZ1bmN0aW9uIGdldE1heFdpbigpIHB1YmxpYyB2aWV3IHJldHVybnModWludDI1Nik7Cn0KCmNvbnRyYWN0IEVPU0JldEJhbmtyb2xsSW50ZXJmYWNlIHsKCWZ1bmN0aW9uIHBheUV0aGVyVG9XaW5uZXIodWludDI1NiBhbXRFdGhlciwgYWRkcmVzcyB3aW5uZXIpIHB1YmxpYzsKCWZ1bmN0aW9uIHJlY2VpdmVFdGhlckZyb21HYW1lQWRkcmVzcygpIHBheWFibGUgcHVibGljOwoJZnVuY3Rpb24gcGF5T3JhY2xpemUodWludDI1NiBhbW91bnRUb1BheSkgcHVibGljOwoJZnVuY3Rpb24gZ2V0QmFua3JvbGwoKSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnQyNTYpOwp9Cgpjb250cmFjdCBFUkMyMCB7CglmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50IHN1cHBseSk7CglmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50IGJhbGFuY2UpOwoJZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCWZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoJZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CglmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50IHJlbWFpbmluZyk7CglldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQgX3ZhbHVlKTsKCWV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludCBfdmFsdWUpOwp9Cgpjb250cmFjdCBFT1NCZXRCYW5rcm9sbCBpcyBFUkMyMCwgRU9TQmV0QmFua3JvbGxJbnRlcmZhY2UgewoKCXVzaW5nIFNhZmVNYXRoIGZvciAqOwoKCS8vIGNvbnN0YW50cyBmb3IgRU9TQmV0IEJhbmtyb2xsCgoJYWRkcmVzcyBwdWJsaWMgT1dORVI7Cgl1aW50MjU2IHB1YmxpYyBNQVhJTVVNSU5WRVNUTUVOVFNBTExPV0VEOwoJdWludDI1NiBwdWJsaWMgV0FJVFRJTUVVTlRJTFdJVEhEUkFXT1JUUkFOU0ZFUjsKCXVpbnQyNTYgcHVibGljIERFVkVMT1BFUlNGVU5EOwoKCS8vIHRoaXMgd2lsbCBiZSBpbml0aWFsaXplZCBhcyB0aGUgdHJ1c3RlZCBnYW1lIGFkZHJlc3NlcyB3aGljaCB3aWxsIGZvcndhcmQgdGhlaXIgZXRoZXIKCS8vIHRvIHRoZSBiYW5rcm9sbCBjb250cmFjdCwgYW5kIHdoZW4gcGxheWVycyB3aW4sIHRoZXkgd2lsbCByZXF1ZXN0IHRoZSBiYW5rcm9sbCBjb250cmFjdCAKCS8vIHRvIHNlbmQgdGhlc2UgcGxheWVycyB0aGVpciB3aW5uaW5ncy4KCS8vIEZlZWwgZnJlZSB0byBhdWRpdCB0aGVzZSBjb250cmFjdHMgb24gZXRoZXJzY2FuLi4uCgltYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIFRSVVNURURBRERSRVNTRVM7CgoJYWRkcmVzcyBwdWJsaWMgRElDRTsKCWFkZHJlc3MgcHVibGljIFNMT1RTOwoKCS8vIG1hcHBpbmcgdG8gbG9nIHRoZSBsYXN0IHRpbWUgYSB1c2VyIGNvbnRyaWJ1dGVkIHRvIHRoZSBiYW5rcm9sbCAKCW1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBjb250cmlidXRpb25UaW1lOwoKCS8vIGNvbnN0YW50cyBmb3IgRVJDMjAgc3RhbmRhcmQKCXN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJFT1NCZXQgU3Rha2UgVG9rZW5zIjsKCXN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIkVPU0JFVFNUIjsKCXVpbnQ4IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwoJLy8gdmFyaWFibGUgdG90YWwgc3VwcGx5Cgl1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKCgkvLyBtYXBwaW5nIHRvIHN0b3JlIHRva2VucwoJbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBiYWxhbmNlczsKCW1hcHBpbmcoYWRkcmVzcyA9PiBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikpIHB1YmxpYyBhbGxvd2VkOwoKCS8vIGV2ZW50cwoJZXZlbnQgRnVuZEJhbmtyb2xsKGFkZHJlc3MgY29udHJpYnV0b3IsIHVpbnQyNTYgZXRoZXJDb250cmlidXRlZCwgdWludDI1NiB0b2tlbnNSZWNlaXZlZCk7CglldmVudCBDYXNoT3V0KGFkZHJlc3MgY29udHJpYnV0b3IsIHVpbnQyNTYgZXRoZXJXaXRoZHJhd24sIHVpbnQyNTYgdG9rZW5zQ2FzaGVkSW4pOwoJZXZlbnQgRmFpbGVkU2VuZChhZGRyZXNzIHNlbmRUbywgdWludDI1NiBhbXQpOwoKCS8vIGNoZWNrcyB0aGF0IGFuIGFkZHJlc3MgaXMgYSAidHJ1c3RlZCBhZGRyZXNzIG9mIGEgbGVnaXRpbWF0ZSBFT1NCZXQgZ2FtZSIKCW1vZGlmaWVyIGFkZHJlc3NJblRydXN0ZWRBZGRyZXNzZXMoYWRkcmVzcyB0aGlzQWRkcmVzcyl7CgoJCXJlcXVpcmUoVFJVU1RFREFERFJFU1NFU1t0aGlzQWRkcmVzc10pOwoJCV87Cgl9CgoJLy8gaW5pdGlhbGl6YXRpb24gZnVuY3Rpb24gCglmdW5jdGlvbiBFT1NCZXRCYW5rcm9sbChhZGRyZXNzIGRpY2UsIGFkZHJlc3Mgc2xvdHMpIHB1YmxpYyBwYXlhYmxlIHsKCQkvLyBmdW5jdGlvbiBpcyBwYXlhYmxlLCBvd25lciBvZiBjb250cmFjdCBNVVNUICJzZWVkIiBjb250cmFjdCB3aXRoIHNvbWUgZXRoZXIsIAoJCS8vIHNvIHRoYXQgdGhlIHJhdGlvcyBhcmUgY29ycmVjdCB3aGVuIHRva2VucyBhcmUgYmVpbmcgbWludGVkCgkJcmVxdWlyZSAobXNnLnZhbHVlID4gMCk7CgoJCU9XTkVSID0gbXNnLnNlbmRlcjsKCgkJLy8gMTAwIHRva2Vucy9ldGhlciBpcyB0aGUgaW5pdGFsIHNlZWQgYW1vdW50LCBzbzoKCQl1aW50MjU2IGluaXRpYWxUb2tlbnMgPSBtc2cudmFsdWUgKiAxMDA7CgkJYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBpbml0aWFsVG9rZW5zOwoJCXRvdGFsU3VwcGx5ID0gaW5pdGlhbFRva2VuczsKCgkJLy8gbG9nIGEgbWludCB0b2tlbnMgZXZlbnQKCQllbWl0IFRyYW5zZmVyKDB4MCwgbXNnLnNlbmRlciwgaW5pdGlhbFRva2Vucyk7CgoJCS8vIGluc2VydCBnaXZlbiBnYW1lIGFkZHJlc3NlcyBpbnRvIHRoZSBUUlVTVEVEQUREUkVTU0VTIG1hcHBpbmcsIGFuZCBzYXZlIHRoZSBhZGRyZXNzZXMgYXMgZ2xvYmFsIHZhcmlhYmxlcwoJCVRSVVNURURBRERSRVNTRVNbZGljZV0gPSB0cnVlOwoJCVRSVVNURURBRERSRVNTRVNbc2xvdHNdID0gdHJ1ZTsKCgkJRElDRSA9IGRpY2U7CgkJU0xPVFMgPSBzbG90czsKCgkJLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgkJLy8gQ0hBTkdFIFRPIDYgSE9VUlMgT04gTElWRSBERVBMT1lNRU5UCgkJLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgkJV0FJVFRJTUVVTlRJTFdJVEhEUkFXT1JUUkFOU0ZFUiA9IDAgc2Vjb25kczsKCQlNQVhJTVVNSU5WRVNUTUVOVFNBTExPV0VEID0gNTAwIGV0aGVyOwoJfQoKCS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgkvLyBWSUVXIEZVTkNUSU9OUwoJLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gCgoJZnVuY3Rpb24gY2hlY2tXaGVuQ29udHJpYnV0b3JDYW5UcmFuc2Zlck9yV2l0aGRyYXcoYWRkcmVzcyBiYW5rcm9sbGVyQWRkcmVzcykgdmlldyBwdWJsaWMgcmV0dXJucyh1aW50MjU2KXsKCQlyZXR1cm4gY29udHJpYnV0aW9uVGltZVtiYW5rcm9sbGVyQWRkcmVzc107Cgl9CgoJZnVuY3Rpb24gZ2V0QmFua3JvbGwoKSB2aWV3IHB1YmxpYyByZXR1cm5zKHVpbnQyNTYpewoJCS8vIHJldHVybnMgdGhlIHRvdGFsIGJhbGFuY2UgbWludXMgdGhlIGRldmVsb3BlcnMgZnVuZCwgYXMgdGhlIGFtb3VudCBvZiBhY3RpdmUgYmFua3JvbGwKCQlyZXR1cm4gU2FmZU1hdGguc3ViKGFkZHJlc3ModGhpcykuYmFsYW5jZSwgREVWRUxPUEVSU0ZVTkQpOwoJfQoKCS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgkvLyBCQU5LUk9MTCBDT05UUkFDVCA8LT4gR0FNRSBDT05UUkFDVFMgZnVuY3Rpb25zCgkvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyAKCglmdW5jdGlvbiBwYXlFdGhlclRvV2lubmVyKHVpbnQyNTYgYW10RXRoZXIsIGFkZHJlc3Mgd2lubmVyKSBwdWJsaWMgYWRkcmVzc0luVHJ1c3RlZEFkZHJlc3Nlcyhtc2cuc2VuZGVyKXsKCQkvLyB0aGlzIGZ1bmN0aW9uIHdpbGwgZ2V0IGNhbGxlZCBieSBhIGdhbWUgY29udHJhY3Qgd2hlbiBzb21lb25lIHdpbnMgYSBnYW1lCgkJLy8gdHJ5IHRvIHNlbmQsIGlmIGl0IGZhaWxzLCB0aGVuIHNlbmQgdGhlIGFtb3VudCB0byB0aGUgb3duZXIKCQkvLyBub3RlLCB0aGlzIHdpbGwgb25seSBoYXBwZW4gaWYgc29tZW9uZSBpcyBjYWxsaW5nIHRoZSBiZXR0aW5nIGZ1bmN0aW9ucyB3aXRoCgkJLy8gYSBjb250cmFjdC4gVGhleSBhcmUgY2xlYXJseSB1cCB0byBubyBnb29kLCBzbyB0aGV5IGNhbiBjb250YWN0IHVzIHRvIHJldHJlaXZlIAoJCS8vIHRoZWlyIGV0aGVyCgkJLy8gaWYgdGhlIGV0aGVyIGNhbm5vdCBiZSBzZW50IHRvIHVzLCB0aGUgT1dORVIsIHRoYXQgbWVhbnMgd2UgYXJlIHVwIHRvIG5vIGdvb2QsIAoJCS8vIGFuZCB0aGUgZXRoZXIgd2lsbCBqdXN0IGJlIGdpdmVuIHRvIHRoZSBiYW5rcm9sbGVycyBhcyBpZiB0aGUgcGxheWVyL293bmVyIGxvc3QgCgoJCWlmICghIHdpbm5lci5zZW5kKGFtdEV0aGVyKSl7CgoJCQllbWl0IEZhaWxlZFNlbmQod2lubmVyLCBhbXRFdGhlcik7CgoJCQlpZiAoISBPV05FUi5zZW5kKGFtdEV0aGVyKSl7CgoJCQkJZW1pdCBGYWlsZWRTZW5kKE9XTkVSLCBhbXRFdGhlcik7CgkJCX0KCQl9Cgl9CgoJZnVuY3Rpb24gcmVjZWl2ZUV0aGVyRnJvbUdhbWVBZGRyZXNzKCkgcGF5YWJsZSBwdWJsaWMgYWRkcmVzc0luVHJ1c3RlZEFkZHJlc3Nlcyhtc2cuc2VuZGVyKXsKCQkvLyB0aGlzIGZ1bmN0aW9uIHdpbGwgZ2V0IGNhbGxlZCBmcm9tIHRoZSBnYW1lIGNvbnRyYWN0cyB3aGVuIHNvbWVvbmUgc3RhcnRzIGEgZ2FtZS4KCX0KCglmdW5jdGlvbiBwYXlPcmFjbGl6ZSh1aW50MjU2IGFtb3VudFRvUGF5KSBwdWJsaWMgYWRkcmVzc0luVHJ1c3RlZEFkZHJlc3Nlcyhtc2cuc2VuZGVyKXsKCQkvLyB0aGlzIGZ1bmN0aW9uIHdpbGwgZ2V0IGNhbGxlZCB3aGVuIGEgZ2FtZSBjb250cmFjdCBtdXN0IHBheSBwYXlPcmFjbGl6ZQoJCUVPU0JldEdhbWVJbnRlcmZhY2UobXNnLnNlbmRlcikucmVjZWl2ZVBheW1lbnRGb3JPcmFjbGl6ZS52YWx1ZShhbW91bnRUb1BheSkoKTsKCX0KCgkvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoJLy8gQkFOS1JPTEwgQ09OVFJBQ1QgTUFJTiBGVU5DVElPTlMKCS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgoKCS8vIHRoaXMgZnVuY3Rpb24gQUREUyB0byB0aGUgYmFua3JvbGwgb2YgRU9TQmV0LCBhbmQgY3JlZGl0cyB0aGUgYmFua3JvbGxlciBhIHByb3BvcnRpb25hbAoJLy8gYW1vdW50IG9mIHRva2VucyBzbyB0aGV5IG1heSB3aXRoZHJhdyB0aGVpciB0b2tlbnMgbGF0ZXIKCS8vIGFsc28gaWYgdGhlcmUgaXMgb25seSBhIGxpbWl0ZWQgYW1vdW50IG9mIHNwYWNlIGxlZnQgaW4gdGhlIGJhbmtyb2xsLCBhIHVzZXIgY2FuIGp1c3Qgc2VuZCBhcyBtdWNoIAoJLy8gZXRoZXIgYXMgdGhleSB3YW50LCBiZWNhdXNlIHRoZXkgd2lsbCBiZSBhYmxlIHRvIGNvbnRyaWJ1dGUgdXAgdG8gdGhlIG1heGltdW0sIGFuZCB0aGVuIGdldCByZWZ1bmRlZCB0aGUgcmVzdC4KCWZ1bmN0aW9uICgpIHB1YmxpYyBwYXlhYmxlIHsKCgkJLy8gc2F2ZSBpbiBtZW1vcnkgZm9yIGNoZWFwIGFjY2Vzcy4KCQkvLyB0aGlzIHJlcHJlc2VudHMgdGhlIHRvdGFsIGJhbmtyb2xsIGJhbGFuY2UgYmVmb3JlIHRoZSBmdW5jdGlvbiB3YXMgY2FsbGVkLgoJCXVpbnQyNTYgY3VycmVudFRvdGFsQmFua3JvbGwgPSBTYWZlTWF0aC5zdWIoZ2V0QmFua3JvbGwoKSwgbXNnLnZhbHVlKTsKCQl1aW50MjU2IG1heEludmVzdG1lbnRzQWxsb3dlZCA9IE1BWElNVU1JTlZFU1RNRU5UU0FMTE9XRUQ7CgoJCXJlcXVpcmUoY3VycmVudFRvdGFsQmFua3JvbGwgPCBtYXhJbnZlc3RtZW50c0FsbG93ZWQgJiYgbXNnLnZhbHVlICE9IDApOwoKCQl1aW50MjU2IGN1cnJlbnRTdXBwbHlPZlRva2VucyA9IHRvdGFsU3VwcGx5OwoJCXVpbnQyNTYgY29udHJpYnV0ZWRFdGhlcjsKCgkJYm9vbCBjb250cmlidXRpb25UYWtlc0Jhbmtyb2xsT3ZlckxpbWl0OwoJCXVpbnQyNTYgaWZDb250cmlidXRpb25UYWtlc0Jhbmtyb2xsT3ZlckxpbWl0X1JlZnVuZDsKCgkJdWludDI1NiBjcmVkaXRlZFRva2VuczsKCgkJaWYgKFNhZmVNYXRoLmFkZChjdXJyZW50VG90YWxCYW5rcm9sbCwgbXNnLnZhbHVlKSA+IG1heEludmVzdG1lbnRzQWxsb3dlZCl7CgkJCS8vIGFsbG93IHRoZSBiYW5rcm9sbGVyIHRvIGNvbnRyaWJ1dGUgdXAgdG8gdGhlIGFsbG93ZWQgYW1vdW50IG9mIGV0aGVyLCBhbmQgcmVmdW5kIHRoZSByZXN0LgoJCQljb250cmlidXRpb25UYWtlc0Jhbmtyb2xsT3ZlckxpbWl0ID0gdHJ1ZTsKCQkJLy8gc2V0IGNvbnRyaWJ1dGVkIGV0aGVyIGFzIChNQVhJTVVNSU5WRVNUTUVOVFNBTExPV0VEIC0gQkFOS1JPTEwpCgkJCWNvbnRyaWJ1dGVkRXRoZXIgPSBTYWZlTWF0aC5zdWIobWF4SW52ZXN0bWVudHNBbGxvd2VkLCBjdXJyZW50VG90YWxCYW5rcm9sbCk7CgkJCS8vIHJlZnVuZCB0aGUgcmVzdCBvZiB0aGUgZXRoZXIsIHdoaWNoIGlzIChvcmlnaW5hbCBhbW91bnQgc2VudCAtIChtYXhpbXVtIGFtb3VudCBhbGxvd2VkIC0gYmFua3JvbGwpKQoJCQlpZkNvbnRyaWJ1dGlvblRha2VzQmFua3JvbGxPdmVyTGltaXRfUmVmdW5kID0gU2FmZU1hdGguc3ViKG1zZy52YWx1ZSwgY29udHJpYnV0ZWRFdGhlcik7CgkJfQoJCWVsc2UgewoJCQljb250cmlidXRlZEV0aGVyID0gbXNnLnZhbHVlOwoJCX0KICAgICAgICAKCQlpZiAoY3VycmVudFN1cHBseU9mVG9rZW5zICE9IDApewoJCQkvLyBkZXRlcm1pbmUgdGhlIHJhdGlvIG9mIGNvbnRyaWJ1dGlvbiB2ZXJzdXMgdG90YWwgQkFOS1JPTEwuCgkJCWNyZWRpdGVkVG9rZW5zID0gU2FmZU1hdGgubXVsKGNvbnRyaWJ1dGVkRXRoZXIsIGN1cnJlbnRTdXBwbHlPZlRva2VucykgLyBjdXJyZW50VG90YWxCYW5rcm9sbDsKCQl9CgkJZWxzZSB7CgkJCS8vIGVkZ2UgY2FzZSB3aGVyZSBBTEwgbW9uZXkgd2FzIGNhc2hlZCBvdXQgZnJvbSBiYW5rcm9sbAoJCQkvLyBzbyBjdXJyZW50U3VwcGx5T2ZUb2tlbnMgPT0gMAoJCQkvLyBjdXJyZW50VG90YWxCYW5rcm9sbCBjYW4gPT0gMCBvciBub3QsIGlmIHNvbWVvbmUgbWluZXMvc2VsZmRlc3RydWN0J3MgdG8gdGhlIGNvbnRyYWN0CgkJCS8vIGJ1dCBlaXRoZXIgd2F5LCBnaXZlIGFsbCB0aGUgYmFua3JvbGwgdG8gcGVyc29uIHdobyBkZXBvc2l0cyBldGhlcgoJCQljcmVkaXRlZFRva2VucyA9IFNhZmVNYXRoLm11bChjb250cmlidXRlZEV0aGVyLCAxMDApOwoJCX0KCQkKCQkvLyBub3cgdXBkYXRlIHRoZSB0b3RhbCBzdXBwbHkgb2YgdG9rZW5zIGFuZCBiYW5rcm9sbCBhbW91bnQKCQl0b3RhbFN1cHBseSA9IFNhZmVNYXRoLmFkZChjdXJyZW50U3VwcGx5T2ZUb2tlbnMsIGNyZWRpdGVkVG9rZW5zKTsKCgkJLy8gbm93IGNyZWRpdCB0aGUgdXNlciB3aXRoIGhpcyBhbW91bnQgb2YgY29udHJpYnV0ZWQgdG9rZW5zIAoJCWJhbGFuY2VzW21zZy5zZW5kZXJdID0gU2FmZU1hdGguYWRkKGJhbGFuY2VzW21zZy5zZW5kZXJdLCBjcmVkaXRlZFRva2Vucyk7CgoJCS8vIHVwZGF0ZSBoaXMgY29udHJpYnV0aW9uIHRpbWUgZm9yIHN0YWtlIHRpbWUgbG9ja2luZwoJCWNvbnRyaWJ1dGlvblRpbWVbbXNnLnNlbmRlcl0gPSBibG9jay50aW1lc3RhbXA7CgoJCS8vIG5vdyBsb29rIGlmIHRoZSBhdHRlbXB0ZWQgY29udHJpYnV0aW9uIHdvdWxkIGhhdmUgdGFrZW4gdGhlIEJBTktST0xMIG92ZXIgdGhlIGxpbWl0LCAKCQkvLyBhbmQgaWYgdHJ1ZSwgcmVmdW5kIHRoZSBleGNlc3MgZXRoZXIuCgkJaWYgKGNvbnRyaWJ1dGlvblRha2VzQmFua3JvbGxPdmVyTGltaXQpewoJCQltc2cuc2VuZGVyLnRyYW5zZmVyKGlmQ29udHJpYnV0aW9uVGFrZXNCYW5rcm9sbE92ZXJMaW1pdF9SZWZ1bmQpOwoJCX0KCgkJLy8gbG9nIGFuIGV2ZW50IGFib3V0IGZ1bmRpbmcgYmFua3JvbGwKCQllbWl0IEZ1bmRCYW5rcm9sbChtc2cuc2VuZGVyLCBjb250cmlidXRlZEV0aGVyLCBjcmVkaXRlZFRva2Vucyk7CgoJCS8vIGxvZyBhIG1pbnQgdG9rZW5zIGV2ZW50CgkJZW1pdCBUcmFuc2ZlcigweDAsIG1zZy5zZW5kZXIsIGNyZWRpdGVkVG9rZW5zKTsKCX0KCglmdW5jdGlvbiBjYXNob3V0RU9TQmV0U3Rha2VUb2tlbnModWludDI1NiBfYW1vdW50VG9rZW5zKSBwdWJsaWMgewoJCS8vIEluIGVmZmVjdCwgdGhpcyBmdW5jdGlvbiBpcyB0aGUgT1BQT1NJVEUgb2YgdGhlIHVuLW5hbWVkIHBheWFibGUgZnVuY3Rpb24gYWJvdmVeXl4KCQkvLyB0aGlzIGFsbG93cyBiYW5rcm9sbGVycyB0byAiY2FzaCBvdXQiIGF0IGFueSB0aW1lLCBhbmQgcmVjZWl2ZSB0aGUgZXRoZXIgdGhhdCB0aGV5IGNvbnRyaWJ1dGVkLCBQTFVTCgkJLy8gYSBwcm9wb3J0aW9uIG9mIGFueSBldGhlciB0aGF0IHdhcyBlYXJuZWQgYnkgdGhlIHNtYXJ0IGNvbnRhY3Qgd2hlbiB0aGVpciBldGhlciB3YXMgInN0YWtpbmciLCBIb3dldmVyCgkJLy8gdGhpcyB3b3JrcyBpbiByZXZlcnNlIGFzIHdlbGwuIEFueSBuZXQgbG9zc2VzIG9mIHRoZSBzbWFydCBjb250cmFjdCB3aWxsIGJlIGFic29yYmVkIGJ5IHRoZSBwbGF5ZXIgaW4gbGlrZSBtYW5uZXIuCgkJLy8gT2YgY291cnNlLCBkdWUgdG8gdGhlIGNvbnN0YW50IGhvdXNlIGVkZ2UsIGEgYmFua3JvbGxlciB0aGF0IGxlYXZlcyB0aGVpciBldGhlciBpbiB0aGUgY29udHJhY3QgbG9uZyBlbm91Z2gKCQkvLyBpcyBlZmZlY3RpdmVseSBndWFyYW50ZWVkIHRvIHdpdGhkcmF3IG1vcmUgZXRoZXIgdGhhbiB0aGV5IG9yaWdpbmFsbHkgInN0YWtlZCIKCgkJLy8gc2F2ZSBpbiBtZW1vcnkgZm9yIGNoZWFwIGFjY2Vzcy4KCQl1aW50MjU2IHRva2VuQmFsYW5jZSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdOwoJCS8vIHZlcmlmeSB0aGF0IHRoZSBjb250cmlidXRvciBoYXMgZW5vdWdoIHRva2VucyB0byBjYXNoIG91dCB0aGlzIG1hbnksIGFuZCBoYXMgd2FpdGVkIHRoZSByZXF1aXJlZCB0aW1lLgoJCXJlcXVpcmUoX2Ftb3VudFRva2VucyA8PSB0b2tlbkJhbGFuY2UgCgkJCSYmIGNvbnRyaWJ1dGlvblRpbWVbbXNnLnNlbmRlcl0gKyBXQUlUVElNRVVOVElMV0lUSERSQVdPUlRSQU5TRkVSIDw9IGJsb2NrLnRpbWVzdGFtcAoJCQkmJiBfYW1vdW50VG9rZW5zID4gMCk7CgoJCS8vIHNhdmUgaW4gbWVtb3J5IGZvciBjaGVhcCBhY2Nlc3MuCgkJLy8gYWdhaW4sIHJlcHJlc2VudHMgdGhlIHRvdGFsIGJhbGFuY2Ugb2YgdGhlIGNvbnRyYWN0IGJlZm9yZSB0aGUgZnVuY3Rpb24gd2FzIGNhbGxlZC4KCQl1aW50MjU2IGN1cnJlbnRUb3RhbEJhbmtyb2xsID0gZ2V0QmFua3JvbGwoKTsKCQl1aW50MjU2IGN1cnJlbnRTdXBwbHlPZlRva2VucyA9IHRvdGFsU3VwcGx5OwoKCQkvLyBjYWxjdWxhdGUgdGhlIHRva2VuIHdpdGhkcmF3IHJhdGlvIGJhc2VkIG9uIGN1cnJlbnQgc3VwcGx5IAoJCXVpbnQyNTYgd2l0aGRyYXdFdGhlciA9IFNhZmVNYXRoLm11bChfYW1vdW50VG9rZW5zLCBjdXJyZW50VG90YWxCYW5rcm9sbCkgLyBjdXJyZW50U3VwcGx5T2ZUb2tlbnM7CgoJCS8vIGRldmVsb3BlcnMgdGFrZSAxJSBvZiB3aXRoZHJhd2xzIAoJCXVpbnQyNTYgZGV2ZWxvcGVyc0N1dCA9IHdpdGhkcmF3RXRoZXIgLyAxMDA7CgkJdWludDI1NiBjb250cmlidXRvckFtb3VudCA9IFNhZmVNYXRoLnN1Yih3aXRoZHJhd0V0aGVyLCBkZXZlbG9wZXJzQ3V0KTsKCgkJLy8gbm93IHVwZGF0ZSB0aGUgdG90YWwgc3VwcGx5IG9mIHRva2VucyBieSBzdWJ0cmFjdGluZyB0aGUgdG9rZW5zIHRoYXQgYXJlIGJlaW5nICJjYXNoZWQgaW4iCgkJdG90YWxTdXBwbHkgPSBTYWZlTWF0aC5zdWIoY3VycmVudFN1cHBseU9mVG9rZW5zLCBfYW1vdW50VG9rZW5zKTsKCgkJLy8gYW5kIHVwZGF0ZSB0aGUgdXNlcnMgc3VwcGx5IG9mIHRva2VucyAKCQliYWxhbmNlc1ttc2cuc2VuZGVyXSA9IFNhZmVNYXRoLnN1Yih0b2tlbkJhbGFuY2UsIF9hbW91bnRUb2tlbnMpOwoKCQkvLyB1cGRhdGUgdGhlIGRldmVsb3BlcnMgZnVuZCBiYXNlZCBvbiB0aGlzIGNhbGN1bGF0ZWQgYW1vdW50IAoJCURFVkVMT1BFUlNGVU5EID0gU2FmZU1hdGguYWRkKERFVkVMT1BFUlNGVU5ELCBkZXZlbG9wZXJzQ3V0KTsKCgkJLy8gbGFzdGx5LCB0cmFuc2ZlciB0aGUgZXRoZXIgYmFjayB0byB0aGUgYmFua3JvbGxlci4gVGhhbmtzIGZvciB5b3VyIGNvbnRyaWJ1dGlvbiEKCQltc2cuc2VuZGVyLnRyYW5zZmVyKGNvbnRyaWJ1dG9yQW1vdW50KTsKCgkJLy8gbG9nIGFuIGV2ZW50IGFib3V0IGNhc2hvdXQKCQllbWl0IENhc2hPdXQobXNnLnNlbmRlciwgY29udHJpYnV0b3JBbW91bnQsIF9hbW91bnRUb2tlbnMpOwoKCQkvLyBsb2cgYSBkZXN0cm95IHRva2VucyBldmVudAoJCWVtaXQgVHJhbnNmZXIobXNnLnNlbmRlciwgMHgwLCBfYW1vdW50VG9rZW5zKTsKCX0KCgkvLyBUTyBDQUxMIFRISVMgRlVOQ1RJT04gRUFTSUxZLCBTRU5EIEEgMCBFVEhFUiBUUkFOU0FDVElPTiBUTyBUSElTIENPTlRSQUNUIFdJVEggRVhUUkEgREFUQTogMHg3YTA5NTg4YgoJZnVuY3Rpb24gY2FzaG91dEVPU0JldFN0YWtlVG9rZW5zX0FMTCgpIHB1YmxpYyB7CgoJCS8vIGp1c3QgZm9yd2FyZCB0byBjYXNob3V0RU9TQmV0U3Rha2VUb2tlbnMgd2l0aCBpbnB1dCBhcyB0aGUgc2VuZGVycyBlbnRpcmUgYmFsYW5jZQoJCWNhc2hvdXRFT1NCZXRTdGFrZVRva2VucyhiYWxhbmNlc1ttc2cuc2VuZGVyXSk7Cgl9CgoJLy8vLy8vLy8vLy8vLy8vLy8vLy8KCS8vIE9XTkVSIEZVTkNUSU9OUzoKCS8vLy8vLy8vLy8vLy8vLy8vLy8vCgkvLyBQbGVhc2UsIGJlIGF3YXJlIHRoYXQgdGhlIG93bmVyIE9OTFkgY2FuIGNoYW5nZToKCQkvLyAxLiBUaGUgb3duZXIgY2FuIGluY3JlYXNlIG9yIGRlY3JlYXNlIHRoZSB0YXJnZXQgYW1vdW50IGZvciBhIGdhbWUuIFRoZXkgY2FuIHRoZW4gY2FsbCB0aGUgdXBkYXRlciBmdW5jdGlvbiB0byBnaXZlL3JlY2VpdmUgdGhlIGV0aGVyIGZyb20gdGhlIGdhbWUuCgkJLy8gMS4gVGhlIHdhaXQgdGltZSB1bnRpbCBhIHVzZXIgY2FuIHdpdGhkcmF3IG9yIHRyYW5zZmVyIHRoZWlyIHRva2VucyBhZnRlciBwdXJjaGFzZSB0aHJvdWdoIHRoZSBkZWZhdWx0IGZ1bmN0aW9uIGFib3ZlIF5eXgoJCS8vIDIuIFRoZSBvd25lciBjYW4gY2hhbmdlIHRoZSBtYXhpbXVtIGFtb3VudCBvZiBpbnZlc3RtZW50cyBhbGxvd2VkLiBUaGlzIGFsbG93cyBmb3IgZWFybHkgY29udHJpYnV0b3JzIHRvIGd1YXJhbnRlZQoJCS8vIAkJYSBjZXJ0YWluIHBlcmNlbnRhZ2Ugb2YgdGhlIGJhbmtyb2xsIHNvIHRoYXQgdGhlaXIgc3Rha2UgY2Fubm90IGJlIGRpbHV0ZWQgaW1tZWRpYXRlbHkuIEhvd2V2ZXIsIGJlIGF3YXJlIHRoYXQgdGhlIAoJCS8vCQltYXhpbXVtIGFtb3VudCBvZiBpbnZlc3RtZW50cyBhbGxvd2VkIHdpbGwgYmUgcmFpc2VkIG92ZXIgdGltZS4gVGhpcyB3aWxsIGFsbG93IGZvciBoaWdoZXIgYmV0cyBieSBnYW1ibGVycywgcmVzdWx0aW5nCgkJLy8gCQlpbiBoaWdoZXIgZGl2aWRlbmRzIGZvciB0aGUgYmFua3JvbGxlcnMKCQkvLyAzLiBUaGUgb3duZXIgY2FuIGZyZWV6ZSBwYXlvdXRzIHRvIGJldHRvcnMuIFRoaXMgd2lsbCBiZSB1c2VkIGluIGNhc2Ugb2YgYW4gZW1lcmdlbmN5LCBhbmQgdGhlIGNvbnRyYWN0IHdpbGwgcmVqZWN0IGFsbAoJCS8vCQluZXcgYmV0cyBhcyB3ZWxsLiBUaGlzIGRvZXMgbm90IG1lYW4gdGhhdCBiZXR0b3JzIHdpbGwgbG9zZSB0aGVpciBtb25leSB3aXRob3V0IHJlY29tcGVuc2UuIFRoZXkgd2lsbCBiZSBhbGxvd2VkIHRvIGNhbGwgdGhlIAoJCS8vIAkJInJlZnVuZCIgZnVuY3Rpb24gaW4gdGhlIHJlc3BlY3RpdmUgZ2FtZSBzbWFydCBjb250cmFjdCBvbmNlIHBheW91dHMgYXJlIHVuLWZyb3plbi4KCQkvLyA0LiBGaW5hbGx5LCB0aGUgb3duZXIgY2FuIG1vZGlmeSBhbmQgd2l0aGRyYXcgdGhlIGRldmVsb3BlcnMgcmV3YXJkLCB3aGljaCB3aWxsIGZ1bmQgZnV0dXJlIGRldmVsb3BtZW50LCBpbmNsdWRpbmcgbmV3IGdhbWVzLCBhIHNleGllciBmcm9udGVuZCwKCQkvLyAJCWFuZCBUUlVFIERBTyBnb3Zlcm5hbmNlIHNvIHRoYXQgb25seU93bmVyIGZ1bmN0aW9ucyBkb24ndCBoYXZlIHRvIGV4aXN0IGFueW1vcmUgOykgYW5kIGluIG9yZGVyIHRvIGVmZmVjdGl2ZWx5IHJlYWN0IHRvIGNoYW5nZXMgCgkJLy8gCQlpbiB0aGUgbWFya2V0IChsb3dlciB0aGUgcGVyY2VudGFnZSBiZWNhdXNlIG9mIGluY3JlYXNlZCBjb21wZXRpdGlvbiBpbiB0aGUgYmxvY2tjaGFpbiBjYXNpbm8gc3BhY2UsIGV0Yy4pCgoJZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIHsKCQlyZXF1aXJlKG1zZy5zZW5kZXIgPT0gT1dORVIpOwoKCQlPV05FUiA9IG5ld093bmVyOwoJfQoKCWZ1bmN0aW9uIGNoYW5nZVdhaXRUaW1lVW50aWxXaXRoZHJhd09yVHJhbnNmZXIodWludDI1NiB3YWl0VGltZSkgcHVibGljIHsKCQkvLyB3YWl0VGltZSBNVVNUIGJlIGxlc3MgdGhhbiBvciBlcXVhbCB0byAxMCB3ZWVrcwoJCXJlcXVpcmUgKG1zZy5zZW5kZXIgPT0gT1dORVIgJiYgd2FpdFRpbWUgPD0gNjA0ODAwMCk7CgoJCVdBSVRUSU1FVU5USUxXSVRIRFJBV09SVFJBTlNGRVIgPSB3YWl0VGltZTsKCX0KCglmdW5jdGlvbiBjaGFuZ2VNYXhpbXVtSW52ZXN0bWVudHNBbGxvd2VkKHVpbnQyNTYgbWF4QW1vdW50KSBwdWJsaWMgewoJCXJlcXVpcmUobXNnLnNlbmRlciA9PSBPV05FUik7CgoJCU1BWElNVU1JTlZFU1RNRU5UU0FMTE9XRUQgPSBtYXhBbW91bnQ7Cgl9CgoKCWZ1bmN0aW9uIHdpdGhkcmF3RGV2ZWxvcGVyc0Z1bmQoYWRkcmVzcyByZWNlaXZlcikgcHVibGljIHsKCQlyZXF1aXJlKG1zZy5zZW5kZXIgPT0gT1dORVIpOwoKCQkvLyBmaXJzdCBnZXQgZGV2ZWxvcGVycyBmdW5kIGZyb20gZWFjaCBnYW1lIAogICAgICAgIEVPU0JldEdhbWVJbnRlcmZhY2UoRElDRSkucGF5RGV2ZWxvcGVyc0Z1bmQocmVjZWl2ZXIpOwoJCUVPU0JldEdhbWVJbnRlcmZhY2UoU0xPVFMpLnBheURldmVsb3BlcnNGdW5kKHJlY2VpdmVyKTsKCgkJLy8gbm93IHNlbmQgdGhlIGRldmVsb3BlcnMgZnVuZCBmcm9tIHRoZSBtYWluIGNvbnRyYWN0LgoJCXVpbnQyNTYgZGV2ZWxvcGVyc0Z1bmQgPSBERVZFTE9QRVJTRlVORDsKCgkJLy8gc2V0IGRldmVsb3BlcnMgZnVuZCB0byB6ZXJvCgkJREVWRUxPUEVSU0ZVTkQgPSAwOwoKCQkvLyB0cmFuc2ZlciB0aGlzIGFtb3VudCB0byB0aGUgb3duZXIhCgkJcmVjZWl2ZXIudHJhbnNmZXIoZGV2ZWxvcGVyc0Z1bmQpOwoJfQoKCS8vIENhbiBiZSByZW1vdmVkIGFmdGVyIHNvbWUgdGVzdGluZy4uLgoJZnVuY3Rpb24gZW1lcmdlbmN5U2VsZkRlc3RydWN0KCkgcHVibGljIHsKCQlyZXF1aXJlKG1zZy5zZW5kZXIgPT0gT1dORVIpOwoKCQlzZWxmZGVzdHJ1Y3QobXNnLnNlbmRlcik7Cgl9CgoJLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoJLy8gQkFTSUMgRVJDMjAgVE9LRU4gT1BFUkFUSU9OUwoJLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKCWZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcHVibGljIHJldHVybnModWludCl7CgkJcmV0dXJuIHRvdGFsU3VwcGx5OwoJfQoKCWZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcHVibGljIHJldHVybnModWludCl7CgkJcmV0dXJuIGJhbGFuY2VzW19vd25lcl07Cgl9CgoJLy8gZG9uJ3QgYWxsb3cgdHJhbnNmZXJzIGJlZm9yZSB0aGUgcmVxdWlyZWQgd2FpdC10aW1lCgkvLyBhbmQgZG9uJ3QgYWxsb3cgdHJhbnNmZXJzIHRvIHRoaXMgY29udHJhY3QgYWRkciwgaXQnbGwganVzdCBraWxsIHRva2VucwoJZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKXsKCQlpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlIAoJCQkmJiBfdmFsdWUgPiAwIAoJCQkmJiBjb250cmlidXRpb25UaW1lW21zZy5zZW5kZXJdICsgV0FJVFRJTUVVTlRJTFdJVEhEUkFXT1JUUkFOU0ZFUiA8PSBibG9jay50aW1lc3RhbXAKCQkJJiYgX3RvICE9IGFkZHJlc3ModGhpcykpewoKCQkJLy8gc2FmZWx5IHN1YnRyYWN0CgkJCWJhbGFuY2VzW21zZy5zZW5kZXJdID0gU2FmZU1hdGguc3ViKGJhbGFuY2VzW21zZy5zZW5kZXJdLCBfdmFsdWUpOwoJCQliYWxhbmNlc1tfdG9dID0gU2FmZU1hdGguYWRkKGJhbGFuY2VzW190b10sIF92YWx1ZSk7CgoJCQkvLyBsb2cgZXZlbnQgCgkJCWVtaXQgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwoJCQlyZXR1cm4gdHJ1ZTsKCQl9CgkJZWxzZSB7CgkJCXJldHVybiBmYWxzZTsKCQl9Cgl9CgoJLy8gZG9uJ3QgYWxsb3cgdHJhbnNmZXJzIGJlZm9yZSB0aGUgcmVxdWlyZWQgd2FpdC10aW1lCgkvLyBhbmQgZG9uJ3QgYWxsb3cgdHJhbnNmZXJzIHRvIHRoZSBjb250cmFjdCBhZGRyLCBpdCdsbCBqdXN0IGtpbGwgdG9rZW5zCglmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sKXsKCQlpZiAoYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPj0gX3ZhbHVlIAoJCQkmJiBiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlIAoJCQkmJiBfdmFsdWUgPiAwIAoJCQkmJiBjb250cmlidXRpb25UaW1lW19mcm9tXSArIFdBSVRUSU1FVU5USUxXSVRIRFJBV09SVFJBTlNGRVIgPD0gYmxvY2sudGltZXN0YW1wCgkJCSYmIF90byAhPSBhZGRyZXNzKHRoaXMpKXsKCgkJCS8vIHNhZmVseSBhZGQgdG8gX3RvIGFuZCBzdWJ0cmFjdCBmcm9tIF9mcm9tLCBhbmQgc3VidHJhY3QgZnJvbSBhbGxvd2VkIGJhbGFuY2VzLgoJCQliYWxhbmNlc1tfdG9dID0gU2FmZU1hdGguYWRkKGJhbGFuY2VzW190b10sIF92YWx1ZSk7CgkgICAJCWJhbGFuY2VzW19mcm9tXSA9IFNhZmVNYXRoLnN1YihiYWxhbmNlc1tfZnJvbV0sIF92YWx1ZSk7CgkgIAkJYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBTYWZlTWF0aC5zdWIoYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0sIF92YWx1ZSk7CgoJICAJCS8vIGxvZyBldmVudAogICAgCQllbWl0IFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAJCXJldHVybiB0cnVlOwogICAJCX0gCiAgICAJZWxzZSB7IAogICAgCQlyZXR1cm4gZmFsc2U7CiAgICAJfQoJfQoJCglmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sKXsKCQlpZihfdmFsdWUgPiAwKXsKCgkJCWFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwoJCQllbWl0IEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwoJCQkvLyBsb2cgZXZlbnQKCQkJcmV0dXJuIHRydWU7CgkJfQoJCWVsc2UgewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJfQoJCglmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zKHVpbnQpewoJCXJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwoJfQp9CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnRyYWN0cyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93IChpLmUuIGlmIHN1YnRyYWhlbmQgaXMgZ3JlYXRlciB0aGFuIG1pbnVlbmQpLgogICovCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgLyoqCiAgKiBAZGV2IEFkZHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9Cgpjb250cmFjdCBFT1NCZXRTbG90cyBpcyB1c2luZ09yYWNsaXplLCBFT1NCZXRHYW1lSW50ZXJmYWNlIHsKCgl1c2luZyBTYWZlTWF0aCBmb3IgKjsKCgkvLyBldmVudHMKCWV2ZW50IEJ1eUNyZWRpdHMoYnl0ZXMzMiBpbmRleGVkIG9yYWNsaXplUXVlcnlJZCk7CglldmVudCBMZWRnZXJQcm9vZkZhaWxlZChieXRlczMyIGluZGV4ZWQgb3JhY2xpemVRdWVyeUlkKTsKCWV2ZW50IFJlZnVuZChieXRlczMyIGluZGV4ZWQgb3JhY2xpemVRdWVyeUlkLCB1aW50MjU2IGFtb3VudCk7CglldmVudCBTbG90c0xhcmdlQmV0KGJ5dGVzMzIgaW5kZXhlZCBvcmFjbGl6ZVF1ZXJ5SWQsIHVpbnQyNTYgZGF0YTEsIHVpbnQyNTYgZGF0YTIsIHVpbnQyNTYgZGF0YTMsIHVpbnQyNTYgZGF0YTQsIHVpbnQyNTYgZGF0YTUsIHVpbnQyNTYgZGF0YTYsIHVpbnQyNTYgZGF0YTcsIHVpbnQyNTYgZGF0YTgpOwoJZXZlbnQgU2xvdHNTbWFsbEJldCh1aW50MjU2IGRhdGExLCB1aW50MjU2IGRhdGEyLCB1aW50MjU2IGRhdGEzLCB1aW50MjU2IGRhdGE0LCB1aW50MjU2IGRhdGE1LCB1aW50MjU2IGRhdGE2LCB1aW50MjU2IGRhdGE3LCB1aW50MjU2IGRhdGE4KTsKCgkvLyBzbG90cyBnYW1lIHN0cnVjdHVyZQoJc3RydWN0IFNsb3RzR2FtZURhdGEgewoJCWFkZHJlc3MgcGxheWVyOwoJCWJvb2wgcGFpZE91dDsKCQl1aW50MjU2IHN0YXJ0OwoJCXVpbnQyNTYgZXRoZXJSZWNlaXZlZDsKCQl1aW50OCBjcmVkaXRzOwoJfQoKCW1hcHBpbmcgKGJ5dGVzMzIgPT4gU2xvdHNHYW1lRGF0YSkgcHVibGljIHNsb3RzRGF0YTsKCgkvLyBldGhlciBpbiB0aGlzIGNvbnRyYWN0IGNhbiBiZSBpbiBvbmUgb2YgdHdvIGxvY2F0aW9uczoKCXVpbnQyNTYgcHVibGljIExJQUJJTElUSUVTOwoJdWludDI1NiBwdWJsaWMgREVWRUxPUEVSU0ZVTkQ7CgoJLy8gY291bnRlcnMgZm9yIGZyb250ZW5kIHN0YXRpc3RpY3MKCXVpbnQyNTYgcHVibGljIEFNT1VOVFdBR0VSRUQ7Cgl1aW50MjU2IHB1YmxpYyBESUFMU1NQVU47CgkKCS8vIHRvZ2dsYWJsZSB2YWx1ZXMKCXVpbnQyNTYgcHVibGljIE9SQUNMSVpFUVVFUllNQVhUSU1FOwoJdWludDI1NiBwdWJsaWMgTUlOQkVUX2Zvck9SQUNMSVpFOwoJdWludDI1NiBwdWJsaWMgTUlOQkVUOwoJdWludDI1NiBwdWJsaWMgT1JBQ0xJWkVHQVNQUklDRTsKCXVpbnQyNTYgcHVibGljIElOSVRJQUxHQVNGT1JPUkFDTElaRTsKCXVpbnQxNiBwdWJsaWMgTUFYV0lOX2luVEhPVVNBTkRUSFBFUkNFTlRTOwoKCS8vIHRvZ2dsYWJsZSBmdW5jdGlvbmFsaXR5IG9mIGNvbnRyYWN0Cglib29sIHB1YmxpYyBHQU1FUEFVU0VEOwoJYm9vbCBwdWJsaWMgUkVGVU5EU0FDVElWRTsKCgkvLyBvd25lciBvZiBjb250cmFjdAoJYWRkcmVzcyBwdWJsaWMgT1dORVI7CgoJLy8gYmFua3JvbGxlciBhZGRyZXNzCglhZGRyZXNzIHB1YmxpYyBCQU5LUk9MTEVSOwoKCS8vIGNvbnN0cnVjdG9yCglmdW5jdGlvbiBFT1NCZXRTbG90cygpIHB1YmxpYyB7CgkJLy8gbGVkZ2VyIHByb29mIGlzIEFMV0FZUyB2ZXJpZmllZCBvbi1jaGFpbgoJCW9yYWNsaXplX3NldFByb29mKHByb29mVHlwZV9MZWRnZXIpOwoKCQkvLyBnYXMgcHJpY2VzIGZvciBvcmFjbGl6ZSBjYWxsIGJhY2ssIGNhbiBiZSBjaGFuZ2VkCgkJb3JhY2xpemVfc2V0Q3VzdG9tR2FzUHJpY2UoMTAwMDAwMDAwMDApOwoJCU9SQUNMSVpFR0FTUFJJQ0UgPSAxMDAwMDAwMDAwMDsKCQlJTklUSUFMR0FTRk9ST1JBQ0xJWkUgPSAyMjUwMDA7CgoJCUFNT1VOVFdBR0VSRUQgPSAwOwoJCURJQUxTU1BVTiA9IDA7CgoJCUdBTUVQQVVTRUQgPSBmYWxzZTsKCQlSRUZVTkRTQUNUSVZFID0gdHJ1ZTsKCgkJT1JBQ0xJWkVRVUVSWU1BWFRJTUUgPSA2IGhvdXJzOwoJCU1JTkJFVF9mb3JPUkFDTElaRSA9IDM1MCBmaW5uZXk7IC8vIDAuMzUgZXRoZXIgaXMgdGhlIG1heCBiZXQgdG8gYXZvaWQgbWluZXIgY2hlYXRpbmcuIHNlZSBweXRob24gc2ltLiBvbiBvdXIgZ2l0aHViCgkJTUlOQkVUID0gMSBmaW5uZXk7IC8vIGN1cnJlbnRseSwgdGhpcyBpcyB+NDAtNTBjIGEgc3Bpbiwgd2hpY2ggaXMgcHJldHR5IGF2ZXJhZ2Ugc2xvdHMuIFRoaXMgaXMgY2hhbmdlYWJsZSBieSBPV05FUiAKICAgICAgICBNQVhXSU5faW5USE9VU0FORFRIUEVSQ0VOVFMgPSAzMDA7IC8vIDMwMC8xMDAwIHNvIGEgamFja3BvdCBjYW4gdGFrZSAzMCUgb2YgYmFua3JvbGwgKGV4dHJlbWVseSByYXJlKQogICAgICAgIE9XTkVSID0gbXNnLnNlbmRlcjsKCX0KCgkvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCS8vIElOVEVSRkFDRSBDT05UQUNUIEZVTkNUSU9OUwoJLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgoJZnVuY3Rpb24gcGF5RGV2ZWxvcGVyc0Z1bmQoYWRkcmVzcyBkZXZlbG9wZXIpIHB1YmxpYyB7CgkJcmVxdWlyZShtc2cuc2VuZGVyID09IEJBTktST0xMRVIpOwoKCQl1aW50MjU2IGRldkZ1bmQgPSBERVZFTE9QRVJTRlVORDsKCgkJREVWRUxPUEVSU0ZVTkQgPSAwOwoKCQlkZXZlbG9wZXIudHJhbnNmZXIoZGV2RnVuZCk7Cgl9CgoJLy8ganVzdCBhIGZ1bmN0aW9uIHRvIHJlY2VpdmUgZXRoLCBvbmx5IGFsbG93IHRoZSBiYW5rcm9sbCB0byB1c2UgdGhpcwoJZnVuY3Rpb24gcmVjZWl2ZVBheW1lbnRGb3JPcmFjbGl6ZSgpIHBheWFibGUgcHVibGljIHsKCQlyZXF1aXJlKG1zZy5zZW5kZXIgPT0gQkFOS1JPTExFUik7Cgl9CgoJLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgkvLyBWSUVXIEZVTkNUSU9OUwoJLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgoJZnVuY3Rpb24gZ2V0TWF4V2luKCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50MjU2KXsKCQlyZXR1cm4gKFNhZmVNYXRoLm11bChFT1NCZXRCYW5rcm9sbEludGVyZmFjZShCQU5LUk9MTEVSKS5nZXRCYW5rcm9sbCgpLCBNQVhXSU5faW5USE9VU0FORFRIUEVSQ0VOVFMpIC8gMTAwMCk7Cgl9CgoJLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgkvLyBPV05FUiBPTkxZIEZVTkNUSU9OUwoJLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgoJLy8gV0FSTklORyEhISEhIENhbiBvbmx5IHNldCB0aGlzIGZ1bmN0aW9uIG9uY2UhCglmdW5jdGlvbiBzZXRCYW5rcm9sbGVyQ29udHJhY3RPbmNlKGFkZHJlc3MgYmFua3JvbGxBZGRyZXNzKSBwdWJsaWMgewoJCS8vIHJlcXVpcmUgdGhhdCBCQU5LUk9MTEVSIGFkZHJlc3MgPT0gMHgwIChhZGRyZXNzIG5vdCBzZXQgeWV0KSwgYW5kIGNvbWluZyBmcm9tIG93bmVyLgoJCXJlcXVpcmUobXNnLnNlbmRlciA9PSBPV05FUiAmJiBCQU5LUk9MTEVSID09IGFkZHJlc3MoMCkpOwoKCQkvLyBjaGVjayBoZXJlIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSBiYW5rcm9sbCBjb250cmFjdCBpcyBsZWdpdGltYXRlCgkJLy8ganVzdCBtYWtlIHN1cmUgdGhhdCBjYWxsaW5nIHRoZSBiYW5rcm9sbCBjb250cmFjdCBnZXRCYW5rcm9sbCgpIHJldHVybnMgbm9uLXplcm8KCgkJcmVxdWlyZShFT1NCZXRCYW5rcm9sbEludGVyZmFjZShiYW5rcm9sbEFkZHJlc3MpLmdldEJhbmtyb2xsKCkgIT0gMCk7CgoJCUJBTktST0xMRVIgPSBiYW5rcm9sbEFkZHJlc3M7Cgl9CgoJZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIHsKCQlyZXF1aXJlKG1zZy5zZW5kZXIgPT0gT1dORVIpOwoKCQlPV05FUiA9IG5ld093bmVyOwoJfQoKCWZ1bmN0aW9uIHNldE9yYWNsaXplUXVlcnlNYXhUaW1lKHVpbnQyNTYgbmV3VGltZSkgcHVibGljIHsKCQlyZXF1aXJlKG1zZy5zZW5kZXIgPT0gT1dORVIpOwoKCQlPUkFDTElaRVFVRVJZTUFYVElNRSA9IG5ld1RpbWU7Cgl9CgoJLy8gc3RvcmUgdGhlIGdhcyBwcmljZSBhcyBhIHN0b3JhZ2UgdmFyaWFibGUgZm9yIGVhc3kgcmVmZXJlbmNlLAoJLy8gYW5kIHRobmUgY2hhbmdlIHRoZSBnYXMgcHJpY2UgdXNpbmcgdGhlIHByb3BlciBvcmFjbGl6ZSBmdW5jdGlvbgoJZnVuY3Rpb24gc2V0T3JhY2xpemVRdWVyeUdhc1ByaWNlKHVpbnQyNTYgZ2FzUHJpY2UpIHB1YmxpYyB7CgkJcmVxdWlyZShtc2cuc2VuZGVyID09IE9XTkVSKTsKCgkJT1JBQ0xJWkVHQVNQUklDRSA9IGdhc1ByaWNlOwoJCW9yYWNsaXplX3NldEN1c3RvbUdhc1ByaWNlKGdhc1ByaWNlKTsKCX0KCgkvLyBzaG91bGQgYmUgfjE2MCwwMDAgdG8gc2F2ZSBldGgKCWZ1bmN0aW9uIHNldEluaXRpYWxHYXNGb3JPcmFjbGl6ZSh1aW50MjU2IGdhc0FtdCkgcHVibGljIHsKCQlyZXF1aXJlKG1zZy5zZW5kZXIgPT0gT1dORVIpOwoKCQlJTklUSUFMR0FTRk9ST1JBQ0xJWkUgPSBnYXNBbXQ7Cgl9CgoJZnVuY3Rpb24gc2V0R2FtZVBhdXNlZChib29sIHBhdXNlZCkgcHVibGljIHsKCQlyZXF1aXJlKG1zZy5zZW5kZXIgPT0gT1dORVIpOwoKCQlHQU1FUEFVU0VEID0gcGF1c2VkOwoJfQoKCWZ1bmN0aW9uIHNldFJlZnVuZHNBY3RpdmUoYm9vbCBhY3RpdmUpIHB1YmxpYyB7CgkJcmVxdWlyZShtc2cuc2VuZGVyID09IE9XTkVSKTsKCgkJUkVGVU5EU0FDVElWRSA9IGFjdGl2ZTsKCX0KCgkvLyBzZXR0aW5nIHRoaXMgdG8gMCB3b3VsZCBqdXN0IGZvcmNlIGFsbCBiZXRzIHRocm91Z2ggb3JhY2xpemUsIGFuZCBzZXR0aW5nIHRvIE1BWF9VSU5UXzI1NiB3b3VsZCBuZXZlciB1c2Ugb3JhY2xpemUgCglmdW5jdGlvbiBzZXRNaW5CZXRGb3JPcmFjbGl6ZSh1aW50MjU2IG1pbkJldCkgcHVibGljIHsKCQlyZXF1aXJlKG1zZy5zZW5kZXIgPT0gT1dORVIpOwoKCQlNSU5CRVRfZm9yT1JBQ0xJWkUgPSBtaW5CZXQ7Cgl9CgoJZnVuY3Rpb24gc2V0TWluQmV0KHVpbnQyNTYgbWluQmV0KSBwdWJsaWMgewoJCXJlcXVpcmUobXNnLnNlbmRlciA9PSBPV05FUiAmJiBtaW5CZXQgPiAxMDAwKTsKCgkJTUlOQkVUID0gbWluQmV0OwoJfQoKCWZ1bmN0aW9uIHNldE1heHdpbih1aW50MTYgbmV3TWF4V2luSW5UaG91c2FuZHRoUGVyY2VudHMpIHB1YmxpYyB7CgkJcmVxdWlyZShtc2cuc2VuZGVyID09IE9XTkVSICYmIG5ld01heFdpbkluVGhvdXNhbmR0aFBlcmNlbnRzIDw9IDMzMyk7IC8vIGNhbm5vdCBzZXQgbWF4IHdpbiBncmVhdGVyIHRoYW4gMS8zIG9mIHRoZSBiYW5rcm9sbCAoYSBqYWNrcG90IGlzIHZlcnkgcmFyZSkKCgkJTUFYV0lOX2luVEhPVVNBTkRUSFBFUkNFTlRTID0gbmV3TWF4V2luSW5UaG91c2FuZHRoUGVyY2VudHM7Cgl9CgoJLy8gdGhpcyBjYW4gYmUgZGVsZXRlZCBhZnRlciBzb21lIHRlc3RpbmcuCglmdW5jdGlvbiBlbWVyZ2VuY3lTZWxmRGVzdHJ1Y3QoKSBwdWJsaWMgewoJCXJlcXVpcmUobXNnLnNlbmRlciA9PSBPV05FUik7CgoJCXNlbGZkZXN0cnVjdChtc2cuc2VuZGVyKTsKCX0KCglmdW5jdGlvbiByZWZ1bmQoYnl0ZXMzMiBvcmFjbGl6ZVF1ZXJ5SWQpIHB1YmxpYyB7CgkJLy8gc2F2ZSBpbnRvIG1lbW9yeSBmb3IgY2hlYXAgYWNjZXNzCgkJU2xvdHNHYW1lRGF0YSBtZW1vcnkgZGF0YSA9IHNsb3RzRGF0YVtvcmFjbGl6ZVF1ZXJ5SWRdOwoKCQkvL3JlcXVpcmUgdGhhdCB0aGUgcXVlcnkgdGltZSBpcyB0b28gc2xvdywgYmV0IGhhcyBub3QgYmVlbiBwYWlkIG91dCwgYW5kIGVpdGhlciBjb250cmFjdCBvd25lciBvciBwbGF5ZXIgaXMgY2FsbGluZyB0aGlzIGZ1bmN0aW9uLgoJCXJlcXVpcmUoU2FmZU1hdGguc3ViKGJsb2NrLnRpbWVzdGFtcCwgZGF0YS5zdGFydCkgPj0gT1JBQ0xJWkVRVUVSWU1BWFRJTUUKCQkJJiYgKG1zZy5zZW5kZXIgPT0gT1dORVIgfHwgbXNnLnNlbmRlciA9PSBkYXRhLnBsYXllcikKCQkJJiYgKCFkYXRhLnBhaWRPdXQpCgkJCSYmIGRhdGEuZXRoZXJSZWNlaXZlZCA8PSBMSUFCSUxJVElFUwoJCQkmJiBkYXRhLmV0aGVyUmVjZWl2ZWQgPiAwCgkJCSYmIFJFRlVORFNBQ1RJVkUpOwoKCQkvLyBzZXQgY29udHJhY3QgZGF0YQoJCXNsb3RzRGF0YVtvcmFjbGl6ZVF1ZXJ5SWRdLnBhaWRPdXQgPSB0cnVlOwoKCQkvLyBzdWJ0cmFjdCBldGhlclJlY2VpdmVkIGZyb20gdGhlc2UgdHdvIHZhbHVlcyBiZWNhdXNlIHRoZSBiZXQgaXMgYmVpbmcgcmVmdW5kZWQKCQlMSUFCSUxJVElFUyA9IFNhZmVNYXRoLnN1YihMSUFCSUxJVElFUywgZGF0YS5ldGhlclJlY2VpdmVkKTsKCgkJLy8gdGhlbiB0cmFuc2ZlciB0aGUgb3JpZ2luYWwgYmV0IHRvIHRoZSBwbGF5ZXIuCgkJZGF0YS5wbGF5ZXIudHJhbnNmZXIoZGF0YS5ldGhlclJlY2VpdmVkKTsKCgkJLy8gZmluYWxseSwgbG9nIGFuIGV2ZW50IHNheWluZyB0aGF0IHRoZSByZWZ1bmQgaGFzIHByb2Nlc3NlZC4KCQllbWl0IFJlZnVuZChvcmFjbGl6ZVF1ZXJ5SWQsIGRhdGEuZXRoZXJSZWNlaXZlZCk7Cgl9CgoJZnVuY3Rpb24gcGxheSh1aW50OCBjcmVkaXRzKSBwdWJsaWMgcGF5YWJsZSB7CgkJLy8gc2F2ZSBmb3IgZnV0dXJlIHVzZSAvIGdhcyBlZmZpY2llbmN5CgkJdWludDI1NiBiZXRQZXJDcmVkaXQgPSBtc2cudmFsdWUgLyBjcmVkaXRzOwoKCQkvLyByZXF1aXJlIHRoYXQgdGhlIGdhbWUgaXMgdW5wYXVzZWQsIGFuZCB0aGF0IHRoZSBjcmVkaXRzIGJlaW5nIHB1cmNoYXNlZCBhcmUgZ3JlYXRlciB0aGFuIDAgYW5kIGxlc3MgdGhhbiB0aGUgYWxsb3dlZCBhbW91bnQsIGRlZmF1bHQ6IDEwMCBzcGlucyAKCQkvLyB2ZXJpZnkgdGhhdCB0aGUgYmV0IGlzIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgYmV0IGxpbWl0LCBzbyB3ZSBkb24ndCBnbyBiYW5rcnVwdCwgYW5kIHRoYXQgdGhlIGV0aGVycmVjZWl2ZWQgaXMgZ3JlYXRlciB0aGFuIHRoZSBtaW5iZXQuCgkJcmVxdWlyZSghR0FNRVBBVVNFRAoJCQkmJiBtc2cudmFsdWUgPiAwCgkJCSYmIGJldFBlckNyZWRpdCA+PSBNSU5CRVQKCQkJJiYgY3JlZGl0cyA+IDAgCgkJCSYmIGNyZWRpdHMgPD0gMjI0CgkJCSYmIFNhZmVNYXRoLm11bChiZXRQZXJDcmVkaXQsIDUwMDApIDw9IGdldE1heFdpbigpKTsgLy8gNTAwMCBpcyB0aGUgamFja3BvdCBwYXlvdXQgKG1heCB3aW4gb24gYSByb2xsKQoKCQkvLyBpZiBlYWNoIGJldCBpcyByZWxhdGl2ZWx5IHNtYWxsLCByZXNvbHZlIHRoZSBiZXQgaW4taG91c2UKCQlpZiAoYmV0UGVyQ3JlZGl0IDwgTUlOQkVUX2Zvck9SQUNMSVpFKXsKCgkJCS8vIHJhbmRvbW5lc3Mgd2lsbCBiZSBkZXRlcm1pbmVkIGJ5IGtlY2NhazI1NihibG9ja2hhc2gsIG5vbmNlKQoJCQkvLyBzdG9yZSB0aGVzZSBpbnRvIG1lbW9yeSBmb3IgY2hlYXAgYWNjZXNzCgkJCWJ5dGVzMzIgYmxvY2tIYXNoID0gYmxvY2suYmxvY2toYXNoKGJsb2NrLm51bWJlcik7CgoJCQkvLyB1c2UgZGlhbHNTcHVuIGFzIGEgbm9uY2UgZm9yIHRoZSBvcmFjbGl6ZSByZXR1cm4gcmFuZG9tIGJ5dGVzLgoJCQl1aW50MjU2IGRpYWxzU3B1bjsKCgkJCS8vIGRpYWwxLCBkaWFsMiwgZGlhbDMgYXJlIHRoZSBpdGVtcyB0aGF0IHRoZSB3aGVlbCBsYW5kcyBvbiwgcmVwcmVzZW50ZWQgYnkgdWludHMgMC02CgkJCS8vIHRoZXNlIGFyZSB0aGVuIGVjaG9lZCB0byB0aGUgZnJvbnQgZW5kIGJ5IGRhdGExLCBkYXRhMiwgZGF0YTMKCQkJdWludDggZGlhbDE7CgkJCXVpbnQ4IGRpYWwyOwoJCQl1aW50OCBkaWFsMzsKCgkJCS8vIHRoZXNlIGFyZSB1c2VkIE9OTFkgZm9yIGxvZyBkYXRhIGZvciB0aGUgZnJvbnRlbmQKCQkJLy8gZWFjaCBkaWFsIG9mIHRoZSBtYWNoaW5lIGNhbiBiZSBiZXR3ZWVuIDAgYW5kIDYgKHNlZSBiZWxvdyB0YWJsZSBmb3IgZGlzdHJpYnV0aW9uKQoJCQkvLyB0aGVyZWZvcmUsIGVhY2ggZGlhbCB0YWtlcyAzIEJJVFMgb2Ygc3BhY2UgLT4gdWludChiaXRzKCcxMTEnKSkgPT0gNywgdWludChiaXRzKCcwMDAnKSkgPT0gMAoJCQkvLyBzbyBkYXRhWCBjYW4gaG9sZCAyNTYgYml0cy8oMyBiaXRzICogMyBkaWFscykgPSAyOC40NDQgLT4gMjggc3BpbnMgd29ydGggb2YgZGF0YSAKCQkJdWludDI1NltdIG1lbW9yeSBsb2dzRGF0YSA9IG5ldyB1aW50MjU2W10oOCk7CgoJCQkvLyB0aGlzIGlzIGluY3JlbWVudGVkIGV2ZXJ5IHRpbWUgYSBwbGF5ZXIgaGl0cyBhIHNwb3Qgb2YgdGhlIHdoZWVsIHRoYXQgcGF5cyBvdXQKCQkJLy8gYXQgdGhlIGVuZCB0aGlzIGlzIG11bHRpcGxpZWQgYnkgdGhlIGJldFBlckNyZWRpdCBhbW91bnQgdG8gZGV0ZXJtaW5lIGhvdyBtdWNoIHRoZSBnYW1lIHNob3VsZCBwYXlvdXQuCgkJCXVpbnQyNTYgcGF5b3V0OwoKCQkJLy8gTm93LCBsb29wIG92ZXIgZWFjaCBjcmVkaXQuCgkJCS8vIFBsZWFzZSBub3RlIHRoYXQgdGhpcyBsb29wIGlzIGFsbW9zdCBpZGVudGljYWwgdG8gdGhlIGxvb3AgaW4gdGhlIF9fY2FsbGJhY2sgZnJvbSBvcmFjbGl6ZQoJCQkvLyBNb2R1bGFyLWl6aW5nIHRoZSBsb29wcyBpbnRvIGEgc2luZ2xlIGZ1bmN0aW9uIGlzIGltcG9zc2libGUgYmVjYXVzZSBzb2xpZGl0eSBjYW4gb25seSBzdG9yZSAxNiB2YXJpYWJsZXMgaW50byBtZW1vcnkKCQkJLy8gYWxzbywgaXQgd291bGQgY29zdCBpbmNyZWFzZWQgZ2FzIGZvciBlYWNoIHNwaW4uCgkJCWZvciAodWludDggaSA9IDA7IGkgPCBjcmVkaXRzOyBpKyspewoKCQkJCS8vIHNwaW4gdGhlIGZpcnN0IGRpYWwKCQkJCWRpYWxzU3B1biArPSAxOwoJCQkJZGlhbDEgPSB1aW50OCh1aW50KGtlY2NhazI1NihibG9ja0hhc2gsIGRpYWxzU3B1bikpICUgNjQpOwoJCQkJLy8gc3BpbiB0aGUgc2Vjb25kIGRpYWwKCQkJCWRpYWxzU3B1biArPSAxOwoJCQkJZGlhbDIgPSB1aW50OCh1aW50KGtlY2NhazI1NihibG9ja0hhc2gsIGRpYWxzU3B1bikpICUgNjQpOwoJCQkJLy8gc3BpbiB0aGUgdGhpcmQgZGlhbAoJCQkJZGlhbHNTcHVuICs9IDE7CgkJCQlkaWFsMyA9IHVpbnQ4KHVpbnQoa2VjY2FrMjU2KGJsb2NrSGFzaCwgZGlhbHNTcHVuKSkgJSA2NCk7CgoJCQkJLy8gZGlhbCAxLCBiYXNlZCBvbiBhYm92ZSB0YWJsZQoJCQkJZGlhbDEgPSBnZXREaWFsMVR5cGUoZGlhbDEpOwoKCQkJCS8vIGRpYWwgMiwgYmFzZWQgb24gYWJvdmUgdGFibGUKCQkJCWRpYWwyID0gZ2V0RGlhbDJUeXBlKGRpYWwyKTsKCgkJCQkvLyBkaWFsIDMsIGJhc2VkIG9uIGFib3ZlIHRhYmxlCgkJCQlkaWFsMyA9IGdldERpYWwzVHlwZShkaWFsMyk7CgoJCQkJLy8gZGV0ZXJtaW5lIHRoZSBwYXlvdXRzIChhbGwgaW4gdWludDgpCgoJCQkJcGF5b3V0ICs9IGRldGVybWluZVBheW91dChkaWFsMSwgZGlhbDIsIGRpYWwzKTsKCgkJCQkvLyBIZXJlIHdlIGFzc2VtYmxlIHVpbnQyNTYncyBvZiBsb2cgZGF0YSBzbyB0aGF0IHRoZSBmcm9udGVuZCBjYW4gInJlcGxheSIgdGhlIHNwaW5zCgkJCQkvLyBlYWNoICJkaWFsIiBpcyBhIHVpbnQ4IGJ1dCBjYW4gb25seSBiZSBiZXR3ZWVuIDAtNiwgc28gd291bGQgb25seSBuZWVkIDMgYml0cyB0byBzdG9yZSB0aGlzLiB1aW50KGJpdHMoJzExMScpKSA9IDcKCQkJCS8vIDIgKiogMyBpcyB0aGUgYml0c2hpZnQgb3BlcmF0b3IgZm9yIHRocmVlIGJpdHMgCgkJCQlpZiAoaSA8PSAyNyl7CgkJCQkJLy8gaW4gbG9nc0RhdGEwCgkJCQkJbG9nc0RhdGFbMF0gKz0gdWludDI1NihkaWFsMSkgKiB1aW50MjU2KDIpICoqICgzICogKCgzICogKDI3IC0gaSkpICsgMikpOwoJCQkJCWxvZ3NEYXRhWzBdICs9IHVpbnQyNTYoZGlhbDIpICogdWludDI1NigyKSAqKiAoMyAqICgoMyAqICgyNyAtIGkpKSArIDEpKTsKCQkJCQlsb2dzRGF0YVswXSArPSB1aW50MjU2KGRpYWwzKSAqIHVpbnQyNTYoMikgKiogKDMgKiAoKDMgKiAoMjcgLSBpKSkpKTsKCQkJCX0KCQkJCWVsc2UgaWYgKGkgPD0gNTUpewoJCQkJCS8vIGluIGxvZ3NEYXRhMQoJCQkJCWxvZ3NEYXRhWzFdICs9IHVpbnQyNTYoZGlhbDEpICogdWludDI1NigyKSAqKiAoMyAqICgoMyAqICg1NSAtIGkpKSArIDIpKTsKCQkJCQlsb2dzRGF0YVsxXSArPSB1aW50MjU2KGRpYWwyKSAqIHVpbnQyNTYoMikgKiogKDMgKiAoKDMgKiAoNTUgLSBpKSkgKyAxKSk7CgkJCQkJbG9nc0RhdGFbMV0gKz0gdWludDI1NihkaWFsMykgKiB1aW50MjU2KDIpICoqICgzICogKCgzICogKDU1IC0gaSkpKSk7CgkJCQl9CgkJCQllbHNlIGlmIChpIDw9IDgzKSB7CgkJCQkJLy8gaW4gbG9nc0RhdGEyCgkJCQkJbG9nc0RhdGFbMl0gKz0gdWludDI1NihkaWFsMSkgKiB1aW50MjU2KDIpICoqICgzICogKCgzICogKDgzIC0gaSkpICsgMikpOwoJCQkJCWxvZ3NEYXRhWzJdICs9IHVpbnQyNTYoZGlhbDIpICogdWludDI1NigyKSAqKiAoMyAqICgoMyAqICg4MyAtIGkpKSArIDEpKTsKCQkJCQlsb2dzRGF0YVsyXSArPSB1aW50MjU2KGRpYWwzKSAqIHVpbnQyNTYoMikgKiogKDMgKiAoKDMgKiAoODMgLSBpKSkpKTsKCQkJCX0KCQkJCWVsc2UgaWYgKGkgPD0gMTExKSB7CgkJCQkJLy8gaW4gbG9nc0RhdGEzCgkJCQkJbG9nc0RhdGFbM10gKz0gdWludDI1NihkaWFsMSkgKiB1aW50MjU2KDIpICoqICgzICogKCgzICogKDExMSAtIGkpKSArIDIpKTsKCQkJCQlsb2dzRGF0YVszXSArPSB1aW50MjU2KGRpYWwyKSAqIHVpbnQyNTYoMikgKiogKDMgKiAoKDMgKiAoMTExIC0gaSkpICsgMSkpOwoJCQkJCWxvZ3NEYXRhWzNdICs9IHVpbnQyNTYoZGlhbDMpICogdWludDI1NigyKSAqKiAoMyAqICgoMyAqICgxMTEgLSBpKSkpKTsKCQkJCX0KCQkJCWVsc2UgaWYgKGkgPD0gMTM5KXsKCQkJCQkvLyBpbiBsb2dzRGF0YTQKCQkJCQlsb2dzRGF0YVs0XSArPSB1aW50MjU2KGRpYWwxKSAqIHVpbnQyNTYoMikgKiogKDMgKiAoKDMgKiAoMTM5IC0gaSkpICsgMikpOwoJCQkJCWxvZ3NEYXRhWzRdICs9IHVpbnQyNTYoZGlhbDIpICogdWludDI1NigyKSAqKiAoMyAqICgoMyAqICgxMzkgLSBpKSkgKyAxKSk7CgkJCQkJbG9nc0RhdGFbNF0gKz0gdWludDI1NihkaWFsMykgKiB1aW50MjU2KDIpICoqICgzICogKCgzICogKDEzOSAtIGkpKSkpOwoJCQkJfQoJCQkJZWxzZSBpZiAoaSA8PSAxNjcpewoJCQkJCS8vIGluIGxvZ3NEYXRhNQoJCQkJCWxvZ3NEYXRhWzVdICs9IHVpbnQyNTYoZGlhbDEpICogdWludDI1NigyKSAqKiAoMyAqICgoMyAqICgxNjcgLSBpKSkgKyAyKSk7CgkJCQkJbG9nc0RhdGFbNV0gKz0gdWludDI1NihkaWFsMikgKiB1aW50MjU2KDIpICoqICgzICogKCgzICogKDE2NyAtIGkpKSArIDEpKTsKCQkJCQlsb2dzRGF0YVs1XSArPSB1aW50MjU2KGRpYWwzKSAqIHVpbnQyNTYoMikgKiogKDMgKiAoKDMgKiAoMTY3IC0gaSkpKSk7CgkJCQl9CgkJCQllbHNlIGlmIChpIDw9IDE5NSl7CgkJCQkJLy8gaW4gbG9nc0RhdGE2CgkJCQkJbG9nc0RhdGFbNl0gKz0gdWludDI1NihkaWFsMSkgKiB1aW50MjU2KDIpICoqICgzICogKCgzICogKDE5NSAtIGkpKSArIDIpKTsKCQkJCQlsb2dzRGF0YVs2XSArPSB1aW50MjU2KGRpYWwyKSAqIHVpbnQyNTYoMikgKiogKDMgKiAoKDMgKiAoMTk1IC0gaSkpICsgMSkpOwoJCQkJCWxvZ3NEYXRhWzZdICs9IHVpbnQyNTYoZGlhbDMpICogdWludDI1NigyKSAqKiAoMyAqICgoMyAqICgxOTUgLSBpKSkpKTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCS8vIGluIGxvZ3NEYXRhNwoJCQkJCWxvZ3NEYXRhWzddICs9IHVpbnQyNTYoZGlhbDEpICogdWludDI1NigyKSAqKiAoMyAqICgoMyAqICgyMjMgLSBpKSkgKyAyKSk7CgkJCQkJbG9nc0RhdGFbN10gKz0gdWludDI1NihkaWFsMikgKiB1aW50MjU2KDIpICoqICgzICogKCgzICogKDIyMyAtIGkpKSArIDEpKTsKCQkJCQlsb2dzRGF0YVs3XSArPSB1aW50MjU2KGRpYWwzKSAqIHVpbnQyNTYoMikgKiogKDMgKiAoKDMgKiAoMjIzIC0gaSkpKSk7CgkJCQl9CgkJCX0KCgkJCS8vIGFkZCB0aGVzZSBuZXcgZGlhbHMgdG8gdGhlIHN0b3JhZ2UgdmFyaWFibGUgRElBTFNTUFVOCgkJCURJQUxTU1BVTiArPSBkaWFsc1NwdW47CgoJCQkvLyBhbmQgYWRkIHRoZSBhbW91bnQgd2FnZXJlZAoJCQlBTU9VTlRXQUdFUkVEID0gU2FmZU1hdGguYWRkKEFNT1VOVFdBR0VSRUQsIG1zZy52YWx1ZSk7CgoJCQkvLyBjYWxjdWxhdGUgYW1vdW50IGZvciB0aGUgZGV2ZWxvcGVycyBmdW5kLgoJCQkvLyB0aGlzIGlzOiB2YWx1ZSBvZiBldGhlciAqICg1JSBob3VzZSBlZGdlKSAqICgyMCUgY3V0KQoJCQl1aW50MjU2IGRldmVsb3BlcnNDdXQgPSBtc2cudmFsdWUgLyAxMDA7CgoJCQkvLyBhZGQgdGhpcyB0byB0aGUgZGV2ZWxvcGVycyBmdW5kLgoJCQlERVZFTE9QRVJTRlVORCA9IFNhZmVNYXRoLmFkZChERVZFTE9QRVJTRlVORCwgZGV2ZWxvcGVyc0N1dCk7CgoJCQkvLyB0cmFuc2ZlciB0aGUgKG1zZy52YWx1ZSAtIGRldmVsb3BlcnNDdXQpIHRvIHRoZSBiYW5rcm9sbAoJCQlFT1NCZXRCYW5rcm9sbEludGVyZmFjZShCQU5LUk9MTEVSKS5yZWNlaXZlRXRoZXJGcm9tR2FtZUFkZHJlc3MudmFsdWUoU2FmZU1hdGguc3ViKG1zZy52YWx1ZSwgZGV2ZWxvcGVyc0N1dCkpKCk7CgoJCQkvLyBub3cgcGF5b3V0IGV0aGVyCgkJCXVpbnQyNTYgZXRoZXJQYWlkb3V0ID0gU2FmZU1hdGgubXVsKGJldFBlckNyZWRpdCwgcGF5b3V0KTsKCgkJCS8vIG1ha2UgdGhlIGJhbmtyb2xsIHRyYW5zZmVyIHRoZSBwYWlkb3V0IGFtb3VudCB0byB0aGUgcGxheWVyCgkJCUVPU0JldEJhbmtyb2xsSW50ZXJmYWNlKEJBTktST0xMRVIpLnBheUV0aGVyVG9XaW5uZXIoZXRoZXJQYWlkb3V0LCBtc2cuc2VuZGVyKTsKCgkJCS8vIGFuZCBsYXN0bHksIGxvZyBhbiBldmVudAoJCQkvLyBsb2cgdGhlIGRhdGEgbG9ncyB0aGF0IHdlcmUgY3JlYXRlZCBhYm92ZSwgd2Ugd2lsbCBub3QgdXNlIGV2ZW50IHdhdGNoZXJzIGhlcmUsIGJ1dCB3aWxsIHVzZSB0aGUgdHhSZWNlaXB0IHRvIGdldCBsb2dzIGluc3RlYWQuCgkJCWVtaXQgU2xvdHNTbWFsbEJldChsb2dzRGF0YVswXSwgbG9nc0RhdGFbMV0sIGxvZ3NEYXRhWzJdLCBsb2dzRGF0YVszXSwgbG9nc0RhdGFbNF0sIGxvZ3NEYXRhWzVdLCBsb2dzRGF0YVs2XSwgbG9nc0RhdGFbN10pOwoKCQl9CgkJLy8gaWYgdGhlIGJldCBhbW91bnQgaXMgT1ZFUiB0aGUgb3JhY2xpemUgcXVlcnkgbGltaXQsIHdlIG11c3QgZ2V0IHRoZSByYW5kb21uZXNzIGZyb20gb3JhY2xpemUuCgkJLy8gVGhpcyBpcyBiZWNhdXNlIG1pbmVycyBhcmUgaW52ZW50aXZpemVkIHRvIGludGVyZmVyZSB3aXRoIHRoZSBibG9jay5ibG9ja2hhc2gsIGluIGFuIGF0dGVtcHQKCQkvLyB0byBnZXQgbW9yZSBmYXZvcmFibGUgcm9sbHMvc2xvdCBzcGlucy9ldGMuCgkJZWxzZSB7CgkJCS8vIG9yYWNsaXplX25ld1JhbmRvbURTUXVlcnkoZGVsYXkgaW4gc2Vjb25kcywgYnl0ZXMgb2YgcmFuZG9tIGRhdGEsIGdhcyBmb3IgY2FsbGJhY2sgZnVuY3Rpb24pCgkJCWJ5dGVzMzIgb3JhY2xpemVRdWVyeUlkOwoKCQkJLy8gZXF1YXRpb24gZm9yIGdhcyB0byBvcmFjbGl6ZSBpczoKCQkJLy8gZ2FzID0gKHNvbWUgZml4ZWQgZ2FzIGFtdCkgKyAzMjcwICogY3JlZGl0cwoJCQkKCQkJdWludDI1NiBnYXNUb1NlbmQgPSBJTklUSUFMR0FTRk9ST1JBQ0xJWkUgKyAodWludDI1NigzMjcwKSAqIGNyZWRpdHMpOwoKCQkJRU9TQmV0QmFua3JvbGxJbnRlcmZhY2UoQkFOS1JPTExFUikucGF5T3JhY2xpemUob3JhY2xpemVfZ2V0UHJpY2UoJ3JhbmRvbScsIGdhc1RvU2VuZCkpOwoKCQkJb3JhY2xpemVRdWVyeUlkID0gb3JhY2xpemVfbmV3UmFuZG9tRFNRdWVyeSgwLCAzMCwgZ2FzVG9TZW5kKTsKCgkJCS8vIGFkZCB0aGUgbmV3IHNsb3RzIGRhdGEgdG8gYSBtYXBwaW5nIHNvIHRoYXQgdGhlIG9yYWNsaXplIF9fY2FsbGJhY2sgY2FuIHVzZSBpdCBsYXRlcgoJCQlzbG90c0RhdGFbb3JhY2xpemVRdWVyeUlkXSA9IFNsb3RzR2FtZURhdGEoewoJCQkJcGxheWVyIDogbXNnLnNlbmRlciwKCQkJCXBhaWRPdXQgOiBmYWxzZSwKCQkJCXN0YXJ0IDogYmxvY2sudGltZXN0YW1wLAoJCQkJZXRoZXJSZWNlaXZlZCA6IG1zZy52YWx1ZSwKCQkJCWNyZWRpdHMgOiBjcmVkaXRzCgkJCX0pOwoKCQkJLy8gYWRkIHRoZSBzZW50IHZhbHVlIGludG8gbGlhYmlsaXRpZXMuIHRoaXMgc2hvdWxkIE5PVCBnbyBpbnRvIHRoZSBiYW5rcm9sbCB5ZXQKCQkJLy8gYW5kIG11c3QgYmUgcXVhcmFudGluZWQgaGVyZSB0byBwcmV2ZW50IHRpbWluZyBhdHRhY2tzCgkJCUxJQUJJTElUSUVTID0gU2FmZU1hdGguYWRkKExJQUJJTElUSUVTLCBtc2cudmFsdWUpOwoKCQkJZW1pdCBCdXlDcmVkaXRzKG9yYWNsaXplUXVlcnlJZCk7CgkJfQoJfQoKCWZ1bmN0aW9uIF9fY2FsbGJhY2soYnl0ZXMzMiBfcXVlcnlJZCwgc3RyaW5nIF9yZXN1bHQsIGJ5dGVzIF9wcm9vZikgcHVibGljIHsKCQkvLyBnZXQgdGhlIGdhbWUgZGF0YSBhbmQgcHV0IGludG8gbWVtb3J5CgkJU2xvdHNHYW1lRGF0YSBtZW1vcnkgZGF0YSA9IHNsb3RzRGF0YVtfcXVlcnlJZF07CgoJCXJlcXVpcmUobXNnLnNlbmRlciA9PSBvcmFjbGl6ZV9jYkFkZHJlc3MoKSAKCQkJJiYgIWRhdGEucGFpZE91dCAKCQkJJiYgZGF0YS5wbGF5ZXIgIT0gYWRkcmVzcygwKSAKCQkJJiYgTElBQklMSVRJRVMgPj0gZGF0YS5ldGhlclJlY2VpdmVkKTsKCgkJLy8gaWYgdGhlIHByb29mIGhhcyBmYWlsZWQsIGltbWVkaWF0ZWx5IHJlZnVuZCB0aGUgcGxheWVyIHRoZSBvcmlnaW5hbCBiZXQuCgkJaWYgKG9yYWNsaXplX3JhbmRvbURTX3Byb29mVmVyaWZ5X19yZXR1cm5Db2RlKF9xdWVyeUlkLCBfcmVzdWx0LCBfcHJvb2YpICE9IDApewoKCQkJaWYgKFJFRlVORFNBQ1RJVkUpewoJCQkJLy8gc2V0IGNvbnRyYWN0IGRhdGEKCQkJCXNsb3RzRGF0YVtfcXVlcnlJZF0ucGFpZE91dCA9IHRydWU7CgoJCQkJLy8gc3VidHJhY3QgZnJvbSBsaWFiaWxpdGllcyBhbmQgYW1vdW50IHdhZ2VyZWQsIGJlY2F1c2UgdGhpcyBiZXQgaXMgYmVpbmcgcmVmdW5kZWQuCgkJCQlMSUFCSUxJVElFUyA9IFNhZmVNYXRoLnN1YihMSUFCSUxJVElFUywgZGF0YS5ldGhlclJlY2VpdmVkKTsKCgkJCQkvLyB0cmFuc2ZlciB0aGUgb3JpZ2luYWwgYmV0IGJhY2sKCQkJCWRhdGEucGxheWVyLnRyYW5zZmVyKGRhdGEuZXRoZXJSZWNlaXZlZCk7CgoJCQkJLy8gbG9nIHRoZSByZWZ1bmQKCQkJCWVtaXQgUmVmdW5kKF9xdWVyeUlkLCBkYXRhLmV0aGVyUmVjZWl2ZWQpOwoJCQl9CgkJCS8vIGxvZyB0aGUgbGVkZ2VyIHByb29mIGZhaWwgCgkJCWVtaXQgTGVkZ2VyUHJvb2ZGYWlsZWQoX3F1ZXJ5SWQpOwoJCQkKCQl9CgkJZWxzZSB7CgkJCS8vIGFnYWluLCB0aGlzIGJsb2NrIGlzIGFsbW9zdCBpZGVudGljYWwgdG8gdGhlIHByZXZpb3VzIGJsb2NrIGluIHRoZSBwbGF5KC4uLikgZnVuY3Rpb24gCgkJCS8vIGluc3RlYWQgb2YgZHVwbGljYXRpbmcgZG9jdW1lbnRhdGlvbiwgd2Ugd2lsbCBqdXN0IHBvaW50IG91dCB0aGUgY2hhbmdlcyBmcm9tIHRoZSBvdGhlciBibG9jayAKCQkJdWludDI1NiBkaWFsc1NwdW47CgkJCQoJCQl1aW50OCBkaWFsMTsKCQkJdWludDggZGlhbDI7CgkJCXVpbnQ4IGRpYWwzOwoJCQkKCQkJdWludDI1NltdIG1lbW9yeSBsb2dzRGF0YSA9IG5ldyB1aW50MjU2W10oOCk7CgkJCQoJCQl1aW50MjU2IHBheW91dDsKCQkJCgkJCS8vIG11c3QgdXNlIGRhdGEuY3JlZGl0cyBpbnN0ZWFkIG9mIGNyZWRpdHMuCgkJCWZvciAodWludDggaSA9IDA7IGkgPCBkYXRhLmNyZWRpdHM7IGkrKyl7CgoJCQkJLy8gYWxsIGRpYWxzIG5vdyB1c2UgX3Jlc3VsdCwgaW5zdGVhZCBvZiBibG9ja2hhc2gsIHRoaXMgaXMgdGhlIG1haW4gY2hhbmdlLCBhbmQgYWxsb3dzIFNsb3RzIHRvIAoJCQkJLy8gYWNjb21vZGF0ZSBiZXRzIG9mIGFueSBzaXplLCBmcmVlIG9mIHBvc3NpYmxlIG1pbmVyIGludGVyZmVyZW5jZSAKCQkJCWRpYWxzU3B1biArPSAxOwoJCQkJZGlhbDEgPSB1aW50OCh1aW50KGtlY2NhazI1NihfcmVzdWx0LCBkaWFsc1NwdW4pKSAlIDY0KTsKCQkJCQoJCQkJZGlhbHNTcHVuICs9IDE7CgkJCQlkaWFsMiA9IHVpbnQ4KHVpbnQoa2VjY2FrMjU2KF9yZXN1bHQsIGRpYWxzU3B1bikpICUgNjQpOwoJCQkJCgkJCQlkaWFsc1NwdW4gKz0gMTsKCQkJCWRpYWwzID0gdWludDgodWludChrZWNjYWsyNTYoX3Jlc3VsdCwgZGlhbHNTcHVuKSkgJSA2NCk7CgoJCQkJLy8gZGlhbCAxCgkJCQlkaWFsMSA9IGdldERpYWwxVHlwZShkaWFsMSk7CgoJCQkJLy8gZGlhbCAyCgkJCQlkaWFsMiA9IGdldERpYWwyVHlwZShkaWFsMik7CgoJCQkJLy8gZGlhbCAzCgkJCQlkaWFsMyA9IGdldERpYWwzVHlwZShkaWFsMyk7CgoJCQkJLy8gZGV0ZXJtaW5lIHRoZSBwYXlvdXQKCQkJCXBheW91dCArPSBkZXRlcm1pbmVQYXlvdXQoZGlhbDEsIGRpYWwyLCBkaWFsMyk7CgkJCQkKCQkJCS8vIGFzc2VtYmxpbmcgbG9nIGRhdGEKCQkJCWlmIChpIDw9IDI3KXsKCQkJCQkvLyBpbiBsb2dzRGF0YTAKCQkJCQlsb2dzRGF0YVswXSArPSB1aW50MjU2KGRpYWwxKSAqIHVpbnQyNTYoMikgKiogKDMgKiAoKDMgKiAoMjcgLSBpKSkgKyAyKSk7CgkJCQkJbG9nc0RhdGFbMF0gKz0gdWludDI1NihkaWFsMikgKiB1aW50MjU2KDIpICoqICgzICogKCgzICogKDI3IC0gaSkpICsgMSkpOwoJCQkJCWxvZ3NEYXRhWzBdICs9IHVpbnQyNTYoZGlhbDMpICogdWludDI1NigyKSAqKiAoMyAqICgoMyAqICgyNyAtIGkpKSkpOwoJCQkJfQoJCQkJZWxzZSBpZiAoaSA8PSA1NSl7CgkJCQkJLy8gaW4gbG9nc0RhdGExCgkJCQkJbG9nc0RhdGFbMV0gKz0gdWludDI1NihkaWFsMSkgKiB1aW50MjU2KDIpICoqICgzICogKCgzICogKDU1IC0gaSkpICsgMikpOwoJCQkJCWxvZ3NEYXRhWzFdICs9IHVpbnQyNTYoZGlhbDIpICogdWludDI1NigyKSAqKiAoMyAqICgoMyAqICg1NSAtIGkpKSArIDEpKTsKCQkJCQlsb2dzRGF0YVsxXSArPSB1aW50MjU2KGRpYWwzKSAqIHVpbnQyNTYoMikgKiogKDMgKiAoKDMgKiAoNTUgLSBpKSkpKTsKCQkJCX0KCQkJCWVsc2UgaWYgKGkgPD0gODMpIHsKCQkJCQkvLyBpbiBsb2dzRGF0YTIKCQkJCQlsb2dzRGF0YVsyXSArPSB1aW50MjU2KGRpYWwxKSAqIHVpbnQyNTYoMikgKiogKDMgKiAoKDMgKiAoODMgLSBpKSkgKyAyKSk7CgkJCQkJbG9nc0RhdGFbMl0gKz0gdWludDI1NihkaWFsMikgKiB1aW50MjU2KDIpICoqICgzICogKCgzICogKDgzIC0gaSkpICsgMSkpOwoJCQkJCWxvZ3NEYXRhWzJdICs9IHVpbnQyNTYoZGlhbDMpICogdWludDI1NigyKSAqKiAoMyAqICgoMyAqICg4MyAtIGkpKSkpOwoJCQkJfQoJCQkJZWxzZSBpZiAoaSA8PSAxMTEpIHsKCQkJCQkvLyBpbiBsb2dzRGF0YTMKCQkJCQlsb2dzRGF0YVszXSArPSB1aW50MjU2KGRpYWwxKSAqIHVpbnQyNTYoMikgKiogKDMgKiAoKDMgKiAoMTExIC0gaSkpICsgMikpOwoJCQkJCWxvZ3NEYXRhWzNdICs9IHVpbnQyNTYoZGlhbDIpICogdWludDI1NigyKSAqKiAoMyAqICgoMyAqICgxMTEgLSBpKSkgKyAxKSk7CgkJCQkJbG9nc0RhdGFbM10gKz0gdWludDI1NihkaWFsMykgKiB1aW50MjU2KDIpICoqICgzICogKCgzICogKDExMSAtIGkpKSkpOwoJCQkJfQoJCQkJZWxzZSBpZiAoaSA8PSAxMzkpewoJCQkJCS8vIGluIGxvZ3NEYXRhNAoJCQkJCWxvZ3NEYXRhWzRdICs9IHVpbnQyNTYoZGlhbDEpICogdWludDI1NigyKSAqKiAoMyAqICgoMyAqICgxMzkgLSBpKSkgKyAyKSk7CgkJCQkJbG9nc0RhdGFbNF0gKz0gdWludDI1NihkaWFsMikgKiB1aW50MjU2KDIpICoqICgzICogKCgzICogKDEzOSAtIGkpKSArIDEpKTsKCQkJCQlsb2dzRGF0YVs0XSArPSB1aW50MjU2KGRpYWwzKSAqIHVpbnQyNTYoMikgKiogKDMgKiAoKDMgKiAoMTM5IC0gaSkpKSk7CgkJCQl9CgkJCQllbHNlIGlmIChpIDw9IDE2Nyl7CgkJCQkJLy8gaW4gbG9nc0RhdGE1CgkJCQkJbG9nc0RhdGFbNV0gKz0gdWludDI1NihkaWFsMSkgKiB1aW50MjU2KDIpICoqICgzICogKCgzICogKDE2NyAtIGkpKSArIDIpKTsKCQkJCQlsb2dzRGF0YVs1XSArPSB1aW50MjU2KGRpYWwyKSAqIHVpbnQyNTYoMikgKiogKDMgKiAoKDMgKiAoMTY3IC0gaSkpICsgMSkpOwoJCQkJCWxvZ3NEYXRhWzVdICs9IHVpbnQyNTYoZGlhbDMpICogdWludDI1NigyKSAqKiAoMyAqICgoMyAqICgxNjcgLSBpKSkpKTsKCQkJCX0KCQkJCWVsc2UgaWYgKGkgPD0gMTk1KXsKCQkJCQkvLyBpbiBsb2dzRGF0YTYKCQkJCQlsb2dzRGF0YVs2XSArPSB1aW50MjU2KGRpYWwxKSAqIHVpbnQyNTYoMikgKiogKDMgKiAoKDMgKiAoMTk1IC0gaSkpICsgMikpOwoJCQkJCWxvZ3NEYXRhWzZdICs9IHVpbnQyNTYoZGlhbDIpICogdWludDI1NigyKSAqKiAoMyAqICgoMyAqICgxOTUgLSBpKSkgKyAxKSk7CgkJCQkJbG9nc0RhdGFbNl0gKz0gdWludDI1NihkaWFsMykgKiB1aW50MjU2KDIpICoqICgzICogKCgzICogKDE5NSAtIGkpKSkpOwoJCQkJfQoJCQkJZWxzZSBpZiAoaSA8PSAyMjMpewoJCQkJCS8vIGluIGxvZ3NEYXRhNwoJCQkJCWxvZ3NEYXRhWzddICs9IHVpbnQyNTYoZGlhbDEpICogdWludDI1NigyKSAqKiAoMyAqICgoMyAqICgyMjMgLSBpKSkgKyAyKSk7CgkJCQkJbG9nc0RhdGFbN10gKz0gdWludDI1NihkaWFsMikgKiB1aW50MjU2KDIpICoqICgzICogKCgzICogKDIyMyAtIGkpKSArIDEpKTsKCQkJCQlsb2dzRGF0YVs3XSArPSB1aW50MjU2KGRpYWwzKSAqIHVpbnQyNTYoMikgKiogKDMgKiAoKDMgKiAoMjIzIC0gaSkpKSk7CgkJCQl9CgkJCX0KCgkJCS8vIHRyYWNrIHRoYXQgdGhlc2Ugc3BpbnMgd2VyZSBtYWRlCgkJCURJQUxTU1BVTiArPSBkaWFsc1NwdW47CgoJCQkvLyBhbmQgYWRkIHRoZSBhbW91bnQgd2FnZXJlZAoJCQlBTU9VTlRXQUdFUkVEID0gU2FmZU1hdGguYWRkKEFNT1VOVFdBR0VSRUQsIGRhdGEuZXRoZXJSZWNlaXZlZCk7CgoJCQkvLyBJTVBPUlRBTlQ6IHdlIG11c3QgY2hhbmdlIHRoZSAicGFpZE91dCIgdG8gVFJVRSBoZXJlIHRvIHByZXZlbnQgcmVlbnRyYW5jeS9vdGhlciBuYXN0eSBlZmZlY3RzLgoJCQkvLyB0aGlzIHdhcyBub3QgbmVlZGVkIHdpdGggdGhlIHByZXZpb3VzIGxvb3AvY29kZSBibG9jaywgYW5kIGlzIHVzZWQgYmVjYXVzZSB2YXJpYWJsZXMgbXVzdCBiZSB3cml0dGVuIGludG8gc3RvcmFnZQoJCQlzbG90c0RhdGFbX3F1ZXJ5SWRdLnBhaWRPdXQgPSB0cnVlOwoKCQkJLy8gZGVjcmVhc2UgTElBQklMSVRJRVMgd2hlbiB0aGUgc3BpbnMgYXJlIG1hZGUKCQkJTElBQklMSVRJRVMgPSBTYWZlTWF0aC5zdWIoTElBQklMSVRJRVMsIGRhdGEuZXRoZXJSZWNlaXZlZCk7CgoJCQkvLyBnZXQgdGhlIGRldmVsb3BlcnMgY3V0LCBhbmQgc2VuZCB0aGUgcmVzdCBvZiB0aGUgZXRoZXIgcmVjZWl2ZWQgdG8gdGhlIGJhbmtyb2xsZXIgY29udHJhY3QKCQkJdWludDI1NiBkZXZlbG9wZXJzQ3V0ID0gZGF0YS5ldGhlclJlY2VpdmVkIC8gMTAwOwoKCQkJREVWRUxPUEVSU0ZVTkQgPSBTYWZlTWF0aC5hZGQoREVWRUxPUEVSU0ZVTkQsIGRldmVsb3BlcnNDdXQpOwoKCQkJRU9TQmV0QmFua3JvbGxJbnRlcmZhY2UoQkFOS1JPTExFUikucmVjZWl2ZUV0aGVyRnJvbUdhbWVBZGRyZXNzLnZhbHVlKFNhZmVNYXRoLnN1YihkYXRhLmV0aGVyUmVjZWl2ZWQsIGRldmVsb3BlcnNDdXQpKSgpOwoKCQkJLy8gZ2V0IHRoZSBldGhlciB0byBiZSBwYWlkIG91dCwgYW5kIGZvcmNlIHRoZSBiYW5rcm9sbGVyIGNvbnRyYWN0IHRvIHBheSBvdXQgdGhlIHBsYXllcgoJCQl1aW50MjU2IGV0aGVyUGFpZG91dCA9IFNhZmVNYXRoLm11bCgoZGF0YS5ldGhlclJlY2VpdmVkIC8gZGF0YS5jcmVkaXRzKSwgcGF5b3V0KTsKCgkJCUVPU0JldEJhbmtyb2xsSW50ZXJmYWNlKEJBTktST0xMRVIpLnBheUV0aGVyVG9XaW5uZXIoZXRoZXJQYWlkb3V0LCBkYXRhLnBsYXllcik7CgoJCQkvLyBsb2cgZW4gZXZlbnQgd2l0aCBpbmRleGVkIHF1ZXJ5IGlkCgkJCWVtaXQgU2xvdHNMYXJnZUJldChfcXVlcnlJZCwgbG9nc0RhdGFbMF0sIGxvZ3NEYXRhWzFdLCBsb2dzRGF0YVsyXSwgbG9nc0RhdGFbM10sIGxvZ3NEYXRhWzRdLCBsb2dzRGF0YVs1XSwgbG9nc0RhdGFbNl0sIGxvZ3NEYXRhWzddKTsKCQl9Cgl9CgkKCS8vIEhFTFBFUiBGVU5DVElPTlMgVE86CgkvLyBjYWxjdWxhdGUgdGhlIHJlc3VsdCBvZiB0aGUgZGlhbHMgYmFzZWQgb24gdGhlIGhhcmRjb2RlZCBzbG90IGRhdGE6IAoKCS8vIFNUT1BTCQkJUkVFTCMxCVJFRUwjMglSRUVMIzMKCS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCS8vIGdvbGQgZXRoZXIgCTAgLy8gIDEgIC8vICAzICAgLy8gICAxICAvLwkKCS8vIHNpbHZlciBldGhlciAxIC8vICA3ICAvLyAgMSAgIC8vICAgNiAgLy8KCS8vIGJyb256ZSBldGhlciAyIC8vICAxICAvLyAgNyAgIC8vICAgNiAgLy8KCS8vIGdvbGQgcGxhbmV0ICAzIC8vICA1ICAvLyAgNyAgIC8vICAgNiAgLy8KCS8vIHNpbHZlcnBsYW5ldCA0IC8vICA5ICAvLyAgNiAgIC8vICAgNyAgLy8KCS8vIGJyb256ZXBsYW5ldCA1IC8vICA5ICAvLyAgOCAgIC8vICAgNiAgLy8KCS8vIC0tLWJsYW5rLS0tICA2IC8vICAzMiAvLyAgMzIgIC8vICAgMzIgLy8KCS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCgkvLyBub3RlIHRoYXQgZGlhbDEgLyAyIC8gMyB3aWxsIGdvIGZyb20gbW9kIDY0IHRvIG1vZCA3IGluIHRoaXMgbWFubmVyCgkKCWZ1bmN0aW9uIGdldERpYWwxVHlwZSh1aW50OCBkaWFsMUxvY2F0aW9uKSBpbnRlcm5hbCBwdXJlIHJldHVybnModWludDgpIHsKCSAgICBpZiAoZGlhbDFMb2NhdGlvbiA9PSAwKSAJCQkJCQkJICAgICAgICB7IHJldHVybiAwOyB9CgkJZWxzZSBpZiAoZGlhbDFMb2NhdGlvbiA+PSAxICYmIGRpYWwxTG9jYXRpb24gPD0gNykgCQkJeyByZXR1cm4gMTsgfQoJCWVsc2UgaWYgKGRpYWwxTG9jYXRpb24gPT0gOCkgCQkJCQkJICAgICAgICB7IHJldHVybiAyOyB9CgkJZWxzZSBpZiAoZGlhbDFMb2NhdGlvbiA+PSA5ICYmIGRpYWwxTG9jYXRpb24gPD0gMTMpIAkJeyByZXR1cm4gMzsgfQoJCWVsc2UgaWYgKGRpYWwxTG9jYXRpb24gPj0gMTQgJiYgZGlhbDFMb2NhdGlvbiA8PSAyMikgCQl7IHJldHVybiA0OyB9CgkJZWxzZSBpZiAoZGlhbDFMb2NhdGlvbiA+PSAyMyAmJiBkaWFsMUxvY2F0aW9uIDw9IDMxKSAJCXsgcmV0dXJuIDU7IH0KCQllbHNlIAkJCQkJCQkJCQkgICAgICAgICAgICAgICAgeyByZXR1cm4gNjsgfQoJfQoJCglmdW5jdGlvbiBnZXREaWFsMlR5cGUodWludDggZGlhbDJMb2NhdGlvbikgaW50ZXJuYWwgcHVyZSByZXR1cm5zKHVpbnQ4KSB7CgkgICAgaWYgKGRpYWwyTG9jYXRpb24gPj0gMCAmJiBkaWFsMkxvY2F0aW9uIDw9IDIpIAkJCQl7IHJldHVybiAwOyB9CgkJZWxzZSBpZiAoZGlhbDJMb2NhdGlvbiA9PSAzKSAJCQkJCQkgICAgICAgIHsgcmV0dXJuIDE7IH0KCQllbHNlIGlmIChkaWFsMkxvY2F0aW9uID49IDQgJiYgZGlhbDJMb2NhdGlvbiA8PSAxMCkJCQl7IHJldHVybiAyOyB9CgkJZWxzZSBpZiAoZGlhbDJMb2NhdGlvbiA+PSAxMSAmJiBkaWFsMkxvY2F0aW9uIDw9IDE3KSAJCXsgcmV0dXJuIDM7IH0KCQllbHNlIGlmIChkaWFsMkxvY2F0aW9uID49IDE4ICYmIGRpYWwyTG9jYXRpb24gPD0gMjMpIAkJeyByZXR1cm4gNDsgfQoJCWVsc2UgaWYgKGRpYWwyTG9jYXRpb24gPj0gMjQgJiYgZGlhbDJMb2NhdGlvbiA8PSAzMSkgCQl7IHJldHVybiA1OyB9CgkJZWxzZSAJCQkJCQkJCQkJICAgICAgICAgICAgICAgIHsgcmV0dXJuIDY7IH0KCX0KCQoJZnVuY3Rpb24gZ2V0RGlhbDNUeXBlKHVpbnQ4IGRpYWwzTG9jYXRpb24pIGludGVybmFsIHB1cmUgcmV0dXJucyh1aW50OCkgewoJICAgIGlmIChkaWFsM0xvY2F0aW9uID09IDApIAkJCQkJCQkgICAgICAgIHsgcmV0dXJuIDA7IH0KCQllbHNlIGlmIChkaWFsM0xvY2F0aW9uID49IDEgJiYgZGlhbDNMb2NhdGlvbiA8PSA2KQkJCXsgcmV0dXJuIDE7IH0KCQllbHNlIGlmIChkaWFsM0xvY2F0aW9uID49IDcgJiYgZGlhbDNMb2NhdGlvbiA8PSAxMikgCQl7IHJldHVybiAyOyB9CgkJZWxzZSBpZiAoZGlhbDNMb2NhdGlvbiA+PSAxMyAmJiBkaWFsM0xvY2F0aW9uIDw9IDE4KQkJeyByZXR1cm4gMzsgfQoJCWVsc2UgaWYgKGRpYWwzTG9jYXRpb24gPj0gMTkgJiYgZGlhbDNMb2NhdGlvbiA8PSAyNSkgCQl7IHJldHVybiA0OyB9CgkJZWxzZSBpZiAoZGlhbDNMb2NhdGlvbiA+PSAyNiAmJiBkaWFsM0xvY2F0aW9uIDw9IDMxKSAJCXsgcmV0dXJuIDU7IH0KCQllbHNlIAkJCQkJCQkJCQkgICAgICAgICAgICAgICAgeyByZXR1cm4gNjsgfQoJfQoJCgkvLyBIRUxQRVIgRlVOQ1RJT04gVE86CgkvLyBkZXRlcm1pbmUgdGhlIHBheW91dCBnaXZlbiBkaWFsIGxvY2F0aW9ucyBiYXNlZCBvbiB0aGlzIHRhYmxlCgkKCS8vIGhhcmRjb2RlZCBwYXlvdXRzIGRhdGE6CgkvLyAJCQlMQU5EUyBPTiAJCQkJLy8JUEFZUyAgLy8KCS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoJLy8gQnJvbnplIEUgLT4gU2lsdmVyIEUgLT4gR29sZCBFCS8vCTUwMDAgIC8vCgkvLyAzeCBHb2xkIEV0aGVyCQkJCQkvLwkxNzc3ICAvLwoJLy8gM3ggU2lsdmVyIEV0aGVyCQkJCQkvLwkyNTAgICAvLwoJLy8gM3ggQnJvbnplIEV0aGVyCQkJCQkvLwkyNTAgICAvLwoJLy8gIDN4IGFueSBFdGhlciAJCQkJCS8vCTk1ICAgIC8vCgkvLyBCcm9uemUgUCAtPiBTaWx2ZXIgUCAtPiBHb2xkIFAJLy8JOTAgICAgLy8KCS8vIDN4IEdvbGQgUGxhbmV0IAkJCQkJLy8JNTAgICAgLy8KCS8vIDN4IFNpbHZlciBQbGFuZXQJCQkJCS8vCTI1ICAgIC8vCgkvLyBBbnkgR29sZCBQICYgU2lsdmVyIFAgJiBCcm9uemUgUCAvLwkyMCAgICAvLwoJLy8gM3ggQnJvbnplIFBsYW5ldAkJCQkJLy8JMTAgICAgLy8KCS8vIEFueSAzIHBsYW5ldCB0eXBlCQkJCS8vCTMgICAgIC8vCgkvLyBBbnkgMyBnb2xkCQkJCQkJLy8JMyAgICAgLy8KCS8vIEFueSAzIHNpbHZlcgkJCQkJCS8vCTIgICAgIC8vCgkvLyBBbnkgMyBicm9uemUJCQkJCQkvLwkyICAgICAvLwoJLy8gQmxhbmssIGJsYW5rLCBibGFuawkJCQkvLwkxICAgICAvLwoJLy8gZWxzZQkJCQkJCQkJLy8gIDAgICAgIC8vCgkvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCQoJZnVuY3Rpb24gZGV0ZXJtaW5lUGF5b3V0KHVpbnQ4IGRpYWwxLCB1aW50OCBkaWFsMiwgdWludDggZGlhbDMpIGludGVybmFsIHB1cmUgcmV0dXJucyh1aW50MjU2KSB7CgkJaWYgKGRpYWwxID09IDYgfHwgZGlhbDIgPT0gNiB8fCBkaWFsMyA9PSA2KXsKCQkJLy8gYWxsIGJsYW5rCgkJCWlmIChkaWFsMSA9PSA2ICYmIGRpYWwyID09IDYgJiYgZGlhbDMgPT0gNikKCQkJCXJldHVybiAxOwoJCX0KCQllbHNlIGlmIChkaWFsMSA9PSA1KXsKCQkJLy8gYnJvbnplIHBsYW5ldCAtPiBzaWx2ZXIgcGxhbmV0IC0+IGdvbGQgcGxhbmV0CgkJCWlmIChkaWFsMiA9PSA0ICYmIGRpYWwzID09IDMpIAoJCQkJcmV0dXJuIDkwOwoKCQkJLy8gb25lIGdvbGQgcGxhbmV0LCBvbmUgc2lsdmVyIHBsYW5ldCwgb25lIGJyb256ZSBwbGFuZXQsIGFueSBvcmRlciEKCQkJLy8gbm90ZTogb3RoZXIgb3JkZXIgY292ZXJlZCBhYm92ZSwgcmV0dXJuIDkwCgkJCWVsc2UgaWYgKGRpYWwyID09IDMgJiYgZGlhbDMgPT0gNCkKCQkJCXJldHVybiAyMDsKCgkJCS8vIGFsbCBicm9uemUgcGxhbmV0IAoJCQllbHNlIGlmIChkaWFsMiA9PSA1ICYmIGRpYWwzID09IDUpIAoJCQkJcmV0dXJuIDEwOwoKCQkJLy8gYW55IHRocmVlIHBsYW5ldCB0eXBlIAoJCQllbHNlIGlmIChkaWFsMiA+PSAzICYmIGRpYWwyIDw9IDUgJiYgZGlhbDMgPj0gMyAmJiBkaWFsMyA8PSA1KQoJCQkJcmV0dXJuIDM7CgoJCQkvLyBhbnkgdGhyZWUgYnJvbnplIAoJCQllbHNlIGlmICgoZGlhbDIgPT0gMiB8fCBkaWFsMiA9PSA1KSAmJiAoZGlhbDMgPT0gMiB8fCBkaWFsMyA9PSA1KSkKCQkJCXJldHVybiAyOwoJCX0KCQllbHNlIGlmIChkaWFsMSA9PSA0KXsKCQkJLy8gYWxsIHNpbHZlciBwbGFuZXQKCQkJaWYgKGRpYWwyID09IDQgJiYgZGlhbDMgPT0gNCkKCQkJCXJldHVybiAyNTsKCgkJCS8vIG9uZSBnb2xkIHBsYW5ldCwgb25lIHNpbHZlciBwbGFuZXQsIG9uZSBicm9uemUgcGxhbmV0LCBhbnkgb3JkZXIhCgkJCWVsc2UgaWYgKChkaWFsMiA9PSAzICYmIGRpYWwzID09IDUpIHx8IChkaWFsMiA9PSA1ICYmIGRpYWwzID09IDMpKQoJCQkJcmV0dXJuIDIwOwoKCQkJLy8gYW55IHRocmVlIHBsYW5ldCB0eXBlIAoJCQllbHNlIGlmIChkaWFsMiA+PSAzICYmIGRpYWwyIDw9IDUgJiYgZGlhbDMgPj0gMyAmJiBkaWFsMyA8PSA1KQoJCQkJcmV0dXJuIDM7CgoJCQkvLyBhbnkgdGhyZWUgc2lsdmVyCgkJCWVsc2UgaWYgKChkaWFsMiA9PSAxIHx8IGRpYWwyID09IDQpICYmIChkaWFsMyA9PSAxIHx8IGRpYWwzID09IDQpKQoJCQkJcmV0dXJuIDI7CgkJfQoJCWVsc2UgaWYgKGRpYWwxID09IDMpewoJCQkvLyBhbGwgZ29sZCBwbGFuZXQKCQkJaWYgKGRpYWwyID09IDMgJiYgZGlhbDMgPT0gMykKCQkJCXJldHVybiA1MDsKCgkJCS8vIG9uZSBnb2xkIHBsYW5ldCwgb25lIHNpbHZlciBwbGFuZXQsIG9uZSBicm9uemUgcGxhbmV0LCBhbnkgb3JkZXIhCgkJCWVsc2UgaWYgKChkaWFsMiA9PSA0ICYmIGRpYWwzID09IDUpIHx8IChkaWFsMiA9PSA1ICYmIGRpYWwzID09IDQpKQoJCQkJcmV0dXJuIDIwOwoKCQkJLy8gYW55IHRocmVlIHBsYW5ldCB0eXBlIAoJCQllbHNlIGlmIChkaWFsMiA+PSAzICYmIGRpYWwyIDw9IDUgJiYgZGlhbDMgPj0gMyAmJiBkaWFsMyA8PSA1KQoJCQkJcmV0dXJuIDM7CgoJCQkvLyBhbnkgdGhyZWUgZ29sZAoJCQllbHNlIGlmICgoZGlhbDIgPT0gMCB8fCBkaWFsMiA9PSAzKSAmJiAoZGlhbDMgPT0gMCB8fCBkaWFsMyA9PSAzKSkKCQkJCXJldHVybiAzOwoJCX0KCQllbHNlIGlmIChkaWFsMSA9PSAyKXsKCQkJaWYgKGRpYWwyID09IDEgJiYgZGlhbDMgPT0gMCkKCQkJCXJldHVybiA1MDAwOyAvLyBqYWNrcG90ISEhIQoKCQkJLy8gYWxsIGJyb256ZSBldGhlcgoJCQllbHNlIGlmIChkaWFsMiA9PSAyICYmIGRpYWwzID09IDIpCgkJCQlyZXR1cm4gMjUwOwoKCQkJLy8gYWxsIHNvbWUgdHlwZSBvZiBldGhlcgoJCQllbHNlIGlmIChkaWFsMiA+PSAwICYmIGRpYWwyIDw9IDIgJiYgZGlhbDMgPj0gMCAmJiBkaWFsMyA8PSAyKQoJCQkJcmV0dXJuIDk1OwoKCQkJLy8gYW55IHRocmVlIGJyb256ZQoJCQllbHNlIGlmICgoZGlhbDIgPT0gMiB8fCBkaWFsMiA9PSA1KSAmJiAoZGlhbDMgPT0gMiB8fCBkaWFsMyA9PSA1KSkKCQkJCXJldHVybiAyOwoJCX0KCQllbHNlIGlmIChkaWFsMSA9PSAxKXsKCQkJLy8gYWxsIHNpbHZlciBldGhlciAKCQkJaWYgKGRpYWwyID09IDEgJiYgZGlhbDMgPT0gMSkKCQkJCXJldHVybiAyNTA7CgoJCQkvLyBhbGwgc29tZSB0eXBlIG9mIGV0aGVyCgkJCWVsc2UgaWYgKGRpYWwyID49IDAgJiYgZGlhbDIgPD0gMiAmJiBkaWFsMyA+PSAwICYmIGRpYWwzIDw9IDIpCgkJCQlyZXR1cm4gOTU7CgoJCQkvLyBhbnkgdGhyZWUgc2lsdmVyCgkJCWVsc2UgaWYgKChkaWFsMiA9PSAxIHx8IGRpYWwyID09IDQpICYmIChkaWFsMyA9PSAxIHx8IGRpYWwzID09IDQpKQoJCQkJcmV0dXJuIDM7CgkJfQoJCWVsc2UgaWYgKGRpYWwxID09IDApewoJCQkvLyBhbGwgZ29sZCBldGhlcgoJCQlpZiAoZGlhbDIgPT0gMCAmJiBkaWFsMyA9PSAwKQoJCQkJcmV0dXJuIDE3Nzc7CgoJCQkvLyBhbGwgc29tZSB0eXBlIG9mIGV0aGVyCgkJCWVsc2UgaWYgKGRpYWwyID49IDAgJiYgZGlhbDIgPD0gMiAmJiBkaWFsMyA+PSAwICYmIGRpYWwzIDw9IDIpCgkJCQlyZXR1cm4gOTU7CgoJCQkvLyBhbnkgdGhyZWUgZ29sZAoJCQllbHNlIGlmICgoZGlhbDIgPT0gMCB8fCBkaWFsMiA9PSAzKSAmJiAoZGlhbDMgPT0gMCB8fCBkaWFsMyA9PSAzKSkKCQkJCXJldHVybiAzOwoJCX0KCQlyZXR1cm4gMDsKCX0KCn0='.
	

]
