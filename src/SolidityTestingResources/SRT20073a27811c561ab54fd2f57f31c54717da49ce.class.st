Class {
	#name : #SRT20073a27811c561ab54fd2f57f31c54717da49ce,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT20073a27811c561ab54fd2f57f31c54717da49ce >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7Cgpjb250cmFjdCBTYWZlTWF0aCB7CgogICAgZnVuY3Rpb24gc2FmZU11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiApIHsKICAgICAgICB1aW50MjU2IGMgPSBhICogYjsKICAgICAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIHNhZmVEaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgKSB7CiAgICAgICAgYXNzZXJ0KGIgPiAwKTsKICAgICAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgICAgICBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICBmdW5jdGlvbiBzYWZlU3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2ICkgewogICAgICAgIGFzc2VydChiIDw9IGEpOwogICAgICAgIHJldHVybiBhIC0gYjsKICAgIH0KCiAgICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2ICkgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgICAgIGFzc2VydChjID49IGEpOwogICAgICAgIHJldHVybiBjOwogICAgfQp9Cgpjb250cmFjdCBFUkMyMCB7CgogICAgLyogVGhpcyBpcyBhIHNsaWdodCBjaGFuZ2UgdG8gdGhlIEVSQzIwIGJhc2Ugc3RhbmRhcmQuCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgc3VwcGx5KTsKICAgIGlzIHJlcGxhY2VkIHdpdGg6CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICAgIFRoaXMgYXV0b21hdGljYWxseSBjcmVhdGVzIGEgZ2V0dGVyIGZ1bmN0aW9uIGZvciB0aGUgdG90YWxTdXBwbHkuCiAgICBUaGlzIGlzIG1vdmVkIHRvIHRoZSBiYXNlIGNvbnRyYWN0IHNpbmNlIHB1YmxpYyBnZXR0ZXIgZnVuY3Rpb25zIGFyZSBub3QKICAgIGN1cnJlbnRseSByZWNvZ25pc2VkIGFzIGFuIGltcGxlbWVudGF0aW9uIG9mIHRoZSBtYXRjaGluZyBhYnN0cmFjdAogICAgZnVuY3Rpb24gYnkgdGhlIGNvbXBpbGVyLgogICAgKi8KICAgIC8vLyB0b3RhbCBhbW91bnQgb2YgdG9rZW5zCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBmcm9tIHdoaWNoIHRoZSBiYWxhbmNlIHdpbGwgYmUgcmV0cmlldmVkCiAgICAvLy8gQHJldHVybiBUaGUgYmFsYW5jZQogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwoKICAgIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgbXNnLnNlbmRlcmAKICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQKICAgIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQKICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIHRyYW5zZmVyIHdhcyBzdWNjZXNzZnVsIG9yIG5vdAogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgX2Zyb21gIG9uIHRoZSBjb25kaXRpb24gaXQgaXMgYXBwcm92ZWQgYnkgYF9mcm9tYAogICAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyCiAgICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8vIEBub3RpY2UgYG1zZy5zZW5kZXJgIGFwcHJvdmVzIGBfc3BlbmRlcmAgdG8gc3BlbmQgYF92YWx1ZWAgdG9rZW5zCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2VucwogICAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgYXBwcm92ZWQgZm9yIHRyYW5zZmVyCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBhcHByb3ZhbCB3YXMgc3VjY2Vzc2Z1bCBvciBub3QKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgb3duaW5nIHRva2VucwogICAgLy8vIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBhYmxlIHRvIHRyYW5zZmVyIHRoZSB0b2tlbnMKICAgIC8vLyBAcmV0dXJuIEFtb3VudCBvZiByZW1haW5pbmcgdG9rZW5zIGFsbG93ZWQgdG8gc3BlbnQKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOwoKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7Cn0KCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIFNhZmVNYXRoIHsKCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwoKICAgIC8vLyBAZGV2IFJldHVybnMgbnVtYmVyIG9mIHRva2VucyBvd25lZCBieSBnaXZlbiBhZGRyZXNzLgogICAgLy8vIEBwYXJhbSBfb3duZXIgQWRkcmVzcyBvZiB0b2tlbiBvd25lci4KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9CgogICAgLy8vIEBkZXYgVHJhbnNmZXJzIHNlbmRlcidzIHRva2VucyB0byBhIGdpdmVuIGFkZHJlc3MuIFJldHVybnMgc3VjY2Vzcy4KICAgIC8vLyBAcGFyYW0gX3RvIEFkZHJlc3Mgb2YgdG9rZW4gcmVjZWl2ZXIuCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBOdW1iZXIgb2YgdG9rZW5zIHRvIHRyYW5zZmVyLgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYgKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gc2FmZVN1YihiYWxhbmNlc1ttc2cuc2VuZGVyXSwgX3ZhbHVlKTsKICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSA9IHNhZmVBZGQoYmFsYW5jZXNbX3RvXSwgX3ZhbHVlKTsKICAgICAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyBhbGxvd2VkIHRoaXJkIHBhcnR5IHRvIHRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIuIFJldHVybnMgc3VjY2Vzcy4KICAgIC8vLyBAcGFyYW0gX2Zyb20gQWRkcmVzcyBmcm9tIHdoZXJlIHRva2VucyBhcmUgd2l0aGRyYXduLgogICAgLy8vIEBwYXJhbSBfdG8gQWRkcmVzcyB0byB3aGVyZSB0b2tlbnMgYXJlIHNlbnQuCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBOdW1iZXIgb2YgdG9rZW5zIHRvIHRyYW5zZmVyLgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW190b10gPSBzYWZlQWRkKGJhbGFuY2VzW190b10sIF92YWx1ZSk7CiAgICAgICAgICAgIGJhbGFuY2VzW19mcm9tXSA9IHNhZmVTdWIoYmFsYW5jZXNbX2Zyb21dLCBfdmFsdWUpOwogICAgICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IHNhZmVTdWIoYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0sIF92YWx1ZSk7CiAgICAgICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLy8vIEBkZXYgU2V0cyBhcHByb3ZlZCBhbW91bnQgb2YgdG9rZW5zIGZvciBzcGVuZGVyLiBSZXR1cm5zIHN1Y2Nlc3MuCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIEFkZHJlc3Mgb2YgYWxsb3dlZCBhY2NvdW50LgogICAgLy8vIEBwYXJhbSBfdmFsdWUgTnVtYmVyIG9mIGFwcHJvdmVkIHRva2Vucy4KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIG51bWJlciBvZiBhbGxvd2VkIHRva2VucyBmb3IgZ2l2ZW4gYWRkcmVzcy4KICAgIC8vLyBAcGFyYW0gX293bmVyIEFkZHJlc3Mgb2YgdG9rZW4gb3duZXIuCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIEFkZHJlc3Mgb2YgdG9rZW4gc3BlbmRlci4KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KfQoKY29udHJhY3QgT3duYWJsZSB7CgogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICBhZGRyZXNzIHB1YmxpYyBwZW5kaW5nT3duZXI7CgogICAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLyBTYWZlIHRyYW5zZmVyIG9mIG93bmVyc2hpcCBpbiAyIHN0ZXBzLiBPbmNlIGNhbGxlZCwgYSBuZXdPd25lciBuZWVkcyB0byBjYWxsIGNsYWltT3duZXJzaGlwKCkgdG8gcHJvdmUgb3duZXJzaGlwLgogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHsKICAgICAgICBwZW5kaW5nT3duZXIgPSBuZXdPd25lcjsKICAgIH0KCiAgICBmdW5jdGlvbiBjbGFpbU93bmVyc2hpcCgpIHsKICAgICAgICBpZiAobXNnLnNlbmRlciA9PSBwZW5kaW5nT3duZXIpIHsKICAgICAgICAgICAgb3duZXIgPSBwZW5kaW5nT3duZXI7CiAgICAgICAgICAgIHBlbmRpbmdPd25lciA9IDA7CiAgICAgICAgfQogICAgfQp9Cgpjb250cmFjdCBNdWx0aU93bmFibGUgewoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgb3duZXJNYXA7CiAgICBhZGRyZXNzW10gcHVibGljIG93bmVyczsKCiAgICBldmVudCBPd25lckFkZGVkKGFkZHJlc3MgaW5kZXhlZCBfbmV3T3duZXIpOwogICAgZXZlbnQgT3duZXJSZW1vdmVkKGFkZHJlc3MgaW5kZXhlZCBfb2xkT3duZXIpOwoKICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgICAgICByZXF1aXJlKGlzT3duZXIobXNnLnNlbmRlcikpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gTXVsdGlPd25hYmxlKCkgewogICAgICAgIC8vIEFkZCBkZWZhdWx0IG93bmVyCiAgICAgICAgYWRkcmVzcyBvd25lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgb3duZXJNYXBbb3duZXJdID0gdHJ1ZTsKICAgICAgICBvd25lcnMucHVzaChvd25lcik7CiAgICB9CgogICAgZnVuY3Rpb24gb3duZXJDb3VudCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIG93bmVycy5sZW5ndGg7CiAgICB9CgogICAgZnVuY3Rpb24gaXNPd25lcihhZGRyZXNzIG93bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBvd25lck1hcFtvd25lcl07CiAgICB9CgogICAgZnVuY3Rpb24gYWRkT3duZXIoYWRkcmVzcyBvd25lcikgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAoIWlzT3duZXIob3duZXIpICYmIG93bmVyICE9IDApIHsKICAgICAgICAgICAgb3duZXJNYXBbb3duZXJdID0gdHJ1ZTsKICAgICAgICAgICAgb3duZXJzLnB1c2gob3duZXIpOwoKICAgICAgICAgICAgT3duZXJBZGRlZChvd25lcik7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgZnVuY3Rpb24gcmVtb3ZlT3duZXIoYWRkcmVzcyBvd25lcikgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAoaXNPd25lcihvd25lcikpIHsKICAgICAgICAgICAgb3duZXJNYXBbb3duZXJdID0gZmFsc2U7CiAgICAgICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IG93bmVycy5sZW5ndGggLSAxOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmIChvd25lcnNbaV0gPT0gb3duZXIpIHsKICAgICAgICAgICAgICAgICAgICBvd25lcnNbaV0gPSBvd25lcnNbb3duZXJzLmxlbmd0aCAtIDFdOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIG93bmVycy5sZW5ndGggLT0gMTsKCiAgICAgICAgICAgIE93bmVyUmVtb3ZlZChvd25lcik7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSByZXR1cm4gZmFsc2U7CiAgICB9Cn0KCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgewoKICAgIGJvb2wgcHVibGljIHBhdXNlZDsKCiAgICBtb2RpZmllciBpZk5vdFBhdXNlZCB7CiAgICAgICAgcmVxdWlyZSghcGF1c2VkKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIGlmUGF1c2VkIHsKICAgICAgICByZXF1aXJlKHBhdXNlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLyBDYWxsZWQgYnkgdGhlIG93bmVyIG9uIGVtZXJnZW5jeSwgdHJpZ2dlcnMgcGF1c2VkIHN0YXRlCiAgICBmdW5jdGlvbiBwYXVzZSgpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgcGF1c2VkID0gdHJ1ZTsKICAgIH0KCiAgICAvLyBDYWxsZWQgYnkgdGhlIG93bmVyIG9uIGVuZCBvZiBlbWVyZ2VuY3ksIHJldHVybnMgdG8gbm9ybWFsIHN0YXRlCiAgICBmdW5jdGlvbiByZXN1bWUoKSBleHRlcm5hbCBvbmx5T3duZXIgaWZQYXVzZWQgewogICAgICAgIHBhdXNlZCA9IGZhbHNlOwogICAgfQp9Cgpjb250cmFjdCBUb2tlblNwZW5kZXIgewogICAgZnVuY3Rpb24gcmVjZWl2ZUFwcHJvdmFsKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlKTsKfQoKY29udHJhY3QgQ29tbW9uQnNUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBNdWx0aU93bmFibGUgewoKICAgIGJvb2wgcHVibGljIGxvY2tlZDsKCiAgICBzdHJpbmcgcHVibGljIG5hbWU7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogICAgdWludDggcHVibGljIGRlY2ltYWxzID0gMTg7CiAgICBzdHJpbmcgcHVibGljIHZlcnNpb24gPSAndjAuMSc7CgogICAgYWRkcmVzcyBwdWJsaWMgY3JlYXRvcjsKICAgIGFkZHJlc3MgcHVibGljIHNlbGxlcjsKICAgIHVpbnQyNTYgcHVibGljIHRva2Vuc1NvbGQ7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFNhbGVzOwoKICAgIGV2ZW50IFNlbGwoYWRkcmVzcyBpbmRleGVkIF9zZWxsZXIsIGFkZHJlc3MgaW5kZXhlZCBfYnV5ZXIsIHVpbnQyNTYgX3ZhbHVlKTsKICAgIGV2ZW50IFNlbGxlckNoYW5nZWQoYWRkcmVzcyBpbmRleGVkIF9vbGRTZWxsZXIsIGFkZHJlc3MgaW5kZXhlZCBfbmV3U2VsbGVyKTsKCiAgICBtb2RpZmllciBvbmx5VW5sb2NrZWQoKSB7CiAgICAgICAgaWYgKCFpc093bmVyKG1zZy5zZW5kZXIpICYmIGxvY2tlZCkgdGhyb3c7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBDb21tb25Cc1Rva2VuKHN0cmluZyBfbmFtZSwgc3RyaW5nIF9zeW1ib2wsIHVpbnQyNTYgX3RvdGFsU3VwcGx5Tm9EZWNpbWFscywgYWRkcmVzcyBfc2VsbGVyKSBNdWx0aU93bmFibGUoKSB7CgogICAgICAgIC8vIExvY2sgdGhlIHRyYW5zZmVyIGZ1bmN0aW9uIGR1cmluZyB0aGUgcHJlc2FsZS9jcm93ZHNhbGUgdG8gcHJldmVudCBzcGVjdWxhdGlvbnMuCiAgICAgICAgbG9ja2VkID0gdHJ1ZTsKCiAgICAgICAgY3JlYXRvciA9IG1zZy5zZW5kZXI7CiAgICAgICAgc2VsbGVyID0gX3NlbGxlcjsKCiAgICAgICAgbmFtZSA9IF9uYW1lOwogICAgICAgIHN5bWJvbCA9IF9zeW1ib2w7CiAgICAgICAgdG90YWxTdXBwbHkgPSBfdG90YWxTdXBwbHlOb0RlY2ltYWxzICogMWUxODsKCiAgICAgICAgYmFsYW5jZXNbc2VsbGVyXSA9IHRvdGFsU3VwcGx5OwogICAgICAgIFRyYW5zZmVyKDB4MCwgc2VsbGVyLCB0b3RhbFN1cHBseSk7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlU2VsbGVyKGFkZHJlc3MgbmV3U2VsbGVyKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUobmV3U2VsbGVyICE9IDB4MCAmJiBzZWxsZXIgIT0gbmV3U2VsbGVyKTsKCiAgICAgICAgYWRkcmVzcyBvbGRTZWxsZXIgPSBzZWxsZXI7CgogICAgICAgIHVpbnQyNTYgdW5zb2xkVG9rZW5zID0gYmFsYW5jZXNbb2xkU2VsbGVyXTsKICAgICAgICBiYWxhbmNlc1tvbGRTZWxsZXJdID0gMDsKICAgICAgICBiYWxhbmNlc1tuZXdTZWxsZXJdID0gc2FmZUFkZChiYWxhbmNlc1tuZXdTZWxsZXJdLCB1bnNvbGRUb2tlbnMpOwogICAgICAgIFRyYW5zZmVyKG9sZFNlbGxlciwgbmV3U2VsbGVyLCB1bnNvbGRUb2tlbnMpOwoKICAgICAgICBzZWxsZXIgPSBuZXdTZWxsZXI7CiAgICAgICAgU2VsbGVyQ2hhbmdlZChvbGRTZWxsZXIsIG5ld1NlbGxlcik7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gc2VsbE5vRGVjaW1hbHMoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHNlbGwoX3RvLCBfdmFsdWUgKiAxZTE4KTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZWxsKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAoYmFsYW5jZXNbc2VsbGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgewogICAgICAgICAgICBiYWxhbmNlc1tzZWxsZXJdID0gc2FmZVN1YihiYWxhbmNlc1tzZWxsZXJdLCBfdmFsdWUpOwogICAgICAgICAgICBiYWxhbmNlc1tfdG9dID0gc2FmZUFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOwogICAgICAgICAgICBUcmFuc2ZlcihzZWxsZXIsIF90bywgX3ZhbHVlKTsKCiAgICAgICAgICAgIHRva2Vuc1NvbGQgPSBzYWZlQWRkKHRva2Vuc1NvbGQsIF92YWx1ZSk7CiAgICAgICAgICAgIHRvdGFsU2FsZXMgPSBzYWZlQWRkKHRvdGFsU2FsZXMsIDEpOwogICAgICAgICAgICBTZWxsKHNlbGxlciwgX3RvLCBfdmFsdWUpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgb25seVVubG9ja2VkIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIG9ubHlVbmxvY2tlZCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGxvY2soKSBvbmx5T3duZXIgewogICAgICAgIGxvY2tlZCA9IHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gdW5sb2NrKCkgb25seU93bmVyIHsKICAgICAgICBsb2NrZWQgPSBmYWxzZTsKICAgIH0KCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYgKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gc2FmZVN1YihiYWxhbmNlc1ttc2cuc2VuZGVyXSwgX3ZhbHVlKSA7CiAgICAgICAgICAgIHRvdGFsU3VwcGx5ID0gc2FmZVN1Yih0b3RhbFN1cHBseSwgX3ZhbHVlKTsKICAgICAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgMHgwLCBfdmFsdWUpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qIEFwcHJvdmUgYW5kIHRoZW4gY29tbXVuaWNhdGUgdGhlIGFwcHJvdmVkIGNvbnRyYWN0IGluIGEgc2luZ2xlIHR4ICovCiAgICBmdW5jdGlvbiBhcHByb3ZlQW5kQ2FsbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgewogICAgICAgIFRva2VuU3BlbmRlciBzcGVuZGVyID0gVG9rZW5TcGVuZGVyKF9zcGVuZGVyKTsKICAgICAgICBpZiAoYXBwcm92ZShfc3BlbmRlciwgX3ZhbHVlKSkgewogICAgICAgICAgICBzcGVuZGVyLnJlY2VpdmVBcHByb3ZhbChtc2cuc2VuZGVyLCBfdmFsdWUpOwogICAgICAgIH0KICAgIH0KfQoKY29udHJhY3QgQ29tbW9uQnNQcmVzYWxlIGlzIFNhZmVNYXRoLCBPd25hYmxlLCBQYXVzYWJsZSB7CgogICAgZW51bSBDdXJyZW5jeSB7IEJUQywgTFRDLCBaRUMsIERBU0gsIFdBVkVTLCBVU0QsIEVVUiB9CgogICAgLy8gVE9ETyByZW5hbWUgdG8gQnV5ZXI/CgogICAgc3RydWN0IEJhY2tlciB7CiAgICAgICAgdWludDI1NiB3ZWlSZWNlaXZlZDsgLy8gQW1vdW50IG9mIHdlaSBnaXZlbiBieSBiYWNrZXIKICAgICAgICB1aW50MjU2IHRva2Vuc1NlbnQ7ICAvLyBBbW91bnQgb2YgdG9rZW5zIHJlY2VpdmVkIGluIHJldHVybiB0byB0aGUgZ2l2ZW4gYW1vdW50IG9mIEVUSC4KICAgIH0KCiAgICAvLyBUT0RPIHJlbmFtZSB0byBidXllcnM/CgogICAgLy8gKGJ1eWVyX2V0aF9hZGRyZXNzIC0+IHN0cnVjdCkKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBCYWNrZXIpIHB1YmxpYyBiYWNrZXJzOwoKICAgIC8vIGN1cnJlbmN5X2NvZGUgPT4gKHR4X2hhc2ggPT4gdG9rZW5zKQogICAgbWFwcGluZyh1aW50OCA9PiBtYXBwaW5nKGJ5dGVzMzIgPT4gdWludDI1NikpIHB1YmxpYyBleHRlcm5hbFR4czsKCiAgICBDb21tb25Cc1Rva2VuIHB1YmxpYyB0b2tlbjsgLy8gVG9rZW4gY29udHJhY3QgcmVmZXJlbmNlLgogICAgYWRkcmVzcyBwdWJsaWMgYmVuZWZpY2lhcnk7IC8vIEFkZHJlc3MgdGhhdCB3aWxsIHJlY2VpdmUgRVRIIHJhaXNlZCBkdXJpbmcgdGhpcyBjcm93ZHNhbGUuCiAgICBhZGRyZXNzIHB1YmxpYyBub3RpZmllcjsgICAgLy8gQWRkcmVzcyB0aGF0IGNhbiB0aGlzIGNyb3dkc2FsZSBhYm91dCBjaGFuZ2VkIGV4dGVybmFsIGNvbmRpdGlvbnMuCgogICAgdWludDI1NiBwdWJsaWMgbWluVG9rZW5zVG9CdXkgPSA1MCAqIDFlMTg7IC8vIEluY2x1ZGluZyBib251c2VzLgogICAgdWludDI1NiBwdWJsaWMgbWF4Q2FwV2VpICAgICAgPSA1MDAwMCBldGhlcjsKCiAgICB1aW50IHB1YmxpYyB0b2tlbnNQZXJXZWkgICAgICAgICA9IDEwMDA7IC8vIE9yZGluYXJ5IHByaWNlOiAxIEVUSCA9IDEwMDAgdG9rZW5zLgogICAgdWludCBwdWJsaWMgdG9rZW5zUGVyV2VpQm9udXMzMzMgPSAxMzMzOwogICAgdWludCBwdWJsaWMgdG9rZW5zUGVyV2VpQm9udXMyNTAgPSAxMjUwOwogICAgdWludCBwdWJsaWMgdG9rZW5zUGVyV2VpQm9udXMxMTEgPSAxMTExOwoKICAgIHVpbnQgcHVibGljIHN0YXJ0VGltZSAgICAgICA9IDE1MTAxNjA3MDA7IC8vIDIwMTctMTEtMDhUMTc6MDU6MDBaCiAgICB1aW50IHB1YmxpYyBib251c0VuZFRpbWUzMzMgPSAxNTEwMzMzNTAwOyAvLyAyMDE3LTExLTEwVDE3OjA1OjAwWgogICAgdWludCBwdWJsaWMgYm9udXNFbmRUaW1lMjUwID0gMTUxMDY3OTEwMDsgLy8gMjAxNy0xMS0xNFQxNzowNTowMFoKICAgIHVpbnQgcHVibGljIGVuZFRpbWUgICAgICAgICA9IDE1MTEwMjQ3MDA7IC8vIDIwMTctMTEtMThUMTc6MDU6MDBaCgogICAgLy8gU3RhdHMgZm9yIGN1cnJlbnQgY3Jvd2RzYWxlCgogICAgLy8gVE9ETyByZW5hbWUgdG8gJ3RvdGFsSW5XZWknCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFdlaSAgICAgICAgICAgPSAwOyAvLyBHcmFuZCB0b3RhbCBpbiB3ZWkKCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFRva2Vuc1NvbGQgICAgPSAwOyAvLyBUb3RhbCBhbW91bnQgb2YgdG9rZW5zIHNvbGQgZHVyaW5nIHRoaXMgY3Jvd2RzYWxlLgogICAgdWludDI1NiBwdWJsaWMgdG90YWxFdGhTYWxlcyAgICAgID0gMDsgLy8gVG90YWwgYW1vdW50IG9mIEVUSCBjb250cmlidXRpb25zIGR1cmluZyB0aGlzIGNyb3dkc2FsZS4KICAgIHVpbnQyNTYgcHVibGljIHRvdGFsRXh0ZXJuYWxTYWxlcyA9IDA7IC8vIFRvdGFsIGFtb3VudCBvZiBleHRlcm5hbCBjb250cmlidXRpb25zIChCVEMsIExUQywgVVNELCBldGMuKSBkdXJpbmcgdGhpcyBjcm93ZHNhbGUuCiAgICB1aW50MjU2IHB1YmxpYyB3ZWlSZWNlaXZlZCAgICAgICAgPSAwOyAvLyBUb3RhbCBhbW91bnQgb2Ygd2VpIHJlY2VpdmVkIGR1cmluZyB0aGlzIGNyb3dkc2FsZSBzbWFydCBjb250cmFjdC4KCiAgICB1aW50IHB1YmxpYyBmaW5hbGl6ZWRUaW1lID0gMDsgLy8gVW5peCB0aW1lc3RhbXAgd2hlbiBmaW5hbGl6ZSgpIHdhcyBjYWxsZWQuCgogICAgYm9vbCBwdWJsaWMgc2FsZUVuYWJsZWQgPSB0cnVlOyAgIC8vIGlmIGZhbHNlLCB0aGVuIGNvbnRyYWN0IHdpbGwgbm90IHNlbGwgdG9rZW5zIG9uIHBheW1lbnQgcmVjZWl2ZWQKCiAgICBldmVudCBCZW5lZmljaWFyeUNoYW5nZWQoYWRkcmVzcyBpbmRleGVkIF9vbGRBZGRyZXNzLCBhZGRyZXNzIGluZGV4ZWQgX25ld0FkZHJlc3MpOwogICAgZXZlbnQgTm90aWZpZXJDaGFuZ2VkKGFkZHJlc3MgaW5kZXhlZCBfb2xkQWRkcmVzcywgYWRkcmVzcyBpbmRleGVkIF9uZXdBZGRyZXNzKTsKCiAgICBldmVudCBFdGhSZWNlaXZlZChhZGRyZXNzIGluZGV4ZWQgX2J1eWVyLCB1aW50MjU2IF9hbW91bnRXZWkpOwogICAgZXZlbnQgRXh0ZXJuYWxTYWxlU2hhMyhDdXJyZW5jeSBfY3VycmVuY3ksIGJ5dGVzMzIgX3R4SWRTaGEzLCBhZGRyZXNzIGluZGV4ZWQgX2J1eWVyLCB1aW50MjU2IF9hbW91bnRXZWksIHVpbnQyNTYgX3Rva2Vuc0UxOCk7CgogICAgbW9kaWZpZXIgcmVzcGVjdFRpbWVGcmFtZSgpIHsKICAgICAgICByZXF1aXJlKGlzU2FsZU9uKCkpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgY2FuTm90aWZ5KCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lciB8fCBtc2cuc2VuZGVyID09IG5vdGlmaWVyKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIENvbW1vbkJzUHJlc2FsZShhZGRyZXNzIF90b2tlbiwgYWRkcmVzcyBfYmVuZWZpY2lhcnkpIHsKICAgICAgICB0b2tlbiA9IENvbW1vbkJzVG9rZW4oX3Rva2VuKTsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgbm90aWZpZXIgPSBvd25lcjsKICAgICAgICBiZW5lZmljaWFyeSA9IF9iZW5lZmljaWFyeTsKICAgIH0KCiAgICAvLyBPdmVycmlkZSB0aGlzIG1ldGhvZCB0byBtb2NrIGN1cnJlbnQgdGltZS4KICAgIGZ1bmN0aW9uIGdldE5vdygpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIG5vdzsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRTYWxlRW5hYmxlZChib29sIF9lbmFibGVkKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBzYWxlRW5hYmxlZCA9IF9lbmFibGVkOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEJlbmVmaWNpYXJ5KGFkZHJlc3MgX2JlbmVmaWNpYXJ5KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBCZW5lZmljaWFyeUNoYW5nZWQoYmVuZWZpY2lhcnksIF9iZW5lZmljaWFyeSk7CiAgICAgICAgYmVuZWZpY2lhcnkgPSBfYmVuZWZpY2lhcnk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0Tm90aWZpZXIoYWRkcmVzcyBfbm90aWZpZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIE5vdGlmaWVyQ2hhbmdlZChub3RpZmllciwgX25vdGlmaWVyKTsKICAgICAgICBub3RpZmllciA9IF9ub3RpZmllcjsKICAgIH0KCiAgICAvKgogICAgICogVGhlIGZhbGxiYWNrIGZ1bmN0aW9uIGNvcnJlc3BvbmRzIHRvIGEgZG9uYXRpb24gaW4gRVRICiAgICAgKi8KICAgIGZ1bmN0aW9uKCkgcHVibGljIHBheWFibGUgewogICAgICAgIGlmIChzYWxlRW5hYmxlZCkgc2VsbFRva2Vuc0ZvckV0aChtc2cuc2VuZGVyLCBtc2cudmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNlbGxUb2tlbnNGb3JFdGgoYWRkcmVzcyBfYnV5ZXIsIHVpbnQyNTYgX2Ftb3VudFdlaSkgaW50ZXJuYWwgaWZOb3RQYXVzZWQgcmVzcGVjdFRpbWVGcmFtZSB7CgogICAgICAgIHRvdGFsV2VpID0gc2FmZUFkZCh0b3RhbFdlaSwgX2Ftb3VudFdlaSk7CiAgICAgICAgd2VpUmVjZWl2ZWQgPSBzYWZlQWRkKHdlaVJlY2VpdmVkLCBfYW1vdW50V2VpKTsKICAgICAgICByZXF1aXJlKHRvdGFsV2VpIDw9IG1heENhcFdlaSk7IC8vIElmIG1heCBjYXAgcmVhY2hlZC4KCiAgICAgICAgdWludDI1NiB0b2tlbnNFMTggPSB3ZWlUb1Rva2VucyhfYW1vdW50V2VpKTsKICAgICAgICByZXF1aXJlKHRva2Vuc0UxOCA+PSBtaW5Ub2tlbnNUb0J1eSk7CgogICAgICAgIHJlcXVpcmUodG9rZW4uc2VsbChfYnV5ZXIsIHRva2Vuc0UxOCkpOyAvLyBUcmFuc2ZlciB0b2tlbnMgdG8gYnV5ZXIuCiAgICAgICAgdG90YWxUb2tlbnNTb2xkID0gc2FmZUFkZCh0b3RhbFRva2Vuc1NvbGQsIHRva2Vuc0UxOCk7CiAgICAgICAgdG90YWxFdGhTYWxlcysrOwoKICAgICAgICBCYWNrZXIgYmFja2VyID0gYmFja2Vyc1tfYnV5ZXJdOwogICAgICAgIGJhY2tlci50b2tlbnNTZW50ID0gc2FmZUFkZChiYWNrZXIudG9rZW5zU2VudCwgdG9rZW5zRTE4KTsKICAgICAgICBiYWNrZXIud2VpUmVjZWl2ZWQgPSBzYWZlQWRkKGJhY2tlci53ZWlSZWNlaXZlZCwgX2Ftb3VudFdlaSk7ICAvLyBVcGRhdGUgdGhlIHRvdGFsIHdlaSBjb2xsZWN0ZWQgZHVyaW5nIHRoZSBjcm93ZGZ1bmRpbmcgZm9yIHRoaXMgYmFja2VyCgogICAgICAgIEV0aFJlY2VpdmVkKF9idXllciwgX2Ftb3VudFdlaSk7CiAgICB9CgogICAgLy8gQ2FsYyBob3cgbXVjaCB0b2tlbnMgeW91IGNhbiBidXkgYXQgY3VycmVudCB0aW1lLgogICAgZnVuY3Rpb24gd2VpVG9Ub2tlbnModWludDI1NiBfYW1vdW50V2VpKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiB3ZWlUb1Rva2Vuc0F0VGltZShfYW1vdW50V2VpLCBnZXROb3coKSk7CiAgICB9CgogICAgZnVuY3Rpb24gd2VpVG9Ub2tlbnNBdFRpbWUodWludDI1NiBfYW1vdW50V2VpLCB1aW50IF90aW1lKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgcmF0ZSA9IHRva2Vuc1BlcldlaTsKCiAgICAgICAgaWYgKHN0YXJ0VGltZSA8PSBfdGltZSAmJiBfdGltZSA8IGJvbnVzRW5kVGltZTMzMykgcmF0ZSA9IHRva2Vuc1BlcldlaUJvbnVzMzMzOwogICAgICAgIGVsc2UgaWYgKGJvbnVzRW5kVGltZTMzMyA8PSBfdGltZSAmJiBfdGltZSA8IGJvbnVzRW5kVGltZTI1MCkgcmF0ZSA9IHRva2Vuc1BlcldlaUJvbnVzMjUwOwogICAgICAgIGVsc2UgaWYgKGJvbnVzRW5kVGltZTI1MCA8PSBfdGltZSAmJiBfdGltZSA8IGVuZFRpbWUpIHJhdGUgPSB0b2tlbnNQZXJXZWlCb251czExMTsKCiAgICAgICAgcmV0dXJuIHNhZmVNdWwoX2Ftb3VudFdlaSwgcmF0ZSk7CiAgICB9CgogICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyBCZWdpbiBvZiBleHRlcm5hbCBzYWxlcy4KCiAgICBmdW5jdGlvbiBleHRlcm5hbFNhbGVzKAogICAgICAgIHVpbnQ4W10gX2N1cnJlbmNpZXMsCiAgICAgICAgYnl0ZXMzMltdIF90eElkU2hhMywKICAgICAgICBhZGRyZXNzW10gX2J1eWVycywKICAgICAgICB1aW50MjU2W10gX2Ftb3VudHNXZWksCiAgICAgICAgdWludDI1NltdIF90b2tlbnNFMTgKICAgICkgcHVibGljIGlmTm90UGF1c2VkIGNhbk5vdGlmeSB7CgogICAgICAgIHJlcXVpcmUoX2N1cnJlbmNpZXMubGVuZ3RoID4gMCk7CiAgICAgICAgcmVxdWlyZShfY3VycmVuY2llcy5sZW5ndGggPT0gX3R4SWRTaGEzLmxlbmd0aCk7CiAgICAgICAgcmVxdWlyZShfY3VycmVuY2llcy5sZW5ndGggPT0gX2J1eWVycy5sZW5ndGgpOwogICAgICAgIHJlcXVpcmUoX2N1cnJlbmNpZXMubGVuZ3RoID09IF9hbW91bnRzV2VpLmxlbmd0aCk7CiAgICAgICAgcmVxdWlyZShfY3VycmVuY2llcy5sZW5ndGggPT0gX3Rva2Vuc0UxOC5sZW5ndGgpOwoKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBfdHhJZFNoYTMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgX2V4dGVybmFsU2FsZVNoYTMoCiAgICAgICAgICAgICAgICBDdXJyZW5jeShfY3VycmVuY2llc1tpXSksCiAgICAgICAgICAgICAgICBfdHhJZFNoYTNbaV0sCiAgICAgICAgICAgICAgICBfYnV5ZXJzW2ldLAogICAgICAgICAgICAgICAgX2Ftb3VudHNXZWlbaV0sCiAgICAgICAgICAgICAgICBfdG9rZW5zRTE4W2ldCiAgICAgICAgICAgICk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIF9leHRlcm5hbFNhbGVTaGEzKAogICAgICAgIEN1cnJlbmN5IF9jdXJyZW5jeSwKICAgICAgICBieXRlczMyIF90eElkU2hhMywgLy8gVG8gZ2V0IGJ5dGVzMzIgdXNlIGtlY2NhazI1Nih0eElkKSBPUiBzaGEzKHR4SWQpCiAgICAgICAgYWRkcmVzcyBfYnV5ZXIsCiAgICAgICAgdWludDI1NiBfYW1vdW50V2VpLAogICAgICAgIHVpbnQyNTYgX3Rva2Vuc0UxOAogICAgKSBpbnRlcm5hbCB7CgogICAgICAgIHJlcXVpcmUoX2J1eWVyID4gMCAmJiBfYW1vdW50V2VpID4gMCAmJiBfdG9rZW5zRTE4ID4gMCk7CgogICAgICAgIHZhciB0eHNCeUN1ciA9IGV4dGVybmFsVHhzW3VpbnQ4KF9jdXJyZW5jeSldOwoKICAgICAgICAvLyBJZiB0aGlzIGZvcmVpZ24gdHJhbnNhY3Rpb24gaGFzIGJlZW4gYWxyZWFkeSBwcm9jZXNzZWQgaW4gdGhpcyBjb250cmFjdC4KICAgICAgICByZXF1aXJlKHR4c0J5Q3VyW190eElkU2hhM10gPT0gMCk7CgogICAgICAgIHRvdGFsV2VpID0gc2FmZUFkZCh0b3RhbFdlaSwgX2Ftb3VudFdlaSk7CiAgICAgICAgcmVxdWlyZSh0b3RhbFdlaSA8PSBtYXhDYXBXZWkpOyAvLyBNYXggY2FwIHNob3VsZCBub3QgYmUgcmVhY2hlZCB5ZXQuCgogICAgICAgIHJlcXVpcmUodG9rZW4uc2VsbChfYnV5ZXIsIF90b2tlbnNFMTgpKTsgLy8gVHJhbnNmZXIgdG9rZW5zIHRvIGJ1eWVyLgogICAgICAgIHRvdGFsVG9rZW5zU29sZCA9IHNhZmVBZGQodG90YWxUb2tlbnNTb2xkLCBfdG9rZW5zRTE4KTsKICAgICAgICB0b3RhbEV4dGVybmFsU2FsZXMrKzsKCiAgICAgICAgdHhzQnlDdXJbX3R4SWRTaGEzXSA9IF90b2tlbnNFMTg7CiAgICAgICAgRXh0ZXJuYWxTYWxlU2hhMyhfY3VycmVuY3ksIF90eElkU2hhMywgX2J1eWVyLCBfYW1vdW50V2VpLCBfdG9rZW5zRTE4KTsKICAgIH0KCiAgICAvLyBHZXQgaWQgb2YgY3VycmVuY3kgZW51bS4gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBmdW5jdGlvbiBidGNJZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50OCkgewogICAgICAgIHJldHVybiB1aW50OChDdXJyZW5jeS5CVEMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGx0Y0lkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgcmV0dXJuIHVpbnQ4KEN1cnJlbmN5LkxUQyk7CiAgICB9CgogICAgZnVuY3Rpb24gemVjSWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gdWludDgoQ3VycmVuY3kuWkVDKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkYXNoSWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gdWludDgoQ3VycmVuY3kuREFTSCk7CiAgICB9CgogICAgZnVuY3Rpb24gd2F2ZXNJZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50OCkgewogICAgICAgIHJldHVybiB1aW50OChDdXJyZW5jeS5XQVZFUyk7CiAgICB9CgogICAgZnVuY3Rpb24gdXNkSWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gdWludDgoQ3VycmVuY3kuVVNEKTsKICAgIH0KCiAgICBmdW5jdGlvbiBldXJJZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50OCkgewogICAgICAgIHJldHVybiB1aW50OChDdXJyZW5jeS5FVVIpOwogICAgfQoKICAgIC8vIEdldCB0b2tlbiBjb3VudCBieSB0cmFuc2FjdGlvbiBpZC4gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIGZ1bmN0aW9uIF90b2tlbnNCeVR4KEN1cnJlbmN5IF9jdXJyZW5jeSwgc3RyaW5nIF90eElkKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHRva2Vuc0J5VHgodWludDgoX2N1cnJlbmN5KSwgX3R4SWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRva2Vuc0J5VHgodWludDggX2N1cnJlbmN5LCBzdHJpbmcgX3R4SWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGV4dGVybmFsVHhzW19jdXJyZW5jeV1ba2VjY2FrMjU2KF90eElkKV07CiAgICB9CgogICAgZnVuY3Rpb24gdG9rZW5zQnlCdGNUeChzdHJpbmcgX3R4SWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIF90b2tlbnNCeVR4KEN1cnJlbmN5LkJUQywgX3R4SWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRva2Vuc0J5THRjVHgoc3RyaW5nIF90eElkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBfdG9rZW5zQnlUeChDdXJyZW5jeS5MVEMsIF90eElkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b2tlbnNCeVplY1R4KHN0cmluZyBfdHhJZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gX3Rva2Vuc0J5VHgoQ3VycmVuY3kuWkVDLCBfdHhJZCk7CiAgICB9CgogICAgZnVuY3Rpb24gdG9rZW5zQnlEYXNoVHgoc3RyaW5nIF90eElkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBfdG9rZW5zQnlUeChDdXJyZW5jeS5EQVNILCBfdHhJZCk7CiAgICB9CgogICAgZnVuY3Rpb24gdG9rZW5zQnlXYXZlc1R4KHN0cmluZyBfdHhJZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gX3Rva2Vuc0J5VHgoQ3VycmVuY3kuV0FWRVMsIF90eElkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b2tlbnNCeVVzZFR4KHN0cmluZyBfdHhJZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gX3Rva2Vuc0J5VHgoQ3VycmVuY3kuVVNELCBfdHhJZCk7CiAgICB9CgogICAgZnVuY3Rpb24gdG9rZW5zQnlFdXJUeChzdHJpbmcgX3R4SWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIF90b2tlbnNCeVR4KEN1cnJlbmN5LkVVUiwgX3R4SWQpOwogICAgfQoKICAgIC8vIEVuZCBvZiBleHRlcm5hbCBzYWxlcy4KICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIGZ1bmN0aW9uIHRvdGFsU2FsZXMoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBzYWZlQWRkKHRvdGFsRXRoU2FsZXMsIHRvdGFsRXh0ZXJuYWxTYWxlcyk7CiAgICB9CgogICAgZnVuY3Rpb24gaXNNYXhDYXBSZWFjaGVkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gdG90YWxXZWkgPj0gbWF4Q2FwV2VpOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzU2FsZU9uKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICB1aW50IF9ub3cgPSBnZXROb3coKTsKICAgICAgICByZXR1cm4gc3RhcnRUaW1lIDw9IF9ub3cgJiYgX25vdyA8PSBlbmRUaW1lOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzU2FsZU92ZXIoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBnZXROb3coKSA+IGVuZFRpbWU7CiAgICB9CgogICAgZnVuY3Rpb24gaXNGaW5hbGl6ZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBmaW5hbGl6ZWRUaW1lID4gMDsKICAgIH0KCiAgICAvKgogICAgICogRmluYWxpemUgdGhlIGNyb3dkc2FsZS4gUmFpc2VkIG1vbmV5IGNhbiBiZSBzZW50IHRvIGJlbmVmaWNpYXJ5IG9ubHkgaWYgY3Jvd2RzYWxlIGhpdCBlbmQgdGltZSBvciBtYXggY2FwICgxNW0gVVNEKS4KICAgICAqLwogICAgZnVuY3Rpb24gZmluYWxpemUoKSBwdWJsaWMgb25seU93bmVyIHsKCiAgICAgICAgLy8gQ2Fubm90IGZpbmFsaXNlIGJlZm9yZSBlbmQgZGF5IG9mIGNyb3dkc2FsZSB1bnRpbCBtYXggY2FwIGlzIHJlYWNoZWQuCiAgICAgICAgcmVxdWlyZShpc01heENhcFJlYWNoZWQoKSB8fCBpc1NhbGVPdmVyKCkpOwoKICAgICAgICBiZW5lZmljaWFyeS50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwoKICAgICAgICBmaW5hbGl6ZWRUaW1lID0gZ2V0Tm93KCk7CiAgICB9Cn0KCmNvbnRyYWN0IEJzUHJlc2FsZSBpcyBDb21tb25Cc1ByZXNhbGUgewoKICAgIGZ1bmN0aW9uIEJzUHJlc2FsZSgpIENvbW1vbkJzUHJlc2FsZSgKICAgICAgICAweDdhYTQzZWY4YWExODI5ZmNlNDIwZmQxZjllNmViYmUyMjEyYjNlMDYsIC8vIFRPRE8gYWRkcmVzcyBfdG9rZW4KICAgICAgICAweDc2Q0E5MTQwNTQwOTg4ZDM2ZjdiZTdBOGIxMTcyRTA5RTZkOEEyNmMgIC8vIFRPRE8gYWRkcmVzcyBfYmVuZWZpY2lhcnkKICAgICkge30KfQ=='.
	

]
