Class {
	#name : #SRTB854728AFAA9f8dAe90794De4b9C19F0C5Eb969a,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTB854728AFAA9f8dAe90794De4b9C19F0C5Eb969a >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKiB0YWtpbmcgaWRlYXMgZnJvbSBaZXBwZWxpbiBzb2xpZGl0eSBtb2R1bGUgKi8KY29udHJhY3QgU2FmZU1hdGggewoKICAgIC8vIGl0IGlzIHJlY29tbWVuZGVkIHRvIGRlZmluZSBmdW5jdGlvbnMgd2hpY2ggY2FuIG5laXRoZXIgcmVhZCB0aGUgc3RhdGUgb2YgYmxvY2tjaGFpbiBub3Igd3JpdGUgaW4gaXQgYXMgcHVyZSBpbnN0ZWFkIG9mIGNvbnN0YW50CgogICAgZnVuY3Rpb24gc2FmZUFkZCh1aW50MjU2IHgsIHVpbnQyNTYgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IHogPSB4ICsgeTsKICAgICAgICBhc3NlcnQoKHogPj0geCkpOwogICAgICAgIHJldHVybiB6OwogICAgfQoKICAgIGZ1bmN0aW9uIHNhZmVTdWJ0cmFjdCh1aW50MjU2IHgsIHVpbnQyNTYgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoeCA+PSB5KTsKICAgICAgICByZXR1cm4geCAtIHk7CiAgICB9CgogICAgZnVuY3Rpb24gc2FmZU11bHQodWludDI1NiB4LCB1aW50MjU2IHkpIGludGVybmFsIHB1cmUgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiB6ID0geCAqIHk7CiAgICAgICAgYXNzZXJ0KCh4ID09IDApfHwoei94ID09IHkpKTsKICAgICAgICByZXR1cm4gejsKICAgIH0KCiAgICBmdW5jdGlvbiBzYWZlRGl2KHVpbnQyNTYgeCwgdWludDI1NiB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IHogPSB4IC8geTsKICAgICAgICByZXR1cm4gejsKICAgIH0KCiAgICAvLyBtaXRpZ2F0ZSBzaG9ydCBhZGRyZXNzIGF0dGFjawogICAgLy8gdGhhbmtzIHRvIGh0dHBzOi8vZ2l0aHViLmNvbS9udW1lcmFpL2NvbnRyYWN0L2Jsb2IvYzE4MjQ2NWY4MmU1MGNlZDhkYWNiMzk3N2VjMzc0YTg5MmY1ZmE4Yy9jb250cmFjdHMvU2FmZS5zb2wjTDMwLUwzNC4KICAgIC8vIFRPRE86IGRvdWJsZWNoZWNrIGltcGxpY2F0aW9uIG9mID49IGNvbXBhcmVkIHRvID09CiAgICBtb2RpZmllciBvbmx5UGF5bG9hZFNpemUodWludCBudW1Xb3JkcykgewogICAgICAgIGFzc2VydChtc2cuZGF0YS5sZW5ndGggPj0gbnVtV29yZHMgKiAzMiArIDQpOwogICAgICAgIF87CiAgICB9Cgp9Ci8vIFRoZSBhYnN0cmFjdCB0b2tlbiBjb250cmFjdAoKY29udHJhY3QgVHJha1Rva2VuIHsKICAgIGZ1bmN0aW9uIFRyYWtUb2tlbiAoKSBwdWJsaWMge30KICAgIGZ1bmN0aW9uIHRyYW5zZmVyIChhZGRyZXNzICx1aW50KSBwdWJsaWMgcHVyZSB7IH0KICAgIGZ1bmN0aW9uIGJ1cm4gKHVpbnQyNTYpIHB1YmxpYyBwdXJlIHsgfQogICAgZnVuY3Rpb24gZmluYWxpemUoKSBwdWJsaWMgcHVyZSB7IH0KICAgIGZ1bmN0aW9uIGNoYW5nZVRva2Vuc1dhbGxldCAoYWRkcmVzcykgcHVibGljIHB1cmUgeyB9Cn0KCmNvbnRyYWN0IENyb3dkU2FsZSBpcyBTYWZlTWF0aCB7CgogICAgLy8vbWV0YWRhdGEKICAgIGVudW0gU3RhdGUgeyBGdW5kcmFpc2luZyxQYXVzZWQsU3VjY2Vzc2Z1bCxDbG9zZWQgfQogICAgU3RhdGUgcHVibGljIHN0YXRlID0gU3RhdGUuRnVuZHJhaXNpbmc7IC8vIGVxdWFsIHRvIDAKICAgIHN0cmluZyBwdWJsaWMgdmVyc2lvbiA9ICIxLjAiOwoKICAgIC8vRXh0ZXJuYWwgY29udHJhY3RzCiAgICBUcmFrVG9rZW4gcHVibGljIHRyYWtUb2tlbjsKICAgIC8vIHdobyBjcmVhdGVkIHNtYXJ0IGNvbnRyYWN0CiAgICBhZGRyZXNzIHB1YmxpYyBjcmVhdG9yOwogICAgLy8gQWRkcmVzcyB3aGljaCB3aWxsIHJlY2VpdmUgcmFpc2VkIGZ1bmRzCiAgICBhZGRyZXNzIHB1YmxpYyBjb250cmFjdE93bmVyOwogICAgLy8gYWRyZWVzcyB2cyBzdGF0ZSBtYXBwaW5nICgxIGZvciBleGlzdHMgLCB6ZXJvIGRlZmF1bHQpOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgd2hpdGVsaXN0ZWRDb250cmlidXRvcnM7CgogICAgdWludDI1NiBwdWJsaWMgZnVuZGluZ1N0YXJ0QmxvY2s7IC8vIERlYyAxNSAtIERlYyAyNQogICAgdWludDI1NiBwdWJsaWMgZmlyc3RDaGFuZ2VCbG9jazsgIC8vIERlY2VtYmVyIDI1IC0gSmFudWFyeSA1CiAgICB1aW50MjU2IHB1YmxpYyBzZWNvbmRDaGFuZ2VCbG9jazsgLy8gSmFudWFyeSA1IC1KYW51YXJ5IDE1CiAgICB1aW50MjU2IHB1YmxpYyB0aGlyZENoYW5nZUJsb2NrOyAgLy8gSmFudWFyeSAxNgogICAgdWludDI1NiBwdWJsaWMgZnVuZGluZ0VuZEJsb2NrOyAgIC8vIEphbiAzMQogICAgLy8gZnVuZGluZyBtYXhpbXVtIGR1cmF0aW9uIGluIGhvdXJzCiAgICB1aW50MjU2IHB1YmxpYyBmdW5kaW5nRHVyYXRpb25JbkhvdXJzOwogICAgdWludDI1NiBjb25zdGFudCBwdWJsaWMgZnVuZGluZ01heGltdW1UYXJnZXRJbldlaSA9IDY2Njg1IGV0aGVyOwogICAgLy8gV2UgbmVlZCB0byBrZWVwIHRyYWNrIG9mIGhvdyBtdWNoIGV0aGVyIChpbiB1bml0cyBvZiBXZWkpIGhhcyBiZWVuIGNvbnRyaWJ1dGVkCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFJhaXNlZEluV2VpOwogICAgLy8gbWF4aW11bSBldGhlciB3ZSB3aWxsIGFjY2VwdCBmcm9tIG9uZSB1c2VyCiAgICB1aW50MjU2IGNvbnN0YW50IHB1YmxpYyBtYXhQcmljZUluV2VpRnJvbVVzZXIgPSAxNTAwIGV0aGVyOwogICAgdWludDI1NiBjb25zdGFudCBwdWJsaWMgbWluUHJpY2VJbldlaUZvclByZSA9IDEgZXRoZXI7CiAgICB1aW50MjU2IGNvbnN0YW50IHB1YmxpYyBtaW5QcmljZUluV2VpRm9ySWNvID0gMC41IGV0aGVyOwogICAgdWludDggY29uc3RhbnQgcHVibGljICBkZWNpbWFscyA9IDE4OwogICAgLy8gTnVtYmVyIG9mIHRva2VucyBkaXN0cmlidXRlZCB0byBpbnZlc3RvcnMKICAgIHVpbnQgcHVibGljIHRva2Vuc0Rpc3RyaWJ1dGVkID0gMDsKICAgIC8vIHRva2VucyBwZXIgdHJhbmNoZQogICAgdWludCBjb25zdGFudCBwdWJsaWMgdG9rZW5zUGVyVHJhbmNoZSA9IDExMDAwMDAwICogKHVpbnQyNTYoMTApICoqIGRlY2ltYWxzKTsKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IHByaXZhdGVFeGNoYW5nZVJhdGUgPSAxNDIwOyAvLyAyMy44JQogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgZmlyc3RFeGNoYW5nZVJhdGUgICA9IDEyODk7IC8vIDE1LjI1JQogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgc2Vjb25kRXhjaGFuZ2VSYXRlICA9IDExOTM7ICAvLyAgOC40MiUKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IHRoaXJkRXhjaGFuZ2VSYXRlICAgPSAxMTQyOyAgLy8gIDQuMzElCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBmb3VydGhFeGNoYW5nZVJhdGUgID0gMTExODsgIC8vICAyLjI1JQogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgZmlmdGhFeGNoYW5nZVJhdGUgICA9IDExMDU7ICAvLyAxLjA5JQoKICAgIC8vLyBtb2RpZmllcnMKICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY29udHJhY3RPd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBpc0ljb09wZW4oKSB7CiAgICAgICAgcmVxdWlyZShibG9jay5udW1iZXIgPj0gZnVuZGluZ1N0YXJ0QmxvY2spOwogICAgICAgIHJlcXVpcmUoYmxvY2subnVtYmVyIDw9IGZ1bmRpbmdFbmRCbG9jayk7CiAgICAgICAgcmVxdWlyZSh0b3RhbFJhaXNlZEluV2VpIDw9IGZ1bmRpbmdNYXhpbXVtVGFyZ2V0SW5XZWkpOwogICAgICAgIF87CiAgICB9CgoKICAgIG1vZGlmaWVyIGlzTWluaW11bVByaWNlKCkgewogICAgICAgIGlmICh0b2tlbnNEaXN0cmlidXRlZCA8IHNhZmVNdWx0KDMsdG9rZW5zUGVyVHJhbmNoZSkgfHwgYmxvY2subnVtYmVyIDwgdGhpcmRDaGFuZ2VCbG9jayApIHsKICAgICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSBtaW5QcmljZUluV2VpRm9yUHJlKTsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAodG9rZW5zRGlzdHJpYnV0ZWQgPD0gc2FmZU11bHQoNix0b2tlbnNQZXJUcmFuY2hlKSkgewogICAgICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID49IG1pblByaWNlSW5XZWlGb3JJY28pOwogICAgICAgIH0KCiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPD0gbWF4UHJpY2VJbldlaUZyb21Vc2VyKTsKCiAgICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgaXNJY29GaW5pc2hlZCgpIHsKICAgICAgICByZXF1aXJlKHRvdGFsUmFpc2VkSW5XZWkgPj0gZnVuZGluZ01heGltdW1UYXJnZXRJbldlaSB8fCAoYmxvY2subnVtYmVyID4gZnVuZGluZ0VuZEJsb2NrKSB8fCBzdGF0ZSA9PSBTdGF0ZS5TdWNjZXNzZnVsICk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBpblN0YXRlKFN0YXRlIF9zdGF0ZSkgewogICAgICAgIHJlcXVpcmUoc3RhdGUgPT0gX3N0YXRlKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIGlzQ3JlYXRvcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY3JlYXRvcik7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLyB3YWl0IDEwMCBibG9jayBhZnRlciBmaW5hbCBjb250cmFjdCBzdGF0ZSBiZWZvcmUgYWxsb3dpbmcgY29udHJhY3QgZGVzdHJ1Y3Rpb24KICAgIG1vZGlmaWVyIGF0RW5kT2ZMaWZlY3ljbGUoKSB7CiAgICAgICAgcmVxdWlyZSh0b3RhbFJhaXNlZEluV2VpID49IGZ1bmRpbmdNYXhpbXVtVGFyZ2V0SW5XZWkgfHwgKGJsb2NrLm51bWJlciA+IGZ1bmRpbmdFbmRCbG9jayArIDQwMDAwKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLy8gY29uc3RydWN0b3IKICAgIGZ1bmN0aW9uIENyb3dkU2FsZSgKICAgIGFkZHJlc3MgX2Z1bmRzV2FsbGV0LAogICAgdWludDI1NiBfZnVuZGluZ1N0YXJ0QmxvY2ssCiAgICB1aW50MjU2IF9maXJzdEluSG91cnMsCiAgICB1aW50MjU2IF9zZWNvbmRJbkhvdXJzLAogICAgdWludDI1NiBfdGhpcmRJbkhvdXJzLAogICAgdWludDI1NiBfZnVuZGluZ0R1cmF0aW9uSW5Ib3VycywKICAgIFRyYWtUb2tlbiBfdG9rZW5BZGRyZXNzCiAgICApIHB1YmxpYyB7CgogICAgICAgIHJlcXVpcmUoc2FmZUFkZChfZnVuZGluZ1N0YXJ0QmxvY2ssIHNhZmVNdWx0KF9mdW5kaW5nRHVyYXRpb25JbkhvdXJzICwgMjEyKSkgPiBfZnVuZGluZ1N0YXJ0QmxvY2spOwoKICAgICAgICBjcmVhdG9yID0gbXNnLnNlbmRlcjsKCiAgICAgICAgaWYgKF9mdW5kc1dhbGxldCAhPTApIHsKICAgICAgICAgICAgY29udHJhY3RPd25lciA9IF9mdW5kc1dhbGxldDsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGNvbnRyYWN0T3duZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIH0KCiAgICAgICAgZnVuZGluZ1N0YXJ0QmxvY2sgPSBfZnVuZGluZ1N0YXJ0QmxvY2s7CiAgICAgICAgZmlyc3RDaGFuZ2VCbG9jayA9ICBzYWZlQWRkKGZ1bmRpbmdTdGFydEJsb2NrLCBzYWZlTXVsdChfZmlyc3RJbkhvdXJzICwgMjEyKSk7CiAgICAgICAgc2Vjb25kQ2hhbmdlQmxvY2sgPSBzYWZlQWRkKGZ1bmRpbmdTdGFydEJsb2NrLCBzYWZlTXVsdChfc2Vjb25kSW5Ib3VycyAsIDIxMikpOwogICAgICAgIHRoaXJkQ2hhbmdlQmxvY2sgPSAgc2FmZUFkZChmdW5kaW5nU3RhcnRCbG9jaywgc2FmZU11bHQoX3RoaXJkSW5Ib3VycyAsIDIxMikpOwogICAgICAgIGZ1bmRpbmdEdXJhdGlvbkluSG91cnMgPSBfZnVuZGluZ0R1cmF0aW9uSW5Ib3VyczsKICAgICAgICBmdW5kaW5nRW5kQmxvY2sgPSBzYWZlQWRkKGZ1bmRpbmdTdGFydEJsb2NrLCBzYWZlTXVsdChfZnVuZGluZ0R1cmF0aW9uSW5Ib3VycyAsIDIxMikpOwogICAgICAgIHRyYWtUb2tlbiA9IFRyYWtUb2tlbihfdG9rZW5BZGRyZXNzKTsKICAgIH0KCgogICAgLy8gZmFsbGJhY2sgZnVuY3Rpb24gY2FuIGJlIHVzZWQgdG8gYnV5IHRva2VucwogICAgZnVuY3Rpb24gKCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwogICAgfQoKCiAgICBmdW5jdGlvbiBidXlUb2tlbnMoYWRkcmVzcyBiZW5lZmljaWFyeSkgaW5TdGF0ZShTdGF0ZS5GdW5kcmFpc2luZykgaXNJY29PcGVuIGlzTWluaW11bVByaWNlICBwdWJsaWMgIHBheWFibGUgIHsKICAgICAgICByZXF1aXJlKGJlbmVmaWNpYXJ5ICE9IDB4MCk7CiAgICAgICAgLy8gc3RhdGUgMSBpcyBzZXQgZm9yCiAgICAgICAgcmVxdWlyZSh3aGl0ZWxpc3RlZENvbnRyaWJ1dG9yc1tiZW5lZmljaWFyeV0gPT0gdHJ1ZSApOwogICAgICAgIHVpbnQyNTYgdG9rZW5BbW91bnQ7CiAgICAgICAgdWludDI1NiBjaGVja2VkUmVjZWl2ZWRXZWkgPSBzYWZlQWRkKHRvdGFsUmFpc2VkSW5XZWksIG1zZy52YWx1ZSk7CiAgICAgICAgLy8gQ2hlY2sgdGhhdCB0aGlzIHRyYW5zYWN0aW9uIHdvdWxkbid0IGV4Y2VlZCB0aGUgRVRIIG1heCBjYXAKCiAgICAgICAgaWYgKGNoZWNrZWRSZWNlaXZlZFdlaSA+IGZ1bmRpbmdNYXhpbXVtVGFyZ2V0SW5XZWkgKSB7CgogICAgICAgICAgICAvLyB1cGRhdGUgdG90YWxSYWlzZWQgQWZ0ZXIgU3VidHJhY3RpbmcKICAgICAgICAgICAgdG90YWxSYWlzZWRJbldlaSA9IHNhZmVBZGQodG90YWxSYWlzZWRJbldlaSxzYWZlU3VidHJhY3QoZnVuZGluZ01heGltdW1UYXJnZXRJbldlaSx0b3RhbFJhaXNlZEluV2VpKSk7CiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBob3cgbWFueSB0b2tlbnMgKGluIHVuaXRzIG9mIFdlaSkgc2hvdWxkIGJlIGF3YXJkZWQgb24gdGhpcyB0cmFuc2FjdGlvbgogICAgICAgICAgICB2YXIgKHJhdGUsLyp0cmFuY2hlTWF4VG9rZW5zTGVmdCAqLykgPSBnZXRDdXJyZW50VG9rZW5QcmljZSgpOwogICAgICAgICAgICAvLyBDYWxjdWxhdGUgaG93IG1hbnkgdG9rZW5zIChpbiB1bml0cyBvZiBXZWkpIHNob3VsZCBiZSBhd2FyZGVkIG9uIHRoaXMgdHJhbnNhY3Rpb24KICAgICAgICAgICAgdG9rZW5BbW91bnQgPSBzYWZlTXVsdChzYWZlU3VidHJhY3QoZnVuZGluZ01heGltdW1UYXJnZXRJbldlaSx0b3RhbFJhaXNlZEluV2VpKSwgcmF0ZSk7CiAgICAgICAgICAgIC8vIFNlbmQgY2hhbmdlIGV4dHJhIGV0aGVyIHRvIHVzZXIuCiAgICAgICAgICAgIGJlbmVmaWNpYXJ5LnRyYW5zZmVyKHNhZmVTdWJ0cmFjdChjaGVja2VkUmVjZWl2ZWRXZWksZnVuZGluZ01heGltdW1UYXJnZXRJbldlaSkpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgdG90YWxSYWlzZWRJbldlaSA9IHNhZmVBZGQodG90YWxSYWlzZWRJbldlaSxtc2cudmFsdWUpOwogICAgICAgICAgICB2YXIgKGN1cnJlbnRSYXRlLHRyYW5jaGVNYXhUb2tlbnNMZWZ0KSA9IGdldEN1cnJlbnRUb2tlblByaWNlKCk7CiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBob3cgbWFueSB0b2tlbnMgKGluIHVuaXRzIG9mIFdlaSkgc2hvdWxkIGJlIGF3YXJkZWQgb24gdGhpcyB0cmFuc2FjdGlvbgogICAgICAgICAgICB0b2tlbkFtb3VudCA9IHNhZmVNdWx0KG1zZy52YWx1ZSwgY3VycmVudFJhdGUpOwogICAgICAgICAgICBpZiAodG9rZW5BbW91bnQgPiB0cmFuY2hlTWF4VG9rZW5zTGVmdCkgewogICAgICAgICAgICAgICAgLy8gaGFuZGxlIHJvdW5kIG9mZiBlcnJvciBieSBhZGRpbmcgLjEgdG9rZW4KICAgICAgICAgICAgICAgIHRva2Vuc0Rpc3RyaWJ1dGVkID0gIHNhZmVBZGQodG9rZW5zRGlzdHJpYnV0ZWQsc2FmZUFkZCh0cmFuY2hlTWF4VG9rZW5zTGVmdCxzYWZlRGl2KDEsMTApKSk7CiAgICAgICAgICAgICAgICAvL2ZpbmQgcmVtYWluaW5nIHRva2VucyBieSBnZXRDdXJyZW50VG9rZW5QcmljZSgpIGZ1bmN0aW9uIGFuZCBzZWxsIHRoZW0gZnJvbSByZW1haW5pbmcgZXRoZXJzIGxlZnQKICAgICAgICAgICAgICAgIHZhciAobmV4dEN1cnJlbnRSYXRlLG5leHRUcmFuY2hlTWF4VG9rZW5zTGVmdCkgPSBnZXRDdXJyZW50VG9rZW5QcmljZSgpOwoKICAgICAgICAgICAgICAgIGlmIChuZXh0VHJhbmNoZU1heFRva2Vuc0xlZnQgPD0gMCkgewogICAgICAgICAgICAgICAgICAgIHRva2VuQW1vdW50ID0gc2FmZUFkZCh0cmFuY2hlTWF4VG9rZW5zTGVmdCxzYWZlRGl2KDEsMTApKTsKICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9ICBTdGF0ZS5TdWNjZXNzZnVsOwogICAgICAgICAgICAgICAgICAgIC8vIFNlbmQgY2hhbmdlIGV4dHJhIGV0aGVyIHRvIHVzZXIuCiAgICAgICAgICAgICAgICAgICAgYmVuZWZpY2lhcnkudHJhbnNmZXIoc2FmZURpdihzYWZlU3VidHJhY3QodG9rZW5BbW91bnQsdHJhbmNoZU1heFRva2Vuc0xlZnQpLGN1cnJlbnRSYXRlKSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHVpbnQyNTYgbmV4dFRva2VuQW1vdW50ID0gc2FmZU11bHQoc2FmZVN1YnRyYWN0KG1zZy52YWx1ZSxzYWZlTXVsdCh0cmFuY2hlTWF4VG9rZW5zTGVmdCxzYWZlRGl2KDEsY3VycmVudFJhdGUpKSksbmV4dEN1cnJlbnRSYXRlKTsKICAgICAgICAgICAgICAgICAgICB0b2tlbnNEaXN0cmlidXRlZCA9ICBzYWZlQWRkKHRva2Vuc0Rpc3RyaWJ1dGVkLG5leHRUb2tlbkFtb3VudCk7CiAgICAgICAgICAgICAgICAgICAgdG9rZW5BbW91bnQgPSBzYWZlQWRkKG5leHRUb2tlbkFtb3VudCxzYWZlQWRkKHRyYW5jaGVNYXhUb2tlbnNMZWZ0LHNhZmVEaXYoMSwxMCkpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHRva2Vuc0Rpc3RyaWJ1dGVkID0gIHNhZmVBZGQodG9rZW5zRGlzdHJpYnV0ZWQsdG9rZW5BbW91bnQpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB0cmFrVG9rZW4udHJhbnNmZXIoYmVuZWZpY2lhcnksdG9rZW5BbW91bnQpOwogICAgICAgIC8vIGltbWVkaWF0ZWx5IHRyYW5zZmVyIGV0aGVyIHRvIGZ1bmRzV2FsbGV0CiAgICAgICAgZm9yd2FyZEZ1bmRzKCk7CiAgICB9CgogICAgZnVuY3Rpb24gZm9yd2FyZEZ1bmRzKCkgaW50ZXJuYWwgewogICAgICAgIGNvbnRyYWN0T3duZXIudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIHRoZSBjdXJyZW50IHRva2VuIHJhdGUgLCBtaW5pbXVtIGV0aGVyIG5lZWRlZCBhbmQgbWF4aW11bSB0b2tlbnMgbGVmdCBpbiBjdXJyZW50dHJhbmNoZQogICAgZnVuY3Rpb24gZ2V0Q3VycmVudFRva2VuUHJpY2UoKSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgY3VycmVudFJhdGUsIHVpbnQyNTYgbWF4aW11bVRva2Vuc0xlZnQpIHsKCiAgICAgICAgaWYgKHRva2Vuc0Rpc3RyaWJ1dGVkIDwgc2FmZU11bHQoMSx0b2tlbnNQZXJUcmFuY2hlKSAmJiAoYmxvY2subnVtYmVyIDwgZmlyc3RDaGFuZ2VCbG9jaykpIHsKICAgICAgICAgICAgLy8gIHJldHVybiAoIHByaXZhdGVFeGNoYW5nZVJhdGUsIG1pblByaWNlSW5XZWlGb3JQcmUsIHNhZmVTdWJ0cmFjdCh0b2tlbnNQZXJUcmFuY2hlLHRva2Vuc0Rpc3RyaWJ1dGVkKSApOwogICAgICAgICAgICByZXR1cm4gKCBwcml2YXRlRXhjaGFuZ2VSYXRlLCBzYWZlU3VidHJhY3QodG9rZW5zUGVyVHJhbmNoZSx0b2tlbnNEaXN0cmlidXRlZCkgKTsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAodG9rZW5zRGlzdHJpYnV0ZWQgPCBzYWZlTXVsdCgyLHRva2Vuc1BlclRyYW5jaGUpICYmIChibG9jay5udW1iZXIgPCBzZWNvbmRDaGFuZ2VCbG9jaykpIHsKICAgICAgICAgICAgcmV0dXJuICggZmlyc3RFeGNoYW5nZVJhdGUsIHNhZmVTdWJ0cmFjdChzYWZlTXVsdCgyLHRva2Vuc1BlclRyYW5jaGUpLHRva2Vuc0Rpc3RyaWJ1dGVkKSApOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmICh0b2tlbnNEaXN0cmlidXRlZCA8IHNhZmVNdWx0KDMsdG9rZW5zUGVyVHJhbmNoZSkgJiYgKGJsb2NrLm51bWJlciA8IHRoaXJkQ2hhbmdlQmxvY2spKSB7CiAgICAgICAgICAgIHJldHVybiAoIHNlY29uZEV4Y2hhbmdlUmF0ZSwgc2FmZVN1YnRyYWN0KHNhZmVNdWx0KDMsdG9rZW5zUGVyVHJhbmNoZSksdG9rZW5zRGlzdHJpYnV0ZWQpICk7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKHRva2Vuc0Rpc3RyaWJ1dGVkIDwgc2FmZU11bHQoNCx0b2tlbnNQZXJUcmFuY2hlKSAmJiAoYmxvY2subnVtYmVyIDwgZnVuZGluZ0VuZEJsb2NrKSkgewogICAgICAgICAgICByZXR1cm4gICh0aGlyZEV4Y2hhbmdlUmF0ZSxzYWZlU3VidHJhY3Qoc2FmZU11bHQoNCx0b2tlbnNQZXJUcmFuY2hlKSx0b2tlbnNEaXN0cmlidXRlZCkgICk7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKHRva2Vuc0Rpc3RyaWJ1dGVkIDwgc2FmZU11bHQoNSx0b2tlbnNQZXJUcmFuY2hlKSAmJiAoYmxvY2subnVtYmVyIDwgZnVuZGluZ0VuZEJsb2NrKSkgewogICAgICAgICAgICByZXR1cm4gIChmb3VydGhFeGNoYW5nZVJhdGUsc2FmZVN1YnRyYWN0KHNhZmVNdWx0KDUsdG9rZW5zUGVyVHJhbmNoZSksdG9rZW5zRGlzdHJpYnV0ZWQpICApOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmICh0b2tlbnNEaXN0cmlidXRlZCA8PSBzYWZlTXVsdCg2LHRva2Vuc1BlclRyYW5jaGUpKSB7CiAgICAgICAgICAgIHJldHVybiAgKGZpZnRoRXhjaGFuZ2VSYXRlLHNhZmVTdWJ0cmFjdChzYWZlTXVsdCg2LHRva2Vuc1BlclRyYW5jaGUpLHRva2Vuc0Rpc3RyaWJ1dGVkKSAgKTsKICAgICAgICB9CiAgICB9CgoKICAgIGZ1bmN0aW9uIGF1dGhvcml6ZUt5YyhhZGRyZXNzW10gYWRkcnMpIGV4dGVybmFsIG9ubHlPd25lciByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKCiAgICAgICAgLy9AVE9ETyAgbWF4aW11bSBiYXRjaCBzaXplIGZvciB1cGxvYWRpbmcKICAgICAgICAvLyBAVE9ETyBhbW91bnQgb2YgZ2FzIGZvciBhIGJsb2NrIG9mIGNvZGUgLSBhbmQgd2lsbCBmYWlsIGlmIHRoYXQgaXMgZXhjZWVkZWQKICAgICAgICB1aW50IGFycmF5TGVuZ3RoID0gYWRkcnMubGVuZ3RoOwoKICAgICAgICBmb3IgKHVpbnQgeCA9IDA7IHggPCBhcnJheUxlbmd0aDsgeCsrKSB7CiAgICAgICAgICAgIHdoaXRlbGlzdGVkQ29udHJpYnV0b3JzW2FkZHJzW3hdXSA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCgogICAgZnVuY3Rpb24gd2l0aGRyYXdXZWkgKCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICAvLyBzZW5kIHRoZSBldGggdG8gdGhlIHByb2plY3QgbXVsdGlzaWcgd2FsbGV0CiAgICAgICAgY29udHJhY3RPd25lci50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgfQoKICAgIGZ1bmN0aW9uIHVwZGF0ZUZ1bmRpbmdFbmRCbG9jayh1aW50MjU2IG5ld0Z1bmRpbmdFbmRCbG9jaykgIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShuZXdGdW5kaW5nRW5kQmxvY2sgPiBmdW5kaW5nU3RhcnRCbG9jayk7CiAgICAgICAgLy9yZXF1aXJlKG5ld0Z1bmRpbmdFbmRCbG9jayA+PSBmdW5kaW5nRW5kQmxvY2spOwogICAgICAgIGZ1bmRpbmdFbmRCbG9jayA9IG5ld0Z1bmRpbmdFbmRCbG9jazsKICAgIH0KCgogICAgLy8gYWZ0ZXIgSUNPIG9ubHkgb3duZXIgY2FuIGNhbGwgdGhpcwogICAgZnVuY3Rpb24gYnVyblJlbWFpbmluZ1Rva2VuKHVpbnQyNTYgX3ZhbHVlKSBleHRlcm5hbCAgb25seU93bmVyIGlzSWNvRmluaXNoZWQgewogICAgICAgIC8vQFRPRE8gLSBjaGVjayBiYWxhbmNlIG9mIGFkZHJlc3MgaWYgbm8gdmFsdWUgcGFzc2VkCiAgICAgICAgcmVxdWlyZShfdmFsdWUgPiAwKTsKICAgICAgICB0cmFrVG9rZW4uYnVybihfdmFsdWUpOwogICAgfQoKICAgIC8vIGFmdGVyIElDTyBvbmx5IG93bmVyIGNhbiBjYWxsIHRoaXMKICAgIGZ1bmN0aW9uIHdpdGhkcmF3UmVtYWluaW5nVG9rZW4odWludDI1NiBfdmFsdWUsYWRkcmVzcyB0cmFrVG9rZW5BZG1pbikgIGV4dGVybmFsIG9ubHlPd25lciBpc0ljb0ZpbmlzaGVkIHsKICAgICAgICAvL0BUT0RPIC0gY2hlY2sgYmFsYW5jZSBvZiBhZGRyZXNzIGlmIG5vIHZhbHVlIHBhc3NlZAogICAgICAgIHJlcXVpcmUodHJha1Rva2VuQWRtaW4gIT0gMHgwKTsKICAgICAgICByZXF1aXJlKF92YWx1ZSA+IDApOwogICAgICAgIHRyYWtUb2tlbi50cmFuc2Zlcih0cmFrVG9rZW5BZG1pbixfdmFsdWUpOwogICAgfQoKCiAgICAvLyBhZnRlciBJQ08gb25seSBvd25lciBjYW4gY2FsbCB0aGlzCiAgICBmdW5jdGlvbiBmaW5hbGl6ZSgpIGV4dGVybmFsICBvbmx5T3duZXIgaXNJY29GaW5pc2hlZCAgewogICAgICAgIHN0YXRlID0gIFN0YXRlLkNsb3NlZDsKICAgICAgICB0cmFrVG9rZW4uZmluYWxpemUoKTsKICAgIH0KCiAgICAvLyBhZnRlciBJQ08gb25seSBvd25lciBjYW4gY2FsbCB0aGlzCiAgICBmdW5jdGlvbiBjaGFuZ2VUb2tlbnNXYWxsZXQoYWRkcmVzcyBuZXdBZGRyZXNzKSBleHRlcm5hbCAgb25seU93bmVyICB7CiAgICAgICAgcmVxdWlyZShuZXdBZGRyZXNzICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHRyYWtUb2tlbi5jaGFuZ2VUb2tlbnNXYWxsZXQobmV3QWRkcmVzcyk7CiAgICB9CgoKICAgIGZ1bmN0aW9uIHJlbW92ZUNvbnRyYWN0ICgpICBleHRlcm5hbCBvbmx5T3duZXIgYXRFbmRPZkxpZmVjeWNsZSB7CiAgICAgICAgLy8gbXNnLnNlbmRlciB3aWxsIHJlY2VpdmUgYWxsIHRoZSBldGhlcnMgaWYgdGhpcyBjb250cmFjdCBoYXMgZXRoZXJzCiAgICAgICAgc2VsZmRlc3RydWN0KG1zZy5zZW5kZXIpOwogICAgfQoKICAgIC8vLyBAcGFyYW0gbmV3QWRkcmVzcyBBZGRyZXNzIG9mIG5ldyBvd25lci4KICAgIGZ1bmN0aW9uIGNoYW5nZUZ1bmRzV2FsbGV0KGFkZHJlc3MgbmV3QWRkcmVzcykgZXh0ZXJuYWwgb25seU93bmVyIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmVxdWlyZShuZXdBZGRyZXNzICE9IGFkZHJlc3MoMCkpOwogICAgICAgIGNvbnRyYWN0T3duZXIgPSBuZXdBZGRyZXNzOwogICAgfQoKCiAgICAvLy8gQGRldiBQYXVzZXMgdGhlIGNvbnRyYWN0CiAgICBmdW5jdGlvbiBwYXVzZSgpIGV4dGVybmFsIG9ubHlPd25lciBpblN0YXRlKFN0YXRlLkZ1bmRyYWlzaW5nKSB7CiAgICAgICAgLy8gTW92ZSB0aGUgY29udHJhY3QgdG8gUGF1c2VkIHN0YXRlCiAgICAgICAgc3RhdGUgPSAgU3RhdGUuUGF1c2VkOwogICAgfQoKCiAgICAvLy8gQGRldiBSZXN1bWUgdGhlIGNvbnRyYWN0CiAgICBmdW5jdGlvbiByZXN1bWUoKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIC8vIE1vdmUgdGhlIGNvbnRyYWN0IG91dCBvZiB0aGUgUGF1c2VkIHN0YXRlCiAgICAgICAgc3RhdGUgPSAgU3RhdGUuRnVuZHJhaXNpbmc7CiAgICB9Cn0='.
	

]
