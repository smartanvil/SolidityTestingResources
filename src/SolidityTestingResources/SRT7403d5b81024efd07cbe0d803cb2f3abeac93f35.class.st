Class {
	#name : #SRT7403d5b81024efd07cbe0d803cb2f3abeac93f35,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT7403d5b81024efd07cbe0d803cb2f3abeac93f35 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovLyBGaWxlOiBjb250cmFjdHMvbGFuZC9MQU5EU3RvcmFnZS5zb2wKCmNvbnRyYWN0IExBTkRTdG9yYWdlIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgbGF0ZXN0UGluZzsKCiAgdWludDI1NiBjb25zdGFudCBjbGVhckxvdyA9IDB4ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmYwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDsKICB1aW50MjU2IGNvbnN0YW50IGNsZWFySGlnaCA9IDB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZjsKICB1aW50MjU2IGNvbnN0YW50IGZhY3RvciA9IDB4MTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwOwoKICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBhdXRob3JpemVkRGVwbG95OwoKICBtYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIHB1YmxpYyB1cGRhdGVPcGVyYXRvcjsKfQoKLy8gRmlsZTogY29udHJhY3RzL3VwZ3JhZGFibGUvT3duYWJsZVN0b3JhZ2Uuc29sCgpjb250cmFjdCBPd25hYmxlU3RvcmFnZSB7CgogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKICBmdW5jdGlvbiBPd25hYmxlU3RvcmFnZSgpIGludGVybmFsIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9Cgp9CgovLyBGaWxlOiBjb250cmFjdHMvdXBncmFkYWJsZS9Qcm94eVN0b3JhZ2Uuc29sCgpjb250cmFjdCBQcm94eVN0b3JhZ2UgewoKICAvKioKICAgKiBDdXJyZW50IGNvbnRyYWN0IHRvIHdoaWNoIHdlIGFyZSBwcm94aW5nCiAgICovCiAgYWRkcmVzcyBwdWJsaWMgY3VycmVudENvbnRyYWN0OwogIGFkZHJlc3MgcHVibGljIHByb3h5T3duZXI7Cn0KCi8vIEZpbGU6IGVyYzgyMS9jb250cmFjdHMvQXNzZXRSZWdpc3RyeVN0b3JhZ2Uuc29sCgpjb250cmFjdCBBc3NldFJlZ2lzdHJ5U3RvcmFnZSB7CgogIHN0cmluZyBpbnRlcm5hbCBfbmFtZTsKICBzdHJpbmcgaW50ZXJuYWwgX3N5bWJvbDsKICBzdHJpbmcgaW50ZXJuYWwgX2Rlc2NyaXB0aW9uOwoKICAvKioKICAgKiBTdG9yZXMgdGhlIHRvdGFsIGNvdW50IG9mIGFzc2V0cyBtYW5hZ2VkIGJ5IHRoaXMgcmVnaXN0cnkKICAgKi8KICB1aW50MjU2IGludGVybmFsIF9jb3VudDsKCiAgLyoqCiAgICogU3RvcmVzIGFuIGFycmF5IG9mIGFzc2V0cyBvd25lZCBieSBhIGdpdmVuIGFjY291bnQKICAgKi8KICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NltdKSBpbnRlcm5hbCBfYXNzZXRzT2Y7CgogIC8qKgogICAqIFN0b3JlcyB0aGUgY3VycmVudCBob2xkZXIgb2YgYW4gYXNzZXQKICAgKi8KICBtYXBwaW5nKHVpbnQyNTYgPT4gYWRkcmVzcykgaW50ZXJuYWwgX2hvbGRlck9mOwoKICAvKioKICAgKiBTdG9yZXMgdGhlIGluZGV4IG9mIGFuIGFzc2V0IGluIHRoZSBgX2Fzc2V0c09mYCBhcnJheSBvZiBpdHMgaG9sZGVyCiAgICovCiAgbWFwcGluZyh1aW50MjU2ID0+IHVpbnQyNTYpIGludGVybmFsIF9pbmRleE9mQXNzZXQ7CgogIC8qKgogICAqIFN0b3JlcyB0aGUgZGF0YSBhc3NvY2lhdGVkIHdpdGggYW4gYXNzZXQKICAgKi8KICBtYXBwaW5nKHVpbnQyNTYgPT4gc3RyaW5nKSBpbnRlcm5hbCBfYXNzZXREYXRhOwoKICAvKioKICAgKiBGb3IgYSBnaXZlbiBhY2NvdW50LCBmb3IgYSBnaXZlbiBvcGVyYXRvciwgc3RvcmUgd2hldGhlciB0aGF0IG9wZXJhdG9yIGlzCiAgICogYWxsb3dlZCB0byB0cmFuc2ZlciBhbmQgbW9kaWZ5IGFzc2V0cyBvbiBiZWhhbGYgb2YgdGhlbS4KICAgKi8KICBtYXBwaW5nKGFkZHJlc3MgPT4gbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpKSBpbnRlcm5hbCBfb3BlcmF0b3JzOwoKICAvKioKICAgKiBBcHByb3ZhbCBhcnJheQogICAqLwogIG1hcHBpbmcodWludDI1NiA9PiBhZGRyZXNzKSBpbnRlcm5hbCBfYXBwcm92YWw7Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9TdG9yYWdlLnNvbAoKY29udHJhY3QgU3RvcmFnZSBpcyBQcm94eVN0b3JhZ2UsIE93bmFibGVTdG9yYWdlLCBBc3NldFJlZ2lzdHJ5U3RvcmFnZSwgTEFORFN0b3JhZ2Ugewp9CgovLyBGaWxlOiBjb250cmFjdHMvdXBncmFkYWJsZS9JQXBwbGljYXRpb24uc29sCgpjb250cmFjdCBJQXBwbGljYXRpb24gewogIGZ1bmN0aW9uIGluaXRpYWxpemUoYnl0ZXMgZGF0YSkgcHVibGljOwp9CgovLyBGaWxlOiBjb250cmFjdHMvdXBncmFkYWJsZS9Pd25hYmxlLnNvbAoKY29udHJhY3QgT3duYWJsZSBpcyBTdG9yYWdlIHsKCiAgZXZlbnQgT3duZXJVcGRhdGUoYWRkcmVzcyBfcHJldk93bmVyLCBhZGRyZXNzIF9uZXdPd25lcik7CgogIGZ1bmN0aW9uIGJ5dGVzVG9BZGRyZXNzIChieXRlcyBiKSBwdXJlIHB1YmxpYyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICB1aW50IHJlc3VsdCA9IDA7CiAgICBmb3IgKHVpbnQgaSA9IGIubGVuZ3RoLTE7IGkrMSA+IDA7IGktLSkgewogICAgICB1aW50IGMgPSB1aW50KGJbaV0pOwogICAgICB1aW50IHRvX2luYyA9IGMgKiAoIDE2ICoqICgoYi5sZW5ndGggLSBpLTEpICogMikpOwogICAgICByZXN1bHQgKz0gdG9faW5jOwogICAgfQogICAgcmV0dXJuIGFkZHJlc3MocmVzdWx0KTsKICB9CgogIG1vZGlmaWVyIG9ubHlPd25lciB7CiAgICBhc3NlcnQobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBfbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShfbmV3T3duZXIgIT0gb3duZXIpOwogICAgb3duZXIgPSBfbmV3T3duZXI7CiAgfQp9CgovLyBGaWxlOiBjb250cmFjdHMvbGFuZC9JTEFORFJlZ2lzdHJ5LnNvbAoKaW50ZXJmYWNlIElMQU5EUmVnaXN0cnkgewoKICAvLyBMQU5EIGNhbiBiZSBhc3NpZ25lZCBieSB0aGUgb3duZXIKICBmdW5jdGlvbiBhc3NpZ25OZXdQYXJjZWwoaW50IHgsIGludCB5LCBhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWM7CiAgZnVuY3Rpb24gYXNzaWduTXVsdGlwbGVQYXJjZWxzKGludFtdIHgsIGludFtdIHksIGFkZHJlc3MgYmVuZWZpY2lhcnkpIHB1YmxpYzsKCiAgLy8gQWZ0ZXIgb25lIHllYXIsIGxhbmQgY2FuIGJlIGNsYWltZWQgZnJvbSBhbiBpbmFjdGl2ZSBwdWJsaWMga2V5CiAgZnVuY3Rpb24gcGluZygpIHB1YmxpYzsKICBmdW5jdGlvbiBjbGVhckxhbmQoaW50W10geCwgaW50W10geSkgcHVibGljOwoKICAvLyBMQU5ELWNlbnRyaWMgZ2V0dGVycwogIGZ1bmN0aW9uIGVuY29kZVRva2VuSWQoaW50IHgsIGludCB5KSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiBkZWNvZGVUb2tlbklkKHVpbnQgdmFsdWUpIHZpZXcgcHVibGljIHJldHVybnMgKGludCwgaW50KTsKICBmdW5jdGlvbiBleGlzdHMoaW50IHgsIGludCB5KSB2aWV3IHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBvd25lck9mTGFuZChpbnQgeCwgaW50IHkpIHZpZXcgcHVibGljIHJldHVybnMgKGFkZHJlc3MpOwogIGZ1bmN0aW9uIG93bmVyT2ZMYW5kTWFueShpbnRbXSB4LCBpbnRbXSB5KSB2aWV3IHB1YmxpYyByZXR1cm5zIChhZGRyZXNzW10pOwogIGZ1bmN0aW9uIGxhbmRPZihhZGRyZXNzIG93bmVyKSB2aWV3IHB1YmxpYyByZXR1cm5zIChpbnRbXSwgaW50W10pOwogIGZ1bmN0aW9uIGxhbmREYXRhKGludCB4LCBpbnQgeSkgdmlldyBwdWJsaWMgcmV0dXJucyAoc3RyaW5nKTsKCiAgLy8gVHJhbnNmZXIgTEFORAogIGZ1bmN0aW9uIHRyYW5zZmVyTGFuZChpbnQgeCwgaW50IHksIGFkZHJlc3MgdG8pIHB1YmxpYzsKICBmdW5jdGlvbiB0cmFuc2Zlck1hbnlMYW5kKGludFtdIHgsIGludFtdIHksIGFkZHJlc3MgdG8pIHB1YmxpYzsKCiAgLy8gVXBkYXRlIExBTkQKICBmdW5jdGlvbiB1cGRhdGVMYW5kRGF0YShpbnQgeCwgaW50IHksIHN0cmluZyBkYXRhKSBwdWJsaWM7CiAgZnVuY3Rpb24gdXBkYXRlTWFueUxhbmREYXRhKGludFtdIHgsIGludFtdIHksIHN0cmluZyBkYXRhKSBwdWJsaWM7CgogIC8vIEV2ZW50cwoKICBldmVudCBVcGRhdGUoICAKICAgIHVpbnQyNTYgaW5kZXhlZCBhc3NldElkLCAKICAgIGFkZHJlc3MgaW5kZXhlZCBob2xkZXIsICAKICAgIGFkZHJlc3MgaW5kZXhlZCBvcGVyYXRvciwgIAogICAgc3RyaW5nIGRhdGEgIAogICk7Cn0KCi8vIEZpbGU6IGVyYzgyMS9jb250cmFjdHMvSUVSQzcyMUJhc2Uuc29sCgppbnRlcmZhY2UgSUVSQzcyMUJhc2UgewogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CgogIC8vIGZ1bmN0aW9uIGV4aXN0cyh1aW50MjU2IGFzc2V0SWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBhc3NldElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgaG9sZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKCiAgZnVuY3Rpb24gc2FmZVRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgYXNzZXRJZCkgcHVibGljOwogIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IGFzc2V0SWQsIGJ5dGVzIHVzZXJEYXRhKSBwdWJsaWM7CgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgYXNzZXRJZCkgcHVibGljOwoKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgb3BlcmF0b3IsIHVpbnQyNTYgYXNzZXRJZCkgcHVibGljOwogIGZ1bmN0aW9uIHNldEFwcHJvdmFsRm9yQWxsKGFkZHJlc3Mgb3BlcmF0b3IsIGJvb2wgYXV0aG9yaXplZCkgcHVibGljOwoKICBmdW5jdGlvbiBnZXRBcHByb3ZlZEFkZHJlc3ModWludDI1NiBhc3NldElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKICBmdW5jdGlvbiBpc0FwcHJvdmVkRm9yQWxsKGFkZHJlc3Mgb3BlcmF0b3IsIGFkZHJlc3MgYXNzZXRPd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CgogIGZ1bmN0aW9uIGlzQXV0aG9yaXplZChhZGRyZXNzIG9wZXJhdG9yLCB1aW50MjU2IGFzc2V0SWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwoKICBldmVudCBUcmFuc2ZlcigKICAgIGFkZHJlc3MgaW5kZXhlZCBmcm9tLAogICAgYWRkcmVzcyBpbmRleGVkIHRvLAogICAgdWludDI1NiBpbmRleGVkIGFzc2V0SWQsCiAgICBhZGRyZXNzIG9wZXJhdG9yLAogICAgYnl0ZXMgdXNlckRhdGEKICApOwogIGV2ZW50IEFwcHJvdmFsRm9yQWxsKAogICAgYWRkcmVzcyBpbmRleGVkIG9wZXJhdG9yLAogICAgYWRkcmVzcyBpbmRleGVkIGhvbGRlciwKICAgIGJvb2wgYXV0aG9yaXplZAogICk7CiAgZXZlbnQgQXBwcm92YWwoCiAgICBhZGRyZXNzIGluZGV4ZWQgb3duZXIsCiAgICBhZGRyZXNzIGluZGV4ZWQgb3BlcmF0b3IsCiAgICB1aW50MjU2IGluZGV4ZWQgYXNzZXRJZAogICk7Cn0KCi8vIEZpbGU6IGVyYzgyMS9jb250cmFjdHMvSUVSQzcyMVJlY2VpdmVyLnNvbAoKaW50ZXJmYWNlIElFUkM3MjFSZWNlaXZlciB7CiAgZnVuY3Rpb24gb25FUkM3MjFSZWNlaXZlZCgKICAgIHVpbnQyNTYgX3Rva2VuSWQsCiAgICBhZGRyZXNzIF9vbGRPd25lciwKICAgIGJ5dGVzICAgX3VzZXJEYXRhCiAgKSBwdWJsaWMgcmV0dXJucyAoYnl0ZXM0KTsKfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL21hdGgvU2FmZU1hdGguc29sCgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKLy8gRmlsZTogZXJjODIxL2NvbnRyYWN0cy9FUkM3MjFCYXNlLnNvbAoKaW50ZXJmYWNlIEVSQzE2NSB7CiAgZnVuY3Rpb24gc3VwcG9ydHNJbnRlcmZhY2UoYnl0ZXM0IGludGVyZmFjZUlEKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKfQoKY29udHJhY3QgRVJDNzIxQmFzZSBpcyBBc3NldFJlZ2lzdHJ5U3RvcmFnZSwgSUVSQzcyMUJhc2UsIEVSQzE2NSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIC8vCiAgLy8gR2xvYmFsIEdldHRlcnMKICAvLwoKICAvKioKICAgKiBAZGV2IEdldHMgdGhlIHRvdGFsIGFtb3VudCBvZiBhc3NldHMgc3RvcmVkIGJ5IHRoZSBjb250cmFjdAogICAqIEByZXR1cm4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIHRvdGFsIGFtb3VudCBvZiBhc3NldHMKICAgKi8KICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBfY291bnQ7CiAgfQoKICAvLwogIC8vIEFzc2V0LWNlbnRyaWMgZ2V0dGVyIGZ1bmN0aW9ucwogIC8vCgogIC8qKgogICAqIEBkZXYgUXVlcmllcyB3aGF0IGFkZHJlc3Mgb3ducyBhbiBhc3NldC4gVGhpcyBtZXRob2QgZG9lcyBub3QgdGhyb3cuCiAgICogSW4gb3JkZXIgdG8gY2hlY2sgaWYgdGhlIGFzc2V0IGV4aXN0cywgdXNlIHRoZSBgZXhpc3RzYCBmdW5jdGlvbiBvciBjaGVjayBpZiB0aGUKICAgKiByZXR1cm4gdmFsdWUgb2YgdGhpcyBjYWxsIGlzIGAwYC4KICAgKiBAcmV0dXJuIHVpbnQyNTYgdGhlIGFzc2V0SWQKICAgKi8KICBmdW5jdGlvbiBvd25lck9mKHVpbnQyNTYgYXNzZXRJZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcykgewogICAgcmV0dXJuIF9ob2xkZXJPZlthc3NldElkXTsKICB9CgogIC8vCiAgLy8gSG9sZGVyLWNlbnRyaWMgZ2V0dGVyIGZ1bmN0aW9ucwogIC8vCiAgLyoqCiAgICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcwogICAqIEBwYXJhbSBvd25lciBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSBiYWxhbmNlIG9mCiAgICogQHJldHVybiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcwogICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIG93bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gX2Fzc2V0c09mW293bmVyXS5sZW5ndGg7CiAgfQoKICAvLwogIC8vIEF1dGhvcml6YXRpb24gZ2V0dGVycwogIC8vCgogIC8qKgogICAqIEBkZXYgUXVlcnkgd2hldGhlciBhbiBhZGRyZXNzIGhhcyBiZWVuIGF1dGhvcml6ZWQgdG8gbW92ZSBhbnkgYXNzZXRzIG9uIGJlaGFsZiBvZiBzb21lb25lIGVsc2UKICAgKiBAcGFyYW0gb3BlcmF0b3IgdGhlIGFkZHJlc3MgdGhhdCBtaWdodCBiZSBhdXRob3JpemVkCiAgICogQHBhcmFtIGFzc2V0SG9sZGVyIHRoZSBhZGRyZXNzIHRoYXQgcHJvdmlkZWQgdGhlIGF1dGhvcml6YXRpb24KICAgKiBAcmV0dXJuIGJvb2wgdHJ1ZSBpZiB0aGUgb3BlcmF0b3IgaGFzIGJlZW4gYXV0aG9yaXplZCB0byBtb3ZlIGFueSBhc3NldHMKICAgKi8KICBmdW5jdGlvbiBpc0FwcHJvdmVkRm9yQWxsKGFkZHJlc3Mgb3BlcmF0b3IsIGFkZHJlc3MgYXNzZXRIb2xkZXIpCiAgICBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKQogIHsKICAgIHJldHVybiBfb3BlcmF0b3JzW2Fzc2V0SG9sZGVyXVtvcGVyYXRvcl07CiAgfQoKICAvKioKICAgKiBAZGV2IFF1ZXJ5IHdoYXQgYWRkcmVzcyBoYXMgYmVlbiBwYXJ0aWN1bGFybHkgYXV0aG9yaXplZCB0byBtb3ZlIGFuIGFzc2V0CiAgICogQHBhcmFtIGFzc2V0SWQgdGhlIGFzc2V0IHRvIGJlIHF1ZXJpZWQgZm9yCiAgICogQHJldHVybiBib29sIHRydWUgaWYgdGhlIGFzc2V0IGhhcyBiZWVuIGFwcHJvdmVkIGJ5IHRoZSBob2xkZXIKICAgKi8KICBmdW5jdGlvbiBnZXRBcHByb3ZlZEFkZHJlc3ModWludDI1NiBhc3NldElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICByZXR1cm4gX2FwcHJvdmFsW2Fzc2V0SWRdOwogIH0KCiAgLyoqCiAgICogQGRldiBRdWVyeSBpZiBhbiBvcGVyYXRvciBjYW4gbW92ZSBhbiBhc3NldC4KICAgKiBAcGFyYW0gb3BlcmF0b3IgdGhlIGFkZHJlc3MgdGhhdCBtaWdodCBiZSBhdXRob3JpemVkCiAgICogQHBhcmFtIGFzc2V0SWQgdGhlIGFzc2V0IHRoYXQgaGFzIGJlZW4gYGFwcHJvdmVkYCBmb3IgdHJhbnNmZXIKICAgKiBAcmV0dXJuIGJvb2wgdHJ1ZSBpZiB0aGUgYXNzZXQgaGFzIGJlZW4gYXBwcm92ZWQgYnkgdGhlIGhvbGRlcgogICAqLwogIGZ1bmN0aW9uIGlzQXV0aG9yaXplZChhZGRyZXNzIG9wZXJhdG9yLCB1aW50MjU2IGFzc2V0SWQpCiAgICBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKQogIHsKICAgIHJlcXVpcmUob3BlcmF0b3IgIT0gMCk7CiAgICBhZGRyZXNzIG93bmVyID0gb3duZXJPZihhc3NldElkKTsKICAgIGlmIChvcGVyYXRvciA9PSBvd25lcikgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIHJldHVybiBpc0FwcHJvdmVkRm9yQWxsKG9wZXJhdG9yLCBvd25lcikgfHwgZ2V0QXBwcm92ZWRBZGRyZXNzKGFzc2V0SWQpID09IG9wZXJhdG9yOwogIH0KCiAgLy8KICAvLyBBdXRob3JpemF0aW9uCiAgLy8KCiAgLyoqCiAgICogQGRldiBBdXRob3JpemUgYSB0aGlyZCBwYXJ0eSBvcGVyYXRvciB0byBtYW5hZ2UgKHNlbmQpIG1zZy5zZW5kZXIncyBhc3NldAogICAqIEBwYXJhbSBvcGVyYXRvciBhZGRyZXNzIHRvIGJlIGFwcHJvdmVkCiAgICogQHBhcmFtIGF1dGhvcml6ZWQgYm9vbCBzZXQgdG8gdHJ1ZSB0byBhdXRob3JpemUsIGZhbHNlIHRvIHdpdGhkcmF3IGF1dGhvcml6YXRpb24KICAgKi8KICBmdW5jdGlvbiBzZXRBcHByb3ZhbEZvckFsbChhZGRyZXNzIG9wZXJhdG9yLCBib29sIGF1dGhvcml6ZWQpIHB1YmxpYyB7CiAgICBpZiAoYXV0aG9yaXplZCkgewogICAgICByZXF1aXJlKCFpc0FwcHJvdmVkRm9yQWxsKG9wZXJhdG9yLCBtc2cuc2VuZGVyKSk7CiAgICAgIF9hZGRBdXRob3JpemF0aW9uKG9wZXJhdG9yLCBtc2cuc2VuZGVyKTsKICAgIH0gZWxzZSB7CiAgICAgIHJlcXVpcmUoaXNBcHByb3ZlZEZvckFsbChvcGVyYXRvciwgbXNnLnNlbmRlcikpOwogICAgICBfY2xlYXJBdXRob3JpemF0aW9uKG9wZXJhdG9yLCBtc2cuc2VuZGVyKTsKICAgIH0KICAgIEFwcHJvdmFsRm9yQWxsKG9wZXJhdG9yLCBtc2cuc2VuZGVyLCBhdXRob3JpemVkKTsKICB9CgogIC8qKgogICAqIEBkZXYgQXV0aG9yaXplIGEgdGhpcmQgcGFydHkgb3BlcmF0b3IgdG8gbWFuYWdlIG9uZSBwYXJ0aWN1bGFyIGFzc2V0CiAgICogQHBhcmFtIG9wZXJhdG9yIGFkZHJlc3MgdG8gYmUgYXBwcm92ZWQKICAgKiBAcGFyYW0gYXNzZXRJZCBhc3NldCB0byBhcHByb3ZlCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIG9wZXJhdG9yLCB1aW50MjU2IGFzc2V0SWQpIHB1YmxpYyB7CiAgICBhZGRyZXNzIGhvbGRlciA9IG93bmVyT2YoYXNzZXRJZCk7CiAgICByZXF1aXJlKG9wZXJhdG9yICE9IGhvbGRlcik7CiAgICBpZiAoZ2V0QXBwcm92ZWRBZGRyZXNzKGFzc2V0SWQpICE9IG9wZXJhdG9yKSB7CiAgICAgIF9hcHByb3ZhbFthc3NldElkXSA9IG9wZXJhdG9yOwogICAgICBBcHByb3ZhbChob2xkZXIsIG9wZXJhdG9yLCBhc3NldElkKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIF9hZGRBdXRob3JpemF0aW9uKGFkZHJlc3Mgb3BlcmF0b3IsIGFkZHJlc3MgaG9sZGVyKSBwcml2YXRlIHsKICAgIF9vcGVyYXRvcnNbaG9sZGVyXVtvcGVyYXRvcl0gPSB0cnVlOwogIH0KCiAgZnVuY3Rpb24gX2NsZWFyQXV0aG9yaXphdGlvbihhZGRyZXNzIG9wZXJhdG9yLCBhZGRyZXNzIGhvbGRlcikgcHJpdmF0ZSB7CiAgICBfb3BlcmF0b3JzW2hvbGRlcl1bb3BlcmF0b3JdID0gZmFsc2U7CiAgfQoKICAvLwogIC8vIEludGVybmFsIE9wZXJhdGlvbnMKICAvLwoKICBmdW5jdGlvbiBfYWRkQXNzZXRUbyhhZGRyZXNzIHRvLCB1aW50MjU2IGFzc2V0SWQpIGludGVybmFsIHsKICAgIF9ob2xkZXJPZlthc3NldElkXSA9IHRvOwoKICAgIHVpbnQyNTYgbGVuZ3RoID0gYmFsYW5jZU9mKHRvKTsKCiAgICBfYXNzZXRzT2ZbdG9dLnB1c2goYXNzZXRJZCk7CgogICAgX2luZGV4T2ZBc3NldFthc3NldElkXSA9IGxlbmd0aDsKCiAgICBfY291bnQgPSBfY291bnQuYWRkKDEpOwogIH0KCiAgZnVuY3Rpb24gX3JlbW92ZUFzc2V0RnJvbShhZGRyZXNzIGZyb20sIHVpbnQyNTYgYXNzZXRJZCkgaW50ZXJuYWwgewogICAgdWludDI1NiBhc3NldEluZGV4ID0gX2luZGV4T2ZBc3NldFthc3NldElkXTsKICAgIHVpbnQyNTYgbGFzdEFzc2V0SW5kZXggPSBiYWxhbmNlT2YoZnJvbSkuc3ViKDEpOwogICAgdWludDI1NiBsYXN0QXNzZXRJZCA9IF9hc3NldHNPZltmcm9tXVtsYXN0QXNzZXRJbmRleF07CgogICAgX2hvbGRlck9mW2Fzc2V0SWRdID0gMDsKCiAgICAvLyBJbnNlcnQgdGhlIGxhc3QgYXNzZXQgaW50byB0aGUgcG9zaXRpb24gcHJldmlvdXNseSBvY2N1cGllZCBieSB0aGUgYXNzZXQgdG8gYmUgcmVtb3ZlZAogICAgX2Fzc2V0c09mW2Zyb21dW2Fzc2V0SW5kZXhdID0gbGFzdEFzc2V0SWQ7CgogICAgLy8gUmVzaXplIHRoZSBhcnJheQogICAgX2Fzc2V0c09mW2Zyb21dW2xhc3RBc3NldEluZGV4XSA9IDA7CiAgICBfYXNzZXRzT2ZbZnJvbV0ubGVuZ3RoLS07CgogICAgLy8gUmVtb3ZlIHRoZSBhcnJheSBpZiBubyBtb3JlIGFzc2V0cyBhcmUgb3duZWQgdG8gcHJldmVudCBwb2xsdXRpb24KICAgIGlmIChfYXNzZXRzT2ZbZnJvbV0ubGVuZ3RoID09IDApIHsKICAgICAgZGVsZXRlIF9hc3NldHNPZltmcm9tXTsKICAgIH0KCiAgICAvLyBVcGRhdGUgdGhlIGluZGV4IG9mIHBvc2l0aW9ucyBmb3IgdGhlIGFzc2V0CiAgICBfaW5kZXhPZkFzc2V0W2Fzc2V0SWRdID0gMDsKICAgIF9pbmRleE9mQXNzZXRbbGFzdEFzc2V0SWRdID0gYXNzZXRJbmRleDsKCiAgICBfY291bnQgPSBfY291bnQuc3ViKDEpOwogIH0KCiAgZnVuY3Rpb24gX2NsZWFyQXBwcm92YWwoYWRkcmVzcyBob2xkZXIsIHVpbnQyNTYgYXNzZXRJZCkgaW50ZXJuYWwgewogICAgaWYgKG93bmVyT2YoYXNzZXRJZCkgPT0gaG9sZGVyICYmIF9hcHByb3ZhbFthc3NldElkXSAhPSAwKSB7CiAgICAgIF9hcHByb3ZhbFthc3NldElkXSA9IDA7CiAgICAgIEFwcHJvdmFsKGhvbGRlciwgMCwgYXNzZXRJZCk7CiAgICB9CiAgfQoKICAvLwogIC8vIFN1cHBseS1hbHRlcmluZyBmdW5jdGlvbnMKICAvLwoKICBmdW5jdGlvbiBfZ2VuZXJhdGUodWludDI1NiBhc3NldElkLCBhZGRyZXNzIGJlbmVmaWNpYXJ5KSBpbnRlcm5hbCB7CiAgICByZXF1aXJlKF9ob2xkZXJPZlthc3NldElkXSA9PSAwKTsKCiAgICBfYWRkQXNzZXRUbyhiZW5lZmljaWFyeSwgYXNzZXRJZCk7CgogICAgVHJhbnNmZXIoMCwgYmVuZWZpY2lhcnksIGFzc2V0SWQsIG1zZy5zZW5kZXIsICcnKTsKICB9CgogIGZ1bmN0aW9uIF9kZXN0cm95KHVpbnQyNTYgYXNzZXRJZCkgaW50ZXJuYWwgewogICAgYWRkcmVzcyBob2xkZXIgPSBfaG9sZGVyT2ZbYXNzZXRJZF07CiAgICByZXF1aXJlKGhvbGRlciAhPSAwKTsKCiAgICBfcmVtb3ZlQXNzZXRGcm9tKGhvbGRlciwgYXNzZXRJZCk7CgogICAgVHJhbnNmZXIoaG9sZGVyLCAwLCBhc3NldElkLCBtc2cuc2VuZGVyLCAnJyk7CiAgfQoKICAvLwogIC8vIFRyYW5zYWN0aW9uIHJlbGF0ZWQgb3BlcmF0aW9ucwogIC8vCgogIG1vZGlmaWVyIG9ubHlIb2xkZXIodWludDI1NiBhc3NldElkKSB7CiAgICByZXF1aXJlKF9ob2xkZXJPZlthc3NldElkXSA9PSBtc2cuc2VuZGVyKTsKICAgIF87CiAgfQoKICBtb2RpZmllciBvbmx5QXV0aG9yaXplZCh1aW50MjU2IGFzc2V0SWQpIHsKICAgIHJlcXVpcmUoaXNBdXRob3JpemVkKG1zZy5zZW5kZXIsIGFzc2V0SWQpKTsKICAgIF87CiAgfQoKICBtb2RpZmllciBpc0N1cnJlbnRPd25lcihhZGRyZXNzIGZyb20sIHVpbnQyNTYgYXNzZXRJZCkgewogICAgcmVxdWlyZShfaG9sZGVyT2ZbYXNzZXRJZF0gPT0gZnJvbSk7CiAgICBfOwogIH0KCiAgbW9kaWZpZXIgaXNEZXN0aW5hdGFyeURlZmluZWQoYWRkcmVzcyBkZXN0aW5hdGFyeSkgewogICAgcmVxdWlyZShkZXN0aW5hdGFyeSAhPSAwKTsKICAgIF87CiAgfQoKICBtb2RpZmllciBkZXN0aW5hdGFyeUlzTm90SG9sZGVyKHVpbnQyNTYgYXNzZXRJZCwgYWRkcmVzcyB0bykgewogICAgcmVxdWlyZShfaG9sZGVyT2ZbYXNzZXRJZF0gIT0gdG8pOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgQWxpYXMgb2YgYHNhZmVUcmFuc2ZlckZyb20oZnJvbSwgdG8sIGFzc2V0SWQsICcnKWAKICAgKgogICAqIEBwYXJhbSBmcm9tIGFkZHJlc3MgdGhhdCBjdXJyZW50bHkgb3ducyBhbiBhc3NldAogICAqIEBwYXJhbSB0byBhZGRyZXNzIHRvIHJlY2VpdmUgdGhlIG93bmVyc2hpcCBvZiB0aGUgYXNzZXQKICAgKiBAcGFyYW0gYXNzZXRJZCB1aW50MjU2IElEIG9mIHRoZSBhc3NldCB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IGFzc2V0SWQpIHB1YmxpYyB7CiAgICByZXR1cm4gX2RvVHJhbnNmZXJGcm9tKGZyb20sIHRvLCBhc3NldElkLCAnJywgbXNnLnNlbmRlciwgdHJ1ZSk7CiAgfQoKICAvKioKICAgKiBAZGV2IFNlY3VyZWx5IHRyYW5zZmVycyB0aGUgb3duZXJzaGlwIG9mIGEgZ2l2ZW4gYXNzZXQgZnJvbSBvbmUgYWRkcmVzcyB0bwogICAqIGFub3RoZXIgYWRkcmVzcywgY2FsbGluZyB0aGUgbWV0aG9kIGBvbk5GVFJlY2VpdmVkYCBvbiB0aGUgdGFyZ2V0IGFkZHJlc3MgaWYKICAgKiB0aGVyZSdzIGNvZGUgYXNzb2NpYXRlZCB3aXRoIGl0CiAgICoKICAgKiBAcGFyYW0gZnJvbSBhZGRyZXNzIHRoYXQgY3VycmVudGx5IG93bnMgYW4gYXNzZXQKICAgKiBAcGFyYW0gdG8gYWRkcmVzcyB0byByZWNlaXZlIHRoZSBvd25lcnNoaXAgb2YgdGhlIGFzc2V0CiAgICogQHBhcmFtIGFzc2V0SWQgdWludDI1NiBJRCBvZiB0aGUgYXNzZXQgdG8gYmUgdHJhbnNmZXJyZWQKICAgKiBAcGFyYW0gdXNlckRhdGEgYnl0ZXMgYXJiaXRyYXJ5IHVzZXIgaW5mb3JtYXRpb24gdG8gYXR0YWNoIHRvIHRoaXMgdHJhbnNmZXIKICAgKi8KICBmdW5jdGlvbiBzYWZlVHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiBhc3NldElkLCBieXRlcyB1c2VyRGF0YSkgcHVibGljIHsKICAgIHJldHVybiBfZG9UcmFuc2ZlckZyb20oZnJvbSwgdG8sIGFzc2V0SWQsIHVzZXJEYXRhLCBtc2cuc2VuZGVyLCB0cnVlKTsKICB9CgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXJzIHRoZSBvd25lcnNoaXAgb2YgYSBnaXZlbiBhc3NldCBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIgYWRkcmVzcwogICAqIFdhcm5pbmchIFRoaXMgZnVuY3Rpb24gZG9lcyBub3QgYXR0ZW1wdCB0byB2ZXJpZnkgdGhhdCB0aGUgdGFyZ2V0IGFkZHJlc3MgY2FuIHNlbmQKICAgKiB0b2tlbnMuCiAgICoKICAgKiBAcGFyYW0gZnJvbSBhZGRyZXNzIHNlbmRpbmcgdGhlIGFzc2V0CiAgICogQHBhcmFtIHRvIGFkZHJlc3MgdG8gcmVjZWl2ZSB0aGUgb3duZXJzaGlwIG9mIHRoZSBhc3NldAogICAqIEBwYXJhbSBhc3NldElkIHVpbnQyNTYgSUQgb2YgdGhlIGFzc2V0IHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiBhc3NldElkKSBwdWJsaWMgewogICAgcmV0dXJuIF9kb1RyYW5zZmVyRnJvbShmcm9tLCB0bywgYXNzZXRJZCwgJycsIG1zZy5zZW5kZXIsIGZhbHNlKTsKICB9CgogIGZ1bmN0aW9uIF9kb1RyYW5zZmVyRnJvbSgKICAgIGFkZHJlc3MgZnJvbSwKICAgIGFkZHJlc3MgdG8sCiAgICB1aW50MjU2IGFzc2V0SWQsCiAgICBieXRlcyB1c2VyRGF0YSwKICAgIGFkZHJlc3Mgb3BlcmF0b3IsCiAgICBib29sIGRvQ2hlY2sKICApCiAgICBpc0Rlc3RpbmF0YXJ5RGVmaW5lZCh0bykKICAgIGRlc3RpbmF0YXJ5SXNOb3RIb2xkZXIoYXNzZXRJZCwgdG8pCiAgICBpc0N1cnJlbnRPd25lcihmcm9tLCBhc3NldElkKQogICAgb25seUF1dGhvcml6ZWQoYXNzZXRJZCkKICAgIGludGVybmFsCiAgewogICAgYWRkcmVzcyBob2xkZXIgPSBfaG9sZGVyT2ZbYXNzZXRJZF07CiAgICBfcmVtb3ZlQXNzZXRGcm9tKGhvbGRlciwgYXNzZXRJZCk7CiAgICBfY2xlYXJBcHByb3ZhbChob2xkZXIsIGFzc2V0SWQpOwogICAgX2FkZEFzc2V0VG8odG8sIGFzc2V0SWQpOwoKICAgIGlmIChkb0NoZWNrICYmIF9pc0NvbnRyYWN0KHRvKSkgewogICAgICAvLyBFcXVhbHMgdG8gYnl0ZXM0KGtlY2NhazI1Nigib25FUkM3MjFSZWNlaXZlZChhZGRyZXNzLHVpbnQyNTYsYnl0ZXMpIikpCiAgICAgIGJ5dGVzNCBFUkM3MjFfUkVDRUlWRUQgPSBieXRlczQoMHhmMGI5ZTViYSk7CiAgICAgIHJlcXVpcmUoCiAgICAgICAgSUVSQzcyMVJlY2VpdmVyKHRvKS5vbkVSQzcyMVJlY2VpdmVkKAogICAgICAgICAgYXNzZXRJZCwgaG9sZGVyLCB1c2VyRGF0YQogICAgICAgICkgPT0gRVJDNzIxX1JFQ0VJVkVECiAgICAgICk7CiAgICB9CgogICAgVHJhbnNmZXIoaG9sZGVyLCB0bywgYXNzZXRJZCwgb3BlcmF0b3IsIHVzZXJEYXRhKTsKICB9CgogIC8qKgogICAqIEBkZXYgUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGNvbnRyYWN0IGltcGxlbWVudHMgYGludGVyZmFjZUlEYCBhbmQgYGludGVyZmFjZUlEYCBpcyBub3QgMHhmZmZmZmZmZiwgYGZhbHNlYCBvdGhlcndpc2UKICAgKiBAcGFyYW0gIF9pbnRlcmZhY2VJRCBUaGUgaW50ZXJmYWNlIGlkZW50aWZpZXIsIGFzIHNwZWNpZmllZCBpbiBFUkMtMTY1CiAgICovCiAgZnVuY3Rpb24gc3VwcG9ydHNJbnRlcmZhY2UoYnl0ZXM0IF9pbnRlcmZhY2VJRCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewoKICAgIGlmIChfaW50ZXJmYWNlSUQgPT0gMHhmZmZmZmZmZikgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gX2ludGVyZmFjZUlEID09IDB4MDFmZmM5YTcgfHwgX2ludGVyZmFjZUlEID09IDB4N2MwNjMzYzY7CiAgfQoKICAvLwogIC8vIFV0aWxpdGllcwogIC8vCgogIGZ1bmN0aW9uIF9pc0NvbnRyYWN0KGFkZHJlc3MgYWRkcikgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICB1aW50IHNpemU7CiAgICBhc3NlbWJseSB7IHNpemUgOj0gZXh0Y29kZXNpemUoYWRkcikgfQogICAgcmV0dXJuIHNpemUgPiAwOwogIH0KfQoKLy8gRmlsZTogZXJjODIxL2NvbnRyYWN0cy9JRVJDNzIxRW51bWVyYWJsZS5zb2wKCmNvbnRyYWN0IElFUkM3MjFFbnVtZXJhYmxlIHsKCiAgLyoqCiAgICogQG5vdGljZSBFbnVtZXJhdGUgYWN0aXZlIHRva2VucwogICAqIEBkZXYgVGhyb3dzIGlmIGBpbmRleGAgPj0gYHRvdGFsU3VwcGx5KClgLCBvdGhlcndpc2UgU0hBTEwgTk9UIHRocm93LgogICAqIEBwYXJhbSBpbmRleCBBIGNvdW50ZXIgbGVzcyB0aGFuIGB0b3RhbFN1cHBseSgpYAogICAqIEByZXR1cm4gVGhlIGlkZW50aWZpZXIgZm9yIHRoZSBgaW5kZXhgdGggYXNzZXQsIChzb3J0IG9yZGVyIG5vdAogICAqICBzcGVjaWZpZWQpCiAgICovCiAgLy8gVE9ETyAoZW9yZGFubyk6IE5vdCBpbXBsZW1lbnRlZAogIC8vIGZ1bmN0aW9uIHRva2VuQnlJbmRleCh1aW50MjU2IGluZGV4KSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IF9hc3NldElkKTsKCiAgLyoqCiAgICogQG5vdGljZSBDb3VudCBvZiBvd25lcnMgd2hpY2ggb3duIGF0IGxlYXN0IG9uZSBhc3NldAogICAqICBNdXN0IG5vdCB0aHJvdy4KICAgKiBAcmV0dXJuIEEgY291bnQgb2YgdGhlIG51bWJlciBvZiBvd25lcnMgd2hpY2ggb3duIGFzc2V0CiAgICovCiAgLy8gVE9ETyAoZW9yZGFubyk6IE5vdCBpbXBsZW1lbnRlZAogIC8vIGZ1bmN0aW9uIGNvdW50T2ZPd25lcnMoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IF9jb3VudCk7CgogIC8qKgogICAqIEBub3RpY2UgRW51bWVyYXRlIG93bmVycwogICAqIEBkZXYgVGhyb3dzIGlmIGBpbmRleGAgPj0gYGNvdW50T2ZPd25lcnMoKWAsIG90aGVyd2lzZSBtdXN0IG5vdCB0aHJvdy4KICAgKiBAcGFyYW0gaW5kZXggQSBjb3VudGVyIGxlc3MgdGhhbiBgY291bnRPZk93bmVycygpYAogICAqIEByZXR1cm4gVGhlIGFkZHJlc3Mgb2YgdGhlIGBpbmRleGB0aCBvd25lciAoc29ydCBvcmRlciBub3Qgc3BlY2lmaWVkKQogICAqLwogIC8vIFRPRE8gKGVvcmRhbm8pOiBOb3QgaW1wbGVtZW50ZWQKICAvLyBmdW5jdGlvbiBvd25lckJ5SW5kZXgodWludDI1NiBpbmRleCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBvd25lcik7CgogIC8qKgogICAqIEBub3RpY2UgR2V0IGFsbCB0b2tlbnMgb2YgYSBnaXZlbiBhZGRyZXNzCiAgICogQGRldiBUaGlzIGlzIG5vdCBpbnRlbmRlZCB0byBiZSB1c2VkIG9uLWNoYWluCiAgICogQHBhcmFtIG93bmVyIGFkZHJlc3Mgb2YgdGhlIG93bmVyIHRvIHF1ZXJ5CiAgICogQHJldHVybiBhIGxpc3Qgb2YgYWxsIGFzc2V0SWRzIG9mIGEgdXNlcgogICAqLwogIGZ1bmN0aW9uIHRva2Vuc09mKGFkZHJlc3Mgb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTZbXSk7CgogIC8qKgogICAqIEBub3RpY2UgRW51bWVyYXRlIHRva2VucyBhc3NpZ25lZCB0byBhbiBvd25lcgogICAqIEBkZXYgVGhyb3dzIGlmIGBpbmRleGAgPj0gYGJhbGFuY2VPZihvd25lcilgIG9yIGlmCiAgICogIGBvd25lcmAgaXMgdGhlIHplcm8gYWRkcmVzcywgcmVwcmVzZW50aW5nIGludmFsaWQgYXNzZXRzLgogICAqICBPdGhlcndpc2UgdGhpcyBtdXN0IG5vdCB0aHJvdy4KICAgKiBAcGFyYW0gb3duZXIgQW4gYWRkcmVzcyB3aGVyZSB3ZSBhcmUgaW50ZXJlc3RlZCBpbiBhc3NldHMgb3duZWQgYnkgdGhlbQogICAqIEBwYXJhbSBpbmRleCBBIGNvdW50ZXIgbGVzcyB0aGFuIGBiYWxhbmNlT2Yob3duZXIpYAogICAqIEByZXR1cm4gVGhlIGlkZW50aWZpZXIgZm9yIHRoZSBgaW5kZXhgdGggYXNzZXQgYXNzaWduZWQgdG8gYG93bmVyYCwKICAgKiAgIChzb3J0IG9yZGVyIG5vdCBzcGVjaWZpZWQpCiAgICovCiAgZnVuY3Rpb24gdG9rZW5PZk93bmVyQnlJbmRleCgKICAgIGFkZHJlc3Mgb3duZXIsIHVpbnQyNTYgaW5kZXgKICApIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgdG9rZW5JZCk7Cn0KCi8vIEZpbGU6IGVyYzgyMS9jb250cmFjdHMvRVJDNzIxRW51bWVyYWJsZS5zb2wKCmNvbnRyYWN0IEVSQzcyMUVudW1lcmFibGUgaXMgQXNzZXRSZWdpc3RyeVN0b3JhZ2UsIElFUkM3MjFFbnVtZXJhYmxlIHsKCiAgLyoqCiAgICogQG5vdGljZSBHZXQgYWxsIHRva2VucyBvZiBhIGdpdmVuIGFkZHJlc3MKICAgKiBAZGV2IFRoaXMgaXMgbm90IGludGVuZGVkIHRvIGJlIHVzZWQgb24tY2hhaW4KICAgKiBAcGFyYW0gb3duZXIgYWRkcmVzcyBvZiB0aGUgb3duZXIgdG8gcXVlcnkKICAgKiBAcmV0dXJuIGEgbGlzdCBvZiBhbGwgYXNzZXRJZHMgb2YgYSB1c2VyCiAgICovCiAgZnVuY3Rpb24gdG9rZW5zT2YoYWRkcmVzcyBvd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NltdKSB7CiAgICByZXR1cm4gX2Fzc2V0c09mW293bmVyXTsKICB9CgogIC8qKgogICAqIEBub3RpY2UgRW51bWVyYXRlIHRva2VucyBhc3NpZ25lZCB0byBhbiBvd25lcgogICAqIEBkZXYgVGhyb3dzIGlmIGBpbmRleGAgPj0gYGJhbGFuY2VPZihvd25lcilgIG9yIGlmCiAgICogIGBvd25lcmAgaXMgdGhlIHplcm8gYWRkcmVzcywgcmVwcmVzZW50aW5nIGludmFsaWQgYXNzZXRzLgogICAqICBPdGhlcndpc2UgdGhpcyBtdXN0IG5vdCB0aHJvdy4KICAgKiBAcGFyYW0gb3duZXIgQW4gYWRkcmVzcyB3aGVyZSB3ZSBhcmUgaW50ZXJlc3RlZCBpbiBhc3NldHMgb3duZWQgYnkgdGhlbQogICAqIEBwYXJhbSBpbmRleCBBIGNvdW50ZXIgbGVzcyB0aGFuIGBiYWxhbmNlT2Yob3duZXIpYAogICAqIEByZXR1cm4gVGhlIGlkZW50aWZpZXIgZm9yIHRoZSBgaW5kZXhgdGggYXNzZXQgYXNzaWduZWQgdG8gYG93bmVyYCwKICAgKiAgIChzb3J0IG9yZGVyIG5vdCBzcGVjaWZpZWQpCiAgICovCiAgZnVuY3Rpb24gdG9rZW5PZk93bmVyQnlJbmRleCgKICAgIGFkZHJlc3Mgb3duZXIsIHVpbnQyNTYgaW5kZXgKICAgICkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBhc3NldElkKQogIHsKICAgIHJlcXVpcmUoaW5kZXggPCBfYXNzZXRzT2Zbb3duZXJdLmxlbmd0aCk7CiAgICByZXF1aXJlKGluZGV4IDwgKDE8PDEyNykpOwogICAgcmV0dXJuIF9hc3NldHNPZltvd25lcl1baW5kZXhdOwogIH0KCn0KCi8vIEZpbGU6IGVyYzgyMS9jb250cmFjdHMvSUVSQzcyMU1ldGFkYXRhLnNvbAoKY29udHJhY3QgSUVSQzcyMU1ldGFkYXRhIHsKCiAgLyoqCiAgICogQG5vdGljZSBBIGRlc2NyaXB0aXZlIG5hbWUgZm9yIGEgY29sbGVjdGlvbiBvZiBORlRzIGluIHRoaXMgY29udHJhY3QKICAgKi8KICBmdW5jdGlvbiBuYW1lKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nKTsKCiAgLyoqCiAgICogQG5vdGljZSBBbiBhYmJyZXZpYXRlZCBuYW1lIGZvciBORlRzIGluIHRoaXMgY29udHJhY3QKICAgKi8KICBmdW5jdGlvbiBzeW1ib2woKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcpOwoKICAvKioKICAgKiBAbm90aWNlIEEgZGVzY3JpcHRpb24gb2Ygd2hhdCB0aGlzIERBUiBpcyB1c2VkIGZvcgogICAqLwogIGZ1bmN0aW9uIGRlc2NyaXB0aW9uKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nKTsKCiAgLyoqCiAgICogU3RvcmVzIGFyYml0cmFyeSBpbmZvIGFib3V0IGEgdG9rZW4KICAgKi8KICBmdW5jdGlvbiB0b2tlbk1ldGFkYXRhKHVpbnQyNTYgYXNzZXRJZCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nKTsKfQoKLy8gRmlsZTogZXJjODIxL2NvbnRyYWN0cy9FUkM3MjFNZXRhZGF0YS5zb2wKCmNvbnRyYWN0IEVSQzcyMU1ldGFkYXRhIGlzIEFzc2V0UmVnaXN0cnlTdG9yYWdlLCBJRVJDNzIxTWV0YWRhdGEgewogIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBfbmFtZTsKICB9CiAgZnVuY3Rpb24gc3ltYm9sKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nKSB7CiAgICByZXR1cm4gX3N5bWJvbDsKICB9CiAgZnVuY3Rpb24gZGVzY3JpcHRpb24oKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBfZGVzY3JpcHRpb247CiAgfQogIGZ1bmN0aW9uIHRva2VuTWV0YWRhdGEodWludDI1NiBhc3NldElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBfYXNzZXREYXRhW2Fzc2V0SWRdOwogIH0KICBmdW5jdGlvbiBfdXBkYXRlKHVpbnQyNTYgYXNzZXRJZCwgc3RyaW5nIGRhdGEpIGludGVybmFsIHsKICAgIF9hc3NldERhdGFbYXNzZXRJZF0gPSBkYXRhOwogIH0KfQoKLy8gRmlsZTogZXJjODIxL2NvbnRyYWN0cy9GdWxsQXNzZXRSZWdpc3RyeS5zb2wKCmNvbnRyYWN0IEZ1bGxBc3NldFJlZ2lzdHJ5IGlzIEVSQzcyMUJhc2UsIEVSQzcyMUVudW1lcmFibGUsIEVSQzcyMU1ldGFkYXRhIHsKICBmdW5jdGlvbiBGdWxsQXNzZXRSZWdpc3RyeSgpIHB1YmxpYyB7CiAgfQoKICAvKioKICAgKiBAZGV2IE1ldGhvZCB0byBjaGVjayBpZiBhbiBhc3NldCBpZGVudGlmaWVkIGJ5IHRoZSBnaXZlbiBpZCBleGlzdHMgdW5kZXIgdGhpcyBEQVIuCiAgICogQHJldHVybiB1aW50MjU2IHRoZSBhc3NldElkCiAgICovCiAgZnVuY3Rpb24gZXhpc3RzKHVpbnQyNTYgYXNzZXRJZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIF9ob2xkZXJPZlthc3NldElkXSAhPSAwOwogIH0KCiAgZnVuY3Rpb24gZGVjaW1hbHMoKSBwdWJsaWMgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gMDsKICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9sYW5kL0xBTkRSZWdpc3RyeS5zb2wKCmNvbnRyYWN0IExBTkRSZWdpc3RyeSBpcyBTdG9yYWdlLAogIE93bmFibGUsIEZ1bGxBc3NldFJlZ2lzdHJ5LAogIElMQU5EUmVnaXN0cnkKewoKICBmdW5jdGlvbiBpbml0aWFsaXplKGJ5dGVzKSBwdWJsaWMgewogICAgX25hbWUgPSAnRGVjZW50cmFsYW5kIExBTkQnOwogICAgX3N5bWJvbCA9ICdMQU5EJzsKICAgIF9kZXNjcmlwdGlvbiA9ICdDb250cmFjdCB0aGF0IHN0b3JlcyB0aGUgRGVjZW50cmFsYW5kIExBTkQgcmVnaXN0cnknOwogIH0KCiAgbW9kaWZpZXIgb25seVByb3h5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gcHJveHlPd25lcik7CiAgICBfOwogIH0KCiAgLy8KICAvLyBMQU5EIENyZWF0ZSBhbmQgZGVzdHJveQogIC8vCgogIG1vZGlmaWVyIG9ubHlPd25lck9mKHVpbnQyNTYgYXNzZXRJZCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyT2YoYXNzZXRJZCkpOwogICAgXzsKICB9CgogIG1vZGlmaWVyIG9ubHlVcGRhdGVBdXRob3JpemVkKHVpbnQyNTYgdG9rZW5JZCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyT2YodG9rZW5JZCkgfHwgaXNVcGRhdGVBdXRob3JpemVkKG1zZy5zZW5kZXIsIHRva2VuSWQpKTsKICAgIF87CiAgfQoKICBmdW5jdGlvbiBpc1VwZGF0ZUF1dGhvcml6ZWQoYWRkcmVzcyBvcGVyYXRvciwgdWludDI1NiBhc3NldElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gb3BlcmF0b3IgPT0gb3duZXJPZihhc3NldElkKSB8fCB1cGRhdGVPcGVyYXRvclthc3NldElkXSA9PSBvcGVyYXRvcjsKICB9CgogIGZ1bmN0aW9uIGF1dGhvcml6ZURlcGxveShhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgb25seVByb3h5T3duZXIgewogICAgYXV0aG9yaXplZERlcGxveVtiZW5lZmljaWFyeV0gPSB0cnVlOwogIH0KICBmdW5jdGlvbiBmb3JiaWREZXBsb3koYWRkcmVzcyBiZW5lZmljaWFyeSkgcHVibGljIG9ubHlQcm94eU93bmVyIHsKICAgIGF1dGhvcml6ZWREZXBsb3lbYmVuZWZpY2lhcnldID0gZmFsc2U7CiAgfQoKICBmdW5jdGlvbiBhc3NpZ25OZXdQYXJjZWwoaW50IHgsIGludCB5LCBhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgb25seVByb3h5T3duZXIgewogICAgX2dlbmVyYXRlKGVuY29kZVRva2VuSWQoeCwgeSksIGJlbmVmaWNpYXJ5KTsKICB9CgogIGZ1bmN0aW9uIGFzc2lnbk11bHRpcGxlUGFyY2VscyhpbnRbXSB4LCBpbnRbXSB5LCBhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgb25seVByb3h5T3duZXIgewogICAgZm9yICh1aW50IGkgPSAwOyBpIDwgeC5sZW5ndGg7IGkrKykgewogICAgICBfZ2VuZXJhdGUoZW5jb2RlVG9rZW5JZCh4W2ldLCB5W2ldKSwgYmVuZWZpY2lhcnkpOwogICAgfQogIH0KCiAgLy8KICAvLyBJbmFjdGl2ZSBrZXlzIGFmdGVyIDEgeWVhciBsb3NlIG93bmVyc2hpcAogIC8vCgogIGZ1bmN0aW9uIHBpbmcoKSBwdWJsaWMgewogICAgbGF0ZXN0UGluZ1ttc2cuc2VuZGVyXSA9IG5vdzsKICB9CgogIGZ1bmN0aW9uIHNldExhdGVzdFRvTm93KGFkZHJlc3MgdXNlcikgcHVibGljIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBwcm94eU93bmVyIHx8IGlzQXBwcm92ZWRGb3JBbGwobXNnLnNlbmRlciwgdXNlcikpOwogICAgbGF0ZXN0UGluZ1t1c2VyXSA9IG5vdzsKICB9CgogIGZ1bmN0aW9uIGNsZWFyTGFuZChpbnRbXSB4LCBpbnRbXSB5KSBwdWJsaWMgewogICAgcmVxdWlyZSh4Lmxlbmd0aCA9PSB5Lmxlbmd0aCk7CiAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSsrKSB7CiAgICAgIHVpbnQgbGFuZElkID0gZW5jb2RlVG9rZW5JZCh4W2ldLCB5W2ldKTsKICAgICAgYWRkcmVzcyBob2xkZXIgPSBvd25lck9mKGxhbmRJZCk7CiAgICAgIGlmIChsYXRlc3RQaW5nW2hvbGRlcl0gPCBub3cgLSAxIHllYXJzKSB7CiAgICAgICAgX2Rlc3Ryb3kobGFuZElkKTsKICAgICAgfQogICAgfQogIH0KCiAgLy8KICAvLyBMQU5EIEdldHRlcnMKICAvLwoKICBmdW5jdGlvbiBlbmNvZGVUb2tlbklkKGludCB4LCBpbnQgeSkgdmlldyBwdWJsaWMgcmV0dXJucyAodWludCkgewogICAgcmV0dXJuICgodWludCh4KSAqIGZhY3RvcikgJiBjbGVhckxvdykgfCAodWludCh5KSAmIGNsZWFySGlnaCk7CiAgfQoKICBmdW5jdGlvbiBkZWNvZGVUb2tlbklkKHVpbnQgdmFsdWUpIHZpZXcgcHVibGljIHJldHVybnMgKGludCwgaW50KSB7CiAgICB1aW50IHggPSAodmFsdWUgJiBjbGVhckxvdykgPj4gMTI4OwogICAgdWludCB5ID0gKHZhbHVlICYgY2xlYXJIaWdoKTsKICAgIHJldHVybiAoZXhwYW5kTmVnYXRpdmUxMjhCaXRDYXN0KHgpLCBleHBhbmROZWdhdGl2ZTEyOEJpdENhc3QoeSkpOwogIH0KCiAgZnVuY3Rpb24gZXhwYW5kTmVnYXRpdmUxMjhCaXRDYXN0KHVpbnQgdmFsdWUpIHB1cmUgaW50ZXJuYWwgcmV0dXJucyAoaW50KSB7CiAgICBpZiAodmFsdWUgJiAoMTw8MTI3KSAhPSAwKSB7CiAgICAgIHJldHVybiBpbnQodmFsdWUgfCBjbGVhckxvdyk7CiAgICB9CiAgICByZXR1cm4gaW50KHZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGV4aXN0cyhpbnQgeCwgaW50IHkpIHZpZXcgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBleGlzdHMoZW5jb2RlVG9rZW5JZCh4LCB5KSk7CiAgfQoKICBmdW5jdGlvbiBvd25lck9mTGFuZChpbnQgeCwgaW50IHkpIHZpZXcgcHVibGljIHJldHVybnMgKGFkZHJlc3MpIHsKICAgIHJldHVybiBvd25lck9mKGVuY29kZVRva2VuSWQoeCwgeSkpOwogIH0KCiAgZnVuY3Rpb24gb3duZXJPZkxhbmRNYW55KGludFtdIHgsIGludFtdIHkpIHZpZXcgcHVibGljIHJldHVybnMgKGFkZHJlc3NbXSkgewogICAgcmVxdWlyZSh4Lmxlbmd0aCA+IDApOwogICAgcmVxdWlyZSh4Lmxlbmd0aCA9PSB5Lmxlbmd0aCk7CgogICAgYWRkcmVzc1tdIG1lbW9yeSBhZGRycyA9IG5ldyBhZGRyZXNzW10oeC5sZW5ndGgpOwogICAgZm9yICh1aW50IGkgPSAwOyBpIDwgeC5sZW5ndGg7IGkrKykgewogICAgICBhZGRyc1tpXSA9IG93bmVyT2ZMYW5kKHhbaV0sIHlbaV0pOwogICAgfQoKICAgIHJldHVybiBhZGRyczsKICB9CgogIGZ1bmN0aW9uIGxhbmRPZihhZGRyZXNzIG93bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zIChpbnRbXSwgaW50W10pIHsKICAgIHVpbnQyNTYgbGVuID0gX2Fzc2V0c09mW293bmVyXS5sZW5ndGg7CiAgICBpbnRbXSBtZW1vcnkgeCA9IG5ldyBpbnRbXShsZW4pOwogICAgaW50W10gbWVtb3J5IHkgPSBuZXcgaW50W10obGVuKTsKCiAgICBpbnQgYXNzZXRYOwogICAgaW50IGFzc2V0WTsKICAgIGZvciAodWludCBpID0gMDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgIChhc3NldFgsIGFzc2V0WSkgPSBkZWNvZGVUb2tlbklkKF9hc3NldHNPZltvd25lcl1baV0pOwogICAgICB4W2ldID0gYXNzZXRYOwogICAgICB5W2ldID0gYXNzZXRZOwogICAgfQoKICAgIHJldHVybiAoeCwgeSk7CiAgfQoKICBmdW5jdGlvbiBsYW5kRGF0YShpbnQgeCwgaW50IHkpIHZpZXcgcHVibGljIHJldHVybnMgKHN0cmluZykgewogICAgcmV0dXJuIHRva2VuTWV0YWRhdGEoZW5jb2RlVG9rZW5JZCh4LCB5KSk7CiAgfQoKICAvLwogIC8vIExBTkQgVHJhbnNmZXIKICAvLwoKICBmdW5jdGlvbiB0cmFuc2ZlckxhbmQoaW50IHgsIGludCB5LCBhZGRyZXNzIHRvKSBwdWJsaWMgewogICAgdWludDI1NiB0b2tlbklkID0gZW5jb2RlVG9rZW5JZCh4LCB5KTsKICAgIHNhZmVUcmFuc2ZlckZyb20ob3duZXJPZih0b2tlbklkKSwgdG8sIHRva2VuSWQpOwogIH0KCiAgZnVuY3Rpb24gdHJhbnNmZXJNYW55TGFuZChpbnRbXSB4LCBpbnRbXSB5LCBhZGRyZXNzIHRvKSBwdWJsaWMgewogICAgcmVxdWlyZSh4Lmxlbmd0aCA+IDApOwogICAgcmVxdWlyZSh4Lmxlbmd0aCA9PSB5Lmxlbmd0aCk7CgogICAgZm9yICh1aW50IGkgPSAwOyBpIDwgeC5sZW5ndGg7IGkrKykgewogICAgICB1aW50MjU2IHRva2VuSWQgPSBlbmNvZGVUb2tlbklkKHhbaV0sIHlbaV0pOwogICAgICBzYWZlVHJhbnNmZXJGcm9tKG93bmVyT2YodG9rZW5JZCksIHRvLCB0b2tlbklkKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHNldFVwZGF0ZU9wZXJhdG9yKHVpbnQyNTYgYXNzZXRJZCwgYWRkcmVzcyBvcGVyYXRvcikgcHVibGljIG9ubHlPd25lck9mKGFzc2V0SWQpIHsKICAgIHVwZGF0ZU9wZXJhdG9yW2Fzc2V0SWRdID0gb3BlcmF0b3I7CiAgfQoKICAvLwogIC8vIExBTkQgVXBkYXRlCiAgLy8KCiAgZnVuY3Rpb24gdXBkYXRlTGFuZERhdGEoaW50IHgsIGludCB5LCBzdHJpbmcgZGF0YSkgcHVibGljIG9ubHlVcGRhdGVBdXRob3JpemVkIChlbmNvZGVUb2tlbklkKHgsIHkpKSB7CiAgICB1aW50MjU2IGFzc2V0SWQgPSBlbmNvZGVUb2tlbklkKHgsIHkpOwogICAgX3VwZGF0ZShhc3NldElkLCBkYXRhKTsKCiAgICBVcGRhdGUoYXNzZXRJZCwgX2hvbGRlck9mW2Fzc2V0SWRdLCBtc2cuc2VuZGVyLCBkYXRhKTsKICB9CgogIGZ1bmN0aW9uIHVwZGF0ZU1hbnlMYW5kRGF0YShpbnRbXSB4LCBpbnRbXSB5LCBzdHJpbmcgZGF0YSkgcHVibGljIHsKICAgIHJlcXVpcmUoeC5sZW5ndGggPiAwKTsKICAgIHJlcXVpcmUoeC5sZW5ndGggPT0geS5sZW5ndGgpOwogICAgZm9yICh1aW50IGkgPSAwOyBpIDwgeC5sZW5ndGg7IGkrKykgewogICAgICB1cGRhdGVMYW5kRGF0YSh4W2ldLCB5W2ldLCBkYXRhKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIF9kb1RyYW5zZmVyRnJvbSgKICAgIGFkZHJlc3MgZnJvbSwKICAgIGFkZHJlc3MgdG8sCiAgICB1aW50MjU2IGFzc2V0SWQsCiAgICBieXRlcyB1c2VyRGF0YSwKICAgIGFkZHJlc3Mgb3BlcmF0b3IsCiAgICBib29sIGRvQ2hlY2sKICApIGludGVybmFsIHsKICAgIHVwZGF0ZU9wZXJhdG9yW2Fzc2V0SWRdID0gYWRkcmVzcygwKTsKICAgIHN1cGVyLl9kb1RyYW5zZmVyRnJvbShmcm9tLCB0bywgYXNzZXRJZCwgdXNlckRhdGEsIG9wZXJhdG9yLCBkb0NoZWNrKTsKICB9Cn0='.
	

]
