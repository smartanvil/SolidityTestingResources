Class {
	#name : #SRT703805ae406016d5fb716f805f07821018a38922,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT703805ae406016d5fb716f805f07821018a38922 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7Cgpjb250cmFjdCBEU01hdGggewogICAgZnVuY3Rpb24gYWRkKHVpbnQgeCwgdWludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHJlcXVpcmUoKHogPSB4ICsgeSkgPj0geCk7CiAgICB9CiAgICBmdW5jdGlvbiBzdWIodWludCB4LCB1aW50IHkpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCB6KSB7CiAgICAgICAgcmVxdWlyZSgoeiA9IHggLSB5KSA8PSB4KTsKICAgIH0KICAgIGZ1bmN0aW9uIG11bCh1aW50IHgsIHVpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICByZXF1aXJlKHkgPT0gMCB8fCAoeiA9IHggKiB5KSAvIHkgPT0geCk7CiAgICB9CgogICAgZnVuY3Rpb24gbWluKHVpbnQgeCwgdWludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHJldHVybiB4IDw9IHkgPyB4IDogeTsKICAgIH0KICAgIGZ1bmN0aW9uIG1heCh1aW50IHgsIHVpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICByZXR1cm4geCA+PSB5ID8geCA6IHk7CiAgICB9CiAgICBmdW5jdGlvbiBpbWluKGludCB4LCBpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChpbnQgeikgewogICAgICAgIHJldHVybiB4IDw9IHkgPyB4IDogeTsKICAgIH0KICAgIGZ1bmN0aW9uIGltYXgoaW50IHgsIGludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKGludCB6KSB7CiAgICAgICAgcmV0dXJuIHggPj0geSA/IHggOiB5OwogICAgfQoKICAgIHVpbnQgY29uc3RhbnQgV0FEID0gMTAgKiogMTg7CiAgICB1aW50IGNvbnN0YW50IFJBWSA9IDEwICoqIDI3OwoKICAgIGZ1bmN0aW9uIHdtdWwodWludCB4LCB1aW50IHkpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCB6KSB7CiAgICAgICAgeiA9IGFkZChtdWwoeCwgeSksIFdBRCAvIDIpIC8gV0FEOwogICAgfQogICAgZnVuY3Rpb24gcm11bCh1aW50IHgsIHVpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICB6ID0gYWRkKG11bCh4LCB5KSwgUkFZIC8gMikgLyBSQVk7CiAgICB9CiAgICBmdW5jdGlvbiB3ZGl2KHVpbnQgeCwgdWludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHogPSBhZGQobXVsKHgsIFdBRCksIHkgLyAyKSAvIHk7CiAgICB9CiAgICBmdW5jdGlvbiByZGl2KHVpbnQgeCwgdWludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHogPSBhZGQobXVsKHgsIFJBWSksIHkgLyAyKSAvIHk7CiAgICB9CgogICAgLy8gVGhpcyBmYW1vdXMgYWxnb3JpdGhtIGlzIGNhbGxlZCAiZXhwb25lbnRpYXRpb24gYnkgc3F1YXJpbmciCiAgICAvLyBhbmQgY2FsY3VsYXRlcyB4Xm4gd2l0aCB4IGFzIGZpeGVkLXBvaW50IGFuZCBuIGFzIHJlZ3VsYXIgdW5zaWduZWQuCiAgICAvLwogICAgLy8gSXQncyBPKGxvZyBuKSwgaW5zdGVhZCBvZiBPKG4pIGZvciBuYWl2ZSByZXBlYXRlZCBtdWx0aXBsaWNhdGlvbi4KICAgIC8vCiAgICAvLyBUaGVzZSBmYWN0cyBhcmUgd2h5IGl0IHdvcmtzOgogICAgLy8KICAgIC8vICBJZiBuIGlzIGV2ZW4sIHRoZW4geF5uID0gKHheMileKG4vMikuCiAgICAvLyAgSWYgbiBpcyBvZGQsICB0aGVuIHhebiA9IHggKiB4XihuLTEpLAogICAgLy8gICBhbmQgYXBwbHlpbmcgdGhlIGVxdWF0aW9uIGZvciBldmVuIHggZ2l2ZXMKICAgIC8vICAgIHhebiA9IHggKiAoeF4yKV4oKG4tMSkgLyAyKS4KICAgIC8vCiAgICAvLyAgQWxzbywgRVZNIGRpdmlzaW9uIGlzIGZsb29yaW5nIGFuZAogICAgLy8gICAgZmxvb3JbKG4tMSkgLyAyXSA9IGZsb29yW24gLyAyXS4KICAgIC8vCiAgICBmdW5jdGlvbiBycG93KHVpbnQgeCwgdWludCBuKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHogPSBuICUgMiAhPSAwID8geCA6IFJBWTsKCiAgICAgICAgZm9yIChuIC89IDI7IG4gIT0gMDsgbiAvPSAyKSB7CiAgICAgICAgICAgIHggPSBybXVsKHgsIHgpOwoKICAgICAgICAgICAgaWYgKG4gJSAyICE9IDApIHsKICAgICAgICAgICAgICAgIHogPSBybXVsKHosIHgpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgppbnRlcmZhY2UgQXNzZXRJbnRlcmZhY2UgewogICAgLyoKICAgICAqIEltcGxlbWVudHMgRVJDIDIwIHN0YW5kYXJkLgogICAgICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvYmxvYi9mOTA4NjRhM2QyYjJiNDVjNGRlY2Y5NWVmZDI2YjNmMGMyNzYwNTFhL0VJUFMvZWlwLTIwLXRva2VuLXN0YW5kYXJkLm1kCiAgICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICAgICAqCiAgICAgKiAgQWRkZWQgc3VwcG9ydCBmb3IgdGhlIEVSQyAyMjMgInRva2VuRmFsbGJhY2siIG1ldGhvZCBpbiBhICJ0cmFuc2ZlciIgZnVuY3Rpb24gd2l0aCBhIHBheWxvYWQuCiAgICAgKiAgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIyMwogICAgICovCgogICAgLy8gRXZlbnRzCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQgX3ZhbHVlKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludCBfdmFsdWUpOwoKICAgIC8vIFRoZXJlIGlzIG5vIEVSQzIyMyBjb21wYXRpYmxlIFRyYW5zZmVyIGV2ZW50LCB3aXRoIGBfZGF0YWAgaW5jbHVkZWQuCgogICAgLy9FUkMgMjIzCiAgICAvLyBQVUJMSUMgTUVUSE9EUwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8gRVJDIDIwCiAgICAvLyBQVUJMSUMgTUVUSE9EUwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICAvLyBQVUJMSUMgVklFVyBNRVRIT0RTCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHZpZXcgcHVibGljIHJldHVybnMgKHVpbnQgYmFsYW5jZSk7CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQgcmVtYWluaW5nKTsKfQoKaW50ZXJmYWNlIEVSQzIyM0ludGVyZmFjZSB7CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludCB2YWx1ZSkgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50IHZhbHVlLCBieXRlcyBkYXRhKSByZXR1cm5zIChib29sKTsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQgdmFsdWUsIGJ5dGVzIGRhdGEpOwp9Cgpjb250cmFjdCBBc3NldCBpcyBEU01hdGgsIEFzc2V0SW50ZXJmYWNlLCBFUkMyMjNJbnRlcmZhY2UgewoKICAgIC8vIERBVEEgU1RSVUNUVVJFUwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgYmFsYW5jZXM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkpIGFsbG93ZWQ7CiAgICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgICAvLyBQVUJMSUMgTUVUSE9EUwoKICAgIC8qKgogICAgICogQG5vdGljZSBTZW5kIGBfdmFsdWVgIHRva2VucyB0byBgX3RvYCBmcm9tIGBtc2cuc2VuZGVyYAogICAgICogQGRldiBUcmFuc2ZlcnMgc2VuZGVyJ3MgdG9rZW5zIHRvIGEgZ2l2ZW4gYWRkcmVzcwogICAgICogQGRldiBTaW1pbGFyIHRvIHRyYW5zZmVyKGFkZHJlc3MsIHVpbnQsIGJ5dGVzKSwgYnV0IHdpdGhvdXQgX2RhdGEgcGFyYW1ldGVyCiAgICAgKiBAcGFyYW0gX3RvIEFkZHJlc3Mgb2YgdG9rZW4gcmVjZWl2ZXIKICAgICAqIEBwYXJhbSBfdmFsdWUgTnVtYmVyIG9mIHRva2VucyB0byB0cmFuc2ZlcgogICAgICogQHJldHVybiBSZXR1cm5zIHN1Y2Nlc3Mgb2YgZnVuY3Rpb24gY2FsbAogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKQogICAgewogICAgICAgIHVpbnQgY29kZUxlbmd0aDsKICAgICAgICBieXRlcyBtZW1vcnkgZW1wdHk7CgogICAgICAgIGFzc2VtYmx5IHsKICAgICAgICAgICAgLy8gUmV0cmlldmUgdGhlIHNpemUgb2YgdGhlIGNvZGUgb24gdGFyZ2V0IGFkZHJlc3MsIHRoaXMgbmVlZHMgYXNzZW1ibHkuCiAgICAgICAgICAgIGNvZGVMZW5ndGggOj0gZXh0Y29kZXNpemUoX3RvKQogICAgICAgIH0KIAogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlKTsgLy8gc2FuaXR5IGNoZWNrcwogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+PSBiYWxhbmNlc1tfdG9dKTsKCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBzdWIoYmFsYW5jZXNbbXNnLnNlbmRlcl0sIF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOwogICAgICAgIC8vIGlmIChjb2RlTGVuZ3RoID4gMCkgewogICAgICAgIC8vICAgICBFUkMyMjNSZWNlaXZpbmdDb250cmFjdCByZWNlaXZlciA9IEVSQzIyM1JlY2VpdmluZ0NvbnRyYWN0KF90byk7CiAgICAgICAgLy8gICAgIHJlY2VpdmVyLnRva2VuRmFsbGJhY2sobXNnLnNlbmRlciwgX3ZhbHVlLCBlbXB0eSk7CiAgICAgICAgLy8gfQogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlLCBlbXB0eSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAbm90aWNlIFNlbmQgYF92YWx1ZWAgdG9rZW5zIHRvIGBfdG9gIGZyb20gYG1zZy5zZW5kZXJgIGFuZCB0cmlnZ2VyIHRva2VuRmFsbGJhY2sgaWYgc2VuZGVyIGlzIGEgY29udHJhY3QKICAgICAqIEBkZXYgRnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgd2hlbiBhIHVzZXIgb3IgY29udHJhY3Qgd2FudHMgdG8gdHJhbnNmZXIgZnVuZHMKICAgICAqIEBwYXJhbSBfdG8gQWRkcmVzcyBvZiB0b2tlbiByZWNlaXZlcgogICAgICogQHBhcmFtIF92YWx1ZSBOdW1iZXIgb2YgdG9rZW5zIHRvIHRyYW5zZmVyCiAgICAgKiBAcGFyYW0gX2RhdGEgRGF0YSB0byBiZSBzZW50IHRvIHRva2VuRmFsbGJhY2sKICAgICAqIEByZXR1cm4gUmV0dXJucyBzdWNjZXNzIG9mIGZ1bmN0aW9uIGNhbGwKICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBieXRlcyBfZGF0YSkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgICAgdWludCBjb2RlTGVuZ3RoOwoKICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgIC8vIFJldHJpZXZlIHRoZSBzaXplIG9mIHRoZSBjb2RlIG9uIHRhcmdldCBhZGRyZXNzLCB0aGlzIG5lZWRzIGFzc2VtYmx5LgogICAgICAgICAgICBjb2RlTGVuZ3RoIDo9IGV4dGNvZGVzaXplKF90bykKICAgICAgICB9CgogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlKTsgLy8gc2FuaXR5IGNoZWNrcwogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+PSBiYWxhbmNlc1tfdG9dKTsKCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBzdWIoYmFsYW5jZXNbbXNnLnNlbmRlcl0sIF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOwogICAgICAgIC8vIGlmIChjb2RlTGVuZ3RoID4gMCkgewogICAgICAgIC8vICAgICBFUkMyMjNSZWNlaXZpbmdDb250cmFjdCByZWNlaXZlciA9IEVSQzIyM1JlY2VpdmluZ0NvbnRyYWN0KF90byk7CiAgICAgICAgLy8gICAgIHJlY2VpdmVyLnRva2VuRmFsbGJhY2sobXNnLnNlbmRlciwgX3ZhbHVlLCBfZGF0YSk7CiAgICAgICAgLy8gfQogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBUcmFuc2ZlciBgX3ZhbHVlYCB0b2tlbnMgZnJvbSBgX2Zyb21gIHRvIGBfdG9gIGlmIGBtc2cuc2VuZGVyYCBpcyBhbGxvd2VkLgogICAgLy8vIEBub3RpY2UgUmVzdHJpY3Rpb246IEFuIGFjY291bnQgY2FuIG9ubHkgdXNlIHRoaXMgZnVuY3Rpb24gdG8gc2VuZCB0byBpdHNlbGYKICAgIC8vLyBAZGV2IEFsbG93cyBmb3IgYW4gYXBwcm92ZWQgdGhpcmQgcGFydHkgdG8gdHJhbnNmZXIgdG9rZW5zIGZyb20gb25lCiAgICAvLy8gYWRkcmVzcyB0byBhbm90aGVyLiBSZXR1cm5zIHN1Y2Nlc3MuCiAgICAvLy8gQHBhcmFtIF9mcm9tIEFkZHJlc3MgZnJvbSB3aGVyZSB0b2tlbnMgYXJlIHdpdGhkcmF3bi4KICAgIC8vLyBAcGFyYW0gX3RvIEFkZHJlc3MgdG8gd2hlcmUgdG9rZW5zIGFyZSBzZW50LgogICAgLy8vIEBwYXJhbSBfdmFsdWUgTnVtYmVyIG9mIHRva2VucyB0byB0cmFuc2Zlci4KICAgIC8vLyBAcmV0dXJuIFJldHVybnMgc3VjY2VzcyBvZiBmdW5jdGlvbiBjYWxsLgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHJlcXVpcmUoX2Zyb20gIT0gMHgwKTsKICAgICAgICByZXF1aXJlKF90byAhPSAweDApOwogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3ModGhpcykpOwogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbX2Zyb21dID49IF92YWx1ZSk7CiAgICAgICAgcmVxdWlyZShhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUpOwogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+PSBiYWxhbmNlc1tfdG9dKTsKICAgICAgICAvLyByZXF1aXJlKF90byA9PSBtc2cuc2VuZGVyKTsgLy8gY2FuIG9ubHkgdXNlIHRyYW5zZmVyRnJvbSB0byBzZW5kIHRvIHNlbGYKCiAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7CiAgICAgICAgYmFsYW5jZXNbX2Zyb21dIC09IF92YWx1ZTsKICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CgogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8vIEBub3RpY2UgQWxsb3dzIGBfc3BlbmRlcmAgdG8gdHJhbnNmZXIgYF92YWx1ZWAgdG9rZW5zIGZyb20gYG1zZy5zZW5kZXJgIHRvIGFueSBhZGRyZXNzLgogICAgLy8vIEBkZXYgU2V0cyBhcHByb3ZlZCBhbW91bnQgb2YgdG9rZW5zIGZvciBzcGVuZGVyLiBSZXR1cm5zIHN1Y2Nlc3MuCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIEFkZHJlc3Mgb2YgYWxsb3dlZCBhY2NvdW50LgogICAgLy8vIEBwYXJhbSBfdmFsdWUgTnVtYmVyIG9mIGFwcHJvdmVkIHRva2Vucy4KICAgIC8vLyBAcmV0dXJuIFJldHVybnMgc3VjY2VzcyBvZiBmdW5jdGlvbiBjYWxsLgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF9zcGVuZGVyICE9IDB4MCk7CgogICAgICAgIC8vIFRvIGNoYW5nZSB0aGUgYXBwcm92ZSBhbW91bnQgeW91IGZpcnN0IGhhdmUgdG8gcmVkdWNlIHRoZSBhZGRyZXNzZXNgCiAgICAgICAgLy8gYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyBgYXBwcm92ZShfc3BlbmRlciwgMClgIGlmIGl0IGlzIG5vdAogICAgICAgIC8vIGFscmVhZHkgMCB0byBtaXRpZ2F0ZSB0aGUgcmFjZSBjb25kaXRpb24gZGVzY3JpYmVkIGhlcmU6CiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgICAgICAvLyByZXF1aXJlKF92YWx1ZSA9PSAwIHx8IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID09IDApOwoKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBQVUJMSUMgVklFVyBNRVRIT0RTCgogICAgLy8vIEBkZXYgUmV0dXJucyBudW1iZXIgb2YgYWxsb3dlZCB0b2tlbnMgdGhhdCBhIHNwZW5kZXIgY2FuIHRyYW5zZmVyIG9uCiAgICAvLy8gYmVoYWxmIG9mIGEgdG9rZW4gb3duZXIuCiAgICAvLy8gQHBhcmFtIF9vd25lciBBZGRyZXNzIG9mIHRva2VuIG93bmVyLgogICAgLy8vIEBwYXJhbSBfc3BlbmRlciBBZGRyZXNzIG9mIHRva2VuIHNwZW5kZXIuCiAgICAvLy8gQHJldHVybiBSZXR1cm5zIHJlbWFpbmluZyBhbGxvd2FuY2UgZm9yIHNwZW5kZXIuCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpCiAgICAgICAgY29uc3RhbnQKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zICh1aW50KQogICAgewogICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgbnVtYmVyIG9mIHRva2VucyBvd25lZCBieSB0aGUgZ2l2ZW4gYWRkcmVzcy4KICAgIC8vLyBAcGFyYW0gX293bmVyIEFkZHJlc3Mgb2YgdG9rZW4gb3duZXIuCiAgICAvLy8gQHJldHVybiBSZXR1cm5zIGJhbGFuY2Ugb2Ygb3duZXIuCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9Cgp9CgppbnRlcmZhY2UgRVJDMjIzUmVjZWl2aW5nQ29udHJhY3QgewoKICAgIC8vLyBAZGV2IEZ1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIHdoZW4gYSB1c2VyIG9yIGFub3RoZXIgY29udHJhY3Qgd2FudHMgdG8gdHJhbnNmZXIgZnVuZHMuCiAgICAvLy8gQHBhcmFtIF9mcm9tIFRyYW5zYWN0aW9uIGluaXRpYXRvciwgYW5hbG9ndWUgb2YgbXNnLnNlbmRlcgogICAgLy8vIEBwYXJhbSBfdmFsdWUgTnVtYmVyIG9mIHRva2VucyB0byB0cmFuc2Zlci4KICAgIC8vLyBAcGFyYW0gX2RhdGEgRGF0YSBjb250YWluaW5nIGEgZnVuY3Rpb24gc2lnbmF0dXJlIGFuZC9vciBwYXJhbWV0ZXJzCiAgICBmdW5jdGlvbiB0b2tlbkZhbGxiYWNrKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljOwp9Cgpjb250cmFjdCBTaW1wbGVBZGFwdGVyIHsKCiAgICAvLyBDT05TVEFOVCBGSUVMRFMKCiAgICBib29sIHB1YmxpYyBjb25zdGFudCBhcHByb3ZlT25seSA9IGZhbHNlOyAvLyBJZiB0aGUgZXhjaGFuZ2UgaW1wbGVtZW50YXRpb24gcmVxdWlyZXMgYXNzZXQgYXBwcm92ZSBpbnN0ZWFkIG9mIHRyYW5zZmVyIG9uIG1ha2Ugb3JkZXJzCgogICAgLy8gRVZFTlRTCgogICAgZXZlbnQgT3JkZXJVcGRhdGVkKHVpbnQgaWQpOwoKICAgIC8vIFZJRVcgTUVUSE9EUwoKICAgIGZ1bmN0aW9uIGlzQXBwcm92ZU9ubHkoKQogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXR1cm4gYXBwcm92ZU9ubHk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0TGFzdE9yZGVySWQoYWRkcmVzcyBvbkV4Y2hhbmdlKQogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCkKICAgIHsKICAgICAgICByZXR1cm4gU2ltcGxlTWFya2V0KG9uRXhjaGFuZ2UpLmxhc3Rfb2ZmZXJfaWQoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBpc0FjdGl2ZShhZGRyZXNzIG9uRXhjaGFuZ2UsIHVpbnQgaWQpCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHJldHVybiBTaW1wbGVNYXJrZXQob25FeGNoYW5nZSkuaXNBY3RpdmUoaWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldE93bmVyKGFkZHJlc3Mgb25FeGNoYW5nZSwgdWludCBpZCkKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKGFkZHJlc3MpCiAgICB7CiAgICAgICAgcmV0dXJuIFNpbXBsZU1hcmtldChvbkV4Y2hhbmdlKS5nZXRPd25lcihpZCk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0T3JkZXIoYWRkcmVzcyBvbkV4Y2hhbmdlLCB1aW50IGlkKQogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoYWRkcmVzcywgYWRkcmVzcywgdWludCwgdWludCkKICAgIHsKICAgICAgICB2YXIgKAogICAgICAgICAgICBzZWxsUXVhbnRpdHksCiAgICAgICAgICAgIHNlbGxBc3NldCwKICAgICAgICAgICAgYnV5UXVhbnRpdHksCiAgICAgICAgICAgIGJ1eUFzc2V0CiAgICAgICAgKSA9IFNpbXBsZU1hcmtldChvbkV4Y2hhbmdlKS5nZXRPZmZlcihpZCk7CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgYWRkcmVzcyhzZWxsQXNzZXQpLAogICAgICAgICAgICBhZGRyZXNzKGJ1eUFzc2V0KSwKICAgICAgICAgICAgc2VsbFF1YW50aXR5LAogICAgICAgICAgICBidXlRdWFudGl0eQogICAgICAgICk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0VGltZXN0YW1wKGFkZHJlc3Mgb25FeGNoYW5nZSwgdWludCBpZCkKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQpCiAgICB7CiAgICAgICAgdmFyICgsICwgLCAsICwgLCB0aW1lc3RhbXApID0gU2ltcGxlTWFya2V0KG9uRXhjaGFuZ2UpLm9mZmVycyhpZCk7CiAgICAgICAgcmV0dXJuIHRpbWVzdGFtcDsKICAgIH0KCiAgICAvLyBOT04tQ09OU1RBTlQgTUVUSE9EUwoKICAgIC8vLyBAbm90aWNlIE1ha2VzIGFuIG9yZGVyIG9uIHRoZSBnaXZlbiBleGNoYW5nZQogICAgLy8vIEBkZXYgT25seSB1c2UgdGhpcyBpbiBjb250ZXh0IG9mIGEgZGVsZWdhdGVjYWxsLCBhcyBzcGVuZGluZyBvZiBzZWxsQXNzZXQgbmVlZCB0byBiZSBhcHByb3ZlZCBmaXJzdAogICAgLy8vIEBwYXJhbSBvbkV4Y2hhbmdlIEFkZHJlc3Mgb2YgdGhlIGV4Y2hhbmdlCiAgICAvLy8gQHBhcmFtIHNlbGxBc3NldCBBc3NldCAoYXMgcmVnaXN0ZXJlZCBpbiBBc3NldCByZWdpc3RyYXIpIHRvIGJlIHNvbGQKICAgIC8vLyBAcGFyYW0gYnV5QXNzZXQgQXNzZXQgKGFzIHJlZ2lzdGVyZWQgaW4gQXNzZXQgcmVnaXN0cmFyKSB0byBiZSBib3VnaHQKICAgIC8vLyBAcGFyYW0gc2VsbFF1YW50aXR5IFF1YW50aXR5IG9mIHNlbGxBc3NldCB0byBiZSBzb2xkCiAgICAvLy8gQHBhcmFtIGJ1eVF1YW50aXR5IFF1YW50aXR5IG9mIGJ1eUFzc2V0IHRvIGJlIGJvdWdodAogICAgLy8vIEByZXR1cm4gaWQgT3JkZXIgSUQKICAgIGZ1bmN0aW9uIG1ha2VPcmRlcigKICAgICAgICBhZGRyZXNzIG9uRXhjaGFuZ2UsCiAgICAgICAgYWRkcmVzcyBzZWxsQXNzZXQsCiAgICAgICAgYWRkcmVzcyBidXlBc3NldCwKICAgICAgICB1aW50IHNlbGxRdWFudGl0eSwKICAgICAgICB1aW50IGJ1eVF1YW50aXR5CiAgICApCiAgICAgICAgcmV0dXJucyAodWludCBpZCkKICAgIHsKICAgICAgICBpZCA9IFNpbXBsZU1hcmtldChvbkV4Y2hhbmdlKS5vZmZlcigKICAgICAgICAgICAgc2VsbFF1YW50aXR5LAogICAgICAgICAgICBBc3NldChzZWxsQXNzZXQpLAogICAgICAgICAgICBidXlRdWFudGl0eSwKICAgICAgICAgICAgQXNzZXQoYnV5QXNzZXQpCiAgICAgICAgKTsKICAgICAgICBPcmRlclVwZGF0ZWQoaWQpOwogICAgfQoKICAgIC8vLyBAbm90aWNlIFRha2VzIGFuIG9yZGVyIG9uIHRoZSBnaXZlbiBleGNoYW5nZQogICAgLy8vIEBkZXYgRm9yIHRoaXMgc3Vic2V0IG9mIGFkYXB0ZXIgbm8gaW1tZWRpYXRlIHNldHRsZW1lbnQgY2FuIGJlIGV4cGVjdGVkCiAgICAvLy8gQHBhcmFtIG9uRXhjaGFuZ2UgQWRkcmVzcyBvZiB0aGUgZXhjaGFuZ2UKICAgIC8vLyBAcGFyYW0gaWQgT3JkZXIgaWQKICAgIC8vLyBAcGFyYW0gcXVhbnRpdHkgUXVhbnRpdHkgb2Ygb3JkZXIgdG8gYmUgZXhlY3V0ZWQgKEZvciBwYXJ0aWFsIHRha2luZykKICAgIC8vLyBAcmV0dXJuIHN1Y2Nlc3MgV2hldGhlciB0aGUgdGFrZU9yZGVyIGlzIHN1Y2Nlc3NmdWxseSBleGVjdXRlZAogICAgZnVuY3Rpb24gdGFrZU9yZGVyKAogICAgICAgIGFkZHJlc3Mgb25FeGNoYW5nZSwKICAgICAgICB1aW50IGlkLAogICAgICAgIHVpbnQgcXVhbnRpdHkKICAgICkKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgICAgc3VjY2VzcyA9IFNpbXBsZU1hcmtldChvbkV4Y2hhbmdlKS5idXkoaWQsIHF1YW50aXR5KTsKICAgICAgICBPcmRlclVwZGF0ZWQoaWQpOwogICAgfQoKICAgIC8vLyBAbm90aWNlIENhbmNlbHMgYW4gb3JkZXIgb24gdGhlIGdpdmVuIGV4Y2hhbmdlCiAgICAvLy8gQGRldiBPbmx5IHVzZSB0aGlzIGluIGNvbnRleHQgb2YgYSBkZWxlZ2F0ZWNhbGwsIGFzIHNwZW5kaW5nIG9mIHNlbGxBc3NldCBuZWVkIHRvIGJlIGFwcHJvdmVkIGZpcnN0CiAgICAvLy8gQHBhcmFtIG9uRXhjaGFuZ2UgQWRkcmVzcyBvZiB0aGUgZXhjaGFuZ2UKICAgIC8vLyBAcGFyYW0gaWQgT3JkZXIgaWQKICAgIC8vLyBAcmV0dXJuIHN1Y2Nlc3MgV2hldGhlciB0aGUgb3JkZXIgaXMgc3VjY2Vzc2Z1bGx5IGNhbmNlbGxlZAogICAgZnVuY3Rpb24gY2FuY2VsT3JkZXIoCiAgICAgICAgYWRkcmVzcyBvbkV4Y2hhbmdlLAogICAgICAgIHVpbnQgaWQKICAgICkKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgICAgc3VjY2VzcyA9IFNpbXBsZU1hcmtldChvbkV4Y2hhbmdlKS5jYW5jZWwoaWQpOwogICAgICAgIE9yZGVyVXBkYXRlZChpZCk7CiAgICB9Cn0KCmNvbnRyYWN0IEV2ZW50ZnVsTWFya2V0IHsKICAgIGV2ZW50IExvZ0l0ZW1VcGRhdGUodWludCBpZCk7CiAgICBldmVudCBMb2dUcmFkZSh1aW50IHBheV9hbXQsIGFkZHJlc3MgaW5kZXhlZCBwYXlfZ2VtLAogICAgICAgICAgICAgICAgICAgdWludCBidXlfYW10LCBhZGRyZXNzIGluZGV4ZWQgYnV5X2dlbSk7CgogICAgZXZlbnQgTG9nTWFrZSgKICAgICAgICBieXRlczMyICBpbmRleGVkICBpZCwKICAgICAgICBieXRlczMyICBpbmRleGVkICBwYWlyLAogICAgICAgIGFkZHJlc3MgIGluZGV4ZWQgIG1ha2VyLAogICAgICAgIEFzc2V0ICAgICAgICAgICAgIHBheV9nZW0sCiAgICAgICAgQXNzZXQgICAgICAgICAgICAgYnV5X2dlbSwKICAgICAgICB1aW50MTI4ICAgICAgICAgICBwYXlfYW10LAogICAgICAgIHVpbnQxMjggICAgICAgICAgIGJ1eV9hbXQsCiAgICAgICAgdWludDY0ICAgICAgICAgICAgdGltZXN0YW1wCiAgICApOwoKICAgIGV2ZW50IExvZ0J1bXAoCiAgICAgICAgYnl0ZXMzMiAgaW5kZXhlZCAgaWQsCiAgICAgICAgYnl0ZXMzMiAgaW5kZXhlZCAgcGFpciwKICAgICAgICBhZGRyZXNzICBpbmRleGVkICBtYWtlciwKICAgICAgICBBc3NldCAgICAgICAgICAgICBwYXlfZ2VtLAogICAgICAgIEFzc2V0ICAgICAgICAgICAgIGJ1eV9nZW0sCiAgICAgICAgdWludDEyOCAgICAgICAgICAgcGF5X2FtdCwKICAgICAgICB1aW50MTI4ICAgICAgICAgICBidXlfYW10LAogICAgICAgIHVpbnQ2NCAgICAgICAgICAgIHRpbWVzdGFtcAogICAgKTsKCiAgICBldmVudCBMb2dUYWtlKAogICAgICAgIGJ5dGVzMzIgICAgICAgICAgIGlkLAogICAgICAgIGJ5dGVzMzIgIGluZGV4ZWQgIHBhaXIsCiAgICAgICAgYWRkcmVzcyAgaW5kZXhlZCAgbWFrZXIsCiAgICAgICAgQXNzZXQgICAgICAgICAgICAgcGF5X2dlbSwKICAgICAgICBBc3NldCAgICAgICAgICAgICBidXlfZ2VtLAogICAgICAgIGFkZHJlc3MgIGluZGV4ZWQgIHRha2VyLAogICAgICAgIHVpbnQxMjggICAgICAgICAgIHRha2VfYW10LAogICAgICAgIHVpbnQxMjggICAgICAgICAgIGdpdmVfYW10LAogICAgICAgIHVpbnQ2NCAgICAgICAgICAgIHRpbWVzdGFtcAogICAgKTsKCiAgICBldmVudCBMb2dLaWxsKAogICAgICAgIGJ5dGVzMzIgIGluZGV4ZWQgIGlkLAogICAgICAgIGJ5dGVzMzIgIGluZGV4ZWQgIHBhaXIsCiAgICAgICAgYWRkcmVzcyAgaW5kZXhlZCAgbWFrZXIsCiAgICAgICAgQXNzZXQgICAgICAgICAgICAgcGF5X2dlbSwKICAgICAgICBBc3NldCAgICAgICAgICAgICBidXlfZ2VtLAogICAgICAgIHVpbnQxMjggICAgICAgICAgIHBheV9hbXQsCiAgICAgICAgdWludDEyOCAgICAgICAgICAgYnV5X2FtdCwKICAgICAgICB1aW50NjQgICAgICAgICAgICB0aW1lc3RhbXAKICAgICk7Cn0KCmNvbnRyYWN0IFNpbXBsZU1hcmtldCBpcyBFdmVudGZ1bE1hcmtldCwgRFNNYXRoIHsKCiAgICB1aW50IHB1YmxpYyBsYXN0X29mZmVyX2lkOwoKICAgIG1hcHBpbmcgKHVpbnQgPT4gT2ZmZXJJbmZvKSBwdWJsaWMgb2ZmZXJzOwoKICAgIGJvb2wgbG9ja2VkOwoKICAgIHN0cnVjdCBPZmZlckluZm8gewogICAgICAgIHVpbnQgICAgIHBheV9hbXQ7CiAgICAgICAgQXNzZXQgICAgcGF5X2dlbTsKICAgICAgICB1aW50ICAgICBidXlfYW10OwogICAgICAgIEFzc2V0ICAgIGJ1eV9nZW07CiAgICAgICAgYWRkcmVzcyAgb3duZXI7CiAgICAgICAgYm9vbCAgICAgYWN0aXZlOwogICAgICAgIHVpbnQ2NCAgIHRpbWVzdGFtcDsKICAgIH0KCiAgICBtb2RpZmllciBjYW5fYnV5KHVpbnQgaWQpIHsKICAgICAgICByZXF1aXJlKGlzQWN0aXZlKGlkKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBjYW5fY2FuY2VsKHVpbnQgaWQpIHsKICAgICAgICByZXF1aXJlKGlzQWN0aXZlKGlkKSk7CiAgICAgICAgcmVxdWlyZShnZXRPd25lcihpZCkgPT0gbXNnLnNlbmRlcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBjYW5fb2ZmZXIgewogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgc3luY2hyb25pemVkIHsKICAgICAgICBhc3NlcnQoIWxvY2tlZCk7CiAgICAgICAgbG9ja2VkID0gdHJ1ZTsKICAgICAgICBfOwogICAgICAgIGxvY2tlZCA9IGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzQWN0aXZlKHVpbnQgaWQpIGNvbnN0YW50IHJldHVybnMgKGJvb2wgYWN0aXZlKSB7CiAgICAgICAgcmV0dXJuIG9mZmVyc1tpZF0uYWN0aXZlOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldE93bmVyKHVpbnQgaWQpIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3Mgb3duZXIpIHsKICAgICAgICByZXR1cm4gb2ZmZXJzW2lkXS5vd25lcjsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRPZmZlcih1aW50IGlkKSBjb25zdGFudCByZXR1cm5zICh1aW50LCBBc3NldCwgdWludCwgQXNzZXQpIHsKICAgICAgdmFyIG9mZmVyID0gb2ZmZXJzW2lkXTsKICAgICAgcmV0dXJuIChvZmZlci5wYXlfYW10LCBvZmZlci5wYXlfZ2VtLAogICAgICAgICAgICAgIG9mZmVyLmJ1eV9hbXQsIG9mZmVyLmJ1eV9nZW0pOwogICAgfQoKICAgIC8vIC0tLS0gUHVibGljIGVudHJ5cG9pbnRzIC0tLS0gLy8KCiAgICBmdW5jdGlvbiBidW1wKGJ5dGVzMzIgaWRfKQogICAgICAgIGNhbl9idXkodWludDI1NihpZF8pKQogICAgewogICAgICAgIHZhciBpZCA9IHVpbnQyNTYoaWRfKTsKICAgICAgICBMb2dCdW1wKAogICAgICAgICAgICBpZF8sCiAgICAgICAgICAgIGtlY2NhazI1NihvZmZlcnNbaWRdLnBheV9nZW0sIG9mZmVyc1tpZF0uYnV5X2dlbSksCiAgICAgICAgICAgIG9mZmVyc1tpZF0ub3duZXIsCiAgICAgICAgICAgIG9mZmVyc1tpZF0ucGF5X2dlbSwKICAgICAgICAgICAgb2ZmZXJzW2lkXS5idXlfZ2VtLAogICAgICAgICAgICB1aW50MTI4KG9mZmVyc1tpZF0ucGF5X2FtdCksCiAgICAgICAgICAgIHVpbnQxMjgob2ZmZXJzW2lkXS5idXlfYW10KSwKICAgICAgICAgICAgb2ZmZXJzW2lkXS50aW1lc3RhbXAKICAgICAgICApOwogICAgfQoKICAgIC8vIEFjY2VwdCBnaXZlbiBgcXVhbnRpdHlgIG9mIGFuIG9mZmVyLiBUcmFuc2ZlcnMgZnVuZHMgZnJvbSBjYWxsZXIgdG8KICAgIC8vIG9mZmVyIG1ha2VyLCBhbmQgZnJvbSBtYXJrZXQgdG8gY2FsbGVyLgogICAgZnVuY3Rpb24gYnV5KHVpbnQgaWQsIHVpbnQgcXVhbnRpdHkpCiAgICAgICAgY2FuX2J1eShpZCkKICAgICAgICBzeW5jaHJvbml6ZWQKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIE9mZmVySW5mbyBtZW1vcnkgb2ZmZXIgPSBvZmZlcnNbaWRdOwogICAgICAgIHVpbnQgc3BlbmQgPSBtdWwocXVhbnRpdHksIG9mZmVyLmJ1eV9hbXQpIC8gb2ZmZXIucGF5X2FtdDsKCiAgICAgICAgcmVxdWlyZSh1aW50MTI4KHNwZW5kKSA9PSBzcGVuZCk7CiAgICAgICAgcmVxdWlyZSh1aW50MTI4KHF1YW50aXR5KSA9PSBxdWFudGl0eSk7CgogICAgICAgIC8vIEZvciBiYWNrd2FyZHMgc2VtYW50aWMgY29tcGF0aWJpbGl0eS4KICAgICAgICBpZiAocXVhbnRpdHkgPT0gMCB8fCBzcGVuZCA9PSAwIHx8CiAgICAgICAgICAgIHF1YW50aXR5ID4gb2ZmZXIucGF5X2FtdCB8fCBzcGVuZCA+IG9mZmVyLmJ1eV9hbXQpCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBvZmZlcnNbaWRdLnBheV9hbXQgPSBzdWIob2ZmZXIucGF5X2FtdCwgcXVhbnRpdHkpOwogICAgICAgIG9mZmVyc1tpZF0uYnV5X2FtdCA9IHN1YihvZmZlci5idXlfYW10LCBzcGVuZCk7CiAgICAgICAgYXNzZXJ0KCBvZmZlci5idXlfZ2VtLnRyYW5zZmVyRnJvbShtc2cuc2VuZGVyLCB0aGlzLCBzcGVuZCkgKTsKICAgICAgICBhc3NlcnQoIG9mZmVyLmJ1eV9nZW0udHJhbnNmZXIob2ZmZXIub3duZXIsIHNwZW5kKSApOwogICAgICAgIGFzc2VydCggb2ZmZXIucGF5X2dlbS50cmFuc2Zlcihtc2cuc2VuZGVyLCBxdWFudGl0eSkgKTsKCiAgICAgICAgTG9nSXRlbVVwZGF0ZShpZCk7CiAgICAgICAgTG9nVGFrZSgKICAgICAgICAgICAgYnl0ZXMzMihpZCksCiAgICAgICAgICAgIGtlY2NhazI1NihvZmZlci5wYXlfZ2VtLCBvZmZlci5idXlfZ2VtKSwKICAgICAgICAgICAgb2ZmZXIub3duZXIsCiAgICAgICAgICAgIG9mZmVyLnBheV9nZW0sCiAgICAgICAgICAgIG9mZmVyLmJ1eV9nZW0sCiAgICAgICAgICAgIG1zZy5zZW5kZXIsCiAgICAgICAgICAgIHVpbnQxMjgocXVhbnRpdHkpLAogICAgICAgICAgICB1aW50MTI4KHNwZW5kKSwKICAgICAgICAgICAgdWludDY0KG5vdykKICAgICAgICApOwogICAgICAgIExvZ1RyYWRlKHF1YW50aXR5LCBvZmZlci5wYXlfZ2VtLCBzcGVuZCwgb2ZmZXIuYnV5X2dlbSk7CgogICAgICAgIGlmIChvZmZlcnNbaWRdLnBheV9hbXQgPT0gMCkgewogICAgICAgICAgICBkZWxldGUgb2ZmZXJzW2lkXTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vIENhbmNlbCBhbiBvZmZlci4gUmVmdW5kcyBvZmZlciBtYWtlci4KICAgIGZ1bmN0aW9uIGNhbmNlbCh1aW50IGlkKQogICAgICAgIGNhbl9jYW5jZWwoaWQpCiAgICAgICAgc3luY2hyb25pemVkCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKQogICAgewogICAgICAgIC8vIHJlYWQtb25seSBvZmZlci4gTW9kaWZ5IGFuIG9mZmVyIGJ5IGRpcmVjdGx5IGFjY2Vzc2luZyBvZmZlcnNbaWRdCiAgICAgICAgT2ZmZXJJbmZvIG1lbW9yeSBvZmZlciA9IG9mZmVyc1tpZF07CiAgICAgICAgZGVsZXRlIG9mZmVyc1tpZF07CgogICAgICAgIGFzc2VydCggb2ZmZXIucGF5X2dlbS50cmFuc2ZlcihvZmZlci5vd25lciwgb2ZmZXIucGF5X2FtdCkgKTsKCiAgICAgICAgTG9nSXRlbVVwZGF0ZShpZCk7CiAgICAgICAgTG9nS2lsbCgKICAgICAgICAgICAgYnl0ZXMzMihpZCksCiAgICAgICAgICAgIGtlY2NhazI1NihvZmZlci5wYXlfZ2VtLCBvZmZlci5idXlfZ2VtKSwKICAgICAgICAgICAgb2ZmZXIub3duZXIsCiAgICAgICAgICAgIG9mZmVyLnBheV9nZW0sCiAgICAgICAgICAgIG9mZmVyLmJ1eV9nZW0sCiAgICAgICAgICAgIHVpbnQxMjgob2ZmZXIucGF5X2FtdCksCiAgICAgICAgICAgIHVpbnQxMjgob2ZmZXIuYnV5X2FtdCksCiAgICAgICAgICAgIHVpbnQ2NChub3cpCiAgICAgICAgKTsKCiAgICAgICAgc3VjY2VzcyA9IHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24ga2lsbChieXRlczMyIGlkKSB7CiAgICAgICAgYXNzZXJ0KGNhbmNlbCh1aW50MjU2KGlkKSkpOwogICAgfQoKICAgIGZ1bmN0aW9uIG1ha2UoCiAgICAgICAgQXNzZXQgICAgcGF5X2dlbSwKICAgICAgICBBc3NldCAgICBidXlfZ2VtLAogICAgICAgIHVpbnQxMjggIHBheV9hbXQsCiAgICAgICAgdWludDEyOCAgYnV5X2FtdAogICAgKSByZXR1cm5zIChieXRlczMyIGlkKSB7CiAgICAgICAgcmV0dXJuIGJ5dGVzMzIob2ZmZXIocGF5X2FtdCwgcGF5X2dlbSwgYnV5X2FtdCwgYnV5X2dlbSkpOwogICAgfQoKICAgIC8vIE1ha2UgYSBuZXcgb2ZmZXIuIFRha2VzIGZ1bmRzIGZyb20gdGhlIGNhbGxlciBpbnRvIG1hcmtldCBlc2Nyb3cuCiAgICBmdW5jdGlvbiBvZmZlcih1aW50IHBheV9hbXQsIEFzc2V0IHBheV9nZW0sIHVpbnQgYnV5X2FtdCwgQXNzZXQgYnV5X2dlbSkKICAgICAgICBjYW5fb2ZmZXIKICAgICAgICBzeW5jaHJvbml6ZWQKICAgICAgICByZXR1cm5zICh1aW50IGlkKQogICAgewogICAgICAgIHJlcXVpcmUodWludDEyOChwYXlfYW10KSA9PSBwYXlfYW10KTsKICAgICAgICByZXF1aXJlKHVpbnQxMjgoYnV5X2FtdCkgPT0gYnV5X2FtdCk7CiAgICAgICAgcmVxdWlyZShwYXlfYW10ID4gMCk7CiAgICAgICAgcmVxdWlyZShwYXlfZ2VtICE9IEFzc2V0KDB4MCkpOwogICAgICAgIHJlcXVpcmUoYnV5X2FtdCA+IDApOwogICAgICAgIHJlcXVpcmUoYnV5X2dlbSAhPSBBc3NldCgweDApKTsKICAgICAgICByZXF1aXJlKHBheV9nZW0gIT0gYnV5X2dlbSk7CgogICAgICAgIE9mZmVySW5mbyBtZW1vcnkgaW5mbzsKICAgICAgICBpbmZvLnBheV9hbXQgPSBwYXlfYW10OwogICAgICAgIGluZm8ucGF5X2dlbSA9IHBheV9nZW07CiAgICAgICAgaW5mby5idXlfYW10ID0gYnV5X2FtdDsKICAgICAgICBpbmZvLmJ1eV9nZW0gPSBidXlfZ2VtOwogICAgICAgIGluZm8ub3duZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIGluZm8uYWN0aXZlID0gdHJ1ZTsKICAgICAgICBpbmZvLnRpbWVzdGFtcCA9IHVpbnQ2NChub3cpOwogICAgICAgIGlkID0gX25leHRfaWQoKTsKICAgICAgICBvZmZlcnNbaWRdID0gaW5mbzsKCiAgICAgICAgYXNzZXJ0KCBwYXlfZ2VtLnRyYW5zZmVyRnJvbShtc2cuc2VuZGVyLCB0aGlzLCBwYXlfYW10KSApOwoKICAgICAgICBMb2dJdGVtVXBkYXRlKGlkKTsKICAgICAgICBMb2dNYWtlKAogICAgICAgICAgICBieXRlczMyKGlkKSwKICAgICAgICAgICAga2VjY2FrMjU2KHBheV9nZW0sIGJ1eV9nZW0pLAogICAgICAgICAgICBtc2cuc2VuZGVyLAogICAgICAgICAgICBwYXlfZ2VtLAogICAgICAgICAgICBidXlfZ2VtLAogICAgICAgICAgICB1aW50MTI4KHBheV9hbXQpLAogICAgICAgICAgICB1aW50MTI4KGJ1eV9hbXQpLAogICAgICAgICAgICB1aW50NjQobm93KQogICAgICAgICk7CiAgICB9CgogICAgZnVuY3Rpb24gdGFrZShieXRlczMyIGlkLCB1aW50MTI4IG1heFRha2VBbW91bnQpIHsKICAgICAgICBhc3NlcnQoYnV5KHVpbnQyNTYoaWQpLCBtYXhUYWtlQW1vdW50KSk7CiAgICB9CgogICAgZnVuY3Rpb24gX25leHRfaWQoKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgbGFzdF9vZmZlcl9pZCsrOyByZXR1cm4gbGFzdF9vZmZlcl9pZDsKICAgIH0KCiAgICBmdW5jdGlvbiB0b2tlbkZhbGxiYWNrKGFkZHJlc3Mgb2ZTZW5kZXIsIHVpbnQgdG9rZW5BbW91bnQsIGJ5dGVzIG1ldGFkYXRhKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQp9'.
	

]
