Class {
	#name : #SRT72d48d0082fb0f7f01fc4b215651cc55cb25c81a,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT72d48d0082fb0f7f01fc4b215651cc55cb25c81a >> base64 [
	^ 'Y29udHJhY3QgRXRoZXJpemF0aW9uIHsKICAgIAogICAgLy8gMSBldGggc3RhcnRpbmcgcHJpY2UKICAgIHVpbnQgcHVibGljIFNUQVJUX1BSSUNFID0gMTAwMDAwMDAwMDAwMDAwMDAwMDsKICAgIC8vIDAuOCBldGggY2l0eSBidWlsZCBwcmljZQogICAgdWludCBwdWJsaWMgQ0lUWV9QUklDRSA9IDgwMDAwMDAwMDAwMDAwMDAwMDsKICAgIC8vIDAuNSBldGggYnVpbGRpbmcgYnVpbGQgcHJpY2UKICAgIHVpbnQgcHVibGljIEJVSUxESU5HX1BSSUNFID0gNTAwMDAwMDAwMDAwMDAwMDAwOwogICAgLy8gMC4yIGV0aCB1bml0IGJ1aWxkIHByaWNlCiAgICB1aW50IHB1YmxpYyBVTklUX1BSSUNFID0gMjAwMDAwMDAwMDAwMDAwMDAwOwogICAgLy8gMC4wMiBldGggdW5pdCBtYWludGVuYW5jZSBwcmljZQogICAgdWludCBwdWJsaWMgTUFJTlRfUFJJQ0UgPSAyMDAwMDAwMDAwMDAwMDAwMDsKICAgIC8vIDAuMSBldGggbWluIHdpdGhkcmF3IGFtb3VudCB0byBwcmV2ZW50IHNwYW0KICAgIHVpbnQgcHVibGljIE1JTl9XVEggPSAxMDAwMDAwMDAwMDAwMDAwMDA7CiAgICAKICAgIC8vIG1pbmltdW0gdGltZSB0byB3YWl0IGJldHdlZW4gbW92ZXMgaW4gc2Vjb25kcwogICAgdWludCBwdWJsaWMgV0FJVF9USU1FID0gMTQ0MDA7CiAgICB1aW50IE1BUF9ST1dTID0gMzQ7CiAgICB1aW50IE1BUF9DT0xTID0gMzQ7CiAgICAKICAgIAogICAgc3RydWN0IENpdHkgewogICAgICAgIHVpbnQgb3duZXI7CiAgICAgICAgc3RyaW5nIG5hbWU7CiAgICAgICAgLy8gMCAtIHF1YXJyeSwgMSAtIGZhcm0sIDIgLSB3b29kd29ya3MsIDMgLSBtZXRhbHdvcmtzLCA0IC1zdGFibGVzCiAgICAgICAgYm9vbFs1XSBidWlsZGluZ3M7CiAgICAgICAgLy8gMSAtIHBpa2VtZW4sIDIgLSBzd29yZHNtZW4sIDMgLSBob3JzZW1lbgogICAgICAgIHVpbnRbMTBdIHVuaXRzOyAvL21heGltdW0gbnVtIG9mIHVuaXRzIHBlciBjaXR5IDEwCiAgICAgICAgdWludFsyXSByb3djb2w7CiAgICAgICAgaW50IHByZXZpb3VzSUQ7CiAgICAgICAgaW50IG5leHRJRDsKICAgIH0KICAgIAogICAgc3RydWN0IFBsYXllciB7CiAgICAgICAgLy8gUGxheWVyIGFkZHJlc3MKICAgICAgICBhZGRyZXNzIGV0aGVyQWRkcmVzczsKICAgICAgICAvLyBUaGVpciBuYW1lCiAgICAgICAgc3RyaW5nIG5hbWU7CiAgICAgICAgLy8gVGhlaXIgdHJlYXN1cnkgYmFsYW5jZQogICAgICAgIHVpbnQgdHJlYXN1cnk7CiAgICAgICAgLy8gVGhlaXIgY2FwaXRvbAogICAgICAgIHVpbnQgY2FwaXRvbDsKICAgICAgICAvLyBOdW1iZXIgb2YgY2l0aWVzIHRoZSBwbGF5ZXIgaGFzIHVuZGVyIGNvbnRyb2wKICAgICAgICB1aW50IG51bUNpdGllczsKICAgICAgICB1aW50IG51bVVuaXRzOwogICAgICAgIC8vIFdoZW4gd2FzIHRoZWlyIGxhc3QgbW92ZSAoYmFzZWQgb24gYmxvY2sudGltZXN0YW1wKQogICAgICAgIHVpbnQgbGFzdFRpbWVzdGFtcDsKICAgIH0KICAgIAogICAgUGxheWVyIHBsYXllcjsKICAgIFBsYXllcltdIHB1YmxpYyBwbGF5ZXJzOwogICAgdWludCBwdWJsaWMgbnVtUGxheWVycyA9IDA7CiAgICAKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50KSBwbGF5ZXJJRHM7CiAgICBtYXBwaW5nKHVpbnQgPT4gdWludCkgcHVibGljIHBsYXllck1zZ3M7CiAgICAKICAgIENpdHkgY2l0eTsKICAgIENpdHlbXSBwdWJsaWMgY2l0aWVzOwogICAgdWludCBwdWJsaWMgbnVtQ2l0aWVzID0gMDsKICAgIAogICAgdWludFtdIHB1YmxpYyBxdWFycnlDaXRpZXM7CiAgICB1aW50W10gcHVibGljIGZhcm1DaXRpZXM7CiAgICB1aW50W10gcHVibGljIHdvb2R3b3Jrc0NpdGllczsKICAgIHVpbnRbXSBwdWJsaWMgbWV0YWx3b3Jrc0NpdGllczsKICAgIHVpbnRbXSBwdWJsaWMgc3RhYmxlc0NpdGllczsKICAgIAogICAgdWludFszNF1bMzRdIHB1YmxpYyBtYXA7CgogICAgYWRkcmVzcyB3aXphcmRBZGRyZXNzOwogICAgCiAgICBhZGRyZXNzIHV0aWxzQWRkcmVzczsKICAgIGFkZHJlc3MgdXRpbHNBZGRyZXNzMjsKICAgIAogICAgLy8gU3VtIG9mIGFsbCBwbGF5ZXJzJyBiYWxhbmNlcwogICAgdWludCBwdWJsaWMgdG90YWxCYWxhbmNlcyA9IDA7CgogICAgLy8gVXNlZCB0byBlbnN1cmUgb25seSB0aGUgb3duZXIgY2FuIGRvIHNvbWUgdGhpbmdzLgogICAgbW9kaWZpZXIgb25seXdpemFyZCB7IGlmIChtc2cuc2VuZGVyID09IHdpemFyZEFkZHJlc3MpIF87IH0gICAgCiAgICAvLyBVc2VkIHRvIGVuc3VyZSBvbmx5IHRoZSB1dGlscyBjb250cmFjdCBjYW4gZG8gc29tZSB0aGluZ3MuCiAgICBtb2RpZmllciBvbmx5dXRpbHMgeyBpZiAobXNnLnNlbmRlciA9PSB1dGlsc0FkZHJlc3MgfHwgbXNnLnNlbmRlciA9PSB1dGlsc0FkZHJlc3MyKSBfOyB9CgoKICAgIC8vIFNldHMgdXAgZGVmYXVsdHMuCiAgICBmdW5jdGlvbiBFdGhlcml6YXRpb24oKSB7CiAgICAgICAgd2l6YXJkQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgZnVuY3Rpb24gc3RhcnQoc3RyaW5nIHBsYXllck5hbWUsIHN0cmluZyBjaXR5TmFtZSwgdWludCByb3csIHVpbnQgY29sLCB1aW50IHJvd3JlZiwgdWludCBjb2xyZWYpIHsKICAgICAgICAKICAgICAgICAKICAgICAgICAvLyBJZiB0aGV5IHBhaWQgdG9vIGxpdHRsZSwgcmVqZWN0IGFuZCByZWZ1bmQgdGhlaXIgbW9uZXkuCiAgICAgICAgaWYgKG1zZy52YWx1ZSA8IFNUQVJUX1BSSUNFKSB7CiAgICAgICAgICAgIC8vbXNnLnNlbmRlci5zZW5kKG1zZy52YWx1ZSk7CiAgICAgICAgICAgIC8vcGxheWVyTXNnc1ttc2cuc2VuZGVyXSA9ICJOb3QgZW5vdWdoIGV0aGVyIHNlbnQgdG8gZm91bmQgYSBjaXR5IGFuZCBzdGFydCBwbGF5aW5nLiBTZW5kaW5nIGJhY2sgYW55IGV0aCBzZW50Li4uIjsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICAvLyBJZiB0aGUgcGxheWVyIGFscmVhZHkgZXhpc3RzCiAgICAgICAgaWYgKHBsYXllcklEc1ttc2cuc2VuZGVyXSA+IDApIHsKICAgICAgICAgICAgLy9tc2cuc2VuZGVyLnNlbmQobXNnLnZhbHVlKTsKICAgICAgICAgICAgLy9wbGF5ZXJNc2dzW21zZy5zZW5kZXJdID0gICJZb3UgYWxyZWFkeSBmb3VuZGVkIGFuIGV0aGVyaXphdGlvbi4gTG9va3VwIHlvdXIgcGxheWVyIElEIGJ5IGNhbGxpbmcgZ2V0TXlQbGF5ZXJJRCgpLiBTZW5kaW5nIGJhY2sgYW55IGV0aCBzZW50Li4uIjsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwbGF5ZXIuZXRoZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICBwbGF5ZXIubmFtZSA9IHBsYXllck5hbWU7CiAgICAgICAgcGxheWVyLnRyZWFzdXJ5ID0gbXNnLnZhbHVlOwogICAgICAgIHRvdGFsQmFsYW5jZXMgKz0gbXNnLnZhbHVlOwogICAgICAgIHBsYXllci5jYXBpdG9sID0gbnVtQ2l0aWVzOwogICAgICAgIHBsYXllci5udW1DaXRpZXMgPSAxOwogICAgICAgIHBsYXllci5udW1Vbml0cyA9IDE7CgogICAgICAgIHBsYXllcnMucHVzaChwbGF5ZXIpOwogICAgICAgIAogICAgICAgIGNpdHkub3duZXIgPSBudW1QbGF5ZXJzOwogICAgICAgIGNpdHkubmFtZSA9IGNpdHlOYW1lOwogICAgICAgIC8vIHRoZSBmaXJzdCBjaXR5IGluIHRoZSBnYW1lIGhhcyBhIHF1YXJyeSBhbmQgYSBmYXJtIGJ5IGRlZmF1bHQKICAgICAgICBpZihudW1DaXRpZXMgPD0gMCkgewogICAgICAgICAgICBjaXR5LmJ1aWxkaW5nc1swXSA9IHRydWU7CiAgICAgICAgICAgIHF1YXJyeUNpdGllcy5wdXNoKDApOwogICAgICAgICAgICBjaXR5LmJ1aWxkaW5nc1sxXSA9IHRydWU7CiAgICAgICAgICAgIGZhcm1DaXRpZXMucHVzaCgwKTsKICAgICAgICAgICAgY2l0eS5yb3djb2xbMF0gPSAxMDsKICAgICAgICAgICAgY2l0eS5yb3djb2xbMV0gPSAxMDsKICAgICAgICAgICAgbWFwWzEwXVsxMF0gPSBudW1QbGF5ZXJzKzE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY2l0eS5idWlsZGluZ3NbMF0gPSBmYWxzZTsKICAgICAgICAgICAgY2l0eS5idWlsZGluZ3NbMV0gPSBmYWxzZTsKICAgICAgICAgICAgaWYocm93PjMzIHx8IGNvbD4zMyB8fCByb3dyZWY+MzMgfHwgY29scmVmPjMzIHx8IGludChyb3cpLWludChyb3dyZWYpID4gaW50KDEpIHx8IGludChyb3cpLWludChyb3dyZWYpIDwgaW50KC0xKSB8fCBpbnQoY29sKS1pbnQoY29scmVmKSA+IGludCgxKSB8fCBpbnQoY29sKS1pbnQoY29scmVmKSA8IGludCgtMSkgfHwgbWFwW3Jvd11bY29sXT4wIHx8IG1hcFtyb3dyZWZdW2NvbHJlZl08PTApIHsKICAgICAgICAgICAgICAgIHRocm93OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNpdHkucm93Y29sWzBdID0gcm93OwogICAgICAgICAgICBjaXR5LnJvd2NvbFsxXSA9IGNvbDsKICAgICAgICAgICAgbWFwW3Jvd11bY29sXSA9IG51bVBsYXllcnMrMTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHBsYXllcnNbbnVtUGxheWVyc10udHJlYXN1cnkgLT0gU1RBUlRfUFJJQ0U7CiAgICAgICAgICAgIC8vIGRpc3RyaWJ1dGUgYnVpbGQgZnVuZHMgdG8gcHJvZHVjdGlvbiB0eXBlIGJ1aWxkaW5nIG93bmVycwogICAgICAgICAgICB1aW50IHByb2R1Y3Rpb25DdXQ7CiAgICAgICAgICAgIHVpbnQgaTsKICAgICAgICAgICAgcHJvZHVjdGlvbkN1dCA9IFNUQVJUX1BSSUNFIC8gcXVhcnJ5Q2l0aWVzLmxlbmd0aDsKICAgICAgICAgICAgZm9yKGk9MDsgaSA8IHF1YXJyeUNpdGllcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgcGxheWVyc1tjaXRpZXNbcXVhcnJ5Q2l0aWVzW2ldXS5vd25lcl0udHJlYXN1cnkgKz0gcHJvZHVjdGlvbkN1dDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjaXR5LnVuaXRzWzBdID0gMTsgIC8vcGlrZW1lbiBndWFyZHMgYSBjaXR5IGJ5IGRlZmF1bHQKICAgICAgICBjaXR5LnByZXZpb3VzSUQgPSAtMTsKICAgICAgICBjaXR5Lm5leHRJRCA9IC0xOwogICAgICAgIAogICAgICAgIGNpdGllcy5wdXNoKGNpdHkpOwogICAgICAgIAogICAgICAgIHBsYXllcklEc1ttc2cuc2VuZGVyXSA9IG51bVBsYXllcnMrMTsgLy90byBkaXN0aW5ndWlzaCBpdCBmcm9tIHRoZSBkZWZhdWx0IDAKICAgICAgICBudW1QbGF5ZXJzKys7CiAgICAgICAgbnVtQ2l0aWVzKys7CiAgICAgICAgCiAgICAgICAgcGxheWVyTXNnc1twbGF5ZXJJRHNbbXNnLnNlbmRlcl0tMV0gPSAxICsgcm93KjEwMCArIGNvbCoxMDAwMDsKICAgICAgICBwbGF5ZXJzW251bVBsYXllcnMtMV0ubGFzdFRpbWVzdGFtcCA9IG5vdzsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZGVwb3NpdCgpIHsKICAgICAgICBwbGF5ZXJzW3BsYXllcklEc1ttc2cuc2VuZGVyXS0xXS50cmVhc3VyeSArPSBtc2cudmFsdWU7CiAgICAgICAgdG90YWxCYWxhbmNlcyArPSBtc2cudmFsdWU7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHdpdGhkcmF3KHVpbnQgYW1vdW50KSB7CiAgICAgICAgaWYoaW50KHBsYXllcklEc1ttc2cuc2VuZGVyXSktMSA8IDApIHsKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgfQogICAgICAgIHVpbnQgcGxheWVySUQgPSBwbGF5ZXJJRHNbbXNnLnNlbmRlcl0tMTsKICAgICAgICBpZih0aW1lUGFzc2VkKHBsYXllcklEKSA8IFdBSVRfVElNRSkgewogICAgICAgICAgICBwbGF5ZXJNc2dzW3BsYXllcklEc1ttc2cuc2VuZGVyXS0xXSA9IDI7CiAgICAgICAgICAgIHJldHVybjsgICAgICAgIAogICAgICAgIH0KICAgICAgICBpZihhbW91bnQgPCBwbGF5ZXJzW3BsYXllcklEXS50cmVhc3VyeSAmJiBhbW91bnQgPiBNSU5fV1RIKSB7CiAgICAgICAgICAgIHBsYXllcnNbcGxheWVySURdLnRyZWFzdXJ5IC09IGFtb3VudDsKICAgICAgICAgICAgdG90YWxCYWxhbmNlcyAtPSBhbW91bnQ7CiAgICAgICAgICAgIHBsYXllcnNbcGxheWVySURdLmV0aGVyQWRkcmVzcy5zZW5kKChhbW91bnQqOTkpLzEwMCk7IC8va2VlcCAxJSBhcyBjb21taXNzaW9uCiAgICAgICAgfQogICAgfQogICAgCiAgICAKICAgIAogICAgZnVuY3Rpb24gZ2V0TXlQbGF5ZXJJRCgpIGNvbnN0YW50IHJldHVybnMgKGludCBJRCkgewogICAgICAgIHJldHVybiBpbnQocGxheWVySURzW21zZy5zZW5kZXJdKS0xOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRNeU1zZygpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcykgewogICAgICAgIHJldHVybiBwbGF5ZXJNc2dzW3BsYXllcklEc1ttc2cuc2VuZGVyXS0xXTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0Q2l0eSh1aW50IGNpdHlJRCkgY29uc3RhbnQgcmV0dXJucyAodWludCBvd25lciwgc3RyaW5nIGNpdHlOYW1lLCBib29sWzVdIGJ1aWxkaW5ncywgdWludFsxMF0gdW5pdHMsIHVpbnRbMl0gcm93Y29sLCBpbnQgcHJldmlvdXNJRCwgaW50IG5leHRJRCkgewogICAgICAgIHJldHVybiAoY2l0aWVzW2NpdHlJRF0ub3duZXIsIGNpdGllc1tjaXR5SURdLm5hbWUsIGNpdGllc1tjaXR5SURdLmJ1aWxkaW5ncywgY2l0aWVzW2NpdHlJRF0udW5pdHMsIGNpdGllc1tjaXR5SURdLnJvd2NvbCwgY2l0aWVzW2NpdHlJRF0ucHJldmlvdXNJRCwgY2l0aWVzW2NpdHlJRF0ubmV4dElEKTsKICAgIH0KICAgIAogICAgCiAgICBmdW5jdGlvbiB0aW1lUGFzc2VkKHVpbnQgcGxheWVySUQpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgdHApIHsKICAgICAgICByZXR1cm4gKG5vdyAtIHBsYXllcnNbcGxheWVySURdLmxhc3RUaW1lc3RhbXApOwogICAgfQoKCiAgICAvLyBVc2VkIG9ubHkgYnkgdGhlIHdpemFyZCB0byBjaGVjayBoaXMgY29tbWlzc2lvbi4KICAgIGZ1bmN0aW9uIGdldENvbW1pc3Npb24oKSBvbmx5d2l6YXJkIGNvbnN0YW50IHJldHVybnMgKHVpbnQgY29tKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuYmFsYW5jZS10b3RhbEJhbGFuY2VzOwogICAgfQoKICAgIC8vIFVzZWQgb25seSBieSB0aGUgd2l6YXJkIHRvIGNvbGxlY3QgaGlzIGNvbW1pc3Npb24uCiAgICBmdW5jdGlvbiBzd2VlcENvbW1pc3Npb24odWludCBhbW91bnQpIG9ubHl3aXphcmQgewogICAgICAgIGlmKGFtb3VudCA8IHRoaXMuYmFsYW5jZS10b3RhbEJhbGFuY2VzKSB7CiAgICAgICAgICAgIHdpemFyZEFkZHJlc3Muc2VuZChhbW91bnQpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgCiAgICAKICAgIGZ1bmN0aW9uIHNldFV0aWxzKGFkZHJlc3MgYSkgb25seXdpemFyZCB7CiAgICAgICAgdXRpbHNBZGRyZXNzID0gYTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gc2V0VXRpbHMyKGFkZHJlc3MgYSkgb25seXdpemFyZCB7CiAgICAgICAgdXRpbHNBZGRyZXNzMiA9IGE7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldFBsYXllcklEKGFkZHJlc3Mgc2VuZGVyKSBvbmx5dXRpbHMgY29uc3RhbnQgcmV0dXJucyAodWludCBwbGF5ZXJJRCkgewogICAgICAgIGlmKGludChwbGF5ZXJJRHNbc2VuZGVyXSktMSA8IDApIHsKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgfQogICAgICAgIHJldHVybiBwbGF5ZXJJRHNbc2VuZGVyXS0xOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRXd0xlbmd0aCgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgbGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIHdvb2R3b3Jrc0NpdGllcy5sZW5ndGg7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldE13TGVuZ3RoKCkgY29uc3RhbnQgcmV0dXJucyAodWludCBsZW5ndGgpIHsKICAgICAgICByZXR1cm4gbWV0YWx3b3Jrc0NpdGllcy5sZW5ndGg7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldFN0TGVuZ3RoKCkgY29uc3RhbnQgcmV0dXJucyAodWludCBsZW5ndGgpIHsKICAgICAgICByZXR1cm4gc3RhYmxlc0NpdGllcy5sZW5ndGg7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldEZtTGVuZ3RoKCkgY29uc3RhbnQgcmV0dXJucyAodWludCBsZW5ndGgpIHsKICAgICAgICByZXR1cm4gZmFybUNpdGllcy5sZW5ndGg7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldFFyTGVuZ3RoKCkgY29uc3RhbnQgcmV0dXJucyAodWludCBsZW5ndGgpIHsKICAgICAgICByZXR1cm4gcXVhcnJ5Q2l0aWVzLmxlbmd0aDsKICAgIH0KICAgIAogICAgCiAgICBmdW5jdGlvbiBzZXRNc2coYWRkcmVzcyBzZW5kZXIsIHVpbnQgcykgb25seXV0aWxzIHsKICAgICAgICBwbGF5ZXJNc2dzW3BsYXllcklEc1tzZW5kZXJdLTFdID0gczsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gc2V0TnVtQ2l0aWVzKHVpbnQgbmMpIG9ubHl1dGlscyB7CiAgICAgICAgbnVtQ2l0aWVzID0gbmM7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHNldFVuaXQodWludCBjaXR5SUQsIHVpbnQgaSwgdWludCB1bml0VHlwZSkgb25seXV0aWxzIHsKICAgICAgICBjaXRpZXNbY2l0eUlEXS51bml0c1tpXSA9IHVuaXRUeXBlOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBzZXRPd25lcih1aW50IGNpdHlJRCwgdWludCBvd25lcikgb25seXV0aWxzIHsKICAgICAgICBjaXRpZXNbY2l0eUlEXS5vd25lciA9IG93bmVyOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBzZXROYW1lKHVpbnQgY2l0eUlELCBzdHJpbmcgbmFtZSkgb25seXV0aWxzIHsKICAgICAgICBjaXRpZXNbY2l0eUlEXS5uYW1lID0gbmFtZTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gc2V0UHJldmlvdXNJRCh1aW50IGNpdHlJRCwgaW50IHByZXZpb3VzSUQpIG9ubHl1dGlscyB7CiAgICAgICAgY2l0aWVzW2NpdHlJRF0ucHJldmlvdXNJRCA9IHByZXZpb3VzSUQ7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHNldE5leHRJRCh1aW50IGNpdHlJRCwgaW50IG5leHRJRCkgb25seXV0aWxzIHsKICAgICAgICBjaXRpZXNbY2l0eUlEXS5uZXh0SUQgPSBuZXh0SUQ7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHNldFJvd2NvbCh1aW50IGNpdHlJRCwgdWludFsyXSByb3djb2wpIG9ubHl1dGlscyB7CiAgICAgICAgY2l0aWVzW2NpdHlJRF0ucm93Y29sID0gcm93Y29sOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBzZXRNYXAodWludCByb3csIHVpbnQgY29sLCB1aW50IGluZCkgb25seXV0aWxzIHsKICAgICAgICBtYXBbcm93XVtjb2xdID0gaW5kOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBzZXRDYXBpdG9sKHVpbnQgcGxheWVySUQsIHVpbnQgY2FwaXRvbCkgb25seXV0aWxzIHsKICAgICAgICBwbGF5ZXJzW3BsYXllcklEXS5jYXBpdG9sID0gY2FwaXRvbDsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXROdW1Vbml0cyh1aW50IHBsYXllcklELCB1aW50IG51bVVuaXRzKSBvbmx5dXRpbHMgewogICAgICAgIHBsYXllcnNbcGxheWVySURdLm51bVVuaXRzID0gbnVtVW5pdHM7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHNldE51bUNpdGllcyh1aW50IHBsYXllcklELCB1aW50IG51bUNpdGllcykgb25seXV0aWxzIHsKICAgICAgICBwbGF5ZXJzW3BsYXllcklEXS5udW1DaXRpZXMgPSBudW1DaXRpZXM7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHNldFRyZWFzdXJ5KHVpbnQgcGxheWVySUQsIHVpbnQgdHJlYXN1cnkpIG9ubHl1dGlscyB7CiAgICAgICAgcGxheWVyc1twbGF5ZXJJRF0udHJlYXN1cnkgPSB0cmVhc3VyeTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gc2V0TGFzdFRpbWVzdGFtcCh1aW50IHBsYXllcklELCB1aW50IHRpbWVzdGFtcCkgb25seXV0aWxzIHsKICAgICAgICBwbGF5ZXJzW3BsYXllcklEXS5sYXN0VGltZXN0YW1wID0gdGltZXN0YW1wOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBzZXRCdWlsZGluZyh1aW50IGNpdHlJRCwgdWludCBidWlsZGluZ1R5cGUpIG9ubHl1dGlscyB7CiAgICAgICAgY2l0aWVzW2NpdHlJRF0uYnVpbGRpbmdzW2J1aWxkaW5nVHlwZV0gPSB0cnVlOwogICAgICAgIGlmKGJ1aWxkaW5nVHlwZSA9PSAwKSB7CiAgICAgICAgICAgIHF1YXJyeUNpdGllcy5wdXNoKGNpdHlJRCk7CiAgICAgICAgfSBlbHNlIGlmKGJ1aWxkaW5nVHlwZSA9PSAxKSB7CiAgICAgICAgICAgIGZhcm1DaXRpZXMucHVzaChjaXR5SUQpOwogICAgICAgIH0gZWxzZSBpZihidWlsZGluZ1R5cGUgPT0gMikgewogICAgICAgICAgICB3b29kd29ya3NDaXRpZXMucHVzaChjaXR5SUQpOwogICAgICAgIH0gZWxzZSBpZihidWlsZGluZ1R5cGUgPT0gMykgewogICAgICAgICAgICBtZXRhbHdvcmtzQ2l0aWVzLnB1c2goY2l0eUlEKTsKICAgICAgICB9IGVsc2UgaWYoYnVpbGRpbmdUeXBlID09IDQpIHsKICAgICAgICAgICAgc3RhYmxlc0NpdGllcy5wdXNoKGNpdHlJRCk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jdGlvbiBwdXNoQ2l0eSgpIG9ubHl1dGlscyB7CiAgICAgICAgY2l0eS5idWlsZGluZ3NbMF0gPSBmYWxzZTsKICAgICAgICBjaXR5LmJ1aWxkaW5nc1sxXSA9IGZhbHNlOwogICAgICAgIGNpdGllcy5wdXNoKGNpdHkpOwogICAgfQoKfQoKCgoKCmNvbnRyYWN0IEV0aGVyaXphdGlvblV0aWxzIHsKICAgIAogICAgLy91aW50WzJdIHNSb3djb2w7CiAgICAvL3VpbnRbMl0gdFJvd2NvbDsKICAgIAogICAgRXRoZXJpemF0aW9uIHB1YmxpYyBlOwogICAgCiAgICBhZGRyZXNzIHdpemFyZEFkZHJlc3M7CiAgICAKICAgIC8vIFVzZWQgdG8gZW5zdXJlIG9ubHkgdGhlIG93bmVyIGNhbiBkbyBzb21lIHRoaW5ncy4KICAgIG1vZGlmaWVyIG9ubHl3aXphcmQgeyBpZiAobXNnLnNlbmRlciA9PSB3aXphcmRBZGRyZXNzKSBfOyB9ICAgIAogICAgCiAgICBmdW5jdGlvbiBFdGhlcml6YXRpb25VdGlscygpIHsKICAgICAgICB3aXphcmRBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gc2V0ZShhZGRyZXNzIGEpIG9ubHl3aXphcmQgewogICAgICAgIGUgPSBFdGhlcml6YXRpb24oYSk7CiAgICB9CiAgICAKICAgIAogICAgZnVuY3Rpb24gYnV5QnVpbGRpbmcodWludCBjaXR5SUQsIHVpbnQgYnVpbGRpbmdUeXBlKSB7CiAgICAgICAgdWludCBwbGF5ZXJJRCA9IGUuZ2V0UGxheWVySUQobXNnLnNlbmRlcik7CiAgICAgICAgCiAgICAgICAgaWYoZS50aW1lUGFzc2VkKHBsYXllcklEKSA8IGUuV0FJVF9USU1FKCkpIHsKICAgICAgICAgICAgZS5zZXRNc2cobXNnLnNlbmRlciwgMik7CiAgICAgICAgICAgIHJldHVybjsgICAgICAgIAogICAgICAgIH0KICAgICAgICAKICAgICAgICB1aW50IG93bmVyOwogICAgICAgIChvd25lciwpID0gZS5jaXRpZXMoY2l0eUlEKTsKICAgICAgICBpZihwbGF5ZXJJRCAhPSBvd25lciB8fCBjaXR5SUQgPiBlLm51bUNpdGllcygpLTEpIHsKICAgICAgICAgICAgZS5zZXRNc2cobXNnLnNlbmRlciwgMyk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYoYnVpbGRpbmdUeXBlPDAgfHwgYnVpbGRpbmdUeXBlPjQpIHsKICAgICAgICAgICAgZS5zZXRNc2cobXNnLnNlbmRlciwgNCk7CiAgICAgICAgICAgIHJldHVybjsgICAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgYm9vbFs1XSBtZW1vcnkgYnVpbGRpbmdzOwogICAgICAgIHVpbnRbMl0gbWVtb3J5IHJvd2NvbDsKICAgICAgICAoLCxidWlsZGluZ3MsLHJvd2NvbCwsKSA9IGUuZ2V0Q2l0eShjaXR5SUQpOwogICAgICAgIGlmKGJ1aWxkaW5nc1tidWlsZGluZ1R5cGVdKSB7CiAgICAgICAgICAgIGUuc2V0TXNnKG1zZy5zZW5kZXIsIDUpOwogICAgICAgICAgICByZXR1cm47IAogICAgICAgIH0KICAgICAgICB1aW50IHRyZWFzdXJ5OwogICAgICAgICgsLHRyZWFzdXJ5LCwsLCkgPSBlLnBsYXllcnMob3duZXIpOwogICAgICAgIGlmKHRyZWFzdXJ5IDwgZS5CVUlMRElOR19QUklDRSgpKSB7CiAgICAgICAgICAgIGUuc2V0TXNnKG1zZy5zZW5kZXIsIDYpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBlLnNldFRyZWFzdXJ5KHBsYXllcklELCB0cmVhc3VyeS1lLkJVSUxESU5HX1BSSUNFKCkpOwogICAgICAgIAogICAgICAgIC8vIGRpc3RyaWJ1dGUgYnVpbGQgZnVuZHMgdG8gcHJvZHVjdGlvbiB0eXBlIGJ1aWxkaW5nIG93bmVycwogICAgICAgIHVpbnQgcHJvZHVjdGlvbkN1dDsKICAgICAgICB1aW50IGk7CiAgICAgICAgcHJvZHVjdGlvbkN1dCA9IGUuQlVJTERJTkdfUFJJQ0UoKSAvIGUuZ2V0UXJMZW5ndGgoKTsKICAgICAgICBmb3IoaT0wOyBpIDwgZS5nZXRRckxlbmd0aCgpOyBpKyspIHsKICAgICAgICAgICAob3duZXIsKSA9IGUuY2l0aWVzKGUucXVhcnJ5Q2l0aWVzKGkpKTsKICAgICAgICAgICAoLCx0cmVhc3VyeSwsLCwpID0gZS5wbGF5ZXJzKG93bmVyKTsKICAgICAgICAgICBlLnNldFRyZWFzdXJ5KG93bmVyLCB0cmVhc3VyeStwcm9kdWN0aW9uQ3V0KTsKICAgICAgICB9CgogICAgICAgIGUuc2V0QnVpbGRpbmcoY2l0eUlELCBidWlsZGluZ1R5cGUpOwogICAgICAgIAogICAgICAgIGUuc2V0TXNnKG1zZy5zZW5kZXIsIDcgKyByb3djb2xbMF0qMTAwICsgcm93Y29sWzFdKjEwMDAwKTsKICAgICAgICBlLnNldExhc3RUaW1lc3RhbXAocGxheWVySUQsIG5vdyk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGJ1eVVuaXQodWludCBjaXR5SUQsIHVpbnQgdW5pdFR5cGUpIHsKICAgICAgICB1aW50IHBsYXllcklEID0gZS5nZXRQbGF5ZXJJRChtc2cuc2VuZGVyKTsKICAgICAgICAKICAgICAgICBpZihlLnRpbWVQYXNzZWQocGxheWVySUQpIDwgZS5XQUlUX1RJTUUoKSkgewogICAgICAgICAgICBlLnNldE1zZyhtc2cuc2VuZGVyLCAyKTsKICAgICAgICAgICAgcmV0dXJuOyAgICAgICAgCiAgICAgICAgfQogICAgICAgIAogICAgICAgIHVpbnQgb3duZXI7CiAgICAgICAgKG93bmVyLCkgPSBlLmNpdGllcyhjaXR5SUQpOwogICAgICAgIGlmKHBsYXllcklEICE9IG93bmVyIHx8IGNpdHlJRCA+IGUubnVtQ2l0aWVzKCktMSkgewogICAgICAgICAgICBlLnNldE1zZyhtc2cuc2VuZGVyLCA4KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZih1bml0VHlwZTwxIHx8IHVuaXRUeXBlPjMpIHsKICAgICAgICAgICAgZS5zZXRNc2cobXNnLnNlbmRlciwgOSk7CiAgICAgICAgICAgIHJldHVybjsgICAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgdWludCBudW1Vbml0czsKICAgICAgICB1aW50IHRyZWFzdXJ5OwogICAgICAgICgsLHRyZWFzdXJ5LCwsbnVtVW5pdHMsKSA9IGUucGxheWVycyhvd25lcik7CiAgICAgICAgdWludCBtYWludCA9IG51bVVuaXRzKmUuTUFJTlRfUFJJQ0UoKTsKICAgICAgICBpZih0cmVhc3VyeSA8IGUuVU5JVF9QUklDRSgpICsgbWFpbnQpIHsKICAgICAgICAgICAgZS5zZXRNc2cobXNnLnNlbmRlciwgMTApOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmKHVuaXRUeXBlPT0xJiZlLmdldFd3TGVuZ3RoKCk9PTAgfHwgdW5pdFR5cGU9PTImJmUuZ2V0TXdMZW5ndGgoKT09MCB8fCB1bml0VHlwZT09MyYmZS5nZXRTdExlbmd0aCgpPT0wKSB7CiAgICAgICAgICAgIGUuc2V0TXNnKG1zZy5zZW5kZXIsIDExKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICAvLyB0cnkgdG8gYWRkIHRoZSB1bml0IGF0IHRoZSBsYXN0IGVtcHR5IGdhcnJpc29uIHNwb3QKICAgICAgICB1aW50WzEwXSBtZW1vcnkgdW5pdHM7CiAgICAgICAgdWludFsyXSBtZW1vcnkgcm93Y29sOwogICAgICAgICgsLCx1bml0cyxyb3djb2wsLCkgPSBlLmdldENpdHkoY2l0eUlEKTsKICAgICAgICBmb3IodWludCBpPTA7IGkgPCB1bml0cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZih1bml0c1tpXSA8IDEpIHsKICAgICAgICAgICAgICAgZS5zZXRVbml0KGNpdHlJRCwgaSwgdW5pdFR5cGUpOwogICAgICAgICAgICAgICBlLnNldE51bVVuaXRzKHBsYXllcklELCBudW1Vbml0cysxKTsKICAgICAgICAgICAgICAgZS5zZXRUcmVhc3VyeShwbGF5ZXJJRCwgdHJlYXN1cnktZS5VTklUX1BSSUNFKCktbWFpbnQpOwogICAgICAgICAgICAgICAvLyBkaXN0cmlidXRlIGJ1aWxkIGZ1bmRzIHRvIHByb2R1Y3Rpb24gdHlwZSBidWlsZGluZyBvd25lcnMKICAgICAgICAgICAgICAgdWludCBwcm9kdWN0aW9uQ3V0OwogICAgICAgICAgICAgICB1aW50IGo7CiAgICAgICAgICAgICAgIC8vIHBpa2VtZW4KICAgICAgICAgICAgICAgaWYodW5pdFR5cGUgPT0gMSkgewogICAgICAgICAgICAgICAgICAgcHJvZHVjdGlvbkN1dCA9IGUuVU5JVF9QUklDRSgpIC8gZS5nZXRXd0xlbmd0aCgpOwogICAgICAgICAgICAgICAgICAgZm9yKGo9MDsgaiA8IGUuZ2V0V3dMZW5ndGgoKTsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgKG93bmVyLCkgPSBlLmNpdGllcyhlLndvb2R3b3Jrc0NpdGllcyhqKSk7CiAgICAgICAgICAgICAgICAgICAgICAgKCwsdHJlYXN1cnksLCwsKSA9IGUucGxheWVycyhvd25lcik7CiAgICAgICAgICAgICAgICAgICAgICAgZS5zZXRUcmVhc3VyeShvd25lciwgdHJlYXN1cnkrcHJvZHVjdGlvbkN1dCk7CiAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgZWxzZSBpZih1bml0VHlwZSA9PSAyKSB7CiAgICAgICAgICAgICAgICAgICBwcm9kdWN0aW9uQ3V0ID0gZS5VTklUX1BSSUNFKCkgLyBlLmdldE13TGVuZ3RoKCk7CiAgICAgICAgICAgICAgICAgICBmb3Ioaj0wOyBqIDwgZS5nZXRNd0xlbmd0aCgpOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAob3duZXIsKSA9IGUuY2l0aWVzKGUubWV0YWx3b3Jrc0NpdGllcyhqKSk7CiAgICAgICAgICAgICAgICAgICAgICAgKCwsdHJlYXN1cnksLCwsKSA9IGUucGxheWVycyhvd25lcik7CiAgICAgICAgICAgICAgICAgICAgICAgZS5zZXRUcmVhc3VyeShvd25lciwgdHJlYXN1cnkrcHJvZHVjdGlvbkN1dCk7CiAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgZWxzZSBpZih1bml0VHlwZSA9PSAzKSB7CiAgICAgICAgICAgICAgICAgICBwcm9kdWN0aW9uQ3V0ID0gZS5VTklUX1BSSUNFKCkgLyBlLmdldFN0TGVuZ3RoKCk7CiAgICAgICAgICAgICAgICAgICBmb3Ioaj0wOyBqIDwgZS5nZXRTdExlbmd0aCgpOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAob3duZXIsKSA9IGUuY2l0aWVzKGUuc3RhYmxlc0NpdGllcyhqKSk7CiAgICAgICAgICAgICAgICAgICAgICAgKCwsdHJlYXN1cnksLCwsKSA9IGUucGxheWVycyhvd25lcik7CiAgICAgICAgICAgICAgICAgICAgICAgZS5zZXRUcmVhc3VyeShvd25lciwgdHJlYXN1cnkrcHJvZHVjdGlvbkN1dCk7CiAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgLy8gcGF5IG1haW50ZW5hbmNlIGZvciBhbGwgb3RoZXIgdW5pdHMgdG8gZmFybSBvd25lcnMKICAgICAgICAgICAgICAgdWludCBtYWludEN1dCA9IG1haW50IC8gZS5nZXRGbUxlbmd0aCgpOwogICAgICAgICAgICAgICBmb3Ioaj0wOyBqIDwgZS5nZXRGbUxlbmd0aCgpOyBqKyspIHsKICAgICAgICAgICAgICAgICAgIChvd25lciwpID0gZS5jaXRpZXMoZS5mYXJtQ2l0aWVzKGopKTsKICAgICAgICAgICAgICAgICAgICgsLHRyZWFzdXJ5LCwsLCkgPSBlLnBsYXllcnMob3duZXIpOwogICAgICAgICAgICAgICAgICAgZS5zZXRUcmVhc3VyeShvd25lciwgdHJlYXN1cnkrbWFpbnRDdXQpOwogICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgIGUuc2V0TXNnKG1zZy5zZW5kZXIsIDEyICsgcm93Y29sWzBdKjEwMCArIHJvd2NvbFsxXSoxMDAwMCk7CiAgICAgICAgICAgICAgIGUuc2V0TGFzdFRpbWVzdGFtcChwbGF5ZXJJRCwgbm93KTsKICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGUuc2V0TXNnKG1zZy5zZW5kZXIsIDEzKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gbW92ZVVuaXRzKHVpbnQgc291cmNlLCB1aW50IHRhcmdldCwgdWludFtdIHVuaXRJbmR4cykgewogICAgICAgIHVpbnRbMl0gbWVtb3J5IHNSb3djb2w7CiAgICAgICAgdWludFsyXSBtZW1vcnkgdFJvd2NvbDsKICAgICAgICB1aW50WzEwXSBtZW1vcnkgdW5pdHNTOwogICAgICAgIHVpbnRbMTBdIG1lbW9yeSB1bml0c1Q7CiAgICAgICAgCiAgICAgICAgdWludCBwbGF5ZXJJRCA9IGUuZ2V0UGxheWVySUQobXNnLnNlbmRlcik7CiAgICAgICAgCiAgICAgICAgaWYoZS50aW1lUGFzc2VkKHBsYXllcklEKSA8IGUuV0FJVF9USU1FKCkpIHsKICAgICAgICAgICAgZS5zZXRNc2cobXNnLnNlbmRlciwgMik7CiAgICAgICAgICAgIHJldHVybjsgICAgICAgIAogICAgICAgIH0KCiAgICAgICAgdWludCBvd25lclM7CiAgICAgICAgdWludCBvd25lclQ7CiAgICAgICAgKG93bmVyUywsLHVuaXRzUyxzUm93Y29sLCwpID0gZS5nZXRDaXR5KHNvdXJjZSk7CiAgICAgICAgKG93bmVyVCwsLHVuaXRzVCx0Um93Y29sLCwpID0gZS5nZXRDaXR5KHRhcmdldCk7CiAgICAgICAgaWYocGxheWVySUQgIT0gb3duZXJTIHx8IHBsYXllcklEICE9IG93bmVyVCB8fCBpbnQoc1Jvd2NvbFswXSktaW50KHRSb3djb2xbMF0pID4gaW50KDEpIHx8IGludChzUm93Y29sWzBdKS1pbnQodFJvd2NvbFswXSkgPCBpbnQoLTEpIHx8IGludChzUm93Y29sWzFdKS1pbnQodFJvd2NvbFsxXSkgPiBpbnQoMSkgfHwgaW50KHNSb3djb2xbMV0pLWludCh0Um93Y29sWzFdKSA8IGludCgtMSkpIHsKICAgICAgICAvL2lmKHBsYXllcklEICE9IG93bmVyUyB8fCBwbGF5ZXJJRCAhPSBvd25lclQgfHwgc291cmNlID4gZS5udW1DaXRpZXMoKS0xIHx8IHRhcmdldCA+IGUubnVtQ2l0aWVzKCktMSkgewogICAgICAgIC8vaWYocGxheWVySUQgIT0gb3duZXJTIHx8IHBsYXllcklEICE9IG93bmVyVCkgeyAgICAKICAgICAgICAgICAgZS5zZXRNc2cobXNnLnNlbmRlciwgMTQpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHVpbnQgaiA9IDA7CiAgICAgICAgZm9yKHVpbnQgaT0wOyBpPHVuaXRJbmR4cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZih1bml0c1NbdW5pdEluZHhzW2ldXSA8IDEpIHsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOyAgIC8vc2tpcCBmb3Igbm9uLXVuaXQKICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IoOyBqPHVuaXRzVC5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgaWYodW5pdHNUW2pdID09IDApIHsKICAgICAgICAgICAgICAgICAgICBlLnNldFVuaXQodGFyZ2V0LCBqLCB1bml0c1NbdW5pdEluZHhzW2ldXSk7CiAgICAgICAgICAgICAgICAgICAgdW5pdHNTW3VuaXRJbmR4c1tpXV0gPSAwOwogICAgICAgICAgICAgICAgICAgIGUuc2V0VW5pdChzb3VyY2UsIHVuaXRJbmR4c1tpXSwgMCk7CiAgICAgICAgICAgICAgICAgICAgaisrOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKGogPT0gdW5pdHNULmxlbmd0aCkgewogICAgICAgICAgICAgICAgZS5zZXRNc2cobXNnLnNlbmRlciwgMTUpOwogICAgICAgICAgICAgICAgZS5zZXRMYXN0VGltZXN0YW1wKHBsYXllcklELCBub3cpOwogICAgICAgICAgICAgICAgcmV0dXJuOyAvL3RhcmdldCBjaXR5IGdhcnJpc29uIGZpbGxlZAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGUuc2V0TXNnKG1zZy5zZW5kZXIsIDE2KTsKICAgICAgICBlLnNldExhc3RUaW1lc3RhbXAocGxheWVySUQsIG5vdyk7CiAgICB9CiAgICAKfQ=='.
	

]
