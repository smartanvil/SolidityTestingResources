Class {
	#name : #SRTc5936b4e458c60f887a4f17d05d2f8162976e012,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTc5936b4e458c60f887a4f17d05d2f8162976e012 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTc7CgovKioKICogViAxLjAuIAogKiAoQykgcHJvZml0LWNoYWluLm5ldCBMaWNlbnNlZCB1bmRlciBNSVQgdGVybXMKICoKICogUHJvZml0Q2hhaW4gaXMgYSBnYW1lIGFsbG93aW5nIHBhcnRpY2lwYW50cyB0byB3aW4gc29tZSBFdGhlci4gQmFzZWQgb24gRXRoZXJldW0gaW50cmluc2ljIHJhbmRvbW5lc3MgYW5kIGRpZmZpY3VsdHksIHlvdSBtdXN0IGJlIGVpdGhlciBsdWNreSBvciBvbmUKICogaGVsbCBvZiBhIGhhY2tlciB0byB3aW4uLi4gUmVhZCB0aGUgY29kZSwgYW5kIGlmIHlvdSBmaW5kIGEgcHJvYmxlbSwgd3JpdGUgb3duZXIgQVQgcHJvZml0LWNoYWluLm5ldCAhCiAqCiAqIEludmVzdG9ycyBwYXJ0aWNpcGF0ZSBpbiByb3VuZHMgb2YgZml4ZWQgc2l6ZSBhbmQgaW52ZXN0bWVudC4gT25jZSBhIHJvdW5kIGlzIGZ1bGwsIGEgbmV3IG9uZSBvcGVucyBhdXRvbWF0aWNhbGx5LgogKiBBIHNpbmdsZSB3aW5uZXIgaXMgcGlja2VkIHBlciByb3VuZCwgcmFraW5nIGFsbCB0aGUgcm91bmQncyBpbnZlc3RtZW50cyAobWludXMgaW52aXRvciBmZWVzKS4KICoKICogRWFjaCBpbnZlc3RvciBtdXN0IHByb3ZpZGUgYW4gaW52aXRvciBhZGRyZXNzIHdoZW4gbWFraW5nIHRoZSBmaXJzdCBpbnZlc3RtZW50IGluIHRoZSBncm91cC4KICogVGhlIGdhbWUgaW5jbHVkZXMgYSB0aW1lIGFuZCBkZXB0aCBsaW1pdGVkIGludml0YXRpb24gcHlyYW1pZCAtIHlvdSBtdXN0IGludmVzdCBmaXJzdCwgdGhlbiB5b3UgY2FuIGludml0ZSBvdGhlcnMuIEFzIGludml0b3IgeW91J2xsIGVuam95IGEgcGFydCBvZiBpbnZpdGVlcyBpbnZlc3RtZW50CiAqIGFuZCB3aW5zLCBhcyB3ZWxsIGFzIHRoZWlyIHN1Yi1pbnZpdGVlcywgZm9yIGEgbGltaXRlZCB0aW1lLCBhbmQgdXAgdG8gY2VydGFpbiBudW1iZXIgb2YgZ2VuZXJhdGlvbnMuCiAqCiAqIFRoZXJlIGFyZSBtdWx0aXBsZSBncm91cHMsIGVhY2ggd2l0aCBpdHMgc3BlY2lmaWMgY2hhcmFjdGVyaXN0aWNzLSB0byBjYXRlciB0byBhbGwgcGxheWVycy4KICogCiAqIFdlIGRldGVyIGhhY2tpbmcgb2YgdGhlIHdpbm5lciBieSBtYWtpbmcgaXQgbm9uLWVjb25vbWljYWw6CiAqIFRoZXJlIGlzIGEgInNlY3VyaXR5IGZhY3RvciIgSywgd2hpY2ggaXMgbGFyZ2VyIHRoYW4gdGhlIGdyb3VwIHJvdW5kIHNpemUgTi4KICogRm9yIGV4YW1wbGUsIGZvciBOPTEwIHdlIG1heSBjaG9vc2UgSz01MC4KICogQSBmZXcgYmxvY2tzIGZvbGxvd2luZyB0aGUgcm91bmQncyBsYXN0IGludmVzdG1lbnQsIHRoZSB3aW5uZXIgaXMgcGlja2VkIGlmIHRoZSBibG9jaydzIGhhc2ggbW9kIEsgaXMgYSBudW1iZXIgb2YgMS4uLk4uCiAqIElmIGEgaGFja2VyIG1pbmVyIG1hZGUgYSBzaW5nbGUgaW52ZXRtZW50IGluIHRoZSByb3VuZCwgdGhlIG1pbmVyIHdvdWxkIGhhdmUgdG8gbWF0Y2ggMSBvdXQgb2YgNTAgImd1ZXNzZXMiLCBpZS4gNTAgdGltZXMgZ3JlYXRlciBlZmZvcnQgdGhhbiB1c3VhbC4uLgogKiBJZiBhIGhhY2tlciBtaW5lciBtYWRlIGFsbCBpbnZldG1lbnRzIGJ1dCBvbmUgaW4gdGhlIHJvdW5kLCB0aGUgbWluZXIgd291bGQgaGF2ZSB0byBtYXRjaCA5IG9mIG9mIDUwICJndWVzc2VzIiwgb3IgYWJvdXQgNSB0aW1lcyBncmVhdGVyIHRoYW4gdXN1YWwuLi4KICogQW5kIHRoZW4gdGhlcmUncyB0aGUgcGFydGljaXBhdGlvbiBmZWVzLCB0aGF0IHJlbmRlciBldmVuIHRoYXQgbGFzdCBzY2VuYXJpbyBub24tZWNvbm9taWNhbC4KICoKICogSXQgd291bGQgdGFrZSBhIGxpdHRsZSBvdmVyIEsgYmxvY2tzIG9uIGF2ZXJhZ2UgdG8gZGVjbGFyZSB0aGUgd2lubmVyLgogKiBBdCAxNSBzZWNvbmRzIHBlciBibG9jaywgaWYgSz01MCwgaXQgd291bGQgdGFrZSBvbiBhdmVyYWdlIDEzIG1pbnV0ZXMgYWZ0ZXIgdGhlIGxhc3QgaW52ZXN0bWVudCwgYmVmb3JlIGEgd2lubmVyIGlzIGZvdW5kLgogKiBCVVQhIAogKiBXaW5uZXIgZGVjbGFyYXRpb24gaXMgdGVtcG9yYXJ5IC0gY2hlY2tpbmcgaXMgZG9uZSBvbiBsYXN0IDI1NSBibG9ja3MuIFNvIGV2ZW4gaWYgYSB3aW5uZXIgZXhpc3RzIG5vdywgdGhlIHdpbm5lciBtdXN0IGJlIGFjdGl2ZWx5IG5hbWVkIHVzaW5nIGEgdHJhbnNhY3Rpb24gd2hpbGUgcmVsZXZhbnQuCiAqIEEgImNoZWNrQW5kRGVjbGFyZVdpbm5lciIgdHJhbnNhY3Rpb24gaXMgcmVxdWlyZWQgdG8gd3JpdGUgdGhlIHdpbm5lciAoYXQgdGhlIHRpbWUgb2YgdGhlIHRyYW5zYWN0aW9uISkgaW50byB0aGUgYmxvY2tjaGFpbi4KICogCiAqIEFsbCBFdGhlciB3aXRoZHJhd2FscywgYWZ0ZXIgd2lucyBvciBpbnZpdG9yIGZlZXMgcGF5b3V0cywgcmVxdWlyZSBleGVjdXRpb24gb2YgYSAid2l0aGRyYXciIHRyYW5zYWN0aW9uLCBmb3Igc2FmZXR5LiAKICovCgoKY29udHJhY3QgUHJvZml0Q2hhaW4gewoKICAgIHVzaW5nIFNhZmVNYXRoMjU2IGZvciB1aW50MjU2OwogICAgdXNpbmcgU2FmZU1hdGgzMiBmb3IgdWludDMyOwogICAgCiAgICAvLyB0eXBlcwogICAgCiAgICBzdHJ1Y3QgSW52ZXN0bWVudCB7CiAgICAgICAgYWRkcmVzcyBpbnZlc3RvcjsgICAgICAgICAgICAgICAvLyB3aG8gbWFkZSB0aGUgaW52ZXN0bWVudAogICAgICAgIHVpbnQyNTYgc3VtOyAgICAgICAgICAgICAgICAgICAgLy8gYWN0dWFsIGludmVzdG1lbnQsIGFmdGVyIGZlZXMgZGVkdWN0aW9uCiAgICAgICAgdWludDI1NiB0aW1lOyAgICAgICAgICAgICAgICAgICAvLyBpbnZlc3RtZW50IHRpbWUKICAgIH0KICAgIAogICAgc3RydWN0IFJvdW5kIHsKICAgICAgICBtYXBwaW5nKHVpbnQzMiA9PiBJbnZlc3RtZW50KSBpbnZlc3RtZW50czsgICAgICAvLyBhbGwgaW52ZXN0bWVudHMgbWFkZSBpbiByb3VuZAogICAgICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDMyKSBpbnZlc3Rvck1hcHBpbmc7ICAgIC8vIHF1aWNrbHkgZmluZCBhbiBpbnZlc3RvciBieSBhZGRyZXNzCiAgICAgICAgdWludDMyIHRvdGFsSW52ZXN0b3JzOyAgICAgICAgICAvLyB0aGUgbnVtYmVyIG9mIGludmVzdG9ycyBpbiByb3VuZCBzbyBmYXIKICAgICAgICB1aW50MjU2IHRvdGFsSW52ZXN0bWVudDsgICAgICAgIC8vIHRoZSBzdW0gb2YgYWxsIGludmVzdG1lbnRzIGluIHJvdW5kLCBzbyBmYXIKICAgICAgICBhZGRyZXNzIHdpbm5lcjsgICAgICAgICAgICAgICAgIC8vIHdpbm5lciBvZiB0aGUgcm91bmQgKDAgaWYgbm90IHlldCBrbm93bikKICAgICAgICB1aW50MjU2IGxhc3RCbG9jazsgICAgICAgICAgICAgIC8vIGJsb2NrIG51bWJlciBvZiBsYXRlc3QgaW52ZXN0bWVudAogICAgfQogICAgCiAgICBzdHJ1Y3QgR3JvdXBNZW1iZXIgewogICAgICAgIHVpbnQyNTYgam9pblRpbWU7ICAgICAgICAgICAgICAgLy8gd2hlbiB0aGUgcGFyaXRpY2lwYW50IGpvaW5lZCB0aGUgZ3JvdXAKICAgICAgICBhZGRyZXNzIGludml0b3I7ICAgICAgICAgICAgICAgIC8vIHdobyBpbnZpdGVkIHRoZSBwYXJ0aWNpcGFudAogICAgfQoKICAgIHN0cnVjdCBHcm91cCB7CiAgICAgICAgc3RyaW5nIG5hbWU7ICAgICAgICAgICAgICAgICAgICAvLyBncm91cCBuYW1lCiAgICAgICAgdWludDMyIHJvdW5kU2l6ZTsgICAgICAgICAgICAgICAvLyByb3VuZCBzaXplIChudW1iZXIgb2YgaW52ZXN0b3JzKQogICAgICAgIHVpbnQyNTYgaW52ZXN0bWVudDsgICAgICAgICAgICAgLy8gaW52ZXN0bWVudCBzaXplIGluIHdlaQogICAgICAgIHVpbnQzMiBibG9ja3NCZWZvcmVXaW5DaGVjazsgICAgLy8gaG93IG1hbnkgYmxvY2tzIHRvIHdhaXQgYWZ0ZXIgcm91bmQncyBmaW5hbCBpbnZlc3RtZW50LCBwcmlvciB0byBkZXRlcm1pbmluZyB0aGUgd2lubmVyCiAgICAgICAgdWludDMyIHNlY3VyaXR5RmFjdG9yOyAgICAgICAgICAvLyBzZWN1cml0eSBmYWN0b3IsIGxhcmdlciB0aGFuIHRoZSBncm91cCBzaXplLCB0byBtYWtlIGhhY2tpbmcgZGlmZmljdWx0CiAgICAgICAgdWludDMyIGludml0YXRpb25GZWU7ICAgICAgICAgICAvLyBwcm9taWxlcyBvZiBpbnZpdGF0aW9uIGZlZSBvdXQgb2YgaW52ZXN0bWVudCBhbmQgd2lubmluZwogICAgICAgIHVpbnQzMiBvd25lckZlZTsgICAgICAgICAgICAgICAgLy8gcHJvbWlsZXMgb2Ygb3duZXIgZmVlIG91dCBvZiBpbnZlc3RtZW50CiAgICAgICAgdWludDMyIGludml0YXRpb25GZWVQZXJpb2Q7ICAgICAvLyBudW1iZXIgb2YgZGF5cyBhbiBpbnZpdGF0aW9uIGluY3VycyBmZWVzCiAgICAgICAgdWludDggaW52aXRhdGlvbkZlZURlcHRoOyAgICAgICAvLyBob3cgbWFueSBpbnZpdG9ycyBjYW4gYmUgcGFpZCB1cCB0aGUgaW52aXRhdGlvbiBjaGFpbgogICAgICAgIGJvb2wgYWN0aXZlOyAgICAgICAgICAgICAgICAgICAgLy8gaXMgdGhlIGdyb3VwIG9wZW4gZm9yIG5ldyByb3VuZHM/CiAgICAgICAgbWFwcGluZyAoYWRkcmVzcyA9PiBHcm91cE1lbWJlcikgbWVtYmVyczsgICAvLyBhbGwgdGhlIGdyb3VwIG1lbWJlcnMKICAgICAgICBtYXBwaW5nKHVpbnQzMiA9PiBSb3VuZCkgcm91bmRzOyAgICAgICAgICAgIC8vIHJvdW5kcyBvZiB0aGlzIGdyb3VwCiAgICAgICAgdWludDMyIGN1cnJlbnRSb3VuZDsgICAgICAgICAgICAvLyB0aGUgY3VycmVudCByb3VuZAogICAgICAgIHVpbnQzMiBmaXJzdFVud29uUm91bmQ7ICAgICAgICAgLy8gdGhlIG9sZGVzdCByb3VuZCB3ZSBuZWVkIHRvIGNoZWNrIGZvciB3aW4KICAgIH0KICAgIAogICAgCiAgICAvLyB2YXJpYWJsZXMKICAgIHN0cmluZyBwdWJsaWMgY29udHJhY3ROYW1lID0gIlByb2ZpdENoYWluIDEuMCI7CiAgICB1aW50MjU2IHB1YmxpYyBjb250cmFjdEJsb2NrOyAgICAgICAgICAgICAgIC8vIGJsb2NrIG9mIGNvbnRyYWN0CiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsgICAgICAgICAgICAgICAgICAgICAgIC8vIG93bmVyIG9mIHRoZSBjb250cmFjdAogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsgICAgICAvLyBiYWxhbmNlIG9mIGVhY2ggaW52ZXN0b3IKICAgIEdyb3VwW10gZ3JvdXBzOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWxsIGdyb3VwcwogICAgbWFwcGluZyAoc3RyaW5nID0+IGJvb2wpIGdyb3VwTmFtZXM7ICAgICAgICAvLyBmb3IgZXhjbHVzaXZpdHkgb2YgZ3JvdXAgbmFtZXMKCiAgICAvLyBtb2RpZmllcnMKICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHtyZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOyBfO30KICAgIAogICAgLy8gZXZlbnRzCiAgICBldmVudCBHcm91cENyZWF0ZWQodWludDMyIGluZGV4ZWQgZ3JvdXAsIHVpbnQyNTYgdGltZXN0YW1wKTsKICAgIGV2ZW50IEdyb3VwQ2xvc2VkKHVpbnQzMiBpbmRleGVkIGdyb3VwLCB1aW50MjU2IHRpbWVzdGFtcCk7CiAgICBldmVudCBOZXdJbnZlc3RvcihhZGRyZXNzIGluZGV4ZWQgaW52ZXN0b3IsIHVpbnQzMiBpbmRleGVkIGdyb3VwLCB1aW50MjU2IHRpbWVzdGFtcCk7CiAgICBldmVudCBJbnZlc3QoYWRkcmVzcyBpbmRleGVkIGludmVzdG9yLCB1aW50MzIgaW5kZXhlZCBncm91cCwgdWludDMyIGluZGV4ZWQgcm91bmQsIHVpbnQyNTYgdGltZXN0YW1wKTsKICAgIGV2ZW50IFdpbm5lcihhZGRyZXNzIGluZGV4ZWQgcGF5ZWUsIHVpbnQzMiBpbmRleGVkIGdyb3VwLCB1aW50MzIgaW5kZXhlZCByb3VuZCwgdWludDI1NiB0aW1lc3RhbXApOwogICAgZXZlbnQgRGVwb3NpdChhZGRyZXNzIGluZGV4ZWQgcGF5ZWUsIHVpbnQyNTYgc3VtLCB1aW50MjU2IHRpbWVzdGFtcCk7CiAgICBldmVudCBXaXRoZHJhdyhhZGRyZXNzIGluZGV4ZWQgcGF5ZWUsIHVpbnQyNTYgc3VtLCB1aW50MjU2IHRpbWVzdGFtcCk7CgogICAgLy8gZnVuY3Rpb25zCiAgICAKICAgIC8qKgogICAgICogQ29uc3RydWN0b3I6CiAgICAgKiAtIG93bmVyIGFjY291bnQKICAgICAqLwogICAgZnVuY3Rpb24gUHJvZml0Q2hhaW4gKCkgcHVibGljIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgY29udHJhY3RCbG9jayA9IGJsb2NrLm51bWJlcjsKICAgIH0KCiAgICAvKioKICAgICAqIGlmIHNvbWVvbmVzIHNlbmRzIEV0aGVyIGRpcmVjdGx5IHRvIHRoZSBjb250cmFjdCAtIGZhaWwgaXQhCiAgICAgKi8KICAgIGZ1bmN0aW9uIC8qIGZhbGxiYWNrICovICgpIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICByZXZlcnQoKTsKICAgIH0gCgogICAgLyoqCiAgICAgKiBDcmVhdGUgbmV3IGdyb3VwIChvbmx5IG93bmVyKQogICAgICovCiAgICBmdW5jdGlvbiBuZXdHcm91cCAoCiAgICAgICAgc3RyaW5nIF9ncm91cE5hbWUsIAogICAgICAgIHVpbnQzMiBfcm91bmRTaXplLAogICAgICAgIHVpbnQyNTYgX2ludmVzdG1lbnQsCiAgICAgICAgdWludDMyIF9ibG9ja3NCZWZvcmVXaW5DaGVjaywKICAgICAgICB1aW50MzIgX3NlY3VyaXR5RmFjdG9yLAogICAgICAgIHVpbnQzMiBfaW52aXRhdGlvbkZlZSwKICAgICAgICB1aW50MzIgX293bmVyRmVlLAogICAgICAgIHVpbnQzMiBfaW52aXRhdGlvbkZlZVBlcmlvZCwKICAgICAgICB1aW50OCBfaW52aXRhdGlvbkZlZURlcHRoCiAgICApIHB1YmxpYyBvbmx5T3duZXIgCiAgICB7CiAgICAgICAgLy8gc29tZSBiYXNpYyB0ZXN0cwogICAgICAgIHJlcXVpcmUoX3JvdW5kU2l6ZSA+IDApOwogICAgICAgIHJlcXVpcmUoX2ludmVzdG1lbnQgPiAwKTsKICAgICAgICByZXF1aXJlKF9pbnZpdGF0aW9uRmVlLmFkZChfb3duZXJGZWUpIDwgMTAwMCk7CiAgICAgICAgcmVxdWlyZShfc2VjdXJpdHlGYWN0b3IgPiBfcm91bmRTaXplKTsKICAgICAgICAvLyBjaGVjayBpZiBncm91cCBuYW1lIGV4aXN0cwogICAgICAgIHJlcXVpcmUoIWdyb3VwTmFtZUV4aXN0cyhfZ3JvdXBOYW1lKSk7CiAgICAgICAgCiAgICAgICAgLy8gY3JlYXRlIHRoZSBncm91cAogICAgICAgIEdyb3VwIG1lbW9yeSBncm91cDsKICAgICAgICBncm91cC5uYW1lID0gX2dyb3VwTmFtZTsKICAgICAgICBncm91cC5yb3VuZFNpemUgPSBfcm91bmRTaXplOwogICAgICAgIGdyb3VwLmludmVzdG1lbnQgPSBfaW52ZXN0bWVudDsKICAgICAgICBncm91cC5ibG9ja3NCZWZvcmVXaW5DaGVjayA9IF9ibG9ja3NCZWZvcmVXaW5DaGVjazsKICAgICAgICBncm91cC5zZWN1cml0eUZhY3RvciA9IF9zZWN1cml0eUZhY3RvcjsKICAgICAgICBncm91cC5pbnZpdGF0aW9uRmVlID0gX2ludml0YXRpb25GZWU7CiAgICAgICAgZ3JvdXAub3duZXJGZWUgPSBfb3duZXJGZWU7CiAgICAgICAgZ3JvdXAuaW52aXRhdGlvbkZlZVBlcmlvZCA9IF9pbnZpdGF0aW9uRmVlUGVyaW9kOwogICAgICAgIGdyb3VwLmludml0YXRpb25GZWVEZXB0aCA9IF9pbnZpdGF0aW9uRmVlRGVwdGg7CiAgICAgICAgZ3JvdXAuYWN0aXZlID0gdHJ1ZTsKICAgICAgICAvLyBncm91cC5jdXJyZW50Um91bmQgPSAwOyAvLyBpbml0aWFsaXplZCB3aXRoIDAgYW55d2F5CiAgICAgICAgLy8gZ3JvdXAuZmlyc3RVbndvblJvdW5kID0gMDsgLy8gaW5pdGlhbGl6ZWQgd2l0aCAwIGFueXdheQogICAgICAgIAogICAgICAgIGdyb3Vwcy5wdXNoKGdyb3VwKTsKICAgICAgICBncm91cE5hbWVzW19ncm91cE5hbWVdID0gdHJ1ZTsKCiAgICAgICAgLy8gbm90aWZ5IHdvcmxkCiAgICAgICAgR3JvdXBDcmVhdGVkKHVpbnQzMihncm91cHMubGVuZ3RoKS5zdWIoMSksIGJsb2NrLnRpbWVzdGFtcCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDbG9zZSBncm91cCAob25seSBvd25lcikKICAgICAqIE9uY2UgY2xvc2VkLCBpdCB3aWxsIG5vdCBpbml0aWF0ZSBuZXcgcm91bmRzLgogICAgICovCiAgICBmdW5jdGlvbiBjbG9zZUdyb3VwKHVpbnQzMiBfZ3JvdXApIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIC8vIHZlcmlmeSBncm91cCBleGlzdHMgYW5kIG5vdCBjbG9zZWQKICAgICAgICByZXF1aXJlKGdyb3VwRXhpc3RzKF9ncm91cCkpOwogICAgICAgIHJlcXVpcmUoZ3JvdXBzW19ncm91cF0uYWN0aXZlKTsKICAgICAgICAKICAgICAgICBncm91cHNbX2dyb3VwXS5hY3RpdmUgPSBmYWxzZTsKCiAgICAgICAgLy8gbm90aWZ5IHRoZSB3b3JsZAogICAgICAgIEdyb3VwQ2xvc2VkKF9ncm91cCwgYmxvY2sudGltZXN0YW1wKTsKICAgIH0gCiAgICAKICAgIAogICAgLyoqCiAgICAgKiBKb2luIGdyb3VwIGFuZCBtYWtlIGZpcnN0IGludmVzdG1lbnQKICAgICAqIEludml0b3IgbXVzdCBhbHJlYWR5IGJlbG9uZyB0byBncm91cCAob3IgYmUgb3duZXIpLCBpbnZlc3RvciBtdXN0IG5vdC4KICAgICAqLwogICAgIAogICAgZnVuY3Rpb24gam9pbkdyb3VwQW5kSW52ZXN0KHVpbnQzMiBfZ3JvdXAsIGFkZHJlc3MgX2ludml0b3IpIHBheWFibGUgcHVibGljIHsKICAgICAgICBhZGRyZXNzIGludmVzdG9yID0gbXNnLnNlbmRlcjsKICAgICAgICAvLyBvd25lciBpcyBub3QgYWxsb3dlZCB0byBpbnZlc3QKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgIT0gb3duZXIpOwogICAgICAgIC8vIGNoZWNrIGdyb3VwIGV4aXN0cywgaW52ZXN0b3IgZG9lcyBub3QgeWV0IGJlbG9uZyB0byBncm91cCwgYW5kIGludml0b3IgZXhpc3RzIChvciBvd25lcikKICAgICAgICBHcm91cCBzdG9yYWdlIHRoaXNHcm91cCA9IGdyb3Vwc1tfZ3JvdXBdOwogICAgICAgIHJlcXVpcmUodGhpc0dyb3VwLnJvdW5kU2l6ZSA+IDApOwogICAgICAgIHJlcXVpcmUodGhpc0dyb3VwLm1lbWJlcnNbX2ludml0b3JdLmpvaW5UaW1lID4gMCB8fCBfaW52aXRvciA9PSBvd25lcik7CiAgICAgICAgcmVxdWlyZSh0aGlzR3JvdXAubWVtYmVyc1tpbnZlc3Rvcl0uam9pblRpbWUgPT0gMCk7CiAgICAgICAgLy8gY2hlY2sgcGF5bWVudCBpcyBhcyByZXF1aXJlZAogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID09IHRoaXNHcm91cC5pbnZlc3RtZW50KTsKICAgICAgICAKICAgICAgICAvLyBhZGQgaW52ZXN0b3IgdG8gZ3JvdXAKICAgICAgICB0aGlzR3JvdXAubWVtYmVyc1tpbnZlc3Rvcl0uam9pblRpbWUgPSBibG9jay50aW1lc3RhbXA7CiAgICAgICAgdGhpc0dyb3VwLm1lbWJlcnNbaW52ZXN0b3JdLmludml0b3IgPSBfaW52aXRvcjsKICAgICAgICAKICAgICAgICAvLyBub3RpZnkgdGhlIHdvcmxkCiAgICAgICAgTmV3SW52ZXN0b3IoaW52ZXN0b3IsIF9ncm91cCwgYmxvY2sudGltZXN0YW1wKTsKICAgICAgICAKICAgICAgICAvLyBtYWtlIHRoZSBmaXJzdCBpbnZlc3RtZW50CiAgICAgICAgaW52ZXN0KF9ncm91cCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbnZlc3QgaW4gYSBncm91cAogICAgICogQ2FuIGludmVzdCBvbmNlIHBlciByb3VuZC4KICAgICAqIE11c3QgYmUgYSBtZW1iZXIgb2YgdGhlIGdyb3VwLgogICAgICovCiAgICBmdW5jdGlvbiBpbnZlc3QodWludDMyIF9ncm91cCkgcGF5YWJsZSBwdWJsaWMgewogICAgICAgIGFkZHJlc3MgaW52ZXN0b3IgPSBtc2cuc2VuZGVyOwogICAgICAgIEdyb3VwIHN0b3JhZ2UgdGhpc0dyb3VwID0gZ3JvdXBzW19ncm91cF07CiAgICAgICAgdWludDMyIHJvdW5kID0gdGhpc0dyb3VwLmN1cnJlbnRSb3VuZDsKICAgICAgICBSb3VuZCBzdG9yYWdlIHRoaXNSb3VuZCA9IHRoaXNHcm91cC5yb3VuZHNbcm91bmRdOwogICAgICAgIAogICAgICAgIC8vIGNoZWNrIHRoZSBncm91cCBpcyBzdGlsbCBvcGVuIGZvciBidXNpbmVzcyAtIG9ubHkgaWYgd2UncmUgYWJvdXQgdG8gYmUgdGhlIGZpcnN0IGludmVzdG9ycwogICAgICAgIHJlcXVpcmUodGhpc0dyb3VwLmFjdGl2ZSB8fCB0aGlzUm91bmQudG90YWxJbnZlc3RvcnMgPiAwKTsKICAgICAgICAKICAgICAgICAvLyBjaGVjayBwYXltZW50IGlzIGFzIHJlcXVpcmVkCiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPT0gdGhpc0dyb3VwLmludmVzdG1lbnQpOwogICAgICAgIC8vIHZlcmlmeSB3ZSdyZSBtZW1iZXJzCiAgICAgICAgcmVxdWlyZSh0aGlzR3JvdXAubWVtYmVyc1tpbnZlc3Rvcl0uam9pblRpbWUgPiAwKTsKICAgICAgICAvLyB2ZXJpZnkgd2UncmUgbm90IGFscmVhZHkgaW52ZXN0b3JzIGluIHRoaXMgcm91bmQKICAgICAgICByZXF1aXJlKCEgaXNJbnZlc3RvckluUm91bmQodGhpc1JvdW5kLCBpbnZlc3RvcikpOwogICAgICAgIAogICAgICAgIC8vIG5vdGlmeSB0aGUgd29ybGQKICAgICAgICBJbnZlc3QoaW52ZXN0b3IsIF9ncm91cCwgcm91bmQsIGJsb2NrLnRpbWVzdGFtcCk7CgogICAgICAgIC8vIGNhbGN1bGF0ZSBmZWVzLiB0aGVyZSBhcmUgb3duZXIgZmVlIGFuZCBpbnZpdG9yIGZlZQogICAgICAgIHVpbnQyNTYgb3duZXJGZWUgPSBtc2cudmFsdWUubXVsKHRoaXNHcm91cC5vd25lckZlZSkuZGl2KDEwMDApOwogICAgICAgIGJhbGFuY2VzW293bmVyXSA9IGJhbGFuY2VzW293bmVyXS5hZGQob3duZXJGZWUpOwogICAgICAgIERlcG9zaXQob3duZXIsIG93bmVyRmVlLCBibG9jay50aW1lc3RhbXApOwogICAgICAgICAgICAgICAgCiAgICAgICAgdWludDI1NiBpbnZlc3RlZFN1bUxlc3NPd25lckZlZSA9IG1zZy52YWx1ZS5zdWIob3duZXJGZWUpOwoKICAgICAgICB1aW50MjU2IGludml0YXRpb25GZWUgPSBwYXlBbGxJbnZpdG9ycyh0aGlzR3JvdXAsIGludmVzdG9yLCBibG9jay50aW1lc3RhbXAsIGludmVzdGVkU3VtTGVzc093bmVyRmVlLCAwKTsKCiAgICAgICAgdWludDI1NiBpbnZlc3RlZE5ldFN1bSA9IGludmVzdGVkU3VtTGVzc093bmVyRmVlLnN1YihpbnZpdGF0aW9uRmVlKTsKICAgICAgICAKICAgICAgICAvLyBqb2luIHRoZSByb3VuZAogICAgICAgIHRoaXNSb3VuZC5pbnZlc3Rvck1hcHBpbmdbaW52ZXN0b3JdID0gdGhpc1JvdW5kLnRvdGFsSW52ZXN0b3JzOwogICAgICAgIHRoaXNSb3VuZC5pbnZlc3RtZW50c1t0aGlzUm91bmQudG90YWxJbnZlc3RvcnNdID0gSW52ZXN0bWVudCh7CiAgICAgICAgICAgIGludmVzdG9yOiBpbnZlc3RvciwKICAgICAgICAgICAgc3VtOiBpbnZlc3RlZE5ldFN1bSwKICAgICAgICAgICAgdGltZTogYmxvY2sudGltZXN0YW1wfSk7CiAgICAgICAgCiAgICAgICAgdGhpc1JvdW5kLnRvdGFsSW52ZXN0b3JzID0gdGhpc1JvdW5kLnRvdGFsSW52ZXN0b3JzLmFkZCgxKTsKICAgICAgICB0aGlzUm91bmQudG90YWxJbnZlc3RtZW50ID0gdGhpc1JvdW5kLnRvdGFsSW52ZXN0bWVudC5hZGQoaW52ZXN0ZWROZXRTdW0pOwogICAgICAgIAogICAgICAgIC8vIGNoZWNrIGlmIHRoaXMgcm91bmQgaGFzIGJlZW4gY29tcGxldGVseSBwb3B1bGF0ZWQuIElmIHNvLCBjbG9zZSB0aGlzIHJvdW5kIGFuZCBwcmVwYXJlIHRoZSBuZXh0IHJvdW5kCiAgICAgICAgaWYgKHRoaXNSb3VuZC50b3RhbEludmVzdG9ycyA9PSB0aGlzR3JvdXAucm91bmRTaXplKSB7CiAgICAgICAgICAgIHRoaXNHcm91cC5jdXJyZW50Um91bmQgPSB0aGlzR3JvdXAuY3VycmVudFJvdW5kLmFkZCgxKTsKICAgICAgICAgICAgdGhpc1JvdW5kLmxhc3RCbG9jayA9IGJsb2NrLm51bWJlcjsKICAgICAgICB9CgogICAgICAgIC8vIGV2ZXJ5IGludmVzdG9yIGFsc28gaGVscHMgYnkgY2hlY2tpbmcgZm9yIGEgcHJldmlvdXMgd2lubmVyLgogICAgICAgIGFkZHJlc3Mgd2lubmVyOwogICAgICAgIHN0cmluZyBtZW1vcnkgcmVhc29uOwogICAgICAgICh3aW5uZXIsIHJlYXNvbikgPSBjaGVja1dpbm5lckludGVybmFsKHRoaXNHcm91cCk7CiAgICAgICAgaWYgKHdpbm5lciAhPSAwKQogICAgICAgICAgICBkZWNsYXJlV2lubmVyKF9ncm91cCwgd2lubmVyKTsKICAgIH0KCiAgICAKICAgIC8qKgogICAgICogd2l0aGRyYXcgY29sbGVjdHMgZHVlIGZ1bmRzIGluIGEgc2FmZSBtYW5uZXIKICAgICAqLwogICAgZnVuY3Rpb24gd2l0aGRyYXcodWludDI1NiBzdW0pIHB1YmxpYyB7CiAgICAgICAgYWRkcmVzcyB3aXRoZHJhd2VyID0gbXNnLnNlbmRlcjsKICAgICAgICAvLyBkbyB3ZSBoYXZlIGVub3VnaCBmdW5kcyBmb3Igd2l0aGRyYXdhbD8KICAgICAgICByZXF1aXJlKGJhbGFuY2VzW3dpdGhkcmF3ZXJdID49IHN1bSk7CgogICAgICAgIC8vIG5vdGlmeSB0aGUgd29ybGQKICAgICAgICBXaXRoZHJhdyh3aXRoZHJhd2VyLCBzdW0sIGJsb2NrLnRpbWVzdGFtcCk7CiAgICAgICAgCiAgICAgICAgLy8gdXBkYXRlIChzYWZlbHkpCiAgICAgICAgYmFsYW5jZXNbd2l0aGRyYXdlcl0gPSBiYWxhbmNlc1t3aXRoZHJhd2VyXS5zdWIoc3VtKTsKICAgICAgICB3aXRoZHJhd2VyLnRyYW5zZmVyKHN1bSk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogY2hlY2tXaW5uZXIgY2hlY2tzIGlmIGF0IHRoZSB0aW1lIG9mIHRoZSBjYWxsIGEgd2lubmVyIGV4aXN0cyBmb3IgdGhlIGN1cnJlbnRseSBlYXJsaWVzdCB1bndvbiByb3VuZCBvZiB0aGUgZ2l2ZW4gZ3JvdXAuCiAgICAgKiBObyBkZWNsYXJhdGlvbiBpcyBtYWRlIC0gc28gYW5vdGhlciB3aW5uZXIgY291bGQgYmUgc2VsZWN0ZWQgbGF0ZXIhCiAgICAgKi8KICAgIGZ1bmN0aW9uIGNoZWNrV2lubmVyKHVpbnQzMiBfZ3JvdXApIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sIGZvdW5kV2lubmVyLCBzdHJpbmcgcmVhc29uKSB7CiAgICAgICAgR3JvdXAgc3RvcmFnZSB0aGlzR3JvdXAgPSBncm91cHNbX2dyb3VwXTsKICAgICAgICByZXF1aXJlKHRoaXNHcm91cC5yb3VuZFNpemUgPiAwKTsKICAgICAgICBhZGRyZXNzIHdpbm5lcjsKICAgICAgICAod2lubmVyLCByZWFzb24pID0gY2hlY2tXaW5uZXJJbnRlcm5hbCh0aGlzR3JvdXApOwogICAgICAgIGZvdW5kV2lubmVyID0gd2lubmVyICE9IDA7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogY2hlY2tBbmREZWNsYXJlV2lubmVyIGNoZWNrcyBpZiBhdCB0aGUgdGltZSBvZiB0aGUgY2FsbCBhIHdpbm5lciBleGlzdHMgZm9yIHRoZSBjdXJyZW50bHkgZWFybGllc3QgdW53b24gcm91bmQgb2YgdGhlIGdpdmVuIGdyb3VwLAogICAgICogYW5kIHRoZW4gZGVjbGFyZXMgdGhlIHdpbm5lci4KICAgICAqIFJldmVydHMgaWYgbm8gd2lubmVyIGZvdW5kLCB0byBwcmV2ZW50IHVubmVjZXNzYXJ5IGdhcyBleHBlbnNlcy4KICAgICAqLwoKICAgIGZ1bmN0aW9uIGNoZWNrQW5kRGVjbGFyZVdpbm5lcih1aW50MzIgX2dyb3VwKSBwdWJsaWMgewogICAgICAgIEdyb3VwIHN0b3JhZ2UgdGhpc0dyb3VwID0gZ3JvdXBzW19ncm91cF07CiAgICAgICAgcmVxdWlyZSh0aGlzR3JvdXAucm91bmRTaXplID4gMCk7CiAgICAgICAgYWRkcmVzcyB3aW5uZXI7CiAgICAgICAgc3RyaW5nIG1lbW9yeSByZWFzb247CiAgICAgICAgKHdpbm5lciwgcmVhc29uKSA9IGNoZWNrV2lubmVySW50ZXJuYWwodGhpc0dyb3VwKTsKICAgICAgICAvLyByZXZlcnQgaWYgbm8gd2lubmVyIGZvdW5kCiAgICAgICAgcmVxdWlyZSh3aW5uZXIgIT0gMCk7CiAgICAgICAgLy8gbGV0J3MgZGVjbGFyZSB0aGUgd2lubmVyIQogICAgICAgIGRlY2xhcmVXaW5uZXIoX2dyb3VwLCB3aW5uZXIpOwogICAgfQoKICAgIC8qKgogICAgICogZGVjbGFyZVdpbm5lciBldGNoZXMgdGhlIHdpbm5lciBpbnRvIHRoZSBibG9ja2NoYWluLgogICAgICovCgogICAgZnVuY3Rpb24gZGVjbGFyZVdpbm5lcih1aW50MzIgX2dyb3VwLCBhZGRyZXNzIF93aW5uZXIpIGludGVybmFsIHsKICAgICAgICAvLyBsZXQncyBkZWNsYXJlIHRoZSB3aW5uZXIhCiAgICAgICAgR3JvdXAgc3RvcmFnZSB0aGlzR3JvdXAgPSBncm91cHNbX2dyb3VwXTsKICAgICAgICBSb3VuZCBzdG9yYWdlIHVud29uUm91bmQgPSB0aGlzR3JvdXAucm91bmRzW3RoaXNHcm91cC5maXJzdFVud29uUm91bmRdOwogICAgCiAgICAgICAgdW53b25Sb3VuZC53aW5uZXIgPSBfd2lubmVyOwogICAgICAgIAogICAgICAgIC8vIG5vdGlmeSB0aGUgd29ybGQKICAgICAgICBXaW5uZXIoX3dpbm5lciwgX2dyb3VwLCB0aGlzR3JvdXAuZmlyc3RVbndvblJvdW5kLCBibG9jay50aW1lc3RhbXApOwogICAgICAgIHVpbnQyNTYgd29uU3VtID0gdW53b25Sb3VuZC50b3RhbEludmVzdG1lbnQ7CiAgICAgICAgCiAgICAgICAgd29uU3VtID0gd29uU3VtLnN1YihwYXlBbGxJbnZpdG9ycyh0aGlzR3JvdXAsIF93aW5uZXIsIGJsb2NrLnRpbWVzdGFtcCwgd29uU3VtLCAwKSk7CiAgICAgICAgCiAgICAgICAgYmFsYW5jZXNbX3dpbm5lcl0gPSBiYWxhbmNlc1tfd2lubmVyXS5hZGQod29uU3VtKTsKICAgICAgICAKICAgICAgICBEZXBvc2l0KF93aW5uZXIsIHdvblN1bSwgYmxvY2sudGltZXN0YW1wKTsKICAgICAgICAgICAgCiAgICAgICAgLy8gdXBkYXRlIHRoZSB1bndvbiByb3VuZAogICAgICAgIHRoaXNHcm91cC5maXJzdFVud29uUm91bmQgPSB0aGlzR3JvdXAuZmlyc3RVbndvblJvdW5kLmFkZCgxKTsKICAgIH0KCiAgICAvKioKICAgICAqIGNoZWNrV2lubmVySW5lcm5hbCB0cmllcyBmaW5kaW5nIGEgd2lubmVyIGZvciB0aGUgb2xkZXN0IG5vbi1kZWNpZGVkIHJvdW5kLgogICAgICogUmV0dXJucyB3aW5uZXIgIT0gMCBpZmYgYSBuZXcgd2lubmVyIHdhcyBmb3VuZCwgYXMgd2VsbCBhcyByZWFzb24KICAgICAqLwogICAgZnVuY3Rpb24gY2hlY2tXaW5uZXJJbnRlcm5hbChHcm91cCBzdG9yYWdlIHRoaXNHcm91cCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcyB3aW5uZXIsIHN0cmluZyByZWFzb24pIHsKICAgICAgICB3aW5uZXIgPSAwOyAvLyBhc3N1bWUgaGF2ZSBub3QgZm91bmQgYSBuZXcgd2lubmVyCiAgICAgICAgLy8gc29tZSB0ZXN0cwogICAgICAgIC8vIHRoZSBmaXJzdCByb3VuZCBoYXMgbm8gcHJldmlvdXMgcm91bmRzIHRvIGNoZWNrCiAgICAgICAgaWYgKHRoaXNHcm91cC5jdXJyZW50Um91bmQgPT0gMCkgewogICAgICAgICAgICByZWFzb24gPSAnU3RpbGwgaW4gZmlyc3Qgcm91bmQnOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIC8vIHdlIGRvbid0IGNoZWNrIGN1cnJlbnQgcm91bmQgLSBieSBkZWZpbml0aW9uIGl0IGlzIG5vdCBmdWxsCiAgICAgICAgaWYgKHRoaXNHcm91cC5jdXJyZW50Um91bmQgPT0gdGhpc0dyb3VwLmZpcnN0VW53b25Sb3VuZCkgewogICAgICAgICAgICByZWFzb24gPSAnTm8gdW53b24gZmluaXNoZWQgcm91bmRzJzsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAKICAgICAgICBSb3VuZCBzdG9yYWdlIHVud29uUm91bmQgPSB0aGlzR3JvdXAucm91bmRzW3RoaXNHcm91cC5maXJzdFVud29uUm91bmRdOwogICAgICAgIAogICAgICAgIC8vIHdlIHdpbGwgc2NhbiBhIHJhbmdlIG9mIGJsb2NrcywgZnJvbSB1bndvblJvdW5kLmxhc3RCbG9jayArIHRoaXNHcm91cC5ibG9ja3NCZWZvcmVXaW5DaGVjazsKICAgICAgICB1aW50MjU2IGZpcnN0QmxvY2sgPSB1bndvblJvdW5kLmxhc3RCbG9jay5hZGQodGhpc0dyb3VwLmJsb2Nrc0JlZm9yZVdpbkNoZWNrKTsKICAgICAgICAvLyBidXQgd2UgY2FuJ3Qgc2NhbiBtb3JlIHRoYW4gMjU1IGJsb2NrcyBpbnRvIHRoZSBwYXN0CiAgICAgICAgLy8gdGhlIGZpcnN0IHRlc3QgaXMgZm9yIHRlc3RpbmcgZW52aXJvbm1lbnRzIHRoYXQgbWF5IGhhdmUgbGVzcyB0aGFuIDI1NiBibG9ja3MgOikKICAgICAgICBpZiAoYmxvY2subnVtYmVyID4gMjU1ICYmIGZpcnN0QmxvY2sgPCBibG9jay5udW1iZXIuc3ViKDI1NSkpCiAgICAgICAgICAgIGZpcnN0QmxvY2sgPSBibG9jay5udW1iZXIuc3ViKDI1NSk7CiAgICAgICAgLy8gdGhlIHNjYW4gZW5kcyBhdCB0aGUgbGFzdCBjb21taXR0ZWQgYmxvY2sKICAgICAgICB1aW50MjU2IGxhc3RCbG9jayA9IGJsb2NrLm51bWJlci5zdWIoMSk7CgogICAgICAgIGZvciAodWludDI1NiB0aGlzQmxvY2sgPSBmaXJzdEJsb2NrOyB0aGlzQmxvY2sgPD0gbGFzdEJsb2NrOyB0aGlzQmxvY2sgPSB0aGlzQmxvY2suYWRkKDEpKSB7CiAgICAgICAgICAgIHVpbnQyNTYgbGF0ZXN0SGFzaCA9IHVpbnQyNTYoYmxvY2suYmxvY2toYXNoKHRoaXNCbG9jaykpOwogICAgICAgICAgICAvLyB3ZSdyZSAiZHJhd2luZyIgYSB3aW5uZXIgb3V0IG9mIHRoZSBzZWN1cml0eS1mYWN0b3Itc2l6ZWQgZ3JvdXAgLSBwZXJoYXBzIG5vIHdpbm5lciBhdCBhbGwgIAogICAgICAgICAgICB1aW50MzIgZHJhd24gPSB1aW50MzIobGF0ZXN0SGFzaCAlIHRoaXNHcm91cC5zZWN1cml0eUZhY3Rvcik7CiAgICAgICAgICAgIGlmIChkcmF3biA8IHRoaXNHcm91cC5yb3VuZFNpemUpIHsKICAgICAgICAgICAgICAgIC8vIHdlIGhhdmUgYSB3aW5uZXIhCiAgICAgICAgICAgICAgICB3aW5uZXIgPSB1bndvblJvdW5kLmludmVzdG1lbnRzW2RyYXduXS5pbnZlc3RvcjsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFzb24gPSAnTm8gd2lubmVyIHBpY2tlZCc7CiAgICB9IAogICAgCiAgICAvKioKICAgICAqIEdpdmVuIGEgZ3JvdXAsIGludmVzdG9yIGFuZCBhbW91bnQgb2Ygd2VpLCBwYXkgYWxsIHRoZSBlbGlnaWJsZSBpbnZpdG9ycy4KICAgICAqIE5PVEU6IGRvZXMgbm90IGRyYXcgZnJvbSB0aGUgX3BheWVyIGJhbGFuY2UgLSB3ZSdyZSBhc3N1bWluZyB0aGUgcmV0dXJuZWQgdmFsdWUgd2lsbCBiZSBkZWR1Y3RlZCB3aGVuIG5lY2Vzc2FyeS4KICAgICAqIE5PVEUgMjogYSByZWN1cnNpdmUgY2FsbCwgeWV0IHRoZSBkZXB0aCBpcyBsaW1pdGVkIGJ5IDgtYml0cyBzbyBubyByZWFsIHN0YWNrIGNvbmNyZW4uCiAgICAgKiBSZXR1cm4gdGhlIGFtb3VudCBvZiB3ZWkgdG8gYmUgZGVkdWN0ZWQgZnJvbSB0aGUgcGF5ZXIKICAgICAqLwogICAgZnVuY3Rpb24gcGF5QWxsSW52aXRvcnMoR3JvdXAgc3RvcmFnZSB0aGlzR3JvdXAsIGFkZHJlc3MgX3BheWVyLCB1aW50MjU2IF9yZWxldmFudFRpbWUsIHVpbnQyNTYgX2Ftb3VudCwgdWludDMyIF9kZXB0aCkgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NiBpbnZpdGF0aW9uRmVlKSB7CgogICAgICAgIGFkZHJlc3MgaW52aXRvciA9IHRoaXNHcm91cC5tZW1iZXJzW19wYXllcl0uaW52aXRvcjsKICAgICAgICAvLyBjb25kaXRpb25zIGZvciBwYXltZW50OgogICAgICAgIGlmICgKICAgICAgICAvLyB0aGUgcGF5ZXIncyBpbnZpdG9yIGlzIG5vdCB0aGUgb3duZXIuLi4KICAgICAgICAgICAgaW52aXRvciA9PSBvd25lciB8fAogICAgICAgIC8vIG11c3QgaGF2ZSBzb21ldGhpbmcgdG8gc2hhcmUuLi4KICAgICAgICAgICAgX2Ftb3VudCA9PSAwIHx8CiAgICAgICAgLy8gbm8gbW9yZSB0aGFuIHNwZWNpZmllZCBkZXB0aAogICAgICAgICAgICBfZGVwdGggPj0gdGhpc0dyb3VwLmludml0YXRpb25GZWVEZXB0aCB8fAogICAgICAgIC8vIHRoZSBpbnZpdG9yJ3MgaW52aXRhdGlvbiB0aW1lIGhhcyBub3QgZXhwaXJlZAogICAgICAgICAgICBfcmVsZXZhbnRUaW1lID4gdGhpc0dyb3VwLm1lbWJlcnNbX3BheWVyXS5qb2luVGltZS5hZGQodGhpc0dyb3VwLmludml0YXRpb25GZWVQZXJpb2QubXVsKDEgZGF5cykpCiAgICAgICAgKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIC8vIGNvbXB1dGUgaG93IG11Y2ggdG8gcGF5CiAgICAgICAgaW52aXRhdGlvbkZlZSA9IF9hbW91bnQubXVsKHRoaXNHcm91cC5pbnZpdGF0aW9uRmVlKS5kaXYoMTAwMCk7CiAgICAgICAgCiAgICAgICAgLy8gd2UgbWF5IGhhdmUgcmVhY2hlZCByb2NrIGJvdHRvbSAtIGRvbid0IGNvbnRpbnVlCiAgICAgICAgaWYgKGludml0YXRpb25GZWUgPT0gMCkgcmV0dXJuOwoKICAgICAgICAvLyBjYWxjdWxhdGUgcmVjdXJzaXZlbHkgZXZlbiBoaWdoZXItaGllcmFyY3kgZmVlcwogICAgICAgIHVpbnQyNTYgaW52aXRvckZlZSA9IHBheUFsbEludml0b3JzKHRoaXNHcm91cCwgaW52aXRvciwgX3JlbGV2YW50VGltZSwgIGludml0YXRpb25GZWUsIF9kZXB0aC5hZGQoMSkpOwogICAgICAgIAogICAgICAgIC8vIG91dCBuZXQgaW52aXRhdGlvbiBmZWVzIGFyZS4uLgogICAgICAgIHVpbnQyNTYgcGFpZCA9IGludml0YXRpb25GZWUuc3ViKGludml0b3JGZWUpOwogICAgICAgIAogICAgICAgIC8vIHBheQogICAgICAgIGJhbGFuY2VzW2ludml0b3JdID0gYmFsYW5jZXNbaW52aXRvcl0uYWRkKHBhaWQpOwogICAgICAgIAogICAgICAgIC8vIG5vdGlmeSB0aGUgd29ybGQKICAgICAgICBEZXBvc2l0KGludml0b3IsIHBhaWQsIGJsb2NrLnRpbWVzdGFtcCk7CiAgICB9CgoKICAgIAogICAgLyoqCiAgICAgKiBJcyBhIHNwZWNpZmljIGludmVzdG9yIGluIGEgc3BlY2lmaWMgcm91bmQ/CiAgICAgKi8KICAgIGZ1bmN0aW9uIGlzSW52ZXN0b3JJblJvdW5kKFJvdW5kIHN0b3JhZ2UgX3JvdW5kLCBhZGRyZXNzIF9pbnZlc3RvcikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYm9vbCBpbnZlc3RvckluUm91bmQpIHsKICAgICAgICByZXR1cm4gKF9yb3VuZC5pbnZlc3RtZW50c1tfcm91bmQuaW52ZXN0b3JNYXBwaW5nW19pbnZlc3Rvcl1dLmludmVzdG9yID09IF9pbnZlc3Rvcik7CiAgICB9CiAgICAKICAgIAogICAgLyoqCiAgICAgKiBHZXQgaW5mbyBhYm91dCBzcGVjaWZpYyBhY2NvdW50CiAgICAgKi8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIGludmVzdG9yKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgYmFsYW5jZSA9IGJhbGFuY2VzW2ludmVzdG9yXTsKICAgIH0KICAgIAogICAgIAogICAgLyoqCiAgICAgKiBHZXQgaW5mbyBhYm91dCBncm91cHMKICAgICAqLwogICAgZnVuY3Rpb24gZ3JvdXBzQ291bnQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBjb3VudCkgewogICAgICAgIGNvdW50ID0gZ3JvdXBzLmxlbmd0aDsKICAgIH0KICAgICAKICAgIC8qKgogICAgICogR2V0IGluZm8gYWJvdXQgc3BlY2lmaWMgZ3JvdXAKICAgICAqLyAKICAgIGZ1bmN0aW9uIGdyb3VwSW5mbyh1aW50MzIgX2dyb3VwKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoCiAgICAgICAgc3RyaW5nIG5hbWUsCiAgICAgICAgdWludDMyIHJvdW5kU2l6ZSwKICAgICAgICB1aW50MjU2IGludmVzdG1lbnQsCiAgICAgICAgdWludDMyIGJsb2Nrc0JlZm9yZVdpbkNoZWNrLAogICAgICAgIHVpbnQzMiBzZWN1cml0eUZhY3RvciwKICAgICAgICB1aW50MzIgaW52aXRhdGlvbkZlZSwKICAgICAgICB1aW50MzIgb3duZXJGZWUsCiAgICAgICAgdWludDMyIGludml0YXRpb25GZWVQZXJpb2QsCiAgICAgICAgdWludDggaW52aXRhdGlvbkZlZURlcHRoLAogICAgICAgIGJvb2wgYWN0aXZlLAogICAgICAgIHVpbnQzMiBjdXJyZW50Um91bmQsCiAgICAgICAgdWludDMyIGZpcnN0VW53b25Sb3VuZAogICAgKSB7CiAgICAgICAgcmVxdWlyZShncm91cEV4aXN0cyhfZ3JvdXApKTsKICAgICAgICBHcm91cCBzdG9yYWdlIHRoaXNHcm91cCA9IGdyb3Vwc1tfZ3JvdXBdOwogICAgICAgIG5hbWUgPSB0aGlzR3JvdXAubmFtZTsKICAgICAgICByb3VuZFNpemUgPSB0aGlzR3JvdXAucm91bmRTaXplOwogICAgICAgIGludmVzdG1lbnQgPSB0aGlzR3JvdXAuaW52ZXN0bWVudDsKICAgICAgICBibG9ja3NCZWZvcmVXaW5DaGVjayA9IHRoaXNHcm91cC5ibG9ja3NCZWZvcmVXaW5DaGVjazsKICAgICAgICBzZWN1cml0eUZhY3RvciA9IHRoaXNHcm91cC5zZWN1cml0eUZhY3RvcjsKICAgICAgICBpbnZpdGF0aW9uRmVlID0gdGhpc0dyb3VwLmludml0YXRpb25GZWU7CiAgICAgICAgb3duZXJGZWUgPSB0aGlzR3JvdXAub3duZXJGZWU7CiAgICAgICAgaW52aXRhdGlvbkZlZVBlcmlvZCA9IHRoaXNHcm91cC5pbnZpdGF0aW9uRmVlUGVyaW9kOwogICAgICAgIGludml0YXRpb25GZWVEZXB0aCA9IHRoaXNHcm91cC5pbnZpdGF0aW9uRmVlRGVwdGg7CiAgICAgICAgYWN0aXZlID0gdGhpc0dyb3VwLmFjdGl2ZTsKICAgICAgICBjdXJyZW50Um91bmQgPSB0aGlzR3JvdXAuY3VycmVudFJvdW5kOwogICAgICAgIGZpcnN0VW53b25Sb3VuZCA9IHRoaXNHcm91cC5maXJzdFVud29uUm91bmQ7CiAgICB9CiAgICAKICAgICAKICAgIC8qKgogICAgICogR2V0IGluZm8gYWJvdXQgc3BlY2lmaWMgZ3JvdXAgbWVtYmVyCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdyb3VwTWVtYmVySW5mbyAodWludDMyIF9ncm91cCwgYWRkcmVzcyBpbnZlc3RvcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKAogICAgICAgIHVpbnQyNTYgam9pblRpbWUsCiAgICAgICAgYWRkcmVzcyBpbnZpdG9yCiAgICApIHsKICAgICAgICByZXF1aXJlKGdyb3VwRXhpc3RzKF9ncm91cCkpOwogICAgICAgIEdyb3VwTWVtYmVyIHN0b3JhZ2UgZ3JvdXBNZW1iZXIgPSBncm91cHNbX2dyb3VwXS5tZW1iZXJzW2ludmVzdG9yXTsKICAgICAgICBqb2luVGltZSA9IGdyb3VwTWVtYmVyLmpvaW5UaW1lOwogICAgICAgIGludml0b3IgPSBncm91cE1lbWJlci5pbnZpdG9yOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEdldCBpbmZvIGFib3V0IHNwZWNpZmljIGdyb3VwJ3Mgcm91bmQKICAgICAqLwogICAgZnVuY3Rpb24gcm91bmRJbmZvICh1aW50MzIgX2dyb3VwLCB1aW50MzIgX3JvdW5kKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoCiAgICAgICAgdWludDMyIHRvdGFsSW52ZXN0b3JzLAogICAgICAgIHVpbnQyNTYgdG90YWxJbnZlc3RtZW50LAogICAgICAgIGFkZHJlc3Mgd2lubmVyLAogICAgICAgIHVpbnQyNTYgbGFzdEJsb2NrCiAgICApIHsKICAgICAgICByZXF1aXJlKGdyb3VwRXhpc3RzKF9ncm91cCkpOwogICAgICAgIFJvdW5kIHN0b3JhZ2Ugcm91bmQgPSBncm91cHNbX2dyb3VwXS5yb3VuZHNbX3JvdW5kXTsKICAgICAgICB0b3RhbEludmVzdG9ycyA9IHJvdW5kLnRvdGFsSW52ZXN0b3JzOwogICAgICAgIHRvdGFsSW52ZXN0bWVudCA9IHJvdW5kLnRvdGFsSW52ZXN0bWVudDsKICAgICAgICB3aW5uZXIgPSByb3VuZC53aW5uZXI7CiAgICAgICAgbGFzdEJsb2NrID0gcm91bmQubGFzdEJsb2NrOwogICAgfSAKICAgIAogICAgLyoqCiAgICAgKiBHZXQgaW5mbyBhYm91dCBzcGVjaWZpYyByb3VuZCdzIGludmVzdG1lbnQsIGJ5IGludmVzdG9yCiAgICAgKi8KICAgIGZ1bmN0aW9uIHJvdW5kSW52ZXN0b3JJbmZvQnlBZGRyZXNzICh1aW50MzIgX2dyb3VwLCB1aW50MzIgX3JvdW5kLCBhZGRyZXNzIGludmVzdG9yKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoCiAgICAgICAgYm9vbCBpblJvdW5kLAogICAgICAgIHVpbnQzMiBpbmRleAogICAgKSB7CiAgICAgICAgcmVxdWlyZShncm91cEV4aXN0cyhfZ3JvdXApKTsKICAgICAgICBpbmRleCA9IGdyb3Vwc1tfZ3JvdXBdLnJvdW5kc1tfcm91bmRdLmludmVzdG9yTWFwcGluZ1tpbnZlc3Rvcl07CiAgICAgICAgaW5Sb3VuZCA9IGlzSW52ZXN0b3JJblJvdW5kKGdyb3Vwc1tfZ3JvdXBdLnJvdW5kc1tfcm91bmRdLCBpbnZlc3Rvcik7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogR2V0IGluZm8gYWJvdXQgc3BlY2lmaWMgcm91bmQncyBpbnZlc3RtZW50IC0gYnkgaW5kZXgKICAgICAqLwogICAgZnVuY3Rpb24gcm91bmRJbnZlc3RvckluZm9CeUluZGV4ICh1aW50MzIgX2dyb3VwLCB1aW50MzIgX3JvdW5kLCB1aW50MzIgX2luZGV4KSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoCiAgICAgICAgYWRkcmVzcyBpbnZlc3RvciwKICAgICAgICB1aW50MjU2IHN1bSwKICAgICAgICB1aW50MjU2IHRpbWUKICAgICkgewogICAgICAgIHJlcXVpcmUoZ3JvdXBFeGlzdHMoX2dyb3VwKSk7CiAgICAgICAgcmVxdWlyZShncm91cHNbX2dyb3VwXS5yb3VuZHNbX3JvdW5kXS50b3RhbEludmVzdG9ycyA+IF9pbmRleCk7CiAgICAgICAgSW52ZXN0bWVudCBzdG9yYWdlIGludmVzdG1lbnQgPSBncm91cHNbX2dyb3VwXS5yb3VuZHNbX3JvdW5kXS5pbnZlc3RtZW50c1tfaW5kZXhdOwogICAgICAgIGludmVzdG9yID0gaW52ZXN0bWVudC5pbnZlc3RvcjsKICAgICAgICBzdW0gPSBpbnZlc3RtZW50LnN1bTsKICAgICAgICB0aW1lID0gaW52ZXN0bWVudC50aW1lOwogICAgfQoKICAgIC8qKgogICAgICogRG9lcyBncm91cCBuYW1lIGV4aXN0PwogICAgICovCiAgICBmdW5jdGlvbiBncm91cE5hbWVFeGlzdHMoc3RyaW5nIF9ncm91cE5hbWUpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wgZXhpc3RzKSB7CiAgICAgICAgcmV0dXJuIGdyb3VwTmFtZXNbX2dyb3VwTmFtZV07CiAgICB9CgogICAgZnVuY3Rpb24gZ3JvdXBFeGlzdHModWludDMyIF9ncm91cCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYm9vbCBleGlzdHMpIHsKICAgICAgICByZXR1cm4gX2dyb3VwIDwgZ3JvdXBzLmxlbmd0aDsKICAgIH0KCn0KCgoKCgpsaWJyYXJ5IFNhZmVNYXRoMjU2IHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICByZXF1aXJlKGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIHJlcXVpcmUoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gcmVxdWlyZShhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXF1aXJlKGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICByZXF1aXJlKGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCmxpYnJhcnkgU2FmZU1hdGgzMiB7CiAgZnVuY3Rpb24gbXVsKHVpbnQzMiBhLCB1aW50MzIgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MzIpIHsKICAgIHVpbnQzMiBjID0gYSAqIGI7CiAgICByZXF1aXJlKGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQzMiBhLCB1aW50MzIgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MzIpIHsKICAgIC8vIHJlcXVpcmUoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQzMiBjID0gYSAvIGI7CiAgICAvLyByZXF1aXJlKGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQzMiBhLCB1aW50MzIgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MzIpIHsKICAgIHJlcXVpcmUoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MzIgYSwgdWludDMyIGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDMyKSB7CiAgICB1aW50MzIgYyA9IGEgKyBiOwogICAgcmVxdWlyZShjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9'.
	

]
