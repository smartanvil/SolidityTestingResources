Class {
	#name : #SRT67b11cab20cc25c2fa673afaa5b2c8ba0afb1a81,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT67b11cab20cc25c2fa673afaa5b2c8ba0afb1a81 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7Cgpjb250cmFjdCBNaW50YWJsZVRva2VuIHsKICAgIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGFtb3VudCk7CgogICAgLy8vIEBkZXYgbWludHMgbmV3IHRva2VucwogICAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBwdWJsaWM7Cn0KCmxpYnJhcnkgU2FmZU1hdGggewogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCmludGVyZmFjZSBJQXBwcm92YWxSZWNpcGllbnQgewogICAgLyoqCiAgICAgKiBAbm90aWNlIFNpZ25hbHMgdGhhdCB0b2tlbiBob2xkZXIgYXBwcm92ZWQgc3BlbmRpbmcgb2YgdG9rZW5zIGFuZCBzb21lIGFjdGlvbiBzaG91bGQgYmUgdGFrZW4uCiAgICAgKgogICAgICogQHBhcmFtIF9zZW5kZXIgdG9rZW4gaG9sZGVyIHdoaWNoIGFwcHJvdmVkIHNwZW5kaW5nIG9mIGhpcyB0b2tlbnMKICAgICAqIEBwYXJhbSBfdmFsdWUgYW1vdW50IG9mIHRva2VucyBhcHByb3ZlZCB0byBiZSBzcGVudAogICAgICogQHBhcmFtIF9leHRyYURhdGEgYW55IGV4dHJhIGRhdGEgdG9rZW4gaG9sZGVyIHByb3ZpZGVkIHRvIHRoZSBjYWxsCiAgICAgKgogICAgICogQGRldiB3YXJuaW5nOiBpbXBsZW1lbnRvcnMgc2hvdWxkIHZhbGlkYXRlIHNlbmRlciBvZiB0aGlzIG1lc3NhZ2UgKGl0IHNob3VsZCBiZSB0aGUgdG9rZW4pIGFuZCBtYWtlIG5vIGZ1cnRoZXIKICAgICAqICAgICAgYXNzdW1wdGlvbnMgdW5sZXNzIHZhbGlkYXRlZCB0aGVtIHZpYSBFUkMyMCBtZXRob2RzLgogICAgICovCiAgICBmdW5jdGlvbiByZWNlaXZlQXBwcm92YWwoYWRkcmVzcyBfc2VuZGVyLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2V4dHJhRGF0YSkgcHVibGljOwp9Cgpjb250cmFjdCBtdWx0aW93bmVkIHsKCgkvLyBUWVBFUwoKICAgIC8vIHN0cnVjdCBmb3IgdGhlIHN0YXR1cyBvZiBhIHBlbmRpbmcgb3BlcmF0aW9uLgogICAgc3RydWN0IE11bHRpT3duZWRPcGVyYXRpb25QZW5kaW5nU3RhdGUgewogICAgICAgIC8vIGNvdW50IG9mIGNvbmZpcm1hdGlvbnMgbmVlZGVkCiAgICAgICAgdWludCB5ZXROZWVkZWQ7CgogICAgICAgIC8vIGJpdG1hcCBvZiBjb25maXJtYXRpb25zIHdoZXJlIG93bmVyICNvd25lckluZGV4J3MgZGVjaXNpb24gY29ycmVzcG9uZHMgdG8gMioqb3duZXJJbmRleCBiaXQKICAgICAgICB1aW50IG93bmVyc0RvbmU7CgogICAgICAgIC8vIHBvc2l0aW9uIG9mIHRoaXMgb3BlcmF0aW9uIGtleSBpbiBtX211bHRpT3duZWRQZW5kaW5nSW5kZXgKICAgICAgICB1aW50IGluZGV4OwogICAgfQoKCS8vIEVWRU5UUwoKICAgIGV2ZW50IENvbmZpcm1hdGlvbihhZGRyZXNzIG93bmVyLCBieXRlczMyIG9wZXJhdGlvbik7CiAgICBldmVudCBSZXZva2UoYWRkcmVzcyBvd25lciwgYnl0ZXMzMiBvcGVyYXRpb24pOwogICAgZXZlbnQgRmluYWxDb25maXJtYXRpb24oYWRkcmVzcyBvd25lciwgYnl0ZXMzMiBvcGVyYXRpb24pOwoKICAgIC8vIHNvbWUgb3RoZXJzIGFyZSBpbiB0aGUgY2FzZSBvZiBhbiBvd25lciBjaGFuZ2luZy4KICAgIGV2ZW50IE93bmVyQ2hhbmdlZChhZGRyZXNzIG9sZE93bmVyLCBhZGRyZXNzIG5ld093bmVyKTsKICAgIGV2ZW50IE93bmVyQWRkZWQoYWRkcmVzcyBuZXdPd25lcik7CiAgICBldmVudCBPd25lclJlbW92ZWQoYWRkcmVzcyBvbGRPd25lcik7CgogICAgLy8gdGhlIGxhc3Qgb25lIGlzIGVtaXR0ZWQgaWYgdGhlIHJlcXVpcmVkIHNpZ25hdHVyZXMgY2hhbmdlCiAgICBldmVudCBSZXF1aXJlbWVudENoYW5nZWQodWludCBuZXdSZXF1aXJlbWVudCk7CgoJLy8gTU9ESUZJRVJTCgogICAgLy8gc2ltcGxlIHNpbmdsZS1zaWcgZnVuY3Rpb24gbW9kaWZpZXIuCiAgICBtb2RpZmllciBvbmx5b3duZXIgewogICAgICAgIHJlcXVpcmUoaXNPd25lcihtc2cuc2VuZGVyKSk7CiAgICAgICAgXzsKICAgIH0KICAgIC8vIG11bHRpLXNpZyBmdW5jdGlvbiBtb2RpZmllcjogdGhlIG9wZXJhdGlvbiBtdXN0IGhhdmUgYW4gaW50cmluc2ljIGhhc2ggaW4gb3JkZXIKICAgIC8vIHRoYXQgbGF0ZXIgYXR0ZW1wdHMgY2FuIGJlIHJlYWxpc2VkIGFzIHRoZSBzYW1lIHVuZGVybHlpbmcgb3BlcmF0aW9uIGFuZAogICAgLy8gdGh1cyBjb3VudCBhcyBjb25maXJtYXRpb25zLgogICAgbW9kaWZpZXIgb25seW1hbnlvd25lcnMoYnl0ZXMzMiBfb3BlcmF0aW9uKSB7CiAgICAgICAgaWYgKGNvbmZpcm1BbmRDaGVjayhfb3BlcmF0aW9uKSkgewogICAgICAgICAgICBfOwogICAgICAgIH0KICAgICAgICAvLyBFdmVuIGlmIHJlcXVpcmVkIG51bWJlciBvZiBjb25maXJtYXRpb25zIGhhcyd0IGJlZW4gY29sbGVjdGVkIHlldCwKICAgICAgICAvLyB3ZSBjYW4ndCB0aHJvdyBoZXJlIC0gYmVjYXVzZSBjaGFuZ2VzIHRvIHRoZSBzdGF0ZSBoYXZlIHRvIGJlIHByZXNlcnZlZC4KICAgICAgICAvLyBCdXQsIGNvbmZpcm1BbmRDaGVjayBpdHNlbGYgd2lsbCB0aHJvdyBpbiBjYXNlIHNlbmRlciBpcyBub3QgYW4gb3duZXIuCiAgICB9CgogICAgbW9kaWZpZXIgdmFsaWROdW1Pd25lcnModWludCBfbnVtT3duZXJzKSB7CiAgICAgICAgcmVxdWlyZShfbnVtT3duZXJzID4gMCAmJiBfbnVtT3duZXJzIDw9IGNfbWF4T3duZXJzKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG11bHRpT3duZWRWYWxpZFJlcXVpcmVtZW50KHVpbnQgX3JlcXVpcmVkLCB1aW50IF9udW1Pd25lcnMpIHsKICAgICAgICByZXF1aXJlKF9yZXF1aXJlZCA+IDAgJiYgX3JlcXVpcmVkIDw9IF9udW1Pd25lcnMpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb3duZXJFeGlzdHMoYWRkcmVzcyBfYWRkcmVzcykgewogICAgICAgIHJlcXVpcmUoaXNPd25lcihfYWRkcmVzcykpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb3duZXJEb2VzTm90RXhpc3QoYWRkcmVzcyBfYWRkcmVzcykgewogICAgICAgIHJlcXVpcmUoIWlzT3duZXIoX2FkZHJlc3MpKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG11bHRpT3duZWRPcGVyYXRpb25Jc0FjdGl2ZShieXRlczMyIF9vcGVyYXRpb24pIHsKICAgICAgICByZXF1aXJlKGlzT3BlcmF0aW9uQWN0aXZlKF9vcGVyYXRpb24pKTsKICAgICAgICBfOwogICAgfQoKCS8vIE1FVEhPRFMKCiAgICAvLyBjb25zdHJ1Y3RvciBpcyBnaXZlbiBudW1iZXIgb2Ygc2lncyByZXF1aXJlZCB0byBkbyBwcm90ZWN0ZWQgIm9ubHltYW55b3duZXJzIiB0cmFuc2FjdGlvbnMKICAgIC8vIGFzIHdlbGwgYXMgdGhlIHNlbGVjdGlvbiBvZiBhZGRyZXNzZXMgY2FwYWJsZSBvZiBjb25maXJtaW5nIHRoZW0gKG1zZy5zZW5kZXIgaXMgbm90IGFkZGVkIHRvIHRoZSBvd25lcnMhKS4KICAgIGZ1bmN0aW9uIG11bHRpb3duZWQoYWRkcmVzc1tdIF9vd25lcnMsIHVpbnQgX3JlcXVpcmVkKQogICAgICAgIHB1YmxpYwogICAgICAgIHZhbGlkTnVtT3duZXJzKF9vd25lcnMubGVuZ3RoKQogICAgICAgIG11bHRpT3duZWRWYWxpZFJlcXVpcmVtZW50KF9yZXF1aXJlZCwgX293bmVycy5sZW5ndGgpCiAgICB7CiAgICAgICAgYXNzZXJ0KGNfbWF4T3duZXJzIDw9IDI1NSk7CgogICAgICAgIG1fbnVtT3duZXJzID0gX293bmVycy5sZW5ndGg7CiAgICAgICAgbV9tdWx0aU93bmVkUmVxdWlyZWQgPSBfcmVxdWlyZWQ7CgogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IF9vd25lcnMubGVuZ3RoOyArK2kpCiAgICAgICAgewogICAgICAgICAgICBhZGRyZXNzIG93bmVyID0gX293bmVyc1tpXTsKICAgICAgICAgICAgLy8gaW52YWxpZCBhbmQgZHVwbGljYXRlIGFkZHJlc3NlcyBhcmUgbm90IGFsbG93ZWQKICAgICAgICAgICAgcmVxdWlyZSgwICE9IG93bmVyICYmICFpc093bmVyKG93bmVyKSAvKiBub3QgaXNPd25lciB5ZXQhICovKTsKCiAgICAgICAgICAgIHVpbnQgY3VycmVudE93bmVySW5kZXggPSBjaGVja093bmVySW5kZXgoaSArIDEgLyogZmlyc3Qgc2xvdCBpcyB1bnVzZWQgKi8pOwogICAgICAgICAgICBtX293bmVyc1tjdXJyZW50T3duZXJJbmRleF0gPSBvd25lcjsKICAgICAgICAgICAgbV9vd25lckluZGV4W293bmVyXSA9IGN1cnJlbnRPd25lckluZGV4OwogICAgICAgIH0KCiAgICAgICAgYXNzZXJ0T3duZXJzQXJlQ29uc2lzdGVudCgpOwogICAgfQoKICAgIC8vLyBAbm90aWNlIHJlcGxhY2VzIGFuIG93bmVyIGBfZnJvbWAgd2l0aCBhbm90aGVyIGBfdG9gLgogICAgLy8vIEBwYXJhbSBfZnJvbSBhZGRyZXNzIG9mIG93bmVyIHRvIHJlcGxhY2UKICAgIC8vLyBAcGFyYW0gX3RvIGFkZHJlc3Mgb2YgbmV3IG93bmVyCiAgICAvLyBBbGwgcGVuZGluZyBvcGVyYXRpb25zIHdpbGwgYmUgY2FuY2VsZWQhCiAgICBmdW5jdGlvbiBjaGFuZ2VPd25lcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bykKICAgICAgICBleHRlcm5hbAogICAgICAgIG93bmVyRXhpc3RzKF9mcm9tKQogICAgICAgIG93bmVyRG9lc05vdEV4aXN0KF90bykKICAgICAgICBvbmx5bWFueW93bmVycyhrZWNjYWsyNTYobXNnLmRhdGEpKQogICAgewogICAgICAgIGFzc2VydE93bmVyc0FyZUNvbnNpc3RlbnQoKTsKCiAgICAgICAgY2xlYXJQZW5kaW5nKCk7CiAgICAgICAgdWludCBvd25lckluZGV4ID0gY2hlY2tPd25lckluZGV4KG1fb3duZXJJbmRleFtfZnJvbV0pOwogICAgICAgIG1fb3duZXJzW293bmVySW5kZXhdID0gX3RvOwogICAgICAgIG1fb3duZXJJbmRleFtfZnJvbV0gPSAwOwogICAgICAgIG1fb3duZXJJbmRleFtfdG9dID0gb3duZXJJbmRleDsKCiAgICAgICAgYXNzZXJ0T3duZXJzQXJlQ29uc2lzdGVudCgpOwogICAgICAgIE93bmVyQ2hhbmdlZChfZnJvbSwgX3RvKTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBhZGRzIGFuIG93bmVyCiAgICAvLy8gQHBhcmFtIF9vd25lciBhZGRyZXNzIG9mIG5ldyBvd25lcgogICAgLy8gQWxsIHBlbmRpbmcgb3BlcmF0aW9ucyB3aWxsIGJlIGNhbmNlbGVkIQogICAgZnVuY3Rpb24gYWRkT3duZXIoYWRkcmVzcyBfb3duZXIpCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICBvd25lckRvZXNOb3RFeGlzdChfb3duZXIpCiAgICAgICAgdmFsaWROdW1Pd25lcnMobV9udW1Pd25lcnMgKyAxKQogICAgICAgIG9ubHltYW55b3duZXJzKGtlY2NhazI1Nihtc2cuZGF0YSkpCiAgICB7CiAgICAgICAgYXNzZXJ0T3duZXJzQXJlQ29uc2lzdGVudCgpOwoKICAgICAgICBjbGVhclBlbmRpbmcoKTsKICAgICAgICBtX251bU93bmVycysrOwogICAgICAgIG1fb3duZXJzW21fbnVtT3duZXJzXSA9IF9vd25lcjsKICAgICAgICBtX293bmVySW5kZXhbX293bmVyXSA9IGNoZWNrT3duZXJJbmRleChtX251bU93bmVycyk7CgogICAgICAgIGFzc2VydE93bmVyc0FyZUNvbnNpc3RlbnQoKTsKICAgICAgICBPd25lckFkZGVkKF9vd25lcik7CiAgICB9CgogICAgLy8vIEBub3RpY2UgcmVtb3ZlcyBhbiBvd25lcgogICAgLy8vIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBvZiBvd25lciB0byByZW1vdmUKICAgIC8vIEFsbCBwZW5kaW5nIG9wZXJhdGlvbnMgd2lsbCBiZSBjYW5jZWxlZCEKICAgIGZ1bmN0aW9uIHJlbW92ZU93bmVyKGFkZHJlc3MgX293bmVyKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgb3duZXJFeGlzdHMoX293bmVyKQogICAgICAgIHZhbGlkTnVtT3duZXJzKG1fbnVtT3duZXJzIC0gMSkKICAgICAgICBtdWx0aU93bmVkVmFsaWRSZXF1aXJlbWVudChtX211bHRpT3duZWRSZXF1aXJlZCwgbV9udW1Pd25lcnMgLSAxKQogICAgICAgIG9ubHltYW55b3duZXJzKGtlY2NhazI1Nihtc2cuZGF0YSkpCiAgICB7CiAgICAgICAgYXNzZXJ0T3duZXJzQXJlQ29uc2lzdGVudCgpOwoKICAgICAgICBjbGVhclBlbmRpbmcoKTsKICAgICAgICB1aW50IG93bmVySW5kZXggPSBjaGVja093bmVySW5kZXgobV9vd25lckluZGV4W19vd25lcl0pOwogICAgICAgIG1fb3duZXJzW293bmVySW5kZXhdID0gMDsKICAgICAgICBtX293bmVySW5kZXhbX293bmVyXSA9IDA7CiAgICAgICAgLy9tYWtlIHN1cmUgbV9udW1Pd25lcnMgaXMgZXF1YWwgdG8gdGhlIG51bWJlciBvZiBvd25lcnMgYW5kIGFsd2F5cyBwb2ludHMgdG8gdGhlIGxhc3Qgb3duZXIKICAgICAgICByZW9yZ2FuaXplT3duZXJzKCk7CgogICAgICAgIGFzc2VydE93bmVyc0FyZUNvbnNpc3RlbnQoKTsKICAgICAgICBPd25lclJlbW92ZWQoX293bmVyKTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBjaGFuZ2VzIHRoZSByZXF1aXJlZCBudW1iZXIgb2Ygb3duZXIgc2lnbmF0dXJlcwogICAgLy8vIEBwYXJhbSBfbmV3UmVxdWlyZWQgbmV3IG51bWJlciBvZiBzaWduYXR1cmVzIHJlcXVpcmVkCiAgICAvLyBBbGwgcGVuZGluZyBvcGVyYXRpb25zIHdpbGwgYmUgY2FuY2VsZWQhCiAgICBmdW5jdGlvbiBjaGFuZ2VSZXF1aXJlbWVudCh1aW50IF9uZXdSZXF1aXJlZCkKICAgICAgICBleHRlcm5hbAogICAgICAgIG11bHRpT3duZWRWYWxpZFJlcXVpcmVtZW50KF9uZXdSZXF1aXJlZCwgbV9udW1Pd25lcnMpCiAgICAgICAgb25seW1hbnlvd25lcnMoa2VjY2FrMjU2KG1zZy5kYXRhKSkKICAgIHsKICAgICAgICBtX211bHRpT3duZWRSZXF1aXJlZCA9IF9uZXdSZXF1aXJlZDsKICAgICAgICBjbGVhclBlbmRpbmcoKTsKICAgICAgICBSZXF1aXJlbWVudENoYW5nZWQoX25ld1JlcXVpcmVkKTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBHZXRzIGFuIG93bmVyIGJ5IDAtaW5kZXhlZCBwb3NpdGlvbgogICAgLy8vIEBwYXJhbSBvd25lckluZGV4IDAtaW5kZXhlZCBvd25lciBwb3NpdGlvbgogICAgZnVuY3Rpb24gZ2V0T3duZXIodWludCBvd25lckluZGV4KSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcykgewogICAgICAgIHJldHVybiBtX293bmVyc1tvd25lckluZGV4ICsgMV07CiAgICB9CgogICAgLy8vIEBub3RpY2UgR2V0cyBvd25lcnMKICAgIC8vLyBAcmV0dXJuIG1lbW9yeSBhcnJheSBvZiBvd25lcnMKICAgIGZ1bmN0aW9uIGdldE93bmVycygpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzW10pIHsKICAgICAgICBhZGRyZXNzW10gbWVtb3J5IHJlc3VsdCA9IG5ldyBhZGRyZXNzW10obV9udW1Pd25lcnMpOwogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IG1fbnVtT3duZXJzOyBpKyspCiAgICAgICAgICAgIHJlc3VsdFtpXSA9IGdldE93bmVyKGkpOwoKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICAgIC8vLyBAbm90aWNlIGNoZWNrcyBpZiBwcm92aWRlZCBhZGRyZXNzIGlzIGFuIG93bmVyIGFkZHJlc3MKICAgIC8vLyBAcGFyYW0gX2FkZHIgYWRkcmVzcyB0byBjaGVjawogICAgLy8vIEByZXR1cm4gdHJ1ZSBpZiBpdCdzIGFuIG93bmVyCiAgICBmdW5jdGlvbiBpc093bmVyKGFkZHJlc3MgX2FkZHIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIG1fb3duZXJJbmRleFtfYWRkcl0gPiAwOwogICAgfQoKICAgIC8vLyBAbm90aWNlIFRlc3RzIG93bmVyc2hpcCBvZiB0aGUgY3VycmVudCBjYWxsZXIuCiAgICAvLy8gQHJldHVybiB0cnVlIGlmIGl0J3MgYW4gb3duZXIKICAgIC8vIEl0J3MgYWR2aXNhYmxlIHRvIGNhbGwgaXQgYnkgbmV3IG93bmVyIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSBzYW1lIGVycm9uZW91cyBhZGRyZXNzIGlzIG5vdCBjb3B5LXBhc3RlZCB0bwogICAgLy8gYWRkT3duZXIvY2hhbmdlT3duZXIgYW5kIHRvIGlzT3duZXIuCiAgICBmdW5jdGlvbiBhbUlPd25lcigpIGV4dGVybmFsIGNvbnN0YW50IG9ubHlvd25lciByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8vIEBub3RpY2UgUmV2b2tlcyBhIHByaW9yIGNvbmZpcm1hdGlvbiBvZiB0aGUgZ2l2ZW4gb3BlcmF0aW9uCiAgICAvLy8gQHBhcmFtIF9vcGVyYXRpb24gb3BlcmF0aW9uIHZhbHVlLCB0eXBpY2FsbHkga2VjY2FrMjU2KG1zZy5kYXRhKQogICAgZnVuY3Rpb24gcmV2b2tlKGJ5dGVzMzIgX29wZXJhdGlvbikKICAgICAgICBleHRlcm5hbAogICAgICAgIG11bHRpT3duZWRPcGVyYXRpb25Jc0FjdGl2ZShfb3BlcmF0aW9uKQogICAgICAgIG9ubHlvd25lcgogICAgewogICAgICAgIHVpbnQgb3duZXJJbmRleEJpdCA9IG1ha2VPd25lckJpdG1hcEJpdChtc2cuc2VuZGVyKTsKICAgICAgICB2YXIgcGVuZGluZyA9IG1fbXVsdGlPd25lZFBlbmRpbmdbX29wZXJhdGlvbl07CiAgICAgICAgcmVxdWlyZShwZW5kaW5nLm93bmVyc0RvbmUgJiBvd25lckluZGV4Qml0ID4gMCk7CgogICAgICAgIGFzc2VydE9wZXJhdGlvbklzQ29uc2lzdGVudChfb3BlcmF0aW9uKTsKCiAgICAgICAgcGVuZGluZy55ZXROZWVkZWQrKzsKICAgICAgICBwZW5kaW5nLm93bmVyc0RvbmUgLT0gb3duZXJJbmRleEJpdDsKCiAgICAgICAgYXNzZXJ0T3BlcmF0aW9uSXNDb25zaXN0ZW50KF9vcGVyYXRpb24pOwogICAgICAgIFJldm9rZShtc2cuc2VuZGVyLCBfb3BlcmF0aW9uKTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBDaGVja3MgaWYgb3duZXIgY29uZmlybWVkIGdpdmVuIG9wZXJhdGlvbgogICAgLy8vIEBwYXJhbSBfb3BlcmF0aW9uIG9wZXJhdGlvbiB2YWx1ZSwgdHlwaWNhbGx5IGtlY2NhazI1Nihtc2cuZGF0YSkKICAgIC8vLyBAcGFyYW0gX293bmVyIGFuIG93bmVyIGFkZHJlc3MKICAgIGZ1bmN0aW9uIGhhc0NvbmZpcm1lZChieXRlczMyIF9vcGVyYXRpb24sIGFkZHJlc3MgX293bmVyKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgY29uc3RhbnQKICAgICAgICBtdWx0aU93bmVkT3BlcmF0aW9uSXNBY3RpdmUoX29wZXJhdGlvbikKICAgICAgICBvd25lckV4aXN0cyhfb3duZXIpCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXR1cm4gIShtX211bHRpT3duZWRQZW5kaW5nW19vcGVyYXRpb25dLm93bmVyc0RvbmUgJiBtYWtlT3duZXJCaXRtYXBCaXQoX293bmVyKSA9PSAwKTsKICAgIH0KCiAgICAvLyBJTlRFUk5BTCBNRVRIT0RTCgogICAgZnVuY3Rpb24gY29uZmlybUFuZENoZWNrKGJ5dGVzMzIgX29wZXJhdGlvbikKICAgICAgICBwcml2YXRlCiAgICAgICAgb25seW93bmVyCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICBpZiAoNTEyID09IG1fbXVsdGlPd25lZFBlbmRpbmdJbmRleC5sZW5ndGgpCiAgICAgICAgICAgIC8vIEluIGNhc2UgbV9tdWx0aU93bmVkUGVuZGluZ0luZGV4IGdyb3dzIHRvbyBtdWNoIHdlIGhhdmUgdG8gc2hyaW5rIGl0OiBvdGhlcndpc2UgYXQgc29tZSBwb2ludAogICAgICAgICAgICAvLyB3ZSB3b24ndCBiZSBhYmxlIHRvIGRvIGl0IGJlY2F1c2Ugb2YgYmxvY2sgZ2FzIGxpbWl0LgogICAgICAgICAgICAvLyBZZXMsIHBlbmRpbmcgY29uZmlybWF0aW9ucyB3aWxsIGJlIGxvc3QuIERvbnQgc2VlIGFueSBzZWN1cml0eSBvciBzdGFiaWxpdHkgaW1wbGljYXRpb25zLgogICAgICAgICAgICAvLyBUT0RPIHVzZSBtb3JlIGdyYWNlZnVsIGFwcHJvYWNoIGxpa2UgY29tcGFjdCBvciByZW1vdmFsIG9mIGNsZWFyUGVuZGluZyBjb21wbGV0ZWx5CiAgICAgICAgICAgIGNsZWFyUGVuZGluZygpOwoKICAgICAgICB2YXIgcGVuZGluZyA9IG1fbXVsdGlPd25lZFBlbmRpbmdbX29wZXJhdGlvbl07CgogICAgICAgIC8vIGlmIHdlJ3JlIG5vdCB5ZXQgd29ya2luZyBvbiB0aGlzIG9wZXJhdGlvbiwgc3dpdGNoIG92ZXIgYW5kIHJlc2V0IHRoZSBjb25maXJtYXRpb24gc3RhdHVzLgogICAgICAgIGlmICghIGlzT3BlcmF0aW9uQWN0aXZlKF9vcGVyYXRpb24pKSB7CiAgICAgICAgICAgIC8vIHJlc2V0IGNvdW50IG9mIGNvbmZpcm1hdGlvbnMgbmVlZGVkLgogICAgICAgICAgICBwZW5kaW5nLnlldE5lZWRlZCA9IG1fbXVsdGlPd25lZFJlcXVpcmVkOwogICAgICAgICAgICAvLyByZXNldCB3aGljaCBvd25lcnMgaGF2ZSBjb25maXJtZWQgKG5vbmUpIC0gc2V0IG91ciBiaXRtYXAgdG8gMC4KICAgICAgICAgICAgcGVuZGluZy5vd25lcnNEb25lID0gMDsKICAgICAgICAgICAgcGVuZGluZy5pbmRleCA9IG1fbXVsdGlPd25lZFBlbmRpbmdJbmRleC5sZW5ndGgrKzsKICAgICAgICAgICAgbV9tdWx0aU93bmVkUGVuZGluZ0luZGV4W3BlbmRpbmcuaW5kZXhdID0gX29wZXJhdGlvbjsKICAgICAgICAgICAgYXNzZXJ0T3BlcmF0aW9uSXNDb25zaXN0ZW50KF9vcGVyYXRpb24pOwogICAgICAgIH0KCiAgICAgICAgLy8gZGV0ZXJtaW5lIHRoZSBiaXQgdG8gc2V0IGZvciB0aGlzIG93bmVyLgogICAgICAgIHVpbnQgb3duZXJJbmRleEJpdCA9IG1ha2VPd25lckJpdG1hcEJpdChtc2cuc2VuZGVyKTsKICAgICAgICAvLyBtYWtlIHN1cmUgd2UgKHRoZSBtZXNzYWdlIHNlbmRlcikgaGF2ZW4ndCBjb25maXJtZWQgdGhpcyBvcGVyYXRpb24gcHJldmlvdXNseS4KICAgICAgICBpZiAocGVuZGluZy5vd25lcnNEb25lICYgb3duZXJJbmRleEJpdCA9PSAwKSB7CiAgICAgICAgICAgIC8vIG9rIC0gY2hlY2sgaWYgY291bnQgaXMgZW5vdWdoIHRvIGdvIGFoZWFkLgogICAgICAgICAgICBhc3NlcnQocGVuZGluZy55ZXROZWVkZWQgPiAwKTsKICAgICAgICAgICAgaWYgKHBlbmRpbmcueWV0TmVlZGVkID09IDEpIHsKICAgICAgICAgICAgICAgIC8vIGVub3VnaCBjb25maXJtYXRpb25zOiByZXNldCBhbmQgcnVuIGludGVyaW9yLgogICAgICAgICAgICAgICAgZGVsZXRlIG1fbXVsdGlPd25lZFBlbmRpbmdJbmRleFttX211bHRpT3duZWRQZW5kaW5nW19vcGVyYXRpb25dLmluZGV4XTsKICAgICAgICAgICAgICAgIGRlbGV0ZSBtX211bHRpT3duZWRQZW5kaW5nW19vcGVyYXRpb25dOwogICAgICAgICAgICAgICAgRmluYWxDb25maXJtYXRpb24obXNnLnNlbmRlciwgX29wZXJhdGlvbik7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIC8vIG5vdCBlbm91Z2g6IHJlY29yZCB0aGF0IHRoaXMgb3duZXIgaW4gcGFydGljdWxhciBjb25maXJtZWQuCiAgICAgICAgICAgICAgICBwZW5kaW5nLnlldE5lZWRlZC0tOwogICAgICAgICAgICAgICAgcGVuZGluZy5vd25lcnNEb25lIHw9IG93bmVySW5kZXhCaXQ7CiAgICAgICAgICAgICAgICBhc3NlcnRPcGVyYXRpb25Jc0NvbnNpc3RlbnQoX29wZXJhdGlvbik7CiAgICAgICAgICAgICAgICBDb25maXJtYXRpb24obXNnLnNlbmRlciwgX29wZXJhdGlvbik7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLy8gUmVjbGFpbXMgZnJlZSBzbG90cyBiZXR3ZWVuIHZhbGlkIG93bmVycyBpbiBtX293bmVycy4KICAgIC8vIFRPRE8gZ2l2ZW4gdGhhdCBpdHMgY2FsbGVkIGFmdGVyIGVhY2ggcmVtb3ZhbCwgaXQgY291bGQgYmUgc2ltcGxpZmllZC4KICAgIGZ1bmN0aW9uIHJlb3JnYW5pemVPd25lcnMoKSBwcml2YXRlIHsKICAgICAgICB1aW50IGZyZWUgPSAxOwogICAgICAgIHdoaWxlIChmcmVlIDwgbV9udW1Pd25lcnMpCiAgICAgICAgewogICAgICAgICAgICAvLyBpdGVyYXRpbmcgdG8gdGhlIGZpcnN0IGZyZWUgc2xvdCBmcm9tIHRoZSBiZWdpbm5pbmcKICAgICAgICAgICAgd2hpbGUgKGZyZWUgPCBtX251bU93bmVycyAmJiBtX293bmVyc1tmcmVlXSAhPSAwKSBmcmVlKys7CgogICAgICAgICAgICAvLyBpdGVyYXRpbmcgdG8gdGhlIGZpcnN0IG9jY3VwaWVkIHNsb3QgZnJvbSB0aGUgZW5kCiAgICAgICAgICAgIHdoaWxlIChtX251bU93bmVycyA+IDEgJiYgbV9vd25lcnNbbV9udW1Pd25lcnNdID09IDApIG1fbnVtT3duZXJzLS07CgogICAgICAgICAgICAvLyBzd2FwLCBpZiBwb3NzaWJsZSwgc28gZnJlZSBzbG90IGlzIGxvY2F0ZWQgYXQgdGhlIGVuZCBhZnRlciB0aGUgc3dhcAogICAgICAgICAgICBpZiAoZnJlZSA8IG1fbnVtT3duZXJzICYmIG1fb3duZXJzW21fbnVtT3duZXJzXSAhPSAwICYmIG1fb3duZXJzW2ZyZWVdID09IDApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIC8vIG93bmVycyBiZXR3ZWVuIHN3YXBwZWQgc2xvdHMgc2hvdWxkJ3QgYmUgcmVudW1iZXJlZCAtIHRoYXQgc2F2ZXMgYSBsb3Qgb2YgZ2FzCiAgICAgICAgICAgICAgICBtX293bmVyc1tmcmVlXSA9IG1fb3duZXJzW21fbnVtT3duZXJzXTsKICAgICAgICAgICAgICAgIG1fb3duZXJJbmRleFttX293bmVyc1tmcmVlXV0gPSBmcmVlOwogICAgICAgICAgICAgICAgbV9vd25lcnNbbV9udW1Pd25lcnNdID0gMDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBjbGVhclBlbmRpbmcoKSBwcml2YXRlIG9ubHlvd25lciB7CiAgICAgICAgdWludCBsZW5ndGggPSBtX211bHRpT3duZWRQZW5kaW5nSW5kZXgubGVuZ3RoOwogICAgICAgIC8vIFRPRE8gYmxvY2sgZ2FzIGxpbWl0CiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHsKICAgICAgICAgICAgaWYgKG1fbXVsdGlPd25lZFBlbmRpbmdJbmRleFtpXSAhPSAwKQogICAgICAgICAgICAgICAgZGVsZXRlIG1fbXVsdGlPd25lZFBlbmRpbmdbbV9tdWx0aU93bmVkUGVuZGluZ0luZGV4W2ldXTsKICAgICAgICB9CiAgICAgICAgZGVsZXRlIG1fbXVsdGlPd25lZFBlbmRpbmdJbmRleDsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGVja093bmVySW5kZXgodWludCBvd25lckluZGV4KSBwcml2YXRlIHB1cmUgcmV0dXJucyAodWludCkgewogICAgICAgIGFzc2VydCgwICE9IG93bmVySW5kZXggJiYgb3duZXJJbmRleCA8PSBjX21heE93bmVycyk7CiAgICAgICAgcmV0dXJuIG93bmVySW5kZXg7CiAgICB9CgogICAgZnVuY3Rpb24gbWFrZU93bmVyQml0bWFwQml0KGFkZHJlc3Mgb3duZXIpIHByaXZhdGUgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIHVpbnQgb3duZXJJbmRleCA9IGNoZWNrT3duZXJJbmRleChtX293bmVySW5kZXhbb3duZXJdKTsKICAgICAgICByZXR1cm4gMiAqKiBvd25lckluZGV4OwogICAgfQoKICAgIGZ1bmN0aW9uIGlzT3BlcmF0aW9uQWN0aXZlKGJ5dGVzMzIgX29wZXJhdGlvbikgcHJpdmF0ZSBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIDAgIT0gbV9tdWx0aU93bmVkUGVuZGluZ1tfb3BlcmF0aW9uXS55ZXROZWVkZWQ7CiAgICB9CgoKICAgIGZ1bmN0aW9uIGFzc2VydE93bmVyc0FyZUNvbnNpc3RlbnQoKSBwcml2YXRlIGNvbnN0YW50IHsKICAgICAgICBhc3NlcnQobV9udW1Pd25lcnMgPiAwKTsKICAgICAgICBhc3NlcnQobV9udW1Pd25lcnMgPD0gY19tYXhPd25lcnMpOwogICAgICAgIGFzc2VydChtX293bmVyc1swXSA9PSAwKTsKICAgICAgICBhc3NlcnQoMCAhPSBtX211bHRpT3duZWRSZXF1aXJlZCAmJiBtX211bHRpT3duZWRSZXF1aXJlZCA8PSBtX251bU93bmVycyk7CiAgICB9CgogICAgZnVuY3Rpb24gYXNzZXJ0T3BlcmF0aW9uSXNDb25zaXN0ZW50KGJ5dGVzMzIgX29wZXJhdGlvbikgcHJpdmF0ZSBjb25zdGFudCB7CiAgICAgICAgdmFyIHBlbmRpbmcgPSBtX211bHRpT3duZWRQZW5kaW5nW19vcGVyYXRpb25dOwogICAgICAgIGFzc2VydCgwICE9IHBlbmRpbmcueWV0TmVlZGVkKTsKICAgICAgICBhc3NlcnQobV9tdWx0aU93bmVkUGVuZGluZ0luZGV4W3BlbmRpbmcuaW5kZXhdID09IF9vcGVyYXRpb24pOwogICAgICAgIGFzc2VydChwZW5kaW5nLnlldE5lZWRlZCA8PSBtX211bHRpT3duZWRSZXF1aXJlZCk7CiAgICB9CgoKICAgCS8vIEZJRUxEUwoKICAgIHVpbnQgY29uc3RhbnQgY19tYXhPd25lcnMgPSAyNTA7CgogICAgLy8gdGhlIG51bWJlciBvZiBvd25lcnMgdGhhdCBtdXN0IGNvbmZpcm0gdGhlIHNhbWUgb3BlcmF0aW9uIGJlZm9yZSBpdCBpcyBydW4uCiAgICB1aW50IHB1YmxpYyBtX211bHRpT3duZWRSZXF1aXJlZDsKCgogICAgLy8gcG9pbnRlciB1c2VkIHRvIGZpbmQgYSBmcmVlIHNsb3QgaW4gbV9vd25lcnMKICAgIHVpbnQgcHVibGljIG1fbnVtT3duZXJzOwoKICAgIC8vIGxpc3Qgb2Ygb3duZXJzIChhZGRyZXNzZXMpLAogICAgLy8gc2xvdCAwIGlzIHVudXNlZCBzbyB0aGVyZSBhcmUgbm8gb3duZXIgd2hpY2ggaW5kZXggaXMgMC4KICAgIC8vIFRPRE8gY291bGQgd2Ugc2F2ZSBzcGFjZSBhdCB0aGUgZW5kIG9mIHRoZSBhcnJheSBmb3IgdGhlIGNvbW1vbiBjYXNlIG9mIDwxMCBvd25lcnM/IGFuZCBzaG91bGQgd2U/CiAgICBhZGRyZXNzWzI1Nl0gaW50ZXJuYWwgbV9vd25lcnM7CgogICAgLy8gaW5kZXggb24gdGhlIGxpc3Qgb2Ygb3duZXJzIHRvIGFsbG93IHJldmVyc2UgbG9va3VwOiBvd25lciBhZGRyZXNzID0+IGluZGV4IGluIG1fb3duZXJzCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgaW50ZXJuYWwgbV9vd25lckluZGV4OwoKCiAgICAvLyB0aGUgb25nb2luZyBvcGVyYXRpb25zLgogICAgbWFwcGluZyhieXRlczMyID0+IE11bHRpT3duZWRPcGVyYXRpb25QZW5kaW5nU3RhdGUpIGludGVybmFsIG1fbXVsdGlPd25lZFBlbmRpbmc7CiAgICBieXRlczMyW10gaW50ZXJuYWwgbV9tdWx0aU93bmVkUGVuZGluZ0luZGV4Owp9Cgpjb250cmFjdCBFUkMyMEJhc2ljIHsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cgp9Cgpjb250cmFjdCBNdWx0aW93bmVkQ29udHJvbGxlZCBpcyBtdWx0aW93bmVkIHsKCiAgICBldmVudCBDb250cm9sbGVyU2V0KGFkZHJlc3MgY29udHJvbGxlcik7CiAgICBldmVudCBDb250cm9sbGVyUmV0aXJlZChhZGRyZXNzIHdhcyk7CiAgICBldmVudCBDb250cm9sbGVyUmV0aXJlZEZvcmV2ZXIoYWRkcmVzcyB3YXMpOwoKCiAgICBtb2RpZmllciBvbmx5Q29udHJvbGxlciB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG1fY29udHJvbGxlcik7CiAgICAgICAgXzsKICAgIH0KCgogICAgLy8gUFVCTElDIGludGVyZmFjZQoKICAgIGZ1bmN0aW9uIE11bHRpb3duZWRDb250cm9sbGVkKGFkZHJlc3NbXSBfb3duZXJzLCB1aW50IF9zaWduYXR1cmVzUmVxdWlyZWQsIGFkZHJlc3MgX2NvbnRyb2xsZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgbXVsdGlvd25lZChfb3duZXJzLCBfc2lnbmF0dXJlc1JlcXVpcmVkKQogICAgewogICAgICAgIG1fY29udHJvbGxlciA9IF9jb250cm9sbGVyOwogICAgICAgIENvbnRyb2xsZXJTZXQobV9jb250cm9sbGVyKTsKICAgIH0KCiAgICAvLy8gQGRldiBzZXRzIHRoZSBjb250cm9sbGVyCiAgICBmdW5jdGlvbiBzZXRDb250cm9sbGVyKGFkZHJlc3MgX2NvbnRyb2xsZXIpIGV4dGVybmFsIG9ubHltYW55b3duZXJzKGtlY2NhazI1Nihtc2cuZGF0YSkpIHsKICAgICAgICByZXF1aXJlKG1fYXR0YWNoaW5nX2VuYWJsZWQpOwogICAgICAgIG1fY29udHJvbGxlciA9IF9jb250cm9sbGVyOwogICAgICAgIENvbnRyb2xsZXJTZXQobV9jb250cm9sbGVyKTsKICAgIH0KCiAgICAvLy8gQGRldiBhYmlsaXR5IGZvciBjb250cm9sbGVyIHRvIHN0ZXAgZG93bgogICAgZnVuY3Rpb24gZGV0YWNoQ29udHJvbGxlcigpIGV4dGVybmFsIG9ubHlDb250cm9sbGVyIHsKICAgICAgICBhZGRyZXNzIHdhcyA9IG1fY29udHJvbGxlcjsKICAgICAgICBtX2NvbnRyb2xsZXIgPSBhZGRyZXNzKDApOwogICAgICAgIENvbnRyb2xsZXJSZXRpcmVkKHdhcyk7CiAgICB9CgogICAgLy8vIEBkZXYgYWJpbGl0eSBmb3IgY29udHJvbGxlciB0byBzdGVwIGRvd24gYW5kIG1ha2UgdGhpcyBjb250cmFjdCBjb21wbGV0ZWx5IGF1dG9tYXRpYyAod2l0aG91dCB0aGlyZC1wYXJ0eSBjb250cm9sKQogICAgZnVuY3Rpb24gZGV0YWNoQ29udHJvbGxlckZvcmV2ZXIoKSBleHRlcm5hbCBvbmx5Q29udHJvbGxlciB7CiAgICAgICAgYXNzZXJ0KG1fYXR0YWNoaW5nX2VuYWJsZWQpOwogICAgICAgIGFkZHJlc3Mgd2FzID0gbV9jb250cm9sbGVyOwogICAgICAgIG1fY29udHJvbGxlciA9IGFkZHJlc3MoMCk7CiAgICAgICAgbV9hdHRhY2hpbmdfZW5hYmxlZCA9IGZhbHNlOwogICAgICAgIENvbnRyb2xsZXJSZXRpcmVkRm9yZXZlcih3YXMpOwogICAgfQoKCiAgICAvLyBGSUVMRFMKCiAgICAvLy8gQG5vdGljZSBhZGRyZXNzIG9mIGVudGl0eSBlbnRpdGxlZCB0byBtaW50IG5ldyB0b2tlbnMKICAgIGFkZHJlc3MgcHVibGljIG1fY29udHJvbGxlcjsKCiAgICBib29sIHB1YmxpYyBtX2F0dGFjaGluZ19lbmFibGVkID0gdHJ1ZTsKfQoKY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CgoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqLwogIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9Cgpjb250cmFjdCBNaW50YWJsZU11bHRpb3duZWRUb2tlbiBpcyBNaW50YWJsZVRva2VuLCBNdWx0aW93bmVkQ29udHJvbGxlZCwgU3RhbmRhcmRUb2tlbiB7CgogICAgLy8gUFVCTElDIGludGVyZmFjZQoKICAgIGZ1bmN0aW9uIE1pbnRhYmxlTXVsdGlvd25lZFRva2VuKGFkZHJlc3NbXSBfb3duZXJzLCB1aW50IF9zaWduYXR1cmVzUmVxdWlyZWQsIGFkZHJlc3MgX21pbnRlcikKICAgICAgICBwdWJsaWMKICAgICAgICBNdWx0aW93bmVkQ29udHJvbGxlZChfb3duZXJzLCBfc2lnbmF0dXJlc1JlcXVpcmVkLCBfbWludGVyKQogICAgewogICAgfQoKCiAgICAvLy8gQGRldiBtaW50cyBuZXcgdG9rZW5zCiAgICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyBvbmx5Q29udHJvbGxlciB7CiAgICAgICAgcmVxdWlyZShtX2V4dGVybmFsTWludGluZ0VuYWJsZWQpOwogICAgICAgIG1pbnRJbnRlcm5hbChfdG8sIF9hbW91bnQpOwogICAgfQoKICAgIC8vLyBAZGV2IGRpc2FibGVzIG1pbnQoKSwgaXJyZXZlcnNpYmxlIQogICAgZnVuY3Rpb24gZGlzYWJsZU1pbnRpbmcoKSBwdWJsaWMgb25seUNvbnRyb2xsZXIgewogICAgICAgIHJlcXVpcmUobV9leHRlcm5hbE1pbnRpbmdFbmFibGVkKTsKICAgICAgICBtX2V4dGVybmFsTWludGluZ0VuYWJsZWQgPSBmYWxzZTsKICAgIH0KCgogICAgLy8gSU5URVJOQUwgZnVuY3Rpb25zCgogICAgZnVuY3Rpb24gbWludEludGVybmFsKGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIGludGVybmFsIHsKICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfYW1vdW50KTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICAgICAgVHJhbnNmZXIoYWRkcmVzcygwKSwgX3RvLCBfYW1vdW50KTsKICAgICAgICBNaW50KF90bywgX2Ftb3VudCk7CiAgICB9CgoKICAgIC8vIEZJRUxEUwoKICAgIC8vLyBAbm90aWNlIGlmIHRoaXMgdHJ1ZSB0aGVuIHRva2VuIGlzIHN0aWxsIGV4dGVybmFsbHkgbWludGFibGUKICAgIGJvb2wgcHVibGljIG1fZXh0ZXJuYWxNaW50aW5nRW5hYmxlZCA9IHRydWU7Cn0KCmNvbnRyYWN0IENpcmN1bGF0aW5nVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiB7CgogICAgZXZlbnQgQ2lyY3VsYXRpb25FbmFibGVkKCk7CgogICAgbW9kaWZpZXIgcmVxdWlyZXNDaXJjdWxhdGlvbiB7CiAgICAgICAgcmVxdWlyZShtX2lzQ2lyY3VsYXRpbmcpOwogICAgICAgIF87CiAgICB9CgoKICAgIC8vIFBVQkxJQyBpbnRlcmZhY2UKCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXF1aXJlc0NpcmN1bGF0aW9uIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXF1aXJlc0NpcmN1bGF0aW9uIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJlcXVpcmVzQ2lyY3VsYXRpb24gcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci5hcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUpOwogICAgfQoKCiAgICAvLyBJTlRFUk5BTCBmdW5jdGlvbnMKCiAgICBmdW5jdGlvbiBlbmFibGVDaXJjdWxhdGlvbigpIGludGVybmFsIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAobV9pc0NpcmN1bGF0aW5nKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIG1faXNDaXJjdWxhdGluZyA9IHRydWU7CiAgICAgICAgQ2lyY3VsYXRpb25FbmFibGVkKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgoKICAgIC8vIEZJRUxEUwoKICAgIC8vLyBAbm90aWNlIGFyZSB0aGUgY2lyY3VsYXRpb24gc3RhcnRlZD8KICAgIGJvb2wgcHVibGljIG1faXNDaXJjdWxhdGluZzsKfQoKY29udHJhY3QgU21hcnR6VG9rZW4gaXMgQ2lyY3VsYXRpbmdUb2tlbiwgTWludGFibGVNdWx0aW93bmVkVG9rZW4gewoKICAgIGV2ZW50IEJ1cm4oYWRkcmVzcyBpbmRleGVkIGZyb20sIHVpbnQyNTYgYW1vdW50KTsKCgogICAgLy8gUFVCTElDIEZVTkNUSU9OUwoKICAgIC8qKgogICAgICogQG5vdGljZSBDb25zdHJ1Y3RzIHRva2VuLgogICAgICoKICAgICAqIEBwYXJhbSBfaW5pdGlhbE93bmVycyBpbml0aWFsIG11bHRpLXNpZ25hdHVyZXMsIHNlZSBjb21tZW50IGJlbG93CiAgICAgKiBAcGFyYW0gX3NpZ25hdHVyZXNSZXF1aXJlZCBxdW9ydW0gb2YgbXVsdGktc2lnbmF0dXJlcwogICAgICoKICAgICAqIEluaXRpYWwgb3duZXJzIGhhdmUgcG93ZXIgb3ZlciB0aGUgdG9rZW4gY29udHJhY3Qgb25seSBkdXJpbmcgYm9vdHN0cmFwIHBoYXNlIChlYXJseSBpbnZlc3RtZW50cyBhbmQgdG9rZW4KICAgICAqIHNhbGVzKS4gQWZ0ZXIgZmluYWwgdG9rZW4gc2FsZSBhbnkgY29udHJvbCBvdmVyIHRoZSB0b2tlbiByZW1vdmVkIGJ5IGlzc3VpbmcgZGV0YWNoQ29udHJvbGxlckZvcmV2ZXIgY2FsbC4KICAgICAqIEZvciBsaWZlY3ljbGUgZXhhbXBsZSBwbGVhc2Ugc2VlIHRlc3QvU21hcnR6VG9rZW5UZXN0LmpzLCAndGVzdCBmdWxsIGxpZmVjeWNsZScuCiAgICAgKi8KICAgIGZ1bmN0aW9uIFNtYXJ0elRva2VuKGFkZHJlc3NbXSBfaW5pdGlhbE93bmVycywgdWludCBfc2lnbmF0dXJlc1JlcXVpcmVkKQogICAgICAgIHB1YmxpYwogICAgICAgIE1pbnRhYmxlTXVsdGlvd25lZFRva2VuKF9pbml0aWFsT3duZXJzLCBfc2lnbmF0dXJlc1JlcXVpcmVkLCBhZGRyZXNzKDApKQogICAgewogICAgfQoKICAgIC8qKgogICAgICogRnVuY3Rpb24gdG8gYnVybiBtc2cuc2VuZGVyJ3MgdG9rZW5zLgogICAgICoKICAgICAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJ1cm4KICAgICAqCiAgICAgKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAgICovCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBhZGRyZXNzIGZyb20gPSBtc2cuc2VuZGVyOwogICAgICAgIHJlcXVpcmUoX2Ftb3VudCA+IDApOwogICAgICAgIHJlcXVpcmUoX2Ftb3VudCA8PSBiYWxhbmNlc1tmcm9tXSk7CgogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuc3ViKF9hbW91bnQpOwogICAgICAgIGJhbGFuY2VzW2Zyb21dID0gYmFsYW5jZXNbZnJvbV0uc3ViKF9hbW91bnQpOwogICAgICAgIEJ1cm4oZnJvbSwgX2Ftb3VudCk7CiAgICAgICAgVHJhbnNmZXIoZnJvbSwgYWRkcmVzcygwKSwgX2Ftb3VudCk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQG5vdGljZSBBcHByb3ZlcyBzcGVuZGluZyB0b2tlbnMgYW5kIGltbWVkaWF0ZWx5IHRyaWdnZXJzIHRva2VuIHJlY2lwaWVudCBsb2dpYy4KICAgICAqCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgY29udHJhY3Qgd2hpY2ggc3VwcG9ydHMgSUFwcHJvdmFsUmVjaXBpZW50IGFuZCBhbGxvd2VkIHRvIHJlY2VpdmUgdG9rZW5zCiAgICAgKiBAcGFyYW0gX3ZhbHVlIGFtb3VudCBvZiB0b2tlbnMgYXBwcm92ZWQgdG8gYmUgc3BlbnQKICAgICAqIEBwYXJhbSBfZXh0cmFEYXRhIGFueSBleHRyYSBkYXRhIHdoaWNoIHRvIGJlIHByb3ZpZGVkIHRvIHRoZSBfc3BlbmRlcgogICAgICoKICAgICAqIEJ5IGludm9raW5nIHRoaXMgdXRpbGl0eSBmdW5jdGlvbiB0b2tlbiBob2xkZXIgY291bGQgZG8gdHdvIHRoaW5ncyBpbiBvbmUgdHJhbnNhY3Rpb246IGFwcHJvdmUgc3BlbmRpbmcgaGlzCiAgICAgKiB0b2tlbnMgYW5kIGV4ZWN1dGUgc29tZSBleHRlcm5hbCBjb250cmFjdCB3aGljaCBzcGVuZHMgdGhlbSBvbiB0b2tlbiBob2xkZXIncyBiZWhhbGYuCiAgICAgKiBJdCBjYW4ndCBiZSBrbm93biBpZiBfc3BlbmRlcidzIGludm9jYXRpb24gc3VjY2VlZCBvciBub3QuCiAgICAgKiBUaGlzIGZ1bmN0aW9uIHdpbGwgdGhyb3cgaWYgYXBwcm92YWwgZmFpbGVkLgogICAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlQW5kQ2FsbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2V4dHJhRGF0YSkgcHVibGljIHsKICAgICAgICByZXF1aXJlKGFwcHJvdmUoX3NwZW5kZXIsIF92YWx1ZSkpOwogICAgICAgIElBcHByb3ZhbFJlY2lwaWVudChfc3BlbmRlcikucmVjZWl2ZUFwcHJvdmFsKG1zZy5zZW5kZXIsIF92YWx1ZSwgX2V4dHJhRGF0YSk7CiAgICB9CgoKICAgIC8vIEFETUlOSVNUUkFUSVZFIEZVTkNUSU9OUwoKICAgIGZ1bmN0aW9uIHN0YXJ0Q2lyY3VsYXRpb24oKSBleHRlcm5hbCBvbmx5Q29udHJvbGxlciByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIGVuYWJsZUNpcmN1bGF0aW9uKCk7CiAgICB9CgoKICAgIC8vIENPTlNUQU5UUwoKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJTbWFydHogdG9rZW4iOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiU01SIjsKICAgIHVpbnQ4IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4Owp9'.
	

]
