Class {
	#name : #SRTdBF98dF5DAd9077f457e1dcf85Aa9420BcA8B761,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTdBF98dF5DAd9077f457e1dcf85Aa9420BcA8B761 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgoKLy9JbnRlcmZhY2VzCgovLyBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKaW50ZXJmYWNlIEVSQzIwIHsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludCBfdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50IF92YWx1ZSk7CgogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCk7CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50IGJhbGFuY2UpOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50IHJlbWFpbmluZyk7Cn0KCmNvbnRyYWN0IFVuaWxvdFRva2VuIGlzIEVSQzIwIHsKICAgIHN0cnVjdCBUb2tlblN0YWdlIHsKICAgICAgICBzdHJpbmcgbmFtZTsKICAgICAgICB1aW50IG51bUNvaW5zU3RhcnQ7CiAgICAgICAgdWludCBjb2luc0F2YWlsYWJsZTsKICAgICAgICB1aW50IGJvbnVzOwogICAgICAgIHVpbnQgc3RhcnRzQXQ7CiAgICAgICAgdWludCBlbmRzQXQ7CiAgICAgICAgdWludCBiYWxhbmNlOyAvL0Ftb3VudCBvZiBldGhlciBzZW50IGR1cmluZyB0aGlzIHN0YWdlCiAgICB9CgogICAgLy9Ub2tlbiBzeW1ib2wKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIlVOSVQiOwogICAgLy9Ub2tlbiBuYW1lCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiVW5pbG90IHRva2VuIjsKICAgIC8vSXQgY2FuIGJlIHJlZWVlYWx5IHNtYWxsCiAgICB1aW50OCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKCiAgICAvL1RoaXMgb25lIGR1cGxpY2F0ZXMgdGhlIGFib3ZlIGJ1dCB3aWxsIGhhdmUgdG8gdXNlIGl0IGJlY2F1c2Ugb2YKICAgIC8vc29saWRpdHkgYnVnIHdpdGggcG93ZXIgb3BlcmF0aW9uCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBhY2N1cmFjeSA9IDEwMDAwMDAwMDAwMDAwMDAwMDA7CgogICAgLy81MDAgbWxuIHRva2VucwogICAgdWludDI1NiBpbnRlcm5hbCBfdG90YWxTdXBwbHkgPSA1MDAgKiAoMTAqKjYpICogYWNjdXJhY3k7CgogICAgLy9QdWJsaWMgaW52ZXN0b3IgY2FuIGJ1eSB0b2tlbnMgZm9yIDMwIGV0aGVyIGF0IG1heGltdW0KICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IHNpbmdsZUludmVzdG9yQ2FwID0gMzAgZXRoZXI7IC8vMzAgZXRoZXIKCiAgICAvL0Rpc3RyaWJ1dGlvbiB1bml0cwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgRFNUX0lDTyAgICAgPSA2MjsgLy82MiUKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IERTVF9SRVNFUlZFID0gMTA7IC8vMTAlCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBEU1RfQk9VTlRZICA9IDM7ICAvLzMlCiAgICAvL1JlZmVycmFsIGFuZCBCb251cyBQcm9ncmFtCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBEU1RfUl9OX0JfUFJPR1JBTSA9IDEwOyAvLzEwJQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgRFNUX0FEVklTRVJTICAgICAgPSA1OyAgLy81JQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgRFNUX1RFQU0gICAgICAgICAgPSAxMDsgLy8xMCUKCiAgICAvL1JlZmVycmFsIEJvbnVzZXMKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFJFRkVSUkFMX0JPTlVTX0xFVkVMMSA9IDU7IC8vNSUKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFJFRkVSUkFMX0JPTlVTX0xFVkVMMiA9IDQ7IC8vNCUKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFJFRkVSUkFMX0JPTlVTX0xFVkVMMyA9IDM7IC8vMyUKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFJFRkVSUkFMX0JPTlVTX0xFVkVMNCA9IDI7IC8vMiUKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFJFRkVSUkFMX0JPTlVTX0xFVkVMNSA9IDE7IC8vMSUKCiAgICAvL1Rva2VuIGFtb3VudAogICAgLy8yNSBtbG4gdG9rZW5zCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBUT0tFTl9BTU9VTlRfUFJFX0lDTyA9IDI1ICogKDEwKio2KSAqIGFjY3VyYWN5OwogICAgLy81IG1sbiB0b2tlbnMKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFRPS0VOX0FNT1VOVF9JQ09fU1RBR0UxX1BSRV9TQUxFMSA9IDUgKiAoMTAqKjYpICogYWNjdXJhY3k7CiAgICAvLzUgbWxuIHRva2VucwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgVE9LRU5fQU1PVU5UX0lDT19TVEFHRTFfUFJFX1NBTEUyID0gNSAqICgxMCoqNikgKiBhY2N1cmFjeTsKICAgIC8vNSBtbG4gdG9rZW5zCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBUT0tFTl9BTU9VTlRfSUNPX1NUQUdFMV9QUkVfU0FMRTMgPSA1ICogKDEwKio2KSAqIGFjY3VyYWN5OwogICAgLy81IG1sbiB0b2tlbnMKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFRPS0VOX0FNT1VOVF9JQ09fU1RBR0UxX1BSRV9TQUxFNCA9IDUgKiAoMTAqKjYpICogYWNjdXJhY3k7CiAgICAvLzEyMi41IG1sbiB0b2tlbnMKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFRPS0VOX0FNT1VOVF9JQ09fU1RBR0UxX1BSRV9TQUxFNSA9IDEyMjUgKiAoMTAqKjUpICogYWNjdXJhY3k7CiAgICAvLzI2NSBtbG4gdG9rZW5zCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBUT0tFTl9BTU9VTlRfSUNPX1NUQUdFMiA9IDE0MjUgKiAoMTAqKjUpICogYWNjdXJhY3k7CgogICAgdWludCBwdWJsaWMgY29uc3RhbnQgQk9OVVNfUFJFX0lDTyA9IDQwOyAvLzQwJQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgQk9OVVNfSUNPX1NUQUdFMV9QUkVfU0FMRTEgPSAzNTsgLy8zNSUKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IEJPTlVTX0lDT19TVEFHRTFfUFJFX1NBTEUyID0gMzA7IC8vMzAlCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBCT05VU19JQ09fU1RBR0UxX1BSRV9TQUxFMyA9IDI1OyAvLzI1JQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgQk9OVVNfSUNPX1NUQUdFMV9QUkVfU0FMRTQgPSAyMDsgLy8yMCUKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IEJPTlVTX0lDT19TVEFHRTFfUFJFX1NBTEU1ID0gMDsgLy8wJQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgQk9OVVNfSUNPX1NUQUdFMiA9IDA7IC8vTm8gYm9udXMKCiAgICAvL1Rva2VuIFByaWNlIG9uIENvaW4gT2ZmZXIKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IHByaWNlID0gNzkgc3phYm87IC8vMC4wMDAwNzkgRVRICgogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgQURWSVNPUlNfV0FMTEVUID0gMHg3NzY2MDc5NUJEMzYxQ2Q0M2MzNjI3ZUFkYWQ0NGREYzIwMjZhRDE3OwogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgUkVTRVJWRV9XQUxMRVQgPSAweDczMUI0Nzg0NzM1MmZBMmNGZjgzRDUyNTFGRDZhNTI2NmY5MDg3OGQ7CiAgICBhZGRyZXNzIHB1YmxpYyBjb25zdGFudCBCT1VOVFlfV0FMTEVUID0gMHg3OTRFRjljNjgwYkREMGJFZjQ4QmVmNDZiQTY4NDcxZTQ0OUQ2N0ZiOwogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgUl9OX0RfV0FMTEVUID0gMHg3OTRFRjljNjgwYkREMGJFZjQ4QmVmNDZiQTY4NDcxZTQ0OUQ2N0ZiOwogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgU1RPUkFHRV9XQUxMRVQgPSAweEUyQThGMTQ3ZmM4MDg3MzhDYWIxNTJiMDFDNzI0NUYzODZmRDhkODk7CgogICAgLy8gT3duZXIgb2YgdGhpcyBjb250cmFjdAogICAgYWRkcmVzcyBwdWJsaWMgYWRtaW5pc3RyYXRvcjsKCiAgICAvLyBCYWxhbmNlcyBmb3IgZWFjaCBhY2NvdW50CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogICAgLy8gT3duZXIgb2YgYWNjb3VudCBhcHByb3ZlcyB0aGUgdHJhbnNmZXIgb2YgYW4gYW1vdW50IHRvIGFub3RoZXIgYWNjb3VudAogICAgbWFwcGluZyhhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CgogICAgLy9Nb3N0bHkgbmVlZGVkIGZvciBpbnRlcm5hbCB1c2UKICAgIHVpbnQyNTYgaW50ZXJuYWwgdG90YWxDb2luc0F2YWlsYWJsZTsKCiAgICAvL0FsbCB0b2tlbiBzdGFnZXMuIFRvdGFsIDYgc3RhZ2VzCiAgICBUb2tlblN0YWdlWzddIHN0YWdlczsKCiAgICAvL0luZGV4IG9mIGN1cnJlbnQgc3RhZ2UgaW4gc3RhZ2UgYXJyYXkKICAgIHVpbnQgY3VycmVudFN0YWdlOwoKICAgIC8vRW5hYmxlcyBvciBkaXNhYmxlcyBkZWJ1ZyBtb2RlLiBEZWJ1ZyBtb2RlIGlzIHNldCBvbmx5IGluIGNvbnN0cnVjdG9yLgogICAgYm9vbCBpc0RlYnVnID0gZmFsc2U7CgogICAgZXZlbnQgU3RhZ2VVcGRhdGVkKHN0cmluZyBmcm9tLCBzdHJpbmcgdG8pOwoKICAgIC8vIEZ1bmN0aW9ucyB3aXRoIHRoaXMgbW9kaWZpZXIgY2FuIG9ubHkgYmUgZXhlY3V0ZWQgYnkgdGhlIG93bmVyCiAgICBtb2RpZmllciBvbmx5QWRtaW5pc3RyYXRvcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYWRtaW5pc3RyYXRvcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBub3RBZG1pbmlzdHJhdG9yKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciAhPSBhZG1pbmlzdHJhdG9yKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlEdXJpbmdJQ08oKSB7CiAgICAgICAgcmVxdWlyZShjdXJyZW50U3RhZ2UgPCBzdGFnZXMubGVuZ3RoKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlBZnRlcklDTygpewogICAgICAgIHJlcXVpcmUoY3VycmVudFN0YWdlID49IHN0YWdlcy5sZW5ndGgpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgbWVldFRoZUNhcCgpIHsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSBwcmljZSk7IC8vIEF0IGxlYXN0IG9uZSB0b2tlbgogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgaXNGcmVlemVkUmVzZXJ2ZShhZGRyZXNzIF9hZGRyZXNzKSB7CiAgICAgICAgcmVxdWlyZSggKCBfYWRkcmVzcyA9PSBSRVNFUlZFX1dBTExFVCApICYmIG5vdyA+IChzdGFnZXNbIChzdGFnZXMubGVuZ3RoIC0gMSkgXS5lbmRzQXQgKyAxODIgZGF5cykpOwogICAgICAgIF87CiAgICB9CgogICAgLy8gQ29uc3RydWN0b3IKICAgIGZ1bmN0aW9uIFVuaWxvdFRva2VuKCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICBhZG1pbmlzdHJhdG9yID0gbXNnLnNlbmRlcjsKICAgICAgICB0b3RhbENvaW5zQXZhaWxhYmxlID0gX3RvdGFsU3VwcGx5OwogICAgICAgIC8vV2FzIGFzIGZuIHBhcmFtZXRlciBmb3IgZGVidWdnaW5nCiAgICAgICAgaXNEZWJ1ZyA9IGZhbHNlOwoKICAgICAgICBfc2V0dXBTdGFnZXMoKTsKICAgICAgICBfcHJvY2VlZFN0YWdlKCk7CiAgICB9CgogICAgZnVuY3Rpb24gcHJlYWxvY2F0ZUNvaW5zKCkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5QWRtaW5pc3RyYXRvcgogICAgewogICAgICAgIHRvdGFsQ29pbnNBdmFpbGFibGUgLT0gYmFsYW5jZXNbQURWSVNPUlNfV0FMTEVUXSArPSAoICggX3RvdGFsU3VwcGx5ICogRFNUX0FEVklTRVJTICkgLyAxMDAgKTsKICAgICAgICB0b3RhbENvaW5zQXZhaWxhYmxlIC09IGJhbGFuY2VzW1JFU0VSVkVfV0FMTEVUXSArPSAoICggX3RvdGFsU3VwcGx5ICogRFNUX1JFU0VSVkUgKSAvIDEwMCApOwoKICAgICAgICBhZGRyZXNzWzddIG1lbW9yeSB0ZWFtV2FsbGV0cyA9IGdldFRlYW1XYWxsZXRzKCk7CiAgICAgICAgdWludCB0ZWFtU3VwcGx5ID0gKCAoIF90b3RhbFN1cHBseSAqIERTVF9URUFNICkgLyAxMDAgKTsKICAgICAgICB1aW50IG1lbWJlckFtb3VudCA9IHRlYW1TdXBwbHkgLyB0ZWFtV2FsbGV0cy5sZW5ndGg7CgogICAgICAgIGZvcih1aW50IGkgPSAwOyBpIDwgdGVhbVdhbGxldHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKCBpID09ICggdGVhbVdhbGxldHMubGVuZ3RoIC0gMSApICkgewogICAgICAgICAgICAgICAgbWVtYmVyQW1vdW50ID0gdGVhbVN1cHBseTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYmFsYW5jZXNbdGVhbVdhbGxldHNbaV1dICs9IG1lbWJlckFtb3VudDsKICAgICAgICAgICAgdGVhbVN1cHBseSAtPSBtZW1iZXJBbW91bnQ7CiAgICAgICAgICAgIHRvdGFsQ29pbnNBdmFpbGFibGUgLT0gbWVtYmVyQW1vdW50OwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBnZXRUZWFtV2FsbGV0cygpCiAgICAgICAgcHVibGljCiAgICAgICAgcHVyZQogICAgICAgIHJldHVybnMgKGFkZHJlc3NbN10gbWVtb3J5IHJlc3VsdCkKICAgIHsKICAgICAgICByZXN1bHRbMF0gPSAweDQwZTNEOGZGYzQ2ZDczQWI1REY4NzhDNzUxRDgxM2E0Y0I3QjM4OEQ7CiAgICAgICAgcmVzdWx0WzFdID0gMHg1RTA2NWE4MGY2NjM1QjZhNDYzMjNlMzM4MzA1N2NFNjA1MWFBY0EwOwogICAgICAgIHJlc3VsdFsyXSA9IDB4MGNGMzU4NUZiQUIyYTEyOTlGODM0N2E5Qjg3Q0Y3QjRmY2RDRTU5OTsKICAgICAgICByZXN1bHRbM10gPSAweDVmRGQzQkE1QjZGZjM0OWQzMWVCMGE3MkE5NTNFNDU0Qzk5NDk0YUM7CiAgICAgICAgcmVzdWx0WzRdID0gMHhDOWJlOTgxOGVFMUIyY0NmMkU0ZjY2OWQyNGVCMDc5ODM5MEZmYjU0OwogICAgICAgIHJlc3VsdFs1XSA9IDB4Nzc2NjA3OTVCRDM2MUNkNDNjMzYyN2VBZGFkNDRkRGMyMDI2YUQxNzsKICAgICAgICByZXN1bHRbNl0gPSAweGQxMzI4OTIwMzg4OWJEODk4ZDQ5ZTMxYTE1MDAzODg0NDFDMDM2NjM7CiAgICB9CgogICAgZnVuY3Rpb24gX3NldHVwU3RhZ2VzKCkKICAgICAgICBpbnRlcm5hbAogICAgewogICAgICAgIC8vUHJlc2FsZSBzdGFnZQogICAgICAgIHN0YWdlc1swXS5uYW1lID0gJ1ByZXNhbGUgc3RhZ2UnOwogICAgICAgIHN0YWdlc1swXS5udW1Db2luc1N0YXJ0ID0gdG90YWxDb2luc0F2YWlsYWJsZTsKICAgICAgICBzdGFnZXNbMF0uY29pbnNBdmFpbGFibGUgPSBUT0tFTl9BTU9VTlRfUFJFX0lDTzsKICAgICAgICBzdGFnZXNbMF0uYm9udXMgPSBCT05VU19QUkVfSUNPOwoKICAgICAgICBpZiAoaXNEZWJ1ZykgewogICAgICAgICAgICBzdGFnZXNbMF0uc3RhcnRzQXQgPSBub3c7CiAgICAgICAgICAgIHN0YWdlc1swXS5lbmRzQXQgPSBzdGFnZXNbMF0uc3RhcnRzQXQgKyAzMCBzZWNvbmRzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0YWdlc1swXS5zdGFydHNBdCA9IDE1MTU2MTA4MDA7IC8vMTB0aCBvZiBKYW51YXJ5IDIwMTggYXQgMTk6MDBVVEMKICAgICAgICAgICAgc3RhZ2VzWzBdLmVuZHNBdCA9IDE1MTg4OTQwMDA7IC8vMTd0aCBvZiBGZWJydWFyeSAyMDE4IGF0IDE5OjAwVVRDCiAgICAgICAgfQoKICAgICAgICAvL0lDTyBTdGFnZSAxIHByZS1zYWxlIDEKICAgICAgICBzdGFnZXNbMV0ubmFtZSA9ICdJQ08gU3RhZ2UgMSBwcmUtc2FsZSAxJzsKICAgICAgICBzdGFnZXNbMV0uY29pbnNBdmFpbGFibGUgPSBUT0tFTl9BTU9VTlRfSUNPX1NUQUdFMV9QUkVfU0FMRTE7CiAgICAgICAgc3RhZ2VzWzFdLmJvbnVzID0gQk9OVVNfSUNPX1NUQUdFMV9QUkVfU0FMRTE7CgogICAgICAgIGlmIChpc0RlYnVnKSB7CiAgICAgICAgICAgIHN0YWdlc1sxXS5zdGFydHNBdCA9IHN0YWdlc1swXS5lbmRzQXQ7CiAgICAgICAgICAgIHN0YWdlc1sxXS5lbmRzQXQgPSBzdGFnZXNbMV0uc3RhcnRzQXQgKyAzMCBzZWNvbmRzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0YWdlc1sxXS5zdGFydHNBdCA9IDE1MTkzMjYwMDA7IC8vMjJ0aCBvZiBGZWJydWFyeSAyMDE4IGF0IDE5OjAwVVRDCiAgICAgICAgICAgIHN0YWdlc1sxXS5lbmRzQXQgPSAxNTIxNzQ1MjAwOyAvLzIydGggb2YgTWFyY2ggMjAxOCBhdCAxOTowMFVUQwogICAgICAgIH0KCiAgICAgICAgLy9JQ08gU3RhZ2UgMSBwcmUtc2FsZSAyCiAgICAgICAgc3RhZ2VzWzJdLm5hbWUgPSAnSUNPIFN0YWdlIDEgcHJlLXNhbGUgMic7CiAgICAgICAgc3RhZ2VzWzJdLmNvaW5zQXZhaWxhYmxlID0gVE9LRU5fQU1PVU5UX0lDT19TVEFHRTFfUFJFX1NBTEUyOwogICAgICAgIHN0YWdlc1syXS5ib251cyA9IEJPTlVTX0lDT19TVEFHRTFfUFJFX1NBTEUyOwoKICAgICAgICBzdGFnZXNbMl0uc3RhcnRzQXQgPSBzdGFnZXNbMV0uc3RhcnRzQXQ7CiAgICAgICAgc3RhZ2VzWzJdLmVuZHNBdCA9IHN0YWdlc1sxXS5lbmRzQXQ7CgogICAgICAgIC8vSUNPIFN0YWdlIDEgcHJlLXNhbGUgMwogICAgICAgIHN0YWdlc1szXS5uYW1lID0gJ0lDTyBTdGFnZSAxIHByZS1zYWxlIDMnOwogICAgICAgIHN0YWdlc1szXS5jb2luc0F2YWlsYWJsZSA9IFRPS0VOX0FNT1VOVF9JQ09fU1RBR0UxX1BSRV9TQUxFMzsKICAgICAgICBzdGFnZXNbM10uYm9udXMgPSBCT05VU19JQ09fU1RBR0UxX1BSRV9TQUxFMzsKCiAgICAgICAgc3RhZ2VzWzNdLnN0YXJ0c0F0ID0gc3RhZ2VzWzFdLnN0YXJ0c0F0OwogICAgICAgIHN0YWdlc1szXS5lbmRzQXQgPSBzdGFnZXNbMV0uZW5kc0F0OwoKICAgICAgICAvL0lDTyBTdGFnZSAxIHByZS1zYWxlIDQKICAgICAgICBzdGFnZXNbNF0ubmFtZSA9ICdJQ08gU3RhZ2UgMSBwcmUtc2FsZSA0JzsKICAgICAgICBzdGFnZXNbNF0uY29pbnNBdmFpbGFibGUgPSBUT0tFTl9BTU9VTlRfSUNPX1NUQUdFMV9QUkVfU0FMRTQ7CiAgICAgICAgc3RhZ2VzWzRdLmJvbnVzID0gQk9OVVNfSUNPX1NUQUdFMV9QUkVfU0FMRTQ7CgogICAgICAgIHN0YWdlc1s0XS5zdGFydHNBdCA9IHN0YWdlc1sxXS5zdGFydHNBdDsKICAgICAgICBzdGFnZXNbNF0uZW5kc0F0ID0gc3RhZ2VzWzFdLmVuZHNBdDsKCiAgICAgICAgLy9JQ08gU3RhZ2UgMSBwcmUtc2FsZSA1CiAgICAgICAgc3RhZ2VzWzVdLm5hbWUgPSAnSUNPIFN0YWdlIDEgcHJlLXNhbGUgNSc7CiAgICAgICAgc3RhZ2VzWzVdLmNvaW5zQXZhaWxhYmxlID0gVE9LRU5fQU1PVU5UX0lDT19TVEFHRTFfUFJFX1NBTEU1OwogICAgICAgIHN0YWdlc1s1XS5ib251cyA9IEJPTlVTX0lDT19TVEFHRTFfUFJFX1NBTEU1OwoKICAgICAgICBzdGFnZXNbNV0uc3RhcnRzQXQgPSBzdGFnZXNbMV0uc3RhcnRzQXQ7CiAgICAgICAgc3RhZ2VzWzVdLmVuZHNBdCA9IHN0YWdlc1sxXS5lbmRzQXQ7CgogICAgICAgIC8vSUNPIFN0YWdlIDIKICAgICAgICBzdGFnZXNbNl0ubmFtZSA9ICdJQ08gU3RhZ2UgMic7CiAgICAgICAgc3RhZ2VzWzZdLmNvaW5zQXZhaWxhYmxlID0gVE9LRU5fQU1PVU5UX0lDT19TVEFHRTI7CiAgICAgICAgc3RhZ2VzWzZdLmJvbnVzID0gQk9OVVNfSUNPX1NUQUdFMjsKCiAgICAgICAgaWYgKGlzRGVidWcpIHsKICAgICAgICAgICAgc3RhZ2VzWzZdLnN0YXJ0c0F0ID0gc3RhZ2VzWzVdLmVuZHNBdDsKICAgICAgICAgICAgc3RhZ2VzWzZdLmVuZHNBdCA9IHN0YWdlc1s2XS5zdGFydHNBdCArIDMwIHNlY29uZHM7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RhZ2VzWzZdLnN0YXJ0c0F0ID0gMTUyNDI1MDgwMDsgLy8yMHRoIG9mIEFwcmlsIDIwMTggYXQgMTk6MDBVVEMKICAgICAgICAgICAgc3RhZ2VzWzZdLmVuZHNBdCA9IDE1MjY4NDI4MDA7IC8vMjB0aCBvZiBNYXkgMjAxOCBhdCAxOTowMFVUQwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBfcHJvY2VlZFN0YWdlKCkKICAgICAgICBpbnRlcm5hbAogICAgewogICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICAgIGlmICggY3VycmVudFN0YWdlIDwgc3RhZ2VzLmxlbmd0aAogICAgICAgICAgICAmJiAobm93ID49IHN0YWdlc1tjdXJyZW50U3RhZ2VdLmVuZHNBdCB8fCBnZXRBdmFpbGFibGVDb2luc0ZvckN1cnJlbnRTdGFnZSgpID09IDApICkgewogICAgICAgICAgICAgICAgY3VycmVudFN0YWdlKys7CiAgICAgICAgICAgICAgICB1aW50IHRvdGFsVG9rZW5zRm9yU2FsZSA9IFRPS0VOX0FNT1VOVF9QUkVfSUNPCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgVE9LRU5fQU1PVU5UX0lDT19TVEFHRTFfUFJFX1NBTEUxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgVE9LRU5fQU1PVU5UX0lDT19TVEFHRTFfUFJFX1NBTEUyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgVE9LRU5fQU1PVU5UX0lDT19TVEFHRTFfUFJFX1NBTEUzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgVE9LRU5fQU1PVU5UX0lDT19TVEFHRTFfUFJFX1NBTEU0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgVE9LRU5fQU1PVU5UX0lDT19TVEFHRTI7CgogICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGFnZSA+PSBzdGFnZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgLy9CdXJuaW5nIGFsbCB1bnNvbGQgdG9rZW5zIGFuZCBwcm9wb3J0aW9uYWxseSBvdGhlciBmb3IgZGVsaWdhdGlvbgogICAgICAgICAgICAgICAgICAgIF90b3RhbFN1cHBseSAtPSAoICggKCBzdGFnZXNbKHN0YWdlcy5sZW5ndGggLSAxKV0uY29pbnNBdmFpbGFibGUgKiBEU1RfQk9VTlRZICkgLyAxMDAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICggKCBzdGFnZXNbKHN0YWdlcy5sZW5ndGggLSAxKV0uY29pbnNBdmFpbGFibGUgKiBEU1RfUl9OX0JfUFJPR1JBTSApIC8gMTAwICkgKTsKCiAgICAgICAgICAgICAgICAgICAgYmFsYW5jZXNbQk9VTlRZX1dBTExFVF0gPSAoKCh0b3RhbFRva2Vuc0ZvclNhbGUgLSBzdGFnZXNbKHN0YWdlcy5sZW5ndGggLSAxKV0uY29pbnNBdmFpbGFibGUpICogRFNUX0JPVU5UWSkvMTAwKTsKICAgICAgICAgICAgICAgICAgICBiYWxhbmNlc1tSX05fRF9XQUxMRVRdID0gKCgodG90YWxUb2tlbnNGb3JTYWxlIC0gc3RhZ2VzWyhzdGFnZXMubGVuZ3RoIC0gMSldLmNvaW5zQXZhaWxhYmxlKSAqIERTVF9SX05fQl9QUk9HUkFNKS8xMDApOwoKICAgICAgICAgICAgICAgICAgICB0b3RhbENvaW5zQXZhaWxhYmxlID0gMDsKICAgICAgICAgICAgICAgICAgICBicmVhazsgLy9JQ08gZW5kZWQKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBzdGFnZXNbY3VycmVudFN0YWdlXS5udW1Db2luc1N0YXJ0ID0gdG90YWxDb2luc0F2YWlsYWJsZTsKCiAgICAgICAgICAgICAgICBpZiAoIGN1cnJlbnRTdGFnZSA+IDAgKSB7CiAgICAgICAgICAgICAgICAgICAgLy9Nb3ZlIGFsbCBsZWZ0IHRva2VucyB0byBsYXN0IHN0YWdlCiAgICAgICAgICAgICAgICAgICAgc3RhZ2VzWyhzdGFnZXMubGVuZ3RoIC0gMSldLmNvaW5zQXZhaWxhYmxlICs9IHN0YWdlc1sgKGN1cnJlbnRTdGFnZSAtIDEgKSBdLmNvaW5zQXZhaWxhYmxlOwogICAgICAgICAgICAgICAgICAgIFN0YWdlVXBkYXRlZChzdGFnZXNbY3VycmVudFN0YWdlIC0gMV0ubmFtZSwgc3RhZ2VzW2N1cnJlbnRTdGFnZV0ubmFtZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBnZXRUb3RhbENvaW5zQXZhaWxhYmxlKCkKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyh1aW50KQogICAgewogICAgICAgIHJldHVybiB0b3RhbENvaW5zQXZhaWxhYmxlOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEF2YWlsYWJsZUNvaW5zRm9yQ3VycmVudFN0YWdlKCkKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyh1aW50KQogICAgewogICAgICAgIFRva2VuU3RhZ2UgbWVtb3J5IHN0YWdlID0gc3RhZ2VzW2N1cnJlbnRTdGFnZV07CgogICAgICAgIHJldHVybiBzdGFnZS5jb2luc0F2YWlsYWJsZTsKICAgIH0KCiAgICAvLy0tLS0tLS0tLS0tLS0gRVJDMjAgbWV0aG9kcyAtLS0tLS0tLS0tLS0tLy8KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQyNTYpCiAgICB7CiAgICAgICAgcmV0dXJuIF90b3RhbFN1cHBseTsKICAgIH0KCgogICAgLy8gV2hhdCBpcyB0aGUgYmFsYW5jZSBvZiBhIHBhcnRpY3VsYXIgYWNjb3VudD8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkKICAgIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KCgogICAgLy8gVHJhbnNmZXIgdGhlIGJhbGFuY2UgZnJvbSBvd25lcidzIGFjY291bnQgdG8gYW5vdGhlciBhY2NvdW50CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlBZnRlcklDTwogICAgICAgIGlzRnJlZXplZFJlc2VydmUoX3RvKQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX2Ftb3VudAogICAgICAgICAgICAmJiBfYW1vdW50ID4gMAogICAgICAgICAgICAmJiBiYWxhbmNlc1tfdG9dICsgX2Ftb3VudCA+IGJhbGFuY2VzW190b10pIHsKICAgICAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gLT0gX2Ftb3VudDsKICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfYW1vdW50OwogICAgICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF9hbW91bnQpOwoKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KCgogICAgLy8gU2VuZCBfdmFsdWUgYW1vdW50IG9mIHRva2VucyBmcm9tIGFkZHJlc3MgX2Zyb20gdG8gYWRkcmVzcyBfdG8KICAgIC8vIFRoZSB0cmFuc2ZlckZyb20gbWV0aG9kIGlzIHVzZWQgZm9yIGEgd2l0aGRyYXcgd29ya2Zsb3csIGFsbG93aW5nIGNvbnRyYWN0cyB0byBzZW5kCiAgICAvLyB0b2tlbnMgb24geW91ciBiZWhhbGYsIGZvciBleGFtcGxlIHRvICJkZXBvc2l0IiB0byBhIGNvbnRyYWN0IGFkZHJlc3MgYW5kL29yIHRvIGNoYXJnZQogICAgLy8gZmVlcyBpbiBzdWItY3VycmVuY2llczsgdGhlIGNvbW1hbmQgc2hvdWxkIGZhaWwgdW5sZXNzIHRoZSBfZnJvbSBhY2NvdW50IGhhcwogICAgLy8gZGVsaWJlcmF0ZWx5IGF1dGhvcml6ZWQgdGhlIHNlbmRlciBvZiB0aGUgbWVzc2FnZSB2aWEgc29tZSBtZWNoYW5pc207IHdlIHByb3Bvc2UKICAgIC8vIHRoZXNlIHN0YW5kYXJkaXplZCBBUElzIGZvciBhcHByb3ZhbDoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbSgKICAgICAgICBhZGRyZXNzIF9mcm9tLAogICAgICAgIGFkZHJlc3MgX3RvLAogICAgICAgIHVpbnQyNTYgX2Ftb3VudAogICAgKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlBZnRlcklDTwogICAgICAgIGlzRnJlZXplZFJlc2VydmUoX2Zyb20pCiAgICAgICAgaXNGcmVlemVkUmVzZXJ2ZShfdG8pCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKQogICAgewogICAgICAgIGlmIChiYWxhbmNlc1tfZnJvbV0gPj0gX2Ftb3VudAogICAgICAgICAgICAmJiBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfYW1vdW50CiAgICAgICAgICAgICYmIF9hbW91bnQgPiAwCiAgICAgICAgICAgICYmIGJhbGFuY2VzW190b10gKyBfYW1vdW50ID4gYmFsYW5jZXNbX3RvXSkgewogICAgICAgICAgICBiYWxhbmNlc1tfZnJvbV0gLT0gX2Ftb3VudDsKICAgICAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gLT0gX2Ftb3VudDsKICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfYW1vdW50OwogICAgICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfYW1vdW50KTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KCgogICAgLy8gQWxsb3cgX3NwZW5kZXIgdG8gd2l0aGRyYXcgZnJvbSB5b3VyIGFjY291bnQsIG11bHRpcGxlIHRpbWVzLCB1cCB0byB0aGUgX3ZhbHVlIGFtb3VudC4KICAgIC8vIElmIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGFnYWluIGl0IG92ZXJ3cml0ZXMgdGhlIGN1cnJlbnQgYWxsb3dhbmNlIHdpdGggX3ZhbHVlLgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF9hbW91bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seUFmdGVySUNPCiAgICAgICAgaXNGcmVlemVkUmVzZXJ2ZShfc3BlbmRlcikKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfYW1vdW50OwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfYW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCgogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpCiAgICB7CiAgICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgICB9CiAgICAvLy0tLS0tLS0tLS0tLS0gRVJDMjAgTWV0aG9kcyBFTkQgLS0tLS0tLS0tLS0tLS8vCgogICAgLy9SZXR1cm5zIGJvbnVzIGZvciBjZXJ0YWluIGxldmVsIG9mIHJlZmVyZW5jZQogICAgZnVuY3Rpb24gY2FsY3VsYXRlUmVmZXJyYWxCb251cyh1aW50IGFtb3VudCwgdWludCBsZXZlbCkKICAgICAgICBwdWJsaWMKICAgICAgICBwdXJlCiAgICAgICAgcmV0dXJucyAodWludCBib251cykKICAgIHsKICAgICAgICBib251cyA9IDA7CgogICAgICAgIGlmICggbGV2ZWwgPT0gMSApIHsKICAgICAgICAgICAgYm9udXMgPSAoICggYW1vdW50ICogUkVGRVJSQUxfQk9OVVNfTEVWRUwxICkgLyAxMDAgKTsKICAgICAgICB9IGVsc2UgaWYgKGxldmVsID09IDIpIHsKICAgICAgICAgICAgYm9udXMgPSAoICggYW1vdW50ICogUkVGRVJSQUxfQk9OVVNfTEVWRUwyICkgLyAxMDAgKTsKICAgICAgICB9IGVsc2UgaWYgKGxldmVsID09IDMpIHsKICAgICAgICAgICAgYm9udXMgPSAoICggYW1vdW50ICogUkVGRVJSQUxfQk9OVVNfTEVWRUwzICkgLyAxMDAgKTsKICAgICAgICB9IGVsc2UgaWYgKGxldmVsID09IDQpIHsKICAgICAgICAgICAgYm9udXMgPSAoICggYW1vdW50ICogUkVGRVJSQUxfQk9OVVNfTEVWRUw0ICkgLyAxMDAgKTsKICAgICAgICB9IGVsc2UgaWYgKGxldmVsID09IDUpIHsKICAgICAgICAgICAgYm9udXMgPSAoICggYW1vdW50ICogUkVGRVJSQUxfQk9OVVNfTEVWRUw1ICkgLyAxMDAgKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gY2FsY3VsYXRlQm9udXModWludCBhbW91bnRPZlRva2VucykKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyAodWludCkKICAgIHsKICAgICAgICByZXR1cm4gKCAoIHN0YWdlc1tjdXJyZW50U3RhZ2VdLmJvbnVzICogYW1vdW50T2ZUb2tlbnMgKSAvIDEwMCApOwogICAgfQoKICAgIGV2ZW50IFRva2VuUHVyY2hhc2VkKHN0cmluZyBzdGFnZSwgdWludCB2YWx1ZVN1Ym1pdHRlZCwgdWludCB2YWx1ZVJlZnVuZGVkLCB1aW50IHRva2Vuc1B1cmNoYXNlZCk7CgogICAgZnVuY3Rpb24gKCkKICAgICAgICBwdWJsaWMKICAgICAgICBwYXlhYmxlCiAgICAgICAgbm90QWRtaW5pc3RyYXRvcgogICAgICAgIG9ubHlEdXJpbmdJQ08KICAgICAgICBtZWV0VGhlQ2FwCiAgICB7CiAgICAgICAgX3Byb2NlZWRTdGFnZSgpOwogICAgICAgIHJlcXVpcmUoY3VycmVudFN0YWdlIDwgc3RhZ2VzLmxlbmd0aCk7CiAgICAgICAgcmVxdWlyZShzdGFnZXNbY3VycmVudFN0YWdlXS5zdGFydHNBdCA8PSBub3cgJiYgbm93IDwgc3RhZ2VzW2N1cnJlbnRTdGFnZV0uZW5kc0F0KTsKICAgICAgICByZXF1aXJlKGdldEF2YWlsYWJsZUNvaW5zRm9yQ3VycmVudFN0YWdlKCkgPiAwKTsKCiAgICAgICAgdWludCByZXF1ZXN0ZWRBbW91bnRPZlRva2VucyA9ICggKCBtc2cudmFsdWUgKiBhY2N1cmFjeSApIC8gcHJpY2UgKTsKICAgICAgICB1aW50IGFtb3VudFRvQnV5ID0gcmVxdWVzdGVkQW1vdW50T2ZUb2tlbnM7CiAgICAgICAgdWludCByZWZ1bmQgPSAwOwoKICAgICAgICBpZiAoIGFtb3VudFRvQnV5ID4gZ2V0QXZhaWxhYmxlQ29pbnNGb3JDdXJyZW50U3RhZ2UoKSApIHsKICAgICAgICAgICAgYW1vdW50VG9CdXkgPSBnZXRBdmFpbGFibGVDb2luc0ZvckN1cnJlbnRTdGFnZSgpOwogICAgICAgICAgICByZWZ1bmQgPSAoICggKHJlcXVlc3RlZEFtb3VudE9mVG9rZW5zIC0gYW1vdW50VG9CdXkpIC8gYWNjdXJhY3kgKSAqIHByaWNlICk7CgogICAgICAgICAgICAvLyBSZXR1cm5pbmcgRVRICiAgICAgICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoIHJlZnVuZCApOwogICAgICAgIH0KCiAgICAgICAgVG9rZW5QdXJjaGFzZWQoc3RhZ2VzW2N1cnJlbnRTdGFnZV0ubmFtZSwgbXNnLnZhbHVlLCByZWZ1bmQsIGFtb3VudFRvQnV5KTsKICAgICAgICBzdGFnZXNbY3VycmVudFN0YWdlXS5jb2luc0F2YWlsYWJsZSAtPSBhbW91bnRUb0J1eTsKICAgICAgICBzdGFnZXNbY3VycmVudFN0YWdlXS5iYWxhbmNlICs9IChtc2cudmFsdWUgLSByZWZ1bmQpOwoKICAgICAgICB1aW50IGFtb3VudERlbGl2ZXJlZCA9IGFtb3VudFRvQnV5ICsgY2FsY3VsYXRlQm9udXMoYW1vdW50VG9CdXkpOwoKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSArPSBhbW91bnREZWxpdmVyZWQ7CiAgICAgICAgdG90YWxDb2luc0F2YWlsYWJsZSAtPSBhbW91bnREZWxpdmVyZWQ7CgogICAgICAgIGlmICggZ2V0QXZhaWxhYmxlQ29pbnNGb3JDdXJyZW50U3RhZ2UoKSA9PSAwICkgewogICAgICAgICAgICBfcHJvY2VlZFN0YWdlKCk7CiAgICAgICAgfQoKICAgICAgICBTVE9SQUdFX1dBTExFVC50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgfQoKICAgIC8vSXQgZG9lc24ndCByZWFsbHkgY2xvc2UgdGhlIHN0YWdlCiAgICAvL0l0IGp1c3QgbmVlZGVkIHRvIHB1c2ggdHJhbnNhY3Rpb24gdG8gdXBkYXRlIHN0YWdlIGFuZCB1cGRhdGUgYmxvY2subm93CiAgICBmdW5jdGlvbiBjbG9zZVN0YWdlKCkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5QWRtaW5pc3RyYXRvcgogICAgewogICAgICAgIF9wcm9jZWVkU3RhZ2UoKTsKICAgIH0KfQoKY29udHJhY3QgRVJDMjBDb250cmFjdCBpcyBFUkMyMCB7CiAgICAvL1Rva2VuIHN5bWJvbAogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiVU5JVCI7CgogICAgLy9Ub2tlbiBuYW1lCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiVW5pbG90IHRva2VuIjsKCiAgICAvL0l0IGNhbiBiZSByZWVlZWFseSBzbWFsbAogICAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CgogICAgLy8gQmFsYW5jZXMgZm9yIGVhY2ggYWNjb3VudAogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQ5NikgYmFsYW5jZXM7CgogICAgLy8gT3duZXIgb2YgYWNjb3VudCBhcHByb3ZlcyB0aGUgdHJhbnNmZXIgb2YgYW4gYW1vdW50IHRvIGFub3RoZXIgYWNjb3VudAogICAgbWFwcGluZyhhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDk2KSkgYWxsb3dlZDsKCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50KTsKCgogICAgLy8gV2hhdCBpcyB0aGUgYmFsYW5jZSBvZiBhIHBhcnRpY3VsYXIgYWNjb3VudD8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQgYmFsYW5jZSkKICAgIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KCgogICAgLy8gVHJhbnNmZXIgdGhlIGJhbGFuY2UgZnJvbSBvd25lcidzIGFjY291bnQgdG8gYW5vdGhlciBhY2NvdW50CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfYW1vdW50KQogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX2Ftb3VudAogICAgICAgICAgICAmJiBfYW1vdW50ID4gMAogICAgICAgICAgICAmJiBiYWxhbmNlc1tfdG9dICsgX2Ftb3VudCA+IGJhbGFuY2VzW190b10pIHsKICAgICAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gLT0gdWludDk2KF9hbW91bnQpOwogICAgICAgICAgICBiYWxhbmNlc1tfdG9dICs9IHVpbnQ5NihfYW1vdW50KTsKICAgICAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfYW1vdW50KTsKCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9CgoKICAgIC8vIFNlbmQgX3ZhbHVlIGFtb3VudCBvZiB0b2tlbnMgZnJvbSBhZGRyZXNzIF9mcm9tIHRvIGFkZHJlc3MgX3RvCiAgICAvLyBUaGUgdHJhbnNmZXJGcm9tIG1ldGhvZCBpcyB1c2VkIGZvciBhIHdpdGhkcmF3IHdvcmtmbG93LCBhbGxvd2luZyBjb250cmFjdHMgdG8gc2VuZAogICAgLy8gdG9rZW5zIG9uIHlvdXIgYmVoYWxmLCBmb3IgZXhhbXBsZSB0byAiZGVwb3NpdCIgdG8gYSBjb250cmFjdCBhZGRyZXNzIGFuZC9vciB0byBjaGFyZ2UKICAgIC8vIGZlZXMgaW4gc3ViLWN1cnJlbmNpZXM7IHRoZSBjb21tYW5kIHNob3VsZCBmYWlsIHVubGVzcyB0aGUgX2Zyb20gYWNjb3VudCBoYXMKICAgIC8vIGRlbGliZXJhdGVseSBhdXRob3JpemVkIHRoZSBzZW5kZXIgb2YgdGhlIG1lc3NhZ2UgdmlhIHNvbWUgbWVjaGFuaXNtOyB3ZSBwcm9wb3NlCiAgICAvLyB0aGVzZSBzdGFuZGFyZGl6ZWQgQVBJcyBmb3IgYXBwcm92YWw6CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oCiAgICAgICAgYWRkcmVzcyBfZnJvbSwKICAgICAgICBhZGRyZXNzIF90bywKICAgICAgICB1aW50MjU2IF9hbW91bnQKICAgICkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgICAgaWYgKGJhbGFuY2VzW19mcm9tXSA+PSBfYW1vdW50CiAgICAgICAgICAgICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF9hbW91bnQKICAgICAgICAgICAgJiYgX2Ftb3VudCA+IDAKICAgICAgICAgICAgJiYgYmFsYW5jZXNbX3RvXSArIF9hbW91bnQgPiBiYWxhbmNlc1tfdG9dKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW19mcm9tXSAtPSB1aW50OTYoX2Ftb3VudCk7CiAgICAgICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdIC09IHVpbnQ5NihfYW1vdW50KTsKICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSArPSB1aW50OTYoX2Ftb3VudCk7CiAgICAgICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF9hbW91bnQpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQoKCiAgICAvLyBBbGxvdyBfc3BlbmRlciB0byB3aXRoZHJhdyBmcm9tIHlvdXIgYWNjb3VudCwgbXVsdGlwbGUgdGltZXMsIHVwIHRvIHRoZSBfdmFsdWUgYW1vdW50LgogICAgLy8gSWYgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgYWdhaW4gaXQgb3ZlcndyaXRlcyB0aGUgY3VycmVudCBhbGxvd2FuY2Ugd2l0aCBfdmFsdWUuCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2Ftb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSB1aW50OTYoX2Ftb3VudCk7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF9hbW91bnQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50IHJlbWFpbmluZykKICAgIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KfQoKY29udHJhY3QgRXh0ZXJuYWxDdXJyZW5jeVByaWNlIHsKICAgIHN0cnVjdCBDdXJyZW5jeVZhbHVlIHsKICAgICAgICB1aW50NjQgdmFsdWU7CiAgICAgICAgdWludDggZGVjaW1hbHM7CiAgICB9CgogICAgc3RydWN0IFRyYW5zYWN0aW9uIHsKICAgICAgICBzdHJpbmcgY3VycmVuY3k7CiAgICAgICAgdWludDY0IHZhbHVlOwogICAgICAgIHN0cmluZyB0cmFuc2FjdGlvbklkOwogICAgICAgIHVpbnQ2NCBwcmljZTsKICAgICAgICB1aW50OCAgZGVjaW1hbHM7CiAgICB9CgogICAgc3RydWN0IFJlZnVuZFRyYW5zYWN0aW9uIHsKICAgICAgICB1aW50IHNvdXJjZVRyYW5zYWN0aW9uOwogICAgICAgIHVpbnQ4OCByZWZ1bmRBbW91bnQ7CiAgICB9CgogICAgbWFwcGluZyhzdHJpbmcgPT4gQ3VycmVuY3lWYWx1ZSkgcHJpY2VzOwoKICAgIFRyYW5zYWN0aW9uW10gcHVibGljIHRyYW5zYWN0aW9uczsKICAgIFJlZnVuZFRyYW5zYWN0aW9uW10gcHVibGljIHJlZnVuZFRyYW5zYWN0aW9uczsKCiAgICBhZGRyZXNzIG93bmVyOwoKICAgIGV2ZW50IE5ld1RyYW5zYWN0aW9uKHN0cmluZyBjdXJyZW5jeSwgdWludDY0IHZhbHVlLCBzdHJpbmcgdHJhbnNhY3Rpb25JZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDY0IHByaWNlLCB1aW50OCBkZWNpbWFscyk7CiAgICBldmVudCBOZXdSZWZ1bmRUcmFuc2FjdGlvbih1aW50IHNvdXJjZVRyYW5zYWN0aW9uLCB1aW50ODggcmVmdW5kQW1vdW50KTsKICAgIGV2ZW50IFByaWNlU2V0KHN0cmluZyBjdXJyZW5jeSwgdWludDY0IHZhbHVlLCB1aW50OCBkZWNpbWFscyk7CgogICAgbW9kaWZpZXIgb25seUFkbWluaXN0cmF0b3IoKSB7CiAgICAgICAgcmVxdWlyZSh0eC5vcmlnaW4gPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gRXh0ZXJuYWxDdXJyZW5jeVByaWNlKCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICBvd25lciA9IHR4Lm9yaWdpbjsKICAgIH0KCiAgICAvL0V4YW1wbGU6IDAuMDAwMDcxMTUgQlRDIHdpbGwgYmUgc2V0UHJpY2UoIkJUQyIsIDcxMTUsIDgpCiAgICBmdW5jdGlvbiBzZXRQcmljZShzdHJpbmcgY3VycmVuY3ksIHVpbnQ2NCB2YWx1ZSwgdWludDggZGVjaW1hbHMpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IKICAgIHsKICAgICAgICBwcmljZXNbY3VycmVuY3ldLnZhbHVlID0gdmFsdWU7CiAgICAgICAgcHJpY2VzW2N1cnJlbmN5XS5kZWNpbWFscyA9IGRlY2ltYWxzOwogICAgICAgIFByaWNlU2V0KGN1cnJlbmN5LCB2YWx1ZSwgZGVjaW1hbHMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFByaWNlKHN0cmluZyBjdXJyZW5jeSkKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyh1aW50NjQgdmFsdWUsIHVpbnQ4IGRlY2ltYWxzKQogICAgewogICAgICAgIHZhbHVlID0gcHJpY2VzW2N1cnJlbmN5XS52YWx1ZTsKICAgICAgICBkZWNpbWFscyA9IHByaWNlc1tjdXJyZW5jeV0uZGVjaW1hbHM7CiAgICB9CgogICAgLy9WYWx1ZSBpcyByZXR1cm5lZCB3aXRoIGFjY3VyYWN5IG9mIDE4IGRlY2ltYWxzIChzYW1lIGFzIHRva2VuKQogICAgLy9FeGFtcGxlOiB0byBjYWxjdWxhdGUgdmFsdWUgb2YgMSBCVEMgY2FsbAogICAgLy8gc2hvdWxkIGxvb2sgbGlrZSBjYWxjdWxhdGVBbW91bnQoIkJUQyIsIDEwMDAwMDAwMCkKICAgIC8vIFNlZSBzZXRQcmljZSBleGFtcGxlICg4IGRlY2ltYWxzKQogICAgZnVuY3Rpb24gY2FsY3VsYXRlQW1vdW50KHN0cmluZyBjdXJyZW5jeSwgdWludDY0IHZhbHVlKQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zICh1aW50ODggYW1vdW50KQogICAgewogICAgICAgIHJlcXVpcmUocHJpY2VzW2N1cnJlbmN5XS52YWx1ZSA+IDApOwogICAgICAgIHJlcXVpcmUodmFsdWUgPj0gcHJpY2VzW2N1cnJlbmN5XS52YWx1ZSk7CgogICAgICAgIGFtb3VudCA9IHVpbnQ4OCggKCB1aW50KHZhbHVlKSAqICggMTAqKjE4ICkgKSAvIHByaWNlc1tjdXJyZW5jeV0udmFsdWUgKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVQcmljZShzdHJpbmcgY3VycmVuY3ksIHVpbnQ4OCBhbW91bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnMgKHVpbnQ2NCBwcmljZSkKICAgIHsKICAgICAgICByZXF1aXJlKHByaWNlc1tjdXJyZW5jeV0udmFsdWUgPiAwKTsKCiAgICAgICAgcHJpY2UgPSB1aW50NjQoIGFtb3VudCAqIHByaWNlc1tjdXJyZW5jeV0udmFsdWUgKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRUcmFuc2FjdGlvbihzdHJpbmcgY3VycmVuY3ksIHVpbnQ2NCB2YWx1ZSwgc3RyaW5nIHRyYW5zYWN0aW9uSWQpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IKICAgICAgICByZXR1cm5zICh1aW50IG5ld1RyYW5zYWN0aW9uSWQpCiAgICB7CiAgICAgICAgcmVxdWlyZShwcmljZXNbY3VycmVuY3ldLnZhbHVlID4gMCk7CgogICAgICAgIG5ld1RyYW5zYWN0aW9uSWQgPSB0cmFuc2FjdGlvbnMubGVuZ3RoOwoKICAgICAgICBUcmFuc2FjdGlvbiBtZW1vcnkgdHJhbnNhY3Rpb247CgogICAgICAgIHRyYW5zYWN0aW9uLmN1cnJlbmN5ID0gY3VycmVuY3k7CiAgICAgICAgdHJhbnNhY3Rpb24udmFsdWUgPSB2YWx1ZTsKICAgICAgICB0cmFuc2FjdGlvbi5kZWNpbWFscyA9IHByaWNlc1tjdXJyZW5jeV0uZGVjaW1hbHM7CiAgICAgICAgdHJhbnNhY3Rpb24ucHJpY2UgPSBwcmljZXNbY3VycmVuY3ldLnZhbHVlOwogICAgICAgIHRyYW5zYWN0aW9uLnRyYW5zYWN0aW9uSWQgPSB0cmFuc2FjdGlvbklkOwoKICAgICAgICB0cmFuc2FjdGlvbnMucHVzaCh0cmFuc2FjdGlvbik7CgogICAgICAgIE5ld1RyYW5zYWN0aW9uKHRyYW5zYWN0aW9uLmN1cnJlbmN5LCB0cmFuc2FjdGlvbi52YWx1ZSwgdHJhbnNhY3Rpb24udHJhbnNhY3Rpb25JZCwKICAgICAgICAgICAgdHJhbnNhY3Rpb24ucHJpY2UsIHRyYW5zYWN0aW9uLmRlY2ltYWxzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXROdW1UcmFuc2FjdGlvbnMoKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyh1aW50IGxlbmd0aCkKICAgIHsKICAgICAgICBsZW5ndGggPSB0cmFuc2FjdGlvbnMubGVuZ3RoOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZFJlZnVuZFRyYW5zYWN0aW9uKHVpbnQgc291cmNlVHJhbnNhY3Rpb24sIHVpbnQ4OCByZWZ1bmRBbW91bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IKICAgICAgICByZXR1cm5zICh1aW50IG5ld1RyYW5zYWN0aW9uSWQpCiAgICB7CiAgICAgICAgcmVxdWlyZShzb3VyY2VUcmFuc2FjdGlvbiA8IHRyYW5zYWN0aW9ucy5sZW5ndGgpOwoKICAgICAgICBuZXdUcmFuc2FjdGlvbklkID0gcmVmdW5kVHJhbnNhY3Rpb25zLmxlbmd0aDsKCiAgICAgICAgUmVmdW5kVHJhbnNhY3Rpb24gbWVtb3J5IHRyYW5zYWN0aW9uOwoKICAgICAgICB0cmFuc2FjdGlvbi5zb3VyY2VUcmFuc2FjdGlvbiA9IHNvdXJjZVRyYW5zYWN0aW9uOwogICAgICAgIHRyYW5zYWN0aW9uLnJlZnVuZEFtb3VudCA9IHJlZnVuZEFtb3VudDsKCiAgICAgICAgcmVmdW5kVHJhbnNhY3Rpb25zLnB1c2godHJhbnNhY3Rpb24pOwoKICAgICAgICBOZXdSZWZ1bmRUcmFuc2FjdGlvbih0cmFuc2FjdGlvbi5zb3VyY2VUcmFuc2FjdGlvbiwgdHJhbnNhY3Rpb24ucmVmdW5kQW1vdW50KTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXROdW1SZWZ1bmRUcmFuc2FjdGlvbnMoKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyh1aW50IGxlbmd0aCkKICAgIHsKICAgICAgICBsZW5ndGggPSByZWZ1bmRUcmFuc2FjdGlvbnMubGVuZ3RoOwogICAgfQp9Cgpjb250cmFjdCBQcmVTYWxlVU5JVCBpcyBFUkMyMENvbnRyYWN0IHsKICAgIEVSQzIwWzNdIGludGVybmFsIHRva2VuczsKCiAgICBFeHRlcm5hbEN1cnJlbmN5UHJpY2UgZXh0ZXJuYWxDdXJyZW5jeVByb2Nlc3NvcjsKCiAgICB1aW50ODggcG9vbCA9IDI0MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwOyAvLzI0IG1sbiB0b2tlbnMKCiAgICB1aW50MzIgaW50ZXJuYWwgZW5kRGF0ZSA9IDE1MTkzMjYwMDA7ICAvLzIyIEZlYnJ1YXJ5IDIwMTggMTk6MDAgVVRDCgogICAgdWludDggaW50ZXJuYWwgZGlzY291bnQgPSA0MDsgICAgICAgICAgLy80MCUKCiAgICBhZGRyZXNzIGludGVybmFsIG93bmVyOwoKICAgIGV2ZW50IEFkZFRva2VuKGFkZHJlc3MgTmV3VG9rZW4sIHVpbnQ4IGluZGV4KTsKICAgIGV2ZW50IEJ1eVRva2Vuc0RpcmVjdChhZGRyZXNzIGJ1eWVyLCB1aW50NzIgZXRoX2Ftb3VudCwgdWludDg4IHBhaWRfYW1vdW50LCB1aW50ODggYm9udXNfYW1vdW50KTsKICAgIGV2ZW50IEJ1eVRva2Vuc0V4dGVybmFsKGFkZHJlc3MgYnV5ZXIsIHN0cmluZyBjdXJyZW5jeSwgdWludDcyIGFtb3VudCwgdWludDg4IHBhaWRfYW1vdW50LCB1aW50ODggYm9udXNfYW1vdW50KTsKICAgIGV2ZW50IENoYW5nZURhdGUodWludDMyIG5ld19kYXRlKTsKICAgIGV2ZW50IENoYW5nZURpc2NvdW50KHVpbnQ4IG5ld19kaXNjb3VudCk7CiAgICBldmVudCBDaGFuZ2VQb29sKHVpbnQ4OCBuZXdfcG9vbCk7CgogICAgbW9kaWZpZXIgb25seUFkbWluaXN0cmF0b3IoKSB7CiAgICAgICAgcmVxdWlyZSh0eC5vcmlnaW4gPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgbm90QWRtaW5pc3RyYXRvcigpIHsKICAgICAgICByZXF1aXJlKHR4Lm9yaWdpbiAhPSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBwb29sSXNOb3RFbXB0eSgpIHsKICAgICAgICByZXF1aXJlKHBvb2wgPiAwKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIGRpZG50UmFuT3V0T2ZUaW1lKCkgewogICAgICAgIHJlcXVpcmUodWludDMyKG5vdykgPD0gZW5kRGF0ZSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBQcmVTYWxlVU5JVChFUkMyMCBfdG9rZW4pCiAgICAgICAgcHVibGljCiAgICB7CiAgICAgICAgdG9rZW5zWzBdID0gX3Rva2VuOwogICAgICAgIG93bmVyID0gdHgub3JpZ2luOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldE93bmVyKCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKGFkZHJlc3MpCiAgICB7CiAgICAgICAgcmV0dXJuIG93bmVyOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFRva2VucygpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zKEVSQzIwWzNdKQogICAgewogICAgICAgIHJldHVybiB0b2tlbnM7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0UG9vbCgpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zKHVpbnQ4OCkKICAgIHsKICAgICAgICByZXR1cm4gcG9vbDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRCYXNlVG9rZW4oKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyhVbmlsb3RUb2tlbiBfdG9rZW4pCiAgICB7CiAgICAgICAgX3Rva2VuID0gVW5pbG90VG9rZW4odG9rZW5zWzBdKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRFeHRlcm5hbEN1cnJlbmN5UHJvY2Vzc29yKCkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5QWRtaW5pc3RyYXRvcgogICAgICAgIHJldHVybnMoRXh0ZXJuYWxDdXJyZW5jeVByaWNlKQogICAgewogICAgICAgIHJldHVybiBleHRlcm5hbEN1cnJlbmN5UHJvY2Vzc29yOwogICAgfQoKICAgIC8vQWRtaW4gZm5zCiAgICBmdW5jdGlvbiBhZGRUb2tlbihFUkMyMCBfdG9rZW4pCiAgICAgICAgcHVibGljCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IKICAgIHsKICAgICAgICByZXF1aXJlKF90b2tlbiAhPSBhZGRyZXNzKDApKTsKCiAgICAgICAgZm9yKHVpbnQ4IGkgPSAwOyBpIDwgdG9rZW5zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmICh0b2tlbnNbaV0gPT0gX3Rva2VuKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfSBlbHNlIGlmICh0b2tlbnNbaV0gPT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICAgICAgdG9rZW5zW2ldID0gX3Rva2VuOwogICAgICAgICAgICAgICAgQWRkVG9rZW4oX3Rva2VuLCBpKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGNoYW5nZUVuZERhdGUodWludDMyIF9lbmREYXRlKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yCiAgICB7CiAgICAgICAgZW5kRGF0ZSA9IF9lbmREYXRlOwogICAgICAgIENoYW5nZURhdGUoZW5kRGF0ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlRGlzY291bnQodWludDggX2Rpc2NvdW50KQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yCiAgICB7CiAgICAgICAgZGlzY291bnQgPSBfZGlzY291bnQ7CiAgICAgICAgQ2hhbmdlRGlzY291bnQoZGlzY291bnQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYW5nZVBvb2wodWludDg4IF9wb29sKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yCiAgICB7CiAgICAgICAgcG9vbCA9IF9wb29sOwogICAgICAgIENoYW5nZVBvb2wocG9vbCk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0RXh0ZXJuYWxDdXJyZW5jeVByb2Nlc3NvcihFeHRlcm5hbEN1cnJlbmN5UHJpY2UgcHJvY2Vzc29yKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yCiAgICB7CiAgICAgICAgZXh0ZXJuYWxDdXJyZW5jeVByb2Nlc3NvciA9IHByb2Nlc3NvcjsKICAgIH0KCiAgICBmdW5jdGlvbiBwYXltZW50V2l0aEN1cnJlbmN5KGFkZHJlc3MgYnV5ZXIsIHN0cmluZyBjdXJyZW5jeSwgdWludDY0IHZhbHVlLCBzdHJpbmcgdHJhbnNhY3Rpb25JZCkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5QWRtaW5pc3RyYXRvcgogICAgICAgIHBvb2xJc05vdEVtcHR5CiAgICAgICAgZGlkbnRSYW5PdXRPZlRpbWUKICAgIHsKICAgICAgICByZXF1aXJlKGJ1eWVyICE9IG93bmVyKTsKCiAgICAgICAgRXh0ZXJuYWxDdXJyZW5jeVByaWNlIHByb2Nlc3NvciA9IGdldEV4dGVybmFsQ3VycmVuY3lQcm9jZXNzb3IoKTsKICAgICAgICB1aW50ODggcGFpZF90b2tlbnMgPSBwcm9jZXNzb3IuY2FsY3VsYXRlQW1vdW50KGN1cnJlbmN5LCB2YWx1ZSk7CiAgICAgICAgdWludDg4IGJvbnVzX3Rva2VucyA9IHVpbnQ4OCgocGFpZF90b2tlbnMgKiBkaXNjb3VudCkgLyAxMDApOwogICAgICAgIHVpbnQ4OCByZWZ1bmRfYW1vdW50ID0gMDsKCiAgICAgICAgaWYoKHBhaWRfdG9rZW5zICsgYm9udXNfdG9rZW5zKSA+IHBvb2wpIHsKICAgICAgICAgICAgcGFpZF90b2tlbnMgPSB1aW50ODgoIHBvb2wgLyAoICggMTAwICsgZGlzY291bnQgKSAvIDEwMCApICk7CiAgICAgICAgICAgIGJvbnVzX3Rva2VucyA9IHVpbnQ4OCggcG9vbCAtIHBhaWRfdG9rZW5zICk7CiAgICAgICAgICAgIHJlZnVuZF9hbW91bnQgPSAoIHZhbHVlIC0gcHJvY2Vzc29yLmNhbGN1bGF0ZVByaWNlKGN1cnJlbmN5LCBwYWlkX3Rva2VucykgKTsKICAgICAgICB9CgogICAgICAgIGJhbGFuY2VzW2J1eWVyXSArPSB1aW50OTYocGFpZF90b2tlbnMgKyBib251c190b2tlbnMpOwoKICAgICAgICBCdXlUb2tlbnNFeHRlcm5hbChidXllciwgY3VycmVuY3ksIHZhbHVlLCBwYWlkX3Rva2VucywgYm9udXNfdG9rZW5zKTsKCiAgICAgICAgdWludCBwcm9jZXNzb3JUcmFuc2FjdGlvbklkID0gcHJvY2Vzc29yLmFkZFRyYW5zYWN0aW9uKGN1cnJlbmN5LCB2YWx1ZSwgdHJhbnNhY3Rpb25JZCk7CgogICAgICAgIGlmICggcmVmdW5kX2Ftb3VudCA+IDAgKSB7CiAgICAgICAgICAgIHByb2Nlc3Nvci5hZGRSZWZ1bmRUcmFuc2FjdGlvbihwcm9jZXNzb3JUcmFuc2FjdGlvbklkLCByZWZ1bmRfYW1vdW50KTsKICAgICAgICB9CiAgICB9CiAgICAvL0VORCBBZG1pbiBmbnMKCiAgICAvL0VSQzIwCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50KQogICAgewogICAgICAgIHJldHVybiB1aW50KHRva2Vuc1swXS50b3RhbFN1cHBseSgpKTsKICAgIH0KCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50IGJhbGFuY2UpCiAgICB7CiAgICAgICAgYmFsYW5jZSA9IHN1cGVyLmJhbGFuY2VPZihfb3duZXIpOwoKICAgICAgICBmb3IgKCB1aW50OCBpID0gMDsgaSA8IHRva2Vucy5sZW5ndGg7IGkrKyApIHsKICAgICAgICAgICAgaWYgKHRva2Vuc1tpXSA9PSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYmFsYW5jZSArPSB1aW50OTYodG9rZW5zW2ldLmJhbGFuY2VPZihfb3duZXIpKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX2Ftb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgICAgc3VjY2VzcyA9IGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbSgKICAgICAgICBhZGRyZXNzIF9mcm9tLAogICAgICAgIGFkZHJlc3MgX3RvLAogICAgICAgIHVpbnQyNTYgX2Ftb3VudAogICAgKQogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICBzdWNjZXNzID0gZmFsc2U7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hbW91bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKQogICAgewogICAgICAgIHN1Y2Nlc3MgPSBmYWxzZTsKICAgIH0KCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50IHJlbWFpbmluZykKICAgIHsKICAgICAgICByZW1haW5pbmcgPSAwOwogICAgfQogICAgLy9FTkQgRVJDMjAKCiAgICBmdW5jdGlvbigpCiAgICAgICAgcHVibGljCiAgICAgICAgcGF5YWJsZQogICAgICAgIG5vdEFkbWluaXN0cmF0b3IKICAgICAgICBwb29sSXNOb3RFbXB0eQogICAgICAgIGRpZG50UmFuT3V0T2ZUaW1lCiAgICB7CiAgICAgICAgVW5pbG90VG9rZW4gYmFzZVRva2VuID0gZ2V0QmFzZVRva2VuKCk7CgogICAgICAgIGFkZHJlc3Mgc3RvcmFnZVdhbGxldCA9IGJhc2VUb2tlbi5TVE9SQUdFX1dBTExFVCgpOwogICAgICAgIHVpbnQ0OCBwcmljZSA9IHVpbnQ0OChiYXNlVG9rZW4ucHJpY2UoKSk7CiAgICAgICAgdWludDcyIGV0aF9hbW91bnQgPSB1aW50NzIobXNnLnZhbHVlKTsKICAgICAgICB1aW50NjQgYWNjdXJhY3kgPSB1aW50NjQoIGJhc2VUb2tlbi5hY2N1cmFjeSgpICk7CiAgICAgICAgdWludDg4IHBhaWRfdG9rZW5zID0gdWludDg4KCAoIHVpbnQoZXRoX2Ftb3VudCkgKiBhY2N1cmFjeSAvIHByaWNlICkgKTsKICAgICAgICB1aW50ODggYm9udXNfdG9rZW5zID0gdWludDg4KChwYWlkX3Rva2VucyAqIGRpc2NvdW50KSAvIDEwMCk7CgogICAgICAgIGlmKChwYWlkX3Rva2VucyArIGJvbnVzX3Rva2VucykgPiBwb29sKSB7CiAgICAgICAgICAgIHBhaWRfdG9rZW5zID0gdWludDg4KCBwb29sIC8gKCAoIDEwMCArIGRpc2NvdW50ICkgLyAxMDAgKSApOwogICAgICAgICAgICBib251c190b2tlbnMgPSB1aW50ODgoIHBvb2wgLSBwYWlkX3Rva2VucyApOwogICAgICAgICAgICBldGhfYW1vdW50ID0gdWludDcyKCAocGFpZF90b2tlbnMgLyBhY2N1cmFjeSkgKiBwcmljZSApOwogICAgICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKCBtc2cudmFsdWUgLSBldGhfYW1vdW50ICk7CiAgICAgICAgfQoKICAgICAgICBCdXlUb2tlbnNEaXJlY3QobXNnLnNlbmRlciwgZXRoX2Ftb3VudCwgcGFpZF90b2tlbnMsIGJvbnVzX3Rva2Vucyk7CgogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdICs9IHVpbnQ5NihwYWlkX3Rva2VucyArIGJvbnVzX3Rva2Vucyk7CgogICAgICAgIHN0b3JhZ2VXYWxsZXQudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgIH0KfQ=='.
	

]
