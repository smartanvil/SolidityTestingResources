Class {
	#name : #SRTa6407855d9742a47386aad09f688856981d21e5b,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTa6407855d9742a47386aad09f688856981d21e5b >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7CgovLyBGaWxlOiBjb250cmFjdHNcemVwcGVsaW5cb3duZXJzaGlwXE93bmFibGUuc29sCgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9CgovLyBGaWxlOiBjb250cmFjdHNcemVwcGVsaW5cbWF0aFxTYWZlTWF0aC5zb2wKCi8qKgogKiBAdGl0bGUgU2FmZU1hdGgKICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCmxpYnJhcnkgU2FmZU1hdGggewogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCAgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCAgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKLy8gRmlsZTogY29udHJhY3RzXHplcHBlbGluXHRva2VuXEVSQzIwQmFzaWMuc29sCgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljICByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCi8vIEZpbGU6IGNvbnRyYWN0c1x6ZXBwZWxpblx0b2tlblxCYXNpY1Rva2VuLnNvbAoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljICByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCi8vIEZpbGU6IGNvbnRyYWN0c1x6ZXBwZWxpblx0b2tlblxFUkMyMC5zb2wKCi8qKgogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKi8KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljICByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKLy8gRmlsZTogY29udHJhY3RzXHplcHBlbGluXHRva2VuXFN0YW5kYXJkVG9rZW4uc29sCgovKioKICogQHRpdGxlIFN0YW5kYXJkIEVSQzIwIHRva2VuCiAqCiAqIEBkZXYgSW1wbGVtZW50YXRpb24gb2YgdGhlIGJhc2ljIHN0YW5kYXJkIHRva2VuLgogKiBAZGV2IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgRmlyc3RCbG9vZDogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sCiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBpbnRlcm5hbCBhbGxvd2VkOwoKCiAgLyoqCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIEJhc2ljVG9rZW4udHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogIH0KCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW19mcm9tXSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSk7CgogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICoKICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICogYW5kIHRoZSBuZXcgYWxsb3dhbmNlIGJ5IHVuZm9ydHVuYXRlIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcwogICAqIHJhY2UgY29uZGl0aW9uIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUgYWZ0ZXJ3YXJkczoKICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgKi8KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyAgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqLwogIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9CgovLyBGaWxlOiBjb250cmFjdHNcemVwcGVsaW5cdG9rZW5cTWludGFibGVUb2tlbi5zb2wKCi8qKgogKiBAdGl0bGUgTWludGFibGUgdG9rZW4KICogQGRldiBTaW1wbGUgRVJDMjAgVG9rZW4gZXhhbXBsZSwgd2l0aCBtaW50YWJsZSB0b2tlbiBjcmVhdGlvbgogKiBAZGV2IElzc3VlOiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvaXNzdWVzLzEyMAogKiBCYXNlZCBvbiBjb2RlIGJ5IFRva2VuTWFya2V0TmV0OiBodHRwczovL2dpdGh1Yi5jb20vVG9rZW5NYXJrZXROZXQvaWNvL2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy9NaW50YWJsZVRva2VuLnNvbAogKi8KCmNvbnRyYWN0IE1pbnRhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZSB7CiAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKICBldmVudCBNaW50RmluaXNoZWQoKTsKCiAgYm9vbCBwdWJsaWMgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CgoKICBtb2RpZmllciBjYW5NaW50KCkgewogICAgcmVxdWlyZSghbWludGluZ0ZpbmlzaGVkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIG1pbnQgdG9rZW5zCiAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgbWludGVkIHRva2Vucy4KICAgKiBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAqIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoX2Ftb3VudCk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICBNaW50KF90bywgX2Ftb3VudCk7CiAgICBUcmFuc2ZlcihhZGRyZXNzKDApLCBfdG8sIF9hbW91bnQpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHN0b3AgbWludGluZyBuZXcgdG9rZW5zLgogICAqIEByZXR1cm4gVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgIE1pbnRGaW5pc2hlZCgpOwogICAgcmV0dXJuIHRydWU7CiAgfQp9CgovLyBGaWxlOiBjb250cmFjdHNcemVwcGVsaW5cdG9rZW5cQ2FwcGVkVG9rZW4uc29sCgovKioKICogQHRpdGxlIENhcHBlZCB0b2tlbgogKiBAZGV2IE1pbnRhYmxlIHRva2VuIHdpdGggYSB0b2tlbiBjYXAuCiAqLwoKY29udHJhY3QgQ2FwcGVkVG9rZW4gaXMgTWludGFibGVUb2tlbiB7CgogIHVpbnQyNTYgcHVibGljIGNhcDsKCiAgZnVuY3Rpb24gQ2FwcGVkVG9rZW4odWludDI1NiBfY2FwKSBwdWJsaWMgewogICAgcmVxdWlyZShfY2FwID4gMCk7CiAgICBjYXAgPSBfY2FwOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBtaW50IHRva2VucwogICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIG1pbnRlZCB0b2tlbnMuCiAgICogQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gbWludC4KICAgKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgb25seU93bmVyIGNhbk1pbnQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUodG90YWxTdXBwbHkuYWRkKF9hbW91bnQpIDw9IGNhcCk7CgogICAgcmV0dXJuIHN1cGVyLm1pbnQoX3RvLCBfYW1vdW50KTsKICB9Cgp9CgovLyBGaWxlOiBjb250cmFjdHNcemVwcGVsaW5cbGlmZWN5Y2xlXFBhdXNhYmxlLnNvbAoKLyoqCiAqIEB0aXRsZSBQYXVzYWJsZQogKiBAZGV2IEJhc2UgY29udHJhY3Qgd2hpY2ggYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uCiAqLwpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKICBldmVudCBQYXVzZSgpOwogIGV2ZW50IFVucGF1c2UoKTsKCiAgYm9vbCBwdWJsaWMgcGF1c2VkID0gZmFsc2U7CgoKICAvKioKICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIG5vdCBwYXVzZWQuCiAgICovCiAgbW9kaWZpZXIgd2hlbk5vdFBhdXNlZCgpIHsKICAgIHJlcXVpcmUoIXBhdXNlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBwYXVzZWQuCiAgICovCiAgbW9kaWZpZXIgd2hlblBhdXNlZCgpIHsKICAgIHJlcXVpcmUocGF1c2VkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gcGF1c2UsIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUKICAgKi8KICBmdW5jdGlvbiBwYXVzZSgpIG9ubHlPd25lciB3aGVuTm90UGF1c2VkIHB1YmxpYyB7CiAgICBwYXVzZWQgPSB0cnVlOwogICAgUGF1c2UoKTsKICB9CgogIC8qKgogICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byB1bnBhdXNlLCByZXR1cm5zIHRvIG5vcm1hbCBzdGF0ZQogICAqLwogIGZ1bmN0aW9uIHVucGF1c2UoKSBvbmx5T3duZXIgd2hlblBhdXNlZCBwdWJsaWMgewogICAgcGF1c2VkID0gZmFsc2U7CiAgICBVbnBhdXNlKCk7CiAgfQp9CgovLyBGaWxlOiBjb250cmFjdHNcemVwcGVsaW5cdG9rZW5cUGF1c2FibGVUb2tlbi5zb2wKCi8qKgogKiBAdGl0bGUgUGF1c2FibGUgdG9rZW4KICoKICogQGRldiBTdGFuZGFyZFRva2VuIG1vZGlmaWVkIHdpdGggcGF1c2FibGUgdHJhbnNmZXJzLgogKiovCgpjb250cmFjdCBQYXVzYWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIFBhdXNhYmxlIHsKCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLmFwcHJvdmUoX3NwZW5kZXIsIF92YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgcmV0dXJuIHN1cGVyLmluY3JlYXNlQXBwcm92YWwoX3NwZW5kZXIsIF9hZGRlZFZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJldHVybiBzdXBlci5kZWNyZWFzZUFwcHJvdmFsKF9zcGVuZGVyLCBfc3VidHJhY3RlZFZhbHVlKTsKICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0c1xCbG9ja3BvcnRUb2tlbi5zb2wKCi8vLyBAdGl0bGUgQmxvY2twb3J0IFRva2VuIC0gVG9rZW4gY29kZSBmb3Igb3VyIEJsb2NrcG9ydC5ubCBQcm9qZWN0Ci8vLyBAYXV0aG9yIEphbiBCb2xodWlzLCBXZXNsZXkgdmFuIEhlaWplCi8vICBWZXJzaW9uIDMsIGRlY2VtYmVyIDIwMTcKLy8gIFRoaXMgdmVyc2lvbiBpcyBjb21wbGV0ZWx5IGJhc2VkIG9uIHRoZSBPcGVuemVwcGVsaW4gU29saWRpdHkgZnJhbWV3b3JrLgovLwovLyAgVGhlcmUgd2lsbCBiZSBhIHByZXNhbGUgY2FwIG9mIDYuNDAwLjAwMCBCUFQgVG9rZW5zCi8vICBNaW5pbXVtIHByZXNhbGUgaW52ZXN0bWVudCBpbiBFdGhlciB3aWxsIGJlIHNldCBhdCB0aGUgc3RhcnQgaW4gdGhlIFByZXNhbGUgY29udHJhY3Q7IGNhbGN1bGF0ZWQgb24gYSB3ZWVrbHkgYXZhcmFnZSBmb3IgYW4gYW1vdW50IG9mIH4gMTAwMCBFdXJvCi8vICBVbnNvbGQgcHJlc2FsZSB0b2tlbnMgd2lsbCBiZSBidXJudCwgaW1wbGVtZW50ZWQgYXMgbWludGJhbGUgdG9rZW4gYXMgc3VjaCB0aGF0IG9ubHkgc29sZCB0b2tlbnMgYXJlIG1pbnRlZC4KLy8gIFByZXNhbGUgcmF0ZSBoYXMgYSAzMyUgYm9udXMgdG8gdGhlIGNyb3dkc2FsZSB0byBjb21wZW5zYXRlIHRoZSBleHRyYSByaXNrCi8vICBUaGUgdG90YWwgc3VwcGx5IG9mIHRva2VucyAocHJlLXNhbGUgKyBjcm93ZHNhbGUpIHdpbGwgYmUgNDksNjAwLDAwMCBCUFQKLy8gIE1pbmltdW0gY3Jvd2RzYWxlIGludmVzdG1lbnQgd2lsbCBiZSAwLjEgZXRoZXIKLy8gIE1hYyBjYXAgZm9yIHRoZSBjcm93ZHNhbGUgaXMgNDMsMjAwLDAwMCBCUFQKLy8gIFRoZXJlIGlzIG5vIGJvbnVzIHNjaGVtZSBmb3IgdGhlIGNyb3dkc2FsZQovLyAgVW5zb2xkIENyb3dzZGFsZSB0b2tlbnMgd2lsbCBiZSBidXJudCwgaW1wbGVtZW50ZWQgYXMgbWludGJhbGUgdG9rZW4gYXMgc3VjaCB0aGF0IG9ubHkgc29sZCB0b2tlbnMgYXJlIG1pbnRlZC4KLy8gIE9uIHRoZSBhbW91bnQgdG9rZW5zIHNvbGQgYW4gYWRkaXRpb25hbCA0MCUgd2lsbCBiZSBtaW50ZWQ7IHRoaXMgd2lsbCBiZSBhbGxvY2F0ZWQgdG8gdGhlIEJsb2NrcG9ydCBjb21wYW55KDIwJSkgYW5kIHRoZSBCbG9ja3BvcnQgdGVhbSgyMCUpCi8vICBCUFQgdG9rZW5zIHdpbGwgYmUgdHJhZGFibGUgc3RyYWlndCBhZnRlciB0aGUgZmluYWxpemF0aW9uIG9mIHRoZSBjcm93ZHNhbGUuIFRoaXMgaXMgaW1wbGVtZW50ZWQgYnkgYmVpbmcgYSBwYXVzYWJsZSB0b2tlbiB0aGF0IGlzIHVucGF1c2VkIGF0IENyb3dkc2FsZSBmaW5hbGlzYXRpb24uCgoKY29udHJhY3QgQmxvY2twb3J0VG9rZW4gaXMgQ2FwcGVkVG9rZW4sIFBhdXNhYmxlVG9rZW4gewoKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSAgICAgICAgICAgICAgICAgPSAiQmxvY2twb3J0IFRva2VuIjsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sICAgICAgICAgICAgICAgPSAiQlBUIjsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzICAgICAgICAgICAgICAgPSAxODsKCiAgICBmdW5jdGlvbiBCbG9ja3BvcnRUb2tlbih1aW50MjU2IF90b3RhbFN1cHBseSkgCiAgICAgICAgQ2FwcGVkVG9rZW4oX3RvdGFsU3VwcGx5KSBwdWJsaWMgewogICAgICAgICAgICBwYXVzZWQgPSB0cnVlOwogICAgfQp9CgovLyBGaWxlOiBjb250cmFjdHNcQ3Jvd2RzYWxlV2hpdGVsaXN0LnNvbAoKY29udHJhY3QgQ3Jvd2RzYWxlV2hpdGVsaXN0IGlzIE93bmFibGUgewogICAgCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgYWxsb3dlZEFkZHJlc3NlczsKICAgIHVpbnQgY291bnQgPSAwOwogICAgCiAgICBtb2RpZmllciB3aGl0ZWxpc3RlZCgpIHsKICAgICAgICByZXF1aXJlKGFsbG93ZWRBZGRyZXNzZXNbbXNnLnNlbmRlcl0gPT0gdHJ1ZSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRUb1doaXRlbGlzdChhZGRyZXNzW10gX2FkZHJlc3NlcykgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgX2FkZHJlc3Nlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoYWxsb3dlZEFkZHJlc3Nlc1tfYWRkcmVzc2VzW2ldXSkgeyAKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBhbGxvd2VkQWRkcmVzc2VzW19hZGRyZXNzZXNbaV1dID0gdHJ1ZTsKICAgICAgICAgICAgY291bnQrKzsKICAgICAgICB9CgogICAgICAgIFdoaXRlbGlzdFVwZGF0ZWQoYmxvY2sudGltZXN0YW1wLCAiQWRkZWQiLCBjb3VudCk7ICAKICAgIH0KCiAgICBmdW5jdGlvbiByZW1vdmVGcm9tV2hpdGVsaXN0KGFkZHJlc3NbXSBfYWRkcmVzc2VzKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBfYWRkcmVzc2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmICghYWxsb3dlZEFkZHJlc3Nlc1tfYWRkcmVzc2VzW2ldXSkgeyAKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBhbGxvd2VkQWRkcmVzc2VzW19hZGRyZXNzZXNbaV1dID0gZmFsc2U7CiAgICAgICAgICAgIGNvdW50LS07CiAgICAgICAgfQogICAgICAgIAogICAgICAgIFdoaXRlbGlzdFVwZGF0ZWQoYmxvY2sudGltZXN0YW1wLCAiUmVtb3ZlZCIsIGNvdW50KTsgICAgICAgIAogICAgfQogICAgCiAgICBmdW5jdGlvbiBpc1doaXRlbGlzdGVkKCkgcHVibGljIHdoaXRlbGlzdGVkIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRyZXNzSXNXaGl0ZWxpc3RlZChhZGRyZXNzIF9hZGRyZXNzKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBhbGxvd2VkQWRkcmVzc2VzW19hZGRyZXNzXTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRBZGRyZXNzQ291bnQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBjb3VudDsKICAgIH0KCiAgICBldmVudCBXaGl0ZWxpc3RVcGRhdGVkKHVpbnQgdGltZXN0YW1wLCBzdHJpbmcgb3BlcmF0aW9uLCB1aW50IHRvdGFsQWRkcmVzc2VzKTsKfQoKLy8gRmlsZTogY29udHJhY3RzXHplcHBlbGluXGNyb3dkc2FsZVxDcm93ZHNhbGUuc29sCgovKioKICogQHRpdGxlIENyb3dkc2FsZQogKiBAZGV2IENyb3dkc2FsZSBpcyBhIGJhc2UgY29udHJhY3QgZm9yIG1hbmFnaW5nIGEgdG9rZW4gY3Jvd2RzYWxlLgogKiBDcm93ZHNhbGVzIGhhdmUgYSBzdGFydCBhbmQgZW5kIHRpbWVzdGFtcHMsIHdoZXJlIGludmVzdG9ycyBjYW4gbWFrZQogKiB0b2tlbiBwdXJjaGFzZXMgYW5kIHRoZSBjcm93ZHNhbGUgd2lsbCBhc3NpZ24gdGhlbSB0b2tlbnMgYmFzZWQKICogb24gYSB0b2tlbiBwZXIgRVRIIHJhdGUuIEZ1bmRzIGNvbGxlY3RlZCBhcmUgZm9yd2FyZGVkIHRvIGEgd2FsbGV0CiAqIGFzIHRoZXkgYXJyaXZlLgogKi8KY29udHJhY3QgQ3Jvd2RzYWxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgLy8gVGhlIHRva2VuIGJlaW5nIHNvbGQKICBNaW50YWJsZVRva2VuIHB1YmxpYyB0b2tlbjsKCiAgLy8gc3RhcnQgYW5kIGVuZCB0aW1lc3RhbXBzIHdoZXJlIGludmVzdG1lbnRzIGFyZSBhbGxvd2VkIChib3RoIGluY2x1c2l2ZSkKICB1aW50MjU2IHB1YmxpYyBzdGFydFRpbWU7CiAgdWludDI1NiBwdWJsaWMgZW5kVGltZTsKCiAgLy8gYWRkcmVzcyB3aGVyZSBmdW5kcyBhcmUgY29sbGVjdGVkCiAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0OwoKICAvLyBob3cgbWFueSB0b2tlbiB1bml0cyBhIGJ1eWVyIGdldHMgcGVyIHdlaQogIHVpbnQyNTYgcHVibGljIHJhdGU7CgogIC8vIGFtb3VudCBvZiByYWlzZWQgbW9uZXkgaW4gd2VpCiAgdWludDI1NiBwdWJsaWMgd2VpUmFpc2VkOwoKICAvKioKICAgKiBldmVudCBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAqIEBwYXJhbSBwdXJjaGFzZXIgd2hvIHBhaWQgZm9yIHRoZSB0b2tlbnMKICAgKiBAcGFyYW0gYmVuZWZpY2lhcnkgd2hvIGdvdCB0aGUgdG9rZW5zCiAgICogQHBhcmFtIHZhbHVlIHdlaXMgcGFpZCBmb3IgcHVyY2hhc2UKICAgKiBAcGFyYW0gYW1vdW50IGFtb3VudCBvZiB0b2tlbnMgcHVyY2hhc2VkCiAgICovCiAgZXZlbnQgVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgdmFsdWUsIHVpbnQyNTYgYW1vdW50KTsKCgogIGZ1bmN0aW9uIENyb3dkc2FsZSh1aW50MjU2IF9zdGFydFRpbWUsIHVpbnQyNTYgX2VuZFRpbWUsIHVpbnQyNTYgX3JhdGUsIGFkZHJlc3MgX3dhbGxldCkgcHVibGljIHsKICAgIHJlcXVpcmUoX3N0YXJ0VGltZSA+PSBub3cpOwogICAgcmVxdWlyZShfZW5kVGltZSA+PSBfc3RhcnRUaW1lKTsKICAgIHJlcXVpcmUoX3JhdGUgPiAwKTsKICAgIHJlcXVpcmUoX3dhbGxldCAhPSBhZGRyZXNzKDApKTsKCiAgICB0b2tlbiA9IGNyZWF0ZVRva2VuQ29udHJhY3QoKTsKICAgIHN0YXJ0VGltZSA9IF9zdGFydFRpbWU7CiAgICBlbmRUaW1lID0gX2VuZFRpbWU7CiAgICByYXRlID0gX3JhdGU7CiAgICB3YWxsZXQgPSBfd2FsbGV0OwogIH0KCiAgLy8gY3JlYXRlcyB0aGUgdG9rZW4gdG8gYmUgc29sZC4KICAvLyBvdmVycmlkZSB0aGlzIG1ldGhvZCB0byBoYXZlIGNyb3dkc2FsZSBvZiBhIHNwZWNpZmljIG1pbnRhYmxlIHRva2VuLgogIGZ1bmN0aW9uIGNyZWF0ZVRva2VuQ29udHJhY3QoKSBpbnRlcm5hbCByZXR1cm5zIChNaW50YWJsZVRva2VuKSB7CiAgICByZXR1cm4gbmV3IE1pbnRhYmxlVG9rZW4oKTsKICB9CgogIC8vIGZhbGxiYWNrIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIGJ1eSB0b2tlbnMKICBmdW5jdGlvbiAoKSBleHRlcm5hbCBwYXlhYmxlIHsKICAgIGJ1eVRva2Vucyhtc2cuc2VuZGVyKTsKICB9CgogIC8vIGxvdyBsZXZlbCB0b2tlbiBwdXJjaGFzZSBmdW5jdGlvbgogIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgcGF5YWJsZSB7CiAgICByZXF1aXJlKGJlbmVmaWNpYXJ5ICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZSh2YWxpZFB1cmNoYXNlKCkpOwoKICAgIHVpbnQyNTYgd2VpQW1vdW50ID0gbXNnLnZhbHVlOwoKICAgIC8vIGNhbGN1bGF0ZSB0b2tlbiBhbW91bnQgdG8gYmUgY3JlYXRlZAogICAgdWludDI1NiB0b2tlbnMgPSB3ZWlBbW91bnQubXVsKHJhdGUpOwoKICAgIC8vIHVwZGF0ZSBzdGF0ZQogICAgd2VpUmFpc2VkID0gd2VpUmFpc2VkLmFkZCh3ZWlBbW91bnQpOwoKICAgIHRva2VuLm1pbnQoYmVuZWZpY2lhcnksIHRva2Vucyk7CiAgICBUb2tlblB1cmNoYXNlKG1zZy5zZW5kZXIsIGJlbmVmaWNpYXJ5LCB3ZWlBbW91bnQsIHRva2Vucyk7CgogICAgZm9yd2FyZEZ1bmRzKCk7CiAgfQoKICAvLyBzZW5kIGV0aGVyIHRvIHRoZSBmdW5kIGNvbGxlY3Rpb24gd2FsbGV0CiAgLy8gb3ZlcnJpZGUgdG8gY3JlYXRlIGN1c3RvbSBmdW5kIGZvcndhcmRpbmcgbWVjaGFuaXNtcwogIGZ1bmN0aW9uIGZvcndhcmRGdW5kcygpIGludGVybmFsIHsKICAgIHdhbGxldC50cmFuc2Zlcihtc2cudmFsdWUpOwogIH0KCiAgLy8gQHJldHVybiB0cnVlIGlmIHRoZSB0cmFuc2FjdGlvbiBjYW4gYnV5IHRva2VucwogIGZ1bmN0aW9uIHZhbGlkUHVyY2hhc2UoKSBpbnRlcm5hbCAgcmV0dXJucyAoYm9vbCkgewogICAgYm9vbCB3aXRoaW5QZXJpb2QgPSBub3cgPj0gc3RhcnRUaW1lICYmIG5vdyA8PSBlbmRUaW1lOwogICAgYm9vbCBub25aZXJvUHVyY2hhc2UgPSBtc2cudmFsdWUgIT0gMDsKICAgIHJldHVybiB3aXRoaW5QZXJpb2QgJiYgbm9uWmVyb1B1cmNoYXNlOwogIH0KCiAgLy8gQHJldHVybiB0cnVlIGlmIGNyb3dkc2FsZSBldmVudCBoYXMgc3RhcnRlZAogIGZ1bmN0aW9uIGhhc1N0YXJ0ZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIG5vdyA+PSBzdGFydFRpbWU7CiAgfQoKICAvLyBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBlbmRlZAogIGZ1bmN0aW9uIGhhc0VuZGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIG5vdyA+IGVuZFRpbWU7CiAgfQoKICAvLyBAcmV0dXJuIGN1cnJlbnQgdGltZXN0YW1wCiAgZnVuY3Rpb24gY3VycmVudFRpbWUoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KSB7IAogICAgcmV0dXJuIG5vdzsKICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0c1x6ZXBwZWxpblxjcm93ZHNhbGVcQ2FwcGVkQ3Jvd2RzYWxlLnNvbAoKLyoqCiAqIEB0aXRsZSBDYXBwZWRDcm93ZHNhbGUKICogQGRldiBFeHRlbnNpb24gb2YgQ3Jvd2RzYWxlIHdpdGggYSBtYXggYW1vdW50IG9mIGZ1bmRzIHJhaXNlZAogKi8KY29udHJhY3QgQ2FwcGVkQ3Jvd2RzYWxlIGlzIENyb3dkc2FsZSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIHVpbnQyNTYgcHVibGljIGNhcDsKCiAgZnVuY3Rpb24gQ2FwcGVkQ3Jvd2RzYWxlKHVpbnQyNTYgX2NhcCkgcHVibGljIHsKICAgIHJlcXVpcmUoX2NhcCA+IDApOwogICAgY2FwID0gX2NhcDsKICB9CgogIC8vIG92ZXJyaWRpbmcgQ3Jvd2RzYWxlI3ZhbGlkUHVyY2hhc2UgdG8gYWRkIGV4dHJhIGNhcCBsb2dpYwogIC8vIEByZXR1cm4gdHJ1ZSBpZiBpbnZlc3RvcnMgY2FuIGJ1eSBhdCB0aGUgbW9tZW50CiAgZnVuY3Rpb24gdmFsaWRQdXJjaGFzZSgpIGludGVybmFsICByZXR1cm5zIChib29sKSB7CiAgICBib29sIHdpdGhpbkNhcCA9IHdlaVJhaXNlZC5hZGQobXNnLnZhbHVlKSA8PSBjYXA7CiAgICByZXR1cm4gc3VwZXIudmFsaWRQdXJjaGFzZSgpICYmIHdpdGhpbkNhcDsKICB9CgogIC8vIG92ZXJyaWRpbmcgQ3Jvd2RzYWxlI2hhc0VuZGVkIHRvIGFkZCBjYXAgbG9naWMKICAvLyBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBlbmRlZAogIGZ1bmN0aW9uIGhhc0VuZGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgYm9vbCBjYXBSZWFjaGVkID0gd2VpUmFpc2VkID49IGNhcDsKICAgIHJldHVybiBzdXBlci5oYXNFbmRlZCgpIHx8IGNhcFJlYWNoZWQ7CiAgfQoKfQoKLy8gRmlsZTogY29udHJhY3RzXHplcHBlbGluXGNyb3dkc2FsZVxGaW5hbGl6YWJsZUNyb3dkc2FsZS5zb2wKCi8qKgogKiBAdGl0bGUgRmluYWxpemFibGVDcm93ZHNhbGUKICogQGRldiBFeHRlbnNpb24gb2YgQ3Jvd2RzYWxlIHdoZXJlIGFuIG93bmVyIGNhbiBkbyBleHRyYSB3b3JrCiAqIGFmdGVyIGZpbmlzaGluZy4KICovCmNvbnRyYWN0IEZpbmFsaXphYmxlQ3Jvd2RzYWxlIGlzIENyb3dkc2FsZSwgT3duYWJsZSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIGJvb2wgcHVibGljIGlzRmluYWxpemVkID0gZmFsc2U7CgogIGV2ZW50IEZpbmFsaXplZCgpOwoKICAvKioKICAgKiBAZGV2IE11c3QgYmUgY2FsbGVkIGFmdGVyIGNyb3dkc2FsZSBlbmRzLCB0byBkbyBzb21lIGV4dHJhIGZpbmFsaXphdGlvbgogICAqIHdvcmsuIENhbGxzIHRoZSBjb250cmFjdCdzIGZpbmFsaXphdGlvbiBmdW5jdGlvbi4KICAgKi8KICBmdW5jdGlvbiBmaW5hbGl6ZSgpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZSghaXNGaW5hbGl6ZWQpOwoKICAgIGZpbmFsaXphdGlvbigpOwogICAgRmluYWxpemVkKCk7CgogICAgaXNGaW5hbGl6ZWQgPSB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBDYW4gYmUgb3ZlcnJpZGRlbiB0byBhZGQgZmluYWxpemF0aW9uIGxvZ2ljLiBUaGUgb3ZlcnJpZGluZyBmdW5jdGlvbgogICAqIHNob3VsZCBjYWxsIHN1cGVyLmZpbmFsaXphdGlvbigpIHRvIGVuc3VyZSB0aGUgY2hhaW4gb2YgZmluYWxpemF0aW9uIGlzCiAgICogZXhlY3V0ZWQgZW50aXJlbHkuCiAgICovCiAgZnVuY3Rpb24gZmluYWxpemF0aW9uKCkgaW50ZXJuYWwgewogIH0KfQoKLy8gRmlsZTogY29udHJhY3RzXEJsb2NrcG9ydENyb3dkc2FsZS5zb2wKCi8vLyBAdGl0bGUgQmxvY2twb3J0IFRva2VuIC0gVG9rZW4gY29kZSBmb3Igb3VyIEJsb2NrcG9ydC5ubCBQcm9qZWN0Ci8vLyBAYXV0aG9yIEphbiBCb2xodWlzLCBXZXNsZXkgdmFuIEhlaWplCi8vICBWZXJzaW9uIDMsIEphbnVhcnkgMjAxOAovLyAgQmFzZWQgb24gT3BlbnplcHBlbGluIGZyYW1ld29yawovLwovLyAgVGhlIENyb3dkc2FsZSB3aWxsIHN0YXJ0IGFmdGVyIHRoZSBwcmVzYWxlIHdoaWNoIGhhZCBhIGNhcCBvZiA2LjQwMC4wMDAgQlBUIFRva2VucwovLyAgTWluaW11bSBwcmVzYWxlIGludmVzdG1lbnQgaW4gRXRoZXIgd2lsbCBiZSBzZXQgYXQgdGhlIHN0YXJ0OyBjYWxjdWxhdGVkIG9uIGEgd2Vla2x5IGF2YXJhZ2UgZm9yIGFuIGFtb3VudCBvZiB+IDEwMDAgRXVybwovLyAgVW5zb2xkIHByZXNhbGUgdG9rZW5zIHdpbGwgYmUgYnVybnQuIEltcGxlbWVudGVkIGJ5IHVzaW5nIE1pbnRlZFRva2VuLgovLyAgVGhlcmUgaXMgbm8gYm9udXMgaW4gdGhlIENyb3dkc2FsZS4KLy8gIFRoZSB0b3RhbCBzdXBwbHkgb2YgdG9rZW5zIChwcmUtc2FsZSArIGNyb3dkc2FsZSkgd2lsbCBiZSA0OSw2MDAsMDAwIEJQVAovLyAgTWluaW11bSBjcm93ZHNhbGUgaW52ZXN0bWVudCB3aWxsIGJlIDAuMSBldGhlcgovLyAgTWFjIGNhcCBmb3IgdGhlIGNyb3dkc2FsZSBpcyA0MywyMDAsMDAwIEJQVAovLyAKLy8gIApjb250cmFjdCBCbG9ja3BvcnRDcm93ZHNhbGUgaXMgQ2FwcGVkQ3Jvd2RzYWxlLCBGaW5hbGl6YWJsZUNyb3dkc2FsZSwgQ3Jvd2RzYWxlV2hpdGVsaXN0LCBQYXVzYWJsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICBhZGRyZXNzIHB1YmxpYyB0b2tlbkFkZHJlc3M7CiAgICBhZGRyZXNzIHB1YmxpYyB0ZWFtVmF1bHQ7CiAgICBhZGRyZXNzIHB1YmxpYyBjb21wYW55VmF1bHQ7CiAgICB1aW50MjU2IHB1YmxpYyBtaW5pbWFsSW52ZXN0bWVudEluV2VpID0gMC4xIGV0aGVyOwogICAgdWludDI1NiBwdWJsaWMgbWF4SW52ZXN0bWVudEluV2VpID0gNTAgZXRoZXI7CiAgICAKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgaW50ZXJuYWwgaW52ZXN0ZWQ7CgogICAgQmxvY2twb3J0VG9rZW4gcHVibGljIGJwVG9rZW47CgogICAgLy8gRXZlbnRzIGZvciB0aGlzIGNvbnRyYWN0CiAgICBldmVudCBJbml0aWFsUmF0ZUNoYW5nZSh1aW50MjU2IHJhdGUsIHVpbnQyNTYgY2FwKTsKICAgIGV2ZW50IEluaXRpYWxEYXRlQ2hhbmdlKHVpbnQyNTYgc3RhcnRUaW1lLCB1aW50MjU2IGVuZFRpbWUpOwoKICAgIC8vIEluaXRpYWxpc2UgY29udHJhY3Qgd2l0aCBwYXJhcGFtZXRycwogICAgLy9Abm90aWNlIEZ1bmN0aW9uIHRvIGluaXRpYWxpc2UgdGhlIHRva2VuIHdpdGggY29uZmlndXJhYmxlIHBhcmFtZXRlcnMuIAogICAgLy9AcGFyYW0gYCBfY2FwIC0gbWF4IG51bWJlciBvdCB0b2tlbnMgYXZhaWxhYmxlIGZvciB0aGUgcHJlc2FsZQogICAgLy9AcGFyYW0gYCBfZ29hbCAtIGdvYWwgY2FuIGJlIHNldCwgYmVsb3cgdGhpcyB2YWx1ZSB0aGUgQ3Jvd2RzYWxlIGJlY29tZXMgcmVmdW5kYWJsZQogICAgLy9AcGFyYW0gJyBfc3RhcnRUaW1lIC0gdGhpcyBpcyB0aGUgcGxhY2UgdG8gYWRhcHQgdGhlIHByZXNhbGUgcGVyaW9kCiAgICAvL0BwYXJhbSBgIF9lbmRUaW1lIC0gdGhpcyBpcyB0aGUgcGxhY2UgdG8gYWRhcHQgdGhlIHByZXNhbGUgcGVyaW9kCiAgICAvL0BwYXJhbSBgIHJhdGUgLSBpbml0aWFsIHByZXNhbGUgcmF0ZS4KICAgIC8vQHBhcmFtIGAgX3dhbGxldCAtIE11bHRpc2lnIHdhbGxldCB0aGUgaW52ZXN0bWVudHMgYXJlIGJlaW5nIHNlbmQgdG8gZHVyaW5nIHByZXNhbGUKICAgIC8vQHBhcmFtIGAgX3Rva2VuQWRkcmVzcyAtIFRva2VuIHRvIGJlIHVzZWQsIGNyZWF0ZWQgb3V0c2lkZSB0aGUgcHJzYWxlIGNvbnRyYWN0ICAKICAgIC8vQHBhcmFtIGAgX3RlYW1WYXVsdCAtIEV0aGVyIHNlbmQgdG8gdGhpcyBjb250cmFjdCB3aWxsIGJlIHN0b3JlZCAgYXQgdGhpcyBtdWx0aXNpZyB3YWxsZXQKICAgIGZ1bmN0aW9uIEJsb2NrcG9ydENyb3dkc2FsZSh1aW50MjU2IF9jYXAsIHVpbnQyNTYgX3N0YXJ0VGltZSwgdWludDI1NiBfZW5kVGltZSwgdWludDI1NiBfcmF0ZSwgYWRkcmVzcyBfd2FsbGV0LCBhZGRyZXNzIF90b2tlbkFkZHJlc3MsIGFkZHJlc3MgX3RlYW1WYXVsdCwgYWRkcmVzcyBfY29tcGFueVZhdWx0KSAKICAgICAgICBDYXBwZWRDcm93ZHNhbGUoX2NhcCkKICAgICAgICBDcm93ZHNhbGUoX3N0YXJ0VGltZSwgX2VuZFRpbWUsIF9yYXRlLCBfd2FsbGV0KSBwdWJsaWMgewogICAgICAgICAgICByZXF1aXJlKF90b2tlbkFkZHJlc3MgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgICAgIHJlcXVpcmUoX3RlYW1WYXVsdCAhPSBhZGRyZXNzKDApKTsKICAgICAgICAgICAgcmVxdWlyZShfY29tcGFueVZhdWx0ICE9IGFkZHJlc3MoMCkpOwogICAgICAgICAgICAKICAgICAgICAgICAgdG9rZW5BZGRyZXNzID0gX3Rva2VuQWRkcmVzczsKICAgICAgICAgICAgdG9rZW4gPSBjcmVhdGVUb2tlbkNvbnRyYWN0KCk7CiAgICAgICAgICAgIHRlYW1WYXVsdCA9IF90ZWFtVmF1bHQ7CiAgICAgICAgICAgIGNvbXBhbnlWYXVsdCA9IF9jb21wYW55VmF1bHQ7CiAgICB9CgogICAgLy9Abm90aWNlIEZ1bmN0aW9uIHRvIGNhc3QgdGhlIENhcHBlZCAoJm1pbnRhYmxlKSB0b2tlbiBwcm92aWRlZCB3aXRoIHRoZSBjb25zdHJ1Y3RvciB0byBhIGJsb2NrcG9ydHRva2VuIHRoYXQgaXMgbWludGFibGV0b2tlbi4KICAgIC8vIFRoaXMgaXMgYSB3b3JrYXJvdW5kIHRvIHN1cnBhc3MgYW4gaXNzdWUgdGhhdCBNaW50YWJsZXRva2VuIGZ1bmN0aW9ucyBhcmUgbm90IGFjY2Vzc2libGUgaW4gdGhpcyBjb250cmFjdC4KICAgIC8vIFdlIGRpZCBub3Qgd2FudCB0byBjaGFuZ2UgdGhlIE9wZW56ZXBwZWxpbiBjb2RlIGFuZCB3ZSBkaWQgbm90IGhhdmUgdGhlIHRpbWUgZm9yIGFuIGV4dGVuc2l2ZSBkcmlsbCBkb3duLgogICAgZnVuY3Rpb24gY3JlYXRlVG9rZW5Db250cmFjdCgpIGludGVybmFsIHJldHVybnMgKE1pbnRhYmxlVG9rZW4pIHsKICAgICAgICBicFRva2VuID0gQmxvY2twb3J0VG9rZW4odG9rZW5BZGRyZXNzKTsKICAgICAgICByZXR1cm4gQmxvY2twb3J0VG9rZW4odG9rZW5BZGRyZXNzKTsKICAgIH0KCiAgICAvLyBsb3cgbGV2ZWwgdG9rZW4gcHVyY2hhc2UgZnVuY3Rpb24KICAgIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgaW52ZXN0ZWRbYmVuZWZpY2lhcnldICs9IG1zZy52YWx1ZTsKICAgICAgICBzdXBlci5idXlUb2tlbnMoYmVuZWZpY2lhcnkpOwogICAgfQoKICAgIC8vIG92ZXJyaWRpbmcgQ3Jvd2RzYWxlI3ZhbGlkUHVyY2hhc2UgdG8gYWRkIGV4dHJhIGNhcCBsb2dpYwogICAgLy8gQHJldHVybiB0cnVlIGlmIGludmVzdG9ycyBjYW4gYnV5IGF0IHRoZSBtb21lbnQKICAgIGZ1bmN0aW9uIHZhbGlkUHVyY2hhc2UoKSBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7CiAgICAgICAgYm9vbCBtb3JlVGhhbk1pbmltYWxJbnZlc3RtZW50ID0gbXNnLnZhbHVlID49IG1pbmltYWxJbnZlc3RtZW50SW5XZWk7CiAgICAgICAgYm9vbCB3aGl0ZWxpc3RlZCA9IGFkZHJlc3NJc1doaXRlbGlzdGVkKG1zZy5zZW5kZXIpOwogICAgICAgIGJvb2wgbGVzc1RoYW5NYXhJbnZlc3RtZW50ID0gaW52ZXN0ZWRbbXNnLnNlbmRlcl0gPD0gbWF4SW52ZXN0bWVudEluV2VpOwoKICAgICAgICByZXR1cm4gc3VwZXIudmFsaWRQdXJjaGFzZSgpICYmIG1vcmVUaGFuTWluaW1hbEludmVzdG1lbnQgJiYgbGVzc1RoYW5NYXhJbnZlc3RtZW50ICYmICFwYXVzZWQgJiYgd2hpdGVsaXN0ZWQ7CiAgICB9CgogICAgLy9Abm90aWNlIEZ1bmN0aW9uIG92ZXJpZGRlbiBmdW5jdGlvbiB3aWxsIGZpbmFuYWxpc2UgdGhlIENyb3dkc2FsZQogICAgLy8gQWRkaXRpb25hbCB0b2tlbnMgYXJlIGFsbG9jYXRlZCB0byB0aGUgdGVhbSBhbmQgdG8gdGhlIGNvbXBhbnksIGFkZGluZyA0MCUgaW4gdG90YWwgdG8gdG9rZW5zIGFscmVhZHkgc29sZC4gCiAgICAvLyBBZnRlciBjYWxsaW5nIHRoaXMgZnVuY3Rpb24gdGhlIGJsb2NrcG9ydHRva2VuIGdhbiBiZSB0cmFuZmVyZWQgLyB0cmFkZWQgYnkgdGhlIGhvbGRlcnMgb2YgdGhpcyB0b2tlbi4KICAgIGZ1bmN0aW9uIGZpbmFsaXphdGlvbigpIGludGVybmFsIHsKICAgICAgICB1aW50MjU2IHRvdGFsU3VwcGx5ID0gdG9rZW4udG90YWxTdXBwbHkoKTsKICAgICAgICB1aW50MjU2IHR3ZW50eVBlcmNlbnRBbGxvY2F0aW9uID0gdG90YWxTdXBwbHkuZGl2KDUpOwoKICAgICAgICAvLyBtaW50IHRva2VucyBmb3IgdGhlIGZvdW5kYXRpb24KICAgICAgICB0b2tlbi5taW50KHRlYW1WYXVsdCwgdHdlbnR5UGVyY2VudEFsbG9jYXRpb24pOwogICAgICAgIHRva2VuLm1pbnQoY29tcGFueVZhdWx0LCB0d2VudHlQZXJjZW50QWxsb2NhdGlvbik7CgogICAgICAgIHRva2VuLmZpbmlzaE1pbnRpbmcoKTsgICAgICAgICAgICAgIC8vIE5vIG1vcmUgdG9rZW5zIGNhbiBiZSBhZGRlZCBmcm9tIG5vdwogICAgICAgIGJwVG9rZW4udW5wYXVzZSgpOyAgICAgICAgICAgICAgICAgIC8vIEVSQzIwIHRyYW5zZmVyIGZ1bmN0aW9ucyB3aWxsIHdvcmsgYWZ0ZXIgdGhpcyBzbyB0cmFkaW5nIGNhbiBzdGFydC4KICAgICAgICBzdXBlci5maW5hbGl6YXRpb24oKTsgICAgICAgICAgICAgICAvLyBmaW5hbGlzZSB1cCBpbiB0aGUgdHJlZQogICAgICAgIAogICAgICAgIGJwVG9rZW4udHJhbnNmZXJPd25lcnNoaXAob3duZXIpOyAgIC8vIHRyYW5zZmVyIHRva2VuIE93bmVyc2hpcCBiYWNrIHRvIG9yaWdpbmFsIG93bmVyCiAgICB9CgogICAgLy9Abm90aWNlIEZ1bmN0aW9uIHNldHMgdGhlIHRva2VuIGNvbnZlcnNpb24gcmF0ZSBpbiB0aGlzIGNvbnRyYWN0CiAgICAvL0BwYXJhbSBgIF9fcmF0ZUluV2VpIC0gUHJpY2Ugb2YgMSBCbG9ja3BvcnQgdG9rZW4gaW4gV2VpLiAKICAgIC8vQHBhcmFtIGAgX19jYXBJbldlaSAtIFByaWNlIG9mIDEgQmxvY2twb3J0IHRva2VuIGluIFdlaS4gCiAgICBmdW5jdGlvbiBzZXRSYXRlKHVpbnQyNTYgX3JhdGVJbldlaSwgdWludDI1NiBfY2FwSW5XZWkpIHB1YmxpYyBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgeyAKICAgICAgICByZXF1aXJlKHN0YXJ0VGltZSA+IGJsb2NrLnRpbWVzdGFtcCk7CiAgICAgICAgcmVxdWlyZShfcmF0ZUluV2VpID4gMCk7CiAgICAgICAgcmVxdWlyZShfY2FwSW5XZWkgPiAwKTsKCiAgICAgICAgcmF0ZSA9IF9yYXRlSW5XZWk7CiAgICAgICAgY2FwID0gX2NhcEluV2VpOwoKICAgICAgICBJbml0aWFsUmF0ZUNoYW5nZShyYXRlLCBjYXApOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vQG5vdGljZSBGdW5jdGlvbiBzZXRzIHN0YXJ0IGFuZCBlbmQgZGF0ZS90aW1lIGZvciB0aGlzIENyb3dkc2FsZS4gQ2FuIGJlIGNhbGxlZCBtdWx0aXBsZSB0aW1lcwogICAgLy9AcGFyYW0gJyBfc3RhcnRUaW1lIC0gdGhpcyBpcyB0aGUgcGxhY2UgdG8gYWRhcHQgdGhlIHByZXNhbGUgcGVyaW9kCiAgICAvL0BwYXJhbSBgIF9lbmRUaW1lIC0gdGhpcyBpcyB0aGUgcGxhY2UgdG8gYWRhcHQgdGhlIHByZXNhbGUgcGVyaW9kCiAgICBmdW5jdGlvbiBzZXRDcm93ZHNhbGVEYXRlcyh1aW50MjU2IF9zdGFydFRpbWUsIHVpbnQyNTYgX2VuZFRpbWUpIHB1YmxpYyBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgeyAKICAgICAgICByZXF1aXJlKHN0YXJ0VGltZSA+IGJsb2NrLnRpbWVzdGFtcCk7IC8vIGN1cnJlbnQgc3RhcnRUaW1lIGluIHRoZSBmdXR1cmUKICAgICAgICByZXF1aXJlKF9zdGFydFRpbWUgPj0gbm93KTsKICAgICAgICByZXF1aXJlKF9lbmRUaW1lID49IF9zdGFydFRpbWUpOwoKICAgICAgICBzdGFydFRpbWUgPSBfc3RhcnRUaW1lOwogICAgICAgIGVuZFRpbWUgPSBfZW5kVGltZTsKCiAgICAgICAgSW5pdGlhbERhdGVDaGFuZ2Uoc3RhcnRUaW1lLCBlbmRUaW1lKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQ=='.
	

]
