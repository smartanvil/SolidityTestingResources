Class {
	#name : #SRTa854529f651b26dd7d2dc5c10954ffc48357bb5b,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTa854529f651b26dd7d2dc5c10954ffc48357bb5b >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovLyBGaWxlOiBjb250cmFjdHMvSVByaWNpbmdTdHJhdGVneS5zb2wKCmludGVyZmFjZSBJUHJpY2luZ1N0cmF0ZWd5IHsKCiAgICBmdW5jdGlvbiBpc1ByaWNpbmdTdHJhdGVneSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwoKICAgIC8qKiBDYWxjdWxhdGUgdGhlIGN1cnJlbnQgcHJpY2UgZm9yIGJ1eSBpbiBhbW91bnQuICovCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVUb2tlbkFtb3VudCh1aW50IHdlaUFtb3VudCwgdWludCB0b2tlbnNTb2xkKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50IHRva2VuQW1vdW50KTsKCn0KCi8vIEZpbGU6IGNvbnRyYWN0cy90b2tlbi9FUkMyMjMuc29sCgpjb250cmFjdCBFUkMyMjMgewogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2RhdGEpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIAogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSwgYnl0ZXMgZGF0YSk7Cn0KCi8vIEZpbGU6IHplcHBlbGluLXNvbGlkaXR5L2NvbnRyYWN0cy9tYXRoL1NhZmVNYXRoLnNvbAoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL293bmVyc2hpcC9Pd25hYmxlLnNvbAoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL293bmVyc2hpcC9Db250YWN0YWJsZS5zb2wKCi8qKgogKiBAdGl0bGUgQ29udGFjdGFibGUgdG9rZW4KICogQGRldiBCYXNpYyB2ZXJzaW9uIG9mIGEgY29udGFjdGFibGUgY29udHJhY3QsIGFsbG93aW5nIHRoZSBvd25lciB0byBwcm92aWRlIGEgc3RyaW5nIHdpdGggdGhlaXIKICogY29udGFjdCBpbmZvcm1hdGlvbi4KICovCmNvbnRyYWN0IENvbnRhY3RhYmxlIGlzIE93bmFibGV7CgogICAgc3RyaW5nIHB1YmxpYyBjb250YWN0SW5mb3JtYXRpb247CgogICAgLyoqCiAgICAgKiBAZGV2IEFsbG93cyB0aGUgb3duZXIgdG8gc2V0IGEgc3RyaW5nIHdpdGggdGhlaXIgY29udGFjdCBpbmZvcm1hdGlvbi4KICAgICAqIEBwYXJhbSBpbmZvIFRoZSBjb250YWN0IGluZm9ybWF0aW9uIHRvIGF0dGFjaCB0byB0aGUgY29udHJhY3QuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldENvbnRhY3RJbmZvcm1hdGlvbihzdHJpbmcgaW5mbykgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgIGNvbnRhY3RJbmZvcm1hdGlvbiA9IGluZm87CiAgICAgfQp9CgovLyBGaWxlOiB6ZXBwZWxpbi1zb2xpZGl0eS9jb250cmFjdHMvdG9rZW4vRVJDMjBCYXNpYy5zb2wKCi8qKgogKiBAdGl0bGUgRVJDMjBCYXNpYwogKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE3OQogKi8KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCi8vIEZpbGU6IHplcHBlbGluLXNvbGlkaXR5L2NvbnRyYWN0cy90b2tlbi9FUkMyMC5zb2wKCi8qKgogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKi8KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy90b2tlbi9NaW50YWJsZVRva2VuLnNvbAoKY29udHJhY3QgTWludGFibGVUb2tlbiBpcyBFUkMyMCwgQ29udGFjdGFibGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBiYWxhbmNlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgcHVibGljIGhvbGRlckdyb3VwOwogICAgYm9vbCBwdWJsaWMgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CiAgICBhZGRyZXNzIHB1YmxpYyBtaW50ZXI7CgogICAgZXZlbnQgTWludGVyQ2hhbmdlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNNaW50ZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdNaW50ZXIpOwogICAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQgYW1vdW50KTsKICAgIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwoKICAgIG1vZGlmaWVyIGNhbk1pbnQoKSB7CiAgICAgICAgcmVxdWlyZSghbWludGluZ0ZpbmlzaGVkKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlNaW50ZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG1pbnRlcik7CiAgICAgICAgXzsKICAgIH0KCiAgICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBtaW50IHRva2VucwogICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgbWludGVkIHRva2Vucy4KICAgICAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIG1pbnQuCiAgICAgKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAgICovCiAgICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50IF9hbW91bnQsIHVpbnQgX2hvbGRlckdyb3VwKSBvbmx5TWludGVyIGNhbk1pbnQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfYW1vdW50KTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICAgICAgaG9sZGVyR3JvdXBbX3RvXSA9IF9ob2xkZXJHcm91cDsKICAgICAgICBNaW50KF90bywgX2Ftb3VudCk7CiAgICAgICAgVHJhbnNmZXIoYWRkcmVzcygwKSwgX3RvLCBfYW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gc3RvcCBtaW50aW5nIG5ldyB0b2tlbnMuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgICAqLwogICAgZnVuY3Rpb24gZmluaXNoTWludGluZygpIG9ubHlNaW50ZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIG1pbnRpbmdGaW5pc2hlZCA9IHRydWU7CiAgICAgICAgTWludEZpbmlzaGVkKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlTWludGVyKGFkZHJlc3MgX21pbnRlcikgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKF9taW50ZXIgIT0gMHgwKTsKICAgICAgICBNaW50ZXJDaGFuZ2VkKG1pbnRlciwgX21pbnRlcik7CiAgICAgICAgbWludGVyID0gX21pbnRlcjsKICAgIH0KfQoKLy8gRmlsZTogY29udHJhY3RzL3Rva2VuL1Rva2VuUmVjaWV2ZXIuc29sCgovKgogKiBDb250cmFjdCB0aGF0IGlzIHdvcmtpbmcgd2l0aCBFUkMyMjMgdG9rZW5zCiAqLwogCiBjb250cmFjdCBUb2tlblJlY2lldmVyIHsKICAgIGZ1bmN0aW9uIHRva2VuRmFsbGJhY2soYWRkcmVzcyBfZnJvbSwgdWludCBfdmFsdWUsIGJ5dGVzIF9kYXRhKSBwdWJsaWMgcHVyZSB7CiAgICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy90b2tlbi9IZXJvQ29pbi5zb2wKCmNvbnRyYWN0IEhlcm9Db2luIGlzIEVSQzIyMywgTWludGFibGVUb2tlbiB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKCiAgICBzdHJpbmcgY29uc3RhbnQgcHVibGljIG5hbWUgPSAiSGVyb0NvaW4iOwogICAgc3RyaW5nIGNvbnN0YW50IHB1YmxpYyBzeW1ib2wgPSAiSFJPIjsKICAgIHVpbnQgY29uc3RhbnQgcHVibGljIGRlY2ltYWxzID0gMTg7CgogICAgbWFwcGluZyhhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkpIGludGVybmFsIGFsbG93ZWQ7CgogICAgbWFwcGluZyAodWludCA9PiB1aW50KSBwdWJsaWMgYWN0aXZhdGlvblRpbWU7CgogICAgbW9kaWZpZXIgYWN0aXZlRm9ySG9sZGVyKGFkZHJlc3MgaG9sZGVyKSB7CiAgICAgICAgdWludCBncm91cCA9IGhvbGRlckdyb3VwW2hvbGRlcl07CiAgICAgICAgcmVxdWlyZShhY3RpdmF0aW9uVGltZVtncm91cF0gPD0gbm93KTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgYnl0ZXMgbWVtb3J5IGVtcHR5OwogICAgICAgIHJldHVybiB0cmFuc2ZlcihfdG8sIF92YWx1ZSwgZW1wdHkpOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAgICogQHBhcmFtIF9kYXRhIE9wdGlvbmFsIG1ldGFkYXRhLgogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSwgYnl0ZXMgX2RhdGEpIHB1YmxpYyBhY3RpdmVGb3JIb2xkZXIobXNnLnNlbmRlcikgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKCiAgICAgICAgLy8gU2FmZU1hdGguc3ViIHdpbGwgdGhyb3cgaWYgdGhlcmUgaXMgbm90IGVub3VnaCBiYWxhbmNlLgogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CgogICAgICAgIGlmIChpc0NvbnRyYWN0KF90bykpIHsKICAgICAgICAgICAgVG9rZW5SZWNpZXZlciByZWNlaXZlciA9IFRva2VuUmVjaWV2ZXIoX3RvKTsKICAgICAgICAgICAgcmVjZWl2ZXIudG9rZW5GYWxsYmFjayhtc2cuc2VuZGVyLCBfdmFsdWUsIF9kYXRhKTsKICAgICAgICB9CgogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSwgX2RhdGEpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAgICogQHJldHVybiBBbiB1aW50IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAgICovCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQgYmFsYW5jZSkgewogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgICAqIEBwYXJhbSBfdmFsdWUgdWludCB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBhY3RpdmVGb3JIb2xkZXIoX2Zyb20pIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgYnl0ZXMgbWVtb3J5IGVtcHR5OwogICAgICAgIHJldHVybiB0cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlLCBlbXB0eSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAgICogQHBhcmFtIF92YWx1ZSB1aW50IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICAgKiBAcGFyYW0gX2RhdGEgT3B0aW9uYWwgbWV0YWRhdGEuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUsIGJ5dGVzIF9kYXRhKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW19mcm9tXSk7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0pOwoKICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKCiAgICAgICAgaWYgKGlzQ29udHJhY3QoX3RvKSkgewogICAgICAgICAgICBUb2tlblJlY2lldmVyIHJlY2VpdmVyID0gVG9rZW5SZWNpZXZlcihfdG8pOwogICAgICAgICAgICByZWNlaXZlci50b2tlbkZhbGxiYWNrKG1zZy5zZW5kZXIsIF92YWx1ZSwgX2RhdGEpOwogICAgICAgIH0KCiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUsIF9kYXRhKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAgICoKICAgICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgICAqIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZSB0cmFuc2FjdGlvbiBvcmRlcmluZy4gT25lIHBvc3NpYmxlIHNvbHV0aW9uIHRvIG1pdGlnYXRlIHRoaXMKICAgICAqIHJhY2UgY29uZGl0aW9uIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUgYWZ0ZXJ3YXJkczoKICAgICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcmV0dXJuIEEgdWludCBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBJbmNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAgICoKICAgICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAogICAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX2FkZGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gaW5jcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgICAqLwogICAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBEZWNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAgICoKICAgICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGRlY3JlbWVudAogICAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX3N1YnRyYWN0ZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBkZWNyZWFzZSB0aGUgYWxsb3dhbmNlIGJ5LgogICAgICovCiAgICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICAgICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICAgICAgfQogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0QWN0aXZhdGlvblRpbWUodWludCBfaG9sZGVyR3JvdXAsIHVpbnQgX2FjdGl2YXRpb25UaW1lKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIGFjdGl2YXRpb25UaW1lW19ob2xkZXJHcm91cF0gPSBfYWN0aXZhdGlvblRpbWU7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0SG9sZGVyR3JvdXAoYWRkcmVzcyBfaG9sZGVyLCB1aW50IF9ob2xkZXJHcm91cCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICBob2xkZXJHcm91cFtfaG9sZGVyXSA9IF9ob2xkZXJHcm91cDsKICAgIH0KCiAgICBmdW5jdGlvbiBpc0NvbnRyYWN0KGFkZHJlc3MgX2FkZHIpIHByaXZhdGUgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgdWludCBsZW5ndGg7CiAgICAgICAgYXNzZW1ibHkgewogICAgICAgICAgICAgIC8vcmV0cmlldmUgdGhlIHNpemUgb2YgdGhlIGNvZGUgb24gdGFyZ2V0IGFkZHJlc3MsIHRoaXMgbmVlZHMgYXNzZW1ibHkKICAgICAgICAgICAgICBsZW5ndGggOj0gZXh0Y29kZXNpemUoX2FkZHIpCiAgICAgICAgfQogICAgICAgIHJldHVybiAobGVuZ3RoPjApOwogICAgfQp9CgovLyBGaWxlOiB6ZXBwZWxpbi1zb2xpZGl0eS9jb250cmFjdHMvbGlmZWN5Y2xlL1BhdXNhYmxlLnNvbAoKLyoqCiAqIEB0aXRsZSBQYXVzYWJsZQogKiBAZGV2IEJhc2UgY29udHJhY3Qgd2hpY2ggYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uCiAqLwpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKICBldmVudCBQYXVzZSgpOwogIGV2ZW50IFVucGF1c2UoKTsKCiAgYm9vbCBwdWJsaWMgcGF1c2VkID0gZmFsc2U7CgoKICAvKioKICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIG5vdCBwYXVzZWQuCiAgICovCiAgbW9kaWZpZXIgd2hlbk5vdFBhdXNlZCgpIHsKICAgIHJlcXVpcmUoIXBhdXNlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBwYXVzZWQuCiAgICovCiAgbW9kaWZpZXIgd2hlblBhdXNlZCgpIHsKICAgIHJlcXVpcmUocGF1c2VkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gcGF1c2UsIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUKICAgKi8KICBmdW5jdGlvbiBwYXVzZSgpIG9ubHlPd25lciB3aGVuTm90UGF1c2VkIHB1YmxpYyB7CiAgICBwYXVzZWQgPSB0cnVlOwogICAgUGF1c2UoKTsKICB9CgogIC8qKgogICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byB1bnBhdXNlLCByZXR1cm5zIHRvIG5vcm1hbCBzdGF0ZQogICAqLwogIGZ1bmN0aW9uIHVucGF1c2UoKSBvbmx5T3duZXIgd2hlblBhdXNlZCBwdWJsaWMgewogICAgcGF1c2VkID0gZmFsc2U7CiAgICBVbnBhdXNlKCk7CiAgfQp9CgovLyBGaWxlOiBjb250cmFjdHMvU2FsZUJhc2Uuc29sCgpjb250cmFjdCBTYWxlQmFzZSBpcyBQYXVzYWJsZSwgQ29udGFjdGFibGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CiAgCiAgICAvLyBUaGUgdG9rZW4gYmVpbmcgc29sZAogICAgSGVyb0NvaW4gcHVibGljIHRva2VuOwogIAogICAgLy8gc3RhcnQgYW5kIGVuZCB0aW1lc3RhbXBzIHdoZXJlIHB1cmNoYXNlcyBhcmUgYWxsb3dlZCAoYm90aCBpbmNsdXNpdmUpCiAgICB1aW50IHB1YmxpYyBzdGFydFRpbWU7CiAgICB1aW50IHB1YmxpYyBlbmRUaW1lOwogIAogICAgLy8gYWRkcmVzcyB3aGVyZSBmdW5kcyBhcmUgY29sbGVjdGVkCiAgICBhZGRyZXNzIHB1YmxpYyB3YWxsZXQ7CiAgCiAgICAvLyB0aGUgY29udHJhY3QsIHdoaWNoIGRldGVybWluZSBob3cgbWFueSB0b2tlbiB1bml0cyBhIGJ1eWVyIGdldHMgcGVyIHdlaQogICAgSVByaWNpbmdTdHJhdGVneSBwdWJsaWMgcHJpY2luZ1N0cmF0ZWd5OwogIAogICAgLy8gYW1vdW50IG9mIHJhaXNlZCBtb25leSBpbiB3ZWkKICAgIHVpbnQgcHVibGljIHdlaVJhaXNlZDsKCiAgICAvLyBhbW91bnQgb2YgdG9rZW5zIHRoYXQgd2FzIHNvbGQgb24gdGhlIGNyb3dkc2FsZQogICAgdWludCBwdWJsaWMgdG9rZW5zU29sZDsKCiAgICAvLyBtYXhpbXVtIGFtb3VudCBvZiB3ZWkgaW4gdG90YWwsIHRoYXQgY2FuIGJlIGJvdWdodAogICAgdWludCBwdWJsaWMgd2VpTWF4aW11bUdvYWw7CgogICAgLy8gaWYgd2VpTWluaW11bUdvYWwgd2lsbCBub3QgYmUgcmVhY2hlZCB0aWxsIGVuZFRpbWUsIGJ1eWVycyB3aWxsIGJlIGFibGUgdG8gcmVmdW5kIEVUSAogICAgdWludCBwdWJsaWMgd2VpTWluaW11bUdvYWw7CgogICAgLy8gbWluaW11bSBhbW91bnQgb2Ygd2VsLCB0aGF0IGNhbiBiZSBjb250cmlidXRlZAogICAgdWludCBwdWJsaWMgd2VpTWluaW11bUFtb3VudDsKCiAgICAvLyBIb3cgbWFueSBkaXN0aW5jdCBhZGRyZXNzZXMgaGF2ZSBib3VnaHQKICAgIHVpbnQgcHVibGljIGJ1eWVyQ291bnQ7CgogICAgLy8gaG93IG11Y2ggd2VpIHdlIGhhdmUgcmV0dXJuZWQgYmFjayB0byB0aGUgY29udHJhY3QgYWZ0ZXIgYSBmYWlsZWQgY3Jvd2RmdW5kCiAgICB1aW50IHB1YmxpYyBsb2FkZWRSZWZ1bmQ7CgogICAgLy8gaG93IG11Y2ggd2VpIHdlIGhhdmUgZ2l2ZW4gYmFjayB0byBidXllcnMKICAgIHVpbnQgcHVibGljIHdlaVJlZnVuZGVkOwoKICAgIC8vIGhvdyBtdWNoIEVUSCBlYWNoIGFkZHJlc3MgaGFzIGJvdWdodCB0byB0aGlzIGNyb3dkc2FsZQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgYm91Z2h0QW1vdW50T2Y7CgogICAgLy8gaG9sZGVyIGdyb3VwIG9mIHNhbGUgYnV5ZXJzLCBtdXN0IGJlIGRlZmluZWQgaW4gY2hpbGQgY29udHJhY3QKICAgIGZ1bmN0aW9uIGhvbGRlckdyb3VwTnVtYmVyKCkgcHVyZSByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgLyoqCiAgICAgKiBldmVudCBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAgICogQHBhcmFtIHB1cmNoYXNlciB3aG8gcGFpZCBmb3IgdGhlIHRva2VucwogICAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IHdobyBnb3QgdGhlIHRva2VucwogICAgICogQHBhcmFtIHZhbHVlIHdlaXMgcGFpZCBmb3IgcHVyY2hhc2UKICAgICAqIEBwYXJhbSB0b2tlbkFtb3VudCBhbW91bnQgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAgICovCiAgICBldmVudCBUb2tlblB1cmNoYXNlKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LAogICAgICAgIHVpbnQgdmFsdWUsCiAgICAgICAgdWludCB0b2tlbkFtb3VudAogICAgKTsKCiAgICAvLyBhIHJlZnVuZCB3YXMgcHJvY2Vzc2VkIGZvciBhbiBidXllcgogICAgZXZlbnQgUmVmdW5kKGFkZHJlc3MgYnV5ZXIsIHVpbnQgd2VpQW1vdW50KTsKCiAgICBmdW5jdGlvbiBTYWxlQmFzZSgKICAgICAgICB1aW50IF9zdGFydFRpbWUsCiAgICAgICAgdWludCBfZW5kVGltZSwKICAgICAgICBJUHJpY2luZ1N0cmF0ZWd5IF9wcmljaW5nU3RyYXRlZ3ksCiAgICAgICAgSGVyb0NvaW4gX3Rva2VuLAogICAgICAgIGFkZHJlc3MgX3dhbGxldCwKICAgICAgICB1aW50IF93ZWlNYXhpbXVtR29hbCwKICAgICAgICB1aW50IF93ZWlNaW5pbXVtR29hbCwKICAgICAgICB1aW50IF93ZWlNaW5pbXVtQW1vdW50CiAgICApIHB1YmxpYwogICAgewogICAgICAgIHJlcXVpcmUoX3ByaWNpbmdTdHJhdGVneS5pc1ByaWNpbmdTdHJhdGVneSgpKTsKICAgICAgICByZXF1aXJlKGFkZHJlc3MoX3Rva2VuKSAhPSAweDApOwogICAgICAgIHJlcXVpcmUoX3dhbGxldCAhPSAweDApOwogICAgICAgIHJlcXVpcmUoX3dlaU1heGltdW1Hb2FsID4gMCk7CgogICAgICAgIHNldFN0YXJ0VGltZShfc3RhcnRUaW1lKTsKICAgICAgICBzZXRFbmRUaW1lKF9lbmRUaW1lKTsKICAgICAgICBwcmljaW5nU3RyYXRlZ3kgPSBfcHJpY2luZ1N0cmF0ZWd5OwogICAgICAgIHRva2VuID0gX3Rva2VuOwogICAgICAgIHdhbGxldCA9IF93YWxsZXQ7CiAgICAgICAgd2VpTWF4aW11bUdvYWwgPSBfd2VpTWF4aW11bUdvYWw7CiAgICAgICAgd2VpTWluaW11bUdvYWwgPSBfd2VpTWluaW11bUdvYWw7CiAgICAgICAgd2VpTWluaW11bUFtb3VudCA9IF93ZWlNaW5pbXVtQW1vdW50OwogICAgfQoKICAgIC8vIGZhbGxiYWNrIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIGJ1eSB0b2tlbnMKICAgIGZ1bmN0aW9uICgpIGV4dGVybmFsIHBheWFibGUgewogICAgICAgIGJ1eVRva2Vucyhtc2cuc2VuZGVyKTsKICAgIH0KCiAgICAvLyBsb3cgbGV2ZWwgdG9rZW4gcHVyY2hhc2UgZnVuY3Rpb24KICAgIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgd2hlbk5vdFBhdXNlZCBwYXlhYmxlIHJldHVybnMgKGJvb2wpIHsKICAgICAgICB1aW50IHdlaUFtb3VudCA9IG1zZy52YWx1ZTsKCiAgICAgICAgcmVxdWlyZShiZW5lZmljaWFyeSAhPSAweDApOwogICAgICAgIHJlcXVpcmUodmFsaWRQdXJjaGFzZSh3ZWlBbW91bnQpKTsKICAgIAogICAgICAgIC8vIGNhbGN1bGF0ZSB0b2tlbiBhbW91bnQgdG8gYmUgY3JlYXRlZAogICAgICAgIHVpbnQgdG9rZW5BbW91bnQgPSBwcmljaW5nU3RyYXRlZ3kuY2FsY3VsYXRlVG9rZW5BbW91bnQod2VpQW1vdW50LCB0b2tlbnNTb2xkKTsKICAgICAgICAKICAgICAgICBtaW50VG9rZW5Ub0J1eWVyKGJlbmVmaWNpYXJ5LCB0b2tlbkFtb3VudCwgd2VpQW1vdW50KTsKICAgICAgICAKICAgICAgICB3YWxsZXQudHJhbnNmZXIobXNnLnZhbHVlKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gbWludFRva2VuVG9CdXllcihhZGRyZXNzIGJlbmVmaWNpYXJ5LCB1aW50IHRva2VuQW1vdW50LCB1aW50IHdlaUFtb3VudCkgaW50ZXJuYWwgewogICAgICAgIGlmIChib3VnaHRBbW91bnRPZltiZW5lZmljaWFyeV0gPT0gMCkgewogICAgICAgICAgICAvLyBBIG5ldyBidXllcgogICAgICAgICAgICBidXllckNvdW50Kys7CiAgICAgICAgfQoKICAgICAgICBib3VnaHRBbW91bnRPZltiZW5lZmljaWFyeV0gPSBib3VnaHRBbW91bnRPZltiZW5lZmljaWFyeV0uYWRkKHdlaUFtb3VudCk7CiAgICAgICAgd2VpUmFpc2VkID0gd2VpUmFpc2VkLmFkZCh3ZWlBbW91bnQpOwogICAgICAgIHRva2Vuc1NvbGQgPSB0b2tlbnNTb2xkLmFkZCh0b2tlbkFtb3VudCk7CiAgICAKICAgICAgICB0b2tlbi5taW50KGJlbmVmaWNpYXJ5LCB0b2tlbkFtb3VudCwgaG9sZGVyR3JvdXBOdW1iZXIoKSk7CiAgICAgICAgVG9rZW5QdXJjaGFzZShtc2cuc2VuZGVyLCBiZW5lZmljaWFyeSwgd2VpQW1vdW50LCB0b2tlbkFtb3VudCk7CiAgICB9CgogICAgLy8gcmV0dXJuIHRydWUgaWYgdGhlIHRyYW5zYWN0aW9uIGNhbiBidXkgdG9rZW5zCiAgICBmdW5jdGlvbiB2YWxpZFB1cmNoYXNlKHVpbnQgd2VpQW1vdW50KSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgYm9vbCB3aXRoaW5QZXJpb2QgPSBub3cgPj0gc3RhcnRUaW1lICYmIG5vdyA8PSBlbmRUaW1lOwogICAgICAgIGJvb2wgd2l0aGluQ2FwID0gd2VpUmFpc2VkLmFkZCh3ZWlBbW91bnQpIDw9IHdlaU1heGltdW1Hb2FsOwogICAgICAgIGJvb2wgbW9yZVRoZW5NaW5pbXVtID0gd2VpQW1vdW50ID49IHdlaU1pbmltdW1BbW91bnQ7CgogICAgICAgIHJldHVybiB3aXRoaW5QZXJpb2QgJiYgd2l0aGluQ2FwICYmIG1vcmVUaGVuTWluaW11bTsKICAgIH0KCiAgICAvLyByZXR1cm4gdHJ1ZSBpZiBjcm93ZHNhbGUgZXZlbnQgaGFzIGVuZGVkCiAgICBmdW5jdGlvbiBoYXNFbmRlZCgpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICBib29sIGNhcFJlYWNoZWQgPSB3ZWlSYWlzZWQgPj0gd2VpTWF4aW11bUdvYWw7CiAgICAgICAgYm9vbCBhZnRlckVuZFRpbWUgPSBub3cgPiBlbmRUaW1lOwogICAgICAgIAogICAgICAgIHJldHVybiBjYXBSZWFjaGVkIHx8IGFmdGVyRW5kVGltZTsKICAgIH0KCiAgICAvLyBnZXQgdGhlIGFtb3VudCBvZiB1bnNvbGQgdG9rZW5zIGFsbG9jYXRlZCB0byB0aGlzIGNvbnRyYWN0OwogICAgZnVuY3Rpb24gZ2V0V2VpTGVmdCgpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gd2VpTWF4aW11bUdvYWwgLSB3ZWlSYWlzZWQ7CiAgICB9CgogICAgLy8gcmV0dXJuIHRydWUgaWYgdGhlIGNyb3dkc2FsZSBoYXMgcmFpc2VkIGVub3VnaCBtb25leSB0byBiZSBhIHN1Y2Nlc3NmdWwuCiAgICBmdW5jdGlvbiBpc01pbmltdW1Hb2FsUmVhY2hlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHdlaVJhaXNlZCA+PSB3ZWlNaW5pbXVtR29hbDsKICAgIH0KICAgIAogICAgLy8gYWxsb3dzIHRvIHVwZGF0ZSB0b2tlbnMgcmF0ZSBmb3Igb3duZXIKICAgIGZ1bmN0aW9uIHNldFByaWNpbmdTdHJhdGVneShJUHJpY2luZ1N0cmF0ZWd5IF9wcmljaW5nU3RyYXRlZ3kpIGV4dGVybmFsIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICAgICAgcHJpY2luZ1N0cmF0ZWd5ID0gX3ByaWNpbmdTdHJhdGVneTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICogQWxsb3cgbG9hZCByZWZ1bmRzIGJhY2sgb24gdGhlIGNvbnRyYWN0IGZvciB0aGUgcmVmdW5kaW5nLgogICAgKgogICAgKiBUaGUgdGVhbSBjYW4gdHJhbnNmZXIgdGhlIGZ1bmRzIGJhY2sgb24gdGhlIHNtYXJ0IGNvbnRyYWN0IGluIHRoZSBjYXNlIHRoZSBtaW5pbXVtIGdvYWwgd2FzIG5vdCByZWFjaGVkLi4KICAgICovCiAgICBmdW5jdGlvbiBsb2FkUmVmdW5kKCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPiAwKTsKICAgICAgICByZXF1aXJlKCFpc01pbmltdW1Hb2FsUmVhY2hlZCgpKTsKICAgICAgICAKICAgICAgICBsb2FkZWRSZWZ1bmQgPSBsb2FkZWRSZWZ1bmQuYWRkKG1zZy52YWx1ZSk7CiAgICB9CgogICAgLyoqCiAgICAqIEJ1eWVycyBjYW4gY2xhaW0gcmVmdW5kLgogICAgKgogICAgKiBOb3RlIHRoYXQgYW55IHJlZnVuZHMgZnJvbSBwcm94eSBidXllcnMgc2hvdWxkIGJlIGhhbmRsZWQgc2VwYXJhdGVseSwKICAgICogYW5kIG5vdCB0aHJvdWdoIHRoaXMgY29udHJhY3QuCiAgICAqLwogICAgZnVuY3Rpb24gcmVmdW5kKCkgZXh0ZXJuYWwgewogICAgICAgIHJlcXVpcmUoIWlzTWluaW11bUdvYWxSZWFjaGVkKCkgJiYgbG9hZGVkUmVmdW5kID4gMCk7CiAgICAgICAgdWludDI1NiB3ZWlWYWx1ZSA9IGJvdWdodEFtb3VudE9mW21zZy5zZW5kZXJdOwogICAgICAgIHJlcXVpcmUod2VpVmFsdWUgPiAwKTsKICAgICAgICAKICAgICAgICBib3VnaHRBbW91bnRPZlttc2cuc2VuZGVyXSA9IDA7CiAgICAgICAgd2VpUmVmdW5kZWQgPSB3ZWlSZWZ1bmRlZC5hZGQod2VpVmFsdWUpOwogICAgICAgIFJlZnVuZChtc2cuc2VuZGVyLCB3ZWlWYWx1ZSk7CiAgICAgICAgbXNnLnNlbmRlci50cmFuc2Zlcih3ZWlWYWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0U3RhcnRUaW1lKHVpbnQgX3N0YXJ0VGltZSkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShfc3RhcnRUaW1lID49IG5vdyk7CiAgICAgICAgc3RhcnRUaW1lID0gX3N0YXJ0VGltZTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRFbmRUaW1lKHVpbnQgX2VuZFRpbWUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoX2VuZFRpbWUgPj0gc3RhcnRUaW1lKTsKICAgICAgICBlbmRUaW1lID0gX2VuZFRpbWU7CiAgICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9wcmVzYWxlL1ByZXNhbGUuc29sCgovKioKICogQHRpdGxlIFByZXNhbGUKICogQGRldiBQcmVzYWxlIGlzIGEgY29udHJhY3QgZm9yIG1hbmFnaW5nIGEgdG9rZW4gY3Jvd2RzYWxlLgogKiBQcmVzYWxlcyBoYXZlIGEgc3RhcnQgYW5kIGVuZCB0aW1lc3RhbXBzLCB3aGVyZSBidXllcnMgY2FuIG1ha2UKICogdG9rZW4gcHVyY2hhc2VzIGFuZCB0aGUgY3Jvd2RzYWxlIHdpbGwgYXNzaWduIHRoZW0gdG9rZW5zIGJhc2VkCiAqIG9uIGEgdG9rZW4gcGVyIEVUSCByYXRlLiBGdW5kcyBjb2xsZWN0ZWQgYXJlIGZvcndhcmRlZCB0byBhIHdhbGxldAogKiBhcyB0aGV5IGFycml2ZS4KICovCmNvbnRyYWN0IFByZXNhbGUgaXMgU2FsZUJhc2UgewogICAgZnVuY3Rpb24gUHJlc2FsZSgKICAgICAgICB1aW50IF9zdGFydFRpbWUsCiAgICAgICAgdWludCBfZW5kVGltZSwKICAgICAgICBJUHJpY2luZ1N0cmF0ZWd5IF9wcmljaW5nU3RyYXRlZ3ksCiAgICAgICAgSGVyb0NvaW4gX3Rva2VuLAogICAgICAgIGFkZHJlc3MgX3dhbGxldCwKICAgICAgICB1aW50IF93ZWlNYXhpbXVtR29hbCwKICAgICAgICB1aW50IF93ZWlNaW5pbXVtR29hbCwKICAgICAgICB1aW50IF93ZWlNaW5pbXVtQW1vdW50CiAgICApIHB1YmxpYyBTYWxlQmFzZSgKICAgICAgICBfc3RhcnRUaW1lLAogICAgICAgIF9lbmRUaW1lLAogICAgICAgIF9wcmljaW5nU3RyYXRlZ3ksCiAgICAgICAgX3Rva2VuLAogICAgICAgIF93YWxsZXQsCiAgICAgICAgX3dlaU1heGltdW1Hb2FsLAogICAgICAgIF93ZWlNaW5pbXVtR29hbCwKICAgICAgICBfd2VpTWluaW11bUFtb3VudCkgCiAgICB7CgogICAgfQoKICAgIGZ1bmN0aW9uIGhvbGRlckdyb3VwTnVtYmVyKCkgcHVibGljIHB1cmUgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiAxOwogICAgfQp9'.
	

]
