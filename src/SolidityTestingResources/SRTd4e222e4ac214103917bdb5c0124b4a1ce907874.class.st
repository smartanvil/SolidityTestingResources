Class {
	#name : #SRTd4e222e4ac214103917bdb5c0124b4a1ce907874,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd4e222e4ac214103917bdb5c0124b4a1ce907874 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7Cgpjb250cmFjdCBJVG9rZW4gewogICAgZnVuY3Rpb24gZXhlY3V0ZVNldHRpbmdzQ2hhbmdlKAogICAgICAgIHVpbnQgYW1vdW50LCAKICAgICAgICB1aW50IHBhcnRJbnZlc3RvciwKICAgICAgICB1aW50IHBhcnRQcm9qZWN0LCAKICAgICAgICB1aW50IHBhcnRGb3VuZGVycywgCiAgICAgICAgdWludCBibG9ja3NQZXJTdGFnZSwgCiAgICAgICAgdWludCBwYXJ0SW52ZXN0b3JJbmNyZWFzZVBlclN0YWdlLAogICAgICAgIHVpbnQgbWF4U3RhZ2VzCiAgICApOwp9CgoKY29udHJhY3QgTXVsdGlTaWdXYWxsZXQgewoKICAgIHVpbnQgY29uc3RhbnQgcHVibGljIE1BWF9PV05FUl9DT1VOVCA9IDUwOwogICAgbWFwcGluZyAodWludCA9PiBUcmFuc2FjdGlvbikgcHVibGljIHRyYW5zYWN0aW9uczsKICAgIG1hcHBpbmcgKHVpbnQgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSkgcHVibGljIGNvbmZpcm1hdGlvbnM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBpc093bmVyOwogICAgYWRkcmVzc1tdIHB1YmxpYyBvd25lcnM7CiAgICBhZGRyZXNzIG93bmVyOyAvL3RoZSBvbmUgd2hvIGNyZWF0ZXMgdGhlIGNvbnRyYWN0LCBvbmx5IHRoaXMgcGVyc29uIGNhbiBzZXQgdGhlIHRva2VuCiAgICB1aW50IHB1YmxpYyByZXF1aXJlZDsKICAgIHVpbnQgcHVibGljIHRyYW5zYWN0aW9uQ291bnQ7CgogICAgZXZlbnQgQ29uZmlybWF0aW9uKGFkZHJlc3MgaW5kZXhlZCBzZW5kZXIsIHVpbnQgaW5kZXhlZCB0cmFuc2FjdGlvbklkKTsKICAgIGV2ZW50IFJldm9jYXRpb24oYWRkcmVzcyBpbmRleGVkIHNlbmRlciwgdWludCBpbmRleGVkIHRyYW5zYWN0aW9uSWQpOwogICAgZXZlbnQgU3VibWlzc2lvbih1aW50IGluZGV4ZWQgdHJhbnNhY3Rpb25JZCk7CiAgICBldmVudCBFeGVjdXRpb24odWludCBpbmRleGVkIHRyYW5zYWN0aW9uSWQpOwogICAgZXZlbnQgRXhlY3V0aW9uRmFpbHVyZSh1aW50IGluZGV4ZWQgdHJhbnNhY3Rpb25JZCk7CiAgICBldmVudCBEZXBvc2l0KGFkZHJlc3MgaW5kZXhlZCBzZW5kZXIsIHVpbnQgdmFsdWUpOwogICAgZXZlbnQgT3duZXJBZGRpdGlvbihhZGRyZXNzIGluZGV4ZWQgb3duZXIpOwogICAgZXZlbnQgT3duZXJSZW1vdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lcik7CiAgICBldmVudCBSZXF1aXJlbWVudENoYW5nZSh1aW50IHJlcXVpcmVkKTsKICAgCiAgICBJVG9rZW4gcHVibGljIHRva2VuOwoKICAgIHN0cnVjdCBTZXR0aW5nc1JlcXVlc3QgewogICAgICAgIHVpbnQgYW1vdW50OwogICAgICAgIHVpbnQgcGFydEludmVzdG9yOwogICAgICAgIHVpbnQgcGFydFByb2plY3Q7CiAgICAgICAgdWludCBwYXJ0Rm91bmRlcnM7CiAgICAgICAgdWludCBibG9ja3NQZXJTdGFnZTsKICAgICAgICB1aW50IHBhcnRJbnZlc3RvckluY3JlYXNlUGVyU3RhZ2U7CiAgICAgICAgdWludCBtYXhTdGFnZXM7CiAgICAgICAgYm9vbCBleGVjdXRlZDsKICAgICAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgY29uZmlybWF0aW9uczsKICAgIH0KCiAgICB1aW50IHNldHRpbmdzUmVxdWVzdHNDb3VudCA9IDA7CiAgICBtYXBwaW5nKHVpbnQgPT4gU2V0dGluZ3NSZXF1ZXN0KSBzZXR0aW5nc1JlcXVlc3RzOwoKICAgIHN0cnVjdCBUcmFuc2FjdGlvbiB7IAogICAgICAgIGFkZHJlc3MgZGVzdGluYXRpb247CiAgICAgICAgdWludCB2YWx1ZTsKICAgICAgICBieXRlcyBkYXRhOwogICAgICAgIGJvb2wgZXhlY3V0ZWQ7CiAgICB9CgogICAgbW9kaWZpZXIgb25seVdhbGxldCgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYWRkcmVzcyh0aGlzKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICBtb2RpZmllciBvd25lckRvZXNOb3RFeGlzdChhZGRyZXNzIF9vd25lcikgewogICAgICAgIHJlcXVpcmUoIWlzT3duZXJbX293bmVyXSk7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgbW9kaWZpZXIgb3duZXJFeGlzdHMoYWRkcmVzcyBfb3duZXIpIHsKICAgICAgICByZXF1aXJlKGlzT3duZXJbX293bmVyXSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciB0cmFuc2FjdGlvbkV4aXN0cyh1aW50IF90cmFuc2FjdGlvbklkKSB7CiAgICAgICAgcmVxdWlyZSh0cmFuc2FjdGlvbnNbX3RyYW5zYWN0aW9uSWRdLmRlc3RpbmF0aW9uICE9IDApOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgY29uZmlybWVkKHVpbnQgX3RyYW5zYWN0aW9uSWQsIGFkZHJlc3MgX293bmVyKSB7CiAgICAgICAgcmVxdWlyZShjb25maXJtYXRpb25zW190cmFuc2FjdGlvbklkXVtfb3duZXJdKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG5vdENvbmZpcm1lZCh1aW50IF90cmFuc2FjdGlvbklkLCBhZGRyZXNzIF9vd25lcikgewogICAgICAgIHJlcXVpcmUoIWNvbmZpcm1hdGlvbnNbX3RyYW5zYWN0aW9uSWRdW19vd25lcl0pOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgbm90RXhlY3V0ZWQodWludCBfdHJhbnNhY3Rpb25JZCkgewogICAgICAgIHJlcXVpcmUoIXRyYW5zYWN0aW9uc1tfdHJhbnNhY3Rpb25JZF0uZXhlY3V0ZWQpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgbm90TnVsbChhZGRyZXNzIF9hZGRyZXNzKSB7CiAgICAgICAgcmVxdWlyZShfYWRkcmVzcyAhPSAwKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIHZhbGlkUmVxdWlyZW1lbnQodWludCBfb3duZXJDb3VudCwgdWludCBfcmVxdWlyZWQpIHsKICAgICAgICByZXF1aXJlKF9vd25lckNvdW50IDwgTUFYX09XTkVSX0NPVU5UCiAgICAgICAgICAgICYmIF9yZXF1aXJlZCA8PSBfb3duZXJDb3VudAogICAgICAgICAgICAmJiBfcmVxdWlyZWQgIT0gMAogICAgICAgICAgICAmJiBfb3duZXJDb3VudCAhPSAwKTsKICAgICAgICBfOwogICAgfQoKICAgIC8vLyBAZGV2IEZhbGxiYWNrIGZ1bmN0aW9uIGFsbG93cyB0byBkZXBvc2l0IGV0aGVyLgogICAgZnVuY3Rpb24oKSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgaWYgKG1zZy52YWx1ZSA+IDApCiAgICAgICAgICAgIERlcG9zaXQobXNnLnNlbmRlciwgbXNnLnZhbHVlKTsKICAgIH0KCiAgICAvLy8gQGRldiBDb250cmFjdCBjb25zdHJ1Y3RvciBzZXRzIGluaXRpYWwgb3duZXJzIGFuZCByZXF1aXJlZCBudW1iZXIgb2YgY29uZmlybWF0aW9ucy4KICAgIC8vLyBAcGFyYW0gX293bmVycyBMaXN0IG9mIGluaXRpYWwgb3duZXJzLgogICAgLy8vIEBwYXJhbSBfcmVxdWlyZWQgTnVtYmVyIG9mIHJlcXVpcmVkIGNvbmZpcm1hdGlvbnMuCiAgICBmdW5jdGlvbiBNdWx0aVNpZ1dhbGxldChhZGRyZXNzW10gX293bmVycywgdWludCBfcmVxdWlyZWQpIHB1YmxpYyB2YWxpZFJlcXVpcmVtZW50KF9vd25lcnMubGVuZ3RoLCBfcmVxdWlyZWQpIHsKICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPF9vd25lcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgcmVxdWlyZSghaXNPd25lcltfb3duZXJzW2ldXSAmJiBfb3duZXJzW2ldICE9IDApOwogICAgICAgICAgICBpc093bmVyW19vd25lcnNbaV1dID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgb3duZXJzID0gX293bmVyczsKICAgICAgICByZXF1aXJlZCA9IF9yZXF1aXJlZDsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0VG9rZW4oYWRkcmVzcyBfdG9rZW4pIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUodG9rZW4gPT0gYWRkcmVzcygwKSk7CiAgICAgICAgdG9rZW4gPSBJVG9rZW4oX3Rva2VuKTsKICAgIH0KCiAgICAvLy0tLS0tLS0tLS0tLS0tLS0gVEdFIFNFVFRJTkdTIC0tLS0tLS0tLS0tCiAgICAvLy8gQGRldiBTZW5kcyByZXF1ZXN0IHRvIGNoYW5nZSBzZXR0aW5ncwogICAgLy8vIEByZXR1cm4gVHJhbnNhY3Rpb24gSUQKICAgIGZ1bmN0aW9uIHRnZVNldHRpbmdzQ2hhbmdlUmVxdWVzdCgKICAgICAgICB1aW50IGFtb3VudCwgCiAgICAgICAgdWludCBwYXJ0SW52ZXN0b3IsCiAgICAgICAgdWludCBwYXJ0UHJvamVjdCwgCiAgICAgICAgdWludCBwYXJ0Rm91bmRlcnMsIAogICAgICAgIHVpbnQgYmxvY2tzUGVyU3RhZ2UsIAogICAgICAgIHVpbnQgcGFydEludmVzdG9ySW5jcmVhc2VQZXJTdGFnZSwKICAgICAgICB1aW50IG1heFN0YWdlcwogICAgKSAKICAgIHB1YmxpYwogICAgb3duZXJFeGlzdHMobXNnLnNlbmRlcikKICAgIHJldHVybnMgKHVpbnQgX3R4SW5kZXgpIAogICAgewogICAgICAgIGFzc2VydChhbW91bnQqcGFydEludmVzdG9yKnBhcnRQcm9qZWN0KmJsb2Nrc1BlclN0YWdlKnBhcnRJbnZlc3RvckluY3JlYXNlUGVyU3RhZ2UqbWF4U3RhZ2VzICE9IDApOyAvL2Fzc2VydGluZyBubyBwYXJhbWV0ZXIgaXMgemVybyBleGNlcHQgcGFydEZvdW5kZXJzCiAgICAgICAgX3R4SW5kZXggPSBzZXR0aW5nc1JlcXVlc3RzQ291bnQ7CiAgICAgICAgc2V0dGluZ3NSZXF1ZXN0c1tfdHhJbmRleF0gPSBTZXR0aW5nc1JlcXVlc3QoewogICAgICAgICAgICBhbW91bnQ6IGFtb3VudCwKICAgICAgICAgICAgcGFydEludmVzdG9yOiBwYXJ0SW52ZXN0b3IsCiAgICAgICAgICAgIHBhcnRQcm9qZWN0OiBwYXJ0UHJvamVjdCwKICAgICAgICAgICAgcGFydEZvdW5kZXJzOiBwYXJ0Rm91bmRlcnMsCiAgICAgICAgICAgIGJsb2Nrc1BlclN0YWdlOiBibG9ja3NQZXJTdGFnZSwKICAgICAgICAgICAgcGFydEludmVzdG9ySW5jcmVhc2VQZXJTdGFnZTogcGFydEludmVzdG9ySW5jcmVhc2VQZXJTdGFnZSwKICAgICAgICAgICAgbWF4U3RhZ2VzOiBtYXhTdGFnZXMsCiAgICAgICAgICAgIGV4ZWN1dGVkOiBmYWxzZQogICAgICAgIH0pOwogICAgICAgIHNldHRpbmdzUmVxdWVzdHNDb3VudCsrOwogICAgICAgIGNvbmZpcm1TZXR0aW5nc0NoYW5nZShfdHhJbmRleCk7CiAgICAgICAgcmV0dXJuIF90eEluZGV4OwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyBhbiBvd25lciB0byBjb25maXJtIGEgY2hhbmdlIHNldHRpbmdzIHJlcXVlc3QuCiAgICAvLy8gQHBhcmFtIF90eEluZGV4IFRyYW5zYWN0aW9uIElELgogICAgZnVuY3Rpb24gY29uZmlybVNldHRpbmdzQ2hhbmdlKHVpbnQgX3R4SW5kZXgpIHB1YmxpYyBvd25lckV4aXN0cyhtc2cuc2VuZGVyKSByZXR1cm5zKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoc2V0dGluZ3NSZXF1ZXN0c1tfdHhJbmRleF0uZXhlY3V0ZWQgPT0gZmFsc2UpOwogICAgICAgIHNldHRpbmdzUmVxdWVzdHNbX3R4SW5kZXhdLmNvbmZpcm1hdGlvbnNbbXNnLnNlbmRlcl0gPSB0cnVlOwogICAgICAgIGlmKGlzQ29uZmlybWVkU2V0dGluZ3NSZXF1ZXN0KF90eEluZGV4KSl7CiAgICAgICAgICAgIFNldHRpbmdzUmVxdWVzdCBzdG9yYWdlIHJlcXVlc3QgPSBzZXR0aW5nc1JlcXVlc3RzW190eEluZGV4XTsKICAgICAgICAgICAgcmVxdWVzdC5leGVjdXRlZCA9IHRydWU7CiAgICAgICAgICAgIElUb2tlbih0b2tlbikuZXhlY3V0ZVNldHRpbmdzQ2hhbmdlKAogICAgICAgICAgICAgICAgcmVxdWVzdC5hbW91bnQsIAogICAgICAgICAgICAgICAgcmVxdWVzdC5wYXJ0SW52ZXN0b3IsCiAgICAgICAgICAgICAgICByZXF1ZXN0LnBhcnRQcm9qZWN0LAogICAgICAgICAgICAgICAgcmVxdWVzdC5wYXJ0Rm91bmRlcnMsCiAgICAgICAgICAgICAgICByZXF1ZXN0LmJsb2Nrc1BlclN0YWdlLAogICAgICAgICAgICAgICAgcmVxdWVzdC5wYXJ0SW52ZXN0b3JJbmNyZWFzZVBlclN0YWdlLAogICAgICAgICAgICAgICAgcmVxdWVzdC5tYXhTdGFnZXMKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBpc0NvbmZpcm1lZFNldHRpbmdzUmVxdWVzdCh1aW50IF90cmFuc2FjdGlvbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgdWludCBjb3VudCA9IDA7CiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgb3duZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChzZXR0aW5nc1JlcXVlc3RzW190cmFuc2FjdGlvbklkXS5jb25maXJtYXRpb25zW293bmVyc1tpXV0pCiAgICAgICAgICAgICAgICBjb3VudCArPSAxOwogICAgICAgICAgICBpZiAoY291bnQgPT0gcmVxdWlyZWQpCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFNldHRpbmdzQ2hhbmdlQ29uZmlybWF0aW9uQ291bnQodWludCBfdHhJbmRleCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCBjb3VudCkgewogICAgICAgIGZvciAodWludCBpPTA7IGk8b3duZXJzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBpZiAoc2V0dGluZ3NSZXF1ZXN0c1tfdHhJbmRleF0uY29uZmlybWF0aW9uc1tvd25lcnNbaV1dKQogICAgICAgICAgICAgICAgY291bnQgKz0gMTsKICAgIH0KCiAgICAvLy8gQGRldiBTaG93cyB3aGF0IHNldHRpbmdzIHdlcmUgcmVxdWVzdGVkIGluIGEgc2V0dGluZ3MgY2hhbmdlIHJlcXVlc3QKICAgIGZ1bmN0aW9uIHZpZXdTZXR0aW5nc0NoYW5nZSh1aW50IF90eEluZGV4KSBwdWJsaWMgY29uc3RhbnQgCiAgICByZXR1cm5zICh1aW50IGFtb3VudCwgdWludCBwYXJ0SW52ZXN0b3IsIHVpbnQgcGFydFByb2plY3QsIHVpbnQgcGFydEZvdW5kZXJzLCB1aW50IGJsb2Nrc1BlclN0YWdlLCB1aW50IHBhcnRJbnZlc3RvckluY3JlYXNlUGVyU3RhZ2UsIHVpbnQgbWF4U3RhZ2VzKSB7CiAgICAgICAgU2V0dGluZ3NSZXF1ZXN0IG1lbW9yeSByZXF1ZXN0ID0gc2V0dGluZ3NSZXF1ZXN0c1tfdHhJbmRleF07CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgcmVxdWVzdC5hbW91bnQsCiAgICAgICAgICAgIHJlcXVlc3QucGFydEludmVzdG9yLCAKICAgICAgICAgICAgcmVxdWVzdC5wYXJ0UHJvamVjdCwKICAgICAgICAgICAgcmVxdWVzdC5wYXJ0Rm91bmRlcnMsCiAgICAgICAgICAgIHJlcXVlc3QuYmxvY2tzUGVyU3RhZ2UsCiAgICAgICAgICAgIHJlcXVlc3QucGFydEludmVzdG9ySW5jcmVhc2VQZXJTdGFnZSwKICAgICAgICAgICAgcmVxdWVzdC5tYXhTdGFnZXMKICAgICAgICApOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyB0byBhZGQgYSBuZXcgb3duZXIuIFRyYW5zYWN0aW9uIGhhcyB0byBiZSBzZW50IGJ5IHdhbGxldC4KICAgIC8vLyBAcGFyYW0gX293bmVyIEFkZHJlc3Mgb2YgbmV3IG93bmVyLgogICAgZnVuY3Rpb24gYWRkT3duZXIoYWRkcmVzcyBfb3duZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seVdhbGxldAogICAgICAgIG93bmVyRG9lc05vdEV4aXN0KF9vd25lcikKICAgICAgICBub3ROdWxsKF9vd25lcikKICAgICAgICB2YWxpZFJlcXVpcmVtZW50KG93bmVycy5sZW5ndGggKyAxLCByZXF1aXJlZCkKICAgIHsKICAgICAgICBpc093bmVyW19vd25lcl0gPSB0cnVlOwogICAgICAgIG93bmVycy5wdXNoKF9vd25lcik7CiAgICAgICAgT3duZXJBZGRpdGlvbihfb3duZXIpOwogICAgfQogICAgLy8vIEBkZXYgQWxsb3dzIHRvIHJlbW92ZSBhbiBvd25lci4gVHJhbnNhY3Rpb24gaGFzIHRvIGJlIHNlbnQgYnkgd2FsbGV0LgogICAgLy8vIEBwYXJhbSBfb3duZXIgQWRkcmVzcyBvZiBvd25lci4KICAgIGZ1bmN0aW9uIHJlbW92ZU93bmVyKGFkZHJlc3MgX293bmVyKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlXYWxsZXQKICAgICAgICBvd25lckV4aXN0cyhfb3duZXIpCiAgICB7CiAgICAgICAgaXNPd25lcltfb3duZXJdID0gZmFsc2U7CiAgICAgICAgZm9yICh1aW50IGk9MDsgaTxvd25lcnMubGVuZ3RoIC0gMTsgaSsrKQogICAgICAgICAgICBpZiAob3duZXJzW2ldID09IF9vd25lcikgewogICAgICAgICAgICAgICAgb3duZXJzW2ldID0gb3duZXJzW293bmVycy5sZW5ndGggLSAxXTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgb3duZXJzLmxlbmd0aCAtPSAxOwogICAgICAgIGlmIChyZXF1aXJlZCA+IG93bmVycy5sZW5ndGgpCiAgICAgICAgICAgIGNoYW5nZVJlcXVpcmVtZW50KG93bmVycy5sZW5ndGgpOwogICAgICAgIE93bmVyUmVtb3ZhbChfb3duZXIpOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyB0byByZXBsYWNlIGFuIG93bmVyIHdpdGggYSBuZXcgb3duZXIuIFRyYW5zYWN0aW9uIGhhcyB0byBiZSBzZW50IGJ5IHdhbGxldC4KICAgIC8vLyBAcGFyYW0gX293bmVyIEFkZHJlc3Mgb2Ygb3duZXIgdG8gYmUgcmVwbGFjZWQuCiAgICAvLy8gQHBhcmFtIF9uZXdPd25lciBBZGRyZXNzIG9mIG5ldyBvd25lci4KICAgIGZ1bmN0aW9uIHJlcGxhY2VPd25lcihhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfbmV3T3duZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seVdhbGxldAogICAgICAgIG93bmVyRXhpc3RzKF9vd25lcikKICAgICAgICBvd25lckRvZXNOb3RFeGlzdChfbmV3T3duZXIpCiAgICB7CiAgICAgICAgZm9yICh1aW50IGk9MDsgaTxvd25lcnMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlmIChvd25lcnNbaV0gPT0gX293bmVyKSB7CiAgICAgICAgICAgICAgICBvd25lcnNbaV0gPSBfbmV3T3duZXI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIGlzT3duZXJbX293bmVyXSA9IGZhbHNlOwogICAgICAgIGlzT3duZXJbX25ld093bmVyXSA9IHRydWU7CiAgICAgICAgT3duZXJSZW1vdmFsKF9vd25lcik7CiAgICAgICAgT3duZXJBZGRpdGlvbihfbmV3T3duZXIpOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyB0byBjaGFuZ2UgdGhlIG51bWJlciBvZiByZXF1aXJlZCBjb25maXJtYXRpb25zLiBUcmFuc2FjdGlvbiBoYXMgdG8gYmUgc2VudCBieSB3YWxsZXQuCiAgICAvLy8gQHBhcmFtIF9yZXF1aXJlZCBOdW1iZXIgb2YgcmVxdWlyZWQgY29uZmlybWF0aW9ucy4KICAgIGZ1bmN0aW9uIGNoYW5nZVJlcXVpcmVtZW50KHVpbnQgX3JlcXVpcmVkKSBwdWJsaWMgb25seVdhbGxldCB2YWxpZFJlcXVpcmVtZW50KG93bmVycy5sZW5ndGgsIF9yZXF1aXJlZCkgewogICAgICAgIHJlcXVpcmVkID0gX3JlcXVpcmVkOwogICAgICAgIFJlcXVpcmVtZW50Q2hhbmdlKF9yZXF1aXJlZCk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0RmluaXNoZWRUeCgpIHB1YmxpYyBvd25lckV4aXN0cyhtc2cuc2VuZGVyKSByZXR1cm5zKHVpbnQgdHJhbnNhY3Rpb25JZCkgewogICAgICAgIHRyYW5zYWN0aW9uSWQgPSBhZGRUcmFuc2FjdGlvbih0b2tlbiwgMCwgaGV4IjY0ZjY1Y2MwIik7CiAgICAgICAgY29uZmlybVRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldExpdmVUeCgpIHB1YmxpYyBvd25lckV4aXN0cyhtc2cuc2VuZGVyKSByZXR1cm5zKHVpbnQgdHJhbnNhY3Rpb25JZCkgewogICAgICAgIHRyYW5zYWN0aW9uSWQgPSBhZGRUcmFuc2FjdGlvbih0b2tlbiwgMCwgaGV4IjlkMDcxNGIyIik7CiAgICAgICAgY29uZmlybVRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEZyZWV6ZVR4KCkgcHVibGljIG93bmVyRXhpc3RzKG1zZy5zZW5kZXIpIHJldHVybnModWludCB0cmFuc2FjdGlvbklkKSB7CiAgICAgICAgdHJhbnNhY3Rpb25JZCA9IGFkZFRyYW5zYWN0aW9uKHRva2VuLCAwLCBoZXgiMmM4Y2JlNDAiKTsKICAgICAgICBjb25maXJtVHJhbnNhY3Rpb24odHJhbnNhY3Rpb25JZCk7CiAgICB9CgogICAgLy8vIEBkZXYgQWxsb3dzIGFuIG93bmVyIHRvIHN1Ym1pdCBhbmQgY29uZmlybSBhIHRyYW5zYWN0aW9uLgogICAgLy8vIEBwYXJhbSBkZXN0aW5hdGlvbiBUcmFuc2FjdGlvbiB0YXJnZXQgYWRkcmVzcy4KICAgIC8vLyBAcGFyYW0gdmFsdWUgVHJhbnNhY3Rpb24gZXRoZXIgdmFsdWUuCiAgICAvLy8gQHBhcmFtIGRhdGEgVHJhbnNhY3Rpb24gZGF0YSBwYXlsb2FkLgogICAgLy8vIEByZXR1cm4gUmV0dXJucyB0cmFuc2FjdGlvbiBJRC4KICAgIGZ1bmN0aW9uIHN1Ym1pdFRyYW5zYWN0aW9uKGFkZHJlc3MgZGVzdGluYXRpb24sIHVpbnQgdmFsdWUsIGJ5dGVzIGRhdGEpIHB1YmxpYwogICAgICAgIG93bmVyRXhpc3RzKG1zZy5zZW5kZXIpCiAgICAgICAgbm90TnVsbChkZXN0aW5hdGlvbikKICAgICAgICByZXR1cm5zICh1aW50IHRyYW5zYWN0aW9uSWQpCiAgICB7CiAgICAgICAgdHJhbnNhY3Rpb25JZCA9IGFkZFRyYW5zYWN0aW9uKGRlc3RpbmF0aW9uLCB2YWx1ZSwgZGF0YSk7CiAgICAgICAgY29uZmlybVRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uSWQpOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyBhbiBvd25lciB0byBjb25maXJtIGEgdHJhbnNhY3Rpb24uCiAgICAvLy8gQHBhcmFtIF90cmFuc2FjdGlvbklkIFRyYW5zYWN0aW9uIElELgogICAgZnVuY3Rpb24gY29uZmlybVRyYW5zYWN0aW9uKHVpbnQgX3RyYW5zYWN0aW9uSWQpCiAgICAgICAgcHVibGljCiAgICAgICAgb3duZXJFeGlzdHMobXNnLnNlbmRlcikKICAgICAgICB0cmFuc2FjdGlvbkV4aXN0cyhfdHJhbnNhY3Rpb25JZCkKICAgICAgICBub3RDb25maXJtZWQoX3RyYW5zYWN0aW9uSWQsIG1zZy5zZW5kZXIpCiAgICB7CiAgICAgICAgY29uZmlybWF0aW9uc1tfdHJhbnNhY3Rpb25JZF1bbXNnLnNlbmRlcl0gPSB0cnVlOwogICAgICAgIENvbmZpcm1hdGlvbihtc2cuc2VuZGVyLCBfdHJhbnNhY3Rpb25JZCk7CiAgICAgICAgZXhlY3V0ZVRyYW5zYWN0aW9uKF90cmFuc2FjdGlvbklkKTsKICAgIH0KCiAgICAvLy8gQGRldiBBbGxvd3MgYW4gb3duZXIgdG8gcmV2b2tlIGEgY29uZmlybWF0aW9uIGZvciBhIHRyYW5zYWN0aW9uLgogICAgLy8vIEBwYXJhbSBfdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRC4KICAgIGZ1bmN0aW9uIHJldm9rZUNvbmZpcm1hdGlvbih1aW50IF90cmFuc2FjdGlvbklkKQogICAgICAgIHB1YmxpYwogICAgICAgIG93bmVyRXhpc3RzKG1zZy5zZW5kZXIpCiAgICAgICAgY29uZmlybWVkKF90cmFuc2FjdGlvbklkLCBtc2cuc2VuZGVyKQogICAgICAgIG5vdEV4ZWN1dGVkKF90cmFuc2FjdGlvbklkKQogICAgewogICAgICAgIGNvbmZpcm1hdGlvbnNbX3RyYW5zYWN0aW9uSWRdW21zZy5zZW5kZXJdID0gZmFsc2U7CiAgICAgICAgUmV2b2NhdGlvbihtc2cuc2VuZGVyLCBfdHJhbnNhY3Rpb25JZCk7CiAgICB9CgogICAgLy8vIEBkZXYgQWxsb3dzIGFueW9uZSB0byBleGVjdXRlIGEgY29uZmlybWVkIHRyYW5zYWN0aW9uLgogICAgLy8vIEBwYXJhbSBfdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRC4KICAgIGZ1bmN0aW9uIGV4ZWN1dGVUcmFuc2FjdGlvbih1aW50IF90cmFuc2FjdGlvbklkKSBwdWJsaWMgbm90RXhlY3V0ZWQoX3RyYW5zYWN0aW9uSWQpIHsKICAgICAgICBpZiAoaXNDb25maXJtZWQoX3RyYW5zYWN0aW9uSWQpKSB7CiAgICAgICAgICAgIFRyYW5zYWN0aW9uIHN0b3JhZ2UgdHJ4ID0gdHJhbnNhY3Rpb25zW190cmFuc2FjdGlvbklkXTsKICAgICAgICAgICAgdHJ4LmV4ZWN1dGVkID0gdHJ1ZTsKICAgICAgICAgICAgaWYgKHRyeC5kZXN0aW5hdGlvbi5jYWxsLnZhbHVlKHRyeC52YWx1ZSkodHJ4LmRhdGEpKQogICAgICAgICAgICAgICAgRXhlY3V0aW9uKF90cmFuc2FjdGlvbklkKTsKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBFeGVjdXRpb25GYWlsdXJlKF90cmFuc2FjdGlvbklkKTsKICAgICAgICAgICAgICAgIHRyeC5leGVjdXRlZCA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgdGhlIGNvbmZpcm1hdGlvbiBzdGF0dXMgb2YgYSB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gX3RyYW5zYWN0aW9uSWQgVHJhbnNhY3Rpb24gSUQuCiAgICAvLy8gQHJldHVybiBDb25maXJtYXRpb24gc3RhdHVzLgogICAgZnVuY3Rpb24gaXNDb25maXJtZWQodWludCBfdHJhbnNhY3Rpb25JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHVpbnQgY291bnQgPSAwOwogICAgICAgIGZvciAodWludCBpPTA7IGk8b3duZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChjb25maXJtYXRpb25zW190cmFuc2FjdGlvbklkXVtvd25lcnNbaV1dKQogICAgICAgICAgICAgICAgY291bnQgKz0gMTsKICAgICAgICAgICAgaWYgKGNvdW50ID09IHJlcXVpcmVkKQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKgogICAgICogSW50ZXJuYWwgZnVuY3Rpb25zCiAgICAgKi8KCiAgICAvLy8gQGRldiBBZGRzIGEgbmV3IHRyYW5zYWN0aW9uIHRvIHRoZSB0cmFuc2FjdGlvbiBtYXBwaW5nLCBpZiB0cmFuc2FjdGlvbiBkb2VzIG5vdCBleGlzdCB5ZXQuCiAgICAvLy8gQHBhcmFtIGRlc3RpbmF0aW9uIFRyYW5zYWN0aW9uIHRhcmdldCBhZGRyZXNzLgogICAgLy8vIEBwYXJhbSB2YWx1ZSBUcmFuc2FjdGlvbiBldGhlciB2YWx1ZS4KICAgIC8vLyBAcGFyYW0gZGF0YSBUcmFuc2FjdGlvbiBkYXRhIHBheWxvYWQuCiAgICAvLy8gQHJldHVybiBSZXR1cm5zIHRyYW5zYWN0aW9uIElELgogICAgZnVuY3Rpb24gYWRkVHJhbnNhY3Rpb24oYWRkcmVzcyBkZXN0aW5hdGlvbiwgdWludCB2YWx1ZSwgYnl0ZXMgZGF0YSkgaW50ZXJuYWwgcmV0dXJucyAodWludCB0cmFuc2FjdGlvbklkKSB7CiAgICAgICAgdHJhbnNhY3Rpb25JZCA9IHRyYW5zYWN0aW9uQ291bnQ7CiAgICAgICAgdHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9uSWRdID0gVHJhbnNhY3Rpb24oewogICAgICAgICAgICBkZXN0aW5hdGlvbjogZGVzdGluYXRpb24sCiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgICAgICAgZGF0YTogZGF0YSwKICAgICAgICAgICAgZXhlY3V0ZWQ6IGZhbHNlCiAgICAgICAgfSk7CiAgICAgICAgdHJhbnNhY3Rpb25Db3VudCArPSAxOwogICAgICAgIFN1Ym1pc3Npb24odHJhbnNhY3Rpb25JZCk7CiAgICB9CgogICAgLyoKICAgICAqIFdlYjMgY2FsbCBmdW5jdGlvbnMKICAgICovCgogICAgLy8vIEBkZXYgUmV0dXJucyBudW1iZXIgb2YgY29uZmlybWF0aW9ucyBvZiBhIHRyYW5zYWN0aW9uLgogICAgLy8vIEBwYXJhbSBfdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRC4KICAgIC8vLyBAcmV0dXJuIE51bWJlciBvZiBjb25maXJtYXRpb25zLgogICAgZnVuY3Rpb24gZ2V0Q29uZmlybWF0aW9uQ291bnQodWludCBfdHJhbnNhY3Rpb25JZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQgY291bnQpIHsKICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPG93bmVycy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKGNvbmZpcm1hdGlvbnNbX3RyYW5zYWN0aW9uSWRdW293bmVyc1tpXV0pCiAgICAgICAgICAgICAgICBjb3VudCArPSAxOwogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgdG90YWwgbnVtYmVyIG9mIHRyYW5zYWN0aW9ucyBhZnRlciBmaWxlcnMgYXJlIGFwcGxpZWQuCiAgICAvLy8gQHBhcmFtIHBlbmRpbmcgSW5jbHVkZSBwZW5kaW5nIHRyYW5zYWN0aW9ucy4KICAgIC8vLyBAcGFyYW0gZXhlY3V0ZWQgSW5jbHVkZSBleGVjdXRlZCB0cmFuc2FjdGlvbnMuCiAgICAvLy8gQHJldHVybiBUb3RhbCBudW1iZXIgb2YgdHJhbnNhY3Rpb25zIGFmdGVyIGZpbHRlcnMgYXJlIGFwcGxpZWQuCiAgICBmdW5jdGlvbiBnZXRUcmFuc2FjdGlvbkNvdW50KGJvb2wgcGVuZGluZywgYm9vbCBleGVjdXRlZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQgY291bnQpIHsKICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPHRyYW5zYWN0aW9uQ291bnQ7IGkrKykKICAgICAgICAgICAgaWYgKCAgIHBlbmRpbmcgJiYgIXRyYW5zYWN0aW9uc1tpXS5leGVjdXRlZAogICAgICAgICAgICAgICAgfHwgZXhlY3V0ZWQgJiYgdHJhbnNhY3Rpb25zW2ldLmV4ZWN1dGVkKQogICAgICAgICAgICAgICAgY291bnQgKz0gMTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIGxpc3Qgb2Ygb3duZXJzLgogICAgLy8vIEByZXR1cm4gTGlzdCBvZiBvd25lciBhZGRyZXNzZXMuCiAgICBmdW5jdGlvbiBnZXRPd25lcnMoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzc1tdKSB7CiAgICAgICAgcmV0dXJuIG93bmVyczsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIGFycmF5IHdpdGggb3duZXIgYWRkcmVzc2VzLCB3aGljaCBjb25maXJtZWQgdHJhbnNhY3Rpb24uCiAgICAvLy8gQHBhcmFtIF90cmFuc2FjdGlvbklkIFRyYW5zYWN0aW9uIElELgogICAgLy8vIEByZXR1cm4gUmV0dXJucyBhcnJheSBvZiBvd25lciBhZGRyZXNzZXMuCiAgICBmdW5jdGlvbiBnZXRDb25maXJtYXRpb25zKHVpbnQgX3RyYW5zYWN0aW9uSWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzW10gX2NvbmZpcm1hdGlvbnMpIHsKICAgICAgICBhZGRyZXNzW10gbWVtb3J5IGNvbmZpcm1hdGlvbnNUZW1wID0gbmV3IGFkZHJlc3NbXShvd25lcnMubGVuZ3RoKTsKICAgICAgICB1aW50IGNvdW50ID0gMDsKICAgICAgICB1aW50IGk7CiAgICAgICAgZm9yIChpPTA7IGk8b3duZXJzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBpZiAoY29uZmlybWF0aW9uc1tfdHJhbnNhY3Rpb25JZF1bb3duZXJzW2ldXSkgewogICAgICAgICAgICAgICAgY29uZmlybWF0aW9uc1RlbXBbY291bnRdID0gb3duZXJzW2ldOwogICAgICAgICAgICAgICAgY291bnQgKz0gMTsKICAgICAgICAgICAgfQogICAgICAgIF9jb25maXJtYXRpb25zID0gbmV3IGFkZHJlc3NbXShjb3VudCk7CiAgICAgICAgZm9yIChpPTA7IGk8Y291bnQ7IGkrKykKICAgICAgICAgICAgX2NvbmZpcm1hdGlvbnNbaV0gPSBjb25maXJtYXRpb25zVGVtcFtpXTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIGxpc3Qgb2YgdHJhbnNhY3Rpb24gSURzIGluIGRlZmluZWQgcmFuZ2UuCiAgICAvLy8gQHBhcmFtIGZyb20gSW5kZXggc3RhcnQgcG9zaXRpb24gb2YgdHJhbnNhY3Rpb24gYXJyYXkuCiAgICAvLy8gQHBhcmFtIHRvIEluZGV4IGVuZCBwb3NpdGlvbiBvZiB0cmFuc2FjdGlvbiBhcnJheS4KICAgIC8vLyBAcGFyYW0gcGVuZGluZyBJbmNsdWRlIHBlbmRpbmcgdHJhbnNhY3Rpb25zLgogICAgLy8vIEBwYXJhbSBleGVjdXRlZCBJbmNsdWRlIGV4ZWN1dGVkIHRyYW5zYWN0aW9ucy4KICAgIC8vLyBAcmV0dXJuIFJldHVybnMgYXJyYXkgb2YgdHJhbnNhY3Rpb24gSURzLgogICAgZnVuY3Rpb24gZ2V0VHJhbnNhY3Rpb25JZHModWludCBmcm9tLCB1aW50IHRvLCBib29sIHBlbmRpbmcsIGJvb2wgZXhlY3V0ZWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50W10gX3RyYW5zYWN0aW9uSWRzKSB7CiAgICAgICAgdWludFtdIG1lbW9yeSB0cmFuc2FjdGlvbklkc1RlbXAgPSBuZXcgdWludFtdKHRyYW5zYWN0aW9uQ291bnQpOwogICAgICAgIHVpbnQgY291bnQgPSAwOwogICAgICAgIHVpbnQgaTsKICAgICAgICBmb3IgKGk9ZnJvbTsgaTx0cmFuc2FjdGlvbkNvdW50OyBpKyspCiAgICAgICAgICAgIGlmICggICBwZW5kaW5nICYmICF0cmFuc2FjdGlvbnNbaV0uZXhlY3V0ZWQKICAgICAgICAgICAgICAgIHx8IGV4ZWN1dGVkICYmIHRyYW5zYWN0aW9uc1tpXS5leGVjdXRlZCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25JZHNUZW1wW2NvdW50XSA9IGk7CiAgICAgICAgICAgICAgICBjb3VudCArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgX3RyYW5zYWN0aW9uSWRzID0gbmV3IHVpbnRbXSh0byAtIGZyb20pOwogICAgICAgIGZvciAoaT1mcm9tOyBpPHRvOyBpKyspCiAgICAgICAgICAgIF90cmFuc2FjdGlvbklkc1tpIC0gZnJvbV0gPSB0cmFuc2FjdGlvbklkc1RlbXBbaV07CiAgICB9Cgp9'.
	

]
