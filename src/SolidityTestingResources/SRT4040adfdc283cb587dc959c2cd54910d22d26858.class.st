Class {
	#name : #SRT4040adfdc283cb587dc959c2cd54910d22d26858,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT4040adfdc283cb587dc959c2cd54910d22d26858 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7Cgpjb250cmFjdCBTYWZlTWF0aCB7CgogICAgZnVuY3Rpb24gc2FmZU11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiApIHsKICAgICAgICB1aW50MjU2IGMgPSBhICogYjsKICAgICAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIHNhZmVEaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgKSB7CiAgICAgICAgYXNzZXJ0KGIgPiAwKTsKICAgICAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgICAgICBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICBmdW5jdGlvbiBzYWZlU3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2ICkgewogICAgICAgIGFzc2VydChiIDw9IGEpOwogICAgICAgIHJldHVybiBhIC0gYjsKICAgIH0KCiAgICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2ICkgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgICAgIGFzc2VydChjID49IGEpOwogICAgICAgIHJldHVybiBjOwogICAgfQp9Cgpjb250cmFjdCBFUkMyMCB7CgogICAgLyogVGhpcyBpcyBhIHNsaWdodCBjaGFuZ2UgdG8gdGhlIEVSQzIwIGJhc2Ugc3RhbmRhcmQuCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgc3VwcGx5KTsKICAgIGlzIHJlcGxhY2VkIHdpdGg6CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICAgIFRoaXMgYXV0b21hdGljYWxseSBjcmVhdGVzIGEgZ2V0dGVyIGZ1bmN0aW9uIGZvciB0aGUgdG90YWxTdXBwbHkuCiAgICBUaGlzIGlzIG1vdmVkIHRvIHRoZSBiYXNlIGNvbnRyYWN0IHNpbmNlIHB1YmxpYyBnZXR0ZXIgZnVuY3Rpb25zIGFyZSBub3QKICAgIGN1cnJlbnRseSByZWNvZ25pc2VkIGFzIGFuIGltcGxlbWVudGF0aW9uIG9mIHRoZSBtYXRjaGluZyBhYnN0cmFjdAogICAgZnVuY3Rpb24gYnkgdGhlIGNvbXBpbGVyLgogICAgKi8KICAgIC8vLyB0b3RhbCBhbW91bnQgb2YgdG9rZW5zCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBmcm9tIHdoaWNoIHRoZSBiYWxhbmNlIHdpbGwgYmUgcmV0cmlldmVkCiAgICAvLy8gQHJldHVybiBUaGUgYmFsYW5jZQogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwoKICAgIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgbXNnLnNlbmRlcmAKICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQKICAgIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQKICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIHRyYW5zZmVyIHdhcyBzdWNjZXNzZnVsIG9yIG5vdAogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgX2Zyb21gIG9uIHRoZSBjb25kaXRpb24gaXQgaXMgYXBwcm92ZWQgYnkgYF9mcm9tYAogICAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyCiAgICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8vIEBub3RpY2UgYG1zZy5zZW5kZXJgIGFwcHJvdmVzIGBfc3BlbmRlcmAgdG8gc3BlbmQgYF92YWx1ZWAgdG9rZW5zCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2VucwogICAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgYXBwcm92ZWQgZm9yIHRyYW5zZmVyCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBhcHByb3ZhbCB3YXMgc3VjY2Vzc2Z1bCBvciBub3QKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgb3duaW5nIHRva2VucwogICAgLy8vIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBhYmxlIHRvIHRyYW5zZmVyIHRoZSB0b2tlbnMKICAgIC8vLyBAcmV0dXJuIEFtb3VudCBvZiByZW1haW5pbmcgdG9rZW5zIGFsbG93ZWQgdG8gc3BlbnQKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOwoKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7Cn0KCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIFNhZmVNYXRoIHsKCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwoKICAgIC8vLyBAZGV2IFJldHVybnMgbnVtYmVyIG9mIHRva2VucyBvd25lZCBieSBnaXZlbiBhZGRyZXNzLgogICAgLy8vIEBwYXJhbSBfb3duZXIgQWRkcmVzcyBvZiB0b2tlbiBvd25lci4KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9CgogICAgLy8vIEBkZXYgVHJhbnNmZXJzIHNlbmRlcidzIHRva2VucyB0byBhIGdpdmVuIGFkZHJlc3MuIFJldHVybnMgc3VjY2Vzcy4KICAgIC8vLyBAcGFyYW0gX3RvIEFkZHJlc3Mgb2YgdG9rZW4gcmVjZWl2ZXIuCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBOdW1iZXIgb2YgdG9rZW5zIHRvIHRyYW5zZmVyLgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYgKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gc2FmZVN1YihiYWxhbmNlc1ttc2cuc2VuZGVyXSwgX3ZhbHVlKTsKICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSA9IHNhZmVBZGQoYmFsYW5jZXNbX3RvXSwgX3ZhbHVlKTsKICAgICAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyBhbGxvd2VkIHRoaXJkIHBhcnR5IHRvIHRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIuIFJldHVybnMgc3VjY2Vzcy4KICAgIC8vLyBAcGFyYW0gX2Zyb20gQWRkcmVzcyBmcm9tIHdoZXJlIHRva2VucyBhcmUgd2l0aGRyYXduLgogICAgLy8vIEBwYXJhbSBfdG8gQWRkcmVzcyB0byB3aGVyZSB0b2tlbnMgYXJlIHNlbnQuCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBOdW1iZXIgb2YgdG9rZW5zIHRvIHRyYW5zZmVyLgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW190b10gPSBzYWZlQWRkKGJhbGFuY2VzW190b10sIF92YWx1ZSk7CiAgICAgICAgICAgIGJhbGFuY2VzW19mcm9tXSA9IHNhZmVTdWIoYmFsYW5jZXNbX2Zyb21dLCBfdmFsdWUpOwogICAgICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IHNhZmVTdWIoYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0sIF92YWx1ZSk7CiAgICAgICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLy8vIEBkZXYgU2V0cyBhcHByb3ZlZCBhbW91bnQgb2YgdG9rZW5zIGZvciBzcGVuZGVyLiBSZXR1cm5zIHN1Y2Nlc3MuCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIEFkZHJlc3Mgb2YgYWxsb3dlZCBhY2NvdW50LgogICAgLy8vIEBwYXJhbSBfdmFsdWUgTnVtYmVyIG9mIGFwcHJvdmVkIHRva2Vucy4KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIG51bWJlciBvZiBhbGxvd2VkIHRva2VucyBmb3IgZ2l2ZW4gYWRkcmVzcy4KICAgIC8vLyBAcGFyYW0gX293bmVyIEFkZHJlc3Mgb2YgdG9rZW4gb3duZXIuCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIEFkZHJlc3Mgb2YgdG9rZW4gc3BlbmRlci4KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KfQoKY29udHJhY3QgT3duYWJsZSB7CgogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICBhZGRyZXNzIHB1YmxpYyBwZW5kaW5nT3duZXI7CgogICAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLyBTYWZlIHRyYW5zZmVyIG9mIG93bmVyc2hpcCBpbiAyIHN0ZXBzLiBPbmNlIGNhbGxlZCwgYSBuZXdPd25lciBuZWVkcyB0byBjYWxsIGNsYWltT3duZXJzaGlwKCkgdG8gcHJvdmUgb3duZXJzaGlwLgogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHsKICAgICAgICBwZW5kaW5nT3duZXIgPSBuZXdPd25lcjsKICAgIH0KCiAgICBmdW5jdGlvbiBjbGFpbU93bmVyc2hpcCgpIHsKICAgICAgICBpZiAobXNnLnNlbmRlciA9PSBwZW5kaW5nT3duZXIpIHsKICAgICAgICAgICAgb3duZXIgPSBwZW5kaW5nT3duZXI7CiAgICAgICAgICAgIHBlbmRpbmdPd25lciA9IDA7CiAgICAgICAgfQogICAgfQp9Cgpjb250cmFjdCBNdWx0aU93bmFibGUgewoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgb3duZXJNYXA7CiAgICBhZGRyZXNzW10gcHVibGljIG93bmVyczsKCiAgICBldmVudCBPd25lckFkZGVkKGFkZHJlc3MgaW5kZXhlZCBfbmV3T3duZXIpOwogICAgZXZlbnQgT3duZXJSZW1vdmVkKGFkZHJlc3MgaW5kZXhlZCBfb2xkT3duZXIpOwoKICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgICAgICByZXF1aXJlKGlzT3duZXIobXNnLnNlbmRlcikpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gTXVsdGlPd25hYmxlKCkgewogICAgICAgIC8vIEFkZCBkZWZhdWx0IG93bmVyCiAgICAgICAgYWRkcmVzcyBvd25lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgb3duZXJNYXBbb3duZXJdID0gdHJ1ZTsKICAgICAgICBvd25lcnMucHVzaChvd25lcik7CiAgICB9CgogICAgZnVuY3Rpb24gb3duZXJDb3VudCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIG93bmVycy5sZW5ndGg7CiAgICB9CgogICAgZnVuY3Rpb24gaXNPd25lcihhZGRyZXNzIG93bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBvd25lck1hcFtvd25lcl07CiAgICB9CgogICAgZnVuY3Rpb24gYWRkT3duZXIoYWRkcmVzcyBvd25lcikgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAoIWlzT3duZXIob3duZXIpICYmIG93bmVyICE9IDApIHsKICAgICAgICAgICAgb3duZXJNYXBbb3duZXJdID0gdHJ1ZTsKICAgICAgICAgICAgb3duZXJzLnB1c2gob3duZXIpOwoKICAgICAgICAgICAgT3duZXJBZGRlZChvd25lcik7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgZnVuY3Rpb24gcmVtb3ZlT3duZXIoYWRkcmVzcyBvd25lcikgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAoaXNPd25lcihvd25lcikpIHsKICAgICAgICAgICAgb3duZXJNYXBbb3duZXJdID0gZmFsc2U7CiAgICAgICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IG93bmVycy5sZW5ndGggLSAxOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmIChvd25lcnNbaV0gPT0gb3duZXIpIHsKICAgICAgICAgICAgICAgICAgICBvd25lcnNbaV0gPSBvd25lcnNbb3duZXJzLmxlbmd0aCAtIDFdOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIG93bmVycy5sZW5ndGggLT0gMTsKCiAgICAgICAgICAgIE93bmVyUmVtb3ZlZChvd25lcik7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSByZXR1cm4gZmFsc2U7CiAgICB9Cn0KCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgewoKICAgIGJvb2wgcHVibGljIHBhdXNlZDsKCiAgICBtb2RpZmllciBpZk5vdFBhdXNlZCB7CiAgICAgICAgcmVxdWlyZSghcGF1c2VkKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIGlmUGF1c2VkIHsKICAgICAgICByZXF1aXJlKHBhdXNlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLyBDYWxsZWQgYnkgdGhlIG93bmVyIG9uIGVtZXJnZW5jeSwgdHJpZ2dlcnMgcGF1c2VkIHN0YXRlCiAgICBmdW5jdGlvbiBwYXVzZSgpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgcGF1c2VkID0gdHJ1ZTsKICAgIH0KCiAgICAvLyBDYWxsZWQgYnkgdGhlIG93bmVyIG9uIGVuZCBvZiBlbWVyZ2VuY3ksIHJldHVybnMgdG8gbm9ybWFsIHN0YXRlCiAgICBmdW5jdGlvbiByZXN1bWUoKSBleHRlcm5hbCBvbmx5T3duZXIgaWZQYXVzZWQgewogICAgICAgIHBhdXNlZCA9IGZhbHNlOwogICAgfQp9Cgpjb250cmFjdCBUb2tlblNwZW5kZXIgewogICAgZnVuY3Rpb24gcmVjZWl2ZUFwcHJvdmFsKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlKTsKfQoKY29udHJhY3QgQ29tbW9uQnNUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBNdWx0aU93bmFibGUgewoKICAgIGJvb2wgcHVibGljIGxvY2tlZDsKCiAgICBzdHJpbmcgcHVibGljIG5hbWU7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogICAgdWludDggcHVibGljIGRlY2ltYWxzID0gMTg7CiAgICBzdHJpbmcgcHVibGljIHZlcnNpb24gPSAndjAuMSc7CgogICAgYWRkcmVzcyBwdWJsaWMgY3JlYXRvcjsKICAgIGFkZHJlc3MgcHVibGljIHNlbGxlcjsKICAgIHVpbnQyNTYgcHVibGljIHRva2Vuc1NvbGQ7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFNhbGVzOwoKICAgIGV2ZW50IFNlbGwoYWRkcmVzcyBpbmRleGVkIF9zZWxsZXIsIGFkZHJlc3MgaW5kZXhlZCBfYnV5ZXIsIHVpbnQyNTYgX3ZhbHVlKTsKICAgIGV2ZW50IFNlbGxlckNoYW5nZWQoYWRkcmVzcyBpbmRleGVkIF9vbGRTZWxsZXIsIGFkZHJlc3MgaW5kZXhlZCBfbmV3U2VsbGVyKTsKCiAgICBtb2RpZmllciBvbmx5VW5sb2NrZWQoKSB7CiAgICAgICAgaWYgKCFpc093bmVyKG1zZy5zZW5kZXIpICYmIGxvY2tlZCkgdGhyb3c7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBDb21tb25Cc1Rva2VuKHN0cmluZyBfbmFtZSwgc3RyaW5nIF9zeW1ib2wsIHVpbnQyNTYgX3RvdGFsU3VwcGx5Tm9EZWNpbWFscywgYWRkcmVzcyBfc2VsbGVyKSBNdWx0aU93bmFibGUoKSB7CgogICAgICAgIC8vIExvY2sgdGhlIHRyYW5zZmVyIGZ1bmN0aW9uIGR1cmluZyB0aGUgcHJlc2FsZS9jcm93ZHNhbGUgdG8gcHJldmVudCBzcGVjdWxhdGlvbnMuCiAgICAgICAgbG9ja2VkID0gdHJ1ZTsKCiAgICAgICAgY3JlYXRvciA9IG1zZy5zZW5kZXI7CiAgICAgICAgc2VsbGVyID0gX3NlbGxlcjsKCiAgICAgICAgbmFtZSA9IF9uYW1lOwogICAgICAgIHN5bWJvbCA9IF9zeW1ib2w7CiAgICAgICAgdG90YWxTdXBwbHkgPSBfdG90YWxTdXBwbHlOb0RlY2ltYWxzICogMWUxODsKCiAgICAgICAgYmFsYW5jZXNbc2VsbGVyXSA9IHRvdGFsU3VwcGx5OwogICAgICAgIFRyYW5zZmVyKDB4MCwgc2VsbGVyLCB0b3RhbFN1cHBseSk7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlU2VsbGVyKGFkZHJlc3MgbmV3U2VsbGVyKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUobmV3U2VsbGVyICE9IDB4MCAmJiBzZWxsZXIgIT0gbmV3U2VsbGVyKTsKCiAgICAgICAgYWRkcmVzcyBvbGRTZWxsZXIgPSBzZWxsZXI7CgogICAgICAgIHVpbnQyNTYgdW5zb2xkVG9rZW5zID0gYmFsYW5jZXNbb2xkU2VsbGVyXTsKICAgICAgICBiYWxhbmNlc1tvbGRTZWxsZXJdID0gMDsKICAgICAgICBiYWxhbmNlc1tuZXdTZWxsZXJdID0gc2FmZUFkZChiYWxhbmNlc1tuZXdTZWxsZXJdLCB1bnNvbGRUb2tlbnMpOwogICAgICAgIFRyYW5zZmVyKG9sZFNlbGxlciwgbmV3U2VsbGVyLCB1bnNvbGRUb2tlbnMpOwoKICAgICAgICBzZWxsZXIgPSBuZXdTZWxsZXI7CiAgICAgICAgU2VsbGVyQ2hhbmdlZChvbGRTZWxsZXIsIG5ld1NlbGxlcik7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gc2VsbE5vRGVjaW1hbHMoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHNlbGwoX3RvLCBfdmFsdWUgKiAxZTE4KTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZWxsKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAoYmFsYW5jZXNbc2VsbGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgewogICAgICAgICAgICBiYWxhbmNlc1tzZWxsZXJdID0gc2FmZVN1YihiYWxhbmNlc1tzZWxsZXJdLCBfdmFsdWUpOwogICAgICAgICAgICBiYWxhbmNlc1tfdG9dID0gc2FmZUFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOwogICAgICAgICAgICBUcmFuc2ZlcihzZWxsZXIsIF90bywgX3ZhbHVlKTsKCiAgICAgICAgICAgIHRva2Vuc1NvbGQgPSBzYWZlQWRkKHRva2Vuc1NvbGQsIF92YWx1ZSk7CiAgICAgICAgICAgIHRvdGFsU2FsZXMgPSBzYWZlQWRkKHRvdGFsU2FsZXMsIDEpOwogICAgICAgICAgICBTZWxsKHNlbGxlciwgX3RvLCBfdmFsdWUpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgb25seVVubG9ja2VkIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIG9ubHlVbmxvY2tlZCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGxvY2soKSBvbmx5T3duZXIgewogICAgICAgIGxvY2tlZCA9IHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gdW5sb2NrKCkgb25seU93bmVyIHsKICAgICAgICBsb2NrZWQgPSBmYWxzZTsKICAgIH0KCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYgKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gc2FmZVN1YihiYWxhbmNlc1ttc2cuc2VuZGVyXSwgX3ZhbHVlKSA7CiAgICAgICAgICAgIHRvdGFsU3VwcGx5ID0gc2FmZVN1Yih0b3RhbFN1cHBseSwgX3ZhbHVlKTsKICAgICAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgMHgwLCBfdmFsdWUpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qIEFwcHJvdmUgYW5kIHRoZW4gY29tbXVuaWNhdGUgdGhlIGFwcHJvdmVkIGNvbnRyYWN0IGluIGEgc2luZ2xlIHR4ICovCiAgICBmdW5jdGlvbiBhcHByb3ZlQW5kQ2FsbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgewogICAgICAgIFRva2VuU3BlbmRlciBzcGVuZGVyID0gVG9rZW5TcGVuZGVyKF9zcGVuZGVyKTsKICAgICAgICBpZiAoYXBwcm92ZShfc3BlbmRlciwgX3ZhbHVlKSkgewogICAgICAgICAgICBzcGVuZGVyLnJlY2VpdmVBcHByb3ZhbChtc2cuc2VuZGVyLCBfdmFsdWUpOwogICAgICAgIH0KICAgIH0KfQoKY29udHJhY3QgQ29tbW9uQnNQcmVzYWxlIGlzIFNhZmVNYXRoLCBPd25hYmxlLCBQYXVzYWJsZSB7CgogICAgZW51bSBDdXJyZW5jeSB7IEJUQywgTFRDLCBaRUMsIERBU0gsIFdBVkVTLCBVU0QsIEVVUiB9CgogICAgLy8gVE9ETyByZW5hbWUgdG8gQnV5ZXI/CgogICAgc3RydWN0IEJhY2tlciB7CiAgICAgICAgdWludDI1NiB3ZWlSZWNlaXZlZDsgLy8gQW1vdW50IG9mIHdlaSBnaXZlbiBieSBiYWNrZXIKICAgICAgICB1aW50MjU2IHRva2Vuc1NlbnQ7ICAvLyBBbW91bnQgb2YgdG9rZW5zIHJlY2VpdmVkIGluIHJldHVybiB0byB0aGUgZ2l2ZW4gYW1vdW50IG9mIEVUSC4KICAgIH0KCiAgICAvLyBUT0RPIHJlbmFtZSB0byBidXllcnM/CgogICAgLy8gKGJ1eWVyX2V0aF9hZGRyZXNzIC0+IHN0cnVjdCkKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBCYWNrZXIpIHB1YmxpYyBiYWNrZXJzOwoKICAgIC8vIGN1cnJlbmN5X2NvZGUgPT4gKHR4X2hhc2ggPT4gdG9rZW5zKQogICAgbWFwcGluZyh1aW50OCA9PiBtYXBwaW5nKGJ5dGVzMzIgPT4gdWludDI1NikpIHB1YmxpYyBleHRlcm5hbFR4czsKCiAgICBDb21tb25Cc1Rva2VuIHB1YmxpYyB0b2tlbjsgLy8gVG9rZW4gY29udHJhY3QgcmVmZXJlbmNlLgogICAgYWRkcmVzcyBwdWJsaWMgYmVuZWZpY2lhcnk7IC8vIEFkZHJlc3MgdGhhdCB3aWxsIHJlY2VpdmUgRVRIIHJhaXNlZCBkdXJpbmcgdGhpcyBjcm93ZHNhbGUuCiAgICBhZGRyZXNzIHB1YmxpYyBub3RpZmllcjsgICAgLy8gQWRkcmVzcyB0aGF0IGNhbiB0aGlzIGNyb3dkc2FsZSBhYm91dCBjaGFuZ2VkIGV4dGVybmFsIGNvbmRpdGlvbnMuCgogICAgdWludDI1NiBwdWJsaWMgbWluVG9rZW5zVG9CdXkgPSAxICogMWUxODsgLy8gSW5jbHVkaW5nIGJvbnVzZXMuCiAgICB1aW50MjU2IHB1YmxpYyBtYXhDYXBXZWkgICAgICA9IDUwMDAwIGV0aGVyOwoKICAgIHVpbnQgcHVibGljIHRva2Vuc1BlcldlaSAgICAgICAgID0gMTAwMDsgLy8gT3JkaW5hcnkgcHJpY2U6IDEgRVRIID0gMTAwMCB0b2tlbnMuCiAgICB1aW50IHB1YmxpYyB0b2tlbnNQZXJXZWlCb251czMzMyA9IDEzMzM7CiAgICB1aW50IHB1YmxpYyB0b2tlbnNQZXJXZWlCb251czI1MCA9IDEyNTA7CiAgICB1aW50IHB1YmxpYyB0b2tlbnNQZXJXZWlCb251czExMSA9IDExMTE7CgogICAgdWludCBwdWJsaWMgc3RhcnRUaW1lICAgICAgID0gMTQxMDE2MDcwMDsgLy8gMjAxNy0xMS0wOFQxNzowNTowMFoKICAgIHVpbnQgcHVibGljIGJvbnVzRW5kVGltZTMzMyA9IDE1MTAzMzM1MDA7IC8vIDIwMTctMTEtMTBUMTc6MDU6MDBaCiAgICB1aW50IHB1YmxpYyBib251c0VuZFRpbWUyNTAgPSAxNTEwNjc5MTAwOyAvLyAyMDE3LTExLTE0VDE3OjA1OjAwWgogICAgdWludCBwdWJsaWMgZW5kVGltZSAgICAgICAgID0gMTUxMTAyNDcwMDsgLy8gMjAxNy0xMS0xOFQxNzowNTowMFoKCiAgICAvLyBTdGF0cyBmb3IgY3VycmVudCBjcm93ZHNhbGUKCiAgICAvLyBUT0RPIHJlbmFtZSB0byAndG90YWxJbldlaScKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsV2VpICAgICAgICAgICA9IDA7IC8vIEdyYW5kIHRvdGFsIGluIHdlaQoKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsVG9rZW5zU29sZCAgICA9IDA7IC8vIFRvdGFsIGFtb3VudCBvZiB0b2tlbnMgc29sZCBkdXJpbmcgdGhpcyBjcm93ZHNhbGUuCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbEV0aFNhbGVzICAgICAgPSAwOyAvLyBUb3RhbCBhbW91bnQgb2YgRVRIIGNvbnRyaWJ1dGlvbnMgZHVyaW5nIHRoaXMgY3Jvd2RzYWxlLgogICAgdWludDI1NiBwdWJsaWMgdG90YWxFeHRlcm5hbFNhbGVzID0gMDsgLy8gVG90YWwgYW1vdW50IG9mIGV4dGVybmFsIGNvbnRyaWJ1dGlvbnMgKEJUQywgTFRDLCBVU0QsIGV0Yy4pIGR1cmluZyB0aGlzIGNyb3dkc2FsZS4KICAgIHVpbnQyNTYgcHVibGljIHdlaVJlY2VpdmVkICAgICAgICA9IDA7IC8vIFRvdGFsIGFtb3VudCBvZiB3ZWkgcmVjZWl2ZWQgZHVyaW5nIHRoaXMgY3Jvd2RzYWxlIHNtYXJ0IGNvbnRyYWN0LgoKICAgIHVpbnQgcHVibGljIGZpbmFsaXplZFRpbWUgPSAwOyAvLyBVbml4IHRpbWVzdGFtcCB3aGVuIGZpbmFsaXplKCkgd2FzIGNhbGxlZC4KCiAgICBib29sIHB1YmxpYyBzYWxlRW5hYmxlZCA9IHRydWU7ICAgLy8gaWYgZmFsc2UsIHRoZW4gY29udHJhY3Qgd2lsbCBub3Qgc2VsbCB0b2tlbnMgb24gcGF5bWVudCByZWNlaXZlZAoKICAgIGV2ZW50IEJlbmVmaWNpYXJ5Q2hhbmdlZChhZGRyZXNzIGluZGV4ZWQgX29sZEFkZHJlc3MsIGFkZHJlc3MgaW5kZXhlZCBfbmV3QWRkcmVzcyk7CiAgICBldmVudCBOb3RpZmllckNoYW5nZWQoYWRkcmVzcyBpbmRleGVkIF9vbGRBZGRyZXNzLCBhZGRyZXNzIGluZGV4ZWQgX25ld0FkZHJlc3MpOwoKICAgIGV2ZW50IEV0aFJlY2VpdmVkKGFkZHJlc3MgaW5kZXhlZCBfYnV5ZXIsIHVpbnQyNTYgX2Ftb3VudFdlaSk7CiAgICBldmVudCBFeHRlcm5hbFNhbGVTaGEzKEN1cnJlbmN5IF9jdXJyZW5jeSwgYnl0ZXMzMiBfdHhJZFNoYTMsIGFkZHJlc3MgaW5kZXhlZCBfYnV5ZXIsIHVpbnQyNTYgX2Ftb3VudFdlaSwgdWludDI1NiBfdG9rZW5zRTE4KTsKCiAgICBtb2RpZmllciByZXNwZWN0VGltZUZyYW1lKCkgewogICAgICAgIHJlcXVpcmUoaXNTYWxlT24oKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBjYW5Ob3RpZnkoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyIHx8IG1zZy5zZW5kZXIgPT0gbm90aWZpZXIpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gQ29tbW9uQnNQcmVzYWxlKGFkZHJlc3MgX3Rva2VuLCBhZGRyZXNzIF9iZW5lZmljaWFyeSkgewogICAgICAgIHRva2VuID0gQ29tbW9uQnNUb2tlbihfdG9rZW4pOwogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgICAgICBub3RpZmllciA9IG93bmVyOwogICAgICAgIGJlbmVmaWNpYXJ5ID0gX2JlbmVmaWNpYXJ5OwogICAgfQoKICAgIC8vIE92ZXJyaWRlIHRoaXMgbWV0aG9kIHRvIG1vY2sgY3VycmVudCB0aW1lLgogICAgZnVuY3Rpb24gZ2V0Tm93KCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gbm93OwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFNhbGVFbmFibGVkKGJvb2wgX2VuYWJsZWQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHNhbGVFbmFibGVkID0gX2VuYWJsZWQ7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0QmVuZWZpY2lhcnkoYWRkcmVzcyBfYmVuZWZpY2lhcnkpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIEJlbmVmaWNpYXJ5Q2hhbmdlZChiZW5lZmljaWFyeSwgX2JlbmVmaWNpYXJ5KTsKICAgICAgICBiZW5lZmljaWFyeSA9IF9iZW5lZmljaWFyeTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXROb3RpZmllcihhZGRyZXNzIF9ub3RpZmllcikgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgTm90aWZpZXJDaGFuZ2VkKG5vdGlmaWVyLCBfbm90aWZpZXIpOwogICAgICAgIG5vdGlmaWVyID0gX25vdGlmaWVyOwogICAgfQoKICAgIC8qCiAgICAgKiBUaGUgZmFsbGJhY2sgZnVuY3Rpb24gY29ycmVzcG9uZHMgdG8gYSBkb25hdGlvbiBpbiBFVEgKICAgICAqLwogICAgZnVuY3Rpb24oKSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgaWYgKHNhbGVFbmFibGVkKSBzZWxsVG9rZW5zRm9yRXRoKG1zZy5zZW5kZXIsIG1zZy52YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gc2VsbFRva2Vuc0ZvckV0aChhZGRyZXNzIF9idXllciwgdWludDI1NiBfYW1vdW50V2VpKSBpbnRlcm5hbCBpZk5vdFBhdXNlZCByZXNwZWN0VGltZUZyYW1lIHsKCiAgICAgICAgdG90YWxXZWkgPSBzYWZlQWRkKHRvdGFsV2VpLCBfYW1vdW50V2VpKTsKICAgICAgICB3ZWlSZWNlaXZlZCA9IHNhZmVBZGQod2VpUmVjZWl2ZWQsIF9hbW91bnRXZWkpOwogICAgICAgIHJlcXVpcmUodG90YWxXZWkgPD0gbWF4Q2FwV2VpKTsgLy8gSWYgbWF4IGNhcCByZWFjaGVkLgoKICAgICAgICB1aW50MjU2IHRva2Vuc0UxOCA9IHdlaVRvVG9rZW5zKF9hbW91bnRXZWkpOwogICAgICAgIHJlcXVpcmUodG9rZW5zRTE4ID49IG1pblRva2Vuc1RvQnV5KTsKCiAgICAgICAgcmVxdWlyZSh0b2tlbi5zZWxsKF9idXllciwgdG9rZW5zRTE4KSk7IC8vIFRyYW5zZmVyIHRva2VucyB0byBidXllci4KICAgICAgICB0b3RhbFRva2Vuc1NvbGQgPSBzYWZlQWRkKHRvdGFsVG9rZW5zU29sZCwgdG9rZW5zRTE4KTsKICAgICAgICB0b3RhbEV0aFNhbGVzKys7CgogICAgICAgIEJhY2tlciBiYWNrZXIgPSBiYWNrZXJzW19idXllcl07CiAgICAgICAgYmFja2VyLnRva2Vuc1NlbnQgPSBzYWZlQWRkKGJhY2tlci50b2tlbnNTZW50LCB0b2tlbnNFMTgpOwogICAgICAgIGJhY2tlci53ZWlSZWNlaXZlZCA9IHNhZmVBZGQoYmFja2VyLndlaVJlY2VpdmVkLCBfYW1vdW50V2VpKTsgIC8vIFVwZGF0ZSB0aGUgdG90YWwgd2VpIGNvbGxlY3RlZCBkdXJpbmcgdGhlIGNyb3dkZnVuZGluZyBmb3IgdGhpcyBiYWNrZXIKCiAgICAgICAgRXRoUmVjZWl2ZWQoX2J1eWVyLCBfYW1vdW50V2VpKTsKICAgIH0KCiAgICAvLyBDYWxjIGhvdyBtdWNoIHRva2VucyB5b3UgY2FuIGJ1eSBhdCBjdXJyZW50IHRpbWUuCiAgICBmdW5jdGlvbiB3ZWlUb1Rva2Vucyh1aW50MjU2IF9hbW91bnRXZWkpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHdlaVRvVG9rZW5zQXRUaW1lKF9hbW91bnRXZWksIGdldE5vdygpKTsKICAgIH0KCiAgICBmdW5jdGlvbiB3ZWlUb1Rva2Vuc0F0VGltZSh1aW50MjU2IF9hbW91bnRXZWksIHVpbnQgX3RpbWUpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiByYXRlID0gdG9rZW5zUGVyV2VpOwoKICAgICAgICBpZiAoc3RhcnRUaW1lIDw9IF90aW1lICYmIF90aW1lIDwgYm9udXNFbmRUaW1lMzMzKSByYXRlID0gdG9rZW5zUGVyV2VpQm9udXMzMzM7CiAgICAgICAgZWxzZSBpZiAoYm9udXNFbmRUaW1lMzMzIDw9IF90aW1lICYmIF90aW1lIDwgYm9udXNFbmRUaW1lMjUwKSByYXRlID0gdG9rZW5zUGVyV2VpQm9udXMyNTA7CiAgICAgICAgZWxzZSBpZiAoYm9udXNFbmRUaW1lMjUwIDw9IF90aW1lICYmIF90aW1lIDwgZW5kVGltZSkgcmF0ZSA9IHRva2Vuc1BlcldlaUJvbnVzMTExOwoKICAgICAgICByZXR1cm4gc2FmZU11bChfYW1vdW50V2VpLCByYXRlKTsKICAgIH0KCiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIEJlZ2luIG9mIGV4dGVybmFsIHNhbGVzLgoKICAgIGZ1bmN0aW9uIGV4dGVybmFsU2FsZXMoCiAgICAgICAgdWludDhbXSBfY3VycmVuY2llcywKICAgICAgICBieXRlczMyW10gX3R4SWRTaGEzLAogICAgICAgIGFkZHJlc3NbXSBfYnV5ZXJzLAogICAgICAgIHVpbnQyNTZbXSBfYW1vdW50c1dlaSwKICAgICAgICB1aW50MjU2W10gX3Rva2Vuc0UxOAogICAgKSBwdWJsaWMgaWZOb3RQYXVzZWQgY2FuTm90aWZ5IHsKCiAgICAgICAgcmVxdWlyZShfY3VycmVuY2llcy5sZW5ndGggPiAwKTsKICAgICAgICByZXF1aXJlKF9jdXJyZW5jaWVzLmxlbmd0aCA9PSBfdHhJZFNoYTMubGVuZ3RoKTsKICAgICAgICByZXF1aXJlKF9jdXJyZW5jaWVzLmxlbmd0aCA9PSBfYnV5ZXJzLmxlbmd0aCk7CiAgICAgICAgcmVxdWlyZShfY3VycmVuY2llcy5sZW5ndGggPT0gX2Ftb3VudHNXZWkubGVuZ3RoKTsKICAgICAgICByZXF1aXJlKF9jdXJyZW5jaWVzLmxlbmd0aCA9PSBfdG9rZW5zRTE4Lmxlbmd0aCk7CgogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IF90eElkU2hhMy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBfZXh0ZXJuYWxTYWxlU2hhMygKICAgICAgICAgICAgICAgIEN1cnJlbmN5KF9jdXJyZW5jaWVzW2ldKSwKICAgICAgICAgICAgICAgIF90eElkU2hhM1tpXSwKICAgICAgICAgICAgICAgIF9idXllcnNbaV0sCiAgICAgICAgICAgICAgICBfYW1vdW50c1dlaVtpXSwKICAgICAgICAgICAgICAgIF90b2tlbnNFMThbaV0KICAgICAgICAgICAgKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gX2V4dGVybmFsU2FsZVNoYTMoCiAgICAgICAgQ3VycmVuY3kgX2N1cnJlbmN5LAogICAgICAgIGJ5dGVzMzIgX3R4SWRTaGEzLCAvLyBUbyBnZXQgYnl0ZXMzMiB1c2Uga2VjY2FrMjU2KHR4SWQpIE9SIHNoYTModHhJZCkKICAgICAgICBhZGRyZXNzIF9idXllciwKICAgICAgICB1aW50MjU2IF9hbW91bnRXZWksCiAgICAgICAgdWludDI1NiBfdG9rZW5zRTE4CiAgICApIGludGVybmFsIHsKCiAgICAgICAgcmVxdWlyZShfYnV5ZXIgPiAwICYmIF9hbW91bnRXZWkgPiAwICYmIF90b2tlbnNFMTggPiAwKTsKCiAgICAgICAgdmFyIHR4c0J5Q3VyID0gZXh0ZXJuYWxUeHNbdWludDgoX2N1cnJlbmN5KV07CgogICAgICAgIC8vIElmIHRoaXMgZm9yZWlnbiB0cmFuc2FjdGlvbiBoYXMgYmVlbiBhbHJlYWR5IHByb2Nlc3NlZCBpbiB0aGlzIGNvbnRyYWN0LgogICAgICAgIHJlcXVpcmUodHhzQnlDdXJbX3R4SWRTaGEzXSA9PSAwKTsKCiAgICAgICAgdG90YWxXZWkgPSBzYWZlQWRkKHRvdGFsV2VpLCBfYW1vdW50V2VpKTsKICAgICAgICByZXF1aXJlKHRvdGFsV2VpIDw9IG1heENhcFdlaSk7IC8vIE1heCBjYXAgc2hvdWxkIG5vdCBiZSByZWFjaGVkIHlldC4KCiAgICAgICAgcmVxdWlyZSh0b2tlbi5zZWxsKF9idXllciwgX3Rva2Vuc0UxOCkpOyAvLyBUcmFuc2ZlciB0b2tlbnMgdG8gYnV5ZXIuCiAgICAgICAgdG90YWxUb2tlbnNTb2xkID0gc2FmZUFkZCh0b3RhbFRva2Vuc1NvbGQsIF90b2tlbnNFMTgpOwogICAgICAgIHRvdGFsRXh0ZXJuYWxTYWxlcysrOwoKICAgICAgICB0eHNCeUN1cltfdHhJZFNoYTNdID0gX3Rva2Vuc0UxODsKICAgICAgICBFeHRlcm5hbFNhbGVTaGEzKF9jdXJyZW5jeSwgX3R4SWRTaGEzLCBfYnV5ZXIsIF9hbW91bnRXZWksIF90b2tlbnNFMTgpOwogICAgfQoKICAgIC8vIEdldCBpZCBvZiBjdXJyZW5jeSBlbnVtLiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIGZ1bmN0aW9uIGJ0Y0lkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgcmV0dXJuIHVpbnQ4KEN1cnJlbmN5LkJUQyk7CiAgICB9CgogICAgZnVuY3Rpb24gbHRjSWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gdWludDgoQ3VycmVuY3kuTFRDKTsKICAgIH0KCiAgICBmdW5jdGlvbiB6ZWNJZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50OCkgewogICAgICAgIHJldHVybiB1aW50OChDdXJyZW5jeS5aRUMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRhc2hJZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50OCkgewogICAgICAgIHJldHVybiB1aW50OChDdXJyZW5jeS5EQVNIKTsKICAgIH0KCiAgICBmdW5jdGlvbiB3YXZlc0lkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgcmV0dXJuIHVpbnQ4KEN1cnJlbmN5LldBVkVTKTsKICAgIH0KCiAgICBmdW5jdGlvbiB1c2RJZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50OCkgewogICAgICAgIHJldHVybiB1aW50OChDdXJyZW5jeS5VU0QpOwogICAgfQoKICAgIGZ1bmN0aW9uIGV1cklkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgcmV0dXJuIHVpbnQ4KEN1cnJlbmN5LkVVUik7CiAgICB9CgogICAgLy8gR2V0IHRva2VuIGNvdW50IGJ5IHRyYW5zYWN0aW9uIGlkLiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgZnVuY3Rpb24gX3Rva2Vuc0J5VHgoQ3VycmVuY3kgX2N1cnJlbmN5LCBzdHJpbmcgX3R4SWQpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gdG9rZW5zQnlUeCh1aW50OChfY3VycmVuY3kpLCBfdHhJZCk7CiAgICB9CgogICAgZnVuY3Rpb24gdG9rZW5zQnlUeCh1aW50OCBfY3VycmVuY3ksIHN0cmluZyBfdHhJZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gZXh0ZXJuYWxUeHNbX2N1cnJlbmN5XVtrZWNjYWsyNTYoX3R4SWQpXTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b2tlbnNCeUJ0Y1R4KHN0cmluZyBfdHhJZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gX3Rva2Vuc0J5VHgoQ3VycmVuY3kuQlRDLCBfdHhJZCk7CiAgICB9CgogICAgZnVuY3Rpb24gdG9rZW5zQnlMdGNUeChzdHJpbmcgX3R4SWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIF90b2tlbnNCeVR4KEN1cnJlbmN5LkxUQywgX3R4SWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRva2Vuc0J5WmVjVHgoc3RyaW5nIF90eElkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBfdG9rZW5zQnlUeChDdXJyZW5jeS5aRUMsIF90eElkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b2tlbnNCeURhc2hUeChzdHJpbmcgX3R4SWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIF90b2tlbnNCeVR4KEN1cnJlbmN5LkRBU0gsIF90eElkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b2tlbnNCeVdhdmVzVHgoc3RyaW5nIF90eElkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBfdG9rZW5zQnlUeChDdXJyZW5jeS5XQVZFUywgX3R4SWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRva2Vuc0J5VXNkVHgoc3RyaW5nIF90eElkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBfdG9rZW5zQnlUeChDdXJyZW5jeS5VU0QsIF90eElkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b2tlbnNCeUV1clR4KHN0cmluZyBfdHhJZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gX3Rva2Vuc0J5VHgoQ3VycmVuY3kuRVVSLCBfdHhJZCk7CiAgICB9CgogICAgLy8gRW5kIG9mIGV4dGVybmFsIHNhbGVzLgogICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgZnVuY3Rpb24gdG90YWxTYWxlcygpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHNhZmVBZGQodG90YWxFdGhTYWxlcywgdG90YWxFeHRlcm5hbFNhbGVzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBpc01heENhcFJlYWNoZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiB0b3RhbFdlaSA+PSBtYXhDYXBXZWk7CiAgICB9CgogICAgZnVuY3Rpb24gaXNTYWxlT24oKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHVpbnQgX25vdyA9IGdldE5vdygpOwogICAgICAgIHJldHVybiBzdGFydFRpbWUgPD0gX25vdyAmJiBfbm93IDw9IGVuZFRpbWU7CiAgICB9CgogICAgZnVuY3Rpb24gaXNTYWxlT3ZlcigpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIGdldE5vdygpID4gZW5kVGltZTsKICAgIH0KCiAgICBmdW5jdGlvbiBpc0ZpbmFsaXplZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIGZpbmFsaXplZFRpbWUgPiAwOwogICAgfQoKICAgIC8qCiAgICAgKiBGaW5hbGl6ZSB0aGUgY3Jvd2RzYWxlLiBSYWlzZWQgbW9uZXkgY2FuIGJlIHNlbnQgdG8gYmVuZWZpY2lhcnkgb25seSBpZiBjcm93ZHNhbGUgaGl0IGVuZCB0aW1lIG9yIG1heCBjYXAgKDE1bSBVU0QpLgogICAgICovCiAgICBmdW5jdGlvbiBmaW5hbGl6ZSgpIHB1YmxpYyBvbmx5T3duZXIgewoKICAgICAgICAvLyBDYW5ub3QgZmluYWxpc2UgYmVmb3JlIGVuZCBkYXkgb2YgY3Jvd2RzYWxlIHVudGlsIG1heCBjYXAgaXMgcmVhY2hlZC4KICAgICAgICByZXF1aXJlKGlzTWF4Q2FwUmVhY2hlZCgpIHx8IGlzU2FsZU92ZXIoKSk7CgogICAgICAgIGJlbmVmaWNpYXJ5LnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CgogICAgICAgIGZpbmFsaXplZFRpbWUgPSBnZXROb3coKTsKICAgIH0KfQoKY29udHJhY3QgQnNQcmVzYWxlIGlzIENvbW1vbkJzUHJlc2FsZSB7CgogICAgZnVuY3Rpb24gQnNQcmVzYWxlKCkgQ29tbW9uQnNQcmVzYWxlKAogICAgICAgIDB4N2FhNDNlZjhhYTE4MjlmY2U0MjBmZDFmOWU2ZWJiZTIyMTJiM2UwNiwgLy8gVE9ETyBhZGRyZXNzIF90b2tlbgogICAgICAgIDB4NzZDQTkxNDA1NDA5ODhkMzZmN2JlN0E4YjExNzJFMDlFNmQ4QTI2YyAgLy8gVE9ETyBhZGRyZXNzIF9iZW5lZmljaWFyeQogICAgKSB7fQp9'.
	

]
