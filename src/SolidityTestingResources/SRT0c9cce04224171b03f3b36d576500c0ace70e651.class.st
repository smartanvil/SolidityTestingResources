Class {
	#name : #SRT0c9cce04224171b03f3b36d576500c0ace70e651,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT0c9cce04224171b03f3b36d576500c0ace70e651 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjE7CgovLy8vLy8gbGliL2RzLXJvbGVzL2xpYi9kcy1hdXRoL3NyYy9hdXRoLnNvbAovLyBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQovLyBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQovLyB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcgovLyAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgoKLy8gVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCi8vIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCi8vIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKLy8gR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KCi8vIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCi8vIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgoKY29udHJhY3QgRFNBdXRob3JpdHkgewogICAgZnVuY3Rpb24gY2FuQ2FsbCgKICAgICAgICBhZGRyZXNzIHNyYywgYWRkcmVzcyBkc3QsIGJ5dGVzNCBzaWcKICAgICkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7Cn0KCmNvbnRyYWN0IERTQXV0aEV2ZW50cyB7CiAgICBldmVudCBMb2dTZXRBdXRob3JpdHkgKGFkZHJlc3MgaW5kZXhlZCBhdXRob3JpdHkpOwogICAgZXZlbnQgTG9nU2V0T3duZXIgICAgIChhZGRyZXNzIGluZGV4ZWQgb3duZXIpOwp9Cgpjb250cmFjdCBEU0F1dGggaXMgRFNBdXRoRXZlbnRzIHsKICAgIERTQXV0aG9yaXR5ICBwdWJsaWMgIGF1dGhvcml0eTsKICAgIGFkZHJlc3MgICAgICBwdWJsaWMgIG93bmVyOwoKICAgIGZ1bmN0aW9uIERTQXV0aCgpIHB1YmxpYyB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIExvZ1NldE93bmVyKG1zZy5zZW5kZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldE93bmVyKGFkZHJlc3Mgb3duZXJfKQogICAgICAgIHB1YmxpYwogICAgICAgIGF1dGgKICAgIHsKICAgICAgICBvd25lciA9IG93bmVyXzsKICAgICAgICBMb2dTZXRPd25lcihvd25lcik7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0QXV0aG9yaXR5KERTQXV0aG9yaXR5IGF1dGhvcml0eV8pCiAgICAgICAgcHVibGljCiAgICAgICAgYXV0aAogICAgewogICAgICAgIGF1dGhvcml0eSA9IGF1dGhvcml0eV87CiAgICAgICAgTG9nU2V0QXV0aG9yaXR5KGF1dGhvcml0eSk7CiAgICB9CgogICAgbW9kaWZpZXIgYXV0aCB7CiAgICAgICAgcmVxdWlyZShpc0F1dGhvcml6ZWQobXNnLnNlbmRlciwgbXNnLnNpZykpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gaXNBdXRob3JpemVkKGFkZHJlc3Mgc3JjLCBieXRlczQgc2lnKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAoc3JjID09IGFkZHJlc3ModGhpcykpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIGlmIChzcmMgPT0gb3duZXIpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIGlmIChhdXRob3JpdHkgPT0gRFNBdXRob3JpdHkoMCkpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBhdXRob3JpdHkuY2FuQ2FsbChzcmMsIHRoaXMsIHNpZyk7CiAgICAgICAgfQogICAgfQp9CgovLyBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQovLyBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQovLyB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcgovLyAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgoKLy8gVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCi8vIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCi8vIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKLy8gR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KCi8vIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCi8vIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgoKY29udHJhY3QgRFNNYXRoIHsKICAgIGZ1bmN0aW9uIGFkZCh1aW50IHgsIHVpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICByZXF1aXJlKCh6ID0geCArIHkpID49IHgpOwogICAgfQogICAgZnVuY3Rpb24gc3ViKHVpbnQgeCwgdWludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHJlcXVpcmUoKHogPSB4IC0geSkgPD0geCk7CiAgICB9CiAgICBmdW5jdGlvbiBtdWwodWludCB4LCB1aW50IHkpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCB6KSB7CiAgICAgICAgcmVxdWlyZSh5ID09IDAgfHwgKHogPSB4ICogeSkgLyB5ID09IHgpOwogICAgfQoKICAgIGZ1bmN0aW9uIG1pbih1aW50IHgsIHVpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICByZXR1cm4geCA8PSB5ID8geCA6IHk7CiAgICB9CiAgICBmdW5jdGlvbiBtYXgodWludCB4LCB1aW50IHkpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCB6KSB7CiAgICAgICAgcmV0dXJuIHggPj0geSA/IHggOiB5OwogICAgfQogICAgZnVuY3Rpb24gaW1pbihpbnQgeCwgaW50IHkpIGludGVybmFsIHB1cmUgcmV0dXJucyAoaW50IHopIHsKICAgICAgICByZXR1cm4geCA8PSB5ID8geCA6IHk7CiAgICB9CiAgICBmdW5jdGlvbiBpbWF4KGludCB4LCBpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChpbnQgeikgewogICAgICAgIHJldHVybiB4ID49IHkgPyB4IDogeTsKICAgIH0KCiAgICB1aW50IGNvbnN0YW50IFdBRCA9IDEwICoqIDE4OwogICAgdWludCBjb25zdGFudCBSQVkgPSAxMCAqKiAyNzsKCiAgICBmdW5jdGlvbiB3bXVsKHVpbnQgeCwgdWludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHogPSBhZGQobXVsKHgsIHkpLCBXQUQgLyAyKSAvIFdBRDsKICAgIH0KICAgIGZ1bmN0aW9uIHJtdWwodWludCB4LCB1aW50IHkpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCB6KSB7CiAgICAgICAgeiA9IGFkZChtdWwoeCwgeSksIFJBWSAvIDIpIC8gUkFZOwogICAgfQogICAgZnVuY3Rpb24gd2Rpdih1aW50IHgsIHVpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICB6ID0gYWRkKG11bCh4LCBXQUQpLCB5IC8gMikgLyB5OwogICAgfQogICAgZnVuY3Rpb24gcmRpdih1aW50IHgsIHVpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICB6ID0gYWRkKG11bCh4LCBSQVkpLCB5IC8gMikgLyB5OwogICAgfQoKICAgIC8vIFRoaXMgZmFtb3VzIGFsZ29yaXRobSBpcyBjYWxsZWQgImV4cG9uZW50aWF0aW9uIGJ5IHNxdWFyaW5nIgogICAgLy8gYW5kIGNhbGN1bGF0ZXMgeF5uIHdpdGggeCBhcyBmaXhlZC1wb2ludCBhbmQgbiBhcyByZWd1bGFyIHVuc2lnbmVkLgogICAgLy8KICAgIC8vIEl0J3MgTyhsb2cgbiksIGluc3RlYWQgb2YgTyhuKSBmb3IgbmFpdmUgcmVwZWF0ZWQgbXVsdGlwbGljYXRpb24uCiAgICAvLwogICAgLy8gVGhlc2UgZmFjdHMgYXJlIHdoeSBpdCB3b3JrczoKICAgIC8vCiAgICAvLyAgSWYgbiBpcyBldmVuLCB0aGVuIHhebiA9ICh4XjIpXihuLzIpLgogICAgLy8gIElmIG4gaXMgb2RkLCAgdGhlbiB4Xm4gPSB4ICogeF4obi0xKSwKICAgIC8vICAgYW5kIGFwcGx5aW5nIHRoZSBlcXVhdGlvbiBmb3IgZXZlbiB4IGdpdmVzCiAgICAvLyAgICB4Xm4gPSB4ICogKHheMileKChuLTEpIC8gMikuCiAgICAvLwogICAgLy8gIEFsc28sIEVWTSBkaXZpc2lvbiBpcyBmbG9vcmluZyBhbmQKICAgIC8vICAgIGZsb29yWyhuLTEpIC8gMl0gPSBmbG9vcltuIC8gMl0uCiAgICAvLwogICAgZnVuY3Rpb24gcnBvdyh1aW50IHgsIHVpbnQgbikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICB6ID0gbiAlIDIgIT0gMCA/IHggOiBSQVk7CgogICAgICAgIGZvciAobiAvPSAyOyBuICE9IDA7IG4gLz0gMikgewogICAgICAgICAgICB4ID0gcm11bCh4LCB4KTsKCiAgICAgICAgICAgIGlmIChuICUgMiAhPSAwKSB7CiAgICAgICAgICAgICAgICB6ID0gcm11bCh6LCB4KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKLy8gVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKLy8gaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKLy8gdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3IKLy8gKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KCi8vIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAovLyBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgovLyBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCi8vIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCgovLyBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQovLyBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KCmNvbnRyYWN0IERTTm90ZSB7CiAgICBldmVudCBMb2dOb3RlKAogICAgICAgIGJ5dGVzNCAgIGluZGV4ZWQgIHNpZywKICAgICAgICBhZGRyZXNzICBpbmRleGVkICBndXksCiAgICAgICAgYnl0ZXMzMiAgaW5kZXhlZCAgZm9vLAogICAgICAgIGJ5dGVzMzIgIGluZGV4ZWQgIGJhciwKICAgICAgICB1aW50ICAgICAgICAgICAgICB3YWQsCiAgICAgICAgYnl0ZXMgICAgICAgICAgICAgZmF4CiAgICApIGFub255bW91czsKCiAgICBtb2RpZmllciBub3RlIHsKICAgICAgICBieXRlczMyIGZvbzsKICAgICAgICBieXRlczMyIGJhcjsKCiAgICAgICAgYXNzZW1ibHkgewogICAgICAgICAgICBmb28gOj0gY2FsbGRhdGFsb2FkKDQpCiAgICAgICAgICAgIGJhciA6PSBjYWxsZGF0YWxvYWQoMzYpCiAgICAgICAgfQoKICAgICAgICBMb2dOb3RlKG1zZy5zaWcsIG1zZy5zZW5kZXIsIGZvbywgYmFyLCBtc2cudmFsdWUsIG1zZy5kYXRhKTsKCiAgICAgICAgXzsKICAgIH0KfQoKLy8gQ29weXJpZ2h0IChDKSAyMDE3ICBEYXBwSHViLCBMTEMKCi8vIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5Ci8vIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5Ci8vIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCi8vIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgovLyBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKLy8gYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKLy8gTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQovLyBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgoKLy8gWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKLy8gYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0uICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCgpjb250cmFjdCBEU1N0b3AgaXMgRFNOb3RlLCBEU0F1dGggewoKICAgIGJvb2wgcHVibGljIHN0b3BwZWQ7CgogICAgbW9kaWZpZXIgc3RvcHBhYmxlIHsKICAgICAgICByZXF1aXJlKCFzdG9wcGVkKTsKICAgICAgICBfOwogICAgfQogICAgZnVuY3Rpb24gc3RvcCgpIHB1YmxpYyBhdXRoIG5vdGUgewogICAgICAgIHN0b3BwZWQgPSB0cnVlOwogICAgfQogICAgZnVuY3Rpb24gc3RhcnQoKSBwdWJsaWMgYXV0aCBub3RlIHsKICAgICAgICBzdG9wcGVkID0gZmFsc2U7CiAgICB9Cgp9CgovLyBTZWUgPGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMD4uCgovLyBUaGlzIGZpbGUgbGlrZWx5IGRvZXMgbm90IG1lZXQgdGhlIHRocmVzaG9sZCBvZiBvcmlnaW5hbGl0eQovLyByZXF1aXJlZCBmb3IgY29weXJpZ2h0IHRvIGFwcGx5LiAgQXMgYSByZXN1bHQsIHRoaXMgaXMgZnJlZSBhbmQKLy8gdW5lbmN1bWJlcmVkIHNvZnR3YXJlIGJlbG9uZ2luZyB0byB0aGUgcHVibGljIGRvbWFpbi4KCmNvbnRyYWN0IEVSQzIwRXZlbnRzIHsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBzcmMsIGFkZHJlc3MgaW5kZXhlZCBndXksIHVpbnQgd2FkKTsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBzcmMsIGFkZHJlc3MgaW5kZXhlZCBkc3QsIHVpbnQgd2FkKTsKfQoKY29udHJhY3QgRVJDMjAgaXMgRVJDMjBFdmVudHMgewogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIGd1eSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCk7CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBzcmMsIGFkZHJlc3MgZ3V5KSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KTsKCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgZ3V5LCB1aW50IHdhZCkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBkc3QsIHVpbnQgd2FkKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oCiAgICAgICAgYWRkcmVzcyBzcmMsIGFkZHJlc3MgZHN0LCB1aW50IHdhZAogICAgKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7Cn0KCi8vIENvcHlyaWdodCAoQykgMjAxNSwgMjAxNiwgMjAxNyAgRGFwcEh1YiwgTExDCgovLyBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQovLyBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQovLyB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcgovLyAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgoKLy8gVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCi8vIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCi8vIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKLy8gR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KCi8vIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCi8vIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgoKY29udHJhY3QgRFNUb2tlbkJhc2UgaXMgRVJDMjAsIERTTWF0aCB7CiAgICB1aW50MjU2ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc3VwcGx5OwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSAgICAgICAgICAgICAgICAgICAgICAgX2JhbGFuY2VzOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSAgX2FwcHJvdmFsczsKCiAgICBmdW5jdGlvbiBEU1Rva2VuQmFzZSh1aW50IHN1cHBseSkgcHVibGljIHsKICAgICAgICBfYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBzdXBwbHk7CiAgICAgICAgX3N1cHBseSA9IHN1cHBseTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gX3N1cHBseTsKICAgIH0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHNyYykgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBfYmFsYW5jZXNbc3JjXTsKICAgIH0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIHNyYywgYWRkcmVzcyBndXkpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gX2FwcHJvdmFsc1tzcmNdW2d1eV07CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBkc3QsIHVpbnQgd2FkKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiB0cmFuc2ZlckZyb20obXNnLnNlbmRlciwgZHN0LCB3YWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIHNyYywgYWRkcmVzcyBkc3QsIHVpbnQgd2FkKQogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgaWYgKHNyYyAhPSBtc2cuc2VuZGVyKSB7CiAgICAgICAgICAgIF9hcHByb3ZhbHNbc3JjXVttc2cuc2VuZGVyXSA9IHN1YihfYXBwcm92YWxzW3NyY11bbXNnLnNlbmRlcl0sIHdhZCk7CiAgICAgICAgfQoKICAgICAgICBfYmFsYW5jZXNbc3JjXSA9IHN1YihfYmFsYW5jZXNbc3JjXSwgd2FkKTsKICAgICAgICBfYmFsYW5jZXNbZHN0XSA9IGFkZChfYmFsYW5jZXNbZHN0XSwgd2FkKTsKCiAgICAgICAgVHJhbnNmZXIoc3JjLCBkc3QsIHdhZCk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBndXksIHVpbnQgd2FkKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIF9hcHByb3ZhbHNbbXNnLnNlbmRlcl1bZ3V5XSA9IHdhZDsKCiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgZ3V5LCB3YWQpOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQoKLy8gQ29weXJpZ2h0IChDKSAyMDE1LCAyMDE2LCAyMDE3ICBEYXBwSHViLCBMTEMKCi8vIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5Ci8vIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5Ci8vIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCi8vIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgovLyBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKLy8gYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKLy8gTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQovLyBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgoKLy8gWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKLy8gYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0uICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCgpjb250cmFjdCBEU1Rva2VuIGlzIERTVG9rZW5CYXNlKDApLCBEU1N0b3AgewoKICAgIGJ5dGVzMzIgIHB1YmxpYyAgc3ltYm9sOwogICAgdWludDI1NiAgcHVibGljICBkZWNpbWFscyA9IDE4OyAvLyBzdGFuZGFyZCB0b2tlbiBwcmVjaXNpb24uIG92ZXJyaWRlIHRvIGN1c3RvbWl6ZQoKICAgIGZ1bmN0aW9uIERTVG9rZW4oYnl0ZXMzMiBzeW1ib2xfKSBwdWJsaWMgewogICAgICAgIHN5bWJvbCA9IHN5bWJvbF87CiAgICB9CgogICAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgZ3V5LCB1aW50IHdhZCk7CiAgICBldmVudCBCdXJuKGFkZHJlc3MgaW5kZXhlZCBndXksIHVpbnQgd2FkKTsKCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgZ3V5KSBwdWJsaWMgc3RvcHBhYmxlIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIuYXBwcm92ZShndXksIHVpbnQoLTEpKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgZ3V5LCB1aW50IHdhZCkgcHVibGljIHN0b3BwYWJsZSByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLmFwcHJvdmUoZ3V5LCB3YWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIHNyYywgYWRkcmVzcyBkc3QsIHVpbnQgd2FkKQogICAgICAgIHB1YmxpYwogICAgICAgIHN0b3BwYWJsZQogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgaWYgKHNyYyAhPSBtc2cuc2VuZGVyICYmIF9hcHByb3ZhbHNbc3JjXVttc2cuc2VuZGVyXSAhPSB1aW50KC0xKSkgewogICAgICAgICAgICBfYXBwcm92YWxzW3NyY11bbXNnLnNlbmRlcl0gPSBzdWIoX2FwcHJvdmFsc1tzcmNdW21zZy5zZW5kZXJdLCB3YWQpOwogICAgICAgIH0KCiAgICAgICAgX2JhbGFuY2VzW3NyY10gPSBzdWIoX2JhbGFuY2VzW3NyY10sIHdhZCk7CiAgICAgICAgX2JhbGFuY2VzW2RzdF0gPSBhZGQoX2JhbGFuY2VzW2RzdF0sIHdhZCk7CgogICAgICAgIFRyYW5zZmVyKHNyYywgZHN0LCB3YWQpOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBwdXNoKGFkZHJlc3MgZHN0LCB1aW50IHdhZCkgcHVibGljIHsKICAgICAgICB0cmFuc2ZlckZyb20obXNnLnNlbmRlciwgZHN0LCB3YWQpOwogICAgfQogICAgZnVuY3Rpb24gcHVsbChhZGRyZXNzIHNyYywgdWludCB3YWQpIHB1YmxpYyB7CiAgICAgICAgdHJhbnNmZXJGcm9tKHNyYywgbXNnLnNlbmRlciwgd2FkKTsKICAgIH0KICAgIGZ1bmN0aW9uIG1vdmUoYWRkcmVzcyBzcmMsIGFkZHJlc3MgZHN0LCB1aW50IHdhZCkgcHVibGljIHsKICAgICAgICB0cmFuc2ZlckZyb20oc3JjLCBkc3QsIHdhZCk7CiAgICB9CgogICAgZnVuY3Rpb24gbWludCh1aW50IHdhZCkgcHVibGljIHsKICAgICAgICBtaW50KG1zZy5zZW5kZXIsIHdhZCk7CiAgICB9CiAgICBmdW5jdGlvbiBidXJuKHVpbnQgd2FkKSBwdWJsaWMgewogICAgICAgIGJ1cm4obXNnLnNlbmRlciwgd2FkKTsKICAgIH0KICAgIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBndXksIHVpbnQgd2FkKSBwdWJsaWMgYXV0aCBzdG9wcGFibGUgewogICAgICAgIF9iYWxhbmNlc1tndXldID0gYWRkKF9iYWxhbmNlc1tndXldLCB3YWQpOwogICAgICAgIF9zdXBwbHkgPSBhZGQoX3N1cHBseSwgd2FkKTsKICAgICAgICBNaW50KGd1eSwgd2FkKTsKICAgIH0KICAgIGZ1bmN0aW9uIGJ1cm4oYWRkcmVzcyBndXksIHVpbnQgd2FkKSBwdWJsaWMgYXV0aCBzdG9wcGFibGUgewogICAgICAgIGlmIChndXkgIT0gbXNnLnNlbmRlciAmJiBfYXBwcm92YWxzW2d1eV1bbXNnLnNlbmRlcl0gIT0gdWludCgtMSkpIHsKICAgICAgICAgICAgX2FwcHJvdmFsc1tndXldW21zZy5zZW5kZXJdID0gc3ViKF9hcHByb3ZhbHNbZ3V5XVttc2cuc2VuZGVyXSwgd2FkKTsKICAgICAgICB9CgogICAgICAgIF9iYWxhbmNlc1tndXldID0gc3ViKF9iYWxhbmNlc1tndXldLCB3YWQpOwogICAgICAgIF9zdXBwbHkgPSBzdWIoX3N1cHBseSwgd2FkKTsKICAgICAgICBCdXJuKGd1eSwgd2FkKTsKICAgIH0KCiAgICAvLyBPcHRpb25hbCB0b2tlbiBuYW1lCiAgICBieXRlczMyICAgcHVibGljICBuYW1lID0gIiI7CgogICAgZnVuY3Rpb24gc2V0TmFtZShieXRlczMyIG5hbWVfKSBwdWJsaWMgYXV0aCB7CiAgICAgICAgbmFtZSA9IG5hbWVfOwogICAgfQp9CgovLyBDb3B5cmlnaHQgKEMpIDIwMTcgIERhcHBIdWIsIExMQwoKLy8gVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKLy8gaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKLy8gdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3IKLy8gKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KCi8vIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAovLyBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgovLyBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCi8vIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCgovLyBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQovLyBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KCmNvbnRyYWN0IERTVGhpbmcgaXMgRFNBdXRoLCBEU05vdGUsIERTTWF0aCB7CgogICAgZnVuY3Rpb24gUyhzdHJpbmcgcykgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChieXRlczQpIHsKICAgICAgICByZXR1cm4gYnl0ZXM0KGtlY2NhazI1NihzKSk7CiAgICB9Cgp9CgovLyBDb3B5cmlnaHQgKEMpIDIwMTcgIERhcHBIdWIsIExMQwoKLy8gVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKLy8gaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKLy8gdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3IKLy8gKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KCi8vIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAovLyBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgovLyBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCi8vIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCgovLyBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQovLyBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KCmNvbnRyYWN0IERTVmFsdWUgaXMgRFNUaGluZyB7CiAgICBib29sICAgIGhhczsKICAgIGJ5dGVzMzIgdmFsOwogICAgZnVuY3Rpb24gcGVlaygpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJ5dGVzMzIsIGJvb2wpIHsKICAgICAgICByZXR1cm4gKHZhbCxoYXMpOwogICAgfQogICAgZnVuY3Rpb24gcmVhZCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJ5dGVzMzIpIHsKICAgICAgICBieXRlczMyIHd1dDsgYm9vbCBoYXo7CiAgICAgICAgKHd1dCwgaGF6KSA9IHBlZWsoKTsKICAgICAgICBhc3NlcnQoaGF6KTsKICAgICAgICByZXR1cm4gd3V0OwogICAgfQogICAgZnVuY3Rpb24gcG9rZShieXRlczMyIHd1dCkgcHVibGljIG5vdGUgYXV0aCB7CiAgICAgICAgdmFsID0gd3V0OwogICAgICAgIGhhcyA9IHRydWU7CiAgICB9CiAgICBmdW5jdGlvbiB2b2lkKCkgcHVibGljIG5vdGUgYXV0aCB7ICAvLyB1bnNldCB0aGUgdmFsdWUKICAgICAgICBoYXMgPSBmYWxzZTsKICAgIH0KfQoKLy8gQ29weXJpZ2h0IChDKSAyMDE3LCAyMDE4IFJhaW4gPDxhIGhyZWY9Ii9jZG4tY2dpL2wvZW1haWwtcHJvdGVjdGlvbiIgY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSIxYTY4N2I3Mzc0Nzg2ODdmN2I3MTVhNjg3MzY5N2Y2ZjZhMzQ3NDdmNmUiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+PgoKLy8gVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKLy8gaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgQWZmZXJvIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5Ci8vIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCi8vIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgovLyBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKLy8gYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKLy8gTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQovLyBHTlUgQWZmZXJvIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KCi8vIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBBZmZlcm8gR2VuZXJhbCBQdWJsaWMgTGljZW5zZQovLyBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KCmNvbnRyYWN0IFNhaUxQQyBpcyBEU1RoaW5nIHsKICAgIC8vIFRoaXMgaXMgYSBzaW1wbGUgdHdvIHRva2VuIGxpcXVpZGl0eSBwb29sIHRoYXQgdXNlcyBhbiBleHRlcm5hbAogICAgLy8gcHJpY2UgZmVlZC4KCiAgICAvLyBNYWtlcnMKICAgIC8vIC0gYHBvb2xgIHRoZWlyIGdlbXMgYW5kIHJlY2VpdmUgTFBTIHRva2Vucywgd2hpY2ggYXJlIGEgY2xhaW0KICAgIC8vICAgIG9uIHRoZSBwb29sLgogICAgLy8gLSBgZXhpdGAgYW5kIHRyYWRlIHRoZWlyIExQUyB0b2tlbnMgZm9yIGEgc2hhcmUgb2YgdGhlIGdlbXMgaW4KICAgIC8vICAgIHRoZSBwb29sCgogICAgLy8gVGFrZXJzCiAgICAvLyAtIGB0YWtlYCBhbmQgZXhjaGFuZ2Ugb25lIGdlbSBmb3IgYW5vdGhlciwgd2hpbHN0IHBheWluZyBhCiAgICAvLyAgIGZlZSAodGhlIGBnYXBgKS4gVGhlIGNvbGxlY3RlZCBmZWUgZ29lcyBpbnRvIHRoZSBwb29sLgoKICAgIC8vIFRvIGF2b2lkIGBwb29sYCwgYGV4aXRgIGJlaW5nIHVzZWQgdG8gY2lyY3VtdmVudCB0aGUgdGFrZXIgZmVlLAogICAgLy8gbWFrZXJzIG11c3QgcGF5IHRoZSBzYW1lIGZlZSBvbiBgZXhpdGAuCgogICAgLy8gcHJvdmlkZSBsaXF1aWRpdHkgZm9yIHRoaXMgZ2VtIHBhaXIKICAgIEVSQzIwICAgIHB1YmxpYyAgcmVmOwogICAgRVJDMjAgICAgcHVibGljICBhbHQ7CgogICAgRFNWYWx1ZSAgcHVibGljICBwaXA7ICAvLyBwcmljZSBmZWVkLCBnaXZpbmcgcmVmcyBwZXIgYWx0CiAgICB1aW50MjU2ICBwdWJsaWMgIGdhcDsgIC8vIHNwcmVhZCwgY2hhcmdlZCBvbiBgdGFrZWAKICAgIERTVG9rZW4gIHB1YmxpYyAgbHBzOyAgLy8gJ2xpcXVpZGl0eSBwcm92aWRlciBzaGFyZXMnLCBlYXJucyBzcHJlYWQKCiAgICBmdW5jdGlvbiBTYWlMUEMoRVJDMjAgcmVmXywgRVJDMjAgYWx0XywgRFNWYWx1ZSBwaXBfLCBEU1Rva2VuIGxwc18pIHB1YmxpYyB7CiAgICAgICAgcmVmID0gcmVmXzsKICAgICAgICBhbHQgPSBhbHRfOwogICAgICAgIHBpcCA9IHBpcF87CgogICAgICAgIGxwcyA9IGxwc187CiAgICAgICAgZ2FwID0gV0FEOwogICAgfQoKICAgIGZ1bmN0aW9uIGp1bXAodWludCB3YWQpIHB1YmxpYyBub3RlIGF1dGggewogICAgICAgIGFzc2VydCh3YWQgIT0gMCk7CiAgICAgICAgZ2FwID0gd2FkOwogICAgfQoKICAgIC8vIHJlZiBwZXIgYWx0CiAgICBmdW5jdGlvbiB0YWcoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIHVpbnQocGlwLnJlYWQoKSk7CiAgICB9CgogICAgLy8gdG90YWwgcG9vbCB2YWx1ZQogICAgZnVuY3Rpb24gcGllKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBhZGQocmVmLmJhbGFuY2VPZih0aGlzKSwgd211bChhbHQuYmFsYW5jZU9mKHRoaXMpLCB0YWcoKSkpOwogICAgfQoKICAgIC8vIGxwcyBwZXIgcmVmCiAgICBmdW5jdGlvbiBwZXIoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIGxwcy50b3RhbFN1cHBseSgpID09IDAKICAgICAgICAgICAgID8gUkFZCiAgICAgICAgICAgICA6IHJkaXYobHBzLnRvdGFsU3VwcGx5KCksIHBpZSgpKTsKICAgIH0KCiAgICAvLyB7cmVmLGFsdH0gLT4gbHBzCiAgICBmdW5jdGlvbiBwb29sKEVSQzIwIGdlbSwgdWludCB3YWQpIHB1YmxpYyBub3RlIGF1dGggewogICAgICAgIHJlcXVpcmUoZ2VtID09IGFsdCB8fCBnZW0gPT0gcmVmKTsKCiAgICAgICAgdWludCBqYW0gPSAoZ2VtID09IHJlZikgPyB3YWQgOiB3bXVsKHdhZCwgdGFnKCkpOwogICAgICAgIHVpbnQgaW5rID0gcm11bChqYW0sIHBlcigpKTsKICAgICAgICBscHMubWludChpbmspOwogICAgICAgIGxwcy5wdXNoKG1zZy5zZW5kZXIsIGluayk7CgogICAgICAgIGdlbS50cmFuc2ZlckZyb20obXNnLnNlbmRlciwgdGhpcywgd2FkKTsKICAgIH0KCiAgICAvLyBscHMgLT4ge3JlZixhbHR9CiAgICBmdW5jdGlvbiBleGl0KEVSQzIwIGdlbSwgdWludCB3YWQpIHB1YmxpYyBub3RlIGF1dGggewogICAgICAgIHJlcXVpcmUoZ2VtID09IGFsdCB8fCBnZW0gPT0gcmVmKTsKCiAgICAgICAgdWludCBqYW0gPSAoZ2VtID09IHJlZikgPyB3YWQgOiB3bXVsKHdhZCwgdGFnKCkpOwogICAgICAgIHVpbnQgaW5rID0gcm11bChqYW0sIHBlcigpKTsKICAgICAgICAvLyBwYXkgZmVlIHRvIGV4aXQsIHVubGVzcyB5b3UncmUgdGhlIGxhc3Qgb3V0CiAgICAgICAgaW5rID0gKGphbSA9PSBwaWUoKSk/IGluayA6IHdtdWwoZ2FwLCBpbmspOwogICAgICAgIGxwcy5wdWxsKG1zZy5zZW5kZXIsIGluayk7CiAgICAgICAgbHBzLmJ1cm4oaW5rKTsKCiAgICAgICAgZ2VtLnRyYW5zZmVyKG1zZy5zZW5kZXIsIHdhZCk7CiAgICB9CgogICAgLy8gcmVmIDwtPiBhbHQKICAgIC8vIFRPRE86IG1lbWUgJ3N3YXAnPwogICAgLy8gVE9ETzogbWVtICd5ZW4nIG1lYW5zIHRvIGRlc2lyZS4gcGFpciB3aXRoICdwYXknPyBvciAnbmV5JwogICAgZnVuY3Rpb24gdGFrZShFUkMyMCBnZW0sIHVpbnQgd2FkKSBwdWJsaWMgbm90ZSBhdXRoIHsKICAgICAgICByZXF1aXJlKGdlbSA9PSBhbHQgfHwgZ2VtID09IHJlZik7CgogICAgICAgIHVpbnQgamFtID0gKGdlbSA9PSByZWYpID8gd2Rpdih3YWQsIHRhZygpKSA6IHdtdWwod2FkLCB0YWcoKSk7CiAgICAgICAgamFtID0gd211bChnYXAsIGphbSk7CgogICAgICAgIEVSQzIwIHBheSA9IChnZW0gPT0gcmVmKSA/IGFsdCA6IHJlZjsKICAgICAgICBwYXkudHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIHRoaXMsIGphbSk7CiAgICAgICAgZ2VtLnRyYW5zZmVyKG1zZy5zZW5kZXIsIHdhZCk7CiAgICB9Cn0KCi8vLyBAdGl0bGUgS3liZXIgUmVzZXJ2ZSBjb250cmFjdAppbnRlcmZhY2UgS3liZXJSZXNlcnZlSW50ZXJmYWNlIHsKICAgIGZ1bmN0aW9uKCkgcGF5YWJsZTsKICAgIGZ1bmN0aW9uIGdldENvbnZlcnNpb25SYXRlKEVSQzIwIHNyYywgRVJDMjAgZGVzdCwgdWludCBzcmNRdHksIHVpbnQgYmxvY2tOdW1iZXIpIGV4dGVybmFsIHZpZXcgcmV0dXJucyh1aW50KTsKICAgIGZ1bmN0aW9uIHdpdGhkcmF3KEVSQzIwIHRva2VuLCB1aW50IGFtb3VudCwgYWRkcmVzcyBkZXN0aW5hdGlvbikgZXh0ZXJuYWwgcmV0dXJucyhib29sKTsKICAgIGZ1bmN0aW9uIGdldEJhbGFuY2UoRVJDMjAgdG9rZW4pIGV4dGVybmFsIHZpZXcgcmV0dXJucyh1aW50KTsKfQoKaW50ZXJmYWNlIFdFVEhJbnRlcmZhY2UgewogIGZ1bmN0aW9uKCkgZXh0ZXJuYWwgcGF5YWJsZTsKICBmdW5jdGlvbiBkZXBvc2l0KCkgZXh0ZXJuYWwgcGF5YWJsZTsKICBmdW5jdGlvbiB3aXRoZHJhdyh1aW50IHdhZCkgZXh0ZXJuYWw7Cn0KCmNvbnRyYWN0IFdFVEggaXMgV0VUSEludGVyZmFjZSwgRVJDMjAgeyB9Cgpjb250cmFjdCBMUENSZXNlcnZlV3JhcHBlciBpcyBEU1RoaW5nIHsKICAgIEVSQzIwIGNvbnN0YW50IGludGVybmFsIEVUSF9UT0tFTl9BRERSRVNTID0gRVJDMjAoMHgwMGVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWUpOwoKICAgIEt5YmVyUmVzZXJ2ZUludGVyZmFjZSBwdWJsaWMgcmVzZXJ2ZTsKICAgIFdFVEggcHVibGljIHdldGg7CiAgICBFUkMyMCBwdWJsaWMgZGFpOwogICAgU2FpTFBDIHB1YmxpYyBscGM7CgogICAgZnVuY3Rpb24gTFBDUmVzZXJ2ZVdyYXBwZXIoS3liZXJSZXNlcnZlSW50ZXJmYWNlIHJlc2VydmVfLCBXRVRIIHdldGhfLCBFUkMyMCBkYWlfLCBTYWlMUEMgbHBjXykgcHVibGljIHsKICAgICAgICBhc3NlcnQoYWRkcmVzcyhyZXNlcnZlXykgIT0gMCk7CiAgICAgICAgYXNzZXJ0KGFkZHJlc3Mod2V0aF8pICE9IDApOwogICAgICAgIGFzc2VydChhZGRyZXNzKGRhaV8pICE9IDApOwogICAgICAgIGFzc2VydChhZGRyZXNzKGxwY18pICE9IDApOwoKICAgICAgICByZXNlcnZlID0gcmVzZXJ2ZV87CiAgICAgICAgd2V0aCA9IHdldGhfOwogICAgICAgIGxwYyA9IGxwY187CiAgICAgICAgZGFpID0gZGFpXzsKICAgIH0KCiAgICBmdW5jdGlvbiBzd2l0Y2hMUEMoU2FpTFBDIGxwY18pIHB1YmxpYyBub3RlIGF1dGggewogICAgICAgIGFzc2VydChhZGRyZXNzKGxwY18pICE9IDApOwogICAgICAgIGxwYyA9IGxwY187CiAgICB9CgogICAgZnVuY3Rpb24gc3dpdGNoUmVzZXJ2ZShLeWJlclJlc2VydmVJbnRlcmZhY2UgcmVzZXJ2ZV8pIHB1YmxpYyBub3RlIGF1dGggewogICAgICAgIGFzc2VydChhZGRyZXNzKHJlc2VydmVfKSAhPSAwKTsKICAgICAgICByZXNlcnZlID0gcmVzZXJ2ZV87CiAgICB9CgogICAgZnVuY3Rpb24oKSBwdWJsaWMgcGF5YWJsZSB7IH0KCiAgICBmdW5jdGlvbiB3aXRoZHJhd0Zyb21SZXNlcnZlKEVSQzIwIHRva2VuLCB1aW50IGFtb3VudCkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgaWYgKHRva2VuID09IHdldGgpIHsKICAgICAgICAgICAgcmVxdWlyZShyZXNlcnZlLndpdGhkcmF3KEVUSF9UT0tFTl9BRERSRVNTLCBhbW91bnQsIHRoaXMpKTsKICAgICAgICAgICAgd2V0aC5kZXBvc2l0LnZhbHVlKGFtb3VudCkoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXF1aXJlKHJlc2VydmUud2l0aGRyYXcodG9rZW4sIGFtb3VudCwgdGhpcykpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlclRvUmVzZXJ2ZShFUkMyMCB0b2tlbiwgdWludCBhbW91bnQpIGludGVybmFsIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGlmICh0b2tlbiA9PSB3ZXRoKSB7CiAgICAgICAgICAgIHdldGgud2l0aGRyYXcoYW1vdW50KTsKICAgICAgICAgICAgcmVzZXJ2ZS50cmFuc2ZlcihhbW91bnQpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlcXVpcmUodG9rZW4udHJhbnNmZXIocmVzZXJ2ZSwgYW1vdW50KSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGFwcHJvdmVUb2tlbihFUkMyMCB0b2tlbiwgYWRkcmVzcyB3aG8sIHVpbnQgd2FkKSBwdWJsaWMgbm90ZSBhdXRoIHsKICAgICAgICByZXF1aXJlKHRva2VuLmFwcHJvdmUod2hvLCB3YWQpKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0YWtlKEVSQzIwIHRva2VuLCB1aW50IHdhZCkgcHVibGljIG5vdGUgYXV0aCB7CiAgICAgICAgcmVxdWlyZSh0b2tlbiA9PSB3ZXRoIHx8IHRva2VuID09IGRhaSk7CiAgICAgICAgLy8gSGFuZGxlIG9ubHkgcmVmID09IERBSSBhbmQgYWx0ID09IFdFVEggaW4gdGhpcyBjb250cmFjdAogICAgICAgIHJlcXVpcmUobHBjLnJlZigpID09IGRhaSk7CiAgICAgICAgcmVxdWlyZShscGMuYWx0KCkgPT0gd2V0aCk7CiAgICAgICAgLy8gR2V0IGZyb20gTFBDIHRoZSBhbW91bnQgdGhhdCB3ZSBuZWVkIHRvIGhhdmUKICAgICAgICB1aW50IGFtb3VudFRvV2l0aGRyYXcgPSAodG9rZW4gPT0gZGFpKSA/IHdkaXYod2FkLCBscGMudGFnKCkpIDogd211bCh3YWQsIGxwYy50YWcoKSk7CiAgICAgICAgLy8gR2V0IHRoZSBhbW91bnQgZnJvbSB0aGUgcmVzZXJ2ZQogICAgICAgIHJlcXVpcmUod2l0aGRyYXdGcm9tUmVzZXJ2ZSgodG9rZW4gPT0gZGFpKSA/IHdldGggOiBkYWksIGFtb3VudFRvV2l0aGRyYXcpKTsKICAgICAgICAvLyBNYWdpYwogICAgICAgIGxwYy50YWtlKHRva2VuLCB3YWQpOwogICAgICAgIC8vIFRyYW5zZmVyIERBSS9XRVRIIHRvIHJlc2VydmUKICAgICAgICByZXF1aXJlKHRyYW5zZmVyVG9SZXNlcnZlKHRva2VuLCB3YWQpKTsKICAgIH0KCiAgICBmdW5jdGlvbiB3aXRoZHJhdyhFUkMyMCB0b2tlbiwgdWludCBhbW91bnQsIGFkZHJlc3MgZGVzdGluYXRpb24pIHB1YmxpYyBub3RlIGF1dGggewogICAgICAgIGlmICh0b2tlbiA9PSBFVEhfVE9LRU5fQUREUkVTUykgewogICAgICAgICAgICBkZXN0aW5hdGlvbi50cmFuc2ZlcihhbW91bnQpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlcXVpcmUodG9rZW4udHJhbnNmZXIoZGVzdGluYXRpb24sIGFtb3VudCkpOwogICAgICAgIH0KICAgIH0KfQ=='.
	

]
