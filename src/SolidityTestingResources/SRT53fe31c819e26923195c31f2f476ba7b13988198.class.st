Class {
	#name : #SRT53fe31c819e26923195c31f2f476ba7b13988198,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT53fe31c819e26923195c31f2f476ba7b13988198 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuODsKCgovKioKICogTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcwogKiBCeSBPcGVuWmVwcGVsaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL1NhZmVNYXRoLnNvbAogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCmNvbnRyYWN0IENvbnRyYWN0UmVjZWl2ZXJ7CiAgICBmdW5jdGlvbiB0b2tlbkZhbGxiYWNrKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyAgX2RhdGEpIGV4dGVybmFsOwp9Cgpjb250cmFjdCBPd25hYmxlIHsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwogICAgYWRkcmVzcyBwdWJsaWMgb3duZXJDYW5kaWRhdGU7CiAgICBldmVudCBPd25lclRyYW5zZmVyKGFkZHJlc3Mgb3JpZ2luYWxPd25lciwgYWRkcmVzcyBjdXJyZW50T3duZXIpOwoKICAgIG1vZGlmaWVyIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHByb3Bvc2VOZXdPd25lcihhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkgJiYgbmV3T3duZXIgIT0gb3duZXIpOwogICAgICAgIG93bmVyQ2FuZGlkYXRlID0gbmV3T3duZXI7CiAgICB9CgogICAgZnVuY3Rpb24gYWNjZXB0T3duZXJUcmFuc2ZlcigpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyQ2FuZGlkYXRlKTsKICAgICAgICBPd25lclRyYW5zZmVyKG93bmVyLCBvd25lckNhbmRpZGF0ZSk7CiAgICAgICAgb3duZXIgPSBvd25lckNhbmRpZGF0ZTsKICAgIH0KfQoKY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9Cgpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgLyoqCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1ttc2cuc2VuZGVyXSk7CgogICAgLy8gU2FmZU1hdGguc3ViIHdpbGwgdGhyb3cgaWYgdGhlcmUgaXMgbm90IGVub3VnaCBiYWxhbmNlLgogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgKi8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CgoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CgogIC8qKgogICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAogICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICovCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCi8vIEJhc2VkIGluIHBhcnQgb24gY29kZSBieSBPcGVuLVplcHBlbGluOiBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5LmdpdAovLyBCYXNlZCBpbiBwYXJ0IG9uIGNvZGUgYnkgRmlyc3RCbG9vZDogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sCi8vIFNtYXJ0IGNvbnRyYWN0IGZvciB0aGUgUmVwdVggdG9rZW4gJiB0aGUgZmlyc3QgY3Jvd2RzYWxlCmNvbnRyYWN0IFJlcHVYIGlzIFN0YW5kYXJkVG9rZW4sIE93bmFibGUgewogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIlJlcHVYIjsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIlJFUFVYIjsKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CiAgICBhZGRyZXNzIHB1YmxpYyBtdWx0aXNpZzsgLy9tdWx0aXNpZyB3YWxsZXQsIHRvIHdoaWNoIGFsbCBjb250cmlidXRpb25zIHdpbGwgYmUgc2VudAoKICAgIHVpbnQyNTYgcHVibGljIHBoYXNlMVN0YXJ0QmxvY2s7IC8vQ3Jvd2RzYWxlIHN0YXJ0IGJsb2NrCiAgICB1aW50MjU2IHB1YmxpYyBwaGFzZTFFbmRCbG9jazsgLy8gRGF5IDcgKGVzdGltYXRlKQogICAgdWludDI1NiBwdWJsaWMgcGhhc2UyRW5kQmxvY2s7IC8vIERheSAxMyAoZXN0aW1hdGUpCiAgICB1aW50MjU2IHB1YmxpYyBwaGFzZTNFbmRCbG9jazsgLy8gRGF5IDE5IChlc3RpbWF0ZSkKICAgIHVpbnQyNTYgcHVibGljIHBoYXNlNEVuZEJsb2NrOyAvLyBEYXkgMjUgKGVzdGltYXRlKQogICAgdWludDI1NiBwdWJsaWMgcGhhc2U1RW5kQmxvY2s7IC8vIERheSAzMSAoZXN0aW1hdGUpCiAgICB1aW50MjU2IHB1YmxpYyBlbmRCbG9jazsgLy93aG9sZSBjcm93ZHNhbGUgZW5kIGJsb2NrCgogICAgdWludDI1NiBwdWJsaWMgYmFzZVByaWNlID0gMTIyNiAqICgxMCoqMTIpOyAvLyBJQ08gdG9rZW4gYmFzZSBwcmljZTogfiQwLjM1IChlc3RpbWF0ZSBhc3N1bWluZyAkMjkwIHBlciBFdGgpCgogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHkgPSA1MDAwMDAwMDAgKiAoMTAqKmRlY2ltYWxzKTsgLy9Ub2tlbiB0b3RhbCBzdXBwbHk6IDUwMDAwMDAwMCBSUFgKICAgIHVpbnQyNTYgcHVibGljIHByZXNhbGVUb2tlblN1cHBseSA9IHRvdGFsU3VwcGx5Lm11bCgxMCkuZGl2KDEwMCk7IC8vQW1vdW50IG9mIHRva2VucyBhdmFpbGFibGUgZHVyaW5nIHByZXNhbGUgKDEwJSkKICAgIHVpbnQyNTYgcHVibGljIGNyb3dkc2FsZVRva2VuU3VwcGx5ID0gdG90YWxTdXBwbHkubXVsKDUwKS5kaXYoMTAwKTsgLy9BbW91bnQgb2YgdG9rZW5zIGF2YWlsYWJsZSBkdXJpbmcgY3Jvd2RzYWxlICg1MCUpCiAgICB1aW50MjU2IHB1YmxpYyByZXdhcmRzVG9rZW5TdXBwbHkgPSB0b3RhbFN1cHBseS5tdWwoMTUpLmRpdigxMDApOyAvL1Jld2FyZHMgcG9vbCAoVklQIGV0YywgMTAlKSwgYW1iYXNzYWRvciBzaGFyZSgzJSkgJiBJQ08gYm91bnRpZXMoMiUpCiAgICB1aW50MjU2IHB1YmxpYyB0ZWFtVG9rZW5TdXBwbHkgPSB0b3RhbFN1cHBseS5tdWwoMTIpLmRpdigxMDApOyAvL1Rva2VucyBkaXN0cmlidXRlZCB0byB0ZWFtICgxMiUgaW4gdG90YWwsIDQlIHZlc3RlZCBmb3IgMTIsIDI0ICYgMzYgbW9udGhzKQogICAgdWludDI1NiBwdWJsaWMgSUNPUmVzZXJ2ZVN1cHBseSA9IHRvdGFsU3VwcGx5Lm11bCgxMykuZGl2KDEwMCk7IC8vVG9rZW4gcmVzZXJ2ZSBmb3IgMm5kIElDTyAoYWZ0ZXIgMiB5ZWFycyBtaW4sIDEzJSkKICAgIHVpbnQyNTYgcHVibGljIHByZXNhbGVUb2tlblNvbGQgPSAwOyAvL1JlY29yZHMgdGhlIGFtb3VudCBvZiB0b2tlbnMgc29sZCBkdXJpbmcgcHJlc2FsZQogICAgdWludDI1NiBwdWJsaWMgY3Jvd2RzYWxlVG9rZW5Tb2xkID0gMDsgLy9SZWNvcmRzIHRoZSBhbW91bnQgb2YgdG9rZW5zIHNvbGQgZHVyaW5nIHRoZSBjcm93ZHNhbGUKCiAgICB1aW50MjU2IHB1YmxpYyBwaGFzZTFDYXAgPSAxMjUwMDAwMDAgKiAoMTAqKmRlY2ltYWxzKTsKICAgIHVpbnQyNTYgcHVibGljIHBoYXNlMkNhcCA9IHBoYXNlMUNhcC5hZGQoNTAwMDAwMDAgKiAoMTAqKmRlY2ltYWxzKSk7CiAgICB1aW50MjU2IHB1YmxpYyBwaGFzZTNDYXAgPSBwaGFzZTJDYXAuYWRkKDM3NTAwMDAwICogKDEwKipkZWNpbWFscykpOwogICAgdWludDI1NiBwdWJsaWMgcGhhc2U0Q2FwID0gcGhhc2UzQ2FwLmFkZCgyNTAwMDAwMCAqICgxMCoqZGVjaW1hbHMpKTsKCiAgICB1aW50MjU2IHB1YmxpYyB0cmFuc2ZlckxvY2t1cCA9IDU3NjA7IC8vTG9jayB1cCB0b2tlbiB0cmFuc2ZlciB1bnRpbCB+MiBkYXlzIGFmdGVyIGNyb3dkc2FsZSBjb25jbHVkZXMKICAgIHVpbnQyNTYgcHVibGljIHRlYW1Mb2NrVXA7IAogICAgdWludDI1NiBwdWJsaWMgSUNPUmVzZXJ2ZUxvY2tVcDsKICAgIHVpbnQyNTYgcHJpdmF0ZSB0ZWFtV2l0aGRyYXdsQ291bnQgPSAwOwogICAgdWludDI1NiBwdWJsaWMgYXZlcmFnZUJsb2NrVGltZSA9IDMwOyAvL0F2ZXJhZ2UgYmxvY2sgdGltZSBpbiBzZWNvbmRzCgogICAgYm9vbCBwdWJsaWMgcHJlc2FsZVN0YXJ0ZWQgPSBmYWxzZTsKICAgIGJvb2wgcHVibGljIHByZXNhbGVDb25jbHVkZWQgPSBmYWxzZTsKICAgIGJvb2wgcHVibGljIGNyb3dkc2FsZVN0YXJ0ZWQgPSBmYWxzZTsKICAgIGJvb2wgcHVibGljIGNyb3dkc2FsZUNvbmNsdWRlZCA9IGZhbHNlOwogICAgYm9vbCBwdWJsaWMgSUNPUmVzZXJ2ZVdpdGhkcmF3biA9IGZhbHNlOwogICAgYm9vbCBwdWJsaWMgaGFsdGVkID0gZmFsc2U7IC8vSGFsdCBjcm93ZHNhbGUgaW4gZW1lcmdlbmN5CgogICAgdWludDI1NiBjb250cmlidXRpb25Db3VudCA9IDA7CiAgICBieXRlczMyW10gcHVibGljIGNvbnRyaWJ1dGlvbkhhc2hlczsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gQ29udHJpYnV0aW9uKSBwcml2YXRlIGNvbnRyaWJ1dGlvbnM7CgogICAgZXZlbnQgSGFsdCgpOyAvL0hhbHQgZXZlbnQKICAgIGV2ZW50IFVuaGFsdCgpOyAvL1VuaGFsdCBldmVudAogICAgZXZlbnQgQnVybihhZGRyZXNzIGJ1cm5lciwgdWludDI1NiBhbW91bnQpOwoKICAgIHN0cnVjdCBDb250cmlidXRpb24gewogICAgICAgIGFkZHJlc3MgY29udHJpYnV0b3I7CiAgICAgICAgYWRkcmVzcyByZWNpcGllbnQ7CiAgICAgICAgdWludDI1NiBldGhXZWk7CiAgICAgICAgdWludDI1NiB0b2tlbnM7CiAgICAgICAgYm9vbCByZXNvbHZlZDsKICAgICAgICBib29sIHN1Y2Nlc3M7CiAgICAgICAgdWludDggc3RhZ2U7CiAgICB9CgogICAgZXZlbnQgQ29udHJpYnV0aW9uUmVjZWl2ZWQoYnl0ZXMzMiBjb250cmlidXRpb25IYXNoLCBhZGRyZXNzIGNvbnRyaWJ1dG9yLCBhZGRyZXNzIHJlY2lwaWVudCwKICAgICAgICB1aW50MjU2IGV0aFdlaSwgdWludDI1NiBwZW5kaW5nVG9rZW5zKTsKCiAgICBldmVudCBDb250cmlidXRpb25SZXNvbHZlZChieXRlczMyIGNvbnRyaWJ1dGlvbkhhc2gsIGJvb2wgcGFzcywgYWRkcmVzcyBjb250cmlidXRvciwgCiAgICAgICAgYWRkcmVzcyByZWNpcGllbnQsIHVpbnQyNTYgZXRoV2VpLCB1aW50MjU2IHRva2Vucyk7CgoKICAgIC8vIGxvY2t1cCBkdXJpbmcgYW5kIGFmdGVyIDQ4aCBvZiBlbmQgb2YgY3Jvd2RzYWxlCiAgICBtb2RpZmllciBjcm93ZHNhbGVUcmFuc2ZlckxvY2soKSB7CiAgICAgICAgcmVxdWlyZShjcm93ZHNhbGVDb25jbHVkZWQgJiYgYmxvY2subnVtYmVyID49IGVuZEJsb2NrLmFkZCh0cmFuc2ZlckxvY2t1cCkpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgd2hlbk5vdEhhbHRlZCgpIHsKICAgICAgICByZXF1aXJlKCFoYWx0ZWQpOwogICAgICAgIF87CiAgICB9CgogICAgLy9Db25zdHJ1Y3Rvcjogc2V0IG93bmVyICh0ZWFtKSBhZGRyZXNzICYgY3Jvd2RzYWxlIHJlY2lwaWVudCBtdWx0aXNpZyB3YWxsZXQgYWRkcmVzcwogICAgLy9BbGxvY2F0ZSByZXdhcmQgdG9rZW5zIHRvIHRoZSB0ZWFtIHdhbGxldAogIAlmdW5jdGlvbiBSZXB1WChhZGRyZXNzIF9tdWx0aXNpZykgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgICAgICBtdWx0aXNpZyA9IF9tdWx0aXNpZzsKICAgICAgICBiYWxhbmNlc1tvd25lcl0gPSByZXdhcmRzVG9rZW5TdXBwbHk7CiAgCX0KCiAgICAvL0ZhbGxiYWNrIGZ1bmN0aW9uIHdoZW4gcmVjZWl2aW5nIEV0aGVyLiBDb250cmlidXRvcnMgY2FuIGRpcmVjdGx5IHNlbmQgRXRoZXIgdG8gdGhlIHRva2VuIGFkZHJlc3MgZHVyaW5nIGNyb3dkc2FsZS4KICAgIGZ1bmN0aW9uKCkgcGF5YWJsZSB7CiAgICAgICAgYnV5KCk7CiAgICB9CgoKICAgIC8vSGFsdCBJQ08gaW4gY2FzZSBvZiBlbWVyZ2VuY3kuCiAgICBmdW5jdGlvbiBoYWx0KCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgaGFsdGVkID0gdHJ1ZTsKICAgICAgICBIYWx0KCk7CiAgICB9CgogICAgZnVuY3Rpb24gdW5oYWx0KCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgaGFsdGVkID0gZmFsc2U7CiAgICAgICAgVW5oYWx0KCk7CiAgICB9CgogICAgZnVuY3Rpb24gc3RhcnRQcmVzYWxlKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZSghcHJlc2FsZVN0YXJ0ZWQpOwogICAgICAgIHByZXNhbGVTdGFydGVkID0gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBjb25jbHVkZVByZXNhbGUoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKHByZXNhbGVTdGFydGVkICYmICFwcmVzYWxlQ29uY2x1ZGVkKTsKICAgICAgICBwcmVzYWxlQ29uY2x1ZGVkID0gdHJ1ZTsKICAgICAgICAvL1Vuc29sZCB0b2tlbnMgaW4gdGhlIHByZXNhbGUgYXJlIG1hZGUgYXZhaWxhYmxlIGluIHRoZSBjcm93ZHNhbGUuCiAgICAgICAgY3Jvd2RzYWxlVG9rZW5TdXBwbHkgPSBjcm93ZHNhbGVUb2tlblN1cHBseS5hZGQocHJlc2FsZVRva2VuU3VwcGx5LnN1YihwcmVzYWxlVG9rZW5Tb2xkKSk7IAogICAgfQoKICAgIC8vQ2FuIG9ubHkgYmUgY2FsbGVkIGFmdGVyIHByZXNhbGUgaXMgY29uY2x1ZGVkLgogICAgZnVuY3Rpb24gc3RhcnRDcm93ZHNhbGUoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKHByZXNhbGVDb25jbHVkZWQgJiYgIWNyb3dkc2FsZVN0YXJ0ZWQpOwogICAgICAgIGNyb3dkc2FsZVN0YXJ0ZWQgPSB0cnVlOwogICAgICAgIHBoYXNlMVN0YXJ0QmxvY2sgPSBibG9jay5udW1iZXI7CiAgICAgICAgcGhhc2UxRW5kQmxvY2sgPSBwaGFzZTFTdGFydEJsb2NrLmFkZChkYXlUb0Jsb2NrTnVtYmVyKDcpKTsKICAgICAgICBwaGFzZTJFbmRCbG9jayA9IHBoYXNlMUVuZEJsb2NrLmFkZChkYXlUb0Jsb2NrTnVtYmVyKDYpKTsKICAgICAgICBwaGFzZTNFbmRCbG9jayA9IHBoYXNlMkVuZEJsb2NrLmFkZChkYXlUb0Jsb2NrTnVtYmVyKDYpKTsKICAgICAgICBwaGFzZTRFbmRCbG9jayA9IHBoYXNlM0VuZEJsb2NrLmFkZChkYXlUb0Jsb2NrTnVtYmVyKDYpKTsKICAgICAgICBwaGFzZTVFbmRCbG9jayA9IHBoYXNlNEVuZEJsb2NrLmFkZChkYXlUb0Jsb2NrTnVtYmVyKDYpKTsKICAgICAgICBlbmRCbG9jayA9IHBoYXNlNUVuZEJsb2NrOwogICAgfQoKICAgIC8vQ2FuIG9ubHkgYmUgY2FsbGVkIGVpdGhlciBhZnRlciBjcm93ZHNhbGUgdGltZSBwZXJpb2QgZW5kcywgb3IgYWZ0ZXIgdG9rZW5zIGhhdmUgc29sZCBvdXQKICAgIGZ1bmN0aW9uIGNvbmNsdWRlQ3Jvd2RzYWxlKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShjcm93ZHNhbGVTdGFydGVkICYmICFjcm93ZHNhbGVPbigpICYmICFjcm93ZHNhbGVDb25jbHVkZWQpOwogICAgICAgIGNyb3dkc2FsZUNvbmNsdWRlZCA9IHRydWU7CiAgICAgICAgZW5kQmxvY2sgPSBibG9jay5udW1iZXI7CiAgICAgICAgdWludDI1NiB1bnNvbGQgPSBjcm93ZHNhbGVUb2tlblN1cHBseS5zdWIoY3Jvd2RzYWxlVG9rZW5Tb2xkKTsKICAgICAgICBpZiAodW5zb2xkID4gMCkgewogICAgICAgICAgICAvL0J1cm4gdW5zb2xkIHRva2VucwogICAgICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LnN1Yih1bnNvbGQpOwogICAgICAgICAgICBCdXJuKHRoaXMsIHVuc29sZCk7CiAgICAgICAgICAgIFRyYW5zZmVyKHRoaXMsIGFkZHJlc3MoMCksIHVuc29sZCk7CiAgICAgICAgfQogICAgICAgIHRlYW1Mb2NrVXAgPSBkYXlUb0Jsb2NrTnVtYmVyKDM2NSk7IC8vMTItbW9udGggbG9jay11cCBwZXJpb2QKICAgICAgICBJQ09SZXNlcnZlTG9ja1VwID0gZGF5VG9CbG9ja051bWJlcigzNjUgKiAyKTsgLy8yIHllYXJzIGxvY2sgdXAgcGVyaW9kCiAgICB9CgogICAgZnVuY3Rpb24gd2l0aGRyYXdUZWFtVG9rZW4oKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKHRlYW1XaXRoZHJhd2xDb3VudCA8IDMpOwogICAgICAgIHJlcXVpcmUoY3Jvd2RzYWxlQ29uY2x1ZGVkKTsKICAgICAgICBpZiAodGVhbVdpdGhkcmF3bENvdW50ID09IDApIHsKICAgICAgICAgICAgcmVxdWlyZShibG9jay5udW1iZXIgPj0gZW5kQmxvY2suYWRkKHRlYW1Mb2NrVXApKTsgLy8xMi1tb250aCBsb2NrLXVwCiAgICAgICAgfSBlbHNlIGlmICh0ZWFtV2l0aGRyYXdsQ291bnQgPT0gMSkgewogICAgICAgICAgICByZXF1aXJlKGJsb2NrLm51bWJlciA+PSBlbmRCbG9jay5hZGQodGVhbUxvY2tVcC5tdWwoMikpKTsgLy8yNC1tb250aCBsb2NrLXVwCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVxdWlyZShibG9jay5udW1iZXIgPj0gZW5kQmxvY2suYWRkKHRlYW1Mb2NrVXAubXVsKDMpKSk7IC8vMzYtbW9udGggbG9jay11cAogICAgICAgIH0KICAgICAgICB0ZWFtV2l0aGRyYXdsQ291bnQrKzsKICAgICAgICB1aW50MjU2IHRva2VucyA9IHRlYW1Ub2tlblN1cHBseS5kaXYoMyk7CiAgICAgICAgYmFsYW5jZXNbb3duZXJdID0gYmFsYW5jZXNbb3duZXJdLmFkZCh0b2tlbnMpOwogICAgICAgIFRyYW5zZmVyKHRoaXMsIG93bmVyLCB0b2tlbnMpOwogICAgfQoKICAgIGZ1bmN0aW9uIHdpdGhkcmF3SUNPUmVzZXJ2ZSgpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoIUlDT1Jlc2VydmVXaXRoZHJhd24pOwogICAgICAgIHJlcXVpcmUoY3Jvd2RzYWxlQ29uY2x1ZGVkKTsKICAgICAgICByZXF1aXJlKGJsb2NrLm51bWJlciA+PSBlbmRCbG9jay5hZGQoSUNPUmVzZXJ2ZUxvY2tVcCkpOwogICAgICAgIElDT1Jlc2VydmVXaXRoZHJhd24gPSB0cnVlOwogICAgICAgIGJhbGFuY2VzW293bmVyXSA9IGJhbGFuY2VzW293bmVyXS5hZGQoSUNPUmVzZXJ2ZVN1cHBseSk7CiAgICAgICAgVHJhbnNmZXIodGhpcywgb3duZXIsIElDT1Jlc2VydmVTdXBwbHkpOwogICAgfQoKICAgIGZ1bmN0aW9uIGJ1eSgpIHBheWFibGUgewogICAgICAgIGJ1eVJlY2lwaWVudChtc2cuc2VuZGVyKTsKICAgIH0KCgogICAgLy9BbGxvdyBhZGRyZXNzZXMgdG8gYnV5IHRva2VuIGZvciBhbm90aGVyIGFjY291bnQKICAgIGZ1bmN0aW9uIGJ1eVJlY2lwaWVudChhZGRyZXNzIHJlY2lwaWVudCkgcHVibGljIHBheWFibGUgd2hlbk5vdEhhbHRlZCB7CiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPiAwKTsKICAgICAgICByZXF1aXJlKHByZXNhbGVPbigpfHxjcm93ZHNhbGVPbigpKTsgLy9Db250cmlidXRpb24gb25seSBhbGxvd2VkIGR1cmluZyBwcmVzYWxlL2Nyb3dkc2FsZQogICAgICAgIHVpbnQyNTYgdG9rZW5zID0gbXNnLnZhbHVlLmRpdih0b2tlblByaWNlKCkpOyAKICAgICAgICB1aW50OCBzdGFnZSA9IDA7CgogICAgICAgIGlmKHByZXNhbGVPbigpKSB7CiAgICAgICAgICAgIHJlcXVpcmUocHJlc2FsZVRva2VuU29sZC5hZGQodG9rZW5zKSA8PSBwcmVzYWxlVG9rZW5TdXBwbHkpOwogICAgICAgICAgICBwcmVzYWxlVG9rZW5Tb2xkID0gcHJlc2FsZVRva2VuU29sZC5hZGQodG9rZW5zKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXF1aXJlKGNyb3dkc2FsZVRva2VuU29sZC5hZGQodG9rZW5zKSA8PSBjcm93ZHNhbGVUb2tlblN1cHBseSk7CiAgICAgICAgICAgIGNyb3dkc2FsZVRva2VuU29sZCA9IGNyb3dkc2FsZVRva2VuU29sZC5hZGQodG9rZW5zKTsKICAgICAgICAgICAgc3RhZ2UgPSAxOwogICAgICAgIH0KICAgICAgICBjb250cmlidXRpb25Db3VudCA9IGNvbnRyaWJ1dGlvbkNvdW50LmFkZCgxKTsKICAgICAgICBieXRlczMyIHRyYW5zYWN0aW9uSGFzaCA9IGtlY2NhazI1Nihjb250cmlidXRpb25Db3VudCwgbXNnLnNlbmRlciwgbXNnLnZhbHVlLCBtc2cuZGF0YSwKICAgICAgICAgICAgbXNnLmdhcywgYmxvY2subnVtYmVyLCB0eC5nYXNwcmljZSk7CiAgICAgICAgY29udHJpYnV0aW9uc1t0cmFuc2FjdGlvbkhhc2hdID0gQ29udHJpYnV0aW9uKG1zZy5zZW5kZXIsIHJlY2lwaWVudCwgbXNnLnZhbHVlLCAKICAgICAgICAgICAgdG9rZW5zLCBmYWxzZSwgZmFsc2UsIHN0YWdlKTsKICAgICAgICBjb250cmlidXRpb25IYXNoZXMucHVzaCh0cmFuc2FjdGlvbkhhc2gpOwogICAgICAgIENvbnRyaWJ1dGlvblJlY2VpdmVkKHRyYW5zYWN0aW9uSGFzaCwgbXNnLnNlbmRlciwgcmVjaXBpZW50LCBtc2cudmFsdWUsIHRva2Vucyk7CiAgICB9CgogICAgLy9BY2NlcHQgYSBjb250cmlidXRpb24gaWYgS1lDIHBhc3NlZC4KICAgIGZ1bmN0aW9uIGFjY2VwdENvbnRyaWJ1dGlvbihieXRlczMyIHRyYW5zYWN0aW9uSGFzaCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgQ29udHJpYnV0aW9uIHN0b3JhZ2UgYyA9IGNvbnRyaWJ1dGlvbnNbdHJhbnNhY3Rpb25IYXNoXTsKICAgICAgICByZXF1aXJlKCFjLnJlc29sdmVkKTsKICAgICAgICBjLnJlc29sdmVkID0gdHJ1ZTsKICAgICAgICBjLnN1Y2Nlc3MgPSB0cnVlOwogICAgICAgIGJhbGFuY2VzW2MucmVjaXBpZW50XSA9IGJhbGFuY2VzW2MucmVjaXBpZW50XS5hZGQoYy50b2tlbnMpOwogICAgICAgIGFzc2VydChtdWx0aXNpZy5zZW5kKGMuZXRoV2VpKSk7CiAgICAgICAgVHJhbnNmZXIodGhpcywgYy5yZWNpcGllbnQsIGMudG9rZW5zKTsKICAgICAgICBDb250cmlidXRpb25SZXNvbHZlZCh0cmFuc2FjdGlvbkhhc2gsIHRydWUsIG1zZy5zZW5kZXIsIGMucmVjaXBpZW50LCBjLmV0aFdlaSwgCiAgICAgICAgICAgIGMudG9rZW5zKTsKICAgIH0KCiAgICAvL1JlamVjdCBhIGNvbnRyaWJ1dGlvbiBpZiBLWUMgZmFpbGVkLgogICAgZnVuY3Rpb24gcmVqZWN0Q29udHJpYnV0aW9uKGJ5dGVzMzIgdHJhbnNhY3Rpb25IYXNoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBDb250cmlidXRpb24gc3RvcmFnZSBjID0gY29udHJpYnV0aW9uc1t0cmFuc2FjdGlvbkhhc2hdOwogICAgICAgIHJlcXVpcmUoIWMucmVzb2x2ZWQpOwogICAgICAgIGMucmVzb2x2ZWQgPSB0cnVlOwogICAgICAgIGMuc3VjY2VzcyA9IGZhbHNlOwogICAgICAgIGlmIChjLnN0YWdlID09IDApIHsKICAgICAgICAgICAgcHJlc2FsZVRva2VuU29sZCA9IHByZXNhbGVUb2tlblNvbGQuc3ViKGMudG9rZW5zKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjcm93ZHNhbGVUb2tlblNvbGQgPSBjcm93ZHNhbGVUb2tlblNvbGQuc3ViKGMudG9rZW5zKTsKICAgICAgICB9CiAgICAgICAgYXNzZXJ0KGMuY29udHJpYnV0b3Iuc2VuZChjLmV0aFdlaSkpOwogICAgICAgIENvbnRyaWJ1dGlvblJlc29sdmVkKHRyYW5zYWN0aW9uSGFzaCwgZmFsc2UsIG1zZy5zZW5kZXIsIGMucmVjaXBpZW50LCBjLmV0aFdlaSwgCiAgICAgICAgICAgIGMudG9rZW5zKTsKICAgIH0KCgogICAgLy9CdXJucyB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgZnJvbSB0aGUgdGVhbSB3YWxsZXQgYWRkcmVzcwogICAgZnVuY3Rpb24gYnVybih1aW50MjU2IF92YWx1ZSkgcHVibGljIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LnN1YihfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIGFkZHJlc3MoMCksIF92YWx1ZSk7CiAgICAgICAgQnVybihtc2cuc2VuZGVyLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vQWxsb3cgdGVhbSB0byBjaGFuZ2UgdGhlIHJlY2lwaWVudCBtdWx0aXNpZyBhZGRyZXNzCiAgICBmdW5jdGlvbiBzZXRNdWx0aXNpZyhhZGRyZXNzIGFkZHIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAJcmVxdWlyZShhZGRyICE9IGFkZHJlc3MoMCkpOwogICAgICAJbXVsdGlzaWcgPSBhZGRyOwogICAgfQoKICAgIC8vQWxsb3dzIFRlYW0gdG8gYWRqdXN0IGF2ZXJhZ2UgYmxvY2t0aW1lIGFjY29yZGluZyB0byBuZXR3b3JrIHN0YXR1cywgCiAgICAvL2luIG9yZGVyIHRvIHByb3ZpZGUgbW9yZSBwcmVjaXNlIHRpbWluZyBmb3IgSUNPIHBoYXNlcyAmIGxvY2stdXAgcGVyaW9kcwogICAgZnVuY3Rpb24gc2V0QXZlcmFnZUJsb2NrVGltZSh1aW50MjU2IG5ld0Jsb2NrVGltZSkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShuZXdCbG9ja1RpbWUgPiAwKTsKICAgICAgICBhdmVyYWdlQmxvY2tUaW1lID0gbmV3QmxvY2tUaW1lOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIGNyb3dkc2FsZVRyYW5zZmVyTG9jayAKICAgIHJldHVybnMoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIAogICAgY3Jvd2RzYWxlVHJhbnNmZXJMb2NrIHJldHVybnMoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICAvL1ByaWNlIG9mIHRva2VuIGluIHRlcm1zIG9mIGV0aGVyLgogICAgZnVuY3Rpb24gdG9rZW5QcmljZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICB1aW50OCBwID0gcGhhc2UoKTsKICAgICAgICBpZiAocCA9PSAwKSByZXR1cm4gYmFzZVByaWNlLm11bCg0MCkuZGl2KDEwMCk7IC8vUHJlc2FsZTogNjAlIGRpc2NvdW50CiAgICAgICAgaWYgKHAgPT0gMSkgcmV0dXJuIGJhc2VQcmljZS5tdWwoNTApLmRpdigxMDApOyAvL0lDTyBwaGFzZSAxOiA1MCUgZGlzY291bnQKICAgICAgICBpZiAocCA9PSAyKSByZXR1cm4gYmFzZVByaWNlLm11bCg2MCkuZGl2KDEwMCk7IC8vUGhhc2UgMiA6NDAlIGRpc2NvdW50CiAgICAgICAgaWYgKHAgPT0gMykgcmV0dXJuIGJhc2VQcmljZS5tdWwoNzApLmRpdigxMDApOyAvL1BoYXNlIDM6IDMwJSBkaXNjb3VudAogICAgICAgIGlmIChwID09IDQpIHJldHVybiBiYXNlUHJpY2UubXVsKDgwKS5kaXYoMTAwKTsgLy9QaGFzZSA0OiAyMCUgZGlzY291bnQKICAgICAgICBpZiAocCA9PSA1KSByZXR1cm4gYmFzZVByaWNlLm11bCg5MCkuZGl2KDEwMCk7IC8vUGhhc2UgNTogMTAlIGRpc2NvdW50CiAgICAgICAgcmV0dXJuIGJhc2VQcmljZTsKICAgIH0KCiAgICBmdW5jdGlvbiBwaGFzZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50OCkgewogICAgICAgIGlmIChwcmVzYWxlT24oKSkgcmV0dXJuIDA7CiAgICAgICAgaWYgKGNyb3dkc2FsZVRva2VuU29sZCA8PSBwaGFzZTFDYXAgJiYgYmxvY2subnVtYmVyIDw9IHBoYXNlMUVuZEJsb2NrKSByZXR1cm4gMTsKICAgICAgICBpZiAoY3Jvd2RzYWxlVG9rZW5Tb2xkIDw9IHBoYXNlMkNhcCAmJiBibG9jay5udW1iZXIgPD0gcGhhc2UyRW5kQmxvY2spIHJldHVybiAyOwogICAgICAgIGlmIChjcm93ZHNhbGVUb2tlblNvbGQgPD0gcGhhc2UzQ2FwICYmIGJsb2NrLm51bWJlciA8PSBwaGFzZTNFbmRCbG9jaykgcmV0dXJuIDM7CiAgICAgICAgaWYgKGNyb3dkc2FsZVRva2VuU29sZCA8PSBwaGFzZTRDYXAgJiYgYmxvY2subnVtYmVyIDw9IHBoYXNlNEVuZEJsb2NrKSByZXR1cm4gNDsKICAgICAgICBpZiAoY3Jvd2RzYWxlVG9rZW5Tb2xkIDw9IGNyb3dkc2FsZVRva2VuU3VwcGx5ICYmIGJsb2NrLm51bWJlciA8PSBwaGFzZTVFbmRCbG9jaykgcmV0dXJuIDU7CiAgICAgICAgcmV0dXJuIDY7CiAgICB9CgogICAgZnVuY3Rpb24gcHJlc2FsZU9uKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gKHByZXNhbGVTdGFydGVkICYmICFwcmVzYWxlQ29uY2x1ZGVkICYmIHByZXNhbGVUb2tlblNvbGQgPCBwcmVzYWxlVG9rZW5TdXBwbHkpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNyb3dkc2FsZU9uKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gKGNyb3dkc2FsZVN0YXJ0ZWQgJiYgYmxvY2subnVtYmVyIDw9IGVuZEJsb2NrICYmIGNyb3dkc2FsZVRva2VuU29sZCA8IGNyb3dkc2FsZVRva2VuU3VwcGx5KTsKICAgIH0KCiAgICBmdW5jdGlvbiBkYXlUb0Jsb2NrTnVtYmVyKHVpbnQyNTYgZGF5TnVtKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGRheU51bS5tdWwoODY0MDApLmRpdihhdmVyYWdlQmxvY2tUaW1lKTsgLy84NjQwMCA9IDI0KjYwKjYwID0gbnVtYmVyIG9mIHNlY29uZHMgaW4gYSBkYXkKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRDb250cmlidXRpb25Gcm9tSGFzaChieXRlczMyIGNvbnRyaWJ1dGlvbkhhc2gpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICgKICAgICAgICAgICAgYWRkcmVzcyBjb250cmlidXRvciwKICAgICAgICAgICAgYWRkcmVzcyByZWNpcGllbnQsCiAgICAgICAgICAgIHVpbnQyNTYgZXRoV2VpLAogICAgICAgICAgICB1aW50MjU2IHRva2VucywKICAgICAgICAgICAgYm9vbCByZXNvbHZlZCwKICAgICAgICAgICAgYm9vbCBzdWNjZXNzCiAgICAgICAgKSB7CiAgICAgICAgQ29udHJpYnV0aW9uIGMgPSBjb250cmlidXRpb25zW2NvbnRyaWJ1dGlvbkhhc2hdOwogICAgICAgIGNvbnRyaWJ1dG9yID0gYy5jb250cmlidXRvcjsKICAgICAgICByZWNpcGllbnQgPSBjLnJlY2lwaWVudDsKICAgICAgICBldGhXZWkgPSBjLmV0aFdlaTsKICAgICAgICB0b2tlbnMgPSBjLnRva2VuczsKICAgICAgICByZXNvbHZlZCA9IGMucmVzb2x2ZWQ7CiAgICAgICAgc3VjY2VzcyA9IGMuc3VjY2VzczsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRDb250cmlidXRpb25IYXNoZXMoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYnl0ZXMzMltdKSB7CiAgICAgICAgcmV0dXJuIGNvbnRyaWJ1dGlvbkhhc2hlczsKICAgIH0KCn0='.
	

]
