Class {
	#name : #SRTd77fc35cc9007557dcd18bfe26fe66f1ea3a0e7f,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd77fc35cc9007557dcd18bfe26fe66f1ea3a0e7f >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIHVpbnQgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KICBmdW5jdGlvbiBkaXYodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIGFzc2VydChiID4gMCk7CiAgICB1aW50IGMgPSBhIC8gYjsKICAgIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOwogICAgcmV0dXJuIGM7CiAgfQogIGZ1bmN0aW9uIHN1Yih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQogIGZ1bmN0aW9uIGFkZCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgdWludCBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KICBmdW5jdGlvbiBtYXg2NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgewogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOwogIH0KICBmdW5jdGlvbiBtaW42NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgewogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7CiAgfQogIGZ1bmN0aW9uIG1heDI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOwogIH0KICBmdW5jdGlvbiBtaW4yNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOwogIH0KICBmdW5jdGlvbiBhc3NlcnQoYm9vbCBhc3NlcnRpb24pIGludGVybmFsIHsKICAgIGlmICghYXNzZXJ0aW9uKSB7CiAgICAgIHRocm93OwogICAgfQogIH0KfQpjb250cmFjdCBQdWxsUGF5bWVudCB7CgogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwogIAogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgcGF5bWVudHM7CgogIGV2ZW50IExvZ1JlZnVuZEVUSChhZGRyZXNzIHRvLCB1aW50IHZhbHVlKTsKCgogIC8qKgogICogIFN0b3JlIHNlbnQgYW1vdW50IGFzIGNyZWRpdCB0byBiZSBwdWxsZWQsIGNhbGxlZCBieSBwYXllciAKICAqKi8KICBmdW5jdGlvbiBhc3luY1NlbmQoYWRkcmVzcyBkZXN0LCB1aW50IGFtb3VudCkgaW50ZXJuYWwgewogICAgcGF5bWVudHNbZGVzdF0gPSBwYXltZW50c1tkZXN0XS5hZGQoYW1vdW50KTsKICB9CgogIC8vIHdpdGhkcmF3IGFjY3VtdWxhdGVkIGJhbGFuY2UsIGNhbGxlZCBieSBwYXllZQogIGZ1bmN0aW9uIHdpdGhkcmF3UGF5bWVudHMoKSB7CiAgICBhZGRyZXNzIHBheWVlID0gbXNnLnNlbmRlcjsKICAgIHVpbnQgcGF5bWVudCA9IHBheW1lbnRzW3BheWVlXTsKICAgIAogICAgaWYgKHBheW1lbnQgPT0gMCkgewogICAgICB0aHJvdzsKICAgIH0KCiAgICBpZiAodGhpcy5iYWxhbmNlIDwgcGF5bWVudCkgewogICAgICB0aHJvdzsKICAgIH0KCiAgICBwYXltZW50c1twYXllZV0gPSAwOwoKICAgIGlmICghcGF5ZWUuc2VuZChwYXltZW50KSkgewogICAgICB0aHJvdzsKICAgIH0KICAgIExvZ1JlZnVuZEVUSChwYXllZSxwYXltZW50KTsKICB9Cn0KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludCBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBjb25zdGFudCByZXR1cm5zICh1aW50KTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50IHZhbHVlKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50IHZhbHVlKTsKfQpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50IHZhbHVlKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludCB2YWx1ZSk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludCB2YWx1ZSk7Cn0KY29udHJhY3QgTWlncmF0aW9ucyB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgdWludCBwdWJsaWMgbGFzdF9jb21wbGV0ZWRfbWlncmF0aW9uOwoKICBtb2RpZmllciByZXN0cmljdGVkKCkgewogICAgaWYgKG1zZy5zZW5kZXIgPT0gb3duZXIpIF87CiAgfQoKICBmdW5jdGlvbiBNaWdyYXRpb25zKCkgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCiAgZnVuY3Rpb24gc2V0Q29tcGxldGVkKHVpbnQgY29tcGxldGVkKSByZXN0cmljdGVkIHsKICAgIGxhc3RfY29tcGxldGVkX21pZ3JhdGlvbiA9IGNvbXBsZXRlZDsKICB9CgogIGZ1bmN0aW9uIHVwZ3JhZGUoYWRkcmVzcyBuZXdfYWRkcmVzcykgcmVzdHJpY3RlZCB7CiAgICBNaWdyYXRpb25zIHVwZ3JhZGVkID0gTWlncmF0aW9ucyhuZXdfYWRkcmVzcyk7CiAgICB1cGdyYWRlZC5zZXRDb21wbGV0ZWQobGFzdF9jb21wbGV0ZWRfbWlncmF0aW9uKTsKICB9Cn0KY29udHJhY3QgT3duYWJsZSB7CiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgICBmdW5jdGlvbiBPd25hYmxlKCkgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5T3duZXIgewogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IG93bmVyKSB0aHJvdzsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciB7CiAgICAgICAgaWYgKG5ld093bmVyICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgICAgICB9CiAgICB9Cn0KY29udHJhY3QgUGF1c2FibGUgaXMgT3duYWJsZSB7CiAgYm9vbCBwdWJsaWMgc3RvcHBlZDsKCiAgbW9kaWZpZXIgc3RvcEluRW1lcmdlbmN5IHsKICAgIGlmIChzdG9wcGVkKSB7CiAgICAgIHRocm93OwogICAgfQogICAgXzsKICB9CiAgCiAgbW9kaWZpZXIgb25seUluRW1lcmdlbmN5IHsKICAgIGlmICghc3RvcHBlZCkgewogICAgICB0aHJvdzsKICAgIH0KICAgIF87CiAgfQoKICAvLyBjYWxsZWQgYnkgdGhlIG93bmVyIG9uIGVtZXJnZW5jeSwgdHJpZ2dlcnMgc3RvcHBlZCBzdGF0ZQogIGZ1bmN0aW9uIGVtZXJnZW5jeVN0b3AoKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgc3RvcHBlZCA9IHRydWU7CiAgfQoKICAvLyBjYWxsZWQgYnkgdGhlIG93bmVyIG9uIGVuZCBvZiBlbWVyZ2VuY3ksIHJldHVybnMgdG8gbm9ybWFsIHN0YXRlCiAgZnVuY3Rpb24gcmVsZWFzZSgpIGV4dGVybmFsIG9ubHlPd25lciBvbmx5SW5FbWVyZ2VuY3kgewogICAgc3RvcHBlZCA9IGZhbHNlOwogIH0KCn0KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICAKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKICAKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgYmFsYW5jZXM7CiAgCiAgLyoKICAgKiBGaXggZm9yIHRoZSBFUkMyMCBzaG9ydCBhZGRyZXNzIGF0dGFjayAgCiAgKi8KICBtb2RpZmllciBvbmx5UGF5bG9hZFNpemUodWludCBzaXplKSB7CiAgICAgaWYobXNnLmRhdGEubGVuZ3RoIDwgc2l6ZSArIDQpIHsKICAgICAgIHRocm93OwogICAgIH0KICAgICBfOwogIH0KCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSB7CiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQp9CmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgQmFzaWNUb2tlbiwgRVJDMjAgewogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSkgYWxsb3dlZDsKCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDMgKiAzMikgewogICAgdmFyIF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKICAgIC8vIENoZWNrIGlzIG5vdCBuZWVkZWQgYmVjYXVzZSBzdWIoX2FsbG93YW5jZSwgX3ZhbHVlKSB3aWxsIGFscmVhZHkgdGhyb3cgaWYgdGhpcyBjb25kaXRpb24gaXMgbm90IG1ldAogICAgLy8gaWYgKF92YWx1ZSA+IF9hbGxvd2FuY2UpIHRocm93OwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkgewogICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2AKICAgIC8vICBhbGxvd2FuY2UgdG8gemVybyBieSBjYWxsaW5nIGBhcHByb3ZlKF9zcGVuZGVyLCAwKWAgaWYgaXQgaXMgbm90CiAgICAvLyAgYWxyZWFkeSAwIHRvIG1pdGlnYXRlIHRoZSByYWNlIGNvbmRpdGlvbiBkZXNjcmliZWQgaGVyZToKICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgaWYgKChfdmFsdWUgIT0gMCkgJiYgKGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdICE9IDApKSB0aHJvdzsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9Cn0KLyoqCiAqICBUaXggdG9rZW4gY29udHJhY3QuIEltcGxlbWVudHMKICovCmNvbnRyYWN0IFRpeCBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiVGV0dGl4IjsKICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJUSVgiOwogIHVpbnQgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gODsKCgogIC8vIENvbnN0cnVjdG9yCiAgZnVuY3Rpb24gVGl4KCkgewogICAgICB0b3RhbFN1cHBseSA9IDEwMDAwMDAwMDAwMDAwMDAwMDsKICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSB0b3RhbFN1cHBseTsgLy8gU2VuZCBhbGwgdG9rZW5zIHRvIG93bmVyCiAgfQoKICAvKioKICAgKiAgQnVybiBhd2F5IHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIFNraW5Db2luIHRva2VucwogICAqLwogIGZ1bmN0aW9uIGJ1cm4odWludCBfdmFsdWUpIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIDB4MCwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCn0KLyoKICBDcm93ZHNhbGUgU21hcnQgQ29udHJhY3QgZm9yIHRoZSBUZXR0aXguaW8gcHJvamVjdAogIFRoaXMgc21hcnQgY29udHJhY3QgY29sbGVjdHMgRVRILCBhbmQgaW4gcmV0dXJuIGVtaXRzIFRJWCB0b2tlbnMgdG8gdGhlIGJhY2tlcnMKKi8KY29udHJhY3QgQ3Jvd2RzYWxlIGlzIFBhdXNhYmxlLCBQdWxsUGF5bWVudCB7CiAgICAKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwoKICAgIHN0cnVjdCBCYWNrZXIgewogICAgICAgIHVpbnQgd2VpUmVjZWl2ZWQ7IC8vIEFtb3VudCBvZiBFdGhlciBnaXZlbgogICAgICAgIHVpbnQgY29pblNlbnQ7CiAgICB9CgogICAgLyoKICAgICogQ29uc3RhbnRzCiAgICAqLwogICAgLyogTWluaW11bSBudW1iZXIgb2YgVElYIHRvIHNlbGwgKi8KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IE1JTl9DQVAgPSAxMDAwMDAwMDAwMDAwOyAKICAgIC8qIE1heGltdW0gbnVtYmVyIG9mIFRJWCB0byBzZWxsICovCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBNQVhfQ0FQID0gNDAwMDAwMDAwMDAwMDAwMDA7CiAgICAvKiBNaW5pbXVtIGFtb3VudCB0byBpbnZlc3QgKi8KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IE1JTl9JTlZFU1RfRVRIRVIgPSAxMCBmaW5uZXk7CiAgICAvKiBDcm93ZHNhbGUgcGVyaW9kICovCiAgICB1aW50IHByaXZhdGUgY29uc3RhbnQgQ1JPV0RTQUxFX1BFUklPRCA9IDIxIGRheXM7CiAgICAvKiBOdW1iZXIgb2YgVElYIHBlciBFdGhlciAqLwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgQ09JTl9QRVJfRVRIRVIgPSAxMDAwMDAwMDAwMDAwOwoKCiAgICAvKgogICAgKiBWYXJpYWJsZXMKICAgICovCiAgICAvKiBUSVggY29udHJhY3QgcmVmZXJlbmNlICovCiAgICBUaXggcHVibGljIGNvaW47CiAgICAvKiBNdWx0aXNpZyBjb250cmFjdCB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgRXRoZXIgKi8KICAgIGFkZHJlc3MgcHVibGljIG11bHRpc2lnRXRoZXI7CiAgICAvKiBOdW1iZXIgb2YgRXRoZXIgcmVjZWl2ZWQgKi8KICAgIHVpbnQgcHVibGljIGV0aGVyUmVjZWl2ZWQ7CiAgICAvKiBOdW1iZXIgb2YgVElYIHNlbnQgdG8gRXRoZXIgY29udHJpYnV0b3JzICovCiAgICB1aW50IHB1YmxpYyBjb2luU2VudFRvRXRoZXI7CiAgICAvKiBDcm93ZHNhbGUgc3RhcnQgdGltZSAqLwogICAgdWludCBwdWJsaWMgc3RhcnRUaW1lOwogICAgLyogQ3Jvd2RzYWxlIGVuZCB0aW1lICovCiAgICB1aW50IHB1YmxpYyBlbmRUaW1lOwogICAgLyogSXMgY3Jvd2RzYWxlIHN0aWxsIG9uIGdvaW5nICovCiAgICBib29sIHB1YmxpYyBjcm93ZHNhbGVDbG9zZWQ7CgogICAgLyogQmFja2VycyBFdGhlciBpbmRleGVkIGJ5IHRoZWlyIEV0aGVyZXVtIGFkZHJlc3MgKi8KICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBCYWNrZXIpIHB1YmxpYyBiYWNrZXJzOwoKCiAgICAvKgogICAgKiBNb2RpZmllcnMKICAgICovCiAgICBtb2RpZmllciBtaW5DYXBOb3RSZWFjaGVkKCkgewogICAgICAgIGlmICgobm93IDwgZW5kVGltZSkgfHwgY29pblNlbnRUb0V0aGVyID49IE1JTl9DQVAgKSB0aHJvdzsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIHJlc3BlY3RUaW1lRnJhbWUoKSB7CiAgICAgICAgaWYgKChub3cgPCBzdGFydFRpbWUpIHx8IChub3cgPiBlbmRUaW1lICkpIHRocm93OwogICAgICAgIF87CiAgICB9CgogICAgLyoKICAgICAqIEV2ZW50CiAgICAqLwogICAgZXZlbnQgTG9nUmVjZWl2ZWRFVEgoYWRkcmVzcyBhZGRyLCB1aW50IHZhbHVlKTsKICAgIGV2ZW50IExvZ0NvaW5zRW1pdGVkKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCB1aW50IGFtb3VudCk7CgogICAgLyoKICAgICAqIENvbnN0cnVjdG9yCiAgICAqLwogICAgZnVuY3Rpb24gQ3Jvd2RzYWxlKGFkZHJlc3MgX3RpeEFkZHJlc3MsIGFkZHJlc3MgX3RvKSB7CiAgICAgICAgY29pbiA9IFRpeChfdGl4QWRkcmVzcyk7CiAgICAgICAgbXVsdGlzaWdFdGhlciA9IF90bzsKICAgIH0KCiAgICAvKiAKICAgICAqIFRoZSBmYWxsYmFjayBmdW5jdGlvbiBjb3JyZXNwb25kcyB0byBhIGRvbmF0aW9uIGluIEVUSAogICAgICovCiAgICBmdW5jdGlvbigpIHN0b3BJbkVtZXJnZW5jeSByZXNwZWN0VGltZUZyYW1lIHBheWFibGUgewogICAgICAgIHJlY2VpdmVFVEgobXNnLnNlbmRlcik7CiAgICB9CgogICAgLyogCiAgICAgKiBUbyBjYWxsIHRvIHN0YXJ0IHRoZSBjcm93ZHNhbGUKICAgICAqLwogICAgZnVuY3Rpb24gc3RhcnQoKSBvbmx5T3duZXIgewogICAgICAgIGlmIChzdGFydFRpbWUgIT0gMCkgdGhyb3c7IC8vIENyb3dkc2FsZSB3YXMgYWxyZWFkeSBzdGFydGVkCgogICAgICAgIHN0YXJ0VGltZSA9IG5vdyA7ICAgICAgICAgICAgCiAgICAgICAgZW5kVGltZSA9ICBub3cgKyBDUk9XRFNBTEVfUEVSSU9EOyAgICAKICAgIH0KCiAgICAvKgogICAgICogIFJlY2VpdmVzIGEgZG9uYXRpb24gaW4gRXRoZXIKICAgICovCiAgICBmdW5jdGlvbiByZWNlaXZlRVRIKGFkZHJlc3MgYmVuZWZpY2lhcnkpIGludGVybmFsIHsKICAgICAgICBpZiAobXNnLnZhbHVlIDwgTUlOX0lOVkVTVF9FVEhFUikgdGhyb3c7IC8vIERvbid0IGFjY2VwdCBmdW5kaW5nIHVuZGVyIGEgcHJlZGVmaW5lZCB0aHJlc2hvbGQKICAgICAgICAKICAgICAgICB1aW50IGNvaW5Ub1NlbmQgPSBib251cyhtc2cudmFsdWUubXVsKENPSU5fUEVSX0VUSEVSKS5kaXYoMSBldGhlcikpOyAvLyBDb21wdXRlIHRoZSBudW1iZXIgb2YgVElYIHRvIHNlbmQKICAgICAgICBpZiAoY29pblRvU2VuZC5hZGQoY29pblNlbnRUb0V0aGVyKSA+IE1BWF9DQVApIHRocm93OyAgIAoKICAgICAgICBCYWNrZXIgYmFja2VyID0gYmFja2Vyc1tiZW5lZmljaWFyeV07CiAgICAgICAgY29pbi50cmFuc2ZlcihiZW5lZmljaWFyeSwgY29pblRvU2VuZCk7IC8vIFRyYW5zZmVyIFRJWCByaWdodCBub3cgCgogICAgICAgIGJhY2tlci5jb2luU2VudCA9IGJhY2tlci5jb2luU2VudC5hZGQoY29pblRvU2VuZCk7CiAgICAgICAgYmFja2VyLndlaVJlY2VpdmVkID0gYmFja2VyLndlaVJlY2VpdmVkLmFkZChtc2cudmFsdWUpOyAvLyBVcGRhdGUgdGhlIHRvdGFsIHdlaSBjb2xsZWN0ZWQgZHVyaW5nIHRoZSBjcm93ZGZ1bmRpbmcgZm9yIHRoaXMgYmFja2VyICAgIAoKICAgICAgICBldGhlclJlY2VpdmVkID0gZXRoZXJSZWNlaXZlZC5hZGQobXNnLnZhbHVlKTsgLy8gVXBkYXRlIHRoZSB0b3RhbCB3ZWkgY29sbGVjdGVkIGR1cmluZyB0aGUgY3Jvd2RmdW5kaW5nCiAgICAgICAgY29pblNlbnRUb0V0aGVyID0gY29pblNlbnRUb0V0aGVyLmFkZChjb2luVG9TZW5kKTsKCiAgICAgICAgLy8gU2VuZCBldmVudHMKICAgICAgICBMb2dDb2luc0VtaXRlZChtc2cuc2VuZGVyICxjb2luVG9TZW5kKTsKICAgICAgICBMb2dSZWNlaXZlZEVUSChiZW5lZmljaWFyeSwgZXRoZXJSZWNlaXZlZCk7IAogICAgfQogICAgCgogICAgLyoKICAgICAqQ29tcHV0ZSB0aGUgVElYIGJvbnVzIGFjY29yZGluZyB0byB0aGUgaW52ZXN0bWVudCBwZXJpb2QKICAgICAqLwogICAgZnVuY3Rpb24gYm9udXModWludCBhbW91bnQpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICBpZiAobm93IDwgc3RhcnRUaW1lLmFkZCg1IGRheXMpKSByZXR1cm4gYW1vdW50LmFkZChhbW91bnQuZGl2KDUpKTsgICAvLyBib251cyAyMCUKICAgICAgICByZXR1cm4gYW1vdW50OwogICAgfQoKICAgIC8qICAKICAgICAqIEZpbmFsaXplIHRoZSBjcm93ZHNhbGUsIHNob3VsZCBiZSBjYWxsZWQgYWZ0ZXIgdGhlIHJlZnVuZCBwZXJpb2QKICAgICovCiAgICBmdW5jdGlvbiBmaW5hbGl6ZSgpIG9ubHlPd25lciBwdWJsaWMgewoKICAgICAgICBpZiAobm93IDwgZW5kVGltZSkgeyAvLyBDYW5ub3QgZmluYWxpc2UgYmVmb3JlIENST1dEU0FMRV9QRVJJT0Qgb3IgYmVmb3JlIHNlbGxpbmcgYWxsIGNvaW5zCiAgICAgICAgICAgIGlmIChjb2luU2VudFRvRXRoZXIgPT0gTUFYX0NBUCkgewogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChjb2luU2VudFRvRXRoZXIgPCBNSU5fQ0FQICYmIG5vdyA8IGVuZFRpbWUgKyAxNSBkYXlzKSB0aHJvdzsgLy8gSWYgTUlOX0NBUCBpcyBub3QgcmVhY2hlZCBkb25vcnMgaGF2ZSAxNWRheXMgdG8gZ2V0IHJlZnVuZCBiZWZvcmUgd2UgY2FuIGZpbmFsaXNlCgogICAgICAgIGlmICghbXVsdGlzaWdFdGhlci5zZW5kKHRoaXMuYmFsYW5jZSkpIHRocm93OyAvLyBNb3ZlIHRoZSByZW1haW5pbmcgRXRoZXIgdG8gdGhlIG11bHRpc2lnIGFkZHJlc3MKICAgICAgICAKICAgICAgICB1aW50IHJlbWFpbnMgPSBjb2luLmJhbGFuY2VPZih0aGlzKTsKICAgICAgICBpZiAocmVtYWlucyA+IDApIHsgLy8gQnVybiB0aGUgcmVzdCBvZiBUSVgKICAgICAgICAgICAgaWYgKCFjb2luLmJ1cm4ocmVtYWlucykpIHRocm93IDsKICAgICAgICB9CiAgICAgICAgY3Jvd2RzYWxlQ2xvc2VkID0gdHJ1ZTsKICAgIH0KCiAgICAvKiAgCiAgICAqIEZhaWxzYWZlIGRyYWluCiAgICAqLwogICAgZnVuY3Rpb24gZHJhaW4oKSBvbmx5T3duZXIgewogICAgICAgIGlmICghb3duZXIuc2VuZCh0aGlzLmJhbGFuY2UpKSB0aHJvdzsKICAgIH0KCiAgICAvKioKICAgICAqIEFsbG93IHRvIGNoYW5nZSB0aGUgdGVhbSBtdWx0aXNpZyBhZGRyZXNzIGluIHRoZSBjYXNlIG9mIGVtZXJnZW5jeS4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0TXVsdGlzaWcoYWRkcmVzcyBhZGRyKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICBpZiAoYWRkciA9PSBhZGRyZXNzKDApKSB0aHJvdzsKICAgICAgICBtdWx0aXNpZ0V0aGVyID0gYWRkcjsKICAgIH0KCiAgICAvKioKICAgICAqIE1hbnVhbGx5IGJhY2sgVElYIG93bmVyIGFkZHJlc3MuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJhY2tUaXhPd25lcigpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGNvaW4udHJhbnNmZXJPd25lcnNoaXAob3duZXIpOwogICAgfQoKICAgIC8qKgogICAgICogVHJhbnNmZXIgcmVtYWlucyB0byBvd25lciBpbiBjYXNlIGlmIGltcG9zc2libGUgdG8gZG8gbWluIGludmVzdAogICAgICovCiAgICBmdW5jdGlvbiBnZXRSZW1haW5Db2lucygpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHZhciByZW1haW5zID0gTUFYX0NBUCAtIGNvaW5TZW50VG9FdGhlcjsKICAgICAgICB1aW50IG1pbkNvaW5zVG9TZWxsID0gYm9udXMoTUlOX0lOVkVTVF9FVEhFUi5tdWwoQ09JTl9QRVJfRVRIRVIpIC8gKDEgZXRoZXIpKTsKCiAgICAgICAgaWYocmVtYWlucyA+IG1pbkNvaW5zVG9TZWxsKSB0aHJvdzsKCiAgICAgICAgQmFja2VyIGJhY2tlciA9IGJhY2tlcnNbb3duZXJdOwogICAgICAgIGNvaW4udHJhbnNmZXIob3duZXIsIHJlbWFpbnMpOyAvLyBUcmFuc2ZlciBUSVggcmlnaHQgbm93IAoKICAgICAgICBiYWNrZXIuY29pblNlbnQgPSBiYWNrZXIuY29pblNlbnQuYWRkKHJlbWFpbnMpOwoKICAgICAgICBjb2luU2VudFRvRXRoZXIgPSBjb2luU2VudFRvRXRoZXIuYWRkKHJlbWFpbnMpOwoKICAgICAgICAvLyBTZW5kIGV2ZW50cwogICAgICAgIExvZ0NvaW5zRW1pdGVkKHRoaXMgLHJlbWFpbnMpOwogICAgICAgIExvZ1JlY2VpdmVkRVRIKG93bmVyLCBldGhlclJlY2VpdmVkKTsgCiAgICB9CgoKICAgIC8qIAogICAgICogV2hlbiBNSU5fQ0FQIGlzIG5vdCByZWFjaDoKICAgICAqIDEpIGJhY2tlciBjYWxsIHRoZSAiYXBwcm92ZSIgZnVuY3Rpb24gb2YgdGhlIFRJWCB0b2tlbiBjb250cmFjdCB3aXRoIHRoZSBhbW91bnQgb2YgYWxsIFRJWHMgdGhleSBnb3QgaW4gb3JkZXIgdG8gYmUgcmVmdW5kCiAgICAgKiAyKSBiYWNrZXIgY2FsbCB0aGUgInJlZnVuZCIgZnVuY3Rpb24gb2YgdGhlIENyb3dkc2FsZSBjb250cmFjdCB3aXRoIHRoZSBzYW1lIGFtb3VudCBvZiBUSVgKICAgICAqIDMpIGJhY2tlciBjYWxsIHRoZSAid2l0aGRyYXdQYXltZW50cyIgZnVuY3Rpb24gb2YgdGhlIENyb3dkc2FsZSBjb250cmFjdCB0byBnZXQgYSByZWZ1bmQgaW4gRVRICiAgICAgKi8KICAgIGZ1bmN0aW9uIHJlZnVuZCh1aW50IF92YWx1ZSkgbWluQ2FwTm90UmVhY2hlZCBwdWJsaWMgewogICAgICAgIAogICAgICAgIGlmIChfdmFsdWUgIT0gYmFja2Vyc1ttc2cuc2VuZGVyXS5jb2luU2VudCkgdGhyb3c7IC8vIGNvbXBhcmUgdmFsdWUgZnJvbSBiYWNrZXIgYmFsYW5jZQoKICAgICAgICBjb2luLnRyYW5zZmVyRnJvbShtc2cuc2VuZGVyLCBhZGRyZXNzKHRoaXMpLCBfdmFsdWUpOyAvLyBnZXQgdGhlIHRva2VuIGJhY2sgdG8gdGhlIGNyb3dkc2FsZSBjb250cmFjdAoKICAgICAgICBpZiAoIWNvaW4uYnVybihfdmFsdWUpKSB0aHJvdyA7IC8vIHRva2VuIHNlbnQgZm9yIHJlZnVuZCBhcmUgYnVybnQKCiAgICAgICAgdWludCBFVEhUb1NlbmQgPSBiYWNrZXJzW21zZy5zZW5kZXJdLndlaVJlY2VpdmVkOwogICAgICAgIGJhY2tlcnNbbXNnLnNlbmRlcl0ud2VpUmVjZWl2ZWQ9MDsKCiAgICAgICAgaWYgKEVUSFRvU2VuZCA+IDApIHsKICAgICAgICAgICAgYXN5bmNTZW5kKG1zZy5zZW5kZXIsIEVUSFRvU2VuZCk7IC8vIHB1bGwgcGF5bWVudCB0byBnZXQgcmVmdW5kIGluIEVUSAogICAgICAgIH0KICAgIH0KCn0='.
	

]
