Class {
	#name : #SRT20bf6672497941bd3e4ec5fd551de5c31e0a898a,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT20bf6672497941bd3e4ec5fd551de5c31e0a898a >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbgogKgogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CgogICAgdWludDI1NiBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07CgogICAgLy8gQ2hlY2sgaXMgbm90IG5lZWRlZCBiZWNhdXNlIHN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0CiAgICAvLyByZXF1aXJlIChfdmFsdWUgPD0gX2FsbG93YW5jZSk7CgogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CgogIC8qKgogICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAogICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICovCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCmNvbnRyYWN0IE1pbnRhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZSB7CiAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKICBldmVudCBNaW50RmluaXNoZWQoKTsKCiAgYm9vbCBwdWJsaWMgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CgoKICBtb2RpZmllciBjYW5NaW50KCkgewogICAgcmVxdWlyZSghbWludGluZ0ZpbmlzaGVkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIG1pbnQgdG9rZW5zCiAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgbWludGVkIHRva2Vucy4KICAgKiBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAqIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoX2Ftb3VudCk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICBNaW50KF90bywgX2Ftb3VudCk7CiAgICBUcmFuc2ZlcigweDAsIF90bywgX2Ftb3VudCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gc3RvcCBtaW50aW5nIG5ldyB0b2tlbnMuCiAgICogQHJldHVybiBUcnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gZmluaXNoTWludGluZygpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgIE1pbnRGaW5pc2hlZCgpOwogICAgcmV0dXJuIHRydWU7CiAgfQp9CgovKioKICogQHRpdGxlIFNldGhlclRva2VuCiAqIEBkZXYgU2V0aGVyIEVSQzIwIFRva2VuIHRoYXQgY2FuIGJlIG1pbnRlZC4KICogSXQgaXMgbWVhbnQgdG8gYmUgdXNlZCBpbiBzZXRoZXIgY3Jvd2RzYWxlIGNvbnRyYWN0LgogKi8KY29udHJhY3QgU2V0aGVyVG9rZW4gaXMgTWludGFibGVUb2tlbiB7CgogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIlNldGhlciI7CiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJTRVRIIjsKICAgIHVpbnQ4IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwoKICAgIGZ1bmN0aW9uIGdldFRvdGFsU3VwcGx5KCkgcHVibGljIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gdG90YWxTdXBwbHk7CiAgICB9Cn0KCi8qKgogKiBAdGl0bGUgU2V0aGVyQmFzZUNyb3dkc2FsZQogKiBAZGV2IFNldGhlckJhc2VDcm93ZHNhbGUgaXMgYSBiYXNlIGNvbnRyYWN0IGZvciBtYW5hZ2luZyBhIHNldGhlciB0b2tlbiBjcm93ZHNhbGUuCiAqLwpjb250cmFjdCBTZXRoZXJCYXNlQ3Jvd2RzYWxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIC8vIFRoZSB0b2tlbiBiZWluZyBzb2xkCiAgICBTZXRoZXJUb2tlbiBwdWJsaWMgdG9rZW47CgogICAgLy8gc3RhcnQgYW5kIGVuZCB0aW1lc3RhbXBzIHdoZXJlIGludmVzdG1lbnRzIGFyZSBhbGxvd2VkIChib3RoIGluY2x1c2l2ZSkKICAgIHVpbnQyNTYgcHVibGljIHN0YXJ0VGltZTsKICAgIHVpbnQyNTYgcHVibGljIGVuZFRpbWU7CgogICAgLy8gYWRkcmVzcyB3aGVyZSBmdW5kcyBhcmUgY29sbGVjdGVkCiAgICBhZGRyZXNzIHB1YmxpYyB3YWxsZXQ7CgogICAgLy8gaG93IG1hbnkgZmlubmV5IHBlciB0b2tlbgogICAgdWludDI1NiBwdWJsaWMgcmF0ZTsKCiAgICAvLyBhbW91bnQgb2YgcmFpc2VkIG1vbmV5IGluIHdlaQogICAgdWludDI1NiBwdWJsaWMgd2VpUmFpc2VkOwoKICAgIC8qKgogICAgKiBldmVudCBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAgKiBAcGFyYW0gcHVyY2hhc2VyIHdobyBwYWlkIGZvciB0aGUgdG9rZW5zCiAgICAqIEBwYXJhbSBiZW5lZmljaWFyeSB3aG8gZ290IHRoZSB0b2tlbnMKICAgICogQHBhcmFtIHZhbHVlIHdlaXMgcGFpZCBmb3IgcHVyY2hhc2UKICAgICogQHBhcmFtIGFtb3VudCBhbW91bnQgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAgKi8KICAgIGV2ZW50IFNldGhUb2tlblB1cmNoYXNlKGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB2YWx1ZSwgdWludDI1NiBhbW91bnQpOwoKICAgIGZ1bmN0aW9uIFNldGhlckJhc2VDcm93ZHNhbGUodWludDI1NiBfcmF0ZSwgYWRkcmVzcyBfd2FsbGV0KSB7CiAgICAgICAgcmVxdWlyZShfcmF0ZSA+IDApOwogICAgICAgIHJlcXVpcmUoX3dhbGxldCAhPSBhZGRyZXNzKDApKTsKCiAgICAgICAgdG9rZW4gPSBjcmVhdGVUb2tlbkNvbnRyYWN0KCk7CiAgICAgICAgcmF0ZSA9IF9yYXRlOwogICAgICAgIHdhbGxldCA9IF93YWxsZXQ7CiAgICB9CgogICAgLy8gZmFsbGJhY2sgZnVuY3Rpb24gY2FuIGJlIHVzZWQgdG8gYnV5IHRva2VucwogICAgZnVuY3Rpb24gKCkgcGF5YWJsZSB7CiAgICAgICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwogICAgfQoKICAgIC8vIGxvdyBsZXZlbCB0b2tlbiBwdXJjaGFzZSBmdW5jdGlvbgogICAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnkpIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKGJlbmVmaWNpYXJ5ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUodmFsaWRQdXJjaGFzZSgpKTsKCiAgICAgICAgdWludDI1NiB3ZWlBbW91bnQgPSBtc2cudmFsdWU7CgogICAgICAgIC8vIGNhbGN1bGF0ZSB0b2tlbiBhbW91bnQgdG8gYmUgY3JlYXRlZAogICAgICAgIHVpbnQyNTYgdG9rZW5zID0gY29tcHV0ZVRva2Vucyh3ZWlBbW91bnQpOwoKICAgICAgICByZXF1aXJlKGlzV2l0aGluVG9rZW5BbGxvY0xpbWl0KHRva2VucykpOwoKICAgICAgICAvLyB1cGRhdGUgc3RhdGUKICAgICAgICB3ZWlSYWlzZWQgPSB3ZWlSYWlzZWQuYWRkKHdlaUFtb3VudCk7CgogICAgICAgIHRva2VuLm1pbnQoYmVuZWZpY2lhcnksIHRva2Vucyk7CgogICAgICAgIFNldGhUb2tlblB1cmNoYXNlKG1zZy5zZW5kZXIsIGJlbmVmaWNpYXJ5LCB3ZWlBbW91bnQsIHRva2Vucyk7CgogICAgICAgIGZvcndhcmRGdW5kcygpOwogICAgfQoKICAgIC8vIEByZXR1cm4gdHJ1ZSBpZiBjcm93ZHNhbGUgZXZlbnQgaGFzIGVuZGVkCiAgICBmdW5jdGlvbiBoYXNFbmRlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIG5vdyA+IGVuZFRpbWU7CiAgICB9CgogICAgLy8gQHJldHVybiB0cnVlIGlmIGNyb3dkc2FsZSBldmVudCBoYXMgc3RhcnRlZAogICAgZnVuY3Rpb24gaGFzU3RhcnRlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIG5vdyA8IHN0YXJ0VGltZTsKICAgIH0KCiAgICAvLyBzZW5kIGV0aGVyIHRvIHRoZSBmdW5kIGNvbGxlY3Rpb24gd2FsbGV0CiAgICBmdW5jdGlvbiBmb3J3YXJkRnVuZHMoKSBpbnRlcm5hbCB7CiAgICAgICAgd2FsbGV0LnRyYW5zZmVyKG1zZy52YWx1ZSk7CiAgICB9CgogICAgLy8gQHJldHVybiB0cnVlIGlmIHRoZSB0cmFuc2FjdGlvbiBjYW4gYnV5IHRva2VucwogICAgZnVuY3Rpb24gdmFsaWRQdXJjaGFzZSgpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICBib29sIHdpdGhpblBlcmlvZCA9IG5vdyA+PSBzdGFydFRpbWUgJiYgbm93IDw9IGVuZFRpbWU7CiAgICAgICAgYm9vbCBub25aZXJvUHVyY2hhc2UgPSBtc2cudmFsdWUgIT0gMDsKICAgICAgICByZXR1cm4gd2l0aGluUGVyaW9kICYmIG5vblplcm9QdXJjaGFzZTsKICAgIH0KICAgIAogICAgLy9PdmVycmlkZSB0aGlzIG1ldGhvZCB3aXRoIHRva2VuIGRpc3RyaWJ1dGlvbiBzdHJhdGVneQogICAgZnVuY3Rpb24gY29tcHV0ZVRva2Vucyh1aW50MjU2IHdlaUFtb3VudCkgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgICAgIC8vVG8gYmUgb3ZlcnJpZGVuCiAgICB9CgogICAgLy9PdmVycmlkZSB0aGlzIG1ldGhvZCB3aXRoIHRva2VuIGxpbWl0YXRpb24gc3RyYXRlZ3kKICAgIGZ1bmN0aW9uIGlzV2l0aGluVG9rZW5BbGxvY0xpbWl0KHVpbnQyNTYgX3Rva2VucykgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgICAgIC8vVG8gYmUgb3ZlcnJpZGVuCiAgICB9CiAgICAKICAgIC8vIGNyZWF0ZXMgdGhlIHRva2VuIHRvIGJlIHNvbGQuCiAgICBmdW5jdGlvbiBjcmVhdGVUb2tlbkNvbnRyYWN0KCkgaW50ZXJuYWwgcmV0dXJucyAoU2V0aGVyVG9rZW4pIHsKICAgICAgICByZXR1cm4gbmV3IFNldGhlclRva2VuKCk7CiAgICB9Cn0KCi8qKgogKiBAdGl0bGUgU2V0aGVyTXVsdGlTdGVwQ3Jvd2RzYWxlCiAqIEBkZXYgTXVsdGktc3RlcCBwYXltZW50IHBvbGljeSBjb250cmFjdCB0aGF0IGV4dGVuZHMgU2V0aGVyQmFzZUNyb3dkc2FsZQogKi8KY29udHJhY3QgU2V0aGVyTXVsdGlTdGVwQ3Jvd2RzYWxlIGlzIFNldGhlckJhc2VDcm93ZHNhbGUgewogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgUFJFU0FMRV9MSU1JVCA9IDI1ICogKDEwICoqIDYpICogKDEwICoqIDE4KTsKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IENST1dEU0FMRV9MSU1JVCA9IDU1ICogKDEwICoqIDYpICogKDEwICoqIDE4KTsKICAgIAogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgUFJFU0FMRV9CT05VU19MSU1JVCA9IDEgKiAoMTAgKiogMTcpOwoKICAgIC8vIFByZXNhbGUgcGVyaW9kIChpbmNsdWRlcyBob2xpZGF5cykKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFBSRVNBTEVfUEVSSU9EID0gNTMgZGF5czsKICAgIC8vIENyb3dkc2FsZSBmaXJzdCB3ZWVrIHBlcmlvZCAoY29uc3RhbnRzIGZvciBwcm9wZXIgdGVzdGluZykKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IENST1dEX1dFRUsxX1BFUklPRCA9IDcgZGF5czsKICAgIC8vIENyb3dkc2FsZSBzZWNvbmQgd2VlayBwZXJpb2QKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IENST1dEX1dFRUsyX1BFUklPRCA9IDcgZGF5czsKICAgIC8vQ3Jvd2RzYWxlIHRoaXJkIHdlZWsgcGVyaW9kCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBDUk9XRF9XRUVLM19QRVJJT0QgPSA3IGRheXM7CiAgICAvL0Nyb3dkc2FsZSBsYXN0IHdlZWsgcGVyaW9kCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBDUk9XRF9XRUVLNF9QRVJJT0QgPSA3IGRheXM7CgogICAgdWludCBwdWJsaWMgY29uc3RhbnQgUFJFU0FMRV9CT05VUyA9IDQwOwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgQ1JPV0RfV0VFSzFfQk9OVVMgPSAyNTsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IENST1dEX1dFRUsyX0JPTlVTID0gMjA7CiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBDUk9XRF9XRUVLM19CT05VUyA9IDEwOwoKICAgIHVpbnQyNTYgcHVibGljIGxpbWl0RGF0ZVByZXNhbGU7CiAgICB1aW50MjU2IHB1YmxpYyBsaW1pdERhdGVDcm93ZFdlZWsxOwogICAgdWludDI1NiBwdWJsaWMgbGltaXREYXRlQ3Jvd2RXZWVrMjsKICAgIHVpbnQyNTYgcHVibGljIGxpbWl0RGF0ZUNyb3dkV2VlazM7CgogICAgZnVuY3Rpb24gU2V0aGVyTXVsdGlTdGVwQ3Jvd2RzYWxlKCkgewoKICAgIH0KCiAgICBmdW5jdGlvbiBpc1dpdGhpblByZXNhbGVUaW1lTGltaXQoKSBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIG5vdyA8PSBsaW1pdERhdGVQcmVzYWxlOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzV2l0aGluQ3Jvd2RXZWVrMVRpbWVMaW1pdCgpIGludGVybmFsIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gbm93IDw9IGxpbWl0RGF0ZUNyb3dkV2VlazE7CiAgICB9CgogICAgZnVuY3Rpb24gaXNXaXRoaW5Dcm93ZFdlZWsyVGltZUxpbWl0KCkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBub3cgPD0gbGltaXREYXRlQ3Jvd2RXZWVrMjsKICAgIH0KCiAgICBmdW5jdGlvbiBpc1dpdGhpbkNyb3dkV2VlazNUaW1lTGltaXQoKSBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIG5vdyA8PSBsaW1pdERhdGVDcm93ZFdlZWszOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzV2l0aGluQ3JvZHdzYWxlVGltZUxpbWl0KCkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBub3cgPD0gZW5kVGltZSAmJiBub3cgPiBsaW1pdERhdGVQcmVzYWxlOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzV2l0aGluUHJlc2FsZUxpbWl0KHVpbnQyNTYgX3Rva2VucykgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiB0b2tlbi5nZXRUb3RhbFN1cHBseSgpLmFkZChfdG9rZW5zKSA8PSBQUkVTQUxFX0xJTUlUOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzV2l0aGluQ3Jvd2RzYWxlTGltaXQodWludDI1NiBfdG9rZW5zKSBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHRva2VuLmdldFRvdGFsU3VwcGx5KCkuYWRkKF90b2tlbnMpIDw9IENST1dEU0FMRV9MSU1JVDsKICAgIH0KCiAgICBmdW5jdGlvbiB2YWxpZFB1cmNoYXNlKCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci52YWxpZFB1cmNoYXNlKCkgJiYKICAgICAgICAgICAgICAgICAhKGlzV2l0aGluUHJlc2FsZVRpbWVMaW1pdCgpICYmIG1zZy52YWx1ZSA8IFBSRVNBTEVfQk9OVVNfTElNSVQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzV2l0aGluVG9rZW5BbGxvY0xpbWl0KHVpbnQyNTYgX3Rva2VucykgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiAoaXNXaXRoaW5QcmVzYWxlVGltZUxpbWl0KCkgJiYgaXNXaXRoaW5QcmVzYWxlTGltaXQoX3Rva2VucykpIHx8CiAgICAgICAgICAgICAgICAgICAgICAgIChpc1dpdGhpbkNyb2R3c2FsZVRpbWVMaW1pdCgpICYmIGlzV2l0aGluQ3Jvd2RzYWxlTGltaXQoX3Rva2VucykpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNvbXB1dGVUb2tlbnModWludDI1NiB3ZWlBbW91bnQpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IGFwcGxpZWRCb251cyA9IDA7CiAgICAgICAgaWYgKGlzV2l0aGluUHJlc2FsZVRpbWVMaW1pdCgpKSB7CiAgICAgICAgICAgIGFwcGxpZWRCb251cyA9IFBSRVNBTEVfQk9OVVM7CiAgICAgICAgfSBlbHNlIGlmIChpc1dpdGhpbkNyb3dkV2VlazFUaW1lTGltaXQoKSkgewogICAgICAgICAgICBhcHBsaWVkQm9udXMgPSBDUk9XRF9XRUVLMV9CT05VUzsKICAgICAgICB9IGVsc2UgaWYgKGlzV2l0aGluQ3Jvd2RXZWVrMlRpbWVMaW1pdCgpKSB7CiAgICAgICAgICAgIGFwcGxpZWRCb251cyA9IENST1dEX1dFRUsyX0JPTlVTOwogICAgICAgIH0gZWxzZSBpZiAoaXNXaXRoaW5Dcm93ZFdlZWszVGltZUxpbWl0KCkpIHsKICAgICAgICAgICAgYXBwbGllZEJvbnVzID0gQ1JPV0RfV0VFSzNfQk9OVVM7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gd2VpQW1vdW50Lm11bCgxMCkubXVsKDEwMCArIGFwcGxpZWRCb251cykuZGl2KHJhdGUpOwogICAgfQp9CgovKioKICogQHRpdGxlIFNldGhlckNhcHBlZENyb3dkc2FsZQogKiBAZGV2IEV4dGVuc2lvbiBvZiBTZXRoZXJCYXNlQ3Jvd2RzYWxlIHdpdGggYSBtYXggYW1vdW50IG9mIGZ1bmRzIHJhaXNlZAogKi8KY29udHJhY3QgU2V0aGVyQ2FwcGVkQ3Jvd2RzYWxlIGlzIFNldGhlck11bHRpU3RlcENyb3dkc2FsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBIQVJEX0NBUCA9IDU1ICogKDEwICoqIDYpICogKDEwICoqIDE4KTsKCiAgICBmdW5jdGlvbiBTZXRoZXJDYXBwZWRDcm93ZHNhbGUoKSB7CiAgICAgICAgCiAgICB9CgogICAgLy8gb3ZlcnJpZGluZyBTZXRoZXJCYXNlQ3Jvd2RzYWxlI3ZhbGlkUHVyY2hhc2UgdG8gYWRkIGV4dHJhIGNhcCBsb2dpYwogICAgLy8gQHJldHVybiB0cnVlIGlmIGludmVzdG9ycyBjYW4gYnV5IGF0IHRoZSBtb21lbnQKICAgIGZ1bmN0aW9uIHZhbGlkUHVyY2hhc2UoKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgYm9vbCB3aXRoaW5DYXAgPSB3ZWlSYWlzZWQuYWRkKG1zZy52YWx1ZSkgPD0gSEFSRF9DQVA7CgogICAgICAgIHJldHVybiBzdXBlci52YWxpZFB1cmNoYXNlKCkgJiYgd2l0aGluQ2FwOwogICAgfQoKICAgIC8vIG92ZXJyaWRpbmcgQ3Jvd2RzYWxlI2hhc0VuZGVkIHRvIGFkZCBjYXAgbG9naWMKICAgIC8vIEByZXR1cm4gdHJ1ZSBpZiBjcm93ZHNhbGUgZXZlbnQgaGFzIGVuZGVkCiAgICBmdW5jdGlvbiBoYXNFbmRlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgYm9vbCBjYXBSZWFjaGVkID0gd2VpUmFpc2VkID49IEhBUkRfQ0FQOwogICAgICAgIHJldHVybiBzdXBlci5oYXNFbmRlZCgpIHx8IGNhcFJlYWNoZWQ7CiAgICB9Cn0KCi8qKgogKiBAdGl0bGUgU2V0aGVyU3RhcnRhYmxlQ3Jvd2RzYWxlCiAqIEBkZXYgRXh0ZW5zaW9uIG9mIFNldGhlckJhc2VDcm93ZHNhbGUgd2hlcmUgYW4gb3duZXIgY2FuIHN0YXJ0IHRoZSBjcm93ZHNhbGUKICovCmNvbnRyYWN0IFNldGhlclN0YXJ0YWJsZUNyb3dkc2FsZSBpcyBTZXRoZXJCYXNlQ3Jvd2RzYWxlLCBPd25hYmxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgYm9vbCBwdWJsaWMgaXNTdGFydGVkID0gZmFsc2U7CgogIGV2ZW50IFNldGhlclN0YXJ0ZWQoKTsKCiAgLyoqCiAgICogQGRldiBNdXN0IGJlIGNhbGxlZCBhZnRlciBjcm93ZHNhbGUgZW5kcywgdG8gZG8gc29tZSBleHRyYSBmaW5hbGl6YXRpb24KICAgKiB3b3JrLiBDYWxscyB0aGUgY29udHJhY3QncyBmaW5hbGl6YXRpb24gZnVuY3Rpb24uCiAgICovCiAgZnVuY3Rpb24gc3RhcnQoKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUoIWlzU3RhcnRlZCk7CiAgICByZXF1aXJlKCFoYXNTdGFydGVkKCkpOwoKICAgIHN0YXJ0aW5nKCk7CiAgICBTZXRoZXJTdGFydGVkKCk7CgogICAgaXNTdGFydGVkID0gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgQ2FuIGJlIG92ZXJyaWRkZW4gdG8gYWRkIHN0YXJ0IGxvZ2ljLiBUaGUgb3ZlcnJpZGluZyBmdW5jdGlvbgogICAqIHNob3VsZCBjYWxsIHN1cGVyLnN0YXJ0aW5nKCkgdG8gZW5zdXJlIHRoZSBjaGFpbiBvZiBzdGFydGluZyBpcwogICAqIGV4ZWN1dGVkIGVudGlyZWx5LgogICAqLwogIGZ1bmN0aW9uIHN0YXJ0aW5nKCkgaW50ZXJuYWwgewogICAgLy9UbyBiZSBvdmVycmlkZW4KICB9Cn0KCi8qKgogKiBAdGl0bGUgU2V0aGVyRmluYWxpemFibGVDcm93ZHNhbGUKICogQGRldiBFeHRlbnNpb24gb2YgU2V0aGVyQmFzZUNyb3dkc2FsZSB3aGVyZSBhbiBvd25lciBjYW4gZG8gZXh0cmEgd29yawogKiBhZnRlciBmaW5pc2hpbmcuCiAqLwpjb250cmFjdCBTZXRoZXJGaW5hbGl6YWJsZUNyb3dkc2FsZSBpcyBTZXRoZXJCYXNlQ3Jvd2RzYWxlLCBPd25hYmxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgYm9vbCBwdWJsaWMgaXNGaW5hbGl6ZWQgPSBmYWxzZTsKCiAgZXZlbnQgU2V0aGVyRmluYWxpemVkKCk7CgogIC8qKgogICAqIEBkZXYgTXVzdCBiZSBjYWxsZWQgYWZ0ZXIgY3Jvd2RzYWxlIGVuZHMsIHRvIGRvIHNvbWUgZXh0cmEgZmluYWxpemF0aW9uCiAgICogd29yay4gQ2FsbHMgdGhlIGNvbnRyYWN0J3MgZmluYWxpemF0aW9uIGZ1bmN0aW9uLgogICAqLwogIGZ1bmN0aW9uIGZpbmFsaXplKCkgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKCFpc0ZpbmFsaXplZCk7CiAgICByZXF1aXJlKGhhc0VuZGVkKCkpOwoKICAgIGZpbmFsaXphdGlvbigpOwogICAgU2V0aGVyRmluYWxpemVkKCk7CgogICAgaXNGaW5hbGl6ZWQgPSB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBDYW4gYmUgb3ZlcnJpZGRlbiB0byBhZGQgZmluYWxpemF0aW9uIGxvZ2ljLiBUaGUgb3ZlcnJpZGluZyBmdW5jdGlvbgogICAqIHNob3VsZCBjYWxsIHN1cGVyLmZpbmFsaXphdGlvbigpIHRvIGVuc3VyZSB0aGUgY2hhaW4gb2YgZmluYWxpemF0aW9uIGlzCiAgICogZXhlY3V0ZWQgZW50aXJlbHkuCiAgICovCiAgZnVuY3Rpb24gZmluYWxpemF0aW9uKCkgaW50ZXJuYWwgewogICAgLy9UbyBiZSBvdmVycmlkZW4KICB9Cn0KCi8qKgogKiBAdGl0bGUgU2V0aGVyQ3Jvd2RzYWxlCiAqIEBkZXYgVGhpcyBpcyBTZXRoZXIncyBjcm93ZHNhbGUgY29udHJhY3QuCiAqLwpjb250cmFjdCBTZXRoZXJDcm93ZHNhbGUgaXMgU2V0aGVyQ2FwcGVkQ3Jvd2RzYWxlLCBTZXRoZXJTdGFydGFibGVDcm93ZHNhbGUsIFNldGhlckZpbmFsaXphYmxlQ3Jvd2RzYWxlIHsKCiAgICBmdW5jdGlvbiBTZXRoZXJDcm93ZHNhbGUodWludDI1NiByYXRlLCBhZGRyZXNzIF93YWxsZXQpIAogICAgICAgIFNldGhlckNhcHBlZENyb3dkc2FsZSgpCiAgICAgICAgU2V0aGVyRmluYWxpemFibGVDcm93ZHNhbGUoKQogICAgICAgIFNldGhlclN0YXJ0YWJsZUNyb3dkc2FsZSgpCiAgICAgICAgU2V0aGVyTXVsdGlTdGVwQ3Jvd2RzYWxlKCkKICAgICAgICBTZXRoZXJCYXNlQ3Jvd2RzYWxlKHJhdGUsIF93YWxsZXQpIAogICAgewogICAKICAgIH0KCiAgICBmdW5jdGlvbiBzdGFydGluZygpIGludGVybmFsIHsKICAgICAgICBzdXBlci5zdGFydGluZygpOwogICAgICAgIHN0YXJ0VGltZSA9IG5vdzsKICAgICAgICBsaW1pdERhdGVQcmVzYWxlID0gc3RhcnRUaW1lICsgUFJFU0FMRV9QRVJJT0Q7CiAgICAgICAgbGltaXREYXRlQ3Jvd2RXZWVrMSA9IGxpbWl0RGF0ZVByZXNhbGUgKyBDUk9XRF9XRUVLMV9QRVJJT0Q7IAogICAgICAgIGxpbWl0RGF0ZUNyb3dkV2VlazIgPSBsaW1pdERhdGVDcm93ZFdlZWsxICsgQ1JPV0RfV0VFSzJfUEVSSU9EOyAKICAgICAgICBsaW1pdERhdGVDcm93ZFdlZWszID0gbGltaXREYXRlQ3Jvd2RXZWVrMiArIENST1dEX1dFRUszX1BFUklPRDsgICAgICAgICAKICAgICAgICBlbmRUaW1lID0gbGltaXREYXRlQ3Jvd2RXZWVrMyArIENST1dEX1dFRUs0X1BFUklPRDsKICAgIH0KCiAgICBmdW5jdGlvbiBmaW5hbGl6YXRpb24oKSBpbnRlcm5hbCB7CiAgICAgICAgc3VwZXIuZmluYWxpemF0aW9uKCk7CiAgICAgICAgdWludDI1NiBvd25lclNoYXJlVG9rZW5zID0gdG9rZW4uZ2V0VG90YWxTdXBwbHkoKS5tdWwoOSkuZGl2KDExKTsKCiAgICAgICAgdG9rZW4ubWludCh3YWxsZXQsIG93bmVyU2hhcmVUb2tlbnMpOwogICAgfQp9'.
	

]
