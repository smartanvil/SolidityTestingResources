Class {
	#name : #SRTca82cfcfbe9eed35f7afee9c17755c679be13241,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTca82cfcfbe9eed35f7afee9c17755c679be13241 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7IC8vIHNvbGhpbnQtZGlzYWJsZS1saW5lCgpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKY29udHJhY3QgRVJDNzIxIHsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSUQpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKICAgIGZ1bmN0aW9uIGltcGxlbWVudHNFUkM3MjEoKSBwdWJsaWMgcHVyZSByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JRCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBhZGRyKTsKICAgIGZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JRCkgcHVibGljOwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHRvdGFsKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JRCkgcHVibGljOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSUQpIHB1YmxpYzsKCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHRva2VuSUQpOyAvLyBzb2xoaW50LWRpc2FibGUtbGluZQogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgYXBwcm92ZWQsIHVpbnQyNTYgdG9rZW5JRCk7CgogICAgZnVuY3Rpb24gbmFtZSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKHN0cmluZyk7CiAgICBmdW5jdGlvbiBzeW1ib2woKSBwdWJsaWMgcHVyZSByZXR1cm5zIChzdHJpbmcpOwp9Cgpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cn0KCmNvbnRyYWN0IE1hbmFnZWFibGUgaXMgT3duYWJsZSB7CgogICAgYWRkcmVzcyBwdWJsaWMgbWFuYWdlcjsKICAgIGJvb2wgcHVibGljIGNvbnRyYWN0TG9jazsKCiAgICBldmVudCBNYW5hZ2VyVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzTWFuYWdlciwgYWRkcmVzcyBpbmRleGVkIG5ld01hbmFnZXIpOwogICAgZXZlbnQgQ29udHJhY3RMb2NrQ2hhbmdlZChhZGRyZXNzIGFkbWluLCBib29sIHN0YXRlKTsKCiAgICBmdW5jdGlvbiBNYW5hZ2VhYmxlKCkgcHVibGljIHsKICAgICAgICBtYW5hZ2VyID0gbXNnLnNlbmRlcjsKICAgICAgICBjb250cmFjdExvY2sgPSBmYWxzZTsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5TWFuYWdlcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gbWFuYWdlcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5QWRtaW4oKSB7CiAgICAgICAgcmVxdWlyZSgobXNnLnNlbmRlciA9PSBtYW5hZ2VyKSB8fCAobXNnLnNlbmRlciA9PSBvd25lcikpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgaXNVbmxvY2tlZCgpIHsKICAgICAgICByZXF1aXJlKCFjb250cmFjdExvY2spOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJNYW5hZ2VyKGFkZHJlc3MgbmV3TWFuYWdlcikgcHVibGljIG9ubHlBZG1pbiB7CiAgICAgICAgcmVxdWlyZShuZXdNYW5hZ2VyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIE1hbmFnZXJUcmFuc2ZlcnJlZChtYW5hZ2VyLCBuZXdNYW5hZ2VyKTsKICAgICAgICBtYW5hZ2VyID0gbmV3TWFuYWdlcjsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRDb250cmFjdExvY2soYm9vbCBzZXR0aW5nKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICBjb250cmFjdExvY2sgPSBzZXR0aW5nOwogICAgICAgIENvbnRyYWN0TG9ja0NoYW5nZWQobXNnLnNlbmRlciwgc2V0dGluZyk7CiAgICB9CgogICAgZnVuY3Rpb24gcGF5b3V0KGFkZHJlc3MgX3RvKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBpZiAoX3RvID09IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgb3duZXIudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfdG8udHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gd2l0aGRyYXdGdW5kcyhhZGRyZXNzIF90bywgdWludDI1NiBhbW91bnQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUodGhpcy5iYWxhbmNlID49IGFtb3VudCk7CiAgICAgICAgaWYgKF90byA9PSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIG93bmVyLnRyYW5zZmVyKGFtb3VudCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3RvLnRyYW5zZmVyKGFtb3VudCk7CiAgICAgICAgfQogICAgfQp9Cgpjb250cmFjdCBUb2tlbkxheWVyIGlzIEVSQzcyMSwgTWFuYWdlYWJsZSB7CgogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBFVkVOVFMgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAgIGV2ZW50IFRva2VuQ3JlYXRlZCh1aW50MjU2IHRva2VuSWQsIGJ5dGVzMzIgbmFtZSwgdWludDI1NiBwYXJlbnRJZCwgYWRkcmVzcyBvd25lcik7CiAgICBldmVudCBUb2tlbkRlbGV0ZWQodWludDI1NiB0b2tlbklkKTsKCiAgICBldmVudCBUb2tlblNvbGQoCiAgICAgICAgdWludDI1NiB0b2tlbklkLCB1aW50MjU2IG9sZFByaWNlLAogICAgICAgIHVpbnQyNTYgbmV3UHJpY2UsIGFkZHJlc3MgcHJldk93bmVyLAogICAgICAgIGFkZHJlc3Mgd2lubmVyLCBieXRlczMyIG5hbWUsCiAgICAgICAgdWludDI1NiBwYXJlbnRJZAogICAgKTsKCiAgICBldmVudCBQcmljZUNoYW5nZWQodWludDI1NiB0b2tlbklkLCB1aW50MjU2IG9sZFByaWNlLCB1aW50MjU2IG5ld1ByaWNlKTsKICAgIGV2ZW50IFBhcmVudENoYW5nZWQodWludDI1NiB0b2tlbklkLCB1aW50MjU2IG9sZFBhcmVudElkLCB1aW50MjU2IG5ld1BhcmVudElkKTsKICAgIGV2ZW50IE5hbWVDaGFuZ2VkKHVpbnQyNTYgdG9rZW5JZCwgYnl0ZXMzMiBvbGROYW1lLCBieXRlczMyIG5ld05hbWUpOwogICAgZXZlbnQgTWV0YURhdGFDaGFuZ2VkKHVpbnQyNTYgdG9rZW5JZCwgYnl0ZXMzMiBvbGRNZXRhLCBieXRlczMyIG5ld01ldGEpOwovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBTVE9SQUdFICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgdWludDI1NiBwcml2YXRlIGNvbnN0YW50IERFRkFVTFRQQVJFTlQgPSAxMjM0NTY3ODk7CgogICAgbWFwcGluZyAodWludDI1NiA9PiBUb2tlbikgICBwcml2YXRlIHRva2VuSW5kZXhUb1Rva2VuOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwcml2YXRlIG93bmVyc2hpcFRva2VuQ291bnQ7CgogICAgYWRkcmVzcyBwdWJsaWMgZ2FtZUFkZHJlc3M7CiAgICBhZGRyZXNzIHB1YmxpYyBwYXJlbnRBZGRyOwoKICAgIHVpbnQyNTYgcHJpdmF0ZSB0b3RhbFRva2VuczsKICAgIHVpbnQyNTYgcHVibGljIGRldkZlZSA9IDUwOwogICAgdWludDI1NiBwdWJsaWMgb3duZXJGZWUgPSAyMDA7CiAgICB1aW50MjU2WzEwXSBwcml2YXRlIGNoYWluRmVlcyA9IFsxMF07CgogICAgc3RydWN0IFRva2VuIHsKICAgICAgICBib29sIGV4aXN0czsKICAgICAgICBhZGRyZXNzIGFwcHJvdmVkOwogICAgICAgIGFkZHJlc3Mgb3duZXI7CiAgICAgICAgYnl0ZXMzMiBtZXRhZGF0YTsKICAgICAgICBieXRlczMyIG5hbWU7CiAgICAgICAgdWludDI1NiBsYXN0QmxvY2s7CiAgICAgICAgdWludDI1NiBwYXJlbnRJZDsKICAgICAgICB1aW50MjU2IHByaWNlOwogICAgfQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIE1PRElGSUVSUyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgbW9kaWZpZXIgb25seVN5c3RlbSgpIHsKICAgICAgICByZXF1aXJlKChtc2cuc2VuZGVyID09IGdhbWVBZGRyZXNzKSB8fCAobXNnLnNlbmRlciA9PSBtYW5hZ2VyKSk7CiAgICAgICAgXzsKICAgIH0KLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIENPTlNUUlVDVE9SICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAgIGZ1bmN0aW9uIFRva2VuTGF5ZXIoYWRkcmVzcyBfZ2FtZUFkZHJlc3MsIGFkZHJlc3MgX3BhcmVudEFkZHIpIHB1YmxpYyB7CiAgICAgICAgZ2FtZUFkZHJlc3MgPSBfZ2FtZUFkZHJlc3M7CiAgICAgICAgcGFyZW50QWRkciA9IF9wYXJlbnRBZGRyOwogICAgfQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIFBVQkxJQyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgZnVuY3Rpb24gaW1wbGVtZW50c0VSQzcyMSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBuYW1lKCkgcHVibGljIHB1cmUgcmV0dXJucyAoc3RyaW5nKSB7CiAgICAgICAgcmV0dXJuICJMYXllck5hbWUiOwogICAgfQoKICAgIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyBwdXJlIHJldHVybnMgKHN0cmluZykgewogICAgICAgIHJldHVybiAiTGF5ZXJTeW1ib2wiOwogICAgfQoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQsIGFkZHJlc3MgX2Zyb20pIHB1YmxpYyBvbmx5U3lzdGVtIHsKICAgICAgICBfYXBwcm92ZShfdG8sIF90b2tlbklkLCBfZnJvbSk7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIGlzVW5sb2NrZWQgewogICAgICAgIF9hcHByb3ZlKF90bywgX3Rva2VuSWQsIG1zZy5zZW5kZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIG93bmVyc2hpcFRva2VuQ291bnRbX293bmVyXTsKICAgIH0KCiAgICBmdW5jdGlvbiBidW5kbGVUb2tlbih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnQyNTZbOF0gX3Rva2VuRGF0YSkgewogICAgICAgIFRva2VuIHN0b3JhZ2UgdG9rZW4gPSB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF07CgogICAgICAgIHVpbnQyNTZbOF0gbWVtb3J5IHRva2VuRGF0YTsKCiAgICAgICAgdG9rZW5EYXRhWzBdID0gdWludDI1Nih0b2tlbi5uYW1lKTsKICAgICAgICB0b2tlbkRhdGFbMV0gPSB0b2tlbi5wYXJlbnRJZDsKICAgICAgICB0b2tlbkRhdGFbMl0gPSB0b2tlbi5wcmljZTsKICAgICAgICB0b2tlbkRhdGFbM10gPSB1aW50MjU2KHRva2VuLm93bmVyKTsKICAgICAgICB0b2tlbkRhdGFbNF0gPSBfZ2V0TmV4dFByaWNlKF90b2tlbklkKTsKICAgICAgICB0b2tlbkRhdGFbNV0gPSBkZXZGZWUrZ2V0Q2hhaW5GZWVzKF90b2tlbklkKTsKICAgICAgICB0b2tlbkRhdGFbNl0gPSB1aW50MjU2KHRva2VuLmFwcHJvdmVkKTsKICAgICAgICB0b2tlbkRhdGFbN10gPSB1aW50MjU2KHRva2VuLm1ldGFkYXRhKTsKICAgICAgICByZXR1cm4gdG9rZW5EYXRhOwogICAgfQoKICAgIGZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JZCwgYWRkcmVzcyBfdG8pIHB1YmxpYyBvbmx5U3lzdGVtIHsKICAgICAgICBfdGFrZU93bmVyc2hpcChfdG9rZW5JZCwgX3RvKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0YWtlT3duZXJzaGlwKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBpc1VubG9ja2VkIHsKICAgICAgICBfdGFrZU93bmVyc2hpcChfdG9rZW5JZCwgbXNnLnNlbmRlcik7CiAgICB9CgogICAgZnVuY3Rpb24gdG9rZW5zT2ZPd25lcihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NltdIG93bmVyVG9rZW5zKSB7CiAgICAgICAgdWludDI1NiB0b2tlbkNvdW50ID0gYmFsYW5jZU9mKF9vd25lcik7CiAgICAgICAgaWYgKHRva2VuQ291bnQgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gbmV3IHVpbnQyNTZbXSgwKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB1aW50MjU2W10gbWVtb3J5IHJlc3VsdCA9IG5ldyB1aW50MjU2W10odG9rZW5Db3VudCk7CiAgICAgICAgICAgIHVpbnQyNTYgX3RvdGFsVG9rZW5zID0gdG90YWxTdXBwbHkoKTsKICAgICAgICAgICAgdWludDI1NiByZXN1bHRJbmRleCA9IDA7CgogICAgICAgICAgICB1aW50MjU2IHRva2VuSWQgPSAwOwogICAgICAgICAgICB1aW50MjU2IHRva2VuSW5kZXggPSAwOwogICAgICAgICAgICB3aGlsZSAodG9rZW5JbmRleCA8PSBfdG90YWxUb2tlbnMpIHsKICAgICAgICAgICAgICAgIGlmIChleGlzdHModG9rZW5JZCkpIHsKICAgICAgICAgICAgICAgICAgICB0b2tlbkluZGV4Kys7CiAgICAgICAgICAgICAgICAgICAgaWYgKHRva2VuSW5kZXhUb1Rva2VuW3Rva2VuSWRdLm93bmVyID09IF9vd25lcikgewogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbcmVzdWx0SW5kZXhdID0gdG9rZW5JZDsKICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0SW5kZXgrKzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0b2tlbklkKys7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHRvdGFsKSB7CiAgICAgICAgcmV0dXJuIHRvdGFsVG9rZW5zOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCBhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgb25seVN5c3RlbSB7CiAgICAgICAgX2NoZWNrVGhlblRyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIGlzVW5sb2NrZWQgewogICAgICAgIF9jaGVja1RoZW5UcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF90b2tlbklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBvbmx5U3lzdGVtIHsKICAgICAgICBfdHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIGlzVW5sb2NrZWQgewogICAgICAgIF90cmFuc2ZlckZyb20oX2Zyb20sIG1zZy5zZW5kZXIsIF90b2tlbklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjcmVhdGVUb2tlbigKICAgICAgICB1aW50MjU2IF90b2tlbklkLCBhZGRyZXNzIF9vd25lciwKICAgICAgICBieXRlczMyIF9uYW1lLCB1aW50MjU2IF9wYXJlbnRJZCwKICAgICAgICB1aW50MjU2IF9wcmljZSwgYnl0ZXMzMiBfbWV0YWRhdGEKICAgICkgcHVibGljIG9ubHlBZG1pbiB7CiAgICAgICAgcmVxdWlyZShfcHJpY2UgPiAwKTsKICAgICAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChfb3duZXIpKTsKICAgICAgICByZXF1aXJlKF90b2tlbklkID09IHVpbnQyNTYodWludDMyKF90b2tlbklkKSkpOwogICAgICAgIHJlcXVpcmUoIWV4aXN0cyhfdG9rZW5JZCkpOwoKICAgICAgICB0b3RhbFRva2VucysrOwoKICAgICAgICBUb2tlbiBtZW1vcnkgX3Rva2VuID0gVG9rZW4oewogICAgICAgICAgICBuYW1lOiBfbmFtZSwKICAgICAgICAgICAgcGFyZW50SWQ6IF9wYXJlbnRJZCwKICAgICAgICAgICAgZXhpc3RzOiB0cnVlLAogICAgICAgICAgICBwcmljZTogX3ByaWNlLAogICAgICAgICAgICBvd25lcjogX293bmVyLAogICAgICAgICAgICBhcHByb3ZlZCA6IDAsCiAgICAgICAgICAgIGxhc3RCbG9jayA6IGJsb2NrLm51bWJlciwKICAgICAgICAgICAgbWV0YWRhdGEgOiBfbWV0YWRhdGEKICAgICAgICB9KTsKCiAgICAgICAgdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdID0gX3Rva2VuOwoKICAgICAgICBUb2tlbkNyZWF0ZWQoX3Rva2VuSWQsIF9uYW1lLCBfcGFyZW50SWQsIF9vd25lcik7CgogICAgICAgIF90cmFuc2ZlcihhZGRyZXNzKDApLCBfb3duZXIsIF90b2tlbklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjcmVhdGVUb2tlbnMoCiAgICAgICAgdWludDI1NltdIF90b2tlbklkcywgYWRkcmVzc1tdIF9vd25lcnMsCiAgICAgICAgYnl0ZXMzMltdIF9uYW1lcywgdWludDI1NltdIF9wYXJlbnRJZHMsCiAgICAgICAgdWludDI1NltdIF9wcmljZXMsIGJ5dGVzMzJbXSBfbWV0YWRhdGFzCiAgICApIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIGZvciAodWludDI1NiBpZCA9IDA7IGlkIDwgX3Rva2VuSWRzLmxlbmd0aDsgaWQrKykgewogICAgICAgICAgICBjcmVhdGVUb2tlbigKICAgICAgICAgICAgICAgIF90b2tlbklkc1tpZF0sIF9vd25lcnNbaWRdLCBfbmFtZXNbaWRdLAogICAgICAgICAgICAgICAgX3BhcmVudElkc1tpZF0sIF9wcmljZXNbaWRdLCBfbWV0YWRhdGFzW2lkXQogICAgICAgICAgICAgICAgKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZGVsZXRlVG9rZW4odWludDI1NiBfdG9rZW5JZCkgcHVibGljIG9ubHlBZG1pbiB7CiAgICAgICAgcmVxdWlyZShfdG9rZW5JZCA9PSB1aW50MjU2KHVpbnQzMihfdG9rZW5JZCkpKTsKICAgICAgICByZXF1aXJlKGV4aXN0cyhfdG9rZW5JZCkpOwogICAgICAgIHRvdGFsVG9rZW5zLS07CgogICAgICAgIGFkZHJlc3Mgb2xkT3duZXIgPSB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ub3duZXI7CgogICAgICAgIG93bmVyc2hpcFRva2VuQ291bnRbb2xkT3duZXJdID0gb3duZXJzaGlwVG9rZW5Db3VudFtvbGRPd25lcl0tLTsKICAgICAgICBkZWxldGUgdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdOwogICAgICAgIFRva2VuRGVsZXRlZChfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gaW5jcmVtZW50UHJpY2UodWludDI1NiBfdG9rZW5JZCwgYWRkcmVzcyBfdG8pIHB1YmxpYyBvbmx5U3lzdGVtIHsKICAgICAgICByZXF1aXJlKGV4aXN0cyhfdG9rZW5JZCkpOwogICAgICAgIHVpbnQyNTYgX3ByaWNlID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLnByaWNlOwogICAgICAgIGFkZHJlc3MgX293bmVyID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm93bmVyOwogICAgICAgIHVpbnQyNTYgX3RvdGFsRmVlcyA9IGdldENoYWluRmVlcyhfdG9rZW5JZCk7CiAgICAgICAgdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLnByaWNlID0gX3ByaWNlLm11bCgxMDAwK293bmVyRmVlKS5kaXYoMTAwMC0oZGV2RmVlK190b3RhbEZlZXMpKTsKCiAgICAgICAgVG9rZW5Tb2xkKAogICAgICAgICAgICBfdG9rZW5JZCwgX3ByaWNlLCB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ucHJpY2UsCiAgICAgICAgICAgIF9vd25lciwgX3RvLCB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ubmFtZSwKICAgICAgICAgICAgdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLnBhcmVudElkCiAgICAgICAgKTsKICAgIH0KCiAgICBmdW5jdGlvbiBvd25lck9mKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3MgX293bmVyKSB7CiAgICAgICAgcmVxdWlyZShleGlzdHMoX3Rva2VuSWQpKTsKICAgICAgICBfb3duZXIgPSB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ub3duZXI7CiAgICB9CgogICAgZnVuY3Rpb24gYmxvY2tlZCh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sIF9ibG9ja2VkKSB7CiAgICAgICAgcmV0dXJuICh0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ubGFzdEJsb2NrID09IGJsb2NrLm51bWJlcik7CiAgICB9CgogICAgZnVuY3Rpb24gZXhpc3RzKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMoYm9vbCkgewogICAgICAgIHJldHVybiAodG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLmV4aXN0cyk7CiAgICB9Ci8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCiAgICBmdW5jdGlvbiBzZXRMYXllclBhcmVudChhZGRyZXNzIF9wYXJlbnQpIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIHBhcmVudEFkZHIgPSBfcGFyZW50OwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEdhbWUoYWRkcmVzcyBfZ2FtZUFkZHJlc3MpIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIGdhbWVBZGRyZXNzID0gX2dhbWVBZGRyZXNzOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFByaWNlKHVpbnQyNTYgX3Rva2VuSWQsIHVpbnQyNTYgX3ByaWNlLCBhZGRyZXNzIF9vd25lcikgcHVibGljIG9ubHlTeXN0ZW0gewogICAgICAgIHJlcXVpcmUoX293bnMoX293bmVyLCBfdG9rZW5JZCkpOwogICAgICAgIHVpbnQyNTYgb2xkUHJpY2UgPSB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ucHJpY2U7CiAgICAgICAgdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLnByaWNlID0gX3ByaWNlOwogICAgICAgIFByaWNlQ2hhbmdlZChfdG9rZW5JZCwgb2xkUHJpY2UsIF9wcmljZSk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0UGFyZW50KHVpbnQyNTYgX3Rva2VuSWQsIHVpbnQyNTYgX3BhcmVudElkKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICByZXF1aXJlKGV4aXN0cyhfdG9rZW5JZCkpOwogICAgICAgIHVpbnQyNTYgb2xkUGFyZW50SWQgPSB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ucGFyZW50SWQ7CiAgICAgICAgdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLnBhcmVudElkID0gX3BhcmVudElkOwogICAgICAgIFBhcmVudENoYW5nZWQoX3Rva2VuSWQsIG9sZFBhcmVudElkLCBfcGFyZW50SWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldE5hbWUodWludDI1NiBfdG9rZW5JZCwgYnl0ZXMzMiBfbmFtZSkgcHVibGljIG9ubHlBZG1pbiB7CiAgICAgICAgcmVxdWlyZShleGlzdHMoX3Rva2VuSWQpKTsKICAgICAgICBieXRlczMyIG9sZE5hbWUgPSB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ubmFtZTsKICAgICAgICB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ubmFtZSA9IF9uYW1lOwogICAgICAgIE5hbWVDaGFuZ2VkKF90b2tlbklkLCBvbGROYW1lLCBfbmFtZSk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0TWV0YWRhdGEodWludDI1NiBfdG9rZW5JZCwgYnl0ZXMzMiBfbWV0YWRhdGEpIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIHJlcXVpcmUoZXhpc3RzKF90b2tlbklkKSk7CiAgICAgICAgYnl0ZXMzMiBvbGRNZXRhID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm1ldGFkYXRhOwogICAgICAgIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5tZXRhZGF0YSA9IF9tZXRhZGF0YTsKICAgICAgICBNZXRhRGF0YUNoYW5nZWQoX3Rva2VuSWQsIG9sZE1ldGEsIF9tZXRhZGF0YSk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0RGV2RmVlKHVpbnQyNTYgX2RldkZlZSkgcHVibGljIG9ubHlBZG1pbiB7CiAgICAgICAgZGV2RmVlID0gX2RldkZlZTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRPd25lckZlZSh1aW50MjU2IF9vd25lckZlZSkgcHVibGljIG9ubHlBZG1pbiB7CiAgICAgICAgb3duZXJGZWUgPSBfb3duZXJGZWU7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0Q2hhaW5GZWVzKHVpbnQyNTZbMTBdIF9jaGFpbkZlZXMpIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIGNoYWluRmVlcyA9IF9jaGFpbkZlZXM7CiAgICB9Ci8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogR0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCiAgICBmdW5jdGlvbiBnZXRUb2tlbih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zCiAgICAoCiAgICAgICAgYnl0ZXMzMiB0b2tlbk5hbWUsIHVpbnQyNTYgcGFyZW50SWQsIHVpbnQyNTYgcHJpY2UsCiAgICAgICAgYWRkcmVzcyBfb3duZXIsIHVpbnQyNTYgbmV4dFByaWNlLCB1aW50MjU2IG5leHRQcmljZUZlZXMsCiAgICAgICAgYWRkcmVzcyBhcHByb3ZlZCwgYnl0ZXMzMiBtZXRhZGF0YQogICAgKSB7CiAgICAgICAgVG9rZW4gc3RvcmFnZSB0b2tlbiA9IHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXTsKCiAgICAgICAgdG9rZW5OYW1lID0gdG9rZW4ubmFtZTsKICAgICAgICBwYXJlbnRJZCA9IHRva2VuLnBhcmVudElkOwogICAgICAgIHByaWNlID0gdG9rZW4ucHJpY2U7CiAgICAgICAgX293bmVyID0gdG9rZW4ub3duZXI7CiAgICAgICAgbmV4dFByaWNlID0gX2dldE5leHRQcmljZShfdG9rZW5JZCk7CiAgICAgICAgbmV4dFByaWNlRmVlcyA9IGRldkZlZStnZXRDaGFpbkZlZXMoX3Rva2VuSWQpOwogICAgICAgIG1ldGFkYXRhID0gdG9rZW4ubWV0YWRhdGE7CiAgICAgICAgYXBwcm92ZWQgPSB0b2tlbi5hcHByb3ZlZDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRDaGFpbkZlZXModWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBfdG90YWwpIHsKICAgICAgICB1aW50MjU2IGNoYWluTGVuZ3RoID0gX2dldENoYWluTGVuZ3RoKF90b2tlbklkKTsKICAgICAgICB1aW50MjU2IHRvdGFsRmVlID0gMDsKICAgICAgICBmb3IgKHVpbnQgaWQgPSAwOyBpZCA8IGNoYWluTGVuZ3RoOyBpZCsrKSB7CiAgICAgICAgICAgIHRvdGFsRmVlID0gdG90YWxGZWUgKyBjaGFpbkZlZXNbaWRdOwogICAgICAgIH0KICAgICAgICByZXR1cm4odG90YWxGZWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldENoYWluRmVlQXJyYXkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2WzEwXSBtZW1vcnkgX2NoYWluRmVlcykgewogICAgICAgIHJldHVybihjaGFpbkZlZXMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFByaWNlT2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBwcmljZSkgewogICAgICAgIHJlcXVpcmUoZXhpc3RzKF90b2tlbklkKSk7CiAgICAgICAgcmV0dXJuIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5wcmljZTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRQYXJlbnRPZih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHBhcmVudElkKSB7CiAgICAgICAgcmVxdWlyZShleGlzdHMoX3Rva2VuSWQpKTsKICAgICAgICByZXR1cm4gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLnBhcmVudElkOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldE1ldGFkYXRhT2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYnl0ZXMzMiBtZXRhZGF0YSkgewogICAgICAgIHJlcXVpcmUoZXhpc3RzKF90b2tlbklkKSk7CiAgICAgICAgcmV0dXJuICh0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ubWV0YWRhdGEpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldENoYWluKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3NbMTBdIG1lbW9yeSBfb3duZXJzKSB7CiAgICAgICAgcmVxdWlyZShleGlzdHMoX3Rva2VuSWQpKTsKCiAgICAgICAgdWludDI1NiBfcGFyZW50SWQgPSBnZXRQYXJlbnRPZihfdG9rZW5JZCk7CiAgICAgICAgYWRkcmVzcyBfcGFyZW50QWRkciA9IHBhcmVudEFkZHI7CgogICAgICAgIGFkZHJlc3NbMTBdIG1lbW9yeSByZXN1bHQ7CgogICAgICAgIGlmIChfcGFyZW50SWQgIT0gREVGQVVMVFBBUkVOVCAmJiBfYWRkcmVzc05vdE51bGwoX3BhcmVudEFkZHIpKSB7CiAgICAgICAgICAgIHVpbnQyNTYgcmVzdWx0SW5kZXggPSAwOwoKICAgICAgICAgICAgVG9rZW5MYXllciBsYXllciA9IFRva2VuTGF5ZXIoX3BhcmVudEFkZHIpOwogICAgICAgICAgICBib29sIHBhcmVudEV4aXN0cyA9IGxheWVyLmV4aXN0cyhfcGFyZW50SWQpOwoKICAgICAgICAgICAgd2hpbGUgKChfcGFyZW50SWQgIT0gREVGQVVMVFBBUkVOVCkgJiYgX2FkZHJlc3NOb3ROdWxsKF9wYXJlbnRBZGRyKSAmJiBwYXJlbnRFeGlzdHMpIHsKICAgICAgICAgICAgICAgIHBhcmVudEV4aXN0cyA9IGxheWVyLmV4aXN0cyhfcGFyZW50SWQpOwogICAgICAgICAgICAgICAgaWYgKCFwYXJlbnRFeGlzdHMpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4ocmVzdWx0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHRJbmRleF0gPSBsYXllci5vd25lck9mKF9wYXJlbnRJZCk7CiAgICAgICAgICAgICAgICByZXN1bHRJbmRleCsrOwoKICAgICAgICAgICAgICAgIF9wYXJlbnRJZCA9IGxheWVyLmdldFBhcmVudE9mKF9wYXJlbnRJZCk7CiAgICAgICAgICAgICAgICBfcGFyZW50QWRkciA9IGxheWVyLnBhcmVudEFkZHIoKTsKCiAgICAgICAgICAgICAgICBsYXllciA9IFRva2VuTGF5ZXIoX3BhcmVudEFkZHIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4ocmVzdWx0KTsKICAgICAgICB9CiAgICB9Ci8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIFBSSVZBVEUgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCiAgICBmdW5jdGlvbiBfYWRkcmVzc05vdE51bGwoYWRkcmVzcyBfdG8pIHByaXZhdGUgcHVyZSByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIF90byAhPSBhZGRyZXNzKDApOwogICAgfQoKICAgIGZ1bmN0aW9uIF9hcHByb3ZlZChhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gKHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5hcHByb3ZlZCA9PSBfdG8pOwogICAgfQoKICAgIGZ1bmN0aW9uIF9vd25zKGFkZHJlc3MgY2xhaW1hbnQsIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIGNsYWltYW50ID09IHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5vd25lcjsKICAgIH0KCiAgICBmdW5jdGlvbiBfY2hlY2tUaGVuVHJhbnNmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgewogICAgICAgIHJlcXVpcmUoX293bnMoX2Zyb20sIF90b2tlbklkKSk7CiAgICAgICAgcmVxdWlyZShfYWRkcmVzc05vdE51bGwoX3RvKSk7CiAgICAgICAgcmVxdWlyZShleGlzdHMoX3Rva2VuSWQpKTsKICAgICAgICBfdHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIF90cmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB7CiAgICAgICAgb3duZXJzaGlwVG9rZW5Db3VudFtfdG9dKys7CiAgICAgICAgdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm93bmVyID0gX3RvOwogICAgICAgIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5sYXN0QmxvY2sgPSBibG9jay5udW1iZXI7CgogICAgICAgIGlmIChfZnJvbSAhPSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIG93bmVyc2hpcFRva2VuQ291bnRbX2Zyb21dLS07CiAgICAgICAgICAgIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5hcHByb3ZlZCA9IDA7CiAgICAgICAgfQoKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gX2FwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQsIGFkZHJlc3MgX2Zyb20pIHByaXZhdGUgewogICAgICAgIHJlcXVpcmUoX293bnMoX2Zyb20sIF90b2tlbklkKSk7CgogICAgICAgIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5hcHByb3ZlZCA9IF90bzsKCiAgICAgICAgQXBwcm92YWwoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIF90YWtlT3duZXJzaGlwKHVpbnQyNTYgX3Rva2VuSWQsIGFkZHJlc3MgX3RvKSBwcml2YXRlIHsKICAgICAgICBhZGRyZXNzIG5ld093bmVyID0gX3RvOwogICAgICAgIGFkZHJlc3Mgb2xkT3duZXIgPSB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ub3duZXI7CgogICAgICAgIHJlcXVpcmUoX2FkZHJlc3NOb3ROdWxsKG5ld093bmVyKSk7CiAgICAgICAgcmVxdWlyZShfYXBwcm92ZWQobmV3T3duZXIsIF90b2tlbklkKSk7CgogICAgICAgIF90cmFuc2ZlcihvbGRPd25lciwgbmV3T3duZXIsIF90b2tlbklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHsKICAgICAgICByZXF1aXJlKF9vd25zKF9mcm9tLCBfdG9rZW5JZCkpOwogICAgICAgIHJlcXVpcmUoX2FwcHJvdmVkKF90bywgX3Rva2VuSWQpKTsKICAgICAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChfdG8pKTsKCiAgICAgICAgX3RyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfZ2V0Q2hhaW5MZW5ndGgodWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB2aWV3IHJldHVybnMgKHVpbnQyNTYgX2xlbmd0aCkgewogICAgICAgIHVpbnQyNTYgbGVuZ3RoOwoKICAgICAgICB1aW50MjU2IF9wYXJlbnRJZCA9IGdldFBhcmVudE9mKF90b2tlbklkKTsKICAgICAgICBhZGRyZXNzIF9wYXJlbnRBZGRyID0gcGFyZW50QWRkcjsKICAgICAgICBpZiAoX3BhcmVudElkID09IERFRkFVTFRQQVJFTlQgfHwgIV9hZGRyZXNzTm90TnVsbChfcGFyZW50QWRkcikpIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQoKICAgICAgICBUb2tlbkxheWVyIGxheWVyID0gVG9rZW5MYXllcihfcGFyZW50QWRkcik7CiAgICAgICAgYm9vbCBwYXJlbnRFeGlzdHMgPSBsYXllci5leGlzdHMoX3BhcmVudElkKTsKCiAgICAgICAgd2hpbGUgKChfcGFyZW50SWQgIT0gREVGQVVMVFBBUkVOVCkgJiYgX2FkZHJlc3NOb3ROdWxsKF9wYXJlbnRBZGRyKSAmJiBwYXJlbnRFeGlzdHMpIHsKICAgICAgICAgICAgcGFyZW50RXhpc3RzID0gbGF5ZXIuZXhpc3RzKF9wYXJlbnRJZCk7CiAgICAgICAgICAgIGlmKCFwYXJlbnRFeGlzdHMpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4obGVuZ3RoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBfcGFyZW50SWQgPSBsYXllci5nZXRQYXJlbnRPZihfcGFyZW50SWQpOwogICAgICAgICAgICBfcGFyZW50QWRkciA9IGxheWVyLnBhcmVudEFkZHIoKTsKICAgICAgICAgICAgbGF5ZXIgPSBUb2tlbkxheWVyKF9wYXJlbnRBZGRyKTsKICAgICAgICAgICAgbGVuZ3RoKys7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4obGVuZ3RoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfZ2V0TmV4dFByaWNlKHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgdmlldyByZXR1cm5zICh1aW50MjU2IF9uZXh0UHJpY2UpIHsKICAgICAgICB1aW50MjU2IF9wcmljZSA9IHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5wcmljZTsKICAgICAgICB1aW50MjU2IF90b3RhbEZlZXMgPSBnZXRDaGFpbkZlZXMoX3Rva2VuSWQpOwogICAgICAgIF9wcmljZSA9IF9wcmljZS5tdWwoMTAwMCtvd25lckZlZSkuZGl2KDEwMDAtKGRldkZlZStfdG90YWxGZWVzKSk7CiAgICAgICAgcmV0dXJuKF9wcmljZSk7CiAgICB9Cn0KCmNvbnRyYWN0IENvcmVDb250cmFjdCBpcyBNYW5hZ2VhYmxlIHsKCiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBTVE9SQUdFICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKICAgIGJvb2wgcHVibGljIHByaWNlTG9ja2VkID0gdHJ1ZTsKICAgIHVpbnQyNTYgcHJpdmF0ZSBjb25zdGFudCBERUZBVUxUUEFSRU5UID0gMTIzNDU2Nzg5OwoKICAgIHVpbnQyNTYgcHVibGljIGxheWVyQ291bnQ7CiAgICBtYXBwaW5nKHVpbnQyNTYgPT4gYWRkcmVzcykgcHVibGljIGdldExheWVyRnJvbUlkOwogICAgbWFwcGluZyh1aW50MjU2ID0+IGJ5dGVzMzIpIHB1YmxpYyBnZXRMYXllck5hbWVGcm9tSWQ7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgcHJpdmF0ZSBibGFja2xpc3RlZDsKCiAgICBib29sIHB1YmxpYyBibGFja0xpc3RBY3RpdmU7CiAgICBib29sIHB1YmxpYyBibG9ja0xvY2tBY3RpdmU7CgoKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogUFVCTElDICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkLCB1aW50MjU2IGxheWVySWQpIHB1YmxpYyBpc1VubG9ja2VkIHsKICAgICAgICBhZGRyZXNzIGxheWVyQWRkciA9IGdldExheWVyRnJvbUlkW2xheWVySWRdOwogICAgICAgIFRva2VuTGF5ZXIgbGF5ZXIgPSBUb2tlbkxheWVyKGxheWVyQWRkcik7CiAgICAgICAgbGF5ZXIuYXBwcm92ZShfdG8sIF90b2tlbklkLCBtc2cuc2VuZGVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0YWtlT3duZXJzaGlwKHVpbnQyNTYgX3Rva2VuSWQsIHVpbnQyNTYgbGF5ZXJJZCkgcHVibGljIGlzVW5sb2NrZWQgewogICAgICAgIGFkZHJlc3MgbGF5ZXJBZGRyID0gZ2V0TGF5ZXJGcm9tSWRbbGF5ZXJJZF07CiAgICAgICAgVG9rZW5MYXllciBsYXllciA9IFRva2VuTGF5ZXIobGF5ZXJBZGRyKTsKICAgICAgICBsYXllci50YWtlT3duZXJzaGlwKF90b2tlbklkLCBtc2cuc2VuZGVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCwgdWludDI1NiBsYXllcklkKSBwdWJsaWMgaXNVbmxvY2tlZCB7CiAgICAgICAgYWRkcmVzcyBsYXllckFkZHIgPSBnZXRMYXllckZyb21JZFtsYXllcklkXTsKICAgICAgICBUb2tlbkxheWVyIGxheWVyID0gVG9rZW5MYXllcihsYXllckFkZHIpOwogICAgICAgIGxheWVyLnRyYW5zZmVyKF90bywgbXNnLnNlbmRlciwgX3Rva2VuSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFByaWNlKHVpbnQyNTYgX3Rva2VuSWQsIHVpbnQyNTYgX3ByaWNlLCB1aW50MjU2IGxheWVySWQpIHB1YmxpYyBpc1VubG9ja2VkIHsKICAgICAgICBhZGRyZXNzIGxheWVyQWRkciA9IGdldExheWVyRnJvbUlkW2xheWVySWRdOwogICAgICAgIHJlcXVpcmUoIXByaWNlTG9ja2VkKTsKICAgICAgICBUb2tlbkxheWVyIGxheWVyID0gVG9rZW5MYXllcihsYXllckFkZHIpOwogICAgICAgIGxheWVyLnNldFByaWNlKF90b2tlbklkLCBfcHJpY2UsIG1zZy5zZW5kZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF90b2tlbklkLCB1aW50MjU2IGxheWVySWQpIHB1YmxpYyBpc1VubG9ja2VkIHsKICAgICAgICBhZGRyZXNzIGxheWVyQWRkciA9IGdldExheWVyRnJvbUlkW2xheWVySWRdOwogICAgICAgIFRva2VuTGF5ZXIgbGF5ZXIgPSBUb2tlbkxheWVyKGxheWVyQWRkcik7CiAgICAgICAgbGF5ZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBtc2cuc2VuZGVyLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gcHVyY2hhc2UodWludDI1NiBfdG9rZW5JZCwgdWludDI1NiBsYXllcklkKSBwdWJsaWMgcGF5YWJsZSBpc1VubG9ja2VkIHsKICAgICAgICBpZiAoIV9ibGFja0xpc3RlZChtc2cuc2VuZGVyKSkgewogICAgICAgICAgICBhZGRyZXNzIGxheWVyQWRkciA9IGdldExheWVyRnJvbUlkW2xheWVySWRdOwogICAgICAgICAgICBUb2tlbkxheWVyIGxheWVyID0gVG9rZW5MYXllcihsYXllckFkZHIpOwoKICAgICAgICAgICAgYWRkcmVzcyBfb3duZXIgPSBsYXllci5vd25lck9mKF90b2tlbklkKTsKICAgICAgICAgICAgdWludDI1NiBwcmljZSA9IGxheWVyLmdldFByaWNlT2YoX3Rva2VuSWQpOwoKICAgICAgICAgICAgdWludDI1NiBleGNlc3MgPSBtc2cudmFsdWUuc3ViKHByaWNlKTsKICAgICAgICAgICAgcmVxdWlyZShfb3duZXIgIT0gbXNnLnNlbmRlcik7CgogICAgICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSBwcmljZSk7CgogICAgICAgICAgICByZXF1aXJlKCFibG9ja0xvY2tBY3RpdmUgfHwgIWxheWVyLmJsb2NrZWQoX3Rva2VuSWQpKTsKCiAgICAgICAgICAgIGxheWVyLmluY3JlbWVudFByaWNlKF90b2tlbklkLCBtc2cuc2VuZGVyKTsKICAgICAgICAgICAgbGF5ZXIudHJhbnNmZXIobXNnLnNlbmRlciwgX293bmVyLCBfdG9rZW5JZCk7CgogICAgICAgICAgICB1aW50MjU2IHBheW1lbnQgPSBfdXBkYXRlUGF5bWVudChfdG9rZW5JZCwgbGF5ZXJBZGRyLCBwcmljZSk7CgogICAgICAgICAgICBpZiAoX293bmVyICE9IGFkZHJlc3ModGhpcykpIHsKICAgICAgICAgICAgICAgIF9vd25lci50cmFuc2ZlcihwYXltZW50KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX3BheUNoYWluKF90b2tlbklkLCBsYXllckFkZHIsIHByaWNlKTsKCiAgICAgICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoZXhjZXNzKTsKICAgICAgICAgICAgb3duZXIudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gYWRkTGF5ZXIoYWRkcmVzcyBfbGF5ZXJBZGRyLCB1aW50MjU2IGxheWVySWQsIGJ5dGVzMzIgX25hbWUpIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIHJlcXVpcmUoIV9hZGRyZXNzTm90TnVsbChnZXRMYXllckZyb21JZFtsYXllcklkXSkpOwogICAgICAgIGdldExheWVyRnJvbUlkW2xheWVySWRdID0gX2xheWVyQWRkcjsKICAgICAgICBnZXRMYXllck5hbWVGcm9tSWRbbGF5ZXJJZF0gPSBfbmFtZTsKICAgICAgICBsYXllckNvdW50Kys7CiAgICB9CgogICAgZnVuY3Rpb24gZGVsZXRlTGF5ZXIodWludDI1NiBsYXllcklkKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChnZXRMYXllckZyb21JZFtsYXllcklkXSkpOwogICAgICAgIGdldExheWVyRnJvbUlkW2xheWVySWRdID0gYWRkcmVzcygwKTsKICAgICAgICBnZXRMYXllck5hbWVGcm9tSWRbbGF5ZXJJZF0gPSAiIjsKICAgICAgICBsYXllckNvdW50LS07CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0VG9rZW4odWludDI1NiBfdG9rZW5JZCwgdWludDI1NiBsYXllcklkKSBwdWJsaWMgdmlldyByZXR1cm5zKAogICAgICAgICAgICBieXRlczMyIHRva2VuTmFtZSwgdWludDI1NiBwYXJlbnRJZCwgdWludDI1NiBwcmljZSwKICAgICAgICAgICAgYWRkcmVzcyBfb3duZXIsIHVpbnQyNTYgbmV4dFByaWNlLCB1aW50MjU2IG5leHRQcmljZUZlZXMsCiAgICAgICAgICAgIGFkZHJlc3MgYXBwcm92ZWQsIGJ5dGVzMzIgbWV0YWRhdGEKICAgICAgICApIHsKICAgICAgICBhZGRyZXNzIGxheWVyQWRkciA9IGdldExheWVyRnJvbUlkW2xheWVySWRdOwogICAgICAgIFRva2VuTGF5ZXIgbGF5ZXIgPSBUb2tlbkxheWVyKGxheWVyQWRkcik7CgogICAgICAgIHVpbnQyNTZbOF0gbWVtb3J5IHRva2VuRGF0YSA9IGxheWVyLmJ1bmRsZVRva2VuKF90b2tlbklkKTsKCiAgICAgICAgdG9rZW5OYW1lID0gYnl0ZXMzMih0b2tlbkRhdGFbMF0pOwogICAgICAgIHBhcmVudElkID0gdG9rZW5EYXRhWzFdOwogICAgICAgIHByaWNlID0gdG9rZW5EYXRhWzJdOwogICAgICAgIF9vd25lciA9IGFkZHJlc3ModG9rZW5EYXRhWzNdKTsKCiAgICAgICAgbmV4dFByaWNlID0gdG9rZW5EYXRhWzRdOwogICAgICAgIG5leHRQcmljZUZlZXMgPSB0b2tlbkRhdGFbNV07CiAgICAgICAgYXBwcm92ZWQgPSBhZGRyZXNzKHRva2VuRGF0YVs2XSk7CiAgICAgICAgbWV0YWRhdGEgPSBieXRlczMyKHRva2VuRGF0YVs3XSk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0UHJpY2VMb2NrZWQoYm9vbCBzZXR0aW5nKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICBwcmljZUxvY2tlZCA9IHNldHRpbmc7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0QmxhY2tsaXN0KGJvb2wgc2V0dGluZykgcHVibGljIG9ubHlBZG1pbiB7CiAgICAgICAgYmxhY2tMaXN0QWN0aXZlID0gc2V0dGluZzsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRCbG9ja0xvY2soYm9vbCBzZXR0aW5nKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICBibG9ja0xvY2tBY3RpdmUgPSBzZXR0aW5nOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZFRvQmxhY2tsaXN0KGFkZHJlc3MgX3RvKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICBibGFja2xpc3RlZFtfdG9dID0gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiByZW1vdmVGcm9tQmxhY2tsaXN0KGFkZHJlc3MgX3RvKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICBibGFja2xpc3RlZFtfdG9dID0gZmFsc2U7CiAgICB9Ci8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIFBSSVZBVEUgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCiAgICBmdW5jdGlvbiBfcGF5Q2hhaW4odWludDI1NiBfdG9rZW5JZCwgYWRkcmVzcyBsYXllckFkZHIsIHVpbnQyNTYgX3ByaWNlKSBwdWJsaWMKICAgIHsKICAgICAgICBUb2tlbkxheWVyIG1haW5MYXllciA9IFRva2VuTGF5ZXIobGF5ZXJBZGRyKTsKCiAgICAgICAgdWludDI1NlsxMF0gbWVtb3J5IF9jaGFpbkZlZXMgPSBtYWluTGF5ZXIuZ2V0Q2hhaW5GZWVBcnJheSgpOwogICAgICAgIGFkZHJlc3NbMTBdIG1lbW9yeSBfb3duZXJzID0gbWFpbkxheWVyLmdldENoYWluKF90b2tlbklkKTsKCiAgICAgICAgZm9yICh1aW50MjU2IGkgPSAwOyBpIDwgMTA7IGkrKykgewogICAgICAgICAgICBpZiAoX2FkZHJlc3NOb3ROdWxsKF9vd25lcnNbaV0pKSB7CiAgICAgICAgICAgICAgICBfb3duZXJzW2ldLnRyYW5zZmVyKF9wcmljZS5tdWwoX2NoYWluRmVlc1tpXSkuZGl2KDEwMDApKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBfdXBkYXRlUGF5bWVudCh1aW50MjU2IF90b2tlbklkLCBhZGRyZXNzIGxheWVyQWRkciwgdWludCBfcHJpY2UpIHByaXZhdGUgdmlldyByZXR1cm5zKHVpbnQyNTYgX3BheW1lbnQpIHsKICAgICAgICBUb2tlbkxheWVyIGxheWVyID0gVG9rZW5MYXllcihsYXllckFkZHIpOwoKICAgICAgICB1aW50MjU2IGRldkZlZSA9IGxheWVyLmRldkZlZSgpOwogICAgICAgIHVpbnQyNTYgdG90YWxGZWUgPSBsYXllci5nZXRDaGFpbkZlZXMoX3Rva2VuSWQpOwoKICAgICAgICB1aW50MjU2IHBheW1lbnQgPSBfcHJpY2UubXVsKDEwMDAtKGRldkZlZSt0b3RhbEZlZSkpLmRpdigxMDAwKTsKCiAgICAgICAgcmV0dXJuKHBheW1lbnQpOwogICAgfQoKICAgIGZ1bmN0aW9uIF9hZGRyZXNzTm90TnVsbChhZGRyZXNzIF90bykgcHJpdmF0ZSBwdXJlIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gX3RvICE9IGFkZHJlc3MoMCk7CiAgICB9CgogICAgZnVuY3Rpb24gX2JsYWNrTGlzdGVkKGFkZHJlc3MgX3BheWVyKSBwcml2YXRlIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiAoYmxhY2tsaXN0ZWRbX3BheWVyXSkgJiYgKGJsYWNrTGlzdEFjdGl2ZSk7CiAgICB9Cn0='.
	

]
