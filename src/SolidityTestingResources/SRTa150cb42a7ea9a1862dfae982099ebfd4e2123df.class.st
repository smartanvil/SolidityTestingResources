Class {
	#name : #SRTa150cb42a7ea9a1862dfae982099ebfd4e2123df,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTa150cb42a7ea9a1862dfae982099ebfd4e2123df >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuOTsKCmNvbnRyYWN0IHRva2VuUmVjaXBpZW50IHsgZnVuY3Rpb24gcmVjZWl2ZUFwcHJvdmFsKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlLCBhZGRyZXNzIF90b2tlbiwgYnl0ZXMgX2V4dHJhRGF0YSk7IH0KCmNvbnRyYWN0IFJvdW5kVG9rZW4gewoKICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiUk9VTkQiOwogIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIlJPVU5EIjsKICB1aW50OCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHZlcnNpb24gPSAnMC4xJzsKICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCB0b3RhbFN1cHBseSA9IDEwMDAwMDAwMDAgKiAxMDAwMDAwMDAwMDAwMDAwMDAwOwoKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7CiAgZXZlbnQgTmV3T3duZXIoYWRkcmVzcyBfbmV3T3duZXIpOwoKICBtb2RpZmllciBjaGVja0lmVG9Db250cmFjdChhZGRyZXNzIF90bykgewogICAgaWYoX3RvICE9IGFkZHJlc3ModGhpcykpICB7CiAgICAgIF87CiAgICB9CiAgfQoKICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCiAgZnVuY3Rpb24gUm91bmRUb2tlbigpIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIGJhbGFuY2VzW293bmVyXSA9IHRvdGFsU3VwcGx5OwogIH0KCiAgZnVuY3Rpb24gcmVwbGFjZU93bmVyKGFkZHJlc3MgX25ld093bmVyKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIGlmIChtc2cuc2VuZGVyICE9IG93bmVyKSB0aHJvdzsKICAgIG93bmVyID0gX25ld093bmVyOwogICAgTmV3T3duZXIoX25ld093bmVyKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBjaGVja0lmVG9Db250cmFjdChfdG8pIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgaWYgKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7CiAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdIC09IF92YWx1ZTsKICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7CiAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQoKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBjaGVja0lmVG9Db250cmFjdChfdG8pIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgaWYgKGJhbGFuY2VzW19mcm9tXSA+PSBfdmFsdWUgJiYgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIF92YWx1ZSA+IDApIHsKICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7CiAgICAgIGJhbGFuY2VzW19mcm9tXSAtPSBfdmFsdWU7CiAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdIC09IF92YWx1ZTsKICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGFwcHJvdmVBbmRDYWxsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZXh0cmFEYXRhKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHRva2VuUmVjaXBpZW50IHNwZW5kZXIgPSB0b2tlblJlY2lwaWVudChfc3BlbmRlcik7CiAgICBpZiAoYXBwcm92ZShfc3BlbmRlciwgX3ZhbHVlKSkgewogICAgICBzcGVuZGVyLnJlY2VpdmVBcHByb3ZhbChtc2cuc2VuZGVyLCBfdmFsdWUsIHRoaXMsIF9leHRyYURhdGEpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KfQoKCmNvbnRyYWN0IE93bmVkIHsKICBhZGRyZXNzIHB1YmxpYyBjb250cmFjdE93bmVyOwogIGFkZHJlc3MgcHVibGljIHBlbmRpbmdDb250cmFjdE93bmVyOwoKICBmdW5jdGlvbiBPd25lZCgpIHsKICAgIGNvbnRyYWN0T3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCiAgbW9kaWZpZXIgb25seUNvbnRyYWN0T3duZXIoKSB7CiAgICBpZiAoY29udHJhY3RPd25lciA9PSBtc2cuc2VuZGVyKSBfOwogIH0KCiAgZnVuY3Rpb24gY2hhbmdlQ29udHJhY3RPd25lcnNoaXAoYWRkcmVzcyBfdG8pIG9ubHlDb250cmFjdE93bmVyKCkgcmV0dXJucyhib29sKSB7CiAgICBwZW5kaW5nQ29udHJhY3RPd25lciA9IF90bzsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gY2xhaW1Db250cmFjdE93bmVyc2hpcCgpIHJldHVybnMoYm9vbCkgewogICAgaWYgKHBlbmRpbmdDb250cmFjdE93bmVyICE9IG1zZy5zZW5kZXIpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGNvbnRyYWN0T3duZXIgPSBwZW5kaW5nQ29udHJhY3RPd25lcjsKICAgIGRlbGV0ZSBwZW5kaW5nQ29udHJhY3RPd25lcjsKICAgIHJldHVybiB0cnVlOwogIH0KfQoKY29udHJhY3QgQmlkR2FtZSBpcyBPd25lZCB7CgogIHVpbnQgY29tbWlzc2lvblBlcmNlbnQ7CiAgdWludCByZWZ1bmRQZW5hbHR5OwogIGFkZHJlc3MgZ2FtZU9yYWNsZUFkZHJlc3M7CiAgYWRkcmVzcyBjb250cmFjdFJvdW5kVG9rZW5BZGRyZXNzOwoKICBzdHJ1Y3QgR2FtZSB7CiAgICB1aW50IGdhbWVJZDsKICAgIHVpbnQgc3RhdGU7IC8vMCAtIG5ldywgMSAtIHN0YXJ0ZWQsIDJYWC0gZ2FtZSBjb21wbGV0ZWQ7CiAgICBzdHJpbmcgd2lubmVyVXNlck5hbWU7CiAgICB1aW50IHdpbm5lclVzZXJJZDsKICAgIHVpbnQgdG90YWxHYW1lQmlkOwoJdWludCBiaWRBbXQ7CiAgICBCaWRbXSBiaWRzOwogIH0KCiAgc3RydWN0IEJpZCB7CiAgICBhZGRyZXNzIGJpZGRlckFkZHJlc3M7CiAgICB1aW50IGJpZDsKICAgIHVpbnQgdXNlcklkOwogICAgc3RyaW5nIHVzZXJOYW1lOwogICAgYm9vbCByZWZ1bmRlZDsKICB9CgogIG1hcHBpbmcodWludCA9PiBHYW1lKSBnYW1lczsKCiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgLy8gbW9kaWZpZXJzCiAgbW9kaWZpZXIgb25seUdhbWVPcmFjbGUoKSB7CiAgICBpZiAoZ2FtZU9yYWNsZUFkZHJlc3MgPT0gbXNnLnNlbmRlcikgXzsKICB9CgogIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogIC8vIGV2ZW50cwogIGV2ZW50IExvZ1NlbmRlcjIoYWRkcmVzcyBsb2csIGFkZHJlc3MgY29udHJhY3RSb3VuZFRva2VuKTsKICBldmVudCBHYW1lQmlkQWNjZXB0ZWQoYWRkcmVzcyBiaWRkZXIsIHVpbnQgYW1vdW50LCB1aW50IGdhbWVJZCwgdWludCB1c2VySWQsIGJ5dGVzIHVzZXJOYW1lLCBib29sIHN0YXRlKTsKICBldmVudCBHYW1lU3RhcnRlZCh1aW50IGdhbWVJZCk7CiAgZXZlbnQgR2FtZUZpbmlzaGVkKHVpbnQgZ2FtZUlkLCB1aW50IHdpbm5lclVzZXJJZCwgc3RyaW5nIHdpbm5lclVzZXJOYW1lLCB1aW50IHdpbm5lcnNQYXltZW50LCBhZGRyZXNzIHdpbm5lckFkZHJlc3MpOwogIGV2ZW50IEdhbWVSZWZ1bmRlZCh1aW50IGdhbWVJZCwgdWludCByZWZ1bmRVc2VySWQsIHVpbnQgcmVmdW5kUGF5bWVudCk7CgogIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogIC8vIGluaXQgc2V0dGluZ3MKICBmdW5jdGlvbiBzZXRQYXJhbXModWludCBfY29tbWlzc2lvblBlcmNlbnQsIHVpbnQgX3JlZnVuZFBlbmFsdHksIGFkZHJlc3MgX2dhbWVPcmFjbGVBZGRyZXNzLCBhZGRyZXNzIF9jb250cmFjdFJvdW5kVG9rZW5BZGRyZXNzKSBvbmx5Q29udHJhY3RPd25lcigpIHsKICAgIGNvbW1pc3Npb25QZXJjZW50ID0gX2NvbW1pc3Npb25QZXJjZW50OwogICAgcmVmdW5kUGVuYWx0eSA9IF9yZWZ1bmRQZW5hbHR5OwogICAgZ2FtZU9yYWNsZUFkZHJlc3MgPSBfZ2FtZU9yYWNsZUFkZHJlc3M7CiAgICBjb250cmFjdFJvdW5kVG9rZW5BZGRyZXNzID0gX2NvbnRyYWN0Um91bmRUb2tlbkFkZHJlc3M7CiAgICBMb2dTZW5kZXIyKG1zZy5zZW5kZXIsIGNvbnRyYWN0Um91bmRUb2tlbkFkZHJlc3MpOwogIH0KCiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgLy8gY29udGFjdCBhY3Rpb25zCiAgZnVuY3Rpb24gcmVjZWl2ZUFwcHJvdmFsKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlLCBhZGRyZXNzIF90b2tlbiwgYnl0ZXMgX2V4dHJhRGF0YSkgewogICAgdWludCBpID0gYnl0ZXNUb1VpbnQyKGJ5dGVzKF9leHRyYURhdGEpKTsKICAgIHVpbnQgX2dhbWVJZCA9IGkvMTAwMDA7CiAgICB1aW50IF91c2VySWQgPSBpIC0gX2dhbWVJZCoxMDAwMDsKCgkvL2NoZWNrIGdhbWUgYmlkIGFtb3VudCBhbmQgZm9yY2UgYmlkZGluZyB0aGUgc2FtZSBhbW91bnQgb2YgUk9VTkRzCglpZiAoZ2FtZXNbX2dhbWVJZF0uZ2FtZUlkID4gMCl7CgkJdWludCBhbW91bnRUb0JpZCA9IGdhbWVzW19nYW1lSWRdLmJpZEFtdDsKCQlmb3IgKHVpbnQgayA9IDA7IGsgPCBnYW1lc1tfZ2FtZUlkXS5iaWRzLmxlbmd0aDsgaysrKSB7CgkJCWlmKCFnYW1lc1tfZ2FtZUlkXS5iaWRzW2tdLnJlZnVuZGVkICYmIF91c2VySWQ9PWdhbWVzW19nYW1lSWRdLmJpZHNba10udXNlcklkKSB7CgkJCQlhbW91bnRUb0JpZC09Z2FtZXNbX2dhbWVJZF0uYmlkc1trXS5iaWQ7CgkJCX0JCgkJfQoJCWlmKGFtb3VudFRvQmlkPjApCgkJCV92YWx1ZSA9IGFtb3VudFRvQmlkOwoJCWVsc2UKCQkJdGhyb3c7CiAgICB9CgkKICAgIFJvdW5kVG9rZW4gdG9rZW4gPSBSb3VuZFRva2VuKGNvbnRyYWN0Um91bmRUb2tlbkFkZHJlc3MpOwogICAgYm9vbCBzdGF0ZSA9IHRva2VuLnRyYW5zZmVyRnJvbShfZnJvbSwgZ2FtZU9yYWNsZUFkZHJlc3MsIF92YWx1ZSk7CgogICAgaWYgKCFzdGF0ZSkgdGhyb3c7CgoJaWYgKGdhbWVzW19nYW1lSWRdLmdhbWVJZCA9PSAwKXsKCQlnYW1lc1tfZ2FtZUlkXS5iaWRBbXQgPSBfdmFsdWU7CgkJZ2FtZXNbX2dhbWVJZF0uZ2FtZUlkID0gX2dhbWVJZDsKCX0KCiAgICBnYW1lc1tfZ2FtZUlkXS50b3RhbEdhbWVCaWQgKz0gX3ZhbHVlOwogICAgZ2FtZXNbX2dhbWVJZF0uYmlkcy5wdXNoKEJpZChfZnJvbSwgX3ZhbHVlLCBfdXNlcklkLCAnJywgZmFsc2UpKTsKCiAgICBHYW1lQmlkQWNjZXB0ZWQoX2Zyb20sIF92YWx1ZSwgX2dhbWVJZCwgX3VzZXJJZCwgJycsIHN0YXRlKTsKICB9CgogIGZ1bmN0aW9uIGdhbWVSZXN1bHQodWludCBfZ2FtZUlkLCB1aW50IF91c2VySWQpIG9ubHlHYW1lT3JhY2xlKCkgewogICAgaWYgKGdhbWVzW19nYW1lSWRdLmdhbWVJZCA9PSAwKSB0aHJvdzsKICAgIGlmIChnYW1lc1tfZ2FtZUlkXS53aW5uZXJVc2VySWQgIT0gMCkgdGhyb3c7CiAgICBpZiAoZ2FtZXNbX2dhbWVJZF0udG90YWxHYW1lQmlkID09IDApIHRocm93OwoKICAgIGFkZHJlc3Mgd2lubmVyQWRkcmVzczsKICAgIHVpbnQgY29tbWlzc2lvbiA9IGdhbWVzW19nYW1lSWRdLnRvdGFsR2FtZUJpZCpjb21taXNzaW9uUGVyY2VudC8xMDA7CiAgICAvLyBpZiAoY29tbWlzc2lvbiA8IDEpIGNvbW1pc3Npb24gPSAxOwogICAgdWludCB3aW5uZXJBbW91bnQgPSBnYW1lc1tfZ2FtZUlkXS50b3RhbEdhbWVCaWQgLSBjb21taXNzaW9uOwoKICAgIGZvciAodWludCBpID0gMDsgaSA8IGdhbWVzW19nYW1lSWRdLmJpZHMubGVuZ3RoOyBpKyspIHsKICAgICAgaWYoIWdhbWVzW19nYW1lSWRdLmJpZHNbaV0ucmVmdW5kZWQgJiYgX3VzZXJJZD09Z2FtZXNbX2dhbWVJZF0uYmlkc1tpXS51c2VySWQpIHsKICAgICAgICB3aW5uZXJBZGRyZXNzID0gZ2FtZXNbX2dhbWVJZF0uYmlkc1tpXS5iaWRkZXJBZGRyZXNzOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgaWYgKHdpbm5lckFkZHJlc3MgPT0gMCkgdGhyb3c7CgogICAgUm91bmRUb2tlbiB0b2tlbiA9IFJvdW5kVG9rZW4oY29udHJhY3RSb3VuZFRva2VuQWRkcmVzcyk7CiAgICBib29sIHN0YXRlID0gdG9rZW4udHJhbnNmZXJGcm9tKGdhbWVPcmFjbGVBZGRyZXNzLCB3aW5uZXJBZGRyZXNzLCB3aW5uZXJBbW91bnQpOwoKICAgIGlmICghc3RhdGUpIHRocm93OwoKICAgIGdhbWVzW19nYW1lSWRdLndpbm5lclVzZXJJZCA9IF91c2VySWQ7CiAgICBnYW1lc1tfZ2FtZUlkXS5zdGF0ZSA9IDIwMDsKCiAgICBHYW1lRmluaXNoZWQoX2dhbWVJZCwgX3VzZXJJZCwgJycsIHdpbm5lckFtb3VudCwgd2lubmVyQWRkcmVzcyk7CiAgfQoKICBmdW5jdGlvbiBnYW1lU3RhcnQodWludCBfZ2FtZUlkKSBvbmx5R2FtZU9yYWNsZSgpIHsKICAgIGlmIChnYW1lc1tfZ2FtZUlkXS5nYW1lSWQgPT0gMCkgdGhyb3c7CiAgICBpZiAoZ2FtZXNbX2dhbWVJZF0uc3RhdGUgIT0gMCkgdGhyb3c7CiAgICBnYW1lc1tfZ2FtZUlkXS5zdGF0ZSA9IDE7CiAgICBHYW1lU3RhcnRlZChfZ2FtZUlkKTsKICB9CgogIGZ1bmN0aW9uIGdhbWVSZWZ1bmQodWludCBfZ2FtZUlkKSBvbmx5R2FtZU9yYWNsZSgpIHsKICAgIGlmIChnYW1lc1tfZ2FtZUlkXS5nYW1lSWQgPT0gMCkgdGhyb3c7CiAgICBpZiAoZ2FtZXNbX2dhbWVJZF0ud2lubmVyVXNlcklkICE9IDApIHRocm93OwogICAgaWYgKGdhbWVzW19nYW1lSWRdLnRvdGFsR2FtZUJpZCA9PSAwKSB0aHJvdzsKCiAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBnYW1lc1tfZ2FtZUlkXS5iaWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGlmKCFnYW1lc1tfZ2FtZUlkXS5iaWRzW2ldLnJlZnVuZGVkKSB7CiAgICAgICAgdWludCBwZW5hbHR5ID0gZ2FtZXNbX2dhbWVJZF0uYmlkc1tpXS5iaWQqcmVmdW5kUGVuYWx0eS8xMDA7CiAgICAgICAgLy8gaWYgKHBlbmFsdHkgPCAxKSBwZW5hbHR5ID0gMTsKICAgICAgICB1aW50IHJlZnVuZEFtb3VudCA9IGdhbWVzW19nYW1lSWRdLmJpZHNbaV0uYmlkIC0gcGVuYWx0eTsKCiAgICAgICAgUm91bmRUb2tlbiB0b2tlbiA9IFJvdW5kVG9rZW4oY29udHJhY3RSb3VuZFRva2VuQWRkcmVzcyk7CiAgICAgICAgYm9vbCBzdGF0ZSA9IHRva2VuLnRyYW5zZmVyRnJvbShnYW1lT3JhY2xlQWRkcmVzcywgZ2FtZXNbX2dhbWVJZF0uYmlkc1tpXS5iaWRkZXJBZGRyZXNzLCByZWZ1bmRBbW91bnQpOwoKICAgICAgICBpZiAoIXN0YXRlKSB0aHJvdzsKCiAgICAgICAgZ2FtZXNbX2dhbWVJZF0uYmlkc1tpXS5yZWZ1bmRlZCA9IHRydWU7CiAgICAgICAgZ2FtZXNbX2dhbWVJZF0udG90YWxHYW1lQmlkIC09IGdhbWVzW19nYW1lSWRdLmJpZHNbaV0uYmlkOwogICAgICAgIEdhbWVSZWZ1bmRlZChfZ2FtZUlkLCBnYW1lc1tfZ2FtZUlkXS5iaWRzW2ldLnVzZXJJZCwgcmVmdW5kQW1vdW50KTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gYmlkUmVmdW5kKHVpbnQgX2dhbWVJZCwgdWludCBfdXNlcklkKSBvbmx5R2FtZU9yYWNsZSgpIHsKICAgIGlmIChnYW1lc1tfZ2FtZUlkXS5nYW1lSWQgPT0gMCkgdGhyb3c7CiAgICBpZiAoZ2FtZXNbX2dhbWVJZF0ud2lubmVyVXNlcklkICE9IDApIHRocm93OwogICAgaWYgKGdhbWVzW19nYW1lSWRdLnRvdGFsR2FtZUJpZCA9PSAwKSB0aHJvdzsKICAgIGZvciAodWludCBpID0gMDsgaSA8IGdhbWVzW19nYW1lSWRdLmJpZHMubGVuZ3RoOyBpKyspIHsKICAgICAgaWYoIWdhbWVzW19nYW1lSWRdLmJpZHNbaV0ucmVmdW5kZWQpIHsKICAgICAgICBpZiAoZ2FtZXNbX2dhbWVJZF0uYmlkc1tpXS51c2VySWQgPT0gX3VzZXJJZCkgewogICAgICAgICAgdWludCBwZW5hbHR5ID0gZ2FtZXNbX2dhbWVJZF0uYmlkc1tpXS5iaWQqcmVmdW5kUGVuYWx0eS8xMDA7CiAgICAgICAgICAvLyBpZiAocGVuYWx0eSA8IDEpIHBlbmFsdHkgPSAxOwogICAgICAgICAgdWludCByZWZ1bmRBbW91bnQgPSBnYW1lc1tfZ2FtZUlkXS5iaWRzW2ldLmJpZCAtIHBlbmFsdHk7CgogICAgICAgICAgUm91bmRUb2tlbiB0b2tlbiA9IFJvdW5kVG9rZW4oY29udHJhY3RSb3VuZFRva2VuQWRkcmVzcyk7CiAgICAgICAgICBib29sIHN0YXRlID0gdG9rZW4udHJhbnNmZXJGcm9tKGdhbWVPcmFjbGVBZGRyZXNzLCBnYW1lc1tfZ2FtZUlkXS5iaWRzW2ldLmJpZGRlckFkZHJlc3MsIHJlZnVuZEFtb3VudCk7CgogICAgICAgICAgaWYgKCFzdGF0ZSkgdGhyb3c7CgogICAgICAgICAgZ2FtZXNbX2dhbWVJZF0uYmlkc1tpXS5yZWZ1bmRlZCA9IHRydWU7CiAgICAgICAgICBnYW1lc1tfZ2FtZUlkXS50b3RhbEdhbWVCaWQgLT0gZ2FtZXNbX2dhbWVJZF0uYmlkc1tpXS5iaWQ7CiAgICAgICAgICBHYW1lUmVmdW5kZWQoX2dhbWVJZCwgZ2FtZXNbX2dhbWVJZF0uYmlkc1tpXS51c2VySWQsIHJlZnVuZEFtb3VudCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAvLyBHZXQgc2V0dGluZ3MKICBmdW5jdGlvbiBnZXRTZXR0aW5ncygpIGNvbnN0YW50IHJldHVybnModWludCBjb21taXNzaW9uLCB1aW50IHBlbmFsdHkpIHsKICAgIHJldHVybiAoCiAgICAgIGNvbW1pc3Npb25QZXJjZW50LAogICAgICByZWZ1bmRQZW5hbHR5CiAgICApOwogIH0KCiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgLy8gR2V0IGdhbWUgaW5mbwogIGZ1bmN0aW9uIGdldEdhbWUodWludCBfZ2FtZUlkKSBjb25zdGFudCByZXR1cm5zKHVpbnQgZ2FtZUlkLCB1aW50IHN0YXRlLCB1aW50IHdpbm5lclVzZXJJZCwgdWludCB0b3RhbEdhbWVCaWQsIHVpbnQgYmlkQW10LCB1aW50IGJpZHNBbW91bnQpIHsKICAgIHZhciBnYW1lID0gZ2FtZXNbX2dhbWVJZF07CiAgICByZXR1cm4gKAogICAgICBnYW1lLmdhbWVJZCwKICAgICAgZ2FtZS5zdGF0ZSwKICAgICAgZ2FtZS53aW5uZXJVc2VySWQsCiAgICAgIGdhbWUudG90YWxHYW1lQmlkLAoJICBnYW1lLmJpZEFtdCwKICAgICAgZ2FtZS5iaWRzLmxlbmd0aAogICAgKTsKICB9CgogIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogIC8vIEdldCBiaWQgaW5mbwogIGZ1bmN0aW9uIGdldEdhbWVCaWQodWludCBfZ2FtZUlkLCB1aW50IF9iaWRJZCkgY29uc3RhbnQgcmV0dXJucyhhZGRyZXNzIGJpZGRlckFkZHJlc3MsIHVpbnQgYmlkc0Ftb3VudCwgdWludCB1c2VySWQsIHN0cmluZyB1c2VyTmFtZSwgYm9vbCByZWZ1bmRlZCkgewogICAgR2FtZSBnYW1lID0gZ2FtZXNbX2dhbWVJZF07CiAgICBCaWQgYmlkPWdhbWUuYmlkc1tfYmlkSWRdOwogICAgcmV0dXJuICgKICAgICAgYmlkLmJpZGRlckFkZHJlc3MsCiAgICAgIGJpZC5iaWQsCiAgICAgIGJpZC51c2VySWQsCiAgICAgIGJpZC51c2VyTmFtZSwKICAgICAgYmlkLnJlZnVuZGVkCiAgICApOwogIH0KCiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgLy8gR2V0IGJhbGFuY2Ugb2YgYWRkcmVzcwogIGZ1bmN0aW9uIGdldEJhbGFuY2UoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgUm91bmRUb2tlbiB0b2tlbiA9IFJvdW5kVG9rZW4oY29udHJhY3RSb3VuZFRva2VuQWRkcmVzcyk7CiAgICByZXR1cm4gdG9rZW4uYmFsYW5jZU9mKF9vd25lcik7CiAgfQoKICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAvLyBraWxsIGNvbnRyYWN0CiAgZnVuY3Rpb24ga2lsbCgpIG9ubHlDb250cmFjdE93bmVyKCkgewogICBpZiAobXNnLnNlbmRlciA9PSBjb250cmFjdE93bmVyKXsKICAgICAgc3VpY2lkZShjb250cmFjdE93bmVyKTsKICAgIH0KICB9CgogIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogIC8vIHV0aWxzCiAgZnVuY3Rpb24gYnl0ZXNUb1VpbnQyKGJ5dGVzIGIpIHJldHVybnMgKHVpbnQpIHsKICAgIHVpbnQgcmVzdWx0ID0gMDsKICAgIGZvciAodWludCBpPTE7IGkgPCBiLmxlbmd0aDsgaSsrKSB7CiAgICAgIHVpbnQgeCA9IHVpbnQodWludChiW2ldKSk7CiAgICAgIGlmICh4ID4gMCkKICAgICAgICB4ID0geCAtIDQ4OwogICAgICByZXN1bHQgPSByZXN1bHQgKyB4KigxMCoqKGIubGVuZ3RoLWktMSkpOwogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKICB9Cgp9'.
	

]
