Class {
	#name : #SRT74951B677de32D596EE851A233336926e6A2cd09,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT74951B677de32D596EE851A233336926e6A2cd09 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgoKLyoqCiAqIEB0aXRsZSBXZUJldENyeXB0bwogKiBAYXV0aG9yIEFMX1gKICogQGRldiBUaGUgV0JDIEVSQy0yMjMgVG9rZW4gQ29udHJhY3QKICovCmNvbnRyYWN0IFdlQmV0Q3J5cHRvIHsKICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICJXZSBCZXQgQ3J5cHRvIjsKICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIldCQSI7CgkKICAgIGFkZHJlc3MgcHVibGljIHNlbGZBZGRyZXNzOwogICAgYWRkcmVzcyBwdWJsaWMgYWRtaW47CiAgICBhZGRyZXNzW10gcHJpdmF0ZSB1c2VyczsKCQogICAgdWludDggcHVibGljIGRlY2ltYWxzID0gNzsKICAgIHVpbnQyNTYgcHVibGljIHJlbGF0aXZlRGF0ZVNhdmU7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbEZ1bmRzOwogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHkgPSA0MDAwMDAwMDAwMDAwMDA7CiAgICB1aW50MjU2IHB1YmxpYyBJT1VTdXBwbHkgPSAwOwogICAgdWludDI1NiBwcml2YXRlIGFtb3VudEluQ2lyY3VsYXRpb247CiAgICB1aW50MjU2IHByaXZhdGUgY3VycmVudFByb2ZpdHM7CiAgICB1aW50MjU2IHByaXZhdGUgY3VycmVudEl0ZXJhdGlvbjsKCXVpbnQyNTYgcHJpdmF0ZSBhY3R1YWxQcm9maXRTcGxpdDsKCQogICAgYm9vbCBwdWJsaWMgaXNGcm96ZW47CiAgICBib29sIHByaXZhdGUgcnVubmluZzsKCQogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIG1vbmV5U3BlbnQ7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgbW9udGhseUxpbWl0OwoJbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGNvb2xkb3duOwoJCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgaXNBZGRlZDsKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBjbGFpbWVkQm9udXM7CgltYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgYmFubmVkVXNlcjsKICAgIC8vbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIGxvZ2dlZFVzZXI7CgkKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCQogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKICAgIAoJLyoqCgkgKiBAbm90aWNlIEVuc3VyZXMgYWRtaW4gaXMgY2FsbGVyCgkgKi8KICAgIG1vZGlmaWVyIGlzQWRtaW4oKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkbWluKTsKICAgICAgICAvL0NvbnRpbnVlIGV4ZWN1dGluZyByZXN0IG9mIG1ldGhvZCBib2R5CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgLyoqCgkgKiBAbm90aWNlIFJlLWVudHJ5IHByb3RlY3Rpb24KCSAqLwogICAgbW9kaWZpZXIgaXNSdW5uaW5nKCkgewogICAgICAgIHJlcXVpcmUoIXJ1bm5pbmcpOwogICAgICAgIHJ1bm5pbmcgPSB0cnVlOwogICAgICAgIF87CiAgICAgICAgcnVubmluZyA9IGZhbHNlOwogICAgfQogICAgCgkvKioKCSAqIEBub3RpY2UgRW5zdXJlcyBzeXN0ZW0gaXNuJ3QgZnJvemVuCgkgKi8KICAgIG1vZGlmaWVyIG5vRnJlZXplKCkgewogICAgICAgIHJlcXVpcmUoIWlzRnJvemVuKTsKICAgICAgICBfOwogICAgfQogICAgCgkvKioKCSAqIEBub3RpY2UgRW5zdXJlcyBwbGF5ZXIgaXNuJ3QgbG9nZ2VkIGluIG9uIHBsYXRmb3JtCgkgKi8KICAgIG1vZGlmaWVyIHVzZXJOb3RQbGF5aW5nKGFkZHJlc3MgX3VzZXIpIHsKICAgICAgICAvL3JlcXVpcmUoIWxvZ2dlZFVzZXJbX3VzZXJdKTsKICAgICAgICB1aW50MjU2IGNoZWNrID0gMDsKICAgICAgICBjaGVjayAtPSAxOwogICAgICAgIHJlcXVpcmUoY29vbGRvd25bX3VzZXJdID09IGNoZWNrKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEBub3RpY2UgRW5zdXJlcyBwbGF5ZXIgaXNuJ3QgYmFubmVkVXNlcgogICAgICovCiAgICBtb2RpZmllciB1c2VyTm90QmFubmVkKGFkZHJlc3MgX3VzZXIpIHsKICAgICAgICByZXF1aXJlKCFiYW5uZWRVc2VyW191c2VyXSk7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgLyoqCgkgKiBAbm90aWNlIFNhZmVNYXRoIExpYnJhcnkgc2FmZVN1YiBJbXBvcnQKCSAqIEBkZXYgCgkgICAgICAgIFNpbmNlIHdlIGFyZSBkZWFsaW5nIHdpdGggYSBsaW1pdGVkIGN1cnJlbmN5CgkgICAgICAgIGNpcmN1bGF0aW9uIG9mIDQwIG1pbGxpb24gdG9rZW5zIGFuZCB2YWx1ZXMKCSAgICAgICAgdGhhdCB3aWxsIG5vdCBzdXJwYXNzIHRoZSB1aW50MjU2IGxpbWl0LCBvbmx5CgkgICAgICAgIHNhZmVTdWIgaXMgcmVxdWlyZWQgdG8gcHJldmVudCB1bmRlcmZsb3dzLgoJICovCiAgICBmdW5jdGlvbiBzYWZlU3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYgeikgewogICAgICAgIGFzc2VydCgoeiA9IGEgLSBiKSA8PSBhKTsKICAgIH0KCQoJLyoqCgkgKiBAbm90aWNlIFdCQyBDb25zdHJ1Y3RvcgoJICogQGRldiAKCSAgICAgICAgQ29uc3RydWN0b3IgZnVuY3Rpb24gY29udGFpbmluZyBwcm9wZXIgaW5pdGlhbGl6YXRpb25zIHN1Y2ggYXMgCgkgICAgICAgIHRva2VuIGRpc3RyaWJ1dGlvbiB0byB0aGUgdGVhbSBtZW1iZXJzIGFuZCBwdXNoaW5nIHRoZSBmaXJzdCAKCSAgICAgICAgcHJvZml0IHNwbGl0IHRvIDYgbW9udGhzIHdoZW4gdGhlIERBcHAgd2lsbCBhbHJlYWR5IGJlIGxpdmUuCgkgKi8KICAgIGZ1bmN0aW9uIFdlQmV0Q3J5cHRvKCkgcHVibGljIHsKICAgICAgICBhZG1pbiA9IG1zZy5zZW5kZXI7CiAgICAgICAgc2VsZkFkZHJlc3MgPSB0aGlzOwogICAgICAgIGJhbGFuY2VzWzB4NjZBRTA3MEE4NTAxRTgxNkNBOTVhYzk5YzRFMTVDN2UxMzJmZDI4OV0gPSAyMDAwMDAwMDAwMDAwMDA7CiAgICAgICAgYWRkVXNlcigweDY2QUUwNzBBODUwMUU4MTZDQTk1YWM5OWM0RTE1QzdlMTMyZmQyODkpOwogICAgICAgIFRyYW5zZmVyKHNlbGZBZGRyZXNzLCAweDY2QUUwNzBBODUwMUU4MTZDQTk1YWM5OWM0RTE1QzdlMTMyZmQyODksIDIwMDAwMDAwMDAwMDAwMCk7CiAgICAgICAgYmFsYW5jZXNbMHhjZjhkMjQyQzUyM2JmYURDMzg0Q2MxZUZGODUyQmYyOTkzOTZCMjJEXSA9IDUwMDAwMDAwMDAwMDAwOwogICAgICAgIGFkZFVzZXIoMHhjZjhkMjQyQzUyM2JmYURDMzg0Q2MxZUZGODUyQmYyOTkzOTZCMjJEKTsKICAgICAgICBUcmFuc2ZlcihzZWxmQWRkcmVzcywgMHhjZjhkMjQyQzUyM2JmYURDMzg0Q2MxZUZGODUyQmYyOTkzOTZCMjJELCA1MDAwMDAwMDAwMDAwMCk7CiAgICAgICAgcmVsYXRpdmVEYXRlU2F2ZSA9IG5vdyArIDQwIGRheXM7CiAgICAgICAgYmFsYW5jZXNbc2VsZkFkZHJlc3NdID0gMTUwMDAwMDAwMDAwMDAwOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEBub3RpY2UgQ2hlY2sgdGhlIG5hbWUgb2YgdGhlIHRva2VuIH4gRVJDLTIwIFN0YW5kYXJkCiAgICAgKiBAcmV0dXJuIHsKCQkJCQkiX25hbWUiOiAiVGhlIHRva2VuIG5hbWUiCgkJCQl9CiAgICAgKi8KICAgIGZ1bmN0aW9uIG5hbWUoKSBleHRlcm5hbCBjb25zdGFudCByZXR1cm5zIChzdHJpbmcgX25hbWUpIHsKICAgICAgICByZXR1cm4gbmFtZTsKICAgIH0KICAgIAoJLyoqCiAgICAgKiBAbm90aWNlIENoZWNrIHRoZSBzeW1ib2wgb2YgdGhlIHRva2VuIH4gRVJDLTIwIFN0YW5kYXJkCiAgICAgKiBAcmV0dXJuIHsKCQkJCQkiX3N5bWJvbCI6ICJUaGUgdG9rZW4gc3ltYm9sIgoJCQkJfQogICAgICovCiAgICBmdW5jdGlvbiBzeW1ib2woKSBleHRlcm5hbCBjb25zdGFudCByZXR1cm5zIChzdHJpbmcgX3N5bWJvbCkgewogICAgICAgIHJldHVybiBzeW1ib2w7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogQG5vdGljZSBDaGVjayB0aGUgZGVjaW1hbHMgb2YgdGhlIHRva2VuIH4gRVJDLTIwIFN0YW5kYXJkCiAgICAgKiBAcmV0dXJuIHsKCQkJCQkiX2RlY2ltYWxzIjogIlRoZSB0b2tlbiBkZWNpbWFscyIKCQkJCX0KICAgICAqLwogICAgZnVuY3Rpb24gZGVjaW1hbHMoKSBleHRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50OCBfZGVjaW1hbHMpIHsKICAgICAgICByZXR1cm4gZGVjaW1hbHM7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogQG5vdGljZSBDaGVjayB0aGUgdG90YWwgc3VwcGx5IG9mIHRoZSB0b2tlbiB+IEVSQy0yMCBTdGFuZGFyZAogICAgICogQHJldHVybiB7CgkJCQkJIl90b3RhbFN1cHBseSI6ICJUb3RhbCBzdXBwbHkgb2YgdG9rZW5zIgoJCQkJfQogICAgICovCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgX3RvdGFsU3VwcGx5KSB7CiAgICAgICAgcmV0dXJuIHRvdGFsU3VwcGx5OwogICAgfQogICAgCiAgICAvKioKICAgICAqIEBub3RpY2UgUXVlcnkgdGhlIGF2YWlsYWJsZSBiYWxhbmNlIG9mIGFuIGFkZHJlc3MgfiBFUkMtMjAgU3RhbmRhcmQKCSAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3Mgd2hvc2UgYmFsYW5jZSB3ZSB3aXNoIHRvIHJldHJpZXZlCiAgICAgKiBAcmV0dXJuIHsKCQkJCQkiYmFsYW5jZSI6ICJCYWxhbmNlIG9mIHRoZSBhZGRyZXNzIgoJCQkJfQogICAgICovCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogICAgfQoJCgkvKioKCSAqIEBub3RpY2UgUXVlcnkgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhlIHNwZW5kZXIgYWRkcmVzcyBjYW4gd2l0aGRyYXcgZnJvbSB0aGUgb3duZXIgYWRkcmVzcyB+IEVSQy0yMCBTdGFuZGFyZAoJICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB3aG8gb3ducyB0aGUgdG9rZW5zCgkgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hvIGNhbiB3aXRoZHJhdyB0aGUgdG9rZW5zCgkgKiBAcmV0dXJuIHsKCQkJCQkicmVtYWluaW5nIjogIlJlbWFpbmluZyB3aXRoZHJhd2FsIGFtb3VudCIKCQkJCX0KICAgICAqLwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBleHRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEBub3RpY2UgUXVlcnkgd2hldGhlciB0aGUgdXNlciBpcyBlbGlnaWJsZSBmb3IgY2xhaW1pbmcgZGl2aWRlbmNlCiAgICAgKiBAcGFyYW0gX3VzZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkKICAgICAqIEByZXR1cm4gX3N1Y2Nlc3MgV2hldGhlciBvciBub3QgdGhlIHVzZXIgaXMgZWxpZ2libGUKICAgICAqLwogICAgZnVuY3Rpb24gZWxpZ2libGVGb3JEaXZpZGVuY2UoYWRkcmVzcyBfdXNlcikgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCBfc3VjY2VzcykgewogICAgICAgIGlmIChtb25leVNwZW50W191c2VyXSA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCQl9IGVsc2UgaWYgKChiYWxhbmNlc1tfdXNlcl0gKyBhbGxvd2VkW3NlbGZBZGRyZXNzXVtfdXNlcl0pL21vbmV5U3BlbnRbX3VzZXJdID4gMjApIHsKCQkgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBAbm90aWNlIFRyYW5zZmVyIHRva2VucyBmcm9tIGFuIGFkZHJlc3MgdG8gYW5vdGhlciB+IEVSQy0yMCBTdGFuZGFyZAoJICogQGRldiAKCSAgICAgICAgQWRqdXN0cyB0aGUgbW9udGhseSBsaW1pdCBpbiBjYXNlIHRoZSBfZnJvbSBhZGRyZXNzIGlzIHRoZSBDYXNpbm8KCSAgICAgICAgYW5kIGVuc3VyZXMgdGhhdCB0aGUgdXNlciBpc24ndCBsb2dnZWQgaW4gd2hlbiByZXRyaWV2aW5nIGZ1bmRzCgkgICAgICAgIHNvIGFzIHRvIHByZXZlbnQgYWdhaW5zdCBhIHJhY2UgYXR0YWNrIHdpdGggdGhlIENhc2luby4KICAgICAqIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyB3aG9zZSBiYWxhbmNlIHdlIHdpbGwgdHJhbnNmZXIKICAgICAqIEBwYXJhbSBfdG8gVGhlIHJlY2lwaWVudCBhZGRyZXNzCgkgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIGV4dGVybmFsIG5vRnJlZXplIHsKICAgICAgICB2YXIgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW190b107CiAgICAgICAgaWYgKF9mcm9tID09IHNlbGZBZGRyZXNzKSB7CiAgICAgICAgICAgIG1vbnRobHlMaW1pdFtfdG9dID0gc2FmZVN1Yihtb250aGx5TGltaXRbX3RvXSwgX3ZhbHVlKTsKICAgICAgICAgICAgcmVxdWlyZShjb29sZG93bltfdG9dIDwgbm93IC8qJiYgIWxvZ2dlZFVzZXJbX3RvXSovKTsKICAgICAgICAgICAgSU9VU3VwcGx5IC09IF92YWx1ZTsKICAgICAgICB9CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10rX3ZhbHVlOwogICAgICAgIGJhbGFuY2VzW19mcm9tXSA9IHNhZmVTdWIoYmFsYW5jZXNbX2Zyb21dLCBfdmFsdWUpOwogICAgICAgIGFsbG93ZWRbX2Zyb21dW190b10gPSBzYWZlU3ViKF9hbGxvd2FuY2UsIF92YWx1ZSk7CiAgICAgICAgYWRkVXNlcihfdG8pOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICB9CiAgICAKICAgIC8qKgoJICogQG5vdGljZSBBdXRob3JpemUgYW4gYWRkcmVzcyB0byByZXRyaWV2ZSBmdW5kcyBmcm9tIHlvdSB+IEVSQy0yMCBTdGFuZGFyZAoJICogQGRldiAKCSAgICAgICAgMzAgbWludXRlIGNvb2xkb3duIHJlbW92ZWQgZm9yIGVhc2llciBwYXJ0aWNpcGF0aW9uIGluCgkgICAgICAgIHRyYWRpbmcgcGxhdGZvcm1zIHN1Y2ggYXMgRXRoZXIgRGVsdGEKCSAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB5b3Ugd2lzaCB0byBhdXRob3JpemUKCSAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgeW91IHdpc2ggdG8gYXV0aG9yaXplCgkgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIGV4dGVybmFsIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIH0KICAgIAogICAgLyoqCgkgKiBAbm90aWNlIFRyYW5zZmVyIHRoZSBzcGVjaWZpZWQgYW1vdW50IHRvIHRoZSB0YXJnZXQgYWRkcmVzcyB+IEVSQy0yMCBTdGFuZGFyZAoJICogQGRldiAKCSAgICAgICAgQSBib29sZWFuIGlzIHJldHVybmVkIHNvIHRoYXQgY2FsbGVycyBvZiB0aGUgZnVuY3Rpb24gCgkgICAgICAgIHdpbGwga25vdyBpZiB0aGVpciB0cmFuc2FjdGlvbiB3ZW50IHRocm91Z2guCgkgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHlvdSB3aXNoIHRvIHNlbmQgdGhlIHRva2VucyB0bwoJICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB5b3Ugd2lzaCB0byBzZW5kCgkgKiBAcmV0dXJuIHsKCQkJCQkic3VjY2VzcyI6ICJUcmFuc2FjdGlvbiBzdWNjZXNzIgoJCQkJfQogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIGV4dGVybmFsIGlzUnVubmluZyBub0ZyZWV6ZSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBieXRlcyBtZW1vcnkgZW1wdHk7CiAgICAgICAgaWYgKF90byA9PSBzZWxmQWRkcmVzcykgewogICAgICAgICAgICByZXR1cm4gdHJhbnNmZXJUb1NlbGYoX3ZhbHVlKTsKICAgICAgICB9IGVsc2UgaWYgKGlzQ29udHJhY3QoX3RvKSkgewogICAgICAgICAgICByZXR1cm4gdHJhbnNmZXJUb0NvbnRyYWN0KF90bywgX3ZhbHVlLCBlbXB0eSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIHRyYW5zZmVyVG9BZGRyZXNzKF90bywgX3ZhbHVlKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8qKgoJICogQG5vdGljZSBDaGVjayB3aGV0aGVyIGFkZHJlc3MgaXMgYSBjb250cmFjdCB+IEVSQy0yMjMgUHJvcG9zZWQgU3RhbmRhcmQKCSAqIEBwYXJhbSBfYWRkcmVzcyBUaGUgYWRkcmVzcyB0byBjaGVjawoJICogQHJldHVybiB7CgkJCQkJImlzX2NvbnRyYWN0IjogIlJlc3VsdCBvZiBxdWVyeSIKCQkJCX0KICAgICAqLwogICAgZnVuY3Rpb24gaXNDb250cmFjdChhZGRyZXNzIF9hZGRyZXNzKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wgaXNfY29udHJhY3QpIHsKICAgICAgICB1aW50IGxlbmd0aDsKICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgIGxlbmd0aCA6PSBleHRjb2Rlc2l6ZShfYWRkcmVzcykKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGxlbmd0aCA+IDA7CiAgICB9CiAgICAKICAgIC8qKgoJICogQG5vdGljZSBUcmFuc2ZlciB0aGUgc3BlY2lmaWVkIGFtb3VudCB0byB0aGUgdGFyZ2V0IGFkZHJlc3Mgd2l0aCBlbWJlZGRlZCBieXRlcyBkYXRhIH4gRVJDLTIyMyBQcm9wb3NlZCBTdGFuZGFyZAoJICogQGRldiBJbmNsdWRlcyBhbiBleHRyYSB0cmFuc2ZlclRvU2VsZiBmdW5jdGlvbiB0byBoYW5kbGUgQ2FzaW5vIGRlcG9zaXRzCgkgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvCgkgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIHRyYW5zZmVyCgkgKiBAcGFyYW0gX2RhdGEgQW55IGV4dHJhIGVtYmVkZGVkIGRhdGEgb2YgdGhlIHRyYW5zYWN0aW9uCgkgKiBAcmV0dXJuIHsKCQkJCQkic3VjY2VzcyI6ICJUcmFuc2FjdGlvbiBzdWNjZXNzIgoJCQkJfQogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9kYXRhKSBleHRlcm5hbCBpc1J1bm5pbmcgbm9GcmVlemUgcmV0dXJucyAoYm9vbCBzdWNjZXNzKXsKICAgICAgICBpZiAoX3RvID09IHNlbGZBZGRyZXNzKSB7CiAgICAgICAgICAgIHJldHVybiB0cmFuc2ZlclRvU2VsZihfdmFsdWUpOwogICAgICAgIH0gZWxzZSBpZiAoaXNDb250cmFjdChfdG8pKSB7CiAgICAgICAgICAgIHJldHVybiB0cmFuc2ZlclRvQ29udHJhY3QoX3RvLCBfdmFsdWUsIF9kYXRhKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gdHJhbnNmZXJUb0FkZHJlc3MoX3RvLCBfdmFsdWUpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLyoqCgkgKiBAbm90aWNlIEhhbmRsZXMgdHJhbnNmZXIgdG8gYW4gRUNBIChFeHRlcm5hbGx5IENvbnRyb2xsZWQgQWNjb3VudCksIGEgbm9ybWFsIGFjY291bnQgfiBFUkMtMjIzIFByb3Bvc2VkIFN0YW5kYXJkCgkgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvCgkgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIHRyYW5zZmVyCgkgKiBAcmV0dXJuIHsKCQkJCQkic3VjY2VzcyI6ICJUcmFuc2FjdGlvbiBzdWNjZXNzIgoJCQkJfQogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlclRvQWRkcmVzcyhhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIGludGVybmFsIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gc2FmZVN1YihiYWxhbmNlc1ttc2cuc2VuZGVyXSwgX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXStfdmFsdWU7CiAgICAgICAgYWRkVXNlcihfdG8pOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIAogICAgLyoqCgkgKiBAbm90aWNlIEhhbmRsZXMgdHJhbnNmZXIgdG8gYSBjb250cmFjdCB+IEVSQy0yMjMgUHJvcG9zZWQgU3RhbmRhcmQKCSAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8KCSAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gdHJhbnNmZXIKCSAqIEBwYXJhbSBfZGF0YSBBbnkgZXh0cmEgZW1iZWRkZWQgZGF0YSBvZiB0aGUgdHJhbnNhY3Rpb24KCSAqIEByZXR1cm4gewoJCQkJCSJzdWNjZXNzIjogIlRyYW5zYWN0aW9uIHN1Y2Nlc3MiCgkJCQl9CiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyVG9Db250cmFjdChhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9kYXRhKSBpbnRlcm5hbCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHNhZmVTdWIoYmFsYW5jZXNbbXNnLnNlbmRlcl0sIF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10rX3ZhbHVlOwogICAgICAgIFdlQmV0Q3J5cHRvIHJlYyA9IFdlQmV0Q3J5cHRvKF90byk7CiAgICAgICAgcmVjLnRva2VuRmFsbGJhY2sobXNnLnNlbmRlciwgX3ZhbHVlLCBfZGF0YSk7CiAgICAgICAgYWRkVXNlcihfdG8pOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIAogICAgLyoqCgkgKiBAbm90aWNlIEhhbmRsZXMgQ2FzaW5vIGRlcG9zaXRzIH4gQ3VzdG9tIEVSQy0yMjMgUHJvcG9zZWQgU3RhbmRhcmQgQWRkaXRpb24KCSAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gdHJhbnNmZXIKCSAqIEByZXR1cm4gewoJCQkJCSJzdWNjZXNzIjogIlRyYW5zYWN0aW9uIHN1Y2Nlc3MiCgkJCQl9CiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyVG9TZWxmKHVpbnQyNTYgX3ZhbHVlKSBpbnRlcm5hbCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHNhZmVTdWIoYmFsYW5jZXNbbXNnLnNlbmRlcl0sIF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbc2VsZkFkZHJlc3NdID0gYmFsYW5jZXNbc2VsZkFkZHJlc3NdK192YWx1ZTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBzZWxmQWRkcmVzcywgX3ZhbHVlKTsKCQlhbGxvd2VkW3NlbGZBZGRyZXNzXVttc2cuc2VuZGVyXSA9IF92YWx1ZSArIGFsbG93ZWRbc2VsZkFkZHJlc3NdW21zZy5zZW5kZXJdOwoJCUlPVVN1cHBseSArPSBfdmFsdWU7CgkJQXBwcm92YWwoc2VsZkFkZHJlc3MsIG1zZy5zZW5kZXIsIGFsbG93ZWRbc2VsZkFkZHJlc3NdW21zZy5zZW5kZXJdKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCQoJLyoqCgkgKiBAbm90aWNlIEVtcHR5IHRva2VuRmFsbGJhY2sgbWV0aG9kIHRvIGVuc3VyZSBFUkMtMjIzIGNvbXBhdGliaWxpdHkKCSAqIEBwYXJhbSBfc2VuZGVyIFRoZSBhZGRyZXNzIHdobyBzZW50IHRoZSBFUkMtMjIzIHRva2VucwoJICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0aGUgYWRkcmVzcyBzZW50IHRvIHRoaXMgY29udHJhY3QKCSAqIEBwYXJhbSBfZGF0YSBBbnkgZW1iZWRkZWQgZGF0YSBvZiB0aGUgdHJhbnNhY3Rpb24KCSAqLwoJZnVuY3Rpb24gdG9rZW5GYWxsYmFjayhhZGRyZXNzIF9zZW5kZXIsIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljIHt9CgkKCS8qKgoJICogQG5vdGljZSBDaGVjayBob3cgbXVjaCBDYXNpbm8gd2l0aGRyYXdhbCBiYWxhbmNlIHJlbWFpbnMgZm9yIGFkZHJlc3MKCSAqIEByZXR1cm4gewoJCQkJCSJyZW1haW5pbmciOiAiV2l0aGRyYXdhbCBiYWxhbmNlIHJlbWFpbmluZyIKCQkJCX0KICAgICAqLwogICAgZnVuY3Rpb24gY2hlY2tNb250aGx5TGltaXQoKSBleHRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgICAgIHJldHVybiBtb250aGx5TGltaXRbbXNnLnNlbmRlcl07CiAgICB9CgkKCS8qKgoJICogQG5vdGljZSBSZXRyaWV2ZSBFUkMgVG9rZW5zIHNlbnQgdG8gY29udHJhY3QKCSAqIEBkZXYgRmVlbCBmcmVlIHRvIGNvbnRhY3QgdXMgYW5kIHJldHJpZXZlIHlvdXIgRVJDIHRva2VucyBzaG91bGQgeW91IHdpc2ggc28uCgkgKiBAcGFyYW0gX3Rva2VuIFRoZSB0b2tlbiBjb250cmFjdCBhZGRyZXNzCgkgKi8KICAgIGZ1bmN0aW9uIGNsYWltVG9rZW5zKGFkZHJlc3MgX3Rva2VuKSBpc0FkbWluIGV4dGVybmFsIHsgCgkJcmVxdWlyZShfdG9rZW4gIT0gc2VsZkFkZHJlc3MpOwogICAgICAgIFdlQmV0Q3J5cHRvIHRva2VuID0gV2VCZXRDcnlwdG8oX3Rva2VuKTsgCiAgICAgICAgdWludCBiYWxhbmNlID0gdG9rZW4uYmFsYW5jZU9mKHNlbGZBZGRyZXNzKTsgCiAgICAgICAgdG9rZW4udHJhbnNmZXIoYWRtaW4sIGJhbGFuY2UpOyAKICAgIH0KICAgIAoJLyoqCgkgKiBAbm90aWNlIEZyZWV6ZSB0b2tlbiBjaXJjdWxhdGlvbiAtIHNwbGl0UHJvZml0cyBpbnRlcm5hbAoJICogQGRldiAKCSAgICAgICAgRW5zdXJlcyB0aGF0IG9uZSBkb2Vzbid0IHRyYW5zZmVyIGhpcyB0b3RhbCBiYWxhbmNlIG1pZC1zcGxpdCB0byAKCSAgICAgICAgYW4gYWNjb3VudCBsYXRlciBpbiB0aGUgc3BsaXQgcXVldWUgaW4gb3JkZXIgdG8gcmVjZWl2ZSB0d2ljZSB0aGUKCSAgICAgICAgbW9udGhseSBwcm9maXRzCgkgKi8KICAgIGZ1bmN0aW9uIGFzc2V0RnJlZXplKCkgaW50ZXJuYWwgewogICAgICAgIGlzRnJvemVuID0gdHJ1ZTsKICAgIH0KICAgIAoJLyoqCgkgKiBAbm90aWNlIFJlLWVuYWJsZSB0b2tlbiBjaXJjdWxhdGlvbiAtIHNwbGl0UHJvZml0cyBpbnRlcm5hbAoJICovCiAgICBmdW5jdGlvbiBhc3NldFRoYXcoKSBpbnRlcm5hbCB7CiAgICAgICAgaXNGcm96ZW4gPSBmYWxzZTsKICAgIH0KICAgIAoJLyoqCgkgKiBAbm90aWNlIEZyZWV6ZSB0b2tlbiBjaXJjdWxhdGlvbgoJICogQGRldiBUbyBiZSB1c2VkIG9ubHkgaW4gZXh0cmVtZSBjaXJjdW1zdGFuY2VzLgoJICovCiAgICBmdW5jdGlvbiBlbWVyZ2VuY3lGcmVlemUoKSBpc0FkbWluIGV4dGVybmFsIHsKICAgICAgICBpc0Zyb3plbiA9IHRydWU7CiAgICB9CiAgICAKCS8qKgoJICogQG5vdGljZSBSZS1lbmFibGUgdG9rZW4gY2lyY3VsYXRpb24KCSAqIEBkZXYgVG8gYmUgdXNlZCBvbmx5IGluIGV4dHJlbWUgY2lyY3Vtc3RhbmNlcwoJICovCiAgICBmdW5jdGlvbiBlbWVyZ2VuY3lUaGF3KCkgaXNBZG1pbiBleHRlcm5hbCB7CiAgICAgICAgaXNGcm96ZW4gPSBmYWxzZTsKICAgIH0KCQoJLyoqCgkgKiBAbm90aWNlIERpc2FibGUgdGhlIHNwbGl0dGluZyBmdW5jdGlvbgoJICogQGRldiAKCSAgICAgICAgVG8gYmUgdXNlZCBpbiBjYXNlIHRoZSBzeXN0ZW0gaXMgdXBncmFkZWQgdG8gYSAKCSAgICAgICAgbm9kZS5qcyBvcGVyYXRlZCBwcm9maXQgcmV3YXJkIHN5c3RlbSB2aWEgdGhlIAoJCQlhbHRlckJhbmtCYWxhbmNlIGZ1bmN0aW9uLiBFbnN1cmVzIHNjYWxhYmlsaXR5IAoJCQlpbiBjYXNlIHVzZXJiYXNlIGdldHMgdG9vIGJpZy4KCSAqLwoJZnVuY3Rpb24gZW1lcmdlbmN5U3BsaXRUb2dnbGUoKSBpc0FkbWluIGV4dGVybmFsIHsKCQl1aW50IHRlbXAgPSAwOwoJCXRlbXAgLT0gMTsKCQlpZiAocmVsYXRpdmVEYXRlU2F2ZSA9PSB0ZW1wKSB7CgkJICAgIHJlbGF0aXZlRGF0ZVNhdmUgPSBub3c7CgkJfSBlbHNlIHsKCSAgICAJcmVsYXRpdmVEYXRlU2F2ZSA9IHRlbXA7CgkJfQoJfQoJCgkvKioKCSAqIEBub3RpY2UgQWRkIHRoZSBhZGRyZXNzIHRvIHRoZSB1c2VyIGxpc3QgCgkgKiBAZGV2IFVzZWQgZm9yIHRoZSBzcGxpdHRpbmcgZnVuY3Rpb24gdG8gdGFrZSBpdCBpbnRvIGFjY291bnQKCSAqIEBwYXJhbSBfdXNlciBVc2VyIHRvIGFkZCB0byBkYXRhYmFzZQoJICovCglmdW5jdGlvbiBhZGRVc2VyKGFkZHJlc3MgX3VzZXIpIGludGVybmFsIHsKCQlpZiAoIWlzQWRkZWRbX3VzZXJdKSB7CiAgICAgICAgICAgIHVzZXJzLnB1c2goX3VzZXIpOwogICAgICAgICAgICBtb250aGx5TGltaXRbX3VzZXJdID0gMTAwMDAwMDAwMDAwMDsKICAgICAgICAgICAgaXNBZGRlZFtfdXNlcl0gPSB0cnVlOwogICAgICAgIH0KCX0KICAgIAoJLyoqCgkgKiBAbm90aWNlIFNwbGl0IHRoZSBtb250aGx5IHByb2ZpdHMgb2YgdGhlIENhc2lubyB0byB0aGUgdXNlcnMKCSAqIEBkZXYgCgkJCVRoZSBmb3JtdWxhIHRoYXQgY2FsY3VsYXRlcyB0aGUgcHJvZml0IGEgdXNlciBpcyBvd2VkIGNhbiBiZSBzZWVuIG9uIAoJCQl0aGUgd2hpdGUgcGFwZXIuIFRoZSBhY3R1YWxQcm9maXRTcGxpdCB2YXJpYWJsZSBzdG9yZXMgdGhlIGFjdHVhbCB2YWx1ZXMKCSAgIAkJdGhhdCBhcmUgZGlzdHJpYnV0ZWQgdG8gdGhlIHVzZXJzIHRvIHByZXZlbnQgcm91bmRpbmcgZXJyb3JzIGZyb20gYnVybmluZyAKCQkJdG9rZW5zLiBTaW5jZSBnYXMgcmVxdWlyZW1lbnRzIHdpbGwgc3Bpa2UgdGhlIG1vcmUgdXNlcnMgdXNlIG91ciBwbGF0Zm9ybSwKCQkJYSBsb29wLXN0YXRlLXNhdmUgaXMgaW1wbGVtZW50ZWQgdG8gZW5zdXJlIHNjYWxhYmlsaXR5LgoJICovCiAgICBmdW5jdGlvbiBzcGxpdFByb2ZpdHMoKSBleHRlcm5hbCB7CiAgICAgICAgdWludCBpOwogICAgICAgIGlmICghaXNGcm96ZW4pIHsKICAgICAgICAgICAgcmVxdWlyZShub3cgPj0gcmVsYXRpdmVEYXRlU2F2ZSk7CiAgICAgICAgICAgIGFzc2V0RnJlZXplKCk7CiAgICAgICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbc2VsZkFkZHJlc3NdID4gMzAwMDAwMDAwMDAwMDApOwogICAgICAgICAgICByZWxhdGl2ZURhdGVTYXZlID0gbm93ICsgMzAgZGF5czsKICAgICAgICAgICAgY3VycmVudFByb2ZpdHMgPSAoKGJhbGFuY2VzW3NlbGZBZGRyZXNzXS0zMDAwMDAwMDAwMDAwMCkvMTApKjc7IAogICAgICAgICAgICBhbW91bnRJbkNpcmN1bGF0aW9uID0gc2FmZVN1Yig0MDAwMDAwMDAwMDAwMDAsIGJhbGFuY2VzW3NlbGZBZGRyZXNzXSkgKyBJT1VTdXBwbHk7CiAgICAgICAgICAgIGN1cnJlbnRJdGVyYXRpb24gPSAwOwoJCQlhY3R1YWxQcm9maXRTcGxpdCA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZm9yIChpID0gY3VycmVudEl0ZXJhdGlvbjsgaSA8IHVzZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBtb250aGx5TGltaXRbdXNlcnNbaV1dID0gMTAwMDAwMDAwMDAwMDsKICAgICAgICAgICAgICAgIGlmIChtc2cuZ2FzIDwgMjUwMDAwKSB7CiAgICAgICAgICAgICAgICAgICAgY3VycmVudEl0ZXJhdGlvbiA9IGk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgkJCQlpZiAoIWVsaWdpYmxlRm9yRGl2aWRlbmNlKHVzZXJzW2ldKSkgewoJCQkJICAgIG1vbmV5U3BlbnRbdXNlcnNbaV1dID0gMDsKICAgICAgICAJCQljaGVja1NwbGl0RW5kKGkpOwogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoJCQkJfQoJCQkJbW9uZXlTcGVudFt1c2Vyc1tpXV0gPSAwOwoJCQkJYWN0dWFsUHJvZml0U3BsaXQgKz0gKChiYWxhbmNlc1t1c2Vyc1tpXV0rYWxsb3dlZFtzZWxmQWRkcmVzc11bdXNlcnNbaV1dKSpjdXJyZW50UHJvZml0cykvYW1vdW50SW5DaXJjdWxhdGlvbjsKICAgICAgICAgICAgICAgIFRyYW5zZmVyKHNlbGZBZGRyZXNzLCB1c2Vyc1tpXSwgKChiYWxhbmNlc1t1c2Vyc1tpXV0rYWxsb3dlZFtzZWxmQWRkcmVzc11bdXNlcnNbaV1dKSpjdXJyZW50UHJvZml0cykvYW1vdW50SW5DaXJjdWxhdGlvbik7CiAgICAgICAgICAgICAgICBiYWxhbmNlc1t1c2Vyc1tpXV0gKz0gKChiYWxhbmNlc1t1c2Vyc1tpXV0rYWxsb3dlZFtzZWxmQWRkcmVzc11bdXNlcnNbaV1dKSpjdXJyZW50UHJvZml0cykvYW1vdW50SW5DaXJjdWxhdGlvbjsKCQkJCWNoZWNrU3BsaXRFbmQoaSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgkKCS8qKgoJICogQG5vdGljZSBDaGFuZ2UgdmFyaWFibGVzIG9uIHNwbGl0IGVuZAoJICogQHBhcmFtIGkgVGhlIGN1cnJlbnQgaW5kZXggb2YgdGhlIHNwbGl0IGxvb3AuCgkgKi8KCWZ1bmN0aW9uIGNoZWNrU3BsaXRFbmQodWludDI1NiBpKSBpbnRlcm5hbCB7CgkJaWYgKGkgPT0gdXNlcnMubGVuZ3RoLTEpIHsKCQkJYXNzZXRUaGF3KCk7CgkJCWJhbGFuY2VzWzB4NjZBRTA3MEE4NTAxRTgxNkNBOTVhYzk5YzRFMTVDN2UxMzJmZDI4OV0gPSBiYWxhbmNlc1sweDY2QUUwNzBBODUwMUU4MTZDQTk1YWM5OWM0RTE1QzdlMTMyZmQyODldICsgY3VycmVudFByb2ZpdHMvMjA7CgkJCWJhbGFuY2VzW3NlbGZBZGRyZXNzXSA9IGJhbGFuY2VzW3NlbGZBZGRyZXNzXSAtIGFjdHVhbFByb2ZpdFNwbGl0IC0gY3VycmVudFByb2ZpdHMvMjA7CgkJfQoJfQogICAgCgkvKioKCSAqIEBub3RpY2UgUmlzZSBvciBsb3dlciB1c2VyIGJhbmsgYmFsYW5jZSAtIEJhY2tlbmQgRnVuY3Rpb24KCSAqIEBkZXYgCgkgICAgICAgIFRoaXMgYWxsb3dzIGFkanVzdG1lbnQgb2YgdGhlIGJhbGFuY2UgYSB1c2VyIGhhcyB3aXRoaW4gdGhlIENhc2lubyB0bwoJCQlyZXByZXNlbnQgZWFybmluZ3MgYW5kIGxvc3Nlcy4KCSAqIEBwYXJhbSBfdG9BbHRlciBUaGUgYWRkcmVzcyB3aG9zZSBDYXNpbm8gYmFsYW5jZSB0byBhbHRlcgoJICogQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCB0byBhbHRlciBpdCBieQoJICovCiAgICBmdW5jdGlvbiBhbHRlckJhbmtCYWxhbmNlKGFkZHJlc3MgX3RvQWx0ZXIsIHVpbnQyNTYgX2Ftb3VudCkgaW50ZXJuYWwgewogICAgICAgIGlmIChfYW1vdW50ID4gYWxsb3dlZFtzZWxmQWRkcmVzc11bX3RvQWx0ZXJdKSB7CiAgICAgICAgICAgIElPVVN1cHBseSArPSAoX2Ftb3VudCAtIGFsbG93ZWRbc2VsZkFkZHJlc3NdW190b0FsdGVyXSk7CiAgICAgICAgICAgIG1vbmV5U3BlbnRbX3RvQWx0ZXJdICs9IChfYW1vdW50IC0gYWxsb3dlZFtzZWxmQWRkcmVzc11bX3RvQWx0ZXJdKTsKCQkJYWxsb3dlZFtzZWxmQWRkcmVzc11bX3RvQWx0ZXJdID0gX2Ftb3VudDsKCQkJQXBwcm92YWwoc2VsZkFkZHJlc3MsIF90b0FsdGVyLCBhbGxvd2VkW3NlbGZBZGRyZXNzXVtfdG9BbHRlcl0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIElPVVN1cHBseSAtPSAoYWxsb3dlZFtzZWxmQWRkcmVzc11bX3RvQWx0ZXJdIC0gX2Ftb3VudCk7CiAgICAgICAgICAgIG1vbmV5U3BlbnRbX3RvQWx0ZXJdICs9IChhbGxvd2VkW3NlbGZBZGRyZXNzXVtfdG9BbHRlcl0gLSBfYW1vdW50KTsKICAgICAgICAgICAgYWxsb3dlZFtzZWxmQWRkcmVzc11bX3RvQWx0ZXJdID0gX2Ftb3VudDsKCQkJQXBwcm92YWwoc2VsZkFkZHJlc3MsIF90b0FsdGVyLCBhbGxvd2VkW3NlbGZBZGRyZXNzXVtfdG9BbHRlcl0pOwogICAgICAgIH0KICAgIH0KICAgIAoJLyoqCgkgKiBAbm90aWNlIEZyZWV6ZSB1c2VyIGR1cmluZyBwbGF0Zm9ybSB1c2UgLSBCYWNrZW5kIEZ1bmN0aW9uCgkgKiBAZGV2IFByZXZlbnRzIGFnYWluc3QgdGhlIEVSQy0yMCByYWNlIGF0dGFjayBvbiB0aGUgQ2FzaW5vCgkgKi8KICAgIGZ1bmN0aW9uIHBsYXRmb3JtTG9naW4oKSB1c2VyTm90QmFubmVkKG1zZy5zZW5kZXIpIGV4dGVybmFsIHsKICAgICAgICAvL2xvZ2dlZFVzZXJbbXNnLnNlbmRlcl0gPSB0cnVlOwogICAgICAgIGNvb2xkb3duW21zZy5zZW5kZXJdID0gMDsKICAgICAgICBjb29sZG93blttc2cuc2VuZGVyXSAtPSAxOwogICAgfQoJCgkvKioKCSAqIEBub3RpY2UgRGUtRnJlZXplIHVzZXIgLSBCYWNrZW5kIEZ1bmN0aW9uCiAgICAgKiBAZGV2IFVzZWQgd2hlbiBhIHVzZXIgbG9ncyBvdXQgb3IgbG9zZXMgY29ubmVjdGlvbiB3aXRoIHRoZSBEQXBwCgkgKi8KCWZ1bmN0aW9uIHBsYXRmb3JtTG9nb3V0KGFkZHJlc3MgX3RvTG9nb3V0LCB1aW50MjU2IF9uZXdCYWxhbmNlKSBleHRlcm5hbCBpc0FkbWluIHsKCQkvL2xvZ2dlZFVzZXJbbXNnLnNlbmRlcl0gPSBmYWxzZTsKCQljb29sZG93bltfdG9Mb2dvdXRdID0gbm93ICsgMzAgbWludXRlczsKCQlhbHRlckJhbmtCYWxhbmNlKF90b0xvZ291dCxfbmV3QmFsYW5jZSk7Cgl9CgkKCS8qKgoJICogQG5vdGljZSBDaGVjayBpZiB1c2VyIGlzIGxvZ2dlZCBpbnRlcm5hbAoJICogQGRldiBVc2VkIHRvIGVuc3VyZSB0aGF0IHRoZSB1c2VyIGlzIGxvZ2dlZCBpbiB0aHJvdWdob3V0IAoJICogICAgICB0aGUgd2hvbGUgY2FzaW5vIHNlc3Npb24KCSAqIEBwYXJhbSBfdG9DaGVjayBUaGUgdXNlciBhZGRyZXNzIHRvIGNoZWNrCgkgKi8KCWZ1bmN0aW9uIGNoZWNrTG9naW4oYWRkcmVzcyBfdG9DaGVjaykgdmlldyBleHRlcm5hbCByZXR1cm5zIChib29sKSB7CgkgICAgdWludDI1NiBjaGVjayA9IDA7CgkgICAgY2hlY2sgLT0gMTsKCSAgICByZXR1cm4gKGNvb2xkb3duW190b0NoZWNrXSA9PSBjaGVjayk7Cgl9CgkKCS8qKgoJICogQG5vdGljZSBCYW4gYSB1c2VyCgkgKiBAZGV2IFVzZWQgaW4gZXh0cmVtZSBjaXJjdW1zdGFuY2VzIHdoZXJlIHRoZSB1c2VycyBicmVhayB0aGUgbGF3CgkgKiBAcGFyYW0gX3VzZXIgVGhlIHVzZXIgdG8gYmFuCgkgKi8KCWZ1bmN0aW9uIGJhblVzZXIoYWRkcmVzcyBfdXNlcikgZXh0ZXJuYWwgaXNBZG1pbiB7CgkgICAgYmFubmVkVXNlcltfdXNlcl0gPSB0cnVlOwoJICAgIGNvb2xkb3duW191c2VyXSA9IG5vdyArIDMwIG1pbnV0ZXM7Cgl9CgkKCS8qKgoJICogQG5vdGljZSBVbmJhbiBhIHVzZXIKCSAqIEBkZXYgVXNlZCBpbiBleHRyZW1lIGNpcmN1bXN0YW5jZXMgd2hlcmUgdGhlIHVzZXJzIGhhdmUgcmVkZWVtZWQKCSAqIEBwYXJhbSBfdXNlciBUaGUgdXNlciB0byB1bmJhbgoJICovCglmdW5jdGlvbiB1bmJhblVzZXIoYWRkcmVzcyBfdXNlcikgZXh0ZXJuYWwgaXNBZG1pbiB7CgkgICAgYmFubmVkVXNlcltfdXNlcl0gPSBmYWxzZTsKCX0KCQoJLyoqCgkgKiBAbm90aWNlIENoZWNrIGlmIGEgdXNlciBpcyBiYW5uZWQKCSAqIEBkZXYgVXNlZCBieSB0aGUgYmFjay1lbmQgdG8gZ2l2ZSBhIG1lc3NhZ2UgdG8gdGhlIHVzZXIKCSAqIEBwYXJhbSBfdXNlciBUaGUgdXNlciB0byBjaGVjawoJICovCglmdW5jdGlvbiBjaGVja0JhbihhZGRyZXNzIF91c2VyKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpIHsKCSAgICByZXR1cm4gYmFubmVkVXNlcltfdXNlcl07Cgl9CgkKICAgIC8qKgoJICogQG5vdGljZSBQdXJjaGFzZSBXQkMgVG9rZW5zIGZvciBTZWxmIC0gSUNPCgkgKi8KICAgIGZ1bmN0aW9uKCkgcGF5YWJsZSBleHRlcm5hbCB7CiAgICAgICAgdG90YWxGdW5kcyA9IHRvdGFsRnVuZHMgKyBtc2cudmFsdWU7CgkJYWRkcmVzcyBldGhlclRyYW5zZmVyID0gMHg2NkFFMDcwQTg1MDFFODE2Q0E5NWFjOTljNEUxNUM3ZTEzMmZkMjg5OwogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID4gMCk7CgkJcmVxdWlyZShtc2cuc2VuZGVyICE9IGV0aGVyVHJhbnNmZXIpOwoJCXJlcXVpcmUodG90YWxGdW5kcy8xIGV0aGVyIDwgMjAwMCk7CiAgICAgICAgYWRkVXNlcihtc2cuc2VuZGVyKTsKICAgICAgICB1aW50MjU2IHRva2VuQW1vdW50ID0gbXNnLnZhbHVlLzEwMDAwMDAwMDsKCQliYWxhbmNlc1tzZWxmQWRkcmVzc10gPSBiYWxhbmNlc1tzZWxmQWRkcmVzc10gLSB0b2tlbkFtb3VudDsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdICsgdG9rZW5BbW91bnQ7CiAgICAgICAgVHJhbnNmZXIoc2VsZkFkZHJlc3MsIG1zZy5zZW5kZXIsIHRva2VuQW1vdW50KTsKICAgICAgICBldGhlclRyYW5zZmVyLnRyYW5zZmVyKG1zZy52YWx1ZSk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogQG5vdGljZSBBZHZlcnRpc2luZyBUb2tlbiBEaXN0cmlidXRpb24KICAgICAqIEBkZXYgRW5zdXJlcyB0aGUgdXNlciBoYXMgYXQgbGVhc3QgMC4xIEV0aGVyIG9uIGhpcyAKICAgICAqICAgICAgYWNjb3VudCBiZWZvcmUgZGlzdHJpYnV0aW5nIDIwIFdCQwogICAgICovCiAgICBmdW5jdGlvbiBjbGFpbUJvbnVzKCkgZXh0ZXJuYWwgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlci5iYWxhbmNlLygxMDAwIGZpbm5leSkgPj0gMSAmJiAhY2xhaW1lZEJvbnVzW21zZy5zZW5kZXJdKTsKICAgICAgICBjbGFpbWVkQm9udXNbbXNnLnNlbmRlcl0gPSB0cnVlOwoJCWFsbG93ZWRbc2VsZkFkZHJlc3NdW21zZy5zZW5kZXJdID0gYWxsb3dlZFtzZWxmQWRkcmVzc11bbXNnLnNlbmRlcl0gKyAyMDAwMDAwMDA7CgkJSU9VU3VwcGx5ICs9IDIwMDAwMDAwMDsKICAgICAgICBhZGRVc2VyKG1zZy5zZW5kZXIpOwoJCUFwcHJvdmFsKHNlbGZBZGRyZXNzLCBtc2cuc2VuZGVyLCBhbGxvd2VkW3NlbGZBZGRyZXNzXVttc2cuc2VuZGVyXSk7CiAgICB9Cn0='.
	

]
