Class {
	#name : #SRTe5bb2aa9e4d748439a66c0f5350257abbce4d8b6,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTe5bb2aa9e4d748439a66c0f5350257abbce4d8b6 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKCi8qKgogKiBAdGl0bGUgT3duYWJsZQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuCiAqLwpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCgogIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKCgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKCi8qKgogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKi8KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKfQoKCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgaW50ZXJuYWwgYWxsb3dlZDsKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW19mcm9tXSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSk7CgogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICoKICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICogYW5kIHRoZSBuZXcgYWxsb3dhbmNlIGJ5IHVuZm9ydHVuYXRlIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcwogICAqIHJhY2UgY29uZGl0aW9uIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUgYWZ0ZXJ3YXJkczoKICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgKi8KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqLwogIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9CgovKioKICogQHRpdGxlIE1pbnRhYmxlIHRva2VuCiAqIEBkZXYgU2ltcGxlIEVSQzIwIFRva2VuIGV4YW1wbGUsIHdpdGggbWludGFibGUgdG9rZW4gY3JlYXRpb24KICogQGRldiBJc3N1ZTogKiBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5L2lzc3Vlcy8xMjAKICogQmFzZWQgb24gY29kZSBieSBUb2tlbk1hcmtldE5ldDogaHR0cHM6Ly9naXRodWIuY29tL1Rva2VuTWFya2V0TmV0L2ljby9ibG9iL21hc3Rlci9jb250cmFjdHMvTWludGFibGVUb2tlbi5zb2wKICovCmNvbnRyYWN0IE1pbnRhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZXsKICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwogIGV2ZW50IE1pbnRGaW5pc2hlZCgpOyAKICB1aW50MjU2IHB1YmxpYyB0b2tlbnNNaW50ZWQgPSAwOyAKICBib29sIHB1YmxpYyBtaW50aW5nRmluaXNoZWQgPSBmYWxzZTsKCiAgbW9kaWZpZXIgY2FuTWludCgpIHsKICAgIHJlcXVpcmUoIW1pbnRpbmdGaW5pc2hlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBtaW50IHRva2VucwogICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIG1pbnRlZCB0b2tlbnMuCiAgICogQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gbWludC4KICAgKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgb25seU93bmVyIGNhbk1pbnQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIC8qKiBNb2RpZmllZCB0byBoYW5kbGUgbXVsdGlwbGUgY2FwcGVkIGNyb3dkc2FsZXMgKi8KICAgIF9hbW91bnQgPSBfYW1vdW50ICogMSBldGhlcjsKICAgIHJlcXVpcmUodG9rZW5zTWludGVkLmFkZChfYW1vdW50KTw9dG90YWxTdXBwbHkpOyAKICAgIHRva2Vuc01pbnRlZCA9IHRva2Vuc01pbnRlZC5hZGQoX2Ftb3VudCk7CiAgICAvL1phcHBlbGluIFN0YW5kYXJkIGNvZGUgCiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICBNaW50KF90bywgX2Ftb3VudCk7CiAgICBUcmFuc2ZlcigweDAsIF90bywgX2Ftb3VudCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gc3RvcCBtaW50aW5nIG5ldyB0b2tlbnMuCiAgICogQHJldHVybiBUcnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gZmluaXNoTWludGluZygpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgIE1pbnRGaW5pc2hlZCgpOwogICAgcmV0dXJuIHRydWU7CiAgfQp9CgoKLyoqCiAqIEB0aXRsZSBXYW5kIHRva2VuCiAqIEBkZXYgQ3VzdG9taXplZCBtaW50YWJsZSBFUkMyMCBUb2tlbiAgCiAqIEBkZXYgVG9rZW4gdG8gc3VwcG9ydCBtdWx0aXBsZSBDYXBwZWQgQ3Jvd2RTYWxlcy4gaS5lLiBldmVyeSBjcm93ZHNhbGUgd2l0aCBjYXBwZWQgdG9rZW4gbGltaXQgYW5kIGFsc28KICAgICAgICB3ZSB3aWxsIGJlIGFibGUgdG8gaW5jcmVhc2UgdG90YWwgdG9rZW4gc3VwcGx5IGJhc2VkIG9uIHJlcXVpcmVtZW50cwogKi8KY29udHJhY3QgV2FuZFRva2VuIGlzIE93bmFibGUsIE1pbnRhYmxlVG9rZW4geyAKICAvL0V2ZW50IGZvciBQcmVzYWxlIHRyYW5zZmVycwogIGV2ZW50IFRva2VuUHJlU2FsZVRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiBhbW91bnQpOwogIAogIC8vIFRva2VuIGRldGFpbHMKICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiV2FuZCBUb2tlbiI7CiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiV0FORCI7CgogIC8vIDE4IGRlY2ltYWwgcGxhY2VzLCB0aGUgc2FtZSBhcyBFVEguCiAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CgogIC8qKgogICAgQGRldiBDb25zdHJ1Y3Rvci4gU2V0cyB0aGUgaW5pdGlhbCBzdXBwbGllcyBhbmQgdHJhbnNmZXIgYWR2aXNvci9mb3VuZGVycy9wcmVzYWxlIHRva2VucyB0byB0aGUgZ2l2ZW4gYWNjb3VudAogICAgQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0aGUgYWNjb3VudCBudG8gd2hpY2ggcHJlc2FsZSB0b2tlbnMgKyBBZHZpc29ycy9mb3VuZGVycyB0b2tlbnMgdHJhbnNmZXJyZWQKICAgKi8KICBmdW5jdGlvbiBXYW5kVG9rZW4oYWRkcmVzcyBfb3duZXIpIHsKICAgICAgLy9Ub3RhbCBvZiA3NU0gdG9rZW5zCiAgICAgIHRvdGFsU3VwcGx5ID0gNzUgKiAxMCoqMjQ7ICAKCiAgICAgIC8vIDE3TSB0b2tlbnMgZm9yIEZ1bmRlcnMrYWR2aXNvcnMsIDMuNE0gZm9yIFByZVNhbGVzCiAgICAgIHRva2Vuc01pbnRlZCA9IHRva2Vuc01pbnRlZC5hZGQoMjA0MDAwMDAgKiAoMSBldGhlcikpOwogICAgICBiYWxhbmNlc1tfb3duZXJdID0gMjA0MDAwMDAgKiAxIGV0aGVyOwogIH0gICAKCiAgLyoqCiAgICBAZGV2IGZ1bmN0aW9uIHRvIGhhbmRsZSBwcmVzYWxlIHRyYXNuZmVycyBtYW51YWxseS4gT25seSBvd25lciBjYW4gZXhlY3V0ZSB0aGUgY29udHJhY3QKICAgIEBwYXJhbSBfYWNjb3VudHMgYnV5ZXJzIGFjY291bnRzIHRoYXQgd2lsbCByZWNlaXZlIHRoZSBwcmVzYWxlIHRva2VucwogICAgQHBhcmFtIF90b2tlbnMgICBBbW91bnQgb2YgdGhlIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZCB0byBlYWNoIGFjY291bnQgaW4gX2FjY291bnRzIGxpc3QgCiAgICBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIGlzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gYmF0Y2hUcmFuc2ZlcnMoYWRkcmVzc1tdIF9hY2NvdW50cywgdWludDI1NltdIF90b2tlbnMpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfYWNjb3VudHMubGVuZ3RoID4gMCk7CiAgICByZXF1aXJlKF9hY2NvdW50cy5sZW5ndGggPT0gX3Rva2Vucy5sZW5ndGgpOyAKICAgIGZvciAodWludCBpID0gMDsgaSA8IF9hY2NvdW50cy5sZW5ndGg7IGkrKykgewogICAgICByZXF1aXJlKF9hY2NvdW50c1tpXSAhPSAweDApOwogICAgICByZXF1aXJlKF90b2tlbnNbaV0gPiAwKTsgCiAgICAgIHRyYW5zZmVyKF9hY2NvdW50c1tpXSwgX3Rva2Vuc1tpXSAqIDEgZXRoZXIpOwogICAgICBUb2tlblByZVNhbGVUcmFuc2Zlcihtc2cuc2VuZGVyLCBfYWNjb3VudHNbaV0sIF90b2tlbnNbaV0pOyAKICAgIH0KICAgIHJldHVybiB0cnVlOyAgIAogIH0KICAKICAvKioKICAgIEBkZXYgZnVuY3Rpb24gdG8gcmFpc2UgdGhlIHRvdGFsIHN1cHBseS4gTWV0aG9kIGNhbiBiZSBleGVjdXRlZCBvbmx5IGJ5IGl0cyBvd25lcgogICAgQHBhcmFtIF9zdXBwbHkgZGVsdGEgbnVtYmVyIG9mIHRva2VucyB0byBiZSBhZGRlZCB0byB0b3RhbCBzdXBwbHkgCiAgICBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIGlzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gcmFpc2VJbml0aWFsU3VwcGx5KHVpbnQyNTYgX3N1cHBseSkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKF9zdXBwbHkgKiAxIGV0aGVyKTsKICAgICAgcmV0dXJuIHRydWU7CiAgfQp9CgovKioKICogQHRpdGxlIFdhbmR4IENyb3dTYWxlL0lDTyBjb250cmFjdCAKICogQGRldiBJdCBhbGxvd3MgbXVsdGlwbGUgQ2FwcGVkIENyb3dkU2FsZXMuIGkuZS4gZXZlcnkgY3Jvd2RzYWxlIHdpdGggY2FwcGVkIHRva2VuIGxpbWl0LiAKICogQGRldiBleHBvc2VzIDIgbW9yZSBwcm94eSBtZXRob2RzIGZyb20gdG9rZW4gY29udHJhY3Qgd2hpY2ggY2FuIGJlIGV4ZWN1dGVkIG9ubHkgYnkgdGhpcyBjb250cmFjdCBvd25lcgogKi8KY29udHJhY3QgV2FuZENyb3dkc2FsZSBpcyBPd25hYmxlCnsgCiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsgCiAgICAgCiAgICAvLyBUaGUgdG9rZW4gYmVpbmcgc29sZAogICAgV2FuZFRva2VuIHB1YmxpYyB0b2tlbjsgIAogICAgLy8gdGhlIGFjY291bnQgdHAgd2hpY2ggYWxsIGluY29taW5nIGV0aGVyIHdpbGwgYmUgdHJhbnNmZXJyZWQKICAgIGFkZHJlc3MgcHVibGljIHdhbGxldDsKICAgIC8vIEZsYWcgdG8gdHJhY2sgdGhlIGNyb3dkc2FsZSBzdGF0dXMgKEFjdGl2ZS9JbkFjdGl2ZSkKICAgIGJvb2wgcHVibGljIGNyb3dkU2FsZU9uID0gZmFsc2U7ICAKCiAgICAvLyBDdXJyZW50IGNyb3dzYWxlIHNhdGUgdmFyaWFibGVzCiAgICB1aW50MjU2IHB1YmxpYyBjYXAgPSAwOyAgLy8gTWF4IGFsbG93ZWQgdG9rZW5zIHRvIGF2YWlhbGJsZQogICAgdWludDI1NiBwdWJsaWMgc3RhcnRUaW1lOyAvLyBDcm93ZHNhbGUgc3RhcnQgdGltZQogICAgdWludDI1NiBwdWJsaWMgZW5kVGltZTsgIC8vIENyb3dkc2FsZSBlbmQgdGltZQogICAgdWludDI1NiBwdWJsaWMgd2VpUmFpc2VkID0gMDsgIC8vIFRvdGFsIGFtb3VudCBldGhlci93ZWkgY29sbGVjdGVkCiAgICB1aW50MjU2IHB1YmxpYyB0b2tlbnNNaW50ZWQgPSAwOyAvLyBUb3RhbCBudW1iZXIgb2YgdG9rZW5zIG1pbnRlZC9zb2xkIHNvIGZhciBpbiB0aGlzIGNyb3dkc2FsZQogICAgdWludDI1NltdIHB1YmxpYyBkaXNjb3VudGVkUmF0ZXMgOyAvLyBEaXNjb3VudCBwZXIgc2xvdAogICAgdWludDI1NltdIHB1YmxpYyBjcm93c2FsZVNsb3RzIDsgLy8gTGlzdCBvZiBzbG90cwogICAgCiAgICAvLyBFdmVudCB0byBiZSByZWdpc3RlcmVkIHdoZW4gYSBzdWNjZXNzZnVsIHRva2VuIHB1cmNoYXNlIGhhcHBlbnMKICAgIGV2ZW50IFRva2VuUHVyY2hhc2UoYWRkcmVzcyBpbmRleGVkIHB1cmNoYXNlciwgYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IGFtb3VudCk7CiAgICAKICAgIC8qKiBNb2RpZmllcnMgdG8gdmVyaWZ5IHRoZSBzdGF0dXMgb2YgdGhlIGNyb3dkc2FsZSovCiAgICBtb2RpZmllciBhY3RpdmVDcm93ZFNhbGUoKSB7CiAgICAgICAgcmVxdWlyZShjcm93ZFNhbGVPbik7CiAgICAgICAgXzsKICAgIH0gCiAgICBtb2RpZmllciBpbmFjdGl2ZUNyb3dkU2FsZSgpIHsKICAgICAgICByZXF1aXJlKCFjcm93ZFNhbGVPbik7CiAgICAgICAgXzsKICAgIH0gCiAgICAKICAgIC8qKgogICAgICAgIEBkZXYgY29uc3RydWN0b3IuIEludGlhbGl6ZXMgdGhlIHdhbGxldHMgYW5kIHRva2VucyB0byBiZSB0cmFkZWQgdXNpbmcgdGhpcyBjb250cmFjdAogICAgICovCiAgICBmdW5jdGlvbiBXYW5kQ3Jvd2RzYWxlKCkgeyAKICAgICAgICB3YWxsZXQgPSBtc2cuc2VuZGVyOyAgCiAgICAgICAgdG9rZW4gPSBuZXcgV2FuZFRva2VuKG1zZy5zZW5kZXIpOwogICAgfQogICAgCiAgICAvKioKICAgICAgQGRldiBwcm94eSBtZXRob2QgZm9yIFdhbmQgVG9rZW5zIGJhdGNoIHRyYW5zZmVycyBtZXRob2QsIHNvIHRoYXQgY29udHJhY3Qgb3duZXIgY2FuIGNhbGwgdG9rZW4gbWV0aG9kcwogICAgICBAcGFyYW0gX2FjY291bnRzIGJ1eWVycyBhY2NvdW50cyB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgcHJlc2FsZSB0b2tlbnMKICAgICAgQHBhcmFtIF90b2tlbnMgICBBbW91bnQgb2YgdGhlIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZCB0byBlYWNoIGFjY291bnQgaW4gX2FjY291bnRzIGxpc3QgCiAgICAgIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gaXMgc3VjY2Vzc2Z1bC4gCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJhdGNoVHJhbnNmZXJzKGFkZHJlc3NbXSBfYWNjb3VudHMsIHVpbnQyNTZbXSBfdG9rZW5zKSBvbmx5T3duZXIgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF9hY2NvdW50cy5sZW5ndGggPiAwKTsKICAgICAgICByZXF1aXJlKF9hY2NvdW50cy5sZW5ndGggPT0gX3Rva2Vucy5sZW5ndGgpOyAKICAgICAgICB0b2tlbi5iYXRjaFRyYW5zZmVycyhfYWNjb3VudHMsX3Rva2Vucyk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIC8qKgogICAgICBAZGV2IHByb3h5IG1ldGhvZCBmb3IgV2FuZCBUb2tlbnMgcmFpc2VJbml0aWFsU3VwcGx5IG1ldGhvZCwgc28gdGhhdCBjb250cmFjdCBvd25lciBjYW4gY2FsbCB0b2tlbiBtZXRob2RzCiAgICAgIEBwYXJhbSBfc3VwcGx5IGRlbHRhIG51bWJlciBvZiB0b2tlbnMgdG8gYmUgYWRkZWQgdG8gdG90YWwgc3VwcGx5IAogICAgICBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIGlzIHN1Y2Nlc3NmdWwuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHJhaXNlSW5pdGlhbFN1cHBseSh1aW50MjU2IF9zdXBwbHkpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3N1cHBseSA+IDApOwogICAgICAgIHRva2VuLnJhaXNlSW5pdGlhbFN1cHBseShfc3VwcGx5KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgIEBkZXYgZnVuY3Rpb24gdG8gc3RhcnQgdGhlIGNyb3dkc2FsZSB3aXRoIHByZWRlZmluZWQgdGltZXNsb3RzIGFuZCBkaXNjb3VudHMuIGl0IHdpbGwgYmUgY2FsbGVkIG9uY2UgZm9yIGV2ZXJ5IGNyb3dkc2FsZSBzZXNzaW9uIGFuZCAKICAgICAgICAgICBpdCBjYW4gYmUgY2FsbGVkIG9ubHkgaXRzIG93bmVyCiAgICAgIEBwYXJhbSBfc3RhcnRUaW1lIGF0IHdoaWNoIGNyb3dkc2FsZSBiZWdpbnMKICAgICAgQHBhcmFtIF9lbmRUaW1lIGF0IHdoaWNoIGNyb3dkc2FsZSBzdG9wcwogICAgICBAcGFyYW0gX2NhcCBpcyBudW1iZXIgb2YgdG9rZW5zIGF2YWlsYWJsZSBkdXJpbmcgdGhlIGNyb3dkc2FsZQogICAgICBAcGFyYW0gX2Nyb3dzYWxlU2xvdHMgYXJyYXkgb2YgdGltZSBzbG90cwogICAgICBAcGFyYW0gX2Rpc2NvdW50ZWRSYXRlcyBhcnJheSBvZiBkaXNjb3VudHMgCiAgICAgIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gaXMgc3VjY2Vzc2Z1bAogICAgICovCiAgICBmdW5jdGlvbiBzdGFydENyb3dkc2FsZSh1aW50MjU2IF9zdGFydFRpbWUsIHVpbnQyNTYgX2VuZFRpbWUsICB1aW50MjU2IF9jYXAsIHVpbnQyNTZbXSBfY3Jvd3NhbGVTbG90cywgdWludDI1NltdIF9kaXNjb3VudGVkUmF0ZXMpIGluYWN0aXZlQ3Jvd2RTYWxlIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYm9vbCkgeyAgCiAgICAgICAgcmVxdWlyZShfY2FwID4gMCk7ICAgCiAgICAgICAgcmVxdWlyZShfY3Jvd3NhbGVTbG90cy5sZW5ndGggPiAwKTsgCiAgICAgICAgcmVxdWlyZShfY3Jvd3NhbGVTbG90cy5sZW5ndGggPT0gX2Rpc2NvdW50ZWRSYXRlcy5sZW5ndGgpOwogICAgICAgIHJlcXVpcmUoX3N0YXJ0VGltZSA+PSB1aW50MjU2KG5vdykpOyAgCiAgICAgICAgcmVxdWlyZSggX2VuZFRpbWUgPiBfc3RhcnRUaW1lKTsgCiAgICAgICAgCiAgICAgICAgLy9zZXRzIHRoZSBjb250cmFjdCBzdGF0ZSBmb3IgdGhpcyBjcm93ZHNhbGUKICAgICAgICBjYXAgPSBfY2FwICogMSBldGhlcjsgIC8vTm9ybWFsaXplZCB0aGUgY2FwIHRvIG9wZXJhdGUgYXQgd2VpIHVuaXRzIGxldmVsCiAgICAgICAgc3RhcnRUaW1lID0gX3N0YXJ0VGltZTsKICAgICAgICBlbmRUaW1lID0gX2VuZFRpbWU7ICAgIAogICAgICAgIGNyb3dkU2FsZU9uID0gdHJ1ZTsKICAgICAgICB3ZWlSYWlzZWQgPSAwOwogICAgICAgIHRva2Vuc01pbnRlZCA9IDA7CiAgICAgICAgZGlzY291bnRlZFJhdGVzID0gX2Rpc2NvdW50ZWRSYXRlczsKICAgICAgICBjcm93c2FsZVNsb3RzID0gX2Nyb3dzYWxlU2xvdHM7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9ICAKCiAgICAvKioKICAgICAgQGRldiBmdW5jdGlvbiB0byBzdG9wIGNyb3dkc2FsZSBzZXNzaW9uLml0IHdpbGwgYmUgY2FsbGVkIG9uY2UgZm9yIGV2ZXJ5IGNyb3dkc2FsZSBzZXNzaW9uIGFuZCBpdCBjYW4gYmUgY2FsbGVkIG9ubHkgaXRzIG93bmVyCiAgICAgIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gaXMgc3VjY2Vzc2Z1bAogICAgICovCiAgICBmdW5jdGlvbiBlbmRDcm93ZHNhbGUoKSBhY3RpdmVDcm93ZFNhbGUgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgZW5kVGltZSA9IG5vdzsgIAogICAgICAgIGlmKHRva2Vuc01pbnRlZCA8IGNhcCl7CiAgICAgICAgICAgIHVpbnQyNTYgbGVmdG92ZXJUb2tlbnMgPSBjYXAuc3ViKHRva2Vuc01pbnRlZCk7CiAgICAgICAgICAgIHJlcXVpcmUodG9rZW5zTWludGVkLmFkZChsZWZ0b3ZlclRva2VucykgPD0gY2FwKTsKICAgICAgICAgICAgdG9rZW5zTWludGVkID0gdG9rZW5zTWludGVkLmFkZChsZWZ0b3ZlclRva2Vucyk7CiAgICAgICAgICAgIHRva2VuLm1pbnQob3duZXIsIGxlZnRvdmVyVG9rZW5zLmRpdigxIGV0aGVyKSk7IAogICAgICAgIH0KICAgICAgICBjcm93ZFNhbGVPbiA9IGZhbHNlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfSAgIAogICAgCiAgICAvKioKICAgICAgQGRldiBmdW5jdGlvbiB0byBjYWxjdWxhdGUgYW5kIHJldHVybiB0aGUgZGlzY291bnRlZCB0b2tlbiByYXRlIGJhc2VkIG9uIHRoZSBjdXJyZW50IHRpbWVzbG90CiAgICAgIEByZXR1cm4gX2Rpc2NvdW50ZWRSYXRlIGZvciB0aGUgY3VycmVudCB0aW1lc2xvdAogICAgICovCiAgICBmdW5jdGlvbiBmaW5kRGlzY291bnQoKSBjb25zdGFudCBwcml2YXRlIHJldHVybnMgKHVpbnQyNTYgX2Rpc2NvdW50ZWRSYXRlKSB7CiAgICAgICAgdWludDI1NiBlbGFwc2VkVGltZSA9IG5vdy5zdWIoc3RhcnRUaW1lKTsKICAgICAgICBmb3IodWludCBpPTA7IGk8Y3Jvd3NhbGVTbG90cy5sZW5ndGg7IGkrKyl7CiAgICAgICAgICAgIGlmKGVsYXBzZWRUaW1lID49IGNyb3dzYWxlU2xvdHNbaV0pIHsKICAgICAgICAgICAgICAgIGVsYXBzZWRUaW1lID0gZWxhcHNlZFRpbWUuc3ViKGNyb3dzYWxlU2xvdHNbaV0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgX2Rpc2NvdW50ZWRSYXRlID0gZGlzY291bnRlZFJhdGVzW2ldOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9IAogICAgfQogICAgCiAgICAvKioKICAgICAgQGRldiAgZmFsbGJhY2sgZnVuY3Rpb24gY2FuIGJlIHVzZWQgdG8gYnV5IHRva2VucwogICAgICAqLwogICAgZnVuY3Rpb24gKCkgcGF5YWJsZSB7CiAgICAgICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwogICAgfQogIAogICAgLyoqCiAgICAgIEBkZXYgIGxvdyBsZXZlbCB0b2tlbiBwdXJjaGFzZSBmdW5jdGlvbgogICAgICAqLwogICAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnkpIGFjdGl2ZUNyb3dkU2FsZSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZShiZW5lZmljaWFyeSAhPSAweDApOyAKICAgICAgICByZXF1aXJlKG5vdyA+PSBzdGFydFRpbWUpOwogICAgICAgIHJlcXVpcmUobm93IDw9IGVuZFRpbWUpOwogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlICE9IDApOyAgIAogICAgICAgIAogICAgICAgIC8vIGFtb3VudCBldGhlciBzZW50IHRvIHRoZSBjb250cmFjdC4uIG5vcm1hbGl6ZWQgdG8gd2VpCiAgICAgICAgdWludDI1NiB3ZWlBbW91bnQgPSBtc2cudmFsdWU7IAogICAgICAgIHdlaVJhaXNlZCA9IHdlaVJhaXNlZC5hZGQod2VpQW1vdW50KTsgCiAgICAgICAgCiAgICAgICAgLy8gYXBwbHkgdGhlIGRpc2NvdW50IGJhc2VkIG9uIHRpbWVzbG90IGFuZCBnZXQgdGhlIHRva2VuIHJhdGUgKFggdG9rZW5zIHBlciAxIGV0aGVyKQogICAgICAgIHZhciBjdXJyZW50UmF0ZSA9IGZpbmREaXNjb3VudCgpOwogICAgICAgIC8vIEZpbmQgb3V0IFRva2VuIHZhbHVlIGluIHdlaSAoIFkgd2VpIHBlciAxIFRva2VuKQogICAgICAgIHVpbnQyNTYgcmF0ZSA9IHVpbnQyNTYoMSAqIDEgZXRoZXIpLmRpdihjdXJyZW50UmF0ZSk7IAogICAgICAgIHJlcXVpcmUocmF0ZSA+IDApOwogICAgICAgIC8vIEZpbmQgb3V0IHRoZSBudW1iZXIgb2YgdG9rZW5zIGZvciBnaXZlbiB3ZWkgYW5kIG5vcm1hbGl6ZSB0byBldGhlciBzbyB0aGF0IHRva2VucyBjYW4gYmUgbWludGVkCiAgICAgICAgLy8gYnkgdG9rZW4gY29udHJhY3QKICAgICAgICB1aW50MjU2IG51bVRva2VucyA9IHdlaUFtb3VudC5kaXYocmF0ZSk7IAogICAgICAgIHJlcXVpcmUobnVtVG9rZW5zID4gMCk7IAogICAgICAgIHJlcXVpcmUodG9rZW5zTWludGVkLmFkZChudW1Ub2tlbnMubXVsKDEgZXRoZXIpKSA8PSBjYXApOwogICAgICAgIHRva2Vuc01pbnRlZCA9IHRva2Vuc01pbnRlZC5hZGQobnVtVG9rZW5zLm11bCgxIGV0aGVyKSk7CiAgICAgICAgCiAgICAgICAgLy8gTWludCB0aGUgdG9rZW5zIGFuZCB0cmFzZmVyIHRvIHRoZSBidXllcgogICAgICAgIHRva2VuLm1pbnQoYmVuZWZpY2lhcnksIG51bVRva2Vucyk7CiAgICAgICAgVG9rZW5QdXJjaGFzZShtc2cuc2VuZGVyLCBiZW5lZmljaWFyeSwgd2VpQW1vdW50LCBudW1Ub2tlbnMpOyAKICAgICAgICAvLyBUcmFuc2ZlciB0aGUgZXRoZXIgdG8gV2FsbGV0IGFuZCBjbG9zZSB0aGUgcHVyY2hhc2UKICAgICAgICB3YWxsZXQudHJhbnNmZXIod2VpQW1vdW50KTsKICAgIH0gCn0='.
	

]
