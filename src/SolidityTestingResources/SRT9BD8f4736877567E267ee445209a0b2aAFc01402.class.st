Class {
	#name : #SRT9BD8f4736877567E267ee445209a0b2aAFc01402,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT9BD8f4736877567E267ee445209a0b2aAFc01402 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7Ci8qKgogKiBAdGl0bGUgRVJDMjBCYXNpYwogKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE3OQogKi8KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsgICAgICAKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQp9CmxpYnJhcnkgRGF0ZVRpbWUgewogICAgICAgIC8qCiAgICAgICAgICogIERhdGUgYW5kIFRpbWUgdXRpbGl0aWVzIGZvciBldGhlcmV1bSBjb250cmFjdHMKICAgICAgICAgKgogICAgICAgICAqLwogICAgICAgIHN0cnVjdCBNeURhdGVUaW1lIHsKICAgICAgICAgICAgICAgIHVpbnQxNiB5ZWFyOwogICAgICAgICAgICAgICAgdWludDggbW9udGg7CiAgICAgICAgICAgICAgICB1aW50OCBkYXk7CiAgICAgICAgICAgICAgICB1aW50OCBob3VyOwogICAgICAgICAgICAgICAgdWludDggbWludXRlOwogICAgICAgICAgICAgICAgdWludDggc2Vjb25kOwogICAgICAgICAgICAgICAgdWludDggd2Vla2RheTsKICAgICAgICB9CiAgICAgICAgdWludCBjb25zdGFudCBEQVlfSU5fU0VDT05EUyA9IDg2NDAwOwogICAgICAgIHVpbnQgY29uc3RhbnQgWUVBUl9JTl9TRUNPTkRTID0gMzE1MzYwMDA7CiAgICAgICAgdWludCBjb25zdGFudCBMRUFQX1lFQVJfSU5fU0VDT05EUyA9IDMxNjIyNDAwOwogICAgICAgIHVpbnQgY29uc3RhbnQgSE9VUl9JTl9TRUNPTkRTID0gMzYwMDsKICAgICAgICB1aW50IGNvbnN0YW50IE1JTlVURV9JTl9TRUNPTkRTID0gNjA7CiAgICAgICAgdWludDE2IGNvbnN0YW50IE9SSUdJTl9ZRUFSID0gMTk3MDsKICAgICAgICBmdW5jdGlvbiBpc0xlYXBZZWFyKHVpbnQxNiB5ZWFyKSBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgICAgICAgICBpZiAoeWVhciAlIDQgIT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoeWVhciAlIDEwMCAhPSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHllYXIgJSA0MDAgIT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgZnVuY3Rpb24gbGVhcFllYXJzQmVmb3JlKHVpbnQgeWVhcikgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgICAgICAgICAgeWVhciAtPSAxOwogICAgICAgICAgICAgICAgcmV0dXJuIHllYXIgLyA0IC0geWVhciAvIDEwMCArIHllYXIgLyA0MDA7CiAgICAgICAgfQogICAgICAgIGZ1bmN0aW9uIGdldERheXNJbk1vbnRoKHVpbnQ4IG1vbnRoLCB1aW50MTYgeWVhcikgY29uc3RhbnQgcmV0dXJucyAodWludDgpIHsKICAgICAgICAgICAgICAgIGlmIChtb250aCA9PSAxIHx8IG1vbnRoID09IDMgfHwgbW9udGggPT0gNSB8fCBtb250aCA9PSA3IHx8IG1vbnRoID09IDggfHwgbW9udGggPT0gMTAgfHwgbW9udGggPT0gMTIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDMxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZiAobW9udGggPT0gNCB8fCBtb250aCA9PSA2IHx8IG1vbnRoID09IDkgfHwgbW9udGggPT0gMTEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDMwOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZiAoaXNMZWFwWWVhcih5ZWFyKSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMjk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDI4OwogICAgICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBmdW5jdGlvbiBwYXJzZVRpbWVzdGFtcCh1aW50IHRpbWVzdGFtcCkgaW50ZXJuYWwgcmV0dXJucyAoTXlEYXRlVGltZSBkdCkgewogICAgICAgICAgICAgICAgdWludCBzZWNvbmRzQWNjb3VudGVkRm9yID0gMDsKICAgICAgICAgICAgICAgIHVpbnQgYnVmOwogICAgICAgICAgICAgICAgdWludDggaTsKICAgICAgICAgICAgICAgIC8vIFllYXIKICAgICAgICAgICAgICAgIGR0LnllYXIgPSBnZXRZZWFyKHRpbWVzdGFtcCk7CiAgICAgICAgICAgICAgICBidWYgPSBsZWFwWWVhcnNCZWZvcmUoZHQueWVhcikgLSBsZWFwWWVhcnNCZWZvcmUoT1JJR0lOX1lFQVIpOwogICAgICAgICAgICAgICAgc2Vjb25kc0FjY291bnRlZEZvciArPSBMRUFQX1lFQVJfSU5fU0VDT05EUyAqIGJ1ZjsKICAgICAgICAgICAgICAgIHNlY29uZHNBY2NvdW50ZWRGb3IgKz0gWUVBUl9JTl9TRUNPTkRTICogKGR0LnllYXIgLSBPUklHSU5fWUVBUiAtIGJ1Zik7CiAgICAgICAgICAgICAgICAvLyBNb250aAogICAgICAgICAgICAgICAgdWludCBzZWNvbmRzSW5Nb250aDsKICAgICAgICAgICAgICAgIGZvciAoaSA9IDE7IGkgPD0gMTI7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRzSW5Nb250aCA9IERBWV9JTl9TRUNPTkRTICogZ2V0RGF5c0luTW9udGgoaSwgZHQueWVhcik7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWNvbmRzSW5Nb250aCArIHNlY29uZHNBY2NvdW50ZWRGb3IgPiB0aW1lc3RhbXApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdC5tb250aCA9IGk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgc2Vjb25kc0FjY291bnRlZEZvciArPSBzZWNvbmRzSW5Nb250aDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIERheQogICAgICAgICAgICAgICAgZm9yIChpID0gMTsgaSA8PSBnZXREYXlzSW5Nb250aChkdC5tb250aCwgZHQueWVhcik7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoREFZX0lOX1NFQ09ORFMgKyBzZWNvbmRzQWNjb3VudGVkRm9yID4gdGltZXN0YW1wKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHQuZGF5ID0gaTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRzQWNjb3VudGVkRm9yICs9IERBWV9JTl9TRUNPTkRTOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gSG91cgogICAgICAgICAgICAgICAgZHQuaG91ciA9IDA7Ly9nZXRIb3VyKHRpbWVzdGFtcCk7CiAgICAgICAgICAgICAgICAvLyBNaW51dGUKICAgICAgICAgICAgICAgIGR0Lm1pbnV0ZSA9IDA7Ly9nZXRNaW51dGUodGltZXN0YW1wKTsKICAgICAgICAgICAgICAgIC8vIFNlY29uZAogICAgICAgICAgICAgICAgZHQuc2Vjb25kID0gMDsvL2dldFNlY29uZCh0aW1lc3RhbXApOwogICAgICAgICAgICAgICAgLy8gRGF5IG9mIHdlZWsuCiAgICAgICAgICAgICAgICBkdC53ZWVrZGF5ID0gMDsvL2dldFdlZWtkYXkodGltZXN0YW1wKTsKICAgICAgICB9CiAgICAgICAgZnVuY3Rpb24gZ2V0WWVhcih1aW50IHRpbWVzdGFtcCkgY29uc3RhbnQgcmV0dXJucyAodWludDE2KSB7CiAgICAgICAgICAgICAgICB1aW50IHNlY29uZHNBY2NvdW50ZWRGb3IgPSAwOwogICAgICAgICAgICAgICAgdWludDE2IHllYXI7CiAgICAgICAgICAgICAgICB1aW50IG51bUxlYXBZZWFyczsKICAgICAgICAgICAgICAgIC8vIFllYXIKICAgICAgICAgICAgICAgIHllYXIgPSB1aW50MTYoT1JJR0lOX1lFQVIgKyB0aW1lc3RhbXAgLyBZRUFSX0lOX1NFQ09ORFMpOwogICAgICAgICAgICAgICAgbnVtTGVhcFllYXJzID0gbGVhcFllYXJzQmVmb3JlKHllYXIpIC0gbGVhcFllYXJzQmVmb3JlKE9SSUdJTl9ZRUFSKTsKICAgICAgICAgICAgICAgIHNlY29uZHNBY2NvdW50ZWRGb3IgKz0gTEVBUF9ZRUFSX0lOX1NFQ09ORFMgKiBudW1MZWFwWWVhcnM7CiAgICAgICAgICAgICAgICBzZWNvbmRzQWNjb3VudGVkRm9yICs9IFlFQVJfSU5fU0VDT05EUyAqICh5ZWFyIC0gT1JJR0lOX1lFQVIgLSBudW1MZWFwWWVhcnMpOwogICAgICAgICAgICAgICAgd2hpbGUgKHNlY29uZHNBY2NvdW50ZWRGb3IgPiB0aW1lc3RhbXApIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzTGVhcFllYXIodWludDE2KHllYXIgLSAxKSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRzQWNjb3VudGVkRm9yIC09IExFQVBfWUVBUl9JTl9TRUNPTkRTOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZHNBY2NvdW50ZWRGb3IgLT0gWUVBUl9JTl9TRUNPTkRTOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHllYXIgLT0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB5ZWFyOwogICAgICAgIH0KICAgICAgICBmdW5jdGlvbiBnZXRNb250aCh1aW50IHRpbWVzdGFtcCkgY29uc3RhbnQgcmV0dXJucyAodWludDgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZVRpbWVzdGFtcCh0aW1lc3RhbXApLm1vbnRoOwogICAgICAgIH0KICAgICAgICBmdW5jdGlvbiBnZXREYXkodWludCB0aW1lc3RhbXApIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VUaW1lc3RhbXAodGltZXN0YW1wKS5kYXk7CiAgICAgICAgfQogICAgICAgIGZ1bmN0aW9uIGdldEhvdXIodWludCB0aW1lc3RhbXApIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdWludDgoKHRpbWVzdGFtcCAvIDYwIC8gNjApICUgMjQpOwogICAgICAgIH0KICAgICAgICBmdW5jdGlvbiBnZXRNaW51dGUodWludCB0aW1lc3RhbXApIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdWludDgoKHRpbWVzdGFtcCAvIDYwKSAlIDYwKTsKICAgICAgICB9CiAgICAgICAgZnVuY3Rpb24gZ2V0U2Vjb25kKHVpbnQgdGltZXN0YW1wKSBjb25zdGFudCByZXR1cm5zICh1aW50OCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHVpbnQ4KHRpbWVzdGFtcCAlIDYwKTsKICAgICAgICB9CiAgICAgICAgZnVuY3Rpb24gdG9UaW1lc3RhbXAodWludDE2IHllYXIsIHVpbnQ4IG1vbnRoLCB1aW50OCBkYXkpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgdGltZXN0YW1wKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdG9UaW1lc3RhbXAoeWVhciwgbW9udGgsIGRheSwgMCwgMCwgMCk7CiAgICAgICAgfQogICAgICAgIGZ1bmN0aW9uIHRvVGltZXN0YW1wKHVpbnQxNiB5ZWFyLCB1aW50OCBtb250aCwgdWludDggZGF5LCB1aW50OCBob3VyLCB1aW50OCBtaW51dGUsIHVpbnQ4IHNlY29uZCkgY29uc3RhbnQgcmV0dXJucyAodWludCB0aW1lc3RhbXApIHsKICAgICAgICAgICAgICAgIHVpbnQxNiBpOwogICAgICAgICAgICAgICAgLy8gWWVhcgogICAgICAgICAgICAgICAgZm9yIChpID0gT1JJR0lOX1lFQVI7IGkgPCB5ZWFyOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzTGVhcFllYXIoaSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXAgKz0gTEVBUF9ZRUFSX0lOX1NFQ09ORFM7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZXN0YW1wICs9IFlFQVJfSU5fU0VDT05EUzsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gTW9udGgKICAgICAgICAgICAgICAgIHVpbnQ4WzEyXSBtZW1vcnkgbW9udGhEYXlDb3VudHM7CiAgICAgICAgICAgICAgICBtb250aERheUNvdW50c1swXSA9IDMxOwogICAgICAgICAgICAgICAgaWYgKGlzTGVhcFllYXIoeWVhcikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbW9udGhEYXlDb3VudHNbMV0gPSAyOTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBtb250aERheUNvdW50c1sxXSA9IDI4OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbW9udGhEYXlDb3VudHNbMl0gPSAzMTsKICAgICAgICAgICAgICAgIG1vbnRoRGF5Q291bnRzWzNdID0gMzA7CiAgICAgICAgICAgICAgICBtb250aERheUNvdW50c1s0XSA9IDMxOwogICAgICAgICAgICAgICAgbW9udGhEYXlDb3VudHNbNV0gPSAzMDsKICAgICAgICAgICAgICAgIG1vbnRoRGF5Q291bnRzWzZdID0gMzE7CiAgICAgICAgICAgICAgICBtb250aERheUNvdW50c1s3XSA9IDMxOwogICAgICAgICAgICAgICAgbW9udGhEYXlDb3VudHNbOF0gPSAzMDsKICAgICAgICAgICAgICAgIG1vbnRoRGF5Q291bnRzWzldID0gMzE7CiAgICAgICAgICAgICAgICBtb250aERheUNvdW50c1sxMF0gPSAzMDsKICAgICAgICAgICAgICAgIG1vbnRoRGF5Q291bnRzWzExXSA9IDMxOwogICAgICAgICAgICAgICAgZm9yIChpID0gMTsgaSA8IG1vbnRoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGltZXN0YW1wICs9IERBWV9JTl9TRUNPTkRTICogbW9udGhEYXlDb3VudHNbaSAtIDFdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gRGF5CiAgICAgICAgICAgICAgICB0aW1lc3RhbXAgKz0gREFZX0lOX1NFQ09ORFMgKiAoZGF5IC0gMSk7CiAgICAgICAgICAgICAgICAvLyBIb3VyCiAgICAgICAgICAgICAgICB0aW1lc3RhbXAgKz0gSE9VUl9JTl9TRUNPTkRTICogKGhvdXIpOwogICAgICAgICAgICAgICAgLy8gTWludXRlCiAgICAgICAgICAgICAgICB0aW1lc3RhbXAgKz0gTUlOVVRFX0lOX1NFQ09ORFMgKiAobWludXRlKTsKICAgICAgICAgICAgICAgIC8vIFNlY29uZAogICAgICAgICAgICAgICAgdGltZXN0YW1wICs9IHNlY29uZDsKICAgICAgICAgICAgICAgIHJldHVybiB0aW1lc3RhbXA7CiAgICAgICAgfQp9Ci8qKgogKiBAdGl0bGUgQ2xhaW1hYmxlCiAqIEBkZXYgRXh0ZW5zaW9uIGZvciB0aGUgT3duYWJsZSBjb250cmFjdCwgd2hlcmUgdGhlIG93bmVyc2hpcCBuZWVkcyB0byBiZSBjbGFpbWVkLgogKiBUaGlzIGFsbG93cyB0aGUgbmV3IG93bmVyIHRvIGFjY2VwdCB0aGUgdHJhbnNmZXIuCiAqLwpjb250cmFjdCBDbGFpbWFibGUgaXMgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgcGVuZGluZ093bmVyOwogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBwZW5kaW5nT3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seVBlbmRpbmdPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBwZW5kaW5nT3duZXIpOwogICAgXzsKICB9CiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gc2V0IHRoZSBwZW5kaW5nT3duZXIgYWRkcmVzcy4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciB7CiAgICBwZW5kaW5nT3duZXIgPSBuZXdPd25lcjsKICB9CiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIHBlbmRpbmdPd25lciBhZGRyZXNzIHRvIGZpbmFsaXplIHRoZSB0cmFuc2Zlci4KICAgKi8KICBmdW5jdGlvbiBjbGFpbU93bmVyc2hpcCgpIG9ubHlQZW5kaW5nT3duZXIgewogICAgb3duZXIgPSBwZW5kaW5nT3duZXI7CiAgICBwZW5kaW5nT3duZXIgPSAweDA7CiAgfQp9CmNvbnRyYWN0IE9wZXJhdGlvbmFsIGlzIENsYWltYWJsZSB7CiAgICBhZGRyZXNzIHB1YmxpYyBvcGVyYXRvcjsKICAgIGZ1bmN0aW9uIE9wZXJhdGlvbmFsKGFkZHJlc3MgX29wZXJhdG9yKSB7CiAgICAgIG9wZXJhdG9yID0gX29wZXJhdG9yOwogICAgfQogICAgbW9kaWZpZXIgb25seU9wZXJhdG9yKCkgewogICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3BlcmF0b3IpOwogICAgICBfOwogICAgfQogICAgZnVuY3Rpb24gdHJhbnNmZXJPcGVyYXRvcihhZGRyZXNzIG5ld09wZXJhdG9yKSBvbmx5T3duZXIgewogICAgICByZXF1aXJlKG5ld09wZXJhdG9yICE9IGFkZHJlc3MoMCkpOwogICAgICBvcGVyYXRvciA9IG5ld09wZXJhdG9yOwogICAgfQp9Ci8qKgogKiBAdGl0bGUgU2FmZU1hdGgKICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCmxpYnJhcnkgU2FmZU1hdGggewogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9Ci8qKgogKiBAdGl0bGUgQmFzaWMgdG9rZW4KICogQGRldiBCYXNpYyB2ZXJzaW9uIG9mIFN0YW5kYXJkVG9rZW4sIHdpdGggbm8gYWxsb3dhbmNlcy4gCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsKICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4gCiAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KfQovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQovKioKICogQHRpdGxlIFN0YW5kYXJkIEVSQzIwIHRva2VuCiAqCiAqIEBkZXYgSW1wbGVtZW50YXRpb24gb2YgdGhlIGJhc2ljIHN0YW5kYXJkIHRva2VuLgogKiBAZGV2IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgRmlyc3RCbG9vZDogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sCiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdXQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICB2YXIgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOwogICAgLy8gQ2hlY2sgaXMgbm90IG5lZWRlZCBiZWNhdXNlIHN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0CiAgICAvLyByZXF1aXJlIChfdmFsdWUgPD0gX2FsbG93YW5jZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgLyoqCiAgICogQGRldiBBcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICAvLyBUbyBjaGFuZ2UgdGhlIGFwcHJvdmUgYW1vdW50IHlvdSBmaXJzdCBoYXZlIHRvIHJlZHVjZSB0aGUgYWRkcmVzc2VzYAogICAgLy8gIGFsbG93YW5jZSB0byB6ZXJvIGJ5IGNhbGxpbmcgYGFwcHJvdmUoX3NwZW5kZXIsIDApYCBpZiBpdCBpcyBub3QKICAgIC8vICBhbHJlYWR5IDAgdG8gbWl0aWdhdGUgdGhlIHJhY2UgY29uZGl0aW9uIGRlc2NyaWJlZCBoZXJlOgogICAgLy8gIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICByZXF1aXJlKChfdmFsdWUgPT0gMCkgfHwgKGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID09IDApKTsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgKi8KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9Cn0KLyoqCiAqIEB0aXRsZSBIZWxwcyBjb250cmFjdHMgZ3VhcmQgYWdhaW5zIHJlbnRyYW5jeSBhdHRhY2tzLgogKiBAYXV0aG9yIFJlbWNvIEJsb2VtZW4gPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iOGRmZmU4ZTBlZWUyY2RiZiI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj7PgC5jb20+CiAqIEBub3RpY2UgSWYgeW91IG1hcmsgYSBmdW5jdGlvbiBgbm9uUmVlbnRyYW50YCwgeW91IHNob3VsZCBhbHNvCiAqIG1hcmsgaXQgYGV4dGVybmFsYC4KICovCmNvbnRyYWN0IFJlZW50cmFuY3lHdWFyZCB7CiAgLyoqCiAgICogQGRldiBXZSB1c2UgYSBzaW5nbGUgbG9jayBmb3IgdGhlIHdob2xlIGNvbnRyYWN0LgogICAqLwogIGJvb2wgcHJpdmF0ZSByZW50cmFuY3lfbG9jayA9IGZhbHNlOwogIC8qKgogICAqIEBkZXYgUHJldmVudHMgYSBjb250cmFjdCBmcm9tIGNhbGxpbmcgaXRzZWxmLCBkaXJlY3RseSBvciBpbmRpcmVjdGx5LgogICAqIEBub3RpY2UgSWYgeW91IG1hcmsgYSBmdW5jdGlvbiBgbm9uUmVlbnRyYW50YCwgeW91IHNob3VsZCBhbHNvCiAgICogbWFyayBpdCBgZXh0ZXJuYWxgLiBDYWxsaW5nIG9uZSBub25SZWVudHJhbnQgZnVuY3Rpb24gZnJvbQogICAqIGFub3RoZXIgaXMgbm90IHN1cHBvcnRlZC4gSW5zdGVhZCwgeW91IGNhbiBpbXBsZW1lbnQgYQogICAqIGBwcml2YXRlYCBmdW5jdGlvbiBkb2luZyB0aGUgYWN0dWFsIHdvcmssIGFuZCBhIGBleHRlcm5hbGAKICAgKiB3cmFwcGVyIG1hcmtlZCBhcyBgbm9uUmVlbnRyYW50YC4KICAgKi8KICBtb2RpZmllciBub25SZWVudHJhbnQoKSB7CiAgICByZXF1aXJlKCFyZW50cmFuY3lfbG9jayk7CiAgICByZW50cmFuY3lfbG9jayA9IHRydWU7CiAgICBfOwogICAgcmVudHJhbmN5X2xvY2sgPSBmYWxzZTsKICB9Cn0KLyoqCiAqIEB0aXRsZSBCdXJuYWJsZSBUb2tlbgogKiBAZGV2IFRva2VuIHRoYXQgY2FuIGJlIGlycmV2ZXJzaWJseSBidXJuZWQgKGRlc3Ryb3llZCkuCiAqLwpjb250cmFjdCBCdXJuYWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4gewogICAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgYnVybmVyLCB1aW50MjU2IHZhbHVlKTsKICAgIC8qKgogICAgICogQGRldiBCdXJucyBhIHNwZWNpZmljIGFtb3VudCBvZiB0b2tlbnMuCiAgICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgYnVybmVkLgogICAgICovCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3ZhbHVlID4gMCk7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwogICAgICAgIC8vIG5vIG5lZWQgdG8gcmVxdWlyZSB2YWx1ZSA8PSB0b3RhbFN1cHBseSwgc2luY2UgdGhhdCB3b3VsZCBpbXBseSB0aGUKICAgICAgICAvLyBzZW5kZXIncyBiYWxhbmNlIGlzIGdyZWF0ZXIgdGhhbiB0aGUgdG90YWxTdXBwbHksIHdoaWNoICpzaG91bGQqIGJlIGFuIGFzc2VydGlvbiBmYWlsdXJlCiAgICAgICAgYWRkcmVzcyBidXJuZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIGJhbGFuY2VzW2J1cm5lcl0gPSBiYWxhbmNlc1tidXJuZXJdLnN1YihfdmFsdWUpOwogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuc3ViKF92YWx1ZSk7CiAgICAgICAgQnVybihidXJuZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0KY29udHJhY3QgRnJvemVuYWJsZVRva2VuIGlzIE9wZXJhdGlvbmFsLCBCdXJuYWJsZVRva2VuLCBSZWVudHJhbmN5R3VhcmQgewogICAgdWludDI1NiBwdWJsaWMgY3JlYXRlVGltZTsKICAgIHN0cnVjdCBGcm96ZW5CYWxhbmNlIHsKICAgICAgICBhZGRyZXNzIG93bmVyOwogICAgICAgIHVpbnQyNTYgdmFsdWU7CiAgICAgICAgdWludDI1NiB1bkZyb3plblRpbWU7CiAgICB9CiAgICBtYXBwaW5nICh1aW50ID0+IEZyb3plbkJhbGFuY2UpIHB1YmxpYyBmcm96ZW5CYWxhbmNlczsKICAgIHVpbnQgcHVibGljIGZyb3plbkJhbGFuY2VDb3VudDsKICAgIGV2ZW50IEZyZWV6ZShhZGRyZXNzIGluZGV4ZWQgb3duZXIsIHVpbnQyNTYgdmFsdWUsIHVpbnQyNTYgcmVsZWFzZVRpbWUpOwogICAgZXZlbnQgRnJlZXplRm9yT3duZXIoYWRkcmVzcyBpbmRleGVkIG93bmVyLCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IHJlbGVhc2VUaW1lKTsKICAgIGV2ZW50IFVuZnJlZXplKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgdWludDI1NiB2YWx1ZSwgdWludDI1NiByZWxlYXNlVGltZSk7CiAgICAvLyBmcmVlemUgX3ZhbHVlIHRva2VuIHRvIF91bkZyb3plblRpbWUKICAgIGZ1bmN0aW9uIGZyZWV6ZSh1aW50MjU2IF92YWx1ZSwgdWludDI1NiBfdW5Gcm96ZW5UaW1lKSBub25SZWVudHJhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlKTsKICAgICAgICByZXF1aXJlKF91bkZyb3plblRpbWUgPiBjcmVhdGVUaW1lKTsKICAgICAgICByZXF1aXJlKF91bkZyb3plblRpbWUgPiBub3cpOwogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgZnJvemVuQmFsYW5jZXNbZnJvemVuQmFsYW5jZUNvdW50XSA9IEZyb3plbkJhbGFuY2Uoe293bmVyOiBtc2cuc2VuZGVyLCB2YWx1ZTogX3ZhbHVlLCB1bkZyb3plblRpbWU6IF91bkZyb3plblRpbWV9KTsKICAgICAgICBmcm96ZW5CYWxhbmNlQ291bnQrKzsKICAgICAgICBGcmVlemUobXNnLnNlbmRlciwgX3ZhbHVlLCBfdW5Gcm96ZW5UaW1lKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIGZ1bmN0aW9uIGZyZWV6ZUZvck93bmVyKHVpbnQyNTYgX3ZhbHVlLCB1aW50MjU2IF91bkZyb3plblRpbWUpIG9ubHlPcGVyYXRvciByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXF1aXJlKGJhbGFuY2VzW293bmVyXSA+PSBfdmFsdWUpOwogICAgICAgIHJlcXVpcmUoX3VuRnJvemVuVGltZSA+IGNyZWF0ZVRpbWUpOwogICAgICAgIHJlcXVpcmUoX3VuRnJvemVuVGltZSA+IG5vdyk7CiAgICAgICAgYmFsYW5jZXNbb3duZXJdID0gYmFsYW5jZXNbb3duZXJdLnN1YihfdmFsdWUpOwogICAgICAgIGZyb3plbkJhbGFuY2VzW2Zyb3plbkJhbGFuY2VDb3VudF0gPSBGcm96ZW5CYWxhbmNlKHtvd25lcjogb3duZXIsIHZhbHVlOiBfdmFsdWUsIHVuRnJvemVuVGltZTogX3VuRnJvemVuVGltZX0pOwogICAgICAgIGZyb3plbkJhbGFuY2VDb3VudCsrOwogICAgICAgIEZyZWV6ZUZvck93bmVyKG93bmVyLCBfdmFsdWUsIF91bkZyb3plblRpbWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLy8gZ2V0IGZyb3plbiBiYWxhbmNlCiAgICBmdW5jdGlvbiBmcm96ZW5CYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgdmFsdWUpIHsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBmcm96ZW5CYWxhbmNlQ291bnQ7IGkrKykgewogICAgICAgICAgICBGcm96ZW5CYWxhbmNlIHN0b3JhZ2UgZnJvemVuQmFsYW5jZSA9IGZyb3plbkJhbGFuY2VzW2ldOwogICAgICAgICAgICBpZiAoX293bmVyID09IGZyb3plbkJhbGFuY2Uub3duZXIpIHsKICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUuYWRkKGZyb3plbkJhbGFuY2UudmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KICAgIC8vIHVuZnJlZXplIGZyb3plbiBhbW91bnQKICAgIGZ1bmN0aW9uIHVuZnJlZXplKCkgcmV0dXJucyAodWludDI1NiByZWxlYXNlQW1vdW50KSB7CiAgICAgICAgdWludCBpbmRleCA9IDA7CiAgICAgICAgd2hpbGUgKGluZGV4IDwgZnJvemVuQmFsYW5jZUNvdW50KSB7CiAgICAgICAgICAgIGlmIChub3cgPj0gZnJvemVuQmFsYW5jZXNbaW5kZXhdLnVuRnJvemVuVGltZSkgewogICAgICAgICAgICAgICAgcmVsZWFzZUFtb3VudCArPSBmcm96ZW5CYWxhbmNlc1tpbmRleF0udmFsdWU7CiAgICAgICAgICAgICAgICB1bkZyb3plbkJhbGFuY2VCeUluZGV4KGluZGV4KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGluZGV4Kys7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlbGVhc2VBbW91bnQ7CiAgICB9CiAgICBmdW5jdGlvbiB1bkZyb3plbkJhbGFuY2VCeUluZGV4KHVpbnQgaW5kZXgpIGludGVybmFsIHsKICAgICAgICBGcm96ZW5CYWxhbmNlIHN0b3JhZ2UgZnJvemVuQmFsYW5jZSA9IGZyb3plbkJhbGFuY2VzW2luZGV4XTsKICAgICAgICBiYWxhbmNlc1tmcm96ZW5CYWxhbmNlLm93bmVyXSA9IGJhbGFuY2VzW2Zyb3plbkJhbGFuY2Uub3duZXJdLmFkZChmcm96ZW5CYWxhbmNlLnZhbHVlKTsKICAgICAgICBVbmZyZWV6ZShmcm96ZW5CYWxhbmNlLm93bmVyLCBmcm96ZW5CYWxhbmNlLnZhbHVlLCBmcm96ZW5CYWxhbmNlLnVuRnJvemVuVGltZSk7CiAgICAgICAgZnJvemVuQmFsYW5jZXNbaW5kZXhdID0gZnJvemVuQmFsYW5jZXNbZnJvemVuQmFsYW5jZUNvdW50IC0gMV07CiAgICAgICAgZGVsZXRlIGZyb3plbkJhbGFuY2VzW2Zyb3plbkJhbGFuY2VDb3VudCAtIDFdOwogICAgICAgIGZyb3plbkJhbGFuY2VDb3VudC0tOwogICAgfQp9CmNvbnRyYWN0IERyYWdvblJlbGVhc2VhYmxlVG9rZW4gaXMgRnJvemVuYWJsZVRva2VuIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwogICAgdXNpbmcgRGF0ZVRpbWUgZm9yIHVpbnQyNTY7CiAgICB1aW50MjU2IHN0YW5kYXJkRGVjaW1hbHMgPSAxMDAwMDAwMDA7IC8vIG1hdGNoIGRlY2ltYWxzCiAgICB1aW50MjU2IHB1YmxpYyBhd2FyZCA9IHN0YW5kYXJkRGVjaW1hbHMubXVsKDUxMjAwKTsgLy8gYXdhcmQgcGVyIGRheQogICAgZXZlbnQgUmVsZWFzZVN1cHBseShhZGRyZXNzIGluZGV4ZWQgcmVjZWl2ZXIsIHVpbnQyNTYgdmFsdWUsIHVpbnQyNTYgcmVsZWFzZVRpbWUpOwogICAgc3RydWN0IFJlbGVhc2VSZWNvcmQgewogICAgICAgIHVpbnQyNTYgYW1vdW50OyAvLyByZWxlYXNlIGFtb3VudAogICAgICAgIHVpbnQyNTYgcmVsZWFzZWRUaW1lOyAvLyByZWxlYXNlIHRpbWUKICAgIH0KICAgIG1hcHBpbmcgKHVpbnQgPT4gUmVsZWFzZVJlY29yZCkgcHVibGljIHJlbGVhc2VkUmVjb3JkczsKICAgIHVpbnQgcHVibGljIHJlbGVhc2VkUmVjb3Jkc0NvdW50ID0gMDsKICAgIGZ1bmN0aW9uIERyYWdvblJlbGVhc2VhYmxlVG9rZW4oCiAgICAgICAgICAgICAgICAgICAgYWRkcmVzcyBvcGVyYXRvcgogICAgICAgICAgICAgICAgKSBPcGVyYXRpb25hbChvcGVyYXRvcikgewogICAgICAgIGNyZWF0ZVRpbWUgPSAxNTA5NTgwODAwOwogICAgfQogICAgZnVuY3Rpb24gcmVsZWFzZVN1cHBseSh1aW50MjU2IHRpbWVzdGFtcCkgb25seU9wZXJhdG9yIHJldHVybnModWludDI1NiBfYWN0dWFsUmVsZWFzZSkgewogICAgICAgIHJlcXVpcmUodGltZXN0YW1wID49IGNyZWF0ZVRpbWUgJiYgdGltZXN0YW1wIDw9IG5vdyk7CiAgICAgICAgcmVxdWlyZSghanVkZ2VSZWxlYXNlUmVjb3JkRXhpc3QodGltZXN0YW1wKSk7CiAgICAgICAgdXBkYXRlQXdhcmQodGltZXN0YW1wKTsKICAgICAgICBiYWxhbmNlc1tvd25lcl0gPSBiYWxhbmNlc1tvd25lcl0uYWRkKGF3YXJkKTsKICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChhd2FyZCk7CiAgICAgICAgcmVsZWFzZWRSZWNvcmRzW3JlbGVhc2VkUmVjb3Jkc0NvdW50XSA9IFJlbGVhc2VSZWNvcmQoYXdhcmQsIHRpbWVzdGFtcCk7CiAgICAgICAgcmVsZWFzZWRSZWNvcmRzQ291bnQrKzsKICAgICAgICBSZWxlYXNlU3VwcGx5KG93bmVyLCBhd2FyZCwgdGltZXN0YW1wKTsKICAgICAgICByZXR1cm4gYXdhcmQ7CiAgICB9CiAgICBmdW5jdGlvbiBqdWRnZVJlbGVhc2VSZWNvcmRFeGlzdCh1aW50MjU2IHRpbWVzdGFtcCkgaW50ZXJuYWwgcmV0dXJucyhib29sIF9leGlzdCkgewogICAgICAgIGJvb2wgZXhpc3QgPSBmYWxzZTsKICAgICAgICBpZiAocmVsZWFzZWRSZWNvcmRzQ291bnQgPiAwKSB7CiAgICAgICAgICAgIGZvciAodWludCBpbmRleCA9IDA7IGluZGV4IDwgcmVsZWFzZWRSZWNvcmRzQ291bnQ7IGluZGV4KyspIHsKICAgICAgICAgICAgICAgIGlmICgocmVsZWFzZWRSZWNvcmRzW2luZGV4XS5yZWxlYXNlZFRpbWUucGFyc2VUaW1lc3RhbXAoKS55ZWFyID09IHRpbWVzdGFtcC5wYXJzZVRpbWVzdGFtcCgpLnllYXIpCiAgICAgICAgICAgICAgICAgICAgJiYgKHJlbGVhc2VkUmVjb3Jkc1tpbmRleF0ucmVsZWFzZWRUaW1lLnBhcnNlVGltZXN0YW1wKCkubW9udGggPT0gdGltZXN0YW1wLnBhcnNlVGltZXN0YW1wKCkubW9udGgpCiAgICAgICAgICAgICAgICAgICAgJiYgKHJlbGVhc2VkUmVjb3Jkc1tpbmRleF0ucmVsZWFzZWRUaW1lLnBhcnNlVGltZXN0YW1wKCkuZGF5ID09IHRpbWVzdGFtcC5wYXJzZVRpbWVzdGFtcCgpLmRheSkpIHsKICAgICAgICAgICAgICAgICAgICBleGlzdCA9IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGV4aXN0OwogICAgfQogICAgZnVuY3Rpb24gdXBkYXRlQXdhcmQodWludDI1NiB0aW1lc3RhbXApIGludGVybmFsIHsKICAgICAgICBpZiAodGltZXN0YW1wIDwgY3JlYXRlVGltZS5hZGQoMSB5ZWFycykpIHsKICAgICAgICAgICAgYXdhcmQgPSBzdGFuZGFyZERlY2ltYWxzLm11bCg1MTIwMCk7CiAgICAgICAgfSBlbHNlIGlmICh0aW1lc3RhbXAgPCBjcmVhdGVUaW1lLmFkZCgyIHllYXJzKSkgewogICAgICAgICAgICBhd2FyZCA9IHN0YW5kYXJkRGVjaW1hbHMubXVsKDI1NjAwKTsKICAgICAgICB9IGVsc2UgaWYgKHRpbWVzdGFtcCA8IGNyZWF0ZVRpbWUuYWRkKDMgeWVhcnMpKSB7CiAgICAgICAgICAgIGF3YXJkID0gc3RhbmRhcmREZWNpbWFscy5tdWwoMTI4MDApOwogICAgICAgIH0gZWxzZSBpZiAodGltZXN0YW1wIDwgY3JlYXRlVGltZS5hZGQoNCB5ZWFycykpIHsKICAgICAgICAgICAgYXdhcmQgPSBzdGFuZGFyZERlY2ltYWxzLm11bCg2NDAwKTsKICAgICAgICB9IGVsc2UgaWYgKHRpbWVzdGFtcCA8IGNyZWF0ZVRpbWUuYWRkKDUgeWVhcnMpKSB7CiAgICAgICAgICAgIGF3YXJkID0gc3RhbmRhcmREZWNpbWFscy5tdWwoMzIwMCk7CiAgICAgICAgfSBlbHNlIGlmICh0aW1lc3RhbXAgPCBjcmVhdGVUaW1lLmFkZCg2IHllYXJzKSkgewogICAgICAgICAgICBhd2FyZCA9IHN0YW5kYXJkRGVjaW1hbHMubXVsKDE2MDApOwogICAgICAgIH0gZWxzZSBpZiAodGltZXN0YW1wIDwgY3JlYXRlVGltZS5hZGQoNyB5ZWFycykpIHsKICAgICAgICAgICAgYXdhcmQgPSBzdGFuZGFyZERlY2ltYWxzLm11bCg4MDApOwogICAgICAgIH0gZWxzZSBpZiAodGltZXN0YW1wIDwgY3JlYXRlVGltZS5hZGQoOCB5ZWFycykpIHsKICAgICAgICAgICAgYXdhcmQgPSBzdGFuZGFyZERlY2ltYWxzLm11bCg0MDApOwogICAgICAgIH0gZWxzZSBpZiAodGltZXN0YW1wIDwgY3JlYXRlVGltZS5hZGQoOSB5ZWFycykpIHsKICAgICAgICAgICAgYXdhcmQgPSBzdGFuZGFyZERlY2ltYWxzLm11bCgyMDApOwogICAgICAgIH0gZWxzZSBpZiAodGltZXN0YW1wIDwgY3JlYXRlVGltZS5hZGQoMTAgeWVhcnMpKSB7CiAgICAgICAgICAgIGF3YXJkID0gc3RhbmRhcmREZWNpbWFscy5tdWwoMTAwKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhd2FyZCA9IDA7CiAgICAgICAgfQogICAgfQp9CmNvbnRyYWN0IERyYWdvblRva2VuIGlzIERyYWdvblJlbGVhc2VhYmxlVG9rZW4gewogICAgc3RyaW5nIHB1YmxpYyBzdGFuZGFyZCA9ICcyMDE3MTExNTA0JzsKICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICdEcmFnb25Ub2tlbic7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbCA9ICdEVCc7CiAgICB1aW50OCBwdWJsaWMgZGVjaW1hbHMgPSA4OwogICAgZnVuY3Rpb24gRHJhZ29uVG9rZW4oCiAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3Mgb3BlcmF0b3IKICAgICAgICAgICAgICAgICAgICAgKSBEcmFnb25SZWxlYXNlYWJsZVRva2VuKG9wZXJhdG9yKSB7fQp9'.
	

]
