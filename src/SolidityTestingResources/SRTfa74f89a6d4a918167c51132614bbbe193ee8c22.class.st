Class {
	#name : #SRTfa74f89a6d4a918167c51132614bbbe193ee8c22,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTfa74f89a6d4a918167c51132614bbbe193ee8c22 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7Cgpjb250cmFjdCBBbGxvY2F0aW9uQWRkcmVzc0xpc3QgewoKICBhZGRyZXNzW10gcHVibGljIGFsbG9jYXRpb25BZGRyZXNzTGlzdDsKfQoKY29udHJhY3QgRVJDMjIzUmVjZWl2aW5nQ29udHJhY3QgewogIC8vIEFVRElUW0NIRi0wOF0gVGhlIG5hbWUgb2YgdGhlIHRva2VuIHRyYW5zZmVyICJmYWxsYmFjayIgZnVuY3Rpb24uCiAgLy8KICAvLyBUaGVyZSB3ZXJlIHN1Z2dlc3Rpb25zIHRvIGNoYW5nZSB0aGUgInN0YW5hcmQiIGZhbGxiYWNrIGZ1bmN0aW9uIG5hbWUKICAvLyB0byAib25Ub2tlblJlY2VpdmVkIiwgc2VlCiAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIyMyNpc3N1ZWNvbW1lbnQtMzI3NzA5MjI2CiAgLy8gU2VlIGFsc28gaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzc3Ny4KICBmdW5jdGlvbiB0b2tlbkZhbGxiYWNrKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljOwp9Cgpjb250cmFjdCBFUkMyMjNUb2tlbiB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIC8vIHRva2VuIGNvbnN0YW50cwogIHN0cmluZyBwdWJsaWMgbmFtZTsKICBieXRlczMyIHB1YmxpYyBzeW1ib2w7CiAgdWludDggcHVibGljIGRlY2ltYWxzOwogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwoKICAvLyB0b2tlbiBiYWxhbmNlcwogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgYmFsYW5jZU9mOwoKICAvLyBGdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCB3aGVuIGEgdXNlciBvciBhbm90aGVyIGNvbnRyYWN0IHdhbnRzIHRvIHRyYW5zZmVyIGZ1bmRzIC4KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlLCBieXRlcyBkYXRhKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgLy8gU3RhbmRhcmQgZnVuY3Rpb24gdHJhbnNmZXIgc2ltaWxhciB0byBFUkMyMCB0cmFuc2ZlciB3aXRoIG5vIF9kYXRhIC4KICAgIC8vIEFkZGVkIGR1ZSB0byBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSByZWFzb25zIC4KICAgIHVpbnQyNTYgY29kZUxlbmd0aDsKCiAgICBhc3NlbWJseSB7CiAgICAgIC8vIFJldHJpZXZlIHRoZSBzaXplIG9mIHRoZSBjb2RlIG9uIHRhcmdldCBhZGRyZXNzLCB0aGlzIG5lZWRzIGFzc2VtYmx5IC4KICAgICAgY29kZUxlbmd0aCA6PSBleHRjb2Rlc2l6ZSh0bykKICAgIH0KCiAgICBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPSBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0uc3ViKHZhbHVlKTsKICAgIGJhbGFuY2VPZlt0b10gPSBiYWxhbmNlT2ZbdG9dLmFkZCh2YWx1ZSk7CiAgICBpZiAoY29kZUxlbmd0aCA+IDApIHsKICAgICAgRVJDMjIzUmVjZWl2aW5nQ29udHJhY3QgcmVjZWl2ZXIgPSBFUkMyMjNSZWNlaXZpbmdDb250cmFjdCh0byk7CiAgICAgIHJlY2VpdmVyLnRva2VuRmFsbGJhY2sobXNnLnNlbmRlciwgdmFsdWUsIGRhdGEpOwogICAgfQogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgdG8sIHZhbHVlLCBkYXRhKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLy8gU3RhbmRhcmQgZnVuY3Rpb24gdHJhbnNmZXIgc2ltaWxhciB0byBFUkMyMCB0cmFuc2ZlciB3aXRoIG5vIF9kYXRhIC4KICAvLyBBZGRlZCBkdWUgdG8gYmFja3dhcmRzIGNvbXBhdGliaWxpdHkgcmVhc29ucyAuCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHVpbnQyNTYgY29kZUxlbmd0aDsKICAgIGJ5dGVzIG1lbW9yeSBlbXB0eTsKCiAgICBhc3NlbWJseSB7CiAgICAgIC8vIFJldHJpZXZlIHRoZSBzaXplIG9mIHRoZSBjb2RlIG9uIHRhcmdldCBhZGRyZXNzLCB0aGlzIG5lZWRzIGFzc2VtYmx5IC4KICAgICAgY29kZUxlbmd0aCA6PSBleHRjb2Rlc2l6ZSh0bykKICAgIH0KCiAgICBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPSBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0uc3ViKHZhbHVlKTsKICAgIGJhbGFuY2VPZlt0b10gPSBiYWxhbmNlT2ZbdG9dLmFkZCh2YWx1ZSk7CiAgICBpZiAoY29kZUxlbmd0aCA+IDApIHsKICAgICAgRVJDMjIzUmVjZWl2aW5nQ29udHJhY3QgcmVjZWl2ZXIgPSBFUkMyMjNSZWNlaXZpbmdDb250cmFjdCh0byk7CiAgICAgIHJlY2VpdmVyLnRva2VuRmFsbGJhY2sobXNnLnNlbmRlciwgdmFsdWUsIGVtcHR5KTsKICAgIH0KICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIHRvLCB2YWx1ZSwgZW1wdHkpOwogICAgLy8gRVJDMjAgY29tcGF0aWJsZSBldmVudDoKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIHRvLCB2YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUsIGJ5dGVzIGluZGV4ZWQgZGF0YSk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCmNvbnRyYWN0IEVSQzIyM01pbnRhYmxlVG9rZW4gaXMgRVJDMjIzVG9rZW4gewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogIHVpbnQyNTYgcHVibGljIGNpcmN1bGF0aW5nU3VwcGx5OwogIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgdWludDI1NiBjb2RlTGVuZ3RoOwoKICAgIGFzc2VtYmx5IHsKICAgICAgLy8gUmV0cmlldmUgdGhlIHNpemUgb2YgdGhlIGNvZGUgb24gdGFyZ2V0IGFkZHJlc3MsIHRoaXMgbmVlZHMgYXNzZW1ibHkgLgogICAgICBjb2RlTGVuZ3RoIDo9IGV4dGNvZGVzaXplKHRvKQogICAgfQoKICAgIGNpcmN1bGF0aW5nU3VwcGx5ICs9IHZhbHVlOwoKICAgIGJhbGFuY2VPZlt0b10gPSBiYWxhbmNlT2ZbdG9dLmFkZCh2YWx1ZSk7CiAgICBpZiAoY29kZUxlbmd0aCA+IDApIHsKICAgICAgRVJDMjIzUmVjZWl2aW5nQ29udHJhY3QgcmVjZWl2ZXIgPSBFUkMyMjNSZWNlaXZpbmdDb250cmFjdCh0byk7CiAgICAgIGJ5dGVzIG1lbW9yeSBlbXB0eTsKICAgICAgcmVjZWl2ZXIudG9rZW5GYWxsYmFjayhtc2cuc2VuZGVyLCB2YWx1ZSwgZW1wdHkpOwogICAgfQogICAgTWludCh0bywgdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCmNvbnRyYWN0IFRlc3RUb2tlbiBpcyBFUkMyMjNNaW50YWJsZVRva2VuIHsKICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBJU19TSUdOQVRVUkVSOwoKICBWZXN0aW5nQWxsb2NhdGlvbiBwcml2YXRlIHBhcnRuZXJUb2tlbnNBbGxvY2F0aW9uOwogIFZlc3RpbmdBbGxvY2F0aW9uIHByaXZhdGUgY29tcGFueVRva2Vuc0FsbG9jYXRpb247CiAgQm91bnR5VG9rZW5BbGxvY2F0aW9uIHByaXZhdGUgYm91bnR5VG9rZW5zQWxsb2NhdGlvbjsKCiAgLyoKICAgKiBJQ08gVE9LRU5TCiAgICogMzMlCiAgICoKICAgKiBJY28gdG9rZW5zIGFyZSBzZW50IHRvIHRoZSBJQ09fVE9LRU5fQUREUkVTUyBpbW1lZGlhdGVseQogICAqIGFmdGVyIFRlc3RUb2tlbiBpbml0aWFsaXphdGlvbgogICAqLyAKICB1aW50MjU2IGNvbnN0YW50IElDT19UT0tFTlMgPSAyNTM0NjUwMDAwMDAwMDAwMDAwMDAwMDAwMDsKICBhZGRyZXNzIGNvbnN0YW50IElDT19UT0tFTlNfQUREUkVTUyA9IDB4Q0UxMTgyMTQ3RkQxM0E1OUU0Q2ExMTRDQWExY0Q1ODcxOWUwOUY2NzsKICAvLyBBVURJVFtDSEYtMDJdIERvY3VtZW50ICJzZWVkIiB0b2tlbnMuCiAgdWludDI1NiBjb25zdGFudCBTRUVEX1RPS0VOUyA9IDI1MzQ2NTAwMDAwMDAwMDAwMDAwMDAwMDAwOwogIGFkZHJlc3MgY29uc3RhbnQgU0VFRF9UT0tFTlNfQUREUkVTUyA9IDB4ODc0NjE3N0ZmMjU3NUU4MjZmNmY3M0ExZjkwMzUxZTBGRDBBNjY0OTsKCiAgLyoKICAgKiBDT01QQU5ZIFRPS0VOUwogICAqIDMzJQogICAqCiAgICogQ29tcGFueSB0b2tlbnMgYXJlIGJlaW5nIGRpc3RydWJpdGVkIGluIDM2IG1vbnRocwogICAqIFRvdGFsIHRva2VucyA9IENPTVBBTllfVE9LRU5TX1BFUl9QRVJJT0QgKiBDT01QQU5ZX1BFUklPRFMKICAgKi8KICB1aW50MjU2IGNvbnN0YW50IENPTVBBTllfVE9LRU5TX1BFUl9QRVJJT0QgPSA3MDQwNjk0NDQ0NDQ0NDQwMDAwMDAwMDA7CiAgdWludDI1NiBjb25zdGFudCBDT01QQU5ZX1BFUklPRFMgPSAzNjsKICB1aW50MjU2IGNvbnN0YW50IE1JTlVURVNfSU5fQ09NUEFOWV9QRVJJT0QgPSAxMDsgLy8xIHllYXJzIC8gMTIgLyAxIG1pbnV0ZXM7CgogIC8qCiAgICogUEFSVE5FUiBUT0tFTlMKICAgKiAzMCUKICAgKgogICAqIENvbXBhbnkgdG9rZW5zIGFyZSBhdmFpYWxhYmxlIGFmdGVyIDE4IG1vbnRocwogICAqIFRvdGFsIHRva2VucyA9IFBBUlRORVJfVE9LRU5TX1BFUl9QRVJJT0QgKiBQQVJUTkVSX1BFUklPRFMKICAgKi8KICB1aW50MjU2IGNvbnN0YW50IFBBUlRORVJfVE9LRU5TX1BFUl9QRVJJT0QgPSAyMzA0MjI3MjcyNzI3MjcwMDAwMDAwMDAwMDsKICB1aW50MjU2IGNvbnN0YW50IFBBUlRORVJfUEVSSU9EUyA9IDE7CiAgdWludDI1NiBjb25zdGFudCBNSU5VVEVTX0lOX1BBUlRORVJfUEVSSU9EID0gNjAgKiAyOyAvL01JTlVURVNfSU5fQ09NUEFOWV9QRVJJT0QgKiAxODsKCiAgLyoKICAgKiBCT1VOVFkgVE9LRU5TCiAgICogMzAlCiAgICoKICAgKiBCb3VudHkgdG9rZW5zIGNhbiBiZSBzZW50IGltbWVkaWF0ZWx5IGFmdGVyIGluaXRpYWxpemF0aW9uCiAgICovCiAgdWludDI1NiBjb25zdGFudCBCT1VOVFlfVE9LRU5TID0gMjMwNDIyNzI3MjcyNzI3MDAwMDAwMDAwMDsKCiAgLyoKICAgKiBNQVJLRVRJTkcgQ09TVCBUT0tFTlMKICAgKiAxJQogICAqCiAgICogVG9rZW5zIGFyZSBzZW50IHRvIHRoZSBNQVJLRVRJTkdfQ09TVF9BRERSRVNTIGltbWVkaWF0ZWx5CiAgICogYWZ0ZXIgVGVzdFRva2VuIGluaXRpYWxpemF0aW9uCiAgICovCiAgdWludDI1NiBjb25zdGFudCBNQVJLRVRJTkdfQ09TVF9UT0tFTlMgPSA3NjgwNzU3NTc1NzU3NTgwMDAwMDAwMDA7CiAgYWRkcmVzcyBjb25zdGFudCBNQVJLRVRJTkdfQ09TVF9BRERSRVNTID0gMHg1NGEwQUIxMjcxMGZhZDJhMjRDQjM5MTQwNmMyMzQ4NTVDODM1MzQwOwoKICB1aW50MjU2IHB1YmxpYyBJTklUX0RBVEU7CgogIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJUZXN0IFRva2VuIjsKICBieXRlczMyIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiVFNUIjsKICB1aW50OCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCB0b3RhbFN1cHBseSA9ICgKICAgIENPTVBBTllfVE9LRU5TX1BFUl9QRVJJT0QgKiBDT01QQU5ZX1BFUklPRFMgKwogICAgUEFSVE5FUl9UT0tFTlNfUEVSX1BFUklPRCAqIFBBUlRORVJfUEVSSU9EUyArCiAgICBCT1VOVFlfVE9LRU5TICsgTUFSS0VUSU5HX0NPU1RfVE9LRU5TICsKICAgIElDT19UT0tFTlMgKyBTRUVEX1RPS0VOUyk7CgogIC8qKgogICAqIFRlc3RUb2tlbiBjb250cnVjdG9yLgogICAqCiAgICogRXh5IHRva2VuIGNvbnRhaW5zIGFsbG9jYXRpb25zIG9mOgogICAqIC0gcGFydG5lclRva2Vuc0FsbG9jYXRpb24KICAgKiAtIGNvbXBhbnlUb2tlbnNBbGxvY2F0aW9uCiAgICogLSBib3VudHlUb2tlbnNBbGxvY2F0aW9uCiAgICoKICAgKiBwYXJhbSBzaWduYXR1cmVyMCBBZGRyZXNzIG9mIGZpcnN0IHNpZ25hdHVyZXIuCiAgICogcGFyYW0gc2lnbmF0dXJlcjEgQWRkcmVzcyBvZiBzZWNvbmQgc2lnbmF0dXJlci4KICAgKiBwYXJhbSBzaWduYXR1cmVyMiBBZGRyZXNzIG9mIHRoaXJkIHNpZ25hdHVyZXIuCiAgICoKICAgKiBBcmd1bWVudHMgaW4gY29uc3RydWN0b3IgYXJlIG9ubHkgZm9yIHRlc3RpbmcuIFdoZW4gZGVwbG95aW5nCiAgICogb24gbWFpbiBuZXQsIHBsZWFzZSBoYXJkY29kZSB0aGVtIGluc2lkZToKICAgKiBhZGRyZXNzIHNpZ25hdHVyZXIwID0gMHgwOwogICAqIGFkZHJlc3Mgc2lnbmF0dXJlcjEgPSAweDE7CiAgICogYWRkcmVzcyBzaWduYXR1cmVyMiA9IDB4MjsKICAgKi8KICBmdW5jdGlvbiBUZXN0VG9rZW4oKSBwdWJsaWMgewogICAgYWRkcmVzcyBzaWduYXR1cmVyMCA9IDB4ZTAyOWI3YjUxYjhjNUI3MUU2QzZmM0RDNjZhMTFERjNDYUI2RTNCNTsKICAgIGFkZHJlc3Mgc2lnbmF0dXJlcjEgPSAweEJFRTliNWU3NTM4M2Y1NmViMTAzRGRDMWE0MzQzZGNBNjEyNERmYTM7CiAgICBhZGRyZXNzIHNpZ25hdHVyZXIyID0gMHhjZEQxRGIxNkU4M0FBNzU3YTVCM0U2ZDAzNDgyYkJDOUEyN2U4RDQ5OwogICAgSVNfU0lHTkFUVVJFUltzaWduYXR1cmVyMF0gPSB0cnVlOwogICAgSVNfU0lHTkFUVVJFUltzaWduYXR1cmVyMV0gPSB0cnVlOwogICAgSVNfU0lHTkFUVVJFUltzaWduYXR1cmVyMl0gPSB0cnVlOwogICAgSU5JVF9EQVRFID0gYmxvY2sudGltZXN0YW1wOwoKICAgIC8vIEFVRElUW0NIRi0wNl0gSW5oZXJpdCBpbnN0ZWFkIG9mIGNvbXBvc2UuCiAgICAvLwogICAgLy8gSSBkb24ndCBzZWUgYSBwb2ludCBvZiBjcmVhdGluZyAiU2lnbmF0dXJlcyIgYXMgYSBzZXBhcmF0ZSBjb250cmFjdC4KICAgIC8vIEp1c3QgZW1iZWQgaXQgaGVyZS4KICAgIC8vIEFsc28sIG1vdmUgIm9ubHlTaWduYXR1cmVyIiB0byBTaWduYXR1cmVzIGNvbnRyYWN0CiAgICBjb21wYW55VG9rZW5zQWxsb2NhdGlvbiA9IG5ldyBWZXN0aW5nQWxsb2NhdGlvbigKICAgICAgQ09NUEFOWV9UT0tFTlNfUEVSX1BFUklPRCwKICAgICAgQ09NUEFOWV9QRVJJT0RTLAogICAgICBNSU5VVEVTX0lOX0NPTVBBTllfUEVSSU9ELAogICAgICBJTklUX0RBVEUpOwoKICAgIHBhcnRuZXJUb2tlbnNBbGxvY2F0aW9uID0gbmV3IFZlc3RpbmdBbGxvY2F0aW9uKAogICAgICBQQVJUTkVSX1RPS0VOU19QRVJfUEVSSU9ELAogICAgICBQQVJUTkVSX1BFUklPRFMsCiAgICAgIE1JTlVURVNfSU5fUEFSVE5FUl9QRVJJT0QsCiAgICAgIElOSVRfREFURSk7CgogICAgYm91bnR5VG9rZW5zQWxsb2NhdGlvbiA9IG5ldyBCb3VudHlUb2tlbkFsbG9jYXRpb24oCiAgICAgIEJPVU5UWV9UT0tFTlMKICAgICk7CgogICAgLy8gbWludGluZyBtYXJrZXRpbmcgY29zdCB0b2tlbnMKICAgIG1pbnQoTUFSS0VUSU5HX0NPU1RfQUREUkVTUywgTUFSS0VUSU5HX0NPU1RfVE9LRU5TKTsKCiAgICAvLyBtaW50aW5nIElDTyB0b2tlbnMKICAgIG1pbnQoSUNPX1RPS0VOU19BRERSRVNTLCBJQ09fVE9LRU5TKTsKICAgIC8vIG1pbnRpbmcgU0VFRCB0b2tlbnMKICAgIG1pbnQoU0VFRF9UT0tFTlNfQUREUkVTUywgU0VFRF9UT0tFTlMpOwogIH0KCiAgLyoqCiAgICogQWRkcyBhIHByb3Bvc2l0aW9uIG9mIGEgY29tcGFueSB0b2tlbiBzcGxpdCB0byBjb21wYW55VG9rZW5zQWxsb2NhdGlvbgogICAqLwogIGZ1bmN0aW9uIHByb3Bvc2VDb21wYW55QWxsb2NhdGlvbihhZGRyZXNzIF9kZXN0LCB1aW50MjU2IF90b2tlbnNQZXJQZXJpb2QpIHB1YmxpYyBvbmx5U2lnbmF0dXJlciB7CiAgICBjb21wYW55VG9rZW5zQWxsb2NhdGlvbi5wcm9wb3NlQWxsb2NhdGlvbihtc2cuc2VuZGVyLCBfZGVzdCwgX3Rva2Vuc1BlclBlcmlvZCk7CiAgfQoKICAvKioKICAgKiBBcHByb3ZlcyBhIHByb3Bvc2l0aW9uIG9mIGEgY29tcGFueSB0b2tlbiBzcGxpdAogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmVDb21wYW55QWxsb2NhdGlvbihhZGRyZXNzIF9kZXN0KSBwdWJsaWMgb25seVNpZ25hdHVyZXIgewogICAgY29tcGFueVRva2Vuc0FsbG9jYXRpb24uYXBwcm92ZUFsbG9jYXRpb24obXNnLnNlbmRlciwgX2Rlc3QpOwogIH0KCiAgLyoqCiAgICogUmVqZWN0cyBhIHByb3Bvc2l0aW9uIG9mIGEgY29tcGFueSB0b2tlbiBzcGxpdC4KICAgKiBpdCBjYW4gcmVqZWN0IG9ubHkgbm90IGFwcHJvdmVkIG1ldGhvZAogICAqLwogIGZ1bmN0aW9uIHJlamVjdENvbXBhbnlBbGxvY2F0aW9uKGFkZHJlc3MgX2Rlc3QpIHB1YmxpYyBvbmx5U2lnbmF0dXJlciB7CiAgICBjb21wYW55VG9rZW5zQWxsb2NhdGlvbi5yZWplY3RBbGxvY2F0aW9uKF9kZXN0KTsKICB9CgogIC8qKgogICAqIFJldHVybiBudW1iZXIgb2YgcmVtYWluaW5nIGNvbXBhbnkgdG9rZW5zIGFsbG9jYXRpb25zCiAgICogQHJldHVybiBMZW5ndGggb2YgY29tcGFueSBhbGxvY2F0aW9ucyBwZXIgcGVyaW9kCiAgICovCiAgZnVuY3Rpb24gZ2V0UmVtYWluaW5nQ29tcGFueVRva2Vuc0FsbG9jYXRpb24oKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gY29tcGFueVRva2Vuc0FsbG9jYXRpb24ucmVtYWluaW5nVG9rZW5zUGVyUGVyaW9kKCk7CiAgfQoKICAvKioKICAgKiBHaXZlbiB0aGUgaW5kZXggb2YgdGhlIGNvbXBhbnkgYWxsb2NhdGlvbiBpbiBhbGxvY2F0aW9uQWRkcmVzc0xpc3QKICAgKiB3ZSBmaW5kIGl0cyByZWNpZXBlbnQgYWRkcmVzcyBhbmQgcmV0dXJuIHN0cnVjdCB3aXRoIGluZm9ybWF0aW9ucwogICAqIGFib3V0IHRoaXMgYWxsb2NhdGlvbgogICAqCiAgICogQHBhcmFtIG5yIEluZGV4IG9mIGFsbG9jYXRpb24gaW4gYWxsb2NhdGlvbkFkZHJlc3NMaXN0CiAgICogQHJldHVybiBJbmZvcm1hdGlvbiBhYm91dCBjb21wYW55IGFsbG9jdGlvbgogICAqLwogIGZ1bmN0aW9uIGdldENvbXBhbnlBbGxvY2F0aW9uKHVpbnQyNTYgbnIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYsIGFkZHJlc3MsIHVpbnQyNTYsIFR5cGVzLkFsbG9jYXRpb25TdGF0ZSwgYWRkcmVzcykgewogICAgYWRkcmVzcyByZWNpcGllbnRBZGRyZXNzID0gY29tcGFueVRva2Vuc0FsbG9jYXRpb24uYWxsb2NhdGlvbkFkZHJlc3NMaXN0KG5yKTsKICAgIHZhciAodG9rZW5zUGVyUGVyaW9kLCBwcm9wb3NhbEFkZHJlc3MsIGNsYWltZWRQZXJpb2RzLCBhbGxvY2F0aW9uU3RhdGUpID0gY29tcGFueVRva2Vuc0FsbG9jYXRpb24uYWxsb2NhdGlvbk9mKHJlY2lwaWVudEFkZHJlc3MpOwogICAgcmV0dXJuICh0b2tlbnNQZXJQZXJpb2QsIHByb3Bvc2FsQWRkcmVzcywgY2xhaW1lZFBlcmlvZHMsIGFsbG9jYXRpb25TdGF0ZSwgcmVjaXBpZW50QWRkcmVzcyk7CiAgfQoKICAvKioKICAgKiBBZGRzIGEgcHJvcG9zaXRpb24gb2YgYSBwYXJ0bmVyIHRva2VuIHNwbGl0IHRvIGNvbXBhbnlUb2tlbnNBbGxvY2F0aW9uCiAgICovCiAgZnVuY3Rpb24gcHJvcG9zZVBhcnRuZXJBbGxvY2F0aW9uKGFkZHJlc3MgX2Rlc3QsIHVpbnQyNTYgX3Rva2Vuc1BlclBlcmlvZCkgcHVibGljIG9ubHlTaWduYXR1cmVyIHsKICAgIHBhcnRuZXJUb2tlbnNBbGxvY2F0aW9uLnByb3Bvc2VBbGxvY2F0aW9uKG1zZy5zZW5kZXIsIF9kZXN0LCBfdG9rZW5zUGVyUGVyaW9kKTsKICB9CgogIC8qKgogICAqIEFwcHJvdmVzIGEgcHJvcG9zaXRpb24gb2YgYSBwYXJ0bmVyIHRva2VuIHNwbGl0CiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZVBhcnRuZXJBbGxvY2F0aW9uKGFkZHJlc3MgX2Rlc3QpIHB1YmxpYyBvbmx5U2lnbmF0dXJlciB7CiAgICBwYXJ0bmVyVG9rZW5zQWxsb2NhdGlvbi5hcHByb3ZlQWxsb2NhdGlvbihtc2cuc2VuZGVyLCBfZGVzdCk7CiAgfQoKICAvKioKICAgKiBSZWplY3RzIGEgcHJvcG9zaXRpb24gb2YgYSBwYXJ0bmVyIHRva2VuIHNwbGl0LgogICAqIGl0IGNhbiByZWplY3Qgb25seSBub3QgYXBwcm92ZWQgbWV0aG9kCiAgICovCiAgZnVuY3Rpb24gcmVqZWN0UGFydG5lckFsbG9jYXRpb24oYWRkcmVzcyBfZGVzdCkgcHVibGljIG9ubHlTaWduYXR1cmVyIHsKICAgIHBhcnRuZXJUb2tlbnNBbGxvY2F0aW9uLnJlamVjdEFsbG9jYXRpb24oX2Rlc3QpOwogIH0KCiAgLyoqCiAgICogUmV0dXJuIG51bWJlciBvZiByZW1haW5pbmcgcGFydG5lciB0b2tlbnMgYWxsb2NhdGlvbnMKICAgKiBAcmV0dXJuIExlbmd0aCBvZiBwYXJ0bmVyIGFsbG9jYXRpb25zIHBlciBwZXJpb2QKICAgKi8KICBmdW5jdGlvbiBnZXRSZW1haW5pbmdQYXJ0bmVyVG9rZW5zQWxsb2NhdGlvbigpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBwYXJ0bmVyVG9rZW5zQWxsb2NhdGlvbi5yZW1haW5pbmdUb2tlbnNQZXJQZXJpb2QoKTsKICB9CgogIC8qKgogICAqIEdpdmVuIHRoZSBpbmRleCBvZiB0aGUgcGFydG5lciBhbGxvY2F0aW9uIGluIGFsbG9jYXRpb25BZGRyZXNzTGlzdAogICAqIHdlIGZpbmQgaXRzIHJlY2llcGVudCBhZGRyZXNzIGFuZCByZXR1cm4gc3RydWN0IHdpdGggaW5mb3JtYXRpb25zCiAgICogYWJvdXQgdGhpcyBhbGxvY2F0aW9uCiAgICoKICAgKiBAcGFyYW0gbnIgSW5kZXggb2YgYWxsb2NhdGlvbiBpbiBhbGxvY2F0aW9uQWRkcmVzc0xpc3QKICAgKiBAcmV0dXJuIEluZm9ybWF0aW9uIGFib3V0IHBhcnRuZXIgYWxsb2N0aW9uCiAgICovCiAgZnVuY3Rpb24gZ2V0UGFydG5lckFsbG9jYXRpb24odWludDI1NiBucikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiwgYWRkcmVzcywgdWludDI1NiwgVHlwZXMuQWxsb2NhdGlvblN0YXRlLCBhZGRyZXNzKSB7CiAgICBhZGRyZXNzIHJlY2lwaWVudEFkZHJlc3MgPSBwYXJ0bmVyVG9rZW5zQWxsb2NhdGlvbi5hbGxvY2F0aW9uQWRkcmVzc0xpc3QobnIpOwogICAgdmFyICh0b2tlbnNQZXJQZXJpb2QsIHByb3Bvc2FsQWRkcmVzcywgY2xhaW1lZFBlcmlvZHMsIGFsbG9jYXRpb25TdGF0ZSkgPSBwYXJ0bmVyVG9rZW5zQWxsb2NhdGlvbi5hbGxvY2F0aW9uT2YocmVjaXBpZW50QWRkcmVzcyk7CiAgICByZXR1cm4gKHRva2Vuc1BlclBlcmlvZCwgcHJvcG9zYWxBZGRyZXNzLCBjbGFpbWVkUGVyaW9kcywgYWxsb2NhdGlvblN0YXRlLCByZWNpcGllbnRBZGRyZXNzKTsKICB9CgogIGZ1bmN0aW9uIHByb3Bvc2VCb3VudHlUcmFuc2ZlcihhZGRyZXNzIF9kZXN0LCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyBvbmx5U2lnbmF0dXJlciB7CiAgICBib3VudHlUb2tlbnNBbGxvY2F0aW9uLnByb3Bvc2VCb3VudHlUcmFuc2ZlcihfZGVzdCwgX2Ftb3VudCk7CiAgfQoKICAvKioKICAgKiBBcHByb3ZlcyBhIGJvdW50eSB0cmFuc2ZlciBhbmQgbWludCB0b2tlbnMKICAgKgogICAqIEBwYXJhbSBfZGVzdCBBZGRyZXNzIG9mIHRoZSBib3VudHkgcmVjaWVwZW50IHRvIHdob20gd2Ugc2hvdWxkIG1pbnQgdG9rZW4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlQm91bnR5VHJhbnNmZXIoYWRkcmVzcyBfZGVzdCkgcHVibGljIG9ubHlTaWduYXR1cmVyIHsKICAgIHVpbnQyNTYgdG9rZW5zVG9NaW50ID0gYm91bnR5VG9rZW5zQWxsb2NhdGlvbi5hcHByb3ZlQm91bnR5VHJhbnNmZXIobXNnLnNlbmRlciwgX2Rlc3QpOwogICAgbWludChfZGVzdCwgdG9rZW5zVG9NaW50KTsKICB9CgogIC8qKgogICAqIFJlamVjdHMgYSBwcm9wb3NpdGlvbiBvZiBhIGJvdW50eSB0b2tlbi4KICAgKiBpdCBjYW4gcmVqZWN0IG9ubHkgbm90IGFwcHJvdmVkIG1ldGhvZAogICAqLwogIGZ1bmN0aW9uIHJlamVjdEJvdW50eVRyYW5zZmVyKGFkZHJlc3MgX2Rlc3QpIHB1YmxpYyBvbmx5U2lnbmF0dXJlciB7CiAgICBib3VudHlUb2tlbnNBbGxvY2F0aW9uLnJlamVjdEJvdW50eVRyYW5zZmVyKF9kZXN0KTsKICB9CgogIGZ1bmN0aW9uIGdldEJvdW50eVRyYW5zZmVycyh1aW50MjU2IG5yKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2LCBhZGRyZXNzLCBUeXBlcy5Cb3VudHlTdGF0ZSwgYWRkcmVzcykgewogICAgYWRkcmVzcyByZWNpcGllbnRBZGRyZXNzID0gYm91bnR5VG9rZW5zQWxsb2NhdGlvbi5hbGxvY2F0aW9uQWRkcmVzc0xpc3QobnIpOwogICAgdmFyIChhbW91bnQsIHByb3Bvc2FsQWRkcmVzcywgYm91bnR5U3RhdGUpID0gYm91bnR5VG9rZW5zQWxsb2NhdGlvbi5ib3VudHlPZihyZWNpcGllbnRBZGRyZXNzKTsKICAgIHJldHVybiAoYW1vdW50LCBwcm9wb3NhbEFkZHJlc3MsIGJvdW50eVN0YXRlLCByZWNpcGllbnRBZGRyZXNzKTsKICB9CgogIC8qKgogICAqIFJldHVybiBudW1iZXIgb2YgcmVtYWluaW5nIGJvdW50eSB0b2tlbnMgYWxsb2NhdGlvbnMKICAgKiBAcmV0dXJuIExlbmd0aCBvZiBjb21wYW55IGFsbG9jYXRpb25zCiAgICovCiAgZnVuY3Rpb24gZ2V0UmVtYWluaW5nQm91bnR5VG9rZW5zKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGJvdW50eVRva2Vuc0FsbG9jYXRpb24ucmVtYWluaW5nQm91bnR5VG9rZW5zKCk7CiAgfQoKICBmdW5jdGlvbiBjbGFpbVRva2VucygpIHB1YmxpYyByZXR1cm5zICh1aW50MjU2KSB7CiAgICBtaW50KG1zZy5zZW5kZXIsCiAgICAgIHBhcnRuZXJUb2tlbnNBbGxvY2F0aW9uLmNsYWltVG9rZW5zKG1zZy5zZW5kZXIpICsKICAgICAgY29tcGFueVRva2Vuc0FsbG9jYXRpb24uY2xhaW1Ub2tlbnMobXNnLnNlbmRlcikpOwogIH0KICBtb2RpZmllciBvbmx5U2lnbmF0dXJlcigpIHsKICAgIHJlcXVpcmUoSVNfU0lHTkFUVVJFUlttc2cuc2VuZGVyXSk7CiAgICBfOwogIH0KCn0KCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKfQoKY29udHJhY3QgQm91bnR5VG9rZW5BbGxvY2F0aW9uIGlzIE93bmFibGUsIEFsbG9jYXRpb25BZGRyZXNzTGlzdCB7CgogIC8vIFRoaXMgY29udHJhY3QgZGVzY3JpYmVzIGhvdyB0aGUgYm91bnR5IHRva2VucyBhcmUgYWxsb2NhdGVkLgogIC8vIEFmdGVyIGEgYm91bnR5IGFsbG9jYXRpb24gd2FzIHByb3Bvc2VkIGJ5IGEgc2lnbmF0dXJlciwgYW5vdGhlcgogIC8vIHNpZ25hdHVyZXIgbXVzdCBhY2NlcHQgdGhpcyBhbGxvY2F0aW9uLgoKICAvLyBUb3RhbCBhbW91bnQgb2YgcmVtYWluaW5nIHRva2VucyB0byBiZSBkaXN0cmlidXRlZAogIHVpbnQyNTYgcHVibGljIHJlbWFpbmluZ0JvdW50eVRva2VuczsKCiAgLy8gUG9zc2libGUgc3BsaXQgc3RhdGVzOiBQcm9wb3NlZCwgQXBwcm92ZWQsIFJlamVjdGVkCiAgLy8gUHJvcG9zZWQgaXMgdGhlIGluaXRpYWwgc3RhdGUuCiAgLy8gQm90aCBBcHByb3ZlZCBhbmQgUmVqZWN0ZWQgYXJlIGZpbmFsIHN0YXRlcy4KICAvLyBUaGUgb25seSBwb3NzaWJsZSB0cmFuc2l0aW9ucyBhcmU6CiAgLy8gUHJvcG9zZWQgPT4gQXBwcm92ZWQKICAvLyBQcm9wb3NlZCA9PiBSZWplY3RlZAoKICAvLyBrZWVwIG1hcCBoZXJlIG9mIGJvdW50eSBwcm9wb3NhbHMKICBtYXBwaW5nIChhZGRyZXNzID0+IFR5cGVzLlN0cnVjdEJvdW50eUFsbG9jYXRpb24pIHB1YmxpYyBib3VudHlPZjsKCiAgYWRkcmVzcyBwdWJsaWMgb3duZXIgPSBtc2cuc2VuZGVyOwoKICAvKioKICAgKiBCb3VudHkgdG9rZW4gYWxsb2NhdGlvbiBjb25zdHJ1Y3Rvci4KICAgKgogICAqIEBwYXJhbSBfcmVtYWluaW5nQm91bnR5VG9rZW5zIFRvdGFsIG51bWJlciBvZiBib3VudHkgdG9rZW5zIHRoYXQgd2lsbCBiZQogICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsbG9jYXRlZC4KICAgKi8KICBmdW5jdGlvbiBCb3VudHlUb2tlbkFsbG9jYXRpb24odWludDI1NiBfcmVtYWluaW5nQm91bnR5VG9rZW5zKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlbWFpbmluZ0JvdW50eVRva2VucyA9IF9yZW1haW5pbmdCb3VudHlUb2tlbnM7CiAgfQoKICAvKioKICAgKiBQcm9wb3NlIGEgYm91bnR5IHRyYW5zZmVyCiAgICoKICAgKiBAcGFyYW0gX2Rlc3QgQWRkcmVzcyBvZiBib3VudHkgcmVjaWVwZW50CiAgICogQHBhcmFtIF9hbW91bnQgQW1vdW50IG9mIHRva2VucyBoZSB3aWxsIHJlY2VpdmUKICAgKi8KICBmdW5jdGlvbiBwcm9wb3NlQm91bnR5VHJhbnNmZXIoYWRkcmVzcyBfZGVzdCwgdWludDI1NiBfYW1vdW50KSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUoX2Ftb3VudCA+IDApOwogICAgcmVxdWlyZShfYW1vdW50IDw9IHJlbWFpbmluZ0JvdW50eVRva2Vucyk7CiAgICAgLy8gd2UgY2FuJ3Qgb3ZlcndyaXRlIGV4aXN0aW5nIHByb3Bvc2FsCiAgICAgLy8gYnV0IHdlIGNhbiBvdmVyd3JpdGUgcmVqZWN0ZWQgcHJvcG9zYWwgd2l0aCBuZXcgdmFsdWVzCiAgICByZXF1aXJlKGJvdW50eU9mW19kZXN0XS5wcm9wb3NhbEFkZHJlc3MgPT0gMHgwIHx8IGJvdW50eU9mW19kZXN0XS5ib3VudHlTdGF0ZSA9PSBUeXBlcy5Cb3VudHlTdGF0ZS5SZWplY3RlZCk7CgogICAgaWYgKGJvdW50eU9mW19kZXN0XS5ib3VudHlTdGF0ZSAhPSBUeXBlcy5Cb3VudHlTdGF0ZS5SZWplY3RlZCkgewogICAgICBhbGxvY2F0aW9uQWRkcmVzc0xpc3QucHVzaChfZGVzdCk7CiAgICB9CgogICAgYm91bnR5T2ZbX2Rlc3RdID0gVHlwZXMuU3RydWN0Qm91bnR5QWxsb2NhdGlvbih7CiAgICAgIGFtb3VudDogX2Ftb3VudCwKICAgICAgcHJvcG9zYWxBZGRyZXNzOiBtc2cuc2VuZGVyLAogICAgICBib3VudHlTdGF0ZTogVHlwZXMuQm91bnR5U3RhdGUuUHJvcG9zZWQKICAgIH0pOwoKICAgIHJlbWFpbmluZ0JvdW50eVRva2VucyA9IHJlbWFpbmluZ0JvdW50eVRva2VucyAtIF9hbW91bnQ7CiAgfQoKICAvKioKICAgKiBBcHByb3ZlcyBhIGJvdW50eSB0cmFuc2ZlcgogICAqCiAgICogQHBhcmFtIF9kZXN0IEFkZHJlc3Mgb2YgYm91bnR5IHJlY2llcGVudAogICAqIEByZXR1cm4gYW1vdW50IG9mIHRva2VucyB3aGljaCB3ZSBhcHByb3ZlZAogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmVCb3VudHlUcmFuc2ZlcihhZGRyZXNzIF9hcHByb3ZlckFkZHJlc3MsIGFkZHJlc3MgX2Rlc3QpIHB1YmxpYyBvbmx5T3duZXIgcmV0dXJucyAodWludDI1NikgewogICAgcmVxdWlyZShib3VudHlPZltfZGVzdF0uYm91bnR5U3RhdGUgPT0gVHlwZXMuQm91bnR5U3RhdGUuUHJvcG9zZWQpOwogICAgcmVxdWlyZShib3VudHlPZltfZGVzdF0ucHJvcG9zYWxBZGRyZXNzICE9IF9hcHByb3ZlckFkZHJlc3MpOwoKICAgIGJvdW50eU9mW19kZXN0XS5ib3VudHlTdGF0ZSA9IFR5cGVzLkJvdW50eVN0YXRlLkFwcHJvdmVkOwogICAgcmV0dXJuIGJvdW50eU9mW19kZXN0XS5hbW91bnQ7CiAgfQoKICAvKioKICAgKiBSZWplY3RzIGEgYm91bnR5IHRyYW5zZmVyCiAgICoKICAgKiBAcGFyYW0gX2Rlc3QgQWRkcmVzcyBvZiBib3VudHkgcmVjaWVwZW50IGZvciB3aG9tIHdlIGFyZSByZWplY3RpbmcgYm91bnR5IHRyYW5zZmVyCiAgICovCiAgZnVuY3Rpb24gcmVqZWN0Qm91bnR5VHJhbnNmZXIoYWRkcmVzcyBfZGVzdCkgcHVibGljIG9ubHlPd25lciB7CiAgICB2YXIgdG1wID0gYm91bnR5T2ZbX2Rlc3RdOwogICAgcmVxdWlyZSh0bXAuYm91bnR5U3RhdGUgPT0gVHlwZXMuQm91bnR5U3RhdGUuUHJvcG9zZWQpOwoKICAgIGJvdW50eU9mW19kZXN0XS5ib3VudHlTdGF0ZSA9IFR5cGVzLkJvdW50eVN0YXRlLlJlamVjdGVkOwogICAgcmVtYWluaW5nQm91bnR5VG9rZW5zID0gcmVtYWluaW5nQm91bnR5VG9rZW5zICsgYm91bnR5T2ZbX2Rlc3RdLmFtb3VudDsKICB9Cgp9CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIHB1cmUgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIHB1cmUgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KICBmdW5jdGlvbiBtaW4odWludDI1NiBhLCB1aW50MjU2IGIpIHB1cmUgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgaWYoYSA+IGIpCiAgICAgIHJldHVybiBiOwogICAgZWxzZQogICAgICByZXR1cm4gYTsKICB9Cn0KCmNvbnRyYWN0IFR5cGVzIHsKCiAgLy8gUG9zc2libGUgc3BsaXQgc3RhdGVzOiBQcm9wb3NlZCwgQXBwcm92ZWQsIFJlamVjdGVkCiAgLy8gUHJvcG9zZWQgaXMgdGhlIGluaXRpYWwgc3RhdGUuCiAgLy8gQm90aCBBcHByb3ZlZCBhbmQgUmVqZWN0ZWQgYXJlIGZpbmFsIHN0YXRlcy4KICAvLyBUaGUgb25seSBwb3NzaWJsZSB0cmFuc2l0aW9ucyBhcmU6CiAgLy8gUHJvcG9zZWQgPT4gQXBwcm92ZWQKICAvLyBQcm9wb3NlZCA9PiBSZWplY3RlZAogIGVudW0gQWxsb2NhdGlvblN0YXRlIHsKICAgIFByb3Bvc2VkLAogICAgQXBwcm92ZWQsCiAgICBSZWplY3RlZAogIH0KCiAgLy8gU3RydWN0dXJlIHVzZWQgZm9yIHN0b3JpbmcgY29tcGFueSBhbmQgcGFydG5lciBhbGxvY2F0aW9ucwogIHN0cnVjdCBTdHJ1Y3RWZXN0aW5nQWxsb2NhdGlvbiB7CiAgICAvLyBIb3cgbWFueSB0b2tlbnMgcGVyIHBlcmlvZCB3ZSB3YW50IHRvIHBhc3MKICAgIHVpbnQyNTYgdG9rZW5zUGVyUGVyaW9kOwogICAgLy8gQnkgd2hvbSB3YXMgdGhpcyBzcGxpdCBwcm9wb3NlZC4gQW5vdGhlciBzaWduYXR1cmVyIG11c3QgYXBwcm92ZSB0b28KICAgIGFkZHJlc3MgcHJvcG9zZXJBZGRyZXNzOwogICAgLy8gSG93IG1hbnkgdGltZXMgZGlkIHdlIHJlbGVhc2VkIHRva2VucwogICAgdWludDI1NiBjbGFpbWVkUGVyaW9kczsKICAgIC8vIFN0YXRlIG9mIGFjdHVhbCBzcGxpdC4KICAgIEFsbG9jYXRpb25TdGF0ZSBhbGxvY2F0aW9uU3RhdGU7CiAgfQoKICAgZW51bSBCb3VudHlTdGF0ZSB7CiAgICBQcm9wb3NlZCwgLy8gMAogICAgQXBwcm92ZWQsIC8vIDEKICAgIFJlamVjdGVkICAvLyAyCiAgfQoKICBzdHJ1Y3QgU3RydWN0Qm91bnR5QWxsb2NhdGlvbiB7CiAgICAvLyBIb3cgbWFueSB0b2tlbnMgc2VuZCBoaW0gb3IgaGVyCiAgICB1aW50MjU2IGFtb3VudDsKICAgIC8vIEJ5IHdob20gd2FzIHRoaXMgYWxsb2NhdGlvbiBwcm9wb3NlZAogICAgYWRkcmVzcyBwcm9wb3NhbEFkZHJlc3M7CiAgICAvLyBTdGF0ZSBvZiBhY3R1YWwgc3BsaXQuCiAgICBCb3VudHlTdGF0ZSBib3VudHlTdGF0ZTsKICB9Cn0KCmNvbnRyYWN0IFZlc3RpbmdBbGxvY2F0aW9uIGlzIE93bmFibGUsIEFsbG9jYXRpb25BZGRyZXNzTGlzdCB7CgogIC8vIFRoaXMgY29udHJhY3QgZGVzY3JpYmVzIGhvdyB0aGUgdG9rZW5zIGFyZSBiZWluZyByZWxlYXNlZCBpbiB0aW1lCgogIC8vIEhvdyBtYW55IGRpc3RyaWJ1dGlvbnMgcGVyaW9kcyB0aGVyZSBhcmUKICB1aW50MjU2IHB1YmxpYyBwZXJpb2RzOwogIC8vIEhvdyBsb25nIGlzIG9uZSBpbnRlcnZhbAogIHVpbnQyNTYgcHVibGljIG1pbnV0ZXNJblBlcmlvZDsKICAvLyBUb3RhbCBhbW91bnQgb2YgcmVtYWluaW5nIHRva2VucyB0byBiZSBkaXN0cmlidXRlZAogIHVpbnQyNTYgcHVibGljIHJlbWFpbmluZ1Rva2Vuc1BlclBlcmlvZDsKICAvLyBUb3RhbCBhbW91bnQgb2YgYWxsIHRva2VucwogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIC8vIEluaXRhbCB0aW1lc3RhbXAKICB1aW50MjU2IHB1YmxpYyBpbml0VGltZXN0YW1wOwoKICAvLyBGb3IgZWFjaCBhZGRyZXNzIHdlIGNhbiBhZGQgZXhhY3RseSBvbmUgcG9zc2libGUgc3BsaXQuCiAgLy8gSWYgd2UgdHJ5IHRvIGFkZCBhbm90aGVyIHByb3Bvc2FsIG9uIGV4aXN0aW5nIGFkZHJlc3MgaXQgd2lsbCBiZSByZWplY3RlZAogIG1hcHBpbmcgKGFkZHJlc3MgPT4gVHlwZXMuU3RydWN0VmVzdGluZ0FsbG9jYXRpb24pIHB1YmxpYyBhbGxvY2F0aW9uT2Y7CgogIC8qKgogICAqIFZlc3RpbmdBbGxvY2F0aW9uIGNvbnRydWN0b3IuCiAgICogUmVtYWluaW5nVG9rZW5zUGVyUGVyaW9kIHZhcmlhYmxlIHdoaWNoIHJlcHJlc2VudHMKICAgKiB0aGUgcmVtYWluaW5nIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgZGlzdHJpYnV0ZWQKICAgKi8KICAvLyBJbnZva2luZyBwYXJlbnQgY29uc3RydWN0b3IgKE93bmVkQnlTaWduYXR1cmVycykgd2l0aCBzaWduYXR1cmVzIGFkZHJlc3NlcwogIGZ1bmN0aW9uIFZlc3RpbmdBbGxvY2F0aW9uKHVpbnQyNTYgX3Rva2Vuc1BlclBlcmlvZCwgdWludDI1NiBfcGVyaW9kcywgdWludDI1NiBfbWludXRlc0luUGVyaW9kLCB1aW50MjU2IF9pbml0YWxUaW1lc3RhbXApICBPd25hYmxlKCkgcHVibGljIHsKICAgIHRvdGFsU3VwcGx5ID0gX3Rva2Vuc1BlclBlcmlvZCAqIF9wZXJpb2RzOwogICAgcGVyaW9kcyA9IF9wZXJpb2RzOwogICAgbWludXRlc0luUGVyaW9kID0gX21pbnV0ZXNJblBlcmlvZDsKICAgIHJlbWFpbmluZ1Rva2Vuc1BlclBlcmlvZCA9IF90b2tlbnNQZXJQZXJpb2Q7CiAgICBpbml0VGltZXN0YW1wID0gX2luaXRhbFRpbWVzdGFtcDsKICB9CgogIC8qKgogICAqIFByb3Bvc2Ugc3BsaXQgbWV0aG9kIGFkZHMgcHJvcG9zYWwgdG8gdGhlIHNwbGl0cyBBcnJheS4KICAgKgogICAqIEBwYXJhbSBfZGVzdCAgICAgICAgICAgICAgLSBhZGRyZXNzIG9mIHRoZSBuZXcgcmVjZWl2ZXIKICAgKiBAcGFyYW0gX3Rva2Vuc1BlclBlcmlvZCAgIC0gaG93IG1hbnkgdG9rZW5zIHdlIGFyZSBnaXZpbmcgdG8gZGVzdAogICAqLwogIGZ1bmN0aW9uIHByb3Bvc2VBbGxvY2F0aW9uKGFkZHJlc3MgX3Byb3Bvc2VyQWRkcmVzcywgYWRkcmVzcyBfZGVzdCwgdWludDI1NiBfdG9rZW5zUGVyUGVyaW9kKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUoX3Rva2Vuc1BlclBlcmlvZCA+IDApOwogICAgcmVxdWlyZShfdG9rZW5zUGVyUGVyaW9kIDw9IHJlbWFpbmluZ1Rva2Vuc1BlclBlcmlvZCk7CiAgICAvLyBJbiBzb2xpZGl0eSB0aGVyZSBpcyBubyAiZXhpc3QiIG1ldGhvZCBvbiBhIG1hcCBrZXkuCiAgICAvLyBXZSBjYW4ndCBvdmVyd3JpdGUgZXhpc3RpbmcgcHJvcG9zYWwsIHNvIHdlIGFyZSBjaGVja2luZyBpZiBpdCBpcyB0aGUgZGVmYXVsdCB2YWx1ZSAoMHgwKQogICAgLy8gQWRkIGBhbGxvY2F0aW9uT2ZbX2Rlc3RdLmFsbG9jYXRpb25TdGF0ZSA9PSBUeXBlcy5BbGxvY2F0aW9uU3RhdGUuUmVqZWN0ZWRgIGZvciBwb3NzaWJpbGl0eSB0byBvdmVyd3JpdGUgcmVqZWN0ZWQgYWxsb2NhdGlvbgogICAgcmVxdWlyZShhbGxvY2F0aW9uT2ZbX2Rlc3RdLnByb3Bvc2VyQWRkcmVzcyA9PSAweDAgfHwgYWxsb2NhdGlvbk9mW19kZXN0XS5hbGxvY2F0aW9uU3RhdGUgPT0gVHlwZXMuQWxsb2NhdGlvblN0YXRlLlJlamVjdGVkKTsKCiAgICBpZiAoYWxsb2NhdGlvbk9mW19kZXN0XS5hbGxvY2F0aW9uU3RhdGUgIT0gVHlwZXMuQWxsb2NhdGlvblN0YXRlLlJlamVjdGVkKSB7CiAgICAgIGFsbG9jYXRpb25BZGRyZXNzTGlzdC5wdXNoKF9kZXN0KTsKICAgIH0KCiAgICBhbGxvY2F0aW9uT2ZbX2Rlc3RdID0gVHlwZXMuU3RydWN0VmVzdGluZ0FsbG9jYXRpb24oewogICAgICB0b2tlbnNQZXJQZXJpb2Q6IF90b2tlbnNQZXJQZXJpb2QsCiAgICAgIGFsbG9jYXRpb25TdGF0ZTogVHlwZXMuQWxsb2NhdGlvblN0YXRlLlByb3Bvc2VkLAogICAgICBwcm9wb3NlckFkZHJlc3M6IF9wcm9wb3NlckFkZHJlc3MsCiAgICAgIGNsYWltZWRQZXJpb2RzOiAwCiAgICB9KTsKCiAgICByZW1haW5pbmdUb2tlbnNQZXJQZXJpb2QgPSByZW1haW5pbmdUb2tlbnNQZXJQZXJpb2QgLSBfdG9rZW5zUGVyUGVyaW9kOyAvLyBUT0RPIHNhZmUtbWF0aAogIH0KCiAgLyoqCiAgICogQXBwcm92ZXMgdGhlIHNwbGl0IGFsbG9jYXRpb24sIHNvIGl0IGNhbiBiZSBjbGFpbWVkIGFmdGVyIHBlcmlvZHMKICAgKgogICAqIEBwYXJhbSBfYWRkcmVzcyAtIGFkZHJlc3MgZm9yIHRoZSBzcGxpdAogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmVBbGxvY2F0aW9uKGFkZHJlc3MgX2FwcHJvdmVyQWRkcmVzcywgYWRkcmVzcyBfYWRkcmVzcykgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKGFsbG9jYXRpb25PZltfYWRkcmVzc10uYWxsb2NhdGlvblN0YXRlID09IFR5cGVzLkFsbG9jYXRpb25TdGF0ZS5Qcm9wb3NlZCk7CiAgICByZXF1aXJlKGFsbG9jYXRpb25PZltfYWRkcmVzc10ucHJvcG9zZXJBZGRyZXNzICE9IF9hcHByb3ZlckFkZHJlc3MpOwogICAgYWxsb2NhdGlvbk9mW19hZGRyZXNzXS5hbGxvY2F0aW9uU3RhdGUgPSBUeXBlcy5BbGxvY2F0aW9uU3RhdGUuQXBwcm92ZWQ7CiAgfQoKIC8qKgogICAqIFJlamVjdHMgdGhlIHNwbGl0IGFsbG9jYXRpb24KICAgKgogICAqIEBwYXJhbSBfYWRkcmVzcyAtIGFkZHJlc3MgZm9yIHRoZSBzcGxpdCB0byBiZSByZWplY3RlZAogICAqLwogIGZ1bmN0aW9uIHJlamVjdEFsbG9jYXRpb24oYWRkcmVzcyBfYWRkcmVzcykgcHVibGljIG9ubHlPd25lciB7CiAgICB2YXIgdG1wID0gYWxsb2NhdGlvbk9mW19hZGRyZXNzXTsKICAgIHJlcXVpcmUodG1wLmFsbG9jYXRpb25TdGF0ZSA9PSBUeXBlcy5BbGxvY2F0aW9uU3RhdGUuUHJvcG9zZWQpOwogICAgYWxsb2NhdGlvbk9mW19hZGRyZXNzXS5hbGxvY2F0aW9uU3RhdGUgPSBUeXBlcy5BbGxvY2F0aW9uU3RhdGUuUmVqZWN0ZWQ7CiAgICByZW1haW5pbmdUb2tlbnNQZXJQZXJpb2QgPSByZW1haW5pbmdUb2tlbnNQZXJQZXJpb2QgKyB0bXAudG9rZW5zUGVyUGVyaW9kOwogIH0KCiAgZnVuY3Rpb24gY2xhaW1Ub2tlbnMoYWRkcmVzcyBfYWRkcmVzcykgcHVibGljIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIFR5cGVzLlN0cnVjdFZlc3RpbmdBbGxvY2F0aW9uIHN0b3JhZ2UgYWxsb2MgPSBhbGxvY2F0aW9uT2ZbX2FkZHJlc3NdOwogICAgaWYgKGFsbG9jLmFsbG9jYXRpb25TdGF0ZSA9PSBUeXBlcy5BbGxvY2F0aW9uU3RhdGUuQXBwcm92ZWQpIHsKICAgICAgdWludDI1NiBwZXJpb2RzRWxhcHNlZCA9IFNhZmVNYXRoLm1pbigoYmxvY2sudGltZXN0YW1wIC0gaW5pdFRpbWVzdGFtcCkgLyAobWludXRlc0luUGVyaW9kICogMSBtaW51dGVzKSwgcGVyaW9kcyk7CiAgICAgIHVpbnQyNTYgdG9rZW5zID0gKHBlcmlvZHNFbGFwc2VkIC0gYWxsb2MuY2xhaW1lZFBlcmlvZHMpICogYWxsb2MudG9rZW5zUGVyUGVyaW9kOwogICAgICBhbGxvYy5jbGFpbWVkUGVyaW9kcyA9IHBlcmlvZHNFbGFwc2VkOwogICAgICByZXR1cm4gdG9rZW5zOwogICAgfQogICAgcmV0dXJuIDA7CiAgfQoKfQ=='.
	

]
