Class {
	#name : #SRTf5b0a3efb8e8e4c201e2a935f110eaaf3ffecb8d,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTf5b0a3efb8e8e4c201e2a935f110eaaf3ffecb8d >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7CgovLyBGaWxlOiBjb250cmFjdHMvZXJjL2VyYzE2NS9JRVJDMTY1LnNvbAoKLy8vIEB0aXRsZSBFUkMtMTY1IFN0YW5kYXJkIEludGVyZmFjZSBEZXRlY3Rpb24KLy8vIEBkZXYgU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2Jsb2IvbWFzdGVyL0VJUFMvZWlwLTE2NS5tZAppbnRlcmZhY2UgSUVSQzE2NSB7CiAgLy8vIEBub3RpY2UgUXVlcnkgaWYgYSBjb250cmFjdCBpbXBsZW1lbnRzIGFuIGludGVyZmFjZQogIC8vLyBAcGFyYW0gaW50ZXJmYWNlSUQgVGhlIGludGVyZmFjZSBpZGVudGlmaWVyLCBhcyBzcGVjaWZpZWQgaW4gRVJDLTE2NQogIC8vLyBAZGV2IEludGVyZmFjZSBpZGVudGlmaWNhdGlvbiBpcyBzcGVjaWZpZWQgaW4gRVJDLTE2NS4gVGhpcyBmdW5jdGlvbgogIC8vLyAgdXNlcyBsZXNzIHRoYW4gMzAsMDAwIGdhcy4KICAvLy8gQHJldHVybiBgdHJ1ZWAgaWYgdGhlIGNvbnRyYWN0IGltcGxlbWVudHMgYGludGVyZmFjZUlEYCBhbmQKICAvLy8gIGBpbnRlcmZhY2VJRGAgaXMgbm90IDB4ZmZmZmZmZmYsIGBmYWxzZWAgb3RoZXJ3aXNlCiAgZnVuY3Rpb24gc3VwcG9ydHNJbnRlcmZhY2UoYnl0ZXM0IGludGVyZmFjZUlEKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpOwp9CgovLyBGaWxlOiBjb250cmFjdHMvZXJjL2VyYzE2NS9FUkMxNjUuc29sCgpjb250cmFjdCBFUkMxNjUgaXMgSUVSQzE2NSB7CiAgLy8vIEBkZXYgWW91IG11c3Qgbm90IHNldCBlbGVtZW50IDB4ZmZmZmZmZmYgdG8gdHJ1ZQogIG1hcHBpbmcgKGJ5dGVzNCA9PiBib29sKSBpbnRlcm5hbCBzdXBwb3J0ZWRJbnRlcmZhY2VzOwoKICBmdW5jdGlvbiBFUkMxNjUoKSBpbnRlcm5hbCB7CiAgICBzdXBwb3J0ZWRJbnRlcmZhY2VzWzB4MDFmZmM5YTddID0gdHJ1ZTsgLy8gRVJDLTE2NQogIH0KCiAgZnVuY3Rpb24gc3VwcG9ydHNJbnRlcmZhY2UoYnl0ZXM0IGludGVyZmFjZUlEKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBzdXBwb3J0ZWRJbnRlcmZhY2VzW2ludGVyZmFjZUlEXTsKICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9lcmMvZXJjNzIxL0lFUkM3MjFCYXNlLnNvbAoKLy8vIEB0aXRsZSBFUkMtNzIxIE5vbi1GdW5naWJsZSBUb2tlbiBTdGFuZGFyZAovLy8gQGRldiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvYmxvYi9tYXN0ZXIvRUlQUy9laXAtNzIxLm1kCi8vLyAgTm90ZTogdGhlIEVSQy0xNjUgaWRlbnRpZmllciBmb3IgdGhpcyBpbnRlcmZhY2UgaXMgMHg2NDY2MzUzYwppbnRlcmZhY2UgSUVSQzcyMUJhc2UgLyogaXMgSUVSQzE2NSAgKi8gewogIC8vLyBAZGV2IFRoaXMgZW1pdHMgd2hlbiBvd25lcnNoaXAgb2YgYW55IE5GVCBjaGFuZ2VzIGJ5IGFueSBtZWNoYW5pc20uCiAgLy8vICBUaGlzIGV2ZW50IGVtaXRzIHdoZW4gTkZUcyBhcmUgY3JlYXRlZCAoYGZyb21gID09IDApIGFuZCBkZXN0cm95ZWQKICAvLy8gIChgdG9gID09IDApLiBFeGNlcHRpb246IGR1cmluZyBjb250cmFjdCBjcmVhdGlvbiwgYW55IG51bWJlciBvZiBORlRzCiAgLy8vICBtYXkgYmUgY3JlYXRlZCBhbmQgYXNzaWduZWQgd2l0aG91dCBlbWl0dGluZyBUcmFuc2Zlci4gQXQgdGhlIHRpbWUgb2YKICAvLy8gIGFueSB0cmFuc2ZlciwgdGhlIGFwcHJvdmVkIGFkZHJlc3MgZm9yIHRoYXQgTkZUIChpZiBhbnkpIGlzIHJlc2V0IHRvIG5vbmUuCiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF90b2tlbklkKTsKCiAgLy8vIEBkZXYgVGhpcyBlbWl0cyB3aGVuIHRoZSBhcHByb3ZlZCBhZGRyZXNzIGZvciBhbiBORlQgaXMgY2hhbmdlZCBvcgogIC8vLyAgcmVhZmZpcm1lZC4gVGhlIHplcm8gYWRkcmVzcyBpbmRpY2F0ZXMgdGhlcmUgaXMgbm8gYXBwcm92ZWQgYWRkcmVzcy4KICAvLy8gIFdoZW4gYSBUcmFuc2ZlciBldmVudCBlbWl0cywgdGhpcyBhbHNvIGluZGljYXRlcyB0aGF0IHRoZSBhcHByb3ZlZAogIC8vLyAgYWRkcmVzcyBmb3IgdGhhdCBORlQgKGlmIGFueSkgaXMgcmVzZXQgdG8gbm9uZS4KICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX2FwcHJvdmVkLCB1aW50MjU2IF90b2tlbklkKTsKCiAgLy8vIEBkZXYgVGhpcyBlbWl0cyB3aGVuIGFuIG9wZXJhdG9yIGlzIGVuYWJsZWQgb3IgZGlzYWJsZWQgZm9yIGFuIG93bmVyLgogIC8vLyAgVGhlIG9wZXJhdG9yIGNhbiBtYW5hZ2UgYWxsIE5GVHMgb2YgdGhlIG93bmVyLgogIGV2ZW50IEFwcHJvdmFsRm9yQWxsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfb3BlcmF0b3IsIGJvb2wgX2FwcHJvdmVkKTsKCiAgLy8vIEBub3RpY2UgQ291bnQgYWxsIE5GVHMgYXNzaWduZWQgdG8gYW4gb3duZXIKICAvLy8gQGRldiBORlRzIGFzc2lnbmVkIHRvIHRoZSB6ZXJvIGFkZHJlc3MgYXJlIGNvbnNpZGVyZWQgaW52YWxpZCwgYW5kIHRoaXMKICAvLy8gIGZ1bmN0aW9uIHRocm93cyBmb3IgcXVlcmllcyBhYm91dCB0aGUgemVybyBhZGRyZXNzLgogIC8vLyBAcGFyYW0gX293bmVyIEFuIGFkZHJlc3MgZm9yIHdob20gdG8gcXVlcnkgdGhlIGJhbGFuY2UKICAvLy8gQHJldHVybiBUaGUgbnVtYmVyIG9mIE5GVHMgb3duZWQgYnkgYF9vd25lcmAsIHBvc3NpYmx5IHplcm8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1Nik7CgogIC8vLyBAbm90aWNlIEZpbmQgdGhlIG93bmVyIG9mIGFuIE5GVAogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIGlkZW50aWZpZXIgZm9yIGFuIE5GVAogIC8vLyBAZGV2IE5GVHMgYXNzaWduZWQgdG8gemVybyBhZGRyZXNzIGFyZSBjb25zaWRlcmVkIGludmFsaWQsIGFuZCBxdWVyaWVzCiAgLy8vICBhYm91dCB0aGVtIGRvIHRocm93LgogIC8vLyBAcmV0dXJuIFRoZSBhZGRyZXNzIG9mIHRoZSBvd25lciBvZiB0aGUgTkZUCiAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF90b2tlbklkKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGFkZHJlc3MpOwoKICAvLy8gQG5vdGljZSBUcmFuc2ZlcnMgdGhlIG93bmVyc2hpcCBvZiBhbiBORlQgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyIGFkZHJlc3MKICAvLy8gQGRldiBUaHJvd3MgdW5sZXNzIGBtc2cuc2VuZGVyYCBpcyB0aGUgY3VycmVudCBvd25lciwgYW4gYXV0aG9yaXplZAogIC8vLyAgb3BlcmF0b3IsIG9yIHRoZSBhcHByb3ZlZCBhZGRyZXNzIGZvciB0aGlzIE5GVC4gVGhyb3dzIGlmIGBfZnJvbWAgaXMKICAvLy8gIG5vdCB0aGUgY3VycmVudCBvd25lci4gVGhyb3dzIGlmIGBfdG9gIGlzIHRoZSB6ZXJvIGFkZHJlc3MuIFRocm93cyBpZgogIC8vLyAgYF90b2tlbklkYCBpcyBub3QgYSB2YWxpZCBORlQuIFdoZW4gdHJhbnNmZXIgaXMgY29tcGxldGUsIHRoaXMgZnVuY3Rpb24KICAvLy8gIGNoZWNrcyBpZiBgX3RvYCBpcyBhIHNtYXJ0IGNvbnRyYWN0IChjb2RlIHNpemUgPiAwKS4gSWYgc28sIGl0IGNhbGxzCiAgLy8vICBgb25FUkM3MjFSZWNlaXZlZGAgb24gYF90b2AgYW5kIHRocm93cyBpZiB0aGUgcmV0dXJuIHZhbHVlIGlzIG5vdAogIC8vLyAgYGJ5dGVzNChrZWNjYWsyNTYoIm9uRVJDNzIxUmVjZWl2ZWQoYWRkcmVzcyx1aW50MjU2LGJ5dGVzKSIpKWAuCiAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgY3VycmVudCBvd25lciBvZiB0aGUgTkZUCiAgLy8vIEBwYXJhbSBfdG8gVGhlIG5ldyBvd25lcgogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIE5GVCB0byB0cmFuc2ZlcgogIC8vLyBAcGFyYW0gX2RhdGEgQWRkaXRpb25hbCBkYXRhIHdpdGggbm8gc3BlY2lmaWVkIGZvcm1hdCwgc2VudCBpbiBjYWxsIHRvIGBfdG9gCiAgLy8gc29saXVtLWRpc2FibGUtbmV4dC1saW5lIGFyZy1vdmVyZmxvdwogIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQsIGJ5dGVzIF9kYXRhKSBleHRlcm5hbCBwYXlhYmxlOwoKICAvLy8gQG5vdGljZSBUcmFuc2ZlcnMgdGhlIG93bmVyc2hpcCBvZiBhbiBORlQgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyIGFkZHJlc3MKICAvLy8gQGRldiBUaGlzIHdvcmtzIGlkZW50aWNhbGx5IHRvIHRoZSBvdGhlciBmdW5jdGlvbiB3aXRoIGFuIGV4dHJhIGRhdGEgcGFyYW1ldGVyLAogIC8vLyAgZXhjZXB0IHRoaXMgZnVuY3Rpb24ganVzdCBzZXRzIGRhdGEgdG8gW10KICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBjdXJyZW50IG93bmVyIG9mIHRoZSBORlQKICAvLy8gQHBhcmFtIF90byBUaGUgbmV3IG93bmVyCiAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgTkZUIHRvIHRyYW5zZmVyCiAgZnVuY3Rpb24gc2FmZVRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWwgcGF5YWJsZTsKCiAgLy8vIEBub3RpY2UgVHJhbnNmZXIgb3duZXJzaGlwIG9mIGFuIE5GVCAtLSBUSEUgQ0FMTEVSIElTIFJFU1BPTlNJQkxFCiAgLy8vICBUTyBDT05GSVJNIFRIQVQgYF90b2AgSVMgQ0FQQUJMRSBPRiBSRUNFSVZJTkcgTkZUUyBPUiBFTFNFCiAgLy8vICBUSEVZIE1BWSBCRSBQRVJNQU5FTlRMWSBMT1NUCiAgLy8vIEBkZXYgVGhyb3dzIHVubGVzcyBgbXNnLnNlbmRlcmAgaXMgdGhlIGN1cnJlbnQgb3duZXIsIGFuIGF1dGhvcml6ZWQKICAvLy8gIG9wZXJhdG9yLCBvciB0aGUgYXBwcm92ZWQgYWRkcmVzcyBmb3IgdGhpcyBORlQuIFRocm93cyBpZiBgX2Zyb21gIGlzCiAgLy8vICBub3QgdGhlIGN1cnJlbnQgb3duZXIuIFRocm93cyBpZiBgX3RvYCBpcyB0aGUgemVybyBhZGRyZXNzLiBUaHJvd3MgaWYKICAvLy8gIGBfdG9rZW5JZGAgaXMgbm90IGEgdmFsaWQgTkZULgogIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGN1cnJlbnQgb3duZXIgb2YgdGhlIE5GVAogIC8vLyBAcGFyYW0gX3RvIFRoZSBuZXcgb3duZXIKICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSBORlQgdG8gdHJhbnNmZXIKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsIHBheWFibGU7CgogIC8vLyBAbm90aWNlIFNldCBvciByZWFmZmlybSB0aGUgYXBwcm92ZWQgYWRkcmVzcyBmb3IgYW4gTkZUCiAgLy8vIEBkZXYgVGhlIHplcm8gYWRkcmVzcyBpbmRpY2F0ZXMgdGhlcmUgaXMgbm8gYXBwcm92ZWQgYWRkcmVzcy4KICAvLy8gQGRldiBUaHJvd3MgdW5sZXNzIGBtc2cuc2VuZGVyYCBpcyB0aGUgY3VycmVudCBORlQgb3duZXIsIG9yIGFuIGF1dGhvcml6ZWQKICAvLy8gIG9wZXJhdG9yIG9mIHRoZSBjdXJyZW50IG93bmVyLgogIC8vLyBAcGFyYW0gX2FwcHJvdmVkIFRoZSBuZXcgYXBwcm92ZWQgTkZUIGNvbnRyb2xsZXIKICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSBORlQgdG8gYXBwcm92ZQogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfYXBwcm92ZWQsIHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsIHBheWFibGU7CgogIC8vLyBAbm90aWNlIEVuYWJsZSBvciBkaXNhYmxlIGFwcHJvdmFsIGZvciBhIHRoaXJkIHBhcnR5ICgib3BlcmF0b3IiKSB0byBtYW5hZ2UKICAvLy8gIGFsbCB5b3VyIGFzc2V0LgogIC8vLyBAZGV2IEVtaXRzIHRoZSBBcHByb3ZhbEZvckFsbCBldmVudAogIC8vLyBAcGFyYW0gX29wZXJhdG9yIEFkZHJlc3MgdG8gYWRkIHRvIHRoZSBzZXQgb2YgYXV0aG9yaXplZCBvcGVyYXRvcnMuCiAgLy8vIEBwYXJhbSBfYXBwcm92ZWQgVHJ1ZSBpZiB0aGUgb3BlcmF0b3JzIGlzIGFwcHJvdmVkLCBmYWxzZSB0byByZXZva2UgYXBwcm92YWwKICBmdW5jdGlvbiBzZXRBcHByb3ZhbEZvckFsbChhZGRyZXNzIF9vcGVyYXRvciwgYm9vbCBfYXBwcm92ZWQpIGV4dGVybmFsOwoKICAvLy8gQG5vdGljZSBHZXQgdGhlIGFwcHJvdmVkIGFkZHJlc3MgZm9yIGEgc2luZ2xlIE5GVAogIC8vLyBAZGV2IFRocm93cyBpZiBgX3Rva2VuSWRgIGlzIG5vdCBhIHZhbGlkIE5GVAogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIE5GVCB0byBmaW5kIHRoZSBhcHByb3ZlZCBhZGRyZXNzIGZvcgogIC8vLyBAcmV0dXJuIFRoZSBhcHByb3ZlZCBhZGRyZXNzIGZvciB0aGlzIE5GVCwgb3IgdGhlIHplcm8gYWRkcmVzcyBpZiB0aGVyZSBpcyBub25lCiAgZnVuY3Rpb24gZ2V0QXBwcm92ZWQodWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKCiAgLy8vIEBub3RpY2UgUXVlcnkgaWYgYW4gYWRkcmVzcyBpcyBhbiBhdXRob3JpemVkIG9wZXJhdG9yIGZvciBhbm90aGVyIGFkZHJlc3MKICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0aGF0IG93bnMgdGhlIE5GVHMKICAvLy8gQHBhcmFtIF9vcGVyYXRvciBUaGUgYWRkcmVzcyB0aGF0IGFjdHMgb24gYmVoYWxmIG9mIHRoZSBvd25lcgogIC8vLyBAcmV0dXJuIFRydWUgaWYgYF9vcGVyYXRvcmAgaXMgYW4gYXBwcm92ZWQgb3BlcmF0b3IgZm9yIGBfb3duZXJgLCBmYWxzZSBvdGhlcndpc2UKICBmdW5jdGlvbiBpc0FwcHJvdmVkRm9yQWxsKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9vcGVyYXRvcikgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChib29sKTsKfQoKLy8gRmlsZTogY29udHJhY3RzL2VyYy9lcmM3MjEvSUVSQzcyMUVudW1lcmFibGUuc29sCgovLy8gQHRpdGxlIEVSQy03MjEgTm9uLUZ1bmdpYmxlIFRva2VuIFN0YW5kYXJkLCBvcHRpb25hbCBlbnVtZXJhdGlvbiBleHRlbnNpb24KLy8vIEBkZXYgU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2Jsb2IvbWFzdGVyL0VJUFMvZWlwLTcyMS5tZAovLy8gIE5vdGU6IHRoZSBFUkMtMTY1IGlkZW50aWZpZXIgZm9yIHRoaXMgaW50ZXJmYWNlIGlzIDB4NzgwZTlkNjMKaW50ZXJmYWNlIElFUkM3MjFFbnVtZXJhYmxlIC8qIGlzIElFUkM3MjFCYXNlICovIHsKICAvLy8gQG5vdGljZSBDb3VudCBORlRzIHRyYWNrZWQgYnkgdGhpcyBjb250cmFjdAogIC8vLyBAcmV0dXJuIEEgY291bnQgb2YgdmFsaWQgTkZUcyB0cmFja2VkIGJ5IHRoaXMgY29udHJhY3QsIHdoZXJlIGVhY2ggb25lIG9mCiAgLy8vICB0aGVtIGhhcyBhbiBhc3NpZ25lZCBhbmQgcXVlcnlhYmxlIG93bmVyIG5vdCBlcXVhbCB0byB0aGUgemVybyBhZGRyZXNzCiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwoKICAvLy8gQG5vdGljZSBFbnVtZXJhdGUgdmFsaWQgTkZUcwogIC8vLyBAZGV2IFRocm93cyBpZiBgX2luZGV4YCA+PSBgdG90YWxTdXBwbHkoKWAuCiAgLy8vIEBwYXJhbSBfaW5kZXggQSBjb3VudGVyIGxlc3MgdGhhbiBgdG90YWxTdXBwbHkoKWAKICAvLy8gQHJldHVybiBUaGUgdG9rZW4gaWRlbnRpZmllciBmb3IgdGhlIGBfaW5kZXhgdGggTkZULAogIC8vLyAgKHNvcnQgb3JkZXIgbm90IHNwZWNpZmllZCkKICBmdW5jdGlvbiB0b2tlbkJ5SW5kZXgodWludDI1NiBfaW5kZXgpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1Nik7CgogIC8vLyBAbm90aWNlIEVudW1lcmF0ZSBORlRzIGFzc2lnbmVkIHRvIGFuIG93bmVyCiAgLy8vIEBkZXYgVGhyb3dzIGlmIGBfaW5kZXhgID49IGBiYWxhbmNlT2YoX293bmVyKWAgb3IgaWYKICAvLy8gIGBfb3duZXJgIGlzIHRoZSB6ZXJvIGFkZHJlc3MsIHJlcHJlc2VudGluZyBpbnZhbGlkIE5GVHMuCiAgLy8vIEBwYXJhbSBfb3duZXIgQW4gYWRkcmVzcyB3aGVyZSB3ZSBhcmUgaW50ZXJlc3RlZCBpbiBORlRzIG93bmVkIGJ5IHRoZW0KICAvLy8gQHBhcmFtIF9pbmRleCBBIGNvdW50ZXIgbGVzcyB0aGFuIGBiYWxhbmNlT2YoX293bmVyKWAKICAvLy8gQHJldHVybiBUaGUgdG9rZW4gaWRlbnRpZmllciBmb3IgdGhlIGBfaW5kZXhgdGggTkZUIGFzc2lnbmVkIHRvIGBfb3duZXJgLAogIC8vLyAgIChzb3J0IG9yZGVyIG5vdCBzcGVjaWZpZWQpCiAgZnVuY3Rpb24gdG9rZW5PZk93bmVyQnlJbmRleChhZGRyZXNzIF9vd25lciwgdWludDI1NiBfaW5kZXgpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NiBfdG9rZW5JZCk7Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9lcmMvZXJjNzIxL0lFUkM3MjFUb2tlblJlY2VpdmVyLnNvbAoKLy8vIEBkZXYgTm90ZTogdGhlIEVSQy0xNjUgaWRlbnRpZmllciBmb3IgdGhpcyBpbnRlcmZhY2UgaXMgMHhmMGI5ZTViYQppbnRlcmZhY2UgSUVSQzcyMVRva2VuUmVjZWl2ZXIgewogIC8vLyBAbm90aWNlIEhhbmRsZSB0aGUgcmVjZWlwdCBvZiBhbiBORlQKICAvLy8gQGRldiBUaGUgRVJDNzIxIHNtYXJ0IGNvbnRyYWN0IGNhbGxzIHRoaXMgZnVuY3Rpb24gb24gdGhlIHJlY2lwaWVudAogIC8vLyAgYWZ0ZXIgYSBgdHJhbnNmZXJgLiBUaGlzIGZ1bmN0aW9uIE1BWSB0aHJvdyB0byByZXZlcnQgYW5kIHJlamVjdCB0aGUKICAvLy8gIHRyYW5zZmVyLiBUaGlzIGZ1bmN0aW9uIE1VU1QgdXNlIDUwLDAwMCBnYXMgb3IgbGVzcy4gUmV0dXJuIG9mIG90aGVyCiAgLy8vICB0aGFuIHRoZSBtYWdpYyB2YWx1ZSBNVVNUIHJlc3VsdCBpbiB0aGUgdHJhbnNhY3Rpb24gYmVpbmcgcmV2ZXJ0ZWQuCiAgLy8vICBOb3RlOiB0aGUgY29udHJhY3QgYWRkcmVzcyBpcyBhbHdheXMgdGhlIG1lc3NhZ2Ugc2VuZGVyLgogIC8vLyBAcGFyYW0gX2Zyb20gVGhlIHNlbmRpbmcgYWRkcmVzcwogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIE5GVCBpZGVudGlmaWVyIHdoaWNoIGlzIGJlaW5nIHRyYW5zZmVyZWQKICAvLy8gQHBhcmFtIF9kYXRhIEFkZGl0aW9uYWwgZGF0YSB3aXRoIG5vIHNwZWNpZmllZCBmb3JtYXQKICAvLy8gQHJldHVybiBgYnl0ZXM0KGtlY2NhazI1Nigib25FUkM3MjFSZWNlaXZlZChhZGRyZXNzLHVpbnQyNTYsYnl0ZXMpIikpYAogIC8vLyAgdW5sZXNzIHRocm93aW5nCglmdW5jdGlvbiBvbkVSQzcyMVJlY2VpdmVkKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3Rva2VuSWQsIGJ5dGVzIF9kYXRhKSBleHRlcm5hbCByZXR1cm5zIChieXRlczQpOwp9CgovLyBGaWxlOiBjb250cmFjdHMvY29yZS9kZXBlbmRlbmN5L0F4aWVNYW5hZ2VyLnNvbAoKaW50ZXJmYWNlIEF4aWVTcGF3bmluZ01hbmFnZXIgewoJZnVuY3Rpb24gaXNTcGF3bmluZ0FsbG93ZWQodWludDI1NiBfZ2VuZXMsIGFkZHJlc3MgX293bmVyKSBleHRlcm5hbCByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBpc1JlYmlydGhBbGxvd2VkKHVpbnQyNTYgX2F4aWVJZCwgdWludDI1NiBfZ2VuZXMpIGV4dGVybmFsIHJldHVybnMgKGJvb2wpOwp9CgppbnRlcmZhY2UgQXhpZVJldGlyZW1lbnRNYW5hZ2VyIHsKICBmdW5jdGlvbiBpc1JldGlyZW1lbnRBbGxvd2VkKHVpbnQyNTYgX2F4aWVJZCwgYm9vbCBfcmlwKSBleHRlcm5hbCByZXR1cm5zIChib29sKTsKfQoKaW50ZXJmYWNlIEF4aWVNYXJrZXRwbGFjZU1hbmFnZXIgewogIGZ1bmN0aW9uIGlzVHJhbnNmZXJBbGxvd2VkKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF9heGllSWQpIGV4dGVybmFsIHJldHVybnMgKGJvb2wpOwp9CgppbnRlcmZhY2UgQXhpZUdlbmVNYW5hZ2VyIHsKICBmdW5jdGlvbiBpc0V2b2x2ZW1lbnRBbGxvd2VkKHVpbnQyNTYgX2F4aWVJZCwgdWludDI1NiBfbmV3R2VuZXMpIGV4dGVybmFsIHJldHVybnMgKGJvb2wpOwp9CgovLyBGaWxlOiBjb250cmFjdHMvY29yZS9kZXBlbmRlbmN5L0F4aWVEZXBlbmRlbmN5LnNvbAoKY29udHJhY3QgQXhpZURlcGVuZGVuY3kgewoKICBhZGRyZXNzIHB1YmxpYyB3aGl0ZWxpc3RTZXR0ZXJBZGRyZXNzOwoKICBBeGllU3Bhd25pbmdNYW5hZ2VyIHB1YmxpYyBzcGF3bmluZ01hbmFnZXI7CiAgQXhpZVJldGlyZW1lbnRNYW5hZ2VyIHB1YmxpYyByZXRpcmVtZW50TWFuYWdlcjsKICBBeGllTWFya2V0cGxhY2VNYW5hZ2VyIHB1YmxpYyBtYXJrZXRwbGFjZU1hbmFnZXI7CiAgQXhpZUdlbmVNYW5hZ2VyIHB1YmxpYyBnZW5lTWFuYWdlcjsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgd2hpdGVsaXN0ZWRTcGF3bmVyOwogIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIHdoaXRlbGlzdGVkQnllU2F5ZXI7CiAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgd2hpdGVsaXN0ZWRNYXJrZXRwbGFjZTsKICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyB3aGl0ZWxpc3RlZEdlbmVTY2llbnRpc3Q7CgogIGZ1bmN0aW9uIEF4aWVEZXBlbmRlbmN5KCkgaW50ZXJuYWwgewogICAgd2hpdGVsaXN0U2V0dGVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgfQoKICBtb2RpZmllciBvbmx5V2hpdGVsaXN0U2V0dGVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHdoaXRlbGlzdFNldHRlckFkZHJlc3MpOwogICAgXzsKICB9CgogIG1vZGlmaWVyIHdoZW5TcGF3bmluZ0FsbG93ZWQodWludDI1NiBfZ2VuZXMsIGFkZHJlc3MgX293bmVyKSB7CiAgICByZXF1aXJlKAogICAgICBzcGF3bmluZ01hbmFnZXIgPT0gYWRkcmVzcygwKSB8fAogICAgICAgIHNwYXduaW5nTWFuYWdlci5pc1NwYXduaW5nQWxsb3dlZChfZ2VuZXMsIF9vd25lcikKICAgICk7CiAgICBfOwogIH0KCiAgbW9kaWZpZXIgd2hlblJlYmlydGhBbGxvd2VkKHVpbnQyNTYgX2F4aWVJZCwgdWludDI1NiBfZ2VuZXMpIHsKICAgIHJlcXVpcmUoCiAgICAgIHNwYXduaW5nTWFuYWdlciA9PSBhZGRyZXNzKDApIHx8CiAgICAgICAgc3Bhd25pbmdNYW5hZ2VyLmlzUmViaXJ0aEFsbG93ZWQoX2F4aWVJZCwgX2dlbmVzKQogICAgKTsKICAgIF87CiAgfQoKICBtb2RpZmllciB3aGVuUmV0aXJlbWVudEFsbG93ZWQodWludDI1NiBfYXhpZUlkLCBib29sIF9yaXApIHsKICAgIHJlcXVpcmUoCiAgICAgIHJldGlyZW1lbnRNYW5hZ2VyID09IGFkZHJlc3MoMCkgfHwKICAgICAgICByZXRpcmVtZW50TWFuYWdlci5pc1JldGlyZW1lbnRBbGxvd2VkKF9heGllSWQsIF9yaXApCiAgICApOwogICAgXzsKICB9CgogIG1vZGlmaWVyIHdoZW5UcmFuc2ZlckFsbG93ZWQoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2F4aWVJZCkgewogICAgcmVxdWlyZSgKICAgICAgbWFya2V0cGxhY2VNYW5hZ2VyID09IGFkZHJlc3MoMCkgfHwKICAgICAgICBtYXJrZXRwbGFjZU1hbmFnZXIuaXNUcmFuc2ZlckFsbG93ZWQoX2Zyb20sIF90bywgX2F4aWVJZCkKICAgICk7CiAgICBfOwogIH0KCiAgbW9kaWZpZXIgd2hlbkV2b2x2ZW1lbnRBbGxvd2VkKHVpbnQyNTYgX2F4aWVJZCwgdWludDI1NiBfbmV3R2VuZXMpIHsKICAgIHJlcXVpcmUoCiAgICAgIGdlbmVNYW5hZ2VyID09IGFkZHJlc3MoMCkgfHwKICAgICAgICBnZW5lTWFuYWdlci5pc0V2b2x2ZW1lbnRBbGxvd2VkKF9heGllSWQsIF9uZXdHZW5lcykKICAgICk7CiAgICBfOwogIH0KCiAgbW9kaWZpZXIgb25seVNwYXduZXIoKSB7CiAgICByZXF1aXJlKHdoaXRlbGlzdGVkU3Bhd25lclttc2cuc2VuZGVyXSk7CiAgICBfOwogIH0KCiAgbW9kaWZpZXIgb25seUJ5ZVNheWVyKCkgewogICAgcmVxdWlyZSh3aGl0ZWxpc3RlZEJ5ZVNheWVyW21zZy5zZW5kZXJdKTsKICAgIF87CiAgfQoKICBtb2RpZmllciBvbmx5TWFya2V0cGxhY2UoKSB7CiAgICByZXF1aXJlKHdoaXRlbGlzdGVkTWFya2V0cGxhY2VbbXNnLnNlbmRlcl0pOwogICAgXzsKICB9CgogIG1vZGlmaWVyIG9ubHlHZW5lU2NpZW50aXN0KCkgewogICAgcmVxdWlyZSh3aGl0ZWxpc3RlZEdlbmVTY2llbnRpc3RbbXNnLnNlbmRlcl0pOwogICAgXzsKICB9CgogIC8qCiAgICogQGRldiBTZXR0aW5nIHRoZSB3aGl0ZWxpc3Qgc2V0dGVyIGFkZHJlc3MgdG8gYGFkZHJlc3MoMClgIHdvdWxkIGJlIGEgaXJyZXZlcnNpYmxlIHByb2Nlc3MuCiAgICogIFRoaXMgaXMgdG8gbG9jayBjaGFuZ2VzIHRvIEF4aWUncyBjb250cmFjdHMgYWZ0ZXIgdGhlaXIgZGV2ZWxvcG1lbnQgaXMgZG9uZS4KICAgKi8KICBmdW5jdGlvbiBzZXRXaGl0ZWxpc3RTZXR0ZXIoYWRkcmVzcyBfbmV3U2V0dGVyKSBleHRlcm5hbCBvbmx5V2hpdGVsaXN0U2V0dGVyIHsKICAgIHdoaXRlbGlzdFNldHRlckFkZHJlc3MgPSBfbmV3U2V0dGVyOwogIH0KCiAgZnVuY3Rpb24gc2V0U3Bhd25pbmdNYW5hZ2VyKGFkZHJlc3MgX21hbmFnZXIpIGV4dGVybmFsIG9ubHlXaGl0ZWxpc3RTZXR0ZXIgewogICAgc3Bhd25pbmdNYW5hZ2VyID0gQXhpZVNwYXduaW5nTWFuYWdlcihfbWFuYWdlcik7CiAgfQoKICBmdW5jdGlvbiBzZXRSZXRpcmVtZW50TWFuYWdlcihhZGRyZXNzIF9tYW5hZ2VyKSBleHRlcm5hbCBvbmx5V2hpdGVsaXN0U2V0dGVyIHsKICAgIHJldGlyZW1lbnRNYW5hZ2VyID0gQXhpZVJldGlyZW1lbnRNYW5hZ2VyKF9tYW5hZ2VyKTsKICB9CgogIGZ1bmN0aW9uIHNldE1hcmtldHBsYWNlTWFuYWdlcihhZGRyZXNzIF9tYW5hZ2VyKSBleHRlcm5hbCBvbmx5V2hpdGVsaXN0U2V0dGVyIHsKICAgIG1hcmtldHBsYWNlTWFuYWdlciA9IEF4aWVNYXJrZXRwbGFjZU1hbmFnZXIoX21hbmFnZXIpOwogIH0KCiAgZnVuY3Rpb24gc2V0R2VuZU1hbmFnZXIoYWRkcmVzcyBfbWFuYWdlcikgZXh0ZXJuYWwgb25seVdoaXRlbGlzdFNldHRlciB7CiAgICBnZW5lTWFuYWdlciA9IEF4aWVHZW5lTWFuYWdlcihfbWFuYWdlcik7CiAgfQoKICBmdW5jdGlvbiBzZXRTcGF3bmVyKGFkZHJlc3MgX3NwYXduZXIsIGJvb2wgX3doaXRlbGlzdGVkKSBleHRlcm5hbCBvbmx5V2hpdGVsaXN0U2V0dGVyIHsKICAgIHJlcXVpcmUod2hpdGVsaXN0ZWRTcGF3bmVyW19zcGF3bmVyXSAhPSBfd2hpdGVsaXN0ZWQpOwogICAgd2hpdGVsaXN0ZWRTcGF3bmVyW19zcGF3bmVyXSA9IF93aGl0ZWxpc3RlZDsKICB9CgogIGZ1bmN0aW9uIHNldEJ5ZVNheWVyKGFkZHJlc3MgX2J5ZVNheWVyLCBib29sIF93aGl0ZWxpc3RlZCkgZXh0ZXJuYWwgb25seVdoaXRlbGlzdFNldHRlciB7CiAgICByZXF1aXJlKHdoaXRlbGlzdGVkQnllU2F5ZXJbX2J5ZVNheWVyXSAhPSBfd2hpdGVsaXN0ZWQpOwogICAgd2hpdGVsaXN0ZWRCeWVTYXllcltfYnllU2F5ZXJdID0gX3doaXRlbGlzdGVkOwogIH0KCiAgZnVuY3Rpb24gc2V0TWFya2V0cGxhY2UoYWRkcmVzcyBfbWFya2V0cGxhY2UsIGJvb2wgX3doaXRlbGlzdGVkKSBleHRlcm5hbCBvbmx5V2hpdGVsaXN0U2V0dGVyIHsKICAgIHJlcXVpcmUod2hpdGVsaXN0ZWRNYXJrZXRwbGFjZVtfbWFya2V0cGxhY2VdICE9IF93aGl0ZWxpc3RlZCk7CiAgICB3aGl0ZWxpc3RlZE1hcmtldHBsYWNlW19tYXJrZXRwbGFjZV0gPSBfd2hpdGVsaXN0ZWQ7CiAgfQoKICBmdW5jdGlvbiBzZXRHZW5lU2NpZW50aXN0KGFkZHJlc3MgX2dlbmVTY2llbnRpc3QsIGJvb2wgX3doaXRlbGlzdGVkKSBleHRlcm5hbCBvbmx5V2hpdGVsaXN0U2V0dGVyIHsKICAgIHJlcXVpcmUod2hpdGVsaXN0ZWRHZW5lU2NpZW50aXN0W19nZW5lU2NpZW50aXN0XSAhPSBfd2hpdGVsaXN0ZWQpOwogICAgd2hpdGVsaXN0ZWRHZW5lU2NpZW50aXN0W19nZW5lU2NpZW50aXN0XSA9IF93aGl0ZWxpc3RlZDsKICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9jb3JlL0F4aWVBY2Nlc3NDb250cm9sLnNvbAoKY29udHJhY3QgQXhpZUFjY2Vzc0NvbnRyb2wgewoKICBhZGRyZXNzIHB1YmxpYyBjZW9BZGRyZXNzOwogIGFkZHJlc3MgcHVibGljIGNmb0FkZHJlc3M7CiAgYWRkcmVzcyBwdWJsaWMgY29vQWRkcmVzczsKCiAgZnVuY3Rpb24gQXhpZUFjY2Vzc0NvbnRyb2woKSBpbnRlcm5hbCB7CiAgICBjZW9BZGRyZXNzID0gbXNnLnNlbmRlcjsKICB9CgogIG1vZGlmaWVyIG9ubHlDRU8oKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY2VvQWRkcmVzcyk7CiAgICBfOwogIH0KCiAgbW9kaWZpZXIgb25seUNGTygpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjZm9BZGRyZXNzKTsKICAgIF87CiAgfQoKICBtb2RpZmllciBvbmx5Q09PKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNvb0FkZHJlc3MpOwogICAgXzsKICB9CgogIG1vZGlmaWVyIG9ubHlDTGV2ZWwoKSB7CiAgICByZXF1aXJlKAogICAgICAvLyBzb2xpdW0tZGlzYWJsZSBvcGVyYXRvci13aGl0ZXNwYWNlCiAgICAgIG1zZy5zZW5kZXIgPT0gY2VvQWRkcmVzcyB8fAogICAgICAgIG1zZy5zZW5kZXIgPT0gY2ZvQWRkcmVzcyB8fAogICAgICAgIG1zZy5zZW5kZXIgPT0gY29vQWRkcmVzcwogICAgICAvLyBzb2xpdW0tZW5hYmxlIG9wZXJhdG9yLXdoaXRlc3BhY2UKICAgICk7CiAgICBfOwogIH0KCiAgZnVuY3Rpb24gc2V0Q0VPKGFkZHJlc3MgX25ld0NFTykgZXh0ZXJuYWwgb25seUNFTyB7CiAgICByZXF1aXJlKF9uZXdDRU8gIT0gYWRkcmVzcygwKSk7CiAgICBjZW9BZGRyZXNzID0gX25ld0NFTzsKICB9CgogIGZ1bmN0aW9uIHNldENGTyhhZGRyZXNzIF9uZXdDRk8pIGV4dGVybmFsIG9ubHlDRU8gewogICAgY2ZvQWRkcmVzcyA9IF9uZXdDRk87CiAgfQoKICBmdW5jdGlvbiBzZXRDT08oYWRkcmVzcyBfbmV3Q09PKSBleHRlcm5hbCBvbmx5Q0VPIHsKICAgIGNvb0FkZHJlc3MgPSBfbmV3Q09POwogIH0KCiAgZnVuY3Rpb24gd2l0aGRyYXdCYWxhbmNlKCkgZXh0ZXJuYWwgb25seUNGTyB7CiAgICBjZm9BZGRyZXNzLnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgfQp9CgovLyBGaWxlOiBjb250cmFjdHMvY29yZS9saWZlY3ljbGUvQXhpZVBhdXNhYmxlLnNvbAoKY29udHJhY3QgQXhpZVBhdXNhYmxlIGlzIEF4aWVBY2Nlc3NDb250cm9sIHsKCiAgYm9vbCBwdWJsaWMgcGF1c2VkID0gZmFsc2U7CgogIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICByZXF1aXJlKCFwYXVzZWQpOwogICAgXzsKICB9CgogIG1vZGlmaWVyIHdoZW5QYXVzZWQgewogICAgcmVxdWlyZShwYXVzZWQpOwogICAgXzsKICB9CgogIGZ1bmN0aW9uIHBhdXNlKCkgZXh0ZXJuYWwgb25seUNMZXZlbCB3aGVuTm90UGF1c2VkIHsKICAgIHBhdXNlZCA9IHRydWU7CiAgfQoKICBmdW5jdGlvbiB1bnBhdXNlKCkgcHVibGljIG9ubHlDRU8gd2hlblBhdXNlZCB7CiAgICBwYXVzZWQgPSBmYWxzZTsKICB9Cn0KCi8vIEZpbGU6IHplcHBlbGluL2NvbnRyYWN0cy9tYXRoL1NhZmVNYXRoLnNvbAoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9jb3JlL2VyYzcyMS9BeGllRVJDNzIxQmFzZUVudW1lcmFibGUuc29sCgpjb250cmFjdCBBeGllRVJDNzIxQmFzZUVudW1lcmFibGUgaXMgRVJDMTY1LCBJRVJDNzIxQmFzZSwgSUVSQzcyMUVudW1lcmFibGUsIEF4aWVEZXBlbmRlbmN5LCBBeGllUGF1c2FibGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAvLyBAZGV2IFRvdGFsIGFtb3VudCBvZiB0b2tlbnMuCiAgdWludDI1NiBwcml2YXRlIF90b3RhbFRva2VuczsKCiAgLy8gQGRldiBNYXBwaW5nIGZyb20gdG9rZW4gaW5kZXggdG8gSUQuCiAgbWFwcGluZyAodWludDI1NiA9PiB1aW50MjU2KSBwcml2YXRlIF9vdmVyYWxsVG9rZW5JZDsKCiAgLy8gQGRldiBNYXBwaW5nIGZyb20gdG9rZW4gSUQgdG8gaW5kZXguCiAgbWFwcGluZyAodWludDI1NiA9PiB1aW50MjU2KSBwcml2YXRlIF9vdmVyYWxsVG9rZW5JbmRleDsKCiAgLy8gQGRldiBNYXBwaW5nIGZyb20gdG9rZW4gSUQgdG8gb3duZXIuCiAgbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSBwcml2YXRlIF90b2tlbk93bmVyOwoKICAvLyBAZGV2IEZvciBhIGdpdmVuIG93bmVyIGFuZCBhIGdpdmVuIG9wZXJhdG9yLCBzdG9yZSB3aGV0aGVyCiAgLy8gIHRoZSBvcGVyYXRvciBpcyBhbGxvd2VkIHRvIG1hbmFnZSB0b2tlbnMgb24gYmVoYWxmIG9mIHRoZSBvd25lci4KICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkpIHByaXZhdGUgX3Rva2VuT3BlcmF0b3I7CgogIC8vIEBkZXYgTWFwcGluZyBmcm9tIHRva2VuIElEIHRvIGFwcHJvdmVkIGFkZHJlc3MuCiAgbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSBwcml2YXRlIF90b2tlbkFwcHJvdmFsOwoKICAvLyBAZGV2IE1hcHBpbmcgZnJvbSBvd25lciB0byBsaXN0IG9mIG93bmVkIHRva2VuIElEcy4KICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTZbXSkgcHJpdmF0ZSBfb3duZWRUb2tlbnM7CgogIC8vIEBkZXYgTWFwcGluZyBmcm9tIHRva2VuIElEIHRvIGluZGV4IGluIHRoZSBvd25lZCB0b2tlbiBsaXN0LgogIG1hcHBpbmcgKHVpbnQyNTYgPT4gdWludDI1NikgcHJpdmF0ZSBfb3duZWRUb2tlbkluZGV4OwoKICBmdW5jdGlvbiBBeGllRVJDNzIxQmFzZUVudW1lcmFibGUoKSBpbnRlcm5hbCB7CiAgICBzdXBwb3J0ZWRJbnRlcmZhY2VzWzB4NjQ2NjM1M2NdID0gdHJ1ZTsgLy8gRVJDLTcyMSBCYXNlCiAgICBzdXBwb3J0ZWRJbnRlcmZhY2VzWzB4NzgwZTlkNjNdID0gdHJ1ZTsgLy8gRVJDLTcyMSBFbnVtZXJhYmxlCiAgfQoKICAvLyBzb2xpdW0tZGlzYWJsZSBmdW5jdGlvbi1vcmRlcgoKICBtb2RpZmllciBtdXN0QmVWYWxpZFRva2VuKHVpbnQyNTYgX3Rva2VuSWQpIHsKICAgIHJlcXVpcmUoX3Rva2VuT3duZXJbX3Rva2VuSWRdICE9IGFkZHJlc3MoMCkpOwogICAgXzsKICB9CgogIGZ1bmN0aW9uIF9pc1Rva2VuT3duZXIoYWRkcmVzcyBfb3duZXJUb0NoZWNrLCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIF90b2tlbk93bmVyW190b2tlbklkXSA9PSBfb3duZXJUb0NoZWNrOwogIH0KCiAgZnVuY3Rpb24gX2lzVG9rZW5PcGVyYXRvcihhZGRyZXNzIF9vcGVyYXRvclRvQ2hlY2ssIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gd2hpdGVsaXN0ZWRNYXJrZXRwbGFjZVtfb3BlcmF0b3JUb0NoZWNrXSB8fAogICAgICBfdG9rZW5PcGVyYXRvcltfdG9rZW5Pd25lcltfdG9rZW5JZF1dW19vcGVyYXRvclRvQ2hlY2tdOwogIH0KCiAgZnVuY3Rpb24gX2lzQXBwcm92ZWQoYWRkcmVzcyBfYXBwcm92ZWRUb0NoZWNrLCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIF90b2tlbkFwcHJvdmFsW190b2tlbklkXSA9PSBfYXBwcm92ZWRUb0NoZWNrOwogIH0KCiAgbW9kaWZpZXIgb25seVRva2VuT3duZXIodWludDI1NiBfdG9rZW5JZCkgewogICAgcmVxdWlyZShfaXNUb2tlbk93bmVyKG1zZy5zZW5kZXIsIF90b2tlbklkKSk7CiAgICBfOwogIH0KCiAgbW9kaWZpZXIgb25seVRva2VuT3duZXJPck9wZXJhdG9yKHVpbnQyNTYgX3Rva2VuSWQpIHsKICAgIHJlcXVpcmUoX2lzVG9rZW5Pd25lcihtc2cuc2VuZGVyLCBfdG9rZW5JZCkgfHwgX2lzVG9rZW5PcGVyYXRvcihtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwogICAgXzsKICB9CgogIG1vZGlmaWVyIG9ubHlUb2tlbkF1dGhvcml6ZWQodWludDI1NiBfdG9rZW5JZCkgewogICAgcmVxdWlyZSgKICAgICAgLy8gc29saXVtLWRpc2FibGUgb3BlcmF0b3Itd2hpdGVzcGFjZQogICAgICBfaXNUb2tlbk93bmVyKG1zZy5zZW5kZXIsIF90b2tlbklkKSB8fAogICAgICAgIF9pc1Rva2VuT3BlcmF0b3IobXNnLnNlbmRlciwgX3Rva2VuSWQpIHx8CiAgICAgICAgX2lzQXBwcm92ZWQobXNnLnNlbmRlciwgX3Rva2VuSWQpCiAgICAgIC8vIHNvbGl1bS1lbmFibGUgb3BlcmF0b3Itd2hpdGVzcGFjZQogICAgKTsKICAgIF87CiAgfQoKICAvLyBFUkMtNzIxIEJhc2UKCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJlcXVpcmUoX293bmVyICE9IGFkZHJlc3MoMCkpOwogICAgcmV0dXJuIF9vd25lZFRva2Vuc1tfb3duZXJdLmxlbmd0aDsKICB9CgogIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWwgdmlldyBtdXN0QmVWYWxpZFRva2VuKF90b2tlbklkKSByZXR1cm5zIChhZGRyZXNzKSB7CiAgICByZXR1cm4gX3Rva2VuT3duZXJbX3Rva2VuSWRdOwogIH0KCiAgZnVuY3Rpb24gX2FkZFRva2VuVG8oYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CgogICAgX3Rva2VuT3duZXJbX3Rva2VuSWRdID0gX3RvOwoKICAgIHVpbnQyNTYgbGVuZ3RoID0gX293bmVkVG9rZW5zW190b10ubGVuZ3RoOwogICAgX293bmVkVG9rZW5zW190b10ucHVzaChfdG9rZW5JZCk7CiAgICBfb3duZWRUb2tlbkluZGV4W190b2tlbklkXSA9IGxlbmd0aDsKICB9CgogIGZ1bmN0aW9uIF9taW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBpbnRlcm5hbCB7CiAgICByZXF1aXJlKF90b2tlbk93bmVyW190b2tlbklkXSA9PSBhZGRyZXNzKDApKTsKCiAgICBfYWRkVG9rZW5UbyhfdG8sIF90b2tlbklkKTsKCiAgICBfb3ZlcmFsbFRva2VuSWRbX3RvdGFsVG9rZW5zXSA9IF90b2tlbklkOwogICAgX292ZXJhbGxUb2tlbkluZGV4W190b2tlbklkXSA9IF90b3RhbFRva2VuczsKICAgIF90b3RhbFRva2VucyA9IF90b3RhbFRva2Vucy5hZGQoMSk7CgogICAgVHJhbnNmZXIoYWRkcmVzcygwKSwgX3RvLCBfdG9rZW5JZCk7CiAgfQoKICBmdW5jdGlvbiBfcmVtb3ZlVG9rZW5Gcm9tKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgewogICAgcmVxdWlyZShfZnJvbSAhPSBhZGRyZXNzKDApKTsKCiAgICB1aW50MjU2IF90b2tlbkluZGV4ID0gX293bmVkVG9rZW5JbmRleFtfdG9rZW5JZF07CiAgICB1aW50MjU2IF9sYXN0VG9rZW5JbmRleCA9IF9vd25lZFRva2Vuc1tfZnJvbV0ubGVuZ3RoLnN1YigxKTsKICAgIHVpbnQyNTYgX2xhc3RUb2tlbklkID0gX293bmVkVG9rZW5zW19mcm9tXVtfbGFzdFRva2VuSW5kZXhdOwoKICAgIF90b2tlbk93bmVyW190b2tlbklkXSA9IGFkZHJlc3MoMCk7CgogICAgLy8gSW5zZXJ0IHRoZSBsYXN0IHRva2VuIGludG8gdGhlIHBvc2l0aW9uIHByZXZpb3VzbHkgb2NjdXBpZWQgYnkgdGhlIHJlbW92ZWQgdG9rZW4uCiAgICBfb3duZWRUb2tlbnNbX2Zyb21dW190b2tlbkluZGV4XSA9IF9sYXN0VG9rZW5JZDsKICAgIF9vd25lZFRva2VuSW5kZXhbX2xhc3RUb2tlbklkXSA9IF90b2tlbkluZGV4OwoKICAgIC8vIFJlc2l6ZSB0aGUgYXJyYXkuCiAgICBkZWxldGUgX293bmVkVG9rZW5zW19mcm9tXVtfbGFzdFRva2VuSW5kZXhdOwogICAgX293bmVkVG9rZW5zW19mcm9tXS5sZW5ndGgtLTsKCiAgICAvLyBSZW1vdmUgdGhlIGFycmF5IGlmIG5vIG1vcmUgdG9rZW5zIGFyZSBvd25lZCB0byBwcmV2ZW50IHBvbGx1dGlvbi4KICAgIGlmIChfb3duZWRUb2tlbnNbX2Zyb21dLmxlbmd0aCA9PSAwKSB7CiAgICAgIGRlbGV0ZSBfb3duZWRUb2tlbnNbX2Zyb21dOwogICAgfQoKICAgIC8vIFVwZGF0ZSB0aGUgaW5kZXggb2YgdGhlIHJlbW92ZWQgdG9rZW4uCiAgICBkZWxldGUgX293bmVkVG9rZW5JbmRleFtfdG9rZW5JZF07CiAgfQoKICBmdW5jdGlvbiBfYnVybih1aW50MjU2IF90b2tlbklkKSBpbnRlcm5hbCB7CiAgICBhZGRyZXNzIF9mcm9tID0gX3Rva2VuT3duZXJbX3Rva2VuSWRdOwoKICAgIHJlcXVpcmUoX2Zyb20gIT0gYWRkcmVzcygwKSk7CgogICAgX3JlbW92ZVRva2VuRnJvbShfZnJvbSwgX3Rva2VuSWQpOwogICAgX3RvdGFsVG9rZW5zID0gX3RvdGFsVG9rZW5zLnN1YigxKTsKCiAgICB1aW50MjU2IF90b2tlbkluZGV4ID0gX292ZXJhbGxUb2tlbkluZGV4W190b2tlbklkXTsKICAgIHVpbnQyNTYgX2xhc3RUb2tlbklkID0gX292ZXJhbGxUb2tlbklkW190b3RhbFRva2Vuc107CgogICAgZGVsZXRlIF9vdmVyYWxsVG9rZW5JbmRleFtfdG9rZW5JZF07CiAgICBkZWxldGUgX292ZXJhbGxUb2tlbklkW190b3RhbFRva2Vuc107CiAgICBfb3ZlcmFsbFRva2VuSWRbX3Rva2VuSW5kZXhdID0gX2xhc3RUb2tlbklkOwogICAgX292ZXJhbGxUb2tlbkluZGV4W19sYXN0VG9rZW5JZF0gPSBfdG9rZW5JbmRleDsKCiAgICBUcmFuc2ZlcihfZnJvbSwgYWRkcmVzcygwKSwgX3Rva2VuSWQpOwogIH0KCiAgZnVuY3Rpb24gX2lzQ29udHJhY3QoYWRkcmVzcyBfYWRkcmVzcykgcHJpdmF0ZSB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgIHVpbnQgX3NpemU7CiAgICAvLyBzb2xpdW0tZGlzYWJsZS1uZXh0LWxpbmUgc2VjdXJpdHkvbm8taW5saW5lLWFzc2VtYmx5CiAgICBhc3NlbWJseSB7IF9zaXplIDo9IGV4dGNvZGVzaXplKF9hZGRyZXNzKSB9CiAgICByZXR1cm4gX3NpemUgPiAwOwogIH0KCiAgZnVuY3Rpb24gX3RyYW5zZmVyRnJvbSgKICAgIGFkZHJlc3MgX2Zyb20sCiAgICBhZGRyZXNzIF90bywKICAgIHVpbnQyNTYgX3Rva2VuSWQsCiAgICBieXRlcyBfZGF0YSwKICAgIGJvb2wgX2NoZWNrCiAgKQogICAgaW50ZXJuYWwKICAgIG11c3RCZVZhbGlkVG9rZW4oX3Rva2VuSWQpCiAgICBvbmx5VG9rZW5BdXRob3JpemVkKF90b2tlbklkKQogICAgd2hlblRyYW5zZmVyQWxsb3dlZChfZnJvbSwgX3RvLCBfdG9rZW5JZCkKICB7CiAgICByZXF1aXJlKF9pc1Rva2VuT3duZXIoX2Zyb20sIF90b2tlbklkKSk7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3RvICE9IF9mcm9tKTsKCiAgICBfcmVtb3ZlVG9rZW5Gcm9tKF9mcm9tLCBfdG9rZW5JZCk7CgogICAgZGVsZXRlIF90b2tlbkFwcHJvdmFsW190b2tlbklkXTsKICAgIEFwcHJvdmFsKF9mcm9tLCBhZGRyZXNzKDApLCBfdG9rZW5JZCk7CgogICAgX2FkZFRva2VuVG8oX3RvLCBfdG9rZW5JZCk7CgogICAgaWYgKF9jaGVjayAmJiBfaXNDb250cmFjdChfdG8pKSB7CiAgICAgIElFUkM3MjFUb2tlblJlY2VpdmVyKF90bykub25FUkM3MjFSZWNlaXZlZC5nYXMoNTAwMDApKF9mcm9tLCBfdG9rZW5JZCwgX2RhdGEpOwogICAgfQoKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICB9CgogIC8vIHNvbGl1bS1kaXNhYmxlIGFyZy1vdmVyZmxvdwoKICBmdW5jdGlvbiBzYWZlVHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkLCBieXRlcyBfZGF0YSkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICBfdHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF90b2tlbklkLCBfZGF0YSwgdHJ1ZSk7CiAgfQoKICBmdW5jdGlvbiBzYWZlVHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBleHRlcm5hbCBwYXlhYmxlIHsKICAgIF90cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3Rva2VuSWQsICIiLCB0cnVlKTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICBfdHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF90b2tlbklkLCAiIiwgZmFsc2UpOwogIH0KCiAgLy8gc29saXVtLWVuYWJsZSBhcmctb3ZlcmZsb3cKCiAgZnVuY3Rpb24gYXBwcm92ZSgKICAgIGFkZHJlc3MgX2FwcHJvdmVkLAogICAgdWludDI1NiBfdG9rZW5JZAogICkKICAgIGV4dGVybmFsCiAgICBwYXlhYmxlCiAgICBtdXN0QmVWYWxpZFRva2VuKF90b2tlbklkKQogICAgb25seVRva2VuT3duZXJPck9wZXJhdG9yKF90b2tlbklkKQogICAgd2hlbk5vdFBhdXNlZAogIHsKICAgIGFkZHJlc3MgX293bmVyID0gX3Rva2VuT3duZXJbX3Rva2VuSWRdOwoKICAgIHJlcXVpcmUoX293bmVyICE9IF9hcHByb3ZlZCk7CiAgICByZXF1aXJlKF90b2tlbkFwcHJvdmFsW190b2tlbklkXSAhPSBfYXBwcm92ZWQpOwoKICAgIF90b2tlbkFwcHJvdmFsW190b2tlbklkXSA9IF9hcHByb3ZlZDsKCiAgICBBcHByb3ZhbChfb3duZXIsIF9hcHByb3ZlZCwgX3Rva2VuSWQpOwogIH0KCiAgZnVuY3Rpb24gc2V0QXBwcm92YWxGb3JBbGwoYWRkcmVzcyBfb3BlcmF0b3IsIGJvb2wgX2FwcHJvdmVkKSBleHRlcm5hbCB3aGVuTm90UGF1c2VkIHsKICAgIHJlcXVpcmUoX3Rva2VuT3BlcmF0b3JbbXNnLnNlbmRlcl1bX29wZXJhdG9yXSAhPSBfYXBwcm92ZWQpOwogICAgX3Rva2VuT3BlcmF0b3JbbXNnLnNlbmRlcl1bX29wZXJhdG9yXSA9IF9hcHByb3ZlZDsKICAgIEFwcHJvdmFsRm9yQWxsKG1zZy5zZW5kZXIsIF9vcGVyYXRvciwgX2FwcHJvdmVkKTsKICB9CgogIGZ1bmN0aW9uIGdldEFwcHJvdmVkKHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsIHZpZXcgbXVzdEJlVmFsaWRUb2tlbihfdG9rZW5JZCkgcmV0dXJucyAoYWRkcmVzcykgewogICAgcmV0dXJuIF90b2tlbkFwcHJvdmFsW190b2tlbklkXTsKICB9CgogIGZ1bmN0aW9uIGlzQXBwcm92ZWRGb3JBbGwoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX29wZXJhdG9yKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBfdG9rZW5PcGVyYXRvcltfb3duZXJdW19vcGVyYXRvcl07CiAgfQoKICAvLyBFUkMtNzIxIEVudW1lcmFibGUKCiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBfdG90YWxUb2tlbnM7CiAgfQoKICBmdW5jdGlvbiB0b2tlbkJ5SW5kZXgodWludDI1NiBfaW5kZXgpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmVxdWlyZShfaW5kZXggPCBfdG90YWxUb2tlbnMpOwogICAgcmV0dXJuIF9vdmVyYWxsVG9rZW5JZFtfaW5kZXhdOwogIH0KCiAgZnVuY3Rpb24gdG9rZW5PZk93bmVyQnlJbmRleChhZGRyZXNzIF9vd25lciwgdWludDI1NiBfaW5kZXgpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NiBfdG9rZW5JZCkgewogICAgcmVxdWlyZShfb3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF9pbmRleCA8IF9vd25lZFRva2Vuc1tfb3duZXJdLmxlbmd0aCk7CiAgICByZXR1cm4gX293bmVkVG9rZW5zW19vd25lcl1bX2luZGV4XTsKICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9lcmMvZXJjNzIxL0lFUkM3MjFNZXRhZGF0YS5zb2wKCi8vLyBAdGl0bGUgRVJDLTcyMSBOb24tRnVuZ2libGUgVG9rZW4gU3RhbmRhcmQsIG9wdGlvbmFsIG1ldGFkYXRhIGV4dGVuc2lvbgovLy8gQGRldiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvYmxvYi9tYXN0ZXIvRUlQUy9laXAtNzIxLm1kCi8vLyAgTm90ZTogdGhlIEVSQy0xNjUgaWRlbnRpZmllciBmb3IgdGhpcyBpbnRlcmZhY2UgaXMgMHg1YjVlMTM5ZgppbnRlcmZhY2UgSUVSQzcyMU1ldGFkYXRhIC8qIGlzIElFUkM3MjFCYXNlICovIHsKICAvLy8gQG5vdGljZSBBIGRlc2NyaXB0aXZlIG5hbWUgZm9yIGEgY29sbGVjdGlvbiBvZiBORlRzIGluIHRoaXMgY29udHJhY3QKICBmdW5jdGlvbiBuYW1lKCkgZXh0ZXJuYWwgcHVyZSByZXR1cm5zIChzdHJpbmcgX25hbWUpOwoKICAvLy8gQG5vdGljZSBBbiBhYmJyZXZpYXRlZCBuYW1lIGZvciBORlRzIGluIHRoaXMgY29udHJhY3QKICBmdW5jdGlvbiBzeW1ib2woKSBleHRlcm5hbCBwdXJlIHJldHVybnMgKHN0cmluZyBfc3ltYm9sKTsKCiAgLy8vIEBub3RpY2UgQSBkaXN0aW5jdCBVbmlmb3JtIFJlc291cmNlIElkZW50aWZpZXIgKFVSSSkgZm9yIGEgZ2l2ZW4gYXNzZXQuCiAgLy8vIEBkZXYgVGhyb3dzIGlmIGBfdG9rZW5JZGAgaXMgbm90IGEgdmFsaWQgTkZULiBVUklzIGFyZSBkZWZpbmVkIGluIFJGQwogIC8vLyAgMzk4Ni4gVGhlIFVSSSBtYXkgcG9pbnQgdG8gYSBKU09OIGZpbGUgdGhhdCBjb25mb3JtcyB0byB0aGUgIkVSQzcyMQogIC8vLyAgTWV0YWRhdGEgSlNPTiBTY2hlbWEiLgogIGZ1bmN0aW9uIHRva2VuVVJJKHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoc3RyaW5nKTsKfQoKLy8gRmlsZTogY29udHJhY3RzL2NvcmUvZXJjNzIxL0F4aWVFUkM3MjFNZXRhZGF0YS5zb2wKCmNvbnRyYWN0IEF4aWVFUkM3MjFNZXRhZGF0YSBpcyBBeGllRVJDNzIxQmFzZUVudW1lcmFibGUsIElFUkM3MjFNZXRhZGF0YSB7CiAgc3RyaW5nIHB1YmxpYyB0b2tlblVSSVByZWZpeCA9ICJodHRwczovL2F4aWVpbmZpbml0eS5jb20vZXJjLzcyMS9heGllcy8iOwogIHN0cmluZyBwdWJsaWMgdG9rZW5VUklTdWZmaXggPSAiLmpzb24iOwoKICBmdW5jdGlvbiBBeGllRVJDNzIxTWV0YWRhdGEoKSBpbnRlcm5hbCB7CiAgICBzdXBwb3J0ZWRJbnRlcmZhY2VzWzB4NWI1ZTEzOWZdID0gdHJ1ZTsgLy8gRVJDLTcyMSBNZXRhZGF0YQogIH0KCiAgZnVuY3Rpb24gbmFtZSgpIGV4dGVybmFsIHB1cmUgcmV0dXJucyAoc3RyaW5nKSB7CiAgICByZXR1cm4gIkF4aWUiOwogIH0KCiAgZnVuY3Rpb24gc3ltYm9sKCkgZXh0ZXJuYWwgcHVyZSByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiAiQVhJRSI7CiAgfQoKICBmdW5jdGlvbiBzZXRUb2tlblVSSUFmZml4ZXMoc3RyaW5nIF9wcmVmaXgsIHN0cmluZyBfc3VmZml4KSBleHRlcm5hbCBvbmx5Q0VPIHsKICAgIHRva2VuVVJJUHJlZml4ID0gX3ByZWZpeDsKICAgIHRva2VuVVJJU3VmZml4ID0gX3N1ZmZpeDsKICB9CgogIGZ1bmN0aW9uIHRva2VuVVJJKAogICAgdWludDI1NiBfdG9rZW5JZAogICkKICAgIGV4dGVybmFsCiAgICB2aWV3CiAgICBtdXN0QmVWYWxpZFRva2VuKF90b2tlbklkKQogICAgcmV0dXJucyAoc3RyaW5nKQogIHsKICAgIGJ5dGVzIG1lbW9yeSBfdG9rZW5VUklQcmVmaXhCeXRlcyA9IGJ5dGVzKHRva2VuVVJJUHJlZml4KTsKICAgIGJ5dGVzIG1lbW9yeSBfdG9rZW5VUklTdWZmaXhCeXRlcyA9IGJ5dGVzKHRva2VuVVJJU3VmZml4KTsKICAgIHVpbnQyNTYgX3RtcFRva2VuSWQgPSBfdG9rZW5JZDsKICAgIHVpbnQyNTYgX2xlbmd0aDsKCiAgICBkbyB7CiAgICAgIF9sZW5ndGgrKzsKICAgICAgX3RtcFRva2VuSWQgLz0gMTA7CiAgICB9IHdoaWxlIChfdG1wVG9rZW5JZCA+IDApOwoKICAgIGJ5dGVzIG1lbW9yeSBfdG9rZW5VUklCeXRlcyA9IG5ldyBieXRlcyhfdG9rZW5VUklQcmVmaXhCeXRlcy5sZW5ndGggKyBfbGVuZ3RoICsgNSk7CiAgICB1aW50MjU2IF9pID0gX3Rva2VuVVJJQnl0ZXMubGVuZ3RoIC0gNjsKCiAgICBfdG1wVG9rZW5JZCA9IF90b2tlbklkOwoKICAgIGRvIHsKICAgICAgX3Rva2VuVVJJQnl0ZXNbX2ktLV0gPSBieXRlKDQ4ICsgX3RtcFRva2VuSWQgJSAxMCk7CiAgICAgIF90bXBUb2tlbklkIC89IDEwOwogICAgfSB3aGlsZSAoX3RtcFRva2VuSWQgPiAwKTsKCiAgICBmb3IgKF9pID0gMDsgX2kgPCBfdG9rZW5VUklQcmVmaXhCeXRlcy5sZW5ndGg7IF9pKyspIHsKICAgICAgX3Rva2VuVVJJQnl0ZXNbX2ldID0gX3Rva2VuVVJJUHJlZml4Qnl0ZXNbX2ldOwogICAgfQoKICAgIGZvciAoX2kgPSAwOyBfaSA8IF90b2tlblVSSVN1ZmZpeEJ5dGVzLmxlbmd0aDsgX2krKykgewogICAgICBfdG9rZW5VUklCeXRlc1tfdG9rZW5VUklCeXRlcy5sZW5ndGggKyBfaSAtIDVdID0gX3Rva2VuVVJJU3VmZml4Qnl0ZXNbX2ldOwogICAgfQoKICAgIHJldHVybiBzdHJpbmcoX3Rva2VuVVJJQnl0ZXMpOwogIH0KfQoKLy8gRmlsZTogY29udHJhY3RzL2NvcmUvZXJjNzIxL0F4aWVFUkM3MjEuc29sCgovLyBzb2xpdW0tZGlzYWJsZS1uZXh0LWxpbmUgbm8tZW1wdHktYmxvY2tzCmNvbnRyYWN0IEF4aWVFUkM3MjEgaXMgQXhpZUVSQzcyMUJhc2VFbnVtZXJhYmxlLCBBeGllRVJDNzIxTWV0YWRhdGEgewp9CgovLyBGaWxlOiBjb250cmFjdHMvY29yZS9BeGllQ29yZS5zb2wKCi8vIHNvbGl1bS1kaXNhYmxlLW5leHQtbGluZSBuby1lbXB0eS1ibG9ja3MKY29udHJhY3QgQXhpZUNvcmUgaXMgQXhpZUVSQzcyMSB7CiAgc3RydWN0IEF4aWUgewogICAgdWludDI1NiBnZW5lczsKICAgIHVpbnQyNTYgYm9ybkF0OwogIH0KCiAgQXhpZVtdIGF4aWVzOwoKICBldmVudCBBeGllU3Bhd25lZCh1aW50MjU2IGluZGV4ZWQgX2F4aWVJZCwgYWRkcmVzcyBpbmRleGVkIF9vd25lciwgdWludDI1NiBfZ2VuZXMpOwogIGV2ZW50IEF4aWVSZWJpcnRoZWQodWludDI1NiBpbmRleGVkIF9heGllSWQsIHVpbnQyNTYgX2dlbmVzKTsKICBldmVudCBBeGllUmV0aXJlZCh1aW50MjU2IGluZGV4ZWQgX2F4aWVJZCk7CiAgZXZlbnQgQXhpZUV2b2x2ZWQodWludDI1NiBpbmRleGVkIF9heGllSWQsIHVpbnQyNTYgX29sZEdlbmVzLCB1aW50MjU2IF9uZXdHZW5lcyk7CgogIGZ1bmN0aW9uIEF4aWVDb3JlKCkgcHVibGljIHsKICAgIGF4aWVzLnB1c2goQXhpZSgwLCBub3cpKTsgLy8gVGhlIHZvaWQgQXhpZQogICAgX3NwYXduQXhpZSgwLCBtc2cuc2VuZGVyKTsgLy8gV2lsbCBiZSBQdWZmCiAgICBfc3Bhd25BeGllKDAsIG1zZy5zZW5kZXIpOyAvLyBXaWxsIGJlIEtvdGFybwogICAgX3NwYXduQXhpZSgwLCBtc2cuc2VuZGVyKTsgLy8gV2lsbCBiZSBHaW5nZXIKICAgIF9zcGF3bkF4aWUoMCwgbXNnLnNlbmRlcik7IC8vIFdpbGwgYmUgU3RlbGxhCiAgfQoKICBmdW5jdGlvbiBnZXRBeGllKAogICAgdWludDI1NiBfYXhpZUlkCiAgKQogICAgZXh0ZXJuYWwKICAgIHZpZXcKICAgIG11c3RCZVZhbGlkVG9rZW4oX2F4aWVJZCkKICAgIHJldHVybnMgKHVpbnQyNTYgLyogX2dlbmVzICovLCB1aW50MjU2IC8qIF9ib3JuQXQgKi8pCiAgewogICAgQXhpZSBzdG9yYWdlIF9heGllID0gYXhpZXNbX2F4aWVJZF07CiAgICByZXR1cm4gKF9heGllLmdlbmVzLCBfYXhpZS5ib3JuQXQpOwogIH0KCiAgZnVuY3Rpb24gc3Bhd25BeGllKAogICAgdWludDI1NiBfZ2VuZXMsCiAgICBhZGRyZXNzIF9vd25lcgogICkKICAgIGV4dGVybmFsCiAgICBvbmx5U3Bhd25lcgogICAgd2hlblNwYXduaW5nQWxsb3dlZChfZ2VuZXMsIF9vd25lcikKICAgIHJldHVybnMgKHVpbnQyNTYpCiAgewogICAgcmV0dXJuIF9zcGF3bkF4aWUoX2dlbmVzLCBfb3duZXIpOwogIH0KCiAgZnVuY3Rpb24gcmViaXJ0aEF4aWUoCiAgICB1aW50MjU2IF9heGllSWQsCiAgICB1aW50MjU2IF9nZW5lcwogICkKICAgIGV4dGVybmFsCiAgICBvbmx5U3Bhd25lcgogICAgbXVzdEJlVmFsaWRUb2tlbihfYXhpZUlkKQogICAgd2hlblJlYmlydGhBbGxvd2VkKF9heGllSWQsIF9nZW5lcykKICB7CiAgICBBeGllIHN0b3JhZ2UgX2F4aWUgPSBheGllc1tfYXhpZUlkXTsKICAgIF9heGllLmdlbmVzID0gX2dlbmVzOwogICAgX2F4aWUuYm9ybkF0ID0gbm93OwogICAgQXhpZVJlYmlydGhlZChfYXhpZUlkLCBfZ2VuZXMpOwogIH0KCiAgZnVuY3Rpb24gcmV0aXJlQXhpZSgKICAgIHVpbnQyNTYgX2F4aWVJZCwKICAgIGJvb2wgX3JpcAogICkKICAgIGV4dGVybmFsCiAgICBvbmx5QnllU2F5ZXIKICAgIHdoZW5SZXRpcmVtZW50QWxsb3dlZChfYXhpZUlkLCBfcmlwKQogIHsKICAgIF9idXJuKF9heGllSWQpOwoKICAgIGlmIChfcmlwKSB7CiAgICAgIGRlbGV0ZSBheGllc1tfYXhpZUlkXTsKICAgIH0KCiAgICBBeGllUmV0aXJlZChfYXhpZUlkKTsKICB9CgogIGZ1bmN0aW9uIGV2b2x2ZUF4aWUoCiAgICB1aW50MjU2IF9heGllSWQsCiAgICB1aW50MjU2IF9uZXdHZW5lcwogICkKICAgIGV4dGVybmFsCiAgICBvbmx5R2VuZVNjaWVudGlzdAogICAgbXVzdEJlVmFsaWRUb2tlbihfYXhpZUlkKQogICAgd2hlbkV2b2x2ZW1lbnRBbGxvd2VkKF9heGllSWQsIF9uZXdHZW5lcykKICB7CiAgICB1aW50MjU2IF9vbGRHZW5lcyA9IGF4aWVzW19heGllSWRdLmdlbmVzOwogICAgYXhpZXNbX2F4aWVJZF0uZ2VuZXMgPSBfbmV3R2VuZXM7CiAgICBBeGllRXZvbHZlZChfYXhpZUlkLCBfb2xkR2VuZXMsIF9uZXdHZW5lcyk7CiAgfQoKICBmdW5jdGlvbiBfc3Bhd25BeGllKHVpbnQyNTYgX2dlbmVzLCBhZGRyZXNzIF9vd25lcikgcHJpdmF0ZSByZXR1cm5zICh1aW50MjU2IF9heGllSWQpIHsKICAgIEF4aWUgbWVtb3J5IF9heGllID0gQXhpZShfZ2VuZXMsIG5vdyk7CiAgICBfYXhpZUlkID0gYXhpZXMucHVzaChfYXhpZSkgLSAxOwogICAgX21pbnQoX293bmVyLCBfYXhpZUlkKTsKICAgIEF4aWVTcGF3bmVkKF9heGllSWQsIF9vd25lciwgX2dlbmVzKTsKICB9Cn0='.
	

]
