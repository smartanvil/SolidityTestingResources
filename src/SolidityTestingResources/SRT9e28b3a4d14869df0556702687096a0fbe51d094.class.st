Class {
	#name : #SRT9e28b3a4d14869df0556702687096a0fbe51d094,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT9e28b3a4d14869df0556702687096a0fbe51d094 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7Ci8qCk1JVCBMaWNlbnNlCgpDb3B5cmlnaHQgKGMpIDIwMTggVHJ1c3RUb2tlbgoKUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6CgpUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KClRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KKi8KCmNvbnRyYWN0IERlbGVnYXRlRVJDMjAgewogIGZ1bmN0aW9uIGRlbGVnYXRlVG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiBkZWxlZ2F0ZUJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gZGVsZWdhdGVUcmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlLCBhZGRyZXNzIG9yaWdTZW5kZXIpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBkZWxlZ2F0ZUFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIGRlbGVnYXRlVHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSwgYWRkcmVzcyBvcmlnU2VuZGVyKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gZGVsZWdhdGVBcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSwgYWRkcmVzcyBvcmlnU2VuZGVyKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gZGVsZWdhdGVJbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3Mgc3BlbmRlciwgdWludCBhZGRlZFZhbHVlLCBhZGRyZXNzIG9yaWdTZW5kZXIpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBkZWxlZ2F0ZURlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBzcGVuZGVyLCB1aW50IHN1YnRyYWN0ZWRWYWx1ZSwgYWRkcmVzcyBvcmlnU2VuZGVyKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7Cn0KCmxpYnJhcnkgU2FmZU1hdGggewoKICAvKioKICAqIEBkZXYgTXVsdGlwbGllcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICovCiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IEludGVnZXIgZGl2aXNpb24gb2YgdHdvIG51bWJlcnMsIHRydW5jYXRpbmcgdGhlIHF1b3RpZW50LgogICovCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICAvKioKICAqIEBkZXYgU3Vic3RyYWN0cyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93IChpLmUuIGlmIHN1YnRyYWhlbmQgaXMgZ3JlYXRlciB0aGFuIG1pbnVlbmQpLgogICovCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgLyoqCiAgKiBAZGV2IEFkZHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9Cgpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCgogIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9Cgpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKICBldmVudCBQYXVzZSgpOwogIGV2ZW50IFVucGF1c2UoKTsKCiAgYm9vbCBwdWJsaWMgcGF1c2VkID0gZmFsc2U7CgoKICAvKioKICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIG5vdCBwYXVzZWQuCiAgICovCiAgbW9kaWZpZXIgd2hlbk5vdFBhdXNlZCgpIHsKICAgIHJlcXVpcmUoIXBhdXNlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBwYXVzZWQuCiAgICovCiAgbW9kaWZpZXIgd2hlblBhdXNlZCgpIHsKICAgIHJlcXVpcmUocGF1c2VkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gcGF1c2UsIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUKICAgKi8KICBmdW5jdGlvbiBwYXVzZSgpIG9ubHlPd25lciB3aGVuTm90UGF1c2VkIHB1YmxpYyB7CiAgICBwYXVzZWQgPSB0cnVlOwogICAgUGF1c2UoKTsKICB9CgogIC8qKgogICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byB1bnBhdXNlLCByZXR1cm5zIHRvIG5vcm1hbCBzdGF0ZQogICAqLwogIGZ1bmN0aW9uIHVucGF1c2UoKSBvbmx5T3duZXIgd2hlblBhdXNlZCBwdWJsaWMgewogICAgcGF1c2VkID0gZmFsc2U7CiAgICBVbnBhdXNlKCk7CiAgfQp9Cgpjb250cmFjdCBDYW5SZWNsYWltVG9rZW4gaXMgT3duYWJsZSB7CiAgdXNpbmcgU2FmZUVSQzIwIGZvciBFUkMyMEJhc2ljOwoKICAvKioKICAgKiBAZGV2IFJlY2xhaW0gYWxsIEVSQzIwQmFzaWMgY29tcGF0aWJsZSB0b2tlbnMKICAgKiBAcGFyYW0gdG9rZW4gRVJDMjBCYXNpYyBUaGUgYWRkcmVzcyBvZiB0aGUgdG9rZW4gY29udHJhY3QKICAgKi8KICBmdW5jdGlvbiByZWNsYWltVG9rZW4oRVJDMjBCYXNpYyB0b2tlbikgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIHVpbnQyNTYgYmFsYW5jZSA9IHRva2VuLmJhbGFuY2VPZih0aGlzKTsKICAgIHRva2VuLnNhZmVUcmFuc2Zlcihvd25lciwgYmFsYW5jZSk7CiAgfQoKfQoKY29udHJhY3QgQ2xhaW1hYmxlIGlzIE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIHBlbmRpbmdPd25lcjsKCiAgLyoqCiAgICogQGRldiBNb2RpZmllciB0aHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIHBlbmRpbmdPd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5UGVuZGluZ093bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHBlbmRpbmdPd25lcik7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gc2V0IHRoZSBwZW5kaW5nT3duZXIgYWRkcmVzcy4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgcGVuZGluZ093bmVyID0gbmV3T3duZXI7CiAgfQoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgcGVuZGluZ093bmVyIGFkZHJlc3MgdG8gZmluYWxpemUgdGhlIHRyYW5zZmVyLgogICAqLwogIGZ1bmN0aW9uIGNsYWltT3duZXJzaGlwKCkgb25seVBlbmRpbmdPd25lciBwdWJsaWMgewogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIHBlbmRpbmdPd25lcik7CiAgICBvd25lciA9IHBlbmRpbmdPd25lcjsKICAgIHBlbmRpbmdPd25lciA9IGFkZHJlc3MoMCk7CiAgfQp9Cgpjb250cmFjdCBBZGRyZXNzTGlzdCBpcyBDbGFpbWFibGUgewogICAgc3RyaW5nIHB1YmxpYyBuYW1lOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgb25MaXN0OwoKICAgIGZ1bmN0aW9uIEFkZHJlc3NMaXN0KHN0cmluZyBfbmFtZSwgYm9vbCBudWxsVmFsdWUpIHB1YmxpYyB7CiAgICAgICAgbmFtZSA9IF9uYW1lOwogICAgICAgIG9uTGlzdFsweDBdID0gbnVsbFZhbHVlOwogICAgfQogICAgZXZlbnQgQ2hhbmdlV2hpdGVMaXN0KGFkZHJlc3MgaW5kZXhlZCB0bywgYm9vbCBvbkxpc3QpOwoKICAgIC8vIFNldCB3aGV0aGVyIF90byBpcyBvbiB0aGUgbGlzdCBvciBub3QuIFdoZXRoZXIgMHgwIGlzIG9uIHRoZSBsaXN0CiAgICAvLyBvciBub3QgY2Fubm90IGJlIHNldCBoZXJlIC0gaXQgaXMgc2V0IG9uY2UgYW5kIGZvciBhbGwgYnkgdGhlIGNvbnN0cnVjdG9yLgogICAgZnVuY3Rpb24gY2hhbmdlTGlzdChhZGRyZXNzIF90bywgYm9vbCBfb25MaXN0KSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKF90byAhPSAweDApOwogICAgICAgIGlmIChvbkxpc3RbX3RvXSAhPSBfb25MaXN0KSB7CiAgICAgICAgICAgIG9uTGlzdFtfdG9dID0gX29uTGlzdDsKICAgICAgICAgICAgQ2hhbmdlV2hpdGVMaXN0KF90bywgX29uTGlzdCk7CiAgICAgICAgfQogICAgfQp9Cgpjb250cmFjdCBIYXNOb0NvbnRyYWN0cyBpcyBPd25hYmxlIHsKCiAgLyoqCiAgICogQGRldiBSZWNsYWltIG93bmVyc2hpcCBvZiBPd25hYmxlIGNvbnRyYWN0cwogICAqIEBwYXJhbSBjb250cmFjdEFkZHIgVGhlIGFkZHJlc3Mgb2YgdGhlIE93bmFibGUgdG8gYmUgcmVjbGFpbWVkLgogICAqLwogIGZ1bmN0aW9uIHJlY2xhaW1Db250cmFjdChhZGRyZXNzIGNvbnRyYWN0QWRkcikgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIE93bmFibGUgY29udHJhY3RJbnN0ID0gT3duYWJsZShjb250cmFjdEFkZHIpOwogICAgY29udHJhY3RJbnN0LnRyYW5zZmVyT3duZXJzaGlwKG93bmVyKTsKICB9Cn0KCmNvbnRyYWN0IEhhc05vRXRoZXIgaXMgT3duYWJsZSB7CgogIC8qKgogICogQGRldiBDb25zdHJ1Y3RvciB0aGF0IHJlamVjdHMgaW5jb21pbmcgRXRoZXIKICAqIEBkZXYgVGhlIGBwYXlhYmxlYCBmbGFnIGlzIGFkZGVkIHNvIHdlIGNhbiBhY2Nlc3MgYG1zZy52YWx1ZWAgd2l0aG91dCBjb21waWxlciB3YXJuaW5nLiBJZiB3ZQogICogbGVhdmUgb3V0IHBheWFibGUsIHRoZW4gU29saWRpdHkgd2lsbCBhbGxvdyBpbmhlcml0aW5nIGNvbnRyYWN0cyB0byBpbXBsZW1lbnQgYSBwYXlhYmxlCiAgKiBjb25zdHJ1Y3Rvci4gQnkgZG9pbmcgaXQgdGhpcyB3YXkgd2UgcHJldmVudCBhIHBheWFibGUgY29uc3RydWN0b3IgZnJvbSB3b3JraW5nLiBBbHRlcm5hdGl2ZWx5CiAgKiB3ZSBjb3VsZCB1c2UgYXNzZW1ibHkgdG8gYWNjZXNzIG1zZy52YWx1ZS4KICAqLwogIGZ1bmN0aW9uIEhhc05vRXRoZXIoKSBwdWJsaWMgcGF5YWJsZSB7CiAgICByZXF1aXJlKG1zZy52YWx1ZSA9PSAwKTsKICB9CgogIC8qKgogICAqIEBkZXYgRGlzYWxsb3dzIGRpcmVjdCBzZW5kIGJ5IHNldHRpbmdzIGEgZGVmYXVsdCBmdW5jdGlvbiB3aXRob3V0IHRoZSBgcGF5YWJsZWAgZmxhZy4KICAgKi8KICBmdW5jdGlvbigpIGV4dGVybmFsIHsKICB9CgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXIgYWxsIEV0aGVyIGhlbGQgYnkgdGhlIGNvbnRyYWN0IHRvIHRoZSBvd25lci4KICAgKi8KICBmdW5jdGlvbiByZWNsYWltRXRoZXIoKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgYXNzZXJ0KG93bmVyLnNlbmQodGhpcy5iYWxhbmNlKSk7CiAgfQp9Cgpjb250cmFjdCBIYXNOb1Rva2VucyBpcyBDYW5SZWNsYWltVG9rZW4gewoKIC8qKgogICogQGRldiBSZWplY3QgYWxsIEVSQzIyMyBjb21wYXRpYmxlIHRva2VucwogICogQHBhcmFtIGZyb21fIGFkZHJlc3MgVGhlIGFkZHJlc3MgdGhhdCBpcyB0cmFuc2ZlcnJpbmcgdGhlIHRva2VucwogICogQHBhcmFtIHZhbHVlXyB1aW50MjU2IHRoZSBhbW91bnQgb2YgdGhlIHNwZWNpZmllZCB0b2tlbgogICogQHBhcmFtIGRhdGFfIEJ5dGVzIFRoZSBkYXRhIHBhc3NlZCBmcm9tIHRoZSBjYWxsZXIuCiAgKi8KICBmdW5jdGlvbiB0b2tlbkZhbGxiYWNrKGFkZHJlc3MgZnJvbV8sIHVpbnQyNTYgdmFsdWVfLCBieXRlcyBkYXRhXykgZXh0ZXJuYWwgewogICAgZnJvbV87CiAgICB2YWx1ZV87CiAgICBkYXRhXzsKICAgIHJldmVydCgpOwogIH0KCn0KCmNvbnRyYWN0IE5vT3duZXIgaXMgSGFzTm9FdGhlciwgSGFzTm9Ub2tlbnMsIEhhc05vQ29udHJhY3RzIHsKfQoKY29udHJhY3QgQWxsb3dhbmNlU2hlZXQgaXMgQ2xhaW1hYmxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgcHVibGljIGFsbG93YW5jZU9mOwoKICAgIGZ1bmN0aW9uIGFkZEFsbG93YW5jZShhZGRyZXNzIHRva2VuSG9sZGVyLCBhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIGFsbG93YW5jZU9mW3Rva2VuSG9sZGVyXVtzcGVuZGVyXSA9IGFsbG93YW5jZU9mW3Rva2VuSG9sZGVyXVtzcGVuZGVyXS5hZGQodmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHN1YkFsbG93YW5jZShhZGRyZXNzIHRva2VuSG9sZGVyLCBhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIGFsbG93YW5jZU9mW3Rva2VuSG9sZGVyXVtzcGVuZGVyXSA9IGFsbG93YW5jZU9mW3Rva2VuSG9sZGVyXVtzcGVuZGVyXS5zdWIodmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEFsbG93YW5jZShhZGRyZXNzIHRva2VuSG9sZGVyLCBhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIGFsbG93YW5jZU9mW3Rva2VuSG9sZGVyXVtzcGVuZGVyXSA9IHZhbHVlOwogICAgfQp9Cgpjb250cmFjdCBCYWxhbmNlU2hlZXQgaXMgQ2xhaW1hYmxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGJhbGFuY2VPZjsKCiAgICBmdW5jdGlvbiBhZGRCYWxhbmNlKGFkZHJlc3MgYWRkciwgdWludDI1NiB2YWx1ZSkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgYmFsYW5jZU9mW2FkZHJdID0gYmFsYW5jZU9mW2FkZHJdLmFkZCh2YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gc3ViQmFsYW5jZShhZGRyZXNzIGFkZHIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIGJhbGFuY2VPZlthZGRyXSA9IGJhbGFuY2VPZlthZGRyXS5zdWIodmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEJhbGFuY2UoYWRkcmVzcyBhZGRyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBiYWxhbmNlT2ZbYWRkcl0gPSB2YWx1ZTsKICAgIH0KfQoKY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljLCBDbGFpbWFibGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBCYWxhbmNlU2hlZXQgcHVibGljIGJhbGFuY2VzOwoKICB1aW50MjU2IHRvdGFsU3VwcGx5XzsKCiAgZnVuY3Rpb24gc2V0QmFsYW5jZVNoZWV0KGFkZHJlc3Mgc2hlZXQpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICBiYWxhbmNlcyA9IEJhbGFuY2VTaGVldChzaGVldCk7CiAgICBiYWxhbmNlcy5jbGFpbU93bmVyc2hpcCgpOwogIH0KCiAgLyoqCiAgKiBAZGV2IHRvdGFsIG51bWJlciBvZiB0b2tlbnMgaW4gZXhpc3RlbmNlCiAgKi8KICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiB0b3RhbFN1cHBseV87CiAgfQoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICB0cmFuc2ZlckFsbEFyZ3NOb0FsbG93YW5jZShtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyQWxsQXJnc05vQWxsb3dhbmNlKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgaW50ZXJuYWwgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF9mcm9tICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXMuYmFsYW5jZU9mKF9mcm9tKSk7CgogICAgLy8gU2FmZU1hdGguc3ViIHdpbGwgdGhyb3cgaWYgdGhlcmUgaXMgbm90IGVub3VnaCBiYWxhbmNlLgogICAgYmFsYW5jZXMuc3ViQmFsYW5jZShfZnJvbSwgX3ZhbHVlKTsKICAgIGJhbGFuY2VzLmFkZEJhbGFuY2UoX3RvLCBfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXMuYmFsYW5jZU9mKF9vd25lcik7CiAgfQp9Cgpjb250cmFjdCBCdXJuYWJsZVRva2VuIGlzIEJhc2ljVG9rZW4gewoKICBldmVudCBCdXJuKGFkZHJlc3MgaW5kZXhlZCBidXJuZXIsIHVpbnQyNTYgdmFsdWUpOwoKICAvKioKICAgKiBAZGV2IEJ1cm5zIGEgc3BlY2lmaWMgYW1vdW50IG9mIHRva2Vucy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgYnVybmVkLgogICAqLwogIGZ1bmN0aW9uIGJ1cm4odWludDI1NiBfdmFsdWUpIHB1YmxpYyB7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlcy5iYWxhbmNlT2YobXNnLnNlbmRlcikpOwogICAgLy8gbm8gbmVlZCB0byByZXF1aXJlIHZhbHVlIDw9IHRvdGFsU3VwcGx5LCBzaW5jZSB0aGF0IHdvdWxkIGltcGx5IHRoZQogICAgLy8gc2VuZGVyJ3MgYmFsYW5jZSBpcyBncmVhdGVyIHRoYW4gdGhlIHRvdGFsU3VwcGx5LCB3aGljaCAqc2hvdWxkKiBiZSBhbiBhc3NlcnRpb24gZmFpbHVyZQoKICAgIGFkZHJlc3MgYnVybmVyID0gbXNnLnNlbmRlcjsKICAgIGJhbGFuY2VzLnN1YkJhbGFuY2UoYnVybmVyLCBfdmFsdWUpOwogICAgdG90YWxTdXBwbHlfID0gdG90YWxTdXBwbHlfLnN1YihfdmFsdWUpOwogICAgQnVybihidXJuZXIsIF92YWx1ZSk7CiAgICBUcmFuc2ZlcihidXJuZXIsIGFkZHJlc3MoMCksIF92YWx1ZSk7CiAgfQp9Cgpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKbGlicmFyeSBTYWZlRVJDMjAgewogIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlcihFUkMyMEJhc2ljIHRva2VuLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBpbnRlcm5hbCB7CiAgICBhc3NlcnQodG9rZW4udHJhbnNmZXIodG8sIHZhbHVlKSk7CiAgfQoKICBmdW5jdGlvbiBzYWZlVHJhbnNmZXJGcm9tKEVSQzIwIHRva2VuLCBhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHsKICAgIGFzc2VydCh0b2tlbi50cmFuc2ZlckZyb20oZnJvbSwgdG8sIHZhbHVlKSk7CiAgfQoKICBmdW5jdGlvbiBzYWZlQXBwcm92ZShFUkMyMCB0b2tlbiwgYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBpbnRlcm5hbCB7CiAgICBhc3NlcnQodG9rZW4uYXBwcm92ZShzcGVuZGVyLCB2YWx1ZSkpOwogIH0KfQoKY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogIEFsbG93YW5jZVNoZWV0IHB1YmxpYyBhbGxvd2FuY2VzOwoKICBmdW5jdGlvbiBzZXRBbGxvd2FuY2VTaGVldChhZGRyZXNzIHNoZWV0KSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgYWxsb3dhbmNlcyA9IEFsbG93YW5jZVNoZWV0KHNoZWV0KTsKICAgIGFsbG93YW5jZXMuY2xhaW1Pd25lcnNoaXAoKTsKICB9CgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdHJhbnNmZXJBbGxBcmdzWWVzQWxsb3dhbmNlKF9mcm9tLCBfdG8sIF92YWx1ZSwgbXNnLnNlbmRlcik7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyQWxsQXJnc1llc0FsbG93YW5jZShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUsIGFkZHJlc3Mgc3BlbmRlcikgaW50ZXJuYWwgewogICAgcmVxdWlyZShfdmFsdWUgPD0gYWxsb3dhbmNlcy5hbGxvd2FuY2VPZihfZnJvbSwgc3BlbmRlcikpOwoKICAgIGFsbG93YW5jZXMuc3ViQWxsb3dhbmNlKF9mcm9tLCBzcGVuZGVyLCBfdmFsdWUpOwogICAgdHJhbnNmZXJBbGxBcmdzTm9BbGxvd2FuY2UoX2Zyb20sIF90bywgX3ZhbHVlKTsKICB9CgogIC8qKgogICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAqCiAgICogQmV3YXJlIHRoYXQgY2hhbmdpbmcgYW4gYWxsb3dhbmNlIHdpdGggdGhpcyBtZXRob2QgYnJpbmdzIHRoZSByaXNrIHRoYXQgc29tZW9uZSBtYXkgdXNlIGJvdGggdGhlIG9sZAogICAqIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZSB0cmFuc2FjdGlvbiBvcmRlcmluZy4gT25lIHBvc3NpYmxlIHNvbHV0aW9uIHRvIG1pdGlnYXRlIHRoaXMKICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgYXBwcm92ZUFsbEFyZ3MoX3NwZW5kZXIsIF92YWx1ZSwgbXNnLnNlbmRlcik7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGFwcHJvdmVBbGxBcmdzKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlLCBhZGRyZXNzIF90b2tlbkhvbGRlcikgaW50ZXJuYWwgewogICAgYWxsb3dhbmNlcy5zZXRBbGxvd2FuY2UoX3Rva2VuSG9sZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIEFwcHJvdmFsKF90b2tlbkhvbGRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgKi8KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBhbGxvd2FuY2VzLmFsbG93YW5jZU9mKF9vd25lciwgX3NwZW5kZXIpOwogIH0KCiAgLyoqCiAgICogQGRldiBJbmNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9hZGRlZFZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGluY3JlYXNlIHRoZSBhbGxvd2FuY2UgYnkuCiAgICovCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgaW5jcmVhc2VBcHByb3ZhbEFsbEFyZ3MoX3NwZW5kZXIsIF9hZGRlZFZhbHVlLCBtc2cuc2VuZGVyKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbEFsbEFyZ3MoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSwgYWRkcmVzcyB0b2tlbkhvbGRlcikgaW50ZXJuYWwgewogICAgYWxsb3dhbmNlcy5hZGRBbGxvd2FuY2UodG9rZW5Ib2xkZXIsIF9zcGVuZGVyLCBfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbCh0b2tlbkhvbGRlciwgX3NwZW5kZXIsIGFsbG93YW5jZXMuYWxsb3dhbmNlT2YodG9rZW5Ib2xkZXIsIF9zcGVuZGVyKSk7CiAgfQoKICAvKioKICAgKiBAZGV2IERlY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBkZWNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3N1YnRyYWN0ZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBkZWNyZWFzZSB0aGUgYWxsb3dhbmNlIGJ5LgogICAqLwogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgZGVjcmVhc2VBcHByb3ZhbEFsbEFyZ3MoX3NwZW5kZXIsIF9zdWJ0cmFjdGVkVmFsdWUsIG1zZy5zZW5kZXIpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsQWxsQXJncyhhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUsIGFkZHJlc3MgdG9rZW5Ib2xkZXIpIGludGVybmFsIHsKICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2FuY2VzLmFsbG93YW5jZU9mKHRva2VuSG9sZGVyLCBfc3BlbmRlcik7CiAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgIGFsbG93YW5jZXMuc2V0QWxsb3dhbmNlKHRva2VuSG9sZGVyLCBfc3BlbmRlciwgMCk7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2FuY2VzLnN1YkFsbG93YW5jZSh0b2tlbkhvbGRlciwgX3NwZW5kZXIsIF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQogICAgQXBwcm92YWwodG9rZW5Ib2xkZXIsIF9zcGVuZGVyLCBhbGxvd2FuY2VzLmFsbG93YW5jZU9mKHRva2VuSG9sZGVyLCBfc3BlbmRlcikpOwogIH0KCn0KCmNvbnRyYWN0IENhbkRlbGVnYXRlIGlzIFN0YW5kYXJkVG9rZW4gewogICAgLy8gSWYgdGhpcyBjb250cmFjdCBuZWVkcyB0byBiZSB1cGdyYWRlZCwgdGhlIG5ldyBjb250cmFjdCB3aWxsIGJlIHN0b3JlZAogICAgLy8gaW4gJ2RlbGVnYXRlJyBhbmQgYW55IEVSQzIwIGNhbGxzIHRvIHRoaXMgY29udHJhY3Qgd2lsbCBiZSBkZWxlZ2F0ZWQgdG8gdGhhdCBvbmUuCiAgICBEZWxlZ2F0ZUVSQzIwIHB1YmxpYyBkZWxlZ2F0ZTsKCiAgICBldmVudCBEZWxlZ2F0ZWRUbyhhZGRyZXNzIGluZGV4ZWQgbmV3Q29udHJhY3QpOwoKICAgIC8vIENhbiB1bmRlbGVnYXRlIGJ5IHBhc3NpbmcgaW4gbmV3Q29udHJhY3QgPSBhZGRyZXNzKDApCiAgICBmdW5jdGlvbiBkZWxlZ2F0ZVRvTmV3Q29udHJhY3QoRGVsZWdhdGVFUkMyMCBuZXdDb250cmFjdCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgZGVsZWdhdGUgPSBuZXdDb250cmFjdDsKICAgICAgICBEZWxlZ2F0ZWRUbyhkZWxlZ2F0ZSk7CiAgICB9CgogICAgLy8gSWYgYSBkZWxlZ2F0ZSBoYXMgYmVlbiBkZXNpZ25hdGVkLCBhbGwgRVJDMjAgY2FsbHMgYXJlIGZvcndhcmRlZCB0byBpdAogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAoZGVsZWdhdGUgPT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIodG8sIHZhbHVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZGVsZWdhdGUuZGVsZWdhdGVUcmFuc2Zlcih0bywgdmFsdWUsIG1zZy5zZW5kZXIpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmIChkZWxlZ2F0ZSA9PSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oZnJvbSwgdG8sIHZhbHVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZGVsZWdhdGUuZGVsZWdhdGVUcmFuc2ZlckZyb20oZnJvbSwgdG8sIHZhbHVlLCBtc2cuc2VuZGVyKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgaWYgKGRlbGVnYXRlID09IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmJhbGFuY2VPZih3aG8pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBkZWxlZ2F0ZS5kZWxlZ2F0ZUJhbGFuY2VPZih3aG8pOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAoZGVsZWdhdGUgPT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICByZXR1cm4gc3VwZXIuYXBwcm92ZShzcGVuZGVyLCB2YWx1ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGRlbGVnYXRlLmRlbGVnYXRlQXBwcm92ZShzcGVuZGVyLCB2YWx1ZSwgbXNnLnNlbmRlcik7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgaWYgKGRlbGVnYXRlID09IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmFsbG93YW5jZShfb3duZXIsIHNwZW5kZXIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBkZWxlZ2F0ZS5kZWxlZ2F0ZUFsbG93YW5jZShfb3duZXIsIHNwZW5kZXIpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBpZiAoZGVsZWdhdGUgPT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICByZXR1cm4gc3VwZXIudG90YWxTdXBwbHkoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZGVsZWdhdGUuZGVsZWdhdGVUb3RhbFN1cHBseSgpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3Mgc3BlbmRlciwgdWludCBhZGRlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmIChkZWxlZ2F0ZSA9PSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIHJldHVybiBzdXBlci5pbmNyZWFzZUFwcHJvdmFsKHNwZW5kZXIsIGFkZGVkVmFsdWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBkZWxlZ2F0ZS5kZWxlZ2F0ZUluY3JlYXNlQXBwcm92YWwoc3BlbmRlciwgYWRkZWRWYWx1ZSwgbXNnLnNlbmRlcik7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBzcGVuZGVyLCB1aW50IHN1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAoZGVsZWdhdGUgPT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVjcmVhc2VBcHByb3ZhbChzcGVuZGVyLCBzdWJ0cmFjdGVkVmFsdWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBkZWxlZ2F0ZS5kZWxlZ2F0ZURlY3JlYXNlQXBwcm92YWwoc3BlbmRlciwgc3VidHJhY3RlZFZhbHVlLCBtc2cuc2VuZGVyKTsKICAgICAgICB9CiAgICB9Cn0KCmNvbnRyYWN0IFN0YW5kYXJkRGVsZWdhdGUgaXMgU3RhbmRhcmRUb2tlbiwgRGVsZWdhdGVFUkMyMCB7CiAgICBhZGRyZXNzIHB1YmxpYyBkZWxlZ2F0ZWRGcm9tOwoKICAgIG1vZGlmaWVyIG9ubHlTZW5kZXIoYWRkcmVzcyBzb3VyY2UpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gc291cmNlKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldERlbGVnYXRlZEZyb20oYWRkcmVzcyBhZGRyKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICBkZWxlZ2F0ZWRGcm9tID0gYWRkcjsKICAgIH0KCiAgICAvLyBBbGwgZGVsZWdhdGUgRVJDMjAgZnVuY3Rpb25zIGFyZSBmb3J3YXJkZWQgdG8gY29ycmVzcG9uZGluZyBub3JtYWwgZnVuY3Rpb25zCiAgICBmdW5jdGlvbiBkZWxlZ2F0ZVRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiB0b3RhbFN1cHBseSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlbGVnYXRlQmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VPZih3aG8pOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlbGVnYXRlVHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSwgYWRkcmVzcyBvcmlnU2VuZGVyKSBvbmx5U2VuZGVyKGRlbGVnYXRlZEZyb20pIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgdHJhbnNmZXJBbGxBcmdzTm9BbGxvd2FuY2Uob3JpZ1NlbmRlciwgdG8sIHZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWxlZ2F0ZUFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gYWxsb3dhbmNlKG93bmVyLCBzcGVuZGVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWxlZ2F0ZVRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUsIGFkZHJlc3Mgb3JpZ1NlbmRlcikgb25seVNlbmRlcihkZWxlZ2F0ZWRGcm9tKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHRyYW5zZmVyQWxsQXJnc1llc0FsbG93YW5jZShmcm9tLCB0bywgdmFsdWUsIG9yaWdTZW5kZXIpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlbGVnYXRlQXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUsIGFkZHJlc3Mgb3JpZ1NlbmRlcikgb25seVNlbmRlcihkZWxlZ2F0ZWRGcm9tKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGFwcHJvdmVBbGxBcmdzKHNwZW5kZXIsIHZhbHVlLCBvcmlnU2VuZGVyKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWxlZ2F0ZUluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBzcGVuZGVyLCB1aW50IGFkZGVkVmFsdWUsIGFkZHJlc3Mgb3JpZ1NlbmRlcikgb25seVNlbmRlcihkZWxlZ2F0ZWRGcm9tKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGluY3JlYXNlQXBwcm92YWxBbGxBcmdzKHNwZW5kZXIsIGFkZGVkVmFsdWUsIG9yaWdTZW5kZXIpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlbGVnYXRlRGVjcmVhc2VBcHByb3ZhbChhZGRyZXNzIHNwZW5kZXIsIHVpbnQgc3VidHJhY3RlZFZhbHVlLCBhZGRyZXNzIG9yaWdTZW5kZXIpIG9ubHlTZW5kZXIoZGVsZWdhdGVkRnJvbSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBkZWNyZWFzZUFwcHJvdmFsQWxsQXJncyhzcGVuZGVyLCBzdWJ0cmFjdGVkVmFsdWUsIG9yaWdTZW5kZXIpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9Cgpjb250cmFjdCBQYXVzYWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIFBhdXNhYmxlIHsKCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLmFwcHJvdmUoX3NwZW5kZXIsIF92YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgcmV0dXJuIHN1cGVyLmluY3JlYXNlQXBwcm92YWwoX3NwZW5kZXIsIF9hZGRlZFZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJldHVybiBzdXBlci5kZWNyZWFzZUFwcHJvdmFsKF9zcGVuZGVyLCBfc3VidHJhY3RlZFZhbHVlKTsKICB9Cn0KCmNvbnRyYWN0IFVTRERpZ2l0YWwgaXMgU3RhbmRhcmREZWxlZ2F0ZSwgUGF1c2FibGVUb2tlbiwgQnVybmFibGVUb2tlbiwgTm9Pd25lciwgQ2FuRGVsZWdhdGUgewogICAgc3RyaW5nIHB1YmxpYyBuYW1lID0gIlVTRERpZ2l0YWwiOwogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAiVVNERCI7CiAgICB1aW50OCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKCiAgICBBZGRyZXNzTGlzdCBwdWJsaWMgY2FuUmVjZWl2ZU1pbnRXaGl0ZUxpc3Q7CiAgICBBZGRyZXNzTGlzdCBwdWJsaWMgY2FuQnVybldoaXRlTGlzdDsKICAgIEFkZHJlc3NMaXN0IHB1YmxpYyBibGFja0xpc3Q7CiAgICBBZGRyZXNzTGlzdCBwdWJsaWMgbm9GZWVzTGlzdDsKICAgIHVpbnQyNTYgcHVibGljIGJ1cm5NaW4gPSAxMDAwMCAqIDEwKip1aW50MjU2KGRlY2ltYWxzKTsKICAgIHVpbnQyNTYgcHVibGljIGJ1cm5NYXggPSAyMDAwMDAwMCAqIDEwKip1aW50MjU2KGRlY2ltYWxzKTsKCiAgICB1aW50ODAgcHVibGljIHRyYW5zZmVyRmVlTnVtZXJhdG9yID0gNzsKICAgIHVpbnQ4MCBwdWJsaWMgdHJhbnNmZXJGZWVEZW5vbWluYXRvciA9IDEwMDAwOwogICAgdWludDgwIHB1YmxpYyBtaW50RmVlTnVtZXJhdG9yID0gMDsKICAgIHVpbnQ4MCBwdWJsaWMgbWludEZlZURlbm9taW5hdG9yID0gMTAwMDA7CiAgICB1aW50MjU2IHB1YmxpYyBtaW50RmVlRmxhdCA9IDA7CiAgICB1aW50ODAgcHVibGljIGJ1cm5GZWVOdW1lcmF0b3IgPSAwOwogICAgdWludDgwIHB1YmxpYyBidXJuRmVlRGVub21pbmF0b3IgPSAxMDAwMDsKICAgIHVpbnQyNTYgcHVibGljIGJ1cm5GZWVGbGF0ID0gMDsKICAgIGFkZHJlc3MgcHVibGljIHN0YWtlcjsKCiAgICBldmVudCBDaGFuZ2VCdXJuQm91bmRzRXZlbnQodWludDI1NiBuZXdNaW4sIHVpbnQyNTYgbmV3TWF4KTsKICAgIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGFtb3VudCk7CiAgICBldmVudCBXaXBlZEFjY291bnQoYWRkcmVzcyBpbmRleGVkIGFjY291bnQsIHVpbnQyNTYgYmFsYW5jZSk7CgogICAgZnVuY3Rpb24gVVNERGlnaXRhbCgpIHB1YmxpYyB7CiAgICAgICAgdG90YWxTdXBwbHlfID0gMDsKICAgICAgICBzdGFrZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldExpc3RzKEFkZHJlc3NMaXN0IF9jYW5SZWNlaXZlTWludFdoaXRlTGlzdCwgQWRkcmVzc0xpc3QgX2NhbkJ1cm5XaGl0ZUxpc3QsIEFkZHJlc3NMaXN0IF9ibGFja0xpc3QsIEFkZHJlc3NMaXN0IF9ub0ZlZXNMaXN0KSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICBjYW5SZWNlaXZlTWludFdoaXRlTGlzdCA9IF9jYW5SZWNlaXZlTWludFdoaXRlTGlzdDsKICAgICAgICBjYW5CdXJuV2hpdGVMaXN0ID0gX2NhbkJ1cm5XaGl0ZUxpc3Q7CiAgICAgICAgYmxhY2tMaXN0ID0gX2JsYWNrTGlzdDsKICAgICAgICBub0ZlZXNMaXN0ID0gX25vRmVlc0xpc3Q7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlTmFtZShzdHJpbmcgX25hbWUsIHN0cmluZyBfc3ltYm9sKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICBuYW1lID0gX25hbWU7CiAgICAgICAgc3ltYm9sID0gX3N5bWJvbDsKICAgIH0KCiAgICAvL0J1cm5pbmcgZnVuY3Rpb25zIGFzIHdpdGhkcmF3aW5nIG1vbmV5IGZyb20gdGhlIHN5c3RlbS4gVGhlIHBsYXRmb3JtIHdpbGwga2VlcCB0cmFjayBvZiB3aG8gYnVybnMgY29pbnMsCiAgICAvL2FuZCB3aWxsIHNlbmQgdGhlbSBiYWNrIHRoZSBlcXVpdmFsZW50IGFtb3VudCBvZiBtb25leSAocm91bmRlZCBkb3duIHRvIHRoZSBuZWFyZXN0IGNlbnQpLgogICAgZnVuY3Rpb24gYnVybih1aW50MjU2IF92YWx1ZSkgcHVibGljIHsKICAgICAgICByZXF1aXJlKGNhbkJ1cm5XaGl0ZUxpc3Qub25MaXN0KG1zZy5zZW5kZXIpKTsKICAgICAgICByZXF1aXJlKF92YWx1ZSA+PSBidXJuTWluKTsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBidXJuTWF4KTsKICAgICAgICB1aW50MjU2IGZlZSA9IHBheVN0YWtpbmdGZWUobXNnLnNlbmRlciwgX3ZhbHVlLCBidXJuRmVlTnVtZXJhdG9yLCBidXJuRmVlRGVub21pbmF0b3IsIGJ1cm5GZWVGbGF0LCAweDApOwogICAgICAgIHVpbnQyNTYgcmVtYWluaW5nID0gX3ZhbHVlLnN1YihmZWUpOwogICAgICAgIHN1cGVyLmJ1cm4ocmVtYWluaW5nKTsKICAgIH0KCiAgICAvL0NyZWF0ZSBfYW1vdW50IG5ldyB0b2tlbnMgYW5kIHRyYW5zZmVyIHRoZW0gdG8gX3RvLgogICAgLy9CYXNlZCBvbiBjb2RlIGJ5IE9wZW5aZXBwZWxpbjogaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXBwZWxpbi1zb2xpZGl0eS9ibG9iL21hc3Rlci9jb250cmFjdHMvdG9rZW4vTWludGFibGVUb2tlbi5zb2wKICAgIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShjYW5SZWNlaXZlTWludFdoaXRlTGlzdC5vbkxpc3QoX3RvKSk7CiAgICAgICAgdG90YWxTdXBwbHlfID0gdG90YWxTdXBwbHlfLmFkZChfYW1vdW50KTsKICAgICAgICBiYWxhbmNlcy5hZGRCYWxhbmNlKF90bywgX2Ftb3VudCk7CiAgICAgICAgTWludChfdG8sIF9hbW91bnQpOwogICAgICAgIFRyYW5zZmVyKGFkZHJlc3MoMCksIF90bywgX2Ftb3VudCk7CiAgICAgICAgcGF5U3Rha2luZ0ZlZShfdG8sIF9hbW91bnQsIG1pbnRGZWVOdW1lcmF0b3IsIG1pbnRGZWVEZW5vbWluYXRvciwgbWludEZlZUZsYXQsIDB4MCk7CiAgICB9CgogICAgLy9DaGFuZ2UgdGhlIG1pbmltdW0gYW5kIG1heGltdW0gYW1vdW50IHRoYXQgY2FuIGJlIGJ1cm5lZCBhdCBvbmNlLiBCdXJuaW5nCiAgICAvL21heSBiZSBkaXNhYmxlZCBieSBzZXR0aW5nIGJvdGggdG8gMCAodGhpcyB3aWxsIG5vdCBiZSBkb25lIHVuZGVyIG5vcm1hbAogICAgLy9vcGVyYXRpb24sIGJ1dCB3ZSBjYW4ndCBhZGQgY2hlY2tzIHRvIGRpc2FsbG93IGl0IHdpdGhvdXQgbG9zaW5nIGEgbG90IG9mCiAgICAvL2ZsZXhpYmlsaXR5IHNpbmNlIGJ1cm5pbmcgY291bGQgYWxzbyBiZSBhcyBnb29kIGFzIGRpc2FibGVkCiAgICAvL2J5IHNldHRpbmcgdGhlIG1pbmltdW0gZXh0cmVtZWx5IGhpZ2gsIGFuZCB3ZSBkb24ndCB3YW50IHRvIGxvY2sKICAgIC8vaW4gYW55IHBhcnRpY3VsYXIgY2FwIGZvciB0aGUgbWluaW11bSkKICAgIGZ1bmN0aW9uIGNoYW5nZUJ1cm5Cb3VuZHModWludCBuZXdNaW4sIHVpbnQgbmV3TWF4KSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKG5ld01pbiA8PSBuZXdNYXgpOwogICAgICAgIGJ1cm5NaW4gPSBuZXdNaW47CiAgICAgICAgYnVybk1heCA9IG5ld01heDsKICAgICAgICBDaGFuZ2VCdXJuQm91bmRzRXZlbnQobmV3TWluLCBuZXdNYXgpOwogICAgfQoKICAgIC8vIHRyYW5zZmVyIGFuZCB0cmFuc2ZlckZyb20gYXJlIGJvdGggZGlzcGF0Y2hlZCB0byB0aGlzIGZ1bmN0aW9uLCBzbyB3ZQogICAgLy8gY2hlY2sgYmxhY2tsaXN0IGFuZCBwYXkgc3Rha2luZyBmZWUgaGVyZS4KICAgIGZ1bmN0aW9uIHRyYW5zZmVyQWxsQXJnc05vQWxsb3dhbmNlKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgaW50ZXJuYWwgewogICAgICAgIHJlcXVpcmUoIWJsYWNrTGlzdC5vbkxpc3QoX2Zyb20pKTsKICAgICAgICByZXF1aXJlKCFibGFja0xpc3Qub25MaXN0KF90bykpOwogICAgICAgIHN1cGVyLnRyYW5zZmVyQWxsQXJnc05vQWxsb3dhbmNlKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcGF5U3Rha2luZ0ZlZShfdG8sIF92YWx1ZSwgdHJhbnNmZXJGZWVOdW1lcmF0b3IsIHRyYW5zZmVyRmVlRGVub21pbmF0b3IsIDAsIF9mcm9tKTsKICAgIH0KCiAgICBmdW5jdGlvbiB3aXBlQmxhY2tsaXN0ZWRBY2NvdW50KGFkZHJlc3MgYWNjb3VudCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShibGFja0xpc3Qub25MaXN0KGFjY291bnQpKTsKICAgICAgICB1aW50MjU2IG9sZFZhbHVlID0gYmFsYW5jZU9mKGFjY291bnQpOwogICAgICAgIGJhbGFuY2VzLnNldEJhbGFuY2UoYWNjb3VudCwgMCk7CiAgICAgICAgdG90YWxTdXBwbHlfID0gdG90YWxTdXBwbHlfLnN1YihvbGRWYWx1ZSk7CiAgICAgICAgV2lwZWRBY2NvdW50KGFjY291bnQsIG9sZFZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwYXlTdGFraW5nRmVlKGFkZHJlc3MgcGF5ZXIsIHVpbnQyNTYgdmFsdWUsIHVpbnQ4MCBudW1lcmF0b3IsIHVpbnQ4MCBkZW5vbWluYXRvciwgdWludDI1NiBmbGF0UmF0ZSwgYWRkcmVzcyBvdGhlclBhcnRpY2lwYW50KSBwcml2YXRlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBpZiAobm9GZWVzTGlzdC5vbkxpc3QocGF5ZXIpIHx8IG5vRmVlc0xpc3Qub25MaXN0KG90aGVyUGFydGljaXBhbnQpKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgICAgICB1aW50MjU2IHN0YWtpbmdGZWUgPSB2YWx1ZS5tdWwobnVtZXJhdG9yKS5kaXYoZGVub21pbmF0b3IpLmFkZChmbGF0UmF0ZSk7CiAgICAgICAgaWYgKHN0YWtpbmdGZWUgPiAwKSB7CiAgICAgICAgICAgIHN1cGVyLnRyYW5zZmVyQWxsQXJnc05vQWxsb3dhbmNlKHBheWVyLCBzdGFrZXIsIHN0YWtpbmdGZWUpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gc3Rha2luZ0ZlZTsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGFuZ2VTdGFraW5nRmVlcyh1aW50ODAgX3RyYW5zZmVyRmVlTnVtZXJhdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50ODAgX3RyYW5zZmVyRmVlRGVub21pbmF0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ4MCBfbWludEZlZU51bWVyYXRvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDgwIF9taW50RmVlRGVub21pbmF0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQyNTYgX21pbnRGZWVGbGF0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50ODAgX2J1cm5GZWVOdW1lcmF0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ4MCBfYnVybkZlZURlbm9taW5hdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MjU2IF9idXJuRmVlRmxhdCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShfdHJhbnNmZXJGZWVEZW5vbWluYXRvciAhPSAwKTsKICAgICAgICByZXF1aXJlKF9taW50RmVlRGVub21pbmF0b3IgIT0gMCk7CiAgICAgICAgcmVxdWlyZShfYnVybkZlZURlbm9taW5hdG9yICE9IDApOwogICAgICAgIHRyYW5zZmVyRmVlTnVtZXJhdG9yID0gX3RyYW5zZmVyRmVlTnVtZXJhdG9yOwogICAgICAgIHRyYW5zZmVyRmVlRGVub21pbmF0b3IgPSBfdHJhbnNmZXJGZWVEZW5vbWluYXRvcjsKICAgICAgICBtaW50RmVlTnVtZXJhdG9yID0gX21pbnRGZWVOdW1lcmF0b3I7CiAgICAgICAgbWludEZlZURlbm9taW5hdG9yID0gX21pbnRGZWVEZW5vbWluYXRvcjsKICAgICAgICBtaW50RmVlRmxhdCA9IF9taW50RmVlRmxhdDsKICAgICAgICBidXJuRmVlTnVtZXJhdG9yID0gX2J1cm5GZWVOdW1lcmF0b3I7CiAgICAgICAgYnVybkZlZURlbm9taW5hdG9yID0gX2J1cm5GZWVEZW5vbWluYXRvcjsKICAgICAgICBidXJuRmVlRmxhdCA9IF9idXJuRmVlRmxhdDsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGFuZ2VTdGFrZXIoYWRkcmVzcyBuZXdTdGFrZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUobmV3U3Rha2VyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHN0YWtlciA9IG5ld1N0YWtlcjsKICAgIH0KfQ=='.
	

]
