Class {
	#name : #SRT5b21ba38a0db91cc43aa7daba778979758e67991,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT5b21ba38a0db91cc43aa7daba778979758e67991 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgoKLy8vIEB0aXRsZSBNYXRoIGxpYnJhcnkgLSBBbGxvd3MgY2FsY3VsYXRpb24gb2YgbG9nYXJpdGhtaWMgYW5kIGV4cG9uZW50aWFsIGZ1bmN0aW9ucwovLy8gQGF1dGhvciBBbGFuIEx1IC0gPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iN2YxZTEzMWUxMTUxMTMwYTNmMTgxMTEwMGMxNjBjNTEwZjEyIj5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4KLy8vIEBhdXRob3IgU3RlZmFuIEdlb3JnZSAtIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImRiYThhZmJlYmRiYWI1OWJiY2I1YjRhOGIyYThmNWFiYjYiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+PgpsaWJyYXJ5IE1hdGggewoKICAgIC8qCiAgICAgKiAgQ29uc3RhbnRzCiAgICAgKi8KICAgIC8vIFRoaXMgaXMgZXF1YWwgdG8gMSBpbiBvdXIgY2FsY3VsYXRpb25zCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBPTkUgPSAgMHgxMDAwMDAwMDAwMDAwMDAwMDsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IExOMiA9IDB4YjE3MjE3ZjdkMWNmNzlhYzsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IExPRzJfRSA9IDB4MTcxNTQ3NjUyYjgyZmUxNzc7CgogICAgLyoKICAgICAqICBQdWJsaWMgZnVuY3Rpb25zCiAgICAgKi8KICAgIC8vLyBAZGV2IFJldHVybnMgbmF0dXJhbCBleHBvbmVudGlhbCBmdW5jdGlvbiB2YWx1ZSBvZiBnaXZlbiB4CiAgICAvLy8gQHBhcmFtIHggeAogICAgLy8vIEByZXR1cm4gZSoqeAogICAgZnVuY3Rpb24gZXhwKGludCB4KQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCkKICAgIHsKICAgICAgICAvLyByZXZlcnQgaWYgeCBpcyA+IE1BWF9QT1dFUiwgd2hlcmUKICAgICAgICAvLyBNQVhfUE9XRVIgPSBpbnQobXAuZmxvb3IobXAubG9nKG1wZigyKioyNTYgLSAxKSAvIE9ORSkgKiBPTkUpKQogICAgICAgIHJlcXVpcmUoeCA8PSAyNDU0OTcxMjU5ODc4OTA5ODg2Njc5KTsKICAgICAgICAvLyByZXR1cm4gMCBpZiBleHAoeCkgaXMgdGlueSwgdXNpbmcKICAgICAgICAvLyBNSU5fUE9XRVIgPSBpbnQobXAuZmxvb3IobXAubG9nKG1wZigxKSAvIE9ORSkgKiBPTkUpKQogICAgICAgIGlmICh4IDwgLTgxODMyMzc1MzI5Mjk2OTk2MjIyNykKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgLy8gVHJhbnNmb3JtIHNvIHRoYXQgZV54IC0+IDJeeAogICAgICAgIHggPSB4ICogaW50KE9ORSkgLyBpbnQoTE4yKTsKICAgICAgICAvLyAyXnggPSAyXndob2xlKHgpICogMl5mcmFjKHgpCiAgICAgICAgLy8gICAgICAgXl5eXl5eXl5eXiBpcyBhIGJpdCBzaGlmdAogICAgICAgIC8vIHNvIFRheWxvciBleHBhbmQgb24geiA9IGZyYWMoeCkKICAgICAgICBpbnQgc2hpZnQ7CiAgICAgICAgdWludCB6OwogICAgICAgIGlmICh4ID49IDApIHsKICAgICAgICAgICAgc2hpZnQgPSB4IC8gaW50KE9ORSk7CiAgICAgICAgICAgIHogPSB1aW50KHggJSBpbnQoT05FKSk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBzaGlmdCA9IHggLyBpbnQoT05FKSAtIDE7CiAgICAgICAgICAgIHogPSBPTkUgLSB1aW50KC14ICUgaW50KE9ORSkpOwogICAgICAgIH0KICAgICAgICAvLyAyXnggPSAxICsgKGxuIDIpIHggKyAobG4gMileMi8yISB4XjIgKyAuLi4KICAgICAgICAvLwogICAgICAgIC8vIENhbiBnZW5lcmF0ZSB0aGUgeiBjb2VmZmljaWVudHMgdXNpbmcgbXBtYXRoIGFuZCB0aGUgZm9sbG93aW5nIGxpbmVzCiAgICAgICAgLy8gPj4+IGZyb20gbXBtYXRoIGltcG9ydCBtcAogICAgICAgIC8vID4+PiBtcC5kcHMgPSAxMDAKICAgICAgICAvLyA+Pj4gT05FID0gIDB4MTAwMDAwMDAwMDAwMDAwMDAKICAgICAgICAvLyA+Pj4gcHJpbnQoJ1xuJy5qb2luKGhleChpbnQobXAubG9nKDIpKippIC8gbXAuZmFjdG9yaWFsKGkpICogT05FKSkgZm9yIGkgaW4gcmFuZ2UoMSwgNykpKQogICAgICAgIC8vIDB4YjE3MjE3ZjdkMWNmNzlhYgogICAgICAgIC8vIDB4M2Q3ZjdiZmYwNThiMWQ1MAogICAgICAgIC8vIDB4ZTM1ODQ2YjgyNTA1ZmM1CiAgICAgICAgLy8gMHgyNzY1NTZkZjc0OWNlZTUKICAgICAgICAvLyAweDU3NjFmZjllMjk5Y2M0CiAgICAgICAgLy8gMHhhMTg0ODk3YzM2M2MzCiAgICAgICAgdWludCB6cG93ID0gejsKICAgICAgICB1aW50IHJlc3VsdCA9IE9ORTsKICAgICAgICByZXN1bHQgKz0gMHhiMTcyMTdmN2QxY2Y3OWFiICogenBvdyAvIE9ORTsKICAgICAgICB6cG93ID0genBvdyAqIHogLyBPTkU7CiAgICAgICAgcmVzdWx0ICs9IDB4M2Q3ZjdiZmYwNThiMWQ1MCAqIHpwb3cgLyBPTkU7CiAgICAgICAgenBvdyA9IHpwb3cgKiB6IC8gT05FOwogICAgICAgIHJlc3VsdCArPSAweGUzNTg0NmI4MjUwNWZjNSAqIHpwb3cgLyBPTkU7CiAgICAgICAgenBvdyA9IHpwb3cgKiB6IC8gT05FOwogICAgICAgIHJlc3VsdCArPSAweDI3NjU1NmRmNzQ5Y2VlNSAqIHpwb3cgLyBPTkU7CiAgICAgICAgenBvdyA9IHpwb3cgKiB6IC8gT05FOwogICAgICAgIHJlc3VsdCArPSAweDU3NjFmZjllMjk5Y2M0ICogenBvdyAvIE9ORTsKICAgICAgICB6cG93ID0genBvdyAqIHogLyBPTkU7CiAgICAgICAgcmVzdWx0ICs9IDB4YTE4NDg5N2MzNjNjMyAqIHpwb3cgLyBPTkU7CiAgICAgICAgenBvdyA9IHpwb3cgKiB6IC8gT05FOwogICAgICAgIHJlc3VsdCArPSAweGZmZTVmZTJjNDU4NiAqIHpwb3cgLyBPTkU7CiAgICAgICAgenBvdyA9IHpwb3cgKiB6IC8gT05FOwogICAgICAgIHJlc3VsdCArPSAweDE2MmMwMjIzYTVjOCAqIHpwb3cgLyBPTkU7CiAgICAgICAgenBvdyA9IHpwb3cgKiB6IC8gT05FOwogICAgICAgIHJlc3VsdCArPSAweDFiNTI1M2QzOTVlICogenBvdyAvIE9ORTsKICAgICAgICB6cG93ID0genBvdyAqIHogLyBPTkU7CiAgICAgICAgcmVzdWx0ICs9IDB4MWU0Y2Y1MTU4YiAqIHpwb3cgLyBPTkU7CiAgICAgICAgenBvdyA9IHpwb3cgKiB6IC8gT05FOwogICAgICAgIHJlc3VsdCArPSAweDFlOGNhYzczNSAqIHpwb3cgLyBPTkU7CiAgICAgICAgenBvdyA9IHpwb3cgKiB6IC8gT05FOwogICAgICAgIHJlc3VsdCArPSAweDFjM2JkNjUwICogenBvdyAvIE9ORTsKICAgICAgICB6cG93ID0genBvdyAqIHogLyBPTkU7CiAgICAgICAgcmVzdWx0ICs9IDB4MTgxNjE5MyAqIHpwb3cgLyBPTkU7CiAgICAgICAgenBvdyA9IHpwb3cgKiB6IC8gT05FOwogICAgICAgIHJlc3VsdCArPSAweDEzMTQ5NiAqIHpwb3cgLyBPTkU7CiAgICAgICAgenBvdyA9IHpwb3cgKiB6IC8gT05FOwogICAgICAgIHJlc3VsdCArPSAweGUxYjcgKiB6cG93IC8gT05FOwogICAgICAgIHpwb3cgPSB6cG93ICogeiAvIE9ORTsKICAgICAgICByZXN1bHQgKz0gMHg5YzcgKiB6cG93IC8gT05FOwogICAgICAgIGlmIChzaGlmdCA+PSAwKSB7CiAgICAgICAgICAgIGlmIChyZXN1bHQgPj4gKDI1Ni1zaGlmdCkgPiAwKQogICAgICAgICAgICAgICAgcmV0dXJuICgyKioyNTYtMSk7CiAgICAgICAgICAgIHJldHVybiByZXN1bHQgPDwgc2hpZnQ7CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdCA+PiAoLXNoaWZ0KTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIG5hdHVyYWwgbG9nYXJpdGhtIHZhbHVlIG9mIGdpdmVuIHgKICAgIC8vLyBAcGFyYW0geCB4CiAgICAvLy8gQHJldHVybiBsbih4KQogICAgZnVuY3Rpb24gbG4odWludCB4KQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoaW50KQogICAgewogICAgICAgIHJlcXVpcmUoeCA+IDApOwogICAgICAgIC8vIGJpbmFyeSBzZWFyY2ggZm9yIGZsb29yKGxvZzIoeCkpCiAgICAgICAgaW50IGlsb2cyID0gZmxvb3JMb2cyKHgpOwogICAgICAgIGludCB6OwogICAgICAgIGlmIChpbG9nMiA8IDApCiAgICAgICAgICAgIHogPSBpbnQoeCA8PCB1aW50KC1pbG9nMikpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgeiA9IGludCh4ID4+IHVpbnQoaWxvZzIpKTsKICAgICAgICAvLyB6ID0geCAqIDJeLeKMimxvZ+KCgnjijIsKICAgICAgICAvLyBzbyAxIDw9IHogPCAyCiAgICAgICAgLy8gYW5kIGxuIHogPSBsbiB4IC0g4oyKbG9n4oKCeOKMiy9sb2figoJlCiAgICAgICAgLy8gc28ganVzdCBjb21wdXRlIGxuIHogdXNpbmcgYXJ0YW5oIHNlcmllcwogICAgICAgIC8vIGFuZCBjYWxjdWxhdGUgbG4geCBmcm9tIHRoYXQKICAgICAgICBpbnQgdGVybSA9ICh6IC0gaW50KE9ORSkpICogaW50KE9ORSkgLyAoeiArIGludChPTkUpKTsKICAgICAgICBpbnQgaGFsZmxueiA9IHRlcm07CiAgICAgICAgaW50IHRlcm1wb3cgPSB0ZXJtICogdGVybSAvIGludChPTkUpICogdGVybSAvIGludChPTkUpOwogICAgICAgIGhhbGZsbnogKz0gdGVybXBvdyAvIDM7CiAgICAgICAgdGVybXBvdyA9IHRlcm1wb3cgKiB0ZXJtIC8gaW50KE9ORSkgKiB0ZXJtIC8gaW50KE9ORSk7CiAgICAgICAgaGFsZmxueiArPSB0ZXJtcG93IC8gNTsKICAgICAgICB0ZXJtcG93ID0gdGVybXBvdyAqIHRlcm0gLyBpbnQoT05FKSAqIHRlcm0gLyBpbnQoT05FKTsKICAgICAgICBoYWxmbG56ICs9IHRlcm1wb3cgLyA3OwogICAgICAgIHRlcm1wb3cgPSB0ZXJtcG93ICogdGVybSAvIGludChPTkUpICogdGVybSAvIGludChPTkUpOwogICAgICAgIGhhbGZsbnogKz0gdGVybXBvdyAvIDk7CiAgICAgICAgdGVybXBvdyA9IHRlcm1wb3cgKiB0ZXJtIC8gaW50KE9ORSkgKiB0ZXJtIC8gaW50KE9ORSk7CiAgICAgICAgaGFsZmxueiArPSB0ZXJtcG93IC8gMTE7CiAgICAgICAgdGVybXBvdyA9IHRlcm1wb3cgKiB0ZXJtIC8gaW50KE9ORSkgKiB0ZXJtIC8gaW50KE9ORSk7CiAgICAgICAgaGFsZmxueiArPSB0ZXJtcG93IC8gMTM7CiAgICAgICAgdGVybXBvdyA9IHRlcm1wb3cgKiB0ZXJtIC8gaW50KE9ORSkgKiB0ZXJtIC8gaW50KE9ORSk7CiAgICAgICAgaGFsZmxueiArPSB0ZXJtcG93IC8gMTU7CiAgICAgICAgdGVybXBvdyA9IHRlcm1wb3cgKiB0ZXJtIC8gaW50KE9ORSkgKiB0ZXJtIC8gaW50KE9ORSk7CiAgICAgICAgaGFsZmxueiArPSB0ZXJtcG93IC8gMTc7CiAgICAgICAgdGVybXBvdyA9IHRlcm1wb3cgKiB0ZXJtIC8gaW50KE9ORSkgKiB0ZXJtIC8gaW50KE9ORSk7CiAgICAgICAgaGFsZmxueiArPSB0ZXJtcG93IC8gMTk7CiAgICAgICAgdGVybXBvdyA9IHRlcm1wb3cgKiB0ZXJtIC8gaW50KE9ORSkgKiB0ZXJtIC8gaW50KE9ORSk7CiAgICAgICAgaGFsZmxueiArPSB0ZXJtcG93IC8gMjE7CiAgICAgICAgdGVybXBvdyA9IHRlcm1wb3cgKiB0ZXJtIC8gaW50KE9ORSkgKiB0ZXJtIC8gaW50KE9ORSk7CiAgICAgICAgaGFsZmxueiArPSB0ZXJtcG93IC8gMjM7CiAgICAgICAgdGVybXBvdyA9IHRlcm1wb3cgKiB0ZXJtIC8gaW50KE9ORSkgKiB0ZXJtIC8gaW50KE9ORSk7CiAgICAgICAgaGFsZmxueiArPSB0ZXJtcG93IC8gMjU7CiAgICAgICAgcmV0dXJuIChpbG9nMiAqIGludChPTkUpKSAqIGludChPTkUpIC8gaW50KExPRzJfRSkgKyAyICogaGFsZmxuejsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIGJhc2UgMiBsb2dhcml0aG0gdmFsdWUgb2YgZ2l2ZW4geAogICAgLy8vIEBwYXJhbSB4IHgKICAgIC8vLyBAcmV0dXJuIGxvZ2FyaXRobWljIHZhbHVlCiAgICBmdW5jdGlvbiBmbG9vckxvZzIodWludCB4KQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoaW50IGxvKQogICAgewogICAgICAgIGxvID0gLTY0OwogICAgICAgIGludCBoaSA9IDE5MzsKICAgICAgICAvLyBJIHVzZSBhIHNoaWZ0IGhlcmUgaW5zdGVhZCBvZiAvIDIgYmVjYXVzZSBpdCBmbG9vcnMgaW5zdGVhZCBvZiByb3VuZGluZyB0b3dhcmRzIDAKICAgICAgICBpbnQgbWlkID0gKGhpICsgbG8pID4+IDE7CiAgICAgICAgd2hpbGUoKGxvICsgMSkgPCBoaSkgewogICAgICAgICAgICBpZiAobWlkIDwgMCAmJiB4IDw8IHVpbnQoLW1pZCkgPCBPTkUgfHwgbWlkID49IDAgJiYgeCA+PiB1aW50KG1pZCkgPCBPTkUpCiAgICAgICAgICAgICAgICBoaSA9IG1pZDsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgbG8gPSBtaWQ7CiAgICAgICAgICAgIG1pZCA9IChoaSArIGxvKSA+PiAxOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIG1heGltdW0gb2YgYW4gYXJyYXkKICAgIC8vLyBAcGFyYW0gbnVtcyBOdW1iZXJzIHRvIGxvb2sgdGhyb3VnaAogICAgLy8vIEByZXR1cm4gTWF4aW11bSBudW1iZXIKICAgIGZ1bmN0aW9uIG1heChpbnRbXSBudW1zKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoaW50IG1heCkKICAgIHsKICAgICAgICByZXF1aXJlKG51bXMubGVuZ3RoID4gMCk7CiAgICAgICAgbWF4ID0gLTIqKjI1NTsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBudW1zLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBpZiAobnVtc1tpXSA+IG1heCkKICAgICAgICAgICAgICAgIG1heCA9IG51bXNbaV07CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyB3aGV0aGVyIGFuIGFkZCBvcGVyYXRpb24gY2F1c2VzIGFuIG92ZXJmbG93CiAgICAvLy8gQHBhcmFtIGEgRmlyc3QgYWRkZW5kCiAgICAvLy8gQHBhcmFtIGIgU2Vjb25kIGFkZGVuZAogICAgLy8vIEByZXR1cm4gRGlkIG5vIG92ZXJmbG93IG9jY3VyPwogICAgZnVuY3Rpb24gc2FmZVRvQWRkKHVpbnQgYSwgdWludCBiKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXR1cm4gYSArIGIgPj0gYTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIHdoZXRoZXIgYSBzdWJ0cmFjdGlvbiBvcGVyYXRpb24gY2F1c2VzIGFuIHVuZGVyZmxvdwogICAgLy8vIEBwYXJhbSBhIE1pbnVlbmQKICAgIC8vLyBAcGFyYW0gYiBTdWJ0cmFoZW5kCiAgICAvLy8gQHJldHVybiBEaWQgbm8gdW5kZXJmbG93IG9jY3VyPwogICAgZnVuY3Rpb24gc2FmZVRvU3ViKHVpbnQgYSwgdWludCBiKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXR1cm4gYSA+PSBiOwogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgd2hldGhlciBhIG11bHRpcGx5IG9wZXJhdGlvbiBjYXVzZXMgYW4gb3ZlcmZsb3cKICAgIC8vLyBAcGFyYW0gYSBGaXJzdCBmYWN0b3IKICAgIC8vLyBAcGFyYW0gYiBTZWNvbmQgZmFjdG9yCiAgICAvLy8gQHJldHVybiBEaWQgbm8gb3ZlcmZsb3cgb2NjdXI/CiAgICBmdW5jdGlvbiBzYWZlVG9NdWwodWludCBhLCB1aW50IGIpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHJldHVybiBiID09IDAgfHwgYSAqIGIgLyBiID09IGE7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyBzdW0gaWYgbm8gb3ZlcmZsb3cgb2NjdXJyZWQKICAgIC8vLyBAcGFyYW0gYSBGaXJzdCBhZGRlbmQKICAgIC8vLyBAcGFyYW0gYiBTZWNvbmQgYWRkZW5kCiAgICAvLy8gQHJldHVybiBTdW0KICAgIGZ1bmN0aW9uIGFkZCh1aW50IGEsIHVpbnQgYikKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQpCiAgICB7CiAgICAgICAgcmVxdWlyZShzYWZlVG9BZGQoYSwgYikpOwogICAgICAgIHJldHVybiBhICsgYjsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIGRpZmZlcmVuY2UgaWYgbm8gb3ZlcmZsb3cgb2NjdXJyZWQKICAgIC8vLyBAcGFyYW0gYSBNaW51ZW5kCiAgICAvLy8gQHBhcmFtIGIgU3VidHJhaGVuZAogICAgLy8vIEByZXR1cm4gRGlmZmVyZW5jZQogICAgZnVuY3Rpb24gc3ViKHVpbnQgYSwgdWludCBiKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCkKICAgIHsKICAgICAgICByZXF1aXJlKHNhZmVUb1N1YihhLCBiKSk7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgcHJvZHVjdCBpZiBubyBvdmVyZmxvdyBvY2N1cnJlZAogICAgLy8vIEBwYXJhbSBhIEZpcnN0IGZhY3RvcgogICAgLy8vIEBwYXJhbSBiIFNlY29uZCBmYWN0b3IKICAgIC8vLyBAcmV0dXJuIFByb2R1Y3QKICAgIGZ1bmN0aW9uIG11bCh1aW50IGEsIHVpbnQgYikKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQpCiAgICB7CiAgICAgICAgcmVxdWlyZShzYWZlVG9NdWwoYSwgYikpOwogICAgICAgIHJldHVybiBhICogYjsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIHdoZXRoZXIgYW4gYWRkIG9wZXJhdGlvbiBjYXVzZXMgYW4gb3ZlcmZsb3cKICAgIC8vLyBAcGFyYW0gYSBGaXJzdCBhZGRlbmQKICAgIC8vLyBAcGFyYW0gYiBTZWNvbmQgYWRkZW5kCiAgICAvLy8gQHJldHVybiBEaWQgbm8gb3ZlcmZsb3cgb2NjdXI/CiAgICBmdW5jdGlvbiBzYWZlVG9BZGQoaW50IGEsIGludCBiKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXR1cm4gKGIgPj0gMCAmJiBhICsgYiA+PSBhKSB8fCAoYiA8IDAgJiYgYSArIGIgPCBhKTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIHdoZXRoZXIgYSBzdWJ0cmFjdGlvbiBvcGVyYXRpb24gY2F1c2VzIGFuIHVuZGVyZmxvdwogICAgLy8vIEBwYXJhbSBhIE1pbnVlbmQKICAgIC8vLyBAcGFyYW0gYiBTdWJ0cmFoZW5kCiAgICAvLy8gQHJldHVybiBEaWQgbm8gdW5kZXJmbG93IG9jY3VyPwogICAgZnVuY3Rpb24gc2FmZVRvU3ViKGludCBhLCBpbnQgYikKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmV0dXJuIChiID49IDAgJiYgYSAtIGIgPD0gYSkgfHwgKGIgPCAwICYmIGEgLSBiID4gYSk7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyB3aGV0aGVyIGEgbXVsdGlwbHkgb3BlcmF0aW9uIGNhdXNlcyBhbiBvdmVyZmxvdwogICAgLy8vIEBwYXJhbSBhIEZpcnN0IGZhY3RvcgogICAgLy8vIEBwYXJhbSBiIFNlY29uZCBmYWN0b3IKICAgIC8vLyBAcmV0dXJuIERpZCBubyBvdmVyZmxvdyBvY2N1cj8KICAgIGZ1bmN0aW9uIHNhZmVUb011bChpbnQgYSwgaW50IGIpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHJldHVybiAoYiA9PSAwKSB8fCAoYSAqIGIgLyBiID09IGEpOwogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgc3VtIGlmIG5vIG92ZXJmbG93IG9jY3VycmVkCiAgICAvLy8gQHBhcmFtIGEgRmlyc3QgYWRkZW5kCiAgICAvLy8gQHBhcmFtIGIgU2Vjb25kIGFkZGVuZAogICAgLy8vIEByZXR1cm4gU3VtCiAgICBmdW5jdGlvbiBhZGQoaW50IGEsIGludCBiKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoaW50KQogICAgewogICAgICAgIHJlcXVpcmUoc2FmZVRvQWRkKGEsIGIpKTsKICAgICAgICByZXR1cm4gYSArIGI7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyBkaWZmZXJlbmNlIGlmIG5vIG92ZXJmbG93IG9jY3VycmVkCiAgICAvLy8gQHBhcmFtIGEgTWludWVuZAogICAgLy8vIEBwYXJhbSBiIFN1YnRyYWhlbmQKICAgIC8vLyBAcmV0dXJuIERpZmZlcmVuY2UKICAgIGZ1bmN0aW9uIHN1YihpbnQgYSwgaW50IGIpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChpbnQpCiAgICB7CiAgICAgICAgcmVxdWlyZShzYWZlVG9TdWIoYSwgYikpOwogICAgICAgIHJldHVybiBhIC0gYjsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIHByb2R1Y3QgaWYgbm8gb3ZlcmZsb3cgb2NjdXJyZWQKICAgIC8vLyBAcGFyYW0gYSBGaXJzdCBmYWN0b3IKICAgIC8vLyBAcGFyYW0gYiBTZWNvbmQgZmFjdG9yCiAgICAvLy8gQHJldHVybiBQcm9kdWN0CiAgICBmdW5jdGlvbiBtdWwoaW50IGEsIGludCBiKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoaW50KQogICAgewogICAgICAgIHJlcXVpcmUoc2FmZVRvTXVsKGEsIGIpKTsKICAgICAgICByZXR1cm4gYSAqIGI7CiAgICB9Cn0KCgoKLy8vIEB0aXRsZSBBYnN0cmFjdCB0b2tlbiBjb250cmFjdCAtIEZ1bmN0aW9ucyB0byBiZSBpbXBsZW1lbnRlZCBieSB0b2tlbiBjb250cmFjdHMKY29udHJhY3QgVG9rZW4gewoKICAgIC8qCiAgICAgKiAgRXZlbnRzCiAgICAgKi8KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQgdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludCB2YWx1ZSk7CgogICAgLyoKICAgICAqICBQdWJsaWMgZnVuY3Rpb25zCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBvd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCk7Cn0KCgoKLy8vIEB0aXRsZSBTdGFuZGFyZCB0b2tlbiBjb250cmFjdCB3aXRoIG92ZXJmbG93IHByb3RlY3Rpb24KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBUb2tlbiB7CiAgICB1c2luZyBNYXRoIGZvciAqOwoKICAgIC8qCiAgICAgKiAgU3RvcmFnZQogICAgICovCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIGJhbGFuY2VzOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpKSBhbGxvd2FuY2VzOwogICAgdWludCB0b3RhbFRva2VuczsKCiAgICAvKgogICAgICogIFB1YmxpYyBmdW5jdGlvbnMKICAgICAqLwogICAgLy8vIEBkZXYgVHJhbnNmZXJzIHNlbmRlcidzIHRva2VucyB0byBhIGdpdmVuIGFkZHJlc3MuIFJldHVybnMgc3VjY2VzcwogICAgLy8vIEBwYXJhbSB0byBBZGRyZXNzIG9mIHRva2VuIHJlY2VpdmVyCiAgICAvLy8gQHBhcmFtIHZhbHVlIE51bWJlciBvZiB0b2tlbnMgdG8gdHJhbnNmZXIKICAgIC8vLyBAcmV0dXJuIFdhcyB0cmFuc2ZlciBzdWNjZXNzZnVsPwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludCB2YWx1ZSkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIGlmICggICAhYmFsYW5jZXNbbXNnLnNlbmRlcl0uc2FmZVRvU3ViKHZhbHVlKQogICAgICAgICAgICB8fCAhYmFsYW5jZXNbdG9dLnNhZmVUb0FkZCh2YWx1ZSkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSB2YWx1ZTsKICAgICAgICBiYWxhbmNlc1t0b10gKz0gdmFsdWU7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgdG8sIHZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLy8gQGRldiBBbGxvd3MgYWxsb3dlZCB0aGlyZCBwYXJ0eSB0byB0cmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyLiBSZXR1cm5zIHN1Y2Nlc3MKICAgIC8vLyBAcGFyYW0gZnJvbSBBZGRyZXNzIGZyb20gd2hlcmUgdG9rZW5zIGFyZSB3aXRoZHJhd24KICAgIC8vLyBAcGFyYW0gdG8gQWRkcmVzcyB0byB3aGVyZSB0b2tlbnMgYXJlIHNlbnQKICAgIC8vLyBAcGFyYW0gdmFsdWUgTnVtYmVyIG9mIHRva2VucyB0byB0cmFuc2ZlcgogICAgLy8vIEByZXR1cm4gV2FzIHRyYW5zZmVyIHN1Y2Nlc3NmdWw/CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50IHZhbHVlKQogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgaWYgKCAgICFiYWxhbmNlc1tmcm9tXS5zYWZlVG9TdWIodmFsdWUpCiAgICAgICAgICAgIHx8ICFhbGxvd2FuY2VzW2Zyb21dW21zZy5zZW5kZXJdLnNhZmVUb1N1Yih2YWx1ZSkKICAgICAgICAgICAgfHwgIWJhbGFuY2VzW3RvXS5zYWZlVG9BZGQodmFsdWUpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgYmFsYW5jZXNbZnJvbV0gLT0gdmFsdWU7CiAgICAgICAgYWxsb3dhbmNlc1tmcm9tXVttc2cuc2VuZGVyXSAtPSB2YWx1ZTsKICAgICAgICBiYWxhbmNlc1t0b10gKz0gdmFsdWU7CiAgICAgICAgVHJhbnNmZXIoZnJvbSwgdG8sIHZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLy8gQGRldiBTZXRzIGFwcHJvdmVkIGFtb3VudCBvZiB0b2tlbnMgZm9yIHNwZW5kZXIuIFJldHVybnMgc3VjY2VzcwogICAgLy8vIEBwYXJhbSBzcGVuZGVyIEFkZHJlc3Mgb2YgYWxsb3dlZCBhY2NvdW50CiAgICAvLy8gQHBhcmFtIHZhbHVlIE51bWJlciBvZiBhcHByb3ZlZCB0b2tlbnMKICAgIC8vLyBAcmV0dXJuIFdhcyBhcHByb3ZhbCBzdWNjZXNzZnVsPwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQgdmFsdWUpCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICBhbGxvd2FuY2VzW21zZy5zZW5kZXJdW3NwZW5kZXJdID0gdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgc3BlbmRlciwgdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgbnVtYmVyIG9mIGFsbG93ZWQgdG9rZW5zIGZvciBnaXZlbiBhZGRyZXNzCiAgICAvLy8gQHBhcmFtIG93bmVyIEFkZHJlc3Mgb2YgdG9rZW4gb3duZXIKICAgIC8vLyBAcGFyYW0gc3BlbmRlciBBZGRyZXNzIG9mIHRva2VuIHNwZW5kZXIKICAgIC8vLyBAcmV0dXJuIFJlbWFpbmluZyBhbGxvd2FuY2UgZm9yIHNwZW5kZXIKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50KQogICAgewogICAgICAgIHJldHVybiBhbGxvd2FuY2VzW293bmVyXVtzcGVuZGVyXTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIG51bWJlciBvZiB0b2tlbnMgb3duZWQgYnkgZ2l2ZW4gYWRkcmVzcwogICAgLy8vIEBwYXJhbSBvd25lciBBZGRyZXNzIG9mIHRva2VuIG93bmVyCiAgICAvLy8gQHJldHVybiBCYWxhbmNlIG9mIG93bmVyCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBvd25lcikKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQpCiAgICB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW293bmVyXTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIHRvdGFsIHN1cHBseSBvZiB0b2tlbnMKICAgIC8vLyBAcmV0dXJuIFRvdGFsIHN1cHBseQogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCkKICAgIHsKICAgICAgICByZXR1cm4gdG90YWxUb2tlbnM7CiAgICB9Cn0KCgoKLy8vIEB0aXRsZSBPdXRjb21lIHRva2VuIGNvbnRyYWN0IC0gSXNzdWluZyBhbmQgcmV2b2tpbmcgb3V0Y29tZSB0b2tlbnMKLy8vIEBhdXRob3IgU3RlZmFuIEdlb3JnZSAtIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjIxNTI1NTQ0NDc0MDRmNjE0NjRmNGU1MjQ4NTIwZjUxNGMiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+Pgpjb250cmFjdCBPdXRjb21lVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiB7CiAgICB1c2luZyBNYXRoIGZvciAqOwoKICAgIC8qCiAgICAgKiAgRXZlbnRzCiAgICAgKi8KICAgIGV2ZW50IElzc3VhbmNlKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgdWludCBhbW91bnQpOwogICAgZXZlbnQgUmV2b2NhdGlvbihhZGRyZXNzIGluZGV4ZWQgb3duZXIsIHVpbnQgYW1vdW50KTsKCiAgICAvKgogICAgICogIFN0b3JhZ2UKICAgICAqLwogICAgYWRkcmVzcyBwdWJsaWMgZXZlbnRDb250cmFjdDsKCiAgICAvKgogICAgICogIE1vZGlmaWVycwogICAgICovCiAgICBtb2RpZmllciBpc0V2ZW50Q29udHJhY3QgKCkgewogICAgICAgIC8vIE9ubHkgZXZlbnQgY29udHJhY3QgaXMgYWxsb3dlZCB0byBwcm9jZWVkCiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGV2ZW50Q29udHJhY3QpOwogICAgICAgIF87CiAgICB9CgogICAgLyoKICAgICAqICBQdWJsaWMgZnVuY3Rpb25zCiAgICAgKi8KICAgIC8vLyBAZGV2IENvbnN0cnVjdG9yIHNldHMgZXZlbnRzIGNvbnRyYWN0IGFkZHJlc3MKICAgIGZ1bmN0aW9uIE91dGNvbWVUb2tlbigpCiAgICAgICAgcHVibGljCiAgICB7CiAgICAgICAgZXZlbnRDb250cmFjdCA9IG1zZy5zZW5kZXI7CiAgICB9CiAgICAKICAgIC8vLyBAZGV2IEV2ZW50cyBjb250cmFjdCBpc3N1ZXMgbmV3IHRva2VucyBmb3IgYWRkcmVzcy4gUmV0dXJucyBzdWNjZXNzCiAgICAvLy8gQHBhcmFtIF9mb3IgQWRkcmVzcyBvZiByZWNlaXZlcgogICAgLy8vIEBwYXJhbSBvdXRjb21lVG9rZW5Db3VudCBOdW1iZXIgb2YgdG9rZW5zIHRvIGlzc3VlCiAgICBmdW5jdGlvbiBpc3N1ZShhZGRyZXNzIF9mb3IsIHVpbnQgb3V0Y29tZVRva2VuQ291bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgaXNFdmVudENvbnRyYWN0CiAgICB7CiAgICAgICAgYmFsYW5jZXNbX2Zvcl0gPSBiYWxhbmNlc1tfZm9yXS5hZGQob3V0Y29tZVRva2VuQ291bnQpOwogICAgICAgIHRvdGFsVG9rZW5zID0gdG90YWxUb2tlbnMuYWRkKG91dGNvbWVUb2tlbkNvdW50KTsKICAgICAgICBJc3N1YW5jZShfZm9yLCBvdXRjb21lVG9rZW5Db3VudCk7CiAgICB9CgogICAgLy8vIEBkZXYgRXZlbnRzIGNvbnRyYWN0IHJldm9rZXMgdG9rZW5zIGZvciBhZGRyZXNzLiBSZXR1cm5zIHN1Y2Nlc3MKICAgIC8vLyBAcGFyYW0gX2ZvciBBZGRyZXNzIG9mIHRva2VuIGhvbGRlcgogICAgLy8vIEBwYXJhbSBvdXRjb21lVG9rZW5Db3VudCBOdW1iZXIgb2YgdG9rZW5zIHRvIHJldm9rZQogICAgZnVuY3Rpb24gcmV2b2tlKGFkZHJlc3MgX2ZvciwgdWludCBvdXRjb21lVG9rZW5Db3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICBpc0V2ZW50Q29udHJhY3QKICAgIHsKICAgICAgICBiYWxhbmNlc1tfZm9yXSA9IGJhbGFuY2VzW19mb3JdLnN1YihvdXRjb21lVG9rZW5Db3VudCk7CiAgICAgICAgdG90YWxUb2tlbnMgPSB0b3RhbFRva2Vucy5zdWIob3V0Y29tZVRva2VuQ291bnQpOwogICAgICAgIFJldm9jYXRpb24oX2Zvciwgb3V0Y29tZVRva2VuQ291bnQpOwogICAgfQp9CgoKCi8vLyBAdGl0bGUgQWJzdHJhY3Qgb3JhY2xlIGNvbnRyYWN0IC0gRnVuY3Rpb25zIHRvIGJlIGltcGxlbWVudGVkIGJ5IG9yYWNsZXMKY29udHJhY3QgT3JhY2xlIHsKCiAgICBmdW5jdGlvbiBpc091dGNvbWVTZXQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRPdXRjb21lKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGludCk7Cn0KCgoKLy8vIEB0aXRsZSBFdmVudCBjb250cmFjdCAtIFByb3ZpZGUgYmFzaWMgZnVuY3Rpb25hbGl0eSByZXF1aXJlZCBieSBkaWZmZXJlbnQgZXZlbnQgdHlwZXMKLy8vIEBhdXRob3IgU3RlZmFuIEdlb3JnZSAtIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjY2MTUxMjAzMDAwNzA4MjYwMTA4MDkxNTBmMTU0ODE2MGIiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+Pgpjb250cmFjdCBFdmVudCB7CgogICAgLyoKICAgICAqICBFdmVudHMKICAgICAqLwogICAgZXZlbnQgT3V0Y29tZVRva2VuQ3JlYXRpb24oT3V0Y29tZVRva2VuIG91dGNvbWVUb2tlbiwgdWludDggaW5kZXgpOwogICAgZXZlbnQgT3V0Y29tZVRva2VuU2V0SXNzdWFuY2UoYWRkcmVzcyBpbmRleGVkIGJ1eWVyLCB1aW50IGNvbGxhdGVyYWxUb2tlbkNvdW50KTsKICAgIGV2ZW50IE91dGNvbWVUb2tlblNldFJldm9jYXRpb24oYWRkcmVzcyBpbmRleGVkIHNlbGxlciwgdWludCBvdXRjb21lVG9rZW5Db3VudCk7CiAgICBldmVudCBPdXRjb21lQXNzaWdubWVudChpbnQgb3V0Y29tZSk7CiAgICBldmVudCBXaW5uaW5nc1JlZGVtcHRpb24oYWRkcmVzcyBpbmRleGVkIHJlY2VpdmVyLCB1aW50IHdpbm5pbmdzKTsKCiAgICAvKgogICAgICogIFN0b3JhZ2UKICAgICAqLwogICAgVG9rZW4gcHVibGljIGNvbGxhdGVyYWxUb2tlbjsKICAgIE9yYWNsZSBwdWJsaWMgb3JhY2xlOwogICAgYm9vbCBwdWJsaWMgaXNPdXRjb21lU2V0OwogICAgaW50IHB1YmxpYyBvdXRjb21lOwogICAgT3V0Y29tZVRva2VuW10gcHVibGljIG91dGNvbWVUb2tlbnM7CgogICAgLyoKICAgICAqICBQdWJsaWMgZnVuY3Rpb25zCiAgICAgKi8KICAgIC8vLyBAZGV2IENvbnRyYWN0IGNvbnN0cnVjdG9yIHZhbGlkYXRlcyBhbmQgc2V0cyBiYXNpYyBldmVudCBwcm9wZXJ0aWVzCiAgICAvLy8gQHBhcmFtIF9jb2xsYXRlcmFsVG9rZW4gVG9rZW5zIHVzZWQgYXMgY29sbGF0ZXJhbCBpbiBleGNoYW5nZSBmb3Igb3V0Y29tZSB0b2tlbnMKICAgIC8vLyBAcGFyYW0gX29yYWNsZSBPcmFjbGUgY29udHJhY3QgdXNlZCB0byByZXNvbHZlIHRoZSBldmVudAogICAgLy8vIEBwYXJhbSBvdXRjb21lQ291bnQgTnVtYmVyIG9mIGV2ZW50IG91dGNvbWVzCiAgICBmdW5jdGlvbiBFdmVudChUb2tlbiBfY29sbGF0ZXJhbFRva2VuLCBPcmFjbGUgX29yYWNsZSwgdWludDggb3V0Y29tZUNvdW50KQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIC8vIFZhbGlkYXRlIGlucHV0CiAgICAgICAgcmVxdWlyZShhZGRyZXNzKF9jb2xsYXRlcmFsVG9rZW4pICE9IDAgJiYgYWRkcmVzcyhfb3JhY2xlKSAhPSAwICYmIG91dGNvbWVDb3VudCA+PSAyKTsKICAgICAgICBjb2xsYXRlcmFsVG9rZW4gPSBfY29sbGF0ZXJhbFRva2VuOwogICAgICAgIG9yYWNsZSA9IF9vcmFjbGU7CiAgICAgICAgLy8gQ3JlYXRlIGFuIG91dGNvbWUgdG9rZW4gZm9yIGVhY2ggb3V0Y29tZQogICAgICAgIGZvciAodWludDggaSA9IDA7IGkgPCBvdXRjb21lQ291bnQ7IGkrKykgewogICAgICAgICAgICBPdXRjb21lVG9rZW4gb3V0Y29tZVRva2VuID0gbmV3IE91dGNvbWVUb2tlbigpOwogICAgICAgICAgICBvdXRjb21lVG9rZW5zLnB1c2gob3V0Y29tZVRva2VuKTsKICAgICAgICAgICAgT3V0Y29tZVRva2VuQ3JlYXRpb24ob3V0Y29tZVRva2VuLCBpKTsKICAgICAgICB9CiAgICB9CgogICAgLy8vIEBkZXYgQnV5cyBlcXVhbCBudW1iZXIgb2YgdG9rZW5zIG9mIGFsbCBvdXRjb21lcywgZXhjaGFuZ2luZyBjb2xsYXRlcmFsIHRva2VucyBhbmQgc2V0cyBvZiBvdXRjb21lIHRva2VucyAxOjEKICAgIC8vLyBAcGFyYW0gY29sbGF0ZXJhbFRva2VuQ291bnQgTnVtYmVyIG9mIGNvbGxhdGVyYWwgdG9rZW5zCiAgICBmdW5jdGlvbiBidXlBbGxPdXRjb21lcyh1aW50IGNvbGxhdGVyYWxUb2tlbkNvdW50KQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIC8vIFRyYW5zZmVyIGNvbGxhdGVyYWwgdG9rZW5zIHRvIGV2ZW50cyBjb250cmFjdAogICAgICAgIHJlcXVpcmUoY29sbGF0ZXJhbFRva2VuLnRyYW5zZmVyRnJvbShtc2cuc2VuZGVyLCB0aGlzLCBjb2xsYXRlcmFsVG9rZW5Db3VudCkpOwogICAgICAgIC8vIElzc3VlIG5ldyBvdXRjb21lIHRva2VucyB0byBzZW5kZXIKICAgICAgICBmb3IgKHVpbnQ4IGkgPSAwOyBpIDwgb3V0Y29tZVRva2Vucy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgb3V0Y29tZVRva2Vuc1tpXS5pc3N1ZShtc2cuc2VuZGVyLCBjb2xsYXRlcmFsVG9rZW5Db3VudCk7CiAgICAgICAgT3V0Y29tZVRva2VuU2V0SXNzdWFuY2UobXNnLnNlbmRlciwgY29sbGF0ZXJhbFRva2VuQ291bnQpOwogICAgfQoKICAgIC8vLyBAZGV2IFNlbGxzIGVxdWFsIG51bWJlciBvZiB0b2tlbnMgb2YgYWxsIG91dGNvbWVzLCBleGNoYW5naW5nIGNvbGxhdGVyYWwgdG9rZW5zIGFuZCBzZXRzIG9mIG91dGNvbWUgdG9rZW5zIDE6MQogICAgLy8vIEBwYXJhbSBvdXRjb21lVG9rZW5Db3VudCBOdW1iZXIgb2Ygb3V0Y29tZSB0b2tlbnMKICAgIGZ1bmN0aW9uIHNlbGxBbGxPdXRjb21lcyh1aW50IG91dGNvbWVUb2tlbkNvdW50KQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIC8vIFJldm9rZSBzZW5kZXIncyBvdXRjb21lIHRva2VucyBvZiBhbGwgb3V0Y29tZXMKICAgICAgICBmb3IgKHVpbnQ4IGkgPSAwOyBpIDwgb3V0Y29tZVRva2Vucy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgb3V0Y29tZVRva2Vuc1tpXS5yZXZva2UobXNnLnNlbmRlciwgb3V0Y29tZVRva2VuQ291bnQpOwogICAgICAgIC8vIFRyYW5zZmVyIGNvbGxhdGVyYWwgdG9rZW5zIHRvIHNlbmRlcgogICAgICAgIHJlcXVpcmUoY29sbGF0ZXJhbFRva2VuLnRyYW5zZmVyKG1zZy5zZW5kZXIsIG91dGNvbWVUb2tlbkNvdW50KSk7CiAgICAgICAgT3V0Y29tZVRva2VuU2V0UmV2b2NhdGlvbihtc2cuc2VuZGVyLCBvdXRjb21lVG9rZW5Db3VudCk7CiAgICB9CgogICAgLy8vIEBkZXYgU2V0cyB3aW5uaW5nIGV2ZW50IG91dGNvbWUKICAgIGZ1bmN0aW9uIHNldE91dGNvbWUoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIC8vIFdpbm5pbmcgb3V0Y29tZSBpcyBub3Qgc2V0IHlldCBpbiBldmVudCBjb250cmFjdCBidXQgaW4gb3JhY2xlIGNvbnRyYWN0CiAgICAgICAgcmVxdWlyZSghaXNPdXRjb21lU2V0ICYmIG9yYWNsZS5pc091dGNvbWVTZXQoKSk7CiAgICAgICAgLy8gU2V0IHdpbm5pbmcgb3V0Y29tZQogICAgICAgIG91dGNvbWUgPSBvcmFjbGUuZ2V0T3V0Y29tZSgpOwogICAgICAgIGlzT3V0Y29tZVNldCA9IHRydWU7CiAgICAgICAgT3V0Y29tZUFzc2lnbm1lbnQob3V0Y29tZSk7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyBvdXRjb21lIGNvdW50CiAgICAvLy8gQHJldHVybiBPdXRjb21lIGNvdW50CiAgICBmdW5jdGlvbiBnZXRPdXRjb21lQ291bnQoKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludDgpCiAgICB7CiAgICAgICAgcmV0dXJuIHVpbnQ4KG91dGNvbWVUb2tlbnMubGVuZ3RoKTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIG91dGNvbWUgdG9rZW5zIGFycmF5CiAgICAvLy8gQHJldHVybiBPdXRjb21lIHRva2VucwogICAgZnVuY3Rpb24gZ2V0T3V0Y29tZVRva2VucygpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChPdXRjb21lVG9rZW5bXSkKICAgIHsKICAgICAgICByZXR1cm4gb3V0Y29tZVRva2VuczsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIHRoZSBhbW91bnQgb2Ygb3V0Y29tZSB0b2tlbnMgaGVsZCBieSBvd25lcgogICAgLy8vIEByZXR1cm4gT3V0Y29tZSB0b2tlbiBkaXN0cmlidXRpb24KICAgIGZ1bmN0aW9uIGdldE91dGNvbWVUb2tlbkRpc3RyaWJ1dGlvbihhZGRyZXNzIG93bmVyKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludFtdIG91dGNvbWVUb2tlbkRpc3RyaWJ1dGlvbikKICAgIHsKICAgICAgICBvdXRjb21lVG9rZW5EaXN0cmlidXRpb24gPSBuZXcgdWludFtdKG91dGNvbWVUb2tlbnMubGVuZ3RoKTsKICAgICAgICBmb3IgKHVpbnQ4IGkgPSAwOyBpIDwgb3V0Y29tZVRva2VuRGlzdHJpYnV0aW9uLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBvdXRjb21lVG9rZW5EaXN0cmlidXRpb25baV0gPSBvdXRjb21lVG9rZW5zW2ldLmJhbGFuY2VPZihvd25lcik7CiAgICB9CgogICAgLy8vIEBkZXYgQ2FsY3VsYXRlcyBhbmQgcmV0dXJucyBldmVudCBoYXNoCiAgICAvLy8gQHJldHVybiBFdmVudCBoYXNoCiAgICBmdW5jdGlvbiBnZXRFdmVudEhhc2goKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYnl0ZXMzMik7CgogICAgLy8vIEBkZXYgRXhjaGFuZ2VzIHNlbmRlcidzIHdpbm5pbmcgb3V0Y29tZSB0b2tlbnMgZm9yIGNvbGxhdGVyYWwgdG9rZW5zCiAgICAvLy8gQHJldHVybiBTZW5kZXIncyB3aW5uaW5ncwogICAgZnVuY3Rpb24gcmVkZWVtV2lubmluZ3MoKSBwdWJsaWMgcmV0dXJucyAodWludCk7Cn0KCgoKLy8vIEB0aXRsZSBDYXRlZ29yaWNhbCBldmVudCBjb250cmFjdCAtIENhdGVnb3JpY2FsIGV2ZW50cyByZXNvbHZlIHRvIGFuIG91dGNvbWUgZnJvbSBhIHNldCBvZiBvdXRjb21lcwovLy8gQGF1dGhvciBTdGVmYW4gR2VvcmdlIC0gPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iNGEzOTNlMmYyYzJiMjQwYTJkMjQyNTM5MjMzOTY0M2EyNyI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+CmNvbnRyYWN0IENhdGVnb3JpY2FsRXZlbnQgaXMgRXZlbnQgewoKICAgIC8qCiAgICAgKiAgUHVibGljIGZ1bmN0aW9ucwogICAgICovCiAgICAvLy8gQGRldiBDb250cmFjdCBjb25zdHJ1Y3RvciB2YWxpZGF0ZXMgYW5kIHNldHMgYmFzaWMgZXZlbnQgcHJvcGVydGllcwogICAgLy8vIEBwYXJhbSBfY29sbGF0ZXJhbFRva2VuIFRva2VucyB1c2VkIGFzIGNvbGxhdGVyYWwgaW4gZXhjaGFuZ2UgZm9yIG91dGNvbWUgdG9rZW5zCiAgICAvLy8gQHBhcmFtIF9vcmFjbGUgT3JhY2xlIGNvbnRyYWN0IHVzZWQgdG8gcmVzb2x2ZSB0aGUgZXZlbnQKICAgIC8vLyBAcGFyYW0gb3V0Y29tZUNvdW50IE51bWJlciBvZiBldmVudCBvdXRjb21lcwogICAgZnVuY3Rpb24gQ2F0ZWdvcmljYWxFdmVudCgKICAgICAgICBUb2tlbiBfY29sbGF0ZXJhbFRva2VuLAogICAgICAgIE9yYWNsZSBfb3JhY2xlLAogICAgICAgIHVpbnQ4IG91dGNvbWVDb3VudAogICAgKQogICAgICAgIHB1YmxpYwogICAgICAgIEV2ZW50KF9jb2xsYXRlcmFsVG9rZW4sIF9vcmFjbGUsIG91dGNvbWVDb3VudCkKICAgIHsKCiAgICB9CgogICAgLy8vIEBkZXYgRXhjaGFuZ2VzIHNlbmRlcidzIHdpbm5pbmcgb3V0Y29tZSB0b2tlbnMgZm9yIGNvbGxhdGVyYWwgdG9rZW5zCiAgICAvLy8gQHJldHVybiBTZW5kZXIncyB3aW5uaW5ncwogICAgZnVuY3Rpb24gcmVkZWVtV2lubmluZ3MoKQogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnMgKHVpbnQgd2lubmluZ3MpCiAgICB7CiAgICAgICAgLy8gV2lubmluZyBvdXRjb21lIGhhcyB0byBiZSBzZXQKICAgICAgICByZXF1aXJlKGlzT3V0Y29tZVNldCk7CiAgICAgICAgLy8gQ2FsY3VsYXRlIHdpbm5pbmdzCiAgICAgICAgd2lubmluZ3MgPSBvdXRjb21lVG9rZW5zW3VpbnQob3V0Y29tZSldLmJhbGFuY2VPZihtc2cuc2VuZGVyKTsKICAgICAgICAvLyBSZXZva2UgdG9rZW5zIGZyb20gd2lubmluZyBvdXRjb21lCiAgICAgICAgb3V0Y29tZVRva2Vuc1t1aW50KG91dGNvbWUpXS5yZXZva2UobXNnLnNlbmRlciwgd2lubmluZ3MpOwogICAgICAgIC8vIFBheW91dCB3aW5uaW5ncwogICAgICAgIHJlcXVpcmUoY29sbGF0ZXJhbFRva2VuLnRyYW5zZmVyKG1zZy5zZW5kZXIsIHdpbm5pbmdzKSk7CiAgICAgICAgV2lubmluZ3NSZWRlbXB0aW9uKG1zZy5zZW5kZXIsIHdpbm5pbmdzKTsKICAgIH0KCiAgICAvLy8gQGRldiBDYWxjdWxhdGVzIGFuZCByZXR1cm5zIGV2ZW50IGhhc2gKICAgIC8vLyBAcmV0dXJuIEV2ZW50IGhhc2gKICAgIGZ1bmN0aW9uIGdldEV2ZW50SGFzaCgpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChieXRlczMyKQogICAgewogICAgICAgIHJldHVybiBrZWNjYWsyNTYoY29sbGF0ZXJhbFRva2VuLCBvcmFjbGUsIG91dGNvbWVUb2tlbnMubGVuZ3RoKTsKICAgIH0KfQoKCgovLy8gQHRpdGxlIFNjYWxhciBldmVudCBjb250cmFjdCAtIFNjYWxhciBldmVudHMgcmVzb2x2ZSB0byBhIG51bWJlciB3aXRoaW4gYSByYW5nZQovLy8gQGF1dGhvciBTdGVmYW4gR2VvcmdlIC0gPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iY2FiOWJlYWZhY2FiYTQ4YWFkYTRhNWI5YTNiOWU0YmFhNyI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+CmNvbnRyYWN0IFNjYWxhckV2ZW50IGlzIEV2ZW50IHsKICAgIHVzaW5nIE1hdGggZm9yICo7CgogICAgLyoKICAgICAqICBDb25zdGFudHMKICAgICAqLwogICAgdWludDggcHVibGljIGNvbnN0YW50IFNIT1JUID0gMDsKICAgIHVpbnQ4IHB1YmxpYyBjb25zdGFudCBMT05HID0gMTsKICAgIHVpbnQyNCBwdWJsaWMgY29uc3RhbnQgT1VUQ09NRV9SQU5HRSA9IDEwMDAwMDA7CgogICAgLyoKICAgICAqICBTdG9yYWdlCiAgICAgKi8KICAgIGludCBwdWJsaWMgbG93ZXJCb3VuZDsKICAgIGludCBwdWJsaWMgdXBwZXJCb3VuZDsKCiAgICAvKgogICAgICogIFB1YmxpYyBmdW5jdGlvbnMKICAgICAqLwogICAgLy8vIEBkZXYgQ29udHJhY3QgY29uc3RydWN0b3IgdmFsaWRhdGVzIGFuZCBzZXRzIGJhc2ljIGV2ZW50IHByb3BlcnRpZXMKICAgIC8vLyBAcGFyYW0gX2NvbGxhdGVyYWxUb2tlbiBUb2tlbnMgdXNlZCBhcyBjb2xsYXRlcmFsIGluIGV4Y2hhbmdlIGZvciBvdXRjb21lIHRva2VucwogICAgLy8vIEBwYXJhbSBfb3JhY2xlIE9yYWNsZSBjb250cmFjdCB1c2VkIHRvIHJlc29sdmUgdGhlIGV2ZW50CiAgICAvLy8gQHBhcmFtIF9sb3dlckJvdW5kIExvd2VyIGJvdW5kIGZvciBldmVudCBvdXRjb21lCiAgICAvLy8gQHBhcmFtIF91cHBlckJvdW5kIExvd2VyIGJvdW5kIGZvciBldmVudCBvdXRjb21lCiAgICBmdW5jdGlvbiBTY2FsYXJFdmVudCgKICAgICAgICBUb2tlbiBfY29sbGF0ZXJhbFRva2VuLAogICAgICAgIE9yYWNsZSBfb3JhY2xlLAogICAgICAgIGludCBfbG93ZXJCb3VuZCwKICAgICAgICBpbnQgX3VwcGVyQm91bmQKICAgICkKICAgICAgICBwdWJsaWMKICAgICAgICBFdmVudChfY29sbGF0ZXJhbFRva2VuLCBfb3JhY2xlLCAyKQogICAgewogICAgICAgIC8vIFZhbGlkYXRlIGJvdW5kcwogICAgICAgIHJlcXVpcmUoX3VwcGVyQm91bmQgPiBfbG93ZXJCb3VuZCk7CiAgICAgICAgbG93ZXJCb3VuZCA9IF9sb3dlckJvdW5kOwogICAgICAgIHVwcGVyQm91bmQgPSBfdXBwZXJCb3VuZDsKICAgIH0KCiAgICAvLy8gQGRldiBFeGNoYW5nZXMgc2VuZGVyJ3Mgd2lubmluZyBvdXRjb21lIHRva2VucyBmb3IgY29sbGF0ZXJhbCB0b2tlbnMKICAgIC8vLyBAcmV0dXJuIFNlbmRlcidzIHdpbm5pbmdzCiAgICBmdW5jdGlvbiByZWRlZW1XaW5uaW5ncygpCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyAodWludCB3aW5uaW5ncykKICAgIHsKICAgICAgICAvLyBXaW5uaW5nIG91dGNvbWUgaGFzIHRvIGJlIHNldAogICAgICAgIHJlcXVpcmUoaXNPdXRjb21lU2V0KTsKICAgICAgICAvLyBDYWxjdWxhdGUgd2lubmluZ3MKICAgICAgICB1aW50MjQgY29udmVydGVkV2lubmluZ091dGNvbWU7CiAgICAgICAgLy8gT3V0Y29tZSBpcyBsb3dlciB0aGFuIGRlZmluZWQgbG93ZXIgYm91bmQKICAgICAgICBpZiAob3V0Y29tZSA8IGxvd2VyQm91bmQpCiAgICAgICAgICAgIGNvbnZlcnRlZFdpbm5pbmdPdXRjb21lID0gMDsKICAgICAgICAvLyBPdXRjb21lIGlzIGhpZ2hlciB0aGFuIGRlZmluZWQgdXBwZXIgYm91bmQKICAgICAgICBlbHNlIGlmIChvdXRjb21lID4gdXBwZXJCb3VuZCkKICAgICAgICAgICAgY29udmVydGVkV2lubmluZ091dGNvbWUgPSBPVVRDT01FX1JBTkdFOwogICAgICAgIC8vIE1hcCBvdXRjb21lIHRvIG91dGNvbWUgcmFuZ2UKICAgICAgICBlbHNlCiAgICAgICAgICAgIGNvbnZlcnRlZFdpbm5pbmdPdXRjb21lID0gdWludDI0KE9VVENPTUVfUkFOR0UgKiAob3V0Y29tZSAtIGxvd2VyQm91bmQpIC8gKHVwcGVyQm91bmQgLSBsb3dlckJvdW5kKSk7CiAgICAgICAgdWludCBmYWN0b3JTaG9ydCA9IE9VVENPTUVfUkFOR0UgLSBjb252ZXJ0ZWRXaW5uaW5nT3V0Y29tZTsKICAgICAgICB1aW50IGZhY3RvckxvbmcgPSBPVVRDT01FX1JBTkdFIC0gZmFjdG9yU2hvcnQ7CiAgICAgICAgdWludCBzaG9ydE91dGNvbWVUb2tlbkNvdW50ID0gb3V0Y29tZVRva2Vuc1tTSE9SVF0uYmFsYW5jZU9mKG1zZy5zZW5kZXIpOwogICAgICAgIHVpbnQgbG9uZ091dGNvbWVUb2tlbkNvdW50ID0gb3V0Y29tZVRva2Vuc1tMT05HXS5iYWxhbmNlT2YobXNnLnNlbmRlcik7CiAgICAgICAgd2lubmluZ3MgPSBzaG9ydE91dGNvbWVUb2tlbkNvdW50Lm11bChmYWN0b3JTaG9ydCkuYWRkKGxvbmdPdXRjb21lVG9rZW5Db3VudC5tdWwoZmFjdG9yTG9uZykpIC8gT1VUQ09NRV9SQU5HRTsKICAgICAgICAvLyBSZXZva2UgYWxsIG91dGNvbWUgdG9rZW5zCiAgICAgICAgb3V0Y29tZVRva2Vuc1tTSE9SVF0ucmV2b2tlKG1zZy5zZW5kZXIsIHNob3J0T3V0Y29tZVRva2VuQ291bnQpOwogICAgICAgIG91dGNvbWVUb2tlbnNbTE9OR10ucmV2b2tlKG1zZy5zZW5kZXIsIGxvbmdPdXRjb21lVG9rZW5Db3VudCk7CiAgICAgICAgLy8gUGF5b3V0IHdpbm5pbmdzIHRvIHNlbmRlcgogICAgICAgIHJlcXVpcmUoY29sbGF0ZXJhbFRva2VuLnRyYW5zZmVyKG1zZy5zZW5kZXIsIHdpbm5pbmdzKSk7CiAgICAgICAgV2lubmluZ3NSZWRlbXB0aW9uKG1zZy5zZW5kZXIsIHdpbm5pbmdzKTsKICAgIH0KCiAgICAvLy8gQGRldiBDYWxjdWxhdGVzIGFuZCByZXR1cm5zIGV2ZW50IGhhc2gKICAgIC8vLyBAcmV0dXJuIEV2ZW50IGhhc2gKICAgIGZ1bmN0aW9uIGdldEV2ZW50SGFzaCgpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChieXRlczMyKQogICAgewogICAgICAgIHJldHVybiBrZWNjYWsyNTYoY29sbGF0ZXJhbFRva2VuLCBvcmFjbGUsIGxvd2VyQm91bmQsIHVwcGVyQm91bmQpOwogICAgfQp9CgoKCi8vLyBAdGl0bGUgRXZlbnQgZmFjdG9yeSBjb250cmFjdCAtIEFsbG93cyBjcmVhdGlvbiBvZiBjYXRlZ29yaWNhbCBhbmQgc2NhbGFyIGV2ZW50cwovLy8gQGF1dGhvciBTdGVmYW4gR2VvcmdlIC0gPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iZmY4YzhiOWE5OTllOTFiZjk4OTE5MDhjOTY4Y2QxOGY5MiI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+CmNvbnRyYWN0IEV2ZW50RmFjdG9yeSB7CgogICAgLyoKICAgICAqICBFdmVudHMKICAgICAqLwogICAgZXZlbnQgQ2F0ZWdvcmljYWxFdmVudENyZWF0aW9uKGFkZHJlc3MgaW5kZXhlZCBjcmVhdG9yLCBDYXRlZ29yaWNhbEV2ZW50IGNhdGVnb3JpY2FsRXZlbnQsIFRva2VuIGNvbGxhdGVyYWxUb2tlbiwgT3JhY2xlIG9yYWNsZSwgdWludDggb3V0Y29tZUNvdW50KTsKICAgIGV2ZW50IFNjYWxhckV2ZW50Q3JlYXRpb24oYWRkcmVzcyBpbmRleGVkIGNyZWF0b3IsIFNjYWxhckV2ZW50IHNjYWxhckV2ZW50LCBUb2tlbiBjb2xsYXRlcmFsVG9rZW4sIE9yYWNsZSBvcmFjbGUsIGludCBsb3dlckJvdW5kLCBpbnQgdXBwZXJCb3VuZCk7CgogICAgLyoKICAgICAqICBTdG9yYWdlCiAgICAgKi8KICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gQ2F0ZWdvcmljYWxFdmVudCkgcHVibGljIGNhdGVnb3JpY2FsRXZlbnRzOwogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiBTY2FsYXJFdmVudCkgcHVibGljIHNjYWxhckV2ZW50czsKCiAgICAvKgogICAgICogIFB1YmxpYyBmdW5jdGlvbnMKICAgICAqLwogICAgLy8vIEBkZXYgQ3JlYXRlcyBhIG5ldyBjYXRlZ29yaWNhbCBldmVudCBhbmQgYWRkcyBpdCB0byB0aGUgZXZlbnQgbWFwcGluZwogICAgLy8vIEBwYXJhbSBjb2xsYXRlcmFsVG9rZW4gVG9rZW5zIHVzZWQgYXMgY29sbGF0ZXJhbCBpbiBleGNoYW5nZSBmb3Igb3V0Y29tZSB0b2tlbnMKICAgIC8vLyBAcGFyYW0gb3JhY2xlIE9yYWNsZSBjb250cmFjdCB1c2VkIHRvIHJlc29sdmUgdGhlIGV2ZW50CiAgICAvLy8gQHBhcmFtIG91dGNvbWVDb3VudCBOdW1iZXIgb2YgZXZlbnQgb3V0Y29tZXMKICAgIC8vLyBAcmV0dXJuIEV2ZW50IGNvbnRyYWN0CiAgICBmdW5jdGlvbiBjcmVhdGVDYXRlZ29yaWNhbEV2ZW50KAogICAgICAgIFRva2VuIGNvbGxhdGVyYWxUb2tlbiwKICAgICAgICBPcmFjbGUgb3JhY2xlLAogICAgICAgIHVpbnQ4IG91dGNvbWVDb3VudAogICAgKQogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnMgKENhdGVnb3JpY2FsRXZlbnQgZXZlbnRDb250cmFjdCkKICAgIHsKICAgICAgICBieXRlczMyIGV2ZW50SGFzaCA9IGtlY2NhazI1Nihjb2xsYXRlcmFsVG9rZW4sIG9yYWNsZSwgb3V0Y29tZUNvdW50KTsKICAgICAgICAvLyBFdmVudCBzaG91bGQgbm90IGV4aXN0IHlldAogICAgICAgIHJlcXVpcmUoYWRkcmVzcyhjYXRlZ29yaWNhbEV2ZW50c1tldmVudEhhc2hdKSA9PSAwKTsKICAgICAgICAvLyBDcmVhdGUgZXZlbnQKICAgICAgICBldmVudENvbnRyYWN0ID0gbmV3IENhdGVnb3JpY2FsRXZlbnQoCiAgICAgICAgICAgIGNvbGxhdGVyYWxUb2tlbiwKICAgICAgICAgICAgb3JhY2xlLAogICAgICAgICAgICBvdXRjb21lQ291bnQKICAgICAgICApOwogICAgICAgIGNhdGVnb3JpY2FsRXZlbnRzW2V2ZW50SGFzaF0gPSBldmVudENvbnRyYWN0OwogICAgICAgIENhdGVnb3JpY2FsRXZlbnRDcmVhdGlvbihtc2cuc2VuZGVyLCBldmVudENvbnRyYWN0LCBjb2xsYXRlcmFsVG9rZW4sIG9yYWNsZSwgb3V0Y29tZUNvdW50KTsKICAgIH0KCiAgICAvLy8gQGRldiBDcmVhdGVzIGEgbmV3IHNjYWxhciBldmVudCBhbmQgYWRkcyBpdCB0byB0aGUgZXZlbnQgbWFwcGluZwogICAgLy8vIEBwYXJhbSBjb2xsYXRlcmFsVG9rZW4gVG9rZW5zIHVzZWQgYXMgY29sbGF0ZXJhbCBpbiBleGNoYW5nZSBmb3Igb3V0Y29tZSB0b2tlbnMKICAgIC8vLyBAcGFyYW0gb3JhY2xlIE9yYWNsZSBjb250cmFjdCB1c2VkIHRvIHJlc29sdmUgdGhlIGV2ZW50CiAgICAvLy8gQHBhcmFtIGxvd2VyQm91bmQgTG93ZXIgYm91bmQgZm9yIGV2ZW50IG91dGNvbWUKICAgIC8vLyBAcGFyYW0gdXBwZXJCb3VuZCBMb3dlciBib3VuZCBmb3IgZXZlbnQgb3V0Y29tZQogICAgLy8vIEByZXR1cm4gRXZlbnQgY29udHJhY3QKICAgIGZ1bmN0aW9uIGNyZWF0ZVNjYWxhckV2ZW50KAogICAgICAgIFRva2VuIGNvbGxhdGVyYWxUb2tlbiwKICAgICAgICBPcmFjbGUgb3JhY2xlLAogICAgICAgIGludCBsb3dlckJvdW5kLAogICAgICAgIGludCB1cHBlckJvdW5kCiAgICApCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyAoU2NhbGFyRXZlbnQgZXZlbnRDb250cmFjdCkKICAgIHsKICAgICAgICBieXRlczMyIGV2ZW50SGFzaCA9IGtlY2NhazI1Nihjb2xsYXRlcmFsVG9rZW4sIG9yYWNsZSwgbG93ZXJCb3VuZCwgdXBwZXJCb3VuZCk7CiAgICAgICAgLy8gRXZlbnQgc2hvdWxkIG5vdCBleGlzdCB5ZXQKICAgICAgICByZXF1aXJlKGFkZHJlc3Moc2NhbGFyRXZlbnRzW2V2ZW50SGFzaF0pID09IDApOwogICAgICAgIC8vIENyZWF0ZSBldmVudAogICAgICAgIGV2ZW50Q29udHJhY3QgPSBuZXcgU2NhbGFyRXZlbnQoCiAgICAgICAgICAgIGNvbGxhdGVyYWxUb2tlbiwKICAgICAgICAgICAgb3JhY2xlLAogICAgICAgICAgICBsb3dlckJvdW5kLAogICAgICAgICAgICB1cHBlckJvdW5kCiAgICAgICAgKTsKICAgICAgICBzY2FsYXJFdmVudHNbZXZlbnRIYXNoXSA9IGV2ZW50Q29udHJhY3Q7CiAgICAgICAgU2NhbGFyRXZlbnRDcmVhdGlvbihtc2cuc2VuZGVyLCBldmVudENvbnRyYWN0LCBjb2xsYXRlcmFsVG9rZW4sIG9yYWNsZSwgbG93ZXJCb3VuZCwgdXBwZXJCb3VuZCk7CiAgICB9Cn0='.
	

]
