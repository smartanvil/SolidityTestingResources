Class {
	#name : #SRT48fc077618662a07e15815fb7afbfbf2a7ee560a,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT48fc077618662a07e15815fb7afbfbf2a7ee560a >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IDAuNC4yMTsKCmxpYnJhcnkgU2FmZU1hdGggewoKICAgIC8qKgogICAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAgICovCiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGlmIChhID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAgICovCiAgICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgU3VidHJhY3RzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cgKGkuZS4gaWYgc3VidHJhaGVuZCBpcyBncmVhdGVyIHRoYW4gbWludWVuZCkuCiAgICAqLwogICAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoYiA8PSBhKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgQWRkcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICAgKi8KICAgIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSk7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9Cn0KCmNvbnRyYWN0IEVSQzIwIHsKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7CiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKaW50ZXJmYWNlIExhbmRNYW5hZ2VtZW50SW50ZXJmYWNlIHsKICAgIGZ1bmN0aW9uIG93bmVyQWRkcmVzcygpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYWRkcmVzcyk7CiAgICBmdW5jdGlvbiBtYW5hZ2VyQWRkcmVzcygpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYWRkcmVzcyk7CiAgICBmdW5jdGlvbiBjb21tdW5pdHlBZGRyZXNzKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIGRpdmlkZW5kTWFuYWdlckFkZHJlc3MoKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGFkZHJlc3MpOwogICAgZnVuY3Rpb24gd2FsbGV0QWRkcmVzcygpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYWRkcmVzcyk7CiAgICAvLyAgICBmdW5jdGlvbiB1bmljb3JuVG9rZW5BZGRyZXNzKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIGNhbmR5VG9rZW4oKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGFkZHJlc3MpOwogICAgZnVuY3Rpb24gbWVnYUNhbmR5VG9rZW4oKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGFkZHJlc3MpOwogICAgZnVuY3Rpb24gdXNlclJhbmtBZGRyZXNzKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIGNhbmR5TGFuZEFkZHJlc3MoKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGFkZHJlc3MpOwogICAgZnVuY3Rpb24gY2FuZHlMYW5kU2FsZUFkZHJlc3MoKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGFkZHJlc3MpOwoKICAgIGZ1bmN0aW9uIGlzVW5pY29ybkNvbnRyYWN0KGFkZHJlc3MgX3VuaWNvcm5Db250cmFjdEFkZHJlc3MpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCk7CgogICAgZnVuY3Rpb24gcGF1c2VkKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIHByZXNhbGVPcGVuKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGZpcnN0UmFua0ZvckZyZWUoKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpOwoKICAgIGZ1bmN0aW9uIGV0aExhbmRTYWxlT3BlbigpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCk7CgogICAgZnVuY3Rpb24gbGFuZFByaWNlV2VpKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50KTsKICAgIGZ1bmN0aW9uIGxhbmRQcmljZUNhbmR5KCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50KTsKCiAgICBmdW5jdGlvbiByZWdpc3RlckluaXQoYWRkcmVzcyBfY29udHJhY3QpIGV4dGVybmFsOwp9CgppbnRlcmZhY2UgVXNlclJhbmtJbnRlcmZhY2UgIHsKICAgIGZ1bmN0aW9uIGJ1eU5leHRSYW5rKCkgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBidXlSYW5rKHVpbnQgX2luZGV4KSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIGdldEluZGl2aWR1YWxQcmljZShhZGRyZXNzIF91c2VyLCB1aW50IF9pbmRleCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50KTsKICAgIGZ1bmN0aW9uIGdldFJhbmtQcmljZUV0aCh1aW50IF9pbmRleCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50KTsKICAgIGZ1bmN0aW9uIGdldFJhbmtQcmljZUNhbmR5KHVpbnQgX2luZGV4KSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQpOwogICAgZnVuY3Rpb24gZ2V0UmFua0xhbmRMaW1pdCh1aW50IF9pbmRleCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50KTsKICAgIGZ1bmN0aW9uIGdldFJhbmtUaXRsZSh1aW50IF9pbmRleCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChzdHJpbmcpOwogICAgZnVuY3Rpb24gZ2V0VXNlclJhbmsoYWRkcmVzcyBfdXNlcikgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50KTsKICAgIGZ1bmN0aW9uIGdldFVzZXJMYW5kTGltaXQoYWRkcmVzcyBfdXNlcikgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50KTsKICAgIGZ1bmN0aW9uIHJhbmtzQ291bnQoKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQpOwogICAgZnVuY3Rpb24gZ2V0TmV4dFJhbmsoYWRkcmVzcyBfdXNlcikgIGV4dGVybmFsIHJldHVybnMgKHVpbnQpOwogICAgZnVuY3Rpb24gZ2V0UHJlU2FsZVJhbmsoYWRkcmVzcyBvd25lciwgdWludCBfaW5kZXgpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gZ2V0UmFuayhhZGRyZXNzIG93bmVyLCB1aW50IF9pbmRleCkgZXh0ZXJuYWw7Cn0KCmNvbnRyYWN0IE1lZ2FDYW5keUludGVyZmFjZSBpcyBFUkMyMCB7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb21TeXN0ZW0oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBidXJuKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyByZXR1cm5zIChib29sKTsKfQoKCmNvbnRyYWN0IExhbmRBY2Nlc3NDb250cm9sIHsKCiAgICBMYW5kTWFuYWdlbWVudEludGVyZmFjZSBwdWJsaWMgbGFuZE1hbmFnZW1lbnQ7CgogICAgZnVuY3Rpb24gTGFuZEFjY2Vzc0NvbnRyb2woYWRkcmVzcyBfbGFuZE1hbmFnZW1lbnRBZGRyZXNzKSBwdWJsaWMgewogICAgICAgIGxhbmRNYW5hZ2VtZW50ID0gTGFuZE1hbmFnZW1lbnRJbnRlcmZhY2UoX2xhbmRNYW5hZ2VtZW50QWRkcmVzcyk7CiAgICAgICAgbGFuZE1hbmFnZW1lbnQucmVnaXN0ZXJJbml0KHRoaXMpOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gbGFuZE1hbmFnZW1lbnQub3duZXJBZGRyZXNzKCkpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seU1hbmFnZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGxhbmRNYW5hZ2VtZW50Lm1hbmFnZXJBZGRyZXNzKCkpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seUNvbW11bml0eSgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gbGFuZE1hbmFnZW1lbnQuY29tbXVuaXR5QWRkcmVzcygpKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICAgICAgcmVxdWlyZSghbGFuZE1hbmFnZW1lbnQucGF1c2VkKCkpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgd2hlblBhdXNlZCB7CiAgICAgICAgcmVxdWlyZShsYW5kTWFuYWdlbWVudC5wYXVzZWQoKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5V2hpbGVFdGhTYWxlT3BlbiB7CiAgICAgICAgcmVxdWlyZShsYW5kTWFuYWdlbWVudC5ldGhMYW5kU2FsZU9wZW4oKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5TGFuZE1hbmFnZW1lbnQoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkZHJlc3MobGFuZE1hbmFnZW1lbnQpKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlVbmljb3JuQ29udHJhY3QoKSB7CiAgICAgICAgcmVxdWlyZShsYW5kTWFuYWdlbWVudC5pc1VuaWNvcm5Db250cmFjdChtc2cuc2VuZGVyKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5Q2FuZHlMYW5kKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBhZGRyZXNzKGxhbmRNYW5hZ2VtZW50LmNhbmR5TGFuZEFkZHJlc3MoKSkpOwogICAgICAgIF87CiAgICB9CgoKICAgIG1vZGlmaWVyIHdoaWxlUHJlc2FsZU9wZW4oKSB7CiAgICAgICAgcmVxdWlyZShsYW5kTWFuYWdlbWVudC5wcmVzYWxlT3BlbigpKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzR2FtZVBhdXNlZCgpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBsYW5kTWFuYWdlbWVudC5wYXVzZWQoKTsKICAgIH0KfQoKCmNvbnRyYWN0IENhblJlY2VpdmVBcHByb3ZhbCB7CiAgICBldmVudCBSZWNlaXZlQXBwcm92YWwoYWRkcmVzcyBmcm9tLCB1aW50MjU2IHZhbHVlLCBhZGRyZXNzIHRva2VuKTsKCiAgICBtYXBwaW5nIChieXRlczQgPT4gYm9vbCkgYWxsb3dlZEZ1bmNzOwoKICAgIG1vZGlmaWVyIG9ubHlQYXlsb2FkU2l6ZSh1aW50IG51bXdvcmRzKSB7CiAgICAgICAgYXNzZXJ0KG1zZy5kYXRhLmxlbmd0aCA+PSBudW13b3JkcyAqIDMyICsgNCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5U2VsZigpewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBhZGRyZXNzKHRoaXMpKTsKICAgICAgICBfOwogICAgfQoKCiAgICBmdW5jdGlvbiBieXRlc1RvQnl0ZXM0KGJ5dGVzIGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAoYnl0ZXM0IG91dCkgewogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IDQ7IGkrKykgewogICAgICAgICAgICBvdXQgfD0gYnl0ZXM0KGJbaV0gJiAweEZGKSA+PiAoaSA8PCAzKTsKICAgICAgICB9CiAgICB9Cgp9CgoKY29udHJhY3QgQ2FuZHlMYW5kIGlzIEVSQzIwLCBMYW5kQWNjZXNzQ29udHJvbCwgQ2FuUmVjZWl2ZUFwcHJvdmFsIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIFVzZXJSYW5rSW50ZXJmYWNlIHB1YmxpYyB1c2VyUmFuazsKICAgIE1lZ2FDYW5keUludGVyZmFjZSBwdWJsaWMgbWVnYUNhbmR5OwogICAgRVJDMjAgcHVibGljIGNhbmR5VG9rZW47CgogICAgc3RydWN0IEdhcmRlbmVyIHsKICAgICAgICB1aW50IHBlcmlvZDsKICAgICAgICB1aW50IHByaWNlOwogICAgICAgIGJvb2wgZXhpc3RzOwogICAgfQoKICAgIHN0cnVjdCBHYXJkZW4gewogICAgICAgIHVpbnQgY291bnQ7CiAgICAgICAgdWludCBzdGFydFRpbWU7CiAgICAgICAgYWRkcmVzcyBvd25lcjsKICAgICAgICB1aW50IGdhcmRlbmVySWQ7CiAgICAgICAgdWludCBsYXN0Q3JvcFRpbWU7CiAgICAgICAgdWludCBwbGFudGF0aW9uSW5kZXg7CiAgICAgICAgdWludCBvd25lclBsYW50YXRpb25JbmRleDsKICAgIH0KCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiVW5pY29ybiBMYW5kIjsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIkxhbmQiOwogICAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMDsKCiAgICB1aW50MjU2IHRvdGFsU3VwcGx5XzsKICAgIHVpbnQyNTYgcHVibGljIE1BWF9TVVBQTFkgPSAzMDAwMDsKCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBwbGFudGVkVGltZSA9IDEgaG91cnM7CiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBwbGFudGVkUmF0ZSA9IDEgZXRoZXI7CiAgICAvL3VpbnQgcHVibGljIGNvbnN0YW50IHByaWNlUmF0ZSA9IDEgZXRoZXI7CgogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwogICAgbWFwcGluZyhhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgcGxhbnRlZDsKCiAgICBtYXBwaW5nKHVpbnQgPT4gR2FyZGVuZXIpIHB1YmxpYyBnYXJkZW5lcnM7CiAgICAvLyBNYXBwaW5nIGZyb20gZ2FyZGVuIElEIHRvIEdhcmRlIHN0cnVjdAogICAgbWFwcGluZyh1aW50ID0+IEdhcmRlbikgcHVibGljIGdhcmRlbnM7CgogICAgLy8gZ2FyZGVuIGluZGV4ID0+IGdhcmRlbklkCiAgICBtYXBwaW5nKHVpbnQgPT4gdWludCkgcHVibGljIHBsYW50YXRpb247CiAgICB1aW50IHB1YmxpYyBwbGFudGF0aW9uU2l6ZSA9IDA7CgogICAgLy91c2VyIHBsYW50YXRpb25zCiAgICAvLyBvd25lciA9PiBhcnJheSAoaW5kZXggPT4gZ2FyZGVuSWQpCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gbWFwcGluZyh1aW50ID0+IHVpbnQpKSBwdWJsaWMgb3duZXJQbGFudGF0aW9uOwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBvd25lclBsYW50YXRpb25TaXplOwoKCiAgICB1aW50IGdhcmRlbmVySWQgPSAwOwogICAgdWludCBnYXJkZW5JZCA9IDA7CgoKICAgIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGFtb3VudCk7CiAgICBldmVudCBNYWtlUGxhbnQoYWRkcmVzcyBpbmRleGVkIG93bmVyLCB1aW50IGdhcmRlbklkLCB1aW50IGNvdW50LCB1aW50IGdhcmRlbmVySWQpOwogICAgZXZlbnQgR2V0Q3JvcChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIHVpbnQgZ2FyZGVuSWQsIHVpbnQgIG1lZ2FDYW5keUNvdW50KTsKICAgIGV2ZW50IE5ld0dhcmRlbmVyQWRkZWQodWludCBnYXJkZW5lcklkLCB1aW50IF9wZXJpb2QsIHVpbnQgX3ByaWNlKTsKICAgIGV2ZW50IEdhcmRlbmVyQ2hhbmdlKHVpbnQgZ2FyZGVuZXJJZCwgdWludCBfcGVyaW9kLCB1aW50IF9wcmljZSk7CiAgICBldmVudCBOZXdMYW5kTGltaXQodWludCBuZXdMaW1pdCk7CiAgICBldmVudCBUb2tlbnNUcmFuc2ZlcnJlZChhZGRyZXNzIHdhbGxldCwgdWludCB2YWx1ZSk7CgogICAgZnVuY3Rpb24gQ2FuZHlMYW5kKGFkZHJlc3MgX2xhbmRNYW5hZ2VtZW50QWRkcmVzcykgTGFuZEFjY2Vzc0NvbnRyb2woX2xhbmRNYW5hZ2VtZW50QWRkcmVzcykgcHVibGljIHsKICAgICAgICBhbGxvd2VkRnVuY3NbYnl0ZXM0KGtlY2NhazI1NigiX3JlY2VpdmVNYWtlUGxhbnQoYWRkcmVzcyx1aW50MjU2LHVpbnQyNTYpIikpXSA9IHRydWU7CgogICAgICAgIGFkZEdhcmRlbmVyKDI0LCAgIDcwMDAwMDAwMDAwMDAwMDAwMCk7CiAgICAgICAgYWRkR2FyZGVuZXIoMTIwLCAzMDAwMDAwMDAwMDAwMDAwMDAwKTsKICAgICAgICBhZGRHYXJkZW5lcigyNDAsIDUwMDAwMDAwMDAwMDAwMDAwMDApOwogICAgICAgIGFkZEdhcmRlbmVyKDcyMCwxMjAwMDAwMDAwMDAwMDAwMDAwMCk7CiAgICB9CgoKICAgIGZ1bmN0aW9uIGluaXQoKSBvbmx5TGFuZE1hbmFnZW1lbnQgd2hlblBhdXNlZCBleHRlcm5hbCB7CiAgICAgICAgdXNlclJhbmsgPSBVc2VyUmFua0ludGVyZmFjZShsYW5kTWFuYWdlbWVudC51c2VyUmFua0FkZHJlc3MoKSk7CiAgICAgICAgbWVnYUNhbmR5ID0gTWVnYUNhbmR5SW50ZXJmYWNlKGxhbmRNYW5hZ2VtZW50Lm1lZ2FDYW5keVRva2VuKCkpOwogICAgICAgIGNhbmR5VG9rZW4gPSBFUkMyMChsYW5kTWFuYWdlbWVudC5jYW5keVRva2VuKCkpOwogICAgfQoKCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gdG90YWxTdXBwbHlfOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIocGxhbnRlZFttc2cuc2VuZGVyXSkpOwogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKSA8PSB1c2VyUmFuay5nZXRVc2VyTGFuZExpbWl0KF90bykpOwoKICAgICAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgICAgICBlbWl0IFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogICAgfQoKICAgIGZ1bmN0aW9uIHBsYW50ZWRPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIHBsYW50ZWRbX293bmVyXTsKICAgIH0KCiAgICBmdW5jdGlvbiBmcmVlTGFuZHNPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl0uc3ViKHBsYW50ZWRbX293bmVyXSk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1tfZnJvbV0uc3ViKHBsYW50ZWRbX2Zyb21dKSk7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0pOwogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKSA8PSB1c2VyUmFuay5nZXRVc2VyTGFuZExpbWl0KF90bykpOwoKICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICBlbWl0IFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBlbWl0IEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQoKICAgIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICAgICAgZW1pdCBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgICAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgICAgICB9CiAgICAgICAgZW1pdCBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbVN5c3RlbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIG9ubHlVbmljb3JuQ29udHJhY3QgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1tfZnJvbV0uc3ViKHBsYW50ZWRbX2Zyb21dKSk7CiAgICAgICAgLy8gICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKICAgICAgICByZXF1aXJlKGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSkgPD0gdXNlclJhbmsuZ2V0VXNlckxhbmRMaW1pdChfdG8pKTsKCiAgICAgICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIGVtaXQgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIG9ubHlVbmljb3JuQ29udHJhY3QgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKHRvdGFsU3VwcGx5Xy5hZGQoX2Ftb3VudCkgPD0gTUFYX1NVUFBMWSk7CiAgICAgICAgcmVxdWlyZShiYWxhbmNlc1tfdG9dLmFkZChfYW1vdW50KSA8PSB1c2VyUmFuay5nZXRVc2VyTGFuZExpbWl0KF90bykpOwogICAgICAgIHRvdGFsU3VwcGx5XyA9IHRvdGFsU3VwcGx5Xy5hZGQoX2Ftb3VudCk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF9hbW91bnQpOwogICAgICAgIGVtaXQgTWludChfdG8sIF9hbW91bnQpOwogICAgICAgIGVtaXQgVHJhbnNmZXIoYWRkcmVzcygwKSwgX3RvLCBfYW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCgogICAgZnVuY3Rpb24gbWFrZVBsYW50KHVpbnQgX2NvdW50LCB1aW50IF9nYXJkZW5lcklkKSBwdWJsaWMgewogICAgICAgIF9tYWtlUGxhbnQobXNnLnNlbmRlciwgX2NvdW50LCBfZ2FyZGVuZXJJZCk7CiAgICB9CgoKICAgIGZ1bmN0aW9uIF9yZWNlaXZlTWFrZVBsYW50KGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCB1aW50IF9jb3VudCwgdWludCBfZ2FyZGVuZXJJZCkgb25seVNlbGYgb25seVBheWxvYWRTaXplKDMpIHB1YmxpYyB7CiAgICAgICAgX21ha2VQbGFudChfYmVuZWZpY2lhcnksIF9jb3VudCwgX2dhcmRlbmVySWQpOwogICAgfQoKCiAgICBmdW5jdGlvbiBfbWFrZVBsYW50KGFkZHJlc3MgX293bmVyLCB1aW50IF9jb3VudCwgdWludCBfZ2FyZGVuZXJJZCkgaW50ZXJuYWwgewogICAgICAgIHJlcXVpcmUoX2NvdW50IDw9IGJhbGFuY2VzW19vd25lcl0uc3ViKHBsYW50ZWRbX293bmVyXSkgJiYgX2NvdW50ID4gMCk7CgogICAgICAgIC8vcmVxdWlyZShjYW5keVRva2VuLnRyYW5zZmVyRnJvbShtc2cuc2VuZGVyLCB0aGlzLCBfY291bnQubXVsKHByaWNlUmF0ZSkpKTsKCiAgICAgICAgaWYgKF9nYXJkZW5lcklkID4gMCkgewogICAgICAgICAgICByZXF1aXJlKGdhcmRlbmVyc1tfZ2FyZGVuZXJJZF0uZXhpc3RzKTsKICAgICAgICAgICAgcmVxdWlyZShjYW5keVRva2VuLnRyYW5zZmVyRnJvbShfb3duZXIsIHRoaXMsIGdhcmRlbmVyc1tfZ2FyZGVuZXJJZF0ucHJpY2UubXVsKF9jb3VudCkpKTsKICAgICAgICB9CgogICAgICAgIGdhcmRlbnNbKytnYXJkZW5JZF0gPSBHYXJkZW4oewogICAgICAgICAgICBjb3VudDogX2NvdW50LAogICAgICAgICAgICBzdGFydFRpbWU6IG5vdywKICAgICAgICAgICAgb3duZXI6IF9vd25lciwKICAgICAgICAgICAgZ2FyZGVuZXJJZDogX2dhcmRlbmVySWQsCiAgICAgICAgICAgIGxhc3RDcm9wVGltZTogbm93LAogICAgICAgICAgICBwbGFudGF0aW9uSW5kZXg6IHBsYW50YXRpb25TaXplLAogICAgICAgICAgICBvd25lclBsYW50YXRpb25JbmRleDogb3duZXJQbGFudGF0aW9uU2l6ZVtfb3duZXJdCiAgICAgICAgICAgIH0pOwoKICAgICAgICBwbGFudGVkW19vd25lcl0gPSBwbGFudGVkW19vd25lcl0uYWRkKF9jb3VudCk7CiAgICAgICAgLy91cGRhdGUgZ2xvYmFsIHBsYW50YXRpb24gbGlzdAogICAgICAgIHBsYW50YXRpb25bcGxhbnRhdGlvblNpemUrK10gPSBnYXJkZW5JZDsKICAgICAgICAvL3VwZGF0ZSB1c2VyIHBsYW50YXRpb24gbGlzdAogICAgICAgIG93bmVyUGxhbnRhdGlvbltfb3duZXJdW293bmVyUGxhbnRhdGlvblNpemVbX293bmVyXSsrXSA9IGdhcmRlbklkOwoKICAgICAgICBlbWl0IE1ha2VQbGFudChfb3duZXIsIGdhcmRlbklkLCBfY291bnQsIGdhcmRlbmVySWQpOwogICAgfQoKCiAgICBmdW5jdGlvbiBnZXRDcm9wKHVpbnQgX2dhcmRlbklkKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBnYXJkZW5zW19nYXJkZW5JZF0ub3duZXIpOwogICAgICAgIHJlcXVpcmUobm93ID49IGdhcmRlbnNbX2dhcmRlbklkXS5sYXN0Q3JvcFRpbWUuYWRkKHBsYW50ZWRUaW1lKSk7CgogICAgICAgIHVpbnQgY3JvcCA9IDA7CiAgICAgICAgdWludCBjcm9wQ291bnQgPSAxOwogICAgICAgIHVpbnQgcmVtYWluaW5nQ3JvcHMgPSAwOwoKICAgICAgICBpZiAoZ2FyZGVuc1tfZ2FyZGVuSWRdLmdhcmRlbmVySWQgPiAwKSB7CiAgICAgICAgICAgIHVpbnQgZmluaXNoVGltZSA9IGdhcmRlbnNbX2dhcmRlbklkXS5zdGFydFRpbWUuYWRkKGdhcmRlbmVyc1tnYXJkZW5zW19nYXJkZW5JZF0uZ2FyZGVuZXJJZF0ucGVyaW9kKTsKICAgICAgICAgICAgLy/QstGA0LXQvNGPINGC0LXQutGD0YnQtdC5INGB0LHQvtC60Lgg0YPRgNC+0LbQsNGPCiAgICAgICAgICAgIHVpbnQgY3VycmVudENyb3BUaW1lID0gbm93IDwgZmluaXNoVGltZSA/IG5vdyA6IGZpbmlzaFRpbWU7CiAgICAgICAgICAgIC8v0LrQvtC70LjRh9C10YHRgtCy0L4g0YPRgNC+0LbQsNC10LIg0LrQvtGC0L7RgNC+0LUg0YHQvtCx0LXRgNC10Lwg0YHQtdC50YfQsNGBCiAgICAgICAgICAgIGNyb3BDb3VudCA9IGN1cnJlbnRDcm9wVGltZS5zdWIoZ2FyZGVuc1tfZ2FyZGVuSWRdLmxhc3RDcm9wVGltZSkuZGl2KHBsYW50ZWRUaW1lKTsKICAgICAgICAgICAgLy/QstGA0LXQvNGPINC/0L7RgdC70LXQtNC90LXQuSDRgdCx0L7RgNC60Lgg0YPRgNC+0LbQsNGPICsg0LLRgNC10LzRjyAxINGD0YDQvtC20LDRjyDQvdCwINC60L7Qu9C40YfQtdGB0YLQstC+INGD0YDQvtC20LDQtdCyINC60L7RgtC+0YDQvtC1INGB0L7QsdC10YDQtdC8INGB0LXQudGH0LDRgQogICAgICAgICAgICBnYXJkZW5zW19nYXJkZW5JZF0ubGFzdENyb3BUaW1lID0gZ2FyZGVuc1tfZ2FyZGVuSWRdLmxhc3RDcm9wVGltZS5hZGQoY3JvcENvdW50Lm11bChwbGFudGVkVGltZSkpOwogICAgICAgICAgICAvL9C60L7Qu9C40YfQtdGB0YLQstC+INC+0YHRgtCw0LLRiNC40YXRgdGPINGD0YDQvtC20LDQtdCyCiAgICAgICAgICAgIHJlbWFpbmluZ0Nyb3BzID0gZmluaXNoVGltZS5zdWIoZ2FyZGVuc1tfZ2FyZGVuSWRdLmxhc3RDcm9wVGltZSkuZGl2KHBsYW50ZWRUaW1lKTsKICAgICAgICB9CgogICAgICAgIGNyb3AgPSBnYXJkZW5zW19nYXJkZW5JZF0uY291bnQubXVsKHBsYW50ZWRSYXRlKS5tdWwoY3JvcENvdW50KTsKICAgICAgICBpZiAocmVtYWluaW5nQ3JvcHMgPT0gMCkgewogICAgICAgICAgICBwbGFudGVkW21zZy5zZW5kZXJdID0gcGxhbnRlZFttc2cuc2VuZGVyXS5zdWIoZ2FyZGVuc1tfZ2FyZGVuSWRdLmNvdW50KTsKCiAgICAgICAgICAgIC8vZGVsZXRlIGZyb20gZ2xvYmFsIHBsYW50YXRpb24gbGlzdAogICAgICAgICAgICBnYXJkZW5zW3BsYW50YXRpb25bLS1wbGFudGF0aW9uU2l6ZV1dLnBsYW50YXRpb25JbmRleCA9IGdhcmRlbnNbX2dhcmRlbklkXS5wbGFudGF0aW9uSW5kZXg7CiAgICAgICAgICAgIHBsYW50YXRpb25bZ2FyZGVuc1tfZ2FyZGVuSWRdLnBsYW50YXRpb25JbmRleF0gPSBwbGFudGF0aW9uW3BsYW50YXRpb25TaXplXTsKICAgICAgICAgICAgZGVsZXRlIHBsYW50YXRpb25bcGxhbnRhdGlvblNpemVdOwoKICAgICAgICAgICAgLy9kZWxldGUgZnJvbSB1c2VyIHBsYW50YXRpb24gbGlzdAogICAgICAgICAgICBnYXJkZW5zW293bmVyUGxhbnRhdGlvblttc2cuc2VuZGVyXVstLW93bmVyUGxhbnRhdGlvblNpemVbbXNnLnNlbmRlcl1dXS5vd25lclBsYW50YXRpb25JbmRleCA9IGdhcmRlbnNbX2dhcmRlbklkXS5vd25lclBsYW50YXRpb25JbmRleDsKICAgICAgICAgICAgb3duZXJQbGFudGF0aW9uW21zZy5zZW5kZXJdW2dhcmRlbnNbX2dhcmRlbklkXS5vd25lclBsYW50YXRpb25JbmRleF0gPSBvd25lclBsYW50YXRpb25bbXNnLnNlbmRlcl1bb3duZXJQbGFudGF0aW9uU2l6ZVttc2cuc2VuZGVyXV07CiAgICAgICAgICAgIGRlbGV0ZSBvd25lclBsYW50YXRpb25bbXNnLnNlbmRlcl1bb3duZXJQbGFudGF0aW9uU2l6ZVttc2cuc2VuZGVyXV07CgogICAgICAgICAgICBkZWxldGUgZ2FyZGVuc1tfZ2FyZGVuSWRdOwoKICAgICAgICB9CgogICAgICAgIG1lZ2FDYW5keS5taW50KG1zZy5zZW5kZXIsIGNyb3ApOwogICAgICAgIGVtaXQgR2V0Q3JvcChtc2cuc2VuZGVyLCBfZ2FyZGVuSWQsIGNyb3ApOwogICAgfQoKCiAgICBmdW5jdGlvbiBhZGRHYXJkZW5lcih1aW50IF9wZXJpb2QsIHVpbnQgX3ByaWNlKSBvbmx5T3duZXIgcHVibGljICB7CiAgICAgICAgZ2FyZGVuZXJzWysrZ2FyZGVuZXJJZF0gPSBHYXJkZW5lcih7CiAgICAgICAgICAgIHBlcmlvZDogX3BlcmlvZCAqIDEgaG91cnMsCiAgICAgICAgICAgIHByaWNlOiBfcHJpY2UsCiAgICAgICAgICAgIGV4aXN0czogdHJ1ZQogICAgICAgICAgICB9KTsKICAgICAgICBlbWl0IE5ld0dhcmRlbmVyQWRkZWQoZ2FyZGVuZXJJZCwgX3BlcmlvZCwgX3ByaWNlKTsKICAgIH0KCgogICAgZnVuY3Rpb24gZWRpdEdhcmRlbmVyKHVpbnQgX2dhcmRlbmVySWQsIHVpbnQgX3BlcmlvZCwgdWludCBfcHJpY2UpIG9ubHlPd25lciBwdWJsaWMgIHsKICAgICAgICByZXF1aXJlKGdhcmRlbmVyc1tfZ2FyZGVuZXJJZF0uZXhpc3RzKTsKICAgICAgICBHYXJkZW5lciBzdG9yYWdlIGcgPSBnYXJkZW5lcnNbX2dhcmRlbmVySWRdOwogICAgICAgIGcucGVyaW9kID0gX3BlcmlvZDsKICAgICAgICBnLnByaWNlID0gX3ByaWNlOwogICAgICAgIGVtaXQgR2FyZGVuZXJDaGFuZ2UoX2dhcmRlbmVySWQsIF9wZXJpb2QsIF9wcmljZSk7CiAgICB9CgoKICAgIGZ1bmN0aW9uIGdldFVzZXJMYW5kTGltaXQoYWRkcmVzcyBfdXNlcikgcHVibGljIHZpZXcgcmV0dXJucyh1aW50KSB7CiAgICAgICAgcmV0dXJuIHVzZXJSYW5rLmdldFJhbmtMYW5kTGltaXQodXNlclJhbmsuZ2V0VXNlclJhbmsoX3VzZXIpKS5zdWIoYmFsYW5jZXNbX3VzZXJdKTsKICAgIH0KCgogICAgZnVuY3Rpb24gc2V0TGFuZExpbWl0KCkgZXh0ZXJuYWwgb25seUNvbW11bml0eSB7CiAgICAgICAgcmVxdWlyZSh0b3RhbFN1cHBseV8gPT0gTUFYX1NVUFBMWSk7CiAgICAgICAgTUFYX1NVUFBMWSA9IE1BWF9TVVBQTFkuYWRkKDEwMDApOwogICAgICAgIGVtaXQgTmV3TGFuZExpbWl0KE1BWF9TVVBQTFkpOwogICAgfQoKICAgIC8vMSUgLSAxMDAsIDEwJSAtIDEwMDAgNTAlIC0gNTAwMAogICAgZnVuY3Rpb24gdmFsdWVGcm9tUGVyY2VudCh1aW50IF92YWx1ZSwgdWludCBfcGVyY2VudCkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IGFtb3VudCkgICAgewogICAgICAgIHVpbnQgX2Ftb3VudCA9IF92YWx1ZS5tdWwoX3BlcmNlbnQpLmRpdigxMDAwMCk7CiAgICAgICAgcmV0dXJuIChfYW1vdW50KTsKICAgIH0KCgogICAgZnVuY3Rpb24gcmVjZWl2ZUFwcHJvdmFsKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlLCBhZGRyZXNzIF90b2tlbiwgYnl0ZXMgX2V4dHJhRGF0YSkgcHVibGljIHsKICAgICAgICAvL3JlcXVpcmUoX3Rva2VuID09IGxhbmRNYW5hZ2VtZW50LmNhbmR5VG9rZW4oKSk7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkZHJlc3MoY2FuZHlUb2tlbikpOwogICAgICAgIHJlcXVpcmUoYWxsb3dlZEZ1bmNzW2J5dGVzVG9CeXRlczQoX2V4dHJhRGF0YSldKTsKICAgICAgICByZXF1aXJlKGFkZHJlc3ModGhpcykuY2FsbChfZXh0cmFEYXRhKSk7CiAgICAgICAgZW1pdCBSZWNlaXZlQXBwcm92YWwoX2Zyb20sIF92YWx1ZSwgX3Rva2VuKTsKICAgIH0KCgogICAgZnVuY3Rpb24gd2l0aGRyYXdUb2tlbnMoKSBvbmx5TWFuYWdlciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoY2FuZHlUb2tlbi5iYWxhbmNlT2YodGhpcykgPiAwKTsKICAgICAgICBjYW5keVRva2VuLnRyYW5zZmVyKGxhbmRNYW5hZ2VtZW50LndhbGxldEFkZHJlc3MoKSwgY2FuZHlUb2tlbi5iYWxhbmNlT2YodGhpcykpOwogICAgICAgIGVtaXQgVG9rZW5zVHJhbnNmZXJyZWQobGFuZE1hbmFnZW1lbnQud2FsbGV0QWRkcmVzcygpLCBjYW5keVRva2VuLmJhbGFuY2VPZih0aGlzKSk7CiAgICB9Cgp9'.
	

]
