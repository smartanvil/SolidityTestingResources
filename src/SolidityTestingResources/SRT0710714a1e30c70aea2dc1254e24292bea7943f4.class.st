Class {
	#name : #SRT0710714a1e30c70aea2dc1254e24292bea7943f4,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT0710714a1e30c70aea2dc1254e24292bea7943f4 >> base64 [
	^ 'LyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCmNvbnRyYWN0IFRva2VuIHsKICAgIGZ1bmN0aW9uIGlzc3VlKGFkZHJlc3MgX3JlY2lwaWVudCwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykge30KICAgIGZ1bmN0aW9uIGlzc3VlQXRJY28oYWRkcmVzcyBfcmVjaXBpZW50LCB1aW50MjU2IF92YWx1ZSwgdWludDI1NiBfaWNvTnVtYmVyKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHt9CiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgc3VwcGx5KSB7fQogICAgZnVuY3Rpb24gdW5sb2NrKCkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7fQp9Cgpjb250cmFjdCBSSUNIQ3Jvd2RzYWxlIHsKCiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICAvLyBDcm93ZHNhbGUgYWRkcmVzc2VzCiAgICBhZGRyZXNzIHB1YmxpYyBjcmVhdG9yOyAvLyBDcmVhdG9yICgxJSBmdW5kaW5nKQogICAgYWRkcmVzcyBwdWJsaWMgYnV5QmFja0Z1bmQ7IC8vIEZ1bmQgZm9yIGJ1eWluZyBiYWNrIGFuZCBidXJuaW5nICg0OCUgZnVuZGluZykKICAgIGFkZHJlc3MgcHVibGljIGh1bWFuaXR5RnVuZDsgLy8gSHVtYW5pdHkgZnVuZCAoNTElIGZ1bmRpbmcpCgogICAgLy8gV2l0aGRyYXdhbCBydWxlcwogICAgdWludDI1NiBwdWJsaWMgY3JlYXRvcldpdGhkcmF3ID0gMDsgLy8gQ3VycmVudCB3aXRoZHJhd2VkCiAgICB1aW50MjU2IHB1YmxpYyBtYXhDcmVhdG9yV2l0aGRyYXcgPSA1ICogMTAgKiogMyAqIDEwKioxODsgLy8gRmlyc3QgNS4wMDAgRVRICiAgICB1aW50MjU2IHB1YmxpYyBwZXJjZW50YWdlSHVtYW5pdHlGdW5kID0gNTE7IC8vIFBlcmNlbnRhZ2UgZ29lcyB0byBIdW1hbml0eSBmdW5kCiAgICB1aW50MjU2IHB1YmxpYyBwZXJjZW50YWdlQnV5QmFja0Z1bmQgPSA0OTsgLy8gUGVyY2VudGFnZSBnb2VzIHRvIEJ1eS1iYWNrIGZ1bmQKCiAgICAvLyBFdGggdG8gdG9rZW4gcmF0ZQogICAgdWludDI1NiBwdWJsaWMgY3VycmVudE1hcmtldFJhdGUgPSAxOyAvLyBDdXJyZW50IG1hcmtldCBwcmljZSBFVEgvUkNILiBXaWxsIGJlIHVwZGF0ZWQgYmVmb3JlIGVhY2ggaWNvCiAgICB1aW50MjU2IHB1YmxpYyBtaW5pbXVtSWNvUmF0ZSA9IDI0MDsgLy8gRVRIL2RvbGxhciByYXRlLiBNaW5pbXVtIHJhdGUgYXQgd2ljaCB3aWxsIGJlIGlzc3VlZCBSSUNIIHRva2VuLCAxJCA9IDFSQ0gKICAgIHVpbnQyNTYgcHVibGljIG1pbkFjY2VwdGVkRXRoQW1vdW50ID0gNCBmaW5uZXk7IC8vIDAuMDA0IGV0aGVyCgogICAgLy8gSUNPcyBzcGVjaWZpY2F0aW9uCiAgICB1aW50MjU2IHB1YmxpYyBtYXhUb3RhbFN1cHBseSA9IDEwMDAwMDAwMDAgKiAxMCoqODsgLy8gMSBtbHJkLiB0b2tlbnMKCiAgICBtYXBwaW5nICh1aW50MjU2ID0+IHVpbnQyNTYpIGljb1Rva2VuSXNzdWVkOyAvLyBJc3N1ZWQgaW4gZWFjaCBJQ08KICAgIHVpbnQyNTYgcHVibGljIHRvdGFsVG9rZW5Jc3N1ZWQ7IC8vIFRvdGFsIG9mIGlzc3VlZCB0b2tlbnMKCiAgICB1aW50MjU2IHB1YmxpYyBpY29QZXJpb2QgPSAxMCBkYXlzOwogICAgdWludDI1NiBwdWJsaWMgbm9JY29QZXJpb2QgPSAxMCBkYXlzOwogICAgdWludDI1NiBwdWJsaWMgbWF4SXNzdWVkVG9rZW5zUGVySWNvID0gMTAqKjYgKiAxMCoqODsgLy8gMSBtaWwuCiAgICB1aW50MjU2IHB1YmxpYyBwcmVJY29QZXJpb2QgPSAzMCBkYXlzOwoKICAgIHVpbnQyNTYgcHVibGljIGJvbnVzUHJlSWNvID0gNTA7CiAgICB1aW50MjU2IHB1YmxpYyBib251c0ZpcnN0SWNvID0gMzA7CiAgICB1aW50MjU2IHB1YmxpYyBib251c1NlY29uZEljbyA9IDEwOwoKICAgIHVpbnQyNTYgcHVibGljIGJvbnVzU3Vic2NyaXB0aW9uID0gNTsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1Nikgc3Vic3JpcHRpb25Cb251c1Rva2Vuc0lzc3VlZDsKCiAgICAvLyBCYWxhbmNlcwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgdG9rZW5CYWxhbmNlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAodWludDI1NiA9PiB1aW50MjU2KSkgdG9rZW5CYWxhbmNlc1BlckljbzsKCiAgICBlbnVtIFN0YWdlcyB7CiAgICAgICAgQ291bnRkb3duLAogICAgICAgIFByZUljbywKICAgICAgICBQcmlvcml0eUljbywKICAgICAgICBPcGVuSWNvLAogICAgICAgIEljbywgLy8gW1ByZUljbywgUHJpb3JpdHlJY28sIE9wZW5JY29dCiAgICAgICAgTm9JY28sCiAgICAgICAgRW5kZWQKICAgIH0KCiAgICBTdGFnZXMgcHVibGljIHN0YWdlID0gU3RhZ2VzLkNvdW50ZG93bjsKCiAgICAvLyBDcm93ZHNhbGUgdGltZXMKICAgIHVpbnQgcHVibGljIHN0YXJ0OwogICAgdWludCBwdWJsaWMgcHJlSWNvU3RhcnQ7CgogICAgLy8gUmljaCB0b2tlbgogICAgVG9rZW4gcHVibGljIHJpY2hUb2tlbjsKCiAgICAvKioKICAgICAqIFRocm93IGlmIGF0IHN0YWdlIG90aGVyIHRoYW4gY3VycmVudCBzdGFnZQogICAgICoKICAgICAqIEBwYXJhbSBfc3RhZ2UgZXhwZWN0ZWQgc3RhZ2UgdG8gdGVzdCBmb3IKICAgICAqLwogICAgbW9kaWZpZXIgYXRTdGFnZShTdGFnZXMgX3N0YWdlKSB7CiAgICAgICAgdXBkYXRlU3RhdGUoKTsKCiAgICAgICAgaWYgKHN0YWdlICE9IF9zdGFnZSAmJiBfc3RhZ2UgIT0gU3RhZ2VzLkljbykgewogICAgICAgICAgICB0aHJvdzsKICAgICAgICB9CgogICAgICAgIGlmIChzdGFnZSAhPSBTdGFnZXMuUHJpb3JpdHlJY28gJiYgc3RhZ2UgIT0gU3RhZ2VzLk9wZW5JY28gJiYgc3RhZ2UgIT0gU3RhZ2VzLlByZUljbykgewogICAgICAgICAgICB0aHJvdzsKICAgICAgICB9CiAgICAgICAgXzsKICAgIH0KCgogICAgLyoqCiAgICAgKiBUaHJvdyBpZiBzZW5kZXIgaXMgbm90IGNyZWF0b3IKICAgICAqLwogICAgbW9kaWZpZXIgb25seUNyZWF0b3IoKSB7CiAgICAgICAgaWYgKGNyZWF0b3IgIT0gbXNnLnNlbmRlcikgewogICAgICAgICAgICB0aHJvdzsKICAgICAgICB9CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEdldCBib251cyBmb3IgcHJvdmlkZWQgSUNPIG51bWJlcgogICAgICoKICAgICAqIEBwYXJhbSBfY3VycmVudEljbyBjdXJyZW50IGljbyBudW1iZXIKICAgICAqIEByZXR1cm4gcGVyY2VudGFnZQogICAgICovCiAgICBmdW5jdGlvbiBnZXRQZXJjZW50YWdlQm9udXNGb3JJY28odWludDI1NiBfY3VycmVudEljbykgcmV0dXJucyAodWludDI1NiBwZXJjZW50YWdlKSB7CiAgICAgICAgdXBkYXRlU3RhdGUoKTsKCiAgICAgICAgaWYgKHN0YWdlID09IFN0YWdlcy5QcmVJY28pIHsKICAgICAgICAgICAgcmV0dXJuIGJvbnVzUHJlSWNvOwogICAgICAgIH0KCiAgICAgICAgaWYgKF9jdXJyZW50SWNvID09IDEpIHsKICAgICAgICAgICAgcmV0dXJuIGJvbnVzRmlyc3RJY287CiAgICAgICAgfQoKICAgICAgICBpZiAoX2N1cnJlbnRJY28gPT0gMikgewogICAgICAgICAgICByZXR1cm4gYm9udXNTZWNvbmRJY287CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gMDsKICAgIH0KCiAgICAvKioKICAgICAqIEdldCBldGhlcmV1bSBiYWxhbmNlIG9mIGBfaW52ZXN0b3JgCiAgICAgKgogICAgICogQHBhcmFtIF9pbnZlc3RvciBUaGUgYWRkcmVzcyBmcm9tIHdoaWNoIHRoZSBiYWxhbmNlIHdpbGwgYmUgcmV0cmlldmVkCiAgICAgKiBAcmV0dXJuIFRoZSBiYWxhbmNlCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9pbnZlc3RvcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19pbnZlc3Rvcl07CiAgICB9CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3QKICAgICAqCiAgICAgKiBAcGFyYW0gX3Rva2VuQWRkcmVzcyBUaGUgYWRkcmVzcyBvZiB0aGUgUmljaCB0b2tlbiBjb250YWN0CiAgICAgKiBAcGFyYW0gX2NyZWF0b3IgQ29udHJhY3QgY3JlYXRvcgogICAgICogQHBhcmFtIF9zdGFydCBTdGFydCBvZiB0aGUgZmlyc3QgSUNPCiAgICAgKiBAcGFyYW0gX3ByZUljb1N0YXJ0IFN0YXJ0IG9mIHByZS1JQ08KICAgICAqLwogICAgZnVuY3Rpb24gUklDSENyb3dkc2FsZShhZGRyZXNzIF90b2tlbkFkZHJlc3MsIGFkZHJlc3MgX2NyZWF0b3IsIHVpbnQyNTYgX3N0YXJ0LCB1aW50MjU2IF9wcmVJY29TdGFydCkgewogICAgICAgIHJpY2hUb2tlbiA9IFRva2VuKF90b2tlbkFkZHJlc3MpOwogICAgICAgIGNyZWF0b3IgPSBfY3JlYXRvcjsKICAgICAgICBzdGFydCA9IF9zdGFydDsKICAgICAgICBwcmVJY29TdGFydCA9IF9wcmVJY29TdGFydDsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCBjdXJyZW50IG1hcmtldCByYXRlIEVUSC9SSUNILiBXaWxsIGJlIGNhbGVkIGJ5IGNyZWF0b3IgYmVmb3JlIGVhY2ggSUNPCiAgICAgKgogICAgICogQHBhcmFtIF9jdXJyZW50TWFya2V0UmF0ZSBjdXJyZW50IEVUSC9SSUNIIHJhdGUgYXQgdGhlIG1hcmtldAogICAgICovCiAgICBmdW5jdGlvbiBzZXRDdXJyZW50TWFya2V0UmF0ZSh1aW50MjU2IF9jdXJyZW50TWFya2V0UmF0ZSkgb25seUNyZWF0b3IgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGN1cnJlbnRNYXJrZXRSYXRlID0gX2N1cnJlbnRNYXJrZXRSYXRlOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IG1pbmltdW0gSUNPIHJhdGUgKEVUSC9kb2xsYXIpIGluIG9yZGVyIHRvIGFjaGlldmUgbWF4IHByaWNlIG9mIDEkIGZvciAxIFJDSC4KICAgICAqIFdpbGwgYmUgY2FsbGVkIGJ5IGNyZWF0b3IgYmVmb3JlIGVhY2ggSUNPCiAgICAgKgogICAgICogQHBhcmFtIF9taW5pbXVtSWNvUmF0ZSBjdXJyZW50IEVUSC9kb2xsYXIgcmF0ZSBhdCB0aGUgbWFya2V0CiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldE1pbmltdW1JY29SYXRlKHVpbnQyNTYgX21pbmltdW1JY29SYXRlKSBvbmx5Q3JlYXRvciByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgbWluaW11bUljb1JhdGUgPSBfbWluaW11bUljb1JhdGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgaHVtYW5pdHkgZnVuZCBhZGRyZXNzCiAgICAgKgogICAgICogQHBhcmFtIF9odW1hbml0eUZ1bmQgSHVtYW5pdHkgZnVuZCBhZGRyZXNzCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldEh1bWFuaXR5RnVuZChhZGRyZXNzIF9odW1hbml0eUZ1bmQpIG9ubHlDcmVhdG9yIHsKICAgICAgICBodW1hbml0eUZ1bmQgPSBfaHVtYW5pdHlGdW5kOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IGJ1eSBiYWNrIGZ1bmQgYWRkcmVzcwogICAgICoKICAgICAqIEBwYXJhbSBfYnV5QmFja0Z1bmQgQmF5IGJhY2sgZnVuZCBhZGRyZXNzCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldEJ1eUJhY2tGdW5kKGFkZHJlc3MgX2J1eUJhY2tGdW5kKSBvbmx5Q3JlYXRvciB7CiAgICAgICAgYnV5QmFja0Z1bmQgPSBfYnV5QmFja0Z1bmQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgY3VycmVudCByYXRlIGF0IHdoaWNoIHdpbGwgYmUgaXNzdWVkIHRva2VucwogICAgICoKICAgICAqIEByZXR1cm4gcmF0ZSBIb3cgbWFueSB0b2tlbnMgd2lsbCBiZSBpc3N1ZWQgZm9yIG9uZSBFVEgKICAgICAqLwogICAgZnVuY3Rpb24gZ2V0UmF0ZSgpIHJldHVybnMgKHVpbnQyNTYgcmF0ZSkgewogICAgICAgIGlmIChjdXJyZW50TWFya2V0UmF0ZSAqIDEyIC8gMTAgPCBtaW5pbXVtSWNvUmF0ZSkgewogICAgICAgICAgICByZXR1cm4gbWluaW11bUljb1JhdGU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gY3VycmVudE1hcmtldFJhdGUgKiAxMiAvIDEwOwogICAgfQoKICAgIC8qKgogICAgICogUmV0cnVuIHBlY2VudGFnZSBvZiB0b2tlbnMgb3duZWQgYnkgcHJvdmlkZWQgaW52ZXN0b3IKICAgICAqCiAgICAgKiBAcGFyYW0gX2ludmVzdG9yIGFkZHJlc3Mgb2YgaW52ZXN0b3IKICAgICAqIEBwYXJhbSBleGVwdEluSWNvIElDTyBudW1iZXIgdGhhdCB3aWxsIGJlIGV4Y2x1ZGVkIGZyb20gY2FsY3VsYXRpb24gKHVzdWFsbHkgY3VycmVudCBJQ08gbnVtYmVyKQogICAgICogQHJldHVybiBpbnZlc3RvciByYXRlLCAxMDAwMDAwID0gMTAwJQogICAgICovCiAgICBmdW5jdGlvbiBnZXRJbnZlc3RvclRva2VuUGVyY2VudGFnZShhZGRyZXNzIF9pbnZlc3RvciwgdWludDI1NiBleGVwdEluSWNvKSByZXR1cm5zICh1aW50MjU2IHBlcmNlbnRhZ2UpIHsKICAgICAgICB1aW50MjU2IGRlZHVjdGlvbkludmVzdG9yID0gMDsKICAgICAgICB1aW50MjU2IGRlZHVjdGlvbkljbyA9IDA7CgogICAgICAgIGlmIChleGVwdEluSWNvID49IDApIHsKICAgICAgICAgICAgZGVkdWN0aW9uSW52ZXN0b3IgPSB0b2tlbkJhbGFuY2VzUGVySWNvW19pbnZlc3Rvcl1bZXhlcHRJbkljb107CiAgICAgICAgICAgIGRlZHVjdGlvbkljbyA9IGljb1Rva2VuSXNzdWVkW2V4ZXB0SW5JY29dOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRvdGFsVG9rZW5Jc3N1ZWQgLSBkZWR1Y3Rpb25JY28gPT0gMCkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CgogICAgICAgIHJldHVybiAxMDAwMDAwICogKHRva2VuQmFsYW5jZXNbX2ludmVzdG9yXSAtIGRlZHVjdGlvbkludmVzdG9yKSAvICh0b3RhbFRva2VuSXNzdWVkIC0gZGVkdWN0aW9uSWNvKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlcnQgYF93ZWlgIHRvIGFuIGFtb3VudCBpbiBSSUNIIHVzaW5nCiAgICAgKiB0aGUgY3VycmVudCByYXRlCiAgICAgKgogICAgICogQHBhcmFtIF93ZWkgYW1vdW50IG9mIHdlaSB0byBjb252ZXJ0CiAgICAgKiBAcmV0dXJuIFRoZSBhbW91bnQgaW4gUklDSAogICAgICovCiAgICBmdW5jdGlvbiB0b1JJQ0godWludDI1NiBfd2VpKSByZXR1cm5zICh1aW50MjU2IGFtb3VudCkgewogICAgICAgIHVpbnQyNTYgcmF0ZSA9IGdldFJhdGUoKTsKCiAgICAgICAgcmV0dXJuIF93ZWkgKiByYXRlICogMTAqKjggLyAxIGV0aGVyOyAvLyAxMCoqOCBmb3IgOCBkZWNpbWFscwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIElDTyBudW1iZXIgKFByZUljbyBoYXMgaW5kZXggMCkKICAgICAqCiAgICAgKiBAcmV0dXJuIElDTyBudW1iZXIKICAgICAqLwogICAgZnVuY3Rpb24gZ2V0Q3VycmVudEljb051bWJlcigpIHJldHVybnMgKHVpbnQyNTYgYW1vdW50KSB7CiAgICAgICAgdWludDI1NiB0aW1lQmVoaW5kID0gbm93IC0gc3RhcnQ7CiAgICAgICAgaWYgKG5vdyA8IHN0YXJ0KSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIDEgKyAoKHRpbWVCZWhpbmQgLSAodGltZUJlaGluZCAlIChpY29QZXJpb2QgKyBub0ljb1BlcmlvZCkpKSAvIChpY29QZXJpb2QgKyBub0ljb1BlcmlvZCkpOwogICAgfQoKICAgIC8qKgogICAgICogVXBkYXRlIGNyb3dkIHNhbGUgc3RhZ2UgYmFzZWQgb24gY3VycmVudCB0aW1lIGFuZCBJQ08gcGVyaW9kcwogICAgICovCiAgICBmdW5jdGlvbiB1cGRhdGVTdGF0ZSgpIHsKICAgICAgICB1aW50MjU2IHRpbWVCZWhpbmQgPSBub3cgLSBzdGFydDsKICAgICAgICB1aW50MjU2IGN1cnJlbnRJY29OdW1iZXIgPSBnZXRDdXJyZW50SWNvTnVtYmVyKCk7CgogICAgICAgIGlmIChpY29Ub2tlbklzc3VlZFtjdXJyZW50SWNvTnVtYmVyXSA+PSBtYXhJc3N1ZWRUb2tlbnNQZXJJY28pIHsKICAgICAgICAgICAgc3RhZ2UgPSBTdGFnZXMuTm9JY287CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICh0b3RhbFRva2VuSXNzdWVkID49IG1heFRvdGFsU3VwcGx5KSB7CiAgICAgICAgICAgIHN0YWdlID0gU3RhZ2VzLkVuZGVkOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAobm93ID49IHByZUljb1N0YXJ0ICYmIG5vdyA8PSBwcmVJY29TdGFydCArIHByZUljb1BlcmlvZCkgewogICAgICAgICAgICBzdGFnZSA9IFN0YWdlcy5QcmVJY287CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmIChub3cgPCBzdGFydCkgewogICAgICAgICAgICBzdGFnZSA9IFN0YWdlcy5Db3VudGRvd247CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHVpbnQyNTYgdGltZUZyb21JY29TdGFydCA9IHRpbWVCZWhpbmQgLSAoY3VycmVudEljb051bWJlciAtIDEpICogKGljb1BlcmlvZCArIG5vSWNvUGVyaW9kKTsKCiAgICAgICAgaWYgKHRpbWVGcm9tSWNvU3RhcnQgPiBpY29QZXJpb2QpIHsKICAgICAgICAgICAgc3RhZ2UgPSBTdGFnZXMuTm9JY287CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICh0aW1lRnJvbUljb1N0YXJ0ID4gaWNvUGVyaW9kIC8gMikgewogICAgICAgICAgICBzdGFnZSA9IFN0YWdlcy5PcGVuSWNvOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBzdGFnZSA9IFN0YWdlcy5Qcmlvcml0eUljbzsKICAgIH0KCgogICAgLyoqCiAgICAgKiBUcmFuc2ZlciBhcHByb3ByaWF0ZSBwZXJjZW50YWdlIG9mIHJhaXNlZCBhbW91bnQgdG8gdGhlIGNvbXBhbnkgYWRkcmVzcyBhbmQgaHVtYW5pdHkgYW5kIGJ1eSBiYWNrIGZ1bmQKICAgICAqLwogICAgZnVuY3Rpb24gd2l0aGRyYXcoKSBvbmx5Q3JlYXRvciB7CiAgICAgICAgdWludDI1NiBldGhCYWxhbmNlID0gdGhpcy5iYWxhbmNlOwogICAgICAgIHVpbnQyNTYgYW1vdW50VG9TZW5kID0gZXRoQmFsYW5jZSAtIDEwMDAwMDAwMDsKCiAgICAgICAgaWYgKGNyZWF0b3JXaXRoZHJhdyA8IG1heENyZWF0b3JXaXRoZHJhdykgewogICAgICAgICAgICBpZiAoYW1vdW50VG9TZW5kID4gbWF4Q3JlYXRvcldpdGhkcmF3IC0gY3JlYXRvcldpdGhkcmF3KSB7CiAgICAgICAgICAgICAgICBhbW91bnRUb1NlbmQgPSBtYXhDcmVhdG9yV2l0aGRyYXcgLSBjcmVhdG9yV2l0aGRyYXc7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICghY3JlYXRvci5zZW5kKGFtb3VudFRvU2VuZCkpIHsKICAgICAgICAgICAgICAgIHRocm93OwogICAgICAgICAgICB9CgogICAgICAgICAgICBjcmVhdG9yV2l0aGRyYXcgKz0gYW1vdW50VG9TZW5kOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB1aW50MjU2IGV0aEZvckh1bWFuaXR5RnVuZCA9IGFtb3VudFRvU2VuZCAqIHBlcmNlbnRhZ2VIdW1hbml0eUZ1bmQgLyAxMDA7CiAgICAgICAgdWludDI1NiBldGhGb3JCdXlCYWNrRnVuZCA9IGFtb3VudFRvU2VuZCAqIHBlcmNlbnRhZ2VCdXlCYWNrRnVuZCAvIDEwMDsKCiAgICAgICAgaWYgKCFodW1hbml0eUZ1bmQuc2VuZChldGhGb3JIdW1hbml0eUZ1bmQpKSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KCiAgICAgICAgaWYgKCFidXlCYWNrRnVuZC5zZW5kKGV0aEZvckJ1eUJhY2tGdW5kKSkgewogICAgICAgICAgICB0aHJvdzsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgYWRkaXRpb25hbCBib251cyB0b2tlbnMgZm9yIHN1YnNjcmliZWQgaW52ZXN0b3JzCiAgICAgKgogICAgICogQHBhcmFtIGludmVzdG9yQWRkcmVzcyBBZGRyZXNzIG9mIGludmVzdG9yCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNlbmRTdWJzY3JpcHRpb25Cb251cyhhZGRyZXNzIGludmVzdG9yQWRkcmVzcykgb25seUNyZWF0b3IgewogICAgICAgIHVpbnQyNTYgc3Vic2NyaXB0aW9uQm9udXMgPSB0b2tlbkJhbGFuY2VzW2ludmVzdG9yQWRkcmVzc10gKiBib251c1N1YnNjcmlwdGlvbiAvIDEwMDsKCiAgICAgICAgaWYgKHN1YnNyaXB0aW9uQm9udXNUb2tlbnNJc3N1ZWRbaW52ZXN0b3JBZGRyZXNzXSA8IHN1YnNjcmlwdGlvbkJvbnVzKSB7CiAgICAgICAgICAgIHVpbnQyNTYgdG9CZUlzc3VlZCA9IHN1YnNjcmlwdGlvbkJvbnVzIC0gc3Vic3JpcHRpb25Cb251c1Rva2Vuc0lzc3VlZFtpbnZlc3RvckFkZHJlc3NdOwogICAgICAgICAgICBpZiAoIXJpY2hUb2tlbi5pc3N1ZShpbnZlc3RvckFkZHJlc3MsIHRvQmVJc3N1ZWQpKSB7CiAgICAgICAgICAgICAgICB0aHJvdzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3Vic3JpcHRpb25Cb251c1Rva2Vuc0lzc3VlZFtpbnZlc3RvckFkZHJlc3NdICs9IHRvQmVJc3N1ZWQ7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmVjZWl2ZXMgRXRoIGFuZCBpc3N1ZSBSSUNIIHRva2VucyB0byB0aGUgc2VuZGVyCiAgICAgKi8KICAgIGZ1bmN0aW9uICgpIHBheWFibGUgYXRTdGFnZShTdGFnZXMuSWNvKSB7CiAgICAgICAgdWludDI1NiByZWNlaXZlZEV0aCA9IG1zZy52YWx1ZTsKCiAgICAgICAgaWYgKHJlY2VpdmVkRXRoIDwgbWluQWNjZXB0ZWRFdGhBbW91bnQpIHsKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgfQoKICAgICAgICB1aW50MjU2IHRva2Vuc1RvQmVJc3N1ZWQgPSB0b1JJQ0gocmVjZWl2ZWRFdGgpOwogICAgICAgIHVpbnQyNTYgY3VycmVudEljbyA9IGdldEN1cnJlbnRJY29OdW1iZXIoKTsKCiAgICAgICAgLy9hZGQgYm9udXMKICAgICAgICB0b2tlbnNUb0JlSXNzdWVkID0gdG9rZW5zVG9CZUlzc3VlZCArICh0b2tlbnNUb0JlSXNzdWVkICogZ2V0UGVyY2VudGFnZUJvbnVzRm9ySWNvKGN1cnJlbnRJY28pIC8gMTAwKTsKCiAgICAgICAgaWYgKHRva2Vuc1RvQmVJc3N1ZWQgPT0gMCB8fCBpY29Ub2tlbklzc3VlZFtjdXJyZW50SWNvXSArIHRva2Vuc1RvQmVJc3N1ZWQgPiBtYXhJc3N1ZWRUb2tlbnNQZXJJY28pIHsKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgfQoKICAgICAgICBpZiAoc3RhZ2UgPT0gU3RhZ2VzLlByaW9yaXR5SWNvKSB7CiAgICAgICAgICAgIHVpbnQyNTYgYWxyZWFkeUJvdWdodEluSWNvID0gdG9rZW5CYWxhbmNlc1Blckljb1ttc2cuc2VuZGVyXVtjdXJyZW50SWNvXTsKICAgICAgICAgICAgdWludDI1NiBjYW5CdXlUb2tlbnNJblRoaXNJY28gPSBtYXhJc3N1ZWRUb2tlbnNQZXJJY28gKiBnZXRJbnZlc3RvclRva2VuUGVyY2VudGFnZShtc2cuc2VuZGVyLCBjdXJyZW50SWNvKSAvIDEwMDAwMDA7CgogICAgICAgICAgICBpZiAodG9rZW5zVG9CZUlzc3VlZCA+IGNhbkJ1eVRva2Vuc0luVGhpc0ljbyAtIGFscmVhZHlCb3VnaHRJbkljbykgewogICAgICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICghcmljaFRva2VuLmlzc3VlKG1zZy5zZW5kZXIsIHRva2Vuc1RvQmVJc3N1ZWQpKSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KCiAgICAgICAgaWNvVG9rZW5Jc3N1ZWRbY3VycmVudEljb10gKz0gdG9rZW5zVG9CZUlzc3VlZDsKICAgICAgICB0b3RhbFRva2VuSXNzdWVkICs9IHRva2Vuc1RvQmVJc3N1ZWQ7CiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gKz0gcmVjZWl2ZWRFdGg7CiAgICAgICAgdG9rZW5CYWxhbmNlc1ttc2cuc2VuZGVyXSArPSB0b2tlbnNUb0JlSXNzdWVkOwogICAgICAgIHRva2VuQmFsYW5jZXNQZXJJY29bbXNnLnNlbmRlcl1bY3VycmVudEljb10gKz0gdG9rZW5zVG9CZUlzc3VlZDsKICAgIH0KfQ=='.
	

]
