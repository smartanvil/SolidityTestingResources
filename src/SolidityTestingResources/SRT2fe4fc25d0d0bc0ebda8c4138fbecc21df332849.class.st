Class {
	#name : #SRT2fe4fc25d0d0bc0ebda8c4138fbecc21df332849,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT2fe4fc25d0d0bc0ebda8c4138fbecc21df332849 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIC8vIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBhIC8gYjsKICB9CgogIC8qKgogICogQGRldiBTdWJ0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCi8qKgogKiBAdGl0bGUgUGF1c2FibGUKICogQGRldiBCYXNlIGNvbnRyYWN0IHdoaWNoIGFsbG93cyBjaGlsZHJlbiB0byBpbXBsZW1lbnQgYW4gZW1lcmdlbmN5IHN0b3AgbWVjaGFuaXNtLgogKi8KY29udHJhY3QgUGF1c2FibGUgaXMgT3duYWJsZSB7CiAgZXZlbnQgUGF1c2UoKTsKICBldmVudCBVbnBhdXNlKCk7CgogIGJvb2wgcHVibGljIHBhdXNlZCA9IGZhbHNlOwoKCiAgLyoqCiAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBub3QgcGF1c2VkLgogICAqLwogIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICByZXF1aXJlKCFwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgcGF1c2VkLgogICAqLwogIG1vZGlmaWVyIHdoZW5QYXVzZWQoKSB7CiAgICByZXF1aXJlKHBhdXNlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHBhdXNlLCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlCiAgICovCiAgZnVuY3Rpb24gcGF1c2UoKSBvbmx5T3duZXIgd2hlbk5vdFBhdXNlZCBwdWJsaWMgewogICAgcGF1c2VkID0gdHJ1ZTsKICAgIFBhdXNlKCk7CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gdW5wYXVzZSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgKi8KICBmdW5jdGlvbiB1bnBhdXNlKCkgb25seU93bmVyIHdoZW5QYXVzZWQgcHVibGljIHsKICAgIHBhdXNlZCA9IGZhbHNlOwogICAgVW5wYXVzZSgpOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5CiAqLwpjb250cmFjdCBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogIHVpbnQyNTYgdG90YWxTdXBwbHlfOwoKICAvKioKICAqIEBkZXYgdG90YWwgbnVtYmVyIG9mIHRva2VucyBpbiBleGlzdGVuY2UKICAqLwogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIHRvdGFsU3VwcGx5XzsKICB9CgogIC8qKgogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoKICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCgovKioKICogQHRpdGxlIFN0YW5kYXJkIEVSQzIwIHRva2VuCiAqCiAqIEBkZXYgSW1wbGVtZW50YXRpb24gb2YgdGhlIGJhc2ljIHN0YW5kYXJkIHRva2VuLgogKiBAZGV2IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgRmlyc3RCbG9vZDogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sCiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBpbnRlcm5hbCBhbGxvd2VkOwoKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW19mcm9tXSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSk7CgogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICoKICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICogYW5kIHRoZSBuZXcgYWxsb3dhbmNlIGJ5IHVuZm9ydHVuYXRlIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcwogICAqIHJhY2UgY29uZGl0aW9uIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUgYWZ0ZXJ3YXJkczoKICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgKi8KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KCiAgLyoqCiAgICogQGRldiBJbmNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9hZGRlZFZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGluY3JlYXNlIHRoZSBhbGxvd2FuY2UgYnkuCiAgICovCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBEZWNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gZGVjcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zdWJ0cmFjdGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gZGVjcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKi8KICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgfSBlbHNlIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBNaW50YWJsZSB0b2tlbgogKiBAZGV2IFNpbXBsZSBFUkMyMCBUb2tlbiBleGFtcGxlLCB3aXRoIG1pbnRhYmxlIHRva2VuIGNyZWF0aW9uCiAqIEBkZXYgSXNzdWU6ICogaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXBwZWxpbi1zb2xpZGl0eS9pc3N1ZXMvMTIwCiAqIEJhc2VkIG9uIGNvZGUgYnkgVG9rZW5NYXJrZXROZXQ6IGh0dHBzOi8vZ2l0aHViLmNvbS9Ub2tlbk1hcmtldE5ldC9pY28vYmxvYi9tYXN0ZXIvY29udHJhY3RzL01pbnRhYmxlVG9rZW4uc29sCiAqLwpjb250cmFjdCBNaW50YWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIE93bmFibGUgewogIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGFtb3VudCk7CiAgZXZlbnQgTWludEZpbmlzaGVkKCk7CgogIGJvb2wgcHVibGljIG1pbnRpbmdGaW5pc2hlZCA9IGZhbHNlOwoKCiAgbW9kaWZpZXIgY2FuTWludCgpIHsKICAgIHJlcXVpcmUoIW1pbnRpbmdGaW5pc2hlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBtaW50IHRva2VucwogICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIG1pbnRlZCB0b2tlbnMuCiAgICogQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gbWludC4KICAgKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgb25seU93bmVyIGNhbk1pbnQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHRvdGFsU3VwcGx5XyA9IHRvdGFsU3VwcGx5Xy5hZGQoX2Ftb3VudCk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICBNaW50KF90bywgX2Ftb3VudCk7CiAgICBUcmFuc2ZlcihhZGRyZXNzKDApLCBfdG8sIF9hbW91bnQpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHN0b3AgbWludGluZyBuZXcgdG9rZW5zLgogICAqIEByZXR1cm4gVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgIE1pbnRGaW5pc2hlZCgpOwogICAgcmV0dXJuIHRydWU7CiAgfQp9CgoKLyoqCiAqIEB0aXRsZSBDYXBwZWQgdG9rZW4KICogQGRldiBNaW50YWJsZSB0b2tlbiB3aXRoIGEgdG9rZW4gY2FwLgogKi8KY29udHJhY3QgQ2FwcGVkVG9rZW4gaXMgTWludGFibGVUb2tlbiB7CgogIHVpbnQyNTYgcHVibGljIGNhcDsKCiAgZnVuY3Rpb24gQ2FwcGVkVG9rZW4odWludDI1NiBfY2FwKSBwdWJsaWMgewogICAgcmVxdWlyZShfY2FwID4gMCk7CiAgICBjYXAgPSBfY2FwOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBtaW50IHRva2VucwogICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIG1pbnRlZCB0b2tlbnMuCiAgICogQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gbWludC4KICAgKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgb25seU93bmVyIGNhbk1pbnQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUodG90YWxTdXBwbHlfLmFkZChfYW1vdW50KSA8PSBjYXApOwoKICAgIHJldHVybiBzdXBlci5taW50KF90bywgX2Ftb3VudCk7CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBQYXVzYWJsZSB0b2tlbgogKiBAZGV2IFN0YW5kYXJkVG9rZW4gbW9kaWZpZWQgd2l0aCBwYXVzYWJsZSB0cmFuc2ZlcnMuCiAqKi8KY29udHJhY3QgUGF1c2FibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBQYXVzYWJsZSB7CgogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBzdXBlci5hcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJldHVybiBzdXBlci5pbmNyZWFzZUFwcHJvdmFsKF9zcGVuZGVyLCBfYWRkZWRWYWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICByZXR1cm4gc3VwZXIuZGVjcmVhc2VBcHByb3ZhbChfc3BlbmRlciwgX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgfQp9IAoKLyoqCiAqIEB0aXRsZSBCdXJuYWJsZSBUb2tlbgogKiBAZGV2IFRva2VuIHRoYXQgY2FuIGJlIGlycmV2ZXJzaWJseSBidXJuZWQgKGRlc3Ryb3llZCkuCiAqLwpjb250cmFjdCBCdXJuYWJsZVRva2VuIGlzIEJhc2ljVG9rZW4gewoKICBldmVudCBCdXJuKGFkZHJlc3MgaW5kZXhlZCBidXJuZXIsIHVpbnQyNTYgdmFsdWUpOwoKICAvKioKICAgKiBAZGV2IEJ1cm5zIGEgc3BlY2lmaWMgYW1vdW50IG9mIHRva2Vucy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgYnVybmVkLgogICAqLwogIGZ1bmN0aW9uIGJ1cm4odWludDI1NiBfdmFsdWUpIHB1YmxpYyB7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1ttc2cuc2VuZGVyXSk7CiAgICAvLyBubyBuZWVkIHRvIHJlcXVpcmUgdmFsdWUgPD0gdG90YWxTdXBwbHksIHNpbmNlIHRoYXQgd291bGQgaW1wbHkgdGhlCiAgICAvLyBzZW5kZXIncyBiYWxhbmNlIGlzIGdyZWF0ZXIgdGhhbiB0aGUgdG90YWxTdXBwbHksIHdoaWNoICpzaG91bGQqIGJlIGFuIGFzc2VydGlvbiBmYWlsdXJlCgogICAgYWRkcmVzcyBidXJuZXIgPSBtc2cuc2VuZGVyOwogICAgYmFsYW5jZXNbYnVybmVyXSA9IGJhbGFuY2VzW2J1cm5lcl0uc3ViKF92YWx1ZSk7CiAgICB0b3RhbFN1cHBseV8gPSB0b3RhbFN1cHBseV8uc3ViKF92YWx1ZSk7CiAgICBCdXJuKGJ1cm5lciwgX3ZhbHVlKTsKICAgIFRyYW5zZmVyKGJ1cm5lciwgYWRkcmVzcygwKSwgX3ZhbHVlKTsKICB9Cn0KCi8qCiAgSGFyZGNhcFRva2VuIGlzIFBhdXNhYmxlVG9rZW4gYW5kIG9uIHRoZSBjcmVhdGlvbiBpdCBpcyBwYXVzZWQuCiAgSXQgaXMgbWFkZSBzbyBiZWNhdXNlIHlvdSBkb24ndCB3YW50IHRva2VuIHRvIGJlIHRyYW5zZmVyYWJsZSBldGMsCiAgd2hpbGUgeW91ciBpY28gaXMgbm90IG92ZXIuCiovCmNvbnRyYWN0IEhhcmRjYXBUb2tlbiBpcyBDYXBwZWRUb2tlbiwgUGF1c2FibGVUb2tlbiwgQnVybmFibGVUb2tlbiB7CgogIHVpbnQyNTYgcHJpdmF0ZSBjb25zdGFudCBUT0tFTl9DQVAgPSAxMDAgKiAxMCoqMjQ7CgogIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJXZWxsdHJhZG8gdG9rZW4iOwogIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIldUTCI7CiAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CgogIGZ1bmN0aW9uIEhhcmRjYXBUb2tlbigpIHB1YmxpYyBDYXBwZWRUb2tlbihUT0tFTl9DQVApIHsKICAgIHBhdXNlZCA9IHRydWU7CiAgfQp9Cgpjb250cmFjdCBIYXJkY2FwQ3Jvd2RzYWxlIGlzIE93bmFibGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBzdHJ1Y3QgUGhhc2UgewogICAgdWludDI1NiBjYXBUbzsKICAgIHVpbnQyNTYgcmF0ZTsKICB9CgogIHVpbnQyNTYgcHJpdmF0ZSBjb25zdGFudCBURUFNX1BFUkNFTlRBR0UgPSAxMDsKICB1aW50MjU2IHByaXZhdGUgY29uc3RhbnQgUExBVEZPUk1fUEVSQ0VOVEFHRSA9IDI1OwogIHVpbnQyNTYgcHJpdmF0ZSBjb25zdGFudCBDUk9XRFNBTEVfUEVSQ0VOVEFHRSA9IDY1OwoKICB1aW50MjU2IHByaXZhdGUgY29uc3RhbnQgTUlOX1RPS0VOU19UT19QVVJDSEFTRSA9IDEwMCAqIDEwKioxODsKCiAgdWludDI1NiBwcml2YXRlIGNvbnN0YW50IElDT19UT0tFTlNfQ0FQID0gNjUgKiAxMCoqMjQ7CgogIHVpbnQyNTYgcHJpdmF0ZSBjb25zdGFudCBGSU5BTF9DTE9TSU5HX1RJTUUgPSAxNTI5OTI4MDAwOwoKICB1aW50MjU2IHByaXZhdGUgY29uc3RhbnQgSU5JVElBTF9TVEFSVF9EQVRFID0gMTUyNDQ4NDgwMDsKCiAgdWludDI1NiBwdWJsaWMgcGhhc2UgPSAwOwoKICBIYXJkY2FwVG9rZW4gcHVibGljIHRva2VuOwoKICBhZGRyZXNzIHB1YmxpYyB3YWxsZXQ7CiAgYWRkcmVzcyBwdWJsaWMgcGxhdGZvcm07CiAgYWRkcmVzcyBwdWJsaWMgYXNzaWduZXI7CiAgYWRkcmVzcyBwdWJsaWMgdGVhbVRva2VuSG9sZGVyOwoKICB1aW50MjU2IHB1YmxpYyB3ZWlSYWlzZWQ7CgogIGJvb2wgcHVibGljIGlzRmluYWxpemVkID0gZmFsc2U7CgogIHVpbnQyNTYgcHVibGljIG9wZW5pbmdUaW1lID0gMTUyNDQ4NDgwMDsKICB1aW50MjU2IHB1YmxpYyBjbG9zaW5nVGltZSA9IDE1MjUwODk2MDA7CiAgdWludDI1NiBwdWJsaWMgZmluYWxpemVkVGltZTsKCiAgbWFwcGluZyAodWludDI1NiA9PiBQaGFzZSkgcHJpdmF0ZSBwaGFzZXM7CgogIGV2ZW50IFRva2VuUHVyY2hhc2UoYWRkcmVzcyBpbmRleGVkIHB1cmNoYXNlciwgYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IGFtb3VudCk7CiAgZXZlbnQgVG9rZW5Bc3NpZ25lZChhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgYW1vdW50KTsKCgogIGV2ZW50IEZpbmFsaXplZCgpOwoKICBtb2RpZmllciBvbmx5QXNzZ2luZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYXNzaWduZXIpOwogICAgXzsKICB9CgogIGZ1bmN0aW9uIEhhcmRjYXBDcm93ZHNhbGUoYWRkcmVzcyBfd2FsbGV0LCBhZGRyZXNzIF9wbGF0Zm9ybSwgYWRkcmVzcyBfYXNzaWduZXIsIEhhcmRjYXBUb2tlbiBfdG9rZW4pIHB1YmxpYyB7CiAgICAgIHJlcXVpcmUoX3dhbGxldCAhPSBhZGRyZXNzKDApKTsKICAgICAgcmVxdWlyZShfYXNzaWduZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgIHJlcXVpcmUoX3BsYXRmb3JtICE9IGFkZHJlc3MoMCkpOwogICAgICByZXF1aXJlKF90b2tlbiAhPSBhZGRyZXNzKDApKTsKCiAgICAgIHdhbGxldCA9IF93YWxsZXQ7CiAgICAgIHBsYXRmb3JtID0gX3BsYXRmb3JtOwogICAgICBhc3NpZ25lciA9IF9hc3NpZ25lcjsKICAgICAgdG9rZW4gPSBfdG9rZW47CgogICAgICAvLyBwaGFzZXMgY2FwVG8gbWVhbnMgdGhhdCB0b3RhbFN1cHBseSBtdXN0IHJlYWNoIGl0IHRvIGNoYW5nZSB0aGUgcGhhc2UKICAgICAgcGhhc2VzWzBdID0gUGhhc2UoMTUgKiAxMCoqMjMsIDEyNTApOwogICAgICBwaGFzZXNbMV0gPSBQaGFzZSgxMCAqIDEwKioyNCwgMTIwMCk7CiAgICAgIHBoYXNlc1syXSA9IFBoYXNlKDE3ICogMTAqKjI0LCAxMTUwKTsKICAgICAgcGhhc2VzWzNdID0gUGhhc2UoMjQgKiAxMCoqMjQsIDExMDApOwogICAgICBwaGFzZXNbNF0gPSBQaGFzZSgzMSAqIDEwKioyNCwgMTA3MCk7CiAgICAgIHBoYXNlc1s1XSA9IFBoYXNlKDM4ICogMTAqKjI0LCAxMDUwKTsKICAgICAgcGhhc2VzWzZdID0gUGhhc2UoNDcgKiAxMCoqMjQsIDEwMzApOwogICAgICBwaGFzZXNbN10gPSBQaGFzZSg1NiAqIDEwKioyNCwgMTAwMCk7CiAgICAgIHBoYXNlc1s4XSA9IFBoYXNlKDY1ICogMTAqKjI0LCAxMDAwKTsKICB9CgogIGZ1bmN0aW9uICgpIGV4dGVybmFsIHBheWFibGUgewogICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwogIH0KCiAgLyoKICAgIGNvbnRyYWN0IGZvciB0ZWFtcyB0b2tlbnMgbG9ja3VwCiAgKi8KICBmdW5jdGlvbiBzZXRUZWFtVG9rZW5Ib2xkZXIoYWRkcmVzcyBfdGVhbVRva2VuSG9sZGVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUoX3RlYW1Ub2tlbkhvbGRlciAhPSBhZGRyZXNzKDApKTsKICAgIC8vIHNob3VsZCBhbGxvdyBzZXQgb25seSBvbmNlCiAgICByZXF1aXJlKHRlYW1Ub2tlbkhvbGRlciA9PSBhZGRyZXNzKDApKTsKICAgIHRlYW1Ub2tlbkhvbGRlciA9IF90ZWFtVG9rZW5Ib2xkZXI7CiAgfQoKICBmdW5jdGlvbiBidXlUb2tlbnMoYWRkcmVzcyBfYmVuZWZpY2lhcnkpIHB1YmxpYyBwYXlhYmxlIHsKICAgIF9wcm9jZXNzVG9rZW5zUHVyY2hhc2UoX2JlbmVmaWNpYXJ5LCBtc2cudmFsdWUpOwogIH0KCiAgLyoKICAgIEl0IG1heSBiZSBuZWVkZWQgdG8gYXNzaWduIHRva2VucyBpbiBiYXRjaGVzIGlmIG11bHRpcGxlIGNsaWVudHMgaW52ZXN0ZWQKICAgIGluIGFueSBvdGhlciBjcnlwdG8gY3VycmVuY3kuCiAgICBOT1RFOiB0aGlzIHdpbGwgZmFpbCBpZiB0aGVyZSBhcmUgbm90IGVub3VnaCB0b2tlbnMgbGVmdCBmb3IgYXQgbGVhc3Qgb25lIGludmVzdG9yLgogICAgICAgIGZvciB0aGlzIHRvIHdvcmsgYWxsIGludmVzdG9ycyBtdXN0IGdldCBhbGwgdGhlaXIgdG9rZW5zLgogICovCiAgZnVuY3Rpb24gYXNzaWduVG9rZW5zVG9NdWx0aXBsZUludmVzdG9ycyhhZGRyZXNzW10gX2JlbmVmaWNpYXJpZXMsIHVpbnQyNTZbXSBfdG9rZW5zQW1vdW50KSBvbmx5QXNzZ2luZXIgcHVibGljIHsKICAgIHJlcXVpcmUoX2JlbmVmaWNpYXJpZXMubGVuZ3RoID09IF90b2tlbnNBbW91bnQubGVuZ3RoKTsKICAgIGZvciAodWludCBpID0gMDsgaSA8IF90b2tlbnNBbW91bnQubGVuZ3RoOyBpKyspIHsKICAgICAgX3Byb2Nlc3NUb2tlbnNBc3NnaW4oX2JlbmVmaWNpYXJpZXNbaV0sIF90b2tlbnNBbW91bnRbaV0pOwogICAgfQogIH0KCiAgLyoKICAgIElmIGludmVzdG1lbmQgd2FzIG1hZGUgaW4gYml0Y29pbnMgZXRjLiBvd25lciBjYW4gYXNzaWduIGFwcm9wcmlhdGUgYW1vdW50IG9mCiAgICB0b2tlbnMgdG8gdGhlIGludmVzdG9yLgogICovCiAgZnVuY3Rpb24gYXNzaWduVG9rZW5zKGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCB1aW50MjU2IF90b2tlbnNBbW91bnQpIG9ubHlBc3NnaW5lciBwdWJsaWMgewogICAgX3Byb2Nlc3NUb2tlbnNBc3NnaW4oX2JlbmVmaWNpYXJ5LCBfdG9rZW5zQW1vdW50KTsKICB9CgogIGZ1bmN0aW9uIGZpbmFsaXplKCkgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKHRlYW1Ub2tlbkhvbGRlciAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoIWlzRmluYWxpemVkKTsKICAgIHJlcXVpcmUoX2hhc0Nsb3NlZCgpKTsKICAgIHJlcXVpcmUoZmluYWxpemVkVGltZSA9PSAwKTsKCiAgICBIYXJkY2FwVG9rZW4gX3Rva2VuID0gSGFyZGNhcFRva2VuKHRva2VuKTsKCiAgICAvLyBhc3NpZ24gZWFjaCBjb3VudGVycGFydHkgdGhlaXIgc2hhcmUKICAgIHVpbnQyNTYgX3Rva2VuQ2FwID0gX3Rva2VuLnRvdGFsU3VwcGx5KCkubXVsKDEwMCkuZGl2KENST1dEU0FMRV9QRVJDRU5UQUdFKTsKICAgIHJlcXVpcmUoX3Rva2VuLm1pbnQodGVhbVRva2VuSG9sZGVyLCBfdG9rZW5DYXAubXVsKFRFQU1fUEVSQ0VOVEFHRSkuZGl2KDEwMCkpKTsKICAgIHJlcXVpcmUoX3Rva2VuLm1pbnQocGxhdGZvcm0sIF90b2tlbkNhcC5tdWwoUExBVEZPUk1fUEVSQ0VOVEFHRSkuZGl2KDEwMCkpKTsKCiAgICAvLyBtaW50IGFuZCBidXJuIGFsbCBsZWZ0b3ZlcnMKICAgIHVpbnQyNTYgX3Rva2Vuc1RvQnVybiA9IF90b2tlbi5jYXAoKS5zdWIoX3Rva2VuLnRvdGFsU3VwcGx5KCkpOwogICAgcmVxdWlyZShfdG9rZW4ubWludChhZGRyZXNzKHRoaXMpLCBfdG9rZW5zVG9CdXJuKSk7CiAgICBfdG9rZW4uYnVybihfdG9rZW5zVG9CdXJuKTsKCiAgICByZXF1aXJlKF90b2tlbi5maW5pc2hNaW50aW5nKCkpOwogICAgX3Rva2VuLnRyYW5zZmVyT3duZXJzaGlwKHdhbGxldCk7CgogICAgRmluYWxpemVkKCk7CgogICAgZmluYWxpemVkVGltZSA9IF9nZXRUaW1lKCk7CiAgICBpc0ZpbmFsaXplZCA9IHRydWU7CiAgfQoKICBmdW5jdGlvbiBfaGFzQ2xvc2VkKCkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gX2dldFRpbWUoKSA+IEZJTkFMX0NMT1NJTkdfVElNRSB8fCB0b2tlbi50b3RhbFN1cHBseSgpID49IElDT19UT0tFTlNfQ0FQOwogIH0KCiAgZnVuY3Rpb24gX3Byb2Nlc3NUb2tlbnNBc3NnaW4oYWRkcmVzcyBfYmVuZWZpY2lhcnksIHVpbnQyNTYgX3Rva2VuQW1vdW50KSBpbnRlcm5hbCB7CiAgICBfcHJlVmFsaWRhdGVBc3NpZ24oX2JlbmVmaWNpYXJ5LCBfdG9rZW5BbW91bnQpOwoKICAgIC8vIGNhbGN1bGF0ZSB0b2tlbiBhbW91bnQgdG8gYmUgY3JlYXRlZAogICAgdWludDI1NiBfbGVmdG93ZXJzID0gMDsKICAgIHVpbnQyNTYgX3Rva2VucyA9IDA7CiAgICB1aW50MjU2IF9jdXJyZW50U3VwcGx5ID0gdG9rZW4udG90YWxTdXBwbHkoKTsKICAgIGJvb2wgX3BoYXNlQ2hhbmdlZCA9IGZhbHNlOwogICAgUGhhc2UgbWVtb3J5IF9waGFzZSA9IHBoYXNlc1twaGFzZV07CgogICAgd2hpbGUgKF90b2tlbkFtb3VudCA+IDAgJiYgX2N1cnJlbnRTdXBwbHkgPCBJQ09fVE9LRU5TX0NBUCkgewogICAgICBfbGVmdG93ZXJzID0gX3BoYXNlLmNhcFRvLnN1YihfY3VycmVudFN1cHBseSk7CiAgICAgIC8vIGNoZWNrIGlmIGl0IGlzIHBvc3NpYmxlIHRvIGFzc2lnbiBtb3JlIHRoYW4gdGhlcmUgaXMgYXZhaWxhYmxlIGluIHRoaXMgcGhhc2UKICAgICAgaWYgKF9sZWZ0b3dlcnMgPCBfdG9rZW5BbW91bnQpIHsKICAgICAgICAgX3Rva2VucyA9IF90b2tlbnMuYWRkKF9sZWZ0b3dlcnMpOwogICAgICAgICBfdG9rZW5BbW91bnQgPSBfdG9rZW5BbW91bnQuc3ViKF9sZWZ0b3dlcnMpOwogICAgICAgICBwaGFzZSA9IHBoYXNlICsgMTsKICAgICAgICAgX3BoYXNlQ2hhbmdlZCA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgIF90b2tlbnMgPSBfdG9rZW5zLmFkZChfdG9rZW5BbW91bnQpOwogICAgICAgICBfdG9rZW5BbW91bnQgPSAwOwogICAgICB9CgogICAgICBfY3VycmVudFN1cHBseSA9IHRva2VuLnRvdGFsU3VwcGx5KCkuYWRkKF90b2tlbnMpOwogICAgICBfcGhhc2UgPSBwaGFzZXNbcGhhc2VdOwogICAgfQoKICAgIHJlcXVpcmUoX3Rva2VucyA+PSBNSU5fVE9LRU5TX1RPX1BVUkNIQVNFIHx8IF9jdXJyZW50U3VwcGx5ID09IElDT19UT0tFTlNfQ0FQKTsKCiAgICAvLyBpZiBwaGFzZSBjaGFuZ2VzIGZvcndhcmQgdGhlIGRhdGUgb2YgdGhlIG5leHQgcGhhc2UgY2hhbmdlIGJ5IDcgZGF5cwogICAgaWYgKF9waGFzZUNoYW5nZWQpIHsKICAgICAgX2NoYW5nZUNsb3NpbmdUaW1lKCk7CiAgICB9CgogICAgcmVxdWlyZShIYXJkY2FwVG9rZW4odG9rZW4pLm1pbnQoX2JlbmVmaWNpYXJ5LCBfdG9rZW5zKSk7CiAgICBUb2tlbkFzc2lnbmVkKG1zZy5zZW5kZXIsIF9iZW5lZmljaWFyeSwgX3Rva2Vucyk7CiAgfQoKICBmdW5jdGlvbiBfcHJvY2Vzc1Rva2Vuc1B1cmNoYXNlKGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCB1aW50MjU2IF93ZWlBbW91bnQpIGludGVybmFsIHsKICAgIF9wcmVWYWxpZGF0ZVB1cmNoYXNlKF9iZW5lZmljaWFyeSwgX3dlaUFtb3VudCk7CgogICAgLy8gY2FsY3VsYXRlIHRva2VuIGFtb3VudCB0byBiZSBjcmVhdGVkCiAgICB1aW50MjU2IF9sZWZ0b3dlcnMgPSAwOwogICAgdWludDI1NiBfd2VpUmVxID0gMDsKICAgIHVpbnQyNTYgX3dlaVNwZW50ID0gMDsKICAgIHVpbnQyNTYgX3Rva2VucyA9IDA7CiAgICB1aW50MjU2IF9jdXJyZW50U3VwcGx5ID0gdG9rZW4udG90YWxTdXBwbHkoKTsKICAgIGJvb2wgX3BoYXNlQ2hhbmdlZCA9IGZhbHNlOwogICAgUGhhc2UgbWVtb3J5IF9waGFzZSA9IHBoYXNlc1twaGFzZV07CgogICAgd2hpbGUgKF93ZWlBbW91bnQgPiAwICYmIF9jdXJyZW50U3VwcGx5IDwgSUNPX1RPS0VOU19DQVApIHsKICAgICAgX2xlZnRvd2VycyA9IF9waGFzZS5jYXBUby5zdWIoX2N1cnJlbnRTdXBwbHkpOwogICAgICBfd2VpUmVxID0gX2xlZnRvd2Vycy5kaXYoX3BoYXNlLnJhdGUpOwogICAgICAvLyBjaGVjayBpZiBpdCBpcyBwb3NzaWJsZSB0byBwdXJjaGFzZSBtb3JlIHRoYW4gdGhlcmUgaXMgYXZhaWxhYmxlIGluIHRoaXMgcGhhc2UKICAgICAgaWYgKF93ZWlSZXEgPCBfd2VpQW1vdW50KSB7CiAgICAgICAgIF90b2tlbnMgPSBfdG9rZW5zLmFkZChfbGVmdG93ZXJzKTsKICAgICAgICAgX3dlaUFtb3VudCA9IF93ZWlBbW91bnQuc3ViKF93ZWlSZXEpOwogICAgICAgICBfd2VpU3BlbnQgPSBfd2VpU3BlbnQuYWRkKF93ZWlSZXEpOwogICAgICAgICBwaGFzZSA9IHBoYXNlICsgMTsKICAgICAgICAgX3BoYXNlQ2hhbmdlZCA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgIF90b2tlbnMgPSBfdG9rZW5zLmFkZChfd2VpQW1vdW50Lm11bChfcGhhc2UucmF0ZSkpOwogICAgICAgICBfd2VpU3BlbnQgPSBfd2VpU3BlbnQuYWRkKF93ZWlBbW91bnQpOwogICAgICAgICBfd2VpQW1vdW50ID0gMDsKICAgICAgfQoKICAgICAgX2N1cnJlbnRTdXBwbHkgPSB0b2tlbi50b3RhbFN1cHBseSgpLmFkZChfdG9rZW5zKTsKICAgICAgX3BoYXNlID0gcGhhc2VzW3BoYXNlXTsKICAgIH0KCiAgICByZXF1aXJlKF90b2tlbnMgPj0gTUlOX1RPS0VOU19UT19QVVJDSEFTRSB8fCBfY3VycmVudFN1cHBseSA9PSBJQ09fVE9LRU5TX0NBUCk7CgogICAgLy8gaWYgcGhhc2UgY2hhbmdlcyBmb3J3YXJkIHRoZSBkYXRlIG9mIHRoZSBuZXh0IHBoYXNlIGNoYW5nZSBieSA3IGRheXMKICAgIGlmIChfcGhhc2VDaGFuZ2VkKSB7CiAgICAgIF9jaGFuZ2VDbG9zaW5nVGltZSgpOwogICAgfQoKICAgIC8vIHJldHVybiBsZWZ0b3ZlcnMgdG8gaW52ZXN0b3IgaWYgdG9rZW5zIGFyZSBvdmVyIGJ1dCBoZSBzZW50IG1vcmUgZWh0ZXJzLgogICAgaWYgKG1zZy52YWx1ZSA+IF93ZWlTcGVudCkgewogICAgICB1aW50MjU2IF9vdmVyZmxvd0Ftb3VudCA9IG1zZy52YWx1ZS5zdWIoX3dlaVNwZW50KTsKICAgICAgX2JlbmVmaWNpYXJ5LnRyYW5zZmVyKF9vdmVyZmxvd0Ftb3VudCk7CiAgICB9CgogICAgd2VpUmFpc2VkID0gd2VpUmFpc2VkLmFkZChfd2VpU3BlbnQpOwoKICAgIHJlcXVpcmUoSGFyZGNhcFRva2VuKHRva2VuKS5taW50KF9iZW5lZmljaWFyeSwgX3Rva2VucykpOwogICAgVG9rZW5QdXJjaGFzZShtc2cuc2VuZGVyLCBfYmVuZWZpY2lhcnksIF93ZWlTcGVudCwgX3Rva2Vucyk7CgogICAgLy8gWW91IGNhbiBhY2Nlc3MgdGhpcyBtZXRob2QgZWl0aGVyIGJ1eWluZyB0b2tlbnMgb3IgYXNzaWduaW5nIHRva2VucyB0bwogICAgLy8gc29tZW9uZS4gSW4gdGhlIHByZXZpb3VzIGNhc2UgeW91IHdvbid0IGJlIHNlbmRpbmcgYW55IGVodGVyIHRvIGNvbnRyYWN0CiAgICAvLyBzbyBubyBuZWVkIHRvIGZvcndhcmQgYW55IGZ1bmRzIHRvIHdhbGxldC4KICAgIGlmIChtc2cudmFsdWUgPiAwKSB7CiAgICAgIHdhbGxldC50cmFuc2Zlcihfd2VpU3BlbnQpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gX3ByZVZhbGlkYXRlUHVyY2hhc2UoYWRkcmVzcyBfYmVuZWZpY2lhcnksIHVpbnQyNTYgX3dlaUFtb3VudCkgaW50ZXJuYWwgewogICAgLy8gaWYgdGhlIHBoYXNlIHRpbWUgZW5kZWQgY2FsY3VsYXRlIG5leHQgcGhhc2UgZW5kIHRpbWUgYW5kIHNldCBuZXcgcGhhc2UKICAgIGlmIChjbG9zaW5nVGltZSA8IF9nZXRUaW1lKCkgJiYgY2xvc2luZ1RpbWUgPCBGSU5BTF9DTE9TSU5HX1RJTUUgJiYgcGhhc2UgPCA4KSB7CiAgICAgIHBoYXNlID0gcGhhc2UuYWRkKF9jYWxjUGhhc2VzUGFzc2VkKCkpOwogICAgICBfY2hhbmdlQ2xvc2luZ1RpbWUoKTsKCiAgICB9CiAgICByZXF1aXJlKF9nZXRUaW1lKCkgPiBJTklUSUFMX1NUQVJUX0RBVEUpOwogICAgcmVxdWlyZShfZ2V0VGltZSgpID49IG9wZW5pbmdUaW1lICYmIF9nZXRUaW1lKCkgPD0gY2xvc2luZ1RpbWUpOwogICAgcmVxdWlyZShfYmVuZWZpY2lhcnkgIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF93ZWlBbW91bnQgIT0gMCk7CiAgICByZXF1aXJlKHBoYXNlIDw9IDgpOwoKICAgIHJlcXVpcmUodG9rZW4udG90YWxTdXBwbHkoKSA8IElDT19UT0tFTlNfQ0FQKTsKICAgIHJlcXVpcmUoIWlzRmluYWxpemVkKTsKICB9CgogIGZ1bmN0aW9uIF9wcmVWYWxpZGF0ZUFzc2lnbihhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludDI1NiBfdG9rZW5BbW91bnQpIGludGVybmFsIHsKICAgIC8vIGlmIHRoZSBwaGFzZSB0aW1lIGVuZGVkIGNhbGN1bGF0ZSBuZXh0IHBoYXNlIGVuZCB0aW1lIGFuZCBzZXQgbmV3IHBoYXNlCiAgICBpZiAoY2xvc2luZ1RpbWUgPCBfZ2V0VGltZSgpICYmIGNsb3NpbmdUaW1lIDwgRklOQUxfQ0xPU0lOR19USU1FICYmIHBoYXNlIDwgOCkgewogICAgICBwaGFzZSA9IHBoYXNlLmFkZChfY2FsY1BoYXNlc1Bhc3NlZCgpKTsKICAgICAgX2NoYW5nZUNsb3NpbmdUaW1lKCk7CgogICAgfQogICAgLy8gc2hvdWxkIG5vdCBhbGxvdyB0byBhc3NpZ24gdG9rZW5zIHRvIHRlYW0gbWVtYmVycwogICAgcmVxdWlyZShfYmVuZWZpY2lhcnkgIT0gYXNzaWduZXIpOwogICAgcmVxdWlyZShfYmVuZWZpY2lhcnkgIT0gcGxhdGZvcm0pOwogICAgcmVxdWlyZShfYmVuZWZpY2lhcnkgIT0gd2FsbGV0KTsKICAgIHJlcXVpcmUoX2JlbmVmaWNpYXJ5ICE9IHRlYW1Ub2tlbkhvbGRlcik7CgogICAgcmVxdWlyZShfZ2V0VGltZSgpID49IG9wZW5pbmdUaW1lICYmIF9nZXRUaW1lKCkgPD0gY2xvc2luZ1RpbWUpOwogICAgcmVxdWlyZShfYmVuZWZpY2lhcnkgIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF90b2tlbkFtb3VudCA+IDApOwogICAgcmVxdWlyZShwaGFzZSA8PSA4KTsKCiAgICByZXF1aXJlKHRva2VuLnRvdGFsU3VwcGx5KCkgPCBJQ09fVE9LRU5TX0NBUCk7CiAgICByZXF1aXJlKCFpc0ZpbmFsaXplZCk7CiAgfQoKICBmdW5jdGlvbiBfY2hhbmdlQ2xvc2luZ1RpbWUoKSBpbnRlcm5hbCB7CiAgICBjbG9zaW5nVGltZSA9IF9nZXRUaW1lKCkgKyA3IGRheXM7CiAgICBpZiAoY2xvc2luZ1RpbWUgPiBGSU5BTF9DTE9TSU5HX1RJTUUpIHsKICAgICAgY2xvc2luZ1RpbWUgPSBGSU5BTF9DTE9TSU5HX1RJTUU7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBfY2FsY1BoYXNlc1Bhc3NlZCgpIGludGVybmFsIHZpZXcgcmV0dXJucyh1aW50MjU2KSB7CiAgICByZXR1cm4gIF9nZXRUaW1lKCkuc3ViKGNsb3NpbmdUaW1lKS5kaXYoNyBkYXlzKS5hZGQoMSk7CiAgfQoKIGZ1bmN0aW9uIF9nZXRUaW1lKCkgaW50ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgIHJldHVybiBub3c7CiB9Cgp9Cgpjb250cmFjdCBUZWFtVG9rZW5Ib2xkZXIgaXMgT3duYWJsZSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIHVpbnQyNTYgcHJpdmF0ZSBMT0NLVVBfVElNRSA9IDI0OyAvLyBpbiBtb250aHMKCiAgSGFyZGNhcENyb3dkc2FsZSBjcm93ZHNhbGU7CiAgSGFyZGNhcFRva2VuIHRva2VuOwogIHVpbnQyNTYgcHVibGljIGNvbGxlY3RlZFRva2VuczsKCiAgZnVuY3Rpb24gVGVhbVRva2VuSG9sZGVyKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9jcm93ZHNhbGUsIGFkZHJlc3MgX3Rva2VuKSBwdWJsaWMgewogICAgb3duZXIgPSBfb3duZXI7CiAgICBjcm93ZHNhbGUgPSBIYXJkY2FwQ3Jvd2RzYWxlKF9jcm93ZHNhbGUpOwogICAgdG9rZW4gPSBIYXJkY2FwVG9rZW4oX3Rva2VuKTsKICB9CgogIC8qCiAgICBAbm90aWNlIFRoZSBEZXYgKE93bmVyKSB3aWxsIGNhbGwgdGhpcyBtZXRob2QgdG8gZXh0cmFjdCB0aGUgdG9rZW5zCiAgKi8KICBmdW5jdGlvbiBjb2xsZWN0VG9rZW5zKCkgcHVibGljIG9ubHlPd25lciB7CiAgICB1aW50MjU2IGJhbGFuY2UgPSB0b2tlbi5iYWxhbmNlT2YoYWRkcmVzcyh0aGlzKSk7CiAgICB1aW50MjU2IHRvdGFsID0gY29sbGVjdGVkVG9rZW5zLmFkZChiYWxhbmNlKTsKCiAgICB1aW50MjU2IGZpbmFsaXplZFRpbWUgPSBjcm93ZHNhbGUuZmluYWxpemVkVGltZSgpOwoKICAgIHJlcXVpcmUoZmluYWxpemVkVGltZSA+IDAgJiYgZ2V0VGltZSgpID49IGZpbmFsaXplZFRpbWUuYWRkKG1vbnRocygzKSkpOwoKICAgIHVpbnQyNTYgY2FuRXh0cmFjdCA9IHRvdGFsLm11bChnZXRUaW1lKCkuc3ViKGZpbmFsaXplZFRpbWUpKS5kaXYobW9udGhzKExPQ0tVUF9USU1FKSk7CgogICAgY2FuRXh0cmFjdCA9IGNhbkV4dHJhY3Quc3ViKGNvbGxlY3RlZFRva2Vucyk7CgogICAgaWYgKGNhbkV4dHJhY3QgPiBiYWxhbmNlKSB7CiAgICAgIGNhbkV4dHJhY3QgPSBiYWxhbmNlOwogICAgfQoKICAgIGNvbGxlY3RlZFRva2VucyA9IGNvbGxlY3RlZFRva2Vucy5hZGQoY2FuRXh0cmFjdCk7CiAgICBhc3NlcnQodG9rZW4udHJhbnNmZXIob3duZXIsIGNhbkV4dHJhY3QpKTsKCiAgICBUb2tlbnNXaXRoZHJhd24ob3duZXIsIGNhbkV4dHJhY3QpOwogIH0KCiAgZnVuY3Rpb24gbW9udGhzKHVpbnQyNTYgbSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgIHJldHVybiBtLm11bCgzMCBkYXlzKTsKICB9CgogIGZ1bmN0aW9uIGdldFRpbWUoKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBub3c7CiAgfQoKICAvKgogICAgIFNhZmV0eSBNZXRob2RzCiAgKi8KCiAgLyoKICAgICBAbm90aWNlIFRoaXMgbWV0aG9kIGNhbiBiZSB1c2VkIGJ5IHRoZSBjb250cm9sbGVyIHRvIGV4dHJhY3QgbWlzdGFrZW5seQogICAgIHNlbnQgdG9rZW5zIHRvIHRoaXMgY29udHJhY3QuCiAgICAgQHBhcmFtIF90b2tlbiBUaGUgYWRkcmVzcyBvZiB0aGUgdG9rZW4gY29udHJhY3QgdGhhdCB5b3Ugd2FudCB0byByZWNvdmVyCiAgICAgc2V0IHRvIDAgaW4gY2FzZSB5b3Ugd2FudCB0byBleHRyYWN0IGV0aGVyLgogICovCiAgZnVuY3Rpb24gY2xhaW1Ub2tlbnMoYWRkcmVzcyBfdG9rZW4pIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShfdG9rZW4gIT0gYWRkcmVzcyh0b2tlbikpOwogICAgaWYgKF90b2tlbiA9PSAweDApIHsKICAgICAgb3duZXIudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIEhhcmRjYXBUb2tlbiBfaGFyZGNhcFRva2VuID0gSGFyZGNhcFRva2VuKF90b2tlbik7CiAgICB1aW50MjU2IGJhbGFuY2UgPSBfaGFyZGNhcFRva2VuLmJhbGFuY2VPZih0aGlzKTsKICAgIF9oYXJkY2FwVG9rZW4udHJhbnNmZXIob3duZXIsIGJhbGFuY2UpOwogICAgQ2xhaW1lZFRva2VucyhfdG9rZW4sIG93bmVyLCBiYWxhbmNlKTsKICB9CgogIGV2ZW50IENsYWltZWRUb2tlbnMoYWRkcmVzcyBpbmRleGVkIF90b2tlbiwgYWRkcmVzcyBpbmRleGVkIF9jb250cm9sbGVyLCB1aW50MjU2IF9hbW91bnQpOwogIGV2ZW50IFRva2Vuc1dpdGhkcmF3bihhZGRyZXNzIGluZGV4ZWQgX2hvbGRlciwgdWludDI1NiBfYW1vdW50KTsKfQ=='.
	

]
