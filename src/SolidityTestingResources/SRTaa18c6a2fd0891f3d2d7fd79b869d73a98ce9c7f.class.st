Class {
	#name : #SRTaa18c6a2fd0891f3d2d7fd79b869d73a98ce9c7f,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTaa18c6a2fd0891f3d2d7fd79b869d73a98ce9c7f >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7CgoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKCgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9CgppbnRlcmZhY2UgVG9rZW4gewogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7CiAgICBmdW5jdGlvbiBkZWNpbWFscygpcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwp9CgovKioKICogQHRpdGxlIFZhdWx0CiAqIEBkZXYgVGhpcyBjb250cmFjdCBpcyB1c2VkIGZvciBzdG9yaW5nIGZ1bmRzIHdoaWxlIGEgY3Jvd2RzYWxlCiAqIGlzIGluIHByb2dyZXNzLiBGdW5kcyB3aWxsIGJlIHRyYW5zZmVycmVkIHRvIG93bmVyIG9uY2Ugc2FsZSBlbmRzCiAqLwpjb250cmFjdCBWYXVsdCBpcyBPd25hYmxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIGVudW0gU3RhdGUgeyBBY3RpdmUsIENsb3NlZCB9CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgZGVwb3NpdGVkOwogICAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0OwogICAgU3RhdGUgcHVibGljIHN0YXRlOwoKICAgIGV2ZW50IENsb3NlZCgpOwogICAgZXZlbnQgd2l0aGRyYXduKGFkZHJlc3MgX3dhbGxldCk7CiAgICBmdW5jdGlvbiBWYXVsdChhZGRyZXNzIF93YWxsZXQpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfd2FsbGV0ICE9IDB4MCk7CiAgICAgICAgd2FsbGV0ID0gX3dhbGxldDsKICAgICAgICBzdGF0ZSA9IFN0YXRlLkFjdGl2ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZXBvc2l0KGFkZHJlc3MgaW52ZXN0b3IpIHB1YmxpYyBvbmx5T3duZXIgIHBheWFibGUgewogICAgICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuQWN0aXZlKTsKICAgICAgICBkZXBvc2l0ZWRbaW52ZXN0b3JdID0gZGVwb3NpdGVkW2ludmVzdG9yXS5hZGQobXNnLnZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjbG9zZSgpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuQWN0aXZlKTsKICAgICAgICBzdGF0ZSA9IFN0YXRlLkNsb3NlZDsKICAgICAgICBDbG9zZWQoKTsKICAgIH0KCiAgICBmdW5jdGlvbiB3aXRoZHJhd1RvV2FsbGV0KCkgb25seU93bmVyIHB1YmxpY3sKICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuQ2xvc2VkKTsKICAgIHdhbGxldC50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgd2l0aGRyYXduKHdhbGxldCk7CiAgfQp9CgoKY29udHJhY3QgVFJBTlhDcm93ZHNhbGVzIGlzIE93bmFibGV7CiAgICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogICAgICAKICAgICAgLy9Ub2tlbiB0byBiZSB1c2VkIGZvciB0aGlzIHNhbGUKICAgICAgVG9rZW4gcHVibGljIHRva2VuOwogICAgICAKICAgICAgLy9BbGwgZnVuZHMgd2lsbCBnbyBpbnRvIHRoaXMgdmF1bHQKICAgICAgVmF1bHQgcHVibGljIHZhdWx0OwogICAgICAKICAgICAgLy9Ub3RhbCB0b2tlbnMgd2hpY2ggaXMgb24gZm9yIHNhbGUKICAgICAgdWludDI1NiBwdWJsaWMgY3Jvd2RTYWxlSGFyZENhcDsKICAgICAgCiAgICAgIAogICAgICAvL1RoZXJlIGNhbiBiZSA1IHRpZXJzIGFuZCBpdCB3aWxsIGNvbnRhaW4gaW5mbyBhYm91dCBlYWNoIHRpZXIKICAgICAgc3RydWN0IFRpZXJJbmZvewogICAgICAgICAgdWludDI1NiBoYXJkY2FwOwogICAgICAgICAgdWludDI1NiBzdGFydFRpbWU7CiAgICAgICAgICB1aW50MjU2IGVuZFRpbWU7CiAgICAgICAgICB1aW50MjU2IHJhdGU7CiAgICAgICAgICB1aW50OCBib251c1BlcmNlbnRhZ2U7CiAgICAgICAgICB1aW50MjU2IHdlaVJhaXNlZDsKICAgICAgfQogICAgICAKICAgICAgLy9pbmZvIG9mIGVhY2ggdGllcgogICAgICBUaWVySW5mb1tdIHB1YmxpYyB0aWVyczsKICAgICAgCiAgICAgIC8vVG90YWwgZnVuZGluZwogICAgICB1aW50MjU2IHB1YmxpYyB0b3RhbEZ1bmRpbmc7CiAgICAgIAogICAgICB1aW50OCBwdWJsaWMgbm9PZlRpZXJzOwogICAgICAKICAgICAgdWludDI1NiBwdWJsaWMgdG9rZW5zU29sZDsKICAgIAogICAgICAvL0tlZXAgdHJhY2sgd2hldGhlciBzYWxlcyBpcyBhY3RpdmUgb3Igbm90CiAgICAgIGJvb2wgcHVibGljIHNhbGVzQWN0aXZlOwogICAgICAKICAgICAgLy9LZWVwIHRyYWNrIG9mIHdoZXRoZXIgdGhlIHNhbGUgaGFzIGVuZGVkIG9yIG5vdAogICAgICBib29sIHB1YmxpYyBzYWxlRW5kZWQ7CiAgICAgIAogICAgICBib29sIHB1YmxpYyB1bnNwZW50Q3JlZGl0c1dpdGhkcmF3bjsKICAgICAgCiAgICAgIC8vdG8gbWFrZSBzdXJlIGNvbnRyYWN0IGlzIHBvd2VyZWR1cCBvbmx5IG9uY2UKICAgICAgYm9vbCBjb250cmFjdFBvd2VyZWRVcCA9IGZhbHNlOwogICAgICAKICAgICAgLy9FdmVudCB0byB0cmlnZ2VyIFNhbGUgc3RvcAogICAgICBldmVudCBTYWxlU3RvcHBlZChhZGRyZXNzIF9vd25lciwgdWludDI1NiB0aW1lKTsKICAgICAgCiAgICAgIC8vRXZlbnQgdG8gdHJpZ2dlciBub3JtYWwgZmxvdyBvZiBzYWxlIGVuZAogICAgICBldmVudCBGaW5hbGl6ZWQoYWRkcmVzcyBfb3duZXIsIHVpbnQyNTYgdGltZSk7CiAgICAKICAgICAvKioKICAgICAqIGV2ZW50IGZvciB0b2tlbiBwdXJjaGFzZSBsb2dnaW5nCiAgICAgKiBAcGFyYW0gcHVyY2hhc2VyIHdobyBwYWlkIGZvciB0aGUgdG9rZW5zCiAgICAgKiBAcGFyYW0gYmVuZWZpY2lhcnkgd2hvIGdvdCB0aGUgdG9rZW5zCiAgICAgKiBAcGFyYW0gdmFsdWUgd2VpcyBwYWlkIGZvciBwdXJjaGFzZQogICAgICogQHBhcmFtIGFtb3VudCBhbW91bnQgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAgICovCiAgICAgZXZlbnQgVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgdmFsdWUsIHVpbnQyNTYgYW1vdW50KTsKICAgIAogICAgLy9tb2RpZmllcnMgICAgCiAgICBtb2RpZmllciBfc2FsZUFjdGl2ZSgpewogICAgICAgIHJlcXVpcmUoc2FsZXNBY3RpdmUpOwogICAgICAgIF87CiAgICB9CiAgCiAgICAgbW9kaWZpZXIgbm9uWmVyb0FkZHJlc3MoYWRkcmVzcyBfdG8pIHsKICAgICAgICByZXF1aXJlKF90byAhPSAweDApOwogICAgICAgIF87CiAgICB9CiAgICAKICAgIG1vZGlmaWVyIG5vblplcm9FdGgoKSB7CiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPiAwKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICBtb2RpZmllciBfc2FsZUVuZGVkKCkgewogICAgICAgIHJlcXVpcmUoc2FsZUVuZGVkKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICBtb2RpZmllciB0aWVyc0VtcHR5KCl7CiAgICAgICAgcmVxdWlyZShub09mVGllcnM9PTApOwogICAgICAgIF87CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIFRSQU5YQ3Jvd2RzYWxlcyhhZGRyZXNzIF90b2tlblRvQmVVc2VkLCBhZGRyZXNzIF93YWxsZXQpcHVibGljIG5vblplcm9BZGRyZXNzKF90b2tlblRvQmVVc2VkKSBub25aZXJvQWRkcmVzcyhfd2FsbGV0KXsKICAgICAgICB0b2tlbiA9IFRva2VuKF90b2tlblRvQmVVc2VkKTsKICAgICAgICB2YXVsdCA9IG5ldyBWYXVsdChfd2FsbGV0KTsKICAgIH0KICAgIAogICAgLyoqCiAgICAqICAgICBAZGV2IENoZWNrIGlmIHNhbGUgY29udHJhY3QgaGFzIGVub3VnaCB0b2tlbnMgb24gaXRzIGFjY291bnQgYmFsYW5jZSAKICAgICogICAgIHRvIHJld2FyZCBhbGwgcG9zc2libGUgcGFydGljaXBhdGlvbnMgd2l0aGluIHNhbGUgcGVyaW9kCiAgICAqLwogICAgZnVuY3Rpb24gcG93ZXJVcENvbnRyYWN0KCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICAKICAgICAgICByZXF1aXJlKCFjb250cmFjdFBvd2VyZWRVcCk7CiAgICAgICAgCiAgICAgICAgLy8gQ29udHJhY3Qgc2hvdWxkIG5vdCBiZSBwb3dlcmVkIHVwIHByZXZpb3VzbHkKICAgICAgICByZXF1aXJlKCFzYWxlc0FjdGl2ZSk7CgogICAgICAgIC8vIENvbnRyYWN0IHNob3VsZCBoYXZlIGVub3VnaCBQYXJzZWMgY3JlZGl0cwogICAgICAgIHJlcXVpcmUodG9rZW4uYmFsYW5jZU9mKHRoaXMpID49IGNyb3dkU2FsZUhhcmRDYXApOwogICAgICAgIAogICAgICAgIC8vY2hlY2sgd2hldGhlciB0aWVyIGluZm9ybWF0aW9uIGhhcyBiZWVuIGVudGVyZWQKICAgICAgICByZXF1aXJlKG5vT2ZUaWVycz4wICYmIHRpZXJzLmxlbmd0aD09bm9PZlRpZXJzKTsKICAgICAgCiAgICAgICAgLy9hY3RpdmF0ZSB0aGUgc2FsZSBwcm9jZXNzCiAgICAgICAgc2FsZXNBY3RpdmU9dHJ1ZTsKICAgICAgICAKICAgICAgICBjb250cmFjdFBvd2VyZWRVcCA9IHRydWU7CiAgICB9CiAgICAKICAgIC8vZm9yIEVtZXJnZW5jeSBzdG9wIG9mIHRoZSBzYWxlCiAgICBmdW5jdGlvbiBlbWVyZ2VuY3lTdG9wKCkgcHVibGljIG9ubHlPd25lciBfc2FsZUFjdGl2ZXsKICAgICAgICBzYWxlc0FjdGl2ZSA9IGZhbHNlOwogICAgICAgIHNhbGVFbmRlZCA9IHRydWU7ICAgIAogICAgICAgIHZhdWx0LmNsb3NlKCk7CiAgICAgICAgU2FsZVN0b3BwZWQobXNnLnNlbmRlciwgbm93KTsKICAgIH0KICAgIAogICAgLyoqCiAgICogQGRldiBNdXN0IGJlIGNhbGxlZCBhZnRlciBzYWxlIGVuZHMsIHRvIGRvIHNvbWUgZXh0cmEgZmluYWxpemF0aW9uCiAgICogd29yay4gQ2FsbHMgdGhlIGNvbnRyYWN0J3MgZmluYWxpemF0aW9uIGZ1bmN0aW9uLgogICAqLwogICAgZnVuY3Rpb24gZmluYWxpemUoKXB1YmxpYyBvbmx5T3duZXIgX3NhbGVBY3RpdmV7CiAgICAgICAgcmVxdWlyZShzYWxlVGltZU92ZXIoKSk7CiAgICAgICAgc2FsZXNBY3RpdmUgPSBmYWxzZTsKICAgICAgICBzYWxlRW5kZWQgPSB0cnVlOwogICAgICAgIHZhdWx0LmNsb3NlKCk7CiAgICAgICAgRmluYWxpemVkKG1zZy5zZW5kZXIsIG5vdyk7CiAgICB9CiAgICAKICAgICAgLy8gQHJldHVybiB0cnVlIGlmIGFsbCB0aGUgdGllcnMgaGFzIGJlZW4gZW5kZWQKICBmdW5jdGlvbiBzYWxlVGltZU92ZXIoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgIGlmKG5vT2ZUaWVycz09MCl7CiAgICAgICAgICAvL3NpbmNlIG5vIHRpZXJzIGhhcyBiZWVuIHByb3ZpZGVkIHlldCwgaGVuY2Ugc2FsZXMgaGFzIG5vdCBzdGFydGVkIHRvIGVuZAogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIC8vSWYgbGFzdCB0aWVyIGhhcyBlbmRlZCwgaXQgbWVhbiBhbGwgdGllcnMgYXJlIGZpbmlzaGVkCiAgICByZXR1cm4gbm93ID4gdGllcnNbbm9PZlRpZXJzLTFdLmVuZFRpbWU7CiAgfQogIAogICAgLy9pZiBjcm93ZHNhbGVzIGlzIG92ZXIsIHRoZSBtb25leSByYXNpZWQgc2hvdWxkIGJlIHRyYW5zZmVycmVkIHRvIHRoZSB3YWxsZXQgYWRkcmVzcwogIGZ1bmN0aW9uIHdpdGhkcmF3RnVuZHMoKSBwdWJsaWMgb25seU93bmVyIF9zYWxlRW5kZWR7CiAgCiAgICAgIHZhdWx0LndpdGhkcmF3VG9XYWxsZXQoKTsKICB9CiAgCiAgLyoqCiAgKiBAZGV2IENhbiBiZSBjYWxsZWQgb25seSBvbmNlLiBUaGUgbWV0aG9kIHRvIGFsbG93IG93bmVyIHRvIHNldCB0aWVyIGluZm9ybWF0aW9uCiAgKiBAcGFyYW0gX25vT2ZUaWVycyBUaGUgaW50ZWdlciB0byBzZXQgbnVtYmVyIG9mIHRpZXJzCiAgKiBAcGFyYW0gX3N0YXJ0VGltZXMgVGhlIGFycmF5IGNvbnRhaW5pbmcgc3RhcnQgdGltZSBvZiBlYWNoIHRpZXIKICAqIEBwYXJhbSBfZW5kVGltZXMgVGhlIGFycmF5IGNvbnRhaW5pbmcgZW5kIHRpbWUgb2YgZWFjaCB0aWVyCiAgKiBAcGFyYW0gX2hhcmRDYXBzIFRoZSBhcnJheSBjb250YWluaW5nIGhhcmQgY2FwIGZvciBlYWNoIHRpZXIKICAqIEBwYXJhbSBfcmF0ZXMgVGhlIGFycmF5IGNvbnRhaW5pbmcgbnVtYmVyIG9mIHRva2VucyBwZXIgZXRoZXIgZm9yIGVhY2ggdGllcgogICogQHBhcmFtIF9ib251c1BlcmNlbnRhZ2VzIFRoZSBhcnJheSBjb250YWluaW5nIGJvbnVzIHBlcmNlbnRhZ2UgZm9yIGVhY2ggdGllcgogICogVGhlIGFycmF5cyBzaG91bGQgYmUgaW4gc3luYyB3aXRoIGVhY2ggb3RoZXIuIEZvciBlYWNoIGluZGV4IDAgZm9yIGVhY2ggb2YgdGhlIGFycmF5IHNob3VsZCBjb250YWluIGluZm8gYWJvdXQgVGllciAxLCBzaW1pbGFybHkgZm9yIFRpZXIyLCAzLDQgYW5kIDUuCiAgKiBTYWxlcyBoYXJkIGNhcCB3aWxsIGJlIHRoZSBoYXJkIGNhcCBvZiBsYXN0IHRpZXIKICAqLwogIGZ1bmN0aW9uIHNldFRpZXJzSW5mbyh1aW50OCBfbm9PZlRpZXJzLCB1aW50MjU2W10gX3N0YXJ0VGltZXMsIHVpbnQyNTZbXSBfZW5kVGltZXMsIHVpbnQyNTZbXSBfaGFyZENhcHMsIHVpbnQyNTZbXSBfcmF0ZXMsIHVpbnQ4W10gX2JvbnVzUGVyY2VudGFnZXMpcHVibGljIG9ubHlPd25lciB0aWVyc0VtcHR5ewogICAgCiAgICAvL01pbmltdSBudW1iZXIgb2YgdGllcnMgc2hvdWxkIGJlIDEgYW5kIGxlc3MgdGhhbiBvciBlcXVhbCB0byA1CiAgICByZXF1aXJlKF9ub09mVGllcnM+PTEgJiYgX25vT2ZUaWVyczw9NSk7CiAgICAKICAgIC8vRWFjaCBhcnJheSBzaG91bGQgY29udGFpbiBpbmZvIGFib3V0IGVhY2ggdGllcgogICAgcmVxdWlyZShfc3RhcnRUaW1lcy5sZW5ndGggPT0gX25vT2ZUaWVycyk7CiAgICByZXF1aXJlKF9lbmRUaW1lcy5sZW5ndGg9PV9ub09mVGllcnMpOwogICAgcmVxdWlyZShfaGFyZENhcHMubGVuZ3RoPT1fbm9PZlRpZXJzKTsKICAgIHJlcXVpcmUoX3JhdGVzLmxlbmd0aD09X25vT2ZUaWVycyk7CiAgICByZXF1aXJlKF9ib251c1BlcmNlbnRhZ2VzLmxlbmd0aD09X25vT2ZUaWVycyk7CiAgICAKICAgIG5vT2ZUaWVycyA9IF9ub09mVGllcnM7CiAgICAKICAgIGZvcih1aW50OCBpPTA7aTxub09mVGllcnM7aSsrKXsKICAgICAgICByZXF1aXJlKF9oYXJkQ2Fwc1tpXT4wKTsKICAgICAgICByZXF1aXJlKF9lbmRUaW1lc1tpXT5fc3RhcnRUaW1lc1tpXSk7CiAgICAgICAgcmVxdWlyZShfcmF0ZXNbaV0+MCk7CiAgICAgICAgcmVxdWlyZShfYm9udXNQZXJjZW50YWdlc1tpXT4wKTsKICAgICAgICBpZihpPjApewogICAgICAgICAgICAKICAgICAgICAgICAgLy9jaGVjayBoYXJkIGNhcCBmb3IgdGhpcyB0aWVyIHNob3VsZCBiZSBncmVhdGVyIHRoYW4gdGhlIHByZXZpb3VzIHRpZXIKICAgICAgICAgICAgcmVxdWlyZShfaGFyZENhcHNbaV0gPiBfaGFyZENhcHNbaS0xXSk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvL3N0YXJ0IHRpbWUgb2YgdGhpcyB0aWVyIHNob3VsZCBiZSBncmVhdGVyIHRoYW4gcHJldmlvdXMgdGllcgogICAgICAgICAgICByZXF1aXJlKF9zdGFydFRpbWVzW2ldPl9lbmRUaW1lc1tpLTFdKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHRpZXJzLnB1c2goVGllckluZm8oewogICAgICAgICAgICAgICAgaGFyZGNhcDpfaGFyZENhcHNbaV0ubXVsKCAxMCAqKiB1aW50MjU2KHRva2VuLmRlY2ltYWxzKCkpKSwKICAgICAgICAgICAgICAgIHN0YXJ0VGltZTpfc3RhcnRUaW1lc1tpXSwKICAgICAgICAgICAgICAgIGVuZFRpbWU6X2VuZFRpbWVzW2ldLAogICAgICAgICAgICAgICAgcmF0ZTpfcmF0ZXNbaV0sCiAgICAgICAgICAgICAgICBib251c1BlcmNlbnRhZ2U6X2JvbnVzUGVyY2VudGFnZXNbaV0sCiAgICAgICAgICAgICAgICB3ZWlSYWlzZWQ6MAogICAgICAgICAgICB9KSk7CiAgICAgICAgfQogICAgICAgIGVsc2V7CiAgICAgICAgICAgIC8vc3RhcnQgdGltZSBvZiB0aWVyMSBzaG91bGQgYmUgZ3JlYXRlciB0aGFuIGN1cnJlbnQgdGltZQogICAgICAgICAgICByZXF1aXJlKF9zdGFydFRpbWVzW2ldPm5vdyk7CiAgICAgICAgICAKICAgICAgICAgICAgdGllcnMucHVzaChUaWVySW5mbyh7CiAgICAgICAgICAgICAgICBoYXJkY2FwOl9oYXJkQ2Fwc1tpXS5tdWwoIDEwICoqIHVpbnQyNTYodG9rZW4uZGVjaW1hbHMoKSkpLCAvL211bHRpcGx5aW5nIHdpdGggZGVjaW1hbCBwbGFjZXMuIFNvIGlmIGhhcmQgY2FwIGlzIHNldCB0byAxIGl0IGlzIGFjdHVhbGx5IHNldCB0byAxICogMTBeZGVjaW1hbHMKICAgICAgICAgICAgICAgIHN0YXJ0VGltZTpfc3RhcnRUaW1lc1tpXSwKICAgICAgICAgICAgICAgIGVuZFRpbWU6X2VuZFRpbWVzW2ldLAogICAgICAgICAgICAgICAgcmF0ZTpfcmF0ZXNbaV0sCiAgICAgICAgICAgICAgICBib251c1BlcmNlbnRhZ2U6X2JvbnVzUGVyY2VudGFnZXNbaV0sCiAgICAgICAgICAgICAgICB3ZWlSYWlzZWQ6MAogICAgICAgICAgICB9KSk7CiAgICAgICAgfQogICAgfQogICAgY3Jvd2RTYWxlSGFyZENhcCA9IF9oYXJkQ2Fwc1tub09mVGllcnMtMV0ubXVsKCAxMCAqKiB1aW50MjU2KHRva2VuLmRlY2ltYWxzKCkpKTsKICB9CiAgICAKICAgIC8qKgogICAgKiBAZGV2IEFsbG93cyBvd25lciB0byB0cmFuc2ZlciB1bnNvbGQgdG9rZW5zIHRvIGhpcy9oZXIgYWRkcmVzcwogICAgKiBUaGlzIG1ldGhvZCBzaG91bGQgb25seSBiZSBjYWxsZWQgb25jZSB0aGUgc2FsZSBoYXMgYmVlbiBzdG9wcGVkL2VuZGVkCiAgICAqLwogICBmdW5jdGlvbiBvd25lcldpdGhkcmF3VW5zcGVudENyZWRpdHMoKXB1YmxpYyBvbmx5T3duZXIgX3NhbGVFbmRlZHsKICAgICAgICByZXF1aXJlKCF1bnNwZW50Q3JlZGl0c1dpdGhkcmF3bik7CiAgICAgICAgdW5zcGVudENyZWRpdHNXaXRoZHJhd24gPSB0cnVlOwogICAgICAgIHRva2VuLnRyYW5zZmVyKG93bmVyLCB0b2tlbi5iYWxhbmNlT2YodGhpcykpOwogICB9CiAgIAogICAvL0ZhbGxiYWNrIGZ1bmN0aW9uIHVzZWQgdG8gYnV5dG9rZW5zCiAgIGZ1bmN0aW9uKClwdWJsaWMgcGF5YWJsZXsKICAgICAgIGJ1eVRva2Vucyhtc2cuc2VuZGVyKTsKICAgfQogICAKICAgLyoqCiAgICogQGRldiBMb3cgbGV2ZWwgdG9rZW4gcHVyY2hhc2UgZnVuY3Rpb24KICAgKiBAcGFyYW0gYmVuZWZpY2lhcnkgVGhlIGFkZHJlc3Mgd2hvIHdpbGwgcmVjZWl2ZSB0aGUgdG9rZW5zIGZvciB0aGlzIHRyYW5zYWN0aW9uCiAgICovCiAgIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KXB1YmxpYyBfc2FsZUFjdGl2ZSBub25aZXJvRXRoIG5vblplcm9BZGRyZXNzKGJlbmVmaWNpYXJ5KSBwYXlhYmxlIHJldHVybnMoYm9vbCl7CiAgICAgICAKICAgICAgIGludDggY3VycmVudFRpZXJJbmRleCA9IGdldEN1cnJlbnRseVJ1bm5pbmdUaWVyKCk7CiAgICAgICBhc3NlcnQoY3VycmVudFRpZXJJbmRleD49MCk7CiAgICAgICAKICAgICAgIFRpZXJJbmZvIHN0b3JhZ2UgY3VycmVudGx5UnVubmluZ1RpZXIgPSB0aWVyc1t1aW50MjU2KGN1cnJlbnRUaWVySW5kZXgpXTsKICAgICAgIAogICAgICAgLy9oYXJkIGNhcCBmb3IgdGhpcyB0aWVyIGhhcyBub3QgYmVlbiByZWFjaGVkCiAgICAgICByZXF1aXJlKHRva2Vuc1NvbGQgPCBjdXJyZW50bHlSdW5uaW5nVGllci5oYXJkY2FwKTsKICAgICAgIAogICAgICAgdWludDI1NiB3ZWlBbW91bnQgPSBtc2cudmFsdWU7CiAgICAgICAKICAgICAgIHVpbnQyNTYgdG9rZW5zID0gd2VpQW1vdW50Lm11bChjdXJyZW50bHlSdW5uaW5nVGllci5yYXRlKTsKICAgICAgIAogICAgICAgdWludDI1NiBib251c2VkVG9rZW5zID0gYXBwbHlCb251cyh0b2tlbnMsIGN1cnJlbnRseVJ1bm5pbmdUaWVyLmJvbnVzUGVyY2VudGFnZSk7CiAgICAgICAKICAgICAgIC8vVG90YWwgdG9rZW5zIHNvbGQgaW5jbHVkaW5nIGN1cnJlbnQgc2FsZSBzaG91bGQgYmUgbGVzcyB0aGFuIGhhcmQgY2FwIG9mIHRoaXMgdGllcgogICAgICAgYXNzZXJ0KHRva2Vuc1NvbGQuYWRkKGJvbnVzZWRUb2tlbnMpIDw9IGN1cnJlbnRseVJ1bm5pbmdUaWVyLmhhcmRjYXApOwogICAgICAgCiAgICAgICB0b2tlbnNTb2xkID0gdG9rZW5zU29sZC5hZGQoYm9udXNlZFRva2Vucyk7CiAgICAgICAKICAgICAgIHRvdGFsRnVuZGluZyA9IHRvdGFsRnVuZGluZy5hZGQod2VpQW1vdW50KTsKICAgICAgIAogICAgICAgY3VycmVudGx5UnVubmluZ1RpZXIud2VpUmFpc2VkID0gY3VycmVudGx5UnVubmluZ1RpZXIud2VpUmFpc2VkLmFkZCh3ZWlBbW91bnQpOwogICAgICAgdmF1bHQuZGVwb3NpdC52YWx1ZShtc2cudmFsdWUpKG1zZy5zZW5kZXIpOwogICAgICAgdG9rZW4udHJhbnNmZXIoYmVuZWZpY2lhcnksIGJvbnVzZWRUb2tlbnMpOwogICAgICAgVG9rZW5QdXJjaGFzZShtc2cuc2VuZGVyLCBiZW5lZmljaWFyeSwgd2VpQW1vdW50LCBib251c2VkVG9rZW5zKTsKICAgICAgIAogICB9CiAgIAogICAgIGZ1bmN0aW9uIGFwcGx5Qm9udXModWludDI1NiB0b2tlbnMsIHVpbnQ4IHBlcmNlbnQpIGludGVybmFsIHB1cmUgcmV0dXJucyAgKHVpbnQyNTYgYm9udXNlZFRva2VucykgewogICAgICAgIHVpbnQyNTYgdG9rZW5zVG9BZGQgPSB0b2tlbnMubXVsKHBlcmNlbnQpLmRpdigxMDApOwogICAgICAgIHJldHVybiB0b2tlbnMuYWRkKHRva2Vuc1RvQWRkKTsKICAgIH0KICAgIAogICAvKioKICAgICogQGRldiByZXR1cm5zIHRoZSBjdXJyZW50bHkgcnVubmluZyB0aWVyIGluZGV4IGFzIHBlciB0aW1lCiAgICAqIFJldHVybiAtMSBpZiBubyB0aWVyIGlzIHJ1bm5pbmcgY3VycmVudGx5CiAgICAqICovCiAgIGZ1bmN0aW9uIGdldEN1cnJlbnRseVJ1bm5pbmdUaWVyKClwdWJsaWMgdmlldyByZXR1cm5zKGludDgpewogICAgICBmb3IodWludDggaT0wO2k8bm9PZlRpZXJzO2krKyl7CiAgICAgICAgICBpZihub3c+PXRpZXJzW2ldLnN0YXJ0VGltZSAmJiBub3c8dGllcnNbaV0uZW5kVGltZSl7CiAgICAgICAgICAgICAgcmV0dXJuIGludDgoaSk7CiAgICAgICAgICB9CiAgICAgIH0gICAKICAgICAgcmV0dXJuIC0xOwogICB9CiAgIAogICAvKioKICAgKiBAZGV2IEdldCBmdW5jdGluZyBpbmZvIG9mIHVzZXIvYWRkcmVzcy4gSXQgd2lsbCByZXR1cm4gaG93IG11Y2ggZnVuZGluZyB0aGUgdXNlciBoYXMgbWFkZSBpbiB0ZXJtcyBvZiB3ZWkKICAgKi8KICAgZnVuY3Rpb24gZ2V0RnVuZGluZ0luZm9Gb3JVc2VyKGFkZHJlc3MgX3VzZXIpcHVibGljIHZpZXcgbm9uWmVyb0FkZHJlc3MoX3VzZXIpIHJldHVybnModWludDI1Nil7CiAgICAgICByZXR1cm4gdmF1bHQuZGVwb3NpdGVkKF91c2VyKTsKICAgfQogICAKICAgICAgCn0='.
	

]
