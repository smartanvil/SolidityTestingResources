Class {
	#name : #SRT94394EbE010332c5A40d946658779d26dA3aC92B,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT94394EbE010332c5A40d946658779d26dA3aC92B >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7CgovKgoqIExvb2tzQ29pbiB0b2tlbiBzYWxlIGNvbnRyYWN0CioKKiBSZWZlciB0byBodHRwczovL2xvb2tyZXYuY29tL3Rva2Vuc2FsZS8gZm9yIG1vcmUgaW5mb3JtYXRpb24uCiogCiogRGV2ZWxvcGVyOiBMb29rUmV2CioKKi8KCi8qCiAqIEVSQzIwIFRva2VuIFN0YW5kYXJkCiAqLwpjb250cmFjdCBFUkMyMCB7CmV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwpldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKCnVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwpmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwpmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwpmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CmZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKTsKfQoKLyoqCiogUHJvdmlkZXMgbWV0aG9kcyB0byBzYWZlbHkgYWRkLCBzdWJ0cmFjdCBhbmQgbXVsdGlwbHkgdWludDI1NiBudW1iZXJzLgoqLwpjb250cmFjdCBTYWZlTWF0aCB7CiAgICAvKioKICAgICAqIEFkZCB0d28gdWludDI1NiB2YWx1ZXMsIHJldmVydCBpbiBjYXNlIG9mIG92ZXJmbG93LgogICAgICoKICAgICAqIEBwYXJhbSBhIGZpcnN0IHZhbHVlIHRvIGFkZAogICAgICogQHBhcmFtIGIgc2Vjb25kIHZhbHVlIHRvIGFkZAogICAgICogQHJldHVybiBhICsgYgogICAgICovCiAgICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSk7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdWJ0cmFjdCBvbmUgdWludDI1NiB2YWx1ZSBmcm9tIGFub3RoZXIsIHRocm93IGluIGNhc2Ugb2YgdW5kZXJmbG93LgogICAgICoKICAgICAqIEBwYXJhbSBhIHZhbHVlIHRvIHN1YnRyYWN0IGZyb20KICAgICAqIEBwYXJhbSBiIHZhbHVlIHRvIHN1YnRyYWN0CiAgICAgKiBAcmV0dXJuIGEgLSBiCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNhZmVTdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoYSA+PSBiKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgLyoqCiAgICAgKiBNdWx0aXBseSB0d28gdWludDI1NiB2YWx1ZXMsIHRocm93IGluIGNhc2Ugb2Ygb3ZlcmZsb3cuCiAgICAgKgogICAgICogQHBhcmFtIGEgZmlyc3QgdmFsdWUgdG8gbXVsdGlwbHkKICAgICAqIEBwYXJhbSBiIHNlY29uZCB2YWx1ZSB0byBtdWx0aXBseQogICAgICogQHJldHVybiBhICogYgogICAgICovCiAgICBmdW5jdGlvbiBzYWZlTXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgaWYgKGEgPT0gMCB8fCBiID09IDApIHJldHVybiAwOwogICAgICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICAvKioKICAgICAqIERpdmlkIHVpbnQyNTYgdmFsdWVzLCB0aHJvdyBpbiBjYXNlIG9mIG92ZXJmbG93LgogICAgICoKICAgICAqIEBwYXJhbSBhIGZpcnN0IHZhbHVlIG51bWVyYXRvcgogICAgICogQHBhcmFtIGIgc2Vjb25kIHZhbHVlIGRlbm9taW5hdG9yCiAgICAgKiBAcmV0dXJuIGEgLyBiCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNhZmVEaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoYiAhPSAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICAgICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAgICAgYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgICAgICByZXR1cm4gYzsKICAgIH0KfQoKLyoKICAgIFByb3ZpZGVzIHN1cHBvcnQgYW5kIHV0aWxpdGllcyBmb3IgY29udHJhY3Qgb3duZXJzaGlwCiovCmNvbnRyYWN0IE93bmFibGUgewogICAgYWRkcmVzcyBvd25lcjsKICAgIGFkZHJlc3MgbmV3T3duZXI7CgogICAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBBbGxvd3MgZXhlY3V0aW9uIGJ5IHRoZSBvd25lciBvbmx5LgogICAgICovCiAgICBtb2RpZmllciBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIFRyYW5zZmVycmluZyB0aGUgY29udHJhY3Qgb3duZXJzaGlwIHRvIHRoZSBuZXcgb3duZXIuCiAgICAgKgogICAgICogQHBhcmFtIF9uZXdPd25lciBuZXcgY29udHJhY3RvciBvd25lcgogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIF9uZXdPd25lcikgb25seU93bmVyIHsKICAgICAgICBpZiAoX25ld093bmVyICE9IDB4MCkgewogICAgICAgICAgbmV3T3duZXIgPSBfbmV3T3duZXI7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQWNjZXB0IHRoZSBjb250cmFjdCBvd25lcnNoaXAgYnkgdGhlIG5ldyBvd25lci4KICAgICAqCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFjY2VwdE93bmVyc2hpcCgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gbmV3T3duZXIpOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICAgICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgICAgICBuZXdPd25lciA9IDB4MDsKICAgIH0KICAgIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90byk7Cn0KCi8qKgoqIFN0YW5kYXJkIFRva2VuIFNtYXJ0IENvbnRyYWN0CiovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIFNhZmVNYXRoIHsKCiAgICAvKioKICAgICAqIE1hcHBpbmcgZnJvbSBhZGRyZXNzZXMgb2YgdG9rZW4gaG9sZGVycyB0byB0aGUgbnVtYmVycyBvZiB0b2tlbnMgYmVsb25naW5nCiAgICAgKiB0byB0aGVzZSB0b2tlbiBob2xkZXJzLgogICAgICovCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAgIC8qKgogICAgICogTWFwcGluZyBmcm9tIGFkZHJlc3NlcyBvZiB0b2tlbiBob2xkZXJzIHRvIHRoZSBtYXBwaW5nIG9mIGFkZHJlc3NlcyBvZgogICAgICogc3BlbmRlcnMgdG8gdGhlIGFsbG93YW5jZXMgc2V0IGJ5IHRoZXNlIHRva2VuIGhvbGRlcnMgdG8gdGhlc2Ugc3BlbmRlcnMuCiAgICAgKi8KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgaW50ZXJuYWwgYWxsb3dlZDsKCiAgICAvKioKICAgICAqIE1hcHBpbmcgZnJvbSBhZGRyZXNzZXMgb2YgdG9rZW4gaG9sZGVycyB0byB0aGUgbWFwcGluZyBvZiB0b2tlbiBhbW91bnQgc3BlbnQuCiAgICAgKiBVc2UgYnkgdGhlIHRva2VuIGhvbGRlcnMgdG8gc3BlbmQgdGhlaXIgdXRpbGl0eSB0b2tlbnMuCiAgICAgKi8KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgc3BlbnRhbW91bnQ7CgogICAgLyoqCiAgICAgKiBNYXBwaW5nIG9mIHRoZSBhZGRpdGlvbiBvZiB0aGUgYWRkcmVzc2Ugb2YgYnV5ZXJzLgogICAgICovCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIGJ1eWVyQXBwZW5kZWQ7CgogICAgLyoqCiAgICAgKiBNYXBwaW5nIG9mIHRoZSBhZGRpdGlvbiBvZiBhZGRyZXNzZXMgb2YgYnV5ZXJzLgogICAgICovCiAgICBhZGRyZXNzW10gYnV5ZXJzOwoKICAgIC8qKgogICAgICogTWFwcGluZyBvZiB0aGUgYWRkcmVzc2VzIG9mIFZJUCB0b2tlbiBob2xkZXJzLgogICAgICovCiAgICBhZGRyZXNzW10gdmlwczsKCiAgICAvKioKICAgICogTWFwcGluZyBmb3IgVklQIHJhbmsgZm9yIHF1YWxpZmllZCB0b2tlbiBob2xkZXJzCiAgICAqIEhpZ2hlciBWSVAgcmFua2luZyAod2l0aCBlYXJsaWVyIHRpbWVzdGFtcCkgaGFzIGhpZ2hlciBiaWRkaW5nIHByaW9yaXR5IHdoZW4KICAgICogY29tcGV0aW5nIGZvciB0aGUgc2FtZSBwcm9kdWN0IG9yIHNlcnZpY2Ugb24gcGxhdGZvcm0uIAogICAgKiBIaWdoZXIgVklQIHJhbmtpbmcgYWRkcmVzcyBjYW4gb3V0YmlkIG90aGVyIGxvd2VyIHJhbmtpbmcgYWRkcmVzc2VzIG9ubHkgb25jZSBwZXIgCiAgICAqIHNlbGxpbmcgd2luZG93IG9yIHByb21vdGlvbiBwZXJpb2QuCiAgICAqIFVzYWdlIG9mIHRoZSBWSVAgcmFua2luZyBhbmQgYmlkIHByaW9yaXR5IHdpbGwgYmUgZGVzY3JpYmVkIG9uIHRva2VuIHdlYnNpdGUuCiAgICAqLwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSB2aXByYW5rOwoKICAgIC8qKgogICAgICogR2V0IG51bWJlciBvZiB0b2tlbnMgY3VycmVudGx5IGJlbG9uZ2luZyB0byBnaXZlbiBvd25lci4KICAgICAqCiAgICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgdG8gZ2V0IG51bWJlciBvZiB0b2tlbnMgY3VycmVudGx5IGJlbG9uZ2luZyB0byB0aGUKICAgICAqICAgICAgICBvd25lciBvZgogICAgICogQHJldHVybiBudW1iZXIgb2YgdG9rZW5zIGN1cnJlbnRseSBiZWxvbmdpbmcgdG8gdGhlIG93bmVyIG9mIGdpdmVuIGFkZHJlc3MKICAgICAqLwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KCiAgICAvKioKICAgICAqIFRyYW5zZmVyIGdpdmVuIG51bWJlciBvZiB0b2tlbnMgZnJvbSBtZXNzYWdlIHNlbmRlciB0byBnaXZlbiByZWNpcGllbnQuCiAgICAgKgogICAgICogQHBhcmFtIF90byBhZGRyZXNzIHRvIHRyYW5zZmVyIHRva2VucyB0byB0aGUgb3duZXIgb2YKICAgICAqIEBwYXJhbSBfdmFsdWUgbnVtYmVyIG9mIHRva2VucyB0byB0cmFuc2ZlciB0byB0aGUgb3duZXIgb2YgZ2l2ZW4gYWRkcmVzcwogICAgICogQHJldHVybiB0cnVlIGlmIHRva2VucyB3ZXJlIHRyYW5zZmVycmVkIHN1Y2Nlc3NmdWxseSwgZmFsc2Ugb3RoZXJ3aXNlCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gMHgwKTsKICAgICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPCBfdmFsdWUpIHJldHVybiBmYWxzZTsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHNhZmVTdWIoYmFsYW5jZXNbbXNnLnNlbmRlcl0sX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gc2FmZUFkZChiYWxhbmNlc1tfdG9dLF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogVHJhbnNmZXIgZ2l2ZW4gbnVtYmVyIG9mIHRva2VucyBmcm9tIGdpdmVuIG93bmVyIHRvIGdpdmVuIHJlY2lwaWVudC4KICAgICAqCiAgICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyB0byB0cmFuc2ZlciB0b2tlbnMgZnJvbSB0aGUgb3duZXIgb2YKICAgICAqIEBwYXJhbSBfdG8gYWRkcmVzcyB0byB0cmFuc2ZlciB0b2tlbnMgdG8gdGhlIG93bmVyIG9mCiAgICAgKiBAcGFyYW0gX3ZhbHVlIG51bWJlciBvZiB0b2tlbnMgdG8gdHJhbnNmZXIgZnJvbSBnaXZlbiBvd25lciB0byBnaXZlbgogICAgICogICAgICAgIHJlY2lwaWVudAogICAgICogQHJldHVybiB0cnVlIGlmIHRva2VucyB3ZXJlIHRyYW5zZmVycmVkIHN1Y2Nlc3NmdWxseSwgZmFsc2Ugb3RoZXJ3aXNlCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIAogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoX3RvICE9IDB4MCk7CiAgICAgICAgaWYoX2Zyb20gPT0gX3RvKSByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKGJhbGFuY2VzW19mcm9tXSA8IF92YWx1ZSkgcmV0dXJuIGZhbHNlOwogICAgICAgIGlmIChfdmFsdWUgPiBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSkgcmV0dXJuIGZhbHNlOwoKICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBzYWZlU3ViKGJhbGFuY2VzW19mcm9tXSxfdmFsdWUpOwogICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gc2FmZVN1YihhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSxfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBzYWZlQWRkKGJhbGFuY2VzW190b10sX3ZhbHVlKTsKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQWxsb3cgZ2l2ZW4gc3BlbmRlciB0byB0cmFuc2ZlciBnaXZlbiBudW1iZXIgb2YgdG9rZW5zIGZyb20gbWVzc2FnZSBzZW5kZXIuCiAgICAgKgogICAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgdG8gYWxsb3cgdGhlIG93bmVyIG9mIHRvIHRyYW5zZmVyIHRva2VucyBmcm9tCiAgICAgKiAgICAgICAgbWVzc2FnZSBzZW5kZXIKICAgICAqIEBwYXJhbSBfdmFsdWUgbnVtYmVyIG9mIHRva2VucyB0byBhbGxvdyB0byB0cmFuc2ZlcgogICAgICogQHJldHVybiB0cnVlIGlmIHRva2VuIHRyYW5zZmVyIHdhcyBzdWNjZXNzZnVsbHkgYXBwcm92ZWQsIGZhbHNlIG90aGVyd2lzZQogICAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKCiAgICAgICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2AKICAgICAgICAvLyAgYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyBgYXBwcm92ZShfc3BlbmRlciwgMClgIGlmIGl0IGlzIG5vdAogICAgICAgIC8vICBhbHJlYWR5IDAgdG8gbWl0aWdhdGUgdGhlIHJhY2UgY29uZGl0aW9uIGRlc2NyaWJlZCBoZXJlOgogICAgICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgICAgIGlmICgoX3ZhbHVlICE9IDApICYmIChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSAhPSAwKSkgewogICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaWYgKGJhbGFuY2VzW21zZy5zZW5kZXJdIDwgX3ZhbHVlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgfQoKICAgIC8qKgogICAgICogVGVsbCBob3cgbWFueSB0b2tlbnMgZ2l2ZW4gc3BlbmRlciBpcyBjdXJyZW50bHkgYWxsb3dlZCB0byB0cmFuc2ZlciBmcm9tCiAgICAgKiBnaXZlbiBvd25lci4KICAgICAqCiAgICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgdG8gZ2V0IG51bWJlciBvZiB0b2tlbnMgYWxsb3dlZCB0byBiZSB0cmFuc2ZlcnJlZAogICAgICogICAgICAgIGZyb20gdGhlIG93bmVyIG9mCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyB0byBnZXQgbnVtYmVyIG9mIHRva2VucyBhbGxvd2VkIHRvIGJlIHRyYW5zZmVycmVkCiAgICAgKiAgICAgICAgYnkgdGhlIG93bmVyIG9mCiAgICAgKiBAcmV0dXJuIG51bWJlciBvZiB0b2tlbnMgZ2l2ZW4gc3BlbmRlciBpcyBjdXJyZW50bHkgYWxsb3dlZCB0byB0cmFuc2ZlcgogICAgICogICAgICAgICBmcm9tIGdpdmVuIG93bmVyCiAgICAgKi8KICAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IAogICAgICAgIHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgICB9Cn0KCi8qKgogKiBMb29rc0NvaW4gVG9rZW4KICoKICogVklQIHJhbmtpbmcgaXMgcmVjb3JkZWQgYXQgdGhlIHRpbWUgd2hlbiB0aGUgdG9rZW4gaG9sZGluZyBhZGRyZXNzIGZpcnN0IG1lZXQgVklQIGNvaW4gCiAqIGhvbGRpbmcgbGV2ZWwuCiAqIFZJUCByYW5raW5nIGlzIHZhbGlkIGZvciB0aGUgbGlmZXRpbWUgb2YgYSB0b2tlbiB3YWxsZXQgYWRkcmVzcywgYXMgbG9uZyBhcyBpdCBtZWV0cyAKICogVklQIGNvaW4gaG9sZGluZyBsZXZlbC4KICogVklQIHJhbmtpbmcgaXMgdXNlZCB0byBjYWxjdWxhdGUgcHJpb3JpdHkgd2hlbiBjb21wZXRpbmcgd2l0aCBvdGhlciBiaWRzIGZvciB0aGUKICogc2FtZSBwcm9kdWN0IG9yIHNlcnZpY2Ugb24gdGhlIHBsYXRmb3JtLiAKICogSGlnaGVyIFZJUCByYW5raW5nICh3aXRoIGVhcmxpZXIgdGltZXN0YW1wKSBoYXMgaGlnaGVyIHByaW9yaXR5LgogKiBIaWdoZXIgVklQIHJhbmtpbmcgYWRkcmVzcyBjYW4gb3V0YmlkIG90aGVyIGxvd2VyIHJhbmtpbmcgd2FsbGV0IGFkZHJlc3NlIG93bmVycyBvbmx5IG9uY2UKICogcGVyIHNlbGxpbmcgd2luZG93IG9yIHByb21vdGlvbiBwZXJpb2QuCiAqIFVzYWdlIG9mIHRoZSBMb29rc0NvaW4sIFZJUCByYW5raW5nIGFuZCBiaWQgcHJpb3JpdHkgd2lsbCBiZSBkZXNjcmliZWQgb24gdG9rZW4gd2Vic2l0ZS4KICoKICovCmNvbnRyYWN0IExvb2tzQ29pbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDA7CgogICAgLyoqCiAgICAgKiBNaW5pbWl1bSBjb250cmlidXRpb24gdG8gcmVjb3JkIGEgVklQIHJhbmsKICAgICAqIFRva2VuIGhvbGRpbmcgYWRkcmVzcyBuZWVkcyBoYXZlIGF0IGxlYXN0IDI0MDAwIExvb2tzQ29pbiB0byBiZSByYW5rZWQgYXMgVklQCiAgICAgKiBWSVAgcmFuayBjYW4gb25seSBiZSBzZXQgdGhyb3VnaCBwdXJjaGFzaW5nIHRva2VucwogICAgKi8KICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IFZJUF9NSU5JTVVNID0gMjQwMDA7CgogICAgLyoqCiAgICAgKiBJbml0aWFsIG51bWJlciBvZiB0b2tlbnMuCiAgICAgKi8KICAgIHVpbnQyNTYgY29uc3RhbnQgSU5JVElBTF9UT0tFTlNfQ09VTlQgPSAxMDAwMDAwMDA7CgogICAgLyoqCiAgICAgKiBDcm93ZHNhbGUgY29udHJhY3QgYWRkcmVzcy4KICAgICAqLwogICAgYWRkcmVzcyBwdWJsaWMgdG9rZW5TYWxlQ29udHJhY3QgPSAweDA7CgogICAgLyoqCiAgICAgKiBJbml0IFBsYWNlaG9sZGVyCiAgICAgKi8KICAgIGFkZHJlc3MgY29pbm1hc3RlciA9IGFkZHJlc3MoMHgzMzE2OWY0MGQxOGM2YzI1OTA5MDFkYjIzMDAwRDg0MDUyYTExRjU0KTsKCiAgICAvKioKICAgICAqIENyZWF0ZSBuZXcgTG9va3NDb2luIHRva2VuIFNtYXJ0IENvbnRyYWN0LgogICAgICogQ29udHJhY3QgaXMgbmVlZGVkIGluIF90b2tlblNhbGVDb250cmFjdCBhZGRyZXNzLgogICAgICoKICAgICAqIEBwYXJhbSBfdG9rZW5TYWxlQ29udHJhY3Qgb2YgY3Jvd2RzYWxlIGNvbnRyYWN0CiAgICAgKgogICAgICovCiAgICBmdW5jdGlvbiBMb29rc0NvaW4oYWRkcmVzcyBfdG9rZW5TYWxlQ29udHJhY3QpIHsKICAgICAgICBhc3NlcnQoX3Rva2VuU2FsZUNvbnRyYWN0ICE9IDB4MCk7CiAgICAgICAgb3duZXIgPSBjb2lubWFzdGVyOwogICAgICAgIHRva2VuU2FsZUNvbnRyYWN0ID0gX3Rva2VuU2FsZUNvbnRyYWN0OwogICAgICAgIGJhbGFuY2VzW293bmVyXSA9IElOSVRJQUxfVE9LRU5TX0NPVU5UOwogICAgICAgIHRvdGFsU3VwcGx5ID0gSU5JVElBTF9UT0tFTlNfQ09VTlQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgbmFtZSBvZiB0aGlzIHRva2VuLgogICAgICoKICAgICAqIEByZXR1cm4gbmFtZSBvZiB0aGlzIHRva2VuCiAgICAgKi8KICAgIGZ1bmN0aW9uIG5hbWUoKSBjb25zdGFudCByZXR1cm5zIChzdHJpbmcgbmFtZSkgewogICAgICByZXR1cm4gIkxvb2tzQ29pbiI7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgc3ltYm9sIG9mIHRoaXMgdG9rZW4uCiAgICAgKgogICAgICogQHJldHVybiBzeW1ib2wgb2YgdGhpcyB0b2tlbgogICAgICovCiAgICBmdW5jdGlvbiBzeW1ib2woKSBjb25zdGFudCByZXR1cm5zIChzdHJpbmcgc3ltYm9sKSB7CiAgICAgIHJldHVybiAiTE9PS1MiOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBTZXQgbmV3IHNhbGUgbWFuYWdlIGNvbnRyYWN0LgogICAgICogTWF5IG9ubHkgYmUgY2FsbGVkIGJ5IG93bmVyLgogICAgICoKICAgICAqIEBwYXJhbSBfbmV3U2FsZU1hbmFnZUNvbnRyYWN0IG5ldyB0b2tlbiBzYWxlIG1hbmFnZSBjb250cmFjdC4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0U2FsZU1hbmFnZUNvbnRyYWN0KGFkZHJlc3MgX25ld1NhbGVNYW5hZ2VDb250cmFjdCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgYXNzZXJ0KF9uZXdTYWxlTWFuYWdlQ29udHJhY3QgIT0gMHgwKTsKICAgICAgICB0b2tlblNhbGVDb250cmFjdCA9IF9uZXdTYWxlTWFuYWdlQ29udHJhY3Q7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgVklQIHJhbmsgb2YgYSBnaXZlbiBvd25lci4KICAgICAqIFZJUCByYW5raW5nIGlzIHZhbGlkIGZvciB0aGUgbGlmZXRpbWUgb2YgYSB0b2tlbiB3YWxsZXQgYWRkcmVzcywgCiAgICAgKiBhcyBsb25nIGFzIGl0IG1lZXRzIFZJUCBob2xkaW5nIGxldmVsLgogICAgICoKICAgICAqIEBwYXJhbSBfdG8gcGFydGljaXBhbnQgYWRkcmVzcyB0byBnZXQgdGhlIHZpcCByYW5rCiAgICAgKiBAcmV0dXJuIHZpcCByYW5rIG9mIHRoZSBvd25lciBvZiBnaXZlbiBhZGRyZXNzCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFZJUFJhbmsoYWRkcmVzcyBfdG8pIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2IHJhbmspIHsKICAgICAgICBpZiAoYmFsYW5jZXNbX3RvXSA8IFZJUF9NSU5JTVVNKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdmlwcmFua1tfdG9dOwogICAgfQoKICAgIC8qKgogICAgICogQ2hlY2sgYW5kIHVwZGF0ZSBWSVAgcmFuayBvZiBhIGdpdmVuIHRva2VuIGJ1eWVyLgogICAgICogQ29udHJpYnV0aW9uIHRpbWVzdGFtcCBpcyByZWNvcmRlZCBmb3IgVklQIHJhbmsKICAgICAqIFJlY29yZGVkIHRpbWVzdGFtcCBmb3IgVklQIHJhbmtpbmcgc2hvdWxkIGFsd2F5cyBiZSBlYXJsaWVyIHRoYW4gdGhlIGN1cnJlbnQgdGltZQogICAgICoKICAgICAqIEBwYXJhbSBfdG8gYWRkcmVzcyB0byBjaGVjayB0aGUgdmlwIHJhbmsKICAgICAqIEByZXR1cm4gcmFuayB2aXAgcmFuayBvZiB0aGUgb3duZXIgb2YgZ2l2ZW4gYWRkcmVzcyBpZiBhbnkKICAgICAqLwogICAgZnVuY3Rpb24gdXBkYXRlVklQUmFuayhhZGRyZXNzIF90bykgcmV0dXJucyAodWludDI1NiByYW5rKSB7CiAgICAgICAgLy8gQ29udHJpYnV0aW9uIHRpbWVzdGFtcCBpcyByZWNvcmRlZCBmb3IgVklQIHJhbmsKICAgICAgICAvLyBSZWNvcmRlZCB0aW1lc3RhbXAgZm9yIFZJUCByYW5raW5nIHNob3VsZCBhbHdheXMgYmUgZWFybGllciB0aGFuIGN1cnJlbnQgdGltZQogICAgICAgIGlmIChiYWxhbmNlc1tfdG9dID49IFZJUF9NSU5JTVVNICYmIHZpcHJhbmtbX3RvXSA9PSAwKSB7CiAgICAgICAgICAgIHZpcHJhbmtbX3RvXSA9IG5vdzsKICAgICAgICAgICAgdmlwcy5wdXNoKF90byk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB2aXByYW5rW190b107CiAgICB9CgogICAgZXZlbnQgVG9rZW5SZXdhcmRzQWRkZWQoYWRkcmVzcyBpbmRleGVkIHBhcnRpY2lwYW50LCB1aW50MjU2IGJhbGFuY2UpOwogICAgLyoqCiAgICAgKiBSZXdhcmQgcGFydGljaXBhbnQgdGhlIHRva2VucyB0aGV5IHB1cmNoYXNlZCBvciBlYXJuZWQKICAgICAqCiAgICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgdG8gY3JlZGl0IHRva2VucyB0byB0aGUgCiAgICAgKiBAcGFyYW0gX3ZhbHVlIG51bWJlciBvZiB0b2tlbnMgdG8gdHJhbnNmZXIgdG8gZ2l2ZW4gcmVjaXBpZW50CiAgICAgKgogICAgICogQHJldHVybiB0cnVlIGlmIHRva2VucyB3ZXJlIHRyYW5zZmVycmVkIHN1Y2Nlc3NmdWxseSwgZmFsc2Ugb3RoZXJ3aXNlCiAgICAgKi8KICAgIGZ1bmN0aW9uIHJld2FyZFRva2VucyhhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gdG9rZW5TYWxlQ29udHJhY3QgfHwgbXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgYXNzZXJ0KF90byAhPSAweDApOwogICAgICAgIHJlcXVpcmUoX3ZhbHVlID4gMCk7CgogICAgICAgIGJhbGFuY2VzW190b10gPSBzYWZlQWRkKGJhbGFuY2VzW190b10sIF92YWx1ZSk7CiAgICAgICAgdG90YWxTdXBwbHkgPSBzYWZlQWRkKHRvdGFsU3VwcGx5LCBfdmFsdWUpOwogICAgICAgIHVwZGF0ZVZJUFJhbmsoX3RvKTsKICAgICAgICBUb2tlblJld2FyZHNBZGRlZChfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgZXZlbnQgU3BlbnRUb2tlbnMoYWRkcmVzcyBpbmRleGVkIHBhcnRpY2lwYW50LCBhZGRyZXNzIGluZGV4ZWQgcmVjaXBpZW50LCB1aW50MjU2IGFtb3VudCk7CiAgICAvKioKICAgICAqIFNwZW5kIGdpdmVuIG51bWJlciBvZiB0b2tlbnMgZm9yIGEgdXNhZ2UuCiAgICAgKgogICAgICogQHBhcmFtIF90byBhZGRyZXNzIHRvIHNwZW5kIHV0aWxpdHkgdG9rZW5zIGF0CiAgICAgKiBAcGFyYW0gX3ZhbHVlIG51bWJlciBvZiB0b2tlbnMgdG8gc3BlbmQKICAgICAqIEByZXR1cm4gdHJ1ZSBvbiBzdWNjZXNzLCBmYWxzZSBvbiBlcnJvcgogICAgICovCiAgICBmdW5jdGlvbiBzcGVuZChhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXF1aXJlKF92YWx1ZSA+IDApOwogICAgICAgIGFzc2VydChfdG8gIT0gMHgwKTsKICAgICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPCBfdmFsdWUpIHJldHVybiBmYWxzZTsKCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBzYWZlU3ViKGJhbGFuY2VzW21zZy5zZW5kZXJdLF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IHNhZmVBZGQoYmFsYW5jZXNbX3RvXSxfdmFsdWUpOwogICAgICAgIHNwZW50YW1vdW50W21zZy5zZW5kZXJdW190b10gPSBzYWZlQWRkKHNwZW50YW1vdW50W21zZy5zZW5kZXJdW190b10sIF92YWx1ZSk7CgogICAgICAgIFNwZW50VG9rZW5zKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICBpZighYnV5ZXJBcHBlbmRlZFttc2cuc2VuZGVyXSkgewogICAgICAgICAgICBidXllckFwcGVuZGVkW21zZy5zZW5kZXJdID0gdHJ1ZTsKICAgICAgICAgICAgYnV5ZXJzLnB1c2gobXNnLnNlbmRlcik7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFNwZW50QW1vdW50KGFkZHJlc3MgX3dobywgYWRkcmVzcyBfdG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gc3BlbnRhbW91bnRbX3dob11bX3RvXTsKICAgIH0KCiAgICBldmVudCBCdXJuKGFkZHJlc3MgaW5kZXhlZCBidXJuZXIsIHVpbnQyNTYgdmFsdWUpOwogICAgLyoqCiAgICAgKiBCdXJuIGdpdmVuIG51bWJlciBvZiB0b2tlbnMgYmVsb25naW5nIHRvIG1lc3NhZ2Ugc2VuZGVyLgogICAgICogSXQgY2FuIGJlIGFwcGxpZWQgYnkgYWNjb3VudCB3aXRoIGFkZHJlc3MgdGhpcy50b2tlbnNhbGVDb250cmFjdAogICAgICoKICAgICAqIEBwYXJhbSBfdmFsdWUgbnVtYmVyIG9mIHRva2VucyB0byBidXJuCiAgICAgKiBAcmV0dXJuIHRydWUgb24gc3VjY2VzcywgZmFsc2Ugb24gZXJyb3IKICAgICAqLwogICAgZnVuY3Rpb24gYnVyblRva2VucyhhZGRyZXNzIGJ1cm5lciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYnVybmVyIHx8IG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIGFzc2VydChidXJuZXIgIT0gMHgwKTsKICAgICAgICBpZiAoX3ZhbHVlID4gdG90YWxTdXBwbHkpIHJldHVybiBmYWxzZTsKICAgICAgICBpZiAoX3ZhbHVlID4gYmFsYW5jZXNbYnVybmVyXSkgcmV0dXJuIGZhbHNlOwogICAgICAgIAogICAgICAgIGJhbGFuY2VzW2J1cm5lcl0gPSBzYWZlU3ViKGJhbGFuY2VzW2J1cm5lcl0sX3ZhbHVlKTsKICAgICAgICB0b3RhbFN1cHBseSA9IHNhZmVTdWIodG90YWxTdXBwbHksX3ZhbHVlKTsKICAgICAgICBCdXJuKGJ1cm5lciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRWSVBPd25lcih1aW50MjU2IGluZGV4KSBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzKSB7CiAgICAgICAgcmV0dXJuICh2aXBzW2luZGV4XSk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0VklQQ291bnQoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHZpcHMubGVuZ3RoOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEJ1eWVyKHVpbnQyNTYgaW5kZXgpIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MpIHsKICAgICAgICByZXR1cm4gKGJ1eWVyc1tpbmRleF0pOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEJ1eWVyc0NvdW50KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBidXllcnMubGVuZ3RoOwogICAgfQp9CgovKioKICogTG9va3NDb2luIENyb3dkU2FsZSBDb250cmFjdAogKgogKiBUaGUgdG9rZW4gc2FsZSBjb250cm9sbGVyLCBhbGxvd3MgY29udHJpYnV0aW5nIGV0aGVyIGluIGV4Y2hhbmdlIGZvciBMb29rc0NvaW4uCiAqIFRoZSBwcmljZSAoZXhjaGFuZ2UgcmF0ZSB3aXRoIEVUSCkgaXMgMjQwMCBMT09LUyBwZXIgRVRIIGF0IGNyb3dkc2FsZS4KICogVklQIHJhbmtpbmcgaXMgcmVjb3JkZWQgYXQgdGhlIHRpbWUgd2hlbiB0aGUgdG9rZW4gaG9sZGluZyBhZGRyZXNzIGZpcnN0IG1lZXQgVklQIGNvaW4gaG9sZGluZyBsZXZlbC4KICogVklQIHJhbmtpbmcgaXMgdmFsaWQgZm9yIHRoZSBsaWZldGltZSBvZiBhIHRva2VuIHdhbGxldCBhZGRyZXNzLCBhcyBsb25nIGFzIGl0IG1lZXRzIFZJUCBjb2luIGhvbGRpbmcgbGV2ZWwuCiAqIFZJUCByYW5raW5nIGlzIHVzZWQgdG8gY2FsY3VsYXRlIHByaW9yaXR5IHdoZW4gY29tcGV0aW5nIHdpdGggb3RoZXIgYmlkcyBmb3IgdGhlCiAqIHNhbWUgcHJvZHVjdCBvciBzZXJ2aWNlIG9uIHRoZSBwbGF0Zm9ybS4gCiAqIEhpZ2hlciBWSVAgcmFua2luZyAod2l0aCBlYXJsaWVyIHRpbWVzdGFtcCkgaGFzIGhpZ2hlciBwcmlvcml0eS4KICogSGlnaGVyIFZJUCByYW5raW5nIGFkZHJlc3MgY2FuIG91dGJpZCBvdGhlciBsb3dlciByYW5raW5nIGFkZHJlc3NlcyBvbmx5IG9uY2UgcGVyIHNlbGxpbmcgd2luZG93IAogKiBvciBwcm9tb3Rpb24gcGVyaW9kLgogKiBVc2FnZSBvZiB0aGUgTG9va3NDb2luLCBWSVAgcmFua2luZyBhbmQgYmlkIHByaW9yaXR5IHdpbGwgYmUgZGVzY3JpYmVkIG9uIHRva2VuIHdlYnNpdGUuCiAqCiAqIExvb2tzQ29pbiBDcm93ZFNhbGUgQm9udXMKICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKICogRmlyc3QgVGVuICgxMCkgVklQIHRva2VuIGhvbGRlcnMgZ2V0IDIwJSBib251cyBvZiB0aGUgTE9PS1MgdG9rZW5zIGluIHRoZWlyIFZJUCBhZGRyZXNzZXMKICogRWxldmVuICgxMXRoKSB0byBGaWZ0eSAoNTB0aCkgVklQIHRva2VuIGhvbGRlcnMgZ2V0IDEwJSBib251cyBvZiB0aGUgTE9PS1MgdG9rZW5zIGluIHRoZWlyIFZJUCBhZGRyZXNzZXMKICogRmlmdHkgT25lICg1MXRoKSB0byBPbmUgSHVuZHJlZCAoMTAwdGgpIFZJUCB0b2tlbiBob2xkZXJzIGdldCA1JSBib251cyBvZiB0aGUgTE9PS1MgdG9rZW5zIGluIHRoZWlyIFZJUCBhZGRyZXNzZXMKICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKICoKICogQm9udXMgdG9rZW5zIHdpbGwgYmUgZGlzdHJpYnV0ZWQgYnkgY29pbiBtYXN0ZXIgd2hlbiBMb29rc0NvaW4gaGFzIDEwMCBWSVAgcmFuayB0b2tlbiB3YWxsZXQgYWRkcmVzc2VzCiAqCiAqLwpjb250cmFjdCBMb29rc0NvaW5Dcm93ZFNhbGUgewogICAgTG9va3NDb2luIHB1YmxpYyBsb29rc0NvaW47CiAgICBFUkMyMCBwdWJsaWMgcHJlU2FsZVRva2VuOwoKICAgIC8vIGluaXRpYWwgcHJpY2UgaW4gd2VpIChudW1lcmF0b3IpCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBUT0tFTl9QUklDRV9OID0gMWUxODsKICAgIC8vIGluaXRpYWwgcHJpY2UgaW4gd2VpIChkZW5vbWluYXRvcikKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IFRPS0VOX1BSSUNFX0QgPSAyNDAwOwogICAgLy8gMSBFVEggPSAyLDQwMCBMT09LUyB0b2tlbnMKCiAgICBhZGRyZXNzIHNhbGVDb250cm9sbGVyID0gMHgwOwoKICAgIC8vIEFtb3VudCBvZiBpbXBvcnRlZCB0b2tlbnMgZnJvbSBwcmVTYWxlCiAgICB1aW50MjU2IHB1YmxpYyBpbXBvcnRlZFRva2VucyA9IDA7CgogICAgLy8gQW1vdW50IG9mIHRva2VucyBzb2xkCiAgICB1aW50MjU2IHB1YmxpYyB0b2tlbnNTb2xkID0gMDsKCiAgICAvKioKICAgICAqIEFkZHJlc3Mgb2YgdGhlIG93bmVyIG9mIHRoaXMgc21hcnQgY29udHJhY3QuCiAgICAgKi8KICAgIGFkZHJlc3MgZnVuZHN0b3JhZ2UgPSAweDA7CgogICAgLyoqCiAgICAgKiBTdGF0ZXMgb2YgdGhlIGNyb3dkc2FsZSBjb250cmFjdC4KICAgICAqLwogICAgZW51bSBTdGF0ZXsKICAgICAgICBQYXVzZSwKICAgICAgICBJbml0LAogICAgICAgIFJ1bm5pbmcsCiAgICAgICAgU3RvcHBlZCwKICAgICAgICBNaWdyYXRlZAogICAgfQoKICAgIFN0YXRlIHB1YmxpYyBjdXJyZW50U3RhdGUgPSBTdGF0ZS5SdW5uaW5nOyAgICAKCiAgICAvKioKICAgICAqIE1vZGlmaWVyLgogICAgICovCiAgICBtb2RpZmllciBvbkNyb3dkU2FsZVJ1bm5pbmcoKSB7CiAgICAgICAgLy8gQ2hlY2tzLCBpZiBDcm93ZFNhbGUgaXMgcnVubmluZyBhbmQgaGFzIG5vdCBiZWVuIHBhdXNlZAogICAgICAgIHJlcXVpcmUoY3VycmVudFN0YXRlID09IFN0YXRlLlJ1bm5pbmcpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgbmV3IExPT0tTIHRva2VuIFNtYXJ0IENvbnRyYWN0LCBtYWtlIG1lc3NhZ2Ugc2VuZGVyIHRvIGJlIHRoZQogICAgICogb3duZXIgb2Ygc21hcnQgY29udHJhY3QsIGlzc3VlIGdpdmVuIG51bWJlciBvZiB0b2tlbnMgYW5kIGdpdmUgdGhlbSB0bwogICAgICogbWVzc2FnZSBzZW5kZXIuCiAgICAgKi8KICAgIGZ1bmN0aW9uIExvb2tzQ29pbkNyb3dkU2FsZSgpIHsKICAgICAgICBzYWxlQ29udHJvbGxlciA9IG1zZy5zZW5kZXI7CiAgICAgICAgZnVuZHN0b3JhZ2UgPSBtc2cuc2VuZGVyOwogICAgICAgIGxvb2tzQ29pbiA9IG5ldyBMb29rc0NvaW4odGhpcyk7CgogICAgICAgIHByZVNhbGVUb2tlbiA9IEVSQzIwKDB4MjUzQzdkZDA3NGY0QmFDYjMwNTM4N0Y5MjIyMjVBNGY3MzdDMDhiZCk7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgU2V0IG5ldyBzdGF0ZQogICAgKiBAcGFyYW0gX25ld1N0YXRlIFZhbHVlIG9mIG5ldyBzdGF0ZQogICAgKi8KICAgIGZ1bmN0aW9uIHNldFN0YXRlKFN0YXRlIF9uZXdTdGF0ZSkKICAgIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gc2FsZUNvbnRyb2xsZXIpOwogICAgICAgIGN1cnJlbnRTdGF0ZSA9IF9uZXdTdGF0ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgU2V0IG5ldyB0b2tlbiBzYWxlIGNvbnRyb2xsZXIuCiAgICAgKiBNYXkgb25seSBiZSBjYWxsZWQgYnkgc2FsZSBjb250cm9sbGVyLgogICAgICoKICAgICAqIEBwYXJhbSBfbmV3U2FsZUNvbnRyb2xsZXIgbmV3IHRva2VuIHNhbGUgY29udHJvbGxlci4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0U2FsZUNvbnRyb2xsZXIoYWRkcmVzcyBfbmV3U2FsZUNvbnRyb2xsZXIpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gc2FsZUNvbnRyb2xsZXIpOwogICAgICAgIGFzc2VydChfbmV3U2FsZUNvbnRyb2xsZXIgIT0gMHgwKTsKICAgICAgICBzYWxlQ29udHJvbGxlciA9IF9uZXdTYWxlQ29udHJvbGxlcjsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCBuZXcgd2FsbGV0IGFkZHJlc3MgZm9yIHRoZSBzbWFydCBjb250cmFjdC4KICAgICAqIE1heSBvbmx5IGJlIGNhbGxlZCBieSBzbWFydCBjb250cmFjdCBvd25lci4KICAgICAqCiAgICAgKiBAcGFyYW0gX2Z1bmRzdG9yYWdlIG5ldyB3YWxsZXQgYWRkcmVzcyBvZiB0aGUgc21hcnQgY29udHJhY3QKICAgICAqLwogICAgZnVuY3Rpb24gc2V0V2FsbGV0KGFkZHJlc3MgX2Z1bmRzdG9yYWdlKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHNhbGVDb250cm9sbGVyKTsKICAgICAgICBhc3NlcnQoX2Z1bmRzdG9yYWdlICE9IDB4MCk7CiAgICAgICAgZnVuZHN0b3JhZ2UgPSBfZnVuZHN0b3JhZ2U7CiAgICAgICAgV2FsbGV0VXBkYXRlZChmdW5kc3RvcmFnZSk7CiAgICB9CiAgICBldmVudCBXYWxsZXRVcGRhdGVkKGFkZHJlc3MgbmV3V2FsbGV0KTsKCiAgICAvKioKICAgICogc2F2ZXMgaW5mbyBpZiBhY2NvdW50J3MgdG9rZW5zIHdlcmUgaW1wb3J0ZWQgZnJvbSBwcmUtQ3Jvd2RTYWxlCiAgICAqLwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwcml2YXRlIGltcG9ydGVkRnJvbVByZVNhbGU7CgogICAgZXZlbnQgVG9rZW5zSW1wb3J0KGFkZHJlc3MgaW5kZXhlZCBwYXJ0aWNpcGFudCwgdWludDI1NiB0b2tlbnMsIHVpbnQyNTYgdG90YWxJbXBvcnQpOwogICAgLyoqCiAgICAqIEltcG9ydHMgYWNjb3VudCdzIHRva2VucyBmcm9tIHByZS1TYWxlLiAKICAgICogSXQgY2FuIGJlIGRvbmUgb25seSBieSBhY2NvdW50IG93bmVyIG9yIENyb3dkU2FsZSBtYW5hZ2VyCiAgICAqIEBwYXJhbSBfYWNjb3VudCBBZGRyZXNzIG9mIGFjY291bnQgd2hpY2ggdG9rZW5zIHdpbGwgYmUgaW1wb3J0ZWQKICAgICovCiAgICBmdW5jdGlvbiBpbXBvcnRUb2tlbnMoYWRkcmVzcyBfYWNjb3VudCkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgLy8gb25seSB0b2tlbiBob2xkZXIgb3IgbWFuYWdlciBjYW4gZG8gaW1wb3J0CiAgICAgICAgcmVxdWlyZShjdXJyZW50U3RhdGUgPT0gU3RhdGUuUnVubmluZyk7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHNhbGVDb250cm9sbGVyIHx8IG1zZy5zZW5kZXIgPT0gX2FjY291bnQpOwogICAgICAgIHJlcXVpcmUoIWltcG9ydGVkRnJvbVByZVNhbGVbX2FjY291bnRdKTsKCiAgICAgICAgLy8gVG9rZW4gZGVjaW1hbHMgaW4gUHJlU2FsZSB3YXMgMTgKICAgICAgICB1aW50MjU2IHByZVNhbGVCYWxhbmNlID0gcHJlU2FsZVRva2VuLmJhbGFuY2VPZihfYWNjb3VudCkgLyBUT0tFTl9QUklDRV9OOwoKICAgICAgICBpZiAocHJlU2FsZUJhbGFuY2UgPT0gMCkgcmV0dXJuIGZhbHNlOwoKICAgICAgICBsb29rc0NvaW4ucmV3YXJkVG9rZW5zKF9hY2NvdW50LCBwcmVTYWxlQmFsYW5jZSk7CiAgICAgICAgaW1wb3J0ZWRUb2tlbnMgPSBpbXBvcnRlZFRva2VucyArIHByZVNhbGVCYWxhbmNlOwogICAgICAgIGltcG9ydGVkRnJvbVByZVNhbGVbX2FjY291bnRdID0gdHJ1ZTsKICAgICAgICBUb2tlbnNJbXBvcnQoX2FjY291bnQsIHByZVNhbGVCYWxhbmNlLCBpbXBvcnRlZFRva2Vucyk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gZmFsbGJhY2sKICAgIGZ1bmN0aW9uKCkgcHVibGljIHBheWFibGUgewogICAgICAgIGJ1eVRva2VucygpOwogICAgfQoKICAgIGV2ZW50IFRva2Vuc0JvdWdodChhZGRyZXNzIGluZGV4ZWQgYnV5ZXIsIHVpbnQyNTYgZXRoZXJzLCB1aW50MjU2IHRva2VucywgdWludDI1NiB0b2tlbnNTb2xkKTsKICAgIC8qKgogICAgICogQWNjZXB0IGV0aGVycyB0byBidXkgdG9rZW5zIGR1cmluZyB0aGUgdG9rZW4gc2FsZQogICAgICogTWluaW1pdW0gaG9sZGluZ3MgdG8gcmVjZWl2ZSBhIFZJUCByYW5rIGlzIDI0MDAwIExvb2tzQ29pbgogICAgICovCiAgICBmdW5jdGlvbiBidXlUb2tlbnMoKSBwYXlhYmxlIHJldHVybnMgKHVpbnQyNTYgYW1vdW50KQogICAgewogICAgICAgIHJlcXVpcmUoY3VycmVudFN0YXRlID09IFN0YXRlLlJ1bm5pbmcpOwogICAgICAgIGFzc2VydChtc2cuc2VuZGVyICE9IDB4MCk7CiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPiAwKTsKCiAgICAgICAgLy8gQ2FsY3VsYXRlIG51bWJlciBvZiB0b2tlbnMgZm9yIGNvbnRyaWJ1dGVkIHdlaQogICAgICAgIHVpbnQyNTYgdG9rZW5zID0gbXNnLnZhbHVlICogVE9LRU5fUFJJQ0VfRCAvIFRPS0VOX1BSSUNFX047CiAgICAgICAgaWYgKHRva2VucyA9PSAwKSByZXR1cm4gMDsKCiAgICAgICAgbG9va3NDb2luLnJld2FyZFRva2Vucyhtc2cuc2VuZGVyLCB0b2tlbnMpOwogICAgICAgIHRva2Vuc1NvbGQgPSB0b2tlbnNTb2xkICsgdG9rZW5zOwoKICAgICAgICAvLyBUcmFuc2ZlciB0aGUgY29udHJpYnV0ZWQgZXRoZXJzIHRvIHRoZSBjcm93ZHNhbGUgZnVuZHN0b3JhZ2UKICAgICAgICBhc3NlcnQoZnVuZHN0b3JhZ2Uuc2VuZChtc2cudmFsdWUpKTsKICAgICAgICBUb2tlbnNCb3VnaHQobXNnLnNlbmRlciwgbXNnLnZhbHVlLCB0b2tlbnMsIHRva2Vuc1NvbGQpOwogICAgICAgIHJldHVybiB0b2tlbnM7CiAgICB9Cn0='.
	

]
