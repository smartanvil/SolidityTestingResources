Class {
	#name : #SRT3bb62bada8f9921dcf0b1be5d2c972d69c064d84,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT3bb62bada8f9921dcf0b1be5d2c972d69c064d84 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgoKY29udHJhY3QgVG9rZW4gewogICAgLyogVGhpcyBpcyBhIHNsaWdodCBjaGFuZ2UgdG8gdGhlIEVSQzIwIGJhc2Ugc3RhbmRhcmQuCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgc3VwcGx5KTsKICAgIGlzIHJlcGxhY2VkIHdpdGg6CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICAgIFRoaXMgYXV0b21hdGljYWxseSBjcmVhdGVzIGEgZ2V0dGVyIGZ1bmN0aW9uIGZvciB0aGUgdG90YWxTdXBwbHkuCiAgICBUaGlzIGlzIG1vdmVkIHRvIHRoZSBiYXNlIGNvbnRyYWN0IHNpbmNlIHB1YmxpYyBnZXR0ZXIgZnVuY3Rpb25zIGFyZSBub3QKICAgIGN1cnJlbnRseSByZWNvZ25pc2VkIGFzIGFuIGltcGxlbWVudGF0aW9uIG9mIHRoZSBtYXRjaGluZyBhYnN0cmFjdAogICAgZnVuY3Rpb24gYnkgdGhlIGNvbXBpbGVyLgogICAgKi8KICAgIC8vLyB0b3RhbCBhbW91bnQgb2YgdG9rZW5zCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBmcm9tIHdoaWNoIHRoZSBiYWxhbmNlIHdpbGwgYmUgcmV0cmlldmVkCiAgICAvLy8gQHJldHVybiBUaGUgYmFsYW5jZQogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwoKICAgIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgbXNnLnNlbmRlcmAKICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQKICAgIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQKICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIHRyYW5zZmVyIHdhcyBzdWNjZXNzZnVsIG9yIG5vdAogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgX2Zyb21gIG9uIHRoZSBjb25kaXRpb24gaXQgaXMgYXBwcm92ZWQgYnkgYF9mcm9tYAogICAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyCiAgICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8vIEBub3RpY2UgYG1zZy5zZW5kZXJgIGFwcHJvdmVzIGBfc3BlbmRlcmAgdG8gc3BlbmQgYF92YWx1ZWAgdG9rZW5zCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2VucwogICAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgYXBwcm92ZWQgZm9yIHRyYW5zZmVyCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBhcHByb3ZhbCB3YXMgc3VjY2Vzc2Z1bCBvciBub3QKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgb3duaW5nIHRva2VucwogICAgLy8vIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBhYmxlIHRvIHRyYW5zZmVyIHRoZSB0b2tlbnMKICAgIC8vLyBAcmV0dXJuIEFtb3VudCBvZiByZW1haW5pbmcgdG9rZW5zIGFsbG93ZWQgdG8gc3BlbnQKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOwoKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7Cn0KLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9Ci8qKgogKiBAdGl0bGUgU2FmZU1hdGgKICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCmxpYnJhcnkgU2FmZU1hdGggewogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgoKCmNvbnRyYWN0IEFic3RyYWN0UGF5bWVudEVzY3JvdyBpcyBPd25hYmxlIHsKCiAgICBhZGRyZXNzIHB1YmxpYyB3YWxsZXQ7CgogICAgbWFwcGluZyAodWludCA9PiB1aW50KSBwdWJsaWMgZGVwb3NpdHM7CgogICAgZXZlbnQgUGF5bWVudChhZGRyZXNzIGluZGV4ZWQgX2N1c3RvbWVyLCB1aW50IGluZGV4ZWQgX3Byb2plY3RJZCwgdWludCB2YWx1ZSk7CiAgICBldmVudCBXaXRoZHJhdyhhZGRyZXNzIGluZGV4ZWQgX3dhbGxldCwgdWludCB2YWx1ZSk7CgogICAgZnVuY3Rpb24gd2l0aGRyYXdGdW5kcygpIHB1YmxpYzsKCiAgICAvKioKICAgICAqIEBkZXYgQ2hhbmdlIHRoZSB3YWxsZXQKICAgICAqIEBwYXJhbSBfd2FsbGV0IGFkZHJlc3Mgb2YgdGhlIHdhbGxldCB3aGVyZSBmZWVzIHdpbGwgYmUgdHJhbnNmZXJlZCB3aGVuIHNwZW50CiAgICAgKi8KICAgIGZ1bmN0aW9uIGNoYW5nZVdhbGxldChhZGRyZXNzIF93YWxsZXQpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seU93bmVyKCkKICAgIHsKICAgICAgICB3YWxsZXQgPSBfd2FsbGV0OwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBHZXQgdGhlIGFtb3VudCBkZXBvc2l0ZWQgZm9yIHRoZSBwcm92aWRlZCBwcm9qZWN0LCByZXR1cm5zIDAgaWYgdGhlcmUncyBubyBkZXBvc2l0IGZvciB0aGF0IHByb2plY3Qgb3IgdGhlIGFtb3VudCBpbiB3ZWkKICAgICAqIEBwYXJhbSBfcHJvamVjdElkIFRoZSBpZCBvZiB0aGUgcHJvamVjdAogICAgICogQHJldHVybiAwIGlmIHRoZXJlJ3MgZWl0aGVyIG5vIGRlcG9zaXQgZm9yIF9wcm9qZWN0SWQsIG90aGVyd2lzZSByZXR1cm5zIHRoZSBkZXBvc2l0ZWQgYW1vdW50IGluIHdlaQogICAgICovCiAgICBmdW5jdGlvbiBnZXREZXBvc2l0KHVpbnQgX3Byb2plY3RJZCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQpCiAgICB7CiAgICAgICAgcmV0dXJuIGRlcG9zaXRzW19wcm9qZWN0SWRdOwogICAgfQp9CgoKCgpjb250cmFjdCBUb2tpdFJlZ2lzdHJ5IGlzIE93bmFibGUgewoKICAgIHN0cnVjdCBQcm9qZWN0Q29udHJhY3RzIHsKICAgICAgICBhZGRyZXNzIHRva2VuOwogICAgICAgIGFkZHJlc3MgZnVuZDsKICAgICAgICBhZGRyZXNzIGNhbXBhaWduOwogICAgfQoKICAgIC8vIHJlZ2lzdHJhciA9PiB0cnVlL2ZhbHNlCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyByZWdpc3RyYXJzOwoKICAgIC8vIGN1c3RvbWVyID0+IHByb2plY3RfaWQgPT4gdG9rZW4vY2FtcGFpZ24KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyh1aW50ID0+IFByb2plY3RDb250cmFjdHMpKSBwdWJsaWMgcmVnaXN0cnk7CiAgICAvLyBwcm9qZWN0X2lkID0+IHRva2VuL2NhbXBhaWduCiAgICBtYXBwaW5nICh1aW50ID0+IFByb2plY3RDb250cmFjdHMpIHB1YmxpYyBwcm9qZWN0X3JlZ2lzdHJ5OwoKICAgIGV2ZW50IFJlZ2lzdGVyZWRUb2tlbihhZGRyZXNzIGluZGV4ZWQgX3Byb2plY3RPd25lciwgdWludCBpbmRleGVkIF9wcm9qZWN0SWQsIGFkZHJlc3MgX3Rva2VuLCBhZGRyZXNzIF9mdW5kKTsKICAgIGV2ZW50IFJlZ2lzdGVyZWRDYW1wYWlnbihhZGRyZXNzIGluZGV4ZWQgX3Byb2plY3RPd25lciwgdWludCBpbmRleGVkIF9wcm9qZWN0SWQsIGFkZHJlc3MgX2NhbXBhaWduKTsKCiAgICBtb2RpZmllciBvbmx5UmVnaXN0cmFycygpIHsKICAgICAgICByZXF1aXJlKHJlZ2lzdHJhcnNbbXNnLnNlbmRlcl0pOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gVG9raXRSZWdpc3RyeShhZGRyZXNzIF9vd25lcikgewogICAgICAgIHNldFJlZ2lzdHJhcihfb3duZXIsIHRydWUpOwogICAgICAgIHRyYW5zZmVyT3duZXJzaGlwKF9vd25lcik7CiAgICB9CgogICAgZnVuY3Rpb24gcmVnaXN0ZXIoYWRkcmVzcyBfY3VzdG9tZXIsIHVpbnQgX3Byb2plY3RJZCwgYWRkcmVzcyBfdG9rZW4sIGFkZHJlc3MgX2Z1bmQpCiAgICAgICAgb25seVJlZ2lzdHJhcnMoKQogICAgewogICAgICAgIHJlZ2lzdHJ5W19jdXN0b21lcl1bX3Byb2plY3RJZF0udG9rZW4gPSBfdG9rZW47CiAgICAgICAgcmVnaXN0cnlbX2N1c3RvbWVyXVtfcHJvamVjdElkXS5mdW5kID0gX2Z1bmQ7CgogICAgICAgIHByb2plY3RfcmVnaXN0cnlbX3Byb2plY3RJZF0udG9rZW4gPSBfdG9rZW47CiAgICAgICAgcHJvamVjdF9yZWdpc3RyeVtfcHJvamVjdElkXS5mdW5kID0gX2Z1bmQ7CgogICAgICAgIFJlZ2lzdGVyZWRUb2tlbihfY3VzdG9tZXIsIF9wcm9qZWN0SWQsIF90b2tlbiwgX2Z1bmQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlZ2lzdGVyKGFkZHJlc3MgX2N1c3RvbWVyLCB1aW50IF9wcm9qZWN0SWQsIGFkZHJlc3MgX2NhbXBhaWduKQogICAgICAgIG9ubHlSZWdpc3RyYXJzKCkKICAgIHsKICAgICAgICByZWdpc3RyeVtfY3VzdG9tZXJdW19wcm9qZWN0SWRdLmNhbXBhaWduID0gX2NhbXBhaWduOwoKICAgICAgICBwcm9qZWN0X3JlZ2lzdHJ5W19wcm9qZWN0SWRdLmNhbXBhaWduID0gX2NhbXBhaWduOwoKICAgICAgICBSZWdpc3RlcmVkQ2FtcGFpZ24oX2N1c3RvbWVyLCBfcHJvamVjdElkLCBfY2FtcGFpZ24pOwogICAgfQoKICAgIGZ1bmN0aW9uIGxvb2t1cChhZGRyZXNzIF9jdXN0b21lciwgdWludCBfcHJvamVjdElkKQogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoYWRkcmVzcyB0b2tlbiwgYWRkcmVzcyBmdW5kLCBhZGRyZXNzIGNhbXBhaWduKQogICAgewogICAgICAgIHJldHVybiAoCiAgICAgICAgICAgIHJlZ2lzdHJ5W19jdXN0b21lcl1bX3Byb2plY3RJZF0udG9rZW4sCiAgICAgICAgICAgIHJlZ2lzdHJ5W19jdXN0b21lcl1bX3Byb2plY3RJZF0uZnVuZCwKICAgICAgICAgICAgcmVnaXN0cnlbX2N1c3RvbWVyXVtfcHJvamVjdElkXS5jYW1wYWlnbgogICAgICAgICk7CiAgICB9CgogICAgZnVuY3Rpb24gbG9va3VwQnlQcm9qZWN0KHVpbnQgX3Byb2plY3RJZCkKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKGFkZHJlc3MgdG9rZW4sIGFkZHJlc3MgZnVuZCwgYWRkcmVzcyBjYW1wYWlnbikKICAgIHsKICAgICAgICByZXR1cm4gKAogICAgICAgICAgICBwcm9qZWN0X3JlZ2lzdHJ5W19wcm9qZWN0SWRdLnRva2VuLAogICAgICAgICAgICBwcm9qZWN0X3JlZ2lzdHJ5W19wcm9qZWN0SWRdLmZ1bmQsCiAgICAgICAgICAgIHByb2plY3RfcmVnaXN0cnlbX3Byb2plY3RJZF0uY2FtcGFpZ24KICAgICAgICApOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFJlZ2lzdHJhcihhZGRyZXNzIF9yZWdpc3RyYXIsIGJvb2wgZW5hYmxlZCkKICAgICAgICBvbmx5T3duZXIoKQogICAgewogICAgICAgIHJlZ2lzdHJhcnNbX3JlZ2lzdHJhcl0gPSBlbmFibGVkOwogICAgfQp9CgoKCgoKLy8vIEB0aXRsZSBGdW5kIGNvbnRyYWN0IC0gSW1wbGVtZW50cyByZXdhcmQgZGlzdHJpYnV0aW9uLgovLy8gQGF1dGhvciBTdGVmYW4gR2VvcmdlIC0gPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iN2QwZTA5MTgxYjFjMTM1MzFhMTgxMjBmMWExODNkMWUxMjEzMGUxODEzMGUwNDBlNTMxMzE4MDkiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+PgovLy8gQGF1dGhvciBNaWxhZCBNb3N0YXZpIC0gPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iNjgwNTAxMDQwOTBjNDYwNTA3MWIxYzA5MWUwMTI4MGIwNzA2MWIwZDA2MWIxMTFiNDYwNjBkMWMiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+Pgpjb250cmFjdCBTaW5ndWxhckRUVkZ1bmQgewogICAgc3RyaW5nIHB1YmxpYyB2ZXJzaW9uID0gIjAuMS4wIjsKCiAgICAvKgogICAgICogIEV4dGVybmFsIGNvbnRyYWN0cwogICAgICovCiAgICBBYnN0cmFjdFNpbmd1bGFyRFRWVG9rZW4gcHVibGljIHNpbmd1bGFyRFRWVG9rZW47CgogICAgLyoKICAgICAqICBTdG9yYWdlCiAgICAgKi8KICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwogICAgdWludCBwdWJsaWMgdG90YWxSZXdhcmQ7CgogICAgLy8gVXNlcidzIGFkZHJlc3MgPT4gUmV3YXJkIGF0IHRpbWUgb2Ygd2l0aGRyYXcKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgcHVibGljIHJld2FyZEF0VGltZU9mV2l0aGRyYXc7CgogICAgLy8gVXNlcidzIGFkZHJlc3MgPT4gUmV3YXJkIHdoaWNoIGNhbiBiZSB3aXRoZHJhd24KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgcHVibGljIG93ZWQ7CgogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIC8vIE9ubHkgZ3VhcmQgaXMgYWxsb3dlZCB0byBkbyB0aGlzIGFjdGlvbi4KICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lcikgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CiAgICAgICAgXzsKICAgIH0KCiAgICAvKgogICAgICogIENvbnRyYWN0IGZ1bmN0aW9ucwogICAgICovCiAgICAvLy8gQGRldiBEZXBvc2l0cyByZXdhcmQuIFJldHVybnMgc3VjY2Vzcy4KICAgIGZ1bmN0aW9uIGRlcG9zaXRSZXdhcmQoKQogICAgICAgIHB1YmxpYwogICAgICAgIHBheWFibGUKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHRvdGFsUmV3YXJkICs9IG1zZy52YWx1ZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLy8gQGRldiBXaXRoZHJhd3MgcmV3YXJkIGZvciB1c2VyLiBSZXR1cm5zIHJld2FyZC4KICAgIC8vLyBAcGFyYW0gZm9yQWRkcmVzcyB1c2VyJ3MgYWRkcmVzcy4KICAgIGZ1bmN0aW9uIGNhbGNSZXdhcmQoYWRkcmVzcyBmb3JBZGRyZXNzKSBwcml2YXRlIHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gc2luZ3VsYXJEVFZUb2tlbi5iYWxhbmNlT2YoZm9yQWRkcmVzcykgKiAodG90YWxSZXdhcmQgLSByZXdhcmRBdFRpbWVPZldpdGhkcmF3W2ZvckFkZHJlc3NdKSAvIHNpbmd1bGFyRFRWVG9rZW4udG90YWxTdXBwbHkoKTsKICAgIH0KCiAgICAvLy8gQGRldiBXaXRoZHJhd3MgcmV3YXJkIGZvciB1c2VyLiBSZXR1cm5zIHJld2FyZC4KICAgIGZ1bmN0aW9uIHdpdGhkcmF3UmV3YXJkKCkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zICh1aW50KQogICAgewogICAgICAgIHVpbnQgdmFsdWUgPSBjYWxjUmV3YXJkKG1zZy5zZW5kZXIpICsgb3dlZFttc2cuc2VuZGVyXTsKICAgICAgICByZXdhcmRBdFRpbWVPZldpdGhkcmF3W21zZy5zZW5kZXJdID0gdG90YWxSZXdhcmQ7CiAgICAgICAgb3dlZFttc2cuc2VuZGVyXSA9IDA7CiAgICAgICAgaWYgKHZhbHVlID4gMCAmJiAhbXNnLnNlbmRlci5zZW5kKHZhbHVlKSkgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQoKICAgIC8vLyBAZGV2IENyZWRpdHMgcmV3YXJkIHRvIG93ZWQgYmFsYW5jZS4KICAgIC8vLyBAcGFyYW0gZm9yQWRkcmVzcyB1c2VyJ3MgYWRkcmVzcy4KICAgIGZ1bmN0aW9uIHNvZnRXaXRoZHJhd1Jld2FyZEZvcihhZGRyZXNzIGZvckFkZHJlc3MpCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICByZXR1cm5zICh1aW50KQogICAgewogICAgICAgIHVpbnQgdmFsdWUgPSBjYWxjUmV3YXJkKGZvckFkZHJlc3MpOwogICAgICAgIHJld2FyZEF0VGltZU9mV2l0aGRyYXdbZm9yQWRkcmVzc10gPSB0b3RhbFJld2FyZDsKICAgICAgICBvd2VkW2ZvckFkZHJlc3NdICs9IHZhbHVlOwogICAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KCiAgICAvLy8gQGRldiBTZXR1cCBmdW5jdGlvbiBzZXRzIGV4dGVybmFsIHRva2VuIGFkZHJlc3MuCiAgICAvLy8gQHBhcmFtIHNpbmd1bGFyRFRWVG9rZW5BZGRyZXNzIFRva2VuIGFkZHJlc3MuCiAgICBmdW5jdGlvbiBzZXR1cChhZGRyZXNzIHNpbmd1bGFyRFRWVG9rZW5BZGRyZXNzKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgb25seU93bmVyCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICBpZiAoYWRkcmVzcyhzaW5ndWxhckRUVlRva2VuKSA9PSAwKSB7CiAgICAgICAgICAgIHNpbmd1bGFyRFRWVG9rZW4gPSBBYnN0cmFjdFNpbmd1bGFyRFRWVG9rZW4oc2luZ3VsYXJEVFZUb2tlbkFkZHJlc3MpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8vLyBAZGV2IENvbnRyYWN0IGNvbnN0cnVjdG9yIGZ1bmN0aW9uIHNldHMgZ3VhcmQgYWRkcmVzcy4KICAgIGZ1bmN0aW9uIFNpbmd1bGFyRFRWRnVuZCgpIHsKICAgICAgICAvLyBTZXQgb3duZXIgYWRkcmVzcwogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICAvLy8gQGRldiBGYWxsYmFjayBmdW5jdGlvbiBhY3RzIGFzIGRlcG9zaXRSZXdhcmQoKQogICAgZnVuY3Rpb24gKCkKICAgICAgICBwdWJsaWMKICAgICAgICBwYXlhYmxlCiAgICB7CiAgICAgICAgaWYgKG1zZy52YWx1ZSA9PSAwKSB7CiAgICAgICAgICAgIHdpdGhkcmF3UmV3YXJkKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGVwb3NpdFJld2FyZCgpOwogICAgICAgIH0KICAgIH0KfQoKCgoKCgoKY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBUb2tlbiB7CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICAvL0RlZmF1bHQgYXNzdW1lcyB0b3RhbFN1cHBseSBjYW4ndCBiZSBvdmVyIG1heCAoMl4yNTYgLSAxKS4KICAgICAgICAvL0lmIHlvdXIgdG9rZW4gbGVhdmVzIG91dCB0b3RhbFN1cHBseSBhbmQgY2FuIGlzc3VlIG1vcmUgdG9rZW5zIGFzIHRpbWUgZ29lcyBvbiwgeW91IG5lZWQgdG8gY2hlY2sgaWYgaXQgZG9lc24ndCB3cmFwLgogICAgICAgIC8vUmVwbGFjZSB0aGUgaWYgd2l0aCB0aGlzIG9uZSBpbnN0ZWFkLgogICAgICAgIC8vcmVxdWlyZShiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+IGJhbGFuY2VzW190b10pOwogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIC8vc2FtZSBhcyBhYm92ZS4gUmVwbGFjZSB0aGlzIGxpbmUgd2l0aCB0aGUgZm9sbG93aW5nIGlmIHlvdSB3YW50IHRvIHByb3RlY3QgYWdhaW5zdCB3cmFwcGluZyB1aW50cy4KICAgICAgICAvL3JlcXVpcmUoYmFsYW5jZXNbX2Zyb21dID49IF92YWx1ZSAmJiBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+IGJhbGFuY2VzW190b10pOwogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbX2Zyb21dID49IF92YWx1ZSAmJiBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gKz0gX3ZhbHVlOwogICAgICAgIGJhbGFuY2VzW19mcm9tXSAtPSBfdmFsdWU7CiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQoKICAgIC8qIEFwcHJvdmVzIGFuZCB0aGVuIGNhbGxzIHRoZSByZWNlaXZpbmcgY29udHJhY3QgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmVBbmRDYWxsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZXh0cmFEYXRhKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKCiAgICAgICAgLy9jYWxsIHRoZSByZWNlaXZlQXBwcm92YWwgZnVuY3Rpb24gb24gdGhlIGNvbnRyYWN0IHlvdSB3YW50IHRvIGJlIG5vdGlmaWVkLiBUaGlzIGNyYWZ0cyB0aGUgZnVuY3Rpb24gc2lnbmF0dXJlIG1hbnVhbGx5IHNvIG9uZSBkb2Vzbid0IGhhdmUgdG8gaW5jbHVkZSBhIGNvbnRyYWN0IGluIGhlcmUganVzdCBmb3IgdGhpcy4KICAgICAgICAvL3JlY2VpdmVBcHByb3ZhbChhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF92YWx1ZSwgYWRkcmVzcyBfdG9rZW5Db250cmFjdCwgYnl0ZXMgX2V4dHJhRGF0YSkKICAgICAgICAvL2l0IGlzIGFzc3VtZWQgdGhhdCB3aGVuIGRvZXMgdGhpcyB0aGF0IHRoZSBjYWxsICpzaG91bGQqIHN1Y2NlZWQsIG90aGVyd2lzZSBvbmUgd291bGQgdXNlIHZhbmlsbGEgYXBwcm92ZSBpbnN0ZWFkLgogICAgICAgIHJlcXVpcmUoX3NwZW5kZXIuY2FsbChieXRlczQoYnl0ZXMzMihzaGEzKCJyZWNlaXZlQXBwcm92YWwoYWRkcmVzcyx1aW50MjU2LGFkZHJlc3MsYnl0ZXMpIikpKSwgbXNnLnNlbmRlciwgX3ZhbHVlLCB0aGlzLCBfZXh0cmFEYXRhKSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKfQoKCgpjb250cmFjdCBBYnN0cmFjdFNpbmd1bGFyRFRWRnVuZCB7CiAgICBmdW5jdGlvbiBzb2Z0V2l0aGRyYXdSZXdhcmRGb3IoYWRkcmVzcyBmb3JBZGRyZXNzKSByZXR1cm5zICh1aW50KTsKfQoKLy8vIEB0aXRsZSBUb2tlbiBjb250cmFjdCAtIEltcGxlbWVudHMgdG9rZW4gaXNzdWFuY2UuCi8vLyBAYXV0aG9yIFN0ZWZhbiBHZW9yZ2UgLSA8PHNwYW4gY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSI3NzA0MDMxMjExMTYxOTU5MTAxMjE4MDUxMDEyMzcxNDE4MTkwNDEyMTkwNDBlMDQ1OTE5MTIwMyI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+Ci8vLyBAYXV0aG9yIE1pbGFkIE1vc3RhdmkgLSA8PHNwYW4gY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSIwYzYxNjU2MDZkNjgyMjYxNjM3Zjc4NmQ3YTY1NGM2ZjYzNjI3ZjY5NjI3Zjc1N2YyMjYyNjk3OCI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+CmNvbnRyYWN0IFNpbmd1bGFyRFRWVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiB7CiAgICBzdHJpbmcgcHVibGljIHZlcnNpb24gPSAiMC4xLjAiOwoKICAgIC8qCiAgICAgKiAgRXh0ZXJuYWwgY29udHJhY3RzCiAgICAgKi8KICAgIEFic3RyYWN0U2luZ3VsYXJEVFZGdW5kIHB1YmxpYyBzaW5ndWxhckRUVkZ1bmQ7CgogICAgLyoKICAgICAqICBUb2tlbiBtZXRhIGRhdGEKICAgICAqLwogICAgc3RyaW5nIHB1YmxpYyBuYW1lOwogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2w7CiAgICB1aW50OCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKCiAgICAvLy8gQGRldiBUcmFuc2ZlcnMgc2VuZGVyJ3MgdG9rZW5zIHRvIGEgZ2l2ZW4gYWRkcmVzcy4gUmV0dXJucyBzdWNjZXNzLgogICAgLy8vIEBwYXJhbSB0byBBZGRyZXNzIG9mIHRva2VuIHJlY2VpdmVyLgogICAgLy8vIEBwYXJhbSB2YWx1ZSBOdW1iZXIgb2YgdG9rZW5zIHRvIHRyYW5zZmVyLgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIC8vIEJvdGggcGFydGllcyB3aXRoZHJhdyB0aGVpciByZXdhcmQgZmlyc3QKICAgICAgICBzaW5ndWxhckRUVkZ1bmQuc29mdFdpdGhkcmF3UmV3YXJkRm9yKG1zZy5zZW5kZXIpOwogICAgICAgIHNpbmd1bGFyRFRWRnVuZC5zb2Z0V2l0aGRyYXdSZXdhcmRGb3IodG8pOwogICAgICAgIHJldHVybiBzdXBlci50cmFuc2Zlcih0bywgdmFsdWUpOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyBhbGxvd2VkIHRoaXJkIHBhcnR5IHRvIHRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIuIFJldHVybnMgc3VjY2Vzcy4KICAgIC8vLyBAcGFyYW0gZnJvbSBBZGRyZXNzIGZyb20gd2hlcmUgdG9rZW5zIGFyZSB3aXRoZHJhd24uCiAgICAvLy8gQHBhcmFtIHRvIEFkZHJlc3MgdG8gd2hlcmUgdG9rZW5zIGFyZSBzZW50LgogICAgLy8vIEBwYXJhbSB2YWx1ZSBOdW1iZXIgb2YgdG9rZW5zIHRvIHRyYW5zZmVyLgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIC8vIEJvdGggcGFydGllcyB3aXRoZHJhdyB0aGVpciByZXdhcmQgZmlyc3QKICAgICAgICBzaW5ndWxhckRUVkZ1bmQuc29mdFdpdGhkcmF3UmV3YXJkRm9yKGZyb20pOwogICAgICAgIHNpbmd1bGFyRFRWRnVuZC5zb2Z0V2l0aGRyYXdSZXdhcmRGb3IodG8pOwogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oZnJvbSwgdG8sIHZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBTaW5ndWxhckRUVlRva2VuKGFkZHJlc3Mgc0RUVkZ1bmRBZGRyLCBhZGRyZXNzIF93YWxsZXQsIHN0cmluZyBfbmFtZSwgc3RyaW5nIF9zeW1ib2wsIHVpbnQgX3RvdGFsU3VwcGx5KSB7CiAgICAgICAgaWYoc0RUVkZ1bmRBZGRyID09IDAgfHwgX3dhbGxldCA9PSAwKSB7CiAgICAgICAgICAgIC8vIEZ1bmQgYW5kIFdhbGxldCBhZGRyZXNzZXMgc2hvdWxkIG5vdCBiZSBudWxsLgogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CgogICAgICAgIGJhbGFuY2VzW193YWxsZXRdID0gX3RvdGFsU3VwcGx5OwogICAgICAgIHRvdGFsU3VwcGx5ID0gX3RvdGFsU3VwcGx5OwoKICAgICAgICBuYW1lID0gX25hbWU7CiAgICAgICAgc3ltYm9sID0gX3N5bWJvbDsKCiAgICAgICAgc2luZ3VsYXJEVFZGdW5kID0gQWJzdHJhY3RTaW5ndWxhckRUVkZ1bmQoc0RUVkZ1bmRBZGRyKTsKCiAgICAgICAgVHJhbnNmZXIodGhpcywgX3dhbGxldCwgX3RvdGFsU3VwcGx5KTsKICAgIH0KfQoKCgoKCgoKCmNvbnRyYWN0IEFic3RyYWN0U2luZ3VsYXJEVFZUb2tlbiBpcyBUb2tlbiB7Cgp9CgoKLy8vIEB0aXRsZSBUb2tlbiBDcmVhdGlvbiBjb250cmFjdCAtIEltcGxlbWVudHMgdG9rZW4gY3JlYXRpb24gZnVuY3Rpb25hbGl0eS4KLy8vIEBhdXRob3IgU3RlZmFuIEdlb3JnZSAtIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImI4Y2JjY2RkZGVkOWQ2OTZkZmRkZDdjYWRmZGRmOGRiZDdkNmNiZGRkNmNiYzFjYjk2ZDZkZGNjIj5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4KLy8vIEBhdXRob3IgUmF6dmFuIFBvcCAtIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImUxOTM4MDliOTc4MDhmY2Y5MThlOTFhMTgyOGU4ZjkyODQ4ZjkyOTg5MmNmOGY4NDk1Ij5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4KLy8vIEBhdXRob3IgTWlsYWQgTW9zdGF2aSAtIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImY4OTU5MTk0OTk5Y2Q2OTU5NzhiOGM5OThlOTFiODliOTc5NjhiOWQ5NjhiODE4YmQ2OTY5ZDhjIj5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4KY29udHJhY3QgU2luZ3VsYXJEVFZMYXVuY2ggewogICAgc3RyaW5nIHB1YmxpYyB2ZXJzaW9uID0gIjAuMS4wIjsKCiAgICBldmVudCBDb250cmlidXRlZChhZGRyZXNzIGluZGV4ZWQgY29udHJpYnV0b3IsIHVpbnQgY29udHJpYnV0aW9uLCB1aW50IHRva2Vucyk7CgogICAgLyoKICAgICAqICBFeHRlcm5hbCBjb250cmFjdHMKICAgICAqLwogICAgQWJzdHJhY3RTaW5ndWxhckRUVlRva2VuIHB1YmxpYyBzaW5ndWxhckRUVlRva2VuOwogICAgYWRkcmVzcyBwdWJsaWMgd29ya3Nob3A7CiAgICBhZGRyZXNzIHB1YmxpYyBTaW5ndWxhckRUVldvcmtzaG9wID0gMHhjNzgzMTAyMzFhQTUzYkQzRDBGRUEyRjhjNzA1QzY3NzMwOTI5RDhmOwogICAgdWludCBwdWJsaWMgU2luZ3VsYXJEVFZXb3Jrc2hvcEZlZTsKCiAgICAvKgogICAgICogIENvbnN0YW50cwogICAgICovCiAgICB1aW50IHB1YmxpYyBDQVA7IC8vIGluIHdlaSBzY2FsZSBvZiB0b2tlbnMKICAgIHVpbnQgcHVibGljIERVUkFUSU9OOyAvLyBpbiBzZWNvbmRzCiAgICB1aW50IHB1YmxpYyBUT0tFTl9UQVJHRVQ7IC8vIEdvYWwgdGhyZXNob2xkIGluIHdlaSBzY2FsZSBvZiB0b2tlbnMKCiAgICAvKgogICAgICogIEVudW1zCiAgICAgKi8KICAgIGVudW0gU3RhZ2VzIHsKICAgICAgICBEZXBsb3llZCwKICAgICAgICBHb2luZ0FuZEdvYWxOb3RSZWFjaGVkLAogICAgICAgIEVuZGVkQW5kR29hbE5vdFJlYWNoZWQsCiAgICAgICAgR29pbmdBbmRHb2FsUmVhY2hlZCwKICAgICAgICBFbmRlZEFuZEdvYWxSZWFjaGVkCiAgICB9CgogICAgLyoKICAgICAqICBTdG9yYWdlCiAgICAgKi8KICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwogICAgdWludCBwdWJsaWMgc3RhcnREYXRlOwogICAgdWludCBwdWJsaWMgZnVuZEJhbGFuY2U7CiAgICB1aW50IHB1YmxpYyB2YWx1ZVBlclRva2VuOyAvL2luIHdlaQogICAgdWludCBwdWJsaWMgdG9rZW5zU2VudDsKCiAgICAvLyBwYXJ0aWNpcGFudCBhZGRyZXNzID0+IHZhbHVlIGluIFdlaQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgY29udHJpYnV0aW9uczsKCiAgICAvLyBwYXJ0aWNpcGFudCBhZGRyZXNzID0+IHRva2VuIGFtb3VudCBpbiB3ZWkgc2NhbGUKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgcHVibGljIHNlbnRUb2tlbnM7CgogICAgLy8gSW5pdGlhbGl6ZSBzdGFnZQogICAgU3RhZ2VzIHB1YmxpYyBzdGFnZSA9IFN0YWdlcy5EZXBsb3llZDsKCiAgICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICAgICAgLy8gT25seSBvd25lciBpcyBhbGxvd2VkIHRvIGRvIHRoaXMgYWN0aW9uLgogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IG93bmVyKSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIGF0U3RhZ2UoU3RhZ2VzIF9zdGFnZSkgewogICAgICAgIGlmIChzdGFnZSAhPSBfc3RhZ2UpIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgYXRTdGFnZU9SKFN0YWdlcyBfc3RhZ2UxLCBTdGFnZXMgX3N0YWdlMikgewogICAgICAgIGlmIChzdGFnZSAhPSBfc3RhZ2UxICYmIHN0YWdlICE9IF9zdGFnZTIpIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgdGltZWRUcmFuc2l0aW9ucygpIHsKICAgICAgICB1aW50IHRpbWVFbGFwc2VkID0gbm93IC0gc3RhcnREYXRlOwoKICAgICAgICBpZiAodGltZUVsYXBzZWQgPj0gRFVSQVRJT04pIHsKICAgICAgICAgICAgaWYgKHN0YWdlID09IFN0YWdlcy5Hb2luZ0FuZEdvYWxOb3RSZWFjaGVkKSB7CiAgICAgICAgICAgICAgICBzdGFnZSA9IFN0YWdlcy5FbmRlZEFuZEdvYWxOb3RSZWFjaGVkOwogICAgICAgICAgICB9IGVsc2UgaWYgKHN0YWdlID09IFN0YWdlcy5Hb2luZ0FuZEdvYWxSZWFjaGVkKSB7CiAgICAgICAgICAgICAgICBzdGFnZSA9IFN0YWdlcy5FbmRlZEFuZEdvYWxSZWFjaGVkOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIF87CiAgICB9CgogICAgLyoKICAgICAqICBDb250cmFjdCBmdW5jdGlvbnMKICAgICAqLwogICAgLy8vIGRldiBWYWxpZGF0ZXMgaW52YXJpYW50cy4KICAgIGZ1bmN0aW9uIGNoZWNrSW52YXJpYW50cygpIGNvbnN0YW50IGludGVybmFsIHsKICAgICAgICBpZiAoZnVuZEJhbGFuY2UgPiB0aGlzLmJhbGFuY2UpIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQogICAgfQoKICAgIC8vLyBAZGV2IENhbiBiZSB0cmlnZ2VyZWQgaWYgYW4gaW52YXJpYW50IGZhaWxzLgogICAgZnVuY3Rpb24gZW1lcmdlbmN5Q2FsbCgpCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICBpZiAoZnVuZEJhbGFuY2UgPiB0aGlzLmJhbGFuY2UpIHsKICAgICAgICAgICAgaWYgKHRoaXMuYmFsYW5jZSA+IDAgJiYgIVNpbmd1bGFyRFRWV29ya3Nob3Auc2VuZCh0aGlzLmJhbGFuY2UpKSB7CiAgICAgICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyB1c2VyIHRvIGNyZWF0ZSB0b2tlbnMgaWYgdG9rZW4gY3JlYXRpb24gaXMgc3RpbGwgZ29pbmcgYW5kIGNhcCBub3QgcmVhY2hlZC4gUmV0dXJucyB0b2tlbiBjb3VudC4KICAgIGZ1bmN0aW9uIGZ1bmQoKQogICAgICAgIHB1YmxpYwogICAgICAgIHRpbWVkVHJhbnNpdGlvbnMKICAgICAgICBhdFN0YWdlT1IoU3RhZ2VzLkdvaW5nQW5kR29hbE5vdFJlYWNoZWQsIFN0YWdlcy5Hb2luZ0FuZEdvYWxSZWFjaGVkKQogICAgICAgIHBheWFibGUKICAgICAgICByZXR1cm5zICh1aW50KQogICAgewogICAgICAgIHVpbnQgdG9rZW5Db3VudCA9IChtc2cudmFsdWUgKiAoMTAqKjE4KSkgLyB2YWx1ZVBlclRva2VuOyAvLyBUb2tlbiBjb3VudCBpbiB3ZWkgaXMgcm91bmRlZCBkb3duLiBTZW50IEVUSCBzaG91bGQgYmUgbXVsdGlwbGVzIG9mIHZhbHVlUGVyVG9rZW4uCiAgICAgICAgcmVxdWlyZSh0b2tlbkNvdW50ID4gMCk7CiAgICAgICAgaWYgKHRva2Vuc1NlbnQgKyB0b2tlbkNvdW50ID4gQ0FQKSB7CiAgICAgICAgICAgIC8vIFVzZXIgd2FudHMgdG8gY3JlYXRlIG1vcmUgdG9rZW5zIHRoYW4gYXZhaWxhYmxlLiBTZXQgdG9rZW5zIHRvIHBvc3NpYmxlIG1heGltdW0uCiAgICAgICAgICAgIHRva2VuQ291bnQgPSBDQVAgLSB0b2tlbnNTZW50OwogICAgICAgIH0KICAgICAgICB0b2tlbnNTZW50ICs9IHRva2VuQ291bnQ7CgogICAgICAgIHVpbnQgY29udHJpYnV0aW9uID0gKHRva2VuQ291bnQgKiB2YWx1ZVBlclRva2VuKSAvICgxMCoqMTgpOyAvLyBFdGhlciBzcGVudCBieSB1c2VyLgogICAgICAgIC8vIFNlbmQgY2hhbmdlIGJhY2sgdG8gdXNlci4KICAgICAgICBpZiAobXNnLnZhbHVlID4gY29udHJpYnV0aW9uICYmICFtc2cuc2VuZGVyLnNlbmQobXNnLnZhbHVlIC0gY29udHJpYnV0aW9uKSkgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CiAgICAgICAgLy8gVXBkYXRlIGZ1bmQgYW5kIHVzZXIncyBiYWxhbmNlIGFuZCB0b3RhbCBzdXBwbHkgb2YgdG9rZW5zLgogICAgICAgIGZ1bmRCYWxhbmNlICs9IGNvbnRyaWJ1dGlvbjsKICAgICAgICBjb250cmlidXRpb25zW21zZy5zZW5kZXJdICs9IGNvbnRyaWJ1dGlvbjsKICAgICAgICBzZW50VG9rZW5zW21zZy5zZW5kZXJdICs9IHRva2VuQ291bnQ7CiAgICAgICAgaWYgKCFzaW5ndWxhckRUVlRva2VuLnRyYW5zZmVyKG1zZy5zZW5kZXIsIHRva2VuQ291bnQpKSB7CiAgICAgICAgICAgIC8vIFRva2VucyBjb3VsZCBub3QgYmUgaXNzdWVkLgogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CiAgICAgICAgLy8gVXBkYXRlIHN0YWdlCiAgICAgICAgaWYgKHN0YWdlID09IFN0YWdlcy5Hb2luZ0FuZEdvYWxOb3RSZWFjaGVkKSB7CiAgICAgICAgICAgIGlmICh0b2tlbnNTZW50ID49IFRPS0VOX1RBUkdFVCkgewogICAgICAgICAgICAgICAgc3RhZ2UgPSBTdGFnZXMuR29pbmdBbmRHb2FsUmVhY2hlZDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAvLyBub3QgYW4gZWxzZSBjbGF1c2UgZm9yIHRoZSBlZGdlIGNhc2UgdGhhdCB0aGUgQ0FQIGFuZCBUT0tFTl9UQVJHRVQgYXJlIHJlYWNoZWQgaW4gb25lIGNhbGwKICAgICAgICBpZiAoc3RhZ2UgPT0gU3RhZ2VzLkdvaW5nQW5kR29hbFJlYWNoZWQpIHsKICAgICAgICAgICAgaWYgKHRva2Vuc1NlbnQgPT0gQ0FQKSB7CiAgICAgICAgICAgICAgICBzdGFnZSA9IFN0YWdlcy5FbmRlZEFuZEdvYWxSZWFjaGVkOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNoZWNrSW52YXJpYW50cygpOwoKICAgICAgICBDb250cmlidXRlZChtc2cuc2VuZGVyLCBjb250cmlidXRpb24sIHRva2VuQ291bnQpOwoKICAgICAgICByZXR1cm4gdG9rZW5Db3VudDsKICAgIH0KCiAgICAvLy8gQGRldiBBbGxvd3MgdXNlciB0byB3aXRoZHJhdyBFVEggaWYgdG9rZW4gY3JlYXRpb24gcGVyaW9kIGVuZGVkIGFuZCB0YXJnZXQgd2FzIG5vdCByZWFjaGVkLiBSZXR1cm5zIGNvbnRyaWJ1dGlvbi4KICAgIGZ1bmN0aW9uIHdpdGhkcmF3Q29udHJpYnV0aW9uKCkKICAgICAgICBwdWJsaWMKICAgICAgICB0aW1lZFRyYW5zaXRpb25zCiAgICAgICAgYXRTdGFnZShTdGFnZXMuRW5kZWRBbmRHb2FsTm90UmVhY2hlZCkKICAgICAgICByZXR1cm5zICh1aW50KQogICAgewogICAgICAgIC8vIFdlIGdldCBiYWNrIHRoZSB0b2tlbnMgZnJvbSB0aGUgY29udHJpYnV0b3IgYmVmb3JlIGdpdmluZyBiYWNrIGhpcyBjb250cmlidXRpb24KICAgICAgICB1aW50IHRva2Vuc1JlY2VpdmVkID0gc2VudFRva2Vuc1ttc2cuc2VuZGVyXTsKICAgICAgICBzZW50VG9rZW5zW21zZy5zZW5kZXJdID0gMDsKICAgICAgICBpZiAoIXNpbmd1bGFyRFRWVG9rZW4udHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIG93bmVyLCB0b2tlbnNSZWNlaXZlZCkpIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQoKICAgICAgICAvLyBVcGRhdGUgZnVuZCdzIGFuZCB1c2VyJ3MgYmFsYW5jZSBhbmQgdG90YWwgc3VwcGx5IG9mIHRva2Vucy4KICAgICAgICB1aW50IGNvbnRyaWJ1dGlvbiA9IGNvbnRyaWJ1dGlvbnNbbXNnLnNlbmRlcl07CiAgICAgICAgY29udHJpYnV0aW9uc1ttc2cuc2VuZGVyXSA9IDA7CiAgICAgICAgZnVuZEJhbGFuY2UgLT0gY29udHJpYnV0aW9uOwogICAgICAgIC8vIFNlbmQgRVRIIGJhY2sgdG8gdXNlci4KICAgICAgICBpZiAoY29udHJpYnV0aW9uID4gMCkgewogICAgICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKGNvbnRyaWJ1dGlvbik7CiAgICAgICAgfQogICAgICAgIGNoZWNrSW52YXJpYW50cygpOwogICAgICAgIHJldHVybiBjb250cmlidXRpb247CiAgICB9CgogICAgLy8vIEBkZXYgV2l0aGRyYXdzIEVUSCB0byB3b3Jrc2hvcCBhZGRyZXNzLiBSZXR1cm5zIHN1Y2Nlc3MuCiAgICBmdW5jdGlvbiB3aXRoZHJhd0ZvcldvcmtzaG9wKCkKICAgICAgICBwdWJsaWMKICAgICAgICB0aW1lZFRyYW5zaXRpb25zCiAgICAgICAgYXRTdGFnZShTdGFnZXMuRW5kZWRBbmRHb2FsUmVhY2hlZCkKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHVpbnQgdmFsdWUgPSBmdW5kQmFsYW5jZTsKICAgICAgICBmdW5kQmFsYW5jZSA9IDA7CgogICAgICAgIHJlcXVpcmUodmFsdWUgPiAwKTsKCiAgICAgICAgdWludCBuZXR3b3JrRmVlID0gdmFsdWUgKiBTaW5ndWxhckRUVldvcmtzaG9wRmVlIC8gMTAwOwogICAgICAgIHdvcmtzaG9wLnRyYW5zZmVyKHZhbHVlIC0gbmV0d29ya0ZlZSk7CiAgICAgICAgU2luZ3VsYXJEVFZXb3Jrc2hvcC50cmFuc2ZlcihuZXR3b3JrRmVlKTsKCiAgICAgICAgdWludCByZW1haW5pbmdUb2tlbnMgPSBDQVAgLSB0b2tlbnNTZW50OwogICAgICAgIGlmIChyZW1haW5pbmdUb2tlbnMgPiAwICYmICFzaW5ndWxhckRUVlRva2VuLnRyYW5zZmVyKG93bmVyLCByZW1haW5pbmdUb2tlbnMpKSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KCiAgICAgICAgY2hlY2tJbnZhcmlhbnRzKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8vIEBkZXYgQWxsb3dzIG93bmVyIHRvIGdldCBiYWNrIHVuc2VudCB0b2tlbnMgaW4gY2FzZSBvZiBsYXVuY2ggZmFpbHVyZSAoRW5kZWRBbmRHb2FsTm90UmVhY2hlZCkuCiAgICBmdW5jdGlvbiB3aXRoZHJhd1Vuc2VudFRva2Vuc0Zvck93bmVyKCkKICAgICAgICBwdWJsaWMKICAgICAgICB0aW1lZFRyYW5zaXRpb25zCiAgICAgICAgYXRTdGFnZShTdGFnZXMuRW5kZWRBbmRHb2FsTm90UmVhY2hlZCkKICAgICAgICByZXR1cm5zICh1aW50KQogICAgewogICAgICAgIHVpbnQgcmVtYWluaW5nVG9rZW5zID0gQ0FQIC0gdG9rZW5zU2VudDsKICAgICAgICBpZiAocmVtYWluaW5nVG9rZW5zID4gMCAmJiAhc2luZ3VsYXJEVFZUb2tlbi50cmFuc2Zlcihvd25lciwgcmVtYWluaW5nVG9rZW5zKSkgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CgogICAgICAgIGNoZWNrSW52YXJpYW50cygpOwogICAgICAgIHJldHVybiByZW1haW5pbmdUb2tlbnM7CiAgICB9CgogICAgLy8vIEBkZXYgU2V0cyB0b2tlbiB2YWx1ZSBpbiBXZWkuCiAgICAvLy8gQHBhcmFtIHZhbHVlSW5XZWkgTmV3IHZhbHVlLgogICAgZnVuY3Rpb24gY2hhbmdlVmFsdWVQZXJUb2tlbih1aW50IHZhbHVlSW5XZWkpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seU93bmVyCiAgICAgICAgYXRTdGFnZShTdGFnZXMuRGVwbG95ZWQpCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICB2YWx1ZVBlclRva2VuID0gdmFsdWVJbldlaTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyB1cGRhdGVTdGFnZSBhbGxvd3MgY2FsbHMgdG8gcmVjZWl2ZSBjb3JyZWN0IHN0YWdlLiBJdCBjYW4gYmUgdXNlZCBmb3IgdHJhbnNhY3Rpb25zIGJ1dCBpcyBub3QgcGFydCBvZiB0aGUgcmVndWxhciB0b2tlbiBjcmVhdGlvbiByb3V0aW5lLgogICAgLy8gSXQgaXMgbm90IG1hcmtlZCBhcyBjb25zdGFudCBiZWNhdXNlIHRpbWVkVHJhbnNpdGlvbnMgbW9kaWZpZXIgaXMgYWx0ZXJpbmcgc3RhdGUgYW5kIGNvbnN0YW50IGlzIG5vdCB5ZXQgZW5mb3JjZWQgYnkgc29sYy4KICAgIC8vLyBAZGV2IHJldHVybnMgY29ycmVjdCBzdGFnZSwgZXZlbiBpZiBhIGZ1bmN0aW9uIHdpdGggdGltZWRUcmFuc2l0aW9ucyBtb2RpZmllciBoYXMgbm90IHlldCBiZWVuIGNhbGxlZCBzdWNjZXNzZnVsbHkuCiAgICBmdW5jdGlvbiB1cGRhdGVTdGFnZSgpCiAgICAgICAgcHVibGljCiAgICAgICAgdGltZWRUcmFuc2l0aW9ucwogICAgICAgIHJldHVybnMgKFN0YWdlcykKICAgIHsKICAgICAgICByZXR1cm4gc3RhZ2U7CiAgICB9CgogICAgZnVuY3Rpb24gc3RhcnQoKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlPd25lcgogICAgICAgIGF0U3RhZ2UoU3RhZ2VzLkRlcGxveWVkKQogICAgICAgIHJldHVybnMgKHVpbnQpCiAgICB7CiAgICAgICAgaWYgKCFzaW5ndWxhckRUVlRva2VuLnRyYW5zZmVyRnJvbShtc2cuc2VuZGVyLCB0aGlzLCBDQVApKSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KCiAgICAgICAgc3RhcnREYXRlID0gbm93OwogICAgICAgIHN0YWdlID0gU3RhZ2VzLkdvaW5nQW5kR29hbE5vdFJlYWNoZWQ7CgogICAgICAgIGNoZWNrSW52YXJpYW50cygpOwogICAgICAgIHJldHVybiBzdGFydERhdGU7CiAgICB9CgogICAgLy8vIEBkZXYgQ29udHJhY3QgY29uc3RydWN0b3IgZnVuY3Rpb24gc2V0cyBvd25lciBhbmQgc3RhcnQgZGF0ZS4KICAgIGZ1bmN0aW9uIFNpbmd1bGFyRFRWTGF1bmNoKAogICAgICAgIGFkZHJlc3Mgc2luZ3VsYXJEVFZUb2tlbkFkZHJlc3MsCiAgICAgICAgYWRkcmVzcyBfd29ya3Nob3AsCiAgICAgICAgYWRkcmVzcyBfb3duZXIsCiAgICAgICAgdWludCBfdG90YWwsCiAgICAgICAgdWludCBfdW5pdF9wcmljZSwKICAgICAgICB1aW50IF9kdXJhdGlvbiwKICAgICAgICB1aW50IF90aHJlc2hvbGQsCiAgICAgICAgdWludCBfc2luZ3VsYXJkdHZ3b3NraG9wX2ZlZQogICAgICAgICkgewogICAgICAgIHNpbmd1bGFyRFRWVG9rZW4gPSBBYnN0cmFjdFNpbmd1bGFyRFRWVG9rZW4oc2luZ3VsYXJEVFZUb2tlbkFkZHJlc3MpOwogICAgICAgIHdvcmtzaG9wID0gX3dvcmtzaG9wOwogICAgICAgIG93bmVyID0gX293bmVyOwogICAgICAgIENBUCA9IF90b3RhbDsgLy8gVG90YWwgbnVtYmVyIG9mIHRva2VucyAod2VpIHNjYWxlKQogICAgICAgIHZhbHVlUGVyVG9rZW4gPSBfdW5pdF9wcmljZTsgLy8gd2VpIHBlciB0b2tlbgogICAgICAgIERVUkFUSU9OID0gX2R1cmF0aW9uOyAvLyBpbiBzZWNvbmRzCiAgICAgICAgVE9LRU5fVEFSR0VUID0gX3RocmVzaG9sZDsgLy8gR29hbCB0aHJlc2hvbGQKICAgICAgICBTaW5ndWxhckRUVldvcmtzaG9wRmVlID0gX3Npbmd1bGFyZHR2d29za2hvcF9mZWU7CiAgICB9CgogICAgLy8vIEBkZXYgRmFsbGJhY2sgZnVuY3Rpb24gYWN0cyBhcyBmdW5kKCkgd2hlbiBzdGFnZSBHb2luZ0FuZEdvYWxOb3RSZWFjaGVkCiAgICAvLy8gb3IgR29pbmdBbmRHb2FsUmVhY2hlZC4gQW5kIGFjdCBhcyB3aXRoZHJhd0Z1bmRpbmcoKSB3aGVuIEVuZGVkQW5kR29hbE5vdFJlYWNoZWQuCiAgICAvLy8gb3RoZXJ3aXNlIHRocm93LgogICAgZnVuY3Rpb24gKCkKICAgICAgICBwdWJsaWMKICAgICAgICBwYXlhYmxlCiAgICB7CiAgICAgICAgaWYgKHN0YWdlID09IFN0YWdlcy5Hb2luZ0FuZEdvYWxOb3RSZWFjaGVkIHx8IHN0YWdlID09IFN0YWdlcy5Hb2luZ0FuZEdvYWxSZWFjaGVkKQogICAgICAgICAgICBmdW5kKCk7CiAgICAgICAgZWxzZSBpZiAoc3RhZ2UgPT0gU3RhZ2VzLkVuZGVkQW5kR29hbE5vdFJlYWNoZWQpCiAgICAgICAgICAgIHdpdGhkcmF3Q29udHJpYnV0aW9uKCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICByZXZlcnQoKTsKICAgIH0KfQoKCgoKCgoKY29udHJhY3QgVG9raXREZXBsb3llciBpcyBPd25hYmxlIHsKCiAgICBUb2tpdFJlZ2lzdHJ5IHB1YmxpYyByZWdpc3RyeTsKCiAgICAvLyBwYXltZW50X3R5cGUgPT4gcGF5bWVudF9jb250cmFjdAogICAgbWFwcGluZyAodWludDggPT4gQWJzdHJhY3RQYXltZW50RXNjcm93KSBwdWJsaWMgcGF5bWVudENvbnRyYWN0czsKCiAgICBldmVudCBEZXBsb3llZFRva2VuKGFkZHJlc3MgaW5kZXhlZCBfY3VzdG9tZXIsIHVpbnQgaW5kZXhlZCBfcHJvamVjdElkLCBhZGRyZXNzIF90b2tlbiwgYWRkcmVzcyBfZnVuZCk7CiAgICBldmVudCBEZXBsb3llZENhbXBhaWduKGFkZHJlc3MgaW5kZXhlZCBfY3VzdG9tZXIsIHVpbnQgaW5kZXhlZCBfcHJvamVjdElkLCBhZGRyZXNzIF9jYW1wYWlnbik7CgoKICAgIGZ1bmN0aW9uIFRva2l0RGVwbG95ZXIoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3JlZ2lzdHJ5KSB7CiAgICAgICAgdHJhbnNmZXJPd25lcnNoaXAoX293bmVyKTsKICAgICAgICByZWdpc3RyeSA9IFRva2l0UmVnaXN0cnkoX3JlZ2lzdHJ5KTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZXBsb3lUb2tlbigKICAgICAgICBhZGRyZXNzIF9jdXN0b21lciwgdWludCBfcHJvamVjdElkLCB1aW50OCBfcGF5ZWRXaXRoLCB1aW50IF9hbW91bnROZWVkZWQsCiAgICAgICAgLy8gU2luZ3VsYXJEVFZUb2tlbgogICAgICAgIGFkZHJlc3MgX3dhbGxldCwgc3RyaW5nIF9uYW1lLCBzdHJpbmcgX3N5bWJvbCwgdWludCBfdG90YWxTdXBwbHkKICAgICkKICAgICAgICBvbmx5T3duZXIoKQogICAgewogICAgICAgIC8vIHBheWVkIGZvcgogICAgICAgIHJlcXVpcmUoQWJzdHJhY3RQYXltZW50RXNjcm93KHBheW1lbnRDb250cmFjdHNbX3BheWVkV2l0aF0pLmdldERlcG9zaXQoX3Byb2plY3RJZCkgPj0gX2Ftb3VudE5lZWRlZCk7CgogICAgICAgIHZhciAodCwsKSA9IHJlZ2lzdHJ5Lmxvb2t1cChfY3VzdG9tZXIsIF9wcm9qZWN0SWQpOwogICAgICAgIC8vIG5vdCBkZXBsb3llZCB5ZXQKICAgICAgICByZXF1aXJlKHQgPT0gYWRkcmVzcygwKSk7CgoKICAgICAgICBTaW5ndWxhckRUVkZ1bmQgZnVuZCA9IG5ldyBTaW5ndWxhckRUVkZ1bmQoKTsKICAgICAgICBTaW5ndWxhckRUVlRva2VuIHRva2VuID0gbmV3IFNpbmd1bGFyRFRWVG9rZW4oZnVuZCwgX3dhbGxldCwgX25hbWUsIF9zeW1ib2wsIF90b3RhbFN1cHBseSk7CiAgICAgICAgZnVuZC5zZXR1cCh0b2tlbik7CgogICAgICAgIHJlZ2lzdHJ5LnJlZ2lzdGVyKF9jdXN0b21lciwgX3Byb2plY3RJZCwgdG9rZW4sIGZ1bmQpOwoKICAgICAgICBEZXBsb3llZFRva2VuKF9jdXN0b21lciwgX3Byb2plY3RJZCwgdG9rZW4sIGZ1bmQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlcGxveUNhbXBhaWduKAogICAgICAgIGFkZHJlc3MgX2N1c3RvbWVyLCB1aW50IF9wcm9qZWN0SWQsCiAgICAgICAgLy8gU2luZ3VsYXJEVFZMYXVuY2gKICAgICAgICBhZGRyZXNzIF93b3Jrc2hvcCwgdWludCBfdG90YWwsIHVpbnQgX3VuaXRQcmljZSwgdWludCBfZHVyYXRpb24sIHVpbnQgX3RocmVzaG9sZCwgdWludCBfbmV0d29ya0ZlZQogICAgKQogICAgICAgIG9ubHlPd25lcigpCiAgICB7CiAgICAgICAgdmFyICh0LGYsYykgPSByZWdpc3RyeS5sb29rdXAoX2N1c3RvbWVyLCBfcHJvamVjdElkKTsKICAgICAgICAvLyBub3QgZGVwbG95ZWQgeWV0CiAgICAgICAgcmVxdWlyZShjID09IGFkZHJlc3MoMCkpOwoKICAgICAgICAvLyBwYXllZCBmb3IsIHRva2VuICYgZnVuZCBkZXBsb3llZAogICAgICAgIHJlcXVpcmUodCAhPSBhZGRyZXNzKDApICYmIGYgIT0gYWRkcmVzcygwKSk7CgogICAgICAgIFNpbmd1bGFyRFRWTGF1bmNoIGNhbXBhaWduID0gbmV3IFNpbmd1bGFyRFRWTGF1bmNoKHQsIF93b3Jrc2hvcCwgX2N1c3RvbWVyLCBfdG90YWwsIF91bml0UHJpY2UsIF9kdXJhdGlvbiwgX3RocmVzaG9sZCwgX25ldHdvcmtGZWUpOwoKICAgICAgICByZWdpc3RyeS5yZWdpc3RlcihfY3VzdG9tZXIsIF9wcm9qZWN0SWQsIGNhbXBhaWduKTsKCiAgICAgICAgRGVwbG95ZWRDYW1wYWlnbihfY3VzdG9tZXIsIF9wcm9qZWN0SWQsIGNhbXBhaWduKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRSZWdpc3RyeUNvbnRyYWN0KGFkZHJlc3MgX3JlZ2lzdHJ5KQogICAgICAgIG9ubHlPd25lcigpCiAgICB7CiAgICAgICAgcmVnaXN0cnkgPSBUb2tpdFJlZ2lzdHJ5KF9yZWdpc3RyeSk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0UGF5bWVudENvbnRyYWN0KHVpbnQ4IF9wYXltZW50VHlwZSwgYWRkcmVzcyBfcGF5bWVudENvbnRyYWN0KQogICAgICAgIG9ubHlPd25lcigpCiAgICB7CiAgICAgICAgcGF5bWVudENvbnRyYWN0c1tfcGF5bWVudFR5cGVdID0gQWJzdHJhY3RQYXltZW50RXNjcm93KF9wYXltZW50Q29udHJhY3QpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlbGV0ZVBheW1lbnRDb250cmFjdCh1aW50OCBfcGF5bWVudFR5cGUpCiAgICAgICAgb25seU93bmVyKCkKICAgIHsKICAgICAgICBkZWxldGUgcGF5bWVudENvbnRyYWN0c1tfcGF5bWVudFR5cGVdOwogICAgfQp9'.
	

]
