Class {
	#name : #SRT5B5d8A8A732A3c73fF0fB6980880Ef399ecaf72E,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT5B5d8A8A732A3c73fF0fB6980880Ef399ecaf72E >> base64 [
	^ 'LyoKVGhpcyBmaWxlIGlzIHBhcnQgb2YgdGhlIFBST09GIENvbnRyYWN0LgoKVGhlIFBST09GIENvbnRyYWN0IGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgptb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgbGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkCmJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCihhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgpUaGUgUFJPT0YgQ29udHJhY3QgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiBTZWUgdGhlCkdOVSBsZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgoKWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIGxlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCmFsb25nIHdpdGggdGhlIFBST09GIENvbnRyYWN0LiBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCgpAYXV0aG9yIElseWEgU3ZpcmluIDw8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImE4YzE4NmRiZGVjMWRhYzFjNmU4YzZjN2RhY2NjOWRlYzFjNmNjODZkYWRkIj5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPj4KKi8KCnByYWdtYSBzb2xpZGl0eSBeMC40LjA7Cgpjb250cmFjdCBvd25lZCB7CiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKICAgIGFkZHJlc3MgcHVibGljIG5ld093bmVyOwoKICAgIGZ1bmN0aW9uIG93bmVkKCkgcGF5YWJsZSB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQogICAgCiAgICBtb2RpZmllciBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUob3duZXIgPT0gbXNnLnNlbmRlcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGFuZ2VPd25lcihhZGRyZXNzIF9vd25lcikgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfb3duZXIgIT0gMCk7CiAgICAgICAgbmV3T3duZXIgPSBfb3duZXI7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNvbmZpcm1Pd25lcigpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShuZXdPd25lciA9PSBtc2cuc2VuZGVyKTsKICAgICAgICBvd25lciA9IG5ld093bmVyOwogICAgICAgIGRlbGV0ZSBuZXdPd25lcjsKICAgIH0KfQoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCB7CiAgICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgY29uc3RhbnQgcmV0dXJucyAodWludCk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50IHZhbHVlKTsKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludCB2YWx1ZSk7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludCB2YWx1ZSk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50IHZhbHVlKTsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQgdmFsdWUpOwp9Cgpjb250cmFjdCBNYW51YWxNaWdyYXRpb24gaXMgb3duZWQsIEVSQzIwIHsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgaW50ZXJuYWwgYmFsYW5jZXM7CiAgICBhZGRyZXNzIHB1YmxpYyBtaWdyYXRpb25Ib3N0OwoKICAgIGZ1bmN0aW9uIE1hbnVhbE1pZ3JhdGlvbihhZGRyZXNzIF9taWdyYXRpb25Ib3N0KSBwYXlhYmxlIG93bmVkKCkgewogICAgICAgIG1pZ3JhdGlvbkhvc3QgPSBfbWlncmF0aW9uSG9zdDsKICAgICAgICAvL2JhbGFuY2VzW3RoaXNdID0gRVJDMjAobWlncmF0aW9uSG9zdCkuYmFsYW5jZU9mKG1pZ3JhdGlvbkhvc3QpOwogICAgfQoKICAgIGZ1bmN0aW9uIG1pZ3JhdGVNYW51YWwoYWRkcmVzcyBfdG9rZW5zSG9sZGVyKSBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUobWlncmF0aW9uSG9zdCAhPSAwKTsKICAgICAgICB1aW50IHRva2VucyA9IEVSQzIwKG1pZ3JhdGlvbkhvc3QpLmJhbGFuY2VPZihfdG9rZW5zSG9sZGVyKTsKICAgICAgICB0b2tlbnMgPSB0b2tlbnMgKiAxMjUgLyAxMDA7CiAgICAgICAgYmFsYW5jZXNbX3Rva2Vuc0hvbGRlcl0gPSB0b2tlbnM7CiAgICAgICAgdG90YWxTdXBwbHkgKz0gdG9rZW5zOwogICAgICAgIFRyYW5zZmVyKG1pZ3JhdGlvbkhvc3QsIF90b2tlbnNIb2xkZXIsIHRva2Vucyk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHNlYWxNYW51YWxNaWdyYXRpb24oKSBvbmx5T3duZXIgewogICAgICAgIGRlbGV0ZSBtaWdyYXRpb25Ib3N0OwogICAgfQp9CgovKioKICogQHRpdGxlIENyb3dkc2FsZSBpbXBsZW1lbnRhdGlvbgogKi8KY29udHJhY3QgQ3Jvd2RzYWxlIGlzIE1hbnVhbE1pZ3JhdGlvbiB7CiAgICB1aW50ICAgIHB1YmxpYyBldGhlclByaWNlOwogICAgYWRkcmVzcyBwdWJsaWMgY3Jvd2RzYWxlT3duZXI7CiAgICB1aW50ICAgIHB1YmxpYyB0b3RhbExpbWl0VVNEOwogICAgdWludCAgICBwdWJsaWMgbWluaW1hbFN1Y2Nlc3NVU0Q7CiAgICB1aW50ICAgIHB1YmxpYyBjb2xsZWN0ZWRVU0Q7CgogICAgZW51bSBTdGF0ZSB7IERpc2FibGVkLCBQcmVJQ08sIENvbXBsZXRlUHJlSUNPLCBDcm93ZHNhbGUsIEVuYWJsZWQsIE1pZ3JhdGlvbiB9CiAgICBldmVudCBOZXdTdGF0ZShTdGF0ZSBzdGF0ZSk7CiAgICBTdGF0ZSAgIHB1YmxpYyBzdGF0ZSA9IFN0YXRlLkRpc2FibGVkOwogICAgdWludCAgICBwdWJsaWMgY3Jvd2RzYWxlU3RhcnRUaW1lOwogICAgdWludCAgICBwdWJsaWMgY3Jvd2RzYWxlRmluaXNoVGltZTsKCiAgICBtb2RpZmllciBlbmFibGVkU3RhdGUgewogICAgICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuRW5hYmxlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBlbmFibGVkT3JNaWdyYXRpb25TdGF0ZSB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5FbmFibGVkIHx8IHN0YXRlID09IFN0YXRlLk1pZ3JhdGlvbik7CiAgICAgICAgXzsKICAgIH0KCiAgICBzdHJ1Y3QgSW52ZXN0b3IgewogICAgICAgIHVpbnQgYW1vdW50VG9rZW5zOwogICAgICAgIHVpbnQgYW1vdW50V2VpOwogICAgfQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBJbnZlc3RvcikgcHVibGljIGludmVzdG9yczsKICAgIG1hcHBpbmcgKHVpbnQgPT4gYWRkcmVzcykgICAgIHB1YmxpYyBpbnZlc3RvcnNJdGVyOwogICAgdWludCAgICAgICAgICAgICAgICAgICAgICAgICAgcHVibGljIG51bWJlck9mSW52ZXN0b3JzOwoKICAgIGZ1bmN0aW9uIENyb3dkc2FsZShhZGRyZXNzIF9taWdyYXRpb25Ib3N0KQogICAgICAgIHBheWFibGUgTWFudWFsTWlncmF0aW9uKF9taWdyYXRpb25Ib3N0KSB7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uICgpIHBheWFibGUgewogICAgICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuUHJlSUNPIHx8IHN0YXRlID09IFN0YXRlLkNyb3dkc2FsZSk7CiAgICAgICAgcmVxdWlyZShub3cgPCBjcm93ZHNhbGVGaW5pc2hUaW1lKTsKICAgICAgICB1aW50IHZhbHVlV2VpID0gbXNnLnZhbHVlOwogICAgICAgIHVpbnQgdmFsdWVVU0QgPSB2YWx1ZVdlaSAqIGV0aGVyUHJpY2UgLyAxMDAwMDAwMDAwMDAwMDAwMDAwOwogICAgICAgIGlmIChjb2xsZWN0ZWRVU0QgKyB2YWx1ZVVTRCA+IHRvdGFsTGltaXRVU0QpIHsgLy8gZG9uJ3QgbmVlZCBzbyBtdWNoIGV0aGVyCiAgICAgICAgICAgIHZhbHVlVVNEID0gdG90YWxMaW1pdFVTRCAtIGNvbGxlY3RlZFVTRDsKICAgICAgICAgICAgdmFsdWVXZWkgPSB2YWx1ZVVTRCAqIDEwMDAwMDAwMDAwMDAwMDAwMDAgLyBldGhlclByaWNlOwogICAgICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIuY2FsbC5nYXMoMzAwMDAwMCkudmFsdWUobXNnLnZhbHVlIC0gdmFsdWVXZWkpKCkpOwogICAgICAgICAgICBjb2xsZWN0ZWRVU0QgPSB0b3RhbExpbWl0VVNEOyAvLyB0byBiZSBzdXJlIQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbGxlY3RlZFVTRCArPSB2YWx1ZVVTRDsKICAgICAgICB9CiAgICAgICAgbWludFRva2Vucyhtc2cuc2VuZGVyLCB2YWx1ZVVTRCwgdmFsdWVXZWkpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlcG9zaXRVU0QoYWRkcmVzcyBfd2hvLCB1aW50IF92YWx1ZVVTRCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5QcmVJQ08gfHwgc3RhdGUgPT0gU3RhdGUuQ3Jvd2RzYWxlKTsKICAgICAgICByZXF1aXJlKG5vdyA8IGNyb3dkc2FsZUZpbmlzaFRpbWUpOwogICAgICAgIHJlcXVpcmUoY29sbGVjdGVkVVNEICsgX3ZhbHVlVVNEIDw9IHRvdGFsTGltaXRVU0QpOwogICAgICAgIGNvbGxlY3RlZFVTRCArPSBfdmFsdWVVU0Q7CiAgICAgICAgbWludFRva2Vucyhfd2hvLCBfdmFsdWVVU0QsIDApOwogICAgfQoKICAgIGZ1bmN0aW9uIG1pbnRUb2tlbnMoYWRkcmVzcyBfd2hvLCB1aW50IF92YWx1ZVVTRCwgdWludCBfdmFsdWVXZWkpIGludGVybmFsIHsKICAgICAgICB1aW50IHRva2Vuc1BlclVTRCA9IDEwMDsKICAgICAgICBpZiAoc3RhdGUgPT0gU3RhdGUuUHJlSUNPKSB7CiAgICAgICAgICAgIGlmIChub3cgPCBjcm93ZHNhbGVTdGFydFRpbWUgKyAxIGRheXMgJiYgX3ZhbHVlVVNEID49IDUwMDAwKSB7CiAgICAgICAgICAgICAgICB0b2tlbnNQZXJVU0QgPSAxNTA7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0b2tlbnNQZXJVU0QgPSAxMjU7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHN0YXRlID09IFN0YXRlLkNyb3dkc2FsZSkgewogICAgICAgICAgICBpZiAobm93IDwgY3Jvd2RzYWxlU3RhcnRUaW1lICsgMSBkYXlzKSB7CiAgICAgICAgICAgICAgICB0b2tlbnNQZXJVU0QgPSAxMTU7CiAgICAgICAgICAgIH0gZWxzZSBpZiAobm93IDwgY3Jvd2RzYWxlU3RhcnRUaW1lICsgMSB3ZWVrcykgewogICAgICAgICAgICAgICAgdG9rZW5zUGVyVVNEID0gMTEwOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHVpbnQgdG9rZW5zID0gdG9rZW5zUGVyVVNEICogX3ZhbHVlVVNEOwogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbX3dob10gKyB0b2tlbnMgPiBiYWxhbmNlc1tfd2hvXSk7IC8vIG92ZXJmbG93CiAgICAgICAgcmVxdWlyZSh0b2tlbnMgPiAwKTsKICAgICAgICBJbnZlc3RvciBzdG9yYWdlIGludiA9IGludmVzdG9yc1tfd2hvXTsKICAgICAgICBpZiAoaW52LmFtb3VudFRva2VucyA9PSAwKSB7IC8vIG5ldyBpbnZlc3RvcgogICAgICAgICAgICBpbnZlc3RvcnNJdGVyW251bWJlck9mSW52ZXN0b3JzKytdID0gX3dobzsKICAgICAgICB9CiAgICAgICAgaW52LmFtb3VudFRva2VucyArPSB0b2tlbnM7CiAgICAgICAgaW52LmFtb3VudFdlaSArPSBfdmFsdWVXZWk7CiAgICAgICAgYmFsYW5jZXNbX3dob10gKz0gdG9rZW5zOwogICAgICAgIFRyYW5zZmVyKHRoaXMsIF93aG8sIHRva2Vucyk7CiAgICAgICAgdG90YWxTdXBwbHkgKz0gdG9rZW5zOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBzdGFydFRva2Vuc1NhbGUoCiAgICAgICAgICAgIGFkZHJlc3MgX2Nyb3dkc2FsZU93bmVyLAogICAgICAgICAgICB1aW50ICAgIF9jcm93ZHNhbGVEdXJhdGlvbkRheXMsCiAgICAgICAgICAgIHVpbnQgICAgX3RvdGFsTGltaXRVU0QsCiAgICAgICAgICAgIHVpbnQgICAgX21pbmltYWxTdWNjZXNzVVNELAogICAgICAgICAgICB1aW50ICAgIF9ldGhlclByaWNlKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLkRpc2FibGVkIHx8IHN0YXRlID09IFN0YXRlLkNvbXBsZXRlUHJlSUNPKTsKICAgICAgICBjcm93ZHNhbGVTdGFydFRpbWUgPSBub3c7CiAgICAgICAgY3Jvd2RzYWxlT3duZXIgPSBfY3Jvd2RzYWxlT3duZXI7CiAgICAgICAgZXRoZXJQcmljZSA9IF9ldGhlclByaWNlOwogICAgICAgIGRlbGV0ZSBudW1iZXJPZkludmVzdG9yczsKICAgICAgICBkZWxldGUgY29sbGVjdGVkVVNEOwogICAgICAgIGNyb3dkc2FsZUZpbmlzaFRpbWUgPSBub3cgKyBfY3Jvd2RzYWxlRHVyYXRpb25EYXlzICogMSBkYXlzOwogICAgICAgIHRvdGFsTGltaXRVU0QgPSBfdG90YWxMaW1pdFVTRDsKICAgICAgICBtaW5pbWFsU3VjY2Vzc1VTRCA9IF9taW5pbWFsU3VjY2Vzc1VTRDsKICAgICAgICBpZiAoc3RhdGUgPT0gU3RhdGUuRGlzYWJsZWQpIHsKICAgICAgICAgICAgc3RhdGUgPSBTdGF0ZS5QcmVJQ087CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RhdGUgPSBTdGF0ZS5Dcm93ZHNhbGU7CiAgICAgICAgfQogICAgICAgIE5ld1N0YXRlKHN0YXRlKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gdGltZVRvRmluaXNoVG9rZW5zU2FsZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQgdCkgewogICAgICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuUHJlSUNPIHx8IHN0YXRlID09IFN0YXRlLkNyb3dkc2FsZSk7CiAgICAgICAgaWYgKG5vdyA+IGNyb3dkc2FsZUZpbmlzaFRpbWUpIHsKICAgICAgICAgICAgdCA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdCA9IGNyb3dkc2FsZUZpbmlzaFRpbWUgLSBub3c7CiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jdGlvbiBmaW5pc2hUb2tlbnNTYWxlKHVpbnQgX2ludmVzdG9yc1RvUHJvY2VzcykgcHVibGljIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLlByZUlDTyB8fCBzdGF0ZSA9PSBTdGF0ZS5Dcm93ZHNhbGUpOwogICAgICAgIHJlcXVpcmUobm93ID49IGNyb3dkc2FsZUZpbmlzaFRpbWUgfHwgY29sbGVjdGVkVVNEID09IHRvdGFsTGltaXRVU0QgfHwKICAgICAgICAgICAgKGNvbGxlY3RlZFVTRCA+PSBtaW5pbWFsU3VjY2Vzc1VTRCAmJiBtc2cuc2VuZGVyID09IG93bmVyKSk7CiAgICAgICAgaWYgKGNvbGxlY3RlZFVTRCA8IG1pbmltYWxTdWNjZXNzVVNEKSB7CiAgICAgICAgICAgIC8vIEludmVzdG9ycyBjYW4gZ2V0IHRoZWlyIGV0aGVyIGNhbGxpbmcgd2l0aGRyYXdCYWNrKCkgZnVuY3Rpb24KICAgICAgICAgICAgd2hpbGUgKF9pbnZlc3RvcnNUb1Byb2Nlc3MgPiAwICYmIG51bWJlck9mSW52ZXN0b3JzID4gMCkgewogICAgICAgICAgICAgICAgYWRkcmVzcyBhZGRyID0gaW52ZXN0b3JzSXRlclstLW51bWJlck9mSW52ZXN0b3JzXTsKICAgICAgICAgICAgICAgIEludmVzdG9yIG1lbW9yeSBpbnYgPSBpbnZlc3RvcnNbYWRkcl07CiAgICAgICAgICAgICAgICBiYWxhbmNlc1thZGRyXSAtPSBpbnYuYW1vdW50VG9rZW5zOwogICAgICAgICAgICAgICAgdG90YWxTdXBwbHkgLT0gaW52LmFtb3VudFRva2VuczsKICAgICAgICAgICAgICAgIFRyYW5zZmVyKGFkZHIsIHRoaXMsIGludi5hbW91bnRUb2tlbnMpOwogICAgICAgICAgICAgICAgLS1faW52ZXN0b3JzVG9Qcm9jZXNzOwogICAgICAgICAgICAgICAgZGVsZXRlIGludmVzdG9yc0l0ZXJbbnVtYmVyT2ZJbnZlc3RvcnNdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChudW1iZXJPZkludmVzdG9ycyA+IDApIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoc3RhdGUgPT0gU3RhdGUuUHJlSUNPKSB7CiAgICAgICAgICAgICAgICBzdGF0ZSA9IFN0YXRlLkRpc2FibGVkOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc3RhdGUgPSBTdGF0ZS5Db21wbGV0ZVByZUlDTzsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHdoaWxlIChfaW52ZXN0b3JzVG9Qcm9jZXNzID4gMCAmJiBudW1iZXJPZkludmVzdG9ycyA+IDApIHsKICAgICAgICAgICAgICAgIC0tbnVtYmVyT2ZJbnZlc3RvcnM7CiAgICAgICAgICAgICAgICAtLV9pbnZlc3RvcnNUb1Byb2Nlc3M7CiAgICAgICAgICAgICAgICBkZWxldGUgaW52ZXN0b3JzW2ludmVzdG9yc0l0ZXJbbnVtYmVyT2ZJbnZlc3RvcnNdXTsKICAgICAgICAgICAgICAgIGRlbGV0ZSBpbnZlc3RvcnNJdGVyW251bWJlck9mSW52ZXN0b3JzXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAobnVtYmVyT2ZJbnZlc3RvcnMgPiAwKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHN0YXRlID09IFN0YXRlLlByZUlDTykgewogICAgICAgICAgICAgICAgcmVxdWlyZShjcm93ZHNhbGVPd25lci5jYWxsLmdhcygzMDAwMDAwKS52YWx1ZSh0aGlzLmJhbGFuY2UpKCkpOwogICAgICAgICAgICAgICAgc3RhdGUgPSBTdGF0ZS5Db21wbGV0ZVByZUlDTzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJlcXVpcmUoY3Jvd2RzYWxlT3duZXIuY2FsbC5nYXMoMzAwMDAwMCkudmFsdWUobWluaW1hbFN1Y2Nlc3NVU0QgKiAxMDAwMDAwMDAwMDAwMDAwMDAwIC8gZXRoZXJQcmljZSkoKSk7CiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYWRkaXRpb25hbCB0b2tlbnMgZm9yIG93bmVyICgzMCUgb2YgY29tcGxldGUgdG90YWxTdXBwbHkpCiAgICAgICAgICAgICAgICB1aW50IHRva2VucyA9IDMgKiB0b3RhbFN1cHBseSAvIDc7CiAgICAgICAgICAgICAgICBiYWxhbmNlc1tvd25lcl0gPSB0b2tlbnM7CiAgICAgICAgICAgICAgICB0b3RhbFN1cHBseSArPSB0b2tlbnM7CiAgICAgICAgICAgICAgICBUcmFuc2Zlcih0aGlzLCBvd25lciwgdG9rZW5zKTsKICAgICAgICAgICAgICAgIHN0YXRlID0gU3RhdGUuRW5hYmxlZDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBOZXdTdGF0ZShzdGF0ZSk7CiAgICB9CiAgICAKICAgIC8vIFRoaXMgZnVuY3Rpb24gbXVzdCBiZSBjYWxsZWQgYnkgdG9rZW4gaG9sZGVyIGluIGNhc2Ugb2YgY3Jvd2RzYWxlIGZhaWxlZAogICAgZnVuY3Rpb24gd2l0aGRyYXdCYWNrKCkgcHVibGljIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLkRpc2FibGVkIHx8IHN0YXRlID09IFN0YXRlLkNvbXBsZXRlUHJlSUNPKTsKICAgICAgICB1aW50IHZhbHVlID0gaW52ZXN0b3JzW21zZy5zZW5kZXJdLmFtb3VudFdlaTsKICAgICAgICBpZiAodmFsdWUgPiAwKSB7CiAgICAgICAgICAgIGRlbGV0ZSBpbnZlc3RvcnNbbXNnLnNlbmRlcl07CiAgICAgICAgICAgIHJlcXVpcmUobXNnLnNlbmRlci5jYWxsLmdhcygzMDAwMDAwKS52YWx1ZSh2YWx1ZSkoKSk7CiAgICAgICAgfQogICAgfQp9CgovKioKICogQHRpdGxlIEFic3RyYWN0IGludGVyZmFjZSBmb3IgUFJPT0Ygb3BlcmF0aW5nIGZyb20gcmVnaXN0ZXJlZCBleHRlcm5hbCBjb250cm9sbGVycwogKi8KY29udHJhY3QgRnVuZCB7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZ1bmQoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBUb2tlbiBQUk9PRiBpbXBsZW1lbnRhdGlvbgogKi8KY29udHJhY3QgVG9rZW4gaXMgQ3Jvd2RzYWxlLCBGdW5kIHsKICAgIAogICAgc3RyaW5nICBwdWJsaWMgc3RhbmRhcmQgICAgPSAnVG9rZW4gMC4xJzsKICAgIHN0cmluZyAgcHVibGljIG5hbWUgICAgICAgID0gJ1BST09GJzsKICAgIHN0cmluZyAgcHVibGljIHN5bWJvbCAgICAgID0gIlBGIjsKICAgIHVpbnQ4ICAgcHVibGljIGRlY2ltYWxzICAgID0gMDsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkpIHB1YmxpYyBhbGxvd2VkOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgZXh0ZXJuYWxDb250cm9sbGVyczsKCiAgICBtb2RpZmllciBvbmx5VG9rZW5Ib2xkZXJzIHsKICAgICAgICByZXF1aXJlKGJhbGFuY2VzW21zZy5zZW5kZXJdICE9IDApOwogICAgICAgIF87CiAgICB9CgogICAgLy8gRml4IGZvciB0aGUgRVJDMjAgc2hvcnQgYWRkcmVzcyBhdHRhY2sKICAgIG1vZGlmaWVyIG9ubHlQYXlsb2FkU2l6ZSh1aW50IHNpemUpIHsKICAgICAgICByZXF1aXJlKG1zZy5kYXRhLmxlbmd0aCA+PSBzaXplICsgNCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBleHRlcm5hbENvbnRyb2xsZXIgewogICAgICAgIHJlcXVpcmUoZXh0ZXJuYWxDb250cm9sbGVyc1ttc2cuc2VuZGVyXSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBUb2tlbihhZGRyZXNzIF9taWdyYXRpb25Ib3N0KQogICAgICAgIHBheWFibGUgQ3Jvd2RzYWxlKF9taWdyYXRpb25Ib3N0KSB7fQoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBiYWxhbmNlc1t3aG9dOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkKICAgICAgICBwdWJsaWMgZW5hYmxlZFN0YXRlIG9ubHlQYXlsb2FkU2l6ZSgyICogMzIpIHsKICAgICAgICByZXF1aXJlKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IF92YWx1ZSk7CiAgICAgICAgcmVxdWlyZShiYWxhbmNlc1tfdG9dICsgX3ZhbHVlID49IGJhbGFuY2VzW190b10pOyAvLyBvdmVyZmxvdwogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdIC09IF92YWx1ZTsKICAgICAgICBiYWxhbmNlc1tfdG9dICs9IF92YWx1ZTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpCiAgICAgICAgcHVibGljIGVuYWJsZWRTdGF0ZSBvbmx5UGF5bG9hZFNpemUoMyAqIDMyKSB7CiAgICAgICAgcmVxdWlyZShiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlKTsKICAgICAgICByZXF1aXJlKGJhbGFuY2VzW190b10gKyBfdmFsdWUgPj0gYmFsYW5jZXNbX3RvXSk7IC8vIG92ZXJmbG93CiAgICAgICAgcmVxdWlyZShhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW19mcm9tXSAtPSBfdmFsdWU7CiAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7CiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkgcHVibGljIGVuYWJsZWRTdGF0ZSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgZW5hYmxlZFN0YXRlCiAgICAgICAgcmV0dXJucyAodWludCByZW1haW5pbmcpIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZ1bmQoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBwdWJsaWMgZXh0ZXJuYWxDb250cm9sbGVyIHsKICAgICAgICByZXF1aXJlKGJhbGFuY2VzW3RoaXNdID49IF92YWx1ZSk7CiAgICAgICAgcmVxdWlyZShiYWxhbmNlc1tfdG9dICsgX3ZhbHVlID49IGJhbGFuY2VzW190b10pOyAvLyBvdmVyZmxvdwogICAgICAgIGJhbGFuY2VzW3RoaXNdIC09IF92YWx1ZTsKICAgICAgICBiYWxhbmNlc1tfdG9dICs9IF92YWx1ZTsKICAgICAgICBUcmFuc2Zlcih0aGlzLCBfdG8sIF92YWx1ZSk7CiAgICB9Cn0KCmNvbnRyYWN0IFByb29mVm90ZSBpcyBUb2tlbiB7CgogICAgZnVuY3Rpb24gUHJvb2ZWb3RlKGFkZHJlc3MgX21pZ3JhdGlvbkhvc3QpCiAgICAgICAgcGF5YWJsZSBUb2tlbihfbWlncmF0aW9uSG9zdCkge30KCiAgICBldmVudCBWb3RpbmdTdGFydGVkKHVpbnQgd2VpUmVxRnVuZCwgVm90ZVJlYXNvbiB2b3RlUmVhc29uKTsKICAgIGV2ZW50IFZvdGVkKGFkZHJlc3MgaW5kZXhlZCB2b3RlciwgYm9vbCBpblN1cHBvcnQpOwogICAgZXZlbnQgVm90aW5nRmluaXNoZWQoYm9vbCBpblN1cHBvcnQpOwoKICAgIGVudW0gVm90ZSB7IE5vVm90ZSwgVm90ZVllYSwgVm90ZU5heSB9CiAgICBlbnVtIFZvdGVSZWFzb24geyBOb3RoaW5nLCBSZXFGdW5kLCBNaWdyYXRpb24sIFVwZGF0ZUNvbnRyYWN0IH0KCiAgICB1aW50IHB1YmxpYyB3ZWlSZXFGdW5kOwogICAgdWludCBwdWJsaWMgdm90aW5nRGVhZGxpbmU7CiAgICB1aW50IHB1YmxpYyBudW1iZXJPZlZvdGVzOwogICAgdWludCBwdWJsaWMgeWVhOwogICAgdWludCBwdWJsaWMgbmF5OwogICAgVm90ZVJlYXNvbiAgdm90ZVJlYXNvbjsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gVm90ZSkgcHVibGljIHZvdGVzOwogICAgbWFwcGluZyAodWludCA9PiBhZGRyZXNzKSBwdWJsaWMgdm90ZXNJdGVyOwoKICAgIGFkZHJlc3MgcHVibGljIG1pZ3JhdGlvbkFnZW50OwogICAgYWRkcmVzcyBwdWJsaWMgbWlncmF0aW9uQWdlbnRDYW5kaWRhdGU7CiAgICBhZGRyZXNzIHB1YmxpYyBleHRlcm5hbENvbnRyb2xsZXJDYW5kaWRhdGU7CgogICAgZnVuY3Rpb24gc3RhcnRWb3RpbmcodWludCBfd2VpUmVxRnVuZCkgcHVibGljIGVuYWJsZWRPck1pZ3JhdGlvblN0YXRlIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShfd2VpUmVxRnVuZCA+IDApOwogICAgICAgIGludGVybmFsU3RhcnRWb3RpbmcoX3dlaVJlcUZ1bmQsIFZvdGVSZWFzb24uUmVxRnVuZCwgNyk7CiAgICB9CgogICAgZnVuY3Rpb24gaW50ZXJuYWxTdGFydFZvdGluZyh1aW50IF93ZWlSZXFGdW5kLCBWb3RlUmVhc29uIF92b3RlUmVhc29uLCB1aW50IF92b3RpbmdEdXJhdGlvbkRheXMpIGludGVybmFsIHsKICAgICAgICByZXF1aXJlKHZvdGVSZWFzb24gPT0gVm90ZVJlYXNvbi5Ob3RoaW5nICYmIF93ZWlSZXFGdW5kIDw9IHRoaXMuYmFsYW5jZSk7CiAgICAgICAgd2VpUmVxRnVuZCA9IF93ZWlSZXFGdW5kOwogICAgICAgIHZvdGluZ0RlYWRsaW5lID0gbm93ICsgX3ZvdGluZ0R1cmF0aW9uRGF5cyAqIDEgZGF5czsKICAgICAgICB2b3RlUmVhc29uID0gX3ZvdGVSZWFzb247CiAgICAgICAgZGVsZXRlIHllYTsKICAgICAgICBkZWxldGUgbmF5OwogICAgICAgIFZvdGluZ1N0YXJ0ZWQoX3dlaVJlcUZ1bmQsIF92b3RlUmVhc29uKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gdm90aW5nSW5mbygpIHB1YmxpYyBjb25zdGFudAogICAgICAgIHJldHVybnModWludCBfd2VpUmVxRnVuZCwgdWludCBfdGltZVRvRmluaXNoLCBWb3RlUmVhc29uIF92b3RlUmVhc29uKSB7CiAgICAgICAgX3dlaVJlcUZ1bmQgPSB3ZWlSZXFGdW5kOwogICAgICAgIF92b3RlUmVhc29uID0gdm90ZVJlYXNvbjsKICAgICAgICBpZiAodm90aW5nRGVhZGxpbmUgPD0gbm93KSB7CiAgICAgICAgICAgIF90aW1lVG9GaW5pc2ggPSAwOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aW1lVG9GaW5pc2ggPSB2b3RpbmdEZWFkbGluZSAtIG5vdzsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdm90ZShib29sIF9pblN1cHBvcnQpIHB1YmxpYyBvbmx5VG9rZW5Ib2xkZXJzIHJldHVybnMgKHVpbnQgdm90ZUlkKSB7CiAgICAgICAgcmVxdWlyZSh2b3RlUmVhc29uICE9IFZvdGVSZWFzb24uTm90aGluZyk7CiAgICAgICAgcmVxdWlyZSh2b3Rlc1ttc2cuc2VuZGVyXSA9PSBWb3RlLk5vVm90ZSk7CiAgICAgICAgcmVxdWlyZSh2b3RpbmdEZWFkbGluZSA+IG5vdyk7CiAgICAgICAgdm90ZUlkID0gbnVtYmVyT2ZWb3RlcysrOwogICAgICAgIHZvdGVzSXRlclt2b3RlSWRdID0gbXNnLnNlbmRlcjsKICAgICAgICBpZiAoX2luU3VwcG9ydCkgewogICAgICAgICAgICB2b3Rlc1ttc2cuc2VuZGVyXSA9IFZvdGUuVm90ZVllYTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2b3Rlc1ttc2cuc2VuZGVyXSA9IFZvdGUuVm90ZU5heTsKICAgICAgICB9CiAgICAgICAgVm90ZWQobXNnLnNlbmRlciwgX2luU3VwcG9ydCk7CiAgICAgICAgcmV0dXJuIHZvdGVJZDsKICAgIH0KCiAgICBmdW5jdGlvbiBmaW5pc2hWb3RpbmcodWludCBfdm90ZXNUb1Byb2Nlc3MpIHB1YmxpYyByZXR1cm5zIChib29sIF9pblN1cHBvcnQpIHsKICAgICAgICByZXF1aXJlKHZvdGVSZWFzb24gIT0gVm90ZVJlYXNvbi5Ob3RoaW5nKTsKICAgICAgICByZXF1aXJlKG5vdyA+PSB2b3RpbmdEZWFkbGluZSk7CgogICAgICAgIHdoaWxlIChfdm90ZXNUb1Byb2Nlc3MgPiAwICYmIG51bWJlck9mVm90ZXMgPiAwKSB7CiAgICAgICAgICAgIGFkZHJlc3Mgdm90ZXIgPSB2b3Rlc0l0ZXJbLS1udW1iZXJPZlZvdGVzXTsKICAgICAgICAgICAgVm90ZSB2ID0gdm90ZXNbdm90ZXJdOwogICAgICAgICAgICB1aW50IHZvdGVXZWlnaHQgPSBiYWxhbmNlc1t2b3Rlcl07CiAgICAgICAgICAgIGlmICh2ID09IFZvdGUuVm90ZVllYSkgewogICAgICAgICAgICAgICAgeWVhICs9IHZvdGVXZWlnaHQ7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodiA9PSBWb3RlLlZvdGVOYXkpIHsKICAgICAgICAgICAgICAgIG5heSArPSB2b3RlV2VpZ2h0OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGRlbGV0ZSB2b3Rlc1t2b3Rlcl07CiAgICAgICAgICAgIGRlbGV0ZSB2b3Rlc0l0ZXJbbnVtYmVyT2ZWb3Rlc107CiAgICAgICAgICAgIC0tX3ZvdGVzVG9Qcm9jZXNzOwogICAgICAgIH0KICAgICAgICBpZiAobnVtYmVyT2ZWb3RlcyA+IDApIHsKICAgICAgICAgICAgX2luU3VwcG9ydCA9IGZhbHNlOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBfaW5TdXBwb3J0ID0gKHllYSA+IG5heSk7CiAgICAgICAgdWludCB3ZWlGb3JTZW5kID0gd2VpUmVxRnVuZDsKICAgICAgICBkZWxldGUgd2VpUmVxRnVuZDsKICAgICAgICBkZWxldGUgdm90aW5nRGVhZGxpbmU7CiAgICAgICAgZGVsZXRlIG51bWJlck9mVm90ZXM7CgogICAgICAgIGlmIChfaW5TdXBwb3J0KSB7CiAgICAgICAgICAgIGlmICh2b3RlUmVhc29uID09IFZvdGVSZWFzb24uUmVxRnVuZCkgewogICAgICAgICAgICAgICAgcmVxdWlyZShvd25lci5jYWxsLmdhcygzMDAwMDAwKS52YWx1ZSh3ZWlGb3JTZW5kKSgpKTsKICAgICAgICAgICAgfSBlbHNlIGlmICh2b3RlUmVhc29uID09IFZvdGVSZWFzb24uTWlncmF0aW9uKSB7CiAgICAgICAgICAgICAgICBtaWdyYXRpb25BZ2VudCA9IG1pZ3JhdGlvbkFnZW50Q2FuZGlkYXRlOwogICAgICAgICAgICAgICAgcmVxdWlyZShtaWdyYXRpb25BZ2VudC5jYWxsLmdhcygzMDAwMDAwKS52YWx1ZSh0aGlzLmJhbGFuY2UpKCkpOwogICAgICAgICAgICAgICAgZGVsZXRlIG1pZ3JhdGlvbkFnZW50Q2FuZGlkYXRlOwogICAgICAgICAgICAgICAgc3RhdGUgPSBTdGF0ZS5NaWdyYXRpb247CiAgICAgICAgICAgIH0gZWxzZSBpZiAodm90ZVJlYXNvbiA9PSBWb3RlUmVhc29uLlVwZGF0ZUNvbnRyYWN0KSB7CiAgICAgICAgICAgICAgICBleHRlcm5hbENvbnRyb2xsZXJzW2V4dGVybmFsQ29udHJvbGxlckNhbmRpZGF0ZV0gPSB0cnVlOwogICAgICAgICAgICAgICAgZGVsZXRlIGV4dGVybmFsQ29udHJvbGxlckNhbmRpZGF0ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZGVsZXRlIHZvdGVSZWFzb247CiAgICAgICAgVm90aW5nRmluaXNoZWQoX2luU3VwcG9ydCk7CiAgICB9Cn0KCi8qKgogKiBAdGl0bGUgTWlncmF0aW9uIGFnZW50IGludGVmcmFjZSBmb3IgcG9zc2liaWxpdHkgb2YgbW92aW5nIHRva2VucwogKiAgICAgICAgdG8gYW5vdGhlciBjb250cmFjdAogKi8KY29udHJhY3QgTWlncmF0aW9uQWdlbnQgewogICAgZnVuY3Rpb24gbWlncmF0ZUZyb20oYWRkcmVzcyBfZnJvbSwgdWludCBfdmFsdWUpOwp9CgovKioKICogQHRpdGxlIE1pZ3JhdGlvbiBmdW5jdGlvbmFsaXR5IGZvciBwb3NzaWJpbGl0eSBvZiBtb3ZpbmcgdG9rZW5zCiAqICAgICAgICB0byBhbm90aGVyIGNvbnRyYWN0CiAqLwpjb250cmFjdCBUb2tlbk1pZ3JhdGlvbiBpcyBQcm9vZlZvdGUgewogICAgCiAgICB1aW50IHB1YmxpYyB0b3RhbE1pZ3JhdGVkOwoKICAgIGV2ZW50IE1pZ3JhdGUoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSk7CgogICAgZnVuY3Rpb24gVG9rZW5NaWdyYXRpb24oYWRkcmVzcyBfbWlncmF0aW9uSG9zdCkgcGF5YWJsZSBQcm9vZlZvdGUoX21pZ3JhdGlvbkhvc3QpIHt9CgogICAgLy8gTWlncmF0ZSBfdmFsdWUgb2YgdG9rZW5zIHRvIHRoZSBuZXcgdG9rZW4gY29udHJhY3QKICAgIGZ1bmN0aW9uIG1pZ3JhdGUoKSBleHRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5NaWdyYXRpb24pOwogICAgICAgIHVpbnQgdmFsdWUgPSBiYWxhbmNlc1ttc2cuc2VuZGVyXTsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSB2YWx1ZTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCB0aGlzLCB2YWx1ZSk7CiAgICAgICAgdG90YWxTdXBwbHkgLT0gdmFsdWU7CiAgICAgICAgdG90YWxNaWdyYXRlZCArPSB2YWx1ZTsKICAgICAgICBNaWdyYXRpb25BZ2VudChtaWdyYXRpb25BZ2VudCkubWlncmF0ZUZyb20obXNnLnNlbmRlciwgdmFsdWUpOwogICAgICAgIE1pZ3JhdGUobXNnLnNlbmRlciwgbWlncmF0aW9uQWdlbnQsIHZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRNaWdyYXRpb25BZ2VudChhZGRyZXNzIF9hZ2VudCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG1pZ3JhdGlvbkFnZW50ID09IDAgJiYgX2FnZW50ICE9IDApOwogICAgICAgIG1pZ3JhdGlvbkFnZW50Q2FuZGlkYXRlID0gX2FnZW50OwogICAgICAgIGludGVybmFsU3RhcnRWb3RpbmcoMCwgVm90ZVJlYXNvbi5NaWdyYXRpb24sIDIpOwogICAgfQp9Cgpjb250cmFjdCBQcm9vZkZ1bmQgaXMgVG9rZW5NaWdyYXRpb24gewoKICAgIGZ1bmN0aW9uIFByb29mRnVuZChhZGRyZXNzIF9taWdyYXRpb25Ib3N0KQogICAgICAgIHBheWFibGUgVG9rZW5NaWdyYXRpb24oX21pZ3JhdGlvbkhvc3QpIHt9CgogICAgZnVuY3Rpb24gYWRkRXh0ZXJuYWxDb250cm9sbGVyKGFkZHJlc3MgX2V4dGVybmFsQ29udHJvbGxlckNhbmRpZGF0ZSkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShfZXh0ZXJuYWxDb250cm9sbGVyQ2FuZGlkYXRlICE9IDApOwogICAgICAgIGV4dGVybmFsQ29udHJvbGxlckNhbmRpZGF0ZSA9IF9leHRlcm5hbENvbnRyb2xsZXJDYW5kaWRhdGU7CiAgICAgICAgaW50ZXJuYWxTdGFydFZvdGluZygwLCBWb3RlUmVhc29uLlVwZGF0ZUNvbnRyYWN0LCAyKTsKICAgIH0KCiAgICBmdW5jdGlvbiByZW1vdmVFeHRlcm5hbENvbnRyb2xsZXIoYWRkcmVzcyBfZXh0ZXJuYWxDb250cm9sbGVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBkZWxldGUgZXh0ZXJuYWxDb250cm9sbGVyc1tfZXh0ZXJuYWxDb250cm9sbGVyXTsKICAgIH0KfQoKLyoqCiAqIEB0aXRsZSBQcm9vZiBpbnRlcmZhY2UKICovCmNvbnRyYWN0IFByb29mQWJzdHJhY3QgewogICAgZnVuY3Rpb24gc3d5cGVDb2RlKGFkZHJlc3MgX3dobykgcmV0dXJucyAodWludDE2IF9zd3lwZSk7CiAgICBmdW5jdGlvbiBzZXRIYXNoKGFkZHJlc3MgX3dobywgdWludDE2IF9zd3lwZSwgYnl0ZXMzMiBfaGFzaCk7Cn0KCmNvbnRyYWN0IFByb29mIGlzIFByb29mRnVuZCB7CgogICAgdWludCAgICBwdWJsaWMgcHJpY2VJblRva2VuczsKICAgIHVpbnQgICAgcHVibGljIHRlYW1GZWU7CiAgICBhZGRyZXNzIHB1YmxpYyBwcm9vZkltcGw7CgogICAgZnVuY3Rpb24gUHJvb2YoYWRkcmVzcyBfbWlncmF0aW9uSG9zdCkKICAgICAgICBwYXlhYmxlIFByb29mRnVuZChfbWlncmF0aW9uSG9zdCkge30KCiAgICBmdW5jdGlvbiBzZXRQcmljZSh1aW50IF9wcmljZUluVG9rZW5zKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKF9wcmljZUluVG9rZW5zID49IDIpOwogICAgICAgIHRlYW1GZWUgPSBfcHJpY2VJblRva2VucyAvIDEwOwogICAgICAgIGlmICh0ZWFtRmVlID09IDApIHsKICAgICAgICAgICAgdGVhbUZlZSA9IDE7CiAgICAgICAgfQogICAgICAgIHByaWNlSW5Ub2tlbnMgPSBfcHJpY2VJblRva2VucyAtIHRlYW1GZWU7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0UHJvb2ZJbXBsKGFkZHJlc3MgX3Byb29mSW1wbCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcHJvb2ZJbXBsID0gX3Byb29mSW1wbDsKICAgIH0KCiAgICBmdW5jdGlvbiBzd3lwZUNvZGUoKSBwdWJsaWMgcmV0dXJucyAodWludDE2IF9zd3lwZSkgewogICAgICAgIHJlcXVpcmUocHJvb2ZJbXBsICE9IDApOwogICAgICAgIF9zd3lwZSA9IFByb29mQWJzdHJhY3QocHJvb2ZJbXBsKS5zd3lwZUNvZGUobXNnLnNlbmRlcik7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHNldEhhc2godWludDE2IF9zd3lwZSwgYnl0ZXMzMiBfaGFzaCkgcHVibGljIHsKICAgICAgICByZXF1aXJlKHByb29mSW1wbCAhPSAwKTsKICAgICAgICB0cmFuc2Zlcihvd25lciwgdGVhbUZlZSk7CiAgICAgICAgdHJhbnNmZXIodGhpcywgcHJpY2VJblRva2Vucyk7CiAgICAgICAgUHJvb2ZBYnN0cmFjdChwcm9vZkltcGwpLnNldEhhc2gobXNnLnNlbmRlciwgX3N3eXBlLCBfaGFzaCk7CiAgICB9Cn0='.
	

]
