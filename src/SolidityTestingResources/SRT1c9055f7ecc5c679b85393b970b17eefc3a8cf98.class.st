Class {
	#name : #SRT1c9055f7ecc5c679b85393b970b17eefc3a8cf98,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT1c9055f7ecc5c679b85393b970b17eefc3a8cf98 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7CgoKIC8vLyBAdGl0bGUgU2FmZU1hdGggY29udHJhY3QgLSBtYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzCmNvbnRyYWN0IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBzYWZlTXVsKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICB1aW50IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHNhZmVEaXYodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIGFzc2VydChiID4gMCk7CiAgICB1aW50IGMgPSBhIC8gYjsKICAgIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzYWZlU3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIHNhZmVBZGQodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIHVpbnQgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGM+PWEgJiYgYz49Yik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIG1heDY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7CiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7CiAgfQoKICBmdW5jdGlvbiBtaW42NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgewogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7CiAgfQoKICBmdW5jdGlvbiBtYXgyNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBhID49IGIgPyBhIDogYjsKICB9CgogIGZ1bmN0aW9uIG1pbjI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7CiAgfQoKIAp9CgoKCiAvLy8gQHRpdGxlIE93bmFibGUgY29udHJhY3QgLSBiYXNlIGNvbnRyYWN0IHdpdGggYW4gb3duZXIKY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgogIGZ1bmN0aW9uIE93bmFibGUoKSB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciB7CiAgICBpZiAobmV3T3duZXIgIT0gYWRkcmVzcygwKSkgewogICAgICBvd25lciA9IG5ld093bmVyOwogICAgfQogIH0KfQoKCi8vLyBAdGl0bGUgSGFsdGFibGUgY29udHJhY3QgLSBhYnN0cmFjdCBjb250cmFjdCB0aGF0IGFsbG93cyBjaGlsZHJlbiB0byBpbXBsZW1lbnQgYW4gZW1lcmdlbmN5IHN0b3AgbWVjaGFuaXNtLgovLy8gT3JpZ2luYWxseSBlbnZpc2lvbmVkIGluIEZpcnN0Qmxvb2QgSUNPIGNvbnRyYWN0Lgpjb250cmFjdCBIYWx0YWJsZSBpcyBPd25hYmxlIHsKICBib29sIHB1YmxpYyBoYWx0ZWQ7CgogIG1vZGlmaWVyIHN0b3BJbkVtZXJnZW5jeSB7CiAgICByZXF1aXJlKCFoYWx0ZWQpOwogICAgXzsKICB9CgogIG1vZGlmaWVyIG9ubHlJbkVtZXJnZW5jeSB7CiAgICByZXF1aXJlKGhhbHRlZCk7CiAgICBfOwogIH0KCiAgLy8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW1lcmdlbmN5LCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlCiAgZnVuY3Rpb24gaGFsdCgpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICBoYWx0ZWQgPSB0cnVlOwogIH0KCiAgLy8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW5kIG9mIGVtZXJnZW5jeSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICBmdW5jdGlvbiB1bmhhbHQoKSBleHRlcm5hbCBvbmx5T3duZXIgb25seUluRW1lcmdlbmN5IHsKICAgIGhhbHRlZCA9IGZhbHNlOwogIH0KfQoKCgoKIC8vLyBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlIHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKY29udHJhY3QgRVJDMjAgewogIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgY29uc3RhbnQgcmV0dXJucyAodWludCk7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCk7CiAgZnVuY3Rpb24gbWludChhZGRyZXNzIHJlY2VpdmVyLCB1aW50IGFtb3VudCk7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludCB2YWx1ZSkgcmV0dXJucyAoYm9vbCBvayk7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludCB2YWx1ZSkgcmV0dXJucyAoYm9vbCBvayk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQgdmFsdWUpIHJldHVybnMgKGJvb2wgb2spOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQgdmFsdWUpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOwp9CgoKCi8vLyBAdGl0bGUgU29sYXJEYW9Ub2tlbiBjb250cmFjdCAtIHN0YW5kYXJkIEVSQzIwIHRva2VuIHdpdGggU2hvcnQgSGFuZCBBdHRhY2sgYW5kIGFwcHJvdmUoKSByYWNlIGNvbmRpdGlvbiBtaXRpZ2F0aW9uLgpjb250cmFjdCBTb2xhckRhb1Rva2VuIGlzIFNhZmVNYXRoLCBFUkMyMCwgT3duYWJsZSB7CiBzdHJpbmcgcHVibGljIG5hbWUgPSAiU29sYXIgREFPIFRva2VuIjsKIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIlNEQU8iOwogdWludCBwdWJsaWMgZGVjaW1hbHMgPSA0OwoKIC8vLyBjb250cmFjdCB0aGF0IGlzIGFsbG93ZWQgdG8gY3JlYXRlIG5ldyB0b2tlbnMgYW5kIGFsbG93cyB1bmxpZnQgdGhlIHRyYW5zZmVyIGxpbWl0cyBvbiB0aGlzIHRva2VuCiBhZGRyZXNzIHB1YmxpYyBjcm93ZHNhbGVBZ2VudDsKIC8vLyBBIGNyb3dkc2FsZSBjb250cmFjdCBjYW4gcmVsZWFzZSB1cyB0byB0aGUgd2lsZCBpZiBJQ08gc3VjY2Vzcy4gSWYgZmFsc2Ugd2UgYXJlIGFyZSBpbiB0cmFuc2ZlciBsb2NrIHVwIHBlcmlvZC4KIGJvb2wgcHVibGljIHJlbGVhc2VkID0gZmFsc2U7CiAvLy8gYXBwcm92ZSgpIGFsbG93YW5jZXMKIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSkgYWxsb3dlZDsKIC8vLyBob2xkZXIgYmFsYW5jZXMKIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50KSBiYWxhbmNlczsKCiAvLy8gQGRldiBMaW1pdCB0b2tlbiB0cmFuc2ZlciB1bnRpbCB0aGUgY3Jvd2RzYWxlIGlzIG92ZXIuCiBtb2RpZmllciBjYW5UcmFuc2ZlcigpIHsKICAgaWYoIXJlbGVhc2VkKSB7CiAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY3Jvd2RzYWxlQWdlbnQpOwogICB9CiAgIF87CiB9CgogLy8vIEBkZXYgVGhlIGZ1bmN0aW9uIGNhbiBiZSBjYWxsZWQgb25seSBiZWZvcmUgb3IgYWZ0ZXIgdGhlIHRva2VucyBoYXZlIGJlZW4gcmVsZWFzZXNkCiAvLy8gQHBhcmFtIF9yZWxlYXNlZCB0b2tlbiB0cmFuc2ZlciBhbmQgbWludCBzdGF0ZQogbW9kaWZpZXIgaW5SZWxlYXNlU3RhdGUoYm9vbCBfcmVsZWFzZWQpIHsKICAgcmVxdWlyZShfcmVsZWFzZWQgPT0gcmVsZWFzZWQpOwogICBfOwogfQoKIC8vLyBAZGV2IFRoZSBmdW5jdGlvbiBjYW4gYmUgY2FsbGVkIG9ubHkgYnkgcmVsZWFzZSBhZ2VudC4KIG1vZGlmaWVyIG9ubHlDcm93ZHNhbGVBZ2VudCgpIHsKICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNyb3dkc2FsZUFnZW50KTsKICAgXzsKIH0KCiAvLy8gQGRldiBGaXggZm9yIHRoZSBFUkMyMCBzaG9ydCBhZGRyZXNzIGF0dGFjayBodHRwOi8vdmVzc2VuZXMuY29tL3RoZS1lcmMyMC1zaG9ydC1hZGRyZXNzLWF0dGFjay1leHBsYWluZWQvCiAvLy8gQHBhcmFtIHNpemUgcGF5bG9hZCBzaXplCiBtb2RpZmllciBvbmx5UGF5bG9hZFNpemUodWludCBzaXplKSB7CiAgICByZXF1aXJlKG1zZy5kYXRhLmxlbmd0aCA+PSBzaXplICsgNCk7CiAgICBfOwogfQoKIC8vLyBAZGV2IE1ha2Ugc3VyZSB3ZSBhcmUgbm90IGRvbmUgeWV0LgogbW9kaWZpZXIgY2FuTWludCgpIHsKICAgIHJlcXVpcmUoIXJlbGVhc2VkKTsKICAgIF87CiAgfQoKIC8vLyBAZGV2IENvbnN0cnVjdG9yCiBmdW5jdGlvbiBTb2xhckRhb1Rva2VuKCkgewogICBvd25lciA9IG1zZy5zZW5kZXI7CiB9CgogLy8vIEZhbGxiYWNrIG1ldGhvZCB3aWxsIGJ1eW91dCB0b2tlbnMKIGZ1bmN0aW9uKCkgcGF5YWJsZSB7CiAgIHJldmVydCgpOwogfQoKIC8vLyBAZGV2IENyZWF0ZSBuZXcgdG9rZW5zIGFuZCBhbGxvY2F0ZSB0aGVtIHRvIGFuIGFkZHJlc3MuIE9ubHkgY2FsbGFibHkgYnkgYSBjcm93ZHNhbGUgY29udHJhY3QKIC8vLyBAcGFyYW0gcmVjZWl2ZXIgQWRkcmVzcyBvZiByZWNlaXZlcgogLy8vIEBwYXJhbSBhbW91bnQgIE51bWJlciBvZiB0b2tlbnMgdG8gaXNzdWUuCiBmdW5jdGlvbiBtaW50KGFkZHJlc3MgcmVjZWl2ZXIsIHVpbnQgYW1vdW50KSBvbmx5Q3Jvd2RzYWxlQWdlbnQgY2FuTWludCBwdWJsaWMgewogICAgdG90YWxTdXBwbHkgPSBzYWZlQWRkKHRvdGFsU3VwcGx5LCBhbW91bnQpOwogICAgYmFsYW5jZXNbcmVjZWl2ZXJdID0gc2FmZUFkZChiYWxhbmNlc1tyZWNlaXZlcl0sIGFtb3VudCk7CiAgICBUcmFuc2ZlcigwLCByZWNlaXZlciwgYW1vdW50KTsKIH0KCiAvLy8gQGRldiBTZXQgdGhlIGNvbnRyYWN0IHRoYXQgY2FuIGNhbGwgcmVsZWFzZSBhbmQgbWFrZSB0aGUgdG9rZW4gdHJhbnNmZXJhYmxlLgogLy8vIEBwYXJhbSBfY3Jvd2RzYWxlQWdlbnQgY3Jvd2RzYWxlIGNvbnRyYWN0IGFkZHJlc3MKIGZ1bmN0aW9uIHNldENyb3dkc2FsZUFnZW50KGFkZHJlc3MgX2Nyb3dkc2FsZUFnZW50KSBvbmx5T3duZXIgaW5SZWxlYXNlU3RhdGUoZmFsc2UpIHB1YmxpYyB7CiAgIGNyb3dkc2FsZUFnZW50ID0gX2Nyb3dkc2FsZUFnZW50OwogfQogLy8vIEBkZXYgT25lIHdheSBmdW5jdGlvbiB0byByZWxlYXNlIHRoZSB0b2tlbnMgdG8gdGhlIHdpbGQuIENhbiBiZSBjYWxsZWQgb25seSBmcm9tIHRoZSByZWxlYXNlIGFnZW50IHRoYXQgaXMgdGhlIGZpbmFsIElDTyBjb250cmFjdC4gSXQgaXMgb25seSBjYWxsZWQgaWYgdGhlIGNyb3dkc2FsZSBoYXMgYmVlbiBzdWNjZXNzIChmaXJzdCBtaWxlc3RvbmUgcmVhY2hlZCkuCiBmdW5jdGlvbiByZWxlYXNlVG9rZW5UcmFuc2ZlcigpIHB1YmxpYyBvbmx5Q3Jvd2RzYWxlQWdlbnQgewogICByZWxlYXNlZCA9IHRydWU7CiB9CiAvLy8gQGRldiBUcmFuZmVyIHRva2VucyB0byBhZGRyZXNzCiAvLy8gQHBhcmFtIF90byBkZXN0IGFkZHJlc3MKIC8vLyBAcGFyYW0gX3ZhbHVlIHRva2VucyBhbW91bnQKIC8vLyBAcmV0dXJuIHRyYW5zZmVyIHJlc3VsdAogZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSBjYW5UcmFuc2ZlciByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBzYWZlU3ViKGJhbGFuY2VzW21zZy5zZW5kZXJdLCBfdmFsdWUpOwogICBiYWxhbmNlc1tfdG9dID0gc2FmZUFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOwoKICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICByZXR1cm4gdHJ1ZTsKIH0KCiAvLy8gQGRldiBUcmFuZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIG90aGVyCiAvLy8gQHBhcmFtIF9mcm9tIHNvdXJjZSBhZGRyZXNzCiAvLy8gQHBhcmFtIF90byBkZXN0IGFkZHJlc3MKIC8vLyBAcGFyYW0gX3ZhbHVlIHRva2VucyBhbW91bnQKIC8vLyBAcmV0dXJuIHRyYW5zZmVyIHJlc3VsdAogZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDIgKiAzMikgY2FuVHJhbnNmZXIgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgIHZhciBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07CgogICAgYmFsYW5jZXNbX3RvXSA9IHNhZmVBZGQoYmFsYW5jZXNbX3RvXSwgX3ZhbHVlKTsKICAgIGJhbGFuY2VzW19mcm9tXSA9IHNhZmVTdWIoYmFsYW5jZXNbX2Zyb21dLCBfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBzYWZlU3ViKF9hbGxvd2FuY2UsIF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiB9CiAvLy8gQGRldiBUb2tlbnMgYmFsYW5jZQogLy8vIEBwYXJhbSBfb3duZXIgaG9sZGVyIGFkZHJlc3MKIC8vLyBAcmV0dXJuIGJhbGFuY2UgYW1vdW50CiBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgYmFsYW5jZSkgewogICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKIH0KCiAvLy8gQGRldiBBcHByb3ZlIHRyYW5zZmVyCiAvLy8gQHBhcmFtIF9zcGVuZGVyIGhvbGRlciBhZGRyZXNzCiAvLy8gQHBhcmFtIF92YWx1ZSB0b2tlbnMgYW1vdW50CiAvLy8gQHJldHVybiByZXN1bHQKIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAvLyBUbyBjaGFuZ2UgdGhlIGFwcHJvdmUgYW1vdW50IHlvdSBmaXJzdCBoYXZlIHRvIHJlZHVjZSB0aGUgYWRkcmVzc2VzYAogICAvLyAgYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyBgYXBwcm92ZShfc3BlbmRlciwgMClgIGlmIGl0IGlzIG5vdAogICAvLyAgYWxyZWFkeSAwIHRvIG1pdGlnYXRlIHRoZSByYWNlIGNvbmRpdGlvbiBkZXNjcmliZWQgaGVyZToKICAgLy8gIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgIHJlcXVpcmUgKChfdmFsdWUgPT0gMCkgfHwgKGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID09IDApKTsKCiAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgcmV0dXJuIHRydWU7CiB9CgogLy8vIEBkZXYgVG9rZW4gYWxsb3dhbmNlCiAvLy8gQHBhcmFtIF9vd25lciBob2xkZXIgYWRkcmVzcwogLy8vIEBwYXJhbSBfc3BlbmRlciBzcGVuZGVyIGFkZHJlc3MKIC8vLyBAcmV0dXJuIHJlbWFpbiBhbW91bnQKIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCByZW1haW5pbmcpIHsKICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiB9Cn0KLy8vIEB0aXRsZSBLaWxsYWJsZSBjb250cmFjdCAtIGJhc2UgY29udHJhY3QgdGhhdCBjYW4gYmUga2lsbGVkIGJ5IG93bmVyLiBBbGwgZnVuZHMgaW4gY29udHJhY3Qgd2lsbCBiZSBzZW50IHRvIHRoZSBvd25lci4KY29udHJhY3QgS2lsbGFibGUgaXMgT3duYWJsZSB7CiBmdW5jdGlvbiBraWxsKCkgb25seU93bmVyIHsKICAgc2VsZmRlc3RydWN0KG93bmVyKTsKIH0KfQoKCi8vLyBAdGl0bGUgU29sYXJEYW9Ub2tlbkNyb3dkc2FsZSBjb250cmFjdCAtIGNvbnRyYWN0IGZvciB0b2tlbiBzYWxlcy4KY29udHJhY3QgU29sYXJEYW9Ub2tlbkNyb3dkc2FsZSBpcyBIYWx0YWJsZSwgS2lsbGFibGUsIFNhZmVNYXRoIHsKCiAgLy8vIFByZWZ1bmRpbmcgZ29hbCBpbiBVU0QgY2VudHMsIGlmIHRoZSBwcmVmdW5kaW5nIGdvYWwgaXMgcmVhY2hlZCwgaWNvIHdpbGwgc3RhcnQKICB1aW50IHB1YmxpYyBjb25zdGFudCBQUkVfRlVORElOR19HT0FMID0gNGU2ICogUFJJQ0U7CgogIC8vLyBUb2tlbnMgZnVuZGluZyBnb2FsIGluIFVTRCBjZW50cywgaWYgdGhlIGZ1bmRpbmcgZ29hbCBpcyByZWFjaGVkLCBpY28gd2lsbCBzdG9wCiAgdWludCBwdWJsaWMgY29uc3RhbnQgSUNPX0dPQUwgPSA4ZTcgKiBQUklDRTsKCiAgLy8vIE1pbWluYWwgdG9rZW5zIGZ1bmRpbmcgZ29hbCBpbiBVU0QgY2VudHMsIGlmIHRoaXMgZ29hbCBpc24ndCByZWFjaGVkIGR1cmluZyBJQ08sIHJlZnVuZCB3aWxsIGJlZ2luCiAgdWludCBwdWJsaWMgY29uc3RhbnQgTUlOX0lDT19HT0FMID0gMWU3OwoKICAvLy8gTWltaW5hbCBpbnZlc3RtZW50IHZhbHVlCiAgdWludCBwdWJsaWMgY29uc3RhbnQgTUlOX0lOVkVTVE1FTlQgPSA1IGV0aGVyOwoKICAvLy8gUGVyY2VudCBvZiBib251cyB0b2tlbnMgdGVhbSByZWNlaXZlcyBmcm9tIGVhY2ggaW52ZXN0bWVudAogIHVpbnQgcHVibGljIGNvbnN0YW50IFRFQU1fQk9OVVNfUEVSQ0VOVCA9IDI1OwoKICAvLy8gVGhlIHRva2VuIHByaWNlIGluIFVTRCBjZW50cwogIHVpbnQgY29uc3RhbnQgcHVibGljIFBSSUNFID0gMTAwOwoKICAvLy8gVGhlIHRva2VuIHdlIGFyZSBzZWxsaW5nCiAgU29sYXJEYW9Ub2tlbiBwdWJsaWMgdG9rZW47CgogIC8vLyB0b2tlbnMgd2lsbCBiZSB0cmFuc2ZlcmVkIGZyb20gdGhpcyBhZGRyZXNzCiAgYWRkcmVzcyBwdWJsaWMgbXVsdGlzaWdXYWxsZXQ7CgogIC8vLyB0aGUgVU5JWCB0aW1lc3RhbXAgc3RhcnQgZGF0ZSBvZiB0aGUgY3Jvd2RzYWxlCiAgdWludCBwdWJsaWMgc3RhcnRzQXQ7CgogIC8vLyB0aGUgVU5JWCB0aW1lc3RhbXAgZW5kIGRhdGUgb2YgdGhlIGNyb3dkc2FsZQogIHVpbnQgcHVibGljIGVuZHNBdDsKCiAgLy8vIHRoZSBVTklYIHRpbWVzdGFtcCBzdGFydCBkYXRlIG9mIHRoZSBwcmUgaW52ZXN0IGNyb3dkc2FsZQogIHVpbnQgcHVibGljIHByZUludmVzdFN0YXJ0OwoKICAvLy8gdGhlIG51bWJlciBvZiB0b2tlbnMgYWxyZWFkeSBzb2xkIHRocm91Z2ggdGhpcyBjb250cmFjdAogIHVpbnQgcHVibGljIHRva2Vuc1NvbGQgPSAwOwoKICAvLy8gSG93IG1hbnkgd2VpIG9mIGZ1bmRpbmcgd2UgaGF2ZSByYWlzZWQKICB1aW50IHB1YmxpYyB3ZWlSYWlzZWQgPSAwOwoKICAvLy8gSG93IG1hbnkgZGlzdGluY3QgYWRkcmVzc2VzIGhhdmUgaW52ZXN0ZWQKICB1aW50IHB1YmxpYyBpbnZlc3RvckNvdW50ID0gMDsKCiAgLy8vIEhvdyBtdWNoIHdlaSB3ZSBoYXZlIHJldHVybmVkIGJhY2sgdG8gdGhlIGNvbnRyYWN0IGFmdGVyIGEgZmFpbGVkIGNyb3dkZnVuZC4KICB1aW50IHB1YmxpYyBsb2FkZWRSZWZ1bmQgPSAwOwoKICAvLy8gSG93IG11Y2ggd2VpIHdlIGhhdmUgZ2l2ZW4gYmFjayB0byBpbnZlc3RvcnMuCiAgdWludCBwdWJsaWMgd2VpUmVmdW5kZWQgPSAwOwoKICAvLy8gSGFzIHRoaXMgY3Jvd2RzYWxlIGJlZW4gZmluYWxpemVkCiAgYm9vbCBwdWJsaWMgZmluYWxpemVkOwoKICAvLy8gVVNEIHRvIEV0aGVyIHJhdGUgaW4gY2VudHMKICB1aW50IHB1YmxpYyBleGNoYW5nZVJhdGU7CgogIC8vLyBleGNoYW5nZVJhdGUgdGltZXN0YW1wCiAgdWludCBwdWJsaWMgZXhjaGFuZ2VSYXRlVGltZXN0YW1wOwoKICAvLy8gRXh0ZXJuYWwgYWdlbnQgdGhhdCB3aWxsIGNhbiBjaGFuZ2UgZXhjaGFuZ2UgcmF0ZQogIGFkZHJlc3MgcHVibGljIGV4Y2hhbmdlUmF0ZUFnZW50OwoKICAvLy8gSG93IG11Y2ggRVRIIGVhY2ggYWRkcmVzcyBoYXMgaW52ZXN0ZWQgdG8gdGhpcyBjcm93ZHNhbGUKICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBpbnZlc3RlZEFtb3VudE9mOwoKICAvLy8gSG93IG11Y2ggdG9rZW5zIHRoaXMgY3Jvd2RzYWxlIGhhcyBjcmVkaXRlZCBmb3IgZWFjaCBpbnZlc3RvciBhZGRyZXNzCiAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgdG9rZW5BbW91bnRPZjsKCiAgLy8vIERlZmluZSBwcmVJQ08gcHJpY2luZyBzY2hlZHVsZSB1c2luZyBtaWxlc3RvbmVzLgogIHN0cnVjdCBNaWxlc3RvbmUgewogICAgICAvLyBVTklYIHRpbWVzdGFtcCB3aGVuIHRoaXMgbWlsZXN0b25lIGtpY2tzIGluCiAgICAgIHVpbnQgc3RhcnQ7CiAgICAgIC8vIFVOSVggdGltZXN0YW1wIHdoZW4gdGhpcyBtaWxlc3RvbmUga2lja3Mgb3V0CiAgICAgIHVpbnQgZW5kOwogICAgICAvLyBIb3cgbWFueSAlIHRva2VucyB3aWxsIGFkZAogICAgICB1aW50IGJvbnVzOwogIH0KCiAgTWlsZXN0b25lW10gcHVibGljIG1pbGVzdG9uZXM7CgogIC8vLyBTdGF0ZSBtYWNoaW5lCiAgLy8vIFByZXBhcmluZzogQWxsIGNvbnRyYWN0IGluaXRpYWxpemF0aW9uIGNhbGxzIGFuZCB2YXJpYWJsZXMgaGF2ZSBub3QgYmVlbiBzZXQgeWV0CiAgLy8vIFByZWZ1bmRpbmc6IFdlIGhhdmUgbm90IHBhc3NlZCBzdGFydCB0aW1lIHlldAogIC8vLyBGdW5kaW5nOiBBY3RpdmUgY3Jvd2RzYWxlCiAgLy8vIFN1Y2Nlc3M6IE1pbmltdW0gZnVuZGluZyBnb2FsIHJlYWNoZWQKICAvLy8gRmFpbHVyZTogTWluaW11bSBmdW5kaW5nIGdvYWwgbm90IHJlYWNoZWQgYmVmb3JlIGVuZGluZyB0aW1lCiAgLy8vIEZpbmFsaXplZDogVGhlIGZpbmFsaXplZCBoYXMgYmVlbiBjYWxsZWQgYW5kIHN1Y2Nlc2Z1bGx5IGV4ZWN1dGVkXAogIC8vLyBSZWZ1bmRpbmc6IFJlZnVuZHMgYXJlIGxvYWRlZCBvbiB0aGUgY29udHJhY3QgZm9yIHJlY2xhaW0uCiAgZW51bSBTdGF0ZXtVbmtub3duLCBQcmVwYXJpbmcsIFByZUZ1bmRpbmcsIEZ1bmRpbmcsIFN1Y2Nlc3MsIEZhaWx1cmUsIEZpbmFsaXplZCwgUmVmdW5kaW5nfQoKICAvLy8gQSBuZXcgaW52ZXN0bWVudCB3YXMgbWFkZQogIGV2ZW50IEludmVzdGVkKGFkZHJlc3MgaW52ZXN0b3IsIHVpbnQgd2VpQW1vdW50LCB1aW50IHRva2VuQW1vdW50KTsKICAvLy8gUmVmdW5kIHdhcyBwcm9jZXNzZWQgZm9yIGEgY29udHJpYnV0b3IKICBldmVudCBSZWZ1bmQoYWRkcmVzcyBpbnZlc3RvciwgdWludCB3ZWlBbW91bnQpOwogIC8vLyBDcm93ZHNhbGUgZW5kIHRpbWUgaGFzIGJlZW4gY2hhbmdlZAogIC8vZXZlbnQgRW5kc0F0Q2hhbmdlZCh1aW50IGVuZHNBdCk7CiAgLy8vIENhbGN1bGF0ZWQgbmV3IHByaWNlCiAgZXZlbnQgRXhjaGFuZ2VSYXRlQ2hhbmdlZCh1aW50IG9sZFZhbHVlLCB1aW50IG5ld1ZhbHVlKTsKCiAgLy8vIEBkZXYgTW9kaWZpZWQgYWxsb3dpbmcgZXhlY3V0aW9uIG9ubHkgaWYgdGhlIGNyb3dkc2FsZSBpcyBjdXJyZW50bHkgcnVubmluZwogIG1vZGlmaWVyIGluU3RhdGUoU3RhdGUgc3RhdGUpIHsKICAgIHJlcXVpcmUoZ2V0U3RhdGUoKSA9PSBzdGF0ZSk7CiAgICBfOwogIH0KCiAgbW9kaWZpZXIgb25seUV4Y2hhbmdlUmF0ZUFnZW50KCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGV4Y2hhbmdlUmF0ZUFnZW50KTsKICAgIF87CiAgfQoKICAvLy8gQGRldiBDb25zdHJ1Y3RvcgogIC8vLyBAcGFyYW0gX3Rva2VuIFNvbGFyIERhbyB0b2tlbiBhZGRyZXNzCiAgLy8vIEBwYXJhbSBfbXVsdGlzaWdXYWxsZXQgdGVhbSB3YWxsZXQKICAvLy8gQHBhcmFtIF9wcmVJbnZlc3RTdGFydCBwcmVJQ08gc3RhcnQgZGF0ZQogIC8vLyBAcGFyYW0gX3N0YXJ0IHRva2VuIElDTyBzdGFydCBkYXRlCiAgLy8vIEBwYXJhbSBfZW5kIHRva2VuIElDTyBlbmQgZGF0ZQogIGZ1bmN0aW9uIFNvbGFyRGFvVG9rZW5Dcm93ZHNhbGUoYWRkcmVzcyBfdG9rZW4sIGFkZHJlc3MgX211bHRpc2lnV2FsbGV0LCB1aW50IF9wcmVJbnZlc3RTdGFydCwgdWludCBfc3RhcnQsIHVpbnQgX2VuZCkgewogICAgcmVxdWlyZShfbXVsdGlzaWdXYWxsZXQgIT0gMCk7CiAgICByZXF1aXJlKF9wcmVJbnZlc3RTdGFydCAhPSAwKTsKICAgIHJlcXVpcmUoX3N0YXJ0ICE9IDApOwogICAgcmVxdWlyZShfZW5kICE9IDApOwogICAgcmVxdWlyZShfc3RhcnQgPCBfZW5kKTsKICAgIHJlcXVpcmUoX2VuZCA+ICAxNTE0NDE5MTk5KTsKCiAgICB0b2tlbiA9IFNvbGFyRGFvVG9rZW4oX3Rva2VuKTsKCiAgICBtdWx0aXNpZ1dhbGxldCA9IF9tdWx0aXNpZ1dhbGxldDsKICAgIHN0YXJ0c0F0ID0gX3N0YXJ0OwogICAgZW5kc0F0ID0gX2VuZDsKICAgIHByZUludmVzdFN0YXJ0ID0gX3ByZUludmVzdFN0YXJ0OwoKICAgIG1pbGVzdG9uZXMucHVzaChNaWxlc3RvbmUocHJlSW52ZXN0U3RhcnQsIDE1MTQ0MTkxOTksIDQwKSk7CgogICAgdmFyIGljb0JvbnVzZXMgPSBbdWludCgxNSksIDEwLCA1XTsKICAgIGZvciAodWludCBpID0gMTsgaSA8PSBpY29Cb251c2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgIG1pbGVzdG9uZXMucHVzaChNaWxlc3RvbmUoc3RhcnRzQXQgKyBpICogMSB3ZWVrcywgc3RhcnRzQXQgKyAoaSArIDEpICogMSB3ZWVrcywgaWNvQm9udXNlc1tpIC0gMV0pKTsKICAgIH0KICAgIGRlbGV0ZSBpY29Cb251c2VzOwogIH0KCiAgZnVuY3Rpb24oKSBwYXlhYmxlIHsKICAgIGJ1eSgpOwogIH0KCiAgLy8vIEBkZXYgR2V0IHRoZSBjdXJyZW50IG1pbGVzdG9uZSBvciBiYWlsIG91dCBpZiB3ZSBhcmUgbm90IGluIHRoZSBtaWxlc3RvbmUgcGVyaW9kcy4KICAvLy8gQHJldHVybiBNaWxlc3RvbmUgY3VycmVudCBib251cyBtaWxlc3RvbmUKICBmdW5jdGlvbiBnZXRDdXJyZW50TWlsZXN0b25lKCkgcHJpdmF0ZSBjb25zdGFudCByZXR1cm5zIChNaWxlc3RvbmUpIHsKICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgbWlsZXN0b25lcy5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChtaWxlc3RvbmVzW2ldLnN0YXJ0IDw9IG5vdyAmJiBtaWxlc3RvbmVzW2ldLmVuZCA+IG5vdykgewogICAgICAgICAgcmV0dXJuIG1pbGVzdG9uZXNbaV07CiAgICAgICAgfQogICAgICB9CiAgfQoKICAgLy8vIEBkZXYgTWFrZSBhbiBpbnZlc3RtZW50LiBDcm93ZHNhbGUgbXVzdCBiZSBydW5uaW5nIGZvciBvbmUgdG8gaW52ZXN0LgogICAvLy8gQHBhcmFtIHJlY2VpdmVyIFRoZSBFdGhlcmV1bSBhZGRyZXNzIHdobyByZWNlaXZlcyB0aGUgdG9rZW5zCiAgZnVuY3Rpb24gaW52ZXN0SW50ZXJuYWwoYWRkcmVzcyByZWNlaXZlcikgc3RvcEluRW1lcmdlbmN5IHByaXZhdGUgewogICAgdmFyIHN0YXRlID0gZ2V0U3RhdGUoKTsKICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuRnVuZGluZyB8fCBzdGF0ZSA9PSBTdGF0ZS5QcmVGdW5kaW5nKTsKICAgIHJlcXVpcmUobXNnLnZhbHVlID49IE1JTl9JTlZFU1RNRU5UKTsKCiAgICB1aW50IHdlaUFtb3VudCA9IG1zZy52YWx1ZTsKCiAgICB1aW50IHRva2Vuc0Ftb3VudCA9IGNhbGN1bGF0ZVRva2Vucyh3ZWlBbW91bnQpOwogICAgYXNzZXJ0ICh0b2tlbnNBbW91bnQgPiAwKTsKCiAgICBpZihzdGF0ZSA9PSBTdGF0ZS5QcmVGdW5kaW5nKSB7CiAgICAgICAgdG9rZW5zQW1vdW50ICs9IHNhZmVEaXYoc2FmZU11bCh0b2tlbnNBbW91bnQsIGdldEN1cnJlbnRNaWxlc3RvbmUoKS5ib251cyksIDEwMCk7CiAgICB9CgogICAgaWYoaW52ZXN0ZWRBbW91bnRPZltyZWNlaXZlcl0gPT0gMCkgewogICAgICAgLy8gQSBuZXcgaW52ZXN0b3IKICAgICAgIGludmVzdG9yQ291bnQrKzsKICAgIH0KCiAgICAvLyBVcGRhdGUgaW52ZXN0b3IKICAgIGludmVzdGVkQW1vdW50T2ZbcmVjZWl2ZXJdID0gc2FmZUFkZChpbnZlc3RlZEFtb3VudE9mW3JlY2VpdmVyXSwgd2VpQW1vdW50KTsKICAgIHRva2VuQW1vdW50T2ZbcmVjZWl2ZXJdID0gc2FmZUFkZCh0b2tlbkFtb3VudE9mW3JlY2VpdmVyXSwgdG9rZW5zQW1vdW50KTsKICAgIC8vIFVwZGF0ZSB0b3RhbHMKICAgIHdlaVJhaXNlZCA9IHNhZmVBZGQod2VpUmFpc2VkLCB3ZWlBbW91bnQpOwogICAgdG9rZW5zU29sZCA9IHNhZmVBZGQodG9rZW5zU29sZCwgdG9rZW5zQW1vdW50KTsKCiAgICBhc3NpZ25Ub2tlbnMocmVjZWl2ZXIsIHRva2Vuc0Ftb3VudCk7CiAgICB2YXIgdGVhbUJvbnVzVG9rZW5zID0gc2FmZURpdihzYWZlTXVsKHRva2Vuc0Ftb3VudCwgVEVBTV9CT05VU19QRVJDRU5UKSwgMTAwIC0gVEVBTV9CT05VU19QRVJDRU5UKTsKICAgIGFzc2lnblRva2VucyhtdWx0aXNpZ1dhbGxldCwgdGVhbUJvbnVzVG9rZW5zKTsKCiAgICBtdWx0aXNpZ1dhbGxldC50cmFuc2Zlcih3ZWlBbW91bnQpOwogICAgLy8gVGVsbCB1cyBpbnZlc3Qgd2FzIHN1Y2Nlc3MKICAgIEludmVzdGVkKHJlY2VpdmVyLCB3ZWlBbW91bnQsIHRva2Vuc0Ftb3VudCk7CiAgfQoKICAvLy8gQGRldiBBbGxvdyBhbm9ueW1vdXMgY29udHJpYnV0aW9ucyB0byB0aGlzIGNyb3dkc2FsZS4KICAvLy8gQHBhcmFtIHJlY2VpdmVyIFRoZSBFdGhlcmV1bSBhZGRyZXNzIHdobyByZWNlaXZlcyB0aGUgdG9rZW5zCiAgZnVuY3Rpb24gaW52ZXN0KGFkZHJlc3MgcmVjZWl2ZXIpIHB1YmxpYyBwYXlhYmxlIHsKICAgIGludmVzdEludGVybmFsKHJlY2VpdmVyKTsKICB9CgogIC8vLyBAZGV2IFRoZSBiYXNpYyBlbnRyeSBwb2ludCB0byBwYXJ0aWNpcGF0ZSB0aGUgY3Jvd2RzYWxlIHByb2Nlc3MuCiAgZnVuY3Rpb24gYnV5KCkgcHVibGljIHBheWFibGUgewogICAgaW52ZXN0KG1zZy5zZW5kZXIpOwogIH0KCiAgLy8vIEBkZXYgRmluYWxpemUgYSBzdWNjY2VzZnVsIGNyb3dkc2FsZS4KICBmdW5jdGlvbiBmaW5hbGl6ZSgpIHB1YmxpYyBpblN0YXRlKFN0YXRlLlN1Y2Nlc3MpIG9ubHlPd25lciBzdG9wSW5FbWVyZ2VuY3kgewogICAgcmVxdWlyZSghZmluYWxpemVkKTsKCiAgICBmaW5hbGl6ZWQgPSB0cnVlOwogICAgZmluYWxpemVDcm93ZHNhbGUoKTsKICB9CgogIC8vLyBAZGV2IEZpbmFsaXplIGEgc3VjY2Nlc2Z1bCBjcm93ZHNhbGUuCiAgZnVuY3Rpb24gZmluYWxpemVDcm93ZHNhbGUoKSBpbnRlcm5hbCB7CiAgICB0b2tlbi5yZWxlYXNlVG9rZW5UcmFuc2ZlcigpOwogIH0KCiAgIC8vLyBAZGV2IE1ldGhvZCBmb3Igc2V0dGluZyBVU0QgdG8gRXRoZXIgcmF0ZSBmcm9tIFBvbG9uaWV4CiAgIC8vLyBAcGFyYW0gdmFsdWUgVVNEIGFtb3V0IGluIGNlbnRzIGZvciAxIEV0aGVyCiAgIC8vLyBAcGFyYW0gdGltZSB0aW1lc3RhbXAKICBmdW5jdGlvbiBzZXRFeGNoYW5nZVJhdGUodWludCB2YWx1ZSwgdWludCB0aW1lKSBvbmx5RXhjaGFuZ2VSYXRlQWdlbnQgewogICAgcmVxdWlyZSh2YWx1ZSA+IDApOwogICAgcmVxdWlyZSh0aW1lID4gMCk7CiAgICByZXF1aXJlKGV4Y2hhbmdlUmF0ZVRpbWVzdGFtcCA9PSAwIHx8IGdldERpZmZlcmVuY2UoaW50KHRpbWUpLCBpbnQobm93KSkgPD0gMSBtaW51dGVzKTsKICAgIHJlcXVpcmUoZXhjaGFuZ2VSYXRlID09IDAgfHwgKGdldERpZmZlcmVuY2UoaW50KHZhbHVlKSwgaW50KGV4Y2hhbmdlUmF0ZSkpICogMTAwIC8gZXhjaGFuZ2VSYXRlIDw9IDMwKSk7CgogICAgRXhjaGFuZ2VSYXRlQ2hhbmdlZChleGNoYW5nZVJhdGUsIHZhbHVlKTsKICAgIGV4Y2hhbmdlUmF0ZSA9IHZhbHVlOwogICAgZXhjaGFuZ2VSYXRlVGltZXN0YW1wID0gdGltZTsKICB9CgogIC8vLyBAZGV2IE1ldGhvZCBzZXQgZXhjaGFuZ2UgcmF0ZSBhZ2VudAogIC8vLyBAcGFyYW0gbmV3QWdlbnQgbmV3IGFnZW50CiBmdW5jdGlvbiBzZXRFeGNoYW5nZVJhdGVBZ2VudChhZGRyZXNzIG5ld0FnZW50KSBvbmx5T3duZXIgewogICBpZiAobmV3QWdlbnQgIT0gYWRkcmVzcygwKSkgewogICAgIGV4Y2hhbmdlUmF0ZUFnZW50ID0gbmV3QWdlbnQ7CiAgIH0KIH0KCiAgLy8vIEBkZXYgTWV0aG9kIHNldCBkYXRhIGZyb20gbWlncmF0ZWQgY29udHJhY3QKICAvLy8gQHBhcmFtIF90b2tlbnNTb2xkIHRva2VucyBzb2xkCiAgLy8vIEBwYXJhbSBfd2VpUmFpc2VkIF93ZWkgcmFpc2VkCiAgLy8vIEBwYXJhbSBfaW52ZXN0b3JDb3VudCBpbnZlc3RvciBjb3VudAogZnVuY3Rpb24gc2V0Q3Jvd2RzYWxlRGF0YSh1aW50IF90b2tlbnNTb2xkLCB1aW50IF93ZWlSYWlzZWQsIHVpbnQgX2ludmVzdG9yQ291bnQpIG9ubHlPd25lciB7CglyZXF1aXJlKF90b2tlbnNTb2xkID4gMCk7CglyZXF1aXJlKF93ZWlSYWlzZWQgPiAwKTsKCXJlcXVpcmUoX2ludmVzdG9yQ291bnQgPiAwKTsKCgl0b2tlbnNTb2xkID0gX3Rva2Vuc1NvbGQ7Cgl3ZWlSYWlzZWQgPSBfd2VpUmFpc2VkOwoJaW52ZXN0b3JDb3VudCA9IF9pbnZlc3RvckNvdW50OwogfQoKICBmdW5jdGlvbiBnZXREaWZmZXJlbmNlKGludCBvbmUsIGludCB0d28pIHByaXZhdGUgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgdmFyIGRpZmYgPSBvbmUgLSB0d287CiAgICBpZiAoZGlmZiA8IDApCiAgICAgIGRpZmYgPSAtZGlmZjsKICAgIHJldHVybiB1aW50KGRpZmYpOwogIH0KCiAgLy8vIEBkZXYgQWxsb3cgY3Jvd2RzYWxlIG93bmVyIHRvIGNsb3NlIGVhcmx5IG9yIGV4dGVuZCB0aGUgY3Jvd2RzYWxlLgogIC8vLyBAcGFyYW0gdGltZSB0aW1lc3RhbXAKICBmdW5jdGlvbiBzZXRFbmRzQXQodWludCB0aW1lKSBvbmx5T3duZXIgewogICAgcmVxdWlyZSh0aW1lID49IG5vdyk7CiAgICBlbmRzQXQgPSB0aW1lOwogICAgLy9FbmRzQXRDaGFuZ2VkKGVuZHNBdCk7CiAgfQoKICAvLy8gQGRldiBBbGxvdyBsb2FkIHJlZnVuZHMgYmFjayBvbiB0aGUgY29udHJhY3QgZm9yIHRoZSByZWZ1bmRpbmcuCiAgZnVuY3Rpb24gbG9hZFJlZnVuZCgpIHB1YmxpYyBwYXlhYmxlIGluU3RhdGUoU3RhdGUuRmFpbHVyZSkgewogICAgcmVxdWlyZShtc2cudmFsdWUgPiAwKTsKICAgIGxvYWRlZFJlZnVuZCA9IHNhZmVBZGQobG9hZGVkUmVmdW5kLCBtc2cudmFsdWUpOwogIH0KCiAgLy8vIEBkZXYgSW52ZXN0b3JzIGNhbiBjbGFpbSByZWZ1bmQuCiAgZnVuY3Rpb24gcmVmdW5kKCkgcHVibGljIGluU3RhdGUoU3RhdGUuUmVmdW5kaW5nKSB7CiAgICB1aW50MjU2IHdlaVZhbHVlID0gaW52ZXN0ZWRBbW91bnRPZlttc2cuc2VuZGVyXTsKICAgIGlmICh3ZWlWYWx1ZSA9PSAwKQogICAgICByZXR1cm47CiAgICBpbnZlc3RlZEFtb3VudE9mW21zZy5zZW5kZXJdID0gMDsKICAgIHdlaVJlZnVuZGVkID0gc2FmZUFkZCh3ZWlSZWZ1bmRlZCwgd2VpVmFsdWUpOwogICAgUmVmdW5kKG1zZy5zZW5kZXIsIHdlaVZhbHVlKTsKICAgIG1zZy5zZW5kZXIudHJhbnNmZXIod2VpVmFsdWUpOwogIH0KCiAgLy8vIEBkZXYgTWluaW11bSBnb2FsIHdhcyByZWFjaGVkCiAgLy8vIEByZXR1cm4gdHJ1ZSBpZiB0aGUgY3Jvd2RzYWxlIGhhcyByYWlzZWQgZW5vdWdoIG1vbmV5IHRvIG5vdCBpbml0aWF0ZSB0aGUgcmVmdW5kaW5nCiAgZnVuY3Rpb24gaXNNaW5pbXVtR29hbFJlYWNoZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCByZWFjaGVkKSB7CiAgICByZXR1cm4gd2VpVG9Vc2RDZW50cyh3ZWlSYWlzZWQpID49IE1JTl9JQ09fR09BTDsKICB9CgogIC8vLyBAZGV2IENoZWNrIGlmIHRoZSBJQ08gZ29hbCB3YXMgcmVhY2hlZC4KICAvLy8gQHJldHVybiB0cnVlIGlmIHRoZSBjcm93ZHNhbGUgaGFzIHJhaXNlZCBlbm91Z2ggbW9uZXkgdG8gYmUgYSBzdWNjZXNzCiAgZnVuY3Rpb24gaXNDcm93ZHNhbGVGdWxsKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiB3ZWlUb1VzZENlbnRzKHdlaVJhaXNlZCkgPj0gSUNPX0dPQUw7CiAgfQoKICAvLy8gQGRldiBDcm93ZGZ1bmQgc3RhdGUgbWFjaGluZSBtYW5hZ2VtZW50LgogIC8vLyBAcmV0dXJuIFN0YXRlIGN1cnJlbnQgc3RhdGUKICBmdW5jdGlvbiBnZXRTdGF0ZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChTdGF0ZSkgewogICAgaWYgKGZpbmFsaXplZCkKICAgICAgcmV0dXJuIFN0YXRlLkZpbmFsaXplZDsKICAgIGlmIChhZGRyZXNzKHRva2VuKSA9PSAwIHx8IGFkZHJlc3MobXVsdGlzaWdXYWxsZXQpID09IDAgfHwgbm93IDwgcHJlSW52ZXN0U3RhcnQpCiAgICAgIHJldHVybiBTdGF0ZS5QcmVwYXJpbmc7CiAgICBpZiAocHJlSW52ZXN0U3RhcnQgPD0gbm93ICYmIG5vdyA8IHN0YXJ0c0F0ICYmICFpc01heGltdW1QcmVGdW5kaW5nR29hbFJlYWNoZWQoKSkKICAgICAgcmV0dXJuIFN0YXRlLlByZUZ1bmRpbmc7CiAgICBpZiAobm93IDw9IGVuZHNBdCAmJiAhaXNDcm93ZHNhbGVGdWxsKCkpCiAgICAgIHJldHVybiBTdGF0ZS5GdW5kaW5nOwogICAgaWYgKGlzTWluaW11bUdvYWxSZWFjaGVkKCkpCiAgICAgIHJldHVybiBTdGF0ZS5TdWNjZXNzOwogICAgaWYgKCFpc01pbmltdW1Hb2FsUmVhY2hlZCgpICYmIHdlaVJhaXNlZCA+IDAgJiYgbG9hZGVkUmVmdW5kID49IHdlaVJhaXNlZCkKICAgICAgcmV0dXJuIFN0YXRlLlJlZnVuZGluZzsKICAgIHJldHVybiBTdGF0ZS5GYWlsdXJlOwogIH0KCiAgLy8vIEBkZXYgQ2FsY3VsYXRpbmcgdG9rZW5zIGNvdW50CiAgLy8vIEBwYXJhbSB3ZWlBbW91bnQgaW52ZXN0ZWQKICAvLy8gQHJldHVybiB0b2tlbnMgYW1vdW50CiAgZnVuY3Rpb24gY2FsY3VsYXRlVG9rZW5zKHVpbnQgd2VpQW1vdW50KSBpbnRlcm5hbCByZXR1cm5zICh1aW50IHRva2VuQW1vdW50KSB7CiAgICB2YXIgbXVsdGlwbGllciA9IDEwICoqIHRva2VuLmRlY2ltYWxzKCk7CgogICAgdWludCB1c2RBbW91bnQgPSB3ZWlUb1VzZENlbnRzKHdlaUFtb3VudCk7CiAgICBhc3NlcnQgKHVzZEFtb3VudCA+PSBQUklDRSk7CgogICAgcmV0dXJuIHNhZmVNdWwodXNkQW1vdW50LCBzYWZlRGl2KG11bHRpcGxpZXIsIFBSSUNFKSk7CiAgfQoKICAgLy8vIEBkZXYgQ2hlY2sgaWYgdGhlIHByZSBJQ08gZ29hbCB3YXMgcmVhY2hlZC4KICAgLy8vIEByZXR1cm4gdHJ1ZSBpZiB0aGUgcHJlSUNPIGhhcyByYWlzZWQgZW5vdWdoIG1vbmV5IHRvIGJlIGEgc3VjY2VzcwogICBmdW5jdGlvbiBpc01heGltdW1QcmVGdW5kaW5nR29hbFJlYWNoZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCByZWFjaGVkKSB7CiAgICAgcmV0dXJuIHdlaVRvVXNkQ2VudHMod2VpUmFpc2VkKSA+PSBQUkVfRlVORElOR19HT0FMOwogICB9CgogICAvLy8gQGRldiBDb252ZXJ0cyB3ZWkgdmFsdWUgaW50byBVU0QgY2VudHMgYWNjb3JkaW5nIHRvIGN1cnJlbnQgZXhjaGFuZ2UgcmF0ZQogICAvLy8gQHBhcmFtIHdlaVZhbHVlIHdlaSB2YWx1ZSB0byBjb252ZXJ0CiAgIC8vLyBAcmV0dXJuIFVTRCBjZW50cyBlcXVpdmFsZW50IG9mIHRoZSB3ZWkgdmFsdWUKICAgZnVuY3Rpb24gd2VpVG9Vc2RDZW50cyh1aW50IHdlaVZhbHVlKSBwcml2YXRlIHJldHVybnMgKHVpbnQpIHsKICAgICByZXR1cm4gc2FmZURpdihzYWZlTXVsKHdlaVZhbHVlLCBleGNoYW5nZVJhdGUpLCAxZTE4KTsKICAgfQoKICAgLy8vIEBkZXYgRHluYW1pY2FsbHkgY3JlYXRlIHRva2VucyBhbmQgYXNzaWduIHRoZW0gdG8gdGhlIGludmVzdG9yLgogICAvLy8gQHBhcmFtIHJlY2VpdmVyIGludmVzdG9yIGFkZHJlc3MKICAgLy8vIEBwYXJhbSB0b2tlbkFtb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB3ZSB0cnkgdG8gZ2l2ZSB0byB0aGUgaW52ZXN0b3IgaW4gdGhlIGN1cnJlbnQgdHJhbnNhY3Rpb24KICAgZnVuY3Rpb24gYXNzaWduVG9rZW5zKGFkZHJlc3MgcmVjZWl2ZXIsIHVpbnQgdG9rZW5BbW91bnQpIHByaXZhdGUgewogICAgIHRva2VuLm1pbnQocmVjZWl2ZXIsIHRva2VuQW1vdW50KTsKICAgfQp9'.
	

]
