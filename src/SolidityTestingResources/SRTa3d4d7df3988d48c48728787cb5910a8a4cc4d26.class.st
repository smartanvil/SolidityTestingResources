Class {
	#name : #SRTa3d4d7df3988d48c48728787cb5910a8a4cc4d26,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTa3d4d7df3988d48c48728787cb5910a8a4cc4d26 >> base64 [
	^ 'Y29udHJhY3QgRXRoZXJvcHQgewoKICBzdHJ1Y3QgT3B0aW9uIHsKICAgIGludCBzdHJpa2U7CiAgfQogIHN0cnVjdCBQb3NpdGlvbiB7CiAgICBtYXBwaW5nKHVpbnQgPT4gaW50KSBwb3NpdGlvbnM7CiAgICBpbnQgY2FzaDsKICAgIGJvb2wgZXhwaXJlZDsKICAgIGJvb2wgaGFzUG9zaXRpb247CiAgfQogIHN0cnVjdCBPcHRpb25DaGFpbiB7CiAgICB1aW50IGV4cGlyYXRpb247CiAgICBzdHJpbmcgdW5kZXJseWluZzsKICAgIHVpbnQgbWFyZ2luOwogICAgdWludCByZWFsaXR5SUQ7CiAgICBieXRlczMyIGZhY3RIYXNoOwogICAgYWRkcmVzcyBldGhBZGRyOwogICAgbWFwcGluZyh1aW50ID0+IE9wdGlvbikgb3B0aW9uczsKICAgIHVpbnQgbnVtT3B0aW9uczsKICAgIGJvb2wgZXhwaXJlZDsKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBQb3NpdGlvbikgcG9zaXRpb25zOwogICAgdWludCBudW1Qb3NpdGlvbnM7CiAgICB1aW50IG51bVBvc2l0aW9uc0V4cGlyZWQ7CiAgfQogIG1hcHBpbmcodWludCA9PiBPcHRpb25DaGFpbikgb3B0aW9uQ2hhaW5zOwogIHVpbnQgbnVtT3B0aW9uQ2hhaW5zOwogIHN0cnVjdCBBY2NvdW50IHsKICAgIGFkZHJlc3MgdXNlcjsKICAgIGludCBjYXBpdGFsOwogIH0KICBtYXBwaW5nKGJ5dGVzMzIgPT4gaW50KSBvcmRlckZpbGxzOyAvL2tlZXBzIHRyYWNrIG9mIGN1bXVsYXRpdmUgb3JkZXIgZmlsbHMKICBzdHJ1Y3QgTWFya2V0TWFrZXIgewogICAgYWRkcmVzcyB1c2VyOwogICAgc3RyaW5nIHNlcnZlcjsKICB9CiAgbWFwcGluZyh1aW50ID0+IE1hcmtldE1ha2VyKSBtYXJrZXRNYWtlcnM7IC8vc3RhcnRzIGF0IDEKICB1aW50IHB1YmxpYyBudW1NYXJrZXRNYWtlcnMgPSAwOwogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50KSBtYXJrZXRNYWtlcklEczsKICBtYXBwaW5nKHVpbnQgPT4gQWNjb3VudCkgYWNjb3VudHM7CiAgdWludCBwdWJsaWMgbnVtQWNjb3VudHM7CiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIGFjY291bnRJRHM7IC8vc3RhcnRzIGF0IDEKCiAgZnVuY3Rpb24gTWFya2V0KCkgewogIH0KCiAgZnVuY3Rpb24gZ2V0QWNjb3VudElEKGFkZHJlc3MgdXNlcikgY29uc3RhbnQgcmV0dXJucyh1aW50KSB7CiAgICByZXR1cm4gYWNjb3VudElEc1t1c2VyXTsKICB9CgogIGZ1bmN0aW9uIGdldEFjY291bnQodWludCBhY2NvdW50SUQpIGNvbnN0YW50IHJldHVybnMoYWRkcmVzcykgewogICAgcmV0dXJuIGFjY291bnRzW2FjY291bnRJRF0udXNlcjsKICB9CgogIGZ1bmN0aW9uIGFkZEZ1bmRzKCkgewogICAgaWYgKGFjY291bnRJRHNbbXNnLnNlbmRlcl0+MCkgewogICAgICBhY2NvdW50c1thY2NvdW50SURzW21zZy5zZW5kZXJdXS5jYXBpdGFsICs9IGludChtc2cudmFsdWUpOwogICAgfSBlbHNlIHsKICAgICAgdWludCBhY2NvdW50SUQgPSArK251bUFjY291bnRzOwogICAgICBhY2NvdW50c1thY2NvdW50SURdLnVzZXIgPSBtc2cuc2VuZGVyOwogICAgICBhY2NvdW50c1thY2NvdW50SURdLmNhcGl0YWwgKz0gaW50KG1zZy52YWx1ZSk7CiAgICAgIGFjY291bnRJRHNbbXNnLnNlbmRlcl0gPSBhY2NvdW50SUQ7CiAgICB9CiAgfQoKICBmdW5jdGlvbiB3aXRoZHJhd0Z1bmRzKHVpbnQgYW1vdW50KSB7CiAgICBpZiAoYWNjb3VudElEc1ttc2cuc2VuZGVyXT4wKSB7CiAgICAgIGlmIChpbnQoYW1vdW50KTw9Z2V0RnVuZHMobXNnLnNlbmRlciwgdHJ1ZSkgJiYgaW50KGFtb3VudCk+MCkgewogICAgICAgIGFjY291bnRzW2FjY291bnRJRHNbbXNnLnNlbmRlcl1dLmNhcGl0YWwgLT0gaW50KGFtb3VudCk7CiAgICAgICAgbXNnLnNlbmRlci5zZW5kKGFtb3VudCk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGdldEZ1bmRzKGFkZHJlc3MgdXNlciwgYm9vbCBvbmx5QXZhaWxhYmxlKSBjb25zdGFudCByZXR1cm5zKGludCkgewogICAgaWYgKGFjY291bnRJRHNbdXNlcl0+MCkgewogICAgICBpZiAob25seUF2YWlsYWJsZSA9PSBmYWxzZSkgewogICAgICAgIHJldHVybiBhY2NvdW50c1thY2NvdW50SURzW3VzZXJdXS5jYXBpdGFsOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBhY2NvdW50c1thY2NvdW50SURzW3VzZXJdXS5jYXBpdGFsICsgZ2V0TWF4TG9zc0FmdGVyVHJhZGUodXNlciwgMCwgMCwgMCwgMCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiAwOwogICAgfQogIH0KCiAgZnVuY3Rpb24gZ2V0RnVuZHNBbmRBdmFpbGFibGUoYWRkcmVzcyB1c2VyKSBjb25zdGFudCByZXR1cm5zKGludCwgaW50KSB7CiAgICByZXR1cm4gKGdldEZ1bmRzKHVzZXIsIGZhbHNlKSwgZ2V0RnVuZHModXNlciwgdHJ1ZSkpOwogIH0KCiAgZnVuY3Rpb24gbWFya2V0TWFrZXIoc3RyaW5nIHNlcnZlcikgewogICAgaWYgKG1zZy52YWx1ZT4wKSB0aHJvdzsKICAgIGlmIChtYXJrZXRNYWtlcklEc1ttc2cuc2VuZGVyXT4wKSB7CiAgICAgIG1hcmtldE1ha2Vyc1ttYXJrZXRNYWtlcklEc1ttc2cuc2VuZGVyXV0uc2VydmVyID0gc2VydmVyOwogICAgfSBlbHNlIHsKICAgICAgaW50IGZ1bmRzID0gZ2V0RnVuZHMobWFya2V0TWFrZXJzW2ldLnVzZXIsIGZhbHNlKTsKICAgICAgdWludCBtYXJrZXRNYWtlcklEID0gMDsKICAgICAgaWYgKG51bU1hcmtldE1ha2Vyczw2KSB7CiAgICAgICAgbWFya2V0TWFrZXJJRCA9ICsrbnVtTWFya2V0TWFrZXJzOwogICAgICB9IGVsc2UgewogICAgICAgIGZvciAodWludCBpPTI7IGk8PW51bU1hcmtldE1ha2VyczsgaSsrKSB7CiAgICAgICAgICBpZiAoZ2V0RnVuZHMobWFya2V0TWFrZXJzW2ldLnVzZXIsIGZhbHNlKTw9ZnVuZHMgJiYgKG1hcmtldE1ha2VySUQ9PTAgfHwgZ2V0RnVuZHMobWFya2V0TWFrZXJzW2ldLnVzZXIsIGZhbHNlKTxnZXRGdW5kcyhtYXJrZXRNYWtlcnNbbWFya2V0TWFrZXJJRF0udXNlciwgZmFsc2UpKSkgewogICAgICAgICAgICBtYXJrZXRNYWtlcklEID0gaTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKG1hcmtldE1ha2VySUQ+MCkgewogICAgICAgIG1hcmtldE1ha2VySURzW21hcmtldE1ha2Vyc1ttYXJrZXRNYWtlcklEXS51c2VyXSA9IDA7CiAgICAgICAgbWFya2V0TWFrZXJzW21hcmtldE1ha2VySURdLnVzZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIG1hcmtldE1ha2Vyc1ttYXJrZXRNYWtlcklEXS5zZXJ2ZXIgPSBzZXJ2ZXI7CiAgICAgICAgbWFya2V0TWFrZXJJRHNbbXNnLnNlbmRlcl0gPSBtYXJrZXRNYWtlcklEOwogICAgICB9IGVsc2UgewogICAgICAgIHRocm93OwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBnZXRNYXJrZXRNYWtlcnMoKSBjb25zdGFudCByZXR1cm5zKHN0cmluZywgc3RyaW5nLCBzdHJpbmcsIHN0cmluZywgc3RyaW5nLCBzdHJpbmcpIHsKICAgIHN0cmluZ1tdIG1lbW9yeSBzZXJ2ZXJzID0gbmV3IHN0cmluZ1tdKDYpOwogICAgZm9yICh1aW50IGk9MTsgaTw9bnVtTWFya2V0TWFrZXJzOyBpKyspIHsKICAgICAgc2VydmVyc1tpLTFdID0gbWFya2V0TWFrZXJzW2ldLnNlcnZlcjsKICAgIH0KICAgIHJldHVybiAoc2VydmVyc1swXSwgc2VydmVyc1sxXSwgc2VydmVyc1syXSwgc2VydmVyc1szXSwgc2VydmVyc1s0XSwgc2VydmVyc1s1XSk7CiAgfQoKICBmdW5jdGlvbiBnZXRNYXJrZXRNYWtlckZ1bmRzKCkgY29uc3RhbnQgcmV0dXJucyhpbnQsIGludCwgaW50LCBpbnQsIGludCwgaW50KSB7CiAgICBpbnRbXSBtZW1vcnkgZnVuZHMgPSBuZXcgaW50W10oNik7CiAgICBmb3IgKHVpbnQgaT0xOyBpPD1udW1NYXJrZXRNYWtlcnM7IGkrKykgewogICAgICBmdW5kc1tpLTFdID0gZ2V0RnVuZHMobWFya2V0TWFrZXJzW2ldLnVzZXIsIGZhbHNlKTsKICAgIH0KICAgIHJldHVybiAoZnVuZHNbMF0sIGZ1bmRzWzFdLCBmdW5kc1syXSwgZnVuZHNbM10sIGZ1bmRzWzRdLCBmdW5kc1s1XSk7CiAgfQoKICBmdW5jdGlvbiBnZXRPcHRpb25DaGFpbih1aW50IG9wdGlvbkNoYWluSUQpIGNvbnN0YW50IHJldHVybnMgKHVpbnQsIHN0cmluZywgdWludCwgdWludCwgYnl0ZXMzMiwgYWRkcmVzcykgewogICAgcmV0dXJuIChvcHRpb25DaGFpbnNbb3B0aW9uQ2hhaW5JRF0uZXhwaXJhdGlvbiwgb3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLnVuZGVybHlpbmcsIG9wdGlvbkNoYWluc1tvcHRpb25DaGFpbklEXS5tYXJnaW4sIG9wdGlvbkNoYWluc1tvcHRpb25DaGFpbklEXS5yZWFsaXR5SUQsIG9wdGlvbkNoYWluc1tvcHRpb25DaGFpbklEXS5mYWN0SGFzaCwgb3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLmV0aEFkZHIpOwogIH0KCiAgZnVuY3Rpb24gZ2V0TWFya2V0KGFkZHJlc3MgdXNlcikgY29uc3RhbnQgcmV0dXJucyh1aW50W10sIGludFtdLCBpbnRbXSwgaW50W10pIHsKICAgIHVpbnRbXSBtZW1vcnkgb3B0aW9uSURzID0gbmV3IHVpbnRbXSg2MCk7CiAgICBpbnRbXSBtZW1vcnkgc3RyaWtlcyA9IG5ldyBpbnRbXSg2MCk7CiAgICBpbnRbXSBtZW1vcnkgcG9zaXRpb25zID0gbmV3IGludFtdKDYwKTsKICAgIGludFtdIG1lbW9yeSBjYXNoZXMgPSBuZXcgaW50W10oNjApOwogICAgdWludCB6ID0gMDsKICAgIGZvciAoaW50IG9wdGlvbkNoYWluSUQ9aW50KG51bU9wdGlvbkNoYWlucyktMTsgb3B0aW9uQ2hhaW5JRD49MCAmJiB6PDYwOyBvcHRpb25DaGFpbklELS0pIHsKICAgICAgaWYgKG9wdGlvbkNoYWluc1t1aW50KG9wdGlvbkNoYWluSUQpXS5leHBpcmVkID09IGZhbHNlKSB7CiAgICAgICAgZm9yICh1aW50IG9wdGlvbklEPTA7IG9wdGlvbklEPG9wdGlvbkNoYWluc1t1aW50KG9wdGlvbkNoYWluSUQpXS5udW1PcHRpb25zOyBvcHRpb25JRCsrKSB7CiAgICAgICAgICBvcHRpb25JRHNbel0gPSB1aW50KG9wdGlvbkNoYWluSUQpKjEwMDAgKyBvcHRpb25JRDsKICAgICAgICAgIHN0cmlrZXNbel0gPSBvcHRpb25DaGFpbnNbdWludChvcHRpb25DaGFpbklEKV0ub3B0aW9uc1tvcHRpb25JRF0uc3RyaWtlOwogICAgICAgICAgcG9zaXRpb25zW3pdID0gb3B0aW9uQ2hhaW5zW3VpbnQob3B0aW9uQ2hhaW5JRCldLnBvc2l0aW9uc1t1c2VyXS5wb3NpdGlvbnNbb3B0aW9uSURdOwogICAgICAgICAgY2FzaGVzW3pdID0gb3B0aW9uQ2hhaW5zW3VpbnQob3B0aW9uQ2hhaW5JRCldLnBvc2l0aW9uc1t1c2VyXS5jYXNoOwogICAgICAgICAgeisrOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuIChvcHRpb25JRHMsIHN0cmlrZXMsIHBvc2l0aW9ucywgY2FzaGVzKTsKICB9CgogIGZ1bmN0aW9uIGV4cGlyZSh1aW50IGFjY291bnRJRCwgdWludCBvcHRpb25DaGFpbklELCB1aW50OCB2LCBieXRlczMyIHIsIGJ5dGVzMzIgcywgYnl0ZXMzMiB2YWx1ZSkgewogICAgaWYgKG9wdGlvbkNoYWluc1tvcHRpb25DaGFpbklEXS5leHBpcmVkID09IGZhbHNlKSB7CiAgICAgIGlmIChlY3JlY292ZXIoc2hhMyhvcHRpb25DaGFpbnNbb3B0aW9uQ2hhaW5JRF0uZmFjdEhhc2gsIHZhbHVlKSwgdiwgciwgcykgPT0gb3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLmV0aEFkZHIpIHsKICAgICAgICB1aW50IGxhc3RBY2NvdW50ID0gbnVtQWNjb3VudHM7CiAgICAgICAgaWYgKGFjY291bnRJRD09MCkgewogICAgICAgICAgYWNjb3VudElEID0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbGFzdEFjY291bnQgPSBhY2NvdW50SUQ7CiAgICAgICAgfQogICAgICAgIGZvciAoYWNjb3VudElEPWFjY291bnRJRDsgYWNjb3VudElEPD1sYXN0QWNjb3VudDsgYWNjb3VudElEKyspIHsKICAgICAgICAgIGlmIChvcHRpb25DaGFpbnNbb3B0aW9uQ2hhaW5JRF0ucG9zaXRpb25zW2FjY291bnRzW2FjY291bnRJRF0udXNlcl0uZXhwaXJlZCA9PSBmYWxzZSkgewogICAgICAgICAgICBpbnQgcmVzdWx0ID0gb3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLnBvc2l0aW9uc1thY2NvdW50c1thY2NvdW50SURdLnVzZXJdLmNhc2ggLyAxMDAwMDAwMDAwMDAwMDAwMDAwOwogICAgICAgICAgICBmb3IgKHVpbnQgb3B0aW9uSUQ9MDsgb3B0aW9uSUQ8b3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLm51bU9wdGlvbnM7IG9wdGlvbklEKyspIHsKICAgICAgICAgICAgICBpbnQgbW9uZXluZXNzID0gZ2V0TW9uZXluZXNzKG9wdGlvbkNoYWluc1tvcHRpb25DaGFpbklEXS5vcHRpb25zW29wdGlvbklEXS5zdHJpa2UsIHVpbnQodmFsdWUpLCBvcHRpb25DaGFpbnNbb3B0aW9uQ2hhaW5JRF0ubWFyZ2luKTsKICAgICAgICAgICAgICByZXN1bHQgKz0gbW9uZXluZXNzICogb3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLnBvc2l0aW9uc1thY2NvdW50c1thY2NvdW50SURdLnVzZXJdLnBvc2l0aW9uc1tvcHRpb25JRF0gLyAxMDAwMDAwMDAwMDAwMDAwMDAwOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGFjY291bnRzW2FjY291bnRJRF0uY2FwaXRhbCA9IGFjY291bnRzW2FjY291bnRJRF0uY2FwaXRhbCArIHJlc3VsdDsKICAgICAgICAgICAgb3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLnBvc2l0aW9uc1thY2NvdW50c1thY2NvdW50SURdLnVzZXJdLmV4cGlyZWQgPSB0cnVlOwogICAgICAgICAgICBvcHRpb25DaGFpbnNbb3B0aW9uQ2hhaW5JRF0ubnVtUG9zaXRpb25zRXhwaXJlZCsrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAob3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLm51bVBvc2l0aW9uc0V4cGlyZWQgPT0gb3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLm51bVBvc2l0aW9ucykgewogICAgICAgICAgb3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLmV4cGlyZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gZ2V0TW9uZXluZXNzKGludCBzdHJpa2UsIHVpbnQgc2V0dGxlbWVudCwgdWludCBtYXJnaW4pIGNvbnN0YW50IHJldHVybnMoaW50KSB7CiAgICBpZiAoc3RyaWtlPj0wKSB7IC8vY2FsbAogICAgICBpZiAoc2V0dGxlbWVudD51aW50KHN0cmlrZSkpIHsKICAgICAgICBpZiAoc2V0dGxlbWVudC11aW50KHN0cmlrZSk8bWFyZ2luKSB7CiAgICAgICAgICByZXR1cm4gaW50KHNldHRsZW1lbnQtdWludChzdHJpa2UpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIGludChtYXJnaW4pOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gMDsKICAgICAgfQogICAgfSBlbHNlIHsgLy9wdXQKICAgICAgaWYgKHNldHRsZW1lbnQ8dWludCgtc3RyaWtlKSkgewogICAgICAgIGlmICh1aW50KC1zdHJpa2UpLXNldHRsZW1lbnQ8bWFyZ2luKSB7CiAgICAgICAgICByZXR1cm4gaW50KHVpbnQoLXN0cmlrZSktc2V0dGxlbWVudCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBpbnQobWFyZ2luKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGFkZE9wdGlvbkNoYWluKHVpbnQgZXhwaXJhdGlvbiwgc3RyaW5nIHVuZGVybHlpbmcsIHVpbnQgbWFyZ2luLCB1aW50IHJlYWxpdHlJRCwgYnl0ZXMzMiBmYWN0SGFzaCwgYWRkcmVzcyBldGhBZGRyLCBpbnRbXSBzdHJpa2VzKSB7CiAgICB1aW50IG9wdGlvbkNoYWluSUQgPSA2OwogICAgaWYgKG51bU9wdGlvbkNoYWluczw2KSB7CiAgICAgIG9wdGlvbkNoYWluSUQgPSBudW1PcHRpb25DaGFpbnMrKzsKICAgIH0gZWxzZSB7CiAgICAgIGZvciAodWludCBpPTA7IGkgPCBudW1PcHRpb25DaGFpbnMgJiYgb3B0aW9uQ2hhaW5JRD49NjsgaSsrKSB7CiAgICAgICAgaWYgKG9wdGlvbkNoYWluc1tpXS5leHBpcmVkPT10cnVlIHx8IG9wdGlvbkNoYWluc1tpXS5udW1Qb3NpdGlvbnM9PTAgfHwgb3B0aW9uQ2hhaW5zW2ldLm51bU9wdGlvbnM9PTApIHsKICAgICAgICAgIG9wdGlvbkNoYWluSUQgPSBpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgaWYgKG9wdGlvbkNoYWluSUQ8NikgewogICAgICBkZWxldGUgb3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdOwogICAgICBvcHRpb25DaGFpbnNbb3B0aW9uQ2hhaW5JRF0uZXhwaXJhdGlvbiA9IGV4cGlyYXRpb247CiAgICAgIG9wdGlvbkNoYWluc1tvcHRpb25DaGFpbklEXS51bmRlcmx5aW5nID0gdW5kZXJseWluZzsKICAgICAgb3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLm1hcmdpbiA9IG1hcmdpbjsKICAgICAgb3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLnJlYWxpdHlJRCA9IHJlYWxpdHlJRDsKICAgICAgb3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLmZhY3RIYXNoID0gZmFjdEhhc2g7CiAgICAgIG9wdGlvbkNoYWluc1tvcHRpb25DaGFpbklEXS5ldGhBZGRyID0gZXRoQWRkcjsKICAgICAgZm9yIChpPTA7IGkgPCBzdHJpa2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKG9wdGlvbkNoYWluc1tvcHRpb25DaGFpbklEXS5udW1PcHRpb25zPDEwKSB7CiAgICAgICAgICB1aW50IG9wdGlvbklEID0gb3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLm51bU9wdGlvbnMrKzsKICAgICAgICAgIE9wdGlvbiBvcHRpb24gPSBvcHRpb25DaGFpbnNbb3B0aW9uQ2hhaW5JRF0ub3B0aW9uc1tpXTsKICAgICAgICAgIG9wdGlvbi5zdHJpa2UgPSBzdHJpa2VzW2ldOwogICAgICAgICAgb3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLm9wdGlvbnNbaV0gPSBvcHRpb247CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBvcmRlck1hdGNoVGVzdCh1aW50IG9wdGlvbkNoYWluSUQsIHVpbnQgb3B0aW9uSUQsIHVpbnQgcHJpY2UsIGludCBzaXplLCB1aW50IG9yZGVySUQsIHVpbnQgYmxvY2tFeHBpcmVzLCBhZGRyZXNzIGFkZHIsIGFkZHJlc3Mgc2VuZGVyLCBpbnQgbWF0Y2hTaXplKSBjb25zdGFudCByZXR1cm5zKGJvb2wpIHsKICAgIGlmIChibG9jay5udW1iZXI8PWJsb2NrRXhwaXJlcyAmJiAoKHNpemU+MCAmJiBtYXRjaFNpemU8MCAmJiBvcmRlckZpbGxzW3NoYTMob3B0aW9uQ2hhaW5JRCwgb3B0aW9uSUQsIHByaWNlLCBzaXplLCBvcmRlcklELCBibG9ja0V4cGlyZXMpXS1tYXRjaFNpemU8PXNpemUpIHx8IChzaXplPDAgJiYgbWF0Y2hTaXplPjAgJiYgb3JkZXJGaWxsc1tzaGEzKG9wdGlvbkNoYWluSUQsIG9wdGlvbklELCBwcmljZSwgc2l6ZSwgb3JkZXJJRCwgYmxvY2tFeHBpcmVzKV0tbWF0Y2hTaXplPj1zaXplKSkgJiYgZ2V0RnVuZHMoYWRkciwgZmFsc2UpK2dldE1heExvc3NBZnRlclRyYWRlKGFkZHIsIG9wdGlvbkNoYWluSUQsIG9wdGlvbklELCAtbWF0Y2hTaXplLCBtYXRjaFNpemUgKiBpbnQocHJpY2UpKT4wICYmIGdldEZ1bmRzKHNlbmRlciwgZmFsc2UpK2dldE1heExvc3NBZnRlclRyYWRlKHNlbmRlciwgb3B0aW9uQ2hhaW5JRCwgb3B0aW9uSUQsIG1hdGNoU2l6ZSwgLW1hdGNoU2l6ZSAqIGludChwcmljZSkpPjApIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBmdW5jdGlvbiBvcmRlck1hdGNoKHVpbnQgb3B0aW9uQ2hhaW5JRCwgdWludCBvcHRpb25JRCwgdWludCBwcmljZSwgaW50IHNpemUsIHVpbnQgb3JkZXJJRCwgdWludCBibG9ja0V4cGlyZXMsIGFkZHJlc3MgYWRkciwgdWludDggdiwgYnl0ZXMzMiByLCBieXRlczMyIHMsIGludCBtYXRjaFNpemUpIHsKICAgIGJ5dGVzMzIgaGFzaCA9IHNoYTI1NihvcHRpb25DaGFpbklELCBvcHRpb25JRCwgcHJpY2UsIHNpemUsIG9yZGVySUQsIGJsb2NrRXhwaXJlcyk7CiAgICBpZiAoZWNyZWNvdmVyKGhhc2gsIHYsIHIsIHMpID09IGFkZHIgJiYgYmxvY2subnVtYmVyPD1ibG9ja0V4cGlyZXMgJiYgKChzaXplPjAgJiYgbWF0Y2hTaXplPDAgJiYgb3JkZXJGaWxsc1toYXNoXS1tYXRjaFNpemU8PXNpemUpIHx8IChzaXplPDAgJiYgbWF0Y2hTaXplPjAgJiYgb3JkZXJGaWxsc1toYXNoXS1tYXRjaFNpemU+PXNpemUpKSAmJiBnZXRGdW5kcyhhZGRyLCBmYWxzZSkrZ2V0TWF4TG9zc0FmdGVyVHJhZGUoYWRkciwgb3B0aW9uQ2hhaW5JRCwgb3B0aW9uSUQsIC1tYXRjaFNpemUsIG1hdGNoU2l6ZSAqIGludChwcmljZSkpPjAgJiYgZ2V0RnVuZHMobXNnLnNlbmRlciwgZmFsc2UpK2dldE1heExvc3NBZnRlclRyYWRlKG1zZy5zZW5kZXIsIG9wdGlvbkNoYWluSUQsIG9wdGlvbklELCBtYXRjaFNpemUsIC1tYXRjaFNpemUgKiBpbnQocHJpY2UpKT4wKSB7CiAgICAgIGlmIChvcHRpb25DaGFpbnNbb3B0aW9uQ2hhaW5JRF0ucG9zaXRpb25zW21zZy5zZW5kZXJdLmhhc1Bvc2l0aW9uID09IGZhbHNlKSB7CiAgICAgICAgb3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLnBvc2l0aW9uc1ttc2cuc2VuZGVyXS5oYXNQb3NpdGlvbiA9IHRydWU7CiAgICAgICAgb3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLm51bVBvc2l0aW9ucysrOwogICAgICB9CiAgICAgIGlmIChvcHRpb25DaGFpbnNbb3B0aW9uQ2hhaW5JRF0ucG9zaXRpb25zW2FkZHJdLmhhc1Bvc2l0aW9uID09IGZhbHNlKSB7CiAgICAgICAgb3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLnBvc2l0aW9uc1thZGRyXS5oYXNQb3NpdGlvbiA9IHRydWU7CiAgICAgICAgb3B0aW9uQ2hhaW5zW29wdGlvbkNoYWluSURdLm51bVBvc2l0aW9ucysrOwogICAgICB9CiAgICAgIG9wdGlvbkNoYWluc1tvcHRpb25DaGFpbklEXS5wb3NpdGlvbnNbbXNnLnNlbmRlcl0ucG9zaXRpb25zW29wdGlvbklEXSArPSBtYXRjaFNpemU7CiAgICAgIG9wdGlvbkNoYWluc1tvcHRpb25DaGFpbklEXS5wb3NpdGlvbnNbbXNnLnNlbmRlcl0uY2FzaCAtPSBtYXRjaFNpemUgKiBpbnQocHJpY2UpOwogICAgICBvcHRpb25DaGFpbnNbb3B0aW9uQ2hhaW5JRF0ucG9zaXRpb25zW2FkZHJdLnBvc2l0aW9uc1tvcHRpb25JRF0gLT0gbWF0Y2hTaXplOwogICAgICBvcHRpb25DaGFpbnNbb3B0aW9uQ2hhaW5JRF0ucG9zaXRpb25zW2FkZHJdLmNhc2ggKz0gbWF0Y2hTaXplICogaW50KHByaWNlKTsKICAgICAgb3JkZXJGaWxsc1toYXNoXSAtPSBtYXRjaFNpemU7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBnZXRNYXhMb3NzQWZ0ZXJUcmFkZShhZGRyZXNzIHVzZXIsIHVpbnQgb3B0aW9uQ2hhaW5JRCwgdWludCBvcHRpb25JRCwgaW50IHBvc2l0aW9uQ2hhbmdlLCBpbnQgY2FzaENoYW5nZSkgY29uc3RhbnQgcmV0dXJucyhpbnQpIHsKICAgIGludCB0b3RhbE1heExvc3MgPSAwOwogICAgZm9yICh1aW50IGk9MDsgaTxudW1PcHRpb25DaGFpbnM7IGkrKykgewogICAgICBpZiAob3B0aW9uQ2hhaW5zW2ldLnBvc2l0aW9uc1t1c2VyXS5leHBpcmVkID09IGZhbHNlICYmIG9wdGlvbkNoYWluc1tpXS5udW1PcHRpb25zPjApIHsKICAgICAgICBib29sIG1heExvc3NJbml0aWFsaXplZCA9IGZhbHNlOwogICAgICAgIGludCBtYXhMb3NzID0gMDsKICAgICAgICBmb3IgKHVpbnQgcz0wOyBzPG9wdGlvbkNoYWluc1tpXS5udW1PcHRpb25zOyBzKyspIHsKICAgICAgICAgIGludCBwbmwgPSBvcHRpb25DaGFpbnNbaV0ucG9zaXRpb25zW3VzZXJdLmNhc2ggLyAxMDAwMDAwMDAwMDAwMDAwMDAwOwogICAgICAgICAgaWYgKGk9PW9wdGlvbkNoYWluSUQpIHsKICAgICAgICAgICAgcG5sICs9IGNhc2hDaGFuZ2UgLyAxMDAwMDAwMDAwMDAwMDAwMDAwOwogICAgICAgICAgfQogICAgICAgICAgdWludCBzZXR0bGVtZW50ID0gMDsKICAgICAgICAgIGlmIChvcHRpb25DaGFpbnNbaV0ub3B0aW9uc1tzXS5zdHJpa2U8MCkgewogICAgICAgICAgICBzZXR0bGVtZW50ID0gdWludCgtb3B0aW9uQ2hhaW5zW2ldLm9wdGlvbnNbc10uc3RyaWtlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNldHRsZW1lbnQgPSB1aW50KG9wdGlvbkNoYWluc1tpXS5vcHRpb25zW3NdLnN0cmlrZSk7CiAgICAgICAgICB9CiAgICAgICAgICBwbmwgKz0gbW9uZXlTdW1BdFNldHRsZW1lbnQodXNlciwgb3B0aW9uQ2hhaW5JRCwgb3B0aW9uSUQsIHBvc2l0aW9uQ2hhbmdlLCBpLCBzZXR0bGVtZW50KTsKICAgICAgICAgIGlmIChwbmw8bWF4TG9zcyB8fCBtYXhMb3NzSW5pdGlhbGl6ZWQ9PWZhbHNlKSB7CiAgICAgICAgICAgIG1heExvc3NJbml0aWFsaXplZCA9IHRydWU7CiAgICAgICAgICAgIG1heExvc3MgPSBwbmw7CiAgICAgICAgICB9CiAgICAgICAgICBwbmwgPSBvcHRpb25DaGFpbnNbaV0ucG9zaXRpb25zW3VzZXJdLmNhc2ggLyAxMDAwMDAwMDAwMDAwMDAwMDAwOwogICAgICAgICAgaWYgKGk9PW9wdGlvbkNoYWluSUQpIHsKICAgICAgICAgICAgcG5sICs9IGNhc2hDaGFuZ2UgLyAxMDAwMDAwMDAwMDAwMDAwMDAwOwogICAgICAgICAgfQogICAgICAgICAgc2V0dGxlbWVudCA9IDA7CiAgICAgICAgICBpZiAob3B0aW9uQ2hhaW5zW2ldLm9wdGlvbnNbc10uc3RyaWtlPDApIHsKICAgICAgICAgICAgaWYgKHVpbnQoLW9wdGlvbkNoYWluc1tpXS5vcHRpb25zW3NdLnN0cmlrZSk+b3B0aW9uQ2hhaW5zW2ldLm1hcmdpbikgewogICAgICAgICAgICAgIHNldHRsZW1lbnQgPSB1aW50KC1vcHRpb25DaGFpbnNbaV0ub3B0aW9uc1tzXS5zdHJpa2UpLW9wdGlvbkNoYWluc1tpXS5tYXJnaW47CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgc2V0dGxlbWVudCA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNldHRsZW1lbnQgPSB1aW50KG9wdGlvbkNoYWluc1tpXS5vcHRpb25zW3NdLnN0cmlrZSkrb3B0aW9uQ2hhaW5zW2ldLm1hcmdpbjsKICAgICAgICAgIH0KICAgICAgICAgIHBubCArPSBtb25leVN1bUF0U2V0dGxlbWVudCh1c2VyLCBvcHRpb25DaGFpbklELCBvcHRpb25JRCwgcG9zaXRpb25DaGFuZ2UsIGksIHNldHRsZW1lbnQpOwogICAgICAgICAgaWYgKHBubDxtYXhMb3NzKSB7CiAgICAgICAgICAgIG1heExvc3MgPSBwbmw7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHRvdGFsTWF4TG9zcyArPSBtYXhMb3NzOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gdG90YWxNYXhMb3NzOwogIH0KCiAgZnVuY3Rpb24gbW9uZXlTdW1BdFNldHRsZW1lbnQoYWRkcmVzcyB1c2VyLCB1aW50IG9wdGlvbkNoYWluSUQsIHVpbnQgb3B0aW9uSUQsIGludCBwb3NpdGlvbkNoYW5nZSwgdWludCBpLCB1aW50IHNldHRsZW1lbnQpIGludGVybmFsIHJldHVybnMoaW50KSB7CiAgICBpbnQgcG5sID0gMDsKICAgIGZvciAodWludCBqPTA7IGo8b3B0aW9uQ2hhaW5zW2ldLm51bU9wdGlvbnM7IGorKykgewogICAgICBwbmwgKz0gb3B0aW9uQ2hhaW5zW2ldLnBvc2l0aW9uc1t1c2VyXS5wb3NpdGlvbnNbal0gKiBnZXRNb25leW5lc3Mob3B0aW9uQ2hhaW5zW2ldLm9wdGlvbnNbal0uc3RyaWtlLCBzZXR0bGVtZW50LCBvcHRpb25DaGFpbnNbaV0ubWFyZ2luKSAvIDEwMDAwMDAwMDAwMDAwMDAwMDA7CiAgICAgIGlmIChpPT1vcHRpb25DaGFpbklEICYmIGo9PW9wdGlvbklEKSB7CiAgICAgICAgcG5sICs9IHBvc2l0aW9uQ2hhbmdlICogZ2V0TW9uZXluZXNzKG9wdGlvbkNoYWluc1tpXS5vcHRpb25zW2pdLnN0cmlrZSwgc2V0dGxlbWVudCwgb3B0aW9uQ2hhaW5zW2ldLm1hcmdpbikgLyAxMDAwMDAwMDAwMDAwMDAwMDAwOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gcG5sOwogIH0KCiAgZnVuY3Rpb24gbWluKHVpbnQgYSwgdWludCBiKSBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsKICAgIGlmIChhPGIpIHsKICAgICAgcmV0dXJuIGE7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gYjsKICAgIH0KICB9Cn0='.
	

]
