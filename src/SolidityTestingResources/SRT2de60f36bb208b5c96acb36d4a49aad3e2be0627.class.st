Class {
	#name : #SRT2de60f36bb208b5c96acb36d4a49aad3e2be0627,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT2de60f36bb208b5c96acb36d4a49aad3e2be0627 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgewogIGV2ZW50IFBhdXNlKCk7CiAgZXZlbnQgVW5wYXVzZSgpOwoKICBib29sIHB1YmxpYyBwYXVzZWQgPSBmYWxzZTsKCgogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgbm90IHBhdXNlZC4KICAgKi8KICBtb2RpZmllciB3aGVuTm90UGF1c2VkKCkgewogICAgcmVxdWlyZSghcGF1c2VkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIHBhdXNlZC4KICAgKi8KICBtb2RpZmllciB3aGVuUGF1c2VkKCkgewogICAgcmVxdWlyZShwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byBwYXVzZSwgdHJpZ2dlcnMgc3RvcHBlZCBzdGF0ZQogICAqLwogIGZ1bmN0aW9uIHBhdXNlKCkgb25seU93bmVyIHdoZW5Ob3RQYXVzZWQgcHVibGljIHsKICAgIHBhdXNlZCA9IHRydWU7CiAgICBQYXVzZSgpOwogIH0KCiAgLyoqCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHVucGF1c2UsIHJldHVybnMgdG8gbm9ybWFsIHN0YXRlCiAgICovCiAgZnVuY3Rpb24gdW5wYXVzZSgpIG9ubHlPd25lciB3aGVuUGF1c2VkIHB1YmxpYyB7CiAgICBwYXVzZWQgPSBmYWxzZTsKICAgIFVucGF1c2UoKTsKICB9Cn0KCmNvbnRyYWN0IEdKQ0lDTyBpcyBQYXVzYWJsZXsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgLy9HYXMvR1dlaQogIHVpbnQgY29uc3RhbnQgcHVibGljIG1pbkNvbnRyaWJBbW91bnQgPSAwLjAxIGV0aGVyOwoKICAvLyBUaGUgdG9rZW4gYmVpbmcgc29sZAogIEdKQ1Rva2VuIHB1YmxpYyB0b2tlbjsKICB1aW50MjU2IGNvbnN0YW50IHB1YmxpYyB0b2tlbkRlY2ltYWxzID0gMTg7CgogIC8vIFRoZSB2ZXN0aW5nIGNvbnRyYWN0CiAgVG9rZW5WZXN0aW5nIHB1YmxpYyB2ZXN0aW5nOwogIHVpbnQyNTYgY29uc3RhbnQgcHVibGljIFZFU1RJTkdfVElNRVMgPSA0OwogIHVpbnQyNTYgY29uc3RhbnQgcHVibGljIERVUkFUSU9OX1BFUl9WRVNUSU5HID0gNTIgd2Vla3M7CgogIC8vIHN0YXJ0IGFuZCBlbmQgdGltZXN0YW1wcyB3aGVyZSBpbnZlc3RtZW50cyBhcmUgYWxsb3dlZCAoYm90aCBpbmNsdXNpdmUpCiAgdWludDI1NiBwdWJsaWMgc3RhcnRUaW1lOwogIHVpbnQyNTYgcHVibGljIGVuZFRpbWU7CgogIC8vIG5lZWQgdG8gYmUgZW5hYmxlZCB0byBhbGxvdyBpbnZlc3RvciB0byBwYXJ0aWNpcGF0ZSBpbiB0aGUgaWNvCiAgYm9vbCBwdWJsaWMgaWNvRW5hYmxlZDsKCiAgLy8gYWRkcmVzcyB3aGVyZSBmdW5kcyBhcmUgY29sbGVjdGVkCiAgYWRkcmVzcyBwdWJsaWMgbXVsdGlzaWduV2FsbGV0OwoKICAvLyBhbW91bnQgb2YgcmFpc2VkIG1vbmV5IGluIHdlaQogIHVpbnQyNTYgcHVibGljIHdlaVJhaXNlZDsKCiAgLy8gdG90YWxTdXBwbHkKICB1aW50MjU2IGNvbnN0YW50IHB1YmxpYyB0b3RhbFN1cHBseSA9IDEwMDAwMDAwMCAqICgxMCAqKiB0b2tlbkRlY2ltYWxzKTsKICAvL3ByZSBzYWxlIGNhcAogIHVpbnQyNTYgY29uc3RhbnQgcHVibGljIHByZVNhbGVDYXAgPSAxMDAwMDAwMCAqICgxMCAqKiB0b2tlbkRlY2ltYWxzKTsKICAvL3NhbGUgY2FwCiAgdWludDI1NiBjb25zdGFudCBwdWJsaWMgaW5pdGlhbElDT0NhcCA9IDYwMDAwMDAwICogKDEwICoqIHRva2VuRGVjaW1hbHMpOwogIC8vZm91bmRlciBzaGFyZQogIHVpbnQyNTYgY29uc3RhbnQgcHVibGljIHRva2Vuc0ZvckZvdW5kZXIgPSAxMDAwMDAwMCAqICgxMCAqKiB0b2tlbkRlY2ltYWxzKTsKICAvL2RldiB0ZWFtIHNoYXJlCiAgdWludDI1NiBjb25zdGFudCBwdWJsaWMgdG9rZW5zRm9yRGV2dGVhbSA9IDEwMDAwMDAwICogKDEwICoqIHRva2VuRGVjaW1hbHMpOwogIC8vUGFydG5lcnMgc2hhcmUKICB1aW50MjU2IGNvbnN0YW50IHB1YmxpYyB0b2tlbnNGb3JQYXJ0bmVycyA9IDUwMDAwMDAgKiAoMTAgKiogdG9rZW5EZWNpbWFscyk7CiAgLy9DaGFyaXR5IHNoYXJlCiAgdWludDI1NiBjb25zdGFudCBwdWJsaWMgdG9rZW5zRm9yQ2hhcml0eSA9IDMwMDAwMDAgKiAoMTAgKiogdG9rZW5EZWNpbWFscyk7CiAgLy9Cb3VudHkgc2hhcmUKICB1aW50MjU2IGNvbnN0YW50IHB1YmxpYyB0b2tlbnNGb3JCb3VudHkgPSAyMDAwMDAwICogKDEwICoqIHRva2VuRGVjaW1hbHMpOwogICAgCiAgLy9Tb2xkIHByZXNhbGUgdG9rZW5zCiAgdWludDI1NiBwdWJsaWMgc29sZFByZVNhbGVUb2tlbnM7IAogIHVpbnQyNTYgcHVibGljIHNlbnRQcmVTYWxlVG9rZW5zOwoKICAvL0lDTyB0b2tlbnMKICAvL0lzIGNhbGNsdWF0ZWQgYXM6IGluaXRpYWxJQ09DYXAgKyBwcmVTYWxlQ2FwIC0gc29sZFByZVNhbGVUb2tlbnMKICB1aW50MjU2IHB1YmxpYyBpY29DYXA7IAogIHVpbnQyNTYgcHVibGljIGljb1NvbGRUb2tlbnM7IAogIGJvb2wgcHVibGljIGljb0VuZGVkID0gZmFsc2U7CgogIC8vU2FsZSByYXRlcwogIHVpbnQyNTYgY29uc3RhbnQgcHVibGljIFJBVEVfRk9SX1dFRUsxID0gNTI1OwogIHVpbnQyNTYgY29uc3RhbnQgcHVibGljIFJBVEVfRk9SX1dFRUsyID0gNDU1OwogIHVpbnQyNTYgY29uc3RhbnQgcHVibGljIFJBVEVfRk9SX1dFRUszID0gNDIwOwogIHVpbnQyNTYgY29uc3RhbnQgcHVibGljIFJBVEVfTk9fRElTQ09VTlQgPSAzNTA7CgoKICAvKioKICAgKiBldmVudCBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAqIEBwYXJhbSBwdXJjaGFzZXIgd2hvIHBhaWQgZm9yIHRoZSB0b2tlbnMKICAgKiBAcGFyYW0gYmVuZWZpY2lhcnkgd2hvIGdvdCB0aGUgdG9rZW5zCiAgICogQHBhcmFtIHZhbHVlIHdlaXMgcGFpZCBmb3IgcHVyY2hhc2UKICAgKiBAcGFyYW0gYW1vdW50IGFtb3VudCBvZiB0b2tlbnMgcHVyY2hhc2VkCiAgICovIAogIGV2ZW50IFRva2VuUHVyY2hhc2UoYWRkcmVzcyBpbmRleGVkIHB1cmNoYXNlciwgYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IGFtb3VudCk7CgoKICBmdW5jdGlvbiBHSkNJQ08oYWRkcmVzcyBfbXVsdGlzaWduV2FsbGV0KSB7CiAgICByZXF1aXJlKF9tdWx0aXNpZ25XYWxsZXQgIT0gYWRkcmVzcygwKSk7CiAgICB0b2tlbiA9IGNyZWF0ZVRva2VuQ29udHJhY3QoKTsKICAgIC8vc2VuZCBhbGwgZGFvIHRva2VucyB0byBtdWx0aXdhbGxldAogICAgdWludDI1NiB0b2tlbnNUb0RhbyA9IHRva2Vuc0ZvckRldnRlYW0uYWRkKHRva2Vuc0ZvclBhcnRuZXJzKS5hZGQodG9rZW5zRm9yQm91bnR5KS5hZGQodG9rZW5zRm9yQ2hhcml0eSk7CiAgICBtdWx0aXNpZ25XYWxsZXQgPSBfbXVsdGlzaWduV2FsbGV0OwogICAgdG9rZW4udHJhbnNmZXIobXVsdGlzaWduV2FsbGV0LCB0b2tlbnNUb0Rhbyk7CiAgfQoKICBmdW5jdGlvbiBjcmVhdGVWZXN0aW5nRm9yRm91bmRlcihhZGRyZXNzIGZvdW5kZXJBZGRyZXNzKSBleHRlcm5hbCBvbmx5T3duZXIoKXsKICAgIHJlcXVpcmUoZm91bmRlckFkZHJlc3MgIT0gYWRkcmVzcygwKSk7CiAgICAvL2NyZWF0ZSBvbmx5IG9uY2UKICAgIHJlcXVpcmUoYWRkcmVzcyh2ZXN0aW5nKSA9PSBhZGRyZXNzKDApKTsKICAgIHZlc3RpbmcgPSBjcmVhdGVUb2tlblZlc3RpbmdDb250cmFjdChhZGRyZXNzKHRva2VuKSk7CiAgICAvLyBjcmVhdGUgdmVzdGluZyBzY2hlbWEgZm9yIGZvdW5kZXJzIGZyb20gbm93LCB0b3RhbCB0b2tlbiBhbW91bnQgaXMgZGl2aWRlZCBpbiA0IHBlcmlvZHMgb2YgMTIgbW9udGhzIGVhY2gKICAgIHZlc3RpbmcuY3JlYXRlVmVzdGluZ0J5RHVyYXRpb25BbmRTcGxpdHMoZm91bmRlckFkZHJlc3MsIHRva2Vuc0ZvckZvdW5kZXIsIG5vdywgRFVSQVRJT05fUEVSX1ZFU1RJTkcsIFZFU1RJTkdfVElNRVMpOwogICAgLy9zZW5kIHRva2VucyB0byB2ZXN0aW5nIGNvbnRyYWN0cwogICAgdG9rZW4udHJhbnNmZXIoYWRkcmVzcyh2ZXN0aW5nKSwgdG9rZW5zRm9yRm91bmRlcik7CiAgfQoKICAvLwogIC8vIFRva2VuIHJlbGF0ZWQgb3BlcmF0aW9ucwogIC8vCgogIC8vIGNyZWF0ZXMgdGhlIHRva2VuIHRvIGJlIHNvbGQuIAogIAogIGZ1bmN0aW9uIGNyZWF0ZVRva2VuQ29udHJhY3QoKSBpbnRlcm5hbCByZXR1cm5zIChHSkNUb2tlbikgewogICAgcmV0dXJuIG5ldyBHSkNUb2tlbigpOwogIH0KCiAgLy8gY3JlYXRlcyB0aGUgdG9rZW4gdG8gYmUgc29sZC4KICAvLyBvdmVycmlkZSB0aGlzIG1ldGhvZCB0byBoYXZlIGNyb3dkc2FsZSBvZiBhIHNwZWNpZmljIG1pbnRhYmxlIHRva2VuLgogIGZ1bmN0aW9uIGNyZWF0ZVRva2VuVmVzdGluZ0NvbnRyYWN0KGFkZHJlc3MgdG9rZW5BZGRyZXNzKSBpbnRlcm5hbCByZXR1cm5zIChUb2tlblZlc3RpbmcpIHsKICAgIHJlcXVpcmUoYWRkcmVzcyh0b2tlbikgIT0gYWRkcmVzcygwKSk7CiAgICByZXR1cm4gbmV3IFRva2VuVmVzdGluZyh0b2tlbkFkZHJlc3MpOwogIH0KCgogIC8vIGVuYWJsZSB0b2tlbiB0cmFuZmVyYWJpbGl0eQogIGZ1bmN0aW9uIGVuYWJsZVRva2VuVHJhbnNmZXJhYmlsaXR5KCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIHJlcXVpcmUodG9rZW4gIT0gYWRkcmVzcygwKSk7CiAgICB0b2tlbi51bnBhdXNlKCk7IAogIH0KCiAgLy8gZGlzYWJsZSB0b2tlbiB0cmFuZmVyYWJpbGl0eQogIGZ1bmN0aW9uIGRpc2FibGVUb2tlblRyYW5zZmVyYWJpbGl0eSgpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICByZXF1aXJlKHRva2VuICE9IGFkZHJlc3MoMCkpOwogICAgdG9rZW4ucGF1c2UoKTsgCiAgfQoKCiAgLy8KICAvLyBQcmVzYWxlIHJlbGF0ZWQgb3BlcmF0aW9ucwogIC8vCgogIC8vIHNldCB0b3RhbCBwcmUgc2FsZSBzb2xkIHRva2VuCiAgLy8gY2FuIG5vdCBiZSBjaGFuZ2VkIG9uY2UgdGhlIGljbyBpcyBlbmFibGVkCiAgLy8gSWNvIGNhcCBpcyBkZXRlcm1pbmVkIGJ5IFNhbGVDYXAgKyBQcmVTYWxlQ2FwIC0gc29sZFByZVNhbGVUb2tlbnMgCiAgZnVuY3Rpb24gc2V0U29sZFByZVNhbGVUb2tlbnModWludDI1NiBfc29sZFByZVNhbGVUb2tlbnMpIGV4dGVybmFsIG9ubHlPd25lcnsKICAgIHJlcXVpcmUoIWljb0VuYWJsZWQpOwogICAgcmVxdWlyZShfc29sZFByZVNhbGVUb2tlbnMgPD0gcHJlU2FsZUNhcCk7CiAgICBzb2xkUHJlU2FsZVRva2VucyA9IF9zb2xkUHJlU2FsZVRva2VuczsKICB9CgogIC8vIHRyYW5zZmVyIHByZSBzYWxlIHRva2VuZCB0byBpbnZlc3RvcnMKICAvLyBzb2xkUHJlU2FsZVRva2VucyBuZWVkIHRvIGJlIHNldCBiZWZvcmVoYW5kLCBhbmQgYmlnZ2VyIHRoYW4gMAogIC8vIHRoZSB0b3RhbCBhbW91bnQgdG8gdHJhbmZlcmVkIG5lZWQgdG8gYmUgbGVzcyBvciBlcXVhbCB0byBzb2xkUHJlU2FsZVRva2VucyAKICBmdW5jdGlvbiB0cmFuc2ZlclByZVNhbGVUb2tlbnModWludDI1NiB0b2tlbnMsIGFkZHJlc3MgYmVuZWZpY2lhcnkpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICByZXF1aXJlKGJlbmVmaWNpYXJ5ICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShzb2xkUHJlU2FsZVRva2VucyA+IDApOwogICAgdWludDI1NiBuZXdTZW50UHJlU2FsZVRva2VucyA9IHNlbnRQcmVTYWxlVG9rZW5zLmFkZCh0b2tlbnMpOwogICAgcmVxdWlyZShuZXdTZW50UHJlU2FsZVRva2VucyA8PSBzb2xkUHJlU2FsZVRva2Vucyk7CiAgICBzZW50UHJlU2FsZVRva2VucyA9IG5ld1NlbnRQcmVTYWxlVG9rZW5zOwogICAgdG9rZW4udHJhbnNmZXIoYmVuZWZpY2lhcnksIHRva2Vucyk7CiAgfQoKCiAgLy8KICAvLyBJQ08gcmVsYXRlZCBvcGVyYXRpb25zCiAgLy8KCiAgLy8gc2V0IG11bHRpc2lnbiB3YWxsZXQKICBmdW5jdGlvbiBzZXRNdWx0aXNpZ25XYWxsZXQoYWRkcmVzcyBfbXVsdGlzaWduV2FsbGV0KSBleHRlcm5hbCBvbmx5T3duZXJ7CiAgICAvLyBuZWVkIHRvIGJlIHNldCBiZWZvcmUgdGhlIGljbyBzdGFydAogICAgcmVxdWlyZSghaWNvRW5hYmxlZCB8fCBub3cgPCBzdGFydFRpbWUpOwogICAgcmVxdWlyZShfbXVsdGlzaWduV2FsbGV0ICE9IGFkZHJlc3MoMCkpOwogICAgbXVsdGlzaWduV2FsbGV0ID0gX211bHRpc2lnbldhbGxldDsKICB9CgogIC8vIGRlbGVnYXRlIHZlc3RpbmcgY29udHJhY3Qgb3duZXIKICBmdW5jdGlvbiBkZWxlZ2F0ZVZlc3RpbmdDb250cmFjdE93bmVyKGFkZHJlc3MgbmV3T3duZXIpIGV4dGVybmFsIG9ubHlPd25lcnsKICAgIHZlc3RpbmcudHJhbnNmZXJPd25lcnNoaXAobmV3T3duZXIpOwogIH0KCiAgLy8gc2V0IGNvbnRyaWJ1dGlvbiBkYXRlcwogIGZ1bmN0aW9uIHNldENvbnRyaWJ1dGlvbkRhdGVzKHVpbnQyNTYgX3N0YXJ0VGltZSwgdWludDI1NiBfZW5kVGltZSkgZXh0ZXJuYWwgb25seU93bmVyewogICAgcmVxdWlyZSghaWNvRW5hYmxlZCk7CiAgICByZXF1aXJlKF9zdGFydFRpbWUgPj0gbm93KTsKICAgIHJlcXVpcmUoX2VuZFRpbWUgPj0gX3N0YXJ0VGltZSk7CiAgICBzdGFydFRpbWUgPSBfc3RhcnRUaW1lOwogICAgZW5kVGltZSA9IF9lbmRUaW1lOwogIH0KCiAgLy8gZW5hYmxlIElDTywgbmVlZCB0byBiZSB0cnVlIHRvIGFjdHVhbGx5IHN0YXJ0IGljbwogIC8vIG11bHRpc2lnbiB3YWxsZXQgbmVlZCB0byBiZSBzZXQsIGJlY2F1c2Ugb25jZSBpY28gc3RhcnRlZCwgaW52ZXN0ZWQgZnVuZHMgaXMgdHJhbnNmZXJlZCB0byB0aGlzIGFkZHJlc3MKICAvLyBvbmNlIGljbyBpcyBlbmFibGVkLCBmb2xsb3dpbmcgcGFyYW1ldGVycyBjYW4gbm90IGJlIGNoYW5nZWQgYW55bW9yZToKICAvLyBzdGFydFRpbWUsIGVuZFRpbWUsIHNvbGRQcmVTYWxlVG9rZW5zCiAgZnVuY3Rpb24gZW5hYmxlSUNPKCkgZXh0ZXJuYWwgb25seU93bmVyewogICAgcmVxdWlyZShzdGFydFRpbWUgPj0gbm93KTsKCiAgICByZXF1aXJlKG11bHRpc2lnbldhbGxldCAhPSBhZGRyZXNzKDApKTsKICAgIGljb0VuYWJsZWQgPSB0cnVlOwogICAgaWNvQ2FwID0gaW5pdGlhbElDT0NhcC5hZGQocHJlU2FsZUNhcCkuc3ViKHNvbGRQcmVTYWxlVG9rZW5zKTsKICB9CgoKICAvLyBmYWxsYmFjayBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBidXkgdG9rZW5zCiAgZnVuY3Rpb24gKCkgcGF5YWJsZSB3aGVuTm90UGF1c2VkIHsKICAgIGJ1eVRva2Vucyhtc2cuc2VuZGVyKTsKICB9CgogIC8vIGxvdyBsZXZlbCB0b2tlbiBwdXJjaGFzZSBmdW5jdGlvbgogIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgcGF5YWJsZSB3aGVuTm90UGF1c2VkIHsKICAgIHJlcXVpcmUoYmVuZWZpY2lhcnkgIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKHZhbGlkUHVyY2hhc2UoKSk7CgogICAgdWludDI1NiB3ZWlBbW91bnQgPSBtc2cudmFsdWU7CiAgICB1aW50MjU2IHJldHVybldlaUFtb3VudDsKCiAgICAvLyBjYWxjdWxhdGUgdG9rZW4gYW1vdW50IHRvIGJlIGNyZWF0ZWQKICAgIHVpbnQgcmF0ZSA9IGdldFJhdGUoKTsKICAgIGFzc2VydChyYXRlID4gMCk7CiAgICB1aW50MjU2IHRva2VucyA9IHdlaUFtb3VudC5tdWwocmF0ZSk7CgogICAgdWludDI1NiBuZXdJY29Tb2xkVG9rZW5zID0gaWNvU29sZFRva2Vucy5hZGQodG9rZW5zKTsKCiAgICBpZiAobmV3SWNvU29sZFRva2VucyA+IGljb0NhcCkgewogICAgICAgIG5ld0ljb1NvbGRUb2tlbnMgPSBpY29DYXA7CiAgICAgICAgdG9rZW5zID0gaWNvQ2FwLnN1YihpY29Tb2xkVG9rZW5zKTsKICAgICAgICB1aW50MjU2IG5ld1dlaUFtb3VudCA9IHRva2Vucy5kaXYocmF0ZSk7CiAgICAgICAgcmV0dXJuV2VpQW1vdW50ID0gd2VpQW1vdW50LnN1YihuZXdXZWlBbW91bnQpOwogICAgICAgIHdlaUFtb3VudCA9IG5ld1dlaUFtb3VudDsKICAgIH0KCiAgICAvLyB1cGRhdGUgc3RhdGUKICAgIHdlaVJhaXNlZCA9IHdlaVJhaXNlZC5hZGQod2VpQW1vdW50KTsKCiAgICB0b2tlbi50cmFuc2ZlcihiZW5lZmljaWFyeSwgdG9rZW5zKTsKICAgIGljb1NvbGRUb2tlbnMgPSBuZXdJY29Tb2xkVG9rZW5zOwogICAgaWYgKHJldHVybldlaUFtb3VudCA+IDApewogICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIocmV0dXJuV2VpQW1vdW50KTsKICAgIH0KCiAgICBUb2tlblB1cmNoYXNlKG1zZy5zZW5kZXIsIGJlbmVmaWNpYXJ5LCB3ZWlBbW91bnQsIHRva2Vucyk7CgogICAgZm9yd2FyZEZ1bmRzKCk7CiAgfQoKICAvLyBzZW5kIGV0aGVyIHRvIHRoZSBmdW5kIGNvbGxlY3Rpb24gd2FsbGV0CiAgCiAgZnVuY3Rpb24gZm9yd2FyZEZ1bmRzKCkgaW50ZXJuYWwgewogICAgbXVsdGlzaWduV2FsbGV0LnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgfQoKICAvLyB1bnNvbGQgaWNvIHRva2VucyB0cmFuc2ZlciBhdXRvbWF0aWNhbGx5IGluIGVuZEljbwogIC8vIGZ1bmN0aW9uIHRyYW5zZmVyVW5zb2xkSWNvVG9rZW5zKCkgb25seU93bmVyIHsKICAvLyByZXF1aXJlKGhhc0VuZGVkKCkpOwogIC8vIHJlcXVpcmUoaWNvU29sZFRva2VucyA8IGljb0NhcCk7CiAgLy8gdWludDI1NiB1bnNvbGRUb2tlbnMgPSBpY29DYXAuc3ViKGljb1NvbGRUb2tlbnMpOwogIC8vIHRva2VuLnRyYW5zZmVyKG11bHRpc2lnbldhbGxldCwgdW5zb2xkVG9rZW5zKTsKICAvL30KCiAgLy8gQHJldHVybiB0cnVlIGlmIHRoZSB0cmFuc2FjdGlvbiBjYW4gYnV5IHRva2VucwogIGZ1bmN0aW9uIHZhbGlkUHVyY2hhc2UoKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICBib29sIHdpdGhpblBlcmlvZCA9IG5vdyA+PSBzdGFydFRpbWUgJiYgbm93IDw9IGVuZFRpbWU7CiAgICBib29sIG5vbk1pbmltdW1QdXJjaGFzZSA9IG1zZy52YWx1ZSA+PSBtaW5Db250cmliQW1vdW50OwogICAgYm9vbCBpY29Ub2tlbnNBdmFpbGFibGUgPSBpY29Tb2xkVG9rZW5zIDwgaWNvQ2FwOwogICAgcmV0dXJuICFpY29FbmRlZCAmJiBpY29FbmFibGVkICYmIHdpdGhpblBlcmlvZCAmJiBub25NaW5pbXVtUHVyY2hhc2UgJiYgaWNvVG9rZW5zQXZhaWxhYmxlOwogIH0KCiAgLy8gZW5kIGljbyBieSBvd25lciwgbm90IHJlYWxseSBuZWVkZWQgaW4gbm9ybWFsIHNpdHVhdGlvbgogIGZ1bmN0aW9uIGVuZEljbygpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICByZXF1aXJlKCFpY29FbmRlZCk7CiAgICBpY29FbmRlZCA9IHRydWU7CiAgICAvLyBzZW5kIHVuc29sZCB0b2tlbnMgdG8gbXVsdGktc2lnbiB3YWxsZXQKICAgIHVpbnQyNTYgdW5zb2xkVG9rZW5zID0gaWNvQ2FwLnN1YihpY29Tb2xkVG9rZW5zKTsKICAgIHRva2VuLnRyYW5zZmVyKG11bHRpc2lnbldhbGxldCwgdW5zb2xkVG9rZW5zKTsKICB9CgogIC8vIEByZXR1cm4gdHJ1ZSBpZiBjcm93ZHNhbGUgZXZlbnQgaGFzIGVuZGVkCiAgZnVuY3Rpb24gaGFzRW5kZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIChpY29FbmRlZCB8fCBpY29Tb2xkVG9rZW5zID49IGljb0NhcCB8fCBub3cgPiBlbmRUaW1lKTsKICB9CgoKICBmdW5jdGlvbiBnZXRSYXRlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludCl7CiAgICByZXF1aXJlKG5vdyA+PSBzdGFydFRpbWUpOwogICAgaWYgKG5vdyA8IHN0YXJ0VGltZS5hZGQoMSB3ZWVrcykpewogICAgICAvLyB3ZWVrIDEKICAgICAgcmV0dXJuIFJBVEVfRk9SX1dFRUsxOwogICAgfWVsc2UgaWYgKG5vdyA8IHN0YXJ0VGltZS5hZGQoMiB3ZWVrcykpewogICAgICAvLyB3ZWVrIDIKICAgICAgcmV0dXJuIFJBVEVfRk9SX1dFRUsyOwogICAgfWVsc2UgaWYgKG5vdyA8IHN0YXJ0VGltZS5hZGQoMyB3ZWVrcykpewogICAgICAvLyB3ZWVrIDMKICAgICAgcmV0dXJuIFJBVEVfRk9SX1dFRUszOwogICAgfWVsc2UgaWYgKG5vdyA8IGVuZFRpbWUpewogICAgICAvLyBubyBkaXNjb3VudAogICAgICByZXR1cm4gUkFURV9OT19ESVNDT1VOVDsKICAgIH0KICAgIHJldHVybiAwOwogIH0KCiAgLy8gZHJhaW4gYWxsIGV0aCBmb3Igb3duZXIgaW4gYW4gZW1lcmdlbmN5IHNpdHVhdGlvbgogIGZ1bmN0aW9uIGRyYWluKCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIG93bmVyLnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgfQp9Cgpjb250cmFjdCBFUkMyMEJhc2ljIHsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgLyoqCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1ttc2cuc2VuZGVyXSk7CgogICAgLy8gU2FmZU1hdGguc3ViIHdpbGwgdGhyb3cgaWYgdGhlcmUgaXMgbm90IGVub3VnaCBiYWxhbmNlLgogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgKi8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKbGlicmFyeSBTYWZlRVJDMjAgewogIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlcihFUkMyMEJhc2ljIHRva2VuLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBpbnRlcm5hbCB7CiAgICBhc3NlcnQodG9rZW4udHJhbnNmZXIodG8sIHZhbHVlKSk7CiAgfQoKICBmdW5jdGlvbiBzYWZlVHJhbnNmZXJGcm9tKEVSQzIwIHRva2VuLCBhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHsKICAgIGFzc2VydCh0b2tlbi50cmFuc2ZlckZyb20oZnJvbSwgdG8sIHZhbHVlKSk7CiAgfQoKICBmdW5jdGlvbiBzYWZlQXBwcm92ZShFUkMyMCB0b2tlbiwgYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBpbnRlcm5hbCB7CiAgICBhc3NlcnQodG9rZW4uYXBwcm92ZShzcGVuZGVyLCB2YWx1ZSkpOwogIH0KfQoKY29udHJhY3QgVG9rZW5WZXN0aW5nIGlzIE93bmFibGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CiAgICB1c2luZyBTYWZlRVJDMjAgZm9yIEVSQzIwQmFzaWM7CgogICAgRVJDMjBCYXNpYyB0b2tlbjsKICAgIC8vIHZlc3RpbmcKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgdG90YWxWZXN0ZWRBbW91bnQ7CgogICAgc3RydWN0IFZlc3RpbmcgewogICAgICAgIHVpbnQyNTYgYW1vdW50OwogICAgICAgIHVpbnQyNTYgdmVzdGluZ0RhdGU7CiAgICB9CgogICAgYWRkcmVzc1tdIGFjY291bnRLZXlzOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBWZXN0aW5nW10pIHB1YmxpYyB2ZXN0aW5nQWNjb3VudHM7CgogICAgLy8gZXZlbnRzCiAgICBldmVudCBWZXN0KGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiBhbW91bnQpOwogICAgZXZlbnQgVmVzdGluZ0NyZWF0ZWQoYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50MjU2IGFtb3VudCwgdWludDI1NiB2ZXN0aW5nRGF0ZSk7CgogICAgLy8gbW9kaWZpZXJzIGhlcmUKICAgIG1vZGlmaWVyIHRva2VuU2V0KCkgewogICAgICAgIHJlcXVpcmUoYWRkcmVzcyh0b2tlbikgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLyB2ZXN0aW5nIGNvbnN0cnVjdG9yCiAgICBmdW5jdGlvbiBUb2tlblZlc3RpbmcoYWRkcmVzcyB0b2tlbl9hZGRyZXNzKXsKICAgICAgIHJlcXVpcmUodG9rZW5fYWRkcmVzcyAhPSBhZGRyZXNzKDApKTsKICAgICAgIHRva2VuID0gRVJDMjBCYXNpYyh0b2tlbl9hZGRyZXNzKTsKICAgIH0KCiAgICAvLyBzZXQgdmVzdGluZyB0b2tlbiBhZGRyZXNzCiAgICBmdW5jdGlvbiBzZXRWZXN0aW5nVG9rZW4oYWRkcmVzcyB0b2tlbl9hZGRyZXNzKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUodG9rZW5fYWRkcmVzcyAhPSBhZGRyZXNzKDApKTsKICAgICAgICB0b2tlbiA9IEVSQzIwQmFzaWModG9rZW5fYWRkcmVzcyk7CiAgICB9CgogICAgLy8gY3JlYXRlIHZlc3RpbmcgYnkgaW50cm9kdWNpbmcgYmVuZWZpY2lhcnkgYWRkcmVzLCB0b3RhbCB0b2tlbiBhbW91bnQsIHN0YXJ0IGRhdGUsIGR1cmF0aW9uIGZvciBlYWNoIHZlc3QgcGVyaW9kIGFuZCBudW1iZXIgb2YgcGVyaW9kcwogICAgZnVuY3Rpb24gY3JlYXRlVmVzdGluZ0J5RHVyYXRpb25BbmRTcGxpdHMoYWRkcmVzcyB1c2VyLCB1aW50MjU2IHRvdGFsX2Ftb3VudCwgdWludDI1NiBzdGFydERhdGUsIHVpbnQyNTYgZHVyYXRpb25QZXJWZXN0aW5nLCB1aW50MjU2IHRpbWVzKSBwdWJsaWMgb25seU93bmVyIHRva2VuU2V0IHsKICAgICAgICByZXF1aXJlKHVzZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShzdGFydERhdGUgPj0gbm93KTsKICAgICAgICByZXF1aXJlKHRpbWVzID4gMCk7CiAgICAgICAgcmVxdWlyZShkdXJhdGlvblBlclZlc3RpbmcgPiAwKTsKICAgICAgICB1aW50MjU2IHZlc3RpbmdEYXRlID0gc3RhcnREYXRlOwogICAgICAgIHVpbnQyNTYgaTsKICAgICAgICB1aW50MjU2IGFtb3VudCA9IHRvdGFsX2Ftb3VudC5kaXYodGltZXMpOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCB0aW1lczsgaSsrKSB7CiAgICAgICAgICAgIHZlc3RpbmdEYXRlID0gdmVzdGluZ0RhdGUuYWRkKGR1cmF0aW9uUGVyVmVzdGluZyk7CiAgICAgICAgICAgIGlmICh2ZXN0aW5nQWNjb3VudHNbdXNlcl0ubGVuZ3RoID09IDApewogICAgICAgICAgICAgICAgYWNjb3VudEtleXMucHVzaCh1c2VyKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB2ZXN0aW5nQWNjb3VudHNbdXNlcl0ucHVzaChWZXN0aW5nKGFtb3VudCwgdmVzdGluZ0RhdGUpKTsKICAgICAgICAgICAgVmVzdGluZ0NyZWF0ZWQodXNlciwgYW1vdW50LCB2ZXN0aW5nRGF0ZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIGdldCBjdXJyZW50IHVzZXIgdG90YWwgZ3JhbnRlZCB0b2tlbiBhbW91bnQKICAgIGZ1bmN0aW9uIGdldFZlc3RpbmdBbW91bnRCeU5vdyhhZGRyZXNzIHVzZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpewogICAgICAgIHVpbnQyNTYgYW1vdW50OwogICAgICAgIHVpbnQyNTYgaTsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdmVzdGluZ0FjY291bnRzW3VzZXJdLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmICh2ZXN0aW5nQWNjb3VudHNbdXNlcl1baV0udmVzdGluZ0RhdGUgPCBub3cpIHsKICAgICAgICAgICAgICAgIGFtb3VudCA9IGFtb3VudC5hZGQodmVzdGluZ0FjY291bnRzW3VzZXJdW2ldLmFtb3VudCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgfQoKICAgIC8vIGdldCB1c2VyIGF2YWlsYWJsZSB2ZXN0aW5nIGFtb3VudCwgdG90YWwgYW1vdW50IC0gcmVjZWl2ZWQgYW1vdW50CiAgICBmdW5jdGlvbiBnZXRBdmFpbGFibGVWZXN0aW5nQW1vdW50KGFkZHJlc3MgdXNlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nil7CiAgICAgICAgdWludDI1NiBhbW91bnQ7CiAgICAgICAgYW1vdW50ID0gZ2V0VmVzdGluZ0Ftb3VudEJ5Tm93KHVzZXIpOwogICAgICAgIGFtb3VudCA9IGFtb3VudC5zdWIodG90YWxWZXN0ZWRBbW91bnRbdXNlcl0pOwogICAgICAgIHJldHVybiBhbW91bnQ7CiAgICB9CgogICAgLy8gZ2V0IGxpc3Qgb2YgdmVzdGluZyB1c2VycyBhZGRyZXNzCiAgICBmdW5jdGlvbiBnZXRBY2NvdW50S2V5cyh1aW50MjU2IHBhZ2UpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3NbMTBdKXsKICAgICAgICBhZGRyZXNzWzEwXSBtZW1vcnkgYWNjb3VudExpc3Q7CiAgICAgICAgdWludDI1NiBpOwogICAgICAgIGZvciAoaT0wICsgcGFnZSAqIDEwOyBpPDEwOyBpKyspewogICAgICAgICAgICBpZiAoaSA8IGFjY291bnRLZXlzLmxlbmd0aCl7CiAgICAgICAgICAgICAgICBhY2NvdW50TGlzdFtpIC0gcGFnZSAqIDEwXSA9IGFjY291bnRLZXlzW2ldOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBhY2NvdW50TGlzdDsKICAgIH0KCiAgICAvLyB2ZXN0CiAgICBmdW5jdGlvbiB2ZXN0KCkgZXh0ZXJuYWwgdG9rZW5TZXQgewogICAgICAgIHVpbnQyNTYgYXZhaWxhYmxlQW1vdW50ID0gZ2V0QXZhaWxhYmxlVmVzdGluZ0Ftb3VudChtc2cuc2VuZGVyKTsKICAgICAgICByZXF1aXJlKGF2YWlsYWJsZUFtb3VudCA+IDApOwogICAgICAgIHRvdGFsVmVzdGVkQW1vdW50W21zZy5zZW5kZXJdID0gdG90YWxWZXN0ZWRBbW91bnRbbXNnLnNlbmRlcl0uYWRkKGF2YWlsYWJsZUFtb3VudCk7CiAgICAgICAgdG9rZW4udHJhbnNmZXIobXNnLnNlbmRlciwgYXZhaWxhYmxlQW1vdW50KTsKICAgICAgICBWZXN0KG1zZy5zZW5kZXIsIGF2YWlsYWJsZUFtb3VudCk7CiAgICB9CgogICAgLy8gZHJhaW4gYWxsIGV0aCBhbmQgdG9rZW5zIHRvIG93bmVyIGluIGFuIGVtZXJnZW5jeSBzaXR1YXRpb24KICAgIGZ1bmN0aW9uIGRyYWluKCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICBvd25lci50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgICAgIHRva2VuLnRyYW5zZmVyKG93bmVyLCB0aGlzLmJhbGFuY2UpOwogICAgfQp9Cgpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBpbnRlcm5hbCBhbGxvd2VkOwoKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW19mcm9tXSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSk7CgogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICoKICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICogYW5kIHRoZSBuZXcgYWxsb3dhbmNlIGJ5IHVuZm9ydHVuYXRlIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcwogICAqIHJhY2UgY29uZGl0aW9uIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUgYWZ0ZXJ3YXJkczoKICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgKi8KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqLwogIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9Cgpjb250cmFjdCBQYXVzYWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIFBhdXNhYmxlIHsKICAvKioKICAgKiBAZGV2IG1vZGlmaWVyIHRvIGFsbG93IGFjdGlvbnMgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBub3QgcGF1c2VkIG9yCiAgICogdGhlIHNlbmRlciBpcyB0aGUgb3duZXIgb2YgdGhlIGNvbnRyYWN0CiAgICovCiAgbW9kaWZpZXIgd2hlbk5vdFBhdXNlZE9yT3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIgfHwgIXBhdXNlZCk7CiAgICBfOwogIH0KCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZE9yT3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkT3JPd25lciByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZE9yT3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLmFwcHJvdmUoX3NwZW5kZXIsIF92YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkT3JPd25lciByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJldHVybiBzdXBlci5pbmNyZWFzZUFwcHJvdmFsKF9zcGVuZGVyLCBfYWRkZWRWYWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWRPck93bmVyIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgcmV0dXJuIHN1cGVyLmRlY3JlYXNlQXBwcm92YWwoX3NwZW5kZXIsIF9zdWJ0cmFjdGVkVmFsdWUpOwogIH0KfQoKY29udHJhY3QgR0pDVG9rZW4gaXMgUGF1c2FibGVUb2tlbiB7CiAgc3RyaW5nIGNvbnN0YW50IHB1YmxpYyBuYW1lID0gIkdKQyI7CiAgc3RyaW5nIGNvbnN0YW50IHB1YmxpYyBzeW1ib2wgPSAiR0pDIjsKICB1aW50MjU2IGNvbnN0YW50IHB1YmxpYyBkZWNpbWFscyA9IDE4OwogIHVpbnQyNTYgY29uc3RhbnQgVE9LRU5fVU5JVCA9IDEwICoqIHVpbnQyNTYoZGVjaW1hbHMpOwogIHVpbnQyNTYgY29uc3RhbnQgSU5JVElBTF9TVVBQTFkgPSAxMDAwMDAwMDAgKiBUT0tFTl9VTklUOwoKICBmdW5jdGlvbiBHSkNUb2tlbigpIHsKICAgIC8vIFNldCB1bnRyYW5zZmVyYWJsZSBieSBkZWZhdWx0IHRvIHRoZSB0b2tlbgogICAgcGF1c2VkID0gdHJ1ZTsKICAgIC8vIGFzaWduIGFsbCB0b2tlbnMgdG8gdGhlIGNvbnRyYWN0IGNyZWF0b3IKICAgIHRvdGFsU3VwcGx5ID0gSU5JVElBTF9TVVBQTFk7CiAgICBUcmFuc2ZlcigweDAsIG1zZy5zZW5kZXIsIElOSVRJQUxfU1VQUExZKTsKICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gSU5JVElBTF9TVVBQTFk7CiAgfQp9'.
	

]
