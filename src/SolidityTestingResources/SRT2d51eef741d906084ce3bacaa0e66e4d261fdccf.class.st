Class {
	#name : #SRT2d51eef741d906084ce3bacaa0e66e4d261fdccf,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT2d51eef741d906084ce3bacaa0e66e4d261fdccf >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7Ci8qKgogKiBPdmVyZmxvdyBhd2FyZSB1aW50IG1hdGggZnVuY3Rpb25zLgogKgogKiBJbnNwaXJlZCBieSBodHRwczovL2dpdGh1Yi5jb20vTWFrZXJEQU8vbWFrZXItb3RjL2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy9zaW1wbGVfbWFya2V0LnNvbAogKi8KY29udHJhY3QgU2FmZU1hdGggewogIC8vaW50ZXJuYWxzCgogIGZ1bmN0aW9uIHNhZmVNdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIHVpbnQgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc2FmZVN1Yih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICB1aW50IGMgPSBhICsgYjsKICAgIGFzc2VydChjPj1hICYmIGM+PWIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBhc3NlcnQoYm9vbCBhc3NlcnRpb24pIGludGVybmFsIHsKICAgIGlmICghYXNzZXJ0aW9uKSB0aHJvdzsKICB9Cn0KCi8qKgogKiBFUkMgMjAgdG9rZW4KICoKICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBUb2tlbiB7CgogICAgLy8vIEByZXR1cm4gdG90YWwgYW1vdW50IG9mIHRva2VucwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHN1cHBseSkge30KCiAgICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBmcm9tIHdoaWNoIHRoZSBiYWxhbmNlIHdpbGwgYmUgcmV0cmlldmVkCiAgICAvLy8gQHJldHVybiBUaGUgYmFsYW5jZQogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHt9CgogICAgLy8vIEBub3RpY2Ugc2VuZCBgX3ZhbHVlYCB0b2tlbiB0byBgX3RvYCBmcm9tIGBtc2cuc2VuZGVyYAogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudAogICAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZAogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgdHJhbnNmZXIgd2FzIHN1Y2Nlc3NmdWwgb3Igbm90CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykge30KCiAgICAvLy8gQG5vdGljZSBzZW5kIGBfdmFsdWVgIHRva2VuIHRvIGBfdG9gIGZyb20gYF9mcm9tYCBvbiB0aGUgY29uZGl0aW9uIGl0IGlzIGFwcHJvdmVkIGJ5IGBfZnJvbWAKICAgIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3Mgb2YgdGhlIHNlbmRlcgogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudAogICAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZAogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgdHJhbnNmZXIgd2FzIHN1Y2Nlc3NmdWwgb3Igbm90CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHt9CgogICAgLy8vIEBub3RpY2UgYG1zZy5zZW5kZXJgIGFwcHJvdmVzIGBfYWRkcmAgdG8gc3BlbmQgYF92YWx1ZWAgdG9rZW5zCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2VucwogICAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB3ZWkgdG8gYmUgYXBwcm92ZWQgZm9yIHRyYW5zZmVyCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBhcHByb3ZhbCB3YXMgc3VjY2Vzc2Z1bCBvciBub3QKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykge30KCiAgICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBvd25pbmcgdG9rZW5zCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2VucwogICAgLy8vIEByZXR1cm4gQW1vdW50IG9mIHJlbWFpbmluZyB0b2tlbnMgYWxsb3dlZCB0byBzcGVudAogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykge30KCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpOwoKfQoKLyoqCiAqIEVSQyAyMCB0b2tlbgogKgogKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgVG9rZW4gewoKICAgIC8qKgogICAgICogUmV2aWV3ZWQ6CiAgICAgKiAtIEludGVyZ2VyIG92ZXJmbG93ID0gT0ssIGNoZWNrZWQKICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICAvL0RlZmF1bHQgYXNzdW1lcyB0b3RhbFN1cHBseSBjYW4ndCBiZSBvdmVyIG1heCAoMl4yNTYgLSAxKS4KICAgICAgICAvL0lmIHlvdXIgdG9rZW4gbGVhdmVzIG91dCB0b3RhbFN1cHBseSBhbmQgY2FuIGlzc3VlIG1vcmUgdG9rZW5zIGFzIHRpbWUgZ29lcyBvbiwgeW91IG5lZWQgdG8gY2hlY2sgaWYgaXQgZG9lc24ndCB3cmFwLgogICAgICAgIC8vUmVwbGFjZSB0aGUgaWYgd2l0aCB0aGlzIG9uZSBpbnN0ZWFkLgogICAgICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+IGJhbGFuY2VzW190b10pIHsKICAgICAgICAvL2lmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgewogICAgICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICAgICAgICAgIGJhbGFuY2VzW190b10gKz0gX3ZhbHVlOwogICAgICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSB7IHJldHVybiBmYWxzZTsgfQogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIC8vc2FtZSBhcyBhYm92ZS4gUmVwbGFjZSB0aGlzIGxpbmUgd2l0aCB0aGUgZm9sbG93aW5nIGlmIHlvdSB3YW50IHRvIHByb3RlY3QgYWdhaW5zdCB3cmFwcGluZyB1aW50cy4KICAgICAgICBpZiAoYmFsYW5jZXNbX2Zyb21dID49IF92YWx1ZSAmJiBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+IGJhbGFuY2VzW190b10pIHsKICAgICAgICAvL2lmIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW190b10gKz0gX3ZhbHVlOwogICAgICAgICAgICBiYWxhbmNlc1tfZnJvbV0gLT0gX3ZhbHVlOwogICAgICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICAgICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSB7IHJldHVybiBmYWxzZTsgfQogICAgfQoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwoKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwoKfQoKCi8qKgogKiBBdXRvbW9iaWxlIEN5YmVyY2hhaW4gVG9rZW4gY3Jvd2RzYWxlIElDTyBjb250cmFjdC4KICoKICovCmNvbnRyYWN0IEF1dG9tb2JpbGVDeWJlcmNoYWluVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgU2FmZU1hdGggewoKICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICJBdXRvbW9iaWxlIEN5YmVyY2hhaW4gVG9rZW4iOwogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAiQU1DQyI7CiAgICB1aW50IHB1YmxpYyBkZWNpbWFscyA9IDE4OwogICAgdWludCBwcmVTYWxlUHJpY2UgID0gMzIwMDA7CiAgICB1aW50IGNyb3dTYWxlUHJpY2UgPSAyMDAwMDsKICAgIHVpbnQgcHJlUGVyaW9kID0gMjU2ICogMjQgKiAzMDsvLyB1bml0OiBibG9jayBjb3VudCwgZXN0aW1hdGU6IDMwIGRheXMsIE1heSAxNiAwOjAwLCBVVEMtNwogICAgdWludCB0b3RhbFBlcmlvZCA9IDI1NiAqIDI0ICogOTU7IC8vIHVuaXQ6IGJsb2NrIGNvdW50LCBlc3RpbWF0ZTogOTUgZGF5cywgSnVseSAyMCwgMDowMCwgVVRDLTcKICAgIHVpbnQgcHVibGljIHN0YXJ0QmxvY2sgPSA1NDU1MjgwOyAvL2Nyb3dkc2FsZSBzdGFydCBibG9jayAoc2V0IGluIGNvbnN0cnVjdG9yKSwgQXByaWwgMTYgMDowMCBVVEMtNwogICAgdWludCBwdWJsaWMgZW5kQmxvY2sgPSBzdGFydEJsb2NrICsgdG90YWxQZXJpb2Q7IC8vY3Jvd2RzYWxlIGVuZCBibG9jawoKCiAgICAvLyBJbml0aWFsIGZvdW5kZXIgYWRkcmVzcyAoc2V0IGluIGNvbnN0cnVjdG9yKQogICAgLy8gQWxsIGRlcG9zaXRlZCBFVEggd2lsbCBiZSBpbnN0YW50bHkgZm9yd2FyZGVkIHRvIHRoaXMgYWRkcmVzcy4KICAgIC8vIEFkZHJlc3MgaXMgYSBtdWx0aXNpZyB3YWxsZXQuCiAgICBhZGRyZXNzIHB1YmxpYyBmb3VuZGVyID0gMHhmRDE2Q0RDNzkzODJGODYzMDNFMmVFODY5M0M3ZjUwQTRkOGI5MzdGOwogICAgdWludDI1NiBwdWJsaWMgcHJlRXRoZXJDYXAgPSAxNTYyNSAqIDEwKioxODsgLy8gbWF4IGFtb3VudCByYWlzZWQgZHVyaW5nIHByZS1JQ08KICAgIHVpbnQyNTYgcHVibGljIGV0aGVyQ2FwID0gICAgODgxMjUgKiAxMCoqMTg7IC8vbWF4IGFtb3VudCByYWlzZWQgZHVyaW5nIGNyb3dkc2FsZQogICAgdWludDI1NiBwdWJsaWMgYm91bnR5QWxsb2NhdGlvbiA9IDEwNTAwMDAwMDAgKiAxMCoqMTg7CiAgICB1aW50MjU2IHB1YmxpYyBtYXhUb2tlbiA9IDMwMDAwMDAwMDAgKiAxMCoqMTg7CiAgICAvLyB1aW50IHB1YmxpYyB0cmFuc2ZlckxvY2t1cCA9IDI1NiAqIDA7IC8vdHJhbnNmZXJzIGFyZSBsb2NrZWQgZm9yIHRoaXMgbWFueSBibG9ja3MgYWZ0ZXIgZW5kQmxvY2sgKGFzc3VtaW5nIDE0IHNlY29uZCBibG9ja3MpCiAgICAvLyB1aW50IHB1YmxpYyBmb3VuZGVyTG9ja3VwID0gMjU2ICogMDsgLy9mb3VuZGVyIGFsbG9jYXRpb24gY2Fubm90IGJlIGNyZWF0ZWQgdW50aWwgdGhpcyBtYW55IGJsb2NrcyBhZnRlciBlbmRCbG9jawoKICAgIHVpbnQyNTYgcHVibGljIHByZXNhbGVUb2tlblN1cHBseSA9IDA7IC8vdGhpcyB3aWxsIGtlZXAgdHJhY2sgb2YgdGhlIHRva2VuIHN1cHBseSBjcmVhdGVkIGR1cmluZyB0aGUgcHJlLWNyb3dkc2FsZQogICAgdWludDI1NiBwdWJsaWMgdG90YWxFdGhlclJhaXNlZCA9IDA7CiAgICBib29sIHB1YmxpYyBoYWx0ZWQgPSBmYWxzZTsgLy90aGUgZm91bmRlciBhZGRyZXNzIGNhbiBzZXQgdGhpcyB0byB0cnVlIHRvIGhhbHQgdGhlIGNyb3dkc2FsZSBkdWUgdG8gZW1lcmdlbmN5CgogICAgZXZlbnQgQnV5KGFkZHJlc3MgaW5kZXhlZCBzZW5kZXIsIHVpbnQgZXRoLCB1aW50IGZidCk7CgoKICAgIGZ1bmN0aW9uIEF1dG9tb2JpbGVDeWJlcmNoYWluVG9rZW4oKSB7CiAgICAgICAgYmFsYW5jZXNbZm91bmRlcl0gPSBib3VudHlBbGxvY2F0aW9uOwogICAgICAgIHRvdGFsU3VwcGx5ID0gYm91bnR5QWxsb2NhdGlvbjsKICAgICAgICBUcmFuc2ZlcihhZGRyZXNzKDApLCBmb3VuZGVyLCBib3VudHlBbGxvY2F0aW9uKTsKICAgIH0KCgogICAgZnVuY3Rpb24gcHJpY2UoKSBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsKICAgICAgICBpZiAoYmxvY2subnVtYmVyPHN0YXJ0QmxvY2sgfHwgYmxvY2subnVtYmVyID4gZW5kQmxvY2spIHJldHVybiAwOyAvL3RoaXMgd2lsbCBub3QgaGFwcGVuIGFjY29yZGluZyB0byB0aGUgYnV5VG9rZW4gYmxvY2sgY2hlY2ssIGJ1dCBzdGlsbCBzZXQgaXQgdG8gMC4KICAgICAgICBlbHNlIGlmIChibG9jay5udW1iZXI+PXN0YXJ0QmxvY2sgJiYgYmxvY2subnVtYmVyPHN0YXJ0QmxvY2srcHJlUGVyaW9kKSByZXR1cm4gcHJlU2FsZVByaWNlOyAvL3ByZS1JQ08KICAgICAgICBlbHNlICByZXR1cm4gY3Jvd1NhbGVQcmljZTsgLy8gZGVmYXVsdC1JQ08KICAgIH0KCiAgIC8qKgogICAgKiBAZGV2IGZhbGxiYWNrIGZ1bmN0aW9uICoqKkRPIE5PVCBPVkVSUklERSoqKgogICAgKi8KICAgIGZ1bmN0aW9uKCkgcHVibGljIHBheWFibGUgIHsKICAgICAgICBidXlUb2tlbihtc2cuc2VuZGVyLCBtc2cudmFsdWUpOwogICAgfQoKCiAgICAvLyBCdXkgZW50cnkgcG9pbnQKICAgIGZ1bmN0aW9uIGJ1eShhZGRyZXNzIHJlY2lwaWVudCwgdWludDI1NiB2YWx1ZSkgcHVibGljIHBheWFibGUgewogICAgICAgIGlmICh2YWx1ZT4gbXNnLnZhbHVlKSB0aHJvdzsKCiAgICAgICAgaWYgKHZhbHVlIDwgbXNnLnZhbHVlKSB7CiAgICAgICAgICAgIHJlcXVpcmUobXNnLnNlbmRlci5jYWxsLnZhbHVlKG1zZy52YWx1ZSAtIHZhbHVlKSgpKTsgLy9yZWZ1bmQgdGhlIGV4dHJhIGV0aGVyCiAgICAgICAgfQogICAgICAgIGJ1eVRva2VuKHJlY2lwaWVudCwgdmFsdWUpOwogICAgfQoKCiAgICBmdW5jdGlvbiBidXlUb2tlbihhZGRyZXNzIHJlY2lwaWVudCwgdWludDI1NiB2YWx1ZSkgaW50ZXJuYWwgewogICAgICAgIGlmIChibG9jay5udW1iZXI8c3RhcnRCbG9jayB8fCBibG9jay5udW1iZXI+ZW5kQmxvY2sgfHwgc2FmZUFkZCh0b3RhbEV0aGVyUmFpc2VkLHZhbHVlKT5ldGhlckNhcCB8fCBoYWx0ZWQpIHRocm93OwogICAgICAgIGlmIChibG9jay5udW1iZXI+PXN0YXJ0QmxvY2sgJiYgYmxvY2subnVtYmVyPD1zdGFydEJsb2NrK3ByZVBlcmlvZCAmJiBzYWZlQWRkKHRvdGFsRXRoZXJSYWlzZWQsdmFsdWUpID4gcHJlRXRoZXJDYXApIHRocm93OyAvL3ByZVNhbGUgQ2FwIGxpbWl0YXRpb24KICAgICAgICB1aW50IHRva2VucyA9IHNhZmVNdWwodmFsdWUsIHByaWNlKCkpOwogICAgICAgIGJhbGFuY2VzW3JlY2lwaWVudF0gPSBzYWZlQWRkKGJhbGFuY2VzW3JlY2lwaWVudF0sIHRva2Vucyk7CiAgICAgICAgdG90YWxTdXBwbHkgPSBzYWZlQWRkKHRvdGFsU3VwcGx5LCB0b2tlbnMpOwogICAgICAgIHRvdGFsRXRoZXJSYWlzZWQgPSBzYWZlQWRkKHRvdGFsRXRoZXJSYWlzZWQsIHZhbHVlKTsKCiAgICAgICAgaWYgKGJsb2NrLm51bWJlcjw9c3RhcnRCbG9jaytwcmVQZXJpb2QpIHsKICAgICAgICAgICAgcHJlc2FsZVRva2VuU3VwcGx5ID0gc2FmZUFkZChwcmVzYWxlVG9rZW5TdXBwbHksIHRva2Vucyk7CiAgICAgICAgfQogICAgICAgIFRyYW5zZmVyKGFkZHJlc3MoMCksIHJlY2lwaWVudCwgdG9rZW5zKTsgLy9UcmFuc2FjdGlvbiByZWNvcmQgZm9yIHRva2VuIHBlcmNoYWlzZQogICAgICAgIGlmICghZm91bmRlci5jYWxsLnZhbHVlKHZhbHVlKSgpKSB0aHJvdzsgLy9pbW1lZGlhdGVseSBzZW5kIEV0aGVyIHRvIGZvdW5kZXIgYWRkcmVzcwogICAgICAgIEJ1eShyZWNpcGllbnQsIHZhbHVlLCB0b2tlbnMpOyAvL0J1eSBldmVudAoKICAgIH0KCgogICAgLyoqCiAgICAgKiBFbWVyZ2VuY3kgU3RvcCBJQ08uCiAgICAgKgogICAgICogIEFwcGxpY2FibGUgdGVzdHM6CiAgICAgKgogICAgICogLSBUZXN0IHVuaGFsdGluZywgYnV5aW5nLCBhbmQgc3VjY2VlZGluZwogICAgICovCiAgICBmdW5jdGlvbiBoYWx0KCkgewogICAgICAgIGlmIChtc2cuc2VuZGVyIT1mb3VuZGVyKSB0aHJvdzsKICAgICAgICBoYWx0ZWQgPSB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHVuaGFsdCgpIHsKICAgICAgICBpZiAobXNnLnNlbmRlciE9Zm91bmRlcikgdGhyb3c7CiAgICAgICAgaGFsdGVkID0gZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBDaGFuZ2UgZm91bmRlciBhZGRyZXNzICh3aGVyZSBJQ08gRVRIIGlzIGJlaW5nIGZvcndhcmRlZCkuCiAgICAgKgogICAgICogQXBwbGljYWJsZSB0ZXN0czoKICAgICAqCiAgICAgKiAtIFRlc3QgZm91bmRlciBjaGFuZ2UgYnkgaGFja2VyCiAgICAgKiAtIFRlc3QgZm91bmRlciBjaGFuZ2UKICAgICAqIC0gVGVzdCBmb3VuZGVyIHRva2VuIGFsbG9jYXRpb24gdHdpY2UKICAgICAqCiAgICAgKi8KICAgIGZ1bmN0aW9uIGNoYW5nZUZvdW5kZXIoYWRkcmVzcyBuZXdGb3VuZGVyKSB7CiAgICAgICAgaWYgKG1zZy5zZW5kZXIhPWZvdW5kZXIpIHRocm93OwogICAgICAgIGZvdW5kZXIgPSBuZXdGb3VuZGVyOwogICAgfQoKICAgIGZ1bmN0aW9uIHdpdGhkcmF3RXh0cmFUb2tlbihhZGRyZXNzIHJlY2lwaWVudCkgcHVibGljIHsKICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGZvdW5kZXIgJiYgYmxvY2subnVtYmVyID4gZW5kQmxvY2sgJiYgdG90YWxTdXBwbHkgPCBtYXhUb2tlbik7CgogICAgICB1aW50MjU2IGxlZnRUb2tlbnMgPSBzYWZlU3ViKG1heFRva2VuLCB0b3RhbFN1cHBseSk7CiAgICAgIGJhbGFuY2VzW3JlY2lwaWVudF0gPSBzYWZlQWRkKGJhbGFuY2VzW3JlY2lwaWVudF0sIGxlZnRUb2tlbnMpOwogICAgICB0b3RhbFN1cHBseSA9IG1heFRva2VuOwogICAgICBUcmFuc2ZlcihhZGRyZXNzKDApLCByZWNpcGllbnQsIGxlZnRUb2tlbnMpOwogICAgfQoKCiAgICAvKioKICAgICAqIEVSQyAyMCBTdGFuZGFyZCBUb2tlbiBpbnRlcmZhY2UgdHJhbnNmZXIgZnVuY3Rpb24KICAgICAqCiAgICAgKiBQcmV2ZW50IHRyYW5zZmVycyB1bnRpbCBmcmVlemUgcGVyaW9kIGlzIG92ZXIuCiAgICAgKgogICAgICogQXBwbGljYWJsZSB0ZXN0czoKICAgICAqCiAgICAgKiAtIFRlc3QgcmVzdHJpY3RlZCBlYXJseSB0cmFuc2ZlcgogICAgICogLSBUZXN0IHRyYW5zZmVyIGFmdGVyIHJlc3RyaWN0ZWQgcGVyaW9kCiAgICAgKi8KICAgIC8vIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAvLyAgICAgaWYgKGJsb2NrLm51bWJlciA8PSBzdGFydEJsb2NrICsgdHJhbnNmZXJMb2NrdXAgJiYgbXNnLnNlbmRlciE9Zm91bmRlcikgdGhyb3c7CiAgICAvLyAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICAgIC8vIH0KCgogICAgLyoqCiAgICAgKiBFUkMgMjAgU3RhbmRhcmQgVG9rZW4gaW50ZXJmYWNlIHRyYW5zZmVyIGZ1bmN0aW9uCiAgICAgKgogICAgICogUHJldmVudCB0cmFuc2ZlcnMgdW50aWwgZnJlZXplIHBlcmlvZCBpcyBvdmVyLgogICAgICovCiAgICAvLyBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIC8vICAgICBpZiAoYmxvY2subnVtYmVyIDw9IHN0YXJ0QmxvY2sgKyB0cmFuc2ZlckxvY2t1cCAmJiBtc2cuc2VuZGVyIT1mb3VuZGVyKSB0aHJvdzsKICAgIC8vICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAvLyB9Cn0='.
	

]
