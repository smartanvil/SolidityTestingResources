Class {
	#name : #SRTb746aed479f18287dc8fc202fe06f25f1a0a60ae,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTb746aed479f18287dc8fc202fe06f25f1a0a60ae >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7CgoKY29udHJhY3QgU2FmZU1hdGggewogICAgZnVuY3Rpb24gc2FmZU11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gc2FmZVN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGFzc2VydChiIDw9IGEpOwogICAgICAgIHJldHVybiBhIC0gYjsKICAgIH0KCiAgICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludCBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSAmJiBjID49IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIC8vICBmdW5jdGlvbiBhc3NlcnQoYm9vbCBhc3NlcnRpb24pIGludGVybmFsIHsKICAgIC8vICAgIGlmICghYXNzZXJ0aW9uKSB0aHJvdzsKICAgIC8vICB9Cn0KCgovLyBFUkMgVG9rZW4gU3RhbmRhcmQgIzIwIEludGVyZmFjZQovLyBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKY29udHJhY3QgRVJDMjBJbnRlcmZhY2UgewogICAgLy8gR2V0IHRoZSB0b3RhbCB0b2tlbiBzdXBwbHkKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgdG90YWxTdXBwbHkpOwoKICAgIC8vIEdldCB0aGUgYWNjb3VudCBiYWxhbmNlIG9mIGFub3RoZXIgYWNjb3VudCB3aXRoIGFkZHJlc3MgX293bmVyCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwoKICAgIC8vIFNlbmQgX3ZhbHVlIGFtb3VudCBvZiB0b2tlbnMgdG8gYWRkcmVzcyBfdG8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8gU2VuZCBfdmFsdWUgYW1vdW50IG9mIHRva2VucyBmcm9tIGFkZHJlc3MgX2Zyb20gdG8gYWRkcmVzcyBfdG8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8vIEFsbG93IF9zcGVuZGVyIHRvIHdpdGhkcmF3IGZyb20geW91ciBhY2NvdW50LCBtdWx0aXBsZSB0aW1lcywgdXAgdG8gdGhlIF92YWx1ZSBhbW91bnQuCiAgICAvLyBJZiB0aGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBhZ2FpbiBpdCBvdmVyd3JpdGVzIHRoZSBjdXJyZW50IGFsbG93YW5jZSB3aXRoIF92YWx1ZS4KICAgIC8vIHRoaXMgZnVuY3Rpb24gaXMgcmVxdWlyZWQgZm9yIHNvbWUgREVYIGZ1bmN0aW9uYWxpdHkKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8vIFJldHVybnMgdGhlIGFtb3VudCB3aGljaCBfc3BlbmRlciBpcyBzdGlsbCBhbGxvd2VkIHRvIHdpdGhkcmF3IGZyb20gX293bmVyCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZyk7CgogICAgLy8gVHJpZ2dlcmVkIHdoZW4gdG9rZW5zIGFyZSB0cmFuc2ZlcnJlZC4KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwoKICAgIC8vIFRyaWdnZXJlZCB3aGVuZXZlciBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBpcyBjYWxsZWQuCiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKfQoKCmNvbnRyYWN0IEV0eCBpcyBFUkMyMEludGVyZmFjZSB7CiAgICB1aW50MjU2IHB1YmxpYyBleHBpcmF0aW9uQmxvY2s7CiAgICBmdW5jdGlvbiBpc0FjdGl2ZShhZGRyZXNzIF9vd25lcikgcHVibGljIHJldHVybnMgKGJvb2wgYWN0aXZhdGVkKTsKfQoKCmNvbnRyYWN0IEV0aGV4IGlzIFNhZmVNYXRoIHsKICAgIGFkZHJlc3MgcHVibGljIGFkbWluOyAvL3RoZSBhZG1pbiBhZGRyZXNzCiAgICBhZGRyZXNzIHB1YmxpYyBmZWVBY2NvdW50OyAvL3RoZSBhY2NvdW50IHRoYXQgd2lsbCByZWNlaXZlIGZlZXMKICAgIGFkZHJlc3MgcHVibGljIGV0eEFkZHJlc3M7CgogICAgdWludDI1NiBwdWJsaWMgbWFrZUZlZTsgLy9wZXJjZW50YWdlIHRpbWVzICgxIGV0aGVyKQogICAgdWludDI1NiBwdWJsaWMgdGFrZUZlZTsgLy9wZXJjZW50YWdlIHRpbWVzICgxIGV0aGVyKQogICAgdWludDI1NiBwdWJsaWMgbGFzdEZyZWVCbG9jazsKCiAgICBtYXBwaW5nIChieXRlczMyID0+IHVpbnQyNTYpIHB1YmxpYyBzZWxsT3JkZXJCYWxhbmNlczsgLy9hIGhhc2ggb2YgYXZhaWxhYmxlIG9yZGVyIGJhbGFuY2VzIGhvbGRzIGEgbnVtYmVyIG9mIHRva2VucwogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiB1aW50MjU2KSBwdWJsaWMgYnV5T3JkZXJCYWxhbmNlczsgLy9hIGhhc2ggb2YgYXZhaWxhYmxlIG9yZGVyIGJhbGFuY2VzLiBob2xkcyBhIG51bWJlciBvZiBldGgKCiAgICBldmVudCBNYWtlQnV5T3JkZXIoYnl0ZXMzMiBvcmRlckhhc2gsIGFkZHJlc3MgaW5kZXhlZCB0b2tlbiwgdWludDI1NiB0b2tlbkFtb3VudCwgdWludDI1NiB3ZWlBbW91bnQsIGFkZHJlc3MgaW5kZXhlZCBidXllcik7CgogICAgZXZlbnQgTWFrZVNlbGxPcmRlcihieXRlczMyIG9yZGVySGFzaCwgYWRkcmVzcyBpbmRleGVkIHRva2VuLCB1aW50MjU2IHRva2VuQW1vdW50LCB1aW50MjU2IHdlaUFtb3VudCwgYWRkcmVzcyBpbmRleGVkIHNlbGxlcik7CgogICAgZXZlbnQgQ2FuY2VsQnV5T3JkZXIoYnl0ZXMzMiBvcmRlckhhc2gsIGFkZHJlc3MgaW5kZXhlZCB0b2tlbiwgdWludDI1NiB0b2tlbkFtb3VudCwgdWludDI1NiB3ZWlBbW91bnQsIGFkZHJlc3MgaW5kZXhlZCBidXllcik7CgogICAgZXZlbnQgQ2FuY2VsU2VsbE9yZGVyKGJ5dGVzMzIgb3JkZXJIYXNoLCBhZGRyZXNzIGluZGV4ZWQgdG9rZW4sIHVpbnQyNTYgdG9rZW5BbW91bnQsIHVpbnQyNTYgd2VpQW1vdW50LCBhZGRyZXNzIGluZGV4ZWQgc2VsbGVyKTsKCiAgICBldmVudCBUYWtlQnV5T3JkZXIoYnl0ZXMzMiBvcmRlckhhc2gsIGFkZHJlc3MgaW5kZXhlZCB0b2tlbiwgdWludDI1NiB0b2tlbkFtb3VudCwgdWludDI1NiB3ZWlBbW91bnQsIHVpbnQyNTYgdG90YWxUcmFuc2FjdGlvblRva2VucywgYWRkcmVzcyBpbmRleGVkIGJ1eWVyLCBhZGRyZXNzIGluZGV4ZWQgc2VsbGVyKTsKCiAgICBldmVudCBUYWtlU2VsbE9yZGVyKGJ5dGVzMzIgb3JkZXJIYXNoLCBhZGRyZXNzIGluZGV4ZWQgdG9rZW4sIHVpbnQyNTYgdG9rZW5BbW91bnQsIHVpbnQyNTYgd2VpQW1vdW50LCB1aW50MjU2IHRvdGFsVHJhbnNhY3Rpb25XZWksIGFkZHJlc3MgaW5kZXhlZCBidXllciwgYWRkcmVzcyBpbmRleGVkIHNlbGxlcik7CgogICAgZnVuY3Rpb24gRXRoZXgoYWRkcmVzcyBhZG1pbl8sIGFkZHJlc3MgZmVlQWNjb3VudF8sIHVpbnQyNTYgbWFrZUZlZV8sIHVpbnQyNTYgdGFrZUZlZV8sIGFkZHJlc3MgZXR4QWRkcmVzc18sIHVpbnQyNTYgX2xhc3RGcmVlQmxvY2spIHB1YmxpYyB7CiAgICAgICAgYWRtaW4gPSBhZG1pbl87CiAgICAgICAgZmVlQWNjb3VudCA9IGZlZUFjY291bnRfOwogICAgICAgIG1ha2VGZWUgPSBtYWtlRmVlXzsKICAgICAgICB0YWtlRmVlID0gdGFrZUZlZV87CiAgICAgICAgZXR4QWRkcmVzcyA9IGV0eEFkZHJlc3NfOwogICAgICAgIGxhc3RGcmVlQmxvY2sgPSBfbGFzdEZyZWVCbG9jazsKICAgIH0KCiAgICBmdW5jdGlvbigpIHB1YmxpYyB7CiAgICAgICAgcmV2ZXJ0KCk7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlQWRtaW4oYWRkcmVzcyBhZG1pbl8pIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkbWluKTsKICAgICAgICBhZG1pbiA9IGFkbWluXzsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGFuZ2VFVFhBZGRyZXNzKGFkZHJlc3MgZXR4QWRkcmVzc18pIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkbWluKTsKICAgICAgICByZXF1aXJlKGJsb2NrLm51bWJlciA+IEV0eChldHhBZGRyZXNzKS5leHBpcmF0aW9uQmxvY2soKSk7CiAgICAgICAgZXR4QWRkcmVzcyA9IGV0eEFkZHJlc3NfOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYW5nZUxhc3RGcmVlQmxvY2sodWludDI1NiBfbGFzdEZyZWVCbG9jaykgcHVibGljIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYWRtaW4pOwogICAgICAgIHJlcXVpcmUoX2xhc3RGcmVlQmxvY2sgPiBibG9jay5udW1iZXIgKyAxMDApOyAvL2Fubm91bmNlIGF0IGxlYXN0IDEwMCBibG9ja3MgYWhlYWQKICAgICAgICBsYXN0RnJlZUJsb2NrID0gX2xhc3RGcmVlQmxvY2s7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlRmVlQWNjb3VudChhZGRyZXNzIGZlZUFjY291bnRfKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBhZG1pbik7CiAgICAgICAgZmVlQWNjb3VudCA9IGZlZUFjY291bnRfOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYW5nZU1ha2VGZWUodWludDI1NiBtYWtlRmVlXykgcHVibGljIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYWRtaW4pOwogICAgICAgIHJlcXVpcmUobWFrZUZlZV8gPCBtYWtlRmVlKTsKICAgICAgICBtYWtlRmVlID0gbWFrZUZlZV87CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlVGFrZUZlZSh1aW50MjU2IHRha2VGZWVfKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBhZG1pbik7CiAgICAgICAgcmVxdWlyZSh0YWtlRmVlXyA8IHRha2VGZWUpOwogICAgICAgIHRha2VGZWUgPSB0YWtlRmVlXzsKICAgIH0KCiAgICBmdW5jdGlvbiBmZWVGcm9tVG90YWxDb3N0Rm9yQWNjb3VudCh1aW50MjU2IHRvdGFsQ29zdCwgdWludDI1NiBmZWVBbW91bnQsIGFkZHJlc3MgYWNjb3VudCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBpZiAoRXR4KGV0eEFkZHJlc3MpLmlzQWN0aXZlKGFjY291bnQpKSB7CiAgICAgICAgICAgIC8vIE5vIGZlZSBmb3IgYWN0aXZlIGFkZHIuCiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKGJsb2NrLm51bWJlciA8PSBsYXN0RnJlZUJsb2NrKQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZmVlRnJvbVRvdGFsQ29zdCh0b3RhbENvc3QsIGZlZUFtb3VudCk7CiAgICB9CgogICAgZnVuY3Rpb24gZmVlRnJvbVRvdGFsQ29zdCh1aW50MjU2IHRvdGFsQ29zdCwgdWludDI1NiBmZWVBbW91bnQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CgogICAgICAgIHVpbnQyNTYgY29zdCA9IHNhZmVNdWwodG90YWxDb3N0LCAoMSBldGhlcikpIC8gc2FmZUFkZCgoMSBldGhlciksIGZlZUFtb3VudCk7CgogICAgICAgIC8vIENhbGN1bGF0ZSBjZWlsKGNvc3QpLgogICAgICAgIHVpbnQyNTYgcmVtYWluZGVyID0gc2FmZU11bCh0b3RhbENvc3QsICgxIGV0aGVyKSkgJSBzYWZlQWRkKCgxIGV0aGVyKSwgZmVlQW1vdW50KTsKICAgICAgICBpZiAocmVtYWluZGVyICE9IDApIHsKICAgICAgICAgICAgY29zdCA9IHNhZmVBZGQoY29zdCwgMSk7CiAgICAgICAgfQoKICAgICAgICB1aW50MjU2IGZlZSA9IHNhZmVTdWIodG90YWxDb3N0LCBjb3N0KTsKICAgICAgICByZXR1cm4gZmVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZUZlZUZvckFjY291bnQodWludDI1NiBjb3N0LCB1aW50MjU2IGZlZUFtb3VudCwgYWRkcmVzcyBhY2NvdW50KSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGlmIChFdHgoZXR4QWRkcmVzcykuaXNBY3RpdmUoYWNjb3VudCkpIHsKICAgICAgICAgICAgLy8gTm8gZmVlIGZvciB2ZXN0ZWQgYWRkci4KICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQoKICAgICAgICBpZiAoYmxvY2subnVtYmVyIDw9IGxhc3RGcmVlQmxvY2spCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CgogICAgICAgIHJldHVybiBjYWxjdWxhdGVGZWUoY29zdCwgZmVlQW1vdW50KTsKICAgIH0KCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVGZWUodWludDI1NiBjb3N0LCB1aW50MjU2IGZlZUFtb3VudCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKCiAgICAgICAgdWludDI1NiBmZWUgPSBzYWZlTXVsKGNvc3QsIGZlZUFtb3VudCkgLyAoMSBldGhlcik7CiAgICAgICAgcmV0dXJuIGZlZTsKICAgIH0KCiAgICAvLyBNYWtlcyBhbiBvZmZlciB0byB0cmFkZSB0b2tlbkFtb3VudCBvZiBFUkMyMCB0b2tlbiwgdG9rZW4sIGZvciB3ZWlBbW91bnQgb2Ygd2VpLgogICAgZnVuY3Rpb24gbWFrZVNlbGxPcmRlcihhZGRyZXNzIHRva2VuLCB1aW50MjU2IHRva2VuQW1vdW50LCB1aW50MjU2IHdlaUFtb3VudCkgcHVibGljIHsKICAgICAgICByZXF1aXJlKHRva2VuQW1vdW50ICE9IDApOwogICAgICAgIHJlcXVpcmUod2VpQW1vdW50ICE9IDApOwoKICAgICAgICBieXRlczMyIGggPSBzaGEyNTYodG9rZW4sIHRva2VuQW1vdW50LCB3ZWlBbW91bnQsIG1zZy5zZW5kZXIpOwoKCiAgICAgICAgLy8gVXBkYXRlIGJhbGFuY2UuCiAgICAgICAgc2VsbE9yZGVyQmFsYW5jZXNbaF0gPSBzYWZlQWRkKHNlbGxPcmRlckJhbGFuY2VzW2hdLCB0b2tlbkFtb3VudCk7CgogICAgICAgIC8vIENoZWNrIGFsbG93YW5jZS4gIC0tIERvbmUgYWZ0ZXIgdXBkYXRpbmcgYmFsYW5jZSBiYyBpdCBtYWtlcyBhIGNhbGwgdG8gYW4gdW50cnVzdGVkIGNvbnRyYWN0LgogICAgICAgIHJlcXVpcmUodG9rZW5BbW91bnQgPD0gRVJDMjBJbnRlcmZhY2UodG9rZW4pLmFsbG93YW5jZShtc2cuc2VuZGVyLCB0aGlzKSk7CgogICAgICAgIC8vIEdyYWIgdGhlIHRva2VuLgogICAgICAgIGlmICghRVJDMjBJbnRlcmZhY2UodG9rZW4pLnRyYW5zZmVyRnJvbShtc2cuc2VuZGVyLCB0aGlzLCB0b2tlbkFtb3VudCkpIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQoKCiAgICAgICAgTWFrZVNlbGxPcmRlcihoLCB0b2tlbiwgdG9rZW5BbW91bnQsIHdlaUFtb3VudCwgbXNnLnNlbmRlcik7CiAgICB9CgogICAgLy8gTWFrZXMgYW4gb2ZmZXIgdG8gdHJhZGUgbXNnLnZhbHVlIHdlaSBmb3IgdG9rZW5BbW91bnQgb2YgdG9rZW4gKGFuIEVSQzIwIHRva2VuKS4KICAgIGZ1bmN0aW9uIG1ha2VCdXlPcmRlcihhZGRyZXNzIHRva2VuLCB1aW50MjU2IHRva2VuQW1vdW50KSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZSh0b2tlbkFtb3VudCAhPSAwKTsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSAhPSAwKTsKCiAgICAgICAgdWludDI1NiBmZWUgPSBmZWVGcm9tVG90YWxDb3N0KG1zZy52YWx1ZSwgbWFrZUZlZSk7CiAgICAgICAgdWludDI1NiB2YWx1ZU5vRmVlID0gc2FmZVN1Yihtc2cudmFsdWUsIGZlZSk7CiAgICAgICAgYnl0ZXMzMiBoID0gc2hhMjU2KHRva2VuLCB0b2tlbkFtb3VudCwgdmFsdWVOb0ZlZSwgbXNnLnNlbmRlcik7CgogICAgICAgIC8vcHV0IGV0aGVyIGluIHRoZSBidXlPcmRlckJhbGFuY2VzIG1hcAogICAgICAgIGJ1eU9yZGVyQmFsYW5jZXNbaF0gPSBzYWZlQWRkKGJ1eU9yZGVyQmFsYW5jZXNbaF0sIG1zZy52YWx1ZSk7CgogICAgICAgIC8vIE5vdGlmeSBhbGwgY2xpZW50cy4KICAgICAgICBNYWtlQnV5T3JkZXIoaCwgdG9rZW4sIHRva2VuQW1vdW50LCB2YWx1ZU5vRmVlLCBtc2cuc2VuZGVyKTsKICAgIH0KCgogICAgLy8gQ2FuY2VscyBhbGwgcHJldmlvdXMgb2ZmZXJzIGJ5IG1zZy5zZW5kZXIgdG8gdHJhZGUgdG9rZW5BbW91bnQgb2YgdG9rZW5zIGZvciB3ZWlBbW91bnQgb2Ygd2VpLgogICAgZnVuY3Rpb24gY2FuY2VsQWxsU2VsbE9yZGVycyhhZGRyZXNzIHRva2VuLCB1aW50MjU2IHRva2VuQW1vdW50LCB1aW50MjU2IHdlaUFtb3VudCkgcHVibGljIHsKICAgICAgICBieXRlczMyIGggPSBzaGEyNTYodG9rZW4sIHRva2VuQW1vdW50LCB3ZWlBbW91bnQsIG1zZy5zZW5kZXIpOwogICAgICAgIHVpbnQyNTYgcmVtYWluID0gc2VsbE9yZGVyQmFsYW5jZXNbaF07CiAgICAgICAgZGVsZXRlIHNlbGxPcmRlckJhbGFuY2VzW2hdOwoKICAgICAgICBFUkMyMEludGVyZmFjZSh0b2tlbikudHJhbnNmZXIobXNnLnNlbmRlciwgcmVtYWluKTsKCiAgICAgICAgQ2FuY2VsU2VsbE9yZGVyKGgsIHRva2VuLCB0b2tlbkFtb3VudCwgd2VpQW1vdW50LCBtc2cuc2VuZGVyKTsKICAgIH0KCiAgICAvLyBDYW5jZWxzIGFueSBwcmV2aW91cyBvZmZlcnMgdG8gdHJhZGUgd2VpQW1vdW50IG9mIHdlaSBmb3IgdG9rZW5BbW91bnQgb2YgdG9rZW5zLiBSZWZ1bmRzIHRoZSB3ZWkgdG8gc2VuZGVyLgogICAgZnVuY3Rpb24gY2FuY2VsQWxsQnV5T3JkZXJzKGFkZHJlc3MgdG9rZW4sIHVpbnQyNTYgdG9rZW5BbW91bnQsIHVpbnQyNTYgd2VpQW1vdW50KSBwdWJsaWMgewogICAgICAgIGJ5dGVzMzIgaCA9IHNoYTI1Nih0b2tlbiwgdG9rZW5BbW91bnQsIHdlaUFtb3VudCwgbXNnLnNlbmRlcik7CiAgICAgICAgdWludDI1NiByZW1haW4gPSBidXlPcmRlckJhbGFuY2VzW2hdOwogICAgICAgIGRlbGV0ZSBidXlPcmRlckJhbGFuY2VzW2hdOwoKICAgICAgICBpZiAoIW1zZy5zZW5kZXIuc2VuZChyZW1haW4pKSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KCiAgICAgICAgQ2FuY2VsQnV5T3JkZXIoaCwgdG9rZW4sIHRva2VuQW1vdW50LCB3ZWlBbW91bnQsIG1zZy5zZW5kZXIpOwogICAgfQoKICAgIC8vIFRha2Ugc29tZSAob3IgYWxsKSBvZiB0aGUgZXRoZXIgKG1pbnVzIGZlZXMpIGluIHRoZSBidXlPcmRlckJhbGFuY2VzIGhhc2ggaW4gZXhjaGFuZ2UgZm9yIHRvdGFsVG9rZW5zIHRva2Vucy4KICAgIGZ1bmN0aW9uIHRha2VCdXlPcmRlcihhZGRyZXNzIHRva2VuLCB1aW50MjU2IHRva2VuQW1vdW50LCB1aW50MjU2IHdlaUFtb3VudCwgdWludDI1NiB0b3RhbFRva2VucywgYWRkcmVzcyBidXllcikgcHVibGljIHsKICAgICAgICByZXF1aXJlKHRva2VuQW1vdW50ICE9IDApOwogICAgICAgIHJlcXVpcmUod2VpQW1vdW50ICE9IDApOwogICAgICAgIHJlcXVpcmUodG90YWxUb2tlbnMgIT0gMCk7CgogICAgICAgIGJ5dGVzMzIgaCA9IHNoYTI1Nih0b2tlbiwgdG9rZW5BbW91bnQsIHdlaUFtb3VudCwgYnV5ZXIpOwoKICAgICAgICAvLyBIb3cgbWFueSB3ZWkgZm9yIHRoZSBhbW91bnQgb2YgdG9rZW5zIGJlaW5nIHNvbGQ/CiAgICAgICAgdWludDI1NiB0cmFuc2FjdGlvbldlaUFtb3VudE5vRmVlID0gc2FmZU11bCh0b3RhbFRva2Vucywgd2VpQW1vdW50KSAvIHRva2VuQW1vdW50OwoKICAgICAgICAvLyBEb2VzIHRoZSBidXllciAobWFrZXIpIGhhdmUgZW5vdWdoIG1vbmV5IGluIHRoZSBjb250cmFjdD8KICAgICAgICB1aW50MjU2IHVudmVzdGVkTWFrZUZlZSA9IGNhbGN1bGF0ZUZlZSh0cmFuc2FjdGlvbldlaUFtb3VudE5vRmVlLCBtYWtlRmVlKTsKICAgICAgICB1aW50MjU2IHRvdGFsVHJhbnNhY3Rpb25XZWlBbW91bnQgPSBzYWZlQWRkKHRyYW5zYWN0aW9uV2VpQW1vdW50Tm9GZWUsIHVudmVzdGVkTWFrZUZlZSk7CiAgICAgICAgcmVxdWlyZShidXlPcmRlckJhbGFuY2VzW2hdID49IHRvdGFsVHJhbnNhY3Rpb25XZWlBbW91bnQpOwoKCiAgICAgICAgLy8gQ2FsY3VsYXRlIHRoZSBhY3R1YWwgdmVzdGVkIGZlZXMuCiAgICAgICAgdWludDI1NiBjdXJyZW50VGFrZUZlZSA9IGNhbGN1bGF0ZUZlZUZvckFjY291bnQodHJhbnNhY3Rpb25XZWlBbW91bnROb0ZlZSwgdGFrZUZlZSwgbXNnLnNlbmRlcik7CiAgICAgICAgdWludDI1NiBjdXJyZW50TWFrZUZlZSA9IGNhbGN1bGF0ZUZlZUZvckFjY291bnQodHJhbnNhY3Rpb25XZWlBbW91bnROb0ZlZSwgbWFrZUZlZSwgYnV5ZXIpOwoKICAgICAgICAvLyBQcm9jZWVkIHdpdGggdHJhbnNmZXJyaW5nIGJhbGFuY2VzLgoKICAgICAgICAvLyBVcGRhdGUgb3VyIGludGVybmFsIGFjY291bnRpbmcuCiAgICAgICAgYnV5T3JkZXJCYWxhbmNlc1toXSA9IHNhZmVTdWIoYnV5T3JkZXJCYWxhbmNlc1toXSwgdG90YWxUcmFuc2FjdGlvbldlaUFtb3VudCk7CgoKICAgICAgICAvLyBEaWQgdGhlIHNlbGxlciBzZW5kIGVub3VnaCB0b2tlbnM/ICAtLSBUaGlzIGNoZWNrIGlzIGhlcmUgYmMgaXQgY2FsbHMgdG8gYW4gdW50cnVzdGVkIGNvbnRyYWN0LgogICAgICAgIHJlcXVpcmUoRVJDMjBJbnRlcmZhY2UodG9rZW4pLmFsbG93YW5jZShtc2cuc2VuZGVyLCB0aGlzKSA+PSB0b3RhbFRva2Vucyk7CgogICAgICAgIC8vIFNlbmQgYnV5ZXIgdGhlaXIgdG9rZW5zIGFuZCBhbnkgZmVlIHJlZnVuZC4KICAgICAgICBpZiAoY3VycmVudE1ha2VGZWUgPCB1bnZlc3RlZE1ha2VGZWUpIHsvLyB0aGUgYnV5ZXIgZ290IGEgZmVlIGRpc2NvdW50LiBTZW5kIHRoZSByZWZ1bmQuCiAgICAgICAgICAgIHVpbnQyNTYgcmVmdW5kQW1vdW50ID0gc2FmZVN1Yih1bnZlc3RlZE1ha2VGZWUsIGN1cnJlbnRNYWtlRmVlKTsKICAgICAgICAgICAgaWYgKCFidXllci5zZW5kKHJlZnVuZEFtb3VudCkpIHsKICAgICAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICghRVJDMjBJbnRlcmZhY2UodG9rZW4pLnRyYW5zZmVyRnJvbShtc2cuc2VuZGVyLCBidXllciwgdG90YWxUb2tlbnMpKSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KCiAgICAgICAgLy8gR3JhYiBvdXIgZmVlLgogICAgICAgIGlmIChzYWZlQWRkKGN1cnJlbnRUYWtlRmVlLCBjdXJyZW50TWFrZUZlZSkgPiAwKSB7CiAgICAgICAgICAgIGlmICghZmVlQWNjb3VudC5zZW5kKHNhZmVBZGQoY3VycmVudFRha2VGZWUsIGN1cnJlbnRNYWtlRmVlKSkpIHsKICAgICAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBTZW5kIHNlbGxlciB0aGUgcHJvY2VlZHMuCiAgICAgICAgaWYgKCFtc2cuc2VuZGVyLnNlbmQoc2FmZVN1Yih0cmFuc2FjdGlvbldlaUFtb3VudE5vRmVlLCBjdXJyZW50VGFrZUZlZSkpKSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KCiAgICAgICAgVGFrZUJ1eU9yZGVyKGgsIHRva2VuLCB0b2tlbkFtb3VudCwgd2VpQW1vdW50LCB0b3RhbFRva2VucywgYnV5ZXIsIG1zZy5zZW5kZXIpOwogICAgfQoKCiAgICBmdW5jdGlvbiB0YWtlU2VsbE9yZGVyKGFkZHJlc3MgdG9rZW4sIHVpbnQyNTYgdG9rZW5BbW91bnQsIHVpbnQyNTYgd2VpQW1vdW50LCBhZGRyZXNzIHNlbGxlcikgcHVibGljIHBheWFibGUgewoKICAgICAgICByZXF1aXJlKHRva2VuQW1vdW50ICE9IDApOwogICAgICAgIHJlcXVpcmUod2VpQW1vdW50ICE9IDApOwoKICAgICAgICBieXRlczMyIGggPSBzaGEyNTYodG9rZW4sIHRva2VuQW1vdW50LCB3ZWlBbW91bnQsIHNlbGxlcik7CgogICAgICAgIC8vIENoZWNrIHRoYXQgdGhlIGNvbnRyYWN0IGhhcyBlbm91Z2ggdG9rZW4gdG8gc2F0aXNmeSB0aGlzIG9yZGVyLgogICAgICAgIHVpbnQyNTYgY3VycmVudFRha2VGZWUgPSBmZWVGcm9tVG90YWxDb3N0Rm9yQWNjb3VudChtc2cudmFsdWUsIHRha2VGZWUsIG1zZy5zZW5kZXIpOwogICAgICAgIHVpbnQyNTYgdHJhbnNhY3Rpb25XZWlBbW91bnROb0ZlZSA9IHNhZmVTdWIobXNnLnZhbHVlLCBjdXJyZW50VGFrZUZlZSk7CiAgICAgICAgdWludDI1NiB0b3RhbFRva2VucyA9IHNhZmVNdWwodHJhbnNhY3Rpb25XZWlBbW91bnROb0ZlZSwgdG9rZW5BbW91bnQpIC8gd2VpQW1vdW50OwogICAgICAgIHJlcXVpcmUoc2VsbE9yZGVyQmFsYW5jZXNbaF0gPj0gdG90YWxUb2tlbnMpOwoKICAgICAgICAvLyBDYWxjdWxhdGUgdG90YWwgdmVzdGVkIGZlZS4KICAgICAgICB1aW50MjU2IGN1cnJlbnRNYWtlRmVlID0gY2FsY3VsYXRlRmVlRm9yQWNjb3VudCh0cmFuc2FjdGlvbldlaUFtb3VudE5vRmVlLCBtYWtlRmVlLCBzZWxsZXIpOwogICAgICAgIHVpbnQyNTYgdG90YWxGZWUgPSBzYWZlQWRkKGN1cnJlbnRNYWtlRmVlLCBjdXJyZW50VGFrZUZlZSk7CgogICAgICAgIHVpbnQyNTYgbWFrZXJQcm9jZWVkc0FmdGVyRmVlID0gc2FmZVN1Yih0cmFuc2FjdGlvbldlaUFtb3VudE5vRmVlLCBjdXJyZW50TWFrZUZlZSk7CgogICAgICAgIC8vIFRyYW5zZmVyLgoKICAgICAgICAvLyBVcGRhdGUgaW50ZXJuYWwgYWNjb3VudGluZy4KICAgICAgICBzZWxsT3JkZXJCYWxhbmNlc1toXSA9IHNhZmVTdWIoc2VsbE9yZGVyQmFsYW5jZXNbaF0sIHRvdGFsVG9rZW5zKTsKCiAgICAgICAgLy8gU2VuZCBidXllciB0aGUgdG9rZW5zLgogICAgICAgIGlmICghRVJDMjBJbnRlcmZhY2UodG9rZW4pLnRyYW5zZmVyKG1zZy5zZW5kZXIsIHRvdGFsVG9rZW5zKSkgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CgogICAgICAgIC8vIFRha2Ugb3VyIGZlZS4KICAgICAgICBpZiAodG90YWxGZWUgPiAwKSB7CiAgICAgICAgICAgIGlmICghZmVlQWNjb3VudC5zZW5kKHRvdGFsRmVlKSkgewogICAgICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIFNlbmQgc2VsbGVyIHRoZSBwcm9jZWVkcy4KICAgICAgICBpZiAoIXNlbGxlci5zZW5kKG1ha2VyUHJvY2VlZHNBZnRlckZlZSkpIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQoKICAgICAgICBUYWtlU2VsbE9yZGVyKGgsIHRva2VuLCB0b2tlbkFtb3VudCwgd2VpQW1vdW50LCB0cmFuc2FjdGlvbldlaUFtb3VudE5vRmVlLCBtc2cuc2VuZGVyLCBzZWxsZXIpOwogICAgfQp9'.
	

]
