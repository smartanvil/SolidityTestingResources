Class {
	#name : #SRT40da24a66f729d0bd0453681c5a6506bdc2a7a6a,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT40da24a66f729d0bd0453681c5a6506bdc2a7a6a >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgpsaWJyYXJ5IEJvbnVzIHsKICAgIHVpbnQyNTYgY29uc3RhbnQgcG9pbnRNdWx0aXBsaWVyID0gMWUxODsgLy8xMDAlID0gMSoxMF4xOCBwb2ludHMKCiAgICBmdW5jdGlvbiBnZXRCb251c0ZhY3Rvcih1aW50MjU2IHNvbGRUb1VzZXIpCiAgICBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYgZmFjdG9yKQogICAgewogICAgICAgIHVpbnQyNTYgdG9rZW5Tb2xkID0gc29sZFRvVXNlciAvIHBvaW50TXVsdGlwbGllcjsKICAgICAgICAvL2NvbXBhcmUgd2hvbGUgY29pbnMKCiAgICAgICAgLy95ZXMsIHRoaXMgaXMgc3BhZ2hldHRpIGNvZGUsIHRvIGF2b2lkIGNvbXBsZXggZm9ybXVsYXMgd2hpY2ggd291bGQgbmVlZCAzIGRpZmZlcmVudCBzZWN0aW9ucyBhbnl3YXlzLgogICAgICAgIGlmICh0b2tlblNvbGQgPj0gMTAwMDAwKSB7CiAgICAgICAgICAgIHJldHVybiAxMDA7CiAgICAgICAgfQogICAgICAgIC8vMC41JSBsZXNzIHBlciAxMDAwMCB0b2tlbnMKICAgICAgICBpZiAodG9rZW5Tb2xkID49IDkwMDAwKSB7CiAgICAgICAgICAgIHJldHVybiA5NTsKICAgICAgICB9CiAgICAgICAgaWYgKHRva2VuU29sZCA+PSA4MDAwMCkgewogICAgICAgICAgICByZXR1cm4gOTA7CiAgICAgICAgfQogICAgICAgIGlmICh0b2tlblNvbGQgPj0gNzAwMDApIHsKICAgICAgICAgICAgcmV0dXJuIDg1OwogICAgICAgIH0KICAgICAgICBpZiAodG9rZW5Tb2xkID49IDYwMDAwKSB7CiAgICAgICAgICAgIHJldHVybiA4MDsKICAgICAgICB9CiAgICAgICAgaWYgKHRva2VuU29sZCA+PSA1MDAwMCkgewogICAgICAgICAgICByZXR1cm4gNzU7CiAgICAgICAgfQogICAgICAgIGlmICh0b2tlblNvbGQgPj0gNDAwMDApIHsKICAgICAgICAgICAgcmV0dXJuIDcwOwogICAgICAgIH0KICAgICAgICBpZiAodG9rZW5Tb2xkID49IDMwMDAwKSB7CiAgICAgICAgICAgIHJldHVybiA2NTsKICAgICAgICB9CiAgICAgICAgaWYgKHRva2VuU29sZCA+PSAyMDAwMCkgewogICAgICAgICAgICByZXR1cm4gNjA7CiAgICAgICAgfQogICAgICAgIGlmICh0b2tlblNvbGQgPj0gMTAwMDApIHsKICAgICAgICAgICAgcmV0dXJuIDU1OwogICAgICAgIH0KICAgICAgICAvL3N3aXRjaCB0byAwLjUlIHBlciAxMDAwIHRva2VucwogICAgICAgIGlmICh0b2tlblNvbGQgPj0gOTAwMCkgewogICAgICAgICAgICByZXR1cm4gNTA7CiAgICAgICAgfQogICAgICAgIGlmICh0b2tlblNvbGQgPj0gODAwMCkgewogICAgICAgICAgICByZXR1cm4gNDU7CiAgICAgICAgfQogICAgICAgIGlmICh0b2tlblNvbGQgPj0gNzAwMCkgewogICAgICAgICAgICByZXR1cm4gNDA7CiAgICAgICAgfQogICAgICAgIGlmICh0b2tlblNvbGQgPj0gNjAwMCkgewogICAgICAgICAgICByZXR1cm4gMzU7CiAgICAgICAgfQogICAgICAgIGlmICh0b2tlblNvbGQgPj0gNTAwMCkgewogICAgICAgICAgICByZXR1cm4gMzA7CiAgICAgICAgfQogICAgICAgIGlmICh0b2tlblNvbGQgPj0gNDAwMCkgewogICAgICAgICAgICByZXR1cm4gMjU7CiAgICAgICAgfQogICAgICAgIC8vc3dpdGNoIHRvIDAuNSUgcGVyIDUwMCB0b2tlbnMKICAgICAgICBpZiAodG9rZW5Tb2xkID49IDMwMDApIHsKICAgICAgICAgICAgcmV0dXJuIDIwOwogICAgICAgIH0KICAgICAgICBpZiAodG9rZW5Tb2xkID49IDI1MDApIHsKICAgICAgICAgICAgcmV0dXJuIDE1OwogICAgICAgIH0KICAgICAgICBpZiAodG9rZW5Tb2xkID49IDIwMDApIHsKICAgICAgICAgICAgcmV0dXJuIDEwOwogICAgICAgIH0KICAgICAgICBpZiAodG9rZW5Tb2xkID49IDE1MDApIHsKICAgICAgICAgICAgcmV0dXJuIDU7CiAgICAgICAgfQogICAgICAgIC8vbGVzcyB0aGFuIDE1MDAgLT4gMCB2b2x1bWUtZGVwZW5kYW50IGJvbnVzCiAgICAgICAgcmV0dXJuIDA7CiAgICB9Cgp9CmxpYnJhcnkgU2FmZU1hdGggewogICAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSAqIGI7CiAgICAgICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgICAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgICAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGFzc2VydChiIDw9IGEpOwogICAgICAgIHJldHVybiBhIC0gYjsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgICAgICBhc3NlcnQoYyA+PSBhKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KfQpjb250cmFjdCBFUkMyMEJhc2ljIHsKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wpOwogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgICAvKioKICAgICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICAgKi8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9Cgp9CmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCgogICAgLyoqCiAgICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91dCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJlZAogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICAgICAgdmFyIF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKCiAgICAgICAgLy8gQ2hlY2sgaXMgbm90IG5lZWRlZCBiZWNhdXNlIHN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0CiAgICAgICAgLy8gcmVxdWlyZSAoX3ZhbHVlIDw9IF9hbGxvd2FuY2UpOwoKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBfYWxsb3dhbmNlLnN1YihfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCkgewoKICAgICAgICAvLyBUbyBjaGFuZ2UgdGhlIGFwcHJvdmUgYW1vdW50IHlvdSBmaXJzdCBoYXZlIHRvIHJlZHVjZSB0aGUgYWRkcmVzc2VzYAogICAgICAgIC8vICBhbGxvd2FuY2UgdG8gemVybyBieSBjYWxsaW5nIGBhcHByb3ZlKF9zcGVuZGVyLCAwKWAgaWYgaXQgaXMgbm90CiAgICAgICAgLy8gIGFscmVhZHkgMCB0byBtaXRpZ2F0ZSB0aGUgcmFjZSBjb25kaXRpb24gZGVzY3JpYmVkIGhlcmU6CiAgICAgICAgLy8gIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICAgICAgcmVxdWlyZSgoX3ZhbHVlID09IDApIHx8IChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9PSAwKSk7CgogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KCn0KCmNvbnRyYWN0IENyd2RUb2tlbiBpcyBTdGFuZGFyZFRva2VuIHsKCiAgICAvLyBkYXRhIHN0cnVjdHVyZXMKICAgIGVudW0gU3RhdGVzIHsKICAgICAgICBJbml0aWFsLCAvLyBkZXBsb3ltZW50IHRpbWUKICAgICAgICBWYWx1YXRpb25TZXQsCiAgICAgICAgSWNvLCAvLyB3aGl0ZWxpc3QgYWRkcmVzc2VzLCBhY2NlcHQgZnVuZHMsIHVwZGF0ZSBiYWxhbmNlcwogICAgICAgIFVuZGVyZnVuZGVkLCAvLyBJQ08gdGltZSBmaW5pc2hlZCBhbmQgbWluaW1hbCBhbW91bnQgbm90IHJhaXNlZAogICAgICAgIE9wZXJhdGlvbmFsLCAvLyBwcm9kdWN0aW9uIHBoYXNlCiAgICAgICAgUGF1c2VkICAgICAgICAgLy8gZm9yIGNvbnRyYWN0IHVwZ3JhZGVzCiAgICB9CgogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBldGhQb3NzaWJsZVJlZnVuZHM7CgogICAgdWludDI1NiBwdWJsaWMgc29sZFRva2VuczsKCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiQ3J3ZHRva2VuIjsKCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJDUldEIjsKCiAgICB1aW50OCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIHdoaXRlbGlzdDsKCiAgICBhZGRyZXNzIHB1YmxpYyB0ZWFtVGltZUxvY2s7CiAgICBhZGRyZXNzIHB1YmxpYyBkZXZUaW1lTG9jazsKICAgIGFkZHJlc3MgcHVibGljIGNvdW50cnlUaW1lTG9jazsKCiAgICBhZGRyZXNzIHB1YmxpYyBtaXNjTm90TG9ja2VkOwoKICAgIGFkZHJlc3MgcHVibGljIHN0YXRlQ29udHJvbDsKCiAgICBhZGRyZXNzIHB1YmxpYyB3aGl0ZWxpc3RDb250cm9sOwoKICAgIGFkZHJlc3MgcHVibGljIHdpdGhkcmF3Q29udHJvbDsKCiAgICBhZGRyZXNzIHB1YmxpYyB0b2tlbkFzc2lnbm1lbnRDb250cm9sOwoKICAgIFN0YXRlcyBwdWJsaWMgc3RhdGU7CgogICAgdWludDI1NiBwdWJsaWMgd2VpSUNPTWluaW11bTsKCiAgICB1aW50MjU2IHB1YmxpYyB3ZWlJQ09NYXhpbXVtOwoKICAgIHVpbnQyNTYgcHVibGljIHNpbGVuY2VQZXJpb2Q7CgogICAgdWludDI1NiBwdWJsaWMgc3RhcnRBY2NlcHRpbmdGdW5kc0Jsb2NrOwoKICAgIHVpbnQyNTYgcHVibGljIGVuZEJsb2NrOwoKICAgIHVpbnQyNTYgcHVibGljIEVUSF9DUldEVE9LRU47IC8vbnVtYmVyIG9mIHRva2VucyBwZXIgRVRICgogICAgdWludDI1NiBjb25zdGFudCBwb2ludE11bHRpcGxpZXIgPSAxZTE4OyAvLzEwMCUgPSAxKjEwXjE4IHBvaW50cwoKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IG1heFRvdGFsU3VwcGx5ID0gNDUwMDAwMDAgKiBwb2ludE11bHRpcGxpZXI7CgogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgcGVyY2VudEZvclNhbGUgPSA1MDsKCiAgICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwogICAgZXZlbnQgTWludEZpbmlzaGVkKCk7CgogICAgYm9vbCBwdWJsaWMgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CgogICAgYm9vbCBwdWJsaWMgYm9udXNQaGFzZSA9IGZhbHNlOwoKCiAgICAvL3RoaXMgY3JlYXRlcyB0aGUgY29udHJhY3QgYW5kIHN0b3JlcyB0aGUgb3duZXIuIGl0IGFsc28gcGFzc2VzIGluIDMgYWRkcmVzc2VzIHRvIGJlIHVzZWQgbGF0ZXIgZHVyaW5nIHRoZSBsaWZldGltZSBvZiB0aGUgY29udHJhY3QuCiAgICBmdW5jdGlvbiBDcndkVG9rZW4oCiAgICAgICAgYWRkcmVzcyBfc3RhdGVDb250cm9sCiAgICAsIGFkZHJlc3MgX3doaXRlbGlzdENvbnRyb2wKICAgICwgYWRkcmVzcyBfd2l0aGRyYXdDb250cm9sCiAgICAsIGFkZHJlc3MgX3Rva2VuQXNzaWdubWVudENvbnRyb2wKICAgICwgYWRkcmVzcyBfbm90TG9ja2VkIC8vMTUlCiAgICAsIGFkZHJlc3MgX2xvY2tlZFRlYW0gLy8xNSUKICAgICwgYWRkcmVzcyBfbG9ja2VkRGV2IC8vMTAlCiAgICAsIGFkZHJlc3MgX2xvY2tlZENvdW50cnkgLy8xMCUKICAgICkgewogICAgICAgIHN0YXRlQ29udHJvbCA9IF9zdGF0ZUNvbnRyb2w7CiAgICAgICAgd2hpdGVsaXN0Q29udHJvbCA9IF93aGl0ZWxpc3RDb250cm9sOwogICAgICAgIHdpdGhkcmF3Q29udHJvbCA9IF93aXRoZHJhd0NvbnRyb2w7CiAgICAgICAgdG9rZW5Bc3NpZ25tZW50Q29udHJvbCA9IF90b2tlbkFzc2lnbm1lbnRDb250cm9sOwogICAgICAgIG1vdmVUb1N0YXRlKFN0YXRlcy5Jbml0aWFsKTsKICAgICAgICB3ZWlJQ09NaW5pbXVtID0gMDsKICAgICAgICAvL3RvIGJlIG92ZXJyaWRkZW4KICAgICAgICB3ZWlJQ09NYXhpbXVtID0gMDsKICAgICAgICBlbmRCbG9jayA9IDA7CiAgICAgICAgRVRIX0NSV0RUT0tFTiA9IDA7CiAgICAgICAgdG90YWxTdXBwbHkgPSAwOwogICAgICAgIHNvbGRUb2tlbnMgPSAwOwogICAgICAgIHVpbnQgcmVsZWFzZVRpbWUgPSBub3cgKyA5ICogMzEgZGF5czsKICAgICAgICB0ZWFtVGltZUxvY2sgPSBhZGRyZXNzKG5ldyBDcndkVGltZWxvY2sodGhpcywgX2xvY2tlZFRlYW0sIHJlbGVhc2VUaW1lKSk7CiAgICAgICAgZGV2VGltZUxvY2sgPSBhZGRyZXNzKG5ldyBDcndkVGltZWxvY2sodGhpcywgX2xvY2tlZERldiwgcmVsZWFzZVRpbWUpKTsKICAgICAgICBjb3VudHJ5VGltZUxvY2sgPSBhZGRyZXNzKG5ldyBDcndkVGltZWxvY2sodGhpcywgX2xvY2tlZENvdW50cnksIHJlbGVhc2VUaW1lKSk7CiAgICAgICAgbWlzY05vdExvY2tlZCA9IF9ub3RMb2NrZWQ7CiAgICB9CgogICAgZXZlbnQgV2hpdGVsaXN0ZWQoYWRkcmVzcyBhZGRyKTsKCiAgICBldmVudCBTdGF0ZVRyYW5zaXRpb24oU3RhdGVzIG9sZFN0YXRlLCBTdGF0ZXMgbmV3U3RhdGUpOwoKICAgIG1vZGlmaWVyIG9ubHlXaGl0ZWxpc3QoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHdoaXRlbGlzdENvbnRyb2wpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seVN0YXRlQ29udHJvbCgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gc3RhdGVDb250cm9sKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlUb2tlbkFzc2lnbm1lbnRDb250cm9sKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSB0b2tlbkFzc2lnbm1lbnRDb250cm9sKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlXaXRoZHJhdygpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gd2l0aGRyYXdDb250cm9sKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIHJlcXVpcmVTdGF0ZShTdGF0ZXMgX3JlcXVpcmVkU3RhdGUpIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IF9yZXF1aXJlZFN0YXRlKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgQkVHSU4gSUNPIGZ1bmN0aW9ucwogICAgKi8KCiAgICAvL3RoaXMgaXMgdGhlIG1haW4gZnVuZGluZyBmdW5jdGlvbiwgaXQgdXBkYXRlcyB0aGUgYmFsYW5jZXMgb2YgdG9rZW5zIGR1cmluZyB0aGUgSUNPLgogICAgLy9ubyBwYXJ0aWN1bGFyIGluY2VudGl2ZSBzY2hlbWVzIGhhdmUgYmVlbiBpbXBsZW1lbnRlZCBoZXJlCiAgICAvL2l0IGlzIG9ubHkgYWNjZXNzaWJsZSBkdXJpbmcgdGhlICJJQ08iIHBoYXNlLgogICAgZnVuY3Rpb24oKSBwYXlhYmxlCiAgICByZXF1aXJlU3RhdGUoU3RhdGVzLkljbykKICAgIHsKICAgICAgICByZXF1aXJlKHdoaXRlbGlzdFttc2cuc2VuZGVyXSA9PSB0cnVlKTsKICAgICAgICByZXF1aXJlKHRoaXMuYmFsYW5jZSA8PSB3ZWlJQ09NYXhpbXVtKTsKICAgICAgICAvL25vdGUgdGhhdCBtc2cudmFsdWUgaXMgYWxyZWFkeSBpbmNsdWRlZCBpbiB0aGlzLmJhbGFuY2UKICAgICAgICByZXF1aXJlKGJsb2NrLm51bWJlciA8IGVuZEJsb2NrKTsKICAgICAgICByZXF1aXJlKGJsb2NrLm51bWJlciA+PSBzdGFydEFjY2VwdGluZ0Z1bmRzQmxvY2spOwoKICAgICAgICB1aW50MjU2IGJhc2lzVG9rZW5zID0gbXNnLnZhbHVlLm11bChFVEhfQ1JXRFRPS0VOKTsKICAgICAgICB1aW50MjU2IHNvbGRUb1R1c2VyV2l0aEJvbnVzID0gYWRkQm9udXMoYmFzaXNUb2tlbnMpOwoKICAgICAgICBpc3N1ZVRva2Vuc1RvVXNlcihtc2cuc2VuZGVyLCBzb2xkVG9UdXNlcldpdGhCb251cyk7CiAgICAgICAgZXRoUG9zc2libGVSZWZ1bmRzW21zZy5zZW5kZXJdID0gZXRoUG9zc2libGVSZWZ1bmRzW21zZy5zZW5kZXJdLmFkZChtc2cudmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzc3VlVG9rZW5zVG9Vc2VyKGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQyNTYgYW1vdW50KQogICAgaW50ZXJuYWwKICAgIHsKICAgICAgICBiYWxhbmNlc1tiZW5lZmljaWFyeV0gPSBiYWxhbmNlc1tiZW5lZmljaWFyeV0uYWRkKGFtb3VudCk7CiAgICAgICAgc29sZFRva2VucyA9IHNvbGRUb2tlbnMuYWRkKGFtb3VudCk7CiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoYW1vdW50Lm11bCgxMDApLmRpdihwZXJjZW50Rm9yU2FsZSkpOwogICAgICAgIE1pbnQoYmVuZWZpY2lhcnksIGFtb3VudCk7CiAgICAgICAgVHJhbnNmZXIoMHgwLCBiZW5lZmljaWFyeSwgYW1vdW50KTsKICAgIH0KCiAgICBmdW5jdGlvbiBpc3N1ZVBlcmNlbnRUb1Jlc2VydmUoYWRkcmVzcyBiZW5lZmljaWFyeSwgdWludDI1NiBwZXJjZW50T2ZTb2xkKQogICAgaW50ZXJuYWwKICAgIHsKICAgICAgICB1aW50MjU2IGFtb3VudCA9IHRvdGFsU3VwcGx5Lm11bChwZXJjZW50T2ZTb2xkKS5kaXYoMTAwKTsKICAgICAgICBiYWxhbmNlc1tiZW5lZmljaWFyeV0gPSBiYWxhbmNlc1tiZW5lZmljaWFyeV0uYWRkKGFtb3VudCk7CiAgICAgICAgTWludChiZW5lZmljaWFyeSwgYW1vdW50KTsKICAgICAgICBUcmFuc2ZlcigweDAsIGJlbmVmaWNpYXJ5LCBhbW91bnQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZEJvbnVzKHVpbnQyNTYgYmFzaXNUb2tlbnMpCiAgICBwdWJsaWMgY29uc3RhbnQKICAgIHJldHVybnMgKHVpbnQyNTYgcmVzdWx0aW5nVG9rZW5zKQogICAgewogICAgICAgIC8vaWYgcHJlLXNhbGUgaXMgbm90IGFjdGl2ZSBubyBib251cyBjYWxjdWxhdGlvbgogICAgICAgIGlmICghYm9udXNQaGFzZSkgcmV0dXJuIGJhc2lzVG9rZW5zOwogICAgICAgIC8vcGVyY2VudGFnZXMgYXJlIGludGVnZXIgbnVtYmVycyBhcyBwZXIgbWlsbCAocHJvbWlsbGUpIHNvIHdlIGNhbiBhY2N1cmF0ZWx5IGNhbGN1bGF0ZSAwLjUlID0gNS4gMTAwJSA9IDEwMDAKICAgICAgICB1aW50MjU2IHBlck1pbGxCb251cyA9IGdldFBoYXNlQm9udXMoKTsKICAgICAgICAvL25vIGJvbnVzIGlmIGludmVzdG1lbnQgYW1vdW50IDwgMTAwMCB0b2tlbnMKICAgICAgICBpZiAoYmFzaXNUb2tlbnMgPj0gcG9pbnRNdWx0aXBsaWVyLm11bCgxMDAwKSkgewogICAgICAgICAgICBwZXJNaWxsQm9udXMgKz0gQm9udXMuZ2V0Qm9udXNGYWN0b3IoYmFzaXNUb2tlbnMpOwogICAgICAgIH0KICAgICAgICAvLzEwMCUgKyBib251cyAlIHRpbWVzIG9yaWdpbmFsIGFtb3VudCBkaXZpZGVkIGJ5IDEwMCUuCiAgICAgICAgcmV0dXJuIGJhc2lzVG9rZW5zLm11bChwZXJfbWlsbCArIHBlck1pbGxCb251cykuZGl2KHBlcl9taWxsKTsKICAgIH0KCiAgICB1aW50MjU2IGNvbnN0YW50IHBlcl9taWxsID0gMTAwMDsKCiAgICBmdW5jdGlvbiBzZXRCb251c1BoYXNlKGJvb2wgX2lzQm9udXNQaGFzZSkKICAgIG9ubHlTdGF0ZUNvbnRyb2wKICAgICAgICAvL3BoYXNlcyBhcmUgY29udHJvbGxlZCBtYW51YWxseSB0aHJvdWdoIHRoZSBzdGF0ZSBjb250cm9sIGtleQogICAgewogICAgICAgIGJvbnVzUGhhc2UgPSBfaXNCb251c1BoYXNlOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFBoYXNlQm9udXMoKQogICAgaW50ZXJuYWwKICAgIGNvbnN0YW50CiAgICByZXR1cm5zICh1aW50MjU2IGZhY3RvcikKICAgIHsKICAgICAgICBpZiAoYm9udXNQaGFzZSkgey8vMjAlCiAgICAgICAgICAgIHJldHVybiAyMDA7CiAgICAgICAgfQogICAgICAgIHJldHVybiAwOwogICAgfQoKCiAgICBmdW5jdGlvbiBtb3ZlVG9TdGF0ZShTdGF0ZXMgX25ld1N0YXRlKQogICAgaW50ZXJuYWwKICAgIHsKICAgICAgICBTdGF0ZVRyYW5zaXRpb24oc3RhdGUsIF9uZXdTdGF0ZSk7CiAgICAgICAgc3RhdGUgPSBfbmV3U3RhdGU7CiAgICB9CiAgICAvLyBJQ08gY29udHJhY3QgY29uZmlndXJhdGlvbiBmdW5jdGlvbgogICAgLy8gbmV3RXRoSUNPTWluaW11bSBpcyB0aGUgbWluaW11bSBhbW91bnQgb2YgZnVuZHMgdG8gcmFpc2UKICAgIC8vIG5ld0V0aElDT01heGltdW0gaXMgdGhlIG1heGltdW0gYW1vdW50IG9mIGZ1bmRzIHRvIHJhaXNlCiAgICAvLyBzaWxlbmNlUGVyaW9kIGlzIGEgbnVtYmVyIG9mIGJsb2NrcyB0byB3YWl0IGFmdGVyIHN0YXJ0aW5nIHRoZSBJQ08uIE5vIGZ1bmRzIGFyZSBhY2NlcHRlZCBkdXJpbmcgdGhlIHNpbGVuY2UgcGVyaW9kLiBJdCBjYW4gYmUgc2V0IHRvIHplcm8uCiAgICAvLyBuZXdFbmRCbG9jayBpcyB0aGUgYWJzb2x1dGUgYmxvY2sgbnVtYmVyIGF0IHdoaWNoIHRoZSBJQ08gbXVzdCBzdG9wLiBJdCBtdXN0IGJlIHNldCBhZnRlciBub3cgKyBzaWxlbmNlIHBlcmlvZC4KICAgIGZ1bmN0aW9uIHVwZGF0ZUV0aElDT1RocmVzaG9sZHModWludDI1NiBfbmV3V2VpSUNPTWluaW11bSwgdWludDI1NiBfbmV3V2VpSUNPTWF4aW11bSwgdWludDI1NiBfc2lsZW5jZVBlcmlvZCwgdWludDI1NiBfbmV3RW5kQmxvY2spCiAgICBvbmx5U3RhdGVDb250cm9sCiAgICB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZXMuSW5pdGlhbCB8fCBzdGF0ZSA9PSBTdGF0ZXMuVmFsdWF0aW9uU2V0KTsKICAgICAgICByZXF1aXJlKF9uZXdXZWlJQ09NYXhpbXVtID4gX25ld1dlaUlDT01pbmltdW0pOwogICAgICAgIHJlcXVpcmUoYmxvY2subnVtYmVyICsgc2lsZW5jZVBlcmlvZCA8IF9uZXdFbmRCbG9jayk7CiAgICAgICAgcmVxdWlyZShibG9jay5udW1iZXIgPCBfbmV3RW5kQmxvY2spOwogICAgICAgIHdlaUlDT01pbmltdW0gPSBfbmV3V2VpSUNPTWluaW11bTsKICAgICAgICB3ZWlJQ09NYXhpbXVtID0gX25ld1dlaUlDT01heGltdW07CiAgICAgICAgc2lsZW5jZVBlcmlvZCA9IF9zaWxlbmNlUGVyaW9kOwogICAgICAgIGVuZEJsb2NrID0gX25ld0VuZEJsb2NrOwogICAgICAgIC8vIGluaXRpYWwgY29udmVyc2lvbiByYXRlIG9mIEVUSF9DUldEVE9LRU4gc2V0IG5vdywgdGhpcyBpcyB1c2VkIGR1cmluZyB0aGUgSWNvIHBoYXNlLgogICAgICAgIEVUSF9DUldEVE9LRU4gPSBtYXhUb3RhbFN1cHBseS5tdWwocGVyY2VudEZvclNhbGUpLmRpdigxMDApLmRpdih3ZWlJQ09NYXhpbXVtKTsKICAgICAgICAvLyBjaGVjayBwb2ludE11bHRpcGxpZXIKICAgICAgICBtb3ZlVG9TdGF0ZShTdGF0ZXMuVmFsdWF0aW9uU2V0KTsKICAgIH0KCiAgICBmdW5jdGlvbiBzdGFydElDTygpCiAgICBvbmx5U3RhdGVDb250cm9sCiAgICByZXF1aXJlU3RhdGUoU3RhdGVzLlZhbHVhdGlvblNldCkKICAgIHsKICAgICAgICByZXF1aXJlKGJsb2NrLm51bWJlciA8IGVuZEJsb2NrKTsKICAgICAgICByZXF1aXJlKGJsb2NrLm51bWJlciArIHNpbGVuY2VQZXJpb2QgPCBlbmRCbG9jayk7CiAgICAgICAgc3RhcnRBY2NlcHRpbmdGdW5kc0Jsb2NrID0gYmxvY2subnVtYmVyICsgc2lsZW5jZVBlcmlvZDsKICAgICAgICBtb3ZlVG9TdGF0ZShTdGF0ZXMuSWNvKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRQcmVzYWxlQW1vdW50KGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQyNTYgYW1vdW50KQogICAgb25seVRva2VuQXNzaWdubWVudENvbnRyb2wKICAgIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlcy5WYWx1YXRpb25TZXQgfHwgc3RhdGUgPT0gU3RhdGVzLkljbyk7CiAgICAgICAgaXNzdWVUb2tlbnNUb1VzZXIoYmVuZWZpY2lhcnksIGFtb3VudCk7CiAgICB9CgoKICAgIGZ1bmN0aW9uIGVuZElDTygpCiAgICBvbmx5U3RhdGVDb250cm9sCiAgICByZXF1aXJlU3RhdGUoU3RhdGVzLkljbykKICAgIHsKICAgICAgICBpZiAodGhpcy5iYWxhbmNlIDwgd2VpSUNPTWluaW11bSkgewogICAgICAgICAgICBtb3ZlVG9TdGF0ZShTdGF0ZXMuVW5kZXJmdW5kZWQpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgYnVybkFuZEZpbmlzaCgpOwogICAgICAgICAgICBtb3ZlVG9TdGF0ZShTdGF0ZXMuT3BlcmF0aW9uYWwpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBhbnlvbmVFbmRJQ08oKQogICAgcmVxdWlyZVN0YXRlKFN0YXRlcy5JY28pCiAgICB7CiAgICAgICAgcmVxdWlyZShibG9jay5udW1iZXIgPiBlbmRCbG9jayk7CiAgICAgICAgaWYgKHRoaXMuYmFsYW5jZSA8IHdlaUlDT01pbmltdW0pIHsKICAgICAgICAgICAgbW92ZVRvU3RhdGUoU3RhdGVzLlVuZGVyZnVuZGVkKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGJ1cm5BbmRGaW5pc2goKTsKICAgICAgICAgICAgbW92ZVRvU3RhdGUoU3RhdGVzLk9wZXJhdGlvbmFsKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gYnVybkFuZEZpbmlzaCgpCiAgICBpbnRlcm5hbAogICAgewogICAgICAgIGlzc3VlUGVyY2VudFRvUmVzZXJ2ZSh0ZWFtVGltZUxvY2ssIDE1KTsKICAgICAgICBpc3N1ZVBlcmNlbnRUb1Jlc2VydmUoZGV2VGltZUxvY2ssIDEwKTsKICAgICAgICBpc3N1ZVBlcmNlbnRUb1Jlc2VydmUoY291bnRyeVRpbWVMb2NrLCAxMCk7CiAgICAgICAgaXNzdWVQZXJjZW50VG9SZXNlcnZlKG1pc2NOb3RMb2NrZWQsIDE1KTsKCiAgICAgICAgdG90YWxTdXBwbHkgPSBzb2xkVG9rZW5zCiAgICAgICAgLmFkZChiYWxhbmNlc1t0ZWFtVGltZUxvY2tdKQogICAgICAgIC5hZGQoYmFsYW5jZXNbZGV2VGltZUxvY2tdKQogICAgICAgIC5hZGQoYmFsYW5jZXNbY291bnRyeVRpbWVMb2NrXSkKICAgICAgICAuYWRkKGJhbGFuY2VzW21pc2NOb3RMb2NrZWRdKTsKCiAgICAgICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgICAgICBNaW50RmluaXNoZWQoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRUb1doaXRlbGlzdChhZGRyZXNzIF93aGl0ZWxpc3RlZCkKICAgIG9ubHlXaGl0ZWxpc3QKICAgICAgICAvLyAgICByZXF1aXJlU3RhdGUoU3RhdGVzLkljbykKICAgIHsKICAgICAgICB3aGl0ZWxpc3RbX3doaXRlbGlzdGVkXSA9IHRydWU7CiAgICAgICAgV2hpdGVsaXN0ZWQoX3doaXRlbGlzdGVkKTsKICAgIH0KCgogICAgLy9lbWVyZ2VuY3kgcGF1c2UgZm9yIHRoZSBJQ08KICAgIGZ1bmN0aW9uIHBhdXNlKCkKICAgIG9ubHlTdGF0ZUNvbnRyb2wKICAgIHJlcXVpcmVTdGF0ZShTdGF0ZXMuSWNvKQogICAgewogICAgICAgIG1vdmVUb1N0YXRlKFN0YXRlcy5QYXVzZWQpOwogICAgfQoKICAgIC8vaW4gY2FzZSB3ZSB3YW50IHRvIGNvbXBsZXRlbHkgYWJvcnQKICAgIGZ1bmN0aW9uIGFib3J0KCkKICAgIG9ubHlTdGF0ZUNvbnRyb2wKICAgIHJlcXVpcmVTdGF0ZShTdGF0ZXMuUGF1c2VkKQogICAgewogICAgICAgIG1vdmVUb1N0YXRlKFN0YXRlcy5VbmRlcmZ1bmRlZCk7CiAgICB9CgogICAgLy91bi1wYXVzZQogICAgZnVuY3Rpb24gcmVzdW1lSUNPKCkKICAgIG9ubHlTdGF0ZUNvbnRyb2wKICAgIHJlcXVpcmVTdGF0ZShTdGF0ZXMuUGF1c2VkKQogICAgewogICAgICAgIG1vdmVUb1N0YXRlKFN0YXRlcy5JY28pOwogICAgfQoKICAgIC8vaW4gY2FzZSBvZiBhIGZhaWxlZC9hYm9ydGVkIElDTyBldmVyeSBpbnZlc3RvciBjYW4gZ2V0IGJhY2sgdGhlaXIgbW9uZXkKICAgIGZ1bmN0aW9uIHJlcXVlc3RSZWZ1bmQoKQogICAgcmVxdWlyZVN0YXRlKFN0YXRlcy5VbmRlcmZ1bmRlZCkKICAgIHsKICAgICAgICByZXF1aXJlKGV0aFBvc3NpYmxlUmVmdW5kc1ttc2cuc2VuZGVyXSA+IDApOwogICAgICAgIC8vdGhlcmUgaXMgbm8gbmVlZCBmb3IgdXBkYXRlQWNjb3VudChtc2cuc2VuZGVyKSBzaW5jZSB0aGUgdG9rZW4gbmV2ZXIgYmVjYW1lIGFjdGl2ZS4KICAgICAgICB1aW50MjU2IHBheW91dCA9IGV0aFBvc3NpYmxlUmVmdW5kc1ttc2cuc2VuZGVyXTsKICAgICAgICAvL3JldmVyc2UgY2FsY3VsYXRlIHRoZSBhbW91bnQgdG8gcGF5IG91dAogICAgICAgIGV0aFBvc3NpYmxlUmVmdW5kc1ttc2cuc2VuZGVyXSA9IDA7CiAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihwYXlvdXQpOwogICAgfQoKICAgIC8vYWZ0ZXIgdGhlIGljbyBoYXMgcnVuIGl0cyBjb3Vyc2UsIHRoZSB3aXRoZHJhdyBhY2NvdW50IGNhbiBkcmFpbiBmdW5kcyBiaXQtYnktYml0IGFzIG5lZWRlZC4KICAgIGZ1bmN0aW9uIHJlcXVlc3RQYXlvdXQodWludCBfYW1vdW50KQogICAgb25seVdpdGhkcmF3IC8vdmVyeSBpbXBvcnRhbnQhCiAgICByZXF1aXJlU3RhdGUoU3RhdGVzLk9wZXJhdGlvbmFsKQogICAgewogICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoX2Ftb3VudCk7CiAgICB9CgogICAgLy9pZiB0aGlzIGNvbnRyYWN0IGdldHMgYSBiYWxhbmNlIGluIHNvbWUgb3RoZXIgRVJDMjAgY29udHJhY3QgLSBvciBldmVuIGlzZWxmIC0gdGhlbiB3ZSBjYW4gcmVzY3VlIGl0LgogICAgZnVuY3Rpb24gcmVzY3VlVG9rZW4oRVJDMjBCYXNpYyBfZm9yZWlnblRva2VuLCBhZGRyZXNzIF90bykKICAgIG9ubHlUb2tlbkFzc2lnbm1lbnRDb250cm9sCiAgICByZXF1aXJlU3RhdGUoU3RhdGVzLk9wZXJhdGlvbmFsKQogICAgewogICAgICAgIF9mb3JlaWduVG9rZW4udHJhbnNmZXIoX3RvLCBfZm9yZWlnblRva2VuLmJhbGFuY2VPZih0aGlzKSk7CiAgICB9CiAgICAvKioKICAgIEVORCBJQ08gZnVuY3Rpb25zCiAgICAqLwoKICAgIC8qKgogICAgQkVHSU4gRVJDMjAgZnVuY3Rpb25zCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKQogICAgcmVxdWlyZVN0YXRlKFN0YXRlcy5PcGVyYXRpb25hbCkKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkKICAgIHJlcXVpcmVTdGF0ZShTdGF0ZXMuT3BlcmF0aW9uYWwpCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX2FjY291bnQpCiAgICBjb25zdGFudAogICAgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19hY2NvdW50XTsKICAgIH0KCiAgICAvKioKICAgIEVORCBFUkMyMCBmdW5jdGlvbnMKICAgICovCn0KY29udHJhY3QgQ3J3ZFRpbWVsb2NrIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgYmFsYW5jZXM7CgogICAgdWludDI1NiBwdWJsaWMgYXNzaWduZWRCYWxhbmNlOwogICAgLy8gYmVuZWZpY2lhcnkgb2YgdG9rZW5zIGFmdGVyIHRoZXkgYXJlIHJlbGVhc2VkCiAgICBhZGRyZXNzIHB1YmxpYyBjb250cm9sbGVyOwoKICAgIC8vIHRpbWVzdGFtcCB3aGVuIHRva2VuIHJlbGVhc2UgaXMgZW5hYmxlZAogICAgdWludCBwdWJsaWMgcmVsZWFzZVRpbWU7CgogICAgQ3J3ZFRva2VuIHRva2VuOwoKICAgIGZ1bmN0aW9uIENyd2RUaW1lbG9jayhDcndkVG9rZW4gX3Rva2VuLCBhZGRyZXNzIF9jb250cm9sbGVyLCB1aW50IF9yZWxlYXNlVGltZSkgewogICAgICAgIHJlcXVpcmUoX3JlbGVhc2VUaW1lID4gbm93KTsKICAgICAgICB0b2tlbiA9IF90b2tlbjsKICAgICAgICBjb250cm9sbGVyID0gX2NvbnRyb2xsZXI7CiAgICAgICAgcmVsZWFzZVRpbWUgPSBfcmVsZWFzZVRpbWU7CiAgICB9CgogICAgZnVuY3Rpb24gYXNzaWduVG9CZW5lZmljaWFyeShhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludDI1NiBfYW1vdW50KXsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY29udHJvbGxlcik7CiAgICAgICAgYXNzaWduZWRCYWxhbmNlID0gYXNzaWduZWRCYWxhbmNlLnN1YihiYWxhbmNlc1tfYmVuZWZpY2lhcnldKTsKICAgICAgICAvL3RvZG8gdGVzdCB0aGF0IHRoaXMgcm9sbHMgYmFjayBjb3JyZWN0bHkhCiAgICAgICAgLy9iYWxhbmNlT2YodGhpcykgd2lsbCBiZSAwIHVudGlsIHRoZSBPcGVyYXRpb25hbCBQaGFzZSBoYXMgYmVlbiByZWFjaGVkLCBubyBuZWVkIGZvciBleHBsaWNpdCBjaGVjawogICAgICAgIHJlcXVpcmUodG9rZW4uYmFsYW5jZU9mKHRoaXMpID49IGFzc2lnbmVkQmFsYW5jZS5hZGQoX2Ftb3VudCkpOwogICAgICAgIGJhbGFuY2VzW19iZW5lZmljaWFyeV0gPSBfYW1vdW50OwogICAgICAgIC8vYmFsYW5jZSBpcyBzZXQsIG5vdCBhZGRlZCwgZ2l2ZXMgX2NvbnRyb2xsZXIgdGhlIHBvd2VyIHRvIHNldCBhbnkgYmFsYW5jZSwgZXZlbiAwCiAgICAgICAgYXNzaWduZWRCYWxhbmNlID0gYXNzaWduZWRCYWxhbmNlLmFkZChiYWxhbmNlc1tfYmVuZWZpY2lhcnldKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBub3RpY2UgVHJhbnNmZXJzIHRva2VucyBoZWxkIGJ5IHRpbWVsb2NrIHRvIGJlbmVmaWNpYXJ5LgogICAgICovCiAgICBmdW5jdGlvbiByZWxlYXNlKGFkZHJlc3MgX2JlbmVmaWNpYXJ5KSB7CiAgICAgICAgcmVxdWlyZShub3cgPj0gcmVsZWFzZVRpbWUpOwogICAgICAgIHVpbnQgYW1vdW50ID0gYmFsYW5jZXNbX2JlbmVmaWNpYXJ5XTsKICAgICAgICByZXF1aXJlKGFtb3VudCA+IDApOwogICAgICAgIHRva2VuLnRyYW5zZmVyKF9iZW5lZmljaWFyeSwgYW1vdW50KTsKICAgICAgICBhc3NpZ25lZEJhbGFuY2UgPSBhc3NpZ25lZEJhbGFuY2Uuc3ViKGFtb3VudCk7CiAgICAgICAgYmFsYW5jZXNbX2JlbmVmaWNpYXJ5XSA9IDA7CgogICAgfQp9'.
	

]
