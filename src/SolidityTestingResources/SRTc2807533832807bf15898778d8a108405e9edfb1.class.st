Class {
	#name : #SRTc2807533832807bf15898778d8a108405e9edfb1,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTc2807533832807bf15898778d8a108405e9edfb1 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKgogKiBQb256aSBUcnVzdCBUb2tlbiBTbWFydCBDb250cmFjdHMgCiAqIENvZGUgaXMgcHVibGlzaGVkIG9uIGh0dHBzOi8vZ2l0aHViLmNvbS9Qb256aVRydXN0L1Rva2VuCiAqIFBvbnppIFRydXN0IGh0dHBzOi8vcG9ueml0cnVzdC5jb20vCiovCgoKLy8gc2VlOiBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5L2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy9tYXRoL1NhZmVNYXRoLnNvbApsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKGEgPT0gMCkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgoKLy8gc2VlOiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9ibG9iL21hc3Rlci9FSVBTL2VpcC0yMC5tZApjb250cmFjdCBFUkMyMCB7CiAgZnVuY3Rpb24gbmFtZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZyk7CiAgZnVuY3Rpb24gc3ltYm9sKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nKTsKICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgoKLy8gc2VlOiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvNjc3CmNvbnRyYWN0IEVSQzY3N1Rva2VuIHsKICBmdW5jdGlvbiB0cmFuc2ZlckFuZENhbGwoYWRkcmVzcyByZWNlaXZlciwgdWludCBhbW91bnQsIGJ5dGVzIGRhdGEpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogIGZ1bmN0aW9uIGNvbnRyYWN0RmFsbGJhY2soYWRkcmVzcyB0bywgdWludCB2YWx1ZSwgYnl0ZXMgZGF0YSkgaW50ZXJuYWw7CiAgZnVuY3Rpb24gaXNDb250cmFjdChhZGRyZXNzIGFkZHIpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCBoYXNDb2RlKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50IHZhbHVlLCBieXRlcyBkYXRhKTsKfQoKCi8vIHNlZTogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzY3Nwpjb250cmFjdCBFUkM2NzdSZWNpcGllbnQgewogIGZ1bmN0aW9uIHRva2VuRmFsbGJhY2soYWRkcmVzcyBmcm9tLCB1aW50MjU2IGFtb3VudCwgYnl0ZXMgZGF0YSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7Cn0gIAoKCi8qKgoqIEBkZXYgVGhlIHRva2VuIGltcGxlbWVudCBFUkMyMCBhbmQgRVJDNjc3IHN0YW5kYXJ0cyhzZWUgYWJvdmUpLgoqIHVzZSBXaXRoZHJhd2FsLCBSZXN0cmljdGluZyBBY2Nlc3MsIFN0YXRlIE1hY2hpbmUgcGF0dGVybnMuCiogc2VlOiBodHRwOi8vc29saWRpdHkucmVhZHRoZWRvY3MuaW8vZW4vZGV2ZWxvcC9jb21tb24tcGF0dGVybnMuaHRtbAoqIHVzZSBTYWZlTWF0aCBsaWJyYXJ5LCBzZWUgYWJvdmUuCiogVGhlIG93bmVyIGNhbiBpbnRlcnZlbmUgaW4gdGhlIHdvcmsgb2YgdGhlIHRva2VuIG9ubHkgYmVmb3JlIHRoZSBleHBpcmF0aW9uCiogRFVSQVRJT05fVE9fQUNDRVNTX0ZPUl9PV05FUiA9IDE0NCBkYXlzLiBDb250cmFjdCBoYXMgdGhlZSBzdGF0ZSBvZiB3b3JraW5nOgoqIDEuUHJlU2FsZSAtIG9ubHkgb3duZXIgY2FuIGFjY2VzcyB0byB0cmFuc2ZlciB0b2tlbnMuIDIuU2FsZSAtIGNvbnRyYWN0IHRvIHNhbGUKKiB0b2tlbnMgYnkgZnVuYyBieVRva2VuKCkgb2YgZmFsbGJhY2ssIGNvbnRhY3QgYW5kIG93bmVyIGNhbiBhY2Nlc3MgdG8gdHJhbnNmZXIgdG9rZW5zLiAKKiBUb2tlbiBwcmljZSBzZXR0aW5nIGJ5IG93bmVyIG9yIHByaWNlIHNldHRlci4gMy5QdWJsaWNVc2UgLSBhbnlvbmUgY2FuIHRyYW5zZmVyIHRva2Vucy4KKi8KY29udHJhY3QgUG9uemlUb2tlbiBpcyBFUkMyMCwgRVJDNjc3VG9rZW4gewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBlbnVtIFN0YXRlIHsKICAgIFByZVNhbGUsICAgLy9QUkVfU0FMRV9TVFIKICAgIFNhbGUsICAgICAgLy9TQUxFX1NUUgogICAgUHVibGljVXNlICAvL1BVQkxJQ19VU0VfU1RSCiAgfQogIC8vIHdlIG5lZWQgcmV0dXJucyBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2Ygc3RhdGUKICAvLyBiZWNhdXNlIGVudW1zIGFyZSBub3Qgc3VwcG9ydGVkIGJ5IHRoZSBBQkksIHRoZXkgYXJlIGp1c3Qgc3VwcG9ydGVkIGJ5IFNvbGlkaXR5LgogIC8vIHNlZTogaHR0cDovL3NvbGlkaXR5LnJlYWR0aGVkb2NzLmlvL2VuL2RldmVsb3AvZnJlcXVlbnRseS1hc2tlZC1xdWVzdGlvbnMuaHRtbCNpZi1pLXJldHVybi1hbi1lbnVtLWktb25seS1nZXQtaW50ZWdlci12YWx1ZXMtaW4td2ViMy1qcy1ob3ctdG8tZ2V0LXRoZS1uYW1lZC12YWx1ZXMKICBzdHJpbmcgcHJpdmF0ZSBjb25zdGFudCBQUkVfU0FMRV9TVFIgPSAiUHJlU2FsZSI7CiAgc3RyaW5nIHByaXZhdGUgY29uc3RhbnQgU0FMRV9TVFIgPSAiU2FsZSI7CiAgc3RyaW5nIHByaXZhdGUgY29uc3RhbnQgUFVCTElDX1VTRV9TVFIgPSAiUHVibGljVXNlIjsKICBTdGF0ZSBwcml2YXRlIG1fc3RhdGU7CgogIHVpbnQyNTYgcHJpdmF0ZSBjb25zdGFudCBEVVJBVElPTl9UT19BQ0NFU1NfRk9SX09XTkVSID0gMTQ0IGRheXM7CiAgCiAgdWludDI1NiBwcml2YXRlIG1fbWF4VG9rZW5zUGVyQWRkcmVzczsKICB1aW50MjU2IHByaXZhdGUgbV9maXJzdEVudHJhbmNlVG9TYWxlU3RhdGVVTklYOwogIGFkZHJlc3MgcHJpdmF0ZSBtX293bmVyOwogIGFkZHJlc3MgcHJpdmF0ZSBtX3ByaWNlU2V0dGVyOwogIGFkZHJlc3MgcHJpdmF0ZSBtX2Jhbms7CiAgdWludDI1NiBwcml2YXRlIG1fdG9rZW5QcmljZUluV2VpOwogIHVpbnQyNTYgcHJpdmF0ZSBtX3RvdGFsU3VwcGx5OwogIHVpbnQyNTYgcHJpdmF0ZSBtX215RGVidEluV2VpOwogIHN0cmluZyBwcml2YXRlIG1fbmFtZTsKICBzdHJpbmcgcHJpdmF0ZSBtX3N5bWJvbDsKICB1aW50OCBwcml2YXRlIG1fZGVjaW1hbHM7CiAgYm9vbCBwcml2YXRlIG1faXNGaXhlZFRva2VuUHJpY2U7CiAgCiAgbWFwcGluZyhhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIHByaXZhdGUgbV9hbGxvd2VkOwogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBwcml2YXRlIG1fYmFsYW5jZXM7CiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHByaXZhdGUgbV9wZW5kaW5nV2l0aGRyYXdhbHM7CgovLy8vLy8vLy8vLy8vLy8vCi8vIEVWRU5UUwovLwogIGV2ZW50IFN0YXRlQ2hhbmdlZChhZGRyZXNzIGluZGV4ZWQgd2hvLCBTdGF0ZSBuZXdTdGF0ZSk7CiAgZXZlbnQgUHJpY2VDaGFuZ2VkKGFkZHJlc3MgaW5kZXhlZCB3aG8sIHVpbnQgbmV3UHJpY2UsIGJvb2wgaXNGaXhlZCk7CiAgZXZlbnQgVG9rZW5zU29sZCh1aW50MjU2IG51bWJlck9mVG9rZW5zLCBhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VkQnksIHVpbnQyNTYgaW5kZXhlZCBwcmljZUluV2VpKTsKICBldmVudCBXaXRoZHJhd2FsKGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCBzdW1JbldlaSk7CgovLy8vLy8vLy8vLy8vLy8vCi8vIE1PRElGSUVSUyAtIFJlc3RyaWN0aW5nIEFjY2VzcyBhbmQgU3RhdGUgTWFjaGluZSBwYXR0ZXJucwovLwogIG1vZGlmaWVyIGF0U3RhdGUoU3RhdGUgc3RhdGUpIHsKICAgIHJlcXVpcmUobV9zdGF0ZSA9PSBzdGF0ZSk7CiAgICBfOwogIH0KCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG1fb3duZXIpOwogICAgXzsKICB9CgogIG1vZGlmaWVyIG9ubHlPd25lck9yQXRTdGF0ZShTdGF0ZSBzdGF0ZSkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG1fb3duZXIgfHwgbV9zdGF0ZSA9PSBzdGF0ZSk7IAogICAgXzsKICB9CiAgCiAgbW9kaWZpZXIgY2hlY2tBY2Nlc3MoKSB7CiAgICByZXF1aXJlKG1fZmlyc3RFbnRyYW5jZVRvU2FsZVN0YXRlVU5JWCA9PSAwIC8vIHNvbGl1bS1kaXNhYmxlLWxpbmUgaW5kZW50YXRpb24sIG9wZXJhdG9yLXdoaXRlc3BhY2UKICAgICAgfHwgbm93LnN1YihtX2ZpcnN0RW50cmFuY2VUb1NhbGVTdGF0ZVVOSVgpIDw9IERVUkFUSU9OX1RPX0FDQ0VTU19GT1JfT1dORVIgCiAgICAgIHx8IG1fc3RhdGUgIT0gU3RhdGUuUHVibGljVXNlCiAgICApOyAKICAgIF87CiAgICAvLyBvd25lciBoYXMgbm90IGFjY2VzcyBpZiBkdXJhdGlvbiBUbyBBY2Nlc3MgRm9yIE93bmVyIHdhcyBwYXNzZWQgCiAgICAvLyBhbmQgKCYmKSBjb250cmFjdCBpbiBQdWJsaWNVc2Ugc3RhdGUuCiAgfQogIAogIG1vZGlmaWVyIHZhbGlkUmVjaXBpZW50KGFkZHJlc3MgcmVjaXBpZW50KSB7CiAgICByZXF1aXJlKHJlY2lwaWVudCAhPSBhZGRyZXNzKDApICYmIHJlY2lwaWVudCAhPSBhZGRyZXNzKHRoaXMpKTsKICAgIF87CiAgfQoKLy8vLy8vLy8vLy8vLy8vCi8vIENPTlNUUlVDVE9SCi8vICAKICAvKioKICAqIEBkZXYgQ29uc3RydWN0b3IgUG9uemlUb2tlbi4KICAqLwogIGZ1bmN0aW9uIFBvbnppVG9rZW4oKSBwdWJsaWMgewogICAgbV9vd25lciA9IG1zZy5zZW5kZXI7CiAgICBtX2JhbmsgPSBtc2cuc2VuZGVyOwogICAgbV9zdGF0ZSA9IFN0YXRlLlByZVNhbGU7CiAgICBtX2RlY2ltYWxzID0gODsKICAgIG1fbmFtZSA9ICJQb256aSI7CiAgICBtX3N5bWJvbCA9ICJQVCI7CiAgfQoKICAvKioKICAqIGRvIG5vdCBmb3JnZXQgYWJvdXQ6CiAgKiBodHRwczovL21lZGl1bS5jb20vY29kZXRyYWN0aW8vYS1sb29rLWludG8tcGFyaXR5cy1tdWx0aXNpZy13YWxsZXQtYnVnLWFmZmVjdGluZy0xMDAtbWlsbGlvbi1pbi1ldGhlci1hbmQtdG9rZW5zLTM1NmY1YmE2ZTkwYQogICogCiAgKiBAZGV2IEluaXRpYWxpemUgdGhlIGNvbnRyYWN0LCBvbmx5IG93bmVyIGNhbiBjYWxsIGFuZCBvbmx5IG9uY2UuCiAgKiBAcmV0dXJuIFdoZXRoZXIgc3VjY2Vzc2Z1bCBvciBub3QuCiAgKi8KICBmdW5jdGlvbiBpbml0Q29udHJhY3QoKSAKICAgIHB1YmxpYyAKICAgIG9ubHlPd25lcigpIAogICAgcmV0dXJucyAoYm9vbCkKICB7CiAgICByZXF1aXJlKG1fbWF4VG9rZW5zUGVyQWRkcmVzcyA9PSAwICYmIG1fZGVjaW1hbHMgPiAwKTsKICAgIG1fbWF4VG9rZW5zUGVyQWRkcmVzcyA9IHVpbnQyNTYoMTAwMCkubXVsKHVpbnQyNTYoMTApKip1aW50MjU2KG1fZGVjaW1hbHMpKTsKCiAgICBtX3RvdGFsU3VwcGx5ID0gdWludDI1NigxMDAwMDAwMDApLm11bCh1aW50MjU2KDEwKSoqdWludDI1NihtX2RlY2ltYWxzKSk7CiAgICAvLyA3MCUgZm9yIG93bmVyCiAgICBtX2JhbGFuY2VzW21zZy5zZW5kZXJdID0gbV90b3RhbFN1cHBseS5tdWwodWludDI1Nig3MCkpLmRpdih1aW50MjU2KDEwMCkpOwogICAgLy8gMzAlIGZvciBzYWxlCiAgICBtX2JhbGFuY2VzW2FkZHJlc3ModGhpcyldID0gbV90b3RhbFN1cHBseS5zdWIobV9iYWxhbmNlc1ttc2cuc2VuZGVyXSk7CgogICAgLy8gYWxsb3cgb3duZXIgdG8gdHJhbnNmZXIgdG9rZW4gZnJvbSB0aGlzICAKICAgIG1fYWxsb3dlZFthZGRyZXNzKHRoaXMpXVttX293bmVyXSA9IG1fYmFsYW5jZXNbYWRkcmVzcyh0aGlzKV07CiAgICByZXR1cm4gdHJ1ZTsKICB9CgovLy8vLy8vLy8vLy8vLy8vLy8vCi8vIEVSQzIwIE1ldGhvZHMKLy8gZ2V0IGZyb20gaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXBwZWxpbi1zb2xpZGl0eS90cmVlL21hc3Rlci9jb250cmFjdHMvdG9rZW4vRVJDMjAKLy8KICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIG93bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gbV9iYWxhbmNlc1tvd25lcl07CiAgfQogIAogIC8qKgogICogQGRldiBUaGUgbmFtZSBvZiB0aGUgdG9rZW4uCiAgKiBAcmV0dXJuIFRoZSBuYW1lIG9mIHRoZSB0b2tlbi4KICAqLwogIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBtX25hbWU7CiAgfQoKICAvKioKICAqIEBkZXYgVGhlIHN5bWJvbCBvZiB0aGUgdG9rZW4uCiAgKiBAcmV0dXJuIFRoZSBzeW1ib2wgb2YgdGhlIHRva2VuLgogICovCiAgZnVuY3Rpb24gc3ltYm9sKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nKSB7CiAgICByZXR1cm4gbV9zeW1ib2w7CiAgfQoKICAvKioKICAqIEBkZXYgVGhlIG51bWJlciBvZiBkZWNpbWFscyB0aGUgdG9rZW4uCiAgKiBAcmV0dXJuIFRoZSBudW1iZXIgb2YgZGVjaW1hbHMgdGhlIHRva2VuLgogICogQG5vdGljZSBVc2VzIC0gZS5nLiA4LCBtZWFucyB0byBkaXZpZGUgdGhlIHRva2VuLgogICogYW1vdW50IGJ5IDEwMDAwMDAwMCB0byBnZXQgaXRzIHVzZXIgcmVwcmVzZW50YXRpb24uCiAgKi8KICBmdW5jdGlvbiBkZWNpbWFscygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KSB7CiAgICByZXR1cm4gbV9kZWNpbWFsczsKICB9CgogIC8qKgogICogQGRldiBUb3RhbCBudW1iZXIgb2YgdG9rZW5zIGluIGV4aXN0ZW5jZS4KICAqIEByZXR1cm4gVG90YWwgbnVtYmVyIG9mIHRva2VucyBpbiBleGlzdGVuY2UuCiAgKi8KICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBtX3RvdGFsU3VwcGx5OwogIH0KCiAgLyoqCiAgKiBAZGV2IFRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIHRvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIHZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKiBAcmV0dXJuIFdoZXRoZXIgc3VjY2Vzc2Z1bCBvciBub3QuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSAKICAgIHB1YmxpYyAKICAgIG9ubHlPd25lck9yQXRTdGF0ZShTdGF0ZS5QdWJsaWNVc2UpCiAgICB2YWxpZFJlY2lwaWVudCh0bykKICAgIHJldHVybnMgKGJvb2wpIAogIHsKICAgIC8vIHJlcXVpcmUodmFsdWUgPD0gbV9iYWxhbmNlc1ttc2cuc2VuZGVyXSk7CiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCBhbHJlYWR5IHRocm93IGlmIHRoaXMgY29uZGl0aW9uIGlzIG5vdCBtZXQKICAgIG1fYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBtX2JhbGFuY2VzW21zZy5zZW5kZXJdLnN1Yih2YWx1ZSk7CiAgICBtX2JhbGFuY2VzW3RvXSA9IG1fYmFsYW5jZXNbdG9dLmFkZCh2YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCB0bywgdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIuCiAgICogQHBhcmFtIGZyb20gQWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tLgogICAqIEBwYXJhbSB0byBBZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvLgogICAqIEBwYXJhbSB2YWx1ZSBVaW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkLgogICAqIEByZXR1cm4gV2hldGhlciBzdWNjZXNzZnVsIG9yIG5vdC4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSAKICAgIHB1YmxpYwogICAgb25seU93bmVyT3JBdFN0YXRlKFN0YXRlLlB1YmxpY1VzZSkKICAgIHZhbGlkUmVjaXBpZW50KHRvKQogICAgcmV0dXJucyAoYm9vbCkgCiAgewogICAgLy8gcmVxdWlyZSh2YWx1ZSA8PSBtX2JhbGFuY2VzW2Zyb21dKTsKICAgIC8vIHJlcXVpcmUodmFsdWUgPD0gbV9hbGxvd2VkW2Zyb21dW21zZy5zZW5kZXJdKTsKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIGFscmVhZHkgdGhyb3cgaWYgdGhpcyBjb25kaXRpb24gaXMgbm90IG1ldAogICAgbV9iYWxhbmNlc1tmcm9tXSA9IG1fYmFsYW5jZXNbZnJvbV0uc3ViKHZhbHVlKTsKICAgIG1fYmFsYW5jZXNbdG9dID0gbV9iYWxhbmNlc1t0b10uYWRkKHZhbHVlKTsKICAgIG1fYWxsb3dlZFtmcm9tXVttc2cuc2VuZGVyXSA9IG1fYWxsb3dlZFtmcm9tXVttc2cuc2VuZGVyXS5zdWIodmFsdWUpOwogICAgVHJhbnNmZXIoZnJvbSwgdG8sIHZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICogQHBhcmFtIHNwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIHZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAqIEByZXR1cm4gV2hldGhlciBzdWNjZXNzZnVsIG9yIG5vdC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgCiAgICBwdWJsaWMKICAgIG9ubHlPd25lck9yQXRTdGF0ZShTdGF0ZS5QdWJsaWNVc2UpCiAgICB2YWxpZFJlY2lwaWVudChzcGVuZGVyKQogICAgcmV0dXJucyAoYm9vbCkgCiAgewogICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2AKICAgIC8vIGFsbG93YW5jZSB0byB6ZXJvIGJ5IGNhbGxpbmcgYGFwcHJvdmUoc3BlbmRlciwwKWAgaWYgaXQgaXMgbm90CiAgICAvLyBhbHJlYWR5IDAgdG8gbWl0aWdhdGUgdGhlIHJhY2UgY29uZGl0aW9uIGRlc2NyaWJlZCBoZXJlOgogICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgIHJlcXVpcmUoKHZhbHVlID09IDApIHx8IChtX2FsbG93ZWRbbXNnLnNlbmRlcl1bc3BlbmRlcl0gPT0gMCkpOwoKICAgIG1fYWxsb3dlZFttc2cuc2VuZGVyXVtzcGVuZGVyXSA9IHZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgc3BlbmRlciwgdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICogQHBhcmFtIG93bmVyIEFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIHNwZW5kZXIgQWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgCiAgICBwdWJsaWMgCiAgICB2aWV3CiAgICByZXR1cm5zICh1aW50MjU2KSAKICB7CiAgICByZXR1cm4gbV9hbGxvd2VkW293bmVyXVtzcGVuZGVyXTsKICB9CiAgCiAgLyoqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtzcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbC4KICAgKgogICAqIEBkZXYgSW5jcmVhc2UgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gYWRkZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBpbmNyZWFzZSB0aGUgYWxsb3dhbmNlIGJ5LgogICAqIEByZXR1cm4gV2hldGhlciBzdWNjZXNzZnVsIG9yIG5vdC4KICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3Mgc3BlbmRlciwgdWludCBhZGRlZFZhbHVlKSAKICAgIHB1YmxpYyAKICAgIG9ubHlPd25lck9yQXRTdGF0ZShTdGF0ZS5QdWJsaWNVc2UpCiAgICB2YWxpZFJlY2lwaWVudChzcGVuZGVyKQogICAgcmV0dXJucyAoYm9vbCkgCiAgewogICAgbV9hbGxvd2VkW21zZy5zZW5kZXJdW3NwZW5kZXJdID0gbV9hbGxvd2VkW21zZy5zZW5kZXJdW3NwZW5kZXJdLmFkZChhZGRlZFZhbHVlKTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIHNwZW5kZXIsIG1fYWxsb3dlZFttc2cuc2VuZGVyXVtzcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogICAvKioKICAgKiBBcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW3NwZW5kZXJdID09IDAuIFRvIGRlY3JlbWVudAogICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sLgogICAqCiAgICogQGRldiBEZWNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBzcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBzdWJ0cmFjdGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gZGVjcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKiBAcmV0dXJuIFdoZXRoZXIgc3VjY2Vzc2Z1bCBvciBub3QuCiAgICovCiAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbChhZGRyZXNzIHNwZW5kZXIsIHVpbnQgc3VidHJhY3RlZFZhbHVlKSAKICAgIHB1YmxpYwogICAgb25seU93bmVyT3JBdFN0YXRlKFN0YXRlLlB1YmxpY1VzZSkKICAgIHZhbGlkUmVjaXBpZW50KHNwZW5kZXIpCiAgICByZXR1cm5zIChib29sKSAKICB7CiAgICB1aW50IG9sZFZhbHVlID0gbV9hbGxvd2VkW21zZy5zZW5kZXJdW3NwZW5kZXJdOwogICAgaWYgKHN1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgIG1fYWxsb3dlZFttc2cuc2VuZGVyXVtzcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBtX2FsbG93ZWRbbXNnLnNlbmRlcl1bc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIHNwZW5kZXIsIG1fYWxsb3dlZFttc2cuc2VuZGVyXVtzcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgovLy8vLy8vLy8vLy8vLy8vLy8vCi8vIEVSQzY3NyBNZXRob2RzCi8vCiAgLyoqCiAgKiBAZGV2IFRyYW5zZmVyIHRva2VuIHRvIGEgY29udHJhY3QgYWRkcmVzcyB3aXRoIGFkZGl0aW9uYWwgZGF0YSBpZiB0aGUgcmVjaXBpZW50IGlzIGEgY29udGFjdC4KICAqIEBwYXJhbSB0byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSB2YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICogQHBhcmFtIGV4dHJhRGF0YSBUaGUgZXh0cmEgZGF0YSB0byBiZSBwYXNzZWQgdG8gdGhlIHJlY2VpdmluZyBjb250cmFjdC4KICAqIEByZXR1cm4gV2hldGhlciBzdWNjZXNzZnVsIG9yIG5vdC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyQW5kQ2FsbChhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlLCBieXRlcyBleHRyYURhdGEpIAogICAgcHVibGljCiAgICBvbmx5T3duZXJPckF0U3RhdGUoU3RhdGUuUHVibGljVXNlKQogICAgdmFsaWRSZWNpcGllbnQodG8pCiAgICByZXR1cm5zIChib29sKQogIHsKICAgIC8vIHJlcXVpcmUodmFsdWUgPD0gbV9iYWxhbmNlc1ttc2cuc2VuZGVyXSk7CiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBtX2JhbGFuY2VzW21zZy5zZW5kZXJdID0gbV9iYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIodmFsdWUpOwogICAgbV9iYWxhbmNlc1t0b10gPSBtX2JhbGFuY2VzW3RvXS5hZGQodmFsdWUpOwogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgdG8sIHZhbHVlKTsKICAgIGlmIChpc0NvbnRyYWN0KHRvKSkgewogICAgICBjb250cmFjdEZhbGxiYWNrKHRvLCB2YWx1ZSwgZXh0cmFEYXRhKTsKICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgdG8sIHZhbHVlLCBleHRyYURhdGEpOwogICAgfQogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gYWxsIHRva2VucyB0byBhIGNvbnRyYWN0IGFkZHJlc3Mgd2l0aCBhZGRpdGlvbmFsIGRhdGEgaWYgdGhlIHJlY2lwaWVudCBpcyBhIGNvbnRhY3QuCiAgKiBAcGFyYW0gdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgYWxsIHRvLgogICogQHBhcmFtIGV4dHJhRGF0YSBUaGUgZXh0cmEgZGF0YSB0byBiZSBwYXNzZWQgdG8gdGhlIHJlY2VpdmluZyBjb250cmFjdC4KICAqIEByZXR1cm4gV2hldGhlciBzdWNjZXNzZnVsIG9yIG5vdC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyQWxsQW5kQ2FsbChhZGRyZXNzIHRvLCBieXRlcyBleHRyYURhdGEpIAogICAgZXh0ZXJuYWwKICAgIG9ubHlPd25lck9yQXRTdGF0ZShTdGF0ZS5QdWJsaWNVc2UpCiAgICByZXR1cm5zIChib29sKSAKICB7CiAgICByZXR1cm4gdHJhbnNmZXJBbmRDYWxsKHRvLCBtX2JhbGFuY2VzW21zZy5zZW5kZXJdLCBleHRyYURhdGEpOwogIH0KICAKICAvKioKICAqIEBkZXYgQ2FsbCBFUkM2NzcgdG9rZW5GYWxsYmFjayBmb3IgRVJDNjc3UmVjaXBpZW50IGNvbnRyYWN0LgogICogQHBhcmFtIHRvIFRoZSBhZGRyZXNzIG9mIEVSQzY3N1JlY2lwaWVudC4KICAqIEBwYXJhbSB2YWx1ZSBBbW91bnQgb2YgdG9rZW5zIHdpdGggd2FzIHNlbmRlZAogICogQHBhcmFtIGRhdGEgU2VuZGVkIHRvIEVSQzY3N1JlY2lwaWVudC4KICAqIEByZXR1cm4gV2hldGhlciBjb250cmFjdCBvciBub3QuCiAgKi8KICBmdW5jdGlvbiBjb250cmFjdEZhbGxiYWNrKGFkZHJlc3MgdG8sIHVpbnQgdmFsdWUsIGJ5dGVzIGRhdGEpCiAgICBpbnRlcm5hbAogIHsKICAgIEVSQzY3N1JlY2lwaWVudCByZWNpcGllbnQgPSBFUkM2NzdSZWNpcGllbnQodG8pOwogICAgcmVjaXBpZW50LnRva2VuRmFsbGJhY2sobXNnLnNlbmRlciwgdmFsdWUsIGRhdGEpOwogIH0KCiAgLyoqCiAgKiBAZGV2IENoZWNrIGFkZHIgaWYgaXMgY29udHJhY3QuCiAgKiBAcGFyYW0gYWRkciBUaGUgYWRkcmVzcyB0aGF0IGNoZWNraW5nLgogICogQHJldHVybiBXaGV0aGVyIGNvbnRyYWN0IG9yIG5vdC4KICAqLwogIGZ1bmN0aW9uIGlzQ29udHJhY3QoYWRkcmVzcyBhZGRyKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgIHVpbnQgbGVuZ3RoOwogICAgYXNzZW1ibHkgeyBsZW5ndGggOj0gZXh0Y29kZXNpemUoYWRkcikgfQogICAgcmV0dXJuIGxlbmd0aCA+IDA7CiAgfQogIAogIAovLy8vLy8vLy8vLy8vLy8vLy8vCi8vIHBheWFibGUgTWV0aG9kcwovLyB1c2Ugd2l0aGRyYXdhbCBwYXR0ZXJuIAovLyBzZWU6IGh0dHA6Ly9zb2xpZGl0eS5yZWFkdGhlZG9jcy5pby9lbi9kZXZlbG9wL2NvbW1vbi1wYXR0ZXJucy5odG1sI3dpdGhkcmF3YWwtZnJvbS1jb250cmFjdHMKLy8gc2VlOiBodHRwczovL2NvbnNlbnN5cy5naXRodWIuaW8vc21hcnQtY29udHJhY3QtYmVzdC1wcmFjdGljZXMva25vd25fYXR0YWNrcy8KLy8KICAvKioKICAqIFJlY2l2ZWQgRVRIIGNvbnZlcnRlZCB0byB0b2tlbnMgYW1vdW50IGZvciBwcmljZS4gc2VuZGVyIGhhcyBtYXggbGltaXQgZm9yIHRva2VucyAKICAqIGFtb3VudCBhcyBtX21heFRva2Vuc1BlckFkZHJlc3MgLSBiYWxhbmNlT2Yoc2VuZGVyKS4gaWYgYW1vdW50IDw9IG1heCBsaW1pdAogICogdGhlbiB0cmFuc2ZlciBhbW91bnQgZnJvbSB0aGlzIHRvIHNlbmRlciBhbmQgOTUlRVRIIHRvIGJhbmssIDUlRVRIIHRvIG93bmVyLgogICogZWxzZSBhbW91bnQgPiBtYXggbGltaXQgdGhlbiB3ZSBjYWxjIGNvc3Qgb2YgbWF4IGxpbWl0IG9mIHRva2VucywKICAqIHN0b3JlIHRoaXMgY29zdCBpbiBtX3BlbmRpbmdXaXRoZHJhd2Fsc1tzZW5kZXJdIGFuZCBtX215RGVidEluV2VpIGFuZCAKICAqIHRyYW5zZmVyIG1heCBsaW1pdCBvZiB0b2tlbnMgZnJvbSB0aGlzIHRvIHNlbmRlciBhbmQgOTUlIG1heCBsaW1pdCBjb3N0IHRvIGJhbmsKICAqIDUlIG1heCBsaW1pdCBjb3N0IHRvIG93bmVyLgogICoKICAqIEBkZXYgQ29udHJhY3QgcmVjZWl2ZSBFVEggKHBheWFibGUpIGZyb20gc2VuZGVyIGFuZCB0cmFuc2ZlciBzb21lIGFtb3VudCBvZiB0b2tlbnMgdG8gaGltLgogICovCiAgZnVuY3Rpb24gYnlUb2tlbnMoKSBwdWJsaWMgcGF5YWJsZSBhdFN0YXRlKFN0YXRlLlNhbGUpIHsKICAgIC8vIGNoZWNrIGlmIG1zZy5zZW5kZXIgY2FuIHRvIGJ5IHRva2VucyAKICAgIHJlcXVpcmUobV9iYWxhbmNlc1ttc2cuc2VuZGVyXSA8IG1fbWF4VG9rZW5zUGVyQWRkcmVzcyk7CgogICAgLy8gZ2V0IGFjdHVhbCB0b2tlbiBwcmljZSBhbmQgc2V0IGl0CiAgICBtX3Rva2VuUHJpY2VJbldlaSA9IGNhbGNUb2tlblByaWNlSW5XZWkoKTsKICAgIAogICAgLy8gY2hlY2sgaWYgbXNnLnZhbHVlIGhhcyBlbm91Z2ggZm9yIGJ5IDEgdG9rZW4KICAgIHJlcXVpcmUobXNnLnZhbHVlID49IG1fdG9rZW5QcmljZUluV2VpKTsKICAgIAogICAgLy8gY2FsYyBtYXggYXZhaWxhYmxlIHRva2VucyBmb3Igc2VuZGVyCiAgICB1aW50MjU2IG1heEF2YWlsYWJsZVRva2VucyA9IG1fbWF4VG9rZW5zUGVyQWRkcmVzcy5zdWIobV9iYWxhbmNlc1ttc2cuc2VuZGVyXSk7CiAgICAKICAgIC8vIGNvbnZlcnQgbXNnLnZhbHVlKHdlaSkgdG8gdG9rZW5zCiAgICB1aW50MjU2IHRva2Vuc0Ftb3VudCA9IHdlaVRvVG9rZW5zKG1zZy52YWx1ZSwgbV90b2tlblByaWNlSW5XZWkpOwogICAgCiAgICBpZiAodG9rZW5zQW1vdW50ID4gbWF4QXZhaWxhYmxlVG9rZW5zKSB7CiAgICAgIC8vIHdlIENBTlQgdHJhbnNmZXIgYWxsIHRva2VucyBhbW91bnQsIE9OTFkgbWF4IGF2YWlsYWJsZSB0b2tlbnMgCiAgICAgIC8vIGNhbGMgY29zdCBpbiB3ZWkgb2YgbWF4IGF2YWlsYWJsZSB0b2tlbnMKICAgICAgLy8gc3VidHJhY3QgY29zdCBmcm9tIG1zZy52YWx1ZSBhbmQgc3RvcmUgaXQgYXMgZGVidCBmb3Igc2VuZGVyCiAgICAgIHRva2Vuc0Ftb3VudCA9IG1heEF2YWlsYWJsZVRva2VuczsgIAogICAgICAvLyBjYWxjIGNvc3QKICAgICAgdWludDI1NiB0b2tlbnNBbW91bnRDb3N0SW5XZWkgPSB0b2tlbnNUb1dlaSh0b2tlbnNBbW91bnQsIG1fdG9rZW5QcmljZUluV2VpKTsKICAgICAgLy8gY2FsYyBkZWJ0CiAgICAgIHVpbnQyNTYgZGVidCA9IG1zZy52YWx1ZS5zdWIodG9rZW5zQW1vdW50Q29zdEluV2VpKTsKICAgICAgLy8gV2l0aGRyYXdhbCBwYXR0ZXJuIGF2b2lkIFJlLUVudHJhbmN5IChkb250IHVzZSB0cmFuc2ZlciB0byB1bmtub3cgYWRkcmVzcykKICAgICAgLy8gdXBkYXRlIHBlbmRpbmcgd2l0aGRyYXdhbHMKICAgICAgbV9wZW5kaW5nV2l0aGRyYXdhbHNbbXNnLnNlbmRlcl0gPSBtX3BlbmRpbmdXaXRoZHJhd2Fsc1ttc2cuc2VuZGVyXS5hZGQoZGVidCk7CiAgICAgIC8vIHVwZGF0ZSBteSBkZWJ0CiAgICAgIG1fbXlEZWJ0SW5XZWkgPSBtX215RGVidEluV2VpLmFkZChkZWJ0KTsKICAgIH0KICAgIC8vIHRyYW5zZmVyIHRva2Vuc0Ftb3VudCB0b2tlbnMgZm9ybSB0aGlzIHRvIHNlbmRlcgogICAgLy8gU2FmZU1hdGguc3ViIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0CiAgICBtX2JhbGFuY2VzW2FkZHJlc3ModGhpcyldID0gbV9iYWxhbmNlc1thZGRyZXNzKHRoaXMpXS5zdWIodG9rZW5zQW1vdW50KTsKICAgIG1fYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBtX2JhbGFuY2VzW21zZy5zZW5kZXJdLmFkZCh0b2tlbnNBbW91bnQpOwoKICAgIC8vIHdlIGNhbiB0cmFuc2ZlciBldGggdG8gb3duZXIgYW5kIGJhbmssIGJlY2F1c2Ugd2Uga25vdyB0aGF0IHRoZXkgCiAgICAvLyBkb250IHVzZSBSZS1FbnRyYW5jeSBhbmQgb3RoZXIgYXR0YWNrcy4KICAgIC8vIHRyYW5zZmVyIDUlIG9mIGVodC1teURlYnQgdG8gb3duZXIKICAgIC8vIG93bmVyIGNhbnQgYmUgZXF1YWwgYWRkcmVzcygwKSBiZWNhdXNlIHRoaXMgZnVuY3Rpb24gdG8gYmUgYWNjZXNzaWJsZQogICAgLy8gb25seSBpbiBTdGF0ZS5TYWxlIGJ1dCBvd25lciBjYW4gYmUgZXF1YWwgYWRkcmVzcygwKSwgb25seSBpbiBTdGF0ZS5QdWJsaWNVc2UKICAgIC8vIFN0YXRlLlNhbGUgbm90IGVxdWFsIFN0YXRlLlB1YmxpY1VzZSEKICAgIG1fb3duZXIudHJhbnNmZXIodGhpcy5iYWxhbmNlLnN1YihtX215RGVidEluV2VpKS5tdWwodWludDI1Nig1KSkuZGl2KHVpbnQyNTYoMTAwKSkpOwogICAgLy8gdHJhbnNmZXIgOTUlIG9mIGVodC1teURlYnQgdG8gYmFuawogICAgLy8gYmFuayBjYW50IGJlIGVxdWFsIGFkZHJlc3MoMCkgc2VlIHNldEJhbmsoKSBhbmQgUG9uemlUb2tlbigpCiAgICBtX2JhbmsudHJhbnNmZXIodGhpcy5iYWxhbmNlLnN1YihtX215RGVidEluV2VpKSk7CiAgICBjaGVja1ZhbGlkaXR5T2ZCYWxhbmNlKCk7IC8vIHRoaXMuYmFsYW5jZSA+PSBtX215RGVidEluV2VpCiAgICBUcmFuc2ZlcihhZGRyZXNzKHRoaXMpLCBtc2cuc2VuZGVyLCB0b2tlbnNBbW91bnQpOwogICAgVG9rZW5zU29sZCh0b2tlbnNBbW91bnQsIG1zZy5zZW5kZXIsIG1fdG9rZW5QcmljZUluV2VpKTsgCiAgfQogIAogIC8qKgogICogQGRldiBTZW5kZXIgcmVjZWl2ZSBoaXMgcGVuZGluZyB3aXRoZHJhd2FscyhpZiA+IDApLgogICovCiAgZnVuY3Rpb24gd2l0aGRyYXcoKSBleHRlcm5hbCB7CiAgICB1aW50IGFtb3VudCA9IG1fcGVuZGluZ1dpdGhkcmF3YWxzW21zZy5zZW5kZXJdOwogICAgcmVxdWlyZShhbW91bnQgPiAwKTsKICAgIC8vIHNldCB6ZXJvIHRoZSBwZW5kaW5nIHJlZnVuZCBiZWZvcmUKICAgIC8vIHNlbmRpbmcgdG8gcHJldmVudCBSZS1FbnRyYW5jeSAKICAgIG1fcGVuZGluZ1dpdGhkcmF3YWxzW21zZy5zZW5kZXJdID0gMDsKICAgIG1fbXlEZWJ0SW5XZWkgPSBtX215RGVidEluV2VpLnN1YihhbW91bnQpOwogICAgbXNnLnNlbmRlci50cmFuc2ZlcihhbW91bnQpOwogICAgY2hlY2tWYWxpZGl0eU9mQmFsYW5jZSgpOyAvLyB0aGlzLmJhbGFuY2UgPj0gbV9teURlYnRJbldlaQogICAgV2l0aGRyYXdhbChtc2cuc2VuZGVyLCBhbW91bnQpOwogIH0KCiAgLyoqCiAgKiBAbm90aWNlIGh0dHA6Ly9zb2xpZGl0eS5yZWFkdGhlZG9jcy5pby9lbi9kZXZlbG9wL2NvbnRyYWN0cy5odG1sI2ZhbGxiYWNrLWZ1bmN0aW9uCiAgKiB3ZSBkb250IG5lZWQgcmVjaWV2ZSBFVEggYWx3YXlzLCBvbmx5IGluIFN0YXRlLlNhbGUgZnJvbSBleHRlcm5hbGx5IGFjY291bnRzLgogICoKICAqIEBkZXYgRmFsbGJhY2sgZnVuYywgY2FsbCBieVRva2VucygpLgogICovCiAgZnVuY3Rpb24oKSBwdWJsaWMgcGF5YWJsZSBhdFN0YXRlKFN0YXRlLlNhbGUpIHsKICAgIGJ5VG9rZW5zKCk7CiAgfQogICAgCiAgCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwovLyBleHRlcm5hbCB2aWV3IG1ldGhvZHMKLy8gZXZlcnlvbmUgb3V0c2lkZSBoYXMgYWNjZXNzIAovLwogIC8qKgogICogQGRldiBHZXRzIHRoZSBwZW5kaW5nIHdpdGhkcmF3YWxzIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBvd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgcGVuZGluZyB3aXRoZHJhd2FscyBvZi4KICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCB3aXRoZHJhd2FscyBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgKi8KICBmdW5jdGlvbiBwZW5kaW5nV2l0aGRyYXdhbHMoYWRkcmVzcyBvd25lcikgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gbV9wZW5kaW5nV2l0aGRyYXdhbHNbb3duZXJdOwogIH0KICAKICAvKioKICAqIEBkZXYgR2V0IGNvbnRyYWN0IHdvcmsgc3RhdGUuCiAgKiBAcmV0dXJuIENvbnRyYWN0IHdvcmsgc3RhdGUgdmlhIHN0cmluZy4KICAqLwogIGZ1bmN0aW9uIHN0YXRlKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChzdHJpbmcgc3RhdGVTdHJpbmcpIHsKICAgIGlmIChtX3N0YXRlID09IFN0YXRlLlByZVNhbGUpIHsKICAgICAgc3RhdGVTdHJpbmcgPSBQUkVfU0FMRV9TVFI7CiAgICB9IGVsc2UgaWYgKG1fc3RhdGUgPT0gU3RhdGUuU2FsZSkgewogICAgICBzdGF0ZVN0cmluZyA9IFNBTEVfU1RSOwogICAgfSBlbHNlIGlmIChtX3N0YXRlID09IFN0YXRlLlB1YmxpY1VzZSkgewogICAgICBzdGF0ZVN0cmluZyA9IFBVQkxJQ19VU0VfU1RSOwogICAgfQogIH0KICAKICAvKioKICAqIEBkZXYgR2V0IHByaWNlIG9mIG9uZSB0b2tlbiBpbiB3ZWkuCiAgKiBAcmV0dXJuIFByaWNlIG9mIG9uZSB0b2tlbiBpbiB3ZWkuCiAgKi8KICBmdW5jdGlvbiB0b2tlblByaWNlSW5XZWkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gY2FsY1Rva2VuUHJpY2VJbldlaSgpOwogIH0KICAKICAvKioKICAqIEBkZXYgR2V0IGFkZHJlc3Mgb2YgdGhlIGJhbmsuCiAgKiBAcmV0dXJuIEFkZHJlc3Mgb2YgdGhlIGJhbmsuIAogICovCiAgZnVuY3Rpb24gYmFuaygpIGV4dGVybmFsIHZpZXcgcmV0dXJucyhhZGRyZXNzKSB7CiAgICByZXR1cm4gbV9iYW5rOwogIH0KICAKICAvKioKICAqIEBkZXYgR2V0IHRpbWVzdGFtcCBvZiBmaXJzdCBlbnRyYW5jZSB0byBzYWxlIHN0YXRlLgogICogQHJldHVybiBUaW1lc3RhbXAgb2YgZmlyc3QgZW50cmFuY2UgdG8gc2FsZSBzdGF0ZS4KICAqLwogIGZ1bmN0aW9uIGZpcnN0RW50cmFuY2VUb1NhbGVTdGF0ZVVOSVgoKSAKICAgIGV4dGVybmFsCiAgICB2aWV3IAogICAgcmV0dXJucyh1aW50MjU2KSAKICB7CiAgICByZXR1cm4gbV9maXJzdEVudHJhbmNlVG9TYWxlU3RhdGVVTklYOwogIH0KICAKICAvKioKICAqIEBkZXYgR2V0IGFkZHJlc3Mgb2YgdGhlIHByaWNlIHNldHRlci4KICAqIEByZXR1cm4gQWRkcmVzcyBvZiB0aGUgcHJpY2Ugc2V0dGVyLgogICovCiAgZnVuY3Rpb24gcHJpY2VTZXR0ZXIoKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGFkZHJlc3MpIHsKICAgIHJldHVybiBtX3ByaWNlU2V0dGVyOwogIH0KCi8vLy8vLy8vLy8vLy8vLy8vLy8vCi8vIHB1YmxpYyBtZXRob2RzCi8vIG9ubHkgZm9yIG93bmVyCi8vCiAgLyoqCiAgKiBAZGV2IE93bmVyIGRvIGRpc293bi4KICAqLyAKICBmdW5jdGlvbiBkaXNvd24oKSBleHRlcm5hbCBhdFN0YXRlKFN0YXRlLlB1YmxpY1VzZSkgb25seU93bmVyKCkgewogICAgZGVsZXRlIG1fb3duZXI7CiAgfQogIAogIC8qKgogICogQGRldiBTZXQgc3RhdGUgb2YgY29udHJhY3Qgd29ya2luZy4KICAqIEBwYXJhbSBuZXdTdGF0ZSBTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgbmV3IHN0YXRlLgogICovIAogIGZ1bmN0aW9uIHNldFN0YXRlKHN0cmluZyBuZXdTdGF0ZSkgCiAgICBleHRlcm5hbCAKICAgIG9ubHlPd25lcigpCiAgICBjaGVja0FjY2VzcygpCiAgewogICAgaWYgKGtlY2NhazI1NihuZXdTdGF0ZSkgPT0ga2VjY2FrMjU2KFBSRV9TQUxFX1NUUikpIHsKICAgICAgbV9zdGF0ZSA9IFN0YXRlLlByZVNhbGU7CiAgICB9IGVsc2UgaWYgKGtlY2NhazI1NihuZXdTdGF0ZSkgPT0ga2VjY2FrMjU2KFNBTEVfU1RSKSkgewogICAgICBpZiAobV9maXJzdEVudHJhbmNlVG9TYWxlU3RhdGVVTklYID09IDApIAogICAgICAgIG1fZmlyc3RFbnRyYW5jZVRvU2FsZVN0YXRlVU5JWCA9IG5vdzsKICAgICAgICAKICAgICAgbV9zdGF0ZSA9IFN0YXRlLlNhbGU7CiAgICB9IGVsc2UgaWYgKGtlY2NhazI1NihuZXdTdGF0ZSkgPT0ga2VjY2FrMjU2KFBVQkxJQ19VU0VfU1RSKSkgewogICAgICBtX3N0YXRlID0gU3RhdGUuUHVibGljVXNlOwogICAgfSBlbHNlIHsKICAgICAgLy8gaWYgbmV3U3RhdGUgbm90IHZhbGlkIHN0cmluZwogICAgICByZXZlcnQoKTsKICAgIH0KICAgIFN0YXRlQ2hhbmdlZChtc2cuc2VuZGVyLCBtX3N0YXRlKTsKICB9CgogIC8qKgogICogSWYgdG9rZW4gcHJpY2Ugbm90IGZpeCB0aGVuIGFjdHVhbCBwcmljZSAKICAqIGFsd2F5cyB3aWxsIGJlIHRva2VuUHJpY2VJbldlaUZvckRheShkYXkpLgogICoKICAqIEBkZXYgU2V0IHByaWNlIG9mIG9uZSB0b2tlbiBpbiB3ZWkgYW5kIGZpeCBpdC4KICAqIEBwYXJhbSBuZXdUb2tlblByaWNlSW5XZWkgUHJpY2Ugb2Ygb25lIHRva2VuIGluIHdlaS4KICAqLyAKICBmdW5jdGlvbiBzZXRBbmRGaXhUb2tlblByaWNlSW5XZWkodWludDI1NiBuZXdUb2tlblByaWNlSW5XZWkpIAogICAgZXh0ZXJuYWwKICAgIGNoZWNrQWNjZXNzKCkKICB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gbV9vd25lciB8fCBtc2cuc2VuZGVyID09IG1fcHJpY2VTZXR0ZXIpOwogICAgbV9pc0ZpeGVkVG9rZW5QcmljZSA9IHRydWU7CiAgICBtX3Rva2VuUHJpY2VJbldlaSA9IG5ld1Rva2VuUHJpY2VJbldlaTsKICAgIFByaWNlQ2hhbmdlZChtc2cuc2VuZGVyLCBtX3Rva2VuUHJpY2VJbldlaSwgbV9pc0ZpeGVkVG9rZW5QcmljZSk7CiAgfQogIAogIC8qKgogICogSWYgdG9rZW4gcHJpY2UgaXMgdW5maXhlZCB0aGVuIGFjdHVhbCB3aWxsIGJlIHRva2VuUHJpY2VJbldlaUZvckRheShkYXkpLgogICogCiAgKiBAZGV2IFNldCB1bmZpeCB0b2tlbiBwcmljZSB0byB0cnVlLgogICovCiAgZnVuY3Rpb24gdW5maXhUb2tlblByaWNlSW5XZWkoKSAKICAgIGV4dGVybmFsCiAgICBjaGVja0FjY2VzcygpCiAgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG1fb3duZXIgfHwgbXNnLnNlbmRlciA9PSBtX3ByaWNlU2V0dGVyKTsKICAgIG1faXNGaXhlZFRva2VuUHJpY2UgPSBmYWxzZTsKICAgIFByaWNlQ2hhbmdlZChtc2cuc2VuZGVyLCBtX3Rva2VuUHJpY2VJbldlaSwgbV9pc0ZpeGVkVG9rZW5QcmljZSk7CiAgfQogIAogIC8qKgogICogQGRldiBTZXQgdGhlIFByaWNlU2V0dGVyIGFkZHJlc3MsIHdoaWNoIGhhcyBhY2Nlc3MgdG8gc2V0IG9uZSB0b2tlbiBwcmljZSBpbiB3ZWkuCiAgKiBAcGFyYW0gbmV3UHJpY2VTZXR0ZXIgVGhlIGFkZHJlc3Mgb2YgbmV3IFByaWNlU2V0dGVyLgogICovCiAgZnVuY3Rpb24gc2V0UHJpY2VTZXR0ZXIoYWRkcmVzcyBuZXdQcmljZVNldHRlcikgCiAgICBleHRlcm5hbCAKICAgIG9ubHlPd25lcigpIAogICAgY2hlY2tBY2Nlc3MoKQogIHsKICAgIG1fcHJpY2VTZXR0ZXIgPSBuZXdQcmljZVNldHRlcjsKICB9CgogIC8qKgogICogQGRldiBTZXQgdGhlIGJhbmssIHdoaWNoIHJlY2VpdmUgOTUlRVRIIGZyb20gdG9rZW5zIHNhbGUuCiAgKiBAcGFyYW0gbmV3QmFuayBUaGUgYWRkcmVzcyBvZiBuZXcgYmFuay4KICAqLwogIGZ1bmN0aW9uIHNldEJhbmsoYWRkcmVzcyBuZXdCYW5rKSAKICAgIGV4dGVybmFsCiAgICB2YWxpZFJlY2lwaWVudChuZXdCYW5rKSAKICAgIG9ubHlPd25lcigpCiAgICBjaGVja0FjY2VzcygpCiAgewogICAgcmVxdWlyZShuZXdCYW5rICE9IGFkZHJlc3MoMCkpOwogICAgbV9iYW5rID0gbmV3QmFuazsKICB9CgovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KLy8gaW50ZXJuYWwgcHVyZSBtZXRob2RzCi8vCiAgLyoqCiAgKiBAZGV2IENvbnZlcnQgdG9rZW4gdG8gd2VpLgogICogQHBhcmFtIHRva2Vuc0Ftb3VudCBBbW91dCBvZiB0b2tlbnMuCiAgKiBAcGFyYW0gdG9rZW5QcmljZSBPbmUgdG9rZW4gcHJpY2UgaW4gd2VpLgogICogQHJldHVybiB3ZWlBbW91bnQgUmVzdWx0IGFtb3VudCBvZiBjb252ZXJ0YXRpb24uIAogICovCiAgZnVuY3Rpb24gdG9rZW5zVG9XZWkodWludDI1NiB0b2tlbnNBbW91bnQsIHVpbnQyNTYgdG9rZW5QcmljZSkgCiAgICBpbnRlcm5hbAogICAgcHVyZQogICAgcmV0dXJucyh1aW50MjU2IHdlaUFtb3VudCkKICB7CiAgICB3ZWlBbW91bnQgPSB0b2tlbnNBbW91bnQubXVsKHRva2VuUHJpY2UpOyAKICB9CiAgCiAgLyoqCiAgKiBAZGV2IENvbnZlciB3ZWkgdG8gdG9rZW4uCiAgKiBAcGFyYW0gd2VpQW1vdW50IFdlaSBhbW91dC4KICAqIEBwYXJhbSB0b2tlblByaWNlIE9uZSB0b2tlbiBwcmljZSBpbiB3ZWkuCiAgKiBAcmV0dXJuIHRva2Vuc0Ftb3VudCBSZXN1bHQgYW1vdW50IG9mIGNvbnZlcnRhdGlvbi4KICAqLwogIGZ1bmN0aW9uIHdlaVRvVG9rZW5zKHVpbnQyNTYgd2VpQW1vdW50LCB1aW50MjU2IHRva2VuUHJpY2UpIAogICAgaW50ZXJuYWwgCiAgICBwdXJlIAogICAgcmV0dXJucyh1aW50MjU2IHRva2Vuc0Ftb3VudCkgCiAgewogICAgdG9rZW5zQW1vdW50ID0gd2VpQW1vdW50LmRpdih0b2tlblByaWNlKTsKICB9CiAKLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCi8vIHByaXZhdGUgdmlldyBtZXRob2RzCi8vCiAgLyoqCiAgKiBAZGV2IEdldCBhY3R1YWwgdG9rZW4gcHJpY2UuCiAgKiBAcmV0dXJuIHByaWNlIE9uZSB0b2tlbiBwcmljZSBpbiB3ZWkuIAogICovCiAgZnVuY3Rpb24gY2FsY1Rva2VuUHJpY2VJbldlaSgpIAogICAgcHJpdmF0ZSAKICAgIHZpZXcgCiAgICByZXR1cm5zKHVpbnQyNTYgcHJpY2UpIAogIHsKICAgIGlmIChtX2lzRml4ZWRUb2tlblByaWNlKSB7CiAgICAgIC8vIHByaWNlIGlzIGZpeGVkLCByZXR1cm4gY3VycmVudCB2YWwKICAgICAgcHJpY2UgPSBtX3Rva2VuUHJpY2VJbldlaTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIHByaWNlIG5vdCBmaXhlZCwgd2UgbXVzdCB0byBjYWxjIHByaWNlCiAgICAgIGlmIChtX2ZpcnN0RW50cmFuY2VUb1NhbGVTdGF0ZVVOSVggPT0gMCkgewogICAgICAgIC8vIGlmIGNvbnRyYWN0IGRvbnQgZW50ZXIgdG8gU2FsZVN0YXRlIHRoZW4gcHJpY2UgPSAwIAogICAgICAgIHByaWNlID0gMDsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBjYWxjdWxhdGUgZGF5IGFmdGVyIGZpcnN0IEVudHJhbmNlIFRvIFNhbGUgU3RhdGUKICAgICAgICB1aW50MjU2IGRheSA9IG5vdy5zdWIobV9maXJzdEVudHJhbmNlVG9TYWxlU3RhdGVVTklYKS5kaXYoMSBkYXlzKTsKICAgICAgICAvLyB1c2Ugc3BlY2lhbCBmb3JtdWxhIGZvciBjYWxjdXRhdGlvbiBwcmljZQogICAgICAgIHByaWNlID0gdG9rZW5QcmljZUluV2VpRm9yRGF5KGRheSk7CiAgICAgIH0KICAgIH0gCiAgfQogIAogIC8qKgogICogQGRldiBHZXQgdG9rZW4gcHJpY2UgZm9yIHNwZWNpZmljIGRheSBhZnRlciBzdGFydGluZyBzYWxlIHRva2Vucy4KICAqIEBwYXJhbSBkYXkgU2VjaWZpYyBkYXkuCiAgKiBAcmV0dXJuIHByaWNlIE9uZSB0b2tlbiBwcmljZSBpbiB3ZWkgZm9yIHNwZWNpZmljIGRheS4gCiAgKi8KICBmdW5jdGlvbiB0b2tlblByaWNlSW5XZWlGb3JEYXkodWludDI1NiBkYXkpIAogICAgcHJpdmF0ZSAKICAgIHZpZXcgCiAgICByZXR1cm5zKHVpbnQyNTYgcHJpY2UpCiAgewogICAgLy8gZGF5IDE6ICAgcHJpY2UgMSoxMF4oZGVjaW1hbHMpIFRPS0VOID0gMC4wMDEgRVRICiAgICAvLyAgICAgICAgICBwcmljZSAxIFRPS0VOID0gMSAqIDEwXigtMykgRVRIIC8gMTBeKGRlY2ltYWxzKSwgaW4gRVRICiAgICAvLyAgICAgICAgICBjb252ZXJ0IHRvIHdlaToKICAgIC8vICAgICAgICAgIHByaWNlIDEgVE9LRU4gPSAxICogMTBeKC0zKSAqIHdlaSAqIDEwXigtZGVjaW1hbHMpCiAgICAvLyAgICAgICAgICBwcmljZSAxIFRPS0VOID0gMSAqIDEwXigtMykgKiAxMF4oMTgpICogMTBeKC1kZWNpbWFscykKICAgIC8vICAgICAgICAgIHByaWNlIDEgVE9LRU4gPSAxICogMTBeKDE1KSAqIDEwXigtZGVjaW1hbHMpLCBpbiBXRUkKICAgIAogICAgLy8gZGF5IDI6ICAgcHJpY2UgMSoxMF4oZGVjaW1hbHMpIFRPS0VOID0gMC4wMDIgRVRIOwogICAgLy8gICAgICAgICAgcHJpY2UgMSBUT0tFTiA9IDIgKiAxMF4oMTUpICogMTBeKC1kZWNpbWFscyksIGluIFdFSQogICAgLy8gLi4uCiAgICAvLyBkYXkgMTI6ICBwcmljZSAxKjEwXihkZWNpbWFscykgVE9LRU4gPSAwLjAxMiBFVEg7CiAgICAvLyAgICAgICAgICBwcmljZSAxIFRPS0VOID0gMTIgKiAxMF4oMTUpICogMTBeKC1kZWNpbWFscyksIGluIFdFSQogICAgCiAgICAvLyBkYXkgPjEyOiBwcmljZSAxKjEwXihkZWNpbWFscykgVE9LRU4gPSAwLjAxMiBFVEg7CiAgICAvLyAgICAgICAgICBwcmljZSAxIFRPS0VOID0gMTIgKiAxMF4oMTUpICogMTBeKC1kZWNpbWFscyksIGluIFdFSQoKICAgIC8vIGZyb20gMCB0byAxMSAtIHN1bSBpcyAxMiBkYXlzCiAgICBpZiAoZGF5IDw9IDExKSAKICAgICAgcHJpY2UgPSBkYXkuYWRkKDEpOy8vIGJlY2F1c2UgZnJvbSA+MGggdG8gPDI0aCBhZnRlciBzdGFydCBkYXkgd2lsbCBiZSAwLCAKICAgIGVsc2UgICAgICAgICAgICAgICAgIC8vIGJ1dCBmb3IgY2FsYyBwcmljZSBpdCBtdXN0IGJlIDE7CiAgICAgIHByaWNlID0gMTI7CiAgICAvLyBjb252ZXJ0IHRvIFdFSQogICAgcHJpY2UgPSBwcmljZS5tdWwodWludDI1NigxMCoqMTUpKS5kaXYoMTAqKnVpbnQyNTYobV9kZWNpbWFscykpOwogIH0KICAKICAvKioKICAqIEBub3RpY2UgSXQgaXMgYWx3YXlzIG11c3QgYmUgdHJ1ZSwgZm9yIGNvcnJlY3Qgd2l0aGRyYXdhbHMgYW5kIHJlY2VpdmVycyBFVEguCiAgKgogICogQ2hlY2sgaWYgdGhpcy5iYWxhbmNlID49IG1fbXlEZWJ0SW5XZWkuCiAgKi8KICBmdW5jdGlvbiBjaGVja1ZhbGlkaXR5T2ZCYWxhbmNlKCkgcHJpdmF0ZSB2aWV3IHsKICAgIC8vIGFzc2VydGlvbiBpcyBub3QgYSBzdHJpY3QgZXF1YWxpdHkgb2YgdGhlIGJhbGFuY2UgYmVjYXVzZSB0aGUgY29udHJhY3QgCiAgICAvLyBjYW4gYmUgZm9yY2libHkgc2VudCBldGhlciB3aXRob3V0IGdvaW5nIHRocm91Z2ggdGhlIGJ5VG9rZW5zKCkgZnVuYy4KICAgIC8vIHNlbGZkZXN0cnVjdCBkb2VzIG5vdCB0cmlnZ2VyIGEgY29udHJhY3QncyBmYWxsYmFjayBmdW5jdGlvbi4gCiAgICAvLyBzZWU6IGh0dHA6Ly9zb2xpZGl0eS5yZWFkdGhlZG9jcy5pby9lbi9kZXZlbG9wL2NvbnRyYWN0cy5odG1sI2ZhbGxiYWNrLWZ1bmN0aW9uCiAgICBhc3NlcnQodGhpcy5iYWxhbmNlID49IG1fbXlEZWJ0SW5XZWkpOwogIH0KfQ=='.
	

]
