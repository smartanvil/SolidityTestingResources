Class {
	#name : #SRTb6fab190f0750a7c3fc683dfc91f624fd90694b5,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTb6fab190f0750a7c3fc683dfc91f624fd90694b5 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTY7Cgpjb250cmFjdCBTYWZlTWF0aCB7CiAgICAgZnVuY3Rpb24gc2FmZU11bCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgICAgICAgdWludCBjID0gYSAqIGI7CiAgICAgICAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgICAgICAgcmV0dXJuIGM7CiAgICAgfQoKICAgICBmdW5jdGlvbiBzYWZlU3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgICBhc3NlcnQoYiA8PSBhKTsKICAgICAgICAgIHJldHVybiBhIC0gYjsKICAgICB9CgogICAgIGZ1bmN0aW9uIHNhZmVBZGQodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgICAgICAgIHVpbnQgYyA9IGEgKyBiOwogICAgICAgICAgYXNzZXJ0KGM+PWEgJiYgYz49Yik7CiAgICAgICAgICByZXR1cm4gYzsKICAgICB9Cn0KCi8vIEVSQzIwIHN0YW5kYXJkCi8vIFdlIGRvbid0IHVzZSBFUkMyMyBzdGFuZGFyZApjb250cmFjdCBTdGRUb2tlbiBpcyBTYWZlTWF0aCB7Ci8vIEZpZWxkczoKICAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CiAgICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwogICAgIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5ID0gMDsKCi8vIEV2ZW50czoKICAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsKICAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKCi8vIEZ1bmN0aW9uczoKICAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMoYm9vbCl7CiAgICAgICAgICByZXF1aXJlKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IF92YWx1ZSk7CiAgICAgICAgICByZXF1aXJlKGJhbGFuY2VzW190b10gKyBfdmFsdWUgPiBiYWxhbmNlc1tfdG9dKTsKCiAgICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHNhZmVTdWIoYmFsYW5jZXNbbXNnLnNlbmRlcl0sX3ZhbHVlKTsKICAgICAgICAgIGJhbGFuY2VzW190b10gPSBzYWZlQWRkKGJhbGFuY2VzW190b10sX3ZhbHVlKTsKCiAgICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICB9CgogICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMoYm9vbCl7CiAgICAgICAgICByZXF1aXJlKGJhbGFuY2VzW19mcm9tXSA+PSBfdmFsdWUpOwogICAgICAgICAgcmVxdWlyZShhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUpOwogICAgICAgICAgcmVxdWlyZShiYWxhbmNlc1tfdG9dICsgX3ZhbHVlID4gYmFsYW5jZXNbX3RvXSk7CgogICAgICAgICAgYmFsYW5jZXNbX3RvXSA9IHNhZmVBZGQoYmFsYW5jZXNbX3RvXSxfdmFsdWUpOwogICAgICAgICAgYmFsYW5jZXNbX2Zyb21dID0gc2FmZVN1YihiYWxhbmNlc1tfZnJvbV0sX3ZhbHVlKTsKICAgICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gc2FmZVN1YihhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSxfdmFsdWUpOwoKICAgICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICB9CgogICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICAgfQoKICAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICAgICAgICAvLyBUbyBjaGFuZ2UgdGhlIGFwcHJvdmUgYW1vdW50IHlvdSBmaXJzdCBoYXZlIHRvIHJlZHVjZSB0aGUgYWRkcmVzc2VzYAogICAgICAgICAgLy8gIGFsbG93YW5jZSB0byB6ZXJvIGJ5IGNhbGxpbmcgYGFwcHJvdmUoX3NwZW5kZXIsIDApYCBpZiBpdCBpcyBub3QKICAgICAgICAgIC8vICBhbHJlYWR5IDAgdG8gbWl0aWdhdGUgdGhlIHJhY2UgY29uZGl0aW9uIGRlc2NyaWJlZCBoZXJlOgogICAgICAgICAgLy8gIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICAgICAgICByZXF1aXJlKChfdmFsdWUgPT0gMCkgfHwgKGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID09IDApKTsKCiAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgfQoKICAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgIH0KCiAgICAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgX3NpemUpIHsKICAgICAgICAgIHJlcXVpcmUobXNnLmRhdGEubGVuZ3RoID49IF9zaXplICsgNCk7CiAgICAgICAgICBfOwogICAgIH0KfQoKY29udHJhY3QgTU5UUCBpcyBTdGRUb2tlbiB7Ci8vIEZpZWxkczoKICAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiR29sZG1pbnQgTU5UIFByZWxhdW5jaCBUb2tlbiI7CiAgICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiTU5UUCI7CiAgICAgdWludCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKCiAgICAgYWRkcmVzcyBwdWJsaWMgY3JlYXRvciA9IDB4MDsKICAgICBhZGRyZXNzIHB1YmxpYyBpY29Db250cmFjdEFkZHJlc3MgPSAweDA7CiAgICAgYm9vbCBwdWJsaWMgbG9ja1RyYW5zZmVycyA9IGZhbHNlOwoKICAgICAvLyAxMCBtbG4KICAgICB1aW50IHB1YmxpYyBjb25zdGFudCBUT1RBTF9UT0tFTl9TVVBQTFkgPSAxMDAwMDAwMCAqIDEgZXRoZXI7CgovLy8gTW9kaWZpZXJzOgogICAgIG1vZGlmaWVyIG9ubHlDcmVhdG9yKCkgeyAKICAgICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjcmVhdG9yKTsgCiAgICAgICAgICBfOyAKICAgICB9CgogICAgIG1vZGlmaWVyIGJ5SWNvQ29udHJhY3QoKSB7IAogICAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGljb0NvbnRyYWN0QWRkcmVzcyk7IAogICAgICAgICAgXzsgCiAgICAgfQoKICAgICBmdW5jdGlvbiBzZXRDcmVhdG9yKGFkZHJlc3MgX2NyZWF0b3IpIG9ubHlDcmVhdG9yIHsKICAgICAgICAgIGNyZWF0b3IgPSBfY3JlYXRvcjsKICAgICB9CgovLyBTZXR0ZXJzL0dldHRlcnMKICAgICBmdW5jdGlvbiBzZXRJY29Db250cmFjdEFkZHJlc3MoYWRkcmVzcyBfaWNvQ29udHJhY3RBZGRyZXNzKSBvbmx5Q3JlYXRvciB7CiAgICAgICAgICBpY29Db250cmFjdEFkZHJlc3MgPSBfaWNvQ29udHJhY3RBZGRyZXNzOwogICAgIH0KCi8vIEZ1bmN0aW9uczoKICAgICBmdW5jdGlvbiBNTlRQKCkgewogICAgICAgICAgY3JlYXRvciA9IG1zZy5zZW5kZXI7CgogICAgICAgICAgYXNzZXJ0KFRPVEFMX1RPS0VOX1NVUFBMWSA9PSAxMDAwMDAwMCAqIDEgZXRoZXIpOwogICAgIH0KCiAgICAgLy8vIEBkZXYgT3ZlcnJpZGUKICAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zKGJvb2wpewogICAgICAgICAgcmVxdWlyZSghbG9ja1RyYW5zZmVycyk7CiAgICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLF92YWx1ZSk7CiAgICAgfQoKICAgICAvLy8gQGRldiBPdmVycmlkZQogICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zKGJvb2wpewogICAgICAgICAgcmVxdWlyZSghbG9ja1RyYW5zZmVycyk7CiAgICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLF90byxfdmFsdWUpOwogICAgIH0KCiAgICAgZnVuY3Rpb24gaXNzdWVUb2tlbnMoYWRkcmVzcyBfd2hvLCB1aW50IF90b2tlbnMpIGJ5SWNvQ29udHJhY3QgewogICAgICAgICAgcmVxdWlyZSgodG90YWxTdXBwbHkgKyBfdG9rZW5zKSA8PSBUT1RBTF9UT0tFTl9TVVBQTFkpOwoKICAgICAgICAgIGJhbGFuY2VzW193aG9dID0gc2FmZUFkZChiYWxhbmNlc1tfd2hvXSxfdG9rZW5zKTsKICAgICAgICAgIHRvdGFsU3VwcGx5ID0gc2FmZUFkZCh0b3RhbFN1cHBseSxfdG9rZW5zKTsKCiAgICAgICAgICBUcmFuc2ZlcigweDAsIF93aG8sIF90b2tlbnMpOwogICAgIH0KCiAgICAgLy8gRm9yIHJlZnVuZHMgb25seQogICAgIGZ1bmN0aW9uIGJ1cm5Ub2tlbnMoYWRkcmVzcyBfd2hvLCB1aW50IF90b2tlbnMpIGJ5SWNvQ29udHJhY3QgewogICAgICAgICAgYmFsYW5jZXNbX3dob10gPSBzYWZlU3ViKGJhbGFuY2VzW193aG9dLCBfdG9rZW5zKTsKICAgICAgICAgIHRvdGFsU3VwcGx5ID0gc2FmZVN1Yih0b3RhbFN1cHBseSwgX3Rva2Vucyk7CiAgICAgfQoKICAgICBmdW5jdGlvbiBsb2NrVHJhbnNmZXIoYm9vbCBfbG9jaykgYnlJY29Db250cmFjdCB7CiAgICAgICAgICBsb2NrVHJhbnNmZXJzID0gX2xvY2s7CiAgICAgfQoKICAgICAvLyBEbyBub3QgYWxsb3cgdG8gc2VuZCBtb25leSBkaXJlY3RseSB0byB0aGlzIGNvbnRyYWN0CiAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXZlcnQoKTsKICAgICB9Cn0KCi8vIFRoaXMgY29udHJhY3Qgd2lsbCBob2xkIGFsbCB0b2tlbnMgdGhhdCB3ZXJlIHVuc29sZCBkdXJpbmcgSUNPLgovLwovLyBHb2xkbWludCBUZWFtIHNob3VsZCBiZSBhYmxlIHRvIHdpdGhkcmF3IHRoZW0gYW5kIHNlbGwgb25seSBhZnRlciAxIHllYXIgaXMgcGFzc2VkIGFmdGVyIAovLyBJQ08gaXMgZmluaXNoZWQuCmNvbnRyYWN0IEdvbGRtaW50VW5zb2xkIGlzIFNhZmVNYXRoIHsKICAgICBhZGRyZXNzIHB1YmxpYyBjcmVhdG9yOwogICAgIGFkZHJlc3MgcHVibGljIHRlYW1BY2NvdW50QWRkcmVzczsKICAgICBhZGRyZXNzIHB1YmxpYyBpY29Db250cmFjdEFkZHJlc3M7CiAgICAgdWludDY0IHB1YmxpYyBpY29Jc0ZpbmlzaGVkRGF0ZTsKCiAgICAgTU5UUCBwdWJsaWMgbW50VG9rZW47CgogICAgIGZ1bmN0aW9uIEdvbGRtaW50VW5zb2xkKGFkZHJlc3MgX3RlYW1BY2NvdW50QWRkcmVzcyxhZGRyZXNzIF9tbnRUb2tlbkFkZHJlc3MpewogICAgICAgICAgY3JlYXRvciA9IG1zZy5zZW5kZXI7CiAgICAgICAgICB0ZWFtQWNjb3VudEFkZHJlc3MgPSBfdGVhbUFjY291bnRBZGRyZXNzOwoKICAgICAgICAgIG1udFRva2VuID0gTU5UUChfbW50VG9rZW5BZGRyZXNzKTsgICAgICAgICAgCiAgICAgfQoKICAgICBtb2RpZmllciBvbmx5Q3JlYXRvcigpIHsgCiAgICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXI9PWNyZWF0b3IpOyAKICAgICAgICAgIF87IAogICAgIH0KCiAgICAgbW9kaWZpZXIgb25seUljb0NvbnRyYWN0KCkgeyAKICAgICAgICAgIHJlcXVpcmUobXNnLnNlbmRlcj09aWNvQ29udHJhY3RBZGRyZXNzKTsgCiAgICAgICAgICBfOyAKICAgICB9CgovLyBTZXR0ZXJzL0dldHRlcnMKICAgICBmdW5jdGlvbiBzZXRJY29Db250cmFjdEFkZHJlc3MoYWRkcmVzcyBfaWNvQ29udHJhY3RBZGRyZXNzKSBvbmx5Q3JlYXRvciB7CiAgICAgICAgICBpY29Db250cmFjdEFkZHJlc3MgPSBfaWNvQ29udHJhY3RBZGRyZXNzOwogICAgIH0KCiAgICAgZnVuY3Rpb24gZmluaXNoSWNvKCkgcHVibGljIG9ubHlJY29Db250cmFjdCB7CiAgICAgICAgICBpY29Jc0ZpbmlzaGVkRGF0ZSA9IHVpbnQ2NChub3cpOwogICAgIH0KCiAgICAgLy8gY2FuIGJlIGNhbGxlZCBieSBhbnlvbmUuLi4KICAgICBmdW5jdGlvbiB3aXRoZHJhd1Rva2VucygpIHB1YmxpYyB7CiAgICAgICAgICAvLyBDaGVjayBpZiAxIHllYXIgaXMgcGFzc2VkCiAgICAgICAgICB1aW50NjQgb25lWWVhclBhc3NlZCA9IGljb0lzRmluaXNoZWREYXRlICsgMzY1IGRheXM7ICAKICAgICAgICAgIHJlcXVpcmUodWludChub3cpID49IG9uZVllYXJQYXNzZWQpOwoKICAgICAgICAgIC8vIFRyYW5zZmVyIGFsbCB0b2tlbnMgZnJvbSB0aGlzIGNvbnRyYWN0IHRvIHRoZSB0ZWFtQWNjb3VudEFkZHJlc3MKICAgICAgICAgIHVpbnQgdG90YWwgPSBtbnRUb2tlbi5iYWxhbmNlT2YodGhpcyk7CiAgICAgICAgICBtbnRUb2tlbi50cmFuc2Zlcih0ZWFtQWNjb3VudEFkZHJlc3MsdG90YWwpOwogICAgIH0KCiAgICAgLy8gRG8gbm90IGFsbG93IHRvIHNlbmQgbW9uZXkgZGlyZWN0bHkgdG8gdGhpcyBjb250cmFjdAogICAgIGZ1bmN0aW9uKCkgcGF5YWJsZSB7CiAgICAgICAgICByZXZlcnQoKTsKICAgICB9Cn0KCmNvbnRyYWN0IEZvdW5kZXJzVmVzdGluZyBpcyBTYWZlTWF0aCB7CiAgICAgYWRkcmVzcyBwdWJsaWMgdGVhbUFjY291bnRBZGRyZXNzOwogICAgIHVpbnQ2NCBwdWJsaWMgbGFzdFdpdGhkcmF3VGltZTsKCiAgICAgdWludCBwdWJsaWMgd2l0aGRyYXdzQ291bnQgPSAwOwogICAgIHVpbnQgcHVibGljIGFtb3VudFRvU2VuZCA9IDA7CgogICAgIE1OVFAgcHVibGljIG1udFRva2VuOwoKICAgICBmdW5jdGlvbiBGb3VuZGVyc1Zlc3RpbmcoYWRkcmVzcyBfdGVhbUFjY291bnRBZGRyZXNzLGFkZHJlc3MgX21udFRva2VuQWRkcmVzcyl7CiAgICAgICAgICB0ZWFtQWNjb3VudEFkZHJlc3MgPSBfdGVhbUFjY291bnRBZGRyZXNzOwogICAgICAgICAgbGFzdFdpdGhkcmF3VGltZSA9IHVpbnQ2NChub3cpOwoKICAgICAgICAgIG1udFRva2VuID0gTU5UUChfbW50VG9rZW5BZGRyZXNzKTsgICAgICAgICAgCiAgICAgfQoKICAgICAvLyBDYW4gYmUgY2FsbGVkIGJ5IGFueW9uZQogICAgIGZ1bmN0aW9uIHdpdGhkcmF3VG9rZW5zKCkgcHVibGljIHsKICAgICAgICAgIC8vIDEgLSB3YWl0IGZvciB0aGUgbmV4dCBtb250aAogICAgICAgICAgdWludDY0IG9uZU1vbnRoID0gbGFzdFdpdGhkcmF3VGltZSArIDMwIGRheXM7ICAKICAgICAgICAgIHJlcXVpcmUodWludChub3cpID49IG9uZU1vbnRoKTsKCiAgICAgICAgICAvLyAyIC0gY2FsY3VsYXRlIGFtb3VudCAob25seSBmaXJzdCB0aW1lKQogICAgICAgICAgaWYod2l0aGRyYXdzQ291bnQ9PTApewogICAgICAgICAgICAgICBhbW91bnRUb1NlbmQgPSBtbnRUb2tlbi5iYWxhbmNlT2YodGhpcykgLyAxMDsKICAgICAgICAgIH0KCiAgICAgICAgICByZXF1aXJlKGFtb3VudFRvU2VuZCE9MCk7CgogICAgICAgICAgLy8gMyAtIHNlbmQgMS8xMHRoCiAgICAgICAgICB1aW50IGN1cnJlbnRCYWxhbmNlID0gbW50VG9rZW4uYmFsYW5jZU9mKHRoaXMpOwogICAgICAgICAgaWYoY3VycmVudEJhbGFuY2U8YW1vdW50VG9TZW5kKXsKICAgICAgICAgICAgIGFtb3VudFRvU2VuZCA9IGN1cnJlbnRCYWxhbmNlOyAgCiAgICAgICAgICB9CiAgICAgICAgICBtbnRUb2tlbi50cmFuc2Zlcih0ZWFtQWNjb3VudEFkZHJlc3MsYW1vdW50VG9TZW5kKTsKCiAgICAgICAgICAvLyA0IC0gdXBkYXRlIGNvdW50ZXIKICAgICAgICAgIHdpdGhkcmF3c0NvdW50Kys7CiAgICAgICAgICBsYXN0V2l0aGRyYXdUaW1lID0gdWludDY0KG5vdyk7CiAgICAgfQoKICAgICAvLyBEbyBub3QgYWxsb3cgdG8gc2VuZCBtb25leSBkaXJlY3RseSB0byB0aGlzIGNvbnRyYWN0CiAgICAgZnVuY3Rpb24oKSBwYXlhYmxlIHsKICAgICAgICAgIHJldmVydCgpOwogICAgIH0KfQoKLy8gVGhpcyBpcyB0aGUgbWFpbiBHb2xkbWludCBJQ08gc21hcnQgY29udHJhY3QKY29udHJhY3QgR29sZG1pbnQgaXMgU2FmZU1hdGggewovLyBDb25zdGFudHM6CiAgICAgLy8gVGhlc2UgdmFsdWVzIGFyZSBIQVJEIENPREVEISEhCiAgICAgLy8gRm9yIGV4dHJhIHNlY3VyaXR5IHdlIHNwbGl0IHNpbmdsZSBtdWx0aXNpZyB3YWxsZXQgaW50byAxMCBzZXBhcmF0ZSBtdWx0aXNpZyB3YWxsZXRzCiAgICAgLy8KICAgICAvLyBUT0RPOiBzZXQgcmVhbCBwYXJhbXMgaGVyZQogICAgIGFkZHJlc3NbXSBwdWJsaWMgbXVsdGlzaWdzID0gWwogICAgICAgICAgMHgyN2NlNTY1YjEwNDdjNjI1ODE2NDA2Mjk4M2JiOGJjMjkxN2YxMWQyLAogICAgICAgICAgMHhmYjNhZmM4MTU4OTRlOTFmZTFhYjZlNmVmMzZmODU2NWZiYjkwNGY2LAogICAgICAgICAgMHg3ZTJhN2ExMDUwOTE3N2RiMmE3ZWE0MWU3Mjg3NDNjNGViNDJmNTI4LAogICAgICAgICAgMHgyN2NlNTY1YjEwNDdjNjI1ODE2NDA2Mjk4M2JiOGJjMjkxN2YxMWQyLAogICAgICAgICAgMHhmYjNhZmM4MTU4OTRlOTFmZTFhYjZlNmVmMzZmODU2NWZiYjkwNGY2LAogICAgICAgICAgMHg3ZTJhN2ExMDUwOTE3N2RiMmE3ZWE0MWU3Mjg3NDNjNGViNDJmNTI4LAogICAgICAgICAgMHgyN2NlNTY1YjEwNDdjNjI1ODE2NDA2Mjk4M2JiOGJjMjkxN2YxMWQyLAogICAgICAgICAgMHhmYjNhZmM4MTU4OTRlOTFmZTFhYjZlNmVmMzZmODU2NWZiYjkwNGY2LAogICAgICAgICAgMHg3ZTJhN2ExMDUwOTE3N2RiMmE3ZWE0MWU3Mjg3NDNjNGViNDJmNTI4LAogICAgICAgICAgMHhGNENlODAwOTdiZjFFNTg0ODIyZEJjQTg0ZjkxRDVkN2Q5ZGYwODQ2CiAgICAgXTsKCiAgICAgLy8gV2UgY291bnQgRVRIIGludmVzdGVkIGJ5IHBlcnNvbiwgZm9yIHJlZnVuZHMgKHNlZSBiZWxvdykKICAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgZXRoSW52ZXN0ZWRCeTsKICAgICAvLyBUaGVzZSBjYW4gYmUgY2hhbmdlZCBiZWZvcmUgSUNPIHN0YXJ0cyAoJDdVU0QvTU5UUCkKICAgICB1aW50IGNvbnN0YW50IFNURF9QUklDRV9VU0RfUEVSXzEwMDBfVE9LRU5TID0gNzAwMDsKICAgICAvLyBVU0QvRVRIIGlzIGZpeGVkIGZvciB0aGUgd2hvbGUgSUNPCiAgICAgLy8gV0FSTklORzogaWYgVVNEL0VUSCByYXRlIGNoYW5nZXMgRFVSSU5HIElDTyAtPiB3ZSB3b24ndCBjaGFuZ2UgaXQKICAgICAvLyBjb2lubWFya2V0Y2FwLmNvbSAwNC4wOS4yMDE3CiAgICAgdWludCBjb25zdGFudCBFVEhfUFJJQ0VfSU5fVVNEID0gMzAwOwogICAgIC8vIFByaWNlIGNoYW5nZXMgZnJvbSBibG9jayB0byBibG9jawogICAgIC8vdWludCBjb25zdGFudCBTSU5HTEVfQkxPQ0tfTEVOID0gNzAwMDAwOwoKICAgICB1aW50IGNvbnN0YW50IFNJTkdMRV9CTE9DS19MRU4gPSAxMDA7CgogICAgIC8vIDEgMDAwIDAwMCB0b2tlbnMKICAgICB1aW50IHB1YmxpYyBjb25zdGFudCBCT05VU19SRVdBUkQgPSAxMDAwMDAwICogMSBldGhlcjsKICAgICAvLyAyIDAwMCAwMDAgdG9rZW5zCiAgICAgdWludCBwdWJsaWMgY29uc3RhbnQgRk9VTkRFUlNfUkVXQVJEID0gMjAwMDAwMCAqIDEgZXRoZXI7CiAgICAgLy8gNyAwMDAgMDAwIGlzIHNvbGQgZHVyaW5nIHRoZSBJQ08KICAgICAvL3VpbnQgcHVibGljIGNvbnN0YW50IElDT19UT0tFTl9TVVBQTFlfTElNSVQgPSA3MDAwMDAwICogMSBldGhlcjsKCiAgICAgdWludCBwdWJsaWMgY29uc3RhbnQgSUNPX1RPS0VOX1NVUFBMWV9MSU1JVCA9IDE1MCAqIDEgZXRoZXI7CgogICAgIC8vIDE1MCAwMDAgdG9rZW5zIHNvZnQgY2FwIChvdGhlcndpc2UgLSByZWZ1bmQpCiAgICAgdWludCBwdWJsaWMgY29uc3RhbnQgSUNPX1RPS0VOX1NPRlRfQ0FQID0gMTUwMDAwICogMSBldGhlcjsKCi8vIEZpZWxkczoKICAgICBhZGRyZXNzIHB1YmxpYyBjcmVhdG9yID0gMHgwOwogICAgIGFkZHJlc3MgcHVibGljIHRva2VuTWFuYWdlciA9IDB4MDsKICAgICBhZGRyZXNzIHB1YmxpYyBvdGhlckN1cnJlbmNpZXNDaGVja2VyID0gMHgwOwoKICAgICB1aW50NjQgcHVibGljIGljb1N0YXJ0ZWRUaW1lID0gMDsKCiAgICAgTU5UUCBwdWJsaWMgbW50VG9rZW47IAoKICAgICBHb2xkbWludFVuc29sZCBwdWJsaWMgdW5zb2xkQ29udHJhY3Q7CgogICAgIC8vIFRvdGFsIGFtb3VudCBvZiB0b2tlbnMgc29sZCBkdXJpbmcgSUNPCiAgICAgdWludCBwdWJsaWMgaWNvVG9rZW5zU29sZCA9IDA7CiAgICAgLy8gVG90YWwgYW1vdW50IG9mIHRva2VucyBzZW50IHRvIEdvbGRtaW50VW5zb2xkIGNvbnRyYWN0IGFmdGVyIElDTyBpcyBmaW5pc2hlZAogICAgIHVpbnQgcHVibGljIGljb1Rva2Vuc1Vuc29sZCA9IDA7CiAgICAgLy8gVG90YWwgbnVtYmVyIG9mIHRva2VucyB0aGF0IHdlcmUgaXNzdWVkIGJ5IGEgc2NyaXB0cwogICAgIHVpbnQgcHVibGljIGlzc3VlZEV4dGVybmFsbHlUb2tlbnMgPSAwOwogICAgIC8vIFRoaXMgaXMgd2hlcmUgRk9VTkRFUlNfUkVXQVJEIHdpbGwgYmUgYWxsb2NhdGVkCiAgICAgYWRkcmVzcyBwdWJsaWMgZm91bmRlcnNSZXdhcmRzQWNjb3VudCA9IDB4MDsKCiAgICAgZW51bSBTdGF0ZXsKICAgICAgICAgIEluaXQsCgogICAgICAgICAgSUNPUnVubmluZywKICAgICAgICAgIElDT1BhdXNlZCwKCiAgICAgICAgICAvLyBDb2xsZWN0ZWQgRVRIIGlzIHRyYW5zZmVycmVkIHRvIG11bHRpc2lncy4KICAgICAgICAgIC8vIFVuc29sZCB0b2tlbnMgdHJhbnNmZXJyZWQgdG8gR29sZG1pbnRVbnNvbGQgY29udHJhY3QuCiAgICAgICAgICBJQ09GaW5pc2hlZCwKCiAgICAgICAgICAvLyBXZSBzdGFydCB0byByZWZ1bmQgaWYgU29mdCBDYXAgaXMgbm90IHJlYWNoZWQuCiAgICAgICAgICAvLyBUaGVuIGVhY2ggdG9rZW4gaG9sZGVyIHNob3VsZCByZXF1ZXN0IGEgcmVmdW5kIHBlcnNvbmFsbHkgZnJvbSBoaXMKICAgICAgICAgIC8vIHBlcnNvbmFsIHdhbGxldC4KICAgICAgICAgIC8vCiAgICAgICAgICAvLyBXZSB3aWxsIHJldHVybiBFVEhzIG9ubHkgdG8gdGhlIG9yaWdpbmFsIGFkZHJlc3MuIElmIHlvdXIgYWRkcmVzcyBpcyBjaGFuZ2VkCiAgICAgICAgICAvLyBvciB5b3UgaGF2ZSBsb3N0IHlvdXIga2V5cyAtPiB5b3Ugd2lsbCBub3QgYmUgYWJsZSB0byBnZXQgYSByZWZ1bmQuCiAgICAgICAgICAvLyAKICAgICAgICAgIC8vIFRoZXJlIGlzIG5vIGFueSBwb3NzaWJpbGl0eSB0byB0cmFuc2ZlciB0b2tlbnMKICAgICAgICAgIC8vIFRoZXJlIGlzIG5vIGFueSBwb3NzaWJpbGl0eSB0byBtb3ZlIGJhY2sKICAgICAgICAgIFJlZnVuZGluZywKCiAgICAgICAgICAvLyBJbiB0aGlzIHN0YXRlIHdlIGxvY2sgYWxsIE1OVCB0b2tlbnMgZm9yZXZlci4KICAgICAgICAgIC8vIFdlIGFyZSBnb2luZyB0byBtaWdyYXRlIE1OVFAgLT4gTU5UIHRva2VucyBkdXJpbmcgdGhpcyBzdGFnZS4gCiAgICAgICAgICAvLyAKICAgICAgICAgIC8vIFRoZXJlIGlzIG5vIGFueSBwb3NzaWJpbGl0eSB0byB0cmFuc2ZlciB0b2tlbnMKICAgICAgICAgIC8vIFRoZXJlIGlzIG5vIGFueSBwb3NzaWJpbGl0eSB0byBtb3ZlIGJhY2sKICAgICAgICAgIE1pZ3JhdGluZwogICAgIH0KICAgICBTdGF0ZSBwdWJsaWMgY3VycmVudFN0YXRlID0gU3RhdGUuSW5pdDsKCi8vIE1vZGlmaWVyczoKICAgICBtb2RpZmllciBvbmx5Q3JlYXRvcigpIHsgCiAgICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXI9PWNyZWF0b3IpOyAKICAgICAgICAgIF87IAogICAgIH0KICAgICBtb2RpZmllciBvbmx5VG9rZW5NYW5hZ2VyKCkgeyAKICAgICAgICAgIHJlcXVpcmUobXNnLnNlbmRlcj09dG9rZW5NYW5hZ2VyKTsgCiAgICAgICAgICBfOyAKICAgICB9CiAgICAgbW9kaWZpZXIgb25seU90aGVyQ3VycmVuY2llc0NoZWNrZXIoKSB7IAogICAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyPT1vdGhlckN1cnJlbmNpZXNDaGVja2VyKTsgCiAgICAgICAgICBfOyAKICAgICB9CiAgICAgbW9kaWZpZXIgb25seUluU3RhdGUoU3RhdGUgc3RhdGUpeyAKICAgICAgICAgIHJlcXVpcmUoc3RhdGU9PWN1cnJlbnRTdGF0ZSk7IAogICAgICAgICAgXzsgCiAgICAgfQoKLy8gRXZlbnRzOgogICAgIGV2ZW50IExvZ1N0YXRlU3dpdGNoKFN0YXRlIG5ld1N0YXRlKTsKICAgICBldmVudCBMb2dCdXkoYWRkcmVzcyBpbmRleGVkIG93bmVyLCB1aW50IHZhbHVlKTsKICAgICBldmVudCBMb2dCdXJuKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgdWludCB2YWx1ZSk7CiAgICAgCi8vIEZ1bmN0aW9uczoKICAgICAvLy8gQGRldiBDb25zdHJ1Y3RvcgogICAgIGZ1bmN0aW9uIEdvbGRtaW50KAogICAgICAgICAgYWRkcmVzcyBfdG9rZW5NYW5hZ2VyLAogICAgICAgICAgYWRkcmVzcyBfb3RoZXJDdXJyZW5jaWVzQ2hlY2tlciwKCiAgICAgICAgICBhZGRyZXNzIF9tbnRUb2tlbkFkZHJlc3MsCiAgICAgICAgICBhZGRyZXNzIF91bnNvbGRDb250cmFjdEFkZHJlc3MsCiAgICAgICAgICBhZGRyZXNzIF9mb3VuZGVyc1Zlc3RpbmdBZGRyZXNzKQogICAgIHsKICAgICAgICAgIGNyZWF0b3IgPSBtc2cuc2VuZGVyOwoKICAgICAgICAgIHRva2VuTWFuYWdlciA9IF90b2tlbk1hbmFnZXI7CiAgICAgICAgICBvdGhlckN1cnJlbmNpZXNDaGVja2VyID0gX290aGVyQ3VycmVuY2llc0NoZWNrZXI7IAoKICAgICAgICAgIG1udFRva2VuID0gTU5UUChfbW50VG9rZW5BZGRyZXNzKTsKICAgICAgICAgIHVuc29sZENvbnRyYWN0ID0gR29sZG1pbnRVbnNvbGQoX3Vuc29sZENvbnRyYWN0QWRkcmVzcyk7CgogICAgICAgICAgLy8gc2xpZ2h0IHJlbmFtZQogICAgICAgICAgZm91bmRlcnNSZXdhcmRzQWNjb3VudCA9IF9mb3VuZGVyc1Zlc3RpbmdBZGRyZXNzOwoKICAgICAgICAgIGFzc2VydChtdWx0aXNpZ3MubGVuZ3RoPT0xMCk7CiAgICAgfQoKICAgICBmdW5jdGlvbiBzdGFydElDTygpIHB1YmxpYyBvbmx5Q3JlYXRvciBvbmx5SW5TdGF0ZShTdGF0ZS5Jbml0KSB7CiAgICAgICAgICBzZXRTdGF0ZShTdGF0ZS5JQ09SdW5uaW5nKTsKICAgICAgICAgIGljb1N0YXJ0ZWRUaW1lID0gdWludDY0KG5vdyk7CiAgICAgICAgICBtbnRUb2tlbi5sb2NrVHJhbnNmZXIodHJ1ZSk7CiAgICAgICAgICBtbnRUb2tlbi5pc3N1ZVRva2Vucyhmb3VuZGVyc1Jld2FyZHNBY2NvdW50LCBGT1VOREVSU19SRVdBUkQpOwogICAgIH0KCiAgICAgZnVuY3Rpb24gcGF1c2VJQ08oKSBwdWJsaWMgb25seUNyZWF0b3Igb25seUluU3RhdGUoU3RhdGUuSUNPUnVubmluZykgewogICAgICAgICAgc2V0U3RhdGUoU3RhdGUuSUNPUGF1c2VkKTsKICAgICB9CgogICAgIGZ1bmN0aW9uIHJlc3VtZUlDTygpIHB1YmxpYyBvbmx5Q3JlYXRvciBvbmx5SW5TdGF0ZShTdGF0ZS5JQ09QYXVzZWQpIHsKICAgICAgICAgIHNldFN0YXRlKFN0YXRlLklDT1J1bm5pbmcpOwogICAgIH0KCiAgICAgZnVuY3Rpb24gc3RhcnRSZWZ1bmRpbmcoKSBwdWJsaWMgb25seUNyZWF0b3Igb25seUluU3RhdGUoU3RhdGUuSUNPUnVubmluZykgewogICAgICAgICAgLy8gb25seSBzd2l0Y2ggdG8gdGhpcyBzdGF0ZSBpZiBsZXNzIHRoYW4gSUNPX1RPS0VOX1NPRlRfQ0FQIHNvbGQKICAgICAgICAgIHJlcXVpcmUoaWNvVG9rZW5zU29sZCA8IElDT19UT0tFTl9TT0ZUX0NBUCk7CiAgICAgICAgICBzZXRTdGF0ZShTdGF0ZS5SZWZ1bmRpbmcpOwoKICAgICAgICAgIC8vIGluIHRoaXMgc3RhdGUgdG9rZW5zIHN0aWxsIHNob3VsZG4ndCBiZSB0cmFuc2ZlcnJlZAogICAgICAgICAgYXNzZXJ0KG1udFRva2VuLmxvY2tUcmFuc2ZlcnMoKSk7CiAgICAgfQoKICAgICBmdW5jdGlvbiBzdGFydE1pZ3JhdGlvbigpIHB1YmxpYyBvbmx5Q3JlYXRvciBvbmx5SW5TdGF0ZShTdGF0ZS5JQ09GaW5pc2hlZCkgewogICAgICAgICAgLy8gdGhlcmUgaXMgbm8gd2F5IGJhY2suLi4KICAgICAgICAgIHNldFN0YXRlKFN0YXRlLk1pZ3JhdGluZyk7CgogICAgICAgICAgLy8gZGlzYWJsZSB0b2tlbiB0cmFuc2ZlcnMKICAgICAgICAgIG1udFRva2VuLmxvY2tUcmFuc2Zlcih0cnVlKTsKICAgICB9CgogICAgIC8vLyBAZGV2IFRoaXMgZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCBieSBjcmVhdG9yIGF0IGFueSB0aW1lLAogICAgIC8vLyBvciBieSBhbnlvbmUgaWYgSUNPIGhhcyByZWFsbHkgZmluaXNoZWQuCiAgICAgZnVuY3Rpb24gZmluaXNoSUNPKCkgcHVibGljIG9ubHlJblN0YXRlKFN0YXRlLklDT1J1bm5pbmcpIHsKICAgICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjcmVhdG9yIHx8IGlzSWNvRmluaXNoZWQoKSk7CiAgICAgICAgICBzZXRTdGF0ZShTdGF0ZS5JQ09GaW5pc2hlZCk7CgogICAgICAgICAgLy8gMSAtIGxvY2sgYWxsIHRyYW5zZmVycwogICAgICAgICAgbW50VG9rZW4ubG9ja1RyYW5zZmVyKGZhbHNlKTsKCiAgICAgICAgICAvLyAyIC0gbW92ZSBhbGwgdW5zb2xkIHRva2VucyB0byB1bnNvbGRUb2tlbnMgY29udHJhY3QKICAgICAgICAgIGljb1Rva2Vuc1Vuc29sZCA9IHNhZmVTdWIoSUNPX1RPS0VOX1NVUFBMWV9MSU1JVCxpY29Ub2tlbnNTb2xkKTsKICAgICAgICAgIGlmKGljb1Rva2Vuc1Vuc29sZD4wKXsKICAgICAgICAgICAgICAgbW50VG9rZW4uaXNzdWVUb2tlbnModW5zb2xkQ29udHJhY3QsaWNvVG9rZW5zVW5zb2xkKTsKICAgICAgICAgICAgICAgdW5zb2xkQ29udHJhY3QuZmluaXNoSWNvKCk7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gMyAtIHNlbmQgYWxsIEVUSCB0byBtdWx0aXNpZ3MKICAgICAgICAgIC8vIHdlIGhhdmUgTiBzZXBhcmF0ZSBtdWx0aXNpZ3MgZm9yIGV4dHJhIHNlY3VyaXR5CiAgICAgICAgICB1aW50IHNlbmRUaGlzQW1vdW50ID0gKHRoaXMuYmFsYW5jZSAvIDEwKTsKCiAgICAgICAgICAvLyAzLjEgLSBzZW5kIHRvIDkgbXVsdGlzaWdzCiAgICAgICAgICBmb3IodWludCBpPTA7IGk8OTsgKytpKXsKICAgICAgICAgICAgICAgYWRkcmVzcyBtcyA9IG11bHRpc2lnc1tpXTsKCiAgICAgICAgICAgICAgIGlmKHRoaXMuYmFsYW5jZT49c2VuZFRoaXNBbW91bnQpewogICAgICAgICAgICAgICAgICAgIG1zLnRyYW5zZmVyKHNlbmRUaGlzQW1vdW50KTsKICAgICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIC8vIDMuMiAtIHNlbmQgZXZlcnl0aGluZyBsZWZ0IHRvIDEwdGggbXVsdGlzaWcKICAgICAgICAgIGlmKDAhPXRoaXMuYmFsYW5jZSl7CiAgICAgICAgICAgICAgIGFkZHJlc3MgbGFzdE1zID0gbXVsdGlzaWdzWzldOwogICAgICAgICAgICAgICBsYXN0TXMudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgICAgICAgIH0KICAgICB9CgogICAgIGZ1bmN0aW9uIHNldFN0YXRlKFN0YXRlIF9zKSBpbnRlcm5hbCB7CiAgICAgICAgICBjdXJyZW50U3RhdGUgPSBfczsKICAgICAgICAgIExvZ1N0YXRlU3dpdGNoKF9zKTsKICAgICB9CgovLyBBY2Nlc3MgbWV0aG9kczoKICAgICBmdW5jdGlvbiBzZXRUb2tlbk1hbmFnZXIoYWRkcmVzcyBfbmV3KSBwdWJsaWMgb25seVRva2VuTWFuYWdlciB7CiAgICAgICAgICB0b2tlbk1hbmFnZXIgPSBfbmV3OwogICAgIH0KCiAgICAgLy8gVE9ETzogc3RlYWxpbmcgY3JlYXRvcidzIGtleSBtZWFucyBzdGVhbGluZyBvdGhlckN1cnJlbmNpZXNDaGVja2VyIGtleSB0b28hCiAgICAgLyoKICAgICBmdW5jdGlvbiBzZXRPdGhlckN1cnJlbmNpZXNDaGVja2VyKGFkZHJlc3MgX25ldykgcHVibGljIG9ubHlDcmVhdG9yIHsKICAgICAgICAgIG90aGVyQ3VycmVuY2llc0NoZWNrZXIgPSBfbmV3OwogICAgIH0KICAgICAqLwoKICAgICAvLyBUaGVzZSBhcmUgdXNlZCBieSBmcm9udGVuZCBzbyB3ZSBjYW4gbm90IHJlbW92ZSB0aGVtCiAgICAgZnVuY3Rpb24gZ2V0VG9rZW5zSWNvU29sZCgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50KXsgICAgICAgICAgCiAgICAgICAgICByZXR1cm4gaWNvVG9rZW5zU29sZDsgICAgICAgCiAgICAgfSAgICAgIAogICAgIAogICAgIGZ1bmN0aW9uIGdldFRvdGFsSWNvVG9rZW5zKCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQpeyAgICAgICAgICAKICAgICAgICAgIHJldHVybiBJQ09fVE9LRU5fU1VQUExZX0xJTUlUOyAgICAgICAgIAogICAgIH0gICAgICAgCiAgICAgCiAgICAgZnVuY3Rpb24gZ2V0TW50VG9rZW5CYWxhbmNlKGFkZHJlc3MgX29mKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludCl7ICAgICAgICAgCiAgICAgICAgICByZXR1cm4gbW50VG9rZW4uYmFsYW5jZU9mKF9vZik7ICAgICAgICAgCiAgICAgfSAgICAgICAgCgogICAgIGZ1bmN0aW9uIGdldEJsb2NrTGVuZ3RoKCljb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludCl7ICAgICAgICAgIAogICAgICAgICAgcmV0dXJuIFNJTkdMRV9CTE9DS19MRU47ICAgICAgCiAgICAgfQoKICAgICBmdW5jdGlvbiBnZXRDdXJyZW50UHJpY2UoKWNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50KXsKICAgICAgICAgIHJldHVybiBnZXRNbnRUb2tlbnNQZXJFdGgoaWNvVG9rZW5zU29sZCk7CiAgICAgfQoKLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgICBmdW5jdGlvbiBpc0ljb0ZpbmlzaGVkKCkgY29uc3RhbnQgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgICAgcmV0dXJuIChpY29TdGFydGVkVGltZSA+IDApCiAgICAgICAgICAgICYmIChub3cgPiAoaWNvU3RhcnRlZFRpbWUgKyAzMCBkYXlzKSB8fCAoaWNvVG9rZW5zU29sZCA+PSBJQ09fVE9LRU5fU1VQUExZX0xJTUlUKSk7CiAgICAgfQoKICAgICBmdW5jdGlvbiBnZXRNbnRUb2tlbnNQZXJFdGgodWludCBfdG9rZW5zU29sZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpewogICAgICAgICAgLy8gMTAgYnVja2V0cwogICAgICAgICAgdWludCBwcmljZUluZGV4ID0gKF90b2tlbnNTb2xkIC8gMSBldGhlcikgLyBTSU5HTEVfQkxPQ0tfTEVOOwogICAgICAgICAgYXNzZXJ0KHByaWNlSW5kZXg+PTAgJiYgKHByaWNlSW5kZXg8PTkpKTsKICAgICAgICAgIAogICAgICAgICAgdWludDhbMTBdIG1lbW9yeSBkaXNjb3VudFBlcmNlbnRzID0gWzIwLDE1LDEwLDgsNiw0LDIsMCwwLDBdOwoKICAgICAgICAgIC8vIFdlIGhhdmUgdG8gbXVsdGlwbHkgYnkgJzEgZXRoZXInIHRvIGF2b2lkIGZsb2F0IHRydW5jYXRpb25zCiAgICAgICAgICAvLyBFeGFtcGxlOiAoJDcwMDAgKiAxMDApIC8gMTIwID0gJDU4MzMuMzMzMzMKICAgICAgICAgIHVpbnQgcHJpY2VQZXIxMDAwdG9rZW5zVXNkID0gCiAgICAgICAgICAgICAgICgoU1REX1BSSUNFX1VTRF9QRVJfMTAwMF9UT0tFTlMgKiAxMDApICogMSBldGhlcikgLyAoMTAwICsgZGlzY291bnRQZXJjZW50c1twcmljZUluZGV4XSk7CgogICAgICAgICAgLy8gQ29ycmVjdDogMzAwMDAwIC8gNTgzMy4zMzMzMzMzMyA9IDUxLjQyODU3MTQyCiAgICAgICAgICAvLyBXZSBoYXZlIHRvIG11bHRpcGx5IGJ5ICcxIGV0aGVyJyB0byBhdm9pZCBmbG9hdCB0cnVuY2F0aW9ucwogICAgICAgICAgdWludCBtbnRQZXJFdGggPSAoRVRIX1BSSUNFX0lOX1VTRCAqIDEwMDAgKiAxIGV0aGVyICogMSBldGhlcikgLyBwcmljZVBlcjEwMDB0b2tlbnNVc2Q7CiAgICAgICAgICByZXR1cm4gbW50UGVyRXRoOwogICAgIH0KCiAgICAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgX2J1eWVyKSBwdWJsaWMgcGF5YWJsZSBvbmx5SW5TdGF0ZShTdGF0ZS5JQ09SdW5uaW5nKSB7CiAgICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSE9MCk7CgogICAgICAgICAgLy8gVGhlIHByaWNlIGlzIHNlbGVjdGVkIGJhc2VkIG9uIGN1cnJlbnQgc29sZCB0b2tlbnMuCiAgICAgICAgICAvLyBQcmljZSBjYW4gJ292ZXJsYXAnLiBGb3IgZXhhbXBsZToKICAgICAgICAgIC8vICAgMS4gaWYgY3VycmVudGx5IHdlIHNvbGQgNjk5OTUwIHRva2VucyAodGhlIHByaWNlIGlzIDEwJSBkaXNjb3VudCkKICAgICAgICAgIC8vICAgMi4gYnV5ZXIgYnV5cyAxMDAwIHRva2VucwogICAgICAgICAgLy8gICAzLiB0aGUgcHJpY2Ugb2YgYWxsIDEwMDAgdG9rZW5zIHdvdWxkIGJlIHdpdGggMTAlIGRpc2NvdW50ISEhCiAgICAgICAgICB1aW50IG5ld1Rva2VucyA9IChtc2cudmFsdWUgKiBnZXRNbnRUb2tlbnNQZXJFdGgoaWNvVG9rZW5zU29sZCkpIC8gMSBldGhlcjsKCiAgICAgICAgICBpc3N1ZVRva2Vuc0ludGVybmFsKF9idXllcixuZXdUb2tlbnMpOwoKICAgICAgICAgIC8vIFVwZGF0ZSB0aGlzIG9ubHkgd2hlbiBidXlpbmcgZnJvbSBFVEgKICAgICAgICAgIGV0aEludmVzdGVkQnlbbXNnLnNlbmRlcl0gPSBzYWZlQWRkKGV0aEludmVzdGVkQnlbbXNnLnNlbmRlcl0sIG1zZy52YWx1ZSk7CiAgICAgfQoKICAgICAvLy8gQGRldiBUaGlzIGlzIGNhbGxlZCBieSBvdGhlciBjdXJyZW5jeSBwcm9jZXNzb3JzIHRvIGlzc3VlIG5ldyB0b2tlbnMgCiAgICAgZnVuY3Rpb24gaXNzdWVUb2tlbnNGcm9tT3RoZXJDdXJyZW5jeShhZGRyZXNzIF90bywgdWludCBfd2VpQ291bnQpIG9ubHlJblN0YXRlKFN0YXRlLklDT1J1bm5pbmcpIHB1YmxpYyBvbmx5T3RoZXJDdXJyZW5jaWVzQ2hlY2tlciB7CiAgICAgICAgICByZXF1aXJlKF93ZWlDb3VudCE9MCk7CgogICAgICAgICAgdWludCBuZXdUb2tlbnMgPSAoX3dlaUNvdW50ICogZ2V0TW50VG9rZW5zUGVyRXRoKGljb1Rva2Vuc1NvbGQpKSAvIDEgZXRoZXI7CiAgICAgICAgICBpc3N1ZVRva2Vuc0ludGVybmFsKF90byxuZXdUb2tlbnMpOwogICAgIH0KCiAgICAgLy8vIEBkZXYgVGhpcyBjYW4gYmUgY2FsbGVkIHRvIG1hbnVhbGx5IGlzc3VlIG5ldyB0b2tlbnMgCiAgICAgLy8vIGZyb20gdGhlIGJvbnVzIHJld2FyZAogICAgIGZ1bmN0aW9uIGlzc3VlVG9rZW5zRXh0ZXJuYWwoYWRkcmVzcyBfdG8sIHVpbnQgX3Rva2VucykgcHVibGljIG9ubHlJblN0YXRlKFN0YXRlLklDT0ZpbmlzaGVkKSBvbmx5VG9rZW5NYW5hZ2VyIHsKICAgICAgICAgIC8vIGNhbiBub3QgaXNzdWUgbW9yZSB0aGFuIEJPTlVTX1JFV0FSRAogICAgICAgICAgcmVxdWlyZSgoaXNzdWVkRXh0ZXJuYWxseVRva2VucyArIF90b2tlbnMpPD1CT05VU19SRVdBUkQpOwoKICAgICAgICAgIG1udFRva2VuLmlzc3VlVG9rZW5zKF90byxfdG9rZW5zKTsKCiAgICAgICAgICBpc3N1ZWRFeHRlcm5hbGx5VG9rZW5zID0gaXNzdWVkRXh0ZXJuYWxseVRva2VucyArIF90b2tlbnM7CiAgICAgfQoKICAgICBmdW5jdGlvbiBpc3N1ZVRva2Vuc0ludGVybmFsKGFkZHJlc3MgX3RvLCB1aW50IF90b2tlbnMpIGludGVybmFsIHsKICAgICAgICAgIHJlcXVpcmUoKGljb1Rva2Vuc1NvbGQgKyBfdG9rZW5zKTw9SUNPX1RPS0VOX1NVUFBMWV9MSU1JVCk7CgogICAgICAgICAgbW50VG9rZW4uaXNzdWVUb2tlbnMoX3RvLF90b2tlbnMpOwoKICAgICAgICAgIGljb1Rva2Vuc1NvbGQrPV90b2tlbnM7CgogICAgICAgICAgTG9nQnV5KF90byxfdG9rZW5zKTsKICAgICB9CgogICAgIC8vIGFueW9uZSBjYW4gY2FsbCB0aGlzIGFuZCBnZXQgaGlzIG1vbmV5IGJhY2sKICAgICBmdW5jdGlvbiBnZXRNeVJlZnVuZCgpIHB1YmxpYyBvbmx5SW5TdGF0ZShTdGF0ZS5SZWZ1bmRpbmcpIHsKICAgICAgICAgIGFkZHJlc3Mgc2VuZGVyID0gbXNnLnNlbmRlcjsKICAgICAgICAgIHVpbnQgZXRoVmFsdWUgPSBldGhJbnZlc3RlZEJ5W3NlbmRlcl07CgogICAgICAgICAgcmVxdWlyZShldGhWYWx1ZSA+IDApOwoKICAgICAgICAgIC8vIDEgLSBzZW5kIG1vbmV5IGJhY2sKICAgICAgICAgIHNlbmRlci50cmFuc2ZlcihldGhWYWx1ZSk7CiAgICAgICAgICBldGhJbnZlc3RlZEJ5W3NlbmRlcl0gPSAwOwoKICAgICAgICAgIC8vIDIgLSBidXJuIHRva2VucwogICAgICAgICAgbW50VG9rZW4uYnVyblRva2VucyhzZW5kZXIsIG1udFRva2VuLmJhbGFuY2VPZihzZW5kZXIpKTsKICAgICB9CgogICAgIC8vIERlZmF1bHQgZmFsbGJhY2sgZnVuY3Rpb24KICAgICBmdW5jdGlvbigpIHBheWFibGUgewogICAgICAgICAgLy8gYnV5VG9rZW5zIC0+IGlzc3VlVG9rZW5zSW50ZXJuYWwKICAgICAgICAgIGJ1eVRva2Vucyhtc2cuc2VuZGVyKTsKICAgICB9Cn0='.
	

]
