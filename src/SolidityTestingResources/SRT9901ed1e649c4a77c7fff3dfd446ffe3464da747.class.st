Class {
	#name : #SRT9901ed1e649c4a77c7fff3dfd446ffe3464da747,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT9901ed1e649c4a77c7fff3dfd446ffe3464da747 >> base64 [
	^ 'LyoKZmlsZTogICBIdXQzNFRTLnNvbAp2ZXI6ICAgIDAuMi40X2RlcGxveQphdXRob3I6IERhcnJ5bCBNb3JyaXMKZGF0ZTogICAyNy1PY3QtMjAxNwplbWFpbDogIG8wcmFnbWFuMG8gQVQgZ21haWwuY29tCihjKSBEYXJyeWwgTW9ycmlzIDIwMTcKCkEgY29sbGF0ZWQgY29udHJhY3Qgc2V0IGZvciB0aGUgcmVjZWlwdCBvZiBmdW5kcyBhbmQgcHJvZHVjdGlvbiBhbmQgdHJhbnNmZXIKb2YgRVJDMjAgdG9rZW5zIGFzIHNwZWNpZmllZCBieSBIdXQzNC4KCkxpY2Vuc2UKLS0tLS0tLQpUaGlzIHNvZnR3YXJlIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCmJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCk1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4KU2VlIE1JVCBMaWNlbmNlIGZvciBmdXJ0aGVyIGRldGFpbHMuCjxodHRwczovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL01JVD4uCgpSZWxlYXNlIE5vdGVzCi0tLS0tLS0tLS0tLS0KKiBBZGRlZCBgZXZlbnQgQWJvcnRlZCgpYAoqIGNvcnJlY3QgYHdob2xlc2FsZUxlZnRgIG1hZ25pdHVkZSBidWcKKiBBbGwgdGVzdHMgcGFzc2VkCgpEZWRpY2F0aW9ucwotLS0tLS0tLS0tLS0tCiogd2l0aCBsb3ZlIHRvIElzYWJlbGxhIGFuZCBwZWEgZnJvbSB5b3VyIGRhZAoqIHh4IHRvIGVkaWUsIHJvYmluLCB3aWxsaWFtIGFuZCBjaGFybG90dGUgeAoqLwoKCnByYWdtYSBzb2xpZGl0eSBeMC40LjE3OwoKLy8gQXVkaXRlZCAyNyBPY3RvYmVyIDIwMTcgYnkgRGFycnlsIE1vcnJpcywgUGV0ZXIgR29kYm9sdApjb250cmFjdCBIdXQzNENvbmZpZwp7CiAgICAvLyBFUkMyMCB0b2tlbiBuYW1lCiAgICBzdHJpbmcgIHB1YmxpYyBjb25zdGFudCBuYW1lICAgICAgICAgICAgPSAiSHV0MzQgRW50cm9weSI7CgogICAgLy8gRVJDMjAgdHJhZGluZyBzeW1ib2wKICAgIHN0cmluZyAgcHVibGljIGNvbnN0YW50IHN5bWJvbCAgICAgICAgICA9ICJFTlQiOwoKICAgIC8vIEVSQzIwIGRlY2ltYWwgcGxhY2VzCiAgICB1aW50OCAgIHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyAgICAgICAgPSAxODsKCiAgICAvLyBUb3RhbCBzdXBwbHkgKCogaW4gdW5pdCBFTlQgKikKICAgIHVpbnQgICAgcHVibGljIGNvbnN0YW50IFRPVEFMX1RPS0VOUyAgICA9IDEwMDAwMDAwMDsKCiAgICAvLyBDb250cmFjdCBvd25lciBhdCB0aW1lIG9mIGRlcGxveW1lbnQuCiAgICBhZGRyZXNzIHB1YmxpYyBjb25zdGFudCBPV05FUiAgICAgICAgICAgPSAweGRBMzc4MENmZjJhRTNhNTlhZTE2ZUMxNzM0REVlYzc3YTdmZDhkYjI7CgogICAgLy8gKyBuZXcgRGF0ZSgiMDA6MDAgMiBOb3ZlbWJlciAyMDE3IHV0YyIpLzEwMDAKICAgIHVpbnQgICAgcHVibGljIGNvbnN0YW50IFNUQVJUX0RBVEUgICAgICA9IDE1MDk1ODA4MDA7CgogICAgLy8gQSBIdXQzNCBhZGRyZXNzIHRvIG93biB0b2tlbnMKICAgIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IEhVVDM0X1JFVEFJTiAgICA9IDB4MzEzNUY0YWNBM0MxQWQ0NzU4OTgxNTAwZjhkQjIwRWJEYzVBMWNhQjsKCiAgICAvLyBBIEh1dDM0IGFkZHJlc3MgdG8gYWNjZXB0IHJhaXNlZCBmdW5kcwogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgSFVUMzRfV0FMTEVUICAgID0gMHhBNzBkMDRkQzRhNjQ5NjBjNDBDRDJFRDJDREUzNkQ3NkNBNEVERmFCOwoKICAgIC8vIFBlcmNlbnRhZ2Ugb2YgdG9rZW5zIHRvIGJlIHZlc3RlZCBvdmVyIDIgeWVhcnMuIDIwJQogICAgdWludCAgICBwdWJsaWMgY29uc3RhbnQgVkVTVEVEX1BFUkNFTlQgID0gMjA7CgogICAgLy8gVmVzdGluZyBwZXJpb2QKICAgIHVpbnQgICAgcHVibGljIGNvbnN0YW50IFZFU1RJTkdfUEVSSU9EICA9IDI2IHdlZWtzOwoKICAgIC8vIE1pbmltdW0gY2FwIG92ZXIgd2hpY2ggdGhlIGZ1bmRpbmcgaXMgY29uc2lkZXJlZCBzdWNjZXNzZnVsCiAgICB1aW50ICAgIHB1YmxpYyBjb25zdGFudCBNSU5fQ0FQICAgICAgICAgPSAzMDAwICogMSBldGhlcjsKCiAgICAvLyBBbiBldGhlciB0aHJlc2hvbGQgb3ZlciB3aGljaCBhIGZ1bmRlciBtdXN0IEtZQyBiZWZvcmUgdG9rZW5zIGNhbiBiZQogICAgLy8gdHJhbnNmZXJyZWQgKHVuaXQgb2YgZXRoZXIpOwogICAgdWludCAgICBwdWJsaWMgY29uc3RhbnQgS1lDX1RIUkVTSE9MRCAgID0gMTUwICogMSBldGhlcjsKCiAgICAvLyBBIG1pbmltdW0gYW1vdW50IG9mIGV0aGVyIGZ1bmRpbmcgYmVmb3JlIHRoZSBjb25jaWVyZ2UgcmF0ZSBpcyBhcHBsaWVkCiAgICAvLyB0byB0b2tlbnMKICAgIHVpbnQgICAgcHVibGljIGNvbnN0YW50IFdIT0xFU0FMRV9USFJFU0hPTEQgID0gMTUwICogMSBldGhlcjsKCiAgICAvLyBOdW1iZXIgb2YgdG9rZW5zIHVwIGZvciB3aG9sZXNhbGUgcHVyY2hhc2VycyAoKiBpbiB1bml0IEVOVCAqKQogICAgdWludCAgICBwdWJsaWMgY29uc3RhbnQgV0hPTEVTQUxFX1RPS0VOUyA9IDEyNTAwMDAwOwoKICAgIC8vIFRva2VucyBzb2xkIHRvIHByZWZ1bmRlcnMgKCogaW4gdW5pdCBFTlQgKikKICAgIHVpbnQgICAgcHVibGljIGNvbnN0YW50IFBSRVNPTERfVE9LRU5TICA9IDIyNDY1MDA7CgogICAgLy8gUHJlc2FsZSBldGhlciBpcyBlc3RpbWF0ZWVkIGZyb20gZmlhdCByYWlzZWQgcHJpb3IgdG8gVFMgYXQgdGhlIEVUSC9BVUQKICAgIC8vIHJhdGUgYXQgdGhlIHRpbWUgb2YgY29udHJhY3QgZGVwbG95bWVudAogICAgdWludCAgICBwdWJsaWMgY29uc3RhbnQgUFJFU0FMRV9FVEhfUkFJU0UgPSAyODA3ICogMSBldGhlcjsKCiAgICAvLyBBZGRyZXNzIGhvbGRpbmcgcHJlc29sZCB0b2tlbnMgdG8gYmUgZGlzdHJpYnV0ZWQgYWZ0ZXIgVFMKICAgIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IFBSRVNPTERfQUREUkVTUyA9IDB4NkJGNzA4ZUYyQzFGRGNlMzYwM2MwNENFOTU0N0FBNkUxMzQwOTNiNjsKCiAgICAvLyB3aG9sZXNhbGUgcmF0ZSBmb3IgcHVyY2hhc2VzIG92ZXIgV0hPTEVTQUxFX1RIUkVTSE9MRCBldGhlcgogICAgdWludCAgICBwdWJsaWMgY29uc3RhbnQgUkFURV9XSE9MRVNBTEUgID0gMTAwMDsKCiAgICAvLyBUaW1lIGRlcGVuZGFudCByZXRhaWwgcmF0ZXMKICAgIC8vIEZpcnN0IERheQogICAgdWludCAgICBwdWJsaWMgY29uc3RhbnQgUkFURV9EQVlfMCAgICAgID0gNzUwOwoKICAgIC8vIEZpcnN0IFdlZWsgKFRoZSBzaXggZGF5cyBhZnRlciBmaXJzdCBkYXkpCiAgICB1aW50ICAgIHB1YmxpYyBjb25zdGFudCBSQVRFX0RBWV8xICAgICAgPSA2NTI7CgogICAgLy8gU2Vjb25kIFdlZWsKICAgIHVpbnQgICAgcHVibGljIGNvbnN0YW50IFJBVEVfREFZXzcgICAgICA9IDU4ODsKCiAgICAvLyBUaGlyZCBXZWVrCiAgICB1aW50ICAgIHB1YmxpYyBjb25zdGFudCBSQVRFX0RBWV8xNCAgICAgPSA1NDU7CgogICAgLy8gRm91cnRoIFdlZWsKICAgIHVpbnQgICAgcHVibGljIGNvbnN0YW50IFJBVEVfREFZXzIxICAgICA9IDUxNzsKCiAgICAvLyBGaWZ0aCBXZWVrCiAgICB1aW50ICAgIHB1YmxpYyBjb25zdGFudCBSQVRFX0RBWV8yOCAgICAgPSA1MDA7Cn0KCgpsaWJyYXJ5IFNhZmVNYXRoCnsKICAgIC8vIGEgYWRkIHRvIGIKICAgIGZ1bmN0aW9uIGFkZCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IGMpIHsKICAgICAgICBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSk7CiAgICB9CgogICAgLy8gYSBzdWJ0cmFjdCBiCiAgICBmdW5jdGlvbiBzdWIodWludCBhLCB1aW50IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCBjKSB7CiAgICAgICAgYyA9IGEgLSBiOwogICAgICAgIGFzc2VydChjIDw9IGEpOwogICAgfQoKICAgIC8vIGEgbXVsdGlwbGllZCBieSBiCiAgICBmdW5jdGlvbiBtdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCBjKSB7CiAgICAgICAgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICB9CgogICAgLy8gYSBkaXZpZGVkIGJ5IGIKICAgIGZ1bmN0aW9uIGRpdih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IGMpIHsKICAgICAgICBhc3NlcnQoYiAhPSAwKTsKICAgICAgICBjID0gYSAvIGI7CiAgICB9Cn0KCgpjb250cmFjdCBSZWVudHJ5UHJvdGVjdGVkCnsKICAgIC8vIFRoZSByZWVudHJ5IHByb3RlY3Rpb24gc3RhdGUgbXV0ZXguCiAgICBib29sIF9fcmVNdXRleDsKCiAgICAvLyBTZXRzIGFuZCBjbGVhcnMgbXV0ZXggaW4gb3JkZXIgdG8gYmxvY2sgZnVuY3Rpb24gcmVlbnRyeQogICAgbW9kaWZpZXIgcHJldmVudFJlZW50cnkoKSB7CiAgICAgICAgcmVxdWlyZSghX19yZU11dGV4KTsKICAgICAgICBfX3JlTXV0ZXggPSB0cnVlOwogICAgICAgIF87CiAgICAgICAgZGVsZXRlIF9fcmVNdXRleDsKICAgIH0KCiAgICAvLyBCbG9ja3MgZnVuY3Rpb24gZW50cnkgaWYgbXV0ZXggaXMgc2V0CiAgICBtb2RpZmllciBub1JlZW50cnkoKSB7CiAgICAgICAgcmVxdWlyZSghX19yZU11dGV4KTsKICAgICAgICBfOwogICAgfQp9CgoKY29udHJhY3QgRVJDMjBUb2tlbgp7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKCi8qIENvbnN0YW50cyAqLwoKICAgIC8vIG5vbmUKCi8qIFN0YXRlIHZhcmlhYmxlICovCgogICAgLy8vIEByZXR1cm4gVGhlIFRvdGFsIHN1cHBseSBvZiB0b2tlbnMKICAgIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5OwoKICAgIC8vLyBAcmV0dXJuIFRva2VucyBvd25lZCBieSBhbiBhZGRyZXNzCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIGJhbGFuY2VzOwoKICAgIC8vLyBAcmV0dXJuIFRva2VucyBzcGVuZGFibGUgYnkgYSB0aGlyZHBhcnR5CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkpIGFsbG93ZWQ7CgovKiBFdmVudHMgKi8KCiAgICAvLyBUcmlnZ2VyZWQgd2hlbiB0b2tlbnMgYXJlIHRyYW5zZmVycmVkLgogICAgZXZlbnQgVHJhbnNmZXIoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIF9mcm9tLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBfdG8sCiAgICAgICAgdWludDI1NiBfYW1vdW50KTsKCiAgICAvLyBUcmlnZ2VyZWQgd2hlbmV2ZXIgYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF9hbW91bnQpIGlzIGNhbGxlZC4KICAgIGV2ZW50IEFwcHJvdmFsKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLAogICAgICAgIHVpbnQyNTYgX2Ftb3VudCk7CgovKiBNb2RpZmllcnMgKi8KCiAgICAvLyBub25lCgovKiBGdW5jdGlvbnMgKi8KCiAgICAvLyBVc2luZyBhbiBleHBsaWNpdCBnZXR0ZXIgYWxsb3dzIGZvciBmdW5jdGlvbiBvdmVybG9hZGluZwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX2FkZHIpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnMgKHVpbnQpCiAgICB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19hZGRyXTsKICAgIH0KCiAgICAvLyBVc2luZyBhbiBleHBsaWNpdCBnZXR0ZXIgYWxsb3dzIGZvciBmdW5jdGlvbiBvdmVybG9hZGluZwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCkKICAgIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KCiAgICAvLyBTZW5kIF92YWx1ZSBhbW91bnQgb2YgdG9rZW5zIHRvIGFkZHJlc3MgX3RvCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KQogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmV0dXJuIHhmZXIobXNnLnNlbmRlciwgX3RvLCBfYW1vdW50KTsKICAgIH0KCiAgICAvLyBTZW5kIF92YWx1ZSBhbW91bnQgb2YgdG9rZW5zIGZyb20gYWRkcmVzcyBfZnJvbSB0byBhZGRyZXNzIF90bwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXF1aXJlKF9hbW91bnQgPD0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0pOwoKICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLnN1YihfYW1vdW50KTsKICAgICAgICByZXR1cm4geGZlcihfZnJvbSwgX3RvLCBfYW1vdW50KTsKICAgIH0KCiAgICAvLyBQcm9jZXNzIGEgdHJhbnNmZXIgaW50ZXJuYWxseS4KICAgIGZ1bmN0aW9uIHhmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX2Ftb3VudCkKICAgICAgICBpbnRlcm5hbAogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmVxdWlyZShfYW1vdW50IDw9IGJhbGFuY2VzW19mcm9tXSk7CgogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF9hbW91bnQpOwoKICAgICAgICAvLyBhdm9pZCB3YXN0aW5nIGdhcyBvbiAwIHRva2VuIHRyYW5zZmVycwogICAgICAgIGlmKF9hbW91bnQgPT0gMCkgcmV0dXJuIHRydWU7CgogICAgICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX2Ftb3VudCk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSAgID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vIEFwcHJvdmVzIGEgdGhpcmQtcGFydHkgc3BlbmRlcgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF9hbW91bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF9hbW91bnQ7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF9hbW91bnQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9CgoKLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVwKCiMjIENvbmRpdGlvbmFsIEVudHJ5IFRhYmxlCgpGdW5jdGlvbnMgbXVzdCB0aHJvdyBvbiBGIGNvbmRpdGlvbnMKClJlbmV0cnkgcHJldmVudGlvbiBpcyBvbiBhbGwgcHVibGljIG11dGF0aW5nIGZ1bmN0aW9ucwpSZWVudHJ5IG11dGV4IHNldCBpbiBmaW5hbGl6ZVRTKCksIGV4dGVybmFsWGZlcigpLCByZWZ1bmQoKQoKfGZ1bmN0aW9uICAgICAgICAgICAgICAgIHw8c3RhcnREYXRlIHw8ZW5kRGF0ZSAgfGZ1bmRGYWlsZWQgIHxmdW5kUmFpc2VkfHRzU3VjY2VlZGVkCnwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18Oi0tLS0tLS0tLTp8Oi0tLS0tLS0tOnw6LS0tLS0tLS0tLTp8Oi0tLS0tLS0tOnw6LS0tLS0tLS0tOnwKfCgpICAgICAgICAgICAgICAgICAgICAgIHxGICAgICAgICAgIHxUICAgICAgICAgfEYgICAgICAgICAgIHxUICAgICAgICAgfEYgICAgICAgICAgfAp8YWJvcnQoKSAgICAgICAgICAgICAgICAgfFQgICAgICAgICAgfFQgICAgICAgICB8VCAgICAgICAgICAgfFQgICAgICAgICB8RiAgICAgICAgICB8Cnxwcm94eVB1cmNoYXNlKCkgICAgICAgICB8RiAgICAgICAgICB8VCAgICAgICAgIHxGICAgICAgICAgICB8VCAgICAgICAgIHxGICAgICAgICAgIHwKfGZpbmFsaXplVFMoKSAgICAgICAgICAgfEYgICAgICAgICAgfEYgICAgICAgICB8RiAgICAgICAgICAgfFQgICAgICAgICB8VCAgICAgICAgICB8CnxyZWZ1bmQoKSAgICAgICAgICAgICAgICB8RiAgICAgICAgICB8RiAgICAgICAgIHxUICAgICAgICAgICB8RiAgICAgICAgIHxGICAgICAgICAgIHwKfHJlZnVuZEZvcigpICAgICAgICAgICAgIHxGICAgICAgICAgIHxGICAgICAgICAgfFQgICAgICAgICAgIHxGICAgICAgICAgfEYgICAgICAgICAgfAp8dHJhbnNmZXIoKSAgICAgICAgICAgICAgfEYgICAgICAgICAgfEYgICAgICAgICB8RiAgICAgICAgICAgfEYgICAgICAgICB8VCAgICAgICAgICB8Cnx0cmFuc2ZlckZyb20oKSAgICAgICAgICB8RiAgICAgICAgICB8RiAgICAgICAgIHxGICAgICAgICAgICB8RiAgICAgICAgIHxUICAgICAgICAgIHwKfHRyYW5zZmVyVG9NYW55KCkgICAgICAgIHxGICAgICAgICAgIHxGICAgICAgICAgfEYgICAgICAgICAgIHxGICAgICAgICAgfFQgICAgICAgICAgfAp8YXBwcm92ZSgpICAgICAgICAgICAgICAgfEYgICAgICAgICAgfEYgICAgICAgICB8RiAgICAgICAgICAgfEYgICAgICAgICB8VCAgICAgICAgICB8CnxjbGVhckt5YygpICAgICAgICAgICAgICB8VCAgICAgICAgICB8VCAgICAgICAgIHxUICAgICAgICAgICB8VCAgICAgICAgIHxUICAgICAgICAgIHwKfHJlbGVhc2VWZXN0ZWQoKSAgICAgICAgIHxGICAgICAgICAgIHxGICAgICAgICAgfEYgICAgICAgICAgIHxGICAgICAgICAgfG5vdz5yZWxlYXNlfAp8Y2hhbmdlT3duZXIoKSAgICAgICAgICAgfFQgICAgICAgICAgfFQgICAgICAgICB8VCAgICAgICAgICAgfFQgICAgICAgICB8VCAgICAgICAgICB8CnxhY2NlcHRPd25lcnNoaXAoKSAgICAgICB8VCAgICAgICAgICB8VCAgICAgICAgIHxUICAgICAgICAgICB8VCAgICAgICAgIHxUICAgICAgICAgIHwKfHRyYW5zZmVyRXh0ZXJuYWxUb2tlbnMoKXxUICAgICAgICAgIHxUICAgICAgICAgfFQgICAgICAgICAgIHxUICAgICAgICAgfFQgICAgICAgICAgfAp8ZGVzdHJveSgpICAgICAgICAgICAgICAgfEYgICAgICAgICAgfEYgICAgICAgICB8IV9fYWJvcnRGdXNlfEYgICAgICAgICB8RiAgICAgICAgICB8CgpcKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKY29udHJhY3QgSHV0MzRUU0Fic3RyYWN0CnsKICAgIC8vLyBAZGV2IExvZ2dlZCB1cG9uIHJlY2VpdmluZyBhIGRlcG9zaXQKICAgIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3MgZnJvbSB3aGljaCB2YWx1ZSBoYXMgYmVlbiByZWNpZXZlZAogICAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIHZhbHVlIG9mIGV0aGVyIHJlY2VpdmVkCiAgICBldmVudCBEZXBvc2l0KGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgdWludCBfdmFsdWUpOwoKICAgIC8vLyBAZGV2IExvZ2dlZCB1cG9uIGEgd2l0aGRyYXdhbAogICAgLy8vIEBwYXJhbSBfZnJvbSB0aGUgYWRkcmVzcyBvZiB0aGUgd2l0aGRyYXdlcgogICAgLy8vIEBwYXJhbSBfdG8gQWRkcmVzcyB0byB3aGljaCB2YWx1ZSB3YXMgc2VudAogICAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIHZhbHVlIGluIGV0aGVyIHdoaWNoIHdhcyB3aXRoZHJhd24KICAgIGV2ZW50IFdpdGhkcmF3YWwoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50IF92YWx1ZSk7CgogICAgLy8vIEBkZXYgTG9nZ2VkIHdoZW4gbmV3IG93bmVyIGFjY2VwdHMgb3duZXJzaGlwCiAgICAvLy8gQHBhcmFtIF9mcm9tIHRoZSBvbGQgb3duZXIgYWRkcmVzcwogICAgLy8vIEBwYXJhbSBfdG8gdGhlIG5ldyBvd25lciBhZGRyZXNzCiAgICBldmVudCBDaGFuZ2VkT3duZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvKTsKCiAgICAvLy8gQGRldiBMb2dnZWQgd2hlbiBvd25lciBpbml0aWF0ZXMgYSBjaGFuZ2Ugb2Ygb3duZXJzaGlwCiAgICAvLy8gQHBhcmFtIF90byB0aGUgbmV3IG93bmVyIGFkZHJlc3MKICAgIGV2ZW50IENoYW5nZU93bmVyVG8oYWRkcmVzcyBpbmRleGVkIF90byk7CgogICAgLy8vIEBkZXYgTG9nZ2VkIHdoZW4gYSBmdW5kZXIgZXhjZWVkcyB0aGUgS1lDIGxpbWl0CiAgICAvLy8gQHBhcmFtIF9hZGRyIEFkZHJlc3MgdG8gc2V0IG9yIGNsZWFyIEtZQyBmbGFnCiAgICAvLy8gQHBhcmFtIF9reWMgQSBib29sZWFuIGZsYWcKICAgIGV2ZW50IEt5YyhhZGRyZXNzIGluZGV4ZWQgX2FkZHIsIGJvb2wgX2t5Yyk7CgogICAgLy8vIEBkZXYgTG9nZ2VkIHdoZW4gdmVzdGVkIHRva2VucyBhcmUgcmVsZWFzZWQgYmFjayB0byBIVVQzMl9XQUxMRVQKICAgIC8vLyBAcGFyYW0gX3JlbGVhc2VEYXRlIFRoZSBvZmZpY2lhbCByZWxlYXNlIGRhdGUgKGV2ZW4gaWYgcmVsZWFzZWQgYXQKICAgIC8vLyBsYXRlciBkYXRlKQogICAgZXZlbnQgVmVzdGluZ1JlbGVhc2VkKHVpbnQgX3JlbGVhc2VEYXRlKTsKCiAgICAvLy8gQGRldiBMb2dnZWQgaWYgdGhlIGNvbnRyYWN0IGlzIGFib3J0ZWQKICAgIGV2ZW50IEFib3J0ZWQoKTsKCi8vCi8vIENvbnN0YW50cwovLwoKICAgIC8vLyBAZGV2IFRoZSBIdXQzNCB2ZXN0aW5nICdwc3Vkby1hZGRyZXNzJyBmb3IgdHJhbnNmZXJyaW5nIGFuZCByZWxlYXNpbmcKICAgIC8vLyB2ZXN0ZWQgdG9rZW5zIHRvIHRoZSBIdXQzNCBXYWxsZXQuIFRoZSBhZGRyZXNzIGlzIFVURjggZW5jb2Rpbmcgb2YgdGhlCiAgICAvLy8gc3RyaW5nIGFuZCBjYW4gb25seSBiZSBhY2Nlc3NlZCBieSB0aGUgJ3JlbGVhc2VWZXN0ZWQoKScgZnVuY3Rpb24uCiAgICAvLy8gQHJldHVybiBgMHg0ODc1NzQzMzM0MjA1NjY1NzM3NDY5NmU2NzAwMDAwMDAwMDAwMDAwYAogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgSFVUMzRfVkVTVF9BRERSID0gYWRkcmVzcyhieXRlczIwKCJIdXQzNCBWZXN0aW5nIikpOwoKLy8KLy8gU3RhdGUgVmFyaWFibGVzCi8vCgogICAgLy8vIEBkZXYgVGhpcyBmdXNlIGJsb3dzIHVwb24gY2FsbGluZyBhYm9ydCgpIHdoaWNoIGZvcmNlcyBhIGZhaWwgc3RhdGUKICAgIC8vLyBAcmV0dXJuIHRoZSBhYm9ydCBzdGF0ZS4gdHJ1ZSA9PSBub3QgYWJvcnRlZAogICAgYm9vbCBwdWJsaWMgX19hYm9ydEZ1c2UgPSB0cnVlOwoKICAgIC8vLyBAZGV2IFNldHMgdG8gdHJ1ZSBhZnRlciB0aGUgZnVuZCBpcyBzd2VwdCB0byB0aGUgZnVuZCB3YWxsZXQsIGFsbG93cwogICAgLy8vIHRva2VuIHRyYW5zZmVycyBhbmQgcHJldmVudHMgYWJvcnQoKQogICAgLy8vIEByZXR1cm4gZmluYWwgc3VjY2VzcyBzdGF0ZSBvZiBUUwogICAgYm9vbCBwdWJsaWMgdHNTdWNjZWVkZWQ7CgogICAgLy8vIEBkZXYgQW4gYWRkcmVzcyBwZXJtaXNzaW9uZWQgdG8gZW5hY3Qgb3duZXIgcmVzdHJpY3RlZCBmdW5jdGlvbnMKICAgIC8vLyBAcmV0dXJuIG93bmVyCiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgICAvLy8gQGRldiBBbiBhZGRyZXNzIHBlcm1pc3Npb25lZCB0byB0YWtlIG93bmVyc2hpcCBvZiB0aGUgY29udHJhY3QKICAgIC8vLyBAcmV0dXJuIG5ldyBvd25lciBhZGRyZXNzCiAgICBhZGRyZXNzIHB1YmxpYyBuZXdPd25lcjsKCiAgICAvLy8gQGRldiBBIHRhbGx5IG9mIHRvdGFsIGV0aGVyIHJhaXNlZCBkdXJpbmcgdGhlIGZ1bmRpbmcgcGVyaW9kCiAgICAvLy8gQHJldHVybiBUb3RhbCBldGhlciByYWlzZWQgZHVyaW5nIGZ1bmRpbmcKICAgIHVpbnQgcHVibGljIGV0aGVyUmFpc2VkOwoKICAgIC8vLyBAcmV0dXJuIFdob2xlc2FsZSB0b2tlbnMgYXZhaWxhYmxlIGZvciBzYWxlCiAgICB1aW50IHB1YmxpYyB3aG9sZXNhbGVMZWZ0OwoKICAgIC8vLyBAcmV0dXJuIFRvdGFsIGV0aGVyIHJlZnVuZGVkLiBVc2VkIHRvIHBlcm1pc2lvbiBjYWxsIHRvIGBkZXN0cm95KClgCiAgICB1aW50IHB1YmxpYyByZWZ1bmRlZDsKCiAgICAvLy8gQHJldHVybnMgRGF0ZSBvZiBuZXh0IHZlc3RpbmcgcmVsZWFzZQogICAgdWludCBwdWJsaWMgbmV4dFJlbGVhc2VEYXRlOwoKICAgIC8vLyBAcmV0dXJuIEV0aGVyIHBhaWQgYnkgYW4gYWRkcmVzcwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgZXRoZXJDb250cmlidXRlZDsKCiAgICAvLy8gQHJldHVybnMgS1lDIGZsYWcgZm9yIGFuIGFkZHJlc3MKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIG11c3RLeWM7CgovLwovLyBNb2RpZmllcnMKLy8KCiAgICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKLy8KLy8gRnVuY3Rpb24gQWJzdHJhY3RzCi8vCgogICAgLy8vIEByZXR1cm4gYHRydWVgIGlmIE1JTl9GVU5EUyB3ZXJlIHJhaXNlZAogICAgZnVuY3Rpb24gZnVuZFJhaXNlZCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwoKICAgIC8vLyBAcmV0dXJuIGB0cnVlYCBpZiBNSU5fRlVORFMgd2VyZSBub3QgcmFpc2VkIGJlZm9yZSBFTkRfREFURSBvciBjb250cmFjdAogICAgLy8vIGhhcyBiZWVuIGFib3J0ZWQKICAgIGZ1bmN0aW9uIGZ1bmRGYWlsZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKCiAgICAvLy8gQHJldHVybiBUaGUgY3VycmVudCByZXRhaWwgcmF0ZSBmb3IgdG9rZW4gcHVyY2hhc2UKICAgIGZ1bmN0aW9uIGN1cnJlbnRSYXRlKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCk7CgogICAgLy8vIEBwYXJhbSBfd2VpIEEgdmFsdWUgb2YgZXRoZXIgaW4gdW5pdHMgb2Ygd2VpCiAgICAvLy8gQHJldHVybiBhbGxUb2tlbnNfIHJldHVybmFibGUgdG9rZW5zIGZvciB0aGUgZnVuZGluZyBhbW91bnQKICAgIC8vLyBAcmV0dXJuIHdob2xlc2FsZVRva2VuXyBOdW1iZXIgb2YgdG9rZW5zIHB1cmNoYXNlZCBhdCB3aG9sZXNhbGUgcmF0ZQogICAgZnVuY3Rpb24gZXRoVG9Ub2tlbnModWludCBfd2VpKQogICAgICAgIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQgYWxsVG9rZW5zXywgdWludCB3aG9sZXNhbGVUb2tlbnNfKTsKCiAgICAvLy8gQG5vdGljZSBQcm9jZXNzZXMgYSB0b2tlbiBwdXJjaGFzZSBmb3IgYF9hZGRyYAogICAgLy8vIEBwYXJhbSBfYWRkciBBbiBhZGRyZXNzIHRvIHB1cmNoYXNlIHRva2VucwogICAgLy8vIEByZXR1cm4gQm9vbGVhbiBzdWNjZXNzIHZhbHVlCiAgICAvLy8gQGRldiBSZXF1aXJlcyA8MTUwLDAwMCBnYXMKICAgIGZ1bmN0aW9uIHByb3h5UHVyY2hhc2UoYWRkcmVzcyBfYWRkcikgcHVibGljIHBheWFibGUgcmV0dXJucyAoYm9vbCk7CgogICAgLy8vIEBub3RpY2UgRmluYWxpemUgdGhlIFRTIGFuZCB0cmFuc2ZlciBmdW5kcwogICAgLy8vIEByZXR1cm4gQm9vbGVhbiBzdWNjZXNzIHZhbHVlCiAgICBmdW5jdGlvbiBmaW5hbGl6ZVRTKCkgcHVibGljIHJldHVybnMgKGJvb2wpOwoKICAgIC8vLyBAbm90aWNlIENsZWFyIHRoZSBLWUMgZmxhZ3MgZm9yIGFuIGFycmF5IG9mIGFkZHJlc3NlcyB0byBhbGxvdyB0b2tlbnMKICAgIC8vLyB0cmFuc2ZlcnMKICAgIGZ1bmN0aW9uIGNsZWFyS3ljKGFkZHJlc3NbXSBfYWRkcnMpIHB1YmxpYyByZXR1cm5zIChib29sKTsKCiAgICAvLy8gQG5vdGljZSBNYWtlIGJ1bGsgdHJhbnNmZXIgb2YgdG9rZW5zIHRvIG1hbnkgYWRkcmVzc2VzCiAgICAvLy8gQHBhcmFtIF9hZGRycyBBbiBhcnJheSBvZiByZWNpcGllbnQgYWRkcmVzc2VzCiAgICAvLy8gQHBhcmFtIF9hbW91bnRzIEFuIGFycmF5IG9mIGFtb3VudHMgdG8gdHJhbnNmZXIgdG8gcmVzcGVjdGl2ZSBhZGRyZXNzZXMKICAgIC8vLyBAcmV0dXJuIEJvb2xlYW4gc3VjY2VzcyB2YWx1ZQogICAgZnVuY3Rpb24gdHJhbnNmZXJUb01hbnkoYWRkcmVzc1tdIF9hZGRycywgdWludFtdIF9hbW91bnRzKQogICAgICAgIHB1YmxpYyByZXR1cm5zIChib29sKTsKCiAgICAvLy8gQG5vdGljZSBSZWxlYXNlIHZlc3RlZCB0b2tlbnMgYWZ0ZXIgYSBtYXR1cml0eSBkYXRlCiAgICAvLy8gQHJldHVybiBCb29sZWFuIHN1Y2Nlc3MgdmFsdWUKICAgIGZ1bmN0aW9uIHJlbGVhc2VWZXN0ZWQoKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CgogICAgLy8vIEBub3RpY2UgQ2xhaW0gcmVmdW5kIG9uIGZhaWxlZCBUUwogICAgLy8vIEByZXR1cm4gQm9vbGVhbiBzdWNjZXNzIHZhbHVlCiAgICBmdW5jdGlvbiByZWZ1bmQoKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CgogICAgLy8vIEBub3RpY2UgUHVzaCByZWZ1bmQgZm9yIGBfYWRkcmAgZnJvbSBmYWlsZWQgVFMKICAgIC8vLyBAcGFyYW0gX2FkZHJzIEFuIGFycmF5IG9mIGFkZHJlc3MgdG8gcmVmdW5kCiAgICAvLy8gQHJldHVybiBCb29sZWFuIHN1Y2Nlc3MgdmFsdWUKICAgIGZ1bmN0aW9uIHJlZnVuZEZvcihhZGRyZXNzW10gX2FkZHJzKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CgogICAgLy8vIEBub3RpY2UgQWJvcnQgdGhlIHRva2VuIHNhbGUgcHJpb3IgdG8gZmluYWxpemVUUygpCiAgICBmdW5jdGlvbiBhYm9ydCgpIHB1YmxpYyByZXR1cm5zIChib29sKTsKCiAgICAvLy8gQG5vdGljZSBTYWx2YWdlIGBfYW1vdW50YCB0b2tlbnMgYXQgYF9rYWRkcmAgYW5kIHNlbmQgdGhlbSB0byBgX3RvYAogICAgLy8vIEBwYXJhbSBfa0FkZHIgQW4gRVJDMjAgY29udHJhY3QgYWRkcmVzcwogICAgLy8vIEBwYXJhbSBfdG8gYW5kIGFkZHJlc3MgdG8gc2VuZCB0b2tlbnMKICAgIC8vLyBAcGFyYW0gX2Ftb3VudCBUaGUgbnVtYmVyIG9mIHRva2VucyB0byB0cmFuc2ZlcgogICAgLy8vIEByZXR1cm4gQm9vbGVhbiBzdWNjZXNzIHZhbHVlCiAgICBmdW5jdGlvbiB0cmFuc2ZlckV4dGVybmFsVG9rZW4oYWRkcmVzcyBfa0FkZHIsIGFkZHJlc3MgX3RvLCB1aW50IF9hbW91bnQpCiAgICAgICAgcHVibGljIHJldHVybnMgKGJvb2wpOwp9CgoKLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVwKCiBIdXQzNFRTIGltcGxpbWVudGF0aW9uCgpcKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKY29udHJhY3QgSHV0MzRUUyBpcwogICAgUmVlbnRyeVByb3RlY3RlZCwKICAgIEVSQzIwVG9rZW4sCiAgICBIdXQzNFRTQWJzdHJhY3QsCiAgICBIdXQzNENvbmZpZwp7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKCi8vCi8vIENvbnN0YW50cwovLwoKICAgIC8vIFRva2VuIGZpeGVkIHBvaW50IGZvciBkZWNpbWFsIHBsYWNlcwogICAgdWludCBjb25zdGFudCBUT0tFTiA9IHVpbnQoMTApKipkZWNpbWFsczsKCiAgICAvLyBDYWxjdWxhdGUgdmVzdGVkIHRva2VucwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgVkVTVEVEX1RPS0VOUyA9CiAgICAgICAgICAgIFRPVEFMX1RPS0VOUyAqIFRPS0VOICogVkVTVEVEX1BFUkNFTlQgLyAxMDA7CgogICAgLy8gSHV0MzQgcmV0YWlucyA1MCUgb2YgdG9rZW5zICg3MCUgLSAyMCUgdmVzdGVkIHRva2VucykKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFJFVEFJTkVEX1RPS0VOUyA9IFRPS0VOICogVE9UQUxfVE9LRU5TIC8gMjsKCiAgICAvLyBDYWxjdWxhdGUgZW5kIGRhdGUKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IEVORF9EQVRFID0gU1RBUlRfREFURSArIDM1IGRheXM7CgogICAgLy8gRGl2aWRlcyBgZXRoZXJSYWlzZWRgIHRvIGNhbGN1bGF0ZSBjb21taXNpb24KICAgIC8vIGV0aGVyUmFpc2VkLzYuNjYuLi4gPT0gZXRoZXJSYWlzZWQgKiAxLjUlIC8gMTAwCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBDT01NSVNTSU9OX0RJViA9IDY3OwoKICAgIC8vIERldmVsb3BlciBjb21taXNzaW9uIHdhbGxldAogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgQ09NTUlTU0lPTl9XQUxMRVQgPQogICAgICAgIDB4MDA2NUQ1MDZFNDc1QjVEQkQ3NjQ4MGJBRmE1N2ZlN0M0MWM3ODNhZjsKCi8vCi8vIEZ1bmN0aW9ucwovLwoKICAgIGZ1bmN0aW9uIEh1dDM0VFMoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIC8vIFJ1biBzYW5pdHkgY2hlY2tzCiAgICAgICAgcmVxdWlyZShUT1RBTF9UT0tFTlMgIT0gMCk7CiAgICAgICAgcmVxdWlyZShPV05FUiAhPSAweDApOwogICAgICAgIHJlcXVpcmUoSFVUMzRfUkVUQUlOICE9IDB4MCk7CiAgICAgICAgcmVxdWlyZShIVVQzNF9XQUxMRVQgIT0gMHgwKTsKICAgICAgICByZXF1aXJlKFBSRVNPTERfVE9LRU5TIDw9IFdIT0xFU0FMRV9UT0tFTlMpOwogICAgICAgIHJlcXVpcmUoUFJFU09MRF9UT0tFTlMgPT0gMCB8fCBQUkVTT0xEX0FERFJFU1MgIT0gMHgwKTsKICAgICAgICByZXF1aXJlKE1JTl9DQVAgIT0gMCk7CiAgICAgICAgcmVxdWlyZShTVEFSVF9EQVRFID49IG5vdyk7CiAgICAgICAgcmVxdWlyZShieXRlcyhuYW1lKS5sZW5ndGggIT0gMCk7CiAgICAgICAgcmVxdWlyZShieXRlcyhzeW1ib2wpLmxlbmd0aCAhPSAwKTsKICAgICAgICByZXF1aXJlKEtZQ19USFJFU0hPTEQgIT0gMCk7CiAgICAgICAgcmVxdWlyZShSQVRFX0RBWV8wID49IFJBVEVfREFZXzEpOwogICAgICAgIHJlcXVpcmUoUkFURV9EQVlfMSA+PSBSQVRFX0RBWV83KTsKICAgICAgICByZXF1aXJlKFJBVEVfREFZXzcgPj0gUkFURV9EQVlfMTQpOwogICAgICAgIHJlcXVpcmUoUkFURV9EQVlfMTQgPj0gUkFURV9EQVlfMjEpOwogICAgICAgIHJlcXVpcmUoUkFURV9EQVlfMjEgPj0gUkFURV9EQVlfMjgpOwoKICAgICAgICBvd25lciA9IE9XTkVSOwogICAgICAgIHRvdGFsU3VwcGx5ID0gVE9UQUxfVE9LRU5TLm11bChUT0tFTik7CiAgICAgICAgd2hvbGVzYWxlTGVmdCA9IFdIT0xFU0FMRV9UT0tFTlMubXVsKFRPS0VOKTsKICAgICAgICB1aW50IHByZXNvbGQgPSBQUkVTT0xEX1RPS0VOUy5tdWwoVE9LRU4pOwogICAgICAgIHdob2xlc2FsZUxlZnQgPSB3aG9sZXNhbGVMZWZ0LnN1YihwcmVzb2xkKTsKCiAgICAgICAgLy8gUHJlc2FsZSByYWlzZSBpcyBhcHBveGltYXRlIGdpdmVuIGl0IHdhcyBjb25kdWN0ZWQgaW4gRmlhdC4KICAgICAgICBldGhlclJhaXNlZCA9IFBSRVNBTEVfRVRIX1JBSVNFOwoKICAgICAgICAvLyBNaW50IHRoZSB0b3RhbCBzdXBwbHkgaW50byBIdXQzNCB0b2tlbiBob2xkaW5nIGFkZHJlc3MKICAgICAgICBiYWxhbmNlc1tIVVQzNF9SRVRBSU5dID0gdG90YWxTdXBwbHk7CiAgICAgICAgVHJhbnNmZXIoMHgwLCBIVVQzNF9SRVRBSU4sIHRvdGFsU3VwcGx5KTsKCiAgICAgICAgLy8gVHJhbnNmZXIgdmVzdGVkIHRva2VucyBmcm9tIGhvbGRpbmcgd2FsbGV0IHRvIHZlc3RpbmcgcHNldWRvLWFkZHJlc3MKICAgICAgICBiYWxhbmNlc1tIVVQzNF9SRVRBSU5dID0gYmFsYW5jZXNbSFVUMzRfUkVUQUlOXS5zdWIoVkVTVEVEX1RPS0VOUyk7CiAgICAgICAgYmFsYW5jZXNbSFVUMzRfVkVTVF9BRERSXSA9IGJhbGFuY2VzW0hVVDM0X1ZFU1RfQUREUl0uYWRkKFZFU1RFRF9UT0tFTlMpOwogICAgICAgIFRyYW5zZmVyKEhVVDM0X1JFVEFJTiwgSFVUMzRfVkVTVF9BRERSLCBWRVNURURfVE9LRU5TKTsKCiAgICAgICAgLy8gVHJhbnNmZXIgcHJlc29sZCB0b2tlbnMgdG8gaG9sZGluZyBhZGRyZXNzOwogICAgICAgIGJhbGFuY2VzW0hVVDM0X1JFVEFJTl0gPSBiYWxhbmNlc1tIVVQzNF9SRVRBSU5dLnN1YihwcmVzb2xkKTsKICAgICAgICBiYWxhbmNlc1tQUkVTT0xEX0FERFJFU1NdID0gYmFsYW5jZXNbUFJFU09MRF9BRERSRVNTXS5hZGQocHJlc29sZCk7CiAgICAgICAgVHJhbnNmZXIoSFVUMzRfUkVUQUlOLCBQUkVTT0xEX0FERFJFU1MsIHByZXNvbGQpOwogICAgfQoKICAgIC8vIERlZmF1bHQgZnVuY3Rpb24uIEFjY2VwdHMgcGF5bWVudHMgZHVyaW5nIGZ1bmRpbmcgcGVyaW9kCiAgICBmdW5jdGlvbiAoKQogICAgICAgIHB1YmxpYwogICAgICAgIHBheWFibGUKICAgIHsKICAgICAgICAvLyBQYXNzIHRocm91Z2ggdG8gcHVyY2hhc2luZyBmdW5jdGlvbi4gV2lsbCB0aHJvdyBvbiBmYWlsZWQgb3IKICAgICAgICAvLyBzdWNjZXNzZnVsIFRTCiAgICAgICAgcHJveHlQdXJjaGFzZShtc2cuc2VuZGVyKTsKICAgIH0KCi8vCi8vIEdldHRlcnMKLy8KCiAgICAvLyBUUyBmYWlscyBpZiBhYm9ydGVkIG9yIG1pbmltdW0gZnVuZHMgYXJlIG5vdCByYWlzZWQgYnkgdGhlIGVuZCBkYXRlCiAgICBmdW5jdGlvbiBmdW5kRmFpbGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXR1cm4gIV9fYWJvcnRGdXNlCiAgICAgICAgICAgIHx8IChub3cgPiBFTkRfREFURSAmJiBldGhlclJhaXNlZCA8IE1JTl9DQVApOwogICAgfQoKICAgIC8vIEZ1bmRpbmcgc3VjY2VlZHMgaWYgbm90IGFib3J0ZWQsIG1pbmltdW0gZnVuZHMgYXJlIHJhaXNlZCBiZWZvcmUgZW5kIGRhdGUKICAgIGZ1bmN0aW9uIGZ1bmRSYWlzZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHJldHVybiAhZnVuZEZhaWxlZCgpCiAgICAgICAgICAgICYmIGV0aGVyUmFpc2VkID49IE1JTl9DQVAKICAgICAgICAgICAgJiYgbm93ID4gU1RBUlRfREFURTsKICAgIH0KCiAgICAvLyBSZXR1cm5zIHdob2xlc2FsZSB2YWx1ZSBpbiB3ZWkKICAgIGZ1bmN0aW9uIHdob2xlU2FsZVZhbHVlTGVmdCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQpCiAgICB7CiAgICAgICAgcmV0dXJuIHdob2xlc2FsZUxlZnQgLyBSQVRFX1dIT0xFU0FMRTsKICAgIH0KCiAgICBmdW5jdGlvbiBjdXJyZW50UmF0ZSgpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnMgKHVpbnQpCiAgICB7CiAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGZ1bmRGYWlsZWQoKSA/IDAgOgogICAgICAgICAgICB0c1N1Y2NlZWRlZCA/IDAgOgogICAgICAgICAgICBub3cgPCBTVEFSVF9EQVRFID8gMCA6CiAgICAgICAgICAgIG5vdyA8IFNUQVJUX0RBVEUgKyAxIGRheXMgPyBSQVRFX0RBWV8wIDoKICAgICAgICAgICAgbm93IDwgU1RBUlRfREFURSArIDcgZGF5cyA/IFJBVEVfREFZXzEgOgogICAgICAgICAgICBub3cgPCBTVEFSVF9EQVRFICsgMTQgZGF5cyA/IFJBVEVfREFZXzcgOgogICAgICAgICAgICBub3cgPCBTVEFSVF9EQVRFICsgMjEgZGF5cyA/IFJBVEVfREFZXzE0IDoKICAgICAgICAgICAgbm93IDwgU1RBUlRfREFURSArIDI4IGRheXMgPyBSQVRFX0RBWV8yMSA6CiAgICAgICAgICAgIG5vdyA8IEVORF9EQVRFID8gUkFURV9EQVlfMjggOgogICAgICAgICAgICAwOwogICAgfQoKICAgIC8vIENhbGN1bGF0ZXMgdGhlIHNhbGUgYW5kIHdob2xlc2FsZSBwb3J0aW9uIG9mIHRva2VucyBmb3IgYSBnaXZlbiB2YWx1ZQogICAgLy8gb2Ygd2VpIGF0IHRoZSB0aW1lIG9mIGNhbGxpbmcuCiAgICBmdW5jdGlvbiBldGhUb1Rva2Vucyh1aW50IF93ZWkpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnMgKHVpbnQgYWxsVG9rZW5zXywgdWludCB3aG9sZXNhbGVUb2tlbnNfKQogICAgewogICAgICAgIC8vIEdldCB3aG9sZXNhbGUgcG9ydGlvbiBvZiBldGhlciBhbmQgdG9rZW5zCiAgICAgICAgdWludCB3c1ZhbHVlTGVmdCA9IHdob2xlU2FsZVZhbHVlTGVmdCgpOwogICAgICAgIHVpbnQgd2hvbGVzYWxlU3BlbmQgPQogICAgICAgICAgICAgICAgZnVuZEZhaWxlZCgpID8gMCA6CiAgICAgICAgICAgICAgICB0c1N1Y2NlZWRlZCA/IDAgOgogICAgICAgICAgICAgICAgbm93IDwgU1RBUlRfREFURSA/IDAgOgogICAgICAgICAgICAgICAgbm93ID4gRU5EX0RBVEUgPyAwIDoKICAgICAgICAgICAgICAgIC8vIE5vIHdob2xlc2FsZSBwdXJjaHNlCiAgICAgICAgICAgICAgICBfd2VpIDwgV0hPTEVTQUxFX1RIUkVTSE9MRCA/IDAgOgogICAgICAgICAgICAgICAgLy8gVG90YWwgd2hvbGVzYWxlIHB1cmNoYXNlCiAgICAgICAgICAgICAgICBfd2VpIDwgd3NWYWx1ZUxlZnQgPyAgX3dlaSA6CiAgICAgICAgICAgICAgICAvLyBvdmVyIGZ1bmRlZCBmb3IgcmVtYWluaW5nIHdob2xlc2FsZSB0b2tlbnMKICAgICAgICAgICAgICAgIHdzVmFsdWVMZWZ0OwoKICAgICAgICB3aG9sZXNhbGVUb2tlbnNfID0gd2hvbGVzYWxlU3BlbmQKICAgICAgICAgICAgICAgIC5tdWwoUkFURV9XSE9MRVNBTEUpCiAgICAgICAgICAgICAgICAubXVsKFRPS0VOKQogICAgICAgICAgICAgICAgLmRpdigxIGV0aGVyKTsKCiAgICAgICAgLy8gUmVtYWluaW5nIHdlaSB1c2VkIHRvIHB1cmNoYXNlIHJldGFpbCB0b2tlbnMKICAgICAgICBfd2VpID0gX3dlaS5zdWIod2hvbGVzYWxlU3BlbmQpOwoKICAgICAgICAvLyBHZXQgcmV0YWlsIHJhdGUKICAgICAgICB1aW50IHNhbGVSYXRlID0gY3VycmVudFJhdGUoKTsKCiAgICAgICAgYWxsVG9rZW5zXyA9IF93ZWkKICAgICAgICAgICAgICAgIC5tdWwoc2FsZVJhdGUpCiAgICAgICAgICAgICAgICAubXVsKFRPS0VOKQogICAgICAgICAgICAgICAgLmRpdigxIGV0aGVyKQogICAgICAgICAgICAgICAgLmFkZCh3aG9sZXNhbGVUb2tlbnNfKTsKICAgIH0KCi8vCi8vIFRTIGZ1bmN0aW9ucwovLwoKICAgIC8vIFRoZSBmdW5kcmFpc2luZyBjYW4gYmUgYWJvcnRlZCBhbnkgdGltZSBiZWZvcmUgYGZpbmFsaXNlVFMoKWAgaXMgY2FsbGVkLgogICAgLy8gVGhpcyB3aWxsIGZvcmNlIGEgZmFpbCBzdGF0ZSBhbmQgYWxsb3cgcmVmdW5kcyB0byBiZSBjb2xsZWN0ZWQuCiAgICAvLyBUaGUgb3duZXIgY2FuIGFib3J0IG9yIGFueW9uZSBlbHNlIGlmIGEgc3VjY2Vzc2Z1bCBmdW5kIGhhcyBub3QgYmVlbgogICAgLy8gZmluYWxpc2VkIGJlZm9yZSA3IGRheXMgYWZ0ZXIgdGhlIGVuZCBkYXRlLgogICAgZnVuY3Rpb24gYWJvcnQoKQogICAgICAgIHB1YmxpYwogICAgICAgIG5vUmVlbnRyeQogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmVxdWlyZSghdHNTdWNjZWVkZWQpOwogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lciB8fCBub3cgPiBFTkRfREFURSAgKyAxNCBkYXlzKTsKICAgICAgICBkZWxldGUgX19hYm9ydEZ1c2U7CiAgICAgICAgQWJvcnRlZCgpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vIEdlbmVyYWwgYWRkcmVzc2VzIGNhbiBwdXJjaGFzZSB0b2tlbnMgZHVyaW5nIGZ1bmRpbmcKICAgIGZ1bmN0aW9uIHByb3h5UHVyY2hhc2UoYWRkcmVzcyBfYWRkcikKICAgICAgICBwdWJsaWMKICAgICAgICBwYXlhYmxlCiAgICAgICAgbm9SZWVudHJ5CiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXF1aXJlKCFmdW5kRmFpbGVkKCkpOwogICAgICAgIHJlcXVpcmUoIXRzU3VjY2VlZGVkKTsKICAgICAgICByZXF1aXJlKG5vdyA+IFNUQVJUX0RBVEUpOwogICAgICAgIHJlcXVpcmUobm93IDw9IEVORF9EQVRFKTsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+IDApOwoKICAgICAgICAvLyBMb2cgZXRoZXIgZGVwb3NpdAogICAgICAgIERlcG9zaXQgKF9hZGRyLCBtc2cudmFsdWUpOwoKICAgICAgICAvLyBHZXQgZXRoZXIgdG8gdG9rZW4gY29udmVyc2lvbgogICAgICAgIHVpbnQgdG9rZW5zOwogICAgICAgIC8vIFBvcnRpb24gb2YgdG9rZW5zIHNvbGQgYXQgd2hvbGVzYWxlIHJhdGUKICAgICAgICB1aW50IHdob2xlc2FsZVRva2VuczsKCiAgICAgICAgKHRva2Vucywgd2hvbGVzYWxlVG9rZW5zKSA9IGV0aFRvVG9rZW5zKG1zZy52YWx1ZSk7CgogICAgICAgIC8vIEJsb2NrIGFueSBmYWlsZWQgdG9rZW4gY3JlYXRpb24KICAgICAgICByZXF1aXJlKHRva2VucyA+IDApOwoKICAgICAgICAvLyBQcmV2ZW50IG92ZXIgc3Vic2NyaWJpbmcKICAgICAgICByZXF1aXJlKGJhbGFuY2VzW0hVVDM0X1JFVEFJTl0gLSB0b2tlbnMgPj0gUkVUQUlORURfVE9LRU5TKTsKCiAgICAgICAgLy8gQWRqdXN0IHdob2xlc2FsZSB0b2tlbnMgbGVmdCBmb3Igc2FsZQogICAgICAgIGlmICh3aG9sZXNhbGVUb2tlbnMgIT0gMCkgewogICAgICAgICAgICB3aG9sZXNhbGVMZWZ0ID0gd2hvbGVzYWxlTGVmdC5zdWIod2hvbGVzYWxlVG9rZW5zKTsKICAgICAgICB9CgogICAgICAgIC8vIHRyYW5zZmVyIHRva2VucyBmcm9tIGZ1bmQgd2FsbGV0CiAgICAgICAgYmFsYW5jZXNbSFVUMzRfUkVUQUlOXSA9IGJhbGFuY2VzW0hVVDM0X1JFVEFJTl0uc3ViKHRva2Vucyk7CiAgICAgICAgYmFsYW5jZXNbX2FkZHJdID0gYmFsYW5jZXNbX2FkZHJdLmFkZCh0b2tlbnMpOwogICAgICAgIFRyYW5zZmVyKEhVVDM0X1JFVEFJTiwgX2FkZHIsIHRva2Vucyk7CgogICAgICAgIC8vIFVwZGF0ZSBmdW5kcyByYWlzZWQKICAgICAgICBldGhlclJhaXNlZCA9IGV0aGVyUmFpc2VkLmFkZChtc2cudmFsdWUpOwoKICAgICAgICAvLyBVcGRhdGUgaG9sZGVyIHBheW1lbnRzCiAgICAgICAgZXRoZXJDb250cmlidXRlZFtfYWRkcl0gPSBldGhlckNvbnRyaWJ1dGVkW19hZGRyXS5hZGQobXNnLnZhbHVlKTsKCiAgICAgICAgLy8gQ2hlY2sgS1lDIHJlcXVpcmVtZW50CiAgICAgICAgaWYoZXRoZXJDb250cmlidXRlZFtfYWRkcl0gPj0gS1lDX1RIUkVTSE9MRCAmJiAhbXVzdEt5Y1tfYWRkcl0pIHsKICAgICAgICAgICAgbXVzdEt5Y1tfYWRkcl0gPSB0cnVlOwogICAgICAgICAgICBLeWMoX2FkZHIsIHRydWUpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gT3duZXIgY2FuIHN3ZWVwIGEgc3VjY2Vzc2Z1bCBmdW5kaW5nIHRvIHRoZSBmdW5kV2FsbGV0LgogICAgLy8gQ2FuIGJlIGNhbGxlZCByZXBlYXRlZGx5IHRvIHJlY292ZXIgZXJyYW50IGV0aGVyIHdoaWNoIG1heSBoYXZlIGJlZW4KICAgIC8vIGBzZWxmZGVzdHJ1Y3RlZGAgdG8gdGhlIGNvbnRyYWN0CiAgICAvLyBDb250cmFjdCBjYW4gYmUgYWJvcnRlZCB1cCB1bnRpbCB0aGlzIHJldHVybnMgYHRydWVgCiAgICBmdW5jdGlvbiBmaW5hbGl6ZVRTKCkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5T3duZXIKICAgICAgICBwcmV2ZW50UmVlbnRyeSgpCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICAvLyBNdXN0IGhhdmUgcmVhY2hlZCBtaW5pbXVtIGNhcAogICAgICAgIHJlcXVpcmUoZnVuZFJhaXNlZCgpKTsKCiAgICAgICAgLy8gU2V0IGZpcnN0IHZlc3RpbmcgZGF0ZSAob25seSBvbmNlIGFzIHRoaXMgZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCBhZ2FpbikKICAgICAgICBpZighdHNTdWNjZWVkZWQpIHsKICAgICAgICAgICAgbmV4dFJlbGVhc2VEYXRlID0gbm93ICsgVkVTVElOR19QRVJJT0Q7CiAgICAgICAgfQoKICAgICAgICAvLyBTZXQgc3VjY2VzcyBmbGFnOwogICAgICAgIHRzU3VjY2VlZGVkID0gdHJ1ZTsKCiAgICAgICAgLy8gVHJhbnNmZXIgJSBEZXZlbG9wZXIgY29tbWlzc2lvbgogICAgICAgIHVpbnQgZGV2Q29tbWlzc2lvbiA9IGNhbGNDb21taXNzaW9uKCk7CiAgICAgICAgV2l0aGRyYXdhbCh0aGlzLCBDT01NSVNTSU9OX1dBTExFVCwgZGV2Q29tbWlzc2lvbik7CiAgICAgICAgQ09NTUlTU0lPTl9XQUxMRVQudHJhbnNmZXIoZGV2Q29tbWlzc2lvbik7CgogICAgICAgIC8vIFJlbWFpbmluZyAlIHRvIHRoZSBmdW5kIHdhbGxldAogICAgICAgIFdpdGhkcmF3YWwodGhpcywgSFVUMzRfV0FMTEVULCB0aGlzLmJhbGFuY2UpOwogICAgICAgIEhVVDM0X1dBTExFVC50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGNsZWFyS3ljKGFkZHJlc3NbXSBfYWRkcnMpCiAgICAgICAgcHVibGljCiAgICAgICAgbm9SZWVudHJ5CiAgICAgICAgb25seU93bmVyCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICB1aW50IGxlbiA9IF9hZGRycy5sZW5ndGg7CiAgICAgICAgZm9yKHVpbnQgaTsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICAgIGRlbGV0ZSBtdXN0S3ljW19hZGRyc1tpXV07CiAgICAgICAgICAgIEt5YyhfYWRkcnNbaV0sIGZhbHNlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gUmVsZWFzZXMgdmVzdGVkIHRva2VucyBiYWNrIHRvIEh1dDM0IHdhbGxldAogICAgZnVuY3Rpb24gcmVsZWFzZVZlc3RlZCgpCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXF1aXJlKG5vdyA+IG5leHRSZWxlYXNlRGF0ZSk7CiAgICAgICAgVmVzdGluZ1JlbGVhc2VkKG5leHRSZWxlYXNlRGF0ZSk7CiAgICAgICAgbmV4dFJlbGVhc2VEYXRlID0gbmV4dFJlbGVhc2VEYXRlLmFkZChWRVNUSU5HX1BFUklPRCk7CiAgICAgICAgcmV0dXJuIHhmZXIoSFVUMzRfVkVTVF9BRERSLCBIVVQzNF9SRVRBSU4sIFZFU1RFRF9UT0tFTlMgLyA0KTsKICAgIH0KCiAgICAvLyBEaXJlY3QgcmVmdW5kIHRvIGNhbGxlcgogICAgZnVuY3Rpb24gcmVmdW5kKCkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIGFkZHJlc3NbXSBtZW1vcnkgYWRkcnMgPSBuZXcgYWRkcmVzc1tdKDEpOwogICAgICAgIGFkZHJzWzBdID0gbXNnLnNlbmRlcjsKICAgICAgICByZXR1cm4gcmVmdW5kRm9yKGFkZHJzKTsKICAgIH0KCiAgICAvLyBCdWxrIHJlZnVuZHMgY2FuIGJlIHB1c2hlZCBmcm9tIGEgZmFpbGVkIFRTCiAgICBmdW5jdGlvbiByZWZ1bmRGb3IoYWRkcmVzc1tdIF9hZGRycykKICAgICAgICBwdWJsaWMKICAgICAgICBwcmV2ZW50UmVlbnRyeSgpCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXF1aXJlKGZ1bmRGYWlsZWQoKSk7CiAgICAgICAgdWludCBpOwogICAgICAgIHVpbnQgbGVuID0gX2FkZHJzLmxlbmd0aDsKICAgICAgICB1aW50IHZhbHVlOwogICAgICAgIHVpbnQgdG9rZW5zOwogICAgICAgIGFkZHJlc3MgYWRkcjsKCiAgICAgICAgZm9yIChpOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICAgICAgYWRkciA9IF9hZGRyc1tpXTsKICAgICAgICAgICAgdmFsdWUgPSBldGhlckNvbnRyaWJ1dGVkW2FkZHJdOwogICAgICAgICAgICB0b2tlbnMgPSBiYWxhbmNlc1thZGRyXTsKICAgICAgICAgICAgaWYgKHRva2VucyA+IDApIHsKICAgICAgICAgICAgICAgIC8vIFJldHVybiB0b2tlbnMKICAgICAgICAgICAgICAgIC8vIHRyYW5zZmVyIHRva2VucyBmcm9tIGZ1bmQgd2FsbGV0CiAgICAgICAgICAgICAgICBiYWxhbmNlc1tIVVQzNF9SRVRBSU5dID0gYmFsYW5jZXNbSFVUMzRfUkVUQUlOXS5hZGQodG9rZW5zKTsKICAgICAgICAgICAgICAgIGRlbGV0ZSBiYWxhbmNlc1thZGRyXTsKICAgICAgICAgICAgICAgIFRyYW5zZmVyKGFkZHIsIEhVVDM0X1JFVEFJTiwgdG9rZW5zKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHZhbHVlID4gMCkgewogICAgICAgICAgICAgICAgLy8gUmVmdW5kIGV0aGVyIGNvbnRyaWJ1dGlvbgogICAgICAgICAgICAgICAgZGVsZXRlIGV0aGVyQ29udHJpYnV0ZWRbYWRkcl07CiAgICAgICAgICAgICAgICBkZWxldGUgbXVzdEt5Y1thZGRyXTsKICAgICAgICAgICAgICAgIHJlZnVuZGVkID0gcmVmdW5kZWQuYWRkKHZhbHVlKTsKICAgICAgICAgICAgICAgIFdpdGhkcmF3YWwodGhpcywgYWRkciwgdmFsdWUpOwogICAgICAgICAgICAgICAgYWRkci50cmFuc2Zlcih2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgovLwovLyBFUkMyMCBhZGRpdGlvbmFsIGFuZCBvdmVybG9hZGVkIGZ1bmN0aW9ucwovLwoKICAgIC8vIEFsbG93cyBhIHNlbmRlciB0byB0cmFuc2ZlciB0b2tlbnMgdG8gYW4gYXJyYXkgb2YgcmVjaXBpZW50cwogICAgZnVuY3Rpb24gdHJhbnNmZXJUb01hbnkoYWRkcmVzc1tdIF9hZGRycywgdWludFtdIF9hbW91bnRzKQogICAgICAgIHB1YmxpYwogICAgICAgIG5vUmVlbnRyeQogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmVxdWlyZShfYWRkcnMubGVuZ3RoID09IF9hbW91bnRzLmxlbmd0aCk7CiAgICAgICAgdWludCBsZW4gPSBfYWRkcnMubGVuZ3RoOwogICAgICAgIGZvcih1aW50IGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICAgICAgeGZlcihtc2cuc2VuZGVyLCBfYWRkcnNbaV0sIF9hbW91bnRzW2ldKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gT3ZlcmxvYWQgdG8gY2hlY2sgVFMgc3VjY2VzcyBhbmQgS1lDIGZsYWdzLgogICAgZnVuY3Rpb24geGZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfYW1vdW50KQogICAgICAgIGludGVybmFsCiAgICAgICAgbm9SZWVudHJ5CiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXF1aXJlKHRzU3VjY2VlZGVkKTsKICAgICAgICByZXF1aXJlKCFtdXN0S3ljW19mcm9tXSk7CiAgICAgICAgc3VwZXIueGZlcihfZnJvbSwgX3RvLCBfYW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBPdmVybG9hZCB0byByZXF1aXJlIFRTIHN1Y2Nlc3MKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYW1vdW50KQogICAgICAgIHB1YmxpYwogICAgICAgIG5vUmVlbnRyeQogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgLy8gVFMgbXVzdCBiZSBzdWNjZXNzZnVsCiAgICAgICAgcmVxdWlyZSh0c1N1Y2NlZWRlZCk7CiAgICAgICAgc3VwZXIuYXBwcm92ZShfc3BlbmRlciwgX2Ftb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgovLwovLyBDb250cmFjdCBtYW5hZ2VtZW50IGZ1bmN0aW9ucwovLwoKICAgIC8vIEluaXRpYXRlIGEgY2hhbmdlIG9mIG93bmVyIHRvIGBfb3duZXJgCiAgICBmdW5jdGlvbiBjaGFuZ2VPd25lcihhZGRyZXNzIF9vd25lcikKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5T3duZXIKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIENoYW5nZU93bmVyVG8oX293bmVyKTsKICAgICAgICBuZXdPd25lciA9IF9vd25lcjsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBGaW5hbGlzZSBjaGFuZ2Ugb2Ygb3duZXJzaGlwIHRvIG5ld093bmVyCiAgICBmdW5jdGlvbiBhY2NlcHRPd25lcnNoaXAoKQogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG5ld093bmVyKTsKICAgICAgICBDaGFuZ2VkT3duZXIob3duZXIsIG1zZy5zZW5kZXIpOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICAgICAgZGVsZXRlIG5ld093bmVyOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vIFRoaXMgd2lsbCBzZWxmZGVzdHJ1Y3QgdGhlIGNvbnRyYWN0IG9uIHRoZSBjb25kaXR0aW9uIGFsbCBoYXZlIGJlZW4KICAgIC8vIHByb2Nlc3NlZC4KICAgIGZ1bmN0aW9uIGRlc3Ryb3koKQogICAgICAgIHB1YmxpYwogICAgICAgIG5vUmVlbnRyeQogICAgICAgIG9ubHlPd25lcgogICAgewogICAgICAgIHJlcXVpcmUoIV9fYWJvcnRGdXNlKTsKICAgICAgICByZXF1aXJlKHJlZnVuZGVkID09IChldGhlclJhaXNlZCAtIFBSRVNBTEVfRVRIX1JBSVNFKSk7CiAgICAgICAgLy8gTG9nIGJ1cm5lZCB0b2tlbnMgZm9yIGNvbXBsZXRlIGxlZGdlciBhY2NvdW50aW5nIG9uIGFyY2hpdmFsIG5vZGVzCiAgICAgICAgVHJhbnNmZXIoSFVUMzRfUkVUQUlOLCAweDAsIGJhbGFuY2VzW0hVVDM0X1JFVEFJTl0pOwogICAgICAgIFRyYW5zZmVyKEhVVDM0X1ZFU1RfQUREUiwgMHgwLCBWRVNURURfVE9LRU5TKTsKICAgICAgICBUcmFuc2ZlcihQUkVTT0xEX0FERFJFU1MsIDB4MCwgUFJFU09MRF9UT0tFTlMpOwogICAgICAgIC8vIEdhcmJhZ2UgY29sbGVjdCBtYXBwZWQgc3RhdGUKICAgICAgICBkZWxldGUgYmFsYW5jZXNbSFVUMzRfUkVUQUlOXTsKICAgICAgICBkZWxldGUgYmFsYW5jZXNbUFJFU09MRF9BRERSRVNTXTsKICAgICAgICBzZWxmZGVzdHJ1Y3Qob3duZXIpOwogICAgfQoKICAgIC8vIE93bmVyIGNhbiBzYWx2YWdlIEVSQzIwIHRva2VucyB0aGF0IG1heSBoYXZlIGJlZW4gc2VudCB0byB0aGUgYWNjb3VudAogICAgZnVuY3Rpb24gdHJhbnNmZXJFeHRlcm5hbFRva2VuKGFkZHJlc3MgX2tBZGRyLCBhZGRyZXNzIF90bywgdWludCBfYW1vdW50KQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlPd25lcgogICAgICAgIHByZXZlbnRSZWVudHJ5CiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXF1aXJlKEVSQzIwVG9rZW4oX2tBZGRyKS50cmFuc2ZlcihfdG8sIF9hbW91bnQpKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBDYWxjdWxhdGUgY29tbWlzc2lvbiBvbiBwcmVmdW5kZWQgYW5kIHJhaXNlZCBldGhlci4KICAgIGZ1bmN0aW9uIGNhbGNDb21taXNzaW9uKCkKICAgICAgICBpbnRlcm5hbAogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zKHVpbnQpCiAgICB7CiAgICAgICAgdWludCBjb21taXNzaW9uID0gKHRoaXMuYmFsYW5jZSArIFBSRVNBTEVfRVRIX1JBSVNFKSAvIENPTU1JU1NJT05fRElWOwogICAgICAgIC8vIEVkZ2UgY2FzZSB0aGF0IHByZWZ1bmQgY2F1c2VzIGNvbW1pc3Npb24gdG8gYmUgZ3JlYXRlciB0aGFuIGJhbGFuY2UKICAgICAgICByZXR1cm4gY29tbWlzc2lvbiA8PSB0aGlzLmJhbGFuY2UgPyBjb21taXNzaW9uIDogdGhpcy5iYWxhbmNlOwogICAgfQp9'.
	

]
