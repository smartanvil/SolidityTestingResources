Class {
	#name : #SRT740650f830a0aec0f27821174d1b5737f9636017,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT740650f830a0aec0f27821174d1b5737f9636017 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgoKLyoqCiAqIE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MKICovCmxpYnJhcnkgU2FmZU1hdGggewogIGZ1bmN0aW9uIG11bCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgdWludCBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIGFzc2VydChiID4gMCk7CiAgICB1aW50IGMgPSBhIC8gYjsKICAgIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICB1aW50IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBtYXg2NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgewogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOwogIH0KCiAgZnVuY3Rpb24gbWluNjQodWludDY0IGEsIHVpbnQ2NCBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50NjQpIHsKICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOwogIH0KCiAgZnVuY3Rpb24gbWF4MjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7CiAgfQoKICBmdW5jdGlvbiBtaW4yNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOwogIH0KfQoKCnByYWdtYSBzb2xpZGl0eSBeMC40LjExOwoKCi8vLyBAZGV2IGBPd25lZGAgaXMgYSBiYXNlIGxldmVsIGNvbnRyYWN0IHRoYXQgYXNzaWducyBhbiBgb3duZXJgIHRoYXQgY2FuIGJlCi8vLyAgbGF0ZXIgY2hhbmdlZApjb250cmFjdCBPd25lZCB7CgogICAgLy8vIEBkZXYgYG93bmVyYCBpcyB0aGUgb25seSBhZGRyZXNzIHRoYXQgY2FuIGNhbGwgYSBmdW5jdGlvbiB3aXRoIHRoaXMKICAgIC8vLyBtb2RpZmllcgogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgICAvLy8gQG5vdGljZSBUaGUgQ29uc3RydWN0b3IgYXNzaWducyB0aGUgbWVzc2FnZSBzZW5kZXIgdG8gYmUgYG93bmVyYAogICAgZnVuY3Rpb24gT3duZWQoKSB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIGFkZHJlc3MgcHVibGljIG5ld093bmVyOwoKICAgIC8vLyBAbm90aWNlIGBvd25lcmAgY2FuIHN0ZXAgZG93biBhbmQgYXNzaWduIHNvbWUgb3RoZXIgYWRkcmVzcyB0byB0aGlzIHJvbGUKICAgIC8vLyBAcGFyYW0gX25ld093bmVyIFRoZSBhZGRyZXNzIG9mIHRoZSBuZXcgb3duZXIuIDB4MCBjYW4gYmUgdXNlZCB0byBjcmVhdGUKICAgIC8vLyAgYW4gdW5vd25lZCBuZXV0cmFsIHZhdWx0LCBob3dldmVyIHRoYXQgY2Fubm90IGJlIHVuZG9uZQogICAgZnVuY3Rpb24gY2hhbmdlT3duZXIoYWRkcmVzcyBfbmV3T3duZXIpIG9ubHlPd25lciB7CiAgICAgICAgbmV3T3duZXIgPSBfbmV3T3duZXI7CiAgICB9CgoKICAgIGZ1bmN0aW9uIGFjY2VwdE93bmVyc2hpcCgpIHsKICAgICAgICBpZiAobXNnLnNlbmRlciA9PSBuZXdPd25lcikgewogICAgICAgICAgICBvd25lciA9IG5ld093bmVyOwogICAgICAgIH0KICAgIH0KfQoKLy8gQWJzdHJhY3QgY29udHJhY3QgZm9yIHRoZSBmdWxsIEVSQyAyMCBUb2tlbiBzdGFuZGFyZAovLyBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7Cgpjb250cmFjdCBFUkMyMFByb3RvY29sIHsKICAgIC8qIFRoaXMgaXMgYSBzbGlnaHQgY2hhbmdlIHRvIHRoZSBFUkMyMCBiYXNlIHN0YW5kYXJkLgogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50IHN1cHBseSk7CiAgICBpcyByZXBsYWNlZCB3aXRoOgogICAgdWludCBwdWJsaWMgdG90YWxTdXBwbHk7CiAgICBUaGlzIGF1dG9tYXRpY2FsbHkgY3JlYXRlcyBhIGdldHRlciBmdW5jdGlvbiBmb3IgdGhlIHRvdGFsU3VwcGx5LgogICAgVGhpcyBpcyBtb3ZlZCB0byB0aGUgYmFzZSBjb250cmFjdCBzaW5jZSBwdWJsaWMgZ2V0dGVyIGZ1bmN0aW9ucyBhcmUgbm90CiAgICBjdXJyZW50bHkgcmVjb2duaXNlZCBhcyBhbiBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgbWF0Y2hpbmcgYWJzdHJhY3QKICAgIGZ1bmN0aW9uIGJ5IHRoZSBjb21waWxlci4KICAgICovCiAgICAvLy8gdG90YWwgYW1vdW50IG9mIHRva2VucwogICAgdWludCBwdWJsaWMgdG90YWxTdXBwbHk7CgogICAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgZnJvbSB3aGljaCB0aGUgYmFsYW5jZSB3aWxsIGJlIHJldHJpZXZlZAogICAgLy8vIEByZXR1cm4gVGhlIGJhbGFuY2UKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKTsKCiAgICAvLy8gQG5vdGljZSBzZW5kIGBfdmFsdWVgIHRva2VuIHRvIGBfdG9gIGZyb20gYG1zZy5zZW5kZXJgCiAgICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCiAgICAvLy8gQG5vdGljZSBzZW5kIGBfdmFsdWVgIHRva2VuIHRvIGBfdG9gIGZyb20gYF9mcm9tYCBvbiB0aGUgY29uZGl0aW9uIGl0IGlzIGFwcHJvdmVkIGJ5IGBfZnJvbWAKICAgIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3Mgb2YgdGhlIHNlbmRlcgogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudAogICAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZAogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgdHJhbnNmZXIgd2FzIHN1Y2Nlc3NmdWwgb3Igbm90CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8vLyBAbm90aWNlIGBtc2cuc2VuZGVyYCBhcHByb3ZlcyBgX3NwZW5kZXJgIHRvIHNwZW5kIGBfdmFsdWVgIHRva2VucwogICAgLy8vIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBhYmxlIHRvIHRyYW5zZmVyIHRoZSB0b2tlbnMKICAgIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIGFwcHJvdmVkIGZvciB0cmFuc2ZlcgogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgYXBwcm92YWwgd2FzIHN1Y2Nlc3NmdWwgb3Igbm90CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IG93bmluZyB0b2tlbnMKICAgIC8vLyBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgYWJsZSB0byB0cmFuc2ZlciB0aGUgdG9rZW5zCiAgICAvLy8gQHJldHVybiBBbW91bnQgb2YgcmVtYWluaW5nIHRva2VucyBhbGxvd2VkIHRvIHNwZW50CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcmVtYWluaW5nKTsKCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQgX3ZhbHVlKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludCBfdmFsdWUpOwp9CgoKcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgovL2ltcG9ydCAiLi9FUkMyMFByb3RvY29sLnNvbCI7Ci8vaW1wb3J0ICIuL1NhZmVNYXRoLnNvbCI7Cgpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwUHJvdG9jb2wgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CgogICAgLyoqCiAgICAqIEBkZXYgRml4IGZvciB0aGUgRVJDMjAgc2hvcnQgYWRkcmVzcyBhdHRhY2suCiAgICAqLwogICAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgc2l6ZSkgewogICAgICAgIHJlcXVpcmUobXNnLmRhdGEubGVuZ3RoID49IHNpemUgKyA0KTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDIgKiAzMikgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgLy9EZWZhdWx0IGFzc3VtZXMgdG90YWxTdXBwbHkgY2FuJ3QgYmUgb3ZlciBtYXggKDJeMjU2IC0gMSkuCiAgICAgICAgLy9JZiB5b3VyIHRva2VuIGxlYXZlcyBvdXQgdG90YWxTdXBwbHkgYW5kIGNhbiBpc3N1ZSBtb3JlIHRva2VucyBhcyB0aW1lIGdvZXMgb24sIHlvdSBuZWVkIHRvIGNoZWNrIGlmIGl0IGRvZXNuJ3Qgd3JhcC4KICAgICAgICAvL1JlcGxhY2UgdGhlIGlmIHdpdGggdGhpcyBvbmUgaW5zdGVhZC4KICAgICAgICAvL2lmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+IGJhbGFuY2VzW190b10pIHsKICAgICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdIC09IF92YWx1ZTsKICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7CiAgICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDMgKiAzMikgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgLy9zYW1lIGFzIGFib3ZlLiBSZXBsYWNlIHRoaXMgbGluZSB3aXRoIHRoZSBmb2xsb3dpbmcgaWYgeW91IHdhbnQgdG8gcHJvdGVjdCBhZ2FpbnN0IHdyYXBwaW5nIHVpbnRzLgogICAgICAgIC8vaWYgKGJhbGFuY2VzW19mcm9tXSA+PSBfdmFsdWUgJiYgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIGJhbGFuY2VzW190b10gKyBfdmFsdWUgPiBiYWxhbmNlc1tfdG9dKSB7CiAgICAgICAgaWYgKGJhbGFuY2VzW19mcm9tXSA+PSBfdmFsdWUgJiYgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPj0gX3ZhbHVlKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW190b10gKz0gX3ZhbHVlOwogICAgICAgICAgICBiYWxhbmNlc1tfZnJvbV0gLT0gX3ZhbHVlOwogICAgICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICAgICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSB7IHJldHVybiBmYWxzZTsgfQogICAgfQoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDIgKiAzMikgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2AKICAgICAgICAvLyAgYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyBgYXBwcm92ZShfc3BlbmRlciwgMClgIGlmIGl0IGlzIG5vdAogICAgICAgIC8vICBhbHJlYWR5IDAgdG8gbWl0aWdhdGUgdGhlIHJhY2UgY29uZGl0aW9uIGRlc2NyaWJlZCBoZXJlOgogICAgICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgICAgIGFzc2VydCgoX3ZhbHVlID09IDApIHx8IChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9PSAwKSk7CgogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCByZW1haW5pbmcpIHsKICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgICB9CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBiYWxhbmNlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSkgYWxsb3dlZDsKfQoKCgoKcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgoKLyoKCiAgQ29weXJpZ2h0IDIwMTcgV2FuY2hhaW4gRm91bmRhdGlvbi4KCiAgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoKICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCiAgVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQogIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoKKi8KCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8gICAgICAgICAgIF8gICAgICAgICAgIF8KLy8gIF9fICAgICAgX19fXyBfIF8gX18gICBfX198IHxfXyAgIF9fIF8oXylfIF9fICAgX198IHwgX19fX18gICBfXwovLyAgXCBcIC9cIC8gLyBfYCB8ICdfIFwgLyBfX3wgJ18gXCAvIF9gIHwgfCAnXyBcQC8gX2AgfC8gXyBcIFwgLyAvCi8vICAgXCBWICBWIC8gKF98IHwgfCB8IHwgKF9ffCB8IHwgfCAoX3wgfCB8IHwgfCB8IChffCB8ICBfXy9cIFYgLwovLyAgICBcXy9cXy8gXF9fLF98X3wgfF98XF9fX3xffCB8X3xcX18sX3xffF98IHxffFxfXyxffFxfX198IFxfLwovLwovLyAgQ29kZSBzdHlsZSBhY2NvcmRpbmcgdG86IGh0dHBzOi8vZ2l0aHViLmNvbS93YW5jaGFpbi93YW5jaGFpbi10b2tlbi9ibG9iL21hc3Rlci9zdHlsZS1ndWlkZS5yc3QKCgoKLy9pbXBvcnQgIi4vU3RhbmRhcmRUb2tlbi5zb2wiOwovL2ltcG9ydCAiLi9TYWZlTWF0aC5zb2wiOwoKCi8vLyBAdGl0bGUgV2FuY2hhaW4gVG9rZW4gQ29udHJhY3QKLy8vIEZvciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IHRoaXMgdG9rZW4gc2FsZSwgcGxlYXNlIHZpc2l0IGh0dHBzOi8vd2FuY2hhaW4ub3JnCi8vLyBAYXV0aG9yIENhdGh5IC0gPDxhIGhyZWY9Ii9jZG4tY2dpL2wvZW1haWwtcHJvdGVjdGlvbiIgY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSI3MjExMTMwNjFhMGIzMjA1MTMxYzExMWExMzFiMWM1YzFkMDAxNSI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvYT4+CmNvbnRyYWN0IFdhblRva2VuIGlzIFN0YW5kYXJkVG9rZW4gewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CgogICAgLy8vIENvbnN0YW50IHRva2VuIHNwZWNpZmljIGZpZWxkcwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIldhbkNvaW4iOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiV0FOIjsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CgogICAgLy8vIFdhbmNoYWluIHRvdGFsIHRva2VucyBzdXBwbHkKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IE1BWF9UT1RBTF9UT0tFTl9BTU9VTlQgPSAyMTAwMDAwMDAgZXRoZXI7CgogICAgLy8vIEZpZWxkcyB0aGF0IGFyZSBvbmx5IGNoYW5nZWQgaW4gY29uc3RydWN0b3IKICAgIC8vLyBXYW5jaGFpbiBjb250cmlidXRpb24gY29udHJhY3QKICAgIGFkZHJlc3MgcHVibGljIG1pbnRlcjsKICAgIC8vLyBJQ08gc3RhcnQgdGltZQogICAgdWludCBwdWJsaWMgc3RhcnRUaW1lOwogICAgLy8vIElDTyBlbmQgdGltZQogICAgdWludCBwdWJsaWMgZW5kVGltZTsKCiAgICAvLy8gRmllbGRzIHRoYXQgY2FuIGJlIGNoYW5nZWQgYnkgZnVuY3Rpb25zCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBsb2NrZWRCYWxhbmNlczsKICAgIC8qCiAgICAgKiBNT0RJRklFUlMKICAgICAqLwoKICAgIG1vZGlmaWVyIG9ubHlNaW50ZXIgewogICAgCSAgYXNzZXJ0KG1zZy5zZW5kZXIgPT0gbWludGVyKTsKICAgIAkgIF87CiAgICB9CgogICAgbW9kaWZpZXIgaXNMYXRlclRoYW4gKHVpbnQgeCl7CiAgICAJICBhc3NlcnQobm93ID4geCk7CiAgICAJICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG1heFdhblRva2VuQW1vdW50Tm90UmVhY2hlZCAodWludCBhbW91bnQpewogICAgCSAgYXNzZXJ0KHRvdGFsU3VwcGx5LmFkZChhbW91bnQpIDw9IE1BWF9UT1RBTF9UT0tFTl9BTU9VTlQpOwogICAgCSAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIENPTlNUUlVDVE9SCiAgICAgKgogICAgICogQGRldiBJbml0aWFsaXplIHRoZSBXYW5jaGFpbiBUb2tlbgogICAgICogQHBhcmFtIF9taW50ZXIgVGhlIFdhbmNoYWluIENvbnRyaWJ1dGlvbiBDb250cmFjdAogICAgICogQHBhcmFtIF9zdGFydFRpbWUgSUNPIHN0YXJ0IHRpbWUKICAgICAqIEBwYXJhbSBfZW5kVGltZSBJQ08gRW5kIFRpbWUKICAgICAqLwogICAgZnVuY3Rpb24gV2FuVG9rZW4oYWRkcmVzcyBfbWludGVyLCB1aW50IF9zdGFydFRpbWUsIHVpbnQgX2VuZFRpbWUpewogICAgCSAgbWludGVyID0gX21pbnRlcjsKICAgIAkgIHN0YXJ0VGltZSA9IF9zdGFydFRpbWU7CiAgICAJICBlbmRUaW1lID0gX2VuZFRpbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBFWFRFUk5BTCBGVU5DVElPTgogICAgICoKICAgICAqIEBkZXYgQ29udHJpYnV0aW9uIGNvbnRyYWN0IGluc3RhbmNlIG1pbnQgdG9rZW4KICAgICAqIEBwYXJhbSByZWNlaXBlbnQgVGhlIGRlc3RpbmF0aW9uIGFjY291bnQgb3duZWQgbWludCB0b2tlbnMKICAgICAqIEBwYXJhbSBhbW91bnQgVGhlIGFtb3VudCBvZiBtaW50IHRva2VuCiAgICAgKiBiZSBzZW50IHRvIHRoaXMgYWRkcmVzcy4KICAgICAqLwogICAgZnVuY3Rpb24gbWludFRva2VuKGFkZHJlc3MgcmVjZWlwZW50LCB1aW50IGFtb3VudCkKICAgICAgICBleHRlcm5hbAogICAgICAgIG9ubHlNaW50ZXIKICAgICAgICBtYXhXYW5Ub2tlbkFtb3VudE5vdFJlYWNoZWQoYW1vdW50KQogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgIAlsb2NrZWRCYWxhbmNlc1tyZWNlaXBlbnRdID0gbG9ja2VkQmFsYW5jZXNbcmVjZWlwZW50XS5hZGQoYW1vdW50KTsKICAgICAgCXRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKGFtb3VudCk7CiAgICAgIAlyZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKgogICAgICogUFVCTElDIEZVTkNUSU9OUwogICAgICovCgogICAgLy8vIEBkZXYgTG9ja2luZyBwZXJpb2QgaGFzIHBhc3NlZCAtIExvY2tlZCB0b2tlbnMgaGF2ZSB0dXJuZWQgaW50byB0cmFkZWFibGUKICAgIC8vLyAgICAgIEFsbCB0b2tlbnMgb3duZWQgYnkgcmVjZWlwZW50IHdpbGwgYmUgdHJhZGVhYmxlCiAgICBmdW5jdGlvbiBjbGFpbVRva2VucyhhZGRyZXNzIHJlY2VpcGVudCkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5TWludGVyCiAgICB7CiAgICAgIAliYWxhbmNlc1tyZWNlaXBlbnRdID0gYmFsYW5jZXNbcmVjZWlwZW50XS5hZGQobG9ja2VkQmFsYW5jZXNbcmVjZWlwZW50XSk7CiAgICAgIAlsb2NrZWRCYWxhbmNlc1tyZWNlaXBlbnRdID0gMDsKICAgIH0KCiAgICAvKgogICAgICogQ09OU1RBTlQgTUVUSE9EUwogICAgICovCiAgICBmdW5jdGlvbiBsb2NrZWRCYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgYmFsYW5jZSkgewogICAgICAgIHJldHVybiBsb2NrZWRCYWxhbmNlc1tfb3duZXJdOwogICAgfQp9CgoKcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgovKgoKICBDb3B5cmlnaHQgMjAxNyBXYW5jaGFpbiBGb3VuZGF0aW9uLgoKICBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgogIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoKICBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgoqLwoKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgXyAgICAgICAgICAgXyAgICAgICAgICAgXwovLyAgX18gICAgICBfX19fIF8gXyBfXyAgIF9fX3wgfF9fICAgX18gXyhfKV8gX18gICBfX3wgfCBfX19fXyAgIF9fCi8vICBcIFwgL1wgLyAvIF9gIHwgJ18gXCAvIF9ffCAnXyBcIC8gX2AgfCB8ICdfIFxALyBfYCB8LyBfIFwgXCAvIC8KLy8gICBcIFYgIFYgLyAoX3wgfCB8IHwgfCAoX198IHwgfCB8IChffCB8IHwgfCB8IHwgKF98IHwgIF9fL1wgViAvCi8vICAgIFxfL1xfLyBcX18sX3xffCB8X3xcX19ffF98IHxffFxfXyxffF98X3wgfF98XF9fLF98XF9fX3wgXF8vCi8vCi8vICBDb2RlIHN0eWxlIGFjY29yZGluZyB0bzogaHR0cHM6Ly9naXRodWIuY29tL3dhbmNoYWluL3dhbmNoYWluLXRva2VuL2Jsb2IvbWFzdGVyL3N0eWxlLWd1aWRlLnJzdAoKLy8vIEB0aXRsZSBXYW5jaGFpbiBDb250cmlidXRpb24gQ29udHJhY3QKLy8vIElDTyBSdWxlcyBhY2NvcmRpbmc6IGh0dHBzOi8vd3d3LndhbmNoYWluLm9yZy9jcm93ZHNhbGUKLy8vIEZvciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IHRoaXMgdG9rZW4gc2FsZSwgcGxlYXNlIHZpc2l0IGh0dHBzOi8vd2FuY2hhaW4ub3JnCi8vLyBAYXV0aG9yIFphbmUgTGlhbmcgLSA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImQ0YWViNWJhYjFiOGJkYjViYWIzOTRhM2I1YmFiN2JjYjViZGJhZmFiYmE2YjMiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+Pgpjb250cmFjdCBXYW5jaGFpbkNvbnRyaWJ1dGlvbiBpcyBPd25lZCB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKCiAgICAvLy8gQ29uc3RhbnQgZmllbGRzCiAgICAvLy8gV2FuY2hhaW4gdG90YWwgdG9rZW5zIHN1cHBseQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgV0FOX1RPVEFMX1NVUFBMWSA9IDIxMDAwMDAwMCBldGhlcjsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IE1BWF9DT05UUklCVVRJT05fRFVSQVRJT04gPSAzIGRheXM7CgogICAgLy8vIEV4Y2hhbmdlIHJhdGVzIGZvciBmaXJzdCBwaGFzZQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgUFJJQ0VfUkFURV9GSVJTVCA9IDg4MDsKICAgIC8vLyBFeGNoYW5nZSByYXRlcyBmb3Igc2Vjb25kIHBoYXNlCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBQUklDRV9SQVRFX1NFQ09ORCA9IDc5MDsKICAgIC8vLyBFeGNoYW5nZSByYXRlcyBmb3IgbGFzdCBwaGFzZQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgUFJJQ0VfUkFURV9MQVNUID0gNzUwOwoKICAgIC8vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLy8gfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgfCAgICAgICAgfAogICAgLy8vIHwgICAgICAgIFBVQkxJQyBTQUxFIChQUkVTQUxFICsgT1BFTiBTQUxFKSAgICAgICAgIHwgICAgICBERVYgVEVBTSAgICAgIHwgICAgRk9VTkRBVElPTiAgIHwgIE1JTkVSIHwKICAgIC8vLyB8ICAgICAgICAgICAgICAgICAgICAgICA1MSUgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgMjAlICAgICAgICB8ICAgICAgIDE5JSAgICAgICB8ICAgMTAlICB8CiAgICAvLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAvLy8gT1BFTl9TQUxFX1NUQUtFICsgUFJFU0FMRV9TVEFLRSA9IDUxOyA1MSUgc2FsZSBmb3IgcHVibGljCiAgICAgIHVpbnQgcHVibGljIGNvbnN0YW50IE9QRU5fU0FMRV9TVEFLRSA9IDQ1OTsgIC8vIDQ1LjklIGZvciBvcGVuIHNhbGUKICAgICAgdWludCBwdWJsaWMgY29uc3RhbnQgUFJFU0FMRV9TVEFLRSA9IDUxOyAgICAgLy8gNS4xJSAgZm9yIHByZXNhbGUKCiAgICAgIC8vIFJlc2VydmVkIHN0YWtlcwogICAgICB1aW50IHB1YmxpYyBjb25zdGFudCBERVZfVEVBTV9TVEFLRSA9IDIwMDsgICAvLyAyMCUKICAgICAgdWludCBwdWJsaWMgY29uc3RhbnQgRk9VTkRBVElPTl9TVEFLRSA9IDE5MDsgLy8gMTklCiAgICAgIHVpbnQgcHVibGljIGNvbnN0YW50IE1JTkVSU19TVEFLRSA9IDEwMDsgICAgIC8vIDEwJQoKICAgICAgdWludCBwdWJsaWMgY29uc3RhbnQgRElWSVNPUl9TVEFLRSA9IDEwMDA7CgogICAgICAvLy8gSG9sZGVyIGFkZHJlc3MgZm9yIHByZXNhbGUgYW5kIHJlc2VydmVkIHRva2VucwogICAgICAvLy8gVE9ETzogY2hhbmdlIGFkZHJlc3NlZCBiZWZvcmUgZGVwbG95ZWQgdG8gbWFpbiBuZXQKICAgICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgUFJFU0FMRV9IT0xERVIgPSAweGNhOGY3NmZkOTU5N2U1YzBlYTVlZjBmODMzODFjMDYzNTI3MWNkNWQ7CgogICAgICAvLyBBZGRyZXNzZXMgb2YgUGF0cm9ucwogICAgICBhZGRyZXNzIHB1YmxpYyBjb25zdGFudCBERVZfVEVBTV9IT0xERVIgPSAweDE2MzE0NDdkMDQxZjkyOTU5NWE5YzdiMGM5YzAwNDdkZTJlNzYxODY7CiAgICAgIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IEZPVU5EQVRJT05fSE9MREVSID0gMHhlNDQyNDA4YTVmMmUyMjRjOTJiMzRlMjUxZGU0OGY1MjY2ZmMzOGRlOwogICAgICBhZGRyZXNzIHB1YmxpYyBjb25zdGFudCBNSU5FUlNfSE9MREVSID0gMHgzOGIxOTVkMmExOGE0ZTYwMjkyODY4ZmE3NGZhZTYxOWQ1NjYxMTFlOwoKICAgICAgdWludCBwdWJsaWMgTUFYX09QRU5fU09MRCA9IFdBTl9UT1RBTF9TVVBQTFkgKiBPUEVOX1NBTEVfU1RBS0UgLyBESVZJU09SX1NUQUtFOwoKICAgIC8vLyBGaWVsZHMgdGhhdCBhcmUgb25seSBjaGFuZ2VkIGluIGNvbnN0cnVjdG9yCiAgICAvLy8gQWxsIGRlcG9zaXRlZCBFVEggd2lsbCBiZSBpbnN0YW50bHkgZm9yd2FyZGVkIHRvIHRoaXMgYWRkcmVzcy4KICAgIGFkZHJlc3MgcHVibGljIHdhbnBvcnQ7CiAgICAvLy8gQ29udHJpYnV0aW9uIHN0YXJ0IHRpbWUKICAgIHVpbnQgcHVibGljIHN0YXJ0VGltZTsKICAgIC8vLyBDb250cmlidXRpb24gZW5kIHRpbWUKICAgIHVpbnQgcHVibGljIGVuZFRpbWU7CgogICAgLy8vIEZpZWxkcyB0aGF0IGNhbiBiZSBjaGFuZ2VkIGJ5IGZ1bmN0aW9ucwogICAgLy8vIEFjY3VtdWxhdG9yIGZvciBvcGVuIHNvbGQgdG9rZW5zCiAgICB1aW50IG9wZW5Tb2xkVG9rZW5zOwogICAgLy8vIE5vcm1hbCBzb2xkIHRva2VucwogICAgdWludCBub3JtYWxTb2xkVG9rZW5zOwogICAgLy8vIFRoZSBzdW0gb2YgcmVzZXJ2ZWQgdG9rZW5zIGZvciBJQ08gc3RhZ2UgMQogICAgdWludCBwdWJsaWMgcGFydG5lclJlc2VydmVkU3VtOwogICAgLy8vIER1ZSB0byBhbiBlbWVyZ2VuY3ksIHNldCB0aGlzIHRvIHRydWUgdG8gaGFsdCB0aGUgY29udHJpYnV0aW9uCiAgICBib29sIHB1YmxpYyBoYWx0ZWQ7CiAgICAvLy8gRVJDMjAgY29tcGlsYW50IHdhbmNoYWluIHRva2VuIGNvbnRhY3QgaW5zdGFuY2UKICAgIFdhblRva2VuIHB1YmxpYyB3YW5Ub2tlbjsKCiAgICAvLy8gUXVvdGEgZm9yIHBhcnRuZXJzCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBwYXJ0bmVyc0xpbWl0OwogICAgLy8vIEFjY3VtdWxhdG9yIGZvciBwYXJ0bmVyIHNvbGQKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIHBhcnRuZXJzQm91Z2h0OwoKICAgIHVpbnQyNTYgcHVibGljIG5vcm1hbEJ1eUxpbWl0ID0gNjUgZXRoZXI7CgogICAgLyoKICAgICAqIEVWRU5UUwogICAgICovCgogICAgZXZlbnQgTmV3U2FsZShhZGRyZXNzIGluZGV4ZWQgZGVzdEFkZHJlc3MsIHVpbnQgZXRoQ29zdCwgdWludCBnb3RUb2tlbnMpOwogICAgZXZlbnQgUGFydG5lckFkZHJlc3NRdW90YShhZGRyZXNzIGluZGV4ZWQgcGFydG5lckFkZHJlc3MsIHVpbnQgcXVvdGEpOwoKICAgIC8qCiAgICAgKiBNT0RJRklFUlMKICAgICAqLwoKICAgIG1vZGlmaWVyIG9ubHlXYWxsZXQgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSB3YW5wb3J0KTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG5vdEhhbHRlZCgpIHsKICAgICAgICByZXF1aXJlKCFoYWx0ZWQpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgaW5pdGlhbGl6ZWQoKSB7CiAgICAgICAgcmVxdWlyZShhZGRyZXNzKHdhbnBvcnQpICE9IDB4MCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBub3RFYXJsaWVyVGhhbih1aW50IHgpIHsKICAgICAgICByZXF1aXJlKG5vdyA+PSB4KTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIGVhcmxpZXJUaGFuKHVpbnQgeCkgewogICAgICAgIHJlcXVpcmUobm93IDwgeCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBjZWlsaW5nTm90UmVhY2hlZCgpIHsKICAgICAgICByZXF1aXJlKG9wZW5Tb2xkVG9rZW5zIDwgTUFYX09QRU5fU09MRCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBpc1NhbGVFbmRlZCgpIHsKICAgICAgICByZXF1aXJlKG5vdyA+IGVuZFRpbWUgfHwgb3BlblNvbGRUb2tlbnMgPj0gTUFYX09QRU5fU09MRCk7CiAgICAgICAgXzsKICAgIH0KCgogICAgLyoqCiAgICAgKiBDT05TVFJVQ1RPUgogICAgICoKICAgICAqIEBkZXYgSW5pdGlhbGl6ZSB0aGUgV2FuY2hhaW4gY29udHJpYnV0aW9uIGNvbnRyYWN0CiAgICAgKiBAcGFyYW0gX3dhbnBvcnQgVGhlIGVzY3JvdyBhY2NvdW50IGFkZHJlc3MsIGFsbCBldGhlcnMgd2lsbCBiZSBzZW50IHRvIHRoaXMgYWRkcmVzcy4KICAgICAqIEBwYXJhbSBfc3RhcnRUaW1lIElDTyBzdGFydCB0aW1lCiAgICAgKi8KICAgIGZ1bmN0aW9uIFdhbmNoYWluQ29udHJpYnV0aW9uKGFkZHJlc3MgX3dhbnBvcnQsIHVpbnQgX3N0YXJ0VGltZSl7CiAgICAJcmVxdWlyZShfd2FucG9ydCAhPSAweDApOwoKICAgICAgICBoYWx0ZWQgPSBmYWxzZTsKICAgIAl3YW5wb3J0ID0gX3dhbnBvcnQ7CiAgICAJc3RhcnRUaW1lID0gX3N0YXJ0VGltZTsKICAgIAllbmRUaW1lID0gc3RhcnRUaW1lICsgTUFYX0NPTlRSSUJVVElPTl9EVVJBVElPTjsKICAgICAgICBvcGVuU29sZFRva2VucyA9IDA7CiAgICAgICAgcGFydG5lclJlc2VydmVkU3VtID0gMDsKICAgICAgICBub3JtYWxTb2xkVG9rZW5zID0gMDsKICAgICAgICAvLy8gQ3JlYXRlIHdhbmNoYWluIHRva2VuIGNvbnRyYWN0IGluc3RhbmNlCiAgICAJd2FuVG9rZW4gPSBuZXcgV2FuVG9rZW4odGhpcyxzdGFydFRpbWUsIGVuZFRpbWUpOwoKICAgICAgICAvLy8gUmVzZXJ2ZSB0b2tlbnMgYWNjb3JkaW5nIHdhbmNoYWluIElDTyBydWxlcwogICAgCXVpbnQgc3Rha2VNdWx0aXBsaWVyID0gV0FOX1RPVEFMX1NVUFBMWSAvIERJVklTT1JfU1RBS0U7CgogICAgCXdhblRva2VuLm1pbnRUb2tlbihQUkVTQUxFX0hPTERFUiwgUFJFU0FMRV9TVEFLRSAqIHN0YWtlTXVsdGlwbGllcik7CiAgICAgICAgd2FuVG9rZW4ubWludFRva2VuKERFVl9URUFNX0hPTERFUiwgREVWX1RFQU1fU1RBS0UgKiBzdGFrZU11bHRpcGxpZXIpOwogICAgICAgIHdhblRva2VuLm1pbnRUb2tlbihGT1VOREFUSU9OX0hPTERFUiwgRk9VTkRBVElPTl9TVEFLRSAqIHN0YWtlTXVsdGlwbGllcik7CiAgICAgICAgd2FuVG9rZW4ubWludFRva2VuKE1JTkVSU19IT0xERVIsIE1JTkVSU19TVEFLRSAqIHN0YWtlTXVsdGlwbGllcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBGYWxsYmFjayBmdW5jdGlvbgogICAgICoKICAgICAqIEBkZXYgSWYgYW55Ym9keSBzZW5kcyBFdGhlciBkaXJlY3RseSB0byB0aGlzICBjb250cmFjdCwgY29uc2lkZXIgaGUgaXMgZ2V0dGluZyB3YW4gdG9rZW4KICAgICAqLwogICAgZnVuY3Rpb24gKCkgcHVibGljIHBheWFibGUgbm90SGFsdGVkIGNlaWxpbmdOb3RSZWFjaGVkewogICAgCWJ1eVdhbkNvaW4obXNnLnNlbmRlcik7CiAgICB9CgogICAgLyoKICAgICAqIFBVQkxJQyBGVU5DVElPTlMKICAgICAqLwoKICAgZnVuY3Rpb24gc2V0Tm9ybWFsQnV5TGltaXQodWludDI1NiBsaW1pdCkKICAgICAgICBwdWJsaWMKICAgICAgICBpbml0aWFsaXplZAogICAgICAgIG9ubHlPd25lcgogICAgICAgIGVhcmxpZXJUaGFuKGVuZFRpbWUpCiAgICB7CiAgICAgICAgbm9ybWFsQnV5TGltaXQgPSBsaW1pdDsKICAgIH0KCiAgICAvLy8gQGRldiBTZXRzIHRoZSBsaW1pdCBmb3IgYSBwYXJ0bmVyIGFkZHJlc3MuIEFsbCB0aGUgcGFydG5lciBhZGRyZXNzZXMKICAgIC8vLyB3aWxsIGJlIGFibGUgdG8gZ2V0IHdhbiB0b2tlbiBkdXJpbmcgdGhlIGNvbnRyaWJ1dGlvbiBwZXJpb2Qgd2l0aCBoaXMgb3duCiAgICAvLy8gc3BlY2lmaWMgbGltaXQuCiAgICAvLy8gVGhpcyBtZXRob2Qgc2hvdWxkIGJlIGNhbGxlZCBieSB0aGUgb3duZXIgYWZ0ZXIgdGhlIGluaXRpYWxpemF0aW9uCiAgICAvLy8gYW5kIGJlZm9yZSB0aGUgY29udHJpYnV0aW9uIGVuZC4KICAgIC8vLyBAcGFyYW0gc2V0UGFydG5lckFkZHJlc3MgUGFydG5lciBhZGRyZXNzCiAgICAvLy8gQHBhcmFtIGxpbWl0IExpbWl0IGZvciB0aGUgcGFydG5lciBhZGRyZXNzLHRoZSBsaW1pdCBpcyBXQU5UT0tFTiwgbm90IEVUSEVSCiAgICBmdW5jdGlvbiBzZXRQYXJ0bmVyUXVvdGEoYWRkcmVzcyBzZXRQYXJ0bmVyQWRkcmVzcywgdWludDI1NiBsaW1pdCkKICAgICAgICBwdWJsaWMKICAgICAgICBpbml0aWFsaXplZAogICAgICAgIG9ubHlPd25lcgogICAgICAgIGVhcmxpZXJUaGFuKGVuZFRpbWUpCiAgICB7CiAgICAgICAgcmVxdWlyZShsaW1pdCA+IDAgJiYgbGltaXQgPD0gTUFYX09QRU5fU09MRCk7CiAgICAgICAgcGFydG5lcnNMaW1pdFtzZXRQYXJ0bmVyQWRkcmVzc10gPSBsaW1pdDsKICAgICAgICBwYXJ0bmVyUmVzZXJ2ZWRTdW0gKz0gbGltaXQ7CiAgICAgICAgUGFydG5lckFkZHJlc3NRdW90YShzZXRQYXJ0bmVyQWRkcmVzcywgbGltaXQpOwogICAgfQoKICAgIC8vLyBAZGV2IEV4Y2hhbmdlIG1zZy52YWx1ZSBldGhlciB0byBXQU4gZm9yIGFjY291bnQgcmVjZXBpZW50CiAgICAvLy8gQHBhcmFtIHJlY2VpcGllbnQgV0FOIHRva2VucyByZWNlaXZlcgogICAgZnVuY3Rpb24gYnV5V2FuQ29pbihhZGRyZXNzIHJlY2VpcGllbnQpCiAgICAgICAgcHVibGljCiAgICAgICAgcGF5YWJsZQogICAgICAgIG5vdEhhbHRlZAogICAgICAgIGluaXRpYWxpemVkCiAgICAgICAgY2VpbGluZ05vdFJlYWNoZWQKICAgICAgICBub3RFYXJsaWVyVGhhbihzdGFydFRpbWUpCiAgICAgICAgZWFybGllclRoYW4oZW5kVGltZSkKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgCXJlcXVpcmUocmVjZWlwaWVudCAhPSAweDApOwogICAgCXJlcXVpcmUobXNnLnZhbHVlID49IDAuMSBldGhlcik7CgogICAgCWlmIChwYXJ0bmVyc0xpbWl0W3JlY2VpcGllbnRdID4gMCkKICAgIAkJYnV5RnJvbVBhcnRuZXIocmVjZWlwaWVudCk7CiAgICAJZWxzZSB7CiAgICAJCXJlcXVpcmUobXNnLnZhbHVlIDw9IG5vcm1hbEJ1eUxpbWl0KTsKICAgIAkJYnV5Tm9ybWFsKHJlY2VpcGllbnQpOwogICAgCX0KCiAgICAJcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8vIEBkZXYgRW1lcmdlbmN5IHNpdHVhdGlvbiB0aGF0IHJlcXVpcmVzIGNvbnRyaWJ1dGlvbiBwZXJpb2QgdG8gc3RvcC4KICAgIC8vLyBDb250cmlidXRpbmcgbm90IHBvc3NpYmxlIGFueW1vcmUuCiAgICBmdW5jdGlvbiBoYWx0KCkgcHVibGljIG9ubHlXYWxsZXR7CiAgICAgICAgaGFsdGVkID0gdHJ1ZTsKICAgIH0KCiAgICAvLy8gQGRldiBFbWVyZ2VuY3kgc2l0dWF0aW9uIHJlc29sdmVkLgogICAgLy8vIENvbnRyaWJ1dGluZyBiZWNvbWVzIHBvc3NpYmxlIGFnYWluIHdpdGhpbmcgdGhlIG91dGxpbmVkIHJlc3RyaWN0aW9ucy4KICAgIGZ1bmN0aW9uIHVuSGFsdCgpIHB1YmxpYyBvbmx5V2FsbGV0ewogICAgICAgIGhhbHRlZCA9IGZhbHNlOwogICAgfQoKICAgIC8vLyBAZGV2IEVtZXJnZW5jeSBzaXR1YXRpb24KICAgIGZ1bmN0aW9uIGNoYW5nZVdhbGxldEFkZHJlc3MoYWRkcmVzcyBuZXdBZGRyZXNzKSBvbmx5V2FsbGV0IHsKICAgICAgICB3YW5wb3J0ID0gbmV3QWRkcmVzczsKICAgIH0KCiAgICAvLy8gQHJldHVybiB0cnVlIGlmIHNhbGUgaGFzIHN0YXJ0ZWQsIGZhbHNlIG90aGVyd2lzZS4KICAgIGZ1bmN0aW9uIHNhbGVTdGFydGVkKCkgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBub3cgPj0gc3RhcnRUaW1lOwogICAgfQoKICAgIC8vLyBAcmV0dXJuIHRydWUgaWYgc2FsZSBoYXMgZW5kZWQsIGZhbHNlIG90aGVyd2lzZS4KICAgIGZ1bmN0aW9uIHNhbGVFbmRlZCgpIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gbm93ID4gZW5kVGltZSB8fCBvcGVuU29sZFRva2VucyA+PSBNQVhfT1BFTl9TT0xEOwogICAgfQoKICAgIC8vLyBDT05TVEFOVCBNRVRIT0RTCiAgICAvLy8gQGRldiBHZXQgY3VycmVudCBleGNoYW5nZSByYXRlCiAgICBmdW5jdGlvbiBwcmljZVJhdGUoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIC8vIFRocmVlIHByaWNlIHRpZXJzCiAgICAgICAgaWYgKHN0YXJ0VGltZSA8PSBub3cgJiYgbm93IDwgc3RhcnRUaW1lICsgMSBkYXlzKQogICAgICAgICAgICByZXR1cm4gUFJJQ0VfUkFURV9GSVJTVDsKICAgICAgICBpZiAoc3RhcnRUaW1lICsgMSBkYXlzIDw9IG5vdyAmJiBub3cgPCBzdGFydFRpbWUgKyAyIGRheXMpCiAgICAgICAgICAgIHJldHVybiBQUklDRV9SQVRFX1NFQ09ORDsKICAgICAgICBpZiAoc3RhcnRUaW1lICsgMiBkYXlzIDw9IG5vdyAmJiBub3cgPCBlbmRUaW1lKQogICAgICAgICAgICByZXR1cm4gUFJJQ0VfUkFURV9MQVNUOwogICAgICAgIC8vIFNob3VsZCBub3QgYmUgY2FsbGVkIGJlZm9yZSBvciBhZnRlciBjb250cmlidXRpb24gcGVyaW9kCiAgICAgICAgYXNzZXJ0KGZhbHNlKTsKICAgIH0KCgogICAgZnVuY3Rpb24gY2xhaW1Ub2tlbnMoYWRkcmVzcyByZWNlaXBlbnQpCiAgICAgIHB1YmxpYwogICAgICBpc1NhbGVFbmRlZAogICAgewoKICAgICAgd2FuVG9rZW4uY2xhaW1Ub2tlbnMocmVjZWlwZW50KTsKCiAgICB9CgogICAgLyoKICAgICAqIElOVEVSTkFMIEZVTkNUSU9OUwogICAgICovCgogICAgLy8vIEBkZXYgQnV5IHdhbmNoYWluIHRva2VucyBieSBwYXJ0bmVycwogICAgZnVuY3Rpb24gYnV5RnJvbVBhcnRuZXIoYWRkcmVzcyByZWNlaXBpZW50KSBpbnRlcm5hbCB7CiAgICAJdWludCBwYXJ0bmVyQXZhaWxhYmxlID0gcGFydG5lcnNMaW1pdFtyZWNlaXBpZW50XS5zdWIocGFydG5lcnNCb3VnaHRbcmVjZWlwaWVudF0pOwoJICAgIHVpbnQgYWxsQXZhaWxhYmxlID0gTUFYX09QRU5fU09MRC5zdWIob3BlblNvbGRUb2tlbnMpOwogICAgICBwYXJ0bmVyQXZhaWxhYmxlID0gcGFydG5lckF2YWlsYWJsZS5taW4yNTYoYWxsQXZhaWxhYmxlKTsKCiAgICAJcmVxdWlyZShwYXJ0bmVyQXZhaWxhYmxlID4gMCk7CgogICAgCXVpbnQgdG9GdW5kOwogICAgCXVpbnQgdG9Db2xsZWN0OwogICAgCSh0b0Z1bmQsICB0b0NvbGxlY3QpPSBjb3N0QW5kQnV5VG9rZW5zKHBhcnRuZXJBdmFpbGFibGUpOwoKICAgIAlwYXJ0bmVyc0JvdWdodFtyZWNlaXBpZW50XSA9IHBhcnRuZXJzQm91Z2h0W3JlY2VpcGllbnRdLmFkZCh0b0NvbGxlY3QpOwoKICAgIAlidXlDb21tb24ocmVjZWlwaWVudCwgdG9GdW5kLCB0b0NvbGxlY3QpOwoKICAgIH0KCiAgICAvLy8gQGRldiBCdXkgd2FuY2hhaW4gdG9rZW4gbm9ybWFsbHkKICAgIGZ1bmN0aW9uIGJ1eU5vcm1hbChhZGRyZXNzIHJlY2VpcGllbnQpIGludGVybmFsIHsKICAgICAgICAvLyBEbyBub3QgYWxsb3cgY29udHJhY3RzIHRvIGdhbWUgdGhlIHN5c3RlbQogICAgICAgIHJlcXVpcmUoIWlzQ29udHJhY3QobXNnLnNlbmRlcikpOwoKICAgICAgICAvLyBwcm90ZWN0IHBhcnRuZXIgcXVvdGEgaW4gc3RhZ2Ugb25lCiAgICAgICAgdWludCB0b2tlbkF2YWlsYWJsZTsKICAgICAgICBpZihzdGFydFRpbWUgPD0gbm93ICYmIG5vdyA8IHN0YXJ0VGltZSArIDEgZGF5cykgewogICAgICAgICAgICB1aW50IHRvdGFsTm9ybWFsQXZhaWxhYmxlID0gTUFYX09QRU5fU09MRC5zdWIocGFydG5lclJlc2VydmVkU3VtKTsKICAgICAgICAgICAgdG9rZW5BdmFpbGFibGUgPSB0b3RhbE5vcm1hbEF2YWlsYWJsZS5zdWIobm9ybWFsU29sZFRva2Vucyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdG9rZW5BdmFpbGFibGUgPSBNQVhfT1BFTl9TT0xELnN1YihvcGVuU29sZFRva2Vucyk7CiAgICAgICAgfQoKICAgICAgICByZXF1aXJlKHRva2VuQXZhaWxhYmxlID4gMCk7CgogICAgCXVpbnQgdG9GdW5kOwogICAgCXVpbnQgdG9Db2xsZWN0OwogICAgCSh0b0Z1bmQsIHRvQ29sbGVjdCkgPSBjb3N0QW5kQnV5VG9rZW5zKHRva2VuQXZhaWxhYmxlKTsKICAgICAgICBidXlDb21tb24ocmVjZWlwaWVudCwgdG9GdW5kLCB0b0NvbGxlY3QpOwogICAgICAgIG5vcm1hbFNvbGRUb2tlbnMgKz0gdG9Db2xsZWN0OwogICAgfQoKICAgIC8vLyBAZGV2IFV0aWxpdHkgZnVuY3Rpb24gZm9yIGJ1ZyB3YW5jaGFpbiB0b2tlbgogICAgZnVuY3Rpb24gYnV5Q29tbW9uKGFkZHJlc3MgcmVjZWlwaWVudCwgdWludCB0b0Z1bmQsIHVpbnQgd2FuVG9rZW5Db2xsZWN0KSBpbnRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPj0gdG9GdW5kKTsgLy8gZG91YmxlIGNoZWNrCgogICAgICAgIGlmKHRvRnVuZCA+IDApIHsKICAgICAgICAgICAgcmVxdWlyZSh3YW5Ub2tlbi5taW50VG9rZW4ocmVjZWlwaWVudCwgd2FuVG9rZW5Db2xsZWN0KSk7CiAgICAgICAgICAgIHdhbnBvcnQudHJhbnNmZXIodG9GdW5kKTsKICAgICAgICAgICAgb3BlblNvbGRUb2tlbnMgPSBvcGVuU29sZFRva2Vucy5hZGQod2FuVG9rZW5Db2xsZWN0KTsKICAgICAgICAgICAgTmV3U2FsZShyZWNlaXBpZW50LCB0b0Z1bmQsIHdhblRva2VuQ29sbGVjdCk7CiAgICAgICAgfQoKICAgICAgICB1aW50IHRvUmV0dXJuID0gbXNnLnZhbHVlLnN1Yih0b0Z1bmQpOwogICAgICAgIGlmKHRvUmV0dXJuID4gMCkgewogICAgICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHRvUmV0dXJuKTsKICAgICAgICB9CiAgICB9CgogICAgLy8vIEBkZXYgVXRpbGl0eSBmdW5jdGlvbiBmb3IgY2FsY3VsYXRlIGF2YWlsYWJsZSB0b2tlbnMgYW5kIGNvc3QgZXRoZXJzCiAgICBmdW5jdGlvbiBjb3N0QW5kQnV5VG9rZW5zKHVpbnQgYXZhaWxhYmxlVG9rZW4pIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQgY29zdFZhbHVlLCB1aW50IGdldFRva2Vucyl7CiAgICAJLy8gYWxsIGNvbmRpdGlvbnMgaGFzIGNoZWNrZWQgaW4gdGhlIGNhbGxlciBmdW5jdGlvbnMKICAgIAl1aW50IGV4Y2hhbmdlUmF0ZSA9IHByaWNlUmF0ZSgpOwogICAgCWdldFRva2VucyA9IGV4Y2hhbmdlUmF0ZSAqIG1zZy52YWx1ZTsKCiAgICAJaWYoYXZhaWxhYmxlVG9rZW4gPj0gZ2V0VG9rZW5zKXsKICAgIAkJY29zdFZhbHVlID0gbXNnLnZhbHVlOwogICAgCX0gZWxzZSB7CiAgICAJCWNvc3RWYWx1ZSA9IGF2YWlsYWJsZVRva2VuIC8gZXhjaGFuZ2VSYXRlOwogICAgCQlnZXRUb2tlbnMgPSBhdmFpbGFibGVUb2tlbjsKICAgIAl9CgogICAgfQoKICAgIC8vLyBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIGRldGVybWluZSBpZiBhbiBhZGRyZXNzIGlzIGEgY29udHJhY3QKICAgIC8vLyBAcGFyYW0gX2FkZHIgVGhlIGFkZHJlc3MgYmVpbmcgcXVlcmllZAogICAgLy8vIEByZXR1cm4gVHJ1ZSBpZiBgX2FkZHJgIGlzIGEgY29udHJhY3QKICAgIGZ1bmN0aW9uIGlzQ29udHJhY3QoYWRkcmVzcyBfYWRkcikgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyhib29sKSB7CiAgICAgICAgdWludCBzaXplOwogICAgICAgIGlmIChfYWRkciA9PSAwKSByZXR1cm4gZmFsc2U7CiAgICAgICAgYXNzZW1ibHkgewogICAgICAgICAgICBzaXplIDo9IGV4dGNvZGVzaXplKF9hZGRyKQogICAgICAgIH0KICAgICAgICByZXR1cm4gc2l6ZSA+IDA7CiAgICB9Cn0='.
	

]
