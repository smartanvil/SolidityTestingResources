Class {
	#name : #SRTae88fe3558b9d41552f1e85c2575e953eb82cee7,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTae88fe3558b9d41552f1e85c2575e953eb82cee7 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTY7CgoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5CiAqLwpjb250cmFjdCBFUkMyMEJhc2ljIHsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9Ci8qKgogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKi8KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9Ci8qKgogKiBAdGl0bGUgQmFzaWMgdG9rZW4KICogQGRldiBCYXNpYyB2ZXJzaW9uIG9mIFN0YW5kYXJkVG9rZW4sIHdpdGggbm8gYWxsb3dhbmNlcy4gCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgICAvKioKICAgICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CgogICAgICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAgICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgICAqLwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KCn0KCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCgogICAgLyoqCiAgICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICAgICAgdmFyIF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKCiAgICAgICAgLy8gQ2hlY2sgaXMgbm90IG5lZWRlZCBiZWNhdXNlIHN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0CiAgICAgICAgLy8gcmVxdWlyZSAoX3ZhbHVlIDw9IF9hbGxvd2FuY2UpOwoKICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBfYWxsb3dhbmNlLnN1YihfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsKCiAgICAgICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2AKICAgICAgICAvLyAgYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyBgYXBwcm92ZShfc3BlbmRlciwgMClgIGlmIGl0IGlzIG5vdAogICAgICAgIC8vICBhbHJlYWR5IDAgdG8gbWl0aWdhdGUgdGhlIHJhY2UgY29uZGl0aW9uIGRlc2NyaWJlZCBoZXJlOgogICAgICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgICAgIHJlcXVpcmUoKF92YWx1ZSA9PSAwKSB8fCAoYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPT0gMCkpOwoKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAgICovCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgICB9CgogICAgLyoqCiAgICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAgICovCiAgICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICAgICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgICAgICB9CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCn0KCi8qKgogKiBAdGl0bGUgT3duYWJsZQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuCiAqLwpjb250cmFjdCBPd25hYmxlIHsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogICAgLyoqCiAgICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgICAqIGFjY291bnQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIE93bmFibGUoKSB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKCiAgICAvKioKICAgICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgICAqLwogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCgogICAgLyoqCiAgICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgIH0KCn0KCi8qKgogKiBAdGl0bGUgTWludGFibGUgdG9rZW4KICogQGRldiBTaW1wbGUgRVJDMjAgVG9rZW4gZXhhbXBsZSwgd2l0aCBtaW50YWJsZSB0b2tlbiBjcmVhdGlvbgogKiBAZGV2IElzc3VlOiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvaXNzdWVzLzEyMAogKiBCYXNlZCBvbiBjb2RlIGJ5IFRva2VuTWFya2V0TmV0OiBodHRwczovL2dpdGh1Yi5jb20vVG9rZW5NYXJrZXROZXQvaWNvL2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy9NaW50YWJsZVRva2VuLnNvbAogKi8KCmNvbnRyYWN0IE1pbnRhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZSB7CiAgICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwoKICAgIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwoKICAgIGJvb2wgcHVibGljIG1pbnRpbmdGaW5pc2hlZCA9IGZhbHNlOwoKCiAgICBtb2RpZmllciBjYW5NaW50KCkgewogICAgICAgIHJlcXVpcmUoIW1pbnRpbmdGaW5pc2hlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gbWludCB0b2tlbnMKICAgICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIG1pbnRlZCB0b2tlbnMuCiAgICAgKiBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAgICogQHJldHVybiBBIGJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgICAqLwogICAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5T3duZXIgY2FuTWludCByZXR1cm5zIChib29sKSB7CiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoX2Ftb3VudCk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF9hbW91bnQpOwogICAgICAgIE1pbnQoX3RvLCBfYW1vdW50KTsKICAgICAgICBUcmFuc2ZlcigweDAsIF90bywgX2Ftb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHN0b3AgbWludGluZyBuZXcgdG9rZW5zLgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgICAgIG1pbnRpbmdGaW5pc2hlZCA9IHRydWU7CiAgICAgICAgTWludEZpbmlzaGVkKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0KCmNvbnRyYWN0IHVzaW5nTXlXaWxsQ29uc3RzIHsKICAgIHVpbnQgY29uc3RhbnQgVE9LRU5fREVDSU1BTFMgPSAxODsKICAgIHVpbnQ4IGNvbnN0YW50IFRPS0VOX0RFQ0lNQUxTX1VJTlQ4ID0gMTg7CiAgICB1aW50IGNvbnN0YW50IFRPS0VOX0RFQ0lNQUxfTVVMVElQTElFUiA9IDEwICoqIFRPS0VOX0RFQ0lNQUxTOwp9CmNvbnRyYWN0IE15V2lsbFRva2VuIGlzIHVzaW5nTXlXaWxsQ29uc3RzLCBNaW50YWJsZVRva2VuIHsKICAgIC8qKgogICAgICogQGRldiBQYXVzZSB0b2tlbiB0cmFuc2Zlci4gQWZ0ZXIgc3VjY2Vzc2Z1bGx5IGZpbmlzaGVkIGNyb3dkc2FsZSBpdCBiZWNvbWVzIHRydWUuCiAgICAgKi8KICAgIGJvb2wgcHVibGljIHBhdXNlZCA9IHRydWU7CiAgICAvKioKICAgICAqIEBkZXYgQWNjb3VudHMgd2hvIGNhbiB0cmFuc2ZlciB0b2tlbiBldmVuIGlmIHBhdXNlZC4gV29ya3Mgb25seSBkdXJpbmcgY3Jvd2RzYWxlLgogICAgICovCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgZXhjbHVkZWQ7CgogICAgZnVuY3Rpb24gbmFtZSgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zIChzdHJpbmcgX25hbWUpIHsKICAgICAgICByZXR1cm4gIk15V2lsbCBDb2luIjsKICAgIH0KCiAgICBmdW5jdGlvbiBzeW1ib2woKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAoYnl0ZXMzMiBfc3ltYm9sKSB7CiAgICAgICAgcmV0dXJuICJXSUwiOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlY2ltYWxzKCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQ4IF9kZWNpbWFscykgewogICAgICAgIHJldHVybiBUT0tFTl9ERUNJTUFMU19VSU5UODsKICAgIH0KCiAgICBmdW5jdGlvbiBjcm93ZHNhbGVGaW5pc2hlZCgpIG9ubHlPd25lciB7CiAgICAgICAgcGF1c2VkID0gZmFsc2U7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkRXhjbHVkZWQoYWRkcmVzcyBfdG9FeGNsdWRlKSBvbmx5T3duZXIgewogICAgICAgIGV4Y2x1ZGVkW190b0V4Y2x1ZGVdID0gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZSghcGF1c2VkIHx8IGV4Y2x1ZGVkW19mcm9tXSk7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoIXBhdXNlZCB8fCBleGNsdWRlZFttc2cuc2VuZGVyXSk7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICAgIH0KfQovKioKICogQHRpdGxlIENyb3dkc2FsZSAKICogQGRldiBDcm93ZHNhbGUgaXMgYSBiYXNlIGNvbnRyYWN0IGZvciBtYW5hZ2luZyBhIHRva2VuIGNyb3dkc2FsZS4KICoKICogQ3Jvd2RzYWxlcyBoYXZlIGEgc3RhcnQgYW5kIGVuZCB0aW1lc3RhbXBzLCB3aGVyZSBpbnZlc3RvcnMgY2FuIG1ha2UKICogdG9rZW4gcHVyY2hhc2VzIGFuZCB0aGUgY3Jvd2RzYWxlIHdpbGwgYXNzaWduIHRoZW0gdG9rZW5zIGJhc2VkCiAqIG9uIGEgdG9rZW4gcGVyIEVUSCByYXRlLiBGdW5kcyBjb2xsZWN0ZWQgYXJlIGZvcndhcmRlZCB0byBhIHdhbGxldCAKICogYXMgdGhleSBhcnJpdmUuCiAqLwpjb250cmFjdCBDcm93ZHNhbGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CgogICAgLy8gVGhlIHRva2VuIGJlaW5nIHNvbGQKICAgIE1pbnRhYmxlVG9rZW4gcHVibGljIHRva2VuOwoKICAgIC8vIHN0YXJ0IGFuZCBlbmQgdGltZXN0YW1wcyB3aGVyZSBpbnZlc3RtZW50cyBhcmUgYWxsb3dlZCAoYm90aCBpbmNsdXNpdmUpCiAgICB1aW50MzIgcHVibGljIHN0YXJ0VGltZTsKICAgIHVpbnQzMiBwdWJsaWMgZW5kVGltZTsKCiAgICAvLyBhZGRyZXNzIHdoZXJlIGZ1bmRzIGFyZSBjb2xsZWN0ZWQKICAgIGFkZHJlc3MgcHVibGljIHdhbGxldDsKCiAgICAvLyBhbW91bnQgb2YgcmFpc2VkIG1vbmV5IGluIHdlaQogICAgdWludCBwdWJsaWMgd2VpUmFpc2VkOwoKICAgIC8qKgogICAgICogQGRldiBBbW91bnQgb2YgYWxyZWFkeSBzb2xkIHRva2Vucy4KICAgICAqLwogICAgdWludCBwdWJsaWMgc29sZFRva2VuczsKCiAgICAvKioKICAgICAqIEBkZXYgTWF4aW11bSBhbW91bnQgb2YgdG9rZW5zIHRvIG1pbnQuCiAgICAgKi8KICAgIHVpbnQgcHVibGljIGhhcmRDYXA7CgogICAgLyoqCiAgICAgKiBldmVudCBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAgICogQHBhcmFtIHB1cmNoYXNlciB3aG8gcGFpZCBmb3IgdGhlIHRva2VucwogICAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IHdobyBnb3QgdGhlIHRva2VucwogICAgICogQHBhcmFtIHZhbHVlIHdlaXMgcGFpZCBmb3IgcHVyY2hhc2UKICAgICAqIEBwYXJhbSBhbW91bnQgYW1vdW50IG9mIHRva2VucyBwdXJjaGFzZWQKICAgICAqLwogICAgZXZlbnQgVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQgdmFsdWUsIHVpbnQgYW1vdW50KTsKCgogICAgZnVuY3Rpb24gQ3Jvd2RzYWxlKHVpbnQzMiBfc3RhcnRUaW1lLCB1aW50MzIgX2VuZFRpbWUsIHVpbnQgX2hhcmRDYXAsIGFkZHJlc3MgX3dhbGxldCkgewogICAgICAgIHJlcXVpcmUoX3N0YXJ0VGltZSA+PSBub3cpOwogICAgICAgIHJlcXVpcmUoX2VuZFRpbWUgPj0gX3N0YXJ0VGltZSk7CiAgICAgICAgcmVxdWlyZShfd2FsbGV0ICE9IDB4MCk7CiAgICAgICAgcmVxdWlyZShfaGFyZENhcCA+IDApOwoKICAgICAgICB0b2tlbiA9IGNyZWF0ZVRva2VuQ29udHJhY3QoKTsKICAgICAgICBzdGFydFRpbWUgPSBfc3RhcnRUaW1lOwogICAgICAgIGVuZFRpbWUgPSBfZW5kVGltZTsKICAgICAgICBoYXJkQ2FwID0gX2hhcmRDYXA7CiAgICAgICAgd2FsbGV0ID0gX3dhbGxldDsKICAgIH0KCiAgICAvLyBjcmVhdGVzIHRoZSB0b2tlbiB0byBiZSBzb2xkLgogICAgLy8gb3ZlcnJpZGUgdGhpcyBtZXRob2QgdG8gaGF2ZSBjcm93ZHNhbGUgb2YgYSBzcGVjaWZpYyBtaW50YWJsZSB0b2tlbi4KICAgIGZ1bmN0aW9uIGNyZWF0ZVRva2VuQ29udHJhY3QoKSBpbnRlcm5hbCByZXR1cm5zIChNaW50YWJsZVRva2VuKSB7CiAgICAgICAgcmV0dXJuIG5ldyBNaW50YWJsZVRva2VuKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IHRoaXMgbWV0aG9kIG1pZ2h0IGJlIG92ZXJyaWRkZW4gZm9yIGltcGxlbWVudGluZyBhbnkgc2FsZSBsb2dpYy4KICAgICAqIEByZXR1cm4gQWN0dWFsIHJhdGUuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFJhdGUodWludCBhbW91bnQpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOwoKICAgIGZ1bmN0aW9uIGdldEJhc2VSYXRlKCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludCk7CgogICAgLyoqCiAgICAgKiBAZGV2IHJhdGUgc2NhbGUgKG9yIGRpdmlkZXIpLCB0byBzdXBwb3J0IG5vdCBpbnRlZ2VyIHJhdGVzLgogICAgICogQHJldHVybiBSYXRlIGRpdmlkZXIuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFJhdGVTY2FsZSgpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gMTsKICAgIH0KCiAgICAvLyBmYWxsYmFjayBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBidXkgdG9rZW5zCiAgICBmdW5jdGlvbigpIHBheWFibGUgewogICAgICAgIGJ1eVRva2Vucyhtc2cuc2VuZGVyLCBtc2cudmFsdWUpOwogICAgfQoKICAgIC8vIGxvdyBsZXZlbCB0b2tlbiBwdXJjaGFzZSBmdW5jdGlvbgogICAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQgYW1vdW50V2VpKSBpbnRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShiZW5lZmljaWFyeSAhPSAweDApOwoKICAgICAgICAvLyB0b3RhbCBtaW50ZWQgdG9rZW5zCiAgICAgICAgdWludCB0b3RhbFN1cHBseSA9IHRva2VuLnRvdGFsU3VwcGx5KCk7CgogICAgICAgIC8vIGFjdHVhbCB0b2tlbiBtaW50aW5nIHJhdGUgKHdpdGggY29uc2lkZXJpbmcgYm9udXNlcyBhbmQgZGlzY291bnRzKQogICAgICAgIHVpbnQgYWN0dWFsUmF0ZSA9IGdldFJhdGUoYW1vdW50V2VpKTsKICAgICAgICB1aW50IHJhdGVTY2FsZSA9IGdldFJhdGVTY2FsZSgpOwoKICAgICAgICByZXF1aXJlKHZhbGlkUHVyY2hhc2UoYW1vdW50V2VpLCBhY3R1YWxSYXRlLCB0b3RhbFN1cHBseSkpOwoKICAgICAgICAvLyBjYWxjdWxhdGUgdG9rZW4gYW1vdW50IHRvIGJlIGNyZWF0ZWQKICAgICAgICB1aW50IHRva2VucyA9IGFtb3VudFdlaS5tdWwoYWN0dWFsUmF0ZSkuZGl2KHJhdGVTY2FsZSk7CgogICAgICAgIC8vIGNoYW5nZSwgaWYgbWludGVkIHRva2VuIHdvdWxkIGJlIGxlc3MKICAgICAgICB1aW50IGNoYW5nZSA9IDA7CgogICAgICAgIC8vIGlmIGhhcmQgY2FwIHJlYWNoZWQKICAgICAgICBpZiAodG9rZW5zLmFkZCh0b3RhbFN1cHBseSkgPiBoYXJkQ2FwKSB7CiAgICAgICAgICAgIC8vIHJlc3QgdG9rZW5zCiAgICAgICAgICAgIHVpbnQgbWF4VG9rZW5zID0gaGFyZENhcC5zdWIodG90YWxTdXBwbHkpOwogICAgICAgICAgICB1aW50IHJlYWxBbW91bnQgPSBtYXhUb2tlbnMubXVsKHJhdGVTY2FsZSkuZGl2KGFjdHVhbFJhdGUpOwoKICAgICAgICAgICAgLy8gcmVzdCB0b2tlbnMgcm91bmRlZCBieSBhY3R1YWxSYXRlCiAgICAgICAgICAgIHRva2VucyA9IHJlYWxBbW91bnQubXVsKGFjdHVhbFJhdGUpLmRpdihyYXRlU2NhbGUpOwogICAgICAgICAgICBjaGFuZ2UgPSBhbW91bnRXZWkgLSByZWFsQW1vdW50OwogICAgICAgICAgICBhbW91bnRXZWkgPSByZWFsQW1vdW50OwogICAgICAgIH0KCiAgICAgICAgLy8gdXBkYXRlIHN0YXRlCiAgICAgICAgd2VpUmFpc2VkID0gd2VpUmFpc2VkLmFkZChhbW91bnRXZWkpOwogICAgICAgIHNvbGRUb2tlbnMgPSBzb2xkVG9rZW5zLmFkZCh0b2tlbnMpOwoKICAgICAgICB0b2tlbi5taW50KGJlbmVmaWNpYXJ5LCB0b2tlbnMpOwogICAgICAgIFRva2VuUHVyY2hhc2UobXNnLnNlbmRlciwgYmVuZWZpY2lhcnksIGFtb3VudFdlaSwgdG9rZW5zKTsKCiAgICAgICAgaWYgKGNoYW5nZSAhPSAwKSB7CiAgICAgICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoY2hhbmdlKTsKICAgICAgICB9CiAgICAgICAgZm9yd2FyZEZ1bmRzKGFtb3VudFdlaSk7CiAgICB9CgogICAgLy8gc2VuZCBldGhlciB0byB0aGUgZnVuZCBjb2xsZWN0aW9uIHdhbGxldAogICAgLy8gb3ZlcnJpZGUgdG8gY3JlYXRlIGN1c3RvbSBmdW5kIGZvcndhcmRpbmcgbWVjaGFuaXNtcwogICAgZnVuY3Rpb24gZm9yd2FyZEZ1bmRzKHVpbnQgYW1vdW50V2VpKSBpbnRlcm5hbCB7CiAgICAgICAgd2FsbGV0LnRyYW5zZmVyKGFtb3VudFdlaSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IENoZWNrIGlmIHRoZSBzcGVjaWZpZWQgcHVyY2hhc2UgaXMgdmFsaWQuCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIHRyYW5zYWN0aW9uIGNhbiBidXkgdG9rZW5zCiAgICAgKi8KICAgIGZ1bmN0aW9uIHZhbGlkUHVyY2hhc2UodWludCBfYW1vdW50V2VpLCB1aW50IF9hY3R1YWxSYXRlLCB1aW50IF90b3RhbFN1cHBseSkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGJvb2wgd2l0aGluUGVyaW9kID0gbm93ID49IHN0YXJ0VGltZSAmJiBub3cgPD0gZW5kVGltZTsKICAgICAgICBib29sIG5vblplcm9QdXJjaGFzZSA9IF9hbW91bnRXZWkgIT0gMDsKICAgICAgICBib29sIGhhcmRDYXBOb3RSZWFjaGVkID0gX3RvdGFsU3VwcGx5IDw9IGhhcmRDYXAuc3ViKF9hY3R1YWxSYXRlKTsKCiAgICAgICAgcmV0dXJuIHdpdGhpblBlcmlvZCAmJiBub25aZXJvUHVyY2hhc2UgJiYgaGFyZENhcE5vdFJlYWNoZWQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEJlY2F1c2Ugb2YgZGlzY291bnQgaGFzRW5kZWQgbWlnaHQgYmUgdHJ1ZSwgYnV0IHZhbGlkUHVyY2hhc2UgcmV0dXJucyBmYWxzZS4KICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBjcm93ZHNhbGUgZXZlbnQgaGFzIGVuZGVkCiAgICAgKi8KICAgIGZ1bmN0aW9uIGhhc0VuZGVkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gbm93ID4gZW5kVGltZSB8fCB0b2tlbi50b3RhbFN1cHBseSgpID4gaGFyZENhcC5zdWIoZ2V0QmFzZVJhdGUoKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBzdGFydGVkCiAgICAgKi8KICAgIGZ1bmN0aW9uIGhhc1N0YXJ0ZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBub3cgPj0gc3RhcnRUaW1lOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBDaGVjayB0aGlzIGNyb3dkc2FsZSBldmVudCBoYXMgZW5kZWQgY29uc2lkZXJpbmcgd2l0aCBhbW91bnQgdG8gYnV5LgogICAgICogQHBhcmFtIF92YWx1ZSBBbW91bnQgdG8gc3BlbmQuCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBlbmRlZAogICAgICovCiAgICBmdW5jdGlvbiBoYXNFbmRlZCh1aW50IF92YWx1ZSkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICB1aW50IGFjdHVhbFJhdGUgPSBnZXRSYXRlKF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIG5vdyA+IGVuZFRpbWUgfHwgdG9rZW4udG90YWxTdXBwbHkoKSA+IGhhcmRDYXAuc3ViKGFjdHVhbFJhdGUpOwogICAgfQp9CgovKioKICogQHRpdGxlIEZpbmFsaXphYmxlQ3Jvd2RzYWxlCiAqIEBkZXYgRXh0ZW5zaW9uIG9mIENyb3dzZGFsZSB3aGVyZSBhbiBvd25lciBjYW4gZG8gZXh0cmEgd29yawogKiBhZnRlciBmaW5pc2hpbmcuIAogKi8KY29udHJhY3QgRmluYWxpemFibGVDcm93ZHNhbGUgaXMgQ3Jvd2RzYWxlLCBPd25hYmxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIGJvb2wgcHVibGljIGlzRmluYWxpemVkID0gZmFsc2U7CgogICAgZXZlbnQgRmluYWxpemVkKCk7CgogICAgZnVuY3Rpb24gRmluYWxpemFibGVDcm93ZHNhbGUodWludDMyIF9zdGFydFRpbWUsIHVpbnQzMiBfZW5kVGltZSwgdWludCBfaGFyZENhcCwgYWRkcmVzcyBfd2FsbGV0KQogICAgICAgICAgICBDcm93ZHNhbGUoX3N0YXJ0VGltZSwgX2VuZFRpbWUsIF9oYXJkQ2FwLCBfd2FsbGV0KSB7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IE11c3QgYmUgY2FsbGVkIGFmdGVyIGNyb3dkc2FsZSBlbmRzLCB0byBkbyBzb21lIGV4dHJhIGZpbmFsaXphdGlvbgogICAgICogd29yay4gQ2FsbHMgdGhlIGNvbnRyYWN0J3MgZmluYWxpemF0aW9uIGZ1bmN0aW9uLgogICAgICovCiAgICBmdW5jdGlvbiBmaW5hbGl6ZSgpIG9ubHlPd25lciBub3RGaW5hbGl6ZWQgewogICAgICAgIHJlcXVpcmUoaGFzRW5kZWQoKSk7CgogICAgICAgIGZpbmFsaXphdGlvbigpOwogICAgICAgIEZpbmFsaXplZCgpOwoKICAgICAgICBpc0ZpbmFsaXplZCA9IHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IENhbiBiZSBvdmVycmlkZW4gdG8gYWRkIGZpbmFsaXphdGlvbiBsb2dpYy4gVGhlIG92ZXJyaWRpbmcgZnVuY3Rpb24KICAgICAqIHNob3VsZCBjYWxsIHN1cGVyLmZpbmFsaXphdGlvbigpIHRvIGVuc3VyZSB0aGUgY2hhaW4gb2YgZmluYWxpemF0aW9uIGlzCiAgICAgKiBleGVjdXRlZCBlbnRpcmVseS4KICAgICAqLwogICAgZnVuY3Rpb24gZmluYWxpemF0aW9uKCkgaW50ZXJuYWwgewogICAgfQoKICAgIG1vZGlmaWVyIG5vdEZpbmFsaXplZCgpIHsKICAgICAgICByZXF1aXJlKCFpc0ZpbmFsaXplZCk7CiAgICAgICAgXzsKICAgIH0KfQoKLyoqCiAqIEB0aXRsZSBSZWZ1bmRWYXVsdAogKiBAZGV2IFRoaXMgY29udHJhY3QgaXMgdXNlZCBmb3Igc3RvcmluZyBmdW5kcyB3aGlsZSBhIGNyb3dkc2FsZQogKiBpcyBpbiBwcm9ncmVzcy4gU3VwcG9ydHMgcmVmdW5kaW5nIHRoZSBtb25leSBpZiBjcm93ZHNhbGUgZmFpbHMsCiAqIGFuZCBmb3J3YXJkaW5nIGl0IGlmIGNyb3dkc2FsZSBpcyBzdWNjZXNzZnVsLgogKi8KY29udHJhY3QgUmVmdW5kVmF1bHQgaXMgT3duYWJsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICBlbnVtIFN0YXRlIHtBY3RpdmUsIFJlZnVuZGluZywgQ2xvc2VkfQoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGRlcG9zaXRlZDsKCiAgICBhZGRyZXNzIHB1YmxpYyB3YWxsZXQ7CgogICAgU3RhdGUgcHVibGljIHN0YXRlOwoKICAgIGV2ZW50IENsb3NlZCgpOwoKICAgIGV2ZW50IFJlZnVuZHNFbmFibGVkKCk7CgogICAgZXZlbnQgUmVmdW5kZWQoYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHdlaUFtb3VudCk7CgogICAgZnVuY3Rpb24gUmVmdW5kVmF1bHQoYWRkcmVzcyBfd2FsbGV0KSB7CiAgICAgICAgcmVxdWlyZShfd2FsbGV0ICE9IDB4MCk7CiAgICAgICAgd2FsbGV0ID0gX3dhbGxldDsKICAgICAgICBzdGF0ZSA9IFN0YXRlLkFjdGl2ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZXBvc2l0KGFkZHJlc3MgaW52ZXN0b3IpIG9ubHlPd25lciBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLkFjdGl2ZSk7CiAgICAgICAgZGVwb3NpdGVkW2ludmVzdG9yXSA9IGRlcG9zaXRlZFtpbnZlc3Rvcl0uYWRkKG1zZy52YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gY2xvc2UoKSBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuQWN0aXZlKTsKICAgICAgICBzdGF0ZSA9IFN0YXRlLkNsb3NlZDsKICAgICAgICBDbG9zZWQoKTsKICAgICAgICB3YWxsZXQudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBlbmFibGVSZWZ1bmRzKCkgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLkFjdGl2ZSk7CiAgICAgICAgc3RhdGUgPSBTdGF0ZS5SZWZ1bmRpbmc7CiAgICAgICAgUmVmdW5kc0VuYWJsZWQoKTsKICAgIH0KCiAgICBmdW5jdGlvbiByZWZ1bmQoYWRkcmVzcyBpbnZlc3Rvcikgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLlJlZnVuZGluZyk7CiAgICAgICAgdWludDI1NiBkZXBvc2l0ZWRWYWx1ZSA9IGRlcG9zaXRlZFtpbnZlc3Rvcl07CiAgICAgICAgZGVwb3NpdGVkW2ludmVzdG9yXSA9IDA7CiAgICAgICAgaW52ZXN0b3IudHJhbnNmZXIoZGVwb3NpdGVkVmFsdWUpOwogICAgICAgIFJlZnVuZGVkKGludmVzdG9yLCBkZXBvc2l0ZWRWYWx1ZSk7CiAgICB9Cn0KCi8qKgogKiBAdGl0bGUgUmVmdW5kYWJsZUNyb3dkc2FsZQogKiBAZGV2IEV4dGVuc2lvbiBvZiBDcm93ZHNhbGUgY29udHJhY3QgdGhhdCBhZGRzIGEgZnVuZGluZyBnb2FsLCBhbmQKICogdGhlIHBvc3NpYmlsaXR5IG9mIHVzZXJzIGdldHRpbmcgYSByZWZ1bmQgaWYgZ29hbCBpcyBub3QgbWV0LgogKiBVc2VzIGEgUmVmdW5kVmF1bHQgYXMgdGhlIGNyb3dkc2FsZSdzIHZhdWx0LgogKi8KY29udHJhY3QgUmVmdW5kYWJsZUNyb3dkc2FsZSBpcyBGaW5hbGl6YWJsZUNyb3dkc2FsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICAvLyBtaW5pbXVtIGFtb3VudCBvZiBmdW5kcyB0byBiZSByYWlzZWQgaW4gd2VpcwogICAgdWludCBwdWJsaWMgZ29hbDsKCiAgICAvLyByZWZ1bmQgdmF1bHQgdXNlZCB0byBob2xkIGZ1bmRzIHdoaWxlIGNyb3dkc2FsZSBpcyBydW5uaW5nCiAgICBSZWZ1bmRWYXVsdCBwdWJsaWMgdmF1bHQ7CgogICAgZnVuY3Rpb24gUmVmdW5kYWJsZUNyb3dkc2FsZSh1aW50MzIgX3N0YXJ0VGltZSwgdWludDMyIF9lbmRUaW1lLCB1aW50IF9oYXJkQ2FwLCBhZGRyZXNzIF93YWxsZXQsIHVpbnQgX2dvYWwpCiAgICAgICAgICAgIEZpbmFsaXphYmxlQ3Jvd2RzYWxlKF9zdGFydFRpbWUsIF9lbmRUaW1lLCBfaGFyZENhcCwgX3dhbGxldCkgewogICAgICAgIHJlcXVpcmUoX2dvYWwgPiAwKTsKICAgICAgICB2YXVsdCA9IG5ldyBSZWZ1bmRWYXVsdCh3YWxsZXQpOwogICAgICAgIGdvYWwgPSBfZ29hbDsKICAgIH0KCiAgICAvLyBXZSdyZSBvdmVycmlkaW5nIHRoZSBmdW5kIGZvcndhcmRpbmcgZnJvbSBDcm93ZHNhbGUuCiAgICAvLyBJbiBhZGRpdGlvbiB0byBzZW5kaW5nIHRoZSBmdW5kcywgd2Ugd2FudCB0byBjYWxsCiAgICAvLyB0aGUgUmVmdW5kVmF1bHQgZGVwb3NpdCBmdW5jdGlvbgogICAgZnVuY3Rpb24gZm9yd2FyZEZ1bmRzKHVpbnQgYW1vdW50V2VpKSBpbnRlcm5hbCB7CiAgICAgICAgaWYgKGdvYWxSZWFjaGVkKCkpIHsKICAgICAgICAgICAgd2FsbGV0LnRyYW5zZmVyKGFtb3VudFdlaSk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICB2YXVsdC5kZXBvc2l0LnZhbHVlKGFtb3VudFdlaSkobXNnLnNlbmRlcik7CiAgICAgICAgfQogICAgfQoKICAgIC8vIGlmIGNyb3dkc2FsZSBpcyB1bnN1Y2Nlc3NmdWwsIGludmVzdG9ycyBjYW4gY2xhaW0gcmVmdW5kcyBoZXJlCiAgICBmdW5jdGlvbiBjbGFpbVJlZnVuZCgpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShpc0ZpbmFsaXplZCk7CiAgICAgICAgcmVxdWlyZSghZ29hbFJlYWNoZWQoKSk7CgogICAgICAgIHZhdWx0LnJlZnVuZChtc2cuc2VuZGVyKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQ2xvc2UgdmF1bHQgb25seSBpZiBnb2FsIHdhcyByZWFjaGVkLgogICAgICovCiAgICBmdW5jdGlvbiBjbG9zZVZhdWx0KCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShnb2FsUmVhY2hlZCgpKTsKICAgICAgICB2YXVsdC5jbG9zZSgpOwogICAgfQoKICAgIC8vIHZhdWx0IGZpbmFsaXphdGlvbiB0YXNrLCBjYWxsZWQgd2hlbiBvd25lciBjYWxscyBmaW5hbGl6ZSgpCiAgICBmdW5jdGlvbiBmaW5hbGl6YXRpb24oKSBpbnRlcm5hbCB7CiAgICAgICAgc3VwZXIuZmluYWxpemF0aW9uKCk7CgogICAgICAgIGlmIChnb2FsUmVhY2hlZCgpKSB7CiAgICAgICAgICAgIHZhdWx0LmNsb3NlKCk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICB2YXVsdC5lbmFibGVSZWZ1bmRzKCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGdvYWxSZWFjaGVkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gd2VpUmFpc2VkID49IGdvYWw7CiAgICB9Cgp9CmNvbnRyYWN0IE15V2lsbFJhdGVQcm92aWRlckkgewogICAgLyoqCiAgICAgKiBAZGV2IENhbGN1bGF0ZSBhY3R1YWwgcmF0ZSB1c2luZyB0aGUgc3BlY2lmaWVkIHBhcmFtZXRlcnMuCiAgICAgKiBAcGFyYW0gYnV5ZXIgICAgIEludmVzdG9yIChidXllcikgYWRkcmVzcy4KICAgICAqIEBwYXJhbSB0b3RhbFNvbGQgQW1vdW50IG9mIHNvbGQgdG9rZW5zLgogICAgICogQHBhcmFtIGFtb3VudFdlaSBBbW91bnQgb2Ygd2VpIHRvIHB1cmNoYXNlLgogICAgICogQHJldHVybiBFVEggdG8gVG9rZW4gcmF0ZS4KICAgICAqLwogICAgZnVuY3Rpb24gZ2V0UmF0ZShhZGRyZXNzIGJ1eWVyLCB1aW50IHRvdGFsU29sZCwgdWludCBhbW91bnRXZWkpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KTsKCiAgICAvKioKICAgICAqIEBkZXYgcmF0ZSBzY2FsZSAob3IgZGl2aWRlciksIHRvIHN1cHBvcnQgbm90IGludGVnZXIgcmF0ZXMuCiAgICAgKiBAcmV0dXJuIFJhdGUgZGl2aWRlci4KICAgICAqLwogICAgZnVuY3Rpb24gZ2V0UmF0ZVNjYWxlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOwoKICAgIC8qKgogICAgICogQHJldHVybiBBYnNvbHV0ZSBiYXNlIHJhdGUuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldEJhc2VSYXRlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOwp9Cgpjb250cmFjdCBNeVdpbGxSYXRlUHJvdmlkZXIgaXMgdXNpbmdNeVdpbGxDb25zdHMsIE15V2lsbFJhdGVQcm92aWRlckksIE93bmFibGUgewogICAgLy8gcmF0ZSBjYWxjdWxhdGUgYWNjdXJhY3kKICAgIHVpbnQgY29uc3RhbnQgUkFURV9TQ0FMRSA9IDEwMDAwOwogICAgdWludCBjb25zdGFudCBTVEVQXzMwID0gMjAwMDAwMDAgKiBUT0tFTl9ERUNJTUFMX01VTFRJUExJRVI7CiAgICB1aW50IGNvbnN0YW50IFNURVBfMjAgPSA0MDAwMDAwMCAqIFRPS0VOX0RFQ0lNQUxfTVVMVElQTElFUjsKICAgIHVpbnQgY29uc3RhbnQgU1RFUF8xMCA9IDYwMDAwMDAwICogVE9LRU5fREVDSU1BTF9NVUxUSVBMSUVSOwogICAgdWludCBjb25zdGFudCBSQVRFXzMwID0gMTk1MCAqIFJBVEVfU0NBTEU7CiAgICB1aW50IGNvbnN0YW50IFJBVEVfMjAgPSAxODAwICogUkFURV9TQ0FMRTsKICAgIHVpbnQgY29uc3RhbnQgUkFURV8xMCA9IDE2NTAgKiBSQVRFX1NDQUxFOwogICAgdWludCBjb25zdGFudCBCQVNFX1JBVEUgPSAxNTAwICogUkFURV9TQ0FMRTsKCiAgICBzdHJ1Y3QgRXhjbHVzaXZlUmF0ZSB7CiAgICAgICAgLy8gYmUgY2FyZWZ1bCwgYWNjdXJhY2llcyB0aGlzIGFib3V0IDE1IG1pbnV0ZXMKICAgICAgICB1aW50MzIgd29ya1VudGlsOwogICAgICAgIC8vIGV4Y2x1c2l2ZSByYXRlIG9yIDAKICAgICAgICB1aW50IHJhdGU7CiAgICAgICAgLy8gcmF0ZSBib251cyBwZXJjZW50LCB3aGljaCB3aWxsIGJlIGRpdmlkZWQgYnkgMTAwMCBvciAwCiAgICAgICAgdWludDE2IGJvbnVzUGVyY2VudDEwMDA7CiAgICAgICAgLy8gZmxhZyB0byBjaGVjaywgdGhhdCByZWNvcmQgZXhpc3RzCiAgICAgICAgYm9vbCBleGlzdHM7CiAgICB9CgogICAgbWFwcGluZyhhZGRyZXNzID0+IEV4Y2x1c2l2ZVJhdGUpIGV4Y2x1c2l2ZVJhdGU7CgogICAgZnVuY3Rpb24gZ2V0UmF0ZVNjYWxlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gUkFURV9TQ0FMRTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRCYXNlUmF0ZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIEJBU0VfUkFURTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRSYXRlKGFkZHJlc3MgYnV5ZXIsIHVpbnQgdG90YWxTb2xkLCB1aW50IGFtb3VudFdlaSkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICB1aW50IHJhdGU7CiAgICAgICAgLy8gYXBwbHkgc2FsZQogICAgICAgIGlmICh0b3RhbFNvbGQgPCBTVEVQXzMwKSB7CiAgICAgICAgICAgIHJhdGUgPSBSQVRFXzMwOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmICh0b3RhbFNvbGQgPCBTVEVQXzIwKSB7CiAgICAgICAgICAgIHJhdGUgPSBSQVRFXzIwOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmICh0b3RhbFNvbGQgPCBTVEVQXzEwKSB7CiAgICAgICAgICAgIHJhdGUgPSBSQVRFXzEwOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgcmF0ZSA9IEJBU0VfUkFURTsKICAgICAgICB9CgogICAgICAgIC8vIGFwcGx5IGJvbnVzIGZvciBhbW91bnQKICAgICAgICBpZiAoYW1vdW50V2VpID49IDEwMDAgZXRoZXIpIHsKICAgICAgICAgICAgcmF0ZSArPSByYXRlICogMTMgLyAxMDA7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKGFtb3VudFdlaSA+PSA1MDAgZXRoZXIpIHsKICAgICAgICAgICAgcmF0ZSArPSByYXRlICogMTAgLyAxMDA7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKGFtb3VudFdlaSA+PSAxMDAgZXRoZXIpIHsKICAgICAgICAgICAgcmF0ZSArPSByYXRlICogNyAvIDEwMDsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoYW1vdW50V2VpID49IDUwIGV0aGVyKSB7CiAgICAgICAgICAgIHJhdGUgKz0gcmF0ZSAqIDUgLyAxMDA7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKGFtb3VudFdlaSA+PSAzMCBldGhlcikgewogICAgICAgICAgICByYXRlICs9IHJhdGUgKiA0IC8gMTAwOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChhbW91bnRXZWkgPj0gMTAgZXRoZXIpIHsKICAgICAgICAgICAgcmF0ZSArPSByYXRlICogMjUgLyAxMDAwOwogICAgICAgIH0KCiAgICAgICAgRXhjbHVzaXZlUmF0ZSBtZW1vcnkgZVJhdGUgPSBleGNsdXNpdmVSYXRlW2J1eWVyXTsKICAgICAgICBpZiAoZVJhdGUuZXhpc3RzICYmIGVSYXRlLndvcmtVbnRpbCA+PSBub3cpIHsKICAgICAgICAgICAgaWYgKGVSYXRlLnJhdGUgIT0gMCkgewogICAgICAgICAgICAgICAgcmF0ZSA9IGVSYXRlLnJhdGU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmF0ZSArPSByYXRlICogZVJhdGUuYm9udXNQZXJjZW50MTAwMCAvIDEwMDA7CiAgICAgICAgfQogICAgICAgIHJldHVybiByYXRlOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEV4Y2x1c2l2ZVJhdGUoYWRkcmVzcyBfaW52ZXN0b3IsIHVpbnQgX3JhdGUsIHVpbnQxNiBfYm9udXNQZXJjZW50MTAwMCwgdWludDMyIF93b3JrVW50aWwpIG9ubHlPd25lciB7CiAgICAgICAgZXhjbHVzaXZlUmF0ZVtfaW52ZXN0b3JdID0gRXhjbHVzaXZlUmF0ZShfd29ya1VudGlsLCBfcmF0ZSwgX2JvbnVzUGVyY2VudDEwMDAsIHRydWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlbW92ZUV4Y2x1c2l2ZVJhdGUoYWRkcmVzcyBfaW52ZXN0b3IpIG9ubHlPd25lciB7CiAgICAgICAgZGVsZXRlIGV4Y2x1c2l2ZVJhdGVbX2ludmVzdG9yXTsKICAgIH0KfQpjb250cmFjdCBNeVdpbGxDcm93ZHNhbGUgaXMgdXNpbmdNeVdpbGxDb25zdHMsIFJlZnVuZGFibGVDcm93ZHNhbGUgewogICAgdWludCBjb25zdGFudCB0ZWFtVG9rZW5zID0gMTEwMDAwMDAgKiBUT0tFTl9ERUNJTUFMX01VTFRJUExJRVI7CiAgICB1aW50IGNvbnN0YW50IGJvdW50eVRva2VucyA9IDIwMDAwMDAgKiBUT0tFTl9ERUNJTUFMX01VTFRJUExJRVI7CiAgICB1aW50IGNvbnN0YW50IGljb1Rva2VucyA9IDMwMzg4MDAgKiBUT0tFTl9ERUNJTUFMX01VTFRJUExJRVI7CiAgICB1aW50IGNvbnN0YW50IG1pbmltYWxQdXJjaGFzZSA9IDAuMDUgZXRoZXI7CiAgICBhZGRyZXNzIGNvbnN0YW50IHRlYW1BZGRyZXNzID0gMHhFNEYwRmY0NjQxZjNjOTlkZTM0MmIwNmMwNjQxNGQ5NEE1ODVlRmZiOwogICAgYWRkcmVzcyBjb25zdGFudCBib3VudHlBZGRyZXNzID0gMHg3NmQ0MTM2ZDZFRTUzREI0Y2MwODdGMkUyOTkwMjgzZDUzMTdBNWU5OwogICAgYWRkcmVzcyBjb25zdGFudCBpY29BY2NvdW50QWRkcmVzcyA9IDB4MTk1NjEwODUxQTQzRTk2ODU2NDNBOEYzYjQ5RjBGOGEwMTkyMDRmMTsKCiAgICBNeVdpbGxSYXRlUHJvdmlkZXJJIHB1YmxpYyByYXRlUHJvdmlkZXI7CgogICAgZnVuY3Rpb24gTXlXaWxsQ3Jvd2RzYWxlKAogICAgICAgICAgICB1aW50MzIgX3N0YXJ0VGltZSwKICAgICAgICAgICAgdWludDMyIF9lbmRUaW1lLAogICAgICAgICAgICB1aW50IF9zb2Z0Q2FwV2VpLAogICAgICAgICAgICB1aW50IF9oYXJkQ2FwVG9rZW5zCiAgICApCiAgICAgICAgUmVmdW5kYWJsZUNyb3dkc2FsZShfc3RhcnRUaW1lLCBfZW5kVGltZSwgX2hhcmRDYXBUb2tlbnMgKiBUT0tFTl9ERUNJTUFMX01VTFRJUExJRVIsIDB4ODA4MjZiNWI3MTdhRGQzRTg0MDM0MzM2NEVDOWQ5NzFGQmEzOTU1QywgX3NvZnRDYXBXZWkpIHsKCiAgICAgICAgdG9rZW4ubWludCh0ZWFtQWRkcmVzcywgIHRlYW1Ub2tlbnMpOwogICAgICAgIHRva2VuLm1pbnQoYm91bnR5QWRkcmVzcywgYm91bnR5VG9rZW5zKTsKICAgICAgICB0b2tlbi5taW50KGljb0FjY291bnRBZGRyZXNzLCBpY29Ub2tlbnMpOwoKICAgICAgICBNeVdpbGxUb2tlbih0b2tlbikuYWRkRXhjbHVkZWQodGVhbUFkZHJlc3MpOwogICAgICAgIE15V2lsbFRva2VuKHRva2VuKS5hZGRFeGNsdWRlZChib3VudHlBZGRyZXNzKTsKICAgICAgICBNeVdpbGxUb2tlbih0b2tlbikuYWRkRXhjbHVkZWQoaWNvQWNjb3VudEFkZHJlc3MpOwoKICAgICAgICBNeVdpbGxSYXRlUHJvdmlkZXIgcHJvdmlkZXIgPSBuZXcgTXlXaWxsUmF0ZVByb3ZpZGVyKCk7CiAgICAgICAgcHJvdmlkZXIudHJhbnNmZXJPd25lcnNoaXAob3duZXIpOwogICAgICAgIHJhdGVQcm92aWRlciA9IHByb3ZpZGVyOwoKICAgICAgICAvLyBwcmUgSUNPCiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IG92ZXJyaWRlIHRva2VuIGNyZWF0aW9uIHRvIGludGVncmF0ZSB3aXRoIE15V2lsbCB0b2tlbi4KICAgICAqLwogICAgZnVuY3Rpb24gY3JlYXRlVG9rZW5Db250cmFjdCgpIGludGVybmFsIHJldHVybnMgKE1pbnRhYmxlVG9rZW4pIHsKICAgICAgICByZXR1cm4gbmV3IE15V2lsbFRva2VuKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IG92ZXJyaWRlIGdldFJhdGUgdG8gaW50ZWdyYXRlIHdpdGggcmF0ZSBwcm92aWRlci4KICAgICAqLwogICAgZnVuY3Rpb24gZ2V0UmF0ZSh1aW50IF92YWx1ZSkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiByYXRlUHJvdmlkZXIuZ2V0UmF0ZShtc2cuc2VuZGVyLCBzb2xkVG9rZW5zLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEJhc2VSYXRlKCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiByYXRlUHJvdmlkZXIuZ2V0UmF0ZShtc2cuc2VuZGVyLCBzb2xkVG9rZW5zLCBtaW5pbWFsUHVyY2hhc2UpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBvdmVycmlkZSBnZXRSYXRlU2NhbGUgdG8gaW50ZWdyYXRlIHdpdGggcmF0ZSBwcm92aWRlci4KICAgICAqLwogICAgZnVuY3Rpb24gZ2V0UmF0ZVNjYWxlKCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiByYXRlUHJvdmlkZXIuZ2V0UmF0ZVNjYWxlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFkbWluIGNhbiBzZXQgbmV3IHJhdGUgcHJvdmlkZXIuCiAgICAgKiBAcGFyYW0gX3JhdGVQcm92aWRlckFkZHJlc3MgTmV3IHJhdGUgcHJvdmlkZXIuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldFJhdGVQcm92aWRlcihhZGRyZXNzIF9yYXRlUHJvdmlkZXJBZGRyZXNzKSBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoX3JhdGVQcm92aWRlckFkZHJlc3MgIT0gMCk7CiAgICAgICAgcmF0ZVByb3ZpZGVyID0gTXlXaWxsUmF0ZVByb3ZpZGVySShfcmF0ZVByb3ZpZGVyQWRkcmVzcyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFkbWluIGNhbiBtb3ZlIGVuZCB0aW1lLgogICAgICogQHBhcmFtIF9lbmRUaW1lIE5ldyBlbmQgdGltZS4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0RW5kVGltZSh1aW50MzIgX2VuZFRpbWUpIG9ubHlPd25lciBub3RGaW5hbGl6ZWQgewogICAgICAgIHJlcXVpcmUoX2VuZFRpbWUgPiBzdGFydFRpbWUpOwogICAgICAgIGVuZFRpbWUgPSBfZW5kVGltZTsKICAgIH0KCiAgICBmdW5jdGlvbiB2YWxpZFB1cmNoYXNlKHVpbnQgX2Ftb3VudFdlaSwgdWludCBfYWN0dWFsUmF0ZSwgdWludCBfdG90YWxTdXBwbHkpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAoX2Ftb3VudFdlaSA8IG1pbmltYWxQdXJjaGFzZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzdXBlci52YWxpZFB1cmNoYXNlKF9hbW91bnRXZWksIF9hY3R1YWxSYXRlLCBfdG90YWxTdXBwbHkpOwogICAgfQoKICAgIGZ1bmN0aW9uIGZpbmFsaXphdGlvbigpIGludGVybmFsIHsKICAgICAgICBzdXBlci5maW5hbGl6YXRpb24oKTsKICAgICAgICB0b2tlbi5maW5pc2hNaW50aW5nKCk7CiAgICAgICAgaWYgKCFnb2FsUmVhY2hlZCgpKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgTXlXaWxsVG9rZW4odG9rZW4pLmNyb3dkc2FsZUZpbmlzaGVkKCk7CiAgICAgICAgdG9rZW4udHJhbnNmZXJPd25lcnNoaXAob3duZXIpOwogICAgfQp9'.
	

]
