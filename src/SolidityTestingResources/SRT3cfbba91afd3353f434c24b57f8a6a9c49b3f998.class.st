Class {
	#name : #SRT3cfbba91afd3353f434c24b57f8a6a9c49b3f998,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT3cfbba91afd3353f434c24b57f8a6a9c49b3f998 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgovLwovLyBTYWZlTWF0aAovLwovLyBPd25hYmxlCi8vIERlc3RydWN0aWJsZQovLyBQYXVzYWJsZQovLwovLyBFUkMyMEJhc2ljCi8vIEVSQzIwIDogRVJDMjBCYXNpYwovLyBCYXNpY1Rva2VuIDogRVJDMjBCYXNpYwovLyBTdGFuZGFyZFRva2VuIDogRVJDMjAsIEJhc2ljVG9rZW4KLy8gTWludGFibGVUb2tlbiA6IFN0YW5kYXJkVG9rZW4sIE93bmFibGUKLy8gUGF1c2FibGVUb2tlbiA6IFN0YW5kYXJkVG9rZW4sIFBhdXNhYmxlCi8vCi8vIENBVG9rZW4gOiBNaW50YWJsZVRva2VuLCBQYXVzYWJsZVRva2VuCi8vCi8vIENyb3dkc2FsZQovLyBQYXVzYWJsZUNyb3dkc2FsZQovLyBCb251c0Nyb3dkc2FsZQovLyBUb2tlbnNDYXBwZWRDcm93ZHNhbGUKLy8gRmluYWxpemFibGVDcm93ZHNhbGUKLy8KLy8gQ0FUQ3Jvd2RzYWxlCi8vCgovLyBEYXRlLm5vdygpLzEwMDArMzYwMCwgIERhdGUubm93KCkvMTAwMCszNjAwKjIsIDQ3MDAsICIweDAwQTYxN2Y1YkU3MjZGOTJCMjk5ODViQjRjMTg1MDYzMGQ5MDdkYjQiLCAiMHgwMEE2MTdmNWJFNzI2RjkyQjI5OTg1YkI0YzE4NTA2MzBkOTA3ZGI0IiwgIjB4MDBBNjE3ZjViRTcyNkY5MkIyOTk4NWJCNGMxODUwNjMwZDkwN2RiNCIsICIweDAwQTYxN2Y1YkU3MjZGOTJCMjk5ODViQjRjMTg1MDYzMGQ5MDdkYjQiCi8vIDE1MDg4OTYyMjAsIDE1MDk4OTk4MzIsIDQ3MDAsICIweDAwQTYxN2Y1YkU3MjZGOTJCMjk5ODViQjRjMTg1MDYzMGQ5MDdkYjQiLCAiMHgwMEE2MTdmNWJFNzI2RjkyQjI5OTg1YkI0YzE4NTA2MzBkOTA3ZGI0IiwgIjB4MDBBNjE3ZjViRTcyNkY5MkIyOTk4NWJCNGMxODUwNjMwZDkwN2RiNCIsICIweDAwQTYxN2Y1YkU3MjZGOTJCMjk5ODViQjRjMTg1MDYzMGQ5MDdkYjQiCi8vIDE1MDc5MDk5MjMsIDE1MDg1MTQ3MjMsIDQ3MDAsICIweDBiOGUyNzAxM2RmQTgyMmJGMWNjMDFiNkFlMzk0Qjc2REEyMzBhMDMiLCAiMHg1Rjg1QTBlOURENUJkMkYxMWE1NGIyMDg0MjdiMjg2ZTlCMEI1MTlGIiwgIjB4N0Y3ODFkMDhGRDE2NURCRUUxRDU3M0JkYjc5YzQzMDQ1NDQyZWFjNCIsICIweDk4YmY2N2I2YTAzREE3QWNGMkVlNzM0OEZkQjNGOWM5NjQyNWExMzAiCi8vIDE1MDkxMjA2NjksIDE1MTkxMjA2NjksIDMwMDAsICIweDA2RTU4QkQ1RGVFQzYzOWQ5YTc5YzljRDNBNjUzNjU1RWRCZWY4MjAiLCAiMHgwNkU1OEJENURlRUM2MzlkOWE3OWM5Y0QzQTY1MzY1NUVkQmVmODIwIiwgIjB4MDZFNThCRDVEZUVDNjM5ZDlhNzljOWNEM0E2NTM2NTVFZEJlZjgyMCIKCi8qKgogKiBAdGl0bGUgU2FmZU1hdGgKICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCmxpYnJhcnkgU2FmZU1hdGggewogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCi8qKgogKiBAdGl0bGUgT3duYWJsZQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuCiAqLwpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCgogIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCi8qKgogKiBAdGl0bGUgRGVzdHJ1Y3RpYmxlCiAqIEBkZXYgQmFzZSBjb250cmFjdCB0aGF0IGNhbiBiZSBkZXN0cm95ZWQgYnkgb3duZXIuIEFsbCBmdW5kcyBpbiBjb250cmFjdCB3aWxsIGJlIHNlbnQgdG8gdGhlIG93bmVyLgogKi8KY29udHJhY3QgRGVzdHJ1Y3RpYmxlIGlzIE93bmFibGUgewoKICBmdW5jdGlvbiBEZXN0cnVjdGlibGUoKSBwdWJsaWMgcGF5YWJsZSB7IH0KCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlcnMgdGhlIGN1cnJlbnQgYmFsYW5jZSB0byB0aGUgb3duZXIgYW5kIHRlcm1pbmF0ZXMgdGhlIGNvbnRyYWN0LgogICAqLwogIGZ1bmN0aW9uIGRlc3Ryb3koKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHNlbGZkZXN0cnVjdChvd25lcik7CiAgfQoKICBmdW5jdGlvbiBkZXN0cm95QW5kU2VuZChhZGRyZXNzIF9yZWNpcGllbnQpIG9ubHlPd25lciBwdWJsaWMgewogICAgc2VsZmRlc3RydWN0KF9yZWNpcGllbnQpOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBQYXVzYWJsZQogKiBAZGV2IEJhc2UgY29udHJhY3Qgd2hpY2ggYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uCiAqLwpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKICBldmVudCBQYXVzZSgpOwogIGV2ZW50IFVucGF1c2UoKTsKCiAgYm9vbCBwdWJsaWMgcGF1c2VkID0gZmFsc2U7CgoKICAvKioKICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIG5vdCBwYXVzZWQuCiAgICovCiAgbW9kaWZpZXIgd2hlbk5vdFBhdXNlZCgpIHsKICAgIHJlcXVpcmUoIXBhdXNlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBwYXVzZWQuCiAgICovCiAgbW9kaWZpZXIgd2hlblBhdXNlZCgpIHsKICAgIHJlcXVpcmUocGF1c2VkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gcGF1c2UsIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUKICAgKi8KICBmdW5jdGlvbiBwYXVzZSgpIG9ubHlPd25lciB3aGVuTm90UGF1c2VkIHB1YmxpYyB7CiAgICBwYXVzZWQgPSB0cnVlOwogICAgUGF1c2UoKTsKICB9CgogIC8qKgogICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byB1bnBhdXNlLCByZXR1cm5zIHRvIG5vcm1hbCBzdGF0ZQogICAqLwogIGZ1bmN0aW9uIHVucGF1c2UoKSBvbmx5T3duZXIgd2hlblBhdXNlZCBwdWJsaWMgewogICAgcGF1c2VkID0gZmFsc2U7CiAgICBVbnBhdXNlKCk7CiAgfQp9CgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCi8qKgogKiBAdGl0bGUgQmFzaWMgdG9rZW4KICogQGRldiBCYXNpYyB2ZXJzaW9uIG9mIFN0YW5kYXJkVG9rZW4sIHdpdGggbm8gYWxsb3dhbmNlcy4KICovCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgLyoqCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CgogICAgLy8gU2FmZU1hdGguc3ViIHdpbGwgdGhyb3cgaWYgdGhlcmUgaXMgbm90IGVub3VnaCBiYWxhbmNlLgogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgKi8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CgoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwoKICAgIHVpbnQyNTYgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOwoKICAgIC8vIENoZWNrIGlzIG5vdCBuZWVkZWQgYmVjYXVzZSBzdWIoX2FsbG93YW5jZSwgX3ZhbHVlKSB3aWxsIGFscmVhZHkgdGhyb3cgaWYgdGhpcyBjb25kaXRpb24gaXMgbm90IG1ldAogICAgLy8gcmVxdWlyZSAoX3ZhbHVlIDw9IF9hbGxvd2FuY2UpOwoKICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBfYWxsb3dhbmNlLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICoKICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICogYW5kIHRoZSBuZXcgYWxsb3dhbmNlIGJ5IHVuZm9ydHVuYXRlIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcwogICAqIHJhY2UgY29uZGl0aW9uIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUgYWZ0ZXJ3YXJkczoKICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgKi8KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqLwogIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYwogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpIHB1YmxpYwogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCi8qKgogKiBAdGl0bGUgTWludGFibGUgdG9rZW4KICogQGRldiBTaW1wbGUgRVJDMjAgVG9rZW4gZXhhbXBsZSwgd2l0aCBtaW50YWJsZSB0b2tlbiBjcmVhdGlvbgogKiBAZGV2IElzc3VlOiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvaXNzdWVzLzEyMAogKiBCYXNlZCBvbiBjb2RlIGJ5IFRva2VuTWFya2V0TmV0OiBodHRwczovL2dpdGh1Yi5jb20vVG9rZW5NYXJrZXROZXQvaWNvL2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy9NaW50YWJsZVRva2VuLnNvbAogKi8KCmNvbnRyYWN0IE1pbnRhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZSB7CiAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKICBldmVudCBNaW50RmluaXNoZWQoKTsKCiAgYm9vbCBwdWJsaWMgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CgoKICBtb2RpZmllciBjYW5NaW50KCkgewogICAgcmVxdWlyZSghbWludGluZ0ZpbmlzaGVkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIG1pbnQgdG9rZW5zCiAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgbWludGVkIHRva2Vucy4KICAgKiBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAqIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoX2Ftb3VudCk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICBNaW50KF90bywgX2Ftb3VudCk7CiAgICBUcmFuc2ZlcigweDAsIF90bywgX2Ftb3VudCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gc3RvcCBtaW50aW5nIG5ldyB0b2tlbnMuCiAgICogQHJldHVybiBUcnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gZmluaXNoTWludGluZygpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgIE1pbnRGaW5pc2hlZCgpOwogICAgcmV0dXJuIHRydWU7CiAgfQp9CgovKioKICogQHRpdGxlIFBhdXNhYmxlIHRva2VuCiAqCiAqIEBkZXYgU3RhbmRhcmRUb2tlbiBtb2RpZmllZCB3aXRoIHBhdXNhYmxlIHRyYW5zZmVycy4KICoqLwoKY29udHJhY3QgUGF1c2FibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBQYXVzYWJsZSB7CgogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBzdXBlci5hcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJldHVybiBzdXBlci5pbmNyZWFzZUFwcHJvdmFsKF9zcGVuZGVyLCBfYWRkZWRWYWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICByZXR1cm4gc3VwZXIuZGVjcmVhc2VBcHByb3ZhbChfc3BlbmRlciwgX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgfQp9CgovKioKKiBAZGV2IFByZSBtYWluIEJpdGNhbHZlIEJUTCB0b2tlbiBFUkMyMCBjb250cmFjdAoqIEJhc2VkIG9uIHJlZmVyZW5jZXMgZnJvbSBPcGVuWmVwcGVsaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkKKiAKKi8KY29udHJhY3QgQlRMVG9rZW4gaXMgTWludGFibGVUb2tlbiwgUGF1c2FibGVUb2tlbiB7CiAgICAKICAgIC8vIE1ldGFkYXRhCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJCVEwiOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIkJpdENsYXZlIFRva2VuIjsKICAgIHVpbnQ4IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCB2ZXJzaW9uID0gIjEuMCI7CgogICAgLyoqCiAgICAqIEBkZXYgT3ZlcnJpZGUgTWludGFibGVUb2tlbm4uZmluaXNoTWludGluZygpIHRvIGFkZCBjYW5NaW50IG1vZGlmaWVyCiAgICAqLwogICAgZnVuY3Rpb24gZmluaXNoTWludGluZygpIG9ubHlPd25lciBjYW5NaW50IHB1YmxpYyByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIuZmluaXNoTWludGluZygpOwogICAgfQoKfQoKLyoqCiogQGRldiBNYWluIEJpdGNhbHZlIFByZUNBVCB0b2tlbiBFUkMyMCBjb250cmFjdAoqIEJhc2VkIG9uIHJlZmVyZW5jZXMgZnJvbSBPcGVuWmVwcGVsaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkKKi8KY29udHJhY3QgQ0FUb2tlbiBpcyBCVExUb2tlbiwgRGVzdHJ1Y3RpYmxlIHsKCiAgICAvLyBNZXRhZGF0YQogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAidGVzdENBVCI7CiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAidGVzdENBVCI7CiAgICB1aW50OCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgdmVyc2lvbiA9ICIxLjAiOwoKICAgIC8vIE92ZXJyaWRlZCBkZXN0cnVjdG9yCiAgICBmdW5jdGlvbiBkZXN0cm95KCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShtaW50aW5nRmluaXNoZWQpOwogICAgICAgIHN1cGVyLmRlc3Ryb3koKTsKICAgIH0KCiAgICAvLyBPdmVycmlkZWQgZGVzdHJ1Y3RvciBjb21wYW5pb24KICAgIGZ1bmN0aW9uIGRlc3Ryb3lBbmRTZW5kKGFkZHJlc3MgX3JlY2lwaWVudCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShtaW50aW5nRmluaXNoZWQpOwogICAgICAgIHN1cGVyLmRlc3Ryb3lBbmRTZW5kKF9yZWNpcGllbnQpOwogICAgfQoKfQoKLyoqCiAqIEB0aXRsZSBDcm93ZHNhbGUKICogQGRldiBDcm93ZHNhbGUgaXMgYSBiYXNlIGNvbnRyYWN0IGZvciBtYW5hZ2luZyBhIHRva2VuIGNyb3dkc2FsZS4KICogQ3Jvd2RzYWxlcyBoYXZlIGEgc3RhcnQgYW5kIGVuZCB0aW1lc3RhbXBzLCB3aGVyZSBpbnZlc3RvcnMgY2FuIG1ha2UKICogdG9rZW4gcHVyY2hhc2VzIGFuZCB0aGUgY3Jvd2RzYWxlIHdpbGwgYXNzaWduIHRoZW0gdG9rZW5zIGJhc2VkCiAqIG9uIGEgdG9rZW4gcGVyIEVUSCByYXRlLiBGdW5kcyBjb2xsZWN0ZWQgYXJlIGZvcndhcmRlZCB0byBhIHdhbGxldAogKiBhcyB0aGV5IGFycml2ZS4KICovCmNvbnRyYWN0IENyb3dkc2FsZSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIC8vIFRoZSB0b2tlbiBiZWluZyBzb2xkCiAgTWludGFibGVUb2tlbiBwdWJsaWMgdG9rZW47CgogIC8vIHN0YXJ0IGFuZCBlbmQgdGltZXN0YW1wcyB3aGVyZSBpbnZlc3RtZW50cyBhcmUgYWxsb3dlZCAoYm90aCBpbmNsdXNpdmUpCiAgdWludDI1NiBwdWJsaWMgc3RhcnRUaW1lOwogIHVpbnQyNTYgcHVibGljIGVuZFRpbWU7CgogIC8vIGFkZHJlc3Mgd2hlcmUgZnVuZHMgYXJlIGNvbGxlY3RlZAogIGFkZHJlc3MgcHVibGljIHdhbGxldDsKCiAgLy8gaG93IG1hbnkgdG9rZW4gdW5pdHMgYSBidXllciBnZXRzIHBlciB3ZWkKICB1aW50MjU2IHB1YmxpYyByYXRlOwoKICAvLyBhbW91bnQgb2YgcmFpc2VkIG1vbmV5IGluIHdlaQogIHVpbnQyNTYgcHVibGljIHdlaVJhaXNlZDsKCiAgLyoqCiAgICogZXZlbnQgZm9yIHRva2VuIHB1cmNoYXNlIGxvZ2dpbmcKICAgKiBAcGFyYW0gcHVyY2hhc2VyIHdobyBwYWlkIGZvciB0aGUgdG9rZW5zCiAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IHdobyBnb3QgdGhlIHRva2VucwogICAqIEBwYXJhbSB2YWx1ZSB3ZWlzIHBhaWQgZm9yIHB1cmNoYXNlCiAgICogQHBhcmFtIGFtb3VudCBhbW91bnQgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAqLwogIGV2ZW50IFRva2VuUHVyY2hhc2UoYWRkcmVzcyBpbmRleGVkIHB1cmNoYXNlciwgYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IGFtb3VudCk7CgoKICBmdW5jdGlvbiBDcm93ZHNhbGUodWludDI1NiBfc3RhcnRUaW1lLCB1aW50MjU2IF9lbmRUaW1lLCB1aW50MjU2IF9yYXRlLCBhZGRyZXNzIF93YWxsZXQpIHB1YmxpYyB7CiAgICByZXF1aXJlKF9zdGFydFRpbWUgPj0gbm93KTsKICAgIHJlcXVpcmUoX2VuZFRpbWUgPj0gX3N0YXJ0VGltZSk7CiAgICByZXF1aXJlKF9yYXRlID4gMCk7CiAgICByZXF1aXJlKF93YWxsZXQgIT0gMHgwKTsKCiAgICB0b2tlbiA9IGNyZWF0ZVRva2VuQ29udHJhY3QoKTsKICAgIHN0YXJ0VGltZSA9IF9zdGFydFRpbWU7CiAgICBlbmRUaW1lID0gX2VuZFRpbWU7CiAgICByYXRlID0gX3JhdGU7CiAgICB3YWxsZXQgPSBfd2FsbGV0OwogIH0KCiAgLy8gY3JlYXRlcyB0aGUgdG9rZW4gdG8gYmUgc29sZC4KICAvLyBvdmVycmlkZSB0aGlzIG1ldGhvZCB0byBoYXZlIGNyb3dkc2FsZSBvZiBhIHNwZWNpZmljIG1pbnRhYmxlIHRva2VuLgogIGZ1bmN0aW9uIGNyZWF0ZVRva2VuQ29udHJhY3QoKSBpbnRlcm5hbCByZXR1cm5zIChNaW50YWJsZVRva2VuKSB7CiAgICByZXR1cm4gbmV3IE1pbnRhYmxlVG9rZW4oKTsKICB9CgoKICAvLyBmYWxsYmFjayBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBidXkgdG9rZW5zCiAgZnVuY3Rpb24gKCkgcHVibGljIHBheWFibGUgewogICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwogIH0KCiAgLy8gbG93IGxldmVsIHRva2VuIHB1cmNoYXNlIGZ1bmN0aW9uCiAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnkpIHB1YmxpYyBwYXlhYmxlIHsKICAgIHJlcXVpcmUoYmVuZWZpY2lhcnkgIT0gMHgwKTsKICAgIHJlcXVpcmUodmFsaWRQdXJjaGFzZSgpKTsKCiAgICB1aW50MjU2IHdlaUFtb3VudCA9IG1zZy52YWx1ZTsKCiAgICAvLyBjYWxjdWxhdGUgdG9rZW4gYW1vdW50IHRvIGJlIGNyZWF0ZWQKICAgIHVpbnQyNTYgdG9rZW5zID0gd2VpQW1vdW50Lm11bChyYXRlKTsKCiAgICAvLyB1cGRhdGUgc3RhdGUKICAgIHdlaVJhaXNlZCA9IHdlaVJhaXNlZC5hZGQod2VpQW1vdW50KTsKCiAgICB0b2tlbi5taW50KGJlbmVmaWNpYXJ5LCB0b2tlbnMpOwogICAgVG9rZW5QdXJjaGFzZShtc2cuc2VuZGVyLCBiZW5lZmljaWFyeSwgd2VpQW1vdW50LCB0b2tlbnMpOwoKICAgIGZvcndhcmRGdW5kcygpOwogIH0KCiAgLy8gc2VuZCBldGhlciB0byB0aGUgZnVuZCBjb2xsZWN0aW9uIHdhbGxldAogIC8vIG92ZXJyaWRlIHRvIGNyZWF0ZSBjdXN0b20gZnVuZCBmb3J3YXJkaW5nIG1lY2hhbmlzbXMKICBmdW5jdGlvbiBmb3J3YXJkRnVuZHMoKSBpbnRlcm5hbCB7CiAgICB3YWxsZXQudHJhbnNmZXIobXNnLnZhbHVlKTsKICB9CgogIC8vIEByZXR1cm4gdHJ1ZSBpZiB0aGUgdHJhbnNhY3Rpb24gY2FuIGJ1eSB0b2tlbnMKICBmdW5jdGlvbiB2YWxpZFB1cmNoYXNlKCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgYm9vbCB3aXRoaW5QZXJpb2QgPSBub3cgPj0gc3RhcnRUaW1lICYmIG5vdyA8PSBlbmRUaW1lOwogICAgYm9vbCBub25aZXJvUHVyY2hhc2UgPSBtc2cudmFsdWUgIT0gMDsKICAgIHJldHVybiB3aXRoaW5QZXJpb2QgJiYgbm9uWmVyb1B1cmNoYXNlOwogIH0KCiAgLy8gQHJldHVybiB0cnVlIGlmIGNyb3dkc2FsZSBldmVudCBoYXMgZW5kZWQKICBmdW5jdGlvbiBoYXNFbmRlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gbm93ID4gZW5kVGltZTsKICB9CgoKfQoKLyoqCiogQGRldiBQYXJlbnQgY3Jvd2RzYWxlIGNvbnRyYWN0IGV4dGVuZGVkIHdpdGggc3VwcG9ydCBmb3IgcGF1c2FibGUgY3Jvd2RzYWxlLCBtZWFuaW5nIGNyb3dkc2FsZSBjYW4gYmUgcGF1c2VkIGJ5IG93bmVyIGF0IGFueSB0aW1lCiogQmFzZWQgb24gcmVmZXJlbmNlcyBmcm9tIE9wZW5aZXBwZWxpbjogaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXBwZWxpbi1zb2xpZGl0eQoqIAoqIFdoaWxlIHRoZSBjb250cmFjdCBpcyBpbiBwYXVzZWQgc3RhdGUsIHRoZSBjb250cmlidXRpb25zIHdpbGwgYmUgcmVqZWN0ZWQKKiAKKi8KY29udHJhY3QgUGF1c2FibGVDcm93ZHNhbGUgaXMgQ3Jvd2RzYWxlLCBQYXVzYWJsZSB7CgogICAgZnVuY3Rpb24gUGF1c2FibGVDcm93ZHNhbGUoYm9vbCBfcGF1c2VkKSBwdWJsaWMgewogICAgICAgIGlmIChfcGF1c2VkKSB7CiAgICAgICAgICAgIHBhdXNlKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIG92ZXJyaWRpbmcgQ3Jvd2RzYWxlI3ZhbGlkUHVyY2hhc2UgdG8gYWRkIGV4dHJhIHBhdXNlZCBsb2dpYwogICAgLy8gQHJldHVybiB0cnVlIGlmIGludmVzdG9ycyBjYW4gYnV5IGF0IHRoZSBtb21lbnQKICAgIGZ1bmN0aW9uIHZhbGlkUHVyY2hhc2UoKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIudmFsaWRQdXJjaGFzZSgpICYmICFwYXVzZWQ7CiAgICB9Cgp9CgovKioKKiBAZGV2IFBhcmVudCBjcm93ZHNhbGUgY29udHJhY3Qgd2l0aCBzdXBwb3J0IGZvciB0aW1lLWJhc2VkIGFuZCBhbW91bnQgYmFzZWQgYm9udXNlcyAKKiBCYXNlZCBvbiByZWZlcmVuY2VzIGZyb20gT3BlblplcHBlbGluOiBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5CiogCiovCmNvbnRyYWN0IEJvbnVzQ3Jvd2RzYWxlIGlzIENyb3dkc2FsZSwgT3duYWJsZSB7CgogICAgLy8gQ29uc3RhbnRzCiAgICAvLyBUaGUgZm9sbG93aW5nIHdpbGwgYmUgcG9wdWxhdGVkIGJ5IG1haW4gY3Jvd2RzYWxlIGNvbnRyYWN0CiAgICB1aW50MzJbXSBwdWJsaWMgQk9OVVNfVElNRVM7CiAgICB1aW50MzJbXSBwdWJsaWMgQk9OVVNfVElNRVNfVkFMVUVTOwogICAgdWludDMyW10gcHVibGljIEJPTlVTX0FNT1VOVFM7CiAgICB1aW50MzJbXSBwdWJsaWMgQk9OVVNfQU1PVU5UU19WQUxVRVM7CiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBCT05VU19DT0VGRiA9IDEwMDA7IC8vIFZhbHVlcyBzaG91bGQgYmUgMTB4IHBlcmNlbnRzLCB2YWx1ZSAxMDAwID0gMTAwJQogICAgCiAgICAvLyBNZW1iZXJzCiAgICB1aW50IHB1YmxpYyB0b2tlblByaWNlSW5DZW50czsKICAgIHVpbnQgcHVibGljIHRva2VuRGVjaW1hbHM7CgogICAgLyoqCiAgICAqIEBkZXYgQ29udHJ1Y3RvcgogICAgKiBAcGFyYW0gX3Rva2VuUHJpY2VJbkNlbnRzIHRva2VuIHByaWNlIGluIFVTRCBjZW50cy4gVGhlIHByaWNlIGlzIGZpeGVkCiAgICAqIEBwYXJhbSBfdG9rZW5EZWNpbWFscyBudW1iZXIgb2YgZGlnaXRzIGFmdGVyIGRlY2ltYWwgcG9pbnQgZm9yIENBVCB0b2tlbgogICAgKi8KICAgIGZ1bmN0aW9uIEJvbnVzQ3Jvd2RzYWxlKHVpbnQyNTYgX3Rva2VuUHJpY2VJbkNlbnRzLCB1aW50MjU2IF90b2tlbkRlY2ltYWxzKSBwdWJsaWMgewogICAgICAgIHRva2VuUHJpY2VJbkNlbnRzID0gX3Rva2VuUHJpY2VJbkNlbnRzOwogICAgICAgIHRva2VuRGVjaW1hbHMgPSBfdG9rZW5EZWNpbWFsczsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBSZXRyaWV2ZSBsZW5ndGggb2YgYm9udXNlcyBieSB0aW1lIGFycmF5CiAgICAqIEByZXR1cm4gQm9udXNlcyBieSB0aW1lIGFycmF5IGxlbmd0aAogICAgKi8KICAgIGZ1bmN0aW9uIGJvbnVzZXNGb3JUaW1lc0NvdW50KCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludCkgewogICAgICAgIHJldHVybiBCT05VU19USU1FUy5sZW5ndGg7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgU2V0cyBib251c2VzIGZvciB0aW1lCiAgICAqLwogICAgZnVuY3Rpb24gc2V0Qm9udXNlc0ZvclRpbWVzKHVpbnQzMltdIHRpbWVzLCB1aW50MzJbXSB2YWx1ZXMpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUodGltZXMubGVuZ3RoID09IHZhbHVlcy5sZW5ndGgpOwogICAgICAgIGZvciAodWludCBpID0gMDsgaSArIDEgPCB0aW1lcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICByZXF1aXJlKHRpbWVzW2ldIDwgdGltZXNbaSsxXSk7CiAgICAgICAgfQoKICAgICAgICBCT05VU19USU1FUyA9IHRpbWVzOwogICAgICAgIEJPTlVTX1RJTUVTX1ZBTFVFUyA9IHZhbHVlczsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBSZXRyaWV2ZSBsZW5ndGggb2YgYm9udXNlcyBieSBhbW91bnRzIGFycmF5CiAgICAqIEByZXR1cm4gQm9udXNlcyBieSBhbW91bnRzIGFycmF5IGxlbmd0aAogICAgKi8KICAgIGZ1bmN0aW9uIGJvbnVzZXNGb3JBbW91bnRzQ291bnQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50KSB7CiAgICAgICAgcmV0dXJuIEJPTlVTX0FNT1VOVFMubGVuZ3RoOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IFNldHMgYm9udXNlcyBmb3IgVVNEIGFtb3VudHMKICAgICovCiAgICBmdW5jdGlvbiBzZXRCb251c2VzRm9yQW1vdW50cyh1aW50MzJbXSBhbW91bnRzLCB1aW50MzJbXSB2YWx1ZXMpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoYW1vdW50cy5sZW5ndGggPT0gdmFsdWVzLmxlbmd0aCk7CiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpICsgMSA8IGFtb3VudHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgcmVxdWlyZShhbW91bnRzW2ldID4gYW1vdW50c1tpKzFdKTsKICAgICAgICB9CgogICAgICAgIEJPTlVTX0FNT1VOVFMgPSBhbW91bnRzOwogICAgICAgIEJPTlVTX0FNT1VOVFNfVkFMVUVTID0gdmFsdWVzOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IE92ZXJyaWRlZCBidXlUb2tlbnMgbWV0aG9kIG9mIHBhcmVudCBDcm93ZHNhbGUgY29udHJhY3QgIHRvIHByb3ZpZGUgYm9udXMgYnkgY2hhbmdpbmcgYW5kIHJlc3RvcmluZyByYXRlIHZhcmlhYmxlCiAgICAqIEBwYXJhbSBiZW5lZmljaWFyeSB3YWxlbHQgb2YgaW52ZXN0b3IgdG8gcmVjZWl2ZSB0b2tlbnMKICAgICovCiAgICBmdW5jdGlvbiBidXlUb2tlbnMoYWRkcmVzcyBiZW5lZmljaWFyeSkgcHVibGljIHBheWFibGUgewogICAgICAgIC8vIENvbXB1dGUgdXNkIGFtb3VudCA9IHdlaSAqIGNhdHNJbkV0aCAqIHVzZGNlbnRzSW5DYXQgLyB1c2RjZW50c1BlclVzZCAvIHdlaXNQZXJFdGgKICAgICAgICB1aW50MjU2IHVzZFZhbHVlID0gbXNnLnZhbHVlLm11bChyYXRlKS5tdWwodG9rZW5QcmljZUluQ2VudHMpLmRpdigxMDApLmRpdigxIGV0aGVyKTsgCiAgICAgICAgCiAgICAgICAgLy8gQ29tcHV0ZSB0aW1lIGFuZCBhbW91bnQgYm9udXMKICAgICAgICB1aW50MjU2IGJvbnVzID0gY29tcHV0ZUJvbnVzKHVzZFZhbHVlKTsKCiAgICAgICAgLy8gQXBwbHkgYm9udXMgYnkgYWRqdXN0aW5nIGFuZCByZXN0b3JpbmcgcmF0ZSBtZW1iZXIKICAgICAgICB1aW50MjU2IG9sZFJhdGUgPSByYXRlOwogICAgICAgIHJhdGUgPSByYXRlLm11bChCT05VU19DT0VGRi5hZGQoYm9udXMpKS5kaXYoQk9OVVNfQ09FRkYpOwogICAgICAgIHN1cGVyLmJ1eVRva2VucyhiZW5lZmljaWFyeSk7CiAgICAgICAgcmF0ZSA9IG9sZFJhdGU7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgQ29tcHV0ZXMgb3ZlcmFsbCBib251cyBiYXNlZCBvbiB0aW1lIG9mIGNvbnRyaWJ1dGlvbiBhbmQgYW1vdW50IG9mIGNvbnRyaWJ1dGlvbi4gCiAgICAqIFRoZSB0b3RhbCBib251cyBpcyB0aGUgc3VtIG9mIGJvbnVzIGJ5IHRpbWUgYW5kIGJvbnVzIGJ5IGFtb3VudAogICAgKiBAcmV0dXJuIGJvbnVzIHBlcmNlbnRhZ2Ugc2NhbGVkIGJ5IDEwCiAgICAqLwogICAgZnVuY3Rpb24gY29tcHV0ZUJvbnVzKHVpbnQyNTYgdXNkVmFsdWUpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gY29tcHV0ZUFtb3VudEJvbnVzKHVzZFZhbHVlKS5hZGQoY29tcHV0ZVRpbWVCb251cygpKTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBDb21wdXRlcyBib251cyBiYXNlZCBvbiB0aW1lIG9mIGNvbnRyaWJ1dGlvbiByZWxhdGl2ZSB0byB0aGUgYmVnaW5uaW5nIG9mIGNyb3dkc2FsZQogICAgKiBAcmV0dXJuIGJvbnVzIHBlcmNlbnRhZ2Ugc2NhbGVkIGJ5IDEwCiAgICAqLwogICAgZnVuY3Rpb24gY29tcHV0ZVRpbWVCb251cygpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICByZXF1aXJlKG5vdyA+PSBzdGFydFRpbWUpOwoKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBCT05VU19USU1FUy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAobm93LnN1YihzdGFydFRpbWUpIDw9IEJPTlVTX1RJTUVTW2ldKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gQk9OVVNfVElNRVNfVkFMVUVTW2ldOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gMDsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBDb21wdXRlcyBib251cyBiYXNlZCBvbiBhbW91bnQgb2YgY29udHJpYnV0aW9uCiAgICAqIEByZXR1cm4gYm9udXMgcGVyY2VudGFnZSBzY2FsZWQgYnkgMTAKICAgICovCiAgICBmdW5jdGlvbiBjb21wdXRlQW1vdW50Qm9udXModWludDI1NiB1c2RWYWx1ZSkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludDI1NikgewogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IEJPTlVTX0FNT1VOVFMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKHVzZFZhbHVlID49IEJPTlVTX0FNT1VOVFNbaV0pIHsKICAgICAgICAgICAgICAgIHJldHVybiBCT05VU19BTU9VTlRTX1ZBTFVFU1tpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIDA7CiAgICB9Cgp9CgoKLyoqCiogQGRldiBQYXJlbnQgY3Jvd2RzYWxlIGNvbnRyYWN0IGlzIGV4dGVuZGVkIHdpdGggc3VwcG9ydCBmb3IgY2FwIGluIHRva2VucwoqIEJhc2VkIG9uIHJlZmVyZW5jZXMgZnJvbSBPcGVuWmVwcGVsaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkKKiAKKi8KY29udHJhY3QgVG9rZW5zQ2FwcGVkQ3Jvd2RzYWxlIGlzIENyb3dkc2FsZSB7CgogICAgdWludDI1NiBwdWJsaWMgdG9rZW5zQ2FwOwoKICAgIGZ1bmN0aW9uIFRva2Vuc0NhcHBlZENyb3dkc2FsZSh1aW50MjU2IF90b2tlbnNDYXApIHB1YmxpYyB7CiAgICAgICAgdG9rZW5zQ2FwID0gX3Rva2Vuc0NhcDsKICAgIH0KCiAgICAvLyBvdmVycmlkaW5nIENyb3dkc2FsZSN2YWxpZFB1cmNoYXNlIHRvIGFkZCBleHRyYSB0b2tlbnMgY2FwIGxvZ2ljCiAgICAvLyBAcmV0dXJuIHRydWUgaWYgaW52ZXN0b3JzIGNhbiBidXkgYXQgdGhlIG1vbWVudAogICAgZnVuY3Rpb24gdmFsaWRQdXJjaGFzZSgpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMoYm9vbCkgewogICAgICAgIHVpbnQyNTYgdG9rZW5zID0gdG9rZW4udG90YWxTdXBwbHkoKS5hZGQobXNnLnZhbHVlLm11bChyYXRlKSk7CiAgICAgICAgYm9vbCB3aXRoaW5DYXAgPSB0b2tlbnMgPD0gdG9rZW5zQ2FwOwogICAgICAgIHJldHVybiBzdXBlci52YWxpZFB1cmNoYXNlKCkgJiYgd2l0aGluQ2FwOwogICAgfQoKICAgIC8vIG92ZXJyaWRpbmcgQ3Jvd2RzYWxlI2hhc0VuZGVkIHRvIGFkZCB0b2tlbnMgY2FwIGxvZ2ljCiAgICAvLyBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBlbmRlZAogICAgZnVuY3Rpb24gaGFzRW5kZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyhib29sKSB7CiAgICAgICAgYm9vbCBjYXBSZWFjaGVkID0gdG9rZW4udG90YWxTdXBwbHkoKSA+PSB0b2tlbnNDYXA7CiAgICAgICAgcmV0dXJuIHN1cGVyLmhhc0VuZGVkKCkgfHwgY2FwUmVhY2hlZDsKICAgIH0KCn0KCi8qKgogKiBAdGl0bGUgRmluYWxpemFibGVDcm93ZHNhbGUKICogQGRldiBFeHRlbnNpb24gb2YgQ3Jvd2RzYWxlIHdoZXJlIGFuIG93bmVyIGNhbiBkbyBleHRyYSB3b3JrCiAqIGFmdGVyIGZpbmlzaGluZy4KICovCmNvbnRyYWN0IEZpbmFsaXphYmxlQ3Jvd2RzYWxlIGlzIENyb3dkc2FsZSwgT3duYWJsZSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIGJvb2wgcHVibGljIGlzRmluYWxpemVkID0gZmFsc2U7CgogIGV2ZW50IEZpbmFsaXplZCgpOwoKICAvKioKICAgKiBAZGV2IE11c3QgYmUgY2FsbGVkIGFmdGVyIGNyb3dkc2FsZSBlbmRzLCB0byBkbyBzb21lIGV4dHJhIGZpbmFsaXphdGlvbgogICAqIHdvcmsuIENhbGxzIHRoZSBjb250cmFjdCdzIGZpbmFsaXphdGlvbiBmdW5jdGlvbi4KICAgKi8KICBmdW5jdGlvbiBmaW5hbGl6ZSgpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZSghaXNGaW5hbGl6ZWQpOwogICAgcmVxdWlyZShoYXNFbmRlZCgpKTsKCiAgICBmaW5hbGl6YXRpb24oKTsKICAgIEZpbmFsaXplZCgpOwoKICAgIGlzRmluYWxpemVkID0gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgQ2FuIGJlIG92ZXJyaWRkZW4gdG8gYWRkIGZpbmFsaXphdGlvbiBsb2dpYy4gVGhlIG92ZXJyaWRpbmcgZnVuY3Rpb24KICAgKiBzaG91bGQgY2FsbCBzdXBlci5maW5hbGl6YXRpb24oKSB0byBlbnN1cmUgdGhlIGNoYWluIG9mIGZpbmFsaXphdGlvbiBpcwogICAqIGV4ZWN1dGVkIGVudGlyZWx5LgogICAqLwogIGZ1bmN0aW9uIGZpbmFsaXphdGlvbigpIGludGVybmFsIHsKICAgICAgaXNGaW5hbGl6ZWQgPSBpc0ZpbmFsaXplZDsKICB9Cn0KCgogIC8qKgogICAqIEBkZXYgTWFpbiBCaXRDYWx2ZSBDcm93ZHNhbGUgY29udHJhY3QuIAogICAqIEJhc2VkIG9uIHJlZmVyZW5jZXMgZnJvbSBPcGVuWmVwcGVsaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkKICAgKiAKICAgKi8KY29udHJhY3QgQ0FUQ3Jvd2RzYWxlIGlzIEZpbmFsaXphYmxlQ3Jvd2RzYWxlLCBUb2tlbnNDYXBwZWRDcm93ZHNhbGUoQ0FUQ3Jvd2RzYWxlLkNBUCksIFBhdXNhYmxlQ3Jvd2RzYWxlKHRydWUpLCBCb251c0Nyb3dkc2FsZShDQVRDcm93ZHNhbGUuVE9LRU5fVVNEQ0VOVF9QUklDRSwgQ0FUQ3Jvd2RzYWxlLkRFQ0lNQUxTKSB7CgogICAgLy8gQ29uc3RhbnRzCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBERUNJTUFMUyA9IDE4OwogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgQ0FQID0gMiAqICgxMCoqOSkgKiAoMTAqKkRFQ0lNQUxTKTsgICAgICAgICAgICAgIC8vIDJCIENBVAogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgQklUQ0xBVkVfQU1PVU5UID0gMSAqICgxMCoqOSkgKiAoMTAqKkRFQ0lNQUxTKTsgIC8vIDFCIENBVAogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgVE9LRU5fVVNEQ0VOVF9QUklDRSA9IDEwOyAgICAgICAgICAgICAgICAgICAgICAgIC8vICQwLjEwCgogICAgLy8gVmFyaWFibGVzCiAgICBhZGRyZXNzIHB1YmxpYyByZW1haW5pbmdUb2tlbnNXYWxsZXQ7CiAgICBhZGRyZXNzIHB1YmxpYyBwcmVzYWxlV2FsbGV0OwoKICAgIC8qKgogICAgKiBAZGV2IFNldHMgQ0FUIHRvIEV0aGVyIHJhdGUuIFdpbGwgYmUgY2FsbGVkIG11bHRpcGxlIHRpbWVzIGR1cmlnbiB0aGUgY3Jvd2RzYWxlIHRvIGFkanN1dCB0aGUgcmF0ZQogICAgKiBzaW5jZSBDQVQgY29zdCBpcyBmaXhlZCBpbiBVU0QsIGJ1dCBVU0QvRVRIIHJhdGUgaXMgY2hhbmdpbmcKICAgICogQHBhcmFtIF9yYXRlIGRlZmluZXMgQ0FUL0VUSCByYXRlOiAxIEVUSCA9IF9yYXRlIENBVHMKICAgICovCiAgICBmdW5jdGlvbiBzZXRSYXRlKHVpbnQyNTYgX3JhdGUpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShfcmF0ZSAhPSAweDApOwogICAgICAgIHJhdGUgPSBfcmF0ZTsKICAgICAgICBSYXRlQ2hhbmdlKF9yYXRlKTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBBbGxvd3MgdG8gYWRqdXN0IHRoZSBjcm93ZHNhbGUgZW5kIHRpbWUKICAgICovCiAgICBmdW5jdGlvbiBzZXRFbmRUaW1lKHVpbnQyNTYgX2VuZFRpbWUpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZSghaXNGaW5hbGl6ZWQpOwogICAgICAgIHJlcXVpcmUoX2VuZFRpbWUgPj0gc3RhcnRUaW1lKTsKICAgICAgICByZXF1aXJlKF9lbmRUaW1lID49IG5vdyk7CiAgICAgICAgZW5kVGltZSA9IF9lbmRUaW1lOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IFNldHMgdGhlIHdhbGxldCB0byBmb3J3YXJkIEVUSCBjb2xsZWN0ZWQgZnVuZHMKICAgICovCiAgICBmdW5jdGlvbiBzZXRXYWxsZXQoYWRkcmVzcyBfd2FsbGV0KSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoX3dhbGxldCAhPSAweDApOwogICAgICAgIHdhbGxldCA9IF93YWxsZXQ7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgU2V0cyB0aGUgd2FsbGV0IHRvIGhvbGQgdW5zb2xkIHRva2VucyBhdCB0aGUgZW5kIG9mIElDTwogICAgKi8KICAgIGZ1bmN0aW9uIHNldFJlbWFpbmluZ1Rva2Vuc1dhbGxldChhZGRyZXNzIF9yZW1haW5pbmdUb2tlbnNXYWxsZXQpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShfcmVtYWluaW5nVG9rZW5zV2FsbGV0ICE9IDB4MCk7CiAgICAgICAgcmVtYWluaW5nVG9rZW5zV2FsbGV0ID0gX3JlbWFpbmluZ1Rva2Vuc1dhbGxldDsKICAgIH0KCiAgICAvLyBFdmVudHMKICAgIGV2ZW50IFJhdGVDaGFuZ2UodWludDI1NiByYXRlKTsKCiAgICAvKioKICAgICogQGRldiBDb250cnVjdG9yCiAgICAqIEBwYXJhbSBfc3RhcnRUaW1lIHN0YXJ0VGltZSBvZiBjcm93ZHNhbGUKICAgICogQHBhcmFtIF9lbmRUaW1lIGVuZFRpbWUgb2YgY3Jvd2RzYWxlCiAgICAqIEBwYXJhbSBfcmF0ZSBDQVQgLyBFVEggcmF0ZQogICAgKiBAcGFyYW0gX3dhbGxldCB3YWxsZXQgdG8gZm9yd2FyZCB0aGUgY29sbGVjdGVkIGZ1bmRzCiAgICAqIEBwYXJhbSBfcmVtYWluaW5nVG9rZW5zV2FsbGV0IHdhbGxldCB0byBob2xkIHRoZSB1bnNvbGQgdG9rZW5zCiAgICAqIEBwYXJhbSBfYml0Q2xhdmVXYWxsZXQgd2FsbGV0IHRvIGhvbGQgdGhlIGluaXRpYWwgMUIgdG9rZW5zIG9mIEJpdENsYXZlCiAgICAqLwogICAgZnVuY3Rpb24gQ0FUQ3Jvd2RzYWxlKAogICAgICAgIHVpbnQyNTYgX3N0YXJ0VGltZSwKICAgICAgICB1aW50MjU2IF9lbmRUaW1lLAogICAgICAgIHVpbnQyNTYgX3JhdGUsCiAgICAgICAgYWRkcmVzcyBfd2FsbGV0LAogICAgICAgIGFkZHJlc3MgX3JlbWFpbmluZ1Rva2Vuc1dhbGxldCwKICAgICAgICBhZGRyZXNzIF9iaXRDbGF2ZVdhbGxldAogICAgKSBwdWJsaWMKICAgICAgICBDcm93ZHNhbGUoX3N0YXJ0VGltZSwgX2VuZFRpbWUsIF9yYXRlLCBfd2FsbGV0KQogICAgewogICAgICAgIHJlbWFpbmluZ1Rva2Vuc1dhbGxldCA9IF9yZW1haW5pbmdUb2tlbnNXYWxsZXQ7CiAgICAgICAgcHJlc2FsZVdhbGxldCA9IHRoaXM7CgogICAgICAgIC8vIGFsbG9jYXRlIHRva2VucyB0byBCaXRDbGF2ZQogICAgICAgIG1pbnRUb2tlbnMoX2JpdENsYXZlV2FsbGV0LCBCSVRDTEFWRV9BTU9VTlQpOwogICAgfQoKICAgIC8vIE92ZXJyaWRlZCBtZXRob2RzCgogICAgLyoqCiAgICAqIEBkZXYgQ3JlYXRlcyB0b2tlbiBjb250cmFjdCBmb3IgSUNPCiAgICAqIEByZXR1cm4gRVJDMjAgY29udHJhY3QgYXNzb2NpYXRlZCB3aXRoIHRoZSBjcm93ZHNhbGUKICAgICovCiAgICBmdW5jdGlvbiBjcmVhdGVUb2tlbkNvbnRyYWN0KCkgaW50ZXJuYWwgcmV0dXJucyhNaW50YWJsZVRva2VuKSB7CiAgICAgICAgQ0FUb2tlbiB0b2tlbiA9IG5ldyBDQVRva2VuKCk7CiAgICAgICAgdG9rZW4ucGF1c2UoKTsKICAgICAgICByZXR1cm4gdG9rZW47CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgRmluYWxpemVzIHRoZSBjcm93ZHNhbGUKICAgICovCiAgICBmdW5jdGlvbiBmaW5hbGl6YXRpb24oKSBpbnRlcm5hbCB7CiAgICAgICAgc3VwZXIuZmluYWxpemF0aW9uKCk7CgogICAgICAgIC8vIE1pbnQgdG9rZW5zIHVwIHRvIENBUAogICAgICAgIGlmICh0b2tlbi50b3RhbFN1cHBseSgpIDwgdG9rZW5zQ2FwKSB7CiAgICAgICAgICAgIHVpbnQgdG9rZW5zID0gdG9rZW5zQ2FwLnN1Yih0b2tlbi50b3RhbFN1cHBseSgpKTsKICAgICAgICAgICAgdG9rZW4ubWludChyZW1haW5pbmdUb2tlbnNXYWxsZXQsIHRva2Vucyk7CiAgICAgICAgfQoKICAgICAgICAvLyBkaXNhYmxlIG1pbnRpbmcgb2YgQ0FUcwogICAgICAgIHRva2VuLmZpbmlzaE1pbnRpbmcoKTsKCiAgICAgICAgLy8gdGFrZSBvbndlcnNoaXAgb3ZlciBDQVRva2VuIGNvbnRyYWN0CiAgICAgICAgdG9rZW4udHJhbnNmZXJPd25lcnNoaXAob3duZXIpOwogICAgfQoKICAgIC8vIE93bmVyIG1ldGhvZHMKCiAgICAvKioKICAgICogQGRldiBIZWxwZXIgdG8gUGF1c2UgQ0FUb2tlbgogICAgKi8KICAgIGZ1bmN0aW9uIHBhdXNlVG9rZW5zKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgQ0FUb2tlbih0b2tlbikucGF1c2UoKTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBIZWxwZXIgdG8gVW5QYXVzZSBDQVRva2VuCiAgICAqLwogICAgZnVuY3Rpb24gdW5wYXVzZVRva2VucygpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIENBVG9rZW4odG9rZW4pLnVucGF1c2UoKTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBBbGxvY2F0ZXMgdG9rZW5zIGZyb20gcHJlU2FsZSB0byBhIHNwZWNpYWwgd2FsbGV0LiBDYWxsZWQgb25jZSBhcyBwYXJ0IG9mIGNyb3dkc2FsZSBzZXR1cAogICAgKi8KICAgIGZ1bmN0aW9uIG1pbnRQcmVzYWxlVG9rZW5zKHVpbnQyNTYgdG9rZW5zKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBtaW50VG9rZW5zKHByZXNhbGVXYWxsZXQsIHRva2Vucyk7CiAgICAgICAgcHJlc2FsZVdhbGxldCA9IDA7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgVHJhbnNmZXIgcHJlc2FsZWQgdG9rZW5zIGV2ZW4gb24gcGF1c2VkIHRva2VuIGNvbnRyYWN0CiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJQcmVzYWxlVG9rZW5zKGFkZHJlc3MgZGVzdGluYXRpb24sIHVpbnQyNTYgYW1vdW50KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICB1bnBhdXNlVG9rZW5zKCk7CiAgICAgICAgdG9rZW4udHJhbnNmZXIoZGVzdGluYXRpb24sIGFtb3VudCk7CiAgICAgICAgcGF1c2VUb2tlbnMoKTsKICAgIH0KCiAgICAvLyAKICAgIC8qKgogICAgKiBAZGV2IEFsbG9jYXRlcyB0b2tlbnMgZm9yIGludmVzdG9ycyB0aGF0IGNvbnRyaWJ1dGVkIGZyb20gd2Vic2l0ZS4gVGhlc2UgaW5jbHVkZQogICAgKiB3aGl0ZWxpc3RlZCBpbnZlc3RvcnMgYW5kIGludmVzdG9ycyBwYXlpbmcgd2l0aCBCVEMvUVRVTS9MVEMKICAgICovCiAgICBmdW5jdGlvbiBtaW50VG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQyNTYgdG9rZW5zKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKGJlbmVmaWNpYXJ5ICE9IDB4MCk7CiAgICAgICAgcmVxdWlyZSh0b2tlbnMgPiAwKTsKICAgICAgICByZXF1aXJlKG5vdyA8PSBlbmRUaW1lKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3Jvd2RzYWxlICh3aXRob3V0IHN0YXJ0VGltZSBjaGVjaykKICAgICAgICByZXF1aXJlKCFpc0ZpbmFsaXplZCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluYWxpemFibGVDcm93ZHNhbGUKICAgICAgICByZXF1aXJlKHRva2VuLnRvdGFsU3VwcGx5KCkuYWRkKHRva2VucykgPD0gdG9rZW5zQ2FwKTsgLy8gVG9rZW5zQ2FwcGVkQ3Jvd2RzYWxlCiAgICAgICAgCiAgICAgICAgdG9rZW4ubWludChiZW5lZmljaWFyeSwgdG9rZW5zKTsKICAgIH0KCn0='.
	

]
