Class {
	#name : #SRT6fb8522af0e58202f74d6525d7fca7b6b2b49a9e,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT6fb8522af0e58202f74d6525d7fca7b6b2b49a9e >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7Cgpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCgogIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCmNvbnRyYWN0IFBhdXNhYmxlVG9rZW4gaXMgT3duYWJsZSB7CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGluY3JlYXNlRnJvemVuKGFkZHJlc3MgX293bmVyLHVpbnQyNTYgX2luY3JlbWVudGFsQW1vdW50KSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWM7Cn0KCmNvbnRyYWN0IEFkZHJlc3NXaGl0ZWxpc3QgaXMgT3duYWJsZSB7CiAgICAvLyB0aGUgYWRkcmVzc2VzIHRoYXQgYXJlIGluY2x1ZGVkIGluIHRoZSB3aGl0ZWxpc3QKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgd2hpdGVsaXN0ZWQ7CiAgICAKICAgIGZ1bmN0aW9uIGlzV2hpdGVsaXN0ZWQoYWRkcmVzcyBhZGRyKSB2aWV3IHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHdoaXRlbGlzdGVkW2FkZHJdOwogICAgfQoKICAgIGV2ZW50IExvZ1doaXRlbGlzdEFkZChhZGRyZXNzIGluZGV4ZWQgYWRkcik7CgogICAgLy8gYWRkIHRoZXNlIGFkZHJlc3NlcyB0byB0aGUgd2hpdGVsaXN0CiAgICBmdW5jdGlvbiBhZGRUb1doaXRlbGlzdChhZGRyZXNzW10gYWRkcmVzc2VzKSBwdWJsaWMgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBhZGRyZXNzZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKCF3aGl0ZWxpc3RlZFthZGRyZXNzZXNbaV1dKSB7CiAgICAgICAgICAgICAgICB3aGl0ZWxpc3RlZFthZGRyZXNzZXNbaV1dID0gdHJ1ZTsKICAgICAgICAgICAgICAgIExvZ1doaXRlbGlzdEFkZChhZGRyZXNzZXNbaV0pOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBldmVudCBMb2dXaGl0ZWxpc3RSZW1vdmUoYWRkcmVzcyBpbmRleGVkIGFkZHIpOwoKICAgIC8vIHJlbW92ZSB0aGVzZSBhZGRyZXNzZXMgZnJvbSB0aGUgd2hpdGVsaXN0CiAgICBmdW5jdGlvbiByZW1vdmVGcm9tV2hpdGVsaXN0KGFkZHJlc3NbXSBhZGRyZXNzZXMpIHB1YmxpYyBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IGFkZHJlc3Nlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAod2hpdGVsaXN0ZWRbYWRkcmVzc2VzW2ldXSkgewogICAgICAgICAgICAgICAgd2hpdGVsaXN0ZWRbYWRkcmVzc2VzW2ldXSA9IGZhbHNlOwogICAgICAgICAgICAgICAgTG9nV2hpdGVsaXN0UmVtb3ZlKGFkZHJlc3Nlc1tpXSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9Cgpjb250cmFjdCBSdGNUb2tlbkNyb3dkc2FsZSBpcyBPd25hYmxlLCBBZGRyZXNzV2hpdGVsaXN0IHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogICAgUGF1c2FibGVUb2tlbiAgcHVibGljIHRva2VuUmV3YXJkOyAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhZGRyZXNzIG9mIHRoZSB0b2tlbiB1c2VkIGFzIHJld2FyZAoKICAgIC8vIGRlcGxveW1lbnQgdmFyaWFibGVzIGZvciBzdGF0aWMgc3VwcGx5IHNhbGUKICAgIHVpbnQyNTYgcHVibGljIGluaXRpYWxTdXBwbHk7CiAgICB1aW50MjU2IHB1YmxpYyB0b2tlbnNSZW1haW5pbmc7CiAgICB1aW50MjU2IHB1YmxpYyBkZWNpbWFsczsKCiAgICAvLyBtdWx0aS1zaWcgYWRkcmVzc2VzIGFuZCBwcmljZSB2YXJpYWJsZQogICAgYWRkcmVzcyBwdWJsaWMgYmVuZWZpY2lhcnlXYWxsZXQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmVuZWZpY2lhcnlNdWx0aVNpZyAoZm91bmRlciBncm91cCkgb3Igd2FsbGV0IGFjY291bnQKICAgIHVpbnQyNTYgcHVibGljIHRva2Vuc1BlckV0aFByaWNlOyAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCBpbml0aWFsIHZhbHVlIGZsb2F0aW5nIHByaWNlVmFyIDEwLDAwMCB0b2tlbnMgcGVyIEV0aAoKICAgIC8vIHVpbnQyNTYgdmFsdWVzIGZvciBtaW4sbWF4LGNhcHMsdHJhY2tpbmcKICAgIHVpbnQyNTYgcHVibGljIGFtb3VudFJhaXNlZEluV2VpOwogICAgdWludDI1NiBwdWJsaWMgZnVuZGluZ01pbkNhcEluV2VpOwoKICAgIC8vIHByaWNpbmcgdmVyaWFibGUKICAgIHVpbnQyNTYgcHVibGljIHAxX2R1cmF0aW9uOwogICAgdWludDI1NiBwdWJsaWMgcDFfc3RhcnQ7CiAgICB1aW50MjU2IHB1YmxpYyBwMl9zdGFydDsKICAgIHVpbnQyNTYgcHVibGljIHdoaXRlX2R1cmF0aW9uOwoKICAgIC8vIGxvb3AgY29udHJvbCwgSUNPIHN0YXJ0dXAgYW5kIGxpbWl0ZXJzCiAgICB1aW50MjU2IHB1YmxpYyBmdW5kaW5nU3RhcnRUaW1lOyAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyb3dkc2FsZSBzdGFydCB0aW1lIwogICAgdWludDI1NiBwdWJsaWMgZnVuZGluZ0VuZFRpbWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjcm93ZHNhbGUgZW5kIHRpbWUjCiAgICBib29sICAgIHB1YmxpYyBpc0Nyb3dkU2FsZUNsb3NlZCAgICAgICAgICAgICAgID0gZmFsc2U7ICAgICAvLyBjcm93ZHNhbGUgY29tcGxldGlvbiBib29sZWFuCiAgICBib29sICAgIHB1YmxpYyBhcmVGdW5kc1JlbGVhc2VkVG9CZW5lZmljaWFyeSAgID0gZmFsc2U7ICAgICAvLyBib29sZWFuIGZvciBmb3VuZGVyIHRvIHJlY2VpdmUgRXRoIG9yIG5vdAogICAgYm9vbCAgICBwdWJsaWMgaXNDcm93ZFNhbGVTZXR1cCAgICAgICAgICAgICAgICA9IGZhbHNlOyAgICAgLy8gYm9vbGVhbiBmb3IgY3Jvd2RzYWxlIHNldHVwCgogICAgLy8gR2FzIHByaWNlIGxpbWl0CiAgICB1aW50MjU2IG1heEdhc1ByaWNlID0gNTAwMDAwMDAwMDA7CgogICAgZXZlbnQgQnV5KGFkZHJlc3MgaW5kZXhlZCBfc2VuZGVyLCB1aW50MjU2IF9ldGgsIHVpbnQyNTYgX1JUQyk7CiAgICBldmVudCBSZWZ1bmQoYWRkcmVzcyBpbmRleGVkIF9yZWZ1bmRlciwgdWludDI1NiBfdmFsdWUpOwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGZ1bmRWYWx1ZTsKCgogICAgLy8gY29udmVydCB0b2tlbnMgdG8gZGVjaW1hbHMKICAgIGZ1bmN0aW9uIHRvU21hbGxydGModWludDI1NiBhbW91bnQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGFtb3VudC5tdWwoMTAqKmRlY2ltYWxzKTsKICAgIH0KCiAgICAvLyBjb252ZXJ0IHRva2VucyB0byB3aG9sZQogICAgZnVuY3Rpb24gdG9SdGModWludDI1NiBhbW91bnQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGFtb3VudC5kaXYoMTAqKmRlY2ltYWxzKTsKICAgIH0KCiAgICBmdW5jdGlvbiB1cGRhdGVNYXhHYXNQcmljZSh1aW50MjU2IF9uZXdHYXNQcmljZSkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShfbmV3R2FzUHJpY2UgIT0gMCk7CiAgICAgICAgbWF4R2FzUHJpY2UgPSBfbmV3R2FzUHJpY2U7CiAgICB9CgogICAgLy8gc2V0dXAgdGhlIENyb3dkU2FsZSBwYXJhbWV0ZXJzCiAgICBmdW5jdGlvbiBzZXR1cENyb3dkc2FsZSh1aW50MjU2IF9mdW5kaW5nU3RhcnRUaW1lKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIGlmICgoIShpc0Nyb3dkU2FsZVNldHVwKSkKICAgICAgICAgICAgJiYgKCEoYmVuZWZpY2lhcnlXYWxsZXQgPiAwKSkpewogICAgICAgICAgICAvLyBpbml0IGFkZHJlc3NlcwogICAgICAgICAgICB0b2tlblJld2FyZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSBQYXVzYWJsZVRva2VuKDB4N2M1YzVGNzYzMjc0RkMyZjViYjg2ODc3ODE1Njc1QjVkZkI2RkUzYSk7CiAgICAgICAgICAgIGJlbmVmaWNpYXJ5V2FsbGV0ICAgICAgICAgICAgICAgICAgICAgICA9IDB4ZjA3YmQ2M0M1Y2Y0MDRjMmYxN2FiNEY5RkExZTEzZkNDRWJjNTI1NTsKICAgICAgICAgICAgdG9rZW5zUGVyRXRoUHJpY2UgICAgICAgICAgICAgICAgICAgICAgID0gMTAwMDA7ICAgICAgICAgICAgICAgICAgLy8gMSBFVEggPSAxMCwwMDAgUlRDCgogICAgICAgICAgICAvLyBmdW5kaW5nIHRhcmdldHMKICAgICAgICAgICAgZnVuZGluZ01pbkNhcEluV2VpICAgICAgICAgICAgICAgICAgICAgID0gMSBldGhlcjsgICAgICAgICAgICAgICAgICAgICAgICAgIC8vMzUwIEV0aCAobWluIGNhcCkgKHRlc3QgPSAxNSkgLSBjcm93ZHNhbGUgaXMgY29uc2lkZXJlZCBzdWNjZXNzIGFmdGVyIHRoaXMgdmFsdWUKCiAgICAgICAgICAgIC8vIHVwZGF0ZSB2YWx1ZXMKICAgICAgICAgICAgZGVjaW1hbHMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMTg7CiAgICAgICAgICAgIGFtb3VudFJhaXNlZEluV2VpICAgICAgICAgICAgICAgICAgICAgICA9IDA7CiAgICAgICAgICAgIGluaXRpYWxTdXBwbHkgICAgICAgICAgICAgICAgICAgICAgICAgICA9IHRvU21hbGxydGMoMzUwMDAwMDApOyAgICAgICAgICAgICAgICAgIC8vICAgMzUgbWlsbGlvbiAqIDE4IGRlY2ltYWwKICAgICAgICAgICAgdG9rZW5zUmVtYWluaW5nICAgICAgICAgICAgICAgICAgICAgICAgID0gaW5pdGlhbFN1cHBseTsKCiAgICAgICAgICAgIGZ1bmRpbmdTdGFydFRpbWUgICAgICAgICAgICAgICAgICAgICAgICA9IF9mdW5kaW5nU3RhcnRUaW1lOwoKICAgICAgICAgICAgd2hpdGVfZHVyYXRpb24gICAgICAgICAgICAgICAgICAgICAgICAgID0gMiBob3VyczsgICAgICAgICAgICAgICAgICAgICAgICAvLyAyIHdlZWsgKHRlc3QgPSAyIGhvdXIpCiAgICAgICAgICAgIHAxX2R1cmF0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDQgaG91cnM7ICAgICAgICAgICAgICAgICAgICAgICAvLyA0IHdlZWsgKHRlc3QgPSAyIGhvdXIpCgogICAgICAgICAgICBwMV9zdGFydCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSBmdW5kaW5nU3RhcnRUaW1lICsgd2hpdGVfZHVyYXRpb247CiAgICAgICAgICAgIHAyX3N0YXJ0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IHAxX3N0YXJ0ICsgcDFfZHVyYXRpb24gKyA0IGhvdXJzOyAgIC8vICsgNCB3ZWVrIGFmdGVyIHAxIGVuZHMgKHRlc3QgPSA0IGhvdXIpCgogICAgICAgICAgICBmdW5kaW5nRW5kVGltZSAgICAgICAgICAgICAgICAgICAgICAgICAgPSBwMl9zdGFydCArIDQgaG91cnM7IC8vICsgNCB3ZWVrICh0ZXN0ID0gNCBob3VyKQoKICAgICAgICAgICAgLy8gY29uZmlndXJlIGNyb3dkc2FsZQogICAgICAgICAgICBpc0Nyb3dkU2FsZVNldHVwICAgICAgICAgICAgICAgICAgICAgICAgPSB0cnVlOwogICAgICAgICAgICBpc0Nyb3dkU2FsZUNsb3NlZCAgICAgICAgICAgICAgICAgICAgICAgPSBmYWxzZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gc2V0Qm9udXNQcmljZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJvbnVzKSB7CiAgICAgICAgcmVxdWlyZShpc0Nyb3dkU2FsZVNldHVwKTsKICAgICAgICByZXF1aXJlKHAxX3N0YXJ0ICsgcDFfZHVyYXRpb24gPD0gcDJfc3RhcnQpOwogICAgICAgIGlmIChub3cgPj0gZnVuZGluZ1N0YXJ0VGltZSAmJiBub3cgPD0gcDFfc3RhcnQpIHsgLy8gUHJpdmF0ZSBzYWxlIEJvbnVzIDQwJSA9IDUsMDAwIFJUQyAgPSAxIEVUSCAodGVzdCA9IDUwIFJUQykKICAgICAgICAgICAgYm9udXMgPSA0MDAwOwogICAgICAgIH0gZWxzZSBpZiAobm93ID4gcDFfc3RhcnQgJiYgbm93IDw9IHAxX3N0YXJ0ICsgcDFfZHVyYXRpb24pIHsgLy8gUGhhc2UtMSBCb251cyAzMCUgPSAzLDAwMCBSVEMgID0gMSBFVEgKICAgICAgICAgICAgYm9udXMgPSAzMDAwOwogICAgICAgIH0gZWxzZSBpZiAobm93ID4gcDJfc3RhcnQgJiYgbm93IDw9IHAyX3N0YXJ0ICsgMTAgbWludXRlcyApIHsgLy8gUGhhc2UtMiAxc3QgZGF5IEJvbnVzIDI1JSA9IDIsNTAwIFJUQyA9IDEgRVRIICh0ZXN0ID0gKzEwIG1pbnV0ZSkKICAgICAgICAgICAgYm9udXMgPSAyNTAwOwogICAgICAgIH0gZWxzZSBpZiAobm93ID4gcDJfc3RhcnQgKyAxMCBtaW51dGVzICYmIG5vdyA8PSBwMl9zdGFydCArIDEgaG91cnMgKSB7IC8vIFBoYXNlLTIgd2Vlay0xIEJvbnVzIDIwJSA9IDIsMDAwIFJUQyA9IDEgRVRIICh0ZXN0IDw9IHAyX3N0YXJ0ICsxIGhvdXIpCiAgICAgICAgICAgIGJvbnVzID0gMjAwMDsKICAgICAgICB9IGVsc2UgaWYgKG5vdyA+IHAyX3N0YXJ0ICsgMSBob3VycyAmJiBub3cgPD0gcDJfc3RhcnQgKyAyIGhvdXJzICkgeyAvLyBQaGFzZS0yIHdlZWstMiBCb251cyArMTUlID0gMSw1MDAgUlRDID0gMSBFVEggKHRlc3QgPD0gcDJfc3RhcnQgKzIgaG91cikKICAgICAgICAgICAgYm9udXMgPSAxNTAwOwogICAgICAgIH0gZWxzZSBpZiAobm93ID4gcDJfc3RhcnQgKyAyIGhvdXJzICYmIG5vdyA8PSBwMl9zdGFydCArIDMgaG91cnMgKSB7IC8vIFBoYXNlLTIgd2Vlay0zIEJvbnVzICsxMCUgPSAxLDAwMCBSVEMgPSAxIEVUSCAodGVzdCA8PSBwMl9zdGFydCArMyBob3VyKQogICAgICAgICAgICBib251cyA9IDEwMDA7CiAgICAgICAgfSBlbHNlIGlmIChub3cgPiBwMl9zdGFydCArIDMgaG91cnMgJiYgbm93IDw9IGZ1bmRpbmdFbmRUaW1lICkgeyAvLyBQaGFzZS0yIGZpbmFsIHdlZWsgQm9udXMgNSUgPSA1MDAgUlRDID0gMSBFVEgKICAgICAgICAgICAgYm9udXMgPSA1MDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIHAxX2R1cmF0aW9uIGNvbnN0YW50LiBPbmx5IHAyIHN0YXJ0IGNoYW5nZXMuIHAyIHN0YXJ0IGNhbm5vdCBiZSBncmVhdGVyIHRoYW4gMSBtb250aCBmcm9tIHAxIGVuZAogICAgZnVuY3Rpb24gdXBkYXRlRHVyYXRpb24odWludDI1NiBfbmV3UDJTdGFydCkgZXh0ZXJuYWwgb25seU93bmVyIHsgLy8gZnVuY3Rpb24gdG8gdXBkYXRlIHRoZSBkdXJhdGlvbiBvZiBwaGFzZS0xIGFuZCBhZGp1c3QgdGhlIHN0YXJ0IHRpbWUgb2YgcGhhc2UtMgogICAgICAgIHJlcXVpcmUoaXNDcm93ZFNhbGVTZXR1cAogICAgICAgICAgICAmJiAhKHAyX3N0YXJ0ID09IF9uZXdQMlN0YXJ0KQogICAgICAgICAgICAmJiAhKF9uZXdQMlN0YXJ0ID4gcDFfc3RhcnQgKyBwMV9kdXJhdGlvbiArIDMwIGhvdXJzKQogICAgICAgICAgICAmJiAobm93IDwgcDJfc3RhcnQpCiAgICAgICAgICAgICYmIChmdW5kaW5nU3RhcnRUaW1lICsgcDFfZHVyYXRpb24gPCBfbmV3UDJTdGFydCkpOwogICAgICAgIHAyX3N0YXJ0ID0gX25ld1AyU3RhcnQ7CiAgICAgICAgZnVuZGluZ0VuZFRpbWUgPSBwMl9zdGFydC5hZGQoNCBob3Vycyk7ICAgLy8gNCB3ZWVrICh0ZXN0ID0gYWRkKDQgaG91cnMpKQogICAgfQoKICAgIC8vIGRlZmF1bHQgcGF5YWJsZSBmdW5jdGlvbiB3aGVuIHNlbmRpbmcgZXRoZXIgdG8gdGhpcyBjb250cmFjdAogICAgZnVuY3Rpb24gKCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZSh0eC5nYXNwcmljZSA8PSBtYXhHYXNQcmljZSk7CiAgICAgICAgcmVxdWlyZShtc2cuZGF0YS5sZW5ndGggPT0gMCk7CiAgICAgICAgCiAgICAgICAgQnV5UlRDdG9rZW5zKCk7CiAgICB9CgogICAgZnVuY3Rpb24gQnV5UlRDdG9rZW5zKCkgcHVibGljIHBheWFibGUgewogICAgICAgIC8vIGNvbmRpdGlvbnMgKGxlbmd0aCwgY3Jvd2RzYWxlIHNldHVwLCB6ZXJvIGNoZWNrLCBleGNlZWQgZnVuZGluZyBjb250cmliIGNoZWNrLCBjb250cmFjdCB2YWxpZCBjaGVjaywgd2l0aGluIGZ1bmRpbmcgYmxvY2sgcmFuZ2UgY2hlY2ssIGJhbGFuY2Ugb3ZlcmZsb3cgY2hlY2sgZXRjKQogICAgICAgIHJlcXVpcmUoIShtc2cudmFsdWUgPT0gMCkKICAgICAgICAmJiAoaXNDcm93ZFNhbGVTZXR1cCkKICAgICAgICAmJiAobm93ID49IGZ1bmRpbmdTdGFydFRpbWUpCiAgICAgICAgJiYgKG5vdyA8PSBmdW5kaW5nRW5kVGltZSkKICAgICAgICAmJiAodG9rZW5zUmVtYWluaW5nID4gMCkpOwoKICAgICAgICAvLyBvbmx5IHdoaXRlbGlzdGVkIGFkZHJlc3NlcyBhcmUgYWxsb3dlZCBkdXJpbmcgdGhlIGZpcnN0IGRheSBvZiBwaGFzZSAxCiAgICAgICAgaWYgKG5vdyA8PSBwMV9zdGFydCkgewogICAgICAgICAgICBhc3NlcnQoaXNXaGl0ZWxpc3RlZChtc2cuc2VuZGVyKSk7CiAgICAgICAgfQogICAgICAgIHVpbnQyNTYgcmV3YXJkVHJhbnNmZXJBbW91bnQgICAgICAgID0gMDsKICAgICAgICB1aW50MjU2IHJld2FyZEJhc2VUcmFuc2ZlckFtb3VudCAgICA9IDA7CiAgICAgICAgdWludDI1NiByZXdhcmRCb251c1RyYW5zZmVyQW1vdW50ICAgPSAwOwogICAgICAgIHVpbnQyNTYgY29udHJpYnV0aW9uSW5XZWkgICAgICAgICAgID0gbXNnLnZhbHVlOwogICAgICAgIHVpbnQyNTYgcmVmdW5kSW5XZWkgICAgICAgICAgICAgICAgID0gMDsKCiAgICAgICAgcmV3YXJkQm9udXNUcmFuc2ZlckFtb3VudCAgICAgICA9IHNldEJvbnVzUHJpY2UoKTsKICAgICAgICByZXdhcmRCYXNlVHJhbnNmZXJBbW91bnQgICAgICAgID0gKG1zZy52YWx1ZS5tdWwodG9rZW5zUGVyRXRoUHJpY2UpKTsgLy8gU2luY2UgYm90aCBldGhlciBhbmQgUlRDIGhhdmUgMTggZGVjaW1hbHMsIE5vIG5lZWQgb2YgY29udmVyc2lvbgogICAgICAgIHJld2FyZEJvbnVzVHJhbnNmZXJBbW91bnQgICAgICAgPSAobXNnLnZhbHVlLm11bChyZXdhcmRCb251c1RyYW5zZmVyQW1vdW50KSk7IC8vIFNpbmNlIGJvdGggZXRoZXIgYW5kIFJUQyBoYXZlIDE4IGRlY2ltYWxzLCBObyBuZWVkIG9mIGNvbnZlcnNpb24KICAgICAgICByZXdhcmRUcmFuc2ZlckFtb3VudCAgICAgICAgICAgID0gcmV3YXJkQmFzZVRyYW5zZmVyQW1vdW50LmFkZChyZXdhcmRCb251c1RyYW5zZmVyQW1vdW50KTsKCiAgICAgICAgaWYgKHJld2FyZFRyYW5zZmVyQW1vdW50ID4gdG9rZW5zUmVtYWluaW5nKSB7CiAgICAgICAgICAgIHVpbnQyNTYgcGFydGlhbFBlcmNlbnRhZ2U7CiAgICAgICAgICAgIHBhcnRpYWxQZXJjZW50YWdlID0gdG9rZW5zUmVtYWluaW5nLm11bCgxMCoqMTgpLmRpdihyZXdhcmRUcmFuc2ZlckFtb3VudCk7CiAgICAgICAgICAgIGNvbnRyaWJ1dGlvbkluV2VpID0gY29udHJpYnV0aW9uSW5XZWkubXVsKHBhcnRpYWxQZXJjZW50YWdlKS5kaXYoMTAqKjE4KTsKICAgICAgICAgICAgcmV3YXJkQm9udXNUcmFuc2ZlckFtb3VudCA9IHJld2FyZEJvbnVzVHJhbnNmZXJBbW91bnQubXVsKHBhcnRpYWxQZXJjZW50YWdlKS5kaXYoMTAqKjE4KTsKICAgICAgICAgICAgcmV3YXJkVHJhbnNmZXJBbW91bnQgPSB0b2tlbnNSZW1haW5pbmc7CiAgICAgICAgICAgIHJlZnVuZEluV2VpID0gbXNnLnZhbHVlLnN1Yihjb250cmlidXRpb25JbldlaSk7CiAgICAgICAgfQoKICAgICAgICBhbW91bnRSYWlzZWRJbldlaSAgICAgICAgICAgICAgID0gYW1vdW50UmFpc2VkSW5XZWkuYWRkKGNvbnRyaWJ1dGlvbkluV2VpKTsKICAgICAgICB0b2tlbnNSZW1haW5pbmcgICAgICAgICAgICAgICAgID0gdG9rZW5zUmVtYWluaW5nLnN1YihyZXdhcmRUcmFuc2ZlckFtb3VudCk7ICAvLyB3aWxsIGNhdXNlIHRocm93IGlmIGF0dGVtcHQgdG8gcHVyY2hhc2Ugb3ZlciB0aGUgdG9rZW4gbGltaXQgaW4gb25lIHR4IG9yIGF0IGFsbCBvbmNlIGxpbWl0IHJlYWNoZWQKICAgICAgICBmdW5kVmFsdWVbbXNnLnNlbmRlcl0gICAgICAgICAgID0gZnVuZFZhbHVlW21zZy5zZW5kZXJdLmFkZChjb250cmlidXRpb25JbldlaSk7CiAgICAgICAgYXNzZXJ0KHRva2VuUmV3YXJkLmluY3JlYXNlRnJvemVuKG1zZy5zZW5kZXIsIHJld2FyZEJvbnVzVHJhbnNmZXJBbW91bnQpKTsKICAgICAgICB0b2tlblJld2FyZC50cmFuc2Zlcihtc2cuc2VuZGVyLCByZXdhcmRUcmFuc2ZlckFtb3VudCk7CiAgICAgICAgQnV5KG1zZy5zZW5kZXIsIGNvbnRyaWJ1dGlvbkluV2VpLCByZXdhcmRUcmFuc2ZlckFtb3VudCk7CiAgICAgICAgaWYgKHJlZnVuZEluV2VpID4gMCkgewogICAgICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHJlZnVuZEluV2VpKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gYmVuZWZpY2lhcnlNdWx0aVNpZ1dpdGhkcmF3KCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICBjaGVja0dvYWxSZWFjaGVkKCk7CiAgICAgICAgcmVxdWlyZShhcmVGdW5kc1JlbGVhc2VkVG9CZW5lZmljaWFyeSAmJiAoYW1vdW50UmFpc2VkSW5XZWkgPj0gZnVuZGluZ01pbkNhcEluV2VpKSk7CiAgICAgICAgYmVuZWZpY2lhcnlXYWxsZXQudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGVja0dvYWxSZWFjaGVkKCkgcHVibGljIHJldHVybnMgKGJ5dGVzMzIgcmVzcG9uc2UpIHsgLy8gcmV0dXJuIGNyb3dkZnVuZCBzdGF0dXMgdG8gb3duZXIgZm9yIGVhY2ggcmVzdWx0IGNhc2UsIHVwZGF0ZSBwdWJsaWMgY29uc3RhbnQKICAgICAgICAvLyB1cGRhdGUgc3RhdGUgJiBzdGF0dXMgdmFyaWFibGVzCiAgICAgICAgcmVxdWlyZSAoaXNDcm93ZFNhbGVTZXR1cCk7CiAgICAgICAgaWYgKChhbW91bnRSYWlzZWRJbldlaSA8IGZ1bmRpbmdNaW5DYXBJbldlaSkgJiYgKGJsb2NrLnRpbWVzdGFtcCA8PSBmdW5kaW5nRW5kVGltZSAmJiBibG9jay50aW1lc3RhbXAgPj0gZnVuZGluZ1N0YXJ0VGltZSkpIHsgLy8gSUNPIGluIHByb2dyZXNzLCB1bmRlciBzb2Z0Y2FwCiAgICAgICAgICAgIGFyZUZ1bmRzUmVsZWFzZWRUb0JlbmVmaWNpYXJ5ID0gZmFsc2U7CiAgICAgICAgICAgIGlzQ3Jvd2RTYWxlQ2xvc2VkID0gZmFsc2U7CiAgICAgICAgICAgIHJldHVybiAiSW4gcHJvZ3Jlc3MgKEV0aCA8IFNvZnRjYXApIjsKICAgICAgICB9IGVsc2UgaWYgKChhbW91bnRSYWlzZWRJbldlaSA8IGZ1bmRpbmdNaW5DYXBJbldlaSkgJiYgKGJsb2NrLnRpbWVzdGFtcCA8IGZ1bmRpbmdTdGFydFRpbWUpKSB7IC8vIElDTyBoYXMgbm90IHN0YXJ0ZWQKICAgICAgICAgICAgYXJlRnVuZHNSZWxlYXNlZFRvQmVuZWZpY2lhcnkgPSBmYWxzZTsKICAgICAgICAgICAgaXNDcm93ZFNhbGVDbG9zZWQgPSBmYWxzZTsKICAgICAgICAgICAgcmV0dXJuICJDcm93ZHNhbGUgaXMgc2V0dXAiOwogICAgICAgIH0gZWxzZSBpZiAoKGFtb3VudFJhaXNlZEluV2VpIDwgZnVuZGluZ01pbkNhcEluV2VpKSAmJiAoYmxvY2sudGltZXN0YW1wID4gZnVuZGluZ0VuZFRpbWUpKSB7IC8vIElDTyBlbmRlZCwgdW5kZXIgc29mdGNhcAogICAgICAgICAgICBhcmVGdW5kc1JlbGVhc2VkVG9CZW5lZmljaWFyeSA9IGZhbHNlOwogICAgICAgICAgICBpc0Nyb3dkU2FsZUNsb3NlZCA9IHRydWU7CiAgICAgICAgICAgIHJldHVybiAiVW5zdWNjZXNzZnVsIChFdGggPCBTb2Z0Y2FwKSI7CiAgICAgICAgfSBlbHNlIGlmICgoYW1vdW50UmFpc2VkSW5XZWkgPj0gZnVuZGluZ01pbkNhcEluV2VpKSAmJiAodG9rZW5zUmVtYWluaW5nID09IDApKSB7IC8vIElDTyBlbmRlZCwgYWxsIHRva2VucyBnb25lCiAgICAgICAgICAgIGFyZUZ1bmRzUmVsZWFzZWRUb0JlbmVmaWNpYXJ5ID0gdHJ1ZTsKICAgICAgICAgICAgaXNDcm93ZFNhbGVDbG9zZWQgPSB0cnVlOwogICAgICAgICAgICByZXR1cm4gIlN1Y2Nlc3NmdWwgKFJUQyA+PSBIYXJkY2FwKSEiOwogICAgICAgIH0gZWxzZSBpZiAoKGFtb3VudFJhaXNlZEluV2VpID49IGZ1bmRpbmdNaW5DYXBJbldlaSkgJiYgKGJsb2NrLnRpbWVzdGFtcCA+IGZ1bmRpbmdFbmRUaW1lKSAmJiAodG9rZW5zUmVtYWluaW5nID4gMCkpIHsgLy8gSUNPIGVuZGVkLCBvdmVyIHNvZnRjYXAhCiAgICAgICAgICAgIGFyZUZ1bmRzUmVsZWFzZWRUb0JlbmVmaWNpYXJ5ID0gdHJ1ZTsKICAgICAgICAgICAgaXNDcm93ZFNhbGVDbG9zZWQgPSB0cnVlOwogICAgICAgICAgICByZXR1cm4gIlN1Y2Nlc3NmdWwgKEV0aCA+PSBTb2Z0Y2FwKSEiOwogICAgICAgIH0gZWxzZSBpZiAoKGFtb3VudFJhaXNlZEluV2VpID49IGZ1bmRpbmdNaW5DYXBJbldlaSkgJiYgKHRva2Vuc1JlbWFpbmluZyA+IDApICYmIChibG9jay50aW1lc3RhbXAgPD0gZnVuZGluZ0VuZFRpbWUpKSB7IC8vIElDTyBpbiBwcm9ncmVzcywgb3ZlciBzb2Z0Y2FwIQogICAgICAgICAgICBhcmVGdW5kc1JlbGVhc2VkVG9CZW5lZmljaWFyeSA9IHRydWU7CiAgICAgICAgICAgIGlzQ3Jvd2RTYWxlQ2xvc2VkID0gZmFsc2U7CiAgICAgICAgICAgIHJldHVybiAiSW4gcHJvZ3Jlc3MgKEV0aCA+PSBTb2Z0Y2FwKSEiOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiByZWZ1bmQoKSBleHRlcm5hbCB7IC8vIGFueSBjb250cmlidXRvciBjYW4gY2FsbCB0aGlzIHRvIGhhdmUgdGhlaXIgRXRoIHJldHVybmVkLiB1c2VyJ3MgcHVyY2hhc2VkIFJUQyB0b2tlbnMgYXJlIGJ1cm5lZCBwcmlvciByZWZ1bmQgb2YgRXRoLgogICAgICAgIGNoZWNrR29hbFJlYWNoZWQoKTsKICAgICAgICAvL3JlcXVpcmUgbWluQ2FwIG5vdCByZWFjaGVkCiAgICAgICAgcmVxdWlyZSAoKGFtb3VudFJhaXNlZEluV2VpIDwgZnVuZGluZ01pbkNhcEluV2VpKQogICAgICAgICYmIChpc0Nyb3dkU2FsZUNsb3NlZCkKICAgICAgICAmJiAobm93ID4gZnVuZGluZ0VuZFRpbWUpCiAgICAgICAgJiYgKGZ1bmRWYWx1ZVttc2cuc2VuZGVyXSA+IDApKTsKCiAgICAgICAgLy9yZWZ1bmQgRXRoIHNlbnQKICAgICAgICB1aW50MjU2IGV0aFJlZnVuZCA9IGZ1bmRWYWx1ZVttc2cuc2VuZGVyXTsKICAgICAgICBmdW5kVmFsdWVbbXNnLnNlbmRlcl0gPSAwOwoKICAgICAgICAvL3NlbmQgRXRoIGJhY2ssIGJ1cm4gdG9rZW5zCiAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihldGhSZWZ1bmQpOwogICAgICAgIFJlZnVuZChtc2cuc2VuZGVyLCBldGhSZWZ1bmQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGJ1cm5SZW1haW5pbmdUb2tlbnMoKSBvbmx5T3duZXIgZXh0ZXJuYWwgewogICAgICAgIHJlcXVpcmUobm93ID4gZnVuZGluZ0VuZFRpbWUpOwogICAgICAgIHVpbnQyNTYgdG9rZW5zVG9CdXJuID0gdG9rZW5SZXdhcmQuYmFsYW5jZU9mKHRoaXMpOwogICAgICAgIHRva2VuUmV3YXJkLmJ1cm4odG9rZW5zVG9CdXJuKTsKICAgIH0KfQoKbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQ=='.
	

]
