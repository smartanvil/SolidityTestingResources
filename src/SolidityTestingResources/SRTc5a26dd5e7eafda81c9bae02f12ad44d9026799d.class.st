Class {
	#name : #SRTc5a26dd5e7eafda81c9bae02f12ad44d9026799d,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTc5a26dd5e7eafda81c9bae02f12ad44d9026799d >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTA7Cgpjb250cmFjdCBUb2tlbiB7CiAgICAKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGJhbGFuY2VPZjsKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgcHVibGljIGFkZHJlc3NlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIGFkZHJlc3NFeGlzdHM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBhZGRyZXNzSW5kZXg7CiAgICB1aW50MjU2IHB1YmxpYyBudW1iZXJPZkFkZHJlc3MgPSAwOwogICAgCiAgICBzdHJpbmcgcHVibGljIHBoeXNpY2FsU3RyaW5nOwogICAgc3RyaW5nIHB1YmxpYyBjcnlwdG9TdHJpbmc7CiAgICAKICAgIGJvb2wgcHVibGljIGlzU2VjdXJlZDsKICAgIHN0cmluZyBwdWJsaWMgbmFtZTsKICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sOwogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgICBib29sIHB1YmxpYyBjYW5NaW50QnVybjsKICAgIHVpbnQyNTYgcHVibGljIHR4blRheDsKICAgIHVpbnQyNTYgcHVibGljIGhvbGRpbmdUYXg7CiAgICAvL0luIFdlZWtzLCBvbiBGcmlkYXlzCiAgICB1aW50MjU2IHB1YmxpYyBob2xkaW5nVGF4SW50ZXJ2YWw7CiAgICB1aW50MjU2IHB1YmxpYyBsYXN0SG9sZGluZ1RheDsKICAgIHVpbnQyNTYgcHVibGljIGhvbGRpbmdUYXhEZWNpbWFscyA9IDI7CiAgICBib29sIHB1YmxpYyBpc1ByaXZhdGU7CiAgICAKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwogICAgCiAgICBmdW5jdGlvbiBUb2tlbihzdHJpbmcgbiwgc3RyaW5nIGEsIHVpbnQyNTYgdG90YWxTdXBwbHlUb1VzZSwgYm9vbCBpc1NlY3VyZWQsIGJvb2wgY01CLCBzdHJpbmcgcGh5c2ljYWwsIHN0cmluZyBjcnlwdG8sIHVpbnQyNTYgdHhuVGF4VG9Vc2UsIHVpbnQyNTYgaG9sZGluZ1RheFRvVXNlLCB1aW50MjU2IGhvbGRpbmdUYXhJbnRlcnZhbFRvVXNlLCBib29sIGlzUHJpdmF0ZVRvVXNlKSB7CiAgICAgICAgbmFtZSA9IG47CiAgICAgICAgc3ltYm9sID0gYTsKICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5VG9Vc2U7CiAgICAgICAgYmFsYW5jZU9mW21zZy5zZW5kZXJdID0gdG90YWxTdXBwbHlUb1VzZTsKICAgICAgICBpc1NlY3VyZWQgPSBpc1NlY3VyZWQ7CiAgICAgICAgcGh5c2ljYWxTdHJpbmcgPSBwaHlzaWNhbDsKICAgICAgICBjcnlwdG9TdHJpbmcgPSBjcnlwdG87CiAgICAgICAgY2FuTWludEJ1cm4gPSBjTUI7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIHR4blRheCA9IHR4blRheFRvVXNlOwogICAgICAgIGhvbGRpbmdUYXggPSBob2xkaW5nVGF4VG9Vc2U7CiAgICAgICAgaG9sZGluZ1RheEludGVydmFsID0gaG9sZGluZ1RheEludGVydmFsVG9Vc2U7CiAgICAgICAgaWYoaG9sZGluZ1RheEludGVydmFsIT0wKSB7CiAgICAgICAgICAgIGxhc3RIb2xkaW5nVGF4ID0gbm93OwogICAgICAgICAgICB3aGlsZShnZXRIb3VyKGxhc3RIb2xkaW5nVGF4KSE9MjEpIHsKICAgICAgICAgICAgICAgIGxhc3RIb2xkaW5nVGF4IC09IDEgaG91cnM7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgd2hpbGUoZ2V0V2Vla2RheShsYXN0SG9sZGluZ1RheCkhPTUpIHsKICAgICAgICAgICAgICAgIGxhc3RIb2xkaW5nVGF4IC09IDEgZGF5czsKICAgICAgICAgICAgfQogICAgICAgICAgICBsYXN0SG9sZGluZ1RheCAtPSBnZXRNaW51dGUobGFzdEhvbGRpbmdUYXgpICogKDEgbWludXRlcykgKyBnZXRTZWNvbmQobGFzdEhvbGRpbmdUYXgpICogKDEgc2Vjb25kcyk7CiAgICAgICAgfQogICAgICAgIGlzUHJpdmF0ZSA9IGlzUHJpdmF0ZVRvVXNlOwogICAgICAgIAogICAgICAgIGFkZEFkZHJlc3Mob3duZXIpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHBheWFibGUgewogICAgICAgIGNoYXJnZUhvbGRpbmdUYXgoKTsKICAgICAgICBpZiAoYmFsYW5jZU9mW21zZy5zZW5kZXJdIDwgX3ZhbHVlKSB0aHJvdzsKICAgICAgICBpZiAoYmFsYW5jZU9mW190b10gKyBfdmFsdWUgPCBiYWxhbmNlT2ZbX3RvXSkgdGhyb3c7CiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIgJiYgX3RvICE9IG93bmVyICYmIHR4blRheCAhPSAwKSB7CiAgICAgICAgICAgIGlmKCFvd25lci5zZW5kKHR4blRheCkpIHsKICAgICAgICAgICAgICAgIHRocm93OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmKGlzUHJpdmF0ZSAmJiBtc2cuc2VuZGVyICE9IG93bmVyICYmICFhZGRyZXNzRXhpc3RzW190b10pIHsKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgfQogICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICAgICAgYmFsYW5jZU9mW190b10gKz0gX3ZhbHVlOwogICAgICAgIGFkZEFkZHJlc3MoX3RvKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNoYW5nZVR4blRheCh1aW50MjU2IF9uZXdWYWx1ZSkgewogICAgICAgIGlmKG1zZy5zZW5kZXIgIT0gb3duZXIpIHRocm93OwogICAgICAgIHR4blRheCA9IF9uZXdWYWx1ZTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gbWludCh1aW50MjU2IF92YWx1ZSkgewogICAgICAgIGlmKGNhbk1pbnRCdXJuICYmIG1zZy5zZW5kZXIgPT0gb3duZXIpIHsKICAgICAgICAgICAgaWYgKGJhbGFuY2VPZlttc2cuc2VuZGVyXSArIF92YWx1ZSA8IGJhbGFuY2VPZlttc2cuc2VuZGVyXSkgdGhyb3c7CiAgICAgICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSArPSBfdmFsdWU7CiAgICAgICAgICAgIHRvdGFsU3VwcGx5ICs9IF92YWx1ZTsKICAgICAgICAgICAgVHJhbnNmZXIoMCwgbXNnLnNlbmRlciwgX3ZhbHVlKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGJ1cm4odWludDI1NiBfdmFsdWUpIHsKICAgICAgICBpZihjYW5NaW50QnVybiAmJiBtc2cuc2VuZGVyID09IG93bmVyKSB7CiAgICAgICAgICAgIGlmIChiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPCBfdmFsdWUpIHRocm93OwogICAgICAgICAgICBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOwogICAgICAgICAgICB0b3RhbFN1cHBseSAtPSBfdmFsdWU7CiAgICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIDAsIF92YWx1ZSk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jdGlvbiBjaGFyZ2VIb2xkaW5nVGF4KCkgewogICAgICAgIGlmKGhvbGRpbmdUYXhJbnRlcnZhbCE9MCkgewogICAgICAgICAgICB1aW50MjU2IGRhdGVEaWYgPSBub3cgLSBsYXN0SG9sZGluZ1RheDsKICAgICAgICAgICAgYm9vbCBjaGFuZ2VkID0gZmFsc2U7CiAgICAgICAgICAgIHdoaWxlKGRhdGVEaWYgPj0gaG9sZGluZ1RheEludGVydmFsICogKDEgd2Vla3MpKSB7CiAgICAgICAgICAgICAgICBjaGFuZ2VkPXRydWU7CiAgICAgICAgICAgICAgICBkYXRlRGlmIC09IGhvbGRpbmdUYXhJbnRlcnZhbCAqICgxIHdlZWtzKTsKICAgICAgICAgICAgICAgIGZvcih1aW50MjU2IGkgPSAwO2k8bnVtYmVyT2ZBZGRyZXNzO2krKykgewogICAgICAgICAgICAgICAgICAgIGlmKGFkZHJlc3Nlc1tpXSE9b3duZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdWludDI1NiBhbXRPZlRheFRvUGF5ID0gKChiYWxhbmNlT2ZbYWRkcmVzc2VzW2ldXSkgKiBob2xkaW5nVGF4KSAgLyAoMTAqKmhvbGRpbmdUYXhEZWNpbWFscykvICgxMCoqaG9sZGluZ1RheERlY2ltYWxzKTsKICAgICAgICAgICAgICAgICAgICAgICAgYmFsYW5jZU9mW2FkZHJlc3Nlc1tpXV0gLT0gYW10T2ZUYXhUb1BheTsKICAgICAgICAgICAgICAgICAgICAgICAgYmFsYW5jZU9mW293bmVyXSArPSBhbXRPZlRheFRvUGF5OwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZihjaGFuZ2VkKSB7CiAgICAgICAgICAgICAgICBsYXN0SG9sZGluZ1RheCA9IG5vdzsKICAgICAgICAgICAgICAgIHdoaWxlKGdldEhvdXIobGFzdEhvbGRpbmdUYXgpIT0yMSkgewogICAgICAgICAgICAgICAgICAgIGxhc3RIb2xkaW5nVGF4IC09IDEgaG91cnM7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB3aGlsZShnZXRXZWVrZGF5KGxhc3RIb2xkaW5nVGF4KSE9NSkgewogICAgICAgICAgICAgICAgICAgIGxhc3RIb2xkaW5nVGF4IC09IDEgZGF5czsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxhc3RIb2xkaW5nVGF4IC09IGdldE1pbnV0ZShsYXN0SG9sZGluZ1RheCkgKiAoMSBtaW51dGVzKSArIGdldFNlY29uZChsYXN0SG9sZGluZ1RheCkgKiAoMSBzZWNvbmRzKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIAogICAgZnVuY3Rpb24gY2hhbmdlSG9sZGluZ1RheCh1aW50MjU2IF9uZXdWYWx1ZSkgewogICAgICAgIGlmKG1zZy5zZW5kZXIgIT0gb3duZXIpIHRocm93OwogICAgICAgIGhvbGRpbmdUYXggPSBfbmV3VmFsdWU7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNoYW5nZUhvbGRpbmdUYXhJbnRlcnZhbCh1aW50MjU2IF9uZXdWYWx1ZSkgewogICAgICAgIGlmKG1zZy5zZW5kZXIgIT0gb3duZXIpIHRocm93OwogICAgICAgIGhvbGRpbmdUYXhJbnRlcnZhbCA9IF9uZXdWYWx1ZTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gYWRkQWRkcmVzcyAoYWRkcmVzcyBhZGRyKSBwcml2YXRlIHsKICAgICAgICBpZighYWRkcmVzc0V4aXN0c1thZGRyXSkgewogICAgICAgICAgICBhZGRyZXNzSW5kZXhbYWRkcl0gPSBudW1iZXJPZkFkZHJlc3M7CiAgICAgICAgICAgIGFkZHJlc3Nlc1tudW1iZXJPZkFkZHJlc3MrK10gPSBhZGRyOwogICAgICAgICAgICBhZGRyZXNzRXhpc3RzW2FkZHJdID0gdHJ1ZTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGFkZEFkZHJlc3NNYW51YWwgKGFkZHJlc3MgYWRkcikgewogICAgICAgIGlmKG1zZy5zZW5kZXIgPT0gb3duZXIgJiYgaXNQcml2YXRlKSB7CiAgICAgICAgICAgIGFkZEFkZHJlc3MoYWRkcik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jdGlvbiByZW1vdmVBZGRyZXNzIChhZGRyZXNzIGFkZHIpIHByaXZhdGUgewogICAgICAgIGlmKGFkZHJlc3NFeGlzdHNbYWRkcl0pIHsKICAgICAgICAgICAgbnVtYmVyT2ZBZGRyZXNzLS07CiAgICAgICAgICAgIGFkZHJlc3Nlc1thZGRyZXNzSW5kZXhbYWRkcl1dID0gMHgwOwogICAgICAgICAgICBhZGRyZXNzRXhpc3RzW2FkZHJdID0gZmFsc2U7CiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jdGlvbiByZW1vdmVBZGRyZXNzTWFudWFsIChhZGRyZXNzIGFkZHIpIHsKICAgICAgICBpZihtc2cuc2VuZGVyID09IG93bmVyICYmIGlzUHJpdmF0ZSkgewogICAgICAgICAgICByZW1vdmVBZGRyZXNzKGFkZHIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0V2Vla2RheSh1aW50IHRpbWVzdGFtcCkgcmV0dXJucyAodWludDgpIHsKICAgICAgICAgICAgcmV0dXJuIHVpbnQ4KCh0aW1lc3RhbXAgLyA4NjQwMCArIDQpICUgNyk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldEhvdXIodWludCB0aW1lc3RhbXApIHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgICAgIHJldHVybiB1aW50OCgodGltZXN0YW1wIC8gNjAgLyA2MCkgJSAyNCk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0TWludXRlKHVpbnQgdGltZXN0YW1wKSByZXR1cm5zICh1aW50OCkgewogICAgICAgICAgICByZXR1cm4gdWludDgoKHRpbWVzdGFtcCAvIDYwKSAlIDYwKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRTZWNvbmQodWludCB0aW1lc3RhbXApIHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgICAgIHJldHVybiB1aW50OCh0aW1lc3RhbXAgJSA2MCk7CiAgICB9CgogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7Cn0KCmNvbnRyYWN0IHRva2Vuc2FsZSB7CiAgICAKICAgIFRva2VuIHB1YmxpYyB0b2tlbjsKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogICAgdWludDI1NiBwdWJsaWMgbnVtYmVyT2ZUb2tlbnM7CiAgICB1aW50MjU2IHB1YmxpYyBudW1iZXJPZlRva2Vuc0xlZnQ7CiAgICB1aW50MjU2IHB1YmxpYyBwcmljZVBlclRva2VuOwogICAgdWludDI1NiBwdWJsaWMgdG9rZW5zRnJvbVByZXNhbGUgPSAwOwogICAgdWludDggcHVibGljIGRlY2ltYWxzID0gMjsKICAgIAogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICBzdHJpbmcgcHVibGljIG5hbWU7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsKICAgIAogICAgYWRkcmVzcyBwdWJsaWMgZmluYWxBZGRyZXNzID0gMHg1OTA0OTU3ZDI1RDBjNjIxMzQ5MTg4MmE2NDc2NTk2N0Y4OEJDQ0M3OwogICAgCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBiYWxhbmNlT2Y7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBhZGRyZXNzRXhpc3RzOwogICAgbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSBwdWJsaWMgYWRkcmVzc2VzOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgYWRkcmVzc0luZGV4OwogICAgdWludDI1NiBwdWJsaWMgbnVtYmVyT2ZBZGRyZXNzID0gMDsKICAgIAogICAgbWFwcGluZyAodWludDI1NiA9PiB1aW50MjU2KSBwdWJsaWMgZGF0ZXM7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IHVpbnQyNTYpIHB1YmxpYyBwZXJjZW50czsKICAgIHVpbnQyNTYgcHVibGljIG51bWJlck9mRGF0ZXMgPSA4OwogICAgCiAgICB0b2tlbnNhbGUgcHMgPSB0b2tlbnNhbGUoMHhhNjdkOTdkNzVlRTE3NWUwNUJCMUZCMTc1MjlGRDc3MmVFOEU5MDMwKTsKICAgIAogICAgZnVuY3Rpb24gdG9rZW5zYWxlKGFkZHJlc3MgdG9rZW5BZGRyZXNzLCB1aW50MjU2IG5vT2ZUb2tlbnMsIHVpbnQyNTYgcHJQZXJUb2tlbikgewogICAgICAgIGRhdGVzWzBdID0gMTUwNTUyMDAwMDsKICAgICAgICBkYXRlc1sxXSA9IDE1MDYwMzg0MDA7CiAgICAgICAgZGF0ZXNbMl0gPSAxNTA2MTI0ODAwOwogICAgICAgIGRhdGVzWzNdID0gMTUwNjgxNjAwMDsKICAgICAgICBkYXRlc1s0XSA9IDE1MDc0MjA4MDA7CiAgICAgICAgZGF0ZXNbNV0gPSAxNTA4MTEyMDAwOwogICAgICAgIGRhdGVzWzZdID0gMTUwODYzMDQwMDsKICAgICAgICBkYXRlc1s3XSA9IDE1MDg4MDMyMDA7CiAgICAgICAgcGVyY2VudHNbMF0gPSAzNTAwMDsKICAgICAgICBwZXJjZW50c1sxXSA9IDIwMDAwOwogICAgICAgIHBlcmNlbnRzWzJdID0gMTAwMDA7CiAgICAgICAgcGVyY2VudHNbM10gPSA1MDAwOwogICAgICAgIHBlcmNlbnRzWzRdID0gMjUwMDsKICAgICAgICBwZXJjZW50c1s1XSA9IDA7CiAgICAgICAgcGVyY2VudHNbNl0gPSA5MDAxOwogICAgICAgIHBlcmNlbnRzWzddID0gOTAwMTsKICAgICAgICB0b2tlbiA9IFRva2VuKHRva2VuQWRkcmVzcyk7CiAgICAgICAgbnVtYmVyT2ZUb2tlbnMgPSBub09mVG9rZW5zICogMTAwOwogICAgICAgIHRvdGFsU3VwcGx5ID0gbm9PZlRva2VucyAqIDEwMDsKICAgICAgICBudW1iZXJPZlRva2Vuc0xlZnQgPSBub09mVG9rZW5zICogMTAwOwogICAgICAgIHByaWNlUGVyVG9rZW4gPSBwclBlclRva2VuOwogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgICAgICBuYW1lID0gIkF1dG9uaW8gSUNPIjsKICAgICAgICBzeW1ib2wgPSAiTklPIjsKICAgICAgICB1cGRhdGVQcmVzYWxlTnVtYmVycygpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBhZGRBZGRyZXNzIChhZGRyZXNzIGFkZHIpIHByaXZhdGUgewogICAgICAgIGlmKCFhZGRyZXNzRXhpc3RzW2FkZHJdKSB7CiAgICAgICAgICAgIGFkZHJlc3NJbmRleFthZGRyXSA9IG51bWJlck9mQWRkcmVzczsKICAgICAgICAgICAgYWRkcmVzc2VzW251bWJlck9mQWRkcmVzcysrXSA9IGFkZHI7CiAgICAgICAgICAgIGFkZHJlc3NFeGlzdHNbYWRkcl0gPSB0cnVlOwogICAgICAgIH0KICAgIH0KICAgIAogICAgZnVuY3Rpb24gZW5kUHJlc2FsZSgpIHsKICAgICAgICBpZihtc2cuc2VuZGVyID09IG93bmVyKSB7CiAgICAgICAgICAgIGlmKG5vdyA+IGRhdGVzW251bWJlck9mRGF0ZXMtMV0pIHsKICAgICAgICAgICAgICAgIGZpbmlzaCgpOwogICAgICAgICAgICB9IGVsc2UgaWYobnVtYmVyT2ZUb2tlbnNMZWZ0ID09IDApIHsKICAgICAgICAgICAgICAgIGZpbmlzaCgpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aHJvdzsKICAgICAgICB9CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGZpbmlzaCgpIHByaXZhdGUgewogICAgICAgIGlmKCFmaW5hbEFkZHJlc3Muc2VuZCh0aGlzLmJhbGFuY2UpKSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KICAgIH0KICAgIAogICAgZnVuY3Rpb24gdXBkYXRlUHJlc2FsZU51bWJlcnMoKSB7CiAgICAgICAgaWYobXNnLnNlbmRlciA9PSBvd25lcikgewogICAgICAgICAgICB1aW50MjU2IHByZXZUb2tlbnNGcm9tUHJlc2FsZSA9IHRva2Vuc0Zyb21QcmVzYWxlOwogICAgICAgICAgICB0b2tlbnNGcm9tUHJlc2FsZSA9IHBzLm51bWJlck9mVG9rZW5zKCkgLSBwcy5udW1iZXJPZlRva2Vuc0xlZnQoKTsKICAgICAgICAgICAgdWludDI1NiBkaWYgPSB0b2tlbnNGcm9tUHJlc2FsZSAtIHByZXZUb2tlbnNGcm9tUHJlc2FsZTsKICAgICAgICAgICAgbnVtYmVyT2ZUb2tlbnNMZWZ0IC09IGRpZiAqIDEwMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aHJvdzsKICAgICAgICB9CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uICgpIHBheWFibGUgewogICAgICAgIHVpbnQyNTYgcHJldlRva2Vuc0Zyb21QcmVzYWxlID0gdG9rZW5zRnJvbVByZXNhbGU7CiAgICAgICAgdG9rZW5zRnJvbVByZXNhbGUgPSBwcy5udW1iZXJPZlRva2VucygpIC0gcHMubnVtYmVyT2ZUb2tlbnNMZWZ0KCk7CiAgICAgICAgdWludDI1NiBkaWYgPSB0b2tlbnNGcm9tUHJlc2FsZSAtIHByZXZUb2tlbnNGcm9tUHJlc2FsZTsKICAgICAgICBudW1iZXJPZlRva2Vuc0xlZnQgLT0gZGlmICogMTAwOwogICAgICAgIHVpbnQyNTYgd2VpU2VudCA9IG1zZy52YWx1ZSAqIDEwMDsKICAgICAgICBpZih3ZWlTZW50PT0wKSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KICAgICAgICB1aW50MjU2IHdlaUxlZnRPdmVyID0gMDsKICAgICAgICBpZihudW1iZXJPZlRva2Vuc0xlZnQ8PTAgfHwgbm93PGRhdGVzWzBdIHx8IG5vdz5kYXRlc1tudW1iZXJPZkRhdGVzLTFdKSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KICAgICAgICB1aW50MjU2IHBlcmNlbnQgPSA5MDAxOwogICAgICAgIGZvcih1aW50MjU2IGk9MDtpPG51bWJlck9mRGF0ZXMtMTtpKyspIHsKICAgICAgICAgICAgaWYobm93Pj1kYXRlc1tpXSAmJiBub3c8PWRhdGVzW2krMV0gKSB7CiAgICAgICAgICAgICAgICBwZXJjZW50ID0gcGVyY2VudHNbaV07CiAgICAgICAgICAgICAgICBpPW51bWJlck9mRGF0ZXMtMTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZihwZXJjZW50PT05MDAxKSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KICAgICAgICB1aW50MjU2IHRva2Vuc1RvR2l2ZSA9IHdlaVNlbnQgLyBwcmljZVBlclRva2VuOwogICAgICAgIGlmKHRva2Vuc1RvR2l2ZSAqIHByaWNlUGVyVG9rZW4gPiB3ZWlTZW50KSB0b2tlbnNUb0dpdmUtLTsKICAgICAgICB0b2tlbnNUb0dpdmU9KHRva2Vuc1RvR2l2ZSooMTAwMDAwK3BlcmNlbnQpKS8xMDAwMDA7CiAgICAgICAgaWYodG9rZW5zVG9HaXZlPm51bWJlck9mVG9rZW5zTGVmdCkgewogICAgICAgICAgICB3ZWlMZWZ0T3ZlciA9ICh0b2tlbnNUb0dpdmUgLSBudW1iZXJPZlRva2Vuc0xlZnQpICogcHJpY2VQZXJUb2tlbjsKICAgICAgICAgICAgdG9rZW5zVG9HaXZlID0gbnVtYmVyT2ZUb2tlbnNMZWZ0OwogICAgICAgIH0KICAgICAgICBudW1iZXJPZlRva2Vuc0xlZnQgLT0gdG9rZW5zVG9HaXZlOwogICAgICAgIGlmKGFkZHJlc3NFeGlzdHNbbXNnLnNlbmRlcl0pIHsKICAgICAgICAgICAgYmFsYW5jZU9mW21zZy5zZW5kZXJdICs9IHRva2Vuc1RvR2l2ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhZGRBZGRyZXNzKG1zZy5zZW5kZXIpOwogICAgICAgICAgICBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPSB0b2tlbnNUb0dpdmU7CiAgICAgICAgfQogICAgICAgIFRyYW5zZmVyKDB4MCxtc2cuc2VuZGVyLHRva2Vuc1RvR2l2ZSk7CiAgICAgICAgaWYod2VpTGVmdE92ZXIvMTAwPjApbXNnLnNlbmRlci5zZW5kKHdlaUxlZnRPdmVyLzEwMCk7CiAgICB9CiAgICAKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwp9'.
	

]
