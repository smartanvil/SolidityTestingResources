Class {
	#name : #SRT37304b0ab297f13f5520c523102797121182fb5b,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT37304b0ab297f13f5520c523102797121182fb5b >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7Cgpjb250cmFjdCBTcG9ydENyeXB0IHsKICAgIGFkZHJlc3MgcHJpdmF0ZSBvd25lcjsKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBwcml2YXRlIGFkbWluczsKCiAgICBmdW5jdGlvbiBTcG9ydENyeXB0KCkgcHVibGljIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGFuZ2VPd25lcihhZGRyZXNzIG5ld093bmVyKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkQWRtaW4oYWRkcmVzcyBhZGRyKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIGFkbWluc1thZGRyXSA9IHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gcmVtb3ZlQWRtaW4oYWRkcmVzcyBhZGRyKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIGFkbWluc1thZGRyXSA9IGZhbHNlOwogICAgfQoKCiAgICAvLyBFdmVudHMKCiAgICBldmVudCBMb2dCYWxhbmNlQ2hhbmdlKGFkZHJlc3MgaW5kZXhlZCBhY2NvdW50LCB1aW50IG9sZEFtb3VudCwgdWludCBuZXdBbW91bnQpOwogICAgZXZlbnQgTG9nRGVwb3NpdChhZGRyZXNzIGluZGV4ZWQgYWNjb3VudCk7CiAgICBldmVudCBMb2dXaXRoZHJhdyhhZGRyZXNzIGluZGV4ZWQgYWNjb3VudCk7CiAgICBldmVudCBMb2dUcmFkZShhZGRyZXNzIGluZGV4ZWQgdGFrZXJBY2NvdW50LCBhZGRyZXNzIGluZGV4ZWQgbWFrZXJBY2NvdW50LCB1aW50IGluZGV4ZWQgbWF0Y2hJZCwgdWludCBvcmRlckhhc2gsIHVpbnQ4IG9yZGVyRGlyZWN0aW9uLCB1aW50OCBwcmljZSwgdWludCBsb25nQW1vdW50LCBpbnQgbmV3TG9uZ1Bvc2l0aW9uLCB1aW50IHNob3J0QW1vdW50LCBpbnQgbmV3U2hvcnRQb3NpdGlvbik7CiAgICBldmVudCBMb2dUcmFkZUVycm9yKGFkZHJlc3MgaW5kZXhlZCB0YWtlckFjY291bnQsIGFkZHJlc3MgaW5kZXhlZCBtYWtlckFjY291bnQsIHVpbnQgaW5kZXhlZCBtYXRjaElkLCB1aW50IG9yZGVySGFzaCwgdWludDE2IHN0YXR1cyk7CiAgICBldmVudCBMb2dPcmRlckNhbmNlbChhZGRyZXNzIGluZGV4ZWQgYWNjb3VudCwgdWludCBpbmRleGVkIG1hdGNoSWQsIHVpbnQgb3JkZXJIYXNoKTsKICAgIGV2ZW50IExvZ0ZpbmFsaXplTWF0Y2godWludCBpbmRleGVkIG1hdGNoSWQsIHVpbnQ4IGZpbmFsUHJpY2UpOwogICAgZXZlbnQgTG9nQ2xhaW0oYWRkcmVzcyBpbmRleGVkIGFjY291bnQsIHVpbnQgaW5kZXhlZCBtYXRjaElkLCB1aW50IGFtb3VudCk7CgoKICAgIC8vIFN0b3JhZ2UKCiAgICBzdHJ1Y3QgTWF0Y2ggewogICAgICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBpbnQpIHBvc2l0aW9uczsKICAgICAgICB1aW50NjQgZmlyc3RUcmFkZVRpbWVzdGFtcDsKICAgICAgICBib29sIGZpbmFsaXplZDsKICAgICAgICB1aW50OCBmaW5hbFByaWNlOwogICAgfQoKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50KSBwcml2YXRlIGJhbGFuY2VzOwogICAgbWFwcGluZyh1aW50ID0+IE1hdGNoKSBwcml2YXRlIG1hdGNoZXM7CiAgICBtYXBwaW5nKHVpbnQgPT4gdWludCkgcHJpdmF0ZSBmaWxsZWRBbW91bnRzOwoKCiAgICAvLyBNZW1vcnkKCiAgICB1aW50IGNvbnN0YW50IE1BWF9TQU5FX0FNT1VOVCA9IDIqKjEyODsKCiAgICBlbnVtIFN0YXR1cyB7CiAgICAgICAgT0ssCiAgICAgICAgTUFUQ0hfRklOQUxJWkVELAogICAgICAgIE9SREVSX0VYUElSRUQsCiAgICAgICAgT1JERVJfTUFMRk9STUVELAogICAgICAgIE9SREVSX0JBRF9TSUcsCiAgICAgICAgQU1PVU5UX01BTEZPUk1FRCwKICAgICAgICBTRUxGX1RSQURFLAogICAgICAgIFpFUk9fVkFMVUVfVFJBREUKICAgIH0KCiAgICBzdHJ1Y3QgT3JkZXIgewogICAgICAgIHVpbnQgb3JkZXJIYXNoOwogICAgICAgIHVpbnQgbWF0Y2hJZDsKICAgICAgICB1aW50IGFtb3VudDsKICAgICAgICB1aW50IGV4cGlyeTsKICAgICAgICBhZGRyZXNzIGFkZHI7CiAgICAgICAgdWludDggcHJpY2U7CiAgICAgICAgdWludDggZGlyZWN0aW9uOwogICAgfQoKICAgIC8vIFswXTogbWF0Y2ggaGFzaAogICAgLy8gWzFdOiBhbW91bnQKICAgIC8vIFsyXTogNS1ieXRlIGV4cGlyeSwgNS1ieXRlIG5vbmNlLCAxLWJ5dGUgcHJpY2UsIDEtYnl0ZSBkaXJlY3Rpb24sIDIwLWJ5dGUgYWRkcmVzcwoKICAgIGZ1bmN0aW9uIHBhcnNlT3JkZXIodWludFszXSBtZW1vcnkgcmF3T3JkZXIpIHByaXZhdGUgY29uc3RhbnQgcmV0dXJucyhPcmRlciBtZW1vcnkgbykgewogICAgICAgIG8ub3JkZXJIYXNoID0gdWludChrZWNjYWsyNTYodGhpcywgcmF3T3JkZXIpKTsKCiAgICAgICAgby5tYXRjaElkID0gcmF3T3JkZXJbMF07CiAgICAgICAgby5hbW91bnQgPSByYXdPcmRlclsxXTsKCiAgICAgICAgdWludCBwYWNrZWQgPSByYXdPcmRlclsyXTsKICAgICAgICBvLmV4cGlyeSA9IHBhY2tlZCA+PiAoOCoyNyk7CiAgICAgICAgby5hZGRyID0gYWRkcmVzcyhwYWNrZWQgJiAweDAwZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZik7CiAgICAgICAgby5wcmljZSA9IHVpbnQ4KChwYWNrZWQgPj4gKDgqMjEpKSAmIDB4ZmYpOwogICAgICAgIG8uZGlyZWN0aW9uID0gdWludDgoKHBhY2tlZCA+PiAoOCoyMCkpICYgMHhmZik7CiAgICB9CgogICAgZnVuY3Rpb24gdmFsaWRhdGVPcmRlclBhcmFtcyhPcmRlciBtZW1vcnkgbykgcHJpdmF0ZSBwdXJlIHJldHVybnMoYm9vbCkgewogICAgICAgIGlmIChvLmFtb3VudCA+IE1BWF9TQU5FX0FNT1VOVCkgcmV0dXJuIGZhbHNlOwogICAgICAgIGlmIChvLnByaWNlID09IDAgfHwgby5wcmljZSA+IDk5KSByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKG8uZGlyZWN0aW9uID4gMSkgcmV0dXJuIGZhbHNlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHZhbGlkYXRlT3JkZXJTaWcoT3JkZXIgbWVtb3J5IG8sIGJ5dGVzMzIgciwgYnl0ZXMzMiBzLCB1aW50OCB2KSBwcml2YXRlIHB1cmUgcmV0dXJucyhib29sKSB7CiAgICAgICAgaWYgKGVjcmVjb3ZlcihrZWNjYWsyNTYoIlx4MTlFdGhlcmV1bSBTaWduZWQgTWVzc2FnZTpcbjMyIiwgby5vcmRlckhhc2gpLCB2LCByLCBzKSAhPSBvLmFkZHIpIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBzdHJ1Y3QgVHJhZGUgewogICAgICAgIFN0YXR1cyBzdGF0dXM7CiAgICAgICAgYWRkcmVzcyBsb25nQWRkcjsKICAgICAgICBhZGRyZXNzIHNob3J0QWRkcjsKICAgICAgICBpbnQgbmV3TG9uZ1Bvc2l0aW9uOwogICAgICAgIGludCBuZXdTaG9ydFBvc2l0aW9uOwogICAgICAgIGludCBsb25nQmFsYW5jZURlbHRhOwogICAgICAgIGludCBzaG9ydEJhbGFuY2VEZWx0YTsKICAgICAgICB1aW50IHNob3J0QW1vdW50OwogICAgICAgIHVpbnQgbG9uZ0Ftb3VudDsKICAgIH0KCgogICAgLy8gVXNlciBtZXRob2RzCgogICAgZnVuY3Rpb24oKSBleHRlcm5hbCBwYXlhYmxlIHsKICAgICAgICByZXZlcnQoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZXBvc2l0KCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgaWYgKG1zZy52YWx1ZSA+IDApIHsKICAgICAgICAgICAgdWludCBvcmlnQW1vdW50ID0gYmFsYW5jZXNbbXNnLnNlbmRlcl07CiAgICAgICAgICAgIHVpbnQgbmV3QW1vdW50ID0gc2FmZUFkZChvcmlnQW1vdW50LCBtc2cudmFsdWUpOwogICAgICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IG5ld0Ftb3VudDsKCiAgICAgICAgICAgIExvZ0RlcG9zaXQobXNnLnNlbmRlcik7CiAgICAgICAgICAgIExvZ0JhbGFuY2VDaGFuZ2UobXNnLnNlbmRlciwgb3JpZ0Ftb3VudCwgbmV3QW1vdW50KTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gd2l0aGRyYXcodWludCBhbW91bnQpIGV4dGVybmFsIHsKICAgICAgICB1aW50IG9yaWdBbW91bnQgPSBiYWxhbmNlc1ttc2cuc2VuZGVyXTsKICAgICAgICB1aW50IGFtb3VudFRvV2l0aGRyYXcgPSBtaW51MjU2KG9yaWdBbW91bnQsIGFtb3VudCk7CgogICAgICAgIGlmIChhbW91bnRUb1dpdGhkcmF3ID4gMCkgewogICAgICAgICAgICB1aW50IG5ld0Ftb3VudCA9IG9yaWdBbW91bnQgLSBhbW91bnRUb1dpdGhkcmF3OwogICAgICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IG5ld0Ftb3VudDsKCiAgICAgICAgICAgIExvZ1dpdGhkcmF3KG1zZy5zZW5kZXIpOwogICAgICAgICAgICBMb2dCYWxhbmNlQ2hhbmdlKG1zZy5zZW5kZXIsIG9yaWdBbW91bnQsIG5ld0Ftb3VudCk7CgogICAgICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKGFtb3VudFRvV2l0aGRyYXcpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBjYW5jZWxPcmRlcih1aW50WzNdIG9yZGVyLCBieXRlczMyIHIsIGJ5dGVzMzIgcywgdWludDggdikgZXh0ZXJuYWwgewogICAgICAgIE9yZGVyIG1lbW9yeSBvID0gcGFyc2VPcmRlcihvcmRlcik7CgogICAgICAgIC8vIERvbid0IGJvdGhlciB2YWxpZGF0aW5nIG9yZGVyIHBhcmFtcy4KICAgICAgICByZXF1aXJlKHZhbGlkYXRlT3JkZXJTaWcobywgciwgcywgdikpOwogICAgICAgIHJlcXVpcmUoby5hZGRyID09IG1zZy5zZW5kZXIpOwoKICAgICAgICBpZiAoYmxvY2sudGltZXN0YW1wIDwgby5leHBpcnkpIHsKICAgICAgICAgICAgZmlsbGVkQW1vdW50c1tvLm9yZGVySGFzaF0gPSBvLmFtb3VudDsKICAgICAgICAgICAgTG9nT3JkZXJDYW5jZWwobXNnLnNlbmRlciwgby5tYXRjaElkLCBvLm9yZGVySGFzaCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHRyYWRlKHVpbnQgYW1vdW50LCB1aW50WzNdIG9yZGVyLCBieXRlczMyIHIsIGJ5dGVzMzIgcywgdWludDggdikgZXh0ZXJuYWwgewogICAgICAgIE9yZGVyIG1lbW9yeSBvID0gcGFyc2VPcmRlcihvcmRlcik7CgogICAgICAgIGlmICghdmFsaWRhdGVPcmRlclBhcmFtcyhvKSkgewogICAgICAgICAgICBMb2dUcmFkZUVycm9yKG1zZy5zZW5kZXIsIG8uYWRkciwgby5tYXRjaElkLCBvLm9yZGVySGFzaCwgdWludDE2KFN0YXR1cy5PUkRFUl9NQUxGT1JNRUQpKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKCF2YWxpZGF0ZU9yZGVyU2lnKG8sIHIsIHMsIHYpKSB7CiAgICAgICAgICAgIExvZ1RyYWRlRXJyb3IobXNnLnNlbmRlciwgby5hZGRyLCBvLm1hdGNoSWQsIG8ub3JkZXJIYXNoLCB1aW50MTYoU3RhdHVzLk9SREVSX0JBRF9TSUcpKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgVHJhZGUgbWVtb3J5IHQgPSB0cmFkZUNvcmUoYW1vdW50LCBvKTsKCiAgICAgICAgaWYgKHQuc3RhdHVzICE9IFN0YXR1cy5PSykgewogICAgICAgICAgICBMb2dUcmFkZUVycm9yKG1zZy5zZW5kZXIsIG8uYWRkciwgby5tYXRjaElkLCBvLm9yZGVySGFzaCwgdWludDE2KHQuc3RhdHVzKSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIC8vIE1vZGlmeSBzdG9yYWdlIHRvIHJlZmxlY3QgdHJhZGU6CgogICAgICAgIHZhciBtID0gbWF0Y2hlc1tvLm1hdGNoSWRdOwoKICAgICAgICBpZiAobS5maXJzdFRyYWRlVGltZXN0YW1wID09IDApIHsKICAgICAgICAgICAgYXNzZXJ0KGJsb2NrLnRpbWVzdGFtcCA+IDApOwogICAgICAgICAgICBtLmZpcnN0VHJhZGVUaW1lc3RhbXAgPSB1aW50NjQoYmxvY2sudGltZXN0YW1wKTsKICAgICAgICB9CgogICAgICAgIG0ucG9zaXRpb25zW3QubG9uZ0FkZHJdID0gdC5uZXdMb25nUG9zaXRpb247CiAgICAgICAgbS5wb3NpdGlvbnNbdC5zaG9ydEFkZHJdID0gdC5uZXdTaG9ydFBvc2l0aW9uOwoKICAgICAgICBhZGp1c3RCYWxhbmNlKHQubG9uZ0FkZHIsIHQubG9uZ0JhbGFuY2VEZWx0YSk7CiAgICAgICAgYWRqdXN0QmFsYW5jZSh0LnNob3J0QWRkciwgdC5zaG9ydEJhbGFuY2VEZWx0YSk7CgogICAgICAgIGZpbGxlZEFtb3VudHNbby5vcmRlckhhc2hdICs9IChvLmRpcmVjdGlvbiA9PSAwID8gdC5zaG9ydEFtb3VudCA6IHQubG9uZ0Ftb3VudCk7CgogICAgICAgIExvZ1RyYWRlKG1zZy5zZW5kZXIsIG8uYWRkciwgby5tYXRjaElkLCBvLm9yZGVySGFzaCwgby5kaXJlY3Rpb24sIG8ucHJpY2UsIHQubG9uZ0Ftb3VudCwgdC5uZXdMb25nUG9zaXRpb24sIHQuc2hvcnRBbW91bnQsIHQubmV3U2hvcnRQb3NpdGlvbik7CiAgICB9CgogICAgZnVuY3Rpb24gY2xhaW0odWludCBtYXRjaElkLCB1aW50OCBmaW5hbFByaWNlLCBieXRlczMyIHIsIGJ5dGVzMzIgcywgdWludDggdikgZXh0ZXJuYWwgewogICAgICAgIHZhciBtID0gbWF0Y2hlc1ttYXRjaElkXTsKCiAgICAgICAgaWYgKG0uZmluYWxpemVkKSB7CiAgICAgICAgICAgIHJlcXVpcmUobS5maW5hbFByaWNlID09IGZpbmFsUHJpY2UpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHVpbnQgbWVzc2FnZUhhc2ggPSB1aW50KGtlY2NhazI1Nih0aGlzLCBtYXRjaElkLCBmaW5hbFByaWNlKSk7CiAgICAgICAgICAgIGFkZHJlc3Mgc2lnbmVyID0gZWNyZWNvdmVyKGtlY2NhazI1NigiXHgxOUV0aGVyZXVtIFNpZ25lZCBNZXNzYWdlOlxuMzIiLCBtZXNzYWdlSGFzaCksIHYsIHIsIHMpOwogICAgICAgICAgICByZXF1aXJlKGFkbWluc1tzaWduZXJdKTsKICAgICAgICAgICAgcmVxdWlyZShmaW5hbFByaWNlIDw9IDEwMCk7CgogICAgICAgICAgICBtLmZpbmFsaXplZCA9IHRydWU7CiAgICAgICAgICAgIG0uZmluYWxQcmljZSA9IGZpbmFsUHJpY2U7CiAgICAgICAgICAgIExvZ0ZpbmFsaXplTWF0Y2gobWF0Y2hJZCwgZmluYWxQcmljZSk7CiAgICAgICAgfQoKICAgICAgICAvLyBOT1RFOiBmaW5hbCBwcmljZXMgb3RoZXIgdGhhbiAwIGFuZCAxMDAgbWF5IGxlYXZlIHZlcnkgc21hbGwgYW1vdW50cyBvZiB1bnJlY292ZXJhYmxlIGR1c3QgaW4gdGhlIGNvbnRyYWN0IGR1ZSB0byByb3VuZGluZy4KCiAgICAgICAgaW50IGRlbHRhID0gMDsKICAgICAgICBpbnQgc2VuZGVyUG9zaXRpb24gPSBtLnBvc2l0aW9uc1ttc2cuc2VuZGVyXTsKCiAgICAgICAgaWYgKHNlbmRlclBvc2l0aW9uID4gMCkgewogICAgICAgICAgICBkZWx0YSA9IHByaWNlRGl2aWRlKHNlbmRlclBvc2l0aW9uLCBmaW5hbFByaWNlKTsKICAgICAgICB9IGVsc2UgaWYgKHNlbmRlclBvc2l0aW9uIDwgMCkgewogICAgICAgICAgICBkZWx0YSA9IHByaWNlRGl2aWRlKC1zZW5kZXJQb3NpdGlvbiwgMTAwIC0gZmluYWxQcmljZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgYXNzZXJ0KGRlbHRhID49IDApOwoKICAgICAgICBtLnBvc2l0aW9uc1ttc2cuc2VuZGVyXSA9IDA7CiAgICAgICAgYWRqdXN0QmFsYW5jZShtc2cuc2VuZGVyLCBkZWx0YSk7CgogICAgICAgIExvZ0NsYWltKG1zZy5zZW5kZXIsIG1hdGNoSWQsIHVpbnQoZGVsdGEpKTsKICAgIH0KCiAgICBmdW5jdGlvbiByZWNvdmVyRnVuZHModWludCBtYXRjaElkKSBleHRlcm5hbCB7CiAgICAgICAgdmFyIG0gPSBtYXRjaGVzW21hdGNoSWRdOwoKICAgICAgICBpZiAobS5maW5hbGl6ZWQgfHwgbS5maXJzdFRyYWRlVGltZXN0YW1wID09IDApIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdWludCByZWNvdmVyeVRpbWVzdGFtcCA9IHVpbnQobS5maXJzdFRyYWRlVGltZXN0YW1wKSArICgobWF0Y2hJZCAmIDB4RkYpICogNyAqIDg2NDAwKTsKCiAgICAgICAgaWYgKHVpbnQoYmxvY2sudGltZXN0YW1wKSA+IHJlY292ZXJ5VGltZXN0YW1wKSB7CiAgICAgICAgICAgIHVpbnQ4IGZpbmFsUHJpY2UgPSB1aW50OCgobWF0Y2hJZCAmIDB4RkYwMCkgPj4gOCk7CiAgICAgICAgICAgIHJlcXVpcmUoZmluYWxQcmljZSA8PSAxMDApOwoKICAgICAgICAgICAgbS5maW5hbGl6ZWQgPSB0cnVlOwogICAgICAgICAgICBtLmZpbmFsUHJpY2UgPSBmaW5hbFByaWNlOwogICAgICAgICAgICBMb2dGaW5hbGl6ZU1hdGNoKG1hdGNoSWQsIGZpbmFsUHJpY2UpOwogICAgICAgIH0KICAgIH0KCgogICAgLy8gUHJpdmF0ZSB1dGlsaXRpZXMKCiAgICBmdW5jdGlvbiBhZGp1c3RCYWxhbmNlKGFkZHJlc3MgYWRkciwgaW50IGRlbHRhKSBwcml2YXRlIHsKICAgICAgICB1aW50IG9yaWdBbW91bnQgPSBiYWxhbmNlc1thZGRyXTsKICAgICAgICB1aW50IG5ld0Ftb3VudCA9IGRlbHRhID49IDAgPyBzYWZlQWRkKG9yaWdBbW91bnQsIHVpbnQoZGVsdGEpKSA6IHNhZmVTdWIob3JpZ0Ftb3VudCwgdWludCgtZGVsdGEpKTsKICAgICAgICBiYWxhbmNlc1thZGRyXSA9IG5ld0Ftb3VudDsKCiAgICAgICAgTG9nQmFsYW5jZUNoYW5nZShhZGRyLCBvcmlnQW1vdW50LCBuZXdBbW91bnQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHByaWNlRGl2aWRlKGludCBhbW91bnQsIHVpbnQ4IHByaWNlKSBwcml2YXRlIHB1cmUgcmV0dXJucyhpbnQpIHsKICAgICAgICBhc3NlcnQoYW1vdW50ID49IDApOwogICAgICAgIHJldHVybiBpbnQoc2FmZU11bCh1aW50KGFtb3VudCksIHByaWNlKSAvIDEwMCk7CiAgICB9CgogICAgZnVuY3Rpb24gY29tcHV0ZUVmZmVjdGl2ZUJhbGFuY2UodWludCBiYWxhbmNlLCBpbnQgcG9zaXRpb24sIHVpbnQ4IHByaWNlLCBib29sIGlzTG9uZykgcHJpdmF0ZSBwdXJlIHJldHVybnModWludCkgewogICAgICAgIHVpbnQgZWZmZWN0aXZlQmFsYW5jZSA9IGJhbGFuY2U7CgogICAgICAgIGlmIChpc0xvbmcpIHsKICAgICAgICAgICAgaWYgKHBvc2l0aW9uIDwgMCkgZWZmZWN0aXZlQmFsYW5jZSArPSB1aW50KHByaWNlRGl2aWRlKC1wb3NpdGlvbiwgcHJpY2UpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAocG9zaXRpb24gPiAwKSBlZmZlY3RpdmVCYWxhbmNlICs9IHVpbnQocHJpY2VEaXZpZGUocG9zaXRpb24sIDEwMCAtIHByaWNlKSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZWZmZWN0aXZlQmFsYW5jZTsKICAgIH0KCiAgICBmdW5jdGlvbiBjb21wdXRlUHJpY2VXZWlnaHRlZEFtb3VudHModWludCBsb25nQW1vdW50LCB1aW50IHNob3J0QW1vdW50LCB1aW50IHByaWNlKSBwcml2YXRlIHB1cmUgcmV0dXJucyh1aW50LCB1aW50KSB7CiAgICAgICAgdWludCB0b3RhbExvbmdBbW91bnQ7CiAgICAgICAgdWludCB0b3RhbFNob3J0QW1vdW50OwoKICAgICAgICB0b3RhbExvbmdBbW91bnQgPSBsb25nQW1vdW50ICsgKHNhZmVNdWwobG9uZ0Ftb3VudCwgMTAwIC0gcHJpY2UpIC8gcHJpY2UpOwogICAgICAgIHRvdGFsU2hvcnRBbW91bnQgPSBzaG9ydEFtb3VudCArIChzYWZlTXVsKHNob3J0QW1vdW50LCBwcmljZSkgLyAoMTAwIC0gcHJpY2UpKTsKCiAgICAgICAgaWYgKHRvdGFsTG9uZ0Ftb3VudCA+IHRvdGFsU2hvcnRBbW91bnQpIHsKICAgICAgICAgICAgcmV0dXJuICh0b3RhbFNob3J0QW1vdW50IC0gc2hvcnRBbW91bnQsIHNob3J0QW1vdW50KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gKGxvbmdBbW91bnQsIHRvdGFsTG9uZ0Ftb3VudCAtIGxvbmdBbW91bnQpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBjb21wdXRlRXhwb3N1cmVEZWx0YShpbnQgbG9uZ0JhbGFuY2VEZWx0YSwgaW50IHNob3J0QmFsYW5jZURlbHRhLCBpbnQgb2xkTG9uZ1Bvc2l0aW9uLCBpbnQgbmV3TG9uZ1Bvc2l0aW9uLCBpbnQgb2xkU2hvcnRQb3NpdGlvbiwgaW50IG5ld1Nob3J0UG9zaXRpb24pIHByaXZhdGUgcHVyZSByZXR1cm5zKGludCkgewogICAgICAgIGludCBwb3NpdGlvbkRlbHRhID0gMDsKICAgICAgICBpZiAobmV3TG9uZ1Bvc2l0aW9uID4gMCkgcG9zaXRpb25EZWx0YSArPSBuZXdMb25nUG9zaXRpb24gLSBtYXgyNTYoMCwgb2xkTG9uZ1Bvc2l0aW9uKTsKICAgICAgICBpZiAob2xkU2hvcnRQb3NpdGlvbiA+IDApIHBvc2l0aW9uRGVsdGEgLT0gb2xkU2hvcnRQb3NpdGlvbiAtIG1heDI1NigwLCBuZXdTaG9ydFBvc2l0aW9uKTsKCiAgICAgICAgcmV0dXJuIHBvc2l0aW9uRGVsdGEgKyBsb25nQmFsYW5jZURlbHRhICsgc2hvcnRCYWxhbmNlRGVsdGE7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhZGVDb3JlKHVpbnQgYW1vdW50LCBPcmRlciBtZW1vcnkgbykgcHJpdmF0ZSBjb25zdGFudCByZXR1cm5zKFRyYWRlIHQpIHsKICAgICAgICB2YXIgbSA9IG1hdGNoZXNbby5tYXRjaElkXTsKCiAgICAgICAgaWYgKGJsb2NrLnRpbWVzdGFtcCA+PSBvLmV4cGlyeSkgewogICAgICAgICAgICB0LnN0YXR1cyA9IFN0YXR1cy5PUkRFUl9FWFBJUkVEOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAobS5maW5hbGl6ZWQpIHsKICAgICAgICAgICAgdC5zdGF0dXMgPSBTdGF0dXMuTUFUQ0hfRklOQUxJWkVEOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAobXNnLnNlbmRlciA9PSBvLmFkZHIpIHsKICAgICAgICAgICAgdC5zdGF0dXMgPSBTdGF0dXMuU0VMRl9UUkFERTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKGFtb3VudCA+IE1BWF9TQU5FX0FNT1VOVCkgewogICAgICAgICAgICB0LnN0YXR1cyA9IFN0YXR1cy5BTU9VTlRfTUFMRk9STUVEOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB0LnN0YXR1cyA9IFN0YXR1cy5PSzsKCgogICAgICAgIHVpbnQgbG9uZ0Ftb3VudDsKICAgICAgICB1aW50IHNob3J0QW1vdW50OwoKICAgICAgICBpZiAoby5kaXJlY3Rpb24gPT0gMCkgewogICAgICAgICAgICAvLyBtYWtlciBzaG9ydCwgdGFrZXIgbG9uZwogICAgICAgICAgICB0LmxvbmdBZGRyID0gbXNnLnNlbmRlcjsKICAgICAgICAgICAgbG9uZ0Ftb3VudCA9IGFtb3VudDsKCiAgICAgICAgICAgIHQuc2hvcnRBZGRyID0gby5hZGRyOwogICAgICAgICAgICBzaG9ydEFtb3VudCA9IHNhZmVTdWIoby5hbW91bnQsIGZpbGxlZEFtb3VudHNbby5vcmRlckhhc2hdKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBtYWtlciBsb25nLCB0YWtlciBzaG9ydCAKICAgICAgICAgICAgdC5sb25nQWRkciA9IG8uYWRkcjsKICAgICAgICAgICAgbG9uZ0Ftb3VudCA9IHNhZmVTdWIoby5hbW91bnQsIGZpbGxlZEFtb3VudHNbby5vcmRlckhhc2hdKTsKCiAgICAgICAgICAgIHQuc2hvcnRBZGRyID0gbXNnLnNlbmRlcjsKICAgICAgICAgICAgc2hvcnRBbW91bnQgPSBhbW91bnQ7CiAgICAgICAgfQoKICAgICAgICBpbnQgb2xkTG9uZ1Bvc2l0aW9uID0gbS5wb3NpdGlvbnNbdC5sb25nQWRkcl07CiAgICAgICAgaW50IG9sZFNob3J0UG9zaXRpb24gPSBtLnBvc2l0aW9uc1t0LnNob3J0QWRkcl07CgogICAgICAgIGxvbmdBbW91bnQgPSBtaW51MjU2KGxvbmdBbW91bnQsIGNvbXB1dGVFZmZlY3RpdmVCYWxhbmNlKGJhbGFuY2VzW3QubG9uZ0FkZHJdLCBvbGRMb25nUG9zaXRpb24sIG8ucHJpY2UsIHRydWUpKTsKICAgICAgICBzaG9ydEFtb3VudCA9IG1pbnUyNTYoc2hvcnRBbW91bnQsIGNvbXB1dGVFZmZlY3RpdmVCYWxhbmNlKGJhbGFuY2VzW3Quc2hvcnRBZGRyXSwgb2xkU2hvcnRQb3NpdGlvbiwgby5wcmljZSwgZmFsc2UpKTsKCiAgICAgICAgKGxvbmdBbW91bnQsIHNob3J0QW1vdW50KSA9IGNvbXB1dGVQcmljZVdlaWdodGVkQW1vdW50cyhsb25nQW1vdW50LCBzaG9ydEFtb3VudCwgby5wcmljZSk7CgogICAgICAgIGlmIChsb25nQW1vdW50ID09IDAgfHwgc2hvcnRBbW91bnQgPT0gMCkgewogICAgICAgICAgICB0LnN0YXR1cyA9IFN0YXR1cy5aRVJPX1ZBTFVFX1RSQURFOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKCiAgICAgICAgaW50IG5ld0xvbmdQb3NpdGlvbiA9IG9sZExvbmdQb3NpdGlvbiArIChpbnQobG9uZ0Ftb3VudCkgKyBpbnQoc2hvcnRBbW91bnQpKTsKICAgICAgICBpbnQgbmV3U2hvcnRQb3NpdGlvbiA9IG9sZFNob3J0UG9zaXRpb24gLSAoaW50KGxvbmdBbW91bnQpICsgaW50KHNob3J0QW1vdW50KSk7CgoKICAgICAgICB0LmxvbmdCYWxhbmNlRGVsdGEgPSAwOwogICAgICAgIHQuc2hvcnRCYWxhbmNlRGVsdGEgPSAwOwoKICAgICAgICBpZiAob2xkTG9uZ1Bvc2l0aW9uIDwgMCkgdC5sb25nQmFsYW5jZURlbHRhICs9IHByaWNlRGl2aWRlKC1vbGRMb25nUG9zaXRpb24gKyBtaW4yNTYoMCwgbmV3TG9uZ1Bvc2l0aW9uKSwgMTAwIC0gby5wcmljZSk7CiAgICAgICAgaWYgKG5ld0xvbmdQb3NpdGlvbiA+IDApIHQubG9uZ0JhbGFuY2VEZWx0YSAtPSBwcmljZURpdmlkZShuZXdMb25nUG9zaXRpb24gLSBtYXgyNTYoMCwgb2xkTG9uZ1Bvc2l0aW9uKSwgby5wcmljZSk7CgogICAgICAgIGlmIChvbGRTaG9ydFBvc2l0aW9uID4gMCkgdC5zaG9ydEJhbGFuY2VEZWx0YSArPSBwcmljZURpdmlkZShvbGRTaG9ydFBvc2l0aW9uIC0gbWF4MjU2KDAsIG5ld1Nob3J0UG9zaXRpb24pLCBvLnByaWNlKTsKICAgICAgICBpZiAobmV3U2hvcnRQb3NpdGlvbiA8IDApIHQuc2hvcnRCYWxhbmNlRGVsdGEgLT0gcHJpY2VEaXZpZGUoLW5ld1Nob3J0UG9zaXRpb24gKyBtaW4yNTYoMCwgb2xkU2hvcnRQb3NpdGlvbiksIDEwMCAtIG8ucHJpY2UpOwoKICAgICAgICBpbnQgZXhwb3N1cmVEZWx0YSA9IGNvbXB1dGVFeHBvc3VyZURlbHRhKHQubG9uZ0JhbGFuY2VEZWx0YSwgdC5zaG9ydEJhbGFuY2VEZWx0YSwgb2xkTG9uZ1Bvc2l0aW9uLCBuZXdMb25nUG9zaXRpb24sIG9sZFNob3J0UG9zaXRpb24sIG5ld1Nob3J0UG9zaXRpb24pOwoKICAgICAgICBpZiAoZXhwb3N1cmVEZWx0YSAhPSAwKSB7CiAgICAgICAgICAgIGlmIChleHBvc3VyZURlbHRhID09IDEpIHsKICAgICAgICAgICAgICAgIG5ld0xvbmdQb3NpdGlvbi0tOwogICAgICAgICAgICAgICAgbmV3U2hvcnRQb3NpdGlvbisrOwogICAgICAgICAgICB9IGVsc2UgaWYgKGV4cG9zdXJlRGVsdGEgPT0gLTEpIHsKICAgICAgICAgICAgICAgIHQubG9uZ0JhbGFuY2VEZWx0YSsrOyAvLyBvbmUgbGVmdC1vdmVyIHdlaTogYXJiaXRyYXJpbHkgZ2l2ZSBpdCB0byBsb25nCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBhc3NlcnQoZmFsc2UpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBleHBvc3VyZURlbHRhID0gY29tcHV0ZUV4cG9zdXJlRGVsdGEodC5sb25nQmFsYW5jZURlbHRhLCB0LnNob3J0QmFsYW5jZURlbHRhLCBvbGRMb25nUG9zaXRpb24sIG5ld0xvbmdQb3NpdGlvbiwgb2xkU2hvcnRQb3NpdGlvbiwgbmV3U2hvcnRQb3NpdGlvbik7CiAgICAgICAgICAgIGFzc2VydChleHBvc3VyZURlbHRhID09IDApOwogICAgICAgIH0KCgogICAgICAgIHQubmV3TG9uZ1Bvc2l0aW9uID0gbmV3TG9uZ1Bvc2l0aW9uOwogICAgICAgIHQubmV3U2hvcnRQb3NpdGlvbiA9IG5ld1Nob3J0UG9zaXRpb247CiAgICAgICAgdC5zaG9ydEFtb3VudCA9IHNob3J0QW1vdW50OwogICAgICAgIHQubG9uZ0Ftb3VudCA9IGxvbmdBbW91bnQ7CiAgICB9CgoKICAgIC8vIEV4dGVybmFsIHZpZXdzCgogICAgZnVuY3Rpb24gZ2V0T3duZXIoKSBleHRlcm5hbCB2aWV3IHJldHVybnMoYWRkcmVzcykgewogICAgICAgIHJldHVybiBvd25lcjsKICAgIH0KCiAgICBmdW5jdGlvbiBpc0FkbWluKGFkZHJlc3MgYWRkcikgZXh0ZXJuYWwgdmlldyByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXR1cm4gYWRtaW5zW2FkZHJdOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEJhbGFuY2UoYWRkcmVzcyBhZGRyKSBleHRlcm5hbCB2aWV3IHJldHVybnModWludCkgewogICAgICAgIHJldHVybiBiYWxhbmNlc1thZGRyXTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRNYXRjaEluZm8odWludCBtYXRjaElkKSBleHRlcm5hbCB2aWV3IHJldHVybnModWludDY0LCBib29sLCB1aW50OCkgewogICAgICAgIHZhciBtID0gbWF0Y2hlc1ttYXRjaElkXTsKICAgICAgICByZXR1cm4gKG0uZmlyc3RUcmFkZVRpbWVzdGFtcCwgbS5maW5hbGl6ZWQsIG0uZmluYWxQcmljZSk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0UG9zaXRpb24odWludCBtYXRjaElkLCBhZGRyZXNzIGFkZHIpIGV4dGVybmFsIHZpZXcgcmV0dXJucyhpbnQpIHsKICAgICAgICByZXR1cm4gbWF0Y2hlc1ttYXRjaElkXS5wb3NpdGlvbnNbYWRkcl07CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RmlsbGVkQW1vdW50KHVpbnQgb3JkZXJIYXNoKSBleHRlcm5hbCB2aWV3IHJldHVybnModWludCkgewogICAgICAgIHJldHVybiBmaWxsZWRBbW91bnRzW29yZGVySGFzaF07CiAgICB9CgogICAgZnVuY3Rpb24gY2hlY2tNYXRjaEJhdGNoKGFkZHJlc3MgbXlBZGRyLCB1aW50WzE2XSBtYXRjaElkcykgZXh0ZXJuYWwgdmlldyByZXR1cm5zKGludFsxNl0gbXlQb3NpdGlvbiwgYm9vbFsxNl0gZmluYWxpemVkLCB1aW50OFsxNl0gZmluYWxQcmljZSkgewogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IDE2OyBpKyspIHsKICAgICAgICAgICAgaWYgKG1hdGNoSWRzW2ldID09IDApIGJyZWFrOwoKICAgICAgICAgICAgdmFyIG0gPSBtYXRjaGVzW21hdGNoSWRzW2ldXTsKCiAgICAgICAgICAgIG15UG9zaXRpb25baV0gPSBtLnBvc2l0aW9uc1tteUFkZHJdOwogICAgICAgICAgICBmaW5hbGl6ZWRbaV0gPSBtLmZpbmFsaXplZDsKICAgICAgICAgICAgZmluYWxQcmljZVtpXSA9IG0uZmluYWxQcmljZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gY2hlY2tPcmRlckJhdGNoKHVpbnRbNDhdIGlucHV0KSBleHRlcm5hbCB2aWV3IHJldHVybnModWludDE2WzE2XSBzdGF0dXMsIHVpbnRbMTZdIGFtb3VudCkgewogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IDE2OyBpKyspIHsKICAgICAgICAgICAgdWludFszXSBtZW1vcnkgcmF3T3JkZXI7CiAgICAgICAgICAgIHJhd09yZGVyWzBdID0gaW5wdXRbKGkqMyldOwogICAgICAgICAgICByYXdPcmRlclsxXSA9IGlucHV0WyhpKjMpICsgMV07CiAgICAgICAgICAgIHJhd09yZGVyWzJdID0gaW5wdXRbKGkqMykgKyAyXTsKCiAgICAgICAgICAgIGlmIChyYXdPcmRlclswXSA9PSAwKSBicmVhazsKCiAgICAgICAgICAgIE9yZGVyIG1lbW9yeSBvID0gcGFyc2VPcmRlcihyYXdPcmRlcik7CgogICAgICAgICAgICBpZiAoIXZhbGlkYXRlT3JkZXJQYXJhbXMobykpIHsKICAgICAgICAgICAgICAgIHN0YXR1c1tpXSA9IHVpbnQxNihTdGF0dXMuT1JERVJfTUFMRk9STUVEKTsKICAgICAgICAgICAgICAgIGFtb3VudFtpXSA9IDA7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gTm90IHZhbGlkYXRpbmcgb3JkZXIgc2lnbmF0dXJlcyBvciB0aW1lc3RhbXBzOiBzaG91bGQgYmUgZG9uZSBieSBjbGllbnRzCgogICAgICAgICAgICB2YXIgbSA9IG1hdGNoZXNbby5tYXRjaElkXTsKCiAgICAgICAgICAgIGlmIChtLmZpbmFsaXplZCkgewogICAgICAgICAgICAgICAgc3RhdHVzW2ldID0gdWludDE2KFN0YXR1cy5NQVRDSF9GSU5BTElaRUQpOwogICAgICAgICAgICAgICAgYW1vdW50W2ldID0gMDsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICB1aW50IGxvbmdBbW91bnQ7CiAgICAgICAgICAgIHVpbnQgc2hvcnRBbW91bnQ7CgogICAgICAgICAgICBpZiAoby5kaXJlY3Rpb24gPT0gMCkgewogICAgICAgICAgICAgICAgc2hvcnRBbW91bnQgPSBzYWZlU3ViKG8uYW1vdW50LCBmaWxsZWRBbW91bnRzW28ub3JkZXJIYXNoXSk7CiAgICAgICAgICAgICAgICBsb25nQW1vdW50ID0gc2FmZU11bChzaG9ydEFtb3VudCwgMTAwKTsKICAgICAgICAgICAgICAgIHNob3J0QW1vdW50ID0gbWludTI1NihzaG9ydEFtb3VudCwgY29tcHV0ZUVmZmVjdGl2ZUJhbGFuY2UoYmFsYW5jZXNbby5hZGRyXSwgbS5wb3NpdGlvbnNbby5hZGRyXSwgby5wcmljZSwgZmFsc2UpKTsKICAgICAgICAgICAgICAgIChsb25nQW1vdW50LCBzaG9ydEFtb3VudCkgPSBjb21wdXRlUHJpY2VXZWlnaHRlZEFtb3VudHMobG9uZ0Ftb3VudCwgc2hvcnRBbW91bnQsIG8ucHJpY2UpOwogICAgICAgICAgICAgICAgc3RhdHVzW2ldID0gdWludDE2KFN0YXR1cy5PSyk7CiAgICAgICAgICAgICAgICBhbW91bnRbaV0gPSBzaG9ydEFtb3VudDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGxvbmdBbW91bnQgPSBzYWZlU3ViKG8uYW1vdW50LCBmaWxsZWRBbW91bnRzW28ub3JkZXJIYXNoXSk7CiAgICAgICAgICAgICAgICBzaG9ydEFtb3VudCA9IHNhZmVNdWwobG9uZ0Ftb3VudCwgMTAwKTsKICAgICAgICAgICAgICAgIGxvbmdBbW91bnQgPSBtaW51MjU2KGxvbmdBbW91bnQsIGNvbXB1dGVFZmZlY3RpdmVCYWxhbmNlKGJhbGFuY2VzW28uYWRkcl0sIG0ucG9zaXRpb25zW28uYWRkcl0sIG8ucHJpY2UsIHRydWUpKTsKICAgICAgICAgICAgICAgIChsb25nQW1vdW50LCBzaG9ydEFtb3VudCkgPSBjb21wdXRlUHJpY2VXZWlnaHRlZEFtb3VudHMobG9uZ0Ftb3VudCwgc2hvcnRBbW91bnQsIG8ucHJpY2UpOwogICAgICAgICAgICAgICAgc3RhdHVzW2ldID0gdWludDE2KFN0YXR1cy5PSyk7CiAgICAgICAgICAgICAgICBhbW91bnRbaV0gPSBsb25nQW1vdW50OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKCiAgICAvLyBNYXRoIHV0aWxpdGllcwoKICAgIGZ1bmN0aW9uIHNhZmVNdWwodWludCBhLCB1aW50IGIpIHByaXZhdGUgcHVyZSByZXR1cm5zKHVpbnQpIHsKICAgICAgICB1aW50IGMgPSBhICogYjsKICAgICAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIHNhZmVTdWIodWludCBhLCB1aW50IGIpIHByaXZhdGUgcHVyZSByZXR1cm5zKHVpbnQpIHsKICAgICAgICBhc3NlcnQoYiA8PSBhKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgZnVuY3Rpb24gc2FmZUFkZCh1aW50IGEsIHVpbnQgYikgcHJpdmF0ZSBwdXJlIHJldHVybnModWludCkgewogICAgICAgIHVpbnQgYyA9IGEgKyBiOwogICAgICAgIGFzc2VydChjID49IGEgJiYgYyA+PSBiKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICBmdW5jdGlvbiBtaW51MjU2KHVpbnQgYSwgdWludCBiKSBwcml2YXRlIHB1cmUgcmV0dXJucyh1aW50KSB7CiAgICAgICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7CiAgICB9CgogICAgZnVuY3Rpb24gbWF4MjU2KGludCBhLCBpbnQgYikgcHJpdmF0ZSBwdXJlIHJldHVybnMoaW50KSB7CiAgICAgICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOwogICAgfQoKICAgIGZ1bmN0aW9uIG1pbjI1NihpbnQgYSwgaW50IGIpIHByaXZhdGUgcHVyZSByZXR1cm5zKGludCkgewogICAgICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOwogICAgfQp9'.
	

]
