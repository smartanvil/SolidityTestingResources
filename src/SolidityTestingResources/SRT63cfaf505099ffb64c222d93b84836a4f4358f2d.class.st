Class {
	#name : #SRT63cfaf505099ffb64c222d93b84836a4f4358f2d,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT63cfaf505099ffb64c222d93b84836a4f4358f2d >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjE7CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CglhZGRyZXNzIHB1YmxpYyBvd25lcjsKCgkvKioKICAgICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAgICogYWNjb3VudC4KICAgICAqLwoJZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CgkJb3duZXIgPSB0eC5vcmlnaW47Cgl9CgoKCS8qKgogICAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAgICovCgltb2RpZmllciBvbmx5T3duZXIoKSB7CgkJcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKCQlfOwoJfQoKCiAgICAvKioKICAgICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICAgKgogICAgICogQHBhcmFtIF9uZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICAgKi8KCWZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgX25ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKCQlyZXF1aXJlKF9uZXdPd25lciAhPSBhZGRyZXNzKDApKTsKCQlvd25lciA9IF9uZXdPd25lcjsKCX0KfQoKCgoKCgoKCi8qKgogKiBAdGl0bGUgQmFzaWNFUkMyMCB0b2tlbi4KICogQGRldiBCYXNpYyB2ZXJzaW9uIG9mIEVSQzIwIHRva2VuIHdpdGggYWxsb3dhbmNlcy4KICovCmNvbnRyYWN0IEJhc2ljRVJDMjBUb2tlbiBpcyBPd25hYmxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGFtb3VudCk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IGFtb3VudCk7CgoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyBmb3IgYWRkcmVzcy4KICAgICAqCiAgICAgKiBAcGFyYW0gX293bmVyIEFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgdG9rZW5zLgogICAgICogCiAgICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIHRvIHRoZSBvd25lci4KICAgICAqLwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KCgogICAgLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSB0b3RhbCBzdXBwbHkgb2YgdG9rZW5zLgogICAgICoKICAgICAqIEByZXR1cm4gVGhlIHVpbnQyNTYgc3BlY2lmaW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHdoaWNoIGFyZSBoZWxkIGJ5IHRoZSBjb250cmFjdC4KICAgICAqLwogICAgZnVuY3Rpb24gZ2V0VG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHRvdGFsU3VwcGx5OwogICAgfQoKCiAgICAvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgICAqCiAgICAgKiBAcGFyYW0gX293bmVyIEFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgQWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgICAqCiAgICAgKiBAcmV0dXJuIFRoZSB1aW50MjU2IHNwZWNpZmluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAgICovCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgICB9CgoKICAgIC8qKgogICAgICogQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byB0cmFuc2ZlciB0b2tlbnMuCiAgICAgKgogICAgICogQHBhcmFtIF9mcm9tIEFkZHJlc3Mgb2YgdGhlIHNlbmRlci4KICAgICAqIEBwYXJhbSBfdG8gQWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50LgogICAgICogQHBhcmFtIF9hbW91bnQgQW1vdW50IHRvIHNlbmQuCiAgICAgKgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICAgKi8KICAgIGZ1bmN0aW9uIF90cmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZSAoX2Zyb20gIT0gMHgwKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUHJldmVudCB0cmFuc2ZlciB0byAweDAgYWRkcmVzcwogICAgICAgIHJlcXVpcmUgKF90byAhPSAweDApOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQcmV2ZW50IHRyYW5zZmVyIHRvIDB4MCBhZGRyZXNzCiAgICAgICAgcmVxdWlyZSAoYmFsYW5jZXNbX2Zyb21dID49IF9hbW91bnQpOyAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgc2VuZGVyIGhhcyBlbm91Z2ggdG9rZW5zCiAgICAgICAgcmVxdWlyZSAoYmFsYW5jZXNbX3RvXSArIF9hbW91bnQgPiBiYWxhbmNlc1tfdG9dKTsgIC8vIENoZWNrIGZvciBvdmVyZmxvd3MKCiAgICAgICAgdWludDI1NiBsZW5ndGg7CiAgICAgICAgYXNzZW1ibHkgewogICAgICAgICAgICBsZW5ndGggOj0gZXh0Y29kZXNpemUoX3RvKQogICAgICAgIH0KICAgICAgICByZXF1aXJlIChsZW5ndGggPT0gMCk7CgogICAgICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX2Ftb3VudCk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF9hbW91bnQpOwoKICAgICAgICBlbWl0IFRyYW5zZmVyKF9mcm9tLCBfdG8sIF9hbW91bnQpOwogICAgICAgIAogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKCiAgICAvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gdHJhbnNmZXIgdG9rZW5zLgogICAgICoKICAgICAqIEBwYXJhbSBfdG8gQWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50LgogICAgICogQHBhcmFtIF9hbW91bnQgQW1vdW50IHRvIHNlbmQuCiAgICAgKgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgX3RyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX2Ftb3VudCk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKCiAgICAvKioKICAgICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb3RoZXIgYWRkcmVzcy4KICAgICAqCiAgICAgKiBAcGFyYW0gX2Zyb20gQWRkcmVzcyBvZiB0aGUgc2VuZGVyLgogICAgICogQHBhcmFtIF90byBBZGRyZXNzIG9mIHRoZSByZWNpcGllbnQuCiAgICAgKiBAcGFyYW0gX2Ftb3VudCBBbW91bnQgdG8gc2VuZC4KICAgICAqCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZSAoYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPj0gX2Ftb3VudCk7ICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBzZW5kZXIgaGFzIGVub3VnaAoKICAgICAgICBfdHJhbnNmZXIoX2Zyb20sIF90bywgX2Ftb3VudCk7CgogICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF9hbW91bnQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKCiAgICAvKioKICAgICAqIEBkZXYgQXByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICAgKiAKICAgICAqIEBwYXJhbSBfc3BlbmRlciBBZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF9hbW91bnQgQW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgICAqCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZSAoX3NwZW5kZXIgIT0gMHgwKTsgICAgICAgICAgICAgICAgICAgICAgIC8vIFByZXZlbnQgdHJhbnNmZXIgdG8gMHgwIGFkZHJlc3MKICAgICAgICByZXF1aXJlIChfYW1vdW50ID49IDApOwogICAgICAgIHJlcXVpcmUgKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IF9hbW91bnQpOyAgICAgICAvLyBDaGVjayBpZiB0aGUgbXNnLnNlbmRlciBoYXMgZW5vdWdoIHRvIGFsbG93IAoKICAgICAgICBpZiAoX2Ftb3VudCA9PSAwKSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF9hbW91bnQ7CiAgICAgICAgZWxzZSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYW1vdW50KTsKCiAgICAgICAgZW1pdCBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX2Ftb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0KCi8qKgogKiBAdGl0bGUgUFVMUyB0b2tlbgogKiBAZGV2IEV4dGVuZHMgRVJDMjAgdG9rZW4uCiAqLwpjb250cmFjdCBQVUxTVG9rZW4gaXMgQmFzaWNFUkMyMFRva2VuIHsKCS8vIFB1YmxpYyB2YXJpYWJsZXMgb2YgdGhlIHRva2VuCglzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAnUFVMUyBUb2tlbic7CglzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICdQVUxTJzsKCXVpbnQyNTYgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7Cgl1aW50MjU2IHB1YmxpYyBjb25zdGFudCBJTklUSUFMX1NVUFBMWSA9IDg4ODg4ODg4MDAwMDAwMDAwMDAwMDAwMDAwOwoKCWFkZHJlc3MgcHVibGljIGNyb3dkc2FsZUFkZHJlc3M7CgoJLy8gUHVibGljIHN0cnVjdHVyZSB0byBzdXBwb3J0IHRva2VuIHJlc2VydmF0aW9uLgoJc3RydWN0IFJlc2VydmUgewogICAgICAgIHVpbnQyNTYgcHVsc0Ftb3VudDsKICAgICAgICB1aW50MjU2IGNvbGxlY3RlZEV0aGVyOwogICAgfQoKCW1hcHBpbmcgKGFkZHJlc3MgPT4gUmVzZXJ2ZSkgcmVzZXJ2ZWQ7CgoJLy8gUHVibGljIHN0cnVjdHVyZSB0byByZWNvcmQgbG9ja2VkIHRva2VucyBmb3IgYSBzcGVjaWZpYyBsb2NrLgoJc3RydWN0IExvY2sgewoJCXVpbnQyNTYgYW1vdW50OwoJCXVpbnQyNTYgc3RhcnRUaW1lOwkvLyBpbiBzZWNvbmRzIHNpbmNlIDAxLjAxLjE5NzAKCQl1aW50MjU2IHRpbWVUb0xvY2s7IC8vIGluIHNlY29uZHMKCQlieXRlczMyIHB1bHNlTG9ja0hhc2g7Cgl9CgkKCS8vIFB1YmxpYyBsaXN0IG9mIGxvY2tlZCB0b2tlbnMgZm9yIGEgc3BlY2lmaWMgYWRkcmVzcy4KCXN0cnVjdCBsb2NrTGlzdHsKCQlMb2NrW10gbG9ja2VkVG9rZW5zOwoJfQoJCgkvLyBQdWJsaWMgbGlzdCBvZiBsb2NrTGlzdHMuCgltYXBwaW5nIChhZGRyZXNzID0+IGxvY2tMaXN0KSBhZGRyZXNzTG9ja3M7CgoJLyoqCiAgICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgY3Jvd2RzYWxlIGFkZHJlc3MuCiAgICAgKi8KCW1vZGlmaWVyIG9ubHlDcm93ZHNhbGVBZGRyZXNzKCkgewoJCXJlcXVpcmUobXNnLnNlbmRlciA9PSBjcm93ZHNhbGVBZGRyZXNzKTsKCQlfOwoJfQoKCWV2ZW50IFRva2VuUmVzZXJ2YXRpb24oYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHNlbmRFdGhlciwgdWludDI1NiBpbmRleGVkIHB1bHNBbW91bnQsIHVpbnQyNTYgcmVzZXJ2ZVR5cGVJZCk7CglldmVudCBSZXZlcnRpbmdSZXNlcnZhdGlvbihhZGRyZXNzIGluZGV4ZWQgYWRkcmVzc1RvUmV2ZXJ0KTsKCWV2ZW50IFRva2VuTG9ja2luZyhhZGRyZXNzIGluZGV4ZWQgYWRkcmVzc1RvTG9jaywgdWludDI1NiBpbmRleGVkIGFtb3VudCwgdWludDI1NiB0aW1lVG9Mb2NrKTsKCWV2ZW50IFRva2VuVW5sb2NraW5nKGFkZHJlc3MgaW5kZXhlZCBhZGRyZXNzVG9VbmxvY2ssIHVpbnQyNTYgaW5kZXhlZCBhbW91bnQpOwoKCgkvKioKICAgICAqIEBkZXYgVGhlIFBVTFMgdG9rZW4gY29uc3RydWN0b3Igc2V0cyB0aGUgaW5pdGlhbCBzdXBwbHkgb2YgdG9rZW5zIHRvIHRoZSBjcm93ZHNhbGUgYWRkcmVzcwogICAgICogYWNjb3VudC4KICAgICAqLwoJZnVuY3Rpb24gUFVMU1Rva2VuKCkgcHVibGljIHsKCQl0b3RhbFN1cHBseSA9IElOSVRJQUxfU1VQUExZOwoJCWJhbGFuY2VzW21zZy5zZW5kZXJdID0gSU5JVElBTF9TVVBQTFk7CgkJCgkJY3Jvd2RzYWxlQWRkcmVzcyA9IG1zZy5zZW5kZXI7CgoJCWVtaXQgVHJhbnNmZXIoMHgwLCBtc2cuc2VuZGVyLCBJTklUSUFMX1NVUFBMWSk7Cgl9CgoKCS8qKgogICAgICogQGRldiBQYXlhYmxlIGZ1bmN0aW9uLgogICAgICovCglmdW5jdGlvbiAoKSBleHRlcm5hbCBwYXlhYmxlIHsKCX0KCgoJLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHJlc2VydmVkIGFtb3VudCBvZiB0b2tlbnMgZm9yIGFkZHJlc3MuCiAgICAgKgogICAgICogQHBhcmFtIF9vd25lciBBZGRyZXNzIG9mIG93bmVyIG9mIHRoZSB0b2tlbnMuCiAgICAgKgogICAgICogQHJldHVybiBUaGUgdWludDI1NiBzcGVjaWZpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgd2hpY2ggYXJlIGhlbGQgaW4gcmVzZXJ2ZSBmb3IgdGhpcyBhZGRyZXNzLgogICAgICovCglmdW5jdGlvbiByZXNlcnZlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKCQlyZXR1cm4gcmVzZXJ2ZWRbX293bmVyXS5wdWxzQW1vdW50OwoJfQoKCgkvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgcmVzZXJ2ZWQgYW1vdW50IG9mIHRva2VucyBmb3IgYWRkcmVzcy4KICAgICAqCiAgICAgKiBAcGFyYW0gX2J1eWVyIEFkZHJlc3Mgb2YgYnV5ZXIgb2YgdGhlIHRva2Vucy4KICAgICAqCiAgICAgKiBAcmV0dXJuIFRoZSB1aW50MjU2IHNwZWNpZmluZyB0aGUgYW1vdW50IG9mIHRva2VucyB3aGljaCBhcmUgaGVsZCBpbiByZXNlcnZlIGZvciB0aGlzIGFkZHJlc3MuCiAgICAgKi8KCWZ1bmN0aW9uIGNvbGxlY3RlZEV0aGVyRnJvbShhZGRyZXNzIF9idXllcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewoJCXJldHVybiByZXNlcnZlZFtfYnV5ZXJdLmNvbGxlY3RlZEV0aGVyOwoJfQoKCgkvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gZ2V0IG51bWJlciBvZiBsb2NrcyBmb3IgYW4gYWRkcmVzcy4KICAgICAqCiAgICAgKiBAcGFyYW0gX2FkZHJlc3MgQWRkcmVzcyB3aG8gb3ducyBsb2NrZWQgdG9rZW5zLgogICAgICoKICAgICAqIEByZXR1cm4gVGhlIHVpbnQyNTYgbGVuZ3RoIG9mIGFycmF5LgogICAgICovCglmdW5jdGlvbiBnZXRBZGRyZXNzTG9ja2VkTGVuZ3RoKGFkZHJlc3MgX2FkZHJlc3MpIHB1YmxpYyB2aWV3IHJldHVybnModWludDI1NiBsZW5ndGgpIHsKCSAgICByZXR1cm4gYWRkcmVzc0xvY2tzW19hZGRyZXNzXS5sb2NrZWRUb2tlbnMubGVuZ3RoOwoJfQoKCgkvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gZ2V0IGxvY2tlZCB0b2tlbnMgYW1vdW50IGZvciBzcGVjaWZpYyBhZGRyZXNzIGZvciBzcGVjaWZpYyBsb2NrLgogICAgICoKICAgICAqIEBwYXJhbSBfYWRkcmVzcyBBZGRyZXNzIG9mIG93bmVyIG9mIGxvY2tlZCB0b2tlbnMuCiAgICAgKiBAcGFyYW0gX2luZGV4IEluZGV4IG9mIHNwZWNpZmljIGxvY2suCiAgICAgKgogICAgICogQHJldHVybiBUaGUgdWludDI1NiBzcGVjaWZpbmcgdGhlIGFtb3VudCBvZiBsb2NrZWQgdG9rZW5zLgogICAgICovCglmdW5jdGlvbiBnZXRMb2NrZWRTdHJ1Y3RBbW91bnQoYWRkcmVzcyBfYWRkcmVzcywgdWludDI1NiBfaW5kZXgpIHB1YmxpYyB2aWV3IHJldHVybnModWludDI1NiBhbW91bnQpIHsKCSAgICByZXR1cm4gYWRkcmVzc0xvY2tzW19hZGRyZXNzXS5sb2NrZWRUb2tlbnNbX2luZGV4XS5hbW91bnQ7Cgl9CgoKCS8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBnZXQgc3RhcnQgdGltZSBvZiBsb2NrIGZvciBzcGVjaWZpYyBhZGRyZXNzLgogICAgICoKICAgICAqIEBwYXJhbSBfYWRkcmVzcyBBZGRyZXNzIG9mIG93bmVyIG9mIGxvY2tlZCB0b2tlbnMuCiAgICAgKiBAcGFyYW0gX2luZGV4IEluZGV4IG9mIHNwZWNpZmljIGxvY2suCiAgICAgKgogICAgICogQHJldHVybiBUaGUgdWludDI1NiBzcGVjaWZpbmcgdGhlIHN0YXJ0IHRpbWUgb2YgbG9jayBpbiBzZWNvbmRzLgogICAgICovCglmdW5jdGlvbiBnZXRMb2NrZWRTdHJ1Y3RTdGFydFRpbWUoYWRkcmVzcyBfYWRkcmVzcywgdWludDI1NiBfaW5kZXgpIHB1YmxpYyB2aWV3IHJldHVybnModWludDI1NiBzdGFydFRpbWUpIHsKCSAgICByZXR1cm4gYWRkcmVzc0xvY2tzW19hZGRyZXNzXS5sb2NrZWRUb2tlbnNbX2luZGV4XS5zdGFydFRpbWU7Cgl9CgoKCS8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBnZXQgZHVyYXRpb24gdGltZSBvZiBsb2NrIGZvciBzcGVjaWZpYyBhZGRyZXNzLgogICAgICoKICAgICAqIEBwYXJhbSBfYWRkcmVzcyBBZGRyZXNzIG9mIG93bmVyIG9mIGxvY2tlZCB0b2tlbnMuCiAgICAgKiBAcGFyYW0gX2luZGV4IEluZGV4IG9mIHNwZWNpZmljIGxvY2suCiAgICAgKgogICAgICogQHJldHVybiBUaGUgdWludDI1NiBzcGVjaWZpbmcgdGhlIGR1cmF0aW9uIHRpbWUgb2YgbG9jayBpbiBzZWNvbmRzLgogICAgICovCglmdW5jdGlvbiBnZXRMb2NrZWRTdHJ1Y3RUaW1lVG9Mb2NrKGFkZHJlc3MgX2FkZHJlc3MsIHVpbnQyNTYgX2luZGV4KSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnQyNTYgdGltZVRvTG9jaykgewoJICAgIHJldHVybiBhZGRyZXNzTG9ja3NbX2FkZHJlc3NdLmxvY2tlZFRva2Vuc1tfaW5kZXhdLnRpbWVUb0xvY2s7Cgl9CgoJCgkvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gZ2V0IHB1bHNlIGhhc2ggZm9yIHNwZWNpZmljIGFkZHJlc3MgZm9yIHNwZWNpZmljIGxvY2suCiAgICAgKgogICAgICogQHBhcmFtIF9hZGRyZXNzIEFkZHJlc3Mgb2Ygb3duZXIgb2YgbG9ja2VkIHRva2Vucy4KICAgICAqIEBwYXJhbSBfaW5kZXggSW5kZXggb2Ygc3BlY2lmaWMgbG9jay4KICAgICAqCiAgICAgKiBAcmV0dXJuIFRoZSBieXRlczMyIHNwZWNpZmluZyB0aGUgcHVsc2UgaGFzaC4KICAgICAqLwoJZnVuY3Rpb24gZ2V0TG9ja2VkU3RydWN0UHVsc2VMb2NrSGFzaChhZGRyZXNzIF9hZGRyZXNzLCB1aW50MjU2IF9pbmRleCkgcHVibGljIHZpZXcgcmV0dXJucyhieXRlczMyIHB1bHNlTG9ja0hhc2gpIHsKCSAgICByZXR1cm4gYWRkcmVzc0xvY2tzW19hZGRyZXNzXS5sb2NrZWRUb2tlbnNbX2luZGV4XS5wdWxzZUxvY2tIYXNoOwoJfQoKCgkvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gc2VuZCB0b2tlbnMgYWZ0ZXIgdmVyaWZpbmcgS1lDIGZvcm0uCiAgICAgKgogICAgICogQHBhcmFtIF9iZW5lZmljaWFyeSBBZGRyZXNzIG9mIHJlY2VpdmVyIG9mIHRva2Vucy4KICAgICAqCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgICAqLwoJZnVuY3Rpb24gc2VuZFRva2VucyhhZGRyZXNzIF9iZW5lZmljaWFyeSkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CgkJcmVxdWlyZSAocmVzZXJ2ZWRbX2JlbmVmaWNpYXJ5XS5wdWxzQW1vdW50ID4gMCk7CQkgLy8gQ2hlY2sgaWYgcmVzZXJ2ZWQgdG9rZW5zIGZvciBfYmVuZWZpY2lhcnkgYWRkcmVzcyBpcyBncmVhdGVyIHRoZW4gMAoKCQlfdHJhbnNmZXIoY3Jvd2RzYWxlQWRkcmVzcywgX2JlbmVmaWNpYXJ5LCByZXNlcnZlZFtfYmVuZWZpY2lhcnldLnB1bHNBbW91bnQpOwoKCQlyZXNlcnZlZFtfYmVuZWZpY2lhcnldLnB1bHNBbW91bnQgPSAwOwoKCQlyZXR1cm4gdHJ1ZTsKCX0KCgoJLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHJlc2VydmUgdG9rZW5zIGZvciBidXllciBhZnRlciBzZW5kaW5nIEVUSCB0byBjcm93ZHNhbGUgYWRkcmVzcy4KICAgICAqCiAgICAgKiBAcGFyYW0gX2JlbmVmaWNpYXJ5IEFkZHJlc3Mgb2YgcmVzZXJ2ZXIgb2YgdG9rZW5zLgogICAgICogQHBhcmFtIF9wdWxzQW1vdW50IEFtb3VudCBvZiB0b2tlbnMgdG8gcmVzZXJ2ZS4KICAgICAqIEBwYXJhbSBfZXRoIEFtb3VudCBvZiBldGggc2VudCBpbiB0cmFuc2FjdGlvbi4KICAgICAqCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgICAqLwoJZnVuY3Rpb24gcmVzZXJ2ZVRva2VucyhhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludDI1NiBfcHVsc0Ftb3VudCwgdWludDI1NiBfZXRoLCB1aW50MjU2IF9yZXNlcnZlVHlwZUlkKSBvbmx5Q3Jvd2RzYWxlQWRkcmVzcyBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewoJCXJlcXVpcmUgKF9iZW5lZmljaWFyeSAhPSAweDApOwkJCQkJLy8gUHJldmVudCB0cmFuc2ZlciB0byAweDAgYWRkcmVzcwoJCXJlcXVpcmUgKHRvdGFsU3VwcGx5ID49IF9wdWxzQW1vdW50KTsgICAgICAgICAgIC8vIENoZWNrIGlmIHN1Y2ggdG9rZW5zIGFtb3VudCBsZWZ0CgoJCXRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuc3ViKF9wdWxzQW1vdW50KTsKCQlyZXNlcnZlZFtfYmVuZWZpY2lhcnldLnB1bHNBbW91bnQgPSByZXNlcnZlZFtfYmVuZWZpY2lhcnldLnB1bHNBbW91bnQuYWRkKF9wdWxzQW1vdW50KTsKCQlyZXNlcnZlZFtfYmVuZWZpY2lhcnldLmNvbGxlY3RlZEV0aGVyID0gcmVzZXJ2ZWRbX2JlbmVmaWNpYXJ5XS5jb2xsZWN0ZWRFdGhlci5hZGQoX2V0aCk7CgoJCWVtaXQgVG9rZW5SZXNlcnZhdGlvbihfYmVuZWZpY2lhcnksIF9ldGgsIF9wdWxzQW1vdW50LCBfcmVzZXJ2ZVR5cGVJZCk7CgkJcmV0dXJuIHRydWU7Cgl9CgoKCS8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byByZXZlcnQgcmVzZXJ2YXRpb24gZm9yIHNvbWUgYWRkcmVzcy4KICAgICAqCiAgICAgKiBAcGFyYW0gX2FkZHJlc3NUb1JldmVydCBBZGRyZXNzIHRvIHdoaWNoIGNvbGxlY3RlZCBFVEggd2lsbCBiZSByZXR1cm5lZC4KICAgICAqCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgICAqLwoJZnVuY3Rpb24gcmV2ZXJ0UmVzZXJ2YXRpb24oYWRkcmVzcyBfYWRkcmVzc1RvUmV2ZXJ0KSBvbmx5T3duZXIgcHVibGljIHJldHVybnMgKGJvb2wpIHsKCQlyZXF1aXJlIChyZXNlcnZlZFtfYWRkcmVzc1RvUmV2ZXJ0XS5wdWxzQW1vdW50ID4gMCk7CQoKCQl0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChyZXNlcnZlZFtfYWRkcmVzc1RvUmV2ZXJ0XS5wdWxzQW1vdW50KTsKCQlyZXNlcnZlZFtfYWRkcmVzc1RvUmV2ZXJ0XS5wdWxzQW1vdW50ID0gMDsKCgkJX2FkZHJlc3NUb1JldmVydC50cmFuc2ZlcihyZXNlcnZlZFtfYWRkcmVzc1RvUmV2ZXJ0XS5jb2xsZWN0ZWRFdGhlciAtICgyMDAwMDAwMDAwMCAqIDIxMDAwKSk7CgkJcmVzZXJ2ZWRbX2FkZHJlc3NUb1JldmVydF0uY29sbGVjdGVkRXRoZXIgPSAwOwoKCQllbWl0IFJldmVydGluZ1Jlc2VydmF0aW9uKF9hZGRyZXNzVG9SZXZlcnQpOwoJCXJldHVybiB0cnVlOwoJfQoKCgkvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gbG9jayB0b2tlbnMgZm9yIHNvbWUgcGVyaW9kIG9mIHRpbWUuCiAgICAgKgogICAgICogQHBhcmFtIF9hbW91bnQgQW1vdW50IG9mIGxvY2tlZCB0b2tlbnMuCiAgICAgKiBAcGFyYW0gX21pbnV0ZXNUb0xvY2sgRGF5cyB0b2tlbnMgd2lsbCBiZSBsb2NrZWQuCiAgICAgKiBAcGFyYW0gX3B1bHNlTG9ja0hhc2ggSGFzaCBvZiBsb2NrZWQgcHVsc2UuCiAgICAgKgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICAgKi8KCWZ1bmN0aW9uIGxvY2tUb2tlbnModWludDI1NiBfYW1vdW50LCB1aW50MjU2IF9taW51dGVzVG9Mb2NrLCBieXRlczMyIF9wdWxzZUxvY2tIYXNoKSBwdWJsaWMgcmV0dXJucyAoYm9vbCl7CgkJcmVxdWlyZShiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfYW1vdW50KTsKCgkJTG9jayBtZW1vcnkgbG9ja1N0cnVjdDsKICAgICAgICBsb2NrU3RydWN0LmFtb3VudCA9IF9hbW91bnQ7CiAgICAgICAgbG9ja1N0cnVjdC5zdGFydFRpbWUgPSBub3c7CiAgICAgICAgbG9ja1N0cnVjdC50aW1lVG9Mb2NrID0gX21pbnV0ZXNUb0xvY2sgKiAxIG1pbnV0ZXM7CiAgICAgICAgbG9ja1N0cnVjdC5wdWxzZUxvY2tIYXNoID0gX3B1bHNlTG9ja0hhc2g7CgogICAgICAgIGFkZHJlc3NMb2Nrc1ttc2cuc2VuZGVyXS5sb2NrZWRUb2tlbnMucHVzaChsb2NrU3RydWN0KTsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfYW1vdW50KTsKCiAgICAgICAgZW1pdCBUb2tlbkxvY2tpbmcobXNnLnNlbmRlciwgX2Ftb3VudCwgX21pbnV0ZXNUb0xvY2spOwogICAgICAgIHJldHVybiB0cnVlOwoJfQoKCgkvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gdW5sb2NrIHRva2VucyBmb3Igc29tZSBwZXJpb2Qgb2YgdGltZS4KICAgICAqCiAgICAgKiBAcGFyYW0gX2FkZHJlc3NUb1VubG9jayBBZGRyZXJzcyBvZiBwZXJzb24gd2l0aCBsb2NrZWQgdG9rZW5zLgogICAgICoKICAgICAqIEByZXR1cm4gVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAgICovCglmdW5jdGlvbiB1bmxvY2tUb2tlbnMoYWRkcmVzcyBfYWRkcmVzc1RvVW5sb2NrKSBwdWJsaWMgcmV0dXJucyAoYm9vbCl7CgkJdWludDI1NiBpID0gMDsKCQl3aGlsZShpIDwgYWRkcmVzc0xvY2tzW19hZGRyZXNzVG9VbmxvY2tdLmxvY2tlZFRva2Vucy5sZW5ndGgpIHsKCQkJaWYgKG5vdyA+IGFkZHJlc3NMb2Nrc1tfYWRkcmVzc1RvVW5sb2NrXS5sb2NrZWRUb2tlbnNbaV0uc3RhcnRUaW1lICsgYWRkcmVzc0xvY2tzW19hZGRyZXNzVG9VbmxvY2tdLmxvY2tlZFRva2Vuc1tpXS50aW1lVG9Mb2NrKSB7CgoJCQkJYmFsYW5jZXNbX2FkZHJlc3NUb1VubG9ja10gPSBiYWxhbmNlc1tfYWRkcmVzc1RvVW5sb2NrXS5hZGQoYWRkcmVzc0xvY2tzW19hZGRyZXNzVG9VbmxvY2tdLmxvY2tlZFRva2Vuc1tpXS5hbW91bnQpOwoJCQkJZW1pdCBUb2tlblVubG9ja2luZyhfYWRkcmVzc1RvVW5sb2NrLCBhZGRyZXNzTG9ja3NbX2FkZHJlc3NUb1VubG9ja10ubG9ja2VkVG9rZW5zW2ldLmFtb3VudCk7CgoJCQkJaWYgKGkgPCBhZGRyZXNzTG9ja3NbX2FkZHJlc3NUb1VubG9ja10ubG9ja2VkVG9rZW5zLmxlbmd0aCkgewoJCQkJCWZvciAodWludDI1NiBqID0gaTsgaiA8IGFkZHJlc3NMb2Nrc1tfYWRkcmVzc1RvVW5sb2NrXS5sb2NrZWRUb2tlbnMubGVuZ3RoIC0gMTsgaisrKXsKCQkJICAgICAgICAgICAgYWRkcmVzc0xvY2tzW19hZGRyZXNzVG9VbmxvY2tdLmxvY2tlZFRva2Vuc1tqXSA9IGFkZHJlc3NMb2Nrc1tfYWRkcmVzc1RvVW5sb2NrXS5sb2NrZWRUb2tlbnNbaiArIDFdOwoJCQkgICAgICAgIH0KCQkJCX0KCQkgICAgICAgIGRlbGV0ZSBhZGRyZXNzTG9ja3NbX2FkZHJlc3NUb1VubG9ja10ubG9ja2VkVG9rZW5zW2FkZHJlc3NMb2Nrc1tfYWRkcmVzc1RvVW5sb2NrXS5sb2NrZWRUb2tlbnMubGVuZ3RoIC0gMV07CgkJCQkKCQkJCWFkZHJlc3NMb2Nrc1tfYWRkcmVzc1RvVW5sb2NrXS5sb2NrZWRUb2tlbnMubGVuZ3RoID0gYWRkcmVzc0xvY2tzW19hZGRyZXNzVG9VbmxvY2tdLmxvY2tlZFRva2Vucy5sZW5ndGguc3ViKDEpOwoJCQl9CgkJCWVsc2UgewoJCQkJaSA9IGkuYWRkKDEpOwoJCQl9CgkJfQoKICAgICAgICByZXR1cm4gdHJ1ZTsKCX0KfQoKCgoKCi8qKgogKiBAdGl0bGUgU2FmZU1hdGguCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yLgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CglmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewoJCXVpbnQyNTYgYyA9IGEgKiBiOwoJCWFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CgkJcmV0dXJuIGM7Cgl9CgoJZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKCQkvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKCQl1aW50MjU2IGMgPSBhIC8gYjsKCQkvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAoJCXJldHVybiBjOwoJfQoKCWZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CgkJYXNzZXJ0KGIgPD0gYSk7CgkJcmV0dXJuIGEgLSBiOwoJfQoKCWZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CgkJdWludDI1NiBjID0gYSArIGI7CgkJYXNzZXJ0KGMgPj0gYSk7CgkJcmV0dXJuIGM7Cgl9Cn0KCi8qKgogKiBAdGl0bGUgU3RhZ2VkIGNyb3dkc2FsZS4KICogQGRldiBGdW5jdGlvbmFsaXR5IG9mIHN0YWdlZCBjcm93ZHNhbGUuCiAqLwpjb250cmFjdCBTdGFnZWRDcm93ZHNhbGUgaXMgT3duYWJsZSB7CgogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgLy8gUHVibGljIHN0cnVjdHVyZSBvZiBjcm93ZHNhbGUncyBzdGFnZXMuCiAgICBzdHJ1Y3QgU3RhZ2UgewogICAgICAgIHVpbnQyNTYgaGFyZGNhcDsKICAgICAgICB1aW50MjU2IHByaWNlOwogICAgICAgIHVpbnQyNTYgbWluSW52ZXN0bWVudDsKICAgICAgICB1aW50MjU2IGludmVzdGVkOwogICAgICAgIHVpbnQyNTYgY2xvc2VkOwogICAgfQoKICAgIFN0YWdlW10gcHVibGljIHN0YWdlczsKCgogICAgLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGdldCB0aGUgY3VycmVudCBzdGFnZSBudW1iZXIuCiAgICAgKiAKICAgICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZmluZyB0aGUgY3VycmVudCBzdGFnZSBudW1iZXIuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRTdGFnZSgpIHB1YmxpYyB2aWV3IHJldHVybnModWludDI1NikgewogICAgICAgIGZvcih1aW50MjU2IGk9MDsgaSA8IHN0YWdlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZihzdGFnZXNbaV0uY2xvc2VkID09IDApIHsKICAgICAgICAgICAgICAgIHJldHVybiBpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldmVydCgpOwogICAgfQoKCiAgICAvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gYWRkIHRoZSBzdGFnZSB0byB0aGUgY3Jvd2RzYWxlLgogICAgICoKICAgICAqIEBwYXJhbSBfaGFyZGNhcCBUaGUgaGFyZGNhcCBvZiB0aGUgc3RhZ2UuCiAgICAgKiBAcGFyYW0gX3ByaWNlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHlvdSB3aWxsIHJlY2VpdmUgcGVyIDEgRVRIIGZvciB0aGlzIHN0YWdlLgogICAgICovCiAgICBmdW5jdGlvbiBhZGRTdGFnZSh1aW50MjU2IF9oYXJkY2FwLCB1aW50MjU2IF9wcmljZSwgdWludDI1NiBfbWluSW52ZXN0bWVudCwgdWludCBfaW52ZXN0ZWQpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX2hhcmRjYXAgPiAwICYmIF9wcmljZSA+IDApOwogICAgICAgIFN0YWdlIG1lbW9yeSBzdGFnZSA9IFN0YWdlKF9oYXJkY2FwLm11bCgxIGV0aGVyKSwgX3ByaWNlLCBfbWluSW52ZXN0bWVudC5tdWwoMSBldGhlcikuZGl2KDEwKSwgX2ludmVzdGVkLm11bCgxIGV0aGVyKSwgMCk7CiAgICAgICAgc3RhZ2VzLnB1c2goc3RhZ2UpOwogICAgfQoKCiAgICAvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gY2xvc2UgdGhlIHN0YWdlIG1hbnVhbGx5LgogICAgICoKICAgICAqIEBwYXJhbSBfc3RhZ2VOdW1iZXIgU3RhZ2UgbnVtYmVyIHRvIGNsb3NlLgogICAgICovCiAgICBmdW5jdGlvbiBjbG9zZVN0YWdlKHVpbnQyNTYgX3N0YWdlTnVtYmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKHN0YWdlc1tfc3RhZ2VOdW1iZXJdLmNsb3NlZCA9PSAwKTsKICAgICAgICBpZiAoX3N0YWdlTnVtYmVyICE9IDApIHJlcXVpcmUoc3RhZ2VzW19zdGFnZU51bWJlciAtIDFdLmNsb3NlZCAhPSAwKTsKCiAgICAgICAgc3RhZ2VzW19zdGFnZU51bWJlcl0uY2xvc2VkID0gbm93OwogICAgICAgIHN0YWdlc1tfc3RhZ2VOdW1iZXJdLmludmVzdGVkID0gc3RhZ2VzW19zdGFnZU51bWJlcl0uaGFyZGNhcDsKCiAgICAgICAgaWYgKF9zdGFnZU51bWJlciArIDEgPD0gc3RhZ2VzLmxlbmd0aCAtIDEpIHsKICAgICAgICAgICAgc3RhZ2VzW19zdGFnZU51bWJlciArIDFdLmludmVzdGVkID0gc3RhZ2VzW19zdGFnZU51bWJlcl0uaGFyZGNhcDsKICAgICAgICB9CiAgICB9CgoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byByZW1vdmUgYWxsIHN0YWdlcy4KICAgICAqCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgICovCiAgICBmdW5jdGlvbiByZW1vdmVTdGFnZXMoKSBvbmx5T3duZXIgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKHN0YWdlcy5sZW5ndGggPiAwKTsKCiAgICAgICAgc3RhZ2VzLmxlbmd0aCA9IDA7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9CgovKioKICogQHRpdGxlIFBVTFMgY3Jvd2RzYWxlCiAqIEBkZXYgUFVMUyBjcm93ZHNhbGUgZnVuY3Rpb25hbGl0eS4KICovCmNvbnRyYWN0IFBVTFNDcm93ZHNhbGUgaXMgU3RhZ2VkQ3Jvd2RzYWxlIHsKCXVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKCVBVTFNUb2tlbiBwdWJsaWMgdG9rZW47CgoJLy8gUHVibGljIHZhcmlhYmxlcyBvZiB0aGUgY3Jvd2RzYWxlCglhZGRyZXNzIHB1YmxpYyBtdWx0aVNpZ1dhbGxldDsgCS8vIGFkZHJlc3Mgd2hlcmUgZnVuZHMgYXJlIGNvbGxlY3RlZAoJYm9vbCBwdWJsaWMgaGFzRW5kZWQ7Cglib29sIHB1YmxpYyBpc1BhdXNlZDsJCgoKCWV2ZW50IFRva2VuUmVzZXJ2YXRpb24oYWRkcmVzcyBwdXJjaGFzZXIsIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiBpbmRleGVkIHNlbmRFdGhlciwgdWludDI1NiBpbmRleGVkIHB1bHNBbW91bnQpOwoJZXZlbnQgRm9yd2FyZGluZ0Z1bmRzKHVpbnQyNTYgaW5kZXhlZCB2YWx1ZSk7CgoKCS8qKgogICAgICogQGRldiBUaHJvd3MgaWYgY3Jvd2RzYWxlIGhhcyBlbmRlZC4KICAgICAqLwoJbW9kaWZpZXIgbm90RW5kZWQoKSB7CgkJcmVxdWlyZSghaGFzRW5kZWQpOwoJCV87Cgl9CgoKCS8qKgogICAgICogQGRldiBUaHJvd3MgaWYgY3Jvd2RzYWxlIGhhcyBub3QgZW5kZWQuCiAgICAgKi8KCW1vZGlmaWVyIG5vdFBhdXNlZCgpIHsKCQlyZXF1aXJlKCFpc1BhdXNlZCk7CgkJXzsKCX0KCgoJLyoqCiAgICAgKiBAZGV2IFRoZSBDcm93ZHNhbGUgY29uc3RydWN0b3Igc2V0cyB0aGUgbXVsdGlzaWcgd2FsbGV0IGZvciBmb3J3YW5kaW5nIGZ1bmRzLgogICAgICogQWRkcyBzdGFnZXMgdG8gdGhlIGNyb3dkc2FsZS4gSW5pdGlhbGl6ZSBQVUxTIHRva2Vucy4KICAgICAqLwoJZnVuY3Rpb24gUFVMU0Nyb3dkc2FsZSgpIHB1YmxpYyB7CgkJdG9rZW4gPSBjcmVhdGVUb2tlbkNvbnRyYWN0KCk7CgoJCW11bHRpU2lnV2FsbGV0ID0gMHgwMDk1NTE0OWQwZjQyNTE3OTAwMGU5MTRGMERGQzJlQkQ5NmQ2ZjQzOwoJCWhhc0VuZGVkID0gZmFsc2U7CgkJaXNQYXVzZWQgPSBmYWxzZTsKCgkJYWRkU3RhZ2UoMzAwMCwgMTYwMCwgMSwgMCk7ICAgLy8zcmQgdmFsdWUgaXMgYWN0dWFsbHkgZGl2IDEwCgkJYWRkU3RhZ2UoMzUwMCwgMTU1MCwgMSwgMCk7ICAgLy8zcmQgdmFsdWUgaXMgYWN0dWFsbHkgZGl2IDEwCgkJYWRkU3RhZ2UoNDAwMCwgMTUwMCwgMSwgMCk7ICAgLy8zcmQgdmFsdWUgaXMgYWN0dWFsbHkgZGl2IDEwCgkJYWRkU3RhZ2UoNDUwMCwgMTQ1MCwgMSwgMCk7ICAgLy8zcmQgdmFsdWUgaXMgYWN0dWFsbHkgZGl2IDEwCgkJYWRkU3RhZ2UoNDI1MDAsIDE0MDAsIDEsIDApOyAgLy8zcmQgdmFsdWUgaXMgYWN0dWFsbHkgZGl2IDEwCgl9CgoKCS8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBjcmVhdGUgUFVMUyB0b2tlbnMgY29udHJhY3QuCiAgICAgKgogICAgICogQHJldHVybiBQVUxTVG9rZW4gVGhlIGluc3RhbmNlIG9mIFBVTFMgdG9rZW4gY29udHJhY3QuCiAgICAgKi8KCWZ1bmN0aW9uIGNyZWF0ZVRva2VuQ29udHJhY3QoKSBpbnRlcm5hbCByZXR1cm5zIChQVUxTVG9rZW4pIHsKCQlyZXR1cm4gbmV3IFBVTFNUb2tlbigpOwoJfQoKCgkvKioKICAgICAqIEBkZXYgUGF5YWJsZSBmdW5jdGlvbi4KICAgICAqLwoJZnVuY3Rpb24gKCkgZXh0ZXJuYWwgcGF5YWJsZSB7CgkJYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwoJfQoKCgkvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gYnV5IHRva2VucyAtIHJlc2VydmUgY2FsY3VsYXRlZCBhbW91bnQgb2YgdG9rZW5zLgogICAgICoKICAgICAqIEBwYXJhbSBfYmVuZWZpY2lhcnkgVGhlIGFkZHJlc3Mgb2YgdGhlIGJ1eWVyLgogICAgICovCglmdW5jdGlvbiBidXlUb2tlbnMoYWRkcmVzcyBfYmVuZWZpY2lhcnkpIHBheWFibGUgbm90RW5kZWQgbm90UGF1c2VkIHB1YmxpYyB7CgkJcmVxdWlyZShtc2cudmFsdWUgPj0gMCk7CgkJCgkJdWludDI1NiBzdGFnZUluZGV4ID0gZ2V0Q3VycmVudFN0YWdlKCk7CgkJU3RhZ2Ugc3RvcmFnZSBzdGFnZUN1cnJlbnQgPSBzdGFnZXNbc3RhZ2VJbmRleF07CgoJCXJlcXVpcmUobXNnLnZhbHVlID49IHN0YWdlQ3VycmVudC5taW5JbnZlc3RtZW50KTsKCgkJdWludDI1NiB0b2tlbnM7CgoJCS8vIGlmIHB1dHMgdXMgaW4gbmV3IHN0YWdlIC0gcmVjZWl2ZXMgd2l0aCBuZXh0IHN0YWdlIHByaWNlCgkJaWYgKHN0YWdlQ3VycmVudC5pbnZlc3RlZC5hZGQobXNnLnZhbHVlKSA+PSBzdGFnZUN1cnJlbnQuaGFyZGNhcCl7CgkJCXN0YWdlQ3VycmVudC5jbG9zZWQgPSBub3c7CgoJCQlpZiAoc3RhZ2VJbmRleCArIDEgPD0gc3RhZ2VzLmxlbmd0aCAtIDEpIHsKCQkJCVN0YWdlIHN0b3JhZ2Ugc3RhZ2VOZXh0ID0gc3RhZ2VzW3N0YWdlSW5kZXggKyAxXTsKCgkJCQl0b2tlbnMgPSBtc2cudmFsdWUubXVsKHN0YWdlQ3VycmVudC5wcmljZSk7CgkJCQl0b2tlbi5yZXNlcnZlVG9rZW5zKF9iZW5lZmljaWFyeSwgdG9rZW5zLCBtc2cudmFsdWUsIDApOwoKCQkJCXN0YWdlTmV4dC5pbnZlc3RlZCA9IHN0YWdlQ3VycmVudC5pbnZlc3RlZC5hZGQobXNnLnZhbHVlKTsKCgkJCQlzdGFnZUN1cnJlbnQuaW52ZXN0ZWQgPSBzdGFnZUN1cnJlbnQuaGFyZGNhcDsKCQkJfQoJCQllbHNlIHsKCQkJCXRva2VucyA9IG1zZy52YWx1ZS5tdWwoc3RhZ2VDdXJyZW50LnByaWNlKTsKCQkJCXRva2VuLnJlc2VydmVUb2tlbnMoX2JlbmVmaWNpYXJ5LCB0b2tlbnMsIG1zZy52YWx1ZSwgMCk7CgoJCQkJc3RhZ2VDdXJyZW50LmludmVzdGVkID0gc3RhZ2VDdXJyZW50LmludmVzdGVkLmFkZChtc2cudmFsdWUpOwoKCQkJCWhhc0VuZGVkID0gdHJ1ZTsKCQkJfQoJCX0KCQllbHNlIHsKCQkJdG9rZW5zID0gbXNnLnZhbHVlLm11bChzdGFnZUN1cnJlbnQucHJpY2UpOwoJCQl0b2tlbi5yZXNlcnZlVG9rZW5zKF9iZW5lZmljaWFyeSwgdG9rZW5zLCBtc2cudmFsdWUsIDApOwoKCQkJc3RhZ2VDdXJyZW50LmludmVzdGVkID0gc3RhZ2VDdXJyZW50LmludmVzdGVkLmFkZChtc2cudmFsdWUpOwoJCX0KCgkJZW1pdCBUb2tlblJlc2VydmF0aW9uKG1zZy5zZW5kZXIsIF9iZW5lZmljaWFyeSwgbXNnLnZhbHVlLCB0b2tlbnMpOwoJCWZvcndhcmRGdW5kcygpOwoJfQoKCgkvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gYnV5IHRva2VucyAtIHJlc2VydmUgY2FsY3VsYXRlZCBhbW91bnQgb2YgdG9rZW5zLgogICAgICoKICAgICAqIEBwYXJhbSBfYmVuZWZpY2lhcnkgVGhlIGFkZHJlc3Mgb2YgdGhlIGJ1eWVyLgogICAgICovCglmdW5jdGlvbiBwcml2YXRlUHJlc2FsZVRva2VuUmVzZXJ2YXRpb24oYWRkcmVzcyBfYmVuZWZpY2lhcnksIHVpbnQyNTYgX2Ftb3VudCwgdWludDI1NiBfcmVzZXJ2ZVR5cGVJZCkgb25seU93bmVyIHB1YmxpYyB7CgkJcmVxdWlyZSAoX3Jlc2VydmVUeXBlSWQgPiAwKTsKCQl0b2tlbi5yZXNlcnZlVG9rZW5zKF9iZW5lZmljaWFyeSwgX2Ftb3VudCwgMCwgX3Jlc2VydmVUeXBlSWQpOwoJCWVtaXQgVG9rZW5SZXNlcnZhdGlvbihtc2cuc2VuZGVyLCBfYmVuZWZpY2lhcnksIDAsIF9hbW91bnQpOwoJfQoKCgkvKioKICAgICAqIEBkZXYgSW50ZXJuYWwgZnVuY3Rpb24gdG8gZm9yd2FyZCBmdW5kcyB0byBtdWx0aXNpZyB3YWxsZXQuCiAgICAgKi8KCWZ1bmN0aW9uIGZvcndhcmRGdW5kcygpIGludGVybmFsIHsKCQltdWx0aVNpZ1dhbGxldC50cmFuc2Zlcihtc2cudmFsdWUpOwoJCWVtaXQgRm9yd2FyZGluZ0Z1bmRzKG1zZy52YWx1ZSk7Cgl9CgoKCS8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBmaW5pc2ggdGhlIGNyb3dkc2FsZS4KICAgICAqCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgICAqLyAKCWZ1bmN0aW9uIGZpbmlzaENyb3dkc2FsZSgpIG9ubHlPd25lciBub3RFbmRlZCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewoJCWhhc0VuZGVkID0gdHJ1ZTsKCQlyZXR1cm4gdHJ1ZTsKCX0KCgoJLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHBhdXNlIHRoZSBjcm93ZHNhbGUuCiAgICAgKgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICAgKi8gCglmdW5jdGlvbiBwYXVzZUNyb3dkc2FsZSgpIG9ubHlPd25lciBub3RFbmRlZCBub3RQYXVzZWQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKCQlpc1BhdXNlZCA9IHRydWU7CgkJcmV0dXJuIHRydWU7Cgl9CgoKCS8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byB1bnBhdXNlIHRoZSBjcm93ZHNhbGUuCiAgICAgKgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICAgKi8gCglmdW5jdGlvbiB1bnBhdXNlQ3Jvd2RzYWxlKCkgb25seU93bmVyIG5vdEVuZGVkIHB1YmxpYyByZXR1cm5zIChib29sKSB7CgkJaXNQYXVzZWQgPSBmYWxzZTsKCQlyZXR1cm4gdHJ1ZTsKCX0KCgoJLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoYW5nZSBtdWx0aXNnd2FsbGV0LgogICAgICoKICAgICAqIEByZXR1cm4gVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAgICovIAoJZnVuY3Rpb24gY2hhbmdlTXVsdGlTaWdXYWxsZXQoYWRkcmVzcyBfbmV3TXVsdGlTaWdXYWxsZXQpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewoJCW11bHRpU2lnV2FsbGV0ID0gX25ld011bHRpU2lnV2FsbGV0OwoJCXJldHVybiB0cnVlOwoJfQp9'.
	

]
