Class {
	#name : #SRT7e5f189b635e943368aba3e4daa9cb7ae9581f42,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT7e5f189b635e943368aba3e4daa9cb7ae9581f42 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjA7CgovKgoqIENyZWF0ZWQgYnkgTE9DS0VEaU4KKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qCiogLT5BYm91dCBMT0NLCiogQW4gYXV0b25vbW91c2Z1bGx5IGF1dG9tYXRlZCBwYXNzaXZlIGluY29tZToKKiBbeF0gQ3JlYXRlZCBieSBhIHRlYW0gb2YgcHJvZmVzc2lvbmFsIERldmVsb3BlcnMgZnJvbSBJbmRpYSB3aG8gcnVuIGEgc29mdHdhcmUgY29tcGFueSBhbmQgc3BlY2lhbGl6ZSBpbiBJbnRlcm5ldCBhbmQgQ3J5cHRvZ3JhcGhpYyBTZWN1cml0eQoqIFt4XSBQZW4tdGVzdGVkIG11bHRpcGxlIHRpbWVzIHdpdGggemVybyB2dWxuZXJhYmlsaXRpZXMhCiogW1hdIEFibGUgdG8gb3BlcmF0ZSBldmVuIGlmIG91ciB3ZWJzaXRlIHd3dy5sb2NrZWRpbi5pbyBpcyBkb3duIHZpYSBNZXRhbWFzayBhbmQgRXRoZXJzY2FuCiogW3hdIDMwIExPQ0sgcmVxdWlyZWQgZm9yIGEgTWFzdGVybm9kZSBMaW5rIGdlbmVyYXRpb24KKiBbeF0gQXMgcGVvcGxlIGpvaW4geW91ciBtYWtlIG1vbmV5IGFzIHBlb3BsZSBsZWF2ZSB5b3UgbWFrZSBtb25leSAyNC83IOKAkyBOb3QgYSBsZW5kaW5nIHBsYXRmb3JtIGJ1dCBhIGh1bWFuLWxlc3MgcGFzc2l2ZSBpbmNvbWUgbWFjaGluZSBvbiB0aGUgRXRoZXJldW0gQmxvY2tjaGFpbgoqIFt4XSBPbmNlIGRlcGxveWVkIG5laXRoZXIgd2Ugbm9yIGFueSBvdGhlciBodW1hbiBjYW4gYWx0ZXIsIGNoYW5nZSBvciBzdG9wIHRoZSBjb250cmFjdCBpdCB3aWxsIHJ1biBmb3IgYXMgbG9uZyBhcyBFdGhlcmV1bSBpcyBydW5uaW5nIQoqIFt4XSBVbmxpa2Ugc2ltaWxhciBwcm9qZWN0cyB0aGUgZGV2ZWxvcGVycyBhcmUgb25seSBhbGxvd2luZyAzIEVUSCB0byBiZSBwdXJjaGFzZWQgYnkgRGV2ZWxvcGVycyBhdCBkZXBsb3ltZW50IGFzIG9wcG9zZWQgdG8gMjIgRVRIIOKAkyBGYWlyIGZvciB0aGUgUHVibGljIQoqIC0gMzMlIFJld2FyZCBvZiBkaXZpZGVuZHMgaWYgc29tZW9uZSBzaWducyB1cCB1c2luZyB5b3VyIE1hc3Rlcm5vZGUgbGluawoqIC0gIFlvdSBlYXJuIGJ5IG90aGVycyBkZXBvc2l0aW5nIG9yIHdpdGhkcmF3aW5nIEVUSCBhbmQgdGhpcyBwYXNzaXZlIEVUSCBlYXJuaW5ncyBjYW4gZWl0aGVyIGJlIHJlaW52ZXN0ZWQgb3IgeW91IGNhbiB3aXRoZHJhdyBpdCBhdCBhbnkgdGltZSB3aXRob3V0IHBlbmFsdHkuCiogVXBvbiBlbnRyeSBpbnRvIHRoZSBjb250cmFjdCBpdCB3aWxsIGF1dG9tYXRpY2FsbHkgZGVkdWN0IHlvdXIgMTAlIGVudHJ5IGFuZCBleGl0IGZlZXMgc28gdGhlIGxvbmdlciB5b3UgcmVtYWluIGFuZCB0aGUgaGlnaGVyIHRoZSB2b2x1bWUgdGhlIG1vcmUgeW91IGVhcm4gYW5kIHRoZSBtb3JlIHRoYXQgcGVvcGxlIGpvaW4gb3IgbGVhdmUgeW91IGFsc28gZWFybiBtb3JlLiAgCiogWW91IGFyZSBhYmxlIHRvIHdpdGhkcmF3IHlvdXIgZW50aXJlIGJhbGFuY2UgYXQgYW55IHRpbWUgeW91IHNvIGNob29zZS4gCiovCgoKY29udHJhY3QgSG91cmdsYXNzIHsKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICA9ICAgICAgICAgICAgTU9ESUZJRVJTICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIC8vIG9ubHkgcGVvcGxlIHdpdGggdG9rZW5zCiAgICBtb2RpZmllciBvbmx5QmFnaG9sZGVycygpIHsKICAgICAgICByZXF1aXJlKG15VG9rZW5zKCkgPiAwKTsKICAgICAgICBfOwogICAgfQoKICAgIC8vIG9ubHkgcGVvcGxlIHdpdGggcHJvZml0cwogICAgbW9kaWZpZXIgb25seVN0cm9uZ2hhbmRzKCkgewogICAgICAgIHJlcXVpcmUobXlEaXZpZGVuZHModHJ1ZSkgPiAwKTsKICAgICAgICBfOwogICAgfQoKCiAgICAvLyBlbnN1cmVzIHRoYXQgdGhlIGZpcnN0IHRva2VucyBpbiB0aGUgY29udHJhY3Qgd2lsbCBiZSBlcXVhbGx5IGRpc3RyaWJ1dGVkCiAgICAvLyBtZWFuaW5nLCBubyBkaXZpbmUgZHVtcCB3aWxsIGJlIGV2ZXIgcG9zc2libGUKICAgIC8vIHJlc3VsdDogaGVhbHRoeSBsb25nZXZpdHkuCiAgICBtb2RpZmllciBhbnRpRWFybHlXaGFsZSh1aW50MjU2IF9hbW91bnRPZkV0aGVyZXVtKXsKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwoKICAgICAgICAvLyBhcmUgd2Ugc3RpbGwgaW4gdGhlIHZ1bG5lcmFibGUgcGhhc2U/CiAgICAgICAgLy8gaWYgc28sIGVuYWN0IGFudGkgZWFybHkgd2hhbGUgcHJvdG9jb2wgCiAgICAgICAgaWYoIG9ubHlEZXZlcyYmICgodG90YWxFdGhlcmV1bUJhbGFuY2UoKSAtIF9hbW91bnRPZkV0aGVyZXVtKSA8PSBkZXZzUXVvdGFfICkpewogICAgICAgICAgICByZXF1aXJlKAogICAgICAgICAgICAgICAgLy8gaXMgdGhlIGN1c3RvbWVyIGluIHRoZSBhbWJhc3NhZG9yIGxpc3Q/CiAgICAgICAgICAgICAgICBkZXZlbG9wZXJzX1tfY3VzdG9tZXJBZGRyZXNzXSA9PSB0cnVlICYmCgogICAgICAgICAgICAgICAgLy8gZG9lcyB0aGUgY3VzdG9tZXIgcHVyY2hhc2UgZXhjZWVkIHRoZSBtYXggYW1iYXNzYWRvciBxdW90YT8KICAgICAgICAgICAgICAgIChhbWJhc3NhZG9yQWNjdW11bGF0ZWRRdW90YV9bX2N1c3RvbWVyQWRkcmVzc10gKyBfYW1vdW50T2ZFdGhlcmV1bSkgPD0gZGV2c01heFB1cmNoYXNlXwoKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIC8vIHVwZGF0ZWQgdGhlIGFjY3VtdWxhdGVkIHF1b3RhICAgIAogICAgICAgICAgICBhbWJhc3NhZG9yQWNjdW11bGF0ZWRRdW90YV9bX2N1c3RvbWVyQWRkcmVzc10gPSBTYWZlTWF0aC5hZGQoYW1iYXNzYWRvckFjY3VtdWxhdGVkUXVvdGFfW19jdXN0b21lckFkZHJlc3NdLCBfYW1vdW50T2ZFdGhlcmV1bSk7CgogICAgICAgICAgICAvLyBleGVjdXRlCiAgICAgICAgICAgIF87CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gaW4gY2FzZSB0aGUgZXRoZXIgY291bnQgZHJvcHMgbG93LCB0aGUgYW1iYXNzYWRvciBwaGFzZSB3b24ndCByZWluaXRpYXRlCiAgICAgICAgICAgIG9ubHlEZXZlcyA9IGZhbHNlOwogICAgICAgICAgICBfOyAgICAKICAgICAgICB9CgogICAgfQoKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgPSAgICAgICAgICAgIEVWRU5UUyAgICAgICAgICAgID0KICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgICBldmVudCBvblRva2VuUHVyY2hhc2UoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIGN1c3RvbWVyQWRkcmVzcywKICAgICAgICB1aW50MjU2IGluY29taW5nRXRoZXJldW0sCiAgICAgICAgdWludDI1NiB0b2tlbnNNaW50ZWQsCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIHJlZmVycmVkQnkKICAgICk7CgogICAgZXZlbnQgb25Ub2tlblNlbGwoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIGN1c3RvbWVyQWRkcmVzcywKICAgICAgICB1aW50MjU2IHRva2Vuc0J1cm5lZCwKICAgICAgICB1aW50MjU2IGV0aGVyZXVtRWFybmVkCiAgICApOwoKICAgIGV2ZW50IG9uUmVpbnZlc3RtZW50KAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBjdXN0b21lckFkZHJlc3MsCiAgICAgICAgdWludDI1NiBldGhlcmV1bVJlaW52ZXN0ZWQsCiAgICAgICAgdWludDI1NiB0b2tlbnNNaW50ZWQKICAgICk7CgogICAgZXZlbnQgb25XaXRoZHJhdygKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgY3VzdG9tZXJBZGRyZXNzLAogICAgICAgIHVpbnQyNTYgZXRoZXJldW1XaXRoZHJhd24KICAgICk7CgogICAgLy8gRVJDMjAKICAgIGV2ZW50IFRyYW5zZmVyKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBmcm9tLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCB0bywKICAgICAgICB1aW50MjU2IHRva2VucwogICAgKTsKCgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICA9ICAgICAgICAgICAgQ09ORklHVVJBQkxFUyAgICAgICAgICAgID0KICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgc3RyaW5nIHB1YmxpYyBuYW1lID0gIkxPQ0tFRGlOIjsKICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIkxPQ0siOwogICAgdWludDggY29uc3RhbnQgcHVibGljIGRlY2ltYWxzID0gMTg7CiAgICB1aW50OCBjb25zdGFudCBpbnRlcm5hbCBkaXZpZGVuZEZlZV8gPSAxMDsKICAgIHVpbnQyNTYgY29uc3RhbnQgaW50ZXJuYWwgdG9rZW5QcmljZUluaXRpYWxfID0gMC4wMDAwMDAxIGV0aGVyOwogICAgdWludDI1NiBjb25zdGFudCBpbnRlcm5hbCB0b2tlblByaWNlSW5jcmVtZW50YWxfID0gMC4wMDAwMDAwMSBldGhlcjsKICAgIHVpbnQyNTYgY29uc3RhbnQgaW50ZXJuYWwgbWFnbml0dWRlID0gMioqNjQ7CgogICAgLy8gcHJvb2Ygb2Ygc3Rha2UgKGRlZmF1bHRzIGF0IDMwIHRva2VucykKICAgIHVpbnQyNTYgcHVibGljIHN0YWtpbmdSZXF1aXJlbWVudCA9IDMwZTE4OwoKICAgIC8vIERldmVsb3BlciBwcm9ncmFtCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgaW50ZXJuYWwgZGV2ZWxvcGVyc187CiAgICB1aW50MjU2IGNvbnN0YW50IGludGVybmFsIGRldnNNYXhQdXJjaGFzZV8gPSAxIGV0aGVyOwogICAgdWludDI1NiBjb25zdGFudCBpbnRlcm5hbCBkZXZzUXVvdGFfID0gMyBldGhlcjsKCgoKICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgPSAgICAgICAgICAgIERBVEFTRVRTICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgLy8gYW1vdW50IG9mIHNoYXJlcyBmb3IgZWFjaCBhZGRyZXNzIChzY2FsZWQgbnVtYmVyKQogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGludGVybmFsIHRva2VuQmFsYW5jZUxlZGdlcl87CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgaW50ZXJuYWwgcmVmZXJyYWxCYWxhbmNlXzsKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBpbnQyNTYpIGludGVybmFsIHBheW91dHNUb187CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgaW50ZXJuYWwgYW1iYXNzYWRvckFjY3VtdWxhdGVkUXVvdGFfOwogICAgdWludDI1NiBpbnRlcm5hbCB0b2tlblN1cHBseV8gPSAwOwogICAgdWludDI1NiBpbnRlcm5hbCBwcm9maXRQZXJTaGFyZV87CgoKICAgIC8vIHdoZW4gdGhpcyBpcyBzZXQgdG8gdHJ1ZSwgb25seSBkZXZlbG9wZXJzIGNhbiBwdXJjaGFzZSB0b2tlbnMgKHRoaXMgcHJldmVudHMgYSB3aGFsZSBwcmVtaW5lLCBpdCBlbnN1cmVzIGEgZmFpcmx5IGRpc3RyaWJ1dGVkIHVwcGVyIHB5cmFtaWQpCiAgICBib29sIHB1YmxpYyBvbmx5RGV2ZXMgPSB0cnVlOwoKCgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgID0gICAgICAgICAgICBQVUJMSUMgRlVOQ1RJT05TICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIC8qCiAgICAqIC0tIEFQUExJQ0FUSU9OIEVOVFJZIFBPSU5UUyAtLSAgCiAgICAqLwogICAgZnVuY3Rpb24gSG91cmdsYXNzKCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICAvLyBhZGQgZGV2ZWxvcGVycyBoZXJlCiAgICAgICAgZGV2ZWxvcGVyc19bMHgyQUFDNDgyMUIwM0VkM2MxNENhYjZkNjI3ODJhMzY4ZTBjNDRlN2RlXSA9IHRydWU7CgogICAgICAgIGRldmVsb3BlcnNfWzB4ZDllQTkwRTY0OTE0NzVFQjQ5OGQ1NUJlMjE2NTc3NTA4MGVENEY4M10gPSB0cnVlOwoKICAgICAgICBkZXZlbG9wZXJzX1sweEViMTg3NGY4YjcwMkFCODkxMWFlNjREMzZmNkIzNDk3NWFmY2M0MzFdID0gdHJ1ZTsKCgogICAgfQoKCiAgICAvKioKICAgICAqIENvbnZlcnRzIGFsbCBpbmNvbWluZyBldGhlcmV1bSB0byB0b2tlbnMgZm9yIHRoZSBjYWxsZXIsIGFuZCBwYXNzZXMgZG93biB0aGUgcmVmZXJyYWwgYWRkeSAoaWYgYW55KQogICAgICovCiAgICBmdW5jdGlvbiBidXkoYWRkcmVzcyBfcmVmZXJyZWRCeSkKICAgICAgICBwdWJsaWMKICAgICAgICBwYXlhYmxlCiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIHB1cmNoYXNlVG9rZW5zKG1zZy52YWx1ZSwgX3JlZmVycmVkQnkpOwogICAgfQoKICAgIC8qKgogICAgICogRmFsbGJhY2sgZnVuY3Rpb24gdG8gaGFuZGxlIGV0aGVyZXVtIHRoYXQgd2FzIHNlbmQgc3RyYWlnaHQgdG8gdGhlIGNvbnRyYWN0CiAgICAgKiBVbmZvcnR1bmF0ZWx5IHdlIGNhbm5vdCB1c2UgYSByZWZlcnJhbCBhZGRyZXNzIHRoaXMgd2F5LgogICAgICovCiAgICBmdW5jdGlvbigpCiAgICAgICAgcGF5YWJsZQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIHB1cmNoYXNlVG9rZW5zKG1zZy52YWx1ZSwgMHgwKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlcnRzIGFsbCBvZiBjYWxsZXIncyBkaXZpZGVuZHMgdG8gdG9rZW5zLgogICAgICovCiAgICBmdW5jdGlvbiByZWludmVzdCgpCiAgICBvbmx5U3Ryb25naGFuZHMoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIC8vIGZldGNoIGRpdmlkZW5kcwogICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IG15RGl2aWRlbmRzKGZhbHNlKTsgLy8gcmV0cmlldmUgcmVmLiBib251cyBsYXRlciBpbiB0aGUgY29kZQoKICAgICAgICAvLyBwYXkgb3V0IHRoZSBkaXZpZGVuZHMgdmlydHVhbGx5CiAgICAgICAgYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICBwYXlvdXRzVG9fW19jdXN0b21lckFkZHJlc3NdICs9ICAoaW50MjU2KSAoX2RpdmlkZW5kcyAqIG1hZ25pdHVkZSk7CgogICAgICAgIC8vIHJldHJpZXZlIHJlZi4gYm9udXMKICAgICAgICBfZGl2aWRlbmRzICs9IHJlZmVycmFsQmFsYW5jZV9bX2N1c3RvbWVyQWRkcmVzc107CiAgICAgICAgcmVmZXJyYWxCYWxhbmNlX1tfY3VzdG9tZXJBZGRyZXNzXSA9IDA7CgogICAgICAgIC8vIGRpc3BhdGNoIGEgYnV5IG9yZGVyIHdpdGggdGhlIHZpcnR1YWxpemVkICJ3aXRoZHJhd24gZGl2aWRlbmRzIgogICAgICAgIHVpbnQyNTYgX3Rva2VucyA9IHB1cmNoYXNlVG9rZW5zKF9kaXZpZGVuZHMsIDB4MCk7CgogICAgICAgIC8vIGZpcmUgZXZlbnQKICAgICAgICBlbWl0IG9uUmVpbnZlc3RtZW50KF9jdXN0b21lckFkZHJlc3MsIF9kaXZpZGVuZHMsIF90b2tlbnMpOwogICAgfQoKICAgIC8qKgogICAgICogQWxpYXMgb2Ygc2VsbCgpIGFuZCB3aXRoZHJhdygpLgogICAgICovCiAgICBmdW5jdGlvbiBleGl0KCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICAvLyBnZXQgdG9rZW4gY291bnQgZm9yIGNhbGxlciAmIHNlbGwgdGhlbSBhbGwKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIHVpbnQyNTYgX3Rva2VucyA9IHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc107CiAgICAgICAgaWYoX3Rva2VucyA+IDApIHNlbGwoX3Rva2Vucyk7CgogICAgICAgIC8vIGxhbWJvIGRlbGl2ZXJ5IHNlcnZpY2UKICAgICAgICB3aXRoZHJhdygpOwogICAgfQoKICAgIC8qKgogICAgICogV2l0aGRyYXdzIGFsbCBvZiB0aGUgY2FsbGVycyBlYXJuaW5ncy4KICAgICAqLwogICAgZnVuY3Rpb24gd2l0aGRyYXcoKQogICAgb25seVN0cm9uZ2hhbmRzKCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICAvLyBzZXR1cCBkYXRhCiAgICAgICAgYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICB1aW50MjU2IF9kaXZpZGVuZHMgPSBteURpdmlkZW5kcyhmYWxzZSk7IC8vIGdldCByZWYuIGJvbnVzIGxhdGVyIGluIHRoZSBjb2RlCgogICAgICAgIC8vIHVwZGF0ZSBkaXZpZGVuZCB0cmFja2VyCiAgICAgICAgcGF5b3V0c1RvX1tfY3VzdG9tZXJBZGRyZXNzXSArPSAgKGludDI1NikgKF9kaXZpZGVuZHMgKiBtYWduaXR1ZGUpOwoKICAgICAgICAvLyBhZGQgcmVmLiBib251cwogICAgICAgIF9kaXZpZGVuZHMgKz0gcmVmZXJyYWxCYWxhbmNlX1tfY3VzdG9tZXJBZGRyZXNzXTsKICAgICAgICByZWZlcnJhbEJhbGFuY2VfW19jdXN0b21lckFkZHJlc3NdID0gMDsKCiAgICAgICAgLy8gbGFtYm8gZGVsaXZlcnkgc2VydmljZQogICAgICAgIF9jdXN0b21lckFkZHJlc3MudHJhbnNmZXIoX2RpdmlkZW5kcyk7CgogICAgICAgIC8vIGZpcmUgZXZlbnQKICAgICAgICBlbWl0IG9uV2l0aGRyYXcoX2N1c3RvbWVyQWRkcmVzcywgX2RpdmlkZW5kcyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBMaXF1aWZpZXMgdG9rZW5zIHRvIGV0aGVyZXVtLgogICAgICovCiAgICBmdW5jdGlvbiBzZWxsKHVpbnQyNTYgX2Ftb3VudE9mVG9rZW5zKQogICAgICAgIG9ubHlCYWdob2xkZXJzKCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICAvLyBzZXR1cCBkYXRhCiAgICAgICAgYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICAvLyBydXNzaWFuIGhhY2tlcnMgQlRGTwogICAgICAgIHJlcXVpcmUoX2Ftb3VudE9mVG9rZW5zPD0gdG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSk7CiAgICAgICAgdWludDI1NiBfdG9rZW5zID0gX2Ftb3VudE9mVG9rZW5zOwogICAgICAgIHVpbnQyNTYgX2V0aGVyZXVtID0gdG9rZW5zVG9FdGhlcmV1bV8oX3Rva2Vucyk7CiAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gU2FmZU1hdGguZGl2KF9ldGhlcmV1bSwgZGl2aWRlbmRGZWVfKTsKICAgICAgICB1aW50MjU2IF90YXhlZEV0aGVyZXVtID0gU2FmZU1hdGguc3ViKF9ldGhlcmV1bSwgX2RpdmlkZW5kcyk7CgogICAgICAgIC8vIGJ1cm4gdGhlIHNvbGQgdG9rZW5zCiAgICAgICAgdG9rZW5TdXBwbHlfID0gU2FmZU1hdGguc3ViKHRva2VuU3VwcGx5XywgX3Rva2Vucyk7CiAgICAgICAgdG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSA9IFNhZmVNYXRoLnN1Yih0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdLCBfdG9rZW5zKTsKCiAgICAgICAgLy8gdXBkYXRlIGRpdmlkZW5kcyB0cmFja2VyCiAgICAgICAgaW50MjU2IF91cGRhdGVkUGF5b3V0cyA9IChpbnQyNTYpIChwcm9maXRQZXJTaGFyZV8gKiBfdG9rZW5zICsgKF90YXhlZEV0aGVyZXVtICogbWFnbml0dWRlKSk7CiAgICAgICAgcGF5b3V0c1RvX1tfY3VzdG9tZXJBZGRyZXNzXSAtPSBfdXBkYXRlZFBheW91dHM7ICAgICAgIAoKICAgICAgICAvLyBkaXZpZGluZyBieSB6ZXJvIGlzIGEgYmFkIGlkZWEKICAgICAgICBpZiAodG9rZW5TdXBwbHlfID4gMCkgewogICAgICAgICAgICAvLyB1cGRhdGUgdGhlIGFtb3VudCBvZiBkaXZpZGVuZHMgcGVyIHRva2VuCiAgICAgICAgICAgIHByb2ZpdFBlclNoYXJlXyA9IFNhZmVNYXRoLmFkZChwcm9maXRQZXJTaGFyZV8sIChfZGl2aWRlbmRzICogbWFnbml0dWRlKSAvIHRva2VuU3VwcGx5Xyk7CiAgICAgICAgfQoKICAgICAgICAvLyBmaXJlIGV2ZW50CiAgICAgICAgZW1pdCBvblRva2VuU2VsbChfY3VzdG9tZXJBZGRyZXNzLCBfdG9rZW5zLCBfdGF4ZWRFdGhlcmV1bSk7CiAgICB9CgoKICAgIC8qKgogICAgICogVHJhbnNmZXIgdG9rZW5zIGZyb20gdGhlIGNhbGxlciB0byBhIG5ldyBob2xkZXIuCiAgICAgKiBSZW1lbWJlciwgdGhlcmUncyBhIDEwJSBmZWUgaGVyZSBhcyB3ZWxsLgogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90b0FkZHJlc3MsIHVpbnQyNTYgX2Ftb3VudE9mVG9rZW5zKQogICAgICAgIG9ubHlCYWdob2xkZXJzKCkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zKGJvb2wpCiAgICB7CiAgICAgICAgLy8gc2V0dXAKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwoKICAgICAgICAvLyBtYWtlIHN1cmUgd2UgaGF2ZSB0aGUgcmVxdWVzdGVkIHRva2VucwogICAgICAgIC8vIGFsc28gZGlzYWJsZXMgdHJhbnNmZXJzIHVudGlsIGFtYmFzc2Fkb3IgcGhhc2UgaXMgb3ZlcgogICAgICAgIC8vICggd2Vkb250IHdhbnQgd2hhbGUgcHJlbWluZXMgKQogICAgICAgIHJlcXVpcmUoIW9ubHlEZXZlcyYmIF9hbW91bnRPZlRva2Vuczw9IHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc10pOwoKICAgICAgICAvLyB3aXRoZHJhdyBhbGwgb3V0c3RhbmRpbmcgZGl2aWRlbmRzIGZpcnN0CiAgICAgICAgaWYobXlEaXZpZGVuZHModHJ1ZSkgPiAwKSB3aXRoZHJhdygpOwoKICAgICAgICAvLyBsaXF1aWZ5IDEwJSBvZiB0aGUgdG9rZW5zIHRoYXQgYXJlIHRyYW5zZmVyZWQKICAgICAgICAvLyB0aGVzZSBhcmUgZGlzcGVyc2VkIHRvIHNoYXJlaG9sZGVycwogICAgICAgIHVpbnQyNTYgX3Rva2VuRmVlID0gU2FmZU1hdGguZGl2KF9hbW91bnRPZlRva2VucywgZGl2aWRlbmRGZWVfKTsKICAgICAgICB1aW50MjU2IF90YXhlZFRva2VucyA9IFNhZmVNYXRoLnN1YihfYW1vdW50T2ZUb2tlbnMsIF90b2tlbkZlZSk7CiAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gdG9rZW5zVG9FdGhlcmV1bV8oX3Rva2VuRmVlKTsKCiAgICAgICAgLy8gYnVybiB0aGUgZmVlIHRva2VucwogICAgICAgIHRva2VuU3VwcGx5XyA9IFNhZmVNYXRoLnN1Yih0b2tlblN1cHBseV8sIF90b2tlbkZlZSk7CgogICAgICAgIC8vIGV4Y2hhbmdlIHRva2VucwogICAgICAgIHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc10gPSBTYWZlTWF0aC5zdWIodG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSwgX2Ftb3VudE9mVG9rZW5zKTsKICAgICAgICB0b2tlbkJhbGFuY2VMZWRnZXJfW190b0FkZHJlc3NdID0gU2FmZU1hdGguYWRkKHRva2VuQmFsYW5jZUxlZGdlcl9bX3RvQWRkcmVzc10sIF90YXhlZFRva2Vucyk7CgogICAgICAgIC8vIHVwZGF0ZSBkaXZpZGVuZCB0cmFja2VycwogICAgICAgIHBheW91dHNUb19bX2N1c3RvbWVyQWRkcmVzc10gLT0gKGludDI1NikgKHByb2ZpdFBlclNoYXJlXyAqIF9hbW91bnRPZlRva2Vucyk7CiAgICAgICAgcGF5b3V0c1RvX1tfdG9BZGRyZXNzXSArPSAoaW50MjU2KSAocHJvZml0UGVyU2hhcmVfICogX3RheGVkVG9rZW5zKTsKCiAgICAgICAgLy8gZGlzcGVyc2UgZGl2aWRlbmRzIGFtb25nIGhvbGRlcnMKICAgICAgICBwcm9maXRQZXJTaGFyZV8gPSBTYWZlTWF0aC5hZGQocHJvZml0UGVyU2hhcmVfLCAoX2RpdmlkZW5kcyAqIG1hZ25pdHVkZSkgLyB0b2tlblN1cHBseV8pOwoKICAgICAgICAvLyBmaXJlIGV2ZW50CiAgICAgICAgZW1pdCBUcmFuc2ZlcihfY3VzdG9tZXJBZGRyZXNzLCBfdG9BZGRyZXNzLCBfdGF4ZWRUb2tlbnMpOwoKICAgICAgICAvLyBFUkMyMAogICAgICAgIHJldHVybiB0cnVlOwoKICAgIH0KCiAgICAKCiAgICAvKi0tLS0tLS0tLS0gIEhFTFBFUlMgQU5EIENBTENVTEFUT1JTICAtLS0tLS0tLS0tKi8KICAgIC8qKgogICAgICogTWV0aG9kIHRvIHZpZXcgdGhlIGN1cnJlbnQgRXRoZXJldW0gc3RvcmVkIGluIHRoZSBjb250cmFjdAogICAgICogRXhhbXBsZTogdG90YWxFdGhlcmV1bUJhbGFuY2UoKQogICAgICovCiAgICBmdW5jdGlvbiB0b3RhbEV0aGVyZXVtQmFsYW5jZSgpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnModWludCkKICAgIHsKICAgICAgICByZXR1cm4gdGhpcy5iYWxhbmNlOwogICAgfQoKICAgIC8qKgogICAgICogUmV0cmlldmUgdGhlIHRvdGFsIHRva2VuIHN1cHBseS4KICAgICAqLwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgcmV0dXJuIHRva2VuU3VwcGx5XzsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHJpZXZlIHRoZSB0b2tlbnMgb3duZWQgYnkgdGhlIGNhbGxlci4KICAgICAqLwogICAgZnVuY3Rpb24gbXlUb2tlbnMoKQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICByZXR1cm4gYmFsYW5jZU9mKF9jdXN0b21lckFkZHJlc3MpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0cmlldmUgdGhlIGRpdmlkZW5kcyBvd25lZCBieSB0aGUgY2FsbGVyLgogICAgICogSWYgYF9pbmNsdWRlUmVmZXJyYWxCb251c2AgaXMgdG8gdG8gMS90cnVlLCB0aGUgcmVmZXJyYWwgYm9udXMgd2lsbCBiZSBpbmNsdWRlZCBpbiB0aGUgY2FsY3VsYXRpb25zLgogICAgICogVGhlIHJlYXNvbiBmb3IgdGhpcywgaXMgdGhhdCBpbiB0aGUgZnJvbnRlbmQsIHdlIHdpbGwgd2FudCB0byBnZXQgdGhlIHRvdGFsIGRpdnMgKGdsb2JhbCArIHJlZikKICAgICAqIEJ1dCBpbiB0aGUgaW50ZXJuYWwgY2FsY3VsYXRpb25zLCB3ZSB3YW50IHRoZW0gc2VwYXJhdGUuIAogICAgICovIAogICAgZnVuY3Rpb24gbXlEaXZpZGVuZHMoYm9vbCBfaW5jbHVkZVJlZmVycmFsQm9udXMpIAogICAgICAgIHB1YmxpYyAKICAgICAgICB2aWV3IAogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIHJldHVybiBfaW5jbHVkZVJlZmVycmFsQm9udXMgP2RpdmlkZW5kc09mKF9jdXN0b21lckFkZHJlc3MpICsgcmVmZXJyYWxCYWxhbmNlX1tfY3VzdG9tZXJBZGRyZXNzXSA6IGRpdmlkZW5kc09mKF9jdXN0b21lckFkZHJlc3MpIDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHJpZXZlIHRoZSB0b2tlbiBiYWxhbmNlIG9mIGFueSBzaW5nbGUgYWRkcmVzcy4KICAgICAqLwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcykKICAgICAgICB2aWV3CiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIHJldHVybiB0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdOwogICAgfQoKICAgIC8qKgogICAgICogUmV0cmlldmUgdGhlIGRpdmlkZW5kIGJhbGFuY2Ugb2YgYW55IHNpbmdsZSBhZGRyZXNzLgogICAgICovCiAgICBmdW5jdGlvbiBkaXZpZGVuZHNPZihhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MpCiAgICAgICAgdmlldwogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICByZXR1cm4gKHVpbnQyNTYpICgoaW50MjU2KShwcm9maXRQZXJTaGFyZV8gKiB0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdKSAtIHBheW91dHNUb19bX2N1c3RvbWVyQWRkcmVzc10pIC8gbWFnbml0dWRlOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBidXkgcHJpY2Ugb2YgMSBpbmRpdmlkdWFsIHRva2VuLgogICAgICovCiAgICBmdW5jdGlvbiBzZWxsUHJpY2UoKSAKICAgICAgICBwdWJsaWMgCiAgICAgICAgdmlldyAKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgLy8gb3VyIGNhbGN1bGF0aW9uIHJlbGllcyBvbiB0aGUgdG9rZW4gc3VwcGx5LCBzbyB3ZSBuZWVkIHN1cHBseS4gRG9oLgogICAgICAgICAgICBpZih0b2tlblN1cHBseV8gPT0gMCl7CiAgICAgICAgICAgIHJldHVybiB0b2tlblByaWNlSW5pdGlhbF8gLSB0b2tlblByaWNlSW5jcmVtZW50YWxfOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHVpbnQyNTYgX2V0aGVyZXVtID0gdG9rZW5zVG9FdGhlcmV1bV8oMWUxOCk7CiAgICAgICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IFNhZmVNYXRoLmRpdihfZXRoZXJldW0sIGRpdmlkZW5kRmVlXyAgKTsKICAgICAgICAgICAgdWludDI1NiBfdGF4ZWRFdGhlcmV1bSA9IFNhZmVNYXRoLnN1YihfZXRoZXJldW0sIF9kaXZpZGVuZHMpOwogICAgICAgICAgICByZXR1cm4gX3RheGVkRXRoZXJldW07CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBzZWxsIHByaWNlIG9mIDEgaW5kaXZpZHVhbCB0b2tlbi4KICAgICAqLwogICAgZnVuY3Rpb24gYnV5UHJpY2UoKSAKICAgICAgICBwdWJsaWMgCiAgICAgICAgdmlldyAKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgLy8gb3VyIGNhbGN1bGF0aW9uIHJlbGllcyBvbiB0aGUgdG9rZW4gc3VwcGx5LCBzbyB3ZSBuZWVkIHN1cHBseS4gRG9oLgogICAgICAgIGlmKHRva2VuU3VwcGx5XyA9PSAwKXsKICAgICAgICAgICAgcmV0dXJuIHRva2VuUHJpY2VJbml0aWFsXyArIHRva2VuUHJpY2VJbmNyZW1lbnRhbF87CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdWludDI1NiBfZXRoZXJldW0gPSB0b2tlbnNUb0V0aGVyZXVtXygxZTE4KTsKICAgICAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gU2FmZU1hdGguZGl2KF9ldGhlcmV1bSwgZGl2aWRlbmRGZWVfICApOwogICAgICAgICAgICB1aW50MjU2IF90YXhlZEV0aGVyZXVtID0gU2FmZU1hdGguYWRkKF9ldGhlcmV1bSwgX2RpdmlkZW5kcyk7CiAgICAgICAgICAgIHJldHVybiBfdGF4ZWRFdGhlcmV1bTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBGdW5jdGlvbiBmb3IgdGhlIGZyb250ZW5kIHRvIGR5bmFtaWNhbGx5IHJldHJpZXZlIHRoZSBwcmljZSBzY2FsaW5nIG9mIGJ1eSBvcmRlcnMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZVRva2Vuc1JlY2VpdmVkKHVpbnQyNTYgX2V0aGVyZXVtVG9TcGVuZCkgCiAgICAgICAgcHVibGljIAogICAgICAgIHZpZXcgCiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IFNhZmVNYXRoLmRpdihfZXRoZXJldW1Ub1NwZW5kLCBkaXZpZGVuZEZlZV8pOwogICAgICAgIHVpbnQyNTYgX3RheGVkRXRoZXJldW0gPSBTYWZlTWF0aC5zdWIoX2V0aGVyZXVtVG9TcGVuZCwgX2RpdmlkZW5kcyk7CiAgICAgICAgdWludDI1NiBfYW1vdW50T2ZUb2tlbnMgPSBldGhlcmV1bVRvVG9rZW5zXyhfdGF4ZWRFdGhlcmV1bSk7CgogICAgICAgIHJldHVybiBfYW1vdW50T2ZUb2tlbnM7CiAgICB9CgogICAgLyoqCiAgICAgKiBGdW5jdGlvbiBmb3IgdGhlIGZyb250ZW5kIHRvIGR5bmFtaWNhbGx5IHJldHJpZXZlIHRoZSBwcmljZSBzY2FsaW5nIG9mIHNlbGwgb3JkZXJzLgogICAgICovCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVFdGhlcmV1bVJlY2VpdmVkKHVpbnQyNTYgX3Rva2Vuc1RvU2VsbCkgCiAgICAgICAgcHVibGljIAogICAgICAgIHZpZXcgCiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIHJlcXVpcmUoX3Rva2Vuc1RvU2VsbDw9IHRva2VuU3VwcGx5Xyk7CiAgICAgICAgdWludDI1NiBfZXRoZXJldW0gPSB0b2tlbnNUb0V0aGVyZXVtXyhfdG9rZW5zVG9TZWxsKTsKICAgICAgICB1aW50MjU2IF9kaXZpZGVuZHMgPSBTYWZlTWF0aC5kaXYoX2V0aGVyZXVtLCBkaXZpZGVuZEZlZV8pOwogICAgICAgIHVpbnQyNTYgX3RheGVkRXRoZXJldW0gPSBTYWZlTWF0aC5zdWIoX2V0aGVyZXVtLCBfZGl2aWRlbmRzKTsKICAgICAgICByZXR1cm4gX3RheGVkRXRoZXJldW07CiAgICB9CgoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICA9ICAgICAgICAgICAgSU5URVJOQUwgRlVOQ1RJT05TICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIGZ1bmN0aW9uIHB1cmNoYXNlVG9rZW5zKHVpbnQyNTYgX2luY29taW5nRXRoZXJldW0sIGFkZHJlc3MgX3JlZmVycmVkQnkpCiAgICAgICAgYW50aUVhcmx5V2hhbGUoX2luY29taW5nRXRoZXJldW0pCiAgICAgICAgaW50ZXJuYWwKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgLy8gZGF0YSBzZXR1cAogICAgICAgIGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgdWludDI1NiBfdW5kaXZpZGVkRGl2aWRlbmRzID0gU2FmZU1hdGguZGl2KF9pbmNvbWluZ0V0aGVyZXVtLCBkaXZpZGVuZEZlZV8pOwogICAgICAgIHVpbnQyNTYgX3JlZmVycmFsQm9udXMgPSBTYWZlTWF0aC5kaXYoX3VuZGl2aWRlZERpdmlkZW5kcywgMyk7CiAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gU2FmZU1hdGguc3ViKF91bmRpdmlkZWREaXZpZGVuZHMsIF9yZWZlcnJhbEJvbnVzKTsKICAgICAgICB1aW50MjU2IF90YXhlZEV0aGVyZXVtID0gU2FmZU1hdGguc3ViKF9pbmNvbWluZ0V0aGVyZXVtLCBfdW5kaXZpZGVkRGl2aWRlbmRzKTsKICAgICAgICB1aW50MjU2IF9hbW91bnRPZlRva2VucyA9IGV0aGVyZXVtVG9Ub2tlbnNfKF90YXhlZEV0aGVyZXVtKTsKICAgICAgICB1aW50MjU2IF9mZWUgPSBfZGl2aWRlbmRzICogbWFnbml0dWRlOwoKICAgICAgICAvLyBubyBwb2ludCBpbiBjb250aW51aW5nIGV4ZWN1dGlvbiBpZiBPUCBpcyBhIHBvb3JmYWdydXNzaWFuIGhhY2tlcgogICAgICAgIC8vIHByZXZlbnRzIG92ZXJmbG93IGluIHRoZSBjYXNlIHRoYXQgdGhlIHB5cmFtaWQgc29tZWhvdyBtYWdpY2FsbHkgc3RhcnRzIGJlaW5nIHVzZWQgYnkgZXZlcnlvbmUgaW4gdGhlIHdvcmxkCiAgICAgICAgLy8gKG9yIGhhY2tlcnMpCiAgICAgICAgLy8gYW5kIHllcyB3ZSBrbm93IHRoYXQgdGhlIHNhZmVtYXRoIGZ1bmN0aW9uIGF1dG9tYXRpY2FsbHkgcnVsZXMgb3V0IHRoZSAiZ3JlYXRlciB0aGVuIiBlcXVhc2lvbi4KICAgICAgICByZXF1aXJlKF9hbW91bnRPZlRva2Vucz4gMCAmJiAoU2FmZU1hdGguYWRkKF9hbW91bnRPZlRva2Vucyx0b2tlblN1cHBseV8pID50b2tlblN1cHBseV8pKTsKCiAgICAgICAgLy8gaXMgdGhlIHVzZXIgcmVmZXJyZWQgYnkgYSBtYXN0ZXJub2RlPwogICAgICAgIGlmKAogICAgICAgICAgICAvLyBpcyB0aGlzIGEgcmVmZXJyZWQgcHVyY2hhc2U/CiAgICAgICAgICAgIF9yZWZlcnJlZEJ5ICE9IDB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCAmJgoKICAgICAgICAgICAgLy8gbm8gY2hlYXRpbmchCiAgICAgICAgICAgIF9yZWZlcnJlZEJ5ICE9IF9jdXN0b21lckFkZHJlc3MmJgoKICAgICAgICAgICAgLy8gZG9lcyB0aGUgcmVmZXJyZXIgaGF2ZSBhdCBsZWFzdCBYIHdob2xlIHRva2Vucz8KICAgICAgICAgICAgLy8gaS5lIGlzIHRoZSByZWZlcnJlciBhIGdvZGx5IGNoYWQgbWFzdGVybm9kZQogICAgICAgICAgICB0b2tlbkJhbGFuY2VMZWRnZXJfW19yZWZlcnJlZEJ5XSA+PSBzdGFraW5nUmVxdWlyZW1lbnQKICAgICAgICApewogICAgICAgICAgICAvLyB3ZWFsdGggcmVkaXN0cmlidXRpb24KICAgICAgICAgICAgcmVmZXJyYWxCYWxhbmNlX1tfcmVmZXJyZWRCeV0gPSBTYWZlTWF0aC5hZGQocmVmZXJyYWxCYWxhbmNlX1tfcmVmZXJyZWRCeV0sIF9yZWZlcnJhbEJvbnVzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBubyByZWYgcHVyY2hhc2UKICAgICAgICAgICAgLy8gYWRkIHRoZSByZWZlcnJhbCBib251cyBiYWNrIHRvIHRoZSBnbG9iYWwgZGl2aWRlbmRzIGNha2UKICAgICAgICAgICAgX2RpdmlkZW5kcyA9IFNhZmVNYXRoLmFkZChfZGl2aWRlbmRzLCBfcmVmZXJyYWxCb251cyk7CiAgICAgICAgICAgIF9mZWUgPSBfZGl2aWRlbmRzICogbWFnbml0dWRlOwogICAgICAgIH0KCiAgICAgICAgLy8gd2UgY2FuJ3QgZ2l2ZSBwZW9wbGUgaW5maW5pdGUgZXRoZXJldW0KICAgICAgICBpZih0b2tlblN1cHBseV8gPiAwKXsKCiAgICAgICAgICAgIC8vIGFkZCB0b2tlbnMgdG8gdGhlIHBvb2wKICAgICAgICAgICAgdG9rZW5TdXBwbHlfID0gU2FmZU1hdGguYWRkKHRva2VuU3VwcGx5XywgX2Ftb3VudE9mVG9rZW5zKTsKCiAgICAgICAgICAgIC8vIHRha2UgdGhlIGFtb3VudCBvZiBkaXZpZGVuZHMgZ2FpbmVkIHRocm91Z2ggdGhpcyB0cmFuc2FjdGlvbiwgYW5kIGFsbG9jYXRlcyB0aGVtIGV2ZW5seSB0byBlYWNoIHNoYXJlaG9sZGVyCiAgICAgICAgICAgIHByb2ZpdFBlclNoYXJlXyArPSAoX2RpdmlkZW5kcyAqIG1hZ25pdHVkZSAvICh0b2tlblN1cHBseV8pKTsKCiAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGUgY3VzdG9tZXIgcmVjZWl2ZXMgb3ZlciBoaXMgcHVyY2hhc2UgCiAgICAgICAgICAgIF9mZWUgPSBfZmVlIC0gKF9mZWUtKF9hbW91bnRPZlRva2VucyAqIChfZGl2aWRlbmRzICogbWFnbml0dWRlIC8gKHRva2VuU3VwcGx5XykpKSk7CgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIGFkZCB0b2tlbnMgdG8gdGhlIHBvb2wKICAgICAgICAgICAgdG9rZW5TdXBwbHlfID0gX2Ftb3VudE9mVG9rZW5zOwogICAgICAgIH0KCiAgICAgICAgLy8gdXBkYXRlIGNpcmN1bGF0aW5nIHN1cHBseSAmIHRoZSBsZWRnZXIgYWRkcmVzcyBmb3IgdGhlIGN1c3RvbWVyCiAgICAgICAgdG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSA9IFNhZmVNYXRoLmFkZCh0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdLCBfYW1vdW50T2ZUb2tlbnMpOwoKICAgICAgICAvLyBUZWxscyB0aGUgY29udHJhY3QgdGhhdCB0aGUgYnV5ZXIgZG9lc24ndCBkZXNlcnZlIGRpdmlkZW5kcyBmb3IgdGhlIHRva2VucyBiZWZvcmUgdGhleSBvd25lZCB0aGVtOwogICAgICAgIC8vcmVhbGx5IGkga25vdyB5b3UgdGhpbmsgeW91IGRvIGJ1dCB5b3UgZG9uJ3QKICAgICAgICBpbnQyNTYgX3VwZGF0ZWRQYXlvdXRzID0gKGludDI1NikgKChwcm9maXRQZXJTaGFyZV8gKiBfYW1vdW50T2ZUb2tlbnMpIC0gX2ZlZSk7CiAgICAgICAgcGF5b3V0c1RvX1tfY3VzdG9tZXJBZGRyZXNzXSArPSBfdXBkYXRlZFBheW91dHM7CgogICAgICAgIC8vIGZpcmUgZXZlbnQKICAgICAgICBlbWl0IG9uVG9rZW5QdXJjaGFzZShfY3VzdG9tZXJBZGRyZXNzLCBfaW5jb21pbmdFdGhlcmV1bSwgX2Ftb3VudE9mVG9rZW5zLCBfcmVmZXJyZWRCeSk7CgogICAgICAgIHJldHVybiBfYW1vdW50T2ZUb2tlbnM7CiAgICB9CgogICAgLyoqCiAgICAgKiBDYWxjdWxhdGUgVG9rZW4gcHJpY2UgYmFzZWQgb24gYW4gYW1vdW50IG9mIGluY29taW5nIGV0aGVyZXVtCiAgICAgKiBTb21lIGNvbnZlcnNpb25zIG9jY3VycmVkIHRvIHByZXZlbnQgZGVjaW1hbCBlcnJvcnMgb3IgdW5kZXJmbG93cyAvIG92ZXJmbG93cyBpbiBzb2xpZGl0eSBjb2RlLgogICAgICovCiAgICBmdW5jdGlvbiBldGhlcmV1bVRvVG9rZW5zXyh1aW50MjU2IF9ldGhlcmV1bSkKICAgICAgICBpbnRlcm5hbAogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgdWludDI1NiBfdG9rZW5QcmljZUluaXRpYWwgPSB0b2tlblByaWNlSW5pdGlhbF8gKiAxZTE4OwogICAgICAgIHVpbnQyNTYgX3Rva2Vuc1JlY2VpdmVkID0gCiAgICAgICAgICgKICAgICAgICAgICAgKAogICAgICAgICAgICAgICAgLy8gdW5kZXJmbG93IGF0dGVtcHRzIEJURk8KICAgICAgICAgICAgICAgIFNhZmVNYXRoLnN1YigKICAgICAgICAgICAgICAgICAgICAoc3FydAogICAgICAgICAgICAgICAgICAgICAgICAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoX3Rva2VuUHJpY2VJbml0aWFsKioyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgKDIqKHRva2VuUHJpY2VJbmNyZW1lbnRhbF8gKiAxZTE4KSooX2V0aGVyZXVtICogMWUxOCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoKCh0b2tlblByaWNlSW5jcmVtZW50YWxfKSoqMikqKHRva2VuU3VwcGx5XyoqMikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoMioodG9rZW5QcmljZUluY3JlbWVudGFsXykqX3Rva2VuUHJpY2VJbml0aWFsKnRva2VuU3VwcGx5XykKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICksIF90b2tlblByaWNlSW5pdGlhbAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApLyh0b2tlblByaWNlSW5jcmVtZW50YWxfKQogICAgICAgICktKHRva2VuU3VwcGx5XykKICAgICAgICA7CgogICAgICAgIHJldHVybiBfdG9rZW5zUmVjZWl2ZWQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBDYWxjdWxhdGUgdG9rZW4gc2VsbCB2YWx1ZS4KICAgICAqIFNvbWUgY29udmVyc2lvbnMgb2NjdXJyZWQgdG8gcHJldmVudCBkZWNpbWFsIGVycm9ycyBvciB1bmRlcmZsb3dzIC8gb3ZlcmZsb3dzIGluIHNvbGlkaXR5IGNvZGUuCiAgICAgKi8KICAgICBmdW5jdGlvbiB0b2tlbnNUb0V0aGVyZXVtXyh1aW50MjU2IF90b2tlbnMpCiAgICAgICAgaW50ZXJuYWwKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewoKICAgICAgICB1aW50MjU2IHRva2Vuc18gPSAoX3Rva2VucyArIDFlMTgpOwogICAgICAgIHVpbnQyNTYgX3Rva2VuU3VwcGx5ID0gKHRva2VuU3VwcGx5XyArIDFlMTgpOwogICAgICAgIHVpbnQyNTYgX2V0aGVyUmVjZWl2ZWQgPQogICAgICAgICgKICAgICAgICAgICAgLy8gdW5kZXJmbG93IGF0dGVtcHRzIEJURk8KICAgICAgICAgICAgU2FmZU1hdGguc3ViKAogICAgICAgICAgICAgICAgKAogICAgICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAgICAgKAogICAgICAgICAgICAgICAgICAgICAgICB0b2tlblByaWNlSW5pdGlhbF8gKyh0b2tlblByaWNlSW5jcmVtZW50YWxfICogKF90b2tlblN1cHBseS8xZTE4KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS10b2tlblByaWNlSW5jcmVtZW50YWxfCiAgICAgICAgICAgICAgICAgICAgKSoodG9rZW5zXyAtIDFlMTgpCiAgICAgICAgICAgICAgICApLCh0b2tlblByaWNlSW5jcmVtZW50YWxfKigodG9rZW5zXyoqMi10b2tlbnNfKS8xZTE4KSkvMgogICAgICAgICAgICApCiAgICAgICAgLzFlMTgpOwogICAgICAgIHJldHVybiBfZXRoZXJSZWNlaXZlZDsKICAgIH0KCgogICAgZnVuY3Rpb24gc3FydCh1aW50IHgpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCB5KSB7CiAgICAgICAgdWludCB6ID0gKHggKyAxKSAvIDI7CiAgICAgICAgeSA9IHg7CiAgICAgICAgd2hpbGUgKHogPCB5KSB7CiAgICAgICAgICAgIHkgPSB6OwogICAgICAgICAgICB6ID0gKHggLyB6ICsgeikgLyAyOwogICAgICAgIH0KICAgIH0KfQoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CgogICAgLyoqCiAgICAqIEBkZXYgTXVsdGlwbGllcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICAgKi8KICAgIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgaWYgKGEgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgICAgdWludDI1NiBjID0gYSAqIGI7CiAgICAgICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEludGVnZXIgZGl2aXNpb24gb2YgdHdvIG51bWJlcnMsIHRydW5jYXRpbmcgdGhlIHF1b3RpZW50LgogICAgKi8KICAgIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICAgICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAgICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBTdWJzdHJhY3RzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cgKGkuZS4gaWYgc3VidHJhaGVuZCBpcyBncmVhdGVyIHRoYW4gbWludWVuZCkuCiAgICAqLwogICAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoYiA8PSBhKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgQWRkcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICAgKi8KICAgIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSk7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9Cn0='.
	

]
