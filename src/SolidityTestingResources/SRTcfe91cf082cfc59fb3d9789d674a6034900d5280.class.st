Class {
	#name : #SRTcfe91cf082cfc59fb3d9789d674a6034900d5280,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTcfe91cf082cfc59fb3d9789d674a6034900d5280 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovLyBGaWxlOiBjb250cmFjdHMvSW5zaWdodHNOZXR3b3JrMS5zb2wKCmNvbnRyYWN0IEluc2lnaHRzTmV0d29yazEgewogIGFkZHJlc3MgcHVibGljIG93bmVyOyAvLyBDcmVhdG9yCiAgYWRkcmVzcyBwdWJsaWMgc3VjY2Vzc29yOyAvLyBNYXkgZGVhY3RpdmF0ZSBjb250cmFjdAogIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgcHVibGljIGJhbGFuY2VzOyAgICAvLyBXaG8gaGFzIHdoYXQKICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyB1bmxvY2tUaW1lczsgLy8gV2hlbiBiYWxhbmNlcyB1bmxvY2sKICBib29sIHB1YmxpYyBhY3RpdmU7CiAgdWludDI1NiBfdG90YWxTdXBwbHk7IC8vIFN1bSBvZiBtaW50ZWQgdG9rZW5zCgogIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJJTlMiOwogIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIklOUyI7CiAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMDsKCiAgZnVuY3Rpb24gSW5zaWdodHNOZXR3b3JrMSgpIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIGFjdGl2ZSA9IHRydWU7CiAgfQoKICBmdW5jdGlvbiByZWdpc3RlcihhZGRyZXNzIG5ld1Rva2VuSG9sZGVyLCB1aW50IGlzc3VlQW1vdW50KSB7IC8vIE1pbnQgdG9rZW5zIGFuZCBhc3NpZ24gdG8gbmV3IG93bmVyCiAgICByZXF1aXJlKGFjdGl2ZSk7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOyAgIC8vIE9ubHkgY3JlYXRvciBjYW4gcmVnaXN0ZXIKICAgIHJlcXVpcmUoYmFsYW5jZXNbbmV3VG9rZW5Ib2xkZXJdID09IDApOyAvLyBBY2NvdW50cyBjYW4gb25seSBiZSByZWdpc3RlcmVkIG9uY2UKCiAgICBfdG90YWxTdXBwbHkgKz0gaXNzdWVBbW91bnQ7CiAgICBNaW50KG5ld1Rva2VuSG9sZGVyLCBpc3N1ZUFtb3VudCk7ICAvLyBUcmlnZ2VyIGV2ZW50CgogICAgcmVxdWlyZShiYWxhbmNlc1tuZXdUb2tlbkhvbGRlcl0gPCAoYmFsYW5jZXNbbmV3VG9rZW5Ib2xkZXJdICsgaXNzdWVBbW91bnQpKTsgICAvLyBPdmVyZmxvdyBjaGVjawogICAgYmFsYW5jZXNbbmV3VG9rZW5Ib2xkZXJdICs9IGlzc3VlQW1vdW50OwogICAgVHJhbnNmZXIoYWRkcmVzcygwKSwgbmV3VG9rZW5Ib2xkZXIsIGlzc3VlQW1vdW50KTsgIC8vIFRyaWdnZXIgZXZlbnQKCiAgICB1aW50IGN1cnJlbnRUaW1lID0gYmxvY2sudGltZXN0YW1wOyAvLyBzZWNvbmRzIHNpbmNlIHRoZSBVbml4IGVwb2NoCiAgICB1aW50IHVubG9ja1RpbWUgPSBjdXJyZW50VGltZSArIDM2NSoyNCo2MCo2MDsgLy8gb25lIHllYXIgb3V0IGZyb20gdGhlIGN1cnJlbnQgdGltZQogICAgYXNzZXJ0KHVubG9ja1RpbWUgPiBjdXJyZW50VGltZSk7IC8vIGNoZWNrIGZvciBvdmVyZmxvdwogICAgdW5sb2NrVGltZXNbbmV3VG9rZW5Ib2xkZXJdID0gdW5sb2NrVGltZTsKICB9CgogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgeyAgIC8vIEVSQzIwIGNvbXBsaWFuY2UKICAgIHJldHVybiBfdG90YWxTdXBwbHk7CiAgfQoKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgeyAgIC8vIEVSQzIwIGNvbXBsaWFuY2UKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgeyAgICAvLyBFUkMyMCBjb21wbGlhbmNlCiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsgICAvLyBFUkMyMCBjb21wbGlhbmNlCiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7ICAgLy8gRVJDMjAgY29tcGxpYW5jZQogICAgcmV0dXJuIDA7ICAgLy8gTm8gdHJhbnNmZXIgYWxsb3dhbmNlCiAgfQoKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgeyAgIC8vIEVSQzIwIGNvbXBsaWFuY2UKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCiAgZnVuY3Rpb24gZ2V0VW5sb2NrVGltZShhZGRyZXNzIF9hY2NvdW50SG9sZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gdW5sb2NrVGltZXNbX2FjY291bnRIb2xkZXJdOwogIH0KCiAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF9hbW91bnQpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpOwoKICBmdW5jdGlvbiBtYWtlU3VjY2Vzc29yKGFkZHJlc3Mgc3VjY2Vzc29yQWRkcikgewogICAgcmVxdWlyZShhY3RpdmUpOwogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIC8vcmVxdWlyZShzdWNjZXNzb3JBZGRyID09IGFkZHJlc3MoMCkpOwogICAgc3VjY2Vzc29yID0gc3VjY2Vzc29yQWRkcjsKICB9CgogIGZ1bmN0aW9uIGRlYWN0aXZhdGUoKSB7CiAgICByZXF1aXJlKGFjdGl2ZSk7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIgfHwgKHN1Y2Nlc3NvciAhPSBhZGRyZXNzKDApICYmIG1zZy5zZW5kZXIgPT0gc3VjY2Vzc29yKSk7ICAgLy8gQ2FsbGVkIGJ5IGNyZWF0b3Igb3Igc3VjY2Vzc29yCiAgICBhY3RpdmUgPSBmYWxzZTsKICB9Cn0KCi8vIEZpbGU6IHplcHBlbGluLXNvbGlkaXR5L2NvbnRyYWN0cy9vd25lcnNoaXAvT3duYWJsZS5zb2wKCi8qKgogKiBAdGl0bGUgT3duYWJsZQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuCiAqLwpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCgogIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9CgoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL21hdGgvU2FmZU1hdGguc29sCgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL3Rva2VuL0VSQzIwL0VSQzIwQmFzaWMuc29sCgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCi8vIEZpbGU6IHplcHBlbGluLXNvbGlkaXR5L2NvbnRyYWN0cy90b2tlbi9FUkMyMC9CYXNpY1Rva2VuLnNvbAoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICB1aW50MjU2IHRvdGFsU3VwcGx5XzsKCiAgLyoqCiAgKiBAZGV2IHRvdGFsIG51bWJlciBvZiB0b2tlbnMgaW4gZXhpc3RlbmNlCiAgKi8KICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiB0b3RhbFN1cHBseV87CiAgfQoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cgp9CgovLyBGaWxlOiB6ZXBwZWxpbi1zb2xpZGl0eS9jb250cmFjdHMvdG9rZW4vRVJDMjAvRVJDMjAuc29sCgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgovLyBGaWxlOiB6ZXBwZWxpbi1zb2xpZGl0eS9jb250cmFjdHMvdG9rZW4vRVJDMjAvU3RhbmRhcmRUb2tlbi5zb2wKCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CgoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBAZGV2IEluY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX2FkZGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gaW5jcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IERlY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBkZWNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3N1YnRyYWN0ZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBkZWNyZWFzZSB0aGUgYWxsb3dhbmNlIGJ5LgogICAqLwogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9CgovLyBGaWxlOiB6ZXBwZWxpbi1zb2xpZGl0eS9jb250cmFjdHMvdG9rZW4vRVJDMjAvTWludGFibGVUb2tlbi5zb2wKCi8qKgogKiBAdGl0bGUgTWludGFibGUgdG9rZW4KICogQGRldiBTaW1wbGUgRVJDMjAgVG9rZW4gZXhhbXBsZSwgd2l0aCBtaW50YWJsZSB0b2tlbiBjcmVhdGlvbgogKiBAZGV2IElzc3VlOiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvaXNzdWVzLzEyMAogKiBCYXNlZCBvbiBjb2RlIGJ5IFRva2VuTWFya2V0TmV0OiBodHRwczovL2dpdGh1Yi5jb20vVG9rZW5NYXJrZXROZXQvaWNvL2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy9NaW50YWJsZVRva2VuLnNvbAogKi8KY29udHJhY3QgTWludGFibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwogIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwoKICBib29sIHB1YmxpYyBtaW50aW5nRmluaXNoZWQgPSBmYWxzZTsKCgogIG1vZGlmaWVyIGNhbk1pbnQoKSB7CiAgICByZXF1aXJlKCFtaW50aW5nRmluaXNoZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gbWludCB0b2tlbnMKICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCByZWNlaXZlIHRoZSBtaW50ZWQgdG9rZW5zLgogICAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIG1pbnQuCiAgICogQHJldHVybiBBIGJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIG9ubHlPd25lciBjYW5NaW50IHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICB0b3RhbFN1cHBseV8gPSB0b3RhbFN1cHBseV8uYWRkKF9hbW91bnQpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF9hbW91bnQpOwogICAgTWludChfdG8sIF9hbW91bnQpOwogICAgVHJhbnNmZXIoYWRkcmVzcygwKSwgX3RvLCBfYW1vdW50KTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBzdG9wIG1pbnRpbmcgbmV3IHRva2Vucy4KICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBmaW5pc2hNaW50aW5nKCkgb25seU93bmVyIGNhbk1pbnQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIG1pbnRpbmdGaW5pc2hlZCA9IHRydWU7CiAgICBNaW50RmluaXNoZWQoKTsKICAgIHJldHVybiB0cnVlOwogIH0KfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL3Rva2VuL0VSQzIwL0NhcHBlZFRva2VuLnNvbAoKLyoqCiAqIEB0aXRsZSBDYXBwZWQgdG9rZW4KICogQGRldiBNaW50YWJsZSB0b2tlbiB3aXRoIGEgdG9rZW4gY2FwLgogKi8KY29udHJhY3QgQ2FwcGVkVG9rZW4gaXMgTWludGFibGVUb2tlbiB7CgogIHVpbnQyNTYgcHVibGljIGNhcDsKCiAgZnVuY3Rpb24gQ2FwcGVkVG9rZW4odWludDI1NiBfY2FwKSBwdWJsaWMgewogICAgcmVxdWlyZShfY2FwID4gMCk7CiAgICBjYXAgPSBfY2FwOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBtaW50IHRva2VucwogICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIG1pbnRlZCB0b2tlbnMuCiAgICogQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gbWludC4KICAgKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgb25seU93bmVyIGNhbk1pbnQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUodG90YWxTdXBwbHlfLmFkZChfYW1vdW50KSA8PSBjYXApOwoKICAgIHJldHVybiBzdXBlci5taW50KF90bywgX2Ftb3VudCk7CiAgfQoKfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL3Rva2VuL0VSQzIwL0RldGFpbGVkRVJDMjAuc29sCgpjb250cmFjdCBEZXRhaWxlZEVSQzIwIGlzIEVSQzIwIHsKICBzdHJpbmcgcHVibGljIG5hbWU7CiAgc3RyaW5nIHB1YmxpYyBzeW1ib2w7CiAgdWludDggcHVibGljIGRlY2ltYWxzOwoKICBmdW5jdGlvbiBEZXRhaWxlZEVSQzIwKHN0cmluZyBfbmFtZSwgc3RyaW5nIF9zeW1ib2wsIHVpbnQ4IF9kZWNpbWFscykgcHVibGljIHsKICAgIG5hbWUgPSBfbmFtZTsKICAgIHN5bWJvbCA9IF9zeW1ib2w7CiAgICBkZWNpbWFscyA9IF9kZWNpbWFsczsKICB9Cn0KCi8vIEZpbGU6IHplcHBlbGluLXNvbGlkaXR5L2NvbnRyYWN0cy9saWZlY3ljbGUvUGF1c2FibGUuc29sCgovKioKICogQHRpdGxlIFBhdXNhYmxlCiAqIEBkZXYgQmFzZSBjb250cmFjdCB3aGljaCBhbGxvd3MgY2hpbGRyZW4gdG8gaW1wbGVtZW50IGFuIGVtZXJnZW5jeSBzdG9wIG1lY2hhbmlzbS4KICovCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgewogIGV2ZW50IFBhdXNlKCk7CiAgZXZlbnQgVW5wYXVzZSgpOwoKICBib29sIHB1YmxpYyBwYXVzZWQgPSBmYWxzZTsKCgogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgbm90IHBhdXNlZC4KICAgKi8KICBtb2RpZmllciB3aGVuTm90UGF1c2VkKCkgewogICAgcmVxdWlyZSghcGF1c2VkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIHBhdXNlZC4KICAgKi8KICBtb2RpZmllciB3aGVuUGF1c2VkKCkgewogICAgcmVxdWlyZShwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byBwYXVzZSwgdHJpZ2dlcnMgc3RvcHBlZCBzdGF0ZQogICAqLwogIGZ1bmN0aW9uIHBhdXNlKCkgb25seU93bmVyIHdoZW5Ob3RQYXVzZWQgcHVibGljIHsKICAgIHBhdXNlZCA9IHRydWU7CiAgICBQYXVzZSgpOwogIH0KCiAgLyoqCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHVucGF1c2UsIHJldHVybnMgdG8gbm9ybWFsIHN0YXRlCiAgICovCiAgZnVuY3Rpb24gdW5wYXVzZSgpIG9ubHlPd25lciB3aGVuUGF1c2VkIHB1YmxpYyB7CiAgICBwYXVzZWQgPSBmYWxzZTsKICAgIFVucGF1c2UoKTsKICB9Cn0KCi8vIEZpbGU6IHplcHBlbGluLXNvbGlkaXR5L2NvbnRyYWN0cy90b2tlbi9FUkMyMC9QYXVzYWJsZVRva2VuLnNvbAoKLyoqCiAqIEB0aXRsZSBQYXVzYWJsZSB0b2tlbgogKiBAZGV2IFN0YW5kYXJkVG9rZW4gbW9kaWZpZWQgd2l0aCBwYXVzYWJsZSB0cmFuc2ZlcnMuCiAqKi8KY29udHJhY3QgUGF1c2FibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBQYXVzYWJsZSB7CgogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBzdXBlci5hcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJldHVybiBzdXBlci5pbmNyZWFzZUFwcHJvdmFsKF9zcGVuZGVyLCBfYWRkZWRWYWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICByZXR1cm4gc3VwZXIuZGVjcmVhc2VBcHByb3ZhbChfc3BlbmRlciwgX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgfQp9CgovLyBGaWxlOiBjb250cmFjdHMvSW5zaWdodHNOZXR3b3JrMkJhc2Uuc29sCgpjb250cmFjdCBJbnNpZ2h0c05ldHdvcmsyQmFzZSBpcyBEZXRhaWxlZEVSQzIwKCJJbnNpZ2h0cyBOZXR3b3JrIiwgIklOU1RBUiIsIDE4KSwgUGF1c2FibGVUb2tlbiwgQ2FwcGVkVG9rZW57CgogICAgdWludDI1NiBjb25zdGFudCBBVFRPVE9LRU5fRkFDVE9SID0gMTAqKjE4OwoKICAgIGFkZHJlc3MgcHVibGljIHByZWRlY2Vzc29yOwogICAgYWRkcmVzcyBwdWJsaWMgc3VjY2Vzc29yOwoKICAgIHVpbnQgY29uc3RhbnQgTUFYX1BVUkNIQVNFUyA9IDY0OwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2W10pIHB1YmxpYyBsb2NrZWRCYWxhbmNlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NltdKSBwdWJsaWMgdW5sb2NrVGltZXM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBpbXBvcnRlZDsKCiAgICBldmVudCBJbXBvcnQoYWRkcmVzcyBpbmRleGVkIGFjY291bnQsIHVpbnQyNTYgYW1vdW50LCB1aW50MjU2IHVubG9ja1RpbWUpOyAgICAKCiAgICBmdW5jdGlvbiBJbnNpZ2h0c05ldHdvcmsyQmFzZSgpIHB1YmxpYyBDYXBwZWRUb2tlbigzMDAqMTAwMDAwMCpBVFRPVE9LRU5fRkFDVE9SKSB7CiAgICAgICAgcGF1c2VkID0gdHJ1ZTsKICAgICAgICBtaW50aW5nRmluaXNoZWQgPSB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGFjdGl2YXRlKGFkZHJlc3MgX3ByZWRlY2Vzc29yKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKHByZWRlY2Vzc29yID09IDApOwogICAgICAgIHJlcXVpcmUoX3ByZWRlY2Vzc29yICE9IDApOwogICAgICAgIHJlcXVpcmUocHJlZGVjZXNzb3JEZWFjdGl2YXRlZChfcHJlZGVjZXNzb3IpKTsKICAgICAgICBwcmVkZWNlc3NvciA9IF9wcmVkZWNlc3NvcjsKICAgICAgICB1bnBhdXNlKCk7CiAgICAgICAgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CiAgICB9CgogICAgZnVuY3Rpb24gbG9ja2VkQmFsYW5jZU9mKGFkZHJlc3MgYWNjb3VudCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgdWludDI1NiBhbW91bnQ7CiAgICAgICAgZm9yICh1aW50MjU2IGluZGV4ID0gMDsgaW5kZXggPCBsb2NrZWRCYWxhbmNlc1thY2NvdW50XS5sZW5ndGg7IGluZGV4KyspCiAgICAgICAgICAgIGlmICh1bmxvY2tUaW1lc1thY2NvdW50XVtpbmRleF0gPiBub3cpCiAgICAgICAgICAgICAgICBhbW91bnQgKz0gbG9ja2VkQmFsYW5jZXNbYWNjb3VudF1baW5kZXhdOwogICAgICAgIHJldHVybiBhbW91bnQ7CiAgICB9CgogICAgZnVuY3Rpb24gbWludFVubG9ja1RpbWUoYWRkcmVzcyBhY2NvdW50LCB1aW50MjU2IGFtb3VudCwgdWludDI1NiB1bmxvY2tUaW1lKSBwdWJsaWMgb25seU93bmVyIGNhbk1pbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUodW5sb2NrVGltZSA+IG5vdyk7CiAgICAgICAgcmVxdWlyZShsb2NrZWRCYWxhbmNlc1thY2NvdW50XS5sZW5ndGggPCBNQVhfUFVSQ0hBU0VTKTsKICAgICAgICBsb2NrZWRCYWxhbmNlc1thY2NvdW50XS5wdXNoKGFtb3VudCk7CiAgICAgICAgdW5sb2NrVGltZXNbYWNjb3VudF0ucHVzaCh1bmxvY2tUaW1lKTsKICAgICAgICByZXR1cm4gc3VwZXIubWludChhY2NvdW50LCBhbW91bnQpOwogICAgfQoKICAgIGZ1bmN0aW9uIG1pbnRMb2NrUGVyaW9kKGFkZHJlc3MgYWNjb3VudCwgdWludDI1NiBhbW91bnQsIHVpbnQyNTYgbG9ja1BlcmlvZCkgcHVibGljIG9ubHlPd25lciBjYW5NaW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gbWludFVubG9ja1RpbWUoYWNjb3VudCwgYW1vdW50LCBub3cgKyBsb2NrUGVyaW9kKTsKICAgIH0KCiAgICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgYWNjb3VudCwgdWludDI1NiBhbW91bnQpIHB1YmxpYyBvbmx5T3duZXIgY2FuTWludCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIG1pbnRMb2NrUGVyaW9kKGFjY291bnQsIGFtb3VudCwgMSB5ZWFycyk7CiAgICB9CgogICAgZnVuY3Rpb24gaW1wb3J0QmFsYW5jZU9mKGFkZHJlc3MgYWNjb3VudCkgcHVibGljIG9ubHlPd25lciBjYW5NaW50IHJldHVybnMgKGJvb2wpOwoKICAgIGZ1bmN0aW9uIGltcG9ydEJhbGFuY2VzT2YoYWRkcmVzc1tdIGFjY291bnRzKSBwdWJsaWMgb25seU93bmVyIGNhbk1pbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoYWNjb3VudHMubGVuZ3RoIDw9IDEwMjQpOwogICAgICAgIGZvciAodWludCBpbmRleCA9IDA7IGluZGV4IDwgYWNjb3VudHMubGVuZ3RoOyBpbmRleCsrKQogICAgICAgICAgICByZXF1aXJlKGltcG9ydEJhbGFuY2VPZihhY2NvdW50c1tpbmRleF0pKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUodmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0gLSBsb2NrZWRCYWxhbmNlT2YobXNnLnNlbmRlcikpOwogICAgICAgIHJldHVybiBzdXBlci50cmFuc2Zlcih0bywgdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZSh2YWx1ZSA8PSBiYWxhbmNlc1tmcm9tXSAtIGxvY2tlZEJhbGFuY2VPZihmcm9tKSk7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShmcm9tLCB0bywgdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNlbGZEZXN0cnVjdChhZGRyZXNzIF9zdWNjZXNzb3IpIHB1YmxpYyBvbmx5T3duZXIgd2hlblBhdXNlZCB7CiAgICAgICAgcmVxdWlyZShtaW50aW5nRmluaXNoZWQpOwogICAgICAgIHN1Y2Nlc3NvciA9IF9zdWNjZXNzb3I7CiAgICAgICAgc2VsZmRlc3RydWN0KG93bmVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwcmVkZWNlc3NvckRlYWN0aXZhdGVkKGFkZHJlc3MgX3ByZWRlY2Vzc29yKSBpbnRlcm5hbCBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCk7Cgp9CgovLyBGaWxlOiBjb250cmFjdHMvSW5zaWdodHNOZXR3b3JrMi5zb2wKCmNvbnRyYWN0IEluc2lnaHRzTmV0d29yazIgaXMgSW5zaWdodHNOZXR3b3JrMkJhc2UgewoKICAgIGZ1bmN0aW9uIGltcG9ydEJhbGFuY2VPZihhZGRyZXNzIGFjY291bnQpIHB1YmxpYyBvbmx5T3duZXIgY2FuTWludCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZSghaW1wb3J0ZWRbYWNjb3VudF0pOwogICAgICAgIHVpbnQyNTYgYW1vdW50ID0gSW5zaWdodHNOZXR3b3JrMShwcmVkZWNlc3NvcikuYmFsYW5jZXMoYWNjb3VudCkqQVRUT1RPS0VOX0ZBQ1RPUjsKICAgICAgICByZXF1aXJlKGFtb3VudCA+IDApOwogICAgICAgIHVpbnQyNTYgdW5sb2NrVGltZSA9IEluc2lnaHRzTmV0d29yazEocHJlZGVjZXNzb3IpLnVubG9ja1RpbWVzKGFjY291bnQpOwogICAgICAgIGltcG9ydGVkW2FjY291bnRdID0gdHJ1ZTsKICAgICAgICBJbXBvcnQoYWNjb3VudCwgYW1vdW50LCB1bmxvY2tUaW1lKTsKICAgICAgICByZXR1cm4gbWludFVubG9ja1RpbWUoYWNjb3VudCwgYW1vdW50LCB1bmxvY2tUaW1lKTsKICAgIH0KCiAgICBmdW5jdGlvbiByZWxvY2soYWRkcmVzcyBhY2NvdW50LCB1aW50MjU2IGFtb3VudCwgdWludDI1NiBvbGRVbmxvY2tUaW1lLCBpbnQyNTYgbG9ja1BlcmlvZCkgcHVibGljIG9ubHlPd25lciBjYW5NaW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICAvLyBSZWxvY2sgdG9rZW5zIGZvciBnaXZlbiBwZXJpb2QsIGRlZmF1bHRpbmcgdG8gMSB5ZWFyCiAgICAgICAgaWYgKGxvY2tQZXJpb2QgPCAwKQogICAgICAgICAgICBsb2NrUGVyaW9kID0gMSB5ZWFyczsKICAgICAgICBmb3IgKHVpbnQgaW5kZXggPSAwOyBpbmRleCA8IGxvY2tlZEJhbGFuY2VzW2FjY291bnRdLmxlbmd0aDsgaW5kZXgrKykKICAgICAgICAgICAgaWYgKGxvY2tlZEJhbGFuY2VzW2FjY291bnRdW2luZGV4XSA9PSBhbW91bnQgJiYgdW5sb2NrVGltZXNbYWNjb3VudF1baW5kZXhdID09IG9sZFVubG9ja1RpbWUpIHsKICAgICAgICAgICAgICAgIHVubG9ja1RpbWVzW2FjY291bnRdW2luZGV4XSA9IG5vdyArIHVpbnQyNTYobG9ja1BlcmlvZCk7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBmdW5jdGlvbiByZWxvY2tQYXJ0KGFkZHJlc3MgYWNjb3VudCwgdWludDI1NiBhbW91bnQsIHVpbnQyNTYgdW5sb2NrVGltZSwgdWludDI1NiBwYXJ0QW1vdW50LCBpbnQyNTYgcGFydExvY2tQZXJpb2QpIHB1YmxpYyBvbmx5T3duZXIgY2FuTWludCByZXR1cm5zIChib29sKSB7CiAgICAgICAgLy8gUmVsb2NrIHBhcnQgb2YgbWF0Y2hpbmcgdG9rZW4gYmFsYW5jZSBmb3IgZ2l2ZW4gcGVyaW9kLCBkZWZhdWx0aW5nIHRvIDEgeWVhcgogICAgICAgIHJlcXVpcmUocGFydEFtb3VudCA+IDApOwogICAgICAgIHJlcXVpcmUocGFydEFtb3VudCA8IGFtb3VudCk7CiAgICAgICAgaWYgKHBhcnRMb2NrUGVyaW9kIDwgMCkKICAgICAgICAgICAgcGFydExvY2tQZXJpb2QgPSAxIHllYXJzOwogICAgICAgIGZvciAodWludCBpbmRleCA9IDA7IGluZGV4IDwgbG9ja2VkQmFsYW5jZXNbYWNjb3VudF0ubGVuZ3RoOyBpbmRleCsrKQogICAgICAgICAgICBpZiAobG9ja2VkQmFsYW5jZXNbYWNjb3VudF1baW5kZXhdID09IGFtb3VudCAmJiB1bmxvY2tUaW1lc1thY2NvdW50XVtpbmRleF0gPT0gdW5sb2NrVGltZSkgewogICAgICAgICAgICAgICAgbG9ja2VkQmFsYW5jZXNbYWNjb3VudF1baW5kZXhdIC09IHBhcnRBbW91bnQ7CiAgICAgICAgICAgICAgICBsb2NrZWRCYWxhbmNlc1thY2NvdW50XS5wdXNoKHBhcnRBbW91bnQpOwogICAgICAgICAgICAgICAgdW5sb2NrVGltZXNbYWNjb3VudF0ucHVzaChub3cgKyB1aW50MjU2KHBhcnRMb2NrUGVyaW9kKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBmdW5jdGlvbiBwcmVkZWNlc3NvckRlYWN0aXZhdGVkKGFkZHJlc3MgX3ByZWRlY2Vzc29yKSBpbnRlcm5hbCBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiAhSW5zaWdodHNOZXR3b3JrMShfcHJlZGVjZXNzb3IpLmFjdGl2ZSgpOwogICAgfQoKfQ=='.
	

]
