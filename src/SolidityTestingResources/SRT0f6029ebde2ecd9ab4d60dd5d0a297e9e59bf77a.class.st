Class {
	#name : #SRT0f6029ebde2ecd9ab4d60dd5d0a297e9e59bf77a,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT0f6029ebde2ecd9ab4d60dd5d0a297e9e59bf77a >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHsKICAgIGlmIChuZXdPd25lciAhPSBhZGRyZXNzKDApKSB7CiAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICB9CiAgfQoKfQoKCi8qKgogKiBAdGl0bGUgU2FmZU1hdGgKICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCmxpYnJhcnkgU2FmZU1hdGggewogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgoKLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5CiAqLwpjb250cmFjdCBFUkMyMEJhc2ljIHsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgoKCgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKCmNvbnRyYWN0IERyYWluYWJsZSBpcyBPd25hYmxlIHsKCWZ1bmN0aW9uIHdpdGhkcmF3VG9rZW4oYWRkcmVzcyB0b2tlbmFkZHIpIAoJCW9ubHlPd25lciAKCXsKCQlFUkMyMCB0b2tlbiA9IEVSQzIwKHRva2VuYWRkcik7CgkJdWludCBiYWwgPSB0b2tlbi5iYWxhbmNlT2YoYWRkcmVzcyh0aGlzKSk7CgkJdG9rZW4udHJhbnNmZXIobXNnLnNlbmRlciwgYmFsKTsKCX0KCglmdW5jdGlvbiB3aXRoZHJhd0V0aGVyKCkgCgkJb25seU93bmVyCgl7CgkgICAgcmVxdWlyZShtc2cuc2VuZGVyLnNlbmQodGhpcy5iYWxhbmNlKSk7Cgl9Cn0KCgpjb250cmFjdCBBRFhSZWdpc3RyeSBpcyBPd25hYmxlLCBEcmFpbmFibGUgewoJc3RyaW5nIHB1YmxpYyBuYW1lID0gIkFkRXggUmVnaXN0cnkiOwoKCS8vIFN0cnVjdHVyZToKCS8vIEFkVW5pdCAoYWR2ZXJ0aXNlcikgLSBhIHVuaXQgb2YgYSBzaW5nbGUgYWR2ZXJ0aXNlbWVudAoJLy8gQWRTbG90IChwdWJsaXNoZXIpIC0gYSBwYXJ0aWN1bGFyIHByb3BlcnR5IChzbG90KSB0aGF0IGNhbiBkaXNwbGF5IGFuIGFkIHVuaXQKCS8vIENhbXBhaWduIChhZHZlcnRpc2VyKSAtIGdyb3VwIG9mIGFkIHVuaXRzIDsgbm90IHZpdGFsCgkvLyBDaGFubmVsIChwdWJsaXNoZXIpIC0gZ3JvdXAgb2YgcHJvcGVydGllcyA7IG5vdCB2aXRhbAoJLy8gRWFjaCBBY2NvdW50IGlzIGxpbmtlZCB0byBhbGwgdGhlIGl0ZW1zIHRoZXkgb3duIHRocm91Z2ggdGhlIEFjY291bnQgc3RydWN0CgoJbWFwcGluZyAoYWRkcmVzcyA9PiBBY2NvdW50KSBwdWJsaWMgYWNjb3VudHM7CgoJLy8gWFhYOiBtb3N0bHkgdW51c2VkLCBiZWNhdXNlIHNvbGlkaXR5IGRvZXMgbm90IGFsbG93IG1hcHBpbmcgd2l0aCBlbnVtIGFzIHByaW1hcnkgdHlwZS4uIDooIHdlIGp1c3QgdXNlIHVpbnQKCWVudW0gSXRlbVR5cGUgeyBBZFVuaXQsIEFkU2xvdCwgQ2FtcGFpZ24sIENoYW5uZWwgfQoKCS8vIHVpbnQgaGVyZSBjb3JyZXNwb25kcyB0byB0aGUgSXRlbVR5cGUKCW1hcHBpbmcgKHVpbnQgPT4gdWludCkgcHVibGljIGNvdW50czsKCW1hcHBpbmcgKHVpbnQgPT4gbWFwcGluZyAodWludCA9PiBJdGVtKSkgcHVibGljIGl0ZW1zOwoKCS8vIFB1Ymxpc2hlciBvciBBZHZlcnRpc2VyIChjb3VsZCBiZSBib3RoKQoJc3RydWN0IEFjY291bnQgewkJCgkJYWRkcmVzcyBhZGRyOwoJCWFkZHJlc3Mgd2FsbGV0OwoKCQlieXRlczMyIGlwZnM7IC8vIGlwZnMgYWRkciBmb3IgYWRkaXRpb25hbCAobGFyZ2VyKSBtZXRhCgkJYnl0ZXMzMiBuYW1lOyAvLyBuYW1lCgkJYnl0ZXMzMiBtZXRhOyAvLyBtZXRhZGF0YSwgY2FuIGJlIEpTT04sIGNhbiBiZSBvdGhlciBmb3JtYXQsIGRlcGVuZHMgb24gdGhlIGhpZ2gtbGV2ZWwgaW1wbGVtZW50YXRpb24KCgkJYnl0ZXMzMiBzaWduYXR1cmU7IC8vIHNpZ25hdHVyZSBpbiB0aGUgb2ZmLWJsb2NrY2hhaW4gc3RhdGUgY2hhbm5lbAoJCQoJCS8vIEl0ZW1zLCBieSB0eXBlLCB0aGVuIGluIGFuIGFycmF5IG9mIG51bWVyaWMgSURzCQoJCW1hcHBpbmcgKHVpbnQgPT4gdWludFtdKSBpdGVtczsKCX0KCgkvLyBTdWItaXRlbSwgc3VjaCBhcyBBZFVuaXQsIEFkU2xvdCwgQ2FtcGFpZ24sIENoYW5uZWwKCXN0cnVjdCBJdGVtIHsKCQl1aW50IGlkOwoJCWFkZHJlc3Mgb3duZXI7CgoJCUl0ZW1UeXBlIGl0ZW1UeXBlOwoKCQlieXRlczMyIGlwZnM7IC8vIGlwZnMgYWRkciBmb3IgYWRkaXRpb25hbCAobGFyZ2VyKSBtZXRhCgkJYnl0ZXMzMiBuYW1lOyAvLyBuYW1lCgkJYnl0ZXMzMiBtZXRhOyAvLyBtZXRhZGF0YSwgY2FuIGJlIEpTT04sIGNhbiBiZSBvdGhlciBmb3JtYXQsIGRlcGVuZHMgb24gdGhlIGhpZ2gtbGV2ZWwgaW1wbGVtZW50YXRpb24KCX0KCgltb2RpZmllciBvbmx5UmVnaXN0ZXJlZCgpIHsKCQl2YXIgYWNjID0gYWNjb3VudHNbbXNnLnNlbmRlcl07CgkJcmVxdWlyZShhY2MuYWRkciAhPSAwKTsKCQlfOwoJfQoKCS8vIGNhbiBiZSBjYWxsZWQgb3ZlciBhbmQgb3ZlciB0byB1cGRhdGUgdGhlIGRhdGEKCS8vIFhYWCBjb25zaWRlciBlbnRyYW5jZSBiYXJyaWVyLCBzdWNoIGFzIGxvY2tpbmcgaW4gc29tZSBBRFgKCWZ1bmN0aW9uIHJlZ2lzdGVyKGJ5dGVzMzIgX25hbWUsIGFkZHJlc3MgX3dhbGxldCwgYnl0ZXMzMiBfaXBmcywgYnl0ZXMzMiBfc2lnLCBieXRlczMyIF9tZXRhKQoJCWV4dGVybmFsCgl7CgkJcmVxdWlyZShfd2FsbGV0ICE9IDApOwoJCS8vIFhYWCBzaG91bGQgd2UgZW5zdXJlIF9zaWcgaXMgbm90IDA/IGlmIHNvLCBhbHNvIGFkZCB0ZXN0CgkJCgkJcmVxdWlyZShfbmFtZSAhPSAwKTsKCgkJdmFyIGlzTmV3ID0gYWNjb3VudHNbbXNnLnNlbmRlcl0uYWRkciA9PSAwOwoKCQl2YXIgYWNjID0gYWNjb3VudHNbbXNnLnNlbmRlcl07CgoJCWlmICghaXNOZXcpIHJlcXVpcmUoYWNjLnNpZ25hdHVyZSA9PSBfc2lnKTsKCQllbHNlIGFjYy5zaWduYXR1cmUgPSBfc2lnOwoKCQlhY2MuYWRkciA9IG1zZy5zZW5kZXI7CgkJYWNjLndhbGxldCA9IF93YWxsZXQ7CgkJYWNjLmlwZnMgPSBfaXBmczsKCQlhY2MubmFtZSA9IF9uYW1lOwoJCWFjYy5tZXRhID0gX21ldGE7CgoJCWlmIChpc05ldykgTG9nQWNjb3VudFJlZ2lzdGVyZWQoYWNjLmFkZHIsIGFjYy53YWxsZXQsIGFjYy5pcGZzLCBhY2MubmFtZSwgYWNjLm1ldGEsIGFjYy5zaWduYXR1cmUpOwoJCWVsc2UgTG9nQWNjb3VudE1vZGlmaWVkKGFjYy5hZGRyLCBhY2Mud2FsbGV0LCBhY2MuaXBmcywgYWNjLm5hbWUsIGFjYy5tZXRhLCBhY2Muc2lnbmF0dXJlKTsKCX0KCgkvLyB1c2UgX2lkID0gMCB0byBjcmVhdGUgYSBuZXcgaXRlbSwgb3RoZXJ3aXNlIG1vZGlmeSBleGlzdGluZwoJZnVuY3Rpb24gcmVnaXN0ZXJJdGVtKHVpbnQgX3R5cGUsIHVpbnQgX2lkLCBieXRlczMyIF9pcGZzLCBieXRlczMyIF9uYW1lLCBieXRlczMyIF9tZXRhKQoJCW9ubHlSZWdpc3RlcmVkCgl7CgkJLy8gWFhYIF90eXBlIHNhbml0eSBjaGVjaz8KCQl2YXIgaXRlbSA9IGl0ZW1zW190eXBlXVtfaWRdOwoKCQlpZiAoX2lkICE9IDApCgkJCXJlcXVpcmUoaXRlbS5vd25lciA9PSBtc2cuc2VuZGVyKTsKCQllbHNlIHsKCQkJLy8gWFhYOiB3aGF0IGFib3V0IG92ZXJmbG93IGhlcmU/CgkJCXZhciBuZXdJZCA9ICsrY291bnRzW190eXBlXTsKCgkJCWl0ZW0gPSBpdGVtc1tfdHlwZV1bbmV3SWRdOwoJCQlpdGVtLmlkID0gbmV3SWQ7CgkJCWl0ZW0uaXRlbVR5cGUgPSBJdGVtVHlwZShfdHlwZSk7CgkJCWl0ZW0ub3duZXIgPSBtc2cuc2VuZGVyOwoKCQkJYWNjb3VudHNbbXNnLnNlbmRlcl0uaXRlbXNbX3R5cGVdLnB1c2goaXRlbS5pZCk7CgkJfQoKCQlpdGVtLm5hbWUgPSBfbmFtZTsKCQlpdGVtLm1ldGEgPSBfbWV0YTsKCQlpdGVtLmlwZnMgPSBfaXBmczsKCgkJaWYgKF9pZCA9PSAwKSBMb2dJdGVtUmVnaXN0ZXJlZCgKCQkJaXRlbS5vd25lciwgdWludChpdGVtLml0ZW1UeXBlKSwgaXRlbS5pZCwgaXRlbS5pcGZzLCBpdGVtLm5hbWUsIGl0ZW0ubWV0YQoJCSk7CgkJZWxzZSBMb2dJdGVtTW9kaWZpZWQoCgkJCWl0ZW0ub3duZXIsIHVpbnQoaXRlbS5pdGVtVHlwZSksIGl0ZW0uaWQsIGl0ZW0uaXBmcywgaXRlbS5uYW1lLCBpdGVtLm1ldGEKCQkpOwoJfQoKCS8vIE5PVEUKCS8vIFRoZXJlJ3Mgbm8gcmVhbCBwb2ludCBvZiB1bi1yZWdpc3RlcmluZyBpdGVtcwoJLy8gQ2FtcGFpZ25zIG5lZWQgdG8gYmUga2VwdCBhbnl3YXksIGFzIHdlbGwgYXMgYWQgdW5pdHMKCS8vIEVORCBOT1RFCgoJLy8KCS8vIENvbnN0YW50IGZ1bmN0aW9ucwoJLy8KCWZ1bmN0aW9uIGlzUmVnaXN0ZXJlZChhZGRyZXNzIHdobykKCQlwdWJsaWMgCgkJY29uc3RhbnQKCQlyZXR1cm5zIChib29sKQoJewoJCXZhciBhY2MgPSBhY2NvdW50c1t3aG9dOwoJCXJldHVybiBhY2MuYWRkciAhPSAwOwoJfQoKCS8vIEZ1bmN0aW9ucyBleHBvc2VkIGZvciB3ZWIzIGludGVyZmFjZQoJLy8gTk9URTogdGhpcyBpcyBzdGlja2luZyB0byB0aGUgcG9saWN5IG9mIGtlZXBpbmcgc3RhdGljLXNpemVkIHZhbHVlcyBhdCB0aGUgbGVmdCBzaWRlIG9mIHR1cGxlcwoJZnVuY3Rpb24gZ2V0QWNjb3VudChhZGRyZXNzIF9hY2MpCgkJY29uc3RhbnQKCQlwdWJsaWMKCQlyZXR1cm5zIChhZGRyZXNzLCBieXRlczMyLCBieXRlczMyLCBieXRlczMyKQoJewoJCXZhciBhY2MgPSBhY2NvdW50c1tfYWNjXTsKCQlyZXF1aXJlKGFjYy5hZGRyICE9IDApOwoJCXJldHVybiAoYWNjLndhbGxldCwgYWNjLmlwZnMsIGFjYy5uYW1lLCBhY2MubWV0YSk7Cgl9CgoJZnVuY3Rpb24gZ2V0QWNjb3VudEl0ZW1zKGFkZHJlc3MgX2FjYywgdWludCBfdHlwZSkKCQljb25zdGFudAoJCXB1YmxpYwoJCXJldHVybnMgKHVpbnRbXSkKCXsKCQl2YXIgYWNjID0gYWNjb3VudHNbX2FjY107CgkJcmVxdWlyZShhY2MuYWRkciAhPSAwKTsKCQlyZXR1cm4gYWNjLml0ZW1zW190eXBlXTsKCX0KCglmdW5jdGlvbiBnZXRJdGVtKHVpbnQgX3R5cGUsIHVpbnQgX2lkKSAKCQljb25zdGFudAoJCXB1YmxpYwoJCXJldHVybnMgKGFkZHJlc3MsIGJ5dGVzMzIsIGJ5dGVzMzIsIGJ5dGVzMzIpCgl7CgkJdmFyIGl0ZW0gPSBpdGVtc1tfdHlwZV1bX2lkXTsKCQlyZXF1aXJlKGl0ZW0uaWQgIT0gMCk7CgkJcmV0dXJuIChpdGVtLm93bmVyLCBpdGVtLmlwZnMsIGl0ZW0ubmFtZSwgaXRlbS5tZXRhKTsKCX0KCglmdW5jdGlvbiBoYXNJdGVtKHVpbnQgX3R5cGUsIHVpbnQgX2lkKQoJCWNvbnN0YW50CgkJcHVibGljCgkJcmV0dXJucyAoYm9vbCkKCXsKCQl2YXIgaXRlbSA9IGl0ZW1zW190eXBlXVtfaWRdOwoJCXJldHVybiBpdGVtLmlkICE9IDA7Cgl9CgoJLy8gRXZlbnRzCglldmVudCBMb2dBY2NvdW50UmVnaXN0ZXJlZChhZGRyZXNzIGFkZHIsIGFkZHJlc3Mgd2FsbGV0LCBieXRlczMyIGlwZnMsIGJ5dGVzMzIgYWNjb3VudE5hbWUsIGJ5dGVzMzIgbWV0YSwgYnl0ZXMzMiBzaWduYXR1cmUpOwoJZXZlbnQgTG9nQWNjb3VudE1vZGlmaWVkKGFkZHJlc3MgYWRkciwgYWRkcmVzcyB3YWxsZXQsIGJ5dGVzMzIgaXBmcywgYnl0ZXMzMiBhY2NvdW50TmFtZSwgYnl0ZXMzMiBtZXRhLCBieXRlczMyIHNpZ25hdHVyZSk7CgkKCWV2ZW50IExvZ0l0ZW1SZWdpc3RlcmVkKGFkZHJlc3Mgb3duZXIsIHVpbnQgaXRlbVR5cGUsIHVpbnQgaWQsIGJ5dGVzMzIgaXBmcywgYnl0ZXMzMiBpdGVtTmFtZSwgYnl0ZXMzMiBtZXRhKTsKCWV2ZW50IExvZ0l0ZW1Nb2RpZmllZChhZGRyZXNzIG93bmVyLCB1aW50IGl0ZW1UeXBlLCB1aW50IGlkLCBieXRlczMyIGlwZnMsIGJ5dGVzMzIgaXRlbU5hbWUsIGJ5dGVzMzIgbWV0YSk7Cn0KCgpjb250cmFjdCBBRFhFeGNoYW5nZSBpcyBPd25hYmxlLCBEcmFpbmFibGUgewoJc3RyaW5nIHB1YmxpYyBuYW1lID0gIkFkRXggRXhjaGFuZ2UiOwoKCUVSQzIwIHB1YmxpYyB0b2tlbjsKCUFEWFJlZ2lzdHJ5IHB1YmxpYyByZWdpc3RyeTsKCgl1aW50IHB1YmxpYyBiaWRzQ291bnQ7CgoJbWFwcGluZyAodWludCA9PiBCaWQpIGJpZHNCeUlkOwoJbWFwcGluZyAodWludCA9PiB1aW50W10pIGJpZHNCeUFkdW5pdDsgLy8gYmlkcyBzZXQgb3V0IGJ5IGFkIHVuaXQKCW1hcHBpbmcgKHVpbnQgPT4gdWludFtdKSBiaWRzQnlBZHNsb3Q7IC8vIGFjY2VwdGVkIGJ5IHB1Ymxpc2hlciwgYnkgYWQgc2xvdAoKCS8vIFRPRE86IHNvbWUgcHJvcGVydGllcyBpbiB0aGUgYmlkIHN0cnVjdHVyZSAtIGFjaGlldmVkUG9pbnRzL3BlZXJzIGZvciBleGFtcGxlIC0gYXJlIG5vdCB1c2VkIGF0bQoJCgkvLyBDT05TSURFUjogdGhlIGJpZCBoYXZpbmcgYSBhZHVuaXRUeXBlIHNvIHRoYXQgdGhpcyBjYW4gYmUgZmlsdGVyZWQgb3V0CgkvLyBXSFkgSVQnUyBOT1QgSU1QT1JUQU5UOiB5b3UgY2FuIGdldCBiaWRzIGJ5IGFkIHVuaXRzIC8gYWQgc2xvdHMsIHdoaWNoIGlzIGZpbHRlciBlbm91Z2ggYWxyZWFkeSBjb25zaWRlcmluZyB3ZSBrbm93IHRoZWlyIHR5cGVzCgoJLy8gQ09OU0lERVI6IGxvY2tpbmcgYWQgdW5pdHMgLyBhZCBzbG90cyBvciBjZXJ0YWluIHByb3BlcnRpZXMgZnJvbSB0aGVtIHNvIHRoYXQgYmlkcyBjYW5ub3QgYmUgcnVpbmVkIGJ5IGVkaXRpbmcgdGhlbQoJLy8gV0hZIElUJ1MgTk9UIElNUE9SVEFOVDogZnJvbSBhIGdhbWUgdGhlb3JldGljYWwgcG9pbnQgb2YgdmlldyB0aGVyZSdzIG5vIGluY2VudGl2ZSB0byBkbyB0aGF0CgoJLy8gY29ycmVzcG9uZHMgdG8gZW51bSB0eXBlcyBpbiBBRFhSZWdpc3RyeQoJdWludCBjb25zdGFudCBBRFVOSVQgPSAwOwoJdWludCBjb25zdGFudCBBRFNMT1QgPSAxOwoKCWVudW0gQmlkU3RhdGUgeyAKCQlPcGVuLCAKCQlBY2NlcHRlZCwgLy8gaW4gcHJvZ3Jlc3MKCgkJLy8gdGhlIGZvbGxvd2luZyBzdGF0ZXMgTVVTVCB1bmxvY2sgdGhlIEFEWCBhbW91bnQgKHJldHVybiB0byBhZHZlcnRpc2VyKQoJCS8vIGZhaWwgc3RhdGVzCgkJQ2FuY2VsZWQsCgkJRXhwaXJlZCwKCgkJLy8gc3VjY2VzcyBzdGF0ZXMKCQlDb21wbGV0ZWQsCgkJQ2xhaW1lZAoJfQoKCXN0cnVjdCBCaWQgewoJCXVpbnQgaWQ7CgkJQmlkU3RhdGUgc3RhdGU7CgoJCS8vIEFEWCByZXdhcmQgYW1vdW50CgkJdWludCBhbW91bnQ7CgoJCS8vIExpbmtzIG9uIGFkdmVydGlzZXIgc2lkZQoJCWFkZHJlc3MgYWR2ZXJ0aXNlcjsKCQlhZGRyZXNzIGFkdmVydGlzZXJXYWxsZXQ7CgkJdWludCBhZFVuaXQ7CgkJYnl0ZXMzMiBhZFVuaXRJcGZzOwoJCWJ5dGVzMzIgYWR2ZXJ0aXNlclBlZXI7CgoJCS8vIExpbmtzIG9uIHB1Ymxpc2hlciBzaWRlCgkJYWRkcmVzcyBwdWJsaXNoZXI7CgkJYWRkcmVzcyBwdWJsaXNoZXJXYWxsZXQ7CgkJdWludCBhZFNsb3Q7CgkJYnl0ZXMzMiBhZFNsb3RJcGZzOwoJCWJ5dGVzMzIgcHVibGlzaGVyUGVlcjsKCgkJdWludCBhY2NlcHRlZFRpbWU7IC8vIHdoZW4gd2FzIGl0IGFjY2VwdGVkIGJ5IGEgcHVibGlzaGVyCgoJCS8vIFJlcXVpcmVtZW50cwoKCQkvL1JlcXVpcmVtZW50VHlwZSB0eXBlOwoJCXVpbnQgcmVxdWlyZWRQb2ludHM7IC8vIGhvdyBtYW55IGltcHJlc3Npb25zL2NsaWNrcy9jb252ZXJzaW9ucyBoYXZlIHRvIGJlIGRvbmUKCQl1aW50IHJlcXVpcmVkRXhlY1RpbWU7IC8vIGVzc2VudGlhbGx5IGEgdGltZW91dAoKCQkvLyBSZXN1bHRzCgkJYm9vbCBjb25maXJtZWRCeVB1Ymxpc2hlcjsKCQlib29sIGNvbmZpcm1lZEJ5QWR2ZXJ0aXNlcjsKCgkJLy8gSVBGUyBsaW5rcyB0byByZXN1bHQgcmVwb3J0cyAKCQlieXRlczMyIHB1Ymxpc2hlclJlcG9ydElwZnM7CgkJYnl0ZXMzMiBhZHZlcnRpc2VyUmVwb3J0SXBmczsKCX0KCgkvLwoJLy8gTU9ESUZJRVJTCgkvLwoJbW9kaWZpZXIgb25seVJlZ2lzdGVyZWRBY2MoKSB7CgkJcmVxdWlyZShyZWdpc3RyeS5pc1JlZ2lzdGVyZWQobXNnLnNlbmRlcikpOwoJCV87Cgl9CgoJbW9kaWZpZXIgb25seUJpZE93bmVyKHVpbnQgX2JpZElkKSB7CgkJcmVxdWlyZShtc2cuc2VuZGVyID09IGJpZHNCeUlkW19iaWRJZF0uYWR2ZXJ0aXNlcik7CgkJXzsKCX0KCgltb2RpZmllciBvbmx5QmlkQWNlcHRlZSh1aW50IF9iaWRJZCkgewoJCXJlcXVpcmUobXNnLnNlbmRlciA9PSBiaWRzQnlJZFtfYmlkSWRdLnB1Ymxpc2hlcik7CgkJXzsKCX0KCgltb2RpZmllciBvbmx5QmlkU3RhdGUodWludCBfYmlkSWQsIEJpZFN0YXRlIF9zdGF0ZSkgewoJCXJlcXVpcmUoYmlkc0J5SWRbX2JpZElkXS5pZCAhPSAwKTsKCQlyZXF1aXJlKGJpZHNCeUlkW19iaWRJZF0uc3RhdGUgPT0gX3N0YXRlKTsKCQlfOwoJfQoKCW1vZGlmaWVyIG9ubHlFeGlzdGluZ0JpZCh1aW50IF9iaWRJZCkgewoJCXJlcXVpcmUoYmlkc0J5SWRbX2JpZElkXS5pZCAhPSAwKTsKCQlfOwoJfQoKCS8vIEZ1bmN0aW9ucwoKCWZ1bmN0aW9uIEFEWEV4Y2hhbmdlKGFkZHJlc3MgX3Rva2VuLCBhZGRyZXNzIF9yZWdpc3RyeSkKCXsKCQl0b2tlbiA9IEVSQzIwKF90b2tlbik7CgkJcmVnaXN0cnkgPSBBRFhSZWdpc3RyeShfcmVnaXN0cnkpOwoJfQoKCS8vCgkvLyBCaWQgYWN0aW9ucwoJLy8gCgoJLy8gdGhlIGJpZCBpcyBwbGFjZWQgYnkgdGhlIGFkdmVydGlzZXIKCWZ1bmN0aW9uIHBsYWNlQmlkKHVpbnQgX2FkdW5pdElkLCB1aW50IF90YXJnZXQsIHVpbnQgX3Jld2FyZEFtb3VudCwgdWludCBfdGltZW91dCwgYnl0ZXMzMiBfcGVlcikKCQlvbmx5UmVnaXN0ZXJlZEFjYwoJewoJCWJ5dGVzMzIgYWRJcGZzOwoJCWFkZHJlc3MgYWR2ZXJ0aXNlcjsKCQlhZGRyZXNzIGFkdmVydGlzZXJXYWxsZXQ7CgoJCS8vIE5PVEU6IHRob3NlIHdpbGwgdGhyb3cgaWYgdGhlIGFkIG9yIHJlc3BlY3RpdmVseSB0aGUgYWNjb3VudCBkbyBub3QgZXhpc3QKCQkoYWR2ZXJ0aXNlcixhZElwZnMsLCkgPSByZWdpc3RyeS5nZXRJdGVtKEFEVU5JVCwgX2FkdW5pdElkKTsKCQkoYWR2ZXJ0aXNlcldhbGxldCwsLCkgPSByZWdpc3RyeS5nZXRBY2NvdW50KGFkdmVydGlzZXIpOwoKCQkvLyBYWFg6IG1heWJlIGl0IGNvdWxkIGJlIGEgZmVhdHVyZSB0byBhbGxvdyBhZHZlcnRpc2VycyBiaWRkaW5nIG9uIG90aGVyIGFkdmVydGlzZXJzJyBhZCB1bml0cywgYnV0IGl0IHdpbGwgY29tcGxpY2F0ZSB0aGluZ3MuLi4KCQlyZXF1aXJlKGFkdmVydGlzZXIgPT0gbXNnLnNlbmRlcik7CgoJCUJpZCBtZW1vcnkgYmlkOwoKCQliaWQuaWQgPSArK2JpZHNDb3VudDsgLy8gc3RhcnQgZnJvbSAxLCBzbyB0aGF0IDAgaXMgbm90IGEgdmFsaWQgSUQKCQliaWQuc3RhdGUgPSBCaWRTdGF0ZS5PcGVuOyAvLyBYWFggcmVkdW5kYW50LCBidXQgZG9uZSBmb3IgY29kZSBjbGFyaXR5CgoJCWJpZC5hbW91bnQgPSBfcmV3YXJkQW1vdW50OwoKCQliaWQuYWR2ZXJ0aXNlciA9IGFkdmVydGlzZXI7CgkJYmlkLmFkdmVydGlzZXJXYWxsZXQgPSBhZHZlcnRpc2VyV2FsbGV0OwoKCQliaWQuYWRVbml0ID0gX2FkdW5pdElkOwoJCWJpZC5hZFVuaXRJcGZzID0gYWRJcGZzOwoKCQliaWQucmVxdWlyZWRQb2ludHMgPSBfdGFyZ2V0OwoJCWJpZC5yZXF1aXJlZEV4ZWNUaW1lID0gX3RpbWVvdXQ7CgoJCWJpZC5hZHZlcnRpc2VyUGVlciA9IF9wZWVyOwoKCQliaWRzQnlJZFtiaWQuaWRdID0gYmlkOwoJCWJpZHNCeUFkdW5pdFtfYWR1bml0SWRdLnB1c2goYmlkLmlkKTsKCgkJcmVxdWlyZSh0b2tlbi50cmFuc2ZlckZyb20oYWR2ZXJ0aXNlcldhbGxldCwgYWRkcmVzcyh0aGlzKSwgX3Jld2FyZEFtb3VudCkpOwoKCQlMb2dCaWRPcGVuZWQoYmlkLmlkLCBhZHZlcnRpc2VyLCBfYWR1bml0SWQsIGFkSXBmcywgX3RhcmdldCwgX3Jld2FyZEFtb3VudCwgX3RpbWVvdXQsIF9wZWVyKTsKCX0KCgkvLyB0aGUgYmlkIGlzIGNhbmNlbGVkIGJ5IHRoZSBhZHZlcnRpc2VyCglmdW5jdGlvbiBjYW5jZWxCaWQodWludCBfYmlkSWQpCgkJb25seVJlZ2lzdGVyZWRBY2MKCQlvbmx5RXhpc3RpbmdCaWQoX2JpZElkKQoJCW9ubHlCaWRPd25lcihfYmlkSWQpCgkJb25seUJpZFN0YXRlKF9iaWRJZCwgQmlkU3RhdGUuT3BlbikKCXsKCQlCaWQgc3RvcmFnZSBiaWQgPSBiaWRzQnlJZFtfYmlkSWRdOwoJCWJpZC5zdGF0ZSA9IEJpZFN0YXRlLkNhbmNlbGVkOwoJCXJlcXVpcmUodG9rZW4udHJhbnNmZXIoYmlkLmFkdmVydGlzZXJXYWxsZXQsIGJpZC5hbW91bnQpKTsKCgkJTG9nQmlkQ2FuY2VsZWQoYmlkLmlkKTsKCX0KCgkvLyBhIGJpZCBpcyBhY2NlcHRlZCBieSBhIHB1Ymxpc2hlciBmb3IgYSBnaXZlbiBhZCBzbG90CglmdW5jdGlvbiBhY2NlcHRCaWQodWludCBfYmlkSWQsIHVpbnQgX3Nsb3RJZCwgYnl0ZXMzMiBfcGVlcikgCgkJb25seVJlZ2lzdGVyZWRBY2MgCgkJb25seUV4aXN0aW5nQmlkKF9iaWRJZCkgCgkJb25seUJpZFN0YXRlKF9iaWRJZCwgQmlkU3RhdGUuT3BlbikKCXsKCQlhZGRyZXNzIHB1Ymxpc2hlcjsKCQlhZGRyZXNzIHB1Ymxpc2hlcldhbGxldDsKCQlieXRlczMyIGFkU2xvdElwZnM7CgoJCS8vIE5PVEU6IHRob3NlIHdpbGwgdGhyb3cgaWYgdGhlIGFkIHNsb3Qgb3IgcmVzcGVjdGl2ZWx5IHRoZSBhY2NvdW50IGRvIG5vdCBleGlzdAoJCShwdWJsaXNoZXIsYWRTbG90SXBmcywsKSA9IHJlZ2lzdHJ5LmdldEl0ZW0oQURTTE9ULCBfc2xvdElkKTsKCQkocHVibGlzaGVyV2FsbGV0LCwsKSA9IHJlZ2lzdHJ5LmdldEFjY291bnQocHVibGlzaGVyKTsKCgkJcmVxdWlyZShwdWJsaXNoZXIgPT0gbXNnLnNlbmRlcik7CgoJCUJpZCBzdG9yYWdlIGJpZCA9IGJpZHNCeUlkW19iaWRJZF07CgoJCS8vIHNob3VsZCBub3QgaGFwcGVuIHdoZW4gYmlkLnN0YXRlIGlzIEJpZFN0YXRlLk9wZW4sIGJ1dCBqdXN0IGluIGNhc2UKCQlyZXF1aXJlKGJpZC5wdWJsaXNoZXIgPT0gMCk7CgoJCWJpZC5zdGF0ZSA9IEJpZFN0YXRlLkFjY2VwdGVkOwoJCQoJCWJpZC5wdWJsaXNoZXIgPSBwdWJsaXNoZXI7CgkJYmlkLnB1Ymxpc2hlcldhbGxldCA9IHB1Ymxpc2hlcldhbGxldDsKCgkJYmlkLmFkU2xvdCA9IF9zbG90SWQ7CgkJYmlkLmFkU2xvdElwZnMgPSBhZFNsb3RJcGZzOwoKCQliaWQucHVibGlzaGVyUGVlciA9IF9wZWVyOwoKCQliaWQuYWNjZXB0ZWRUaW1lID0gbm93OwoKCQliaWRzQnlBZHNsb3RbX3Nsb3RJZF0ucHVzaChfYmlkSWQpOwoKCQlMb2dCaWRBY2NlcHRlZChiaWQuaWQsIHB1Ymxpc2hlciwgX3Nsb3RJZCwgYWRTbG90SXBmcywgYmlkLmFjY2VwdGVkVGltZSwgYmlkLnB1Ymxpc2hlclBlZXIpOwoJfQoKCS8vIHRoZSBiaWQgaXMgZ2l2ZW4gdXAgYnkgdGhlIHB1Ymxpc2hlciwgdGhlcmVmb3JlIGNhbmNlbGluZyBpdCBhbmQgcmV0dXJuaW5nIHRoZSBmdW5kcyB0byB0aGUgYWR2ZXJ0aXNlcgoJLy8gc2FtZSBsb2dpYyBhcyBjYW5jZWxCaWQoKSwgYnV0IGRpZmZlcmVudCBwZXJtaXNzaW9ucwoJZnVuY3Rpb24gZ2l2ZXVwQmlkKHVpbnQgX2JpZElkKQoJCW9ubHlSZWdpc3RlcmVkQWNjCgkJb25seUV4aXN0aW5nQmlkKF9iaWRJZCkKCQlvbmx5QmlkQWNlcHRlZShfYmlkSWQpCgkJb25seUJpZFN0YXRlKF9iaWRJZCwgQmlkU3RhdGUuQWNjZXB0ZWQpCgl7CgkJdmFyIGJpZCA9IGJpZHNCeUlkW19iaWRJZF07CgkJYmlkLnN0YXRlID0gQmlkU3RhdGUuQ2FuY2VsZWQ7CgkJcmVxdWlyZSh0b2tlbi50cmFuc2ZlcihiaWQuYWR2ZXJ0aXNlcldhbGxldCwgYmlkLmFtb3VudCkpOwoKCQlMb2dCaWRDYW5jZWxlZChiaWQuaWQpOwoJfQoKCS8vIGJvdGggcHVibGlzaGVyIGFuZCBhZHZlcnRpc2VyIGhhdmUgdG8gY2FsbCB0aGlzIGZvciBhIGJpZCB0byBiZSBjb25zaWRlcmVkIHZlcmlmaWVkCglmdW5jdGlvbiB2ZXJpZnlCaWQodWludCBfYmlkSWQsIGJ5dGVzMzIgX3JlcG9ydCkKCQlvbmx5UmVnaXN0ZXJlZEFjYwoJCW9ubHlFeGlzdGluZ0JpZChfYmlkSWQpCgkJb25seUJpZFN0YXRlKF9iaWRJZCwgQmlkU3RhdGUuQWNjZXB0ZWQpCgl7CgkJQmlkIHN0b3JhZ2UgYmlkID0gYmlkc0J5SWRbX2JpZElkXTsKCgkJcmVxdWlyZShiaWQucHVibGlzaGVyID09IG1zZy5zZW5kZXIgfHwgYmlkLmFkdmVydGlzZXIgPT0gbXNnLnNlbmRlcik7CgoJCWlmIChiaWQucHVibGlzaGVyID09IG1zZy5zZW5kZXIpIHsKCQkJYmlkLmNvbmZpcm1lZEJ5UHVibGlzaGVyID0gdHJ1ZTsKCQkJYmlkLnB1Ymxpc2hlclJlcG9ydElwZnMgPSBfcmVwb3J0OwoJCX0KCgkJaWYgKGJpZC5hZHZlcnRpc2VyID09IG1zZy5zZW5kZXIpIHsKCQkJYmlkLmNvbmZpcm1lZEJ5QWR2ZXJ0aXNlciA9IHRydWU7CgkJCWJpZC5hZHZlcnRpc2VyUmVwb3J0SXBmcyA9IF9yZXBvcnQ7CgkJfQoKCQlpZiAoYmlkLmNvbmZpcm1lZEJ5QWR2ZXJ0aXNlciAmJiBiaWQuY29uZmlybWVkQnlQdWJsaXNoZXIpIHsKCQkJYmlkLnN0YXRlID0gQmlkU3RhdGUuQ29tcGxldGVkOwoJCQlMb2dCaWRDb21wbGV0ZWQoYmlkLmlkLCBiaWQuYWR2ZXJ0aXNlclJlcG9ydElwZnMsIGJpZC5wdWJsaXNoZXJSZXBvcnRJcGZzKTsKCQl9Cgl9CgoJLy8gbm93LCBjbGFpbSB0aGUgcmV3YXJkOyBjYWxsYWJsZSBieSB0aGUgcHVibGlzaGVyOwoJLy8gY2xhaW1CaWRSZXdhcmQgaXMgYSBzZXBhcmF0ZSBmdW5jdGlvbiBzbyBhcyB0byBkZWZpbmUgY2xlYXJseSB3aG8gcGF5cyB0aGUgZ2FzIGZvciB0cmFuc2ZlcmluZyB0aGUgcmV3YXJkIAoJZnVuY3Rpb24gY2xhaW1CaWRSZXdhcmQodWludCBfYmlkSWQpCgkJb25seVJlZ2lzdGVyZWRBY2MKCQlvbmx5RXhpc3RpbmdCaWQoX2JpZElkKQoJCW9ubHlCaWRBY2VwdGVlKF9iaWRJZCkKCQlvbmx5QmlkU3RhdGUoX2JpZElkLCBCaWRTdGF0ZS5Db21wbGV0ZWQpCgl7CgkJQmlkIHN0b3JhZ2UgYmlkID0gYmlkc0J5SWRbX2JpZElkXTsKCQkKCQliaWQuc3RhdGUgPSBCaWRTdGF0ZS5DbGFpbWVkOwoKCQlyZXF1aXJlKHRva2VuLnRyYW5zZmVyKGJpZC5wdWJsaXNoZXJXYWxsZXQsIGJpZC5hbW91bnQpKTsKCgkJTG9nQmlkUmV3YXJkQ2xhaW1lZChiaWQuaWQsIGJpZC5wdWJsaXNoZXJXYWxsZXQsIGJpZC5hbW91bnQpOwoJfQoKCS8vIFRoaXMgY2FuIGJlIGRvbmUgaWYgYSBiaWQgaXMgYWNjZXB0ZWQsIGJ1dCBleHBpcmVkCgkvLyBUaGlzIGlzIGVzc2VudGlhbGx5IHRoZSBwcm90ZWN0aW9uIGZyb20gbmV2ZXIgc2V0dGxpbmcgb24gdmVyaWZpY2F0aW9uLCBvciBmcm9tIHB1Ymxpc2hlciBub3QgZXhlY3V0aW5nIHRoZSBiaWQgd2l0aGluIGEgcmVhc29uYWJsZSB0aW1lCglmdW5jdGlvbiByZWZ1bmRCaWQodWludCBfYmlkSWQpCgkJb25seVJlZ2lzdGVyZWRBY2MKCQlvbmx5RXhpc3RpbmdCaWQoX2JpZElkKQoJCW9ubHlCaWRPd25lcihfYmlkSWQpCgkJb25seUJpZFN0YXRlKF9iaWRJZCwgQmlkU3RhdGUuQWNjZXB0ZWQpCgl7CgkJQmlkIHN0b3JhZ2UgYmlkID0gYmlkc0J5SWRbX2JpZElkXTsKCQlyZXF1aXJlKGJpZC5yZXF1aXJlZEV4ZWNUaW1lID4gMCk7IC8vIHlvdSBjYW4ndCByZWZ1bmQgaWYgeW91IGhhdmVuJ3Qgc2V0IGEgdGltZW91dAoJCXJlcXVpcmUoU2FmZU1hdGguYWRkKGJpZC5hY2NlcHRlZFRpbWUsIGJpZC5yZXF1aXJlZEV4ZWNUaW1lKSA8IG5vdyk7CgoJCWJpZC5zdGF0ZSA9IEJpZFN0YXRlLkV4cGlyZWQ7CgkJcmVxdWlyZSh0b2tlbi50cmFuc2ZlcihiaWQuYWR2ZXJ0aXNlcldhbGxldCwgYmlkLmFtb3VudCkpOwoKCQlMb2dCaWRFeHBpcmVkKGJpZC5pZCk7Cgl9CgoJLy8KCS8vIFB1YmxpYyBjb25zdGFudCBmdW5jdGlvbnMKCS8vCgoJZnVuY3Rpb24gZ2V0Qmlkc0Zyb21BcnIodWludFtdIGFyciwgdWludCBfc3RhdGUpIAoJCWludGVybmFsCgkJcmV0dXJucyAodWludFtdIF9hbGwpCgl7CgkJQmlkU3RhdGUgc3RhdGUgPSBCaWRTdGF0ZShfc3RhdGUpOwoKCQkvLyBzZXBhcmF0ZSBhcnJheSBpcyBuZWVkZWQgYmVjYXVzZSBvZiBzb2xpZGl0eSBzdHVwaWRpdHkgKHB1biBpbnRlbmRlZCApKSkgKQoJCXVpbnRbXSBtZW1vcnkgYWxsID0gbmV3IHVpbnRbXShhcnIubGVuZ3RoKTsKCgkJdWludCBjb3VudCA9IDA7CgkJdWludCBpOwoKCQlmb3IgKGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CgkJCXZhciBpZCA9IGFycltpXTsKCQkJdmFyIGJpZCA9IGJpZHNCeUlkW2lkXTsKCQkJaWYgKGJpZC5zdGF0ZSA9PSBzdGF0ZSkgewoJCQkJYWxsW2NvdW50XSA9IGlkOwoJCQkJY291bnQgKz0gMTsKCQkJfQoJCX0KCgkJX2FsbCA9IG5ldyB1aW50W10oY291bnQpOwoJCWZvciAoaSA9IDA7IGkgPCBjb3VudDsgaSsrKSBfYWxsW2ldID0gYWxsW2ldOwoJfQoKCWZ1bmN0aW9uIGdldEFsbEJpZHNCeUFkdW5pdCh1aW50IF9hZHVuaXRJZCkgCgkJY29uc3RhbnQgCgkJZXh0ZXJuYWwKCQlyZXR1cm5zICh1aW50W10pCgl7CgkJcmV0dXJuIGJpZHNCeUFkdW5pdFtfYWR1bml0SWRdOwoJfQoKCWZ1bmN0aW9uIGdldEJpZHNCeUFkdW5pdCh1aW50IF9hZHVuaXRJZCwgdWludCBfc3RhdGUpCgkJY29uc3RhbnQKCQlleHRlcm5hbAoJCXJldHVybnMgKHVpbnRbXSkKCXsKCQlyZXR1cm4gZ2V0Qmlkc0Zyb21BcnIoYmlkc0J5QWR1bml0W19hZHVuaXRJZF0sIF9zdGF0ZSk7Cgl9CgoJZnVuY3Rpb24gZ2V0QWxsQmlkc0J5QWRzbG90KHVpbnQgX2Fkc2xvdElkKSAKCQljb25zdGFudCAKCQlleHRlcm5hbAoJCXJldHVybnMgKHVpbnRbXSkKCXsKCQlyZXR1cm4gYmlkc0J5QWRzbG90W19hZHNsb3RJZF07Cgl9CgoJZnVuY3Rpb24gZ2V0Qmlkc0J5QWRzbG90KHVpbnQgX2Fkc2xvdElkLCB1aW50IF9zdGF0ZSkKCQljb25zdGFudAoJCWV4dGVybmFsCgkJcmV0dXJucyAodWludFtdKQoJewoJCXJldHVybiBnZXRCaWRzRnJvbUFycihiaWRzQnlBZHNsb3RbX2Fkc2xvdElkXSwgX3N0YXRlKTsKCX0KCglmdW5jdGlvbiBnZXRCaWQodWludCBfYmlkSWQpIAoJCW9ubHlFeGlzdGluZ0JpZChfYmlkSWQpCgkJY29uc3RhbnQKCQlleHRlcm5hbAoJCXJldHVybnMgKAoJCQl1aW50LCB1aW50LCB1aW50LCB1aW50LCB1aW50LCAKCQkJLy8gYWR2ZXJ0aXNlciAoYWQgdW5pdCwgaXBmcywgcGVlcikKCQkJdWludCwgYnl0ZXMzMiwgYnl0ZXMzMiwKCQkJLy8gcHVibGlzaGVyIChhZCBzbG90LCBpcGZzLCBwZWVyKQoJCQl1aW50LCBieXRlczMyLCBieXRlczMyCgkJKQoJewoJCXZhciBiaWQgPSBiaWRzQnlJZFtfYmlkSWRdOwoJCXJldHVybiAoCgkJCXVpbnQoYmlkLnN0YXRlKSwgYmlkLnJlcXVpcmVkUG9pbnRzLCBiaWQucmVxdWlyZWRFeGVjVGltZSwgYmlkLmFtb3VudCwgYmlkLmFjY2VwdGVkVGltZSwKCQkJYmlkLmFkVW5pdCwgYmlkLmFkVW5pdElwZnMsIGJpZC5hZHZlcnRpc2VyUGVlciwKCQkJYmlkLmFkU2xvdCwgYmlkLmFkU2xvdElwZnMsIGJpZC5wdWJsaXNoZXJQZWVyCgkJKTsKCX0KCglmdW5jdGlvbiBnZXRCaWRSZXBvcnRzKHVpbnQgX2JpZElkKQoJCW9ubHlFeGlzdGluZ0JpZChfYmlkSWQpCgkJY29uc3RhbnQKCQlleHRlcm5hbAoJCXJldHVybnMgKAoJCQlieXRlczMyLCAvLyBhZHZlcnRpc2VyIHJlcG9ydAoJCQlieXRlczMyIC8vIHB1Ymxpc2hlciByZXBvcnQKCQkpCgl7CgkJdmFyIGJpZCA9IGJpZHNCeUlkW19iaWRJZF07CgkJcmV0dXJuIChiaWQuYWR2ZXJ0aXNlclJlcG9ydElwZnMsIGJpZC5wdWJsaXNoZXJSZXBvcnRJcGZzKTsKCX0KCgkvLwoJLy8gRXZlbnRzCgkvLwoJZXZlbnQgTG9nQmlkT3BlbmVkKHVpbnQgYmlkSWQsIGFkZHJlc3MgYWR2ZXJ0aXNlciwgdWludCBhZHVuaXRJZCwgYnl0ZXMzMiBhZHVuaXRJcGZzLCB1aW50IHRhcmdldCwgdWludCByZXdhcmRBbW91bnQsIHVpbnQgdGltZW91dCwgYnl0ZXMzMiBhZHZlcnRpc2VyUGVlcik7CglldmVudCBMb2dCaWRBY2NlcHRlZCh1aW50IGJpZElkLCBhZGRyZXNzIHB1Ymxpc2hlciwgdWludCBhZHNsb3RJZCwgYnl0ZXMzMiBhZHNsb3RJcGZzLCB1aW50IGFjY2VwdGVkVGltZSwgYnl0ZXMzMiBwdWJsaXNoZXJQZWVyKTsKCWV2ZW50IExvZ0JpZENhbmNlbGVkKHVpbnQgYmlkSWQpOwoJZXZlbnQgTG9nQmlkRXhwaXJlZCh1aW50IGJpZElkKTsKCWV2ZW50IExvZ0JpZENvbXBsZXRlZCh1aW50IGJpZElkLCBieXRlczMyIGFkdlJlcG9ydCwgYnl0ZXMzMiBwdWJSZXBvcnQpOwoJZXZlbnQgTG9nQmlkUmV3YXJkQ2xhaW1lZCh1aW50IF9iaWRJZCwgYWRkcmVzcyBfd2FsbGV0LCB1aW50IF9hbW91bnQpOwp9'.
	

]
