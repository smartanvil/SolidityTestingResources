Class {
	#name : #SRT0062179227c03efc81301ade144f447f2561edd5,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT0062179227c03efc81301ade144f447f2561edd5 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovLyBGaWxlOiBjb250cmFjdHMvSVByaWNpbmdTdHJhdGVneS5zb2wKCmludGVyZmFjZSBJUHJpY2luZ1N0cmF0ZWd5IHsKCiAgICBmdW5jdGlvbiBpc1ByaWNpbmdTdHJhdGVneSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwoKICAgIC8qKiBDYWxjdWxhdGUgdGhlIGN1cnJlbnQgcHJpY2UgZm9yIGJ1eSBpbiBhbW91bnQuICovCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVUb2tlbkFtb3VudCh1aW50IHdlaUFtb3VudCwgdWludCB0b2tlbnNTb2xkKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50IHRva2VuQW1vdW50KTsKCn0KCi8vIEZpbGU6IHplcHBlbGluLXNvbGlkaXR5L2NvbnRyYWN0cy90b2tlbi9FUkMyMEJhc2ljLnNvbAoKLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5CiAqLwpjb250cmFjdCBFUkMyMEJhc2ljIHsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL3Rva2VuL0VSQzIwLnNvbAoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKLy8gRmlsZTogY29udHJhY3RzL3Rva2VuL0VSQzIyMy5zb2wKCmNvbnRyYWN0IEVSQzIyMyBpcyBFUkMyMCB7CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUsIGJ5dGVzIF9kYXRhKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50IHZhbHVlLCBieXRlcyBkYXRhKTsKfQoKLy8gRmlsZTogY29udHJhY3RzL3Rva2VuL1Rva2VuUmVjaWV2ZXIuc29sCgovKgogKiBDb250cmFjdCB0aGF0IGlzIHdvcmtpbmcgd2l0aCBFUkMyMjMgdG9rZW5zCiAqLwogCiBjb250cmFjdCBUb2tlblJlY2lldmVyIHsKICAgIGZ1bmN0aW9uIHRva2VuRmFsbGJhY2soYWRkcmVzcyBfZnJvbSwgdWludCBfdmFsdWUsIGJ5dGVzIF9kYXRhKSBwdWJsaWMgcHVyZSB7CiAgICB9Cn0KCi8vIEZpbGU6IHplcHBlbGluLXNvbGlkaXR5L2NvbnRyYWN0cy9tYXRoL1NhZmVNYXRoLnNvbAoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL293bmVyc2hpcC9Pd25hYmxlLnNvbAoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL293bmVyc2hpcC9Db250YWN0YWJsZS5zb2wKCi8qKgogKiBAdGl0bGUgQ29udGFjdGFibGUgdG9rZW4KICogQGRldiBCYXNpYyB2ZXJzaW9uIG9mIGEgY29udGFjdGFibGUgY29udHJhY3QsIGFsbG93aW5nIHRoZSBvd25lciB0byBwcm92aWRlIGEgc3RyaW5nIHdpdGggdGhlaXIKICogY29udGFjdCBpbmZvcm1hdGlvbi4KICovCmNvbnRyYWN0IENvbnRhY3RhYmxlIGlzIE93bmFibGV7CgogICAgc3RyaW5nIHB1YmxpYyBjb250YWN0SW5mb3JtYXRpb247CgogICAgLyoqCiAgICAgKiBAZGV2IEFsbG93cyB0aGUgb3duZXIgdG8gc2V0IGEgc3RyaW5nIHdpdGggdGhlaXIgY29udGFjdCBpbmZvcm1hdGlvbi4KICAgICAqIEBwYXJhbSBpbmZvIFRoZSBjb250YWN0IGluZm9ybWF0aW9uIHRvIGF0dGFjaCB0byB0aGUgY29udHJhY3QuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldENvbnRhY3RJbmZvcm1hdGlvbihzdHJpbmcgaW5mbykgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgIGNvbnRhY3RJbmZvcm1hdGlvbiA9IGluZm87CiAgICAgfQp9CgovLyBGaWxlOiBjb250cmFjdHMvdG9rZW4vUGxheUhhbGxUb2tlbi5zb2wKCmNvbnRyYWN0IFBsYXlIYWxsVG9rZW4gaXMgRVJDMjIzLCBDb250YWN0YWJsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKCiAgICBzdHJpbmcgY29uc3RhbnQgcHVibGljIG5hbWUgPSAiUGxheUhhbGwgVG9rZW4iOwogICAgc3RyaW5nIGNvbnN0YW50IHB1YmxpYyBzeW1ib2wgPSAiUEhUIjsKICAgIHVpbnQgY29uc3RhbnQgcHVibGljIGRlY2ltYWxzID0gMTg7CgogICAgYm9vbCBwdWJsaWMgaXNBY3RpdmF0ZWQgPSBmYWxzZTsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIGJhbGFuY2VzOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpKSBpbnRlcm5hbCBhbGxvd2VkOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgZnJlZXplZExpc3Q7CiAgICAKICAgIC8vIGFkZHJlc3MsIHdobyBpcyBhbGxvd2VkIHRvIGlzc3VlIG5ldyB0b2tlbnMgKHByZXNhbGUgYW5kIHNhbGUgY29udHJhY3RzKQogICAgYWRkcmVzcyBwdWJsaWMgbWludGVyOwoKICAgIGJvb2wgcHVibGljIG1pbnRpbmdGaW5pc2hlZCA9IGZhbHNlOwoKICAgIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50IGFtb3VudCk7CiAgICBldmVudCBNaW50aW5nRmluaXNoZWQoKTsKCiAgICBtb2RpZmllciBvbmx5TWludGVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBtaW50ZXIpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgY2FuTWludCgpIHsKICAgICAgICByZXF1aXJlKCFtaW50aW5nRmluaXNoZWQpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgd2hlbkFjdGl2YXRlZCgpIHsKICAgICAgICByZXF1aXJlKGlzQWN0aXZhdGVkKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIFBsYXlIYWxsVG9rZW4oKSBwdWJsaWMgewogICAgICAgIG1pbnRlciA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBieXRlcyBtZW1vcnkgZW1wdHk7CiAgICAgICAgcmV0dXJuIHRyYW5zZmVyKF90bywgX3ZhbHVlLCBlbXB0eSk7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICAgKiBAcGFyYW0gX2RhdGEgT3B0aW9uYWwgbWV0YWRhdGEuCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljIHdoZW5BY3RpdmF0ZWQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKICAgICAgICByZXF1aXJlKCFmcmVlemVkTGlzdFttc2cuc2VuZGVyXSk7CgogICAgICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwoKICAgICAgICBpZiAoaXNDb250cmFjdChfdG8pKSB7CiAgICAgICAgICAgIFRva2VuUmVjaWV2ZXIgcmVjZWl2ZXIgPSBUb2tlblJlY2lldmVyKF90byk7CiAgICAgICAgICAgIHJlY2VpdmVyLnRva2VuRmFsbGJhY2sobXNnLnNlbmRlciwgX3ZhbHVlLCBfZGF0YSk7CiAgICAgICAgfQoKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUsIF9kYXRhKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAgICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgICAqIEByZXR1cm4gQW4gdWludCByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgICAqLwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBieXRlcyBtZW1vcnkgZW1wdHk7CiAgICAgICAgcmV0dXJuIHRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUsIGVtcHR5KTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgICAqIEBwYXJhbSBfZGF0YSBPcHRpb25hbCBtZXRhZGF0YS4KICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSwgYnl0ZXMgX2RhdGEpIHB1YmxpYyB3aGVuQWN0aXZhdGVkIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1tfZnJvbV0pOwogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKICAgICAgICByZXF1aXJlKCFmcmVlemVkTGlzdFtfZnJvbV0pOwoKICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKCiAgICAgICAgaWYgKGlzQ29udHJhY3QoX3RvKSkgewogICAgICAgICAgICBUb2tlblJlY2lldmVyIHJlY2VpdmVyID0gVG9rZW5SZWNpZXZlcihfdG8pOwogICAgICAgICAgICByZWNlaXZlci50b2tlbkZhbGxiYWNrKF9mcm9tLCBfdmFsdWUsIF9kYXRhKTsKICAgICAgICB9CgogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlLCBfZGF0YSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgICAqCiAgICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF92YWx1ZSA9PSAwIHx8IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID09IDApOwogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcmV0dXJuIEEgdWludCBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBJbmNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAgICoKICAgICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAogICAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX2FkZGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gaW5jcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgICAqLwogICAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBEZWNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAgICoKICAgICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGRlY3JlbWVudAogICAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX3N1YnRyYWN0ZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBkZWNyZWFzZSB0aGUgYWxsb3dhbmNlIGJ5LgogICAgICovCiAgICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICAgICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICAgICAgfQogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgICAvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gbWludCB0b2tlbnMKICAgICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIG1pbnRlZCB0b2tlbnMuCiAgICAgKiBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAgICogQHJldHVybiBBIGJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgICAqLwogICAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludCBfYW1vdW50LCBib29sIGZyZWV6ZSkgY2FuTWludCBvbmx5TWludGVyIGV4dGVybmFsIHJldHVybnMgKGJvb2wpIHsKICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfYW1vdW50KTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICAgICAgaWYgKGZyZWV6ZSkgewogICAgICAgICAgICBmcmVlemVkTGlzdFtfdG9dID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgTWludChfdG8sIF9hbW91bnQpOwogICAgICAgIFRyYW5zZmVyKGFkZHJlc3MoMCksIF90bywgX2Ftb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHN0b3AgbWludGluZyBuZXcgdG9rZW5zLgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBjYW5NaW50IG9ubHlNaW50ZXIgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgICAgIG1pbnRpbmdGaW5pc2hlZCA9IHRydWU7CiAgICAgICAgTWludGluZ0ZpbmlzaGVkKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogTWludGVyIGNhbiBwYXNzIGl0J3Mgcm9sZSB0byBhbm90aGVyIGFkZHJlc3MKICAgICAqLwogICAgZnVuY3Rpb24gc2V0TWludGVyKGFkZHJlc3MgX21pbnRlcikgZXh0ZXJuYWwgb25seU1pbnRlciB7CiAgICAgICAgcmVxdWlyZShfbWludGVyICE9IDB4MCk7CiAgICAgICAgbWludGVyID0gX21pbnRlcjsKICAgIH0KCiAgICAvKioKICAgICAqIE93bmVyIGNhbiB1bmZyZWV6ZSBhbnkgYWRkcmVzcwogICAgICovCiAgICBmdW5jdGlvbiByZW1vdmVGcm9tRnJlZXplZExpc3QoYWRkcmVzcyB1c2VyKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIGZyZWV6ZWRMaXN0W3VzZXJdID0gZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBBY3RpdmF0aW9uIG9mIHRoZSB0b2tlbiBhbGxvd3MgYWxsIHRva2VuaG9sZGVycyB0byBvcGVyYXRlIHdpdGggdGhlIHRva2VuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkgZXh0ZXJuYWwgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpc0FjdGl2YXRlZCA9IHRydWU7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gaXNDb250cmFjdChhZGRyZXNzIF9hZGRyKSBwcml2YXRlIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHVpbnQgbGVuZ3RoOwogICAgICAgIGFzc2VtYmx5IHsKICAgICAgICAgICAgICAvL3JldHJpZXZlIHRoZSBzaXplIG9mIHRoZSBjb2RlIG9uIHRhcmdldCBhZGRyZXNzLCB0aGlzIG5lZWRzIGFzc2VtYmx5CiAgICAgICAgICAgICAgbGVuZ3RoIDo9IGV4dGNvZGVzaXplKF9hZGRyKQogICAgICAgIH0KICAgICAgICByZXR1cm4gKGxlbmd0aD4wKTsKICAgIH0KfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL2xpZmVjeWNsZS9QYXVzYWJsZS5zb2wKCi8qKgogKiBAdGl0bGUgUGF1c2FibGUKICogQGRldiBCYXNlIGNvbnRyYWN0IHdoaWNoIGFsbG93cyBjaGlsZHJlbiB0byBpbXBsZW1lbnQgYW4gZW1lcmdlbmN5IHN0b3AgbWVjaGFuaXNtLgogKi8KY29udHJhY3QgUGF1c2FibGUgaXMgT3duYWJsZSB7CiAgZXZlbnQgUGF1c2UoKTsKICBldmVudCBVbnBhdXNlKCk7CgogIGJvb2wgcHVibGljIHBhdXNlZCA9IGZhbHNlOwoKCiAgLyoqCiAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBub3QgcGF1c2VkLgogICAqLwogIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICByZXF1aXJlKCFwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgcGF1c2VkLgogICAqLwogIG1vZGlmaWVyIHdoZW5QYXVzZWQoKSB7CiAgICByZXF1aXJlKHBhdXNlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHBhdXNlLCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlCiAgICovCiAgZnVuY3Rpb24gcGF1c2UoKSBvbmx5T3duZXIgd2hlbk5vdFBhdXNlZCBwdWJsaWMgewogICAgcGF1c2VkID0gdHJ1ZTsKICAgIFBhdXNlKCk7CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gdW5wYXVzZSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgKi8KICBmdW5jdGlvbiB1bnBhdXNlKCkgb25seU93bmVyIHdoZW5QYXVzZWQgcHVibGljIHsKICAgIHBhdXNlZCA9IGZhbHNlOwogICAgVW5wYXVzZSgpOwogIH0KfQoKLy8gRmlsZTogY29udHJhY3RzL1NhbGVCYXNlLnNvbAoKY29udHJhY3QgU2FsZUJhc2UgaXMgUGF1c2FibGUsIENvbnRhY3RhYmxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwogIAogICAgLy8gVGhlIHRva2VuIGJlaW5nIHNvbGQKICAgIFBsYXlIYWxsVG9rZW4gcHVibGljIHRva2VuOwogIAogICAgLy8gc3RhcnQgYW5kIGVuZCB0aW1lc3RhbXBzIHdoZXJlIHB1cmNoYXNlcyBhcmUgYWxsb3dlZCAoYm90aCBpbmNsdXNpdmUpCiAgICB1aW50IHB1YmxpYyBzdGFydFRpbWU7CiAgICB1aW50IHB1YmxpYyBlbmRUaW1lOwogIAogICAgLy8gYWRkcmVzcyB3aGVyZSBmdW5kcyBhcmUgY29sbGVjdGVkCiAgICBhZGRyZXNzIHB1YmxpYyB3YWxsZXQ7CiAgCiAgICAvLyB0aGUgY29udHJhY3QsIHdoaWNoIGRldGVybWluZSBob3cgbWFueSB0b2tlbiB1bml0cyBhIGJ1eWVyIGdldHMgcGVyIHdlaQogICAgSVByaWNpbmdTdHJhdGVneSBwdWJsaWMgcHJpY2luZ1N0cmF0ZWd5OwogIAogICAgLy8gYW1vdW50IG9mIHJhaXNlZCBtb25leSBpbiB3ZWkKICAgIHVpbnQgcHVibGljIHdlaVJhaXNlZDsKCiAgICAvLyBhbW91bnQgb2YgdG9rZW5zIHRoYXQgd2FzIHNvbGQgb24gdGhlIGNyb3dkc2FsZQogICAgdWludCBwdWJsaWMgdG9rZW5zU29sZDsKCiAgICAvLyBtYXhpbXVtIGFtb3VudCBvZiB3ZWkgaW4gdG90YWwsIHRoYXQgY2FuIGJlIGJvdWdodAogICAgdWludCBwdWJsaWMgd2VpTWF4aW11bUdvYWw7CgogICAgLy8gaWYgd2VpTWluaW11bUdvYWwgd2lsbCBub3QgYmUgcmVhY2hlZCB0aWxsIGVuZFRpbWUsIGJ1eWVycyB3aWxsIGJlIGFibGUgdG8gcmVmdW5kIEVUSAogICAgdWludCBwdWJsaWMgd2VpTWluaW11bUdvYWw7CgogICAgLy8gbWluaW11bSBhbW91bnQgb2Ygd2VsLCB0aGF0IGNhbiBiZSBjb250cmlidXRlZAogICAgdWludCBwdWJsaWMgd2VpTWluaW11bUFtb3VudDsKCiAgICAvLyBIb3cgbWFueSBkaXN0aW5jdCBhZGRyZXNzZXMgaGF2ZSBib3VnaHQKICAgIHVpbnQgcHVibGljIGJ1eWVyQ291bnQ7CgogICAgLy8gaG93IG11Y2ggd2VpIHdlIGhhdmUgcmV0dXJuZWQgYmFjayB0byB0aGUgY29udHJhY3QgYWZ0ZXIgYSBmYWlsZWQgY3Jvd2RmdW5kCiAgICB1aW50IHB1YmxpYyBsb2FkZWRSZWZ1bmQ7CgogICAgLy8gaG93IG11Y2ggd2VpIHdlIGhhdmUgZ2l2ZW4gYmFjayB0byBidXllcnMKICAgIHVpbnQgcHVibGljIHdlaVJlZnVuZGVkOwoKICAgIC8vIGhvdyBtdWNoIEVUSCBlYWNoIGFkZHJlc3MgaGFzIGJvdWdodCB0byB0aGlzIGNyb3dkc2FsZQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgYm91Z2h0QW1vdW50T2Y7CgogICAgLy8gd2hldGhlciBhIGJ1eWVyIGFscmVhZHkgYm91Z2h0IHNvbWUgdG9rZW5zCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBpc0J1eWVyOwoKICAgIC8vIHdoZXRoZXIgYSBidXllciBib3VnaHQgdG9rZW5zIHRocm91Z2ggb3RoZXIgY3VycmVuY2llcwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgaXNFeHRlcm5hbEJ1eWVyOwoKICAgIGFkZHJlc3MgcHVibGljIGFkbWluOwoKICAgIC8qKgogICAgICogZXZlbnQgZm9yIHRva2VuIHB1cmNoYXNlIGxvZ2dpbmcKICAgICAqIEBwYXJhbSBwdXJjaGFzZXIgd2hvIHBhaWQgZm9yIHRoZSB0b2tlbnMKICAgICAqIEBwYXJhbSBiZW5lZmljaWFyeSB3aG8gZ290IHRoZSB0b2tlbnMKICAgICAqIEBwYXJhbSB2YWx1ZSB3ZWlzIHBhaWQgZm9yIHB1cmNoYXNlCiAgICAgKiBAcGFyYW0gdG9rZW5BbW91bnQgYW1vdW50IG9mIHRva2VucyBwdXJjaGFzZWQKICAgICAqLwogICAgZXZlbnQgVG9rZW5QdXJjaGFzZSgKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwKICAgICAgICB1aW50IHZhbHVlLAogICAgICAgIHVpbnQgdG9rZW5BbW91bnQKICAgICk7CgogICAgLy8gYSByZWZ1bmQgd2FzIHByb2Nlc3NlZCBmb3IgYW4gYnV5ZXIKICAgIGV2ZW50IFJlZnVuZChhZGRyZXNzIGJ1eWVyLCB1aW50IHdlaUFtb3VudCk7CiAgICBldmVudCBSZWZ1bmRMb2FkZWQodWludCBhbW91bnQpOwoKICAgIGZ1bmN0aW9uIFNhbGVCYXNlKAogICAgICAgIHVpbnQgX3N0YXJ0VGltZSwKICAgICAgICB1aW50IF9lbmRUaW1lLAogICAgICAgIElQcmljaW5nU3RyYXRlZ3kgX3ByaWNpbmdTdHJhdGVneSwKICAgICAgICBQbGF5SGFsbFRva2VuIF90b2tlbiwKICAgICAgICBhZGRyZXNzIF93YWxsZXQsCiAgICAgICAgdWludCBfd2VpTWF4aW11bUdvYWwsCiAgICAgICAgdWludCBfd2VpTWluaW11bUdvYWwsCiAgICAgICAgdWludCBfd2VpTWluaW11bUFtb3VudCwKICAgICAgICBhZGRyZXNzIF9hZG1pbgogICAgKSBwdWJsaWMKICAgIHsKICAgICAgICByZXF1aXJlKF9zdGFydFRpbWUgPj0gbm93KTsKICAgICAgICByZXF1aXJlKF9lbmRUaW1lID49IF9zdGFydFRpbWUpOwogICAgICAgIHJlcXVpcmUoX3ByaWNpbmdTdHJhdGVneS5pc1ByaWNpbmdTdHJhdGVneSgpKTsKICAgICAgICByZXF1aXJlKGFkZHJlc3MoX3Rva2VuKSAhPSAweDApOwogICAgICAgIHJlcXVpcmUoX3dhbGxldCAhPSAweDApOwogICAgICAgIHJlcXVpcmUoX3dlaU1heGltdW1Hb2FsID4gMCk7CiAgICAgICAgcmVxdWlyZShfYWRtaW4gIT0gMHgwKTsKCiAgICAgICAgc3RhcnRUaW1lID0gX3N0YXJ0VGltZTsKICAgICAgICBlbmRUaW1lID0gX2VuZFRpbWU7CiAgICAgICAgcHJpY2luZ1N0cmF0ZWd5ID0gX3ByaWNpbmdTdHJhdGVneTsKICAgICAgICB0b2tlbiA9IF90b2tlbjsKICAgICAgICB3YWxsZXQgPSBfd2FsbGV0OwogICAgICAgIHdlaU1heGltdW1Hb2FsID0gX3dlaU1heGltdW1Hb2FsOwogICAgICAgIHdlaU1pbmltdW1Hb2FsID0gX3dlaU1pbmltdW1Hb2FsOwogICAgICAgIHdlaU1pbmltdW1BbW91bnQgPSBfd2VpTWluaW11bUFtb3VudDsKICAgICAgICBhZG1pbiA9IF9hZG1pbjsKICAgIH0KCgogICAgbW9kaWZpZXIgb25seU93bmVyT3JBZG1pbigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIgfHwgbXNnLnNlbmRlciA9PSBhZG1pbik7IAogICAgICAgIF87CiAgICB9CgogICAgLy8gZmFsbGJhY2sgZnVuY3Rpb24gY2FuIGJlIHVzZWQgdG8gYnV5IHRva2VucwogICAgZnVuY3Rpb24gKCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwogICAgfQoKICAgIC8vIGxvdyBsZXZlbCB0b2tlbiBwdXJjaGFzZSBmdW5jdGlvbgogICAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnkpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHBheWFibGUgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHVpbnQgd2VpQW1vdW50ID0gbXNnLnZhbHVlOwoKICAgICAgICByZXF1aXJlKGJlbmVmaWNpYXJ5ICE9IDB4MCk7CiAgICAgICAgcmVxdWlyZSh3ZWlBbW91bnQgPj0gd2VpTWluaW11bUFtb3VudCk7CiAgICAgICAgcmVxdWlyZSh2YWxpZFB1cmNoYXNlKG1zZy52YWx1ZSkpOwogICAgCiAgICAgICAgLy8gY2FsY3VsYXRlIHRva2VuIGFtb3VudCB0byBiZSBjcmVhdGVkCiAgICAgICAgdWludCB0b2tlbkFtb3VudCA9IHByaWNpbmdTdHJhdGVneS5jYWxjdWxhdGVUb2tlbkFtb3VudCh3ZWlBbW91bnQsIHdlaVJhaXNlZCk7CiAgICAgICAgCiAgICAgICAgbWludFRva2VuVG9CdXllcihiZW5lZmljaWFyeSwgdG9rZW5BbW91bnQsIHdlaUFtb3VudCk7CiAgICAgICAgCiAgICAgICAgd2FsbGV0LnRyYW5zZmVyKG1zZy52YWx1ZSk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIG1pbnRUb2tlblRvQnV5ZXIoYWRkcmVzcyBiZW5lZmljaWFyeSwgdWludCB0b2tlbkFtb3VudCwgdWludCB3ZWlBbW91bnQpIGludGVybmFsIHsKICAgICAgICBpZiAoIWlzQnV5ZXJbYmVuZWZpY2lhcnldKSB7CiAgICAgICAgICAgIC8vIEEgbmV3IGJ1eWVyCiAgICAgICAgICAgIGJ1eWVyQ291bnQrKzsKICAgICAgICAgICAgaXNCdXllcltiZW5lZmljaWFyeV0gPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgYm91Z2h0QW1vdW50T2ZbYmVuZWZpY2lhcnldID0gYm91Z2h0QW1vdW50T2ZbYmVuZWZpY2lhcnldLmFkZCh3ZWlBbW91bnQpOwogICAgICAgIHdlaVJhaXNlZCA9IHdlaVJhaXNlZC5hZGQod2VpQW1vdW50KTsKICAgICAgICB0b2tlbnNTb2xkID0gdG9rZW5zU29sZC5hZGQodG9rZW5BbW91bnQpOwogICAgCiAgICAgICAgdG9rZW4ubWludChiZW5lZmljaWFyeSwgdG9rZW5BbW91bnQsIHRydWUpOwogICAgICAgIFRva2VuUHVyY2hhc2UobXNnLnNlbmRlciwgYmVuZWZpY2lhcnksIHdlaUFtb3VudCwgdG9rZW5BbW91bnQpOwogICAgfQoKICAgIC8vIHJldHVybiB0cnVlIGlmIHRoZSB0cmFuc2FjdGlvbiBjYW4gYnV5IHRva2VucwogICAgZnVuY3Rpb24gdmFsaWRQdXJjaGFzZSh1aW50IHdlaUFtb3VudCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGJvb2wgd2l0aGluUGVyaW9kID0gbm93ID49IHN0YXJ0VGltZSAmJiBub3cgPD0gZW5kVGltZTsKICAgICAgICBib29sIHdpdGhpbkNhcCA9IHdlaVJhaXNlZC5hZGQod2VpQW1vdW50KSA8PSB3ZWlNYXhpbXVtR29hbDsKCiAgICAgICAgcmV0dXJuIHdpdGhpblBlcmlvZCAmJiB3aXRoaW5DYXA7CiAgICB9CgogICAgLy8gcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBlbmRlZAogICAgZnVuY3Rpb24gaGFzRW5kZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGJvb2wgY2FwUmVhY2hlZCA9IHdlaVJhaXNlZCA+PSB3ZWlNYXhpbXVtR29hbDsKICAgICAgICBib29sIGFmdGVyRW5kVGltZSA9IG5vdyA+IGVuZFRpbWU7CiAgICAgICAgCiAgICAgICAgcmV0dXJuIGNhcFJlYWNoZWQgfHwgYWZ0ZXJFbmRUaW1lOwogICAgfQoKICAgIC8vIGdldCB0aGUgYW1vdW50IG9mIHVuc29sZCB0b2tlbnMgYWxsb2NhdGVkIHRvIHRoaXMgY29udHJhY3Q7CiAgICBmdW5jdGlvbiBnZXRXZWlMZWZ0KCkgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiB3ZWlNYXhpbXVtR29hbCAtIHdlaVJhaXNlZDsKICAgIH0KCiAgICAvLyByZXR1cm4gdHJ1ZSBpZiB0aGUgY3Jvd2RzYWxlIGhhcyByYWlzZWQgZW5vdWdoIG1vbmV5IHRvIGJlIGEgc3VjY2Vzc2Z1bC4KICAgIGZ1bmN0aW9uIGlzTWluaW11bUdvYWxSZWFjaGVkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gd2VpUmFpc2VkID49IHdlaU1pbmltdW1Hb2FsOwogICAgfQogICAgCiAgICAvLyBhbGxvd3MgdG8gdXBkYXRlIHRva2VucyByYXRlIGZvciBvd25lcgogICAgZnVuY3Rpb24gc2V0UHJpY2luZ1N0cmF0ZWd5KElQcmljaW5nU3RyYXRlZ3kgX3ByaWNpbmdTdHJhdGVneSkgZXh0ZXJuYWwgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBwcmljaW5nU3RyYXRlZ3kgPSBfcHJpY2luZ1N0cmF0ZWd5OwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgKiBBbGxvdyBsb2FkIHJlZnVuZHMgYmFjayBvbiB0aGUgY29udHJhY3QgZm9yIHRoZSByZWZ1bmRpbmcuCiAgICAqCiAgICAqIFRoZSB0ZWFtIGNhbiB0cmFuc2ZlciB0aGUgZnVuZHMgYmFjayBvbiB0aGUgc21hcnQgY29udHJhY3QgaW4gdGhlIGNhc2UgdGhlIG1pbmltdW0gZ29hbCB3YXMgbm90IHJlYWNoZWQuLgogICAgKi8KICAgIGZ1bmN0aW9uIGxvYWRSZWZ1bmQoKSBleHRlcm5hbCBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gd2FsbGV0KTsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+IDApOwogICAgICAgIHJlcXVpcmUoIWlzTWluaW11bUdvYWxSZWFjaGVkKCkpOwogICAgICAgIAogICAgICAgIGxvYWRlZFJlZnVuZCA9IGxvYWRlZFJlZnVuZC5hZGQobXNnLnZhbHVlKTsKCiAgICAgICAgUmVmdW5kTG9hZGVkKG1zZy52YWx1ZSk7CiAgICB9CgogICAgLyoqCiAgICAqIEJ1eWVycyBjYW4gY2xhaW0gcmVmdW5kLgogICAgKgogICAgKiBOb3RlIHRoYXQgYW55IHJlZnVuZHMgZnJvbSBwcm94eSBidXllcnMgc2hvdWxkIGJlIGhhbmRsZWQgc2VwYXJhdGVseSwKICAgICogYW5kIG5vdCB0aHJvdWdoIHRoaXMgY29udHJhY3QuCiAgICAqLwogICAgZnVuY3Rpb24gcmVmdW5kKCkgZXh0ZXJuYWwgewogICAgICAgIHJlcXVpcmUoIWlzTWluaW11bUdvYWxSZWFjaGVkKCkgJiYgbG9hZGVkUmVmdW5kID4gMCk7CiAgICAgICAgcmVxdWlyZSghaXNFeHRlcm5hbEJ1eWVyW21zZy5zZW5kZXJdKTsKICAgICAgICB1aW50IHdlaVZhbHVlID0gYm91Z2h0QW1vdW50T2ZbbXNnLnNlbmRlcl07CiAgICAgICAgcmVxdWlyZSh3ZWlWYWx1ZSA+IDApOwogICAgICAgIAogICAgICAgIGJvdWdodEFtb3VudE9mW21zZy5zZW5kZXJdID0gMDsKICAgICAgICB3ZWlSZWZ1bmRlZCA9IHdlaVJlZnVuZGVkLmFkZCh3ZWlWYWx1ZSk7CiAgICAgICAgbXNnLnNlbmRlci50cmFuc2Zlcih3ZWlWYWx1ZSk7CgogICAgICAgIFJlZnVuZChtc2cuc2VuZGVyLCB3ZWlWYWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gcmVnaXN0ZXJQYXltZW50KGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQgdG9rZW5BbW91bnQsIHVpbnQgd2VpQW1vdW50KSBwdWJsaWMgb25seU93bmVyT3JBZG1pbiB7CiAgICAgICAgcmVxdWlyZSh2YWxpZFB1cmNoYXNlKHdlaUFtb3VudCkpOwogICAgICAgIGlzRXh0ZXJuYWxCdXllcltiZW5lZmljaWFyeV0gPSB0cnVlOwogICAgICAgIG1pbnRUb2tlblRvQnV5ZXIoYmVuZWZpY2lhcnksIHRva2VuQW1vdW50LCB3ZWlBbW91bnQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlZ2lzdGVyUGF5bWVudHMoYWRkcmVzc1tdIGJlbmVmaWNpYXJpZXMsIHVpbnRbXSB0b2tlbkFtb3VudHMsIHVpbnRbXSB3ZWlBbW91bnRzKSBleHRlcm5hbCBvbmx5T3duZXJPckFkbWluIHsKICAgICAgICByZXF1aXJlKGJlbmVmaWNpYXJpZXMubGVuZ3RoID09IHRva2VuQW1vdW50cy5sZW5ndGgpOwogICAgICAgIHJlcXVpcmUodG9rZW5BbW91bnRzLmxlbmd0aCA9PSB3ZWlBbW91bnRzLmxlbmd0aCk7CgogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IGJlbmVmaWNpYXJpZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgcmVnaXN0ZXJQYXltZW50KGJlbmVmaWNpYXJpZXNbaV0sIHRva2VuQW1vdW50c1tpXSwgd2VpQW1vdW50c1tpXSk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHNldEFkbWluKGFkZHJlc3MgYWRtaW5BZGRyZXNzKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIGFkbWluID0gYWRtaW5BZGRyZXNzOwogICAgfQp9CgovLyBGaWxlOiBjb250cmFjdHMvcHJlc2FsZS9QcmVzYWxlLnNvbAoKLyoqCiAqIEB0aXRsZSBQcmVzYWxlCiAqIEBkZXYgUHJlc2FsZSBpcyBhIGNvbnRyYWN0IGZvciBtYW5hZ2luZyBhIHRva2VuIGNyb3dkc2FsZS4KICogUHJlc2FsZXMgaGF2ZSBhIHN0YXJ0IGFuZCBlbmQgdGltZXN0YW1wcywgd2hlcmUgYnV5ZXJzIGNhbiBtYWtlCiAqIHRva2VuIHB1cmNoYXNlcyBhbmQgdGhlIGNyb3dkc2FsZSB3aWxsIGFzc2lnbiB0aGVtIHRva2VucyBiYXNlZAogKiBvbiBhIHRva2VuIHBlciBFVEggcmF0ZS4gRnVuZHMgY29sbGVjdGVkIGFyZSBmb3J3YXJkZWQgdG8gYSB3YWxsZXQKICogYXMgdGhleSBhcnJpdmUuCiAqLwpjb250cmFjdCBQcmVzYWxlIGlzIFNhbGVCYXNlIHsKICAgIGZ1bmN0aW9uIFByZXNhbGUoCiAgICAgICAgdWludCBfc3RhcnRUaW1lLAogICAgICAgIHVpbnQgX2VuZFRpbWUsCiAgICAgICAgSVByaWNpbmdTdHJhdGVneSBfcHJpY2luZ1N0cmF0ZWd5LAogICAgICAgIFBsYXlIYWxsVG9rZW4gX3Rva2VuLAogICAgICAgIGFkZHJlc3MgX3dhbGxldCwKICAgICAgICB1aW50IF93ZWlNYXhpbXVtR29hbCwKICAgICAgICB1aW50IF93ZWlNaW5pbXVtR29hbCwKICAgICAgICB1aW50IF93ZWlNaW5pbXVtQW1vdW50LAogICAgICAgIGFkZHJlc3MgX2FkbWluCiAgICApIHB1YmxpYyBTYWxlQmFzZSgKICAgICAgICBfc3RhcnRUaW1lLAogICAgICAgIF9lbmRUaW1lLAogICAgICAgIF9wcmljaW5nU3RyYXRlZ3ksCiAgICAgICAgX3Rva2VuLAogICAgICAgIF93YWxsZXQsCiAgICAgICAgX3dlaU1heGltdW1Hb2FsLAogICAgICAgIF93ZWlNaW5pbXVtR29hbCwKICAgICAgICBfd2VpTWluaW11bUFtb3VudCwKICAgICAgICBfYWRtaW4pIAogICAgewoKICAgIH0KCiAgICBmdW5jdGlvbiBjaGFuZ2VUb2tlbk1pbnRlcihhZGRyZXNzIG5ld01pbnRlcikgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG5ld01pbnRlciAhPSAweDApOwogICAgICAgIHJlcXVpcmUoaGFzRW5kZWQoKSk7CgogICAgICAgIHRva2VuLnNldE1pbnRlcihuZXdNaW50ZXIpOwogICAgfQp9'.
	

]
