Class {
	#name : #SRT393b5fd2b993eaf419fbadab630bc9bd3d5792e9,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT393b5fd2b993eaf419fbadab630bc9bd3d5792e9 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7IC8vIHNvbGhpbnQtZGlzYWJsZS1saW5lCgoKCi8vLyBAdGl0bGUgSW50ZXJmYWNlIGZvciBjb250cmFjdHMgY29uZm9ybWluZyB0byBFUkMtNzIxOiBOb24tRnVuZ2libGUgVG9rZW5zCi8vLyBAYXV0aG9yIERpZXRlciBTaGlybGV5IDw8YSBocmVmPSIvY2RuLWNnaS9sL2VtYWlsLXByb3RlY3Rpb24iIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iMTU3MTcwNjE3MDU1NzQ2ZDdjN2E3ODZmNzA3YjNiNzY3YSI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvYT4+IChodHRwczovL2dpdGh1Yi5jb20vZGV0ZSkKY29udHJhY3QgRVJDNzIxIHsKICAvLyBSZXF1aXJlZCBtZXRob2RzCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljOwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKICBmdW5jdGlvbiBpbXBsZW1lbnRzRVJDNzIxKCkgcHVibGljIHB1cmUgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzIGFkZHIpOwogIGZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JZCkgcHVibGljOwogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiB0b3RhbCk7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWM7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYzsKCiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB0b2tlbklkKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBhcHByb3ZlZCwgdWludDI1NiB0b2tlbklkKTsKCiAgLy8gT3B0aW9uYWwKICAvLyBmdW5jdGlvbiBuYW1lKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nIG5hbWUpOwogIC8vIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZyBzeW1ib2wpOwogIC8vIGZ1bmN0aW9uIHRva2VuT2ZPd25lckJ5SW5kZXgoYWRkcmVzcyBfb3duZXIsIHVpbnQyNTYgX2luZGV4KSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYgdG9rZW5JZCk7CiAgLy8gZnVuY3Rpb24gdG9rZW5NZXRhZGF0YSh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcgaW5mb1VybCk7Cn0KCgpjb250cmFjdCBPcGluaW9uVG9rZW4gaXMgRVJDNzIxIHsKCiAgLyoqKiBFVkVOVFMgKioqLwoKICAvLy8gQGRldiBUaGUgQmlydGggZXZlbnQgaXMgZmlyZWQgd2hlbmV2ZXIgYSBuZXcgb3BpbmlvbiBjb21lcyBpbnRvIGV4aXN0ZW5jZS4KICBldmVudCBCaXJ0aCh1aW50MjU2IHRva2VuSWQsIHN0cmluZyBuYW1lLCBhZGRyZXNzIG93bmVyKTsKCiAgLy8vIEBkZXYgVGhlIFRva2VuU29sZCBldmVudCBpcyBmaXJlZCB3aGVuZXZlciBhIHRva2VuIGlzIHNvbGQuCiAgZXZlbnQgVG9rZW5Tb2xkKHVpbnQyNTYgdG9rZW5JZCwgdWludDI1NiBvbGRQcmljZSwgdWludDI1NiBuZXdQcmljZSwgYWRkcmVzcyBwcmV2T3duZXIsIGFkZHJlc3Mgd2lubmVyLCBzdHJpbmcgbmFtZSk7CgogIC8vLyBAZGV2IFRyYW5zZmVyIGV2ZW50IGFzIGRlZmluZWQgaW4gY3VycmVudCBkcmFmdCBvZiBFUkM3MjEuIAogIC8vLyAgb3duZXJzaGlwIGlzIGFzc2lnbmVkLCBpbmNsdWRpbmcgYmlydGhzLgogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB0b2tlbklkKTsKCiAgLyoqKiBDT05TVEFOVFMgKioqLwoKICAvLy8gQG5vdGljZSBOYW1lIGFuZCBzeW1ib2wgb2YgdGhlIG5vbiBmdW5naWJsZSB0b2tlbiwgYXMgZGVmaW5lZCBpbiBFUkM3MjEuCiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBOQU1FID0gIkNyeXB0b3BpbmlvbnMiOyAvLyBzb2xoaW50LWRpc2FibGUtbGluZQogIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgU1lNQk9MID0gIk9waW5pb25Ub2tlbiI7IC8vIHNvbGhpbnQtZGlzYWJsZS1saW5lCiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBERUZBVUxUX1RFWFQgPSAiIjsKCiAgdWludDI1NiBwcml2YXRlIGZpcnN0U3RlcExpbWl0ID0gIDAuMDUzNjEzIGV0aGVyOwogIHVpbnQyNTYgcHJpdmF0ZSBzZWNvbmRTdGVwTGltaXQgPSAwLjU2NDk1NyBldGhlcjsKICB1aW50MjU2IHByaXZhdGUgbnVtSXNzdWVkPTU7IC8vbnVtYmVyIG9mIHRva2VucyBpc3N1ZWQgaW5pdGlhbGx5CiAgdWludDI1NiBwcml2YXRlIGNvbnN0YW50IHN0ZXBNdWx0aXBsaWVyPTI7Ly9tdWx0aXBsaWVyIGZvciBpbml0aWFsIG9waW5pb24gcmVnaXN0cmF0aW9uIGNvc3QsIG5vdCBzcG9uc29yc2hpcAogIHVpbnQyNTYgcHJpdmF0ZSBzdGFydGluZ1ByaWNlID0gMC4wMDEgZXRoZXI7IC8vd2lsbCBpbmNyZWFzZSBldmVyeSB0b2tlbiBpc3N1ZWQgYnkgc3RlcE11bHRpcGxpZXIgdGltZXMKICB1aW50MjU2IHByaXZhdGUgc3BvbnNvclN0YXJ0aW5nQ29zdD0wLjAxIGV0aGVyOy8vaW5pdGlhbCBjb3N0IHRvIHNwb25zb3IgYW4gb3BpbmlvbgogIC8vdWludDI1NiBwcml2YXRlIGN1cnJlbnRJc3N1ZVJlbWFpbmluZzsKICAvKioqIFNUT1JBR0UgKioqLwoKICAvLy8gQGRldiBBIG1hcHBpbmcgZnJvbSBvcGluaW9uIElEcyB0byB0aGUgYWRkcmVzcyB0aGF0IG93bnMgdGhlbS4gQWxsIG9waW5pb25zIGhhdmUKICAvLy8gIHNvbWUgdmFsaWQgb3duZXIgYWRkcmVzcy4KICBtYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIHB1YmxpYyBvcGluaW9uSW5kZXhUb093bmVyOwoKICAvLyBAZGV2IEEgbWFwcGluZyBmcm9tIG93bmVyIGFkZHJlc3MgdG8gY291bnQgb2YgdG9rZW5zIHRoYXQgYWRkcmVzcyBvd25zLgogIC8vICBVc2VkIGludGVybmFsbHkgaW5zaWRlIGJhbGFuY2VPZigpIHRvIHJlc29sdmUgb3duZXJzaGlwIGNvdW50LgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHJpdmF0ZSBvd25lcnNoaXBUb2tlbkNvdW50OwoKICAvLy8gQGRldiBBIG1hcHBpbmcgZnJvbSBvcGluaW9uSURzIHRvIGFuIGFkZHJlc3MgdGhhdCBoYXMgYmVlbiBhcHByb3ZlZCB0byBjYWxsCiAgLy8vICB0cmFuc2ZlckZyb20oKS4gRWFjaCBvcGluaW9uIGNhbiBvbmx5IGhhdmUgb25lIGFwcHJvdmVkIGFkZHJlc3MgZm9yIHRyYW5zZmVyCiAgLy8vICBhdCBhbnkgdGltZS4gQSB6ZXJvIHZhbHVlIG1lYW5zIG5vIGFwcHJvdmFsIGlzIG91dHN0YW5kaW5nLgogIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgcHVibGljIG9waW5pb25JbmRleFRvQXBwcm92ZWQ7CgogIC8vIEBkZXYgQSBtYXBwaW5nIGZyb20gb3BpbmlvbklEcyB0byB0aGUgcHJpY2Ugb2YgdGhlIHRva2VuLgogIG1hcHBpbmcgKHVpbnQyNTYgPT4gdWludDI1NikgcHJpdmF0ZSBvcGluaW9uSW5kZXhUb1ByaWNlOwogIAogIC8vIFRoZSBhZGRyZXNzZXMgb2YgdGhlIGFjY291bnRzIChvciBjb250cmFjdHMpIHRoYXQgY2FuIGV4ZWN1dGUgYWN0aW9ucyB3aXRoaW4gZWFjaCByb2xlcy4KICBhZGRyZXNzIHB1YmxpYyBjZW9BZGRyZXNzOwogIGFkZHJlc3MgcHVibGljIGNvb0FkZHJlc3M7CgogIC8qKiogREFUQVRZUEVTICoqKi8KICBzdHJ1Y3QgT3BpbmlvbiB7CiAgICBzdHJpbmcgdGV4dDsKICAgIGJvb2wgY2xhaW1lZDsKICAgIGJvb2wgZGVsZXRlZDsKICAgIHVpbnQ4IGNvbW1lbnQ7CiAgICBhZGRyZXNzIHNwb25zb3I7CiAgICBhZGRyZXNzIGFudGlzcG9uc29yOwogICAgdWludDI1NiB0b3RhbHNwb25zb3JlZDsKICAgIHVpbnQyNTYgdG90YWxhbnRpc3BvbnNvcmVkOwogICAgdWludDI1NiB0aW1lc3RhbXA7CiAgfQoKICBPcGluaW9uW10gcHJpdmF0ZSBvcGluaW9uczsKCiAgLyoqKiBBQ0NFU1MgTU9ESUZJRVJTICoqKi8KICAvLy8gQGRldiBBY2Nlc3MgbW9kaWZpZXIgZm9yIENFTy1vbmx5IGZ1bmN0aW9uYWxpdHkKICBtb2RpZmllciBvbmx5Q0VPKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNlb0FkZHJlc3MpOwogICAgXzsKICB9CgogIC8vLyBAZGV2IEFjY2VzcyBtb2RpZmllciBmb3IgQ09PLW9ubHkgZnVuY3Rpb25hbGl0eQogIG1vZGlmaWVyIG9ubHlDT08oKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY29vQWRkcmVzcyk7CiAgICBfOwogIH0KCiAgLy8vIEFjY2VzcyBtb2RpZmllciBmb3IgY29udHJhY3Qgb3duZXIgb25seSBmdW5jdGlvbmFsaXR5CiAgbW9kaWZpZXIgb25seUNMZXZlbCgpIHsKICAgIHJlcXVpcmUoCiAgICAgIG1zZy5zZW5kZXIgPT0gY2VvQWRkcmVzcyB8fAogICAgICBtc2cuc2VuZGVyID09IGNvb0FkZHJlc3MKICAgICk7CiAgICBfOwogIH0KCiAgLyoqKiBDT05TVFJVQ1RPUiAqKiovCiAgZnVuY3Rpb24gT3BpbmlvblRva2VuKCkgcHVibGljIHsKICAgIGNlb0FkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgY29vQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgfQoKICAvKioqIFBVQkxJQyBGVU5DVElPTlMgKioqLwogIC8vLyBAbm90aWNlIEdyYW50IGFub3RoZXIgYWRkcmVzcyB0aGUgcmlnaHQgdG8gdHJhbnNmZXIgdG9rZW4gdmlhIHRha2VPd25lcnNoaXAoKSBhbmQgdHJhbnNmZXJGcm9tKCkuCiAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gYmUgZ3JhbnRlZCB0cmFuc2ZlciBhcHByb3ZhbC4gUGFzcyBhZGRyZXNzKDApIHRvCiAgLy8vICBjbGVhciBhbGwgYXBwcm92YWxzLgogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIElEIG9mIHRoZSBUb2tlbiB0aGF0IGNhbiBiZSB0cmFuc2ZlcnJlZCBpZiB0aGlzIGNhbGwgc3VjY2VlZHMuCiAgLy8vIEBkZXYgUmVxdWlyZWQgZm9yIEVSQy03MjEgY29tcGxpYW5jZS4KICBmdW5jdGlvbiBhcHByb3ZlKAogICAgYWRkcmVzcyBfdG8sCiAgICB1aW50MjU2IF90b2tlbklkCiAgKSBwdWJsaWMgewogICAgLy8gQ2FsbGVyIG11c3Qgb3duIHRva2VuLgogICAgcmVxdWlyZShfb3ducyhtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwoKICAgIG9waW5pb25JbmRleFRvQXBwcm92ZWRbX3Rva2VuSWRdID0gX3RvOwoKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF90bywgX3Rva2VuSWQpOwogIH0KCiAgLy8vIEZvciBxdWVyeWluZyBiYWxhbmNlIG9mIGEgcGFydGljdWxhciBhY2NvdW50CiAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgZm9yIGJhbGFuY2UgcXVlcnkKICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gb3duZXJzaGlwVG9rZW5Db3VudFtfb3duZXJdOwogIH0KICAvLy8gQGRldiBDcmVhdGVzIGluaXRpYWwgc2V0IG9mIG9waW5pb25zLiBDYW4gb25seSBiZSBjYWxsZWQgb25jZS4KICBmdW5jdGlvbiBjcmVhdGVJbml0aWFsSXRlbXMoKSBwdWJsaWMgb25seUNPTyB7CiAgICByZXF1aXJlKG9waW5pb25zLmxlbmd0aD09MCk7CiAgICBfY3JlYXRlT3BpbmlvblNldCgpOwogIH0KCiAgLy8vIEBub3RpY2UgUmV0dXJucyBhbGwgdGhlIHJlbGV2YW50IGluZm9ybWF0aW9uIGFib3V0IGEgc3BlY2lmaWMgb3Bpbmlvbi4KICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSB0b2tlbklkIG9mIHRoZSBvcGluaW9uIG9mIGludGVyZXN0LgogIGZ1bmN0aW9uIGdldE9waW5pb24odWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoCiAgICB1aW50MjU2IHNlbGxpbmdQcmljZSwKICAgIGFkZHJlc3Mgb3duZXIsCiAgICBhZGRyZXNzIHNwb25zb3IsCiAgICBhZGRyZXNzIGFudGlzcG9uc29yLAogICAgdWludDI1NiBhbW91bnRzcG9uc29yZWQsCiAgICB1aW50MjU2IGFtb3VudGFudGlzcG9uc29yZWQsCiAgICB1aW50OCBhY29tbWVudCwKICAgIHVpbnQyNTYgdGltZXN0YW1wLAogICAgc3RyaW5nIG9waW5pb25UZXh0CiAgKSB7CiAgICBPcGluaW9uIHN0b3JhZ2Ugb3BpbmlvbiA9IG9waW5pb25zW190b2tlbklkXTsKICAgIG9waW5pb25UZXh0ID0gb3Bpbmlvbi50ZXh0OwogICAgc2VsbGluZ1ByaWNlID0gb3BpbmlvbkluZGV4VG9QcmljZVtfdG9rZW5JZF07CiAgICBvd25lciA9IG9waW5pb25JbmRleFRvT3duZXJbX3Rva2VuSWRdOwogICAgYWNvbW1lbnQ9b3Bpbmlvbi5jb21tZW50OwogICAgc3BvbnNvcj1vcGluaW9uLnNwb25zb3I7CiAgICBhbnRpc3BvbnNvcj1vcGluaW9uLmFudGlzcG9uc29yOwogICAgYW1vdW50c3BvbnNvcmVkPW9waW5pb24udG90YWxzcG9uc29yZWQ7CiAgICBhbW91bnRhbnRpc3BvbnNvcmVkPW9waW5pb24udG90YWxhbnRpc3BvbnNvcmVkOwogICAgdGltZXN0YW1wPW9waW5pb24udGltZXN0YW1wOwogIH0KCiAgZnVuY3Rpb24gY29tcGFyZVN0cmluZ3MgKHN0cmluZyBhLCBzdHJpbmcgYikgcHVibGljIHB1cmUgcmV0dXJucyAoYm9vbCl7CiAgICAgICByZXR1cm4ga2VjY2FrMjU2KGEpID09IGtlY2NhazI1NihiKTsKICAgfQogIAogIGZ1bmN0aW9uIGhhc0R1cGxpY2F0ZShzdHJpbmcgX3RvY2hlY2spIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpewogICAgcmV0dXJuIGhhc1ByaW9yRHVwbGljYXRlKF90b2NoZWNrLG9waW5pb25zLmxlbmd0aCk7CiAgfQogIAogIGZ1bmN0aW9uIGhhc1ByaW9yRHVwbGljYXRlKHN0cmluZyBfdG9jaGVjayx1aW50MjU2IGluZGV4KSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKXsKICAgIGZvcih1aW50IGkgPSAwOyBpPGluZGV4OyBpKyspewogICAgICAgIGlmKGNvbXBhcmVTdHJpbmdzKF90b2NoZWNrLG9waW5pb25zW2ldLnRleHQpKXsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIGZhbHNlOwogIH0KICAKICBmdW5jdGlvbiBpbXBsZW1lbnRzRVJDNzIxKCkgcHVibGljIHB1cmUgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgcHVyZSByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBOQU1FOwogIH0KCiAgLy8vIEZvciBxdWVyeWluZyBvd25lciBvZiB0b2tlbgogIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIHRva2VuSUQgZm9yIG93bmVyIGlucXVpcnkKICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkKICAgIHB1YmxpYwogICAgdmlldwogICAgcmV0dXJucyAoYWRkcmVzcyBvd25lcikKICB7CiAgICBvd25lciA9IG9waW5pb25JbmRleFRvT3duZXJbX3Rva2VuSWRdOwogICAgcmVxdWlyZShvd25lciAhPSBhZGRyZXNzKDApKTsKICB9CgogIGZ1bmN0aW9uIHBheW91dChhZGRyZXNzIF90bykgcHVibGljIG9ubHlDTGV2ZWwgewogICAgX3BheW91dChfdG8pOwogIH0KCiAgZnVuY3Rpb24gc3BvbnNvck9waW5pb24odWludDI1NiBfdG9rZW5JZCx1aW50OCBjb21tZW50LGJvb2wgX2xpa2VzT3BpbmlvbikgcHVibGljIHBheWFibGUgewogICAgICAvL2Vuc3VyZSBjb21tZW50IGNvcnJlc3BvbmRzIHRvIHN0YXR1cyBvZiB0b2tlbi4gVG9rZW5zIHdpdGggYSBjb21tZW50IG9mIDAgYXJlIHVucmVnaXN0ZXJlZC4KICAgICAgcmVxdWlyZShjb21tZW50IT0wKTsKICAgICAgcmVxdWlyZSgoX2xpa2VzT3BpbmlvbiAmJiBjb21tZW50PDEwMCkgfHwgKCFfbGlrZXNPcGluaW9uICYmIGNvbW1lbnQ+MTAwKSk7CiAgICAgIGFkZHJlc3Mgc3BvbnNvckFkciA9IG1zZy5zZW5kZXI7CiAgICAgIHJlcXVpcmUoX2FkZHJlc3NOb3ROdWxsKHNwb25zb3JBZHIpKTsKICAgICAgLy8gTWFraW5nIHN1cmUgc2VudCBhbW91bnQgaXMgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIHRoZSBzZWxsaW5nUHJpY2UKICAgICAgdWludDI1NiBzZWxsaW5nUHJpY2UgPSBvcGluaW9uSW5kZXhUb1ByaWNlW190b2tlbklkXTsKICAgICAgYWRkcmVzcyBjdXJyZW50T3duZXI9b3BpbmlvbkluZGV4VG9Pd25lcltfdG9rZW5JZF07CiAgICAgIGFkZHJlc3MgbmV3T3duZXIgPSBtc2cuc2VuZGVyOwogICAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChuZXdPd25lcikpOwogICAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChjdXJyZW50T3duZXIpKTsKICAgICAgcmVxdWlyZShtc2cudmFsdWUgPj0gc2VsbGluZ1ByaWNlKTsKICAgICAgdWludDI1NiBwYXltZW50ID0gdWludDI1NihTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKHNlbGxpbmdQcmljZSwgOTApLCAxMDApKTsKICAgICAgdWludDI1NiBvd25lclRha2U9dWludDI1NihTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKHNlbGxpbmdQcmljZSwgMTApLCAxMDApKTsKICAgICAgdWludDI1NiBwdXJjaGFzZUV4Y2VzcyA9IFNhZmVNYXRoLnN1Yihtc2cudmFsdWUsIHNlbGxpbmdQcmljZSk7CiAgICAgICAgICAvLyBVcGRhdGUgcHJpY2VzCiAgICBpZiAoc2VsbGluZ1ByaWNlIDwgZmlyc3RTdGVwTGltaXQpIHsKICAgICAgLy8gZmlyc3Qgc3RhZ2UKICAgICAgb3BpbmlvbkluZGV4VG9QcmljZVtfdG9rZW5JZF0gPSBTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKHNlbGxpbmdQcmljZSwgMjAwKSwgOTApOwogICAgfSBlbHNlIGlmIChzZWxsaW5nUHJpY2UgPCBzZWNvbmRTdGVwTGltaXQpIHsKICAgICAgLy8gc2Vjb25kIHN0YWdlCiAgICAgIG9waW5pb25JbmRleFRvUHJpY2VbX3Rva2VuSWRdID0gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChzZWxsaW5nUHJpY2UsIDEyMCksIDkwKTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIHRoaXJkIHN0YWdlCiAgICAgIG9waW5pb25JbmRleFRvUHJpY2VbX3Rva2VuSWRdID0gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChzZWxsaW5nUHJpY2UsIDExNSksIDkwKTsKICAgIH0KICAgIE9waW5pb24gc3RvcmFnZSBvcGluaW9uID0gb3BpbmlvbnNbX3Rva2VuSWRdOwogICAgcmVxdWlyZShvcGluaW9uLmNsYWltZWQpOwogICAgcmVxdWlyZShzcG9uc29yQWRyIT1vcGluaW9uLnNwb25zb3IpOwogICAgcmVxdWlyZShzcG9uc29yQWRyIT1vcGluaW9uLmFudGlzcG9uc29yKTsKICAgIHJlcXVpcmUoc3BvbnNvckFkciE9Y3VycmVudE93bmVyKTsKICAgIG9waW5pb24uY29tbWVudD1jb21tZW50OwogICAgaWYoX2xpa2VzT3Bpbmlvbil7CiAgICAgICAgaWYoX2FkZHJlc3NOb3ROdWxsKG9waW5pb24uc3BvbnNvcikpewogICAgICAgICAgICBvcGluaW9uLnNwb25zb3IudHJhbnNmZXIocGF5bWVudCk7CiAgICAgICAgICAgIGN1cnJlbnRPd25lci50cmFuc2Zlcihvd25lclRha2UpOwogICAgICAgIH0KICAgICAgICBlbHNlewogICAgICAgICAgICBjdXJyZW50T3duZXIudHJhbnNmZXIoc2VsbGluZ1ByaWNlKTsKICAgICAgICB9CiAgICAgICAgb3Bpbmlvbi5zcG9uc29yPXNwb25zb3JBZHI7CiAgICAgICAgb3Bpbmlvbi50b3RhbHNwb25zb3JlZD1TYWZlTWF0aC5hZGQob3Bpbmlvbi50b3RhbHNwb25zb3JlZCxzZWxsaW5nUHJpY2UpOwogICAgfQogICAgZWxzZXsKICAgICAgICBpZihfYWRkcmVzc05vdE51bGwob3Bpbmlvbi5zcG9uc29yKSl7CiAgICAgICAgICAgIG9waW5pb24uYW50aXNwb25zb3IudHJhbnNmZXIocGF5bWVudCk7CiAgICAgICAgICAgIGNlb0FkZHJlc3MudHJhbnNmZXIob3duZXJUYWtlKTsKICAgICAgICB9CiAgICAgICAgZWxzZXsKICAgICAgICAgICAgY2VvQWRkcmVzcy50cmFuc2ZlcihzZWxsaW5nUHJpY2UpOyAvL2V0aCBmb3IgaW5pdGlhbCBhbnRpc3BvbnNvciBnb2VzIHRvIENyeXB0b3BpbmlvbnMsIGJlY2F1c2UgeW91IHdvdWxkbid0IHdhbnQgaXQgdG8gZ28gdG8gdGhlIGNyZWF0b3Igb2YgYW4gb3BpbmlvbiB5b3UgZG9uJ3QgbGlrZQogICAgICAgIH0KICAgICAgICBvcGluaW9uLmFudGlzcG9uc29yPXNwb25zb3JBZHI7CiAgICAgICAgb3Bpbmlvbi50b3RhbGFudGlzcG9uc29yZWQ9U2FmZU1hdGguYWRkKG9waW5pb24udG90YWxhbnRpc3BvbnNvcmVkLHNlbGxpbmdQcmljZSk7CiAgICB9CiAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHB1cmNoYXNlRXhjZXNzKTsKICB9CiAgCiAgLy9sZXRzIHlvdSBwZXJtYW5lbnRseSBkZWxldGUgc29tZW9uZSBlbHNlcyBvcGluaW9uLgogIGZ1bmN0aW9uIGRlbGV0ZVRoaXModWludDI1NiBfdG9rZW5JZCkgcHVibGljIHBheWFibGV7CiAgICAvL0Nvc3QgaXMgMSBldGggb3IgZml2ZSB0aW1lcyB0aGUgY3VycmVudCB2YWx1YXRpb24gb2YgdGhlIG9waW5pb24sIHdoaWNoZXZlciBpcyBoaWdoZXIuCiAgICB1aW50MjU2IHNlbGxpbmdQcmljZSA9IFNhZmVNYXRoLm11bChvcGluaW9uSW5kZXhUb1ByaWNlW190b2tlbklkXSw1KTsKICAgIGlmKHNlbGxpbmdQcmljZTwxIGV0aGVyKXsKICAgICAgICBzZWxsaW5nUHJpY2U9MSBldGhlcjsKICAgIH0KICAgIHJlcXVpcmUobXNnLnZhbHVlID49IHNlbGxpbmdQcmljZSk7CiAgICBjZW9BZGRyZXNzLnRyYW5zZmVyKHNlbGxpbmdQcmljZSk7CiAgICBPcGluaW9uIHN0b3JhZ2Ugb3BpbmlvbiA9IG9waW5pb25zW190b2tlbklkXTsKICAgIG9waW5pb24uZGVsZXRlZD10cnVlOwogICAgdWludDI1NiBwdXJjaGFzZUV4Y2VzcyA9IFNhZmVNYXRoLnN1Yihtc2cudmFsdWUsIHNlbGxpbmdQcmljZSk7CiAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHB1cmNoYXNlRXhjZXNzKTsKICB9CiAgCiAgLy8gQWxsb3dzIHNvbWVvbmUgdG8gc2VuZCBldGhlciBhbmQgb2J0YWluIHRoZSAodW5jbGFpbWVkIG9ubHkpIHRva2VuCiAgZnVuY3Rpb24gcmVnaXN0ZXJPcGluaW9uKHVpbnQyNTYgX3Rva2VuSWQsc3RyaW5nIF9uZXdPcGluaW9uKSBwdWJsaWMgcGF5YWJsZSB7CiAgICAKICAgIC8vU2V0IG9waW5pb24gdG8gdGhlIG5ldyBvcGluaW9uCiAgICBfaW5pdE9waW5pb24oX3Rva2VuSWQsX25ld09waW5pb24pOwogICAgCiAgICBhZGRyZXNzIG9sZE93bmVyID0gb3BpbmlvbkluZGV4VG9Pd25lcltfdG9rZW5JZF07CiAgICBhZGRyZXNzIG5ld093bmVyID0gbXNnLnNlbmRlcjsKCiAgICB1aW50MjU2IHNlbGxpbmdQcmljZSA9IG9waW5pb25JbmRleFRvUHJpY2VbX3Rva2VuSWRdOwoKICAgIC8vIE1ha2luZyBzdXJlIHRva2VuIG93bmVyIGlzIG5vdCBzZW5kaW5nIHRvIHNlbGYKICAgIHJlcXVpcmUob2xkT3duZXIgIT0gbmV3T3duZXIpOwoKICAgIC8vIFNhZmV0eSBjaGVjayB0byBwcmV2ZW50IGFnYWluc3QgYW4gdW5leHBlY3RlZCAweDAgZGVmYXVsdC4KICAgIHJlcXVpcmUoX2FkZHJlc3NOb3ROdWxsKG5ld093bmVyKSk7CgogICAgLy8gTWFraW5nIHN1cmUgc2VudCBhbW91bnQgaXMgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIHRoZSBzZWxsaW5nUHJpY2UKICAgIHJlcXVpcmUobXNnLnZhbHVlID49IHNlbGxpbmdQcmljZSk7CiAgICAKICAgIHVpbnQyNTYgcGF5bWVudCA9IHNlbGxpbmdQcmljZTsKICAgIHVpbnQyNTYgcHVyY2hhc2VFeGNlc3MgPSBTYWZlTWF0aC5zdWIobXNnLnZhbHVlLCBzZWxsaW5nUHJpY2UpOwogICAgb3BpbmlvbkluZGV4VG9QcmljZVtfdG9rZW5JZF0gPSBzcG9uc29yU3RhcnRpbmdDb3N0OyAvL2luaXRpYWwgY29zdCB0byBzcG9uc29yCgogICAgX3RyYW5zZmVyKG9sZE93bmVyLCBuZXdPd25lciwgX3Rva2VuSWQpOwoKICAgIGNlb0FkZHJlc3MudHJhbnNmZXIocGF5bWVudCk7CgogICAgVG9rZW5Tb2xkKF90b2tlbklkLCBzZWxsaW5nUHJpY2UsIG9waW5pb25JbmRleFRvUHJpY2VbX3Rva2VuSWRdLCBvbGRPd25lciwgbmV3T3duZXIsIG9waW5pb25zW190b2tlbklkXS50ZXh0KTsKCiAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHB1cmNoYXNlRXhjZXNzKTsKICB9CgogIGZ1bmN0aW9uIHByaWNlT2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBwcmljZSkgewogICAgcmV0dXJuIG9waW5pb25JbmRleFRvUHJpY2VbX3Rva2VuSWRdOwogIH0KCiAgLy8vIEBkZXYgQXNzaWducyBhIG5ldyBhZGRyZXNzIHRvIGFjdCBhcyB0aGUgQ0VPLiBPbmx5IGF2YWlsYWJsZSB0byB0aGUgY3VycmVudCBDRU8uCiAgLy8vIEBwYXJhbSBfbmV3Q0VPIFRoZSBhZGRyZXNzIG9mIHRoZSBuZXcgQ0VPCiAgZnVuY3Rpb24gc2V0Q0VPKGFkZHJlc3MgX25ld0NFTykgcHVibGljIG9ubHlDRU8gewogICAgX3NldENFTyhfbmV3Q0VPKTsKICB9CiAgIGZ1bmN0aW9uIF9zZXRDRU8oYWRkcmVzcyBfbmV3Q0VPKSBwcml2YXRlewogICAgICAgICByZXF1aXJlKF9uZXdDRU8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgIGNlb0FkZHJlc3MgPSBfbmV3Q0VPOwogICB9CiAgLy8vIEBkZXYgQXNzaWducyBhIG5ldyBhZGRyZXNzIHRvIGFjdCBhcyB0aGUgQ09PLiBPbmx5IGF2YWlsYWJsZSB0byB0aGUgY3VycmVudCBDT08uCiAgLy8vIEBwYXJhbSBfbmV3Q09PIFRoZSBhZGRyZXNzIG9mIHRoZSBuZXcgQ09PCiAgZnVuY3Rpb24gc2V0Q09PKGFkZHJlc3MgX25ld0NPTykgcHVibGljIG9ubHlDRU8gewogICAgcmVxdWlyZShfbmV3Q09PICE9IGFkZHJlc3MoMCkpOwoKICAgIGNvb0FkZHJlc3MgPSBfbmV3Q09POwogIH0KCiAgLy8vIEBkZXYgUmVxdWlyZWQgZm9yIEVSQy03MjEgY29tcGxpYW5jZS4KICBmdW5jdGlvbiBzeW1ib2woKSBwdWJsaWMgcHVyZSByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBTWU1CT0w7CiAgfQoKICAvLy8gQG5vdGljZSBBbGxvdyBwcmUtYXBwcm92ZWQgdXNlciB0byB0YWtlIG93bmVyc2hpcCBvZiBhIHRva2VuCiAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgSUQgb2YgdGhlIFRva2VuIHRoYXQgY2FuIGJlIHRyYW5zZmVycmVkIGlmIHRoaXMgY2FsbCBzdWNjZWVkcy4KICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHsKICAgIGFkZHJlc3MgbmV3T3duZXIgPSBtc2cuc2VuZGVyOwogICAgYWRkcmVzcyBvbGRPd25lciA9IG9waW5pb25JbmRleFRvT3duZXJbX3Rva2VuSWRdOwoKICAgIC8vIFNhZmV0eSBjaGVjayB0byBwcmV2ZW50IGFnYWluc3QgYW4gdW5leHBlY3RlZCAweDAgZGVmYXVsdC4KICAgIHJlcXVpcmUoX2FkZHJlc3NOb3ROdWxsKG5ld093bmVyKSk7CgogICAgLy8gTWFraW5nIHN1cmUgdHJhbnNmZXIgaXMgYXBwcm92ZWQKICAgIHJlcXVpcmUoX2FwcHJvdmVkKG5ld093bmVyLCBfdG9rZW5JZCkpOwoKICAgIF90cmFuc2ZlcihvbGRPd25lciwgbmV3T3duZXIsIF90b2tlbklkKTsKICB9CgogIC8vLyBAcGFyYW0gX293bmVyIFRoZSBvd25lciB3aG9zZSBjZWxlYnJpdHkgdG9rZW5zIHdlIGFyZSBpbnRlcmVzdGVkIGluLgogIC8vLyBAZGV2IFRoaXMgbWV0aG9kIE1VU1QgTkVWRVIgYmUgY2FsbGVkIGJ5IHNtYXJ0IGNvbnRyYWN0IGNvZGUuIEZpcnN0LCBpdCdzIGZhaXJseQogIC8vLyAgZXhwZW5zaXZlIChpdCB3YWxrcyB0aGUgZW50aXJlIG9waW5pb25zIGFycmF5IGxvb2tpbmcgZm9yIG9waW5pb25zIGJlbG9uZ2luZyB0byBvd25lciksCiAgLy8vICBidXQgaXQgYWxzbyByZXR1cm5zIGEgZHluYW1pYyBhcnJheSwgd2hpY2ggaXMgb25seSBzdXBwb3J0ZWQgZm9yIHdlYjMgY2FsbHMsIGFuZAogIC8vLyAgbm90IGNvbnRyYWN0LXRvLWNvbnRyYWN0IGNhbGxzLgogIGZ1bmN0aW9uIHRva2Vuc09mT3duZXIoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnModWludDI1NltdIG93bmVyVG9rZW5zKSB7CiAgICB1aW50MjU2IHRva2VuQ291bnQgPSBiYWxhbmNlT2YoX293bmVyKTsKICAgIGlmICh0b2tlbkNvdW50ID09IDApIHsKICAgICAgICAvLyBSZXR1cm4gYW4gZW1wdHkgYXJyYXkKICAgICAgcmV0dXJuIG5ldyB1aW50MjU2W10oMCk7CiAgICB9IGVsc2UgewogICAgICB1aW50MjU2W10gbWVtb3J5IHJlc3VsdCA9IG5ldyB1aW50MjU2W10odG9rZW5Db3VudCk7CiAgICAgIHVpbnQyNTYgdG90YWxPcGluaW9ucyA9IHRvdGFsU3VwcGx5KCk7CiAgICAgIHVpbnQyNTYgcmVzdWx0SW5kZXggPSAwOwoKICAgICAgdWludDI1NiBvcGluaW9uSWQ7CiAgICAgIGZvciAob3BpbmlvbklkID0gMDsgb3BpbmlvbklkIDw9IHRvdGFsT3BpbmlvbnM7IG9waW5pb25JZCsrKSB7CiAgICAgICAgaWYgKG9waW5pb25JbmRleFRvT3duZXJbb3BpbmlvbklkXSA9PSBfb3duZXIpIHsKICAgICAgICAgIHJlc3VsdFtyZXN1bHRJbmRleF0gPSBvcGluaW9uSWQ7CiAgICAgICAgICByZXN1bHRJbmRleCsrOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH0KCiAgLy8vIEZvciBxdWVyeWluZyB0b3RhbFN1cHBseSBvZiB0b2tlbgogIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHRvdGFsKSB7CiAgICByZXR1cm4gb3BpbmlvbnMubGVuZ3RoOwogIH0KCiAgLy8vIE93bmVyIGluaXRhdGVzIHRoZSB0cmFuc2ZlciBvZiB0aGUgdG9rZW4gdG8gYW5vdGhlciBhY2NvdW50CiAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgZm9yIHRoZSB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZCB0by4KICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSBJRCBvZiB0aGUgVG9rZW4gdGhhdCBjYW4gYmUgdHJhbnNmZXJyZWQgaWYgdGhpcyBjYWxsIHN1Y2NlZWRzLgogIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgZnVuY3Rpb24gdHJhbnNmZXIoCiAgICBhZGRyZXNzIF90bywKICAgIHVpbnQyNTYgX3Rva2VuSWQKICApIHB1YmxpYyB7CiAgICByZXF1aXJlKF9vd25zKG1zZy5zZW5kZXIsIF90b2tlbklkKSk7CiAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChfdG8pKTsKCiAgICBfdHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdG9rZW5JZCk7CiAgfQoKICAvLy8gVGhpcmQtcGFydHkgaW5pdGlhdGVzIHRyYW5zZmVyIG9mIHRva2VuIGZyb20gYWRkcmVzcyBfZnJvbSB0byBhZGRyZXNzIF90bwogIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3MgZm9yIHRoZSB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZCBmcm9tLgogIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIGZvciB0aGUgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQgdG8uCiAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgSUQgb2YgdGhlIFRva2VuIHRoYXQgY2FuIGJlIHRyYW5zZmVycmVkIGlmIHRoaXMgY2FsbCBzdWNjZWVkcy4KICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbSgKICAgIGFkZHJlc3MgX2Zyb20sCiAgICBhZGRyZXNzIF90bywKICAgIHVpbnQyNTYgX3Rva2VuSWQKICApIHB1YmxpYyB7CiAgICByZXF1aXJlKF9vd25zKF9mcm9tLCBfdG9rZW5JZCkpOwogICAgcmVxdWlyZShfYXBwcm92ZWQoX3RvLCBfdG9rZW5JZCkpOwogICAgcmVxdWlyZShfYWRkcmVzc05vdE51bGwoX3RvKSk7CgogICAgX3RyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICB9CiAgCi8vQWxsb3dzIHB1cmNoYXNlIG9mIHRoZSBlbnRpcmUgY29udHJhY3QuIEFsbCByZXZlbnVlIHByb3Zpc2lvbmVkIHRvIGNlb0FkZHJlc3Mgd2lsbCBnbyB0byB0aGUgbmV3IGFkZHJlc3Mgc3BlY2lmaWVkLgovL0lmIHlvdSBjb250YWN0IHVzIGZvbGxvd2luZyBwdXJjaGFzZSB3ZSB3aWxsIHRyYW5zZmVyIGRvbWFpbiwgd2Vic2l0ZSBzb3VyY2UgY29kZSBldGMuIHRvIHlvdSBmcmVlIG9mIGNoYXJnZSwgb3RoZXJ3aXNlIHdlIHdpbGwgY29udGludWUgdG8gbWFpbnRhaW4gdGhlIGZyb250ZW5kIHNpdGUgZm9yIDEgeWVhci4KdWludDI1NiBjb250cmFjdFByaWNlPTMwMCBldGhlcjsKZnVuY3Rpb24gYnV5Q3J5cHRvcGluaW9ucyhhZGRyZXNzIF9uZXdDRU8pIHBheWFibGUgcHVibGljewogICAgcmVxdWlyZShtc2cudmFsdWUgPj0gY29udHJhY3RQcmljZSk7CiAgICBjZW9BZGRyZXNzLnRyYW5zZmVyKG1zZy52YWx1ZSk7CiAgICBfc2V0Q0VPKF9uZXdDRU8pOwogICAgX3NldFByaWNlKDk5OTk5OTkgZXRoZXIpOwp9CmZ1bmN0aW9uIHNldFByaWNlKHVpbnQyNTYgbmV3cHJpY2UpIHB1YmxpYyBvbmx5Q0VPewogICAgX3NldFByaWNlKG5ld3ByaWNlKTsKfQpmdW5jdGlvbiBfc2V0UHJpY2UodWludDI1NiBuZXdwcmljZSkgcHJpdmF0ZXsKICAgIGNvbnRyYWN0UHJpY2U9bmV3cHJpY2U7Cn0KCiAgLyoqKiBQUklWQVRFIEZVTkNUSU9OUyAqKiovCiAgLy8vIFNhZmV0eSBjaGVjayBvbiBfdG8gYWRkcmVzcyB0byBwcmV2ZW50IGFnYWluc3QgYW4gdW5leHBlY3RlZCAweDAgZGVmYXVsdC4KICBmdW5jdGlvbiBfYWRkcmVzc05vdE51bGwoYWRkcmVzcyBfdG8pIHByaXZhdGUgcHVyZSByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gX3RvICE9IGFkZHJlc3MoMCk7CiAgfQoKICAvLy8gRm9yIGNoZWNraW5nIGFwcHJvdmFsIG9mIHRyYW5zZmVyIGZvciBhZGRyZXNzIF90bwogIGZ1bmN0aW9uIF9hcHByb3ZlZChhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBvcGluaW9uSW5kZXhUb0FwcHJvdmVkW190b2tlbklkXSA9PSBfdG87CiAgfQogIAogIGZ1bmN0aW9uIF9jcmVhdGVPcGluaW9uU2V0KCkgcHJpdmF0ZSB7CiAgICAgIGZvcih1aW50IGkgPSAwOyBpPG51bUlzc3VlZDsgaSsrKXsKICAgICAgICBfY3JlYXRlT3BpbmlvbihERUZBVUxUX1RFWFQsY2VvQWRkcmVzcyxzdGFydGluZ1ByaWNlKTsKICAgICAgfQogICAgICAvL3N0YXJ0aW5nUHJpY2UgPSBTYWZlTWF0aC5tdWwoc3RhcnRpbmdQcmljZSxzdGVwTXVsdGlwbGllcik7IC8vaW5jcmVhc2UgdGhlIHByaWNlIGZvciB0aGUgbmV4dCBzZXQgb2YgdG9rZW5zCiAgICAgIC8vY3VycmVudElzc3VlUmVtYWluaW5nPW51bUlzc3VlZDsKICAgICAgCiAgfQogIAogIC8vZm9yIHJlZ2lzdGVyaW5nIGFuIE9waW5pb24KICBmdW5jdGlvbiBfaW5pdE9waW5pb24odWludDI1NiBfdG9rZW5JZCxzdHJpbmcgX25ld09waW5pb24pIHByaXZhdGUgewogICAgICBPcGluaW9uIHN0b3JhZ2Ugb3BpbmlvbiA9IG9waW5pb25zW190b2tlbklkXTsKICAgICAgb3Bpbmlvbi50aW1lc3RhbXA9bm93OwogICAgICBvcGluaW9uLnRleHQ9X25ld09waW5pb247CiAgICAgIG9waW5pb24uY29tbWVudD0xOwogICAgICByZXF1aXJlKCFvcGluaW9uLmNsYWltZWQpOwogICAgICAgIHVpbnQyNTYgbmV3cHJpY2U9U2FmZU1hdGgubXVsKHN0ZXBNdWx0aXBsaWVyLG9waW5pb25JbmRleFRvUHJpY2VbX3Rva2VuSWRdKTsKICAgICAgICAvL21heCBwcmljZSAxIGV0aAogICAgICAgIGlmKG5ld3ByaWNlID4gMC4xIGV0aGVyKXsgLy9tYXggcHJpY2UgZm9yIGEgbmV3IG9waW5pb24sIDEgZXRoZXIKICAgICAgICAgICAgbmV3cHJpY2U9MC4xIGV0aGVyOwogICAgICAgIH0KICAgICAgICBfY3JlYXRlT3BpbmlvbigiIixjZW9BZGRyZXNzLG5ld3ByaWNlKTsgLy9tYWtlIGEgbmV3IG9waW5pb24gZm9yIHNvbWVvbmUgZWxzZSB0byBidXkKICAgICAgICBvcGluaW9uLmNsYWltZWQ9dHJ1ZTsKICAgICAgCiAgICAgICAgICAvL2N1cnJlbnRJc3N1ZVJlbWFpbmluZz1TYWZlTWF0aC5zdWIoY3VycmVudElzc3VlUmVtYWluaW5nLDEpOwogICAgICAgICAgLy9pZiB0aGlzIGlzIHRoZSBsYXN0IHJlbWFpbmluZyB0b2tlbiBmb3Igc2FsZSwgaXNzdWUgbW9yZQogICAgICAgICAgLy9pZihjdXJyZW50SXNzdWVSZW1haW5pbmcgPT0gMCl7CiAgICAgICAgICAvLyAgICBfY3JlYXRlT3BpbmlvblNldCgpOwogICAgICAgICAgLy99CiAgICAgIAogICAgICAKICB9CiAgCiAgLy8vIEZvciBjcmVhdGluZyBPcGluaW9uCiAgZnVuY3Rpb24gX2NyZWF0ZU9waW5pb24oc3RyaW5nIF9uYW1lLCBhZGRyZXNzIF9vd25lciwgdWludDI1NiBfcHJpY2UpIHByaXZhdGUgewogICAgT3BpbmlvbiBtZW1vcnkgX29waW5pb24gPSBPcGluaW9uKHsKICAgICAgdGV4dDogX25hbWUsCiAgICAgIGNsYWltZWQ6IGZhbHNlLAogICAgICBkZWxldGVkOiBmYWxzZSwKICAgICAgY29tbWVudDogMCwKICAgICAgc3BvbnNvcjogX293bmVyLAogICAgICBhbnRpc3BvbnNvcjogY2VvQWRkcmVzcywKICAgICAgdG90YWxzcG9uc29yZWQ6MCwKICAgICAgdG90YWxhbnRpc3BvbnNvcmVkOjAsCiAgICAgIHRpbWVzdGFtcDpub3cKICAgIH0pOwogICAgdWludDI1NiBuZXdPcGluaW9uSWQgPSBvcGluaW9ucy5wdXNoKF9vcGluaW9uKSAtIDE7CgogICAgLy8gSXQncyBwcm9iYWJseSBuZXZlciBnb2luZyB0byBoYXBwZW4sIDQgYmlsbGlvbiB0b2tlbnMgYXJlIEEgTE9ULCBidXQKICAgIC8vIGxldCdzIGp1c3QgYmUgMTAwJSBzdXJlIHdlIG5ldmVyIGxldCB0aGlzIGhhcHBlbi4KICAgIHJlcXVpcmUobmV3T3BpbmlvbklkID09IHVpbnQyNTYodWludDMyKG5ld09waW5pb25JZCkpKTsKCiAgICBCaXJ0aChuZXdPcGluaW9uSWQsIF9uYW1lLCBfb3duZXIpOwoKICAgIG9waW5pb25JbmRleFRvUHJpY2VbbmV3T3BpbmlvbklkXSA9IF9wcmljZTsKCiAgICAvLyBUaGlzIHdpbGwgYXNzaWduIG93bmVyc2hpcCwgYW5kIGFsc28gZW1pdCB0aGUgVHJhbnNmZXIgZXZlbnQgYXMKICAgIC8vIHBlciBFUkM3MjEgZHJhZnQKICAgIF90cmFuc2ZlcihhZGRyZXNzKDApLCBfb3duZXIsIG5ld09waW5pb25JZCk7CiAgfQoKICAvLy8gQ2hlY2sgZm9yIHRva2VuIG93bmVyc2hpcAogIGZ1bmN0aW9uIF9vd25zKGFkZHJlc3MgY2xhaW1hbnQsIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gY2xhaW1hbnQgPT0gb3BpbmlvbkluZGV4VG9Pd25lcltfdG9rZW5JZF07CiAgfQoKICAvLy8gRm9yIHBheWluZyBvdXQgYmFsYW5jZSBvbiBjb250cmFjdAogIGZ1bmN0aW9uIF9wYXlvdXQoYWRkcmVzcyBfdG8pIHByaXZhdGUgewogICAgaWYgKF90byA9PSBhZGRyZXNzKDApKSB7CiAgICAgIGNlb0FkZHJlc3MudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgIH0gZWxzZSB7CiAgICAgIF90by50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgfQogIH0KCiAgLy8vIEBkZXYgQXNzaWducyBvd25lcnNoaXAgb2YgYSBzcGVjaWZpYyBvcGluaW9uIHRvIGFuIGFkZHJlc3MuCiAgZnVuY3Rpb24gX3RyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHsKICAgIC8vIFNpbmNlIHRoZSBudW1iZXIgb2Ygb3BpbmlvbnMgaXMgY2FwcGVkIHRvIDJeMzIgd2UgY2FuJ3Qgb3ZlcmZsb3cgdGhpcwogICAgb3duZXJzaGlwVG9rZW5Db3VudFtfdG9dKys7CiAgICAvL3RyYW5zZmVyIG93bmVyc2hpcAogICAgb3BpbmlvbkluZGV4VG9Pd25lcltfdG9rZW5JZF0gPSBfdG87CgogICAgLy8gV2hlbiBjcmVhdGluZyBuZXcgb3BpbmlvbnMgX2Zyb20gaXMgMHgwLCBidXQgd2UgY2FuJ3QgYWNjb3VudCB0aGF0IGFkZHJlc3MuCiAgICBpZiAoX2Zyb20gIT0gYWRkcmVzcygwKSkgewogICAgICBvd25lcnNoaXBUb2tlbkNvdW50W19mcm9tXS0tOwogICAgICAvLyBjbGVhciBhbnkgcHJldmlvdXNseSBhcHByb3ZlZCBvd25lcnNoaXAgZXhjaGFuZ2UKICAgICAgZGVsZXRlIG9waW5pb25JbmRleFRvQXBwcm92ZWRbX3Rva2VuSWRdOwogICAgfQoKICAgIC8vIEVtaXQgdGhlIHRyYW5zZmVyIGV2ZW50LgogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogIH0KfQpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQ=='.
	

]
