Class {
	#name : #SRTa26665a15a6bab711ed0aa9667a338a2230c4ad4,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTa26665a15a6bab711ed0aa9667a338a2230c4ad4 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7Cgpjb250cmFjdCBEaWdpeENvbnN0YW50cyB7CiAgLy8vIGdlbmVyYWwgY29uc3RhbnRzCiAgdWludDI1NiBjb25zdGFudCBTRUNPTkRTX0lOX0FfREFZID0gMjQgKiA2MCAqIDYwOwoKICAvLy8gYXNzZXQgZXZlbnRzCiAgdWludDI1NiBjb25zdGFudCBBU1NFVF9FVkVOVF9DUkVBVEVEX1ZFTkRPUl9PUkRFUiA9IDE7CiAgdWludDI1NiBjb25zdGFudCBBU1NFVF9FVkVOVF9DUkVBVEVEX1RSQU5TRkVSX09SREVSID0gMjsKICB1aW50MjU2IGNvbnN0YW50IEFTU0VUX0VWRU5UX0NSRUFURURfUkVQTEFDRU1FTlRfT1JERVIgPSAzOwogIHVpbnQyNTYgY29uc3RhbnQgQVNTRVRfRVZFTlRfRlVMRklMTEVEX1ZFTkRPUl9PUkRFUiA9IDQ7CiAgdWludDI1NiBjb25zdGFudCBBU1NFVF9FVkVOVF9GVUxGSUxMRURfVFJBTlNGRVJfT1JERVIgPSA1OwogIHVpbnQyNTYgY29uc3RhbnQgQVNTRVRfRVZFTlRfRlVMRklMTEVEX1JFUExBQ0VNRU5UX09SREVSID0gNjsKICB1aW50MjU2IGNvbnN0YW50IEFTU0VUX0VWRU5UX01JTlRFRCA9IDc7CiAgdWludDI1NiBjb25zdGFudCBBU1NFVF9FVkVOVF9NSU5URURfUkVQTEFDRU1FTlQgPSA4OwogIHVpbnQyNTYgY29uc3RhbnQgQVNTRVRfRVZFTlRfUkVDQVNURUQgPSA5OwogIHVpbnQyNTYgY29uc3RhbnQgQVNTRVRfRVZFTlRfUkVERUVNRUQgPSAxMDsKICB1aW50MjU2IGNvbnN0YW50IEFTU0VUX0VWRU5UX0ZBSUxFRF9BVURJVCA9IDExOwogIHVpbnQyNTYgY29uc3RhbnQgQVNTRVRfRVZFTlRfQURNSU5fRkFJTEVEID0gMTI7CiAgdWludDI1NiBjb25zdGFudCBBU1NFVF9FVkVOVF9SRU1JTlRFRCA9IDEzOwoKICAvLy8gcm9sZXMKICB1aW50MjU2IGNvbnN0YW50IFJPTEVfWkVST19BTllPTkUgPSAwOwogIHVpbnQyNTYgY29uc3RhbnQgUk9MRV9ST09UID0gMTsKICB1aW50MjU2IGNvbnN0YW50IFJPTEVfVkVORE9SID0gMjsKICB1aW50MjU2IGNvbnN0YW50IFJPTEVfWEZFUkFVVEggPSAzOwogIHVpbnQyNTYgY29uc3RhbnQgUk9MRV9QT1BBRE1JTiA9IDQ7CiAgdWludDI1NiBjb25zdGFudCBST0xFX0NVU1RPRElBTiA9IDU7CiAgdWludDI1NiBjb25zdGFudCBST0xFX0FVRElUT1IgPSA2OwogIHVpbnQyNTYgY29uc3RhbnQgUk9MRV9NQVJLRVRQTEFDRV9BRE1JTiA9IDc7CiAgdWludDI1NiBjb25zdGFudCBST0xFX0tZQ19BRE1JTiA9IDg7CiAgdWludDI1NiBjb25zdGFudCBST0xFX0ZFRVNfQURNSU4gPSA5OwogIHVpbnQyNTYgY29uc3RhbnQgUk9MRV9ET0NTX1VQTE9BREVSID0gMTA7CiAgdWludDI1NiBjb25zdGFudCBST0xFX0tZQ19SRUNBU1RFUiA9IDExOwogIHVpbnQyNTYgY29uc3RhbnQgUk9MRV9GRUVTX0RJU1RSSUJVVElPTl9BRE1JTiA9IDEyOwoKICAvLy8gc3RhdGVzCiAgdWludDI1NiBjb25zdGFudCBTVEFURV9aRVJPX1VOREVGSU5FRCA9IDA7CiAgdWludDI1NiBjb25zdGFudCBTVEFURV9DUkVBVEVEID0gMTsKICB1aW50MjU2IGNvbnN0YW50IFNUQVRFX1ZFTkRPUl9PUkRFUiA9IDI7CiAgdWludDI1NiBjb25zdGFudCBTVEFURV9UUkFOU0ZFUiA9IDM7CiAgdWludDI1NiBjb25zdGFudCBTVEFURV9DVVNUT0RJQU5fREVMSVZFUlkgPSA0OwogIHVpbnQyNTYgY29uc3RhbnQgU1RBVEVfTUlOVEVEID0gNTsKICB1aW50MjU2IGNvbnN0YW50IFNUQVRFX0FVRElUX0ZBSUxVUkUgPSA2OwogIHVpbnQyNTYgY29uc3RhbnQgU1RBVEVfUkVQTEFDRU1FTlRfT1JERVIgPSA3OwogIHVpbnQyNTYgY29uc3RhbnQgU1RBVEVfUkVQTEFDRU1FTlRfREVMSVZFUlkgPSA4OwogIHVpbnQyNTYgY29uc3RhbnQgU1RBVEVfUkVDQVNURUQgPSA5OwogIHVpbnQyNTYgY29uc3RhbnQgU1RBVEVfUkVERUVNRUQgPSAxMDsKICB1aW50MjU2IGNvbnN0YW50IFNUQVRFX0FETUlOX0ZBSUxVUkUgPSAxMTsKCiAgLy8vIGludGVyYWN0aXZlIGNvbnRyYWN0cwogIGJ5dGVzMzIgY29uc3RhbnQgQ09OVFJBQ1RfSU5URVJBQ1RJVkVfQVNTRVRTX0VYUExPUkVSID0gImk6YXNzZXQ6ZXhwbG9yZXIiOwogIGJ5dGVzMzIgY29uc3RhbnQgQ09OVFJBQ1RfSU5URVJBQ1RJVkVfRElHSVhfRElSRUNUT1JZID0gImk6ZGlyZWN0b3J5IjsKICBieXRlczMyIGNvbnN0YW50IENPTlRSQUNUX0lOVEVSQUNUSVZFX01BUktFVFBMQUNFID0gImk6bXAiOwogIGJ5dGVzMzIgY29uc3RhbnQgQ09OVFJBQ1RfSU5URVJBQ1RJVkVfTUFSS0VUUExBQ0VfQURNSU4gPSAiaTptcGFkbWluIjsKICBieXRlczMyIGNvbnN0YW50IENPTlRSQUNUX0lOVEVSQUNUSVZFX1BPUEFETUlOID0gImk6cG9wYWRtaW4iOwogIGJ5dGVzMzIgY29uc3RhbnQgQ09OVFJBQ1RfSU5URVJBQ1RJVkVfUFJPRFVDVFNfTElTVCA9ICJpOnByb2R1Y3RzIjsKICBieXRlczMyIGNvbnN0YW50IENPTlRSQUNUX0lOVEVSQUNUSVZFX1RPS0VOID0gImk6dG9rZW4iOwogIGJ5dGVzMzIgY29uc3RhbnQgQ09OVFJBQ1RfSU5URVJBQ1RJVkVfQlVMS19XUkFQUEVSID0gImk6YnVsay13cmFwcGVyIjsKICBieXRlczMyIGNvbnN0YW50IENPTlRSQUNUX0lOVEVSQUNUSVZFX1RPS0VOX0NPTkZJRyA9ICJpOnRva2VuOmNvbmZpZyI7CiAgYnl0ZXMzMiBjb25zdGFudCBDT05UUkFDVF9JTlRFUkFDVElWRV9UT0tFTl9JTkZPUk1BVElPTiA9ICJpOnRva2VuOmluZm9ybWF0aW9uIjsKICBieXRlczMyIGNvbnN0YW50IENPTlRSQUNUX0lOVEVSQUNUSVZFX01BUktFVFBMQUNFX0lORk9STUFUSU9OID0gImk6bXA6aW5mb3JtYXRpb24iOwogIGJ5dGVzMzIgY29uc3RhbnQgQ09OVFJBQ1RfSU5URVJBQ1RJVkVfSURFTlRJVFkgPSAiaTppZGVudGl0eSI7CgogIC8vLyBjb250cm9sbGVyIGNvbnRyYWN0cwogIGJ5dGVzMzIgY29uc3RhbnQgQ09OVFJBQ1RfQ09OVFJPTExFUl9BU1NFVFMgPSAiYzphc3NldCI7CiAgYnl0ZXMzMiBjb25zdGFudCBDT05UUkFDVF9DT05UUk9MTEVSX0FTU0VUU19SRUNBU1QgPSAiYzphc3NldDpyZWNhc3QiOwogIGJ5dGVzMzIgY29uc3RhbnQgQ09OVFJBQ1RfQ09OVFJPTExFUl9BU1NFVFNfRVhQTE9SRVIgPSAiYzpleHBsb3JlciI7CiAgYnl0ZXMzMiBjb25zdGFudCBDT05UUkFDVF9DT05UUk9MTEVSX0RJR0lYX0RJUkVDVE9SWSA9ICJjOmRpcmVjdG9yeSI7CiAgYnl0ZXMzMiBjb25zdGFudCBDT05UUkFDVF9DT05UUk9MTEVSX01BUktFVFBMQUNFID0gImM6bXAiOwogIGJ5dGVzMzIgY29uc3RhbnQgQ09OVFJBQ1RfQ09OVFJPTExFUl9NQVJLRVRQTEFDRV9BRE1JTiA9ICJjOm1wYWRtaW4iOwogIGJ5dGVzMzIgY29uc3RhbnQgQ09OVFJBQ1RfQ09OVFJPTExFUl9QUk9EVUNUU19MSVNUID0gImM6cHJvZHVjdHMiOwoKICBieXRlczMyIGNvbnN0YW50IENPTlRSQUNUX0NPTlRST0xMRVJfVE9LRU5fQVBQUk9WQUwgPSAiYzp0b2tlbjphcHByb3ZhbCI7CiAgYnl0ZXMzMiBjb25zdGFudCBDT05UUkFDVF9DT05UUk9MTEVSX1RPS0VOX0NPTkZJRyA9ICJjOnRva2VuOmNvbmZpZyI7CiAgYnl0ZXMzMiBjb25zdGFudCBDT05UUkFDVF9DT05UUk9MTEVSX1RPS0VOX0lORk8gPSAiYzp0b2tlbjppbmZvIjsKICBieXRlczMyIGNvbnN0YW50IENPTlRSQUNUX0NPTlRST0xMRVJfVE9LRU5fVFJBTlNGRVIgPSAiYzp0b2tlbjp0cmFuc2ZlciI7CgogIGJ5dGVzMzIgY29uc3RhbnQgQ09OVFJBQ1RfQ09OVFJPTExFUl9KT0JfSUQgPSAiYzpqb2JpZCI7CiAgYnl0ZXMzMiBjb25zdGFudCBDT05UUkFDVF9DT05UUk9MTEVSX0lERU5USVRZID0gImM6aWRlbnRpdHkiOwoKICAvLy8gc3RvcmFnZSBjb250cmFjdHMKICBieXRlczMyIGNvbnN0YW50IENPTlRSQUNUX1NUT1JBR0VfQVNTRVRTID0gInM6YXNzZXQiOwogIGJ5dGVzMzIgY29uc3RhbnQgQ09OVFJBQ1RfU1RPUkFHRV9BU1NFVF9FVkVOVFMgPSAiczphc3NldDpldmVudHMiOwogIGJ5dGVzMzIgY29uc3RhbnQgQ09OVFJBQ1RfU1RPUkFHRV9ESUdJWF9ESVJFQ1RPUlkgPSAiczpkaXJlY3RvcnkiOwogIGJ5dGVzMzIgY29uc3RhbnQgQ09OVFJBQ1RfU1RPUkFHRV9NQVJLRVRQTEFDRSA9ICJzOm1wIjsKICBieXRlczMyIGNvbnN0YW50IENPTlRSQUNUX1NUT1JBR0VfUFJPRFVDVFNfTElTVCA9ICJzOnByb2R1Y3RzIjsKICBieXRlczMyIGNvbnN0YW50IENPTlRSQUNUX1NUT1JBR0VfR09MRF9UT0tFTiA9ICJzOmdvbGR0b2tlbiI7CiAgYnl0ZXMzMiBjb25zdGFudCBDT05UUkFDVF9TVE9SQUdFX0pPQl9JRCA9ICJzOmpvYmlkIjsKICBieXRlczMyIGNvbnN0YW50IENPTlRSQUNUX1NUT1JBR0VfSURFTlRJVFkgPSAiczppZGVudGl0eSI7CgogIC8vLyBzZXJ2aWNlIGNvbnRyYWN0cwogIGJ5dGVzMzIgY29uc3RhbnQgQ09OVFJBQ1RfU0VSVklDRV9UT0tFTl9ERU1VUlJBR0UgPSAic3Y6dGRlbXVycmFnZSI7CiAgYnl0ZXMzMiBjb25zdGFudCBDT05UUkFDVF9TRVJWSUNFX01BUktFVFBMQUNFID0gInN2Om1wIjsKICBieXRlczMyIGNvbnN0YW50IENPTlRSQUNUX1NFUlZJQ0VfRElSRUNUT1JZID0gInN2OmRpcmVjdG9yeSI7CgogIC8vLyBmZWVzIGRpc3RyaWJ1dG9ycwogIGJ5dGVzMzIgY29uc3RhbnQgQ09OVFJBQ1RfREVNVVJSQUdFX0ZFRVNfRElTVFJJQlVUT1IgPSAiZmVlczpkaXN0cmlidXRvcjpkZW11cnJhZ2UiOwogIGJ5dGVzMzIgY29uc3RhbnQgQ09OVFJBQ1RfUkVDQVNUX0ZFRVNfRElTVFJJQlVUT1IgPSAiZmVlczpkaXN0cmlidXRvcjpyZWNhc3QiOwogIGJ5dGVzMzIgY29uc3RhbnQgQ09OVFJBQ1RfVFJBTlNGRVJfRkVFU19ESVNUUklCVVRPUiA9ICJmZWVzOmRpc3RyaWJ1dG9yOnRyYW5zZmVyIjsKfQoKY29udHJhY3QgQ29udHJhY3RSZXNvbHZlciB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgYm9vbCBwdWJsaWMgbG9ja2VkOwogIGZ1bmN0aW9uIGluaXRfcmVnaXN0ZXJfY29udHJhY3QoYnl0ZXMzMiBfa2V5LCBhZGRyZXNzIF9jb250cmFjdF9hZGRyZXNzKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBfc3VjY2Vzcyk7CiAgZnVuY3Rpb24gdW5yZWdpc3Rlcl9jb250cmFjdChieXRlczMyIF9rZXkpIHB1YmxpYyByZXR1cm5zIChib29sIF9zdWNjZXNzKTsKICBmdW5jdGlvbiBnZXRfY29udHJhY3QoYnl0ZXMzMiBfa2V5KSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcyBfY29udHJhY3QpOwp9Cgpjb250cmFjdCBSZXNvbHZlckNsaWVudCB7CgogIC8vLyBUaGUgYWRkcmVzcyBvZiB0aGUgcmVzb2x2ZXIgY29udHJhY3QgZm9yIHRoaXMgcHJvamVjdAogIGFkZHJlc3MgcHVibGljIHJlc29sdmVyOwogIC8vLyBUaGUga2V5IHRvIGlkZW50aWZ5IHRoaXMgY29udHJhY3QKICBieXRlczMyIHB1YmxpYyBrZXk7CgogIC8vLyBNYWtlIG91ciBvd24gYWRkcmVzcyBhdmFpbGFibGUgdG8gdXMgYXMgYSBjb25zdGFudAogIGFkZHJlc3MgcHVibGljIENPTlRSQUNUX0FERFJFU1M7CgogIC8vLyBGdW5jdGlvbiBtb2RpZmllciB0byBjaGVjayBpZiBtc2cuc2VuZGVyIGNvcnJlc3BvbmRzIHRvIHRoZSByZXNvbHZlZCBhZGRyZXNzIG9mIGEgZ2l2ZW4ga2V5CiAgLy8vIEBwYXJhbSBfY29udHJhY3QgVGhlIHJlc29sdmVyIGtleQogIG1vZGlmaWVyIGlmX3NlbmRlcl9pcyhieXRlczMyIF9jb250cmFjdCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IENvbnRyYWN0UmVzb2x2ZXIocmVzb2x2ZXIpLmdldF9jb250cmFjdChfY29udHJhY3QpKTsKICAgIF87CiAgfQoKICAvLy8gRnVuY3Rpb24gbW9kaWZpZXIgdG8gY2hlY2sgcmVzb2x2ZXIncyBsb2NraW5nIHN0YXR1cy4KICBtb2RpZmllciB1bmxlc3NfcmVzb2x2ZXJfaXNfbG9ja2VkKCkgewogICAgcmVxdWlyZShpc19sb2NrZWQoKSA9PSBmYWxzZSk7CiAgICBfOwogIH0KCiAgLy8vIEBkZXYgSW5pdGlhbGl6ZSBuZXcgY29udHJhY3QKICAvLy8gQHBhcmFtIF9rZXkgdGhlIHJlc29sdmVyIGtleSBmb3IgdGhpcyBjb250cmFjdAogIC8vLyBAcmV0dXJuIF9zdWNjZXNzIGlmIHRoZSBpbml0aWFsaXphdGlvbiBpcyBzdWNjZXNzZnVsCiAgZnVuY3Rpb24gaW5pdChieXRlczMyIF9rZXksIGFkZHJlc3MgX3Jlc29sdmVyKQogICAgICAgICAgIGludGVybmFsCiAgICAgICAgICAgcmV0dXJucyAoYm9vbCBfc3VjY2VzcykKICB7CiAgICBib29sIF9pc19sb2NrZWQgPSBDb250cmFjdFJlc29sdmVyKF9yZXNvbHZlcikubG9ja2VkKCk7CiAgICBpZiAoX2lzX2xvY2tlZCA9PSBmYWxzZSkgewogICAgICBDT05UUkFDVF9BRERSRVNTID0gYWRkcmVzcyh0aGlzKTsKICAgICAgcmVzb2x2ZXIgPSBfcmVzb2x2ZXI7CiAgICAgIGtleSA9IF9rZXk7CiAgICAgIHJlcXVpcmUoQ29udHJhY3RSZXNvbHZlcihyZXNvbHZlcikuaW5pdF9yZWdpc3Rlcl9jb250cmFjdChrZXksIENPTlRSQUNUX0FERFJFU1MpKTsKICAgICAgX3N1Y2Nlc3MgPSB0cnVlOwogICAgfSAgZWxzZSB7CiAgICAgIF9zdWNjZXNzID0gZmFsc2U7CiAgICB9CiAgfQoKICAvLy8gQGRldiBEZXN0cm95IHRoZSBjb250cmFjdCBhbmQgdW5yZWdpc3RlciBzZWxmIGZyb20gdGhlIENvbnRyYWN0UmVzb2x2ZXIKICAvLy8gQGRldiBDYW4gb25seSBiZSBjYWxsZWQgYnkgdGhlIG93bmVyIG9mIENvbnRyYWN0UmVzb2x2ZXIKICBmdW5jdGlvbiBkZXN0cm95KCkKICAgICAgICAgICBwdWJsaWMKICAgICAgICAgICByZXR1cm5zIChib29sIF9zdWNjZXNzKQogIHsKICAgIGJvb2wgX2lzX2xvY2tlZCA9IENvbnRyYWN0UmVzb2x2ZXIocmVzb2x2ZXIpLmxvY2tlZCgpOwogICAgcmVxdWlyZSghX2lzX2xvY2tlZCk7CgogICAgYWRkcmVzcyBfb3duZXJfb2ZfY29udHJhY3RfcmVzb2x2ZXIgPSBDb250cmFjdFJlc29sdmVyKHJlc29sdmVyKS5vd25lcigpOwogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IF9vd25lcl9vZl9jb250cmFjdF9yZXNvbHZlcik7CgogICAgX3N1Y2Nlc3MgPSBDb250cmFjdFJlc29sdmVyKHJlc29sdmVyKS51bnJlZ2lzdGVyX2NvbnRyYWN0KGtleSk7CiAgICByZXF1aXJlKF9zdWNjZXNzKTsKCiAgICBzZWxmZGVzdHJ1Y3QoX293bmVyX29mX2NvbnRyYWN0X3Jlc29sdmVyKTsKICB9CgogIC8vLyBAZGV2IENoZWNrIGlmIHJlc29sdmVyIGlzIGxvY2tlZAogIC8vLyBAcmV0dXJuIF9sb2NrZWQgaWYgdGhlIHJlc29sdmVyIGlzIGN1cnJlbnRseSBsb2NrZWQKICBmdW5jdGlvbiBpc19sb2NrZWQoKQogICAgICAgICAgIHByaXZhdGUKICAgICAgICAgICBjb25zdGFudAogICAgICAgICAgIHJldHVybnMgKGJvb2wgX2xvY2tlZCkKICB7CiAgICBfbG9ja2VkID0gQ29udHJhY3RSZXNvbHZlcihyZXNvbHZlcikubG9ja2VkKCk7CiAgfQoKICAvLy8gQGRldiBHZXQgdGhlIGFkZHJlc3Mgb2YgYSBjb250cmFjdAogIC8vLyBAcGFyYW0gX2tleSB0aGUgcmVzb2x2ZXIga2V5IHRvIGxvb2sgdXAKICAvLy8gQHJldHVybiBfY29udHJhY3QgdGhlIGFkZHJlc3Mgb2YgdGhlIGNvbnRyYWN0CiAgZnVuY3Rpb24gZ2V0X2NvbnRyYWN0KGJ5dGVzMzIgX2tleSkKICAgICAgICAgICBwdWJsaWMKICAgICAgICAgICBjb25zdGFudAogICAgICAgICAgIHJldHVybnMgKGFkZHJlc3MgX2NvbnRyYWN0KQogIHsKICAgIF9jb250cmFjdCA9IENvbnRyYWN0UmVzb2x2ZXIocmVzb2x2ZXIpLmdldF9jb250cmFjdChfa2V5KTsKICB9Cn0KCi8qKgogIEB0aXRsZSBJbmRleGVkIEJ5dGVzIEl0ZXJhdG9yIEludGVyYWN0aXZlCiAgQGF1dGhvciBEaWdpeCBIb2xkaW5ncyBQdGUgTHRkCiovCmNvbnRyYWN0IEluZGV4ZWRCeXRlc0l0ZXJhdG9ySW50ZXJhY3RpdmUgewoKICAvKioKICAgIEBub3RpY2UgTGlzdHMgYW4gaW5kZXhlZCBCeXRlcyBjb2xsZWN0aW9uIGZyb20gc3RhcnQgb3IgZW5kCiAgICBAcGFyYW0gX2NvbGxlY3Rpb25faW5kZXggSW5kZXggb2YgdGhlIENvbGxlY3Rpb24gdG8gbGlzdAogICAgQHBhcmFtIF9jb3VudCBUb3RhbCBudW1iZXIgb2YgQnl0ZXMgaXRlbXMgdG8gcmV0dXJuCiAgICBAcGFyYW0gX2Z1bmN0aW9uX2ZpcnN0IEZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgRmlyc3QgQnl0ZXMgaXRlbSBpbiB0aGUgbGlzdAogICAgQHBhcmFtIF9mdW5jdGlvbl9sYXN0IEZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgbGFzdCBCeXRlcyBpdGVtIGluIHRoZSBsaXN0CiAgICBAcGFyYW0gX2Z1bmN0aW9uX25leHQgRnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSBOZXh0IEJ5dGVzIGl0ZW0gaW4gdGhlIGxpc3QKICAgIEBwYXJhbSBfZnVuY3Rpb25fcHJldmlvdXMgRnVuY3Rpb24gdGhhdCByZXR1cm5zIHByZXZpb3VzIEJ5dGVzIGl0ZW0gaW4gdGhlIGxpc3QKICAgIEBwYXJhbSBfZnJvbV9zdGFydCB3aGV0aGVyIHRvIHJlYWQgZnJvbSBzdGFydCAob3IgZW5kKSBvZiB0aGUgbGlzdAogICAgQHJldHVybiB7Il9ieXRlc19pdGVtcyIgOiAiQ29sbGVjdGlvbiBvZiByZXZlcnNlZCBCeXRlcyBsaXN0In0KICAqLwogIGZ1bmN0aW9uIGxpc3RfaW5kZXhlZF9ieXRlc2FycmF5KGJ5dGVzMzIgX2NvbGxlY3Rpb25faW5kZXgsIHVpbnQyNTYgX2NvdW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoYnl0ZXMzMikgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYnl0ZXMzMikgX2Z1bmN0aW9uX2ZpcnN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoYnl0ZXMzMikgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYnl0ZXMzMikgX2Z1bmN0aW9uX2xhc3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChieXRlczMyLCBieXRlczMyKSBleHRlcm5hbCBjb25zdGFudCByZXR1cm5zIChieXRlczMyKSBfZnVuY3Rpb25fbmV4dCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGJ5dGVzMzIsIGJ5dGVzMzIpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJ5dGVzMzIpIF9mdW5jdGlvbl9wcmV2aW91cywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBfZnJvbV9zdGFydCkKICAgICAgICAgICBpbnRlcm5hbAogICAgICAgICAgIGNvbnN0YW50CiAgICAgICAgICAgcmV0dXJucyAoYnl0ZXMzMltdIF9pbmRleGVkX2J5dGVzX2l0ZW1zKQogIHsKICAgIGlmIChfZnJvbV9zdGFydCkgewogICAgICBfaW5kZXhlZF9ieXRlc19pdGVtcyA9IHByaXZhdGVfbGlzdF9pbmRleGVkX2J5dGVzX2Zyb21fYnl0ZXMoX2NvbGxlY3Rpb25faW5kZXgsIF9mdW5jdGlvbl9maXJzdChfY29sbGVjdGlvbl9pbmRleCksIF9jb3VudCwgdHJ1ZSwgX2Z1bmN0aW9uX2xhc3QsIF9mdW5jdGlvbl9uZXh0KTsKICAgIH0gZWxzZSB7CiAgICAgIF9pbmRleGVkX2J5dGVzX2l0ZW1zID0gcHJpdmF0ZV9saXN0X2luZGV4ZWRfYnl0ZXNfZnJvbV9ieXRlcyhfY29sbGVjdGlvbl9pbmRleCwgX2Z1bmN0aW9uX2xhc3QoX2NvbGxlY3Rpb25faW5kZXgpLCBfY291bnQsIHRydWUsIF9mdW5jdGlvbl9maXJzdCwgX2Z1bmN0aW9uX3ByZXZpb3VzKTsKICAgIH0KICB9CgogIC8qKgogICAgQG5vdGljZSBMaXN0cyBhbiBpbmRleGVkIEJ5dGVzIGNvbGxlY3Rpb24gZnJvbSBzb21lIGBfY3VycmVudF9pdGVtYCwgZ29pbmcgZm9yd2FyZHMgb3IgYmFja3dhcmRzIGRlcGVuZGluZyBvbiBgX2Zyb21fc3RhcnRgCiAgICBAcGFyYW0gX2NvbGxlY3Rpb25faW5kZXggSW5kZXggb2YgdGhlIENvbGxlY3Rpb24gdG8gbGlzdAogICAgQHBhcmFtIF9jdXJyZW50X2l0ZW0gVGhlIGN1cnJlbnQgSXRlbQogICAgQHBhcmFtIF9jb3VudCBUb3RhbCBudW1iZXIgb2YgQnl0ZXMgaXRlbXMgdG8gcmV0dXJuCiAgICBAcGFyYW0gX2Z1bmN0aW9uX2ZpcnN0IEZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgRmlyc3QgQnl0ZXMgaXRlbSBpbiB0aGUgbGlzdAogICAgQHBhcmFtIF9mdW5jdGlvbl9sYXN0IEZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgbGFzdCBCeXRlcyBpdGVtIGluIHRoZSBsaXN0CiAgICBAcGFyYW0gX2Z1bmN0aW9uX25leHQgRnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSBOZXh0IEJ5dGVzIGl0ZW0gaW4gdGhlIGxpc3QKICAgIEBwYXJhbSBfZnVuY3Rpb25fcHJldmlvdXMgRnVuY3Rpb24gdGhhdCByZXR1cm5zIHByZXZpb3VzIEJ5dGVzIGl0ZW0gaW4gdGhlIGxpc3QKICAgIEBwYXJhbSBfZnJvbV9zdGFydCB3aGV0aGVyIHRvIHJlYWQgaW4gdGhlIGZvcndhcmRzICggb3IgYmFja3dhcmRzKSBkaXJlY3Rpb24KICAgIEByZXR1cm4geyJfYnl0ZXNfaXRlbXMiIDoiQ29sbGVjdGlvbi9saXN0IG9mIEJ5dGVzIn0KICAqLwogIGZ1bmN0aW9uIGxpc3RfaW5kZXhlZF9ieXRlc2FycmF5X2Zyb20oYnl0ZXMzMiBfY29sbGVjdGlvbl9pbmRleCwgYnl0ZXMzMiBfY3VycmVudF9pdGVtLCB1aW50MjU2IF9jb3VudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoYnl0ZXMzMikgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYnl0ZXMzMikgX2Z1bmN0aW9uX2ZpcnN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChieXRlczMyKSBleHRlcm5hbCBjb25zdGFudCByZXR1cm5zIChieXRlczMyKSBfZnVuY3Rpb25fbGFzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoYnl0ZXMzMiwgYnl0ZXMzMikgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYnl0ZXMzMikgX2Z1bmN0aW9uX25leHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGJ5dGVzMzIsIGJ5dGVzMzIpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJ5dGVzMzIpIF9mdW5jdGlvbl9wcmV2aW91cywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIF9mcm9tX3N0YXJ0KQogICAgICAgICAgIGludGVybmFsCiAgICAgICAgICAgY29uc3RhbnQKICAgICAgICAgICByZXR1cm5zIChieXRlczMyW10gX2luZGV4ZWRfYnl0ZXNfaXRlbXMpCiAgewogICAgaWYgKF9mcm9tX3N0YXJ0KSB7CiAgICAgIF9pbmRleGVkX2J5dGVzX2l0ZW1zID0gcHJpdmF0ZV9saXN0X2luZGV4ZWRfYnl0ZXNfZnJvbV9ieXRlcyhfY29sbGVjdGlvbl9pbmRleCwgX2N1cnJlbnRfaXRlbSwgX2NvdW50LCBmYWxzZSwgX2Z1bmN0aW9uX2xhc3QsIF9mdW5jdGlvbl9uZXh0KTsKICAgIH0gZWxzZSB7CiAgICAgIF9pbmRleGVkX2J5dGVzX2l0ZW1zID0gcHJpdmF0ZV9saXN0X2luZGV4ZWRfYnl0ZXNfZnJvbV9ieXRlcyhfY29sbGVjdGlvbl9pbmRleCwgX2N1cnJlbnRfaXRlbSwgX2NvdW50LCBmYWxzZSwgX2Z1bmN0aW9uX2ZpcnN0LCBfZnVuY3Rpb25fcHJldmlvdXMpOwogICAgfQogIH0KCiAgLyoqCiAgICBAbm90aWNlIGEgcHJpdmF0ZSBmdW5jdGlvbiB0byBsaXN0cyBhbiBpbmRleGVkIEJ5dGVzIGNvbGxlY3Rpb24gc3RhcnRpbmcgZnJvbSBzb21lIGBfY3VycmVudF9pdGVtYCAod2hpY2ggY291bGQgYmUgaW5jbHVkZWQgb3IgZXhjbHVkZWQpLCBpbiB0aGUgZm9yd2FyZHMgb3IgYmFja3dhcmRzIGRpcmVjdGlvbgogICAgQHBhcmFtIF9jb2xsZWN0aW9uX2luZGV4IEluZGV4IG9mIHRoZSBDb2xsZWN0aW9uIHRvIGxpc3QKICAgIEBwYXJhbSBfY3VycmVudF9pdGVtIFRoZSBpdGVtIHdoZXJlIHdlIHN0YXJ0IHJlYWRpbmcgZnJvbSB0aGUgbGlzdAogICAgQHBhcmFtIF9jb3VudCBUb3RhbCBudW1iZXIgb2YgQnl0ZXMgaXRlbXMgdG8gcmV0dXJuCiAgICBAcGFyYW0gX2luY2x1ZGluZ19jdXJyZW50IFdoZXRoZXIgdGhlIGBfY3VycmVudF9pdGVtYCBzaG91bGQgYmUgaW5jbHVkZWQgaW4gdGhlIHJlc3VsdAogICAgQHBhcmFtIF9mdW5jdGlvbl9sYXN0IEZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgYnl0ZXMgd2hlcmUgd2Ugc3RvcCByZWFkaW5nIG1vcmUgYnl0ZXMKICAgIEBwYXJhbSBfZnVuY3Rpb25fbmV4dCBGdW5jdGlvbiB0aGF0IHJldHVybnMgdGhlIG5leHQgYnl0ZXMgdG8gcmVhZCBhZnRlciBhbm90aGVyIGJ5dGVzIChjb3VsZCBiZSBiYWNrd2FyZHMgb3IgZm9yd2FyZHMgaW4gdGhlIHBoeXNpY2FsIGNvbGxlY3Rpb24pCiAgICBAcmV0dXJuIHsiX2J5dGVzX2l0ZW1zIiA6IkNvbGxlY3Rpb24vbGlzdCBvZiBCeXRlcyJ9CiAgKi8KICBmdW5jdGlvbiBwcml2YXRlX2xpc3RfaW5kZXhlZF9ieXRlc19mcm9tX2J5dGVzKGJ5dGVzMzIgX2NvbGxlY3Rpb25faW5kZXgsIGJ5dGVzMzIgX2N1cnJlbnRfaXRlbSwgdWludDI1NiBfY291bnQsIGJvb2wgX2luY2x1ZGluZ19jdXJyZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChieXRlczMyKSBleHRlcm5hbCBjb25zdGFudCByZXR1cm5zIChieXRlczMyKSBfZnVuY3Rpb25fbGFzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoYnl0ZXMzMiwgYnl0ZXMzMikgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYnl0ZXMzMikgX2Z1bmN0aW9uX25leHQpCiAgICAgICAgICAgcHJpdmF0ZQogICAgICAgICAgIGNvbnN0YW50CiAgICAgICAgICAgcmV0dXJucyAoYnl0ZXMzMltdIF9pbmRleGVkX2J5dGVzX2l0ZW1zKQogIHsKICAgIHVpbnQyNTYgX2k7CiAgICB1aW50MjU2IF9yZWFsX2NvdW50ID0gMDsKICAgIGJ5dGVzMzIgX2xhc3RfaXRlbTsKCiAgICBfbGFzdF9pdGVtID0gX2Z1bmN0aW9uX2xhc3QoX2NvbGxlY3Rpb25faW5kZXgpOwogICAgaWYgKF9jb3VudCA9PSAwIHx8IF9sYXN0X2l0ZW0gPT0gYnl0ZXMzMigweDApKSB7ICAvLyBpZiBjb3VudCBpcyAwIG9yIHRoZSBjb2xsZWN0aW9uIGlzIGVtcHR5LCByZXR1cm5zIGVtcHR5IGFycmF5CiAgICAgIF9pbmRleGVkX2J5dGVzX2l0ZW1zID0gbmV3IGJ5dGVzMzJbXSgwKTsKICAgIH0gZWxzZSB7CiAgICAgIGJ5dGVzMzJbXSBtZW1vcnkgX2l0ZW1zX3RlbXAgPSBuZXcgYnl0ZXMzMltdKF9jb3VudCk7CiAgICAgIGJ5dGVzMzIgX3RoaXNfaXRlbTsKICAgICAgaWYgKF9pbmNsdWRpbmdfY3VycmVudCkgewogICAgICAgIF9pdGVtc190ZW1wWzBdID0gX2N1cnJlbnRfaXRlbTsKICAgICAgICBfcmVhbF9jb3VudCA9IDE7CiAgICAgIH0KICAgICAgX3RoaXNfaXRlbSA9IF9jdXJyZW50X2l0ZW07CiAgICAgIGZvciAoX2kgPSBfcmVhbF9jb3VudDsgKF9pIDwgX2NvdW50KSAmJiAoX3RoaXNfaXRlbSAhPSBfbGFzdF9pdGVtKTtfaSsrKSB7CiAgICAgICAgX3RoaXNfaXRlbSA9IF9mdW5jdGlvbl9uZXh0KF9jb2xsZWN0aW9uX2luZGV4LCBfdGhpc19pdGVtKTsKICAgICAgICBpZiAoX3RoaXNfaXRlbSAhPSBieXRlczMyKDB4MCkpIHsKICAgICAgICAgIF9yZWFsX2NvdW50Kys7CiAgICAgICAgICBfaXRlbXNfdGVtcFtfaV0gPSBfdGhpc19pdGVtOwogICAgICAgIH0KICAgICAgfQoKICAgICAgX2luZGV4ZWRfYnl0ZXNfaXRlbXMgPSBuZXcgYnl0ZXMzMltdKF9yZWFsX2NvdW50KTsKICAgICAgZm9yKF9pID0gMDtfaSA8IF9yZWFsX2NvdW50O19pKyspIHsKICAgICAgICBfaW5kZXhlZF9ieXRlc19pdGVtc1tfaV0gPSBfaXRlbXNfdGVtcFtfaV07CiAgICAgIH0KICAgIH0KICB9Cn0KCi8qKgogIEB0aXRsZSBCeXRlcyBJdGVyYXRvciBJbnRlcmFjdGl2ZQogIEBhdXRob3IgRGlnaXggSG9sZGluZ3MgUHRlIEx0ZAoqLwpjb250cmFjdCBCeXRlc0l0ZXJhdG9ySW50ZXJhY3RpdmUgewoKICAvKioKICAgIEBub3RpY2UgTGlzdHMgYSBCeXRlcyBjb2xsZWN0aW9uIGZyb20gc3RhcnQgb3IgZW5kCiAgICBAcGFyYW0gX2NvdW50IFRvdGFsIG51bWJlciBvZiBCeXRlcyBpdGVtcyB0byByZXR1cm4KICAgIEBwYXJhbSBfZnVuY3Rpb25fZmlyc3QgRnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSBGaXJzdCBCeXRlcyBpdGVtIGluIHRoZSBsaXN0CiAgICBAcGFyYW0gX2Z1bmN0aW9uX2xhc3QgRnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSBsYXN0IEJ5dGVzIGl0ZW0gaW4gdGhlIGxpc3QKICAgIEBwYXJhbSBfZnVuY3Rpb25fbmV4dCBGdW5jdGlvbiB0aGF0IHJldHVybnMgdGhlIE5leHQgQnl0ZXMgaXRlbSBpbiB0aGUgbGlzdAogICAgQHBhcmFtIF9mdW5jdGlvbl9wcmV2aW91cyBGdW5jdGlvbiB0aGF0IHJldHVybnMgcHJldmlvdXMgQnl0ZXMgaXRlbSBpbiB0aGUgbGlzdAogICAgQHBhcmFtIF9mcm9tX3N0YXJ0IHdoZXRoZXIgdG8gcmVhZCBmcm9tIHN0YXJ0IChvciBlbmQpIG9mIHRoZSBsaXN0CiAgICBAcmV0dXJuIHsiX2J5dGVzX2l0ZW1zIiA6ICJDb2xsZWN0aW9uIG9mIHJldmVyc2VkIEJ5dGVzIGxpc3QifQogICovCiAgZnVuY3Rpb24gbGlzdF9ieXRlc2FycmF5KHVpbnQyNTYgX2NvdW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSBleHRlcm5hbCBjb25zdGFudCByZXR1cm5zIChieXRlczMyKSBfZnVuY3Rpb25fZmlyc3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJ5dGVzMzIpIF9mdW5jdGlvbl9sYXN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoYnl0ZXMzMikgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYnl0ZXMzMikgX2Z1bmN0aW9uX25leHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChieXRlczMyKSBleHRlcm5hbCBjb25zdGFudCByZXR1cm5zIChieXRlczMyKSBfZnVuY3Rpb25fcHJldmlvdXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgX2Zyb21fc3RhcnQpCiAgICAgICAgICAgaW50ZXJuYWwKICAgICAgICAgICBjb25zdGFudAogICAgICAgICAgIHJldHVybnMgKGJ5dGVzMzJbXSBfYnl0ZXNfaXRlbXMpCiAgewogICAgaWYgKF9mcm9tX3N0YXJ0KSB7CiAgICAgIF9ieXRlc19pdGVtcyA9IHByaXZhdGVfbGlzdF9ieXRlc19mcm9tX2J5dGVzKF9mdW5jdGlvbl9maXJzdCgpLCBfY291bnQsIHRydWUsIF9mdW5jdGlvbl9sYXN0LCBfZnVuY3Rpb25fbmV4dCk7CiAgICB9IGVsc2UgewogICAgICBfYnl0ZXNfaXRlbXMgPSBwcml2YXRlX2xpc3RfYnl0ZXNfZnJvbV9ieXRlcyhfZnVuY3Rpb25fbGFzdCgpLCBfY291bnQsIHRydWUsIF9mdW5jdGlvbl9maXJzdCwgX2Z1bmN0aW9uX3ByZXZpb3VzKTsKICAgIH0KICB9CgogIC8qKgogICAgQG5vdGljZSBMaXN0cyBhIEJ5dGVzIGNvbGxlY3Rpb24gZnJvbSBzb21lIGBfY3VycmVudF9pdGVtYCwgZ29pbmcgZm9yd2FyZHMgb3IgYmFja3dhcmRzIGRlcGVuZGluZyBvbiBgX2Zyb21fc3RhcnRgCiAgICBAcGFyYW0gX2N1cnJlbnRfaXRlbSBUaGUgY3VycmVudCBJdGVtCiAgICBAcGFyYW0gX2NvdW50IFRvdGFsIG51bWJlciBvZiBCeXRlcyBpdGVtcyB0byByZXR1cm4KICAgIEBwYXJhbSBfZnVuY3Rpb25fZmlyc3QgRnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSBGaXJzdCBCeXRlcyBpdGVtIGluIHRoZSBsaXN0CiAgICBAcGFyYW0gX2Z1bmN0aW9uX2xhc3QgRnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSBsYXN0IEJ5dGVzIGl0ZW0gaW4gdGhlIGxpc3QKICAgIEBwYXJhbSBfZnVuY3Rpb25fbmV4dCBGdW5jdGlvbiB0aGF0IHJldHVybnMgdGhlIE5leHQgQnl0ZXMgaXRlbSBpbiB0aGUgbGlzdAogICAgQHBhcmFtIF9mdW5jdGlvbl9wcmV2aW91cyBGdW5jdGlvbiB0aGF0IHJldHVybnMgcHJldmlvdXMgQnl0ZXMgaXRlbSBpbiB0aGUgbGlzdAogICAgQHBhcmFtIF9mcm9tX3N0YXJ0IHdoZXRoZXIgdG8gcmVhZCBpbiB0aGUgZm9yd2FyZHMgKCBvciBiYWNrd2FyZHMpIGRpcmVjdGlvbgogICAgQHJldHVybiB7Il9ieXRlc19pdGVtcyIgOiJDb2xsZWN0aW9uL2xpc3Qgb2YgQnl0ZXMifQogICovCiAgZnVuY3Rpb24gbGlzdF9ieXRlc2FycmF5X2Zyb20oYnl0ZXMzMiBfY3VycmVudF9pdGVtLCB1aW50MjU2IF9jb3VudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSBleHRlcm5hbCBjb25zdGFudCByZXR1cm5zIChieXRlczMyKSBfZnVuY3Rpb25fZmlyc3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYnl0ZXMzMikgX2Z1bmN0aW9uX2xhc3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGJ5dGVzMzIpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJ5dGVzMzIpIF9mdW5jdGlvbl9uZXh0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChieXRlczMyKSBleHRlcm5hbCBjb25zdGFudCByZXR1cm5zIChieXRlczMyKSBfZnVuY3Rpb25fcHJldmlvdXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBfZnJvbV9zdGFydCkKICAgICAgICAgICBpbnRlcm5hbAogICAgICAgICAgIGNvbnN0YW50CiAgICAgICAgICAgcmV0dXJucyAoYnl0ZXMzMltdIF9ieXRlc19pdGVtcykKICB7CiAgICBpZiAoX2Zyb21fc3RhcnQpIHsKICAgICAgX2J5dGVzX2l0ZW1zID0gcHJpdmF0ZV9saXN0X2J5dGVzX2Zyb21fYnl0ZXMoX2N1cnJlbnRfaXRlbSwgX2NvdW50LCBmYWxzZSwgX2Z1bmN0aW9uX2xhc3QsIF9mdW5jdGlvbl9uZXh0KTsKICAgIH0gZWxzZSB7CiAgICAgIF9ieXRlc19pdGVtcyA9IHByaXZhdGVfbGlzdF9ieXRlc19mcm9tX2J5dGVzKF9jdXJyZW50X2l0ZW0sIF9jb3VudCwgZmFsc2UsIF9mdW5jdGlvbl9maXJzdCwgX2Z1bmN0aW9uX3ByZXZpb3VzKTsKICAgIH0KICB9CgogIC8qKgogICAgQG5vdGljZSBBIHByaXZhdGUgZnVuY3Rpb24gdG8gbGlzdHMgYSBCeXRlcyBjb2xsZWN0aW9uIHN0YXJ0aW5nIGZyb20gc29tZSBgX2N1cnJlbnRfaXRlbWAgKHdoaWNoIGNvdWxkIGJlIGluY2x1ZGVkIG9yIGV4Y2x1ZGVkKSwgaW4gdGhlIGZvcndhcmRzIG9yIGJhY2t3YXJkcyBkaXJlY3Rpb24KICAgIEBwYXJhbSBfY3VycmVudF9pdGVtIFRoZSBjdXJyZW50IEl0ZW0KICAgIEBwYXJhbSBfY291bnQgVG90YWwgbnVtYmVyIG9mIEJ5dGVzIGl0ZW1zIHRvIHJldHVybgogICAgQHBhcmFtIF9pbmNsdWRpbmdfY3VycmVudCBXaGV0aGVyIHRoZSBgX2N1cnJlbnRfaXRlbWAgc2hvdWxkIGJlIGluY2x1ZGVkIGluIHRoZSByZXN1bHQKICAgIEBwYXJhbSBfZnVuY3Rpb25fbGFzdCBGdW5jdGlvbiB0aGF0IHJldHVybnMgdGhlIGJ5dGVzIHdoZXJlIHdlIHN0b3AgcmVhZGluZyBtb3JlIGJ5dGVzCiAgICBAcGFyYW0gX2Z1bmN0aW9uX25leHQgRnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSBuZXh0IGJ5dGVzIHRvIHJlYWQgYWZ0ZXIgc29tZSBieXRlcyAoY291bGQgYmUgYmFja3dhcmRzIG9yIGZvcndhcmRzIGluIHRoZSBwaHlzaWNhbCBjb2xsZWN0aW9uKQogICAgQHJldHVybiB7Il9hZGRyZXNzX2l0ZW1zIiA6IkNvbGxlY3Rpb24vbGlzdCBvZiBCeXRlcyJ9CiAgKi8KICBmdW5jdGlvbiBwcml2YXRlX2xpc3RfYnl0ZXNfZnJvbV9ieXRlcyhieXRlczMyIF9jdXJyZW50X2l0ZW0sIHVpbnQyNTYgX2NvdW50LCBib29sIF9pbmNsdWRpbmdfY3VycmVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYnl0ZXMzMikgX2Z1bmN0aW9uX2xhc3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChieXRlczMyKSBleHRlcm5hbCBjb25zdGFudCByZXR1cm5zIChieXRlczMyKSBfZnVuY3Rpb25fbmV4dCkKICAgICAgICAgICBwcml2YXRlCiAgICAgICAgICAgY29uc3RhbnQKICAgICAgICAgICByZXR1cm5zIChieXRlczMyW10gX2J5dGVzMzJfaXRlbXMpCiAgewogICAgdWludDI1NiBfaTsKICAgIHVpbnQyNTYgX3JlYWxfY291bnQgPSAwOwogICAgYnl0ZXMzMiBfbGFzdF9pdGVtOwoKICAgIF9sYXN0X2l0ZW0gPSBfZnVuY3Rpb25fbGFzdCgpOwogICAgaWYgKF9jb3VudCA9PSAwIHx8IF9sYXN0X2l0ZW0gPT0gYnl0ZXMzMigweDApKSB7CiAgICAgIF9ieXRlczMyX2l0ZW1zID0gbmV3IGJ5dGVzMzJbXSgwKTsKICAgIH0gZWxzZSB7CiAgICAgIGJ5dGVzMzJbXSBtZW1vcnkgX2l0ZW1zX3RlbXAgPSBuZXcgYnl0ZXMzMltdKF9jb3VudCk7CiAgICAgIGJ5dGVzMzIgX3RoaXNfaXRlbTsKICAgICAgaWYgKF9pbmNsdWRpbmdfY3VycmVudCA9PSB0cnVlKSB7CiAgICAgICAgX2l0ZW1zX3RlbXBbMF0gPSBfY3VycmVudF9pdGVtOwogICAgICAgIF9yZWFsX2NvdW50ID0gMTsKICAgICAgfQogICAgICBfdGhpc19pdGVtID0gX2N1cnJlbnRfaXRlbTsKICAgICAgZm9yIChfaSA9IF9yZWFsX2NvdW50OyAoX2kgPCBfY291bnQpICYmIChfdGhpc19pdGVtICE9IF9sYXN0X2l0ZW0pO19pKyspIHsKICAgICAgICBfdGhpc19pdGVtID0gX2Z1bmN0aW9uX25leHQoX3RoaXNfaXRlbSk7CiAgICAgICAgaWYgKF90aGlzX2l0ZW0gIT0gYnl0ZXMzMigweDApKSB7CiAgICAgICAgICBfcmVhbF9jb3VudCsrOwogICAgICAgICAgX2l0ZW1zX3RlbXBbX2ldID0gX3RoaXNfaXRlbTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIF9ieXRlczMyX2l0ZW1zID0gbmV3IGJ5dGVzMzJbXShfcmVhbF9jb3VudCk7CiAgICAgIGZvcihfaSA9IDA7X2kgPCBfcmVhbF9jb3VudDtfaSsrKSB7CiAgICAgICAgX2J5dGVzMzJfaXRlbXNbX2ldID0gX2l0ZW1zX3RlbXBbX2ldOwogICAgICB9CiAgICB9CiAgfQp9Cgpjb250cmFjdCBBc3NldHNTdG9yYWdlIHsKfQoKY29udHJhY3QgR29sZFRva2VuU3RvcmFnZSB7CiAgZnVuY3Rpb24gcmVhZF9zdXBwbHkoKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDI1NiBfdG90YWxfc3VwcGx5LCB1aW50MjU2IF9lZmZlY3RpdmVfdG90YWxfc3VwcGx5KTsKfQoKY29udHJhY3QgTWFya2V0cGxhY2VTdG9yYWdlIHsKfQoKY29udHJhY3QgQXNzZXRzQ29udHJvbGxlciB7Cn0KCmNvbnRyYWN0IEFzc2V0c0V4cGxvcmVyQ29udHJvbGxlciB7CiAgZnVuY3Rpb24gZ2V0X2ZpcnN0X2l0ZW1faW5fc3RhdGUoYnl0ZXMzMiBfc3RhdGVfaWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChieXRlczMyIF9pdGVtKTsKICBmdW5jdGlvbiBnZXRfbGFzdF9pdGVtX2luX3N0YXRlKGJ5dGVzMzIgX3N0YXRlX2lkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYnl0ZXMzMiBfaXRlbSk7CiAgZnVuY3Rpb24gZ2V0X25leHRfaXRlbV9pbl9zdGF0ZV9mcm9tX2l0ZW0oYnl0ZXMzMiBfc3RhdGVfaWQsIGJ5dGVzMzIgX2N1cnJlbnRfaXRlbSkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJ5dGVzMzIgX2l0ZW0pOwogIGZ1bmN0aW9uIGdldF9wcmV2aW91c19pdGVtX2luX3N0YXRlX2Zyb21faXRlbShieXRlczMyIF9zdGF0ZV9pZCwgYnl0ZXMzMiBfY3VycmVudF9pdGVtKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYnl0ZXMzMiBfaXRlbSk7CiAgZnVuY3Rpb24gZ2V0X2ZpcnN0X2dsb2JhbF9hdWRpdF9kb2N1bWVudCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChieXRlczMyIF9kb2N1bWVudCk7CiAgZnVuY3Rpb24gZ2V0X2xhc3RfZ2xvYmFsX2F1ZGl0X2RvY3VtZW50KCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJ5dGVzMzIgX2RvY3VtZW50KTsKICBmdW5jdGlvbiBnZXRfbmV4dF9nbG9iYWxfYXVkaXRfZG9jdW1lbnQoYnl0ZXMzMiBfY3VycmVudF9kb2N1bWVudCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJ5dGVzMzIgX2RvY3VtZW50KTsKICBmdW5jdGlvbiBnZXRfcHJldmlvdXNfZ2xvYmFsX2F1ZGl0X2RvY3VtZW50KGJ5dGVzMzIgX2N1cnJlbnRfZG9jdW1lbnQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChieXRlczMyIF9kb2N1bWVudCk7CiAgZnVuY3Rpb24gZ2V0X2ZpcnN0X2Fzc2V0X2RvY3VtZW50KGJ5dGVzMzIgX2l0ZW0pIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChieXRlczMyIF9kb2N1bWVudCk7CiAgZnVuY3Rpb24gZ2V0X2xhc3RfYXNzZXRfZG9jdW1lbnQoYnl0ZXMzMiBfaXRlbSkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJ5dGVzMzIgX2RvY3VtZW50KTsKICBmdW5jdGlvbiBnZXRfbmV4dF9hc3NldF9kb2N1bWVudF9mcm9tX2RvY3VtZW50KGJ5dGVzMzIgX2l0ZW0sIGJ5dGVzMzIgX2N1cnJlbnRfZG9jdW1lbnQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChieXRlczMyIF9kb2N1bWVudCk7CiAgZnVuY3Rpb24gZ2V0X3ByZXZpb3VzX2Fzc2V0X2RvY3VtZW50X2Zyb21fZG9jdW1lbnQoYnl0ZXMzMiBfaXRlbSwgYnl0ZXMzMiBfY3VycmVudF9kb2N1bWVudCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJ5dGVzMzIgX2RvY3VtZW50KTsKICBmdW5jdGlvbiBnZXRfZmlyc3RfdXNlcl9yZWNhc3QoYnl0ZXMzMiBfdXNlcl9rZXkpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChieXRlczMyIF9pdGVtKTsKICBmdW5jdGlvbiBnZXRfbGFzdF91c2VyX3JlY2FzdChieXRlczMyIF91c2VyX2tleSkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJ5dGVzMzIgX2l0ZW0pOwogIGZ1bmN0aW9uIGdldF9uZXh0X3VzZXJfcmVjYXN0X2Zyb21faXRlbShieXRlczMyIF91c2VyX2tleSwgYnl0ZXMzMiBfY3VycmVudF9pdGVtKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYnl0ZXMzMiBfaXRlbSk7CiAgZnVuY3Rpb24gZ2V0X3ByZXZpb3VzX3VzZXJfcmVjYXN0X2Zyb21faXRlbShieXRlczMyIF91c2VyX2tleSwgYnl0ZXMzMiBfY3VycmVudF9pdGVtKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYnl0ZXMzMiBfaXRlbSk7CiAgZnVuY3Rpb24gZ2V0X2Fzc2V0X2luZm8oYnl0ZXMzMiBfaXRlbSkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgX3Byb2R1Y3RfaWQsIHVpbnQyNTYgX25nX3dlaWdodCwgdWludDI1NiBfZWZmZWN0aXZlX25nX3dlaWdodCwgYnl0ZXMzMiBfc2VyaWFsLCB1aW50MjU2IF9zdGF0ZV9pZCwgdWludDI1NiBfZG9jdW1lbnRzX2NvdW50LCB1aW50MjU2IF90aW1lX21pbnRlZCwgdWludDI1NiBfcmVkZWVtX2RlYWRsaW5lKTsKICBmdW5jdGlvbiBnZXRfYXNzZXRfZGV0YWlscyhieXRlczMyIF9pdGVtKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcyBfbWludF90YXJnZXQsIGFkZHJlc3MgX3JlZGVlbV9mb3IsIGJ5dGVzMzIgX3JlcGxhY2VkX2J5LCBieXRlczMyIF9yZXBsYWNlcyk7CiAgZnVuY3Rpb24gZ2V0X3RvdGFsX2l0ZW1zX2luX3N0YXRlKGJ5dGVzMzIgX3N0YXRlX2lkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBfdG90YWxfaXRlbXMpOwogIGZ1bmN0aW9uIGdldF9hc3NldF9ldmVudHNfY291bnQoYnl0ZXMzMiBfaXRlbSkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgX2NvdW50KTsKICBmdW5jdGlvbiBnZXRfYXNzZXRfZXZlbnRfZGV0YWlscyhieXRlczMyIF9pdGVtLCB1aW50MjU2IF9ldmVudF9pbmRleCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgX2V2ZW50X3R5cGUsIHVpbnQyNTYgX3RpbWVzdGFtcCk7CiAgZnVuY3Rpb24gZ2V0X2xhc3RfZ2xvYmFsX2F1ZGl0X3RpbWUoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBfbGFzdF9nbG9iYWxfYXVkaXRfdGltZSk7Cn0KCi8vLyBAdGl0bGUgQXNzZXRzLVJlbGF0ZWQgSW5mb3JtYXRpb24KLy8vIEBhdXRob3IgRGlnaXggSG9sZGluZ3MgUHRlIEx0ZAovLy8gQG5vdGljZSBUaGlzIGNvbnRyYWN0IGlzIHVzZWQgdG8gcmVhZCBhbGwgaW5mb3JtYXRpb24gcmVsYXRlZCB0byB0aGUgYXNzZXRzIGluIHRoZSBQcm9vZiBvZiBQcm92ZW5hbmNlIHByb3RvY29sCmNvbnRyYWN0IEFzc2V0c0V4cGxvcmVyIGlzIFJlc29sdmVyQ2xpZW50LCBJbmRleGVkQnl0ZXNJdGVyYXRvckludGVyYWN0aXZlLCBCeXRlc0l0ZXJhdG9ySW50ZXJhY3RpdmUsIERpZ2l4Q29uc3RhbnRzIHsKCiAgZnVuY3Rpb24gQXNzZXRzRXhwbG9yZXIoYWRkcmVzcyBfcmVzb2x2ZXIpIHB1YmxpYwogIHsKICAgIHJlcXVpcmUoaW5pdChDT05UUkFDVF9JTlRFUkFDVElWRV9BU1NFVFNfRVhQTE9SRVIsIF9yZXNvbHZlcikpOwogIH0KCiAgZnVuY3Rpb24gYXNzZXRzX2NvbnRyb2xsZXIoKQogICAgICAgICAgIGludGVybmFsCiAgICAgICAgICAgY29uc3RhbnQKICAgICAgICAgICByZXR1cm5zIChBc3NldHNDb250cm9sbGVyIF9jb250cmFjdCkKICB7CiAgICBfY29udHJhY3QgPSBBc3NldHNDb250cm9sbGVyKGdldF9jb250cmFjdChDT05UUkFDVF9DT05UUk9MTEVSX0FTU0VUUykpOwogIH0KCiAgZnVuY3Rpb24gZ29sZF90b2tlbl9zdG9yYWdlKCkKICAgICAgICAgICBpbnRlcm5hbAogICAgICAgICAgIGNvbnN0YW50CiAgICAgICAgICAgcmV0dXJucyAoR29sZFRva2VuU3RvcmFnZSBfY29udHJhY3QpCiAgewogICAgX2NvbnRyYWN0ID0gR29sZFRva2VuU3RvcmFnZShnZXRfY29udHJhY3QoQ09OVFJBQ1RfU1RPUkFHRV9HT0xEX1RPS0VOKSk7CiAgfQoKICBmdW5jdGlvbiBtYXJrZXRwbGFjZV9zdG9yYWdlKCkKICAgICAgICAgICBpbnRlcm5hbAogICAgICAgICAgIGNvbnN0YW50CiAgICAgICAgICAgcmV0dXJucyAoTWFya2V0cGxhY2VTdG9yYWdlIF9jb250cmFjdCkKICB7CiAgICBfY29udHJhY3QgPSBNYXJrZXRwbGFjZVN0b3JhZ2UoZ2V0X2NvbnRyYWN0KENPTlRSQUNUX1NUT1JBR0VfTUFSS0VUUExBQ0UpKTsKICB9CgogIGZ1bmN0aW9uIGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkKICAgICAgICAgICBpbnRlcm5hbAogICAgICAgICAgIGNvbnN0YW50CiAgICAgICAgICAgcmV0dXJucyAoQXNzZXRzRXhwbG9yZXJDb250cm9sbGVyIF9jb250cmFjdCkKICB7CiAgICBfY29udHJhY3QgPSBBc3NldHNFeHBsb3JlckNvbnRyb2xsZXIoZ2V0X2NvbnRyYWN0KENPTlRSQUNUX0NPTlRST0xMRVJfQVNTRVRTX0VYUExPUkVSKSk7CiAgfQoKICAvLy8gQGRldiBMaXN0IEFzc2V0cyBpbiBhIHBhcnRpY3VsYXIgc3RhdGUKICAvLy8gQHBhcmFtICBfc3RhdGVfaWQgVGhlIHN0YXRlIElEIGF0IHdoaWNoIHdlIGZldGNoIGFzc2V0cwogIC8vLyBAcGFyYW0gX2NvdW50IFRoZSBudW1iZXIgb2YgYXNzZXRzIHRvIGJlIGxpc3RlZAogIC8vLyBAcGFyYW0gX2Zyb21fc3RhcnQgTGlzdCBmcm9tIHN0YXJ0IG9yIGVuZAogIC8vLyBAcmV0dXJuIF9hc3NldHMgdGhlIGFzc2V0cyB0byBiZSBsaXN0ZWQKICBmdW5jdGlvbiBsaXN0QXNzZXRzKHVpbnQyNTYgX3N0YXRlX2lkLCB1aW50MjU2IF9jb3VudCwgYm9vbCBfZnJvbV9zdGFydCkKICAgICAgICAgICBwdWJsaWMKICAgICAgICAgICBjb25zdGFudAogICAgICAgICAgIHJldHVybnMgKGJ5dGVzMzJbXSBfYXNzZXRzKQogIHsKICAgIGJ5dGVzMzIgX2NvbGxlY3Rpb24gPSBieXRlczMyKF9zdGF0ZV9pZCk7CiAgICBfYXNzZXRzID0gbGlzdF9pbmRleGVkX2J5dGVzYXJyYXkoX2NvbGxlY3Rpb24sIF9jb3VudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldHNfZXhwbG9yZXJfY29udHJvbGxlcigpLmdldF9maXJzdF9pdGVtX2luX3N0YXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X2xhc3RfaXRlbV9pbl9zdGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldHNfZXhwbG9yZXJfY29udHJvbGxlcigpLmdldF9uZXh0X2l0ZW1faW5fc3RhdGVfZnJvbV9pdGVtLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X3ByZXZpb3VzX2l0ZW1faW5fc3RhdGVfZnJvbV9pdGVtLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9mcm9tX3N0YXJ0KTsKICB9CgogIC8vLyBAZGV2IExpc3QgYXNzZXRzIGluIGEgcGFydGljdWxhciBzdGF0ZSBzdGFydGluZyBmcm9tIGFuIGFzc2V0IGl0ZW0KICAvLy8gQHBhcmFtIF9zdGF0ZV9pZCBzdGF0ZSBpZCBhdCB3aGljaCB3ZSBsaXN0IGFzc2V0cwogIC8vLyBAcGFyYW0gX2N1cnJlbnRfaXRlbSBsaXN0IGFzc2V0cyBmcm9tIHRoaXMgaXRlbQogIC8vLyBAcGFyYW0gX2NvdW50IG51bWJlciBvZiBhc3NldHMgdG8gbGlzdAogIC8vLyBAcGFyYW0gX2Zyb21fc3RhcnQgd2hldGhlciB0byBsaXN0IGluIGZvcndhcmQgb3IgYmFja3dhcmQgZGlyZWN0aW9uCiAgLy8vIEByZXR1cm4gX2Fzc2V0cyB0aGUgYXNzZXRzIHRvIGJlIGxpc3RlZAogIGZ1bmN0aW9uIGxpc3RBc3NldHNGcm9tKHVpbnQyNTYgX3N0YXRlX2lkLCBieXRlczMyIF9jdXJyZW50X2l0ZW0sIHVpbnQyNTYgX2NvdW50LCBib29sIF9mcm9tX3N0YXJ0KQogICAgICAgICAgIHB1YmxpYwogICAgICAgICAgIGNvbnN0YW50CiAgICAgICAgICAgcmV0dXJucyAoYnl0ZXMzMltdIF9hc3NldHMpCiAgewogICAgYnl0ZXMzMiBfY29sbGVjdGlvbiA9IGJ5dGVzMzIoX3N0YXRlX2lkKTsKICAgIF9hc3NldHMgPSBsaXN0X2luZGV4ZWRfYnl0ZXNhcnJheV9mcm9tKF9jb2xsZWN0aW9uLCBfY3VycmVudF9pdGVtLCBfY291bnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X2ZpcnN0X2l0ZW1faW5fc3RhdGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X2xhc3RfaXRlbV9pbl9zdGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRzX2V4cGxvcmVyX2NvbnRyb2xsZXIoKS5nZXRfbmV4dF9pdGVtX2luX3N0YXRlX2Zyb21faXRlbSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRzX2V4cGxvcmVyX2NvbnRyb2xsZXIoKS5nZXRfcHJldmlvdXNfaXRlbV9pbl9zdGF0ZV9mcm9tX2l0ZW0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9mcm9tX3N0YXJ0KTsKICB9CgogIC8vLyBAZGV2IGxpc3QgZ2xvYmFsIGF1ZGl0IGRvY3VtZW50cwogIC8vLyBAcGFyYW0gX2NvdW50IG51bWJlciBvZiBkb2N1bWVudHMgdG8gbGlzdAogIC8vLyBAcGFyYW0gX2Zyb21fc3RhcnQgd2hldGhlciB0byBsaXN0IGZyb20gc3RhcnQgb3IgZW5kCiAgLy8vIEByZXR1cm4gX2RvY3VtZW50cyB0aGUgZG9jdW1lbnRzIHRvIGJlIGxpc3RlZAogIGZ1bmN0aW9uIGxpc3RHbG9iYWxBdWRpdERvY3VtZW50cyh1aW50MjU2IF9jb3VudCwgYm9vbCBfZnJvbV9zdGFydCkKICAgICAgICAgICBwdWJsaWMKICAgICAgICAgICBjb25zdGFudAogICAgICAgICAgIHJldHVybnMgKGJ5dGVzMzJbXSBfZG9jdW1lbnRzKQogIHsKICAgIF9kb2N1bWVudHMgPSAgbGlzdF9ieXRlc2FycmF5KF9jb3VudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X2ZpcnN0X2dsb2JhbF9hdWRpdF9kb2N1bWVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X2xhc3RfZ2xvYmFsX2F1ZGl0X2RvY3VtZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRzX2V4cGxvcmVyX2NvbnRyb2xsZXIoKS5nZXRfbmV4dF9nbG9iYWxfYXVkaXRfZG9jdW1lbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldHNfZXhwbG9yZXJfY29udHJvbGxlcigpLmdldF9wcmV2aW91c19nbG9iYWxfYXVkaXRfZG9jdW1lbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZnJvbV9zdGFydCk7CiAgfQoKICAvLy8gQGRldiBsaXN0IGdsb2JhbCBhdWRpdCBkb2N1bWVudHMgZnJvbSBhIHNwZWNpZmljIGRvY3VtZW50CiAgLy8vIEBwYXJhbSBfY3VycmVudF9kb2N1bWVudCBsaXN0IGRvY3VtZW50cyBmcm9tIHRoaXMgZG9jdW1lbnQKICAvLy8gQHBhcmFtIF9jb3VudCBudW1iZXIgb2YgZG9jdW1lbnRzIHRvIGxpc3QKICAvLy8gQHBhcmFtIF9mcm9tX3N0YXJ0IHdoZXRoZXIgdG8gbGlzdCBmb3J3YXJkIG9yIGJhY2t3YXJkCiAgLy8vIEByZXR1cm4gX2RvY3VtZW50cyB0aGUgbGlzdCBvZiBkb2N1bWVudHMKICBmdW5jdGlvbiBsaXN0R2xvYmFsQXVkaXREb2N1bWVudHNGcm9tKGJ5dGVzMzIgX2N1cnJlbnRfZG9jdW1lbnQsIHVpbnQyNTYgX2NvdW50LCBib29sIF9mcm9tX3N0YXJ0KQogICAgICAgICAgIHB1YmxpYwogICAgICAgICAgIGNvbnN0YW50CiAgICAgICAgICAgcmV0dXJucyAoYnl0ZXMzMltdIF9kb2N1bWVudHMpCiAgewogICAgX2RvY3VtZW50cyA9IGxpc3RfYnl0ZXNhcnJheV9mcm9tKF9jdXJyZW50X2RvY3VtZW50LCBfY291bnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRzX2V4cGxvcmVyX2NvbnRyb2xsZXIoKS5nZXRfZmlyc3RfZ2xvYmFsX2F1ZGl0X2RvY3VtZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X2xhc3RfZ2xvYmFsX2F1ZGl0X2RvY3VtZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X25leHRfZ2xvYmFsX2F1ZGl0X2RvY3VtZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X3ByZXZpb3VzX2dsb2JhbF9hdWRpdF9kb2N1bWVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZnJvbV9zdGFydCk7CiAgfQoKICAvLy8gQGRldiBsaXN0IHN1cHBvcnRpbmcgZG9jdW1lbnRzIG9mIGFuIGFzc2V0CiAgLy8vIEBwYXJhbSBfaXRlbSBhc3NldHMgaXRlbSBmb3Igd2hpY2ggdG8gbGlzdCBkb2N1bWVudHMKICAvLy8gQHBhcmFtIF9jb3VudCBudW1iZXIgb2YgZG9jdW1lbnRzIHRvIGxpc3QKICAvLy8gQHBhcmFtIF9mcm9tX3N0YXJ0IHdoZXRoZXIgdG8gbGlzdCBmcm9tIHN0YXJ0IG9yIGVuZAogIC8vLyBAcmV0dXJuIF9kb2N1bWVudHMgdGhlIGxpc3Qgb2YgZG9jdW1lbnRzIGZvciB0aGUgYXNzZXQKICBmdW5jdGlvbiBsaXN0QXNzZXREb2N1bWVudHMoYnl0ZXMzMiBfaXRlbSwgdWludDI1NiBfY291bnQsIGJvb2wgX2Zyb21fc3RhcnQpCiAgICAgICAgICAgcHVibGljCiAgICAgICAgICAgY29uc3RhbnQKICAgICAgICAgICByZXR1cm5zIChieXRlczMyW10gX2RvY3VtZW50cykKICB7CiAgICBfZG9jdW1lbnRzID0gbGlzdF9pbmRleGVkX2J5dGVzYXJyYXkoX2l0ZW0sIF9jb3VudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldHNfZXhwbG9yZXJfY29udHJvbGxlcigpLmdldF9maXJzdF9hc3NldF9kb2N1bWVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldHNfZXhwbG9yZXJfY29udHJvbGxlcigpLmdldF9sYXN0X2Fzc2V0X2RvY3VtZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X25leHRfYXNzZXRfZG9jdW1lbnRfZnJvbV9kb2N1bWVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldHNfZXhwbG9yZXJfY29udHJvbGxlcigpLmdldF9wcmV2aW91c19hc3NldF9kb2N1bWVudF9mcm9tX2RvY3VtZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9mcm9tX3N0YXJ0KTsKICB9CgogIC8vLyBAZGV2IGxpc3Qgc3VwcG9ydGluZyBkb2N1bWVudHMgb2YgYW4gYXNzZXQsIGZyb20gYSBzcGVjaWZpYyBkb2N1bWVudAogIC8vLyBAcGFyYW0gX2l0ZW0gdGhlIGFzc2V0IGl0ZW0gZm9yIHdoaWNoIHRvIGxpc3QgZG9jdW1lbnRzCiAgLy8vIEBwYXJhbSBfY3VycmVudF9kb2N1bWVudCB0aGUgZG9jdW1lbnQgZnJvbSB3aGljaCB0byBsaXN0IGRvY3VtZW50cwogIC8vLyBAcGFyYW0gX2NvdW50IHRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIHRvIGJlIGxpc3RlZAogIC8vLyBAcGFyYW0gX2Zyb21fc3RhcnQgd2hldGhlciB0byBsaXN0IGZvcndhcmQgb3IgYmFja3dhcmQKICAvLy8gQHJldHVybiBfZG9jdW1lbnRzIHRoZSBsaXN0IG9mIGRvY3VtZW50cwogIGZ1bmN0aW9uIGxpc3RBc3NldERvY3VtZW50c0Zyb20oYnl0ZXMzMiBfaXRlbSwgYnl0ZXMzMiBfY3VycmVudF9kb2N1bWVudCwgdWludDI1NiBfY291bnQsIGJvb2wgX2Zyb21fc3RhcnQpCiAgICAgICAgICAgcHVibGljCiAgICAgICAgICAgY29uc3RhbnQKICAgICAgICAgICByZXR1cm5zIChieXRlczMyW10gX2RvY3VtZW50cykKICB7CiAgICBfZG9jdW1lbnRzID0gbGlzdF9pbmRleGVkX2J5dGVzYXJyYXlfZnJvbShfaXRlbSwgX2N1cnJlbnRfZG9jdW1lbnQsIF9jb3VudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X2ZpcnN0X2Fzc2V0X2RvY3VtZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRzX2V4cGxvcmVyX2NvbnRyb2xsZXIoKS5nZXRfbGFzdF9hc3NldF9kb2N1bWVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X25leHRfYXNzZXRfZG9jdW1lbnRfZnJvbV9kb2N1bWVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X3ByZXZpb3VzX2Fzc2V0X2RvY3VtZW50X2Zyb21fZG9jdW1lbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZnJvbV9zdGFydCk7CiAgfQoKICAvLy8gQGRldiBsaXN0IHJlY2FzdCBpdGVtcyBieSBhIHVzZXIKICAvLy8gQHBhcmFtIF91c2VyIHRoZSB1c2VyIGZvciB3aGljaCB0byBsaXN0IHJlY2FzdHMKICAvLy8gQHBhcmFtIF9jb3VudCB0aGUgbnVtYmVyIG9mIHJlY2FzdHMgdG8gbGlzdAogIC8vLyBAcGFyYW0gX2Zyb21fc3RhcnQgd2hldGhlciB0byBsaXN0IGZyb20gc3RhcnQgb3IgZW5kCiAgLy8vIHJldHVybiBfaXRlbXMgdGhlIGxpc3Qgb2YgdXNlciByZWNhc3RzCiAgZnVuY3Rpb24gbGlzdFVzZXJSZWNhc3RzKGFkZHJlc3MgX3VzZXIsIHVpbnQyNTYgX2NvdW50LCBib29sIF9mcm9tX3N0YXJ0KQogICAgICAgICAgIHB1YmxpYwogICAgICAgICAgIGNvbnN0YW50CiAgICAgICAgICAgcmV0dXJucyAoYnl0ZXMzMltdIF9pdGVtcykKICB7CiAgICBieXRlczMyIF91c2VyX2tleSA9IGJ5dGVzMzIoX3VzZXIpOwogICAgX2l0ZW1zID0gbGlzdF9pbmRleGVkX2J5dGVzYXJyYXkoX3VzZXJfa2V5LCBfY291bnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldHNfZXhwbG9yZXJfY29udHJvbGxlcigpLmdldF9maXJzdF91c2VyX3JlY2FzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X2xhc3RfdXNlcl9yZWNhc3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldHNfZXhwbG9yZXJfY29udHJvbGxlcigpLmdldF9uZXh0X3VzZXJfcmVjYXN0X2Zyb21faXRlbSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X3ByZXZpb3VzX3VzZXJfcmVjYXN0X2Zyb21faXRlbSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9mcm9tX3N0YXJ0KTsKICB9CgogIC8vLyBAZGV2IGxpc3QgcmVjYXN0IGl0ZW1zIGJ5IGEgdXNlciBmcm9tIGEgc3BlY2lmaWMgaXRlbQogIC8vLyBAcGFyYW0gX3VzZXIgdGhlIHVzZXIgZm9yIHdoaWNoIHRvIGxpc3QgcmVjYXN0IGl0ZW1zCiAgLy8vIEBwYXJhbSBfY3VycmVudF9pdGVtIHRoZSBpdGVtIGZyb20gd2hpY2ggdG8gbGlzdCB0aGUgcmVjYXN0IGl0ZW1zCiAgLy8vIEBwYXJhbSBfY291bnQgdGhlIG51bWJlciBvZiBpdGVtcyB0byBiZSBsaXN0ZWQKICAvLy8gQHBhcmFtIF9mcm9tX3N0YXJ0IHdoZXRoZXIgdG8gbGlzdCBmb3J3YXJkIG9yIGJhY2t3YXJkCiAgLy8vIEByZXR1cm4gX2l0ZW1zIHRoZSBsaXN0IG9mIHJlY2FzdCBpdGVtcyBmb3IgdGhlIHVzZXIKICBmdW5jdGlvbiBsaXN0VXNlclJlY2FzdHNGcm9tKGFkZHJlc3MgX3VzZXIsIGJ5dGVzMzIgX2N1cnJlbnRfaXRlbSwgdWludDI1NiBfY291bnQsIGJvb2wgX2Zyb21fc3RhcnQpCiAgICAgICAgICAgcHVibGljCiAgICAgICAgICAgY29uc3RhbnQKICAgICAgICAgICByZXR1cm5zIChieXRlczMyW10gX2l0ZW1zKQogIHsKICAgIGJ5dGVzMzIgX3VzZXJfa2V5ID0gYnl0ZXMzMihfdXNlcik7CiAgICBfaXRlbXMgPSBsaXN0X2luZGV4ZWRfYnl0ZXNhcnJheV9mcm9tKF91c2VyX2tleSwgX2N1cnJlbnRfaXRlbSwgX2NvdW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldHNfZXhwbG9yZXJfY29udHJvbGxlcigpLmdldF9maXJzdF91c2VyX3JlY2FzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRzX2V4cGxvcmVyX2NvbnRyb2xsZXIoKS5nZXRfbGFzdF91c2VyX3JlY2FzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRzX2V4cGxvcmVyX2NvbnRyb2xsZXIoKS5nZXRfbmV4dF91c2VyX3JlY2FzdF9mcm9tX2l0ZW0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X3ByZXZpb3VzX3VzZXJfcmVjYXN0X2Zyb21faXRlbSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Zyb21fc3RhcnQpOwogIH0KCiAgLy8vIEBkZXYgc2hvdyBhc3NldCBpbmZvcm1hdGlvbgogIC8vLyBAcGFyYW0gX2l0ZW0gYXNzZXQgaXRlbQogIC8vLyBAcmV0dXJuIHsKICAvLy8gICAiX3Byb2R1Y3RfaWQiOiAicHJvZHVjdCBJRCBvZiB0aGUgYXNzZXQiLAogIC8vLyAgICJfbmdfd2VpZ2h0IjogIndlaWdodCBvZiBhc3NldCwgaW4gbmFub2dyYW1zIiwKICAvLy8gICAiX2VmZmVjdGl2ZV9uZ193ZWlnaHQiOiAiZXF1aXZhbGVudCB3ZWlnaHQgaW4gbmFub2dyYW1zIG9mIC45OTk5IGdvbGQgKHdoaWNoIGlzIGFsc28gdGhlIG51bWJlciBvZiBER1ggbWludGVkIGZvciB0aGlzIGFzc2V0KSIsCiAgLy8vICAgIl9zZXJpYWwiOiAic2VyaWFsIElEIG9mIHRoZSBhc3NldCIsCiAgLy8vICAgIl9zdGF0ZV9pZCI6ICJ0aGUgY3VycmVudCBzdGF0ZSBpZCBvZiB0aGUgYXNzZXQiLAogIC8vLyAgICJfZG9jdW1lbnRzX2NvdW50IjogInRoZSBudW1iZXIgb2Ygc3VwcG9ydGluZyBkb2N1bWVudHMgZm9yIHRoaXMgYXNzZXQiLAogIC8vLyAgICJfdGltZV9taW50ZWQiOiAidGltZSBhdCB3aGljaCB0aGUgREdYIHRva2VucyB3ZXJlIG1pbnRlZCBmb3IgdGhpcyBhc3NldCIsCiAgLy8vICAgIl9yZXBsYWNlZF9ieSI6ICJpZiBhdWRpdCBmYWlsdXJlIGhhcHBlbmVkLCB0aGlzIG9yaWdpbmFsIGFzc2V0IHdhcyByZXBsYWNlZCBieSB0aGlzIGl0ZW0iCiAgLy8vIH0KICBmdW5jdGlvbiBzaG93QXNzZXRJbmZvKGJ5dGVzMzIgX2l0ZW0pCiAgICAgICAgICAgcHVibGljCiAgICAgICAgICAgY29uc3RhbnQKICAgICAgICAgICByZXR1cm5zICh1aW50MjU2IF9wcm9kdWN0X2lkLCB1aW50MjU2IF9uZ193ZWlnaHQsIHVpbnQyNTYgX2VmZmVjdGl2ZV9uZ193ZWlnaHQsCiAgICAgICAgICAgICAgICAgICAgYnl0ZXMzMiBfc2VyaWFsLCB1aW50MjU2IF9zdGF0ZV9pZCwgdWludDI1NiBfZG9jdW1lbnRzX2NvdW50LCB1aW50MjU2IF90aW1lX21pbnRlZCwgYnl0ZXMzMiBfcmVwbGFjZWRfYnkpCiAgewogICAgKF9wcm9kdWN0X2lkLCBfbmdfd2VpZ2h0LCBfZWZmZWN0aXZlX25nX3dlaWdodCwKICAgICBfc2VyaWFsLCBfc3RhdGVfaWQsIF9kb2N1bWVudHNfY291bnQsIF90aW1lX21pbnRlZCwpID0gYXNzZXRzX2V4cGxvcmVyX2NvbnRyb2xsZXIoKS5nZXRfYXNzZXRfaW5mbyhfaXRlbSk7CiAgICAoLCxfcmVwbGFjZWRfYnksKSA9IGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X2Fzc2V0X2RldGFpbHMoX2l0ZW0pOwogIH0KCiAgLy8vIEBkZXYgc2hvdyBhc3NldCBkZXRhaWxzCiAgLy8vIEBwYXJhbSBfaXRlbSBhc3NldCBpdGVtCiAgLy8vIEByZXR1cm4gewogIC8vLyAgICJfbWludF90YXJnZXQiOiAiYXNzZXQgd2FzIG1pbnRlZCB0byB0aGlzIGFkZHJlc3MiLAogIC8vLyAgICJfcmVkZWVtX2ZvciI6ICJhc3NldCBjYW4gYmUgcmVkZWVtZWQgYnkgdGhpcyBhZGRyZXNzIiwKICAvLy8gICAiX3JlcGxhY2VkX2J5IjogImlmIGF1ZGl0IGZhaWx1cmUgaGFwcGVuZWQsIHRoaXMgb3JpZ2luYWwgYXNzZXQgd2FzIHJlcGxhY2VkIGJ5IHRoaXMgaXRlbSIsCiAgLy8vICAgIl9yZXBsYWNlcyI6ICJ0aGUgZmFpbGVkIGl0ZW0gd2hpY2ggdGhpcyBpdGVtIHJlcGxhY2VzIiwKICAvLy8gICAiX3JlZGVlbV9kZWFkbGluZSI6ICJhc3NldCBjYW4gYmUgcmVkZWVtZWQgYmVmb3JlIHRoaXMgZGVhZGxpbmUiCiAgLy8vIH0KICBmdW5jdGlvbiBzaG93QXNzZXREZXRhaWxzKGJ5dGVzMzIgX2l0ZW0pCiAgICAgICAgICAgcHVibGljCiAgICAgICAgICAgY29uc3RhbnQKICAgICAgICAgICByZXR1cm5zIChhZGRyZXNzIF9taW50X3RhcmdldCwgYWRkcmVzcyBfcmVkZWVtX2ZvciwgYnl0ZXMzMiBfcmVwbGFjZWRfYnksIGJ5dGVzMzIgX3JlcGxhY2VzLCB1aW50MjU2IF9yZWRlZW1fZGVhZGxpbmUpCiAgewogICAgKF9taW50X3RhcmdldCwgX3JlZGVlbV9mb3IsIF9yZXBsYWNlZF9ieSwgX3JlcGxhY2VzKSA9IGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X2Fzc2V0X2RldGFpbHMoX2l0ZW0pOwogICAgKCwsLCwsLCxfcmVkZWVtX2RlYWRsaW5lKSA9IGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X2Fzc2V0X2luZm8oX2l0ZW0pOwogIH0KCiAgLy8vIEBkZXYgcmV0dXJucyB0aGUgbnVtYmVyIG9mIGFzc2V0cyBpbiBhIHN0YXRlCiAgLy8vIEBwYXJhbSBfc3RhdGVfaWQgdGhlIHN0YXRlIElECiAgLy8vIEByZXR1cm4gX2NvdW50IHRoZSBudW1iZXIgb2YgYXNzZXRzIGluIF9zdGF0ZV9pZAogIGZ1bmN0aW9uIGNvdW50QXNzZXRzKHVpbnQyNTYgX3N0YXRlX2lkKQogICAgICAgICAgIHB1YmxpYwogICAgICAgICAgIGNvbnN0YW50CiAgICAgICAgICAgcmV0dXJucyAodWludDI1NiBfY291bnQpCiAgewogICAgX2NvdW50ID0gYXNzZXRzX2V4cGxvcmVyX2NvbnRyb2xsZXIoKS5nZXRfdG90YWxfaXRlbXNfaW5fc3RhdGUoYnl0ZXMzMihfc3RhdGVfaWQpKTsKICB9CgogIC8vLyBAZGV2IHRoZSB0b3RhbCBzdXBwbHkgb2YgREdYIHRva2VucyBhbmQgLjk5OTkgZ29sZCBpbiB0aGUgdmF1bHRzCiAgLy8vIEByZXR1cm4gewogIC8vLyAgICJfdG90YWxfc3VwcGx5IjogInRvdGFsIHN1cHBseSBvZiBER1ggdG9rZW5zIiwKICAvLy8gICAiX2VmZmVjdGl2ZV90b3RhbF9zdXBwbHkiOiAidG90YWwgYW1vdW50IG9mIC45OTk5IGdvbGQgaW4gdGhlIHZhdWx0cy4gVGhpcyB3aWxsIG9ubHkgYmUgdGVtcG9yYXJpbHkgc21hbGxlciB0aGFuIF90b3RhbF9zdXBwbHkgd2hlbiBhbiBhdWRpdCBmYWlsdXJlIGhhcHBlbnMiCiAgLy8vIH0KICBmdW5jdGlvbiBzaG93U3VwcGx5KCkKICAgICAgICAgICBwdWJsaWMKICAgICAgICAgICBjb25zdGFudAogICAgICAgICAgIHJldHVybnMgKHVpbnQyNTYgX3RvdGFsX3N1cHBseSwgdWludDI1NiBfZWZmZWN0aXZlX3RvdGFsX3N1cHBseSkKICB7CiAgICAoX3RvdGFsX3N1cHBseSwgX2VmZmVjdGl2ZV90b3RhbF9zdXBwbHkpID0gZ29sZF90b2tlbl9zdG9yYWdlKCkucmVhZF9zdXBwbHkoKTsKICB9CgogIC8vLyBAZGV2IHJldHVybnMgdGhlIG51bWJlciBvZiBhc3NldCBldmVudHMgdGhhdCBoYXMgaGFwcGVuZWQgdG8gYW4gYXNzZXQgaXRlbQogIC8vLyBAcGFyYW0gX2l0ZW0gdGhlIGFzc2V0IGl0ZW0KICAvLy8gcmV0dXJuIF9jb3VudCB0aGUgbnVtYmVyIG9mIGV2ZW50cwogIGZ1bmN0aW9uIGNvdW50QXNzZXRFdmVudHMoYnl0ZXMzMiBfaXRlbSkKICAgICAgICAgICBwdWJsaWMKICAgICAgICAgICBjb25zdGFudAogICAgICAgICAgIHJldHVybnMgKHVpbnQyNTYgX2NvdW50KQogIHsKICAgIF9jb3VudCA9IGFzc2V0c19leHBsb3Jlcl9jb250cm9sbGVyKCkuZ2V0X2Fzc2V0X2V2ZW50c19jb3VudChfaXRlbSk7CiAgfQoKICAvLy8gQGRldiByZXR1cm5zIHRoZSBpbmZvcm1hdGlvbiBvZiBhIHBhcnRpY3VsYXIgYXNzZXQgZXZlbnQgb2YgYW4gYXNzZXQgaXRlbQogIC8vLyBAcGFyYW0gX2l0ZW0gdGhlIGFzc2V0IGl0ZW0KICAvLy8gQHBhcmFtIF9ldmVudF9pbmRleCB0aGUgaW5kZXggb2YgdGhlIGFzc2V0IGV2ZW50IChpbmRleCBnb2VzIGZyb20gMCkKICAvLy8gQHJldHVybiB7CiAgLy8vICAgIl9ldmVudF90eXBlIjogInRoZSB0eXBlIG9mIGV2ZW50IiwKICAvLy8gICAiX3RpbWVzdGFtcCI6ICJ0aW1lIGF0IHdoaWNoIHRoZSBldmVudCBoYXBwZW5lZCIKICAvLy8gfQogIGZ1bmN0aW9uIHNob3dBc3NldEV2ZW50KGJ5dGVzMzIgX2l0ZW0sIHVpbnQyNTYgX2V2ZW50X2luZGV4KQogICAgICAgICAgIHB1YmxpYwogICAgICAgICAgIGNvbnN0YW50CiAgICAgICAgICAgcmV0dXJucyAodWludDI1NiBfZXZlbnRfdHlwZSwgdWludDI1NiBfdGltZXN0YW1wKQogIHsKICAgIChfZXZlbnRfdHlwZSwgX3RpbWVzdGFtcCkgPSBhc3NldHNfZXhwbG9yZXJfY29udHJvbGxlcigpLmdldF9hc3NldF9ldmVudF9kZXRhaWxzKF9pdGVtLCBfZXZlbnRfaW5kZXgpOwogIH0KCiAgLy8vIEBkZXYgcmV0dXJuIHRoZSB0aW1lIGF0IHdoaWNoIGxhc3QgZ2xvYmFsIGF1ZGl0IHdhcyBkb25lCiAgLy8vIEByZXR1cm4gX2xhc3RfZ2xvYmFsX2F1ZGl0X3RpbWUgVGhlIHRpbWUgb2YgbGFzdCBnbG9iYWwgYXVkaXQKICBmdW5jdGlvbiBzaG93TGFzdEdsb2JhbEF1ZGl0VGltZSgpCiAgICAgICAgICAgcHVibGljCiAgICAgICAgICAgY29uc3RhbnQKICAgICAgICAgICByZXR1cm5zICh1aW50MjU2IF9sYXN0X2dsb2JhbF9hdWRpdF90aW1lKQogIHsKICAgIF9sYXN0X2dsb2JhbF9hdWRpdF90aW1lID0gYXNzZXRzX2V4cGxvcmVyX2NvbnRyb2xsZXIoKS5nZXRfbGFzdF9nbG9iYWxfYXVkaXRfdGltZSgpOwogIH0KCn0='.
	

]
