Class {
	#name : #SRTb5c2ea13d2bf1968a10722dc45900c8da0f78212,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTb5c2ea13d2bf1968a10722dc45900c8da0f78212 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTY7CgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vCi8vIElESCBpbmRhSGFzaCB0b2tlbiBwdWJsaWMgc2FsZSBjb250cmFjdF8KLy8KLy8gRm9yIGRldGFpbHMsIHBsZWFzZSB2aXNpdDogaHR0cHM6Ly9pbmRhaGFzaC5jb20vaWNvCi8vCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vCi8vIFNhZmVNYXRoMwovLwovLyBBZGFwdGVkIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXBwZWxpbi1zb2xpZGl0eS9ibG9iL21hc3Rlci9jb250cmFjdHMvbWF0aC9TYWZlTWF0aC5zb2wKLy8gKG5vIG5lZWQgdG8gaW1wbGVtZW50IGRpdmlzaW9uKQovLwovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpsaWJyYXJ5IFNhZmVNYXRoMyB7CgogIGZ1bmN0aW9uIG11bCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludCBjKSB7CiAgICBjID0gYSAqIGI7CiAgICBhc3NlcnQoIGEgPT0gMCB8fCBjIC8gYSA9PSBiICk7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludCBhLCB1aW50IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgIGFzc2VydCggYiA8PSBhICk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludCBhLCB1aW50IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQgYykgewogICAgYyA9IGEgKyBiOwogICAgYXNzZXJ0KCBjID49IGEgKTsKICB9Cgp9CgoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLwovLyBPd25lZCBjb250cmFjdAovLwovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpjb250cmFjdCBPd25lZCB7CgogIGFkZHJlc3MgcHVibGljIG93bmVyOwogIGFkZHJlc3MgcHVibGljIG5ld093bmVyOwoKICAvLyBFdmVudHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVyUHJvcG9zZWQoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvKTsKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8pOwoKICAvLyBNb2RpZmllciAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogIG1vZGlmaWVyIG9ubHlPd25lciB7CiAgICByZXF1aXJlKCBtc2cuc2VuZGVyID09IG93bmVyICk7CiAgICBfOwogIH0KCiAgLy8gRnVuY3Rpb25zIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICBmdW5jdGlvbiBPd25lZCgpIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgX25ld093bmVyKSBvbmx5T3duZXIgewogICAgcmVxdWlyZSggX25ld093bmVyICE9IG93bmVyICk7CiAgICByZXF1aXJlKCBfbmV3T3duZXIgIT0gYWRkcmVzcygweDApICk7CiAgICBPd25lcnNoaXBUcmFuc2ZlclByb3Bvc2VkKG93bmVyLCBfbmV3T3duZXIpOwogICAgbmV3T3duZXIgPSBfbmV3T3duZXI7CiAgfQoKICBmdW5jdGlvbiBhY2NlcHRPd25lcnNoaXAoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gbmV3T3duZXIpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8KLy8gRVJDIFRva2VuIFN0YW5kYXJkICMyMCBJbnRlcmZhY2UKLy8gaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvYmxvYi9tYXN0ZXIvRUlQUy9laXAtMjAtdG9rZW4tc3RhbmRhcmQubWQKLy8KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKY29udHJhY3QgRVJDMjBJbnRlcmZhY2UgewoKICAvLyBFdmVudHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludCBfdmFsdWUpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludCBfdmFsdWUpOwoKICAvLyBGdW5jdGlvbnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludCk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IGJhbGFuY2UpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlbWFpbmluZyk7Cgp9CgoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLwovLyBFUkMgVG9rZW4gU3RhbmRhcmQgIzIwCi8vCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmNvbnRyYWN0IEVSQzIwVG9rZW4gaXMgRVJDMjBJbnRlcmZhY2UsIE93bmVkIHsKICAKICB1c2luZyBTYWZlTWF0aDMgZm9yIHVpbnQ7CgogIHVpbnQgcHVibGljIHRva2Vuc0lzc3VlZFRvdGFsID0gMDsKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgYmFsYW5jZXM7CiAgbWFwcGluZyhhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkpIGFsbG93ZWQ7CgogIC8vIEZ1bmN0aW9ucyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgLyogVG90YWwgdG9rZW4gc3VwcGx5ICovCgogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgcmV0dXJuIHRva2Vuc0lzc3VlZFRvdGFsOwogIH0KCiAgLyogR2V0IHRoZSBhY2NvdW50IGJhbGFuY2UgZm9yIGFuIGFkZHJlc3MgKi8KCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCiAgLyogVHJhbnNmZXIgdGhlIGJhbGFuY2UgZnJvbSBvd25lcidzIGFjY291bnQgdG8gYW5vdGhlciBhY2NvdW50ICovCgogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF9hbW91bnQpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgLy8gYW1vdW50IHNlbnQgY2Fubm90IGV4Y2VlZCBiYWxhbmNlCiAgICByZXF1aXJlKCBiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfYW1vdW50ICk7CgogICAgLy8gdXBkYXRlIGJhbGFuY2VzCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfYW1vdW50KTsKICAgIGJhbGFuY2VzW190b10gICAgICAgID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CgogICAgLy8gbG9nIGV2ZW50CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF9hbW91bnQpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKiBBbGxvdyBfc3BlbmRlciB0byB3aXRoZHJhdyBmcm9tIHlvdXIgYWNjb3VudCB1cCB0byBfYW1vdW50ICovCgogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYW1vdW50KSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIC8vIGFwcHJvdmFsIGFtb3VudCBjYW5ub3QgZXhjZWVkIHRoZSBiYWxhbmNlCiAgICByZXF1aXJlICggYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX2Ftb3VudCApOwogICAgICAKICAgIC8vIHVwZGF0ZSBhbGxvd2VkIGFtb3VudAogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfYW1vdW50OwogICAgCiAgICAvLyBsb2cgZXZlbnQKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfYW1vdW50KTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyogU3BlbmRlciBvZiB0b2tlbnMgdHJhbnNmZXJzIHRva2VucyBmcm9tIHRoZSBvd25lcidzIGJhbGFuY2UgKi8KICAvKiBNdXN0IGJlIHByZS1hcHByb3ZlZCBieSBvd25lciAqLwoKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX2Ftb3VudCkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAvLyBiYWxhbmNlIGNoZWNrcwogICAgcmVxdWlyZSggYmFsYW5jZXNbX2Zyb21dID49IF9hbW91bnQgKTsKICAgIHJlcXVpcmUoIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF9hbW91bnQgKTsKCiAgICAvLyB1cGRhdGUgYmFsYW5jZXMgYW5kIGFsbG93ZWQgYW1vdW50CiAgICBiYWxhbmNlc1tfZnJvbV0gICAgICAgICAgICA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX2Ftb3VudCk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLnN1YihfYW1vdW50KTsKICAgIGJhbGFuY2VzW190b10gICAgICAgICAgICAgID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CgogICAgLy8gbG9nIGV2ZW50CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfYW1vdW50KTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyogUmV0dXJucyB0aGUgYW1vdW50IG9mIHRva2VucyBhcHByb3ZlZCBieSB0aGUgb3duZXIgKi8KICAvKiB0aGF0IGNhbiBiZSB0cmFuc2ZlcnJlZCBieSBzcGVuZGVyICovCgogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCByZW1haW5pbmcpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KCn0KCgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vCi8vIElESCBwdWJsaWMgdG9rZW4gc2FsZQovLwovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpjb250cmFjdCBJbmRhSGFzaFRva2VuIGlzIEVSQzIwVG9rZW4gewoKICAvKiBVdGlsaXR5IHZhcmlhYmxlICovCiAgCiAgdWludCBjb25zdGFudCBFNiA9IDEwKio2OwogIAogIC8qIEJhc2ljIHRva2VuIGRhdGEgKi8KCiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lICAgICA9ICJpbmRhSGFzaCBDb2luIjsKICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCAgID0gIklESCI7CiAgdWludDggIHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDY7CgogIC8qIFdhbGxldCBhZGRyZXNzZXMgLSBpbml0aWFsbHkgc2V0IHRvIG93bmVyIGF0IGRlcGxveW1lbnQgKi8KICAKICBhZGRyZXNzIHB1YmxpYyB3YWxsZXQ7CiAgYWRkcmVzcyBwdWJsaWMgYWRtaW5XYWxsZXQ7CgogIC8qIElDTyBkYXRlcyAqLwoKICB1aW50IHB1YmxpYyBjb25zdGFudCBEQVRFX1BSRVNBTEVfU1RBUlQgPSAxNTEwMTUzMjAwOyAvLyAwOC1Ob3YtMjAxNyAxNTowMCBVVEMKICB1aW50IHB1YmxpYyBjb25zdGFudCBEQVRFX1BSRVNBTEVfRU5EICAgPSAxNTEwNzU4MDAwOyAvLyAxNS1Ob3YtMjAxNyAxNTowMCBVVEMKCiAgdWludCBwdWJsaWMgY29uc3RhbnQgREFURV9JQ09fU1RBUlQgPSAxNTExOTY3NjAwOyAvLyAyOS1Ob3YtMjAxNyAxNTowMCBVVEMKICB1aW50IHB1YmxpYyBjb25zdGFudCBEQVRFX0lDT19FTkQgICA9IDE1MTM3ODIwMDA7IC8vIDIwLURlYy0yMDE3IDE1OjAwIFVUQwoKICAvKiBJQ08gdG9rZW5zIHBlciBFVEggKi8KICAKICB1aW50IHB1YmxpYyB0b2tlbnNQZXJFdGggPSAzMjAwICogRTY7IC8vIHJhdGUgZHVyaW5nIGxhc3QgSUNPIHdlZWsKCiAgdWludCBwdWJsaWMgY29uc3RhbnQgQk9OVVNfUFJFU0FMRSAgICAgID0gNDA7CiAgdWludCBwdWJsaWMgY29uc3RhbnQgQk9OVVNfSUNPX1dFRUtfT05FID0gMjA7CiAgdWludCBwdWJsaWMgY29uc3RhbnQgQk9OVVNfSUNPX1dFRUtfVFdPID0gMTA7CgogIC8qIE90aGVyIElDTyBwYXJhbWV0ZXJzICovICAKICAKICB1aW50IHB1YmxpYyBjb25zdGFudCBUT0tFTl9TVVBQTFlfVE9UQUwgPSA0MDAgKiBFNiAqIEU2OyAvLyA0MDAgbW0gdG9rZW5zCiAgdWludCBwdWJsaWMgY29uc3RhbnQgVE9LRU5fU1VQUExZX0lDTyAgID0gMzIwICogRTYgKiBFNjsgLy8gMzIwIG1tIHRva2VucwogIHVpbnQgcHVibGljIGNvbnN0YW50IFRPS0VOX1NVUFBMWV9NS1QgICA9ICA4MCAqIEU2ICogRTY7IC8vICA4MCBtbSB0b2tlbnMKCiAgdWludCBwdWJsaWMgY29uc3RhbnQgUFJFU0FMRV9FVEhfQ0FQID0gIDE1MDAwIGV0aGVyOwoKICB1aW50IHB1YmxpYyBjb25zdGFudCBNSU5fRlVORElOR19HT0FMID0gIDQwICogRTYgKiBFNjsgLy8gNDAgbW0gdG9rZW5zCiAgCiAgdWludCBwdWJsaWMgY29uc3RhbnQgTUlOX0NPTlRSSUJVVElPTiA9IDEgZXRoZXIgLyAyOyAvLyAwLjUgRXRoZXIKICB1aW50IHB1YmxpYyBjb25zdGFudCBNQVhfQ09OVFJJQlVUSU9OID0gMzAwIGV0aGVyOwoKICB1aW50IHB1YmxpYyBjb25zdGFudCBDT09MRE9XTl9QRVJJT0QgPSAgMiBkYXlzOwogIHVpbnQgcHVibGljIGNvbnN0YW50IENMQVdCQUNLX1BFUklPRCA9IDkwIGRheXM7CgogIC8qIENyb3dkc2FsZSB2YXJpYWJsZXMgKi8KCiAgdWludCBwdWJsaWMgaWNvRXRoZXJSZWNlaXZlZCA9IDA7IC8vIEV0aGVyIGFjdHVhbGx5IHJlY2VpdmVkIGJ5IHRoZSBjb250cmFjdAoKICB1aW50IHB1YmxpYyB0b2tlbnNJc3N1ZWRJY28gICA9IDA7CiAgdWludCBwdWJsaWMgdG9rZW5zSXNzdWVkTWt0ICAgPSAwOwogIAogIHVpbnQgcHVibGljIHRva2Vuc0NsYWltZWRBaXJkcm9wID0gMDsKICAKICAvKiBLZWVwIHRyYWNrIG9mIEV0aGVyIGNvbnRyaWJ1dGVkIGFuZCB0b2tlbnMgcmVjZWl2ZWQgZHVyaW5nIENyb3dkc2FsZSAqLwogIAogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgaWNvRXRoZXJDb250cmlidXRlZDsKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgcHVibGljIGljb1Rva2Vuc1JlY2VpdmVkOwoKICAvKiBLZWVwIHRyYWNrIG9mIHBhcnRpY2lwYW50cyB3aG8gCiAgLyogLSBoYXZlIHJlY2VpdmVkIHRoZWlyIGFpcmRyb3BwZWQgdG9rZW5zIGFmdGVyIGEgc3VjY2Vzc2Z1bCBJQ08gKi8KICAvKiAtIG9yIGhhdmUgcmVjbGFpbWVkIHRoZWlyIGNvbnRyaWJ1dGlvbnMgaW4gY2FzZSBvZiBmYWlsZWQgQ3Jvd2RzYWxlICovCiAgLyogLSBhcmUgbG9ja2VkICovCiAgCiAgbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBhaXJkcm9wQ2xhaW1lZDsKICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIHJlZnVuZENsYWltZWQ7CiAgbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBsb2NrZWQ7CgogIC8vIEV2ZW50cyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAKICBldmVudCBXYWxsZXRVcGRhdGVkKGFkZHJlc3MgX25ld1dhbGxldCk7CiAgZXZlbnQgQWRtaW5XYWxsZXRVcGRhdGVkKGFkZHJlc3MgX25ld0FkbWluV2FsbGV0KTsKICBldmVudCBUb2tlbnNQZXJFdGhVcGRhdGVkKHVpbnQgX3Rva2Vuc1BlckV0aCk7CiAgZXZlbnQgVG9rZW5zTWludGVkKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIHVpbnQgX3Rva2VucywgdWludCBfYmFsYW5jZSk7CiAgZXZlbnQgVG9rZW5zSXNzdWVkKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIHVpbnQgX3Rva2VucywgdWludCBfYmFsYW5jZSwgdWludCBfZXRoZXJDb250cmlidXRlZCk7CiAgZXZlbnQgUmVmdW5kKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIHVpbnQgX2Ftb3VudCwgdWludCBfdG9rZW5zKTsKICBldmVudCBBaXJkcm9wKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIHVpbnQgX2Ftb3VudCwgdWludCBfYmFsYW5jZSk7CiAgZXZlbnQgTG9ja1JlbW92ZWQoYWRkcmVzcyBpbmRleGVkIF9wYXJ0aWNpcGFudCk7CgogIC8vIEJhc2ljIEZ1bmN0aW9ucyAtLS0tLS0tLS0tLS0tLS0tLS0KCiAgLyogSW5pdGlhbGl6ZSAob3duZXIgaXMgc2V0IHRvIG1zZy5zZW5kZXIgYnkgT3duZWQuT3duZWQoKSAqLwoKICBmdW5jdGlvbiBJbmRhSGFzaFRva2VuKCkgewogICAgcmVxdWlyZSggVE9LRU5fU1VQUExZX0lDTyArIFRPS0VOX1NVUFBMWV9NS1QgPT0gVE9LRU5fU1VQUExZX1RPVEFMICk7CiAgICB3YWxsZXQgPSBvd25lcjsKICAgIGFkbWluV2FsbGV0ID0gb3duZXI7CiAgfQoKICAvKiBGYWxsYmFjayAqLwogIAogIGZ1bmN0aW9uICgpIHBheWFibGUgewogICAgYnV5VG9rZW5zKCk7CiAgfQogIAogIC8vIEluZm9ybWF0aW9uIGZ1bmN0aW9ucyAtLS0tLS0tLS0tLS0KICAKICAvKiBXaGF0IHRpbWUgaXMgaXQ/ICovCiAgCiAgZnVuY3Rpb24gYXROb3coKSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CiAgICByZXR1cm4gbm93OwogIH0KICAKICAvKiBIYXMgdGhlIG1pbmltdW0gdGhyZXNob2xkIGJlZW4gcmVhY2hlZD8gKi8KICAKICBmdW5jdGlvbiBpY29UaHJlc2hvbGRSZWFjaGVkKCkgY29uc3RhbnQgcmV0dXJucyAoYm9vbCB0aHJlc2hvbGRSZWFjaGVkKSB7CiAgICAgaWYgKHRva2Vuc0lzc3VlZEljbyA8IE1JTl9GVU5ESU5HX0dPQUwpIHJldHVybiBmYWxzZTsKICAgICByZXR1cm4gdHJ1ZTsKICB9ICAKICAKICAvKiBBcmUgdG9rZW5zIHRyYW5zZmVyYWJsZT8gKi8KCiAgZnVuY3Rpb24gaXNUcmFuc2ZlcmFibGUoKSBjb25zdGFudCByZXR1cm5zIChib29sIHRyYW5zZmVyYWJsZSkgewogICAgIGlmICggIWljb1RocmVzaG9sZFJlYWNoZWQoKSApIHJldHVybiBmYWxzZTsKICAgICBpZiAoIGF0Tm93KCkgPCBEQVRFX0lDT19FTkQgKyBDT09MRE9XTl9QRVJJT0QgKSByZXR1cm4gZmFsc2U7CiAgICAgcmV0dXJuIHRydWU7CiAgfQogIAogIC8vIExvY2sgZnVuY3Rpb25zIC0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgLyogTWFuYWdlIGxvY2tlZCAqLwoKICBmdW5jdGlvbiByZW1vdmVMb2NrKGFkZHJlc3MgX3BhcnRpY2lwYW50KSB7CiAgICByZXF1aXJlKCBtc2cuc2VuZGVyID09IGFkbWluV2FsbGV0IHx8IG1zZy5zZW5kZXIgPT0gb3duZXIgKTsKICAgIGxvY2tlZFtfcGFydGljaXBhbnRdID0gZmFsc2U7CiAgICBMb2NrUmVtb3ZlZChfcGFydGljaXBhbnQpOwogIH0KCiAgZnVuY3Rpb24gcmVtb3ZlTG9ja011bHRpcGxlKGFkZHJlc3NbXSBfcGFydGljaXBhbnRzKSB7CiAgICByZXF1aXJlKCBtc2cuc2VuZGVyID09IGFkbWluV2FsbGV0IHx8IG1zZy5zZW5kZXIgPT0gb3duZXIgKTsKICAgIGZvciAodWludCBpID0gMDsgaSA8IF9wYXJ0aWNpcGFudHMubGVuZ3RoOyBpKyspIHsKICAgICAgbG9ja2VkW19wYXJ0aWNpcGFudHNbaV1dID0gZmFsc2U7CiAgICAgIExvY2tSZW1vdmVkKF9wYXJ0aWNpcGFudHNbaV0pOwogICAgfQogIH0KCiAgLy8gT3duZXIgRnVuY3Rpb25zIC0tLS0tLS0tLS0tLS0tLS0tLQogIAogIC8qIENoYW5nZSB0aGUgY3Jvd2RzYWxlIHdhbGxldCBhZGRyZXNzICovCgogIGZ1bmN0aW9uIHNldFdhbGxldChhZGRyZXNzIF93YWxsZXQpIG9ubHlPd25lciB7CiAgICByZXF1aXJlKCBfd2FsbGV0ICE9IGFkZHJlc3MoMHgwKSApOwogICAgd2FsbGV0ID0gX3dhbGxldDsKICAgIFdhbGxldFVwZGF0ZWQod2FsbGV0KTsKICB9CgogIC8qIENoYW5nZSB0aGUgYWRtaW4gd2FsbGV0IGFkZHJlc3MgKi8KCiAgZnVuY3Rpb24gc2V0QWRtaW5XYWxsZXQoYWRkcmVzcyBfd2FsbGV0KSBvbmx5T3duZXIgewogICAgcmVxdWlyZSggX3dhbGxldCAhPSBhZGRyZXNzKDB4MCkgKTsKICAgIGFkbWluV2FsbGV0ID0gX3dhbGxldDsKICAgIEFkbWluV2FsbGV0VXBkYXRlZChhZG1pbldhbGxldCk7CiAgfQoKICAvKiBDaGFuZ2UgdG9rZW5zUGVyRXRoIGJlZm9yZSBJQ08gc3RhcnQgKi8KICAKICBmdW5jdGlvbiB1cGRhdGVUb2tlbnNQZXJFdGgodWludCBfdG9rZW5zUGVyRXRoKSBvbmx5T3duZXIgewogICAgcmVxdWlyZSggYXROb3coKSA8IERBVEVfUFJFU0FMRV9TVEFSVCApOwogICAgdG9rZW5zUGVyRXRoID0gX3Rva2Vuc1BlckV0aDsKICAgIFRva2Vuc1BlckV0aFVwZGF0ZWQoX3Rva2Vuc1BlckV0aCk7CiAgfQoKICAvKiBNaW50aW5nIG9mIG1hcmtldGluZyB0b2tlbnMgYnkgb3duZXIgKi8KCiAgZnVuY3Rpb24gbWludE1hcmtldGluZyhhZGRyZXNzIF9wYXJ0aWNpcGFudCwgdWludCBfdG9rZW5zKSBvbmx5T3duZXIgewogICAgLy8gY2hlY2sgYW1vdW50CiAgICByZXF1aXJlKCBfdG9rZW5zIDw9IFRPS0VOX1NVUFBMWV9NS1Quc3ViKHRva2Vuc0lzc3VlZE1rdCkgKTsKICAgIAogICAgLy8gdXBkYXRlIGJhbGFuY2VzCiAgICBiYWxhbmNlc1tfcGFydGljaXBhbnRdID0gYmFsYW5jZXNbX3BhcnRpY2lwYW50XS5hZGQoX3Rva2Vucyk7CiAgICB0b2tlbnNJc3N1ZWRNa3QgICAgICAgID0gdG9rZW5zSXNzdWVkTWt0LmFkZChfdG9rZW5zKTsKICAgIHRva2Vuc0lzc3VlZFRvdGFsICAgICAgPSB0b2tlbnNJc3N1ZWRUb3RhbC5hZGQoX3Rva2Vucyk7CiAgICAKICAgIC8vIGxvY2tlZAogICAgbG9ja2VkW19wYXJ0aWNpcGFudF0gPSB0cnVlOwogICAgCiAgICAvLyBsb2cgdGhlIG1pbml0aW5nCiAgICBUcmFuc2ZlcigweDAsIF9wYXJ0aWNpcGFudCwgX3Rva2Vucyk7CiAgICBUb2tlbnNNaW50ZWQoX3BhcnRpY2lwYW50LCBfdG9rZW5zLCBiYWxhbmNlc1tfcGFydGljaXBhbnRdKTsKICB9CgogIC8qIE93bmVyIGNsYXdiYWNrIG9mIHJlbWFpbmluZyBmdW5kcyBhZnRlciBjbGF3YmFjayBwZXJpb2QgKi8KICAvKiAoZm9yIHVzZSBpbiBjYXNlIG9mIGEgZmFpbGVkIENyd29kc2FsZSkgKi8KICAKICBmdW5jdGlvbiBvd25lckNsYXdiYWNrKCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIHJlcXVpcmUoIGF0Tm93KCkgPiBEQVRFX0lDT19FTkQgKyBDTEFXQkFDS19QRVJJT0QgKTsKICAgIHdhbGxldC50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogIH0KCiAgLyogVHJhbnNmZXIgb3V0IGFueSBhY2NpZGVudGFsbHkgc2VudCBFUkMyMCB0b2tlbnMgKi8KCiAgZnVuY3Rpb24gdHJhbnNmZXJBbnlFUkMyMFRva2VuKGFkZHJlc3MgdG9rZW5BZGRyZXNzLCB1aW50IGFtb3VudCkgb25seU93bmVyIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICByZXR1cm4gRVJDMjBJbnRlcmZhY2UodG9rZW5BZGRyZXNzKS50cmFuc2Zlcihvd25lciwgYW1vdW50KTsKICB9CgogIC8vIFByaXZhdGUgZnVuY3Rpb25zIC0tLS0tLS0tLS0tLS0tLS0KCiAgLyogQWNjZXB0IEVUSCBkdXJpbmcgY3Jvd2RzYWxlIChjYWxsZWQgYnkgZGVmYXVsdCBmdW5jdGlvbikgKi8KCiAgZnVuY3Rpb24gYnV5VG9rZW5zKCkgcHJpdmF0ZSB7CiAgICB1aW50IHRzID0gYXROb3coKTsKICAgIGJvb2wgaXNQcmVzYWxlID0gZmFsc2U7CiAgICBib29sIGlzSWNvID0gZmFsc2U7CiAgICB1aW50IHRva2VucyA9IDA7CiAgICAKICAgIC8vIG1pbmltdW0gY29udHJpYnV0aW9uCiAgICByZXF1aXJlKCBtc2cudmFsdWUgPj0gTUlOX0NPTlRSSUJVVElPTiApOwogICAgCiAgICAvLyBvbmUgYWRkcmVzcyB0cmFuc2ZlciBoYXJkIGNhcAogICAgcmVxdWlyZSggaWNvRXRoZXJDb250cmlidXRlZFttc2cuc2VuZGVyXS5hZGQobXNnLnZhbHVlKSA8PSBNQVhfQ09OVFJJQlVUSU9OICk7CgogICAgLy8gY2hlY2sgZGF0ZXMgZm9yIHByZXNhbGUgb3IgSUNPCiAgICBpZiAodHMgPiBEQVRFX1BSRVNBTEVfU1RBUlQgJiYgdHMgPCBEQVRFX1BSRVNBTEVfRU5EKSBpc1ByZXNhbGUgPSB0cnVlOyAgCiAgICBpZiAodHMgPiBEQVRFX0lDT19TVEFSVCAmJiB0cyA8IERBVEVfSUNPX0VORCkgaXNJY28gPSB0cnVlOyAgCiAgICByZXF1aXJlKCBpc1ByZXNhbGUgfHwgaXNJY28gKTsKCiAgICAvLyBwcmVzYWxlIGNhcCBpbiBFdGhlcgogICAgaWYgKGlzUHJlc2FsZSkgcmVxdWlyZSggaWNvRXRoZXJSZWNlaXZlZC5hZGQobXNnLnZhbHVlKSA8PSBQUkVTQUxFX0VUSF9DQVAgKTsKICAgIAogICAgLy8gZ2V0IGJhc2VsaW5lIG51bWJlciBvZiB0b2tlbnMKICAgIHRva2VucyA9IHRva2Vuc1BlckV0aC5tdWwobXNnLnZhbHVlKSAvIDEgZXRoZXI7CiAgICAKICAgIC8vIGFwcGx5IGJvbnVzZXMgKG5vbmUgZm9yIGxhc3Qgd2VlaykKICAgIGlmIChpc1ByZXNhbGUpIHsKICAgICAgdG9rZW5zID0gdG9rZW5zLm11bCgxMDAgKyBCT05VU19QUkVTQUxFKSAvIDEwMDsKICAgIH0gZWxzZSBpZiAodHMgPCBEQVRFX0lDT19TVEFSVCArIDcgZGF5cykgewogICAgICAvLyBmaXJzdCB3ZWVrIGljbyBib251cwogICAgICB0b2tlbnMgPSB0b2tlbnMubXVsKDEwMCArIEJPTlVTX0lDT19XRUVLX09ORSkgLyAxMDA7CiAgICB9IGVsc2UgaWYgKHRzIDwgREFURV9JQ09fU1RBUlQgKyAxNCBkYXlzKSB7CiAgICAgIC8vIHNlY29uZCB3ZWVrIGljbyBib251cwogICAgICB0b2tlbnMgPSB0b2tlbnMubXVsKDEwMCArIEJPTlVTX0lDT19XRUVLX1RXTykgLyAxMDA7CiAgICB9CiAgICAKICAgIC8vIElDTyB0b2tlbiB2b2x1bWUgY2FwCiAgICByZXF1aXJlKCB0b2tlbnNJc3N1ZWRJY28uYWRkKHRva2VucykgPD0gVE9LRU5fU1VQUExZX0lDTyApOwoKICAgIC8vIHJlZ2lzdGVyIHRva2VucwogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gICAgICAgICAgPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5hZGQodG9rZW5zKTsKICAgIGljb1Rva2Vuc1JlY2VpdmVkW21zZy5zZW5kZXJdID0gaWNvVG9rZW5zUmVjZWl2ZWRbbXNnLnNlbmRlcl0uYWRkKHRva2Vucyk7CiAgICB0b2tlbnNJc3N1ZWRJY28gICAgICAgICAgICAgICA9IHRva2Vuc0lzc3VlZEljby5hZGQodG9rZW5zKTsKICAgIHRva2Vuc0lzc3VlZFRvdGFsICAgICAgICAgICAgID0gdG9rZW5zSXNzdWVkVG90YWwuYWRkKHRva2Vucyk7CiAgICAKICAgIC8vIHJlZ2lzdGVyIEV0aGVyCiAgICBpY29FdGhlclJlY2VpdmVkICAgICAgICAgICAgICAgID0gaWNvRXRoZXJSZWNlaXZlZC5hZGQobXNnLnZhbHVlKTsKICAgIGljb0V0aGVyQ29udHJpYnV0ZWRbbXNnLnNlbmRlcl0gPSBpY29FdGhlckNvbnRyaWJ1dGVkW21zZy5zZW5kZXJdLmFkZChtc2cudmFsdWUpOwogICAgCiAgICAvLyBsb2NrZWQKICAgIGxvY2tlZFttc2cuc2VuZGVyXSA9IHRydWU7CiAgICAKICAgIC8vIGxvZyB0b2tlbiBpc3N1YW5jZQogICAgVHJhbnNmZXIoMHgwLCBtc2cuc2VuZGVyLCB0b2tlbnMpOwogICAgVG9rZW5zSXNzdWVkKG1zZy5zZW5kZXIsIHRva2VucywgYmFsYW5jZXNbbXNnLnNlbmRlcl0sIG1zZy52YWx1ZSk7CgogICAgLy8gdHJhbnNmZXIgRXRoZXIgaWYgd2UncmUgb3ZlciB0aGUgdGhyZXNob2xkCiAgICBpZiAoIGljb1RocmVzaG9sZFJlYWNoZWQoKSApIHdhbGxldC50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogIH0KICAKICAvLyBFUkMyMCBmdW5jdGlvbnMgLS0tLS0tLS0tLS0tLS0tLS0tCgogIC8qIE92ZXJyaWRlICJ0cmFuc2ZlciIgKEVSQzIwKSAqLwoKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfYW1vdW50KSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJlcXVpcmUoIGlzVHJhbnNmZXJhYmxlKCkgKTsKICAgIHJlcXVpcmUoIGxvY2tlZFttc2cuc2VuZGVyXSA9PSBmYWxzZSApOwogICAgcmVxdWlyZSggbG9ja2VkW190b10gPT0gZmFsc2UgKTsKICAgIHJldHVybiBzdXBlci50cmFuc2ZlcihfdG8sIF9hbW91bnQpOwogIH0KICAKICAvKiBPdmVycmlkZSAidHJhbnNmZXJGcm9tIiAoRVJDMjApICovCgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfYW1vdW50KSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJlcXVpcmUoIGlzVHJhbnNmZXJhYmxlKCkgKTsKICAgIHJlcXVpcmUoIGxvY2tlZFtfZnJvbV0gPT0gZmFsc2UgKTsKICAgIHJlcXVpcmUoIGxvY2tlZFtfdG9dID09IGZhbHNlICk7CiAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF9hbW91bnQpOwogIH0KCiAgLy8gRXh0ZXJuYWwgZnVuY3Rpb25zIC0tLS0tLS0tLS0tLS0tLQoKICAvKiBSZWNsYWltaW5nIG9mIGZ1bmRzIGJ5IGNvbnRyaWJ1dG9ycyBpbiBjYXNlIG9mIGEgZmFpbGVkIGNyb3dkc2FsZSAqLwogIC8qIChpdCB3aWxsIGZhaWwgaWYgYWNjb3VudCBpcyBlbXB0eSBhZnRlciBvd25lckNsYXdiYWNrKSAqLwoKICAvKiBXaGlsZSB0aGVyZSBjb3VsZCBub3QgaGF2ZSBiZWVuIGFueSB0b2tlbiB0cmFuc2ZlcnMgeWV0LCBhIGNvbnRyaWJ1dG9yICovCiAgLyogbWF5IGhhdmUgcmVjZWl2ZWQgbWludGVkIHRva2Vucywgc28gdGhlIHRva2VuIGJhbGFuY2UgYWZ0ZXIgYSByZWZ1bmQgKi8gCiAgLyogbWF5IHN0aWxsIGJlIHBvc2l0aXZlICovCiAgCiAgZnVuY3Rpb24gcmVjbGFpbUZ1bmRzKCkgZXh0ZXJuYWwgewogICAgdWludCB0b2tlbnM7IC8vIHRva2VucyB0byBkZXN0cm95CiAgICB1aW50IGFtb3VudDsgLy8gcmVmdW5kIGFtb3VudAogICAgCiAgICAvLyBpY28gaXMgZmluaXNoZWQgYW5kIHdhcyBub3Qgc3VjY2Vzc2Z1bAogICAgcmVxdWlyZSggYXROb3coKSA+IERBVEVfSUNPX0VORCAmJiAhaWNvVGhyZXNob2xkUmVhY2hlZCgpICk7CiAgICAKICAgIC8vIGNoZWNrIGlmIHJlZnVuZCBoYXMgYWxyZWFkeSBiZWVuIGNsYWltZWQKICAgIHJlcXVpcmUoICFyZWZ1bmRDbGFpbWVkW21zZy5zZW5kZXJdICk7CiAgICAKICAgIC8vIGNoZWNrIGlmIHRoZXJlIGlzIGFueXRoaW5nIHRvIHJlZnVuZAogICAgcmVxdWlyZSggaWNvRXRoZXJDb250cmlidXRlZFttc2cuc2VuZGVyXSA+IDAgKTsKICAgIAogICAgLy8gdXBkYXRlIHZhcmlhYmxlcyBhZmZlY3RlZCBieSByZWZ1bmQKICAgIHRva2VucyA9IGljb1Rva2Vuc1JlY2VpdmVkW21zZy5zZW5kZXJdOwogICAgYW1vdW50ID0gaWNvRXRoZXJDb250cmlidXRlZFttc2cuc2VuZGVyXTsKCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1Yih0b2tlbnMpOwogICAgdG9rZW5zSXNzdWVkVG90YWwgICAgPSB0b2tlbnNJc3N1ZWRUb3RhbC5zdWIodG9rZW5zKTsKICAgIAogICAgcmVmdW5kQ2xhaW1lZFttc2cuc2VuZGVyXSA9IHRydWU7CiAgICAKICAgIC8vIHRyYW5zZmVyIG91dCByZWZ1bmQKICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoYW1vdW50KTsKICAgIAogICAgLy8gbG9nCiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCAweDAsIHRva2Vucyk7CiAgICBSZWZ1bmQobXNnLnNlbmRlciwgYW1vdW50LCB0b2tlbnMpOwogIH0KCiAgLyogQ2xhaW1pbmcgb2YgImFpcmRyb3BwZWQiIHRva2VucyBpbiBjYXNlIG9mIHN1Y2Nlc3NmdWwgY3Jvd2RzYWxlICovCiAgLyogQ2FuIGJlIGRvbmUgYnkgdG9rZW4gaG9sZGVyLCBvciBieSBhZG1pbldhbGxldCAqLyAKCiAgZnVuY3Rpb24gY2xhaW1BaXJkcm9wKCkgZXh0ZXJuYWwgewogICAgZG9BaXJkcm9wKG1zZy5zZW5kZXIpOwogIH0KCiAgZnVuY3Rpb24gYWRtaW5DbGFpbUFpcmRyb3AoYWRkcmVzcyBfcGFydGljaXBhbnQpIGV4dGVybmFsIHsKICAgIHJlcXVpcmUoIG1zZy5zZW5kZXIgPT0gYWRtaW5XYWxsZXQgKTsKICAgIGRvQWlyZHJvcChfcGFydGljaXBhbnQpOwogIH0KCiAgZnVuY3Rpb24gYWRtaW5DbGFpbUFpcmRyb3BNdWx0aXBsZShhZGRyZXNzW10gX2FkZHJlc3NlcykgZXh0ZXJuYWwgewogICAgcmVxdWlyZSggbXNnLnNlbmRlciA9PSBhZG1pbldhbGxldCApOwogICAgZm9yICh1aW50IGkgPSAwOyBpIDwgX2FkZHJlc3Nlcy5sZW5ndGg7IGkrKykgZG9BaXJkcm9wKF9hZGRyZXNzZXNbaV0pOwogIH0gIAogIAogIGZ1bmN0aW9uIGRvQWlyZHJvcChhZGRyZXNzIF9wYXJ0aWNpcGFudCkgaW50ZXJuYWwgewogICAgdWludCBhaXJkcm9wID0gY29tcHV0ZUFpcmRyb3AoX3BhcnRpY2lwYW50KTsKCiAgICByZXF1aXJlKCBhaXJkcm9wID4gMCApOwoKICAgIC8vIHVwZGF0ZSBiYWxhbmNlcyBhbmQgdG9rZW4gaXNzdWUgdm9sdW1lCiAgICBhaXJkcm9wQ2xhaW1lZFtfcGFydGljaXBhbnRdID0gdHJ1ZTsKICAgIGJhbGFuY2VzW19wYXJ0aWNpcGFudF0gPSBiYWxhbmNlc1tfcGFydGljaXBhbnRdLmFkZChhaXJkcm9wKTsKICAgIHRva2Vuc0lzc3VlZFRvdGFsICAgICAgPSB0b2tlbnNJc3N1ZWRUb3RhbC5hZGQoYWlyZHJvcCk7CiAgICB0b2tlbnNDbGFpbWVkQWlyZHJvcCAgID0gdG9rZW5zQ2xhaW1lZEFpcmRyb3AuYWRkKGFpcmRyb3ApOwogICAgCiAgICAvLyBsb2cKICAgIEFpcmRyb3AoX3BhcnRpY2lwYW50LCBhaXJkcm9wLCBiYWxhbmNlc1tfcGFydGljaXBhbnRdKTsKICAgIFRyYW5zZmVyKDB4MCwgX3BhcnRpY2lwYW50LCBhaXJkcm9wKTsKICB9CgogIC8qIEZ1bmN0aW9uIHRvIGVzdGltYXRlIGFpcmRyb3AgYW1vdW50LiBGb3Igc29tZSBhY2NvdW50cywgdGhlIHZhbHVlIG9mICovCiAgLyogdG9rZW5zIHJlY2VpdmVkIGJ5IGNhbGxpbmcgY2xhaW1BaXJkcm9wKCkgbWF5IGJlIGxlc3MgdGhhbiBnYXMgY29zdHMgKi8KICAKICAvKiBJZiBhbiBhY2NvdW50IGhhcyB0b2tlbnMgZnJvbSB0aGUgaWNvLCB0aGUgYW1vdW50IGFmdGVyIHRoZSBhaXJkcm9wICovCiAgLyogd2lsbCBiZSBuZXdCYWxhbmNlID0gdG9rZW5zICogVE9LRU5fU1VQUExZX0lDTyAvIHRva2Vuc0lzc3VlZEljbyAqLwogICAgICAKICBmdW5jdGlvbiBjb21wdXRlQWlyZHJvcChhZGRyZXNzIF9wYXJ0aWNpcGFudCkgY29uc3RhbnQgcmV0dXJucyAodWludCBhaXJkcm9wKSB7CiAgICAvLyByZXR1cm4gMCBpZiBpdCdzIHRvbyBlYXJseSBvciBpY28gd2FzIG5vdCBzdWNjZXNzZnVsCiAgICBpZiAoIGF0Tm93KCkgPCBEQVRFX0lDT19FTkQgfHwgIWljb1RocmVzaG9sZFJlYWNoZWQoKSApIHJldHVybiAwOwogICAgCiAgICAvLyByZXR1cm4gIDAgaXMgdGhlIGFpcmRyb3Agd2FzIGFscmVhZHkgY2xhaW1lZAogICAgaWYoIGFpcmRyb3BDbGFpbWVkW19wYXJ0aWNpcGFudF0gKSByZXR1cm4gMDsKCiAgICAvLyByZXR1cm4gMCBpZiB0aGUgYWNjb3VudCBkb2VzIG5vdCBob2xkIGFueSBjcm93ZHNhbGUgdG9rZW5zCiAgICBpZiggaWNvVG9rZW5zUmVjZWl2ZWRbX3BhcnRpY2lwYW50XSA9PSAwICkgcmV0dXJuIDA7CiAgICAKICAgIC8vIGFpcmRyb3AgYW1vdW50CiAgICB1aW50IHRva2VucyA9IGljb1Rva2Vuc1JlY2VpdmVkW19wYXJ0aWNpcGFudF07CiAgICB1aW50IG5ld0JhbGFuY2UgPSB0b2tlbnMubXVsKFRPS0VOX1NVUFBMWV9JQ08pIC8gdG9rZW5zSXNzdWVkSWNvOwogICAgYWlyZHJvcCA9IG5ld0JhbGFuY2UgLSB0b2tlbnM7CiAgfSAgCgogIC8qIE11bHRpcGxlIHRva2VuIHRyYW5zZmVycyBmcm9tIG9uZSBhZGRyZXNzIHRvIHNhdmUgZ2FzICovCiAgLyogKGxvbmdlciBfYW1vdW50cyBhcnJheSBub3QgYWNjZXB0ZWQgPSBzYW5pdHkgY2hlY2spICovCgogIGZ1bmN0aW9uIHRyYW5zZmVyTXVsdGlwbGUoYWRkcmVzc1tdIF9hZGRyZXNzZXMsIHVpbnRbXSBfYW1vdW50cykgZXh0ZXJuYWwgewogICAgcmVxdWlyZSggaXNUcmFuc2ZlcmFibGUoKSApOwogICAgcmVxdWlyZSggbG9ja2VkW21zZy5zZW5kZXJdID09IGZhbHNlICk7CiAgICByZXF1aXJlKCBfYWRkcmVzc2VzLmxlbmd0aCA9PSBfYW1vdW50cy5sZW5ndGggKTsKICAgIGZvciAodWludCBpID0gMDsgaSA8IF9hZGRyZXNzZXMubGVuZ3RoOyBpKyspIHsKICAgICAgaWYgKGxvY2tlZFtfYWRkcmVzc2VzW2ldXSA9PSBmYWxzZSkgc3VwZXIudHJhbnNmZXIoX2FkZHJlc3Nlc1tpXSwgX2Ftb3VudHNbaV0pOwogICAgfQogIH0gIAoKfQ=='.
	

]
