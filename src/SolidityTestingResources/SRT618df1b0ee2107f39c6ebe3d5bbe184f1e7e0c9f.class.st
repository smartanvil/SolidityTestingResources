Class {
	#name : #SRT618df1b0ee2107f39c6ebe3d5bbe184f1e7e0c9f,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT618df1b0ee2107f39c6ebe3d5bbe184f1e7e0c9f >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7CgpsaWJyYXJ5IFN0cmluZ3MgewogICAgc3RydWN0IHNsaWNlIHsKICAgICAgICB1aW50IF9sZW47CiAgICAgICAgdWludCBfcHRyOwogICAgfQoKICAgIGZ1bmN0aW9uIG1lbWNweSh1aW50IGRlc3QsIHVpbnQgc3JjLCB1aW50IGxlbikgcHJpdmF0ZSB7CiAgICAgICAgLy8gQ29weSB3b3JkLWxlbmd0aCBjaHVua3Mgd2hpbGUgcG9zc2libGUKICAgICAgICBmb3IoOyBsZW4gPj0gMzI7IGxlbiAtPSAzMikgewogICAgICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgICAgICBtc3RvcmUoZGVzdCwgbWxvYWQoc3JjKSkKICAgICAgICAgICAgfQogICAgICAgICAgICBkZXN0ICs9IDMyOwogICAgICAgICAgICBzcmMgKz0gMzI7CiAgICAgICAgfQoKICAgICAgICAvLyBDb3B5IHJlbWFpbmluZyBieXRlcwogICAgICAgIHVpbnQgbWFzayA9IDI1NiAqKiAoMzIgLSBsZW4pIC0gMTsKICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgIGxldCBzcmNwYXJ0IDo9IGFuZChtbG9hZChzcmMpLCBub3QobWFzaykpCiAgICAgICAgICAgIGxldCBkZXN0cGFydCA6PSBhbmQobWxvYWQoZGVzdCksIG1hc2spCiAgICAgICAgICAgIG1zdG9yZShkZXN0LCBvcihkZXN0cGFydCwgc3JjcGFydCkpCiAgICAgICAgfQogICAgfQoKICAgIC8qCiAgICAgKiBAZGV2IFJldHVybnMgYSBzbGljZSBjb250YWluaW5nIHRoZSBlbnRpcmUgc3RyaW5nLgogICAgICogQHBhcmFtIHNlbGYgVGhlIHN0cmluZyB0byBtYWtlIGEgc2xpY2UgZnJvbS4KICAgICAqIEByZXR1cm4gQSBuZXdseSBhbGxvY2F0ZWQgc2xpY2UgY29udGFpbmluZyB0aGUgZW50aXJlIHN0cmluZy4KICAgICAqLwogICAgZnVuY3Rpb24gdG9TbGljZShzdHJpbmcgc2VsZikgaW50ZXJuYWwgcmV0dXJucyAoc2xpY2UpIHsKICAgICAgICB1aW50IHB0cjsKICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgIHB0ciA6PSBhZGQoc2VsZiwgMHgyMCkKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNsaWNlKGJ5dGVzKHNlbGYpLmxlbmd0aCwgcHRyKTsKICAgIH0KCiAgICAvKgogICAgICogQGRldiBSZXR1cm5zIHRoZSBsZW5ndGggb2YgYSBudWxsLXRlcm1pbmF0ZWQgYnl0ZXMzMiBzdHJpbmcuCiAgICAgKiBAcGFyYW0gc2VsZiBUaGUgdmFsdWUgdG8gZmluZCB0aGUgbGVuZ3RoIG9mLgogICAgICogQHJldHVybiBUaGUgbGVuZ3RoIG9mIHRoZSBzdHJpbmcsIGZyb20gMCB0byAzMi4KICAgICAqLwogICAgZnVuY3Rpb24gbGVuKGJ5dGVzMzIgc2VsZikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgICAgIHVpbnQgcmV0OwogICAgICAgIGlmIChzZWxmID09IDApCiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIGlmIChzZWxmICYgMHhmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZiA9PSAwKSB7CiAgICAgICAgICAgIHJldCArPSAxNjsKICAgICAgICAgICAgc2VsZiA9IGJ5dGVzMzIodWludChzZWxmKSAvIDB4MTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwKTsKICAgICAgICB9CiAgICAgICAgaWYgKHNlbGYgJiAweGZmZmZmZmZmZmZmZmZmZmYgPT0gMCkgewogICAgICAgICAgICByZXQgKz0gODsKICAgICAgICAgICAgc2VsZiA9IGJ5dGVzMzIodWludChzZWxmKSAvIDB4MTAwMDAwMDAwMDAwMDAwMDApOwogICAgICAgIH0KICAgICAgICBpZiAoc2VsZiAmIDB4ZmZmZmZmZmYgPT0gMCkgewogICAgICAgICAgICByZXQgKz0gNDsKICAgICAgICAgICAgc2VsZiA9IGJ5dGVzMzIodWludChzZWxmKSAvIDB4MTAwMDAwMDAwKTsKICAgICAgICB9CiAgICAgICAgaWYgKHNlbGYgJiAweGZmZmYgPT0gMCkgewogICAgICAgICAgICByZXQgKz0gMjsKICAgICAgICAgICAgc2VsZiA9IGJ5dGVzMzIodWludChzZWxmKSAvIDB4MTAwMDApOwogICAgICAgIH0KICAgICAgICBpZiAoc2VsZiAmIDB4ZmYgPT0gMCkgewogICAgICAgICAgICByZXQgKz0gMTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIDMyIC0gcmV0OwogICAgfQoKICAgIC8qCiAgICAgKiBAZGV2IFJldHVybnMgYSBzbGljZSBjb250YWluaW5nIHRoZSBlbnRpcmUgYnl0ZXMzMiwgaW50ZXJwcmV0ZWQgYXMgYQogICAgICogICAgICBudWxsLXRlcm1pbnRhZWQgdXRmLTggc3RyaW5nLgogICAgICogQHBhcmFtIHNlbGYgVGhlIGJ5dGVzMzIgdmFsdWUgdG8gY29udmVydCB0byBhIHNsaWNlLgogICAgICogQHJldHVybiBBIG5ldyBzbGljZSBjb250YWluaW5nIHRoZSB2YWx1ZSBvZiB0aGUgaW5wdXQgYXJndW1lbnQgdXAgdG8gdGhlCiAgICAgKiAgICAgICAgIGZpcnN0IG51bGwuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRvU2xpY2VCMzIoYnl0ZXMzMiBzZWxmKSBpbnRlcm5hbCByZXR1cm5zIChzbGljZSByZXQpIHsKICAgICAgICAvLyBBbGxvY2F0ZSBzcGFjZSBmb3IgYHNlbGZgIGluIG1lbW9yeSwgY29weSBpdCB0aGVyZSwgYW5kIHBvaW50IHJldCBhdCBpdAogICAgICAgIGFzc2VtYmx5IHsKICAgICAgICAgICAgbGV0IHB0ciA6PSBtbG9hZCgweDQwKQogICAgICAgICAgICBtc3RvcmUoMHg0MCwgYWRkKHB0ciwgMHgyMCkpCiAgICAgICAgICAgIG1zdG9yZShwdHIsIHNlbGYpCiAgICAgICAgICAgIG1zdG9yZShhZGQocmV0LCAweDIwKSwgcHRyKQogICAgICAgIH0KICAgICAgICByZXQuX2xlbiA9IGxlbihzZWxmKTsKICAgIH0KCiAgICAvKgogICAgICogQGRldiBSZXR1cm5zIGEgbmV3IHNsaWNlIGNvbnRhaW5pbmcgdGhlIHNhbWUgZGF0YSBhcyB0aGUgY3VycmVudCBzbGljZS4KICAgICAqIEBwYXJhbSBzZWxmIFRoZSBzbGljZSB0byBjb3B5LgogICAgICogQHJldHVybiBBIG5ldyBzbGljZSBjb250YWluaW5nIHRoZSBzYW1lIGRhdGEgYXMgYHNlbGZgLgogICAgICovCiAgICBmdW5jdGlvbiBjb3B5KHNsaWNlIHNlbGYpIGludGVybmFsIHJldHVybnMgKHNsaWNlKSB7CiAgICAgICAgcmV0dXJuIHNsaWNlKHNlbGYuX2xlbiwgc2VsZi5fcHRyKTsKICAgIH0KCiAgICAvKgogICAgICogQGRldiBDb3BpZXMgYSBzbGljZSB0byBhIG5ldyBzdHJpbmcuCiAgICAgKiBAcGFyYW0gc2VsZiBUaGUgc2xpY2UgdG8gY29weS4KICAgICAqIEByZXR1cm4gQSBuZXdseSBhbGxvY2F0ZWQgc3RyaW5nIGNvbnRhaW5pbmcgdGhlIHNsaWNlJ3MgdGV4dC4KICAgICAqLwogICAgZnVuY3Rpb24gdG9TdHJpbmcoc2xpY2Ugc2VsZikgaW50ZXJuYWwgcmV0dXJucyAoc3RyaW5nKSB7CiAgICAgICAgdmFyIHJldCA9IG5ldyBzdHJpbmcoc2VsZi5fbGVuKTsKICAgICAgICB1aW50IHJldHB0cjsKICAgICAgICBhc3NlbWJseSB7IHJldHB0ciA6PSBhZGQocmV0LCAzMikgfQoKICAgICAgICBtZW1jcHkocmV0cHRyLCBzZWxmLl9wdHIsIHNlbGYuX2xlbik7CiAgICAgICAgcmV0dXJuIHJldDsKICAgIH0KCiAgICAvKgogICAgICogQGRldiBSZXR1cm5zIHRoZSBsZW5ndGggaW4gcnVuZXMgb2YgdGhlIHNsaWNlLiBOb3RlIHRoYXQgdGhpcyBvcGVyYXRpb24KICAgICAqICAgICAgdGFrZXMgdGltZSBwcm9wb3J0aW9uYWwgdG8gdGhlIGxlbmd0aCBvZiB0aGUgc2xpY2U7IGF2b2lkIHVzaW5nIGl0CiAgICAgKiAgICAgIGluIGxvb3BzLCBhbmQgY2FsbCBgc2xpY2UuZW1wdHkoKWAgaWYgeW91IG9ubHkgbmVlZCB0byBrbm93IHdoZXRoZXIKICAgICAqICAgICAgdGhlIHNsaWNlIGlzIGVtcHR5IG9yIG5vdC4KICAgICAqIEBwYXJhbSBzZWxmIFRoZSBzbGljZSB0byBvcGVyYXRlIG9uLgogICAgICogQHJldHVybiBUaGUgbGVuZ3RoIG9mIHRoZSBzbGljZSBpbiBydW5lcy4KICAgICAqLwogICAgZnVuY3Rpb24gbGVuKHNsaWNlIHNlbGYpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgICAgICAvLyBTdGFydGluZyBhdCBwdHItMzEgbWVhbnMgdGhlIExTQiB3aWxsIGJlIHRoZSBieXRlIHdlIGNhcmUgYWJvdXQKICAgICAgICB2YXIgcHRyID0gc2VsZi5fcHRyIC0gMzE7CiAgICAgICAgdmFyIGVuZCA9IHB0ciArIHNlbGYuX2xlbjsKICAgICAgICBmb3IgKHVpbnQgbGVuID0gMDsgcHRyIDwgZW5kOyBsZW4rKykgewogICAgICAgICAgICB1aW50OCBiOwogICAgICAgICAgICBhc3NlbWJseSB7IGIgOj0gYW5kKG1sb2FkKHB0ciksIDB4RkYpIH0KICAgICAgICAgICAgaWYgKGIgPCAweDgwKSB7CiAgICAgICAgICAgICAgICBwdHIgKz0gMTsKICAgICAgICAgICAgfSBlbHNlIGlmKGIgPCAweEUwKSB7CiAgICAgICAgICAgICAgICBwdHIgKz0gMjsKICAgICAgICAgICAgfSBlbHNlIGlmKGIgPCAweEYwKSB7CiAgICAgICAgICAgICAgICBwdHIgKz0gMzsKICAgICAgICAgICAgfSBlbHNlIGlmKGIgPCAweEY4KSB7CiAgICAgICAgICAgICAgICBwdHIgKz0gNDsKICAgICAgICAgICAgfSBlbHNlIGlmKGIgPCAweEZDKSB7CiAgICAgICAgICAgICAgICBwdHIgKz0gNTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHB0ciArPSA2OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBsZW47CiAgICB9CgogICAgLyoKICAgICAqIEBkZXYgUmV0dXJucyB0cnVlIGlmIHRoZSBzbGljZSBpcyBlbXB0eSAoaGFzIGEgbGVuZ3RoIG9mIDApLgogICAgICogQHBhcmFtIHNlbGYgVGhlIHNsaWNlIHRvIG9wZXJhdGUgb24uCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIHNsaWNlIGlzIGVtcHR5LCBGYWxzZSBvdGhlcndpc2UuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGVtcHR5KHNsaWNlIHNlbGYpIGludGVybmFsIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc2VsZi5fbGVuID09IDA7CiAgICB9CgogICAgLyoKICAgICAqIEBkZXYgUmV0dXJucyBhIHBvc2l0aXZlIG51bWJlciBpZiBgb3RoZXJgIGNvbWVzIGxleGljb2dyYXBoaWNhbGx5IGFmdGVyCiAgICAgKiAgICAgIGBzZWxmYCwgYSBuZWdhdGl2ZSBudW1iZXIgaWYgaXQgY29tZXMgYmVmb3JlLCBvciB6ZXJvIGlmIHRoZQogICAgICogICAgICBjb250ZW50cyBvZiB0aGUgdHdvIHNsaWNlcyBhcmUgZXF1YWwuIENvbXBhcmlzb24gaXMgZG9uZSBwZXItcnVuZSwKICAgICAqICAgICAgb24gdW5pY29kZSBjb2RlcG9pbnRzLgogICAgICogQHBhcmFtIHNlbGYgVGhlIGZpcnN0IHNsaWNlIHRvIGNvbXBhcmUuCiAgICAgKiBAcGFyYW0gb3RoZXIgVGhlIHNlY29uZCBzbGljZSB0byBjb21wYXJlLgogICAgICogQHJldHVybiBUaGUgcmVzdWx0IG9mIHRoZSBjb21wYXJpc29uLgogICAgICovCiAgICBmdW5jdGlvbiBjb21wYXJlKHNsaWNlIHNlbGYsIHNsaWNlIG90aGVyKSBpbnRlcm5hbCByZXR1cm5zIChpbnQpIHsKICAgICAgICB1aW50IHNob3J0ZXN0ID0gc2VsZi5fbGVuOwogICAgICAgIGlmIChvdGhlci5fbGVuIDwgc2VsZi5fbGVuKQogICAgICAgICAgICBzaG9ydGVzdCA9IG90aGVyLl9sZW47CgogICAgICAgIHZhciBzZWxmcHRyID0gc2VsZi5fcHRyOwogICAgICAgIHZhciBvdGhlcnB0ciA9IG90aGVyLl9wdHI7CiAgICAgICAgZm9yICh1aW50IGlkeCA9IDA7IGlkeCA8IHNob3J0ZXN0OyBpZHggKz0gMzIpIHsKICAgICAgICAgICAgdWludCBhOwogICAgICAgICAgICB1aW50IGI7CiAgICAgICAgICAgIGFzc2VtYmx5IHsKICAgICAgICAgICAgICAgIGEgOj0gbWxvYWQoc2VsZnB0cikKICAgICAgICAgICAgICAgIGIgOj0gbWxvYWQob3RoZXJwdHIpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGEgIT0gYikgewogICAgICAgICAgICAgICAgLy8gTWFzayBvdXQgaXJyZWxldmFudCBieXRlcyBhbmQgY2hlY2sgYWdhaW4KICAgICAgICAgICAgICAgIHVpbnQgbWFzayA9IH4oMiAqKiAoOCAqICgzMiAtIHNob3J0ZXN0ICsgaWR4KSkgLSAxKTsKICAgICAgICAgICAgICAgIHZhciBkaWZmID0gKGEgJiBtYXNrKSAtIChiICYgbWFzayk7CiAgICAgICAgICAgICAgICBpZiAoZGlmZiAhPSAwKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBpbnQoZGlmZik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2VsZnB0ciArPSAzMjsKICAgICAgICAgICAgb3RoZXJwdHIgKz0gMzI7CiAgICAgICAgfQogICAgICAgIHJldHVybiBpbnQoc2VsZi5fbGVuKSAtIGludChvdGhlci5fbGVuKTsKICAgIH0KCiAgICAvKgogICAgICogQGRldiBSZXR1cm5zIHRydWUgaWYgdGhlIHR3byBzbGljZXMgY29udGFpbiB0aGUgc2FtZSB0ZXh0LgogICAgICogQHBhcmFtIHNlbGYgVGhlIGZpcnN0IHNsaWNlIHRvIGNvbXBhcmUuCiAgICAgKiBAcGFyYW0gc2VsZiBUaGUgc2Vjb25kIHNsaWNlIHRvIGNvbXBhcmUuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIHNsaWNlcyBhcmUgZXF1YWwsIGZhbHNlIG90aGVyd2lzZS4KICAgICAqLwogICAgZnVuY3Rpb24gZXF1YWxzKHNsaWNlIHNlbGYsIHNsaWNlIG90aGVyKSBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIGNvbXBhcmUoc2VsZiwgb3RoZXIpID09IDA7CiAgICB9CgogICAgLyoKICAgICAqIEBkZXYgRXh0cmFjdHMgdGhlIGZpcnN0IHJ1bmUgaW4gdGhlIHNsaWNlIGludG8gYHJ1bmVgLCBhZHZhbmNpbmcgdGhlCiAgICAgKiAgICAgIHNsaWNlIHRvIHBvaW50IHRvIHRoZSBuZXh0IHJ1bmUgYW5kIHJldHVybmluZyBgc2VsZmAuCiAgICAgKiBAcGFyYW0gc2VsZiBUaGUgc2xpY2UgdG8gb3BlcmF0ZSBvbi4KICAgICAqIEBwYXJhbSBydW5lIFRoZSBzbGljZSB0aGF0IHdpbGwgY29udGFpbiB0aGUgZmlyc3QgcnVuZS4KICAgICAqIEByZXR1cm4gYHJ1bmVgLgogICAgICovCiAgICBmdW5jdGlvbiBuZXh0UnVuZShzbGljZSBzZWxmLCBzbGljZSBydW5lKSBpbnRlcm5hbCByZXR1cm5zIChzbGljZSkgewogICAgICAgIHJ1bmUuX3B0ciA9IHNlbGYuX3B0cjsKCiAgICAgICAgaWYgKHNlbGYuX2xlbiA9PSAwKSB7CiAgICAgICAgICAgIHJ1bmUuX2xlbiA9IDA7CiAgICAgICAgICAgIHJldHVybiBydW5lOwogICAgICAgIH0KCiAgICAgICAgdWludCBsZW47CiAgICAgICAgdWludCBiOwogICAgICAgIC8vIExvYWQgdGhlIGZpcnN0IGJ5dGUgb2YgdGhlIHJ1bmUgaW50byB0aGUgTFNCcyBvZiBiCiAgICAgICAgYXNzZW1ibHkgeyBiIDo9IGFuZChtbG9hZChzdWIobWxvYWQoYWRkKHNlbGYsIDMyKSksIDMxKSksIDB4RkYpIH0KICAgICAgICBpZiAoYiA8IDB4ODApIHsKICAgICAgICAgICAgbGVuID0gMTsKICAgICAgICB9IGVsc2UgaWYoYiA8IDB4RTApIHsKICAgICAgICAgICAgbGVuID0gMjsKICAgICAgICB9IGVsc2UgaWYoYiA8IDB4RjApIHsKICAgICAgICAgICAgbGVuID0gMzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsZW4gPSA0OwogICAgICAgIH0KCiAgICAgICAgLy8gQ2hlY2sgZm9yIHRydW5jYXRlZCBjb2RlcG9pbnRzCiAgICAgICAgaWYgKGxlbiA+IHNlbGYuX2xlbikgewogICAgICAgICAgICBydW5lLl9sZW4gPSBzZWxmLl9sZW47CiAgICAgICAgICAgIHNlbGYuX3B0ciArPSBzZWxmLl9sZW47CiAgICAgICAgICAgIHNlbGYuX2xlbiA9IDA7CiAgICAgICAgICAgIHJldHVybiBydW5lOwogICAgICAgIH0KCiAgICAgICAgc2VsZi5fcHRyICs9IGxlbjsKICAgICAgICBzZWxmLl9sZW4gLT0gbGVuOwogICAgICAgIHJ1bmUuX2xlbiA9IGxlbjsKICAgICAgICByZXR1cm4gcnVuZTsKICAgIH0KCiAgICAvKgogICAgICogQGRldiBSZXR1cm5zIHRoZSBmaXJzdCBydW5lIGluIHRoZSBzbGljZSwgYWR2YW5jaW5nIHRoZSBzbGljZSB0byBwb2ludAogICAgICogICAgICB0byB0aGUgbmV4dCBydW5lLgogICAgICogQHBhcmFtIHNlbGYgVGhlIHNsaWNlIHRvIG9wZXJhdGUgb24uCiAgICAgKiBAcmV0dXJuIEEgc2xpY2UgY29udGFpbmluZyBvbmx5IHRoZSBmaXJzdCBydW5lIGZyb20gYHNlbGZgLgogICAgICovCiAgICBmdW5jdGlvbiBuZXh0UnVuZShzbGljZSBzZWxmKSBpbnRlcm5hbCByZXR1cm5zIChzbGljZSByZXQpIHsKICAgICAgICBuZXh0UnVuZShzZWxmLCByZXQpOwogICAgfQoKICAgIC8qCiAgICAgKiBAZGV2IFJldHVybnMgdGhlIG51bWJlciBvZiB0aGUgZmlyc3QgY29kZXBvaW50IGluIHRoZSBzbGljZS4KICAgICAqIEBwYXJhbSBzZWxmIFRoZSBzbGljZSB0byBvcGVyYXRlIG9uLgogICAgICogQHJldHVybiBUaGUgbnVtYmVyIG9mIHRoZSBmaXJzdCBjb2RlcG9pbnQgaW4gdGhlIHNsaWNlLgogICAgICovCiAgICBmdW5jdGlvbiBvcmQoc2xpY2Ugc2VsZikgaW50ZXJuYWwgcmV0dXJucyAodWludCByZXQpIHsKICAgICAgICBpZiAoc2VsZi5fbGVuID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQoKICAgICAgICB1aW50IHdvcmQ7CiAgICAgICAgdWludCBsZW47CiAgICAgICAgdWludCBkaXYgPSAyICoqIDI0ODsKCiAgICAgICAgLy8gTG9hZCB0aGUgcnVuZSBpbnRvIHRoZSBNU0JzIG9mIGIKICAgICAgICBhc3NlbWJseSB7IHdvcmQ6PSBtbG9hZChtbG9hZChhZGQoc2VsZiwgMzIpKSkgfQogICAgICAgIHZhciBiID0gd29yZCAvIGRpdjsKICAgICAgICBpZiAoYiA8IDB4ODApIHsKICAgICAgICAgICAgcmV0ID0gYjsKICAgICAgICAgICAgbGVuID0gMTsKICAgICAgICB9IGVsc2UgaWYoYiA8IDB4RTApIHsKICAgICAgICAgICAgcmV0ID0gYiAmIDB4MUY7CiAgICAgICAgICAgIGxlbiA9IDI7CiAgICAgICAgfSBlbHNlIGlmKGIgPCAweEYwKSB7CiAgICAgICAgICAgIHJldCA9IGIgJiAweDBGOwogICAgICAgICAgICBsZW4gPSAzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldCA9IGIgJiAweDA3OwogICAgICAgICAgICBsZW4gPSA0OwogICAgICAgIH0KCiAgICAgICAgLy8gQ2hlY2sgZm9yIHRydW5jYXRlZCBjb2RlcG9pbnRzCiAgICAgICAgaWYgKGxlbiA+IHNlbGYuX2xlbikgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CgogICAgICAgIGZvciAodWludCBpID0gMTsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICAgIGRpdiA9IGRpdiAvIDI1NjsKICAgICAgICAgICAgYiA9ICh3b3JkIC8gZGl2KSAmIDB4RkY7CiAgICAgICAgICAgIGlmIChiICYgMHhDMCAhPSAweDgwKSB7CiAgICAgICAgICAgICAgICAvLyBJbnZhbGlkIFVURi04IHNlcXVlbmNlCiAgICAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXQgPSAocmV0ICogNjQpIHwgKGIgJiAweDNGKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXQ7CiAgICB9CgogICAgLyoKICAgICAqIEBkZXYgUmV0dXJucyB0aGUga2VjY2FrLTI1NiBoYXNoIG9mIHRoZSBzbGljZS4KICAgICAqIEBwYXJhbSBzZWxmIFRoZSBzbGljZSB0byBoYXNoLgogICAgICogQHJldHVybiBUaGUgaGFzaCBvZiB0aGUgc2xpY2UuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGtlY2NhayhzbGljZSBzZWxmKSBpbnRlcm5hbCByZXR1cm5zIChieXRlczMyIHJldCkgewogICAgICAgIGFzc2VtYmx5IHsKICAgICAgICAgICAgcmV0IDo9IHNoYTMobWxvYWQoYWRkKHNlbGYsIDMyKSksIG1sb2FkKHNlbGYpKQogICAgICAgIH0KICAgIH0KCiAgICAvKgogICAgICogQGRldiBSZXR1cm5zIHRydWUgaWYgYHNlbGZgIHN0YXJ0cyB3aXRoIGBuZWVkbGVgLgogICAgICogQHBhcmFtIHNlbGYgVGhlIHNsaWNlIHRvIG9wZXJhdGUgb24uCiAgICAgKiBAcGFyYW0gbmVlZGxlIFRoZSBzbGljZSB0byBzZWFyY2ggZm9yLgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSBzbGljZSBzdGFydHMgd2l0aCB0aGUgcHJvdmlkZWQgdGV4dCwgZmFsc2Ugb3RoZXJ3aXNlLgogICAgICovCiAgICBmdW5jdGlvbiBzdGFydHNXaXRoKHNsaWNlIHNlbGYsIHNsaWNlIG5lZWRsZSkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmIChzZWxmLl9sZW4gPCBuZWVkbGUuX2xlbikgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBpZiAoc2VsZi5fcHRyID09IG5lZWRsZS5fcHRyKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgYm9vbCBlcXVhbDsKICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgIGxldCBsZW4gOj0gbWxvYWQobmVlZGxlKQogICAgICAgICAgICBsZXQgc2VsZnB0ciA6PSBtbG9hZChhZGQoc2VsZiwgMHgyMCkpCiAgICAgICAgICAgIGxldCBuZWVkbGVwdHIgOj0gbWxvYWQoYWRkKG5lZWRsZSwgMHgyMCkpCiAgICAgICAgICAgIGVxdWFsIDo9IGVxKHNoYTMoc2VsZnB0ciwgbGVuKSwgc2hhMyhuZWVkbGVwdHIsIGxlbikpCiAgICAgICAgfQogICAgICAgIHJldHVybiBlcXVhbDsKICAgIH0KCiAgICAvKgogICAgICogQGRldiBJZiBgc2VsZmAgc3RhcnRzIHdpdGggYG5lZWRsZWAsIGBuZWVkbGVgIGlzIHJlbW92ZWQgZnJvbSB0aGUKICAgICAqICAgICAgYmVnaW5uaW5nIG9mIGBzZWxmYC4gT3RoZXJ3aXNlLCBgc2VsZmAgaXMgdW5tb2RpZmllZC4KICAgICAqIEBwYXJhbSBzZWxmIFRoZSBzbGljZSB0byBvcGVyYXRlIG9uLgogICAgICogQHBhcmFtIG5lZWRsZSBUaGUgc2xpY2UgdG8gc2VhcmNoIGZvci4KICAgICAqIEByZXR1cm4gYHNlbGZgCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJleW9uZChzbGljZSBzZWxmLCBzbGljZSBuZWVkbGUpIGludGVybmFsIHJldHVybnMgKHNsaWNlKSB7CiAgICAgICAgaWYgKHNlbGYuX2xlbiA8IG5lZWRsZS5fbGVuKSB7CiAgICAgICAgICAgIHJldHVybiBzZWxmOwogICAgICAgIH0KCiAgICAgICAgYm9vbCBlcXVhbCA9IHRydWU7CiAgICAgICAgaWYgKHNlbGYuX3B0ciAhPSBuZWVkbGUuX3B0cikgewogICAgICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgICAgICBsZXQgbGVuIDo9IG1sb2FkKG5lZWRsZSkKICAgICAgICAgICAgICAgIGxldCBzZWxmcHRyIDo9IG1sb2FkKGFkZChzZWxmLCAweDIwKSkKICAgICAgICAgICAgICAgIGxldCBuZWVkbGVwdHIgOj0gbWxvYWQoYWRkKG5lZWRsZSwgMHgyMCkpCiAgICAgICAgICAgICAgICBlcXVhbCA6PSBlcShzaGEzKHNlbGZwdHIsIGxlbiksIHNoYTMobmVlZGxlcHRyLCBsZW4pKQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoZXF1YWwpIHsKICAgICAgICAgICAgc2VsZi5fbGVuIC09IG5lZWRsZS5fbGVuOwogICAgICAgICAgICBzZWxmLl9wdHIgKz0gbmVlZGxlLl9sZW47CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gc2VsZjsKICAgIH0KCiAgICAvKgogICAgICogQGRldiBSZXR1cm5zIHRydWUgaWYgdGhlIHNsaWNlIGVuZHMgd2l0aCBgbmVlZGxlYC4KICAgICAqIEBwYXJhbSBzZWxmIFRoZSBzbGljZSB0byBvcGVyYXRlIG9uLgogICAgICogQHBhcmFtIG5lZWRsZSBUaGUgc2xpY2UgdG8gc2VhcmNoIGZvci4KICAgICAqIEByZXR1cm4gVHJ1ZSBpZiB0aGUgc2xpY2Ugc3RhcnRzIHdpdGggdGhlIHByb3ZpZGVkIHRleHQsIGZhbHNlIG90aGVyd2lzZS4KICAgICAqLwogICAgZnVuY3Rpb24gZW5kc1dpdGgoc2xpY2Ugc2VsZiwgc2xpY2UgbmVlZGxlKSBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYgKHNlbGYuX2xlbiA8IG5lZWRsZS5fbGVuKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHZhciBzZWxmcHRyID0gc2VsZi5fcHRyICsgc2VsZi5fbGVuIC0gbmVlZGxlLl9sZW47CgogICAgICAgIGlmIChzZWxmcHRyID09IG5lZWRsZS5fcHRyKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgYm9vbCBlcXVhbDsKICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgIGxldCBsZW4gOj0gbWxvYWQobmVlZGxlKQogICAgICAgICAgICBsZXQgbmVlZGxlcHRyIDo9IG1sb2FkKGFkZChuZWVkbGUsIDB4MjApKQogICAgICAgICAgICBlcXVhbCA6PSBlcShzaGEzKHNlbGZwdHIsIGxlbiksIHNoYTMobmVlZGxlcHRyLCBsZW4pKQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGVxdWFsOwogICAgfQoKICAgIC8qCiAgICAgKiBAZGV2IElmIGBzZWxmYCBlbmRzIHdpdGggYG5lZWRsZWAsIGBuZWVkbGVgIGlzIHJlbW92ZWQgZnJvbSB0aGUKICAgICAqICAgICAgZW5kIG9mIGBzZWxmYC4gT3RoZXJ3aXNlLCBgc2VsZmAgaXMgdW5tb2RpZmllZC4KICAgICAqIEBwYXJhbSBzZWxmIFRoZSBzbGljZSB0byBvcGVyYXRlIG9uLgogICAgICogQHBhcmFtIG5lZWRsZSBUaGUgc2xpY2UgdG8gc2VhcmNoIGZvci4KICAgICAqIEByZXR1cm4gYHNlbGZgCiAgICAgKi8KICAgIGZ1bmN0aW9uIHVudGlsKHNsaWNlIHNlbGYsIHNsaWNlIG5lZWRsZSkgaW50ZXJuYWwgcmV0dXJucyAoc2xpY2UpIHsKICAgICAgICBpZiAoc2VsZi5fbGVuIDwgbmVlZGxlLl9sZW4pIHsKICAgICAgICAgICAgcmV0dXJuIHNlbGY7CiAgICAgICAgfQoKICAgICAgICB2YXIgc2VsZnB0ciA9IHNlbGYuX3B0ciArIHNlbGYuX2xlbiAtIG5lZWRsZS5fbGVuOwogICAgICAgIGJvb2wgZXF1YWwgPSB0cnVlOwogICAgICAgIGlmIChzZWxmcHRyICE9IG5lZWRsZS5fcHRyKSB7CiAgICAgICAgICAgIGFzc2VtYmx5IHsKICAgICAgICAgICAgICAgIGxldCBsZW4gOj0gbWxvYWQobmVlZGxlKQogICAgICAgICAgICAgICAgbGV0IG5lZWRsZXB0ciA6PSBtbG9hZChhZGQobmVlZGxlLCAweDIwKSkKICAgICAgICAgICAgICAgIGVxdWFsIDo9IGVxKHNoYTMoc2VsZnB0ciwgbGVuKSwgc2hhMyhuZWVkbGVwdHIsIGxlbikpCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChlcXVhbCkgewogICAgICAgICAgICBzZWxmLl9sZW4gLT0gbmVlZGxlLl9sZW47CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gc2VsZjsKICAgIH0KCiAgICAvLyBSZXR1cm5zIHRoZSBtZW1vcnkgYWRkcmVzcyBvZiB0aGUgZmlyc3QgYnl0ZSBvZiB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZgogICAgLy8gYG5lZWRsZWAgaW4gYHNlbGZgLCBvciB0aGUgZmlyc3QgYnl0ZSBhZnRlciBgc2VsZmAgaWYgbm90IGZvdW5kLgogICAgZnVuY3Rpb24gZmluZFB0cih1aW50IHNlbGZsZW4sIHVpbnQgc2VsZnB0ciwgdWludCBuZWVkbGVsZW4sIHVpbnQgbmVlZGxlcHRyKSBwcml2YXRlIHJldHVybnMgKHVpbnQpIHsKICAgICAgICB1aW50IHB0cjsKICAgICAgICB1aW50IGlkeDsKCiAgICAgICAgaWYgKG5lZWRsZWxlbiA8PSBzZWxmbGVuKSB7CiAgICAgICAgICAgIGlmIChuZWVkbGVsZW4gPD0gMzIpIHsKICAgICAgICAgICAgICAgIC8vIE9wdGltaXplZCBhc3NlbWJseSBmb3IgNjggZ2FzIHBlciBieXRlIG9uIHNob3J0IHN0cmluZ3MKICAgICAgICAgICAgICAgIGFzc2VtYmx5IHsKICAgICAgICAgICAgICAgICAgICBsZXQgbWFzayA6PSBub3Qoc3ViKGV4cCgyLCBtdWwoOCwgc3ViKDMyLCBuZWVkbGVsZW4pKSksIDEpKQogICAgICAgICAgICAgICAgICAgIGxldCBuZWVkbGVkYXRhIDo9IGFuZChtbG9hZChuZWVkbGVwdHIpLCBtYXNrKQogICAgICAgICAgICAgICAgICAgIGxldCBlbmQgOj0gYWRkKHNlbGZwdHIsIHN1YihzZWxmbGVuLCBuZWVkbGVsZW4pKQogICAgICAgICAgICAgICAgICAgIHB0ciA6PSBzZWxmcHRyCiAgICAgICAgICAgICAgICAgICAgbG9vcDoKICAgICAgICAgICAgICAgICAgICBqdW1waShleGl0LCBlcShhbmQobWxvYWQocHRyKSwgbWFzayksIG5lZWRsZWRhdGEpKQogICAgICAgICAgICAgICAgICAgIHB0ciA6PSBhZGQocHRyLCAxKQogICAgICAgICAgICAgICAgICAgIGp1bXBpKGxvb3AsIGx0KHN1YihwdHIsIDEpLCBlbmQpKQogICAgICAgICAgICAgICAgICAgIHB0ciA6PSBhZGQoc2VsZnB0ciwgc2VsZmxlbikKICAgICAgICAgICAgICAgICAgICBleGl0OgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHB0cjsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIEZvciBsb25nIG5lZWRsZXMsIHVzZSBoYXNoaW5nCiAgICAgICAgICAgICAgICBieXRlczMyIGhhc2g7CiAgICAgICAgICAgICAgICBhc3NlbWJseSB7IGhhc2ggOj0gc2hhMyhuZWVkbGVwdHIsIG5lZWRsZWxlbikgfQogICAgICAgICAgICAgICAgcHRyID0gc2VsZnB0cjsKICAgICAgICAgICAgICAgIGZvciAoaWR4ID0gMDsgaWR4IDw9IHNlbGZsZW4gLSBuZWVkbGVsZW47IGlkeCsrKSB7CiAgICAgICAgICAgICAgICAgICAgYnl0ZXMzMiB0ZXN0SGFzaDsKICAgICAgICAgICAgICAgICAgICBhc3NlbWJseSB7IHRlc3RIYXNoIDo9IHNoYTMocHRyLCBuZWVkbGVsZW4pIH0KICAgICAgICAgICAgICAgICAgICBpZiAoaGFzaCA9PSB0ZXN0SGFzaCkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHB0cjsKICAgICAgICAgICAgICAgICAgICBwdHIgKz0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gc2VsZnB0ciArIHNlbGZsZW47CiAgICB9CgogICAgLy8gUmV0dXJucyB0aGUgbWVtb3J5IGFkZHJlc3Mgb2YgdGhlIGZpcnN0IGJ5dGUgYWZ0ZXIgdGhlIGxhc3Qgb2NjdXJyZW5jZSBvZgogICAgLy8gYG5lZWRsZWAgaW4gYHNlbGZgLCBvciB0aGUgYWRkcmVzcyBvZiBgc2VsZmAgaWYgbm90IGZvdW5kLgogICAgZnVuY3Rpb24gcmZpbmRQdHIodWludCBzZWxmbGVuLCB1aW50IHNlbGZwdHIsIHVpbnQgbmVlZGxlbGVuLCB1aW50IG5lZWRsZXB0cikgcHJpdmF0ZSByZXR1cm5zICh1aW50KSB7CiAgICAgICAgdWludCBwdHI7CgogICAgICAgIGlmIChuZWVkbGVsZW4gPD0gc2VsZmxlbikgewogICAgICAgICAgICBpZiAobmVlZGxlbGVuIDw9IDMyKSB7CiAgICAgICAgICAgICAgICAvLyBPcHRpbWl6ZWQgYXNzZW1ibHkgZm9yIDY5IGdhcyBwZXIgYnl0ZSBvbiBzaG9ydCBzdHJpbmdzCiAgICAgICAgICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IG1hc2sgOj0gbm90KHN1YihleHAoMiwgbXVsKDgsIHN1YigzMiwgbmVlZGxlbGVuKSkpLCAxKSkKICAgICAgICAgICAgICAgICAgICBsZXQgbmVlZGxlZGF0YSA6PSBhbmQobWxvYWQobmVlZGxlcHRyKSwgbWFzaykKICAgICAgICAgICAgICAgICAgICBwdHIgOj0gYWRkKHNlbGZwdHIsIHN1YihzZWxmbGVuLCBuZWVkbGVsZW4pKQogICAgICAgICAgICAgICAgICAgIGxvb3A6CiAgICAgICAgICAgICAgICAgICAganVtcGkocmV0LCBlcShhbmQobWxvYWQocHRyKSwgbWFzayksIG5lZWRsZWRhdGEpKQogICAgICAgICAgICAgICAgICAgIHB0ciA6PSBzdWIocHRyLCAxKQogICAgICAgICAgICAgICAgICAgIGp1bXBpKGxvb3AsIGd0KGFkZChwdHIsIDEpLCBzZWxmcHRyKSkKICAgICAgICAgICAgICAgICAgICBwdHIgOj0gc2VsZnB0cgogICAgICAgICAgICAgICAgICAgIGp1bXAoZXhpdCkKICAgICAgICAgICAgICAgICAgICByZXQ6CiAgICAgICAgICAgICAgICAgICAgcHRyIDo9IGFkZChwdHIsIG5lZWRsZWxlbikKICAgICAgICAgICAgICAgICAgICBleGl0OgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHB0cjsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIEZvciBsb25nIG5lZWRsZXMsIHVzZSBoYXNoaW5nCiAgICAgICAgICAgICAgICBieXRlczMyIGhhc2g7CiAgICAgICAgICAgICAgICBhc3NlbWJseSB7IGhhc2ggOj0gc2hhMyhuZWVkbGVwdHIsIG5lZWRsZWxlbikgfQogICAgICAgICAgICAgICAgcHRyID0gc2VsZnB0ciArIChzZWxmbGVuIC0gbmVlZGxlbGVuKTsKICAgICAgICAgICAgICAgIHdoaWxlIChwdHIgPj0gc2VsZnB0cikgewogICAgICAgICAgICAgICAgICAgIGJ5dGVzMzIgdGVzdEhhc2g7CiAgICAgICAgICAgICAgICAgICAgYXNzZW1ibHkgeyB0ZXN0SGFzaCA6PSBzaGEzKHB0ciwgbmVlZGxlbGVuKSB9CiAgICAgICAgICAgICAgICAgICAgaWYgKGhhc2ggPT0gdGVzdEhhc2gpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwdHIgKyBuZWVkbGVsZW47CiAgICAgICAgICAgICAgICAgICAgcHRyIC09IDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNlbGZwdHI7CiAgICB9CgogICAgLyoKICAgICAqIEBkZXYgTW9kaWZpZXMgYHNlbGZgIHRvIGNvbnRhaW4gZXZlcnl0aGluZyBmcm9tIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mCiAgICAgKiAgICAgIGBuZWVkbGVgIHRvIHRoZSBlbmQgb2YgdGhlIHNsaWNlLiBgc2VsZmAgaXMgc2V0IHRvIHRoZSBlbXB0eSBzbGljZQogICAgICogICAgICBpZiBgbmVlZGxlYCBpcyBub3QgZm91bmQuCiAgICAgKiBAcGFyYW0gc2VsZiBUaGUgc2xpY2UgdG8gc2VhcmNoIGFuZCBtb2RpZnkuCiAgICAgKiBAcGFyYW0gbmVlZGxlIFRoZSB0ZXh0IHRvIHNlYXJjaCBmb3IuCiAgICAgKiBAcmV0dXJuIGBzZWxmYC4KICAgICAqLwogICAgZnVuY3Rpb24gZmluZChzbGljZSBzZWxmLCBzbGljZSBuZWVkbGUpIGludGVybmFsIHJldHVybnMgKHNsaWNlKSB7CiAgICAgICAgdWludCBwdHIgPSBmaW5kUHRyKHNlbGYuX2xlbiwgc2VsZi5fcHRyLCBuZWVkbGUuX2xlbiwgbmVlZGxlLl9wdHIpOwogICAgICAgIHNlbGYuX2xlbiAtPSBwdHIgLSBzZWxmLl9wdHI7CiAgICAgICAgc2VsZi5fcHRyID0gcHRyOwogICAgICAgIHJldHVybiBzZWxmOwogICAgfQoKICAgIC8qCiAgICAgKiBAZGV2IE1vZGlmaWVzIGBzZWxmYCB0byBjb250YWluIHRoZSBwYXJ0IG9mIHRoZSBzdHJpbmcgZnJvbSB0aGUgc3RhcnQgb2YKICAgICAqICAgICAgYHNlbGZgIHRvIHRoZSBlbmQgb2YgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgYG5lZWRsZWAuIElmIGBuZWVkbGVgCiAgICAgKiAgICAgIGlzIG5vdCBmb3VuZCwgYHNlbGZgIGlzIHNldCB0byB0aGUgZW1wdHkgc2xpY2UuCiAgICAgKiBAcGFyYW0gc2VsZiBUaGUgc2xpY2UgdG8gc2VhcmNoIGFuZCBtb2RpZnkuCiAgICAgKiBAcGFyYW0gbmVlZGxlIFRoZSB0ZXh0IHRvIHNlYXJjaCBmb3IuCiAgICAgKiBAcmV0dXJuIGBzZWxmYC4KICAgICAqLwogICAgZnVuY3Rpb24gcmZpbmQoc2xpY2Ugc2VsZiwgc2xpY2UgbmVlZGxlKSBpbnRlcm5hbCByZXR1cm5zIChzbGljZSkgewogICAgICAgIHVpbnQgcHRyID0gcmZpbmRQdHIoc2VsZi5fbGVuLCBzZWxmLl9wdHIsIG5lZWRsZS5fbGVuLCBuZWVkbGUuX3B0cik7CiAgICAgICAgc2VsZi5fbGVuID0gcHRyIC0gc2VsZi5fcHRyOwogICAgICAgIHJldHVybiBzZWxmOwogICAgfQoKICAgIC8qCiAgICAgKiBAZGV2IFNwbGl0cyB0aGUgc2xpY2UsIHNldHRpbmcgYHNlbGZgIHRvIGV2ZXJ5dGhpbmcgYWZ0ZXIgdGhlIGZpcnN0CiAgICAgKiAgICAgIG9jY3VycmVuY2Ugb2YgYG5lZWRsZWAsIGFuZCBgdG9rZW5gIHRvIGV2ZXJ5dGhpbmcgYmVmb3JlIGl0LiBJZgogICAgICogICAgICBgbmVlZGxlYCBkb2VzIG5vdCBvY2N1ciBpbiBgc2VsZmAsIGBzZWxmYCBpcyBzZXQgdG8gdGhlIGVtcHR5IHNsaWNlLAogICAgICogICAgICBhbmQgYHRva2VuYCBpcyBzZXQgdG8gdGhlIGVudGlyZXR5IG9mIGBzZWxmYC4KICAgICAqIEBwYXJhbSBzZWxmIFRoZSBzbGljZSB0byBzcGxpdC4KICAgICAqIEBwYXJhbSBuZWVkbGUgVGhlIHRleHQgdG8gc2VhcmNoIGZvciBpbiBgc2VsZmAuCiAgICAgKiBAcGFyYW0gdG9rZW4gQW4gb3V0cHV0IHBhcmFtZXRlciB0byB3aGljaCB0aGUgZmlyc3QgdG9rZW4gaXMgd3JpdHRlbi4KICAgICAqIEByZXR1cm4gYHRva2VuYC4KICAgICAqLwogICAgZnVuY3Rpb24gc3BsaXQoc2xpY2Ugc2VsZiwgc2xpY2UgbmVlZGxlLCBzbGljZSB0b2tlbikgaW50ZXJuYWwgcmV0dXJucyAoc2xpY2UpIHsKICAgICAgICB1aW50IHB0ciA9IGZpbmRQdHIoc2VsZi5fbGVuLCBzZWxmLl9wdHIsIG5lZWRsZS5fbGVuLCBuZWVkbGUuX3B0cik7CiAgICAgICAgdG9rZW4uX3B0ciA9IHNlbGYuX3B0cjsKICAgICAgICB0b2tlbi5fbGVuID0gcHRyIC0gc2VsZi5fcHRyOwogICAgICAgIGlmIChwdHIgPT0gc2VsZi5fcHRyICsgc2VsZi5fbGVuKSB7CiAgICAgICAgICAgIC8vIE5vdCBmb3VuZAogICAgICAgICAgICBzZWxmLl9sZW4gPSAwOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNlbGYuX2xlbiAtPSB0b2tlbi5fbGVuICsgbmVlZGxlLl9sZW47CiAgICAgICAgICAgIHNlbGYuX3B0ciA9IHB0ciArIG5lZWRsZS5fbGVuOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdG9rZW47CiAgICB9CgogICAgLyoKICAgICAqIEBkZXYgU3BsaXRzIHRoZSBzbGljZSwgc2V0dGluZyBgc2VsZmAgdG8gZXZlcnl0aGluZyBhZnRlciB0aGUgZmlyc3QKICAgICAqICAgICAgb2NjdXJyZW5jZSBvZiBgbmVlZGxlYCwgYW5kIHJldHVybmluZyBldmVyeXRoaW5nIGJlZm9yZSBpdC4gSWYKICAgICAqICAgICAgYG5lZWRsZWAgZG9lcyBub3Qgb2NjdXIgaW4gYHNlbGZgLCBgc2VsZmAgaXMgc2V0IHRvIHRoZSBlbXB0eSBzbGljZSwKICAgICAqICAgICAgYW5kIHRoZSBlbnRpcmV0eSBvZiBgc2VsZmAgaXMgcmV0dXJuZWQuCiAgICAgKiBAcGFyYW0gc2VsZiBUaGUgc2xpY2UgdG8gc3BsaXQuCiAgICAgKiBAcGFyYW0gbmVlZGxlIFRoZSB0ZXh0IHRvIHNlYXJjaCBmb3IgaW4gYHNlbGZgLgogICAgICogQHJldHVybiBUaGUgcGFydCBvZiBgc2VsZmAgdXAgdG8gdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgYGRlbGltYC4KICAgICAqLwogICAgZnVuY3Rpb24gc3BsaXQoc2xpY2Ugc2VsZiwgc2xpY2UgbmVlZGxlKSBpbnRlcm5hbCByZXR1cm5zIChzbGljZSB0b2tlbikgewogICAgICAgIHNwbGl0KHNlbGYsIG5lZWRsZSwgdG9rZW4pOwogICAgfQoKICAgIC8qCiAgICAgKiBAZGV2IFNwbGl0cyB0aGUgc2xpY2UsIHNldHRpbmcgYHNlbGZgIHRvIGV2ZXJ5dGhpbmcgYmVmb3JlIHRoZSBsYXN0CiAgICAgKiAgICAgIG9jY3VycmVuY2Ugb2YgYG5lZWRsZWAsIGFuZCBgdG9rZW5gIHRvIGV2ZXJ5dGhpbmcgYWZ0ZXIgaXQuIElmCiAgICAgKiAgICAgIGBuZWVkbGVgIGRvZXMgbm90IG9jY3VyIGluIGBzZWxmYCwgYHNlbGZgIGlzIHNldCB0byB0aGUgZW1wdHkgc2xpY2UsCiAgICAgKiAgICAgIGFuZCBgdG9rZW5gIGlzIHNldCB0byB0aGUgZW50aXJldHkgb2YgYHNlbGZgLgogICAgICogQHBhcmFtIHNlbGYgVGhlIHNsaWNlIHRvIHNwbGl0LgogICAgICogQHBhcmFtIG5lZWRsZSBUaGUgdGV4dCB0byBzZWFyY2ggZm9yIGluIGBzZWxmYC4KICAgICAqIEBwYXJhbSB0b2tlbiBBbiBvdXRwdXQgcGFyYW1ldGVyIHRvIHdoaWNoIHRoZSBmaXJzdCB0b2tlbiBpcyB3cml0dGVuLgogICAgICogQHJldHVybiBgdG9rZW5gLgogICAgICovCiAgICBmdW5jdGlvbiByc3BsaXQoc2xpY2Ugc2VsZiwgc2xpY2UgbmVlZGxlLCBzbGljZSB0b2tlbikgaW50ZXJuYWwgcmV0dXJucyAoc2xpY2UpIHsKICAgICAgICB1aW50IHB0ciA9IHJmaW5kUHRyKHNlbGYuX2xlbiwgc2VsZi5fcHRyLCBuZWVkbGUuX2xlbiwgbmVlZGxlLl9wdHIpOwogICAgICAgIHRva2VuLl9wdHIgPSBwdHI7CiAgICAgICAgdG9rZW4uX2xlbiA9IHNlbGYuX2xlbiAtIChwdHIgLSBzZWxmLl9wdHIpOwogICAgICAgIGlmIChwdHIgPT0gc2VsZi5fcHRyKSB7CiAgICAgICAgICAgIC8vIE5vdCBmb3VuZAogICAgICAgICAgICBzZWxmLl9sZW4gPSAwOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNlbGYuX2xlbiAtPSB0b2tlbi5fbGVuICsgbmVlZGxlLl9sZW47CiAgICAgICAgfQogICAgICAgIHJldHVybiB0b2tlbjsKICAgIH0KCiAgICAvKgogICAgICogQGRldiBTcGxpdHMgdGhlIHNsaWNlLCBzZXR0aW5nIGBzZWxmYCB0byBldmVyeXRoaW5nIGJlZm9yZSB0aGUgbGFzdAogICAgICogICAgICBvY2N1cnJlbmNlIG9mIGBuZWVkbGVgLCBhbmQgcmV0dXJuaW5nIGV2ZXJ5dGhpbmcgYWZ0ZXIgaXQuIElmCiAgICAgKiAgICAgIGBuZWVkbGVgIGRvZXMgbm90IG9jY3VyIGluIGBzZWxmYCwgYHNlbGZgIGlzIHNldCB0byB0aGUgZW1wdHkgc2xpY2UsCiAgICAgKiAgICAgIGFuZCB0aGUgZW50aXJldHkgb2YgYHNlbGZgIGlzIHJldHVybmVkLgogICAgICogQHBhcmFtIHNlbGYgVGhlIHNsaWNlIHRvIHNwbGl0LgogICAgICogQHBhcmFtIG5lZWRsZSBUaGUgdGV4dCB0byBzZWFyY2ggZm9yIGluIGBzZWxmYC4KICAgICAqIEByZXR1cm4gVGhlIHBhcnQgb2YgYHNlbGZgIGFmdGVyIHRoZSBsYXN0IG9jY3VycmVuY2Ugb2YgYGRlbGltYC4KICAgICAqLwogICAgZnVuY3Rpb24gcnNwbGl0KHNsaWNlIHNlbGYsIHNsaWNlIG5lZWRsZSkgaW50ZXJuYWwgcmV0dXJucyAoc2xpY2UgdG9rZW4pIHsKICAgICAgICByc3BsaXQoc2VsZiwgbmVlZGxlLCB0b2tlbik7CiAgICB9CgogICAgLyoKICAgICAqIEBkZXYgQ291bnRzIHRoZSBudW1iZXIgb2Ygbm9ub3ZlcmxhcHBpbmcgb2NjdXJyZW5jZXMgb2YgYG5lZWRsZWAgaW4gYHNlbGZgLgogICAgICogQHBhcmFtIHNlbGYgVGhlIHNsaWNlIHRvIHNlYXJjaC4KICAgICAqIEBwYXJhbSBuZWVkbGUgVGhlIHRleHQgdG8gc2VhcmNoIGZvciBpbiBgc2VsZmAuCiAgICAgKiBAcmV0dXJuIFRoZSBudW1iZXIgb2Ygb2NjdXJyZW5jZXMgb2YgYG5lZWRsZWAgZm91bmQgaW4gYHNlbGZgLgogICAgICovCiAgICBmdW5jdGlvbiBjb3VudChzbGljZSBzZWxmLCBzbGljZSBuZWVkbGUpIGludGVybmFsIHJldHVybnMgKHVpbnQgY291bnQpIHsKICAgICAgICB1aW50IHB0ciA9IGZpbmRQdHIoc2VsZi5fbGVuLCBzZWxmLl9wdHIsIG5lZWRsZS5fbGVuLCBuZWVkbGUuX3B0cikgKyBuZWVkbGUuX2xlbjsKICAgICAgICB3aGlsZSAocHRyIDw9IHNlbGYuX3B0ciArIHNlbGYuX2xlbikgewogICAgICAgICAgICBjb3VudCsrOwogICAgICAgICAgICBwdHIgPSBmaW5kUHRyKHNlbGYuX2xlbiAtIChwdHIgLSBzZWxmLl9wdHIpLCBwdHIsIG5lZWRsZS5fbGVuLCBuZWVkbGUuX3B0cikgKyBuZWVkbGUuX2xlbjsKICAgICAgICB9CiAgICB9CgogICAgLyoKICAgICAqIEBkZXYgUmV0dXJucyBUcnVlIGlmIGBzZWxmYCBjb250YWlucyBgbmVlZGxlYC4KICAgICAqIEBwYXJhbSBzZWxmIFRoZSBzbGljZSB0byBzZWFyY2guCiAgICAgKiBAcGFyYW0gbmVlZGxlIFRoZSB0ZXh0IHRvIHNlYXJjaCBmb3IgaW4gYHNlbGZgLgogICAgICogQHJldHVybiBUcnVlIGlmIGBuZWVkbGVgIGlzIGZvdW5kIGluIGBzZWxmYCwgZmFsc2Ugb3RoZXJ3aXNlLgogICAgICovCiAgICBmdW5jdGlvbiBjb250YWlucyhzbGljZSBzZWxmLCBzbGljZSBuZWVkbGUpIGludGVybmFsIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gcmZpbmRQdHIoc2VsZi5fbGVuLCBzZWxmLl9wdHIsIG5lZWRsZS5fbGVuLCBuZWVkbGUuX3B0cikgIT0gc2VsZi5fcHRyOwogICAgfQoKICAgIC8qCiAgICAgKiBAZGV2IFJldHVybnMgYSBuZXdseSBhbGxvY2F0ZWQgc3RyaW5nIGNvbnRhaW5pbmcgdGhlIGNvbmNhdGVuYXRpb24gb2YKICAgICAqICAgICAgYHNlbGZgIGFuZCBgb3RoZXJgLgogICAgICogQHBhcmFtIHNlbGYgVGhlIGZpcnN0IHNsaWNlIHRvIGNvbmNhdGVuYXRlLgogICAgICogQHBhcmFtIG90aGVyIFRoZSBzZWNvbmQgc2xpY2UgdG8gY29uY2F0ZW5hdGUuCiAgICAgKiBAcmV0dXJuIFRoZSBjb25jYXRlbmF0aW9uIG9mIHRoZSB0d28gc3RyaW5ncy4KICAgICAqLwogICAgZnVuY3Rpb24gY29uY2F0KHNsaWNlIHNlbGYsIHNsaWNlIG90aGVyKSBpbnRlcm5hbCByZXR1cm5zIChzdHJpbmcpIHsKICAgICAgICB2YXIgcmV0ID0gbmV3IHN0cmluZyhzZWxmLl9sZW4gKyBvdGhlci5fbGVuKTsKICAgICAgICB1aW50IHJldHB0cjsKICAgICAgICBhc3NlbWJseSB7IHJldHB0ciA6PSBhZGQocmV0LCAzMikgfQogICAgICAgIG1lbWNweShyZXRwdHIsIHNlbGYuX3B0ciwgc2VsZi5fbGVuKTsKICAgICAgICBtZW1jcHkocmV0cHRyICsgc2VsZi5fbGVuLCBvdGhlci5fcHRyLCBvdGhlci5fbGVuKTsKICAgICAgICByZXR1cm4gcmV0OwogICAgfQoKICAgIC8qCiAgICAgKiBAZGV2IEpvaW5zIGFuIGFycmF5IG9mIHNsaWNlcywgdXNpbmcgYHNlbGZgIGFzIGEgZGVsaW1pdGVyLCByZXR1cm5pbmcgYQogICAgICogICAgICBuZXdseSBhbGxvY2F0ZWQgc3RyaW5nLgogICAgICogQHBhcmFtIHNlbGYgVGhlIGRlbGltaXRlciB0byB1c2UuCiAgICAgKiBAcGFyYW0gcGFydHMgQSBsaXN0IG9mIHNsaWNlcyB0byBqb2luLgogICAgICogQHJldHVybiBBIG5ld2x5IGFsbG9jYXRlZCBzdHJpbmcgY29udGFpbmluZyBhbGwgdGhlIHNsaWNlcyBpbiBgcGFydHNgLAogICAgICogICAgICAgICBqb2luZWQgd2l0aCBgc2VsZmAuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGpvaW4oc2xpY2Ugc2VsZiwgc2xpY2VbXSBwYXJ0cykgaW50ZXJuYWwgcmV0dXJucyAoc3RyaW5nKSB7CiAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PSAwKQogICAgICAgICAgICByZXR1cm4gIiI7CgogICAgICAgIHVpbnQgbGVuID0gc2VsZi5fbGVuICogKHBhcnRzLmxlbmd0aCAtIDEpOwogICAgICAgIGZvcih1aW50IGkgPSAwOyBpIDwgcGFydHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGxlbiArPSBwYXJ0c1tpXS5fbGVuOwoKICAgICAgICB2YXIgcmV0ID0gbmV3IHN0cmluZyhsZW4pOwogICAgICAgIHVpbnQgcmV0cHRyOwogICAgICAgIGFzc2VtYmx5IHsgcmV0cHRyIDo9IGFkZChyZXQsIDMyKSB9CgogICAgICAgIGZvcihpID0gMDsgaSA8IHBhcnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIG1lbWNweShyZXRwdHIsIHBhcnRzW2ldLl9wdHIsIHBhcnRzW2ldLl9sZW4pOwogICAgICAgICAgICByZXRwdHIgKz0gcGFydHNbaV0uX2xlbjsKICAgICAgICAgICAgaWYgKGkgPCBwYXJ0cy5sZW5ndGggLSAxKSB7CiAgICAgICAgICAgICAgICBtZW1jcHkocmV0cHRyLCBzZWxmLl9wdHIsIHNlbGYuX2xlbik7CiAgICAgICAgICAgICAgICByZXRwdHIgKz0gc2VsZi5fbGVuOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmV0OwogICAgfQp9CgpsaWJyYXJ5IENvbnZlcnRTdHJpbmdCeXRlIHsKICBmdW5jdGlvbiBieXRlczMyVG9TdHJpbmcoYnl0ZXMzMiB4KSBjb25zdGFudCByZXR1cm5zIChzdHJpbmcpIHsKICAgIGJ5dGVzIG1lbW9yeSBieXRlc1N0cmluZyA9IG5ldyBieXRlcygzMik7CiAgICB1aW50IGNoYXJDb3VudCA9IDA7CiAgICBmb3IgKHVpbnQgaiA9IDA7IGogPCAzMjsgaisrKSB7CiAgICAgIGJ5dGUgY2hhciA9IGJ5dGUoYnl0ZXMzMih1aW50KHgpICogMiAqKiAoOCAqIGopKSk7CiAgICAgIGlmIChjaGFyICE9IDApIHsKICAgICAgICAgIGJ5dGVzU3RyaW5nW2NoYXJDb3VudF0gPSBjaGFyOwogICAgICAgICAgY2hhckNvdW50Kys7CiAgICAgIH0KICAgIH0KICAgIGJ5dGVzIG1lbW9yeSBieXRlc1N0cmluZ1RyaW1tZWQgPSBuZXcgYnl0ZXMoY2hhckNvdW50KTsKICAgIGZvciAoaiA9IDA7IGogPCBjaGFyQ291bnQ7IGorKykgewogICAgICBieXRlc1N0cmluZ1RyaW1tZWRbal0gPSBieXRlc1N0cmluZ1tqXTsKICAgIH0KICAgIHJldHVybiBzdHJpbmcoYnl0ZXNTdHJpbmdUcmltbWVkKTsKICB9CgogIGZ1bmN0aW9uIHN0cmluZ1RvQnl0ZXMzMihzdHJpbmcgbWVtb3J5IHNvdXJjZSkgcmV0dXJucyAoYnl0ZXMzMiByZXN1bHQpIHsKICAgIGFzc2VtYmx5IHsKICAgICAgcmVzdWx0IDo9IG1sb2FkKGFkZChzb3VyY2UsIDMyKSkKICAgIH0KICB9Cn0KCgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgewogICAgaWYgKG5ld093bmVyICE9IGFkZHJlc3MoMCkpIHsKICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgIH0KICB9Cgp9CgoKY29udHJhY3QgUGxhdGludW0gaXMgT3duYWJsZSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CiAgdXNpbmcgU3RyaW5ncyBmb3IgKjsKCiAgLy8gPT09PT09PT09IOWuo+WRiiA9PT09PT09PT0KICBzdHJpbmcgcHVibGljIHZlcnNpb24gPSAiMC4wLjEiOwogIC8vIOWfuuacrOWWruS9jQogIHN0cmluZyBwdWJsaWMgdW5pdCA9ICJveiI7CiAgLy8g57i95L6b57Wm6YePCiAgdWludDI1NiBwdWJsaWMgdG90YWw7CiAgLy8g5a2Y6LKoCiAgc3RydWN0IEJ1bGxpb24gewogICAgc3RyaW5nIGluZGV4OwogICAgc3RyaW5nIHVuaXQ7CiAgICB1aW50MjU2IGFtb3VudDsKICAgIHN0cmluZyBpcGZzOwogIH0KICBieXRlczMyW10gcHVibGljIHN0b3JlaG91c2VJbmRleDsKICBtYXBwaW5nIChieXRlczMyID0+IEJ1bGxpb24pIHB1YmxpYyBzdG9yZWhvdXNlOwogIC8vIOaOm+WLvuiyqOW5owogIGFkZHJlc3MgcHVibGljIHRva2VuOwogIC8vIOWMr+eOhyAx55m96YeR77ya55m96YeR5bmjCiAgdWludDI1NiBwdWJsaWMgcmF0ZSA9IDEwOwogIC8vIFBsYXRpbnVtVG9rZW4g5a+m5L6LCiAgUGxhdGludW1Ub2tlbiBjb2luOwoKCgoKCiAgLy8gPT09PT09PT09IOWIneWni+WMliA9PT09PT09PT0KICBmdW5jdGlvbiBQbGF0aW51bSgpIHsKCiAgfQoKCgoKICAvLyA9PT09PT09PT0gZXZlbnQgPT09PT09PT09CiAgZXZlbnQgU3RvY2sgKAogICAgc3RyaW5nIGluZGV4LAogICAgc3RyaW5nIHVuaXQsCiAgICB1aW50MjU2IGFtb3VudCwKICAgIHN0cmluZyBpcGZzLAogICAgdWludDI1NiB0b3RhbAogICk7CgogIGV2ZW50IFNoaXAgKAogICAgc3RyaW5nIGluZGV4LAogICAgdWludDI1NiB0b3RhbAogICk7CgogIGV2ZW50IE1pbnQgKAogICAgdWludDI1NiBhbW91bnQsCiAgICB1aW50MjU2IHRvdGFsCiAgKTsKCiAgZXZlbnQgQWxjaGVteSAoCiAgICB1aW50MjU2IGFtb3VudCwKICAgIHVpbnQyNTYgdG90YWwKICApOwoKICBldmVudCBCdXkgKAogICAgc3RyaW5nIGluZGV4LAogICAgYWRkcmVzcyBmcm9tLAogICAgdWludDI1NiBmZWUsCiAgICB1aW50MjU2IHByaWNlCiAgKTsKCgoKCgoKICAvLyA9PT09PT09PT0g5pOB5pyJ6ICF5pa55rOVID09PT09PT09PQoKICAvKioKICAgKiDmk43kvZzlrZjosqgt6YCy6LKoCiAgICoKICAgKiDmraTmlrnms5Xln7fooYzvvJoKICAgKiAgLSDntIDpjITmlrDlop7nmoTnmb3ph5HvvIzntIDpjITos4foqIrvvJoKICAgKiAgICAtIGluZGV4OiDnmb3ph5Hnt6jomZ8KICAgKiAgICAtIHVuaXQ6IOeZvemHkeWWruS9jQogICAqICAgIC0gYW1vdW50OiDmlbjph48KICAgKiAgICAtIGlwZnM6IOeZvemHkeitieaYjlVSTAogICAqICAtIOWinuWKoOeZvemHkee4veW6q+WtmOaVuOmHj++8jOmHj+eCumFtb3VudAogICAqCiAgICogUmVxdWlyZXM6CiAgICogIC0g5Z+36KGM6ICF6aCI54K6b3duZXIKICAgKiAgLSDnmb3ph5Hnt6jomZ9pbmRleOS4jeiDvemHjeikhwogICAqICAtIOWWruS9jemgiOetieaWvOebruWJjeWQiOe0hOaJgOioreWumueahOWWruS9jQogICAqICAtIOmHj2Ftb3VudOmcgOWkp+aWvDAKICAgKgogICAqIFJldHVybnM6CiAgICogIC0gYm9vbDog5Z+36KGM5oiQ5Yqf5pmC77yM5Zue5YKzdHJ1ZQogICAqCiAgICogRXZlbnRzOgogICAqICAtIFN0b2NrOiDln7fooYzmiJDlip/mmYLop7jnmbwKICAgKi8KICBmdW5jdGlvbiBzdG9jayhzdHJpbmcgX2luZGV4LCBzdHJpbmcgX3VuaXQsIHVpbnQyNTYgX2Ftb3VudCwgc3RyaW5nIF9pcGZzKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgYnl0ZXMzMiBfYmluZGV4ID0gQ29udmVydFN0cmluZ0J5dGUuc3RyaW5nVG9CeXRlczMyKF9pbmRleCk7CgogICAgcmVxdWlyZShfYW1vdW50ID4gMCk7CiAgICByZXF1aXJlKF91bml0LnRvU2xpY2UoKS5lcXVhbHModW5pdC50b1NsaWNlKCkpKTsKICAgIHJlcXVpcmUoIShzdG9yZWhvdXNlW19iaW5kZXhdLmFtb3VudCA+IDApKTsKCiAgICBCdWxsaW9uIGJ1bGxpb24gPSBzdG9yZWhvdXNlW19iaW5kZXhdOwogICAgYnVsbGlvbi5pbmRleCA9IF9pbmRleDsKICAgIGJ1bGxpb24udW5pdCA9IF91bml0OwogICAgYnVsbGlvbi5hbW91bnQgPSBfYW1vdW50OwogICAgYnVsbGlvbi5pcGZzID0gX2lwZnM7CgogICAgLy8g5Yqg5YWl5YCJ5YSy55uu6YyECiAgICBzdG9yZWhvdXNlSW5kZXgucHVzaChfYmluZGV4KTsKICAgIC8vIOWKoOWFpeWAieWEsgogICAgc3RvcmVob3VzZVtfYmluZGV4XSA9IGJ1bGxpb247CgogICAgLy8g5aKe5Yqg57i95bqr5a2YCiAgICB0b3RhbCA9IHRvdGFsLmFkZChfYW1vdW50KTsKCiAgICBTdG9jayhidWxsaW9uLmluZGV4LCBidWxsaW9uLnVuaXQsIGJ1bGxpb24uYW1vdW50LCBidWxsaW9uLmlwZnMsIHRvdGFsKTsKCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIOaTjeS9nOWtmOiyqC3lh7rosqgKICAgKgogICAqIOatpOaWueazleWft+ihjO+8mgogICAqICAtIOenu+mZpOeZvemHkeW6q+WtmAogICAqICAtIOa4m+WwkeeZvemHkee4veW6q+WtmOmHj++8jOmHj+eCuueZvemHkeW6q+WtmOeahOaVuOmHjwogICAqCiAgICogUmVxdWlyZXM6CiAgICogIC0g5Z+36KGM6ICF54K6b3duZXIKICAgKiAgLSDnmb3ph5Hnt6jomZ9pbmRleOmcgOWtmOWcqOaWvOe0gOmMhO+8iOW3suS9v+eUqHN0b2Nr5pa55rOV5paw5aKe6Kmy5bqr5a2Y77yJCiAgICogIC0g55m96YeR57i95bqr5a2Y6ZyA6Laz5aSg77yM5aSn5pa85oyH5a6a55m96YeR5bqr5a2Y55qE5pW46YePCiAgICoKICAgKiBSZXR1cm5zOgogICAqICAtIGJvb2w6IOWft+ihjOaIkOWKn+aZgu+8jOWbnuWCs3RydWUKICAgKgogICAqIEV2ZW50czoKICAgKiAgLSBTaGlwOiDln7fooYzmiJDlip/mmYLop7jnmbwKICAgKi8KICBmdW5jdGlvbiBzaGlwKHN0cmluZyBfaW5kZXgpIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICBieXRlczMyIF9iaW5kZXggPSBDb252ZXJ0U3RyaW5nQnl0ZS5zdHJpbmdUb0J5dGVzMzIoX2luZGV4KTsKCiAgICByZXF1aXJlKHN0b3JlaG91c2VbX2JpbmRleF0uYW1vdW50ID4gMCk7CiAgICBCdWxsaW9uIGJ1bGxpb24gPSBzdG9yZWhvdXNlW19iaW5kZXhdOwogICAgcmVxdWlyZSh0b3RhbC5zdWIoYnVsbGlvbi5hbW91bnQpID49IDApOwoKICAgIHVpbnQyNTYgdG1wQW1vdW50ID0gYnVsbGlvbi5hbW91bnQ7CgogICAgZm9yICh1aW50MjU2IGluZGV4ID0gMDsgaW5kZXggPCBzdG9yZWhvdXNlSW5kZXgubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgIEJ1bGxpb24gX2J1bGxpb24gPSBzdG9yZWhvdXNlW3N0b3JlaG91c2VJbmRleFtpbmRleF1dOwogICAgICBpZiAoX2J1bGxpb24uaW5kZXgudG9TbGljZSgpLmVxdWFscyhfaW5kZXgudG9TbGljZSgpKSkgewogICAgICAgIC8vIOW+nuWAieWEsuebrumMhOenu+mZpAogICAgICAgIGRlbGV0ZSBzdG9yZWhvdXNlSW5kZXhbaW5kZXhdOwogICAgICB9CiAgICB9CiAgICAvLyDlvp7lgInlhLLnp7vpmaQKICAgIGRlbGV0ZSBzdG9yZWhvdXNlW19iaW5kZXhdOwogICAgLy8g5rib5bCR57i95bqr5a2YCiAgICB0b3RhbCA9IHRvdGFsLnN1Yih0bXBBbW91bnQpOwoKICAgIFNoaXAoYnVsbGlvbi5pbmRleCwgdG90YWwpOwoKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICog6ZGE5bmjCiAgICoKICAgKiDmraTmlrnms5Xln7fooYzvvJoKICAgKiAgLSDlop7liqDnmb3ph5Hku6PluaPmlbjph48KICAgKiAgLSDmuJvlsJHnuL3nmb3ph5HluqvlrZgKICAgKgogICAqIFJlcXVpcmVzOgogICAqICAtIOWft+ihjOiAheeCum93bmVyCiAgICogIC0g55m96YeR57i95bqr5a2Y6ZyA6Laz5aSg77yM5Y2z5aSn5pa8562J5pa8cHRBbW91bnQKICAgKiAgLSDnmb3ph5Hku6PluaPlkIjntITpnIDlt7LoqK3lrprvvIhzZXRUb2tlbkFkZHJlc3Pmlrnms5XvvIkKICAgKgogICAqIFJldHVybnM6CiAgICogIC0gYm9vbDog5Z+36KGM5oiQ5Yqf5pmC77yM5Zue5YKzdHJ1ZQogICAqCiAgICogRXZlbnRzOgogICAqICAtIE1pbnQ6IOWft+ihjOaIkOWKn+aZguinuOeZvAogICAqLwogIGZ1bmN0aW9uIG1pbnQodWludDI1NiBfcHRBbW91bnQpIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKHRva2VuICE9IDB4MCk7CgogICAgdWludDI1NiBhbW91bnQgPSBjb252ZXJ0MlBsYXRpbnVtVG9rZW4oX3B0QW1vdW50KTsKICAgIC8vIOeZvOmAgXRva2Vu55qE5aKe5Yqg5ra15byPCiAgICBib29sIHByb2R1Y2VkID0gY29pbi5wcm9kdWNlKGFtb3VudCk7CiAgICByZXF1aXJlKHByb2R1Y2VkKTsKCiAgICB0b3RhbCA9IHRvdGFsLnN1YihfcHRBbW91bnQpOwoKICAgIE1pbnQoX3B0QW1vdW50LCB0b3RhbCk7CgogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiDnhYnph5EKICAgKgogICAqIOatpOaWueazleWft+ihjO+8mgogICAqICAtIOa4m+WwkeeZvemHkeS7o+W5owogICAqICAtIOWinuWKoOe4veeZvemHkeW6q+WtmAogICAqCiAgICogUmVxdWlyZXM6CiAgICogIC0g5Z+36KGM6ICF54K6b3duZXIKICAgKiAgLSDpnIDlt7LoqK3lrprnmb3ph5Hku6PluaPlkIjntITvvIhzZXRUb2tlbkFkZHJlc3Pmlrnms5XvvIkKICAgKiAgLSDnmb3ph5Hku6PluaNvd25lcuaJgOaTgeacieeahOS7o+W5o+i2s+WkoO+8jOWNs3Rva2VuQW1vdW505bCP5pa8562J5pa85Luj5bmjb3duZXLnmoTnmb3ph5Hku6PluaPmlbjph48KICAgKgogICAqIFJldHVybnM6CiAgICogIC0gYm9vbDog5Z+36KGM5oiQ5Yqf77yM5Zue5YKzdHJ1ZQogICAqCiAgICogRXZlbnRzOgogICAqICAtIEFsY2hlbXk6IOWft+ihjOaIkOWKn+aZguinuOeZvAogICAqLwogIGZ1bmN0aW9uIGFsY2hlbXkodWludDI1NiBfdG9rZW5BbW91bnQpIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKHRva2VuICE9IDB4MCk7CgogICAgdWludDI1NiBhbW91bnQgPSBjb252ZXJ0MlBsYXRpbnVtKF90b2tlbkFtb3VudCk7CiAgICBib29sIHJlZHVjZWQgPSBjb2luLnJlZHVjZShfdG9rZW5BbW91bnQpOwogICAgcmVxdWlyZShyZWR1Y2VkKTsKCiAgICB0b3RhbCA9IHRvdGFsLmFkZChhbW91bnQpOwoKICAgIEFsY2hlbXkoYW1vdW50LCB0b3RhbCk7CgogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiDoqK3lrpot5Yyv546HCiAgICoKICAgKiDljK/njofopo/liYc6CiAgICogIC0g55m96YeR5pW46YePICog5Yyv546HID0g55m96YeR5Luj5bmj5pW46YePCiAgICogIC0g55m96YeR5Luj5bmj5pW46YePIC8g5Yyv546HID0g55m96YeR5pW46YePCiAgICoKICAgKiBSZXF1aXJlczoKICAgKiAgLSDln7fooYzogIXngrpvd25lcgogICAqICAtIOWMr+eOh3JhdGXpnIDlpKfmlrwwCiAgICoKICAgKiBSZXR1cm5zOgogICAqICAtIGJvb2w6IOWft+ihjOaIkOWKn++8jOWbnuWCs3RydWUKICAgKi8KICBmdW5jdGlvbiBzZXRSYXRlKHVpbnQyNTYgX3JhdGUpIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF9yYXRlID4gMCk7CgogICAgcmF0ZSA9IF9yYXRlOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiDoqK3lrpotVG9rZW7lnLDlnYAKICAgKgogICAqIOioreWumueZvemHkeWQiOe0hOWcsOWdgAogICAqCiAgICogUmVxdWlyZXM6CiAgICogIC0g5Z+36KGM6ICF54K6b3duZXIKICAgKiAgLSDlkIjntITlnLDlnYBhZGRyZXNz5LiN54K6MAogICAqCiAgICogUmV0dXJuczoKICAgKiAgLSBib29sOiDln7fooYzmiJDlip/vvIzlm57lgrN0cnVlCiAgICovCiAgZnVuY3Rpb24gc2V0VG9rZW5BZGRyZXNzKGFkZHJlc3MgX2FkZHJlc3MpIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF9hZGRyZXNzICE9IDB4MCk7CgogICAgY29pbiA9IFBsYXRpbnVtVG9rZW4oX2FkZHJlc3MpOwogICAgdG9rZW4gPSBfYWRkcmVzczsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICog6LO86LK36YeR5qKdCiAgICoKICAgKiDmraTmlrnms5Xln7fooYzvvJoKICAgKiAgLSDmiaPpmaRidXllcueahOeZvemHkeS7o+W5owogICAqICAtIOenu+mZpOeZvemHkeW6q+WtmO+8jOS7o+ihqGJ1eWVy5bey5b6e5bqr5a2Y6LK36LWw55m96YeRCiAgICoKICAgKiBSZXF1aXJlczoKICAgKiAgLSDln7fooYzogIXngrpvd25lcgogICAqICAtIOeZvemHkee3qOiZn2luZGV46ZyA5a2Y5Zyo5pa857SA6YyE77yI5bey5L2/55Soc3RvY2vmlrnms5XmlrDlop7oqbLluqvlrZjvvIkKICAgKgogICAqIFJldHVybnM6CiAgICogIC0gYm9vbDog5Z+36KGM5oiQ5Yqf77yM5Zue5YKzdHJ1ZQogICAqCiAgICogRXZlbnRzOgogICAqICAtIEJ1eTog5Z+36KGM5oiQ5Yqf5pmC6Ke455m8CiAgICovCiAgZnVuY3Rpb24gYnV5KHN0cmluZyBfaW5kZXgsIGFkZHJlc3MgYnV5ZXIpIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKHRva2VuICE9IDB4MCk7CiAgICBieXRlczMyIF9iaW5kZXggPSBDb252ZXJ0U3RyaW5nQnl0ZS5zdHJpbmdUb0J5dGVzMzIoX2luZGV4KTsKICAgIHVpbnQyNTYgZmVlID0gY29pbi5mZWUoKTsKICAgIHJlcXVpcmUoc3RvcmVob3VzZVtfYmluZGV4XS5hbW91bnQgPiAwKTsKCiAgICBCdWxsaW9uIGJ1bGxpb24gPSBzdG9yZWhvdXNlW19iaW5kZXhdOwogICAgdWludDI1NiB0b2tlblByaWNlID0gY29udmVydDJQbGF0aW51bVRva2VuKGJ1bGxpb24uYW1vdW50KTsKICAgIHVpbnQyNTYgdG9rZW5QcmljZUZlZSA9IHRva2VuUHJpY2UuYWRkKGZlZSk7CgogICAgLy8g6L2J5bizCiAgICBib29sIHRyYW5zZmVyZWQgPSBjb2luLnRyYW5zZmVyRnJvbShidXllciwgY29pbi5vd25lcigpLCB0b2tlblByaWNlRmVlKTsKICAgIHJlcXVpcmUodHJhbnNmZXJlZCk7CgogICAgLy8g55u05o6l5oqK5Ymb5Ymb6LOj5Ye655qE5YO55qC854WJ6YeRCiAgICBib29sIHJlZHVjZWQgPSBjb2luLnJlZHVjZSh0b2tlblByaWNlKTsKICAgIHJlcXVpcmUocmVkdWNlZCk7CgogICAgLy8g5rib5bCR5bqr5a2YCiAgICBmb3IgKHVpbnQyNTYgaW5kZXggPSAwOyBpbmRleCA8IHN0b3JlaG91c2VJbmRleC5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgQnVsbGlvbiBfYnVsbGlvbiA9IHN0b3JlaG91c2Vbc3RvcmVob3VzZUluZGV4W2luZGV4XV07CiAgICAgIGlmIChfYnVsbGlvbi5pbmRleC50b1NsaWNlKCkuZXF1YWxzKF9pbmRleC50b1NsaWNlKCkpKSB7CiAgICAgICAgLy8g5b6e5YCJ5YSy55uu6YyE56e76ZmkCiAgICAgICAgZGVsZXRlIHN0b3JlaG91c2VJbmRleFtpbmRleF07CiAgICAgIH0KICAgIH0KICAgIC8vIOW+nuWAieWEsuenu+mZpAogICAgZGVsZXRlIHN0b3JlaG91c2VbX2JpbmRleF07CgogICAgQnV5KF9pbmRleCwgYnV5ZXIsIGZlZSwgdG9rZW5QcmljZSk7CgogICAgcmV0dXJuIHRydWU7CiAgfQoKCgoKCiAgLy8gPT09PT09PT09IOWFrOWFseaWueazlSA9PT09PT09PT0KCiAgLy8g5q+U546H6L2J5o+bLeeZvemHkeW5o+aPm+eZvemHkQogIGZ1bmN0aW9uIGNvbnZlcnQyUGxhdGludW0odWludDI1NiBfYW1vdW50KSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gX2Ftb3VudC5kaXYocmF0ZSk7CiAgfQoKICAvLyDmr5TnjofovYnmj5st55m96YeR5o+b55m96YeR5bmjCiAgZnVuY3Rpb24gY29udmVydDJQbGF0aW51bVRva2VuKHVpbnQyNTYgX2Ftb3VudCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIF9hbW91bnQubXVsKHJhdGUpOwogIH0KCiAgLy8g6YeR5qKd6LOH6KiKCiAgZnVuY3Rpb24gaW5mbyhzdHJpbmcgX2luZGV4KSBjb25zdGFudCByZXR1cm5zIChzdHJpbmcsIHN0cmluZywgdWludDI1Niwgc3RyaW5nKSB7CiAgICBieXRlczMyIF9iaW5kZXggPSBDb252ZXJ0U3RyaW5nQnl0ZS5zdHJpbmdUb0J5dGVzMzIoX2luZGV4KTsKICAgIHJlcXVpcmUoc3RvcmVob3VzZVtfYmluZGV4XS5hbW91bnQgPiAwKTsKCiAgICBCdWxsaW9uIGJ1bGxpb24gPSBzdG9yZWhvdXNlW19iaW5kZXhdOwoKICAgIHJldHVybiAoYnVsbGlvbi5pbmRleCwgYnVsbGlvbi51bml0LCBidWxsaW9uLmFtb3VudCwgYnVsbGlvbi5pcGZzKTsKICB9Cn0KCgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5CiAqLwpjb250cmFjdCBFUkMyMEJhc2ljIHsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKCmNvbnRyYWN0IFBsYXRpbnVtVG9rZW4gaXMgT3duYWJsZSwgRVJDMjAgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogIC8vID09PT09PT09PSDlrqPlkYogPT09PT09PT09CgogIC8vIOeJiOacrAogIHN0cmluZyBwdWJsaWMgdmVyc2lvbiA9ICIwLjAuMSI7CiAgLy8g5ZCN56ixCiAgc3RyaW5nIHB1YmxpYyBuYW1lOwogIC8vIOaomeiomAogIHN0cmluZyBwdWJsaWMgc3ltYm9sOwogIC8vIOWwj+aVuOm7nuS9jeaVuAogIHVpbnQyNTYgcHVibGljIGRlY2ltYWxzOwogIC8vIOeZvemHkeWQiOe0hOWcsOWdgAogIGFkZHJlc3MgcHVibGljIHBsYXRpbnVtOwoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwogIC8vIOe4veS+m+e1pumHjwogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIC8vIOaJi+e6jOiyuwogIHVpbnQyNTYgcHVibGljIGZlZSA9IDEwOwoKICAvLyA9PT09PT09PT0g5Yid5aeL5YyWID09PT09PT09PQogIGZ1bmN0aW9uIFBsYXRpbnVtVG9rZW4oCiAgICB1aW50MjU2IGluaXRpYWxTdXBwbHksCiAgICBzdHJpbmcgdG9rZW5OYW1lLAogICAgdWludDggZGVjaW1hbFVuaXRzLAogICAgc3RyaW5nIHRva2VuU3ltYm9sCiAgICApIHsKICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gaW5pdGlhbFN1cHBseTsKICAgIHRvdGFsU3VwcGx5ID0gaW5pdGlhbFN1cHBseTsKICAgIG5hbWUgPSB0b2tlbk5hbWU7CiAgICBzeW1ib2wgPSB0b2tlblN5bWJvbDsKICAgIGRlY2ltYWxzID0gZGVjaW1hbFVuaXRzOwogIH0KCiAgLy8gPT09PT09PT09IOasiumZkOaOp+euoSA9PT09PT09PT0KICBtb2RpZmllciBpc1BsYXRpbnVtQ29udHJhY3QoKSB7CiAgICByZXF1aXJlKHBsYXRpbnVtICE9IDB4MCk7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gcGxhdGludW0pOwogICAgXzsKICB9CgogIG1vZGlmaWVyIGlzT3duZXJPclBsYXRpbnVtQ29udHJhY3QoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgIT0gYWRkcmVzcygwKSAmJiAobXNnLnNlbmRlciA9PSBwbGF0aW51bSB8fCBtc2cuc2VuZGVyID09IG93bmVyKSk7CiAgICBfOwogIH0KCiAgLyoqCiAgICog5aKe55SiCiAgICoKICAgKiAg5q2k5pa55rOV5Z+36KGM77yaCiAgICogICAgLSDlop7liqBvd25lcueahGJhbGFuY2XvvIzph4/ngrrmjIflrprnmoRhbW91bnQKICAgKiAgICAtIOWinuWKoHRvdGFsU3VwcGx577yM6YeP54K65oyH5a6a55qEYW1vdW50CiAgICoKICAgKiAgUmVxdWlyZXM6CiAgICogICAgLSDln7fooYzogIXngrrnmb3ph5HlkIjntITvvIjlj6/pgI/pgY5zZXRQbGF0aW51bUFkZHJlc3Pmlrnms5XoqK3lrprvvIkKICAgKiAgICAtIGFtb3VudOmgiOioreWumueCujDku6XkuIoKICAgKgogICAqICBSZXR1cm46CiAgICogICAgLSBib29sOiDln7fooYzmiJDlip/lm57lgrN0cnVlCiAgICovCiAgZnVuY3Rpb24gcHJvZHVjZSh1aW50MjU2IGFtb3VudCkgaXNQbGF0aW51bUNvbnRyYWN0IHJldHVybnMgKGJvb2wpIHsKICAgIGJhbGFuY2VzW293bmVyXSA9IGJhbGFuY2VzW293bmVyXS5hZGQoYW1vdW50KTsKICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKGFtb3VudCk7CgogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKiog5rib55SiCiAgICoKICAgKiAg5q2k5pa55rOV5Z+36KGM77yaCiAgICogICAgLSDmuJvlsJFvd25lcueahGJhbGFuY2XvvIzph4/ngrrmjIflrprnmoRhbW91bnQKICAgKiAgICAtIOa4m+WwkXRvdGFsU3VwcGx577yM6YeP54K65oyH5a6a55qEYW1vdW50CiAgICoKICAgKiAgUmVxdWlyZXM6CiAgICogICAgLSDln7fooYzogIXngrrnmb3ph5HlkIjntITvvIjlj6/pgI/pgY5zZXRQbGF0aW51bUFkZHJlc3Pmlrnms5XoqK3lrprvvIkKICAgKiAgICAtIGFtb3VudOmgiOioreWumueCujDku6XkuIoKICAgKiAgICAtIG93bmVy55qEYmFsYW5jZemcgOWkp+aWvOetieaWvOaMh+WumueahGFtb3VudAogICAqICAgIC0gdG90YWxTdXBwbHnpnIDlpKfmlrznrYnmlrzmjIflrprnmoRhbW91bnQKICAgKgogICAqICBSZXR1cm46CiAgICogICAgLSBib29sOiDln7fooYzmiJDlip/lm57lgrN0cnVlCiAgICovCiAgZnVuY3Rpb24gcmVkdWNlKHVpbnQyNTYgYW1vdW50KSBpc1BsYXRpbnVtQ29udHJhY3QgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShiYWxhbmNlc1tvd25lcl0uc3ViKGFtb3VudCkgPj0gMCk7CiAgICByZXF1aXJlKHRvdGFsU3VwcGx5LnN1YihhbW91bnQpID49IDApOwoKICAgIGJhbGFuY2VzW293bmVyXSA9IGJhbGFuY2VzW293bmVyXS5zdWIoYW1vdW50KTsKICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuc3ViKGFtb3VudCk7CgogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiDoqK3lrpot55m96YeR5ZCI57SE5Zyw5Z2ACiAgICoKICAgKiDmraTmlrnms5Xln7fooYzvvJoKICAgKiAgLSDkv67mlLnmraTlkIjntITmiYDoqo3orZjnmoTnmb3ph5HlkIjntITlnLDlnYDvvIzmraTlnLDlnYDmsbrlrprog73ln7fooYxwcm9kdWNl5ZKMcmVkdWNl5pa55rOV55qE5ZCI57SECiAgICoKICAgKiBSZXF1aXJlczoKICAgKiAgLSDln7fooYzogIXpoIjngrpvd25lcgogICAqICAtIOWcsOWdgOS4jeiDveioreeCujAKICAgKgogICAqIFJldHVybnM6CiAgICogIC0gYm9vbDog6Kit5a6a5oiQ5Yqf5pmC5Zue5YKzdHJ1ZQogICAqLwogIGZ1bmN0aW9uIHNldFBsYXRpbnVtQWRkcmVzcyhhZGRyZXNzIF9hZGRyZXNzKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfYWRkcmVzcyAhPSAweDApOwoKICAgIHBsYXRpbnVtID0gX2FkZHJlc3M7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIOioreWumi3miYvnuozosrsKICAgKgogICAqIOaJi+e6jOiyu+imj+WJh++8mgogICAqICAtIOizvOiyt+mHkeaineaZgu+8jOS7o+W5o+mHj+e4vemHj+WinuWKoOaJi+e6jOiyu+eCuue4veaJo+mZpOS7o+W5o+e4vemHjwogICAqCiAgICogUmVxdWlyZXM6CiAgICogIC0g5Z+36KGM6ICF54K6b3duZXIKICAgKgogICAqIFJldHVybnM6CiAgICogIC0gYm9vbDog5Z+36KGM5oiQ5Yqf77yM5Zue5YKzdHJ1ZQogICAqLwogIGZ1bmN0aW9uIHNldEZlZSh1aW50MjU2IF9mZWUpIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF9mZWUgPj0gMCk7CgogICAgZmVlID0gX2ZlZTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICog5Lqk5piT77yM6L2J56e755m96YeR5Luj5bmjCiAgICoKICAgKiDmraTmlrnms5Xln7fooYzvvJoKICAgKiAgLSDmuJvlsJFmcm9t55qE55m96YeR5Luj5bmj77yM6YeP54K6dmFsdWUKICAgKiAgLSDlop7liqB0b+eahOeZvemHkeS7o+W5o++8jOmHj+eCunZhbHVlCiAgICoKICAgKiBSZXF1aXJlczoKICAgKiAgLSDln7fooYzogIXngrpvd25lcgogICAqCiAgICogUmV0dXJuczoKICAgKiAgLSBib29sOiDln7fooYzmiJDlip/lm57lgrN0cnVlCiAgICoKICAgKiBFdmVudHM6CiAgICogIC0gVHJhbnNmZXI6IOWft+ihjOaIkOWKn+aZgu+8jOinuOeZvOatpOS6i+S7tgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgIGJhbGFuY2VzW293bmVyXSA9IGJhbGFuY2VzW293bmVyXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwoKICAgIFRyYW5zZmVyKG93bmVyLCBfdG8sIF92YWx1ZSk7CgogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiDmn6XoqaLnmb3ph5Hku6PluaPppJjpoY0KICAgKgogICAqIFJldHVybnM6CiAgICogIC0gYmFsYW5jZTog5oyH5a6aYWRkcmVzc+eahOeZvemHkeS7o+W5o+mkmOmhjQogICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9CgogIC8qKgogICAqIOi9ieW4swogICAqCiAgICog5a+m6Zqb5bCHYXBwcm92ZemBjueahHRva2Vu5pW46YeP6YCy6KGM5Lqk5piTCiAgICoKICAgKiDmraTmlrnms5Xln7fooYzvvJoKICAgKiAgLSDkuqTmmJPmjIflrprmlbjph4/nmoTku6PluaMKICAgKgogICAqIFJlcXVpcmVzOgogICAqICAtIOS6pOaYk+eahOS7o+W5o+aVuOmHj3ZhbHVl6ZyA5aSn5pa8MAogICAqICAtIGFsbG93ZWTnmoTku6PluaPmlbjph4/pnIDlpKfmlrx2YWx1Ze+8iGFsbG93ZWTnmoTku6PluaPlhYjnlLHlkbzlj6thcHByb3Zl5pa55rOV6Kit5a6a77yJCiAgICoKICAgKiBSZXR1cm5zOgogICAqICAtIGJvb2w6IOWft+ihjOaIkOWKn++8jOWbnuWCs3RydWUKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBpc093bmVyT3JQbGF0aW51bUNvbnRyYWN0IHJldHVybnMgKGJvb2wpIHsKICAgIHZhciBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bb3duZXJdOwoKICAgIHVpbnQyNTYgdmFsdWVTdWJGZWUgPSBfdmFsdWUuc3ViKGZlZSk7CgogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKHZhbHVlU3ViRmVlKTsKICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW293bmVyXSA9IGJhbGFuY2VzW293bmVyXS5hZGQoZmVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW293bmVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7CgogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIOi9ieW4syAtIOWFgeiosQogICAqCiAgICog5YWB6Kix5LiA5a6a5pW46YeP55qE5Luj5bmj5Y+v5Lul6L2J5biz6Iezb3duZXIKICAgKgogICAqIOassuS/ruaUueWFgeioseWAvO+8jOmcgOWFiOWft+ihjOatpOaWueazleWwh3ZhbHVl6Kit54K6MO+8jOWGjeWft+ihjOS4gOasoeatpOaWueazleWwh3ZhbHVl6Kit54K65oyH5a6a5YC8CiAgICoKICAgKiDmraTmlrnms5Xmk43kvZzvvJoKICAgKiAgLSDkv67mlLlhbGxvd2Vk5YC877yM57SA6YyEc2VuZGVy5YWB6Kix6L2J5bizdmFsdWXmlbjph4/ku6PluaPntaZvd25lcgogICAqICAtIGFsbG93ZWTlgLzmnInoqK3lrprmmYLvvIx2YWx1ZemgiOeCujAKICAgKiAgLSBhbGxvd2Vk5YC85pyq6Kit5a6a5pmC77yMdmFsdWXkuI3ngrowCiAgICoKICAgKiBSZXR1cm5zOgogICAqICAtIGJvb2w6IOWft+ihjOaIkOWKn++8jOWbnuWCs3RydWUKICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX2R1bW15LCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCkgewogICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2AKICAgIC8vICBhbGxvd2FuY2UgdG8gemVybyBieSBjYWxsaW5nIGBhcHByb3ZlKF9zcGVuZGVyLCAwKWAgaWYgaXQgaXMgbm90CiAgICAvLyAgYWxyZWFkeSAwIHRvIG1pdGlnYXRlIHRoZSByYWNlIGNvbmRpdGlvbiBkZXNjcmliZWQgaGVyZToKICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgcmVxdWlyZSgoX3ZhbHVlID09IDApIHx8IChhbGxvd2VkW21zZy5zZW5kZXJdW293bmVyXSA9PSAwKSk7CgogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtvd25lcl0gPSBfdmFsdWU7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBvd25lciwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICog6L2J5bizIC0g5p+l6Kmi5YWB6Kix5YC8CiAgICoKICAgKiBSZXR1cm5zOgogICAqICAtIHVuaXQyNTY6IOWFgeioseWAvAogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KCiAgLyoqCiAgICog5Yiq6Zmk5ZCI57SECiAgICoKICAgKiDmraTmlrnms5Xlkbzlj6vlkIjntITlhaflu7rnmoRzZWxmZGVzdHJ1Y3Tmlrnms5UKICAgKi8KICBmdW5jdGlvbiBzdWljaWRlKCkgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgIHNlbGZkZXN0cnVjdChvd25lcik7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0='.
	

]
