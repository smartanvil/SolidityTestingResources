Class {
	#name : #SRTddd001ced3619edfbdb5be7cf7f982002093f426,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTddd001ced3619edfbdb5be7cf7f982002093f426 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IDAuNC4yMTsKCi8vIEZpbGU6IGNvbnRyYWN0cy9sYW5kL0xBTkRTdG9yYWdlLnNvbAoKY29udHJhY3QgTEFORFN0b3JhZ2UgewoKICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBsYXRlc3RQaW5nOwoKICB1aW50MjU2IGNvbnN0YW50IGNsZWFyTG93ID0gMHhmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwOwogIHVpbnQyNTYgY29uc3RhbnQgY2xlYXJIaWdoID0gMHgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmOwogIHVpbnQyNTYgY29uc3RhbnQgZmFjdG9yID0gMHgxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIGF1dGhvcml6ZWREZXBsb3k7CgogIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgcHVibGljIHVwZGF0ZU9wZXJhdG9yOwp9CgovLyBGaWxlOiBjb250cmFjdHMvdXBncmFkYWJsZS9Pd25hYmxlU3RvcmFnZS5zb2wKCmNvbnRyYWN0IE93bmFibGVTdG9yYWdlIHsKCiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgogIGZ1bmN0aW9uIE93bmFibGVTdG9yYWdlKCkgaW50ZXJuYWwgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCn0KCi8vIEZpbGU6IGNvbnRyYWN0cy91cGdyYWRhYmxlL1Byb3h5U3RvcmFnZS5zb2wKCmNvbnRyYWN0IFByb3h5U3RvcmFnZSB7CgogIC8qKgogICAqIEN1cnJlbnQgY29udHJhY3QgdG8gd2hpY2ggd2UgYXJlIHByb3hpbmcKICAgKi8KICBhZGRyZXNzIHB1YmxpYyBjdXJyZW50Q29udHJhY3Q7CiAgYWRkcmVzcyBwdWJsaWMgcHJveHlPd25lcjsKfQoKLy8gRmlsZTogZXJjODIxL2NvbnRyYWN0cy9Bc3NldFJlZ2lzdHJ5U3RvcmFnZS5zb2wKCmNvbnRyYWN0IEFzc2V0UmVnaXN0cnlTdG9yYWdlIHsKCiAgc3RyaW5nIGludGVybmFsIF9uYW1lOwogIHN0cmluZyBpbnRlcm5hbCBfc3ltYm9sOwogIHN0cmluZyBpbnRlcm5hbCBfZGVzY3JpcHRpb247CgogIC8qKgogICAqIFN0b3JlcyB0aGUgdG90YWwgY291bnQgb2YgYXNzZXRzIG1hbmFnZWQgYnkgdGhpcyByZWdpc3RyeQogICAqLwogIHVpbnQyNTYgaW50ZXJuYWwgX2NvdW50OwoKICAvKioKICAgKiBTdG9yZXMgYW4gYXJyYXkgb2YgYXNzZXRzIG93bmVkIGJ5IGEgZ2l2ZW4gYWNjb3VudAogICAqLwogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2W10pIGludGVybmFsIF9hc3NldHNPZjsKCiAgLyoqCiAgICogU3RvcmVzIHRoZSBjdXJyZW50IGhvbGRlciBvZiBhbiBhc3NldAogICAqLwogIG1hcHBpbmcodWludDI1NiA9PiBhZGRyZXNzKSBpbnRlcm5hbCBfaG9sZGVyT2Y7CgogIC8qKgogICAqIFN0b3JlcyB0aGUgaW5kZXggb2YgYW4gYXNzZXQgaW4gdGhlIGBfYXNzZXRzT2ZgIGFycmF5IG9mIGl0cyBob2xkZXIKICAgKi8KICBtYXBwaW5nKHVpbnQyNTYgPT4gdWludDI1NikgaW50ZXJuYWwgX2luZGV4T2ZBc3NldDsKCiAgLyoqCiAgICogU3RvcmVzIHRoZSBkYXRhIGFzc29jaWF0ZWQgd2l0aCBhbiBhc3NldAogICAqLwogIG1hcHBpbmcodWludDI1NiA9PiBzdHJpbmcpIGludGVybmFsIF9hc3NldERhdGE7CgogIC8qKgogICAqIEZvciBhIGdpdmVuIGFjY291bnQsIGZvciBhIGdpdmVuIG9wZXJhdG9yLCBzdG9yZSB3aGV0aGVyIHRoYXQgb3BlcmF0b3IgaXMKICAgKiBhbGxvd2VkIHRvIHRyYW5zZmVyIGFuZCBtb2RpZnkgYXNzZXRzIG9uIGJlaGFsZiBvZiB0aGVtLgogICAqLwogIG1hcHBpbmcoYWRkcmVzcyA9PiBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkpIGludGVybmFsIF9vcGVyYXRvcnM7CgogIC8qKgogICAqIEFwcHJvdmFsIGFycmF5CiAgICovCiAgbWFwcGluZyh1aW50MjU2ID0+IGFkZHJlc3MpIGludGVybmFsIF9hcHByb3ZhbDsKfQoKLy8gRmlsZTogY29udHJhY3RzL1N0b3JhZ2Uuc29sCgpjb250cmFjdCBTdG9yYWdlIGlzIFByb3h5U3RvcmFnZSwgT3duYWJsZVN0b3JhZ2UsIEFzc2V0UmVnaXN0cnlTdG9yYWdlLCBMQU5EU3RvcmFnZSB7Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy91cGdyYWRhYmxlL0lBcHBsaWNhdGlvbi5zb2wKCmNvbnRyYWN0IElBcHBsaWNhdGlvbiB7CiAgZnVuY3Rpb24gaW5pdGlhbGl6ZShieXRlcyBkYXRhKSBwdWJsaWM7Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy91cGdyYWRhYmxlL093bmFibGUuc29sCgpjb250cmFjdCBPd25hYmxlIGlzIFN0b3JhZ2UgewoKICBldmVudCBPd25lclVwZGF0ZShhZGRyZXNzIF9wcmV2T3duZXIsIGFkZHJlc3MgX25ld093bmVyKTsKCiAgZnVuY3Rpb24gYnl0ZXNUb0FkZHJlc3MgKGJ5dGVzIGIpIHB1cmUgcHVibGljIHJldHVybnMgKGFkZHJlc3MpIHsKICAgIHVpbnQgcmVzdWx0ID0gMDsKICAgIGZvciAodWludCBpID0gYi5sZW5ndGgtMTsgaSsxID4gMDsgaS0tKSB7CiAgICAgIHVpbnQgYyA9IHVpbnQoYltpXSk7CiAgICAgIHVpbnQgdG9faW5jID0gYyAqICggMTYgKiogKChiLmxlbmd0aCAtIGktMSkgKiAyKSk7CiAgICAgIHJlc3VsdCArPSB0b19pbmM7CiAgICB9CiAgICByZXR1cm4gYWRkcmVzcyhyZXN1bHQpOwogIH0KCiAgbW9kaWZpZXIgb25seU93bmVyIHsKICAgIGFzc2VydChtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIF9uZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKF9uZXdPd25lciAhPSBvd25lcik7CiAgICBvd25lciA9IF9uZXdPd25lcjsKICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9sYW5kL0lMQU5EUmVnaXN0cnkuc29sCgppbnRlcmZhY2UgSUxBTkRSZWdpc3RyeSB7CgogIC8vIExBTkQgY2FuIGJlIGFzc2lnbmVkIGJ5IHRoZSBvd25lcgogIGZ1bmN0aW9uIGFzc2lnbk5ld1BhcmNlbChpbnQgeCwgaW50IHksIGFkZHJlc3MgYmVuZWZpY2lhcnkpIHB1YmxpYzsKICBmdW5jdGlvbiBhc3NpZ25NdWx0aXBsZVBhcmNlbHMoaW50W10geCwgaW50W10geSwgYWRkcmVzcyBiZW5lZmljaWFyeSkgcHVibGljOwoKICAvLyBBZnRlciBvbmUgeWVhciwgbGFuZCBjYW4gYmUgY2xhaW1lZCBmcm9tIGFuIGluYWN0aXZlIHB1YmxpYyBrZXkKICBmdW5jdGlvbiBwaW5nKCkgcHVibGljOwoKICAvLyBMQU5ELWNlbnRyaWMgZ2V0dGVycwogIGZ1bmN0aW9uIGVuY29kZVRva2VuSWQoaW50IHgsIGludCB5KSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiBkZWNvZGVUb2tlbklkKHVpbnQgdmFsdWUpIHZpZXcgcHVibGljIHJldHVybnMgKGludCwgaW50KTsKICBmdW5jdGlvbiBleGlzdHMoaW50IHgsIGludCB5KSB2aWV3IHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBvd25lck9mTGFuZChpbnQgeCwgaW50IHkpIHZpZXcgcHVibGljIHJldHVybnMgKGFkZHJlc3MpOwogIGZ1bmN0aW9uIG93bmVyT2ZMYW5kTWFueShpbnRbXSB4LCBpbnRbXSB5KSB2aWV3IHB1YmxpYyByZXR1cm5zIChhZGRyZXNzW10pOwogIGZ1bmN0aW9uIGxhbmRPZihhZGRyZXNzIG93bmVyKSB2aWV3IHB1YmxpYyByZXR1cm5zIChpbnRbXSwgaW50W10pOwogIGZ1bmN0aW9uIGxhbmREYXRhKGludCB4LCBpbnQgeSkgdmlldyBwdWJsaWMgcmV0dXJucyAoc3RyaW5nKTsKCiAgLy8gVHJhbnNmZXIgTEFORAogIGZ1bmN0aW9uIHRyYW5zZmVyTGFuZChpbnQgeCwgaW50IHksIGFkZHJlc3MgdG8pIHB1YmxpYzsKICBmdW5jdGlvbiB0cmFuc2Zlck1hbnlMYW5kKGludFtdIHgsIGludFtdIHksIGFkZHJlc3MgdG8pIHB1YmxpYzsKCiAgLy8gVXBkYXRlIExBTkQKICBmdW5jdGlvbiB1cGRhdGVMYW5kRGF0YShpbnQgeCwgaW50IHksIHN0cmluZyBkYXRhKSBwdWJsaWM7CiAgZnVuY3Rpb24gdXBkYXRlTWFueUxhbmREYXRhKGludFtdIHgsIGludFtdIHksIHN0cmluZyBkYXRhKSBwdWJsaWM7CgogIC8vIEV2ZW50cwoKICBldmVudCBVcGRhdGUoICAKICAgIHVpbnQyNTYgaW5kZXhlZCBhc3NldElkLCAKICAgIGFkZHJlc3MgaW5kZXhlZCBob2xkZXIsICAKICAgIGFkZHJlc3MgaW5kZXhlZCBvcGVyYXRvciwgIAogICAgc3RyaW5nIGRhdGEgIAogICk7Cn0KCi8vIEZpbGU6IGVyYzgyMS9jb250cmFjdHMvSUVSQzcyMUJhc2Uuc29sCgppbnRlcmZhY2UgSUVSQzcyMUJhc2UgewogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CgogIC8vIGZ1bmN0aW9uIGV4aXN0cyh1aW50MjU2IGFzc2V0SWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBhc3NldElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgaG9sZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKCiAgZnVuY3Rpb24gc2FmZVRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgYXNzZXRJZCkgcHVibGljOwogIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IGFzc2V0SWQsIGJ5dGVzIHVzZXJEYXRhKSBwdWJsaWM7CgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgYXNzZXRJZCkgcHVibGljOwoKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgb3BlcmF0b3IsIHVpbnQyNTYgYXNzZXRJZCkgcHVibGljOwogIGZ1bmN0aW9uIHNldEFwcHJvdmFsRm9yQWxsKGFkZHJlc3Mgb3BlcmF0b3IsIGJvb2wgYXV0aG9yaXplZCkgcHVibGljOwoKICBmdW5jdGlvbiBnZXRBcHByb3ZlZEFkZHJlc3ModWludDI1NiBhc3NldElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKICBmdW5jdGlvbiBpc0FwcHJvdmVkRm9yQWxsKGFkZHJlc3Mgb3BlcmF0b3IsIGFkZHJlc3MgYXNzZXRPd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CgogIGZ1bmN0aW9uIGlzQXV0aG9yaXplZChhZGRyZXNzIG9wZXJhdG9yLCB1aW50MjU2IGFzc2V0SWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwoKICBldmVudCBUcmFuc2ZlcigKICAgIGFkZHJlc3MgaW5kZXhlZCBmcm9tLAogICAgYWRkcmVzcyBpbmRleGVkIHRvLAogICAgdWludDI1NiBpbmRleGVkIGFzc2V0SWQsCiAgICBhZGRyZXNzIG9wZXJhdG9yLAogICAgYnl0ZXMgdXNlckRhdGEKICApOwogIGV2ZW50IEFwcHJvdmFsRm9yQWxsKAogICAgYWRkcmVzcyBpbmRleGVkIG9wZXJhdG9yLAogICAgYWRkcmVzcyBpbmRleGVkIGhvbGRlciwKICAgIGJvb2wgYXV0aG9yaXplZAogICk7CiAgZXZlbnQgQXBwcm92YWwoCiAgICBhZGRyZXNzIGluZGV4ZWQgb3duZXIsCiAgICBhZGRyZXNzIGluZGV4ZWQgb3BlcmF0b3IsCiAgICB1aW50MjU2IGluZGV4ZWQgYXNzZXRJZAogICk7Cn0KCi8vIEZpbGU6IGVyYzgyMS9jb250cmFjdHMvSUVSQzcyMVJlY2VpdmVyLnNvbAoKaW50ZXJmYWNlIElFUkM3MjFSZWNlaXZlciB7CiAgZnVuY3Rpb24gb25FUkM3MjFSZWNlaXZlZCgKICAgIHVpbnQyNTYgX3Rva2VuSWQsCiAgICBhZGRyZXNzIF9vbGRPd25lciwKICAgIGJ5dGVzICAgX3VzZXJEYXRhCiAgKSBwdWJsaWMgcmV0dXJucyAoYnl0ZXM0KTsKfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL21hdGgvU2FmZU1hdGguc29sCgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKLy8gRmlsZTogZXJjODIxL2NvbnRyYWN0cy9FUkM3MjFCYXNlLnNvbAoKaW50ZXJmYWNlIEVSQzE2NSB7CiAgZnVuY3Rpb24gc3VwcG9ydHNJbnRlcmZhY2UoYnl0ZXM0IGludGVyZmFjZUlEKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKfQoKY29udHJhY3QgRVJDNzIxQmFzZSBpcyBBc3NldFJlZ2lzdHJ5U3RvcmFnZSwgSUVSQzcyMUJhc2UsIEVSQzE2NSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIC8vCiAgLy8gR2xvYmFsIEdldHRlcnMKICAvLwoKICAvKioKICAgKiBAZGV2IEdldHMgdGhlIHRvdGFsIGFtb3VudCBvZiBhc3NldHMgc3RvcmVkIGJ5IHRoZSBjb250cmFjdAogICAqIEByZXR1cm4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIHRvdGFsIGFtb3VudCBvZiBhc3NldHMKICAgKi8KICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBfY291bnQ7CiAgfQoKICAvLwogIC8vIEFzc2V0LWNlbnRyaWMgZ2V0dGVyIGZ1bmN0aW9ucwogIC8vCgogIC8qKgogICAqIEBkZXYgUXVlcmllcyB3aGF0IGFkZHJlc3Mgb3ducyBhbiBhc3NldC4gVGhpcyBtZXRob2QgZG9lcyBub3QgdGhyb3cuCiAgICogSW4gb3JkZXIgdG8gY2hlY2sgaWYgdGhlIGFzc2V0IGV4aXN0cywgdXNlIHRoZSBgZXhpc3RzYCBmdW5jdGlvbiBvciBjaGVjayBpZiB0aGUKICAgKiByZXR1cm4gdmFsdWUgb2YgdGhpcyBjYWxsIGlzIGAwYC4KICAgKiBAcmV0dXJuIHVpbnQyNTYgdGhlIGFzc2V0SWQKICAgKi8KICBmdW5jdGlvbiBvd25lck9mKHVpbnQyNTYgYXNzZXRJZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcykgewogICAgcmV0dXJuIF9ob2xkZXJPZlthc3NldElkXTsKICB9CgogIC8vCiAgLy8gSG9sZGVyLWNlbnRyaWMgZ2V0dGVyIGZ1bmN0aW9ucwogIC8vCiAgLyoqCiAgICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcwogICAqIEBwYXJhbSBvd25lciBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSBiYWxhbmNlIG9mCiAgICogQHJldHVybiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcwogICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIG93bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gX2Fzc2V0c09mW293bmVyXS5sZW5ndGg7CiAgfQoKICAvLwogIC8vIEF1dGhvcml6YXRpb24gZ2V0dGVycwogIC8vCgogIC8qKgogICAqIEBkZXYgUXVlcnkgd2hldGhlciBhbiBhZGRyZXNzIGhhcyBiZWVuIGF1dGhvcml6ZWQgdG8gbW92ZSBhbnkgYXNzZXRzIG9uIGJlaGFsZiBvZiBzb21lb25lIGVsc2UKICAgKiBAcGFyYW0gb3BlcmF0b3IgdGhlIGFkZHJlc3MgdGhhdCBtaWdodCBiZSBhdXRob3JpemVkCiAgICogQHBhcmFtIGFzc2V0SG9sZGVyIHRoZSBhZGRyZXNzIHRoYXQgcHJvdmlkZWQgdGhlIGF1dGhvcml6YXRpb24KICAgKiBAcmV0dXJuIGJvb2wgdHJ1ZSBpZiB0aGUgb3BlcmF0b3IgaGFzIGJlZW4gYXV0aG9yaXplZCB0byBtb3ZlIGFueSBhc3NldHMKICAgKi8KICBmdW5jdGlvbiBpc0FwcHJvdmVkRm9yQWxsKGFkZHJlc3Mgb3BlcmF0b3IsIGFkZHJlc3MgYXNzZXRIb2xkZXIpCiAgICBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKQogIHsKICAgIHJldHVybiBfb3BlcmF0b3JzW2Fzc2V0SG9sZGVyXVtvcGVyYXRvcl07CiAgfQoKICAvKioKICAgKiBAZGV2IFF1ZXJ5IHdoYXQgYWRkcmVzcyBoYXMgYmVlbiBwYXJ0aWN1bGFybHkgYXV0aG9yaXplZCB0byBtb3ZlIGFuIGFzc2V0CiAgICogQHBhcmFtIGFzc2V0SWQgdGhlIGFzc2V0IHRvIGJlIHF1ZXJpZWQgZm9yCiAgICogQHJldHVybiBib29sIHRydWUgaWYgdGhlIGFzc2V0IGhhcyBiZWVuIGFwcHJvdmVkIGJ5IHRoZSBob2xkZXIKICAgKi8KICBmdW5jdGlvbiBnZXRBcHByb3ZlZEFkZHJlc3ModWludDI1NiBhc3NldElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICByZXR1cm4gX2FwcHJvdmFsW2Fzc2V0SWRdOwogIH0KCiAgLyoqCiAgICogQGRldiBRdWVyeSBpZiBhbiBvcGVyYXRvciBjYW4gbW92ZSBhbiBhc3NldC4KICAgKiBAcGFyYW0gb3BlcmF0b3IgdGhlIGFkZHJlc3MgdGhhdCBtaWdodCBiZSBhdXRob3JpemVkCiAgICogQHBhcmFtIGFzc2V0SWQgdGhlIGFzc2V0IHRoYXQgaGFzIGJlZW4gYGFwcHJvdmVkYCBmb3IgdHJhbnNmZXIKICAgKiBAcmV0dXJuIGJvb2wgdHJ1ZSBpZiB0aGUgYXNzZXQgaGFzIGJlZW4gYXBwcm92ZWQgYnkgdGhlIGhvbGRlcgogICAqLwogIGZ1bmN0aW9uIGlzQXV0aG9yaXplZChhZGRyZXNzIG9wZXJhdG9yLCB1aW50MjU2IGFzc2V0SWQpCiAgICBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKQogIHsKICAgIHJlcXVpcmUob3BlcmF0b3IgIT0gMCk7CiAgICBhZGRyZXNzIG93bmVyID0gb3duZXJPZihhc3NldElkKTsKICAgIGlmIChvcGVyYXRvciA9PSBvd25lcikgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIHJldHVybiBpc0FwcHJvdmVkRm9yQWxsKG9wZXJhdG9yLCBvd25lcikgfHwgZ2V0QXBwcm92ZWRBZGRyZXNzKGFzc2V0SWQpID09IG9wZXJhdG9yOwogIH0KCiAgLy8KICAvLyBBdXRob3JpemF0aW9uCiAgLy8KCiAgLyoqCiAgICogQGRldiBBdXRob3JpemUgYSB0aGlyZCBwYXJ0eSBvcGVyYXRvciB0byBtYW5hZ2UgKHNlbmQpIG1zZy5zZW5kZXIncyBhc3NldAogICAqIEBwYXJhbSBvcGVyYXRvciBhZGRyZXNzIHRvIGJlIGFwcHJvdmVkCiAgICogQHBhcmFtIGF1dGhvcml6ZWQgYm9vbCBzZXQgdG8gdHJ1ZSB0byBhdXRob3JpemUsIGZhbHNlIHRvIHdpdGhkcmF3IGF1dGhvcml6YXRpb24KICAgKi8KICBmdW5jdGlvbiBzZXRBcHByb3ZhbEZvckFsbChhZGRyZXNzIG9wZXJhdG9yLCBib29sIGF1dGhvcml6ZWQpIHB1YmxpYyB7CiAgICBpZiAoYXV0aG9yaXplZCkgewogICAgICByZXF1aXJlKCFpc0FwcHJvdmVkRm9yQWxsKG9wZXJhdG9yLCBtc2cuc2VuZGVyKSk7CiAgICAgIF9hZGRBdXRob3JpemF0aW9uKG9wZXJhdG9yLCBtc2cuc2VuZGVyKTsKICAgIH0gZWxzZSB7CiAgICAgIHJlcXVpcmUoaXNBcHByb3ZlZEZvckFsbChvcGVyYXRvciwgbXNnLnNlbmRlcikpOwogICAgICBfY2xlYXJBdXRob3JpemF0aW9uKG9wZXJhdG9yLCBtc2cuc2VuZGVyKTsKICAgIH0KICAgIEFwcHJvdmFsRm9yQWxsKG9wZXJhdG9yLCBtc2cuc2VuZGVyLCBhdXRob3JpemVkKTsKICB9CgogIC8qKgogICAqIEBkZXYgQXV0aG9yaXplIGEgdGhpcmQgcGFydHkgb3BlcmF0b3IgdG8gbWFuYWdlIG9uZSBwYXJ0aWN1bGFyIGFzc2V0CiAgICogQHBhcmFtIG9wZXJhdG9yIGFkZHJlc3MgdG8gYmUgYXBwcm92ZWQKICAgKiBAcGFyYW0gYXNzZXRJZCBhc3NldCB0byBhcHByb3ZlCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIG9wZXJhdG9yLCB1aW50MjU2IGFzc2V0SWQpIHB1YmxpYyB7CiAgICBhZGRyZXNzIGhvbGRlciA9IG93bmVyT2YoYXNzZXRJZCk7CiAgICByZXF1aXJlKG9wZXJhdG9yICE9IGhvbGRlcik7CiAgICBpZiAoZ2V0QXBwcm92ZWRBZGRyZXNzKGFzc2V0SWQpICE9IG9wZXJhdG9yKSB7CiAgICAgIF9hcHByb3ZhbFthc3NldElkXSA9IG9wZXJhdG9yOwogICAgICBBcHByb3ZhbChob2xkZXIsIG9wZXJhdG9yLCBhc3NldElkKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIF9hZGRBdXRob3JpemF0aW9uKGFkZHJlc3Mgb3BlcmF0b3IsIGFkZHJlc3MgaG9sZGVyKSBwcml2YXRlIHsKICAgIF9vcGVyYXRvcnNbaG9sZGVyXVtvcGVyYXRvcl0gPSB0cnVlOwogIH0KCiAgZnVuY3Rpb24gX2NsZWFyQXV0aG9yaXphdGlvbihhZGRyZXNzIG9wZXJhdG9yLCBhZGRyZXNzIGhvbGRlcikgcHJpdmF0ZSB7CiAgICBfb3BlcmF0b3JzW2hvbGRlcl1bb3BlcmF0b3JdID0gZmFsc2U7CiAgfQoKICAvLwogIC8vIEludGVybmFsIE9wZXJhdGlvbnMKICAvLwoKICBmdW5jdGlvbiBfYWRkQXNzZXRUbyhhZGRyZXNzIHRvLCB1aW50MjU2IGFzc2V0SWQpIGludGVybmFsIHsKICAgIF9ob2xkZXJPZlthc3NldElkXSA9IHRvOwoKICAgIHVpbnQyNTYgbGVuZ3RoID0gYmFsYW5jZU9mKHRvKTsKCiAgICBfYXNzZXRzT2ZbdG9dLnB1c2goYXNzZXRJZCk7CgogICAgX2luZGV4T2ZBc3NldFthc3NldElkXSA9IGxlbmd0aDsKCiAgICBfY291bnQgPSBfY291bnQuYWRkKDEpOwogIH0KCiAgZnVuY3Rpb24gX3JlbW92ZUFzc2V0RnJvbShhZGRyZXNzIGZyb20sIHVpbnQyNTYgYXNzZXRJZCkgaW50ZXJuYWwgewogICAgdWludDI1NiBhc3NldEluZGV4ID0gX2luZGV4T2ZBc3NldFthc3NldElkXTsKICAgIHVpbnQyNTYgbGFzdEFzc2V0SW5kZXggPSBiYWxhbmNlT2YoZnJvbSkuc3ViKDEpOwogICAgdWludDI1NiBsYXN0QXNzZXRJZCA9IF9hc3NldHNPZltmcm9tXVtsYXN0QXNzZXRJbmRleF07CgogICAgX2hvbGRlck9mW2Fzc2V0SWRdID0gMDsKCiAgICAvLyBJbnNlcnQgdGhlIGxhc3QgYXNzZXQgaW50byB0aGUgcG9zaXRpb24gcHJldmlvdXNseSBvY2N1cGllZCBieSB0aGUgYXNzZXQgdG8gYmUgcmVtb3ZlZAogICAgX2Fzc2V0c09mW2Zyb21dW2Fzc2V0SW5kZXhdID0gbGFzdEFzc2V0SWQ7CgogICAgLy8gUmVzaXplIHRoZSBhcnJheQogICAgX2Fzc2V0c09mW2Zyb21dW2xhc3RBc3NldEluZGV4XSA9IDA7CiAgICBfYXNzZXRzT2ZbZnJvbV0ubGVuZ3RoLS07CgogICAgLy8gUmVtb3ZlIHRoZSBhcnJheSBpZiBubyBtb3JlIGFzc2V0cyBhcmUgb3duZWQgdG8gcHJldmVudCBwb2xsdXRpb24KICAgIGlmIChfYXNzZXRzT2ZbZnJvbV0ubGVuZ3RoID09IDApIHsKICAgICAgZGVsZXRlIF9hc3NldHNPZltmcm9tXTsKICAgIH0KCiAgICAvLyBVcGRhdGUgdGhlIGluZGV4IG9mIHBvc2l0aW9ucyBmb3IgdGhlIGFzc2V0CiAgICBfaW5kZXhPZkFzc2V0W2Fzc2V0SWRdID0gMDsKICAgIF9pbmRleE9mQXNzZXRbbGFzdEFzc2V0SWRdID0gYXNzZXRJbmRleDsKCiAgICBfY291bnQgPSBfY291bnQuc3ViKDEpOwogIH0KCiAgZnVuY3Rpb24gX2NsZWFyQXBwcm92YWwoYWRkcmVzcyBob2xkZXIsIHVpbnQyNTYgYXNzZXRJZCkgaW50ZXJuYWwgewogICAgaWYgKG93bmVyT2YoYXNzZXRJZCkgPT0gaG9sZGVyICYmIF9hcHByb3ZhbFthc3NldElkXSAhPSAwKSB7CiAgICAgIF9hcHByb3ZhbFthc3NldElkXSA9IDA7CiAgICAgIEFwcHJvdmFsKGhvbGRlciwgMCwgYXNzZXRJZCk7CiAgICB9CiAgfQoKICAvLwogIC8vIFN1cHBseS1hbHRlcmluZyBmdW5jdGlvbnMKICAvLwoKICBmdW5jdGlvbiBfZ2VuZXJhdGUodWludDI1NiBhc3NldElkLCBhZGRyZXNzIGJlbmVmaWNpYXJ5KSBpbnRlcm5hbCB7CiAgICByZXF1aXJlKF9ob2xkZXJPZlthc3NldElkXSA9PSAwKTsKCiAgICBfYWRkQXNzZXRUbyhiZW5lZmljaWFyeSwgYXNzZXRJZCk7CgogICAgVHJhbnNmZXIoMCwgYmVuZWZpY2lhcnksIGFzc2V0SWQsIG1zZy5zZW5kZXIsICcnKTsKICB9CgogIGZ1bmN0aW9uIF9kZXN0cm95KHVpbnQyNTYgYXNzZXRJZCkgaW50ZXJuYWwgewogICAgYWRkcmVzcyBob2xkZXIgPSBfaG9sZGVyT2ZbYXNzZXRJZF07CiAgICByZXF1aXJlKGhvbGRlciAhPSAwKTsKCiAgICBfcmVtb3ZlQXNzZXRGcm9tKGhvbGRlciwgYXNzZXRJZCk7CgogICAgVHJhbnNmZXIoaG9sZGVyLCAwLCBhc3NldElkLCBtc2cuc2VuZGVyLCAnJyk7CiAgfQoKICAvLwogIC8vIFRyYW5zYWN0aW9uIHJlbGF0ZWQgb3BlcmF0aW9ucwogIC8vCgogIG1vZGlmaWVyIG9ubHlIb2xkZXIodWludDI1NiBhc3NldElkKSB7CiAgICByZXF1aXJlKF9ob2xkZXJPZlthc3NldElkXSA9PSBtc2cuc2VuZGVyKTsKICAgIF87CiAgfQoKICBtb2RpZmllciBvbmx5QXV0aG9yaXplZCh1aW50MjU2IGFzc2V0SWQpIHsKICAgIHJlcXVpcmUoaXNBdXRob3JpemVkKG1zZy5zZW5kZXIsIGFzc2V0SWQpKTsKICAgIF87CiAgfQoKICBtb2RpZmllciBpc0N1cnJlbnRPd25lcihhZGRyZXNzIGZyb20sIHVpbnQyNTYgYXNzZXRJZCkgewogICAgcmVxdWlyZShfaG9sZGVyT2ZbYXNzZXRJZF0gPT0gZnJvbSk7CiAgICBfOwogIH0KCiAgbW9kaWZpZXIgaXNEZXN0aW5hdGFyeURlZmluZWQoYWRkcmVzcyBkZXN0aW5hdGFyeSkgewogICAgcmVxdWlyZShkZXN0aW5hdGFyeSAhPSAwKTsKICAgIF87CiAgfQoKICBtb2RpZmllciBkZXN0aW5hdGFyeUlzTm90SG9sZGVyKHVpbnQyNTYgYXNzZXRJZCwgYWRkcmVzcyB0bykgewogICAgcmVxdWlyZShfaG9sZGVyT2ZbYXNzZXRJZF0gIT0gdG8pOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgQWxpYXMgb2YgYHNhZmVUcmFuc2ZlckZyb20oZnJvbSwgdG8sIGFzc2V0SWQsICcnKWAKICAgKgogICAqIEBwYXJhbSBmcm9tIGFkZHJlc3MgdGhhdCBjdXJyZW50bHkgb3ducyBhbiBhc3NldAogICAqIEBwYXJhbSB0byBhZGRyZXNzIHRvIHJlY2VpdmUgdGhlIG93bmVyc2hpcCBvZiB0aGUgYXNzZXQKICAgKiBAcGFyYW0gYXNzZXRJZCB1aW50MjU2IElEIG9mIHRoZSBhc3NldCB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IGFzc2V0SWQpIHB1YmxpYyB7CiAgICByZXR1cm4gX2RvVHJhbnNmZXJGcm9tKGZyb20sIHRvLCBhc3NldElkLCAnJywgbXNnLnNlbmRlciwgdHJ1ZSk7CiAgfQoKICAvKioKICAgKiBAZGV2IFNlY3VyZWx5IHRyYW5zZmVycyB0aGUgb3duZXJzaGlwIG9mIGEgZ2l2ZW4gYXNzZXQgZnJvbSBvbmUgYWRkcmVzcyB0bwogICAqIGFub3RoZXIgYWRkcmVzcywgY2FsbGluZyB0aGUgbWV0aG9kIGBvbk5GVFJlY2VpdmVkYCBvbiB0aGUgdGFyZ2V0IGFkZHJlc3MgaWYKICAgKiB0aGVyZSdzIGNvZGUgYXNzb2NpYXRlZCB3aXRoIGl0CiAgICoKICAgKiBAcGFyYW0gZnJvbSBhZGRyZXNzIHRoYXQgY3VycmVudGx5IG93bnMgYW4gYXNzZXQKICAgKiBAcGFyYW0gdG8gYWRkcmVzcyB0byByZWNlaXZlIHRoZSBvd25lcnNoaXAgb2YgdGhlIGFzc2V0CiAgICogQHBhcmFtIGFzc2V0SWQgdWludDI1NiBJRCBvZiB0aGUgYXNzZXQgdG8gYmUgdHJhbnNmZXJyZWQKICAgKiBAcGFyYW0gdXNlckRhdGEgYnl0ZXMgYXJiaXRyYXJ5IHVzZXIgaW5mb3JtYXRpb24gdG8gYXR0YWNoIHRvIHRoaXMgdHJhbnNmZXIKICAgKi8KICBmdW5jdGlvbiBzYWZlVHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiBhc3NldElkLCBieXRlcyB1c2VyRGF0YSkgcHVibGljIHsKICAgIHJldHVybiBfZG9UcmFuc2ZlckZyb20oZnJvbSwgdG8sIGFzc2V0SWQsIHVzZXJEYXRhLCBtc2cuc2VuZGVyLCB0cnVlKTsKICB9CgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXJzIHRoZSBvd25lcnNoaXAgb2YgYSBnaXZlbiBhc3NldCBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIgYWRkcmVzcwogICAqIFdhcm5pbmchIFRoaXMgZnVuY3Rpb24gZG9lcyBub3QgYXR0ZW1wdCB0byB2ZXJpZnkgdGhhdCB0aGUgdGFyZ2V0IGFkZHJlc3MgY2FuIHNlbmQKICAgKiB0b2tlbnMuCiAgICoKICAgKiBAcGFyYW0gZnJvbSBhZGRyZXNzIHNlbmRpbmcgdGhlIGFzc2V0CiAgICogQHBhcmFtIHRvIGFkZHJlc3MgdG8gcmVjZWl2ZSB0aGUgb3duZXJzaGlwIG9mIHRoZSBhc3NldAogICAqIEBwYXJhbSBhc3NldElkIHVpbnQyNTYgSUQgb2YgdGhlIGFzc2V0IHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiBhc3NldElkKSBwdWJsaWMgewogICAgcmV0dXJuIF9kb1RyYW5zZmVyRnJvbShmcm9tLCB0bywgYXNzZXRJZCwgJycsIG1zZy5zZW5kZXIsIGZhbHNlKTsKICB9CgogIGZ1bmN0aW9uIF9kb1RyYW5zZmVyRnJvbSgKICAgIGFkZHJlc3MgZnJvbSwKICAgIGFkZHJlc3MgdG8sCiAgICB1aW50MjU2IGFzc2V0SWQsCiAgICBieXRlcyB1c2VyRGF0YSwKICAgIGFkZHJlc3Mgb3BlcmF0b3IsCiAgICBib29sIGRvQ2hlY2sKICApCiAgICBpc0Rlc3RpbmF0YXJ5RGVmaW5lZCh0bykKICAgIGRlc3RpbmF0YXJ5SXNOb3RIb2xkZXIoYXNzZXRJZCwgdG8pCiAgICBpc0N1cnJlbnRPd25lcihmcm9tLCBhc3NldElkKQogICAgb25seUF1dGhvcml6ZWQoYXNzZXRJZCkKICAgIGludGVybmFsCiAgewogICAgYWRkcmVzcyBob2xkZXIgPSBfaG9sZGVyT2ZbYXNzZXRJZF07CiAgICBfcmVtb3ZlQXNzZXRGcm9tKGhvbGRlciwgYXNzZXRJZCk7CiAgICBfY2xlYXJBcHByb3ZhbChob2xkZXIsIGFzc2V0SWQpOwogICAgX2FkZEFzc2V0VG8odG8sIGFzc2V0SWQpOwoKICAgIGlmIChkb0NoZWNrICYmIF9pc0NvbnRyYWN0KHRvKSkgewogICAgICAvLyBFcXVhbHMgdG8gYnl0ZXM0KGtlY2NhazI1Nigib25FUkM3MjFSZWNlaXZlZChhZGRyZXNzLHVpbnQyNTYsYnl0ZXMpIikpCiAgICAgIGJ5dGVzNCBFUkM3MjFfUkVDRUlWRUQgPSBieXRlczQoMHhmMGI5ZTViYSk7CiAgICAgIHJlcXVpcmUoCiAgICAgICAgSUVSQzcyMVJlY2VpdmVyKHRvKS5vbkVSQzcyMVJlY2VpdmVkKAogICAgICAgICAgYXNzZXRJZCwgaG9sZGVyLCB1c2VyRGF0YQogICAgICAgICkgPT0gRVJDNzIxX1JFQ0VJVkVECiAgICAgICk7CiAgICB9CgogICAgVHJhbnNmZXIoaG9sZGVyLCB0bywgYXNzZXRJZCwgb3BlcmF0b3IsIHVzZXJEYXRhKTsKICB9CgogIC8qKgogICAqIEBkZXYgUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGNvbnRyYWN0IGltcGxlbWVudHMgYGludGVyZmFjZUlEYCBhbmQgYGludGVyZmFjZUlEYCBpcyBub3QgMHhmZmZmZmZmZiwgYGZhbHNlYCBvdGhlcndpc2UKICAgKiBAcGFyYW0gIF9pbnRlcmZhY2VJRCBUaGUgaW50ZXJmYWNlIGlkZW50aWZpZXIsIGFzIHNwZWNpZmllZCBpbiBFUkMtMTY1CiAgICovCiAgZnVuY3Rpb24gc3VwcG9ydHNJbnRlcmZhY2UoYnl0ZXM0IF9pbnRlcmZhY2VJRCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewoKICAgIGlmIChfaW50ZXJmYWNlSUQgPT0gMHhmZmZmZmZmZikgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gX2ludGVyZmFjZUlEID09IDB4MDFmZmM5YTcgfHwgX2ludGVyZmFjZUlEID09IDB4N2MwNjMzYzY7CiAgfQoKICAvLwogIC8vIFV0aWxpdGllcwogIC8vCgogIGZ1bmN0aW9uIF9pc0NvbnRyYWN0KGFkZHJlc3MgYWRkcikgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICB1aW50IHNpemU7CiAgICBhc3NlbWJseSB7IHNpemUgOj0gZXh0Y29kZXNpemUoYWRkcikgfQogICAgcmV0dXJuIHNpemUgPiAwOwogIH0KfQoKLy8gRmlsZTogZXJjODIxL2NvbnRyYWN0cy9JRVJDNzIxRW51bWVyYWJsZS5zb2wKCmNvbnRyYWN0IElFUkM3MjFFbnVtZXJhYmxlIHsKCiAgLyoqCiAgICogQG5vdGljZSBFbnVtZXJhdGUgYWN0aXZlIHRva2VucwogICAqIEBkZXYgVGhyb3dzIGlmIGBpbmRleGAgPj0gYHRvdGFsU3VwcGx5KClgLCBvdGhlcndpc2UgU0hBTEwgTk9UIHRocm93LgogICAqIEBwYXJhbSBpbmRleCBBIGNvdW50ZXIgbGVzcyB0aGFuIGB0b3RhbFN1cHBseSgpYAogICAqIEByZXR1cm4gVGhlIGlkZW50aWZpZXIgZm9yIHRoZSBgaW5kZXhgdGggYXNzZXQsIChzb3J0IG9yZGVyIG5vdAogICAqICBzcGVjaWZpZWQpCiAgICovCiAgLy8gVE9ETyAoZW9yZGFubyk6IE5vdCBpbXBsZW1lbnRlZAogIC8vIGZ1bmN0aW9uIHRva2VuQnlJbmRleCh1aW50MjU2IGluZGV4KSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IF9hc3NldElkKTsKCiAgLyoqCiAgICogQG5vdGljZSBDb3VudCBvZiBvd25lcnMgd2hpY2ggb3duIGF0IGxlYXN0IG9uZSBhc3NldAogICAqICBNdXN0IG5vdCB0aHJvdy4KICAgKiBAcmV0dXJuIEEgY291bnQgb2YgdGhlIG51bWJlciBvZiBvd25lcnMgd2hpY2ggb3duIGFzc2V0CiAgICovCiAgLy8gVE9ETyAoZW9yZGFubyk6IE5vdCBpbXBsZW1lbnRlZAogIC8vIGZ1bmN0aW9uIGNvdW50T2ZPd25lcnMoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IF9jb3VudCk7CgogIC8qKgogICAqIEBub3RpY2UgRW51bWVyYXRlIG93bmVycwogICAqIEBkZXYgVGhyb3dzIGlmIGBpbmRleGAgPj0gYGNvdW50T2ZPd25lcnMoKWAsIG90aGVyd2lzZSBtdXN0IG5vdCB0aHJvdy4KICAgKiBAcGFyYW0gaW5kZXggQSBjb3VudGVyIGxlc3MgdGhhbiBgY291bnRPZk93bmVycygpYAogICAqIEByZXR1cm4gVGhlIGFkZHJlc3Mgb2YgdGhlIGBpbmRleGB0aCBvd25lciAoc29ydCBvcmRlciBub3Qgc3BlY2lmaWVkKQogICAqLwogIC8vIFRPRE8gKGVvcmRhbm8pOiBOb3QgaW1wbGVtZW50ZWQKICAvLyBmdW5jdGlvbiBvd25lckJ5SW5kZXgodWludDI1NiBpbmRleCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBvd25lcik7CgogIC8qKgogICAqIEBub3RpY2UgR2V0IGFsbCB0b2tlbnMgb2YgYSBnaXZlbiBhZGRyZXNzCiAgICogQGRldiBUaGlzIGlzIG5vdCBpbnRlbmRlZCB0byBiZSB1c2VkIG9uLWNoYWluCiAgICogQHBhcmFtIG93bmVyIGFkZHJlc3Mgb2YgdGhlIG93bmVyIHRvIHF1ZXJ5CiAgICogQHJldHVybiBhIGxpc3Qgb2YgYWxsIGFzc2V0SWRzIG9mIGEgdXNlcgogICAqLwogIGZ1bmN0aW9uIHRva2Vuc09mKGFkZHJlc3Mgb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTZbXSk7CgogIC8qKgogICAqIEBub3RpY2UgRW51bWVyYXRlIHRva2VucyBhc3NpZ25lZCB0byBhbiBvd25lcgogICAqIEBkZXYgVGhyb3dzIGlmIGBpbmRleGAgPj0gYGJhbGFuY2VPZihvd25lcilgIG9yIGlmCiAgICogIGBvd25lcmAgaXMgdGhlIHplcm8gYWRkcmVzcywgcmVwcmVzZW50aW5nIGludmFsaWQgYXNzZXRzLgogICAqICBPdGhlcndpc2UgdGhpcyBtdXN0IG5vdCB0aHJvdy4KICAgKiBAcGFyYW0gb3duZXIgQW4gYWRkcmVzcyB3aGVyZSB3ZSBhcmUgaW50ZXJlc3RlZCBpbiBhc3NldHMgb3duZWQgYnkgdGhlbQogICAqIEBwYXJhbSBpbmRleCBBIGNvdW50ZXIgbGVzcyB0aGFuIGBiYWxhbmNlT2Yob3duZXIpYAogICAqIEByZXR1cm4gVGhlIGlkZW50aWZpZXIgZm9yIHRoZSBgaW5kZXhgdGggYXNzZXQgYXNzaWduZWQgdG8gYG93bmVyYCwKICAgKiAgIChzb3J0IG9yZGVyIG5vdCBzcGVjaWZpZWQpCiAgICovCiAgZnVuY3Rpb24gdG9rZW5PZk93bmVyQnlJbmRleCgKICAgIGFkZHJlc3Mgb3duZXIsIHVpbnQyNTYgaW5kZXgKICApIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgdG9rZW5JZCk7Cn0KCi8vIEZpbGU6IGVyYzgyMS9jb250cmFjdHMvRVJDNzIxRW51bWVyYWJsZS5zb2wKCmNvbnRyYWN0IEVSQzcyMUVudW1lcmFibGUgaXMgQXNzZXRSZWdpc3RyeVN0b3JhZ2UsIElFUkM3MjFFbnVtZXJhYmxlIHsKCiAgLyoqCiAgICogQG5vdGljZSBHZXQgYWxsIHRva2VucyBvZiBhIGdpdmVuIGFkZHJlc3MKICAgKiBAZGV2IFRoaXMgaXMgbm90IGludGVuZGVkIHRvIGJlIHVzZWQgb24tY2hhaW4KICAgKiBAcGFyYW0gb3duZXIgYWRkcmVzcyBvZiB0aGUgb3duZXIgdG8gcXVlcnkKICAgKiBAcmV0dXJuIGEgbGlzdCBvZiBhbGwgYXNzZXRJZHMgb2YgYSB1c2VyCiAgICovCiAgZnVuY3Rpb24gdG9rZW5zT2YoYWRkcmVzcyBvd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NltdKSB7CiAgICByZXR1cm4gX2Fzc2V0c09mW293bmVyXTsKICB9CgogIC8qKgogICAqIEBub3RpY2UgRW51bWVyYXRlIHRva2VucyBhc3NpZ25lZCB0byBhbiBvd25lcgogICAqIEBkZXYgVGhyb3dzIGlmIGBpbmRleGAgPj0gYGJhbGFuY2VPZihvd25lcilgIG9yIGlmCiAgICogIGBvd25lcmAgaXMgdGhlIHplcm8gYWRkcmVzcywgcmVwcmVzZW50aW5nIGludmFsaWQgYXNzZXRzLgogICAqICBPdGhlcndpc2UgdGhpcyBtdXN0IG5vdCB0aHJvdy4KICAgKiBAcGFyYW0gb3duZXIgQW4gYWRkcmVzcyB3aGVyZSB3ZSBhcmUgaW50ZXJlc3RlZCBpbiBhc3NldHMgb3duZWQgYnkgdGhlbQogICAqIEBwYXJhbSBpbmRleCBBIGNvdW50ZXIgbGVzcyB0aGFuIGBiYWxhbmNlT2Yob3duZXIpYAogICAqIEByZXR1cm4gVGhlIGlkZW50aWZpZXIgZm9yIHRoZSBgaW5kZXhgdGggYXNzZXQgYXNzaWduZWQgdG8gYG93bmVyYCwKICAgKiAgIChzb3J0IG9yZGVyIG5vdCBzcGVjaWZpZWQpCiAgICovCiAgZnVuY3Rpb24gdG9rZW5PZk93bmVyQnlJbmRleCgKICAgIGFkZHJlc3Mgb3duZXIsIHVpbnQyNTYgaW5kZXgKICAgICkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBhc3NldElkKQogIHsKICAgIHJlcXVpcmUoaW5kZXggPCBfYXNzZXRzT2Zbb3duZXJdLmxlbmd0aCk7CiAgICByZXF1aXJlKGluZGV4IDwgKDE8PDEyNykpOwogICAgcmV0dXJuIF9hc3NldHNPZltvd25lcl1baW5kZXhdOwogIH0KCn0KCi8vIEZpbGU6IGVyYzgyMS9jb250cmFjdHMvSUVSQzcyMU1ldGFkYXRhLnNvbAoKY29udHJhY3QgSUVSQzcyMU1ldGFkYXRhIHsKCiAgLyoqCiAgICogQG5vdGljZSBBIGRlc2NyaXB0aXZlIG5hbWUgZm9yIGEgY29sbGVjdGlvbiBvZiBORlRzIGluIHRoaXMgY29udHJhY3QKICAgKi8KICBmdW5jdGlvbiBuYW1lKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nKTsKCiAgLyoqCiAgICogQG5vdGljZSBBbiBhYmJyZXZpYXRlZCBuYW1lIGZvciBORlRzIGluIHRoaXMgY29udHJhY3QKICAgKi8KICBmdW5jdGlvbiBzeW1ib2woKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcpOwoKICAvKioKICAgKiBAbm90aWNlIEEgZGVzY3JpcHRpb24gb2Ygd2hhdCB0aGlzIERBUiBpcyB1c2VkIGZvcgogICAqLwogIGZ1bmN0aW9uIGRlc2NyaXB0aW9uKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nKTsKCiAgLyoqCiAgICogU3RvcmVzIGFyYml0cmFyeSBpbmZvIGFib3V0IGEgdG9rZW4KICAgKi8KICBmdW5jdGlvbiB0b2tlbk1ldGFkYXRhKHVpbnQyNTYgYXNzZXRJZCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nKTsKfQoKLy8gRmlsZTogZXJjODIxL2NvbnRyYWN0cy9FUkM3MjFNZXRhZGF0YS5zb2wKCmNvbnRyYWN0IEVSQzcyMU1ldGFkYXRhIGlzIEFzc2V0UmVnaXN0cnlTdG9yYWdlLCBJRVJDNzIxTWV0YWRhdGEgewogIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBfbmFtZTsKICB9CiAgZnVuY3Rpb24gc3ltYm9sKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nKSB7CiAgICByZXR1cm4gX3N5bWJvbDsKICB9CiAgZnVuY3Rpb24gZGVzY3JpcHRpb24oKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBfZGVzY3JpcHRpb247CiAgfQogIGZ1bmN0aW9uIHRva2VuTWV0YWRhdGEodWludDI1NiBhc3NldElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBfYXNzZXREYXRhW2Fzc2V0SWRdOwogIH0KICBmdW5jdGlvbiBfdXBkYXRlKHVpbnQyNTYgYXNzZXRJZCwgc3RyaW5nIGRhdGEpIGludGVybmFsIHsKICAgIF9hc3NldERhdGFbYXNzZXRJZF0gPSBkYXRhOwogIH0KfQoKLy8gRmlsZTogZXJjODIxL2NvbnRyYWN0cy9GdWxsQXNzZXRSZWdpc3RyeS5zb2wKCmNvbnRyYWN0IEZ1bGxBc3NldFJlZ2lzdHJ5IGlzIEVSQzcyMUJhc2UsIEVSQzcyMUVudW1lcmFibGUsIEVSQzcyMU1ldGFkYXRhIHsKICBmdW5jdGlvbiBGdWxsQXNzZXRSZWdpc3RyeSgpIHB1YmxpYyB7CiAgfQoKICAvKioKICAgKiBAZGV2IE1ldGhvZCB0byBjaGVjayBpZiBhbiBhc3NldCBpZGVudGlmaWVkIGJ5IHRoZSBnaXZlbiBpZCBleGlzdHMgdW5kZXIgdGhpcyBEQVIuCiAgICogQHJldHVybiB1aW50MjU2IHRoZSBhc3NldElkCiAgICovCiAgZnVuY3Rpb24gZXhpc3RzKHVpbnQyNTYgYXNzZXRJZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIF9ob2xkZXJPZlthc3NldElkXSAhPSAwOwogIH0KCiAgZnVuY3Rpb24gZGVjaW1hbHMoKSBwdWJsaWMgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gMDsKICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9sYW5kL0xBTkRSZWdpc3RyeS5zb2wKCmNvbnRyYWN0IExBTkRSZWdpc3RyeSBpcyBTdG9yYWdlLAogIE93bmFibGUsIEZ1bGxBc3NldFJlZ2lzdHJ5LAogIElMQU5EUmVnaXN0cnkKewoKICBmdW5jdGlvbiBpbml0aWFsaXplKGJ5dGVzKSBwdWJsaWMgewogICAgX25hbWUgPSAnRGVjZW50cmFsYW5kIExBTkQnOwogICAgX3N5bWJvbCA9ICdMQU5EJzsKICAgIF9kZXNjcmlwdGlvbiA9ICdDb250cmFjdCB0aGF0IHN0b3JlcyB0aGUgRGVjZW50cmFsYW5kIExBTkQgcmVnaXN0cnknOwogIH0KCiAgbW9kaWZpZXIgb25seVByb3h5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gcHJveHlPd25lcik7CiAgICBfOwogIH0KCiAgLy8KICAvLyBMQU5EIENyZWF0ZSBhbmQgZGVzdHJveQogIC8vCgogIG1vZGlmaWVyIG9ubHlPd25lck9mKHVpbnQyNTYgYXNzZXRJZCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyT2YoYXNzZXRJZCkpOwogICAgXzsKICB9CgogIG1vZGlmaWVyIG9ubHlVcGRhdGVBdXRob3JpemVkKHVpbnQyNTYgdG9rZW5JZCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyT2YodG9rZW5JZCkgfHwgaXNVcGRhdGVBdXRob3JpemVkKG1zZy5zZW5kZXIsIHRva2VuSWQpKTsKICAgIF87CiAgfQoKICBmdW5jdGlvbiBpc1VwZGF0ZUF1dGhvcml6ZWQoYWRkcmVzcyBvcGVyYXRvciwgdWludDI1NiBhc3NldElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gb3BlcmF0b3IgPT0gb3duZXJPZihhc3NldElkKSB8fCB1cGRhdGVPcGVyYXRvclthc3NldElkXSA9PSBvcGVyYXRvcjsKICB9CgogIGZ1bmN0aW9uIGF1dGhvcml6ZURlcGxveShhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgb25seVByb3h5T3duZXIgewogICAgYXV0aG9yaXplZERlcGxveVtiZW5lZmljaWFyeV0gPSB0cnVlOwogIH0KICBmdW5jdGlvbiBmb3JiaWREZXBsb3koYWRkcmVzcyBiZW5lZmljaWFyeSkgcHVibGljIG9ubHlQcm94eU93bmVyIHsKICAgIGF1dGhvcml6ZWREZXBsb3lbYmVuZWZpY2lhcnldID0gZmFsc2U7CiAgfQoKICBmdW5jdGlvbiBhc3NpZ25OZXdQYXJjZWwoaW50IHgsIGludCB5LCBhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgb25seVByb3h5T3duZXIgewogICAgX2dlbmVyYXRlKGVuY29kZVRva2VuSWQoeCwgeSksIGJlbmVmaWNpYXJ5KTsKICB9CgogIGZ1bmN0aW9uIGFzc2lnbk11bHRpcGxlUGFyY2VscyhpbnRbXSB4LCBpbnRbXSB5LCBhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgb25seVByb3h5T3duZXIgewogICAgZm9yICh1aW50IGkgPSAwOyBpIDwgeC5sZW5ndGg7IGkrKykgewogICAgICBfZ2VuZXJhdGUoZW5jb2RlVG9rZW5JZCh4W2ldLCB5W2ldKSwgYmVuZWZpY2lhcnkpOwogICAgfQogIH0KCiAgLy8KICAvLyBJbmFjdGl2ZSBrZXlzIGFmdGVyIDEgeWVhciBsb3NlIG93bmVyc2hpcAogIC8vCgogIGZ1bmN0aW9uIHBpbmcoKSBwdWJsaWMgewogICAgbGF0ZXN0UGluZ1ttc2cuc2VuZGVyXSA9IG5vdzsKICB9CgogIGZ1bmN0aW9uIHNldExhdGVzdFRvTm93KGFkZHJlc3MgdXNlcikgcHVibGljIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBwcm94eU93bmVyIHx8IGlzQXBwcm92ZWRGb3JBbGwobXNnLnNlbmRlciwgdXNlcikpOwogICAgbGF0ZXN0UGluZ1t1c2VyXSA9IG5vdzsKICB9CgogIC8vCiAgLy8gTEFORCBHZXR0ZXJzCiAgLy8KCiAgZnVuY3Rpb24gZW5jb2RlVG9rZW5JZChpbnQgeCwgaW50IHkpIHZpZXcgcHVibGljIHJldHVybnMgKHVpbnQpIHsKICAgIHJldHVybiAoKHVpbnQoeCkgKiBmYWN0b3IpICYgY2xlYXJMb3cpIHwgKHVpbnQoeSkgJiBjbGVhckhpZ2gpOwogIH0KCiAgZnVuY3Rpb24gZGVjb2RlVG9rZW5JZCh1aW50IHZhbHVlKSB2aWV3IHB1YmxpYyByZXR1cm5zIChpbnQsIGludCkgewogICAgdWludCB4ID0gKHZhbHVlICYgY2xlYXJMb3cpID4+IDEyODsKICAgIHVpbnQgeSA9ICh2YWx1ZSAmIGNsZWFySGlnaCk7CiAgICByZXR1cm4gKGV4cGFuZE5lZ2F0aXZlMTI4Qml0Q2FzdCh4KSwgZXhwYW5kTmVnYXRpdmUxMjhCaXRDYXN0KHkpKTsKICB9CgogIGZ1bmN0aW9uIGV4cGFuZE5lZ2F0aXZlMTI4Qml0Q2FzdCh1aW50IHZhbHVlKSBwdXJlIGludGVybmFsIHJldHVybnMgKGludCkgewogICAgaWYgKHZhbHVlICYgKDE8PDEyNykgIT0gMCkgewogICAgICByZXR1cm4gaW50KHZhbHVlIHwgY2xlYXJMb3cpOwogICAgfQogICAgcmV0dXJuIGludCh2YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBleGlzdHMoaW50IHgsIGludCB5KSB2aWV3IHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gZXhpc3RzKGVuY29kZVRva2VuSWQoeCwgeSkpOwogIH0KCiAgZnVuY3Rpb24gb3duZXJPZkxhbmQoaW50IHgsIGludCB5KSB2aWV3IHB1YmxpYyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICByZXR1cm4gb3duZXJPZihlbmNvZGVUb2tlbklkKHgsIHkpKTsKICB9CgogIGZ1bmN0aW9uIG93bmVyT2ZMYW5kTWFueShpbnRbXSB4LCBpbnRbXSB5KSB2aWV3IHB1YmxpYyByZXR1cm5zIChhZGRyZXNzW10pIHsKICAgIHJlcXVpcmUoeC5sZW5ndGggPiAwKTsKICAgIHJlcXVpcmUoeC5sZW5ndGggPT0geS5sZW5ndGgpOwoKICAgIGFkZHJlc3NbXSBtZW1vcnkgYWRkcnMgPSBuZXcgYWRkcmVzc1tdKHgubGVuZ3RoKTsKICAgIGZvciAodWludCBpID0gMDsgaSA8IHgubGVuZ3RoOyBpKyspIHsKICAgICAgYWRkcnNbaV0gPSBvd25lck9mTGFuZCh4W2ldLCB5W2ldKTsKICAgIH0KCiAgICByZXR1cm4gYWRkcnM7CiAgfQoKICBmdW5jdGlvbiBsYW5kT2YoYWRkcmVzcyBvd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAoaW50W10sIGludFtdKSB7CiAgICB1aW50MjU2IGxlbiA9IF9hc3NldHNPZltvd25lcl0ubGVuZ3RoOwogICAgaW50W10gbWVtb3J5IHggPSBuZXcgaW50W10obGVuKTsKICAgIGludFtdIG1lbW9yeSB5ID0gbmV3IGludFtdKGxlbik7CgogICAgaW50IGFzc2V0WDsKICAgIGludCBhc3NldFk7CiAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgICAoYXNzZXRYLCBhc3NldFkpID0gZGVjb2RlVG9rZW5JZChfYXNzZXRzT2Zbb3duZXJdW2ldKTsKICAgICAgeFtpXSA9IGFzc2V0WDsKICAgICAgeVtpXSA9IGFzc2V0WTsKICAgIH0KCiAgICByZXR1cm4gKHgsIHkpOwogIH0KCiAgZnVuY3Rpb24gbGFuZERhdGEoaW50IHgsIGludCB5KSB2aWV3IHB1YmxpYyByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiB0b2tlbk1ldGFkYXRhKGVuY29kZVRva2VuSWQoeCwgeSkpOwogIH0KCiAgLy8KICAvLyBMQU5EIFRyYW5zZmVyCiAgLy8KCiAgZnVuY3Rpb24gdHJhbnNmZXJMYW5kKGludCB4LCBpbnQgeSwgYWRkcmVzcyB0bykgcHVibGljIHsKICAgIHVpbnQyNTYgdG9rZW5JZCA9IGVuY29kZVRva2VuSWQoeCwgeSk7CiAgICBzYWZlVHJhbnNmZXJGcm9tKG93bmVyT2YodG9rZW5JZCksIHRvLCB0b2tlbklkKTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyTWFueUxhbmQoaW50W10geCwgaW50W10geSwgYWRkcmVzcyB0bykgcHVibGljIHsKICAgIHJlcXVpcmUoeC5sZW5ndGggPiAwKTsKICAgIHJlcXVpcmUoeC5sZW5ndGggPT0geS5sZW5ndGgpOwoKICAgIGZvciAodWludCBpID0gMDsgaSA8IHgubGVuZ3RoOyBpKyspIHsKICAgICAgdWludDI1NiB0b2tlbklkID0gZW5jb2RlVG9rZW5JZCh4W2ldLCB5W2ldKTsKICAgICAgc2FmZVRyYW5zZmVyRnJvbShvd25lck9mKHRva2VuSWQpLCB0bywgdG9rZW5JZCk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBzZXRVcGRhdGVPcGVyYXRvcih1aW50MjU2IGFzc2V0SWQsIGFkZHJlc3Mgb3BlcmF0b3IpIHB1YmxpYyBvbmx5T3duZXJPZihhc3NldElkKSB7CiAgICB1cGRhdGVPcGVyYXRvclthc3NldElkXSA9IG9wZXJhdG9yOwogIH0KCiAgLy8KICAvLyBMQU5EIFVwZGF0ZQogIC8vCgogIGZ1bmN0aW9uIHVwZGF0ZUxhbmREYXRhKGludCB4LCBpbnQgeSwgc3RyaW5nIGRhdGEpIHB1YmxpYyBvbmx5VXBkYXRlQXV0aG9yaXplZCAoZW5jb2RlVG9rZW5JZCh4LCB5KSkgewogICAgdWludDI1NiBhc3NldElkID0gZW5jb2RlVG9rZW5JZCh4LCB5KTsKICAgIF91cGRhdGUoYXNzZXRJZCwgZGF0YSk7CgogICAgVXBkYXRlKGFzc2V0SWQsIF9ob2xkZXJPZlthc3NldElkXSwgbXNnLnNlbmRlciwgZGF0YSk7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVNYW55TGFuZERhdGEoaW50W10geCwgaW50W10geSwgc3RyaW5nIGRhdGEpIHB1YmxpYyB7CiAgICByZXF1aXJlKHgubGVuZ3RoID4gMCk7CiAgICByZXF1aXJlKHgubGVuZ3RoID09IHkubGVuZ3RoKTsKICAgIGZvciAodWludCBpID0gMDsgaSA8IHgubGVuZ3RoOyBpKyspIHsKICAgICAgdXBkYXRlTGFuZERhdGEoeFtpXSwgeVtpXSwgZGF0YSk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBfZG9UcmFuc2ZlckZyb20oCiAgICBhZGRyZXNzIGZyb20sCiAgICBhZGRyZXNzIHRvLAogICAgdWludDI1NiBhc3NldElkLAogICAgYnl0ZXMgdXNlckRhdGEsCiAgICBhZGRyZXNzIG9wZXJhdG9yLAogICAgYm9vbCBkb0NoZWNrCiAgKSBpbnRlcm5hbCB7CiAgICB1cGRhdGVPcGVyYXRvclthc3NldElkXSA9IGFkZHJlc3MoMCk7CiAgICBzdXBlci5fZG9UcmFuc2ZlckZyb20oZnJvbSwgdG8sIGFzc2V0SWQsIHVzZXJEYXRhLCBvcGVyYXRvciwgZG9DaGVjayk7CiAgfQp9'.
	

]
