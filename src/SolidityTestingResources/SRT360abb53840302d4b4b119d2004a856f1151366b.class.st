Class {
	#name : #SRT360abb53840302d4b4b119d2004a856f1151366b,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT360abb53840302d4b4b119d2004a856f1151366b >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7Cgpjb250cmFjdCBFUkM3MjEgewogICAgLy8gUmVxdWlyZWQgbWV0aG9kcwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IF90b3RhbFN1cHBseSk7CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgX2JhbGFuY2UpOwogICAgZnVuY3Rpb24gb3duZXJPZih1aW50IF90b2tlbklkKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGFkZHJlc3MgX293bmVyKTsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQgX3Rva2VuSWQpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF90b2tlbklkKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF90b2tlbklkKSBleHRlcm5hbDsKICAgIAogICAgLy8gRXZlbnRzCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9hcHByb3ZlZCwgdWludDI1NiBfdG9rZW5JZCk7CgogICAgLy8gT3B0aW9uYWwgZnVuY3Rpb25zCiAgICAvLyBmdW5jdGlvbiBuYW1lKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nIF9uYW1lKTsKICAgIC8vIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZyBfc3ltYm9sKTsKICAgIC8vIGZ1bmN0aW9uIHRva2VuT2ZPd25lckJ5SW5kZXgoYWRkcmVzcyBfb3duZXIsIHVpbnQgX2luZGV4KSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQgX3Rva2VuSWQpOwogICAgLy8gZnVuY3Rpb24gdG9rZW5NZXRhZGF0YSh1aW50IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcgX2luZm9VcmwpOwp9CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogICAgCiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOyAgICAgIAogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9Cgpjb250cmFjdCBBY2Nlc3NDb250cm9sIGlzIE93bmFibGUgewogICAgCiAgICBib29sIHB1YmxpYyBwYXVzZWQgPSBmYWxzZTsKICAgIAogICAgbW9kaWZpZXIgd2hlblBhdXNlZCB7CiAgICAgICAgcmVxdWlyZShwYXVzZWQpOwogICAgICAgIF87CiAgICB9CiAgICAKICAgIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICAgICAgcmVxdWlyZSghcGF1c2VkKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBwYXVzZSgpIGV4dGVybmFsIG9ubHlPd25lciB3aGVuTm90UGF1c2VkIHsKICAgICAgICBwYXVzZWQgPSB0cnVlOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB1bnBhdXNlKCkgZXh0ZXJuYWwgb25seU93bmVyIHdoZW5QYXVzZWQgewogICAgICAgIHBhdXNlZCA9IGZhbHNlOwogICAgfQogICAgCn0KCmNvbnRyYWN0IERldGFpbEJhc2UgaXMgQWNjZXNzQ29udHJvbCB7CiAgICAKICAgIGV2ZW50IENyZWF0ZShhZGRyZXNzIG93bmVyLCB1aW50MjU2IGRldGFpbElkLCB1aW50MjU2IGRuYSk7CgogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHRva2VuSWQpOwoKICAgIHN0cnVjdCBEZXRhaWwgewogICAgICAgIHVpbnQyNTYgZG5hOwogICAgICAgIHVpbnQyNTYgaWRQYXJlbnQ7CiAgICAgICAgdWludDY0IHJlbGVhc2VUaW1lOwogICAgfQoKICAgIERldGFpbFtdIGRldGFpbHM7CgogICAgbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSBwdWJsaWMgZGV0YWlsSW5kZXhUb093bmVyOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgb3duZXJzaGlwVG9rZW5Db3VudDsKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgcHVibGljIGRldGFpbEluZGV4VG9BcHByb3ZlZDsKCiAgICBmdW5jdGlvbiBfdHJhbnNmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIGludGVybmFsIHsKICAgICAgICBvd25lcnNoaXBUb2tlbkNvdW50W190b10rKzsKICAgICAgICBkZXRhaWxJbmRleFRvT3duZXJbX3Rva2VuSWRdID0gX3RvOwogICAgICAgIGlmIChfZnJvbSAhPSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIG93bmVyc2hpcFRva2VuQ291bnRbX2Zyb21dLS07CiAgICAgICAgICAgIGRlbGV0ZSBkZXRhaWxJbmRleFRvQXBwcm92ZWRbX3Rva2VuSWRdOwogICAgICAgIH0KICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gY3JlYXRlRGV0YWlsKGFkZHJlc3MgX293bmVyLCB1aW50MjU2IF9kbmEpIGludGVybmFsIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAodWludCkgewogICAgICAgIERldGFpbCBtZW1vcnkgX2RldGFpbCA9IERldGFpbChfZG5hLCAwLCB1aW50NjQobm93KSk7CiAgICAgICAgdWludDI1NiBuZXdEZXRhaWxJZCA9IGRldGFpbHMucHVzaChfZGV0YWlsKSAtIDE7CiAgICAgICAgcmVxdWlyZShuZXdEZXRhaWxJZCA9PSB1aW50MjU2KHVpbnQzMihuZXdEZXRhaWxJZCkpKTsKICAgICAgICBDcmVhdGUoX293bmVyLCBuZXdEZXRhaWxJZCwgX2RldGFpbC5kbmEpOwogICAgICAgIF90cmFuc2ZlcigwLCBfb3duZXIsIG5ld0RldGFpbElkKTsKCiAgICAgICAgcmV0dXJuIG5ld0RldGFpbElkOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldERldGFpbCh1aW50IF9pZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiwgdWludDI1NiwgdWludDY0KSB7CiAgICAgICAgcmV0dXJuIChkZXRhaWxzW19pZF0uZG5hLCBkZXRhaWxzW19pZF0uaWRQYXJlbnQsIGRldGFpbHNbX2lkXS5yZWxlYXNlVGltZSk7CiAgICB9CiAgICAKfQoKY29udHJhY3QgQXNzZW1ibHlCYXNlIGlzIERldGFpbEJhc2UgewogICAgICAgIAogICAgc3RydWN0IEFzc2VtYmx5IHsKICAgICAgICB1aW50MjU2IGlkUGFyZW50OwogICAgICAgIHVpbnQyNTYgZG5hOwogICAgICAgIHVpbnQ2NCByZWxlYXNlVGltZTsKICAgICAgICB1aW50NjQgdXBkYXRlVGltZTsKICAgICAgICB1aW50NjQgc3RhcnRNaW5pbmdUaW1lOwogICAgICAgIHVpbnQ2NFtdIHNwYXJlczsKICAgICAgICB1aW50OCBjb3VudE1pbmluZ0RldGFpbDsKICAgICAgICB1aW50OCByYW5nOwogICAgfQogICAgCiAgICB1aW50OFtdIHByaXZhdGUgcmFuZ0luZGV4ID0gWwogICAgICAgIDMsCiAgICAgICAgNCwKICAgICAgICA1LAogICAgICAgIDYKICAgIF07CiAgICAKICAgIEFzc2VtYmx5W10gYXNzZW1ibHlzOwogICAgCiAgICBtYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIHB1YmxpYyBhc3NlbWJsSW5kZXhUb093bmVyOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgb3duZXJzaGlwQXNzZW1ibHlDb3VudDsKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgcHVibGljIHJvYm90SW5kZXhUb0FwcHJvdmVkOwogICAgCiAgICBmdW5jdGlvbiBnYXRoZXJEZXRhaWxzKHVpbnQ2NFtdIF9hcnJJZERldGFpbHMpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKHVpbnQpIHsKICAgICAgICAKICAgICAgICByZXF1aXJlKF9hcnJJZERldGFpbHMubGVuZ3RoID09IDcpOwogICAgICAgIAogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IF9hcnJJZERldGFpbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgX2NoZWNrRGV0YWlsKF9hcnJJZERldGFpbHNbaV0sIHVpbnQ4KGkrMSkpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBBc3NlbWJseSBtZW1vcnkgX2FzcyA9IEFzc2VtYmx5KDAsIF9tYWtlRG5hKF9hcnJJZERldGFpbHMpLCB1aW50NjQobm93KSwgdWludDY0KG5vdyksIDAsIF9hcnJJZERldGFpbHMsIDAsICBfcmFuZ2UoX2FycklkRGV0YWlscykpOwogICAgICAgIAogICAgICAgIHVpbnQyNTYgbmV3QXNzZW1ibHlJZCA9IGFzc2VtYmx5cy5wdXNoKF9hc3MpIC0gMTsKICAgICAgICAKICAgICAgICBmb3IgKHVpbnQgaiA9IDA7IGogPCBfYXJySWREZXRhaWxzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGRldGFpbHNbX2FycklkRGV0YWlsc1tqXV0uaWRQYXJlbnQgPSBuZXdBc3NlbWJseUlkOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBhc3NlbWJsSW5kZXhUb093bmVyW25ld0Fzc2VtYmx5SWRdID0gbXNnLnNlbmRlcjsKICAgICAgICBvd25lcnNoaXBBc3NlbWJseUNvdW50W21zZy5zZW5kZXJdKys7CiAgICAgICAgCiAgICAgICAgcmV0dXJuIG5ld0Fzc2VtYmx5SWQ7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNoYW5nZUFzc2VtYmx5KHVpbnQgX2lkLCB1aW50NjRbXSBfaW5kZXgsIHVpbnQ2NFtdIF9hcnJJZFJlcGxhY2UpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHsKICAgICAgICByZXF1aXJlKF9pbmRleC5sZW5ndGggPT0gX2FycklkUmVwbGFjZS5sZW5ndGggJiYKICAgICAgICAgICAgICAgIGFzc2VtYmxJbmRleFRvT3duZXJbX2lkXSA9PSBtc2cuc2VuZGVyICYmCiAgICAgICAgICAgICAgICBhc3NlbWJseXNbX2lkXS5zdGFydE1pbmluZ1RpbWUgPT0gMCk7CiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgX2FycklkUmVwbGFjZS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBfY2hlY2tEZXRhaWwoX2FycklkUmVwbGFjZVtpXSwgdWludDgoX2luZGV4W2ldICsgMSkpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBBc3NlbWJseSBzdG9yYWdlIF9hc3NTdG9yYWdlID0gYXNzZW1ibHlzW19pZF07CiAgICAgICAgCiAgICAgICAgZm9yICh1aW50IGogPSAwOyBqIDwgX2luZGV4Lmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGRldGFpbHNbX2Fzc1N0b3JhZ2Uuc3BhcmVzW19pbmRleFtqXV1dLmlkUGFyZW50ID0gMDsKICAgICAgICAgICAgX2Fzc1N0b3JhZ2Uuc3BhcmVzW19pbmRleFtqXV0gPSBfYXJySWRSZXBsYWNlW2pdOwogICAgICAgICAgICBkZXRhaWxzW19hcnJJZFJlcGxhY2Vbal1dLmlkUGFyZW50ID0gX2lkOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBfYXNzU3RvcmFnZS5kbmEgPSBfbWFrZURuYShfYXNzU3RvcmFnZS5zcGFyZXMpOwogICAgICAgIF9hc3NTdG9yYWdlLnVwZGF0ZVRpbWUgPSB1aW50NjQobm93KTsKICAgICAgICBfYXNzU3RvcmFnZS5yYW5nID0gX3JhbmdlKF9hc3NTdG9yYWdlLnNwYXJlcyk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHN0YXJ0TWluaW5nKHVpbnQgX2lkKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXF1aXJlKGFzc2VtYmxJbmRleFRvT3duZXJbX2lkXSA9PSBtc2cuc2VuZGVyICYmCiAgICAgICAgICAgICAgICBhc3NlbWJseXNbX2lkXS5yYW5nID4gMCAmJgogICAgICAgICAgICAgICAgYXNzZW1ibHlzW19pZF0uc3RhcnRNaW5pbmdUaW1lID09IDApOwogICAgICAgIGFzc2VtYmx5c1tfaWRdLnN0YXJ0TWluaW5nVGltZSA9IHVpbnQ2NChub3cpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRBc3NlbWJseSh1aW50IF9pZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiwgdWludDY0LCB1aW50NjQsIHVpbnQ2NCwgdWludDY0W10sIHVpbnQ4LCB1aW50OCkgewogICAgICAgIHJldHVybiAoYXNzZW1ibHlzW19pZF0uZG5hLAogICAgICAgICAgICAgICAgYXNzZW1ibHlzW19pZF0ucmVsZWFzZVRpbWUsCiAgICAgICAgICAgICAgICBhc3NlbWJseXNbX2lkXS51cGRhdGVUaW1lLAogICAgICAgICAgICAgICAgYXNzZW1ibHlzW19pZF0uc3RhcnRNaW5pbmdUaW1lLAogICAgICAgICAgICAgICAgYXNzZW1ibHlzW19pZF0uc3BhcmVzLAogICAgICAgICAgICAgICAgYXNzZW1ibHlzW19pZF0uY291bnRNaW5pbmdEZXRhaWwsCiAgICAgICAgICAgICAgICBhc3NlbWJseXNbX2lkXS5yYW5nKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0QWxsQXNzZW1ibHkoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnModWludFtdLCB1aW50W10sIHVpbnRbXSkgewogICAgICAgIHVpbnRbXSBtZW1vcnkgcmVzdWx0SW5kZXggPSBuZXcgdWludFtdKG93bmVyc2hpcEFzc2VtYmx5Q291bnRbX293bmVyXSk7CiAgICAgICAgdWludFtdIG1lbW9yeSByZXN1bHREbmEgPSBuZXcgdWludFtdKG93bmVyc2hpcEFzc2VtYmx5Q291bnRbX293bmVyXSk7CiAgICAgICAgdWludFtdIG1lbW9yeSByZXN1bHRSYW5nID0gbmV3IHVpbnRbXShvd25lcnNoaXBBc3NlbWJseUNvdW50W19vd25lcl0pOwogICAgICAgIHVpbnQgY291bnRlciA9IDA7CiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgYXNzZW1ibHlzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBpZiAoYXNzZW1ibEluZGV4VG9Pd25lcltpXSA9PSBfb3duZXIpIHsKICAgICAgICAgICAgcmVzdWx0SW5kZXhbY291bnRlcl0gPSBpOyAvLyBpbmRleAogICAgICAgICAgICByZXN1bHREbmFbY291bnRlcl0gPSBhc3NlbWJseXNbaV0uZG5hOwogICAgICAgICAgICByZXN1bHRSYW5nW2NvdW50ZXJdID0gYXNzZW1ibHlzW2ldLnJhbmc7CiAgICAgICAgICAgIGNvdW50ZXIrKzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIChyZXN1bHRJbmRleCwgcmVzdWx0RG5hLCByZXN1bHRSYW5nKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gX2NoZWNrRGV0YWlsKHVpbnQgX2lkLCB1aW50OCBfbWFzaykgaW50ZXJuYWwgdmlldyB7CiAgICAgICAgcmVxdWlyZShkZXRhaWxJbmRleFRvT3duZXJbX2lkXSA9PSBtc2cuc2VuZGVyCiAgICAgICAgJiYgZGV0YWlsc1tfaWRdLmlkUGFyZW50ID09IDAKICAgICAgICAmJiBkZXRhaWxzW19pZF0uZG5hIC8gMTAwMCA9PSBfbWFzayk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIF9pc0Nhbk1pbmluZyh1aW50NjRbXSBtZW1vcnkgX2FycklkRGV0YWlscykgaW50ZXJuYWwgdmlldyByZXR1cm5zKHVpbnQpIHsKICAgICAgICB1aW50IF9jaCA9IGRldGFpbHNbX2FycklkRGV0YWlsc1tpXV0uZG5hICUgMTAwOwogICAgICAgIGZvciAodWludCBpID0gMTsgaSA8IF9hcnJJZERldGFpbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKF9jaCAhPSBkZXRhaWxzW19hcnJJZERldGFpbHNbaV1dLmRuYSAlIDEwMCkgewogICAgICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9jaDsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gY29zdFJlY2hhcmdlKHVpbnQgX3JvYm90SWQpIHB1YmxpYyB2aWV3IHJldHVybnModWludCkgewogICAgICAgIHVpbnQ4IF9yYW5nID0gYXNzZW1ibHlzW19yb2JvdElkXS5yYW5nOwogICAgICAgIGlmIChfcmFuZyA9PSAzKSB7CiAgICAgICAgICAgIHJldHVybiAwLjAxNSBldGhlcjsKICAgICAgICB9IGVsc2UgaWYgKF9yYW5nID09IDQpIHsKICAgICAgICAgICAgcmV0dXJuIDAuMDIgZXRoZXI7CiAgICAgICAgfSBlbHNlIGlmIChfcmFuZyA9PSA1KSB7CiAgICAgICAgICAgIHJldHVybiAwLjAyNSBldGhlcjsKICAgICAgICB9IGVsc2UgaWYgKF9yYW5nID09IDYpIHsKICAgICAgICAgICAgcmV0dXJuIDAuMDI1IGV0aGVyOwogICAgICAgIH0KICAgIH0KICAgIAogICAgZnVuY3Rpb24gX3JhbmdlKHVpbnQ2NFtdIG1lbW9yeSBfYXJySWREZXRhaWxzKSBpbnRlcm5hbCB2aWV3IHJldHVybnModWludDgpIHsKICAgICAgICB1aW50OCByYW5nOwogICAgICAgIHVpbnQgX2NoID0gX2lzQ2FuTWluaW5nKF9hcnJJZERldGFpbHMpOwogICAgICAgIGlmIChfY2ggPT0gMCkgewogICAgICAgICAgICByYW5nID0gMDsKICAgICAgICB9IGVsc2UgaWYgKF9jaCA8IDI5KSB7CiAgICAgICAgICAgIHJhbmcgPSByYW5nSW5kZXhbMF07CiAgICAgICAgfSBlbHNlIGlmIChfY2ggPiAyOCAmJiBfY2ggPCAzNykgewogICAgICAgICAgICByYW5nID0gcmFuZ0luZGV4WzFdOwogICAgICAgIH0gZWxzZSBpZiAoX2NoID4gMzYgJiYgX2NoIDwgNDApIHsKICAgICAgICAgICAgcmFuZyA9IHJhbmdJbmRleFsyXTsKICAgICAgICB9IGVsc2UgaWYgKF9jaCA8IDM5KSB7CiAgICAgICAgICAgIHJhbmcgPSByYW5nSW5kZXhbM107CiAgICAgICAgfQogICAgICAgIHJldHVybiByYW5nOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBfbWFrZURuYSh1aW50NjRbXSBtZW1vcnkgX2FycklkRGV0YWlscykgaW50ZXJuYWwgdmlldyByZXR1cm5zKHVpbnQpIHsKICAgICAgICB1aW50IF9kbmEgPSAwOwogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IF9hcnJJZERldGFpbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgX2RuYSArPSBkZXRhaWxzW19hcnJJZERldGFpbHNbaV1dLmRuYSAqICgxMDAwMCAqKiBpKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9kbmE7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIF90cmFuc2ZlclJvYm90KGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF9yb2JvdElkKSBpbnRlcm5hbCB7CiAgICAgICAgb3duZXJzaGlwQXNzZW1ibHlDb3VudFtfdG9dKys7CiAgICAgICAgYXNzZW1ibEluZGV4VG9Pd25lcltfcm9ib3RJZF0gPSBfdG87CiAgICAgICAgaWYgKF9mcm9tICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgb3duZXJzaGlwQXNzZW1ibHlDb3VudFtfZnJvbV0tLTsKICAgICAgICAgICAgZGVsZXRlIHJvYm90SW5kZXhUb0FwcHJvdmVkW19yb2JvdElkXTsKICAgICAgICB9CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3JvYm90SWQpOwogICAgfQogICAgCn0KCmNvbnRyYWN0IEJhc2VDb250cmFjdCBpcyBBc3NlbWJseUJhc2UsIEVSQzcyMSB7CiAgICAKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwogICAgYWRkcmVzcyB3YWxsZXQxOwogICAgYWRkcmVzcyB3YWxsZXQyOwogICAgYWRkcmVzcyB3YWxsZXQzOwogICAgYWRkcmVzcyB3YWxsZXQ0OwogICAgYWRkcmVzcyB3YWxsZXQ1OwogICAgCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiUm9ib3RzIENyeXB0byI7CiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJSQyI7CgogICAgdWludFtdIGRIZWFkOwogICAgdWludFtdIGRIb3VzaW5nOwogICAgdWludFtdIGRMZWZ0SGFuZDsKICAgIHVpbnRbXSBkUmlnaHRIYW5kOwogICAgdWludFtdIGRQZWx2aWM7CiAgICB1aW50W10gZExlZnRMZWc7CiAgICB1aW50W10gZFJpZ2h0TGVnOwogICAgCiAgICB1aW50IHJhbmROb25jZSA9IDA7CgogICAgZnVuY3Rpb24gQmFzZUNvbnRyYWN0KCkgcHVibGljIHsKICAgICAgICBEZXRhaWwgbWVtb3J5IF9kZXRhaWwgPSBEZXRhaWwoMCwgMCwgMCk7CiAgICAgICAgZGV0YWlscy5wdXNoKF9kZXRhaWwpOwogICAgICAgIEFzc2VtYmx5IG1lbW9yeSBfYXNzID0gQXNzZW1ibHkoMCwgMCwgMCwgMCwgMCwgbmV3IHVpbnQ2NFtdKDApLCAwLCAwKTsKICAgICAgICBhc3NlbWJseXMucHVzaChfYXNzKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2Zlck9uV2FsbGV0KCkgcHVibGljIHBheWFibGUgewogICAgICAgIHVpbnQgdmFsdWU4NCA9IG1zZy52YWx1ZS5tdWwoODQpLmRpdigxMDApOwogICAgICAgIHVpbnQgdmFsNzkgPSBtc2cudmFsdWUubXVsKDc5KS5kaXYoMTAwKTsKICAgICAgICAKICAgICAgICB3YWxsZXQxLnRyYW5zZmVyKG1zZy52YWx1ZSAtIHZhbHVlODQpOwogICAgICAgIHdhbGxldDIudHJhbnNmZXIobXNnLnZhbHVlIC0gdmFsNzkpOwogICAgICAgIHdhbGxldDMudHJhbnNmZXIobXNnLnZhbHVlIC0gdmFsNzkpOwogICAgICAgIHdhbGxldDQudHJhbnNmZXIobXNnLnZhbHVlIC0gdmFsNzkpOwogICAgICAgIHdhbGxldDUudHJhbnNmZXIobXNnLnZhbHVlIC0gdmFsNzkpOwogICAgICAgIAogICAgfQogICAgCiAgICBmdW5jdGlvbiBzZXRXYWxsZXQoYWRkcmVzcyBfd2FsbDEsIGFkZHJlc3MgX3dhbGwyLCBhZGRyZXNzIF93YWxsMywgYWRkcmVzcyBfd2FsbDQsIGFkZHJlc3MgX3dhbGw1KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICB3YWxsZXQxID0gX3dhbGwxOwogICAgICAgIHdhbGxldDIgPSBfd2FsbDI7CiAgICAgICAgd2FsbGV0MyA9IF93YWxsMzsKICAgICAgICB3YWxsZXQ0ID0gX3dhbGw0OwogICAgICAgIHdhbGxldDUgPSBfd2FsbDU7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIF9vd25zKGFkZHJlc3MgX2NsYWltYW50LCB1aW50MjU2IF90b2tlbklkKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gZGV0YWlsSW5kZXhUb093bmVyW190b2tlbklkXSA9PSBfY2xhaW1hbnQ7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIF9vd25zUm9ib3QoYWRkcmVzcyBfY2xhaW1hbnQsIHVpbnQyNTYgX3JvYm90SWQpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBhc3NlbWJsSW5kZXhUb093bmVyW19yb2JvdElkXSA9PSBfY2xhaW1hbnQ7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIF9hcHByb3ZlZEZvcihhZGRyZXNzIF9jbGFpbWFudCwgdWludDI1NiBfdG9rZW5JZCkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIGRldGFpbEluZGV4VG9BcHByb3ZlZFtfdG9rZW5JZF0gPT0gX2NsYWltYW50OwogICAgfQoKICAgIGZ1bmN0aW9uIF9hcHByb3ZlKHVpbnQyNTYgX3Rva2VuSWQsIGFkZHJlc3MgX2FwcHJvdmVkKSBpbnRlcm5hbCB7CiAgICAgICAgZGV0YWlsSW5kZXhUb0FwcHJvdmVkW190b2tlbklkXSA9IF9hcHByb3ZlZDsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gX2FwcHJvdmVSb2JvdCh1aW50MjU2IF9yb2JvdElkLCBhZGRyZXNzIF9hcHByb3ZlZCkgaW50ZXJuYWwgewogICAgICAgIHJvYm90SW5kZXhUb0FwcHJvdmVkW19yb2JvdElkXSA9IF9hcHByb3ZlZDsKICAgIH0KCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgY291bnQpIHsKICAgICAgICByZXR1cm4gb3duZXJzaGlwVG9rZW5Db3VudFtfb3duZXJdOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBiYWxhbmNlT2ZSb2JvdHMoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgY291bnQpIHsKICAgICAgICByZXR1cm4gb3duZXJzaGlwQXNzZW1ibHlDb3VudFtfb3duZXJdOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKAogICAgICAgIGFkZHJlc3MgX3RvLAogICAgICAgIHVpbnQyNTYgX3Rva2VuSWQKICAgICkKICAgICAgICBleHRlcm5hbAogICAgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3ModGhpcykpOwogICAgICAgIF90cmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF90b2tlbklkKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gdHJhbnNmZXJSb2JvdCgKICAgICAgICBhZGRyZXNzIF90bywKICAgICAgICB1aW50MjU2IF9yb2JvdElkCiAgICApCiAgICAgICAgZXh0ZXJuYWwKICAgIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKHRoaXMpKTsKICAgICAgICBfdHJhbnNmZXJSb2JvdChtc2cuc2VuZGVyLCBfdG8sIF9yb2JvdElkKTsKICAgICAgICB1aW50NjRbXSBzdG9yYWdlIHNwYXJlcyA9IGFzc2VtYmx5c1tfcm9ib3RJZF0uc3BhcmVzOwogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IHNwYXJlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBfdHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBzcGFyZXNbaV0pOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBleHRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShfb3ducyhtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwogICAgICAgIF9hcHByb3ZlKF90b2tlbklkLCBfdG8pOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF90bywgX3Rva2VuSWQpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBhcHByb3ZlUm9ib3QoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3JvYm90SWQpIGV4dGVybmFsIHsKICAgICAgICByZXF1aXJlKF9vd25zUm9ib3QobXNnLnNlbmRlciwgX3JvYm90SWQpKTsKICAgICAgICBfYXBwcm92ZVJvYm90KF9yb2JvdElkLCBfdG8pOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF90bywgX3JvYm90SWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbSgKICAgICAgICBhZGRyZXNzIF9mcm9tLAogICAgICAgIGFkZHJlc3MgX3RvLAogICAgICAgIHVpbnQyNTYgX3Rva2VuSWQKICAgICkKICAgICAgICBleHRlcm5hbAogICAgICAgIAogICAgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX293bnMoX2Zyb20sIF90b2tlbklkKSk7CiAgICAgICAgX3RyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tUm9ib3QoCiAgICAgICAgYWRkcmVzcyBfZnJvbSwKICAgICAgICBhZGRyZXNzIF90bywKICAgICAgICB1aW50MjU2IF9yb2JvdElkCiAgICApCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICAKICAgIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF9vd25zUm9ib3QoX2Zyb20sIF9yb2JvdElkKSk7CgogICAgICAgIF90cmFuc2ZlclJvYm90KF9mcm9tLCBfdG8sIF9yb2JvdElkKTsKICAgICAgICBvd25lcnNoaXBUb2tlbkNvdW50W19mcm9tXSAtPSA3OwogICAgfQoKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBkZXRhaWxzLmxlbmd0aCAtIDE7CiAgICB9CgogICAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF90b2tlbklkKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnMgKGFkZHJlc3Mgb3duZXIpCiAgICB7CiAgICAgICAgb3duZXIgPSBkZXRhaWxJbmRleFRvT3duZXJbX3Rva2VuSWRdOwogICAgICAgIHJlcXVpcmUob3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIG93bmVyT2ZSb2JvdCh1aW50MjU2IF9yb2JvdElkKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnMgKGFkZHJlc3Mgb3duZXIpCiAgICB7CiAgICAgICAgb3duZXIgPSBhc3NlbWJsSW5kZXhUb093bmVyW19yb2JvdElkXTsKICAgICAgICByZXF1aXJlKG93bmVyICE9IGFkZHJlc3MoMCkpOwogICAgfQoKCiAgICBmdW5jdGlvbiB0b2tlbnNPZk93bmVyKGFkZHJlc3MgX293bmVyKSBleHRlcm5hbCB2aWV3IHJldHVybnModWludDI1NltdIG93bmVyVG9rZW5zKSB7CiAgICAgICAgdWludDI1NiB0b2tlbkNvdW50ID0gYmFsYW5jZU9mKF9vd25lcik7CgogICAgICAgIGlmICh0b2tlbkNvdW50ID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyB1aW50MjU2W10oMCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdWludDI1NltdIG1lbW9yeSByZXN1bHQgPSBuZXcgdWludDI1NltdKHRva2VuQ291bnQpOwogICAgICAgICAgICB1aW50MjU2IHRvdGFsRGV0YWlscyA9IHRvdGFsU3VwcGx5KCk7CiAgICAgICAgICAgIHVpbnQyNTYgcmVzdWx0SW5kZXggPSAwOwogICAgICAgICAgICB1aW50MjU2IGRldGFpbElkOwoKICAgICAgICAgICAgZm9yIChkZXRhaWxJZCA9IDE7IGRldGFpbElkIDw9IHRvdGFsRGV0YWlsczsgZGV0YWlsSWQrKykgewogICAgICAgICAgICAgICAgaWYgKGRldGFpbEluZGV4VG9Pd25lcltkZXRhaWxJZF0gPT0gX293bmVyKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3Jlc3VsdEluZGV4XSA9IGRldGFpbElkOwogICAgICAgICAgICAgICAgICAgIHJlc3VsdEluZGV4Kys7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgfQogICAgfQogICAgCiAgICBtb2RpZmllciBjYW5NaW5pbmcodWludCBfaWQpIHsKICAgICAgICBpZiAoYXNzZW1ibHlzW19pZF0ucmFuZyA9PSA2KSB7CiAgICAgICAgICAgIHJlcXVpcmUoYXNzZW1ibHlzW19pZF0uY291bnRNaW5pbmdEZXRhaWwgPCAoYXNzZW1ibHlzW19pZF0ucmFuZyAtIDEpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXF1aXJlKGFzc2VtYmx5c1tfaWRdLmNvdW50TWluaW5nRGV0YWlsIDwgYXNzZW1ibHlzW19pZF0ucmFuZyk7CiAgICAgICAgfQogICAgICAgIF87CiAgICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0QWxsSGVhZCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnRbXSkgewogICAgICAgIHJldHVybiBkSGVhZDsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0QWxsSG91c2luZygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnRbXSkgewogICAgICAgIHJldHVybiBkSG91c2luZzsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0QWxsTGVmdEhhbmQoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50W10pIHsKICAgICAgICByZXR1cm4gZExlZnRIYW5kOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRBbGxSaWdodEhhbmQoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50W10pIHsKICAgICAgICByZXR1cm4gZFJpZ2h0SGFuZDsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0QWxsUGVsdmljKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludFtdKSB7CiAgICAgICAgcmV0dXJuIGRQZWx2aWM7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldEFsbExlZnRMZWcoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50W10pIHsKICAgICAgICByZXR1cm4gZExlZnRMZWc7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldEFsbFJpZ2h0TGVnKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludFtdKSB7CiAgICAgICAgcmV0dXJuIGRSaWdodExlZzsKICAgIH0KICAgIAp9Cgpjb250cmFjdCBNYWluQ29udHJhY3QgaXMgQmFzZUNvbnRyYWN0IHsKICAgIAogICAgZXZlbnQgQnV5Q2hlc3RTdWNjZXNzKHVpbnQgY291bnQpOwogICAgCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBvd25lcnNoaXBDaGVzdENvdW50OwogICAgCiAgICAgICAgbW9kaWZpZXIgaXNNdWx0aXBsZVByaWNlKCkgewogICAgICAgIHJlcXVpcmUoKG1zZy52YWx1ZSAlIDAuMSBldGhlcikgPT0gMCk7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgbW9kaWZpZXIgaXNNaW5WYWx1ZSgpIHsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSAwLjEgZXRoZXIpOwogICAgICAgIF87CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGFkZE93bmVyc2hpcENoZXN0KGFkZHJlc3MgX293bmVyLCB1aW50IF9udW0pIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgb3duZXJzaGlwQ2hlc3RDb3VudFtfb3duZXJdICs9IF9udW07CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldE15Q2hlc3QoYWRkcmVzcyBfb3duZXIpIGV4dGVybmFsIHZpZXcgcmV0dXJucyh1aW50KSB7CiAgICAgICAgcmV0dXJuIG93bmVyc2hpcENoZXN0Q291bnRbX293bmVyXTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gYnV5Q2hlc3QoKSBwdWJsaWMgcGF5YWJsZSB3aGVuTm90UGF1c2VkIGlzTWluVmFsdWUgaXNNdWx0aXBsZVByaWNlIHsKICAgICAgICB0cmFuc2Zlck9uV2FsbGV0KCk7CiAgICAgICAgdWludCB0b2tlbnMgPSBtc2cudmFsdWUuZGl2KDAuMSBldGhlcik7CiAgICAgICAgb3duZXJzaGlwQ2hlc3RDb3VudFttc2cuc2VuZGVyXSArPSB0b2tlbnM7CiAgICAgICAgQnV5Q2hlc3RTdWNjZXNzKHRva2Vucyk7CiAgICB9CiAgICAKICAgIAogICAgZnVuY3Rpb24gZ2V0TWluaW5nRGV0YWlsKHVpbnQgX2lkKSBwdWJsaWMgY2FuTWluaW5nKF9pZCkgd2hlbk5vdFBhdXNlZCByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXF1aXJlKGFzc2VtYmxJbmRleFRvT3duZXJbX2lkXSA9PSBtc2cuc2VuZGVyKTsKICAgICAgICBpZiAoYXNzZW1ibHlzW19pZF0uc3RhcnRNaW5pbmdUaW1lICsgMjU5MjAwIDw9IG5vdykgewogICAgICAgICAgICBpZiAoYXNzZW1ibHlzW19pZF0ucmFuZyA9PSA2KSB7CiAgICAgICAgICAgICAgICBfZ2VuZXJhdGVEZXRhaWwoNDApOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgX2dlbmVyYXRlRGV0YWlsKDI4KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBhc3NlbWJseXNbX2lkXS5zdGFydE1pbmluZ1RpbWUgPSB1aW50NjQobm93KTsKICAgICAgICAgICAgYXNzZW1ibHlzW19pZF0uY291bnRNaW5pbmdEZXRhaWwrKzsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0QWxsRGV0YWlscyhhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyh1aW50W10sIHVpbnRbXSkgewogICAgICAgIHVpbnRbXSBtZW1vcnkgcmVzdWx0SW5kZXggPSBuZXcgdWludFtdKG93bmVyc2hpcFRva2VuQ291bnRbX293bmVyXSAtIChvd25lcnNoaXBBc3NlbWJseUNvdW50W19vd25lcl0gKiA3KSk7CiAgICAgICAgdWludFtdIG1lbW9yeSByZXN1bHREbmEgPSBuZXcgdWludFtdKG93bmVyc2hpcFRva2VuQ291bnRbX293bmVyXSAtIChvd25lcnNoaXBBc3NlbWJseUNvdW50W19vd25lcl0gKiA3KSk7CiAgICAgICAgdWludCBjb3VudGVyID0gMDsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBkZXRhaWxzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBpZiAoZGV0YWlsSW5kZXhUb093bmVyW2ldID09IF9vd25lciAmJiBkZXRhaWxzW2ldLmlkUGFyZW50ID09IDApIHsKICAgICAgICAgICAgcmVzdWx0SW5kZXhbY291bnRlcl0gPSBpOwogICAgICAgICAgICByZXN1bHREbmFbY291bnRlcl0gPSBkZXRhaWxzW2ldLmRuYTsKICAgICAgICAgICAgY291bnRlcisrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gKHJlc3VsdEluZGV4LCByZXN1bHREbmEpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBfZ2VuZXJhdGVEZXRhaWwodWludCBfcmFuZExpbSkgaW50ZXJuYWwgewogICAgICAgIHVpbnQgX2RuYSA9IHJhbmRNb2QoNyk7CiAgICAgICAgICAgIAogICAgICAgIHVpbnQyNTYgbmV3RGV0YWlsSWQgPSBjcmVhdGVEZXRhaWwobXNnLnNlbmRlciwgKF9kbmEgKiAxMDAwICsgcmFuZE1vZChfcmFuZExpbSkpKTsKICAgICAgICAgICAgICAgIAogICAgICAgIGlmIChfZG5hID09IDEpIHsKICAgICAgICAgICAgZEhlYWQucHVzaChuZXdEZXRhaWxJZCk7CiAgICAgICAgfSBlbHNlIGlmIChfZG5hID09IDIpIHsKICAgICAgICAgICAgZEhvdXNpbmcucHVzaChuZXdEZXRhaWxJZCk7CiAgICAgICAgfSBlbHNlIGlmIChfZG5hID09IDMpIHsKICAgICAgICAgICAgZExlZnRIYW5kLnB1c2gobmV3RGV0YWlsSWQpOwogICAgICAgIH0gZWxzZSBpZiAoX2RuYSA9PSA0KSB7CiAgICAgICAgICAgIGRSaWdodEhhbmQucHVzaChuZXdEZXRhaWxJZCk7CiAgICAgICAgfSBlbHNlIGlmIChfZG5hID09IDUpIHsKICAgICAgICAgICAgZFBlbHZpYy5wdXNoKG5ld0RldGFpbElkKTsKICAgICAgICB9IGVsc2UgaWYgKF9kbmEgPT0gNikgewogICAgICAgICAgICBkTGVmdExlZy5wdXNoKG5ld0RldGFpbElkKTsKICAgICAgICB9IGVsc2UgaWYgKF9kbmEgPT0gNykgewogICAgICAgICAgICBkUmlnaHRMZWcucHVzaChuZXdEZXRhaWxJZCk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jdGlvbiBpbml0KGFkZHJlc3MgX293bmVyLCB1aW50IF9jb2xvcikgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICAKICAgICAgICB1aW50IF9kbmEgPSAxOwogICAgICAgIAogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IDc7IGkrKykgewogICAgICAgICAgICAKICAgICAgICAgICAgdWludDI1NiBuZXdEZXRhaWxJZCA9IGNyZWF0ZURldGFpbChfb3duZXIsIChfZG5hICogMTAwMCArIF9jb2xvcikpOwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKF9kbmEgPT0gMSkgewogICAgICAgICAgICAgICAgZEhlYWQucHVzaChuZXdEZXRhaWxJZCk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoX2RuYSA9PSAyKSB7CiAgICAgICAgICAgICAgICBkSG91c2luZy5wdXNoKG5ld0RldGFpbElkKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChfZG5hID09IDMpIHsKICAgICAgICAgICAgICAgIGRMZWZ0SGFuZC5wdXNoKG5ld0RldGFpbElkKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChfZG5hID09IDQpIHsKICAgICAgICAgICAgICAgIGRSaWdodEhhbmQucHVzaChuZXdEZXRhaWxJZCk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoX2RuYSA9PSA1KSB7CiAgICAgICAgICAgICAgICBkUGVsdmljLnB1c2gobmV3RGV0YWlsSWQpOwogICAgICAgICAgICB9IGVsc2UgaWYgKF9kbmEgPT0gNikgewogICAgICAgICAgICAgICAgZExlZnRMZWcucHVzaChuZXdEZXRhaWxJZCk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoX2RuYSA9PSA3KSB7CiAgICAgICAgICAgICAgICBkUmlnaHRMZWcucHVzaChuZXdEZXRhaWxJZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX2RuYSsrOwogICAgICAgIH0KICAgIH0KICAgIAogICAgZnVuY3Rpb24gcmFuZE1vZCh1aW50IF9tb2R1bHVzKSBpbnRlcm5hbCByZXR1cm5zKHVpbnQpIHsKICAgICAgICByYW5kTm9uY2UrKzsKICAgICAgICByZXR1cm4gKHVpbnQoa2VjY2FrMjU2KG5vdywgbXNnLnNlbmRlciwgcmFuZE5vbmNlKSkgJSBfbW9kdWx1cykgKyAxOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBvcGVuQ2hlc3QoKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCB7CiAgICAgICAgcmVxdWlyZShvd25lcnNoaXBDaGVzdENvdW50W21zZy5zZW5kZXJdID49IDEpOwogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IDU7IGkrKykgewogICAgICAgICAgICBfZ2VuZXJhdGVEZXRhaWwoNDApOwogICAgICAgIH0KICAgICAgICBvd25lcnNoaXBDaGVzdENvdW50W21zZy5zZW5kZXJdLS07CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIG9wZW41Q2hlc3QoKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCB7CiAgICAgICAgcmVxdWlyZShvd25lcnNoaXBDaGVzdENvdW50W21zZy5zZW5kZXJdID49IDUpOwogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IDU7IGkrKykgewogICAgICAgICAgICBvcGVuQ2hlc3QoKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHJlY2hhcmdlUm9ib3QodWludCBfcm9ib3RJZCkgZXh0ZXJuYWwgd2hlbk5vdFBhdXNlZCBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKGFzc2VtYmxJbmRleFRvT3duZXJbX3JvYm90SWRdID09IG1zZy5zZW5kZXIgJiYKICAgICAgICAgICAgICAgIG1zZy52YWx1ZSA9PSBjb3N0UmVjaGFyZ2UoX3JvYm90SWQpKTsKICAgICAgICBpZiAoYXNzZW1ibHlzW19yb2JvdElkXS5yYW5nID09IDYpIHsKICAgICAgICAgICAgcmVxdWlyZShhc3NlbWJseXNbX3JvYm90SWRdLmNvdW50TWluaW5nRGV0YWlsID09IChhc3NlbWJseXNbX3JvYm90SWRdLnJhbmcgLSAxKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVxdWlyZShhc3NlbWJseXNbX3JvYm90SWRdLmNvdW50TWluaW5nRGV0YWlsID09IGFzc2VtYmx5c1tfcm9ib3RJZF0ucmFuZyk7CiAgICAgICAgfSAgIAogICAgICAgIHRyYW5zZmVyT25XYWxsZXQoKTsgICAgICAgIAogICAgICAgIGFzc2VtYmx5c1tfcm9ib3RJZF0uY291bnRNaW5pbmdEZXRhaWwgPSAwOwogICAgICAgIGFzc2VtYmx5c1tfcm9ib3RJZF0uc3RhcnRNaW5pbmdUaW1lID0gMDsKICAgIH0KICAgIAogICAgCn0='.
	

]
