Class {
	#name : #SRT07e9b9a2f6e916b641660f649afcba9b54edb3ef,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT07e9b9a2f6e916b641660f649afcba9b54edb3ef >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7Cgpjb250cmFjdCBPd25hYmxlIAp7CiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKICAgIGFkZHJlc3MgcHVibGljIG5ld093bmVyOwogICAgCiAgICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIAogICAgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5T3duZXIoKSAKICAgIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlT3duZXIoYWRkcmVzcyBfb3duZXIpIG9ubHlPd25lciBwdWJsaWMgCiAgICB7CiAgICAgICAgcmVxdWlyZShfb3duZXIgIT0gMCk7CiAgICAgICAgbmV3T3duZXIgPSBfb3duZXI7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNvbmZpcm1Pd25lcigpIHB1YmxpYyAKICAgIHsKICAgICAgICByZXF1aXJlKG5ld093bmVyID09IG1zZy5zZW5kZXIpOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICAgICAgZGVsZXRlIG5ld093bmVyOwogICAgfQp9CgoKLyoqCiAqIE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MKICovCmNvbnRyYWN0IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPiAwKTsKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCAKewogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWM7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwogICAgZnVuY3Rpb24gZ2V0RGVjaW1hbHMoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50OCk7CiAgICBmdW5jdGlvbiBnZXRUb3RhbFN1cHBseSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYgc3VwcGx5KTsKfQoKCgpjb250cmFjdCBJenViclRva2VuIGlzIE93bmFibGUsIEVSQzIwLCBTYWZlTWF0aCAKewogICAgc3RyaW5nICBwdWJsaWMgY29uc3RhbnQgc3RhbmRhcmQgICAgPSAnVG9rZW4gMC4xJzsKICAgIHN0cmluZyAgcHVibGljIGNvbnN0YW50IG5hbWUgICAgICAgID0gJ0l6dWJyJzsKICAgIHN0cmluZyAgcHVibGljIGNvbnN0YW50IHN5bWJvbCAgICAgID0gIklaUiI7CiAgICB1aW50OCAgIHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyAgICA9IDE4OwogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgdG9rZW5Lb2VmID0gMTAwMDAwMDAwMDAwMDAwMDAwMDsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIGludGVybmFsIGJhbGFuY2VzOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBwdWJsaWMgYWxsb3dlZDsKCiAgICB1aW50ICAgICAgIHByaXZhdGUgY29uc3RhbnQgZ2FzUHJpY2UgPSAzMDAwMDAwOwoKICAgIHVpbnQyNTYgICAgcHVibGljIGV0aGVyUHJpY2U7CiAgICB1aW50MjU2ICAgIHB1YmxpYyBtaW5pbWFsU3VjY2Vzc1Rva2VuczsKICAgIHVpbnQyNTYgICAgcHVibGljIGNvbGxlY3RlZFRva2VuczsKCiAgICBlbnVtICAgIFN0YXRlIHsgRGlzYWJsZWQsIFByZUlDTywgQ29tcGxldGVQcmVJQ08sIENyb3dkc2FsZSwgRW5hYmxlZCwgTWlncmF0aW9uIH0KICAgIGV2ZW50ICAgTmV3U3RhdGUoU3RhdGUgc3RhdGUpOwoKICAgIFN0YXRlICAgICAgcHVibGljIHN0YXRlID0gU3RhdGUuRGlzYWJsZWQ7CiAgICB1aW50MjU2ICAgIHB1YmxpYyBjcm93ZHNhbGVTdGFydFRpbWU7CiAgICB1aW50MjU2ICAgIHB1YmxpYyBjcm93ZHNhbGVGaW5pc2hUaW1lOwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgIHB1YmxpYyBpbnZlc3RvcnM7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpICBwdWJsaWMgaW52ZXN0b3JzSXRlcjsKICAgIHVpbnQyNTYgICAgICAgICAgICAgICAgICAgICAgIHB1YmxpYyBudW1iZXJPZkludmVzdG9yczsKCiAgICBtb2RpZmllciBvbmx5VG9rZW5Ib2xkZXJzIAogICAgewogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbbXNnLnNlbmRlcl0gIT0gMCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLyBGaXggZm9yIHRoZSBFUkMyMCBzaG9ydCBhZGRyZXNzIGF0dGFjawogICAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgc2l6ZSkgCiAgICB7CiAgICAgICAgcmVxdWlyZShtc2cuZGF0YS5sZW5ndGggPj0gc2l6ZSArIDQpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgZW5hYmxlZFN0YXRlIAogICAgewogICAgICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuRW5hYmxlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBlbmFibGVkT3JNaWdyYXRpb25TdGF0ZSAKICAgIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLkVuYWJsZWQgfHwgc3RhdGUgPT0gU3RhdGUuTWlncmF0aW9uKTsKICAgICAgICBfOwogICAgfQoKCgogICAgZnVuY3Rpb24gZ2V0RGVjaW1hbHMoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50OCkKICAgIHsKICAgICAgICByZXR1cm4gZGVjaW1hbHM7CiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgCiAgICB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW3dob107CiAgICB9CgogICAgZnVuY3Rpb24gaW52ZXN0b3JzQ291bnQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgCiAgICB7CiAgICAgICAgcmV0dXJuIG51bWJlck9mSW52ZXN0b3JzOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkKICAgICAgICBwdWJsaWMgZW5hYmxlZFN0YXRlIG9ubHlQYXlsb2FkU2l6ZSgyICogMzIpIAogICAgewogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlKTsKCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBzdWIoIGJhbGFuY2VzW21zZy5zZW5kZXJdLCBfdmFsdWUgKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYWRkKCBiYWxhbmNlc1tfdG9dLCBfdmFsdWUgKTsKCiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKQogICAgICAgIHB1YmxpYyBlbmFibGVkU3RhdGUgb25seVBheWxvYWRTaXplKDMgKiAzMikgCiAgICB7CiAgICAgICAgcmVxdWlyZShiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlKTsKICAgICAgICByZXF1aXJlKGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSk7CgogICAgICAgIGJhbGFuY2VzW19mcm9tXSA9IHN1YiggYmFsYW5jZXNbX2Zyb21dLCBfdmFsdWUgKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYWRkKCBiYWxhbmNlc1tfdG9dLCBfdmFsdWUgKTsKCiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBzdWIoIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLCBfdmFsdWUgKTsKCiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgZW5hYmxlZFN0YXRlIAogICAgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwoKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyBjb25zdGFudCBlbmFibGVkU3RhdGUKICAgICAgICByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgCiAgICB7CiAgICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgICB9CgoKICAgIAogICAgZnVuY3Rpb24gKCkgcHVibGljIHBheWFibGUKICAgIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLlByZUlDTyB8fCBzdGF0ZSA9PSBTdGF0ZS5Dcm93ZHNhbGUpOwogICAgICAgIHJlcXVpcmUobm93IDwgY3Jvd2RzYWxlRmluaXNoVGltZSk7CgogICAgICAgIHVpbnQyNTYgdmFsdWVXZWkgPSBtc2cudmFsdWU7CgogICAgICAgIHVpbnQyNTYgcHJpY2UgPSBjdXJyZW50UHJpY2UoKTsKCiAgICAgICAgdWludDI1NiB2YWx1ZVRva2VucyA9IGRpdiggbXVsKCB2YWx1ZVdlaSwgcHJpY2UgKSwgMSBldGhlcik7CgogICAgICAgIGlmKCB2YWx1ZVRva2VucyA+IDMzMzMzKnRva2VuS29lZiApIC8vIDUgQlRDCiAgICAgICAgewogICAgICAgICAgICBwcmljZSA9IHByaWNlICogMTEyIC8gMTAwOwogICAgICAgICAgICB2YWx1ZVRva2VucyA9IG11bCggdmFsdWVXZWksIHByaWNlICk7CiAgICAgICAgfQoKICAgICAgICByZXF1aXJlKHZhbHVlVG9rZW5zID4gMTAqdG9rZW5Lb2VmKTsKCgogICAgICAgIGNvbGxlY3RlZFRva2VucyA9IGFkZCggY29sbGVjdGVkVG9rZW5zLCB2YWx1ZVRva2VucyApOwogICAgICAgICAgICAKICAgICAgICBpZihtc2cuZGF0YS5sZW5ndGggPT0gMjApIAogICAgICAgIHsKICAgICAgICAgICAgYWRkcmVzcyByZWZlcmVyID0gYnl0ZXNUb0FkZHJlc3MoYnl0ZXMobXNnLmRhdGEpKTsKCiAgICAgICAgICAgIHJlcXVpcmUocmVmZXJlciAhPSBtc2cuc2VuZGVyKTsKCiAgICAgICAgICAgIG1pbnRUb2tlbnNXaXRoUmVmZXJhbChtc2cuc2VuZGVyLCByZWZlcmVyLCB2YWx1ZVRva2Vucyk7CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIG1pbnRUb2tlbnMobXNnLnNlbmRlciwgdmFsdWVUb2tlbnMpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBieXRlc1RvQWRkcmVzcyhieXRlcyBzb3VyY2UpIGludGVybmFsIHB1cmUgcmV0dXJucyhhZGRyZXNzKSAKICAgIHsKICAgICAgICB1aW50IHJlc3VsdDsKICAgICAgICB1aW50IG11bCA9IDE7CgogICAgICAgIGZvcih1aW50IGkgPSAyMDsgaSA+IDA7IGktLSkgCiAgICAgICAgewogICAgICAgICAgICByZXN1bHQgKz0gdWludDgoc291cmNlW2ktMV0pKm11bDsKICAgICAgICAgICAgbXVsID0gbXVsKjI1NjsKICAgICAgICB9CgogICAgICAgIHJldHVybiBhZGRyZXNzKHJlc3VsdCk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0VG90YWxTdXBwbHkoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHRvdGFsU3VwcGx5OwogICAgfQoKICAgIGZ1bmN0aW9uIGRlcG9zaXRUb2tlbnMoYWRkcmVzcyBfd2hvLCB1aW50MjU2IF92YWx1ZVRva2VucykgcHVibGljIG9ubHlPd25lciAKICAgIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLlByZUlDTyB8fCBzdGF0ZSA9PSBTdGF0ZS5Dcm93ZHNhbGUpOwogICAgICAgIHJlcXVpcmUobm93IDwgY3Jvd2RzYWxlRmluaXNoVGltZSk7CgogICAgICAgIHVpbnQyNTYgYm9udXMgPSBjdXJyZW50Qm9udXMoKTsKICAgICAgICB1aW50MjU2IHRva2VucyA9IF92YWx1ZVRva2VucyAqICgxMDAgKyBib251cykgLyAxMDA7CgogICAgICAgIGNvbGxlY3RlZFRva2VucyA9IGFkZCggY29sbGVjdGVkVG9rZW5zLCB0b2tlbnMgKTsKCiAgICAgICAgbWludFRva2Vucyhfd2hvLCB0b2tlbnMpOwogICAgfQoKCiAgICBmdW5jdGlvbiBib251c0ZvckRhdGUodWludCBkYXRlKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgCiAgICB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5QcmVJQ08gfHwgc3RhdGUgPT0gU3RhdGUuQ3Jvd2RzYWxlKTsKCiAgICAgICAgdWludCBuZGF5ID0gKGRhdGUgLSBjcm93ZHNhbGVTdGFydFRpbWUpIC8gKDEgZGF5cyk7CgogICAgICAgIHVpbnQyNTYgYm9udXMgPSAwOwoKICAgICAgICBpZiAoc3RhdGUgPT0gU3RhdGUuUHJlSUNPKSAKICAgICAgICB7CiAgICAgICAgICAgIGlmKCBuZGF5IDwgNyoxICkgYm9udXMgPSAxMDA7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgaWYoIG5kYXkgPCA3KjIgKSBib251cyA9IDgwOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIGlmKCBuZGF5IDwgNyozICkgYm9udXMgPSA3MDsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICBpZiggbmRheSA8IDcqNCApIGJvbnVzID0gNjA7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgaWYoIG5kYXkgPCA3KjUgKSBib251cyA9IDUwOwogICAgICAgICAgICBlbHNlICAgICAgICAgICAgIGJvbnVzID0gNDA7CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICBpZiAoc3RhdGUgPT0gU3RhdGUuQ3Jvd2RzYWxlKSAKICAgICAgICB7CiAgICAgICAgICAgIGlmKCBuZGF5IDwgMSApIGJvbnVzID0gMjA7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgaWYoIG5kYXkgPCA0ICkgYm9udXMgPSAxNTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICBpZiggbmRheSA8IDggKSBib251cyA9IDEwOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIGlmKCBuZGF5IDwgMTIgKSBib251cyA9IDU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gYm9udXM7CiAgICB9CgogICAgZnVuY3Rpb24gY3VycmVudEJvbnVzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIAogICAgewogICAgICAgIHJldHVybiBib251c0ZvckRhdGUobm93KTsKICAgIH0KCgogICAgZnVuY3Rpb24gcHJpY2VGb3JEYXRlKHVpbnQgZGF0ZSkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIAogICAgewogICAgICAgIHVpbnQyNTYgYm9udXMgPSBib251c0ZvckRhdGUoZGF0ZSk7CgogICAgICAgIHJldHVybiBldGhlclByaWNlICogKDEwMCArIGJvbnVzKSAvIDEwMDsKICAgIH0KCiAgICBmdW5jdGlvbiBjdXJyZW50UHJpY2UoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgCiAgICB7CiAgICAgICAgcmV0dXJuIHByaWNlRm9yRGF0ZShub3cpOwogICAgfQoKCiAgICBmdW5jdGlvbiBtaW50VG9rZW5zKGFkZHJlc3MgX3dobywgdWludDI1NiBfdG9rZW5zKSBpbnRlcm5hbCAKICAgIHsKICAgICAgICB1aW50MjU2IGludiA9IGludmVzdG9yc1tfd2hvXTsKCiAgICAgICAgaWYgKGludiA9PSAwKSAvLyBuZXcgaW52ZXN0b3IKICAgICAgICB7CiAgICAgICAgICAgIGludmVzdG9yc0l0ZXJbbnVtYmVyT2ZJbnZlc3RvcnMrK10gPSBfd2hvOwogICAgICAgIH0KCiAgICAgICAgaW52ID0gYWRkKCBpbnYsIF90b2tlbnMgKTsKICAgICAgICBiYWxhbmNlc1tfd2hvXSA9IGFkZCggYmFsYW5jZXNbX3dob10sIF90b2tlbnMgKTsKCiAgICAgICAgVHJhbnNmZXIodGhpcywgX3dobywgX3Rva2Vucyk7CgogICAgICAgIHRvdGFsU3VwcGx5ID0gYWRkKCB0b3RhbFN1cHBseSwgX3Rva2VucyApOwogICAgfQoKCiAgICBmdW5jdGlvbiBtaW50VG9rZW5zV2l0aFJlZmVyYWwoYWRkcmVzcyBfd2hvLCBhZGRyZXNzIF9yZWZlcmFsLCB1aW50MjU2IF92YWx1ZVRva2VucykgaW50ZXJuYWwgCiAgICB7CiAgICAgICAgdWludDI1NiByZWZlcmVyVG9rZW5zID0gX3ZhbHVlVG9rZW5zICogNSAvIDEwMDsKCiAgICAgICAgdWludDI1NiB2YWx1ZVRva2VucyA9IF92YWx1ZVRva2VucyAqIDEwMyAvIDEwMDsKCiAgICAgICAgbWludFRva2VucyhfcmVmZXJhbCwgcmVmZXJlclRva2Vucyk7CgogICAgICAgIG1pbnRUb2tlbnMoX3dobywgdmFsdWVUb2tlbnMpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBzdGFydFRva2Vuc1NhbGUoCiAgICAgICAgICAgIHVpbnQgICAgX2Nyb3dkc2FsZVN0YXJ0VGltZSwKICAgICAgICAgICAgdWludCAgICBfY3Jvd2RzYWxlRmluaXNoVGltZSwKICAgICAgICAgICAgdWludDI1NiBfbWluaW1hbFN1Y2Nlc3NUb2tlbnMsCiAgICAgICAgICAgIHVpbnQyNTYgX2V0aGVyUHJpY2UpIHB1YmxpYyBvbmx5T3duZXIgCiAgICB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5EaXNhYmxlZCB8fCBzdGF0ZSA9PSBTdGF0ZS5Db21wbGV0ZVByZUlDTyk7CgogICAgICAgIGNyb3dkc2FsZVN0YXJ0VGltZSAgPSBfY3Jvd2RzYWxlU3RhcnRUaW1lOwogICAgICAgIGNyb3dkc2FsZUZpbmlzaFRpbWUgPSBfY3Jvd2RzYWxlRmluaXNoVGltZTsKCiAgICAgICAgZXRoZXJQcmljZSA9IF9ldGhlclByaWNlOwogICAgICAgIGRlbGV0ZSBudW1iZXJPZkludmVzdG9yczsKICAgICAgICBkZWxldGUgY29sbGVjdGVkVG9rZW5zOwoKICAgICAgICBtaW5pbWFsU3VjY2Vzc1Rva2VucyA9IF9taW5pbWFsU3VjY2Vzc1Rva2VuczsKCiAgICAgICAgaWYgKHN0YXRlID09IFN0YXRlLkRpc2FibGVkKSAKICAgICAgICB7CiAgICAgICAgICAgIHN0YXRlID0gU3RhdGUuUHJlSUNPOwogICAgICAgIH0gCiAgICAgICAgZWxzZSAKICAgICAgICB7CiAgICAgICAgICAgIHN0YXRlID0gU3RhdGUuQ3Jvd2RzYWxlOwogICAgICAgIH0KCiAgICAgICAgTmV3U3RhdGUoc3RhdGUpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB0aW1lVG9GaW5pc2hUb2tlbnNTYWxlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludDI1NiB0KSAKICAgIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLlByZUlDTyB8fCBzdGF0ZSA9PSBTdGF0ZS5Dcm93ZHNhbGUpOwoKICAgICAgICBpZiAobm93ID4gY3Jvd2RzYWxlRmluaXNoVGltZSkgCiAgICAgICAgewogICAgICAgICAgICB0ID0gMDsKICAgICAgICB9IAogICAgICAgIGVsc2UgCiAgICAgICAgewogICAgICAgICAgICB0ID0gY3Jvd2RzYWxlRmluaXNoVGltZSAtIG5vdzsKICAgICAgICB9CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGZpbmlzaFRva2Vuc1NhbGUodWludDI1NiBfaW52ZXN0b3JzVG9Qcm9jZXNzKSBwdWJsaWMgCiAgICB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5QcmVJQ08gfHwgc3RhdGUgPT0gU3RhdGUuQ3Jvd2RzYWxlKTsKCiAgICAgICAgcmVxdWlyZShub3cgPj0gY3Jvd2RzYWxlRmluaXNoVGltZSB8fCAKICAgICAgICAgICAgKGNvbGxlY3RlZFRva2VucyA+PSBtaW5pbWFsU3VjY2Vzc1Rva2VucyAmJiBtc2cuc2VuZGVyID09IG93bmVyKSk7CgogICAgICAgIGlmIChjb2xsZWN0ZWRUb2tlbnMgPCBtaW5pbWFsU3VjY2Vzc1Rva2VucykgCiAgICAgICAgewogICAgICAgICAgICAvLyBJbnZlc3RvcnMgY2FuIGdldCB0aGVpciBldGhlciBjYWxsaW5nIHdpdGhkcmF3QmFjaygpIGZ1bmN0aW9uCiAgICAgICAgICAgIHdoaWxlIChfaW52ZXN0b3JzVG9Qcm9jZXNzID4gMCAmJiBudW1iZXJPZkludmVzdG9ycyA+IDApIAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBhZGRyZXNzIGFkZHIgPSBpbnZlc3RvcnNJdGVyWy0tbnVtYmVyT2ZJbnZlc3RvcnNdOwogICAgICAgICAgICAgICAgdWludDI1NiBpbnYgPSBpbnZlc3RvcnNbYWRkcl07CiAgICAgICAgICAgICAgICBiYWxhbmNlc1thZGRyXSA9IHN1YiggYmFsYW5jZXNbYWRkcl0sIGludiApOwogICAgICAgICAgICAgICAgdG90YWxTdXBwbHkgPSBzdWIoIHRvdGFsU3VwcGx5LCBpbnYgKTsKICAgICAgICAgICAgICAgIFRyYW5zZmVyKGFkZHIsIHRoaXMsIGludik7CgogICAgICAgICAgICAgICAgLS1faW52ZXN0b3JzVG9Qcm9jZXNzOwoKICAgICAgICAgICAgICAgIGRlbGV0ZSBpbnZlc3RvcnNJdGVyW251bWJlck9mSW52ZXN0b3JzXTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKG51bWJlck9mSW52ZXN0b3JzID4gMCkgCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHN0YXRlID09IFN0YXRlLlByZUlDTykgCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHN0YXRlID0gU3RhdGUuRGlzYWJsZWQ7CiAgICAgICAgICAgIH0gCiAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHN0YXRlID0gU3RhdGUuQ29tcGxldGVQcmVJQ087CiAgICAgICAgICAgIH0KICAgICAgICB9IAogICAgICAgIGVsc2UgCiAgICAgICAgewogICAgICAgICAgICB3aGlsZSAoX2ludmVzdG9yc1RvUHJvY2VzcyA+IDAgJiYgbnVtYmVyT2ZJbnZlc3RvcnMgPiAwKSAKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgLS1udW1iZXJPZkludmVzdG9yczsKICAgICAgICAgICAgICAgIC0tX2ludmVzdG9yc1RvUHJvY2VzczsKCiAgICAgICAgICAgICAgICBhZGRyZXNzIGkgPSBpbnZlc3RvcnNJdGVyW251bWJlck9mSW52ZXN0b3JzXTsKCiAgICAgICAgICAgICAgICBpbnZlc3RvcnNbaV0gPSAwOwoKICAgICAgICAgICAgICAgIGRlbGV0ZSBpbnZlc3RvcnNbaV07CiAgICAgICAgICAgICAgICBkZWxldGUgaW52ZXN0b3JzSXRlcltudW1iZXJPZkludmVzdG9yc107CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChudW1iZXJPZkludmVzdG9ycyA+IDApIAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChzdGF0ZSA9PSBTdGF0ZS5QcmVJQ08pIAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBzdGF0ZSA9IFN0YXRlLkNvbXBsZXRlUHJlSUNPOwogICAgICAgICAgICB9IAogICAgICAgICAgICBlbHNlIAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYWRkaXRpb25hbCB0b2tlbnMgZm9yIG93bmVyICg0MCUgb2YgY29tcGxldGUgdG90YWxTdXBwbHkpCiAgICAgICAgICAgICAgICB1aW50MjU2IHRva2VucyA9IGRpdiggbXVsKCA0LCB0b3RhbFN1cHBseSApICwgNiApOwogICAgICAgICAgICAgICAgYmFsYW5jZXNbb3duZXJdID0gdG9rZW5zOwogICAgICAgICAgICAgICAgdG90YWxTdXBwbHkgPSBhZGQoIHRvdGFsU3VwcGx5LCB0b2tlbnMgKTsKICAgICAgICAgICAgICAgIFRyYW5zZmVyKHRoaXMsIG93bmVyLCB0b2tlbnMpOwogICAgICAgICAgICAgICAgc3RhdGUgPSBTdGF0ZS5FbmFibGVkOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBOZXdTdGF0ZShzdGF0ZSk7CiAgICB9CiAgICAKICAgIC8vIFRoaXMgZnVuY3Rpb24gbXVzdCBiZSBjYWxsZWQgYnkgdG9rZW4gaG9sZGVyIGluIGNhc2Ugb2YgY3Jvd2RzYWxlIGZhaWxlZAogICAgZnVuY3Rpb24gd2l0aGRyYXdCYWNrKCkgcHVibGljIAogICAgewogICAgICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuRGlzYWJsZWQpOwoKICAgICAgICB1aW50MjU2IHRva2VucyA9IGludmVzdG9yc1ttc2cuc2VuZGVyXTsKICAgICAgICB1aW50MjU2IHZhbHVlID0gZGl2KCB0b2tlbnMsIGV0aGVyUHJpY2UgKTsKCiAgICAgICAgaWYgKHZhbHVlID4gMCkgCiAgICAgICAgewogICAgICAgICAgICBpbnZlc3RvcnNbbXNnLnNlbmRlcl0gPSAwOwogICAgICAgICAgICByZXF1aXJlKCBtc2cuc2VuZGVyLmNhbGwuZ2FzKGdhc1ByaWNlKS52YWx1ZSh2YWx1ZSkoKSApOwoKICAgICAgICAgICAgdG90YWxTdXBwbHkgPSBzdWIoIHRvdGFsU3VwcGx5LCB0b2tlbnMgKTsKICAgICAgICB9CiAgICB9CgogICAgCn0='.
	

]
