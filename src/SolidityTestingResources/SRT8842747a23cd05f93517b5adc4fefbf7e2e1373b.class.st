Class {
	#name : #SRT8842747a23cd05f93517b5adc4fefbf7e2e1373b,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT8842747a23cd05f93517b5adc4fefbf7e2e1373b >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjA7Cgpjb250cmFjdCBHZW5lc2lzUHJvdGVjdGVkIHsKICAgIG1vZGlmaWVyIGFkZHJOb3ROdWxsKGFkZHJlc3MgX2FkZHJlc3MpIHsKICAgICAgICByZXF1aXJlKF9hZGRyZXNzICE9IGFkZHJlc3MoMCkpOwogICAgICAgIF87CiAgICB9Cn0KCgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIFRoZSBvcmlnaW5hbCBjb2RlIGlzIHRha2VuIGZyb206Ci8vIGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHk6Ci8vICAgICBtYXN0ZXIgYnJhbmNoIGZyb20gemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL293bmVyc2hpcC9Pd25hYmxlLnNvbAovLyBDaGFuZ2VkIGZ1bmN0aW9uIG5hbWU6IHRyYW5zZmVyT3duZXJzaGlwIC0+IHNldE93bmVyLgovLyBBZGRlZCBpbmhlcml0YW5jZSBmcm9tIEdlbmVzaXNQcm90ZWN0ZWQgKGFkZHJlc3MgIT0gMHgwKS4KLy8gc2V0T3duZXIgcmVmYWN0b3JlZCBmb3IgZW1pdHRpbmcgYWZ0ZXIgb3duZXIgcmVwbGFjaW5nLgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSBpcyBHZW5lc2lzUHJvdGVjdGVkIHsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwoKICAgIC8qKgogICAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICAgKiBhY2NvdW50LgogICAgICovCiAgICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICAgKi8KICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIF9uZXcuCiAgICAgKiBAcGFyYW0gYSBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldE93bmVyKGFkZHJlc3MgYSkgZXh0ZXJuYWwgb25seU93bmVyIGFkZHJOb3ROdWxsKGEpIHsKICAgICAgICBvd25lciA9IGE7CiAgICAgICAgZW1pdCBPd25lcnNoaXBSZXBsYWNlZChtc2cuc2VuZGVyLCBhKTsKICAgIH0KCiAgICBldmVudCBPd25lcnNoaXBSZXBsYWNlZCgKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIKICAgICk7Cn0KCgpjb250cmFjdCBFbnVtcyB7CiAgICAvLyBUeXBlIGZvciBtYXBwaW5nIHVpbnQgKGluZGV4KSA9PiBuYW1lIGZvciBiYXNrZXRzIHR5cGVzIGRlc2NyaWJlZCBpbiBXUAogICAgZW51bSBCYXNrZXRUeXBlIHsKICAgICAgICB1bmtub3duLCAvLyAwIHVua25vd24KICAgICAgICB0ZWFtLCAvLyAxIFRlYW0KICAgICAgICBmb3VuZGF0aW9uLCAvLyAyIEZvdW5kYXRpb24KICAgICAgICBhcnIsIC8vIDMgQWR2ZXJ0aXNlbWVudCwgUmVmZXJyYWwgcHJvZ3JhbSwgUmV3YXJkCiAgICAgICAgYWR2aXNvcnMsIC8vIDQgQWR2aXNvcnMKICAgICAgICBib3VudHksIC8vIDUgQm91bnR5CiAgICAgICAgcmVmZXJyYWwsIC8vIDYgUmVmZXJyYWwKICAgICAgICByZWZlcnJlciAvLyA3IFJlZmVycmVyCiAgICB9Cn0KCgpjb250cmFjdCBXUFRva2Vuc0Jhc2tldHMgaXMgT3duYWJsZSwgRW51bXMgewogICAgLy8gVGhpcyBtYXBwaW5nIGhvbGRzIGFsbCBhY2NvdW50cyBldmVyIHVzZWQgYXMgYmFza2V0cyBmb3JldmVyCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IEJhc2tldFR5cGUpIGludGVybmFsIHR5cGVzOwoKICAgIC8vIEJhc2tldHMgZm9yIHRva2VucwogICAgYWRkcmVzcyBwdWJsaWMgdGVhbTsKICAgIGFkZHJlc3MgcHVibGljIGZvdW5kYXRpb247CiAgICBhZGRyZXNzIHB1YmxpYyBhcnI7CiAgICBhZGRyZXNzIHB1YmxpYyBhZHZpc29yczsKICAgIGFkZHJlc3MgcHVibGljIGJvdW50eTsKCiAgICAvLyBQdWJsaWMgY29uc3RydWN0b3IKICAgIGZ1bmN0aW9uIFdQVG9rZW5zQmFza2V0cygKICAgICAgICBhZGRyZXNzIF90ZWFtLAogICAgICAgIGFkZHJlc3MgX2ZvdW5kYXRpb24sCiAgICAgICAgYWRkcmVzcyBfYXJyLAogICAgICAgIGFkZHJlc3MgX2Fkdmlzb3JzLAogICAgICAgIGFkZHJlc3MgX2JvdW50eQogICAgKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIHNldFRlYW0oX3RlYW0pOwogICAgICAgIHNldEZvdW5kYXRpb24oX2ZvdW5kYXRpb24pOwogICAgICAgIHNldEFSUihfYXJyKTsKICAgICAgICBzZXRBZHZpc29ycyhfYWR2aXNvcnMpOwogICAgICAgIHNldEJvdW50eShfYm91bnR5KTsKICAgIH0KCiAgICAvLyBGYWxsYmFjayBmdW5jdGlvbiAtIGRvIG5vdCBhcHBseSBhbnkgZXRoZXIgdG8gdGhpcyBjb250cmFjdC4KICAgIGZ1bmN0aW9uICgpIGV4dGVybmFsIHBheWFibGUgewogICAgICAgIHJldmVydCgpOwogICAgfQoKICAgIC8vIExhc3QgcmVzb3J0IHRvIHJldHVybiBldGhlci4KICAgIC8vIFNlZSB0aGUgbGFzdCB3YXJuaW5nIGF0CiAgICAvLyBodHRwOi8vc29saWRpdHkucmVhZHRoZWRvY3MuaW8vZW4vZGV2ZWxvcC9jb250cmFjdHMuaHRtbCNmYWxsYmFjay1mdW5jdGlvbgogICAgLy8gZm9yIHN1Y2ggY2FzZXMuCiAgICBmdW5jdGlvbiB0cmFuc2ZlckV0aGVyVG8oYWRkcmVzcyBhKSBleHRlcm5hbCBvbmx5T3duZXIgYWRkck5vdE51bGwoYSkgewogICAgICAgIGEudHJhbnNmZXIoYWRkcmVzcyh0aGlzKS5iYWxhbmNlKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0eXBlT2YoYWRkcmVzcyBhKSBwdWJsaWMgdmlldyByZXR1cm5zIChCYXNrZXRUeXBlKSB7CiAgICAgICAgcmV0dXJuIHR5cGVzW2FdOwogICAgfQoKICAgIC8vIFJldHVybiB0cnV0aCBpZiBnaXZlbiBhZGRyZXNzIGlzIG5vdCByZWdpc3RlcmVkIGFzIHRva2VuIGJhc2tldC4KICAgIGZ1bmN0aW9uIGlzVW5rbm93bihhZGRyZXNzIGEpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gdHlwZXNbYV0gPT0gQmFza2V0VHlwZS51bmtub3duOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzVGVhbShhZGRyZXNzIGEpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gdHlwZXNbYV0gPT0gQmFza2V0VHlwZS50ZWFtOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzRm91bmRhdGlvbihhZGRyZXNzIGEpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gdHlwZXNbYV0gPT0gQmFza2V0VHlwZS5mb3VuZGF0aW9uOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFRlYW0oYWRkcmVzcyBhKSBwdWJsaWMgb25seU93bmVyIGFkZHJOb3ROdWxsKGEpIHsKICAgICAgICByZXF1aXJlKGlzVW5rbm93bihhKSk7CiAgICAgICAgdHlwZXNbdGVhbSA9IGFdID0gQmFza2V0VHlwZS50ZWFtOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEZvdW5kYXRpb24oYWRkcmVzcyBhKSBwdWJsaWMgb25seU93bmVyIGFkZHJOb3ROdWxsKGEpIHsKICAgICAgICByZXF1aXJlKGlzVW5rbm93bihhKSk7CiAgICAgICAgdHlwZXNbZm91bmRhdGlvbiA9IGFdID0gQmFza2V0VHlwZS5mb3VuZGF0aW9uOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEFSUihhZGRyZXNzIGEpIHB1YmxpYyBvbmx5T3duZXIgYWRkck5vdE51bGwoYSkgewogICAgICAgIHJlcXVpcmUoaXNVbmtub3duKGEpKTsKICAgICAgICB0eXBlc1thcnIgPSBhXSA9IEJhc2tldFR5cGUuYXJyOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEFkdmlzb3JzKGFkZHJlc3MgYSkgcHVibGljIG9ubHlPd25lciBhZGRyTm90TnVsbChhKSB7CiAgICAgICAgcmVxdWlyZShpc1Vua25vd24oYSkpOwogICAgICAgIHR5cGVzW2Fkdmlzb3JzID0gYV0gPSBCYXNrZXRUeXBlLmFkdmlzb3JzOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEJvdW50eShhZGRyZXNzIGEpIHB1YmxpYyBvbmx5T3duZXIgYWRkck5vdE51bGwoYSkgewogICAgICAgIHJlcXVpcmUodHlwZXNbYV0gPT0gQmFza2V0VHlwZS51bmtub3duKTsKICAgICAgICB0eXBlc1tib3VudHkgPSBhXSA9IEJhc2tldFR5cGUuYm91bnR5OwogICAgfQp9CgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIFRoZSBvcmlnaW5hbCBjb2RlIGlzIHRha2VuIGZyb206Ci8vIGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHk6Ci8vICAgICBtYXN0ZXIgYnJhbmNoIGZyb20gemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL21hdGgvU2FmZU1hdGguc29sCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8qKgogKiBAdGl0bGUgU2FmZU1hdGgKICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCmxpYnJhcnkgU2FmZU1hdGggewogICAgLyoqCiAgICAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAgICAqLwogICAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBpZiAoYSA9PSAwKQogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB1aW50MjU2IGMgPSBhICogYjsKICAgICAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEludGVnZXIgZGl2aXNpb24gb2YgdHdvIG51bWJlcnMsIHRydW5jYXRpbmcgdGhlIHF1b3RpZW50LgogICAgICovCiAgICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IFN1YnRyYWN0cyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93IChpLmUuIGlmIHN1YnRyYWhlbmQgaXMKICAgICAqIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAgICAqLwogICAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoYiA8PSBhKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFkZHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAgICAqLwogICAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgICAgICBhc3NlcnQoYyA+PSBhKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KfQoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyBFUkMgVG9rZW4gU3RhbmRhcmQgIzIwIEludGVyZmFjZQovLyBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9ibG9iL21hc3Rlci9FSVBTL2VpcC0yMC5tZAovLyBUaGUgb3JpZ2luYWwgY29kZSBpcyB0YWtlbiBmcm9tOgovLyBodHRwczovL3RoZWV0aGVyZXVtLndpa2kvdy9pbmRleC5waHAvRVJDMjBfVG9rZW5fU3RhbmRhcmQKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpjb250cmFjdCBFUkMyMEludGVyZmFjZSB7CiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHRva2VuT3duZXIpCiAgICAgICAgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQgYmFsYW5jZSk7CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyB0b2tlbk93bmVyLCBhZGRyZXNzIHNwZW5kZXIpCiAgICAgICAgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcmVtYWluaW5nKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQgdG9rZW5zKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50IHRva2VucykKICAgICAgICBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQgdG9rZW5zKQogICAgICAgIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQgdG9rZW5zKTsKICAgIGV2ZW50IEFwcHJvdmFsKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCB0b2tlbk93bmVyLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLAogICAgICAgIHVpbnQgdG9rZW5zCiAgICApOwp9CgoKY29udHJhY3QgVG9rZW4gaXMgT3duYWJsZSwgRVJDMjBJbnRlcmZhY2UsIEVudW1zIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwoKICAgIC8vIFRva2VuIGZ1bGwgbmFtZQogICAgc3RyaW5nIHByaXZhdGUgY29uc3RhbnQgTkFNRSA9ICJFbnZpc2lvblggRVhDSEFJTiBUb2tlbiI7CiAgICAvLyBUb2tlbiBzeW1ib2wgbmFtZQogICAgc3RyaW5nIHByaXZhdGUgY29uc3RhbnQgU1lNQk9MID0gIkVYVCI7CiAgICAvLyBUb2tlbiBtYXggZnJhY3Rpb24sIGluIGRlY2ltYWwgc2lnbnMgYWZ0ZXIgdGhlIHBvaW50CiAgICB1aW50OCBwcml2YXRlIGNvbnN0YW50IERFQ0lNQUxTID0gMTg7CgogICAgLy8gVG9rZW5zIG1heCBzdXBwbHksIGluIEVYVHdlaQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgTUFYX1NVUFBMWSA9IDMwMDAwMDAwMDAgKiAoMTAqKnVpbnQoREVDSU1BTFMpKTsKCiAgICAvLyBUb2tlbnMgYmFsYW5jZXMgbWFwCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgaW50ZXJuYWwgYmFsYW5jZXM7CgogICAgLy8gTWFwcyB3aXRoIGFsbG93ZWQgYW1vdW50cyBmb3QgVHJhbnNmZXJGcm9tCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkpIGludGVybmFsIGFsbG93ZWQ7CgogICAgLy8gVG90YWwgYW1vdW50IG9mIGlzc3VlZCB0b2tlbnMsIGluIEVYVHdlaQogICAgdWludCBpbnRlcm5hbCBfdG90YWxTdXBwbHk7CgogICAgLy8gTWFwIHdpdGggRXRoZXIgZm91bmRzIGFtb3VudCBieSBhZGRyZXNzICh1c2luZyB3aGVuIHJlZnVuZHMpCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgaW50ZXJuYWwgZXRoZXJGdW5kczsKICAgIHVpbnQgaW50ZXJuYWwgX2Vhcm5lZEZ1bmRzOwogICAgLy8gTWFwIHdpdGggcmVmdW5kZWQgYWRkcmVzZXMgKEJsYWNrIExpc3QpCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgaW50ZXJuYWwgcmVmdW5kZWQ7CgogICAgLy8gQWRkcmVzcyBvZiBzYWxlIGFnZW50IChhIGNvbnRyYWN0KSB3aGljaCBjYW4gbWludCBuZXcgdG9rZW5zCiAgICBhZGRyZXNzIHB1YmxpYyBtaW50QWdlbnQ7CgogICAgLy8gVG9rZW4gdHJhbnNmZXIgYWxsb3dlZCBvbmx5IHdoZW4gdG9rZW4gbWludGluZyBpcyBmaW5pc2hlZAogICAgYm9vbCBwdWJsaWMgaXNNaW50aW5nRmluaXNoZWQgPSBmYWxzZTsKICAgIC8vIFdoZW4gbWludGluZyB3YXMgZmluaXNoZWQKICAgIHVpbnQgcHVibGljIG1pbnRpbmdTdG9wRGF0ZTsKCiAgICAvLyBUb3RhbCBhbW91bnQgb2YgdG9rZW5zIG1pbnRlZCB0byB0ZWFtIGJhc2tldCwgaW4gRVhUd2VpLgogICAgLy8gVGhpcyB3aWxsIG5vdCBpbmNsdWRlIHRva2VucywgdHJhbnNmZXJyZWQgdG8gdGVhbSBiYXNrZXQKICAgIC8vIGFmdGVyIG1pbnRpbmcgaXMgZmluaXNoZWQuCiAgICB1aW50IHB1YmxpYyB0ZWFtVG90YWw7CiAgICAvLyBBbW91bnQgb2YgdG9rZW5zIHNwZW50IGJ5IHRlYW0gaW4gZmlyc3QgOTYgd2Vla3Mgc2luY2UKICAgIC8vIG1pbnRpbmcgZmluaXNoIGRhdGUuIFVzZWQgdG8gY2FsY3VsYXRlIHRlYW0gc3BlbmQKICAgIC8vIHJlc3RyaWN0aW9ucyBhY2NvcmRpbmcgdG8gSUNPIFdoaXRlIFBhcGVyLgogICAgdWludCBwdWJsaWMgc3BlbnRCeVRlYW07CgogICAgLy8gQWRkcmVzcyBvZiBXUFRva2Vuc0Jhc2tldHMgY29udHJhY3QKICAgIFdQVG9rZW5zQmFza2V0cyBwdWJsaWMgd3BUb2tlbnNCYXNrZXRzOwoKICAgIC8vIENvbnN0cnVjdG9yCiAgICBmdW5jdGlvbiBUb2tlbihXUFRva2Vuc0Jhc2tldHMgYmFza2V0cykgcHVibGljIHsKICAgICAgICB3cFRva2Vuc0Jhc2tldHMgPSBiYXNrZXRzOwogICAgICAgIG1pbnRBZ2VudCA9IG93bmVyOwogICAgfQoKICAgIC8vIEZhbGxiYWNrIGZ1bmN0aW9uIC0gZG8gbm90IGFwcGx5IGFueSBldGhlciB0byB0aGlzIGNvbnRyYWN0LgogICAgZnVuY3Rpb24gKCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgcmV2ZXJ0KCk7CiAgICB9CgogICAgLy8gTGFzdCByZXNvcnQgdG8gcmV0dXJuIGV0aGVyLgogICAgLy8gU2VlIHRoZSBsYXN0IHdhcm5pbmcgYXQKICAgIC8vIGh0dHA6Ly9zb2xpZGl0eS5yZWFkdGhlZG9jcy5pby9lbi9kZXZlbG9wL2NvbnRyYWN0cy5odG1sI2ZhbGxiYWNrLWZ1bmN0aW9uCiAgICAvLyBmb3Igc3VjaCBjYXNlcy4KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRXRoZXJUbyhhZGRyZXNzIGEpIGV4dGVybmFsIG9ubHlPd25lciBhZGRyTm90TnVsbChhKSB7CiAgICAgICAgYS50cmFuc2ZlcihhZGRyZXNzKHRoaXMpLmJhbGFuY2UpOwogICAgfQoKICAgIC8qKgogICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgRVJDMjAgSW50ZXJmYWNlIGltcGxlbWVudGF0aW9uCiAgICAqLwoKICAgIC8vIFJldHVybiB0b2tlbiBmdWxsIG5hbWUKICAgIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgcHVyZSByZXR1cm5zIChzdHJpbmcpIHsKICAgICAgICByZXR1cm4gTkFNRTsKICAgIH0KCiAgICAvLyBSZXR1cm4gdG9rZW4gc3ltYm9sIG5hbWUKICAgIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyBwdXJlIHJldHVybnMgKHN0cmluZykgewogICAgICAgIHJldHVybiBTWU1CT0w7CiAgICB9CgogICAgLy8gUmV0dXJuIGFtb3VudCBvZiBkZWNpbWFscyBhZnRlciBwb2ludAogICAgZnVuY3Rpb24gZGVjaW1hbHMoKSBwdWJsaWMgcHVyZSByZXR1cm5zICh1aW50OCkgewogICAgICAgIHJldHVybiBERUNJTUFMUzsKICAgIH0KCiAgICAvLyBSZXR1cm4gdG90YWwgYW1vdW50IG9mIGlzc3VlZCB0b2tlbnMsIGluIEVYVHdlaQogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBfdG90YWxTdXBwbHk7CiAgICB9CgogICAgLy8gUmV0dXJuIGFjY291bnQgYmFsYW5jZSBpbiB0b2tlbnMgKGluIEVYVHdlaSkKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9hZGRyZXNzKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBiYWxhbmNlc1tfYWRkcmVzc107CiAgICB9CgogICAgLy8gVHJhbnNmZXIgdG9rZW5zIHRvIGFub3RoZXIgYWNjb3VudAogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludCB2YWx1ZSkKICAgICAgICBwdWJsaWMKICAgICAgICBhZGRyTm90TnVsbCh0bykKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA8IHZhbHVlKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKGlzRnJvemVuKHdwVG9rZW5zQmFza2V0cy50eXBlT2YobXNnLnNlbmRlciksIHZhbHVlKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKHZhbHVlKTsKICAgICAgICBiYWxhbmNlc1t0b10gPSBiYWxhbmNlc1t0b10uYWRkKHZhbHVlKTsKICAgICAgICBzYXZlVGVhbVNwZW50KG1zZy5zZW5kZXIsIHZhbHVlKTsKICAgICAgICBlbWl0IFRyYW5zZmVyKG1zZy5zZW5kZXIsIHRvLCB2YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFjY291bnQgdG8gYW5vdGhlciwKICAgIC8vIHVzaW5nIHBlcm1pc3Npb25zIGRlZmluZWQgd2l0aCBhcHByb3ZlKCkgbWV0aG9kLgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludCB2YWx1ZSkKICAgICAgICBwdWJsaWMKICAgICAgICBhZGRyTm90TnVsbCh0bykKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIGlmIChiYWxhbmNlc1tmcm9tXSA8IHZhbHVlKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKGFsbG93YW5jZShmcm9tLCBtc2cuc2VuZGVyKSA8IHZhbHVlKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKGlzRnJvemVuKHdwVG9rZW5zQmFza2V0cy50eXBlT2YoZnJvbSksIHZhbHVlKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGJhbGFuY2VzW2Zyb21dID0gYmFsYW5jZXNbZnJvbV0uc3ViKHZhbHVlKTsKICAgICAgICBiYWxhbmNlc1t0b10gPSBiYWxhbmNlc1t0b10uYWRkKHZhbHVlKTsKICAgICAgICBhbGxvd2VkW2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtmcm9tXVttc2cuc2VuZGVyXS5zdWIodmFsdWUpOwogICAgICAgIHNhdmVUZWFtU3BlbnQoZnJvbSwgdmFsdWUpOwogICAgICAgIGVtaXQgVHJhbnNmZXIoZnJvbSwgdG8sIHZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBBbGxvdyB0byB0cmFuc2ZlciBnaXZlbiBhbW91bnQgb2YgdG9rZW5zIChpbiBFWFR3ZWkpCiAgICAvLyB0byBhY2NvdW50IHdoaWNoIGlzIG5vdCBvd25lci4KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmIChtc2cuc2VuZGVyID09IHNwZW5kZXIpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW3NwZW5kZXJdID0gdmFsdWU7CiAgICAgICAgZW1pdCBBcHByb3ZhbChtc2cuc2VuZGVyLCBzcGVuZGVyLCB2YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gUmV0dXJuIGFtb3VudCBvZiB0b2tlbnMgKGluIEVYVHdlaSkgd2hpY2ggYWxsb3dlZCB0bwogICAgLy8gYmUgdHJhbnNmZXJyZWQgYnkgbm9uLW93bmVyIHNwZW5kZXIKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBzcGVuZGVyKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCkKICAgIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW3NwZW5kZXJdOwogICAgfQoKICAgIC8qKgogICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgT3RoZXIgbWV0aG9kcwogICAgKi8KCiAgICAvLyBSZXR1cm4gYWNjb3VudCBmdW5kcyBpbiBldGhlciAoaW4gd2VpKQogICAgZnVuY3Rpb24gZXRoZXJGdW5kc09mKGFkZHJlc3MgX2FkZHJlc3MpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIGV0aGVyRnVuZHNbX2FkZHJlc3NdOwogICAgfQoKICAgIC8vIFJldHVybiB0b3RhbCBhbW91bnQgb2YgZnVuZGVkIGV0aGVyLCBpbiB3ZWkKICAgIGZ1bmN0aW9uIGVhcm5lZEZ1bmRzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gX2Vhcm5lZEZ1bmRzOwogICAgfQoKICAgIC8vIFJldHVybiB0cnVlIGlmIGdpdmVuIGFkZHJlc3MgaGF2ZSBiZWVuIHJlZnVuZGVkCiAgICBmdW5jdGlvbiBpc1JlZnVuZGVkKGFkZHJlc3MgX2FkZHJlc3MpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gcmVmdW5kZWRbX2FkZHJlc3NdOwogICAgfQoKICAgIC8vIFNldCBuZXcgYWRkcmVzcyBvZiBzYWxlIGFnZW50IGNvbnRyYWN0LgogICAgLy8gV2lsbCBiZSBjYWxsZWQgZm9yIGVhY2ggc2FsZSBzdGFnZTogUHJpdmF0ZVNhbGUsIFByZVNhbGUsIE1haW5TYWxlLgogICAgZnVuY3Rpb24gc2V0TWludEFnZW50KGFkZHJlc3MgYSkgcHVibGljIG9ubHlPd25lciBhZGRyTm90TnVsbChhKSB7CiAgICAgICAgZW1pdCBNaW50QWdlbnRSZXBsYWNlZChtaW50QWdlbnQsIGEpOwogICAgICAgIG1pbnRBZ2VudCA9IGE7CiAgICB9CgogICAgLy8gSW50ZXJmYWNlIGZvciBzYWxlIGFnZW50IGNvbnRyYWN0IC0gbWludCBuZXcgdG9rZW5zCiAgICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgdG8sIHVpbnQyNTYgZXh0QW1vdW50LCB1aW50MjU2IGV0aGVyQW1vdW50KSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoIWlzTWludGluZ0ZpbmlzaGVkKTsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gbWludEFnZW50KTsKICAgICAgICByZXF1aXJlKCFyZWZ1bmRlZFt0b10pOwogICAgICAgIF90b3RhbFN1cHBseSA9IF90b3RhbFN1cHBseS5hZGQoZXh0QW1vdW50KTsKICAgICAgICByZXF1aXJlKF90b3RhbFN1cHBseSA8PSBNQVhfU1VQUExZKTsKICAgICAgICBiYWxhbmNlc1t0b10gPSBiYWxhbmNlc1t0b10uYWRkKGV4dEFtb3VudCk7CiAgICAgICAgaWYgKHdwVG9rZW5zQmFza2V0cy5pc1Vua25vd24odG8pKSB7CiAgICAgICAgICAgIF9lYXJuZWRGdW5kcyA9IF9lYXJuZWRGdW5kcy5hZGQoZXRoZXJBbW91bnQpOwogICAgICAgICAgICBldGhlckZ1bmRzW3RvXSA9IGV0aGVyRnVuZHNbdG9dLmFkZChldGhlckFtb3VudCk7CiAgICAgICAgfSBlbHNlIGlmICh3cFRva2Vuc0Jhc2tldHMuaXNUZWFtKHRvKSkgewogICAgICAgICAgICB0ZWFtVG90YWwgPSB0ZWFtVG90YWwuYWRkKGV4dEFtb3VudCk7CiAgICAgICAgfQogICAgICAgIGVtaXQgTWludCh0bywgZXh0QW1vdW50KTsKICAgICAgICBlbWl0IFRyYW5zZmVyKG1zZy5zZW5kZXIsIHRvLCBleHRBbW91bnQpOwogICAgfQoKICAgIC8vIERlc3Ryb3kgbWludGVkIHRva2VucyBhbmQgcmVmdW5kIGV0aGVyIHNwZW50IGJ5IGludmVzdG9yLgogICAgLy8gVXNlZCBpbiBBTUwgKEFudGkgTW9uZXkgTGF1bmRlcmluZykgd29ya2Zsb3cuCiAgICAvLyBXaWxsIGJlIGNhbGxlZCBvbmx5IGJ5IGh1bWFucyBiZWNhdXNlIHRoZXJlIGlzIG5vIHdheQogICAgLy8gdG8gd2l0aGRyYXcgY3Jvd2RmdW5kZWQgZXRoZXIgZnJvbSBCZW5lZmljaWFyeSBhY2NvdW50CiAgICAvLyBmcm9tIGNvbnRleHQgb2YgdGhpcyBhY2NvdW50LgogICAgLy8gSW1wb3J0YW50IG5vdGU6IGFsbCB0b2tlbnMgbWludGVkIHRvIHRlYW0sIGZvdW5kYXRpb24gZXRjLgogICAgLy8gd2lsbCBOT1QgYmUgYnVybmVkLCBiZWNhdXNlIHRoZXkgaW4gZ2VuZXJhbCBhcmUgc3BlbnQKICAgIC8vIGR1cmluZyB0aGUgc2FsZSBhbmQgaXRzIHRvbyBleHBlbnNpdmUgdG8gdHJhY2sgYWxsIHRoZXNlCiAgICAvLyB0cmFuc2FjdGlvbnMuCiAgICBmdW5jdGlvbiBidXJuVG9rZW5zQW5kUmVmdW5kKGFkZHJlc3MgX2FkZHJlc3MpCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICBwYXlhYmxlCiAgICAgICAgYWRkck5vdE51bGwoX2FkZHJlc3MpCiAgICAgICAgb25seU93bmVyKCkKICAgIHsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+IDAgJiYgbXNnLnZhbHVlID09IGV0aGVyRnVuZHNbX2FkZHJlc3NdKTsKICAgICAgICBfdG90YWxTdXBwbHkgPSBfdG90YWxTdXBwbHkuc3ViKGJhbGFuY2VzW19hZGRyZXNzXSk7CiAgICAgICAgYmFsYW5jZXNbX2FkZHJlc3NdID0gMDsKICAgICAgICBfZWFybmVkRnVuZHMgPSBfZWFybmVkRnVuZHMuc3ViKG1zZy52YWx1ZSk7CiAgICAgICAgZXRoZXJGdW5kc1tfYWRkcmVzc10gPSAwOwogICAgICAgIHJlZnVuZGVkW19hZGRyZXNzXSA9IHRydWU7CiAgICAgICAgX2FkZHJlc3MudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgIH0KCiAgICAvLyBTdG9wIHRva2VucyBtaW50aW5nIGZvcmV2ZXIuCiAgICBmdW5jdGlvbiBmaW5pc2hNaW50aW5nKCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKCFpc01pbnRpbmdGaW5pc2hlZCk7CiAgICAgICAgaXNNaW50aW5nRmluaXNoZWQgPSB0cnVlOwogICAgICAgIG1pbnRpbmdTdG9wRGF0ZSA9IG5vdzsKICAgICAgICBlbWl0IE1pbnRpbmdGaW5pc2hlZCgpOwogICAgfQoKICAgIC8qKgogICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgVG9rZW5zIGZyZWV6ZSBsb2dpYywgYWNjb3JkaW5nIHRvIElDTyBXaGl0ZSBQYXBlcgogICAgKi8KCiAgICAvLyBSZXR1cm4gdHJ1dGggaWYgZ2l2ZW4gX3ZhbHVlIGFtb3VudCBvZiB0b2tlbnMgKGluIEVYVHdlaSkKICAgIC8vIGNhbm5vdCBiZSB0cmFuc2ZlcnJlZCBmcm9tIGFjY291bnQgZHVlIHRvIHNwZW5kIHJlc3RyaWN0aW9ucwogICAgLy8gZGVmaW5lZCBpbiBJQ08gV2hpdGUgUGFwZXIuCiAgICAvLyAhISFDYXZlYXQgb2YgY3VycmVudCBpbXBsZW1lbnRhaW9uISEhCiAgICAvLyBTYXksCiAgICAvLyAgMS4gVGhlcmUgd2FzIDEwMCB0b2tlbnMgbWludGVkIHRvIHRoZSB0ZWFtIGJhc2tldDsKICAgIC8vICAyLiBNaW50aW5nIHdhcyBmaW5pc2hlZCBhbmQgMjQgd2Vla3MgZWxhcHNlZCwgYW5kIG5vdwogICAgLy8gICAgdGVhbSBjYW4gc3BlbmQgdXAgdG8gMjUgdG9rZW5zIHRpbGwgbmV4dCAyNCB3ZWVrczsKICAgIC8vICAzLiBTb21lb25lIHRyYW5zZmVycyBhbm90aGVyIDEwMCB0b2tlbnMgdG8gdGhlIHRlYW0gYmFza2V0OwogICAgLy8gIDQuIC4uLgogICAgLy8gUHJvYmxlbSBpcywgYWN0dWFsbHksIHlvdSBjYW4ndCBzcGVuZCBhbnkgb2YgdGhlc2UgZXh0cmEgMTAwCiAgICAvLyB0b2tlbnMgdW50aWwgOTYgd2Vla3Mgd2lsbCBlbGFwc2Ugc2luY2UgbWludGluZyBmaW5pc2ggZGF0ZS4KICAgIC8vIFRoYXQncyBiZWNhdXNlIGFmdGVyIG5leHQgMjQgd2Vla3Mgd2lsbCBiZSB1bmxvY2tlZCBvbmx5CiAgICAvLyAyNSB0b2tlbnMgbW9yZSAoMjUlIG9mICptaW50ZWQqIHRva2VucykgYW5kIHNvIG9uLgogICAgLy8gU28sIERPIE5PVCBzZW5kIHRva2VucyB0byB0aGUgdGVhbSBiYXNrZXQgdW50aWwgOTYgd2Vla3MgZWxhcHNlIQogICAgZnVuY3Rpb24gaXNGcm96ZW4oCiAgICAgICAgQmFza2V0VHlwZSBfYmFza2V0VHlwZSwKICAgICAgICB1aW50IF92YWx1ZQogICAgKQogICAgICAgIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgaWYgKCFpc01pbnRpbmdGaW5pc2hlZCkgewogICAgICAgICAgICAvLyBBbGxvdyBzcGVuZCBvbmx5IGFmdGVyIG1pbnRpbmcgaXMgZmluaXNoZWQKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGlmIChfYmFza2V0VHlwZSA9PSBCYXNrZXRUeXBlLmZvdW5kYXRpb24pIHsKICAgICAgICAgICAgLy8gQWxsb3cgdG8gc3BlbmQgZm91bmRhdGlvbiB0b2tlbnMgb25seSBhZnRlcgogICAgICAgICAgICAvLyA0OCB3ZWVrcyBhZnRlciBtaW50aW5nIGlzIGZpbmlzaGVkCiAgICAgICAgICAgIHJldHVybiBub3cgPCBtaW50aW5nU3RvcERhdGUgKyA0OCB3ZWVrczsKICAgICAgICB9CiAgICAgICAgaWYgKF9iYXNrZXRUeXBlID09IEJhc2tldFR5cGUudGVhbSkgewogICAgICAgICAgICAvLyBUZWFtIGFsbG93ZWQgdG8gc3BlbmQgdG9rZW5zOgogICAgICAgICAgICAvLyAgMjUlICAtIGFmdGVyIG1pbnRpbmcgZmluaXNoZWQgZGF0ZSArIDI0IHdlZWtzOwogICAgICAgICAgICAvLyAgNTAlICAtIGFmdGVyIG1pbnRpbmcgZmluaXNoZWQgZGF0ZSArIDQ4IHdlZWtzOwogICAgICAgICAgICAvLyAgNzUlICAtIGFmdGVyIG1pbnRpbmcgZmluaXNoZWQgZGF0ZSArIDcyIHdlZWtzOwogICAgICAgICAgICAvLyAgMTAwJSAtIGFmdGVyIG1pbnRpbmcgZmluaXNoZWQgZGF0ZSArIDk2IHdlZWtzLgogICAgICAgICAgICBpZiAobWludGluZ1N0b3BEYXRlICsgOTYgd2Vla3MgPD0gbm93KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKG5vdyA8IG1pbnRpbmdTdG9wRGF0ZSArIDI0IHdlZWtzKQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBmcmFjdGlvbiBhcyBwZXJjZW50cyBtdWx0aXBsZWQgdG8gMTBeMTAuCiAgICAgICAgICAgIC8vIFdpdGhvdXQgdGhpcyBvd25lciB3aWxsIGJlIGFibGUgdG8gc3BlbmQgZnJhY3Rpb25zCiAgICAgICAgICAgIC8vIGxlc3MgdGhhbiAxJSBwZXIgdHJhbnNhY3Rpb24uCiAgICAgICAgICAgIHVpbnQgZnJhY3Rpb25TcGVudCA9CiAgICAgICAgICAgICAgICBzcGVudEJ5VGVhbS5hZGQoX3ZhbHVlKS5tdWwoMTAwMDAwMDAwMDAwMCkuZGl2KHRlYW1Ub3RhbCk7CiAgICAgICAgICAgIGlmIChub3cgPCBtaW50aW5nU3RvcERhdGUgKyA0OCB3ZWVrcykgewogICAgICAgICAgICAgICAgcmV0dXJuIDI1MDAwMDAwMDAwMCA8IGZyYWN0aW9uU3BlbnQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKG5vdyA8IG1pbnRpbmdTdG9wRGF0ZSArIDcyIHdlZWtzKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gNTAwMDAwMDAwMDAwIDwgZnJhY3Rpb25TcGVudDsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBmcm9tIDcyIHRvIDk2IHdlZWtzIGVsYXBzZWQKICAgICAgICAgICAgcmV0dXJuIDc1MDAwMDAwMDAwMCA8IGZyYWN0aW9uU3BlbnQ7CiAgICAgICAgfQogICAgICAgIC8vIE5vIHJlc3RyaWN0aW9ucyBmb3Igb3RoZXIgdG9rZW4gaG9sZGVycwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvLyBTYXZlIGFtb3VudCBvZiBzcGVudCB0b2tlbnMgYnkgdGVhbSB0aWxsIDk2IHdlZWtzIGFmdGVyIG1pbnRpbmcKICAgIC8vIGZpbmlzaCBkYXRlLiBUaGlzIGlzIHZpdGFsIGJlY2F1c2Ugd2l0aG91dCB0aGUgY2hlY2sgd2UnbGwgZXZlbnR1YWxseQogICAgLy8gb3ZlcmZsb3cgdGhlIHVpbnQyNTYuCiAgICBmdW5jdGlvbiBzYXZlVGVhbVNwZW50KGFkZHJlc3MgX293bmVyLCB1aW50IF92YWx1ZSkgaW50ZXJuYWwgewogICAgICAgIGlmICh3cFRva2Vuc0Jhc2tldHMuaXNUZWFtKF9vd25lcikpIHsKICAgICAgICAgICAgaWYgKG5vdyA8IG1pbnRpbmdTdG9wRGF0ZSArIDk2IHdlZWtzKQogICAgICAgICAgICAgICAgc3BlbnRCeVRlYW0gPSBzcGVudEJ5VGVhbS5hZGQoX3ZhbHVlKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICBFdmVudHMKICAgICovCgogICAgLy8gRW1pdHRlZCB3aGVuIG1pbnQgYWdlbnQgKGFkZHJlc3Mgb2YgYSBzYWxlIGNvbnRyYWN0KQogICAgLy8gcmVwbGFjZWQgd2l0aCBuZXcgb25lCiAgICBldmVudCBNaW50QWdlbnRSZXBsYWNlZCgKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNNaW50QWdlbnQsCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIG5ld01pbnRBZ2VudAogICAgKTsKCiAgICAvLyBFbWl0dGVkIHdoZW4gbmV3IHRva2VucyB3ZXJlIGNyZWF0ZWQgYW5kIGZ1bmRlZCB0byBhY2NvdW50CiAgICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwoKICAgIC8vIEVtaXR0ZWQgd2hlbiB0b2tlbnMgbWludGluZyBpcyBmaW5pc2hlZC4KICAgIGV2ZW50IE1pbnRpbmdGaW5pc2hlZCgpOwp9CgoKY29udHJhY3QgS2lsbGFibGUgaXMgT3duYWJsZSB7CiAgICBmdW5jdGlvbiBraWxsKGFkZHJlc3MgYSkgZXh0ZXJuYWwgb25seU93bmVyIGFkZHJOb3ROdWxsKGEpIHsKICAgICAgICBzZWxmZGVzdHJ1Y3QoYSk7CiAgICB9Cn0KCgpjb250cmFjdCBCZW5lZmljaWFyeSBpcyBLaWxsYWJsZSB7CgogICAgLy8gQWRkcmVzcyBvZiBhY2NvdW50IHdoaWNoIHdpbGwgcmVjZWl2ZSBhbGwgZXRoZXIKICAgIC8vIGdhdGhlcmVkIGZyb20gSUNPCiAgICBhZGRyZXNzIHB1YmxpYyBiZW5lZmljaWFyeTsKCiAgICAvLyBDb25zdHJ1Y3RvcgogICAgZnVuY3Rpb24gQmVuZWZpY2lhcnkoKSBwdWJsaWMgewogICAgICAgIGJlbmVmaWNpYXJ5ID0gb3duZXI7CiAgICB9CgogICAgLy8gRmFsbGJhY2sgZnVuY3Rpb24gLSBkbyBub3QgYXBwbHkgYW55IGV0aGVyIHRvIHRoaXMgY29udHJhY3QuCiAgICBmdW5jdGlvbiAoKSBleHRlcm5hbCBwYXlhYmxlIHsKICAgICAgICByZXZlcnQoKTsKICAgIH0KCiAgICAvLyBTZXQgbmV3IGJlbmVmaWNpYXJ5IGZvciBJQ08KICAgIGZ1bmN0aW9uIHNldEJlbmVmaWNpYXJ5KGFkZHJlc3MgYSkgZXh0ZXJuYWwgb25seU93bmVyIGFkZHJOb3ROdWxsKGEpIHsKICAgICAgICBiZW5lZmljaWFyeSA9IGE7CiAgICB9Cn0KCgpjb250cmFjdCBUb2tlblNhbGUgaXMgS2lsbGFibGUsIEVudW1zIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIC8vIFR5cGUgZGVzY3JpYmluZzoKICAgIC8vICAtIHRoZSBhZGRyZXNzIG9mIHRoZSBiZW5lZmljaWFyeSBvZiB0aGUgdG9rZW5zOwogICAgLy8gIC0gdGhlIGZpbmFsIGFtb3VudCBvZiB0b2tlbnMgY2FsY3VsYXRlZCBhY2NvcmRpbmcgdG8gdGhlCiAgICAvLyAgICB0ZXJtcyBvZiB0aGUgV1A7CiAgICAvLyAgLSB0aGUgYW1vdW50IG9mIEV0aGVyIChpbiBXZWkpIGlmIHRoZSBiZW5lZmljaWFyeSBpcyBhbiBpbnZlc3RvcgogICAgLy8gVGhpcyB0eXBlIGlzIHVzZWQgaW4gYXJyYXlzWzhdIHRoYXQgc2hvdWxkIGJlIGRlY2xhcmUgaW4gdGhlIGhlaXIKICAgIC8vIGNvbnRyYWN0cy4KICAgIHN0cnVjdCB0b2tlbnMgewogICAgICAgIGFkZHJlc3MgYmVuZWZpY2lhcnk7CiAgICAgICAgdWludDI1NiBleHRBbW91bnQ7CiAgICAgICAgdWludDI1NiBldGhBbW91bnQ7CiAgICB9CgogICAgLy8gU2FsZSBzdGFnZSBzdGFydCBkYXRlL3RpbWUsIFVuaXggdGltZXN0YW1wCiAgICB1aW50MzIgcHVibGljIHN0YXJ0OwogICAgLy8gU2FsZSBzdGFnZSBzdG9wIGRhdGUvdGltZSwgVW5peCB0aW1lc3RhbXAKICAgIHVpbnQzMiBwdWJsaWMgc3RvcDsKICAgIC8vIE1pbiBldGhlciBhbW91bnQgZm9yIHB1cmNoYXNlCiAgICB1aW50MjU2IHB1YmxpYyBtaW5CdXlpbmdBbW91bnQ7CiAgICAvLyBQcmljZSBvZiBvbmUgdG9rZW4sIGluIHdlaQogICAgdWludDI1NiBwdWJsaWMgY3VycmVudFByaWNlOwoKICAgIC8vIEFtb3VudCBvZiB0b2tlbnMgYXZhaWxhYmxlLCBpbiBFWFR3ZWkKICAgIHVpbnQyNTYgcHVibGljIHJlbWFpbmluZ1N1cHBseTsKICAgIC8vIEFtb3VudCBvZiBlYXJuZWQgZnVuZHMsIGluIHdlaQogICAgdWludDI1NiBwdWJsaWMgZWFybmVkRnVuZHM7CgogICAgLy8gQWRkcmVzcyBvZiBUb2tlbiBjb250cmFjdAogICAgVG9rZW4gcHVibGljIHRva2VuOwogICAgLy8gQWRkcmVzcyBvZiBCZW5lZmljaWFyeSBjb250cmFjdCAtIGEgY29udGFpbmVyCiAgICAvLyBmb3IgdGhlIGJlbmVmaWNpYXJ5IGFkZHJlc3MKICAgIEJlbmVmaWNpYXJ5IGludGVybmFsIF9iZW5lZmljaWFyeTsKCiAgICAvLyBFcXVhbHMgdG8gMTBeZGVjaW1hbHMuCiAgICAvLyBJbnRlcm5hbGx5IHRva2VucyBzdG9yZWQgYXMgRVhUd2VpICh0b2tlbiBjb3VudCAqIDEwXmRlY2ltYWxzKS4KICAgIC8vIFVzZWQgdG8gY29udmVydCBFWFQgdG8gRVhUd2VpIGFuZCB2aWNlIHZlcnNhLgogICAgdWludDI1NiBpbnRlcm5hbCBkZWM7CgogICAgLy8gQ29uc3RydWN0b3IKICAgIGZ1bmN0aW9uIFRva2VuU2FsZSgKICAgICAgICBUb2tlbiBfdG9rZW4sIC8vIGFkZHJlc3Mgb2YgRVhUIEVSQzIwIHRva2VuIGNvbnRyYWN0CiAgICAgICAgQmVuZWZpY2lhcnkgYmVuZWZpY2lhcnksIC8vIGFkZHJlc3Mgb2YgY29udGFpbmVyIGZvciBFdGhlciBiZW5lZmljaWFyeQogICAgICAgIHVpbnQyNTYgX3N1cHBseUFtb3VudCAvLyBpbiBFWFQKICAgICkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICB0b2tlbiA9IF90b2tlbjsKICAgICAgICBfYmVuZWZpY2lhcnkgPSBiZW5lZmljaWFyeTsKCiAgICAgICAgLy8gRmFjdG9yIGZvciBjb252ZXJ0YXRpb24gRVhUIHRvIEVYVHdlaSBhbmQgdmljZSB2ZXJzYQogICAgICAgIGRlYyA9IDEwICoqIHVpbnQyNTYodG9rZW4uZGVjaW1hbHMoKSk7CiAgICAgICAgLy8gY29udmVydCB0byBFWFR3ZWkKICAgICAgICByZW1haW5pbmdTdXBwbHkgPSBfc3VwcGx5QW1vdW50Lm11bChkZWMpOwogICAgfQoKICAgIC8vIEZhbGxiYWNrIGZ1bmN0aW9uLiBIZXJlIHdlJ2xsIHJlY2VpdmUgYWxsIGludmVzdG1lbnRzLgogICAgZnVuY3Rpb24oKSBleHRlcm5hbCBwYXlhYmxlIHsKICAgICAgICBwdXJjaGFzZSgpOwogICAgfQoKICAgIC8vIEludmVzdG1lbnRzIHJlY2VpdmUgbG9naWMuIE11c3QgYmUgb3ZlcnJpZGVkIGluCiAgICAvLyBhcmJpdHJhcnkgc2FsZSBhZ2VudCAocGVyIGVhY2ggc2FsZSBzdGFnZSkuCiAgICBmdW5jdGlvbiBwdXJjaGFzZSgpIHB1YmxpYyBwYXlhYmxlOwoKICAgIC8vIFJldHVybiB0cnV0aCBpZiBwdXJjaGFzZSB3aXRoIGdpdmVuIF92YWx1ZSBvZiBldGhlcgogICAgLy8gKGluIHdlaSkgY2FuIGJlIG1hZGUKICAgIGZ1bmN0aW9uIGNhblB1cmNoYXNlKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN0YXJ0IDw9IG5vdyAmJiBub3cgPD0gc3RvcCAmJgogICAgICAgICAgICBtaW5CdXlpbmdBbW91bnQgPD0gX3ZhbHVlICYmCiAgICAgICAgICAgIHRvRVhUd2VpKF92YWx1ZSkgPD0gcmVtYWluaW5nU3VwcGx5OwogICAgfQoKICAgIC8vIFJldHVybiBhZGRyZXNzIG9mIGNyb3dkZnVuZGluZyBiZW5lZmljaWFyeSBhZGRyZXNzLgogICAgZnVuY3Rpb24gYmVuZWZpY2lhcnkoKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICAgICAgcmV0dXJuIF9iZW5lZmljaWFyeS5iZW5lZmljaWFyeSgpOwogICAgfQoKICAgIC8vIFJldHVybiB0cnV0aCBpZiB0aGVyZSBhcmUgdG9rZW5zIHdoaWNoIGNhbiBiZSBwdXJjaGFzZWQuCiAgICBmdW5jdGlvbiBpc0FjdGl2ZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gY2FuUHVyY2hhc2UobWluQnV5aW5nQW1vdW50KTsKICAgIH0KCiAgICAvLyBJbml0aWFsaXplIHRva2Vuc0FycmF5IHJlY29yZHMgd2l0aCBhY3R1YWwgYWRkcmVzc2VzIG9mIFdQIHRva2VucyBiYXNrZXRzCiAgICBmdW5jdGlvbiBzZXRCYXNrZXRzKHRva2Vuc1s4XSBtZW1vcnkgX3Rva2Vuc0FycmF5KSBpbnRlcm5hbCB2aWV3IHsKICAgICAgICBfdG9rZW5zQXJyYXlbdWludDgoQmFza2V0VHlwZS51bmtub3duKV0uYmVuZWZpY2lhcnkgPQogICAgICAgICAgICBtc2cuc2VuZGVyOwogICAgICAgIF90b2tlbnNBcnJheVt1aW50OChCYXNrZXRUeXBlLnRlYW0pXS5iZW5lZmljaWFyeSA9CiAgICAgICAgICAgIHRva2VuLndwVG9rZW5zQmFza2V0cygpLnRlYW0oKTsKICAgICAgICBfdG9rZW5zQXJyYXlbdWludDgoQmFza2V0VHlwZS5mb3VuZGF0aW9uKV0uYmVuZWZpY2lhcnkgPQogICAgICAgICAgICB0b2tlbi53cFRva2Vuc0Jhc2tldHMoKS5mb3VuZGF0aW9uKCk7CiAgICAgICAgX3Rva2Vuc0FycmF5W3VpbnQ4KEJhc2tldFR5cGUuYXJyKV0uYmVuZWZpY2lhcnkgPQogICAgICAgICAgICB0b2tlbi53cFRva2Vuc0Jhc2tldHMoKS5hcnIoKTsKICAgICAgICBfdG9rZW5zQXJyYXlbdWludDgoQmFza2V0VHlwZS5hZHZpc29ycyldLmJlbmVmaWNpYXJ5ID0KICAgICAgICAgICAgdG9rZW4ud3BUb2tlbnNCYXNrZXRzKCkuYWR2aXNvcnMoKTsKICAgICAgICBfdG9rZW5zQXJyYXlbdWludDgoQmFza2V0VHlwZS5ib3VudHkpXS5iZW5lZmljaWFyeSA9CiAgICAgICAgICAgIHRva2VuLndwVG9rZW5zQmFza2V0cygpLmJvdW50eSgpOwogICAgfQoKICAgIC8vIFJldHVybiBhbW91bnQgb2YgdG9rZW5zIChpbiBFWFR3ZWkpIHdoaWNoIGNhbiBiZSBwdXJjaGFzZWQKICAgIC8vIGF0IHRoZSBtb21lbnQgZm9yIGdpdmVuIGFtb3VudCBvZiBldGhlciAoaW4gd2VpKS4KICAgIGZ1bmN0aW9uIHRvRVhUd2VpKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIF92YWx1ZS5tdWwoZGVjKS5kaXYoY3VycmVudFByaWNlKTsKICAgIH0KCiAgICAvLyBSZXR1cm4gYW1vdW50IG9mIGJvbnVzIHRva2VucyAoaW4gRVhUd2VpKQogICAgLy8gUmVjZWl2ZSBhbW91bnQgb2YgdG9rZW5zIChpbiBFWFR3ZWkpIHRoYXQgd2lsbCBiZSBzYWxlLCBhbmQgYm9udXMgcGVyY2VudAogICAgZnVuY3Rpb24gYm9udXModWludDI1NiBfdG9rZW5zLCB1aW50OCBfYm9udXMpCiAgICAgICAgaW50ZXJuYWwKICAgICAgICBwdXJlCiAgICAgICAgcmV0dXJucyAodWludDI1NikKICAgIHsKICAgICAgICByZXR1cm4gX3Rva2Vucy5tdWwoX2JvbnVzKS5kaXYoMTAwKTsKICAgIH0KCiAgICAvLyBJbml0aWFsaXplIHRva2Vuc0FycmF5IHJlY29yZHMgd2l0aCBhY3R1YWwgYW1vdW50cyBvZiB0b2tlbnMKICAgIGZ1bmN0aW9uIGNhbGNXUFRva2Vucyh0b2tlbnNbOF0gbWVtb3J5IGEsIHVpbnQ4IF9ib251cykgaW50ZXJuYWwgcHVyZSB7CiAgICAgICAgYVt1aW50OChCYXNrZXRUeXBlLnVua25vd24pXS5leHRBbW91bnQgPQogICAgICAgICAgIGFbdWludDgoQmFza2V0VHlwZS51bmtub3duKV0uZXh0QW1vdW50LmFkZCgKICAgICAgICAgICAgICAgYm9udXMoCiAgICAgICAgICAgICAgICAgICBhW3VpbnQ4KEJhc2tldFR5cGUudW5rbm93bildLmV4dEFtb3VudCwKICAgICAgICAgICAgICAgICAgIF9ib251cwogICAgICAgICAgICAgICApCiAgICAgICAgICAgKTsKICAgICAgICB1aW50MjU2IG4gPSBhW3VpbnQ4KEJhc2tldFR5cGUudW5rbm93bildLmV4dEFtb3VudDsKICAgICAgICBhW3VpbnQ4KEJhc2tldFR5cGUudGVhbSldLmV4dEFtb3VudCA9IG4ubXVsKDI0KS5kaXYoNDApOwogICAgICAgIGFbdWludDgoQmFza2V0VHlwZS5mb3VuZGF0aW9uKV0uZXh0QW1vdW50ID0gbi5tdWwoMjApLmRpdig0MCk7CiAgICAgICAgYVt1aW50OChCYXNrZXRUeXBlLmFycildLmV4dEFtb3VudCA9IG4ubXVsKDEwKS5kaXYoNDApOwogICAgICAgIGFbdWludDgoQmFza2V0VHlwZS5hZHZpc29ycyldLmV4dEFtb3VudCA9IG4ubXVsKDQpLmRpdig0MCk7CiAgICAgICAgYVt1aW50OChCYXNrZXRUeXBlLmJvdW50eSldLmV4dEFtb3VudCA9IG4ubXVsKDIpLmRpdig0MCk7CiAgICB9CgogICAgLy8gU2VuZCByZWNlaXZlZCBldGhlciAoaW4gd2VpKSB0byBiZW5lZmljaWFyeQogICAgZnVuY3Rpb24gdHJhbnNmZXJGdW5kcyh1aW50MjU2IF92YWx1ZSkgaW50ZXJuYWwgewogICAgICAgIGJlbmVmaWNpYXJ5KCkudHJhbnNmZXIoX3ZhbHVlKTsKICAgICAgICBlYXJuZWRGdW5kcyA9IGVhcm5lZEZ1bmRzLmFkZChfdmFsdWUpOwogICAgfQoKICAgIC8vIE1ldGhvZCBmb3IgY2FsbCBtaW50KCkgaW4gRVhUIEVSQzIwIGNvbnRyYWN0LgogICAgLy8gbWludCgpIHdpbGwgYmUgY2FsbGVkIGZvciBlYWNoIHJlY29yZCBpZiBhbW91bnQgb2YgdG9rZW5zID4gMAogICAgZnVuY3Rpb24gY3JlYXRlVG9rZW5zKHRva2Vuc1s4XSBtZW1vcnkgX3Rva2Vuc0FycmF5KSBpbnRlcm5hbCB7CiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgX3Rva2Vuc0FycmF5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChfdG9rZW5zQXJyYXlbaV0uZXh0QW1vdW50ID4gMCkgewogICAgICAgICAgICAgICAgdG9rZW4ubWludCgKICAgICAgICAgICAgICAgICAgICBfdG9rZW5zQXJyYXlbaV0uYmVuZWZpY2lhcnksCiAgICAgICAgICAgICAgICAgICAgX3Rva2Vuc0FycmF5W2ldLmV4dEFtb3VudCwKICAgICAgICAgICAgICAgICAgICBfdG9rZW5zQXJyYXlbaV0uZXRoQW1vdW50CiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgoKY29udHJhY3QgUHJpdmF0ZVNhbGUgaXMgVG9rZW5TYWxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIC8vIExpc3Qgb2YgaW52ZXN0b3JzIGFsbG93ZWQgdG8gYnV5IHRva2VucyBhdCBQcml2YXRlU2FsZQogICAgbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIGludGVybmFsIGFsbG93ZWRJbnZlc3RvcnM7CgogICAgZnVuY3Rpb24gUHJpdmF0ZVNhbGUoVG9rZW4gX3Rva2VuLCBCZW5lZmljaWFyeSBfYmVuZWZpY2lhcnkpCiAgICAgICAgVG9rZW5TYWxlKF90b2tlbiwgX2JlbmVmaWNpYXJ5LCB1aW50MjU2KDQwMDAwMDAwMCkpCiAgICAgICAgcHVibGljCiAgICB7CiAgICAgICAgc3RhcnQgPSAxNTIyNjI3NjIwOwogICAgICAgIHN0b3AgPSAxNTI1MDQ2Mzk5OwogICAgICAgIG1pbkJ1eWluZ0Ftb3VudCA9IDcwIHN6YWJvOwogICAgICAgIGN1cnJlbnRQcmljZSA9IDcwIHN6YWJvOwogICAgfQoKICAgIGZ1bmN0aW9uIHB1cmNoYXNlKCkgcHVibGljIHBheWFibGUgewogICAgICAgIHJlcXVpcmUoaXNJbnZlc3RvckFsbG93ZWQobXNnLnNlbmRlcikpOwogICAgICAgIHJlcXVpcmUoY2FuUHVyY2hhc2UobXNnLnZhbHVlKSk7CiAgICAgICAgdHJhbnNmZXJGdW5kcyhtc2cudmFsdWUpOwogICAgICAgIHRva2Vuc1s4XSBtZW1vcnkgdG9rZW5zQXJyYXk7CiAgICAgICAgdG9rZW5zQXJyYXlbdWludDgoQmFza2V0VHlwZS51bmtub3duKV0uZXh0QW1vdW50ID0gdG9FWFR3ZWkobXNnLnZhbHVlKTsKICAgICAgICBzZXRCYXNrZXRzKHRva2Vuc0FycmF5KTsKICAgICAgICByZW1haW5pbmdTdXBwbHkgPSByZW1haW5pbmdTdXBwbHkuc3ViKAogICAgICAgICAgICB0b2tlbnNBcnJheVt1aW50OChCYXNrZXRUeXBlLnVua25vd24pXS5leHRBbW91bnQKICAgICAgICApOwogICAgICAgIGNhbGNXUFRva2Vucyh0b2tlbnNBcnJheSwgMzApOwogICAgICAgIHRva2Vuc0FycmF5W3VpbnQ4KEJhc2tldFR5cGUudW5rbm93bildLmV0aEFtb3VudCA9IG1zZy52YWx1ZTsKICAgICAgICBjcmVhdGVUb2tlbnModG9rZW5zQXJyYXkpOwogICAgfQoKICAgIC8vIFJlZ2lzdGVyIG5ldyBpbnZlc3RvcgogICAgZnVuY3Rpb24gYWxsb3dJbnZlc3RvcihhZGRyZXNzIGEpIHB1YmxpYyBvbmx5T3duZXIgYWRkck5vdE51bGwoYSkgewogICAgICAgIGFsbG93ZWRJbnZlc3RvcnNbYV0gPSB0cnVlOwogICAgfQoKICAgIC8vIERpc2NhcmQgZXhpc3RpbmcgaW52ZXN0b3IKICAgIGZ1bmN0aW9uIGRlbnlJbnZlc3RvcihhZGRyZXNzIGEpIHB1YmxpYyBvbmx5T3duZXIgYWRkck5vdE51bGwoYSkgewogICAgICAgIGRlbGV0ZSBhbGxvd2VkSW52ZXN0b3JzW2FdOwogICAgfQoKICAgIC8vIFJldHVybiB0cnV0aCBpZiBnaXZlbiBhY2NvdW50IGlzIGFsbG93ZWQgdG8gYnV5IHRva2VucwogICAgZnVuY3Rpb24gaXNJbnZlc3RvckFsbG93ZWQoYWRkcmVzcyBhKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIGFsbG93ZWRJbnZlc3RvcnNbYV07CiAgICB9Cn0='.
	

]
