Class {
	#name : #SRTc4a86561cb0b7ea1214904f26e6d50fd357c7986,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTc4a86561cb0b7ea1214904f26e6d50fd357c7986 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgICAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgICAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgYXNzZXJ0KGIgPD0gYSk7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSk7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9Cn0KCgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHkgPSA5MDAwMDAwMCAqIDEwICoqIDE4OwoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKCi8qKgogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKi8KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CgogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgICAvKioKICAgICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICAgKi8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogICAgfQoKfQoKCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCgogICAgLyoqCiAgICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CgogICAgICAgIHVpbnQyNTYgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOwoKICAgICAgICAvLyBDaGVjayBpcyBub3QgbmVlZGVkIGJlY2F1c2Ugc3ViKF9hbGxvd2FuY2UsIF92YWx1ZSkgd2lsbCBhbHJlYWR5IHRocm93IGlmIHRoaXMgY29uZGl0aW9uIGlzIG5vdCBtZXQKICAgICAgICAvLyByZXF1aXJlIChfdmFsdWUgPD0gX2FsbG93YW5jZSk7CgogICAgICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAgICoKICAgICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgICAqIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZSB0cmFuc2FjdGlvbiBvcmRlcmluZy4gT25lIHBvc3NpYmxlIHNvbHV0aW9uIHRvIG1pdGlnYXRlIHRoaXMKICAgICAqIHJhY2UgY29uZGl0aW9uIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUgYWZ0ZXJ3YXJkczoKICAgICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgICB9CgogICAgLyoqCiAgICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAgICovCiAgICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkKICAgIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICAgICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgICAgICB9CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCn0KCgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CgogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgogICAgLyoqCiAgICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgICAqIGFjY291bnQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgICAqLwogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICB9Cn0KCgovKgogKiBDaGFyZ0NvaW5Db250cmFjdAogKgogKiBTaW1wbGUgRVJDMjAgVG9rZW4gZXhhbXBsZSwgd2l0aCBjcm93ZHNhbGUgdG9rZW4gY3JlYXRpb24KICovCmNvbnRyYWN0IENoYXJnQ29pbkNvbnRyYWN0IGlzIFN0YW5kYXJkVG9rZW4sIE93bmFibGUgewoKICAgIHN0cmluZyBwdWJsaWMgc3RhbmRhcmQgPSAiQ0hHIjsKICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICJDaGFyZyBDb2luIjsKICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIkNIRyI7CgogICAgdWludCBwdWJsaWMgZGVjaW1hbHMgPSAxODsKCiAgICBhZGRyZXNzIHB1YmxpYyBtdWx0aXNpZyA9IDB4NDgyRUZkNDQ3YkU4ODc0OGU3NjI1ZTJiN2M1MjJjMzg4OTcwQjc5MDsKCiAgICBzdHJ1Y3QgQ2hhcmdpbmdEYXRhIHsKICAgIGFkZHJlc3Mgbm9kZTsKICAgIHVpbnQgc3RhcnRUaW1lOwogICAgdWludCBlbmRUaW1lOwogICAgdWludDI1NiBmaXhlZFJhdGU7CiAgICBib29sIGluaXRpYWxpemVkOwogICAgdWludDI1NiBwcmVkZWZpbmVkQW1vdW50OwogICAgfQoKICAgIHN0cnVjdCBQYXJraW5nRGF0YSB7CiAgICBhZGRyZXNzIG5vZGU7CiAgICB1aW50IHN0YXJ0VGltZTsKICAgIHVpbnQgZW5kVGltZTsKICAgIHVpbnQyNTYgZml4ZWRSYXRlOwogICAgYm9vbCBpbml0aWFsaXplZDsKICAgIHVpbnQyNTYgcHJlZGVmaW5lZEFtb3VudDsKICAgIH0KCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBhdXRob3JpemVkOwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIHJhdGVPZkNoYXJnaW5nOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgcmF0ZU9mUGFya2luZzsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IENoYXJnaW5nRGF0YSkgcHVibGljIGNoYXJnaW5nU3dpdGNoZXM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IFBhcmtpbmdEYXRhKSBwdWJsaWMgcGFya2luZ1N3aXRjaGVzOwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIHJlc2VydmVkRnVuZHNDaGFyZ2luZzsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIHJlc2VydmVkRnVuZHNQYXJraW5nOwoKICAgIC8vIDEgRVRIID0gODAwIENIQVJHIHRva2VucyAoMSBDSEFSRyA9IDAuNTkgVVNEKQogICAgdWludCBQUklDRSA9IDgwMDsKCiAgICBzdHJ1Y3QgQ29udHJpYnV0b3JEYXRhIHsKICAgIHVpbnQgY29udHJpYnV0aW9uQW1vdW50OwogICAgdWludCB0b2tlbnNJc3N1ZWQ7CiAgICB9CgogICAgZnVuY3Rpb24gQ2hhcmdDb2luQ29udHJhY3QoKSBwdWJsaWMgewogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gdG90YWxTdXBwbHk7CiAgICB9CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBDb250cmlidXRvckRhdGEpIHB1YmxpYyBjb250cmlidXRvckxpc3Q7CgogICAgdWludCBuZXh0Q29udHJpYnV0b3JJbmRleDsKCiAgICBtYXBwaW5nICh1aW50ID0+IGFkZHJlc3MpIGNvbnRyaWJ1dG9ySW5kZXhlczsKCiAgICBzdGF0ZSBwdWJsaWMgY3Jvd2RzYWxlU3RhdGUgPSBzdGF0ZS5wZW5kaW5nU3RhcnQ7CiAgICBlbnVtIHN0YXRlIHtwZW5kaW5nU3RhcnQsIGNyb3dkc2FsZSwgY3Jvd2RzYWxlRW5kZWR9CgogICAgZXZlbnQgQ3Jvd2RzYWxlU3RhcnRlZCh1aW50IGJsb2NrTnVtYmVyKTsKCiAgICBldmVudCBDcm93ZHNhbGVFbmRlZCh1aW50IGJsb2NrTnVtYmVyKTsKCiAgICBldmVudCBFcnJvclNlbmRpbmdFVEgoYWRkcmVzcyB0bywgdWludCBhbW91bnQpOwoKICAgIGV2ZW50IE1pbkNhcFJlYWNoZWQodWludCBibG9ja051bWJlcik7CgogICAgZXZlbnQgTWF4Q2FwUmVhY2hlZCh1aW50IGJsb2NrTnVtYmVyKTsKCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBCRUdJTl9USU1FID0gMTUxMjMxOTk2NTsKCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBFTkRfVElNRSA9IDE1MTQ3NjQ4MDA7CgogICAgdWludCBwdWJsaWMgbWluQ2FwID0gMSBldGhlcjsKCiAgICB1aW50IHB1YmxpYyBtYXhDYXAgPSAxMjUwMCBldGhlcjsKCiAgICB1aW50IHB1YmxpYyBldGhSYWlzZWQgPSAwOwoKICAgIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5ID0gOTAwMDAwMDAgKiAxMCAqKiBkZWNpbWFsczsKCiAgICB1aW50IGNyb3dkc2FsZVRva2VuQ2FwID0gMTAwMDAwMDAgKiAxMCAqKiBkZWNpbWFsczsgLy8gMTEuMTElCiAgICB1aW50IGZvdW5kZXJzQW5kVGVhbVRva2VucyA9IDkwMDAwMDAgKiAxMCAqKiBkZWNpbWFsczsgLy8gMTAlCiAgICB1aW50IERpc3Ryb0Z1bmRUb2tlbnMgPSA2OTAwMDAwMCAqIDEwICoqIGRlY2ltYWxzOyAvLyA3Ni42NyUKCXVpbnQgQm91bnR5VG9rZW5zID0gMjAwMDAwMCAqIDEwICoqIGRlY2ltYWxzOyAvLyAyLjIyJQoKICAgIGJvb2wgZm91bmRlcnNBbmRUZWFtVG9rZW5zQ2xhaW1lZCA9IGZhbHNlOwogICAgYm9vbCBEaXN0cm9GdW5kVG9rZW5zQ2xhaW1lZCA9IGZhbHNlOwoJYm9vbCBCb3VudHlUb2tlbnNDbGFpbWVkID0gZmFsc2U7CgogICAgdWludCBuZXh0Q29udHJpYnV0b3JUb0NsYWltOwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgaGFzQ2xhaW1lZEV0aFdoZW5GYWlsOwoKICAgIGZ1bmN0aW9uKCkgcGF5YWJsZSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlICE9IDApOwogICAgICAgIHJlcXVpcmUoY3Jvd2RzYWxlU3RhdGUgIT0gc3RhdGUuY3Jvd2RzYWxlRW5kZWQpOwogICAgICAgIC8vIENoZWNrIGlmIGNyb3dkc2FsZSBoYXMgZW5kZWQKCiAgICAgICAgYm9vbCBzdGF0ZUNoYW5nZWQgPSBjaGVja0Nyb3dkc2FsZVN0YXRlKCk7CiAgICAgICAgLy8gQ2hlY2sgYmxvY2tzIGFuZCBjYWxpYnJhdGUgY3Jvd2RzYWxlIHN0YXRlCgogICAgICAgIGlmIChjcm93ZHNhbGVTdGF0ZSA9PSBzdGF0ZS5jcm93ZHNhbGUpIHsKICAgICAgICAgICAgY3JlYXRlVG9rZW5zKG1zZy5zZW5kZXIpOwogICAgICAgICAgICAvLyBQcm9jZXNzIHRyYW5zYWN0aW9uIGFuZCBpc3N1ZSB0b2tlbnMKCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICByZWZ1bmRUcmFuc2FjdGlvbihzdGF0ZUNoYW5nZWQpOwogICAgICAgICAgICAvLyBTZXQgc3RhdGUgYW5kIHJldHVybiBmdW5kcyBvciB0aHJvdwogICAgICAgIH0KICAgIH0KCiAgICAvLwogICAgLy8gQ2hlY2sgY3Jvd2RzYWxlIHN0YXRlIGFuZCBjYWxpYnJhdGUgaXQKICAgIC8vCiAgICBmdW5jdGlvbiBjaGVja0Nyb3dkc2FsZVN0YXRlKCkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmIChldGhSYWlzZWQgPj0gbWF4Q2FwICYmIGNyb3dkc2FsZVN0YXRlICE9IHN0YXRlLmNyb3dkc2FsZUVuZGVkKSB7Ly8gQ2hlY2sgaWYgbWF4IGNhcCBpcyByZWFjaGVkCiAgICAgICAgICAgIGNyb3dkc2FsZVN0YXRlID0gc3RhdGUuY3Jvd2RzYWxlRW5kZWQ7CiAgICAgICAgICAgIENyb3dkc2FsZUVuZGVkKGJsb2NrLm51bWJlcik7CiAgICAgICAgICAgIC8vIFJhaXNlIGV2ZW50CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKG5vdyA+PSBFTkRfVElNRSkgewogICAgICAgICAgICBjcm93ZHNhbGVTdGF0ZSA9IHN0YXRlLmNyb3dkc2FsZUVuZGVkOwogICAgICAgICAgICBDcm93ZHNhbGVFbmRlZChibG9jay5udW1iZXIpOwogICAgICAgICAgICAvLyBSYWlzZSBldmVudAogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIGlmIChub3cgPj0gQkVHSU5fVElNRSAmJiBub3cgPCBFTkRfVElNRSkgey8vIENoZWNrIGlmIHdlIGFyZSBpbiBjcm93ZHNhbGUgc3RhdGUKICAgICAgICAgICAgaWYgKGNyb3dkc2FsZVN0YXRlICE9IHN0YXRlLmNyb3dkc2FsZSkgey8vIENoZWNrIGlmIHN0YXRlIG5lZWRzIHRvIGJlIGNoYW5nZWQKICAgICAgICAgICAgICAgIGNyb3dkc2FsZVN0YXRlID0gc3RhdGUuY3Jvd2RzYWxlOwogICAgICAgICAgICAgICAgLy8gU2V0IG5ldyBzdGF0ZQogICAgICAgICAgICAgICAgQ3Jvd2RzYWxlU3RhcnRlZChibG9jay5udW1iZXIpOwogICAgICAgICAgICAgICAgLy8gUmFpc2UgZXZlbnQKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLy8KICAgIC8vIERlY2lkZSBpZiB0aHJvdyBvciBvbmx5IHJldHVybiBldGhlcgogICAgLy8KICAgIGZ1bmN0aW9uIHJlZnVuZFRyYW5zYWN0aW9uKGJvb2wgX3N0YXRlQ2hhbmdlZCkgaW50ZXJuYWwgewogICAgICAgIGlmIChfc3RhdGVDaGFuZ2VkKSB7CiAgICAgICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBjcmVhdGVUb2tlbnMoYWRkcmVzcyBfY29udHJpYnV0b3IpIHBheWFibGUgcHVibGljIHsKCiAgICAgICAgdWludCBfYW1vdW50ID0gbXNnLnZhbHVlOwoKICAgICAgICB1aW50IGNvbnRyaWJ1dGlvbkFtb3VudCA9IF9hbW91bnQ7CiAgICAgICAgdWludCByZXR1cm5BbW91bnQgPSAwOwoKICAgICAgICBpZiAoX2Ftb3VudCA+IChtYXhDYXAgLSBldGhSYWlzZWQpKSB7Ly8gQ2hlY2sgaWYgbWF4IGNvbnRyaWJ1dGlvbiBpcyBsb3dlciB0aGFuIF9hbW91bnQgc2VudAogICAgICAgICAgICBjb250cmlidXRpb25BbW91bnQgPSBtYXhDYXAgLSBldGhSYWlzZWQ7CiAgICAgICAgICAgIC8vIFNldCB0aGF0IHVzZXIgY29udGlidXRlcyBoaXMgbWF4aW11bSBhbG93ZWQgY29udHJpYnV0aW9uCiAgICAgICAgICAgIHJldHVybkFtb3VudCA9IF9hbW91bnQgLSBjb250cmlidXRpb25BbW91bnQ7CiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBob3cgbXVjaCBoZSBtdXN0IGdldCBiYWNrCiAgICAgICAgfQoKICAgICAgICBpZiAoZXRoUmFpc2VkICsgY29udHJpYnV0aW9uQW1vdW50ID4gbWluQ2FwICYmIG1pbkNhcCA+IGV0aFJhaXNlZCkgewogICAgICAgICAgICBNaW5DYXBSZWFjaGVkKGJsb2NrLm51bWJlcik7CiAgICAgICAgfQoKICAgICAgICBpZiAoZXRoUmFpc2VkICsgY29udHJpYnV0aW9uQW1vdW50ID09IG1heENhcCAmJiBldGhSYWlzZWQgPCBtYXhDYXApIHsKICAgICAgICAgICAgTWF4Q2FwUmVhY2hlZChibG9jay5udW1iZXIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGNvbnRyaWJ1dG9yTGlzdFtfY29udHJpYnV0b3JdLmNvbnRyaWJ1dGlvbkFtb3VudCA9PSAwKSB7CiAgICAgICAgICAgIGNvbnRyaWJ1dG9ySW5kZXhlc1tuZXh0Q29udHJpYnV0b3JJbmRleF0gPSBfY29udHJpYnV0b3I7CiAgICAgICAgICAgIG5leHRDb250cmlidXRvckluZGV4ICs9IDE7CiAgICAgICAgfQoKICAgICAgICBjb250cmlidXRvckxpc3RbX2NvbnRyaWJ1dG9yXS5jb250cmlidXRpb25BbW91bnQgKz0gY29udHJpYnV0aW9uQW1vdW50OwogICAgICAgIGV0aFJhaXNlZCArPSBjb250cmlidXRpb25BbW91bnQ7CiAgICAgICAgLy8gQWRkIHRvIGV0aCByYWlzZWQKCiAgICAgICAgdWludDI1NiB0b2tlbkFtb3VudCA9IGNhbGN1bGF0ZUV0aFRvQ2hhcmdjb2luKGNvbnRyaWJ1dGlvbkFtb3VudCk7CiAgICAgICAgLy8gQ2FsY3VsYXRlIGhvdyBtdWNoIHRva2VucyBtdXN0IGNvbnRyaWJ1dG9yIGdldAogICAgICAgIGlmICh0b2tlbkFtb3VudCA+IDApIHsKICAgICAgICAgICAgdHJhbnNmZXJUb0NvbnRyaWJ1dG9yKF9jb250cmlidXRvciwgdG9rZW5BbW91bnQpOwogICAgICAgICAgICBjb250cmlidXRvckxpc3RbX2NvbnRyaWJ1dG9yXS50b2tlbnNJc3N1ZWQgKz0gdG9rZW5BbW91bnQ7CiAgICAgICAgICAgIC8vIGxvZyB0b2tlbiBpc3N1YW5jZQogICAgICAgIH0KCiAgICAgICAgaWYgKCFtdWx0aXNpZy5zZW5kKG1zZy52YWx1ZSkpIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQogICAgfQoKCiAgICBmdW5jdGlvbiB0cmFuc2ZlclRvQ29udHJpYnV0b3IoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSAgcHVibGljIHsKICAgICAgICBiYWxhbmNlc1tvd25lcl0gPSBiYWxhbmNlc1tvd25lcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gY2FsY3VsYXRlRXRoVG9DaGFyZ2NvaW4odWludCBfZXRoKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDI1NikgewoKICAgICAgICB1aW50IHRva2VucyA9IF9ldGgubXVsKGdldFByaWNlKCkpOwogICAgICAgIHVpbnQgcGVyY2VudGFnZSA9IDA7CgogICAgICAgIGlmIChldGhSYWlzZWQgPiAwKSB7CiAgICAgICAgICAgIHBlcmNlbnRhZ2UgPSBldGhSYWlzZWQgKiAxMDAgLyBtYXhDYXA7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdG9rZW5zICsgZ2V0QW1vdW50Qm9udXModG9rZW5zKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRBbW91bnRCb251cyh1aW50IHRva2VucykgcHVyZSBwdWJsaWMgcmV0dXJucyAodWludCkgewogICAgICAgIHVpbnQgYW1vdW50Qm9udXMgPSAwOwoKICAgICAgICBpZiAodG9rZW5zID49IDEwMDAwKSBhbW91bnRCb251cyA9IHRva2VuczsKICAgICAgICBlbHNlIGlmICh0b2tlbnMgPj0gNTAwMCkgYW1vdW50Qm9udXMgPSB0b2tlbnMgKiA2MCAvIDEwMDsKICAgICAgICBlbHNlIGlmICh0b2tlbnMgPj0gMTAwMCkgYW1vdW50Qm9udXMgPSB0b2tlbnMgKiAzMCAvIDEwMDsKICAgICAgICBlbHNlIGlmICh0b2tlbnMgPj0gNTAwKSBhbW91bnRCb251cyA9IHRva2VucyAqIDEwIC8gMTAwOwogICAgICAgIGVsc2UgaWYgKHRva2VucyA+PSAxMDApIGFtb3VudEJvbnVzID0gdG9rZW5zICogNSAvIDEwMDsKICAgICAgICBlbHNlIGlmICh0b2tlbnMgPj0gMTApIGFtb3VudEJvbnVzID0gdG9rZW5zICogMSAvIDEwMDsKCiAgICAgICAgcmV0dXJuIGFtb3VudEJvbnVzOwogICAgfQoKICAgIC8vIHJlcGxhY2UgdGhpcyB3aXRoIGFueSBvdGhlciBwcmljZSBmdW5jdGlvbgogICAgZnVuY3Rpb24gZ2V0UHJpY2UoKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludCByZXN1bHQpIHsKICAgICAgICByZXR1cm4gUFJJQ0U7CiAgICB9CgogICAgLy8KICAgIC8vIE93bmVyIGNhbiBiYXRjaCByZXR1cm4gY29udHJpYnV0b3JzIGNvbnRyaWJ1dGlvbnMoZXRoKQogICAgLy8KICAgIGZ1bmN0aW9uIGJhdGNoUmV0dXJuRXRoSWZGYWlsZWQodWludCBfbnVtYmVyT2ZSZXR1cm5zKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKGNyb3dkc2FsZVN0YXRlICE9IHN0YXRlLmNyb3dkc2FsZUVuZGVkKTsKICAgICAgICAvLyBDaGVjayBpZiBjcm93ZHNhbGUgaGFzIGVuZGVkCiAgICAgICAgcmVxdWlyZShldGhSYWlzZWQgPCBtaW5DYXApOwogICAgICAgIC8vIENoZWNrIGlmIGNyb3dkc2FsZSBoYXMgZmFpbGVkCiAgICAgICAgYWRkcmVzcyBjdXJyZW50UGFydGljaXBhbnRBZGRyZXNzOwogICAgICAgIHVpbnQgY29udHJpYnV0aW9uOwogICAgICAgIGZvciAodWludCBjbnQgPSAwOyBjbnQgPCBfbnVtYmVyT2ZSZXR1cm5zOyBjbnQrKykgewogICAgICAgICAgICBjdXJyZW50UGFydGljaXBhbnRBZGRyZXNzID0gY29udHJpYnV0b3JJbmRleGVzW25leHRDb250cmlidXRvclRvQ2xhaW1dOwogICAgICAgICAgICAvLyBHZXQgbmV4dCB1bmNsYWltZWQgcGFydGljaXBhbnQKICAgICAgICAgICAgaWYgKGN1cnJlbnRQYXJ0aWNpcGFudEFkZHJlc3MgPT0gMHgwKSByZXR1cm47CiAgICAgICAgICAgIC8vIENoZWNrIGlmIGFsbCB0aGUgcGFydGljaXBhbnRzIHdlcmUgY29tcGVuc2F0ZWQKICAgICAgICAgICAgaWYgKCFoYXNDbGFpbWVkRXRoV2hlbkZhaWxbY3VycmVudFBhcnRpY2lwYW50QWRkcmVzc10pIHsvLyBDaGVjayBpZiBwYXJ0aWNpcGFudCBoYXMgYWxyZWFkeSBjbGFpbWVkCiAgICAgICAgICAgICAgICBjb250cmlidXRpb24gPSBjb250cmlidXRvckxpc3RbY3VycmVudFBhcnRpY2lwYW50QWRkcmVzc10uY29udHJpYnV0aW9uQW1vdW50OwogICAgICAgICAgICAgICAgLy8gR2V0IGNvbnRyaWJ1dGlvbiBvZiBwYXJ0aWNpcGFudAogICAgICAgICAgICAgICAgaGFzQ2xhaW1lZEV0aFdoZW5GYWlsW2N1cnJlbnRQYXJ0aWNpcGFudEFkZHJlc3NdID0gdHJ1ZTsKICAgICAgICAgICAgICAgIC8vIFNldCB0aGF0IGhlIGhhcyBjbGFpbWVkCiAgICAgICAgICAgICAgICBiYWxhbmNlc1tjdXJyZW50UGFydGljaXBhbnRBZGRyZXNzXSA9IDA7CiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRQYXJ0aWNpcGFudEFkZHJlc3Muc2VuZChjb250cmlidXRpb24pKSB7Ly8gUmVmdW5kIGV0aAogICAgICAgICAgICAgICAgICAgIEVycm9yU2VuZGluZ0VUSChjdXJyZW50UGFydGljaXBhbnRBZGRyZXNzLCBjb250cmlidXRpb24pOwogICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZXJlIGlzIGFuIGlzc3VlIHJhaXNlIGV2ZW50IGZvciBtYW51YWwgcmVjb3ZlcnkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBuZXh0Q29udHJpYnV0b3JUb0NsYWltICs9IDE7CiAgICAgICAgICAgIC8vIFJlcGVhdAogICAgICAgIH0KICAgIH0KCiAgICAvLwogICAgLy8gT3duZXIgY2FuIHNldCBtdWx0aXNpZyBhZGRyZXNzIGZvciBjcm93ZHNhbGUKICAgIC8vCiAgICBmdW5jdGlvbiBzZXRNdWx0aXNpZ0FkZHJlc3MoYWRkcmVzcyBfbmV3QWRkcmVzcykgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgbXVsdGlzaWcgPSBfbmV3QWRkcmVzczsKICAgIH0KCiAgICAvLwogICAgLy8gUmVnaXN0ZXJzIG5vZGUgd2l0aCByYXRlCiAgICAvLwogICAgZnVuY3Rpb24gcmVnaXN0ZXJOb2RlKHVpbnQyNTYgY2hhcmdpbmdSYXRlLCB1aW50MjU2IHBhcmtpbmdSYXRlKSBwdWJsaWMgewogICAgICAgIGlmIChhdXRob3JpemVkW21zZy5zZW5kZXJdID09IDEpIHJldmVydCgpOwoKICAgICAgICByYXRlT2ZDaGFyZ2luZ1ttc2cuc2VuZGVyXSA9IGNoYXJnaW5nUmF0ZTsKICAgICAgICByYXRlT2ZQYXJraW5nW21zZy5zZW5kZXJdID0gcGFya2luZ1JhdGU7CiAgICAgICAgYXV0aG9yaXplZFttc2cuc2VuZGVyXSA9IDE7CiAgICB9CgogICAgLy8gCiAgICAvLyBCbG9jayBub2RlCiAgICAvLwogICAgZnVuY3Rpb24gYmxvY2tOb2RlIChhZGRyZXNzIG5vZGUpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGF1dGhvcml6ZWRbbm9kZV0gPSAwOwogICAgfQoKICAgIC8vCiAgICAvLyBVcGRhdGVzIG5vZGUgY2hhcmdpbmcgcmF0ZQogICAgLy8gCiAgICBmdW5jdGlvbiB1cGRhdGVDaGFyZ2luZ1JhdGUgKHVpbnQyNTYgcmF0ZSkgcHVibGljIHsKICAgICAgICByYXRlT2ZDaGFyZ2luZ1ttc2cuc2VuZGVyXSA9IHJhdGU7CiAgICB9CgogICAgLy8KICAgIC8vIFVwZGF0ZXMgbm9kZSBwYXJraW5nIHJhdGUKICAgIC8vIAogICAgZnVuY3Rpb24gdXBkYXRlUGFya2luZ1JhdGUgKHVpbnQyNTYgcmF0ZSkgcHVibGljIHsKICAgICAgICByYXRlT2ZDaGFyZ2luZ1ttc2cuc2VuZGVyXSA9IHJhdGU7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhcmdlT24gKGFkZHJlc3Mgbm9kZSwgdWludCB0aW1lKSBwdWJsaWMgewogICAgICAgIC8vIFByZXZlbnQgZnJvbSBub3QgYXV0aG9yaXplZCBub2RlcwogICAgICAgIGlmIChhdXRob3JpemVkW25vZGVdID09IDApIHJldmVydCgpOwogICAgICAgIC8vIFByZXZlbnQgZnJvbSBkb3VibGUgY2hhcmdpbmcKICAgICAgICBpZiAoY2hhcmdpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5pbml0aWFsaXplZCkgcmV2ZXJ0KCk7CgogICAgICAgIC8vIERldGVybWluZSBlbmRUaW1lCiAgICAgICAgdWludCBlbmRUaW1lID0gbm93ICsgdGltZTsKCiAgICAgICAgLy8gUHJldmVudCBmcm9tIHBhc3QgZGF0ZXMKICAgICAgICBpZiAoZW5kVGltZSA8PSBub3cpIHJldmVydCgpOwoKICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIGFtb3VudCBvZiB0b2tlbnMgaGFzIHRvIGJlIHRha2VuIGZyb20gdXNlcnMgYWNjb3VudAogICAgICAgIHVpbnQyNTYgcHJlZGVmaW5lZEFtb3VudCA9IChlbmRUaW1lIC0gbm93KSAqIHJhdGVPZkNoYXJnaW5nW25vZGVdOwoKICAgICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPCBwcmVkZWZpbmVkQW1vdW50KSByZXZlcnQoKTsKCiAgICAgICAgY2hhcmdpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXSA9IENoYXJnaW5nRGF0YShub2RlLCBub3csIGVuZFRpbWUsIHJhdGVPZkNoYXJnaW5nW25vZGVdLCB0cnVlLCBwcmVkZWZpbmVkQW1vdW50KTsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihwcmVkZWZpbmVkQW1vdW50KTsKICAgICAgICByZXNlcnZlZEZ1bmRzQ2hhcmdpbmdbbXNnLnNlbmRlcl0gPSByZXNlcnZlZEZ1bmRzQ2hhcmdpbmdbbXNnLnNlbmRlcl0uYWRkKHByZWRlZmluZWRBbW91bnQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYXJnZU9mZiAoYWRkcmVzcyBub2RlKSBwdWJsaWMgewogICAgICAgIC8vIENoZWNrIHRoYXQgaW5pdGlhbGl6YXRpb24gaGFwcGVuZWQKICAgICAgICBpZiAoIWNoYXJnaW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0uaW5pdGlhbGl6ZWQpIHJldmVydCgpOwogICAgICAgIC8vIENhbGN1bGF0ZSB0aGUgYW1vdW50IGRlcGVuZGluZyBvbiByYXRlCiAgICAgICAgdWludDI1NiBhbW91bnQgPSAobm93IC0gY2hhcmdpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5zdGFydFRpbWUpICogY2hhcmdpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5maXhlZFJhdGU7CiAgICAgICAgLy8gTWF4aW11bSBjYW4gYmUgcHJlZGVmaW5lZEFtb3VudCwgaWYgaXQgbGVzcyB0aGFuIHRoYXQsIHJldHVybiB0b2tlbnMKICAgICAgICBhbW91bnQgPSBhbW91bnQgPiBjaGFyZ2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLnByZWRlZmluZWRBbW91bnQgPyBjaGFyZ2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLnByZWRlZmluZWRBbW91bnQgOiBhbW91bnQ7CgogICAgICAgIC8vIFRha2UgdG9rZW5zIGZyb20gcmVzZXJGdW5kcyBhbmQgcHV0IGl0IG9uIGJhbGFuY2UKICAgICAgICBiYWxhbmNlc1tub2RlXSA9IGJhbGFuY2VzW25vZGVdICsgYW1vdW50OwogICAgICAgIHJlc2VydmVkRnVuZHNDaGFyZ2luZ1ttc2cuc2VuZGVyXSA9IHJlc2VydmVkRnVuZHNDaGFyZ2luZ1ttc2cuc2VuZGVyXSAtIGFtb3VudDsKCiAgICAgICAgLy8gV2hlbiBhbW91bnQgaXMgbGVzcyB0aGFuIHByZWRlZmluZWRBbW91bnQsIHJldHVybiBvdGhlciB0b2tlbnMgdG8gdXNlcgogICAgICAgIGlmIChyZXNlcnZlZEZ1bmRzQ2hhcmdpbmdbbXNnLnNlbmRlcl0gPiAwKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0gKyByZXNlcnZlZEZ1bmRzQ2hhcmdpbmdbbXNnLnNlbmRlcl07CiAgICAgICAgICAgIHJlc2VydmVkRnVuZHNDaGFyZ2luZ1ttc2cuc2VuZGVyXSA9IDA7CiAgICAgICAgfQoKICAgICAgICAvLyBVbmluaXRpYWxpemUKICAgICAgICBjaGFyZ2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLm5vZGUgPSAwOwogICAgICAgIGNoYXJnaW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0uc3RhcnRUaW1lID0gMDsKICAgICAgICBjaGFyZ2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLmVuZFRpbWUgPSAwOwogICAgICAgIGNoYXJnaW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0uZml4ZWRSYXRlID0gMDsKICAgICAgICBjaGFyZ2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLmluaXRpYWxpemVkID0gZmFsc2U7CiAgICAgICAgY2hhcmdpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5wcmVkZWZpbmVkQW1vdW50ID0gMDsKICAgIH0KCiAgICBmdW5jdGlvbiBwYXJraW5nT24gKGFkZHJlc3Mgbm9kZSwgdWludCB0aW1lKSBwdWJsaWMgewogICAgICAgIC8vIFByZXZlbnQgZnJvbSBub3QgYXV0aG9yaXplZCBub2RlcwogICAgICAgIGlmIChhdXRob3JpemVkW25vZGVdID09IDApIHJldmVydCgpOwogICAgICAgIC8vIFByZXZlbnQgZnJvbSBkb3VibGUgY2hhcmdpbmcKICAgICAgICBpZiAocGFya2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLmluaXRpYWxpemVkKSByZXZlcnQoKTsKCiAgICAgICAgaWYgKGJhbGFuY2VzW21zZy5zZW5kZXJdIDwgcHJlZGVmaW5lZEFtb3VudCkgcmV2ZXJ0KCk7CgogICAgICAgIHVpbnQgZW5kVGltZSA9IG5vdyArIHRpbWU7CgogICAgICAgIC8vIFByZXZlbnQgZnJvbSBwYXN0IGRhdGVzCiAgICAgICAgaWYgKGVuZFRpbWUgPD0gbm93KSByZXZlcnQoKTsKCiAgICAgICAgdWludDI1NiBwcmVkZWZpbmVkQW1vdW50ID0gKGVuZFRpbWUgLSBub3cpICogcmF0ZU9mUGFya2luZ1tub2RlXTsKCiAgICAgICAgcGFya2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdID0gUGFya2luZ0RhdGEobm9kZSwgbm93LCBlbmRUaW1lLCByYXRlT2ZQYXJraW5nW25vZGVdLCB0cnVlLCBwcmVkZWZpbmVkQW1vdW50KTsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihwcmVkZWZpbmVkQW1vdW50KTsKICAgICAgICByZXNlcnZlZEZ1bmRzUGFya2luZ1ttc2cuc2VuZGVyXSA9IHJlc2VydmVkRnVuZHNQYXJraW5nW21zZy5zZW5kZXJdLmFkZChwcmVkZWZpbmVkQW1vdW50KTsKICAgIH0KCiAgICAvLyBQYXJraW5nIG9mZiAgICAgCiAgICBmdW5jdGlvbiBwYXJraW5nT2ZmIChhZGRyZXNzIG5vZGUpIHB1YmxpYyB7CiAgICAgICAgaWYgKCFwYXJraW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0uaW5pdGlhbGl6ZWQpIHJldmVydCgpOwoKICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIGFtb3VudCBkZXBlbmRpbmcgb24gcmF0ZQogICAgICAgIHVpbnQyNTYgYW1vdW50ID0gKG5vdyAtIHBhcmtpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5zdGFydFRpbWUpICogcGFya2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLmZpeGVkUmF0ZTsKICAgICAgICAvLyBNYXhpbXVtIGNhbiBiZSBwcmVkZWZpbmVkQW1vdW50LCBpZiBpdCBsZXNzIHRoYW4gdGhhdCwgcmV0dXJuIHRva2VucwogICAgICAgIGFtb3VudCA9IGFtb3VudCA+IHBhcmtpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5wcmVkZWZpbmVkQW1vdW50ID8gcGFya2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLnByZWRlZmluZWRBbW91bnQgOiBhbW91bnQ7CgogICAgICAgIGJhbGFuY2VzW25vZGVdID0gYmFsYW5jZXNbbm9kZV0gKyBhbW91bnQ7CiAgICAgICAgcmVzZXJ2ZWRGdW5kc1BhcmtpbmdbbXNnLnNlbmRlcl0gPSByZXNlcnZlZEZ1bmRzUGFya2luZ1ttc2cuc2VuZGVyXSAtIGFtb3VudDsKCiAgICAgICAgLy8gIAogICAgICAgIGlmIChyZXNlcnZlZEZ1bmRzUGFya2luZ1ttc2cuc2VuZGVyXSA+IDApIHsKICAgICAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXSArIHJlc2VydmVkRnVuZHNQYXJraW5nW21zZy5zZW5kZXJdOwogICAgICAgICAgICAvLyBhbGwgdG9rZW5zIHRha2VuLCBzZXQgdG8gMAogICAgICAgICAgICByZXNlcnZlZEZ1bmRzUGFya2luZ1ttc2cuc2VuZGVyXSA9IDA7CiAgICAgICAgfQoKICAgICAgICAvLyBVbmluaXRpYWxpemUKICAgICAgICBwYXJraW5nU3dpdGNoZXNbbXNnLnNlbmRlcl0ubm9kZSA9IDA7CiAgICAgICAgcGFya2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLnN0YXJ0VGltZSA9IDA7CiAgICAgICAgcGFya2luZ1N3aXRjaGVzW21zZy5zZW5kZXJdLmVuZFRpbWUgPSAwOwogICAgICAgIHBhcmtpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5maXhlZFJhdGUgPSAwOwogICAgICAgIHBhcmtpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5pbml0aWFsaXplZCA9IGZhbHNlOwogICAgICAgIHBhcmtpbmdTd2l0Y2hlc1ttc2cuc2VuZGVyXS5wcmVkZWZpbmVkQW1vdW50ID0gMDsKICAgIH0KCn0='.
	

]
