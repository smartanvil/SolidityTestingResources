Class {
	#name : #SRTd0a2750731af7047ea2692d23fed61095cbf9336,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd0a2750731af7047ea2692d23fed61095cbf9336 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKgogICAgICAgICAgLC9gLgogICAgICAgICwnLyBfX2AuCiAgICAgICwnXy9fICBfIF9gLgogICAgLCdfXy9fIF9fXyBfICBgLgogICwnXyAgL19fXyBfXyBfIF9fIGAuCiAnLS4uXy9fX18uLi4tIi0uLS4uX19gLgogIEIKCiBFdGhQeXJhbWlkLiBBIG5vLWJ1bGxzaGl0LCB0cmFuc3BhcmVudCwgc2VsZi1zdXN0YWluaW5nIHB5cmFtaWQgc2NoZW1lLgogCiBJbnNwaXJlZCBieSBodHRwczovL3Rlc3Quam9jaGVuLWhvZW5pY2tlLmRlL2V0aC9wb256aXRva2VuLwoKIERldmVsb3BlcnM6CiAgICBBcmMKICAgIERpdmluZQogICAgTm9yc2VmaXJlCiAgICBUb0NzSWNLCiAgICAKIEZyb250LUVuZDoKICAgIENhcmRpb3RoCiAgICB0ZW5tZWkKICAgIFRyZW5kaXVtCiAgICAKIE1vcmFsIFN1cHBvcnQ6CiAgICBEZWFkQ293LlJhdAogICAgRG90cwogICAgRmF0S3JlYW15CiAgICBLYXNleWxvbAogICAgUXVhbnR1bURlYXRoNjY2CiAgICBRdWVudGluCiAKIFNoaXQtVGllcjoKICAgIEhlbnRhaUNocmlzdAogCiovCgpjb250cmFjdCBFdGhQeXJhbWlkMyB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3MgcHVibGljIE93bmVyID0gbXNnLnNlbmRlcjsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCgogICAgLy8gc2NhbGVGYWN0b3IgaXMgdXNlZCB0byBjb252ZXJ0IEV0aGVyIGludG8gdG9rZW5zIGFuZCB2aWNlLXZlcnNhOiB0aGV5J3JlIG9mIGRpZmZlcmVudAogICAgLy8gb3JkZXJzIG9mIG1hZ25pdHVkZSwgaGVuY2UgdGhlIG5lZWQgdG8gYnJpZGdlIGJldHdlZW4gdGhlIHR3by4KICAgIHVpbnQyNTYgY29uc3RhbnQgc2NhbGVGYWN0b3IgPSAweDEwMDAwMDAwMDAwMDAwMDAwOyAgLy8gMl42NAoKICAgIC8vIENSUiA9IDUwJQogICAgLy8gQ1JSIGlzIENhc2ggUmVzZXJ2ZSBSYXRpbyAoaW4gdGhpcyBjYXNlIENyeXB0byBSZXNlcnZlIFJhdGlvKS4KICAgIC8vIEZvciBtb3JlIG9uIHRoaXM6IGNoZWNrIG91dCBodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9SZXNlcnZlX3JlcXVpcmVtZW50CiAgICBpbnQgY29uc3RhbnQgY3JyX24gPSAxOyAvLyBDUlIgbnVtZXJhdG9yCiAgICBpbnQgY29uc3RhbnQgY3JyX2QgPSAyOyAvLyBDUlIgZGVub21pbmF0b3IKCiAgICAvLyBUaGUgcHJpY2UgY29lZmZpY2llbnQuIENob3NlbiBzdWNoIHRoYXQgYXQgMSB0b2tlbiB0b3RhbCBzdXBwbHkKICAgIC8vIHRoZSBhbW91bnQgaW4gcmVzZXJ2ZSBpcyAwLjUgZXRoZXIgYW5kIHRva2VuIHByaWNlIGlzIDEgRXRoZXIuCiAgICBpbnQgY29uc3RhbnQgcHJpY2VfY29lZmYgPSAtMHgyOTZBQkY3ODRBMzU4NDY4QzsKCiAgICAvLyBUeXBpY2FsIHZhbHVlcyB0aGF0IHdlIGhhdmUgdG8gZGVjbGFyZS4KICAgIHN0cmluZyBjb25zdGFudCBwdWJsaWMgbmFtZSA9ICJFdGhQeXJhbWlkIjsKICAgIHN0cmluZyBjb25zdGFudCBwdWJsaWMgc3ltYm9sID0gIkVQWSI7CiAgICB1aW50OCBjb25zdGFudCBwdWJsaWMgZGVjaW1hbHMgPSAxODsKCiAgICAvLyBBcnJheSBiZXR3ZWVuIGVhY2ggYWRkcmVzcyBhbmQgdGhlaXIgbnVtYmVyIG9mIHRva2Vucy4KICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgdG9rZW5CYWxhbmNlOwogICAgICAgIAogICAgLy8gQXJyYXkgYmV0d2VlbiBlYWNoIGFkZHJlc3MgYW5kIGhvdyBtdWNoIEV0aGVyIGhhcyBiZWVuIHBhaWQgb3V0IHRvIGl0LgogICAgLy8gTm90ZSB0aGF0IHRoaXMgaXMgc2NhbGVkIGJ5IHRoZSBzY2FsZUZhY3RvciB2YXJpYWJsZS4KICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBpbnQyNTYpIHB1YmxpYyBwYXlvdXRzOwoKICAgIC8vIFZhcmlhYmxlIHRyYWNraW5nIGhvdyBtYW55IHRva2VucyBhcmUgaW4gZXhpc3RlbmNlIG92ZXJhbGwuCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgICAvLyBBZ2dyZWdhdGUgc3VtIG9mIGFsbCBwYXlvdXRzLgogICAgLy8gTm90ZSB0aGF0IHRoaXMgaXMgc2NhbGVkIGJ5IHRoZSBzY2FsZUZhY3RvciB2YXJpYWJsZS4KICAgIGludDI1NiB0b3RhbFBheW91dHM7CgogICAgLy8gVmFyaWFibGUgdHJhY2tpbmcgaG93IG11Y2ggRXRoZXIgZWFjaCB0b2tlbiBpcyBjdXJyZW50bHkgd29ydGguCiAgICAvLyBOb3RlIHRoYXQgdGhpcyBpcyBzY2FsZWQgYnkgdGhlIHNjYWxlRmFjdG9yIHZhcmlhYmxlLgogICAgdWludDI1NiBlYXJuaW5nc1BlclRva2VuOwogICAgCiAgICAvLyBDdXJyZW50IGNvbnRyYWN0IGJhbGFuY2UgaW4gRXRoZXIKICAgIHVpbnQyNTYgcHVibGljIGNvbnRyYWN0QmFsYW5jZTsKCiAgICBmdW5jdGlvbiBFdGhQeXJhbWlkKCkgcHVibGljIHt9CgogICAgLy8gVGhlIGZvbGxvd2luZyBmdW5jdGlvbnMgYXJlIHVzZWQgYnkgdGhlIGZyb250LWVuZCBmb3IgZGlzcGxheSBwdXJwb3Nlcy4KCiAgICAvLyBSZXR1cm5zIHRoZSBudW1iZXIgb2YgdG9rZW5zIGN1cnJlbnRseSBoZWxkIGJ5IF9vd25lci4KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgICAgIHJldHVybiB0b2tlbkJhbGFuY2VbX293bmVyXTsKICAgIH0KCiAgICAvLyBXaXRoZHJhd3MgYWxsIGRpdmlkZW5kcyBoZWxkIGJ5IHRoZSBjYWxsZXIgc2VuZGluZyB0aGUgdHJhbnNhY3Rpb24sIHVwZGF0ZXMKICAgIC8vIHRoZSByZXF1aXNpdGUgZ2xvYmFsIHZhcmlhYmxlcywgYW5kIHRyYW5zZmVycyBFdGhlciBiYWNrIHRvIHRoZSBjYWxsZXIuCiAgICBmdW5jdGlvbiB3aXRoZHJhdygpIHB1YmxpYyB7CiAgICAgICAgLy8gUmV0cmlldmUgdGhlIGRpdmlkZW5kcyBhc3NvY2lhdGVkIHdpdGggdGhlIGFkZHJlc3MgdGhlIHJlcXVlc3QgY2FtZSBmcm9tLgogICAgICAgIHZhciBiYWxhbmNlID0gZGl2aWRlbmRzKG1zZy5zZW5kZXIpOwogICAgICAgIAogICAgICAgIC8vIFVwZGF0ZSB0aGUgcGF5b3V0cyBhcnJheSwgaW5jcmVtZW50aW5nIHRoZSByZXF1ZXN0IGFkZHJlc3MgYnkgYGJhbGFuY2VgLgogICAgICAgIHBheW91dHNbbXNnLnNlbmRlcl0gKz0gKGludDI1NikgKGJhbGFuY2UgKiBzY2FsZUZhY3Rvcik7CiAgICAgICAgCiAgICAgICAgLy8gSW5jcmVhc2UgdGhlIHRvdGFsIGFtb3VudCB0aGF0J3MgYmVlbiBwYWlkIG91dCB0byBtYWludGFpbiBpbnZhcmlhbmNlLgogICAgICAgIHRvdGFsUGF5b3V0cyArPSAoaW50MjU2KSAoYmFsYW5jZSAqIHNjYWxlRmFjdG9yKTsKICAgICAgICAKICAgICAgICAvLyBTZW5kIHRoZSBkaXZpZGVuZHMgdG8gdGhlIGFkZHJlc3MgdGhhdCByZXF1ZXN0ZWQgdGhlIHdpdGhkcmF3LgogICAgICAgIGNvbnRyYWN0QmFsYW5jZSA9IHN1Yihjb250cmFjdEJhbGFuY2UsIGJhbGFuY2UpOwogICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoYmFsYW5jZSk7CiAgICB9CgogICAgLy8gQ29udmVydHMgdGhlIEV0aGVyIGFjY3J1ZWQgYXMgZGl2aWRlbmRzIGJhY2sgaW50byBFUFkgdG9rZW5zIHdpdGhvdXQgaGF2aW5nIHRvCiAgICAvLyB3aXRoZHJhdyBpdCBmaXJzdC4gU2F2ZXMgb24gZ2FzIGFuZCBwb3RlbnRpYWwgcHJpY2Ugc3Bpa2UgbG9zcy4KICAgIGZ1bmN0aW9uIHJlaW52ZXN0RGl2aWRlbmRzKCkgcHVibGljIHsKICAgICAgICAvLyBSZXRyaWV2ZSB0aGUgZGl2aWRlbmRzIGFzc29jaWF0ZWQgd2l0aCB0aGUgYWRkcmVzcyB0aGUgcmVxdWVzdCBjYW1lIGZyb20uCiAgICAgICAgdmFyIGJhbGFuY2UgPSBkaXZpZGVuZHMobXNnLnNlbmRlcik7CiAgICAgICAgCiAgICAgICAgLy8gVXBkYXRlIHRoZSBwYXlvdXRzIGFycmF5LCBpbmNyZW1lbnRpbmcgdGhlIHJlcXVlc3QgYWRkcmVzcyBieSBgYmFsYW5jZWAuCiAgICAgICAgLy8gU2luY2UgdGhpcyBpcyBlc3NlbnRpYWxseSBhIHNob3J0Y3V0IHRvIHdpdGhkcmF3aW5nIGFuZCByZWludmVzdGluZywgdGhpcyBzdGVwIHN0aWxsIGhvbGRzLgogICAgICAgIHBheW91dHNbbXNnLnNlbmRlcl0gKz0gKGludDI1NikgKGJhbGFuY2UgKiBzY2FsZUZhY3Rvcik7CiAgICAgICAgCiAgICAgICAgLy8gSW5jcmVhc2UgdGhlIHRvdGFsIGFtb3VudCB0aGF0J3MgYmVlbiBwYWlkIG91dCB0byBtYWludGFpbiBpbnZhcmlhbmNlLgogICAgICAgIHRvdGFsUGF5b3V0cyArPSAoaW50MjU2KSAoYmFsYW5jZSAqIHNjYWxlRmFjdG9yKTsKICAgICAgICAKICAgICAgICAvLyBBc3NpZ24gYmFsYW5jZSB0byBhIG5ldyB2YXJpYWJsZS4KICAgICAgICB1aW50IHZhbHVlXyA9ICh1aW50KSAoYmFsYW5jZSk7CiAgICAgICAgCiAgICAgICAgLy8gSWYgeW91ciBkaXZpZGVuZHMgYXJlIHdvcnRoIGxlc3MgdGhhbiAxIHN6YWJvLCBvciBtb3JlIHRoYW4gYSBtaWxsaW9uIEV0aGVyCiAgICAgICAgLy8gKGluIHdoaWNoIGNhc2UsIHdoeSBhcmUgeW91IGV2ZW4gaGVyZSksIGFib3J0LgogICAgICAgIGlmICh2YWx1ZV8gPCAwLjAwMDAwMSBldGhlciB8fCB2YWx1ZV8gPiAxMDAwMDAwIGV0aGVyKQogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICAgICAgCiAgICAgICAgLy8gbXNnLnNlbmRlciBpcyB0aGUgYWRkcmVzcyBvZiB0aGUgY2FsbGVyLgogICAgICAgIHZhciBzZW5kZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIAogICAgICAgIC8vIEEgdGVtcG9yYXJ5IHJlc2VydmUgdmFyaWFibGUgdXNlZCBmb3IgY2FsY3VsYXRpbmcgdGhlIHJld2FyZCB0aGUgaG9sZGVyIGdldHMgZm9yIGJ1eWluZyB0b2tlbnMuCiAgICAgICAgLy8gKFllcywgdGhlIGJ1eWVyIHJlY2VpdmVzIGEgcGFydCBvZiB0aGUgZGlzdHJpYnV0aW9uIGFzIHdlbGwhKQogICAgICAgIHZhciByZXMgPSByZXNlcnZlKCkgLSBiYWxhbmNlOwoKICAgICAgICAvLyAxMCUgb2YgdGhlIHRvdGFsIEV0aGVyIHNlbnQgaXMgdXNlZCB0byBwYXkgZXhpc3RpbmcgaG9sZGVycy4KICAgICAgICB2YXIgZmVlID0gZGl2KHZhbHVlXywgMTApOwogICAgICAgIAogICAgICAgIC8vIFRoZSBhbW91bnQgb2YgRXRoZXIgdXNlZCB0byBwdXJjaGFzZSBuZXcgdG9rZW5zIGZvciB0aGUgY2FsbGVyLgogICAgICAgIHZhciBudW1FdGhlciA9IHZhbHVlXyAtIGZlZTsKICAgICAgICAKICAgICAgICAvLyBUaGUgbnVtYmVyIG9mIHRva2VucyB3aGljaCBjYW4gYmUgcHVyY2hhc2VkIGZvciBudW1FdGhlci4KICAgICAgICB2YXIgbnVtVG9rZW5zID0gY2FsY3VsYXRlRGl2aWRlbmRUb2tlbnMobnVtRXRoZXIsIGJhbGFuY2UpOwogICAgICAgIAogICAgICAgIC8vIFRoZSBidXllciBmZWUsIHNjYWxlZCBieSB0aGUgc2NhbGVGYWN0b3IgdmFyaWFibGUuCiAgICAgICAgdmFyIGJ1eWVyRmVlID0gZmVlICogc2NhbGVGYWN0b3I7CiAgICAgICAgCiAgICAgICAgLy8gQ2hlY2sgdGhhdCB3ZSBoYXZlIHRva2VucyBpbiBleGlzdGVuY2UgKHRoaXMgc2hvdWxkIGFsd2F5cyBiZSB0cnVlKSwgb3IKICAgICAgICAvLyBlbHNlIHlvdSdyZSBnb25uYSBoYXZlIGEgYmFkIHRpbWUuCiAgICAgICAgaWYgKHRvdGFsU3VwcGx5ID4gMCkgewogICAgICAgICAgICAvLyBDb21wdXRlIHRoZSBib251cyBjby1lZmZpY2llbnQgZm9yIGFsbCBleGlzdGluZyBob2xkZXJzIGFuZCB0aGUgYnV5ZXIuCiAgICAgICAgICAgIC8vIFRoZSBidXllciByZWNlaXZlcyBwYXJ0IG9mIHRoZSBkaXN0cmlidXRpb24gZm9yIGVhY2ggdG9rZW4gYm91Z2h0IGluIHRoZQogICAgICAgICAgICAvLyBzYW1lIHdheSB0aGV5IHdvdWxkIGhhdmUgaWYgdGhleSBib3VnaHQgZWFjaCB0b2tlbiBpbmRpdmlkdWFsbHkuCiAgICAgICAgICAgIHZhciBib251c0NvRWZmID0KICAgICAgICAgICAgICAgIChzY2FsZUZhY3RvciAtIChyZXMgKyBudW1FdGhlcikgKiBudW1Ub2tlbnMgKiBzY2FsZUZhY3RvciAvICh0b3RhbFN1cHBseSArIG51bVRva2VucykgLyBudW1FdGhlcikKICAgICAgICAgICAgICAgICogKHVpbnQpKGNycl9kKSAvICh1aW50KShjcnJfZC1jcnJfbik7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgLy8gVGhlIHRvdGFsIHJld2FyZCB0byBiZSBkaXN0cmlidXRlZCBhbW9uZ3N0IHRoZSBtYXNzZXMgaXMgdGhlIGZlZSAoaW4gRXRoZXIpCiAgICAgICAgICAgIC8vIG11bHRpcGxpZWQgYnkgdGhlIGJvbnVzIGNvLWVmZmljaWVudC4KICAgICAgICAgICAgdmFyIGhvbGRlclJld2FyZCA9IGZlZSAqIGJvbnVzQ29FZmY7CiAgICAgICAgICAgIAogICAgICAgICAgICBidXllckZlZSAtPSBob2xkZXJSZXdhcmQ7CgogICAgICAgICAgICAvLyBGZWUgaXMgZGlzdHJpYnV0ZWQgdG8gYWxsIGV4aXN0aW5nIHRva2VuIGhvbGRlcnMgYmVmb3JlIHRoZSBuZXcgdG9rZW5zIGFyZSBwdXJjaGFzZWQuCiAgICAgICAgICAgIC8vIHJld2FyZFBlclNoYXJlIGlzIHRoZSBhbW91bnQgZ2FpbmVkIHBlciB0b2tlbiB0aGFua3MgdG8gdGhpcyBidXktaW4uCiAgICAgICAgICAgIHZhciByZXdhcmRQZXJTaGFyZSA9IGhvbGRlclJld2FyZCAvIHRvdGFsU3VwcGx5OwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gVGhlIEV0aGVyIHZhbHVlIHBlciB0b2tlbiBpcyBpbmNyZWFzZWQgcHJvcG9ydGlvbmFsbHkuCiAgICAgICAgICAgIGVhcm5pbmdzUGVyVG9rZW4gKz0gcmV3YXJkUGVyU2hhcmU7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIEFkZCB0aGUgbnVtVG9rZW5zIHdoaWNoIHdlcmUganVzdCBjcmVhdGVkIHRvIHRoZSB0b3RhbCBzdXBwbHkuIFdlJ3JlIGEgY3J5cHRvIGNlbnRyYWwgYmFuayEKICAgICAgICB0b3RhbFN1cHBseSA9IGFkZCh0b3RhbFN1cHBseSwgbnVtVG9rZW5zKTsKICAgICAgICAKICAgICAgICAvLyBBc3NpZ24gdGhlIHRva2VucyB0byB0aGUgYmFsYW5jZSBvZiB0aGUgYnV5ZXIuCiAgICAgICAgdG9rZW5CYWxhbmNlW3NlbmRlcl0gPSBhZGQodG9rZW5CYWxhbmNlW3NlbmRlcl0sIG51bVRva2Vucyk7CiAgICAgICAgCiAgICAgICAgLy8gVXBkYXRlIHRoZSBwYXlvdXQgYXJyYXkgc28gdGhhdCB0aGUgYnV5ZXIgY2Fubm90IGNsYWltIGRpdmlkZW5kcyBvbiBwcmV2aW91cyBwdXJjaGFzZXMuCiAgICAgICAgLy8gQWxzbyBpbmNsdWRlIHRoZSBmZWUgcGFpZCBmb3IgZW50ZXJpbmcgdGhlIHNjaGVtZS4KICAgICAgICAvLyBGaXJzdCB3ZSBjb21wdXRlIGhvdyBtdWNoIHdhcyBqdXN0IHBhaWQgb3V0IHRvIHRoZSBidXllci4uLgogICAgICAgIHZhciBwYXlvdXREaWZmICA9IChpbnQyNTYpICgoZWFybmluZ3NQZXJUb2tlbiAqIG51bVRva2VucykgLSBidXllckZlZSk7CiAgICAgICAgCiAgICAgICAgLy8gVGhlbiB3ZSB1cGRhdGUgdGhlIHBheW91dHMgYXJyYXkgZm9yIHRoZSBidXllciB3aXRoIHRoaXMgYW1vdW50Li4uCiAgICAgICAgcGF5b3V0c1tzZW5kZXJdICs9IHBheW91dERpZmY7CiAgICAgICAgCiAgICAgICAgLy8gQW5kIHRoZW4gd2UgZmluYWxseSBhZGQgaXQgdG8gdGhlIHZhcmlhYmxlIHRyYWNraW5nIHRoZSB0b3RhbCBhbW91bnQgc3BlbnQgdG8gbWFpbnRhaW4gaW52YXJpYW5jZS4KICAgICAgICB0b3RhbFBheW91dHMgICAgKz0gcGF5b3V0RGlmZjsKICAgICAgICAKICAgIH0KCiAgICAvLyBTZWxscyB5b3VyIHRva2VucyBmb3IgRXRoZXIuIFRoaXMgRXRoZXIgaXMgYXNzaWduZWQgdG8gdGhlIGNhbGxlcnMgZW50cnkKICAgIC8vIGluIHRoZSB0b2tlbkJhbGFuY2UgYXJyYXksIGFuZCB0aGVyZWZvcmUgaXMgc2hvd24gYXMgYSBkaXZpZGVuZC4gQSBzZWNvbmQKICAgIC8vIGNhbGwgdG8gd2l0aGRyYXcoKSBtdXN0IGJlIG1hZGUgdG8gaW52b2tlIHRoZSB0cmFuc2ZlciBvZiBFdGhlciBiYWNrIHRvIHlvdXIgYWRkcmVzcy4KICAgIGZ1bmN0aW9uIHNlbGxNeVRva2VucygpIHB1YmxpYyB7CiAgICAgICAgdmFyIGJhbGFuY2UgPSBiYWxhbmNlT2YobXNnLnNlbmRlcik7CiAgICAgICAgc2VsbChiYWxhbmNlKTsKICAgIH0KCiAgICAvLyBUaGUgc2xhbS10aGUtYnV0dG9uIGVzY2FwZSBoYXRjaC4gU2VsbHMgdGhlIGNhbGxlcnMgdG9rZW5zIGZvciBFdGhlciwgdGhlbiBpbW1lZGlhdGVseQogICAgLy8gaW52b2tlcyB0aGUgd2l0aGRyYXcoKSBmdW5jdGlvbiwgc2VuZGluZyB0aGUgcmVzdWx0aW5nIEV0aGVyIHRvIHRoZSBjYWxsZXJzIGFkZHJlc3MuCiAgICBmdW5jdGlvbiBnZXRNZU91dE9mSGVyZSgpIHB1YmxpYyB7CiAgICAgICAgc2VsbE15VG9rZW5zKCk7CiAgICAgICAgd2l0aGRyYXcoKTsKICAgIH0KCiAgICAvLyBHYXRla2VlcGVyIGZ1bmN0aW9uIHRvIGNoZWNrIGlmIHRoZSBhbW91bnQgb2YgRXRoZXIgYmVpbmcgc2VudCBpc24ndCBlaXRoZXIKICAgIC8vIHRvbyBzbWFsbCBvciB0b28gbGFyZ2UuIElmIGl0IHBhc3NlcywgZ29lcyBkaXJlY3QgdG8gYnV5KCkuCiAgICBmdW5jdGlvbiBmdW5kKCkgcGF5YWJsZSBwdWJsaWMgewogICAgICAgIC8vIERvbid0IGFsbG93IGZvciBmdW5kaW5nIGlmIHRoZSBhbW91bnQgb2YgRXRoZXIgc2VudCBpcyBsZXNzIHRoYW4gMSBzemFiby4KICAgICAgICBpZiAobXNnLnZhbHVlID4gMC4wMDQgZXRoZXIpIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPd25lci50cmFuc2Zlcihtc2cudmFsdWUpOyB9IGVsc2UgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgY29udHJhY3RCYWxhbmNlID0gYWRkKGNvbnRyYWN0QmFsYW5jZSwgbXNnLnZhbHVlKTsKICAgICAgICAgICAgYnV5KCk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIEZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgKGR5bmFtaWMpIHByaWNlIG9mIGJ1eWluZyBhIGZpbm5leSB3b3J0aCBvZiB0b2tlbnMuCiAgICBmdW5jdGlvbiBidXlQcmljZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIGdldFRva2Vuc0ZvckV0aGVyKDEgZmlubmV5KTsKICAgIH0KCiAgICAvLyBGdW5jdGlvbiB0aGF0IHJldHVybnMgdGhlIChkeW5hbWljKSBwcmljZSBvZiBzZWxsaW5nIGEgc2luZ2xlIHRva2VuLgogICAgZnVuY3Rpb24gc2VsbFByaWNlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICB2YXIgZXRoID0gZ2V0RXRoZXJGb3JUb2tlbnMoMSBmaW5uZXkpOwogICAgICAgIHZhciBmZWUgPSBkaXYoZXRoLCAxMCk7CiAgICAgICAgcmV0dXJuIGV0aCAtIGZlZTsKICAgIH0KCiAgICAvLyBDYWxjdWxhdGUgdGhlIGN1cnJlbnQgZGl2aWRlbmRzIGFzc29jaWF0ZWQgd2l0aCB0aGUgY2FsbGVyIGFkZHJlc3MuIFRoaXMgaXMgdGhlIG5ldCByZXN1bHQKICAgIC8vIG9mIG11bHRpcGx5aW5nIHRoZSBudW1iZXIgb2YgdG9rZW5zIGhlbGQgYnkgdGhlaXIgY3VycmVudCB2YWx1ZSBpbiBFdGhlciBhbmQgc3VidHJhY3RpbmcgdGhlCiAgICAvLyBFdGhlciB0aGF0IGhhcyBhbHJlYWR5IGJlZW4gcGFpZCBvdXQuCiAgICBmdW5jdGlvbiBkaXZpZGVuZHMoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGFtb3VudCkgewogICAgICAgIHJldHVybiAodWludDI1NikgKChpbnQyNTYpKGVhcm5pbmdzUGVyVG9rZW4gKiB0b2tlbkJhbGFuY2VbX293bmVyXSkgLSBwYXlvdXRzW19vd25lcl0pIC8gc2NhbGVGYWN0b3I7CiAgICB9CgogICAgLy8gVmVyc2lvbiBvZiB3aXRoZHJhdyB0aGF0IGV4dHJhY3RzIHRoZSBkaXZpZGVuZHMgYW5kIHNlbmRzIHRoZSBFdGhlciB0byB0aGUgY2FsbGVyLgogICAgLy8gVGhpcyBpcyBvbmx5IHVzZWQgaW4gdGhlIGNhc2Ugd2hlbiB0aGVyZSBpcyBubyB0cmFuc2FjdGlvbiBkYXRhLCBhbmQgdGhhdCBzaG91bGQgYmUKICAgIC8vIHF1aXRlIHJhcmUgdW5sZXNzIGludGVyYWN0aW5nIGRpcmVjdGx5IHdpdGggdGhlIHNtYXJ0IGNvbnRyYWN0LgogICAgZnVuY3Rpb24gd2l0aGRyYXdPbGQoYWRkcmVzcyB0bykgcHVibGljIHsKICAgICAgICAvLyBSZXRyaWV2ZSB0aGUgZGl2aWRlbmRzIGFzc29jaWF0ZWQgd2l0aCB0aGUgYWRkcmVzcyB0aGUgcmVxdWVzdCBjYW1lIGZyb20uCiAgICAgICAgdmFyIGJhbGFuY2UgPSBkaXZpZGVuZHMobXNnLnNlbmRlcik7CiAgICAgICAgCiAgICAgICAgLy8gVXBkYXRlIHRoZSBwYXlvdXRzIGFycmF5LCBpbmNyZW1lbnRpbmcgdGhlIHJlcXVlc3QgYWRkcmVzcyBieSBgYmFsYW5jZWAuCiAgICAgICAgcGF5b3V0c1ttc2cuc2VuZGVyXSArPSAoaW50MjU2KSAoYmFsYW5jZSAqIHNjYWxlRmFjdG9yKTsKICAgICAgICAKICAgICAgICAvLyBJbmNyZWFzZSB0aGUgdG90YWwgYW1vdW50IHRoYXQncyBiZWVuIHBhaWQgb3V0IHRvIG1haW50YWluIGludmFyaWFuY2UuCiAgICAgICAgdG90YWxQYXlvdXRzICs9IChpbnQyNTYpIChiYWxhbmNlICogc2NhbGVGYWN0b3IpOwogICAgICAgIAogICAgICAgIC8vIFNlbmQgdGhlIGRpdmlkZW5kcyB0byB0aGUgYWRkcmVzcyB0aGF0IHJlcXVlc3RlZCB0aGUgd2l0aGRyYXcuCiAgICAgICAgY29udHJhY3RCYWxhbmNlID0gc3ViKGNvbnRyYWN0QmFsYW5jZSwgYmFsYW5jZSk7CiAgICAgICAgdG8udHJhbnNmZXIoYmFsYW5jZSk7ICAgICAgIAogICAgfQoKICAgIC8vIEludGVybmFsIGJhbGFuY2UgZnVuY3Rpb24sIHVzZWQgdG8gY2FsY3VsYXRlIHRoZSBkeW5hbWljIHJlc2VydmUgdmFsdWUuCiAgICBmdW5jdGlvbiBiYWxhbmNlKCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBhbW91bnQpIHsKICAgICAgICAvLyBtc2cudmFsdWUgaXMgdGhlIGFtb3VudCBvZiBFdGhlciBzZW50IGJ5IHRoZSB0cmFuc2FjdGlvbi4KICAgICAgICByZXR1cm4gY29udHJhY3RCYWxhbmNlIC0gbXNnLnZhbHVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGJ1eSgpIGludGVybmFsIHsKICAgICAgICAvLyBBbnkgdHJhbnNhY3Rpb24gb2YgbGVzcyB0aGFuIDEgc3phYm8gaXMgbGlrZWx5IHRvIGJlIHdvcnRoIGxlc3MgdGhhbiB0aGUgZ2FzIHVzZWQgdG8gc2VuZCBpdC4KICAgICAgICBpZiAobXNnLnZhbHVlIDwgMC4wMDAwMDEgZXRoZXIgfHwgbXNnLnZhbHVlID4gMTAwMDAwMCBldGhlcikKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIC8vIG1zZy5zZW5kZXIgaXMgdGhlIGFkZHJlc3Mgb2YgdGhlIGNhbGxlci4KICAgICAgICB2YXIgc2VuZGVyID0gbXNnLnNlbmRlcjsKICAgICAgICAKICAgICAgICAvLyAxMCUgb2YgdGhlIHRvdGFsIEV0aGVyIHNlbnQgaXMgdXNlZCB0byBwYXkgZXhpc3RpbmcgaG9sZGVycy4KICAgICAgICB2YXIgZmVlID0gZGl2KG1zZy52YWx1ZSwgMTApOwogICAgICAgIAogICAgICAgIC8vIFRoZSBhbW91bnQgb2YgRXRoZXIgdXNlZCB0byBwdXJjaGFzZSBuZXcgdG9rZW5zIGZvciB0aGUgY2FsbGVyLgogICAgICAgIHZhciBudW1FdGhlciA9IG1zZy52YWx1ZSAtIGZlZTsKICAgICAgICAKICAgICAgICAvLyBUaGUgbnVtYmVyIG9mIHRva2VucyB3aGljaCBjYW4gYmUgcHVyY2hhc2VkIGZvciBudW1FdGhlci4KICAgICAgICB2YXIgbnVtVG9rZW5zID0gZ2V0VG9rZW5zRm9yRXRoZXIobnVtRXRoZXIpOwogICAgICAgIAogICAgICAgIC8vIFRoZSBidXllciBmZWUsIHNjYWxlZCBieSB0aGUgc2NhbGVGYWN0b3IgdmFyaWFibGUuCiAgICAgICAgdmFyIGJ1eWVyRmVlID0gZmVlICogc2NhbGVGYWN0b3I7CiAgICAgICAgCiAgICAgICAgLy8gQ2hlY2sgdGhhdCB3ZSBoYXZlIHRva2VucyBpbiBleGlzdGVuY2UgKHRoaXMgc2hvdWxkIGFsd2F5cyBiZSB0cnVlKSwgb3IKICAgICAgICAvLyBlbHNlIHlvdSdyZSBnb25uYSBoYXZlIGEgYmFkIHRpbWUuCiAgICAgICAgaWYgKHRvdGFsU3VwcGx5ID4gMCkgewogICAgICAgICAgICAvLyBDb21wdXRlIHRoZSBib251cyBjby1lZmZpY2llbnQgZm9yIGFsbCBleGlzdGluZyBob2xkZXJzIGFuZCB0aGUgYnV5ZXIuCiAgICAgICAgICAgIC8vIFRoZSBidXllciByZWNlaXZlcyBwYXJ0IG9mIHRoZSBkaXN0cmlidXRpb24gZm9yIGVhY2ggdG9rZW4gYm91Z2h0IGluIHRoZQogICAgICAgICAgICAvLyBzYW1lIHdheSB0aGV5IHdvdWxkIGhhdmUgaWYgdGhleSBib3VnaHQgZWFjaCB0b2tlbiBpbmRpdmlkdWFsbHkuCiAgICAgICAgICAgIHZhciBib251c0NvRWZmID0KICAgICAgICAgICAgICAgIChzY2FsZUZhY3RvciAtIChyZXNlcnZlKCkgKyBudW1FdGhlcikgKiBudW1Ub2tlbnMgKiBzY2FsZUZhY3RvciAvICh0b3RhbFN1cHBseSArIG51bVRva2VucykgLyBudW1FdGhlcikKICAgICAgICAgICAgICAgICogKHVpbnQpKGNycl9kKSAvICh1aW50KShjcnJfZC1jcnJfbik7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgLy8gVGhlIHRvdGFsIHJld2FyZCB0byBiZSBkaXN0cmlidXRlZCBhbW9uZ3N0IHRoZSBtYXNzZXMgaXMgdGhlIGZlZSAoaW4gRXRoZXIpCiAgICAgICAgICAgIC8vIG11bHRpcGxpZWQgYnkgdGhlIGJvbnVzIGNvLWVmZmljaWVudC4KICAgICAgICAgICAgdmFyIGhvbGRlclJld2FyZCA9IGZlZSAqIGJvbnVzQ29FZmY7CiAgICAgICAgICAgIAogICAgICAgICAgICBidXllckZlZSAtPSBob2xkZXJSZXdhcmQ7CgogICAgICAgICAgICAvLyBGZWUgaXMgZGlzdHJpYnV0ZWQgdG8gYWxsIGV4aXN0aW5nIHRva2VuIGhvbGRlcnMgYmVmb3JlIHRoZSBuZXcgdG9rZW5zIGFyZSBwdXJjaGFzZWQuCiAgICAgICAgICAgIC8vIHJld2FyZFBlclNoYXJlIGlzIHRoZSBhbW91bnQgZ2FpbmVkIHBlciB0b2tlbiB0aGFua3MgdG8gdGhpcyBidXktaW4uCiAgICAgICAgICAgIHZhciByZXdhcmRQZXJTaGFyZSA9IGhvbGRlclJld2FyZCAvIHRvdGFsU3VwcGx5OwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gVGhlIEV0aGVyIHZhbHVlIHBlciB0b2tlbiBpcyBpbmNyZWFzZWQgcHJvcG9ydGlvbmFsbHkuCiAgICAgICAgICAgIGVhcm5pbmdzUGVyVG9rZW4gKz0gcmV3YXJkUGVyU2hhcmU7CiAgICAgICAgICAgIAogICAgICAgIH0KCiAgICAgICAgLy8gQWRkIHRoZSBudW1Ub2tlbnMgd2hpY2ggd2VyZSBqdXN0IGNyZWF0ZWQgdG8gdGhlIHRvdGFsIHN1cHBseS4gV2UncmUgYSBjcnlwdG8gY2VudHJhbCBiYW5rIQogICAgICAgIHRvdGFsU3VwcGx5ID0gYWRkKHRvdGFsU3VwcGx5LCBudW1Ub2tlbnMpOwoKICAgICAgICAvLyBBc3NpZ24gdGhlIHRva2VucyB0byB0aGUgYmFsYW5jZSBvZiB0aGUgYnV5ZXIuCiAgICAgICAgdG9rZW5CYWxhbmNlW3NlbmRlcl0gPSBhZGQodG9rZW5CYWxhbmNlW3NlbmRlcl0sIG51bVRva2Vucyk7CgogICAgICAgIC8vIFVwZGF0ZSB0aGUgcGF5b3V0IGFycmF5IHNvIHRoYXQgdGhlIGJ1eWVyIGNhbm5vdCBjbGFpbSBkaXZpZGVuZHMgb24gcHJldmlvdXMgcHVyY2hhc2VzLgogICAgICAgIC8vIEFsc28gaW5jbHVkZSB0aGUgZmVlIHBhaWQgZm9yIGVudGVyaW5nIHRoZSBzY2hlbWUuCiAgICAgICAgLy8gRmlyc3Qgd2UgY29tcHV0ZSBob3cgbXVjaCB3YXMganVzdCBwYWlkIG91dCB0byB0aGUgYnV5ZXIuLi4KICAgICAgICB2YXIgcGF5b3V0RGlmZiA9IChpbnQyNTYpICgoZWFybmluZ3NQZXJUb2tlbiAqIG51bVRva2VucykgLSBidXllckZlZSk7CiAgICAgICAgCiAgICAgICAgLy8gVGhlbiB3ZSB1cGRhdGUgdGhlIHBheW91dHMgYXJyYXkgZm9yIHRoZSBidXllciB3aXRoIHRoaXMgYW1vdW50Li4uCiAgICAgICAgcGF5b3V0c1tzZW5kZXJdICs9IHBheW91dERpZmY7CiAgICAgICAgCiAgICAgICAgLy8gQW5kIHRoZW4gd2UgZmluYWxseSBhZGQgaXQgdG8gdGhlIHZhcmlhYmxlIHRyYWNraW5nIHRoZSB0b3RhbCBhbW91bnQgc3BlbnQgdG8gbWFpbnRhaW4gaW52YXJpYW5jZS4KICAgICAgICB0b3RhbFBheW91dHMgICAgKz0gcGF5b3V0RGlmZjsKICAgICAgICAKICAgIH0KCiAgICAvLyBTZWxsIGZ1bmN0aW9uIHRoYXQgdGFrZXMgdG9rZW5zIGFuZCBjb252ZXJ0cyB0aGVtIGludG8gRXRoZXIuIEFsc28gY29tZXMgd2l0aCBhIDEwJSBmZWUKICAgIC8vIHRvIGRpc2NvdXJhZ2luZyBkdW1waW5nLCBhbmQgbWVhbnMgdGhhdCBpZiBzb21lb25lIG5lYXIgdGhlIHRvcCBzZWxscywgdGhlIGZlZSBkaXN0cmlidXRlZAogICAgLy8gd2lsbCBiZSAqc2lnbmlmaWNhbnQqLgogICAgZnVuY3Rpb24gc2VsbCh1aW50MjU2IGFtb3VudCkgaW50ZXJuYWwgewogICAgICAgIC8vIENhbGN1bGF0ZSB0aGUgYW1vdW50IG9mIEV0aGVyIHRoYXQgdGhlIGhvbGRlcnMgdG9rZW5zIHNlbGwgZm9yIGF0IHRoZSBjdXJyZW50IHNlbGwgcHJpY2UuCiAgICAgICAgdmFyIG51bUV0aGVyc0JlZm9yZUZlZSA9IGdldEV0aGVyRm9yVG9rZW5zKGFtb3VudCk7CiAgICAgICAgCiAgICAgICAgLy8gMTAlIG9mIHRoZSByZXN1bHRpbmcgRXRoZXIgaXMgdXNlZCB0byBwYXkgcmVtYWluaW5nIGhvbGRlcnMuCiAgICAgICAgdmFyIGZlZSA9IGRpdihudW1FdGhlcnNCZWZvcmVGZWUsIDEwKTsKICAgICAgICAKICAgICAgICAvLyBOZXQgRXRoZXIgZm9yIHRoZSBzZWxsZXIgYWZ0ZXIgdGhlIGZlZSBoYXMgYmVlbiBzdWJ0cmFjdGVkLgogICAgICAgIHZhciBudW1FdGhlcnMgPSBudW1FdGhlcnNCZWZvcmVGZWUgLSBmZWU7CiAgICAgICAgCiAgICAgICAgLy8gKlJlbW92ZSogdGhlIG51bVRva2VucyB3aGljaCB3ZXJlIGp1c3Qgc29sZCBmcm9tIHRoZSB0b3RhbCBzdXBwbHkuIFdlJ3JlIC9kZWZpbml0ZWx5LyBhIGNyeXB0byBjZW50cmFsIGJhbmsuCiAgICAgICAgdG90YWxTdXBwbHkgPSBzdWIodG90YWxTdXBwbHksIGFtb3VudCk7CiAgICAgICAgCiAgICAgICAgLy8gUmVtb3ZlIHRoZSB0b2tlbnMgZnJvbSB0aGUgYmFsYW5jZSBvZiB0aGUgYnV5ZXIuCiAgICAgICAgdG9rZW5CYWxhbmNlW21zZy5zZW5kZXJdID0gc3ViKHRva2VuQmFsYW5jZVttc2cuc2VuZGVyXSwgYW1vdW50KTsKCiAgICAgICAgLy8gVXBkYXRlIHRoZSBwYXlvdXQgYXJyYXkgc28gdGhhdCB0aGUgc2VsbGVyIGNhbm5vdCBjbGFpbSBmdXR1cmUgZGl2aWRlbmRzIHVubGVzcyB0aGV5IGJ1eSBiYWNrIGluLgogICAgICAgIC8vIEZpcnN0IHdlIGNvbXB1dGUgaG93IG11Y2ggd2FzIGp1c3QgcGFpZCBvdXQgdG8gdGhlIHNlbGxlci4uLgogICAgICAgIHZhciBwYXlvdXREaWZmID0gKGludDI1NikgKGVhcm5pbmdzUGVyVG9rZW4gKiBhbW91bnQgKyAobnVtRXRoZXJzICogc2NhbGVGYWN0b3IpKTsKICAgICAgICAKICAgICAgICAvLyBXZSByZWR1Y2UgdGhlIGFtb3VudCBwYWlkIG91dCB0byB0aGUgc2VsbGVyICh0aGlzIGVmZmVjdGl2ZWx5IHJlc2V0cyB0aGVpciBwYXlvdXRzIHZhbHVlIHRvIHplcm8sCiAgICAgICAgLy8gc2luY2UgdGhleSdyZSBzZWxsaW5nIGFsbCBvZiB0aGVpciB0b2tlbnMpLiBUaGlzIG1ha2VzIHN1cmUgdGhlIHNlbGxlciBpc24ndCBkaXNhZHZhbnRhZ2VkIGlmCiAgICAgICAgLy8gdGhleSBkZWNpZGUgdG8gYnV5IGJhY2sgaW4uCiAgICAgICAgcGF5b3V0c1ttc2cuc2VuZGVyXSAtPSBwYXlvdXREaWZmOyAgICAgIAogICAgICAgIAogICAgICAgIC8vIERlY3JlYXNlIHRoZSB0b3RhbCBhbW91bnQgdGhhdCdzIGJlZW4gcGFpZCBvdXQgdG8gbWFpbnRhaW4gaW52YXJpYW5jZS4KICAgICAgICB0b3RhbFBheW91dHMgLT0gcGF5b3V0RGlmZjsKICAgICAgICAKICAgICAgICAvLyBDaGVjayB0aGF0IHdlIGhhdmUgdG9rZW5zIGluIGV4aXN0ZW5jZSAodGhpcyBpcyBhIGJpdCBvZiBhbiBpcnJlbGV2YW50IGNoZWNrIHNpbmNlIHdlJ3JlCiAgICAgICAgLy8gc2VsbGluZyB0b2tlbnMsIGJ1dCBpdCBndWFyZHMgYWdhaW5zdCBkaXZpc2lvbiBieSB6ZXJvKS4KICAgICAgICBpZiAodG90YWxTdXBwbHkgPiAwKSB7CiAgICAgICAgICAgIC8vIFNjYWxlIHRoZSBFdGhlciB0YWtlbiBhcyB0aGUgc2VsbGluZyBmZWUgYnkgdGhlIHNjYWxlRmFjdG9yIHZhcmlhYmxlLgogICAgICAgICAgICB2YXIgZXRoZXJGZWUgPSBmZWUgKiBzY2FsZUZhY3RvcjsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIEZlZSBpcyBkaXN0cmlidXRlZCB0byBhbGwgcmVtYWluaW5nIHRva2VuIGhvbGRlcnMuCiAgICAgICAgICAgIC8vIHJld2FyZFBlclNoYXJlIGlzIHRoZSBhbW91bnQgZ2FpbmVkIHBlciB0b2tlbiB0aGFua3MgdG8gdGhpcyBzZWxsLgogICAgICAgICAgICB2YXIgcmV3YXJkUGVyU2hhcmUgPSBldGhlckZlZSAvIHRvdGFsU3VwcGx5OwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gVGhlIEV0aGVyIHZhbHVlIHBlciB0b2tlbiBpcyBpbmNyZWFzZWQgcHJvcG9ydGlvbmFsbHkuCiAgICAgICAgICAgIGVhcm5pbmdzUGVyVG9rZW4gPSBhZGQoZWFybmluZ3NQZXJUb2tlbiwgcmV3YXJkUGVyU2hhcmUpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLy8gRHluYW1pYyB2YWx1ZSBvZiBFdGhlciBpbiByZXNlcnZlLCBhY2NvcmRpbmcgdG8gdGhlIENSUiByZXF1aXJlbWVudC4KICAgIGZ1bmN0aW9uIHJlc2VydmUoKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGFtb3VudCkgewogICAgICAgIHJldHVybiBzdWIoYmFsYW5jZSgpLAogICAgICAgICAgICAgKCh1aW50MjU2KSAoKGludDI1NikgKGVhcm5pbmdzUGVyVG9rZW4gKiB0b3RhbFN1cHBseSkgLSB0b3RhbFBheW91dHMpIC8gc2NhbGVGYWN0b3IpKTsKICAgIH0KCiAgICAvLyBDYWxjdWxhdGVzIHRoZSBudW1iZXIgb2YgdG9rZW5zIHRoYXQgY2FuIGJlIGJvdWdodCBmb3IgYSBnaXZlbiBhbW91bnQgb2YgRXRoZXIsIGFjY29yZGluZyB0byB0aGUKICAgIC8vIGR5bmFtaWMgcmVzZXJ2ZSBhbmQgdG90YWxTdXBwbHkgdmFsdWVzIChkZXJpdmVkIGZyb20gdGhlIGJ1eSBhbmQgc2VsbCBwcmljZXMpLgogICAgZnVuY3Rpb24gZ2V0VG9rZW5zRm9yRXRoZXIodWludDI1NiBldGhlcnZhbHVlKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiB0b2tlbnMpIHsKICAgICAgICByZXR1cm4gc3ViKGZpeGVkRXhwKGZpeGVkTG9nKHJlc2VydmUoKSArIGV0aGVydmFsdWUpKmNycl9uL2Nycl9kICsgcHJpY2VfY29lZmYpLCB0b3RhbFN1cHBseSk7CiAgICB9CgogICAgLy8gU2VtYW50aWNhbGx5IHNpbWlsYXIgdG8gZ2V0VG9rZW5zRm9yRXRoZXIsIGJ1dCBzdWJ0cmFjdHMgdGhlIGNhbGxlcnMgYmFsYW5jZSBmcm9tIHRoZSBhbW91bnQgb2YgRXRoZXIgcmV0dXJuZWQgZm9yIGNvbnZlcnNpb24uCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVEaXZpZGVuZFRva2Vucyh1aW50MjU2IGV0aGVydmFsdWUsIHVpbnQyNTYgc3VidmFsdWUpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHRva2VucykgewogICAgICAgIHJldHVybiBzdWIoZml4ZWRFeHAoZml4ZWRMb2cocmVzZXJ2ZSgpIC0gc3VidmFsdWUgKyBldGhlcnZhbHVlKSpjcnJfbi9jcnJfZCArIHByaWNlX2NvZWZmKSwgdG90YWxTdXBwbHkpOwogICAgfQoKICAgIC8vIENvbnZlcnRzIGEgbnVtYmVyIHRva2VucyBpbnRvIGFuIEV0aGVyIHZhbHVlLgogICAgZnVuY3Rpb24gZ2V0RXRoZXJGb3JUb2tlbnModWludDI1NiB0b2tlbnMpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGV0aGVydmFsdWUpIHsKICAgICAgICAvLyBIb3cgbXVjaCByZXNlcnZlIEV0aGVyIGRvIHdlIGhhdmUgbGVmdCBpbiB0aGUgY29udHJhY3Q/CiAgICAgICAgdmFyIHJlc2VydmVBbW91bnQgPSByZXNlcnZlKCk7CgogICAgICAgIC8vIElmIHlvdSdyZSB0aGUgSGlnaGxhbmRlciAob3IgYmFnaG9sZGVyKSwgeW91IGdldCBUaGUgUHJpemUuIEV2ZXJ5dGhpbmcgbGVmdCBpbiB0aGUgdmF1bHQuCiAgICAgICAgaWYgKHRva2VucyA9PSB0b3RhbFN1cHBseSkKICAgICAgICAgICAgcmV0dXJuIHJlc2VydmVBbW91bnQ7CgogICAgICAgIC8vIElmIHRoZXJlIHdvdWxkIGJlIGV4Y2VzcyBFdGhlciBsZWZ0IGFmdGVyIHRoZSB0cmFuc2FjdGlvbiB0aGlzIGlzIGNhbGxlZCB3aXRoaW4sIHJldHVybiB0aGUgRXRoZXIKICAgICAgICAvLyBjb3JyZXNwb25kaW5nIHRvIHRoZSBlcXVhdGlvbiBpbiBEciBKb2NoZW4gSG9lbmlja2UncyBvcmlnaW5hbCBQb256aSBwYXBlciwgd2hpY2ggY2FuIGJlIGZvdW5kCiAgICAgICAgLy8gYXQgaHR0cHM6Ly90ZXN0LmpvY2hlbi1ob2VuaWNrZS5kZS9ldGgvcG9ueml0b2tlbi8gaW4gdGhlIHRoaXJkIGVxdWF0aW9uLCB3aXRoIHRoZSBDUlIgbnVtZXJhdG9yIAogICAgICAgIC8vIGFuZCBkZW5vbWluYXRvciBhbHRlcmVkIHRvIDEgYW5kIDIgcmVzcGVjdGl2ZWx5LgogICAgICAgIHJldHVybiBzdWIocmVzZXJ2ZUFtb3VudCwgZml4ZWRFeHAoKGZpeGVkTG9nKHRvdGFsU3VwcGx5IC0gdG9rZW5zKSAtIHByaWNlX2NvZWZmKSAqIGNycl9kL2Nycl9uKSk7CiAgICB9CgogICAgLy8gWW91IGRvbid0IGNhcmUgYWJvdXQgdGhlc2UsIGJ1dCBpZiB5b3UgcmVhbGx5IGRvIHRoZXkncmUgaGV4IHZhbHVlcyBmb3IgCiAgICAvLyBjby1lZmZpY2llbnRzIHVzZWQgdG8gc2ltdWxhdGUgYXBwcm94aW1hdGlvbnMgb2YgdGhlIGxvZyBhbmQgZXhwIGZ1bmN0aW9ucy4KICAgIGludDI1NiAgY29uc3RhbnQgb25lICAgICAgICA9IDB4MTAwMDAwMDAwMDAwMDAwMDA7CiAgICB1aW50MjU2IGNvbnN0YW50IHNxcnQyICAgICAgPSAweDE2YTA5ZTY2N2YzYmNjOTA4OwogICAgdWludDI1NiBjb25zdGFudCBzcXJ0ZG90NSAgID0gMHgwYjUwNGYzMzNmOWRlNjQ4NDsKICAgIGludDI1NiAgY29uc3RhbnQgbG4yICAgICAgICA9IDB4MGIxNzIxN2Y3ZDFjZjc5YWM7CiAgICBpbnQyNTYgIGNvbnN0YW50IGxuMl82NGRvdDUgPSAweDJjYjUzZjA5ZjA1Y2M2MjdjODsKICAgIGludDI1NiAgY29uc3RhbnQgYzEgICAgICAgICA9IDB4MWZmZmZmZmZmZmY5ZGFjOWI7CiAgICBpbnQyNTYgIGNvbnN0YW50IGMzICAgICAgICAgPSAweDBhYWFhYWFhYzE2ODc3OTA4OwogICAgaW50MjU2ICBjb25zdGFudCBjNSAgICAgICAgID0gMHgwNjY2NjY0ZTVlOWZhMGM5OTsKICAgIGludDI1NiAgY29uc3RhbnQgYzcgICAgICAgICA9IDB4MDQ5MjU0MDI2YTc2MzBhY2Y7CiAgICBpbnQyNTYgIGNvbnN0YW50IGM5ICAgICAgICAgPSAweDAzOGJkNzVlZDM3NzUzZDY4OwogICAgaW50MjU2ICBjb25zdGFudCBjMTEgICAgICAgID0gMHgwMzI4NGEwYzE0NjEwOTI0ZjsKCiAgICAvLyBUaGUgcG9seW5vbWlhbCBSID0gYzEqeCArIGMzKnheMyArIC4uLiArIGMxMSAqIHheMTEKICAgIC8vIGFwcHJveGltYXRlcyB0aGUgZnVuY3Rpb24gbG9nKDEreCktbG9nKDEteCkKICAgIC8vIEhlbmNlIFIocykgPSBsb2coKDErcykvKDEtcykpID0gbG9nKGEpCiAgICBmdW5jdGlvbiBmaXhlZExvZyh1aW50MjU2IGEpIGludGVybmFsIHB1cmUgcmV0dXJucyAoaW50MjU2IGxvZykgewogICAgICAgIGludDMyIHNjYWxlID0gMDsKICAgICAgICB3aGlsZSAoYSA+IHNxcnQyKSB7CiAgICAgICAgICAgIGEgLz0gMjsKICAgICAgICAgICAgc2NhbGUrKzsKICAgICAgICB9CiAgICAgICAgd2hpbGUgKGEgPD0gc3FydGRvdDUpIHsKICAgICAgICAgICAgYSAqPSAyOwogICAgICAgICAgICBzY2FsZS0tOwogICAgICAgIH0KICAgICAgICBpbnQyNTYgcyA9ICgoKGludDI1NikoYSkgLSBvbmUpICogb25lKSAvICgoaW50MjU2KShhKSArIG9uZSk7CiAgICAgICAgdmFyIHogPSAocypzKSAvIG9uZTsKICAgICAgICByZXR1cm4gc2NhbGUgKiBsbjIgKwogICAgICAgICAgICAocyooYzEgKyAoeiooYzMgKyAoeiooYzUgKyAoeiooYzcgKyAoeiooYzkgKyAoeipjMTEvb25lKSkKICAgICAgICAgICAgICAgIC9vbmUpKS9vbmUpKS9vbmUpKS9vbmUpKS9vbmUpOwogICAgfQoKICAgIGludDI1NiBjb25zdGFudCBjMiA9ICAweDAyYWFhYWFhYWFhMDE1ZGIwOwogICAgaW50MjU2IGNvbnN0YW50IGM0ID0gLTB4MDAwYjYwYjYwODA4Mzk5ZDE7CiAgICBpbnQyNTYgY29uc3RhbnQgYzYgPSAgMHgwMDAwNDU1OTU2YmNjZGQwNjsKICAgIGludDI1NiBjb25zdGFudCBjOCA9IC0weDAwMDAwMWI4OTNhZDA0YjNhOwogICAgCiAgICAvLyBUaGUgcG9seW5vbWlhbCBSID0gMiArIGMyKnheMiArIGM0KnheNCArIC4uLgogICAgLy8gYXBwcm94aW1hdGVzIHRoZSBmdW5jdGlvbiB4KihleHAoeCkrMSkvKGV4cCh4KS0xKQogICAgLy8gSGVuY2UgZXhwKHgpID0gKFIoeCkreCkvKFIoeCkteCkKICAgIGZ1bmN0aW9uIGZpeGVkRXhwKGludDI1NiBhKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYgZXhwKSB7CiAgICAgICAgaW50MjU2IHNjYWxlID0gKGEgKyAobG4yXzY0ZG90NSkpIC8gbG4yIC0gNjQ7CiAgICAgICAgYSAtPSBzY2FsZSpsbjI7CiAgICAgICAgaW50MjU2IHogPSAoYSphKSAvIG9uZTsKICAgICAgICBpbnQyNTYgUiA9ICgoaW50MjU2KSgyKSAqIG9uZSkgKwogICAgICAgICAgICAoeiooYzIgKyAoeiooYzQgKyAoeiooYzYgKyAoeipjOC9vbmUpKS9vbmUpKS9vbmUpKS9vbmUpOwogICAgICAgIGV4cCA9ICh1aW50MjU2KSAoKChSICsgYSkgKiBvbmUpIC8gKFIgLSBhKSk7CiAgICAgICAgaWYgKHNjYWxlID49IDApCiAgICAgICAgICAgIGV4cCA8PD0gc2NhbGU7CiAgICAgICAgZWxzZQogICAgICAgICAgICBleHAgPj49IC1zY2FsZTsKICAgICAgICByZXR1cm4gZXhwOwogICAgfQogICAgCiAgICAvLyBUaGUgYmVsb3cgYXJlIHNhZmVtYXRoIGltcGxlbWVudGF0aW9ucyBvZiB0aGUgZm91ciBhcml0aG1ldGljIG9wZXJhdG9ycwogICAgLy8gZGVzaWduZWQgdG8gZXhwbGljaXRseSBwcmV2ZW50IG92ZXItIGFuZCB1bmRlci1mbG93cyBvZiBpbnRlZ2VyIHZhbHVlcy4KCiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGlmIChhID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoYiA8PSBhKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgICAgICBhc3NlcnQoYyA+PSBhKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICAvLyBUaGlzIGFsbG93cyB5b3UgdG8gYnV5IHRva2VucyBieSBzZW5kaW5nIEV0aGVyIGRpcmVjdGx5IHRvIHRoZSBzbWFydCBjb250cmFjdAogICAgLy8gd2l0aG91dCBpbmNsdWRpbmcgYW55IHRyYW5zYWN0aW9uIGRhdGEgKHVzZWZ1bCBmb3IsIHNheSwgbW9iaWxlIHdhbGxldCBhcHBzKS4KICAgIGZ1bmN0aW9uICgpIHBheWFibGUgcHVibGljIHsKICAgICAgICAvLyBtc2cudmFsdWUgaXMgdGhlIGFtb3VudCBvZiBFdGhlciBzZW50IGJ5IHRoZSB0cmFuc2FjdGlvbi4KICAgICAgICBpZiAobXNnLnZhbHVlID4gMCkgewogICAgICAgICAgICBmdW5kKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgd2l0aGRyYXdPbGQobXNnLnNlbmRlcik7CiAgICAgICAgfQogICAgfQp9'.
	

]
