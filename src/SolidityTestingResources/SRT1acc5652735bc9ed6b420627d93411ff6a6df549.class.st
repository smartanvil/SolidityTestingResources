Class {
	#name : #SRT1acc5652735bc9ed6b420627d93411ff6a6df549,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT1acc5652735bc9ed6b420627d93411ff6a6df549 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTc7CgovKioKICogQHRpdGxlIEVSQzIwCiAqIEBkZXYgRVJDMjAgaW50ZXJmYWNlCiAqLwpjb250cmFjdCBFUkMyMCB7CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9CgovLy8gQGRldiBDcm93ZHNhbGUgaW50ZXJmYWNlIGZvciBFdGhlYWwgTm9ybWFsIFNhbGUsIGZ1bmN0aW9ucyBuZWVkZWQgZnJvbSBvdXRzaWRlLgpjb250cmFjdCBpRXRoZWFsU2FsZSB7CiAgICBib29sIHB1YmxpYyBwYXVzZWQ7CiAgICB1aW50MjU2IHB1YmxpYyBtaW5Db250cmlidXRpb247CiAgICB1aW50MjU2IHB1YmxpYyB3aGl0ZWxpc3RUaHJlc2hvbGQ7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBzdGFrZXM7CiAgICBmdW5jdGlvbiBzZXRQcm9tb0JvbnVzKGFkZHJlc3MgX2ludmVzdG9yLCB1aW50MjU2IF92YWx1ZSkgcHVibGljOwogICAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgX2JlbmVmaWNpYXJ5KSBwdWJsaWMgcGF5YWJsZTsKICAgIGZ1bmN0aW9uIGRlcG9zaXRFdGgoYWRkcmVzcyBfYmVuZWZpY2lhcnksIHVpbnQyNTYgX3RpbWUsIGJ5dGVzIF93aGl0ZWxpc3RTaWduKSBwdWJsaWMgcGF5YWJsZTsKICAgIGZ1bmN0aW9uIGRlcG9zaXRPZmZjaGFpbihhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludDI1NiBfYW1vdW50LCB1aW50MjU2IF90aW1lKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBoYXNFbmRlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKTsKfQoKCgoKCgovKioKICogQHRpdGxlIGNsYWltIGFjY2lkZW50YWxseSBzZW50IHRva2VucwogKi8KY29udHJhY3QgSGFzTm9Ub2tlbnMgaXMgT3duYWJsZSB7CiAgICBldmVudCBFeHRyYWN0ZWRUb2tlbnMoYWRkcmVzcyBpbmRleGVkIF90b2tlbiwgYWRkcmVzcyBpbmRleGVkIF9jbGFpbWVyLCB1aW50IF9hbW91bnQpOwoKICAgIC8vLyBAbm90aWNlIFRoaXMgbWV0aG9kIGNhbiBiZSB1c2VkIHRvIGV4dHJhY3QgbWlzdGFrZW5seQogICAgLy8vICBzZW50IHRva2VucyB0byB0aGlzIGNvbnRyYWN0LgogICAgLy8vIEBwYXJhbSBfdG9rZW4gVGhlIGFkZHJlc3Mgb2YgdGhlIHRva2VuIGNvbnRyYWN0IHRoYXQgeW91IHdhbnQgdG8gcmVjb3ZlcgogICAgLy8vICBzZXQgdG8gMCBpbiBjYXNlIHlvdSB3YW50IHRvIGV4dHJhY3QgZXRoZXIuCiAgICAvLy8gQHBhcmFtIF9jbGFpbWVyIEFkZHJlc3MgdGhhdCB0b2tlbnMgd2lsbCBiZSBzZW5kIHRvCiAgICBmdW5jdGlvbiBleHRyYWN0VG9rZW5zKGFkZHJlc3MgX3Rva2VuLCBhZGRyZXNzIF9jbGFpbWVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICBpZiAoX3Rva2VuID09IDB4MCkgewogICAgICAgICAgICBfY2xhaW1lci50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBFUkMyMCB0b2tlbiA9IEVSQzIwKF90b2tlbik7CiAgICAgICAgdWludCBiYWxhbmNlID0gdG9rZW4uYmFsYW5jZU9mKHRoaXMpOwogICAgICAgIHRva2VuLnRyYW5zZmVyKF9jbGFpbWVyLCBiYWxhbmNlKTsKICAgICAgICBFeHRyYWN0ZWRUb2tlbnMoX3Rva2VuLCBfY2xhaW1lciwgYmFsYW5jZSk7CiAgICB9Cn0KCgoKCgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgovKgogKiBFUkMtMjAgU3RhbmRhcmQgVG9rZW4gU21hcnQgQ29udHJhY3QgSW50ZXJmYWNlLgogKiBDb3B5cmlnaHQgJiMxNjk7IDIwMTbigJMyMDE3IGJ5IEFCREsgQ29uc3VsdGluZy4KICogQXV0aG9yOiBNaWtoYWlsIFZsYWRpbWlyb3YgPDxhIGhyZWY9Ii9jZG4tY2dpL2wvZW1haWwtcHJvdGVjdGlvbiIgY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSI2YjA2MDIwMDAzMGEwMjA3NDUxZDA3MGEwZjAyMDYwMjE5MDQxZDJiMGMwNjBhMDIwNzQ1MDgwNDA2Ij5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9hPj4KICovCgovKioKICogRVJDLTIwIHN0YW5kYXJkIHRva2VuIGludGVyZmFjZSwgYXMgZGVmaW5lZAogKiA8YSBocmVmPSJodHRwOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCI+aGVyZTwvYT4uCiAqLwpjb250cmFjdCBUb2tlbiB7CiAgICAvKioKICAgICAqIEdldCB0b3RhbCBudW1iZXIgb2YgdG9rZW5zIGluIGNpcmN1bGF0aW9uLgogICAgICoKICAgICAqIEByZXR1cm4gdG90YWwgbnVtYmVyIG9mIHRva2VucyBpbiBjaXJjdWxhdGlvbgogICAgICovCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSAoKSB2aWV3IHJldHVybnMgKHVpbnQyNTYgc3VwcGx5KTsKCiAgICAvKioKICAgICAqIEdldCBudW1iZXIgb2YgdG9rZW5zIGN1cnJlbnRseSBiZWxvbmdpbmcgdG8gZ2l2ZW4gb3duZXIuCiAgICAgKgogICAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIHRvIGdldCBudW1iZXIgb2YgdG9rZW5zIGN1cnJlbnRseSBiZWxvbmdpbmcgdG8gdGhlCiAgICAgKiAgICAgICAgb3duZXIgb2YKICAgICAqIEByZXR1cm4gbnVtYmVyIG9mIHRva2VucyBjdXJyZW50bHkgYmVsb25naW5nIHRvIHRoZSBvd25lciBvZiBnaXZlbiBhZGRyZXNzCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZiAoYWRkcmVzcyBfb3duZXIpIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKCiAgICAvKioKICAgICAqIFRyYW5zZmVyIGdpdmVuIG51bWJlciBvZiB0b2tlbnMgZnJvbSBtZXNzYWdlIHNlbmRlciB0byBnaXZlbiByZWNpcGllbnQuCiAgICAgKgogICAgICogQHBhcmFtIF90byBhZGRyZXNzIHRvIHRyYW5zZmVyIHRva2VucyB0byB0aGUgb3duZXIgb2YKICAgICAqIEBwYXJhbSBfdmFsdWUgbnVtYmVyIG9mIHRva2VucyB0byB0cmFuc2ZlciB0byB0aGUgb3duZXIgb2YgZ2l2ZW4gYWRkcmVzcwogICAgICogQHJldHVybiB0cnVlIGlmIHRva2VucyB3ZXJlIHRyYW5zZmVycmVkIHN1Y2Nlc3NmdWxseSwgZmFsc2Ugb3RoZXJ3aXNlCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyIChhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLyoqCiAgICAgKiBUcmFuc2ZlciBnaXZlbiBudW1iZXIgb2YgdG9rZW5zIGZyb20gZ2l2ZW4gb3duZXIgdG8gZ2l2ZW4gcmVjaXBpZW50LgogICAgICoKICAgICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRva2VucyBmcm9tIHRoZSBvd25lciBvZgogICAgICogQHBhcmFtIF90byBhZGRyZXNzIHRvIHRyYW5zZmVyIHRva2VucyB0byB0aGUgb3duZXIgb2YKICAgICAqIEBwYXJhbSBfdmFsdWUgbnVtYmVyIG9mIHRva2VucyB0byB0cmFuc2ZlciBmcm9tIGdpdmVuIG93bmVyIHRvIGdpdmVuCiAgICAgKiAgICAgICAgcmVjaXBpZW50CiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdG9rZW5zIHdlcmUgdHJhbnNmZXJyZWQgc3VjY2Vzc2Z1bGx5LCBmYWxzZSBvdGhlcndpc2UKICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tIChhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLyoqCiAgICAgKiBBbGxvdyBnaXZlbiBzcGVuZGVyIHRvIHRyYW5zZmVyIGdpdmVuIG51bWJlciBvZiB0b2tlbnMgZnJvbSBtZXNzYWdlIHNlbmRlci4KICAgICAqCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyB0byBhbGxvdyB0aGUgb3duZXIgb2YgdG8gdHJhbnNmZXIgdG9rZW5zIGZyb20KICAgICAqICAgICAgICBtZXNzYWdlIHNlbmRlcgogICAgICogQHBhcmFtIF92YWx1ZSBudW1iZXIgb2YgdG9rZW5zIHRvIGFsbG93IHRvIHRyYW5zZmVyCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdG9rZW4gdHJhbnNmZXIgd2FzIHN1Y2Nlc3NmdWxseSBhcHByb3ZlZCwgZmFsc2Ugb3RoZXJ3aXNlCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmUgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8qKgogICAgICogVGVsbCBob3cgbWFueSB0b2tlbnMgZ2l2ZW4gc3BlbmRlciBpcyBjdXJyZW50bHkgYWxsb3dlZCB0byB0cmFuc2ZlciBmcm9tCiAgICAgKiBnaXZlbiBvd25lci4KICAgICAqCiAgICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgdG8gZ2V0IG51bWJlciBvZiB0b2tlbnMgYWxsb3dlZCB0byBiZSB0cmFuc2ZlcnJlZAogICAgICogICAgICAgIGZyb20gdGhlIG93bmVyIG9mCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyB0byBnZXQgbnVtYmVyIG9mIHRva2VucyBhbGxvd2VkIHRvIGJlIHRyYW5zZmVycmVkCiAgICAgKiAgICAgICAgYnkgdGhlIG93bmVyIG9mCiAgICAgKiBAcmV0dXJuIG51bWJlciBvZiB0b2tlbnMgZ2l2ZW4gc3BlbmRlciBpcyBjdXJyZW50bHkgYWxsb3dlZCB0byB0cmFuc2ZlcgogICAgICogICAgICAgICBmcm9tIGdpdmVuIG93bmVyCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFsbG93YW5jZSAoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHZpZXcgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOwoKICAgIC8qKgogICAgICogTG9nZ2VkIHdoZW4gdG9rZW5zIHdlcmUgdHJhbnNmZXJyZWQgZnJvbSBvbmUgb3duZXIgdG8gYW5vdGhlci4KICAgICAqCiAgICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBvZiB0aGUgb3duZXIsIHRva2VucyB3ZXJlIHRyYW5zZmVycmVkIGZyb20KICAgICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBvZiB0aGUgb3duZXIsIHRva2VucyB3ZXJlIHRyYW5zZmVycmVkIHRvCiAgICAgKiBAcGFyYW0gX3ZhbHVlIG51bWJlciBvZiB0b2tlbnMgdHJhbnNmZXJyZWQKICAgICAqLwogICAgZXZlbnQgVHJhbnNmZXIgKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwoKICAgIC8qKgogICAgICogTG9nZ2VkIHdoZW4gb3duZXIgYXBwcm92ZWQgaGlzIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZCBieSBzb21lIHNwZW5kZXIuCiAgICAgKgogICAgICogQHBhcmFtIF9vd25lciBvd25lciB3aG8gYXBwcm92ZWQgaGlzIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAgICogQHBhcmFtIF9zcGVuZGVyIHNwZW5kZXIgd2hvIHdlcmUgYWxsb3dlZCB0byB0cmFuc2ZlciB0aGUgdG9rZW5zIGJlbG9uZ2luZwogICAgICogICAgICAgIHRvIHRoZSBvd25lcgogICAgICogQHBhcmFtIF92YWx1ZSBudW1iZXIgb2YgdG9rZW5zIGJlbG9uZ2luZyB0byB0aGUgb3duZXIsIGFwcHJvdmVkIHRvIGJlCiAgICAgKiAgICAgICAgdHJhbnNmZXJyZWQgYnkgdGhlIHNwZW5kZXIKICAgICAqLwogICAgZXZlbnQgQXBwcm92YWwgKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpOwp9CgovKgogKiBBYnN0cmFjdCBUb2tlbiBTbWFydCBDb250cmFjdC4gIENvcHlyaWdodCAmIzE2OTsgMjAxNyBieSBBQkRLIENvbnN1bHRpbmcuCiAqIEF1dGhvcjogTWlraGFpbCBWbGFkaW1pcm92IDw8YSBocmVmPSIvY2RuLWNnaS9sL2VtYWlsLXByb3RlY3Rpb24iIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iNjAwZDA5MGIwODAxMDkwYzRlMTYwYzAxMDQwOTBkMDkxMjBmMTYyMDA3MGQwMTA5MGM0ZTAzMGYwZCI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvYT4+CiAqIE1vZGlmaWVkIHRvIHVzZSBTYWZlTWF0aCBsaWJyYXJ5IGJ5IHRoZXN2ZWQKICovCi8qKgogKiBBYnN0cmFjdCBUb2tlbiBTbWFydCBDb250cmFjdCB0aGF0IGNvdWxkIGJlIHVzZWQgYXMgYSBiYXNlIGNvbnRyYWN0IGZvcgogKiBFUkMtMjAgdG9rZW4gY29udHJhY3RzLgogKi8KY29udHJhY3QgQWJzdHJhY3RUb2tlbiBpcyBUb2tlbiB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKCiAgICAvKioKICAgICAqIENyZWF0ZSBuZXcgQWJzdHJhY3QgVG9rZW4gY29udHJhY3QuCiAgICAgKi8KICAgIGZ1bmN0aW9uIEFic3RyYWN0VG9rZW4gKCkgewogICAgICAgIC8vIERvIG5vdGhpbmcKICAgIH0KCiAgICAvKioKICAgICAqIEdldCBudW1iZXIgb2YgdG9rZW5zIGN1cnJlbnRseSBiZWxvbmdpbmcgdG8gZ2l2ZW4gb3duZXIuCiAgICAgKgogICAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIHRvIGdldCBudW1iZXIgb2YgdG9rZW5zIGN1cnJlbnRseSBiZWxvbmdpbmcgdG8gdGhlIG93bmVyCiAgICAgKiBAcmV0dXJuIG51bWJlciBvZiB0b2tlbnMgY3VycmVudGx5IGJlbG9uZ2luZyB0byB0aGUgb3duZXIgb2YgZ2l2ZW4gYWRkcmVzcwogICAgICovCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YgKGFkZHJlc3MgX293bmVyKSB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgICAgIHJldHVybiBhY2NvdW50c1tfb3duZXJdOwogICAgfQoKICAgIC8qKgogICAgICogVHJhbnNmZXIgZ2l2ZW4gbnVtYmVyIG9mIHRva2VucyBmcm9tIG1lc3NhZ2Ugc2VuZGVyIHRvIGdpdmVuIHJlY2lwaWVudC4KICAgICAqCiAgICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG9rZW5zIHRvIHRoZSBvd25lciBvZgogICAgICogQHBhcmFtIF92YWx1ZSBudW1iZXIgb2YgdG9rZW5zIHRvIHRyYW5zZmVyIHRvIHRoZSBvd25lciBvZiBnaXZlbiBhZGRyZXNzCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdG9rZW5zIHdlcmUgdHJhbnNmZXJyZWQgc3VjY2Vzc2Z1bGx5LCBmYWxzZSBvdGhlcndpc2UKICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIgKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgdWludDI1NiBmcm9tQmFsYW5jZSA9IGFjY291bnRzW21zZy5zZW5kZXJdOwogICAgICAgIGlmIChmcm9tQmFsYW5jZSA8IF92YWx1ZSkgcmV0dXJuIGZhbHNlOwogICAgICAgIGlmIChfdmFsdWUgPiAwICYmIG1zZy5zZW5kZXIgIT0gX3RvKSB7CiAgICAgICAgICAgIGFjY291bnRzW21zZy5zZW5kZXJdID0gZnJvbUJhbGFuY2Uuc3ViKF92YWx1ZSk7CiAgICAgICAgICAgIGFjY291bnRzW190b10gPSBhY2NvdW50c1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogVHJhbnNmZXIgZ2l2ZW4gbnVtYmVyIG9mIHRva2VucyBmcm9tIGdpdmVuIG93bmVyIHRvIGdpdmVuIHJlY2lwaWVudC4KICAgICAqCiAgICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyB0byB0cmFuc2ZlciB0b2tlbnMgZnJvbSB0aGUgb3duZXIgb2YKICAgICAqIEBwYXJhbSBfdG8gYWRkcmVzcyB0byB0cmFuc2ZlciB0b2tlbnMgdG8gdGhlIG93bmVyIG9mCiAgICAgKiBAcGFyYW0gX3ZhbHVlIG51bWJlciBvZiB0b2tlbnMgdG8gdHJhbnNmZXIgZnJvbSBnaXZlbiBvd25lciB0byBnaXZlbiByZWNpcGllbnQKICAgICAqIEByZXR1cm4gdHJ1ZSBpZiB0b2tlbnMgd2VyZSB0cmFuc2ZlcnJlZCBzdWNjZXNzZnVsbHksIGZhbHNlIG90aGVyd2lzZQogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20gKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgdWludDI1NiBzcGVuZGVyQWxsb3dhbmNlID0gYWxsb3dhbmNlc1tfZnJvbV1bbXNnLnNlbmRlcl07CiAgICAgICAgaWYgKHNwZW5kZXJBbGxvd2FuY2UgPCBfdmFsdWUpIHJldHVybiBmYWxzZTsKICAgICAgICB1aW50MjU2IGZyb21CYWxhbmNlID0gYWNjb3VudHNbX2Zyb21dOwogICAgICAgIGlmIChmcm9tQmFsYW5jZSA8IF92YWx1ZSkgcmV0dXJuIGZhbHNlOwoKICAgICAgICBhbGxvd2FuY2VzW19mcm9tXVttc2cuc2VuZGVyXSA9IHNwZW5kZXJBbGxvd2FuY2Uuc3ViKF92YWx1ZSk7CgogICAgICAgIGlmIChfdmFsdWUgPiAwICYmIF9mcm9tICE9IF90bykgewogICAgICAgICAgICBhY2NvdW50c1tfZnJvbV0gPSBmcm9tQmFsYW5jZS5zdWIoX3ZhbHVlKTsKICAgICAgICAgICAgYWNjb3VudHNbX3RvXSA9IGFjY291bnRzW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQWxsb3cgZ2l2ZW4gc3BlbmRlciB0byB0cmFuc2ZlciBnaXZlbiBudW1iZXIgb2YgdG9rZW5zIGZyb20gbWVzc2FnZSBzZW5kZXIuCiAgICAgKgogICAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgdG8gYWxsb3cgdGhlIG93bmVyIG9mIHRvIHRyYW5zZmVyIHRva2VucyBmcm9tCiAgICAgKiAgICAgICAgbWVzc2FnZSBzZW5kZXIKICAgICAqIEBwYXJhbSBfdmFsdWUgbnVtYmVyIG9mIHRva2VucyB0byBhbGxvdyB0byB0cmFuc2ZlcgogICAgICogQHJldHVybiB0cnVlIGlmIHRva2VuIHRyYW5zZmVyIHdhcyBzdWNjZXNzZnVsbHkgYXBwcm92ZWQsIGZhbHNlIG90aGVyd2lzZQogICAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgYWxsb3dhbmNlc1ttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogVGVsbCBob3cgbWFueSB0b2tlbnMgZ2l2ZW4gc3BlbmRlciBpcyBjdXJyZW50bHkgYWxsb3dlZCB0byB0cmFuc2ZlciBmcm9tCiAgICAgKiBnaXZlbiBvd25lci4KICAgICAqCiAgICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgdG8gZ2V0IG51bWJlciBvZiB0b2tlbnMgYWxsb3dlZCB0byBiZSB0cmFuc2ZlcnJlZCBmcm9tIHRoZSBvd25lcgogICAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgdG8gZ2V0IG51bWJlciBvZiB0b2tlbnMgYWxsb3dlZCB0byBiZSB0cmFuc2ZlcnJlZCBieSB0aGUgb3duZXIKICAgICAqIEByZXR1cm4gbnVtYmVyIG9mIHRva2VucyBnaXZlbiBzcGVuZGVyIGlzIGN1cnJlbnRseSBhbGxvd2VkIHRvIHRyYW5zZmVyIGZyb20gZ2l2ZW4gb3duZXIKICAgICAqLwogICAgZnVuY3Rpb24gYWxsb3dhbmNlIChhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgdmlldyByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgICAgIHJldHVybiBhbGxvd2FuY2VzW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQoKICAgIC8qKgogICAgICogTWFwcGluZyBmcm9tIGFkZHJlc3NlcyBvZiB0b2tlbiBob2xkZXJzIHRvIHRoZSBudW1iZXJzIG9mIHRva2VucyBiZWxvbmdpbmcKICAgICAqIHRvIHRoZXNlIHRva2VuIGhvbGRlcnMuCiAgICAgKi8KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgYWNjb3VudHM7CgogICAgLyoqCiAgICAgKiBNYXBwaW5nIGZyb20gYWRkcmVzc2VzIG9mIHRva2VuIGhvbGRlcnMgdG8gdGhlIG1hcHBpbmcgb2YgYWRkcmVzc2VzIG9mCiAgICAgKiBzcGVuZGVycyB0byB0aGUgYWxsb3dhbmNlcyBzZXQgYnkgdGhlc2UgdG9rZW4gaG9sZGVycyB0byB0aGVzZSBzcGVuZGVycy4KICAgICAqLwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBwcml2YXRlIGFsbG93YW5jZXM7Cn0KCgovKgogKiBBYnN0cmFjdCBWaXJ0dWFsIFRva2VuIFNtYXJ0IENvbnRyYWN0LiAgQ29weXJpZ2h0ICYjMTY5OyAyMDE3IGJ5IEFCREsgQ29uc3VsdGluZy4KICogQXV0aG9yOiBNaWtoYWlsIFZsYWRpbWlyb3YgPDxhIGhyZWY9Ii9jZG4tY2dpL2wvZW1haWwtcHJvdGVjdGlvbiIgY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSIwODY1NjE2MzYwNjk2MTY0MjY3ZTY0Njk2YzYxNjU2MTdhNjc3ZTQ4NmY2NTY5NjE2NDI2NmI2NzY1Ij5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9hPj4KICogTW9kaWZpZWQgdG8gdXNlIFNhZmVNYXRoIGxpYnJhcnkgYnkgdGhlc3ZlZAogKi8KCi8qKgogKiBBYnN0cmFjdCBUb2tlbiBTbWFydCBDb250cmFjdCB0aGF0IGNvdWxkIGJlIHVzZWQgYXMgYSBiYXNlIGNvbnRyYWN0IGZvcgogKiBFUkMtMjAgdG9rZW4gY29udHJhY3RzIHN1cHBvcnRpbmcgdmlydHVhbCBiYWxhbmNlLgogKi8KY29udHJhY3QgQWJzdHJhY3RWaXJ0dWFsVG9rZW4gaXMgQWJzdHJhY3RUb2tlbiB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKCiAgICAvKioKICAgICAqIE1heGltdW0gbnVtYmVyIG9mIHJlYWwgKGkuZS4gbm9uLXZpcnR1YWwpIHRva2VucyBpbiBjaXJjdWxhdGlvbiAoMl4yNTUtMSkuCiAgICAgKi8KICAgIHVpbnQyNTYgY29uc3RhbnQgTUFYSU1VTV9UT0tFTlNfQ09VTlQgPSAweDdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkY7CgogICAgLyoqCiAgICAgKiBNYXNrIHVzZWQgdG8gZXh0cmFjdCByZWFsIGJhbGFuY2Ugb2YgYW4gYWNjb3VudCAoMl4yNTUtMSkuCiAgICAgKi8KICAgIHVpbnQyNTYgY29uc3RhbnQgQkFMQU5DRV9NQVNLID0gMHg3RkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGOwoKICAgIC8qKgogICAgICogTWFzayB1c2VkIHRvIGV4dHJhY3QgIm1hdGVyaWFsaXplZCIgZmxhZyBvZiBhbiBhY2NvdW50ICgyXjI1NSkuCiAgICAgKi8KICAgIHVpbnQyNTYgY29uc3RhbnQgTUFURVJJQUxJWkVEX0ZMQUdfTUFTSyA9IDB4ODAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDsKCiAgICAvKioKICAgICAqIENyZWF0ZSBuZXcgQWJzdHJhY3QgVmlydHVhbCBUb2tlbiBjb250cmFjdC4KICAgICAqLwogICAgZnVuY3Rpb24gQWJzdHJhY3RWaXJ0dWFsVG9rZW4gKCkgewogICAgICAgIC8vIERvIG5vdGhpbmcKICAgIH0KCiAgICAvKioKICAgICAqIEdldCB0b3RhbCBudW1iZXIgb2YgdG9rZW5zIGluIGNpcmN1bGF0aW9uLgogICAgICoKICAgICAqIEByZXR1cm4gdG90YWwgbnVtYmVyIG9mIHRva2VucyBpbiBjaXJjdWxhdGlvbgogICAgICovCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSAoKSB2aWV3IHJldHVybnMgKHVpbnQyNTYgc3VwcGx5KSB7CiAgICAgICAgcmV0dXJuIHRva2Vuc0NvdW50OwogICAgfQoKICAgIC8qKgogICAgICogR2V0IG51bWJlciBvZiB0b2tlbnMgY3VycmVudGx5IGJlbG9uZ2luZyB0byBnaXZlbiBvd25lci4KICAgICAqCiAgICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgdG8gZ2V0IG51bWJlciBvZiB0b2tlbnMgY3VycmVudGx5IGJlbG9uZ2luZyB0byB0aGUgb3duZXIKICAgICAqIEByZXR1cm4gbnVtYmVyIG9mIHRva2VucyBjdXJyZW50bHkgYmVsb25naW5nIHRvIHRoZSBvd25lciBvZiBnaXZlbiBhZGRyZXNzCiAgICAqLwogICAgZnVuY3Rpb24gYmFsYW5jZU9mIChhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7IAogICAgICAgIHJldHVybiAoYWNjb3VudHNbX293bmVyXSAmIEJBTEFOQ0VfTUFTSykuYWRkKGdldFZpcnR1YWxCYWxhbmNlKF9vd25lcikpOwogICAgfQoKICAgIC8qKgogICAgICogVHJhbnNmZXIgZ2l2ZW4gbnVtYmVyIG9mIHRva2VucyBmcm9tIG1lc3NhZ2Ugc2VuZGVyIHRvIGdpdmVuIHJlY2lwaWVudC4KICAgICAqCiAgICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG9rZW5zIHRvIHRoZSBvd25lciBvZgogICAgICogQHBhcmFtIF92YWx1ZSBudW1iZXIgb2YgdG9rZW5zIHRvIHRyYW5zZmVyIHRvIHRoZSBvd25lciBvZiBnaXZlbiBhZGRyZXNzCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdG9rZW5zIHdlcmUgdHJhbnNmZXJyZWQgc3VjY2Vzc2Z1bGx5LCBmYWxzZSBvdGhlcndpc2UKICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIgKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgaWYgKF92YWx1ZSA+IGJhbGFuY2VPZihtc2cuc2VuZGVyKSkgcmV0dXJuIGZhbHNlOwogICAgICAgIGVsc2UgewogICAgICAgICAgICBtYXRlcmlhbGl6ZUJhbGFuY2VJZk5lZWRlZChtc2cuc2VuZGVyLCBfdmFsdWUpOwogICAgICAgICAgICByZXR1cm4gQWJzdHJhY3RUb2tlbi50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVHJhbnNmZXIgZ2l2ZW4gbnVtYmVyIG9mIHRva2VucyBmcm9tIGdpdmVuIG93bmVyIHRvIGdpdmVuIHJlY2lwaWVudC4KICAgICAqCiAgICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyB0byB0cmFuc2ZlciB0b2tlbnMgZnJvbSB0aGUgb3duZXIgb2YKICAgICAqIEBwYXJhbSBfdG8gYWRkcmVzcyB0byB0cmFuc2ZlciB0b2tlbnMgdG8gdGhlIG93bmVyIG9mCiAgICAgKiBAcGFyYW0gX3ZhbHVlIG51bWJlciBvZiB0b2tlbnMgdG8gdHJhbnNmZXIgZnJvbSBnaXZlbiBvd25lciB0byBnaXZlbgogICAgICogICAgICAgIHJlY2lwaWVudAogICAgICogQHJldHVybiB0cnVlIGlmIHRva2VucyB3ZXJlIHRyYW5zZmVycmVkIHN1Y2Nlc3NmdWxseSwgZmFsc2Ugb3RoZXJ3aXNlCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbSAoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBpZiAoX3ZhbHVlID4gYWxsb3dhbmNlKF9mcm9tLCBtc2cuc2VuZGVyKSkgcmV0dXJuIGZhbHNlOwogICAgICAgIGlmIChfdmFsdWUgPiBiYWxhbmNlT2YoX2Zyb20pKSByZXR1cm4gZmFsc2U7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIG1hdGVyaWFsaXplQmFsYW5jZUlmTmVlZGVkKF9mcm9tLCBfdmFsdWUpOwogICAgICAgICAgICByZXR1cm4gQWJzdHJhY3RUb2tlbi50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgdmlydHVhbCBiYWxhbmNlIG9mIHRoZSBvd25lciBvZiBnaXZlbiBhZGRyZXNzLgogICAgICoKICAgICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyB0byBnZXQgdmlydHVhbCBiYWxhbmNlIGZvciB0aGUgb3duZXIgb2YKICAgICAqIEByZXR1cm4gdmlydHVhbCBiYWxhbmNlIG9mIHRoZSBvd25lciBvZiBnaXZlbiBhZGRyZXNzCiAgICAgKi8KICAgIGZ1bmN0aW9uIHZpcnR1YWxCYWxhbmNlT2YgKGFkZHJlc3MgX293bmVyKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYgX3ZpcnR1YWxCYWxhbmNlKTsKCiAgICAvKioKICAgICAqIENhbGN1bGF0ZSB2aXJ0dWFsIGJhbGFuY2Ugb2YgdGhlIG93bmVyIG9mIGdpdmVuIGFkZHJlc3MgdGFraW5nIGludG8gYWNjb3VudAogICAgICogbWF0ZXJpYWxpemVkIGZsYWcgYW5kIHRvdGFsIG51bWJlciBvZiByZWFsIHRva2VucyBhbHJlYWR5IGluIGNpcmN1bGF0aW9uLgogICAgICovCiAgICBmdW5jdGlvbiBnZXRWaXJ0dWFsQmFsYW5jZSAoYWRkcmVzcyBfb3duZXIpIHByaXZhdGUgdmlldyByZXR1cm5zICh1aW50MjU2IF92aXJ0dWFsQmFsYW5jZSkgewogICAgICAgIGlmIChhY2NvdW50cyBbX293bmVyXSAmIE1BVEVSSUFMSVpFRF9GTEFHX01BU0sgIT0gMCkgcmV0dXJuIDA7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIF92aXJ0dWFsQmFsYW5jZSA9IHZpcnR1YWxCYWxhbmNlT2YoX293bmVyKTsKICAgICAgICAgICAgdWludDI1NiBtYXhWaXJ0dWFsQmFsYW5jZSA9IE1BWElNVU1fVE9LRU5TX0NPVU5ULnN1Yih0b2tlbnNDb3VudCk7CiAgICAgICAgICAgIGlmIChfdmlydHVhbEJhbGFuY2UgPiBtYXhWaXJ0dWFsQmFsYW5jZSkKICAgICAgICAgICAgICAgIF92aXJ0dWFsQmFsYW5jZSA9IG1heFZpcnR1YWxCYWxhbmNlOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIE1hdGVyaWFsaXplIHZpcnR1YWwgYmFsYW5jZSBvZiB0aGUgb3duZXIgb2YgZ2l2ZW4gYWRkcmVzcyBpZiB0aGlzIHdpbGwgaGVscAogICAgICogdG8gdHJhbnNmZXIgZ2l2ZW4gbnVtYmVyIG9mIHRva2VucyBmcm9tIGl0LgogICAgICoKICAgICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyB0byBtYXRlcmlhbGl6ZSB2aXJ0dWFsIGJhbGFuY2Ugb2YKICAgICAqIEBwYXJhbSBfdmFsdWUgbnVtYmVyIG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAgICovCiAgICBmdW5jdGlvbiBtYXRlcmlhbGl6ZUJhbGFuY2VJZk5lZWRlZCAoYWRkcmVzcyBfb3duZXIsIHVpbnQyNTYgX3ZhbHVlKSBwcml2YXRlIHsKICAgICAgICB1aW50MjU2IHN0b3JlZEJhbGFuY2UgPSBhY2NvdW50c1tfb3duZXJdOwogICAgICAgIGlmIChzdG9yZWRCYWxhbmNlICYgTUFURVJJQUxJWkVEX0ZMQUdfTUFTSyA9PSAwKSB7CiAgICAgICAgICAgIC8vIFZpcnR1YWwgYmFsYW5jZSBpcyBub3QgbWF0ZXJpYWxpemVkIHlldAogICAgICAgICAgICBpZiAoX3ZhbHVlID4gc3RvcmVkQmFsYW5jZSkgewogICAgICAgICAgICAgICAgLy8gUmVhbCBiYWxhbmNlIGlzIG5vdCBlbm91Z2gKICAgICAgICAgICAgICAgIHVpbnQyNTYgdmlydHVhbEJhbGFuY2UgPSBnZXRWaXJ0dWFsQmFsYW5jZShfb3duZXIpOwogICAgICAgICAgICAgICAgcmVxdWlyZSAoX3ZhbHVlLnN1YihzdG9yZWRCYWxhbmNlKSA8PSB2aXJ0dWFsQmFsYW5jZSk7CiAgICAgICAgICAgICAgICBhY2NvdW50c1tfb3duZXJdID0gTUFURVJJQUxJWkVEX0ZMQUdfTUFTSyB8IHN0b3JlZEJhbGFuY2UuYWRkKHZpcnR1YWxCYWxhbmNlKTsKICAgICAgICAgICAgICAgIHRva2Vuc0NvdW50ID0gdG9rZW5zQ291bnQuYWRkKHZpcnR1YWxCYWxhbmNlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICogTnVtYmVyIG9mIHJlYWwgKGkuZS4gbm9uLXZpcnR1YWwpIHRva2VucyBpbiBjaXJjdWxhdGlvbi4KICAgICovCiAgICB1aW50MjU2IHRva2Vuc0NvdW50Owp9CgoKLyoqCiAqIEV0aGVhbCBQcm9tbyBFUkMtMjAgY29udHJhY3QKICogQXV0aG9yOiB0aGVzdmVkCiAqLwpjb250cmFjdCBFdGhlYWxQcm9tb1Rva2VuIGlzIEhhc05vVG9rZW5zLCBBYnN0cmFjdFZpcnR1YWxUb2tlbiB7CiAgICAvLyBCYWxhbmNlIHRocmVzaG9sZCB0byBhc3NpZ24gdmlydHVhbCB0b2tlbnMgdG8gdGhlIG93bmVyIG9mIGhpZ2hlciBiYWxhbmNlcyB0aGVuIHRoaXMgdGhyZXNob2xkLgogICAgdWludDI1NiBwcml2YXRlIGNvbnN0YW50IFZJUlRVQUxfVEhSRVNIT0xEID0gMC4xIGV0aGVyOwoKICAgIC8vIE51bWJlciBvZiB2aXJ0dWFsIHRva2VucyB0byBhc3NpZ24gdG8gdGhlIG93bmVycyBvZiBiYWxhbmNlcyBoaWdoZXIgdGhhbiB2aXJ0dWFsIHRocmVzaG9sZC4KICAgIHVpbnQyNTYgcHJpdmF0ZSBjb25zdGFudCBWSVJUVUFMX0NPVU5UID0gOTExOwoKICAgIC8vIGNyb3dkc2FsZSB0byBzZXQgYm9udXMgd2hlbiBzZW5kaW5nIHRva2VuCiAgICBpRXRoZWFsU2FsZSBwdWJsaWMgY3Jvd2RzYWxlOwoKCiAgICAvLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBCYXNpYyBmdW5jdGlvbnMKICAgIC8vLy8vLy8vLy8vLy8vLy8KCiAgICAvLy8gQGRldiBDb25zdHJ1Y3RvciwgY3Jvd2RzYWxlIGFkZHJlc3MgY2FuIGJlIDB4MAogICAgZnVuY3Rpb24gRXRoZWFsUHJvbW9Ub2tlbihhZGRyZXNzIF9jcm93ZHNhbGUpIHsKICAgICAgICBjcm93ZHNhbGUgPSBpRXRoZWFsU2FsZShfY3Jvd2RzYWxlKTsKICAgIH0KCiAgICAvLy8gQGRldiBTZXR0aW5nIGNyb3dkc2FsZSwgY3Jvd2RzYWxlIGFkZHJlc3MgY2FuIGJlIDB4MAogICAgZnVuY3Rpb24gc2V0Q3Jvd2RzYWxlKGFkZHJlc3MgX2Nyb3dkc2FsZSkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgY3Jvd2RzYWxlID0gaUV0aGVhbFNhbGUoX2Nyb3dkc2FsZSk7CiAgICB9CgogICAgLy8vIEBub3RpY2UgR2V0IHZpcnR1YWwgYmFsYW5jZSBvZiB0aGUgb3duZXIgb2YgZ2l2ZW4gYWRkcmVzcy4KICAgIC8vLyBAcGFyYW0gX293bmVyIGFkZHJlc3MgdG8gZ2V0IHZpcnR1YWwgYmFsYW5jZSBmb3IgdGhlIG93bmVyCiAgICAvLy8gQHJldHVybiB2aXJ0dWFsIGJhbGFuY2Ugb2YgdGhlIG93bmVyIG9mIGdpdmVuIGFkZHJlc3MKICAgIGZ1bmN0aW9uIHZpcnR1YWxCYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGludGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBfb3duZXIuYmFsYW5jZSA+PSBWSVJUVUFMX1RIUkVTSE9MRCA/IFZJUlRVQUxfQ09VTlQgOiAwOwogICAgfQoKICAgIC8vLyBAbm90aWNlIEdldCBuYW1lIG9mIHRoaXMgdG9rZW4uCiAgICBmdW5jdGlvbiBuYW1lKCkgcHVibGljIHB1cmUgcmV0dXJucyAoc3RyaW5nIHJlc3VsdCkgewogICAgICAgIHJldHVybiAiQW4gRXRoZWFsIFByb21vIjsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBHZXQgc3ltYm9sIG9mIHRoaXMgdG9rZW4uCiAgICBmdW5jdGlvbiBzeW1ib2woKSBwdWJsaWMgcHVyZSByZXR1cm5zIChzdHJpbmcgcmVzdWx0KSB7CiAgICAgICAgcmV0dXJuICJIRUFMUCI7CiAgICB9CgogICAgLy8vIEBub3RpY2UgR2V0IG51bWJlciBvZiBkZWNpbWFscyBmb3IgdGhpcyB0b2tlbi4KICAgIGZ1bmN0aW9uIGRlY2ltYWxzKCkgcHVibGljIHB1cmUgcmV0dXJucyAodWludDggcmVzdWx0KSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CgoKICAgIC8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIFNldCBzYWxlIGJvbnVzCiAgICAvLy8vLy8vLy8vLy8vLy8vCgogICAgLy8vIEBkZXYgSW50ZXJuYWwgZnVuY3Rpb24gZm9yIHNldHRpbmcgc2FsZSBib251cwogICAgZnVuY3Rpb24gc2V0U2FsZUJvbnVzKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgaW50ZXJuYWwgewogICAgICAgIGlmIChhZGRyZXNzKGNyb3dkc2FsZSkgPT0gYWRkcmVzcygwKSkgcmV0dXJuOwogICAgICAgIGlmIChfdmFsdWUgPT0gMCkgcmV0dXJuOwoKICAgICAgICBpZiAoX3RvID09IGFkZHJlc3MoMSkgfHwgX3RvID09IGFkZHJlc3ModGhpcykgfHwgX3RvID09IGFkZHJlc3MoY3Jvd2RzYWxlKSkgewogICAgICAgICAgICBjcm93ZHNhbGUuc2V0UHJvbW9Cb251cyhfZnJvbSwgX3ZhbHVlKTsKICAgICAgICB9CiAgICB9CgogICAgLy8vIEBkZXYgT3ZlcnJpZGUgdHJhbnNmZXIgZnVuY3Rpb24gdG8gc2V0IHNhbGUgYm9udXMKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBib29sIHN1Y2Nlc3MgPSBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7IAoKICAgICAgICBpZiAoc3VjY2VzcykgewogICAgICAgICAgICBzZXRTYWxlQm9udXMobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHN1Y2Nlc3M7CiAgICB9CgogICAgLy8vIEBkZXYgT3ZlcnJpZGUgdHJhbnNmZXIgZnVuY3Rpb24gdG8gc2V0IHNhbGUgYm9udXMKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgYm9vbCBzdWNjZXNzID0gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CgogICAgICAgIGlmIChzdWNjZXNzKSB7CiAgICAgICAgICAgIHNldFNhbGVCb251cyhfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHN1Y2Nlc3M7CiAgICB9CgoKICAgIC8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIEV4dHJhCiAgICAvLy8vLy8vLy8vLy8vLy8vCgogICAgLy8vIEBub3RpY2UgTm90aWZ5IG93bmVycyBhYm91dCB0aGVpciB2aXJ0dWFsIGJhbGFuY2VzLgogICAgZnVuY3Rpb24gbWFzc05vdGlmeShhZGRyZXNzW10gX293bmVycykgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgZm9yICh1aW50MjU2IGkgPSAwOyBpIDwgX293bmVycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBUcmFuc2ZlcihhZGRyZXNzKDApLCBfb3duZXJzW2ldLCBWSVJUVUFMX0NPVU5UKTsKICAgICAgICB9CiAgICB9CgogICAgLy8vIEBub3RpY2UgS2lsbCB0aGlzIHNtYXJ0IGNvbnRyYWN0LgogICAgZnVuY3Rpb24ga2lsbCgpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHNlbGZkZXN0cnVjdChvd25lcik7CiAgICB9CgogICAgCn0='.
	

]
