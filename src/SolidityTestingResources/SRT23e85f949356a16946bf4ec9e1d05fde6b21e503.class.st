Class {
	#name : #SRT23e85f949356a16946bf4ec9e1d05fde6b21e503,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT23e85f949356a16946bf4ec9e1d05fde6b21e503 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIEdpZnRvIFRva2VuIGJ5IEdpZnRvIExpbWl0ZWQuCi8vIEFuIEVSQzIwIHN0YW5kYXJkCi8vCi8vIGF1dGhvcjogR2lmdG8gVGVhbQovLyBDb250YWN0OiA8c3BhbiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImM5YWRhOGJkYmVhMWE3YWViY2IwYWNhNzg5YWVhNGE4YTBhNWU3YWFhNmE0Ij5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9zcGFuPgoKY29udHJhY3QgRVJDMjBJbnRlcmZhY2UgewogICAgLy8gR2V0IHRoZSB0b3RhbCB0b2tlbiBzdXBwbHkKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgX3RvdGFsU3VwcGx5KTsKIAogICAgLy8gR2V0IHRoZSBhY2NvdW50IGJhbGFuY2Ugb2YgYW5vdGhlciBhY2NvdW50IHdpdGggYWRkcmVzcyBfb3duZXIKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7CiAKICAgIC8vIFNlbmQgX3ZhbHVlIGFtb3VudCBvZiB0b2tlbnMgdG8gYWRkcmVzcyBfdG8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgCiAgICAvLyBUcmlnZ2VyZWQgd2hlbiB0b2tlbnMgYXJlIHRyYW5zZmVycmVkLgogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CiAKICAgIC8vIFRyaWdnZXJlZCB3aGVuZXZlciBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBpcyBjYWxsZWQuCiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKfQogCmNvbnRyYWN0IEdpZnRvIGlzIEVSQzIwSW50ZXJmYWNlIHsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gNTsKCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJHaWZ0byI7CiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiR2lmdG8iOwoKICAgIGJvb2wgcHVibGljIF9zZWxsaW5nID0gZmFsc2U7Ly9pbml0aWFsIG5vdCBzZWxsaW5nCiAgICB1aW50IHB1YmxpYyBfdG90YWxTdXBwbHkgPSAxMCAqKiAxNDsgLy8gdG90YWwgc3VwcGx5IGlzIDEwXjE0IHVuaXQsIGVxdWl2YWxlbnQgdG8gMTBeOSBHaWZ0bwogICAgdWludCBwdWJsaWMgX29yaWdpbmFsQnV5UHJpY2UgPSAxMCAqKiAxMDsgLy8gb3JpZ2luYWwgYnV5IGluIHdlaSBvZiBvbmUgdW5pdC4gQWp1c3RhYmxlLgoKICAgIC8vIE93bmVyIG9mIHRoaXMgY29udHJhY3QKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwogCiAgICAvLyBCYWxhbmNlcyBHaWZ0byBmb3IgZWFjaCBhY2NvdW50CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogICAgLy8gTGlzdCBvZiBhcHByb3ZlZCBpbnZlc3RvcnMKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBhcHByb3ZlZEludmVzdG9yTGlzdDsKICAgIAogICAgLy8gbWFwcGluZyBEZXBvc2l0CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgZGVwb3NpdDsKICAgIAogICAgLy8gYnV5ZXJzIGJ1eSB0b2tlbiBkZXBvc2l0CiAgICBhZGRyZXNzW10gYnV5ZXJzOwogICAgCiAgICAvLyBpY29QZXJjZW50CiAgICB1aW50IF9pY29QZXJjZW50ID0gMTA7CiAgICAKICAgIC8vIF9pY29TdXBwbHkgaXMgdGhlIGF2YWxhYmxlIHVuaXQuIEluaXRpYWxseSwgaXQgaXMgX3RvdGFsU3VwcGx5CiAgICB1aW50IHB1YmxpYyBfaWNvU3VwcGx5ID0gX3RvdGFsU3VwcGx5ICogX2ljb1BlcmNlbnQgLyAxMDA7CiAgICAKICAgIC8vIG1pbmltdW0gYnV5IDAuMSBFVEgKICAgIHVpbnQgcHVibGljIF9taW5pbXVtQnV5ID0gMTAgKiogMTc7CiAgICAKICAgIC8vIG1heGltdW0gYnV5IDMwIEVUSAogICAgdWludCBwdWJsaWMgX21heGltdW1CdXkgPSAzMCAqIDEwICoqIDE4OwogICAgCiAgICAvKioKICAgICAqIEZ1bmN0aW9ucyB3aXRoIHRoaXMgbW9kaWZpZXIgY2FuIG9ubHkgYmUgZXhlY3V0ZWQgYnkgdGhlIG93bmVyCiAgICAgKi8KICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBGdW5jdGlvbnMgd2l0aCB0aGlzIG1vZGlmaWVyIGNhbiBvbmx5IGJlIGV4ZWN1dGVkIGJ5IHVzZXJzIGV4Y2VwdCBvd25lcnMKICAgICAqLwogICAgbW9kaWZpZXIgb25seU5vdE93bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciAhPSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEZ1bmN0aW9ucyB3aXRoIHRoaXMgbW9kaWZpZXIgY2hlY2sgb24gc2FsZSBzdGF0dXMKICAgICAqIE9ubHkgYWxsb3cgc2FsZSBpZiBfc2VsbGluZyBpcyBvbgogICAgICovCiAgICBtb2RpZmllciBvblNhbGUoKSB7CiAgICAgICAgcmVxdWlyZShfc2VsbGluZyAmJiAoX2ljb1N1cHBseSA+IDApICk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEZ1bmN0aW9ucyB3aXRoIHRoaXMgbW9kaWZpZXIgY2hlY2sgdGhlIHZhbGlkaXR5IG9mIG9yaWdpbmFsIGJ1eSBwcmljZQogICAgICovCiAgICBtb2RpZmllciB2YWxpZE9yaWdpbmFsQnV5UHJpY2UoKSB7CiAgICAgICAgcmVxdWlyZShfb3JpZ2luYWxCdXlQcmljZSA+IDApOwogICAgICAgIF87CiAgICB9CiAgICAKICAgIC8qKgogICAgICogRnVuY3Rpb25zIHdpdGggdGhpcyBtb2RpZmllciBjaGVjayB0aGUgdmFsaWRpdHkgb2YgYWRkcmVzcyBpcyBpbnZlc3RvcgogICAgICovCiAgICBtb2RpZmllciB2YWxpZEludmVzdG9yKCkgewogICAgICAgIHJlcXVpcmUoYXBwcm92ZWRJbnZlc3Rvckxpc3RbbXNnLnNlbmRlcl0pOwogICAgICAgIF87CiAgICB9CiAgICAKICAgIC8qKgogICAgICogRnVuY3Rpb25zIHdpdGggdGhpcyBtb2RpZmllciBjaGVjayB0aGUgdmFsaWRpdHkgb2YgbXNnIHZhbHVlCiAgICAgKiB2YWx1ZSBtdXN0IGdyZWF0ZXIgdGhhbiBlcXVhbCBtaW5pbXVtQnV5UHJpY2UKICAgICAqIHRvdGFsIGRlcG9zaXQgbXVzdCBsZXNzIHRoYW4gZXF1YWwgbWF4aW11bUJ1eVByaWNlCiAgICAgKi8KICAgIG1vZGlmaWVyIHZhbGlkVmFsdWUoKXsKICAgICAgICAvLyBpZiB2YWx1ZSA8IF9taW5pbXVtQnV5IE9SIHRvdGFsIGRlcG9zaXQgb2YgbXNnLnNlbmRlciA+IG1heGltdW1CdXlQcmljZQogICAgICAgIHJlcXVpcmUgKCAobXNnLnZhbHVlID49IF9taW5pbXVtQnV5KSAmJgogICAgICAgICAgICAgICAgKCAoZGVwb3NpdFttc2cuc2VuZGVyXSArIG1zZy52YWx1ZSkgPD0gX21heGltdW1CdXkpICk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLy8gQGRldiBGYWxsYmFjayBmdW5jdGlvbiBhbGxvd3MgdG8gYnV5IGV0aGVyLgogICAgZnVuY3Rpb24oKQogICAgICAgIHB1YmxpYwogICAgICAgIHBheWFibGUKICAgICAgICB2YWxpZFZhbHVlIHsKICAgICAgICAvLyBjaGVjayB0aGUgZmlyc3QgYnV5ID0+IHB1c2ggdG8gQXJyYXkKICAgICAgICBpZiAoZGVwb3NpdFttc2cuc2VuZGVyXSA9PSAwICYmIG1zZy52YWx1ZSAhPSAwKXsKICAgICAgICAgICAgLy8gYWRkIG5ldyBidXllciB0byBMaXN0CiAgICAgICAgICAgIGJ1eWVycy5wdXNoKG1zZy5zZW5kZXIpOwogICAgICAgIH0KICAgICAgICAvLyBpbmNyZWFzZSBhbW91bnQgZGVwb3NpdCBvZiBidXllcgogICAgICAgIGRlcG9zaXRbbXNnLnNlbmRlcl0gKz0gbXNnLnZhbHVlOwogICAgfQoKICAgIC8vLyBAZGV2IENvbnN0cnVjdG9yCiAgICBmdW5jdGlvbiBHaWZ0bygpIAogICAgICAgIHB1YmxpYyB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIGJhbGFuY2VzW293bmVyXSA9IF90b3RhbFN1cHBseTsKICAgICAgICBUcmFuc2ZlcigweDAsIG93bmVyLCBfdG90YWxTdXBwbHkpOwogICAgfQogICAgCiAgICAvLy8gQGRldiBHZXRzIHRvdGFsU3VwcGx5CiAgICAvLy8gQHJldHVybiBUb3RhbCBzdXBwbHkKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkKICAgICAgICBwdWJsaWMgCiAgICAgICAgY29uc3RhbnQgCiAgICAgICAgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBfdG90YWxTdXBwbHk7CiAgICB9CiAgICAKICAgIC8vLyBAZGV2IHNldCBuZXcgaWNvUGVyY2VudAogICAgLy8vIEBwYXJhbSBuZXdJY29QZXJjZW50IG5ldyB2YWx1ZSBvZiBpY29QZXJjZW50CiAgICBmdW5jdGlvbiBzZXRJY29QZXJjZW50KHVpbnQyNTYgbmV3SWNvUGVyY2VudCkKICAgICAgICBwdWJsaWMgCiAgICAgICAgb25seU93bmVyCiAgICAgICAgcmV0dXJucyAoYm9vbCl7CiAgICAgICAgX2ljb1BlcmNlbnQgPSBuZXdJY29QZXJjZW50OwogICAgICAgIF9pY29TdXBwbHkgPSBfdG90YWxTdXBwbHkgKiBfaWNvUGVyY2VudCAvIDEwMDsKICAgIH0KICAgIAogICAgLy8vIEBkZXYgc2V0IG5ldyBfbWluaW11bUJ1eQogICAgLy8vIEBwYXJhbSBuZXdNaW5pbXVtQnV5IG5ldyB2YWx1ZSBvZiBfbWluaW11bUJ1eQogICAgZnVuY3Rpb24gc2V0TWluaW11bUJ1eSh1aW50MjU2IG5ld01pbmltdW1CdXkpCiAgICAgICAgcHVibGljIAogICAgICAgIG9ubHlPd25lcgogICAgICAgIHJldHVybnMgKGJvb2wpewogICAgICAgIF9taW5pbXVtQnV5ID0gbmV3TWluaW11bUJ1eTsKICAgIH0KICAgIAogICAgLy8vIEBkZXYgc2V0IG5ldyBfbWF4aW11bUJ1eQogICAgLy8vIEBwYXJhbSBuZXdNYXhpbXVtQnV5IG5ldyB2YWx1ZSBvZiBfbWF4aW11bUJ1eQogICAgZnVuY3Rpb24gc2V0TWF4aW11bUJ1eSh1aW50MjU2IG5ld01heGltdW1CdXkpCiAgICAgICAgcHVibGljIAogICAgICAgIG9ubHlPd25lcgogICAgICAgIHJldHVybnMgKGJvb2wpewogICAgICAgIF9tYXhpbXVtQnV5ID0gbmV3TWF4aW11bUJ1eTsKICAgIH0KIAogICAgLy8vIEBkZXYgR2V0cyBhY2NvdW50J3MgYmFsYW5jZQogICAgLy8vIEBwYXJhbSBfYWRkciBBZGRyZXNzIG9mIHRoZSBhY2NvdW50CiAgICAvLy8gQHJldHVybiBBY2NvdW50IGJhbGFuY2UKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9hZGRyKSAKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudCAKICAgICAgICByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19hZGRyXTsKICAgIH0KICAgIAogICAgLy8vIEBkZXYgY2hlY2sgYWRkcmVzcyBpcyBhcHByb3ZlZCBpbnZlc3RvcgogICAgLy8vIEBwYXJhbSBfYWRkciBhZGRyZXNzCiAgICBmdW5jdGlvbiBpc0FwcHJvdmVkSW52ZXN0b3IoYWRkcmVzcyBfYWRkcikKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gYXBwcm92ZWRJbnZlc3Rvckxpc3RbX2FkZHJdOwogICAgfQogICAgCiAgICAvLy8gQGRldiBmaWx0ZXIgYnV5ZXJzIGluIGxpc3QgYnV5ZXJzCiAgICAvLy8gQHBhcmFtIGlzSW52ZXN0b3IgdHlwZSBidXllcnMsIGlzIGludmVzdG9yIG9yIG5vdAogICAgZnVuY3Rpb24gZmlsdGVyQnV5ZXJzKGJvb2wgaXNJbnZlc3RvcikKICAgICAgICBwcml2YXRlCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zKGFkZHJlc3NbXSBmaWx0ZXJMaXN0KXsKICAgICAgICBhZGRyZXNzW10gbWVtb3J5IGZpbHRlclRtcCA9IG5ldyBhZGRyZXNzW10oYnV5ZXJzLmxlbmd0aCk7CiAgICAgICAgdWludCBjb3VudCA9IDA7CiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgYnV5ZXJzLmxlbmd0aDsgaSsrKXsKICAgICAgICAgICAgaWYoYXBwcm92ZWRJbnZlc3Rvckxpc3RbYnV5ZXJzW2ldXSA9PSBpc0ludmVzdG9yKXsKICAgICAgICAgICAgICAgIGZpbHRlclRtcFtjb3VudF0gPSBidXllcnNbaV07CiAgICAgICAgICAgICAgICBjb3VudCsrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGZpbHRlckxpc3QgPSBuZXcgYWRkcmVzc1tdKGNvdW50KTsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY291bnQ7IGkrKyl7CiAgICAgICAgICAgIGlmKGZpbHRlclRtcFtpXSAhPSAweDApewogICAgICAgICAgICAgICAgZmlsdGVyTGlzdFtpXSA9IGZpbHRlclRtcFtpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIAogICAgLy8vIEBkZXYgZmlsdGVyIGJ1eWVycyBhcmUgaW52ZXN0b3IgaW4gbGlzdCBkZXBvc2l0ZWQKICAgIGZ1bmN0aW9uIGdldEludmVzdG9yQnV5ZXJzKCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMoYWRkcmVzc1tdKXsKICAgICAgICByZXR1cm4gZmlsdGVyQnV5ZXJzKHRydWUpOwogICAgfQogICAgCiAgICAvLy8gQGRldiBmaWx0ZXIgbm9ybWFsIEJ1eWVycyBpbiBsaXN0IGJ1eWVyIGRlcG9zaXRlZAogICAgZnVuY3Rpb24gZ2V0Tm9ybWFsQnV5ZXJzKCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMoYWRkcmVzc1tdKXsKICAgICAgICByZXR1cm4gZmlsdGVyQnV5ZXJzKGZhbHNlKTsKICAgIH0KICAgIAogICAgLy8vIEBkZXYgZ2V0IEVUSCBkZXBvc2l0CiAgICAvLy8gQHBhcmFtIF9hZGRyIGFkZHJlc3MgZ2V0IGRlcG9zaXQKICAgIC8vLyBAcmV0dXJuIGFtb3VudCBkZXBvc2l0IG9mIGFuIGJ1eWVyCiAgICBmdW5jdGlvbiBnZXREZXBvc2l0KGFkZHJlc3MgX2FkZHIpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zKHVpbnQyNTYpewogICAgICAgIHJldHVybiBkZXBvc2l0W19hZGRyXTsKICAgIH0KICAgIAogICAgLy8vIEBkZXYgZ2V0IHRvdGFsIGRlcG9zaXQgb2YgYnV5ZXJzCiAgICAvLy8gQHJldHVybiBhbW91bnQgRVRIIGRlcG9zaXQKICAgIGZ1bmN0aW9uIGdldFRvdGFsRGVwb3NpdCgpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zKHVpbnQyNTYgdG90YWxEZXBvc2l0KXsKICAgICAgICB0b3RhbERlcG9zaXQgPSAwOwogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IGJ1eWVycy5sZW5ndGg7IGkrKyl7CiAgICAgICAgICAgIHRvdGFsRGVwb3NpdCArPSBkZXBvc2l0W2J1eWVyc1tpXV07CiAgICAgICAgfQogICAgfQogICAgCiAgICAvLy8gQGRldiBkZWxpdmVyeSB0b2tlbiBmb3IgYnV5ZXIKICAgIC8vLyBAcGFyYW0gaXNJbnZlc3RvciB0cmFuc2ZlciB0b2tlbiBmb3IgaW52ZXN0b3Igb3Igbm90CiAgICAvLy8gICAgICAgICB0cnVlOiBpbnZlc3RvcnMKICAgIC8vLyAgICAgICAgIGZhbHNlOiBub3QgaW52ZXN0b3JzCiAgICBmdW5jdGlvbiBkZWxpdmVyeVRva2VuKGJvb2wgaXNJbnZlc3RvcikKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5T3duZXIKICAgICAgICB2YWxpZE9yaWdpbmFsQnV5UHJpY2UgewogICAgICAgIC8vc3VtYXJ5IGRlcG9zaXQgb2YgaW52ZXN0b3JzCiAgICAgICAgdWludDI1NiBzdW0gPSAwOwogICAgICAgIAogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IGJ1eWVycy5sZW5ndGg7IGkrKyl7CiAgICAgICAgICAgIGlmKGFwcHJvdmVkSW52ZXN0b3JMaXN0W2J1eWVyc1tpXV0gPT0gaXNJbnZlc3RvcikgewogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBjb21wdXRlIGFtb3VudCB0b2tlbiBvZiBlYWNoIGJ1eWVyCiAgICAgICAgICAgICAgICB1aW50MjU2IHJlcXVlc3RlZFVuaXRzID0gZGVwb3NpdFtidXllcnNbaV1dIC8gX29yaWdpbmFsQnV5UHJpY2U7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vY2hlY2sgcmVxdWVzdGVkVW5pdHMgPiBfaWNvU3VwcGx5CiAgICAgICAgICAgICAgICBpZihyZXF1ZXN0ZWRVbml0cyA8PSBfaWNvU3VwcGx5ICYmIHJlcXVlc3RlZFVuaXRzID4gMCApewogICAgICAgICAgICAgICAgICAgIC8vIHByZXBhcmUgdHJhbnNmZXIgZGF0YQogICAgICAgICAgICAgICAgICAgIC8vIE5PVEU6IG1ha2Ugc3VyZSBiYWxhbmNlcyBvd25lciBncmVhdGVyIHRoYW4gX2ljb1N1cHBseQogICAgICAgICAgICAgICAgICAgIGJhbGFuY2VzW293bmVyXSAtPSByZXF1ZXN0ZWRVbml0czsKICAgICAgICAgICAgICAgICAgICBiYWxhbmNlc1tidXllcnNbaV1dICs9IHJlcXVlc3RlZFVuaXRzOwogICAgICAgICAgICAgICAgICAgIF9pY29TdXBwbHkgLT0gcmVxdWVzdGVkVW5pdHM7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gc3VibWl0IHRyYW5zZmVyCiAgICAgICAgICAgICAgICAgICAgVHJhbnNmZXIob3duZXIsIGJ1eWVyc1tpXSwgcmVxdWVzdGVkVW5pdHMpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIHJlc2V0IGRlcG9zaXQgb2YgYnV5ZXIKICAgICAgICAgICAgICAgICAgICBzdW0gKz0gZGVwb3NpdFtidXllcnNbaV1dOwogICAgICAgICAgICAgICAgICAgIGRlcG9zaXRbYnV5ZXJzW2ldXSA9IDA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLy90cmFuc2ZlciB0b3RhbCBFVEggb2YgaW52ZXN0b3JzIHRvIG93bmVyCiAgICAgICAgb3duZXIudHJhbnNmZXIoc3VtKTsKICAgIH0KICAgIAogICAgLy8vIEBkZXYgcmV0dXJuIEVUSCBmb3Igbm9ybWFsIGJ1eWVycwogICAgZnVuY3Rpb24gcmV0dXJuRVRIZm9yTm9ybWFsQnV5ZXJzKCkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5T3duZXJ7CiAgICAgICAgZm9yKHVpbnQgaSA9IDA7IGkgPCBidXllcnMubGVuZ3RoOyBpKyspewogICAgICAgICAgICAvLyBidXllciBub3QgYXBwcm92ZSBpbnZlc3RvcgogICAgICAgICAgICBpZiAoIWFwcHJvdmVkSW52ZXN0b3JMaXN0W2J1eWVyc1tpXV0pIHsKICAgICAgICAgICAgICAgIC8vIGdldCBkZXBvc2l0IG9mIGJ1eWVyCiAgICAgICAgICAgICAgICB1aW50MjU2IGJ1eWVyRGVwb3NpdCA9IGRlcG9zaXRbYnV5ZXJzW2ldXTsKICAgICAgICAgICAgICAgIC8vIHJlc2V0IGRlcG9zaXQgb2YgYnV5ZXIKICAgICAgICAgICAgICAgIGRlcG9zaXRbYnV5ZXJzW2ldXSA9IDA7CiAgICAgICAgICAgICAgICAvLyByZXR1cm4gZGVwb3NpdCBhbW91bnQgZm9yIGJ1eWVyCiAgICAgICAgICAgICAgICBidXllcnNbaV0udHJhbnNmZXIoYnV5ZXJEZXBvc2l0KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KIAogICAgLy8vIEBkZXYgVHJhbnNmZXJzIHRoZSBiYWxhbmNlIGZyb20gTXVsdGlzaWcgd2FsbGV0IHRvIGFuIGFjY291bnQKICAgIC8vLyBAcGFyYW0gX3RvIFJlY2lwaWVudCBhZGRyZXNzCiAgICAvLy8gQHBhcmFtIF9hbW91bnQgVHJhbnNmZXJlZCBhbW91bnQgaW4gdW5pdAogICAgLy8vIEByZXR1cm4gVHJhbnNmZXIgc3RhdHVzCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KQogICAgICAgIHB1YmxpYyAKICAgICAgICByZXR1cm5zIChib29sKSB7CiAgICAgICAgLy8gaWYgc2VuZGVyJ3MgYmFsYW5jZSBoYXMgZW5vdWdoIHVuaXQgYW5kIGFtb3VudCA+PSAwLCAKICAgICAgICAvLyAgICAgIGFuZCB0aGUgc3VtIGlzIG5vdCBvdmVyZmxvdywKICAgICAgICAvLyB0aGVuIGRvIHRyYW5zZmVyIAogICAgICAgIGlmICggKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IF9hbW91bnQpICYmCiAgICAgICAgICAgICAoX2Ftb3VudCA+PSAwKSAmJiAKICAgICAgICAgICAgIChiYWxhbmNlc1tfdG9dICsgX2Ftb3VudCA+IGJhbGFuY2VzW190b10pICkgeyAgCgogICAgICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSBfYW1vdW50OwogICAgICAgICAgICBiYWxhbmNlc1tfdG9dICs9IF9hbW91bnQ7CiAgICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX2Ftb3VudCk7CiAgICAgICAgICAgIAogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQogICAgfQoKICAgIC8vLyBAZGV2IEVuYWJsZXMgc2FsZSAKICAgIGZ1bmN0aW9uIHR1cm5PblNhbGUoKSBvbmx5T3duZXIgCiAgICAgICAgcHVibGljIHsKICAgICAgICBfc2VsbGluZyA9IHRydWU7CiAgICB9CgogICAgLy8vIEBkZXYgRGlzYWJsZXMgc2FsZQogICAgZnVuY3Rpb24gdHVybk9mZlNhbGUoKSBvbmx5T3duZXIgCiAgICAgICAgcHVibGljIHsKICAgICAgICBfc2VsbGluZyA9IGZhbHNlOwogICAgfQoKICAgIC8vLyBAZGV2IEdldHMgc2VsbGluZyBzdGF0dXMKICAgIGZ1bmN0aW9uIGlzU2VsbGluZ05vdygpIAogICAgICAgIHB1YmxpYyAKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gX3NlbGxpbmc7CiAgICB9CgogICAgLy8vIEBkZXYgVXBkYXRlcyBidXkgcHJpY2UgKG93bmVyIE9OTFkpCiAgICAvLy8gQHBhcmFtIG5ld0J1eVByaWNlIE5ldyBidXkgcHJpY2UgKGluIHVuaXQpCiAgICBmdW5jdGlvbiBzZXRCdXlQcmljZSh1aW50IG5ld0J1eVByaWNlKSAKICAgICAgICBvbmx5T3duZXIgCiAgICAgICAgcHVibGljIHsKICAgICAgICBfb3JpZ2luYWxCdXlQcmljZSA9IG5ld0J1eVByaWNlOwogICAgfQoKICAgIC8vLyBAZGV2IEFkZHMgbGlzdCBvZiBuZXcgaW52ZXN0b3JzIHRvIHRoZSBpbnZlc3RvcnMgbGlzdCBhbmQgYXBwcm92ZSBhbGwKICAgIC8vLyBAcGFyYW0gbmV3SW52ZXN0b3JMaXN0IEFycmF5IG9mIG5ldyBpbnZlc3RvcnMgYWRkcmVzc2VzIHRvIGJlIGFkZGVkCiAgICBmdW5jdGlvbiBhZGRJbnZlc3Rvckxpc3QoYWRkcmVzc1tdIG5ld0ludmVzdG9yTGlzdCkKICAgICAgICBvbmx5T3duZXIKICAgICAgICBwdWJsaWMgewogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IG5ld0ludmVzdG9yTGlzdC5sZW5ndGg7IGkrKyl7CiAgICAgICAgICAgIGFwcHJvdmVkSW52ZXN0b3JMaXN0W25ld0ludmVzdG9yTGlzdFtpXV0gPSB0cnVlOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8gQGRldiBSZW1vdmVzIGxpc3Qgb2YgaW52ZXN0b3JzIGZyb20gbGlzdAogICAgLy8vIEBwYXJhbSBpbnZlc3Rvckxpc3QgQXJyYXkgb2YgYWRkcmVzc2VzIG9mIGludmVzdG9ycyB0byBiZSByZW1vdmVkCiAgICBmdW5jdGlvbiByZW1vdmVJbnZlc3Rvckxpc3QoYWRkcmVzc1tdIGludmVzdG9yTGlzdCkKICAgICAgICBvbmx5T3duZXIKICAgICAgICBwdWJsaWMgewogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IGludmVzdG9yTGlzdC5sZW5ndGg7IGkrKyl7CiAgICAgICAgICAgIGFwcHJvdmVkSW52ZXN0b3JMaXN0W2ludmVzdG9yTGlzdFtpXV0gPSBmYWxzZTsKICAgICAgICB9CiAgICB9CgogICAgLy8vIEBkZXYgQnV5cyBHaWZ0bwogICAgLy8vIEByZXR1cm4gQW1vdW50IG9mIHJlcXVlc3RlZCB1bml0cyAKICAgIGZ1bmN0aW9uIGJ1eSgpIHBheWFibGUKICAgICAgICBvbmx5Tm90T3duZXIgCiAgICAgICAgdmFsaWRPcmlnaW5hbEJ1eVByaWNlCiAgICAgICAgdmFsaWRJbnZlc3RvcgogICAgICAgIG9uU2FsZSAKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zICh1aW50MjU2IGFtb3VudCkgewogICAgICAgIC8vIGNvbnZlcnQgYnV5IGFtb3VudCBpbiB3ZWkgdG8gbnVtYmVyIG9mIHVuaXQgd2FudCB0byBidXkKICAgICAgICB1aW50IHJlcXVlc3RlZFVuaXRzID0gbXNnLnZhbHVlIC8gX29yaWdpbmFsQnV5UHJpY2UgOwogICAgICAgIAogICAgICAgIC8vY2hlY2sgcmVxdWVzdGVkVW5pdHMgPD0gX2ljb1N1cHBseQogICAgICAgIHJlcXVpcmUocmVxdWVzdGVkVW5pdHMgPD0gX2ljb1N1cHBseSk7CgogICAgICAgIC8vIHByZXBhcmUgdHJhbnNmZXIgZGF0YQogICAgICAgIGJhbGFuY2VzW293bmVyXSAtPSByZXF1ZXN0ZWRVbml0czsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSArPSByZXF1ZXN0ZWRVbml0czsKICAgICAgICAKICAgICAgICAvLyBkZWNyZWFzZSBfaWNvU3VwcGx5CiAgICAgICAgX2ljb1N1cHBseSAtPSByZXF1ZXN0ZWRVbml0czsKCiAgICAgICAgLy8gc3VibWl0IHRyYW5zZmVyCiAgICAgICAgVHJhbnNmZXIob3duZXIsIG1zZy5zZW5kZXIsIHJlcXVlc3RlZFVuaXRzKTsKCiAgICAgICAgLy90cmFuc2ZlciBFVEggdG8gb3duZXIKICAgICAgICBvd25lci50cmFuc2Zlcihtc2cudmFsdWUpOwogICAgICAgIAogICAgICAgIHJldHVybiByZXF1ZXN0ZWRVbml0czsKICAgIH0KICAgIAogICAgLy8vIEBkZXYgV2l0aGRyYXdzIEV0aGVyIGluIGNvbnRyYWN0IChPd25lciBvbmx5KQogICAgLy8vIEByZXR1cm4gU3RhdHVzIG9mIHdpdGhkcmF3YWwKICAgIGZ1bmN0aW9uIHdpdGhkcmF3KCkgb25seU93bmVyIAogICAgICAgIHB1YmxpYyAKICAgICAgICByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIG93bmVyLnNlbmQodGhpcy5iYWxhbmNlKTsKICAgIH0KfQoKLy8vIEB0aXRsZSBNdWx0aXNpZ25hdHVyZSB3YWxsZXQgLSBBbGxvd3MgbXVsdGlwbGUgcGFydGllcyB0byBhZ3JlZSBvbiB0cmFuc2FjdGlvbnMgYmVmb3JlIGV4ZWN1dGlvbi4KY29udHJhY3QgTXVsdGlTaWdXYWxsZXQgewoKICAgIGV2ZW50IENvbmZpcm1hdGlvbihhZGRyZXNzIHNlbmRlciwgYnl0ZXMzMiB0cmFuc2FjdGlvbklkKTsKICAgIGV2ZW50IFJldm9jYXRpb24oYWRkcmVzcyBzZW5kZXIsIGJ5dGVzMzIgdHJhbnNhY3Rpb25JZCk7CiAgICBldmVudCBTdWJtaXNzaW9uKGJ5dGVzMzIgdHJhbnNhY3Rpb25JZCk7CiAgICBldmVudCBFeGVjdXRpb24oYnl0ZXMzMiB0cmFuc2FjdGlvbklkKTsKICAgIGV2ZW50IERlcG9zaXQoYWRkcmVzcyBzZW5kZXIsIHVpbnQgdmFsdWUpOwogICAgZXZlbnQgT3duZXJBZGRpdGlvbihhZGRyZXNzIG93bmVyKTsKICAgIGV2ZW50IE93bmVyUmVtb3ZhbChhZGRyZXNzIG93bmVyKTsKICAgIGV2ZW50IFJlcXVpcmVtZW50Q2hhbmdlKHVpbnQgcmVxdWlyZWQpOwogICAgZXZlbnQgQ29pbkNyZWF0aW9uKGFkZHJlc3MgY29pbik7CgogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiBUcmFuc2FjdGlvbikgcHVibGljIHRyYW5zYWN0aW9uczsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSkgcHVibGljIGNvbmZpcm1hdGlvbnM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBpc093bmVyOwogICAgYWRkcmVzc1tdIG93bmVyczsKICAgIGJ5dGVzMzJbXSB0cmFuc2FjdGlvbkxpc3Q7CiAgICB1aW50IHB1YmxpYyByZXF1aXJlZDsKCiAgICBzdHJ1Y3QgVHJhbnNhY3Rpb24gewogICAgICAgIGFkZHJlc3MgZGVzdGluYXRpb247CiAgICAgICAgdWludCB2YWx1ZTsKICAgICAgICBieXRlcyBkYXRhOwogICAgICAgIHVpbnQgbm9uY2U7CiAgICAgICAgYm9vbCBleGVjdXRlZDsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5V2FsbGV0KCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBhZGRyZXNzKHRoaXMpKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG93bmVyRG9lc05vdEV4aXN0KGFkZHJlc3Mgb3duZXIpIHsKICAgICAgICByZXF1aXJlKCFpc093bmVyW293bmVyXSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvd25lckV4aXN0cyhhZGRyZXNzIG93bmVyKSB7CiAgICAgICAgcmVxdWlyZShpc093bmVyW293bmVyXSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBjb25maXJtZWQoYnl0ZXMzMiB0cmFuc2FjdGlvbklkLCBhZGRyZXNzIG93bmVyKSB7CiAgICAgICAgcmVxdWlyZShjb25maXJtYXRpb25zW3RyYW5zYWN0aW9uSWRdW293bmVyXSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBub3RDb25maXJtZWQoYnl0ZXMzMiB0cmFuc2FjdGlvbklkLCBhZGRyZXNzIG93bmVyKSB7CiAgICAgICAgcmVxdWlyZSghY29uZmlybWF0aW9uc1t0cmFuc2FjdGlvbklkXVtvd25lcl0pOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgbm90RXhlY3V0ZWQoYnl0ZXMzMiB0cmFuc2FjdGlvbklkKSB7CiAgICAgICAgcmVxdWlyZSghdHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9uSWRdLmV4ZWN1dGVkKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG5vdE51bGwoYWRkcmVzcyBkZXN0aW5hdGlvbikgewogICAgICAgIHJlcXVpcmUoZGVzdGluYXRpb24gIT0gMCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciB2YWxpZFJlcXVpcmVtZW50KHVpbnQgX293bmVyQ291bnQsIHVpbnQgX3JlcXVpcmVkKSB7CiAgICAgICAgcmVxdWlyZSggICBfcmVxdWlyZWQgPD0gX293bmVyQ291bnQKICAgICAgICAgICAgICAgICYmIF9yZXF1aXJlZCA+IDAgKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICAvLy8gQGRldiBDb250cmFjdCBjb25zdHJ1Y3RvciBzZXRzIGluaXRpYWwgb3duZXJzIGFuZCByZXF1aXJlZCBudW1iZXIgb2YgY29uZmlybWF0aW9ucy4KICAgIC8vLyBAcGFyYW0gX293bmVycyBMaXN0IG9mIGluaXRpYWwgb3duZXJzLgogICAgLy8vIEBwYXJhbSBfcmVxdWlyZWQgTnVtYmVyIG9mIHJlcXVpcmVkIGNvbmZpcm1hdGlvbnMuCiAgICBmdW5jdGlvbiBNdWx0aVNpZ1dhbGxldChhZGRyZXNzW10gX293bmVycywgdWludCBfcmVxdWlyZWQpCiAgICAgICAgdmFsaWRSZXF1aXJlbWVudChfb3duZXJzLmxlbmd0aCwgX3JlcXVpcmVkKQogICAgICAgIHB1YmxpYyB7CiAgICAgICAgZm9yICh1aW50IGk9MDsgaTxfb3duZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIC8vIGNoZWNrIGR1cGxpY2F0ZSBvd25lciBhbmQgaW52YWxpZCBhZGRyZXNzCiAgICAgICAgICAgIGlmIChpc093bmVyW19vd25lcnNbaV1dIHx8IF9vd25lcnNbaV0gPT0gMCl7CiAgICAgICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBhc3NpZ24gbmV3IG93bmVyCiAgICAgICAgICAgIGlzT3duZXJbX293bmVyc1tpXV0gPSB0cnVlOwogICAgICAgIH0KICAgICAgICBvd25lcnMgPSBfb3duZXJzOwogICAgICAgIHJlcXVpcmVkID0gX3JlcXVpcmVkOwogICAgfQoKICAgIC8vLyAgRmFsbGJhY2sgZnVuY3Rpb24gYWxsb3dzIHRvIGRlcG9zaXQgZXRoZXIuCiAgICBmdW5jdGlvbigpCiAgICAgICAgcHVibGljCiAgICAgICAgcGF5YWJsZSB7CiAgICAgICAgaWYgKG1zZy52YWx1ZSA+IDApCiAgICAgICAgICAgIERlcG9zaXQobXNnLnNlbmRlciwgbXNnLnZhbHVlKTsKICAgIH0KCiAgICAvLy8gQGRldiBBbGxvd3MgdG8gYWRkIGEgbmV3IG93bmVyLiBUcmFuc2FjdGlvbiBoYXMgdG8gYmUgc2VudCBieSB3YWxsZXQuCiAgICAvLy8gQHBhcmFtIG93bmVyIEFkZHJlc3Mgb2YgbmV3IG93bmVyLgogICAgZnVuY3Rpb24gYWRkT3duZXIoYWRkcmVzcyBvd25lcikKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5V2FsbGV0CiAgICAgICAgb3duZXJEb2VzTm90RXhpc3Qob3duZXIpIHsKICAgICAgICBpc093bmVyW293bmVyXSA9IHRydWU7CiAgICAgICAgb3duZXJzLnB1c2gob3duZXIpOwogICAgICAgIE93bmVyQWRkaXRpb24ob3duZXIpOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyB0byByZW1vdmUgYW4gb3duZXIuIFRyYW5zYWN0aW9uIGhhcyB0byBiZSBzZW50IGJ5IHdhbGxldC4KICAgIC8vLyBAcGFyYW0gb3duZXIgQWRkcmVzcyBvZiBvd25lci4KICAgIGZ1bmN0aW9uIHJlbW92ZU93bmVyKGFkZHJlc3Mgb3duZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seVdhbGxldAogICAgICAgIG93bmVyRXhpc3RzKG93bmVyKSB7CiAgICAgICAgLy8gRE8gTk9UIHJlbW92ZSBsYXN0IG93bmVyCiAgICAgICAgcmVxdWlyZShvd25lcnMubGVuZ3RoID4gMSk7CiAgICAgICAgCiAgICAgICAgaXNPd25lcltvd25lcl0gPSBmYWxzZTsKICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPG93bmVycy5sZW5ndGggLSAxOyBpKyspCiAgICAgICAgICAgIGlmIChvd25lcnNbaV0gPT0gb3duZXIpIHsKICAgICAgICAgICAgICAgIG93bmVyc1tpXSA9IG93bmVyc1tvd25lcnMubGVuZ3RoIC0gMV07CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIG93bmVycy5sZW5ndGggLT0gMTsKICAgICAgICBpZiAocmVxdWlyZWQgPiBvd25lcnMubGVuZ3RoKQogICAgICAgICAgICBjaGFuZ2VSZXF1aXJlbWVudChvd25lcnMubGVuZ3RoKTsKICAgICAgICBPd25lclJlbW92YWwob3duZXIpOwogICAgfQoKICAgIC8vLyBAZGV2IFVwZGF0ZSB0aGUgbWluaW11bSByZXF1aXJlZCBvd25lciBmb3IgdHJhbnNhY3Rpb24gdmFsaWRhdGlvbgogICAgLy8vIEBwYXJhbSBfcmVxdWlyZWQgbnVtYmVyIG9mIG93bmVycwogICAgZnVuY3Rpb24gY2hhbmdlUmVxdWlyZW1lbnQodWludCBfcmVxdWlyZWQpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seVdhbGxldAogICAgICAgIHZhbGlkUmVxdWlyZW1lbnQob3duZXJzLmxlbmd0aCwgX3JlcXVpcmVkKSB7CiAgICAgICAgcmVxdWlyZWQgPSBfcmVxdWlyZWQ7CiAgICAgICAgUmVxdWlyZW1lbnRDaGFuZ2UoX3JlcXVpcmVkKTsKICAgIH0KCiAgICAvLy8gQGRldiBBZGRzIGEgbmV3IHRyYW5zYWN0aW9uIHRvIHRoZSB0cmFuc2FjdGlvbiBtYXBwaW5nLCBpZiB0cmFuc2FjdGlvbiBkb2VzIG5vdCBleGlzdCB5ZXQuCiAgICAvLy8gQHBhcmFtIGRlc3RpbmF0aW9uIFRyYW5zYWN0aW9uIHRhcmdldCBhZGRyZXNzLgogICAgLy8vIEBwYXJhbSB2YWx1ZSBUcmFuc2FjdGlvbiBldGhlciB2YWx1ZS4KICAgIC8vLyBAcGFyYW0gZGF0YSBUcmFuc2FjdGlvbiBkYXRhIHBheWxvYWQuCiAgICAvLy8gQHBhcmFtIG5vbmNlIAogICAgLy8vIEByZXR1cm4gdHJhbnNhY3Rpb25JZC4KICAgIGZ1bmN0aW9uIGFkZFRyYW5zYWN0aW9uKGFkZHJlc3MgZGVzdGluYXRpb24sIHVpbnQgdmFsdWUsIGJ5dGVzIGRhdGEsIHVpbnQgbm9uY2UpCiAgICAgICAgcHJpdmF0ZQogICAgICAgIG5vdE51bGwoZGVzdGluYXRpb24pCiAgICAgICAgcmV0dXJucyAoYnl0ZXMzMiB0cmFuc2FjdGlvbklkKSB7CiAgICAgICAgLy8gdHJhbnNhY3Rpb25JZCA9IHNoYTMoZGVzdGluYXRpb24sIHZhbHVlLCBkYXRhLCBub25jZSk7CiAgICAgICAgdHJhbnNhY3Rpb25JZCA9IGtlY2NhazI1NihkZXN0aW5hdGlvbiwgdmFsdWUsIGRhdGEsIG5vbmNlKTsKICAgICAgICBpZiAodHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9uSWRdLmRlc3RpbmF0aW9uID09IDApIHsKICAgICAgICAgICAgdHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9uSWRdID0gVHJhbnNhY3Rpb24oewogICAgICAgICAgICAgICAgZGVzdGluYXRpb246IGRlc3RpbmF0aW9uLAogICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlLAogICAgICAgICAgICAgICAgZGF0YTogZGF0YSwKICAgICAgICAgICAgICAgIG5vbmNlOiBub25jZSwKICAgICAgICAgICAgICAgIGV4ZWN1dGVkOiBmYWxzZQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdHJhbnNhY3Rpb25MaXN0LnB1c2godHJhbnNhY3Rpb25JZCk7CiAgICAgICAgICAgIFN1Ym1pc3Npb24odHJhbnNhY3Rpb25JZCk7CiAgICAgICAgfQogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyBhbiBvd25lciB0byBzdWJtaXQgYW5kIGNvbmZpcm0gYSB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gZGVzdGluYXRpb24gVHJhbnNhY3Rpb24gdGFyZ2V0IGFkZHJlc3MuCiAgICAvLy8gQHBhcmFtIHZhbHVlIFRyYW5zYWN0aW9uIGV0aGVyIHZhbHVlLgogICAgLy8vIEBwYXJhbSBkYXRhIFRyYW5zYWN0aW9uIGRhdGEgcGF5bG9hZC4KICAgIC8vLyBAcGFyYW0gbm9uY2UgCiAgICAvLy8gQHJldHVybiB0cmFuc2FjdGlvbklkLgogICAgZnVuY3Rpb24gc3VibWl0VHJhbnNhY3Rpb24oYWRkcmVzcyBkZXN0aW5hdGlvbiwgdWludCB2YWx1ZSwgYnl0ZXMgZGF0YSwgdWludCBub25jZSkKICAgICAgICBleHRlcm5hbAogICAgICAgIG93bmVyRXhpc3RzKG1zZy5zZW5kZXIpCiAgICAgICAgcmV0dXJucyAoYnl0ZXMzMiB0cmFuc2FjdGlvbklkKSB7CiAgICAgICAgdHJhbnNhY3Rpb25JZCA9IGFkZFRyYW5zYWN0aW9uKGRlc3RpbmF0aW9uLCB2YWx1ZSwgZGF0YSwgbm9uY2UpOwogICAgICAgIGNvbmZpcm1UcmFuc2FjdGlvbih0cmFuc2FjdGlvbklkKTsKICAgIH0KCiAgICAvLy8gQGRldiBBbGxvd3MgYW4gb3duZXIgdG8gY29uZmlybSBhIHRyYW5zYWN0aW9uLgogICAgLy8vIEBwYXJhbSB0cmFuc2FjdGlvbklkIHRyYW5zYWN0aW9uIElkLgogICAgZnVuY3Rpb24gY29uZmlybVRyYW5zYWN0aW9uKGJ5dGVzMzIgdHJhbnNhY3Rpb25JZCkKICAgICAgICBwdWJsaWMKICAgICAgICBvd25lckV4aXN0cyhtc2cuc2VuZGVyKQogICAgICAgIG5vdENvbmZpcm1lZCh0cmFuc2FjdGlvbklkLCBtc2cuc2VuZGVyKSB7CiAgICAgICAgY29uZmlybWF0aW9uc1t0cmFuc2FjdGlvbklkXVttc2cuc2VuZGVyXSA9IHRydWU7CiAgICAgICAgQ29uZmlybWF0aW9uKG1zZy5zZW5kZXIsIHRyYW5zYWN0aW9uSWQpOwogICAgICAgIGV4ZWN1dGVUcmFuc2FjdGlvbih0cmFuc2FjdGlvbklkKTsKICAgIH0KCiAgICAKICAgIC8vLyBAZGV2IEFsbG93cyBhbnlvbmUgdG8gZXhlY3V0ZSBhIGNvbmZpcm1lZCB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gdHJhbnNhY3Rpb25JZCB0cmFuc2FjdGlvbiBJZC4KICAgIGZ1bmN0aW9uIGV4ZWN1dGVUcmFuc2FjdGlvbihieXRlczMyIHRyYW5zYWN0aW9uSWQpCiAgICAgICAgcHVibGljCiAgICAgICAgbm90RXhlY3V0ZWQodHJhbnNhY3Rpb25JZCkgewogICAgICAgIGlmIChpc0NvbmZpcm1lZCh0cmFuc2FjdGlvbklkKSkgewogICAgICAgICAgICBUcmFuc2FjdGlvbiBzdG9yYWdlIHR4biA9IHRyYW5zYWN0aW9uc1t0cmFuc2FjdGlvbklkXTsgCiAgICAgICAgICAgIHR4bi5leGVjdXRlZCA9IHRydWU7CiAgICAgICAgICAgIGlmICghdHhuLmRlc3RpbmF0aW9uLmNhbGwudmFsdWUodHhuLnZhbHVlKSh0eG4uZGF0YSkpCiAgICAgICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICAgICAgRXhlY3V0aW9uKHRyYW5zYWN0aW9uSWQpOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8gQGRldiBBbGxvd3MgYW4gb3duZXIgdG8gcmV2b2tlIGEgY29uZmlybWF0aW9uIGZvciBhIHRyYW5zYWN0aW9uLgogICAgLy8vIEBwYXJhbSB0cmFuc2FjdGlvbklkIHRyYW5zYWN0aW9uIElkLgogICAgZnVuY3Rpb24gcmV2b2tlQ29uZmlybWF0aW9uKGJ5dGVzMzIgdHJhbnNhY3Rpb25JZCkKICAgICAgICBleHRlcm5hbAogICAgICAgIG93bmVyRXhpc3RzKG1zZy5zZW5kZXIpCiAgICAgICAgY29uZmlybWVkKHRyYW5zYWN0aW9uSWQsIG1zZy5zZW5kZXIpCiAgICAgICAgbm90RXhlY3V0ZWQodHJhbnNhY3Rpb25JZCkgewogICAgICAgIGNvbmZpcm1hdGlvbnNbdHJhbnNhY3Rpb25JZF1bbXNnLnNlbmRlcl0gPSBmYWxzZTsKICAgICAgICBSZXZvY2F0aW9uKG1zZy5zZW5kZXIsIHRyYW5zYWN0aW9uSWQpOwogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgdGhlIGNvbmZpcm1hdGlvbiBzdGF0dXMgb2YgYSB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gdHJhbnNhY3Rpb25JZCB0cmFuc2FjdGlvbiBJZC4KICAgIC8vLyBAcmV0dXJuIENvbmZpcm1hdGlvbiBzdGF0dXMuCiAgICBmdW5jdGlvbiBpc0NvbmZpcm1lZChieXRlczMyIHRyYW5zYWN0aW9uSWQpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChib29sKSB7CiAgICAgICAgdWludCBjb3VudCA9IDA7CiAgICAgICAgZm9yICh1aW50IGk9MDsgaTxvd25lcnMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlmIChjb25maXJtYXRpb25zW3RyYW5zYWN0aW9uSWRdW293bmVyc1tpXV0pCiAgICAgICAgICAgICAgICBjb3VudCArPSAxOwogICAgICAgICAgICBpZiAoY291bnQgPT0gcmVxdWlyZWQpCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKgogICAgICogV2ViMyBjYWxsIGZ1bmN0aW9ucwogICAgICovCiAgICAvLy8gQGRldiBSZXR1cm5zIG51bWJlciBvZiBjb25maXJtYXRpb25zIG9mIGEgdHJhbnNhY3Rpb24uCiAgICAvLy8gQHBhcmFtIHRyYW5zYWN0aW9uSWQgdHJhbnNhY3Rpb24gSWQuCiAgICAvLy8gQHJldHVybiBOdW1iZXIgb2YgY29uZmlybWF0aW9ucy4KICAgIGZ1bmN0aW9uIGNvbmZpcm1hdGlvbkNvdW50KGJ5dGVzMzIgdHJhbnNhY3Rpb25JZCkKICAgICAgICBleHRlcm5hbAogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCBjb3VudCkgewogICAgICAgIGZvciAodWludCBpPTA7IGk8b3duZXJzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBpZiAoY29uZmlybWF0aW9uc1t0cmFuc2FjdGlvbklkXVtvd25lcnNbaV1dKQogICAgICAgICAgICAgICAgY291bnQgKz0gMTsKICAgIH0KCiAgICAvLy8gIEBkZXYgUmV0dXJuIGxpc3Qgb2YgdHJhbnNhY3Rpb25zIGFmdGVyIGZpbHRlcnMgYXJlIGFwcGxpZWQKICAgIC8vLyAgQHBhcmFtIGlzUGVuZGluZyBwZW5kaW5nIHN0YXR1cwogICAgLy8vICBAcmV0dXJuIExpc3Qgb2YgdHJhbnNhY3Rpb25zCiAgICBmdW5jdGlvbiBmaWx0ZXJUcmFuc2FjdGlvbnMoYm9vbCBpc1BlbmRpbmcpCiAgICAgICAgcHJpdmF0ZQogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoYnl0ZXMzMltdIF90cmFuc2FjdGlvbkxpc3QpIHsKICAgICAgICBieXRlczMyW10gbWVtb3J5IF90cmFuc2FjdGlvbkxpc3RUZW1wID0gbmV3IGJ5dGVzMzJbXSh0cmFuc2FjdGlvbkxpc3QubGVuZ3RoKTsKICAgICAgICB1aW50IGNvdW50ID0gMDsKICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPHRyYW5zYWN0aW9uTGlzdC5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKHRyYW5zYWN0aW9uc1t0cmFuc2FjdGlvbkxpc3RbaV1dLmV4ZWN1dGVkICE9IGlzUGVuZGluZykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgX3RyYW5zYWN0aW9uTGlzdFRlbXBbY291bnRdID0gdHJhbnNhY3Rpb25MaXN0W2ldOwogICAgICAgICAgICAgICAgY291bnQgKz0gMTsKICAgICAgICAgICAgfQogICAgICAgIF90cmFuc2FjdGlvbkxpc3QgPSBuZXcgYnl0ZXMzMltdKGNvdW50KTsKICAgICAgICBmb3IgKGk9MDsgaTxjb3VudDsgaSsrKQogICAgICAgICAgICBpZiAoX3RyYW5zYWN0aW9uTGlzdFRlbXBbaV0gPiAwKQogICAgICAgICAgICAgICAgX3RyYW5zYWN0aW9uTGlzdFtpXSA9IF90cmFuc2FjdGlvbkxpc3RUZW1wW2ldOwogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgbGlzdCBvZiBwZW5kaW5nIHRyYW5zYWN0aW9ucwogICAgZnVuY3Rpb24gZ2V0UGVuZGluZ1RyYW5zYWN0aW9ucygpCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKGJ5dGVzMzJbXSkgewogICAgICAgIHJldHVybiBmaWx0ZXJUcmFuc2FjdGlvbnModHJ1ZSk7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyBsaXN0IG9mIGV4ZWN1dGVkIHRyYW5zYWN0aW9ucwogICAgZnVuY3Rpb24gZ2V0RXhlY3V0ZWRUcmFuc2FjdGlvbnMoKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChieXRlczMyW10pIHsKICAgICAgICByZXR1cm4gZmlsdGVyVHJhbnNhY3Rpb25zKGZhbHNlKTsKICAgIH0KICAgIAogICAgLy8vIEBkZXYgQ3JlYXRlIG5ldyBjb2luLgogICAgZnVuY3Rpb24gY3JlYXRlQ29pbigpCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICBvbmx5V2FsbGV0CiAgICB7CiAgICAgICAgQ29pbkNyZWF0aW9uKG5ldyBHaWZ0bygpKTsKICAgIH0KfQ=='.
	

]
