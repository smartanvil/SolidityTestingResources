Class {
	#name : #SRT6102a380791a5edfb04bb3e18ea15812a5b82e71,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT6102a380791a5edfb04bb3e18ea15812a5b82e71 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4gMC40LjE5OwoKLyoqCiAqIEB0aXRsZSBHZHByQ29uZmlnCiAqIEBkZXYgQ29uZmlndXJhdGlvbiBmb3IgR0RQUiBDYXNoIHRva2VuIGFuZCBjcm93ZHNhbGUKKi8KY29udHJhY3QgR2RwckNvbmZpZyB7CgogICAgLy8gVG9rZW4gc2V0dGluZ3MKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgVE9LRU5fTkFNRSA9ICJHRFBSIENhc2giOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBUT0tFTl9TWU1CT0wgPSAiR0RQUiI7CiAgICB1aW50OCBwdWJsaWMgY29uc3RhbnQgVE9LRU5fREVDSU1BTFMgPSAxODsKCiAgICAvLyBTbWFsbGVzdCB2YWx1ZSBvZiB0aGUgR0RQUgogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgTUlOX1RPS0VOX1VOSVQgPSAxMCAqKiB1aW50MjU2KFRPS0VOX0RFQ0lNQUxTKTsKICAgIC8vIE1pbmltdW0gY2FwIHBlciBwdXJjaGFzZXIgb24gcHVibGljIHNhbGUgfiAkMTAwIGluIEdEUFIgQ2FzaAogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgUFVSQ0hBU0VSX01JTl9UT0tFTl9DQVAgPSA1MDAgKiBNSU5fVE9LRU5fVU5JVDsKICAgIC8vIE1heGltdW0gY2FwIHBlciBwdXJjaGFzZXIgb24gZmlyc3QgZGF5IG9mIHB1YmxpYyBzYWxlIH4gJDIsMDAwIGluIEdEUFIgQ2FzaAogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgUFVSQ0hBU0VSX01BWF9UT0tFTl9DQVBfREFZMSA9IDEwMDAwICogTUlOX1RPS0VOX1VOSVQ7CiAgICAvLyBNYXhpbXVtIGNhcCBwZXIgcHVyY2hhc2VyIG9uIHB1YmxpYyBzYWxlIH4gJDIwLDAwMCBpbiBHRFBSCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBQVVJDSEFTRVJfTUFYX1RPS0VOX0NBUCA9IDEwMDAwMCAqIE1JTl9UT0tFTl9VTklUOwoKICAgIC8vIENyb3dkc2FsZSByYXRlIEdEUFIgLyBFVEgKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IElOSVRJQUxfUkFURSA9IDc2MDA7IC8vIDc2MDAgR0RQUiBmb3IgMSBldGhlcgoKICAgIC8vIEluaXRpYWwgZGlzdHJpYnV0aW9uIGFtb3VudHMKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IFRPVEFMX1NVUFBMWV9DQVAgPSAyMDAwMDAwMDAgKiBNSU5fVE9LRU5fVU5JVDsKICAgIC8vIDYwJSBvZiB0aGUgdG90YWwgc3VwcGx5IGNhcAogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgU0FMRV9DQVAgPSAxMjAwMDAwMDAgKiBNSU5fVE9LRU5fVU5JVDsKICAgIC8vIDEwJSB0b2tlbnMgZm9yIHRoZSBleHBlcnRzCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBFWFBFUlRTX1BPT0xfVE9LRU5TID0gMjAwMDAwMDAgKiBNSU5fVE9LRU5fVU5JVDsKICAgIC8vIDEwJSB0b2tlbnMgZm9yIG1hcmtldGluZyBleHBlbnNlcwogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgTUFSS0VUSU5HX1BPT0xfVE9LRU5TID0gMjAwMDAwMDAgKiBNSU5fVE9LRU5fVU5JVDsKICAgIC8vIDklIGZvdW5kZXJzJyBkaXN0cmlidXRpb24KICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IFRFQU1fUE9PTF9UT0tFTlMgPSAxODAwMDAwMCAqIE1JTl9UT0tFTl9VTklUOwogICAgLy8gMSUgZm9yIGxlZ2FsIGFkdmlzb3JzCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBMRUdBTF9FWFBFTlNFU19UT0tFTlMgPSAyMDAwMDAwICogTUlOX1RPS0VOX1VOSVQ7CiAgICAvLyAxMCUgdG9rZW5zIGZvciB0aGUgcmVzZXJ2ZQogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgUkVTRVJWRV9QT09MX1RPS0VOUyA9IDIwMDAwMDAwICogTUlOX1RPS0VOX1VOSVQ7CgogICAgLy8gQ29udHJhY3Qgd2FsbGV0IGFkZHJlc3NlcyBmb3IgaW5pdGlhbCBhbGxvY2F0aW9uCiAgICBhZGRyZXNzIHB1YmxpYyBjb25zdGFudCBFWFBFUlRTX1BPT0xfQUREUiA9IDB4Mjg5YkIwMmRlYUY0NzNjNkFhNWVkYzQ4ODZBNzFEODVjMThGMzI4QjsKICAgIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IE1BUktFVElOR19QT09MX0FERFIgPSAweDdCRkQ4MkM5NzhFRERjZTk0ZmUxMmVCRjM2NGM2OTQzYzdjQzJmMjc7CiAgICBhZGRyZXNzIHB1YmxpYyBjb25zdGFudCBURUFNX1BPT0xfQUREUiA9IDB4QjRBZmJGNUYzOTg5NWFkZjIxMzE5NDE5OGMwYmEzMTZmODAxQjI0ZDsKICAgIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IExFR0FMX0VYUEVOU0VTX0FERFIgPSAweGY3MjkzMUIwOGY4RWYzZDg4MTFhRDY4MmNFMjRBNTE0MTA1ZjcxM2M7CiAgICBhZGRyZXNzIHB1YmxpYyBjb25zdGFudCBTQUxFX0ZVTkRTX0FERFIgPSAweGI4RTgxYTg3YzZEOTZlZDVmNDI0RjBBMzNGMTNiMDQ2QzFmMjRhMjQ7CiAgICBhZGRyZXNzIHB1YmxpYyBjb25zdGFudCBSRVNFUlZFX1BPT0xfQUREUiA9IDB4MDEwYUFBMTBCZkI5MTMxODRDNWIyRTA0NjE0M2MyZWM4QTAzNzQxMzsKfQoKCi8qKgogKiBAdGl0bGUgT3duYWJsZQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuCiAqLwpjb250cmFjdCBPd25hYmxlIHsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogICAgLyoqCiAgICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgICAqIGFjY291bnQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgICAqLwogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgIH0KCn0KCgoKCi8qKgogKiBAdGl0bGUgU2FmZU1hdGgKICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCmxpYnJhcnkgU2FmZU1hdGggewoKICAgIC8qKgogICAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAgICovCiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgaWYgKGEgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgICAgdWludDI1NiBjID0gYSAqIGI7CiAgICAgICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEludGVnZXIgZGl2aXNpb24gb2YgdHdvIG51bWJlcnMsIHRydW5jYXRpbmcgdGhlIHF1b3RpZW50LgogICAgKi8KICAgIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgICAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgICAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAgICovCiAgICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgYXNzZXJ0KGIgPD0gYSk7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEFkZHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAgICovCiAgICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSk7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9Cn0KCgoKLyoqCiAqIEB0aXRsZSBQYXVzYWJsZQogKiBAZGV2IEJhc2UgY29udHJhY3Qgd2hpY2ggYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uCiAqLwpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKICAgIGV2ZW50IFBhdXNlKCk7CiAgICBldmVudCBVbnBhdXNlKCk7CgogICAgYm9vbCBwdWJsaWMgcGF1c2VkID0gZmFsc2U7CgoKICAgIC8qKgogICAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBub3QgcGF1c2VkLgogICAgICovCiAgICBtb2RpZmllciB3aGVuTm90UGF1c2VkKCkgewogICAgICAgIHJlcXVpcmUoIXBhdXNlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgcGF1c2VkLgogICAgICovCiAgICBtb2RpZmllciB3aGVuUGF1c2VkKCkgewogICAgICAgIHJlcXVpcmUocGF1c2VkKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHBhdXNlLCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlCiAgICAgKi8KICAgIGZ1bmN0aW9uIHBhdXNlKCkgb25seU93bmVyIHdoZW5Ob3RQYXVzZWQgcHVibGljIHsKICAgICAgICBwYXVzZWQgPSB0cnVlOwogICAgICAgIFBhdXNlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gdW5wYXVzZSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgICAqLwogICAgZnVuY3Rpb24gdW5wYXVzZSgpIG9ubHlPd25lciB3aGVuUGF1c2VkIHB1YmxpYyB7CiAgICAgICAgcGF1c2VkID0gZmFsc2U7CiAgICAgICAgVW5wYXVzZSgpOwogICAgfQp9CgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMoYm9vbCk7CiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKCgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zKGJvb2wpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zKGJvb2wpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCgoKY29udHJhY3QgRGV0YWlsZWRFUkMyMCBpcyBFUkMyMCB7CiAgICBzdHJpbmcgcHVibGljIG5hbWU7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsKICAgIHVpbnQ4IHB1YmxpYyBkZWNpbWFsczsKCiAgICBmdW5jdGlvbiBEZXRhaWxlZEVSQzIwKHN0cmluZyBfbmFtZSwgc3RyaW5nIF9zeW1ib2wsIHVpbnQ4IF9kZWNpbWFscykgcHVibGljIHsKICAgICAgICBuYW1lID0gX25hbWU7CiAgICAgICAgc3ltYm9sID0gX3N5bWJvbDsKICAgICAgICBkZWNpbWFscyA9IF9kZWNpbWFsczsKICAgIH0KfQoKCgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgICB1aW50MjU2IHRvdGFsU3VwcGx5XzsKCiAgICAvKioKICAgICogQGRldiB0b3RhbCBudW1iZXIgb2YgdG9rZW5zIGluIGV4aXN0ZW5jZQogICAgKi8KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHRvdGFsU3VwcGx5XzsKICAgIH0KCiAgICAvKioKICAgICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoKICAgICAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICAgKi8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KCn0KCgoKLyoqCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbgogKgogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogICAgbWFwcGluZyhhZGRyZXNzID0+IG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSkgaW50ZXJuYWwgYWxsb3dlZDsKCgogICAgLyoqCiAgICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1tfZnJvbV0pOwogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKCiAgICAgICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAgICoKICAgICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgICAqIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZSB0cmFuc2FjdGlvbiBvcmRlcmluZy4gT25lIHBvc3NpYmxlIHNvbHV0aW9uIHRvIG1pdGlnYXRlIHRoaXMKICAgICAqIHJhY2UgY29uZGl0aW9uIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUgYWZ0ZXJ3YXJkczoKICAgICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgICAqLwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgSW5jcmVhc2UgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgICAqCiAgICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF9hZGRlZFZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGluY3JlYXNlIHRoZSBhbGxvd2FuY2UgYnkuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBEZWNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAgICoKICAgICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGRlY3JlbWVudAogICAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX3N1YnRyYWN0ZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBkZWNyZWFzZSB0aGUgYWxsb3dhbmNlIGJ5LgogICAgICovCiAgICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgICAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgICAgICB9CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCn0KCgoKLyoqCiAqIEB0aXRsZSBNaW50YWJsZSB0b2tlbgogKiBAZGV2IFNpbXBsZSBFUkMyMCBUb2tlbiBleGFtcGxlLCB3aXRoIG1pbnRhYmxlIHRva2VuIGNyZWF0aW9uCiAqIEBkZXYgSXNzdWU6ICogaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXBwZWxpbi1zb2xpZGl0eS9pc3N1ZXMvMTIwCiAqIEJhc2VkIG9uIGNvZGUgYnkgVG9rZW5NYXJrZXROZXQ6IGh0dHBzOi8vZ2l0aHViLmNvbS9Ub2tlbk1hcmtldE5ldC9pY28vYmxvYi9tYXN0ZXIvY29udHJhY3RzL01pbnRhYmxlVG9rZW4uc29sCiAqLwpjb250cmFjdCBNaW50YWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIE93bmFibGUgewogICAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKICAgIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwoKICAgIGJvb2wgcHVibGljIG1pbnRpbmdGaW5pc2hlZCA9IGZhbHNlOwoKCiAgICBtb2RpZmllciBjYW5NaW50KCkgewogICAgICAgIHJlcXVpcmUoIW1pbnRpbmdGaW5pc2hlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gbWludCB0b2tlbnMKICAgICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIG1pbnRlZCB0b2tlbnMuCiAgICAgKiBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAgICogQHJldHVybiBBIGJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgICAqLwogICAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgdG90YWxTdXBwbHlfID0gdG90YWxTdXBwbHlfLmFkZChfYW1vdW50KTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICAgICAgTWludChfdG8sIF9hbW91bnQpOwogICAgICAgIFRyYW5zZmVyKGFkZHJlc3MoMCksIF90bywgX2Ftb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHN0b3AgbWludGluZyBuZXcgdG9rZW5zLgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgICAgICBNaW50RmluaXNoZWQoKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQoKCgovKioKICogQHRpdGxlIENhcHBlZCB0b2tlbgogKiBAZGV2IE1pbnRhYmxlIHRva2VuIHdpdGggYSB0b2tlbiBjYXAuCiAqLwpjb250cmFjdCBDYXBwZWRUb2tlbiBpcyBNaW50YWJsZVRva2VuIHsKCiAgICB1aW50MjU2IHB1YmxpYyBjYXA7CgogICAgZnVuY3Rpb24gQ2FwcGVkVG9rZW4odWludDI1NiBfY2FwKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX2NhcCA+IDApOwogICAgICAgIGNhcCA9IF9jYXA7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIG1pbnQgdG9rZW5zCiAgICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCByZWNlaXZlIHRoZSBtaW50ZWQgdG9rZW5zLgogICAgICogQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gbWludC4KICAgICAqIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICAgKi8KICAgIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgb25seU93bmVyIGNhbk1pbnQgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIHJlcXVpcmUodG90YWxTdXBwbHlfLmFkZChfYW1vdW50KSA8PSBjYXApOwoKICAgICAgICByZXR1cm4gc3VwZXIubWludChfdG8sIF9hbW91bnQpOwogICAgfQoKfQoKCi8qKgogKiBAdGl0bGUgQnVybmFibGUgVG9rZW4KICogQGRldiBUb2tlbiB0aGF0IGNhbiBiZSBpcnJldmVyc2libHkgYnVybmVkIChkZXN0cm95ZWQpLgogKi8KY29udHJhY3QgQnVybmFibGVUb2tlbiBpcyBCYXNpY1Rva2VuIHsKCiAgICBldmVudCBCdXJuKGFkZHJlc3MgaW5kZXhlZCBidXJuZXIsIHVpbnQyNTYgdmFsdWUpOwoKICAgIC8qKgogICAgICogQGRldiBCdXJucyBhIHNwZWNpZmljIGFtb3VudCBvZiB0b2tlbnMuCiAgICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgYnVybmVkLgogICAgICovCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKICAgICAgICAvLyBubyBuZWVkIHRvIHJlcXVpcmUgdmFsdWUgPD0gdG90YWxTdXBwbHksIHNpbmNlIHRoYXQgd291bGQgaW1wbHkgdGhlCiAgICAgICAgLy8gc2VuZGVyJ3MgYmFsYW5jZSBpcyBncmVhdGVyIHRoYW4gdGhlIHRvdGFsU3VwcGx5LCB3aGljaCAqc2hvdWxkKiBiZSBhbiBhc3NlcnRpb24gZmFpbHVyZQoKICAgICAgICBhZGRyZXNzIGJ1cm5lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgYmFsYW5jZXNbYnVybmVyXSA9IGJhbGFuY2VzW2J1cm5lcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgdG90YWxTdXBwbHlfID0gdG90YWxTdXBwbHlfLnN1YihfdmFsdWUpOwogICAgICAgIEJ1cm4oYnVybmVyLCBfdmFsdWUpOwogICAgfQp9CgoKCgovKioKICogQHRpdGxlIEdkcHJDYXNoCiAqIEBkZXYgR0RQUiBDYXNoIC0gdGhlIHRva2VuIHVzZWQgaW4gdGhlIGdkcHIuY2FzaCBuZXR3b3JrLgogKgogKiBBbGwgdG9rZW5zIGFyZSBwcmVtaW50ZWQgYW5kIGRpc3RyaWJ1dGVkIGF0IGRlcGxveSB0aW1lLgogKiBUcmFuc2ZlcnMgYXJlIGRpc2FibGVkIHVudGlsIHRoZSBjcm93ZHNhbGUgaXMgb3Zlci4gCiAqIEFsbCB1bnNvbGQgdG9rZW5zIGFyZSBidXJuZWQuCiAqLwpjb250cmFjdCBHZHByQ2FzaCBpcyBEZXRhaWxlZEVSQzIwLCBDYXBwZWRUb2tlbiwgR2RwckNvbmZpZyB7CgogICAgYm9vbCBwcml2YXRlIHRyYW5zZmVyc0VuYWJsZWQgPSBmYWxzZTsKICAgIGFkZHJlc3MgcHVibGljIGNyb3dkc2FsZSA9IGFkZHJlc3MoMCk7CgogICAgLyoqCiAgICAgKiBAZGV2IFRyaWdnZXJlZCBvbiB0b2tlbiBidXJuCiAgICAgKi8KICAgIGV2ZW50IEJ1cm4oYWRkcmVzcyBpbmRleGVkIGJ1cm5lciwgdWludDI1NiB2YWx1ZSk7CgogICAgLyoqCiAgICAgKiBAZGV2IFRyYW5zZmVycyBhcmUgcmVzdHJpY3RlZCB0byB0aGUgY3Jvd2RzYWxlIGFuZCBvd25lciBvbmx5CiAgICAgKiAgICAgIHVudGlsIHRoZSBjcm93ZHNhbGUgaXMgb3Zlci4KICAgICAqLwogICAgbW9kaWZpZXIgY2FuVHJhbnNmZXIoKSB7CiAgICAgICAgcmVxdWlyZSh0cmFuc2ZlcnNFbmFibGVkIHx8IG1zZy5zZW5kZXIgPT0gb3duZXIgfHwgbXNnLnNlbmRlciA9PSBjcm93ZHNhbGUpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IFJlc3RyaWVjdGVkIHRvIHRoZSBjcm93ZHNhbGUgb25seQogICAgICovCiAgICBtb2RpZmllciBvbmx5Q3Jvd2RzYWxlKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjcm93ZHNhbGUpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IENvbnN0cnVjdG9yIHRoYXQgc2V0cyBuYW1lLCBzeW1ib2wsIGRlY2ltYWxzIGFzIHdlbGwgYXMgYSBtYXhpbXVtIHN1cHBseSBjYXAuCiAgICAgKi8KICAgIGZ1bmN0aW9uIEdkcHJDYXNoKCkgcHVibGljCiAgICBEZXRhaWxlZEVSQzIwKFRPS0VOX05BTUUsIFRPS0VOX1NZTUJPTCwgVE9LRU5fREVDSU1BTFMpCiAgICBDYXBwZWRUb2tlbihUT1RBTF9TVVBQTFlfQ0FQKSB7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IFNldHMgdGhlIGNyb3dkc2FsZS4gQ2FuIGJlIGludm9rZWQgb25seSBvbmNlIGFuZCBieSB0aGUgb3duZXIKICAgICAqIEBwYXJhbSBfY3Jvd2RzYWxlQWRkciBhZGRyZXNzIFRoZSBhZGRyZXNzIG9mIHRoZSBjcm93ZHNhbGUgY29udHJhY3QKICAgICAqLwogICAgZnVuY3Rpb24gc2V0Q3Jvd2RzYWxlKGFkZHJlc3MgX2Nyb3dkc2FsZUFkZHIpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShjcm93ZHNhbGUgPT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfY3Jvd2RzYWxlQWRkciAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKCF0cmFuc2ZlcnNFbmFibGVkKTsKICAgICAgICBjcm93ZHNhbGUgPSBfY3Jvd2RzYWxlQWRkcjsKCiAgICAgICAgLy8gR2VuZXJhdGUgc2FsZSB0b2tlbnMKICAgICAgICBtaW50KGNyb3dkc2FsZSwgU0FMRV9DQVApOwoKICAgICAgICAvLyBEaXN0cmlidXRlIG5vbi1zYWxlIHRva2VucyB0byBwb29scwogICAgICAgIG1pbnQoRVhQRVJUU19QT09MX0FERFIsIEVYUEVSVFNfUE9PTF9UT0tFTlMpOwogICAgICAgIG1pbnQoTUFSS0VUSU5HX1BPT0xfQUREUiwgTUFSS0VUSU5HX1BPT0xfVE9LRU5TKTsKICAgICAgICBtaW50KFRFQU1fUE9PTF9BRERSLCBURUFNX1BPT0xfVE9LRU5TKTsKICAgICAgICBtaW50KExFR0FMX0VYUEVOU0VTX0FERFIsIExFR0FMX0VYUEVOU0VTX1RPS0VOUyk7CiAgICAgICAgbWludChSRVNFUlZFX1BPT0xfQUREUiwgUkVTRVJWRV9QT09MX1RPS0VOUyk7CgogICAgICAgIGZpbmlzaE1pbnRpbmcoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQ2hlY2tzIG1vZGlmaWVyIGFuZCB0cmFuc2ZlcnMKICAgICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkKICAgICAgICBwdWJsaWMgY2FuVHJhbnNmZXIgcmV0dXJucyhib29sKQogICAgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IENoZWNrcyBtb2RpZmllciBhbmQgdHJhbnNmZXJzCiAgICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKQogICAgICAgIHB1YmxpYyBjYW5UcmFuc2ZlciByZXR1cm5zKGJvb2wpCiAgICB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBFbmFibGVzIHRva2VuIHRyYW5zZmVycy4KICAgICAqIENhbGxlZCB3aGVuIHRoZSB0b2tlbiBzYWxlIGlzIHN1Y2Nlc3NmdWxseSBmaW5hbGl6ZWQKICAgICAqLwogICAgZnVuY3Rpb24gZW5hYmxlVHJhbnNmZXJzKCkgcHVibGljIG9ubHlDcm93ZHNhbGUgewogICAgICAgIHRyYW5zZmVyc0VuYWJsZWQgPSB0cnVlOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEJ1cm5zIGEgc3BlY2lmaWMgbnVtYmVyIG9mIHRva2Vucy4KICAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IFRoZSBudW1iZXIgb2YgdG9rZW5zIHRvIGJlIGJ1cm5lZC4KICAgICovCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgb25seUNyb3dkc2FsZSB7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoKICAgICAgICBhZGRyZXNzIGJ1cm5lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgYmFsYW5jZXNbYnVybmVyXSA9IGJhbGFuY2VzW2J1cm5lcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgdG90YWxTdXBwbHlfID0gdG90YWxTdXBwbHlfLnN1YihfdmFsdWUpOwogICAgICAgIEJ1cm4oYnVybmVyLCBfdmFsdWUpOwogICAgfQp9CgoKCgoKLyoqCiAqIEB0aXRsZSBHRFBSIENyb3dkc2FsZQogKiBAZGV2IEdEUFIgQ2FzaCBjcm93ZHNhbGUgY29udHJhY3QuIAogKi8KY29udHJhY3QgR2RwckNyb3dkc2FsZSBpcyBQYXVzYWJsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICAgICAgLy8gVG9rZW4gY29udHJhY3QKICAgICAgICBHZHByQ2FzaCBwdWJsaWMgdG9rZW47CgogICAgLy8gU3RhcnQgYW5kIGVuZCB0aW1lc3RhbXBzIHdoZXJlIGludmVzdG1lbnRzIGFyZSBhbGxvd2VkIChib3RoIGluY2x1c2l2ZSkKICAgIHVpbnQyNTYgcHVibGljIHN0YXJ0VGltZTsKICAgIHVpbnQyNTYgcHVibGljIGVuZFRpbWU7CgogICAgLy8gQWRkcmVzcyB3aGVyZSBmdW5kcyBhcmUgY29sbGVjdGVkCiAgICBhZGRyZXNzIHB1YmxpYyB3YWxsZXQ7CgogICAgLy8gSG93IG1hbnkgdG9rZW4gdW5pdHMgYSBidXllciBnZXRzIHBlciB3ZWkKICAgIHVpbnQyNTYgcHVibGljIHJhdGU7CgogICAgLy8gQW1vdW50IG9mIHJhaXNlZCBtb25leSBpbiB3ZWkKICAgIHVpbnQyNTYgcHVibGljIHdlaVJhaXNlZCA9IDA7CgogICAgLy8gVG90YWwgYW1vdW50IG9mIHRva2VucyBwdXJjaGFzZWQKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsUHVyY2hhc2VkID0gMDsKCiAgICAvLyBQdXJjaGFzZXMKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgdG9rZW5zUHVyY2hhc2VkOwoKICAgIC8vIFdoZXRoZXIgdGhlIGNyb3dkc2FsZSBpcyBmaW5hbGl6ZWQKICAgIGJvb2wgcHVibGljIGlzRmluYWxpemVkID0gZmFsc2U7CgogICAgLy8gQ3Jvd2RzYWxlIGV2ZW50cwogICAgLyoqCiAgICAgKiBFdmVudCBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAgICogQHBhcmFtIHB1cmNoYXNlciB3aG8gcGFpZCBmb3IgdGhlIHRva2VucwogICAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IHdobyBnb3QgdGhlIHRva2VucwogICAgICogQHBhcmFtIHZhbHVlIHdlaXMgcGFpZCBmb3IgcHVyY2hhc2UKICAgICAqIEBwYXJhbSBhbW91bnQgYW1vdW50IG9mIHRva2VucyBwdXJjaGFzZWQKICAgICAqLwogICAgZXZlbnQgVG9rZW5QdXJjaGFzZSgKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwKICAgICAgICB1aW50MjU2IHZhbHVlLAogICAgICAgIHVpbnQyNTYgYW1vdW50KTsKCiAgICAvKioKICAgICogRXZlbnQgZm9yIHRva2VuIHB1cmNoYXNlIGxvZ2dpbmcKICAgICogQHBhcmFtIHB1cmNoYXNlciB3aG8gcGFpZCBmb3IgdGhlIHRva2VucwogICAgKiBAcGFyYW0gYW1vdW50IGFtb3VudCBvZiB0b2tlbnMgcHVyY2hhc2VkCiAgICAqLwogICAgZXZlbnQgVG9rZW5QcmVzYWxlKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsCiAgICAgICAgdWludDI1NiBhbW91bnQpOwoKICAgIC8qKgogICAgICogRXZlbnQgaW52b2tlZCB3aGVuIHRoZSByYXRlIGlzIGNoYW5nZWQKICAgICAqIEBwYXJhbSBuZXdSYXRlIFRoZSBuZXcgcmF0ZSBHRFBSIC8gRVRICiAgICAgKi8KICAgIGV2ZW50IFJhdGVDaGFuZ2UodWludDI1NiBuZXdSYXRlKTsKCiAgICAvKioKICAgICAqIFRyaWdnZXJlZCB3aGVuIGV0aGVyIGlzIHdpdGhkcmF3biB0byB0aGUgc2FsZSB3YWxsZXQKICAgICAqIEBwYXJhbSBhbW91bnQgSG93IG1hbnkgZnVuZHMgdG8gd2l0aGRyYXcgaW4gd2VpCiAgICAgKi8KICAgIGV2ZW50IEZ1bmRXaXRoZHJhd2FsKHVpbnQyNTYgYW1vdW50KTsKCiAgICAvKioKICAgICAqIEV2ZW50IGZvciBjcm93ZHNhbGUgZmluYWxpemF0aW9uCiAgICAgKi8KICAgIGV2ZW50IEZpbmFsaXplZCgpOwoKICAgIC8qKgogICAgICogQGRldiBHZHByQ3Jvd2RzYWxlIGNvbnRyYWN0IGNvbnN0cnVjdG9yCiAgICAgKiBAcGFyYW0gX3N0YXJ0VGltZSB1aW50MjU2IFVuaXggdGltZXN0YW1wIHJlcHJlc2VudGluZyB0aGUgY3Jvd2RzYWxlIHN0YXJ0IHRpbWUKICAgICAqIEBwYXJhbSBfZW5kVGltZSB1aW50MjU2IFVuaXggdGltZXN0YW1wIHJlcHJlc2VudGluZyB0aGUgY3Jvd2RzYWxlIGVuZCB0aW1lCiAgICAgKiBAcGFyYW0gX3Rva2VuQWRkcmVzcyBhZGRyZXNzIEFkZHJlc3Mgb2YgdGhlIEdEUFIgQ2FzaCB0b2tlbiBjb250cmFjdAogICAgICovCiAgICBmdW5jdGlvbiBHZHByQ3Jvd2RzYWxlKAogICAgICAgIHVpbnQyNTYgX3N0YXJ0VGltZSwKICAgICAgICB1aW50MjU2IF9lbmRUaW1lLAogICAgICAgIGFkZHJlc3MgX3Rva2VuQWRkcmVzcwogICAgKSBwdWJsaWMKICAgIHsKICAgICAgICByZXF1aXJlKF9lbmRUaW1lID4gX3N0YXJ0VGltZSk7CiAgICAgICAgcmVxdWlyZShfdG9rZW5BZGRyZXNzICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICBzdGFydFRpbWUgPSBfc3RhcnRUaW1lOwogICAgICAgIGVuZFRpbWUgPSBfZW5kVGltZTsKICAgICAgICB0b2tlbiA9IEdkcHJDYXNoKF90b2tlbkFkZHJlc3MpOwogICAgICAgIHJhdGUgPSB0b2tlbi5JTklUSUFMX1JBVEUoKTsKICAgICAgICB3YWxsZXQgPSB0b2tlbi5TQUxFX0ZVTkRTX0FERFIoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgRmFsbGJhY2sgZnVuY3Rpb24gaXMgdXNlZCB0byBidXkgdG9rZW5zLgogICAgICogSXQncyB0aGUgb25seSBlbnRyeSBwb2ludCBzaW5jZSBgYnV5VG9rZW5zYCBpcyBpbnRlcm5hbC4KICAgICAqIFdoZW4gcGF1c2VkIGZ1bmRzIGFyZSBub3QgYWNjZXB0ZWQuCiAgICAgKi8KICAgIGZ1bmN0aW9uICgpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHBheWFibGUgewogICAgICAgIGJ1eVRva2Vucyhtc2cuc2VuZGVyLCBtc2cudmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBTZXRzIGEgbmV3IHN0YXJ0IGRhdGUgYXMgbG9uZyBhcyB0b2tlbiBzYWxlIGhhc24ndCBzdGFydGVkIHlldAogICAgICogQHBhcmFtIF9zdGFydFRpbWUgdWludDI1NiBVbml4IHRpbWVzdGFtcCBvZiB0aGUgbmV3IHN0YXJ0IHRpbWUKICAgICAqLwogICAgZnVuY3Rpb24gc2V0U3RhcnRUaW1lKHVpbnQyNTYgX3N0YXJ0VGltZSkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShub3cgPCBzdGFydFRpbWUpOwogICAgICAgIHJlcXVpcmUoX3N0YXJ0VGltZSA+IG5vdyk7CiAgICAgICAgcmVxdWlyZShfc3RhcnRUaW1lIDwgZW5kVGltZSk7CgogICAgICAgIHN0YXJ0VGltZSA9IF9zdGFydFRpbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IFNldHMgYSBuZXcgZW5kIGRhdGUgYXMgbG9uZyBhcyBlbmQgZGF0ZSBoYXNuJ3QgYmVlbiByZWFjaGVkCiAgICAgKiBAcGFyYW0gX2VuZFRpbWUgdWludDJ0NTYgVW5peCB0aW1lc3RhbXAgb2YgdGhlIG5ldyBlbmQgdGltZQogICAgICovCiAgICBmdW5jdGlvbiBzZXRFbmRUaW1lKHVpbnQyNTYgX2VuZFRpbWUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUobm93IDwgZW5kVGltZSk7CiAgICAgICAgcmVxdWlyZShfZW5kVGltZSA+IG5vdyk7CiAgICAgICAgcmVxdWlyZShfZW5kVGltZSA+IHN0YXJ0VGltZSk7CgogICAgICAgIGVuZFRpbWUgPSBfZW5kVGltZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgVXBkYXRlcyB0aGUgR0RQUi9FVEggY29udmVyc2lvbiByYXRlCiAgICAgKiBAcGFyYW0gX3JhdGUgdWludDI1NiBVcGRhdGVkIGNvbnZlcnNpb24gcmF0ZQogICAgICovCiAgICBmdW5jdGlvbiBzZXRSYXRlKHVpbnQyNTYgX3JhdGUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoX3JhdGUgPiAwKTsKICAgICAgICByYXRlID0gX3JhdGU7CiAgICAgICAgUmF0ZUNoYW5nZShyYXRlKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgTXVzdCBiZSBjYWxsZWQgYWZ0ZXIgY3Jvd2RzYWxlIGVuZHMsIHRvIGRvIHNvbWUgZXh0cmEgZmluYWxpemF0aW9uCiAgICAgKiB3b3JrLiBDYWxscyB0aGUgY29udHJhY3QncyBmaW5hbGl6YXRpb24gZnVuY3Rpb24uCiAgICAgKi8KICAgIGZ1bmN0aW9uIGZpbmFsaXplKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShub3cgPiBlbmRUaW1lKTsKICAgICAgICByZXF1aXJlKCFpc0ZpbmFsaXplZCk7CgogICAgICAgIGZpbmFsaXphdGlvbigpOwogICAgICAgIEZpbmFsaXplZCgpOwoKICAgICAgICBpc0ZpbmFsaXplZCA9IHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFueW9uZSBjYW4gY2hlY2sgaWYgdGhlIGNyb3dkc2FsZSBpcyBvdmVyCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGhhcyBlbmRlZHMKICAgICAqLwogICAgZnVuY3Rpb24gaGFzRW5kZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXR1cm4gbm93ID4gZW5kVGltZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgVHJhbnNmZXJzIGV0aGVyIHRvIHRoZSBzYWxlIHdhbGxldAogICAgICogQHBhcmFtIF9hbW91bnQgdWludDI1NiBUaGUgYW1vdW50IHRvIHdpdGhkcmF3LiAKICAgICAqIElmIDAgc3VwcGxpZWQgdHJhbnNmZXJzIHRoZSBlbnRpcmUgYmFsYW5jZS4KICAgICAqLwogICAgZnVuY3Rpb24gd2l0aGRyYXcodWludDI1NiBfYW1vdW50KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKHRoaXMuYmFsYW5jZSA+IDApOwogICAgICAgIHJlcXVpcmUoX2Ftb3VudCA8PSB0aGlzLmJhbGFuY2UpOwogICAgICAgIHVpbnQyNTYgYmFsYW5jZVRvU2VuZCA9IF9hbW91bnQ7CiAgICAgICAgaWYgKGJhbGFuY2VUb1NlbmQgPT0gMCkgewogICAgICAgICAgICBiYWxhbmNlVG9TZW5kID0gdGhpcy5iYWxhbmNlOwogICAgICAgIH0KICAgICAgICB3YWxsZXQudHJhbnNmZXIoYmFsYW5jZVRvU2VuZCk7CiAgICAgICAgRnVuZFdpdGhkcmF3YWwoYmFsYW5jZVRvU2VuZCk7CiAgICB9CgogICAgLyoqCiAgICAgKiAgQGRldiBSZWdpc3RlcnMgYSBwcmVzYWxlIG9yZGVyCiAgICAgKiAgQHBhcmFtIF9wYXJ0aWNpcGFudCBhZGRyZXNzIFRoZSBhZGRyZXNzIG9mIHRoZSB0b2tlbiBwdXJjaGFzZXIKICAgICAqICBAcGFyYW0gX3Rva2VuQW1vdW50IHVpbjI1NiBUaGUgYW1vdW50IG9mIEdEUFIgQ2FzaCAoaW4gd2VpKSBwdXJjaGFzZWQKICAgICAqLwogICAgZnVuY3Rpb24gYWRkUHJlc2FsZU9yZGVyKGFkZHJlc3MgX3BhcnRpY2lwYW50LCB1aW50MjU2IF90b2tlbkFtb3VudCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG5vdyA8IHN0YXJ0VGltZSk7CgogICAgICAgIC8vIFVwZGF0ZSBzdGF0ZQogICAgICAgIHRva2Vuc1B1cmNoYXNlZFtfcGFydGljaXBhbnRdID0gdG9rZW5zUHVyY2hhc2VkW19wYXJ0aWNpcGFudF0uYWRkKF90b2tlbkFtb3VudCk7CiAgICAgICAgdG90YWxQdXJjaGFzZWQgPSB0b3RhbFB1cmNoYXNlZC5hZGQoX3Rva2VuQW1vdW50KTsKCiAgICAgICAgdG9rZW4udHJhbnNmZXIoX3BhcnRpY2lwYW50LCBfdG9rZW5BbW91bnQpOwoKICAgICAgICBUb2tlblByZXNhbGUoCiAgICAgICAgICAgIF9wYXJ0aWNpcGFudCwKICAgICAgICAgICAgX3Rva2VuQW1vdW50CiAgICAgICAgKTsKICAgIH0KCiAgICAvKioKICAgICAqICBAZGV2IFRva2VuIHB1cmNoYXNlIGxvZ2ljLiBVc2VkIGludGVybmFsbHkuCiAgICAgKiAgQHBhcmFtIF9wYXJ0aWNpcGFudCBhZGRyZXNzIFRoZSBhZGRyZXNzIG9mIHRoZSB0b2tlbiBwdXJjaGFzZXIKICAgICAqICBAcGFyYW0gX3dlaUFtb3VudCB1aW4yNTYgVGhlIGFtb3VudCBvZiBldGhlciBpbiB3ZWkgc2VudCB0byB0aGUgY29udHJhY3QKICAgICAqLwogICAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgX3BhcnRpY2lwYW50LCB1aW50MjU2IF93ZWlBbW91bnQpIGludGVybmFsIHsKICAgICAgICByZXF1aXJlKF9wYXJ0aWNpcGFudCAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKG5vdyA+PSBzdGFydFRpbWUpOwogICAgICAgIHJlcXVpcmUobm93IDwgZW5kVGltZSk7CiAgICAgICAgcmVxdWlyZSghaXNGaW5hbGl6ZWQpOwogICAgICAgIHJlcXVpcmUoX3dlaUFtb3VudCAhPSAwKTsKCiAgICAgICAgLy8gQ2FsY3VsYXRlIHRoZSB0b2tlbiBhbW91bnQgdG8gYmUgYWxsb2NhdGVkCiAgICAgICAgdWludDI1NiB0b2tlbnMgPSBfd2VpQW1vdW50Lm11bChyYXRlKTsKCiAgICAgICAgLy8gVXBkYXRlIHN0YXRlCiAgICAgICAgdG9rZW5zUHVyY2hhc2VkW19wYXJ0aWNpcGFudF0gPSB0b2tlbnNQdXJjaGFzZWRbX3BhcnRpY2lwYW50XS5hZGQodG9rZW5zKTsKICAgICAgICB0b3RhbFB1cmNoYXNlZCA9IHRvdGFsUHVyY2hhc2VkLmFkZCh0b2tlbnMpOwogICAgICAgIC8vIHVwZGF0ZSBzdGF0ZQogICAgICAgIHdlaVJhaXNlZCA9IHdlaVJhaXNlZC5hZGQoX3dlaUFtb3VudCk7CgogICAgICAgIHJlcXVpcmUodG90YWxQdXJjaGFzZWQgPD0gdG9rZW4uU0FMRV9DQVAoKSk7CiAgICAgICAgcmVxdWlyZSh0b2tlbnNQdXJjaGFzZWRbX3BhcnRpY2lwYW50XSA+PSB0b2tlbi5QVVJDSEFTRVJfTUlOX1RPS0VOX0NBUCgpKTsKCiAgICAgICAgaWYgKG5vdyA8IHN0YXJ0VGltZSArIDg2NDAwKSB7CiAgICAgICAgICAgIC8vIGlmIHN0aWxsIGR1cmluZyB0aGUgZmlyc3QgZGF5IG9mIHRva2VuIHNhbGUsIGFwcGx5IGRpZmZlcmVudCBtYXggY2FwCiAgICAgICAgICAgIHJlcXVpcmUodG9rZW5zUHVyY2hhc2VkW19wYXJ0aWNpcGFudF0gPD0gdG9rZW4uUFVSQ0hBU0VSX01BWF9UT0tFTl9DQVBfREFZMSgpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXF1aXJlKHRva2Vuc1B1cmNoYXNlZFtfcGFydGljaXBhbnRdIDw9IHRva2VuLlBVUkNIQVNFUl9NQVhfVE9LRU5fQ0FQKCkpOwogICAgICAgIH0KCiAgICAgICAgdG9rZW4udHJhbnNmZXIoX3BhcnRpY2lwYW50LCB0b2tlbnMpOwoKICAgICAgICBUb2tlblB1cmNoYXNlKAogICAgICAgICAgICBtc2cuc2VuZGVyLAogICAgICAgICAgICBfcGFydGljaXBhbnQsCiAgICAgICAgICAgIF93ZWlBbW91bnQsCiAgICAgICAgICAgIHRva2VucwogICAgICAgICk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFkZGl0aW9uYWwgZmluYWxpemF0aW9uIGxvZ2ljLiAKICAgICAqIEVuYWJsZXMgdG9rZW4gdHJhbnNmZXJzIGFuZCBidXJucyBhbGwgdW5zb2xkIHRva2Vucy4KICAgICAqLwogICAgZnVuY3Rpb24gZmluYWxpemF0aW9uKCkgaW50ZXJuYWwgewogICAgICAgIHdpdGhkcmF3KDApOwogICAgICAgIGJ1cm5VbnNvbGQoKTsKICAgICAgICB0b2tlbi5lbmFibGVUcmFuc2ZlcnMoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQnVybiBhbGwgcmVtYWluaW5nICh1bnNvbGQpIHRva2Vucy4KICAgICAqIFRoaXMgc2hvdWxkIGJlIGNhbGxlZCBhdXRvbWF0aWNhbGx5IGFmdGVyIHNhbGUgZmluYWxpemF0aW9uCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJ1cm5VbnNvbGQoKSBpbnRlcm5hbCB7CiAgICAgICAgLy8gQWxsIHRva2VucyBoZWxkIGJ5IHRoaXMgY29udHJhY3QgZ2V0IGJ1cm5lZAogICAgICAgIHRva2VuLmJ1cm4odG9rZW4uYmFsYW5jZU9mKHRoaXMpKTsKICAgIH0KfQ=='.
	

]
