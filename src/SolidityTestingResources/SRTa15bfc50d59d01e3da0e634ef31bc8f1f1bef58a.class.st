Class {
	#name : #SRTa15bfc50d59d01e3da0e634ef31bc8f1f1bef58a,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTa15bfc50d59d01e3da0e634ef31bc8f1f1bef58a >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTY7CgppbnRlcmZhY2UgR2FtZSB7CiAgICBldmVudCBHYW1lU3RhcnRlZCh1aW50IGJldEFtb3VudCk7CiAgICBldmVudCBOZXdQbGF5ZXJBZGRlZCh1aW50IG51bVBsYXllcnMsIHVpbnQgcHJpemVBbW91bnQpOwogICAgZXZlbnQgR2FtZUZpbmlzaGVkKGFkZHJlc3Mgd2lubmVyKTsKCiAgICBmdW5jdGlvbiAoKSBwdWJsaWMgcGF5YWJsZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vUGFydGljaXBhdGUgaW4gZ2FtZS4gUHJveHkgZm9yIHBsYXkgbWV0aG9kCiAgICBmdW5jdGlvbiBnZXRQcml6ZUFtb3VudCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KTsgICAgIC8vR2V0IHBvdGVudGlhbCBvciBhY3R1YWwgcHJpemUgYW1vdW50CiAgICBmdW5jdGlvbiBnZXROdW1XaW5uZXJzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludCwgdWludCk7CiAgICBmdW5jdGlvbiBnZXRQbGF5ZXJzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMoYWRkcmVzc1tdKTsgICAgICAgICAgIC8vR2V0IGZ1bGwgbGlzdCBvZiBwbGF5ZXJzCiAgICBmdW5jdGlvbiBnZXRXaW5uZXJzKCkgcHVibGljIHZpZXcgcmV0dXJucyhhZGRyZXNzW10gbWVtb3J5IHBsYXllcnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnRbXSBtZW1vcnkgcHJpemVzKTsgIC8vR2V0IHdpbm5lcnMuIEFjY2Vzc2FibGUgb25seSB3aGVuIGZpbmlzaGVkCiAgICBmdW5jdGlvbiBnZXRTdGF0KCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludCwgdWludCwgdWludCk7ICAgICAgIC8vU2hvcnQgc3RhdCBvbiBnYW1lCgogICAgZnVuY3Rpb24gY2FsY2F1bHRlUHJpemVzKCkgcHVibGljIHJldHVybnMgKHVpbnRbXSk7CgogICAgZnVuY3Rpb24gZmluaXNoKCkgcHVibGljOyAgICAgICAgICAgICAgICAgICAgICAgIC8vQ2xvc2VzIGdhbWUgY2hvb3NlcyB3aW5uZXIKCiAgICBmdW5jdGlvbiByZXZva2UoKSBwdWJsaWM7ICAgICAgICAgICAgICAgICAgICAgICAgLy9TdG9wIGdhbWUgYW5kIHJldHVybiBtb25leSB0byBwbGF5ZXJzCiAgICAvLyBmdW5jdGlvbiBtb3ZlKGFkZHJlc3MgbmV4dEdhbWUpOyAgICAgICAgICAgICAgLy9Nb3ZlIHBsYXllcnMgYmV0cyB0byBhbm90aGVyIGdhbWUKfQoKbGlicmFyeSBUaWNrZXRMaWIgewogICAgc3RydWN0IFRpY2tldCB7CiAgICAgICAgdWludDQwIGJsb2NrX251bWJlcjsKICAgICAgICB1aW50MzIgYmxvY2tfdGltZTsKICAgICAgICB1aW50IHByaXplOwogICAgfQp9Cgpjb250cmFjdCBVbmlsb3RQcml6ZUNhbGN1bGF0b3IgewogICAgLy9DYWxjdWxhdGlvbiBjb25zdGFudHMKICAgIHVpbnQ2NCAgY29uc3RhbnQgYWNjdXJhY3kgICAgICAgICAgICAgICAgICAgPSAxMDAwMDAwMDAwMDAwMDAwMDAwOwogICAgdWludDggIGNvbnN0YW50IE1BWF9YX0ZPUl9ZICAgICAgICAgICAgICAgID0gMTk1OyAgLy8gMTkuNQoKICAgIHVpbnQ4ICBjb25zdGFudCBtaW5Qcml6ZUNvZWZpY2VudCAgICAgICAgICA9IDE7CiAgICB1aW50OCAgY29uc3RhbnQgcGVyY2VudE9mV2lubmVycyAgICAgICAgICAgPSA1OyAgICAvLyA1JQogICAgdWludDggIGNvbnN0YW50IHBlcmNlbnRPZkZpeGVkUHJpemVXaW5uZXJzID0gMjA7ICAgLy8gMjAlCiAgICB1aW50OCAgY29uc3RhbnQgZ2FtZUNvbW1pc2lvbiAgICAgICAgICAgICAgPSAyMDsgICAvLyAyMCUKICAgIHVpbnQ4ICBjb25zdGFudCBib251c0dhbWVDb21taXNpb24gICAgICAgICA9IDU7ICAgIC8vIDUlCiAgICB1aW50OCAgY29uc3RhbnQgdG9rZW5Ib2xlckdhbWVDb21taXNpb24gICAgPSA1OyAgICAvLyA1JQogICAgLy8gRW5kIENhbGN1bGF0aW9uIGNvbnN0YW50cwoKICAgIGV2ZW50IERlYnVnKHVpbnQpOwoKICAgIGZ1bmN0aW9uIGdldFByaXplQW1vdW50KHVpbnQgdG90YWxBbW91bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgcHVyZQogICAgICAgIHJldHVybnMgKHVpbnQgcmVzdWx0KQogICAgewogICAgICAgIHVpbnQgdG90YWxDb21taXNpb24gPSBnYW1lQ29tbWlzaW9uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArIGJvbnVzR2FtZUNvbW1pc2lvbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyB0b2tlbkhvbGVyR2FtZUNvbW1pc2lvbjsKCiAgICAgICAgLy9DYWxjdWxhdGlvbiBpcyBvZGQgb24gcHVycG9zZS4gIEl0IGlzIGEgc29ydCBvZiBjZWlsaW5nIGVmZmVjdCB0bwogICAgICAgIC8vIG1heGltaXplIGFtb3VudCBvZiBwcml6ZQogICAgICAgIHJlc3VsdCA9ICggdG90YWxBbW91bnQgLSAoICggdG90YWxBbW91bnQgKiB0b3RhbENvbW1pc2lvbikgLyAxMDApICk7CgogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0TnVtV2lubmVycyh1aW50IG51bVBsYXllcnMpCiAgICAgICAgcHVibGljCiAgICAgICAgcHVyZQogICAgICAgIHJldHVybnMgKHVpbnQxNiBudW1XaW5uZXJzLCB1aW50MTYgbnVtRml4ZWRBbW91bnRXaW5uZXJzKQogICAgewogICAgICAgIC8vIENhbGN1bGF0aW9uIGlzIG9kZCBvbiBwdXJwb3NlLiBJdCBpcyBhIHNvcnQgb2YgY2VpbGluZyBlZmZlY3QgdG8KICAgICAgICAvLyBtYXhpbWl6ZSBudW1iZXIgb2Ygd2lubmVycwogICAgICAgIHVpbnQxNiB0b3RhTnVtbFdpbm5lcnMgPSB1aW50MTYoIG51bVBsYXllcnMgLSAoIChudW1QbGF5ZXJzICogKCAxMDAgLSBwZXJjZW50T2ZXaW5uZXJzICkgKSAvIDEwMCApICk7CgoKICAgICAgICBudW1GaXhlZEFtb3VudFdpbm5lcnMgPSB1aW50MTYoICh0b3RhTnVtbFdpbm5lcnMgKiBwZXJjZW50T2ZGaXhlZFByaXplV2lubmVycykgLyAxMDAgKTsKICAgICAgICBudW1XaW5uZXJzID0gdWludDE2KCB0b3RhTnVtbFdpbm5lcnMgLSBudW1GaXhlZEFtb3VudFdpbm5lcnMgKTsKCiAgICAgICAgcmV0dXJuIChudW1XaW5uZXJzLCBudW1GaXhlZEFtb3VudFdpbm5lcnMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNhbGNhdWx0ZVByaXplcyh1aW50IGJldCwgdWludCBudW1QbGF5ZXJzKQogICAgICAgIHB1YmxpYwogICAgICAgIHB1cmUKICAgICAgICByZXR1cm5zICh1aW50WzUwXSBtZW1vcnkgcHJpemVzKQogICAgewogICAgICAgIHZhciAobnVtV2lubmVycywgbnVtRml4ZWRBbW91bnRXaW5uZXJzKSA9IGdldE51bVdpbm5lcnMobnVtUGxheWVycyk7CgogICAgICAgIHJlcXVpcmUoIHVpbnQobnVtV2lubmVycyArIG51bUZpeGVkQW1vdW50V2lubmVycykgPD0gcHJpemVzLmxlbmd0aCApOwoKICAgICAgICB1aW50W10gbWVtb3J5IHkgPSBuZXcgdWludFtdKChudW1XaW5uZXJzIC0gMSkpOwogICAgICAgIHVpbnQgeiA9IDA7IC8vIFN1bSBvZiBhbGwgWSB2YWx1ZXMKCiAgICAgICAgaWYgKCBudW1XaW5uZXJzID09IDEgKSB7CiAgICAgICAgICAgIHByaXplc1swXSA9IGdldFByaXplQW1vdW50KHVpbnQoYmV0Km51bVBsYXllcnMpKTsKCiAgICAgICAgICAgIHJldHVybiBwcml6ZXM7CiAgICAgICAgfSBlbHNlIGlmICggbnVtV2lubmVycyA8IDEgKSB7CiAgICAgICAgICAgIHJldHVybiBwcml6ZXM7CiAgICAgICAgfQoKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCB5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHlbaV0gPSBmb3JtdWxhKCAoY2FsY3VsYXRlU3RlcChudW1XaW5uZXJzKSAqIGkpICk7CiAgICAgICAgICAgIHogKz0geVtpXTsKICAgICAgICB9CgogICAgICAgIGJvb2wgc3RvcCA9IGZhbHNlOwoKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMTA7IGkrKykgewogICAgICAgICAgICB1aW50WzVdIG1lbW9yeSBjaHVuayA9IGRpc3RyaWJ1dGVQcml6ZUNhbGN1bGF0aW9uKAogICAgICAgICAgICAgICAgaSwgeiwgeSwgbnVtUGxheWVycywgYmV0KTsKCiAgICAgICAgICAgIGZvciAoIHVpbnQgaiA9IDA7IGogPCBjaHVuay5sZW5ndGg7IGorKyApIHsKICAgICAgICAgICAgICAgIGlmICggKCAoaSAqIGNodW5rLmxlbmd0aCkgKyBqICkgPj0gKCBudW1XaW5uZXJzICsgbnVtRml4ZWRBbW91bnRXaW5uZXJzICkgKSB7CiAgICAgICAgICAgICAgICAgICAgc3RvcCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcHJpemVzWyAoaSAqIGNodW5rLmxlbmd0aCkgKyBqIF0gPSBjaHVua1tqXTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCBzdG9wICkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBwcml6ZXM7CiAgICB9CgogICAgZnVuY3Rpb24gZGlzdHJpYnV0ZVByaXplQ2FsY3VsYXRpb24gKHVpbnQgY2h1bmtOdW1iZXIsIHVpbnQgeiwgdWludFtdIG1lbW9yeSB5LCB1aW50IHRvdGFsTnVtUGxheWVycywgdWludCBiZXQpCiAgICAgICAgcHJpdmF0ZQogICAgICAgIHB1cmUKICAgICAgICByZXR1cm5zICh1aW50WzVdIG1lbW9yeSBwcml6ZXMpCiAgICB7CiAgICAgICAgdmFyKG51bVdpbm5lcnMsIG51bUZpeGVkQW1vdW50V2lubmVycykgPSBnZXROdW1XaW5uZXJzKHRvdGFsTnVtUGxheWVycyk7CiAgICAgICAgdWludCBwcml6ZUFtb3VudEZvckRlbGlnYXRpb24gPSBnZXRQcml6ZUFtb3VudCggKHRvdGFsTnVtUGxheWVycyAqIGJldCkgKTsKICAgICAgICBwcml6ZUFtb3VudEZvckRlbGlnYXRpb24gLT0gdWludCggKCBiZXQgKiBtaW5Qcml6ZUNvZWZpY2VudCApICogdWludCggbnVtV2lubmVycyArIG51bUZpeGVkQW1vdW50V2lubmVycyApICk7CgogICAgICAgIHVpbnQgbWFpbldpbm5lckJhc2VBbW91bnQgPSAoIChwcml6ZUFtb3VudEZvckRlbGlnYXRpb24gKiBhY2N1cmFjeSkgLyAoICggKCB6ICogYWNjdXJhY3kgKSAvICggMiAqIHlbMF0gKSApICsgKCAxICogYWNjdXJhY3kgKSApICk7CiAgICAgICAgdWludCB1bmRlbGlnYXRlZEFtb3VudCAgICA9IHByaXplQW1vdW50Rm9yRGVsaWdhdGlvbjsKCiAgICAgICAgdWludCBzdGFydFBvaW50ID0gY2h1bmtOdW1iZXIgKiBwcml6ZXMubGVuZ3RoOwoKICAgICAgICBmb3IgKCB1aW50IGkgPSAwOyBpIDwgcHJpemVzLmxlbmd0aDsgaSsrICkgewogICAgICAgICAgICBpZiAoIGkgPj0gdWludChudW1XaW5uZXJzICsgbnVtRml4ZWRBbW91bnRXaW5uZXJzKSApIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHByaXplc1sgaSBdID0gKGJldCAqIG1pblByaXplQ29lZmljZW50KTsKICAgICAgICAgICAgdWludCBleHRyYVByaXplID0gMDsKCiAgICAgICAgICAgIGlmICggaSA9PSAoIG51bVdpbm5lcnMgLSAxICkgKSB7CiAgICAgICAgICAgICAgICBleHRyYVByaXplID0gdW5kZWxpZ2F0ZWRBbW91bnQ7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoIGkgPT0gMCAmJiBjaHVua051bWJlciA9PSAwICkgewogICAgICAgICAgICAgICAgZXh0cmFQcml6ZSA9IG1haW5XaW5uZXJCYXNlQW1vdW50OwogICAgICAgICAgICB9IGVsc2UgaWYgKCAoIHN0YXJ0UG9pbnQgKyBpICkgPCBudW1XaW5uZXJzICkgewogICAgICAgICAgICAgICAgZXh0cmFQcml6ZSA9ICggKCB5WyAoIHN0YXJ0UG9pbnQgKyBpICkgLSAxIF0gKiAocHJpemVBbW91bnRGb3JEZWxpZ2F0aW9uIC0gbWFpbldpbm5lckJhc2VBbW91bnQpICkgLyB6KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJpemVzWyBpIF0gKz0gZXh0cmFQcml6ZTsKICAgICAgICAgICAgdW5kZWxpZ2F0ZWRBbW91bnQgLT0gZXh0cmFQcml6ZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBwcml6ZXM7CiAgICB9CgogICAgZnVuY3Rpb24gZm9ybXVsYSh1aW50IHgpCiAgICAgICAgcHVibGljCiAgICAgICAgcHVyZQogICAgICAgIHJldHVybnMgKHVpbnQgeSkKICAgIHsKICAgICAgICB5ID0gKCAoMSAqIGFjY3VyYWN5KioyKSAvICh4ICsgKDUqYWNjdXJhY3kvMTApKSkgLSAoKDUgKiBhY2N1cmFjeSkgLyAxMDApOwoKICAgICAgICByZXR1cm4geTsKICAgIH0KCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVTdGVwKHVpbnQgbnVtV2lubmVycykKICAgICAgICBwdWJsaWMKICAgICAgICBwdXJlCiAgICAgICAgcmV0dXJucyh1aW50IHN0ZXApCiAgICB7CiAgICAgICAgc3RlcCA9ICggTUFYX1hfRk9SX1kgKiBhY2N1cmFjeSAvIDEwICkgLyBudW1XaW5uZXJzOwoKICAgICAgICByZXR1cm4gc3RlcDsKICAgIH0KfQoKY29udHJhY3QgQmFzZVVuaWxvdEdhbWUgaXMgR2FtZSB7CiAgICBlbnVtIFN0YXRlIHsKICAgICAgICBBQ1RJVkUsCiAgICAgICAgRU5ERUQsCiAgICAgICAgUkVWT0tJTkcsCiAgICAgICAgUkVWT0tFRCwKICAgICAgICBNT1ZFRAogICAgfQoKICAgIGV2ZW50IFByaXplUmVzdWx0Q2FsY3VsYXRlZCh1aW50IHNpemUsIHVpbnRbXSBwcml6ZXMpOwoKICAgIFN0YXRlIHN0YXRlOwogICAgYWRkcmVzcyBhZG1pbmlzdHJhdG9yOwogICAgdWludCBiZXQ7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBUaWNrZXRMaWIuVGlja2V0KSBpbnRlcm5hbCB0aWNrZXRzOwogICAgYWRkcmVzc1tdIGludGVybmFsIHRpY2tldEluZGV4OwoKICAgIFVuaWxvdFByaXplQ2FsY3VsYXRvciBjYWxjdWxhdG9yOwoKICAgIC8vTW9kaWZpZXJzCiAgICBtb2RpZmllciBvbmx5QWRtaW5pc3RyYXRvcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYWRtaW5pc3RyYXRvcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5UGxheWVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciAhPSBhZG1pbmlzdHJhdG9yKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIHZhbGlkQmV0KCkgewogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID09IGJldCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBhY3RpdmVHYW1lKCkgewogICAgICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuQUNUSVZFKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIGluYWN0aXZlR2FtZSgpIHsKICAgICAgICByZXF1aXJlKHN0YXRlICE9IFN0YXRlLkFDVElWRSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBmaW5pc2hlZEdhbWUoKSB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5FTkRFRCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvL1ByaXZhdGUgbWV0aG9kcwoKICAgIGZ1bmN0aW9uIGdldFN0YXRlKCkKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyhTdGF0ZSkKICAgIHsKICAgICAgICByZXR1cm4gc3RhdGU7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QmV0KCkKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyAodWludCkKICAgIHsKICAgICAgICByZXR1cm4gYmV0OwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFBsYXllcnMoKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyhhZGRyZXNzW10pCiAgICB7CiAgICAgICAgcmV0dXJuIHRpY2tldEluZGV4OwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFBsYXllckRldGFpbHMoYWRkcmVzcyBwbGF5ZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIGluYWN0aXZlR2FtZQogICAgICAgIHJldHVybnMgKHVpbnQsIHVpbnQsIHVpbnQpCiAgICB7CiAgICAgICAgVGlja2V0TGliLlRpY2tldCBtZW1vcnkgdGlja2V0ID0gdGlja2V0c1twbGF5ZXJdOwoKICAgICAgICByZXR1cm4gKHRpY2tldC5ibG9ja19udW1iZXIsIHRpY2tldC5ibG9ja190aW1lLCB0aWNrZXQucHJpemUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldE51bVdpbm5lcnMoKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCwgdWludCkKICAgIHsKICAgICAgICB2YXIobnVtV2lubmVycywgbnVtRml4ZWRBbW91bnRXaW5uZXJzKSA9IGNhbGN1bGF0b3IuZ2V0TnVtV2lubmVycyh0aWNrZXRJbmRleC5sZW5ndGgpOwoKICAgICAgICByZXR1cm4gKG51bVdpbm5lcnMsIG51bUZpeGVkQW1vdW50V2lubmVycyk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0UHJpemVBbW91bnQoKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCByZXN1bHQpCiAgICB7CiAgICAgICAgdWludCB0b3RhbEFtb3VudCA9IHRoaXMuYmFsYW5jZTsKCiAgICAgICAgaWYgKCBzdGF0ZSA9PSBTdGF0ZS5FTkRFRCApIHsKICAgICAgICAgICAgdG90YWxBbW91bnQgPSBiZXQgKiB0aWNrZXRJbmRleC5sZW5ndGg7CiAgICAgICAgfQoKICAgICAgICByZXN1bHQgPSBjYWxjdWxhdG9yLmdldFByaXplQW1vdW50KHRvdGFsQW1vdW50KTsKCiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRTdGF0KCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKCB1aW50LCB1aW50LCB1aW50ICkKICAgIHsKICAgICAgICB2YXIgKG51bVdpbm5lcnMsIG51bUZpeGVkQW1vdW50V2lubmVycykgPSBnZXROdW1XaW5uZXJzKCk7CiAgICAgICAgcmV0dXJuICh0aWNrZXRJbmRleC5sZW5ndGgsIGdldFByaXplQW1vdW50KCksIHVpbnQobnVtV2lubmVycyArIG51bUZpeGVkQW1vdW50V2lubmVycykpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNhbGNhdWx0ZVByaXplcygpCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyh1aW50W10gbWVtb3J5IHJlc3VsdCkKICAgIHsKICAgICAgICB2YXIobnVtV2lubmVycywgbnVtRml4ZWRBbW91bnRXaW5uZXJzKSA9IGdldE51bVdpbm5lcnMoKTsKICAgICAgICB1aW50MTYgdG90YWxOdW1XaW5uZXJzID0gdWludDE2KCBudW1XaW5uZXJzICsgbnVtRml4ZWRBbW91bnRXaW5uZXJzICk7CiAgICAgICAgcmVzdWx0ID0gbmV3IHVpbnRbXSggdG90YWxOdW1XaW5uZXJzICk7CgoKICAgICAgICB1aW50WzUwXSBtZW1vcnkgcHJpemVzID0gY2FsY3VsYXRvci5jYWxjYXVsdGVQcml6ZXMoCiAgICAgICAgYmV0LCB0aWNrZXRJbmRleC5sZW5ndGgpOwoKICAgICAgICBmb3IgKHVpbnQxNiBpID0gMDsgaSA8IHRvdGFsTnVtV2lubmVyczsgaSsrKSB7CiAgICAgICAgICAgIHJlc3VsdFtpXSA9IHByaXplc1tpXTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogICAgZnVuY3Rpb24gcmV2b2tlKCkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5QWRtaW5pc3RyYXRvcgogICAgICAgIGFjdGl2ZUdhbWUKICAgIHsKICAgICAgICBmb3IgKHVpbnQyNCBpID0gMDsgaSA8IHRpY2tldEluZGV4Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHRpY2tldEluZGV4W2ldLnRyYW5zZmVyKGJldCk7CiAgICAgICAgfQoKICAgICAgICBzdGF0ZSA9IFN0YXRlLlJFVk9LRUQ7CiAgICB9Cn0KCgpjb250cmFjdCBVbmlsb3RUYWlsRXRoZXIgaXMgQmFzZVVuaWxvdEdhbWUgewoKICAgIHVpbnQ2NCB3aW5uZXJJbmRleDsKCiAgICAvL1B1YmxpYyBtZXRob2RzCiAgICBmdW5jdGlvbiBVbmlsb3RUYWlsRXRoZXIodWludCBiZXRBbW91bnQsIGFkZHJlc3MgY2FsY3VsYXRvckNvbnRyYWN0QWRkcmVzcykKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICBzdGF0ZSA9IFN0YXRlLkFDVElWRTsKICAgICAgICBhZG1pbmlzdHJhdG9yID0gbXNnLnNlbmRlcjsKICAgICAgICBiZXQgPSBiZXRBbW91bnQ7CgogICAgICAgIGNhbGN1bGF0b3IgPSBVbmlsb3RQcml6ZUNhbGN1bGF0b3IoY2FsY3VsYXRvckNvbnRyYWN0QWRkcmVzcyk7CgogICAgICAgIEdhbWVTdGFydGVkKGJldEFtb3VudCk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0V2lubmVycygpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIGZpbmlzaGVkR2FtZQogICAgICAgIHJldHVybnMoYWRkcmVzc1tdIG1lbW9yeSBwbGF5ZXJzLCB1aW50W10gbWVtb3J5IHByaXplcykKICAgIHsKICAgICAgICB2YXIobnVtV2lubmVycywgbnVtRml4ZWRBbW91bnRXaW5uZXJzKSA9IGdldE51bVdpbm5lcnMoKTsKICAgICAgICB1aW50IHRvdGFsTnVtV2lubmVycyA9IG51bVdpbm5lcnMgKyBudW1GaXhlZEFtb3VudFdpbm5lcnM7CgogICAgICAgIHBsYXllcnMgPSBuZXcgYWRkcmVzc1tdKHRvdGFsTnVtV2lubmVycyk7CiAgICAgICAgcHJpemVzID0gbmV3IHVpbnRbXSh0b3RhbE51bVdpbm5lcnMpOwoKICAgICAgICB1aW50IGluZGV4OwoKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCB0b3RhbE51bVdpbm5lcnM7IGkrKykgewogICAgICAgICAgICBpZiAoIGkgPiB3aW5uZXJJbmRleCApIHsKICAgICAgICAgICAgICAgIGluZGV4ID0gKCAoIHBsYXllcnMubGVuZ3RoICkgLSAoIGkgLSB3aW5uZXJJbmRleCApICk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpbmRleCA9ICggd2lubmVySW5kZXggLSBpICk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHBsYXllcnNbaV0gPSB0aWNrZXRJbmRleFtpbmRleF07CiAgICAgICAgICAgIHByaXplc1tpXSA9IHRpY2tldHNbcGxheWVyc1tpXV0ucHJpemU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gKHBsYXllcnMsIHByaXplcyk7CiAgICB9CgogICAgZnVuY3Rpb24gKCkKICAgICAgICBwdWJsaWMKICAgICAgICBwYXlhYmxlCiAgICAgICAgdmFsaWRCZXQKICAgICAgICBvbmx5UGxheWVyCiAgICB7CiAgICAgICAgcmVxdWlyZSh0aWNrZXRzW21zZy5zZW5kZXJdLmJsb2NrX251bWJlciA9PSAwKTsKICAgICAgICByZXF1aXJlKHRpY2tldEluZGV4Lmxlbmd0aCA8PSAxMDAwKTsKCiAgICAgICAgdGlja2V0c1ttc2cuc2VuZGVyXS5ibG9ja19udW1iZXIgPSB1aW50NDAoYmxvY2subnVtYmVyKTsKICAgICAgICB0aWNrZXRzW21zZy5zZW5kZXJdLmJsb2NrX3RpbWUgICA9IHVpbnQzMihibG9jay50aW1lc3RhbXApOwoKICAgICAgICB0aWNrZXRJbmRleC5wdXNoKG1zZy5zZW5kZXIpOwoKICAgICAgICBOZXdQbGF5ZXJBZGRlZCh0aWNrZXRJbmRleC5sZW5ndGgsIGdldFByaXplQW1vdW50KCkpOwogICAgfQoKICAgIGZ1bmN0aW9uIGZpbmlzaCgpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IKICAgICAgICBhY3RpdmVHYW1lCiAgICB7CiAgICAgICAgdWludDY0IG1heF92b3RlczsKICAgICAgICB1aW50NjRbXSBtZW1vcnkgbnVtX3ZvdGVzID0gbmV3IHVpbnQ2NFtdKHRpY2tldEluZGV4Lmxlbmd0aCk7CgogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IHRpY2tldEluZGV4Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIFRpY2tldExpYi5UaWNrZXQgbWVtb3J5IHRpY2tldCA9IHRpY2tldHNbdGlja2V0SW5kZXhbaV1dOwogICAgICAgICAgICB1aW50NjQgdm90ZSA9IHVpbnQ2NCggKCAoIHRpY2tldC5ibG9ja19udW1iZXIgKiB0aWNrZXQuYmxvY2tfdGltZSApICsgdWludCggdGlja2V0SW5kZXhbaV0pICkgJSB0aWNrZXRJbmRleC5sZW5ndGggKTsKCiAgICAgICAgICAgIG51bV92b3Rlc1t2b3RlXSArPSAxOwoKICAgICAgICAgICAgaWYgKCBudW1fdm90ZXNbdm90ZV0gPiBtYXhfdm90ZXMgKSB7CiAgICAgICAgICAgICAgICBtYXhfdm90ZXMgPSBudW1fdm90ZXNbdm90ZV07CiAgICAgICAgICAgICAgICB3aW5uZXJJbmRleCA9IHZvdGU7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHVpbnRbXSBtZW1vcnkgcHJpemVzID0gY2FsY2F1bHRlUHJpemVzKCk7CgogICAgICAgIHVpbnQgbGFzdElkID0gd2lubmVySW5kZXg7CgogICAgICAgIGZvciAoIGkgPSAwOyBpIDwgcHJpemVzLmxlbmd0aDsgaSsrICkgewogICAgICAgICAgICB0aWNrZXRzW3RpY2tldEluZGV4W2xhc3RJZF1dLnByaXplID0gcHJpemVzW2ldOwogICAgICAgICAgICB0aWNrZXRJbmRleFtsYXN0SWRdLnRyYW5zZmVyKHByaXplc1tpXSk7CgogICAgICAgICAgICBpZiAoIGxhc3RJZCA8PSAwICkgewogICAgICAgICAgICAgICAgbGFzdElkID0gdGlja2V0SW5kZXgubGVuZ3RoOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsYXN0SWQgLT0gMTsKICAgICAgICB9CgogICAgICAgIGFkbWluaXN0cmF0b3IudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKCiAgICAgICAgc3RhdGUgPSBTdGF0ZS5FTkRFRDsKCiAgICAgICAgR2FtZUZpbmlzaGVkKHRpY2tldEluZGV4W3dpbm5lckluZGV4XSk7CiAgICB9Cn0='.
	

]
