Class {
	#name : #SRT42a501903afaa1086b5975773375c80e363f4063,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT42a501903afaa1086b5975773375c80e363f4063 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7Cgpjb250cmFjdCBSZWdpc3RyeUlDQVBJbnRlcmZhY2UgewogICAgZnVuY3Rpb24gcGFyc2UoYnl0ZXMzMiBfaWNhcCkgY29uc3RhbnQgcmV0dXJucyhhZGRyZXNzLCBieXRlczMyLCBib29sKTsKICAgIGZ1bmN0aW9uIGluc3RpdHV0aW9ucyhieXRlczMyIF9pbnN0aXR1dGlvbikgY29uc3RhbnQgcmV0dXJucyhhZGRyZXNzKTsKfQoKY29udHJhY3QgRVRva2VuMkludGVyZmFjZSB7CiAgICBmdW5jdGlvbiByZWdpc3RyeUlDQVAoKSBjb25zdGFudCByZXR1cm5zKFJlZ2lzdHJ5SUNBUEludGVyZmFjZSk7CiAgICBmdW5jdGlvbiBiYXNlVW5pdChieXRlczMyIF9zeW1ib2wpIGNvbnN0YW50IHJldHVybnModWludDgpOwogICAgZnVuY3Rpb24gZGVzY3JpcHRpb24oYnl0ZXMzMiBfc3ltYm9sKSBjb25zdGFudCByZXR1cm5zKHN0cmluZyk7CiAgICBmdW5jdGlvbiBvd25lcihieXRlczMyIF9zeW1ib2wpIGNvbnN0YW50IHJldHVybnMoYWRkcmVzcyk7CiAgICBmdW5jdGlvbiBpc093bmVyKGFkZHJlc3MgX293bmVyLCBieXRlczMyIF9zeW1ib2wpIGNvbnN0YW50IHJldHVybnMoYm9vbCk7CiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseShieXRlczMyIF9zeW1ib2wpIGNvbnN0YW50IHJldHVybnModWludCk7CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfaG9sZGVyLCBieXRlczMyIF9zeW1ib2wpIGNvbnN0YW50IHJldHVybnModWludCk7CiAgICBmdW5jdGlvbiBpc0xvY2tlZChieXRlczMyIF9zeW1ib2wpIGNvbnN0YW50IHJldHVybnMoYm9vbCk7CiAgICBmdW5jdGlvbiBpc3N1ZUFzc2V0KGJ5dGVzMzIgX3N5bWJvbCwgdWludCBfdmFsdWUsIHN0cmluZyBfbmFtZSwgc3RyaW5nIF9kZXNjcmlwdGlvbiwgdWludDggX2Jhc2VVbml0LCBib29sIF9pc1JlaXNzdWFibGUpIHJldHVybnMoYm9vbCk7CiAgICBmdW5jdGlvbiByZWlzc3VlQXNzZXQoYnl0ZXMzMiBfc3ltYm9sLCB1aW50IF92YWx1ZSkgcmV0dXJucyhib29sKTsKICAgIGZ1bmN0aW9uIHJldm9rZUFzc2V0KGJ5dGVzMzIgX3N5bWJvbCwgdWludCBfdmFsdWUpIHJldHVybnMoYm9vbCk7CiAgICBmdW5jdGlvbiBzZXRQcm94eShhZGRyZXNzIF9hZGRyZXNzLCBieXRlczMyIF9zeW1ib2wpIHJldHVybnMoYm9vbCk7CiAgICBmdW5jdGlvbiBsb2NrQXNzZXQoYnl0ZXMzMiBfc3ltYm9sKSByZXR1cm5zKGJvb2wpOwogICAgZnVuY3Rpb24gcHJveHlUcmFuc2ZlckZyb21Ub0lDQVBXaXRoUmVmZXJlbmNlKGFkZHJlc3MgX2Zyb20sIGJ5dGVzMzIgX2ljYXAsIHVpbnQgX3ZhbHVlLCBzdHJpbmcgX3JlZmVyZW5jZSwgYWRkcmVzcyBfc2VuZGVyKSByZXR1cm5zKGJvb2wpOwogICAgZnVuY3Rpb24gcHJveHlBcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlLCBieXRlczMyIF9zeW1ib2wsIGFkZHJlc3MgX3NlbmRlcikgcmV0dXJucyhib29sKTsKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF9zcGVuZGVyLCBieXRlczMyIF9zeW1ib2wpIGNvbnN0YW50IHJldHVybnModWludCk7CiAgICBmdW5jdGlvbiBwcm94eVRyYW5zZmVyRnJvbVdpdGhSZWZlcmVuY2UoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBieXRlczMyIF9zeW1ib2wsIHN0cmluZyBfcmVmZXJlbmNlLCBhZGRyZXNzIF9zZW5kZXIpIHJldHVybnMoYm9vbCk7Cn0KCmNvbnRyYWN0IEFzc2V0SW50ZXJmYWNlIHsKICAgIGZ1bmN0aW9uIF9wZXJmb3JtVHJhbnNmZXJXaXRoUmVmZXJlbmNlKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSwgc3RyaW5nIF9yZWZlcmVuY2UsIGFkZHJlc3MgX3NlbmRlcikgcmV0dXJucyhib29sKTsKICAgIGZ1bmN0aW9uIF9wZXJmb3JtVHJhbnNmZXJUb0lDQVBXaXRoUmVmZXJlbmNlKGJ5dGVzMzIgX2ljYXAsIHVpbnQgX3ZhbHVlLCBzdHJpbmcgX3JlZmVyZW5jZSwgYWRkcmVzcyBfc2VuZGVyKSByZXR1cm5zKGJvb2wpOwogICAgZnVuY3Rpb24gX3BlcmZvcm1BcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlLCBhZGRyZXNzIF9zZW5kZXIpIHJldHVybnMoYm9vbCk7ICAgIAogICAgZnVuY3Rpb24gX3BlcmZvcm1UcmFuc2ZlckZyb21XaXRoUmVmZXJlbmNlKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSwgc3RyaW5nIF9yZWZlcmVuY2UsIGFkZHJlc3MgX3NlbmRlcikgcmV0dXJucyhib29sKTsKICAgIGZ1bmN0aW9uIF9wZXJmb3JtVHJhbnNmZXJGcm9tVG9JQ0FQV2l0aFJlZmVyZW5jZShhZGRyZXNzIF9mcm9tLCBieXRlczMyIF9pY2FwLCB1aW50IF92YWx1ZSwgc3RyaW5nIF9yZWZlcmVuY2UsIGFkZHJlc3MgX3NlbmRlcikgcmV0dXJucyhib29sKTsKICAgIGZ1bmN0aW9uIF9wZXJmb3JtR2VuZXJpYyhieXRlcywgYWRkcmVzcykgcGF5YWJsZSB7CiAgICAgICAgcmV2ZXJ0KCk7CiAgICB9Cn0KCmNvbnRyYWN0IEVSQzIwSW50ZXJmYWNlIHsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnModWludDI1NiBzdXBwbHkpOwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYgYmFsYW5jZSk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2IHJlbWFpbmluZyk7CgogICAgLy8gZnVuY3Rpb24gc3ltYm9sKCkgY29uc3RhbnQgcmV0dXJucyhzdHJpbmcpOwogICAgZnVuY3Rpb24gZGVjaW1hbHMoKSBjb25zdGFudCByZXR1cm5zKHVpbnQ4KTsKICAgIC8vIGZ1bmN0aW9uIG5hbWUoKSBjb25zdGFudCByZXR1cm5zKHN0cmluZyk7Cn0KCmNvbnRyYWN0IEFzc2V0UHJveHlJbnRlcmZhY2UgewogICAgZnVuY3Rpb24gX2ZvcndhcmRBcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlLCBhZGRyZXNzIF9zZW5kZXIpIHJldHVybnMoYm9vbCk7CiAgICBmdW5jdGlvbiBfZm9yd2FyZFRyYW5zZmVyRnJvbVdpdGhSZWZlcmVuY2UoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBzdHJpbmcgX3JlZmVyZW5jZSwgYWRkcmVzcyBfc2VuZGVyKSByZXR1cm5zKGJvb2wpOwogICAgZnVuY3Rpb24gX2ZvcndhcmRUcmFuc2ZlckZyb21Ub0lDQVBXaXRoUmVmZXJlbmNlKGFkZHJlc3MgX2Zyb20sIGJ5dGVzMzIgX2ljYXAsIHVpbnQgX3ZhbHVlLCBzdHJpbmcgX3JlZmVyZW5jZSwgYWRkcmVzcyBfc2VuZGVyKSByZXR1cm5zKGJvb2wpOwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zKHVpbnQpOwp9Cgpjb250cmFjdCBCeXRlczMyIHsKICAgIGZ1bmN0aW9uIF9ieXRlczMyKHN0cmluZyBfaW5wdXQpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMoYnl0ZXMzMiByZXN1bHQpIHsKICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgIHJlc3VsdCA6PSBtbG9hZChhZGQoX2lucHV0LCAzMikpCiAgICAgICAgfQogICAgfQp9Cgpjb250cmFjdCBSZXR1cm5EYXRhIHsKICAgIGZ1bmN0aW9uIF9yZXR1cm5SZXR1cm5EYXRhKGJvb2wgX3N1Y2Nlc3MpIGludGVybmFsIHsKICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgIGxldCByZXR1cm5kYXRhc3RhcnQgOj0gbXNpemUoKQogICAgICAgICAgICBtc3RvcmUoMHg0MCwgYWRkKHJldHVybmRhdGFzdGFydCwgcmV0dXJuZGF0YXNpemUpKQogICAgICAgICAgICByZXR1cm5kYXRhY29weShyZXR1cm5kYXRhc3RhcnQsIDAsIHJldHVybmRhdGFzaXplKQogICAgICAgICAgICBzd2l0Y2ggX3N1Y2Nlc3MgY2FzZSAwIHsgcmV2ZXJ0KHJldHVybmRhdGFzdGFydCwgcmV0dXJuZGF0YXNpemUpIH0gZGVmYXVsdCB7IHJldHVybihyZXR1cm5kYXRhc3RhcnQsIHJldHVybmRhdGFzaXplKSB9CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIF9hc3NlbWJseUNhbGwoYWRkcmVzcyBfZGVzdGluYXRpb24sIHVpbnQgX3ZhbHVlLCBieXRlcyBfZGF0YSkgaW50ZXJuYWwgcmV0dXJucyhib29sIHN1Y2Nlc3MpIHsKICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgIHN1Y2Nlc3MgOj0gY2FsbChkaXYobXVsKGdhcywgNjMpLCA2NCksIF9kZXN0aW5hdGlvbiwgX3ZhbHVlLCBhZGQoX2RhdGEsIDMyKSwgbWxvYWQoX2RhdGEpLCAwLCAwKQogICAgICAgIH0KICAgIH0KfQoKLyoqCiAqIEB0aXRsZSBFVG9rZW4yIEFzc2V0IFByb3h5LgogKgogKiBQcm94eSBpbXBsZW1lbnRzIEVSQzIwIGludGVyZmFjZSBhbmQgYWN0cyBhcyBhIGdhdGV3YXkgdG8gYSBzaW5nbGUgRVRva2VuMiBhc3NldC4KICogUHJveHkgYWRkcyBldG9rZW4yU3ltYm9sIGFuZCBjYWxsZXIoc2VuZGVyKSB3aGVuIGZvcndhcmRpbmcgcmVxdWVzdHMgdG8gRVRva2VuMi4KICogRXZlcnkgcmVxdWVzdCB0aGF0IGlzIG1hZGUgYnkgY2FsbGVyIGZpcnN0IHNlbnQgdG8gdGhlIHNwZWNpZmljIGFzc2V0IGltcGxlbWVudGF0aW9uCiAqIGNvbnRyYWN0LCB3aGljaCB0aGVuIGNhbGxzIGJhY2sgdG8gYmUgZm9yd2FyZGVkIG9udG8gRVRva2VuMi4KICoKICogQ2FsbHMgZmxvdzogQ2FsbGVyIC0+CiAqICAgICAgICAgICAgIFByb3h5LmZ1bmMoLi4uKSAtPgogKiAgICAgICAgICAgICBBc3NldC5fcGVyZm9ybUZ1bmMoLi4uLCBDYWxsZXIuYWRkcmVzcykgLT4KICogICAgICAgICAgICAgUHJveHkuX2ZvcndhcmRGdW5jKC4uLiwgQ2FsbGVyLmFkZHJlc3MpIC0+CiAqICAgICAgICAgICAgIFBsYXRmb3JtLnByb3h5RnVuYyguLi4sIHN5bWJvbCwgQ2FsbGVyLmFkZHJlc3MpCiAqCiAqIEdlbmVyaWMgY2FsbCBmbG93OiBDYWxsZXIgLT4KICogICAgICAgICAgICAgUHJveHkudW5rbm93bkZ1bmMoLi4uKSAtPgogKiAgICAgICAgICAgICBBc3NldC5fcGVyZm9ybUdlbmVyaWMoLi4uLCBDYWxsZXIuYWRkcmVzcykgLT4KICogICAgICAgICAgICAgQXNzZXQudW5rbm93bkZ1bmMoLi4uKQogKgogKiBBc3NldCBpbXBsZW1lbnRhdGlvbiBjb250cmFjdCBpcyBtdXRhYmxlLCBidXQgZWFjaCB1c2VyIGhhdmUgYW4gb3B0aW9uIHRvIHN0aWNrIHdpdGgKICogb2xkIGltcGxlbWVudGF0aW9uLCB0aHJvdWdoIGV4cGxpY2l0IGRlY2lzaW9uIG1hZGUgaW4gdGltZWx5IG1hbm5lciwgaWYgaGUgZG9lc24ndCBhZ3JlZQogKiB3aXRoIG5ldyBydWxlcy4KICogRWFjaCB1c2VyIGhhdmUgYSBwb3NzaWJpbGl0eSB0byB1cGdyYWRlIHRvIGxhdGVzdCBhc3NldCBjb250cmFjdCBpbXBsZW1lbnRhdGlvbiwgd2l0aG91dCB0aGUKICogcG9zc2liaWxpdHkgdG8gcm9sbGJhY2suCiAqCiAqIE5vdGU6IGFsbCB0aGUgbm9uIGNvbnN0YW50IGZ1bmN0aW9ucyByZXR1cm4gZmFsc2UgaW5zdGVhZCBvZiB0aHJvd2luZyBpbiBjYXNlIGlmIHN0YXRlIGNoYW5nZQogKiBkaWRuJ3QgaGFwcGVuIHlldC4KICovCmNvbnRyYWN0IENyeXB0eWtUb2tlbnMgaXMgRVJDMjBJbnRlcmZhY2UsIEFzc2V0UHJveHlJbnRlcmZhY2UsIEJ5dGVzMzIsIFJldHVybkRhdGEgewogICAgLy8gQXNzaWduZWQgRVRva2VuMiwgaW1tdXRhYmxlLgogICAgRVRva2VuMkludGVyZmFjZSBwdWJsaWMgZXRva2VuMjsKCiAgICAvLyBBc3NpZ25lZCBzeW1ib2wsIGltbXV0YWJsZS4KICAgIGJ5dGVzMzIgcHVibGljIGV0b2tlbjJTeW1ib2w7CgogICAgLy8gQXNzaWduZWQgbmFtZSwgaW1tdXRhYmxlLiBGb3IgVUkuCiAgICBzdHJpbmcgcHVibGljIG5hbWU7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsKCiAgICAvKioKICAgICAqIFNldHMgRVRva2VuMiBhZGRyZXNzLCBhc3NpZ25zIHN5bWJvbCBhbmQgbmFtZS4KICAgICAqCiAgICAgKiBDYW4gYmUgc2V0IG9ubHkgb25jZS4KICAgICAqCiAgICAgKiBAcGFyYW0gX2V0b2tlbjIgRVRva2VuMiBjb250cmFjdCBhZGRyZXNzLgogICAgICogQHBhcmFtIF9zeW1ib2wgYXNzaWduZWQgc3ltYm9sLgogICAgICogQHBhcmFtIF9uYW1lIGFzc2lnbmVkIG5hbWUuCiAgICAgKgogICAgICogQHJldHVybiBzdWNjZXNzLgogICAgICovCiAgICBmdW5jdGlvbiBpbml0KEVUb2tlbjJJbnRlcmZhY2UgX2V0b2tlbjIsIHN0cmluZyBfc3ltYm9sLCBzdHJpbmcgX25hbWUpIHJldHVybnMoYm9vbCkgewogICAgICAgIGlmIChhZGRyZXNzKGV0b2tlbjIpICE9IDB4MCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGV0b2tlbjIgPSBfZXRva2VuMjsKICAgICAgICBldG9rZW4yU3ltYm9sID0gX2J5dGVzMzIoX3N5bWJvbCk7CiAgICAgICAgbmFtZSA9IF9uYW1lOwogICAgICAgIHN5bWJvbCA9IF9zeW1ib2w7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBPbmx5IEVUb2tlbjIgaXMgYWxsb3dlZCB0byBjYWxsLgogICAgICovCiAgICBtb2RpZmllciBvbmx5RVRva2VuMigpIHsKICAgICAgICBpZiAobXNnLnNlbmRlciA9PSBhZGRyZXNzKGV0b2tlbjIpKSB7CiAgICAgICAgICAgIF87CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogT25seSBjdXJyZW50IGFzc2V0IG93bmVyIGlzIGFsbG93ZWQgdG8gY2FsbC4KICAgICAqLwogICAgbW9kaWZpZXIgb25seUFzc2V0T3duZXIoKSB7CiAgICAgICAgaWYgKGV0b2tlbjIuaXNPd25lcihtc2cuc2VuZGVyLCBldG9rZW4yU3ltYm9sKSkgewogICAgICAgICAgICBfOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgYXNzZXQgaW1wbGVtZW50YXRpb24gY29udHJhY3QgZm9yIGN1cnJlbnQgY2FsbGVyLgogICAgICoKICAgICAqIEByZXR1cm4gYXNzZXQgaW1wbGVtZW50YXRpb24gY29udHJhY3QuCiAgICAgKi8KICAgIGZ1bmN0aW9uIF9nZXRBc3NldCgpIGludGVybmFsIHJldHVybnMoQXNzZXRJbnRlcmZhY2UpIHsKICAgICAgICByZXR1cm4gQXNzZXRJbnRlcmZhY2UoZ2V0VmVyc2lvbkZvcihtc2cuc2VuZGVyKSk7CiAgICB9CgogICAgZnVuY3Rpb24gcmVjb3ZlclRva2Vucyh1aW50IF92YWx1ZSkgb25seUFzc2V0T3duZXIoKSByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXR1cm4gdGhpcy50cmFuc2ZlcldpdGhSZWZlcmVuY2UobXNnLnNlbmRlciwgX3ZhbHVlLCAnVG9rZW5zIHJlY292ZXJ5Jyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFzc2V0IHRvdGFsIHN1cHBseS4KICAgICAqCiAgICAgKiBAcmV0dXJuIGFzc2V0IHRvdGFsIHN1cHBseS4KICAgICAqLwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsKICAgICAgICByZXR1cm4gZXRva2VuMi50b3RhbFN1cHBseShldG9rZW4yU3ltYm9sKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgYXNzZXQgYmFsYW5jZSBmb3IgYSBwYXJ0aWN1bGFyIGhvbGRlci4KICAgICAqCiAgICAgKiBAcGFyYW0gX293bmVyIGhvbGRlciBhZGRyZXNzLgogICAgICoKICAgICAqIEByZXR1cm4gaG9sZGVyIGJhbGFuY2UuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyh1aW50KSB7CiAgICAgICAgcmV0dXJuIGV0b2tlbjIuYmFsYW5jZU9mKF9vd25lciwgZXRva2VuMlN5bWJvbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFzc2V0IGFsbG93YW5jZSBmcm9tIG9uZSBob2xkZXIgdG8gYW5vdGhlci4KICAgICAqCiAgICAgKiBAcGFyYW0gX2Zyb20gaG9sZGVyIHRoYXQgYWxsb3dlZCBzcGVuZGluZy4KICAgICAqIEBwYXJhbSBfc3BlbmRlciBob2xkZXIgdGhhdCBpcyBhbGxvd2VkIHRvIHNwZW5kLgogICAgICoKICAgICAqIEByZXR1cm4gaG9sZGVyIHRvIHNwZW5kZXIgYWxsb3dhbmNlLgogICAgICovCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyh1aW50KSB7CiAgICAgICAgcmV0dXJuIGV0b2tlbjIuYWxsb3dhbmNlKF9mcm9tLCBfc3BlbmRlciwgZXRva2VuMlN5bWJvbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFzc2V0IGRlY2ltYWxzLgogICAgICoKICAgICAqIEByZXR1cm4gYXNzZXQgZGVjaW1hbHMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGRlY2ltYWxzKCkgY29uc3RhbnQgcmV0dXJucyh1aW50OCkgewogICAgICAgIHJldHVybiBldG9rZW4yLmJhc2VVbml0KGV0b2tlbjJTeW1ib2wpOwogICAgfQoKICAgIC8qKgogICAgICogVHJhbnNmZXJzIGFzc2V0IGJhbGFuY2UgZnJvbSB0aGUgY2FsbGVyIHRvIHNwZWNpZmllZCByZWNlaXZlci4KICAgICAqCiAgICAgKiBAcGFyYW0gX3RvIGhvbGRlciBhZGRyZXNzIHRvIGdpdmUgdG8uCiAgICAgKiBAcGFyYW0gX3ZhbHVlIGFtb3VudCB0byB0cmFuc2Zlci4KICAgICAqCiAgICAgKiBAcmV0dXJuIHN1Y2Nlc3MuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmV0dXJuIHRyYW5zZmVyV2l0aFJlZmVyZW5jZShfdG8sIF92YWx1ZSwgJycpOwogICAgfQoKICAgIC8qKgogICAgICogVHJhbnNmZXJzIGFzc2V0IGJhbGFuY2UgZnJvbSB0aGUgY2FsbGVyIHRvIHNwZWNpZmllZCByZWNlaXZlciBhZGRpbmcgc3BlY2lmaWVkIGNvbW1lbnQuCiAgICAgKiBSZXNvbHZlcyBhc3NldCBpbXBsZW1lbnRhdGlvbiBjb250cmFjdCBmb3IgdGhlIGNhbGxlciBhbmQgZm9yd2FyZHMgdGhlcmUgYXJndW1lbnRzIGFsb25nIHdpdGgKICAgICAqIHRoZSBjYWxsZXIgYWRkcmVzcy4KICAgICAqCiAgICAgKiBAcGFyYW0gX3RvIGhvbGRlciBhZGRyZXNzIHRvIGdpdmUgdG8uCiAgICAgKiBAcGFyYW0gX3ZhbHVlIGFtb3VudCB0byB0cmFuc2Zlci4KICAgICAqIEBwYXJhbSBfcmVmZXJlbmNlIHRyYW5zZmVyIGNvbW1lbnQgdG8gYmUgaW5jbHVkZWQgaW4gYSBFVG9rZW4yJ3MgVHJhbnNmZXIgZXZlbnQuCiAgICAgKgogICAgICogQHJldHVybiBzdWNjZXNzLgogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcldpdGhSZWZlcmVuY2UoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBzdHJpbmcgX3JlZmVyZW5jZSkgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmV0dXJuIF9nZXRBc3NldCgpLl9wZXJmb3JtVHJhbnNmZXJXaXRoUmVmZXJlbmNlKF90bywgX3ZhbHVlLCBfcmVmZXJlbmNlLCBtc2cuc2VuZGVyKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRyYW5zZmVycyBhc3NldCBiYWxhbmNlIGZyb20gdGhlIGNhbGxlciB0byBzcGVjaWZpZWQgSUNBUC4KICAgICAqCiAgICAgKiBAcGFyYW0gX2ljYXAgcmVjaXBpZW50IElDQVAgdG8gZ2l2ZSB0by4KICAgICAqIEBwYXJhbSBfdmFsdWUgYW1vdW50IHRvIHRyYW5zZmVyLgogICAgICoKICAgICAqIEByZXR1cm4gc3VjY2Vzcy4KICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJUb0lDQVAoYnl0ZXMzMiBfaWNhcCwgdWludCBfdmFsdWUpIHJldHVybnMoYm9vbCkgewogICAgICAgIHJldHVybiB0cmFuc2ZlclRvSUNBUFdpdGhSZWZlcmVuY2UoX2ljYXAsIF92YWx1ZSwgJycpOwogICAgfQoKICAgIC8qKgogICAgICogVHJhbnNmZXJzIGFzc2V0IGJhbGFuY2UgZnJvbSB0aGUgY2FsbGVyIHRvIHNwZWNpZmllZCBJQ0FQIGFkZGluZyBzcGVjaWZpZWQgY29tbWVudC4KICAgICAqIFJlc29sdmVzIGFzc2V0IGltcGxlbWVudGF0aW9uIGNvbnRyYWN0IGZvciB0aGUgY2FsbGVyIGFuZCBmb3J3YXJkcyB0aGVyZSBhcmd1bWVudHMgYWxvbmcgd2l0aAogICAgICogdGhlIGNhbGxlciBhZGRyZXNzLgogICAgICoKICAgICAqIEBwYXJhbSBfaWNhcCByZWNpcGllbnQgSUNBUCB0byBnaXZlIHRvLgogICAgICogQHBhcmFtIF92YWx1ZSBhbW91bnQgdG8gdHJhbnNmZXIuCiAgICAgKiBAcGFyYW0gX3JlZmVyZW5jZSB0cmFuc2ZlciBjb21tZW50IHRvIGJlIGluY2x1ZGVkIGluIGEgRVRva2VuMidzIFRyYW5zZmVyIGV2ZW50LgogICAgICoKICAgICAqIEByZXR1cm4gc3VjY2Vzcy4KICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJUb0lDQVBXaXRoUmVmZXJlbmNlKGJ5dGVzMzIgX2ljYXAsIHVpbnQgX3ZhbHVlLCBzdHJpbmcgX3JlZmVyZW5jZSkgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmV0dXJuIF9nZXRBc3NldCgpLl9wZXJmb3JtVHJhbnNmZXJUb0lDQVBXaXRoUmVmZXJlbmNlKF9pY2FwLCBfdmFsdWUsIF9yZWZlcmVuY2UsIG1zZy5zZW5kZXIpOwogICAgfQoKICAgIC8qKgogICAgICogUHJmb3JtcyBhbGxvd2FuY2UgdHJhbnNmZXIgb2YgYXNzZXQgYmFsYW5jZSBiZXR3ZWVuIGhvbGRlcnMuCiAgICAgKgogICAgICogQHBhcmFtIF9mcm9tIGhvbGRlciBhZGRyZXNzIHRvIHRha2UgZnJvbS4KICAgICAqIEBwYXJhbSBfdG8gaG9sZGVyIGFkZHJlc3MgdG8gZ2l2ZSB0by4KICAgICAqIEBwYXJhbSBfdmFsdWUgYW1vdW50IHRvIHRyYW5zZmVyLgogICAgICoKICAgICAqIEByZXR1cm4gc3VjY2Vzcy4KICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmV0dXJuIHRyYW5zZmVyRnJvbVdpdGhSZWZlcmVuY2UoX2Zyb20sIF90bywgX3ZhbHVlLCAnJyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQcmZvcm1zIGFsbG93YW5jZSB0cmFuc2ZlciBvZiBhc3NldCBiYWxhbmNlIGJldHdlZW4gaG9sZGVycyBhZGRpbmcgc3BlY2lmaWVkIGNvbW1lbnQuCiAgICAgKiBSZXNvbHZlcyBhc3NldCBpbXBsZW1lbnRhdGlvbiBjb250cmFjdCBmb3IgdGhlIGNhbGxlciBhbmQgZm9yd2FyZHMgdGhlcmUgYXJndW1lbnRzIGFsb25nIHdpdGgKICAgICAqIHRoZSBjYWxsZXIgYWRkcmVzcy4KICAgICAqCiAgICAgKiBAcGFyYW0gX2Zyb20gaG9sZGVyIGFkZHJlc3MgdG8gdGFrZSBmcm9tLgogICAgICogQHBhcmFtIF90byBob2xkZXIgYWRkcmVzcyB0byBnaXZlIHRvLgogICAgICogQHBhcmFtIF92YWx1ZSBhbW91bnQgdG8gdHJhbnNmZXIuCiAgICAgKiBAcGFyYW0gX3JlZmVyZW5jZSB0cmFuc2ZlciBjb21tZW50IHRvIGJlIGluY2x1ZGVkIGluIGEgRVRva2VuMidzIFRyYW5zZmVyIGV2ZW50LgogICAgICoKICAgICAqIEByZXR1cm4gc3VjY2Vzcy4KICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tV2l0aFJlZmVyZW5jZShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUsIHN0cmluZyBfcmVmZXJlbmNlKSByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXR1cm4gX2dldEFzc2V0KCkuX3BlcmZvcm1UcmFuc2ZlckZyb21XaXRoUmVmZXJlbmNlKF9mcm9tLCBfdG8sIF92YWx1ZSwgX3JlZmVyZW5jZSwgbXNnLnNlbmRlcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBQZXJmb3JtcyB0cmFuc2ZlciBjYWxsIG9uIHRoZSBFVG9rZW4yIGJ5IHRoZSBuYW1lIG9mIHNwZWNpZmllZCBzZW5kZXIuCiAgICAgKgogICAgICogQ2FuIG9ubHkgYmUgY2FsbGVkIGJ5IGFzc2V0IGltcGxlbWVudGF0aW9uIGNvbnRyYWN0IGFzc2lnbmVkIHRvIHNlbmRlci4KICAgICAqCiAgICAgKiBAcGFyYW0gX2Zyb20gaG9sZGVyIGFkZHJlc3MgdG8gdGFrZSBmcm9tLgogICAgICogQHBhcmFtIF90byBob2xkZXIgYWRkcmVzcyB0byBnaXZlIHRvLgogICAgICogQHBhcmFtIF92YWx1ZSBhbW91bnQgdG8gdHJhbnNmZXIuCiAgICAgKiBAcGFyYW0gX3JlZmVyZW5jZSB0cmFuc2ZlciBjb21tZW50IHRvIGJlIGluY2x1ZGVkIGluIGEgRVRva2VuMidzIFRyYW5zZmVyIGV2ZW50LgogICAgICogQHBhcmFtIF9zZW5kZXIgaW5pdGlhbCBjYWxsZXIuCiAgICAgKgogICAgICogQHJldHVybiBzdWNjZXNzLgogICAgICovCiAgICBmdW5jdGlvbiBfZm9yd2FyZFRyYW5zZmVyRnJvbVdpdGhSZWZlcmVuY2UoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBzdHJpbmcgX3JlZmVyZW5jZSwgYWRkcmVzcyBfc2VuZGVyKSBvbmx5SW1wbGVtZW50YXRpb25Gb3IoX3NlbmRlcikgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmV0dXJuIGV0b2tlbjIucHJveHlUcmFuc2ZlckZyb21XaXRoUmVmZXJlbmNlKF9mcm9tLCBfdG8sIF92YWx1ZSwgZXRva2VuMlN5bWJvbCwgX3JlZmVyZW5jZSwgX3NlbmRlcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBQcmZvcm1zIGFsbG93YW5jZSB0cmFuc2ZlciBvZiBhc3NldCBiYWxhbmNlIGJldHdlZW4gaG9sZGVycy4KICAgICAqCiAgICAgKiBAcGFyYW0gX2Zyb20gaG9sZGVyIGFkZHJlc3MgdG8gdGFrZSBmcm9tLgogICAgICogQHBhcmFtIF9pY2FwIHJlY2lwaWVudCBJQ0FQIGFkZHJlc3MgdG8gZ2l2ZSB0by4KICAgICAqIEBwYXJhbSBfdmFsdWUgYW1vdW50IHRvIHRyYW5zZmVyLgogICAgICoKICAgICAqIEByZXR1cm4gc3VjY2Vzcy4KICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tVG9JQ0FQKGFkZHJlc3MgX2Zyb20sIGJ5dGVzMzIgX2ljYXAsIHVpbnQgX3ZhbHVlKSByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXR1cm4gdHJhbnNmZXJGcm9tVG9JQ0FQV2l0aFJlZmVyZW5jZShfZnJvbSwgX2ljYXAsIF92YWx1ZSwgJycpOwogICAgfQoKICAgIC8qKgogICAgICogUHJmb3JtcyBhbGxvd2FuY2UgdHJhbnNmZXIgb2YgYXNzZXQgYmFsYW5jZSBiZXR3ZWVuIGhvbGRlcnMgYWRkaW5nIHNwZWNpZmllZCBjb21tZW50LgogICAgICogUmVzb2x2ZXMgYXNzZXQgaW1wbGVtZW50YXRpb24gY29udHJhY3QgZm9yIHRoZSBjYWxsZXIgYW5kIGZvcndhcmRzIHRoZXJlIGFyZ3VtZW50cyBhbG9uZyB3aXRoCiAgICAgKiB0aGUgY2FsbGVyIGFkZHJlc3MuCiAgICAgKgogICAgICogQHBhcmFtIF9mcm9tIGhvbGRlciBhZGRyZXNzIHRvIHRha2UgZnJvbS4KICAgICAqIEBwYXJhbSBfaWNhcCByZWNpcGllbnQgSUNBUCBhZGRyZXNzIHRvIGdpdmUgdG8uCiAgICAgKiBAcGFyYW0gX3ZhbHVlIGFtb3VudCB0byB0cmFuc2Zlci4KICAgICAqIEBwYXJhbSBfcmVmZXJlbmNlIHRyYW5zZmVyIGNvbW1lbnQgdG8gYmUgaW5jbHVkZWQgaW4gYSBFVG9rZW4yJ3MgVHJhbnNmZXIgZXZlbnQuCiAgICAgKgogICAgICogQHJldHVybiBzdWNjZXNzLgogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb21Ub0lDQVBXaXRoUmVmZXJlbmNlKGFkZHJlc3MgX2Zyb20sIGJ5dGVzMzIgX2ljYXAsIHVpbnQgX3ZhbHVlLCBzdHJpbmcgX3JlZmVyZW5jZSkgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmV0dXJuIF9nZXRBc3NldCgpLl9wZXJmb3JtVHJhbnNmZXJGcm9tVG9JQ0FQV2l0aFJlZmVyZW5jZShfZnJvbSwgX2ljYXAsIF92YWx1ZSwgX3JlZmVyZW5jZSwgbXNnLnNlbmRlcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBQZXJmb3JtcyBhbGxvd2FuY2UgdHJhbnNmZXIgdG8gSUNBUCBjYWxsIG9uIHRoZSBFVG9rZW4yIGJ5IHRoZSBuYW1lIG9mIHNwZWNpZmllZCBzZW5kZXIuCiAgICAgKgogICAgICogQ2FuIG9ubHkgYmUgY2FsbGVkIGJ5IGFzc2V0IGltcGxlbWVudGF0aW9uIGNvbnRyYWN0IGFzc2lnbmVkIHRvIHNlbmRlci4KICAgICAqCiAgICAgKiBAcGFyYW0gX2Zyb20gaG9sZGVyIGFkZHJlc3MgdG8gdGFrZSBmcm9tLgogICAgICogQHBhcmFtIF9pY2FwIHJlY2lwaWVudCBJQ0FQIGFkZHJlc3MgdG8gZ2l2ZSB0by4KICAgICAqIEBwYXJhbSBfdmFsdWUgYW1vdW50IHRvIHRyYW5zZmVyLgogICAgICogQHBhcmFtIF9yZWZlcmVuY2UgdHJhbnNmZXIgY29tbWVudCB0byBiZSBpbmNsdWRlZCBpbiBhIEVUb2tlbjIncyBUcmFuc2ZlciBldmVudC4KICAgICAqIEBwYXJhbSBfc2VuZGVyIGluaXRpYWwgY2FsbGVyLgogICAgICoKICAgICAqIEByZXR1cm4gc3VjY2Vzcy4KICAgICAqLwogICAgZnVuY3Rpb24gX2ZvcndhcmRUcmFuc2ZlckZyb21Ub0lDQVBXaXRoUmVmZXJlbmNlKGFkZHJlc3MgX2Zyb20sIGJ5dGVzMzIgX2ljYXAsIHVpbnQgX3ZhbHVlLCBzdHJpbmcgX3JlZmVyZW5jZSwgYWRkcmVzcyBfc2VuZGVyKSBvbmx5SW1wbGVtZW50YXRpb25Gb3IoX3NlbmRlcikgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmV0dXJuIGV0b2tlbjIucHJveHlUcmFuc2ZlckZyb21Ub0lDQVBXaXRoUmVmZXJlbmNlKF9mcm9tLCBfaWNhcCwgX3ZhbHVlLCBfcmVmZXJlbmNlLCBfc2VuZGVyKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHMgYXNzZXQgc3BlbmRpbmcgYWxsb3dhbmNlIGZvciBhIHNwZWNpZmllZCBzcGVuZGVyLgogICAgICogUmVzb2x2ZXMgYXNzZXQgaW1wbGVtZW50YXRpb24gY29udHJhY3QgZm9yIHRoZSBjYWxsZXIgYW5kIGZvcndhcmRzIHRoZXJlIGFyZ3VtZW50cyBhbG9uZyB3aXRoCiAgICAgKiB0aGUgY2FsbGVyIGFkZHJlc3MuCiAgICAgKgogICAgICogQHBhcmFtIF9zcGVuZGVyIGhvbGRlciBhZGRyZXNzIHRvIHNldCBhbGxvd2FuY2UgdG8uCiAgICAgKiBAcGFyYW0gX3ZhbHVlIGFtb3VudCB0byBhbGxvdy4KICAgICAqCiAgICAgKiBAcmV0dXJuIHN1Y2Nlc3MuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfdmFsdWUpIHJldHVybnMoYm9vbCkgewogICAgICAgIHJldHVybiBfZ2V0QXNzZXQoKS5fcGVyZm9ybUFwcHJvdmUoX3NwZW5kZXIsIF92YWx1ZSwgbXNnLnNlbmRlcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBQZXJmb3JtcyBhbGxvd2FuY2Ugc2V0dGluZyBjYWxsIG9uIHRoZSBFVG9rZW4yIGJ5IHRoZSBuYW1lIG9mIHNwZWNpZmllZCBzZW5kZXIuCiAgICAgKgogICAgICogQ2FuIG9ubHkgYmUgY2FsbGVkIGJ5IGFzc2V0IGltcGxlbWVudGF0aW9uIGNvbnRyYWN0IGFzc2lnbmVkIHRvIHNlbmRlci4KICAgICAqCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgaG9sZGVyIGFkZHJlc3MgdG8gc2V0IGFsbG93YW5jZSB0by4KICAgICAqIEBwYXJhbSBfdmFsdWUgYW1vdW50IHRvIGFsbG93LgogICAgICogQHBhcmFtIF9zZW5kZXIgaW5pdGlhbCBjYWxsZXIuCiAgICAgKgogICAgICogQHJldHVybiBzdWNjZXNzLgogICAgICovCiAgICBmdW5jdGlvbiBfZm9yd2FyZEFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfdmFsdWUsIGFkZHJlc3MgX3NlbmRlcikgb25seUltcGxlbWVudGF0aW9uRm9yKF9zZW5kZXIpIHJldHVybnMoYm9vbCkgewogICAgICAgIHJldHVybiBldG9rZW4yLnByb3h5QXBwcm92ZShfc3BlbmRlciwgX3ZhbHVlLCBldG9rZW4yU3ltYm9sLCBfc2VuZGVyKTsKICAgIH0KCiAgICAvKioKICAgICAqIEVtaXRzIEVSQzIwIFRyYW5zZmVyIGV2ZW50IG9uIHRoaXMgY29udHJhY3QuCiAgICAgKgogICAgICogQ2FuIG9ubHkgYmUsIGFuZCwgY2FsbGVkIGJ5IGFzc2lnbmVkIEVUb2tlbjIgd2hlbiBhc3NldCB0cmFuc2ZlciBoYXBwZW5zLgogICAgICovCiAgICBmdW5jdGlvbiBlbWl0VHJhbnNmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5RVRva2VuMigpIHsKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgICogRW1pdHMgRVJDMjAgQXBwcm92YWwgZXZlbnQgb24gdGhpcyBjb250cmFjdC4KICAgICAqCiAgICAgKiBDYW4gb25seSBiZSwgYW5kLCBjYWxsZWQgYnkgYXNzaWduZWQgRVRva2VuMiB3aGVuIGFzc2V0IGFsbG93YW5jZSBzZXQgaGFwcGVucy4KICAgICAqLwogICAgZnVuY3Rpb24gZW1pdEFwcHJvdmUoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfc3BlbmRlciwgdWludCBfdmFsdWUpIG9ubHlFVG9rZW4yKCkgewogICAgICAgIEFwcHJvdmFsKF9mcm9tLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlc29sdmVzIGFzc2V0IGltcGxlbWVudGF0aW9uIGNvbnRyYWN0IGZvciB0aGUgY2FsbGVyIGFuZCBmb3J3YXJkcyB0aGVyZSB0cmFuc2FjdGlvbiBkYXRhLAogICAgICogYWxvbmcgd2l0aCB0aGUgdmFsdWUuIFRoaXMgYWxsb3dzIGZvciBwcm94eSBpbnRlcmZhY2UgZ3Jvd3RoLgogICAgICovCiAgICBmdW5jdGlvbiAoKSBwYXlhYmxlIHsKICAgICAgICBfZ2V0QXNzZXQoKS5fcGVyZm9ybUdlbmVyaWMudmFsdWUobXNnLnZhbHVlKShtc2cuZGF0YSwgbXNnLnNlbmRlcik7CiAgICAgICAgX3JldHVyblJldHVybkRhdGEodHJ1ZSk7CiAgICB9CgogICAgLy8gSW50ZXJmYWNlIGZ1bmN0aW9ucyB0byBhbGxvdyBzcGVjaWZ5aW5nIElDQVAgYWRkcmVzc2VzIGFzIHN0cmluZ3MuCiAgICBmdW5jdGlvbiB0cmFuc2ZlclRvSUNBUChzdHJpbmcgX2ljYXAsIHVpbnQgX3ZhbHVlKSByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXR1cm4gdHJhbnNmZXJUb0lDQVBXaXRoUmVmZXJlbmNlKF9pY2FwLCBfdmFsdWUsICcnKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlclRvSUNBUFdpdGhSZWZlcmVuY2Uoc3RyaW5nIF9pY2FwLCB1aW50IF92YWx1ZSwgc3RyaW5nIF9yZWZlcmVuY2UpIHJldHVybnMoYm9vbCkgewogICAgICAgIHJldHVybiB0cmFuc2ZlclRvSUNBUFdpdGhSZWZlcmVuY2UoX2J5dGVzMzIoX2ljYXApLCBfdmFsdWUsIF9yZWZlcmVuY2UpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbVRvSUNBUChhZGRyZXNzIF9mcm9tLCBzdHJpbmcgX2ljYXAsIHVpbnQgX3ZhbHVlKSByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXR1cm4gdHJhbnNmZXJGcm9tVG9JQ0FQV2l0aFJlZmVyZW5jZShfZnJvbSwgX2ljYXAsIF92YWx1ZSwgJycpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbVRvSUNBUFdpdGhSZWZlcmVuY2UoYWRkcmVzcyBfZnJvbSwgc3RyaW5nIF9pY2FwLCB1aW50IF92YWx1ZSwgc3RyaW5nIF9yZWZlcmVuY2UpIHJldHVybnMoYm9vbCkgewogICAgICAgIHJldHVybiB0cmFuc2ZlckZyb21Ub0lDQVBXaXRoUmVmZXJlbmNlKF9mcm9tLCBfYnl0ZXMzMihfaWNhcCksIF92YWx1ZSwgX3JlZmVyZW5jZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbmRpY2F0ZXMgYW4gdXBncmFkZSBmcmVlemUtdGltZSBzdGFydCwgYW5kIHRoZSBuZXh0IGFzc2V0IGltcGxlbWVudGF0aW9uIGNvbnRyYWN0LgogICAgICovCiAgICBldmVudCBVcGdyYWRlUHJvcG9zZWQoYWRkcmVzcyBuZXdWZXJzaW9uKTsKICAgIGV2ZW50IFVwZ3JhZGVQdXJnZWQoYWRkcmVzcyBuZXdWZXJzaW9uKTsKICAgIGV2ZW50IFVwZ3JhZGVDb21taXRlZChhZGRyZXNzIG5ld1ZlcnNpb24pOwogICAgZXZlbnQgT3B0ZWRPdXQoYWRkcmVzcyBzZW5kZXIsIGFkZHJlc3MgdmVyc2lvbik7CiAgICBldmVudCBPcHRlZEluKGFkZHJlc3Mgc2VuZGVyLCBhZGRyZXNzIHZlcnNpb24pOwoKICAgIC8vIEN1cnJlbnQgYXNzZXQgaW1wbGVtZW50YXRpb24gY29udHJhY3QgYWRkcmVzcy4KICAgIGFkZHJlc3MgbGF0ZXN0VmVyc2lvbjsKCiAgICAvLyBQcm9wb3NlZCBuZXh0IGFzc2V0IGltcGxlbWVudGF0aW9uIGNvbnRyYWN0IGFkZHJlc3MuCiAgICBhZGRyZXNzIHBlbmRpbmdWZXJzaW9uOwoKICAgIC8vIFVwZ3JhZGUgZnJlZXplLXRpbWUgc3RhcnQuCiAgICB1aW50IHBlbmRpbmdWZXJzaW9uVGltZXN0YW1wOwoKICAgIC8vIFRpbWVzcGFuIGZvciB1c2VycyB0byByZXZpZXcgdGhlIG5ldyBpbXBsZW1lbnRhdGlvbiBhbmQgbWFrZSBkZWNpc2lvbi4KICAgIHVpbnQgY29uc3RhbnQgVVBHUkFERV9GUkVFWkVfVElNRSA9IDMgZGF5czsKCiAgICAvLyBBc3NldCBpbXBsZW1lbnRhdGlvbiBjb250cmFjdCBhZGRyZXNzIHRoYXQgdXNlciBkZWNpZGVkIHRvIHN0aWNrIHdpdGguCiAgICAvLyAweDAgbWVhbnMgdGhhdCB1c2VyIHVzZXMgbGF0ZXN0IHZlcnNpb24uCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYWRkcmVzcykgdXNlck9wdE91dFZlcnNpb247CgogICAgLyoqCiAgICAgKiBPbmx5IGFzc2V0IGltcGxlbWVudGF0aW9uIGNvbnRyYWN0IGFzc2lnbmVkIHRvIHNlbmRlciBpcyBhbGxvd2VkIHRvIGNhbGwuCiAgICAgKi8KICAgIG1vZGlmaWVyIG9ubHlJbXBsZW1lbnRhdGlvbkZvcihhZGRyZXNzIF9zZW5kZXIpIHsKICAgICAgICBpZiAoZ2V0VmVyc2lvbkZvcihfc2VuZGVyKSA9PSBtc2cuc2VuZGVyKSB7CiAgICAgICAgICAgIF87CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyBhc3NldCBpbXBsZW1lbnRhdGlvbiBjb250cmFjdCBhZGRyZXNzIGFzc2lnbmVkIHRvIHNlbmRlci4KICAgICAqCiAgICAgKiBAcGFyYW0gX3NlbmRlciBzZW5kZXIgYWRkcmVzcy4KICAgICAqCiAgICAgKiBAcmV0dXJuIGFzc2V0IGltcGxlbWVudGF0aW9uIGNvbnRyYWN0IGFkZHJlc3MuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFZlcnNpb25Gb3IoYWRkcmVzcyBfc2VuZGVyKSBjb25zdGFudCByZXR1cm5zKGFkZHJlc3MpIHsKICAgICAgICByZXR1cm4gdXNlck9wdE91dFZlcnNpb25bX3NlbmRlcl0gPT0gMCA/IGxhdGVzdFZlcnNpb24gOiB1c2VyT3B0T3V0VmVyc2lvbltfc2VuZGVyXTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgY3VycmVudCBhc3NldCBpbXBsZW1lbnRhdGlvbiBjb250cmFjdCBhZGRyZXNzLgogICAgICoKICAgICAqIEByZXR1cm4gYXNzZXQgaW1wbGVtZW50YXRpb24gY29udHJhY3QgYWRkcmVzcy4KICAgICAqLwogICAgZnVuY3Rpb24gZ2V0TGF0ZXN0VmVyc2lvbigpIGNvbnN0YW50IHJldHVybnMoYWRkcmVzcykgewogICAgICAgIHJldHVybiBsYXRlc3RWZXJzaW9uOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyBwcm9wb3NlZCBuZXh0IGFzc2V0IGltcGxlbWVudGF0aW9uIGNvbnRyYWN0IGFkZHJlc3MuCiAgICAgKgogICAgICogQHJldHVybiBhc3NldCBpbXBsZW1lbnRhdGlvbiBjb250cmFjdCBhZGRyZXNzLgogICAgICovCiAgICBmdW5jdGlvbiBnZXRQZW5kaW5nVmVyc2lvbigpIGNvbnN0YW50IHJldHVybnMoYWRkcmVzcykgewogICAgICAgIHJldHVybiBwZW5kaW5nVmVyc2lvbjsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdXBncmFkZSBmcmVlemUtdGltZSBzdGFydC4KICAgICAqCiAgICAgKiBAcmV0dXJuIGZyZWV6ZS10aW1lIHN0YXJ0LgogICAgICovCiAgICBmdW5jdGlvbiBnZXRQZW5kaW5nVmVyc2lvblRpbWVzdGFtcCgpIGNvbnN0YW50IHJldHVybnModWludCkgewogICAgICAgIHJldHVybiBwZW5kaW5nVmVyc2lvblRpbWVzdGFtcDsKICAgIH0KCiAgICAvKioKICAgICAqIFByb3Bvc2UgbmV4dCBhc3NldCBpbXBsZW1lbnRhdGlvbiBjb250cmFjdCBhZGRyZXNzLgogICAgICoKICAgICAqIENhbiBvbmx5IGJlIGNhbGxlZCBieSBjdXJyZW50IGFzc2V0IG93bmVyLgogICAgICoKICAgICAqIE5vdGU6IGZyZWV6ZS10aW1lIHNob3VsZCBub3QgYmUgYXBwbGllZCBmb3IgdGhlIGluaXRpYWwgc2V0dXAuCiAgICAgKgogICAgICogQHBhcmFtIF9uZXdWZXJzaW9uIGFzc2V0IGltcGxlbWVudGF0aW9uIGNvbnRyYWN0IGFkZHJlc3MuCiAgICAgKgogICAgICogQHJldHVybiBzdWNjZXNzLgogICAgICovCiAgICBmdW5jdGlvbiBwcm9wb3NlVXBncmFkZShhZGRyZXNzIF9uZXdWZXJzaW9uKSBvbmx5QXNzZXRPd25lcigpIHJldHVybnMoYm9vbCkgewogICAgICAgIC8vIFNob3VsZCBub3QgYWxyZWFkeSBiZSBpbiB0aGUgdXBncmFkaW5nIHByb2Nlc3MuCiAgICAgICAgaWYgKHBlbmRpbmdWZXJzaW9uICE9IDB4MCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIC8vIE5ldyB2ZXJzaW9uIGFkZHJlc3Mgc2hvdWxkIGJlIG90aGVyIHRoYW4gMHgwLgogICAgICAgIGlmIChfbmV3VmVyc2lvbiA9PSAweDApIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICAvLyBEb24ndCBhcHBseSBmcmVlemUtdGltZSBmb3IgdGhlIGluaXRpYWwgc2V0dXAuCiAgICAgICAgaWYgKGxhdGVzdFZlcnNpb24gPT0gMHgwKSB7CiAgICAgICAgICAgIGxhdGVzdFZlcnNpb24gPSBfbmV3VmVyc2lvbjsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHBlbmRpbmdWZXJzaW9uID0gX25ld1ZlcnNpb247CiAgICAgICAgcGVuZGluZ1ZlcnNpb25UaW1lc3RhbXAgPSBub3c7CiAgICAgICAgVXBncmFkZVByb3Bvc2VkKF9uZXdWZXJzaW9uKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIENhbmNlbCB0aGUgcGVuZGluZyB1cGdyYWRlIHByb2Nlc3MuCiAgICAgKgogICAgICogQ2FuIG9ubHkgYmUgY2FsbGVkIGJ5IGN1cnJlbnQgYXNzZXQgb3duZXIuCiAgICAgKgogICAgICogQHJldHVybiBzdWNjZXNzLgogICAgICovCiAgICBmdW5jdGlvbiBwdXJnZVVwZ3JhZGUoKSBvbmx5QXNzZXRPd25lcigpIHJldHVybnMoYm9vbCkgewogICAgICAgIGlmIChwZW5kaW5nVmVyc2lvbiA9PSAweDApIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBVcGdyYWRlUHVyZ2VkKHBlbmRpbmdWZXJzaW9uKTsKICAgICAgICBkZWxldGUgcGVuZGluZ1ZlcnNpb247CiAgICAgICAgZGVsZXRlIHBlbmRpbmdWZXJzaW9uVGltZXN0YW1wOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogRmluYWxpemUgYW4gdXBncmFkZSBwcm9jZXNzIHNldHRpbmcgbmV3IGFzc2V0IGltcGxlbWVudGF0aW9uIGNvbnRyYWN0IGFkZHJlc3MuCiAgICAgKgogICAgICogQ2FuIG9ubHkgYmUgY2FsbGVkIGFmdGVyIGFuIHVwZ3JhZGUgZnJlZXplLXRpbWUuCiAgICAgKgogICAgICogQHJldHVybiBzdWNjZXNzLgogICAgICovCiAgICBmdW5jdGlvbiBjb21taXRVcGdyYWRlKCkgcmV0dXJucyhib29sKSB7CiAgICAgICAgaWYgKHBlbmRpbmdWZXJzaW9uID09IDB4MCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGlmIChwZW5kaW5nVmVyc2lvblRpbWVzdGFtcCArIFVQR1JBREVfRlJFRVpFX1RJTUUgPiBub3cpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBsYXRlc3RWZXJzaW9uID0gcGVuZGluZ1ZlcnNpb247CiAgICAgICAgZGVsZXRlIHBlbmRpbmdWZXJzaW9uOwogICAgICAgIGRlbGV0ZSBwZW5kaW5nVmVyc2lvblRpbWVzdGFtcDsKICAgICAgICBVcGdyYWRlQ29tbWl0ZWQobGF0ZXN0VmVyc2lvbik7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBEaXNhZ3JlZSB3aXRoIHByb3Bvc2VkIHVwZ3JhZGUsIGFuZCBzdGljayB3aXRoIGN1cnJlbnQgYXNzZXQgaW1wbGVtZW50YXRpb24KICAgICAqIHVudGlsIGZ1cnRoZXIgZXhwbGljaXQgYWdyZWVtZW50IHRvIHVwZ3JhZGUuCiAgICAgKgogICAgICogQHJldHVybiBzdWNjZXNzLgogICAgICovCiAgICBmdW5jdGlvbiBvcHRPdXQoKSByZXR1cm5zKGJvb2wpIHsKICAgICAgICBpZiAodXNlck9wdE91dFZlcnNpb25bbXNnLnNlbmRlcl0gIT0gMHgwKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgdXNlck9wdE91dFZlcnNpb25bbXNnLnNlbmRlcl0gPSBsYXRlc3RWZXJzaW9uOwogICAgICAgIE9wdGVkT3V0KG1zZy5zZW5kZXIsIGxhdGVzdFZlcnNpb24pOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogSW1wbGljaXRseSBhZ3JlZSB0byB1cGdyYWRlIHRvIGN1cnJlbnQgYW5kIGZ1dHVyZSBhc3NldCBpbXBsZW1lbnRhdGlvbiB1cGdyYWRlcywKICAgICAqIHVudGlsIGZ1cnRoZXIgZXhwbGljaXQgZGlzYWdyZWVtZW50LgogICAgICoKICAgICAqIEByZXR1cm4gc3VjY2Vzcy4KICAgICAqLwogICAgZnVuY3Rpb24gb3B0SW4oKSByZXR1cm5zKGJvb2wpIHsKICAgICAgICBkZWxldGUgdXNlck9wdE91dFZlcnNpb25bbXNnLnNlbmRlcl07CiAgICAgICAgT3B0ZWRJbihtc2cuc2VuZGVyLCBsYXRlc3RWZXJzaW9uKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBCYWNrd2FyZHMgY29tcGF0aWJpbGl0eS4KICAgIGZ1bmN0aW9uIG11bHRpQXNzZXQoKSBjb25zdGFudCByZXR1cm5zKEVUb2tlbjJJbnRlcmZhY2UpIHsKICAgICAgICByZXR1cm4gZXRva2VuMjsKICAgIH0KfQ=='.
	

]
