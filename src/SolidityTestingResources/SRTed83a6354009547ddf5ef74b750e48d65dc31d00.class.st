Class {
	#name : #SRTed83a6354009547ddf5ef74b750e48d65dc31d00,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTed83a6354009547ddf5ef74b750e48d65dc31d00 >> base64 [
	^ 'Y29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CgogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICB1aW50MjU2IF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgfSBlbHNlIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKfQoKY29udHJhY3QgT3duZWQgCnsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwogICAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvKTsKCiAgICBmdW5jdGlvbiBPd25lZCgpIAogICAgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5T3duZXIgCiAgICB7CiAgICAgICAgcmVxdWlyZSAobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5T3duZXJPclRva2VuVHJhZGVyV2l0aFNhbWVPd25lciAKICAgIHsKICAgICAgICByZXF1aXJlIChtc2cuc2VuZGVyID09IG93bmVyICYmIFRva2VuVHJhZGVyKG1zZy5zZW5kZXIpLm93bmVyKCkgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIAogICAgewogICAgICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgIH0KfQoKY29udHJhY3QgeDg4OCBpcyBTdGFuZGFyZFRva2VuLCBPd25lZAp7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICJNZXRhIEV4Y2hhbmdlIHg4ODgiOwogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAiWDg4OCI7CiAgICB1aW50OCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSA2OwogICAgCiAgICB1aW50MjU2IHZlcnNpb24gPSAxMDAyMDAxMDAwMTsKICAgIAogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHkgPSA1MTI1Mzg3ODg4ICogKHVpbnQyNTYoMTApICoqIGRlY2ltYWxzKTsKCiAgICB1aW50MjU2IHB1YmxpYyBleGNoRmVlID0gdWludDI1NigxICogKHVpbnQyNTYoMTApICoqIChkZWNpbWFscyAtIDIpKSk7CgogICAgdWludDI1NiBwdWJsaWMgc3RhcnRUaW1lc3RhbXA7CiAgICAKICAgIHVpbnQyNTYgcHVibGljIGF2Z1JhdGUgPSB1aW50MjU2KHVpbnQyNTYoMTApKiooMTgtZGVjaW1hbHMpKS5kaXYoODg4KTsKCiAgICBhZGRyZXNzIHB1YmxpYyBzdHVmZiA9IDB4MENjQ2I5YkFBZEQ2MUY5ZTBhYjI1YkQ3ODI3NjUwMTM4MTc4MjFiRDsKICAgIGFkZHJlc3MgcHVibGljIHRlYW1hID0gMHgyMGYzNDk5MTdkMjUyMWM0MWY4ZWM5YzBhMWY3ZTBjMzZhZjBiNDZmOwogICAgYWRkcmVzcyBwdWJsaWMgYmFzZW93bmVyOwoKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBfdmVyaWZ5OwogICAgbWFwcGluZyh1aW50MjU2ID0+IGFkZHJlc3MpIF9ta3M7CiAgICB1aW50MjU2IHB1YmxpYyBtYWtlcnNDb3VudDsKCiAgICBldmVudCBMb2dUcmFuc2ZlcihhZGRyZXNzIHNlbmRlciwgYWRkcmVzcyB0bywgdWludCBhbW91bnQpOwogICAgZXZlbnQgQ2xlYXJpbmcoYWRkcmVzcyB0bywgdWludDI1NiBhbW91bnQpOwoKICAgIGV2ZW50IFRyYWRlTGlzdGluZyhhZGRyZXNzIGluZGV4ZWQgb3duZXJBZGRyZXNzLCBhZGRyZXNzIGluZGV4ZWQgdG9rZW5UcmFkZXJBZGRyZXNzLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBhc3NldCwgdWludDI1NiBidXlQcmljZSwgdWludDI1NiBzZWxsUHJpY2UsIHVpbnQyNTYgdW5pdHMsCiAgICAgICAgYm9vbCBidXlzVG9rZW5zLCBib29sIHNlbGxzVG9rZW5zKTsKICAgIGV2ZW50IE93bmVyV2l0aGRyZXdFUkMyMFRva2VuKGFkZHJlc3MgaW5kZXhlZCB0b2tlbkFkZHJlc3MsIHVpbnQyNTYgdG9rZW5zKTsKCiAgICBmdW5jdGlvbiB4ODg4KCkgCiAgICB7CiAgICAgICAgbWFrZXJzQ291bnQgPSAwOwogICAgICAgIHN0YXJ0VGltZXN0YW1wID0gbm93OwogICAgICAgIGJhc2Vvd25lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgYmFsYW5jZXNbYmFzZW93bmVyXSA9IHRvdGFsU3VwcGx5OwogICAgICAgIFRyYW5zZmVyKDB4MCwgYmFzZW93bmVyLCB0b3RhbFN1cHBseSk7CiAgICB9CgogICAgZnVuY3Rpb24gYnZhKGFkZHJlc3MgcGFydG5lciwgdWludDI1NiB2YWx1ZSwgYWRkcmVzcyBhZHZpc2VyKXBheWFibGUgcHVibGljIAogICAgewogICAgICB1aW50MjU2IHRva2VuQW1vdW50ID0gY2FsY1RvdGFsKHZhbHVlKTsKICAgICAgaWYobXNnLnZhbHVlICE9IDApCiAgICAgIHsKICAgICAgICB0b2tlbkFtb3VudCA9IGNhbGNDb3VudChtc2cudmFsdWUpOwogICAgICB9ZWxzZQogICAgICB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHN0dWZmKTsKICAgICAgfQogICAgICBpZihtc2cudmFsdWUgIT0gMCkKICAgICAgewogICAgICAgIENsZWFyaW5nKHN0dWZmLCBtc2cudmFsdWUubXVsKDQwKS5kaXYoMTAwKSk7CiAgICAgICAgc3R1ZmYudHJhbnNmZXIobXNnLnZhbHVlLm11bCg0MCkuZGl2KDEwMCkpOwogICAgICAgIENsZWFyaW5nKHRlYW1hLCBtc2cudmFsdWUubXVsKDQwKS5kaXYoMTAwKSk7CiAgICAgICAgdGVhbWEudHJhbnNmZXIobXNnLnZhbHVlLm11bCg0MCkuZGl2KDEwMCkpOwogICAgICAgIGlmKHBhcnRuZXIgIT0gYWR2aXNlciAmJiBiYWxhbmNlc1thZHZpc2VyXSE9MCkKICAgICAgICB7CiAgICAgICAgICBDbGVhcmluZyhhZHZpc2VyLCBtc2cudmFsdWUubXVsKDIwKS5kaXYoMTAwKSk7CiAgICAgICAgICBhZHZpc2VyLnRyYW5zZmVyKG1zZy52YWx1ZS5tdWwoMjApLmRpdigxMDApKTsKICAgICAgICB9ZWxzZQogICAgICAgIHsKICAgICAgICAgIENsZWFyaW5nKHN0dWZmLCBtc2cudmFsdWUubXVsKDEwKS5kaXYoMTAwKSk7CiAgICAgICAgICBzdHVmZi50cmFuc2Zlcihtc2cudmFsdWUubXVsKDEwKS5kaXYoMTAwKSk7CiAgICAgICAgICBDbGVhcmluZyh0ZWFtYSwgbXNnLnZhbHVlLm11bCgxMCkuZGl2KDEwMCkpOwogICAgICAgICAgdGVhbWEudHJhbnNmZXIobXNnLnZhbHVlLm11bCgxMCkuZGl2KDEwMCkpOwogICAgICAgIH0gCiAgICAgIH0KICAgICAgYmFsYW5jZXNbYmFzZW93bmVyXSA9IGJhbGFuY2VzW2Jhc2Vvd25lcl0uc3ViKHRva2VuQW1vdW50KTsKICAgICAgYmFsYW5jZXNbcGFydG5lcl0gPSBiYWxhbmNlc1twYXJ0bmVyXS5hZGQodG9rZW5BbW91bnQpOwogICAgICBUcmFuc2ZlcihiYXNlb3duZXIsIHBhcnRuZXIsIHRva2VuQW1vdW50KTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24oKSBwYXlhYmxlIHB1YmxpYwogICAgewogICAgICBpZihtc2cudmFsdWUgIT0gMCkKICAgICAgewogICAgICAgIHVpbnQyNTYgdG9rZW5BbW91bnQgPSBtc2cudmFsdWUuZGl2KGF2Z1JhdGUpOwogICAgICAgIENsZWFyaW5nKHN0dWZmLCBtc2cudmFsdWUubXVsKDUwKS5kaXYoMTAwKSk7CiAgICAgICAgc3R1ZmYudHJhbnNmZXIobXNnLnZhbHVlLm11bCg1MCkuZGl2KDEwMCkpOwogICAgICAgIENsZWFyaW5nKHRlYW1hLCBtc2cudmFsdWUubXVsKDUwKS5kaXYoMTAwKSk7CiAgICAgICAgdGVhbWEudHJhbnNmZXIobXNnLnZhbHVlLm11bCg1MCkuZGl2KDEwMCkpOwogICAgICAgIGlmKG1zZy5zZW5kZXIhPXN0dWZmKQogICAgICAgIHsKICAgICAgICAgIGJhbGFuY2VzW2Jhc2Vvd25lcl0gPSBiYWxhbmNlc1tiYXNlb3duZXJdLnN1Yih0b2tlbkFtb3VudCk7CiAgICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLmFkZCh0b2tlbkFtb3VudCk7CiAgICAgICAgICBUcmFuc2ZlcihiYXNlb3duZXIsIG1zZy5zZW5kZXIsIHRva2VuQW1vdW50KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBjYWxjVG90YWwodWludDI1NiBjb3VudCkgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KSAKICAgIHsKICAgICAgICByZXR1cm4gY291bnQubXVsKGdldERlZmxhdG9yKCkpLmRpdigxMDApOwogICAgfQoKICAgIGZ1bmN0aW9uIGNhbGNDb3VudCh1aW50MjU2IHdlaUFtb3VudCkgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KSAKICAgIHsKICAgICAgICByZXR1cm4gd2VpQW1vdW50LmRpdihhdmdSYXRlKS5tdWwoZ2V0RGVmbGF0b3IoKSkuZGl2KDEwMCk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RGVmbGF0b3IoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KQogICAgewogICAgICAgIGlmIChub3cgPD0gc3RhcnRUaW1lc3RhbXAgKyAyOCBkYXlzKS8vMzglIAogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIDEzODsKICAgICAgICB9ZWxzZSBpZiAobm93IDw9IHN0YXJ0VGltZXN0YW1wICsgNTYgZGF5cykvLzIzJSAKICAgICAgICB7CiAgICAgICAgICAgIHJldHVybiAxMjM7CiAgICAgICAgfWVsc2UgaWYgKG5vdyA8PSBzdGFydFRpbWVzdGFtcCArIDg0IGRheXMpLy8xNSUgCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gMTE1OwogICAgICAgIH1lbHNlIGlmIChub3cgPD0gc3RhcnRUaW1lc3RhbXAgKyAxMTIgZGF5cykvLzklCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gMTA5OwogICAgICAgIH1lbHNlIGlmIChub3cgPD0gc3RhcnRUaW1lc3RhbXAgKyAxNDAgZGF5cykvLzUlCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gMTA1OwogICAgICAgIH1lbHNlCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gMTAwOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiB2ZXJpZnkoYWRkcmVzcyB0cmFkZUNvbnRyYWN0KSBjb25zdGFudCByZXR1cm5zICgKICAgICAgICBib29sICAgIHZhbGlkLAogICAgICAgIGFkZHJlc3Mgb3duZXIsCiAgICAgICAgYWRkcmVzcyBhc3NldCwKICAgICAgICB1aW50MjU2IGJ1eVByaWNlLAogICAgICAgIHVpbnQyNTYgc2VsbFByaWNlLAogICAgICAgIHVpbnQyNTYgdW5pdHMsCiAgICAgICAgYm9vbCAgICBidXlzVG9rZW5zLAogICAgICAgIGJvb2wgICAgc2VsbHNUb2tlbnMKICAgICkgCiAgICB7CiAgICAgICAgdmFsaWQgPSBfdmVyaWZ5W3RyYWRlQ29udHJhY3RdOwogICAgICAgIGlmICh2YWxpZCkgCiAgICAgICAgewogICAgICAgICAgICBUb2tlblRyYWRlciB0ID0gVG9rZW5UcmFkZXIodHJhZGVDb250cmFjdCk7CiAgICAgICAgICAgIG93bmVyICAgICAgICAgPSB0Lm93bmVyKCk7CiAgICAgICAgICAgIGFzc2V0ICAgICAgICAgPSB0LmFzc2V0KCk7CiAgICAgICAgICAgIGJ1eVByaWNlICAgICAgPSB0LmJ1eVByaWNlKCk7CiAgICAgICAgICAgIHNlbGxQcmljZSAgICAgPSB0LnNlbGxQcmljZSgpOwogICAgICAgICAgICB1bml0cyAgICAgICAgID0gdC51bml0cygpOwogICAgICAgICAgICBidXlzVG9rZW5zICAgID0gdC5idXlzVG9rZW5zKCk7CiAgICAgICAgICAgIHNlbGxzVG9rZW5zICAgPSB0LnNlbGxzVG9rZW5zKCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGdldFRyYWRlcih1aW50MjU2IGlkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoCiAgICAgICAgYm9vbCAgICB2YWxpZCwKICAgICAgICBhZGRyZXNzIHRyYWRlLAogICAgICAgIGFkZHJlc3Mgb3duZXIsCiAgICAgICAgYWRkcmVzcyBhc3NldCwKICAgICAgICB1aW50MjU2IGJ1eVByaWNlLAogICAgICAgIHVpbnQyNTYgc2VsbFByaWNlLAogICAgICAgIHVpbnQyNTYgdW5pdHMsCiAgICAgICAgYm9vbCAgICBidXlzVG9rZW5zLAogICAgICAgIGJvb2wgICAgc2VsbHNUb2tlbnMKICAgICkgCiAgICB7CiAgICAgIGlmKGlkIDwgbWFrZXJzQ291bnQpCiAgICAgIHsKICAgICAgICB0cmFkZSA9IF9ta3NbaWRdOwogICAgICAgIHZhbGlkID0gX3ZlcmlmeVt0cmFkZV07CiAgICAgICAgaWYgKHZhbGlkKSAKICAgICAgICB7CiAgICAgICAgICAgIFRva2VuVHJhZGVyIHQgPSBUb2tlblRyYWRlcih0cmFkZSk7CiAgICAgICAgICAgIG93bmVyICAgICAgICAgPSB0Lm93bmVyKCk7CiAgICAgICAgICAgIGFzc2V0ICAgICAgICAgPSB0LmFzc2V0KCk7CiAgICAgICAgICAgIGJ1eVByaWNlICAgICAgPSB0LmJ1eVByaWNlKCk7CiAgICAgICAgICAgIHNlbGxQcmljZSAgICAgPSB0LnNlbGxQcmljZSgpOwogICAgICAgICAgICB1bml0cyAgICAgICAgID0gdC51bml0cygpOwogICAgICAgICAgICBidXlzVG9rZW5zICAgID0gdC5idXlzVG9rZW5zKCk7CiAgICAgICAgICAgIHNlbGxzVG9rZW5zICAgPSB0LnNlbGxzVG9rZW5zKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGNyZWF0ZVRyYWRlQ29udHJhY3QoCiAgICAgICAgYWRkcmVzcyBhc3NldCwKICAgICAgICB1aW50MjU2IGJ1eVByaWNlLAogICAgICAgIHVpbnQyNTYgc2VsbFByaWNlLAogICAgICAgIHVpbnQyNTYgdW5pdHMsCiAgICAgICAgYm9vbCAgICBidXlzVG9rZW5zLAogICAgICAgIGJvb2wgICAgc2VsbHNUb2tlbnMKICAgICkgcHVibGljIHJldHVybnMgKGFkZHJlc3MgdHJhZGVyKSAKICAgIHsKICAgICAgICByZXF1aXJlIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+IDEwMDAgKiAodWludDI1NigxMCkgKiogZGVjaW1hbHMpKTsKICAgICAgICByZXF1aXJlIChhc3NldCAhPSAweDApOwogICAgICAgIHJlcXVpcmUoYnV5UHJpY2UgPiAwICYmIHNlbGxQcmljZSA+IDApOwogICAgICAgIHJlcXVpcmUoYnV5UHJpY2UgPCBzZWxsUHJpY2UpOwogICAgICAgIHJlcXVpcmUodW5pdHMgPiAwKTsKCiAgICAgICAgdHJhZGVyID0gbmV3IFRva2VuVHJhZGVyKAogICAgICAgICAgICBhc3NldCwKICAgICAgICAgICAgZXhjaEZlZSwKICAgICAgICAgICAgYWRkcmVzcyh0aGlzKSwKICAgICAgICAgICAgYnV5UHJpY2UsCiAgICAgICAgICAgIHNlbGxQcmljZSwKICAgICAgICAgICAgdW5pdHMsCiAgICAgICAgICAgIGJ1eXNUb2tlbnMsCiAgICAgICAgICAgIHNlbGxzVG9rZW5zKTsKICAgICAgICBfdmVyaWZ5W3RyYWRlcl0gPSB0cnVlOwogICAgICAgIF9ta3NbbWFrZXJzQ291bnRdID0gdHJhZGVyOwogICAgICAgIG1ha2Vyc0NvdW50ID0gbWFrZXJzQ291bnQuYWRkKDEpOwogICAgICAgIGJhbGFuY2VzW2Jhc2Vvd25lcl0gKz0gMTAwMCAqICh1aW50MjU2KDEwKSAqKiBkZWNpbWFscyk7CiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gLT0gMTAwMCAqICh1aW50MjU2KDEwKSAqKiBkZWNpbWFscyk7CiAgICAgICAgVG9rZW5UcmFkZXIodHJhZGVyKS50cmFuc2Zlck93bmVyc2hpcChtc2cuc2VuZGVyKTsKICAgICAgICBUcmFkZUxpc3RpbmcobXNnLnNlbmRlciwgdHJhZGVyLCBhc3NldCwgYnV5UHJpY2UsIHNlbGxQcmljZSwgdW5pdHMsIGJ1eXNUb2tlbnMsIHNlbGxzVG9rZW5zKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjbGVhbnVwKCkgCiAgICB7CiAgICAgIHJldmVydCgpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcmV0dXJucyAoYm9vbCkgCiAgICB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSByZXR1cm5zIChib29sKSAKICAgIHsKICAgICAgICBpZihfdmVyaWZ5W19mcm9tXSkKICAgICAgICB7CiAgICAgICAgICAgVG9rZW5UcmFkZXIgdCA9IFRva2VuVHJhZGVyKF9mcm9tKTsKICAgICAgICAgICBpZihiYWxhbmNlc1thZGRyZXNzKHQub3duZXIpXT5fdmFsdWUpCiAgICAgICAgICAgewogICAgICAgICAgICAgICBiYWxhbmNlc1thZGRyZXNzKHQub3duZXIpXSArPSBfdmFsdWU7CiAgICAgICAgICAgICAgIGJhbGFuY2VzW190b10gLT0gX3ZhbHVlOwogICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcmVtYWluaW5nKQogICAgewogICAgICAgIHJldHVybiBzdXBlci5hbGxvd2FuY2UoX293bmVyLCBfc3BlbmRlcik7CiAgICB9Cgp9Cgpjb250cmFjdCBFUkNUVyAKewogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQgX3ZhbHVlKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludCBfdmFsdWUpOwp9CgoKY29udHJhY3QgVG9rZW5UcmFkZXIgaXMgT3duZWQgCnsKICAgIGFkZHJlc3MgcHVibGljIGV4Y2hhbmdlOyAgICAvLyBhZGRyZXNzIG9mIGV4Y2hhbmdlCiAgICBhZGRyZXNzIHB1YmxpYyBhc3NldDsgICAgICAgLy8gYWRkcmVzcyBvZiB0b2tlbgogICAgdWludDI1NiBwdWJsaWMgYnV5UHJpY2U7ICAgIC8vIGNvbnRyYWN0IGJ1eXMgbG90cyBvZiB0b2tlbiBhdCB0aGlzIHByaWNlCiAgICB1aW50MjU2IHB1YmxpYyBzZWxsUHJpY2U7ICAgLy8gY29udHJhY3Qgc2VsbHMgbG90cyBhdCB0aGlzIHByaWNlCiAgICB1aW50MjU2IHB1YmxpYyB1bml0czsgICAgICAgLy8gbG90IHNpemUgKHRva2VuLXdlaSkKICAgIHVpbnQyNTYgcHVibGljIGV4Y2hGZWU7ICAgICAvLyBmZWUgc2l6ZSAoMCwwMSB4ODg4OCkKCiAgICBib29sIHB1YmxpYyBidXlzVG9rZW5zOyAgICAgLy8gaXMgY29udHJhY3QgYnV5aW5nCiAgICBib29sIHB1YmxpYyBzZWxsc1Rva2VuczsgICAgLy8gaXMgY29udHJhY3Qgc2VsbGluZwoKICAgIGV2ZW50IEFjdGl2YXRlZEV2ZW50KGJvb2wgYnV5cywgYm9vbCBzZWxscyk7CiAgICBldmVudCBNYWtlckRlcG9zaXRlZEV0aGVyKHVpbnQyNTYgYW1vdW50KTsKICAgIGV2ZW50IE1ha2VyV2l0aGRyZXdBc3NldCh1aW50MjU2IHRva2Vucyk7CiAgICBldmVudCBNYWtlclRyYW5zZmVycmVkQXNzZXQoYWRkcmVzcyB0b1Rva2VuVHJhZGVyLCB1aW50MjU2IHRva2Vucyk7CiAgICBldmVudCBNYWtlcldpdGhkcmV3RVJDMjBUb2tlbihhZGRyZXNzIHRva2VuQWRkcmVzcywgdWludDI1NiB0b2tlbnMpOwogICAgZXZlbnQgTWFrZXJXaXRoZHJld0V0aGVyKHVpbnQyNTYgZXRoZXJzKTsKICAgIGV2ZW50IE1ha2VyVHJhbnNmZXJyZWRFdGhlcihhZGRyZXNzIHRvVG9rZW5UcmFkZXIsIHVpbnQyNTYgZXRoZXJzKTsKICAgIGV2ZW50IFRha2VyQm91Z2h0QXNzZXQoYWRkcmVzcyBpbmRleGVkIGJ1eWVyLCB1aW50MjU2IGV0aGVyc1NlbnQsCiAgICAgICAgdWludDI1NiBldGhlcnNSZXR1cm5lZCwgdWludDI1NiB0b2tlbnNCb3VnaHQpOwogICAgZXZlbnQgVGFrZXJTb2xkQXNzZXQoYWRkcmVzcyBpbmRleGVkIHNlbGxlciwgdWludDI1NiBhbW91bnRPZlRva2Vuc1RvU2VsbCwKICAgICAgICB1aW50MjU2IHRva2Vuc1NvbGQsIHVpbnQyNTYgZXRoZXJWYWx1ZU9mVG9rZW5zU29sZCk7CgogICAgLy8gQ29uc3RydWN0b3IgLSBvbmx5IHRvIGJlIGNhbGxlZCBieSB0aGUgVG9rZW5UcmFkZXJGYWN0b3J5IGNvbnRyYWN0CiAgICBmdW5jdGlvbiBUb2tlblRyYWRlciAoCiAgICAgICAgYWRkcmVzcyBfYXNzZXQsCiAgICAgICAgdWludDI1NiBfZXhjaEZlZSwKICAgICAgICBhZGRyZXNzIF9leGNoYW5nZSwKICAgICAgICB1aW50MjU2IF9idXlQcmljZSwKICAgICAgICB1aW50MjU2IF9zZWxsUHJpY2UsCiAgICAgICAgdWludDI1NiBfdW5pdHMsCiAgICAgICAgYm9vbCAgICBfYnV5c1Rva2VucywKICAgICAgICBib29sICAgIF9zZWxsc1Rva2VucwogICAgKSAKICAgIHsKICAgICAgICBhc3NldCAgICAgICA9IF9hc3NldDsKICAgICAgICBleGNoRmVlICAgICA9IF9leGNoRmVlOwogICAgICAgIGV4Y2hhbmdlICAgID0gX2V4Y2hhbmdlOwogICAgICAgIGJ1eVByaWNlICAgID0gX2J1eVByaWNlOwogICAgICAgIHNlbGxQcmljZSAgID0gX3NlbGxQcmljZTsKICAgICAgICB1bml0cyAgICAgICA9IF91bml0czsKICAgICAgICBidXlzVG9rZW5zICA9IF9idXlzVG9rZW5zOwogICAgICAgIHNlbGxzVG9rZW5zID0gX3NlbGxzVG9rZW5zOwogICAgICAgIEFjdGl2YXRlZEV2ZW50KGJ1eXNUb2tlbnMsIHNlbGxzVG9rZW5zKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhY3RpdmF0ZSAoCiAgICAgICAgYWRkcmVzcyBfYXNzZXQsCiAgICAgICAgdWludDI1NiBfZXhjaEZlZSwKICAgICAgICBhZGRyZXNzIF9leGNoYW5nZSwKICAgICAgICB1aW50MjU2IF9idXlQcmljZSwKICAgICAgICB1aW50MjU2IF9zZWxsUHJpY2UsCiAgICAgICAgdWludDI1NiBfdW5pdHMsCiAgICAgICAgYm9vbCAgICBfYnV5c1Rva2VucywKICAgICAgICBib29sICAgIF9zZWxsc1Rva2VucwogICAgKSBvbmx5T3duZXIgCiAgICB7CiAgICAgICAgcmVxdWlyZShFUkNUVyhleGNoYW5nZSkudHJhbnNmZXJGcm9tKG93bmVyLCBleGNoYW5nZSwgZXhjaEZlZSkpOwogICAgICAgIGFzc2V0ICAgICAgID0gX2Fzc2V0OwogICAgICAgIGV4Y2hGZWUgICAgID0gX2V4Y2hGZWU7CiAgICAgICAgZXhjaGFuZ2UgICAgPSBfZXhjaGFuZ2U7CiAgICAgICAgYnV5UHJpY2UgICAgPSBfYnV5UHJpY2U7CiAgICAgICAgc2VsbFByaWNlICAgPSBfc2VsbFByaWNlOwogICAgICAgIHVuaXRzICAgICAgID0gX3VuaXRzOwogICAgICAgIGJ1eXNUb2tlbnMgID0gX2J1eXNUb2tlbnM7CiAgICAgICAgc2VsbHNUb2tlbnMgPSBfc2VsbHNUb2tlbnM7CiAgICAgICAgQWN0aXZhdGVkRXZlbnQoYnV5c1Rva2Vucywgc2VsbHNUb2tlbnMpOwogICAgfQoKICAgIGZ1bmN0aW9uIG1ha2VyRGVwb3NpdEV0aGVyKCkgcGF5YWJsZSBvbmx5T3duZXJPclRva2VuVHJhZGVyV2l0aFNhbWVPd25lciAKICAgIHsKICAgICAgICByZXF1aXJlKEVSQ1RXKGV4Y2hhbmdlKS50cmFuc2ZlckZyb20odGhpcywgZXhjaGFuZ2UsIGV4Y2hGZWUpKTsKICAgICAgICBNYWtlckRlcG9zaXRlZEV0aGVyKG1zZy52YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gbWFrZXJXaXRoZHJhd0Fzc2V0KHVpbnQyNTYgdG9rZW5zKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBvaykgCiAgICB7CiAgICAgICAgcmVxdWlyZShFUkNUVyhleGNoYW5nZSkudHJhbnNmZXJGcm9tKHRoaXMsIGV4Y2hhbmdlLCBleGNoRmVlKSk7CiAgICAgICAgTWFrZXJXaXRoZHJld0Fzc2V0KHRva2Vucyk7CiAgICAgICAgcmV0dXJuIEVSQ1RXKGFzc2V0KS50cmFuc2Zlcihvd25lciwgdG9rZW5zKTsKICAgIH0KCiAgICBmdW5jdGlvbiBtYWtlclRyYW5zZmVyQXNzZXQoCiAgICAgICAgVG9rZW5UcmFkZXIgdG9Ub2tlblRyYWRlciwKICAgICAgICB1aW50MjU2IHRva2VucwogICAgKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBvaykgCiAgICB7CiAgICAgICAgcmVxdWlyZShFUkNUVyhleGNoYW5nZSkudHJhbnNmZXJGcm9tKHRoaXMsIGV4Y2hhbmdlLCBleGNoRmVlKSk7CiAgICAgICAgcmVxdWlyZSAob3duZXIgPT0gdG9Ub2tlblRyYWRlci5vd25lcigpICYmIGFzc2V0ID09IHRvVG9rZW5UcmFkZXIuYXNzZXQoKSk7IAogICAgICAgIE1ha2VyVHJhbnNmZXJyZWRBc3NldCh0b1Rva2VuVHJhZGVyLCB0b2tlbnMpOwogICAgICAgIHJldHVybiBFUkNUVyhhc3NldCkudHJhbnNmZXIodG9Ub2tlblRyYWRlciwgdG9rZW5zKTsKICAgIH0KCiAgICBmdW5jdGlvbiBtYWtlcldpdGhkcmF3RVJDMjBUb2tlbigKICAgICAgICBhZGRyZXNzIHRva2VuQWRkcmVzcywKICAgICAgICB1aW50MjU2IHRva2VucwogICAgKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBvaykgCiAgICB7CiAgICAgICAgcmVxdWlyZShFUkNUVyhleGNoYW5nZSkudHJhbnNmZXJGcm9tKHRoaXMsIGV4Y2hhbmdlLCBleGNoRmVlKSk7CiAgICAgICAgTWFrZXJXaXRoZHJld0VSQzIwVG9rZW4odG9rZW5BZGRyZXNzLCB0b2tlbnMpOwogICAgICAgIHJldHVybiBFUkNUVyh0b2tlbkFkZHJlc3MpLnRyYW5zZmVyKG93bmVyLCB0b2tlbnMpOwogICAgfQoKICAgIGZ1bmN0aW9uIG1ha2VyV2l0aGRyYXdFdGhlcih1aW50MjU2IGV0aGVycykgb25seU93bmVyIHJldHVybnMgKGJvb2wgb2spIAogICAgewogICAgICAgIHJlcXVpcmUoRVJDVFcoZXhjaGFuZ2UpLnRyYW5zZmVyRnJvbSh0aGlzLCBleGNoYW5nZSwgZXhjaEZlZSkpOwogICAgICAgIGlmICh0aGlzLmJhbGFuY2UgPj0gZXRoZXJzKSAKICAgICAgICB7CiAgICAgICAgICAgIE1ha2VyV2l0aGRyZXdFdGhlcihldGhlcnMpOwogICAgICAgICAgICByZXR1cm4gb3duZXIuc2VuZChldGhlcnMpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBtYWtlclRyYW5zZmVyRXRoZXIoCiAgICAgICAgVG9rZW5UcmFkZXIgdG9Ub2tlblRyYWRlciwKICAgICAgICB1aW50MjU2IGV0aGVycwogICAgKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgCiAgICB7CiAgICAgICAgcmVxdWlyZShFUkNUVyhleGNoYW5nZSkudHJhbnNmZXJGcm9tKHRoaXMsIGV4Y2hhbmdlLCBleGNoRmVlKSk7CiAgICAgICAgcmVxdWlyZSAob3duZXIgPT0gdG9Ub2tlblRyYWRlci5vd25lcigpICYmIGFzc2V0ID09IHRvVG9rZW5UcmFkZXIuYXNzZXQoKSk7IAogICAgICAgIGlmICh0aGlzLmJhbGFuY2UgPj0gZXRoZXJzKSAKICAgICAgICB7CiAgICAgICAgICAgIE1ha2VyVHJhbnNmZXJyZWRFdGhlcih0b1Rva2VuVHJhZGVyLCBldGhlcnMpOwogICAgICAgICAgICB0b1Rva2VuVHJhZGVyLm1ha2VyRGVwb3NpdEV0aGVyLnZhbHVlKGV0aGVycykoKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdGFrZXJCdXlBc3NldCgpIHBheWFibGUgCiAgICB7CiAgICAgICAgcmVxdWlyZShFUkNUVyhleGNoYW5nZSkudHJhbnNmZXJGcm9tKHRoaXMsIGV4Y2hhbmdlLCBleGNoRmVlKSk7CiAgICAgICAgaWYgKHNlbGxzVG9rZW5zIHx8IG1zZy5zZW5kZXIgPT0gb3duZXIpIAogICAgICAgIHsKICAgICAgICAgICAgdWludCBvcmRlciAgICA9IG1zZy52YWx1ZSAvIHNlbGxQcmljZTsKICAgICAgICAgICAgdWludCBjYW5fc2VsbCA9IEVSQ1RXKGFzc2V0KS5iYWxhbmNlT2YoYWRkcmVzcyh0aGlzKSkgLyB1bml0czsKICAgICAgICAgICAgdWludDI1NiBjaGFuZ2UgPSAwOwogICAgICAgICAgICBpZiAobXNnLnZhbHVlID4gKGNhbl9zZWxsICogc2VsbFByaWNlKSkgCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGNoYW5nZSAgPSBtc2cudmFsdWUgLSAoY2FuX3NlbGwgKiBzZWxsUHJpY2UpOwogICAgICAgICAgICAgICAgb3JkZXIgPSBjYW5fc2VsbDsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoY2hhbmdlID4gMCkgCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHJlcXVpcmUobXNnLnNlbmRlci5zZW5kKGNoYW5nZSkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChvcmRlciA+IDApIAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXF1aXJlIChFUkNUVyhhc3NldCkudHJhbnNmZXIobXNnLnNlbmRlciwgb3JkZXIgKiB1bml0cykpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFRha2VyQm91Z2h0QXNzZXQobXNnLnNlbmRlciwgbXNnLnZhbHVlLCBjaGFuZ2UsIG9yZGVyICogdW5pdHMpOwogICAgICAgIH0KICAgICAgICBlbHNlIHJlcXVpcmUgKG1zZy5zZW5kZXIuc2VuZChtc2cudmFsdWUpKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0YWtlclNlbGxBc3NldCh1aW50MjU2IGFtb3VudE9mVG9rZW5zVG9TZWxsKSBwdWJsaWMgIAogICAgewogICAgICAgIHJlcXVpcmUoRVJDVFcoZXhjaGFuZ2UpLnRyYW5zZmVyRnJvbSh0aGlzLCBleGNoYW5nZSwgZXhjaEZlZSkpOwogICAgICAgIGlmIChidXlzVG9rZW5zIHx8IG1zZy5zZW5kZXIgPT0gb3duZXIpIAogICAgICAgIHsKICAgICAgICAgICAgdWludDI1NiBjYW5fYnV5ID0gdGhpcy5iYWxhbmNlIC8gYnV5UHJpY2U7CiAgICAgICAgICAgIHVpbnQyNTYgb3JkZXIgPSBhbW91bnRPZlRva2Vuc1RvU2VsbCAvIHVuaXRzOwogICAgICAgICAgICBpZiAob3JkZXIgPiBjYW5fYnV5KSBvcmRlciA9IGNhbl9idXk7CiAgICAgICAgICAgIGlmIChvcmRlciA+IDApIAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXF1aXJlKEVSQ1RXKGFzc2V0KS50cmFuc2ZlckZyb20obXNnLnNlbmRlciwgYWRkcmVzcyh0aGlzKSwgb3JkZXIgKiB1bml0cykpOwogICAgICAgICAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyLnNlbmQob3JkZXIgKiBidXlQcmljZSkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFRha2VyU29sZEFzc2V0KG1zZy5zZW5kZXIsIGFtb3VudE9mVG9rZW5zVG9TZWxsLCBvcmRlciAqIHVuaXRzLCBvcmRlciAqIGJ1eVByaWNlKTsKICAgICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiAoKSBwYXlhYmxlIAogICAgewogICAgICAgIHRha2VyQnV5QXNzZXQoKTsKICAgIH0KfQ=='.
	

]
