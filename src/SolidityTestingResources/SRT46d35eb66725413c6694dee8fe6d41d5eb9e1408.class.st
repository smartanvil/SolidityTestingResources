Class {
	#name : #SRT46d35eb66725413c6694dee8fe6d41d5eb9e1408,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT46d35eb66725413c6694dee8fe6d41d5eb9e1408 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjA7CgovKgoqIFRlYW0gUEFQQSBBTkQgRlJJRU5EUyBwcmVzZW50cy4uLgoqIGRhbmtjb2luLnN1cmdlLnNoCiogaHR0cHM6Ly9kaXNjb3JkLmdnL05lMlBUblMKKiAKKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09KgoqICAgICAgIF9fXyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiogICAgICB8ICAgIFwgICAgICAgICB8ICAgICAgfFwgICAgIHwgIHwgIC8gICAgICAgICoKKiAgICAgIHwgICAgIFwgICAgICAgfCB8ICAgICB8IFwgICAgfCAgfCAvICAgICAgICAgKgoqICAgICAgfCAgICAgIHwgICAgIHwgICB8ICAgIHwgIFwgICB8ICB8LyAgICAgICAgICAqCiogICAgICB8ICAgICAgLyAgICB8X19fX198ICAgfCAgIFwgIHwgIHxcICAgICAgICAgICoKKiAgICAgIHwgICAgIC8gICAgfCAgICAgICB8ICB8ICAgIFwgfCAgfCBcICAgICAgICAgKgoqICAgICAgfF9fX18vICAgIHwgICAgICAgICB8IHwgICAgIFx8ICB8ICBcICAgICAgICAqCiogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09KgoqCiogREFOSyBDT0lOCiogSm9pbiB1cyB0byB0aGUgTU9PT09PT09PT05ORVQhCioKKiAtPiBXaGF0PwoqIEluY29ycG9yYXRlZCB0aGUgc3Ryb25nIHBvaW50cyBvZiBkaWZmZXJlbnQgUE9Xe3h9LCBiZXN0IGNvbmZpZzoKKiBb4pyTXSAyMCUgZGl2aWRlbmRzIGZvciB0b2tlbiBwdXJjaGFzZSwgc2hhcmVkIGFtb25nIGFsbCB0b2tlbiBob2xkZXJzLgoqIFvinJNdIDEwJSBkaXZpZGVuZHMgZm9yIHRva2VuIHRyYW5zZmVyLCBzaGFyZWQgYW1vbmcgYWxsIHRva2VuIGhvbGRlcnMuCiogW+Kck10gMjUlIGRpdmlkZW5kcyBmb3IgdG9rZW4gc2VsbGluZy4KKiBb4pyTXSA3JSBkaXZpZGVuZHMgaXMgZ2l2ZW4gdG8gcmVmZXJyZXIuCiogW+Kck10gNTAgdG9rZW5zIHRvIGFjdGl2YXRlIE1hc3Rlcm5vZGVzLgoqCiovCgpjb250cmFjdCBEYW5rQ29pbiB7CgoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICA9ICAgICAgICAgICAgTU9ESUZJRVJTICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KCiAgICAvLy8gQGRldiBPbmx5IHBlb3BsZSB3aXRoIHRva2VucwogICAgbW9kaWZpZXIgb25seUJhZ2hvbGRlcnMgewogICAgICAgIHJlcXVpcmUobXlUb2tlbnMoKSA+IDApOwogICAgICAgIF87CiAgICB9CgogICAgLy8vIEBkZXYgT25seSBwZW9wbGUgd2l0aCBwcm9maXRzCiAgICBtb2RpZmllciBvbmx5U3Ryb25naGFuZHMgewogICAgICAgIHJlcXVpcmUobXlEaXZpZGVuZHModHJ1ZSkgPiAwKTsKICAgICAgICBfOwogICAgfQoKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgPSAgICAgICAgICAgIEVWRU5UUyAgICAgICAgICAgID0KICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCgogICAgZXZlbnQgb25Ub2tlblB1cmNoYXNlKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBjdXN0b21lckFkZHJlc3MsCiAgICAgICAgdWludDI1NiBpbmNvbWluZ0V0aGVyZXVtLAogICAgICAgIHVpbnQyNTYgdG9rZW5zTWludGVkLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCByZWZlcnJlZEJ5LAogICAgICAgIHVpbnQgdGltZXN0YW1wLAogICAgICAgIHVpbnQyNTYgcHJpY2UKICAgICk7CgogICAgZXZlbnQgb25Ub2tlblNlbGwoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIGN1c3RvbWVyQWRkcmVzcywKICAgICAgICB1aW50MjU2IHRva2Vuc0J1cm5lZCwKICAgICAgICB1aW50MjU2IGV0aGVyZXVtRWFybmVkLAogICAgICAgIHVpbnQgdGltZXN0YW1wLAogICAgICAgIHVpbnQyNTYgcHJpY2UKICAgICk7CgogICAgZXZlbnQgb25SZWludmVzdG1lbnQoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIGN1c3RvbWVyQWRkcmVzcywKICAgICAgICB1aW50MjU2IGV0aGVyZXVtUmVpbnZlc3RlZCwKICAgICAgICB1aW50MjU2IHRva2Vuc01pbnRlZAogICAgKTsKCiAgICBldmVudCBvbldpdGhkcmF3KAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBjdXN0b21lckFkZHJlc3MsCiAgICAgICAgdWludDI1NiBldGhlcmV1bVdpdGhkcmF3bgogICAgKTsKCiAgICAvLyBFUkMyMAogICAgZXZlbnQgVHJhbnNmZXIoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIGZyb20sCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIHRvLAogICAgICAgIHVpbnQyNTYgdG9rZW5zCiAgICApOwoKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgID0gICAgICAgICAgICBDT05GSUdVUkFCTEVTICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCgogICAgc3RyaW5nIHB1YmxpYyBuYW1lID0gIkRhbmtDb2luIjsKICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIkRBTksiOwogICAgdWludDggY29uc3RhbnQgcHVibGljIGRlY2ltYWxzID0gMTg7CgogICAgLy8vIEBkZXYgMTUlIGRpdmlkZW5kcyBmb3IgdG9rZW4gcHVyY2hhc2UKICAgIHVpbnQ4IGNvbnN0YW50IGludGVybmFsIGVudHJ5RmVlXyA9IDIwOwoKICAgIC8vLyBAZGV2IDEwJSBkaXZpZGVuZHMgZm9yIHRva2VuIHRyYW5zZmVyCiAgICB1aW50OCBjb25zdGFudCBpbnRlcm5hbCB0cmFuc2ZlckZlZV8gPSAxMDsKCiAgICAvLy8gQGRldiAyNSUgZGl2aWRlbmRzIGZvciB0b2tlbiBzZWxsaW5nCiAgICB1aW50OCBjb25zdGFudCBpbnRlcm5hbCBleGl0RmVlXyA9IDI1OwoKICAgIC8vLyBAZGV2IDM1JSBvZiBlbnRyeUZlZV8gKGkuZS4gNyUgZGl2aWRlbmRzKSBpcyBnaXZlbiB0byByZWZlcnJlcgogICAgdWludDggY29uc3RhbnQgaW50ZXJuYWwgcmVmZmVyYWxGZWVfID0gMzU7CgogICAgdWludDI1NiBjb25zdGFudCBpbnRlcm5hbCB0b2tlblByaWNlSW5pdGlhbF8gPSAwLjAwMDAwMDEgZXRoZXI7CiAgICB1aW50MjU2IGNvbnN0YW50IGludGVybmFsIHRva2VuUHJpY2VJbmNyZW1lbnRhbF8gPSAwLjAwMDAwMDAxIGV0aGVyOwogICAgdWludDI1NiBjb25zdGFudCBpbnRlcm5hbCBtYWduaXR1ZGUgPSAyICoqIDY0OwoKICAgIC8vLyBAZGV2IHByb29mIG9mIHN0YWtlIChkZWZhdWx0cyBhdCA1MCB0b2tlbnMpCiAgICB1aW50MjU2IHB1YmxpYyBzdGFraW5nUmVxdWlyZW1lbnQgPSA1MGUxODsKCgogICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgPSAgICAgICAgICAgIERBVEFTRVRTICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwoKICAgIC8vIGFtb3VudCBvZiBzaGFyZXMgZm9yIGVhY2ggYWRkcmVzcyAoc2NhbGVkIG51bWJlcikKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBpbnRlcm5hbCB0b2tlbkJhbGFuY2VMZWRnZXJfOwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGludGVybmFsIHJlZmVycmFsQmFsYW5jZV87CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gaW50MjU2KSBpbnRlcm5hbCBwYXlvdXRzVG9fOwogICAgdWludDI1NiBpbnRlcm5hbCB0b2tlblN1cHBseV87CiAgICB1aW50MjU2IGludGVybmFsIHByb2ZpdFBlclNoYXJlXzsKCgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgID0gICAgICAgICAgICBQVUJMSUMgRlVOQ1RJT05TICAgICAgICAgICA9CiAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwoKICAgIC8vLyBAZGV2IENvbnZlcnRzIGFsbCBpbmNvbWluZyBldGhlcmV1bSB0byB0b2tlbnMgZm9yIHRoZSBjYWxsZXIsIGFuZCBwYXNzZXMgZG93biB0aGUgcmVmZXJyYWwgYWRkeSAoaWYgYW55KQogICAgZnVuY3Rpb24gYnV5KGFkZHJlc3MgX3JlZmVycmVkQnkpIHB1YmxpYyBwYXlhYmxlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBwdXJjaGFzZVRva2Vucyhtc2cudmFsdWUsIF9yZWZlcnJlZEJ5KTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgRmFsbGJhY2sgZnVuY3Rpb24gdG8gaGFuZGxlIGV0aGVyZXVtIHRoYXQgd2FzIHNlbmQgc3RyYWlnaHQgdG8gdGhlIGNvbnRyYWN0CiAgICAgKiAgVW5mb3J0dW5hdGVseSB3ZSBjYW5ub3QgdXNlIGEgcmVmZXJyYWwgYWRkcmVzcyB0aGlzIHdheS4KICAgICAqLwogICAgZnVuY3Rpb24oKSBwYXlhYmxlIHB1YmxpYyB7CiAgICAgICAgcHVyY2hhc2VUb2tlbnMobXNnLnZhbHVlLCAweDApOwogICAgfQoKICAgIC8vLyBAZGV2IENvbnZlcnRzIGFsbCBvZiBjYWxsZXIncyBkaXZpZGVuZHMgdG8gdG9rZW5zLgogICAgZnVuY3Rpb24gcmVpbnZlc3QoKSBvbmx5U3Ryb25naGFuZHMgcHVibGljIHsKICAgICAgICAvLyBmZXRjaCBkaXZpZGVuZHMKICAgICAgICB1aW50MjU2IF9kaXZpZGVuZHMgPSBteURpdmlkZW5kcyhmYWxzZSk7IC8vIHJldHJpZXZlIHJlZi4gYm9udXMgbGF0ZXIgaW4gdGhlIGNvZGUKCiAgICAgICAgLy8gcGF5IG91dCB0aGUgZGl2aWRlbmRzIHZpcnR1YWxseQogICAgICAgIGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgcGF5b3V0c1RvX1tfY3VzdG9tZXJBZGRyZXNzXSArPSAgKGludDI1NikgKF9kaXZpZGVuZHMgKiBtYWduaXR1ZGUpOwoKICAgICAgICAvLyByZXRyaWV2ZSByZWYuIGJvbnVzCiAgICAgICAgX2RpdmlkZW5kcyArPSByZWZlcnJhbEJhbGFuY2VfW19jdXN0b21lckFkZHJlc3NdOwogICAgICAgIHJlZmVycmFsQmFsYW5jZV9bX2N1c3RvbWVyQWRkcmVzc10gPSAwOwoKICAgICAgICAvLyBkaXNwYXRjaCBhIGJ1eSBvcmRlciB3aXRoIHRoZSB2aXJ0dWFsaXplZCAid2l0aGRyYXduIGRpdmlkZW5kcyIKICAgICAgICB1aW50MjU2IF90b2tlbnMgPSBwdXJjaGFzZVRva2VucyhfZGl2aWRlbmRzLCAweDApOwoKICAgICAgICAvLyBmaXJlIGV2ZW50CiAgICAgICAgb25SZWludmVzdG1lbnQoX2N1c3RvbWVyQWRkcmVzcywgX2RpdmlkZW5kcywgX3Rva2Vucyk7CiAgICB9CgogICAgLy8vIEBkZXYgQWxpYXMgb2Ygc2VsbCgpIGFuZCB3aXRoZHJhdygpLgogICAgZnVuY3Rpb24gZXhpdCgpIHB1YmxpYyB7CiAgICAgICAgLy8gZ2V0IHRva2VuIGNvdW50IGZvciBjYWxsZXIgJiBzZWxsIHRoZW0gYWxsCiAgICAgICAgYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICB1aW50MjU2IF90b2tlbnMgPSB0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdOwogICAgICAgIGlmIChfdG9rZW5zID4gMCkgc2VsbChfdG9rZW5zKTsKCiAgICAgICAgLy8gbGFtYm8gZGVsaXZlcnkgc2VydmljZQogICAgICAgIHdpdGhkcmF3KCk7CiAgICB9CgogICAgLy8vIEBkZXYgV2l0aGRyYXdzIGFsbCBvZiB0aGUgY2FsbGVycyBlYXJuaW5ncy4KICAgIGZ1bmN0aW9uIHdpdGhkcmF3KCkgb25seVN0cm9uZ2hhbmRzIHB1YmxpYyB7CiAgICAgICAgLy8gc2V0dXAgZGF0YQogICAgICAgIGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gbXlEaXZpZGVuZHMoZmFsc2UpOyAvLyBnZXQgcmVmLiBib251cyBsYXRlciBpbiB0aGUgY29kZQoKICAgICAgICAvLyB1cGRhdGUgZGl2aWRlbmQgdHJhY2tlcgogICAgICAgIHBheW91dHNUb19bX2N1c3RvbWVyQWRkcmVzc10gKz0gKGludDI1NikgKF9kaXZpZGVuZHMgKiBtYWduaXR1ZGUpOwoKICAgICAgICAvLyBhZGQgcmVmLiBib251cwogICAgICAgIF9kaXZpZGVuZHMgKz0gcmVmZXJyYWxCYWxhbmNlX1tfY3VzdG9tZXJBZGRyZXNzXTsKICAgICAgICByZWZlcnJhbEJhbGFuY2VfW19jdXN0b21lckFkZHJlc3NdID0gMDsKCiAgICAgICAgLy8gbGFtYm8gZGVsaXZlcnkgc2VydmljZQogICAgICAgIF9jdXN0b21lckFkZHJlc3MudHJhbnNmZXIoX2RpdmlkZW5kcyk7CgogICAgICAgIC8vIGZpcmUgZXZlbnQKICAgICAgICBvbldpdGhkcmF3KF9jdXN0b21lckFkZHJlc3MsIF9kaXZpZGVuZHMpOwogICAgfQoKICAgIC8vLyBAZGV2IExpcXVpZmllcyB0b2tlbnMgdG8gZXRoZXJldW0uCiAgICBmdW5jdGlvbiBzZWxsKHVpbnQyNTYgX2Ftb3VudE9mVG9rZW5zKSBvbmx5QmFnaG9sZGVycyBwdWJsaWMgewogICAgICAgIC8vIHNldHVwIGRhdGEKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIC8vIHJ1c3NpYW4gaGFja2VycyBCVEZPCiAgICAgICAgcmVxdWlyZShfYW1vdW50T2ZUb2tlbnMgPD0gdG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSk7CiAgICAgICAgdWludDI1NiBfdG9rZW5zID0gX2Ftb3VudE9mVG9rZW5zOwogICAgICAgIHVpbnQyNTYgX2V0aGVyZXVtID0gdG9rZW5zVG9FdGhlcmV1bV8oX3Rva2Vucyk7CiAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChfZXRoZXJldW0sIGV4aXRGZWVfKSwgMTAwKTsKICAgICAgICB1aW50MjU2IF90YXhlZEV0aGVyZXVtID0gU2FmZU1hdGguc3ViKF9ldGhlcmV1bSwgX2RpdmlkZW5kcyk7CgogICAgICAgIC8vIGJ1cm4gdGhlIHNvbGQgdG9rZW5zCiAgICAgICAgdG9rZW5TdXBwbHlfID0gU2FmZU1hdGguc3ViKHRva2VuU3VwcGx5XywgX3Rva2Vucyk7CiAgICAgICAgdG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSA9IFNhZmVNYXRoLnN1Yih0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdLCBfdG9rZW5zKTsKCiAgICAgICAgLy8gdXBkYXRlIGRpdmlkZW5kcyB0cmFja2VyCiAgICAgICAgaW50MjU2IF91cGRhdGVkUGF5b3V0cyA9IChpbnQyNTYpIChwcm9maXRQZXJTaGFyZV8gKiBfdG9rZW5zICsgKF90YXhlZEV0aGVyZXVtICogbWFnbml0dWRlKSk7CiAgICAgICAgcGF5b3V0c1RvX1tfY3VzdG9tZXJBZGRyZXNzXSAtPSBfdXBkYXRlZFBheW91dHM7CgogICAgICAgIC8vIGRpdmlkaW5nIGJ5IHplcm8gaXMgYSBiYWQgaWRlYQogICAgICAgIGlmICh0b2tlblN1cHBseV8gPiAwKSB7CiAgICAgICAgICAgIC8vIHVwZGF0ZSB0aGUgYW1vdW50IG9mIGRpdmlkZW5kcyBwZXIgdG9rZW4KICAgICAgICAgICAgcHJvZml0UGVyU2hhcmVfID0gU2FmZU1hdGguYWRkKHByb2ZpdFBlclNoYXJlXywgKF9kaXZpZGVuZHMgKiBtYWduaXR1ZGUpIC8gdG9rZW5TdXBwbHlfKTsKICAgICAgICB9CgogICAgICAgIC8vIGZpcmUgZXZlbnQKICAgICAgICBvblRva2VuU2VsbChfY3VzdG9tZXJBZGRyZXNzLCBfdG9rZW5zLCBfdGF4ZWRFdGhlcmV1bSwgbm93LCBidXlQcmljZSgpKTsKICAgIH0KCgogICAgLyoqCiAgICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIHRoZSBjYWxsZXIgdG8gYSBuZXcgaG9sZGVyLgogICAgICogIFJlbWVtYmVyLCB0aGVyZSdzIGEgMTUlIGZlZSBoZXJlIGFzIHdlbGwuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvQWRkcmVzcywgdWludDI1NiBfYW1vdW50T2ZUb2tlbnMpIG9ubHlCYWdob2xkZXJzIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgLy8gc2V0dXAKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwoKICAgICAgICAvLyBtYWtlIHN1cmUgd2UgaGF2ZSB0aGUgcmVxdWVzdGVkIHRva2VucwogICAgICAgIHJlcXVpcmUoX2Ftb3VudE9mVG9rZW5zIDw9IHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc10pOwoKICAgICAgICAvLyB3aXRoZHJhdyBhbGwgb3V0c3RhbmRpbmcgZGl2aWRlbmRzIGZpcnN0CiAgICAgICAgaWYgKG15RGl2aWRlbmRzKHRydWUpID4gMCkgewogICAgICAgICAgICB3aXRoZHJhdygpOwogICAgICAgIH0KCiAgICAgICAgLy8gbGlxdWlmeSAxMCUgb2YgdGhlIHRva2VucyB0aGF0IGFyZSB0cmFuc2ZlcmVkCiAgICAgICAgLy8gdGhlc2UgYXJlIGRpc3BlcnNlZCB0byBzaGFyZWhvbGRlcnMKICAgICAgICB1aW50MjU2IF90b2tlbkZlZSA9IFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoX2Ftb3VudE9mVG9rZW5zLCB0cmFuc2ZlckZlZV8pLCAxMDApOwogICAgICAgIHVpbnQyNTYgX3RheGVkVG9rZW5zID0gU2FmZU1hdGguc3ViKF9hbW91bnRPZlRva2VucywgX3Rva2VuRmVlKTsKICAgICAgICB1aW50MjU2IF9kaXZpZGVuZHMgPSB0b2tlbnNUb0V0aGVyZXVtXyhfdG9rZW5GZWUpOwoKICAgICAgICAvLyBidXJuIHRoZSBmZWUgdG9rZW5zCiAgICAgICAgdG9rZW5TdXBwbHlfID0gU2FmZU1hdGguc3ViKHRva2VuU3VwcGx5XywgX3Rva2VuRmVlKTsKCiAgICAgICAgLy8gZXhjaGFuZ2UgdG9rZW5zCiAgICAgICAgdG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSA9IFNhZmVNYXRoLnN1Yih0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdLCBfYW1vdW50T2ZUb2tlbnMpOwogICAgICAgIHRva2VuQmFsYW5jZUxlZGdlcl9bX3RvQWRkcmVzc10gPSBTYWZlTWF0aC5hZGQodG9rZW5CYWxhbmNlTGVkZ2VyX1tfdG9BZGRyZXNzXSwgX3RheGVkVG9rZW5zKTsKCiAgICAgICAgLy8gdXBkYXRlIGRpdmlkZW5kIHRyYWNrZXJzCiAgICAgICAgcGF5b3V0c1RvX1tfY3VzdG9tZXJBZGRyZXNzXSAtPSAoaW50MjU2KSAocHJvZml0UGVyU2hhcmVfICogX2Ftb3VudE9mVG9rZW5zKTsKICAgICAgICBwYXlvdXRzVG9fW190b0FkZHJlc3NdICs9IChpbnQyNTYpIChwcm9maXRQZXJTaGFyZV8gKiBfdGF4ZWRUb2tlbnMpOwoKICAgICAgICAvLyBkaXNwZXJzZSBkaXZpZGVuZHMgYW1vbmcgaG9sZGVycwogICAgICAgIHByb2ZpdFBlclNoYXJlXyA9IFNhZmVNYXRoLmFkZChwcm9maXRQZXJTaGFyZV8sIChfZGl2aWRlbmRzICogbWFnbml0dWRlKSAvIHRva2VuU3VwcGx5Xyk7CgogICAgICAgIC8vIGZpcmUgZXZlbnQKICAgICAgICBUcmFuc2ZlcihfY3VzdG9tZXJBZGRyZXNzLCBfdG9BZGRyZXNzLCBfdGF4ZWRUb2tlbnMpOwoKICAgICAgICAvLyBFUkMyMAogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgID0gICAgICBIRUxQRVJTIEFORCBDQUxDVUxBVE9SUyAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCgogICAgLyoqCiAgICAgKiBAZGV2IE1ldGhvZCB0byB2aWV3IHRoZSBjdXJyZW50IEV0aGVyZXVtIHN0b3JlZCBpbiB0aGUgY29udHJhY3QKICAgICAqICBFeGFtcGxlOiB0b3RhbEV0aGVyZXVtQmFsYW5jZSgpCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRvdGFsRXRoZXJldW1CYWxhbmNlKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiB0aGlzLmJhbGFuY2U7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0cmlldmUgdGhlIHRvdGFsIHRva2VuIHN1cHBseS4KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiB0b2tlblN1cHBseV87CiAgICB9CgogICAgLy8vIEBkZXYgUmV0cmlldmUgdGhlIHRva2VucyBvd25lZCBieSB0aGUgY2FsbGVyLgogICAgZnVuY3Rpb24gbXlUb2tlbnMoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICByZXR1cm4gYmFsYW5jZU9mKF9jdXN0b21lckFkZHJlc3MpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBSZXRyaWV2ZSB0aGUgZGl2aWRlbmRzIG93bmVkIGJ5IHRoZSBjYWxsZXIuCiAgICAgKiAgSWYgYF9pbmNsdWRlUmVmZXJyYWxCb251c2AgaXMgdG8gdG8gMS90cnVlLCB0aGUgcmVmZXJyYWwgYm9udXMgd2lsbCBiZSBpbmNsdWRlZCBpbiB0aGUgY2FsY3VsYXRpb25zLgogICAgICogIFRoZSByZWFzb24gZm9yIHRoaXMsIGlzIHRoYXQgaW4gdGhlIGZyb250ZW5kLCB3ZSB3aWxsIHdhbnQgdG8gZ2V0IHRoZSB0b3RhbCBkaXZzIChnbG9iYWwgKyByZWYpCiAgICAgKiAgQnV0IGluIHRoZSBpbnRlcm5hbCBjYWxjdWxhdGlvbnMsIHdlIHdhbnQgdGhlbSBzZXBhcmF0ZS4KICAgICAqLwogICAgZnVuY3Rpb24gbXlEaXZpZGVuZHMoYm9vbCBfaW5jbHVkZVJlZmVycmFsQm9udXMpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIHJldHVybiBfaW5jbHVkZVJlZmVycmFsQm9udXMgPyBkaXZpZGVuZHNPZihfY3VzdG9tZXJBZGRyZXNzKSArIHJlZmVycmFsQmFsYW5jZV9bX2N1c3RvbWVyQWRkcmVzc10gOiBkaXZpZGVuZHNPZihfY3VzdG9tZXJBZGRyZXNzKSA7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0cmlldmUgdGhlIHRva2VuIGJhbGFuY2Ugb2YgYW55IHNpbmdsZSBhZGRyZXNzLgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcykgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiB0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdOwogICAgfQoKICAgIC8vLyBAZGV2IFJldHJpZXZlIHRoZSBkaXZpZGVuZCBiYWxhbmNlIG9mIGFueSBzaW5nbGUgYWRkcmVzcy4KICAgIGZ1bmN0aW9uIGRpdmlkZW5kc09mKGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcykgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiAodWludDI1NikgKChpbnQyNTYpIChwcm9maXRQZXJTaGFyZV8gKiB0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdKSAtIHBheW91dHNUb19bX2N1c3RvbWVyQWRkcmVzc10pIC8gbWFnbml0dWRlOwogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybiB0aGUgc2VsbCBwcmljZSBvZiAxIGluZGl2aWR1YWwgdG9rZW4uCiAgICBmdW5jdGlvbiBzZWxsUHJpY2UoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgLy8gb3VyIGNhbGN1bGF0aW9uIHJlbGllcyBvbiB0aGUgdG9rZW4gc3VwcGx5LCBzbyB3ZSBuZWVkIHN1cHBseS4gRG9oLgogICAgICAgIGlmICh0b2tlblN1cHBseV8gPT0gMCkgewogICAgICAgICAgICByZXR1cm4gdG9rZW5QcmljZUluaXRpYWxfIC0gdG9rZW5QcmljZUluY3JlbWVudGFsXzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB1aW50MjU2IF9ldGhlcmV1bSA9IHRva2Vuc1RvRXRoZXJldW1fKDFlMTgpOwogICAgICAgICAgICB1aW50MjU2IF9kaXZpZGVuZHMgPSBTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKF9ldGhlcmV1bSwgZXhpdEZlZV8pLCAxMDApOwogICAgICAgICAgICB1aW50MjU2IF90YXhlZEV0aGVyZXVtID0gU2FmZU1hdGguc3ViKF9ldGhlcmV1bSwgX2RpdmlkZW5kcyk7CgogICAgICAgICAgICByZXR1cm4gX3RheGVkRXRoZXJldW07CiAgICAgICAgfQogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybiB0aGUgYnV5IHByaWNlIG9mIDEgaW5kaXZpZHVhbCB0b2tlbi4KICAgIGZ1bmN0aW9uIGJ1eVByaWNlKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIC8vIG91ciBjYWxjdWxhdGlvbiByZWxpZXMgb24gdGhlIHRva2VuIHN1cHBseSwgc28gd2UgbmVlZCBzdXBwbHkuIERvaC4KICAgICAgICBpZiAodG9rZW5TdXBwbHlfID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIHRva2VuUHJpY2VJbml0aWFsXyArIHRva2VuUHJpY2VJbmNyZW1lbnRhbF87CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdWludDI1NiBfZXRoZXJldW0gPSB0b2tlbnNUb0V0aGVyZXVtXygxZTE4KTsKICAgICAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChfZXRoZXJldW0sIGVudHJ5RmVlXyksIDEwMCk7CiAgICAgICAgICAgIHVpbnQyNTYgX3RheGVkRXRoZXJldW0gPSBTYWZlTWF0aC5hZGQoX2V0aGVyZXVtLCBfZGl2aWRlbmRzKTsKCiAgICAgICAgICAgIHJldHVybiBfdGF4ZWRFdGhlcmV1bTsKICAgICAgICB9CiAgICB9CgogICAgLy8vIEBkZXYgRnVuY3Rpb24gZm9yIHRoZSBmcm9udGVuZCB0byBkeW5hbWljYWxseSByZXRyaWV2ZSB0aGUgcHJpY2Ugc2NhbGluZyBvZiBidXkgb3JkZXJzLgogICAgZnVuY3Rpb24gY2FsY3VsYXRlVG9rZW5zUmVjZWl2ZWQodWludDI1NiBfZXRoZXJldW1Ub1NwZW5kKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChfZXRoZXJldW1Ub1NwZW5kLCBlbnRyeUZlZV8pLCAxMDApOwogICAgICAgIHVpbnQyNTYgX3RheGVkRXRoZXJldW0gPSBTYWZlTWF0aC5zdWIoX2V0aGVyZXVtVG9TcGVuZCwgX2RpdmlkZW5kcyk7CiAgICAgICAgdWludDI1NiBfYW1vdW50T2ZUb2tlbnMgPSBldGhlcmV1bVRvVG9rZW5zXyhfdGF4ZWRFdGhlcmV1bSk7CgogICAgICAgIHJldHVybiBfYW1vdW50T2ZUb2tlbnM7CiAgICB9CgogICAgLy8vIEBkZXYgRnVuY3Rpb24gZm9yIHRoZSBmcm9udGVuZCB0byBkeW5hbWljYWxseSByZXRyaWV2ZSB0aGUgcHJpY2Ugc2NhbGluZyBvZiBzZWxsIG9yZGVycy4KICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZUV0aGVyZXVtUmVjZWl2ZWQodWludDI1NiBfdG9rZW5zVG9TZWxsKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmVxdWlyZShfdG9rZW5zVG9TZWxsIDw9IHRva2VuU3VwcGx5Xyk7CiAgICAgICAgdWludDI1NiBfZXRoZXJldW0gPSB0b2tlbnNUb0V0aGVyZXVtXyhfdG9rZW5zVG9TZWxsKTsKICAgICAgICB1aW50MjU2IF9kaXZpZGVuZHMgPSBTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKF9ldGhlcmV1bSwgZXhpdEZlZV8pLCAxMDApOwogICAgICAgIHVpbnQyNTYgX3RheGVkRXRoZXJldW0gPSBTYWZlTWF0aC5zdWIoX2V0aGVyZXVtLCBfZGl2aWRlbmRzKTsKICAgICAgICByZXR1cm4gX3RheGVkRXRoZXJldW07CiAgICB9CgoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICA9ICAgICAgICAgICAgSU5URVJOQUwgRlVOQ1RJT05TICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KCiAgICAvLy8gQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byBhY3R1YWxseSBwdXJjaGFzZSB0aGUgdG9rZW5zLgogICAgZnVuY3Rpb24gcHVyY2hhc2VUb2tlbnModWludDI1NiBfaW5jb21pbmdFdGhlcmV1bSwgYWRkcmVzcyBfcmVmZXJyZWRCeSkgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgICAgIC8vIGRhdGEgc2V0dXAKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIHVpbnQyNTYgX3VuZGl2aWRlZERpdmlkZW5kcyA9IFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoX2luY29taW5nRXRoZXJldW0sIGVudHJ5RmVlXyksIDEwMCk7CiAgICAgICAgdWludDI1NiBfcmVmZXJyYWxCb251cyA9IFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoX3VuZGl2aWRlZERpdmlkZW5kcywgcmVmZmVyYWxGZWVfKSwgMTAwKTsKICAgICAgICB1aW50MjU2IF9kaXZpZGVuZHMgPSBTYWZlTWF0aC5zdWIoX3VuZGl2aWRlZERpdmlkZW5kcywgX3JlZmVycmFsQm9udXMpOwogICAgICAgIHVpbnQyNTYgX3RheGVkRXRoZXJldW0gPSBTYWZlTWF0aC5zdWIoX2luY29taW5nRXRoZXJldW0sIF91bmRpdmlkZWREaXZpZGVuZHMpOwogICAgICAgIHVpbnQyNTYgX2Ftb3VudE9mVG9rZW5zID0gZXRoZXJldW1Ub1Rva2Vuc18oX3RheGVkRXRoZXJldW0pOwogICAgICAgIHVpbnQyNTYgX2ZlZSA9IF9kaXZpZGVuZHMgKiBtYWduaXR1ZGU7CgogICAgICAgIC8vIG5vIHBvaW50IGluIGNvbnRpbnVpbmcgZXhlY3V0aW9uIGlmIE9QIGlzIGEgcG9vcmZhZyBydXNzaWFuIGhhY2tlcgogICAgICAgIC8vIHByZXZlbnRzIG92ZXJmbG93IGluIHRoZSBjYXNlIHRoYXQgdGhlIHB5cmFtaWQgc29tZWhvdyBtYWdpY2FsbHkgc3RhcnRzIGJlaW5nIHVzZWQgYnkgZXZlcnlvbmUgaW4gdGhlIHdvcmxkCiAgICAgICAgLy8gKG9yIGhhY2tlcnMpCiAgICAgICAgLy8gYW5kIHllcyB3ZSBrbm93IHRoYXQgdGhlIHNhZmVtYXRoIGZ1bmN0aW9uIGF1dG9tYXRpY2FsbHkgcnVsZXMgb3V0IHRoZSAiZ3JlYXRlciB0aGVuIiBlcXVhc2lvbi4KICAgICAgICByZXF1aXJlKF9hbW91bnRPZlRva2VucyA+IDAgJiYgU2FmZU1hdGguYWRkKF9hbW91bnRPZlRva2VucywgdG9rZW5TdXBwbHlfKSA+IHRva2VuU3VwcGx5Xyk7CgogICAgICAgIC8vIGlzIHRoZSB1c2VyIHJlZmVycmVkIGJ5IGEgbWFzdGVybm9kZT8KICAgICAgICBpZiAoCiAgICAgICAgICAgIC8vIGlzIHRoaXMgYSByZWZlcnJlZCBwdXJjaGFzZT8KICAgICAgICAgICAgX3JlZmVycmVkQnkgIT0gMHgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwICYmCgogICAgICAgICAgICAvLyBubyBjaGVhdGluZyEKICAgICAgICAgICAgX3JlZmVycmVkQnkgIT0gX2N1c3RvbWVyQWRkcmVzcyAmJgoKICAgICAgICAgICAgLy8gZG9lcyB0aGUgcmVmZXJyZXIgaGF2ZSBhdCBsZWFzdCBYIHdob2xlIHRva2Vucz8KICAgICAgICAgICAgLy8gaS5lIGlzIHRoZSByZWZlcnJlciBhIGdvZGx5IGNoYWQgbWFzdGVybm9kZQogICAgICAgICAgICB0b2tlbkJhbGFuY2VMZWRnZXJfW19yZWZlcnJlZEJ5XSA+PSBzdGFraW5nUmVxdWlyZW1lbnQKICAgICAgICApIHsKICAgICAgICAgICAgLy8gd2VhbHRoIHJlZGlzdHJpYnV0aW9uCiAgICAgICAgICAgIHJlZmVycmFsQmFsYW5jZV9bX3JlZmVycmVkQnldID0gU2FmZU1hdGguYWRkKHJlZmVycmFsQmFsYW5jZV9bX3JlZmVycmVkQnldLCBfcmVmZXJyYWxCb251cyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gbm8gcmVmIHB1cmNoYXNlCiAgICAgICAgICAgIC8vIGFkZCB0aGUgcmVmZXJyYWwgYm9udXMgYmFjayB0byB0aGUgZ2xvYmFsIGRpdmlkZW5kcyBjYWtlCiAgICAgICAgICAgIF9kaXZpZGVuZHMgPSBTYWZlTWF0aC5hZGQoX2RpdmlkZW5kcywgX3JlZmVycmFsQm9udXMpOwogICAgICAgICAgICBfZmVlID0gX2RpdmlkZW5kcyAqIG1hZ25pdHVkZTsKICAgICAgICB9CgogICAgICAgIC8vIHdlIGNhbid0IGdpdmUgcGVvcGxlIGluZmluaXRlIGV0aGVyZXVtCiAgICAgICAgaWYgKHRva2VuU3VwcGx5XyA+IDApIHsKICAgICAgICAgICAgLy8gYWRkIHRva2VucyB0byB0aGUgcG9vbAogICAgICAgICAgICB0b2tlblN1cHBseV8gPSBTYWZlTWF0aC5hZGQodG9rZW5TdXBwbHlfLCBfYW1vdW50T2ZUb2tlbnMpOwoKICAgICAgICAgICAgLy8gdGFrZSB0aGUgYW1vdW50IG9mIGRpdmlkZW5kcyBnYWluZWQgdGhyb3VnaCB0aGlzIHRyYW5zYWN0aW9uLCBhbmQgYWxsb2NhdGVzIHRoZW0gZXZlbmx5IHRvIGVhY2ggc2hhcmVob2xkZXIKICAgICAgICAgICAgcHJvZml0UGVyU2hhcmVfICs9IChfZGl2aWRlbmRzICogbWFnbml0dWRlIC8gdG9rZW5TdXBwbHlfKTsKCiAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGUgY3VzdG9tZXIgcmVjZWl2ZXMgb3ZlciBoaXMgcHVyY2hhc2UKICAgICAgICAgICAgX2ZlZSA9IF9mZWUgLSAoX2ZlZSAtIChfYW1vdW50T2ZUb2tlbnMgKiAoX2RpdmlkZW5kcyAqIG1hZ25pdHVkZSAvIHRva2VuU3VwcGx5XykpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBhZGQgdG9rZW5zIHRvIHRoZSBwb29sCiAgICAgICAgICAgIHRva2VuU3VwcGx5XyA9IF9hbW91bnRPZlRva2VuczsKICAgICAgICB9CgogICAgICAgIC8vIHVwZGF0ZSBjaXJjdWxhdGluZyBzdXBwbHkgJiB0aGUgbGVkZ2VyIGFkZHJlc3MgZm9yIHRoZSBjdXN0b21lcgogICAgICAgIHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc10gPSBTYWZlTWF0aC5hZGQodG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSwgX2Ftb3VudE9mVG9rZW5zKTsKCiAgICAgICAgLy8gVGVsbHMgdGhlIGNvbnRyYWN0IHRoYXQgdGhlIGJ1eWVyIGRvZXNuJ3QgZGVzZXJ2ZSBkaXZpZGVuZHMgZm9yIHRoZSB0b2tlbnMgYmVmb3JlIHRoZXkgb3duZWQgdGhlbTsKICAgICAgICAvLyByZWFsbHkgaSBrbm93IHlvdSB0aGluayB5b3UgZG8gYnV0IHlvdSBkb24ndAogICAgICAgIGludDI1NiBfdXBkYXRlZFBheW91dHMgPSAoaW50MjU2KSAocHJvZml0UGVyU2hhcmVfICogX2Ftb3VudE9mVG9rZW5zIC0gX2ZlZSk7CiAgICAgICAgcGF5b3V0c1RvX1tfY3VzdG9tZXJBZGRyZXNzXSArPSBfdXBkYXRlZFBheW91dHM7CgogICAgICAgIC8vIGZpcmUgZXZlbnQKICAgICAgICBvblRva2VuUHVyY2hhc2UoX2N1c3RvbWVyQWRkcmVzcywgX2luY29taW5nRXRoZXJldW0sIF9hbW91bnRPZlRva2VucywgX3JlZmVycmVkQnksIG5vdywgYnV5UHJpY2UoKSk7CgogICAgICAgIHJldHVybiBfYW1vdW50T2ZUb2tlbnM7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IENhbGN1bGF0ZSBUb2tlbiBwcmljZSBiYXNlZCBvbiBhbiBhbW91bnQgb2YgaW5jb21pbmcgZXRoZXJldW0KICAgICAqICBJdCdzIGFuIGFsZ29yaXRobSwgaG9wZWZ1bGx5IHdlIGdhdmUgeW91IHRoZSB3aGl0ZXBhcGVyIHdpdGggaXQgaW4gc2NpZW50aWZpYyBub3RhdGlvbjsKICAgICAqICBTb21lIGNvbnZlcnNpb25zIG9jY3VycmVkIHRvIHByZXZlbnQgZGVjaW1hbCBlcnJvcnMgb3IgdW5kZXJmbG93cyAvIG92ZXJmbG93cyBpbiBzb2xpZGl0eSBjb2RlLgogICAgICovCiAgICBmdW5jdGlvbiBldGhlcmV1bVRvVG9rZW5zXyh1aW50MjU2IF9ldGhlcmV1bSkgaW50ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBfdG9rZW5QcmljZUluaXRpYWwgPSB0b2tlblByaWNlSW5pdGlhbF8gKiAxZTE4OwogICAgICAgIHVpbnQyNTYgX3Rva2Vuc1JlY2VpdmVkID0KICAgICAgICAgKAogICAgICAgICAgICAoCiAgICAgICAgICAgICAgICAvLyB1bmRlcmZsb3cgYXR0ZW1wdHMgQlRGTwogICAgICAgICAgICAgICAgU2FmZU1hdGguc3ViKAogICAgICAgICAgICAgICAgICAgIChzcXJ0CiAgICAgICAgICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfdG9rZW5QcmljZUluaXRpYWwgKiogMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICgyICogKHRva2VuUHJpY2VJbmNyZW1lbnRhbF8gKiAxZTE4KSAqIChfZXRoZXJldW0gKiAxZTE4KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICgodG9rZW5QcmljZUluY3JlbWVudGFsXyAqKiAyKSAqICh0b2tlblN1cHBseV8gKiogMikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoMiAqIHRva2VuUHJpY2VJbmNyZW1lbnRhbF8gKiBfdG9rZW5QcmljZUluaXRpYWwqdG9rZW5TdXBwbHlfKQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgKSwgX3Rva2VuUHJpY2VJbml0aWFsCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkgLyAodG9rZW5QcmljZUluY3JlbWVudGFsXykKICAgICAgICApIC0gKHRva2VuU3VwcGx5Xyk7CgogICAgICAgIHJldHVybiBfdG9rZW5zUmVjZWl2ZWQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IENhbGN1bGF0ZSB0b2tlbiBzZWxsIHZhbHVlLgogICAgICogIEl0J3MgYW4gYWxnb3JpdGhtLCBob3BlZnVsbHkgd2UgZ2F2ZSB5b3UgdGhlIHdoaXRlcGFwZXIgd2l0aCBpdCBpbiBzY2llbnRpZmljIG5vdGF0aW9uOwogICAgICogIFNvbWUgY29udmVyc2lvbnMgb2NjdXJyZWQgdG8gcHJldmVudCBkZWNpbWFsIGVycm9ycyBvciB1bmRlcmZsb3dzIC8gb3ZlcmZsb3dzIGluIHNvbGlkaXR5IGNvZGUuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRva2Vuc1RvRXRoZXJldW1fKHVpbnQyNTYgX3Rva2VucykgaW50ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiB0b2tlbnNfID0gKF90b2tlbnMgKyAxZTE4KTsKICAgICAgICB1aW50MjU2IF90b2tlblN1cHBseSA9ICh0b2tlblN1cHBseV8gKyAxZTE4KTsKICAgICAgICB1aW50MjU2IF9ldGhlclJlY2VpdmVkID0KICAgICAgICAoCiAgICAgICAgICAgIC8vIHVuZGVyZmxvdyBhdHRlbXB0cyBCVEZPCiAgICAgICAgICAgIFNhZmVNYXRoLnN1YigKICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAoCiAgICAgICAgICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRva2VuUHJpY2VJbml0aWFsXyArICh0b2tlblByaWNlSW5jcmVtZW50YWxfICogKF90b2tlblN1cHBseSAvIDFlMTgpKQogICAgICAgICAgICAgICAgICAgICAgICApIC0gdG9rZW5QcmljZUluY3JlbWVudGFsXwogICAgICAgICAgICAgICAgICAgICkgKiAodG9rZW5zXyAtIDFlMTgpCiAgICAgICAgICAgICAgICApLCAodG9rZW5QcmljZUluY3JlbWVudGFsXyAqICgodG9rZW5zXyAqKiAyIC0gdG9rZW5zXykgLyAxZTE4KSkgLyAyCiAgICAgICAgICAgICkKICAgICAgICAvIDFlMTgpOwoKICAgICAgICByZXR1cm4gX2V0aGVyUmVjZWl2ZWQ7CiAgICB9CgogICAgLy8vIEBkZXYgVGhpcyBpcyB3aGVyZSBhbGwgeW91ciBnYXMgZ29lcy4KICAgIGZ1bmN0aW9uIHNxcnQodWludDI1NiB4KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYgeSkgewogICAgICAgIHVpbnQyNTYgeiA9ICh4ICsgMSkgLyAyOwogICAgICAgIHkgPSB4OwoKICAgICAgICB3aGlsZSAoeiA8IHkpIHsKICAgICAgICAgICAgeSA9IHo7CiAgICAgICAgICAgIHogPSAoeCAvIHogKyB6KSAvIDI7CiAgICAgICAgfQogICAgfQoKCn0KCi8qKgogKiBAdGl0bGUgU2FmZU1hdGgKICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCmxpYnJhcnkgU2FmZU1hdGggewoKICAgIC8qKgogICAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAgICovCiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGlmIChhID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAgICovCiAgICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgU3Vic3RyYWN0cyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93IChpLmUuIGlmIHN1YnRyYWhlbmQgaXMgZ3JlYXRlciB0aGFuIG1pbnVlbmQpLgogICAgKi8KICAgIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgYXNzZXJ0KGIgPD0gYSk7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEFkZHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAgICovCiAgICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgICAgIGFzc2VydChjID49IGEpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKfQ=='.
	

]
