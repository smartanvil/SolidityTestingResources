Class {
	#name : #SRT2998328a3a0c95b6beb64c694b6b60aba386cf98,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT2998328a3a0c95b6beb64c694b6b60aba386cf98 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5CiAqLwpjb250cmFjdCBFUkMyMEJhc2ljIHsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQpwcmFnbWEgc29saWRpdHkgXjAuNC4xODsKCgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogIC8qKgogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CgoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqLwogIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9CgoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKCi8qKgogKiBAdGl0bGUgTWludGFibGUgdG9rZW4KICogQGRldiBTaW1wbGUgRVJDMjAgVG9rZW4gZXhhbXBsZSwgd2l0aCBtaW50YWJsZSB0b2tlbiBjcmVhdGlvbgogKiBAZGV2IElzc3VlOiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvaXNzdWVzLzEyMAogKiBCYXNlZCBvbiBjb2RlIGJ5IFRva2VuTWFya2V0TmV0OiBodHRwczovL2dpdGh1Yi5jb20vVG9rZW5NYXJrZXROZXQvaWNvL2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy9NaW50YWJsZVRva2VuLnNvbAogKi8KCmNvbnRyYWN0IE1pbnRhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZSB7CiAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKICBldmVudCBNaW50RmluaXNoZWQoKTsKCiAgYm9vbCBwdWJsaWMgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CgoKICBtb2RpZmllciBjYW5NaW50KCkgewogICAgcmVxdWlyZSghbWludGluZ0ZpbmlzaGVkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIG1pbnQgdG9rZW5zCiAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgbWludGVkIHRva2Vucy4KICAgKiBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAqIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoX2Ftb3VudCk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICBNaW50KF90bywgX2Ftb3VudCk7CiAgICBUcmFuc2ZlcihhZGRyZXNzKDApLCBfdG8sIF9hbW91bnQpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHN0b3AgbWludGluZyBuZXcgdG9rZW5zLgogICAqIEByZXR1cm4gVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgIE1pbnRGaW5pc2hlZCgpOwogICAgcmV0dXJuIHRydWU7CiAgfQp9CgovKioKICogQHRpdGxlIFlSWFRva2VuCiAqIEBkZXYgRVJDMjAgYmFzZWQgVG9rZW4sIHdoZXJlIGFsbCB0b2tlbnMgYXJlIHByZS1hc3NpZ25lZCB0byB0aGUgY3JlYXRvci4KICogTm90ZSB0aGV5IGNhbiBsYXRlciBkaXN0cmlidXRlIHRoZXNlIHRva2VucyBhcyB0aGV5IHdpc2ggdXNpbmcgYHRyYW5zZmVyYCBhbmQgb3RoZXIKICogYFN0YW5kYXJkVG9rZW5gIGZ1bmN0aW9ucy4KICovCmNvbnRyYWN0IFlSWFRva2VuIGlzIE1pbnRhYmxlVG9rZW4gewogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIllvcml0ZXggVG9rZW4iOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiWVJYIjsKICAgIHVpbnQ4IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwogICAgYWRkcmVzcyBwdWJsaWMgY3Jvd2RzYWxlQWRkcmVzczsKCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBJTklUSUFMX1NVUFBMWSA9IDUxMDAwMDAwMCAqIDEgZXRoZXI7CgogICAgbW9kaWZpZXIgbm9uWmVyb0FkZHJlc3MoYWRkcmVzcyBfdG8pIHsgICAgICAgICAgICAgICAgIC8vIEVuc3VyZXMgYW4gYWRkcmVzcyBpcyBwcm92aWRlZAogICAgICAgIHJlcXVpcmUoX3RvICE9IDB4MCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBub25aZXJvQW1vdW50KHVpbnQgX2Ftb3VudCkgeyAgICAgICAgICAgICAgICAgLy8gRW5zdXJlcyBhIG5vbi16ZXJvIGFtb3VudAogICAgICAgIHJlcXVpcmUoX2Ftb3VudCA+IDApOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgbm9uWmVyb1ZhbHVlKCkgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEVuc3VyZXMgYSBub24temVybyB2YWx1ZSBpcyBwYXNzZWQKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+IDApOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seUNyb3dkc2FsZSgpIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEVuc3VyZXMgb25seSBjcm93ZGZ1bmQgY2FuIGNhbGwgdGhlIGZ1bmN0aW9uCiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNyb3dkc2FsZUFkZHJlc3MpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IENvbnN0cnVjdG9yIHRoYXQgZ2l2ZXMgbXNnLnNlbmRlciBhbGwgb2YgZXhpc3RpbmcgdG9rZW5zLgogICAgICovCiAgICBmdW5jdGlvbiBZUlhUb2tlbigpIHB1YmxpYyB7CiAgICAgICAgdG90YWxTdXBwbHkgPSBJTklUSUFMX1NVUFBMWTsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHRvdGFsU3VwcGx5OwogICAgfQoKICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIFNldHMgdGhlIGNyb3dkc2FsZSBhZGRyZXNzLCBjYW4gb25seSBiZSBkb25lIG9uY2UKICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIGZ1bmN0aW9uIHNldENyb3dkc2FsZUFkZHJlc3MoYWRkcmVzcyBfY3Jvd2RzYWxlQWRkcmVzcykgZXh0ZXJuYWwgb25seU93bmVyIG5vblplcm9BZGRyZXNzKF9jcm93ZHNhbGVBZGRyZXNzKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpewogICAgICAgIHJlcXVpcmUoY3Jvd2RzYWxlQWRkcmVzcyA9PSAweDApOwogICAgICAgIGNyb3dkc2FsZUFkZHJlc3MgPSBfY3Jvd2RzYWxlQWRkcmVzczsKICAgICAgICBkZWNyZW1lbnRCYWxhbmNlKG93bmVyLCB0b3RhbFN1cHBseSk7CiAgICAgICAgYWRkVG9CYWxhbmNlKGNyb3dkc2FsZUFkZHJlc3MsIHRvdGFsU3VwcGx5KTsKICAgICAgICBUcmFuc2ZlcigweDAsIF9jcm93ZHNhbGVBZGRyZXNzLCB0b3RhbFN1cHBseSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gRnVuY3Rpb24gZm9yIHRoZSBDcm93ZHNhbGUgdG8gdHJhbnNmZXIgdG9rZW5zCiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb21Dcm93ZHNhbGUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgZXh0ZXJuYWwgb25seUNyb3dkc2FsZSBub25aZXJvQW1vdW50KF9hbW91bnQpIG5vblplcm9BZGRyZXNzKF90bykgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmVxdWlyZShiYWxhbmNlT2YoY3Jvd2RzYWxlQWRkcmVzcykgPj0gX2Ftb3VudCk7CiAgICAgICAgZGVjcmVtZW50QmFsYW5jZShjcm93ZHNhbGVBZGRyZXNzLCBfYW1vdW50KTsKICAgICAgICBhZGRUb0JhbGFuY2UoX3RvLCBfYW1vdW50KTsKICAgICAgICBUcmFuc2ZlcigweDAsIF90bywgX2Ftb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gQWRkcyB0byBiYWxhbmNlCiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICBmdW5jdGlvbiBhZGRUb0JhbGFuY2UoYWRkcmVzcyBfYWRkcmVzcywgdWludCBfYW1vdW50KSBpbnRlcm5hbCB7CiAgICAgICAgYmFsYW5jZXNbX2FkZHJlc3NdID0gYmFsYW5jZXNbX2FkZHJlc3NdLmFkZChfYW1vdW50KTsKICAgIH0KCiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyBSZW1vdmVzIGZyb20gYmFsYW5jZQogICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgZnVuY3Rpb24gZGVjcmVtZW50QmFsYW5jZShhZGRyZXNzIF9hZGRyZXNzLCB1aW50IF9hbW91bnQpIGludGVybmFsIHsKICAgICAgICBiYWxhbmNlc1tfYWRkcmVzc10gPSBiYWxhbmNlc1tfYWRkcmVzc10uc3ViKF9hbW91bnQpOwogICAgfQoKfQoKLyoqCiAqIEB0aXRsZSBZUlhDcm93ZHNhbGUKICovCgpjb250cmFjdCBZUlhDcm93ZHNhbGUgaXMgT3duYWJsZSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIC8vIHRydWUgZm9yIGZpbmFsaXNlZCBwcmVzYWxlCiAgYm9vbCBwdWJsaWMgaXNQcmVTYWxlRmluYWxpc2VkOwogIC8vIHRydWUgZm9yIGZpbmFsaXNlZCBjcm93ZHNhbGUKICBib29sIHB1YmxpYyBpc0ZpbmFsaXNlZDsKICAvLyBUaGUgdG9rZW4gYmVpbmcgc29sZAogIFlSWFRva2VuIHB1YmxpYyBZUlg7CiAgLy8gYWRkcmVzcyB3aGVyZSBmdW5kcyBhcmUgY29sbGVjdGVkCiAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0OwoKICAvLyBhbW91bnQgb2YgcmFpc2VkIG1vbmV5IGluIHdlaQogIHVpbnQyNTYgcHVibGljIHdlaVJhaXNlZDsKCiAgLy8gY3VycmVudCBhbW91bnQgb2YgcHVyY2hhc2VkIHRva2VucyBmb3IgcHJlLXNhbGUgYW5kIG1haW4gc2FsZQogIHVpbnQyNTYgcHVibGljIHByZVNhbGVUb3RhbFN1cHBseTsKICB1aW50MjU2IHB1YmxpYyBtYWluU2FsZVRvdGFsU3VwcGx5OwogIC8vIGN1cnJlbnQgYW1vdW50IG9mIG1pbnRlZCB0b2tlbnMgZm9yIGJvdW50eQogIHVpbnQyNTYgcHVibGljIGJvdW50eVRvdGFsU3VwcGx5OwogIHVpbnQyNTYgcHJpdmF0ZSBtYWluU2FsZVRva2Vuc0V4dHJhOwoKICBldmVudCBXYWxsZXRBZGRyZXNzQ2hhbmdlZChhZGRyZXNzIF93YWxsZXQpOyAgICAgICAgICAgLy8gVHJpZ2dlcmVkIHVwb24gb3duZXIgY2hhbmdpbmcgdGhlIHdhbGxldCBhZGRyZXNzCiAgZXZlbnQgQW1vdW50UmFpc2VkKGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQgYW1vdW50UmFpc2VkKTsgLy8gVHJpZ2dlcmVkIHVwb24gY3Jvd2RmdW5kIGJlaW5nIGZpbmFsaXplZAogIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGFtb3VudCk7CiAgLyoqCiAgICogZXZlbnQgZm9yIHRva2VuIHB1cmNoYXNlIGxvZ2dpbmcKICAgKiBAcGFyYW0gcHVyY2hhc2VyIHdobyBwYWlkIGZvciB0aGUgdG9rZW5zCiAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IHdobyBnb3QgdGhlIHRva2VucwogICAqIEBwYXJhbSB2YWx1ZSB3ZWlzIHBhaWQgZm9yIHB1cmNoYXNlCiAgICogQHBhcmFtIGFtb3VudCBhbW91bnQgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAqLwogIGV2ZW50IFRva2VuUHVyY2hhc2UoYWRkcmVzcyBpbmRleGVkIHB1cmNoYXNlciwgYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IGFtb3VudCk7CgogIG1vZGlmaWVyIG5vblplcm9BZGRyZXNzKGFkZHJlc3MgX3RvKSB7ICAgICAgICAgICAgICAgICAvLyBFbnN1cmVzIGFuIGFkZHJlc3MgaXMgcHJvdmlkZWQKICAgIHJlcXVpcmUoX3RvICE9IDB4MCk7CiAgICBfOwogIH0KCiAgbW9kaWZpZXIgbm9uWmVyb0Ftb3VudCh1aW50IF9hbW91bnQpIHsgICAgICAgICAgICAgICAgIC8vIEVuc3VyZXMgYSBub24temVybyBhbW91bnQKICAgIHJlcXVpcmUoX2Ftb3VudCA+IDApOwogICAgXzsKICB9CgogIG1vZGlmaWVyIG5vblplcm9WYWx1ZSgpIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBFbnN1cmVzIGEgbm9uLXplcm8gdmFsdWUgaXMgcGFzc2VkCiAgICByZXF1aXJlKG1zZy52YWx1ZSA+IDApOwogICAgXzsKICB9CgogIG1vZGlmaWVyIGNyb3dkc2FsZUlzQWN0aXZlKCkgeyAgICAgICAgICAgICAgICAgICAgICAgICAvLyBFbnN1cmVzIHRoZSBjcm93ZGZ1bmQgaXMgb25nb2luZwogICAgcmVxdWlyZSghaXNGaW5hbGlzZWQgJiYgKGlzSW5QcmVTYWxlKCkgfHwgaXNJbk1haW5TYWxlKCkpKTsKICAgIF87CiAgfQoKICBmdW5jdGlvbiBZUlhDcm93ZHNhbGUoYWRkcmVzcyBfd2FsbGV0LCBhZGRyZXNzIF90b2tlbikgcHVibGljIHsKCiAgICAvKiBkZWZhdWx0IHN0YXJ0LWVuZCBwZXJpb2RzIGRhdGVzCiAgICAgIF9wcmVTYWxlU3RhcnRUaW1lID0gICAgICcyOSBOb3YgMjAxNyAwMDowMDowMCBHTVQnIDE1MTE5MTM2MDAKICAgICAgX3ByZVNhbGVFbmRUaW1lID0gICAgICAgJzEwIEphbiAyMDE4IDIzOjU5OjU5IEdNVCcgMTUxNTYyODc5OQogICAgICBfbWFpblNhbGVTdGFydFRpbWUgPSAgICAnMTEgSmFuIDIwMTggMDA6MDA6MDAgR01UJyAxNTE1NjI4ODAwCiAgICAgIF9tYWluU2FsZUVuZFRpbWUgPSAgICAgICcxMSBNYXkgMjAxOCAwMDowMDowMCBHTVQnIDE1MjU5OTY4MDAKICAgICovCgogICAgLy8gY2hlY2sgZGF0ZXMKICAgIHJlcXVpcmUobWFpblNhbGVTdGFydFRpbWUoKSA+PSBub3cpOyAgICAgICAgICAgICAgICAgLy8gY2FuJ3Qgc3RhcnQgbWFpbiBzYWxlIGluIHRoZSBwYXN0CiAgICByZXF1aXJlKHByZVNhbGVFbmRUaW1lKCkgPCBtYWluU2FsZVN0YXJ0VGltZSgpKTsgICAgICAvLyBjYW4ndCBzdGFydCBtYWluIHNhbGUgYmVmb3JlIHRoZSBlbmQgb2YgcHJlLXNhbGUKICAgIHJlcXVpcmUocHJlU2FsZVN0YXJ0VGltZSgpIDwgcHJlU2FsZUVuZFRpbWUoKSk7ICAgICAgIC8vIHRoZSBlbmQgb2YgcHJlLXNhbGUgY2FuJ3QgaGFwcGVuIGJlZm9yZSBpdCdzIHN0YXJ0CiAgICByZXF1aXJlKG1haW5TYWxlU3RhcnRUaW1lKCkgPCBtYWluU2FsZUVuZFRpbWUoKSk7ICAgICAvLyB0aGUgZW5kIG9mIG1haW4gc2FsZSBjYW4ndCBoYXBwZW4gYmVmb3JlIGl0J3Mgc3RhcnQKCiAgICAvLyBjcmVhdGUgdG9rZW4gY29udHJhY3QKICAgIFlSWCA9IFlSWFRva2VuKF90b2tlbik7CiAgICB3YWxsZXQgPSBfd2FsbGV0OwogICAgaXNQcmVTYWxlRmluYWxpc2VkID0gZmFsc2U7CiAgICBpc0ZpbmFsaXNlZCA9IGZhbHNlOwoKICAgIC8vIGN1cnJlbnQgYW1vdW50IG9mIHB1cmNoYXNlZCB0b2tlbnMgZm9yIHByZS1zYWxlIGFuZCBtYWluIHNhbGUKICAgIHByZVNhbGVUb3RhbFN1cHBseSA9IDA7CiAgICBtYWluU2FsZVRvdGFsU3VwcGx5ID0gMDsKICAgIGJvdW50eVRvdGFsU3VwcGx5ID0gMDsKICAgIG1haW5TYWxlVG9rZW5zRXh0cmEgPSAwOwogIH0KCiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogIC8vIENoYW5nZXMgbWFpbiBjb250cmlidXRpb24gd2FsbGV0CiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogIGZ1bmN0aW9uIGNoYW5nZVdhbGxldEFkZHJlc3MoYWRkcmVzcyBfd2FsbGV0KSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgd2FsbGV0ID0gX3dhbGxldDsKICAgIFdhbGxldEFkZHJlc3NDaGFuZ2VkKF93YWxsZXQpOwogIH0KCgogIGZ1bmN0aW9uIG1heFRva2VucygpIHB1YmxpYyBwdXJlIHJldHVybnModWludDI1NikgewogICAgcmV0dXJuIDUxMDAwMDAwMCAqIDEgZXRoZXI7CiAgfQoKICBmdW5jdGlvbiBwcmVTYWxlTWF4VG9rZW5zKCkgcHVibGljIHB1cmUgcmV0dXJucyh1aW50MjU2KSB7CiAgICByZXR1cm4gNTEwMDAwMDAgKiAxIGV0aGVyOwogIH0KCiAgZnVuY3Rpb24gbWFpblNhbGVNYXhUb2tlbnMoKSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnQyNTYpIHsKICAgIHJldHVybiA0MzM1MDAwMDAgICogMSBldGhlciArIG1haW5TYWxlVG9rZW5zRXh0cmE7CiAgfQoKICBmdW5jdGlvbiBib3VudHlNYXhUb2tlbnMoKSBwdWJsaWMgcHVyZSByZXR1cm5zKHVpbnQyNTYpIHsKICAgIHJldHVybiAyNTUwMDAwMCAqIDEgZXRoZXI7CiAgfQoKICBmdW5jdGlvbiBwcmVTYWxlU3RhcnRUaW1lKCkgcHVibGljIHB1cmUgcmV0dXJucyh1aW50MjU2KSB7CiAgICByZXR1cm4gMTUxMTkxMzYwMDsKICB9CgogIGZ1bmN0aW9uIHByZVNhbGVFbmRUaW1lKCkgcHVibGljIHB1cmUgcmV0dXJucyh1aW50MjU2KSB7CiAgICByZXR1cm4gMTUxNTYyODc5OTsKICB9CgogIGZ1bmN0aW9uIG1haW5TYWxlU3RhcnRUaW1lKCkgcHVibGljIHB1cmUgcmV0dXJucyh1aW50MjU2KSB7CiAgICByZXR1cm4gMTUxNTYyODgwMDsKICB9CgogIGZ1bmN0aW9uIG1haW5TYWxlRW5kVGltZSgpIHB1YmxpYyBwdXJlIHJldHVybnModWludDI1NikgewogICAgcmV0dXJuIDE1MjU5OTY4MDA7CiAgfQoKICBmdW5jdGlvbiByYXRlKCkgcHVibGljIHB1cmUgcmV0dXJucyh1aW50MjU2KSB7CiAgICByZXR1cm4gNTQwOwogIH0KCiAgZnVuY3Rpb24gZGlzY291bnRSYXRlKCkgcHVibGljIHB1cmUgcmV0dXJucyh1aW50MjU2KSB7CiAgICByZXR1cm4gMTM1MDsKICB9CgogIGZ1bmN0aW9uIGRpc2NvdW50SUNPKCkgcHVibGljIHB1cmUgcmV0dXJucyh1aW50MjU2KSB7CiAgICByZXR1cm4gNjA7CiAgfQoKICBmdW5jdGlvbiBpc0luUHJlU2FsZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKGJvb2wpewogICAgcmV0dXJuIG5vdyA+PSBwcmVTYWxlU3RhcnRUaW1lKCkgJiYgbm93IDw9IHByZVNhbGVFbmRUaW1lKCk7CiAgfQoKICBmdW5jdGlvbiBpc0luTWFpblNhbGUoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyhib29sKXsKICAgIHJldHVybiBub3cgPj0gbWFpblNhbGVTdGFydFRpbWUoKSAmJiBub3cgPD0gbWFpblNhbGVFbmRUaW1lKCk7CiAgfQoKICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnModWludDI1Nil7CiAgICByZXR1cm4gWVJYLnRvdGFsU3VwcGx5KCk7CiAgfQoKICAvLyBmYWxsYmFjayBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBidXkgdG9rZW5zCiAgZnVuY3Rpb24gKCkgcHVibGljIHBheWFibGUgewogICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwogIH0KCiAgLy8gbG93IGxldmVsIHRva2VuIHB1cmNoYXNlIGZ1bmN0aW9uCiAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnkpIHB1YmxpYyBjcm93ZHNhbGVJc0FjdGl2ZSBub25aZXJvQWRkcmVzcyhiZW5lZmljaWFyeSkgbm9uWmVyb1ZhbHVlIHBheWFibGUgewogICAgdWludDI1NiB3ZWlBbW91bnQgPSBtc2cudmFsdWU7CgogICAgLy8gY2FsY3VsYXRlIHRva2VuIGFtb3VudCB0byBiZSBjcmVhdGVkCiAgICB1aW50MjU2IHRva2VucyA9IHdlaUFtb3VudCAqIHJhdGUoKTsKICAgIGlmIChpc0luUHJlU2FsZSgpKSB7CiAgICAgIHJlcXVpcmUoIWlzUHJlU2FsZUZpbmFsaXNlZCk7CiAgICAgIHRva2VucyA9IHdlaUFtb3VudCAqIGRpc2NvdW50UmF0ZSgpOwogICAgICByZXF1aXJlKHRva2VucyA8PSBwcmVTYWxlVG9rZW5MZWZ0KCkpOwogICAgfQoKICAgIGlmIChpc0luTWFpblNhbGUoKSkgewogICAgICAvLyB0b2tlbnMgd2l0aCBkaXNjb3VudAogICAgICB0b2tlbnMgPSB3ZWlBbW91bnQgKiBkaXNjb3VudFJhdGUoKTsKICAgICAgcmVxdWlyZShtYWluU2FsZVRvdGFsU3VwcGx5ICsgdG9rZW5zIDw9IG1haW5TYWxlTWF4VG9rZW5zKCkpOwogICAgfQoKICAgIC8vIHVwZGF0ZSBzdGF0ZQogICAgd2VpUmFpc2VkID0gd2VpUmFpc2VkLmFkZCh3ZWlBbW91bnQpOwogICAgaWYgKGlzSW5QcmVTYWxlKCkpCiAgICAgIHByZVNhbGVUb3RhbFN1cHBseSArPSB0b2tlbnM7CiAgICBpZiAoaXNJbk1haW5TYWxlKCkpCiAgICAgIG1haW5TYWxlVG90YWxTdXBwbHkgKz0gdG9rZW5zOwoKICAgIGZvcndhcmRGdW5kcygpOwogICAgaWYgKCFZUlgudHJhbnNmZXJGcm9tQ3Jvd2RzYWxlKGJlbmVmaWNpYXJ5LCB0b2tlbnMpKSB7cmV2ZXJ0KCk7fQogICAgVG9rZW5QdXJjaGFzZShtc2cuc2VuZGVyLCBiZW5lZmljaWFyeSwgd2VpQW1vdW50LCB0b2tlbnMpOwogIH0KCiAgLy8gc2VuZCBldGhlciB0byB0aGUgZnVuZCBjb2xsZWN0aW9uIHdhbGxldAogIGZ1bmN0aW9uIGZvcndhcmRGdW5kcygpIGludGVybmFsIHsKICAgIHdhbGxldC50cmFuc2Zlcihtc2cudmFsdWUpOwogIH0KCiAgLy8gbWludCB0b2tlbnMgdG8gYmVuZWZpY2lhcnkKICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQyNTYgYW1vdW50KSBwdWJsaWMgb25seU93bmVyIGNyb3dkc2FsZUlzQWN0aXZlIG5vblplcm9BZGRyZXNzKGJlbmVmaWNpYXJ5KSBub25aZXJvQW1vdW50KGFtb3VudCkgewogICAgLy8gY2hlY2sgcGVyaW9kCiAgICBib29sIHdpdGhpblByZVNhbGVQZXJpb2QgPSBpc0luUHJlU2FsZSgpOwogICAgYm9vbCB3aXRoaW5NYWluU2FsZVBlcmlvZCA9IGlzSW5NYWluU2FsZSgpOwogICAgaWYgKHdpdGhpblByZVNhbGVQZXJpb2QpIHsKICAgICAgcmVxdWlyZSghaXNQcmVTYWxlRmluYWxpc2VkKTsKICAgICAgcmVxdWlyZShhbW91bnQgPD0gcHJlU2FsZVRva2VuTGVmdCgpKTsKICAgIH0KICAgIGlmICh3aXRoaW5NYWluU2FsZVBlcmlvZCkgewogICAgICByZXF1aXJlKGFtb3VudCA8PSAobWFpblNhbGVNYXhUb2tlbnMoKSAtIG1haW5TYWxlVG90YWxTdXBwbHkpKTsKICAgIH0KCiAgICBpZiAod2l0aGluUHJlU2FsZVBlcmlvZCkKICAgICAgcHJlU2FsZVRvdGFsU3VwcGx5ICs9IGFtb3VudDsKICAgIGlmICh3aXRoaW5NYWluU2FsZVBlcmlvZCkKICAgICAgbWFpblNhbGVUb3RhbFN1cHBseSArPSBhbW91bnQ7CgogICAgaWYgKCFZUlgudHJhbnNmZXJGcm9tQ3Jvd2RzYWxlKGJlbmVmaWNpYXJ5LCBhbW91bnQpKSB7cmV2ZXJ0KCk7fQogICAgTWludChiZW5lZmljaWFyeSwgYW1vdW50KTsKICB9CgogIGZ1bmN0aW9uIHByZVNhbGVUb2tlbkxlZnQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KXsKICAgIHJldHVybiBwcmVTYWxlTWF4VG9rZW5zKCkgLSBwcmVTYWxlVG90YWxTdXBwbHk7CiAgfQoKICAvLyBmaW5hbGlzZSBwcmVzYWxlCiAgZnVuY3Rpb24gZmluYWxpc2VQcmVTYWxlKCkgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKCFpc0ZpbmFsaXNlZCk7CiAgICByZXF1aXJlKCFpc1ByZVNhbGVGaW5hbGlzZWQpOwogICAgcmVxdWlyZShub3cgPj0gcHJlU2FsZVN0YXJ0VGltZSgpKTsgLy8gY2FuIGZpbmFsaXNlIHByZXNhbGUgb25seSBhZnRlciBpdCBzdGFydHMKCiAgICBpZiAocHJlU2FsZVRva2VuTGVmdCgpID4gMCkgewogICAgICBtYWluU2FsZVRva2Vuc0V4dHJhID0gcHJlU2FsZVRva2VuTGVmdCgpOwogICAgfQoKICAgIGlzUHJlU2FsZUZpbmFsaXNlZCA9IHRydWU7CiAgfQoKICAvLyBmaW5hbGFzZSBjcm93ZHNhbGUgKG1haW5zYWxlKQogIGZ1bmN0aW9uIGZpbmFsaXNlKCkgcHVibGljIG9ubHlPd25lciByZXR1cm5zKGJvb2wgc3VjY2Vzcyl7CiAgICByZXF1aXJlKCFpc0ZpbmFsaXNlZCk7CiAgICByZXF1aXJlKG5vdyA+PSBtYWluU2FsZVN0YXJ0VGltZSgpKTsgLy8gY2FuIGZpbmFsaXNlIG1haW5zYWxlIChjcm93ZHNhbGUpIG9ubHkgYWZ0ZXIgaXQgc3RhcnRzCiAgICBBbW91bnRSYWlzZWQod2FsbGV0LCB3ZWlSYWlzZWQpOwogICAgaXNGaW5hbGlzZWQgPSB0cnVlOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLyBtaW50IGJvdW50eSB0b2tlbnMgdG8gYmVuZWZpY2lhcnkKICBmdW5jdGlvbiBtaW50Qm91bnR5KGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQyNTYgYW1vdW50KSBwdWJsaWMgb25seU93bmVyIGNyb3dkc2FsZUlzQWN0aXZlIG5vblplcm9BZGRyZXNzKGJlbmVmaWNpYXJ5KSBub25aZXJvQW1vdW50KGFtb3VudCkgewogICAgcmVxdWlyZShhbW91bnQgPD0gKGJvdW50eU1heFRva2VucygpIC0gYm91bnR5VG90YWxTdXBwbHkpKTsKCiAgICBib3VudHlUb3RhbFN1cHBseSArPSBhbW91bnQ7CiAgICBpZiAoIVlSWC50cmFuc2ZlckZyb21Dcm93ZHNhbGUoYmVuZWZpY2lhcnksIGFtb3VudCkpIHtyZXZlcnQoKTt9CiAgICBNaW50KGJlbmVmaWNpYXJ5LCBhbW91bnQpOwogIH0KCn0='.
	

]
