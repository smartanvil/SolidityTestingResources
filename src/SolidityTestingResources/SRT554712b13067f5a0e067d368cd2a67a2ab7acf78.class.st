Class {
	#name : #SRT554712b13067f5a0e067d368cd2a67a2ab7acf78,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT554712b13067f5a0e067d368cd2a67a2ab7acf78 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7CgovLyBXb2xmIENyeXB0byBwb29saW5nIGNvbnRyYWN0IGZvciBIYXZ2ZW4KLy8gd3JpdHRlbiBieSBAaWFtZGVmaW5pdGVseWFodW1hbgoKbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCgpjb250cmFjdCBFUkMyMCB7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHt9CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHt9Cn0KCgpjb250cmFjdCBXaGl0ZUxpc3QgewogICBmdW5jdGlvbiBjaGVja01lbWJlckxldmVsIChhZGRyZXNzIGFkZHIpIHZpZXcgcHVibGljIHJldHVybnMgKHVpbnQpIHt9Cn0KCgpjb250cmFjdCBQcmVzYWxlUG9vbCB7CgogIC8vIFNhZmVNYXRoIGlzIGEgbGlicmFyeSB0byBlbnN1cmUgdGhhdCBtYXRoIG9wZXJhdGlvbnMgZG8gbm90IGhhdmUgb3ZlcmZsb3cgZXJyb3JzCiAgLy8gaHR0cHM6Ly96ZXBwZWxpbi1zb2xpZGl0eS5yZWFkdGhlZG9jcy5pby9lbi9sYXRlc3Qvc2FmZW1hdGguaHRtbAogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwogIAogIC8vIFRoZSBjb250cmFjdCBoYXMgMyBzdGFnZXM6CiAgLy8gMSAtIFRoZSBpbml0aWFsIHN0YXRlLiBUaGUgb3duZXIgaXMgYWJsZSB0byBhZGQgYWRkcmVzc2VzIHRvIHRoZSB3aGl0ZWxpc3QsIGFuZCBhbnkgd2hpdGVsaXN0ZWQgYWRkcmVzc2VzIGNhbiBkZXBvc2l0IG9yIHdpdGhkcmF3IGV0aCB0byB0aGUgY29udHJhY3QuCiAgLy8gMiAtIFRoZSBvd25lciBoYXMgY2xvc2VkIHRoZSBjb250cmFjdCBmb3IgZnVydGhlciBkZXBvc2l0cy4gV2hpdGVsaXN0ZWQgYWRkcmVzc2VzIGNhbiBzdGlsbCB3aXRoZHJhdyBldGggZnJvbSB0aGUgY29udHJhY3QuCiAgLy8gMyAtIFRoZSBldGggaXMgc2VudCBmcm9tIHRoZSBjb250cmFjdCB0byB0aGUgcmVjZWl2ZXIuIFVudXNlZCBldGggY2FuIGJlIGNsYWltZWQgYnkgY29udHJpYnV0b3JzIGltbWVkaWF0ZWx5LiBPbmNlIHRva2VucyBhcmUgc2VudCB0byB0aGUgY29udHJhY3QsCiAgLy8gICAgIHRoZSBvd25lciBlbmFibGVzIHdpdGhkcmF3YWxzIGFuZCBjb250cmlidXRvcnMgY2FuIHdpdGhkcmF3IHRoZWlyIHRva2Vucy4KICB1aW50OCBwdWJsaWMgY29udHJhY3RTdGFnZSA9IDE7CiAgCiAgLy8gVGhlc2UgdmFyaWFibGVzIGFyZSBzZXQgYXQgdGhlIHRpbWUgb2YgY29udHJhY3QgY3JlYXRpb24KICAvLyB0aGUgYWRkcmVzcyB0aGF0IGNyZWF0ZXMgdGhlIGNvbnRyYWN0CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgLy8gdGhlIG1pbmltdW0gZXRoIGFtb3VudCAoaW4gd2VpKSB0aGF0IGNhbiBiZSBzZW50IGJ5IGEgd2hpdGVsaXN0ZWQgYWRkcmVzcwogIHVpbnQgY29uc3RhbnQgcHVibGljIGNvbnRyaWJ1dGlvbk1pbiA9IDEwMDAwMDAwMDAwMDAwMDAwMDsKICAvLyB0aGUgbWF4aW11bSBldGggYW1vdW50IChpbiB3ZWkpIHRoYXQgY2FuIGJlIHNlbnQgYnkgYSB3aGl0ZWxpc3RlZCBhZGRyZXNzCiAgdWludFtdIHB1YmxpYyBjb250cmlidXRpb25DYXBzOwogIC8vIHRoZSAlIG9mIHRva2VucyBrZXB0IGJ5IHRoZSBjb250cmFjdCBvd25lcgogIHVpbnQgcHVibGljIGZlZVBjdDsKICAvLyB0aGUgYWRkcmVzcyB0aGF0IHRoZSBwb29sIHdpbGwgYmUgcGFpZCBvdXQgdG8KICBhZGRyZXNzIHB1YmxpYyByZWNlaXZlckFkZHJlc3M7CiAgLy8gdGhlIG1heGltdW0gZ2FzIHByaWNlIGFsbG93ZWQgZm9yIGRlcG9zaXRzIGluIHN0YWdlIDEKICB1aW50IGNvbnN0YW50IHB1YmxpYyBtYXhHYXNQcmljZSA9IDUwMDAwMDAwMDAwOwogIC8vIHRoZSB3aGl0ZWxpc3RpbmcgY29udHJhY3QKICBXaGl0ZUxpc3QgY29uc3RhbnQgcHVibGljIHdoaXRlbGlzdENvbnRyYWN0ID0gV2hpdGVMaXN0KDB4OEQ5NUIwMzhjQTgwQTk4NjQyNUZBMjQwQzNDMTdGYjJCNmU5YmM2Myk7CiAgCiAgLy8gVGhlc2UgdmFyaWFibGVzIGFyZSBhbGwgaW5pdGlhbGx5IHNldCB0byAwIGFuZCB3aWxsIGJlIHNldCBhdCBzb21lIHBvaW50IGR1cmluZyB0aGUgY29udHJhY3QKICAvLyB0aGUgYW1vdW50IG9mIGV0aCAoaW4gd2VpKSBwcmVzZW50IGluIHRoZSBjb250cmFjdCB3aGVuIGl0IHdhcyBzdWJtaXR0ZWQKICB1aW50IHB1YmxpYyBmaW5hbEJhbGFuY2U7CiAgLy8gYW4gYXJyYXkgY29udGFpbmluZyBldGggYW1vdW50cyB0byBiZSByZWZ1bmRlZCBpbiBzdGFnZSAzCiAgdWludFtdIHB1YmxpYyBldGhSZWZ1bmRBbW91bnQ7CiAgLy8gdGhlIGRlZmF1bHQgdG9rZW4gY29udHJhY3QgdG8gYmUgdXNlZCBmb3Igd2l0aGRyYXdpbmcgdG9rZW5zIGluIHN0YWdlIDMKICBhZGRyZXNzIHB1YmxpYyBhY3RpdmVUb2tlbjsKICAKICAvLyBhIGRhdGEgc3RydWN0dXJlIGZvciBob2xkaW5nIHRoZSBjb250cmlidXRpb24gYW1vdW50LCBjYXAsIGV0aCByZWZ1bmQgc3RhdHVzLCBhbmQgdG9rZW4gd2l0aGRyYXdhbCBzdGF0dXMgZm9yIGVhY2ggd2hpdGVsaXN0ZWQgYWRkcmVzcwogIHN0cnVjdCBDb250cmlidXRvciB7CiAgICBib29sIGF1dGhvcml6ZWQ7CiAgICB1aW50IGV0aFJlZnVuZDsKICAgIHVpbnQgYmFsYW5jZTsKICAgIHVpbnQgY2FwOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSB0b2tlbnNDbGFpbWVkOwogIH0KICAvLyBhIG1hcHBpbmcgdGhhdCBob2xkcyB0aGUgY29udHJpYnV0b3Igc3RydWN0IGZvciBlYWNoIHdoaXRlbGlzdGVkIGFkZHJlc3MKICBtYXBwaW5nIChhZGRyZXNzID0+IENvbnRyaWJ1dG9yKSB3aGl0ZWxpc3Q7CiAgCiAgLy8gYSBkYXRhIHN0cnVjdHVyZSBmb3IgaG9sZGluZyBpbmZvcm1hdGlvbiByZWxhdGVkIHRvIHRva2VuIHdpdGhkcmF3YWxzLgogIHN0cnVjdCBUb2tlbkFsbG9jYXRpb24gewogICAgRVJDMjAgdG9rZW47CiAgICB1aW50W10gcGN0OwogICAgdWludCBiYWxhbmNlUmVtYWluaW5nOwogIH0KICAvLyBhIG1hcHBpbmcgdGhhdCBob2xkcyB0aGUgdG9rZW4gYWxsb2NhdGlvbiBzdHJ1Y3QgZm9yIGVhY2ggdG9rZW4gYWRkcmVzcwogIG1hcHBpbmcgKGFkZHJlc3MgPT4gVG9rZW5BbGxvY2F0aW9uKSBkaXN0cmlidXRpb25NYXA7CiAgCiAgCiAgLy8gdGhpcyBtb2RpZmllciBpcyB1c2VkIGZvciBmdW5jdGlvbnMgdGhhdCBjYW4gb25seSBiZSBhY2Nlc3NlZCBieSB0aGUgY29udHJhY3QgY3JlYXRvcgogIG1vZGlmaWVyIG9ubHlPd25lciAoKSB7CiAgICByZXF1aXJlIChtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQogIAogIC8vIHRoaXMgbW9kaWZpZXIgaXMgdXNlZCB0byBwcmV2ZW50IHJlLWVudHJhbmN5IGV4cGxvaXRzIGR1cmluZyBjb250cmFjdCA+IGNvbnRyYWN0IGludGVyYWN0aW9uCiAgYm9vbCBsb2NrZWQ7CiAgbW9kaWZpZXIgbm9SZWVudHJhbmN5KCkgewogICAgcmVxdWlyZSghbG9ja2VkKTsKICAgIGxvY2tlZCA9IHRydWU7CiAgICBfOwogICAgbG9ja2VkID0gZmFsc2U7CiAgfQogIAogIC8vIEV2ZW50cyB0cmlnZ2VyZWQgdGhyb3VnaG91dCBjb250cmFjdCBleGVjdXRpb24KICAvLyBUaGVzZSBjYW4gYmUgd2F0Y2hlZCB2aWEgZ2V0aCBmaWx0ZXJzIHRvIGtlZXAgdXAtdG8tZGF0ZSB3aXRoIHRoZSBjb250cmFjdAogIGV2ZW50IENvbnRyaWJ1dG9yQmFsYW5jZUNoYW5nZWQgKGFkZHJlc3MgY29udHJpYnV0b3IsIHVpbnQgdG90YWxCYWxhbmNlKTsKICBldmVudCBQb29sU3VibWl0dGVkIChhZGRyZXNzIHJlY2VpdmVyLCB1aW50IGFtb3VudCk7CiAgZXZlbnQgV2l0aGRyYXdhbHNPcGVuIChhZGRyZXNzIHRva2VuQWRkcik7CiAgZXZlbnQgVG9rZW5zV2l0aGRyYXduIChhZGRyZXNzIHJlY2VpdmVyLCB1aW50IGFtb3VudCk7CiAgZXZlbnQgRXRoUmVmdW5kUmVjZWl2ZWQgKGFkZHJlc3Mgc2VuZGVyLCB1aW50IGFtb3VudCk7CiAgZXZlbnQgRXRoUmVmdW5kZWQgKGFkZHJlc3MgcmVjZWl2ZXIsIHVpbnQgYW1vdW50KTsKICBldmVudCBFUkMyMjNSZWNlaXZlZCAoYWRkcmVzcyB0b2tlbiwgdWludCB2YWx1ZSk7CiAgIAogIC8vIFRoZXNlIGFyZSBpbnRlcm5hbCBmdW5jdGlvbnMgdXNlZCBmb3IgY2FsY3VsYXRpbmcgZmVlcywgZXRoIGFuZCB0b2tlbiBhbGxvY2F0aW9ucyBhcyAlCiAgLy8gcmV0dXJucyBhIHZhbHVlIGFzIGEgJSBhY2N1cmF0ZSB0byAyMCBkZWNpbWFsIHBvaW50cwogIGZ1bmN0aW9uIF90b1BjdCAodWludCBudW1lcmF0b3IsIHVpbnQgZGVub21pbmF0b3IgKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQpIHsKICAgIHJldHVybiBudW1lcmF0b3IubXVsKDEwICoqIDIwKSAvIGRlbm9taW5hdG9yOwogIH0KICAKICAvLyByZXR1cm5zICUgb2YgYW55IG51bWJlciwgd2hlcmUgJSBnaXZlbiB3YXMgZ2VuZXJhdGVkIHdpdGggdG9QY3QKICBmdW5jdGlvbiBfYXBwbHlQY3QgKHVpbnQgbnVtZXJhdG9yLCB1aW50IHBjdCkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50KSB7CiAgICByZXR1cm4gbnVtZXJhdG9yLm11bChwY3QpIC8gKDEwICoqIDIwKTsKICB9CiAgCiAgLy8gVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgYXQgdGhlIHRpbWUgb2YgY29udHJhY3QgY3JlYXRpb24sCiAgLy8gaXQgc2V0cyB0aGUgaW5pdGlhbCB2YXJpYWJsZXMgYW5kIHdoaXRlbGlzdHMgdGhlIGNvbnRyYWN0IG93bmVyLgogIGZ1bmN0aW9uIFByZXNhbGVQb29sKGFkZHJlc3MgcmVjZWl2ZXJBZGRyLCB1aW50W10gY2FwQW1vdW50cywgdWludCBmZWUpIHB1YmxpYyB7CiAgICByZXF1aXJlIChmZWUgPCAxMDApOwogICAgcmVxdWlyZSAoY2FwQW1vdW50cy5sZW5ndGg+MSAmJiBjYXBBbW91bnRzLmxlbmd0aDwyNTYpOwogICAgZm9yICh1aW50OCBpPTE7IGk8Y2FwQW1vdW50cy5sZW5ndGg7IGkrKykgewogICAgICByZXF1aXJlIChjYXBBbW91bnRzW2ldIDw9IGNhcEFtb3VudHNbMF0pOwogICAgfQogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgcmVjZWl2ZXJBZGRyZXNzID0gcmVjZWl2ZXJBZGRyOwogICAgY29udHJpYnV0aW9uQ2FwcyA9IGNhcEFtb3VudHM7CiAgICBmZWVQY3QgPSBfdG9QY3QoZmVlLDEwMCk7CiAgICB3aGl0ZWxpc3RbbXNnLnNlbmRlcl0uYXV0aG9yaXplZCA9IHRydWU7CiAgfQogIAogIC8vIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIHdoZW5ldmVyIGV0aCBpcyBzZW50IGludG8gdGhlIGNvbnRyYWN0LgogIC8vIFRoZSBzZW5kIHdpbGwgZmFpbCB1bmxlc3MgdGhlIGNvbnRyYWN0IGlzIGluIHN0YWdlIG9uZSBhbmQgdGhlIHNlbmRlciBoYXMgYmVlbiB3aGl0ZWxpc3RlZC4KICAvLyBUaGUgYW1vdW50IHNlbnQgaXMgYWRkZWQgdG8gdGhlIGJhbGFuY2UgaW4gdGhlIENvbnRyaWJ1dG9yIHN0cnVjdCBhc3NvY2lhdGVkIHdpdGggdGhlIHNlbmRpbmcgYWRkcmVzcy4KICBmdW5jdGlvbiAoKSBwYXlhYmxlIHB1YmxpYyB7CiAgICBpZiAoY29udHJhY3RTdGFnZSA9PSAxKSB7CiAgICAgIF9ldGhEZXBvc2l0KCk7CiAgICB9IGVsc2UgaWYgKGNvbnRyYWN0U3RhZ2UgPT0gMykgewogICAgICBfZXRoUmVmdW5kKCk7CiAgICB9IGVsc2UgcmV2ZXJ0KCk7CiAgfQogIAogIC8vIEludGVybmFsIGZ1bmN0aW9uIGZvciBoYW5kbGluZyBldGggZGVwb3NpdHMgZHVyaW5nIGNvbnRyYWN0IHN0YWdlIG9uZS4KICBmdW5jdGlvbiBfZXRoRGVwb3NpdCAoKSBpbnRlcm5hbCB7CiAgICBhc3NlcnQgKGNvbnRyYWN0U3RhZ2UgPT0gMSk7CiAgICByZXF1aXJlICh0eC5nYXNwcmljZSA8PSBtYXhHYXNQcmljZSk7CiAgICByZXF1aXJlICh0aGlzLmJhbGFuY2UgPD0gY29udHJpYnV0aW9uQ2Fwc1swXSk7CiAgICB2YXIgYyA9IHdoaXRlbGlzdFttc2cuc2VuZGVyXTsKICAgIHVpbnQgbmV3QmFsYW5jZSA9IGMuYmFsYW5jZS5hZGQobXNnLnZhbHVlKTsKICAgIHJlcXVpcmUgKG5ld0JhbGFuY2UgPj0gY29udHJpYnV0aW9uTWluKTsKICAgIHJlcXVpcmUgKG5ld0JhbGFuY2UgPD0gX2NoZWNrQ2FwKG1zZy5zZW5kZXIpKTsKICAgIGMuYmFsYW5jZSA9IG5ld0JhbGFuY2U7CiAgICBDb250cmlidXRvckJhbGFuY2VDaGFuZ2VkKG1zZy5zZW5kZXIsIG5ld0JhbGFuY2UpOwogIH0KICAKICAvLyBJbnRlcm5hbCBmdW5jdGlvbiBmb3IgaGFuZGxpbmcgZXRoIHJlZnVuZHMgZHVyaW5nIHN0YWdlIHRocmVlLgogIGZ1bmN0aW9uIF9ldGhSZWZ1bmQgKCkgaW50ZXJuYWwgewogICAgYXNzZXJ0IChjb250cmFjdFN0YWdlID09IDMpOwogICAgcmVxdWlyZSAobXNnLnNlbmRlciA9PSBvd25lciB8fCBtc2cuc2VuZGVyID09IHJlY2VpdmVyQWRkcmVzcyk7CiAgICByZXF1aXJlIChtc2cudmFsdWUgPj0gY29udHJpYnV0aW9uTWluKTsKICAgIGV0aFJlZnVuZEFtb3VudC5wdXNoKG1zZy52YWx1ZSk7CiAgICBFdGhSZWZ1bmRSZWNlaXZlZChtc2cuc2VuZGVyLCBtc2cudmFsdWUpOwogIH0KICAKICAvLyBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCB0byB3aXRoZHJhdyBldGggb3IgdG9rZW5zIGZyb20gdGhlIGNvbnRyYWN0LgogIC8vIEl0IGNhbiBvbmx5IGJlIGNhbGxlZCBieSBhZGRyZXNzZXMgdGhhdCBhcmUgd2hpdGVsaXN0ZWQgYW5kIHNob3cgYSBiYWxhbmNlIGdyZWF0ZXIgdGhhbiAwLgogIC8vIElmIGNhbGxlZCBkdXJpbmcgc3RhZ2VzIG9uZSBvciB0d28sIHRoZSBmdWxsIGV0aCBiYWxhbmNlIGRlcG9zaXRlZCBpbnRvIHRoZSBjb250cmFjdCBpcyByZXR1cm5lZCBhbmQgdGhlIGNvbnRyaWJ1dG9yJ3MgYmFsYW5jZSByZXNldCB0byAwLgogIC8vIElmIGNhbGxlZCBkdXJpbmcgc3RhZ2UgdGhyZWUsIHRoZSBjb250cmlidXRvcidzIHVudXNlZCBldGggd2lsbCBiZSByZXR1cm5lZCwgYXMgd2VsbCBhcyBhbnkgYXZhaWxhYmxlIHRva2Vucy4KICAvLyBUaGUgdG9rZW4gYWRkcmVzcyBtYXkgYmUgcHJvdmlkZWQgb3B0aW9uYWxseSB0byB3aXRoZHJhdyB0b2tlbnMgdGhhdCBhcmUgbm90IGN1cnJlbnRseSB0aGUgZGVmYXVsdCB0b2tlbiAoYWlyZHJvcHMpLgogIGZ1bmN0aW9uIHdpdGhkcmF3IChhZGRyZXNzIHRva2VuQWRkcikgcHVibGljIHsKICAgIHZhciBjID0gd2hpdGVsaXN0W21zZy5zZW5kZXJdOwogICAgcmVxdWlyZSAoYy5iYWxhbmNlID4gMCk7CiAgICBpZiAoY29udHJhY3RTdGFnZSA8IDMpIHsKICAgICAgdWludCBhbW91bnRUb1RyYW5zZmVyID0gYy5iYWxhbmNlOwogICAgICBjLmJhbGFuY2UgPSAwOwogICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKGFtb3VudFRvVHJhbnNmZXIpOwogICAgICBDb250cmlidXRvckJhbGFuY2VDaGFuZ2VkKG1zZy5zZW5kZXIsIDApOwogICAgfSBlbHNlIHsKICAgICAgX3dpdGhkcmF3KG1zZy5zZW5kZXIsdG9rZW5BZGRyKTsKICAgIH0gIAogIH0KICAKICAvLyBUaGlzIGZ1bmN0aW9uIGFsbG93cyB0aGUgY29udHJhY3Qgb3duZXIgdG8gZm9yY2UgYSB3aXRoZHJhd2FsIHRvIGFueSBjb250cmlidXRvci4KICBmdW5jdGlvbiB3aXRoZHJhd0ZvciAoYWRkcmVzcyBjb250cmlidXRvciwgYWRkcmVzcyB0b2tlbkFkZHIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZSAoY29udHJhY3RTdGFnZSA9PSAzKTsKICAgIHJlcXVpcmUgKHdoaXRlbGlzdFtjb250cmlidXRvcl0uYmFsYW5jZSA+IDApOwogICAgX3dpdGhkcmF3KGNvbnRyaWJ1dG9yLHRva2VuQWRkcik7CiAgfQogIAogIC8vIFRoaXMgaW50ZXJuYWwgZnVuY3Rpb24gaGFuZGxlcyB3aXRoZHJhd2FscyBkdXJpbmcgc3RhZ2UgdGhyZWUuCiAgLy8gVGhlIGFzc29jaWF0ZWQgZXZlbnRzIHdpbGwgZmlyZSB0byBub3RpZnkgd2hlbiBhIHJlZnVuZCBvciB0b2tlbiBhbGxvY2F0aW9uIGlzIGNsYWltZWQuCiAgZnVuY3Rpb24gX3dpdGhkcmF3IChhZGRyZXNzIHJlY2VpdmVyLCBhZGRyZXNzIHRva2VuQWRkcikgaW50ZXJuYWwgewogICAgYXNzZXJ0IChjb250cmFjdFN0YWdlID09IDMpOwogICAgdmFyIGMgPSB3aGl0ZWxpc3RbcmVjZWl2ZXJdOwogICAgaWYgKHRva2VuQWRkciA9PSAweDAwKSB7CiAgICAgIHRva2VuQWRkciA9IGFjdGl2ZVRva2VuOwogICAgfQogICAgdmFyIGQgPSBkaXN0cmlidXRpb25NYXBbdG9rZW5BZGRyXTsKICAgIHJlcXVpcmUgKCAoZXRoUmVmdW5kQW1vdW50Lmxlbmd0aCA+IGMuZXRoUmVmdW5kKSB8fCBkLnBjdC5sZW5ndGggPiBjLnRva2Vuc0NsYWltZWRbdG9rZW5BZGRyXSApOwogICAgaWYgKGV0aFJlZnVuZEFtb3VudC5sZW5ndGggPiBjLmV0aFJlZnVuZCkgewogICAgICB1aW50IHBjdCA9IF90b1BjdChjLmJhbGFuY2UsZmluYWxCYWxhbmNlKTsKICAgICAgdWludCBldGhBbW91bnQgPSAwOwogICAgICBmb3IgKHVpbnQgaT1jLmV0aFJlZnVuZDsgaTxldGhSZWZ1bmRBbW91bnQubGVuZ3RoOyBpKyspIHsKICAgICAgICBldGhBbW91bnQgPSBldGhBbW91bnQuYWRkKF9hcHBseVBjdChldGhSZWZ1bmRBbW91bnRbaV0scGN0KSk7CiAgICAgIH0KICAgICAgYy5ldGhSZWZ1bmQgPSBldGhSZWZ1bmRBbW91bnQubGVuZ3RoOwogICAgICBpZiAoZXRoQW1vdW50ID4gMCkgewogICAgICAgIHJlY2VpdmVyLnRyYW5zZmVyKGV0aEFtb3VudCk7CiAgICAgICAgRXRoUmVmdW5kZWQocmVjZWl2ZXIsZXRoQW1vdW50KTsKICAgICAgfQogICAgfQogICAgaWYgKGQucGN0Lmxlbmd0aCA+IGMudG9rZW5zQ2xhaW1lZFt0b2tlbkFkZHJdKSB7CiAgICAgIHVpbnQgdG9rZW5BbW91bnQgPSAwOwogICAgICBmb3IgKGk9Yy50b2tlbnNDbGFpbWVkW3Rva2VuQWRkcl07IGk8ZC5wY3QubGVuZ3RoOyBpKyspIHsKICAgICAgICB0b2tlbkFtb3VudCA9IHRva2VuQW1vdW50LmFkZChfYXBwbHlQY3QoYy5iYWxhbmNlLGQucGN0W2ldKSk7CiAgICAgIH0KICAgICAgYy50b2tlbnNDbGFpbWVkW3Rva2VuQWRkcl0gPSBkLnBjdC5sZW5ndGg7CiAgICAgIGlmICh0b2tlbkFtb3VudCA+IDApIHsKICAgICAgICByZXF1aXJlKGQudG9rZW4udHJhbnNmZXIocmVjZWl2ZXIsdG9rZW5BbW91bnQpKTsKICAgICAgICBkLmJhbGFuY2VSZW1haW5pbmcgPSBkLmJhbGFuY2VSZW1haW5pbmcuc3ViKHRva2VuQW1vdW50KTsKICAgICAgICBUb2tlbnNXaXRoZHJhd24ocmVjZWl2ZXIsdG9rZW5BbW91bnQpOwogICAgICB9ICAKICAgIH0KICAgIAogIH0KICAKICAvLyBUaGlzIGZ1bmN0aW9uIGNhbiBvbmx5IGJlIGV4ZWN1dGVkIGJ5IHRoZSBvd25lciwgaXQgYWRkcyBhbiBhZGRyZXNzIHRvIHRoZSB3aGl0ZWxpc3QuCiAgLy8gVG8gZXhlY3V0ZSwgdGhlIGNvbnRyYWN0IG11c3QgYmUgaW4gc3RhZ2UgMSwgdGhlIGFkZHJlc3MgY2Fubm90IGFscmVhZHkgYmUgd2hpdGVsaXN0ZWQsIGFuZCB0aGUgYWRkcmVzcyBjYW5ub3QgYmUgYSBjb250cmFjdCBpdHNlbGYuCiAgLy8gQmxvY2tpbmcgY29udHJhY3RzIGZyb20gYmVpbmcgd2hpdGVsaXN0ZWQgcHJldmVudHMgYXR0YWNrcyBmcm9tIHVuZXhwZWN0ZWQgY29udHJhY3QgdG8gY29udHJhY3QgaW50ZXJhY3Rpb24gLSB2ZXJ5IGltcG9ydGFudCEKICBmdW5jdGlvbiBhdXRob3JpemUgKGFkZHJlc3MgYWRkciwgdWludCBjYXApIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZSAoY29udHJhY3RTdGFnZSA9PSAxKTsKICAgIF9jaGVja1doaXRlbGlzdENvbnRyYWN0KGFkZHIpOwogICAgcmVxdWlyZSAoIXdoaXRlbGlzdFthZGRyXS5hdXRob3JpemVkKTsKICAgIHJlcXVpcmUgKChjYXAgPiAwICYmIGNhcCA8IGNvbnRyaWJ1dGlvbkNhcHMubGVuZ3RoKSB8fCAoY2FwID49IGNvbnRyaWJ1dGlvbk1pbiAmJiBjYXAgPD0gY29udHJpYnV0aW9uQ2Fwc1swXSkgKTsKICAgIHVpbnQgc2l6ZTsKICAgIGFzc2VtYmx5IHsgc2l6ZSA6PSBleHRjb2Rlc2l6ZShhZGRyKSB9CiAgICByZXF1aXJlIChzaXplID09IDApOwogICAgd2hpdGVsaXN0W2FkZHJdLmNhcCA9IGNhcDsKICAgIHdoaXRlbGlzdFthZGRyXS5hdXRob3JpemVkID0gdHJ1ZTsKICB9CiAgCiAgLy8gVGhpcyBmdW5jdGlvbiBpcyB1c2VkIGJ5IHRoZSBvd25lciB0byBhdXRob3JpemUgbWFueSBhZGRyZXNzZXMgaW4gYSBzaW5nbGUgY2FsbC4KICAvLyBFYWNoIGFkZHJlc3Mgd2lsbCBiZSBnaXZlbiB0aGUgc2FtZSBjYXAsIGFuZCB0aGUgY2FwIG11c3QgYmUgb25lIG9mIHRoZSBzdGFuZGFyZCBsZXZlbHMuCiAgZnVuY3Rpb24gYXV0aG9yaXplTWFueSAoYWRkcmVzc1tdIGFkZHIsIHVpbnQgY2FwKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUgKGFkZHIubGVuZ3RoIDwgMjU1KTsKICAgIHJlcXVpcmUgKGNhcCA+IDAgJiYgY2FwIDwgY29udHJpYnV0aW9uQ2Fwcy5sZW5ndGgpOwogICAgZm9yICh1aW50OCBpPTA7IGk8YWRkci5sZW5ndGg7IGkrKykgewogICAgICBhdXRob3JpemUoYWRkcltpXSwgY2FwKTsKICAgIH0KICB9CiAgCiAgLy8gVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHJlbW92ZSBhbiBhZGRyZXNzIGZyb20gdGhlIHdoaXRlbGlzdC4KICAvLyBJdCBtYXkgb25seSBiZSBleGVjdXRlZCBkdXJpbmcgc3RhZ2VzIDEgYW5kIDIuICBBbnkgZXRoIHNlbnQgYnkgdGhlIGFkZHJlc3MgaXMgcmVmdW5kZWQgYW5kIHRoZWlyIHBlcnNvbmFsIGNhcCBpcyBzZXQgdG8gMC4KICAvLyBJdCB3aWxsIHRocm93IGlmIHRoZSBhZGRyZXNzIGlzIHN0aWxsIGF1dGhvcmlzZWQgaW4gdGhlIHdoaXRlbGlzdCBjb250cmFjdC4KICBmdW5jdGlvbiByZXZva2UgKGFkZHJlc3MgYWRkcikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlIChjb250cmFjdFN0YWdlIDwgMyk7CiAgICByZXF1aXJlICh3aGl0ZWxpc3RbYWRkcl0uYXV0aG9yaXplZCk7CiAgICByZXF1aXJlICh3aGl0ZWxpc3RDb250cmFjdC5jaGVja01lbWJlckxldmVsKGFkZHIpID09IDApOwogICAgd2hpdGVsaXN0W2FkZHJdLmF1dGhvcml6ZWQgPSBmYWxzZTsKICAgIGlmICh3aGl0ZWxpc3RbYWRkcl0uYmFsYW5jZSA+IDApIHsKICAgICAgdWludCBhbW91bnRUb1RyYW5zZmVyID0gd2hpdGVsaXN0W2FkZHJdLmJhbGFuY2U7CiAgICAgIHdoaXRlbGlzdFthZGRyXS5iYWxhbmNlID0gMDsKICAgICAgYWRkci50cmFuc2ZlcihhbW91bnRUb1RyYW5zZmVyKTsKICAgICAgQ29udHJpYnV0b3JCYWxhbmNlQ2hhbmdlZChhZGRyLCAwKTsKICAgIH0KICB9CiAgCiAgLy8gVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIG1vZGlmeSB0aGUgY29udHJpYnV0aW9uIGNhcCBvZiBhIHdoaXRlbGlzdGVkIGFkZHJlc3MuCiAgLy8gSWYgdGhlIGN1cnJlbnQgY29udHJpYnV0aW9uIGJhbGFuY2UgZXhjZWVkcyB0aGUgbmV3IGNhcCwgdGhlIGV4Y2VzcyBiYWxhbmNlIGlzIHJlZnVuZGVkLgogIGZ1bmN0aW9uIG1vZGlmeUluZGl2aWR1YWxDYXAgKGFkZHJlc3MgYWRkciwgdWludCBjYXApIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZSAoY29udHJhY3RTdGFnZSA8IDMpOwogICAgcmVxdWlyZSAoY2FwIDwgY29udHJpYnV0aW9uQ2Fwcy5sZW5ndGggfHwgKGNhcCA+PSBjb250cmlidXRpb25NaW4gJiYgY2FwIDw9IGNvbnRyaWJ1dGlvbkNhcHNbMF0pICk7CiAgICBfY2hlY2tXaGl0ZWxpc3RDb250cmFjdChhZGRyKTsKICAgIHZhciBjID0gd2hpdGVsaXN0W2FkZHJdOwogICAgcmVxdWlyZSAoYy5hdXRob3JpemVkKTsKICAgIHVpbnQgYW1vdW50ID0gYy5iYWxhbmNlOwogICAgYy5jYXAgPSBjYXA7CiAgICB1aW50IGNhcEFtb3VudCA9IF9jaGVja0NhcChhZGRyKTsKICAgIGlmIChhbW91bnQgPiBjYXBBbW91bnQpIHsKICAgICAgYy5iYWxhbmNlID0gY2FwQW1vdW50OwogICAgICBhZGRyLnRyYW5zZmVyKGFtb3VudC5zdWIoY2FwQW1vdW50KSk7CiAgICAgIENvbnRyaWJ1dG9yQmFsYW5jZUNoYW5nZWQoYWRkciwgY2FwQW1vdW50KTsKICAgIH0KICB9CiAgCiAgLy8gVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIG1vZGlmeSB0aGUgY2FwIGZvciBhIGNvbnRyaWJ1dGlvbiBsZXZlbC4KICAvLyBUaGUgY2FwIGNhbiBvbmx5IGJlIGluY3JlYXNlZCwgbm90IGRlY3JlYXNlZCwgYW5kIGNhbm5vdCBleGNlZWQgdGhlIGNvbnRyYWN0IGxpbWl0LgogIGZ1bmN0aW9uIG1vZGlmeUxldmVsQ2FwICh1aW50IGxldmVsLCB1aW50IGNhcCkgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlIChjb250cmFjdFN0YWdlIDwgMyk7CiAgICByZXF1aXJlIChsZXZlbCA+IDAgJiYgbGV2ZWwgPCBjb250cmlidXRpb25DYXBzLmxlbmd0aCk7CiAgICByZXF1aXJlIChjb250cmlidXRpb25DYXBzW2xldmVsXSA8IGNhcCAmJiBjb250cmlidXRpb25DYXBzWzBdID49IGNhcCk7CiAgICBjb250cmlidXRpb25DYXBzW2xldmVsXSA9IGNhcDsKICB9CiAgCiAgLy8gVGhpcyBmdW5jdGlvbiBjaGFuZ2VzIGV2ZXJ5IGxldmVsIGNhcCBhdCBvbmNlLgogIGZ1bmN0aW9uIG1vZGlmeUFsbExldmVsQ2FwcyAodWludFtdIGNhcCkgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlIChjb250cmFjdFN0YWdlIDwgMyk7CiAgICByZXF1aXJlIChjYXAubGVuZ3RoID09IGNvbnRyaWJ1dGlvbkNhcHMubGVuZ3RoLTEpOwogICAgZm9yICh1aW50OCBpID0gMTsgaSA8IGNvbnRyaWJ1dGlvbkNhcHMubGVuZ3RoOyBpKyspIHsKICAgICAgbW9kaWZ5TGV2ZWxDYXAoaSwgY2FwW2ktMV0pOwogICAgfQogIH0KICAKICAvLyBUaGlzIGZ1bmN0aW9uIGNhbiBiZSBjYWxsZWQgZHVyaW5nIHN0YWdlcyBvbmUgb3IgdHdvIHRvIG1vZGlmeSB0aGUgbWF4aW11bSBiYWxhbmNlIG9mIHRoZSBjb250cmFjdC4KICAvLyBJdCBjYW4gb25seSBiZSBjYWxsZWQgYnkgdGhlIG93bmVyLiBUaGUgYW1vdW50IGNhbm5vdCBiZSBzZXQgdG8gbG93ZXIgdGhhbiB0aGUgY3VycmVudCBiYWxhbmNlIG9mIHRoZSBjb250cmFjdC4KICBmdW5jdGlvbiBtb2RpZnlNYXhDb250cmFjdEJhbGFuY2UgKHVpbnQgYW1vdW50KSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUgKGNvbnRyYWN0U3RhZ2UgPCAzKTsKICAgIHJlcXVpcmUgKGFtb3VudCA+PSBjb250cmlidXRpb25NaW4pOwogICAgcmVxdWlyZSAoYW1vdW50ID49IHRoaXMuYmFsYW5jZSk7CiAgICBjb250cmlidXRpb25DYXBzWzBdID0gYW1vdW50OwogICAgZm9yICh1aW50OCBpPTE7IGk8Y29udHJpYnV0aW9uQ2Fwcy5sZW5ndGg7IGkrKykgewogICAgICBpZiAoY29udHJpYnV0aW9uQ2Fwc1tpXT5hbW91bnQpIGNvbnRyaWJ1dGlvbkNhcHNbaV09YW1vdW50OwogICAgfQogIH0KICAKICAvLyBUaGlzIGludGVybmFsIGZ1bmN0aW9uIHJldHVybnMgdGhlIGNhcCBhbW91bnQgb2YgYSB3aGl0ZWxpc3RlZCBhZGRyZXNzLgogIGZ1bmN0aW9uIF9jaGVja0NhcCAoYWRkcmVzcyBhZGRyKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICBfY2hlY2tXaGl0ZWxpc3RDb250cmFjdChhZGRyKTsKICAgIHZhciBjID0gd2hpdGVsaXN0W2FkZHJdOwogICAgaWYgKCFjLmF1dGhvcml6ZWQpIHJldHVybiAwOwogICAgaWYgKGMuY2FwPGNvbnRyaWJ1dGlvbkNhcHMubGVuZ3RoKSByZXR1cm4gY29udHJpYnV0aW9uQ2Fwc1tjLmNhcF07CiAgICByZXR1cm4gYy5jYXA7IAogIH0KICAKICAvLyBUaGlzIGludGVybmFsIGZ1bmN0aW9uIGNoZWNrcyBpZiBhbiBhZGRyZXNzIGlzIHdoaXRlbGlzdGVkIGluIHRoZSB3aGl0ZWxpc3QgY29udHJhY3QuCiAgZnVuY3Rpb24gX2NoZWNrV2hpdGVsaXN0Q29udHJhY3QgKGFkZHJlc3MgYWRkcikgaW50ZXJuYWwgewogICAgdmFyIGMgPSB3aGl0ZWxpc3RbYWRkcl07CiAgICBpZiAoIWMuYXV0aG9yaXplZCkgewogICAgICB2YXIgbGV2ZWwgPSB3aGl0ZWxpc3RDb250cmFjdC5jaGVja01lbWJlckxldmVsKGFkZHIpOwogICAgICBpZiAobGV2ZWwgPT0gMCB8fCBsZXZlbCA+PSBjb250cmlidXRpb25DYXBzLmxlbmd0aCkgcmV0dXJuOwogICAgICBjLmNhcCA9IGxldmVsOwogICAgICBjLmF1dGhvcml6ZWQgPSB0cnVlOwogICAgfQogIH0KICAKICAvLyBUaGlzIGNhbGxhYmxlIGZ1bmN0aW9uIHJldHVybnMgdGhlIHRvdGFsIHBvb2wgY2FwLCBjdXJyZW50IGJhbGFuY2UgYW5kIHJlbWFpbmluZyBiYWxhbmNlIHRvIGJlIGZpbGxlZC4KICBmdW5jdGlvbiBjaGVja1Bvb2xCYWxhbmNlICgpIHZpZXcgcHVibGljIHJldHVybnMgKHVpbnQgcG9vbENhcCwgdWludCBiYWxhbmNlLCB1aW50IHJlbWFpbmluZykgewogICAgaWYgKGNvbnRyYWN0U3RhZ2UgPT0gMSkgewogICAgICByZW1haW5pbmcgPSBjb250cmlidXRpb25DYXBzWzBdLnN1Yih0aGlzLmJhbGFuY2UpOwogICAgfSBlbHNlIHsKICAgICAgcmVtYWluaW5nID0gMDsKICAgIH0KICAgIHJldHVybiAoY29udHJpYnV0aW9uQ2Fwc1swXSx0aGlzLmJhbGFuY2UscmVtYWluaW5nKTsKICB9CiAgCiAgLy8gVGhpcyBjYWxsYWJsZSBmdW5jdGlvbiByZXR1cm5zIHRoZSBiYWxhbmNlLCBjb250cmlidXRpb24gY2FwLCBhbmQgcmVtYWluaW5nIGF2YWlsYWJsZSBiYWxhbmNlIG9mIGFueSBjb250cmlidXRvci4KICBmdW5jdGlvbiBjaGVja0NvbnRyaWJ1dG9yQmFsYW5jZSAoYWRkcmVzcyBhZGRyKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50IGJhbGFuY2UsIHVpbnQgY2FwLCB1aW50IHJlbWFpbmluZykgewogICAgdmFyIGMgPSB3aGl0ZWxpc3RbYWRkcl07CiAgICBpZiAoIWMuYXV0aG9yaXplZCkgewogICAgICBjYXAgPSB3aGl0ZWxpc3RDb250cmFjdC5jaGVja01lbWJlckxldmVsKGFkZHIpOwogICAgICBpZiAoY2FwID09IDApIHJldHVybiAoMCwwLDApOwogICAgfSBlbHNlIHsKICAgICAgY2FwID0gYy5jYXA7CiAgICB9CiAgICBiYWxhbmNlID0gYy5iYWxhbmNlOwogICAgaWYgKGNvbnRyYWN0U3RhZ2UgPT0gMSkgewogICAgICBpZiAoY2FwPGNvbnRyaWJ1dGlvbkNhcHMubGVuZ3RoKSB7CiAgICAgICAgY2FwID0gY29udHJpYnV0aW9uQ2Fwc1tjYXBdOwogICAgICB9CiAgICAgIHJlbWFpbmluZyA9IGNhcC5zdWIoYmFsYW5jZSk7CiAgICAgIGlmIChjb250cmlidXRpb25DYXBzWzBdLnN1Yih0aGlzLmJhbGFuY2UpIDwgcmVtYWluaW5nKSByZW1haW5pbmcgPSBjb250cmlidXRpb25DYXBzWzBdLnN1Yih0aGlzLmJhbGFuY2UpOwogICAgfSBlbHNlIHsKICAgICAgcmVtYWluaW5nID0gMDsKICAgIH0KICAgIHJldHVybiAoYmFsYW5jZSwgY2FwLCByZW1haW5pbmcpOwogIH0KICAKICAvLyBUaGlzIGNhbGxhYmxlIGZ1bmN0aW9uIHJldHVybnMgdGhlIHRva2VuIGJhbGFuY2UgdGhhdCBhIGNvbnRyaWJ1dG9yIGNhbiBjdXJyZW50bHkgY2xhaW0uCiAgZnVuY3Rpb24gY2hlY2tBdmFpbGFibGVUb2tlbnMgKGFkZHJlc3MgYWRkciwgYWRkcmVzcyB0b2tlbkFkZHIpIHZpZXcgcHVibGljIHJldHVybnMgKHVpbnQgdG9rZW5BbW91bnQpIHsKICAgIHZhciBjID0gd2hpdGVsaXN0W2FkZHJdOwogICAgdmFyIGQgPSBkaXN0cmlidXRpb25NYXBbdG9rZW5BZGRyXTsKICAgIGZvciAodWludCBpPWMudG9rZW5zQ2xhaW1lZFt0b2tlbkFkZHJdOyBpPGQucGN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgIHRva2VuQW1vdW50ID0gdG9rZW5BbW91bnQuYWRkKF9hcHBseVBjdChjLmJhbGFuY2UsZC5wY3RbaV0pKTsKICAgIH0KICAgIHJldHVybiB0b2tlbkFtb3VudDsKICB9CiAgCiAgLy8gVGhpcyBmdW5jdGlvbiBjbG9zZXMgZnVydGhlciBjb250cmlidXRpb25zIHRvIHRoZSBjb250cmFjdCwgYWR2YW5jaW5nIGl0IHRvIHN0YWdlIHR3by4KICAvLyBJdCBjYW4gb25seSBiZSBjYWxsZWQgYnkgdGhlIG93bmVyLiAgQWZ0ZXIgdGhpcyBjYWxsIGhhcyBiZWVuIG1hZGUsIHdoaXRlbGlzdGVkIGFkZHJlc3NlcwogIC8vIGNhbiBzdGlsbCByZW1vdmUgdGhlaXIgZXRoIGZyb20gdGhlIGNvbnRyYWN0IGJ1dCBjYW5ub3QgY29udHJpYnV0ZSBhbnkgbW9yZS4KICBmdW5jdGlvbiBjbG9zZUNvbnRyaWJ1dGlvbnMgKCkgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlIChjb250cmFjdFN0YWdlID09IDEpOwogICAgY29udHJhY3RTdGFnZSA9IDI7CiAgfQogIAogIC8vIFRoaXMgZnVuY3Rpb24gcmVvcGVucyB0aGUgY29udHJhY3QgdG8gY29udHJpYnV0aW9ucyBhbmQgZnVydGhlciB3aGl0ZWxpc3RpbmcsIHJldHVybmluZyBpdCB0byBzdGFnZSBvbmUuCiAgLy8gSXQgY2FuIG9ubHkgYmUgY2FsbGVkIGJ5IHRoZSBvd25lciBkdXJpbmcgc3RhZ2UgdHdvLgogIGZ1bmN0aW9uIHJlb3BlbkNvbnRyaWJ1dGlvbnMgKCkgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlIChjb250cmFjdFN0YWdlID09IDIpOwogICAgY29udHJhY3RTdGFnZSA9IDE7CiAgfQoKICAvLyBUaGlzIGZ1bmN0aW9uIHNlbmRzIHRoZSBwb29sZWQgZXRoIHRvIHRoZSByZWNlaXZpbmcgYWRkcmVzcywgY2FsY3VsYXRlcyB0aGUgJSBvZiB1bnVzZWQgZXRoIHRvIGJlIHJldHVybmVkLAogIC8vIGFuZCBhZHZhbmNlcyB0aGUgY29udHJhY3QgdG8gc3RhZ2UgdGhyZWUuIEl0IGNhbiBvbmx5IGJlIGNhbGxlZCBieSB0aGUgY29udHJhY3Qgb3duZXIgZHVyaW5nIHN0YWdlcyBvbmUgb3IgdHdvLgogIC8vIFRoZSBhbW91bnQgdG8gc2VuZCAoZ2l2ZW4gaW4gd2VpKSBtdXN0IGJlIHNwZWNpZmllZCBkdXJpbmcgdGhlIGNhbGwuIEFzIHRoaXMgZnVuY3Rpb24gY2FuIG9ubHkgYmUgZXhlY3V0ZWQgb25jZSwKICAvLyBpdCBpcyBWRVJZIElNUE9SVEFOVCBub3QgdG8gZ2V0IHRoZSBhbW91bnQgd3JvbmcuCiAgZnVuY3Rpb24gc3VibWl0UG9vbCAodWludCBhbW91bnRJbldlaSkgcHVibGljIG9ubHlPd25lciBub1JlZW50cmFuY3kgewogICAgcmVxdWlyZSAoY29udHJhY3RTdGFnZSA8IDMpOwogICAgcmVxdWlyZSAoY29udHJpYnV0aW9uTWluIDw9IGFtb3VudEluV2VpICYmIGFtb3VudEluV2VpIDw9IHRoaXMuYmFsYW5jZSk7CiAgICBmaW5hbEJhbGFuY2UgPSB0aGlzLmJhbGFuY2U7CiAgICByZXF1aXJlIChyZWNlaXZlckFkZHJlc3MuY2FsbC52YWx1ZShhbW91bnRJbldlaSkuZ2FzKG1zZy5nYXMuc3ViKDUwMDApKSgpKTsKICAgIGV0aFJlZnVuZEFtb3VudC5wdXNoKHRoaXMuYmFsYW5jZSk7CiAgICBjb250cmFjdFN0YWdlID0gMzsKICAgIFBvb2xTdWJtaXR0ZWQocmVjZWl2ZXJBZGRyZXNzLCBhbW91bnRJbldlaSk7CiAgfQogIAogIC8vIFRoaXMgZnVuY3Rpb24gb3BlbnMgdGhlIGNvbnRyYWN0IHVwIGZvciB0b2tlbiB3aXRoZHJhd2Fscy4KICAvLyBJdCBjYW4gb25seSBiZSBjYWxsZWQgYnkgdGhlIG93bmVyIGR1cmluZyBzdGFnZSAzLiAgVGhlIG93bmVyIHNwZWNpZmllcyB0aGUgYWRkcmVzcyBvZiBhbiBFUkMyMCB0b2tlbgogIC8vIGNvbnRyYWN0IHRoYXQgdGhpcyBjb250cmFjdCBoYXMgYSBiYWxhbmNlIGluLCBhbmQgb3B0aW9uYWxseSBhIGJvb2wgdG8gcHJldmVudCB0aGlzIHRva2VuIGZyb20gYmVpbmcKICAvLyB0aGUgZGVmYXVsdCB3aXRoZHJhd2FsIChpbiB0aGUgZXZlbnQgb2YgYW4gYWlyZHJvcCwgZm9yIGV4YW1wbGUpLgogIGZ1bmN0aW9uIGVuYWJsZVRva2VuV2l0aGRyYXdhbHMgKGFkZHJlc3MgdG9rZW5BZGRyLCBib29sIG5vdERlZmF1bHQpIHB1YmxpYyBvbmx5T3duZXIgbm9SZWVudHJhbmN5IHsKICAgIHJlcXVpcmUgKGNvbnRyYWN0U3RhZ2UgPT0gMyk7CiAgICBpZiAobm90RGVmYXVsdCkgewogICAgICByZXF1aXJlIChhY3RpdmVUb2tlbiAhPSAweDAwKTsKICAgIH0gZWxzZSB7CiAgICAgIGFjdGl2ZVRva2VuID0gdG9rZW5BZGRyOwogICAgfQogICAgdmFyIGQgPSBkaXN0cmlidXRpb25NYXBbdG9rZW5BZGRyXTsgICAgCiAgICBpZiAoZC5wY3QubGVuZ3RoPT0wKSBkLnRva2VuID0gRVJDMjAodG9rZW5BZGRyKTsKICAgIHVpbnQgYW1vdW50ID0gZC50b2tlbi5iYWxhbmNlT2YodGhpcykuc3ViKGQuYmFsYW5jZVJlbWFpbmluZyk7CiAgICByZXF1aXJlIChhbW91bnQgPiAwKTsKICAgIGlmIChmZWVQY3QgPiAwKSB7CiAgICAgIHJlcXVpcmUgKGQudG9rZW4udHJhbnNmZXIob3duZXIsX2FwcGx5UGN0KGFtb3VudCxmZWVQY3QpKSk7CiAgICB9CiAgICBhbW91bnQgPSBkLnRva2VuLmJhbGFuY2VPZih0aGlzKS5zdWIoZC5iYWxhbmNlUmVtYWluaW5nKTsKICAgIGQuYmFsYW5jZVJlbWFpbmluZyA9IGQudG9rZW4uYmFsYW5jZU9mKHRoaXMpOwogICAgZC5wY3QucHVzaChfdG9QY3QoYW1vdW50LGZpbmFsQmFsYW5jZSkpOwogIH0KICAKICAvLyBUaGlzIGlzIGEgc3RhbmRhcmQgZnVuY3Rpb24gcmVxdWlyZWQgZm9yIEVSQzIyMyBjb21wYXRpYmlsaXR5LgogIGZ1bmN0aW9uIHRva2VuRmFsbGJhY2sgKGFkZHJlc3MgZnJvbSwgdWludCB2YWx1ZSwgYnl0ZXMgZGF0YSkgcHVibGljIHsKICAgIEVSQzIyM1JlY2VpdmVkIChmcm9tLCB2YWx1ZSk7CiAgfQogIAp9'.
	

]
