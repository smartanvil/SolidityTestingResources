Class {
	#name : #SRT0064353c557afe927866f0f3b748bc271c385d71,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT0064353c557afe927866f0f3b748bc271c385d71 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7Cgpjb250cmFjdCBCYXNlIHsKICBmdW5jdGlvbiBpc0NvbnRyYWN0KGFkZHJlc3MgX2FkZHIpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMoYm9vbCkgewogICAgdWludCBzaXplOwogICAgaWYgKF9hZGRyID09IDApIHJldHVybiBmYWxzZTsKICAgIGFzc2VtYmx5IHsKICAgICAgICBzaXplIDo9IGV4dGNvZGVzaXplKF9hZGRyKQogICAgfQogICAgcmV0dXJuIHNpemUgPiAwOwogIH0KfQoKLy9UT0RPIGNoYW5nZSB0byBpbnRlcmZhY2UgaWYgdGhhdCBldmVyIGdldHMgYWRkZWQgdG8gdGhlIHBhcnNlcgpjb250cmFjdCBSbmdSZXF1ZXN0ZXIgewogIGZ1bmN0aW9uIGFjY2VwdFJhbmRvbShieXRlczMyIGlkLCBieXRlcyByZXN1bHQpOwp9CgovL1RPRE8gY2hhbmdlIHRvIGludGVyZmFjZSBpZiB0aGF0IGV2ZXIgZ2V0cyBhZGRlZCB0byB0aGUgcGFyc2VyCmNvbnRyYWN0IENyeXB0b0x1Y2tSbmcgewogIGZ1bmN0aW9uIHJlcXVlc3RSYW5kb20odWludDggbnVtYmVyT2ZCeXRlcykgcGF5YWJsZSByZXR1cm5zKGJ5dGVzMzIpOwoKICBmdW5jdGlvbiBnZXRGZWUoKSByZXR1cm5zKHVpbnQyNTYpOwp9CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKGEgPT0gMCkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9Cgpjb250cmFjdCBTdGF0ZVF1aWNrRXRoIGlzIE93bmFibGUgewogIC8vQ2VydGFpbiBwYXJhbWV0ZXJzIG9mIHRoZSBnYW1lIGNhbiBvbmx5IGJlIGNoYW5nZWQgaWYgdGhlIGdhbWUgaXMgc3RvcHBlZC4KICAvL1J1bGVzIHNob3VsZG4ndCBiZSBjaGFuZ2VkIHdoaWxlIHRoZSBnYW1lIGlzIGdvaW5nIG9uIDopCiAgLy8KICAvL1RoaXMgd2F5LCB0aGUgb3duZXIgY2FuJ3QgZS5nLiBsb2NrIHVwIGNvbnRyaWJ1dGVkIGZ1bmRzIG9yIHN1Y2gsIAogIC8vYnkgdXBkYXRpbmcgdGhlIGdhbWUgcGFyYW1zIHRvIGJhZCB2YWx1ZXMsIGxpa2UgbWluaW11bSAxIG1pbGxpb24gcGFydGljaXBhbnRzLCBldGMuCiAgbW9kaWZpZXIgZ2FtZVN0b3BwZWQgewogICAgcmVxdWlyZSghZ2FtZVJ1bm5pbmcpOwogICAgCiAgICBfOwogIH0KCiAgdWludDE2IGludGVybmFsIGNvbnN0YW50IE1BTlVBTF9XSVRIRFJBV19JTlRFUlZBTCA9IDEgaG91cnM7CiAgCiAgYm9vbCBwdWJsaWMgZ2FtZVJ1bm5pbmc7CiAgCiAgLy9JbnN0ZWFkIG9mIGJlaW5nIGFibGUgdG8gc3RvcCB0aGUgZ2FtZSBvdXRyaWdodCwgdGhlIG93bmVyIGNhbiBvbmx5ICJzY2hlZHVsZSIKICAvL2ZvciB0aGUgZ2FtZSB0byBzdG9wIGF0IHRoZSBlbmQgb2YgdGhlIGN1cnJlbnQgcm91bmQuCiAgLy9HYW1lIHN0YXlzIGxvY2tlZCB1bnRpbCBleHBsaWNpdGx5IHJlc3RhcnRlZC4KICBib29sIHB1YmxpYyBzdG9wR2FtZU9uTmV4dFJvdW5kOwoKICAvL1doZW4gc29tZW9uZSBzZW5kcyBFVEggdG8gdGhlIGNvbnRyYWN0LCB3aGF0J3MgdGhlIG1pbmltdW0gZ2FzIHRoZSB0eCBzaG91bGQgaGF2ZSwKICAvL3NvIHRoYXQgaXQgY2FuIGV4ZWN1dGUgdGhlIGRyYXcuIAogIHVpbnQzMiBwdWJsaWMgbWluR2FzRm9yRHJhd2luZyA9IDM1MDAwMDsKICAKICAvL0lkZWFsbHksIHdlIGRvbnQgd2FudCB0aGUgZXhlY3V0aW9uIG9mIGEgbG90dGVyeSB0byBsYXN0IHRvbyBsb25nLCAKICAvL3NvIHJlcXVpcmUgYSBkZWNlbnQgZ2FzIHByaWNlIHdoZW4gZHJhd2luZy4gNiBHV0VJCiAgdWludDI1NiBwdWJsaWMgbWluR2FzUHJpY2VGb3JEcmF3aW5nID0gNjAwMDAwMDAwMDsKCiAgLy9UaGlzIHJld2FyZCBzaG91bGQgY292ZXIgdGhlIGdhcyBjb3N0IGZvciBkcmF3aW5nLgogIC8vQXQgdGhlIGVuZCBvZiBlYWNoIGxvdHRlcnksIHRoZSBkcmF3ZXIgd2lsbCBiZSByZWZ1bmRlZCB0aGlzIGFtb3VudCAKICAvLygwLjAwMiBldGggdG8gc3RhcnQgd2l0aCkgLSBhYm91dCAzNTBrIGdhcyBhdCA2IGd3ZWkgcHJpY2UuCiAgdWludDI1NiBwdWJsaWMgcmV3YXJkRm9yRHJhd2luZyA9IDIgZmlubmV5OwoKICAvL0hvdXNlIHRha2VzIGEgMSUgZmVlICgxMC8xMDAwKS4gQ2FuIGJlIHVwZGF0ZWQgd2hlbiBnYW1lIGlzIHN0b3BwZWQuCiAgLy9WYWx1ZSBpcyBkaXZpZGVkIGJ5IDEwMDAgaW5zdGVhZCBvZiAxMDAsIHRvIGJlIGFibGUgdG8gdXNlIGZyYWN0aW9uYWwgcGVyY2VudGFnZXMgZS5nLiwgMS41JQogIHVpbnQ4IHB1YmxpYyBob3VzZUZlZSA9IDEwOwoKICAvL01pbiBhbmQgbWF4IGNvbnRyaWJ1dGlvbiBvZiB0aGlzIGxvdHRlcnkuICAgCiAgdWludDI1NiBwdWJsaWMgbWluQ29udHJpYnV0aW9uID0gMjAgZmlubmV5OwogIHVpbnQyNTYgcHVibGljIG1heENvbnRyaWJ1dGlvbiA9IDEgZXRoZXI7CiAgCiAgLy9NYXggYm9udXMgdGlja2V0cyBmb3IgZHJhd2VyLgogIHVpbnQyNTYgcHVibGljIG1heEJvbnVzVGlja2V0cyA9IDU7CiAgCiAgLy9QZXJjZW50YWdlIG9mIHRpY2tldHMgcHVyY2hhc2VkLCBhd2FyZGVkIGFzIGJvbnVzIHRvIHRoZSBkcmF3ZXIuCiAgdWludDggcHVibGljIGJvbnVzVGlja2V0c1BlcmNlbnRhZ2UgPSAxOwogIAogIC8vTWluaW11bSBlbnRyaWVzIHJlcXVpcmVkIHRvIGFsbG93IGEgZHJhdyB0byBoYXBwZW4KICB1aW50MTYgcHVibGljIHJlcXVpcmVkRW50cmllcyA9IDU7CiAgCiAgLy9BbGxvdyBhdCBsZWFzdCA2MCBtaW51dGVzIGJldHdlZW4gZHJhd3MsIHRvIGhhdmUgYSBtaW5pbWFsbHkgZGVjZW50IHByaXplIHBvb2wuCiAgdWludDI1NiBwdWJsaWMgcmVxdWlyZWRUaW1lQmV0d2VlbkRyYXdzID0gNjAgbWludXRlczsKCiAgYWRkcmVzcyBwdWJsaWMgcm5nQWRkcmVzczsKICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogIC8vT3duZXIgbWV0aG9kcwoKICAvL0dhbWUgcnVsZXMgLSBjYW4gb25seSBiZSBjaGFuZ2VkIGlmIHRoZSBnYW1lIGlzIHN0b3BwZWQuCiAgZnVuY3Rpb24gdXBkYXRlSG91c2VGZWUodWludDggX3ZhbHVlKSBwdWJsaWMgb25seU93bmVyIGdhbWVTdG9wcGVkIHsKICAgIGhvdXNlRmVlID0gX3ZhbHVlOwogIH0KCiAgZnVuY3Rpb24gdXBkYXRlTWluQ29udHJpYnV0aW9uKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgb25seU93bmVyIGdhbWVTdG9wcGVkIHsKICAgIG1pbkNvbnRyaWJ1dGlvbiA9IF92YWx1ZTsKICB9CgogIGZ1bmN0aW9uIHVwZGF0ZU1heENvbnRyaWJ1dGlvbih1aW50MjU2IF92YWx1ZSkgcHVibGljIG9ubHlPd25lciBnYW1lU3RvcHBlZCB7CiAgICBtYXhDb250cmlidXRpb24gPSBfdmFsdWU7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVSZXF1aXJlZEVudHJpZXModWludDE2IF92YWx1ZSkgcHVibGljIG9ubHlPd25lciBnYW1lU3RvcHBlZCB7CiAgICByZXF1aXJlZEVudHJpZXMgPSBfdmFsdWU7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVSZXF1aXJlZFRpbWVCZXR3ZWVuRHJhd3ModWludDI1NiBfdmFsdWUpIHB1YmxpYyBvbmx5T3duZXIgZ2FtZVN0b3BwZWQgewogICAgcmVxdWlyZWRUaW1lQmV0d2VlbkRyYXdzID0gX3ZhbHVlOwogIH0KICAvL0VORCBvZiBHYW1lIHJ1bGVzCiAgLy8vLy8KCiAgLy9Mb2dpc3RpY3MKICBmdW5jdGlvbiB1cGRhdGVNYXhCb251c1RpY2tldHModWludDI1NiBfdmFsdWUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgbWF4Qm9udXNUaWNrZXRzID0gX3ZhbHVlOwogIH0KCiAgZnVuY3Rpb24gdXBkYXRlQm9udXNUaWNrZXRzUGVyY2VudGFnZSh1aW50OCBfdmFsdWUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgYm9udXNUaWNrZXRzUGVyY2VudGFnZSA9IF92YWx1ZTsKICB9CgogIGZ1bmN0aW9uIHVwZGF0ZVN0b3BHYW1lT25OZXh0Um91bmQoYm9vbCBfdmFsdWUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgc3RvcEdhbWVPbk5leHRSb3VuZCA9IF92YWx1ZTsKICB9CgogIGZ1bmN0aW9uIHJlc3RhcnRHYW1lKCkgcHVibGljIG9ubHlPd25lciB7CiAgICBnYW1lUnVubmluZyA9IHRydWU7CiAgfQogIAogIGZ1bmN0aW9uIHVwZGF0ZU1pbkdhc0ZvckRyYXdpbmcodWludDMyIG5ld0dhc0Ftb3VudCkgcHVibGljIG9ubHlPd25lciB7CiAgICBtaW5HYXNGb3JEcmF3aW5nID0gbmV3R2FzQW1vdW50OwogIH0KCiAgZnVuY3Rpb24gdXBkYXRlTWluR2FzUHJpY2VGb3JEcmF3aW5nKHVpbnQzMiBuZXdHYXNQcmljZSkgcHVibGljIG9ubHlPd25lciB7CiAgICBtaW5HYXNQcmljZUZvckRyYXdpbmcgPSBuZXdHYXNQcmljZTsKICB9CgogIGZ1bmN0aW9uIHVwZGF0ZVJuZ0FkZHJlc3MoYWRkcmVzcyBuZXdBZGRyZXNzKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUocm5nQWRkcmVzcyAhPSAweDApOwogICAgcm5nQWRkcmVzcyA9IG5ld0FkZHJlc3M7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVSZXdhcmRGb3JEcmF3aW5nKHVpbnQyNTYgbmV3UmV3YXJkRm9yRHJhd2luZykgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKG5ld1Jld2FyZEZvckRyYXdpbmcgPiAwKTsKCiAgICByZXdhcmRGb3JEcmF3aW5nID0gbmV3UmV3YXJkRm9yRHJhd2luZzsKICB9CiAgLy9FTkQgTG9naXN0aWNzCgogIC8vRU5EIG93bmVyIG1ldGhvZHMgIAp9CgovLwovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIDw8PDxDb250cmFjdCBiZWdpbnMgaGVyZT4+Pj4KLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLwovLyogQ3J5cHRvTHVjayBMb3R0ZXJ5IEdhbWUgCi8vKiBRdWljaywgRVRICi8vKiBWZXJzaW9uOiAxCi8vKiBXZWJzaXRlOiBodHRwczovL2NyeXB0b2x1Y2suZnVuCi8vKgpjb250cmFjdCBDcnlwdG9MdWNrUXVpY2tFdGhWMSBpcyBSbmdSZXF1ZXN0ZXIsIFN0YXRlUXVpY2tFdGgsIEJhc2UgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwoKICBtb2RpZmllciBvbmx5Um5nIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBybmdBZGRyZXNzKTsKICAgIAogICAgXzsKICB9CgogIGV2ZW50IExvZ0xvdHRlcnlSZXN1bHQoCiAgICB1aW50MzIgaW5kZXhlZCBsb3R0ZXJ5SWQsIAogICAgdWludDggc3RhdHVzLAogICAgYnl0ZXMzMiBpbmRleGVkIG9yYWNsaXplSWQsIAogICAgYnl0ZXMgb3JhY2xpemVSZXN1bHQKICApOwogIAogIHN0cnVjdCBMb3R0ZXJ5IHsKICAgIHVpbnQyNTYgcHJpemVQb29sOwogICAgdWludDI1NiB0b3RhbENvbnRyaWJ1dGlvbnM7CiAgICB1aW50MjU2IG9yYWNsaXplRmVlczsKICAgIAogICAgdWludDI1NiBkcmF3ZXJCb251c1RpY2tldHM7CiAgICAKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CiAgICBhZGRyZXNzW10gcGFydGljaXBhbnRzOwogICAgICAKICAgIGFkZHJlc3Mgd2lubmVyOwogICAgYWRkcmVzcyBkcmF3ZXI7CgogICAgYnl0ZXMzMltdIG9yYWNsaXplSWRzOwogICAgYnl0ZXMgb3JhY2xpemVSZXN1bHQ7CgogICAgdWludDI1NiB3aW5uaW5nTnVtYmVyOwoKICAgIC8vMCA9PiBpbml0aWFsIHN0YXRlLCBvcGVuCiAgICAvLzEgPT4gZmluYWxpemVkIHdpdGggc3VjY2VzcwogICAgLy8yID0+IGZpbmFsaXplZCB3aXRoIGVycm9yIChlLmcuIGR1ZSB0byBPcmFjbGl6ZSBub3QgcmV0dXJuaW5nIHByb3BlciByZXN1bHRzIGV0YykKICAgIHVpbnQ4IHN0YXR1czsKCiAgICBib29sIGF3YWl0aW5nT3JhY2xpemVDYWxsYmFjazsKICB9CiAgCiAgYm9vbCBwdWJsaWMgdXNlT3JhY2xpemU7CiAgLy9LZWVwIHRyYWNrIG9mIGFsbCBsb3R0ZXJpZXMuIFN0YXRzIGZ0dwogIHVpbnQzMiBwdWJsaWMgY3VycmVudExvdHRlcnlJZCA9IDA7CiAgbWFwcGluZyAodWludDMyID0+IExvdHRlcnkpIHB1YmxpYyBsb3R0ZXJpZXM7CiAgCiAgLy8xIGZpbm5leSA9PSAwLjAwMSBFVEguIEVzdGltYXRpbmcgZm9yIGEgcnVuIG9mIEVUSCB0byAxMDAwIFVTRCwgdGhhdCdzICQxIHBlciB0aWNrZXQuCiAgdWludDI1NiBwdWJsaWMgdGlja2V0UHJpY2UgPSAxIGZpbm5leTsKICAKICAvL1RpbWVzdGFtcCB0byBrZWVwIHRyYWNrIG9mIHdoZW4gdGhlIGxhc3QgZHJhdyBoYXBwZW5lZAogIHVpbnQyNTYgcHVibGljIGxhc3REcmF3VHM7CiAgCiAgdWludDI1NiBwdWJsaWMgaG91c2VCYWxhbmNlID0gMDsKICAKICBmdW5jdGlvbiBDcnlwdG9MdWNrUXVpY2tFdGhWMShhZGRyZXNzIF9ybmdBZGRyZXNzLCBib29sIF91c2VPcmFjbGl6ZSkgewogICAgc3RvcEdhbWVPbk5leHRSb3VuZCA9IGZhbHNlOwogICAgZ2FtZVJ1bm5pbmcgPSB0cnVlOwogICAgCiAgICByZXF1aXJlKF9ybmdBZGRyZXNzICE9IDB4MCk7CgogICAgcm5nQWRkcmVzcyA9IF9ybmdBZGRyZXNzOwogICAgdXNlT3JhY2xpemUgPSBfdXNlT3JhY2xpemU7CiAgICAKICAgIC8vSW5pdGlhbGl6ZSBsb3R0ZXJ5IGRyYXcgdG8gY29udHJhY3QgZGVwbG95IHRpbWUgLSAKICAgIC8vdGhhdCdzIHdoZW4gd2UgInN0YXJ0IiB0aGUgbG90dGVyeS4KICAgIGxhc3REcmF3VHMgPSBibG9jay50aW1lc3RhbXA7CiAgfQoKICAvL0NvbnZlbmllbmNlIG1ldGhvZCB0byByZXR1cm4gdGhlIGN1cnJlbnQgbG90dGVyeQogIGZ1bmN0aW9uIGN1cnJlbnRMb3R0ZXJ5KCkgdmlldyBpbnRlcm5hbCByZXR1cm5zIChMb3R0ZXJ5IHN0b3JhZ2UpIHsKICAgIHJldHVybiBsb3R0ZXJpZXNbY3VycmVudExvdHRlcnlJZF07CiAgfQoKICAvLy8vLy8vLy8vLy8vLy8vLwogIC8vTG90dGVyeSBmbG93OgogIC8vU1RFUCAxOiBzZW5kIEVUSCB0byBlbnRlciBsb3R0ZXJ5IAogIGZ1bmN0aW9uICgpIHB1YmxpYyBwYXlhYmxlIHsKICAgIC8vIERpc2FsbG93IGNvbnRyYWN0cyAtIHRoaXMgYXZvaWRzIGEgd2hvbGUgaG9zdCBvZiBpc3N1ZXMsIGF1dG9tYXRpb25zIGV0Yy4KICAgIHJlcXVpcmUoIWlzQ29udHJhY3QobXNnLnNlbmRlcikpOwogICAgCiAgICAvLyBEaXNhbGxvdyBkZXBvc2l0cyBpZiBnYW1lIGlzIG5vdCBydW5uaW5nCiAgICByZXF1aXJlKGdhbWVSdW5uaW5nKTsKICAgIAogICAgLy8gUmVxdWlyZSB0aGUgc2VuZGVyIHRvIGJlIGFibGUgdG8gcHVyY2hhc2UgYXQgbGVhc3QgMSB0aWNrZXQKICAgIHJlcXVpcmUobXNnLnZhbHVlID49IHRpY2tldFByaWNlKTsKICAgIAogICAgdWludDI1NiBleGlzdGluZ0JhbGFuY2UgPSBjdXJyZW50TG90dGVyeSgpLmJhbGFuY2VzW21zZy5zZW5kZXJdOwogICAgCiAgICAvL1RvdGFsIGNvbnRyaWJ1dGlvbiBzaG91bGQgYmUgYXQgbGVhc3QgdGhlIG1pbmltdW0gY29udHJpYnV0aW9uICgwLjA1IEVUSCB0byBzdGFydCB3aXRoKQogICAgcmVxdWlyZShtc2cudmFsdWUgKyBleGlzdGluZ0JhbGFuY2UgPj0gbWluQ29udHJpYnV0aW9uKTsKICAgIC8vQnV0IHRoZWlyIHRvdGFsIGNvbnRyaWJ1dGlvbiBtdXN0IG5vdCBleGNlZWQgbWF4IGNvbnRyaWJ1dGlvbgogICAgcmVxdWlyZShtc2cudmFsdWUgKyBleGlzdGluZ0JhbGFuY2UgPD0gbWF4Q29udHJpYnV0aW9uKTsKICAgIAogICAgdXBkYXRlUGxheWVyQmFsYW5jZShjdXJyZW50TG90dGVyeUlkKTsKICAgIAogICAgLy9JZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBhIGRyYXcgYXJlIG1ldCwgYW5kIHRoZSBnYXMgcHJpY2UgYW5kIGdhcyBsaW1pdCBhcmUgT0sgYXMgd2VsbCwKICAgIC8vZXhlY3V0ZSB0aGUgZHJhdy4KICAgIGlmIChtdXN0RHJhdygpICYmIGdhc1JlcXVpcmVtZW50c09rKCkpIHsKICAgICAgZHJhdygpOwogICAgfQogIH0KCiAgLy9FbnN1cmUgdGhlcmUncyBlbm91Z2ggZ2FzIGxlZnQgKG1pbkdhc0ZvckRyYXdpbmcgaXMgYW4gZXN0aW1hdGUpCiAgLy9hbmQgdGhhdCB0aGUgZ2FzIHByaWNlIGlzIGVub3VnaCB0byBlbnN1cmUgaXQgZG9lc250IHRha2UgYW4gZXRlcm5pdHkgdG8gcHJvY2VzcyB0aGUgZHJhdyB0eC4KICBmdW5jdGlvbiBnYXNSZXF1aXJlbWVudHNPaygpIHZpZXcgcHJpdmF0ZSByZXR1cm5zKGJvb2wpIHsKICAgIHJldHVybiAobXNnLmdhcyA+PSBtaW5HYXNGb3JEcmF3aW5nKSAmJiAodHguZ2FzcHJpY2UgPj0gbWluR2FzUHJpY2VGb3JEcmF3aW5nKTsKICB9CgogIC8vLy8vLy8vLy8vLy8vLy8vCiAgLy9TVEVQIDI6IHN0b3JlIGJhbGFuY2UKICAvLwogIC8vV2hlbiBzb21lb25lIHNlbmRzIEV0aGVyIHRvIHRoaXMgY29udHJhY3QsIHdlIGtlZXAgdHJhY2sgb2YgdGhlaXIgdG90YWwgY29udHJpYnV0aW9uLgogIGZ1bmN0aW9uIHVwZGF0ZVBsYXllckJhbGFuY2UodWludDMyIGxvdHRlcnlJZCkgcHJpdmF0ZSByZXR1cm5zKHVpbnQpIHsKICAgIExvdHRlcnkgc3RvcmFnZSBsb3QgPSBsb3R0ZXJpZXNbbG90dGVyeUlkXTsKICAgIAogICAgLy9pZiBjdXJyZW50IGxvdHRlcnkgaXMgbG9ja2VkLCBzaW5jZSB3ZSBtYWRlIHRoZSBjYWxsIHRvIE9yYWNsaXplIGZvciB0aGUgcmFuZG9tIG51bWJlciwKICAgIC8vYnV0IHdlIGhhdmVuJ3QgcmVjZWl2ZWQgdGhlIHJlc3BvbnNlIHlldCwgcHV0IHRoZSBwbGF5ZXIncyBldGhlciBpbnRvIHRoZSBuZXh0IGxvdHRlcnkgaW5zdGVhZC4KICAgIGlmIChsb3QuYXdhaXRpbmdPcmFjbGl6ZUNhbGxiYWNrKSB7CiAgICAgIHVwZGF0ZVBsYXllckJhbGFuY2UobG90dGVyeUlkICsgMSk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBhZGRyZXNzIHBhcnRpY2lwYW50ID0gbXNnLnNlbmRlcjsKICAgIAogICAgLy9JZiB3ZSBkb250IGhhdmUgdGhpcyBwYXJ0aWNpcGFudCBpbiB0aGUgYmFsYW5jZXMgbWFwcGluZywgCiAgICAvL3RoZW4gaXQncyBhIG5ldyBhZGRyZXNzLCBzbyBhZGQgaXQgdG8gdGhlIHBhcnRpY2lwYW50cyBsaXN0LCB0byBrZWVwIHRyYWNrIG9mIHRoZSBhZGRyZXNzLgogICAgaWYgKGxvdC5iYWxhbmNlc1twYXJ0aWNpcGFudF0gPT0gMCkgewogICAgICBsb3QucGFydGljaXBhbnRzLnB1c2gocGFydGljaXBhbnQpOwogICAgfQogICAgCiAgICAvL0luY3JlYXNlIHRoZSB0b3RhbCBjb250cmlidXRpb24gb2YgdGhpcyBhZGRyZXNzIChwZW9wbGUgY2FuIGJ1eSBtdWx0aXBsZSB0aW1lcyBmcm9tIHRoZSBzYW1lIGFkZHJlc3MpCiAgICBsb3QuYmFsYW5jZXNbcGFydGljaXBhbnRdID0gbG90LmJhbGFuY2VzW3BhcnRpY2lwYW50XS5hZGQobXNnLnZhbHVlKTsKICAgIC8vQW5kIHRoZSBwcml6ZSBwb29sLCBvZiBjb3Vyc2UuCiAgICBsb3QucHJpemVQb29sID0gbG90LnByaXplUG9vbC5hZGQobXNnLnZhbHVlKTsKICAgIAogICAgcmV0dXJuIGxvdC5iYWxhbmNlc1twYXJ0aWNpcGFudF07CiAgfQogIAogIC8vLy8vLy8vLy8vLy8vLy8vCiAgLy9TVEVQIDM6IHdoZW4gc29tZW9uZSBjb250cmlidXRlcyB0byB0aGUgbG90dGVyeSwgY2hlY2sgdG8gc2VlIGlmIHdlJ3ZlIG1ldCB0aGUgcmVxdWlyZW1lbnRzIGZvciBhIGRyYXcgeWV0LgogIGZ1bmN0aW9uIG11c3REcmF3KCkgdmlldyBwcml2YXRlIHJldHVybnMgKGJvb2wpIHsKICAgIExvdHRlcnkgbWVtb3J5IGxvdCA9IGN1cnJlbnRMb3R0ZXJ5KCk7CiAgICAKICAgIC8vQXQgbGVhc3QgNjAgbWlucyBoYXZlIGVsYXBzZWQgc2luY2UgdGhlIGxhc3QgZHJhdwogICAgYm9vbCB0aW1lRGlmZk9rID0gbm93IC0gbGFzdERyYXdUcyA+PSByZXF1aXJlZFRpbWVCZXR3ZWVuRHJhd3M7CiAgICAKICAgIC8vV2UgaGF2ZSBhdCBsZWFzdCA1IHBhcnRpY2lwYW50cwogICAgYm9vbCBtaW5QYXJ0aWNpcGFudHNPayA9IGxvdC5wYXJ0aWNpcGFudHMubGVuZ3RoID49IHJlcXVpcmVkRW50cmllczsKCiAgICByZXR1cm4gbWluUGFydGljaXBhbnRzT2sgJiYgdGltZURpZmZPazsKICB9CgogIC8vLy8vLy8vLy8vLy8vLy8vCiAgLy9TVEVQIDQ6IElmIFNURVAgMyBpcyBhLW9rLCBleGVjdXRlIHRoZSBkcmF3LCByZXF1ZXN0IGEgcmFuZG9tIG51bWJlciBmcm9tIG91ciBSTkcgcHJvdmlkZXIuCiAgLy9GbG93IHdpbGwgYmUgcmVzdW1lZCB3aGVuIHRoZSBSTkcgcHJvdmlkZXIgY29udHJhY3QgcmVjZWl2ZXMgdGhlIE9yYWNsaXplIGNhbGxiYWNrLCBhbmQgaW4gdHVybgogIC8vY2FsbHMgYmFjayBpbnRvIHRoZSBsb3R0ZXJ5IGNvbnRyYWN0LgogIGZ1bmN0aW9uIGRyYXcoKSBwcml2YXRlIHsKICAgIExvdHRlcnkgc3RvcmFnZSBsb3QgPSBjdXJyZW50TG90dGVyeSgpOwogICAgCiAgICBsb3QuYXdhaXRpbmdPcmFjbGl6ZUNhbGxiYWNrID0gdHJ1ZTsKICAgIAogICAgLy9SZWNvcmQgdG90YWwgY29udHJpYnV0aW9ucyBmb3IgcG9zdGVyaXR5IGFuZCBmb3IgY29ycmVjdCBjYWxjdWxhdGlvbiBvZiB0aGUgcmVzdWx0LAogICAgLy9zaW5jZSB0aGUgcHJpemUgcG9vbCBpcyB1c2VkIHRvIHBheSBmb3IgdGhlIE9yYWNsaXplIGZlZXMuCiAgICBsb3QudG90YWxDb250cmlidXRpb25zID0gbG90LnByaXplUG9vbDsKCiAgICAvL1RyYWNrIHdobyB3YXMgdGhlIGRyYXdlciBvZiB0aGUgbG90dGVyeSwgdG8gYmUgYXdhcmRlZCB0aGUgZHJhd2VyIGJvbnVzZXM6IAogICAgLy9leHRyYSB0aWNrZXQocykgYW5kIHNvbWUgRVRIIHRvIGNvdmVyIHRoZSBnYXMgY29zdAogICAgbG90LmRyYXdlciA9IG1zZy5zZW5kZXI7CgogICAgbGFzdERyYXdUcyA9IG5vdzsKICAgIAogICAgcmVxdWVzdFJhbmRvbSgpOwogIH0KCiAgLy8vLy8vLy8vLy8vLy8vLy8KICAvL1NURVAgNTogR2VuZXJhdGUgYSByYW5kb20gbnVtYmVyIGJldHdlZW4gMCBhbmQgdGhlIHN1bSBvZiBwdXJjaGFzZWQgdGlja2V0cywgdXNpbmcgT3JhY2xpemUgcmFuZG9tIERTLgogIGZ1bmN0aW9uIHJlcXVlc3RSYW5kb20oKSBwcml2YXRlIHsKICAgIExvdHRlcnkgc3RvcmFnZSBsb3QgPSBjdXJyZW50TG90dGVyeSgpOwogICAgCiAgICBDcnlwdG9MdWNrUm5nIHJuZ0NvbnRyYWN0ID0gQ3J5cHRvTHVja1JuZyhybmdBZGRyZXNzKTsKICAgIAogICAgLy9STkcgcHJvdmlkZXIgcmV0dXJucyB0aGUgZXN0aW1hdGVkIE9yYWNsaXplIGZlZQogICAgdWludCBmZWUgPSBybmdDb250cmFjdC5nZXRGZWUoKTsKICAgIAogICAgLy9QYXkgb3JhY2xpemUgcXVlcnkgZnJvbSB0aGUgcHJpemUgcG9vbCBhbmQga2VlcCB0cmFjayBvZiBhbGwgZmVlcyBwYWlkIAogICAgLy8odXN1YWxseSwgb25seSAxIGZlZSwgYnV0IGNhbiBiZSBtb3JlIGlmIHRoZSBmaXJzdCBjYWxsIGZhaWxzKQogICAgbG90LnByaXplUG9vbCA9IGxvdC5wcml6ZVBvb2wuc3ViKGZlZSk7CiAgICBsb3Qub3JhY2xpemVGZWVzID0gbG90Lm9yYWNsaXplRmVlcy5hZGQoZmVlKTsKICAgIAogICAgLy9TdG9yZSB0aGUgcXVlcnkgSUQgc28gd2UgY2FuIG1hdGNoIGl0IG9uIGNhbGxiYWNrLCB0byBlbnN1cmUgd2UgYXJlIHJlY2VpdmluZyBhIGxlZ2l0IGNhbGxiYWNrLgogICAgLy9Bc2sgZm9yIGEgNyBieXRlcyBudW1iZXIuIG1heCBpcyA3MicwNTcnNTk0JzAzNyc5MjcnOTM2LCBzaG91bGQgYmUgb2sgOikKICAgIGJ5dGVzMzIgb3JhY2xpemVJZCA9IHJuZ0NvbnRyYWN0LnJlcXVlc3RSYW5kb20udmFsdWUoZmVlKSg3KTsKICAgIAogICAgbG90Lm9yYWNsaXplSWRzLnB1c2gob3JhY2xpemVJZCk7CiAgfQoKICAvLy8vLy8vLy8vLy8vLy8vLwogIC8vU1RFUCA2OiBjYWxsYmFjayBmcm9tIHRoZSBSTkcgcHJvdmlkZXIgLSBmaW5kIHRoZSB3aW5uZXIgYmFzZWQgb24gdGhlIGdlbmVyYXRlZCByYW5kb20gbnVtYmVyCiAgZnVuY3Rpb24gYWNjZXB0UmFuZG9tKGJ5dGVzMzIgcmVxSWQsIGJ5dGVzIHJlc3VsdCkgcHVibGljIG9ubHlSbmcgewogICAgTG90dGVyeSBzdG9yYWdlIGxvdCA9IGN1cnJlbnRMb3R0ZXJ5KCk7CiAgICAKICAgIC8vVmVyaWZ5IHRoZSBjdXJyZW50IGxvdHRlcnkgbWF0Y2hlcyBpdHMgb3JhY2xpemVJRCB3aXRoIHRoZSBzdXBwbGllZCBvbmUsIAogICAgLy9pZiB3ZSB1c2UgT3JhY2xpemUgb24gdGhpcyBuZXR3b3JrICh0cnVlIGZvciBub24tZGV2IG9uZXMpCiAgICBpZiAodXNlT3JhY2xpemUpIHsKICAgICAgcmVxdWlyZShjdXJyZW50T3JhY2xpemVJZCgpID09IHJlcUlkKTsKICAgIH0KICAgIAogICAgLy9TdG9yZSB0aGUgcmF3IHJlc3VsdC4KICAgIGxvdC5vcmFjbGl6ZVJlc3VsdCA9IHJlc3VsdDsKCiAgICAvL0F3YXJkIGJvbnVzIHRpY2tldHMgdG8gdGhlIGRyYXdlci4KICAgIHVpbnQyNTYgYm9udXNUaWNrZXRzID0gY2FsY3VsYXRlQm9udXNUaWNrZXRzKGxvdC50b3RhbENvbnRyaWJ1dGlvbnMpOwoKICAgIGxvdC5kcmF3ZXJCb251c1RpY2tldHMgPSBib251c1RpY2tldHM7CgogICAgLy9Db21wdXRlIHRvdGFsIHRpY2tldHMgaW4gdGhlIGRyYXcsIGluY2x1ZGluZyB0aGUgYm9udXMgb25lcy4KICAgIHVpbnQyNTYgdG90YWxUaWNrZXRzID0gYm9udXNUaWNrZXRzICsgKGxvdC50b3RhbENvbnRyaWJ1dGlvbnMgLyB0aWNrZXRQcmljZSk7CiAgICAKICAgIC8vbW9kIHdpdGggdG90YWxUaWNrZXRzIHRvIGdldCBhIG51bWJlciBpbiBbMC4udG90YWxUaWNrZXRzIC0gMV0KICAgIC8vYWRkIDEgdG8gYnJpbmcgaXQgaW4gdGhlIHJhbmdlIG9mIFsxLCB0b3RhbFRpY2tldHNdLCBzaW5jZSB3ZSBzdGFydCBvdXIgaW50ZXJ2YWwgc2xpY2VzIGF0IDEgKHNlZSBiZWxvdykKICAgIGxvdC53aW5uaW5nTnVtYmVyID0gMSArICh1aW50KGtlY2NhazI1NihyZXN1bHQpKSAlIHRvdGFsVGlja2V0cyk7CgogICAgZmluZFdpbm5lcigpOwoKICAgIExvZ0xvdHRlcnlSZXN1bHQoY3VycmVudExvdHRlcnlJZCwgMSwgcmVxSWQsIHJlc3VsdCk7CiAgfQogIAogIC8vU1RFUCA2JzogRHJhd2VyIHJlY2VpdmVzIGJvbnVzIHRpY2tldHMsIHRvIGNvdmVyIHRoZSBoaWdoZXIgZ2FzIGNvbnN1bXB0aW9uIGFuZCBpbmNlbnRpdml6ZSBwZW9wbGUgdG8gZG8gc28uCiAgZnVuY3Rpb24gY2FsY3VsYXRlQm9udXNUaWNrZXRzKHVpbnQyNTYgdG90YWxDb250cmlidXRpb25zKSB2aWV3IGludGVybmFsIHJldHVybnModWludDI1NikgewogICAgCiAgICAvLzElIG9mIGFsbCBjb250cmlidXRpb25zCiAgICB1aW50MjU2IGJvbnVzVGlja2V0cyA9ICh0b3RhbENvbnRyaWJ1dGlvbnMgKiBib251c1RpY2tldHNQZXJjZW50YWdlIC8gMTAwKSAvIHRpY2tldFByaWNlOwogICAgCiAgICAvL2JvbnVzID0gYmV0d2VlbiAxIHRvIG1heEJvbnVzVGlja2V0cyAoaW5pdGlhbGx5LCA1KQogICAgaWYgKGJvbnVzVGlja2V0cyA9PSAwKSB7CiAgICAgICBib251c1RpY2tldHMgPSAxOwogICAgfQoKICAgIGlmIChib251c1RpY2tldHMgPiBtYXhCb251c1RpY2tldHMpIHsKICAgICAgYm9udXNUaWNrZXRzID0gbWF4Qm9udXNUaWNrZXRzOwogICAgfQogICAgCiAgICByZXR1cm4gYm9udXNUaWNrZXRzOwogIH0KCiAgLy8vLy8vLy8vLy8vLy8vLy8KICAvL1NURVAgNzogZGV0ZXJtaW5lIHdpbm5lciBieSBmaWd1cmluZyBvdXQgd2hpY2ggYWRkcmVzcyBvd25zIHRoZSBpbnRlcnZhbCAKICAvLyBlbmNvbXBhc3NpbmcgdGhlIGdlbmVyYXRlZCByYW5kb20gbnVtYmVyIGFuZCBwYXkgdGhlIHdpbm5lci4KICBmdW5jdGlvbiBmaW5kV2lubmVyKCkgcHJpdmF0ZSB7CiAgICBMb3R0ZXJ5IHN0b3JhZ2UgbG90ID0gY3VycmVudExvdHRlcnkoKTsKICAgIAogICAgdWludDI1NiBjdXJyZW50TG9jYXRpb24gPSAxOwoKICAgIGZvciAodWludDE2IGkgPSAwOyBpIDwgbG90LnBhcnRpY2lwYW50cy5sZW5ndGg7IGkrKykgewogICAgICBhZGRyZXNzIHBhcnRpY2lwYW50ID0gbG90LnBhcnRpY2lwYW50c1tpXTsKICAgICAgCiAgICAgIC8vQTEgYm91Z2h0IDcwIHRpY2tldHMgPT4gaGVhZCA9IDEgKyA3MCAtIDEgPT4gb3ducyBbMSwgNzBdOyBhdCB0aGUgZW5kIG9mIHRoZSBsb29wLCBsb2NhdGlvbiArKwogICAgICAvL0EyIGJvdWdodCA5MCB0aWNrZXRzID0+IGhlYWQgPSA3MSArIDkwIC0gMSA9PiBvd25zIFs3MSwgMTYwXTsgaW5jcmVtZW50LCBldGMKICAgICAgdWludDI1NiBmaW5hbFRpY2tldHMgPSBsb3QuYmFsYW5jZXNbcGFydGljaXBhbnRdIC8gdGlja2V0UHJpY2U7CiAgICAgIAogICAgICAvL1RoZSBkcmF3ZXIgcmVjZWl2ZXMgc29tZSBib251cyB0aWNrZXRzLCBmb3IgdGhlIGVmZm9ydCBvZiBoYXZpbmcgZXhlY3V0ZWQgdGhlIGxvdHRlcnkgZHJhdy4KICAgICAgaWYgKHBhcnRpY2lwYW50ID09IGxvdC5kcmF3ZXIpIHsKICAgICAgICBmaW5hbFRpY2tldHMgKz0gbG90LmRyYXdlckJvbnVzVGlja2V0czsKICAgICAgfQoKICAgICAgY3VycmVudExvY2F0aW9uICs9IGZpbmFsVGlja2V0cyAtIDE7IAogICAgICAKICAgICAgaWYgKGN1cnJlbnRMb2NhdGlvbiA+PSBsb3Qud2lubmluZ051bWJlcikgewogICAgICAgICAgbG90Lndpbm5lciA9IHBhcnRpY2lwYW50OwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgLy9tb3ZlIHRvIHRoZSAic3RhcnQiIG9mIHRoZSBuZXh0IGludGVydmFsLCBmb3IgdGhlIG5leHQgcGFydGljaXBhbnQuCiAgICAgIGN1cnJlbnRMb2NhdGlvbiArPSAxOyAKICAgIH0KICAgIAogICAgLy9Qcml6ZSBpcyBhbGwgY3VycmVudCBiYWxhbmNlIG9uIGN1cnJlbnQgbG90dGVyeSwgbWludXMgdGhlIGhvdXNlIGZlZSBhbmQgcmV3YXJkIGZvciBkcmF3aW5nCiAgICB1aW50MjU2IHByaXplID0gbG90LnByaXplUG9vbDsKCiAgICAvL0NhbGN1bGF0ZSBob3VzZSBmZWUgYW5kIHRyYWNrIGl0LiAKICAgIC8vSG91c2UgZmVlIGlzIGludGVnZXIgcGVyIG1pbGxlLCBlLGcsIDUgPSAwLjUlLCB0aHVzLCBkaXZpZGUgYnkgMTAwMCB0byBnZXQgdGhlIHBlcmNlbnRhZ2UKICAgIHVpbnQyNTYgaG91c2VTaGFyZSA9IGhvdXNlRmVlICogcHJpemUgLyAxMDAwOwogICAgCiAgICBob3VzZUJhbGFuY2UgPSBob3VzZUJhbGFuY2UuYWRkKGhvdXNlU2hhcmUpOwogICAgCiAgICAvL2RlZHVjdCB0aGUgaG91c2Ugc2hhcmUgYW5kIHRoZSByZXdhcmQgZm9yIGRyYXdpbmcgZnJvbSB0aGUgcHJpemUgcG9vbC4KICAgIHByaXplID0gcHJpemUuc3ViKGhvdXNlU2hhcmUpOwogICAgcHJpemUgPSBwcml6ZS5zdWIocmV3YXJkRm9yRHJhd2luZyk7CiAgICAKICAgIGxvdC5zdGF0dXMgPSAxOwogICAgbG90LmF3YWl0aW5nT3JhY2xpemVDYWxsYmFjayA9IGZhbHNlOwogICAgCiAgICBsb3QucHJpemVQb29sID0gcHJpemU7CgogICAgLy9UcmFuc2ZlciB0aGUgcHJpemUgdG8gdGhlIHdpbm5lcgogICAgbG90Lndpbm5lci50cmFuc2Zlcihwcml6ZSk7CiAgICAKICAgIC8vVHJhbnNmZXIgdGhlIHJld2FyZCBmb3IgZHJhd2luZyB0byB0aGUgZHJhd2VyLgogICAgLy8oc2hvdWxkIGNvdmVyIG1vc3Qgb2YgdGhlIGdhcyBwYWlkIGZvciBleGVjdXRpbmcgdGhlIGRyYXcpCiAgICBsb3QuZHJhd2VyLnRyYW5zZmVyKHJld2FyZEZvckRyYXdpbmcpOwoKICAgIGZpbmFsaXplTG90dGVyeSgpOwogIH0gCiAgCiAgLy9FTkQgbG90dGVyeSBmbG93CiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAKICAvL0Z1bmN0aW9uIHdoaWNoIG1vdmVzIG9uIHRvIHRoZSBuZXh0IGxvdHRlcnkgYW5kIHN0b3BzIHRoZSBuZXh0IHJvdW5kIGlmIGluZGljYXRlZAogIGZ1bmN0aW9uIGZpbmFsaXplTG90dGVyeSgpIHByaXZhdGUgewogICAgY3VycmVudExvdHRlcnlJZCArPSAxOwoKICAgIGlmIChzdG9wR2FtZU9uTmV4dFJvdW5kKSB7CiAgICAgIGdhbWVSdW5uaW5nID0gZmFsc2U7CiAgICAgIHN0b3BHYW1lT25OZXh0Um91bmQgPSBmYWxzZTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGN1cnJlbnRPcmFjbGl6ZUlkKCkgdmlldyBwcml2YXRlIHJldHVybnMoYnl0ZXMzMikgewogICAgTG90dGVyeSBtZW1vcnkgbG90ID0gY3VycmVudExvdHRlcnkoKTsKICAgIAogICAgcmV0dXJuIGxvdC5vcmFjbGl6ZUlkc1tsb3Qub3JhY2xpemVJZHMubGVuZ3RoIC0gMV07CiAgfQoKICAvL0FsbG93IHBsYXllcnMgdG8gd2l0aGRyYXcgdGhlaXIgbW9uZXkgaW4gY2FzZSB0aGUgbG90dGVyeSBmYWlscy4KICAvL0NhbiBoYXBwZW4gaWYgdGhlIG9yYWNsaXplIGNhbGwgZmFpbHMgMiB0aW1lcwogIGZ1bmN0aW9uIHdpdGhkcmF3RnJvbUZhaWxlZExvdHRlcnkodWludDMyIGxvdHRlcnlJZCkgcHVibGljIHsKICAgIGFkZHJlc3MgcGxheWVyID0gbXNnLnNlbmRlcjsKICAgIAogICAgTG90dGVyeSBzdG9yYWdlIGxvdCA9IGxvdHRlcmllc1tsb3R0ZXJ5SWRdOwogICAgCiAgICAvL2NhbiBvbmx5IHdpdGhkcmF3IGZyb20gZmFpbGVkIGxvdHRlcmllcwogICAgcmVxdWlyZShsb3Quc3RhdHVzID09IDIpOwogICAgCiAgICAvL2NhbiB3aXRoZHJhdyBjb250cmlidXRlZCBiYWxhbmNlLCBtaW51cyB0aGUgZmVlcyB0aGF0IGhhdmUgYmVlbiBwYWlkIHRvIE9yYWNsaXplLCBkaXZpZGVkL3N1cHBvcnRlZCBhbW9uZyBhbGwgcGFydGljaXBhbnRzCiAgICB1aW50MjU2IHBsYXllckJhbGFuY2UgPSBsb3QuYmFsYW5jZXNbcGxheWVyXS5zdWIobG90Lm9yYWNsaXplRmVlcyAvIGxvdC5wYXJ0aWNpcGFudHMubGVuZ3RoKTsKICAgIC8vcmVxdWlyZSB0byBoYXZlIHNvbWV0aGluZyB0byBzZW5kIGJhY2sKICAgIHJlcXVpcmUocGxheWVyQmFsYW5jZSA+IDApOwoKICAgIC8vdXBkYXRlIHRoZSBsb2NhbCBiYWxhbmNlcwogICAgbG90LmJhbGFuY2VzW3BsYXllcl0gPSAwOwogICAgbG90LnByaXplUG9vbCA9IGxvdC5wcml6ZVBvb2wuc3ViKHBsYXllckJhbGFuY2UpOwoKICAgIC8vc2VuZCB0byBwbGF5ZXIKICAgIHBsYXllci50cmFuc2ZlcihwbGF5ZXJCYWxhbmNlKTsKICB9CgogIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgLy9QdWJsaWMgbWV0aG9kcyBvdXRzaWRlIGxvdHRlcnkgZmxvdwogIAogIC8vSW4gY2FzZSBFVEggaXMgbmVlZGVkIGluIHRoZSBjb250cmFjdCBmb3Igd2hhdGV2ZXIgcmVhc29uLgogIC8vR2VuZXJhbGx5LCB0aGUgb3duZXIgb2YgdGhlIGhvdXNlIHdpbGwgdG9wIHVwIHRoZSBjb250cmFjdCwgc28gaW5jcmVhc2UgdGhlIGhvdXNlIGJhbGFuY2UuCiAgLy9QUzogSWYgc29tZW9uZSBlbHNlIHRvcHMgdXAgdGhlIGhvdXNlLCB0aGFua3MhIDopCiAgZnVuY3Rpb24gaG91c2VUb3BVcCgpIHB1YmxpYyBwYXlhYmxlIHsKICAgIGhvdXNlQmFsYW5jZSA9IGhvdXNlQmFsYW5jZS5hZGQobXNnLnZhbHVlKTsKICB9CiAgCiAgLy9BbGxvdyB0aGUgb3duZXIgdG8gd2l0aGRyYXcgdGhlIGhvdXNlIGZlZXMgKyBob3VzZSB0b3AgdXBzLgogIGZ1bmN0aW9uIGhvdXNlV2l0aGRyYXcoKSBwdWJsaWMgb25seU93bmVyIHsKICAgIG93bmVyLnRyYW5zZmVyKGhvdXNlQmFsYW5jZSk7CiAgfQoKICAvL0luIGNhc2UgdGhlIGxvdHRlcnkgZ2V0cyBzdHVjaywgb3JhY2xpemUgZG9lc250IGNhbGwgYmFjayBldGMuLCBuZWVkIGEgd2F5IHRvIHJldHJ5LgogIGZ1bmN0aW9uIG1hbnVhbERyYXcoKSBwdWJsaWMgb25seU93bmVyIHsKICAgIExvdHRlcnkgc3RvcmFnZSBsb3QgPSBjdXJyZW50TG90dGVyeSgpOwogICAgLy9Pbmx5IGZvciBvcGVuIGxvdHRlcmllcwogICAgcmVxdWlyZShsb3Quc3RhdHVzID09IDApOwogICAgCiAgICAvL0FsbG93IHRoZSBvd25lciB0byBkcmF3IG9ubHkgd2hlbiBpdCB3b3VsZCBub3JtYWxseSBiZSBhbGxvd2VkCiAgICByZXF1aXJlKG11c3REcmF3KCkpOwogICAgCiAgICAvL0Fsc28sIGVuc3VyZSB0aGVyZSdzIGF0IGxlYXN0IDEgaHIgc2luY2UgdGhlIGNhbGwgdG8gb3JhY2xpemUgaGFzIGJlZW4gbWFkZS4KICAgIC8vSWYgdGhlIHJlc3VsdCBkaWRudCBjb21lIGluIDEgaG91ciwgdGhlbiBzb21ldGhpbmcgaXMgd3Jvbmcgd2l0aCBvcmFjbGl6ZSwgc28gaXQncyBvayB0byB0cnkgYWdhaW4uCiAgICByZXF1aXJlKG5vdyAtIGxhc3REcmF3VHMgPiBNQU5VQUxfV0lUSERSQVdfSU5URVJWQUwpOwoKICAgIC8vSWYgd2UgdHJ5IHRvIGRyYXcgbWFudWFsbHkgYnV0IHdlIGFscmVhZHkgaGF2ZSAyIE9yYWNsaXplIHJlcXVlc3RzIGxvZ2dlZCwgdGhlbiB3ZSBuZWVkIHRvIGZhaWwgdGhlIGxvdHRlcnkuCiAgICAvL3RoZW4gc29tZXRoaW5nIGlzIHdyb25nIHdpdGggT3JhY2xpemUgLSBtYXliZSBkb3duIG9yIHNvbWVvbmUgYXQgT3JhY2xpemUgdHJ5aW5nIHRvIG1lZGRsZSB3aXRoIHRoZSByZXN1bHRzLgogICAgLy9BcyBzdWNoLCBmYWlsIHRoZSBsb3R0ZXJ5LCBtb3ZlIG9uIHRvIHRoZSBuZXh0IGFuZCBhbGxvdyBwZW9wbGUgdG8gd2l0aGRyYXcgdGhlaXIgbW9uZXkgZnJvbSB0aGlzIG9uZS4KICAgIGlmIChsb3Qub3JhY2xpemVJZHMubGVuZ3RoID09IDIpIHsKICAgICAgbG90LnN0YXR1cyA9IDI7CiAgICAgIGxvdC5hd2FpdGluZ09yYWNsaXplQ2FsbGJhY2sgPSBmYWxzZTsKICAgICAgCiAgICAgIExvZ0xvdHRlcnlSZXN1bHQoY3VycmVudExvdHRlcnlJZCwgMiwgbG90Lm9yYWNsaXplSWRzW2xvdC5vcmFjbGl6ZUlkcy5sZW5ndGggLSAxXSwgIiIpOwoKICAgICAgZmluYWxpemVMb3R0ZXJ5KCk7CiAgICB9IGVsc2UgewogICAgICBkcmF3KCk7CiAgICB9CiAgfQoKICAKICAvLy8vLy8vLy8vLwoKICAvL0hlbHBlciBtZXRob2RzLgogIGZ1bmN0aW9uIGJhbGFuY2VJbkxvdHRlcnkodWludDMyIGxvdHRlcnlJZCwgYWRkcmVzcyBwbGF5ZXIpIHZpZXcgcHVibGljIHJldHVybnModWludCkgewogICAgcmV0dXJuIGxvdHRlcmllc1tsb3R0ZXJ5SWRdLmJhbGFuY2VzW3BsYXllcl07CiAgfQoKICBmdW5jdGlvbiBwYXJ0aWNpcGFudHNPZih1aW50MzIgbG90dGVyeUlkKSB2aWV3IHB1YmxpYyByZXR1cm5zIChhZGRyZXNzW10pIHsKICAgIHJldHVybiBsb3R0ZXJpZXNbbG90dGVyeUlkXS5wYXJ0aWNpcGFudHM7CiAgfQoKICBmdW5jdGlvbiBvcmFjbGl6ZUlkcyh1aW50MzIgbG90dGVyeUlkKSB2aWV3IHB1YmxpYyByZXR1cm5zKGJ5dGVzMzJbXSkgewogICAgcmV0dXJuIGxvdHRlcmllc1tsb3R0ZXJ5SWRdLm9yYWNsaXplSWRzOwogIH0KfQ=='.
	

]
