Class {
	#name : #SRT4d6e0922e6b703f0fdf92745343a9b83eb656402,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT4d6e0922e6b703f0fdf92745343a9b83eb656402 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTc7CgpsaWJyYXJ5IEVDVmVyaWZ5IHsKCiAgICBmdW5jdGlvbiBlY3ZlcmlmeShieXRlczMyIGhhc2gsIGJ5dGVzIHNpZ25hdHVyZSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChhZGRyZXNzIHNpZ25hdHVyZV9hZGRyZXNzKSB7CiAgICAgICAgcmVxdWlyZShzaWduYXR1cmUubGVuZ3RoID09IDY1KTsKCiAgICAgICAgYnl0ZXMzMiByOwogICAgICAgIGJ5dGVzMzIgczsKICAgICAgICB1aW50OCB2OwoKICAgICAgICAvLyBUaGUgc2lnbmF0dXJlIGZvcm1hdCBpcyBhIGNvbXBhY3QgZm9ybSBvZjoKICAgICAgICAvLyAgIHtieXRlczMyIHJ9e2J5dGVzMzIgc317dWludDggdn0KICAgICAgICAvLyBDb21wYWN0IG1lYW5zLCB1aW50OCBpcyBub3QgcGFkZGVkIHRvIDMyIGJ5dGVzLgogICAgICAgIGFzc2VtYmx5IHsKICAgICAgICAgICAgciA6PSBtbG9hZChhZGQoc2lnbmF0dXJlLCAzMikpCiAgICAgICAgICAgIHMgOj0gbWxvYWQoYWRkKHNpZ25hdHVyZSwgNjQpKQoKICAgICAgICAgICAgLy8gSGVyZSB3ZSBhcmUgbG9hZGluZyB0aGUgbGFzdCAzMiBieXRlcywgaW5jbHVkaW5nIDMxIGJ5dGVzIG9mICdzJy4KICAgICAgICAgICAgdiA6PSBieXRlKDAsIG1sb2FkKGFkZChzaWduYXR1cmUsIDk2KSkpCiAgICAgICAgfQoKICAgICAgICAvLyBWZXJzaW9uIG9mIHNpZ25hdHVyZSBzaG91bGQgYmUgMjcgb3IgMjgsIGJ1dCAwIGFuZCAxIGFyZSBhbHNvIHBvc3NpYmxlCiAgICAgICAgaWYgKHYgPCAyNykgewogICAgICAgICAgICB2ICs9IDI3OwogICAgICAgIH0KCiAgICAgICAgcmVxdWlyZSh2ID09IDI3IHx8IHYgPT0gMjgpOwoKICAgICAgICBzaWduYXR1cmVfYWRkcmVzcyA9IGVjcmVjb3ZlcihoYXNoLCB2LCByLCBzKTsKCiAgICAgICAgLy8gZWNyZWNvdmVyIHJldHVybnMgemVybyBvbiBlcnJvcgogICAgICAgIHJlcXVpcmUoc2lnbmF0dXJlX2FkZHJlc3MgIT0gMHgwKTsKCiAgICAgICAgcmV0dXJuIHNpZ25hdHVyZV9hZGRyZXNzOwogICAgfQp9Ci8vLyBAdGl0bGUgQmFzZSBUb2tlbiBjb250cmFjdCAtIEZ1bmN0aW9ucyB0byBiZSBpbXBsZW1lbnRlZCBieSB0b2tlbiBjb250cmFjdHMuCmNvbnRyYWN0IFRva2VuIHsKICAgIC8qCiAgICAgKiBJbXBsZW1lbnRzIEVSQyAyMCBzdGFuZGFyZC4KICAgICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2Jsb2IvZjkwODY0YTNkMmIyYjQ1YzRkZWNmOTVlZmQyNmIzZjBjMjc2MDUxYS9FSVBTL2VpcC0yMC10b2tlbi1zdGFuZGFyZC5tZAogICAgICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAgICAgKgogICAgICogIEFkZGVkIHN1cHBvcnQgZm9yIHRoZSBFUkMgMjIzICJ0b2tlbkZhbGxiYWNrIiBtZXRob2QgaW4gYSAidHJhbnNmZXIiIGZ1bmN0aW9uIHdpdGggYSBwYXlsb2FkLgogICAgICogIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMjMKICAgICAqLwoKICAgIC8qCiAgICAgKiBUaGlzIGlzIGEgc2xpZ2h0IGNoYW5nZSB0byB0aGUgRVJDMjAgYmFzZSBzdGFuZGFyZC4KICAgICAqIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBzdXBwbHkpOwogICAgICogaXMgcmVwbGFjZWQgd2l0aDoKICAgICAqIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogICAgICogVGhpcyBhdXRvbWF0aWNhbGx5IGNyZWF0ZXMgYSBnZXR0ZXIgZnVuY3Rpb24gZm9yIHRoZSB0b3RhbFN1cHBseS4KICAgICAqIFRoaXMgaXMgbW92ZWQgdG8gdGhlIGJhc2UgY29udHJhY3Qgc2luY2UgcHVibGljIGdldHRlciBmdW5jdGlvbnMgYXJlIG5vdAogICAgICogY3VycmVudGx5IHJlY29nbmlzZWQgYXMgYW4gaW1wbGVtZW50YXRpb24gb2YgdGhlIG1hdGNoaW5nIGFic3RyYWN0CiAgICAgKiBmdW5jdGlvbiBieSB0aGUgY29tcGlsZXIuCiAgICAgKi8KICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwoKICAgIC8qCiAgICAgKiBOT1RFOgogICAgICogVGhlIGZvbGxvd2luZyB2YXJpYWJsZXMgd2VyZSBvcHRpb25hbC4gTm93LCB0aGV5IGFyZSBpbmNsdWRlZCBpbiBFUkMgMjIzIGludGVyZmFjZS4KICAgICAqIFRoZXkgYWxsb3cgb25lIHRvIGN1c3RvbWlzZSB0aGUgdG9rZW4gY29udHJhY3QgJiBpbiBubyB3YXkgaW5mbHVlbmNlcyB0aGUgY29yZSBmdW5jdGlvbmFsaXR5LgogICAgICovCiAgICBzdHJpbmcgcHVibGljIG5hbWU7ICAgICAgICAgICAgICAgICAgIC8vZmFuY3kgbmFtZTogZWcgU2ltb24gQnVja3MKICAgIHVpbnQ4IHB1YmxpYyBkZWNpbWFsczsgICAgICAgICAgICAgICAgLy9Ib3cgbWFueSBkZWNpbWFscyB0byBzaG93LiBpZS4gVGhlcmUgY291bGQgMTAwMCBiYXNlIHVuaXRzIHdpdGggMyBkZWNpbWFscy4gTWVhbmluZyAwLjk4MCBTQlggPSA5ODAgYmFzZSB1bml0cy4gSXQncyBsaWtlIGNvbXBhcmluZyAxIHdlaSB0byAxIGV0aGVyLgogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2w7ICAgICAgICAgICAgICAgICAvL0FuIGlkZW50aWZpZXI6IGVnIFNCWAoKCiAgICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBmcm9tIHdoaWNoIHRoZSBiYWxhbmNlIHdpbGwgYmUgcmV0cmlldmVkLgogICAgLy8vIEByZXR1cm4gVGhlIGJhbGFuY2UuCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwoKICAgIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgbXNnLnNlbmRlcmAuCiAgICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50LgogICAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZC4KICAgIC8vLyBAcGFyYW0gX2RhdGEgRGF0YSB0byBiZSBzZW50IHRvIGB0b2tlbkZhbGxiYWNrLgogICAgLy8vIEByZXR1cm4gUmV0dXJucyBzdWNjZXNzIG9mIGZ1bmN0aW9uIGNhbGwuCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9kYXRhKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCiAgICAvLy8gQG5vdGljZSBzZW5kIGBfdmFsdWVgIHRva2VuIHRvIGBfdG9gIGZyb20gYG1zZy5zZW5kZXJgLgogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudC4KICAgIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQuCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QuCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgX2Zyb21gIG9uIHRoZSBjb25kaXRpb24gaXQgaXMgYXBwcm92ZWQgYnkgYF9mcm9tYC4KICAgIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3Mgb2YgdGhlIHNlbmRlci4KICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQuCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkLgogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgdHJhbnNmZXIgd2FzIHN1Y2Nlc3NmdWwgb3Igbm90LgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8vIEBub3RpY2UgYG1zZy5zZW5kZXJgIGFwcHJvdmVzIGBfc3BlbmRlcmAgdG8gc3BlbmQgYF92YWx1ZWAgdG9rZW5zLgogICAgLy8vIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBhYmxlIHRvIHRyYW5zZmVyIHRoZSB0b2tlbnMuCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBhcHByb3ZlZCBmb3IgdHJhbnNmZXIuCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBhcHByb3ZhbCB3YXMgc3VjY2Vzc2Z1bCBvciBub3QuCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCiAgICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBvd25pbmcgdG9rZW5zLgogICAgLy8vIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBhYmxlIHRvIHRyYW5zZmVyIHRoZSB0b2tlbnMuCiAgICAvLy8gQHJldHVybiBBbW91bnQgb2YgcmVtYWluaW5nIHRva2VucyBhbGxvd2VkIHRvIHNwZW50LgogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOwoKICAgIC8qCiAgICAgKiBFdmVudHMKICAgICAqLwogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKCiAgICAvLyBUaGVyZSBpcyBubyBFUkMyMjMgY29tcGF0aWJsZSBUcmFuc2ZlciBldmVudCwgd2l0aCBgX2RhdGFgIGluY2x1ZGVkLgp9Ci8vLyBAdGl0bGUgUmFpZGVuIE1pY3JvVHJhbnNmZXIgQ2hhbm5lbHMgQ29udHJhY3QuCmNvbnRyYWN0IFJhaWRlbk1pY3JvVHJhbnNmZXJDaGFubmVscyB7CgogICAgLyoKICAgICAqICBEYXRhIHN0cnVjdHVyZXMKICAgICAqLwoKICAgIHVpbnQzMiBwdWJsaWMgY2hhbGxlbmdlX3BlcmlvZDsKCiAgICAvLyBDb250cmFjdCBzZW1hbnRpYyB2ZXJzaW9uCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHZlcnNpb24gPSAnMC4xLjAnOwoKICAgIC8vIFdlIHRlbXBvcmFyaWx5IGxpbWl0IHRvdGFsIHRva2VuIGRlcG9zaXRzIGluIGEgY2hhbm5lbCB0byAxMDAgdG9rZW5zIHdpdGggMTggZGVjaW1hbHMuCiAgICAvLyBUaGlzIHdhcyBjYWxjdWxhdGVkIGp1c3QgZm9yIFJETiB3aXRoIGl0cyBjdXJyZW50IChhcyBvZiAzMC8xMS8yMDE3KSBwcmljZSBhbmQgc2hvdWxkCiAgICAvLyBub3QgYmUgY29uc2lkZXJlZCB0byBiZSB0aGUgc2FtZSBmb3Igb3RoZXIgdG9rZW5zLgogICAgLy8gVGhpcyBpcyBqdXN0IGZvciB0aGUgYnVnIGJvdW50eSByZWxlYXNlLCBhcyBhIHNhZmV0eSBtZWFzdXJlLgogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgY2hhbm5lbF9kZXBvc2l0X2J1Z2JvdW50eV9saW1pdCA9IDEwICoqIDE4ICogMTAwOwoKICAgIFRva2VuIHB1YmxpYyB0b2tlbjsKCiAgICBtYXBwaW5nIChieXRlczMyID0+IENoYW5uZWwpIHB1YmxpYyBjaGFubmVsczsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gQ2xvc2luZ1JlcXVlc3QpIHB1YmxpYyBjbG9zaW5nX3JlcXVlc3RzOwoKICAgIC8vIDI4IChkZXBvc2l0KSArIDQgKGJsb2NrIG5vIHNldHRsZW1lbnQpCiAgICBzdHJ1Y3QgQ2hhbm5lbCB7CiAgICAgICAgLy8gdWludDE5MiBpcyB0aGUgbWF4aW11bSB1aW50IHNpemUgbmVlZGVkIGZvciBkZXBvc2l0IGJhc2VkIG9uIGEKICAgICAgICAvLyAxMF44ICogMTBeMTggdG9rZW4gdG90YWxTdXBwbHkuCiAgICAgICAgdWludDE5MiBkZXBvc2l0OwoKICAgICAgICAvLyBVc2VkIGluIGNyZWF0aW5nIGEgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBjaGFubmVsIGJldHdlZW4gYSBzZW5kZXIgYW5kIHJlY2VpdmVyLgogICAgICAgIC8vIFN1cHBvcnRzIGNyZWF0aW9uIG9mIG11bHRpcGxlIGNoYW5uZWxzIGJldHdlZW4gdGhlIDIgcGFydGllcyBhbmQgcHJldmVudHMKICAgICAgICAvLyByZXBsYXkgb2YgbWVzc2FnZXMgaW4gbGF0ZXIgY2hhbm5lbHMuCiAgICAgICAgdWludDMyIG9wZW5fYmxvY2tfbnVtYmVyOwogICAgfQoKICAgIHN0cnVjdCBDbG9zaW5nUmVxdWVzdCB7CiAgICAgICAgdWludDE5MiBjbG9zaW5nX2JhbGFuY2U7CiAgICAgICAgdWludDMyIHNldHRsZV9ibG9ja19udW1iZXI7CiAgICB9CgogICAgLyoKICAgICAqICBFdmVudHMKICAgICAqLwoKICAgIGV2ZW50IENoYW5uZWxDcmVhdGVkKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBfc2VuZGVyLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBfcmVjZWl2ZXIsCiAgICAgICAgdWludDE5MiBfZGVwb3NpdCk7CiAgICBldmVudCBDaGFubmVsVG9wcGVkVXAgKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBfc2VuZGVyLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBfcmVjZWl2ZXIsCiAgICAgICAgdWludDMyIGluZGV4ZWQgX29wZW5fYmxvY2tfbnVtYmVyLAogICAgICAgIHVpbnQxOTIgX2FkZGVkX2RlcG9zaXQpOwogICAgZXZlbnQgQ2hhbm5lbENsb3NlUmVxdWVzdGVkKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBfc2VuZGVyLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBfcmVjZWl2ZXIsCiAgICAgICAgdWludDMyIGluZGV4ZWQgX29wZW5fYmxvY2tfbnVtYmVyLAogICAgICAgIHVpbnQxOTIgX2JhbGFuY2UpOwogICAgZXZlbnQgQ2hhbm5lbFNldHRsZWQoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIF9zZW5kZXIsCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIF9yZWNlaXZlciwKICAgICAgICB1aW50MzIgaW5kZXhlZCBfb3Blbl9ibG9ja19udW1iZXIsCiAgICAgICAgdWludDE5MiBfYmFsYW5jZSk7CgoKICAgIC8qCiAgICAgKiAgQ29uc3RydWN0b3IKICAgICAqLwoKICAgIC8vLyBAZGV2IENvbnN0cnVjdG9yIGZvciBjcmVhdGluZyB0aGUgdVJhaWRlbiBtaWNyb3RyYW5zZmVyIGNoYW5uZWxzIGNvbnRyYWN0LgogICAgLy8vIEBwYXJhbSBfdG9rZW5fYWRkcmVzcyBUaGUgYWRkcmVzcyBvZiB0aGUgVG9rZW4gdXNlZCBieSB0aGUgdVJhaWRlbiBjb250cmFjdC4KICAgIC8vLyBAcGFyYW0gX2NoYWxsZW5nZV9wZXJpb2QgQSBmaXhlZCBudW1iZXIgb2YgYmxvY2tzIHJlcHJlc2VudGluZyB0aGUgY2hhbGxlbmdlIHBlcmlvZC4KICAgIC8vLyBXZSBlbmZvcmNlIGEgbWluaW11bSBvZiA1MDAgYmxvY2tzIHdhaXRpbmcgcGVyaW9kLgogICAgLy8vIGFmdGVyIGEgc2VuZGVyIHJlcXVlc3RzIHRoZSBjbG9zaW5nIG9mIHRoZSBjaGFubmVsIHdpdGhvdXQgdGhlIHJlY2VpdmVyJ3Mgc2lnbmF0dXJlLgogICAgZnVuY3Rpb24gUmFpZGVuTWljcm9UcmFuc2ZlckNoYW5uZWxzKGFkZHJlc3MgX3Rva2VuX2FkZHJlc3MsIHVpbnQzMiBfY2hhbGxlbmdlX3BlcmlvZCkgcHVibGljIHsKICAgICAgICByZXF1aXJlKF90b2tlbl9hZGRyZXNzICE9IDB4MCk7CiAgICAgICAgcmVxdWlyZShhZGRyZXNzSGFzQ29kZShfdG9rZW5fYWRkcmVzcykpOwogICAgICAgIHJlcXVpcmUoX2NoYWxsZW5nZV9wZXJpb2QgPj0gNTAwKTsKCiAgICAgICAgdG9rZW4gPSBUb2tlbihfdG9rZW5fYWRkcmVzcyk7CgogICAgICAgIC8vIENoZWNrIGlmIHRoZSBjb250cmFjdCBpcyBpbmRlZWQgYSB0b2tlbiBjb250cmFjdAogICAgICAgIHJlcXVpcmUodG9rZW4udG90YWxTdXBwbHkoKSA+IDApOwoKICAgICAgICBjaGFsbGVuZ2VfcGVyaW9kID0gX2NoYWxsZW5nZV9wZXJpb2Q7CiAgICB9CgogICAgLyoKICAgICAqICBQdWJsaWMgaGVscGVyIGZ1bmN0aW9ucyAoY29uc3RhbnQpCiAgICAgKi8KICAgIC8vLyBAZGV2IFJldHVybnMgdGhlIHVuaXF1ZSBjaGFubmVsIGlkZW50aWZpZXIgdXNlZCBpbiB0aGUgY29udHJhY3QuCiAgICAvLy8gQHBhcmFtIF9zZW5kZXJfYWRkcmVzcyBUaGUgYWRkcmVzcyB0aGF0IHNlbmRzIHRva2Vucy4KICAgIC8vLyBAcGFyYW0gX3JlY2VpdmVyX2FkZHJlc3MgVGhlIGFkZHJlc3MgdGhhdCByZWNlaXZlcyB0b2tlbnMuCiAgICAvLy8gQHBhcmFtIF9vcGVuX2Jsb2NrX251bWJlciBUaGUgYmxvY2sgbnVtYmVyIGF0IHdoaWNoIGEgY2hhbm5lbCBiZXR3ZWVuIHRoZQogICAgLy8vIHNlbmRlciBhbmQgcmVjZWl2ZXIgd2FzIGNyZWF0ZWQuCiAgICAvLy8gQHJldHVybiBVbmlxdWUgY2hhbm5lbCBpZGVudGlmaWVyLgogICAgZnVuY3Rpb24gZ2V0S2V5KAogICAgICAgIGFkZHJlc3MgX3NlbmRlcl9hZGRyZXNzLAogICAgICAgIGFkZHJlc3MgX3JlY2VpdmVyX2FkZHJlc3MsCiAgICAgICAgdWludDMyIF9vcGVuX2Jsb2NrX251bWJlcikKICAgICAgICBwdWJsaWMKICAgICAgICBwdXJlCiAgICAgICAgcmV0dXJucyAoYnl0ZXMzMiBkYXRhKQogICAgewogICAgICAgIHJldHVybiBrZWNjYWsyNTYoX3NlbmRlcl9hZGRyZXNzLCBfcmVjZWl2ZXJfYWRkcmVzcywgX29wZW5fYmxvY2tfbnVtYmVyKTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIHRoZSBzZW5kZXIgYWRkcmVzcyBleHRyYWN0ZWQgZnJvbSB0aGUgYmFsYW5jZSBwcm9vZi4KICAgIC8vLyBXb3JrcyB3aXRoIGV0aF9zaWduVHlwZWREYXRhIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL3B1bGwvNzEyLgogICAgLy8vIEBwYXJhbSBfcmVjZWl2ZXJfYWRkcmVzcyBUaGUgYWRkcmVzcyB0aGF0IHJlY2VpdmVzIHRva2Vucy4KICAgIC8vLyBAcGFyYW0gX29wZW5fYmxvY2tfbnVtYmVyIFRoZSBibG9jayBudW1iZXIgYXQgd2hpY2ggYSBjaGFubmVsIGJldHdlZW4gdGhlCiAgICAvLy8gc2VuZGVyIGFuZCByZWNlaXZlciB3YXMgY3JlYXRlZC4KICAgIC8vLyBAcGFyYW0gX2JhbGFuY2UgVGhlIGFtb3VudCBvZiB0b2tlbnMgb3dlZCBieSB0aGUgc2VuZGVyIHRvIHRoZSByZWNlaXZlci4KICAgIC8vLyBAcGFyYW0gX2JhbGFuY2VfbXNnX3NpZyBUaGUgYmFsYW5jZSBtZXNzYWdlIHNpZ25lZCBieSB0aGUgc2VuZGVyLgogICAgLy8vIEByZXR1cm4gQWRkcmVzcyBvZiB0aGUgYmFsYW5jZSBwcm9vZiBzaWduZXIuCiAgICBmdW5jdGlvbiB2ZXJpZnlCYWxhbmNlUHJvb2YoCiAgICAgICAgYWRkcmVzcyBfcmVjZWl2ZXJfYWRkcmVzcywKICAgICAgICB1aW50MzIgX29wZW5fYmxvY2tfbnVtYmVyLAogICAgICAgIHVpbnQxOTIgX2JhbGFuY2UsCiAgICAgICAgYnl0ZXMgX2JhbGFuY2VfbXNnX3NpZykKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyAoYWRkcmVzcykKICAgIHsKICAgICAgICAvLyBUaGUgdmFyaWFibGUgbmFtZXMgZnJvbSBiZWxvdyB3aWxsIGJlIHNob3duIHRvIHRoZSBzZW5kZXIgd2hlbiBzaWduaW5nCiAgICAgICAgLy8gdGhlIGJhbGFuY2UgcHJvb2YsIHNvIHRoZXkgaGF2ZSB0byBiZSBrZXB0IGluIHN5bmMgd2l0aCB0aGUgRGFwcCBjbGllbnQuCiAgICAgICAgLy8gVGhlIGhhc2hlZCBzdHJpbmdzIHNob3VsZCBiZSBrZXB0IGluIHN5bmMgd2l0aCB0aGlzIGZ1bmN0aW9uJ3MgcGFyYW1ldGVycwogICAgICAgIC8vICh2YXJpYWJsZSBuYW1lcyBhbmQgdHlwZXMpLgogICAgICAgIC8vICEgTm90ZSB0aGF0IEVJUDcxMiBtaWdodCBjaGFuZ2UgaG93IGhhc2hpbmcgaXMgZG9uZSwgdHJpZ2dlcmluZyBhCiAgICAgICAgLy8gbmV3IGNvbnRyYWN0IGRlcGxveW1lbnQgd2l0aCB1cGRhdGVkIGNvZGUuCiAgICAgICAgYnl0ZXMzMiBtZXNzYWdlX2hhc2ggPSBrZWNjYWsyNTYoCiAgICAgICAgICBrZWNjYWsyNTYoJ2FkZHJlc3MgcmVjZWl2ZXInLCAndWludDMyIGJsb2NrX2NyZWF0ZWQnLCAndWludDE5MiBiYWxhbmNlJywgJ2FkZHJlc3MgY29udHJhY3QnKSwKICAgICAgICAgIGtlY2NhazI1NihfcmVjZWl2ZXJfYWRkcmVzcywgX29wZW5fYmxvY2tfbnVtYmVyLCBfYmFsYW5jZSwgYWRkcmVzcyh0aGlzKSkKICAgICAgICApOwoKICAgICAgICAvLyBEZXJpdmUgYWRkcmVzcyBmcm9tIHNpZ25hdHVyZQogICAgICAgIGFkZHJlc3Mgc2lnbmVyID0gRUNWZXJpZnkuZWN2ZXJpZnkobWVzc2FnZV9oYXNoLCBfYmFsYW5jZV9tc2dfc2lnKTsKICAgICAgICByZXR1cm4gc2lnbmVyOwogICAgfQoKICAgIC8qCiAgICAgKiAgRXh0ZXJuYWwgZnVuY3Rpb25zCiAgICAgKi8KCiAgICAvLy8gQGRldiBPcGVucyBhIG5ldyBjaGFubmVsIG9yIHRvcHMgdXAgYW4gZXhpc3Rpbmcgb25lLCBjb21wYXRpYmlsaXR5IHdpdGggRVJDIDIyMzsKICAgIC8vLyBtc2cuc2VuZGVyIGlzIFRva2VuIGNvbnRyYWN0LgogICAgLy8vIEBwYXJhbSBfc2VuZGVyX2FkZHJlc3MgVGhlIGFkZHJlc3MgdGhhdCBzZW5kcyB0aGUgdG9rZW5zLgogICAgLy8vIEBwYXJhbSBfZGVwb3NpdCBUaGUgYW1vdW50IG9mIHRva2VucyB0aGF0IHRoZSBzZW5kZXIgZXNjcm93cy4KICAgIC8vLyBAcGFyYW0gX2RhdGEgUmVjZWl2ZXIgYWRkcmVzcyBpbiBieXRlcy4KICAgIGZ1bmN0aW9uIHRva2VuRmFsbGJhY2soYWRkcmVzcyBfc2VuZGVyX2FkZHJlc3MsIHVpbnQyNTYgX2RlcG9zaXQsIGJ5dGVzIF9kYXRhKSBleHRlcm5hbCB7CiAgICAgICAgLy8gTWFrZSBzdXJlIHdlIHRydXN0IHRoZSB0b2tlbgogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBhZGRyZXNzKHRva2VuKSk7CgogICAgICAgIHVpbnQxOTIgZGVwb3NpdCA9IHVpbnQxOTIoX2RlcG9zaXQpOwogICAgICAgIHJlcXVpcmUoZGVwb3NpdCA9PSBfZGVwb3NpdCk7CgogICAgICAgIHVpbnQgbGVuZ3RoID0gX2RhdGEubGVuZ3RoOwoKICAgICAgICAvLyBjcmVhdGVDaGFubmVsIC0gcmVjZWl2ZXIgYWRkcmVzcyAoMjAgYnl0ZXMpCiAgICAgICAgLy8gdG9wVXAgLSByZWNlaXZlciBhZGRyZXNzICgyMCBieXRlcykgKyBvcGVuX2Jsb2NrX251bWJlciAoNCBieXRlcykgPSAyNCBieXRlcwogICAgICAgIHJlcXVpcmUobGVuZ3RoID09IDIwIHx8IGxlbmd0aCA9PSAyNCk7CgogICAgICAgIGFkZHJlc3MgcmVjZWl2ZXIgPSBhZGRyZXNzRnJvbURhdGEoX2RhdGEpOwoKICAgICAgICBpZihsZW5ndGggPT0gMjApIHsKICAgICAgICAgICAgY3JlYXRlQ2hhbm5lbFByaXZhdGUoX3NlbmRlcl9hZGRyZXNzLCByZWNlaXZlciwgZGVwb3NpdCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdWludDMyIG9wZW5fYmxvY2tfbnVtYmVyID0gYmxvY2tOdW1iZXJGcm9tRGF0YShfZGF0YSk7CiAgICAgICAgICAgIHVwZGF0ZUludGVybmFsQmFsYW5jZVN0cnVjdHMoCiAgICAgICAgICAgICAgICBfc2VuZGVyX2FkZHJlc3MsCiAgICAgICAgICAgICAgICByZWNlaXZlciwKICAgICAgICAgICAgICAgIG9wZW5fYmxvY2tfbnVtYmVyLAogICAgICAgICAgICAgICAgZGVwb3NpdAogICAgICAgICAgICApOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8gQGRldiBDcmVhdGVzIGEgbmV3IGNoYW5uZWwgYmV0d2VlbiBhIHNlbmRlciBhbmQgYSByZWNlaXZlciBhbmQgdHJhbnNmZXJzCiAgICAvLy8gdGhlIHNlbmRlcidzIHRva2VuIGRlcG9zaXQgdG8gdGhpcyBjb250cmFjdCwgY29tcGF0aWJpbGl0eSB3aXRoIEVSQzIwIHRva2Vucy4KICAgIC8vLyBAcGFyYW0gX3JlY2VpdmVyX2FkZHJlc3MgVGhlIGFkZHJlc3MgdGhhdCByZWNlaXZlcyB0b2tlbnMuCiAgICAvLy8gQHBhcmFtIF9kZXBvc2l0IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgdGhlIHNlbmRlciBlc2Nyb3dzLgogICAgZnVuY3Rpb24gY3JlYXRlQ2hhbm5lbEVSQzIwKGFkZHJlc3MgX3JlY2VpdmVyX2FkZHJlc3MsIHVpbnQxOTIgX2RlcG9zaXQpIGV4dGVybmFsIHsKICAgICAgICBjcmVhdGVDaGFubmVsUHJpdmF0ZShtc2cuc2VuZGVyLCBfcmVjZWl2ZXJfYWRkcmVzcywgX2RlcG9zaXQpOwoKICAgICAgICAvLyB0cmFuc2ZlckZyb20gZGVwb3NpdCBmcm9tIHNlbmRlciB0byBjb250cmFjdAogICAgICAgIC8vICEgbmVlZHMgcHJpb3IgYXBwcm92YWwgZnJvbSB1c2VyCiAgICAgICAgcmVxdWlyZSh0b2tlbi50cmFuc2ZlckZyb20obXNnLnNlbmRlciwgYWRkcmVzcyh0aGlzKSwgX2RlcG9zaXQpKTsKICAgIH0KCiAgICAvLy8gQGRldiBJbmNyZWFzZSB0aGUgc2VuZGVyJ3MgY3VycmVudCBkZXBvc2l0LgogICAgLy8vIEBwYXJhbSBfcmVjZWl2ZXJfYWRkcmVzcyBUaGUgYWRkcmVzcyB0aGF0IHJlY2VpdmVzIHRva2Vucy4KICAgIC8vLyBAcGFyYW0gX29wZW5fYmxvY2tfbnVtYmVyIFRoZSBibG9jayBudW1iZXIgYXQgd2hpY2ggYSBjaGFubmVsIGJldHdlZW4gdGhlCiAgICAvLy8gc2VuZGVyIGFuZCByZWNlaXZlciB3YXMgY3JlYXRlZC4KICAgIC8vLyBAcGFyYW0gX2FkZGVkX2RlcG9zaXQgVGhlIGFkZGVkIHRva2VuIGRlcG9zaXQgd2l0aCB3aGljaCB0aGUgY3VycmVudCBkZXBvc2l0IGlzIGluY3JlYXNlZC4KICAgIGZ1bmN0aW9uIHRvcFVwRVJDMjAoCiAgICAgICAgYWRkcmVzcyBfcmVjZWl2ZXJfYWRkcmVzcywKICAgICAgICB1aW50MzIgX29wZW5fYmxvY2tfbnVtYmVyLAogICAgICAgIHVpbnQxOTIgX2FkZGVkX2RlcG9zaXQpCiAgICAgICAgZXh0ZXJuYWwKICAgIHsKICAgICAgICB1cGRhdGVJbnRlcm5hbEJhbGFuY2VTdHJ1Y3RzKAogICAgICAgICAgICBtc2cuc2VuZGVyLAogICAgICAgICAgICBfcmVjZWl2ZXJfYWRkcmVzcywKICAgICAgICAgICAgX29wZW5fYmxvY2tfbnVtYmVyLAogICAgICAgICAgICBfYWRkZWRfZGVwb3NpdAogICAgICAgICk7CgogICAgICAgIC8vIHRyYW5zZmVyRnJvbSBkZXBvc2l0IGZyb20gbXNnLnNlbmRlciB0byBjb250cmFjdAogICAgICAgIC8vICEgbmVlZHMgcHJpb3IgYXBwcm92YWwgZnJvbSB1c2VyCiAgICAgICAgLy8gRG8gdHJhbnNmZXIgYWZ0ZXIgYW55IHN0YXRlIGNoYW5nZQogICAgICAgIHJlcXVpcmUodG9rZW4udHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIGFkZHJlc3ModGhpcyksIF9hZGRlZF9kZXBvc2l0KSk7CiAgICB9CgogICAgLy8vIEBkZXYgRnVuY3Rpb24gY2FsbGVkIHdoZW4gYW55IG9mIHRoZSBwYXJ0aWVzIHdhbnRzIHRvIGNsb3NlIHRoZSBjaGFubmVsIGFuZCBzZXR0bGU7CiAgICAvLy8gcmVjZWl2ZXIgbmVlZHMgYSBiYWxhbmNlIHByb29mIHRvIGltbWVkaWF0ZWx5IHNldHRsZSwgc2VuZGVyIHRyaWdnZXJzIGEgY2hhbGxlbmdlIHBlcmlvZC4KICAgIC8vLyBAcGFyYW0gX3JlY2VpdmVyX2FkZHJlc3MgVGhlIGFkZHJlc3MgdGhhdCByZWNlaXZlcyB0b2tlbnMuCiAgICAvLy8gQHBhcmFtIF9vcGVuX2Jsb2NrX251bWJlciBUaGUgYmxvY2sgbnVtYmVyIGF0IHdoaWNoIGEgY2hhbm5lbCBiZXR3ZWVuIHRoZQogICAgLy8vIHNlbmRlciBhbmQgcmVjZWl2ZXIgd2FzIGNyZWF0ZWQuCiAgICAvLy8gQHBhcmFtIF9iYWxhbmNlIFRoZSBhbW91bnQgb2YgdG9rZW5zIG93ZWQgYnkgdGhlIHNlbmRlciB0byB0aGUgcmVjZWl2ZXIuCiAgICAvLy8gQHBhcmFtIF9iYWxhbmNlX21zZ19zaWcgVGhlIGJhbGFuY2UgbWVzc2FnZSBzaWduZWQgYnkgdGhlIHNlbmRlci4KICAgIGZ1bmN0aW9uIHVuY29vcGVyYXRpdmVDbG9zZSgKICAgICAgICBhZGRyZXNzIF9yZWNlaXZlcl9hZGRyZXNzLAogICAgICAgIHVpbnQzMiBfb3Blbl9ibG9ja19udW1iZXIsCiAgICAgICAgdWludDE5MiBfYmFsYW5jZSwKICAgICAgICBieXRlcyBfYmFsYW5jZV9tc2dfc2lnKQogICAgICAgIGV4dGVybmFsCiAgICB7CiAgICAgICAgYWRkcmVzcyBzZW5kZXIgPSB2ZXJpZnlCYWxhbmNlUHJvb2YoX3JlY2VpdmVyX2FkZHJlc3MsIF9vcGVuX2Jsb2NrX251bWJlciwgX2JhbGFuY2UsIF9iYWxhbmNlX21zZ19zaWcpOwoKICAgICAgICBpZihtc2cuc2VuZGVyID09IF9yZWNlaXZlcl9hZGRyZXNzKSB7CiAgICAgICAgICAgIHNldHRsZUNoYW5uZWwoc2VuZGVyLCBfcmVjZWl2ZXJfYWRkcmVzcywgX29wZW5fYmxvY2tfbnVtYmVyLCBfYmFsYW5jZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHNlbmRlcik7CiAgICAgICAgICAgIGluaXRDaGFsbGVuZ2VQZXJpb2QoX3JlY2VpdmVyX2FkZHJlc3MsIF9vcGVuX2Jsb2NrX251bWJlciwgX2JhbGFuY2UpOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8gQGRldiBGdW5jdGlvbiBjYWxsZWQgYnkgdGhlIHNlbmRlciwgd2hlbiBoZSBoYXMgYSBjbG9zaW5nIHNpZ25hdHVyZSBmcm9tIHRoZSByZWNlaXZlcjsKICAgIC8vLyBjaGFubmVsIGlzIGNsb3NlZCBpbW1lZGlhdGVseS4KICAgIC8vLyBAcGFyYW0gX3JlY2VpdmVyX2FkZHJlc3MgVGhlIGFkZHJlc3MgdGhhdCByZWNlaXZlcyB0b2tlbnMuCiAgICAvLy8gQHBhcmFtIF9vcGVuX2Jsb2NrX251bWJlciBUaGUgYmxvY2sgbnVtYmVyIGF0IHdoaWNoIGEgY2hhbm5lbCBiZXR3ZWVuIHRoZQogICAgLy8vIHNlbmRlciBhbmQgcmVjZWl2ZXIgd2FzIGNyZWF0ZWQuCiAgICAvLy8gQHBhcmFtIF9iYWxhbmNlIFRoZSBhbW91bnQgb2YgdG9rZW5zIG93ZWQgYnkgdGhlIHNlbmRlciB0byB0aGUgcmVjZWl2ZXIuCiAgICAvLy8gQHBhcmFtIF9iYWxhbmNlX21zZ19zaWcgVGhlIGJhbGFuY2UgbWVzc2FnZSBzaWduZWQgYnkgdGhlIHNlbmRlci4KICAgIC8vLyBAcGFyYW0gX2Nsb3Npbmdfc2lnIFRoZSBoYXNoIG9mIHRoZSBzaWduZWQgYmFsYW5jZSBtZXNzYWdlLCBzaWduZWQgYnkgdGhlIHJlY2VpdmVyLgogICAgZnVuY3Rpb24gY29vcGVyYXRpdmVDbG9zZSgKICAgICAgICBhZGRyZXNzIF9yZWNlaXZlcl9hZGRyZXNzLAogICAgICAgIHVpbnQzMiBfb3Blbl9ibG9ja19udW1iZXIsCiAgICAgICAgdWludDE5MiBfYmFsYW5jZSwKICAgICAgICBieXRlcyBfYmFsYW5jZV9tc2dfc2lnLAogICAgICAgIGJ5dGVzIF9jbG9zaW5nX3NpZykKICAgICAgICBleHRlcm5hbAogICAgewogICAgICAgIC8vIERlcml2ZSByZWNlaXZlciBhZGRyZXNzIGZyb20gc2lnbmF0dXJlCiAgICAgICAgYWRkcmVzcyByZWNlaXZlciA9IEVDVmVyaWZ5LmVjdmVyaWZ5KGtlY2NhazI1NihfYmFsYW5jZV9tc2dfc2lnKSwgX2Nsb3Npbmdfc2lnKTsKICAgICAgICByZXF1aXJlKHJlY2VpdmVyID09IF9yZWNlaXZlcl9hZGRyZXNzKTsKCiAgICAgICAgLy8gRGVyaXZlIHNlbmRlciBhZGRyZXNzIGZyb20gc2lnbmVkIGJhbGFuY2UgcHJvb2YKICAgICAgICBhZGRyZXNzIHNlbmRlciA9IHZlcmlmeUJhbGFuY2VQcm9vZihfcmVjZWl2ZXJfYWRkcmVzcywgX29wZW5fYmxvY2tfbnVtYmVyLCBfYmFsYW5jZSwgX2JhbGFuY2VfbXNnX3NpZyk7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHNlbmRlcik7CgogICAgICAgIHNldHRsZUNoYW5uZWwoc2VuZGVyLCByZWNlaXZlciwgX29wZW5fYmxvY2tfbnVtYmVyLCBfYmFsYW5jZSk7CiAgICB9CgogICAgLy8vIEBkZXYgRnVuY3Rpb24gZm9yIGdldHRpbmcgaW5mb3JtYXRpb24gYWJvdXQgYSBjaGFubmVsLgogICAgLy8vIEBwYXJhbSBfc2VuZGVyX2FkZHJlc3MgVGhlIGFkZHJlc3MgdGhhdCBzZW5kcyB0b2tlbnMuCiAgICAvLy8gQHBhcmFtIF9yZWNlaXZlcl9hZGRyZXNzIFRoZSBhZGRyZXNzIHRoYXQgcmVjZWl2ZXMgdG9rZW5zLgogICAgLy8vIEBwYXJhbSBfb3Blbl9ibG9ja19udW1iZXIgVGhlIGJsb2NrIG51bWJlciBhdCB3aGljaCBhIGNoYW5uZWwgYmV0d2VlbiB0aGUKICAgIC8vLyBzZW5kZXIgYW5kIHJlY2VpdmVyIHdhcyBjcmVhdGVkLgogICAgLy8vIEByZXR1cm4gQ2hhbm5lbCBpbmZvcm1hdGlvbiAodW5pcXVlX2lkZW50aWZpZXIsIGRlcG9zaXQsIHNldHRsZV9ibG9ja19udW1iZXIsIGNsb3NpbmdfYmFsYW5jZSkuCiAgICBmdW5jdGlvbiBnZXRDaGFubmVsSW5mbygKICAgICAgICBhZGRyZXNzIF9zZW5kZXJfYWRkcmVzcywKICAgICAgICBhZGRyZXNzIF9yZWNlaXZlcl9hZGRyZXNzLAogICAgICAgIHVpbnQzMiBfb3Blbl9ibG9ja19udW1iZXIpCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKGJ5dGVzMzIsIHVpbnQxOTIsIHVpbnQzMiwgdWludDE5MikKICAgIHsKICAgICAgICBieXRlczMyIGtleSA9IGdldEtleShfc2VuZGVyX2FkZHJlc3MsIF9yZWNlaXZlcl9hZGRyZXNzLCBfb3Blbl9ibG9ja19udW1iZXIpOwogICAgICAgIHJlcXVpcmUoY2hhbm5lbHNba2V5XS5vcGVuX2Jsb2NrX251bWJlciA+IDApOwoKICAgICAgICByZXR1cm4gKAogICAgICAgICAgICBrZXksCiAgICAgICAgICAgIGNoYW5uZWxzW2tleV0uZGVwb3NpdCwKICAgICAgICAgICAgY2xvc2luZ19yZXF1ZXN0c1trZXldLnNldHRsZV9ibG9ja19udW1iZXIsCiAgICAgICAgICAgIGNsb3NpbmdfcmVxdWVzdHNba2V5XS5jbG9zaW5nX2JhbGFuY2UKICAgICAgICApOwogICAgfQoKICAgIC8vLyBAZGV2IEZ1bmN0aW9uIGNhbGxlZCBieSB0aGUgc2VuZGVyIGFmdGVyIHRoZSBjaGFsbGVuZ2UgcGVyaW9kIGhhcyBlbmRlZCwKICAgIC8vLyBpbiBjYXNlIHRoZSByZWNlaXZlciBoYXMgbm90IGNsb3NlZCB0aGUgY2hhbm5lbC4KICAgIC8vLyBAcGFyYW0gX3JlY2VpdmVyX2FkZHJlc3MgVGhlIGFkZHJlc3MgdGhhdCByZWNlaXZlcyB0b2tlbnMuCiAgICAvLy8gQHBhcmFtIF9vcGVuX2Jsb2NrX251bWJlciBUaGUgYmxvY2sgbnVtYmVyIGF0IHdoaWNoIGEgY2hhbm5lbCBiZXR3ZWVuCiAgICAvLy8gdGhlIHNlbmRlciBhbmQgcmVjZWl2ZXIgd2FzIGNyZWF0ZWQuCiAgICBmdW5jdGlvbiBzZXR0bGUoYWRkcmVzcyBfcmVjZWl2ZXJfYWRkcmVzcywgdWludDMyIF9vcGVuX2Jsb2NrX251bWJlcikgZXh0ZXJuYWwgewogICAgICAgIGJ5dGVzMzIga2V5ID0gZ2V0S2V5KG1zZy5zZW5kZXIsIF9yZWNlaXZlcl9hZGRyZXNzLCBfb3Blbl9ibG9ja19udW1iZXIpOwoKICAgICAgICAvLyBNYWtlIHN1cmUgYW4gdW5jb29wZXJhdGl2ZUNsb3NlIGhhcyBiZWVuIGluaXRpYXRlZAogICAgICAgIHJlcXVpcmUoY2xvc2luZ19yZXF1ZXN0c1trZXldLnNldHRsZV9ibG9ja19udW1iZXIgPiAwKTsKCiAgICAgICAgLy8gTWFrZSBzdXJlIHRoZSBjaGFsbGVuZ2VfcGVyaW9kIGhhcyBlbmRlZAoJICAgIHJlcXVpcmUoYmxvY2subnVtYmVyID4gY2xvc2luZ19yZXF1ZXN0c1trZXldLnNldHRsZV9ibG9ja19udW1iZXIpOwoKICAgICAgICBzZXR0bGVDaGFubmVsKG1zZy5zZW5kZXIsIF9yZWNlaXZlcl9hZGRyZXNzLCBfb3Blbl9ibG9ja19udW1iZXIsCiAgICAgICAgICAgIGNsb3NpbmdfcmVxdWVzdHNba2V5XS5jbG9zaW5nX2JhbGFuY2UKICAgICAgICApOwogICAgfQoKICAgIC8qCiAgICAgKiAgUHJpdmF0ZSBmdW5jdGlvbnMKICAgICAqLwoKICAgIC8vLyBAZGV2IENyZWF0ZXMgYSBuZXcgY2hhbm5lbCBiZXR3ZWVuIGEgc2VuZGVyIGFuZCBhIHJlY2VpdmVyLAogICAgLy8vIG9ubHkgY2FsbGFibGUgYnkgdGhlIFRva2VuIGNvbnRyYWN0LgogICAgLy8vIEBwYXJhbSBfc2VuZGVyX2FkZHJlc3MgVGhlIGFkZHJlc3MgdGhhdCBzZW5kcyB0b2tlbnMuCiAgICAvLy8gQHBhcmFtIF9yZWNlaXZlcl9hZGRyZXNzIFRoZSBhZGRyZXNzIHRoYXQgcmVjZWl2ZXMgdG9rZW5zLgogICAgLy8vIEBwYXJhbSBfZGVwb3NpdCBUaGUgYW1vdW50IG9mIHRva2VucyB0aGF0IHRoZSBzZW5kZXIgZXNjcm93cy4KICAgIGZ1bmN0aW9uIGNyZWF0ZUNoYW5uZWxQcml2YXRlKGFkZHJlc3MgX3NlbmRlcl9hZGRyZXNzLCBhZGRyZXNzIF9yZWNlaXZlcl9hZGRyZXNzLCB1aW50MTkyIF9kZXBvc2l0KSBwcml2YXRlIHsKICAgICAgICByZXF1aXJlKF9kZXBvc2l0IDw9IGNoYW5uZWxfZGVwb3NpdF9idWdib3VudHlfbGltaXQpOwoKICAgICAgICB1aW50MzIgb3Blbl9ibG9ja19udW1iZXIgPSB1aW50MzIoYmxvY2subnVtYmVyKTsKCiAgICAgICAgLy8gQ3JlYXRlIHVuaXF1ZSBpZGVudGlmaWVyIGZyb20gc2VuZGVyLCByZWNlaXZlciBhbmQgY3VycmVudCBibG9jayBudW1iZXIKICAgICAgICBieXRlczMyIGtleSA9IGdldEtleShfc2VuZGVyX2FkZHJlc3MsIF9yZWNlaXZlcl9hZGRyZXNzLCBvcGVuX2Jsb2NrX251bWJlcik7CgogICAgICAgIHJlcXVpcmUoY2hhbm5lbHNba2V5XS5kZXBvc2l0ID09IDApOwogICAgICAgIHJlcXVpcmUoY2hhbm5lbHNba2V5XS5vcGVuX2Jsb2NrX251bWJlciA9PSAwKTsKICAgICAgICByZXF1aXJlKGNsb3NpbmdfcmVxdWVzdHNba2V5XS5zZXR0bGVfYmxvY2tfbnVtYmVyID09IDApOwoKICAgICAgICAvLyBTdG9yZSBjaGFubmVsIGluZm9ybWF0aW9uCiAgICAgICAgY2hhbm5lbHNba2V5XSA9IENoYW5uZWwoe2RlcG9zaXQ6IF9kZXBvc2l0LCBvcGVuX2Jsb2NrX251bWJlcjogb3Blbl9ibG9ja19udW1iZXJ9KTsKICAgICAgICBDaGFubmVsQ3JlYXRlZChfc2VuZGVyX2FkZHJlc3MsIF9yZWNlaXZlcl9hZGRyZXNzLCBfZGVwb3NpdCk7CiAgICB9CgogICAgLy8vIEBkZXYgVXBkYXRlcyBpbnRlcm5hbCBiYWxhbmNlIFN0cnVjdHVyZXMsIG9ubHkgY2FsbGFibGUgYnkgdGhlIFRva2VuIGNvbnRyYWN0LgogICAgLy8vIEBwYXJhbSBfc2VuZGVyX2FkZHJlc3MgVGhlIGFkZHJlc3MgdGhhdCBzZW5kcyB0b2tlbnMuCiAgICAvLy8gQHBhcmFtIF9yZWNlaXZlcl9hZGRyZXNzIFRoZSBhZGRyZXNzIHRoYXQgcmVjZWl2ZXMgdG9rZW5zLgogICAgLy8vIEBwYXJhbSBfb3Blbl9ibG9ja19udW1iZXIgVGhlIGJsb2NrIG51bWJlciBhdCB3aGljaCBhIGNoYW5uZWwgYmV0d2VlbiB0aGUKICAgIC8vLyBzZW5kZXIgYW5kIHJlY2VpdmVyIHdhcyBjcmVhdGVkLgogICAgLy8vIEBwYXJhbSBfYWRkZWRfZGVwb3NpdCBUaGUgYWRkZWQgdG9rZW4gZGVwb3NpdCB3aXRoIHdoaWNoIHRoZSBjdXJyZW50IGRlcG9zaXQgaXMgaW5jcmVhc2VkLgogICAgZnVuY3Rpb24gdXBkYXRlSW50ZXJuYWxCYWxhbmNlU3RydWN0cygKICAgICAgICBhZGRyZXNzIF9zZW5kZXJfYWRkcmVzcywKICAgICAgICBhZGRyZXNzIF9yZWNlaXZlcl9hZGRyZXNzLAogICAgICAgIHVpbnQzMiBfb3Blbl9ibG9ja19udW1iZXIsCiAgICAgICAgdWludDE5MiBfYWRkZWRfZGVwb3NpdCkKICAgICAgICBwcml2YXRlCiAgICB7CiAgICAgICAgcmVxdWlyZShfYWRkZWRfZGVwb3NpdCA+IDApOwogICAgICAgIHJlcXVpcmUoX29wZW5fYmxvY2tfbnVtYmVyID4gMCk7CgogICAgICAgIGJ5dGVzMzIga2V5ID0gZ2V0S2V5KF9zZW5kZXJfYWRkcmVzcywgX3JlY2VpdmVyX2FkZHJlc3MsIF9vcGVuX2Jsb2NrX251bWJlcik7CgogICAgICAgIHJlcXVpcmUoY2hhbm5lbHNba2V5XS5kZXBvc2l0ID4gMCk7CiAgICAgICAgcmVxdWlyZShjbG9zaW5nX3JlcXVlc3RzW2tleV0uc2V0dGxlX2Jsb2NrX251bWJlciA9PSAwKTsKICAgICAgICByZXF1aXJlKGNoYW5uZWxzW2tleV0uZGVwb3NpdCArIF9hZGRlZF9kZXBvc2l0IDw9IGNoYW5uZWxfZGVwb3NpdF9idWdib3VudHlfbGltaXQpOwoKICAgICAgICBjaGFubmVsc1trZXldLmRlcG9zaXQgKz0gX2FkZGVkX2RlcG9zaXQ7CiAgICAgICAgYXNzZXJ0KGNoYW5uZWxzW2tleV0uZGVwb3NpdCA+IF9hZGRlZF9kZXBvc2l0KTsKICAgICAgICBDaGFubmVsVG9wcGVkVXAoX3NlbmRlcl9hZGRyZXNzLCBfcmVjZWl2ZXJfYWRkcmVzcywgX29wZW5fYmxvY2tfbnVtYmVyLCBfYWRkZWRfZGVwb3NpdCk7CiAgICB9CgoKICAgIC8vLyBAZGV2IFNlbmRlciBzdGFydHMgdGhlIGNoYWxsZW5nZSBwZXJpb2Q7IHRoaXMgY2FuIG9ubHkgaGFwcGVuIG9uY2UuCiAgICAvLy8gQHBhcmFtIF9yZWNlaXZlcl9hZGRyZXNzIFRoZSBhZGRyZXNzIHRoYXQgcmVjZWl2ZXMgdG9rZW5zLgogICAgLy8vIEBwYXJhbSBfb3Blbl9ibG9ja19udW1iZXIgVGhlIGJsb2NrIG51bWJlciBhdCB3aGljaCBhIGNoYW5uZWwgYmV0d2VlbgogICAgLy8vIHRoZSBzZW5kZXIgYW5kIHJlY2VpdmVyIHdhcyBjcmVhdGVkLgogICAgLy8vIEBwYXJhbSBfYmFsYW5jZSBUaGUgYW1vdW50IG9mIHRva2VucyBvd2VkIGJ5IHRoZSBzZW5kZXIgdG8gdGhlIHJlY2VpdmVyLgogICAgZnVuY3Rpb24gaW5pdENoYWxsZW5nZVBlcmlvZCgKICAgICAgICBhZGRyZXNzIF9yZWNlaXZlcl9hZGRyZXNzLAogICAgICAgIHVpbnQzMiBfb3Blbl9ibG9ja19udW1iZXIsCiAgICAgICAgdWludDE5MiBfYmFsYW5jZSkKICAgICAgICBwcml2YXRlCiAgICB7CiAgICAgICAgYnl0ZXMzMiBrZXkgPSBnZXRLZXkobXNnLnNlbmRlciwgX3JlY2VpdmVyX2FkZHJlc3MsIF9vcGVuX2Jsb2NrX251bWJlcik7CgogICAgICAgIHJlcXVpcmUoY2xvc2luZ19yZXF1ZXN0c1trZXldLnNldHRsZV9ibG9ja19udW1iZXIgPT0gMCk7CiAgICAgICAgcmVxdWlyZShfYmFsYW5jZSA8PSBjaGFubmVsc1trZXldLmRlcG9zaXQpOwoKICAgICAgICAvLyBNYXJrIGNoYW5uZWwgYXMgY2xvc2VkCiAgICAgICAgY2xvc2luZ19yZXF1ZXN0c1trZXldLnNldHRsZV9ibG9ja19udW1iZXIgPSB1aW50MzIoYmxvY2subnVtYmVyKSArIGNoYWxsZW5nZV9wZXJpb2Q7CiAgICAgICAgY2xvc2luZ19yZXF1ZXN0c1trZXldLmNsb3NpbmdfYmFsYW5jZSA9IF9iYWxhbmNlOwogICAgICAgIENoYW5uZWxDbG9zZVJlcXVlc3RlZChtc2cuc2VuZGVyLCBfcmVjZWl2ZXJfYWRkcmVzcywgX29wZW5fYmxvY2tfbnVtYmVyLCBfYmFsYW5jZSk7CiAgICB9CgogICAgLy8vIEBkZXYgRGVsZXRlcyB0aGUgY2hhbm5lbCBhbmQgc2V0dGxlcyBieSB0cmFuc2ZlcmluZyB0aGUgYmFsYW5jZSB0byB0aGUgcmVjZWl2ZXIKICAgIC8vLyBhbmQgdGhlIHJlc3Qgb2YgdGhlIGRlcG9zaXQgYmFjayB0byB0aGUgc2VuZGVyLgogICAgLy8vIEBwYXJhbSBfc2VuZGVyX2FkZHJlc3MgVGhlIGFkZHJlc3MgdGhhdCBzZW5kcyB0b2tlbnMuCiAgICAvLy8gQHBhcmFtIF9yZWNlaXZlcl9hZGRyZXNzIFRoZSBhZGRyZXNzIHRoYXQgcmVjZWl2ZXMgdG9rZW5zLgogICAgLy8vIEBwYXJhbSBfb3Blbl9ibG9ja19udW1iZXIgVGhlIGJsb2NrIG51bWJlciBhdCB3aGljaCBhIGNoYW5uZWwgYmV0d2VlbiB0aGUKICAgIC8vLyBzZW5kZXIgYW5kIHJlY2VpdmVyIHdhcyBjcmVhdGVkLgogICAgLy8vIEBwYXJhbSBfYmFsYW5jZSBUaGUgYW1vdW50IG9mIHRva2VucyBvd2VkIGJ5IHRoZSBzZW5kZXIgdG8gdGhlIHJlY2VpdmVyLgogICAgZnVuY3Rpb24gc2V0dGxlQ2hhbm5lbCgKICAgICAgICBhZGRyZXNzIF9zZW5kZXJfYWRkcmVzcywKICAgICAgICBhZGRyZXNzIF9yZWNlaXZlcl9hZGRyZXNzLAogICAgICAgIHVpbnQzMiBfb3Blbl9ibG9ja19udW1iZXIsCiAgICAgICAgdWludDE5MiBfYmFsYW5jZSkKICAgICAgICBwcml2YXRlCiAgICB7CiAgICAgICAgYnl0ZXMzMiBrZXkgPSBnZXRLZXkoX3NlbmRlcl9hZGRyZXNzLCBfcmVjZWl2ZXJfYWRkcmVzcywgX29wZW5fYmxvY2tfbnVtYmVyKTsKICAgICAgICBDaGFubmVsIG1lbW9yeSBjaGFubmVsID0gY2hhbm5lbHNba2V5XTsKCiAgICAgICAgcmVxdWlyZShjaGFubmVsLm9wZW5fYmxvY2tfbnVtYmVyID4gMCk7CiAgICAgICAgcmVxdWlyZShfYmFsYW5jZSA8PSBjaGFubmVsLmRlcG9zaXQpOwoKICAgICAgICAvLyBSZW1vdmUgY2xvc2VkIGNoYW5uZWwgc3RydWN0dXJlcwogICAgICAgIC8vIGNoYW5uZWwub3Blbl9ibG9ja19udW1iZXIgd2lsbCBiZWNvbWUgMAogICAgICAgIC8vIENoYW5nZSBzdGF0ZSBiZWZvcmUgdHJhbnNmZXIgY2FsbAogICAgICAgIGRlbGV0ZSBjaGFubmVsc1trZXldOwogICAgICAgIGRlbGV0ZSBjbG9zaW5nX3JlcXVlc3RzW2tleV07CgogICAgICAgIC8vIFNlbmQgX2JhbGFuY2UgdG8gdGhlIHJlY2VpdmVyLCBhcyBpdCBpcyBhbHdheXMgPD0gZGVwb3NpdAogICAgICAgIHJlcXVpcmUodG9rZW4udHJhbnNmZXIoX3JlY2VpdmVyX2FkZHJlc3MsIF9iYWxhbmNlKSk7CgogICAgICAgIC8vIFNlbmQgZGVwb3NpdCAtIGJhbGFuY2UgYmFjayB0byBzZW5kZXIKICAgICAgICByZXF1aXJlKHRva2VuLnRyYW5zZmVyKF9zZW5kZXJfYWRkcmVzcywgY2hhbm5lbC5kZXBvc2l0IC0gX2JhbGFuY2UpKTsKCiAgICAgICAgQ2hhbm5lbFNldHRsZWQoX3NlbmRlcl9hZGRyZXNzLCBfcmVjZWl2ZXJfYWRkcmVzcywgX29wZW5fYmxvY2tfbnVtYmVyLCBfYmFsYW5jZSk7CiAgICB9CgogICAgLyoKICAgICAqICBJbnRlcm5hbCBmdW5jdGlvbnMKICAgICAqLwoKICAgIC8vLyBAZGV2IEludGVybmFsIGZ1bmN0aW9uIGZvciBnZXR0aW5nIGFuIGFkZHJlc3MgZnJvbSB0b2tlbkZhbGxiYWNrIGRhdGEgYnl0ZXMuCiAgICAvLy8gQHBhcmFtIGIgQnl0ZXMgcmVjZWl2ZWQuCiAgICAvLy8gQHJldHVybiBBZGRyZXNzIHJlc3VsdGVkLgogICAgZnVuY3Rpb24gYWRkcmVzc0Zyb21EYXRhIChieXRlcyBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKGFkZHJlc3MpIHsKICAgICAgICBieXRlczIwIGFkZHI7CiAgICAgICAgYXNzZW1ibHkgewogICAgICAgICAgICAvLyBSZWFkIGFkZHJlc3MgYnl0ZXMKICAgICAgICAgICAgLy8gT2Zmc2V0IG9mIDMyIGJ5dGVzLCByZXByZXNlbnRpbmcgYi5sZW5ndGgKICAgICAgICAgICAgYWRkciA6PSBtbG9hZChhZGQoYiwgMHgyMCkpCiAgICAgICAgfQogICAgICAgIHJldHVybiBhZGRyZXNzKGFkZHIpOwogICAgfQoKICAgIC8vLyBAZGV2IEludGVybmFsIGZ1bmN0aW9uIGZvciBnZXR0aW5nIHRoZSBibG9jayBudW1iZXIgZnJvbSB0b2tlbkZhbGxiYWNrIGRhdGEgYnl0ZXMuCiAgICAvLy8gQHBhcmFtIGIgQnl0ZXMgcmVjZWl2ZWQuCiAgICAvLy8gQHJldHVybiBCbG9jayBudW1iZXIuCiAgICBmdW5jdGlvbiBibG9ja051bWJlckZyb21EYXRhKGJ5dGVzIGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDMyKSB7CiAgICAgICAgYnl0ZXM0IGJsb2NrX251bWJlcjsKICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgIC8vIFJlYWQgYmxvY2sgbnVtYmVyIGJ5dGVzCiAgICAgICAgICAgIC8vIE9mZnNldCBvZiAzMiBieXRlcyAoYi5sZW5ndGgpICsgMjAgYnl0ZXMgKGFkZHJlc3MpCiAgICAgICAgICAgIGJsb2NrX251bWJlciA6PSBtbG9hZChhZGQoYiwgMHgzNCkpCiAgICAgICAgfQogICAgICAgIHJldHVybiB1aW50MzIoYmxvY2tfbnVtYmVyKTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBDaGVjayBpZiBhIGNvbnRyYWN0IGV4aXN0cwogICAgLy8vIEBwYXJhbSBfY29udHJhY3QgVGhlIGFkZHJlc3Mgb2YgdGhlIGNvbnRyYWN0IHRvIGNoZWNrIGZvci4KICAgIC8vLyBAcmV0dXJuIFRydWUgaWYgYSBjb250cmFjdCBleGlzdHMsIGZhbHNlIG90aGVyd2lzZQogICAgZnVuY3Rpb24gYWRkcmVzc0hhc0NvZGUoYWRkcmVzcyBfY29udHJhY3QpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICB1aW50IHNpemU7CiAgICAgICAgYXNzZW1ibHkgewogICAgICAgICAgICBzaXplIDo9IGV4dGNvZGVzaXplKF9jb250cmFjdCkKICAgICAgICB9CgogICAgICAgIHJldHVybiBzaXplID4gMDsKICAgIH0KfQ=='.
	

]
