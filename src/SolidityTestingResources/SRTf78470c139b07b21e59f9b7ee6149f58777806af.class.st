Class {
	#name : #SRTf78470c139b07b21e59f9b7ee6149f58777806af,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTf78470c139b07b21e59f9b7ee6149f58777806af >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICAgIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgaWYgKGEgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgICAgdWludDI1NiBjID0gYSAqIGI7CiAgICAgICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoYiA8PSBhKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgICAgICBhc3NlcnQoYyA+PSBhKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KfQoKCmNvbnRyYWN0IFRydW1wQmluZ28gewoKICAgIC8qIEdMT0JBTCBDT05TVEFOVFMgKi8KICAgIHVpbnQyNTYgcHJpdmF0ZSBtaW5CaWQgPSAwLjAxIGV0aGVyOwogICAgdWludDI1NiBwcml2YXRlIGZlZVBlcmNlbnQgPSA1OyAgLy8gb25seSBjaGFyZ2VkIGZyb20gcHJvZml0cwogICAgdWludDI1NiBwcml2YXRlIGphY2twb3RQZXJjZW50ID0gMTA7ICAvLyBvbmx5IGNoYXJnZWQgZnJvbSBwcm9maXRzCiAgICB1aW50MjU2IHByaXZhdGUgc3RhcnRpbmdDb293bmVyUHJpY2UgPSAxMCBldGhlcjsKCiAgICAvKiBBRE1JTiBBUkVBICovCgogICAgYm9vbCBwdWJsaWMgcGF1c2VkOwoKICAgIGFkZHJlc3MgcHVibGljIGNlb0FkZHJlc3M7CiAgICBhZGRyZXNzIHB1YmxpYyBmZWVBZGRyZXNzOwogICAgYWRkcmVzcyBwdWJsaWMgZmVlZEFkZHJlc3M7CgogICAgbW9kaWZpZXIgbm90UGF1c2VkKCkgewogICAgICAgIHJlcXVpcmUoIXBhdXNlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5RmVlZCgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gZmVlZEFkZHJlc3MpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seUNFTygpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY2VvQWRkcmVzcyk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRDRU8oYWRkcmVzcyBfbmV3Q0VPKSBwdWJsaWMgb25seUNFTyB7CiAgICAgICAgcmVxdWlyZShfbmV3Q0VPICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICBjZW9BZGRyZXNzID0gX25ld0NFTzsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRGZWVkQWRkcmVzcyhhZGRyZXNzIF9uZXdGZWVkKSBwdWJsaWMgb25seUNFTyB7CiAgICAgICAgZmVlZEFkZHJlc3MgPSBfbmV3RmVlZDsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRGZWVBZGRyZXNzKGFkZHJlc3MgX25ld0ZlZSkgcHVibGljIG9ubHlDRU8gewogICAgICAgIGZlZUFkZHJlc3MgPSBfbmV3RmVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHBhdXNlQ29udHJhY3QoKSBwdWJsaWMgb25seUNFTyB7CiAgICAgICAgcGF1c2VkID0gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiB1bnBhdXNlQ29udHJhY3QoKSBwdWJsaWMgb25seUNFTyB7CiAgICAgICAgcGF1c2VkID0gZmFsc2U7CiAgICB9CgogICAgLyogUFJPRklUUyAqLwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHJpdmF0ZSBwcm9maXRzOwoKICAgIGZ1bmN0aW9uIGdldFByb2ZpdHMoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gcHJvZml0c1t3aG9dOwogICAgfQoKICAgIGZ1bmN0aW9uIHdpdGhkcmF3KGFkZHJlc3Mgd2hvKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUocHJvZml0c1t3aG9dID4gMCk7CiAgICAgICAgdWludDI1NiBhbW91bnQgPSBwcm9maXRzW3dob107CiAgICAgICAgcHJvZml0c1t3aG9dID0gMDsKICAgICAgICB3aG8udHJhbnNmZXIoYW1vdW50KTsKICAgIH0KCiAgICAvKiBDT09XTkVSIE1BTkFHRU1FTlQgKi8KCiAgICBhZGRyZXNzIHB1YmxpYyBmZWVDb293bmVyQWRkcmVzczsKICAgIHVpbnQyNTYgcHVibGljIGNvb3duZXJQcmljZTsKCiAgICBmdW5jdGlvbiBiZWNvbWVDb293bmVyKCkgcHVibGljIHBheWFibGUgewogICAgICAgIGlmIChtc2cudmFsdWUgPCBjb293bmVyUHJpY2UpIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQoKICAgICAgICB1aW50MjU2IG91ckZlZSA9IGNvb3duZXJQcmljZSAvIDEwOwogICAgICAgIHVpbnQyNTYgcHJvZml0ID0gY29vd25lclByaWNlIC0gb3VyRmVlOwogICAgICAgIHByb2ZpdHNbZmVlQ29vd25lckFkZHJlc3NdICs9IHByb2ZpdDsKICAgICAgICBwcm9maXRzW2ZlZUFkZHJlc3NdICs9IG91ckZlZTsKICAgICAgICBwcm9maXRzW21zZy5zZW5kZXJdICs9IG1zZy52YWx1ZSAtIGNvb3duZXJQcmljZTsKICAgICAgICBjb293bmVyUHJpY2UgPSBjb293bmVyUHJpY2UgKiAzIC8gMjsKICAgICAgICBmZWVDb293bmVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICB9CgoKICAgIC8qIFdPUkQgTUFOQUdFTUVOVCAqLwoKICAgIHN0cnVjdCBXb3JkIHsKICAgICAgICBzdHJpbmcgd29yZDsKICAgICAgICBib29sIGRpc2FibGVkOwogICAgfQoKCiAgICBldmVudCBXb3JkU2V0Q2hhbmdlZCgpOwoKICAgIFdvcmRbXSBwcml2YXRlIHdvcmRzOwogICAgbWFwcGluZyAoc3RyaW5nID0+IHVpbnQyNTYpIHByaXZhdGUgaWRCeVdvcmQ7CgogICAgZnVuY3Rpb24gZ2V0V29yZENvdW50KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiB3b3Jkcy5sZW5ndGg7CiAgICAgfQoKICAgIGZ1bmN0aW9uIGdldFdvcmQodWludCBpbmRleCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nIHdvcmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgZGlzYWJsZWQpIHsKICAgICAgICByZXF1aXJlKGluZGV4IDwgd29yZHMubGVuZ3RoKTsKICAgICAgICByZXR1cm4gKHdvcmRzW2luZGV4XS53b3JkLCB3b3Jkc1tpbmRleF0uZGlzYWJsZWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFdvcmRJbmRleChzdHJpbmcgd29yZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBpZEJ5V29yZFt3b3JkXTsKICAgICB9CgoKICAgIGZ1bmN0aW9uIGFkZFdvcmQoc3RyaW5nIHdvcmQpIHB1YmxpYyBvbmx5Q0VPIHsKICAgICAgICB1aW50IGluZGV4ID0gaWRCeVdvcmRbd29yZF07CiAgICAgICAgcmVxdWlyZShpbmRleCA9PSAwKTsKICAgICAgICBpbmRleCA9IHdvcmRzLnB1c2goV29yZCh7d29yZDogd29yZCwgZGlzYWJsZWQ6IGZhbHNlfSkpIC0gMTsKICAgICAgICBpZEJ5V29yZFt3b3JkXSA9IGluZGV4OwogICAgICAgIGJpZHMubGVuZ3RoID0gd29yZHMubGVuZ3RoOwogICAgICAgIFdvcmRTZXRDaGFuZ2VkKCk7CiAgICB9CgogICAgZnVuY3Rpb24gZGVsV29yZChzdHJpbmcgd29yZCkgcHVibGljIG9ubHlDRU8gewogICAgICAgIHVpbnQgaW5kZXggPSBpZEJ5V29yZFt3b3JkXTsKICAgICAgICByZXF1aXJlKGluZGV4ID4gMCk7CiAgICAgICAgcmVxdWlyZShiaWRzW2luZGV4XS5iZXN0QmlkZGVyID09IGFkZHJlc3MoMCkpOwogICAgICAgIGlkQnlXb3JkW3dvcmRdID0gMDsKICAgICAgICB3b3Jkc1tpbmRleF0uZGlzYWJsZWQgPSB0cnVlOwogICAgICAgIFdvcmRTZXRDaGFuZ2VkKCk7CiAgICB9CgogICAgLyogV0lOTkVSUyBNQU5BR0VNRU5UICovCiAgICB1aW50IHB1YmxpYyBwcmV2VHdlZXRUaW1lOwogICAgdWludDI1NiBwdWJsaWMgcHJldlJvdW5kVHdlZXRJZDsKICAgIHN0cnVjdCBXaW5uZXJJbmZvIHsKICAgICAgICBhZGRyZXNzIHdobzsKICAgICAgICB1aW50MjU2IGhvd011Y2g7CiAgICAgICAgdWludDI1NiB3b3JkSWQ7CiAgICB9CgogICAgV2lubmVySW5mb1tdIHByaXZhdGUgcHJldlJvdW5kV2lubmVyczsKICAgIHVpbnQgcHJpdmF0ZSBwcmV2Um91bmRXaW5uZXJDb3VudDsKCiAgICBmdW5jdGlvbiBnZXRQcmV2Um91bmRXaW5uZXJDb3VudCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgd2lubmVyQ291bnQpICB7CiAgICAgICAgd2lubmVyQ291bnQgPSBwcmV2Um91bmRXaW5uZXJDb3VudDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRQcmV2Um91bmRXaW5uZXIodWludCBpKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzIHdobywgdWludDI1NiBob3dNdWNoLCB1aW50MjU2IHdvcmRJZCkgewogICAgICAgIHdobyA9IHByZXZSb3VuZFdpbm5lcnNbaV0ud2hvOwogICAgICAgIGhvd011Y2ggPSBwcmV2Um91bmRXaW5uZXJzW2ldLmhvd011Y2g7CiAgICAgICAgd29yZElkID0gcHJldlJvdW5kV2lubmVyc1tpXS53b3JkSWQ7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkV2lubmVyKGFkZHJlc3Mgd2hvLCB1aW50IGhvd011Y2gsIHVpbnQgd29yZElkKSBwcml2YXRlIHsKICAgICAgICArK3ByZXZSb3VuZFdpbm5lckNvdW50OwogICAgICAgIGlmIChwcmV2Um91bmRXaW5uZXJzLmxlbmd0aCA8IHByZXZSb3VuZFdpbm5lckNvdW50KSB7CiAgICAgICAgICAgIHByZXZSb3VuZFdpbm5lcnMubGVuZ3RoID0gcHJldlJvdW5kV2lubmVyQ291bnQ7CiAgICAgICAgfQogICAgICAgIHByZXZSb3VuZFdpbm5lcnNbcHJldlJvdW5kV2lubmVyQ291bnQgLSAxXS53aG8gPSB3aG87CiAgICAgICAgcHJldlJvdW5kV2lubmVyc1twcmV2Um91bmRXaW5uZXJDb3VudCAtIDFdLmhvd011Y2ggPSBob3dNdWNoOwogICAgICAgIHByZXZSb3VuZFdpbm5lcnNbcHJldlJvdW5kV2lubmVyQ291bnQgLSAxXS53b3JkSWQgPSB3b3JkSWQ7CiAgICB9CgogICAgLyogQklEUyBNQU5BR0VNRU5UICovCiAgICBzdHJ1Y3QgQmlkIHsKICAgICAgICB1aW50MjU2IGN1bVZhbHVlOwogICAgICAgIHVpbnQyNTYgdmFsaWRSb3VuZE5vOwogICAgfQoKICAgIHN0cnVjdCBXb3JkQmlkcyB7CiAgICAgICAgbWFwcGluZyAoYWRkcmVzcyA9PiBCaWQpIHRvdGFsQmlkczsKICAgICAgICBhZGRyZXNzIGJlc3RCaWRkZXI7CiAgICB9CgogICAgdWludDI1NiBwcml2YXRlIGN1clJvdW5kOwogICAgV29yZEJpZHNbXSBwcml2YXRlIGJpZHM7CgogICAgdWludDI1NiBwcml2YXRlIHRvdGFsQmFuazsKICAgIHVpbnQyNTYgcHJpdmF0ZSB0b3RhbEphY2twb3Q7CgogICAgZnVuY3Rpb24gZ2V0SmFja3BvdCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gdG90YWxKYWNrcG90OwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEJhbmsoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHRvdGFsQmFuazsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRCZXN0QmlkZGVyKHVpbnQyNTYgd29yZEluZGV4KSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzLCB1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIChiaWRzW3dvcmRJbmRleF0uYmVzdEJpZGRlciwgYmlkc1t3b3JkSW5kZXhdLnRvdGFsQmlkc1tiaWRzW3dvcmRJbmRleF0uYmVzdEJpZGRlcl0uY3VtVmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEJlc3RCaWQodWludDI1NiB3b3JkSW5kZXgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gYmlkc1t3b3JkSW5kZXhdLnRvdGFsQmlkc1tiaWRzW3dvcmRJbmRleF0uYmVzdEJpZGRlcl0uY3VtVmFsdWU7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0TWluQWxsb3dlZEJpZCh1aW50MjU2IHdvcmRJbmRleCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBnZXRCZXN0QmlkKHdvcmRJbmRleCkgKyBtaW5CaWQ7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0VG90YWxCaWQoYWRkcmVzcyB3aG8sIHVpbnQyNTYgd29yZEluZGV4KSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgaWYgKGJpZHNbd29yZEluZGV4XS50b3RhbEJpZHNbd2hvXS52YWxpZFJvdW5kTm8gIT0gY3VyUm91bmQpIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICAgIHJldHVybiBiaWRzW3dvcmRJbmRleF0udG90YWxCaWRzW3dob10uY3VtVmFsdWU7CiAgICB9CgogICAgZnVuY3Rpb24gc3RhcnROZXdSb3VuZCgpIHByaXZhdGUgewogICAgICAgIHRvdGFsQmFuayA9IDA7CiAgICAgICAgKytjdXJSb3VuZDsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBiaWRzLmxlbmd0aDsgKytpKSB7CiAgICAgICAgICAgIGJpZHNbaV0uYmVzdEJpZGRlciA9IDA7CiAgICAgICAgfQogICAgfQoKICAgIGV2ZW50IEJlc3RCaWRVcGRhdGUoKTsKCiAgICBmdW5jdGlvbiBhZGRCaWQoYWRkcmVzcyB3aG8sIHVpbnQgd29yZEluZGV4LCB1aW50MjU2IHZhbHVlKSBwcml2YXRlIHsKICAgICAgICBpZiAoYmlkc1t3b3JkSW5kZXhdLnRvdGFsQmlkc1t3aG9dLnZhbGlkUm91bmRObyAhPSBjdXJSb3VuZCkgewogICAgICAgICAgICBiaWRzW3dvcmRJbmRleF0udG90YWxCaWRzW3dob10uY3VtVmFsdWUgPSAwOwogICAgICAgICAgICBiaWRzW3dvcmRJbmRleF0udG90YWxCaWRzW3dob10udmFsaWRSb3VuZE5vID0gY3VyUm91bmQ7CiAgICAgICAgfQoKICAgICAgICB1aW50MjU2IG5ld0JpZCA9IHZhbHVlICsgYmlkc1t3b3JkSW5kZXhdLnRvdGFsQmlkc1t3aG9dLmN1bVZhbHVlOwogICAgICAgIHVpbnQyNTYgbWluQWxsb3dlZEJpZCA9IGdldE1pbkFsbG93ZWRCaWQod29yZEluZGV4KTsKICAgICAgICBpZiAobWluQWxsb3dlZEJpZCA+IG5ld0JpZCkgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CgogICAgICAgIGJpZHNbd29yZEluZGV4XS50b3RhbEJpZHNbd2hvXS5jdW1WYWx1ZSA9IG5ld0JpZDsKICAgICAgICBiaWRzW3dvcmRJbmRleF0uYmVzdEJpZGRlciA9IHdobzsKICAgICAgICB0b3RhbEJhbmsgKz0gdmFsdWU7CiAgICAgICAgQmVzdEJpZFVwZGF0ZSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNhbGNQYXlvdXRzKGJvb2xbXSBoYXNXb24pIHByaXZhdGUgewogICAgICAgIHVpbnQyNTYgdG90YWxXb247CiAgICAgICAgdWludCBpOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCB3b3Jkcy5sZW5ndGg7ICsraSkgewogICAgICAgICAgICBpZiAoaGFzV29uW2ldKSB7CiAgICAgICAgICAgICAgICB0b3RhbFdvbiArPSBnZXRCZXN0QmlkKGkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAodG90YWxXb24gPT0gMCkgewogICAgICAgICAgICB0b3RhbEphY2twb3QgKz0gdG90YWxCYW5rOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHVpbnQyNTYgYmFuayA9IHRvdGFsSmFja3BvdCAvIDI7CiAgICAgICAgdG90YWxKYWNrcG90IC09IGJhbms7CiAgICAgICAgYmFuayArPSB0b3RhbEJhbms7CgogICAgICAgIC8vIGNoYXJnZSBvbmx5IGxvb3NlcnMKICAgICAgICB1aW50MjU2IGZlZSA9IHVpbnQyNTYoU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChiYW5rIC0gdG90YWxXb24sIGZlZVBlcmNlbnQpLCAxMDApKTsKICAgICAgICBiYW5rIC09IGZlZTsKICAgICAgICBwcm9maXRzW2ZlZUFkZHJlc3NdICs9IGZlZSAvIDI7CiAgICAgICAgZmVlIC09IGZlZSAvIDI7CiAgICAgICAgcHJvZml0c1tmZWVDb293bmVyQWRkcmVzc10gKz0gZmVlOwoKICAgICAgICB1aW50MjU2IGphY2twb3RGaWxsID0gdWludDI1NihTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKGJhbmsgLSB0b3RhbFdvbiwgamFja3BvdFBlcmNlbnQpLCAxMDApKTsKICAgICAgICBiYW5rIC09IGphY2twb3RGaWxsOwogICAgICAgIHRvdGFsSmFja3BvdCArPSBqYWNrcG90RmlsbDsKCiAgICAgICAgZm9yIChpID0gMDsgaSA8IHdvcmRzLmxlbmd0aDsgKytpKSB7CiAgICAgICAgICAgIGlmIChoYXNXb25baV0gJiYgYmlkc1tpXS5iZXN0QmlkZGVyICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgICAgIHVpbnQyNTYgcGF5b3V0ID0gdWludDI1NihTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKGJhbmssIGdldEJlc3RCaWQoaSkpLCB0b3RhbFdvbikpOwogICAgICAgICAgICAgICAgcHJvZml0c1tiaWRzW2ldLmJlc3RCaWRkZXJdICs9IHBheW91dDsKICAgICAgICAgICAgICAgIGFkZFdpbm5lcihiaWRzW2ldLmJlc3RCaWRkZXIsIHBheW91dCwgaSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0UG90ZW50aWFsUHJvZml0KGFkZHJlc3Mgd2hvLCBzdHJpbmcgd29yZCkgcHVibGljIHZpZXcgcmV0dXJucwogICAgICAgICh1aW50MjU2IG1pbk5lZWRlZEJpZCwKICAgICAgICAgdWludDI1NiBleHBlY3RlZFByb2ZpdCkgewoKICAgICAgICB1aW50IGluZGV4ID0gaWRCeVdvcmRbd29yZF07CiAgICAgICAgcmVxdWlyZShpbmRleCA+IDApOwoKICAgICAgICB1aW50IGN1cnJlbnRCaWQgPSBnZXRUb3RhbEJpZCh3aG8sIGluZGV4KTsKICAgICAgICBhZGRyZXNzIGJlc3RCaWRkZXI7CiAgICAgICAgKGJlc3RCaWRkZXIsKSA9IGdldEJlc3RCaWRkZXIoaW5kZXgpOwogICAgICAgIGlmIChiZXN0QmlkZGVyICE9IHdobykgewogICAgICAgICAgICBtaW5OZWVkZWRCaWQgPSBnZXRNaW5BbGxvd2VkQmlkKGluZGV4KSAtIGN1cnJlbnRCaWQ7CiAgICAgICAgfQoKICAgICAgICB1aW50MjU2IGJhbmsgPSB0b3RhbEphY2twb3QgLyAyOwogICAgICAgIGJhbmsgKz0gdG90YWxCYW5rOwoKICAgICAgICB1aW50MjU2IGZlZSA9IHVpbnQyNTYoU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChiYW5rIC0gY3VycmVudEJpZCwgZmVlUGVyY2VudCksIDEwMCkpOwogICAgICAgIGJhbmsgLT0gZmVlOwoKICAgICAgICB1aW50MjU2IGphY2twb3RGaWxsID0gdWludDI1NihTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKGJhbmsgLSBjdXJyZW50QmlkLCBqYWNrcG90UGVyY2VudCksIDEwMCkpOwogICAgICAgIGJhbmsgLT0gamFja3BvdEZpbGw7CgogICAgICAgIGV4cGVjdGVkUHJvZml0ID0gYmFuazsKICAgIH0KCiAgICBmdW5jdGlvbiBiaWQoc3RyaW5nIHdvcmQpIHB1YmxpYyBwYXlhYmxlIG5vdFBhdXNlZCB7CiAgICAgICAgdWludCBpbmRleCA9IGlkQnlXb3JkW3dvcmRdOwogICAgICAgIHJlcXVpcmUoaW5kZXggPiAwKTsKICAgICAgICBhZGRCaWQobXNnLnNlbmRlciwgaW5kZXgsIG1zZy52YWx1ZSk7CiAgICB9CgogICAgLyogRkVFRCBUUlVNUCBUV0VFVCAqLwoKICAgIGZ1bmN0aW9uIGhhc1N1YnN0cmluZyhzdHJpbmcgaGF5c3RhY2ssIHN0cmluZyBuZWVkbGUpIHByaXZhdGUgcHVyZSByZXR1cm5zIChib29sKSB7CiAgICAgICAgdWludCBuZWVkbGVTaXplID0gYnl0ZXMobmVlZGxlKS5sZW5ndGg7CiAgICAgICAgYnl0ZXMzMiBoYXNoID0ga2VjY2FrMjU2KG5lZWRsZSk7CiAgICAgICAgZm9yKHVpbnQgaSA9IDA7IGkgPCBieXRlcyhoYXlzdGFjaykubGVuZ3RoIC0gbmVlZGxlU2l6ZTsgaSsrKSB7CiAgICAgICAgICAgIGJ5dGVzMzIgdGVzdEhhc2g7CiAgICAgICAgICAgIGFzc2VtYmx5IHsKICAgICAgICAgICAgICAgIHRlc3RIYXNoIDo9IHNoYTMoYWRkKGFkZChoYXlzdGFjaywgaSksIDMyKSwgbmVlZGxlU2l6ZSkKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoaGFzaCA9PSB0ZXN0SGFzaCkKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgZXZlbnQgUm91bmRGaW5pc2hlZCgpOwogICAgZXZlbnQgTm9CaWRzKCk7CiAgICBldmVudCBOb0JpbmdvV29yZHMoKTsKCiAgICBmdW5jdGlvbiBmZWVkVHdlZXQodWludCB0d2VldFRpbWUsIHVpbnQyNTYgdHdlZXRJZCwgc3RyaW5nIHR3ZWV0KSBwdWJsaWMgb25seUZlZWQgbm90UGF1c2VkIHsKICAgICAgICBwcmV2VHdlZXRUaW1lID0gdHdlZXRUaW1lOwogICAgICAgIGlmICh0b3RhbEJhbmsgPT0gMCkgewogICAgICAgICAgICBOb0JpZHMoKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgYm9vbFtdIG1lbW9yeSBoYXNXb24gPSBuZXcgYm9vbFtdKHdvcmRzLmxlbmd0aCk7CiAgICAgICAgYm9vbCBhbnlXb3JkUHJlc2VudCA9IGZhbHNlOwogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IHdvcmRzLmxlbmd0aDsgKytpKSB7CiAgICAgICAgICAgIGhhc1dvbltpXSA9ICghd29yZHNbaV0uZGlzYWJsZWQpICYmIGhhc1N1YnN0cmluZyh0d2VldCwgd29yZHNbaV0ud29yZCk7CiAgICAgICAgICAgIGlmIChoYXNXb25baV0pIHsKICAgICAgICAgICAgICAgIGFueVdvcmRQcmVzZW50ID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKCFhbnlXb3JkUHJlc2VudCkgewogICAgICAgICAgICBOb0JpbmdvV29yZHMoKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgcHJldlJvdW5kVHdlZXRJZCA9IHR3ZWV0SWQ7CiAgICAgICAgcHJldlJvdW5kV2lubmVyQ291bnQgPSAwOwogICAgICAgIGNhbGNQYXlvdXRzKGhhc1dvbik7CiAgICAgICAgUm91bmRGaW5pc2hlZCgpOwogICAgICAgIHN0YXJ0TmV3Um91bmQoKTsKICAgIH0KCiAgICAvKiBDT05TVFJVQ1RPUiAqLwoKICAgIGZ1bmN0aW9uIFRydW1wQmluZ28oKSBwdWJsaWMgewogICAgICAgIGNlb0FkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIGZlZUFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIGZlZWRBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICBmZWVDb293bmVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgY29vd25lclByaWNlID0gc3RhcnRpbmdDb293bmVyUHJpY2U7CgogICAgICAgIHBhdXNlZCA9IGZhbHNlOwogICAgICAgIHdvcmRzLnB1c2goV29yZCh7d29yZDogIiIsIGRpc2FibGVkOiB0cnVlfSkpOyAvLyBmYWtlICcwJyB3b3JkCiAgICAgICAgc3RhcnROZXdSb3VuZCgpOwogICAgfQoKCn0='.
	

]
