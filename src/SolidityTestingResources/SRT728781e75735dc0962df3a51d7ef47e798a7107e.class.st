Class {
	#name : #SRT728781e75735dc0962df3a51d7ef47e798a7107e,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT728781e75735dc0962df3a51d7ef47e798a7107e >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTY7CgovLyBTYWZlTWF0aCBUYWtlbiBGcm9tIEZpcnN0Qmxvb2QKY29udHJhY3QgU2FmZU1hdGggewogICAgZnVuY3Rpb24gc2FmZU11bCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgICAgIHVpbnQgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gc2FmZURpdih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgICAgIGFzc2VydChiID4gMCk7CiAgICAgICAgdWludCBjID0gYSAvIGI7CiAgICAgICAgYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gc2FmZVN1Yih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgICAgIGFzc2VydChiIDw9IGEpOwogICAgICAgIHJldHVybiBhIC0gYjsKICAgIH0KCiAgICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgdWludCBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGM+PWEgJiYgYz49Yik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9Cn0KCi8vIE93bmVyc2hpcApjb250cmFjdCBPd25lZCB7CgogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICBhZGRyZXNzIHB1YmxpYyBuZXdPd25lcjsKICAgIG1vZGlmaWVyIG9ubHlPd25lciB7IGFzc2VydChtc2cuc2VuZGVyID09IG93bmVyKTsgXzsgfQoKICAgIGV2ZW50IE93bmVyVXBkYXRlKGFkZHJlc3MgX3ByZXZPd25lciwgYWRkcmVzcyBfbmV3T3duZXIpOwoKICAgIGZ1bmN0aW9uIE93bmVkKCkgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIF9uZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShfbmV3T3duZXIgIT0gb3duZXIpOwogICAgICAgIG5ld093bmVyID0gX25ld093bmVyOwogICAgfQoKICAgIGZ1bmN0aW9uIGFjY2VwdE93bmVyc2hpcCgpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG5ld093bmVyKTsKICAgICAgICBPd25lclVwZGF0ZShvd25lciwgbmV3T3duZXIpOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICAgICAgbmV3T3duZXIgPSAweDA7CiAgICB9Cn0KCi8vIEVSQzIwIEludGVyZmFjZQpjb250cmFjdCBFUkMyMCB7CiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgX3RvdGFsU3VwcGx5KTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlbWFpbmluZyk7CiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQgX3ZhbHVlKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludCBfdmFsdWUpOwp9CgovLyBFUkMyMFRva2VuCmNvbnRyYWN0IEVSQzIwVG9rZW4gaXMgRVJDMjAsIFNhZmVNYXRoIHsKCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFRva2VuczsgCgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIF92YWx1ZSA+IDApIHsKICAgICAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBzYWZlU3ViKGJhbGFuY2VzW21zZy5zZW5kZXJdLCBfdmFsdWUpOwogICAgICAgICAgICBiYWxhbmNlc1tfdG9dID0gc2FmZUFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOwogICAgICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgdmFyIF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKICAgICAgICBpZiAoYmFsYW5jZXNbX2Zyb21dID49IF92YWx1ZSAmJiBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgewogICAgICAgICAgICBiYWxhbmNlc1tfdG9dID0gc2FmZUFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOwogICAgICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBzYWZlU3ViKGJhbGFuY2VzW19mcm9tXSwgX3ZhbHVlKTsKICAgICAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBzYWZlU3ViKF9hbGxvd2FuY2UsIF92YWx1ZSk7CiAgICAgICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHRvdGFsVG9rZW5zOwogICAgfQoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmVxdWlyZSgoX3ZhbHVlID09IDApIHx8IChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9PSAwKSk7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQp9Cgpjb250cmFjdCBXb2xrIGlzIEVSQzIwVG9rZW4sIE93bmVkIHsKCiAgICAvLyBUT0tFTiBJTkZPCiAgICBzdHJpbmcgIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIldvbGsgUHJvdG9jb2wgVG9rZW4iOwogICAgc3RyaW5nICBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIldPTEsiOwogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKCiAgICAvLyBSRVNFUlZFCiAgICB1aW50MjU2IHB1YmxpYyByZXNlcnZlQmFsYW5jZSA9IDA7IAogICAgdWludDggIHB1YmxpYyBjb25zdGFudCBwZXJjZW50YWdlRVRIUmVzZXJ2ZSA9IDE1OwoKICAgIC8vIENPTlRSQUNUIE9XTkVSCiAgICBhZGRyZXNzIHB1YmxpYyBtdWx0aXNpZ1dhbGxldDsKCgogICAgLy8gV09MSyBTRVRUTEVSUwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBzZXR0bGVyczsKICAgIG1vZGlmaWVyIG9ubHlTZXR0bGVyIHsgYXNzZXJ0KHNldHRsZXJzW21zZy5zZW5kZXJdID09IHRydWUpOyBfOyB9CgogICAgLy8gVE9LRU4gR0VORVJBVElPTiBDT05UUk9MCiAgICBhZGRyZXNzIHB1YmxpYyB3b2xrU2FsZTsKICAgIGJvb2wgICAgcHVibGljIGFsbFNhbGVDb21wbGV0ZWQgPSBmYWxzZTsKICAgIGJvb2wgICAgcHVibGljIG9wZW5TYWxlQ29tcGxldGVkID0gZmFsc2U7CiAgICBtb2RpZmllciBpc1RyYW5zZmVyYWJsZSB7IHJlcXVpcmUoYWxsU2FsZUNvbXBsZXRlZCk7IF87IH0KICAgIG1vZGlmaWVyIG9ubHlXb2xrIHsgYXNzZXJ0KG1zZy5zZW5kZXIgPT0gd29sa1NhbGUpOyBfOyB9CgogICAgLy8gVE9LRU4gR0VORVJBVElPTiBFVkVOVExPRwogICAgZXZlbnQgV29sa0NyZWF0ZWQoYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdG9rZW5DcmVhdGVkKTsKICAgIGV2ZW50IFdvbGtEZXN0cm95ZWQoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCB1aW50MjU2IF90b2tlbkRlc3Ryb3llZCk7CiAgICBldmVudCBMb2dSZWZ1bmQoYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwp9Cgpjb250cmFjdCBXb2xrVEdFIGlzIFdvbGsgewoKICAgIC8vIFRPS0VOIEdFTkVSQVRJT04gRVZFTlQKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgY29udHJpYnV0aW9uOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwcmVzYWxlTGltaXQ7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHByZXNhbGVDb250cmlidXRvcjsKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IHRva2VuR2VuZXJhdGlvbk1pbiA9IDUwICogMTAqKjYgKiAxMCoqZGVjaW1hbHM7CiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCB0b2tlbkdlbmVyYXRpb25NYXggPSAxNTAgKiAxMCoqNiAqIDEwKipkZWNpbWFsczsKICAgIHVpbnQyNTYgcHVibGljIHByZXNhbGVfc3RhcnRfYmxvY2s7IAogICAgdWludDI1NiBwdWJsaWMgc3RhcnRfYmxvY2s7CiAgICB1aW50MjU2IHB1YmxpYyBlbmRfYmxvY2s7CgogICAgLy8gQHBhcmFtIF9wcmVzYWxlU3RhcnRCbG9jawogICAgLy8gQHBhcmFtIF9zdGFydEJsb2NrCiAgICAvLyBAcGFyYW0gX2VuZEJsb2NrCiAgICAvLyBAcGFyYW0gX3dvbGtXYWxsZXQKICAgIC8vIEBwYXJhbSBfd29sa1NhbGUKICAgIC8vIEByZXR1cm4gc3VjY2VzcwogICAgLy8gQGRldiBXb2xrIEdlbmVzaXMgRXZlbnQgW29ubHkgYWNjZXNzaWJsZSBieSBDb250cmFjdCBPd25lcl0KICAgIGZ1bmN0aW9uIHdvbGtHZW5lc2lzKHVpbnQyNTYgX3ByZXNhbGVTdGFydEJsb2NrLCB1aW50MjU2IF9zdGFydEJsb2NrLCB1aW50MjU2IF9lbmRCbG9jaywgYWRkcmVzcyBfd29sa1dhbGxldCwgYWRkcmVzcyBfd29sa1NhbGUpIG9ubHlPd25lciByZXR1cm5zIChib29sIHN1Y2Nlc3MpewogICAgICAgIHJlcXVpcmUoKHRvdGFsVG9rZW5zIDwgMSkgJiYgKGJsb2NrLm51bWJlciA8PSBfc3RhcnRCbG9jaykgJiYgKF9lbmRCbG9jayA+IF9zdGFydEJsb2NrKSAmJiAoX3N0YXJ0QmxvY2sgPiBfcHJlc2FsZVN0YXJ0QmxvY2spKTsKICAgICAgICBwcmVzYWxlX3N0YXJ0X2Jsb2NrID0gX3ByZXNhbGVTdGFydEJsb2NrOwogICAgICAgIHN0YXJ0X2Jsb2NrID0gX3N0YXJ0QmxvY2s7CiAgICAgICAgZW5kX2Jsb2NrID0gX2VuZEJsb2NrOwogICAgICAgIG11bHRpc2lnV2FsbGV0ID0gX3dvbGtXYWxsZXQ7CiAgICAgICAgd29sa1NhbGUgPSBfd29sa1NhbGU7CiAgICAgICAgc2V0dGxlcnNbbXNnLnNlbmRlcl0gPSB0cnVlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vIEBwYXJhbSBfcHJlc2FsZVBhcnRpY2lwYW50cwogICAgLy8gQHJldHVybiBzdWNjZXNzCiAgICAvLyBAZGV2IEFkZHMgYWRkcmVzc2VzIHRoYXQgYXJlIGFsbG93ZWQgdG8gdGFrZSBwYXJ0IGluIHByZXNhbGUgW29ubHkgYWNjZXNzaWJsZSBieSBjdXJyZW50IENvbnRyYWN0IE93bmVyXQogICAgZnVuY3Rpb24gYWRkUGFydGljaXBhbnQoYWRkcmVzc1tdIF9wcmVzYWxlUGFydGljaXBhbnRzLCB1aW50MjU2W10gX2NvbnRyaWJ1dGlvbkxpbWl0cykgb25seU93bmVyIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoX3ByZXNhbGVQYXJ0aWNpcGFudHMubGVuZ3RoID09IF9jb250cmlidXRpb25MaW1pdHMubGVuZ3RoKTsgICAgICAgICAKICAgICAgICBmb3IgKHVpbnQgY250ID0gMDsgY250IDwgX3ByZXNhbGVQYXJ0aWNpcGFudHMubGVuZ3RoOyBjbnQrKyl7ICAgICAgICAgICAKICAgICAgICAgICAgcHJlc2FsZUNvbnRyaWJ1dG9yW19wcmVzYWxlUGFydGljaXBhbnRzW2NudF1dID0gdHJ1ZTsKICAgICAgICAgICAgcHJlc2FsZUxpbWl0W19wcmVzYWxlUGFydGljaXBhbnRzW2NudF1dID0gIHNhZmVNdWwoX2NvbnRyaWJ1dGlvbkxpbWl0c1tjbnRdLCAxMCoqZGVjaW1hbHMpOyAgICAgICAKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9IAoKICAgIC8vIEBwYXJhbSBfcHJlc2FsZVBhcnRpY2lwYW50cwogICAgLy8gQHJldHVybiBzdWNjZXNzCiAgICAvLyBAZGV2IFJldm9rZSBkZXNpZ25hdGVkIHByZXNhbGUgY29udHJpYnV0b3JzIFtvbmx5IGFjY2Vzc2libGUgYnkgY3VycmVudCBDb250cmFjdCBPd25lcl0KICAgIGZ1bmN0aW9uIHJlbW92ZVBhcnRpY2lwYW50KGFkZHJlc3NbXSBfcHJlc2FsZVBhcnRpY2lwYW50cykgb25seU93bmVyIHJldHVybnMgKGJvb2wgc3VjY2Vzcyl7ICAgICAgICAgCiAgICAgICAgZm9yICh1aW50IGNudCA9IDA7IGNudCA8IF9wcmVzYWxlUGFydGljaXBhbnRzLmxlbmd0aDsgY250KyspeyAgICAgICAgICAgCiAgICAgICAgICAgIHByZXNhbGVDb250cmlidXRvcltfcHJlc2FsZVBhcnRpY2lwYW50c1tjbnRdXSA9IGZhbHNlOwogICAgICAgICAgICBwcmVzYWxlTGltaXRbX3ByZXNhbGVQYXJ0aWNpcGFudHNbY250XV0gPSAwOyAgICAgIAogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBAcGFyYW0gX3BhcnRpY2lwYW50CiAgICAvLyBAcmV0dXJuIHJlbWFpbmluZ0FsbG9jYXRpb24KICAgIC8vIEBkZXYgcmV0dXJuIFByZXNhbGVMaW1pdCBhbGxvY2F0ZWQgdG8gZ2l2ZW4gYWRkcmVzcwogICAgZnVuY3Rpb24gcGFydGljaXBhbnRCYWxhbmNlKGFkZHJlc3MgX3BhcnRpY2lwYW50KSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZ0FsbG9jYXRpb24pIHsKICAgICAgICByZXR1cm4gcHJlc2FsZUxpbWl0W19wYXJ0aWNpcGFudF07CiAgICB9CiAgICAKCiAgICAvLyBAcGFyYW0gX3BhcnRpY2lwYW50CiAgICAvLyBAZGV2IHVzZSB0b2tlbkdlbmVyYXRpb25FdmVudCB0byBoYW5kbGUgUHJlLXNhbGUgYW5kIE9wZW4tc2FsZQogICAgZnVuY3Rpb24gdG9rZW5HZW5lcmF0aW9uRXZlbnQoYWRkcmVzcyBfcGFydGljaXBhbnQpIHBheWFibGUgZXh0ZXJuYWwgewogICAgICAgIHJlcXVpcmUoIHByZXNhbGVDb250cmlidXRvcltfcGFydGljaXBhbnRdICYmICFvcGVuU2FsZUNvbXBsZXRlZCAmJiAhYWxsU2FsZUNvbXBsZXRlZCAmJiAoYmxvY2subnVtYmVyIDw9IGVuZF9ibG9jaykgJiYgbXNnLnZhbHVlID4gMCk7CgogICAgICAgIC8qIEVhcmx5IFBhcnRpY2lwYXRpb24gRGlzY291bnQgKHJvdW5kZWQgdG8gdGhlIG5lYXJlc3QgaW50ZWdlcikKICAgICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICB8IFRva2VuIElzc3VlZCB8IFJhdGUgfCBEaXNjb3VudHwKICAgICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICB8ICAgMCAgLSAgNTBNTSB8IDExNzcgfCAgMTUuMCUgIHwKICAgICAgICB8IDUwTU0gLSAgNjBNTSB8IDExNDMgfCAgMTIuNSUgIHwKICAgICAgICB8IDYwTU0gLSAgNzBNTSB8IDExMTEgfCAgMTAuMCUgIHwKICAgICAgICB8IDcwTU0gLSAgODBNTSB8IDEwODEgfCAgIDcuNSUgIHwKICAgICAgICB8IDgwTU0gLSAgOTBNTSB8IDEwNTMgfCAgIDUuMCUgIHwgICAgICAgICAKICAgICAgICB8IDkwTU0gLSAxMDBNTSB8IDEwMjYgfCAgIDIuNSUgIHwKICAgICAgICB8ICAgIDEwME1NKyAgICB8IDEwMDAgfCAgIDAuMCUgIHwKICAgICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAqLwoKICAgICAgICB1aW50MjU2IHJhdGUgPSAxMDAwOyAgLy8gRGVmYXVsdCBSYXRlCgogICAgICAgIGlmICggdG90YWxUb2tlbnMgPCAoNTAgKiAxMCoqNiAqIDEwKipkZWNpbWFscykgKSB7ICAKICAgICAgICAgICAgcmF0ZSA9IDExNzc7CiAgICAgICAgfSBlbHNlIGlmICggdG90YWxUb2tlbnMgPCAoNjAgKiAxMCoqNiAqIDEwKipkZWNpbWFscykgKSB7ICAKICAgICAgICAgICAgcmF0ZSA9IDExNDM7CiAgICAgICAgfSBlbHNlIGlmICggdG90YWxUb2tlbnMgPCAoNzAgKiAxMCoqNiAqIDEwKipkZWNpbWFscykgKSB7ICAKICAgICAgICAgICAgcmF0ZSA9IDExMTE7CiAgICAgICAgfSBlbHNlIGlmICggdG90YWxUb2tlbnMgPCAoODAgKiAxMCoqNiAqIDEwKipkZWNpbWFscykgKSB7ICAKICAgICAgICAgICAgcmF0ZSA9IDEwODE7CiAgICAgICAgfSBlbHNlIGlmICggdG90YWxUb2tlbnMgPCAoOTAgKiAxMCoqNiAqIDEwKipkZWNpbWFscykgKSB7ICAKICAgICAgICAgICAgcmF0ZSA9IDEwNTM7CiAgICAgICAgfSBlbHNlIGlmICggdG90YWxUb2tlbnMgPCAoMTAwICogMTAqKjYgKiAxMCoqZGVjaW1hbHMpICkgeyAgCiAgICAgICAgICAgIHJhdGUgPSAxMDI2OwogICAgICAgIH1lbHNlewogICAgICAgICAgICByYXRlID0gMTAwMDsKICAgICAgICB9CgogICAgICAgIGlmICgoYmxvY2subnVtYmVyIDwgc3RhcnRfYmxvY2spICYmIChibG9jay5udW1iZXIgPj0gcHJlc2FsZV9zdGFydF9ibG9jaykpICB7IAogICAgICAgICAgICByZXF1aXJlKHByZXNhbGVMaW1pdFtfcGFydGljaXBhbnRdID49IG1zZy52YWx1ZSk7CiAgICAgICAgICAgIHByZXNhbGVMaW1pdFtfcGFydGljaXBhbnRdID0gc2FmZVN1YihwcmVzYWxlTGltaXRbX3BhcnRpY2lwYW50XSwgbXNnLnZhbHVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXF1aXJlKGJsb2NrLm51bWJlciA+PSBzdGFydF9ibG9jaykgOwogICAgICAgIH0KCiAgICAgICAgdWludDI1NiB0b2tlbnMgPSBzYWZlTXVsKG1zZy52YWx1ZSwgcmF0ZSk7CiAgICAgICAgdWludDI1NiBjaGVja2VkU3VwcGx5ID0gc2FmZUFkZCh0b3RhbFRva2VucywgdG9rZW5zKTsKICAgICAgICByZXF1aXJlKGNoZWNrZWRTdXBwbHkgPD0gdG9rZW5HZW5lcmF0aW9uTWF4KTsKCiAgICAgICAgdG90YWxUb2tlbnMgPSBjaGVja2VkU3VwcGx5OwogICAgICAgIFRyYW5zZmVyKGFkZHJlc3ModGhpcyksIF9wYXJ0aWNpcGFudCwgdG9rZW5zKTsKICAgICAgICBiYWxhbmNlc1tfcGFydGljaXBhbnRdID0gc2FmZUFkZChiYWxhbmNlc1tfcGFydGljaXBhbnRdLCB0b2tlbnMpOwogICAgICAgIGNvbnRyaWJ1dGlvbltfcGFydGljaXBhbnRdID0gc2FmZUFkZChjb250cmlidXRpb25bX3BhcnRpY2lwYW50XSwgbXNnLnZhbHVlKTsKICAgICAgICBXb2xrQ3JlYXRlZChfcGFydGljaXBhbnQsIHRva2Vucyk7IC8vIGxvZ3MgdG9rZW4gY3JlYXRpb24KICAgIH0KCgogICAgLy8gQGRldiBJZiBUb2tlbiBHZW5lcmF0aW9uIE1pbmltdW0gaXMgTm90IE1ldCwgVEdFIFBhcnRpY2lwYW50cyBjYW4gY2FsbCB0aGlzIGZ1bmMgYW5kIHJlcXVlc3QgZm9yIHJlZnVuZAogICAgZnVuY3Rpb24gcmVmdW5kKCkgZXh0ZXJuYWwgewogICAgICAgIHJlcXVpcmUoKGNvbnRyaWJ1dGlvblttc2cuc2VuZGVyXSA+IDApICYmICghYWxsU2FsZUNvbXBsZXRlZCkgJiYgKHRvdGFsVG9rZW5zIDwgdG9rZW5HZW5lcmF0aW9uTWluKSAmJiAoYmxvY2subnVtYmVyID4gZW5kX2Jsb2NrKSk7CiAgICAgICAgdWludDI1NiB0b2tlbkJhbGFuY2UgPSBiYWxhbmNlc1ttc2cuc2VuZGVyXTsKICAgICAgICB1aW50MjU2IHJlZnVuZEJhbGFuY2UgPSBjb250cmlidXRpb25bbXNnLnNlbmRlcl07CiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSAwOwogICAgICAgIGNvbnRyaWJ1dGlvblttc2cuc2VuZGVyXSA9IDA7CiAgICAgICAgdG90YWxUb2tlbnMgPSBzYWZlU3ViKHRvdGFsVG9rZW5zLCB0b2tlbkJhbGFuY2UpOwogICAgICAgIFdvbGtEZXN0cm95ZWQobXNnLnNlbmRlciwgdG9rZW5CYWxhbmNlKTsKICAgICAgICBMb2dSZWZ1bmQobXNnLnNlbmRlciwgcmVmdW5kQmFsYW5jZSk7CiAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihyZWZ1bmRCYWxhbmNlKTsgCiAgICB9CgogICAgLy8gQGRldiBGaW5hbGl6aW5nIHRoZSBPcGVuLVNhbGUgZm9yIFRva2VuIEdlbmVyYXRpb24gRXZlbnQuIDE1JSBvZiBFdGggd2lsbCBiZSBrZXB0IGluIGNvbnRyYWN0IHRvIHByb3ZpZGUgbGlxdWlkaXR5CiAgICBmdW5jdGlvbiBmaW5hbGl6ZU9wZW5TYWxlKCkgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKCghb3BlblNhbGVDb21wbGV0ZWQpICYmICh0b3RhbFRva2VucyA+PSB0b2tlbkdlbmVyYXRpb25NaW4pKTsKICAgICAgICBvcGVuU2FsZUNvbXBsZXRlZCA9IHRydWU7CiAgICAgICAgZW5kX2Jsb2NrID0gYmxvY2subnVtYmVyOwogICAgICAgIHJlc2VydmVCYWxhbmNlID0gc2FmZURpdihzYWZlTXVsKHRvdGFsVG9rZW5zLCBwZXJjZW50YWdlRVRIUmVzZXJ2ZSksIDEwMDAwMCk7CiAgICAgICAgdmFyIHdpdGhkcmF3YWxCYWxhbmNlID0gc2FmZVN1Yih0aGlzLmJhbGFuY2UsIHJlc2VydmVCYWxhbmNlKTsKICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHdpdGhkcmF3YWxCYWxhbmNlKTsKICAgIH0KCiAgICAvLyBAZGV2IEZpbmFsaXppbmcgdGhlIFByaXZhdGUtU2FsZS4gRW50aXJlIEV0aCB3aWxsIGJlIGtlcHQgaW4gY29udHJhY3QgdG8gcHJvdmlkZSBsaXF1aWRpdHkuIFRoaXMgZnVuYyB3aWxsIGNvbmNsdWRlIHRoZSBlbnRpcmUgc2FsZS4KICAgIGZ1bmN0aW9uIGZpbmFsaXplKCkgb25seVdvbGsgcGF5YWJsZSBleHRlcm5hbCB7CiAgICAgICAgcmVxdWlyZSgob3BlblNhbGVDb21wbGV0ZWQpICYmICghYWxsU2FsZUNvbXBsZXRlZCkpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICB1aW50MjU2IHByaXZhdGVTYWxlVG9rZW5zID0gIHNhZmVEaXYoc2FmZU11bChtc2cudmFsdWUsIDEwMDAwMCksIHBlcmNlbnRhZ2VFVEhSZXNlcnZlKTsKICAgICAgICB1aW50MjU2IGNoZWNrZWRTdXBwbHkgPSBzYWZlQWRkKHRvdGFsVG9rZW5zLCBwcml2YXRlU2FsZVRva2Vucyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgdG90YWxUb2tlbnMgPSBjaGVja2VkU3VwcGx5OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICByZXNlcnZlQmFsYW5jZSA9IHNhZmVBZGQocmVzZXJ2ZUJhbGFuY2UsIG1zZy52YWx1ZSk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIFRyYW5zZmVyKGFkZHJlc3ModGhpcyksIHdvbGtTYWxlLCBwcml2YXRlU2FsZVRva2Vucyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICBiYWxhbmNlc1t3b2xrU2FsZV0gPSBzYWZlQWRkKGJhbGFuY2VzW3dvbGtTYWxlXSwgcHJpdmF0ZVNhbGVUb2tlbnMpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgV29sa0NyZWF0ZWQod29sa1NhbGUsIHByaXZhdGVTYWxlVG9rZW5zKTsgLy8gbG9ncyB0b2tlbiBjcmVhdGlvbiBmb3IgUHJlc2FsZSBldmVudHMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgYWxsU2FsZUNvbXBsZXRlZCA9IHRydWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgIH0KfQoKY29udHJhY3QgSUJ1cm5Gb3JtdWxhIHsKICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZVdvbGtUb0J1cm4odWludDI1NiBfdmFsdWUpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKfQoKY29udHJhY3QgSUZlZUZvcm11bGEgewogICAgZnVuY3Rpb24gY2FsY3VsYXRlUHJvdmlkZXJGZWUodWludDI1NiBfdmFsdWUpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKfQoKY29udHJhY3QgV29sa1Byb3RvY29sIGlzIFdvbGsgewoKICAgIC8vIFdPTEsgTkVUV09SSyBQUk9UT0NPTAogICAgYWRkcmVzcyBwdWJsaWMgYnVybkZvcm11bGE7CiAgICBib29sICAgIHB1YmxpYyBzZXR0bGVtZW50SXNSdW5uaW5nID0gdHJ1ZTsKICAgIHVpbnQyNTYgcHVibGljIGJ1cm5CYXNpc1BvaW50cyA9IDUwMDsgIC8vIEJ1cm4gcmF0ZSAoaW4gQlApIHdoZW4gU2VydmljZSBQcm92aWRlciB3aXRoZHJhd3MgZnJvbSBkYXRhIGJ1eWVycycgYWNjb3VudHMKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSkgYXV0aG9yaXplZDsgLy8gaG9sZHMgd2hpY2ggYWNjb3VudHMgaGF2ZSBhcHByb3ZlZCB3aGljaCBTZXJ2aWNlIFByb3ZpZGVycwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBmZWVCYXNpc1BvaW50czsgICAvLyBGZWUgKGluIEJQKSBlYXJuZWQgYnkgU2VydmljZSBQcm92aWRlciB3aGVuIGRlcG9zaXRpbmcgdG8gZGF0YSBzZWxsZXIKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYWRkcmVzcykgZmVlRm9ybXVsYXM7ICAgICAgLy8gUHJvdmlkZXIncyBjdXN0b21pemFibGUgRmVlIG1vcm11bGEKICAgIG1vZGlmaWVyIGlzU2V0dGxlYWJsZSB7IHJlcXVpcmUoc2V0dGxlbWVudElzUnVubmluZyk7IF87IH0KCgogICAgLy8gV09MSyBQUk9UT0NPTCBFdmVudHM6CiAgICBldmVudCBBdXRob3JpemVTZXJ2aWNlUHJvdmlkZXIoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBfc2VydmljZVByb3ZpZGVyKTsKICAgIGV2ZW50IERlYXV0aG9yaXplU2VydmljZVByb3ZpZGVyKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgX3NlcnZpY2VQcm92aWRlcik7CiAgICBldmVudCBTZXRTZXJ2aWNlUHJvdmlkZXJGZWUoYWRkcmVzcyBpbmRleGVkIF9zZXJ2aWNlUHJvdmlkZXIsIHVpbnQyNTYgX2ZlZUJhc2lzUG9pbnRzKTsKICAgIGV2ZW50IEJ1cm5Ub2tlbnMoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3NlcnZpY2VQcm92aWRlciwgdWludDI1NiBfdmFsdWUpOwoKICAgIC8vIEBwYXJhbSAgX2J1cm5CYXNpc1BvaW50cwogICAgLy8gQHJldHVybiBzdWNjZXNzCiAgICAvLyBAZGV2IFNldCBCdXJuUmF0ZSBvbiBXb2xrIFByb3RvY29sIC0tIG9ubHkgV29sayBjYW4gc2V0IHRoaXMsIGFmZmVjdHMgU2VydmljZSBQcm92aWRlciBzZXR0bGVCdXllcgogICAgZnVuY3Rpb24gc2V0QnVyblJhdGUodWludDI1NiBfYnVybkJhc2lzUG9pbnRzKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmVxdWlyZSgoX2J1cm5CYXNpc1BvaW50cyA+IDApICYmIChfYnVybkJhc2lzUG9pbnRzIDw9IDEwMDApKTsKICAgICAgICBidXJuQmFzaXNQb2ludHMgPSBfYnVybkJhc2lzUG9pbnRzOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgCiAgICAvLyBAcGFyYW0gIF9uZXdCdXJuRm9ybXVsYQogICAgLy8gQHJldHVybiBzdWNjZXNzCiAgICAvLyBAZGV2IFNldCB0aGUgZm9ybXVsYSB0byB1c2UgZm9yIGJ1cm5pbmcgLS0gb25seSBXb2xrICBjYW4gc2V0IHRoaXMKICAgIGZ1bmN0aW9uIHNldEJ1cm5Gb3JtdWxhKGFkZHJlc3MgX25ld0J1cm5Gb3JtdWxhKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBzdWNjZXNzKXsKICAgICAgICB1aW50MjU2IHRlc3RCdXJuaW5nID0gZXN0V29sa1RvQnVybihfbmV3QnVybkZvcm11bGEsIDEwICoqIDE4KTsKICAgICAgICByZXF1aXJlKHRlc3RCdXJuaW5nID4gKDUgKiAxMCAqKiAxMykpOwogICAgICAgIGJ1cm5Gb3JtdWxhID0gX25ld0J1cm5Gb3JtdWxhOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgCiAgICAvLyBAcGFyYW0gIF9uZXdGZWVGb3JtdWxhCiAgICAvLyBAcmV0dXJuIHN1Y2Nlc3MKICAgIC8vIEBkZXYgU2V0IHRoZSBmb3JtdWxhIHRvIHVzZSBmb3Igc2V0dGxlbWVudCAtLSBzZXR0bGVyIGNhbiBjdXN0b21pemUgaXRzIGZlZSAgCiAgICBmdW5jdGlvbiBzZXRGZWVGb3JtdWxhKGFkZHJlc3MgX25ld0ZlZUZvcm11bGEpIG9ubHlTZXR0bGVyIHJldHVybnMgKGJvb2wgc3VjY2Vzcyl7CiAgICAgICAgdWludDI1NiB0ZXN0U2V0dGxpbmcgPSBlc3RQcm92aWRlckZlZShfbmV3RmVlRm9ybXVsYSwgMTAgKiogMTgpOwogICAgICAgIHJlcXVpcmUodGVzdFNldHRsaW5nID4gKDUgKiAxMCAqKiAxMykpOwogICAgICAgIGZlZUZvcm11bGFzW21zZy5zZW5kZXJdID0gX25ld0ZlZUZvcm11bGE7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIC8vIEBwYXJhbSAgX2lzUnVubmluZwogICAgLy8gQHJldHVybiBzdWNjZXNzCiAgICAvLyBAZGV2IHVwYXRpbmcgc2V0dGxlbWVudCBzdGF0dXMgLS0gb25seSBXb2xrIGNhbiBzZXQgdGhpcwogICAgZnVuY3Rpb24gdXBkYXRlU2V0dGxlbWVudFN0YXR1cyhib29sIF9pc1J1bm5pbmcpIG9ubHlPd25lciByZXR1cm5zIChib29sIHN1Y2Nlc3MpewogICAgICAgIHNldHRsZW1lbnRJc1J1bm5pbmcgPSBfaXNSdW5uaW5nOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgCiAgICAvLyBAcGFyYW0gIF9zZXJ2aWNlUHJvdmlkZXIKICAgIC8vIEBwYXJhbSAgX2ZlZUJhc2lzUG9pbnRzCiAgICAvLyBAcmV0dXJuIHN1Y2Nlc3MKICAgIC8vIEBkZXYgU2V0IFNlcnZpY2UgUHJvdmlkZXIgZmVlIC0tIG9ubHkgQ29udHJhY3QgT3duZXIgY2FuIGRvIHRoaXMsIGFmZmVjdHMgU2VydmljZSBQcm92aWRlciBzZXR0bGVTZWxsZXIKICAgIGZ1bmN0aW9uIHNldFNlcnZpY2VGZWUoYWRkcmVzcyBfc2VydmljZVByb3ZpZGVyLCB1aW50MjU2IF9mZWVCYXNpc1BvaW50cykgb25seU93bmVyIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGlmIChfZmVlQmFzaXNQb2ludHMgPD0gMCB8fCBfZmVlQmFzaXNQb2ludHMgPiA0MDAwKXsKICAgICAgICAgICAgLy8gcmV2b2tlIFNldHRsZXIgcHJpdmlsZWdlCiAgICAgICAgICAgIHNldHRsZXJzW19zZXJ2aWNlUHJvdmlkZXJdID0gZmFsc2U7CiAgICAgICAgICAgIGZlZUJhc2lzUG9pbnRzW19zZXJ2aWNlUHJvdmlkZXJdID0gMDsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH1lbHNlewogICAgICAgICAgICBmZWVCYXNpc1BvaW50c1tfc2VydmljZVByb3ZpZGVyXSA9IF9mZWVCYXNpc1BvaW50czsKICAgICAgICAgICAgc2V0dGxlcnNbX3NlcnZpY2VQcm92aWRlcl0gPSB0cnVlOwogICAgICAgICAgICBTZXRTZXJ2aWNlUHJvdmlkZXJGZWUoX3NlcnZpY2VQcm92aWRlciwgX2ZlZUJhc2lzUG9pbnRzKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgfQoKICAgIC8vIEBwYXJhbSAgX3NlcnZpY2VQcm92aWRlcgogICAgLy8gQHJldHVybiBfZmVlQmFzaXNQb2ludHMKICAgIC8vIEBkZXYgQ2hlY2sgc2VydmljZSBGZWUgKGluIEJQKSBmb3IgYSBnaXZlbiBwcm92aWRlcgogICAgZnVuY3Rpb24gY2hlY2tTZXJ2aWNlRmVlKGFkZHJlc3MgX3NlcnZpY2VQcm92aWRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBfZmVlQmFzaXNQb2ludHMpIHsKICAgICAgICByZXR1cm4gZmVlQmFzaXNQb2ludHNbX3NlcnZpY2VQcm92aWRlcl07CiAgICB9CgogICAgLy8gQHBhcmFtIF9zZXJ2aWNlUHJvdmlkZXIKICAgIC8vIEByZXR1cm4gX2Zvcm11bGFBZGRyZXNzCiAgICAvLyBAZGV2IFJldHVybnMgdGhlIGNvbnRyYWN0IGFkZHJlc3Mgb2YgdGhlIFNlcnZpY2UgUHJvdmlkZXIncyBmZWUgZm9ybXVsYQogICAgZnVuY3Rpb24gY2hlY2tGZWVTY2hlZHVsZShhZGRyZXNzIF9zZXJ2aWNlUHJvdmlkZXIpIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MgX2Zvcm11bGFBZGRyZXNzKSB7CiAgICAgICAgcmV0dXJuIGZlZUZvcm11bGFzW19zZXJ2aWNlUHJvdmlkZXJdOwogICAgfQogICAgCiAgICAvLyBAcGFyYW0gX3ZhbHVlCiAgICAvLyBAcmV0dXJuIHdvbGtCdXJudAogICAgLy8gQGRldiBSZXR1cm5zIGVzdGltYXRlIG9mIFdvbGsgdG8gYnVybiAKICAgIGZ1bmN0aW9uIGVzdFdvbGtUb0J1cm4oYWRkcmVzcyBfYnVybkZvcm11bGEsIHVpbnQyNTYgX3ZhbHVlKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KXsKICAgICAgICBpZihfYnVybkZvcm11bGEgIT0gMHgwKXsKICAgICAgICAgICAgdWludDI1NiB3b2xrQnVybnQgPSBJQnVybkZvcm11bGEoX2J1cm5Gb3JtdWxhKS5jYWxjdWxhdGVXb2xrVG9CdXJuKF92YWx1ZSk7CiAgICAgICAgICAgIHJldHVybiB3b2xrQnVybnQ7ICAgIAogICAgICAgIH1lbHNlewogICAgICAgICAgICByZXR1cm4gMDsgCiAgICAgICAgfQogICAgfQogICAgCiAgICAvLyBAcGFyYW0gX3ZhbHVlCiAgICAvLyBAcGFyYW0gX3NlcnZpY2VQcm92aWRlcgogICAgLy8gQHJldHVybiBlc3RGZWUKICAgIC8vIEBkZXYgUmV0dXJucyBlc3RpbWF0ZSBvZiBTZXJ2aWNlIFByb3ZpZGVyJ3MgZmVlIAogICAgZnVuY3Rpb24gZXN0UHJvdmlkZXJGZWUoYWRkcmVzcyBfc2VydmljZVByb3ZpZGVyLCB1aW50MjU2IF92YWx1ZSkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludDI1Nil7CiAgICAgICAgYWRkcmVzcyBQcm92aWRlckZlZUZvcm11bGEgPSBmZWVGb3JtdWxhc1tfc2VydmljZVByb3ZpZGVyXTsKICAgICAgICBpZiAoUHJvdmlkZXJGZWVGb3JtdWxhICE9IDB4MCl7CiAgICAgICAgICAgIHVpbnQyNTYgZXN0RmVlID0gSUZlZUZvcm11bGEoUHJvdmlkZXJGZWVGb3JtdWxhKS5jYWxjdWxhdGVQcm92aWRlckZlZShfdmFsdWUpOwogICAgICAgICAgICByZXR1cm4gZXN0RmVlOyAgICAgIAogICAgICAgIH1lbHNlewogICAgICAgICAgICByZXR1cm4gMDsgIAogICAgICAgIH0KICAgIH0KICAgIAogICAgLy8gQHBhcmFtICBfYnV5ZXIKICAgIC8vIEBwYXJhbSAgX3ZhbHVlCiAgICAvLyBAcmV0dXJuIHN1Y2Nlc3MKICAgIC8vIEBkZXYgU2VydmljZSBQcm92aWRlciBTZXR0bGVtZW50IHdpdGggQnV5ZXI6IGEgc21hbGwgcGVyY2VudCBpcyBidXJudCAoc2V0IGluIHNldEJ1cm5SYXRlLCBzdG9yZWQgaW4gYnVybkJhc2lzUG9pbnRzKSB3aGVuIGZ1bmRzIGFyZSB0cmFuc2ZlcnJlZCBmcm9tIGJ1eWVyIHRvIFNlcnZpY2UgUHJvdmlkZXIgW29ubHkgYWNjZXNzaWJsZSBieSBzZXR0bGVyc10KICAgIGZ1bmN0aW9uIHNldHRsZUJ1eWVyKGFkZHJlc3MgX2J1eWVyLCB1aW50MjU2IF92YWx1ZSkgb25seVNldHRsZXIgaXNTZXR0bGVhYmxlIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoKGJ1cm5CYXNpc1BvaW50cyA+IDApICYmIChidXJuQmFzaXNQb2ludHMgPD0gMTAwMCkgJiYgYXV0aG9yaXplZFtfYnV5ZXJdW21zZy5zZW5kZXJdKTsgLy8gQnV5ZXIgbXVzdCBhdXRob3JpemUgU2VydmljZSBQcm92aWRlciAKICAgICAgICByZXF1aXJlKGJhbGFuY2VzW19idXllcl0gPj0gX3ZhbHVlICYmIF92YWx1ZSA+IDApOwogICAgICAgIHZhciBXb2xrVG9CdXJuID0gZXN0V29sa1RvQnVybihidXJuRm9ybXVsYSwgX3ZhbHVlKTsKICAgICAgICB2YXIgYnVybkNhcCA9IHNhZmVEaXYoc2FmZU11bChfdmFsdWUsIGJ1cm5CYXNpc1BvaW50cyksIDEwMDAwKTsgLy9jYW4gbm90IGJ1cm4gbW9yZSB0aGFuIHRoaXMKCiAgICAgICAgLy8gSWYgYnVybiBmb3JtdWxhIG5vdCBmb3VuZCwgdXNlIGRlZmF1bHQgYnVybiByYXRlLiBJZiBFc3QgdG8gYnVybiBleGNlZWRzIEJ1cm5DYXAsIGN1dCBiYWNrIHRvIHRoZSBjYXAKICAgICAgICBpZiAoV29sa1RvQnVybiA8IDEpIFdvbGtUb0J1cm4gPSBidXJuQ2FwOwogICAgICAgIGlmIChXb2xrVG9CdXJuID4gYnVybkNhcCkgV29sa1RvQnVybiA9IGJ1cm5DYXA7CiAgICAgICAgICAgIAogICAgICAgIHZhciB0cmFuc2ZlcnJlZFRvU2VydmljZVByb3ZpZGVyID0gc2FmZVN1YihfdmFsdWUsIFdvbGtUb0J1cm4pOwogICAgICAgIGJhbGFuY2VzW19idXllcl0gPSBzYWZlU3ViKGJhbGFuY2VzW19idXllcl0sIF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBzYWZlQWRkKGJhbGFuY2VzW21zZy5zZW5kZXJdLCB0cmFuc2ZlcnJlZFRvU2VydmljZVByb3ZpZGVyKTsKICAgICAgICB0b3RhbFRva2VucyA9IHNhZmVTdWIodG90YWxUb2tlbnMsIFdvbGtUb0J1cm4pOwogICAgICAgIFRyYW5zZmVyKF9idXllciwgbXNnLnNlbmRlciwgdHJhbnNmZXJyZWRUb1NlcnZpY2VQcm92aWRlcik7CiAgICAgICAgVHJhbnNmZXIoX2J1eWVyLCAweDAwMDAwMDAwMDAwMDAwMDAwMDAwLCBXb2xrVG9CdXJuKTsKICAgICAgICBCdXJuVG9rZW5zKF9idXllciwgbXNnLnNlbmRlciwgV29sa1RvQnVybik7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9IAoKICAgIC8vIEBwYXJhbSAgX3NlbGxlcgogICAgLy8gQHBhcmFtICBfdmFsdWUKICAgIC8vIEByZXR1cm4gc3VjY2VzcwogICAgLy8gQGRldiBTZXJ2aWNlIFByb3ZpZGVyIFNldHRsZW1lbnQgd2l0aCBTZWxsZXI6IGEgc21hbGwgcGVyY2VudCBpcyBrZXB0IGJ5IFNlcnZpY2UgUHJvdmlkZXIgKHNldCBpbiBzZXRTZXJ2aWNlRmVlLCBzdG9yZWQgaW4gZmVlQmFzaXNQb2ludHMpIHdoZW4gZnVuZHMgYXJlIHRyYW5zZmVycmVkIGZyb20gU2VydmljZSBQcm92aWRlciB0byBzZWxsZXIgW29ubHkgYWNjZXNzaWJsZSBieSBzZXR0bGVyc10KICAgIGZ1bmN0aW9uIHNldHRsZVNlbGxlcihhZGRyZXNzIF9zZWxsZXIsIHVpbnQyNTYgX3ZhbHVlKSBvbmx5U2V0dGxlciBpc1NldHRsZWFibGUgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgLy8gU2VydmljZSBQcm92aWRlcnMgaGF2ZSBhICUgbWF4IGZlZSAoZS5nLiAyMCUpCiAgICAgICAgdmFyIHNlcnZpY2VQcm92aWRlckJQID0gZmVlQmFzaXNQb2ludHNbbXNnLnNlbmRlcl07CiAgICAgICAgcmVxdWlyZSgoc2VydmljZVByb3ZpZGVyQlAgPiAwKSAmJiAoc2VydmljZVByb3ZpZGVyQlAgPD0gNDAwMCkgJiYgKF92YWx1ZSA+IDApKTsKICAgICAgICB2YXIgc2V2aWNlRmVlID0gZXN0UHJvdmlkZXJGZWUobXNnLnNlbmRlciwgX3ZhbHVlKTsKICAgICAgICB2YXIgTWF4aW11bWZlZSA9IHNhZmVEaXYoc2FmZU11bChfdmFsdWUsIHNlcnZpY2VQcm92aWRlckJQKSwgMTAwMDApOwogICAgICAgIAogICAgICAgIC8vIElmIHByb3ZpZGVyJ3MgZmVlIGZvcm11bGEgbm90IHNldCwgdXNlIGRlZmF1bHQgYnVybiByYXRlLiBJZiBFc3QgZmVlIGV4Y2VlZHMgTWF4aW11bWZlZSwgY3V0IGJhY2sgdG8gdGhlIGZlZQogICAgICAgIGlmIChzZXZpY2VGZWUgPCAxKSBzZXZpY2VGZWUgPSBNYXhpbXVtZmVlOyAgCiAgICAgICAgaWYgKHNldmljZUZlZSA+IE1heGltdW1mZWUpIHNldmljZUZlZSA9IE1heGltdW1mZWU7CiAgICAgICAgdmFyIHRyYW5zZmVycmVkVG9TZWxsZXIgPSBzYWZlU3ViKF92YWx1ZSwgc2V2aWNlRmVlKTsKICAgICAgICByZXF1aXJlKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IHRyYW5zZmVycmVkVG9TZWxsZXIgKTsKICAgICAgICBiYWxhbmNlc1tfc2VsbGVyXSA9IHNhZmVBZGQoYmFsYW5jZXNbX3NlbGxlcl0sIHRyYW5zZmVycmVkVG9TZWxsZXIpOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF9zZWxsZXIsIHRyYW5zZmVycmVkVG9TZWxsZXIpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vIEBwYXJhbSBfcHJvdmlkZXJUb0FkZAogICAgLy8gQHJldHVybiBzdWNjZXNzCiAgICAvLyBAZGV2IEJ1eWVyIGF1dGhvcml6ZXMgdGhlIFNlcnZpY2UgUHJvdmlkZXIgKHRvIGNhbGwgc2V0dGxlQnV5ZXIpLiBGb3Igc2VjdXJpdHkgcmVhc29uLCBfcHJvdmlkZXJUb0FkZCBuZWVkcyB0byBiZSB3aGl0ZWxpc3RlZCBieSBXb2xrIEluYyBmaXJzdAogICAgZnVuY3Rpb24gYXV0aG9yaXplUHJvdmlkZXIoYWRkcmVzcyBfcHJvdmlkZXJUb0FkZCkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmVxdWlyZShzZXR0bGVyc1tfcHJvdmlkZXJUb0FkZF0pOwogICAgICAgIGF1dGhvcml6ZWRbbXNnLnNlbmRlcl1bX3Byb3ZpZGVyVG9BZGRdID0gdHJ1ZTsKICAgICAgICBBdXRob3JpemVTZXJ2aWNlUHJvdmlkZXIobXNnLnNlbmRlciwgX3Byb3ZpZGVyVG9BZGQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vIEBwYXJhbSBfcHJvdmlkZXJUb1JlbW92ZQogICAgLy8gQHJldHVybiBzdWNjZXNzCiAgICAvLyBAZGV2IEJ1eWVyIGRlYXV0aG9yaXplcyB0aGUgU2VydmljZSBQcm92aWRlciAoZnJvbSBjYWxsaW5nIHNldHRsZUJ1eWVyKQogICAgZnVuY3Rpb24gZGVhdXRob3JpemVQcm92aWRlcihhZGRyZXNzIF9wcm92aWRlclRvUmVtb3ZlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBhdXRob3JpemVkW21zZy5zZW5kZXJdW19wcm92aWRlclRvUmVtb3ZlXSA9IGZhbHNlOwogICAgICAgIERlYXV0aG9yaXplU2VydmljZVByb3ZpZGVyKG1zZy5zZW5kZXIsIF9wcm92aWRlclRvUmVtb3ZlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBAcGFyYW0gX293bmVyCiAgICAvLyBAcGFyYW0gX3NlcnZpY2VQcm92aWRlcgogICAgLy8gQHJldHVybiBhdXRob3JpemF0aW9uU3RhdHVzCiAgICAvLyBAZGV2IENoZWNrIGF1dGhvcml6YXRpb24gYmV0d2VlbiBhY2NvdW50IGFuZCBTZXJ2aWNlIFByb3ZpZGVyCiAgICBmdW5jdGlvbiBjaGVja0F1dGhvcml6YXRpb24oYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NlcnZpY2VQcm92aWRlcikgY29uc3RhbnQgcmV0dXJucyAoYm9vbCBhdXRob3JpemF0aW9uU3RhdHVzKSB7CiAgICAgICAgcmV0dXJuIGF1dGhvcml6ZWRbX293bmVyXVtfc2VydmljZVByb3ZpZGVyXTsKICAgIH0KCiAgICAvLyBAcGFyYW0gX293bmVyCiAgICAvLyBAcGFyYW0gX3Byb3ZpZGVyVG9BZGQKICAgIC8vIEByZXR1cm4gYXV0aG9yaXphdGlvblN0YXR1cwogICAgLy8gQGRldiBHcmFudCBhdXRob3JpemF0aW9uIGJldHdlZW4gYWNjb3VudCBhbmQgU2VydmljZSBQcm92aWRlciBvbiBidXllcnMnIGJlaGFsZiBbb25seSBhY2Nlc3NpYmxlIGJ5IENvbnRyYWN0IE93bmVyXQogICAgLy8gQG5vdGUgRXhwbGljaXQgcGVybWlzc2lvbiBmcm9tIGJhbGFuY2Ugb3duZXIgTVVTVCBiZSBvYnRhaW5lZCBiZWZvcmVoYW5kCiAgICBmdW5jdGlvbiBncmFudFNlcnZpY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3Byb3ZpZGVyVG9BZGQpIG9ubHlPd25lciByZXR1cm5zIChib29sIGF1dGhvcml6YXRpb25TdGF0dXMpIHsKICAgICAgICB2YXIgaXNQcmVhdXRob3JpemVkID0gYXV0aG9yaXplZFtfb3duZXJdW21zZy5zZW5kZXJdOwogICAgICAgIGlmIChpc1ByZWF1dGhvcml6ZWQgJiYgc2V0dGxlcnNbX3Byb3ZpZGVyVG9BZGRdKSB7CiAgICAgICAgICAgIGF1dGhvcml6ZWRbX293bmVyXVtfcHJvdmlkZXJUb0FkZF0gPSB0cnVlOwogICAgICAgICAgICBBdXRob3JpemVTZXJ2aWNlUHJvdmlkZXIobXNnLnNlbmRlciwgX3Byb3ZpZGVyVG9BZGQpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBAcGFyYW0gX293bmVyCiAgICAvLyBAcGFyYW0gX3Byb3ZpZGVyVG9SZW1vdmUKICAgIC8vIEByZXR1cm4gYXV0aG9yaXphdGlvbl9zdGF0dXMKICAgIC8vIEBkZXYgUmV2b2tlIGF1dGhvcml6YXRpb24gYmV0d2VlbiBhY2NvdW50IGFuZCBTZXJ2aWNlIFByb3ZpZGVyIG9uIGJ1eWVycycgYmVoYWxmIFtvbmx5IGFjY2Vzc2libGUgYnkgQ29udHJhY3QgT3duZXJdCiAgICAvLyBAbm90ZSBFeHBsaWNpdCBwZXJtaXNzaW9uIGZyb20gYmFsYW5jZSBvd25lciBhcmUgTk9UIHJlcXVpcmVkIGZvciBkaXNhYmxpbmcgaWxsLWludGVudCBTZXJ2aWNlIFByb3ZpZGVyCiAgICBmdW5jdGlvbiByZW1vdmVTZXJ2aWNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9wcm92aWRlclRvUmVtb3ZlKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBhdXRob3JpemF0aW9uU3RhdHVzKSB7CiAgICAgICAgYXV0aG9yaXplZFtfb3duZXJdW19wcm92aWRlclRvUmVtb3ZlXSA9IGZhbHNlOwogICAgICAgIERlYXV0aG9yaXplU2VydmljZVByb3ZpZGVyKF9vd25lciwgX3Byb3ZpZGVyVG9SZW1vdmUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9CgovLyBUYWtlbiBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9iYW5jb3Jwcm90b2NvbC9jb250cmFjdHMvYmxvYi9tYXN0ZXIvc29saWRpdHkvY29udHJhY3RzL0JhbmNvckZvcm11bGEuc29sCmNvbnRyYWN0IElCYW5jb3JGb3JtdWxhIHsKICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZVB1cmNoYXNlUmV0dXJuKHVpbnQyNTYgX3N1cHBseSwgdWludDI1NiBfcmVzZXJ2ZUJhbGFuY2UsIHVpbnQ4IF9yZXNlcnZlUmF0aW8sIHVpbnQyNTYgX2RlcG9zaXRBbW91bnQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZVNhbGVSZXR1cm4odWludDI1NiBfc3VwcGx5LCB1aW50MjU2IF9yZXNlcnZlQmFsYW5jZSwgdWludDggX3Jlc2VydmVSYXRpbywgdWludDI1NiBfc2VsbEFtb3VudCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwp9Cgpjb250cmFjdCBXb2xrRXhjaGFuZ2UgaXMgV29sa1Byb3RvY29sLCBXb2xrVEdFIHsKCiAgICB1aW50MjU2IHB1YmxpYyBtYXhQZXJFeGNoYW5nZUJQID0gNTA7CiAgICBhZGRyZXNzIHB1YmxpYyBleGNoYW5nZUZvcm11bGE7CiAgICBib29sICAgIHB1YmxpYyBleGNoYW5nZUlzUnVubmluZyA9IGZhbHNlOwogICAgbW9kaWZpZXIgaXNFeGNoYW5nYWJsZSB7IHJlcXVpcmUoZXhjaGFuZ2VJc1J1bm5pbmcgJiYgYWxsU2FsZUNvbXBsZXRlZCk7IF87IH0KICAgIAogICAgLy8gQHBhcmFtICBfbmV3RXhjaGFuZ2Vmb3JtdWxhCiAgICAvLyBAcmV0dXJuIHN1Y2Nlc3MKICAgIC8vIEBkZXYgU2V0IHRoZSBiYW5jb3IgZm9ybXVsYSB0byB1c2UgLS0gb25seSBXb2xrIEluYyBjYW4gc2V0IHRoaXMKICAgIGZ1bmN0aW9uIHNldEV4Y2hhbmdlRm9ybXVsYShhZGRyZXNzIF9uZXdFeGNoYW5nZWZvcm11bGEpIG9ubHlPd25lciByZXR1cm5zIChib29sIHN1Y2Nlc3MpewogICAgICAgIHJlcXVpcmUoc2VsbFdvbGtFc3RpbWF0ZSgxMCoqZGVjaW1hbHMsIF9uZXdFeGNoYW5nZWZvcm11bGEpID4gMCk7CiAgICAgICAgcmVxdWlyZShwdXJjaGFzZVdvbGtFc3RpbWF0ZSgxMCoqZGVjaW1hbHMsIF9uZXdFeGNoYW5nZWZvcm11bGEpID4gMCk7CiAgICAgICAgZXhjaGFuZ2VJc1J1bm5pbmcgPSBmYWxzZTsKICAgICAgICBleGNoYW5nZUZvcm11bGEgPSBfbmV3RXhjaGFuZ2Vmb3JtdWxhOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgCiAgICAvLyBAcGFyYW0gIF9pc1J1bm5pbmcKICAgIC8vIEByZXR1cm4gc3VjY2VzcwogICAgLy8gQGRldiB1cGF0aW5nIGV4Y2hhbmdlIHN0YXR1cyAtLSBvbmx5IFdvbGsgSW5jIGNhbiBzZXQgdGhpcwogICAgZnVuY3Rpb24gdXBkYXRlRXhjaGFuZ2VTdGF0dXMoYm9vbCBfaXNSdW5uaW5nKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBzdWNjZXNzKXsKICAgICAgICBpZiAoX2lzUnVubmluZyl7CiAgICAgICAgICAgIHJlcXVpcmUoc2VsbFdvbGtFc3RpbWF0ZSgxMCoqZGVjaW1hbHMsIGV4Y2hhbmdlRm9ybXVsYSkgPiAwKTsKICAgICAgICAgICAgcmVxdWlyZShwdXJjaGFzZVdvbGtFc3RpbWF0ZSgxMCoqZGVjaW1hbHMsIGV4Y2hhbmdlRm9ybXVsYSkgPiAwKTsgICAKICAgICAgICB9CiAgICAgICAgZXhjaGFuZ2VJc1J1bm5pbmcgPSBfaXNSdW5uaW5nOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgCiAgICAvLyBAcGFyYW0gIF9tYXhQZXJFeGNoYW5nZQogICAgLy8gQHJldHVybiBzdWNjZXNzCiAgICAvLyBAZGV2IFNldCBtYXggc2VsbCB0b2tlbiBhbW91bnQgcGVyIHRyYW5zYWN0aW9uIC0tIG9ubHkgV29sayBJbmMgY2FuIHNldCB0aGlzCiAgICBmdW5jdGlvbiBzZXRNYXhQZXJFeGNoYW5nZSh1aW50MjU2IF9tYXhQZXJFeGNoYW5nZSkgb25seU93bmVyIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoKF9tYXhQZXJFeGNoYW5nZSA+PSAxMCkgJiYgKF9tYXhQZXJFeGNoYW5nZSA8PSAxMDApKTsKICAgICAgICBtYXhQZXJFeGNoYW5nZUJQID0gX21heFBlckV4Y2hhbmdlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vIEByZXR1cm4gRXN0aW1hdGVkIExpcXVpZGF0aW9uIENhcAogICAgLy8gQGRldiBMaXF1aWRhdGlvbiBDYXAgcGVyIHRyYW5zYWN0aW9uIGlzIHVzZWQgdG8gZW5zdXJlIHByb3BlciBwcmljZSBkaXNjb3ZlcnkgZm9yIFdvbGsgRXhjaGFuZ2UgCiAgICBmdW5jdGlvbiBlc3RMaXF1aWRhdGlvbkNhcCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgaWYgKG9wZW5TYWxlQ29tcGxldGVkKXsKICAgICAgICAgICAgdmFyIGxpcXVpZGF0aW9uTWF4ICA9IHNhZmVEaXYoc2FmZU11bCh0b3RhbFRva2VucywgbWF4UGVyRXhjaGFuZ2VCUCksIDEwMDAwKTsKICAgICAgICAgICAgaWYgKGxpcXVpZGF0aW9uTWF4IDwgMTAwICogMTAqKmRlY2ltYWxzKXsgCiAgICAgICAgICAgICAgICBsaXF1aWRhdGlvbk1heCA9IDEwMCAqIDEwKipkZWNpbWFsczsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbGlxdWlkYXRpb25NYXg7ICAgCiAgICAgICAgfWVsc2V7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBzZWxsV29sa0VzdGltYXRlKHVpbnQyNTYgX3dvbGtBbW91bnRlc3QsIGFkZHJlc3MgX2Zvcm11bGEpIGludGVybmFsIHJldHVybnModWludDI1NikgewogICAgICAgIHVpbnQyNTYgZXRoUmVjZWl2YWJsZSA9ICBJQmFuY29yRm9ybXVsYShfZm9ybXVsYSkuY2FsY3VsYXRlU2FsZVJldHVybih0b3RhbFRva2VucywgcmVzZXJ2ZUJhbGFuY2UsIHBlcmNlbnRhZ2VFVEhSZXNlcnZlLCBfd29sa0Ftb3VudGVzdCk7CiAgICAgICAgcmV0dXJuIGV0aFJlY2VpdmFibGU7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHB1cmNoYXNlV29sa0VzdGltYXRlKHVpbnQyNTYgX2V0aEFtb3VudGVzdCwgYWRkcmVzcyBfZm9ybXVsYSkgaW50ZXJuYWwgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiB3b2xrUmVjZWl2YWJsZSA9IElCYW5jb3JGb3JtdWxhKF9mb3JtdWxhKS5jYWxjdWxhdGVQdXJjaGFzZVJldHVybih0b3RhbFRva2VucywgcmVzZXJ2ZUJhbGFuY2UsIHBlcmNlbnRhZ2VFVEhSZXNlcnZlLCBfZXRoQW1vdW50ZXN0KTsKICAgICAgICByZXR1cm4gd29sa1JlY2VpdmFibGU7CiAgICB9CiAgICAKICAgIC8vIEBwYXJhbSBfd29sa0Ftb3VudAogICAgLy8gQHJldHVybiBldGhSZWNlaXZhYmxlCiAgICAvLyBAZGV2IHNlbmQgV29sayBpbnRvIGNvbnRyYWN0IGluIGV4Y2hhbmdlIGZvciBldGgsIGF0IGFuIGV4Y2hhbmdlIHJhdGUgYmFzZWQgb24gdGhlIEJhbmNvciBQcm90b2NvbCBkZXJpdmF0aW9uIGFuZCBkZWNyZWFzZSB0b3RhbFN1cHBseSBhY2NvcmRpbmdseQogICAgZnVuY3Rpb24gc2VsbFdvbGsodWludDI1NiBfd29sa0Ftb3VudCkgaXNFeGNoYW5nYWJsZSgpIHJldHVybnModWludDI1NikgewogICAgICAgIHVpbnQyNTYgc2VsbENhcCA9IGVzdExpcXVpZGF0aW9uQ2FwKCk7CiAgICAgICAgcmVxdWlyZSgoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3dvbGtBbW91bnQpKTsKICAgICAgICByZXF1aXJlKHNlbGxDYXAgPj0gX3dvbGtBbW91bnQpOwogICAgICAgIHVpbnQyNTYgZXRoUmVjZWl2YWJsZSA9IHNlbGxXb2xrRXN0aW1hdGUoX3dvbGtBbW91bnQsZXhjaGFuZ2VGb3JtdWxhKTsKICAgICAgICByZXF1aXJlKHRoaXMuYmFsYW5jZSA+IGV0aFJlY2VpdmFibGUpOwogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gc2FmZVN1YihiYWxhbmNlc1ttc2cuc2VuZGVyXSwgX3dvbGtBbW91bnQpOwogICAgICAgIHRvdGFsVG9rZW5zID0gc2FmZVN1Yih0b3RhbFRva2VucywgX3dvbGtBbW91bnQpOwogICAgICAgIHJlc2VydmVCYWxhbmNlID0gc2FmZVN1Yih0aGlzLmJhbGFuY2UsIGV0aFJlY2VpdmFibGUpOwogICAgICAgIFdvbGtEZXN0cm95ZWQobXNnLnNlbmRlciwgX3dvbGtBbW91bnQpOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIDB4MDAwMDAwMDAwMDAwMDAwMDAwMDAsIF93b2xrQW1vdW50KTsKICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKGV0aFJlY2VpdmFibGUpOwogICAgICAgIHJldHVybiBldGhSZWNlaXZhYmxlOyAgICAgCiAgICB9CgogICAgLy8gQHJldHVybiB3b2xrUmVjZWl2YWJsZSAgICAKICAgIC8vIEBkZXYgc2VuZCBldGggaW50byBjb250cmFjdCBpbiBleGNoYW5nZSBmb3IgV29sayB0b2tlbnMsIGF0IGFuIGV4Y2hhbmdlIHJhdGUgYmFzZWQgb24gdGhlIEJhbmNvciBQcm90b2NvbCBkZXJpdmF0aW9uIGFuZCBpbmNyZWFzZSB0b3RhbFN1cHBseSBhY2NvcmRpbmdseQogICAgZnVuY3Rpb24gcHVyY2hhc2VXb2xrKGFkZHJlc3MgX2J1eWVyKSBpc0V4Y2hhbmdhYmxlKCkgcGF5YWJsZSByZXR1cm5zKHVpbnQyNTYpewogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID4gMCk7CiAgICAgICAgdWludDI1NiB3b2xrUmVjZWl2YWJsZSA9IHB1cmNoYXNlV29sa0VzdGltYXRlKG1zZy52YWx1ZSwgZXhjaGFuZ2VGb3JtdWxhKTsKICAgICAgICByZXF1aXJlKHdvbGtSZWNlaXZhYmxlID4gMCk7CiAgICAgICAgdG90YWxUb2tlbnMgPSBzYWZlQWRkKHRvdGFsVG9rZW5zLCB3b2xrUmVjZWl2YWJsZSk7CiAgICAgICAgYmFsYW5jZXNbX2J1eWVyXSA9IHNhZmVBZGQoYmFsYW5jZXNbX2J1eWVyXSwgd29sa1JlY2VpdmFibGUpOwogICAgICAgIHJlc2VydmVCYWxhbmNlID0gc2FmZUFkZChyZXNlcnZlQmFsYW5jZSwgbXNnLnZhbHVlKTsKICAgICAgICBXb2xrQ3JlYXRlZChfYnV5ZXIsIHdvbGtSZWNlaXZhYmxlKTsKICAgICAgICBUcmFuc2ZlcihhZGRyZXNzKHRoaXMpLF9idXllcix3b2xrUmVjZWl2YWJsZSk7CiAgICAgICAgcmV0dXJuIHdvbGtSZWNlaXZhYmxlOwogICAgfQoKICAgIC8vIEBkZXYgIGZhbGxiYWNrIGZ1bmN0aW9uIGZvciBwdXJjaGFzZQogICAgLy8gQG5vdGUgQXV0b21hdGljYWxseSBmYWxsYmFjayB0byB0b2tlbkdlbmVyYXRpb25FdmVudCBiZWZvcmUgc2FsZSBpcyBjb21wbGV0ZWQuIEFmdGVyIHRoZSB0b2tlbiBnZW5lcmF0aW9uIGV2ZW50LCBmYWxsYmFjayB0byBwdXJjaGFzZVdvbGsuIExpcXVpZGl0eSBleGNoYW5nZSB3aWxsIGJlIGVuYWJsZWQgdGhyb3VnaCB1cGRhdGVFeGNoYW5nZVN0YXR1cyAgCiAgICBmdW5jdGlvbiAoKSBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+IDApOwogICAgICAgIGlmKCFvcGVuU2FsZUNvbXBsZXRlZCl7CiAgICAgICAgICAgIHRoaXMudG9rZW5HZW5lcmF0aW9uRXZlbnQudmFsdWUobXNnLnZhbHVlKShtc2cuc2VuZGVyKTsKICAgICAgICB9ZWxzZSBpZiAoYmxvY2subnVtYmVyID49IGVuZF9ibG9jayl7CiAgICAgICAgICAgIHRoaXMucHVyY2hhc2VXb2xrLnZhbHVlKG1zZy52YWx1ZSkobXNnLnNlbmRlcik7CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KICAgIH0KfQ=='.
	

]
