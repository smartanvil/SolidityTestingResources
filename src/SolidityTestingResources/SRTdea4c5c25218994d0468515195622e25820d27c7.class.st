Class {
	#name : #SRTdea4c5c25218994d0468515195622e25820d27c7,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTdea4c5c25218994d0468515195622e25820d27c7 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7Cgpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9Cgpjb250cmFjdCBFUkM3MjEgewogICAgZnVuY3Rpb24gaW1wbGVtZW50c0VSQzcyMSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHRvdGFsKTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKICAgIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBvd25lcik7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWM7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWM7CiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGluZGV4ZWQgdG9rZW5JZCk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBhcHByb3ZlZCwgdWludDI1NiBpbmRleGVkIHRva2VuSWQpOwp9Cgpjb250cmFjdCBTYW1wbGVTdG9yYWdlIGlzIE93bmFibGUgewogICAgCiAgICBzdHJ1Y3QgU2FtcGxlIHsKICAgICAgICBzdHJpbmcgaXBmc0hhc2g7CiAgICAgICAgdWludCByYXJpdHk7CiAgICB9CiAgICAKICAgIG1hcHBpbmcgKHVpbnQzMiA9PiBTYW1wbGUpIHB1YmxpYyBzYW1wbGVUeXBlczsKICAgIAogICAgdWludDMyIHB1YmxpYyBudW1PZlNhbXBsZVR5cGVzOwogICAgCiAgICB1aW50MzIgcHVibGljIG51bU9mQ29tbW9uOwogICAgdWludDMyIHB1YmxpYyBudW1PZlJhcmU7CiAgICB1aW50MzIgcHVibGljIG51bU9mTGVnZW5kYXJ5OwoKICAgIC8vIFRoZSBteXRoaWNhbCBzYW1wbGUgaXMgYSB0eXBlIGNvbW1vbiB0aGF0IGFwcGVhcnMgb25seSBvbmNlIGluIGEgMTAwMAogICAgZnVuY3Rpb24gYWRkTmV3U2FtcGxlVHlwZShzdHJpbmcgX2lwZnNIYXNoLCB1aW50IF9yYXJpdHlUeXBlKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICAKICAgICAgICBpZiAoX3Jhcml0eVR5cGUgPT0gMCkgewogICAgICAgICAgICBudW1PZkNvbW1vbisrOwogICAgICAgIH0gZWxzZSBpZiAoX3Jhcml0eVR5cGUgPT0gMSkgewogICAgICAgICAgICBudW1PZlJhcmUrKzsKICAgICAgICB9IGVsc2UgaWYoX3Jhcml0eVR5cGUgPT0gMikgewogICAgICAgICAgICBudW1PZkxlZ2VuZGFyeSsrOwogICAgICAgIH0gZWxzZSBpZihfcmFyaXR5VHlwZSA9PSAzKSB7CiAgICAgICAgICAgIG51bU9mQ29tbW9uKys7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHNhbXBsZVR5cGVzW251bU9mU2FtcGxlVHlwZXNdID0gU2FtcGxlKHsKICAgICAgICAgICBpcGZzSGFzaDogX2lwZnNIYXNoLAogICAgICAgICAgIHJhcml0eTogX3Jhcml0eVR5cGUKICAgICAgICB9KTsKICAgICAgICAKICAgICAgICBudW1PZlNhbXBsZVR5cGVzKys7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldFR5cGUodWludCBfcmFuZG9tTnVtKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MzIpIHsKICAgICAgICB1aW50MzIgcmFuZ2UgPSAwOwogICAgICAgIAogICAgICAgIGlmIChfcmFuZG9tTnVtID4gMCAmJiBfcmFuZG9tTnVtIDwgNjAwKSB7CiAgICAgICAgICAgIHJhbmdlID0gNjAwIC8gbnVtT2ZDb21tb247CiAgICAgICAgICAgIHJldHVybiB1aW50MzIoX3JhbmRvbU51bSkgLyByYW5nZTsKICAgICAgICAgICAgCiAgICAgICAgfSBlbHNlIGlmKF9yYW5kb21OdW0gPj0gNjAwICYmIF9yYW5kb21OdW0gPCA5MDApIHsKICAgICAgICAgICAgcmFuZ2UgPSAzMDAgLyBudW1PZlJhcmU7CiAgICAgICAgICAgIHJldHVybiB1aW50MzIoX3JhbmRvbU51bSkgLyByYW5nZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByYW5nZSA9IDEwMCAvIG51bU9mTGVnZW5kYXJ5OwogICAgICAgICAgICByZXR1cm4gdWludDMyKF9yYW5kb21OdW0pIC8gcmFuZ2U7CiAgICAgICAgfQogICAgfQogICAgCn0KCmNvbnRyYWN0IEppbmdsZSBpcyBPd25hYmxlLCBFUkM3MjEgewogICAgCiAgICBzdHJ1Y3QgTWV0YUluZm8gewogICAgICAgIHN0cmluZyBuYW1lOwogICAgICAgIHN0cmluZyBhdXRob3I7CiAgICB9CiAgICAKICAgIG1hcHBpbmcgKHVpbnQgPT4gYWRkcmVzcykgaW50ZXJuYWwgdG9rZW5zRm9yT3duZXI7CiAgICBtYXBwaW5nICh1aW50ID0+IGFkZHJlc3MpIGludGVybmFsIHRva2Vuc0ZvckFwcHJvdmVkOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50W10pIGludGVybmFsIHRva2Vuc093bmVkOwogICAgbWFwcGluZyAodWludCA9PiB1aW50KSBpbnRlcm5hbCB0b2tlblBvc0luQXJyOwogICAgCiAgICBtYXBwaW5nKHVpbnQgPT4gdWludFtdKSBpbnRlcm5hbCBzYW1wbGVzSW5KaW5nbGU7CiAgICBtYXBwaW5nKHVpbnQgPT4gTWV0YUluZm8pIHB1YmxpYyBqaW5nbGVzSW5mbzsKICAgIAogICAgbWFwcGluZyhieXRlczMyID0+IGJvb2wpIHB1YmxpYyB1bmlxdWVKaW5nbGVzOwogICAgCiAgICBtYXBwaW5nKHVpbnQgPT4gdWludDhbXSkgcHVibGljIHNvdW5kRWZmZWN0czsKICAgIG1hcHBpbmcodWludCA9PiB1aW50OFsyMF0pIHB1YmxpYyBzZXR0aW5nczsKICAgIAogICAgdWludCBwdWJsaWMgbnVtT2ZKaW5nbGVzOwogICAgCiAgICBhZGRyZXNzIHB1YmxpYyBjcnlwdG9KaW5nbGVzOwogICAgTWFya2V0cGxhY2UgcHVibGljIG1hcmtldHBsYWNlQ29udHJhY3Q7CiAgICAKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgaW5kZXhlZCB0b2tlbklkKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIGFwcHJvdmVkLCB1aW50MjU2IGluZGV4ZWQgdG9rZW5JZCk7CiAgICBldmVudCBFZmZlY3RBZGRlZCh1aW50IGluZGV4ZWQgamluZ2xlSWQsIHVpbnQ4W10gZWZmZWN0UGFyYW1zKTsKICAgIGV2ZW50IENvbXBvc2VkKHVpbnQgaW5kZXhlZCBqaW5nbGVJZCwgYWRkcmVzcyBpbmRleGVkIG93bmVyLCB1aW50MzJbNV0gc2FtcGxlcywgdWludDMyWzVdIGppbmdsZVR5cGVzLAogICAgICAgICAgICBzdHJpbmcgbmFtZSwgc3RyaW5nIGF1dGhvciwgdWludDhbMjBdIHNldHRpbmdzKTsKICAgIAogICAgbW9kaWZpZXIgb25seUNyeXB0b0ppbmdsZXMoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNyeXB0b0ppbmdsZXMpOwogICAgICAgIF87CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF9qaW5nbGVJZCkgcHVibGljIHsKICAgICAgICByZXF1aXJlKHRva2Vuc0Zvck93bmVyW19qaW5nbGVJZF0gIT0gMHgwKTsKICAgICAgICByZXF1aXJlKHRva2Vuc0Zvck93bmVyW19qaW5nbGVJZF0gPT0gbXNnLnNlbmRlcik7CiAgICAgICAgCiAgICAgICAgdG9rZW5zRm9yQXBwcm92ZWRbX2ppbmdsZUlkXSA9IDB4MDsKICAgICAgICAKICAgICAgICByZW1vdmVKaW5nbGUobXNnLnNlbmRlciwgX2ppbmdsZUlkKTsKICAgICAgICBhZGRKaW5nbGUoX3RvLCBfamluZ2xlSWQpOwogICAgICAgIAogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIDAsIF9qaW5nbGVJZCk7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfamluZ2xlSWQpOwogICAgfQogICAgCiAgICAKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2ppbmdsZUlkKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUodG9rZW5zRm9yT3duZXJbX2ppbmdsZUlkXSAhPSAweDApOwogICAgICAgIHJlcXVpcmUob3duZXJPZihfamluZ2xlSWQpID09IG1zZy5zZW5kZXIpOwogICAgICAgIHJlcXVpcmUoX3RvICE9IG1zZy5zZW5kZXIpOwogICAgICAgIAogICAgICAgIGlmIChfZ2V0QXBwcm92ZWQoX2ppbmdsZUlkKSAhPSAweDAgfHwgX3RvICE9IDB4MCkgewogICAgICAgICAgICB0b2tlbnNGb3JBcHByb3ZlZFtfamluZ2xlSWRdID0gX3RvOwogICAgICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfdG8sIF9qaW5nbGVJZCk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2ppbmdsZUlkKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUodG9rZW5zRm9yT3duZXJbX2ppbmdsZUlkXSAhPSAweDApOwogICAgICAgIHJlcXVpcmUoX2dldEFwcHJvdmVkKF9qaW5nbGVJZCkgPT0gbXNnLnNlbmRlcik7CiAgICAgICAgcmVxdWlyZShvd25lck9mKF9qaW5nbGVJZCkgPT0gX2Zyb20pOwogICAgICAgIHJlcXVpcmUoX3RvICE9IDB4MCk7CiAgICAgICAgCiAgICAgICAgdG9rZW5zRm9yQXBwcm92ZWRbX2ppbmdsZUlkXSA9IDB4MDsKICAgICAgICAKICAgICAgICByZW1vdmVKaW5nbGUoX2Zyb20sIF9qaW5nbGVJZCk7CiAgICAgICAgYWRkSmluZ2xlKF90bywgX2ppbmdsZUlkKTsKICAgICAgICAKICAgICAgICBBcHByb3ZhbChfZnJvbSwgMCwgX2ppbmdsZUlkKTsKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfamluZ2xlSWQpOwogICAgICAgIAogICAgfQogICAgCiAgICBmdW5jdGlvbiBhcHByb3ZlQW5kU2VsbCh1aW50IF9qaW5nbGVJZCwgdWludCBfYW1vdW50KSBwdWJsaWMgewogICAgICAgIGFwcHJvdmUoYWRkcmVzcyhtYXJrZXRwbGFjZUNvbnRyYWN0KSwgX2ppbmdsZUlkKTsKICAgICAgICAKICAgICAgICBtYXJrZXRwbGFjZUNvbnRyYWN0LnNlbGwobXNnLnNlbmRlciwgX2ppbmdsZUlkLCBfYW1vdW50KTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gY29tcG9zZUppbmdsZShhZGRyZXNzIF9vd25lciwgdWludDMyWzVdIGppbmdsZXMsIAogICAgdWludDMyWzVdIGppbmdsZVR5cGVzLCBzdHJpbmcgbmFtZSwgc3RyaW5nIGF1dGhvciwgdWludDhbMjBdIF9zZXR0aW5ncykgcHVibGljIG9ubHlDcnlwdG9KaW5nbGVzIHsKICAgICAgICAKICAgICAgICB1aW50IF9qaW5nbGVJZCA9IG51bU9mSmluZ2xlczsKICAgICAgICAKICAgICAgICB1bmlxdWVKaW5nbGVzW2tlY2NhazI1NihqaW5nbGVzKV0gPSB0cnVlOwogICAgICAgIAogICAgICAgIHRva2Vuc0Zvck93bmVyW19qaW5nbGVJZF0gPSBfb3duZXI7CiAgICAgICAgCiAgICAgICAgdG9rZW5zT3duZWRbX293bmVyXS5wdXNoKF9qaW5nbGVJZCk7CiAgICAgICAgCiAgICAgICAgc2FtcGxlc0luSmluZ2xlW19qaW5nbGVJZF0gPSBqaW5nbGVzOwogICAgICAgIHNldHRpbmdzW19qaW5nbGVJZF0gPSBfc2V0dGluZ3M7CiAgICAgICAgCiAgICAgICAgdG9rZW5Qb3NJbkFycltfamluZ2xlSWRdID0gdG9rZW5zT3duZWRbX293bmVyXS5sZW5ndGggLSAxOwogICAgICAgIAogICAgICAgIGlmIChieXRlcyhhdXRob3IpLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICAgIGF1dGhvciA9ICJTb3VuZHRvc2hpIE5ha2FqaW5nbGVzIjsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgamluZ2xlc0luZm9bbnVtT2ZKaW5nbGVzXSA9IE1ldGFJbmZvKHsKICAgICAgICAgICAgbmFtZTogbmFtZSwKICAgICAgICAgICAgYXV0aG9yOiBhdXRob3IKICAgICAgICB9KTsKICAgICAgICAKICAgICAgICBDb21wb3NlZChudW1PZkppbmdsZXMsIF9vd25lciwgamluZ2xlcywgamluZ2xlVHlwZXMsIAogICAgICAgIG5hbWUsIGF1dGhvciwgX3NldHRpbmdzKTsKICAgICAgICAKICAgICAgICBudW1PZkppbmdsZXMrKzsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gYWRkU291bmRFZmZlY3QodWludCBfamluZ2xlSWQsIHVpbnQ4W10gX2VmZmVjdFBhcmFtcykgZXh0ZXJuYWwgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lck9mKF9qaW5nbGVJZCkpOwogICAgICAgIAogICAgICAgIHNvdW5kRWZmZWN0c1tfamluZ2xlSWRdID0gX2VmZmVjdFBhcmFtczsKICAgICAgICAKICAgICAgICBFZmZlY3RBZGRlZChfamluZ2xlSWQsIF9lZmZlY3RQYXJhbXMpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBpbXBsZW1lbnRzRVJDNzIxKCkgcHVibGljIHB1cmUgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gbnVtT2ZKaW5nbGVzOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgICAgIHJldHVybiB0b2tlbnNPd25lZFtfb3duZXJdLmxlbmd0aDsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF9qaW5nbGVJZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcykgewogICAgICAgIHJldHVybiB0b2tlbnNGb3JPd25lcltfamluZ2xlSWRdOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB0b2tlbk9mT3duZXJCeUluZGV4KGFkZHJlc3MgX293bmVyLCB1aW50MjU2IF9pbmRleCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHRva2Vuc093bmVkW19vd25lcl1bX2luZGV4XTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0U2FtcGxlc0ZvckppbmdsZSh1aW50IF9qaW5nbGVJZCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zKHVpbnRbXSkgewogICAgICAgIHJldHVybiBzYW1wbGVzSW5KaW5nbGVbX2ppbmdsZUlkXTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0QWxsSmluZ2xlcyhhZGRyZXNzIF9vd25lcikgZXh0ZXJuYWwgdmlldyByZXR1cm5zKHVpbnRbXSkgewogICAgICAgIHJldHVybiB0b2tlbnNPd25lZFtfb3duZXJdOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRNZXRhSW5mbyh1aW50IF9qaW5nbGVJZCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zKHN0cmluZywgc3RyaW5nKSB7CiAgICAgICAgcmV0dXJuIChqaW5nbGVzSW5mb1tfamluZ2xlSWRdLm5hbWUsIGppbmdsZXNJbmZvW19qaW5nbGVJZF0uYXV0aG9yKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gX2dldEFwcHJvdmVkKHVpbnQgX2ppbmdsZUlkKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKGFkZHJlc3MpIHsKICAgICAgICByZXR1cm4gdG9rZW5zRm9yQXBwcm92ZWRbX2ppbmdsZUlkXTsKICAgIH0KICAgIAogICAgIC8vIEludGVybmFsIGZ1bmN0aW9ucyBvZiB0aGUgY29udHJhY3QKICAgIAogICAgZnVuY3Rpb24gYWRkSmluZ2xlKGFkZHJlc3MgX293bmVyLCB1aW50IF9qaW5nbGVJZCkgaW50ZXJuYWwgewogICAgICAgIHRva2Vuc0Zvck93bmVyW19qaW5nbGVJZF0gPSBfb3duZXI7CiAgICAgICAgCiAgICAgICAgdG9rZW5zT3duZWRbX293bmVyXS5wdXNoKF9qaW5nbGVJZCk7CiAgICAgICAgCiAgICAgICAgdG9rZW5Qb3NJbkFycltfamluZ2xlSWRdID0gdG9rZW5zT3duZWRbX293bmVyXS5sZW5ndGggLSAxOwogICAgfQogICAgCiAgICAvLyBmaW5kIHdobyBvd25zIHRoYXQgamluZ2xlIGFuZCBhdCB3aGF0IHBvc2l0aW9uIGlzIGl0IGluIHRoZSBvd25lcnMgYXJyIAogICAgLy8gU3dhcCB0aGF0IHRva2VuIHdpdGggdGhlIGxhc3Qgb25lIGluIGFyciBhbmQgZGVsZXRlIHRoZSBlbmQgb2YgYXJyCiAgICBmdW5jdGlvbiByZW1vdmVKaW5nbGUoYWRkcmVzcyBfb3duZXIsIHVpbnQgX2ppbmdsZUlkKSBpbnRlcm5hbCB7CiAgICAgICAgdWludCBsZW5ndGggPSB0b2tlbnNPd25lZFtfb3duZXJdLmxlbmd0aDsKICAgICAgICB1aW50IGluZGV4ID0gdG9rZW5Qb3NJbkFycltfamluZ2xlSWRdOwogICAgICAgIHVpbnQgc3dhcFRva2VuID0gdG9rZW5zT3duZWRbX293bmVyXVtsZW5ndGggLSAxXTsKCiAgICAgICAgdG9rZW5zT3duZWRbX293bmVyXVtpbmRleF0gPSBzd2FwVG9rZW47CiAgICAgICAgdG9rZW5Qb3NJbkFycltzd2FwVG9rZW5dID0gaW5kZXg7CgogICAgICAgIGRlbGV0ZSB0b2tlbnNPd25lZFtfb3duZXJdW2xlbmd0aCAtIDFdOwogICAgICAgIHRva2Vuc093bmVkW19vd25lcl0ubGVuZ3RoLS07CiAgICB9CiAgICAKICAgIC8vIE93bmVyIGZ1bmN0aW9ucyAKICAgIGZ1bmN0aW9uIHNldENyeXB0b0ppbmdsZXNDb250cmFjdChhZGRyZXNzIF9jcnlwdG9KaW5nbGVzKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKGNyeXB0b0ppbmdsZXMgPT0gMHgwKTsKICAgICAgICAKICAgICAgICBjcnlwdG9KaW5nbGVzID0gX2NyeXB0b0ppbmdsZXM7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHNldE1hcmtldHBsYWNlQ29udHJhY3QoYWRkcmVzcyBfbWFya2V0cGxhY2UpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoYWRkcmVzcyhtYXJrZXRwbGFjZUNvbnRyYWN0KSA9PSAweDApOwogICAgICAgIAogICAgICAgIG1hcmtldHBsYWNlQ29udHJhY3QgPSBNYXJrZXRwbGFjZShfbWFya2V0cGxhY2UpOwogICAgfQp9Cgpjb250cmFjdCBTYW1wbGUgaXMgT3duYWJsZSB7CiAgICAKICAgIG1hcHBpbmcgKHVpbnQgPT4gYWRkcmVzcykgaW50ZXJuYWwgdG9rZW5zRm9yT3duZXI7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnRbXSkgaW50ZXJuYWwgdG9rZW5zT3duZWQ7CiAgICBtYXBwaW5nICh1aW50ID0+IHVpbnQpIGludGVybmFsIHRva2VuUG9zSW5BcnI7CiAgICAKICAgIG1hcHBpbmcgKHVpbnQgPT4gdWludDMyKSBwdWJsaWMgdG9rZW5UeXBlOwogICAgCiAgICB1aW50IHB1YmxpYyBudW1PZlNhbXBsZXM7CiAgICAKICAgIGFkZHJlc3MgcHVibGljIGNyeXB0b0ppbmdsZXM7CiAgICBhZGRyZXNzIHB1YmxpYyBzYW1wbGVSZWdpc3RyeTsKCgogICAgU2FtcGxlU3RvcmFnZSBwdWJsaWMgc2FtcGxlU3RvcmFnZTsKICAgIAogICAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IGluZGV4ZWQgX3Rva2VuSWQpOwogICAgCiAgICBtb2RpZmllciBvbmx5Q3J5cHRvSmluZ2xlcygpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY3J5cHRvSmluZ2xlcyk7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gU2FtcGxlKGFkZHJlc3MgX3NhbXBsZVN0b3JhZ2UpIHB1YmxpYyB7CiAgICAgICAgc2FtcGxlU3RvcmFnZSA9IFNhbXBsZVN0b3JhZ2UoX3NhbXBsZVN0b3JhZ2UpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX293bmVyLCB1aW50IF9yYW5kb21OdW0pIHB1YmxpYyBvbmx5Q3J5cHRvSmluZ2xlcyB7CiAgICAgICAgCiAgICAgICAgdWludDMyIHNhbXBsZVR5cGUgPSBzYW1wbGVTdG9yYWdlLmdldFR5cGUoX3JhbmRvbU51bSk7CiAgICAgICAgCiAgICAgICAgYWRkU2FtcGxlKF9vd25lciwgc2FtcGxlVHlwZSwgbnVtT2ZTYW1wbGVzKTsKICAgICAgICAKICAgICAgICBNaW50KF9vd25lciwgbnVtT2ZTYW1wbGVzKTsKICAgICAgICAKICAgICAgICBudW1PZlNhbXBsZXMrKzsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gbWludEZvclNhbXBsZVJlZ2l0cnkoYWRkcmVzcyBfb3duZXIsIHVpbnQzMiBfdHlwZSkgcHVibGljIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gc2FtcGxlUmVnaXN0cnkpOwogICAgICAgIAogICAgICAgIGFkZFNhbXBsZShfb3duZXIsIF90eXBlLCBudW1PZlNhbXBsZXMpOwogICAgICAgIAogICAgICAgIE1pbnQoX293bmVyLCBudW1PZlNhbXBsZXMpOwogICAgICAgIAogICAgICAgIG51bU9mU2FtcGxlcysrOwogICAgfQogICAgCiAgICBmdW5jdGlvbiByZW1vdmVTYW1wbGUoYWRkcmVzcyBfb3duZXIsIHVpbnQgX3NhbXBsZUlkKSBwdWJsaWMgb25seUNyeXB0b0ppbmdsZXMgewogICAgICAgIHVpbnQgbGVuZ3RoID0gdG9rZW5zT3duZWRbX293bmVyXS5sZW5ndGg7CiAgICAgICAgdWludCBpbmRleCA9IHRva2VuUG9zSW5BcnJbX3NhbXBsZUlkXTsKICAgICAgICB1aW50IHN3YXBUb2tlbiA9IHRva2Vuc093bmVkW19vd25lcl1bbGVuZ3RoIC0gMV07CgogICAgICAgIHRva2Vuc093bmVkW19vd25lcl1baW5kZXhdID0gc3dhcFRva2VuOwogICAgICAgIHRva2VuUG9zSW5BcnJbc3dhcFRva2VuXSA9IGluZGV4OwoKICAgICAgICBkZWxldGUgdG9rZW5zT3duZWRbX293bmVyXVtsZW5ndGggLSAxXTsKICAgICAgICB0b2tlbnNPd25lZFtfb3duZXJdLmxlbmd0aC0tOwogICAgICAgIAogICAgICAgIHRva2Vuc0Zvck93bmVyW19zYW1wbGVJZF0gPSAweDA7CiAgICAgICAgCiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldFNhbXBsZXNGb3JPd25lcihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnRbXSkgewogICAgICAgIHJldHVybiB0b2tlbnNPd25lZFtfb3duZXJdOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRUb2tlblR5cGUodWludCBfc2FtcGxlSWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIHRva2VuVHlwZVtfc2FtcGxlSWRdOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBpc1Rva2VuT3duZXIodWludCBfdG9rZW5JZCwgYWRkcmVzcyBfdXNlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMoYm9vbCkgewogICAgICAgIHJldHVybiB0b2tlbnNGb3JPd25lcltfdG9rZW5JZF0gPT0gX3VzZXI7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldEFsbFNhbXBsZXNGb3JPd25lcihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnModWludFtdKSB7CiAgICAgICAgdWludFtdIG1lbW9yeSBzYW1wbGVzID0gdG9rZW5zT3duZWRbX293bmVyXTsKICAgICAgICAKICAgICAgICB1aW50W10gbWVtb3J5IHVzZXJzU2FtcGxlcyA9IG5ldyB1aW50W10oc2FtcGxlcy5sZW5ndGggKiAyKTsKICAgICAgICAKICAgICAgICB1aW50IGogPSAwOwogICAgICAgIAogICAgICAgIGZvcih1aW50IGkgPSAwOyBpIDwgc2FtcGxlcy5sZW5ndGg7ICsraSkgewogICAgICAgICAgICB1c2Vyc1NhbXBsZXNbal0gPSBzYW1wbGVzW2ldOwogICAgICAgICAgICB1c2Vyc1NhbXBsZXNbaiArIDFdID0gdG9rZW5UeXBlW3NhbXBsZXNbaV1dOwogICAgICAgICAgICBqICs9IDI7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVybiB1c2Vyc1NhbXBsZXM7CiAgICB9CiAgICAKICAgIC8vIEludGVybmFsIGZ1bmN0aW9ucyBvZiB0aGUgY29udHJhY3QKICAgIAogICAgZnVuY3Rpb24gYWRkU2FtcGxlKGFkZHJlc3MgX293bmVyLCB1aW50MzIgX3NhbXBsZVR5cGUsIHVpbnQgX3NhbXBsZUlkKSBpbnRlcm5hbCB7CiAgICAgICAgdG9rZW5zRm9yT3duZXJbX3NhbXBsZUlkXSA9IF9vd25lcjsKICAgICAgICAKICAgICAgICB0b2tlbnNPd25lZFtfb3duZXJdLnB1c2goX3NhbXBsZUlkKTsKICAgICAgICAKICAgICAgICB0b2tlblR5cGVbX3NhbXBsZUlkXSA9IF9zYW1wbGVUeXBlOwogICAgICAgIAogICAgICAgIHRva2VuUG9zSW5BcnJbX3NhbXBsZUlkXSA9IHRva2Vuc093bmVkW19vd25lcl0ubGVuZ3RoIC0gMTsKICAgIH0KICAgIAogICAgIC8vIE93bmVyIGZ1bmN0aW9ucyAKICAgIC8vIFNldCB0aGUgY3J5cHRvIGppbmdsZXMgY29udHJhY3QgY2FuIAogICAgZnVuY3Rpb24gc2V0Q3J5cHRvSmluZ2xlc0NvbnRyYWN0KGFkZHJlc3MgX2NyeXB0b0ppbmdsZXMpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoY3J5cHRvSmluZ2xlcyA9PSAweDApOwogICAgICAgIAogICAgICAgIGNyeXB0b0ppbmdsZXMgPSBfY3J5cHRvSmluZ2xlczsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gc2V0U2FtcGxlUmVnaXN0cnkoYWRkcmVzcyBfc2FtcGxlUmVnaXN0cnkpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHNhbXBsZVJlZ2lzdHJ5ID0gX3NhbXBsZVJlZ2lzdHJ5OwogICAgfQp9Cgpjb250cmFjdCBDcnlwdG9KaW5nbGVzIGlzIE93bmFibGUgewogICAgCiAgICBzdHJ1Y3QgUHVyY2hhc2UgewogICAgICAgIGFkZHJlc3MgdXNlcjsKICAgICAgICB1aW50IGJsb2NrTnVtYmVyOwogICAgICAgIGJvb2wgcmV2ZWFsZWQ7CiAgICAgICAgdWludCBudW1TYW1wbGVzOwogICAgICAgIGJvb2wgZXhpc3RzOwogICAgfQogICAgCiAgICBldmVudCBQdXJjaGFzZWQoYWRkcmVzcyBpbmRleGVkIHVzZXIsIHVpbnQgYmxvY2tOdW1iZXIsIHVpbnQgbnVtSmluZ2xlcywgdWludCBudW1PZlB1cmNoYXNlcyk7CiAgICBldmVudCBKaW5nbGVzT3BlbmVkKGFkZHJlc3MgYnlXaG9tLCBhZGRyZXNzIGppbmdsZU93bmVyLCB1aW50IGN1cnJCbG9ja051bWJlcik7CiAgICAKICAgIG1hcHBpbmcgKHVpbnQgPT4gYm9vbCkgcHVibGljIGlzQWxyZWFkeVVzZWQ7CiAgICAKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBzdHJpbmcpIHB1YmxpYyBhdXRob3JzOwoKICAgIHVpbnQgbnVtT2ZQdXJjaGFzZXM7CiAgICAKICAgIHVpbnQgTUFYX1NBTVBMRVNfUEVSX1BVUkNIQVNFID0gMTU7CiAgICB1aW50IFNBTVBMRV9QUklDRSA9IDEwICoqIDE1OwogICAgdWludCBTQU1QTEVTX1BFUl9KSU5HTEUgPSA1OwogICAgdWludCBOVU1fU0FNUExFX1JBTkdFID0gMTAwMDsKICAgIAogICAgU2FtcGxlIHB1YmxpYyBzYW1wbGVDb250cmFjdDsKICAgIEppbmdsZSBwdWJsaWMgamluZ2xlQ29udHJhY3Q7CiAgICAKICAgIGZ1bmN0aW9uIENyeXB0b0ppbmdsZXMoYWRkcmVzcyBfc2FtcGxlLCBhZGRyZXNzIF9qaW5nbGUpIHB1YmxpYyB7CiAgICAgICAgbnVtT2ZQdXJjaGFzZXMgPSAwOwogICAgICAgIHNhbXBsZUNvbnRyYWN0ID0gU2FtcGxlKF9zYW1wbGUpOwogICAgICAgIGppbmdsZUNvbnRyYWN0ID0gSmluZ2xlKF9qaW5nbGUpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBidXlTYW1wbGVzKHVpbnQgX251bVNhbXBsZXMsIGFkZHJlc3MgX3RvKSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZShfbnVtU2FtcGxlcyA8PSBNQVhfU0FNUExFU19QRVJfUFVSQ0hBU0UpOwogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID49IChTQU1QTEVfUFJJQ0UgKiBfbnVtU2FtcGxlcykpOwogICAgICAgIHJlcXVpcmUoX3RvICE9IDB4MCk7CiAgICAgICAgCiAgICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IF9udW1TYW1wbGVzOyArK2kpIHsKICAgICAgICAgICAgCiAgICAgICAgICAgIGJ5dGVzMzIgYmxvY2tIYXNoID0gYmxvY2suYmxvY2toYXNoKGJsb2NrLm51bWJlciAtIDEpOwogICAgICAgICAgICAKICAgICAgICAgICAgdWludCByYW5kb21OdW0gPSByYW5kb21HZW4oYmxvY2tIYXNoLCBpKTsKICAgICAgICAgICAgc2FtcGxlQ29udHJhY3QubWludChfdG8sIHJhbmRvbU51bSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIFB1cmNoYXNlZChfdG8sIGJsb2NrLm51bWJlciwgX251bVNhbXBsZXMsIG51bU9mUHVyY2hhc2VzKTsKICAgICAgICAKICAgICAgICBudW1PZlB1cmNoYXNlcysrOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBjb21wb3NlSmluZ2xlKHN0cmluZyBuYW1lLCB1aW50MzJbNV0gc2FtcGxlcywgdWludDhbMjBdIHNldHRpbmdzKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoamluZ2xlQ29udHJhY3QudW5pcXVlSmluZ2xlcyhrZWNjYWsyNTYoc2FtcGxlcykpID09IGZhbHNlKTsKICAgICAgICAKICAgICAgICB1aW50MzJbNV0gbWVtb3J5IHNhbXBsZVR5cGVzOwogICAgICAgIAogICAgICAgIC8vY2hlY2sgaWYgeW91IG93biBhbGwgdGhlIDUgc2FtcGxlcyAKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBTQU1QTEVTX1BFUl9KSU5HTEU7ICsraSkgewogICAgICAgICAgICBib29sIGlzT3duZXIgPSBzYW1wbGVDb250cmFjdC5pc1Rva2VuT3duZXIoc2FtcGxlc1tpXSwgbXNnLnNlbmRlcik7CiAgICAgICAgICAgIAogICAgICAgICAgICByZXF1aXJlKGlzT3duZXIgPT0gdHJ1ZSAmJiBpc0FscmVhZHlVc2VkW3NhbXBsZXNbaV1dID09IGZhbHNlKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlzQWxyZWFkeVVzZWRbc2FtcGxlc1tpXV0gPSB0cnVlOwogICAgICAgICAgICAKICAgICAgICAgICAgc2FtcGxlVHlwZXNbaV0gPSBzYW1wbGVDb250cmFjdC50b2tlblR5cGUoc2FtcGxlc1tpXSk7CiAgICAgICAgICAgIHNhbXBsZUNvbnRyYWN0LnJlbW92ZVNhbXBsZShtc2cuc2VuZGVyLCBzYW1wbGVzW2ldKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy9jcmVhdGUgYSBuZXcgamluZ2xlIGNvbnRhaW5pbmcgdGhvc2UgNSBzYW1wbGVzCiAgICAgICAgamluZ2xlQ29udHJhY3QuY29tcG9zZUppbmdsZShtc2cuc2VuZGVyLCBzYW1wbGVzLCBzYW1wbGVUeXBlcywgbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcnNbbXNnLnNlbmRlcl0sIHNldHRpbmdzKTsKICAgIH0KICAgIAogICAgLy8gQWRkcmVzc2VzIGNhbiBzZXQgdGhlaXIgbmFtZSB3aGVuIGNvbXBvc2luZyBqaW5nbGVzCiAgICBmdW5jdGlvbiBzZXRBdXRob3JOYW1lKHN0cmluZyBfbmFtZSkgcHVibGljIHsKICAgICAgICBhdXRob3JzW21zZy5zZW5kZXJdID0gX25hbWU7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHJhbmRvbUdlbihieXRlczMyIGJsb2NrSGFzaCwgdWludCBzZWVkKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludCByYW5kb21OdW1iZXIpIHsKICAgICAgICByZXR1cm4gKHVpbnQoa2VjY2FrMjU2KGJsb2NrSGFzaCwgYmxvY2sudGltZXN0YW1wLCBudW1PZlB1cmNoYXNlcywgc2VlZCApKSAlIE5VTV9TQU1QTEVfUkFOR0UpOwogICAgfQogICAgCiAgICAvLyBUaGUgb25seSBldGhlciBrZXB0IG9uIHRoaXMgY29udHJhY3QgYXJlIG93bmVyIG1vbmV5IGZvciBzYW1wbGVzCiAgICBmdW5jdGlvbiB3aXRoZHJhdyh1aW50IF9hbW91bnQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoX2Ftb3VudCA8PSB0aGlzLmJhbGFuY2UpOwogICAgICAgIAogICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoX2Ftb3VudCk7CiAgICB9CiAgICAKfQoKY29udHJhY3QgTWFya2V0cGxhY2UgaXMgT3duYWJsZSB7CiAgICAKICAgIG1vZGlmaWVyIG9ubHlKaW5nbGUoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkZHJlc3MoamluZ2xlQ29udHJhY3QpKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICBzdHJ1Y3QgT3JkZXIgewogICAgICAgIHVpbnQgcHJpY2U7CiAgICAgICAgYWRkcmVzcyBzZWxsZXI7CiAgICAgICAgdWludCB0aW1lc3RhbXA7CiAgICAgICAgYm9vbCBleGlzdHM7CiAgICB9CiAgICAKICAgIGV2ZW50IFNlbGxPcmRlcihhZGRyZXNzIG93bmVyLCB1aW50IGppbmdsZUlkLCB1aW50IHByaWNlKTsKICAgIGV2ZW50IEJvdWdodCh1aW50IGppbmdsZUlkLCBhZGRyZXNzIGJ1eWVyLCB1aW50IHByaWNlKTsKICAgIGV2ZW50IENhbmNlbGVkKGFkZHJlc3Mgb3duZXIsIHVpbnQgamluZ2xlSWQpOwogICAgCiAgICB1aW50IHB1YmxpYyBudW1PcmRlcnM7CiAgICB1aW50IHB1YmxpYyBvd25lckJhbGFuY2U7CiAgICAKICAgIHVpbnQgT1dORVJTX0NVVCA9IDM7IC8vIDMgcGVyY2VudCBvZiBldmVyeSBzYWxlIGdvZXMgdG8gb3duZXIKICAgIAogICAgbWFwcGluZyAodWludCA9PiBPcmRlcikgcHVibGljIHNlbGxPcmRlcnM7CiAgICBtYXBwaW5nKHVpbnQgPT4gdWludCkgcHVibGljIHBvc2l0aW9uT2ZKaW5nbGU7CiAgICAKICAgIHVpbnRbXSBwdWJsaWMgamluZ2xlc09uU2FsZTsKICAgIAogICAgSmluZ2xlIHB1YmxpYyBqaW5nbGVDb250cmFjdDsKICAgIAogICAgZnVuY3Rpb24gTWFya2V0cGxhY2UoYWRkcmVzcyBfamluZ2xlKSBwdWJsaWMgewogICAgICAgIGppbmdsZUNvbnRyYWN0ID0gSmluZ2xlKF9qaW5nbGUpOwogICAgICAgIG93bmVyQmFsYW5jZSA9IDA7CiAgICB9CgogICAgZnVuY3Rpb24gc2VsbChhZGRyZXNzIF9vd25lciwgdWludCBfamluZ2xlSWQsIHVpbnQgX2Ftb3VudCkgcHVibGljIG9ubHlKaW5nbGUgewogICAgICAgIHJlcXVpcmUoX2Ftb3VudCA+IDEwMCk7CiAgICAgICAgcmVxdWlyZShzZWxsT3JkZXJzW19qaW5nbGVJZF0uZXhpc3RzID09IGZhbHNlKTsKICAgICAgICAKICAgICAgICBzZWxsT3JkZXJzW19qaW5nbGVJZF0gPSBPcmRlcih7CiAgICAgICAgICAgcHJpY2U6IF9hbW91bnQsCiAgICAgICAgICAgc2VsbGVyOiBfb3duZXIsCiAgICAgICAgICAgdGltZXN0YW1wOiBub3csCiAgICAgICAgICAgZXhpc3RzOiB0cnVlCiAgICAgICAgfSk7CiAgICAgICAgCiAgICAgICAgbnVtT3JkZXJzKys7CiAgICAgICAgCiAgICAgICAgLy8gc2V0IGZvciBpdGVyYXRpbmcKICAgICAgICBqaW5nbGVzT25TYWxlLnB1c2goX2ppbmdsZUlkKTsKICAgICAgICBwb3NpdGlvbk9mSmluZ2xlW19qaW5nbGVJZF0gPSBqaW5nbGVzT25TYWxlLmxlbmd0aCAtIDE7CiAgICAgICAgCiAgICAgICAgLy90cmFuc2ZlciBvd25lcnNoaXAgCiAgICAgICAgamluZ2xlQ29udHJhY3QudHJhbnNmZXJGcm9tKF9vd25lciwgdGhpcywgX2ppbmdsZUlkKTsKICAgICAgICAKICAgICAgICAvL0ZpcmUgYW4gc2VsbCBldmVudAogICAgICAgIFNlbGxPcmRlcihfb3duZXIsIF9qaW5nbGVJZCwgX2Ftb3VudCk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGJ1eSh1aW50IF9qaW5nbGVJZCkgcHVibGljIHBheWFibGUgewogICAgICAgIHJlcXVpcmUoc2VsbE9yZGVyc1tfamluZ2xlSWRdLmV4aXN0cyA9PSB0cnVlKTsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSBzZWxsT3JkZXJzW19qaW5nbGVJZF0ucHJpY2UpOwogICAgICAgIAogICAgICAgIHNlbGxPcmRlcnNbX2ppbmdsZUlkXS5leGlzdHMgPSBmYWxzZTsKICAgICAgICAKICAgICAgICBudW1PcmRlcnMtLTsKICAgICAgICAKICAgICAgICAvL2RlbGV0ZSBzdHVmZiBmb3IgaXRlcmF0aW5nIAogICAgICAgIHJlbW92ZU9yZGVyKF9qaW5nbGVJZCk7CiAgICAgICAgCiAgICAgICAgLy90cmFuc2ZlciBvd25lcnNoaXAgCiAgICAgICAgamluZ2xlQ29udHJhY3QudHJhbnNmZXIobXNnLnNlbmRlciwgX2ppbmdsZUlkKTsKICAgICAgICAKICAgICAgICAvLyB0cmFuc2ZlciBtb25leSB0byBzZWxsZXIKICAgICAgICB1aW50IHByaWNlID0gc2VsbE9yZGVyc1tfamluZ2xlSWRdLnByaWNlOwogICAgICAgIAogICAgICAgIHVpbnQgdGhyZWVQZXJjZW50ID0gKHByaWNlIC8gMTAwKSAqIE9XTkVSU19DVVQ7CiAgICAgICAgCiAgICAgICAgc2VsbE9yZGVyc1tfamluZ2xlSWRdLnNlbGxlci50cmFuc2ZlcihwcmljZSAtIHRocmVlUGVyY2VudCk7CiAgICAgICAgCiAgICAgICAgb3duZXJCYWxhbmNlICs9IHRocmVlUGVyY2VudDsKICAgICAgICAKICAgICAgICAvL2ZpcmUgYW5kIGV2ZW50CiAgICAgICAgQm91Z2h0KF9qaW5nbGVJZCwgbXNnLnNlbmRlciwgbXNnLnZhbHVlKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gY2FuY2VsKHVpbnQgX2ppbmdsZUlkKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoc2VsbE9yZGVyc1tfamluZ2xlSWRdLmV4aXN0cyA9PSB0cnVlKTsKICAgICAgICByZXF1aXJlKHNlbGxPcmRlcnNbX2ppbmdsZUlkXS5zZWxsZXIgPT0gbXNnLnNlbmRlcik7CiAgICAgICAgCiAgICAgICAgc2VsbE9yZGVyc1tfamluZ2xlSWRdLmV4aXN0cyA9IGZhbHNlOwogICAgICAgIAogICAgICAgIG51bU9yZGVycy0tOwogICAgICAgIAogICAgICAgIC8vZGVsZXRlIHN0dWZmIGZvciBpdGVyYXRpbmcgCiAgICAgICAgcmVtb3ZlT3JkZXIoX2ppbmdsZUlkKTsKICAgICAgICAKICAgICAgICBqaW5nbGVDb250cmFjdC50cmFuc2Zlcihtc2cuc2VuZGVyLCBfamluZ2xlSWQpOwogICAgICAgIAogICAgICAgIC8vZmlyZSBhbmQgZXZlbnQKICAgICAgICBDYW5jZWxlZChtc2cuc2VuZGVyLCBfamluZ2xlSWQpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiByZW1vdmVPcmRlcih1aW50IF9qaW5nbGVJZCkgaW50ZXJuYWwgewogICAgICAgIHVpbnQgbGVuZ3RoID0gamluZ2xlc09uU2FsZS5sZW5ndGg7CiAgICAgICAgdWludCBpbmRleCA9IHBvc2l0aW9uT2ZKaW5nbGVbX2ppbmdsZUlkXTsKICAgICAgICB1aW50IGxhc3RPbmUgPSBqaW5nbGVzT25TYWxlW2xlbmd0aCAtIDFdOwoKICAgICAgICBqaW5nbGVzT25TYWxlW2luZGV4XSA9IGxhc3RPbmU7CiAgICAgICAgcG9zaXRpb25PZkppbmdsZVtsYXN0T25lXSA9IGluZGV4OwoKICAgICAgICBkZWxldGUgamluZ2xlc09uU2FsZVtsZW5ndGggLSAxXTsKICAgICAgICBqaW5nbGVzT25TYWxlLmxlbmd0aC0tOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRBbGxKaW5nbGVzT25TYWxlKCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50W10pIHsKICAgICAgICByZXR1cm4gamluZ2xlc09uU2FsZTsKICAgIH0KICAgIAogICAgLy9Pd25lcnMgZnVuY3Rpb25zIAogICAgZnVuY3Rpb24gd2l0aGRyYXcodWludCBfYW1vdW50KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKF9hbW91bnQgPD0gb3duZXJCYWxhbmNlKTsKICAgICAgICAKICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKF9hbW91bnQpOwogICAgfQogICAgCn0='.
	

]
