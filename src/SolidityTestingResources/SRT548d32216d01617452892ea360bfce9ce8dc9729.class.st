Class {
	#name : #SRT548d32216d01617452892ea360bfce9ce8dc9729,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT548d32216d01617452892ea360bfce9ce8dc9729 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7CgoKY29udHJhY3QgRVJDNzIxIHsKICAgIC8vIFJlcXVpcmVkIG1ldGhvZHMKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiB0b3RhbCk7CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7CiAgICBmdW5jdGlvbiBvd25lck9mKHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBvd25lcik7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiB0YWtlT3duZXJzaGlwKHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsOwoKICAgIC8vIEV2ZW50cwogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHRva2VuSWQpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBhcHByb3ZlZCwgdWludDI1NiB0b2tlbklkKTsKCiAgICAvLyBPcHRpb25hbAogICAgLy8gZnVuY3Rpb24gbmFtZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZyBuYW1lKTsKICAgIC8vIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZyBzeW1ib2wpOwogICAgLy8gZnVuY3Rpb24gdG9rZW5zT2ZPd25lcihhZGRyZXNzIF9vd25lcikgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2W10gdG9rZW5JZHMpOwogICAgLy8gZnVuY3Rpb24gdG9rZW5NZXRhZGF0YSh1aW50MjU2IF90b2tlbklkLCBzdHJpbmcgX3ByZWZlcnJlZFRyYW5zcG9ydCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nIGluZm9VcmwpOwogICAgZnVuY3Rpb24gc3VwcG9ydHNJbnRlcmZhY2UoYnl0ZXM0IF9pbnRlcmZhY2VJRCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChib29sKTsKfQoKCi8qKgogKiBAdGl0bGUgT3duYWJsZQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuCiAqLwpjb250cmFjdCBPd25hYmxlIHsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwoKICAgIC8qKgogICAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICAgKiBhY2NvdW50LgogICAgICovCiAgICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgICAqLwogICAgbW9kaWZpZXIgb25seU93bmVyKCl7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXJ7CiAgICAgICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgICAgICBvd25lciA9IG5ld093bmVyOwogICAgfQp9CgoKLyoqCiAqIEB0aXRsZSBQYXVzYWJsZQogKiBAZGV2IEJhc2UgY29udHJhY3Qgd2hpY2ggYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uCiAqLwpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKICAgIGV2ZW50IFBhdXNlKCk7CgogICAgZXZlbnQgVW5wYXVzZSgpOwoKICAgIGJvb2wgcHVibGljIHBhdXNlZCA9IGZhbHNlOwoKICAgIC8qKgogICAgICogQGRldiBtb2RpZmllciB0byBhbGxvdyBhY3Rpb25zIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgSVMgcGF1c2VkCiAgICAgKi8KICAgIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKXsKICAgICAgICByZXF1aXJlKCFwYXVzZWQpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IG1vZGlmaWVyIHRvIGFsbG93IGFjdGlvbnMgb25seSB3aGVuIHRoZSBjb250cmFjdCBJUyBOT1QgcGF1c2VkCiAgICAgKi8KICAgIG1vZGlmaWVyIHdoZW5QYXVzZWR7CiAgICAgICAgcmVxdWlyZShwYXVzZWQpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gcGF1c2UsIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUKICAgICAqLwogICAgZnVuY3Rpb24gcGF1c2UoKSBwdWJsaWMgb25seU93bmVyIHdoZW5Ob3RQYXVzZWQgewogICAgICAgIHBhdXNlZCA9IHRydWU7CiAgICAgICAgUGF1c2UoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byB1bnBhdXNlLCByZXR1cm5zIHRvIG5vcm1hbCBzdGF0ZQogICAgICovCiAgICBmdW5jdGlvbiB1bnBhdXNlKCkgcHVibGljIG9ubHlPd25lciB3aGVuUGF1c2VkIHsKICAgICAgICBwYXVzZWQgPSBmYWxzZTsKICAgICAgICBVbnBhdXNlKCk7CiAgICB9Cn0KCmxpYnJhcnkgU2FmZU1hdGggewoKICAvKioKICAqIEBkZXYgTXVsdGlwbGllcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICovCiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IEludGVnZXIgZGl2aXNpb24gb2YgdHdvIG51bWJlcnMsIHRydW5jYXRpbmcgdGhlIHF1b3RpZW50LgogICovCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICAvKioKICAqIEBkZXYgU3Vic3RyYWN0cyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93IChpLmUuIGlmIHN1YnRyYWhlbmQgaXMgZ3JlYXRlciB0aGFuIG1pbnVlbmQpLgogICovCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgLyoqCiAgKiBAZGV2IEFkZHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgoKY29udHJhY3QgQ2hlbWlzdHJ5QmFzZSBpcyBPd25hYmxlIHsKICAgIAogICAgc3RydWN0IEVsZW1lbnR7CiAgICAgICAgYnl0ZXMzMiBzeW1ib2w7CiAgICB9CiAgIAogICAgLyoqKiBFVkVOVFMgKioqLwoKICAgIGV2ZW50IENyZWF0ZShhZGRyZXNzIG93bmVyLCB1aW50MjU2IGF0b21pY051bWJlciwgYnl0ZXMzMiBzeW1ib2wpOwogICAgCiAgICAvLy8gQGRldiBUcmFuc2ZlciBldmVudCBhcyBkZWZpbmVkIGluIGN1cnJlbnQgZHJhZnQgb2YgRVJDNzIxLiBFbWl0dGVkIGV2ZXJ5IHRpbWUgYSBlbGVtZW50CiAgICAvLy8gIG93bmVyc2hpcCBpcyBhc3NpZ25lZC4KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB0b2tlbklkKTsKCiAgICAvKioqIENPTlNUQU5UUyAqKiovCiAgICAKICAgIC8vIGN1cnJlbnRseSBrbm93biBudW1iZXIgb2YgZWxlbWVudHMgaW4gcGVyaW9kaWMgdGFibGUKICAgIHVpbnQyNTYgcHVibGljIHRhYmxlU2l6ZSA9IDE3MzsKCiAgICAvKioqIFNUT1JBR0UgKioqLwoKICAgIC8vLyBAZGV2IEFuIGFycmF5IGNvbnRhaW5pbmcgdGhlIGVsZW1lbnQgc3RydWN0IGZvciBhbGwgRWxlbWVudHMgaW4gZXhpc3RlbmNlLiBUaGUgSUQKICAgIC8vLyAgb2YgZWFjaCBlbGVtZW50IGlzIGFjdHVhbGx5IGFuIGluZGV4IG9mIHRoaXMgYXJyYXkuCiAgICBFbGVtZW50W10gcHVibGljIGVsZW1lbnRzOwoKICAgIC8vLyBAZGV2IEEgbWFwcGluZyBmcm9tIGVsZW1lbnQgSURzIHRvIHRoZSBhZGRyZXNzIHRoYXQgb3ducyB0aGVtLiBBbGwgZWxlbWVudHMgaGF2ZQogICAgLy8vICBzb21lIHZhbGlkIG93bmVyIGFkZHJlc3MsIGV2ZW4gbWluZXIgZWxlbWVudHMgYXJlIGNyZWF0ZWQgd2l0aCBhIG5vbi16ZXJvIG93bmVyLgogICAgbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSBwdWJsaWMgZWxlbWVudFRvT3duZXI7CgogICAgLy8gQGRldiBBIG1hcHBpbmcgZnJvbSBvd25lciBhZGRyZXNzIHRvIGNvdW50IG9mIHRva2VucyB0aGF0IGFkZHJlc3Mgb3ducy4KICAgIC8vICBVc2VkIGludGVybmFsbHkgaW5zaWRlIGJhbGFuY2VPZigpIHRvIHJlc29sdmUgb3duZXJzaGlwIGNvdW50LgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBpbnRlcm5hbCBvd25lcnNUb2tlbkNvdW50OwoKICAgIC8vLyBAZGV2IEEgbWFwcGluZyBmcm9tIGVsZW1lbnQgSURzIHRvIGFuIGFkZHJlc3MgdGhhdCBoYXMgYmVlbiBhcHByb3ZlZCB0byBjYWxsCiAgICAvLy8gIHRyYW5zZmVyRnJvbSgpLiBFYWNoIEVsZW1lbnQgY2FuIG9ubHkgaGF2ZSBvbmUgYXBwcm92ZWQgYWRkcmVzcyBmb3IgdHJhbnNmZXIKICAgIC8vLyAgYXQgYW55IHRpbWUuIEEgemVybyB2YWx1ZSBtZWFucyBubyBhcHByb3ZhbCBpcyBvdXRzdGFuZGluZy4KICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgcHVibGljIGVsZW1lbnRUb0FwcHJvdmVkOwogICAgCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBhdXRob3JpemVkOwogICAgCiAgICBtYXBwaW5nICh1aW50MjU2ID0+IHVpbnQyNTYpIHB1YmxpYyBjdXJyZW50UHJpY2U7CiAgICAKCWZ1bmN0aW9uIGFkZEF1dGhvcml6YXRpb24gKGFkZHJlc3MgX2F1dGhvcml6ZWQpIG9ubHlPd25lciBleHRlcm5hbCB7CgkJYXV0aG9yaXplZFtfYXV0aG9yaXplZF0gPSB0cnVlOwoJfQoKCWZ1bmN0aW9uIHJlbW92ZUF1dGhvcml6YXRpb24gKGFkZHJlc3MgX2F1dGhvcml6ZWQpIG9ubHlPd25lciBleHRlcm5hbCB7CgkJZGVsZXRlIGF1dGhvcml6ZWRbX2F1dGhvcml6ZWRdOwoJfQoJCgltb2RpZmllciBvbmx5QXV0aG9yaXplZCgpIHsKCQlyZXF1aXJlKGF1dGhvcml6ZWRbbXNnLnNlbmRlcl0pOwoJCV87Cgl9CiAgICAKICAgIC8vLyBAZGV2IEFzc2lnbnMgb3duZXJzaGlwIG9mIGEgc3BlY2lmaWMgZWxlbWVudCB0byBhbiBhZGRyZXNzLgogICAgZnVuY3Rpb24gX3RyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBpbnRlcm5hbCB7CiAgICAgICAgLy8gU2luY2UgdGhlIG51bWJlciBvZiBlbGVtZW50cyBpcyBjYXBwZWQgdG8gJ251bWJlck9mRWxlbWVudHMnKDE3Mykgd2UgY2FuJ3Qgb3ZlcmZsb3cgdGhpcwogICAgICAgIG93bmVyc1Rva2VuQ291bnRbX3RvXSsrOwogICAgICAgIC8vIHRyYW5zZmVyIG93bmVyc2hpcAogICAgICAgIGVsZW1lbnRUb093bmVyW190b2tlbklkXSA9IF90bzsKICAgICAgICAvLyBXaGVuIGNyZWF0aW5nIG5ldyBlbGVtZW50IF9mcm9tIGlzIDB4MCwgYnV0IHdlIGNhbid0IGFjY291bnQgdGhhdCBhZGRyZXNzLgogICAgICAgIGlmIChfZnJvbSAhPSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIG93bmVyc1Rva2VuQ291bnRbX2Zyb21dLS07CiAgICAgICAgICAgIC8vIGNsZWFyIGFueSBwcmV2aW91c2x5IGFwcHJvdmVkIG93bmVyc2hpcCBleGNoYW5nZQogICAgICAgICAgICBkZWxldGUgZWxlbWVudFRvQXBwcm92ZWRbX3Rva2VuSWRdOwogICAgICAgIH0KICAgICAgICAvLyBFbWl0IHRoZSB0cmFuc2ZlciBldmVudC4KICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgLy8vIEBkZXYgQW4gaW50ZXJuYWwgbWV0aG9kIHRoYXQgY3JlYXRlcyBhIG5ldyBlbGVtZW50IGFuZCBzdG9yZXMgaXQuIFRoaXMKICAgIC8vLyAgbWV0aG9kIGRvZXNuJ3QgZG8gYW55IGNoZWNraW5nIGFuZCBzaG91bGQgb25seSBiZSBjYWxsZWQgd2hlbiB0aGUKICAgIC8vLyAgaW5wdXQgZGF0YSBpcyBrbm93biB0byBiZSB2YWxpZC4gV2lsbCBnZW5lcmF0ZSBib3RoIGEgQXJpc2UgZXZlbnQKICAgIC8vLyAgYW5kIGEgVHJhbnNmZXIgZXZlbnQuCiAgICBmdW5jdGlvbiBfY3JlYXRlRWxlbWVudChieXRlczMyIF9zeW1ib2wsIHVpbnQyNTYgX3ByaWNlKQogICAgICAgIGludGVybmFsCiAgICAgICAgcmV0dXJucyAodWludDI1NikgewogICAgICAgIAkgICAgCiAgICAgICAgYWRkcmVzcyBvd25lciA9IGFkZHJlc3ModGhpcyk7CiAgICAgICAgRWxlbWVudCBtZW1vcnkgX2VsZW1lbnQgPSBFbGVtZW50KHsKICAgICAgICAgICAgc3ltYm9sIDogX3N5bWJvbAogICAgICAgIH0pOwogICAgICAgIHVpbnQyNTYgbmV3RWxlbWVudElkID0gZWxlbWVudHMucHVzaChfZWxlbWVudCkgLSAxOwogICAgICAgIAogICAgICAgIGN1cnJlbnRQcmljZVtuZXdFbGVtZW50SWRdID0gX3ByaWNlOwogICAgICAgIAogICAgICAgIC8vIGVtaXQgdGhlIGNyZWF0ZSBldmVudAogICAgICAgIENyZWF0ZShvd25lciwgbmV3RWxlbWVudElkLCBfc3ltYm9sKTsKICAgICAgICAKICAgICAgICAvLyBUaGlzIHdpbGwgYXNzaWduIG93bmVyc2hpcCwgYW5kIGFsc28gZW1pdCB0aGUgVHJhbnNmZXIgZXZlbnQgYXMKICAgICAgICAvLyBwZXIgRVJDNzIxIGRyYWZ0CiAgICAgICAgX3RyYW5zZmVyKDAsIG93bmVyLCBuZXdFbGVtZW50SWQpOwoKICAgICAgICByZXR1cm4gbmV3RWxlbWVudElkOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBzZXRUYWJsZVNpemUodWludDI1NiBfbmV3U2l6ZSkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICB0YWJsZVNpemUgPSBfbmV3U2l6ZTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIG9ubHlPd25lcnsKICAgICAgICBkZWxldGUgYXV0aG9yaXplZFtvd25lcl07CiAgICAgICAgYXV0aG9yaXplZFtuZXdPd25lcl0gPSB0cnVlOwogICAgICAgIHN1cGVyLnRyYW5zZmVyT3duZXJzaGlwKG5ld093bmVyKTsKICAgIH0KfQoKY29udHJhY3QgRWxlbWVudFRva2VuSW1wbCBpcyBDaGVtaXN0cnlCYXNlLCBFUkM3MjEgewoKICAgIC8vLyBAbm90aWNlIE5hbWUgYW5kIHN5bWJvbCBvZiB0aGUgbm9uIGZ1bmdpYmxlIHRva2VuLCBhcyBkZWZpbmVkIGluIEVSQzcyMS4KICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJDcnlwdG9DaGVtaXN0cnkiOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiQ0MiOwoKICAgIGJ5dGVzNCBjb25zdGFudCBJbnRlcmZhY2VTaWduYXR1cmVfRVJDMTY1ID0KICAgICAgICBieXRlczQoa2VjY2FrMjU2KCdzdXBwb3J0c0ludGVyZmFjZShieXRlczQpJykpOwoKICAgIGJ5dGVzNCBjb25zdGFudCBJbnRlcmZhY2VTaWduYXR1cmVfRVJDNzIxID0KICAgICAgICBieXRlczQoa2VjY2FrMjU2KCduYW1lKCknKSkgXgogICAgICAgIGJ5dGVzNChrZWNjYWsyNTYoJ3N5bWJvbCgpJykpIF4KICAgICAgICBieXRlczQoa2VjY2FrMjU2KCd0b3RhbFN1cHBseSgpJykpIF4KICAgICAgICBieXRlczQoa2VjY2FrMjU2KCdiYWxhbmNlT2YoYWRkcmVzcyknKSkgXgogICAgICAgIGJ5dGVzNChrZWNjYWsyNTYoJ293bmVyT2YodWludDI1NiknKSkgXgogICAgICAgIGJ5dGVzNChrZWNjYWsyNTYoJ2FwcHJvdmUoYWRkcmVzcyx1aW50MjU2KScpKSBeCiAgICAgICAgYnl0ZXM0KGtlY2NhazI1NigndHJhbnNmZXIoYWRkcmVzcyx1aW50MjU2KScpKSBeCiAgICAgICAgYnl0ZXM0KGtlY2NhazI1NigndHJhbnNmZXJGcm9tKGFkZHJlc3MsYWRkcmVzcyx1aW50MjU2KScpKSBeCiAgICAgICAgYnl0ZXM0KGtlY2NhazI1NigndGFrZU93bmVyc2hpcCh1aW50MjU2KScpKSBeCiAgICAgICAgYnl0ZXM0KGtlY2NhazI1NigndG9rZW5zT2ZPd25lcihhZGRyZXNzKScpKTsKCiAgICAvLy8gQG5vdGljZSBJbnRyb3NwZWN0aW9uIGludGVyZmFjZSBhcyBwZXIgRVJDLTE2NSAoaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE2NSkuCiAgICAvLy8gIFJldHVybnMgdHJ1ZSBmb3IgYW55IHN0YW5kYXJkaXplZCBpbnRlcmZhY2VzIGltcGxlbWVudGVkIGJ5IHRoaXMgY29udHJhY3QuIFdlIGltcGxlbWVudAogICAgLy8vICBFUkMtMTY1IGFuZCBFUkMtNzIxLgogICAgZnVuY3Rpb24gc3VwcG9ydHNJbnRlcmZhY2UoYnl0ZXM0IF9pbnRlcmZhY2VJRCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHJldHVybiAoKF9pbnRlcmZhY2VJRCA9PSBJbnRlcmZhY2VTaWduYXR1cmVfRVJDMTY1KSB8fCAoX2ludGVyZmFjZUlEID09IEludGVyZmFjZVNpZ25hdHVyZV9FUkM3MjEpKTsKICAgIH0KCiAgICAvKiogQGRldiBDaGVja3MgaWYgYSBnaXZlbiBhZGRyZXNzIGlzIHRoZSBjdXJyZW50IG93bmVyIG9mIHRoZSBzcGVjaWZpZWQgRWxlbWVudCB0b2tlbklkLgogICAgICogQHBhcmFtIF9jbGFpbWFudCB0aGUgYWRkcmVzcyB3ZSBhcmUgdmFsaWRhdGluZyBhZ2FpbnN0LgogICAgICogQHBhcmFtIF90b2tlbklkIGVsZW1lbnQgaWQKICAgICAqLwogICAgZnVuY3Rpb24gX293bnMoYWRkcmVzcyBfY2xhaW1hbnQsIHVpbnQyNTYgX3Rva2VuSWQpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBlbGVtZW50VG9Pd25lcltfdG9rZW5JZF0gPT0gX2NsYWltYW50OyAgICAKICAgIH0KCiAgICBmdW5jdGlvbiBfb3duZXJBcHByb3ZlZChhZGRyZXNzIF9jbGFpbWFudCwgdWludDI1NiBfdG9rZW5JZCkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIGVsZW1lbnRUb093bmVyW190b2tlbklkXSA9PSBfY2xhaW1hbnQgJiYgZWxlbWVudFRvQXBwcm92ZWRbX3Rva2VuSWRdID09IGFkZHJlc3MoMCk7ICAgIAogICAgfQoKICAgIC8vLyBAZGV2IENoZWNrcyBpZiBhIGdpdmVuIGFkZHJlc3MgY3VycmVudGx5IGhhcyB0cmFuc2ZlckFwcHJvdmFsIGZvciBhIHBhcnRpY3VsYXIgZWxlbWVudC4KICAgIC8vLyBAcGFyYW0gX2NsYWltYW50IHRoZSBhZGRyZXNzIHdlIGFyZSBjb25maXJtaW5nIGVsZW1lbnQgaXMgYXBwcm92ZWQgZm9yLgogICAgLy8vIEBwYXJhbSBfdG9rZW5JZCBlbGVtZW50IGlkCiAgICBmdW5jdGlvbiBfYXBwcm92ZWRGb3IoYWRkcmVzcyBfY2xhaW1hbnQsIHVpbnQyNTYgX3Rva2VuSWQpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBlbGVtZW50VG9BcHByb3ZlZFtfdG9rZW5JZF0gPT0gX2NsYWltYW50OwogICAgfQoKICAgIC8vLyBAZGV2IE1hcmtzIGFuIGFkZHJlc3MgYXMgYmVpbmcgYXBwcm92ZWQgZm9yIHRyYW5zZmVyRnJvbSgpLCBvdmVyd3JpdGluZyBhbnkgcHJldmlvdXMKICAgIC8vLyAgYXBwcm92YWwuIFNldHRpbmcgX2FwcHJvdmVkIHRvIGFkZHJlc3MoMCkgY2xlYXJzIGFsbCB0cmFuc2ZlciBhcHByb3ZhbC4KICAgIC8vLyAgTk9URTogX2FwcHJvdmUoKSBkb2VzIE5PVCBzZW5kIHRoZSBBcHByb3ZhbCBldmVudC4KICAgIGZ1bmN0aW9uIF9hcHByb3ZlKHVpbnQyNTYgX3Rva2VuSWQsIGFkZHJlc3MgX2FwcHJvdmVkKSBpbnRlcm5hbCB7CiAgICAgICAgZWxlbWVudFRvQXBwcm92ZWRbX3Rva2VuSWRdID0gX2FwcHJvdmVkOwogICAgfQoKICAgIC8vLyBAbm90aWNlIFJldHVybnMgdGhlIG51bWJlciBvZiB0b2tlbnMgb3duZWQgYnkgYSBzcGVjaWZpYyBhZGRyZXNzLgogICAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIG93bmVyIGFkZHJlc3MgdG8gY2hlY2suCiAgICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgY291bnQpIHsKICAgICAgICByZXR1cm4gb3duZXJzVG9rZW5Db3VudFtfb3duZXJdOwogICAgfQoKICAgIC8vLyBAbm90aWNlIFRyYW5zZmVycyBhIGVsZW1lbnQgdG8gYW5vdGhlciBhZGRyZXNzCiAgICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50LCBjYW4gYmUgYSB1c2VyIG9yIGNvbnRyYWN0LgogICAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgSUQgb2YgdGhlIGVsZW1lbnQgdG8gdHJhbnNmZXIuCiAgICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsIHsKICAgICAgICAvLyBTYWZldHkgY2hlY2sgdG8gcHJldmVudCBhZ2FpbnN0IGFuIHVuZXhwZWN0ZWQgMHgwIGRlZmF1bHQuCiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgLy8gRGlzYWxsb3cgdHJhbnNmZXJzIHRvIHRoaXMgY29udHJhY3QgdG8gcHJldmVudCBhY2NpZGVudGFsIG1pc3VzZS4KICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKHRoaXMpKTsKCiAgICAgICAgLy8gWW91IGNhbiBvbmx5IHNlbmQgeW91ciBvd24gZWxlbWVudC4KICAgICAgICByZXF1aXJlKF9vd25zKG1zZy5zZW5kZXIsIF90b2tlbklkKSk7CgogICAgICAgIC8vIFJlYXNzaWduIG93bmVyc2hpcCwgY2xlYXIgcGVuZGluZyBhcHByb3ZhbHMsIGVtaXQgVHJhbnNmZXIgZXZlbnQuCiAgICAgICAgX3RyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3Rva2VuSWQpOwogICAgfQoKICAgIC8vLyBAbm90aWNlIEdyYW50IGFub3RoZXIgYWRkcmVzcyB0aGUgcmlnaHQgdG8gdHJhbnNmZXIgYSBzcGVjaWZpYyBlbGVtZW50IHZpYQogICAgLy8vICB0cmFuc2ZlckZyb20oKS4gVGhpcyBpcyB0aGUgcHJlZmVycmVkIGZsb3cgZm9yIHRyYW5zZmVyaW5nIE5GVHMgdG8gY29udHJhY3RzLgogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gYmUgZ3JhbnRlZCB0cmFuc2ZlciBhcHByb3ZhbC4gUGFzcyBhZGRyZXNzKDApIHRvCiAgICAvLy8gIGNsZWFyIGFsbCBhcHByb3ZhbHMuCiAgICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSBJRCBvZiB0aGUgZWxlbWVudCB0aGF0IGNhbiBiZSB0cmFuc2ZlcnJlZCBpZiB0aGlzIGNhbGwgc3VjY2VlZHMuCiAgICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWwgewogICAgICAgIC8vIE9ubHkgYW4gb3duZXIgY2FuIGdyYW50IHRyYW5zZmVyIGFwcHJvdmFsLgogICAgICAgIHJlcXVpcmUoX293bnMobXNnLnNlbmRlciwgX3Rva2VuSWQpKTsKCiAgICAgICAgLy8gUmVnaXN0ZXIgdGhlIGFwcHJvdmFsIChyZXBsYWNpbmcgYW55IHByZXZpb3VzIGFwcHJvdmFsKS4KICAgICAgICBfYXBwcm92ZShfdG9rZW5JZCwgX3RvKTsKCiAgICAgICAgLy8gRW1pdCBhcHByb3ZhbCBldmVudC4KICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfdG8sIF90b2tlbklkKTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBUcmFuc2ZlciBhIGVsZW1lbnQgb3duZWQgYnkgYW5vdGhlciBhZGRyZXNzLCBmb3Igd2hpY2ggdGhlIGNhbGxpbmcgYWRkcmVzcwogICAgLy8vICBoYXMgcHJldmlvdXNseSBiZWVuIGdyYW50ZWQgdHJhbnNmZXIgYXBwcm92YWwgYnkgdGhlIG93bmVyLgogICAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyB0aGF0IG93bnMgdGhlIGVsZW1lbnQgdG8gYmUgdHJhbnNmZXJlZC4KICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgc2hvdWxkIHRha2Ugb3duZXJzaGlwIG9mIHRoZSBlbGVtZW50LiBDYW4gYmUgYW55IGFkZHJlc3MsCiAgICAvLy8gIGluY2x1ZGluZyB0aGUgY2FsbGVyLgogICAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgSUQgb2YgdGhlIGVsZW1lbnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKQogICAgICAgIGV4dGVybmFsCiAgICB7CiAgICAgICAgLy8gU2FmZXR5IGNoZWNrIHRvIHByZXZlbnQgYWdhaW5zdCBhbiB1bmV4cGVjdGVkIDB4MCBkZWZhdWx0LgogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIC8vIERpc2FsbG93IHRyYW5zZmVycyB0byB0aGlzIGNvbnRyYWN0IHRvIHByZXZlbnQgYWNjaWRlbnRhbCBtaXN1c2UuCiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcyh0aGlzKSk7CiAgICAgICAgLy8gQ2hlY2sgZm9yIGFwcHJvdmFsIGFuZCB2YWxpZCBvd25lcnNoaXAKICAgICAgICByZXF1aXJlKF9hcHByb3ZlZEZvcihtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwogICAgICAgIHJlcXVpcmUoX293bnMoX2Zyb20sIF90b2tlbklkKSk7CgogICAgICAgIC8vIFJlYXNzaWduIG93bmVyc2hpcCAoYWxzbyBjbGVhcnMgcGVuZGluZyBhcHByb3ZhbHMgYW5kIGVtaXRzIFRyYW5zZmVyIGV2ZW50KS4KICAgICAgICBfdHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogICAgfQoKICAgIC8vLyBAbm90aWNlIFJldHVybnMgdGhlIHRvdGFsIG51bWJlciBvZiB0b2tlbnMgY3VycmVudGx5IGluIGV4aXN0ZW5jZS4KICAgIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gZWxlbWVudHMubGVuZ3RoOwogICAgfQoKICAgIC8vLyBAbm90aWNlIFJldHVybnMgdGhlIGFkZHJlc3MgY3VycmVudGx5IGFzc2lnbmVkIG93bmVyc2hpcCBvZiBhIGdpdmVuIGVsZW1lbnQuCiAgICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogICAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF90b2tlbklkKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnMgKGFkZHJlc3Mgb3duZXIpCiAgICB7CiAgICAgICAgb3duZXIgPSBlbGVtZW50VG9Pd25lcltfdG9rZW5JZF07CgogICAgICAgIHJlcXVpcmUob3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWwgewogICAgICAgIGFkZHJlc3MgX2Zyb20gPSBlbGVtZW50VG9Pd25lcltfdG9rZW5JZF07CiAgICAgICAgCiAgICAgICAgLy8gQ2hlY2sgZm9yIGFwcHJvdmFsIGFuZCB2YWxpZCBvd25lcnNoaXAKICAgICAgICByZXF1aXJlKF9hcHByb3ZlZEZvcihtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwogICAgICAgIHJlcXVpcmUoX2Zyb20gIT0gYWRkcmVzcygwKSk7CgogICAgICAgIC8vIFJlYXNzaWduIG93bmVyc2hpcCAoYWxzbyBjbGVhcnMgcGVuZGluZyBhcHByb3ZhbHMgYW5kIGVtaXRzIFRyYW5zZmVyIGV2ZW50KS4KICAgICAgICBfdHJhbnNmZXIoX2Zyb20sIG1zZy5zZW5kZXIsIF90b2tlbklkKTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBSZXR1cm5zIGEgbGlzdCBvZiBhbGwgZWxlbWVudCBJRHMgYXNzaWduZWQgdG8gYW4gYWRkcmVzcy4KICAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBvd25lciB3aG9zZSB0b2tlbnMgd2UgYXJlIGludGVyZXN0ZWQgaW4uCiAgICBmdW5jdGlvbiB0b2tlbnNPZk93bmVyKGFkZHJlc3MgX293bmVyKSBleHRlcm5hbCB2aWV3IHJldHVybnModWludDI1NltdIG93bmVyVG9rZW5zKSB7CiAgICAgICAgdWludDI1NiB0b2tlbkNvdW50ID0gYmFsYW5jZU9mKF9vd25lcik7CgogICAgICAgIGlmICh0b2tlbkNvdW50ID09IDApIHsKICAgICAgICAgICAgLy8gUmV0dXJuIGFuIGVtcHR5IGFycmF5CiAgICAgICAgICAgIHJldHVybiBuZXcgdWludDI1NltdKDApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHVpbnQyNTZbXSBtZW1vcnkgcmVzdWx0ID0gbmV3IHVpbnQyNTZbXSh0b2tlbkNvdW50KTsKICAgICAgICAgICAgdWludDI1NiB0b3RhbEVsZW1lbnRzID0gdG90YWxTdXBwbHkoKTsKICAgICAgICAgICAgdWludDI1NiByZXN1bHRJbmRleCA9IDA7CgogICAgICAgICAgICB1aW50MjU2IGVsZW1lbnRJZDsKCiAgICAgICAgICAgIGZvciAoZWxlbWVudElkID0gMDsgZWxlbWVudElkIDwgdG90YWxFbGVtZW50czsgZWxlbWVudElkKyspIHsKICAgICAgICAgICAgICAgIGlmIChlbGVtZW50VG9Pd25lcltlbGVtZW50SWRdID09IF9vd25lcikgewogICAgICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHRJbmRleF0gPSBlbGVtZW50SWQ7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0SW5kZXgrKzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgICB9CiAgICB9CiAgICAKfQoKY29udHJhY3QgQ29udHJhY3RPZlNhbGUgaXMgRWxlbWVudFRva2VuSW1wbCB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKICAgIAogIAlldmVudCBTb2xkICh1aW50MjU2IGVsZW1lbnRJZCwgYWRkcmVzcyBvbGRPd25lciwgYWRkcmVzcyBuZXdPd25lciwgdWludDI1NiBwcmljZSk7CiAgCQogIAl1aW50MjU2IHByaXZhdGUgY29uc3RhbnQgTElNSVRfMSA9IDIwIGZpbm5leTsKICAJdWludDI1NiBwcml2YXRlIGNvbnN0YW50IExJTUlUXzIgPSA1MDAgZmlubmV5OwogIAl1aW50MjU2IHByaXZhdGUgY29uc3RhbnQgTElNSVRfMyA9IDIwMDAgZmlubmV5OwogIAl1aW50MjU2IHByaXZhdGUgY29uc3RhbnQgTElNSVRfNCA9IDUwMDAgZmlubmV5OwogIAkKICAJLyogQnV5aW5nICovCiAgCWZ1bmN0aW9uIGNhbGN1bGF0ZU5leHRQcmljZSAodWludDI1NiBfcHJpY2UpIHB1YmxpYyBwdXJlIHJldHVybnMgKHVpbnQyNTYgX25leHRQcmljZSkgewoJICAgIGlmIChfcHJpY2UgPCBMSU1JVF8xKSB7CgkgICAgICByZXR1cm4gX3ByaWNlLm11bCgyKTsvLzEwMCUKCSAgICB9IGVsc2UgaWYgKF9wcmljZSA8IExJTUlUXzIpIHsKCSAgICAgIHJldHVybiBfcHJpY2UubXVsKDEzNTAwKS5kaXYoMTAwMDApOy8vMzUlCgkgICAgfSBlbHNlIGlmIChfcHJpY2UgPCBMSU1JVF8zKSB7CgkgICAgICByZXR1cm4gX3ByaWNlLm11bCgxMjUwMCkuZGl2KDEwMDAwKTsvLzI1JQoJICAgIH0gZWxzZSBpZiAoX3ByaWNlIDwgTElNSVRfNCkgewoJICAgICAgcmV0dXJuIF9wcmljZS5tdWwoMTE3MDApLmRpdigxMDAwMCk7Ly8xNyUKCSAgICB9IGVsc2UgewoJICAgICAgcmV0dXJuIF9wcmljZS5tdWwoMTE1MDApLmRpdigxMDAwMCk7Ly8xNSUKCSAgICB9CiAgCX0KCglmdW5jdGlvbiBfY2FsY3VsYXRlT3duZXJDdXQgKHVpbnQyNTYgX3ByaWNlKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYgX2RldkN1dCkgewoJCWlmIChfcHJpY2UgPCBMSU1JVF8xKSB7CgkgICAgICByZXR1cm4gX3ByaWNlLm11bCgxNTAwKS5kaXYoMTAwMDApOyAvLyAxNSUKCSAgICB9IGVsc2UgaWYgKF9wcmljZSA8IExJTUlUXzIpIHsKCSAgICAgIHJldHVybiBfcHJpY2UubXVsKDUwMCkuZGl2KDEwMDAwKTsgLy8gNSUKCSAgICB9IGVsc2UgaWYgKF9wcmljZSA8IExJTUlUXzMpIHsKCSAgICAgIHJldHVybiBfcHJpY2UubXVsKDQwMCkuZGl2KDEwMDAwKTsgLy8gNCUKCSAgICB9IGVsc2UgaWYgKF9wcmljZSA8IExJTUlUXzQpIHsKCSAgICAgIHJldHVybiBfcHJpY2UubXVsKDMwMCkuZGl2KDEwMDAwKTsgLy8gMyUKCSAgICB9IGVsc2UgewoJICAgICAgcmV0dXJuIF9wcmljZS5tdWwoMjAwKS5kaXYoMTAwMDApOyAvLyAyJQoJICAgIH0KICAJfQoKCWZ1bmN0aW9uIGJ1eSAodWludDI1NiBfaXRlbUlkKSBleHRlcm5hbCBwYXlhYmxlewogICAgICAgIHVpbnQyNTYgcHJpY2UgPSBjdXJyZW50UHJpY2VbX2l0ZW1JZF07CgkgICAgLy8KICAgICAgICByZXF1aXJlKGN1cnJlbnRQcmljZVtfaXRlbUlkXSA+IDApOwogICAgICAgIC8vCiAgICAgICAgcmVxdWlyZShlbGVtZW50VG9Pd25lcltfaXRlbUlkXSAhPSBhZGRyZXNzKDApKTsKICAgICAgICAvLwogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID49IHByaWNlKTsKICAgICAgICAvLwogICAgICAgIHJlcXVpcmUoZWxlbWVudFRvT3duZXJbX2l0ZW1JZF0gIT0gbXNnLnNlbmRlcik7CiAgICAgICAgLy8KICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgCiAgICAgICAgYWRkcmVzcyBvbGRPd25lciA9IGVsZW1lbnRUb093bmVyW19pdGVtSWRdOwogICAgICAgIC8vCiAgICAgICAgYWRkcmVzcyBuZXdPd25lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgLy8KICAgICAgICAvLwogICAgICAgIHVpbnQyNTYgZXhjZXNzID0gbXNnLnZhbHVlLnN1YihwcmljZSk7CiAgICAgICAgLy8KICAgICAgICBfdHJhbnNmZXIob2xkT3duZXIsIG5ld093bmVyLCBfaXRlbUlkKTsKICAgICAgICAvLwogICAgICAgIGN1cnJlbnRQcmljZVtfaXRlbUlkXSA9IGNhbGN1bGF0ZU5leHRQcmljZShwcmljZSk7CiAgICAgICAgCiAgICAgICAgU29sZChfaXRlbUlkLCBvbGRPd25lciwgbmV3T3duZXIsIHByaWNlKTsKCiAgICAgICAgdWludDI1NiBvd25lckN1dCA9IF9jYWxjdWxhdGVPd25lckN1dChwcmljZSk7CgogICAgICAgIG9sZE93bmVyLnRyYW5zZmVyKHByaWNlLnN1Yihvd25lckN1dCkpOwogICAgICAgIGlmIChleGNlc3MgPiAwKSB7CiAgICAgICAgICAgIG5ld093bmVyLnRyYW5zZmVyKGV4Y2Vzcyk7CiAgICAgICAgfQogICAgfQogICAgCglmdW5jdGlvbiBwcmljZU9mRWxlbWVudCh1aW50MjU2IF9lbGVtZW50SWQpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NiBfcHJpY2UpIHsKCQlyZXR1cm4gY3VycmVudFByaWNlW19lbGVtZW50SWRdOwoJfQoKCWZ1bmN0aW9uIHByaWNlT2ZFbGVtZW50cyh1aW50MjU2W10gX2VsZW1lbnRJZHMpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NltdIF9wcmljZXMpIHsKCSAgICB1aW50MjU2IGxlbmd0aCA9IF9lbGVtZW50SWRzLmxlbmd0aDsKCSAgICBfcHJpY2VzID0gbmV3IHVpbnQyNTZbXShsZW5ndGgpOwoJICAgIAoJICAgIGZvcih1aW50MjU2IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKCSAgICAgICAgX3ByaWNlc1tpXSA9IGN1cnJlbnRQcmljZVtfZWxlbWVudElkc1tpXV07CgkgICAgfQoJfQoKCWZ1bmN0aW9uIG5leHRQcmljZU9mRWxlbWVudCh1aW50MjU2IF9pdGVtSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgX25leHRQcmljZSkgewoJCXJldHVybiBjYWxjdWxhdGVOZXh0UHJpY2UoY3VycmVudFByaWNlW19pdGVtSWRdKTsKCX0KCn0KCmNvbnRyYWN0IENoZW1pc3RyeUNvcmUgaXMgQ29udHJhY3RPZlNhbGUgewogICAgCiAgICBmdW5jdGlvbiBDaGVtaXN0cnlDb3JlKCkgcHVibGljIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgYXV0aG9yaXplZFttc2cuc2VuZGVyXSA9IHRydWU7CiAgICAgICAgCiAgICAgICAgX2NyZWF0ZUVsZW1lbnQoIjAiLCAyICoqIDI1NSk7Ly9waGlsb3NvcGhlcnMgc3RvbmUgaXMgcHJpY2VsZXNzCiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGFkZEVsZW1lbnQoYnl0ZXMzMiBfc3ltYm9sKSBleHRlcm5hbCBvbmx5QXV0aG9yaXplZCgpIHsKICAgICAgICB1aW50MjU2IGVsZW1lbnRJZCA9IGVsZW1lbnRzLmxlbmd0aCArIDE7CiAgICAgICAgCiAgICAgICAgcmVxdWlyZShjdXJyZW50UHJpY2VbZWxlbWVudElkXSA9PSAwKTsKICAgICAgICByZXF1aXJlKGVsZW1lbnRUb093bmVyW2VsZW1lbnRJZF0gPT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShlbGVtZW50SWQgPD0gdGFibGVTaXplICsgMSk7CiAgICAgICAgCiAgICAgICAgX2NyZWF0ZUVsZW1lbnQoX3N5bWJvbCwgMSBmaW5uZXkpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBhZGRFbGVtZW50cyhieXRlczMyW10gX3N5bWJvbHMpIGV4dGVybmFsIG9ubHlBdXRob3JpemVkKCkgewogICAgICAgIHVpbnQyNTYgZWxlbWVudElkID0gZWxlbWVudHMubGVuZ3RoICsgMTsKICAgICAgICAKICAgICAgICB1aW50MjU2IGxlbmd0aCA9IF9zeW1ib2xzLmxlbmd0aDsKICAgICAgICB1aW50MjU2IHNpemUgPSB0YWJsZVNpemUgKyAxOwogICAgICAgIGZvcih1aW50MjU2IGkgPSAwOyBpIDwgbGVuZ3RoOyBpICsrKSB7CiAgICAgICAgICAgIAogICAgICAgICAgICByZXF1aXJlKGN1cnJlbnRQcmljZVtlbGVtZW50SWRdID09IDApOwogICAgICAgICAgICByZXF1aXJlKGVsZW1lbnRUb093bmVyW2VsZW1lbnRJZF0gPT0gYWRkcmVzcygwKSk7CiAgICAgICAgICAgIHJlcXVpcmUoZWxlbWVudElkIDw9IHNpemUpOwogICAgICAgICAgICAKICAgICAgICAgICAgX2NyZWF0ZUVsZW1lbnQoX3N5bWJvbHNbaV0sIDEgZmlubmV5KTsKICAgICAgICAgICAgZWxlbWVudElkKys7CiAgICAgICAgfQogICAgICAgIAogICAgfQoKICAgIGZ1bmN0aW9uIHdpdGhkcmF3QWxsKCkgb25seU93bmVyKCkgZXh0ZXJuYWwgewogICAgICAgIG93bmVyLnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgICB9CgogICAgZnVuY3Rpb24gd2l0aGRyYXdBbW91bnQodWludDI1NiBfYW1vdW50KSBvbmx5T3duZXIoKSBleHRlcm5hbCB7CiAgICAgICAgb3duZXIudHJhbnNmZXIoX2Ftb3VudCk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uKCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkZHJlc3ModGhpcykpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRFbGVtZW50c0Zyb21JbmRleCh1aW50MzIgaW5kZXhGcm9tLCB1aW50MzIgY291bnQpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYnl0ZXMzMltdIG1lbW9yeSBlbGVtZW50c0RhdGEpIHsKICAgICAgICAvL2NoZWNrIGxlbmd0aAogICAgICAgIHVpbnQyNTYgbGVuZ2h0ID0gKGVsZW1lbnRzLmxlbmd0aCAtIGluZGV4RnJvbSA+PSBjb3VudCA/IGNvdW50IDogZWxlbWVudHMubGVuZ3RoIC0gaW5kZXhGcm9tKTsKICAgICAgICAKICAgICAgICBlbGVtZW50c0RhdGEgPSBuZXcgYnl0ZXMzMltdKGxlbmdodCk7CiAgICAgICAgZm9yKHVpbnQyNTYgaSA9IDA7IGkgPCBsZW5naHQ7IGkgKyspIHsKICAgICAgICAgICAgZWxlbWVudHNEYXRhW2ldID0gZWxlbWVudHNbaW5kZXhGcm9tICsgaV0uc3ltYm9sOwogICAgICAgIH0KICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0RWxlbWVudE93bmVycyh1aW50MjU2W10gX2VsZW1lbnRJZHMpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYWRkcmVzc1tdIG1lbW9yeSBvd25lcnMpIHsKICAgICAgICB1aW50MjU2IGxlbmdodCA9IF9lbGVtZW50SWRzLmxlbmd0aDsKICAgICAgICBvd25lcnMgPSBuZXcgYWRkcmVzc1tdKGxlbmdodCk7CiAgICAgICAgCiAgICAgICAgZm9yKHVpbnQyNTYgaSA9IDA7IGkgPCBsZW5naHQ7IGkgKyspIHsKICAgICAgICAgICAgb3duZXJzW2ldID0gZWxlbWVudFRvT3duZXJbX2VsZW1lbnRJZHNbaV1dOwogICAgICAgIH0KICAgIH0KICAgIAoJZnVuY3Rpb24gZ2V0RWxlbWVudFZpZXcodWludDI1NiBfaWQpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoc3RyaW5nIHN5bWJvbCkgewoJCXN5bWJvbCA9IF9ieXRlczMyVG9TdHJpbmcoZWxlbWVudHNbX2lkXS5zeW1ib2wpOwogICAgfQoJCglmdW5jdGlvbiBnZXRFbGVtZW50KHVpbnQyNTYgX2lkKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGJ5dGVzMzIgc3ltYm9sKSB7CgkJc3ltYm9sID0gZWxlbWVudHNbX2lkXS5zeW1ib2w7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGdldEVsZW1lbnRzKHVpbnQyNTZbXSBfZWxlbWVudElkcykgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChieXRlczMyW10gbWVtb3J5IGVsZW1lbnRzRGF0YSkgewogICAgICAgIGVsZW1lbnRzRGF0YSA9IG5ldyBieXRlczMyW10oX2VsZW1lbnRJZHMubGVuZ3RoKTsKICAgICAgICBmb3IodWludDI1NiBpID0gMDsgaSA8IF9lbGVtZW50SWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGVsZW1lbnRzRGF0YVtpXSA9IGVsZW1lbnRzW19lbGVtZW50SWRzW2ldXS5zeW1ib2w7CiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRFbGVtZW50SW5mb1ZpZXcodWludDI1NiBfaXRlbUlkKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGFkZHJlc3MgX293bmVyLCB1aW50MjU2IF9wcmljZSwgdWludDI1NiBfbmV4dFByaWNlLCBzdHJpbmcgX3N5bWJvbCkgewoJICAgIF9wcmljZSA9IGN1cnJlbnRQcmljZVtfaXRlbUlkXTsKCQlyZXR1cm4gKGVsZW1lbnRUb093bmVyW19pdGVtSWRdLCBfcHJpY2UsIGNhbGN1bGF0ZU5leHRQcmljZShfcHJpY2UpLCBfYnl0ZXMzMlRvU3RyaW5nKGVsZW1lbnRzW19pdGVtSWRdLnN5bWJvbCkpOwoJfQogICAgCiAgICBmdW5jdGlvbiBnZXRFbGVtZW50SW5mbyh1aW50MjU2IF9pdGVtSWQpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBfb3duZXIsIHVpbnQyNTYgX3ByaWNlLCB1aW50MjU2IF9uZXh0UHJpY2UsIGJ5dGVzMzIgX3N5bWJvbCkgewoJICAgIF9wcmljZSA9IGN1cnJlbnRQcmljZVtfaXRlbUlkXTsKCQlyZXR1cm4gKGVsZW1lbnRUb093bmVyW19pdGVtSWRdLCBfcHJpY2UsIGNhbGN1bGF0ZU5leHRQcmljZShfcHJpY2UpLCBlbGVtZW50c1tfaXRlbUlkXS5zeW1ib2wpOwoJfQogICAgCiAgICBmdW5jdGlvbiBfYnl0ZXMzMlRvU3RyaW5nKGJ5dGVzMzIgZGF0YSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChzdHJpbmcpIHsKICAgICAgICBieXRlcyBtZW1vcnkgYnl0ZXNTdHJpbmcgPSBuZXcgYnl0ZXMoMzIpOwogICAgICAgIHVpbnQgY2hhckNvdW50ID0gMDsKICAgICAgICBmb3IgKHVpbnQgaiA9IDA7IGogPCAzMjsgaisrKSB7CiAgICAgICAgICAgIGJ5dGUgY2hhciA9IGJ5dGUoYnl0ZXMzMih1aW50MjU2KGRhdGEpICogMiAqKiAoOCAqIGopKSk7CiAgICAgICAgICAgIGlmIChjaGFyICE9IDApIHsKICAgICAgICAgICAgICAgIGJ5dGVzU3RyaW5nW2NoYXJDb3VudF0gPSBjaGFyOwogICAgICAgICAgICAgICAgY2hhckNvdW50Kys7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgYnl0ZXMgbWVtb3J5IGJ5dGVzU3RyaW5nVHJpbW1lZCA9IG5ldyBieXRlcyhjaGFyQ291bnQpOwogICAgICAgIGZvciAoaiA9IDA7IGogPCBjaGFyQ291bnQ7IGorKykgewogICAgICAgICAgICBieXRlc1N0cmluZ1RyaW1tZWRbal0gPSBieXRlc1N0cmluZ1tqXTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN0cmluZyhieXRlc1N0cmluZ1RyaW1tZWQpOwogICAgfQp9'.
	

]
