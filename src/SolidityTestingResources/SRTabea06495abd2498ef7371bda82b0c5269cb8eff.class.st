Class {
	#name : #SRTabea06495abd2498ef7371bda82b0c5269cb8eff,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTabea06495abd2498ef7371bda82b0c5269cb8eff >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgoKLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLwovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09RVJDNzIxIGludGVyZmFjZT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLwovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovCgovLy8gQHRpdGxlIEludGVyZmFjZSBmb3IgY29udHJhY3RzIGNvbmZvcm1pbmcgdG8gRVJDLTcyMTogTm9uLUZ1bmdpYmxlIFRva2VucwovLy8gQGF1dGhvciBZdW1pbi55YW5nCmNvbnRyYWN0IEVSQzcyMSB7CiAgICAvLyBSZXF1aXJlZCBtZXRob2RzCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgdG90YWwpOwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwogICAgLy9mdW5jdGlvbiBvd25lck9mKHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBvd25lcik7CiAgICAvL2Z1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsOwogICAgLy9mdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsOwoKICAgIC8vIEV2ZW50cwogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHRva2VuSWQpOwogICAgLy9ldmVudCBBcHByb3ZhbChhZGRyZXNzIG93bmVyLCBhZGRyZXNzIGFwcHJvdmVkLCB1aW50MjU2IHRva2VuSWQpOwoKfQoKCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PUZvcmV2ZXIgUm9zZT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLwovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovCgovLy8gQHRpdGxlIEludGVyZmFjZSBmb3IgY29udHJhY3RzIGNvbmZvcm1pbmcgdG8gRVJDLTcyMTogTm9uLUZ1bmdpYmxlIFRva2VucwovLy8gQGF1dGhvciBZdW1pbi55YW5nCmNvbnRyYWN0IERpdmlzaWJsZUZvcmV2ZXJSb3NlIGlzIEVSQzcyMSB7CiAgCiAgICAvL1RoaXMgY29udHJhY3QncyBvd25lcgogICAgYWRkcmVzcyBwcml2YXRlIGNvbnRyYWN0T3duZXI7CgogICAgCiAgICAvL0dpZnQgdG9rZW4gc3RvcmFnZS4KICAgIG1hcHBpbmcodWludCA9PiBHaWZ0VG9rZW4pIGdpZnRTdG9yYWdlOwoKICAgIC8vIFRvdGFsIHN1cHBseSBvZiB0aGlzIHRva2VuLiAKCXVpbnQgcHVibGljIHRvdGFsU3VwcGx5ID0gMTA7IAoKICAgIGJvb2wgcHVibGljIHRyYWRhYmxlID0gZmFsc2U7CgogICAgdWludCBmb3JldmVyUm9zZUlkID0gMTsKCiAgICAvLyBEaXZpc2liaWxpdHkgb2Ygb3duZXJzaGlwIG92ZXIgYSB0b2tlbiAgCgltYXBwaW5nKGFkZHJlc3MgPT4gbWFwcGluZyh1aW50ID0+IHVpbnQpKSBvd25lclRvVG9rZW5TaGFyZTsKCgkvLyBIb3cgbXVjaCBvd25lcnMgaGF2ZSBvZiBhIHRva2VuCgltYXBwaW5nKHVpbnQgPT4gbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpKSB0b2tlblRvT3duZXJzSG9sZGluZ3M7CgogICAgLy8gSWYgRm9yZXZlciBSb3NlIGhhcyBiZWVuIGNyZWF0ZWQKCW1hcHBpbmcodWludCA9PiBib29sKSBmb3JldmVyUm9zZUNyZWF0ZWQ7CgogICAgc3RyaW5nIHB1YmxpYyBuYW1lOyAgCiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsgICAgICAgICAgIAogICAgdWludDggcHVibGljIGRlY2ltYWxzID0gMTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgIHN0cmluZyBwdWJsaWMgdmVyc2lvbiA9ICIxLjAiOyAgICAKCiAgICAvL1NwZWNpYWwgZ2lmdCB0b2tlbgogICAgc3RydWN0IEdpZnRUb2tlbiB7CiAgICAgICAgdWludDI1NiBnaWZ0SWQ7CiAgICB9IAoKICAgIC8vQGRldiBDb25zdHJ1Y3RvciAKICAgIGZ1bmN0aW9uIERpdmlzaWJsZUZvcmV2ZXJSb3NlKCkgcHVibGljIHsKICAgICAgICBjb250cmFjdE93bmVyID0gbXNnLnNlbmRlcjsKICAgICAgICBuYW1lID0gIkZvcmV2ZXJSb3NlIjsKICAgICAgICBzeW1ib2wgPSAiUk9TRSI7ICAKCiAgICAgICAgLy8gQ3JlYXRlIEZvcmV2ZXIgcm9zZQogICAgICAgIEdpZnRUb2tlbiBtZW1vcnkgbmV3R2lmdCA9IEdpZnRUb2tlbih7CiAgICAgICAgICAgIGdpZnRJZDogZm9yZXZlclJvc2VJZAogICAgICAgIH0pOwogICAgICAgIGdpZnRTdG9yYWdlW2ZvcmV2ZXJSb3NlSWRdID0gbmV3R2lmdDsKCiAgICAgICAgCiAgICAgICAgZm9yZXZlclJvc2VDcmVhdGVkW2ZvcmV2ZXJSb3NlSWRdID0gdHJ1ZTsKICAgICAgICBfYWRkTmV3T3duZXJIb2xkaW5nc1RvVG9rZW4oY29udHJhY3RPd25lciwgZm9yZXZlclJvc2VJZCwgdG90YWxTdXBwbHkpOwogICAgICAgIF9hZGRTaGFyZVRvTmV3T3duZXIoY29udHJhY3RPd25lciwgZm9yZXZlclJvc2VJZCwgdG90YWxTdXBwbHkpOwoKICAgIH0KICAgIAogICAgLy8gRmFsbGJhY2sgZnVuY2l0b24KICAgIGZ1bmN0aW9uKCkgcHVibGljIHsKICAgICAgICByZXZlcnQoKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgdG90YWwpIHsKICAgICAgICByZXR1cm4gdG90YWxTdXBwbHk7CiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gb3duZXJUb1Rva2VuU2hhcmVbX293bmVyXVtmb3JldmVyUm9zZUlkXTsKICAgIH0KCiAgICAvLyBXZSB1c2UgcGFyYW1ldGVyICdfdG9rZW5JZCcgYXMgdGhlIGRpdmlzaWJpbGl0eQogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsIHsKCiAgICAgICAgLy8gUmVxdWlyaW5nIHRoaXMgY29udHJhY3QgYmUgdHJhZGFibGUKICAgICAgICByZXF1aXJlKHRyYWRhYmxlID09IHRydWUpOwoKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgIT0gX3RvKTsKCiAgICAgICAgLy8gVGFrZSBfdG9rZW5JZCBhcyBkaXZpc2liaWxpdHkKICAgICAgICB1aW50MjU2IF9kaXZpc2liaWxpdHkgPSBfdG9rZW5JZDsKCiAgICAgICAgLy8gUmVxdWlyaW5nIG1zZy5zZW5kZXIgaGFzIEhvbGRpbmdzIG9mIEZvcmV2ZXIgcm9zZQogICAgICAgIHJlcXVpcmUodG9rZW5Ub093bmVyc0hvbGRpbmdzW2ZvcmV2ZXJSb3NlSWRdW21zZy5zZW5kZXJdID49IF9kaXZpc2liaWxpdHkpOwoKICAgIAogICAgICAgIC8vIFJlbW92ZSBkaXZpc2liaWxpdHlzIGZyb20gb2xkIG93bmVyCiAgICAgICAgX3JlbW92ZVNoYXJlRnJvbUxhc3RPd25lcihtc2cuc2VuZGVyLCBmb3JldmVyUm9zZUlkLCBfZGl2aXNpYmlsaXR5KTsKICAgICAgICBfcmVtb3ZlTGFzdE93bmVySG9sZGluZ3NGcm9tVG9rZW4obXNnLnNlbmRlciwgZm9yZXZlclJvc2VJZCwgX2RpdmlzaWJpbGl0eSk7CgogICAgICAgIC8vIEFkZCBkaXZpc2liaWxpdHlzIHRvIG5ldyBvd25lcgogICAgICAgIF9hZGROZXdPd25lckhvbGRpbmdzVG9Ub2tlbihfdG8sIGZvcmV2ZXJSb3NlSWQsIF9kaXZpc2liaWxpdHkpOwogICAgICAgIF9hZGRTaGFyZVRvTmV3T3duZXIoX3RvLCBmb3JldmVyUm9zZUlkLCBfZGl2aXNpYmlsaXR5KTsKCiAgICAgICAgLy8gVHJpZ2dlciBFdGhlcmV1bSBFdmVudAogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgZm9yZXZlclJvc2VJZCk7CgogICAgfQoKICAgIC8vIFRyYW5zZmVyIGdpZnQgdG8gYSBuZXcgb3duZXIuCiAgICBmdW5jdGlvbiBhc3NpZ25TaGFyZWRPd25lcnNoaXAoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2RpdmlzaWJpbGl0eSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ubHlPd25lciBleHRlcm5hbCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewoKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgIT0gX3RvKTsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKHRoaXMpKTsKICAgICAgICAKICAgICAgICAvLyBSZXF1aXJpbmcgbXNnLnNlbmRlciBoYXMgSG9sZGluZ3Mgb2YgRm9yZXZlciByb3NlCiAgICAgICAgcmVxdWlyZSh0b2tlblRvT3duZXJzSG9sZGluZ3NbZm9yZXZlclJvc2VJZF1bbXNnLnNlbmRlcl0gPj0gX2RpdmlzaWJpbGl0eSk7CgogICAgICAgIC8vUmVtb3ZlIG93bmVyc2hpcCBmcm9tIG9sZE93bmVyKG1zZy5zZW5kZXIpCiAgICAgICAgX3JlbW92ZUxhc3RPd25lckhvbGRpbmdzRnJvbVRva2VuKG1zZy5zZW5kZXIsIGZvcmV2ZXJSb3NlSWQsIF9kaXZpc2liaWxpdHkpOwogICAgICAgIF9yZW1vdmVTaGFyZUZyb21MYXN0T3duZXIobXNnLnNlbmRlciwgZm9yZXZlclJvc2VJZCwgX2RpdmlzaWJpbGl0eSk7CgogICAgICAgICAvL0FkZCBvd25lcnNoaXAgdG8gTmV3T3duZXIoYWRkcmVzcyBfdG8pCiAgICAgICAgX2FkZFNoYXJlVG9OZXdPd25lcihfdG8sIGZvcmV2ZXJSb3NlSWQsIF9kaXZpc2liaWxpdHkpOyAKICAgICAgICBfYWRkTmV3T3duZXJIb2xkaW5nc1RvVG9rZW4oX3RvLCBmb3JldmVyUm9zZUlkLCBfZGl2aXNpYmlsaXR5KTsKCiAgICAgICAgLy8gVHJpZ2dlciBFdGhlcmV1bSBFdmVudAogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgZm9yZXZlclJvc2VJZCk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEZvcmV2ZXJSb3NlKCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50MjU2IF9mb3JldmVyUm9zZUlkKSB7CiAgICAgICAgcmV0dXJuIGdpZnRTdG9yYWdlW2ZvcmV2ZXJSb3NlSWRdLmdpZnRJZDsKICAgIH0KCiAgICAvLyBUdXJuIG9uIHRoaXMgY29udHJhY3QgdG8gYmUgdHJhZGFibGUsIHNvIG93bmVycyBjYW4gdHJhbnNmZXIgdGhlaXIgdG9rZW4KICAgIGZ1bmN0aW9uIHR1cm5PblRyYWRhYmxlKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgdHJhZGFibGUgPSB0cnVlOwogICAgfQogICAgCiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gSGVscGVyIGZ1bmN0aW9ucyAoaW50ZXJuYWwgZnVuY3Rpb25zKSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgkvLyBBZGQgZGl2aXNpYmlsaXR5IHRvIG5ldyBvd25lcgoJZnVuY3Rpb24gX2FkZFNoYXJlVG9OZXdPd25lcihhZGRyZXNzIF9vd25lciwgdWludCBfdG9rZW5JZCwgdWludCBfdW5pdHMpIGludGVybmFsIHsKCQlvd25lclRvVG9rZW5TaGFyZVtfb3duZXJdW190b2tlbklkXSArPSBfdW5pdHM7Cgl9CgoJCgkvLyBBZGQgdGhlIGRpdmlzaWJpbGl0eSB0byBuZXcgb3duZXIKCWZ1bmN0aW9uIF9hZGROZXdPd25lckhvbGRpbmdzVG9Ub2tlbihhZGRyZXNzIF9vd25lciwgdWludCBfdG9rZW5JZCwgdWludCBfdW5pdHMpIGludGVybmFsIHsKCQl0b2tlblRvT3duZXJzSG9sZGluZ3NbX3Rva2VuSWRdW19vd25lcl0gKz0gX3VuaXRzOwoJfQogICAgCiAgICAvLyBSZW1vdmUgZGl2aXNpYmlsaXR5IGZyb20gbGFzdCBvd25lcgoJZnVuY3Rpb24gX3JlbW92ZVNoYXJlRnJvbUxhc3RPd25lcihhZGRyZXNzIF9vd25lciwgdWludCBfdG9rZW5JZCwgdWludCBfdW5pdHMpIGludGVybmFsIHsKCQlvd25lclRvVG9rZW5TaGFyZVtfb3duZXJdW190b2tlbklkXSAtPSBfdW5pdHM7Cgl9CiAgICAKICAgIC8vIFJlbW92ZSBkaXZpc2liaWxpdHkgZnJvbSBsYXN0IG93bmVyIAoJZnVuY3Rpb24gX3JlbW92ZUxhc3RPd25lckhvbGRpbmdzRnJvbVRva2VuKGFkZHJlc3MgX293bmVyLCB1aW50IF90b2tlbklkLCB1aW50IF91bml0cykgaW50ZXJuYWwgewoJCXRva2VuVG9Pd25lcnNIb2xkaW5nc1tfdG9rZW5JZF1bX293bmVyXSAtPSBfdW5pdHM7Cgl9CgogICAgLy8gV2l0aGRyYXcgRXRoZXIgZnJvbSB0aGlzIGNvbnRyYWN0IHRvIE11bHRpIHNpZ2luIHdhbGxldAogICAgZnVuY3Rpb24gd2l0aGRyYXdFdGhlcigpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmV0dXJuIGNvbnRyYWN0T3duZXIuc2VuZCh0aGlzLmJhbGFuY2UpOwogICAgfQoKICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBNb2RpZmllciAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKCiAgICAgbW9kaWZpZXIgb25seUV4aXN0ZW50VG9rZW4odWludCBfdG9rZW5JZCkgewoJICAgIHJlcXVpcmUoZm9yZXZlclJvc2VDcmVhdGVkW190b2tlbklkXSA9PSB0cnVlKTsKCSAgICBfOwoJfQoKICAgIG1vZGlmaWVyIG9ubHlPd25lcigpewogICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY29udHJhY3RPd25lcik7CiAgICAgICAgIF87CiAgICAgfQoKfQoKCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PU11bHRpU2lnIFdhbGxldD09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLwovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovCgovLy8gQHRpdGxlIE11bHRpc2lnbmF0dXJlIHdhbGxldCAtIEFsbG93cyBtdWx0aXBsZSBwYXJ0aWVzIHRvIGFncmVlIG9uIHRyYW5zYWN0aW9ucyBiZWZvcmUgZXhlY3V0aW9uLgovLy8gQGF1dGhvciBTdGVmYW4gR2VvcmdlIC0gPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iN2UwZDBhMWIxODFmMTA1MDE5MWIxMTBjMTkxYjNlMWQxMTEwMGQxYjEwMGQwNzBkNTAxMDFiMGEiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L3NwYW4+Pgpjb250cmFjdCBNdWx0aVNpZ1dhbGxldCB7CgogICAvL0xvYWQgR2lmdG8gYW5kIElBTUlDT0lOIENvbnRyYWN0cyB0byB0aGlzIGNvbnRyYWN0LgogICAgLy9FUkMyMCBwcml2YXRlIEdpZnRvID0gRVJDMjAoMHg5MmU4N2E1NjIyY2Y5OTU1ZDEwNjI4MjI0NTQ3MDExOThhMDI4YTcyKTsKICAgIC8vRVJDMjAgcHJpdmF0ZSBJQU1JVG9rZW4gPSBFUkMyMCgweGVlMTBhMDZiMmEwY2Y3ZTA0MTE1ZWRmYmVlNDYyNDIxMzZlYjZhZTEpOwoKICAgIHVpbnQgY29uc3RhbnQgcHVibGljIE1BWF9PV05FUl9DT1VOVCA9IDUwOwoKICAgIGV2ZW50IENvbmZpcm1hdGlvbihhZGRyZXNzIGluZGV4ZWQgc2VuZGVyLCB1aW50IGluZGV4ZWQgdHJhbnNhY3Rpb25JZCk7CiAgICBldmVudCBSZXZvY2F0aW9uKGFkZHJlc3MgaW5kZXhlZCBzZW5kZXIsIHVpbnQgaW5kZXhlZCB0cmFuc2FjdGlvbklkKTsKICAgIGV2ZW50IFN1Ym1pc3Npb24odWludCBpbmRleGVkIHRyYW5zYWN0aW9uSWQpOwogICAgZXZlbnQgRXhlY3V0aW9uKHVpbnQgaW5kZXhlZCB0cmFuc2FjdGlvbklkKTsKICAgIGV2ZW50IEV4ZWN1dGlvbkZhaWx1cmUodWludCBpbmRleGVkIHRyYW5zYWN0aW9uSWQpOwogICAgZXZlbnQgRGVwb3NpdChhZGRyZXNzIGluZGV4ZWQgc2VuZGVyLCB1aW50IHZhbHVlKTsKICAgIGV2ZW50IE93bmVyQWRkaXRpb24oYWRkcmVzcyBpbmRleGVkIG93bmVyKTsKICAgIGV2ZW50IE93bmVyUmVtb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIpOwogICAgZXZlbnQgUmVxdWlyZW1lbnRDaGFuZ2UodWludCByZXF1aXJlZCk7CiAgICBldmVudCBDb2luQ3JlYXRpb24oYWRkcmVzcyBjb2luKTsKCiAgICBtYXBwaW5nICh1aW50ID0+IFRyYW5zYWN0aW9uKSBwdWJsaWMgdHJhbnNhY3Rpb25zOwogICAgbWFwcGluZyAodWludCA9PiBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpKSBwdWJsaWMgY29uZmlybWF0aW9uczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIGlzT3duZXI7CiAgICBhZGRyZXNzW10gcHVibGljIG93bmVyczsKICAgIHVpbnQgcHVibGljIHJlcXVpcmVkOwogICAgdWludCBwdWJsaWMgdHJhbnNhY3Rpb25Db3VudDsKICAgIGJvb2wgZmxhZyA9IHRydWU7CgogICAgc3RydWN0IFRyYW5zYWN0aW9uIHsKICAgICAgICBhZGRyZXNzIGRlc3RpbmF0aW9uOwogICAgICAgIHVpbnQgdmFsdWU7CiAgICAgICAgYnl0ZXMgZGF0YTsKICAgICAgICBib29sIGV4ZWN1dGVkOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlXYWxsZXQoKSB7CiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gYWRkcmVzcyh0aGlzKSkKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvd25lckRvZXNOb3RFeGlzdChhZGRyZXNzIG93bmVyKSB7CiAgICAgICAgaWYgKGlzT3duZXJbb3duZXJdKQogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG93bmVyRXhpc3RzKGFkZHJlc3Mgb3duZXIpIHsKICAgICAgICBpZiAoIWlzT3duZXJbb3duZXJdKQogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIHRyYW5zYWN0aW9uRXhpc3RzKHVpbnQgdHJhbnNhY3Rpb25JZCkgewogICAgICAgIGlmICh0cmFuc2FjdGlvbnNbdHJhbnNhY3Rpb25JZF0uZGVzdGluYXRpb24gPT0gMCkKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBjb25maXJtZWQodWludCB0cmFuc2FjdGlvbklkLCBhZGRyZXNzIG93bmVyKSB7CiAgICAgICAgaWYgKCFjb25maXJtYXRpb25zW3RyYW5zYWN0aW9uSWRdW293bmVyXSkKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBub3RDb25maXJtZWQodWludCB0cmFuc2FjdGlvbklkLCBhZGRyZXNzIG93bmVyKSB7CiAgICAgICAgaWYgKGNvbmZpcm1hdGlvbnNbdHJhbnNhY3Rpb25JZF1bb3duZXJdKQogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG5vdEV4ZWN1dGVkKHVpbnQgdHJhbnNhY3Rpb25JZCkgewogICAgICAgIGlmICh0cmFuc2FjdGlvbnNbdHJhbnNhY3Rpb25JZF0uZXhlY3V0ZWQpCiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgbm90TnVsbChhZGRyZXNzIF9hZGRyZXNzKSB7CiAgICAgICAgaWYgKF9hZGRyZXNzID09IDApCiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgdmFsaWRSZXF1aXJlbWVudCh1aW50IG93bmVyQ291bnQsIHVpbnQgX3JlcXVpcmVkKSB7CiAgICAgICAgaWYgKCAgIG93bmVyQ291bnQgPiBNQVhfT1dORVJfQ09VTlQKICAgICAgICAgICAgfHwgX3JlcXVpcmVkID4gb3duZXJDb3VudAogICAgICAgICAgICB8fCBfcmVxdWlyZWQgPT0gMAogICAgICAgICAgICB8fCBvd25lckNvdW50ID09IDApCiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIF87CiAgICB9CgogICAgLy8vIEBkZXYgRmFsbGJhY2sgZnVuY3Rpb24gYWxsb3dzIHRvIGRlcG9zaXQgZXRoZXIuCiAgICBmdW5jdGlvbigpCiAgICAgICAgcGF5YWJsZQogICAgewogICAgICAgIGlmIChtc2cudmFsdWUgPiAwKQogICAgICAgICAgICBEZXBvc2l0KG1zZy5zZW5kZXIsIG1zZy52YWx1ZSk7CiAgICB9CgogICAgLyoKICAgICAqIFB1YmxpYyBmdW5jdGlvbnMKICAgICAqLwogICAgLy8vIEBkZXYgQ29udHJhY3QgY29uc3RydWN0b3Igc2V0cyBpbml0aWFsIG93bmVycyBhbmQgcmVxdWlyZWQgbnVtYmVyIG9mIGNvbmZpcm1hdGlvbnMuCiAgICAvLy8gQHBhcmFtIF9vd25lcnMgTGlzdCBvZiBpbml0aWFsIG93bmVycy4KICAgIC8vLyBAcGFyYW0gX3JlcXVpcmVkIE51bWJlciBvZiByZXF1aXJlZCBjb25maXJtYXRpb25zLgogICAgZnVuY3Rpb24gTXVsdGlTaWdXYWxsZXQoYWRkcmVzc1tdIF9vd25lcnMsIHVpbnQgX3JlcXVpcmVkKQogICAgICAgIHB1YmxpYwogICAgICAgIHZhbGlkUmVxdWlyZW1lbnQoX293bmVycy5sZW5ndGgsIF9yZXF1aXJlZCkKICAgIHsKICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPF9vd25lcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGlzT3duZXJbX293bmVyc1tpXV0gfHwgX293bmVyc1tpXSA9PSAwKQogICAgICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgICAgIGlzT3duZXJbX293bmVyc1tpXV0gPSB0cnVlOwogICAgICAgIH0KICAgICAgICBvd25lcnMgPSBfb3duZXJzOwogICAgICAgIHJlcXVpcmVkID0gX3JlcXVpcmVkOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyB0byBhZGQgYSBuZXcgb3duZXIuIFRyYW5zYWN0aW9uIGhhcyB0byBiZSBzZW50IGJ5IHdhbGxldC4KICAgIC8vLyBAcGFyYW0gb3duZXIgQWRkcmVzcyBvZiBuZXcgb3duZXIuCiAgICBmdW5jdGlvbiBhZGRPd25lcihhZGRyZXNzIG93bmVyKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlXYWxsZXQKICAgICAgICBvd25lckRvZXNOb3RFeGlzdChvd25lcikKICAgICAgICBub3ROdWxsKG93bmVyKQogICAgICAgIHZhbGlkUmVxdWlyZW1lbnQob3duZXJzLmxlbmd0aCArIDEsIHJlcXVpcmVkKQogICAgewogICAgICAgIGlzT3duZXJbb3duZXJdID0gdHJ1ZTsKICAgICAgICBvd25lcnMucHVzaChvd25lcik7CiAgICAgICAgT3duZXJBZGRpdGlvbihvd25lcik7CiAgICB9CgogICAgLy8vIEBkZXYgQWxsb3dzIHRvIHJlbW92ZSBhbiBvd25lci4gVHJhbnNhY3Rpb24gaGFzIHRvIGJlIHNlbnQgYnkgd2FsbGV0LgogICAgLy8vIEBwYXJhbSBvd25lciBBZGRyZXNzIG9mIG93bmVyLgogICAgZnVuY3Rpb24gcmVtb3ZlT3duZXIoYWRkcmVzcyBvd25lcikKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5V2FsbGV0CiAgICAgICAgb3duZXJFeGlzdHMob3duZXIpCiAgICB7CiAgICAgICAgaXNPd25lcltvd25lcl0gPSBmYWxzZTsKICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPG93bmVycy5sZW5ndGggLSAxOyBpKyspCiAgICAgICAgICAgIGlmIChvd25lcnNbaV0gPT0gb3duZXIpIHsKICAgICAgICAgICAgICAgIG93bmVyc1tpXSA9IG93bmVyc1tvd25lcnMubGVuZ3RoIC0gMV07CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIG93bmVycy5sZW5ndGggLT0gMTsKICAgICAgICBpZiAocmVxdWlyZWQgPiBvd25lcnMubGVuZ3RoKQogICAgICAgICAgICBjaGFuZ2VSZXF1aXJlbWVudChvd25lcnMubGVuZ3RoKTsKICAgICAgICBPd25lclJlbW92YWwob3duZXIpOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyB0byByZXBsYWNlIGFuIG93bmVyIHdpdGggYSBuZXcgb3duZXIuIFRyYW5zYWN0aW9uIGhhcyB0byBiZSBzZW50IGJ5IHdhbGxldC4KICAgIC8vLyBAcGFyYW0gb3duZXIgQWRkcmVzcyBvZiBvd25lciB0byBiZSByZXBsYWNlZC4KICAgIC8vLyBAcGFyYW0gb3duZXIgQWRkcmVzcyBvZiBuZXcgb3duZXIuCiAgICBmdW5jdGlvbiByZXBsYWNlT3duZXIoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBuZXdPd25lcikKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5V2FsbGV0CiAgICAgICAgb3duZXJFeGlzdHMob3duZXIpCiAgICAgICAgb3duZXJEb2VzTm90RXhpc3QobmV3T3duZXIpCiAgICB7CiAgICAgICAgZm9yICh1aW50IGk9MDsgaTxvd25lcnMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlmIChvd25lcnNbaV0gPT0gb3duZXIpIHsKICAgICAgICAgICAgICAgIG93bmVyc1tpXSA9IG5ld093bmVyOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICBpc093bmVyW293bmVyXSA9IGZhbHNlOwogICAgICAgIGlzT3duZXJbbmV3T3duZXJdID0gdHJ1ZTsKICAgICAgICBPd25lclJlbW92YWwob3duZXIpOwogICAgICAgIE93bmVyQWRkaXRpb24obmV3T3duZXIpOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyB0byBjaGFuZ2UgdGhlIG51bWJlciBvZiByZXF1aXJlZCBjb25maXJtYXRpb25zLiBUcmFuc2FjdGlvbiBoYXMgdG8gYmUgc2VudCBieSB3YWxsZXQuCiAgICAvLy8gQHBhcmFtIF9yZXF1aXJlZCBOdW1iZXIgb2YgcmVxdWlyZWQgY29uZmlybWF0aW9ucy4KICAgIGZ1bmN0aW9uIGNoYW5nZVJlcXVpcmVtZW50KHVpbnQgX3JlcXVpcmVkKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlXYWxsZXQKICAgICAgICB2YWxpZFJlcXVpcmVtZW50KG93bmVycy5sZW5ndGgsIF9yZXF1aXJlZCkKICAgIHsKICAgICAgICByZXF1aXJlZCA9IF9yZXF1aXJlZDsKICAgICAgICBSZXF1aXJlbWVudENoYW5nZShfcmVxdWlyZWQpOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyBhbiBvd25lciB0byBzdWJtaXQgYW5kIGNvbmZpcm0gYSB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gZGVzdGluYXRpb24gVHJhbnNhY3Rpb24gdGFyZ2V0IGFkZHJlc3MuCiAgICAvLy8gQHBhcmFtIHZhbHVlIFRyYW5zYWN0aW9uIGV0aGVyIHZhbHVlLgogICAgLy8vIEBwYXJhbSBkYXRhIFRyYW5zYWN0aW9uIGRhdGEgcGF5bG9hZC4KICAgIC8vLyBAcmV0dXJuIFJldHVybnMgdHJhbnNhY3Rpb24gSUQuCiAgICBmdW5jdGlvbiBzdWJtaXRUcmFuc2FjdGlvbihhZGRyZXNzIGRlc3RpbmF0aW9uLCB1aW50IHZhbHVlLCBieXRlcyBkYXRhKQogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnMgKHVpbnQgdHJhbnNhY3Rpb25JZCkKICAgIHsKICAgICAgICB0cmFuc2FjdGlvbklkID0gYWRkVHJhbnNhY3Rpb24oZGVzdGluYXRpb24sIHZhbHVlLCBkYXRhKTsKICAgICAgICBjb25maXJtVHJhbnNhY3Rpb24odHJhbnNhY3Rpb25JZCk7CiAgICB9CgogICAgLy8vIEBkZXYgQWxsb3dzIGFuIG93bmVyIHRvIGNvbmZpcm0gYSB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRC4KICAgIGZ1bmN0aW9uIGNvbmZpcm1UcmFuc2FjdGlvbih1aW50IHRyYW5zYWN0aW9uSWQpCiAgICAgICAgcHVibGljCiAgICAgICAgb3duZXJFeGlzdHMobXNnLnNlbmRlcikKICAgICAgICB0cmFuc2FjdGlvbkV4aXN0cyh0cmFuc2FjdGlvbklkKQogICAgICAgIG5vdENvbmZpcm1lZCh0cmFuc2FjdGlvbklkLCBtc2cuc2VuZGVyKQogICAgewogICAgICAgIGNvbmZpcm1hdGlvbnNbdHJhbnNhY3Rpb25JZF1bbXNnLnNlbmRlcl0gPSB0cnVlOwogICAgICAgIENvbmZpcm1hdGlvbihtc2cuc2VuZGVyLCB0cmFuc2FjdGlvbklkKTsKICAgICAgICBleGVjdXRlVHJhbnNhY3Rpb24odHJhbnNhY3Rpb25JZCk7CiAgICB9CgogICAgLy8vIEBkZXYgQWxsb3dzIGFuIG93bmVyIHRvIHJldm9rZSBhIGNvbmZpcm1hdGlvbiBmb3IgYSB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRC4KICAgIGZ1bmN0aW9uIHJldm9rZUNvbmZpcm1hdGlvbih1aW50IHRyYW5zYWN0aW9uSWQpCiAgICAgICAgcHVibGljCiAgICAgICAgb3duZXJFeGlzdHMobXNnLnNlbmRlcikKICAgICAgICBjb25maXJtZWQodHJhbnNhY3Rpb25JZCwgbXNnLnNlbmRlcikKICAgICAgICBub3RFeGVjdXRlZCh0cmFuc2FjdGlvbklkKQogICAgewogICAgICAgIGNvbmZpcm1hdGlvbnNbdHJhbnNhY3Rpb25JZF1bbXNnLnNlbmRlcl0gPSBmYWxzZTsKICAgICAgICBSZXZvY2F0aW9uKG1zZy5zZW5kZXIsIHRyYW5zYWN0aW9uSWQpOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyBhbnlvbmUgdG8gZXhlY3V0ZSBhIGNvbmZpcm1lZCB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRC4KICAgIGZ1bmN0aW9uIGV4ZWN1dGVUcmFuc2FjdGlvbih1aW50IHRyYW5zYWN0aW9uSWQpCiAgICAgICAgcHVibGljCiAgICAgICAgbm90RXhlY3V0ZWQodHJhbnNhY3Rpb25JZCkKICAgIHsKICAgICAgICBpZiAoaXNDb25maXJtZWQodHJhbnNhY3Rpb25JZCkpIHsKICAgICAgICAgICAgVHJhbnNhY3Rpb24gdHggPSB0cmFuc2FjdGlvbnNbdHJhbnNhY3Rpb25JZF07CiAgICAgICAgICAgIHR4LmV4ZWN1dGVkID0gdHJ1ZTsKICAgICAgICAgICAgaWYgKHR4LmRlc3RpbmF0aW9uLmNhbGwudmFsdWUodHgudmFsdWUpKHR4LmRhdGEpKQogICAgICAgICAgICAgICAgRXhlY3V0aW9uKHRyYW5zYWN0aW9uSWQpOwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIEV4ZWN1dGlvbkZhaWx1cmUodHJhbnNhY3Rpb25JZCk7CiAgICAgICAgICAgICAgICB0eC5leGVjdXRlZCA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgdGhlIGNvbmZpcm1hdGlvbiBzdGF0dXMgb2YgYSB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRC4KICAgIC8vLyBAcmV0dXJuIENvbmZpcm1hdGlvbiBzdGF0dXMuCiAgICBmdW5jdGlvbiBpc0NvbmZpcm1lZCh1aW50IHRyYW5zYWN0aW9uSWQpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHVpbnQgY291bnQgPSAwOwogICAgICAgIGZvciAodWludCBpPTA7IGk8b3duZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChjb25maXJtYXRpb25zW3RyYW5zYWN0aW9uSWRdW293bmVyc1tpXV0pCiAgICAgICAgICAgICAgICBjb3VudCArPSAxOwogICAgICAgICAgICBpZiAoY291bnQgPT0gcmVxdWlyZWQpCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgLyoKICAgICAqIEludGVybmFsIGZ1bmN0aW9ucwogICAgICovCiAgICAvLy8gQGRldiBBZGRzIGEgbmV3IHRyYW5zYWN0aW9uIHRvIHRoZSB0cmFuc2FjdGlvbiBtYXBwaW5nLCBpZiB0cmFuc2FjdGlvbiBkb2VzIG5vdCBleGlzdCB5ZXQuCiAgICAvLy8gQHBhcmFtIGRlc3RpbmF0aW9uIFRyYW5zYWN0aW9uIHRhcmdldCBhZGRyZXNzLgogICAgLy8vIEBwYXJhbSB2YWx1ZSBUcmFuc2FjdGlvbiBldGhlciB2YWx1ZS4KICAgIC8vLyBAcGFyYW0gZGF0YSBUcmFuc2FjdGlvbiBkYXRhIHBheWxvYWQuCiAgICAvLy8gQHJldHVybiBSZXR1cm5zIHRyYW5zYWN0aW9uIElELgogICAgZnVuY3Rpb24gYWRkVHJhbnNhY3Rpb24oYWRkcmVzcyBkZXN0aW5hdGlvbiwgdWludCB2YWx1ZSwgYnl0ZXMgZGF0YSkKICAgICAgICBpbnRlcm5hbAogICAgICAgIG5vdE51bGwoZGVzdGluYXRpb24pCiAgICAgICAgcmV0dXJucyAodWludCB0cmFuc2FjdGlvbklkKQogICAgewogICAgICAgIHRyYW5zYWN0aW9uSWQgPSB0cmFuc2FjdGlvbkNvdW50OwogICAgICAgIHRyYW5zYWN0aW9uc1t0cmFuc2FjdGlvbklkXSA9IFRyYW5zYWN0aW9uKHsKICAgICAgICAgICAgZGVzdGluYXRpb246IGRlc3RpbmF0aW9uLAogICAgICAgICAgICB2YWx1ZTogdmFsdWUsCiAgICAgICAgICAgIGRhdGE6IGRhdGEsCiAgICAgICAgICAgIGV4ZWN1dGVkOiBmYWxzZQogICAgICAgIH0pOwogICAgICAgIHRyYW5zYWN0aW9uQ291bnQgKz0gMTsKICAgICAgICBTdWJtaXNzaW9uKHRyYW5zYWN0aW9uSWQpOwogICAgfQoKICAgIC8qCiAgICAgKiBXZWIzIGNhbGwgZnVuY3Rpb25zCiAgICAgKi8KICAgIC8vLyBAZGV2IFJldHVybnMgbnVtYmVyIG9mIGNvbmZpcm1hdGlvbnMgb2YgYSB0cmFuc2FjdGlvbi4KICAgIC8vLyBAcGFyYW0gdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRC4KICAgIC8vLyBAcmV0dXJuIE51bWJlciBvZiBjb25maXJtYXRpb25zLgogICAgZnVuY3Rpb24gZ2V0Q29uZmlybWF0aW9uQ291bnQodWludCB0cmFuc2FjdGlvbklkKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCBjb3VudCkKICAgIHsKICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPG93bmVycy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKGNvbmZpcm1hdGlvbnNbdHJhbnNhY3Rpb25JZF1bb3duZXJzW2ldXSkKICAgICAgICAgICAgICAgIGNvdW50ICs9IDE7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyB0b3RhbCBudW1iZXIgb2YgdHJhbnNhY3Rpb25zIGFmdGVyIGZpbGVycyBhcmUgYXBwbGllZC4KICAgIC8vLyBAcGFyYW0gcGVuZGluZyBJbmNsdWRlIHBlbmRpbmcgdHJhbnNhY3Rpb25zLgogICAgLy8vIEBwYXJhbSBleGVjdXRlZCBJbmNsdWRlIGV4ZWN1dGVkIHRyYW5zYWN0aW9ucy4KICAgIC8vLyBAcmV0dXJuIFRvdGFsIG51bWJlciBvZiB0cmFuc2FjdGlvbnMgYWZ0ZXIgZmlsdGVycyBhcmUgYXBwbGllZC4KICAgIGZ1bmN0aW9uIGdldFRyYW5zYWN0aW9uQ291bnQoYm9vbCBwZW5kaW5nLCBib29sIGV4ZWN1dGVkKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCBjb3VudCkKICAgIHsKICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPHRyYW5zYWN0aW9uQ291bnQ7IGkrKykKICAgICAgICAgICAgaWYgKCAgIHBlbmRpbmcgJiYgIXRyYW5zYWN0aW9uc1tpXS5leGVjdXRlZAogICAgICAgICAgICAgICAgfHwgZXhlY3V0ZWQgJiYgdHJhbnNhY3Rpb25zW2ldLmV4ZWN1dGVkKQogICAgICAgICAgICAgICAgY291bnQgKz0gMTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIGxpc3Qgb2Ygb3duZXJzLgogICAgLy8vIEByZXR1cm4gTGlzdCBvZiBvd25lciBhZGRyZXNzZXMuCiAgICBmdW5jdGlvbiBnZXRPd25lcnMoKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoYWRkcmVzc1tdKQogICAgewogICAgICAgIHJldHVybiBvd25lcnM7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyBhcnJheSB3aXRoIG93bmVyIGFkZHJlc3Nlcywgd2hpY2ggY29uZmlybWVkIHRyYW5zYWN0aW9uLgogICAgLy8vIEBwYXJhbSB0cmFuc2FjdGlvbklkIFRyYW5zYWN0aW9uIElELgogICAgLy8vIEByZXR1cm4gUmV0dXJucyBhcnJheSBvZiBvd25lciBhZGRyZXNzZXMuCiAgICBmdW5jdGlvbiBnZXRDb25maXJtYXRpb25zKHVpbnQgdHJhbnNhY3Rpb25JZCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKGFkZHJlc3NbXSBfY29uZmlybWF0aW9ucykKICAgIHsKICAgICAgICBhZGRyZXNzW10gbWVtb3J5IGNvbmZpcm1hdGlvbnNUZW1wID0gbmV3IGFkZHJlc3NbXShvd25lcnMubGVuZ3RoKTsKICAgICAgICB1aW50IGNvdW50ID0gMDsKICAgICAgICB1aW50IGk7CiAgICAgICAgZm9yIChpPTA7IGk8b3duZXJzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBpZiAoY29uZmlybWF0aW9uc1t0cmFuc2FjdGlvbklkXVtvd25lcnNbaV1dKSB7CiAgICAgICAgICAgICAgICBjb25maXJtYXRpb25zVGVtcFtjb3VudF0gPSBvd25lcnNbaV07CiAgICAgICAgICAgICAgICBjb3VudCArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgX2NvbmZpcm1hdGlvbnMgPSBuZXcgYWRkcmVzc1tdKGNvdW50KTsKICAgICAgICBmb3IgKGk9MDsgaTxjb3VudDsgaSsrKQogICAgICAgICAgICBfY29uZmlybWF0aW9uc1tpXSA9IGNvbmZpcm1hdGlvbnNUZW1wW2ldOwogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgbGlzdCBvZiB0cmFuc2FjdGlvbiBJRHMgaW4gZGVmaW5lZCByYW5nZS4KICAgIC8vLyBAcGFyYW0gZnJvbSBJbmRleCBzdGFydCBwb3NpdGlvbiBvZiB0cmFuc2FjdGlvbiBhcnJheS4KICAgIC8vLyBAcGFyYW0gdG8gSW5kZXggZW5kIHBvc2l0aW9uIG9mIHRyYW5zYWN0aW9uIGFycmF5LgogICAgLy8vIEBwYXJhbSBwZW5kaW5nIEluY2x1ZGUgcGVuZGluZyB0cmFuc2FjdGlvbnMuCiAgICAvLy8gQHBhcmFtIGV4ZWN1dGVkIEluY2x1ZGUgZXhlY3V0ZWQgdHJhbnNhY3Rpb25zLgogICAgLy8vIEByZXR1cm4gUmV0dXJucyBhcnJheSBvZiB0cmFuc2FjdGlvbiBJRHMuCiAgICBmdW5jdGlvbiBnZXRUcmFuc2FjdGlvbklkcyh1aW50IGZyb20sIHVpbnQgdG8sIGJvb2wgcGVuZGluZywgYm9vbCBleGVjdXRlZCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnRbXSBfdHJhbnNhY3Rpb25JZHMpCiAgICB7CiAgICAgICAgdWludFtdIG1lbW9yeSB0cmFuc2FjdGlvbklkc1RlbXAgPSBuZXcgdWludFtdKHRyYW5zYWN0aW9uQ291bnQpOwogICAgICAgIHVpbnQgY291bnQgPSAwOwogICAgICAgIHVpbnQgaTsKICAgICAgICBmb3IgKGk9MDsgaTx0cmFuc2FjdGlvbkNvdW50OyBpKyspCiAgICAgICAgICAgIGlmICggICBwZW5kaW5nICYmICF0cmFuc2FjdGlvbnNbaV0uZXhlY3V0ZWQKICAgICAgICAgICAgICAgIHx8IGV4ZWN1dGVkICYmIHRyYW5zYWN0aW9uc1tpXS5leGVjdXRlZCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25JZHNUZW1wW2NvdW50XSA9IGk7CiAgICAgICAgICAgICAgICBjb3VudCArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgX3RyYW5zYWN0aW9uSWRzID0gbmV3IHVpbnRbXSh0byAtIGZyb20pOwogICAgICAgIGZvciAoaT1mcm9tOyBpPHRvOyBpKyspCiAgICAgICAgICAgIF90cmFuc2FjdGlvbklkc1tpIC0gZnJvbV0gPSB0cmFuc2FjdGlvbklkc1RlbXBbaV07CiAgICB9CgogICAgLy8gVHJhbnNmZXIgR1RPIHRvIGFuIG91dHNpZGUgYWNjb3VudAogICAgLypmdW5jdGlvbiBfd2l0aGRyYXdHVE8oYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2JhbGFuY2UpIG9ubHlPd25lciBpbnRlcm5hbCB7IAogICAgICAgIHJlcXVpcmUoR2lmdG8uYmFsYW5jZU9mKGFkZHJlc3ModGhpcykpID49IF9iYWxhbmNlKTsKICAgICAgICBHaWZ0by50cmFuc2ZlcihfdG8sIF9iYWxhbmNlKTsgCiAgICB9CgogICAgLy8gVHJhbnNmZXIgSUFNSSB0byBhbiBvdXRzaWRlIGFjY291bnQKICAgIGZ1bmN0aW9uIF93aXRoZHJhd0lBTUkoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2JhbGFuY2UpIG9ubHlPd25lciBpbnRlcm5hbCB7IAogICAgICAgIHJlcXVpcmUoSUFNSVRva2VuLmJhbGFuY2VPZihhZGRyZXNzKHRoaXMpKSA+PSBfYmFsYW5jZSk7CiAgICAgICAgSUFNSVRva2VuLnRyYW5zZmVyKF90bywgX2JhbGFuY2UpOyAKICAgIH0KCiAgICAvLyBDaGFuZ2UgR2lmdG8gY29udHJhY3QncyBhZGRyZXNzIG9yIGFub3RoZXIgdHlwZSBvZiB0b2tlbiwgbGlrZSBFdGhlci4KICAgIGZ1bmN0aW9uIHNldElBTUlUb2tlbkFkZHJlc3MoYWRkcmVzcyBuZXdBZGRyZXNzKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBJQU1JVG9rZW4gPSBFUkMyMChuZXdBZGRyZXNzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRHaWZ0b0FkZHJlc3MoYWRkcmVzcyBuZXdBZGRyZXNzKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBHaWZ0byA9IEVSQzIwKG5ld0FkZHJlc3MpOwogICAgfSovCgogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUoaXNPd25lclttc2cuc2VuZGVyXSA9PSB0cnVlKTsKICAgICAgICBfOwogICAgfQoKICAgIC8vLyBAZGV2IENyZWF0ZSBuZXcgZm9yZXZlciByb3NlLgogICAgZnVuY3Rpb24gY3JlYXRlRm9yZXZlclJvc2UoKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgb25seVdhbGxldAogICAgewogICAgICAgIHJlcXVpcmUoZmxhZyA9PSB0cnVlKTsKICAgICAgICBDb2luQ3JlYXRpb24obmV3IERpdmlzaWJsZUZvcmV2ZXJSb3NlKCkpOwogICAgICAgIGZsYWcgPSBmYWxzZTsKICAgIH0KICAgIAoKfQ=='.
	

]
