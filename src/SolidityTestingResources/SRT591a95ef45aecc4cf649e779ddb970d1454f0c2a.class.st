Class {
	#name : #SRT591a95ef45aecc4cf649e779ddb970d1454f0c2a,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT591a95ef45aecc4cf649e779ddb970d1454f0c2a >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgoKCmxpYnJhcnkgU2FmZU1hdGggewoKICAvKioKICAqIEBkZXYgTXVsdGlwbGllcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICovCiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IEludGVnZXIgZGl2aXNpb24gb2YgdHdvIG51bWJlcnMsIHRydW5jYXRpbmcgdGhlIHF1b3RpZW50LgogICovCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICAvKioKICAqIEBkZXYgU3Vic3RyYWN0cyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93IChpLmUuIGlmIHN1YnRyYWhlbmQgaXMgZ3JlYXRlciB0aGFuIG1pbnVlbmQpLgogICovCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgLyoqCiAgKiBAZGV2IEFkZHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKCi8qKgogKiBAdGl0bGUgRVJDMjBCYXNpYwogKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE3OQogKi8KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKCmNvbnRyYWN0IENyb3dkc2FsZSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIC8vIFRoZSB0b2tlbiBiZWluZyBzb2xkCiAgRVJDMjAgcHVibGljIHRva2VuOwoKICAvLyBBZGRyZXNzIHdoZXJlIGZ1bmRzIGFyZSBjb2xsZWN0ZWQKICBhZGRyZXNzIHB1YmxpYyB3YWxsZXQ7CgogIC8vIEhvdyBtYW55IHRva2VuIHVuaXRzIGEgYnV5ZXIgZ2V0cyBwZXIgd2VpCiAgdWludDI1NiBwdWJsaWMgcmF0ZTsKCiAgLy8gQW1vdW50IG9mIHdlaSByYWlzZWQKICB1aW50MjU2IHB1YmxpYyB3ZWlSYWlzZWQ7CgogIC8qKgogICAqIEV2ZW50IGZvciB0b2tlbiBwdXJjaGFzZSBsb2dnaW5nCiAgICogQHBhcmFtIHB1cmNoYXNlciB3aG8gcGFpZCBmb3IgdGhlIHRva2VucwogICAqIEBwYXJhbSBiZW5lZmljaWFyeSB3aG8gZ290IHRoZSB0b2tlbnMKICAgKiBAcGFyYW0gdmFsdWUgd2VpcyBwYWlkIGZvciBwdXJjaGFzZQogICAqIEBwYXJhbSBhbW91bnQgYW1vdW50IG9mIHRva2VucyBwdXJjaGFzZWQKICAgKi8KICBldmVudCBUb2tlblB1cmNoYXNlKGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB2YWx1ZSwgdWludDI1NiBhbW91bnQpOwoKICAvKioKICAgKiBAcGFyYW0gX3JhdGUgTnVtYmVyIG9mIHRva2VuIHVuaXRzIGEgYnV5ZXIgZ2V0cyBwZXIgd2VpCiAgICogQHBhcmFtIF93YWxsZXQgQWRkcmVzcyB3aGVyZSBjb2xsZWN0ZWQgZnVuZHMgd2lsbCBiZSBmb3J3YXJkZWQgdG8KICAgKiBAcGFyYW0gX3Rva2VuIEFkZHJlc3Mgb2YgdGhlIHRva2VuIGJlaW5nIHNvbGQKICAgKi8KICBmdW5jdGlvbiBDcm93ZHNhbGUodWludDI1NiBfcmF0ZSwgYWRkcmVzcyBfd2FsbGV0LCBFUkMyMCBfdG9rZW4pIHB1YmxpYyB7CiAgICByZXF1aXJlKF9yYXRlID4gMCk7CiAgICByZXF1aXJlKF93YWxsZXQgIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF90b2tlbiAhPSBhZGRyZXNzKDApKTsKCiAgICByYXRlID0gX3JhdGU7CiAgICB3YWxsZXQgPSBfd2FsbGV0OwogICAgdG9rZW4gPSBfdG9rZW47CiAgfQoKICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogIC8vIENyb3dkc2FsZSBleHRlcm5hbCBpbnRlcmZhY2UKICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAvKioKICAgKiBAZGV2IGZhbGxiYWNrIGZ1bmN0aW9uICoqKkRPIE5PVCBPVkVSUklERSoqKgogICAqLwogIGZ1bmN0aW9uICgpIGV4dGVybmFsIHBheWFibGUgewogICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwogIH0KCiAgLyoqCiAgICogQGRldiBsb3cgbGV2ZWwgdG9rZW4gcHVyY2hhc2UgKioqRE8gTk9UIE9WRVJSSURFKioqCiAgICogQHBhcmFtIF9iZW5lZmljaWFyeSBBZGRyZXNzIHBlcmZvcm1pbmcgdGhlIHRva2VuIHB1cmNoYXNlCiAgICovCiAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgX2JlbmVmaWNpYXJ5KSBwdWJsaWMgcGF5YWJsZSB7CgogICAgdWludDI1NiB3ZWlBbW91bnQgPSBtc2cudmFsdWU7CiAgICBfcHJlVmFsaWRhdGVQdXJjaGFzZShfYmVuZWZpY2lhcnksIHdlaUFtb3VudCk7CgogICAgLy8gY2FsY3VsYXRlIHRva2VuIGFtb3VudCB0byBiZSBjcmVhdGVkCiAgICB1aW50MjU2IHRva2VucyA9IF9nZXRUb2tlbkFtb3VudCh3ZWlBbW91bnQpOwoKICAgIC8vIHVwZGF0ZSBzdGF0ZQogICAgd2VpUmFpc2VkID0gd2VpUmFpc2VkLmFkZCh3ZWlBbW91bnQpOwoKICAgVG9rZW5QdXJjaGFzZShtc2cuc2VuZGVyLCBfYmVuZWZpY2lhcnksIHdlaUFtb3VudCwgdG9rZW5zKTsKICAgIF9wcm9jZXNzUHVyY2hhc2UoX2JlbmVmaWNpYXJ5LCB0b2tlbnMpOwogICAgCiAgCiAgICBfdXBkYXRlUHVyY2hhc2luZ1N0YXRlKF9iZW5lZmljaWFyeSwgd2VpQW1vdW50KTsKCiAgICBfZm9yd2FyZEZ1bmRzKCk7CiAgICBfcG9zdFZhbGlkYXRlUHVyY2hhc2UoX2JlbmVmaWNpYXJ5LCB3ZWlBbW91bnQpOwogIH0KCiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAvLyBJbnRlcm5hbCBpbnRlcmZhY2UgKGV4dGVuc2libGUpCiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgLyoqCiAgICogQGRldiBWYWxpZGF0aW9uIG9mIGFuIGluY29taW5nIHB1cmNoYXNlLiBVc2UgcmVxdWlyZSBzdGF0ZW1lbnMgdG8gcmV2ZXJ0IHN0YXRlIHdoZW4gY29uZGl0aW9ucyBhcmUgbm90IG1ldC4gVXNlIHN1cGVyIHRvIGNvbmNhdGVuYXRlIHZhbGlkYXRpb25zLgogICAqIEBwYXJhbSBfYmVuZWZpY2lhcnkgQWRkcmVzcyBwZXJmb3JtaW5nIHRoZSB0b2tlbiBwdXJjaGFzZQogICAqIEBwYXJhbSBfd2VpQW1vdW50IFZhbHVlIGluIHdlaSBpbnZvbHZlZCBpbiB0aGUgcHVyY2hhc2UKICAgKi8KICBmdW5jdGlvbiBfcHJlVmFsaWRhdGVQdXJjaGFzZShhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludDI1NiBfd2VpQW1vdW50KSBpbnRlcm5hbCB7CiAgICByZXF1aXJlKF9iZW5lZmljaWFyeSAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3dlaUFtb3VudCAhPSAwKTsKICB9CgogIC8qKgogICAqIEBkZXYgVmFsaWRhdGlvbiBvZiBhbiBleGVjdXRlZCBwdXJjaGFzZS4gT2JzZXJ2ZSBzdGF0ZSBhbmQgdXNlIHJldmVydCBzdGF0ZW1lbnRzIHRvIHVuZG8gcm9sbGJhY2sgd2hlbiB2YWxpZCBjb25kaXRpb25zIGFyZSBub3QgbWV0LgogICAqIEBwYXJhbSBfYmVuZWZpY2lhcnkgQWRkcmVzcyBwZXJmb3JtaW5nIHRoZSB0b2tlbiBwdXJjaGFzZQogICAqIEBwYXJhbSBfd2VpQW1vdW50IFZhbHVlIGluIHdlaSBpbnZvbHZlZCBpbiB0aGUgcHVyY2hhc2UKICAgKi8KICBmdW5jdGlvbiBfcG9zdFZhbGlkYXRlUHVyY2hhc2UoYWRkcmVzcyBfYmVuZWZpY2lhcnksIHVpbnQyNTYgX3dlaUFtb3VudCkgaW50ZXJuYWwgewogICAgLy8gb3B0aW9uYWwgb3ZlcnJpZGUKICB9CgogIC8qKgogICAqIEBkZXYgU291cmNlIG9mIHRva2Vucy4gT3ZlcnJpZGUgdGhpcyBtZXRob2QgdG8gbW9kaWZ5IHRoZSB3YXkgaW4gd2hpY2ggdGhlIGNyb3dkc2FsZSB1bHRpbWF0ZWx5IGdldHMgYW5kIHNlbmRzIGl0cyB0b2tlbnMuCiAgICogQHBhcmFtIF9iZW5lZmljaWFyeSBBZGRyZXNzIHBlcmZvcm1pbmcgdGhlIHRva2VuIHB1cmNoYXNlCiAgICogQHBhcmFtIF90b2tlbkFtb3VudCBOdW1iZXIgb2YgdG9rZW5zIHRvIGJlIGVtaXR0ZWQKICAgKi8KICBmdW5jdGlvbiBfZGVsaXZlclRva2VucyhhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludDI1NiBfdG9rZW5BbW91bnQpIGludGVybmFsIHsKICAgIHRva2VuLnRyYW5zZmVyKF9iZW5lZmljaWFyeSwgX3Rva2VuQW1vdW50KTsKICB9CgogIC8qKgogICAqIEBkZXYgRXhlY3V0ZWQgd2hlbiBhIHB1cmNoYXNlIGhhcyBiZWVuIHZhbGlkYXRlZCBhbmQgaXMgcmVhZHkgdG8gYmUgZXhlY3V0ZWQuIE5vdCBuZWNlc3NhcmlseSBlbWl0cy9zZW5kcyB0b2tlbnMuCiAgICogQHBhcmFtIF9iZW5lZmljaWFyeSBBZGRyZXNzIHJlY2VpdmluZyB0aGUgdG9rZW5zCiAgICogQHBhcmFtIF90b2tlbkFtb3VudCBOdW1iZXIgb2YgdG9rZW5zIHRvIGJlIHB1cmNoYXNlZAogICAqLwogIGZ1bmN0aW9uIF9wcm9jZXNzUHVyY2hhc2UoYWRkcmVzcyBfYmVuZWZpY2lhcnksIHVpbnQyNTYgX3Rva2VuQW1vdW50KSBpbnRlcm5hbCB7CiAgICBfZGVsaXZlclRva2VucyhfYmVuZWZpY2lhcnksIF90b2tlbkFtb3VudCk7CiAgfQoKICAvKioKICAgKiBAZGV2IE92ZXJyaWRlIGZvciBleHRlbnNpb25zIHRoYXQgcmVxdWlyZSBhbiBpbnRlcm5hbCBzdGF0ZSB0byBjaGVjayBmb3IgdmFsaWRpdHkgKGN1cnJlbnQgdXNlciBjb250cmlidXRpb25zLCBldGMuKQogICAqIEBwYXJhbSBfYmVuZWZpY2lhcnkgQWRkcmVzcyByZWNlaXZpbmcgdGhlIHRva2VucwogICAqIEBwYXJhbSBfd2VpQW1vdW50IFZhbHVlIGluIHdlaSBpbnZvbHZlZCBpbiB0aGUgcHVyY2hhc2UKICAgKi8KICBmdW5jdGlvbiBfdXBkYXRlUHVyY2hhc2luZ1N0YXRlKGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCB1aW50MjU2IF93ZWlBbW91bnQpIGludGVybmFsIHsKICAgIC8vIG9wdGlvbmFsIG92ZXJyaWRlCiAgfQoKICAvKioKICAgKiBAZGV2IE92ZXJyaWRlIHRvIGV4dGVuZCB0aGUgd2F5IGluIHdoaWNoIGV0aGVyIGlzIGNvbnZlcnRlZCB0byB0b2tlbnMuCiAgICogQHBhcmFtIF93ZWlBbW91bnQgVmFsdWUgaW4gd2VpIHRvIGJlIGNvbnZlcnRlZCBpbnRvIHRva2VucwogICAqIEByZXR1cm4gTnVtYmVyIG9mIHRva2VucyB0aGF0IGNhbiBiZSBwdXJjaGFzZWQgd2l0aCB0aGUgc3BlY2lmaWVkIF93ZWlBbW91bnQKICAgKi8KICBmdW5jdGlvbiBfZ2V0VG9rZW5BbW91bnQodWludDI1NiBfd2VpQW1vdW50KSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBfd2VpQW1vdW50Lm11bChyYXRlKTsKICB9CgogIC8qKgogICAqIEBkZXYgRGV0ZXJtaW5lcyBob3cgRVRIIGlzIHN0b3JlZC9mb3J3YXJkZWQgb24gcHVyY2hhc2VzLgogICAqLwogIGZ1bmN0aW9uIF9mb3J3YXJkRnVuZHMoKSBpbnRlcm5hbCB7CiAgICB3YWxsZXQudHJhbnNmZXIobXNnLnZhbHVlKTsKICB9Cn0KCgoKLyoqCiAqIEB0aXRsZSBUaW1lZENyb3dkc2FsZQogKiBAZGV2IENyb3dkc2FsZSBhY2NlcHRpbmcgY29udHJpYnV0aW9ucyBvbmx5IHdpdGhpbiBhIHRpbWUgZnJhbWUuCiAqLwpjb250cmFjdCBUaW1lZENyb3dkc2FsZSBpcyBDcm93ZHNhbGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICB1aW50MjU2IHB1YmxpYyBvcGVuaW5nVGltZTsKICB1aW50MjU2IHB1YmxpYyBjbG9zaW5nVGltZTsKCiAgLyoqCiAgICogQGRldiBSZXZlcnRzIGlmIG5vdCBpbiBjcm93ZHNhbGUgdGltZSByYW5nZS4KICAgKi8KICBtb2RpZmllciBvbmx5V2hpbGVPcGVuIHsKICAgIHJlcXVpcmUobm93ID49IG9wZW5pbmdUaW1lICYmIG5vdyA8PSBjbG9zaW5nVGltZSk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBDb25zdHJ1Y3RvciwgdGFrZXMgY3Jvd2RzYWxlIG9wZW5pbmcgYW5kIGNsb3NpbmcgdGltZXMuCiAgICogQHBhcmFtIF9vcGVuaW5nVGltZSBDcm93ZHNhbGUgb3BlbmluZyB0aW1lCiAgICogQHBhcmFtIF9jbG9zaW5nVGltZSBDcm93ZHNhbGUgY2xvc2luZyB0aW1lCiAgICovCiAgZnVuY3Rpb24gVGltZWRDcm93ZHNhbGUodWludDI1NiBfb3BlbmluZ1RpbWUsIHVpbnQyNTYgX2Nsb3NpbmdUaW1lKSBwdWJsaWMgewogICAgcmVxdWlyZShfb3BlbmluZ1RpbWUgPj0gbm93KTsKICAgIHJlcXVpcmUoX2Nsb3NpbmdUaW1lID49IF9vcGVuaW5nVGltZSk7CgogICAgb3BlbmluZ1RpbWUgPSBfb3BlbmluZ1RpbWU7CiAgICBjbG9zaW5nVGltZSA9IF9jbG9zaW5nVGltZTsKICB9CgogIC8qKgogICAqIEBkZXYgQ2hlY2tzIHdoZXRoZXIgdGhlIHBlcmlvZCBpbiB3aGljaCB0aGUgY3Jvd2RzYWxlIGlzIG9wZW4gaGFzIGFscmVhZHkgZWxhcHNlZC4KICAgKiBAcmV0dXJuIFdoZXRoZXIgY3Jvd2RzYWxlIHBlcmlvZCBoYXMgZWxhcHNlZAogICAqLwogIGZ1bmN0aW9uIGhhc0Nsb3NlZCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBub3cgPiBjbG9zaW5nVGltZTsKICB9CgogIC8qKgogICAqIEBkZXYgRXh0ZW5kIHBhcmVudCBiZWhhdmlvciByZXF1aXJpbmcgdG8gYmUgd2l0aGluIGNvbnRyaWJ1dGluZyBwZXJpb2QKICAgKiBAcGFyYW0gX2JlbmVmaWNpYXJ5IFRva2VuIHB1cmNoYXNlcgogICAqIEBwYXJhbSBfd2VpQW1vdW50IEFtb3VudCBvZiB3ZWkgY29udHJpYnV0ZWQKICAgKi8KICBmdW5jdGlvbiBfcHJlVmFsaWRhdGVQdXJjaGFzZShhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludDI1NiBfd2VpQW1vdW50KSBpbnRlcm5hbCBvbmx5V2hpbGVPcGVuIHsKICAgIHN1cGVyLl9wcmVWYWxpZGF0ZVB1cmNoYXNlKF9iZW5lZmljaWFyeSwgX3dlaUFtb3VudCk7CiAgfQoKfQoKCmNvbnRyYWN0IEZpbmFsaXphYmxlQ3Jvd2RzYWxlIGlzIFRpbWVkQ3Jvd2RzYWxlLCBPd25hYmxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgYm9vbCBwdWJsaWMgaXNGaW5hbGl6ZWQgPSBmYWxzZTsKCiAgZXZlbnQgRmluYWxpemVkKCk7CgogIC8qKgogICAqIEBkZXYgTXVzdCBiZSBjYWxsZWQgYWZ0ZXIgY3Jvd2RzYWxlIGVuZHMsIHRvIGRvIHNvbWUgZXh0cmEgZmluYWxpemF0aW9uCiAgICogd29yay4gQ2FsbHMgdGhlIGNvbnRyYWN0J3MgZmluYWxpemF0aW9uIGZ1bmN0aW9uLgogICAqLwogIGZ1bmN0aW9uIGZpbmFsaXplKCkgb25seU93bmVyIHB1YmxpYyB7CiAgIAogICAgcmVxdWlyZSghaXNGaW5hbGl6ZWQpOwogICAgcmVxdWlyZShoYXNDbG9zZWQoKSk7CgogICAgZmluYWxpemF0aW9uKCk7CiAgICBGaW5hbGl6ZWQoKTsKCiAgICBpc0ZpbmFsaXplZCA9IHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IENhbiBiZSBvdmVycmlkZGVuIHRvIGFkZCBmaW5hbGl6YXRpb24gbG9naWMuIFRoZSBvdmVycmlkaW5nIGZ1bmN0aW9uCiAgICogc2hvdWxkIGNhbGwgc3VwZXIuZmluYWxpemF0aW9uKCkgdG8gZW5zdXJlIHRoZSBjaGFpbiBvZiBmaW5hbGl6YXRpb24gaXMKICAgKiBleGVjdXRlZCBlbnRpcmVseS4KICAgKi8KICBmdW5jdGlvbiBmaW5hbGl6YXRpb24oKSBpbnRlcm5hbCB7CiAgfQp9CgoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICB1aW50MjU2IHRvdGFsU3VwcGx5XzsKICAKICAvKioKICAqIEBkZXYgdG90YWwgbnVtYmVyIG9mIHRva2VucyBpbiBleGlzdGVuY2UKICAqLwogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIHRvdGFsU3VwcGx5XzsKICB9CgogIC8qKgogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAqLwogCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgIHJldHVybnMgKGJvb2wpIHsKICAgICAgCiAgCiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCgovKioKICogQHRpdGxlIFN0YW5kYXJkIEVSQzIwIHRva2VuCiAqCiAqIEBkZXYgSW1wbGVtZW50YXRpb24gb2YgdGhlIGJhc2ljIHN0YW5kYXJkIHRva2VuLgogKiBAZGV2IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgRmlyc3RCbG9vZDogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sCiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBpbnRlcm5hbCBhbGxvd2VkOwoKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW19mcm9tXSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSk7CgogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICoKICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICogYW5kIHRoZSBuZXcgYWxsb3dhbmNlIGJ5IHVuZm9ydHVuYXRlIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcwogICAqIHJhY2UgY29uZGl0aW9uIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUgYWZ0ZXJ3YXJkczoKICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgKi8KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KCiAgLyoqCiAgICogQGRldiBJbmNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9hZGRlZFZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGluY3JlYXNlIHRoZSBhbGxvd2FuY2UgYnkuCiAgICovCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBEZWNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gZGVjcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zdWJ0cmFjdGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gZGVjcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKi8KICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgfSBlbHNlIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKfQoKCmNvbnRyYWN0IE1pbnRhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZSB7CiAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKICBldmVudCBNaW50RmluaXNoZWQoKTsKCiAgYm9vbCBwdWJsaWMgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CgoKICBtb2RpZmllciBjYW5NaW50KCkgewogICAgcmVxdWlyZSghbWludGluZ0ZpbmlzaGVkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIG1pbnQgdG9rZW5zCiAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgbWludGVkIHRva2Vucy4KICAgKiBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAqIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5T3duZXIgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHRvdGFsU3VwcGx5XyA9IHRvdGFsU3VwcGx5Xy5hZGQoX2Ftb3VudCk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICBNaW50KF90bywgX2Ftb3VudCk7CiAgICBUcmFuc2ZlcihhZGRyZXNzKDApLCBfdG8sIF9hbW91bnQpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHN0b3AgbWludGluZyBuZXcgdG9rZW5zLgogICAqIEByZXR1cm4gVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgIE1pbnRGaW5pc2hlZCgpOwogICAgcmV0dXJuIHRydWU7CiAgfQp9CgovKioKICogQHRpdGxlIENhcHBlZENyb3dkc2FsZQogKiBAZGV2IENyb3dkc2FsZSB3aXRoIGEgbGltaXQgZm9yIHRvdGFsIGNvbnRyaWJ1dGlvbnMuCiAqLwpjb250cmFjdCBDYXBwZWRDcm93ZHNhbGUgaXMgQ3Jvd2RzYWxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgdWludDI1NiBwdWJsaWMgY2FwOwoKICAvKioKICAgKiBAZGV2IENvbnN0cnVjdG9yLCB0YWtlcyBtYXhpbXVtIGFtb3VudCBvZiB3ZWkgYWNjZXB0ZWQgaW4gdGhlIGNyb3dkc2FsZS4KICAgKiBAcGFyYW0gX2NhcCBNYXggYW1vdW50IG9mIHdlaSB0byBiZSBjb250cmlidXRlZAogICAqLwogIGZ1bmN0aW9uIENhcHBlZENyb3dkc2FsZSh1aW50MjU2IF9jYXApIHB1YmxpYyB7CiAgICByZXF1aXJlKF9jYXAgPiAwKTsKICAgIGNhcCA9IF9jYXA7CiAgfQoKICAvKioKICAgKiBAZGV2IENoZWNrcyB3aGV0aGVyIHRoZSBjYXAgaGFzIGJlZW4gcmVhY2hlZC4KICAgKiBAcmV0dXJuIFdoZXRoZXIgdGhlIGNhcCB3YXMgcmVhY2hlZAogICAqLwogIGZ1bmN0aW9uIGNhcFJlYWNoZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gd2VpUmFpc2VkID49IGNhcDsKICB9CgogIC8qKgogICAqIEBkZXYgRXh0ZW5kIHBhcmVudCBiZWhhdmlvciByZXF1aXJpbmcgcHVyY2hhc2UgdG8gcmVzcGVjdCB0aGUgZnVuZGluZyBjYXAuCiAgICogQHBhcmFtIF9iZW5lZmljaWFyeSBUb2tlbiBwdXJjaGFzZXIKICAgKiBAcGFyYW0gX3dlaUFtb3VudCBBbW91bnQgb2Ygd2VpIGNvbnRyaWJ1dGVkCiAgICovCiAgZnVuY3Rpb24gX3ByZVZhbGlkYXRlUHVyY2hhc2UoYWRkcmVzcyBfYmVuZWZpY2lhcnksIHVpbnQyNTYgX3dlaUFtb3VudCkgaW50ZXJuYWwgewogICAgc3VwZXIuX3ByZVZhbGlkYXRlUHVyY2hhc2UoX2JlbmVmaWNpYXJ5LCBfd2VpQW1vdW50KTsKICAgIHJlcXVpcmUod2VpUmFpc2VkLmFkZChfd2VpQW1vdW50KSA8PSBjYXApOwogIH0KCn0KCmNvbnRyYWN0IFdoaXRlbGlzdGVkQ3Jvd2RzYWxlIGlzIENyb3dkc2FsZSwgT3duYWJsZSB7CgogIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgd2hpdGVsaXN0OwoKICAvKioKICAgKiBAZGV2IFJldmVydHMgaWYgYmVuZWZpY2lhcnkgaXMgbm90IHdoaXRlbGlzdGVkLiBDYW4gYmUgdXNlZCB3aGVuIGV4dGVuZGluZyB0aGlzIGNvbnRyYWN0LgogICAqLwogIG1vZGlmaWVyIGlzV2hpdGVsaXN0ZWQoYWRkcmVzcyBfYmVuZWZpY2lhcnkpIHsKICAgIHJlcXVpcmUod2hpdGVsaXN0W19iZW5lZmljaWFyeV0pOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgQWRkcyBzaW5nbGUgYWRkcmVzcyB0byB3aGl0ZWxpc3QuCiAgICogQHBhcmFtIF9iZW5lZmljaWFyeSBBZGRyZXNzIHRvIGJlIGFkZGVkIHRvIHRoZSB3aGl0ZWxpc3QKICAgKi8KICBmdW5jdGlvbiBhZGRUb1doaXRlbGlzdChhZGRyZXNzIF9iZW5lZmljaWFyeSkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIHdoaXRlbGlzdFtfYmVuZWZpY2lhcnldID0gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgQWRkcyBsaXN0IG9mIGFkZHJlc3NlcyB0byB3aGl0ZWxpc3QuIE5vdCBvdmVybG9hZGVkIGR1ZSB0byBsaW1pdGF0aW9ucyB3aXRoIHRydWZmbGUgdGVzdGluZy4KICAgKiBAcGFyYW0gX2JlbmVmaWNpYXJpZXMgQWRkcmVzc2VzIHRvIGJlIGFkZGVkIHRvIHRoZSB3aGl0ZWxpc3QKICAgKi8KICBmdW5jdGlvbiBhZGRNYW55VG9XaGl0ZWxpc3QoYWRkcmVzc1tdIF9iZW5lZmljaWFyaWVzKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgZm9yICh1aW50MjU2IGkgPSAwOyBpIDwgX2JlbmVmaWNpYXJpZXMubGVuZ3RoOyBpKyspIHsKICAgICAgd2hpdGVsaXN0W19iZW5lZmljaWFyaWVzW2ldXSA9IHRydWU7CiAgICB9CiAgfQoKICAvKioKICAgKiBAZGV2IFJlbW92ZXMgc2luZ2xlIGFkZHJlc3MgZnJvbSB3aGl0ZWxpc3QuCiAgICogQHBhcmFtIF9iZW5lZmljaWFyeSBBZGRyZXNzIHRvIGJlIHJlbW92ZWQgdG8gdGhlIHdoaXRlbGlzdAogICAqLwogIGZ1bmN0aW9uIHJlbW92ZUZyb21XaGl0ZWxpc3QoYWRkcmVzcyBfYmVuZWZpY2lhcnkpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICB3aGl0ZWxpc3RbX2JlbmVmaWNpYXJ5XSA9IGZhbHNlOwogIH0KCiAgLyoqCiAgICogQGRldiBFeHRlbmQgcGFyZW50IGJlaGF2aW9yIHJlcXVpcmluZyBiZW5lZmljaWFyeSB0byBiZSBpbiB3aGl0ZWxpc3QuCiAgICogQHBhcmFtIF9iZW5lZmljaWFyeSBUb2tlbiBiZW5lZmljaWFyeQogICAqIEBwYXJhbSBfd2VpQW1vdW50IEFtb3VudCBvZiB3ZWkgY29udHJpYnV0ZWQKICAgKi8KICBmdW5jdGlvbiBfcHJlVmFsaWRhdGVQdXJjaGFzZShhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludDI1NiBfd2VpQW1vdW50KSBpbnRlcm5hbCBpc1doaXRlbGlzdGVkKF9iZW5lZmljaWFyeSkgewogICAgc3VwZXIuX3ByZVZhbGlkYXRlUHVyY2hhc2UoX2JlbmVmaWNpYXJ5LCBfd2VpQW1vdW50KTsKICB9Cgp9CgoKCgovKioKICogQHRpdGxlIE1pbnRlZENyb3dkc2FsZQogKiBAZGV2IEV4dGVuc2lvbiBvZiBDcm93ZHNhbGUgY29udHJhY3Qgd2hvc2UgdG9rZW5zIGFyZSBtaW50ZWQgaW4gZWFjaCBwdXJjaGFzZS4KICogVG9rZW4gb3duZXJzaGlwIHNob3VsZCBiZSB0cmFuc2ZlcnJlZCB0byBNaW50ZWRDcm93ZHNhbGUgZm9yIG1pbnRpbmcuCiAqLwpjb250cmFjdCBNaW50ZWRDcm93ZHNhbGUgaXMgQ3Jvd2RzYWxlIHsKCiAgLyoqCiAgKiBAZGV2IE92ZXJyaWRlcyBkZWxpdmVyeSBieSBtaW50aW5nIHRva2VucyB1cG9uIHB1cmNoYXNlLgogICogQHBhcmFtIF9iZW5lZmljaWFyeSBUb2tlbiBwdXJjaGFzZXIKICAqIEBwYXJhbSBfdG9rZW5BbW91bnQgTnVtYmVyIG9mIHRva2VucyB0byBiZSBtaW50ZWQKICAqLwogIGZ1bmN0aW9uIF9kZWxpdmVyVG9rZW5zKGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCB1aW50MjU2IF90b2tlbkFtb3VudCkgaW50ZXJuYWwgewogICAgcmVxdWlyZShNaW50YWJsZVRva2VuKHRva2VuKS5taW50KF9iZW5lZmljaWFyeSwgX3Rva2VuQW1vdW50KSk7CiAgfQp9CgoKCi8qKgogKiBAdGl0bGUgRGFndENyb3dkc2FsZQogKiBAZGV2IERBR1QgVG9rZW4gdGhhdCBjYW4gYmUgbWludGVkLgogKiBJdCBpcyBtZWFudCB0byBiZSB1c2VkIGluIGEgY3Jvd2RzYWxlIGNvbnRyYWN0LgogKi8KY29udHJhY3QgRGFndENyb3dkc2FsZSBpcyBDYXBwZWRDcm93ZHNhbGUsIE1pbnRlZENyb3dkc2FsZSwgRmluYWxpemFibGVDcm93ZHNhbGUsIFdoaXRlbGlzdGVkQ3Jvd2RzYWxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogICAgLy8gQ29uc3RhbnRzCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHZlcnNpb24gPSAiMS4xIjsKICAgIC8vIERBR1QgdG9rZW4gdW5pdC4xMDAwMDAwMDAwMDAwMDAwMDAwCiAgICAvLyBVc2luZyBzYW1lIGRlY2ltYWwgdmFsdWUgYXMgRVRIIChtYWtlcyBFVEgtREFHVCBjb252ZXJzaW9uIG11Y2ggZWFzaWVyKS4KICAgIC8vIFRoaXMgaXMgdGhlIHNhbWUgYXMgaW4gREFHVCB0b2tlbiBjb250cmFjdC4KICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IFRPS0VOX1VOSVQgPSAxMCAqKiAxODsKICAgIC8vIE1heGltdW0gbnVtYmVyIG9mIHRva2VucyBpbiBjaXJjdWxhdGlvbgogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgTUFYX1RPS0VOUyA9IDEwMDAwMDAwMCAqIFRPS0VOX1VOSVQ7CiAgICAvLyBWYWx1ZXMgc2hvdWxkIGJlIDEweCBwZXJjZW50cywgdmFsdWUgMTAwMCA9IDEwMCUKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IEJPTlVTX0NPRUZGID0gMTAwMDsgCiAgICAvLyBWYXJpYWJsZXMKICAgIGFkZHJlc3MgcHVibGljIHJlbWFpbmluZ1Rva2Vuc1dhbGxldDsKICAgIHVpbnQgcHVibGljIGxvY2tpbmdSYXRpbzsKICAgIHVpbnQyNTYgcHVibGljIG1pbldlaUFtb3VudDsKCiAgICAgLy8gVGhlIGZvbGxvd2luZyB3aWxsIGJlIHBvcHVsYXRlZCBieSBtYWluIGNyb3dkc2FsZSBjb250cmFjdAogICAgdWludDMyW10gcHVibGljIEJPTlVTX1RJTUVTOwogICAgdWludDMyW10gcHVibGljIEJPTlVTX1RJTUVTX1ZBTFVFUzsKICAgIHVpbnQyNTZbXSBwdWJsaWMgQk9OVVNfQU1PVU5UUzsKICAgIHVpbnQzMltdIHB1YmxpYyBCT05VU19BTU9VTlRTX1ZBTFVFUzsKICAgIC8qKgogICAgKiBAZGV2IENvbnN0cnVjdG9yLCB0YWtlcyBjcm93ZHNhbGUgb3BlbmluZyBhbmQgY2xvc2luZyB0aW1lcy4KICAgICogQHBhcmFtIF9vcGVuaW5nVGltZSBjcm93ZHNhbGUgb3BlbmluZyB0aW1lCiAgICAqIEBwYXJhbSBfY2xvc2luZ1RpbWUgY3Jvd2RzYWxlIGNsb3NpbmcgdGltZQogICAgKiBAcGFyYW0gX3JhdGUgTnVtYmVyIG9mIHRva2VuIHVuaXRzIGEgYnV5ZXIgZ2V0cyBwZXIgd2VpCiAgICAqIEBwYXJhbSBfd2FsbGV0IEFkZHJlc3Mgd2hlcmUgY29sbGVjdGVkIGZ1bmRzIHdpbGwgYmUgZm9yd2FyZGVkIHRvCiAgICAqIEBwYXJhbSBfcmVtYWluaW5nVG9rZW5zV2FsbGV0IHJlbWFpbmluZyB0b2tlbnMgd2FsbGV0CiAgICAqIEBwYXJhbSBfY2FwIE1heCBhbW91bnQgb2Ygd2VpIHRvIGJlIGNvbnRyaWJ1dGVkCiAgICAqIEBwYXJhbSBfbG9ja2luZ1JhdGlvIGxvY2tpbmcgcmF0aW8gZXhjZXB0IGJ1bnVzCiAgICAqIEBwYXJhbSBfdG9rZW4gQWRkcmVzcyBvZiB0aGUgdG9rZW4gYmVpbmcgc29sZAogICAgKi8KICAgIGZ1bmN0aW9uIERhZ3RDcm93ZHNhbGUodWludDI1NiBfb3BlbmluZ1RpbWUsIHVpbnQyNTYgX2Nsb3NpbmdUaW1lLCB1aW50MjU2IF9yYXRlLCBhZGRyZXNzIF93YWxsZXQsIGFkZHJlc3MgX3JlbWFpbmluZ1Rva2Vuc1dhbGxldCwgdWludDI1NiBfY2FwLCB1aW50IF9sb2NraW5nUmF0aW8sIE1pbnRhYmxlVG9rZW4gX3Rva2VuKSBwdWJsaWMKICAgICAgICBDcm93ZHNhbGUoX3JhdGUsIF93YWxsZXQsIF90b2tlbikKICAgICAgICBDYXBwZWRDcm93ZHNhbGUoX2NhcCkKICAgICAgICBUaW1lZENyb3dkc2FsZShfb3BlbmluZ1RpbWUsIF9jbG9zaW5nVGltZSkgewogICAgICAgICAgICAKICAgICAgICByZXF1aXJlKF9yZW1haW5pbmdUb2tlbnNXYWxsZXQgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVtYWluaW5nVG9rZW5zV2FsbGV0ID0gX3JlbWFpbmluZ1Rva2Vuc1dhbGxldDsKICAgICAgICBzZXRMb2NrZWRSYXRpbyhfbG9ja2luZ1JhdGlvKTsKICAgIH0KICAgIC8qKgogICAgKiBAZGV2IENoZWNrcyB3aGV0aGVyIF9iZW5lZmljaWFyeSBpbiB3aGl0ZWxpc3RlZCBmb3IgdGhlIFByZXNhbGUgQW5kIHNhbGUuCiAgICAqIEBwYXJhbSBfYmVuZWZpY2lhcnkgLCBVc2VyJ3MgQWRkcmVzcy4gCiAgICAqIEByZXR1cm4gV2hldGhlciBfYmVuZWZpY2lhcnkgaW4gd2hpdGVsaXN0ZWQuCiAgICAqLwogICAgZnVuY3Rpb24gaXNXaGl0ZWxpc3RlZEFkZHJlc3MoYWRkcmVzcyBfYmVuZWZpY2lhcnkpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHdoaXRlbGlzdFtfYmVuZWZpY2lhcnldOwogICAgfQogICAgLyoqCiAgICAqIEBkZXYgT3ZlcnJpZGUgdG8gZXh0ZW5kIHRoZSB3YXkgaW4gd2hpY2ggZXRoZXIgaXMgY29udmVydGVkIHRvIHRva2Vucy4KICAgICogQHBhcmFtIF93ZWlBbW91bnQgVmFsdWUgaW4gd2VpIHRvIGJlIGNvbnZlcnRlZCBpbnRvIHRva2VucwogICAgKiBAcmV0dXJuIE51bWJlciBvZiB0b2tlbnMgdGhhdCBjYW4gYmUgcHVyY2hhc2VkIHdpdGggdGhlIHNwZWNpZmllZCBfd2VpQW1vdW50CiAgICAqLwogICAgZnVuY3Rpb24gX2dldFRva2VuQW1vdW50KHVpbnQyNTYgX3dlaUFtb3VudCkgaW50ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGNvbXB1dGVUb2tlbnMoX3dlaUFtb3VudCk7CiAgICB9CiAgICAvKioKICAgICogQGRldiBDYW4gYmUgb3ZlcnJpZGRlbiB0byBhZGQgZmluYWxpemF0aW9uIGxvZ2ljLiBUaGUgb3ZlcnJpZGluZyBmdW5jdGlvbgogICAgKiBzaG91bGQgY2FsbCBzdXBlci5maW5hbGl6YXRpb24oKSB0byBlbnN1cmUgdGhlIGNoYWluIG9mIGZpbmFsaXphdGlvbiBpcwogICAgKiBleGVjdXRlZCBlbnRpcmVseS4KICAgICovCiAgICBmdW5jdGlvbiBmaW5hbGl6YXRpb24oKSBpbnRlcm5hbCB7CiAgICAgICAgLy9EQUdUIGdldHMgMjAlIG9mIHRoZSBhbW91bnQgb2YgdGhlIHRvdGFsIHRva2VuIHN1cHBseQogICAgICAgIHVpbnQyNTYgdG90YWxTdXBwbHkgPSB0b2tlbi50b3RhbFN1cHBseSgpOwogICAgICAgIC8vIC8vIHRvdGFsIHJlbWFpbmluZyBUb2tlbnMKICAgICAgICAvL01pbnRhYmxlVG9rZW4gdG9rZW4gPSBNaW50YWJsZVRva2VuKHRva2VuKTsKICAgICAgICBNaW50YWJsZVRva2VuKHRva2VuKS5taW50KHJlbWFpbmluZ1Rva2Vuc1dhbGxldCxNQVhfVE9LRU5TLnN1Yih0b3RhbFN1cHBseSkpOwogICAgICAgIE1pbnRhYmxlVG9rZW4odG9rZW4pLmZpbmlzaE1pbnRpbmcoKTsKICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgICBzdXBlci5maW5hbGl6YXRpb24oKTsKICAgIH0KICAgIC8qKgogICAgKiBAZGV2IE92ZXJyaWRkZW4gVGltZWRDcm93ZHNhbGUsIHRha2VzIGNyb3dkc2FsZSBvcGVuaW5nIGFuZCBjbG9zaW5nIHRpbWVzLgogICAgKiBAcGFyYW0gX29wZW5pbmdUaW1lIENyb3dkc2FsZSBvcGVuaW5nIHRpbWUKICAgICogQHBhcmFtIF9jbG9zaW5nVGltZSBDcm93ZHNhbGUgY2xvc2luZyB0aW1lCiAgICAqLwogICAgZnVuY3Rpb24gc2V0VGltZWRDcm93ZHNhbGUodWludDI1NiBfb3BlbmluZ1RpbWUsIHVpbnQyNTYgX2Nsb3NpbmdUaW1lKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICAvLyByZXF1aXJlKF9vcGVuaW5nVGltZSA+PSBub3cpOwogICAgICAgIHJlcXVpcmUoX2Nsb3NpbmdUaW1lID49IF9vcGVuaW5nVGltZSk7CgogICAgICAgIG9wZW5pbmdUaW1lID0gX29wZW5pbmdUaW1lOwogICAgICAgIGNsb3NpbmdUaW1lID0gX2Nsb3NpbmdUaW1lOwogICAgfQogICAgLyoqCiAgICAqIEBkZXYgQ29tcHV0ZXMgb3ZlcmFsbCBib251cyBiYXNlZCBvbiB0aW1lIG9mIGNvbnRyaWJ1dGlvbiBhbmQgYW1vdW50IG9mIGNvbnRyaWJ1dGlvbi4gCiAgICAqIFRoZSB0b3RhbCBib251cyBpcyB0aGUgc3VtIG9mIGJvbnVzIGJ5IHRpbWUgYW5kIGJvbnVzIGJ5IGFtb3VudAogICAgKiBAcmV0dXJuIHRva2VucyAKICAgICovCiAgICBmdW5jdGlvbiBjb21wdXRlVG9rZW5zKHVpbnQyNTYgX3dlaUFtb3VudCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludDI1NikgewogICAgICAgIGlmKF93ZWlBbW91bnQgPCBtaW5XZWlBbW91bnQpeyAKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHVpbnQyNTYgdG9rZW5zID0gX3dlaUFtb3VudC5tdWwocmF0ZS5tdWwoY29tcHV0ZVRpbWVCb251cyhub3cpKSkuZGl2KEJPTlVTX0NPRUZGKTsKICAgICAgICB1aW50MjU2IGJvbnVzID0gdG9rZW5zLm11bChjb21wdXRlQW1vdW50Qm9udXMoX3dlaUFtb3VudCkpLmRpdihCT05VU19DT0VGRik7CiAgICAgICAgcmV0dXJuIHRva2Vucy5kaXYobG9ja2luZ1JhdGlvKS5hZGQoYm9udXMpOwogICAgfQogICAgLyoqCiAgICAqIEBkZXYgU2V0IHRoZSBNaW5pbXVtIG9mIGludmVzdG1lbnQuIAogICAgKiBAcGFyYW0gX21pbldlaUFtb3VudCBWYWx1ZSBpbiB3ZWkKICAgICovCiAgICBmdW5jdGlvbiBzZXRNaW5BbW91bnQodWludDI1NiBfbWluV2VpQW1vdW50KSAgcHVibGljIG9ubHlPd25lcnsKICAgICAgICByZXF1aXJlKF9taW5XZWlBbW91bnQgPiB1aW50MjU2KDApKTsKICAgICAgICBtaW5XZWlBbW91bnQgPSBfbWluV2VpQW1vdW50OwogICAgfQogICAgCiAgIC8qKgogICAgKiBAZGV2IFNldCB0aGUgbG9ja2luZ1JhdGlvICBvZiAgdG90YWwgYm9udXMgdGhhdCBpcyB0aGUgc3VtIG9mIGJvbnVzIGJ5IHRpbWUuIAogICAgKiBAcGFyYW0gX2xvY2tpbmdSYXRpbyBsb2NraW5nIHJhdGlvIGV4Y2VwdCBidW51cwogICAgKi8KICAgIGZ1bmN0aW9uIHNldExvY2tlZFJhdGlvKHVpbnQgX2xvY2tpbmdSYXRpbykgIHB1YmxpYyBvbmx5T3duZXJ7CiAgICAgICAgcmVxdWlyZShfbG9ja2luZ1JhdGlvID4gdWludCgwKSk7CiAgICAgICAgbG9ja2luZ1JhdGlvID0gX2xvY2tpbmdSYXRpbzsKICAgIH0KICAgIC8qKgogICAgICogKiBAZGV2IENvbXB1dGVzIGJvbnVzIGJhc2VkIG9uIHRpbWUgb2YgY29udHJpYnV0aW9uIHJlbGF0aXZlIHRvIHRoZSBiZWdpbm5pbmcgb2YgY3Jvd2RzYWxlCiAgICAqIEByZXR1cm4gYm9udXMgCiAgICAqLwogICAgZnVuY3Rpb24gY29tcHV0ZVRpbWVCb251cyh1aW50MjU2IF90aW1lKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgcmVxdWlyZShfdGltZSA+PSBvcGVuaW5nVGltZSk7CgogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IEJPTlVTX1RJTUVTLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChfdGltZS5zdWIob3BlbmluZ1RpbWUpIDw9IEJPTlVTX1RJTUVTW2ldKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gQk9OVVNfVElNRVNfVkFMVUVTW2ldOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiAwOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IENvbXB1dGVzIGJvbnVzIGJhc2VkIG9uIGFtb3VudCBvZiBjb250cmlidXRpb24KICAgICogQHJldHVybiBib251cyAKICAgICovCiAgICBmdW5jdGlvbiBjb21wdXRlQW1vdW50Qm9udXModWludDI1NiBfd2VpQW1vdW50KSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgQk9OVVNfQU1PVU5UUy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoX3dlaUFtb3VudCA+PSBCT05VU19BTU9VTlRTW2ldKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gQk9OVVNfQU1PVU5UU19WQUxVRVNbaV07CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICAgIC8qKgogICAgKiBAZGV2IFJldHJpZXZlIGxlbmd0aCBvZiBib251c2VzIGJ5IHRpbWUgYXJyYXkKICAgICogQHJldHVybiBCb251c2VzIGJ5IHRpbWUgYXJyYXkgbGVuZ3RoCiAgICAqLwogICAgZnVuY3Rpb24gYm9udXNlc0ZvclRpbWVzQ291bnQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50KSB7CiAgICAgICAgcmV0dXJuIEJPTlVTX1RJTUVTLmxlbmd0aDsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBTZXRzIGJvbnVzZXMgZm9yIHRpbWUKICAgICovCiAgICBmdW5jdGlvbiBzZXRCb251c2VzRm9yVGltZXModWludDMyW10gdGltZXMsIHVpbnQzMltdIHZhbHVlcykgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZSh0aW1lcy5sZW5ndGggPT0gdmFsdWVzLmxlbmd0aCk7CiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpICsgMSA8IHRpbWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHJlcXVpcmUodGltZXNbaV0gPCB0aW1lc1tpKzFdKTsKICAgICAgICB9CgogICAgICAgIEJPTlVTX1RJTUVTID0gdGltZXM7CiAgICAgICAgQk9OVVNfVElNRVNfVkFMVUVTID0gdmFsdWVzOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IFJldHJpZXZlIGxlbmd0aCBvZiBib251c2VzIGJ5IGFtb3VudHMgYXJyYXkKICAgICogQHJldHVybiBCb251c2VzIGJ5IGFtb3VudHMgYXJyYXkgbGVuZ3RoCiAgICAqLwogICAgZnVuY3Rpb24gYm9udXNlc0ZvckFtb3VudHNDb3VudCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsKICAgICAgICByZXR1cm4gQk9OVVNfQU1PVU5UUy5sZW5ndGg7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgU2V0cyBib251c2VzIGZvciBVU0QgYW1vdW50cwogICAgKi8KICAgIGZ1bmN0aW9uIHNldEJvbnVzZXNGb3JBbW91bnRzKHVpbnQyNTZbXSBhbW91bnRzLCB1aW50MzJbXSB2YWx1ZXMpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoYW1vdW50cy5sZW5ndGggPT0gdmFsdWVzLmxlbmd0aCk7CiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpICsgMSA8IGFtb3VudHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgcmVxdWlyZShhbW91bnRzW2ldID4gYW1vdW50c1tpKzFdKTsKICAgICAgICB9CgogICAgICAgIEJPTlVTX0FNT1VOVFMgPSBhbW91bnRzOwogICAgICAgIEJPTlVTX0FNT1VOVFNfVkFMVUVTID0gdmFsdWVzOwogICAgfQoKfQ=='.
	

]
