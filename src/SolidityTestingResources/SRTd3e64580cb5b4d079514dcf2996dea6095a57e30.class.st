Class {
	#name : #SRTd3e64580cb5b4d079514dcf2996dea6095a57e30,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd3e64580cb5b4d079514dcf2996dea6095a57e30 >> base64 [
	^ 'LyoKICAgQlVSU0EgREVYICAgICAgICAgICAgICBTb3VyY2UgY29kZSBhdmFpbGFibGUgdW5kZXIgR1BMdjIgbGljZW5zZQogICAgICAgICAgICAgICAgICAgICAgICAgIDIwMTggIE1pY2hhZWwgQmF5bm92IDw8YSBocmVmPSIvY2RuLWNnaS9sL2VtYWlsLXByb3RlY3Rpb24iIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iNjUwODRiMDcwNDFjMGIwYTEzMjUwMjA4MDQwYzA5NGIwNjBhMDgiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+PgoKICAgQlVSU0EgIGlzIGEgbmV3IGdlbmVyYXRpb24gb2YgZGVjZW50cmFsaXplZCBleGNoYW5nZXMgYmFzZWQgb24KICAgc3RhdGUgc3RvcmFnZSwgbm90IGxvZ3MgKGV2ZW50cykuIEl0IGlzIGRlc2lnbmVkIHRvIGJlIHVzZWQgYm90aAogICB3aXRoIG9yIHdpdGhvdXQgYSBmcm9udGVuZC4gQSBEQVBQIGNvbm5lY3RlZCB0byBCVVJTQSBjb250cmFjdAogICB3aWxsIHJlY2VpdmUgMzAlIHNoYXJlIG9mIHRyYWRlIGZlZS4gVG8gaGF2ZSBpdCwganVzdCBwYXNzIHRoZQogICByZWZ1bmQgYWRkcmVzcyBhcyB0aGUgbGFzdCBhcmd1bWVudCB0byBidXkoKSBhbmQgc2VsbCgpIG1ldGhvZHMuCiAgIFRyYWRpbmcgd2l0aG91dCBhIGZyb250ZW5kIGdpdmVzIHlvdSAzMCUgZGVzY291bnQuCiAgIEJVUlNBIGlzIHJlY29tbWVuZGVkIHRvIGJlIHVzZWQgd2l0aCBQYXJpdHkgV2FsbGV0LgoKCiAgIFdBTlQgVE8gVFJBREUgT04gQlVSU0E/IFJFQUQgVEhFIERPQ1M6CiAgIGh0dHBzOi8vZ2l0aHViLmNvbS90ZXJtc2xhbmcvYnVyc2FkZXgKCgpCVVJTQSBDT05UUkFDVCBBQkk6Clt7ImNvbnN0YW50IjpmYWxzZSwiaW5wdXRzIjpbeyJuYW1lIjoiYW1vdW50IiwidHlwZSI6InVpbnQyNTYifSx7Im5hbWUiOiJ0b2tlbiIsInR5cGUiOiJhZGRyZXNzIn0seyJuYW1lIjoicHJpY2VfZWFjaCIsInR5cGUiOiJ1aW50MjU2In0seyJuYW1lIjoiYmlkX29yZGVyX3Nwb3QiLCJ0eXBlIjoidWludDI1NiJ9XSwibmFtZSI6IndpbGxidXkiLCJvdXRwdXRzIjpbeyJuYW1lIjoiIiwidHlwZSI6ImJvb2wifV0sInBheWFibGUiOnRydWUsInN0YXRlTXV0YWJpbGl0eSI6InBheWFibGUiLCJ0eXBlIjoiZnVuY3Rpb24ifSx7ImNvbnN0YW50Ijp0cnVlLCJpbnB1dHMiOltdLCJuYW1lIjoidXBkYXRlQXZhaWxhYmxlIiwib3V0cHV0cyI6W3sibmFtZSI6IiIsInR5cGUiOiJhZGRyZXNzIn1dLCJwYXlhYmxlIjpmYWxzZSwic3RhdGVNdXRhYmlsaXR5IjoidmlldyIsInR5cGUiOiJmdW5jdGlvbiJ9LHsiY29uc3RhbnQiOnRydWUsImlucHV0cyI6W10sIm5hbWUiOiJuYW1lIiwib3V0cHV0cyI6W3sibmFtZSI6IiIsInR5cGUiOiJzdHJpbmcifV0sInBheWFibGUiOmZhbHNlLCJzdGF0ZU11dGFiaWxpdHkiOiJ2aWV3IiwidHlwZSI6ImZ1bmN0aW9uIn0seyJjb25zdGFudCI6dHJ1ZSwiaW5wdXRzIjpbeyJuYW1lIjoidG9rZW4iLCJ0eXBlIjoiYWRkcmVzcyJ9LHsibmFtZSI6Im1pbl90cmFkZV9hbW91bnQiLCJ0eXBlIjoidWludDI1NiJ9XSwibmFtZSI6ImZpbmRCZXN0QmlkIiwib3V0cHV0cyI6W3sibmFtZSI6ImJpZF9vcmRlciIsInR5cGUiOiJ1aW50MjU2In0seyJuYW1lIjoidm9sdW1lIiwidHlwZSI6InVpbnQyNTYifSx7Im5hbWUiOiJwcmljZSIsInR5cGUiOiJ1aW50MjU2In1dLCJwYXlhYmxlIjpmYWxzZSwic3RhdGVNdXRhYmlsaXR5IjoidmlldyIsInR5cGUiOiJmdW5jdGlvbiJ9LHsiY29uc3RhbnQiOmZhbHNlLCJpbnB1dHMiOlt7Im5hbWUiOiJhbW91bnQiLCJ0eXBlIjoidWludDI1NiJ9XSwibmFtZSI6IndpdGhkcmF3Iiwib3V0cHV0cyI6W10sInBheWFibGUiOmZhbHNlLCJzdGF0ZU11dGFiaWxpdHkiOiJub25wYXlhYmxlIiwidHlwZSI6ImZ1bmN0aW9uIn0seyJjb25zdGFudCI6dHJ1ZSwiaW5wdXRzIjpbeyJuYW1lIjoidG9rZW4iLCJ0eXBlIjoiYWRkcmVzcyJ9LHsibmFtZSI6InVzZXIiLCJ0eXBlIjoiYWRkcmVzcyJ9XSwibmFtZSI6ImJhbGFuY2VBcHByb3ZlZEZvclRva2VuIiwib3V0cHV0cyI6W3sibmFtZSI6ImFtb3VudCIsInR5cGUiOiJ1aW50MjU2In1dLCJwYXlhYmxlIjpmYWxzZSwic3RhdGVNdXRhYmlsaXR5IjoidmlldyIsInR5cGUiOiJmdW5jdGlvbiJ9LHsiY29uc3RhbnQiOnRydWUsImlucHV0cyI6W3sibmFtZSI6InVzZXIiLCJ0eXBlIjoiYWRkcmVzcyJ9XSwibmFtZSI6ImJhbGFuY2VPZiIsIm91dHB1dHMiOlt7Im5hbWUiOiJiYWxhbmNlIiwidHlwZSI6InVpbnQyNTYifV0sInBheWFibGUiOmZhbHNlLCJzdGF0ZU11dGFiaWxpdHkiOiJ2aWV3IiwidHlwZSI6ImZ1bmN0aW9uIn0seyJjb25zdGFudCI6dHJ1ZSwiaW5wdXRzIjpbeyJuYW1lIjoidG9rZW4iLCJ0eXBlIjoiYWRkcmVzcyJ9LHsibmFtZSI6ImFza19vcmRlciIsInR5cGUiOiJ1aW50MjU2In1dLCJuYW1lIjoid2lsbHNlbGxJbmZvIiwib3V0cHV0cyI6W3sibmFtZSI6InVzZXIiLCJ0eXBlIjoiYWRkcmVzcyJ9LHsibmFtZSI6InByaWNlIiwidHlwZSI6InVpbnQyNTYifSx7Im5hbWUiOiJhbW91bnQiLCJ0eXBlIjoidWludDI1NiJ9XSwicGF5YWJsZSI6ZmFsc2UsInN0YXRlTXV0YWJpbGl0eSI6InZpZXciLCJ0eXBlIjoiZnVuY3Rpb24ifSx7ImNvbnN0YW50IjpmYWxzZSwiaW5wdXRzIjpbeyJuYW1lIjoiYW1vdW50IiwidHlwZSI6InVpbnQyNTYifSx7Im5hbWUiOiJ0b2tlbiIsInR5cGUiOiJhZGRyZXNzIn0seyJuYW1lIjoibWluX3ByaWNlX2VhY2giLCJ0eXBlIjoidWludDI1NiJ9LHsibmFtZSI6ImJpZF9vcmRlciIsInR5cGUiOiJ1aW50MjU2In0seyJuYW1lIjoiZnJvbnRlbmRfcmVmdW5kIiwidHlwZSI6ImFkZHJlc3MifV0sIm5hbWUiOiJzZWxsIiwib3V0cHV0cyI6W3sibmFtZSI6IiIsInR5cGUiOiJib29sIn1dLCJwYXlhYmxlIjp0cnVlLCJzdGF0ZU11dGFiaWxpdHkiOiJwYXlhYmxlIiwidHlwZSI6ImZ1bmN0aW9uIn0seyJjb25zdGFudCI6dHJ1ZSwiaW5wdXRzIjpbeyJuYW1lIjoidG9rZW4iLCJ0eXBlIjoiYWRkcmVzcyJ9LHsibmFtZSI6Im1pbl90cmFkZV9hbW91bnQiLCJ0eXBlIjoidWludDI1NiJ9XSwibmFtZSI6ImZpbmRCZXN0QXNrIiwib3V0cHV0cyI6W3sibmFtZSI6ImFza19vcmRlciIsInR5cGUiOiJ1aW50MjU2In0seyJuYW1lIjoidm9sdW1lIiwidHlwZSI6InVpbnQyNTYifSx7Im5hbWUiOiJwcmljZSIsInR5cGUiOiJ1aW50MjU2In1dLCJwYXlhYmxlIjpmYWxzZSwic3RhdGVNdXRhYmlsaXR5IjoidmlldyIsInR5cGUiOiJmdW5jdGlvbiJ9LHsiY29uc3RhbnQiOmZhbHNlLCJpbnB1dHMiOlt7Im5hbWUiOiJhbW91bnQiLCJ0eXBlIjoidWludDI1NiJ9LHsibmFtZSI6InRva2VuIiwidHlwZSI6ImFkZHJlc3MifSx7Im5hbWUiOiJwcmljZV9lYWNoIiwidHlwZSI6InVpbnQyNTYifSx7Im5hbWUiOiJhc2tfb3JkZXJfc3BvdCIsInR5cGUiOiJ1aW50MjU2In1dLCJuYW1lIjoid2lsbHNlbGwiLCJvdXRwdXRzIjpbeyJuYW1lIjoiIiwidHlwZSI6ImJvb2wifV0sInBheWFibGUiOnRydWUsInN0YXRlTXV0YWJpbGl0eSI6InBheWFibGUiLCJ0eXBlIjoiZnVuY3Rpb24ifSx7ImNvbnN0YW50Ijp0cnVlLCJpbnB1dHMiOlt7Im5hbWUiOiJ0b2tlbiIsInR5cGUiOiJhZGRyZXNzIn0seyJuYW1lIjoiYmlkX29yZGVyIiwidHlwZSI6InVpbnQyNTYifV0sIm5hbWUiOiJ3aWxsYnV5SW5mbyIsIm91dHB1dHMiOlt7Im5hbWUiOiJ1c2VyIiwidHlwZSI6ImFkZHJlc3MifSx7Im5hbWUiOiJwcmljZSIsInR5cGUiOiJ1aW50MjU2In0seyJuYW1lIjoiYW1vdW50IiwidHlwZSI6InVpbnQyNTYifV0sInBheWFibGUiOmZhbHNlLCJzdGF0ZU11dGFiaWxpdHkiOiJ2aWV3IiwidHlwZSI6ImZ1bmN0aW9uIn0seyJjb25zdGFudCI6ZmFsc2UsImlucHV0cyI6W10sIm5hbWUiOiJkZXBvc2l0Iiwib3V0cHV0cyI6W3sibmFtZSI6IiIsInR5cGUiOiJib29sIn1dLCJwYXlhYmxlIjp0cnVlLCJzdGF0ZU11dGFiaWxpdHkiOiJwYXlhYmxlIiwidHlwZSI6ImZ1bmN0aW9uIn0seyJjb25zdGFudCI6dHJ1ZSwiaW5wdXRzIjpbeyJuYW1lIjoidG9rZW4iLCJ0eXBlIjoiYWRkcmVzcyJ9XSwibmFtZSI6IndpbGxzZWxsRmluZFNwb3QiLCJvdXRwdXRzIjpbeyJuYW1lIjoiYXNrX29yZGVyX3Nwb3QiLCJ0eXBlIjoidWludDI1NiJ9XSwicGF5YWJsZSI6ZmFsc2UsInN0YXRlTXV0YWJpbGl0eSI6InZpZXciLCJ0eXBlIjoiZnVuY3Rpb24ifSx7ImNvbnN0YW50Ijp0cnVlLCJpbnB1dHMiOlt7Im5hbWUiOiJ0b2tlbiIsInR5cGUiOiJhZGRyZXNzIn1dLCJuYW1lIjoid2lsbGJ1eUZpbmRTcG90Iiwib3V0cHV0cyI6W3sibmFtZSI6ImJpZF9vcmRlcl9zcG90IiwidHlwZSI6InVpbnQyNTYifV0sInBheWFibGUiOmZhbHNlLCJzdGF0ZU11dGFiaWxpdHkiOiJ2aWV3IiwidHlwZSI6ImZ1bmN0aW9uIn0seyJjb25zdGFudCI6ZmFsc2UsImlucHV0cyI6W3sibmFtZSI6ImFtb3VudCIsInR5cGUiOiJ1aW50MjU2In0seyJuYW1lIjoidG9rZW4iLCJ0eXBlIjoiYWRkcmVzcyJ9LHsibmFtZSI6Im1heF9wcmljZV9lYWNoIiwidHlwZSI6InVpbnQyNTYifSx7Im5hbWUiOiJhc2tfb3JkZXIiLCJ0eXBlIjoidWludDI1NiJ9LHsibmFtZSI6ImZyb250ZW5kX3JlZnVuZCIsInR5cGUiOiJhZGRyZXNzIn1dLCJuYW1lIjoiYnV5Iiwib3V0cHV0cyI6W3sibmFtZSI6IiIsInR5cGUiOiJib29sIn1dLCJwYXlhYmxlIjp0cnVlLCJzdGF0ZU11dGFiaWxpdHkiOiJwYXlhYmxlIiwidHlwZSI6ImZ1bmN0aW9uIn0seyJpbnB1dHMiOltdLCJwYXlhYmxlIjpmYWxzZSwic3RhdGVNdXRhYmlsaXR5Ijoibm9ucGF5YWJsZSIsInR5cGUiOiJjb25zdHJ1Y3RvciJ9LHsicGF5YWJsZSI6dHJ1ZSwic3RhdGVNdXRhYmlsaXR5IjoicGF5YWJsZSIsInR5cGUiOiJmYWxsYmFjayJ9LHsiYW5vbnltb3VzIjpmYWxzZSwiaW5wdXRzIjpbeyJpbmRleGVkIjpmYWxzZSwibmFtZSI6ImFtb3VudCIsInR5cGUiOiJ1aW50MjU2In0seyJpbmRleGVkIjpmYWxzZSwibmFtZSI6InRva2VuIiwidHlwZSI6ImFkZHJlc3MifSx7ImluZGV4ZWQiOmZhbHNlLCJuYW1lIjoicHJpY2VfZWFjaCIsInR5cGUiOiJ1aW50MjU2In0seyJpbmRleGVkIjpmYWxzZSwibmFtZSI6ImJ1eWVyIiwidHlwZSI6ImFkZHJlc3MifSx7ImluZGV4ZWQiOmZhbHNlLCJuYW1lIjoic2VsbGVyIiwidHlwZSI6ImFkZHJlc3MifV0sIm5hbWUiOiJUcmFkZSIsInR5cGUiOiJldmVudCJ9XQoKKi8KcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7CmNvbnRyYWN0IEJ1cnNhIHsKCiAgYWRkcmVzcyBwcml2YXRlIGNlbzsKICBhZGRyZXNzIHByaXZhdGUgYWRtaW47CiAgYWRkcmVzcyBwdWJsaWMgdXBkYXRlQXZhaWxhYmxlOwogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSkgcHJpdmF0ZSB3aWxsc2VsbFVzZXI7CiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nICh1aW50MjU2ID0+IHVpbnQyNTYpKSBwcml2YXRlIHdpbGxzZWxsUHJpY2U7CiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nICh1aW50MjU2ID0+IHVpbnQyNTYpKSBwcml2YXRlIHdpbGxzZWxsQW1vdW50OwogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSkgcHJpdmF0ZSB3aWxsYnV5VXNlcjsKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKHVpbnQyNTYgPT4gdWludDI1NikpIHByaXZhdGUgd2lsbGJ1eVByaWNlOwogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAodWludDI1NiA9PiB1aW50MjU2KSkgcHJpdmF0ZSB3aWxsYnV5QW1vdW50OwogIGV2ZW50IFRyYWRlKHVpbnQyNTYgYW1vdW50LCBhZGRyZXNzIHRva2VuLCB1aW50MjU2IHByaWNlX2VhY2gsIGFkZHJlc3MgYnV5ZXIsIGFkZHJlc3Mgc2VsbGVyKTsKCgogIGZ1bmN0aW9uIEJ1cnNhKCkgcHVibGljIHsKICAgIGFkbWluID0gbXNnLnNlbmRlcjsKICAgIGNlbyA9IG1zZy5zZW5kZXI7CiAgfQogIGZ1bmN0aW9uKCkgcHVibGljIHBheWFibGUgewogICAgaWYgKHVwZGF0ZUF2YWlsYWJsZSAhPSAwKSByZXZlcnQoKTsKICAgIGZ1bmRzW21zZy5zZW5kZXJdICs9IG1zZy52YWx1ZTsKICB9CiAgZnVuY3Rpb24gZGVwb3NpdCgpIHB1YmxpYyBwYXlhYmxlIHJldHVybnMgKGJvb2wpIHsKICAgIGlmICh1cGRhdGVBdmFpbGFibGUgIT0gMCkgcmV2ZXJ0KCk7CiAgICBmdW5kc1ttc2cuc2VuZGVyXSArPSBtc2cudmFsdWU7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgoKICBmdW5jdGlvbiBidXkodWludDI1NiBhbW91bnQsIGFkZHJlc3MgdG9rZW4sIHVpbnQyNTYgbWF4X3ByaWNlX2VhY2gsIHVpbnQyNTYgYXNrX29yZGVyLCBhZGRyZXNzIGZyb250ZW5kX3JlZnVuZCkgcHVibGljIHBheWFibGUgcmV0dXJucyAoYm9vbCkgewogICAgaWYgKG1zZy52YWx1ZSAhPSAwKSBmdW5kc1ttc2cuc2VuZGVyXSArPSBtc2cudmFsdWU7CiAgICBpZiAoKHdpbGxzZWxsUHJpY2VbdG9rZW5dW2Fza19vcmRlcl0gPiBtYXhfcHJpY2VfZWFjaCAmJiBtYXhfcHJpY2VfZWFjaCAhPSAwKQogICAgICB8fCBhbW91bnQgPT0gMAogICAgICB8fCB0b2tlbiA9PSAwCiAgICAgIHx8IHRva2VuID09IGFkZHJlc3ModGhpcykKICAgICAgfHwgYXNrX29yZGVyID09IDAKICAgICAgfHwgZnVuZHNbbXNnLnNlbmRlcl0gPD0gMWUxNQogICAgKSByZXZlcnQoKTsKICAgIGFkZHJlc3MgYnV5ZXIgPSBtc2cuc2VuZGVyOwogICAgYWRkcmVzcyBzZWxsZXIgPSB3aWxsc2VsbFVzZXJbdG9rZW5dW2Fza19vcmRlcl07CiAgICAvLyBDYW5jZWwgeW91ciBvd24gb3JkZXIKICAgIGlmIChidXllciA9PSBzZWxsZXIpIHsKICAgICAgaWYgKGFtb3VudCA+PSB3aWxsc2VsbEFtb3VudFt0b2tlbl1bYXNrX29yZGVyXSkgewogICAgICAgIHdpbGxzZWxsQW1vdW50W3Rva2VuXVthc2tfb3JkZXJdID0gMDsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgICB3aWxsc2VsbEFtb3VudFt0b2tlbl1bYXNrX29yZGVyXSAtPSBhbW91bnQ7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLy8gVmFsaWRhdGUgYW1vdW50CiAgICB1aW50MjU2IHZvbHVtZSA9IHdpbGxzZWxsVm9sdW1lKHRva2VuLCBhc2tfb3JkZXIpOwogICAgaWYgKGFtb3VudCA+IHZvbHVtZSkgewogICAgICBpZiAodm9sdW1lID09IDApIHsKICAgICAgICB3aWxsc2VsbEFtb3VudFt0b2tlbl1bYXNrX29yZGVyXSA9IDA7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIGFtb3VudCA9IHZvbHVtZTsKICAgIH0KICAgIHVpbnQyNTYgcGF5ID0gd2lsbHNlbGxQcmljZVt0b2tlbl1bYXNrX29yZGVyXSAqIGFtb3VudCAvIDFlMTg7CiAgICAvLyBCdXllciBwYXlzIHRoZSBmZWUKICAgIHVpbnQyNTYgZmVlOwogICAgaWYgKHBheSA+IDFlMTYgJiYgdHJhZGVkW21zZy5zZW5kZXJdKSB7CiAgICAgIGlmIChmcm9udGVuZF9yZWZ1bmQgPT0gMCB8fCBmcm9udGVuZF9yZWZ1bmQgPT0gbXNnLnNlbmRlcikgewogICAgICAgIGZlZSA9IDdlMTQ7CiAgICAgIH0KICAgICAgZWxzZSBmZWUgPSAxZTE1OwogICAgfSAvLyBlbHNlIGZlZSA9IDAKICAgIC8vIFZhbGlkYXRlIHBheW91dAogICAgaWYgKHBheSArIGZlZSA+IGZ1bmRzW21zZy5zZW5kZXJdKSB7CiAgICAgIHBheSA9IGZ1bmRzW21zZy5zZW5kZXJdIC0gZmVlOwogICAgICBhbW91bnQgPSBwYXkgKiAxZTE4IC8gd2lsbHNlbGxQcmljZVt0b2tlbl1bYXNrX29yZGVyXTsKICAgIH0KICAgIC8vIFRyYWRlCiAgICBpZiAoIUJ1cnNhKHRva2VuKS50cmFuc2ZlckZyb20oc2VsbGVyLCBidXllciwgYW1vdW50KSkgcmV0dXJuIGZhbHNlOwogICAgZnVuZHNbc2VsbGVyXSA9IGZ1bmRzW3NlbGxlcl0gKyBwYXk7CiAgICBmdW5kc1tidXllcl0gPSBmdW5kc1tidXllcl0gLSBwYXkgLSBmZWU7CiAgICBpZiAoZmVlID09IDFlMTUpIGZ1bmRzW2Zyb250ZW5kX3JlZnVuZF0gPSBmdW5kc1tmcm9udGVuZF9yZWZ1bmRdICsgM2UxNDsKICAgIGlmICh0cmFkZWRbbXNnLnNlbmRlcl0gPT0gZmFsc2UpIHsKICAgICAgZnVuZHNbY2VvXSA9IGZ1bmRzW2Nlb10gKyBwYXkgLyAyMDsKICAgICAgdHJhZGVkW21zZy5zZW5kZXJdID0gdHJ1ZTsKICAgIH0KICAgIC8vIERyb3AgdW5jb3ZlcmVkIG9yZGVyCiAgICBpZiAoYW1vdW50ID09IHZvbHVtZSkgewogICAgICB3aWxsc2VsbEFtb3VudFt0b2tlbl1bYXNrX29yZGVyXSA9IDA7CiAgICB9CiAgICBlbHNlIHdpbGxzZWxsQW1vdW50W3Rva2VuXVthc2tfb3JkZXJdIC09IGFtb3VudDsKICAgIFRyYWRlKGFtb3VudCwgdG9rZW4sIHdpbGxzZWxsUHJpY2VbdG9rZW5dW2Fza19vcmRlcl0sIGJ1eWVyLCBzZWxsZXIpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKCiAgZnVuY3Rpb24gc2VsbCh1aW50MjU2IGFtb3VudCwgYWRkcmVzcyB0b2tlbiwgdWludDI1NiBtaW5fcHJpY2VfZWFjaCwgdWludDI1NiBiaWRfb3JkZXIsIGFkZHJlc3MgZnJvbnRlbmRfcmVmdW5kKSBwdWJsaWMgcGF5YWJsZSByZXR1cm5zIChib29sKSB7CiAgICBpZiAobXNnLnZhbHVlICE9IDApIGZ1bmRzW21zZy5zZW5kZXJdICs9IG1zZy52YWx1ZTsKICAgIGlmICh3aWxsYnV5UHJpY2VbdG9rZW5dW2JpZF9vcmRlcl0gPCBtaW5fcHJpY2VfZWFjaAogICAgICB8fCBhbW91bnQgPT0gMAogICAgICB8fCB0b2tlbiA9PSAwCiAgICAgIHx8IHRva2VuID09IGFkZHJlc3ModGhpcykKICAgICAgfHwgYmlkX29yZGVyID09IDAKICAgICkgcmV2ZXJ0KCk7CiAgICBhZGRyZXNzIGJ1eWVyID0gd2lsbGJ1eVVzZXJbdG9rZW5dW2JpZF9vcmRlcl07CiAgICBhZGRyZXNzIHNlbGxlciA9IG1zZy5zZW5kZXI7CiAgICAvLyBDYW5jZWwgeW91ciBvd24gb3JkZXIKICAgIGlmIChidXllciA9PSBzZWxsZXIpIHsKICAgICAgaWYgKGFtb3VudCA+PSB3aWxsYnV5QW1vdW50W3Rva2VuXVtiaWRfb3JkZXJdKSB7CiAgICAgICAgd2lsbGJ1eUFtb3VudFt0b2tlbl1bYmlkX29yZGVyXSA9IDA7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgICAgd2lsbGJ1eUFtb3VudFt0b2tlbl1bYmlkX29yZGVyXSAtPSBhbW91bnQ7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLy8gVmFsaWRhdGUgYW1vdW50CiAgICB1aW50MjU2IHZvbHVtZSA9IHdpbGxidXlWb2x1bWUodG9rZW4sIGJpZF9vcmRlcik7CiAgICBpZiAoYW1vdW50ID4gdm9sdW1lKSB7CiAgICAgIGlmICh2b2x1bWUgPT0gMCkgewogICAgICAgIHdpbGxidXlBbW91bnRbdG9rZW5dW2JpZF9vcmRlcl0gPSAwOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICBhbW91bnQgPSB2b2x1bWU7CiAgICB9CiAgICB1aW50MjU2IHBheSA9IHdpbGxidXlQcmljZVt0b2tlbl1bYmlkX29yZGVyXSAqIGFtb3VudCAvIDFlMTg7CiAgICAvLyBTZWxsZXIgcGF5cyB0aGUgZmVlCiAgICB1aW50MjU2IGZlZTsKICAgIGlmIChwYXkgPiAxZTE2ICYmIHRyYWRlZFttc2cuc2VuZGVyXSkgewogICAgICBpZiAoZnJvbnRlbmRfcmVmdW5kID09IDAgfHwgZnJvbnRlbmRfcmVmdW5kID09IG1zZy5zZW5kZXIpIHsKICAgICAgICBmZWUgPSA3ZTE0OwogICAgICB9CiAgICAgIGVsc2UgZmVlID0gMWUxNTsKICAgIH0gLy8gZWxzZSBmZWUgPSAwCiAgICAvLyBUcmFkZQogICAgaWYgKCFCdXJzYSh0b2tlbikudHJhbnNmZXJGcm9tKHNlbGxlciwgYnV5ZXIsIGFtb3VudCkpIHJldHVybiBmYWxzZTsKICAgIGZ1bmRzW2J1eWVyXSA9IGZ1bmRzW2J1eWVyXSAtIHBheTsKICAgIGZ1bmRzW3NlbGxlcl0gPSBmdW5kc1tzZWxsZXJdICsgcGF5IC0gZmVlOwogICAgaWYgKGZlZSA9PSAxZTE1KSBmdW5kc1tmcm9udGVuZF9yZWZ1bmRdID0gZnVuZHNbZnJvbnRlbmRfcmVmdW5kXSArIDNlMTQ7CiAgICBpZiAodHJhZGVkW21zZy5zZW5kZXJdID09IGZhbHNlKSB7CiAgICAgIGZ1bmRzW2Nlb10gPSBmdW5kc1tjZW9dICsgcGF5IC8gMjA7CiAgICAgIHRyYWRlZFttc2cuc2VuZGVyXSA9IHRydWU7CiAgICB9CiAgICAvLyBEcm9wIHVuY292ZXJlZCBvcmRlcgogICAgaWYgKGFtb3VudCA9PSB2b2x1bWUpIHsKICAgICAgd2lsbGJ1eUFtb3VudFt0b2tlbl1bYmlkX29yZGVyXSA9IDA7CiAgICB9CiAgICBlbHNlIHdpbGxidXlBbW91bnRbdG9rZW5dW2JpZF9vcmRlcl0gLT0gYW1vdW50OwogICAgVHJhZGUoYW1vdW50LCB0b2tlbiwgd2lsbGJ1eVByaWNlW3Rva2VuXVtiaWRfb3JkZXJdLCBidXllciwgc2VsbGVyKTsKICAgIHJldHVybiB0cnVlOwogIH0KCgogIGZ1bmN0aW9uIHdpbGxidXkodWludDI1NiBhbW91bnQsIGFkZHJlc3MgdG9rZW4sIHVpbnQyNTYgcHJpY2VfZWFjaCwgdWludDI1NiBiaWRfb3JkZXJfc3BvdCkgcHVibGljIHBheWFibGUgcmV0dXJucyAoYm9vbCkgewogICAgaWYgKG1zZy52YWx1ZSAhPSAwKSBmdW5kc1ttc2cuc2VuZGVyXSArPSBtc2cudmFsdWU7CiAgICBpZiAodXBkYXRlQXZhaWxhYmxlICE9IDAKICAgICAgfHwgYW1vdW50ID09IDAKICAgICAgfHwgdG9rZW4gPT0gMAogICAgICB8fCB0b2tlbiA9PSBhZGRyZXNzKHRoaXMpCiAgICAgIHx8IHByaWNlX2VhY2ggPT0gMAogICAgICB8fCBiaWRfb3JkZXJfc3BvdCA9PSAwCiAgICApIHJldmVydCgpOwogICAgd2hpbGUgKHdpbGxidXlBbW91bnRbdG9rZW5dW2JpZF9vcmRlcl9zcG90XSAhPSAwICYmIGZ1bmRzW3dpbGxidXlVc2VyW3Rva2VuXVtiaWRfb3JkZXJfc3BvdF1dICE9IDApICsrYmlkX29yZGVyX3Nwb3Q7CiAgICB3aWxsYnV5VXNlclt0b2tlbl1bYmlkX29yZGVyX3Nwb3RdID0gbXNnLnNlbmRlcjsKICAgIHdpbGxidXlQcmljZVt0b2tlbl1bYmlkX29yZGVyX3Nwb3RdID0gcHJpY2VfZWFjaDsKICAgIHdpbGxidXlBbW91bnRbdG9rZW5dW2JpZF9vcmRlcl9zcG90XSA9IGFtb3VudDsKICAgIHJldHVybiB0cnVlOwogIH0KICBmdW5jdGlvbiB3aWxsc2VsbCh1aW50MjU2IGFtb3VudCwgYWRkcmVzcyB0b2tlbiwgdWludDI1NiBwcmljZV9lYWNoLCB1aW50MjU2IGFza19vcmRlcl9zcG90KSBwdWJsaWMgcGF5YWJsZSByZXR1cm5zIChib29sKSB7CiAgICBpZiAobXNnLnZhbHVlICE9IDApIGZ1bmRzW21zZy5zZW5kZXJdICs9IG1zZy52YWx1ZTsKICAgIGlmICh1cGRhdGVBdmFpbGFibGUgIT0gMAogICAgICB8fCBhbW91bnQgPT0gMAogICAgICB8fCB0b2tlbiA9PSAwCiAgICAgIHx8IHRva2VuID09IGFkZHJlc3ModGhpcykKICAgICAgfHwgcHJpY2VfZWFjaCA9PSAwCiAgICAgIHx8IGFza19vcmRlcl9zcG90ID09IDAKICAgICkgcmV2ZXJ0KCk7CiAgICB3aGlsZSAod2lsbHNlbGxBbW91bnRbdG9rZW5dW2Fza19vcmRlcl9zcG90XSAhPSAwKSB7CiAgICAgIGFkZHJlc3MgdXNlciA9IHdpbGxzZWxsVXNlclt0b2tlbl1bYXNrX29yZGVyX3Nwb3RdOwogICAgICB1aW50MjU2IGJhbGFuY2VTZWxsZXIgPSBCdXJzYSh0b2tlbikuYmFsYW5jZU9mKHVzZXIpOwogICAgICBpZiAoYmFsYW5jZVNlbGxlciA9PSAwKSBicmVhazsKICAgICAgdWludDI1NiBhbGxvd2FuY2VTZWxsZXIgPSBCdXJzYSh0b2tlbikuYWxsb3dhbmNlKHVzZXIsIGFkZHJlc3ModGhpcykpOwogICAgICBpZiAoYWxsb3dhbmNlU2VsbGVyID09IDApIGJyZWFrOwogICAgICArK2Fza19vcmRlcl9zcG90OwogICAgfQogICAgd2lsbHNlbGxVc2VyW3Rva2VuXVthc2tfb3JkZXJfc3BvdF0gPSBtc2cuc2VuZGVyOwogICAgd2lsbHNlbGxQcmljZVt0b2tlbl1bYXNrX29yZGVyX3Nwb3RdID0gcHJpY2VfZWFjaDsKICAgIHdpbGxzZWxsQW1vdW50W3Rva2VuXVthc2tfb3JkZXJfc3BvdF0gPSBhbW91bnQ7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgZnVuY3Rpb24gd2l0aGRyYXcodWludDI1NiBhbW91bnQpIHB1YmxpYyB7CiAgICBpZiAoZnVuZHNbbXNnLnNlbmRlcl0gPCBhbW91bnQgfHwgYW1vdW50ID09IDApIGFtb3VudCA9IGZ1bmRzW21zZy5zZW5kZXJdOwogICAgZnVuZHNbbXNnLnNlbmRlcl0gLT0gYW1vdW50OwogICAgbXNnLnNlbmRlci50cmFuc2ZlcihhbW91bnQpOwogIH0KCgovLyBDb25zdGFudCBtZXRob2RzIGJlbG93CgogIGZ1bmN0aW9uIG5hbWUoKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAoc3RyaW5nKSB7CiAgICBpZiAodXBkYXRlQXZhaWxhYmxlICE9IDApIHJldHVybiAiQlVSU0EgREVYIChkZWFjdGl2YXRlZCkiOwogICAgcmV0dXJuICJCVVJTQSBERVgiOwogIH0KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB1c2VyKQogIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBmdW5kc1t1c2VyXTsKICB9CiAgZnVuY3Rpb24gYmFsYW5jZUFwcHJvdmVkRm9yVG9rZW4oYWRkcmVzcyB0b2tlbiwgYWRkcmVzcyB1c2VyKQogIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2IGFtb3VudCkgewogICAgaWYgKHRva2VuID09IDAgfHwgdG9rZW4gPT0gYWRkcmVzcyh0aGlzKSkgcmV0dXJuIGZ1bmRzW3VzZXJdOwogICAgYW1vdW50ID0gQnVyc2EodG9rZW4pLmJhbGFuY2VPZih1c2VyKTsKICAgIHVpbnQyNTYgYWxsb3dhbmNlID0gQnVyc2EodG9rZW4pLmFsbG93YW5jZSh1c2VyLCBhZGRyZXNzKHRoaXMpKTsKICAgIGlmIChhbW91bnQgPiBhbGxvd2FuY2UpIGFtb3VudCA9IGFsbG93YW5jZTsKICAgIHJldHVybiBhbW91bnQ7CiAgfQoKCiAgZnVuY3Rpb24gZmluZEJlc3RBc2soYWRkcmVzcyB0b2tlbiwgdWludDI1NiBtaW5fdHJhZGVfYW1vdW50KSBwdWJsaWMKICBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGFza19vcmRlciwgdWludDI1NiB2b2x1bWUsIHVpbnQyNTYgcHJpY2UpIHsKICAgIHByaWNlID0gKHVpbnQyNTYpKC0xKTsKICAgIHVpbnQyNTYgaT0xOwogICAgd2hpbGUgKHdpbGxzZWxsVXNlclt0b2tlbl1baV0gIT0gMCkgewogICAgICBpZiAod2lsbHNlbGxQcmljZVt0b2tlbl1baV0gPCBwcmljZSAmJiB3aWxsc2VsbEFtb3VudFt0b2tlbl1baV0gIT0gMCkgewogICAgICAgIHZvbHVtZSA9IHdpbGxzZWxsVm9sdW1lKHRva2VuLCBpKTsKICAgICAgICBpZiAodm9sdW1lID49IG1pbl90cmFkZV9hbW91bnQgJiYgdm9sdW1lID49IDFlMTUgKiAxZTE4IC8gKHdpbGxzZWxsUHJpY2VbdG9rZW5dW2ldICsgMSkpIHsKICAgICAgICAgIHByaWNlID0gd2lsbHNlbGxQcmljZVt0b2tlbl1baV07CiAgICAgICAgICBhc2tfb3JkZXIgPSBpOwogICAgICAgIH0KICAgICAgfQogICAgICArK2k7CiAgICB9CiAgICBpZiAoYXNrX29yZGVyID09IDApIHJldHVybiAoMCwwLDApOwogICAgcmV0dXJuOwogIH0KICBmdW5jdGlvbiBmaW5kQmVzdEJpZChhZGRyZXNzIHRva2VuLCB1aW50MjU2IG1pbl90cmFkZV9hbW91bnQpIHB1YmxpYwogIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmlkX29yZGVyLCB1aW50MjU2IHZvbHVtZSwgdWludDI1NiBwcmljZSkgewogICAgdWludDI1NiBpPTE7CiAgICB3aGlsZSAod2lsbGJ1eVVzZXJbdG9rZW5dW2ldICE9IDApIHsKICAgICAgaWYgKHdpbGxidXlQcmljZVt0b2tlbl1baV0gPiBwcmljZSAmJiB3aWxsYnV5QW1vdW50W3Rva2VuXVtpXSAhPSAwKSB7CiAgICAgICAgdm9sdW1lID0gd2lsbGJ1eVZvbHVtZSh0b2tlbiwgaSk7CiAgICAgICAgaWYgKHZvbHVtZSA+PSBtaW5fdHJhZGVfYW1vdW50ICYmIHZvbHVtZSA+PSAxZTE1ICogMWUxOCAvICh3aWxsYnV5UHJpY2VbdG9rZW5dW2ldICsgMSkpIHsKICAgICAgICAgIHByaWNlID0gd2lsbGJ1eVByaWNlW3Rva2VuXVtpXTsKICAgICAgICAgIGJpZF9vcmRlciA9IGk7CiAgICAgICAgfQogICAgICB9CiAgICAgICsraTsKICAgIH0KICAgIGlmIChiaWRfb3JkZXIgPT0gMCkgcmV0dXJuICgwLDAsMCk7CiAgICByZXR1cm47CiAgfQoKICBmdW5jdGlvbiB3aWxsYnV5RmluZFNwb3QoYWRkcmVzcyB0b2tlbikgcHVibGljCiAgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiaWRfb3JkZXJfc3BvdCkgewogICAgLy8gaXMgRVJDMjA/CiAgICBCdXJzYSh0b2tlbikuc3ltYm9sKCk7CiAgICB1aW50MjU2IGk9MTsKICAgIHdoaWxlICh3aWxsYnV5QW1vdW50W3Rva2VuXVtpXSA+PSAxZTE1ICogMWUxOCAvICh3aWxsYnV5UHJpY2VbdG9rZW5dW2ldICsgMSkgJiYgZnVuZHNbd2lsbGJ1eVVzZXJbdG9rZW5dW2ldXSAhPSAwKSArK2k7CiAgICByZXR1cm4gaTsKICB9CiAgZnVuY3Rpb24gd2lsbHNlbGxGaW5kU3BvdChhZGRyZXNzIHRva2VuKSBwdWJsaWMKICBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGFza19vcmRlcl9zcG90KSB7CiAgICAvLyBpcyBFUkMyMD8KICAgIEJ1cnNhKHRva2VuKS5zeW1ib2woKTsKICAgIHVpbnQyNTYgaT0xOwogICAgd2hpbGUgKHdpbGxzZWxsQW1vdW50W3Rva2VuXVtpXSA+PSAxZTE1ICogMWUxOCAvICh3aWxsc2VsbFByaWNlW3Rva2VuXVtpXSArIDEpKSB7CiAgICAgIHVpbnQyNTYgYmFsYW5jZVNlbGxlciA9IEJ1cnNhKHRva2VuKS5iYWxhbmNlT2Yod2lsbHNlbGxVc2VyW3Rva2VuXVtpXSk7CiAgICAgIGlmIChiYWxhbmNlU2VsbGVyID09IDApIHJldHVybiBpOwogICAgICB1aW50MjU2IGFsbG93YW5jZVNlbGxlciA9IEJ1cnNhKHRva2VuKS5hbGxvd2FuY2Uod2lsbHNlbGxVc2VyW3Rva2VuXVtpXSwgYWRkcmVzcyh0aGlzKSk7CiAgICAgIGlmIChhbGxvd2FuY2VTZWxsZXIgPT0gMCkgcmV0dXJuIGk7CiAgICAgICsraTsKICAgIH0KICAgIHJldHVybiBpOwogIH0KCgovLyBHZXQgaW5mbyBvbiBvcmRlcnMKCiAgZnVuY3Rpb24gd2lsbGJ1eUluZm8oYWRkcmVzcyB0b2tlbiwgdWludDI1NiBiaWRfb3JkZXIpIHB1YmxpYwogIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MgdXNlciwgdWludDI1NiBwcmljZSwgdWludDI1NiBhbW91bnQpIHsKICAgIHVzZXIgPSB3aWxsYnV5VXNlclt0b2tlbl1bYmlkX29yZGVyXTsKICAgIHByaWNlID0gd2lsbGJ1eVByaWNlW3Rva2VuXVtiaWRfb3JkZXJdOwogICAgYW1vdW50ID0gd2lsbGJ1eUFtb3VudFt0b2tlbl1bYmlkX29yZGVyXTsKICAgIHVpbnQyNTYgcGF5ID0gcHJpY2UgKiBhbW91bnQgLyAxZTE4OwogICAgaWYgKHBheSA+IGZ1bmRzW3VzZXJdKSB7CiAgICAgIHBheSA9IGZ1bmRzW3VzZXJdOwogICAgICBhbW91bnQgPSBwYXkgKiAxZTE4IC8gcHJpY2U7CiAgICB9CiAgICByZXR1cm47CiAgfQogIGZ1bmN0aW9uIHdpbGxidXlWb2x1bWUoYWRkcmVzcyB0b2tlbiwgdWludDI1NiBiaWRfb3JkZXIpIHByaXZhdGUKICBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGFtb3VudCA9IHdpbGxidXlBbW91bnRbdG9rZW5dW2JpZF9vcmRlcl07CiAgICBhZGRyZXNzIHVzZXIgPSB3aWxsYnV5VXNlclt0b2tlbl1bYmlkX29yZGVyXTsKICAgIGlmIChhbW91bnQgPT0gMCB8fCBmdW5kc1t1c2VyXSA9PSAwKSByZXR1cm4gMDsKICAgIHVpbnQyNTYgcHJpY2UgPSB3aWxsYnV5UHJpY2VbdG9rZW5dW2JpZF9vcmRlcl07CiAgICB1aW50MjU2IHBheSA9IHByaWNlICogYW1vdW50IC8gMWUxODsKICAgIGlmIChwYXkgPiBmdW5kc1t1c2VyXSkgewogICAgICBwYXkgPSBmdW5kc1t1c2VyXTsKICAgICAgYW1vdW50ID0gcGF5ICogMWUxOCAvIHByaWNlOwogICAgfQogICAgcmV0dXJuIGFtb3VudDsKICB9CgogIGZ1bmN0aW9uIHdpbGxzZWxsSW5mbyhhZGRyZXNzIHRva2VuLCB1aW50MjU2IGFza19vcmRlcikgcHVibGljCiAgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcyB1c2VyLCB1aW50MjU2IHByaWNlLCB1aW50MjU2IGFtb3VudCkgewogICAgdXNlciA9IHdpbGxzZWxsVXNlclt0b2tlbl1bYXNrX29yZGVyXTsKICAgIHByaWNlID0gd2lsbHNlbGxQcmljZVt0b2tlbl1bYXNrX29yZGVyXTsKICAgIGFtb3VudCA9IHdpbGxzZWxsQW1vdW50W3Rva2VuXVthc2tfb3JkZXJdOwogICAgdWludDI1NiBiYWxhbmNlU2VsbGVyID0gQnVyc2EodG9rZW4pLmJhbGFuY2VPZih1c2VyKTsKICAgIHVpbnQyNTYgYWxsb3dhbmNlU2VsbGVyID0gQnVyc2EodG9rZW4pLmFsbG93YW5jZSh1c2VyLCBhZGRyZXNzKHRoaXMpKTsKICAgIGlmIChiYWxhbmNlU2VsbGVyID4gYWxsb3dhbmNlU2VsbGVyKSBiYWxhbmNlU2VsbGVyID0gYWxsb3dhbmNlU2VsbGVyOwogICAgaWYgKGFtb3VudCA+IGJhbGFuY2VTZWxsZXIpIGFtb3VudCA9IGJhbGFuY2VTZWxsZXI7CiAgICByZXR1cm47CiAgfQogIGZ1bmN0aW9uIHdpbGxzZWxsVm9sdW1lKGFkZHJlc3MgdG9rZW4sIHVpbnQyNTYgYXNrX29yZGVyKSBwcml2YXRlCiAgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBhbW91bnQgPSB3aWxsc2VsbEFtb3VudFt0b2tlbl1bYXNrX29yZGVyXTsKICAgIGlmIChhbW91bnQgPT0gMCkgcmV0dXJuIDA7CiAgICBhZGRyZXNzIHVzZXIgPSB3aWxsc2VsbFVzZXJbdG9rZW5dW2Fza19vcmRlcl07CiAgICB1aW50MjU2IGJhbGFuY2VTZWxsZXIgPSBCdXJzYSh0b2tlbikuYmFsYW5jZU9mKHVzZXIpOwogICAgaWYgKGJhbGFuY2VTZWxsZXIgPT0gMCkgcmV0dXJuIDA7CiAgICB1aW50MjU2IGFsbG93YW5jZVNlbGxlciA9IEJ1cnNhKHRva2VuKS5hbGxvd2FuY2UodXNlciwgYWRkcmVzcyh0aGlzKSk7CiAgICBpZiAoYWxsb3dhbmNlU2VsbGVyID09IDApIHJldHVybiAwOwogICAgaWYgKGJhbGFuY2VTZWxsZXIgPiBhbGxvd2FuY2VTZWxsZXIpIGJhbGFuY2VTZWxsZXIgPSBhbGxvd2FuY2VTZWxsZXI7CiAgICBpZiAoYW1vdW50ID4gYmFsYW5jZVNlbGxlcikgYW1vdW50ID0gYmFsYW5jZVNlbGxlcjsKICAgIHJldHVybiBhbW91bnQ7CiAgfQoKCi8vIEJVUlNBIGV0aGVyIHBlZ2dlZCB0b2tlbgovLyBVc2VkIHRvIGNvbnZlbmllbnRseSBzaG93IHVzZXIgZGVwb3NpdCBpbiB3YWxsZXRzCgogIGZ1bmN0aW9uIHN5bWJvbCgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zIChzdHJpbmcpIHsKICAgIGlmICh1cGRhdGVBdmFpbGFibGUgIT0gMCkgcmV0dXJuICJleEJVUlNBIjsKICAgIHJldHVybiAiQlVSU0EiOwogIH0KICBmdW5jdGlvbiBkZWNpbWFscygpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gMTg7CiAgfQogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQyNTYgc3VwcGx5KSB7CiAgICByZXR1cm4gdGhpcy5iYWxhbmNlOwogIH0KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIGlmIChfdmFsdWUgPiBmdW5kc1ttc2cuc2VuZGVyXSkgX3ZhbHVlID0gZnVuZHNbbXNnLnNlbmRlcl07CiAgICBmdW5kc1ttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICBmdW5kc1tfdG9dICs9IF92YWx1ZTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICBpZiAoX3ZhbHVlID4gZnVuZHNbbXNnLnNlbmRlcl0pIF92YWx1ZSA9IGZ1bmRzW21zZy5zZW5kZXJdOwogICAgaWYgKF92YWx1ZSA+IGFwcHJvdmVkW19mcm9tXVttc2cuc2VuZGVyXSkgX3ZhbHVlID0gYXBwcm92ZWRbX2Zyb21dW21zZy5zZW5kZXJdOwogICAgZnVuZHNbX2Zyb21dIC09IF92YWx1ZTsKICAgIGZ1bmRzW190b10gKz0gX3ZhbHVlOwogICAgYXBwcm92ZWRbX2Zyb21dW21zZy5zZW5kZXJdIC09IF92YWx1ZTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgaWYgKF9zcGVuZGVyID09IGFkZHJlc3ModGhpcykpIHJldHVybiB0cnVlOwogICAgYXBwcm92ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgIGlmIChfc3BlbmRlciA9PSBhZGRyZXNzKHRoaXMpKSByZXR1cm4gYmFsYW5jZU9mKF9vd25lcik7CiAgICByZXR1cm4gYXBwcm92ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpOwogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgcHJpdmF0ZSBhcHByb3ZlZDsKICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHByaXZhdGUgZnVuZHM7CiAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwcml2YXRlIHRyYWRlZDsKCgovLyAgQWRtaW4gbWV0aG9kcwovLyAgRE8gTk9UIEVWRVIgVFJBTlNGRVIgVE9LRU5TIFRPIEJVUlNBIE9SIFlPVSdMTCBCRSBCQU5ORUQgRlJPTSBFVEhFUkVVTQoKICBmdW5jdGlvbiByZWZ1bmRMb3N0VG9rZW4oYWRkcmVzcyB0b2tlbiwgYWRkcmVzcyB1c2VyKSBwdWJsaWMgewogICAgaWYgKG1zZy5zZW5kZXIgIT0gYWRtaW4gJiYgbXNnLnNlbmRlciAhPSBjZW8pIHJldHVybjsKICAgIHVpbnQyNTYgYW1vdW50ID0gQnVyc2EodG9rZW4pLmJhbGFuY2VPZihhZGRyZXNzKHRoaXMpKTsKICAgIEJ1cnNhKHRva2VuKS50cmFuc2Zlcih1c2VyLCBhbW91bnQpOwogIH0KICBmdW5jdGlvbiByb2xsVXBkYXRlKGFkZHJlc3MgX3VwZGF0ZUF2YWlsYWJsZSkgcHVibGljIHsKICAgIGlmIChtc2cuc2VuZGVyID09IGFkbWluIHx8IG1zZy5zZW5kZXIgPT0gY2VvKSB1cGRhdGVBdmFpbGFibGUgPSBfdXBkYXRlQXZhaWxhYmxlOwogIH0KICBmdW5jdGlvbiBhc3NpZ25DRU8oYWRkcmVzcyBfY2VvKSBwdWJsaWMgewogICAgaWYgKG1zZy5zZW5kZXIgPT0gYWRtaW4pIHsKICAgICAgY2VvID0gX2NlbzsKICAgIH0KICAgIGVsc2UgaWYgKG1zZy5zZW5kZXIgPT0gY2VvKSB7CiAgICAgIGFkbWluID0gY2VvOwogICAgICBjZW8gPSBfY2VvOwogICAgfQogIH0KCn0='.
	

]
