Class {
	#name : #SRT0f0b6cecfd03b847ad45a4d488f6c703af85af00,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT0f0b6cecfd03b847ad45a4d488f6c703af85af00 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTc7CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBBcHBsaWNhdGlvbiBFbnRpdHkgR2VuZXJpYyBDb250cmFjdAogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjE5NzQ3MDdhNzI2MDU5Nzc3NjZlNzU3MDZmN2MzNzZiNzYiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+PgoKICAgIFVzZWQgZm9yIHRoZSBBQkkgaW50ZXJmYWNlIHdoZW4gYXNzZXRzIG5lZWQgdG8gY2FsbCBBcHBsaWNhdGlvbiBFbnRpdHkuCgogICAgVGhpcyBpcyByZXF1aXJlZCwgb3RoZXJ3aXNlIHdlIGVuZCB1cCBsb2FkaW5nIHRoZSBhc3NldHMgdGhlbXNlbHZlcyB3aGVuIHdlIGxvYWQgdGhlIEFwcGxpY2F0aW9uRW50aXR5IGNvbnRyYWN0CiAgICBhbmQgZW5kIHVwIGluIGEgbG9vcAoqLwoKCgpjb250cmFjdCBBcHBsaWNhdGlvbkVudGl0eUFCSSB7CgogICAgYWRkcmVzcyBwdWJsaWMgUHJvcG9zYWxzRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgRnVuZGluZ0VudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIE1pbGVzdG9uZXNFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBNZWV0aW5nc0VudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIEJvdW50eU1hbmFnZXJFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBUb2tlbk1hbmFnZXJFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBMaXN0aW5nQ29udHJhY3RFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBGdW5kaW5nTWFuYWdlckVudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIE5ld3NDb250cmFjdEVudGl0eTsKCiAgICBib29sIHB1YmxpYyBfaW5pdGlhbGl6ZWQgPSBmYWxzZTsKICAgIGJvb2wgcHVibGljIF9sb2NrZWQgPSBmYWxzZTsKICAgIHVpbnQ4IHB1YmxpYyBDdXJyZW50RW50aXR5U3RhdGU7CiAgICB1aW50OCBwdWJsaWMgQXNzZXRDb2xsZWN0aW9uTnVtOwogICAgYWRkcmVzcyBwdWJsaWMgR2F0ZXdheUludGVyZmFjZUFkZHJlc3M7CiAgICBhZGRyZXNzIHB1YmxpYyBkZXBsb3llckFkZHJlc3M7CiAgICBhZGRyZXNzIHRlc3RBZGRyZXNzQWxsb3dVcGdyYWRlRnJvbTsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludDgpIHB1YmxpYyBFbnRpdHlTdGF0ZXM7CiAgICBtYXBwaW5nIChieXRlczMyID0+IGFkZHJlc3MpIHB1YmxpYyBBc3NldENvbGxlY3Rpb247CiAgICBtYXBwaW5nICh1aW50OCA9PiBieXRlczMyKSBwdWJsaWMgQXNzZXRDb2xsZWN0aW9uSWRUb05hbWU7CiAgICBtYXBwaW5nIChieXRlczMyID0+IHVpbnQyNTYpIHB1YmxpYyBCeWxhd3NVaW50MjU2OwogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiBieXRlczMyKSBwdWJsaWMgQnlsYXdzQnl0ZXMzMjsKCiAgICBmdW5jdGlvbiBBcHBsaWNhdGlvbkVudGl0eSgpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGdldEVudGl0eVN0YXRlKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gbGlua1RvR2F0ZXdheSggYWRkcmVzcyBfR2F0ZXdheUludGVyZmFjZUFkZHJlc3MsIGJ5dGVzMzIgX3NvdXJjZUNvZGVVcmwgKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIHNldFVwZ3JhZGVTdGF0ZSh1aW50OCBzdGF0ZSkgcHVibGljIDsKICAgIGZ1bmN0aW9uIGFkZEFzc2V0UHJvcG9zYWxzKGFkZHJlc3MgX2Fzc2V0QWRkcmVzc2VzKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIGFkZEFzc2V0RnVuZGluZyhhZGRyZXNzIF9hc3NldEFkZHJlc3NlcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBhZGRBc3NldE1pbGVzdG9uZXMoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYWRkQXNzZXRNZWV0aW5ncyhhZGRyZXNzIF9hc3NldEFkZHJlc3NlcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBhZGRBc3NldEJvdW50eU1hbmFnZXIoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYWRkQXNzZXRUb2tlbk1hbmFnZXIoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYWRkQXNzZXRGdW5kaW5nTWFuYWdlcihhZGRyZXNzIF9hc3NldEFkZHJlc3NlcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBhZGRBc3NldExpc3RpbmdDb250cmFjdChhZGRyZXNzIF9hc3NldEFkZHJlc3NlcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBhZGRBc3NldE5ld3NDb250cmFjdChhZGRyZXNzIF9hc3NldEFkZHJlc3NlcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBnZXRBc3NldEFkZHJlc3NCeU5hbWUoYnl0ZXMzMiBfbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyk7CiAgICBmdW5jdGlvbiBzZXRCeWxhd1VpbnQyNTYoYnl0ZXMzMiBuYW1lLCB1aW50MjU2IHZhbHVlKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBnZXRCeWxhd1VpbnQyNTYoYnl0ZXMzMiBuYW1lKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHNldEJ5bGF3Qnl0ZXMzMihieXRlczMyIG5hbWUsIGJ5dGVzMzIgdmFsdWUpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGdldEJ5bGF3Qnl0ZXMzMihieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJ5dGVzMzIpOwogICAgZnVuY3Rpb24gaW5pdGlhbGl6ZSgpIGV4dGVybmFsIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0UGFyZW50QWRkcmVzcygpIGV4dGVybmFsIHZpZXcgcmV0dXJucyhhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIGNyZWF0ZUNvZGVVcGdyYWRlUHJvcG9zYWwoIGFkZHJlc3MgX25ld0FkZHJlc3MsIGJ5dGVzMzIgX3NvdXJjZUNvZGVVcmwgKSBleHRlcm5hbCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGFjY2VwdENvZGVVcGdyYWRlUHJvcG9zYWwoYWRkcmVzcyBfbmV3QWRkcmVzcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBpbml0aWFsaXplQXNzZXRzVG9UaGlzQXBwbGljYXRpb24oKSBleHRlcm5hbCByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyQXNzZXRzVG9OZXdBcHBsaWNhdGlvbihhZGRyZXNzIF9uZXdBZGRyZXNzKSBleHRlcm5hbCByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGxvY2soKSBleHRlcm5hbCByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGNhbkluaXRpYXRlQ29kZVVwZ3JhZGUoYWRkcmVzcyBfc2VuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zKGJvb2wpOwogICAgZnVuY3Rpb24gZG9TdGF0ZUNoYW5nZXMoKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBoYXNSZXF1aXJlZFN0YXRlQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gYW55QXNzZXRIYXNDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBleHRlbmRlZEFueUFzc2V0SGFzQ2hhbmdlcygpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRSZXF1aXJlZFN0YXRlQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4LCB1aW50OCk7CiAgICBmdW5jdGlvbiBnZXRUaW1lc3RhbXAoKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KTsKCn0KCi8qCgogKiBzb3VyY2UgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL2Jsb2NrYml0c2lvLwoKICogQG5hbWUgICAgICAgIFRva2VuIENvbnRyYWN0CiAqIEBwYWNrYWdlICAgICBCbG9ja0JpdHNJTwogKiBAYXV0aG9yICAgICAgTWlja3kgU29jYWNpIDw8YSBocmVmPSIvY2RuLWNnaS9sL2VtYWlsLXByb3RlY3Rpb24iIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iNjgwNTAxMGIwMzExMjgwNjA3MWYwNDAxMWUwZDQ2MWEwNyI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvYT4+CgogWmVwcGVsaW4gRVJDMjAgU3RhbmRhcmQgVG9rZW4KCiovCgoKCmNvbnRyYWN0IEFCSVRva2VuIHsKCiAgICBzdHJpbmcgcHVibGljICBzeW1ib2w7CiAgICBzdHJpbmcgcHVibGljICBuYW1lOwogICAgdWludDggcHVibGljICAgZGVjaW1hbHM7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICAgIHN0cmluZyBwdWJsaWMgIHZlcnNpb247CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBiYWxhbmNlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKICAgIGFkZHJlc3MgcHVibGljIG1hbmFnZXI7CiAgICBhZGRyZXNzIHB1YmxpYyBkZXBsb3llcjsKICAgIGJvb2wgcHVibGljIG1pbnRpbmdGaW5pc2hlZCA9IGZhbHNlOwogICAgYm9vbCBwdWJsaWMgaW5pdGlhbGl6ZWQgPSBmYWxzZTsKCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOwogICAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZmluaXNoTWludGluZygpIHB1YmxpYyByZXR1cm5zIChib29sKTsKCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGluZGV4ZWQgdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiBpbmRleGVkIHZhbHVlKTsKICAgIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGFtb3VudCk7CiAgICBldmVudCBNaW50RmluaXNoZWQoKTsKfQoKLyoKCiAqIHNvdXJjZSAgICAgICBodHRwczovL2dpdGh1Yi5jb20vYmxvY2tiaXRzaW8vCgogKiBAbmFtZSAgICAgICAgQXBwbGljYXRpb24gQXNzZXQgQ29udHJhY3QgQUJJCiAqIEBwYWNrYWdlICAgICBCbG9ja0JpdHNJTwogKiBAYXV0aG9yICAgICAgTWlja3kgU29jYWNpIDw8YSBocmVmPSIvY2RuLWNnaS9sL2VtYWlsLXByb3RlY3Rpb24iIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iM2U1MzU3NWQ1NTQ3N2U1MDUxNDk1MjU3NDg1YjEwNGM1MSI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvYT4+CgogQW55IGNvbnRyYWN0IGluaGVyaXRpbmcgdGhpcyB3aWxsIGJlIHVzYWJsZSBhcyBhbiBBc3NldCBpbiB0aGUgQXBwbGljYXRpb24gRW50aXR5CgoqLwoKCgpjb250cmFjdCBBQklBcHBsaWNhdGlvbkFzc2V0IHsKCiAgICBieXRlczMyIHB1YmxpYyBhc3NldE5hbWU7CiAgICB1aW50OCBwdWJsaWMgQ3VycmVudEVudGl0eVN0YXRlOwogICAgdWludDggcHVibGljIFJlY29yZE51bTsKICAgIGJvb2wgcHVibGljIF9pbml0aWFsaXplZDsKICAgIGJvb2wgcHVibGljIF9zZXR0aW5nc0FwcGxpZWQ7CiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKICAgIGFkZHJlc3MgcHVibGljIGRlcGxveWVyQWRkcmVzczsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludDgpIHB1YmxpYyBFbnRpdHlTdGF0ZXM7CiAgICBtYXBwaW5nIChieXRlczMyID0+IHVpbnQ4KSBwdWJsaWMgUmVjb3JkU3RhdGVzOwoKICAgIGZ1bmN0aW9uIHNldEluaXRpYWxBcHBsaWNhdGlvbkFkZHJlc3MoYWRkcmVzcyBfb3duZXJBZGRyZXNzKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBzZXRJbml0aWFsT3duZXJBbmROYW1lKGJ5dGVzMzIgX25hbWUpIGV4dGVybmFsIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0UmVjb3JkU3RhdGUoYnl0ZXMzMiBuYW1lKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCk7CiAgICBmdW5jdGlvbiBnZXRFbnRpdHlTdGF0ZShieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGFwcGx5QW5kTG9ja1NldHRpbmdzKCkgcHVibGljIHJldHVybnMoYm9vbCk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlclRvTmV3T3duZXIoYWRkcmVzcyBfbmV3T3duZXIpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldEFwcGxpY2F0aW9uQXNzZXRBZGRyZXNzQnlOYW1lKGJ5dGVzMzIgX25hbWUpIHB1YmxpYyByZXR1cm5zKGFkZHJlc3MpOwogICAgZnVuY3Rpb24gZ2V0QXBwbGljYXRpb25TdGF0ZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGdldEFwcGxpY2F0aW9uRW50aXR5U3RhdGUoYnl0ZXMzMiBuYW1lKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCk7CiAgICBmdW5jdGlvbiBnZXRBcHBCeWxhd1VpbnQyNTYoYnl0ZXMzMiBuYW1lKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGdldEFwcEJ5bGF3Qnl0ZXMzMihieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJ5dGVzMzIpOwogICAgZnVuY3Rpb24gZ2V0VGltZXN0YW1wKCkgdmlldyBwdWJsaWMgcmV0dXJucyAodWludDI1Nik7CgoKfQoKLyoKCiAqIHNvdXJjZSAgICAgICBodHRwczovL2dpdGh1Yi5jb20vYmxvY2tiaXRzaW8vCgogKiBAbmFtZSAgICAgICAgRnVuZGluZyBDb250cmFjdCBBQkkKICogQHBhY2thZ2UgICAgIEJsb2NrQml0c0lPCiAqIEBhdXRob3IgICAgICBNaWNreSBTb2NhY2kgPDxhIGhyZWY9Ii9jZG4tY2dpL2wvZW1haWwtcHJvdGVjdGlvbiIgY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSI1OTM0MzAzYTMyMjAxOTM3MzYyZTM1MzAyZjNjNzcyYjM2Ij5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9hPj4KCiBDb250YWlucyB0aGUgRnVuZGluZyBDb250cmFjdCBjb2RlIGRlcGxveWVkIGFuZCBsaW5rZWQgdG8gdGhlIEFwcGxpY2F0aW9uIEVudGl0eQoKCiAgICAhISEgTGlua3MgZGlyZWN0bHkgdG8gTWlsZXN0b25lcwoKKi8KCgoKCgpjb250cmFjdCBBQklGdW5kaW5nIGlzIEFCSUFwcGxpY2F0aW9uQXNzZXQgewoKICAgIGFkZHJlc3MgcHVibGljIG11bHRpU2lnT3V0cHV0QWRkcmVzczsKICAgIGFkZHJlc3MgcHVibGljIERpcmVjdElucHV0OwogICAgYWRkcmVzcyBwdWJsaWMgTWlsZXN0b25lSW5wdXQ7CiAgICBhZGRyZXNzIHB1YmxpYyBUb2tlbk1hbmFnZXJFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBGdW5kaW5nTWFuYWdlckVudGl0eTsKCiAgICBzdHJ1Y3QgRnVuZGluZ1N0YWdlIHsKICAgICAgICBieXRlczMyIG5hbWU7CiAgICAgICAgdWludDggICBzdGF0ZTsKICAgICAgICB1aW50MjU2IHRpbWVfc3RhcnQ7CiAgICAgICAgdWludDI1NiB0aW1lX2VuZDsKICAgICAgICB1aW50MjU2IGFtb3VudF9jYXBfc29mdDsgICAgICAgICAgICAvLyAwID0gbm90IGVuZm9yY2VkCiAgICAgICAgdWludDI1NiBhbW91bnRfY2FwX2hhcmQ7ICAgICAgICAgICAgLy8gMCA9IG5vdCBlbmZvcmNlZAogICAgICAgIHVpbnQyNTYgYW1vdW50X3JhaXNlZDsgICAgICAgICAgICAgIC8vIDAgPSBub3QgZW5mb3JjZWQKICAgICAgICAvLyBmdW5kaW5nIG1ldGhvZCBzZXR0aW5ncwogICAgICAgIHVpbnQyNTYgbWluaW11bV9lbnRyeTsKICAgICAgICB1aW50OCAgIG1ldGhvZHM7ICAgICAgICAgICAgICAgICAgICAvLyBGdW5kaW5nTWV0aG9kSWRzCiAgICAgICAgLy8gdG9rZW4gc2V0dGluZ3MKICAgICAgICB1aW50MjU2IGZpeGVkX3Rva2VuczsKICAgICAgICB1aW50OCAgIHByaWNlX2FkZGl0aW9uX3BlcmNlbnRhZ2U7ICAvLwogICAgICAgIHVpbnQ4ICAgdG9rZW5fc2hhcmVfcGVyY2VudGFnZTsKICAgICAgICB1aW50OCAgIGluZGV4OwogICAgfQoKICAgIG1hcHBpbmcgKHVpbnQ4ID0+IEZ1bmRpbmdTdGFnZSkgcHVibGljIENvbGxlY3Rpb247CiAgICB1aW50OCBwdWJsaWMgRnVuZGluZ1N0YWdlTnVtOwogICAgdWludDggcHVibGljIGN1cnJlbnRGdW5kaW5nU3RhZ2U7CiAgICB1aW50MjU2IHB1YmxpYyBBbW91bnRSYWlzZWQ7CiAgICB1aW50MjU2IHB1YmxpYyBNaWxlc3RvbmVBbW91bnRSYWlzZWQ7CiAgICB1aW50MjU2IHB1YmxpYyBHbG9iYWxBbW91bnRDYXBTb2Z0OwogICAgdWludDI1NiBwdWJsaWMgR2xvYmFsQW1vdW50Q2FwSGFyZDsKICAgIHVpbnQ4IHB1YmxpYyBUb2tlblNlbGxQZXJjZW50YWdlOwogICAgdWludDI1NiBwdWJsaWMgRnVuZGluZ19TZXR0aW5nX2Z1bmRpbmdfdGltZV9zdGFydDsKICAgIHVpbnQyNTYgcHVibGljIEZ1bmRpbmdfU2V0dGluZ19mdW5kaW5nX3RpbWVfZW5kOwogICAgdWludDI1NiBwdWJsaWMgRnVuZGluZ19TZXR0aW5nX2Nhc2hiYWNrX3RpbWVfc3RhcnQ7CiAgICB1aW50MjU2IHB1YmxpYyBGdW5kaW5nX1NldHRpbmdfY2FzaGJhY2tfdGltZV9lbmQ7CiAgICB1aW50MjU2IHB1YmxpYyBGdW5kaW5nX1NldHRpbmdfY2FzaGJhY2tfYmVmb3JlX3N0YXJ0X3dhaXRfZHVyYXRpb247CiAgICB1aW50MjU2IHB1YmxpYyBGdW5kaW5nX1NldHRpbmdfY2FzaGJhY2tfZHVyYXRpb247CgoKICAgIGZ1bmN0aW9uIGFkZEZ1bmRpbmdTdGFnZSgKICAgICAgICBieXRlczMyIF9uYW1lLAogICAgICAgIHVpbnQyNTYgX3RpbWVfc3RhcnQsCiAgICAgICAgdWludDI1NiBfdGltZV9lbmQsCiAgICAgICAgdWludDI1NiBfYW1vdW50X2NhcF9zb2Z0LAogICAgICAgIHVpbnQyNTYgX2Ftb3VudF9jYXBfaGFyZCwgICAvLyByZXF1aXJlZCA+IDAKICAgICAgICB1aW50OCAgIF9tZXRob2RzLAogICAgICAgIHVpbnQyNTYgX21pbmltdW1fZW50cnksCiAgICAgICAgdWludDI1NiBfZml4ZWRfdG9rZW5zLAogICAgICAgIHVpbnQ4ICAgX3ByaWNlX2FkZGl0aW9uX3BlcmNlbnRhZ2UsCiAgICAgICAgdWludDggICBfdG9rZW5fc2hhcmVfcGVyY2VudGFnZQogICAgKQogICAgcHVibGljOwoKICAgIGZ1bmN0aW9uIGFkZFNldHRpbmdzKGFkZHJlc3MgX291dHB1dEFkZHJlc3MsIHVpbnQyNTYgc29mdF9jYXAsIHVpbnQyNTYgaGFyZF9jYXAsIHVpbnQ4IHNhbGVfcGVyY2VudGFnZSwgYWRkcmVzcyBfZGlyZWN0LCBhZGRyZXNzIF9taWxlc3RvbmUgKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBnZXRTdGFnZUFtb3VudCh1aW50OCBTdGFnZUlkKSBwdWJsaWMgdmlldyByZXR1cm5zICggdWludDI1NiApOwogICAgZnVuY3Rpb24gYWxsb3dlZFBheW1lbnRNZXRob2QodWludDggX3BheW1lbnRfbWV0aG9kKSBwdWJsaWMgcHVyZSByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIHJlY2VpdmVQYXltZW50KGFkZHJlc3MgX3NlbmRlciwgdWludDggX3BheW1lbnRfbWV0aG9kKSBwYXlhYmxlIHB1YmxpYyByZXR1cm5zKGJvb2wpOwogICAgZnVuY3Rpb24gY2FuQWNjZXB0UGF5bWVudCh1aW50MjU2IF9hbW91bnQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0VmFsdWVPdmVyQ3VycmVudENhcCh1aW50MjU2IF9hbW91bnQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gaXNGdW5kaW5nU3RhZ2VVcGRhdGVBbGxvd2VkKHVpbnQ4IF9uZXdfc3RhdGUgKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldFJlY29yZFN0YXRlUmVxdWlyZWRDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gZG9TdGF0ZUNoYW5nZXMoKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBoYXNSZXF1aXJlZFN0YXRlQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0UmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCwgdWludDgsIHVpbnQ4KTsKCn0KCi8qCgogKiBzb3VyY2UgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL2Jsb2NrYml0c2lvLwoKICogQG5hbWUgICAgICAgIE1pbGVzdG9uZXMgQ29udHJhY3QKICogQHBhY2thZ2UgICAgIEJsb2NrQml0c0lPCiAqIEBhdXRob3IgICAgICBNaWNreSBTb2NhY2kgPDxhIGhyZWY9Ii9jZG4tY2dpL2wvZW1haWwtcHJvdGVjdGlvbiIgY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSJjMGFkYTlhM2FiYjk4MGFlYWZiN2FjYTliNmE1ZWViMmFmIj5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9hPj4KCiBDb250YWlucyB0aGUgTWlsZXN0b25lcyBDb250cmFjdCBjb2RlIGRlcGxveWVkIGFuZCBsaW5rZWQgdG8gdGhlIEFwcGxpY2F0aW9uIEVudGl0eQoKKi8KCgoKCgpjb250cmFjdCBBQklNaWxlc3RvbmVzIGlzIEFCSUFwcGxpY2F0aW9uQXNzZXQgewoKICAgIHN0cnVjdCBSZWNvcmQgewogICAgICAgIGJ5dGVzMzIgbmFtZTsKICAgICAgICBzdHJpbmcgZGVzY3JpcHRpb247ICAgICAgICAgICAgICAgICAgICAgLy8gd2lsbCBjaGFuZ2UgdG8gaGFzaCBwb2ludGVyICggZXh0ZXJuYWwgc3RvcmFnZSApCiAgICAgICAgdWludDggc3RhdGU7CiAgICAgICAgdWludDI1NiBkdXJhdGlvbjsKICAgICAgICB1aW50MjU2IHRpbWVfc3RhcnQ7ICAgICAgICAgICAgICAgICAgICAgLy8gc3RhcnQgYXQgdW5peHRpbWVzdGFtcAogICAgICAgIHVpbnQyNTYgbGFzdF9zdGF0ZV9jaGFuZ2VfdGltZTsgICAgICAgICAvLyB0aW1lIG9mIGxhc3Qgc3RhdGUgY2hhbmdlCiAgICAgICAgdWludDI1NiB0aW1lX2VuZDsgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzdGltYXRlZCBlbmQgdGltZSA+PiBjYW4gYmUgaW5jcmVhc2VkIGJ5IHByb3Bvc2FsCiAgICAgICAgdWludDI1NiB0aW1lX2VuZGVkOyAgICAgICAgICAgICAgICAgICAgIC8vIGFjdHVhbCBlbmQgdGltZQogICAgICAgIHVpbnQyNTYgbWVldGluZ190aW1lOwogICAgICAgIHVpbnQ4IGZ1bmRpbmdfcGVyY2VudGFnZTsKICAgICAgICB1aW50OCBpbmRleDsKICAgIH0KCiAgICB1aW50OCBwdWJsaWMgY3VycmVudFJlY29yZDsKICAgIHVpbnQyNTYgcHVibGljIE1pbGVzdG9uZUNhc2hCYWNrVGltZSA9IDA7CiAgICBtYXBwaW5nICh1aW50OCA9PiBSZWNvcmQpIHB1YmxpYyBDb2xsZWN0aW9uOwogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiBib29sKSBwdWJsaWMgTWlsZXN0b25lUG9zdHBvbmluZ0hhc2g7CiAgICBtYXBwaW5nIChieXRlczMyID0+IHVpbnQyNTYpIHB1YmxpYyBQcm9wb3NhbElkQnlIYXNoOwoKICAgIGZ1bmN0aW9uIGdldEJ5bGF3c1Byb2plY3REZXZlbG9wbWVudFN0YXJ0KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBnZXRCeWxhd3NNaW5UaW1lSW5UaGVGdXR1cmVGb3JNZWV0aW5nQ3JlYXRpb24oKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGdldEJ5bGF3c0Nhc2hCYWNrVm90ZVJlamVjdGVkRHVyYXRpb24oKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGFkZFJlY29yZCggYnl0ZXMzMiBfbmFtZSwgc3RyaW5nIF9kZXNjcmlwdGlvbiwgdWludDI1NiBfZHVyYXRpb24sIHVpbnQ4IF9wZXJjICkgcHVibGljOwogICAgZnVuY3Rpb24gZ2V0TWlsZXN0b25lRnVuZGluZ1BlcmNlbnRhZ2UodWludDggcmVjb3JkSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGRvU3RhdGVDaGFuZ2VzKCkgcHVibGljOwogICAgZnVuY3Rpb24gZ2V0UmVjb3JkU3RhdGVSZXF1aXJlZENoYW5nZXMoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCk7CiAgICBmdW5jdGlvbiBoYXNSZXF1aXJlZFN0YXRlQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gYWZ0ZXJWb3RlTm9DYXNoQmFja1RpbWUoKSBwdWJsaWMgdmlldyByZXR1cm5zICggYm9vbCApOwogICAgZnVuY3Rpb24gZ2V0SGFzaCh1aW50OCBhY3Rpb25UeXBlLCBieXRlczMyIGFyZzEsIGJ5dGVzMzIgYXJnMikgcHVibGljIHB1cmUgcmV0dXJucyAoIGJ5dGVzMzIgKTsKICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRIYXNoKCkgcHVibGljIHZpZXcgcmV0dXJucyAoIGJ5dGVzMzIgKTsKICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRQcm9wb3NhbElkKCkgaW50ZXJuYWwgdmlldyByZXR1cm5zICggdWludDI1NiApOwogICAgZnVuY3Rpb24gc2V0Q3VycmVudE1pbGVzdG9uZU1lZXRpbmdUaW1lKHVpbnQyNTYgX21lZXRpbmdfdGltZSkgcHVibGljOwogICAgZnVuY3Rpb24gaXNSZWNvcmRVcGRhdGVBbGxvd2VkKHVpbnQ4IF9uZXdfc3RhdGUgKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldFJlcXVpcmVkU3RhdGVDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgsIHVpbnQ4LCB1aW50OCk7CiAgICBmdW5jdGlvbiBBcHBsaWNhdGlvbklzSW5EZXZlbG9wbWVudCgpIHB1YmxpYyB2aWV3IHJldHVybnMoYm9vbCk7CiAgICBmdW5jdGlvbiBNZWV0aW5nVGltZVNldEZhaWx1cmUoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKCn0KCi8qCgogKiBzb3VyY2UgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL2Jsb2NrYml0c2lvLwoKICogQG5hbWUgICAgICAgIFByb3Bvc2FscyBDb250cmFjdAogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImE5YzRjMGNhYzJkMGU5YzdjNmRlYzVjMGRmY2M4N2RiYzYiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+PgoKIENvbnRhaW5zIHRoZSBQcm9wb3NhbHMgQ29udHJhY3QgY29kZSBkZXBsb3llZCBhbmQgbGlua2VkIHRvIHRoZSBBcHBsaWNhdGlvbiBFbnRpdHkKCiovCgoKCgoKY29udHJhY3QgQUJJUHJvcG9zYWxzIGlzIEFCSUFwcGxpY2F0aW9uQXNzZXQgewoKICAgIGFkZHJlc3MgcHVibGljIEFwcGxpY2F0aW9uOwogICAgYWRkcmVzcyBwdWJsaWMgTGlzdGluZ0NvbnRyYWN0RW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgRnVuZGluZ0VudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIEZ1bmRpbmdNYW5hZ2VyRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgVG9rZW5NYW5hZ2VyRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgVG9rZW5FbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBNaWxlc3RvbmVzRW50aXR5OwoKICAgIHN0cnVjdCBQcm9wb3NhbFJlY29yZCB7CiAgICAgICAgYWRkcmVzcyBjcmVhdG9yOwogICAgICAgIGJ5dGVzMzIgbmFtZTsKICAgICAgICB1aW50OCBhY3Rpb25UeXBlOwogICAgICAgIHVpbnQ4IHN0YXRlOwogICAgICAgIGJ5dGVzMzIgaGFzaDsgICAgICAgICAgICAgICAgICAgICAgIC8vIGFjdGlvbiBuYW1lICsgYXJncyBoYXNoCiAgICAgICAgYWRkcmVzcyBhZGRyOwogICAgICAgIGJ5dGVzMzIgc291cmNlQ29kZVVybDsKICAgICAgICB1aW50MjU2IGV4dHJhOwogICAgICAgIHVpbnQyNTYgdGltZV9zdGFydDsKICAgICAgICB1aW50MjU2IHRpbWVfZW5kOwogICAgICAgIHVpbnQyNTYgaW5kZXg7CiAgICB9CgogICAgc3RydWN0IFZvdGVTdHJ1Y3QgewogICAgICAgIGFkZHJlc3Mgdm90ZXI7CiAgICAgICAgdWludDI1NiB0aW1lOwogICAgICAgIGJvb2wgICAgdm90ZTsKICAgICAgICB1aW50MjU2IHBvd2VyOwogICAgICAgIGJvb2wgICAgYW5udWxsZWQ7CiAgICAgICAgdWludDI1NiBpbmRleDsKICAgIH0KCiAgICBzdHJ1Y3QgUmVzdWx0UmVjb3JkIHsKICAgICAgICB1aW50MjU2IHRvdGFsQXZhaWxhYmxlOwogICAgICAgIHVpbnQyNTYgcmVxdWlyZWRGb3JSZXN1bHQ7CiAgICAgICAgdWludDI1NiB0b3RhbFNvRmFyOwogICAgICAgIHVpbnQyNTYgeWVzOwogICAgICAgIHVpbnQyNTYgbm87CiAgICAgICAgYm9vbCAgICByZXF1aXJlc0NvdW50aW5nOwogICAgfQoKICAgIHVpbnQ4IHB1YmxpYyBBY3RpdmVQcm9wb3NhbE51bTsKICAgIHVpbnQyNTYgcHVibGljIFZvdGVDb3VudFBlclByb2Nlc3M7CiAgICBib29sIHB1YmxpYyBFbWVyZ2VuY3lGdW5kaW5nUmVsZWFzZUFwcHJvdmVkOwoKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludDgpIHB1YmxpYyBBY3Rpb25UeXBlczsKICAgIG1hcHBpbmcgKHVpbnQ4ID0+IHVpbnQyNTYpIHB1YmxpYyBBY3RpdmVQcm9wb3NhbElkczsKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gYm9vbCkgcHVibGljIEV4cGlyZWRQcm9wb3NhbElkczsKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gUHJvcG9zYWxSZWNvcmQpIHB1YmxpYyBQcm9wb3NhbHNCeUlkOwogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiB1aW50MjU2KSBwdWJsaWMgUHJvcG9zYWxJZEJ5SGFzaDsKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gbWFwcGluZyAodWludDI1NiA9PiBWb3RlU3RydWN0KSApIHB1YmxpYyBWb3Rlc0J5UHJvcG9zYWxJZDsKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiBWb3RlU3RydWN0KSApIHB1YmxpYyBWb3Rlc0J5Q2FzdGVyOwogICAgbWFwcGluZyAodWludDI1NiA9PiB1aW50MjU2KSBwdWJsaWMgVm90ZXNOdW1CeVByb3Bvc2FsSWQ7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IFJlc3VsdFJlY29yZCApIHB1YmxpYyBSZXN1bHRzQnlQcm9wb3NhbElkOwogICAgbWFwcGluZyAodWludDI1NiA9PiB1aW50MjU2KSBwdWJsaWMgbGFzdFByb2Nlc3NlZFZvdGVJZEJ5UHJvcG9zYWw7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IHVpbnQyNTYpIHB1YmxpYyBQcm9jZXNzZWRWb3Rlc0J5UHJvcG9zYWw7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IHVpbnQyNTYpIHB1YmxpYyBWb3RlQ291bnRBdFByb2Nlc3NpbmdTdGFydEJ5UHJvcG9zYWw7CgogICAgZnVuY3Rpb24gZ2V0UmVjb3JkU3RhdGUoYnl0ZXMzMiBuYW1lKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCk7CiAgICBmdW5jdGlvbiBnZXRBY3Rpb25UeXBlKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gZ2V0UHJvcG9zYWxTdGF0ZSh1aW50MjU2IF9wcm9wb3NhbElkKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCk7CiAgICBmdW5jdGlvbiBnZXRCeWxhd3NQcm9wb3NhbFZvdGluZ0R1cmF0aW9uKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBnZXRCeWxhd3NNaWxlc3RvbmVNaW5Qb3N0cG9uaW5nKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBnZXRCeWxhd3NNaWxlc3RvbmVNYXhQb3N0cG9uaW5nKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBnZXRIYXNoKHVpbnQ4IGFjdGlvblR5cGUsIGJ5dGVzMzIgYXJnMSwgYnl0ZXMzMiBhcmcyKSBwdWJsaWMgcHVyZSByZXR1cm5zICggYnl0ZXMzMiApOwogICAgZnVuY3Rpb24gcHJvY2VzcygpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGhhc1JlcXVpcmVkU3RhdGVDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRSZXF1aXJlZFN0YXRlQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGFkZENvZGVVcGdyYWRlUHJvcG9zYWwoYWRkcmVzcyBfYWRkciwgYnl0ZXMzMiBfc291cmNlQ29kZVVybCkgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBjcmVhdGVNaWxlc3RvbmVBY2NlcHRhbmNlUHJvcG9zYWwoKSBleHRlcm5hbCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGNyZWF0ZU1pbGVzdG9uZVBvc3Rwb25pbmdQcm9wb3NhbCh1aW50MjU2IF9kdXJhdGlvbikgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBnZXRDdXJyZW50TWlsZXN0b25lUG9zdHBvbmluZ1Byb3Bvc2FsRHVyYXRpb24oKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRNaWxlc3RvbmVQcm9wb3NhbFN0YXR1c0ZvclR5cGUodWludDggX2FjdGlvblR5cGUgKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCk7CiAgICBmdW5jdGlvbiBjcmVhdGVFbWVyZ2VuY3lGdW5kUmVsZWFzZVByb3Bvc2FsKCkgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBjcmVhdGVEZWxpc3RpbmdQcm9wb3NhbCh1aW50MjU2IF9wcm9qZWN0SWQpIGV4dGVybmFsIHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gUmVnaXN0ZXJWb3RlKHVpbnQyNTYgX3Byb3Bvc2FsSWQsIGJvb2wgX215Vm90ZSkgcHVibGljOwogICAgZnVuY3Rpb24gaGFzUHJldmlvdXNWb3RlKHVpbnQyNTYgX3Byb3Bvc2FsSWQsIGFkZHJlc3MgX3ZvdGVyKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldFRvdGFsVG9rZW5Wb3RpbmdQb3dlcihhZGRyZXNzIF92b3RlcikgcHVibGljIHZpZXcgcmV0dXJucyAoIHVpbnQyNTYgKTsKICAgIGZ1bmN0aW9uIGdldFZvdGluZ1Bvd2VyKHVpbnQyNTYgX3Byb3Bvc2FsSWQsIGFkZHJlc3MgX3ZvdGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICggdWludDI1NiApOwogICAgZnVuY3Rpb24gc2V0Vm90ZUNvdW50UGVyUHJvY2Vzcyh1aW50MjU2IF9wZXJQcm9jZXNzKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIFByb2Nlc3NWb3RlVG90YWxzKHVpbnQyNTYgX3Byb3Bvc2FsSWQsIHVpbnQyNTYgbGVuZ3RoKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBjYW5FbmRWb3RpbmcodWludDI1NiBfcHJvcG9zYWxJZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRQcm9wb3NhbFR5cGUodWludDI1NiBfcHJvcG9zYWxJZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gZXhwaXJ5Q2hhbmdlc1N0YXRlKHVpbnQyNTYgX3Byb3Bvc2FsSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gbmVlZHNQcm9jZXNzaW5nKHVpbnQyNTYgX3Byb3Bvc2FsSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0TXlWb3RlRm9yQ3VycmVudE1pbGVzdG9uZVJlbGVhc2UoYWRkcmVzcyBfdm90ZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0SGFzVm90ZUZvckN1cnJlbnRNaWxlc3RvbmVSZWxlYXNlKGFkZHJlc3MgX3ZvdGVyKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldE15Vm90ZSh1aW50MjU2IF9wcm9wb3NhbElkLCBhZGRyZXNzIF92b3RlcikgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7Cgp9CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBUb2tlbiBNYW5hZ2VyIENvbnRyYWN0CiAqIEBwYWNrYWdlICAgICBCbG9ja0JpdHNJTwogKiBAYXV0aG9yICAgICAgTWlja3kgU29jYWNpIDw8YSBocmVmPSIvY2RuLWNnaS9sL2VtYWlsLXByb3RlY3Rpb24iIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iZjg5NTkxOWI5MzgxYjg5Njk3OGY5NDkxOGU5ZGQ2OGE5NyI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvYT4+CgoqLwoKCgoKCmNvbnRyYWN0IEFCSVRva2VuTWFuYWdlciBpcyBBQklBcHBsaWNhdGlvbkFzc2V0IHsKCiAgICBhZGRyZXNzIHB1YmxpYyBUb2tlblNDQURBRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgVG9rZW5FbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBNYXJrZXRpbmdNZXRob2RBZGRyZXNzOwogICAgYm9vbCBPd25lclRva2VuQmFsYW5jZXNSZWxlYXNlZCA9IGZhbHNlOwoKICAgIGZ1bmN0aW9uIGFkZFNldHRpbmdzKGFkZHJlc3MgX3NjYWRhQWRkcmVzcywgYWRkcmVzcyBfdG9rZW5BZGRyZXNzLCBhZGRyZXNzIF9tYXJrZXRpbmcgKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBnZXRUb2tlblNDQURBUmVxdWlyZXNIYXJkQ2FwKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBtaW50Rm9yTWFya2V0aW5nUG9vbChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBleHRlcm5hbCByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIFJlbGVhc2VPd25lcnNMb2NrZWRUb2tlbnMoYWRkcmVzcyBfbXVsdGlTaWdPdXRwdXRBZGRyZXNzKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7Cgp9CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBGdW5kaW5nIENvbnRyYWN0IEFCSQogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImI0ZDlkZGQ3ZGZjZGY0ZGFkYmMzZDhkZGMyZDE5YWM2ZGIiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+PgoKIENvbnRhaW5zIHRoZSBGdW5kaW5nIENvbnRyYWN0IGNvZGUgZGVwbG95ZWQgYW5kIGxpbmtlZCB0byB0aGUgQXBwbGljYXRpb24gRW50aXR5CgoqLwoKCgoKCmNvbnRyYWN0IEFCSUZ1bmRpbmdNYW5hZ2VyIGlzIEFCSUFwcGxpY2F0aW9uQXNzZXQgewoKICAgIGJvb2wgcHVibGljIGZ1bmRpbmdQcm9jZXNzZWQ7CiAgICBib29sIEZ1bmRpbmdQb29sQmFsYW5jZXNBbGxvY2F0ZWQ7CiAgICB1aW50OCBwdWJsaWMgVmF1bHRDb3VudFBlclByb2Nlc3M7CiAgICB1aW50MjU2IHB1YmxpYyBsYXN0UHJvY2Vzc2VkVmF1bHRJZDsKICAgIHVpbnQyNTYgcHVibGljIHZhdWx0TnVtOwogICAgdWludDI1NiBwdWJsaWMgTG9ja2VkVm90aW5nVG9rZW5zOwogICAgYnl0ZXMzMiBwdWJsaWMgY3VycmVudFRhc2s7CiAgICBtYXBwaW5nIChieXRlczMyID0+IGJvb2wpIHB1YmxpYyB0YXNrQnlIYXNoOwogICAgbWFwcGluZyAgKGFkZHJlc3MgPT4gYWRkcmVzcykgcHVibGljIHZhdWx0TGlzdDsKICAgIG1hcHBpbmcgICh1aW50MjU2ID0+IGFkZHJlc3MpIHB1YmxpYyB2YXVsdEJ5SWQ7CgogICAgZnVuY3Rpb24gcmVjZWl2ZVBheW1lbnQoYWRkcmVzcyBfc2VuZGVyLCB1aW50OCBfcGF5bWVudF9tZXRob2QsIHVpbnQ4IF9mdW5kaW5nX3N0YWdlKSBwYXlhYmxlIHB1YmxpYyByZXR1cm5zKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0TXlWYXVsdEFkZHJlc3MoYWRkcmVzcyBfc2VuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIHNldFZhdWx0Q291bnRQZXJQcm9jZXNzKHVpbnQ4IF9wZXJQcm9jZXNzKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIGdldEhhc2goYnl0ZXMzMiBhY3Rpb25UeXBlLCBieXRlczMyIGFyZzEpIHB1YmxpYyBwdXJlIHJldHVybnMgKCBieXRlczMyICk7CiAgICBmdW5jdGlvbiBnZXRDdXJyZW50TWlsZXN0b25lUHJvY2Vzc2VkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBwcm9jZXNzRnVuZGluZ0ZhaWxlZEZpbmlzaGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBwcm9jZXNzRnVuZGluZ1N1Y2Nlc3NmdWxGaW5pc2hlZCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0Q3VycmVudE1pbGVzdG9uZUlkSGFzaCgpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYnl0ZXMzMik7CiAgICBmdW5jdGlvbiBwcm9jZXNzTWlsZXN0b25lRmluaXNoZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIHByb2Nlc3NFbWVyZ2VuY3lGdW5kUmVsZWFzZUZpbmlzaGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRBZnRlclRyYW5zZmVyTG9ja2VkVG9rZW5CYWxhbmNlcyhhZGRyZXNzIHZhdWx0QWRkcmVzcywgYm9vbCBleGNsdWRlQ3VycmVudCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBWYXVsdFJlcXVlc3RlZFVwZGF0ZUZvckxvY2tlZFZvdGluZ1Rva2VucyhhZGRyZXNzIG93bmVyKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBkb1N0YXRlQ2hhbmdlcygpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGhhc1JlcXVpcmVkU3RhdGVDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRSZXF1aXJlZFN0YXRlQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4LCB1aW50OCk7CiAgICBmdW5jdGlvbiBBcHBsaWNhdGlvbkluRnVuZGluZ09yRGV2ZWxvcG1lbnQoKSBwdWJsaWMgdmlldyByZXR1cm5zKGJvb2wpOwoKfQoKLyoKCiAqIHNvdXJjZSAgICAgICBodHRwczovL2dpdGh1Yi5jb20vYmxvY2tiaXRzaW8vCgogKiBAbmFtZSAgICAgICAgVG9rZW4gU3Rha2UgQ2FsY3VsYXRpb24gQW5kIERpc3RyaWJ1dGlvbiBBbGdvcml0aG0gLSBUeXBlIDMgLSBTZWxsIGEgdmFyaWFibGUgYW1vdW50IG9mIHRva2VucyBmb3IgYSBmaXhlZCBwcmljZQogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjJiNDY0MjQ4NDA1MjZiNDU0NDVjNDc0MjVkNGUwNTU5NDQiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+PgoKCiAgICBJbnB1dHM6CgogICAgRGVmaW5lZCBudW1iZXIgb2YgdG9rZW5zIHBlciB3ZWkgKCBYIFRva2VucyA9IDEgd2VpICkKICAgIFJlY2VpdmVkIGFtb3VudCBvZiBFVEgKICAgIEdlbmVyYXRlczoKCiAgICBUb3RhbCBTdXBwbHkgb2YgdG9rZW5zIGF2YWlsYWJsZSBpbiBGdW5kaW5nIFBoYXNlIHJlc3BlY3RpdmVseSBQcm9qZWN0CiAgICBPYnNlcnZhdGlvbnM6CgogICAgV2lsbCBzZWxsIHRoZSB3aG9sZSBzdXBwbHkgb2YgVG9rZW5zIGF2YWlsYWJsZSB0byBDdXJyZW50IEZ1bmRpbmcgUGhhc2UKICAgIFVzZSBjYXNlczoKCiAgICBBbnkgRnVuZGluZyBQaGFzZSB3aGVyZSB5b3Ugd2FudCB0aGUgZmlyc3QgRnVuZGluZyBQaGFzZSB0byBkZXRlcm1pbmUgdGhlIHRva2VuIHN1cHBseSBvZiB0aGUgd2hvbGUgUHJvamVjdAoKKi8KCgoKCmNvbnRyYWN0IEFCSVRva2VuU0NBREFWYXJpYWJsZSB7CiAgICBib29sIHB1YmxpYyBTQ0FEQV9yZXF1aXJlc19oYXJkX2NhcCA9IHRydWU7CiAgICBib29sIHB1YmxpYyBpbml0aWFsaXplZDsKICAgIGFkZHJlc3MgcHVibGljIGRlcGxveWVyQWRkcmVzczsKICAgIGZ1bmN0aW9uIGFkZFNldHRpbmdzKGFkZHJlc3MgX2Z1bmRpbmdDb250cmFjdCkgcHVibGljOwogICAgZnVuY3Rpb24gcmVxdWlyZXNIYXJkQ2FwKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRUb2tlbnNGb3JWYWx1ZUluQ3VycmVudFN0YWdlKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGdldFRva2Vuc0ZvclZhbHVlSW5TdGFnZSh1aW50OCBfc3RhZ2UsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGdldEJvdWdodFRva2VucyggYWRkcmVzcyBfdmF1bHRBZGRyZXNzLCBib29sIF9kaXJlY3QgKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKfQoKLyoKCiAqIHNvdXJjZSAgICAgICBodHRwczovL2dpdGh1Yi5jb20vYmxvY2tiaXRzaW8vCgogKiBAbmFtZSAgICAgICAgRnVuZGluZyBWYXVsdAogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjNjNTE1NTVmNTc0NTdjNTI1MzRiNTA1NTRhNTkxMjRlNTMiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+PgoKICAgIGVhY2ggcHVyY2hhc2UgY3JlYXRlcyBhIHNlcGFyYXRlIGZ1bmRpbmcgdmF1bHQgY29udHJhY3QKKi8KCgpjb250cmFjdCBGdW5kaW5nVmF1bHQgewoKICAgIC8qIEFzc2V0IGluaXRpYWxpc2VkIG9yIG5vdCAqLwogICAgYm9vbCBwdWJsaWMgX2luaXRpYWxpemVkID0gZmFsc2U7CgogICAgLyoKICAgICAgICBBZGRyZXNzZXM6CiAgICAgICAgdmF1bHRPd25lciAtIHRoZSBhZGRyZXNzIG9mIHRoZSB3YWxsZXQgdGhhdCBzdG9yZXMgcHVyY2hhc2VzIGluIHRoaXMgdmF1bHQgKCBpbnZlc3RvciBhZGRyZXNzICkKICAgICAgICBvdXRwdXRBZGRyZXNzIC0gYWRkcmVzcyB3aGVyZSBmdW5kcyBnbyB1cG9uIHN1Y2Nlc3NmdWwgZnVuZGluZyBvciBzdWNjZXNzZnVsIG1pbGVzdG9uZSByZWxlYXNlCiAgICAgICAgbWFuYWdlckFkZHJlc3MgLSBhZGRyZXNzIG9mIHRoZSAiRnVuZGluZ01hbmFnZXIiCiAgICAqLwogICAgYWRkcmVzcyBwdWJsaWMgdmF1bHRPd25lciA7CiAgICBhZGRyZXNzIHB1YmxpYyBvdXRwdXRBZGRyZXNzOwogICAgYWRkcmVzcyBwdWJsaWMgbWFuYWdlckFkZHJlc3M7CgogICAgLyoKICAgICAgICBMb2NrIGFuZCBCbGFja0hvbGUgc2V0dGluZ3MKICAgICovCgogICAgYm9vbCBwdWJsaWMgYWxsRnVuZGluZ1Byb2Nlc3NlZCA9IGZhbHNlOwogICAgYm9vbCBwdWJsaWMgRGlyZWN0RnVuZGluZ1Byb2Nlc3NlZCA9IGZhbHNlOwoKICAgIC8qCiAgICAgICAgQXNzZXRzCiAgICAqLwogICAgLy8gQXBwbGljYXRpb25FbnRpdHlBQkkgcHVibGljIEFwcGxpY2F0aW9uRW50aXR5OwogICAgQUJJRnVuZGluZyBGdW5kaW5nRW50aXR5OwogICAgQUJJRnVuZGluZ01hbmFnZXIgRnVuZGluZ01hbmFnZXJFbnRpdHk7CiAgICBBQklNaWxlc3RvbmVzIE1pbGVzdG9uZXNFbnRpdHk7CiAgICBBQklQcm9wb3NhbHMgUHJvcG9zYWxzRW50aXR5OwogICAgQUJJVG9rZW5TQ0FEQVZhcmlhYmxlIFRva2VuU0NBREFFbnRpdHk7CiAgICBBQklUb2tlbiBUb2tlbkVudGl0eSA7CgogICAgLyoKICAgICAgICBHbG9iYWxzCiAgICAqLwogICAgdWludDI1NiBwdWJsaWMgYW1vdW50X2RpcmVjdCA9IDA7CiAgICB1aW50MjU2IHB1YmxpYyBhbW91bnRfbWlsZXN0b25lID0gMDsKCiAgICAvLyBieWxhd3MKICAgIGJvb2wgcHVibGljIGVtZXJnZW5jeUZ1bmRSZWxlYXNlZCA9IGZhbHNlOwogICAgdWludDggZW1lcmdlbmN5RnVuZFBlcmNlbnRhZ2UgPSAwOwogICAgdWludDI1NiBCeWxhd3NDYXNoQmFja093bmVyTWlhRHVyYXRpb247CiAgICB1aW50MjU2IEJ5bGF3c0Nhc2hCYWNrVm90ZVJlamVjdGVkRHVyYXRpb247CiAgICB1aW50MjU2IEJ5bGF3c1Byb3Bvc2FsVm90aW5nRHVyYXRpb247CgogICAgc3RydWN0IFB1cmNoYXNlU3RydWN0IHsKICAgICAgICB1aW50MjU2IHVuaXhfdGltZTsKICAgICAgICB1aW50OCBwYXltZW50X21ldGhvZDsKICAgICAgICB1aW50MjU2IGFtb3VudDsKICAgICAgICB1aW50OCBmdW5kaW5nX3N0YWdlOwogICAgICAgIHVpbnQxNiBpbmRleDsKICAgIH0KCiAgICBtYXBwaW5nKHVpbnQxNiA9PiBQdXJjaGFzZVN0cnVjdCkgcHVibGljIHB1cmNoYXNlUmVjb3JkczsKICAgIHVpbnQxNiBwdWJsaWMgcHVyY2hhc2VSZWNvcmRzTnVtOwoKICAgIGV2ZW50IEV2ZW50UGF5bWVudFJlY2VpdmVkKHVpbnQ4IGluZGV4ZWQgX3BheW1lbnRfbWV0aG9kLCB1aW50MjU2IGluZGV4ZWQgX2Ftb3VudCwgdWludDE2IGluZGV4ZWQgX2luZGV4ICk7CiAgICBldmVudCBWYXVsdEluaXRpYWxpemVkKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIpOwoKICAgIGZ1bmN0aW9uIGluaXRpYWxpemUoCiAgICAgICAgYWRkcmVzcyBfb3duZXIsCiAgICAgICAgYWRkcmVzcyBfb3V0cHV0LAogICAgICAgIGFkZHJlc3MgX2Z1bmRpbmdBZGRyZXNzLAogICAgICAgIGFkZHJlc3MgX21pbGVzdG9uZUFkZHJlc3MsCiAgICAgICAgYWRkcmVzcyBfcHJvcG9zYWxzQWRkcmVzcwogICAgKQogICAgICAgIHB1YmxpYwogICAgICAgIHJlcXVpcmVOb3RJbml0aWFsaXNlZAogICAgICAgIHJldHVybnMoYm9vbCkKICAgIHsKICAgICAgICBWYXVsdEluaXRpYWxpemVkKF9vd25lcik7CgogICAgICAgIG91dHB1dEFkZHJlc3MgPSBfb3V0cHV0OwogICAgICAgIHZhdWx0T3duZXIgPSBfb3duZXI7CgogICAgICAgIC8vIHdob21ldmVyIGNyZWF0ZXMgdGhpcyBjb250cmFjdCBpcyB0aGUgbWFuYWdlci4KICAgICAgICBtYW5hZ2VyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CgogICAgICAgIC8vIGFzc2V0cwogICAgICAgIEZ1bmRpbmdFbnRpdHkgPSBBQklGdW5kaW5nKF9mdW5kaW5nQWRkcmVzcyk7CiAgICAgICAgRnVuZGluZ01hbmFnZXJFbnRpdHkgPSBBQklGdW5kaW5nTWFuYWdlcihtYW5hZ2VyQWRkcmVzcyk7CiAgICAgICAgTWlsZXN0b25lc0VudGl0eSA9IEFCSU1pbGVzdG9uZXMoX21pbGVzdG9uZUFkZHJlc3MpOwogICAgICAgIFByb3Bvc2Fsc0VudGl0eSA9IEFCSVByb3Bvc2FscyhfcHJvcG9zYWxzQWRkcmVzcyk7CgogICAgICAgIGFkZHJlc3MgVG9rZW5NYW5hZ2VyQWRkcmVzcyA9IEZ1bmRpbmdFbnRpdHkuZ2V0QXBwbGljYXRpb25Bc3NldEFkZHJlc3NCeU5hbWUoIlRva2VuTWFuYWdlciIpOwogICAgICAgIEFCSVRva2VuTWFuYWdlciBUb2tlbk1hbmFnZXJFbnRpdHkgPSBBQklUb2tlbk1hbmFnZXIoVG9rZW5NYW5hZ2VyQWRkcmVzcyk7CgogICAgICAgIGFkZHJlc3MgVG9rZW5BZGRyZXNzID0gVG9rZW5NYW5hZ2VyRW50aXR5LlRva2VuRW50aXR5KCk7CiAgICAgICAgVG9rZW5FbnRpdHkgPSBBQklUb2tlbihUb2tlbkFkZHJlc3MpOwoKICAgICAgICBhZGRyZXNzIFRva2VuU0NBREFBZGRyZXNzID0gVG9rZW5NYW5hZ2VyRW50aXR5LlRva2VuU0NBREFFbnRpdHkoKTsKICAgICAgICBUb2tlblNDQURBRW50aXR5ID0gQUJJVG9rZW5TQ0FEQVZhcmlhYmxlKFRva2VuU0NBREFBZGRyZXNzKTsKCiAgICAgICAgLy8gc2V0IEVtZXJnZW5jeSBGdW5kIFBlcmNlbnRhZ2UgaWYgYXZhaWxhYmxlLgogICAgICAgIGFkZHJlc3MgQXBwbGljYXRpb25FbnRpdHlBZGRyZXNzID0gVG9rZW5NYW5hZ2VyRW50aXR5Lm93bmVyKCk7CiAgICAgICAgQXBwbGljYXRpb25FbnRpdHlBQkkgQXBwbGljYXRpb25FbnRpdHkgPSBBcHBsaWNhdGlvbkVudGl0eUFCSShBcHBsaWNhdGlvbkVudGl0eUFkZHJlc3MpOwoKICAgICAgICAvLyBnZXQgQXBwbGljYXRpb24gQnlsYXdzCiAgICAgICAgZW1lcmdlbmN5RnVuZFBlcmNlbnRhZ2UgICAgICAgICAgICAgPSB1aW50OCggQXBwbGljYXRpb25FbnRpdHkuZ2V0QnlsYXdVaW50MjU2KCJlbWVyZ2VuY3lfZnVuZF9wZXJjZW50YWdlIikgKTsKICAgICAgICBCeWxhd3NDYXNoQmFja093bmVyTWlhRHVyYXRpb24gICAgICA9IEFwcGxpY2F0aW9uRW50aXR5LmdldEJ5bGF3VWludDI1NigiY2FzaGJhY2tfb3duZXJfbWlhX2R1ciIpIDsKICAgICAgICBCeWxhd3NDYXNoQmFja1ZvdGVSZWplY3RlZER1cmF0aW9uICA9IEFwcGxpY2F0aW9uRW50aXR5LmdldEJ5bGF3VWludDI1NigiY2FzaGJhY2tfaW52ZXN0b3Jfbm8iKSA7CiAgICAgICAgQnlsYXdzUHJvcG9zYWxWb3RpbmdEdXJhdGlvbiAgICAgICAgPSBBcHBsaWNhdGlvbkVudGl0eS5nZXRCeWxhd1VpbnQyNTYoInByb3Bvc2FsX3ZvdGluZ19kdXJhdGlvbiIpIDsKCiAgICAgICAgLy8gaW5pdAogICAgICAgIF9pbml0aWFsaXplZCA9IHRydWU7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgoKCiAgICAvKgogICAgICAgIFRoZSBmdW5kaW5nIGNvbnRyYWN0IGRlY2lkZXMgaWYgYSB2YXVsdCBzaG91bGQgcmVjZWl2ZSBwYXltZW50cyBvciBub3QsIHNpbmNlIGl0J3MgdGhlIG9uZSB0aGF0IGNyZWF0ZXMgdGhlbSwKICAgICAgICBubyBwb2ludCBpbiBjcmVhdGluZyBvbmUgaWYgeW91IGNhbid0IGFjY2VwdCBwYXltZW50cy4KICAgICovCgogICAgbWFwcGluZyAodWludDggPT4gdWludDI1NikgcHVibGljIHN0YWdlQW1vdW50czsKICAgIG1hcHBpbmcgKHVpbnQ4ID0+IHVpbnQyNTYpIHB1YmxpYyBzdGFnZUFtb3VudHNEaXJlY3Q7CgogICAgZnVuY3Rpb24gYWRkUGF5bWVudCgKICAgICAgICB1aW50OCBfcGF5bWVudF9tZXRob2QsCiAgICAgICAgdWludDggX2Z1bmRpbmdfc3RhZ2UKICAgICkKICAgICAgICBwdWJsaWMKICAgICAgICBwYXlhYmxlCiAgICAgICAgcmVxdWlyZUluaXRpYWxpc2VkCiAgICAgICAgb25seU1hbmFnZXIKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIGlmKG1zZy52YWx1ZSA+IDAgJiYgRnVuZGluZ0VudGl0eS5hbGxvd2VkUGF5bWVudE1ldGhvZChfcGF5bWVudF9tZXRob2QpKSB7CgogICAgICAgICAgICAvLyBzdG9yZSBwYXltZW50CiAgICAgICAgICAgIFB1cmNoYXNlU3RydWN0IHN0b3JhZ2UgcHVyY2hhc2UgPSBwdXJjaGFzZVJlY29yZHNbKytwdXJjaGFzZVJlY29yZHNOdW1dOwogICAgICAgICAgICAgICAgcHVyY2hhc2UudW5peF90aW1lID0gbm93OwogICAgICAgICAgICAgICAgcHVyY2hhc2UucGF5bWVudF9tZXRob2QgPSBfcGF5bWVudF9tZXRob2Q7CiAgICAgICAgICAgICAgICBwdXJjaGFzZS5hbW91bnQgPSBtc2cudmFsdWU7CiAgICAgICAgICAgICAgICBwdXJjaGFzZS5mdW5kaW5nX3N0YWdlID0gX2Z1bmRpbmdfc3RhZ2U7CiAgICAgICAgICAgICAgICBwdXJjaGFzZS5pbmRleCA9IHB1cmNoYXNlUmVjb3Jkc051bTsKCiAgICAgICAgICAgIC8vIGFzc2lnbiBwYXltZW50IHRvIGRpcmVjdCBvciBtaWxlc3RvbmUKICAgICAgICAgICAgaWYoX3BheW1lbnRfbWV0aG9kID09IDEpIHsKICAgICAgICAgICAgICAgIGFtb3VudF9kaXJlY3QrPSBwdXJjaGFzZS5hbW91bnQ7CiAgICAgICAgICAgICAgICBzdGFnZUFtb3VudHNEaXJlY3RbX2Z1bmRpbmdfc3RhZ2VdKz1wdXJjaGFzZS5hbW91bnQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKF9wYXltZW50X21ldGhvZCA9PSAyKSB7CiAgICAgICAgICAgICAgICBhbW91bnRfbWlsZXN0b25lKz0gcHVyY2hhc2UuYW1vdW50OwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBpbiBvcmRlciB0byBub3QgaXRlcmF0ZSB0aHJvdWdoIHB1cmNoYXNlIHJlY29yZHMsIHdlIGp1c3QgaW5jcmVhc2UgZnVuZGluZyBzdGFnZSBhbW91bnQuCiAgICAgICAgICAgIC8vIGlzc3VlIHdpdGggaXRlcmF0aW5nIG92ZXIgdGhlbSwgd2hpbGUgcHJvY2Vzc2luZyB2YXVsdHMsIHdvdWxkIGJlIHRoYXQgc29tZW9uZSBjb3VsZCBjcmVhdGUgYSBsYXJnZQogICAgICAgICAgICAvLyBudW1iZXIgb2YgcGF5bWVudHMsIHdoaWNoIHdvdWxkIHJlc3VsdCBpbiBhbiAib3V0IG9mIGdhcyIgLyBzdGFjayBvdmVyZmxvdyBpc3N1ZSwgdGhhdCB3b3VsZCBsb2NrCiAgICAgICAgICAgIC8vIG91ciBjb250cmFjdCwgc28gd2UgZG9uJ3QgcmVhbGx5IHdhbnQgdG8gZG8gdGhhdC4KICAgICAgICAgICAgLy8gZG9pbmcgaXQgdGhpcyB3YXkgYWxzbyBzYXZlcyBzb21lIGdhcwogICAgICAgICAgICBzdGFnZUFtb3VudHNbX2Z1bmRpbmdfc3RhZ2VdKz1wdXJjaGFzZS5hbW91bnQ7CgogICAgICAgICAgICBFdmVudFBheW1lbnRSZWNlaXZlZCggcHVyY2hhc2UucGF5bWVudF9tZXRob2QsIHB1cmNoYXNlLmFtb3VudCwgcHVyY2hhc2UuaW5kZXggKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGdldEJvdWdodFRva2VucygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gVG9rZW5TQ0FEQUVudGl0eS5nZXRCb3VnaHRUb2tlbnMoIGFkZHJlc3ModGhpcyksIGZhbHNlICk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RGlyZWN0Qm91Z2h0VG9rZW5zKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBUb2tlblNDQURBRW50aXR5LmdldEJvdWdodFRva2VucyggYWRkcmVzcyh0aGlzKSwgdHJ1ZSApOwogICAgfQoKCiAgICBtYXBwaW5nICh1aW50OCA9PiB1aW50MjU2KSBwdWJsaWMgZXRoZXJCYWxhbmNlczsKICAgIG1hcHBpbmcgKHVpbnQ4ID0+IHVpbnQyNTYpIHB1YmxpYyB0b2tlbkJhbGFuY2VzOwogICAgdWludDggcHVibGljIEJhbGFuY2VOdW0gPSAwOwoKICAgIGJvb2wgcHVibGljIEJhbGFuY2VzSW5pdGlhbGlzZWQgPSBmYWxzZTsKICAgIGZ1bmN0aW9uIGluaXRNaWxlc3RvbmVUb2tlbkFuZEV0aGVyQmFsYW5jZXMoKSBpbnRlcm5hbAogICAgewogICAgICAgIGlmKEJhbGFuY2VzSW5pdGlhbGlzZWQgPT0gZmFsc2UpIHsKCiAgICAgICAgICAgIHVpbnQyNTYgbWlsZXN0b25lVG9rZW5CYWxhbmNlID0gVG9rZW5FbnRpdHkuYmFsYW5jZU9mKGFkZHJlc3ModGhpcykpOwogICAgICAgICAgICB1aW50MjU2IG1pbGVzdG9uZUV0aGVyQmFsYW5jZSA9IHRoaXMuYmFsYW5jZTsKCiAgICAgICAgICAgIC8vIG5vIG5lZWQgdG8gd29ycnkgYWJvdXQgZnJhY3Rpb25zIGJlY2F1c2UgYXQgdGhlIGxhc3QgbWlsZXN0b25lLCB3ZSBzZW5kIGV2ZXJ5dGhpbmcgdGhhdCdzIGxlZnQuCgogICAgICAgICAgICAvLyBlbWVyZ2VuY3kgZnVuZCB0YWtlcyBpdCdzIHBlcmNlbnRhZ2UgZnJvbSBpbml0aWFsIGJhbGFuY2VzLgogICAgICAgICAgICBpZihlbWVyZ2VuY3lGdW5kUGVyY2VudGFnZSA+IDApIHsKICAgICAgICAgICAgICAgIHRva2VuQmFsYW5jZXNbMF0gPSBtaWxlc3RvbmVUb2tlbkJhbGFuY2UgLyAxMDAgKiBlbWVyZ2VuY3lGdW5kUGVyY2VudGFnZTsKICAgICAgICAgICAgICAgIGV0aGVyQmFsYW5jZXNbMF0gPSBtaWxlc3RvbmVFdGhlckJhbGFuY2UgLyAxMDAgKiBlbWVyZ2VuY3lGdW5kUGVyY2VudGFnZTsKCiAgICAgICAgICAgICAgICBtaWxlc3RvbmVUb2tlbkJhbGFuY2UtPXRva2VuQmFsYW5jZXNbMF07CiAgICAgICAgICAgICAgICBtaWxlc3RvbmVFdGhlckJhbGFuY2UtPWV0aGVyQmFsYW5jZXNbMF07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIG1pbGVzdG9uZXMgcGVyY2VudGFnZXMgYXJlIHRoZW4gdGFrZW4gZnJvbSB3aGF0J3MgbGVmdC4KICAgICAgICAgICAgZm9yKHVpbnQ4IGkgPSAxOyBpIDw9IE1pbGVzdG9uZXNFbnRpdHkuUmVjb3JkTnVtKCk7IGkrKykgewoKICAgICAgICAgICAgICAgIHVpbnQ4IHBlcmMgPSBNaWxlc3RvbmVzRW50aXR5LmdldE1pbGVzdG9uZUZ1bmRpbmdQZXJjZW50YWdlKGkpOwogICAgICAgICAgICAgICAgdG9rZW5CYWxhbmNlc1tpXSA9IG1pbGVzdG9uZVRva2VuQmFsYW5jZSAvIDEwMCAqIHBlcmM7CiAgICAgICAgICAgICAgICBldGhlckJhbGFuY2VzW2ldID0gbWlsZXN0b25lRXRoZXJCYWxhbmNlIC8gMTAwICogcGVyYzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgQmFsYW5jZU51bSA9IGk7CiAgICAgICAgICAgIEJhbGFuY2VzSW5pdGlhbGlzZWQgPSB0cnVlOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBSZWxlYXNlRnVuZHNBbmRUb2tlbnMoKQogICAgICAgIHB1YmxpYwogICAgICAgIHJlcXVpcmVJbml0aWFsaXNlZAogICAgICAgIG9ubHlNYW5hZ2VyCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICAvLyBmaXJzdCBtYWtlIHN1cmUgY2FzaGJhY2sgaXMgbm90IHBvc3NpYmxlLCBhbmQgdGhhdCB3ZSd2ZSBub3QgcHJvY2Vzc2VkIGV2ZXJ5dGhpbmcgaW4gdGhpcyB2YXVsdAogICAgICAgIGlmKCFjYW5DYXNoQmFjaygpICYmIGFsbEZ1bmRpbmdQcm9jZXNzZWQgPT0gZmFsc2UpIHsKCiAgICAgICAgICAgIGlmKEZ1bmRpbmdNYW5hZ2VyRW50aXR5LkN1cnJlbnRFbnRpdHlTdGF0ZSgpID09IEZ1bmRpbmdNYW5hZ2VyRW50aXR5LmdldEVudGl0eVN0YXRlKCJGVU5ESU5HX1NVQ0NFU1NGVUxfUFJPR1JFU1MiKSkgewoKICAgICAgICAgICAgICAgIC8vIGNhc2UgMSwgZGlyZWN0IGZ1bmRpbmcgb25seQogICAgICAgICAgICAgICAgaWYoYW1vdW50X2RpcmVjdCA+IDAgJiYgYW1vdW50X21pbGVzdG9uZSA9PSAwKSB7CgogICAgICAgICAgICAgICAgICAgIC8vIGlmIHdlIGhhdmUgZGlyZWN0IGZ1bmRpbmcgYW5kIG5vIG1pbGVzdG9uZSBiYWxhbmNlLCB0cmFuc2ZlciBldmVyeXRoaW5nIGFuZCBsb2NrIHZhdWx0CiAgICAgICAgICAgICAgICAgICAgLy8gdG8gc2F2ZSBnYXMgaW4gZnV0dXJlIHByb2Nlc3NpbmcgcnVucy4KCiAgICAgICAgICAgICAgICAgICAgLy8gdHJhbnNmZXIgdG9rZW5zIHRvIHRoZSBpbnZlc3RvcgogICAgICAgICAgICAgICAgICAgIFRva2VuRW50aXR5LnRyYW5zZmVyKHZhdWx0T3duZXIsIFRva2VuRW50aXR5LmJhbGFuY2VPZiggYWRkcmVzcyh0aGlzKSApICk7CgogICAgICAgICAgICAgICAgICAgIC8vIHRyYW5zZmVyIGV0aGVyIHRvIHRoZSBvd25lcidzIHdhbGxldAogICAgICAgICAgICAgICAgICAgIG91dHB1dEFkZHJlc3MudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKCiAgICAgICAgICAgICAgICAgICAgLy8gbG9jayB2YXVsdC4uIGFuZCBlbmFibGUgYmxhY2sgaG9sZSBtZXRob2RzCiAgICAgICAgICAgICAgICAgICAgYWxsRnVuZGluZ1Byb2Nlc3NlZCA9IHRydWU7CgogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIGNhc2UgMiBhbmQgMywgZGlyZWN0IGZ1bmRpbmcgb25seQoKICAgICAgICAgICAgICAgICAgICBpZihhbW91bnRfZGlyZWN0ID4gMCAmJiBEaXJlY3RGdW5kaW5nUHJvY2Vzc2VkID09IGZhbHNlICkgewogICAgICAgICAgICAgICAgICAgICAgICBUb2tlbkVudGl0eS50cmFuc2Zlcih2YXVsdE93bmVyLCBnZXREaXJlY3RCb3VnaHRUb2tlbnMoKSApOwogICAgICAgICAgICAgICAgICAgICAgICAvLyB0cmFuc2ZlciAiZGlyZWN0IGZ1bmRpbmciIGV0aGVyIHRvIHRoZSBvd25lcidzIHdhbGxldAogICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRBZGRyZXNzLnRyYW5zZmVyKGFtb3VudF9kaXJlY3QpOwogICAgICAgICAgICAgICAgICAgICAgICBEaXJlY3RGdW5kaW5nUHJvY2Vzc2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIC8vIHByb2Nlc3MgYW5kIGluaXRpYWxpemUgbWlsZXN0b25lIGJhbGFuY2VzLCBlbWVyZ2VuY3kgZnVuZCwgZXRjLCBvbmNlCiAgICAgICAgICAgICAgICAgICAgaW5pdE1pbGVzdG9uZVRva2VuQW5kRXRoZXJCYWxhbmNlcygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICAgICAgICB9IGVsc2UgaWYoRnVuZGluZ01hbmFnZXJFbnRpdHkuQ3VycmVudEVudGl0eVN0YXRlKCkgPT0gRnVuZGluZ01hbmFnZXJFbnRpdHkuZ2V0RW50aXR5U3RhdGUoIk1JTEVTVE9ORV9QUk9DRVNTX1BST0dSRVNTIikpIHsKCiAgICAgICAgICAgICAgICAvLyBnZXQgY3VycmVudCBtaWxlc3RvbmUgc28gd2Uga25vdyB3aGljaCBvbmUgd2UgbmVlZCB0byByZWxlYXNlIGZ1bmRzIGZvci4KICAgICAgICAgICAgICAgIHVpbnQ4IG1pbGVzdG9uZUlkID0gTWlsZXN0b25lc0VudGl0eS5jdXJyZW50UmVjb3JkKCk7CgogICAgICAgICAgICAgICAgdWludDI1NiB0cmFuc2ZlclRva2VucyA9IHRva2VuQmFsYW5jZXNbbWlsZXN0b25lSWRdOwogICAgICAgICAgICAgICAgdWludDI1NiB0cmFuc2ZlckV0aGVyID0gZXRoZXJCYWxhbmNlc1ttaWxlc3RvbmVJZF07CgogICAgICAgICAgICAgICAgaWYobWlsZXN0b25lSWQgPT0gQmFsYW5jZU51bSAtIDEpIHsKICAgICAgICAgICAgICAgICAgICAvLyB3ZSdyZSBwcm9jZXNzaW5nIHRoZSBsYXN0IG1pbGVzdG9uZSBhbmQgYmFsYW5jZSwgdGhpcyBtZWFucyB3ZSdyZSB0cmFuc2ZlcnJpbmcgZXZlcnl0aGluZyBsZWZ0LgogICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgaXMgZG9uZSB0byBtYWtlIHN1cmUgd2UndmUgdHJhbnNmZXJyZWQgZXZlcnl0aGluZywgZXZlbiAiZXRoZXIgdGhhdCBnb3QgbWlzdGFrZW5seSBzZW50IHRvIHRoaXMgYWRkcmVzcyIKICAgICAgICAgICAgICAgICAgICAvLyBhcyB3ZWxsIGFzIHRoZSBlbWVyZ2VuY3kgZnVuZCBpZiBpdCBoYXMgbm90IGJlZW4gdXNlZC4KICAgICAgICAgICAgICAgICAgICB0cmFuc2ZlclRva2VucyA9IFRva2VuRW50aXR5LmJhbGFuY2VPZihhZGRyZXNzKHRoaXMpKTsKICAgICAgICAgICAgICAgICAgICB0cmFuc2ZlckV0aGVyID0gdGhpcy5iYWxhbmNlOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIHNldCBiYWxhbmNlcyB0byAwIHNvIHdlIGNhbid0IHRyYW5zZmVyIG11bHRpcGxlIHRpbWVzLgogICAgICAgICAgICAgICAgLy8gdG9rZW5CYWxhbmNlc1ttaWxlc3RvbmVJZF0gPSAwOwogICAgICAgICAgICAgICAgLy8gZXRoZXJCYWxhbmNlc1ttaWxlc3RvbmVJZF0gPSAwOwoKICAgICAgICAgICAgICAgIC8vIHRyYW5zZmVyIHRva2VucyB0byB0aGUgaW52ZXN0b3IKICAgICAgICAgICAgICAgIFRva2VuRW50aXR5LnRyYW5zZmVyKHZhdWx0T3duZXIsIHRyYW5zZmVyVG9rZW5zICk7CgogICAgICAgICAgICAgICAgLy8gdHJhbnNmZXIgZXRoZXIgdG8gdGhlIG93bmVyJ3Mgd2FsbGV0CiAgICAgICAgICAgICAgICBvdXRwdXRBZGRyZXNzLnRyYW5zZmVyKHRyYW5zZmVyRXRoZXIpOwoKICAgICAgICAgICAgICAgIGlmKG1pbGVzdG9uZUlkID09IEJhbGFuY2VOdW0gLSAxKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gbG9jayB2YXVsdC4uIGFuZCBlbmFibGUgYmxhY2sgaG9sZSBtZXRob2RzCiAgICAgICAgICAgICAgICAgICAgYWxsRnVuZGluZ1Byb2Nlc3NlZCA9IHRydWU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCgogICAgZnVuY3Rpb24gcmVsZWFzZVRva2Vuc0FuZEV0aGVyRm9yRW1lcmdlbmN5RnVuZCgpCiAgICAgICAgcHVibGljCiAgICAgICAgcmVxdWlyZUluaXRpYWxpc2VkCiAgICAgICAgb25seU1hbmFnZXIKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIGlmKCBlbWVyZ2VuY3lGdW5kUmVsZWFzZWQgPT0gZmFsc2UgJiYgZW1lcmdlbmN5RnVuZFBlcmNlbnRhZ2UgPiAwKSB7CgogICAgICAgICAgICAvLyB0cmFuc2ZlciB0b2tlbnMgdG8gdGhlIGludmVzdG9yCiAgICAgICAgICAgIFRva2VuRW50aXR5LnRyYW5zZmVyKHZhdWx0T3duZXIsIHRva2VuQmFsYW5jZXNbMF0gKTsKCiAgICAgICAgICAgIC8vIHRyYW5zZmVyIGV0aGVyIHRvIHRoZSBvd25lcidzIHdhbGxldAogICAgICAgICAgICBvdXRwdXRBZGRyZXNzLnRyYW5zZmVyKGV0aGVyQmFsYW5jZXNbMF0pOwoKICAgICAgICAgICAgZW1lcmdlbmN5RnVuZFJlbGVhc2VkID0gdHJ1ZTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBmdW5jdGlvbiBSZWxlYXNlRnVuZHNUb0ludmVzdG9yKCkKICAgICAgICBwdWJsaWMKICAgICAgICByZXF1aXJlSW5pdGlhbGlzZWQKICAgICAgICBpc093bmVyCiAgICB7CiAgICAgICAgaWYoY2FuQ2FzaEJhY2soKSkgewoKICAgICAgICAgICAgLy8gSUYgd2UncmUgZG9pbmcgYSBjYXNoYmFjawogICAgICAgICAgICAvLyB0cmFuc2ZlciB2YXVsdCB0b2tlbnMgYmFjayB0byBvd25lciBhZGRyZXNzCiAgICAgICAgICAgIC8vIHNlbmQgYWxsIGV0aGVyIHRvIHdhbGxldCBvd25lcgoKICAgICAgICAgICAgLy8gZ2V0IHRva2VuIGJhbGFuY2UKICAgICAgICAgICAgdWludDI1NiBteUJhbGFuY2UgPSBUb2tlbkVudGl0eS5iYWxhbmNlT2YoYWRkcmVzcyh0aGlzKSk7CiAgICAgICAgICAgIC8vIHRyYW5zZmVyIGFsbCB2YXVsdCB0b2tlbnMgdG8gb3duZXIKICAgICAgICAgICAgaWYobXlCYWxhbmNlID4gMCkgewogICAgICAgICAgICAgICAgVG9rZW5FbnRpdHkudHJhbnNmZXIob3V0cHV0QWRkcmVzcywgbXlCYWxhbmNlICk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIG5vdyB0cmFuc2ZlciBhbGwgcmVtYWluaW5nIGV0aGVyIGJhY2sgdG8gaW52ZXN0b3IgYWRkcmVzcwogICAgICAgICAgICB2YXVsdE93bmVyLnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CgogICAgICAgICAgICAvLyB1cGRhdGUgRnVuZGluZ01hbmFnZXIgTG9ja2VkIFRva2VuIEFtb3VudCwgc28gd2UgZG9uJ3QgYnJlYWsgdm90aW5nCiAgICAgICAgICAgIEZ1bmRpbmdNYW5hZ2VyRW50aXR5LlZhdWx0UmVxdWVzdGVkVXBkYXRlRm9yTG9ja2VkVm90aW5nVG9rZW5zKCB2YXVsdE93bmVyICk7CgogICAgICAgICAgICAvLyBkaXNhbGxvdyBmdXJ0aGVyIHByb2Nlc3NpbmcsIHNvIHdlIGRvbid0IGJyZWFrIEZ1bmRpbmcgTWFuYWdlci4KICAgICAgICAgICAgLy8gdGhpcyBtZXRob2QgY2FuIHN0aWxsIGJlIGNhbGxlZCB0byBjb2xsZWN0IGZ1dHVyZSBibGFjayBob2xlIGV0aGVyIHRvIHRoaXMgdmF1bHQuCiAgICAgICAgICAgIGFsbEZ1bmRpbmdQcm9jZXNzZWQgPSB0cnVlOwogICAgICAgIH0KICAgIH0KCiAgICAvKgogICAgICAgIDEgLSBpZiB0aGUgZnVuZGluZyBvZiB0aGUgcHJvamVjdCBGYWlsZWQsIGFsbG93cyBpbnZlc3RvcnMgdG8gY2xhaW0gdGhlaXIgbG9ja2VkIGV0aGVyIGJhY2suCiAgICAgICAgMiAtIGlmIHRoZSBJbnZlc3RvciB2b3RlcyBOTyB0byBhIERldmVsb3BtZW50IE1pbGVzdG9uZSBDb21wbGV0aW9uIFByb3Bvc2FsLCB3aGVyZSB0aGUgbWFqb3JpdHkKICAgICAgICAgICAgYWxzbyB2b3RlcyBOTyBhbGxvd3MgaW52ZXN0b3JzIHRvIGNsYWltIHRoZWlyIGxvY2tlZCBldGhlciBiYWNrLgogICAgICAgIDMgLSBwcm9qZWN0IG93bmVyIG1pc3NlcyB0byBzZXQgdGhlIHRpbWUgZm9yIGEgRGV2ZWxvcG1lbnQgTWlsZXN0b25lIENvbXBsZXRpb24gTWVldGluZyBhbGxvd3MgaW52ZXN0b3JzCiAgICAgICAgdG8gY2xhaW0gdGhlaXIgbG9ja2VkIGV0aGVyIGJhY2suCiAgICAqLwogICAgZnVuY3Rpb24gY2FuQ2FzaEJhY2soKSBwdWJsaWMgdmlldyByZXF1aXJlSW5pdGlhbGlzZWQgcmV0dXJucyAoYm9vbCkgewoKICAgICAgICAvLyBjYXNlIDEKICAgICAgICBpZihjaGVja0Z1bmRpbmdTdGF0ZUZhaWxlZCgpKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICAvLyBjYXNlIDIKICAgICAgICBpZihjaGVja01pbGVzdG9uZVN0YXRlSW52ZXN0b3JWb3RlZE5vVm90aW5nRW5kZWRObygpKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICAvLyBjYXNlIDMKICAgICAgICBpZihjaGVja093bmVyRmFpbGVkVG9TZXRUaW1lT25NZWV0aW5nKCkpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgZnVuY3Rpb24gY2hlY2tGdW5kaW5nU3RhdGVGYWlsZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYoRnVuZGluZ0VudGl0eS5DdXJyZW50RW50aXR5U3RhdGUoKSA9PSBGdW5kaW5nRW50aXR5LmdldEVudGl0eVN0YXRlKCJGQUlMRURfRklOQUwiKSApIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICAvLyBhbHNvIGNoZWNrIGlmIGZ1bmRpbmcgcGVyaW9kIGVuZGVkLCBhbmQgNyBkYXlzIGhhdmUgcGFzc2VkIGFuZCBubyBwcm9jZXNzaW5nIHdhcyBkb25lLgogICAgICAgIGlmKCBGdW5kaW5nRW50aXR5LmdldFRpbWVzdGFtcCgpID49IEZ1bmRpbmdFbnRpdHkuRnVuZGluZ19TZXR0aW5nX2Nhc2hiYWNrX3RpbWVfc3RhcnQoKSApIHsKCiAgICAgICAgICAgIC8vIHNob3VsZCBvbmx5IGJlIHBvc3NpYmxlIGlmIGZ1bmRpbmcgZW50aXR5IGhhcyBiZWVuIHN0dWNrIGluIHByb2Nlc3NpbmcgZm9yIG1vcmUgdGhhbiA3IGRheXMuCiAgICAgICAgICAgIGlmKCBGdW5kaW5nRW50aXR5LkN1cnJlbnRFbnRpdHlTdGF0ZSgpICE9IEZ1bmRpbmdFbnRpdHkuZ2V0RW50aXR5U3RhdGUoIlNVQ0NFU1NGVUxfRklOQUwiKSApIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgZnVuY3Rpb24gY2hlY2tNaWxlc3RvbmVTdGF0ZUludmVzdG9yVm90ZWROb1ZvdGluZ0VuZGVkTm8oKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYoTWlsZXN0b25lc0VudGl0eS5DdXJyZW50RW50aXR5U3RhdGUoKSA9PSBNaWxlc3RvbmVzRW50aXR5LmdldEVudGl0eVN0YXRlKCJWT1RJTkdfRU5ERURfTk8iKSApIHsKICAgICAgICAgICAgLy8gZmlyc3Qgd2UgbmVlZCB0byBtYWtlIHN1cmUgd2UgYWN0dWFsbHkgdm90ZWQuCiAgICAgICAgICAgIGlmKCBQcm9wb3NhbHNFbnRpdHkuZ2V0SGFzVm90ZUZvckN1cnJlbnRNaWxlc3RvbmVSZWxlYXNlKHZhdWx0T3duZXIpID09IHRydWUpIHsKICAgICAgICAgICAgICAgIC8vIG5vdyBtYWtlIHN1cmUgd2Ugdm90ZWQgTk8sIGFuZCBpZiBzbyByZXR1cm4gdHJ1ZQogICAgICAgICAgICAgICAgaWYoIFByb3Bvc2Fsc0VudGl0eS5nZXRNeVZvdGVGb3JDdXJyZW50TWlsZXN0b25lUmVsZWFzZSggdmF1bHRPd25lciApID09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoZWNrT3duZXJGYWlsZWRUb1NldFRpbWVPbk1lZXRpbmcoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgLy8gTG9va3MgbGlrZSB0aGUgcHJvamVjdCBvd25lciBpcyBtaXNzaW5nIGluIGFjdGlvbgogICAgICAgIC8vIHRoZXkgb25seSBoYXZlIHRvIGRvIDEgdGhpbmcsIHdoaWNoIGlzIHNldCB0aGUgbWVldGluZyB0aW1lIDcgZGF5cyBiZWZvcmUgdGhlIGVuZCBvZiB0aGUgbWlsZXN0b25lIHNvIHRoYXQKICAgICAgICAvLyBpbnZlc3RvcnMga25vdyB3aGVuIHRoZXkgbmVlZCB0byBzaG93IHVwIGZvciBhIHByb2dyZXNzIHJlcG9ydCBtZWV0aW5nCgogICAgICAgIC8vIGFzIHRoZXkgZGlkIG5vdCwgd2UgY29uc2lkZXIgdGhlbSBtaXNzaW5nIGluIGFjdGlvbiBhbmQgYWxsb3cgaW52ZXN0b3JzIHRvIHJldHJpZXZlIHRoZWlyIGxvY2tlZCBldGhlciBiYWNrCiAgICAgICAgaWYoIE1pbGVzdG9uZXNFbnRpdHkuQ3VycmVudEVudGl0eVN0YXRlKCkgPT0gTWlsZXN0b25lc0VudGl0eS5nZXRFbnRpdHlTdGF0ZSgiREVBRExJTkVfTUVFVElOR19USU1FX0ZBSUxFRCIpICkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKCiAgICBtb2RpZmllciBpc093bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSB2YXVsdE93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlNYW5hZ2VyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBtYW5hZ2VyQWRkcmVzcyk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciByZXF1aXJlSW5pdGlhbGlzZWQoKSB7CiAgICAgICAgcmVxdWlyZShfaW5pdGlhbGl6ZWQgPT0gdHJ1ZSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciByZXF1aXJlTm90SW5pdGlhbGlzZWQoKSB7CiAgICAgICAgcmVxdWlyZShfaW5pdGlhbGl6ZWQgPT0gZmFsc2UpOwogICAgICAgIF87CiAgICB9Cn0='.
	

]
