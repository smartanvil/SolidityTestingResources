Class {
	#name : #SRTdd94De9cFE063577051A5eb7465D08317d8808B6,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTdd94De9cFE063577051A5eb7465D08317d8808B6 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMDsKCgpsaWJyYXJ5IEVDVmVyaWZ5TGliIHsKICAgIC8vIEZyb206IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL2F4aWMvNWIzMzkxMmM2ZjYxYWU2ZmQ5NmQ2YzRhNDdhZmRlNmQKICAgIC8vIER1cGxpY2F0ZSBTb2xpZGl0eSdzIGVjcmVjb3ZlciwgYnV0IGNhdGNoaW5nIHRoZSBDQUxMIHJldHVybiB2YWx1ZQogICAgZnVuY3Rpb24gc2FmZXJfZWNyZWNvdmVyKGJ5dGVzMzIgaGFzaCwgdWludDggdiwgYnl0ZXMzMiByLCBieXRlczMyIHMpIGludGVybmFsIHJldHVybnMgKGJvb2wsIGFkZHJlc3MpIHsKICAgICAgICAvLyBXZSBkbyBvdXIgb3duIG1lbW9yeSBtYW5hZ2VtZW50IGhlcmUuIFNvbGlkaXR5IHVzZXMgbWVtb3J5IG9mZnNldAogICAgICAgIC8vIDB4NDAgdG8gc3RvcmUgdGhlIGN1cnJlbnQgZW5kIG9mIG1lbW9yeS4gV2Ugd3JpdGUgcGFzdCBpdCAoYXMKICAgICAgICAvLyB3cml0ZXMgYXJlIG1lbW9yeSBleHRlbnNpb25zKSwgYnV0IGRvbid0IHVwZGF0ZSB0aGUgb2Zmc2V0IHNvCiAgICAgICAgLy8gU29saWRpdHkgd2lsbCByZXVzZSBpdC4gVGhlIG1lbW9yeSB1c2VkIGhlcmUgaXMgb25seSBuZWVkZWQgZm9yCiAgICAgICAgLy8gdGhpcyBjb250ZXh0LgoKICAgICAgICAvLyBGSVhNRTogaW5saW5lIGFzc2VtYmx5IGNhbid0IGFjY2VzcyByZXR1cm4gdmFsdWVzCiAgICAgICAgYm9vbCByZXQ7CiAgICAgICAgYWRkcmVzcyBhZGRyOwoKICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgIGxldCBzaXplIDo9IG1sb2FkKDB4NDApCiAgICAgICAgICAgIG1zdG9yZShzaXplLCBoYXNoKQogICAgICAgICAgICBtc3RvcmUoYWRkKHNpemUsIDMyKSwgdikKICAgICAgICAgICAgbXN0b3JlKGFkZChzaXplLCA2NCksIHIpCiAgICAgICAgICAgIG1zdG9yZShhZGQoc2l6ZSwgOTYpLCBzKQoKICAgICAgICAgICAgLy8gTk9URTogd2UgY2FuIHJldXNlIHRoZSByZXF1ZXN0IG1lbW9yeSBiZWNhdXNlIHdlIGRlYWwgd2l0aAogICAgICAgICAgICAvLyAgICAgICB0aGUgcmV0dXJuIGNvZGUKICAgICAgICAgICAgcmV0IDo9IGNhbGwoMzAwMCwgMSwgMCwgc2l6ZSwgMTI4LCBzaXplLCAzMikKICAgICAgICAgICAgYWRkciA6PSBtbG9hZChzaXplKQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIChyZXQsIGFkZHIpOwogICAgfQoKICAgIGZ1bmN0aW9uIGVjcmVjb3ZlcnkoYnl0ZXMzMiBoYXNoLCBieXRlcyBzaWcpIHJldHVybnMgKGJvb2wsIGFkZHJlc3MpIHsKICAgICAgICBieXRlczMyIHI7CiAgICAgICAgYnl0ZXMzMiBzOwogICAgICAgIHVpbnQ4IHY7CgogICAgICAgIGlmIChzaWcubGVuZ3RoICE9IDY1KQogICAgICAgICAgcmV0dXJuIChmYWxzZSwgMCk7CgogICAgICAgIC8vIFRoZSBzaWduYXR1cmUgZm9ybWF0IGlzIGEgY29tcGFjdCBmb3JtIG9mOgogICAgICAgIC8vICAge2J5dGVzMzIgcn17Ynl0ZXMzMiBzfXt1aW50OCB2fQogICAgICAgIC8vIENvbXBhY3QgbWVhbnMsIHVpbnQ4IGlzIG5vdCBwYWRkZWQgdG8gMzIgYnl0ZXMuCiAgICAgICAgYXNzZW1ibHkgewogICAgICAgICAgICByIDo9IG1sb2FkKGFkZChzaWcsIDMyKSkKICAgICAgICAgICAgcyA6PSBtbG9hZChhZGQoc2lnLCA2NCkpCgogICAgICAgICAgICAvLyBIZXJlIHdlIGFyZSBsb2FkaW5nIHRoZSBsYXN0IDMyIGJ5dGVzLiBXZSBleHBsb2l0IHRoZSBmYWN0IHRoYXQKICAgICAgICAgICAgLy8gJ21sb2FkJyB3aWxsIHBhZCB3aXRoIHplcm9lcyBpZiB3ZSBvdmVycmVhZC4KICAgICAgICAgICAgLy8gVGhlcmUgaXMgbm8gJ21sb2FkOCcgdG8gZG8gdGhpcywgYnV0IHRoYXQgd291bGQgYmUgbmljZXIuCiAgICAgICAgICAgIHYgOj0gYnl0ZSgwLCBtbG9hZChhZGQoc2lnLCA5NikpKQoKICAgICAgICAgICAgLy8gQWx0ZXJuYXRpdmUgc29sdXRpb246CiAgICAgICAgICAgIC8vICdieXRlJyBpcyBub3Qgd29ya2luZyBkdWUgdG8gdGhlIFNvbGlkaXR5IHBhcnNlciwgc28gbGV0cwogICAgICAgICAgICAvLyB1c2UgdGhlIHNlY29uZCBiZXN0IG9wdGlvbiwgJ2FuZCcKICAgICAgICAgICAgLy8gdiA6PSBhbmQobWxvYWQoYWRkKHNpZywgNjUpKSwgMjU1KQogICAgICAgIH0KCiAgICAgICAgLy8gYWxiZWl0IG5vbi10cmFuc2FjdGlvbmFsIHNpZ25hdHVyZXMgYXJlIG5vdCBzcGVjaWZpZWQgYnkgdGhlIFlQLCBvbmUgd291bGQgZXhwZWN0IGl0CiAgICAgICAgLy8gdG8gbWF0Y2ggdGhlIFlQIHJhbmdlIG9mIFsyNywgMjhdCiAgICAgICAgLy8KICAgICAgICAvLyBnZXRoIHVzZXMgWzAsIDFdIGFuZCBzb21lIGNsaWVudHMgaGF2ZSBmb2xsb3dlZC4gVGhpcyBtaWdodCBjaGFuZ2UsIHNlZToKICAgICAgICAvLyAgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL2dvLWV0aGVyZXVtL2lzc3Vlcy8yMDUzCiAgICAgICAgaWYgKHYgPCAyNykKICAgICAgICAgIHYgKz0gMjc7CgogICAgICAgIGlmICh2ICE9IDI3ICYmIHYgIT0gMjgpCiAgICAgICAgICAgIHJldHVybiAoZmFsc2UsIDApOwoKICAgICAgICByZXR1cm4gc2FmZXJfZWNyZWNvdmVyKGhhc2gsIHYsIHIsIHMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGVjdmVyaWZ5KGJ5dGVzMzIgaGFzaCwgYnl0ZXMgc2lnLCBhZGRyZXNzIHNpZ25lcikgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGJvb2wgcmV0OwogICAgICAgIGFkZHJlc3MgYWRkcjsKICAgICAgICAocmV0LCBhZGRyKSA9IGVjcmVjb3ZlcnkoaGFzaCwgc2lnKTsKICAgICAgICByZXR1cm4gcmV0ID09IHRydWUgJiYgYWRkciA9PSBzaWduZXI7CiAgICB9Cn0KCgpjb250cmFjdCBJbmRpdmlkdWFsaXR5VG9rZW5JbnRlcmZhY2UgewogICAgLyoKICAgICAqICBFdmVudHMKICAgICAqLwogICAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBieXRlczMyIF90b2tlbklEKTsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7CgogICAgLyoKICAgICAqIFJlYWQgc3RvcmFnZSBmdW5jdGlvbnMKICAgICAqLwoKICAgIC8vLyBAZGV2IFJldHVybiB0aGUgbnVtYmVyIG9mIHRva2VucwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHN1cHBseSk7CgogICAgLy8vIEBkZXYgUmV0dXJucyBpZCBvZiB0b2tlbiBvd25lZCBieSBnaXZlbiBhZGRyZXNzIChlbmNvZGVkIGFzIGFuIGludGVnZXIpLgogICAgLy8vIEBwYXJhbSBfb3duZXIgQWRkcmVzcyBvZiB0b2tlbiBvd25lci4KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKCiAgICAvLy8gQGRldiBSZXR1cm5zIHRoZSB0b2tlbiBpZCB0aGF0IG1heSB0cmFuc2ZlciBmcm9tIF9vd25lciBhY2NvdW50IGJ5IF9zcGVuZGVyLi4KICAgIC8vLyBAcGFyYW0gX293bmVyIEFkZHJlc3Mgb2YgdG9rZW4gb3duZXIuCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIEFkZHJlc3Mgb2YgdG9rZW4gc3BlbmRlci4KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOwoKICAgIC8qCiAgICAgKiAgV3JpdGUgc3RvcmFnZSBmdW5jdGlvbnMKICAgICAqLwoKICAgIC8vLyBAZGV2IFRyYW5zZmVycyBzZW5kZXIgdG9rZW4gdG8gZ2l2ZW4gYWRkcmVzcy4gUmV0dXJucyBzdWNjZXNzLgogICAgLy8vIEBwYXJhbSBfdG8gQWRkcmVzcyBvZiBuZXcgdG9rZW4gb3duZXIuCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBCeXRlczMyIGlkIG9mIHRoZSB0b2tlbiB0byB0cmFuc2Zlci4KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bykgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8vIEBkZXYgQWxsb3dzIGFsbG93ZWQgdGhpcmQgcGFydHkgdG8gdHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlci4gUmV0dXJucyBzdWNjZXNzLgogICAgLy8vIEBwYXJhbSBfZnJvbSBBZGRyZXNzIG9mIHRva2VuIG93bmVyLgogICAgLy8vIEBwYXJhbSBfdG8gQWRkcmVzcyBvZiBuZXcgdG9rZW4gb3duZXIuCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBCeXRlczMyIGlkIG9mIHRoZSB0b2tlbiB0byB0cmFuc2Zlci4KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCiAgICAvLy8gQGRldiBTZXRzIGFwcHJvdmFsIHNwZW5kZXIgdG8gdHJhbnNmZXIgb3duZXJzaGlwIG9mIHRva2VuLiBSZXR1cm5zIHN1Y2Nlc3MuCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIEFkZHJlc3Mgb2Ygc3BlbmRlci4uCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBCeXRlczMyIGlkIG9mIHRva2VuIHRoYXQgY2FuIGJlIHNwZW5kLgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8qCiAgICAgKiAgRXh0cmEgbm9uIEVSQzIwIGZ1bmN0aW9ucwogICAgICovCgogICAgLy8vIEBkZXYgUmV0dXJucyB3aGV0aGVyIHRoZSBhZGRyZXNzIG93bnMgYSB0b2tlbi4KICAgIC8vLyBAcGFyYW0gX293bmVyIEFkZHJlc3MgdG8gY2hlY2suCiAgICBmdW5jdGlvbiBpc1Rva2VuT3duZXIoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKGJvb2wpOwoKICAgIC8vLyBAZGV2IFJldHVybnMgdGhlIGFkZHJlc3Mgb2YgdGhlIG93bmVyIG9mIHRoZSBnaXZlbiB0b2tlbiBpZC4KICAgIC8vLyBAcGFyYW0gX3Rva2VuSUQgQnl0ZXMzMiBpZCBvZiB0b2tlbiB0byBsb29rdXAuCiAgICBmdW5jdGlvbiBvd25lck9mKGJ5dGVzMzIgX3Rva2VuSUQpIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3Mgb3duZXIpOwoKICAgIC8vLyBAZGV2IFJldHVybnMgdGhlIHRva2VuIElEIGZvciB0aGUgZ2l2ZW4gYWRkcmVzcyBvciAweDAgaWYgdGhleSBhcmUgbm90IGEgdG9rZW4gb3duZXIuCiAgICAvLy8gQHBhcmFtIF9vd25lciBBZGRyZXNzIG9mIHRoZSBvd25lciB0byBsb29rdXAuCiAgICBmdW5jdGlvbiB0b2tlbklkKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zIChieXRlczMyIHRva2VuSUQpOwp9CgoKY29udHJhY3QgSW5kaXZpZHVhbGl0eVRva2VuUm9vdEludGVyZmFjZSBpcyBJbmRpdmlkdWFsaXR5VG9rZW5JbnRlcmZhY2UgewogICAgLy8vIEBkZXYgSW1wb3J0cyBhIHRva2VuIGZyb20gdGhlIERldmNvbjJUb2tlbiBjb250cmFjdC4KICAgIGZ1bmN0aW9uIHVwZ3JhZGUoKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCiAgICAvLy8gQGRldiBVcGdyYWRlcyBhIHRva2VuIGZyb20gdGhlIHByZXZpb3VzIGNvbnRyYWN0CiAgICAvLy8gQHBhcmFtIF9vd25lciB0aGUgYWRkcmVzcyBvZiB0aGUgb3duZXIgb2YgdGhlIHRva2VuIG9uIHRoZSBvcmlnaW5hbCBjb250cmFjdAogICAgLy8vIEBwYXJhbSBfbmV3T3duZXIgdGhlIGFkZHJlc3MgdGhhdCBzaG91bGQgb3duIHRoZSB0b2tlbiBvbiB0aGUgbmV3IGNvbnRyYWN0LgogICAgLy8vIEBwYXJhbSBzaWduYXR1cmUgNjUgYnl0ZSBzaWduYXR1cmUgb2YgdGhlIHRpZ2h0bHkgcGFja2VkIGJ5dGVzIChhZGRyZXNzKHRoaXMpICsgX293bmVyICsgX25ld093bmVyKSwgc2lnbmVkIGJ5IF9vd25lcgogICAgZnVuY3Rpb24gcHJveHlVcGdyYWRlKGFkZHJlc3MgX293bmVyLAogICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3MgX25ld093bmVyLAogICAgICAgICAgICAgICAgICAgICAgICAgIGJ5dGVzIHNpZ25hdHVyZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwoKICAgIC8vLyBAZGV2IFJldHVybnMgdGhlIG51bWJlciBvZiB0b2tlbnMgdGhhdCBoYXZlIGJlZW4gdXBncmFkZWQuCiAgICBmdW5jdGlvbiB1cGdyYWRlQ291bnQoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGFtb3VudCk7CgogICAgLy8vIEBkZXYgUmV0dXJucyB0aGUgbnVtYmVyIG9mIHRva2VucyB0aGF0IGhhdmUgYmVlbiB1cGdyYWRlZC4KICAgIC8vLyBAcGFyYW0gX3Rva2VuSUQgdGhlIGlkIG9mIHRoZSB0b2tlbiB0byBxdWVyeQogICAgZnVuY3Rpb24gaXNUb2tlblVwZ3JhZGVkKGJ5dGVzMzIgX3Rva2VuSUQpIGNvbnN0YW50IHJldHVybnMgKGJvb2wgaXNVcGdyYWRlZCk7Cn0KCgpsaWJyYXJ5IFRva2VuRXZlbnRMaWIgewogICAgLyoKICAgICAqIFdoZW4gdW5kZXJseWluZyBzb2xpZGl0eSBpc3N1ZSBpcyBmaXhlZCB0aGlzIGxpYnJhcnkgd2lsbCBub3QgYmUgbmVlZGVkLgogICAgICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL3NvbGlkaXR5L2lzc3Vlcy8xMjE1CiAgICAgKi8KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwKICAgICAgICAgICAgICAgICAgIGFkZHJlc3MgaW5kZXhlZCBfdG8sCiAgICAgICAgICAgICAgICAgICBieXRlczMyIGluZGV4ZWQgX3Rva2VuSUQpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwKICAgICAgICAgICAgICAgICAgIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwKICAgICAgICAgICAgICAgICAgIGJ5dGVzMzIgaW5kZXhlZCBfdG9rZW5JRCk7CgogICAgZnVuY3Rpb24gX1RyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCBieXRlczMyIF90b2tlbklEKSBwdWJsaWMgewogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklEKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfQXBwcm92YWwoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIsIGJ5dGVzMzIgX3Rva2VuSUQpIHB1YmxpYyB7CiAgICAgICAgQXBwcm92YWwoX293bmVyLCBfc3BlbmRlciwgX3Rva2VuSUQpOwogICAgfQp9CgoKY29udHJhY3QgVG9rZW5JbnRlcmZhY2UgewogICAgLyoKICAgICAqICBFdmVudHMKICAgICAqLwogICAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgX3RvLCBieXRlczMyIF9pZCk7CiAgICBldmVudCBEZXN0cm95KGJ5dGVzMzIgX2lkKTsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7CiAgICBldmVudCBNaW50ZXJBZGRlZChhZGRyZXNzIHdobyk7CiAgICBldmVudCBNaW50ZXJSZW1vdmVkKGFkZHJlc3Mgd2hvKTsKCiAgICAvKgogICAgICogIE1pbnRpbmcKICAgICAqLwogICAgLy8vIEBkZXYgTWludHMgYSBuZXcgdG9rZW4uCiAgICAvLy8gQHBhcmFtIF90byBBZGRyZXNzIG9mIHRva2VuIG93bmVyLgogICAgLy8vIEBwYXJhbSBfaWRlbnRpdHkgU3RyaW5nIGZvciBvd25lciBpZGVudGl0eS4KICAgIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfdG8sIHN0cmluZyBfaWRlbnRpdHkpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8vIEBkZXYgRGVzdHJveSBhIHRva2VuCiAgICAvLy8gQHBhcmFtIF9pZCBCeXRlczMyIGlkIG9mIHRoZSB0b2tlbiB0byBkZXN0cm95LgogICAgZnVuY3Rpb24gZGVzdHJveShieXRlczMyIF9pZCkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCiAgICAvLy8gQGRldiBBZGQgYSBuZXcgbWludGVyCiAgICAvLy8gQHBhcmFtIHdobyBBZGRyZXNzIHRoZSBhZGRyZXNzIHRoYXQgY2FuIG5vdyBtaW50IHRva2Vucy4KICAgIGZ1bmN0aW9uIGFkZE1pbnRlcihhZGRyZXNzIHdobykgcmV0dXJucyAoYm9vbCk7CgogICAgLy8vIEBkZXYgUmVtb3ZlIGEgbWludGVyCiAgICAvLy8gQHBhcmFtIHdobyBBZGRyZXNzIHRoZSBhZGRyZXNzIHRoYXQgd2lsbCBubyBsb25nZXIgYmUgYSBtaW50ZXIuCiAgICBmdW5jdGlvbiByZW1vdmVNaW50ZXIoYWRkcmVzcyB3aG8pIHJldHVybnMgKGJvb2wpOwoKICAgIC8qCiAgICAgKiAgUmVhZCBhbmQgd3JpdGUgc3RvcmFnZSBmdW5jdGlvbnMKICAgICAqLwoKICAgIC8vLyBAZGV2IFJldHVybiB0aGUgbnVtYmVyIG9mIHRva2VucwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSByZXR1cm5zICh1aW50IHN1cHBseSk7CgogICAgLy8vIEBkZXYgVHJhbnNmZXJzIHNlbmRlciB0b2tlbiB0byBnaXZlbiBhZGRyZXNzLiBSZXR1cm5zIHN1Y2Nlc3MuCiAgICAvLy8gQHBhcmFtIF90byBBZGRyZXNzIG9mIG5ldyB0b2tlbiBvd25lci4KICAgIC8vLyBAcGFyYW0gX3ZhbHVlIEJ5dGVzMzIgaWQgb2YgdGhlIHRva2VuIHRvIHRyYW5zZmVyLgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIGJ5dGVzMzIgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8vLyBAZGV2IEFsbG93cyBhbGxvd2VkIHRoaXJkIHBhcnR5IHRvIHRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIuIFJldHVybnMgc3VjY2Vzcy4KICAgIC8vLyBAcGFyYW0gX2Zyb20gQWRkcmVzcyBvZiB0b2tlbiBvd25lci4KICAgIC8vLyBAcGFyYW0gX3RvIEFkZHJlc3Mgb2YgbmV3IHRva2VuIG93bmVyLgogICAgLy8vIEBwYXJhbSBfdmFsdWUgQnl0ZXMzMiBpZCBvZiB0aGUgdG9rZW4gdG8gdHJhbnNmZXIuCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCBieXRlczMyIF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCiAgICAvLy8gQGRldiBTZXRzIGFwcHJvdmFsIHNwZW5kZXIgdG8gdHJhbnNmZXIgb3duZXJzaGlwIG9mIHRva2VuLiBSZXR1cm5zIHN1Y2Nlc3MuCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIEFkZHJlc3Mgb2Ygc3BlbmRlci4uCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBCeXRlczMyIGlkIG9mIHRva2VuIHRoYXQgY2FuIGJlIHNwZW5kLgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgYnl0ZXMzMiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLyoKICAgICAqIFJlYWQgc3RvcmFnZSBmdW5jdGlvbnMKICAgICAqLwogICAgLy8vIEBkZXYgUmV0dXJucyBpZCBvZiB0b2tlbiBvd25lZCBieSBnaXZlbiBhZGRyZXNzIChlbmNvZGVkIGFzIGFuIGludGVnZXIpLgogICAgLy8vIEBwYXJhbSBfb3duZXIgQWRkcmVzcyBvZiB0b2tlbiBvd25lci4KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKCiAgICAvLy8gQGRldiBSZXR1cm5zIHRoZSB0b2tlbiBpZCB0aGF0IG1heSB0cmFuc2ZlciBmcm9tIF9vd25lciBhY2NvdW50IGJ5IF9zcGVuZGVyLi4KICAgIC8vLyBAcGFyYW0gX293bmVyIEFkZHJlc3Mgb2YgdG9rZW4gb3duZXIuCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIEFkZHJlc3Mgb2YgdG9rZW4gc3BlbmRlci4KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOwoKICAgIC8qCiAgICAgKiAgRXh0cmEgbm9uIEVSQzIwIGZ1bmN0aW9ucwogICAgICovCiAgICAvLy8gQGRldiBSZXR1cm5zIHdoZXRoZXIgdGhlIGFkZHJlc3Mgb3ducyBhIHRva2VuLgogICAgLy8vIEBwYXJhbSBfb3duZXIgQWRkcmVzcyB0byBjaGVjay4KICAgIGZ1bmN0aW9uIGlzVG9rZW5Pd25lcihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAoYm9vbCk7CgogICAgLy8vIEBkZXYgUmV0dXJucyB0aGUgaWRlbnRpdHkgb2YgdGhlIGdpdmVuIHRva2VuIGlkLgogICAgLy8vIEBwYXJhbSBfaWQgQnl0ZXMzMiBpZCBvZiB0b2tlbiB0byBsb29rdXAuCiAgICBmdW5jdGlvbiBpZGVudGl0eU9mKGJ5dGVzMzIgX2lkKSBjb25zdGFudCByZXR1cm5zIChzdHJpbmcgaWRlbnRpdHkpOwoKICAgIC8vLyBAZGV2IFJldHVybnMgdGhlIGFkZHJlc3Mgb2YgdGhlIG93bmVyIG9mIHRoZSBnaXZlbiB0b2tlbiBpZC4KICAgIC8vLyBAcGFyYW0gX2lkIEJ5dGVzMzIgaWQgb2YgdG9rZW4gdG8gbG9va3VwLgogICAgZnVuY3Rpb24gb3duZXJPZihieXRlczMyIF9pZCkgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcyBvd25lcik7Cn0KCgpjb250cmFjdCBJbmRpdmlkdWFsaXR5VG9rZW5Sb290IGlzIEluZGl2aWR1YWxpdHlUb2tlblJvb3RJbnRlcmZhY2UgewogICAgVG9rZW5JbnRlcmZhY2UgcHVibGljIGRldmNvbjJUb2tlbjsKCiAgICBmdW5jdGlvbiBJbmRpdmlkdWFsaXR5VG9rZW5Sb290KGFkZHJlc3MgX2RldmNvbjJUb2tlbikgewogICAgICAgIGRldmNvbjJUb2tlbiA9IFRva2VuSW50ZXJmYWNlKF9kZXZjb24yVG9rZW4pOwogICAgfQoKICAgIC8vIG93bmVyID0+IHRva2VuCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJ5dGVzMzIpIG93bmVyVG9Ub2tlbjsKCiAgICAvLyB0b2tlbiA9PiBvd25lcgogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiBhZGRyZXNzKSB0b2tlblRvT3duZXI7CgogICAgLy8gb3duZXIgPT4gc3BlbmRlciA9PiB0b2tlbgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IGJ5dGVzMzIpKSBhcHByb3ZhbHM7CgogICAgdWludCBfdXBncmFkZUNvdW50OwoKICAgIC8qCiAgICAgKiBJbnRlcm5hbCBIZWxwZXJzCiAgICAgKi8KICAgIGZ1bmN0aW9uIGlzRWxpZ2libGVGb3JVcGdyYWRlKGFkZHJlc3MgX293bmVyKSBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYgKG93bmVyVG9Ub2tlbltfb3duZXJdICE9IDB4MCkgewogICAgICAgICAgICAvLyBhbHJlYWR5IGEgdG9rZW4gb3duZXIKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0gZWxzZSBpZiAoIWRldmNvbjJUb2tlbi5pc1Rva2VuT3duZXIoX293bmVyKSkgewogICAgICAgICAgICAvLyBub3QgYSB0b2tlbiBvd25lciBvbiB0aGUgb3JpZ2luYWwgZGV2Y29uMlRva2VuIGNvbnRyYWN0LgogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIGlmIChpc1Rva2VuVXBncmFkZWQoYnl0ZXMzMihkZXZjb24yVG9rZW4uYmFsYW5jZU9mKF9vd25lcikpKSkgewogICAgICAgICAgICAvLyB0aGUgdG9rZW4gaGFzIGFscmVhZHkgYmVlbiB1cGdyYWRlZC4KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgIH0KCiAgICAvKgogICAgICogQW55IGZ1bmN0aW9uIG1vZGlmaWVkIHdpdGggdGhpcyB3aWxsIHBlcmZvcm0gdGhlIGB1cGdyYWRlYCBjYWxsIHByaW9yIHRvCiAgICAgKiBleGVjdXRpb24gd2hpY2ggYWxsb3dzIHBlb3BsZSB0byB1c2UgdGhpcyBjb250cmFjdCBhcy1pZiB0aGV5IGhhZAogICAgICogYWxyZWFkeSBwcm9jZXNzZWQgdGhlIHVwZ3JhZGUuCiAgICAgKi8KICAgIG1vZGlmaWVyIHNpbGVudFVwZ3JhZGUgewogICAgICAgIGlmIChpc0VsaWdpYmxlRm9yVXBncmFkZShtc2cuc2VuZGVyKSkgewogICAgICAgICAgICB1cGdyYWRlKCk7CiAgICAgICAgfQogICAgICAgIF87CiAgICB9CgoKICAgIC8vLyBAZGV2IFJldHVybiB0aGUgbnVtYmVyIG9mIHRva2VucwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGRldmNvbjJUb2tlbi50b3RhbFN1cHBseSgpOwogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgaWQgb2YgdG9rZW4gb3duZWQgYnkgZ2l2ZW4gYWRkcmVzcyAoZW5jb2RlZCBhcyBhbiBpbnRlZ2VyKS4KICAgIC8vLyBAcGFyYW0gX293bmVyIEFkZHJlc3Mgb2YgdG9rZW4gb3duZXIuCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgICAgIGlmIChfb3duZXIgPT0gMHgwKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0gZWxzZSBpZiAob3duZXJUb1Rva2VuW19vd25lcl0gPT0gMHgwKSB7CiAgICAgICAgICAgIC8vIG5vdCBhIGN1cnJlbnQgdG9rZW4gb3duZXIuICBDaGVjayB3aGV0aGVyIHRoZXkgYXJlIG9uIHRoZQogICAgICAgICAgICAvLyBvcmlnaW5hbCBjb250cmFjdC4KICAgICAgICAgICAgaWYgKGRldmNvbjJUb2tlbi5pc1Rva2VuT3duZXIoX293bmVyKSkgewogICAgICAgICAgICAgICAgLy8gcHVsbCB0aGUgdG9rZW5JRAogICAgICAgICAgICAgICAgdmFyIHRva2VuSUQgPSBieXRlczMyKGRldmNvbjJUb2tlbi5iYWxhbmNlT2YoX293bmVyKSk7CgogICAgICAgICAgICAgICAgaWYgKHRva2VuVG9Pd25lclt0b2tlbklEXSA9PSAweDApIHsKICAgICAgICAgICAgICAgICAgICAvLyB0aGUgdG9rZW4gaGFzbid0IHlldCBiZWVuIHVwZ3JhZGVkIHNvIHdlIGNhbiByZXR1cm4gMS4KICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICB9CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyB0aGUgdG9rZW4gaWQgdGhhdCBtYXkgdHJhbnNmZXIgZnJvbSBfb3duZXIgYWNjb3VudCBieSBfc3BlbmRlci4uCiAgICAvLy8gQHBhcmFtIF9vd25lciBBZGRyZXNzIG9mIHRva2VuIG93bmVyLgogICAgLy8vIEBwYXJhbSBfc3BlbmRlciBBZGRyZXNzIG9mIHRva2VuIHNwZW5kZXIuCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsCiAgICAgICAgICAgICAgICAgICAgICAgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgICAgICB2YXIgYXBwcm92ZWRUb2tlbklEID0gYXBwcm92YWxzW19vd25lcl1bX3NwZW5kZXJdOwoKICAgICAgICBpZiAoYXBwcm92ZWRUb2tlbklEID09IDB4MCkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9IGVsc2UgaWYgKF9vd25lciA9PSAweDAgfHwgX3NwZW5kZXIgPT0gMHgwKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0gZWxzZSBpZiAodG9rZW5Ub093bmVyW2FwcHJvdmVkVG9rZW5JRF0gPT0gX293bmVyKSB7CiAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8gQGRldiBUcmFuc2ZlcnMgc2VuZGVyIHRva2VuIHRvIGdpdmVuIGFkZHJlc3MuIFJldHVybnMgc3VjY2Vzcy4KICAgIC8vLyBAcGFyYW0gX3RvIEFkZHJlc3Mgb2YgbmV3IHRva2VuIG93bmVyLgogICAgLy8vIEBwYXJhbSBfdmFsdWUgQnl0ZXMzMiBpZCBvZiB0aGUgdG9rZW4gdG8gdHJhbnNmZXIuCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywKICAgICAgICAgICAgICAgICAgICAgIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgc2lsZW50VXBncmFkZSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBpZiAoX3ZhbHVlICE9IDEpIHsKICAgICAgICAgICAgLy8gMSBpcyB0aGUgb25seSB2YWx1ZSB0aGF0IG1ha2VzIGFueSBzZW5zZSBoZXJlLgogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIGlmIChfdG8gPT0gMHgwKSB7CiAgICAgICAgICAgIC8vIGNhbm5vdCB0cmFuc2ZlciB0byB0aGUgbnVsbCBhZGRyZXNzLgogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIGlmIChvd25lclRvVG9rZW5bbXNnLnNlbmRlcl0gPT0gMHgwKSB7CiAgICAgICAgICAgIC8vIG1zZy5zZW5kZXIgaXMgbm90IGEgdG9rZW4gb3duZXIKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0gZWxzZSBpZiAob3duZXJUb1Rva2VuW190b10gIT0gMHgwKSB7CiAgICAgICAgICAgIC8vIGNhbm5vdCB0cmFuc2ZlciB0byBhbiBhZGRyZXNzIHRoYXQgYWxyZWFkeSBvd25zIGEgdG9rZW4uCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgaWYgKGlzRWxpZ2libGVGb3JVcGdyYWRlKF90bykpIHsKICAgICAgICAgICAgLy8gY2Fubm90IHRyYW5zZmVyIHRvIGFuIGFjY291bnQgd2hpY2ggaXMgc3RpbGwgaG9sZGluZyB0aGVpciB0b2tlbgogICAgICAgICAgICAvLyBpbiB0aGUgb2xkIHN5c3RlbS4KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgLy8gcHVsbCB0aGUgdG9rZW4gaWQuCiAgICAgICAgdmFyIHRva2VuSUQgPSBvd25lclRvVG9rZW5bbXNnLnNlbmRlcl07CgogICAgICAgIC8vIHJlbW92ZSB0aGUgdG9rZW4gZnJvbSB0aGUgc2VuZGVyLgogICAgICAgIG93bmVyVG9Ub2tlblttc2cuc2VuZGVyXSA9IDB4MDsKCiAgICAgICAgLy8gYXNzaWduIHRoZSB0b2tlbiB0byB0aGUgbmV3IG93bmVyCiAgICAgICAgb3duZXJUb1Rva2VuW190b10gPSB0b2tlbklEOwogICAgICAgIHRva2VuVG9Pd25lclt0b2tlbklEXSA9IF90bzsKCiAgICAgICAgLy8gbG9nIHRoZSB0cmFuc2ZlcgogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgMSk7CiAgICAgICAgVG9rZW5FdmVudExpYi5fVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCB0b2tlbklEKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8vIEBkZXYgVHJhbnNmZXJzIHNlbmRlciB0b2tlbiB0byBnaXZlbiBhZGRyZXNzLiBSZXR1cm5zIHN1Y2Nlc3MuCiAgICAvLy8gQHBhcmFtIF90byBBZGRyZXNzIG9mIG5ldyB0b2tlbiBvd25lci4KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmV0dXJuIHRyYW5zZmVyKF90bywgMSk7CiAgICB9CgogICAgLy8vIEBkZXYgQWxsb3dzIGFsbG93ZWQgdGhpcmQgcGFydHkgdG8gdHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlci4gUmV0dXJucyBzdWNjZXNzLgogICAgLy8vIEBwYXJhbSBfZnJvbSBBZGRyZXNzIG9mIHRva2VuIG93bmVyLgogICAgLy8vIEBwYXJhbSBfdG8gQWRkcmVzcyBvZiBuZXcgdG9rZW4gb3duZXIuCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBCeXRlczMyIGlkIG9mIHRoZSB0b2tlbiB0byB0cmFuc2Zlci4KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLAogICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3MgX3RvLAogICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgaWYgKF92YWx1ZSAhPSAxKSB7CiAgICAgICAgICAgIC8vIENhbm5vdCB0cmFuc2ZlciBhbnl0aGluZyBvdGhlciB0aGFuIDEgdG9rZW4uCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgaWYgKF90byA9PSAweDApIHsKICAgICAgICAgICAgLy8gQ2Fubm90IHRyYW5zZmVyIHRvIHRoZSBudWxsIGFkZHJlc3MKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0gZWxzZSBpZiAob3duZXJUb1Rva2VuW19mcm9tXSA9PSAweDApIHsKICAgICAgICAgICAgLy8gQ2Fubm90IHRyYW5zZmVyIGlmIF9mcm9tIGlzIG5vdCBhIHRva2VuIG93bmVyCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgaWYgKG93bmVyVG9Ub2tlbltfdG9dICE9IDB4MCkgewogICAgICAgICAgICAvLyBDYW5ub3QgdHJhbnNmZXIgdG8gYW4gZXhpc3RpbmcgdG9rZW4gb3duZXIKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0gZWxzZSBpZiAoYXBwcm92YWxzW19mcm9tXVttc2cuc2VuZGVyXSAhPSBvd25lclRvVG9rZW5bX2Zyb21dKSB7CiAgICAgICAgICAgIC8vIFRoZSBhcHByb3ZlZCB0b2tlbiBkb2Vzbid0IG1hdGNoIHRoZSB0b2tlbiBiZWluZyB0cmFuc2ZlcnJlZC4KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0gZWxzZSBpZiAoaXNFbGlnaWJsZUZvclVwZ3JhZGUoX3RvKSkgewogICAgICAgICAgICAvLyBjYW5ub3QgdHJhbnNmZXIgdG8gYW4gYWNjb3VudCB3aGljaCBpcyBzdGlsbCBob2xkaW5nIHRoZWlyIHRva2VuCiAgICAgICAgICAgIC8vIGluIHRoZSBvbGQgc3lzdGVtLgogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICAvLyBwdWxsIHRoZSB0b2tlbklECiAgICAgICAgdmFyIHRva2VuSUQgPSBvd25lclRvVG9rZW5bX2Zyb21dOwoKICAgICAgICAvLyBudWxsIG91dCB0aGUgYXBwcm92YWwKICAgICAgICBhcHByb3ZhbHNbX2Zyb21dW21zZy5zZW5kZXJdID0gMHgwOwoKICAgICAgICAvLyByZW1vdmUgdGhlIHRva2VuIGZyb20gdGhlIHNlbmRlci4KICAgICAgICBvd25lclRvVG9rZW5bX2Zyb21dID0gMHgwOwoKICAgICAgICAvLyBhc3NpZ24gdGhlIHRva2VuIHRvIHRoZSBuZXcgb3duZXIKICAgICAgICBvd25lclRvVG9rZW5bX3RvXSA9IHRva2VuSUQ7CiAgICAgICAgdG9rZW5Ub093bmVyW3Rva2VuSURdID0gX3RvOwoKICAgICAgICAvLyBsb2cgdGhlIHRyYW5zZmVyCiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgMSk7CiAgICAgICAgVG9rZW5FdmVudExpYi5fVHJhbnNmZXIoX2Zyb20sIF90bywgdG9rZW5JRCk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyBhbGxvd2VkIHRoaXJkIHBhcnR5IHRvIHRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIuIFJldHVybnMgc3VjY2Vzcy4KICAgIC8vLyBAcGFyYW0gX2Zyb20gQWRkcmVzcyBvZiB0b2tlbiBvd25lci4KICAgIC8vLyBAcGFyYW0gX3RvIEFkZHJlc3Mgb2YgbmV3IHRva2VuIG93bmVyLgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmV0dXJuIHRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCAxKTsKICAgIH0KCiAgICAvLy8gQGRldiBTZXRzIGFwcHJvdmFsIHNwZW5kZXIgdG8gdHJhbnNmZXIgb3duZXJzaGlwIG9mIHRva2VuLiBSZXR1cm5zIHN1Y2Nlc3MuCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIEFkZHJlc3Mgb2Ygc3BlbmRlci4uCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBCeXRlczMyIGlkIG9mIHRva2VuIHRoYXQgY2FuIGJlIHNwZW5kLgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLAogICAgICAgICAgICAgICAgICAgICB1aW50MjU2IF92YWx1ZSkgcHVibGljIHNpbGVudFVwZ3JhZGUgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgaWYgKF92YWx1ZSAhPSAxKSB7CiAgICAgICAgICAgIC8vIGNhbm5vdCBhcHByb3ZlIGFueSB2YWx1ZSBvdGhlciB0aGFuIDEKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0gZWxzZSBpZiAoX3NwZW5kZXIgPT0gMHgwKSB7CiAgICAgICAgICAgIC8vIGNhbm5vdCBhcHByb3ZlIHRoZSBudWxsIGFkZHJlc3MgYXMgYSBzcGVuZGVyLgogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIGlmIChvd25lclRvVG9rZW5bbXNnLnNlbmRlcl0gPT0gMHgwKSB7CiAgICAgICAgICAgIC8vIGNhbm5vdCBhcHByb3ZlIGlmIG5vdCBhIHRva2VuIG93bmVyLgogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICB2YXIgdG9rZW5JRCA9IG93bmVyVG9Ub2tlblttc2cuc2VuZGVyXTsKICAgICAgICBhcHByb3ZhbHNbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gdG9rZW5JRDsKCiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIDEpOwogICAgICAgIFRva2VuRXZlbnRMaWIuX0FwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCB0b2tlbklEKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8vIEBkZXYgU2V0cyBhcHByb3ZhbCBzcGVuZGVyIHRvIHRyYW5zZmVyIG93bmVyc2hpcCBvZiB0b2tlbi4gUmV0dXJucyBzdWNjZXNzLgogICAgLy8vIEBwYXJhbSBfc3BlbmRlciBBZGRyZXNzIG9mIHNwZW5kZXIuLgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmV0dXJuIGFwcHJvdmUoX3NwZW5kZXIsIDEpOwogICAgfQoKICAgIC8qCiAgICAgKiAgRXh0cmEgbm9uIEVSQzIwIGZ1bmN0aW9ucwogICAgICovCiAgICAvLy8gQGRldiBSZXR1cm5zIHdoZXRoZXIgdGhlIGFkZHJlc3Mgb3ducyBhIHRva2VuLgogICAgLy8vIEBwYXJhbSBfb3duZXIgQWRkcmVzcyB0byBjaGVjay4KICAgIGZ1bmN0aW9uIGlzVG9rZW5Pd25lcihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmIChfb3duZXIgPT0gMHgwKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgaWYgKG93bmVyVG9Ub2tlbltfb3duZXJdID09IDB4MCkgewogICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgb3duZXIgaGFzIGEgdG9rZW4gb24gdGhlIG1haW4gZGV2Y29uMlRva2VuIGNvbnRyYWN0LgogICAgICAgICAgICBpZiAoZGV2Y29uMlRva2VuLmlzVG9rZW5Pd25lcihfb3duZXIpKSB7CiAgICAgICAgICAgICAgICAvLyBwdWxsIHRoZSB0b2tlbiBJRAogICAgICAgICAgICAgICAgdmFyIHRva2VuSUQgPSBieXRlczMyKGRldmNvbjJUb2tlbi5iYWxhbmNlT2YoX293bmVyKSk7CgogICAgICAgICAgICAgICAgaWYgKHRva2VuVG9Pd25lclt0b2tlbklEXSA9PSAweDApIHsKICAgICAgICAgICAgICAgICAgICAvLyBUaGV5IG93biBhbiB1bi10cmFuc2ZlcmVkIHRva2VuIGluIHRoZSBwYXJlbnQKICAgICAgICAgICAgICAgICAgICAvLyBkZXZjb24yVG9rZW4gY29udHJhY3QuCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIHRoZSBhZGRyZXNzIG9mIHRoZSBvd25lciBvZiB0aGUgZ2l2ZW4gdG9rZW4gaWQuCiAgICAvLy8gQHBhcmFtIF90b2tlbklEIEJ5dGVzMzIgaWQgb2YgdG9rZW4gdG8gbG9va3VwLgogICAgZnVuY3Rpb24gb3duZXJPZihieXRlczMyIF90b2tlbklEKSBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzIG93bmVyKSB7CiAgICAgICAgaWYgKF90b2tlbklEID09IDB4MCkgewogICAgICAgICAgICByZXR1cm4gMHgwOwogICAgICAgIH0gZWxzZSBpZiAodG9rZW5Ub093bmVyW190b2tlbklEXSAhPSAweDApIHsKICAgICAgICAgICAgcmV0dXJuIHRva2VuVG9Pd25lcltfdG9rZW5JRF07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGRldmNvbjJUb2tlbi5vd25lck9mKF90b2tlbklEKTsKICAgICAgICB9CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyB0aGUgdG9rZW4gSUQgZm9yIHRoZSBnaXZlbiBhZGRyZXNzIG9yIDB4MCBpZiB0aGV5IGFyZSBub3QgYSB0b2tlbiBvd25lci4KICAgIC8vLyBAcGFyYW0gX293bmVyIEFkZHJlc3Mgb2YgdGhlIG93bmVyIHRvIGxvb2t1cC4KICAgIGZ1bmN0aW9uIHRva2VuSWQoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKGJ5dGVzMzIgdG9rZW5JRCkgewogICAgICAgIGlmIChfb3duZXIgPT0gMHgwKSB7CiAgICAgICAgICAgIHJldHVybiAweDA7CiAgICAgICAgfSBlbHNlIGlmIChvd25lclRvVG9rZW5bX293bmVyXSAhPSAweDApIHsKICAgICAgICAgICAgcmV0dXJuIG93bmVyVG9Ub2tlbltfb3duZXJdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRva2VuSUQgPSBieXRlczMyKGRldmNvbjJUb2tlbi5iYWxhbmNlT2YoX293bmVyKSk7CiAgICAgICAgICAgIGlmICh0b2tlblRvT3duZXJbdG9rZW5JRF0gPT0gMHgwKSB7CiAgICAgICAgICAgICAgICAvLyB0aGlzIHRva2VuIGhhcyBub3QgYmVlbiB0cmFuc2ZlcmVkIHlldCBzbyByZXR1cm4gdGhlIHByb3hpZWQKICAgICAgICAgICAgICAgIC8vIHZhbHVlLgogICAgICAgICAgICAgICAgcmV0dXJuIHRva2VuSUQ7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBUaGUgdG9rZW4gaGFzIGFscmVhZHkgYmVlbiB0cmFuc2ZlcnJlZCBzbyBpZ25vcmUgdGhlIHBhcmVudAogICAgICAgICAgICAgICAgLy8gY29udHJhY3QgZGF0YS4KICAgICAgICAgICAgICAgIHJldHVybiAweDA7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLy8vIEBkZXYgVXBncmFkZXMgYSB0b2tlbiBmcm9tIHRoZSBwcmV2aW91cyBjb250cmFjdAogICAgZnVuY3Rpb24gdXBncmFkZSgpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBpZiAoIWRldmNvbjJUb2tlbi5pc1Rva2VuT3duZXIobXNnLnNlbmRlcikpIHsKICAgICAgICAgICAgLy8gbm90IGEgdG9rZW4gb3duZXIuCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgaWYgKG93bmVyVG9Ub2tlblttc2cuc2VuZGVyXSAhPSAweDApIHsKICAgICAgICAgICAgLy8gYWxyZWFkeSBvd25zIGEgdG9rZW4KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBwdWxsIHRoZSB0b2tlbiBJRAogICAgICAgIHZhciB0b2tlbklEID0gYnl0ZXMzMihkZXZjb24yVG9rZW4uYmFsYW5jZU9mKG1zZy5zZW5kZXIpKTsKCiAgICAgICAgaWYgKHRva2VuSUQgPT0gMHgwKSB7CiAgICAgICAgICAgIC8vIChzaG91bGQgbm90IGJlIHBvc3NpYmxlIGJ1dCBoZXJlIGFzIGEgc2FuaXR5IGNoZWNrKQogICAgICAgICAgICAvLyBudWxsIHRva2VuIGlzIGludmFsaWQuCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgaWYgKHRva2VuVG9Pd25lclt0b2tlbklEXSAhPSAweDApIHsKICAgICAgICAgICAgLy8gYWxyZWFkeSB1cGdyYWRlZC4KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0gZWxzZSBpZiAoZGV2Y29uMlRva2VuLm93bmVyT2YodG9rZW5JRCkgIT0gbXNnLnNlbmRlcikgewogICAgICAgICAgICAvLyAoc2hvdWxkIG5vdCBiZSBwb3NzaWJsZSBidXQgaGVyZSBhcyBhIHNhbml0eSBjaGVjaykKICAgICAgICAgICAgLy8gbm90IHRoZSBvd25lciBvZiB0aGUgdG9rZW4uCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIC8vIEFzc2lnbiB0aGUgbmV3IG93bmVyc2hpcC4KICAgICAgICBvd25lclRvVG9rZW5bbXNnLnNlbmRlcl0gPSB0b2tlbklEOwogICAgICAgIHRva2VuVG9Pd25lclt0b2tlbklEXSA9IG1zZy5zZW5kZXI7CgogICAgICAgIC8vIGluY3JlbWVudCB0aGUgbnVtYmVyIG9mIHRva2VucyB0aGF0IGhhdmUgYmVlbiB1cGdyYWRlZC4KICAgICAgICBfdXBncmFkZUNvdW50ICs9IDE7CgogICAgICAgIC8vIExvZyBpdAogICAgICAgIE1pbnQobXNnLnNlbmRlciwgdG9rZW5JRCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8vIEBkZXYgVXBncmFkZXMgYSB0b2tlbiBmcm9tIHRoZSBwcmV2aW91cyBjb250cmFjdAogICAgLy8vIEBwYXJhbSBfb3duZXIgdGhlIGFkZHJlc3Mgb2YgdGhlIG93bmVyIG9mIHRoZSB0b2tlbiBvbiB0aGUgb3JpZ2luYWwgY29udHJhY3QKICAgIC8vLyBAcGFyYW0gX25ld093bmVyIHRoZSBhZGRyZXNzIHRoYXQgc2hvdWxkIG93biB0aGUgdG9rZW4gb24gdGhlIG5ldyBjb250cmFjdC4KICAgIC8vLyBAcGFyYW0gc2lnbmF0dXJlIDY1IGJ5dGUgc2lnbmF0dXJlIG9mIHRoZSB0aWdodGx5IHBhY2tlZCBieXRlcyAoYWRkcmVzcyh0aGlzKSArIF9vd25lciArIF9uZXdPd25lciksIHNpZ25lZCBieSBfb3duZXIKICAgIGZ1bmN0aW9uIHByb3h5VXBncmFkZShhZGRyZXNzIF9vd25lciwKICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzIF9uZXdPd25lciwKICAgICAgICAgICAgICAgICAgICAgICAgICBieXRlcyBzaWduYXR1cmUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYgKF9vd25lciA9PSAweDAgfHwgX25ld093bmVyID09IDB4MCkgewogICAgICAgICAgICAvLyBjYW5ub3Qgd29yayB3aXRoIG51bGwgYWRkcmVzc2VzLgogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIGlmICghZGV2Y29uMlRva2VuLmlzVG9rZW5Pd25lcihfb3duZXIpKSB7CiAgICAgICAgICAgIC8vIG5vdCBhIHRva2VuIG93bmVyIG9uIHRoZSBvcmlnaW5hbCBkZXZjb24yVG9rZW4gY29udHJhY3QuCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGJ5dGVzMzIgdG9rZW5JRCA9IGJ5dGVzMzIoZGV2Y29uMlRva2VuLmJhbGFuY2VPZihfb3duZXIpKTsKCiAgICAgICAgaWYgKHRva2VuSUQgPT0gMHgwKSB7CiAgICAgICAgICAgIC8vIChzaG91bGQgbm90IGJlIHBvc3NpYmxlIHNpbmNlIHdlIGFscmVhZHkgY2hlY2tlZCBpc1Rva2VuT3duZXIKICAgICAgICAgICAgLy8gYnV0IEkgbGlrZSBiZWluZyBleHBsaWNpdCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0gZWxzZSBpZiAoaXNUb2tlblVwZ3JhZGVkKHRva2VuSUQpKSB7CiAgICAgICAgICAgIC8vIHRoZSB0b2tlbiBoYXMgYWxyZWFkeSBiZWVuIHVwZ3JhZGVkLgogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIGlmIChvd25lclRvVG9rZW5bX25ld093bmVyXSAhPSAweDApIHsKICAgICAgICAgICAgLy8gbmV3IG93bmVyIGFscmVhZHkgb3ducyBhIHRva2VuCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgaWYgKF9vd25lciAhPSBfbmV3T3duZXIgJiYgaXNFbGlnaWJsZUZvclVwZ3JhZGUoX25ld093bmVyKSkgewogICAgICAgICAgICAvLyBjYW5ub3QgdXBncmFkZSB0byBhY2NvdW50IHRoYXQgaXMgc3RpbGwgaGFzIGFuIHVwZ3JhZGFibGUgdG9rZW4KICAgICAgICAgICAgLy8gb24gdGhlIG9sZCBzeXN0ZW0uCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGJ5dGVzMzIgc2lnbmF0dXJlSGFzaCA9IHNoYTMoYWRkcmVzcyh0aGlzKSwgX293bmVyLCBfbmV3T3duZXIpOwoKICAgICAgICBpZiAoIUVDVmVyaWZ5TGliLmVjdmVyaWZ5KHNpZ25hdHVyZUhhc2gsIHNpZ25hdHVyZSwgX293bmVyKSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICAvLyBBc3NpZ24gdGhlIG5ldyB0b2tlbgogICAgICAgIHRva2VuVG9Pd25lclt0b2tlbklEXSA9IF9uZXdPd25lcjsKICAgICAgICBvd25lclRvVG9rZW5bX25ld093bmVyXSA9IHRva2VuSUQ7CgogICAgICAgIC8vIGluY3JlbWVudCB0aGUgbnVtYmVyIG9mIHRva2VucyB0aGF0IGhhdmUgYmVlbiB1cGdyYWRlZC4KICAgICAgICBfdXBncmFkZUNvdW50ICs9IDE7CgogICAgICAgIC8vIExvZyBpdAogICAgICAgIE1pbnQoX25ld093bmVyLCB0b2tlbklEKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyB0aGUgbnVtYmVyIG9mIHRva2VucyB0aGF0IGhhdmUgYmVlbiB1cGdyYWRlZC4KICAgIGZ1bmN0aW9uIHVwZ3JhZGVDb3VudCgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgX2Ftb3VudCkgewogICAgICAgIHJldHVybiBfdXBncmFkZUNvdW50OwogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgdGhlIG51bWJlciBvZiB0b2tlbnMgdGhhdCBoYXZlIGJlZW4gdXBncmFkZWQuCiAgICAvLy8gQHBhcmFtIF90b2tlbklEIHRoZSBpZCBvZiB0aGUgdG9rZW4gdG8gcXVlcnkKICAgIGZ1bmN0aW9uIGlzVG9rZW5VcGdyYWRlZChieXRlczMyIF90b2tlbklEKSBjb25zdGFudCByZXR1cm5zIChib29sIGlzVXBncmFkZWQpIHsKICAgICAgICByZXR1cm4gKHRva2VuVG9Pd25lcltfdG9rZW5JRF0gIT0gMHgwKTsKICAgIH0KfQoKCmNvbnRyYWN0IE1haW5uZXRJbmRpdmlkdWFsaXR5VG9rZW5Sb290IGlzIAogICAgICAgICBJbmRpdmlkdWFsaXR5VG9rZW5Sb290KDB4MGE0M2VkZmUxMDZkMjk1ZTdjMWU1OTFhNGIwNGI1NTk4YWY5NDc0Yykgewp9'.
	

]
