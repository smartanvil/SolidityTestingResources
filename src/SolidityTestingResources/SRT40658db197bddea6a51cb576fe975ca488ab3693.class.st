Class {
	#name : #SRT40658db197bddea6a51cb576fe975ca488ab3693,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT40658db197bddea6a51cb576fe975ca488ab3693 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7Cgpjb250cmFjdCBCVENSZWxheSB7CiAgICBmdW5jdGlvbiBnZXRMYXN0QmxvY2tIZWlnaHQoKSBwdWJsaWMgcmV0dXJucyAoaW50KTsKICAgIGZ1bmN0aW9uIGdldEJsb2NrY2hhaW5IZWFkKCkgcHVibGljIHJldHVybnMgKGludCk7CiAgICBmdW5jdGlvbiBnZXRGZWVBbW91bnQoaW50IGJsb2NrSGFzaCkgcHVibGljIHJldHVybnMgKGludCk7CiAgICBmdW5jdGlvbiBnZXRCbG9ja0hlYWRlcihpbnQgYmxvY2tIYXNoKSBwdWJsaWMgcmV0dXJucyAoYnl0ZXMzMls1XSk7CiAgICBmdW5jdGlvbiBzdG9yZUJsb2NrSGVhZGVyKGJ5dGVzIGJsb2NrSGVhZGVyKSBwdWJsaWMgcmV0dXJucyAoaW50KTsKfQoKY29udHJhY3QgRXNjcm93IHsKICAgIGZ1bmN0aW9uIGRlcG9zaXQoYWRkcmVzcyByZWNpcGllbnQpIHBheWFibGU7Cn0KCmNvbnRyYWN0IEFmZmlsaWF0ZU5ldHdvcmsgewogICAgZnVuY3Rpb24gYWZmaWxpYXRlQWRkcmVzc2VzKHVpbnQgY29kZSkgcmV0dXJucyAoYWRkcmVzcyk7Cn0KCmNvbnRyYWN0IEV0aGVyZXVtTG90dGVyeSB7CiAgICB1aW50IGNvbnN0YW50IEdBU19MSU1JVF9ERVBPU0lUID0gMzAwMDAwOwogICAgdWludCBjb25zdGFudCBHQVNfTElNSVRfQUZGSUxJQVRFID0gMzUwMDA7CgogICAgc3RydWN0IExvdHRlcnkgewogICAgICAgIHVpbnQgamFja3BvdDsKICAgICAgICBpbnQgZGVjaWRpbmdCbG9jazsKICAgICAgICB1aW50IG51bVRpY2tldHM7CiAgICAgICAgdWludCBudW1UaWNrZXRzU29sZDsKICAgICAgICB1aW50IHRpY2tldFByaWNlOwogICAgICAgIHVpbnQgYWZmaWxpYXRlQ3V0OwogICAgICAgIGludCB3aW5uaW5nVGlja2V0OwogICAgICAgIGFkZHJlc3Mgd2lubmVyOwogICAgICAgIHVpbnQgZmluYWxpemF0aW9uQmxvY2s7CiAgICAgICAgYWRkcmVzcyBmaW5hbGl6ZXI7CiAgICAgICAgc3RyaW5nIG1lc3NhZ2U7CiAgICAgICAgbWFwcGluZyAodWludCA9PiBhZGRyZXNzKSB0aWNrZXRzOwogICAgICAgIGludCBuZWFyZXN0S25vd25CbG9jazsKICAgICAgICBpbnQgbmVhcmVzdEtub3duQmxvY2tIYXNoOwogICAgfQoKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwogICAgYWRkcmVzcyBwdWJsaWMgYWRtaW47CiAgICBhZGRyZXNzIHB1YmxpYyBwcm9wb3NlZE93bmVyOwoKICAgIGludCBwdWJsaWMgaWQgPSAtMTsKICAgIHVpbnQgcHVibGljIGxhc3RJbml0VGltZXN0YW1wOwogICAgdWludCBwdWJsaWMgbGFzdFNhbGVUaW1lc3RhbXA7CgogICAgdWludCBwdWJsaWMgcmVjZW50QWN0aXZpdHlJZHg7CiAgICB1aW50WzEwMDBdIHB1YmxpYyByZWNlbnRBY3Rpdml0eTsKCiAgICBtYXBwaW5nIChpbnQgPT4gTG90dGVyeSkgcHVibGljIGxvdHRlcmllczsKCiAgICBhZGRyZXNzIHB1YmxpYyBidGNSZWxheTsKICAgIGFkZHJlc3MgcHVibGljIGVzY3JvdzsKICAgIGFkZHJlc3MgcHVibGljIGFmZmlsaWF0ZU5ldHdvcms7CgogICAgZW51bSBSZWFzb24geyBUaWNrZXRTYWxlQ2xvc2VkLCBUaWNrZXRBbHJlYWR5U29sZCB9CiAgICBldmVudCBQdXJjaGFzZUZhaWxlZChhZGRyZXNzIGluZGV4ZWQgYnV5ZXIsIHVpbnQgbWFyaywgUmVhc29uIHJlYXNvbik7CiAgICBldmVudCBQdXJjaGFzZVN1Y2Nlc3NmdWwoYWRkcmVzcyBpbmRleGVkIGJ1eWVyLCB1aW50IG1hcmspOwoKICAgIG1vZGlmaWVyIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlBZG1pbk9yT3duZXIgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lciB8fCBtc2cuc2VuZGVyID09IGFkbWluKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIGFmdGVySW5pdGlhbGl6YXRpb24gewogICAgICAgIHJlcXVpcmUoaWQgPj0gMCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBFdGhlcmV1bUxvdHRlcnkoYWRkcmVzcyBfYnRjUmVsYXksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkcmVzcyBfZXNjcm93LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3MgX2FmZmlsaWF0ZU5ldHdvcmspIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgYWRtaW4gPSBtc2cuc2VuZGVyOwogICAgICAgIGJ0Y1JlbGF5ID0gX2J0Y1JlbGF5OwogICAgICAgIGVzY3JvdyA9IF9lc2Nyb3c7CiAgICAgICAgYWZmaWxpYXRlTmV0d29yayA9IF9hZmZpbGlhdGVOZXR3b3JrOwogICAgfQoKICAgIGZ1bmN0aW9uIG5lZWRzSW5pdGlhbGl6YXRpb24oKSBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIGlkID09IC0xIHx8IGxvdHRlcmllc1tpZF0uZmluYWxpemF0aW9uQmxvY2sgPiAwOwogICAgfQoKICAgIGZ1bmN0aW9uIGluaXRMb3R0ZXJ5KHVpbnQgX2phY2twb3QsIHVpbnQgX251bVRpY2tldHMsIHVpbnQgX3RpY2tldFByaWNlKQogICAgICAgICAgICAgb25seUFkbWluT3JPd25lciB7CiAgICAgICAgcmVxdWlyZShuZWVkc0luaXRpYWxpemF0aW9uKCkpOwogICAgICAgIHJlcXVpcmUoX251bVRpY2tldHMgKiBfdGlja2V0UHJpY2UgPiBfamFja3BvdCk7CgogICAgICAgIGlkICs9IDE7CiAgICAgICAgbG90dGVyaWVzW2lkXS5qYWNrcG90ID0gX2phY2twb3Q7CiAgICAgICAgbG90dGVyaWVzW2lkXS5kZWNpZGluZ0Jsb2NrID0gLTE7CiAgICAgICAgbG90dGVyaWVzW2lkXS5udW1UaWNrZXRzID0gX251bVRpY2tldHM7CiAgICAgICAgbG90dGVyaWVzW2lkXS50aWNrZXRQcmljZSA9IF90aWNrZXRQcmljZTsKICAgICAgICBsb3R0ZXJpZXNbaWRdLndpbm5pbmdUaWNrZXQgPSAtMTsKCiAgICAgICAgdWludCBhZmZpbGlhdGVDdXQgPSAoX3RpY2tldFByaWNlIC0gKF9qYWNrcG90IC8gX251bVRpY2tldHMpKSAvIDI7CiAgICAgICAgbG90dGVyaWVzW2lkXS5hZmZpbGlhdGVDdXQgPSBhZmZpbGlhdGVDdXQ7CgogICAgICAgIGxhc3RJbml0VGltZXN0YW1wID0gYmxvY2sudGltZXN0YW1wOwogICAgICAgIGxhc3RTYWxlVGltZXN0YW1wID0gMDsKICAgIH0KCiAgICBmdW5jdGlvbiBidXlUaWNrZXRzKHVpbnRbXSBfdGlja2V0cywgdWludCBfbWFyaywgdWludCBfYWZmaWxpYXRlKQogICAgICAgICAgICAgcGF5YWJsZSBhZnRlckluaXRpYWxpemF0aW9uIHsKICAgICAgICBpZiAobG90dGVyaWVzW2lkXS5udW1UaWNrZXRzU29sZCA9PSBsb3R0ZXJpZXNbaWRdLm51bVRpY2tldHMpIHsKICAgICAgICAgICAgUHVyY2hhc2VGYWlsZWQobXNnLnNlbmRlciwgX21hcmssIFJlYXNvbi5UaWNrZXRTYWxlQ2xvc2VkKTsKICAgICAgICAgICAgbXNnLnNlbmRlci50cmFuc2Zlcihtc2cudmFsdWUpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICByZXF1aXJlKF90aWNrZXRzLmxlbmd0aCA+IDApOwogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID09IF90aWNrZXRzLmxlbmd0aCAqIGxvdHRlcmllc1tpZF0udGlja2V0UHJpY2UpOwoKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBfdGlja2V0cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB1aW50IHRpY2tldCA9IF90aWNrZXRzW2ldOwogICAgICAgICAgICByZXF1aXJlKHRpY2tldCA+PSAwKTsKICAgICAgICAgICAgcmVxdWlyZSh0aWNrZXQgPCBsb3R0ZXJpZXNbaWRdLm51bVRpY2tldHMpOwoKICAgICAgICAgICAgaWYgKGxvdHRlcmllc1tpZF0udGlja2V0c1t0aWNrZXRdICE9IDApIHsKICAgICAgICAgICAgICAgIFB1cmNoYXNlRmFpbGVkKG1zZy5zZW5kZXIsIF9tYXJrLCBSZWFzb24uVGlja2V0QWxyZWFkeVNvbGQpOwogICAgICAgICAgICAgICAgbXNnLnNlbmRlci50cmFuc2Zlcihtc2cudmFsdWUpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgX3RpY2tldHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdGlja2V0ID0gX3RpY2tldHNbaV07CiAgICAgICAgICAgIGxvdHRlcmllc1tpZF0udGlja2V0c1t0aWNrZXRdID0gbXNnLnNlbmRlcjsKICAgICAgICAgICAgcmVjZW50QWN0aXZpdHlbcmVjZW50QWN0aXZpdHlJZHhdID0gdGlja2V0OwoKICAgICAgICAgICAgcmVjZW50QWN0aXZpdHlJZHggKz0gMTsKICAgICAgICAgICAgaWYgKHJlY2VudEFjdGl2aXR5SWR4ID49IHJlY2VudEFjdGl2aXR5Lmxlbmd0aCkgewogICAgICAgICAgICAgICAgcmVjZW50QWN0aXZpdHlJZHggPSAwOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBsb3R0ZXJpZXNbaWRdLm51bVRpY2tldHNTb2xkICs9IF90aWNrZXRzLmxlbmd0aDsKICAgICAgICBsYXN0U2FsZVRpbWVzdGFtcCA9IGJsb2NrLnRpbWVzdGFtcDsKCiAgICAgICAgYWRkcmVzcyBhZmZpbGlhdGVBZGRyZXNzID0KICAgICAgICAgICAgQWZmaWxpYXRlTmV0d29yayhhZmZpbGlhdGVOZXR3b3JrKS5hZmZpbGlhdGVBZGRyZXNzZXMoX2FmZmlsaWF0ZSk7CiAgICAgICAgaWYgKGFmZmlsaWF0ZUFkZHJlc3MgIT0gMCkgewogICAgICAgICAgICB1aW50IGN1dCA9IGxvdHRlcmllc1tpZF0uYWZmaWxpYXRlQ3V0ICogX3RpY2tldHMubGVuZ3RoOwogICAgICAgICAgICB2YXIgXyA9IGFmZmlsaWF0ZUFkZHJlc3MuY2FsbC5nYXMoR0FTX0xJTUlUX0FGRklMSUFURSkudmFsdWUoY3V0KSgpOwogICAgICAgIH0KCiAgICAgICAgUHVyY2hhc2VTdWNjZXNzZnVsKG1zZy5zZW5kZXIsIF9tYXJrKTsKICAgIH0KCiAgICBmdW5jdGlvbiBuZWVkc0Jsb2NrRmluYWxpemF0aW9uKCkKICAgICAgICAgICAgIGFmdGVySW5pdGlhbGl6YXRpb24gY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIC8vIENoZWNrIHRoZSB0aW1lc3RhbXAgb2YgdGhlIGxhdGVzdCBibG9jayBrbm93biB0byBCVENSZWxheQogICAgICAgIC8vIGFuZCByZXF1aXJlIGl0IHRvIGJlIG5vIG1vcmUgdGhhbiAyIGhvdXJzIG9sZGVyIHRoYW4gdGhlCiAgICAgICAgLy8gdGltZXN0YW1wIG9mIG91ciBibG9jay4gVGhpcyBzaG91bGQgZW5zdXJlIHRoYXQgQlRDUmVsYXkKICAgICAgICAvLyBpcyByZWFzb25hYmx5IHVwIHRvIGRhdGUuCiAgICAgICAgdWludCBidGNUaW1lc3RhbXA7CiAgICAgICAgaW50IGJsb2NrSGFzaCA9IEJUQ1JlbGF5KGJ0Y1JlbGF5KS5nZXRCbG9ja2NoYWluSGVhZCgpOwogICAgICAgICgsYnRjVGltZXN0YW1wKSA9IGdldEJsb2NrSGVhZGVyKGJsb2NrSGFzaCk7CgogICAgICAgIHVpbnQgZGVsdGEgPSAwOwogICAgICAgIGlmIChidGNUaW1lc3RhbXAgPCBibG9jay50aW1lc3RhbXApIHsKICAgICAgICAgICAgZGVsdGEgPSBibG9jay50aW1lc3RhbXAgLSBidGNUaW1lc3RhbXA7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZGVsdGEgPCAyICogNjAgKiA2MCAmJgogICAgICAgICAgICAgICBsb3R0ZXJpZXNbaWRdLm51bVRpY2tldHNTb2xkID09IGxvdHRlcmllc1tpZF0ubnVtVGlja2V0cyAmJgogICAgICAgICAgICAgICBsb3R0ZXJpZXNbaWRdLmRlY2lkaW5nQmxvY2sgPT0gLTE7CiAgICB9CgogICAgZnVuY3Rpb24gZmluYWxpemVCbG9jaygpCiAgICAgICAgICAgICBhZnRlckluaXRpYWxpemF0aW9uIHsKICAgICAgICByZXF1aXJlKG5lZWRzQmxvY2tGaW5hbGl6YXRpb24oKSk7CgogICAgICAgIC8vIEF0IHRoaXMgcG9pbnQgd2Uga25vdyB0aGF0IHRoZSB0aW1lc3RhbXAgb2YgdGhlIGxhdGVzdCBibG9jawogICAgICAgIC8vIGtub3duIHRvIEJUQ1JlbGF5IGlzIHdpdGhpbiAyIGhvdXJzIG9mIHdoYXQgdGhlIEV0aGVyZXVtIG5ldHdvcmsKICAgICAgICAvLyBjb25zaWRlcnMgJ25vdycuIElmIHdlIGFzc3VtZSB0aGlzIHRvIGJlIGNvcnJlY3Qgd2l0aGluICsvLSAzIGhvdXJzLAogICAgICAgIC8vIHdlIGNhbiBjb25jbHVkZSB0aGF0ICdvdXQgdGhlcmUnIGluIHRoZSByZWFsIHdvcmxkIGF0IG1vc3QgNSBob3VycwogICAgICAgIC8vIGhhdmUgcGFzc2VkLiBBc3N1bWluZyBhbiBhY3R1YWwgYmxvY2sgdGltZSBvZiA5IG1pbnV0ZXMgZm9yIEJpdGNvaW4sCiAgICAgICAgLy8gd2UgY2FuIHVzZSB0aGUgUG9pc3NvbiBkaXN0cmlidXRpb24gdG8gY2FsY3VsYXRlLCB0aGF0IGlmIHdlIHdhaXQgZm9yCiAgICAgICAgLy8gNTQgbW9yZSBibG9ja3MsIHRoZW4gdGhlIHByb2JhYmlsaXR5IGZvciBhbGwgb2YgdGhlc2UgNTQgYmxvY2tzCiAgICAgICAgLy8gaGF2aW5nIGFscmVhZHkgYmVlbiBtaW5lZCBpbiA1IGhvdXJzIGlzIGxlc3MgdGhhbiAwLjEgJS4KICAgICAgICBpbnQgYmxvY2tIZWlnaHQgPSBCVENSZWxheShidGNSZWxheSkuZ2V0TGFzdEJsb2NrSGVpZ2h0KCk7CiAgICAgICAgbG90dGVyaWVzW2lkXS5kZWNpZGluZ0Jsb2NrID0gYmxvY2tIZWlnaHQgKyA1NDsKICAgIH0KCiAgICBmdW5jdGlvbiBuZWVkc0xvdHRlcnlGaW5hbGl6YXRpb24oKQogICAgICAgICAgICAgYWZ0ZXJJbml0aWFsaXphdGlvbiBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgaW50IGJsb2NrSGVpZ2h0ID0gQlRDUmVsYXkoYnRjUmVsYXkpLmdldExhc3RCbG9ja0hlaWdodCgpOwogICAgICAgIHJldHVybiBsb3R0ZXJpZXNbaWRdLmRlY2lkaW5nQmxvY2sgIT0gLTEgJiYKICAgICAgICAgICAgICAgYmxvY2tIZWlnaHQgPj0gbG90dGVyaWVzW2lkXS5kZWNpZGluZ0Jsb2NrICsgNiAmJgogICAgICAgICAgICAgICBsb3R0ZXJpZXNbaWRdLmZpbmFsaXphdGlvbkJsb2NrID09IDA7CiAgICB9CgogICAgZnVuY3Rpb24gZmluYWxpemVMb3R0ZXJ5KHVpbnQgX3N0ZXBzKQogICAgICAgICAgICAgYWZ0ZXJJbml0aWFsaXphdGlvbiB7CiAgICAgICAgcmVxdWlyZShuZWVkc0xvdHRlcnlGaW5hbGl6YXRpb24oKSk7CgogICAgICAgIGlmIChsb3R0ZXJpZXNbaWRdLm5lYXJlc3RLbm93bkJsb2NrICE9IGxvdHRlcmllc1tpZF0uZGVjaWRpbmdCbG9jaykgewogICAgICAgICAgICB3YWxrVG93YXJkc0Jsb2NrKF9zdGVwcyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaW50IHdpbm5pbmdUaWNrZXQgPSBsb3R0ZXJpZXNbaWRdLm5lYXJlc3RLbm93bkJsb2NrSGFzaCAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50KGxvdHRlcmllc1tpZF0ubnVtVGlja2V0cyk7CiAgICAgICAgICAgIGFkZHJlc3Mgd2lubmVyID0gbG90dGVyaWVzW2lkXS50aWNrZXRzW3VpbnQod2lubmluZ1RpY2tldCldOwoKICAgICAgICAgICAgbG90dGVyaWVzW2lkXS53aW5uaW5nVGlja2V0ID0gd2lubmluZ1RpY2tldDsKICAgICAgICAgICAgbG90dGVyaWVzW2lkXS53aW5uZXIgPSB3aW5uZXI7CiAgICAgICAgICAgIGxvdHRlcmllc1tpZF0uZmluYWxpemF0aW9uQmxvY2sgPSBibG9jay5udW1iZXI7CiAgICAgICAgICAgIGxvdHRlcmllc1tpZF0uZmluYWxpemVyID0gdHgub3JpZ2luOwoKICAgICAgICAgICAgaWYgKHdpbm5lciAhPSAwKSB7CiAgICAgICAgICAgICAgICB1aW50IHZhbHVlID0gbG90dGVyaWVzW2lkXS5qYWNrcG90OwogICAgICAgICAgICAgICAgYm9vbCBzdWNjZXNzZnVsID0KICAgICAgICAgICAgICAgICAgICB3aW5uZXIuY2FsbC5nYXMoR0FTX0xJTUlUX0RFUE9TSVQpLnZhbHVlKHZhbHVlKSgpOwogICAgICAgICAgICAgICAgaWYgKCFzdWNjZXNzZnVsKSB7CiAgICAgICAgICAgICAgICAgICAgRXNjcm93KGVzY3JvdykuZGVwb3NpdC52YWx1ZSh2YWx1ZSkod2lubmVyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIF8gPSBhZG1pbi5jYWxsLmdhcyhHQVNfTElNSVRfREVQT1NJVCkudmFsdWUodGhpcy5iYWxhbmNlKSgpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiB3YWxrVG93YXJkc0Jsb2NrKHVpbnQgX3N0ZXBzKSBpbnRlcm5hbCB7CiAgICAgICAgaW50IGJsb2NrSGVpZ2h0OwogICAgICAgIGludCBibG9ja0hhc2g7CiAgICAgICAgaWYgKGxvdHRlcmllc1tpZF0ubmVhcmVzdEtub3duQmxvY2sgPT0gMCkgewogICAgICAgICAgICBibG9ja0hlaWdodCA9IEJUQ1JlbGF5KGJ0Y1JlbGF5KS5nZXRMYXN0QmxvY2tIZWlnaHQoKTsKICAgICAgICAgICAgYmxvY2tIYXNoID0gQlRDUmVsYXkoYnRjUmVsYXkpLmdldEJsb2NrY2hhaW5IZWFkKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYmxvY2tIZWlnaHQgPSBsb3R0ZXJpZXNbaWRdLm5lYXJlc3RLbm93bkJsb2NrOwogICAgICAgICAgICBibG9ja0hhc2ggPSBsb3R0ZXJpZXNbaWRdLm5lYXJlc3RLbm93bkJsb2NrSGFzaDsKICAgICAgICB9CgogICAgICAgIC8vIFdhbGsgb25seSBhIGZldyBzdGVwcyB0byBrZWVwIGFuIHVwcGVyIGxpbWl0IG9uIGdhcyBjb3N0cy4KICAgICAgICBmb3IgKHVpbnQgc3RlcCA9IDA7IHN0ZXAgPCBfc3RlcHM7IHN0ZXArKykgewogICAgICAgICAgICBibG9ja0hlaWdodCAtPSAxOwogICAgICAgICAgICAoYmxvY2tIYXNoLCkgPSBnZXRCbG9ja0hlYWRlcihibG9ja0hhc2gpOwoKICAgICAgICAgICAgaWYgKGJsb2NrSGVpZ2h0ID09IGxvdHRlcmllc1tpZF0uZGVjaWRpbmdCbG9jaykgeyBicmVhazsgfQogICAgICAgIH0KCiAgICAgICAgLy8gU3RvcmUgdGhlIHByb2dyZXNzIHRvIHBpY2sgdXAgZnJvbSB0aGVyZSBuZXh0IHRpbWUuCiAgICAgICAgbG90dGVyaWVzW2lkXS5uZWFyZXN0S25vd25CbG9jayA9IGJsb2NrSGVpZ2h0OwogICAgICAgIGxvdHRlcmllc1tpZF0ubmVhcmVzdEtub3duQmxvY2tIYXNoID0gYmxvY2tIYXNoOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEJsb2NrSGVhZGVyKGludCBibG9ja0hhc2gpCiAgICAgICAgICAgICBpbnRlcm5hbCByZXR1cm5zIChpbnQgcHJldkJsb2NrSGFzaCwgdWludCB0aW1lc3RhbXApIHsKICAgICAgICAvLyBXZSBleHBlY3QgZnJlZSBhY2Nlc3MgdG8gQlRDUmVsYXkuCiAgICAgICAgaW50IGZlZSA9IEJUQ1JlbGF5KGJ0Y1JlbGF5KS5nZXRGZWVBbW91bnQoYmxvY2tIYXNoKTsKICAgICAgICByZXF1aXJlKGZlZSA9PSAwKTsKCiAgICAgICAgLy8gQ29kZSBpcyBiYXNlZCBvbiB0amFkZTI3MydzIEJUQ1JlbGF5VG9vbHMuCiAgICAgICAgYnl0ZXMzMls1XSBtZW1vcnkgYmxvY2tIZWFkZXIgPQogICAgICAgICAgICBCVENSZWxheShidGNSZWxheSkuZ2V0QmxvY2tIZWFkZXIoYmxvY2tIYXNoKTsKCiAgICAgICAgcHJldkJsb2NrSGFzaCA9IDA7CiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgMzI7IGkrKykgewogICAgICAgICAgICB1aW50IHBvcyA9IDY4ICsgaTsgIC8vIHByZXYuIGJsb2NrIGhhc2ggc3RhcnRzIGF0IHBvc2l0aW9uIDY4CiAgICAgICAgICAgIGJ5dGUgZGF0YSA9IGJsb2NrSGVhZGVyW3BvcyAvIDMyXVtwb3MgJSAzMl07CiAgICAgICAgICAgIHByZXZCbG9ja0hhc2ggPSBwcmV2QmxvY2tIYXNoIHwgaW50KGRhdGEpICogaW50KDB4MTAwICoqIGkpOwogICAgICAgIH0KCiAgICAgICAgdGltZXN0YW1wID0gMDsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgNDsgaSsrKSB7CiAgICAgICAgICAgIHBvcyA9IDEzMiArIGk7ICAvLyB0aW1lc3RhbXAgc3RhcnRzIGF0IHBvc2l0aW9uIDEzMgogICAgICAgICAgICBkYXRhID0gYmxvY2tIZWFkZXJbcG9zIC8gMzJdW3BvcyAlIDMyXTsKICAgICAgICAgICAgdGltZXN0YW1wID0gdGltZXN0YW1wIHwgdWludChkYXRhKSAqIHVpbnQoMHgxMDAgKiogaSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gKHByZXZCbG9ja0hhc2gsIHRpbWVzdGFtcCk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0TWVzc2FnZUxlbmd0aChzdHJpbmcgX21lc3NhZ2UpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gYnl0ZXMoX21lc3NhZ2UpLmxlbmd0aDsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRNZXNzYWdlKGludCBfaWQsIHN0cmluZyBfbWVzc2FnZSkKICAgICAgICAgICAgIGFmdGVySW5pdGlhbGl6YXRpb24gewogICAgICAgIHJlcXVpcmUobG90dGVyaWVzW19pZF0ud2lubmVyICE9IDApOwogICAgICAgIHJlcXVpcmUobG90dGVyaWVzW19pZF0ud2lubmVyID09IG1zZy5zZW5kZXIpOwogICAgICAgIHJlcXVpcmUoZ2V0TWVzc2FnZUxlbmd0aChfbWVzc2FnZSkgPD0gNTAwKTsKICAgICAgICBsb3R0ZXJpZXNbX2lkXS5tZXNzYWdlID0gX21lc3NhZ2U7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0TG90dGVyeURldGFpbHNBKGludCBfaWQpCiAgICAgICAgICAgICBjb25zdGFudCByZXR1cm5zIChpbnQgX2FjdHVhbElkLCB1aW50IF9qYWNrcG90LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IF9kZWNpZGluZ0Jsb2NrLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludCBfbnVtVGlja2V0cywgdWludCBfbnVtVGlja2V0c1NvbGQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50IF9sYXN0U2FsZVRpbWVzdGFtcCwgdWludCBfdGlja2V0UHJpY2UpIHsKICAgICAgICBpZiAoX2lkID09IC0xKSB7CiAgICAgICAgICAgIF9hY3R1YWxJZCA9IGlkOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF9hY3R1YWxJZCA9IF9pZDsKICAgICAgICB9CiAgICAgICAgX2phY2twb3QgPSBsb3R0ZXJpZXNbX2FjdHVhbElkXS5qYWNrcG90OwogICAgICAgIF9kZWNpZGluZ0Jsb2NrID0gbG90dGVyaWVzW19hY3R1YWxJZF0uZGVjaWRpbmdCbG9jazsKICAgICAgICBfbnVtVGlja2V0cyA9IGxvdHRlcmllc1tfYWN0dWFsSWRdLm51bVRpY2tldHM7CiAgICAgICAgX251bVRpY2tldHNTb2xkID0gbG90dGVyaWVzW19hY3R1YWxJZF0ubnVtVGlja2V0c1NvbGQ7CiAgICAgICAgX2xhc3RTYWxlVGltZXN0YW1wID0gbGFzdFNhbGVUaW1lc3RhbXA7CiAgICAgICAgX3RpY2tldFByaWNlID0gbG90dGVyaWVzW19hY3R1YWxJZF0udGlja2V0UHJpY2U7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0TG90dGVyeURldGFpbHNCKGludCBfaWQpCiAgICAgICAgICAgICBjb25zdGFudCByZXR1cm5zIChpbnQgX2FjdHVhbElkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IF93aW5uaW5nVGlja2V0LCBhZGRyZXNzIF93aW5uZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50IF9maW5hbGl6YXRpb25CbG9jaywgYWRkcmVzcyBfZmluYWxpemVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nIF9tZXNzYWdlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IF9wcmV2TG90dGVyeSwgaW50IF9uZXh0TG90dGVyeSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBfYmxvY2tIZWlnaHQpIHsKICAgICAgICBpZiAoX2lkID09IC0xKSB7CiAgICAgICAgICAgIF9hY3R1YWxJZCA9IGlkOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF9hY3R1YWxJZCA9IF9pZDsKICAgICAgICB9CiAgICAgICAgX3dpbm5pbmdUaWNrZXQgPSBsb3R0ZXJpZXNbX2FjdHVhbElkXS53aW5uaW5nVGlja2V0OwogICAgICAgIF93aW5uZXIgPSBsb3R0ZXJpZXNbX2FjdHVhbElkXS53aW5uZXI7CiAgICAgICAgX2ZpbmFsaXphdGlvbkJsb2NrID0gbG90dGVyaWVzW19hY3R1YWxJZF0uZmluYWxpemF0aW9uQmxvY2s7CiAgICAgICAgX2ZpbmFsaXplciA9IGxvdHRlcmllc1tfYWN0dWFsSWRdLmZpbmFsaXplcjsKICAgICAgICBfbWVzc2FnZSA9IGxvdHRlcmllc1tfYWN0dWFsSWRdLm1lc3NhZ2U7CgogICAgICAgIGlmIChfYWN0dWFsSWQgPT0gMCkgewogICAgICAgICAgICBfcHJldkxvdHRlcnkgPSAtMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfcHJldkxvdHRlcnkgPSBfYWN0dWFsSWQgLSAxOwogICAgICAgIH0KICAgICAgICBpZiAoX2FjdHVhbElkID09IGlkKSB7CiAgICAgICAgICAgIF9uZXh0TG90dGVyeSA9IC0xOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF9uZXh0TG90dGVyeSA9IF9hY3R1YWxJZCArIDE7CiAgICAgICAgfQoKICAgICAgICBfYmxvY2tIZWlnaHQgPSBCVENSZWxheShidGNSZWxheSkuZ2V0TGFzdEJsb2NrSGVpZ2h0KCk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0VGlja2V0RGV0YWlscyhpbnQgX2lkLCB1aW50IF9vZmZzZXQsIHVpbnQgX24sIGFkZHJlc3MgX2FkZHIpCiAgICAgICAgICAgICBjb25zdGFudCByZXR1cm5zICh1aW50OFtdIGRldGFpbHMpIHsKICAgICAgICByZXF1aXJlKF9vZmZzZXQgKyBfbiA8PSBsb3R0ZXJpZXNbX2lkXS5udW1UaWNrZXRzKTsKCiAgICAgICAgZGV0YWlscyA9IG5ldyB1aW50OFtdKF9uKTsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBfbjsgaSsrKSB7CiAgICAgICAgICAgIGFkZHJlc3MgYWRkciA9IGxvdHRlcmllc1tfaWRdLnRpY2tldHNbX29mZnNldCArIGldOwogICAgICAgICAgICBpZiAoYWRkciA9PSBfYWRkciAmJiBfYWRkciAhPSAwKSB7CiAgICAgICAgICAgICAgICBkZXRhaWxzW2ldID0gMjsKICAgICAgICAgICAgfSBlbHNlIGlmIChhZGRyICE9IDApIHsKICAgICAgICAgICAgICAgIGRldGFpbHNbaV0gPSAxOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZGV0YWlsc1tpXSA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RnVsbFRpY2tldERldGFpbHMoaW50IF9pZCwgdWludCBfb2Zmc2V0LCB1aW50IF9uKQogICAgICAgICAgICAgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzc1tdIGRldGFpbHMpIHsKICAgICAgICByZXF1aXJlKF9vZmZzZXQgKyBfbiA8PSBsb3R0ZXJpZXNbX2lkXS5udW1UaWNrZXRzKTsKCiAgICAgICAgZGV0YWlscyA9IG5ldyBhZGRyZXNzW10oX24pOwogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IF9uOyBpKyspIHsKICAgICAgICAgICAgZGV0YWlsc1tpXSA9IGxvdHRlcmllc1tfaWRdLnRpY2tldHNbX29mZnNldCArIGldOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBnZXRUaWNrZXRPd25lcihpbnQgX2lkLCB1aW50IF90aWNrZXQpIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MpIHsKICAgICAgICByZXF1aXJlKF9pZCA+PSAwKTsKICAgICAgICByZXR1cm4gbG90dGVyaWVzW19pZF0udGlja2V0c1tfdGlja2V0XTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRSZWNlbnRBY3Rpdml0eSgpCiAgICAgICAgICAgICBjb25zdGFudCByZXR1cm5zIChpbnQgX2lkLCB1aW50IF9pZHgsIHVpbnRbMTAwMF0gX3JlY2VudEFjdGl2aXR5KSB7CiAgICAgICAgX2lkID0gaWQ7CiAgICAgICAgX2lkeCA9IHJlY2VudEFjdGl2aXR5SWR4OwogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IHJlY2VudEFjdGl2aXR5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIF9yZWNlbnRBY3Rpdml0eVtpXSA9IHJlY2VudEFjdGl2aXR5W2ldOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBzZXRBZG1pbihhZGRyZXNzIF9hZG1pbikgb25seU93bmVyIHsKICAgICAgICBhZG1pbiA9IF9hZG1pbjsKICAgIH0KCiAgICBmdW5jdGlvbiBwcm9wb3NlT3duZXIoYWRkcmVzcyBfb3duZXIpIG9ubHlPd25lciB7CiAgICAgICAgcHJvcG9zZWRPd25lciA9IF9vd25lcjsKICAgIH0KCiAgICBmdW5jdGlvbiBhY2NlcHRPd25lcnNoaXAoKSB7CiAgICAgICAgcmVxdWlyZShwcm9wb3NlZE93bmVyICE9IDApOwogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBwcm9wb3NlZE93bmVyKTsKICAgICAgICBvd25lciA9IHByb3Bvc2VkT3duZXI7CiAgICB9Cn0='.
	

]
