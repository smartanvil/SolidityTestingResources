Class {
	#name : #SRTf9cf843153289ff2f6a3ad21dc52687a5906ac99,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTf9cf843153289ff2f6a3ad21dc52687a5906ac99 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgovLyBGaWxlOiBjb250cmFjdHMvQlRDLnNvbAoKLy8gQml0Y29pbiB0cmFuc2FjdGlvbiBwYXJzaW5nIGxpYnJhcnkKCi8vIENvcHlyaWdodCAyMDE2IHJhaW4gPGh0dHBzOi8va2V5YmFzZS5pby9yYWluPgovLwovLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgovLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKLy8KLy8gICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKLy8KLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQovLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAovLyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAovLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCi8vIGh0dHBzOi8vZW4uYml0Y29pbi5pdC93aWtpL1Byb3RvY29sX2RvY3VtZW50YXRpb24jdHgKLy8KLy8gUmF3IEJpdGNvaW4gdHJhbnNhY3Rpb24gc3RydWN0dXJlOgovLwovLyBmaWVsZCAgICAgfCBzaXplIHwgdHlwZSAgICAgfCBkZXNjcmlwdGlvbgovLyB2ZXJzaW9uICAgfCA0ICAgIHwgaW50MzIgICAgfCB0cmFuc2FjdGlvbiB2ZXJzaW9uIG51bWJlcgovLyBuX3R4X2luICAgfCAxLTkgIHwgdmFyX2ludCAgfCBudW1iZXIgb2YgdHJhbnNhY3Rpb24gaW5wdXRzCi8vIHR4X2luICAgICB8IDQxKyAgfCB0eF9pbltdICB8IGxpc3Qgb2YgdHJhbnNhY3Rpb24gaW5wdXRzCi8vIG5fdHhfb3V0ICB8IDEtOSAgfCB2YXJfaW50ICB8IG51bWJlciBvZiB0cmFuc2FjdGlvbiBvdXRwdXRzCi8vIHR4X291dCAgICB8IDkrICAgfCB0eF9vdXRbXSB8IGxpc3Qgb2YgdHJhbnNhY3Rpb24gb3V0cHV0cwovLyBsb2NrX3RpbWUgfCA0ICAgIHwgdWludDMyICAgfCBibG9jayBudW1iZXIgLyB0aW1lc3RhbXAgYXQgd2hpY2ggdHggbG9ja2VkCi8vCi8vIFRyYW5zYWN0aW9uIGlucHV0ICh0eF9pbikgc3RydWN0dXJlOgovLwovLyBmaWVsZCAgICAgIHwgc2l6ZSB8IHR5cGUgICAgIHwgZGVzY3JpcHRpb24KLy8gcHJldmlvdXMgICB8IDM2ICAgfCBvdXRwb2ludCB8IFByZXZpb3VzIG91dHB1dCB0cmFuc2FjdGlvbiByZWZlcmVuY2UKLy8gc2NyaXB0X2xlbiB8IDEtOSAgfCB2YXJfaW50ICB8IExlbmd0aCBvZiB0aGUgc2lnbmF0dXJlIHNjcmlwdAovLyBzaWdfc2NyaXB0IHwgPyAgICB8IHVjaGFyW10gIHwgU2NyaXB0IGZvciBjb25maXJtaW5nIHRyYW5zYWN0aW9uIGF1dGhvcml6YXRpb24KLy8gc2VxdWVuY2UgICB8IDQgICAgfCB1aW50MzIgICB8IFNlbmRlciB0cmFuc2FjdGlvbiB2ZXJzaW9uCi8vCi8vIE91dFBvaW50IHN0cnVjdHVyZToKLy8KLy8gZmllbGQgICAgICB8IHNpemUgfCB0eXBlICAgICB8IGRlc2NyaXB0aW9uCi8vIGhhc2ggICAgICAgfCAzMiAgIHwgY2hhclszMl0gfCBUaGUgaGFzaCBvZiB0aGUgcmVmZXJlbmNlZCB0cmFuc2FjdGlvbgovLyBpbmRleCAgICAgIHwgNCAgICB8IHVpbnQzMiAgIHwgVGhlIGluZGV4IG9mIHRoaXMgb3V0cHV0IGluIHRoZSByZWZlcmVuY2VkIHRyYW5zYWN0aW9uCi8vCi8vIFRyYW5zYWN0aW9uIG91dHB1dCAodHhfb3V0KSBzdHJ1Y3R1cmU6Ci8vCi8vIGZpZWxkICAgICAgICAgfCBzaXplIHwgdHlwZSAgICAgfCBkZXNjcmlwdGlvbgovLyB2YWx1ZSAgICAgICAgIHwgOCAgICB8IGludDY0ICAgIHwgVHJhbnNhY3Rpb24gdmFsdWUgKFNhdG9zaGlzKQovLyBwa19zY3JpcHRfbGVuIHwgMS05ICB8IHZhcl9pbnQgIHwgTGVuZ3RoIG9mIHRoZSBwdWJsaWMga2V5IHNjcmlwdAovLyBwa19zY3JpcHQgICAgIHwgPyAgICB8IHVjaGFyW10gIHwgUHVibGljIGtleSBhcyBhIEJpdGNvaW4gc2NyaXB0LgovLwovLyBWYXJpYWJsZSBpbnRlZ2VycyAodmFyX2ludCkgY2FuIGJlIGVuY29kZWQgZGlmZmVyZW50bHkgZGVwZW5kaW5nCi8vIG9uIHRoZSByZXByZXNlbnRlZCB2YWx1ZSwgdG8gc2F2ZSBzcGFjZS4gVmFyaWFibGUgaW50ZWdlcnMgYWx3YXlzCi8vIHByZWNlZGUgYW4gYXJyYXkgb2YgYSB2YXJpYWJsZSBsZW5ndGggZGF0YSB0eXBlIChlLmcuIHR4X2luKS4KLy8KLy8gVmFyaWFibGUgaW50ZWdlciBlbmNvZGluZ3MgYXMgYSBmdW5jdGlvbiBvZiByZXByZXNlbnRlZCB2YWx1ZToKLy8KLy8gdmFsdWUgICAgICAgICAgIHwgYnl0ZXMgIHwgZm9ybWF0Ci8vIDwweEZEICgyNTMpICAgICB8IDEgICAgICB8IHVpbnQ4Ci8vIDw9MHhGRkZGICg2NTUzNSl8IDMgICAgICB8IDB4RkQgZm9sbG93ZWQgYnkgbGVuZ3RoIGFzIHVpbnQxNgovLyA8PTB4RkZGRiBGRkZGICAgfCA1ICAgICAgfCAweEZFIGZvbGxvd2VkIGJ5IGxlbmd0aCBhcyB1aW50MzIKLy8gLSAgICAgICAgICAgICAgIHwgOSAgICAgIHwgMHhGRiBmb2xsb3dlZCBieSBsZW5ndGggYXMgdWludDY0Ci8vCi8vIFB1YmxpYyBrZXkgc2NyaXB0cyBgcGtfc2NyaXB0YCBhcmUgc2V0IG9uIHRoZSBvdXRwdXQgYW5kIGNhbgovLyB0YWtlIGEgbnVtYmVyIG9mIGZvcm1zLiBUaGUgcmVndWxhciB0cmFuc2FjdGlvbiBzY3JpcHQgaXMKLy8gY2FsbGVkICdwYXktdG8tcHVia2V5LWhhc2gnIChQMlBLSCk6Ci8vCi8vIE9QX0RVUCBPUF9IQVNIMTYwIDxwdWJLZXlIYXNoPiBPUF9FUVVBTFZFUklGWSBPUF9DSEVDS1NJRwovLwovLyBPUF94IGFyZSBCaXRjb2luIHNjcmlwdCBvcGNvZGVzLiBUaGUgYnl0ZXMgcmVwcmVzZW50YXRpb24gKGluY2x1ZGluZwovLyB0aGUgMHgxNCAyMC1ieXRlIHN0YWNrIHB1c2gpIGlzOgovLwovLyAweDc2IDB4QTkgMHgxNCA8cHViS2V5SGFzaD4gMHg4OCAweEFDCi8vCi8vIFRoZSA8cHViS2V5SGFzaD4gaXMgdGhlIHJpcGVtZDE2MCBoYXNoIG9mIHRoZSBzaGEyNTYgaGFzaCBvZgovLyB0aGUgcHVibGljIGtleSwgcHJlY2VkZWQgYnkgYSBuZXR3b3JrIHZlcnNpb24gYnl0ZS4gKDIxIGJ5dGVzIHRvdGFsKQovLwovLyBOZXR3b3JrIHZlcnNpb24gYnl0ZXM6IDB4MDAgKG1haW5uZXQpOyAweDZmICh0ZXN0bmV0KTsgMHgzNCAobmFtZWNvaW4pCi8vCi8vIFRoZSBCaXRjb2luIGFkZHJlc3MgaXMgZGVyaXZlZCBmcm9tIHRoZSBwdWJLZXlIYXNoLiBUaGUgYmluYXJ5IGZvcm0gaXMgdGhlCi8vIHB1YktleUhhc2gsIHBsdXMgYSBjaGVja3N1bSBhdCB0aGUgZW5kLiAgVGhlIGNoZWNrc3VtIGlzIHRoZSBmaXJzdCA0IGJ5dGVzCi8vIG9mIHRoZSAoMzIgYnl0ZSkgZG91YmxlIHNoYTI1NiBvZiB0aGUgcHViS2V5SGFzaC4gKDI1IGJ5dGVzIHRvdGFsKQovLyBUaGlzIGlzIGNvbnZlcnRlZCB0byBiYXNlNTggdG8gZm9ybSB0aGUgcHVibGljbHkgdXNlZCBCaXRjb2luIGFkZHJlc3MuCi8vIE1haW5uZXQgUDJQS0ggdHJhbnNhY3Rpb24gc2NyaXB0cyBhcmUgdG8gYWRkcmVzc2VzIGJlZ2lubmluZyB3aXRoICcxJy4KLy8KLy8gUDJTSCAoJ3BheSB0byBzY3JpcHQgaGFzaCcpIHNjcmlwdHMgb25seSBzdXBwbHkgYSBzY3JpcHQgaGFzaC4gVGhlIHNwZW5kZXIKLy8gbXVzdCB0aGVuIHByb3ZpZGUgdGhlIHNjcmlwdCB0aGF0IHdvdWxkIGFsbG93IHRoZW0gdG8gcmVkZWVtIHRoaXMgb3V0cHV0LgovLyBUaGlzIGFsbG93cyBmb3IgYXJiaXRyYXJpbHkgY29tcGxleCBzY3JpcHRzIHRvIGJlIGZ1bmRlZCB1c2luZyBvbmx5IGEKLy8gaGFzaCBvZiB0aGUgc2NyaXB0LCBhbmQgbW92ZXMgdGhlIG9udXMgb24gcHJvdmlkaW5nIHRoZSBzY3JpcHQgZnJvbQovLyB0aGUgc3BlbmRlciB0byB0aGUgcmVkZWVtZXIuCi8vCi8vIFRoZSBQMlNIIHNjcmlwdCBmb3JtYXQgaXMgc2ltcGxlOgovLwovLyBPUF9IQVNIMTYwIDxzY3JpcHRIYXNoPiBPUF9FUVVBTAovLwovLyAweEE5IDB4MTQgPHNjcmlwdEhhc2g+IDB4ODcKLy8KLy8gVGhlIDxzY3JpcHRIYXNoPiBpcyB0aGUgcmlwZW1kMTYwIGhhc2ggb2YgdGhlIHNoYTI1NiBoYXNoIG9mIHRoZQovLyByZWRlZW0gc2NyaXB0LiBUaGUgUDJTSCBhZGRyZXNzIGlzIGRlcml2ZWQgZnJvbSB0aGUgc2NyaXB0SGFzaC4KLy8gQWRkcmVzc2VzIGFyZSB0aGUgc2NyaXB0SGFzaCB3aXRoIGEgdmVyc2lvbiBwcmVmaXggb2YgNSwgZW5jb2RlZCBhcwovLyBCYXNlNThjaGVjay4gVGhlc2UgYWRkcmVzc2VzIGJlZ2luIHdpdGggYSAnMycuCgovLyBwYXJzZSBhIHJhdyBiaXRjb2luIHRyYW5zYWN0aW9uIGJ5dGUgYXJyYXkKbGlicmFyeSBCVEMgewogICAgLy8gQ29udmVydCBhIHZhcmlhYmxlIGludGVnZXIgaW50byBzb21ldGhpbmcgdXNlZnVsIGFuZCByZXR1cm4gaXQgYW5kCiAgICAvLyB0aGUgaW5kZXggdG8gYWZ0ZXIgaXQuCiAgICBmdW5jdGlvbiBwYXJzZVZhckludChieXRlcyB0eEJ5dGVzLCB1aW50IHBvcykgcmV0dXJucyAodWludCwgdWludCkgewogICAgICAgIC8vIHRoZSBmaXJzdCBieXRlIHRlbGxzIHVzIGhvdyBiaWcgdGhlIGludGVnZXIgaXMKICAgICAgICB2YXIgaWJpdCA9IHVpbnQ4KHR4Qnl0ZXNbcG9zXSk7CiAgICAgICAgcG9zICs9IDE7ICAvLyBza2lwIGliaXQKCiAgICAgICAgaWYgKGliaXQgPCAweGZkKSB7CiAgICAgICAgICAgIHJldHVybiAoaWJpdCwgcG9zKTsKICAgICAgICB9IGVsc2UgaWYgKGliaXQgPT0gMHhmZCkgewogICAgICAgICAgICByZXR1cm4gKGdldEJ5dGVzTEUodHhCeXRlcywgcG9zLCAxNiksIHBvcyArIDIpOwogICAgICAgIH0gZWxzZSBpZiAoaWJpdCA9PSAweGZlKSB7CiAgICAgICAgICAgIHJldHVybiAoZ2V0Qnl0ZXNMRSh0eEJ5dGVzLCBwb3MsIDMyKSwgcG9zICsgNCk7CiAgICAgICAgfSBlbHNlIGlmIChpYml0ID09IDB4ZmYpIHsKICAgICAgICAgICAgcmV0dXJuIChnZXRCeXRlc0xFKHR4Qnl0ZXMsIHBvcywgNjQpLCBwb3MgKyA4KTsKICAgICAgICB9CiAgICB9CiAgICAvLyBjb252ZXJ0IGxpdHRsZSBlbmRpYW4gYnl0ZXMgdG8gdWludAogICAgZnVuY3Rpb24gZ2V0Qnl0ZXNMRShieXRlcyBkYXRhLCB1aW50IHBvcywgdWludCBiaXRzKSByZXR1cm5zICh1aW50KSB7CiAgICAgICAgaWYgKGJpdHMgPT0gOCkgewogICAgICAgICAgICByZXR1cm4gdWludDgoZGF0YVtwb3NdKTsKICAgICAgICB9IGVsc2UgaWYgKGJpdHMgPT0gMTYpIHsKICAgICAgICAgICAgcmV0dXJuIHVpbnQxNihkYXRhW3Bvc10pCiAgICAgICAgICAgICAgICAgKyB1aW50MTYoZGF0YVtwb3MgKyAxXSkgKiAyICoqIDg7CiAgICAgICAgfSBlbHNlIGlmIChiaXRzID09IDMyKSB7CiAgICAgICAgICAgIHJldHVybiB1aW50MzIoZGF0YVtwb3NdKQogICAgICAgICAgICAgICAgICsgdWludDMyKGRhdGFbcG9zICsgMV0pICogMiAqKiA4CiAgICAgICAgICAgICAgICAgKyB1aW50MzIoZGF0YVtwb3MgKyAyXSkgKiAyICoqIDE2CiAgICAgICAgICAgICAgICAgKyB1aW50MzIoZGF0YVtwb3MgKyAzXSkgKiAyICoqIDI0OwogICAgICAgIH0gZWxzZSBpZiAoYml0cyA9PSA2NCkgewogICAgICAgICAgICByZXR1cm4gdWludDY0KGRhdGFbcG9zXSkKICAgICAgICAgICAgICAgICArIHVpbnQ2NChkYXRhW3BvcyArIDFdKSAqIDIgKiogOAogICAgICAgICAgICAgICAgICsgdWludDY0KGRhdGFbcG9zICsgMl0pICogMiAqKiAxNgogICAgICAgICAgICAgICAgICsgdWludDY0KGRhdGFbcG9zICsgM10pICogMiAqKiAyNAogICAgICAgICAgICAgICAgICsgdWludDY0KGRhdGFbcG9zICsgNF0pICogMiAqKiAzMgogICAgICAgICAgICAgICAgICsgdWludDY0KGRhdGFbcG9zICsgNV0pICogMiAqKiA0MAogICAgICAgICAgICAgICAgICsgdWludDY0KGRhdGFbcG9zICsgNl0pICogMiAqKiA0OAogICAgICAgICAgICAgICAgICsgdWludDY0KGRhdGFbcG9zICsgN10pICogMiAqKiA1NjsKICAgICAgICB9CiAgICB9CiAgICAvLyBzY2FuIHRoZSBmdWxsIHRyYW5zYWN0aW9uIGJ5dGVzIGFuZCByZXR1cm4gdGhlIGZpcnN0IHR3byBvdXRwdXQKICAgIC8vIHZhbHVlcyAoaW4gc2F0b3NoaXMpIGFuZCBhZGRyZXNzZXMgKGluIGJpbmFyeSkKICAgIGZ1bmN0aW9uIGdldEZpcnN0VHdvT3V0cHV0cyhieXRlcyB0eEJ5dGVzKQogICAgICAgICAgICAgcmV0dXJucyAodWludCwgYnl0ZXMyMCwgdWludCwgYnl0ZXMyMCkKICAgIHsKICAgICAgICB1aW50IHBvczsKICAgICAgICB1aW50W10gbWVtb3J5IGlucHV0X3NjcmlwdF9sZW5zID0gbmV3IHVpbnRbXSgyKTsKICAgICAgICB1aW50W10gbWVtb3J5IG91dHB1dF9zY3JpcHRfbGVucyA9IG5ldyB1aW50W10oMik7CiAgICAgICAgdWludFtdIG1lbW9yeSBzY3JpcHRfc3RhcnRzID0gbmV3IHVpbnRbXSgyKTsKICAgICAgICB1aW50W10gbWVtb3J5IG91dHB1dF92YWx1ZXMgPSBuZXcgdWludFtdKDIpOwogICAgICAgIGJ5dGVzMjBbXSBtZW1vcnkgb3V0cHV0X2FkZHJlc3NlcyA9IG5ldyBieXRlczIwW10oMik7CgogICAgICAgIHBvcyA9IDQ7ICAvLyBza2lwIHZlcnNpb24KCiAgICAgICAgKGlucHV0X3NjcmlwdF9sZW5zLCBwb3MpID0gc2NhbklucHV0cyh0eEJ5dGVzLCBwb3MsIDApOwoKICAgICAgICAob3V0cHV0X3ZhbHVlcywgc2NyaXB0X3N0YXJ0cywgb3V0cHV0X3NjcmlwdF9sZW5zLCBwb3MpID0gc2Nhbk91dHB1dHModHhCeXRlcywgcG9zLCAyKTsKCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgMjsgaSsrKSB7CiAgICAgICAgICAgIHZhciBwa2hhc2ggPSBwYXJzZU91dHB1dFNjcmlwdCh0eEJ5dGVzLCBzY3JpcHRfc3RhcnRzW2ldLCBvdXRwdXRfc2NyaXB0X2xlbnNbaV0pOwogICAgICAgICAgICBvdXRwdXRfYWRkcmVzc2VzW2ldID0gcGtoYXNoOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIChvdXRwdXRfdmFsdWVzWzBdLCBvdXRwdXRfYWRkcmVzc2VzWzBdLAogICAgICAgICAgICAgICAgb3V0cHV0X3ZhbHVlc1sxXSwgb3V0cHV0X2FkZHJlc3Nlc1sxXSk7CiAgICB9CiAgICAvLyBDaGVjayB3aGV0aGVyIGBidGNBZGRyZXNzYCBpcyBpbiB0aGUgdHJhbnNhY3Rpb24gb3V0cHV0cyAqYW5kKgogICAgLy8gd2hldGhlciAqYXQgbGVhc3QqIGB2YWx1ZWAgaGFzIGJlZW4gc2VudCB0byBpdC4KICAgICAgICAvLyBDaGVjayB3aGV0aGVyIGBidGNBZGRyZXNzYCBpcyBpbiB0aGUgdHJhbnNhY3Rpb24gb3V0cHV0cyAqYW5kKgogICAgLy8gd2hldGhlciAqYXQgbGVhc3QqIGB2YWx1ZWAgaGFzIGJlZW4gc2VudCB0byBpdC4KICAgIGZ1bmN0aW9uIGNoZWNrVmFsdWVTZW50KGJ5dGVzIHR4Qnl0ZXMsIGJ5dGVzMjAgYnRjQWRkcmVzcywgdWludCB2YWx1ZSkKICAgICAgICAgICAgIHJldHVybnMgKGJvb2wsdWludCkKICAgIHsKICAgICAgICB1aW50IHBvcyA9IDQ7ICAvLyBza2lwIHZlcnNpb24KICAgICAgICAoLCBwb3MpID0gc2NhbklucHV0cyh0eEJ5dGVzLCBwb3MsIDApOyAgLy8gZmluZCBlbmQgb2YgaW5wdXRzCgogICAgICAgIC8vIHNjYW4gKmFsbCogdGhlIG91dHB1dHMgYW5kIGZpbmQgd2hlcmUgdGhleSBhcmUKICAgICAgICB2YXIgKG91dHB1dF92YWx1ZXMsIHNjcmlwdF9zdGFydHMsIG91dHB1dF9zY3JpcHRfbGVucywpID0gc2Nhbk91dHB1dHModHhCeXRlcywgcG9zLCAwKTsKCiAgICAgICAgLy8gbG9vayBhdCBlYWNoIG91dHB1dCBhbmQgY2hlY2sgd2hldGhlciBpdCBhdCBsZWFzdCB2YWx1ZSB0byBidGNBZGRyZXNzCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgb3V0cHV0X3ZhbHVlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB2YXIgcGtoYXNoID0gcGFyc2VPdXRwdXRTY3JpcHQodHhCeXRlcywgc2NyaXB0X3N0YXJ0c1tpXSwgb3V0cHV0X3NjcmlwdF9sZW5zW2ldKTsKICAgICAgICAgICAgaWYgKHBraGFzaCA9PSBidGNBZGRyZXNzICYmIG91dHB1dF92YWx1ZXNbaV0gPj0gdmFsdWUpIHsKICAgICAgICAgICAgICAgIHJldHVybiAodHJ1ZSxvdXRwdXRfdmFsdWVzW2ldKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIC8vIHNjYW4gdGhlIGlucHV0cyBhbmQgZmluZCB0aGUgc2NyaXB0IGxlbmd0aHMuCiAgICAvLyByZXR1cm4gYW4gYXJyYXkgb2Ygc2NyaXB0IGxlbmd0aHMgYW5kIHRoZSBlbmQgcG9zaXRpb24KICAgIC8vIG9mIHRoZSBpbnB1dHMuCiAgICAvLyB0YWtlcyBhICdzdG9wJyBhcmd1bWVudCB3aGljaCBzZXRzIHRoZSBtYXhpbXVtIG51bWJlciBvZgogICAgLy8gb3V0cHV0cyB0byBzY2FuIHRocm91Z2guIHN0b3A9MCA9PiBzY2FuIGFsbC4KICAgIGZ1bmN0aW9uIHNjYW5JbnB1dHMoYnl0ZXMgdHhCeXRlcywgdWludCBwb3MsIHVpbnQgc3RvcCkKICAgICAgICAgICAgIHJldHVybnMgKHVpbnRbXSwgdWludCkKICAgIHsKICAgICAgICB1aW50IG5faW5wdXRzOwogICAgICAgIHVpbnQgaGFsdDsKICAgICAgICB1aW50IHNjcmlwdF9sZW47CgogICAgICAgIChuX2lucHV0cywgcG9zKSA9IHBhcnNlVmFySW50KHR4Qnl0ZXMsIHBvcyk7CgogICAgICAgIGlmIChzdG9wID09IDAgfHwgc3RvcCA+IG5faW5wdXRzKSB7CiAgICAgICAgICAgIGhhbHQgPSBuX2lucHV0czsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBoYWx0ID0gc3RvcDsKICAgICAgICB9CgogICAgICAgIHVpbnRbXSBtZW1vcnkgc2NyaXB0X2xlbnMgPSBuZXcgdWludFtdKGhhbHQpOwoKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhhbHQ7IGkrKykgewogICAgICAgICAgICBwb3MgKz0gMzY7ICAvLyBza2lwIG91dHBvaW50CiAgICAgICAgICAgIChzY3JpcHRfbGVuLCBwb3MpID0gcGFyc2VWYXJJbnQodHhCeXRlcywgcG9zKTsKICAgICAgICAgICAgc2NyaXB0X2xlbnNbaV0gPSBzY3JpcHRfbGVuOwogICAgICAgICAgICBwb3MgKz0gc2NyaXB0X2xlbiArIDQ7ICAvLyBza2lwIHNpZ19zY3JpcHQsIHNlcQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIChzY3JpcHRfbGVucywgcG9zKTsKICAgIH0KICAgIC8vIHNjYW4gdGhlIG91dHB1dHMgYW5kIGZpbmQgdGhlIHZhbHVlcyBhbmQgc2NyaXB0IGxlbmd0aHMuCiAgICAvLyByZXR1cm4gYXJyYXkgb2YgdmFsdWVzLCBhcnJheSBvZiBzY3JpcHQgbGVuZ3RocyBhbmQgdGhlCiAgICAvLyBlbmQgcG9zaXRpb24gb2YgdGhlIG91dHB1dHMuCiAgICAvLyB0YWtlcyBhICdzdG9wJyBhcmd1bWVudCB3aGljaCBzZXRzIHRoZSBtYXhpbXVtIG51bWJlciBvZgogICAgLy8gb3V0cHV0cyB0byBzY2FuIHRocm91Z2guIHN0b3A9MCA9PiBzY2FuIGFsbC4KICAgIGZ1bmN0aW9uIHNjYW5PdXRwdXRzKGJ5dGVzIHR4Qnl0ZXMsIHVpbnQgcG9zLCB1aW50IHN0b3ApCiAgICAgICAgICAgICByZXR1cm5zICh1aW50W10sIHVpbnRbXSwgdWludFtdLCB1aW50KQogICAgewogICAgICAgIHVpbnQgbl9vdXRwdXRzOwogICAgICAgIHVpbnQgaGFsdDsKICAgICAgICB1aW50IHNjcmlwdF9sZW47CgogICAgICAgIChuX291dHB1dHMsIHBvcykgPSBwYXJzZVZhckludCh0eEJ5dGVzLCBwb3MpOwoKICAgICAgICBpZiAoc3RvcCA9PSAwIHx8IHN0b3AgPiBuX291dHB1dHMpIHsKICAgICAgICAgICAgaGFsdCA9IG5fb3V0cHV0czsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBoYWx0ID0gc3RvcDsKICAgICAgICB9CgogICAgICAgIHVpbnRbXSBtZW1vcnkgc2NyaXB0X3N0YXJ0cyA9IG5ldyB1aW50W10oaGFsdCk7CiAgICAgICAgdWludFtdIG1lbW9yeSBzY3JpcHRfbGVucyA9IG5ldyB1aW50W10oaGFsdCk7CiAgICAgICAgdWludFtdIG1lbW9yeSBvdXRwdXRfdmFsdWVzID0gbmV3IHVpbnRbXShoYWx0KTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoYWx0OyBpKyspIHsKICAgICAgICAgICAgb3V0cHV0X3ZhbHVlc1tpXSA9IGdldEJ5dGVzTEUodHhCeXRlcywgcG9zLCA2NCk7CiAgICAgICAgICAgIHBvcyArPSA4OwoKICAgICAgICAgICAgKHNjcmlwdF9sZW4sIHBvcykgPSBwYXJzZVZhckludCh0eEJ5dGVzLCBwb3MpOwogICAgICAgICAgICBzY3JpcHRfc3RhcnRzW2ldID0gcG9zOwogICAgICAgICAgICBzY3JpcHRfbGVuc1tpXSA9IHNjcmlwdF9sZW47CiAgICAgICAgICAgIHBvcyArPSBzY3JpcHRfbGVuOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIChvdXRwdXRfdmFsdWVzLCBzY3JpcHRfc3RhcnRzLCBzY3JpcHRfbGVucywgcG9zKTsKICAgIH0KICAgIC8vIFNsaWNlIDIwIGNvbnRpZ3VvdXMgYnl0ZXMgZnJvbSBieXRlcyBgZGF0YWAsIHN0YXJ0aW5nIGF0IGBzdGFydGAKICAgIGZ1bmN0aW9uIHNsaWNlQnl0ZXMyMChieXRlcyBkYXRhLCB1aW50IHN0YXJ0KSByZXR1cm5zIChieXRlczIwKSB7CiAgICAgICAgdWludDE2MCBzbGljZSA9IDA7CiAgICAgICAgZm9yICh1aW50MTYwIGkgPSAwOyBpIDwgMjA7IGkrKykgewogICAgICAgICAgICBzbGljZSArPSB1aW50MTYwKGRhdGFbaSArIHN0YXJ0XSkgPDwgKDggKiAoMTkgLSBpKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBieXRlczIwKHNsaWNlKTsKICAgIH0KICAgIC8vIHJldHVybnMgdHJ1ZSBpZiB0aGUgYnl0ZXMgbG9jYXRlZCBpbiB0eEJ5dGVzIGJ5IHBvcyBhbmQKICAgIC8vIHNjcmlwdF9sZW4gcmVwcmVzZW50IGEgUDJQS0ggc2NyaXB0CiAgICBmdW5jdGlvbiBpc1AyUEtIKGJ5dGVzIHR4Qnl0ZXMsIHVpbnQgcG9zLCB1aW50IHNjcmlwdF9sZW4pIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gKHNjcmlwdF9sZW4gPT0gMjUpICAgICAgICAgICAvLyAyMCBieXRlIHB1YmtleWhhc2ggKyA1IGJ5dGVzIG9mIHNjcmlwdAogICAgICAgICAgICAmJiAodHhCeXRlc1twb3NdID09IDB4NzYpICAgICAgIC8vIE9QX0RVUAogICAgICAgICAgICAmJiAodHhCeXRlc1twb3MgKyAxXSA9PSAweGE5KSAgIC8vIE9QX0hBU0gxNjAKICAgICAgICAgICAgJiYgKHR4Qnl0ZXNbcG9zICsgMl0gPT0gMHgxNCkgICAvLyBieXRlcyB0byBwdXNoCiAgICAgICAgICAgICYmICh0eEJ5dGVzW3BvcyArIDIzXSA9PSAweDg4KSAgLy8gT1BfRVFVQUxWRVJJRlkKICAgICAgICAgICAgJiYgKHR4Qnl0ZXNbcG9zICsgMjRdID09IDB4YWMpOyAvLyBPUF9DSEVDS1NJRwogICAgfQogICAgLy8gcmV0dXJucyB0cnVlIGlmIHRoZSBieXRlcyBsb2NhdGVkIGluIHR4Qnl0ZXMgYnkgcG9zIGFuZAogICAgLy8gc2NyaXB0X2xlbiByZXByZXNlbnQgYSBQMlNIIHNjcmlwdAogICAgZnVuY3Rpb24gaXNQMlNIKGJ5dGVzIHR4Qnl0ZXMsIHVpbnQgcG9zLCB1aW50IHNjcmlwdF9sZW4pIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gKHNjcmlwdF9sZW4gPT0gMjMpICAgICAgICAgICAvLyAyMCBieXRlIHNjcmlwdGhhc2ggKyAzIGJ5dGVzIG9mIHNjcmlwdAogICAgICAgICAgICAmJiAodHhCeXRlc1twb3MgKyAwXSA9PSAweGE5KSAgIC8vIE9QX0hBU0gxNjAKICAgICAgICAgICAgJiYgKHR4Qnl0ZXNbcG9zICsgMV0gPT0gMHgxNCkgICAvLyBieXRlcyB0byBwdXNoCiAgICAgICAgICAgICYmICh0eEJ5dGVzW3BvcyArIDIyXSA9PSAweDg3KTsgLy8gT1BfRVFVQUwKICAgIH0KICAgIC8vIEdldCB0aGUgcHVia2V5aGFzaCAvIHNjcmlwdGhhc2ggZnJvbSBhbiBvdXRwdXQgc2NyaXB0LiBBc3N1bWVzCiAgICAvLyBwYXktdG8tcHVia2V5LWhhc2ggKFAyUEtIKSBvciBwYXktdG8tc2NyaXB0LWhhc2ggKFAyU0gpIG91dHB1dHMuCiAgICAvLyBSZXR1cm5zIHRoZSBwdWJrZXloYXNoLyBzY3JpcHRoYXNoLCBvciB6ZXJvIGlmIHVua25vd24gb3V0cHV0LgogICAgZnVuY3Rpb24gcGFyc2VPdXRwdXRTY3JpcHQoYnl0ZXMgdHhCeXRlcywgdWludCBwb3MsIHVpbnQgc2NyaXB0X2xlbikKICAgICAgICAgICAgIHJldHVybnMgKGJ5dGVzMjApCiAgICB7CiAgICAgICAgaWYgKGlzUDJQS0godHhCeXRlcywgcG9zLCBzY3JpcHRfbGVuKSkgewogICAgICAgICAgICByZXR1cm4gc2xpY2VCeXRlczIwKHR4Qnl0ZXMsIHBvcyArIDMpOwogICAgICAgIH0gZWxzZSBpZiAoaXNQMlNIKHR4Qnl0ZXMsIHBvcywgc2NyaXB0X2xlbikpIHsKICAgICAgICAgICAgcmV0dXJuIHNsaWNlQnl0ZXMyMCh0eEJ5dGVzLCBwb3MgKyAyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgfQp9CgovLyBGaWxlOiBjb250cmFjdHMvT3duYWJsZS5zb2wKCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwogIGFkZHJlc3MgcHVibGljIG93bmVyMTsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjI7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXIzOwoKICBmdW5jdGlvbiBPd25hYmxlKCkgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCiAgICBmdW5jdGlvbiBPd25hYmxlMSgpIHsKICAgIG93bmVyMSA9IG1zZy5zZW5kZXI7CiAgfQoKICAgIGZ1bmN0aW9uIE93bmFibGUyKCkgewogICAgb3duZXIyID0gbXNnLnNlbmRlcjsKICB9CgogICAgZnVuY3Rpb24gT3duYWJsZTMoKSB7CiAgICBvd25lcjMgPSBtc2cuc2VuZGVyOwogIH0KCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgaWYgKG1zZy5zZW5kZXIgPT0gb3duZXIpCiAgICAgIF87CiAgfQoKICBtb2RpZmllciBvbmx5T3duZXIxKCkgewogICAgaWYgKG1zZy5zZW5kZXIgPT0gb3duZXIxKQogICAgICBfOwogIH0KCiAgbW9kaWZpZXIgb25seU93bmVyMigpIHsKICAgIGlmIChtc2cuc2VuZGVyID09IG93bmVyMikKICAgICAgXzsKICB9CgogIG1vZGlmaWVyIG9ubHlPd25lcjMoKSB7CiAgICBpZiAobXNnLnNlbmRlciA9PSBvd25lcjMpCiAgICAgIF87CiAgfQoKICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgewogICAgaWYgKG5ld093bmVyICE9IGFkZHJlc3MoMCkpIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKLy8gRmlsZTogY29udHJhY3RzL1BhdXNhYmxlLnNvbAoKLyoKICogUGF1c2FibGUKICogQWJzdHJhY3QgY29udHJhY3QgdGhhdCBhbGxvd3MgY2hpbGRyZW4gdG8gaW1wbGVtZW50IGFuCiAqIGVtZXJnZW5jeSBzdG9wIG1lY2hhbmlzbS4KICovCgpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKICBib29sIHB1YmxpYyBzdG9wcGVkOwoKICBtb2RpZmllciBzdG9wSW5FbWVyZ2VuY3kgewogICAgaWYgKHN0b3BwZWQpIHsKICAgICAgdGhyb3c7CiAgICB9CiAgICBfOwogIH0KICAKICBtb2RpZmllciBvbmx5SW5FbWVyZ2VuY3kgewogICAgaWYgKCFzdG9wcGVkKSB7CiAgICAgIHRocm93OwogICAgfQogICAgXzsKICB9CgogIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW1lcmdlbmN5LCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlCiAgZnVuY3Rpb24gZW1lcmdlbmN5U3RvcCgpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICBzdG9wcGVkID0gdHJ1ZTsKICB9CgogIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW5kIG9mIGVtZXJnZW5jeSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICBmdW5jdGlvbiByZWxlYXNlKCkgZXh0ZXJuYWwgb25seU93bmVyIG9ubHlJbkVtZXJnZW5jeSB7CiAgICBzdG9wcGVkID0gZmFsc2U7CiAgfQoKfQoKLy8gRmlsZTogY29udHJhY3RzL1NhZmVNYXRoLnNvbAoKLyoqCiAqIE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MKICovCmNvbnRyYWN0IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBzYWZlTXVsKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICB1aW50IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHNhZmVEaXYodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIGFzc2VydChiID4gMCk7CiAgICB1aW50IGMgPSBhIC8gYjsKICAgIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzYWZlU3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIHNhZmVBZGQodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIHVpbnQgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGM+PWEgJiYgYz49Yik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIG1heDY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7CiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7CiAgfQoKICBmdW5jdGlvbiBtaW42NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgewogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7CiAgfQoKICBmdW5jdGlvbiBtYXgyNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBhID49IGIgPyBhIDogYjsKICB9CgogIGZ1bmN0aW9uIG1pbjI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7CiAgfQoKfQoKLy8gRmlsZTogY29udHJhY3RzL1N0YW5kYXJkVG9rZW4uc29sCgpjb250cmFjdCBUb2tlbiB7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOwogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKfQoKCi8qICBFUkMgMjAgdG9rZW4gKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBUb2tlbiB7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIF92YWx1ZSA+IDApIHsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgIGlmIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7CiAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7CiAgICAgICAgYmFsYW5jZXNbX2Zyb21dIC09IF92YWx1ZTsKICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CgoKfQoKLy8gRmlsZTogY29udHJhY3RzL1V0aWxzLnNvbAoKY29udHJhY3QgVXRpbHN7CgoJLy92ZXJpZmllcyB0aGUgYW1vdW50IGdyZWF0ZXIgdGhhbiB6ZXJvCgoJbW9kaWZpZXIgZ3JlYXRlclRoYW5aZXJvKHVpbnQyNTYgX3ZhbHVlKXsKCQlyZXF1aXJlKF92YWx1ZT4wKTsKCQlfOwoJfQoKCS8vL3ZlcmlmaWVzIGFuIGFkZHJlc3MKCgltb2RpZmllciB2YWxpZEFkZHJlc3MoYWRkcmVzcyBfYWRkKXsKCQlyZXF1aXJlKF9hZGQhPTB4MCk7CgkJXzsKCX0KfQoKLy8gRmlsZTogY29udHJhY3RzL0Nyb3dkc2FsZS5zb2wKCmNvbnRyYWN0IENyb3dkc2FsZSBpcyBTdGFuZGFyZFRva2VuLCBQYXVzYWJsZSwgU2FmZU1hdGgsIFV0aWxzewoJc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIk11ZHJhIjsKCXN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIk1EUiI7Cgl1aW50MjU2IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwoJc3RyaW5nIHB1YmxpYyB2ZXJzaW9uID0gIjEuMCI7Cglib29sIHB1YmxpYyB0cmFkaW5nU3RhcnRlZCA9IGZhbHNlOwoKICAgIC8qKgogICAqIEBkZXYgbW9kaWZpZXIgdGhhdCB0aHJvd3MgaWYgdHJhZGluZyBoYXMgbm90IHN0YXJ0ZWQgeWV0CiAgICovCiAgIG1vZGlmaWVyIGhhc1N0YXJ0ZWRUcmFkaW5nKCkgewogICAJcmVxdWlyZSh0cmFkaW5nU3RhcnRlZCk7CiAgIAlfOwogICB9CiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIG93bmVyIHRvIGVuYWJsZSB0aGUgdHJhZGluZy4gVGhpcyBjYW4gbm90IGJlIHVuZG9uZQogICAqLwogICBmdW5jdGlvbiBzdGFydFRyYWRpbmcoKSBvbmx5KGZpbmFsT3duZXIpIHsKICAgCXRyYWRpbmdTdGFydGVkID0gdHJ1ZTsKICAgfQoKICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBoYXNTdGFydGVkVHJhZGluZyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHtzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7fQoKICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgaGFzU3RhcnRlZFRyYWRpbmcgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7c3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7fQoKICAgZW51bSBTdGF0ZXsKICAgCUluYWN0aXZlLAogICAJRnVuZGluZywKICAgCVN1Y2Nlc3MsCiAgIAlGYWlsdXJlCiAgIH0KCiAgIG1vZGlmaWVyIG9ubHkoYWRkcmVzcyBhbGxvd2VkKSB7CiAgIAlpZiAobXNnLnNlbmRlciAhPSBhbGxvd2VkKSB0aHJvdzsKICAgCV87CiAgIH0KCiAgIHVpbnQyNTYgcHVibGljIGludmVzdG1lbnRFVEg7CiAgIHVpbnQyNTYgcHVibGljIGludmVzdG1lbnRCVEM7CiAgIG1hcHBpbmcodWludDI1NiA9PiBib29sKSB0cmFuc2FjdGlvbnNDbGFpbWVkOwogICB1aW50MjU2IHB1YmxpYyBpbml0aWFsU3VwcGx5OwogICBhZGRyZXNzIGZpbmFsT3duZXI7CiAgIGFkZHJlc3Mgd2FsbGV0OwogICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBfdG90YWxTdXBwbHkgPSAxMDAgKiAoMTAqKjYpICogMTAgKiogZGVjaW1hbHM7IC8vIDEwME0gfiAxMCBDcm9yZXMKICAgdWludDI1NiBwdWJsaWMgZnVuZGluZ1N0YXJ0QmxvY2s7IC8vIGNyb3dkc2FsZSBzdGFydCBibG9jawogICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBtaW5CdGNWYWx1ZSA9IDEwMDAwOyAvLyB+IGFwcHJveCAxJAogICB1aW50MjU2IHB1YmxpYyB0b2tlbnNQZXJFdGhlciA9IDQ2MDsgLy8gMSBFVEggPSA0NjAgdG9rZW5zCiAgIHVpbnQyNTYgcHVibGljIHRva2Vuc1BlckJUQyA9IDExNSAqIDEwICoqIDEwICogMTAgKiogMjsgLy8gMSBidGMgPSAxMTUwMCBUb2tlbnMKICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgdG9rZW5DcmVhdGlvbk1heCA9IDEwICogKDEwKio2KSAqIDEwICoqIGRlY2ltYWxzOyAvLyAxME0gfiAxIENyb3JlcwogICBhZGRyZXNzW10gcHVibGljIGludmVzdG9yczsKCiAgIC8vZGlzcGxheXMgbnVtYmVyIG9mIHVuaXEgaW52ZXN0b3JzCiAgIGZ1bmN0aW9uIGludmVzdG9yc0NvdW50KCkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyh1aW50KSB7IHJldHVybiBpbnZlc3RvcnMubGVuZ3RoOyB9CgogICBmdW5jdGlvbiBDcm93ZHNhbGUodWludDI1NiBfZnVuZGluZ1N0YXJ0QmxvY2ssYWRkcmVzcyBvd25lcixhZGRyZXNzIF93YWxsZXQpewogICAJb3duZXIgPSBtc2cuc2VuZGVyOwogICAJZnVuZGluZ1N0YXJ0QmxvY2sgPV9mdW5kaW5nU3RhcnRCbG9jazsKICAgCXRvdGFsU3VwcGx5ID0gX3RvdGFsU3VwcGx5OwogICAJaW5pdGlhbFN1cHBseSA9IDA7CiAgIAlmaW5hbE93bmVyID0gb3duZXI7CiAgICAgIHdhbGxldCA9IF93YWxsZXQ7CgogICAgICAvL2NoZWNrIGNvbmZpZ3VyYXRpb24gaWYgc29tZXRoaW5nIGluIHNldHVwIGlzIGxvb2tpbmcgd2VpcmQKICAgICAgaWYgKAogICAgICAgdG9rZW5zUGVyRXRoZXIgPT0gMAogICAgICAgfHwgdG9rZW5zUGVyQlRDID09IDAKICAgICAgIHx8IGZpbmFsT3duZXIgPT0gMHgwCiAgICAgICB8fCB3YWxsZXQgPT0gMHgwCiAgICAgICB8fCBmdW5kaW5nU3RhcnRCbG9jayA9PSAwCiAgICAgICB8fCB0b3RhbFN1cHBseSA9PSAwCiAgICAgICB8fCB0b2tlbkNyZWF0aW9uTWF4ID09IDAKICAgICAgIHx8IGZ1bmRpbmdTdGFydEJsb2NrIDw9IGJsb2NrLm51bWJlcikKICAgICAgdGhyb3c7CgogICB9CgogICAvLyBkb24ndCBqdXN0IHNlbmQgZXRoZXIgdG8gdGhlIGNvbnRyYWN0IGV4cGVjdGluZyB0byBnZXQgdG9rZW5zCiAgIC8vZnVuY3Rpb24oKSB7IHRocm93OyB9CiAgIC8vLy9AZGV2IFRoaXMgZnVuY3Rpb24gbWFuYWdlcyB0aGUgQ3Jvd2RzYWxlIFN0YXRlIG1hY2hpbmUKICAgLy8vV2UgbWFrZSBpdCBhIGZ1bmN0aW9uIGFuZCBkbyBub3QgYXNzaWduIHRvIGEgdmFyaWFibGUvLwogICAvLy9zbyB0aGF0IG5vIGNoYW5jZSBvZiBzdGFsZSB2YXJpYWJsZQogICBmdW5jdGlvbiBnZXRTdGF0ZSgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zKFN0YXRlKXsKICAgCS8vL29uY2Ugd2UgcmVhY2ggc3VjY2VzcyBsb2NrIHRoZSBTdGF0ZQogICAJaWYoYmxvY2subnVtYmVyPGZ1bmRpbmdTdGFydEJsb2NrKSByZXR1cm4gU3RhdGUuSW5hY3RpdmU7CiAgIAllbHNlIGlmKGJsb2NrLm51bWJlcj5mdW5kaW5nU3RhcnRCbG9jayAmJiBpbml0aWFsU3VwcGx5PHRva2VuQ3JlYXRpb25NYXgpIHJldHVybiBTdGF0ZS5GdW5kaW5nOwogICAJZWxzZSBpZiAoaW5pdGlhbFN1cHBseSA+PSB0b2tlbkNyZWF0aW9uTWF4KSByZXR1cm4gU3RhdGUuU3VjY2VzczsKICAgCWVsc2UgcmV0dXJuIFN0YXRlLkZhaWx1cmU7CiAgIH0KCiAgIC8vL2dldCB0b3RhbCB0b2tlbnMgaW4gdGhhdCBhZGRyZXNzIG1hcHBpbmcKICAgZnVuY3Rpb24gZ2V0VG9rZW5zKGFkZHJlc3MgYWRkcikgcHVibGljIHJldHVybnModWludDI1Nil7CiAgIAlyZXR1cm4gYmFsYW5jZXNbYWRkcl07CiAgIH0KCiAgIC8vL2dldCB0aGUgYmxvY2sgbnVtYmVyIHN0YXRlCiAgIGZ1bmN0aW9uIGdldFN0YXRlRnVuZGluZygpIHB1YmxpYyByZXR1cm5zICh1aW50MjU2KXsKICAgCS8vIGF2ZXJhZ2UgNjAwMCBibG9ja3MgbWluZWQgaW4gMjQgaHJzCiAgIAlpZihibG9jay5udW1iZXI8ZnVuZGluZ1N0YXJ0QmxvY2sgKyAxODAwMDApIHJldHVybiAyMDsgLy8gMSBtb250aCAyMCUKICAgCWVsc2UgaWYoYmxvY2subnVtYmVyPj1mdW5kaW5nU3RhcnRCbG9jaysgMTgwMDAxICYmIGJsb2NrLm51bWJlcjxmdW5kaW5nU3RhcnRCbG9jayArIDI3MDAwMCkgcmV0dXJuIDEwOyAvLyBuZXh0IDE1IGRheXMKICAgCWVsc2UgaWYoYmxvY2subnVtYmVyPj1mdW5kaW5nU3RhcnRCbG9jayArIDI3MDAwMSAmJiBibG9jay5udW1iZXI8ZnVuZGluZ1N0YXJ0QmxvY2sgKyAzNjAwMCkgcmV0dXJuIDU7IC8vIG5leHQgMTUgZGF5cwogICAJZWxzZSByZXR1cm4gMDsKICAgfQogICAvLy9hIGZ1bmN0aW9uIHVzaW5nIHNhZmVtYXRoIHRvIHdvcmsgd2l0aAogICAvLy90aGUgbmV3IGZ1bmN0aW9uCiAgIGZ1bmN0aW9uIGNhbE5ld1Rva2Vucyh1aW50MjU2IHRva2VucykgcmV0dXJucyAodWludDI1Nil7CiAgIAl1aW50MjU2IGRpc2MgPSBnZXRTdGF0ZUZ1bmRpbmcoKTsKICAgCXRva2VucyA9IHNhZmVBZGQodG9rZW5zLHNhZmVEaXYoc2FmZU11bCh0b2tlbnMsZGlzYyksMTAwKSk7CiAgIAlyZXR1cm4gdG9rZW5zOwogICB9CgogICBmdW5jdGlvbigpIGV4dGVybmFsIHBheWFibGUgc3RvcEluRW1lcmdlbmN5ewogICAJLy8gQWJvcnQgaWYgbm90IGluIEZ1bmRpbmcgQWN0aXZlIHN0YXRlLgogICAJaWYoZ2V0U3RhdGUoKSA9PSBTdGF0ZS5TdWNjZXNzKSB0aHJvdzsKICAgCWlmIChtc2cudmFsdWUgPT0gMCkgdGhyb3c7CiAgIAl1aW50MjU2IG5ld0NyZWF0ZWRUb2tlbnMgPSBzYWZlTXVsKG1zZy52YWx1ZSx0b2tlbnNQZXJFdGhlcik7CiAgIAluZXdDcmVhdGVkVG9rZW5zID0gY2FsTmV3VG9rZW5zKG5ld0NyZWF0ZWRUb2tlbnMpOwogICAJLy8vc2luY2Ugd2UgYXJlIGNyZWF0aW5nIHRva2VucyB3ZSBuZWVkIHRvIGluY3JlYXNlIHRoZSB0b3RhbCBzdXBwbHkKICAgCWluaXRpYWxTdXBwbHkgPSBzYWZlQWRkKGluaXRpYWxTdXBwbHksbmV3Q3JlYXRlZFRva2Vucyk7CiAgIAlpZihpbml0aWFsU3VwcGx5PnRva2VuQ3JlYXRpb25NYXgpIHRocm93OwogICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPT0gMCkgaW52ZXN0b3JzLnB1c2gobXNnLnNlbmRlcik7CiAgICAgIGludmVzdG1lbnRFVEggKz0gbXNnLnZhbHVlOwogICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHNhZmVBZGQoYmFsYW5jZXNbbXNnLnNlbmRlcl0sbmV3Q3JlYXRlZFRva2Vucyk7CiAgICAgIC8vIFBvY2tldCB0aGUgbW9uZXkKICAgICAgaWYoIXdhbGxldC5zZW5kKG1zZy52YWx1ZSkpIHRocm93OwogICB9CgoKICAgLy8vdG9rZW4gZGlzdHJpYnV0aW9uIGluaXRpYWwgZnVuY3Rpb24gZm9yIHRoZSBvbmUgaW4gdGhlIGV4Y2hhbmdlcwogICAvLy90byBiZSBkb25lIG9ubHkgdGhlIG93bmVyIGNhbiBydW4gdGhpcyBmdW5jdGlvbgogICBmdW5jdGlvbiB0b2tlbkFzc2lnbkV4Y2hhbmdlKGFkZHJlc3MgYWRkcix1aW50MjU2IHZhbCkKICAgZXh0ZXJuYWwKICAgb25seShmaW5hbE93bmVyKQogICB7CiAgIAlpZihnZXRTdGF0ZSgpID09IFN0YXRlLlN1Y2Nlc3MpIHRocm93OwogICAJaWYgKHZhbCA9PSAwKSB0aHJvdzsKICAgCXVpbnQyNTYgbmV3Q3JlYXRlZFRva2VucyA9IHNhZmVNdWwodmFsLHRva2Vuc1BlckV0aGVyKTsKICAgCW5ld0NyZWF0ZWRUb2tlbnMgPSBjYWxOZXdUb2tlbnMobmV3Q3JlYXRlZFRva2Vucyk7CiAgIAlpbml0aWFsU3VwcGx5ID0gc2FmZUFkZChpbml0aWFsU3VwcGx5LG5ld0NyZWF0ZWRUb2tlbnMpOwogICAJaWYoaW5pdGlhbFN1cHBseT50b2tlbkNyZWF0aW9uTWF4KSB0aHJvdzsKICAgICAgaWYgKGJhbGFuY2VzW2FkZHJdID09IDApIGludmVzdG9ycy5wdXNoKGFkZHIpOwogICAgICBpbnZlc3RtZW50RVRIICs9IHZhbDsKICAgICAgYmFsYW5jZXNbYWRkcl0gPSBzYWZlQWRkKGJhbGFuY2VzW2FkZHJdLG5ld0NyZWF0ZWRUb2tlbnMpOwogICB9CgogICAvLy9mdW5jdGlvbiB0byBydW4gd2hlbiB0aGUgdHJhbnNhY3Rpb24gaGFzIGJlZW4gdmVpZmllZAogICBmdW5jdGlvbiBwcm9jZXNzVHJhbnNhY3Rpb24oYnl0ZXMgdHhuLCB1aW50MjU2IHR4SGFzaCxhZGRyZXNzIGFkZHIsYnl0ZXMyMCBidGNhZGRyKQogICBleHRlcm5hbAogICBvbmx5KGZpbmFsT3duZXIpCiAgIHJldHVybnMgKHVpbnQpCiAgIHsKICAgCWlmKGdldFN0YXRlKCkgPT0gU3RhdGUuU3VjY2VzcykgdGhyb3c7CiAgIAl2YXIgKG91dHB1dDEsb3V0cHV0MixvdXRwdXQzLG91dHB1dDQpID0gQlRDLmdldEZpcnN0VHdvT3V0cHV0cyh0eG4pOwogICAgICBpZih0cmFuc2FjdGlvbnNDbGFpbWVkW3R4SGFzaF0pIHRocm93OwogICAgICB2YXIgKGEsYikgPSBCVEMuY2hlY2tWYWx1ZVNlbnQodHhuLGJ0Y2FkZHIsbWluQnRjVmFsdWUpOwogICAgICBpZihhKXsKICAgICAgICAgdHJhbnNhY3Rpb25zQ2xhaW1lZFt0eEhhc2hdID0gdHJ1ZTsKICAgICAgICAgdWludDI1NiBuZXdDcmVhdGVkVG9rZW5zID0gc2FmZU11bChiLHRva2Vuc1BlckJUQyk7CiAgICAgICAgIC8vL3NpbmNlIHdlIGFyZSBjcmVhdGluZyB0b2tlbnMgd2UgbmVlZCB0byBpbmNyZWFzZSB0aGUgdG90YWwgc3VwcGx5CiAgICAgICAgIG5ld0NyZWF0ZWRUb2tlbnMgPSBjYWxOZXdUb2tlbnMobmV3Q3JlYXRlZFRva2Vucyk7CiAgICAgICAgIGluaXRpYWxTdXBwbHkgPSBzYWZlQWRkKGluaXRpYWxTdXBwbHksbmV3Q3JlYXRlZFRva2Vucyk7CiAgICAgICAgIC8vL3JlbWVtYmVyIG5vdCB0byBnbyBvZmYgdGhlIExJTUlUUyEhCiAgICAgICAgIGlmKGluaXRpYWxTdXBwbHk+dG9rZW5DcmVhdGlvbk1heCkgdGhyb3c7CiAgICAgICAgIGlmIChiYWxhbmNlc1thZGRyXSA9PSAwKSBpbnZlc3RvcnMucHVzaChhZGRyKTsKICAgICAgICAgaW52ZXN0bWVudEJUQyArPSBiOwogICAgICAgICBiYWxhbmNlc1thZGRyXSA9IHNhZmVBZGQoYmFsYW5jZXNbYWRkcl0sbmV3Q3JlYXRlZFRva2Vucyk7CiAgICAgICAgIHJldHVybiAxOwogICAgICB9CiAgICAgIGVsc2UgcmV0dXJuIDA7CiAgIH0KCiAgIC8vL2NoYW5nZSBleGNoYW5nZSByYXRlCiAgIGZ1bmN0aW9uIGNoYW5nZUV4Y2hhbmdlUmF0ZSh1aW50MjU2IGV0aCwgdWludDI1NiBidGMpCiAgIGV4dGVybmFsCiAgIG9ubHkoZmluYWxPd25lcikKICAgewogICAgaWYoZXRoID09IDAgfHwgYnRjID09IDApIHRocm93OwogICAgdG9rZW5zUGVyRXRoZXIgPSBldGg7CiAgICB0b2tlbnNQZXJCVEMgPSBidGM7CiB9CgogLy8vYmxhY2tsaXN0IHRoZSB1c2VycyB3aGljaCBhcmUgZnJhdWR1bGVudAogLy8vZnJvbSBnZXR0aW5nIGFueSB0b2tlbnMKIC8vL3RvIGRvIGFsc28gcmVmdW5kIGp1c3QgaW4gY2FzZXMKIGZ1bmN0aW9uIGJsYWNrbGlzdChhZGRyZXNzIGFkZHIpCiBleHRlcm5hbAogb25seShmaW5hbE93bmVyKQogewogICAgYmFsYW5jZXNbYWRkcl0gPSAwOwogfQoKfQ=='.
	

]
