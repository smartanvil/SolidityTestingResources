Class {
	#name : #SRTb8a88034bcf46e26c6bae1269ff2d051e2dee65c,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTb8a88034bcf46e26c6bae1269ff2d051e2dee65c >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKioKICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCmxpYnJhcnkgU2FmZU1hdGggewogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9Cgpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IFNuYXBzaG90W10pIGJhbGFuY2VzOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSB1c2VyV2l0aGRyYXdhbEJsb2NrczsKCQogICAgLyoqCiAgICAgKiBAZGV2ICdTbmFwc2hvdCcgaXMgdGhlIHN0cnVjdHVyZSB0aGF0IGF0dGFjaGVzIGEgYmxvY2sgbnVtYmVyIHRvIGEKICAgICAqIGdpdmVuIHZhbHVlLCB0aGUgYmxvY2sgbnVtYmVyIGF0dGFjaGVkIGlzIHRoZSBvbmUgdGhhdCBsYXN0IGNoYW5nZWQgdGhlIHZhbHVlCiAgICAgKiAnZnJvbUJsb2NrJyAtIGlzIHRoZSBibG9jayBudW1iZXIgdGhhdCB0aGUgdmFsdWUgd2FzIGdlbmVyYXRlZCBmcm9tCiAgICAgKiAndmFsdWUnIC0gaXMgdGhlIGFtb3VudCBvZiB0b2tlbnMgYXQgYSBzcGVjaWZpYyBibG9jayBudW1iZXIKICAgICAqLwogICAgc3RydWN0IFNuYXBzaG90IHsKICAgICAgdWludDEyOCBmcm9tQmxvY2s7CiAgICAgIHVpbnQxMjggdmFsdWU7CiAgICB9CgkKCS8qKgoJICogQGRldiB0cmFja3MgaGlzdG9yeSBvZiB0b3RhbFN1cHBseQoJICovCiAgICBTbmFwc2hvdFtdIHRvdGFsU3VwcGx5SGlzdG9yeTsKICAgIAogICAgLyoqCiAgICAgKiBAZGV2IHRyYWNrIGhpc3Rvcnkgb2YgJ0VUSCBiYWxhbmNlJyBmb3IgZGl2aWRlbmRzCiAgICAgKi8KICAgIFNuYXBzaG90W10gYmFsYW5jZUZvckRpdmlkZW5kc0hpc3Rvcnk7CgkKCS8qKgoJKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCgkqIEBwYXJhbSB0byAtIHRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgoJKiBAcGFyYW0gdmFsdWUgLSB0aGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgoJKi8KCWZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIGRvVHJhbnNmZXIobXNnLnNlbmRlciwgdG8sIHZhbHVlKTsKCX0KCQoJLyoqCgkgKiBAZGV2IGludGVybmFsIGZ1bmN0aW9uIGZvciB0cmFuc2ZlcnMgaGFuZGxpbmcKCSAqLwoJZnVuY3Rpb24gZG9UcmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfYW1vdW50KSBpbnRlcm5hbCByZXR1cm5zKGJvb2wpIHsKCSAgIGlmIChfYW1vdW50ID09IDApIHsKCQkgICByZXR1cm4gdHJ1ZTsKCSAgIH0KICAgICAKCSAgIC8vIERvIG5vdCBhbGxvdyB0cmFuc2ZlciB0byAweDAgb3IgdGhlIHRva2VuIGNvbnRyYWN0IGl0c2VsZgoJICAgcmVxdWlyZSgoX3RvICE9IDApICYmIChfdG8gIT0gYWRkcmVzcyh0aGlzKSkpOwoKCSAgIC8vIElmIHRoZSBhbW91bnQgYmVpbmcgdHJhbnNmZXJlZCBpcyBtb3JlIHRoYW4gdGhlIGJhbGFuY2Ugb2YgdGhlCgkgICAvLyAgYWNjb3VudCB0aGUgdHJhbnNmZXIgcmV0dXJucyBmYWxzZQoJICAgdmFyIHByZXZpb3VzQmFsYW5jZUZyb20gPSBiYWxhbmNlT2ZBdChfZnJvbSwgYmxvY2subnVtYmVyKTsKCSAgIGlmIChwcmV2aW91c0JhbGFuY2VGcm9tIDwgX2Ftb3VudCkgewoJCSAgIHJldHVybiBmYWxzZTsKCSAgIH0KCgkgICAvLyBGaXJzdCB1cGRhdGUgdGhlIGJhbGFuY2UgYXJyYXkgd2l0aCB0aGUgbmV3IHZhbHVlIGZvciB0aGUgYWRkcmVzcwoJICAgLy8gIHNlbmRpbmcgdGhlIHRva2VucwoJICAgdXBkYXRlVmFsdWVBdE5vdyhiYWxhbmNlc1tfZnJvbV0sIHByZXZpb3VzQmFsYW5jZUZyb20gLSBfYW1vdW50KTsKCgkgICAvLyBUaGVuIHVwZGF0ZSB0aGUgYmFsYW5jZSBhcnJheSB3aXRoIHRoZSBuZXcgdmFsdWUgZm9yIHRoZSBhZGRyZXNzCgkgICAvLyAgcmVjZWl2aW5nIHRoZSB0b2tlbnMKCSAgIHZhciBwcmV2aW91c0JhbGFuY2VUbyA9IGJhbGFuY2VPZkF0KF90bywgYmxvY2subnVtYmVyKTsKCSAgIHJlcXVpcmUocHJldmlvdXNCYWxhbmNlVG8gKyBfYW1vdW50ID49IHByZXZpb3VzQmFsYW5jZVRvKTsgLy8gQ2hlY2sgZm9yIG92ZXJmbG93CgkgICB1cGRhdGVWYWx1ZUF0Tm93KGJhbGFuY2VzW190b10sIHByZXZpb3VzQmFsYW5jZVRvICsgX2Ftb3VudCk7CgoJICAgLy8gQW4gZXZlbnQgdG8gbWFrZSB0aGUgdHJhbnNmZXIgZWFzeSB0byBmaW5kIG9uIHRoZSBibG9ja2NoYWluCgkgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfYW1vdW50KTsKCgkgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIAoJLyoqCgkqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCgkqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLiAKCSogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KCSovCglmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKCQlyZXR1cm4gYmFsYW5jZU9mQXQoX293bmVyLCBibG9jay5udW1iZXIpOwoJfQoKICAgIC8qKgogICAgICogQGRldiBRdWVyaWVzIHRoZSBiYWxhbmNlIG9mIGBfb3duZXJgIGF0IGEgc3BlY2lmaWMgYF9ibG9ja051bWJlcmAKICAgICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgZnJvbSB3aGljaCB0aGUgYmFsYW5jZSB3aWxsIGJlIHJldHJpZXZlZAogICAgICogQHBhcmFtIF9ibG9ja051bWJlciBUaGUgYmxvY2sgbnVtYmVyIHdoZW4gdGhlIGJhbGFuY2UgaXMgcXVlcmllZAogICAgICogQHJldHVybiBUaGUgYmFsYW5jZSBhdCBgX2Jsb2NrTnVtYmVyYAogICAgICovCiAgICBmdW5jdGlvbiBiYWxhbmNlT2ZBdChhZGRyZXNzIF9vd25lciwgdWludCBfYmxvY2tOdW1iZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgLy8gIFRoZXNlIG5leHQgZmV3IGxpbmVzIGFyZSB1c2VkIHdoZW4gdGhlIGJhbGFuY2Ugb2YgdGhlIHRva2VuIGlzCiAgICAgICAgLy8gIHJlcXVlc3RlZCBiZWZvcmUgYSBjaGVjayBwb2ludCB3YXMgZXZlciBjcmVhdGVkIGZvciB0aGlzIHRva2VuCiAgICAgICAgaWYgKChiYWxhbmNlc1tfb3duZXJdLmxlbmd0aCA9PSAwKXx8IChiYWxhbmNlc1tfb3duZXJdWzBdLmZyb21CbG9jayA+IF9ibG9ja051bWJlcikpIHsKCQkJcmV0dXJuIDA7IAogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBnZXRWYWx1ZUF0KGJhbGFuY2VzW19vd25lcl0sIF9ibG9ja051bWJlcik7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQGRldiBUb3RhbCBhbW91bnQgb2YgdG9rZW5zIGF0IGEgc3BlY2lmaWMgYF9ibG9ja051bWJlcmAuCiAgICAgKiBAcGFyYW0gX2Jsb2NrTnVtYmVyIFRoZSBibG9jayBudW1iZXIgd2hlbiB0aGUgdG90YWxTdXBwbHkgaXMgcXVlcmllZAogICAgICogQHJldHVybiBUaGUgdG90YWwgYW1vdW50IG9mIHRva2VucyBhdCBgX2Jsb2NrTnVtYmVyYAogICAgICovCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseUF0KHVpbnQgX2Jsb2NrTnVtYmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50KSB7CiAgICAgICAgLy8gVGhlc2UgbmV4dCBmZXcgbGluZXMgYXJlIHVzZWQgd2hlbiB0aGUgdG90YWxTdXBwbHkgb2YgdGhlIHRva2VuIGlzCiAgICAgICAgLy8gcmVxdWVzdGVkIGJlZm9yZSBhIGNoZWNrIHBvaW50IHdhcyBldmVyIGNyZWF0ZWQgZm9yIHRoaXMgdG9rZW4KICAgICAgICBpZiAoKHRvdGFsU3VwcGx5SGlzdG9yeS5sZW5ndGggPT0gMCkgfHwgKHRvdGFsU3VwcGx5SGlzdG9yeVswXS5mcm9tQmxvY2sgPiBfYmxvY2tOdW1iZXIpKSB7CgkJCXJldHVybiAwOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBnZXRWYWx1ZUF0KHRvdGFsU3VwcGx5SGlzdG9yeSwgX2Jsb2NrTnVtYmVyKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGBnZXRWYWx1ZUF0YCByZXRyaWV2ZXMgdGhlIG51bWJlciBvZiB0b2tlbnMgYXQgYSBnaXZlbiBibG9jayBudW1iZXIKICAgICAqIEBwYXJhbSBjaGVja3BvaW50cyBUaGUgaGlzdG9yeSBvZiB2YWx1ZXMgYmVpbmcgcXVlcmllZAogICAgICogQHBhcmFtIF9ibG9jayBUaGUgYmxvY2sgbnVtYmVyIHRvIHJldHJpZXZlIHRoZSB2YWx1ZSBhdAogICAgICogQHJldHVybiBUaGUgbnVtYmVyIG9mIHRva2VucyBiZWluZyBxdWVyaWVkCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFZhbHVlQXQoU25hcHNob3RbXSBzdG9yYWdlIGNoZWNrcG9pbnRzLCB1aW50IF9ibG9jaykgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgICAgIGlmIChjaGVja3BvaW50cy5sZW5ndGggPT0gMCkgcmV0dXJuIDA7CgogICAgICAgIC8vIFNob3J0Y3V0IGZvciB0aGUgYWN0dWFsIHZhbHVlCiAgICAgICAgaWYgKF9ibG9jayA+PSBjaGVja3BvaW50c1tjaGVja3BvaW50cy5sZW5ndGgtMV0uZnJvbUJsb2NrKQogICAgICAgICAgICByZXR1cm4gY2hlY2twb2ludHNbY2hlY2twb2ludHMubGVuZ3RoLTFdLnZhbHVlOwogICAgICAgIGlmIChfYmxvY2sgPCBjaGVja3BvaW50c1swXS5mcm9tQmxvY2spIHJldHVybiAwOwoKICAgICAgICAvLyBCaW5hcnkgc2VhcmNoIG9mIHRoZSB2YWx1ZSBpbiB0aGUgYXJyYXkKICAgICAgICB1aW50IG1pbiA9IDA7CiAgICAgICAgdWludCBtYXggPSBjaGVja3BvaW50cy5sZW5ndGgtMTsKICAgICAgICB3aGlsZSAobWF4ID4gbWluKSB7CiAgICAgICAgICAgIHVpbnQgbWlkID0gKG1heCArIG1pbiArIDEpLyAyOwogICAgICAgICAgICBpZiAoY2hlY2twb2ludHNbbWlkXS5mcm9tQmxvY2s8PV9ibG9jaykgewogICAgICAgICAgICAgICAgbWluID0gbWlkOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbWF4ID0gbWlkLTE7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGNoZWNrcG9pbnRzW21pbl0udmFsdWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGB1cGRhdGVWYWx1ZUF0Tm93YCB1c2VkIHRvIHVwZGF0ZSB0aGUgYGJhbGFuY2VzYCBtYXAgYW5kIHRoZSBgdG90YWxTdXBwbHlIaXN0b3J5YAogICAgICogQHBhcmFtIGNoZWNrcG9pbnRzIFRoZSBoaXN0b3J5IG9mIGRhdGEgYmVpbmcgdXBkYXRlZAogICAgICogQHBhcmFtIF92YWx1ZSBUaGUgbmV3IG51bWJlciBvZiB0b2tlbnMKICAgICAqLyAKICAgIGZ1bmN0aW9uIHVwZGF0ZVZhbHVlQXROb3coU25hcHNob3RbXSBzdG9yYWdlIGNoZWNrcG9pbnRzLCB1aW50IF92YWx1ZSkgaW50ZXJuYWwgIHsKICAgICAgICBpZiAoKGNoZWNrcG9pbnRzLmxlbmd0aCA9PSAwKSB8fCAoY2hlY2twb2ludHNbY2hlY2twb2ludHMubGVuZ3RoIC0xXS5mcm9tQmxvY2sgPCBibG9jay5udW1iZXIpKSB7CiAgICAgICAgICAgU25hcHNob3Qgc3RvcmFnZSBuZXdDaGVja1BvaW50ID0gY2hlY2twb2ludHNbIGNoZWNrcG9pbnRzLmxlbmd0aCsrIF07CiAgICAgICAgICAgbmV3Q2hlY2tQb2ludC5mcm9tQmxvY2sgPSAgdWludDEyOChibG9jay5udW1iZXIpOwogICAgICAgICAgIG5ld0NoZWNrUG9pbnQudmFsdWUgPSB1aW50MTI4KF92YWx1ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICBTbmFwc2hvdCBzdG9yYWdlIG9sZENoZWNrUG9pbnQgPSBjaGVja3BvaW50c1tjaGVja3BvaW50cy5sZW5ndGgtMV07CiAgICAgICAgICAgb2xkQ2hlY2tQb2ludC52YWx1ZSA9IHVpbnQxMjgoX3ZhbHVlKTsKICAgICAgICB9CiAgICB9CgkKICAgIC8qKgogICAgICogQGRldiBUaGlzIGZ1bmN0aW9uIG1ha2VzIGl0IGVhc3kgdG8gZ2V0IHRoZSB0b3RhbCBudW1iZXIgb2YgdG9rZW5zCiAgICAgKiBAcmV0dXJuIFRoZSB0b3RhbCBudW1iZXIgb2YgdG9rZW5zCiAgICAgKi8KICAgIGZ1bmN0aW9uIHJlZGVlbWVkU3VwcGx5KCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gdG90YWxTdXBwbHlBdChibG9jay5udW1iZXIpOwogICAgfQp9Cgpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7ICAgICAgCiAgICBvd25lciA9IG5ld093bmVyOwogIH0KfQoKY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CgkgIHJldHVybiBkb1RyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2AKICAgIC8vICBhbGxvd2FuY2UgdG8gemVybyBieSBjYWxsaW5nIGBhcHByb3ZlKF9zcGVuZGVyLCAwKWAgaWYgaXQgaXMgbm90CiAgICAvLyAgYWxyZWFkeSAwIHRvIG1pdGlnYXRlIHRoZSByYWNlIGNvbmRpdGlvbiBkZXNjcmliZWQgaGVyZToKICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgcmVxdWlyZSgoX3ZhbHVlID09IDApIHx8IChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9PSAwKSk7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgKi8KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKfQoKY29udHJhY3QgTWludGFibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuIHsKICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwogIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwogIAogIGJvb2wgcHVibGljIG1pbnRpbmdGaW5pc2hlZCA9IGZhbHNlOwoKICBzdHJpbmcgcHVibGljIG5hbWUgPSAiSG9uZXkgTWluaW5nIFRva2VuIjsJCQogIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIkhNVCI7CQkKICB1aW50OCBwdWJsaWMgZGVjaW1hbHMgPSA4OwkJCgogIG1vZGlmaWVyIGNhbk1pbnQoKSB7CiAgICByZXF1aXJlKCFtaW50aW5nRmluaXNoZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gbWludCB0b2tlbnMKICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCByZWNlaXZlIHRoZSBtaW50ZWQgdG9rZW5zLgogICAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIG1pbnQuCiAgICogQHJldHVybiBBIGJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyBjYW5NaW50IHJldHVybnMgKGJvb2wpIHsKICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKF9hbW91bnQpOwoJdWludCBjdXJUb3RhbFN1cHBseSA9IHJlZGVlbWVkU3VwcGx5KCk7CglyZXF1aXJlKGN1clRvdGFsU3VwcGx5ICsgX2Ftb3VudCA+PSBjdXJUb3RhbFN1cHBseSk7IC8vIENoZWNrIGZvciBvdmVyZmxvdwoJdWludCBwcmV2aW91c0JhbGFuY2VUbyA9IGJhbGFuY2VPZihfdG8pOwoJcmVxdWlyZShwcmV2aW91c0JhbGFuY2VUbyArIF9hbW91bnQgPj0gcHJldmlvdXNCYWxhbmNlVG8pOyAvLyBDaGVjayBmb3Igb3ZlcmZsb3cKCXVwZGF0ZVZhbHVlQXROb3codG90YWxTdXBwbHlIaXN0b3J5LCBjdXJUb3RhbFN1cHBseSArIF9hbW91bnQpOwogICAgdXBkYXRlVmFsdWVBdE5vdyhiYWxhbmNlc1tfdG9dLCBwcmV2aW91c0JhbGFuY2VUbyArIF9hbW91bnQpOwogICAgTWludChfdG8sIF9hbW91bnQpOwogICAgVHJhbnNmZXIoMHgwLCBfdG8sIF9hbW91bnQpOwogICAgcmV0dXJuIHRydWU7CiAgfQogIAogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gcmVjb3JkIHNuYXBzaG90IGJsb2NrIGFuZCBhbW91bnQKICAgKi8KICBmdW5jdGlvbiByZWNvcmREZXBvc2l0KHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIHsKCSB1cGRhdGVWYWx1ZUF0Tm93KGJhbGFuY2VGb3JEaXZpZGVuZHNIaXN0b3J5LCBfYW1vdW50KTsKICB9CiAgCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBzdG9wIG1pbnRpbmcgbmV3IHRva2Vucy4KICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBmaW5pc2hNaW50aW5nKCkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIG1pbnRpbmdGaW5pc2hlZCA9IHRydWU7CiAgICBNaW50RmluaXNoZWQoKTsKICAgIHJldHVybiB0cnVlOwogIH0KICAKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNhbGN1bGF0ZSBkaXZpZGVuZHMKICAgKiBAcmV0dXJuIGF3YWlsYWJsZSBmb3Igd2l0aGRyYXdhbCBldGhlcmUgKHdlaSB2YWx1ZSkKICAgKi8KICBmdW5jdGlvbiBhd2FpbGFibGVEaXZpZGVuZHMoYWRkcmVzcyB1c2VyQWRkcmVzcykgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICB1aW50MjU2IHVzZXJMYXN0V2l0aGRyYXdhbEJsb2NrID0gdXNlcldpdGhkcmF3YWxCbG9ja3NbdXNlckFkZHJlc3NdOwogICAgICB1aW50MjU2IGFtb3VudEZvcldpdGhkcmF3ID0gMDsKICAgICAgZm9yKHVpbnQgaSA9IDA7IGk8PWJhbGFuY2VGb3JEaXZpZGVuZHNIaXN0b3J5Lmxlbmd0aC0xOyBpKyspewogICAgICAgICAgU25hcHNob3Qgc3RvcmFnZSBzbmFwc2hvdCA9IGJhbGFuY2VGb3JEaXZpZGVuZHNIaXN0b3J5W2ldOwogICAgICAgICAgaWYodXNlckxhc3RXaXRoZHJhd2FsQmxvY2sgPCBzbmFwc2hvdC5mcm9tQmxvY2spCiAgICAgICAgICAgIGFtb3VudEZvcldpdGhkcmF3ID0gYW1vdW50Rm9yV2l0aGRyYXcuYWRkKGJhbGFuY2VPZkF0KHVzZXJBZGRyZXNzLCBzbmFwc2hvdC5mcm9tQmxvY2spLm11bChzbmFwc2hvdC52YWx1ZSkuZGl2KHRvdGFsU3VwcGx5QXQoc25hcHNob3QuZnJvbUJsb2NrKSkpOwogICAgICB9CiAgICAgIHJldHVybiBhbW91bnRGb3JXaXRoZHJhdzsKICB9CiAgCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byByZWNvcmQgdXNlciB3aXRoZHJhd2FsIAogICAqLwogIGZ1bmN0aW9uIHJlY29yZFdpdGhkcmF3KGFkZHJlc3MgdXNlckFkZHJlc3MpIHB1YmxpYyB7CiAgICB1c2VyV2l0aGRyYXdhbEJsb2Nrc1t1c2VyQWRkcmVzc10gPSBiYWxhbmNlRm9yRGl2aWRlbmRzSGlzdG9yeVtiYWxhbmNlRm9yRGl2aWRlbmRzSGlzdG9yeS5sZW5ndGgtMV0uZnJvbUJsb2NrOwogIH0KfQoKY29udHJhY3QgSG9uZXlNaW5pbmdUb2tlbiBpcyBPd25hYmxlIHsKICAgIAogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBNaW50YWJsZVRva2VuIHB1YmxpYyB0b2tlbjsKICAvKioKICAgKiBAZGV2IEluZm8gb2YgbWF4IHN1cHBseQogICAqLwogIHVpbnQyNTYgcHVibGljIG1heFN1cHBseSA9IDMwMDAwMDAwMDAwMDAwMDsKICAKICAvKioKICAgKiBldmVudCBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAqIEBwYXJhbSBwdXJjaGFzZXIgd2hvIHBhaWQgZm9yIHRoZSB0b2tlbnMsIGJhc2ljYWxseSAtIDB4MCwgYnV0IGNvdWxkIGJlIHVzZXIgYWRkcmVzcyBvbiByZWZmZXJhbCBjYXNlCiAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IHdobyBnb3QgdGhlIHRva2VucwogICAqIEBwYXJhbSB2YWx1ZSB3ZWlzIHBhaWQgZm9yIHB1cmNoYXNlCiAgICogQHBhcmFtIGFtb3VudCAtIG9mIHRva2VucyBwdXJjaGFzZWQKICAgKi8KICBldmVudCBUb2tlblB1cmNoYXNlKGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB2YWx1ZSwgdWludDI1NiBhbW91bnQpOwogIAogIC8qKgogICAqIGV2ZW50IGZvciByZWZlcnJhbCBjb21pc3Npb24gbG9nZ2luZwogICAqIEBwYXJhbSBwdXJjaGFzZXIgd2hvIHBhaWQgZm9yIHRoZSB0b2tlbnMKICAgKiBAcGFyYW0gYmVuZWZpY2lhcnkgd2hvIGdvdCB0aGUgYm9udXMgdG9rZW5zCiAgICogQHBhcmFtIGFtb3VudCAtIG9mIHRva2VucyBhcyByZWYgcmV3YXJkCiAgICovCiAgZXZlbnQgUmVmZXJyYWxCb251cyhhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQgYW1vdW50KTsKICAKICAgLyoqCiAgICogZXZlbnQgZm9yIHRva2VuIGRpdmlkZW5kcyBkZXBvc2l0IGxvZ2dpbmcKICAgKiBAcGFyYW0gYW1vdW50IC0gYW1vdW50IG9mIEVUSCBkZXBvc2l0ZWQKICAgKi8KICBldmVudCBEZXBvc2l0Rm9yRGl2aWRlbmRzKHVpbnQyNTYgaW5kZXhlZCBhbW91bnQpOwogIAogIC8qKgogICAqIGV2ZW50IGZvciBkaXZpZGVuZHMgd2l0aGRyYXdhbCBsb2dnaW5nIAogICAqIEBwYXJhbSBob2xkZXIgLSB3aG8gaGFzIHRoZSB0b2tlbnMKICAgKiBAcGFyYW0gYW1vdW50IC0gYW1vdW50IG9mIEVUSCB3aGljaCB3YXMgd2l0aGRyYXcKICAqLwogIGV2ZW50IFdpdGhkcmF3RGl2aWRlbmRzKGFkZHJlc3MgaW5kZXhlZCBob2xkZXIsIHVpbnQyNTYgYW1vdW50KTsKCiAgLyoqCiAgICogZXZlbnQgZm9yIGRldiByZXdhcmRzIGxvZ2dpbmcKICAgKiBAcGFyYW0gcHVyY2hhc2VyIC0gd2hvIHBhaWQgZm9yIHRoZSB0b2tlbnMKICAgKiBAcGFyYW0gYW1vdW50ICAtIHJlcHJlc2VudGF0aW9uIG9mIGRldiByZXdhcmQKICAgKi8KICBldmVudCBEZXZSZXdhcmQoYWRkcmVzcyBwdXJjaGFzZXIsIHVpbnQgYW1vdW50KTsKCiAgZnVuY3Rpb24gSG9uZXlNaW5pbmdUb2tlbigpIHB1YmxpYyB7CiAgICB0b2tlbiA9IG5ldyBNaW50YWJsZVRva2VuKCk7CiAgfQoKICAvKioKICAgKiBAZGV2IGZhbGxiYWNrIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIGJ1eSB0b2tlbnMKICAgKi8KICBmdW5jdGlvbiAoKSBwdWJsaWMgcGF5YWJsZSB7YnV5VG9rZW5zKDB4MCk7fQoKICAvKioKICAgKiBAZGV2IGxvdyBsZXZlbCB0b2tlbiBwdXJjaGFzZSBmdW5jdGlvbgogICAqIEBwYXJhbSByZWZlcnJlciAtIG9wdGlvbmFsIHBhcmFtZXRlciBmb3IgcmVmIGJvbnVzCiAgICovCiAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgcmVmZXJyZXIpIHB1YmxpYyBwYXlhYmxlIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciAhPSAweDApOwogICAgcmVxdWlyZShtc2cuc2VuZGVyICE9IHJlZmVycmVyKTsKICAgIHJlcXVpcmUodmFsaWRQdXJjaGFzZSgpKTsKICAgIAogICAgLy93ZSBkb250IG5lZWQgMTggZGVjaW1hbHMgLSBhbmQgd2lsbCB1c2Ugb25seSA4CiAgICB1aW50MjU2IGFtb3VudCA9IG1zZy52YWx1ZS5kaXYoMTAwMDAwMDAwMDApOwogICAgCiAgICAvLyBjYWxjdWxhdGUgdG9rZW4gYW1vdW50IHRvIGJlIGNyZWF0ZWQKICAgIHVpbnQyNTYgdG9rZW5zID0gYW1vdW50Lm11bChyYXRlKCkpOwogICAgcmVxdWlyZSh0b2tlbnMgPj0gMTAwMDAwMDAwKTsKICAgIHVpbnQyNTYgZGV2VG9rZW5zID0gdG9rZW5zLm11bCgzMCkuZGl2KDEwMCk7CiAgICBpZihyZWZlcnJlciAhPSAweDApewogICAgICAgcmVxdWlyZSh0b2tlbi5iYWxhbmNlT2YocmVmZXJyZXIpID49IDEwMDAwMDAwMCk7CiAgICAgICAvLyAyLjUlIGZvciByZWZlcnJhbCBhbmQgcmVmZXJyZXIKICAgICAgIHVpbnQyNTYgcmVmVG9rZW5zID0gdG9rZW5zLm11bCgyNSkuZGl2KDEwMDApOwogICAgICAgLy90b2tlbnMgPSB0b2tlbnMrcmVmVG9rZW5zOwogICAgICAgcmVxdWlyZShtYXhTdXBwbHkuc3ViKHJlZGVlbWVkU3VwcGx5KCkpID49IHRva2Vucy5hZGQocmVmVG9rZW5zLm11bCgyKSkuYWRkKGRldlRva2VucykpOwogICAgICAgCiAgICAgICAvL2dlbmVyYXRlIHRva2VucyBmb3IgcHVyY2hzZXIKICAgICAgIHRva2VuLm1pbnQobXNnLnNlbmRlciwgdG9rZW5zLmFkZChyZWZUb2tlbnMpKTsKICAgICAgIFRva2VuUHVyY2hhc2UobXNnLnNlbmRlciwgbXNnLnNlbmRlciwgYW1vdW50LCB0b2tlbnMuYWRkKHJlZlRva2VucykpOwogICAgICAgdG9rZW4ubWludChyZWZlcnJlciwgcmVmVG9rZW5zKTsKICAgICAgIFJlZmVycmFsQm9udXMobXNnLnNlbmRlciwgcmVmZXJyZXIsIHJlZlRva2Vucyk7CiAgICAgICAKICAgIH0gZWxzZXsKICAgICAgICByZXF1aXJlKG1heFN1cHBseS5zdWIocmVkZWVtZWRTdXBwbHkoKSk+PXRva2Vucy5hZGQoZGV2VG9rZW5zKSk7CiAgICAgICAgLy91cGRhdGVkUmVkZGVtZWRTdXBwbHkgPSByZWRlZW1lZFN1cHBseSgpLmFkZCh0b2tlbnMuYWRkKGRldlRva2VucykpOwogICAgICAgIAogICAgICAgIC8vZ2VuZXJhdGUgdG9rZW5zIGZvciBwdXJjaHNlcgogICAgICAgIHRva2VuLm1pbnQobXNnLnNlbmRlciwgdG9rZW5zKTsKICAgIAogICAgICAgIC8vIGxvZyBwdXJjaGFzZQogICAgICAgIFRva2VuUHVyY2hhc2UobXNnLnNlbmRlciwgbXNnLnNlbmRlciwgYW1vdW50LCB0b2tlbnMpOwogICAgfQogICAgdG9rZW4ubWludChvd25lciwgZGV2VG9rZW5zKTsKICAgIERldlJld2FyZChtc2cuc2VuZGVyLCBkZXZUb2tlbnMpOwogICAgZm9yd2FyZEZ1bmRzKCk7CiAgfQoKICAvKioKICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIHRyYW5zYWN0aW9uIGNhbiBidXkgdG9rZW5zCiAgICovCiAgZnVuY3Rpb24gdmFsaWRQdXJjaGFzZSgpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiAhaGFzRW5kZWQoKSAmJiBtc2cudmFsdWUgIT0gMDsKICB9CgogIC8qKgogICAqIEByZXR1cm4gdHJ1ZSBpZiBzYWxlIGlzIG92ZXIKICAgKi8KICBmdW5jdGlvbiBoYXNFbmRlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gbWF4U3VwcGx5IDw9IHJlZGVlbWVkU3VwcGx5KCk7CiAgfQogIAogIC8qKgogICAqIEBkZXYgZ2V0IGN1cnJlbnQgdXNlciBiYWxhbmNlCiAgICogQHBhcmFtIHVzZXJBZGRyZXNzIC0gYWRkcmVzcyBvZiB1c2VyCiAgICogQHJldHVybiBjdXJyZW50IGJhbGFuY2Ugb2YgdG9rZW5zCiAgICovCiAgZnVuY3Rpb24gY2hlY2tCYWxhbmNlKGFkZHJlc3MgdXNlckFkZHJlc3MpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KXsKICAgICAgcmV0dXJuIHRva2VuLmJhbGFuY2VPZih1c2VyQWRkcmVzcyk7CiAgfQogIAogIC8qKgogICAqIEBkZXYgZ2V0IHVzZXIgYmFsYW5jZSBvZiB0b2tlbnMgb24gc3BlY2lmaWMgYmxvY2sKICAgKiBAcGFyYW0gdXNlckFkZHJlc3MgLSBhZGRyZXNzIG9mIHVzZXIKICAgKiBAcGFyYW0gdGFyZ2V0QmxvY2sgLSBibG9jayBudW1iZXIKICAgKiBAcmV0dXJuIGFkZHJlc3MgYmFsYW5jZSBvbiBibG9jawogICAqLwogIGZ1bmN0aW9uIGNoZWNrQmFsYW5jZUF0KGFkZHJlc3MgdXNlckFkZHJlc3MsIHVpbnQyNTYgdGFyZ2V0QmxvY2spIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KXsKICAgICAgcmV0dXJuIHRva2VuLmJhbGFuY2VPZkF0KHVzZXJBZGRyZXNzLCB0YXJnZXRCbG9jayk7CiAgfQogIAogIC8qKgogICAqIEBkZXYgZ2V0IGF3YWlsYWJsZSBkaXZpZGVuZHMgZm9yIHdpdGhkcmF3YWwKICAgKiBAcGFyYW0gdXNlckFkZHJlc3MgLSB0YXJnZXQgCiAgICogQHJldHVybiBhbW91bnQgb2YgZXRoZXIgKHdlaSB2YWx1ZSkgZm9yIGN1cnJlbnQgdXNlcgogICAqLwogIGZ1bmN0aW9uIGF3YWlsYWJsZURpdmlkZW5kcyhhZGRyZXNzIHVzZXJBZGRyZXNzKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCl7CiAgICByZXR1cm4gdG9rZW4uYXdhaWxhYmxlRGl2aWRlbmRzKHVzZXJBZGRyZXNzKTsKICB9CiAgCiAgLyoqCiAgICogQHJldHVybiB0b3RhbCBwdXJjaGFzZWQgdG9rZW5zIHZhbHVlCiAgICovCiAgZnVuY3Rpb24gcmVkZWVtZWRTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KXsKICAgIHJldHVybiB0b2tlbi50b3RhbFN1cHBseSgpOwogIH0KICAKICAvKioKICAgKiBAZGV2IHVzZXItcmVsYXRlZCBtZXRob2QgZm9yIHdpdGhkcmF3YWwgZGl2aWRlbmRzCiAgICovCiAgZnVuY3Rpb24gd2l0aGRyYXdEaXZpZGVuZHMoKSBwdWJsaWMgewogICAgdWludCBfYW1vdW50ID0gYXdhaWxhYmxlRGl2aWRlbmRzKG1zZy5zZW5kZXIpOwogICAgcmVxdWlyZShfYW1vdW50ID4gMCk7CiAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKF9hbW91bnQpOwogICAgdG9rZW4ucmVjb3JkV2l0aGRyYXcobXNnLnNlbmRlcik7CiAgICBXaXRoZHJhd0RpdmlkZW5kcyhtc2cuc2VuZGVyLCBfYW1vdW50KTsKICB9CiAgCiAgLyoqCiAgICogQGRldiBmdW5jdGlvbiBmb3IgZGVwb3NpdCBldGhlciB0byB0b2tlbiBhZGRyZXNzIGFzL2ZvciBkaXZpZGVuZHMKICAgKi8KICBmdW5jdGlvbiBkZXBvc2l0Rm9yRGl2aWRlbmRzKCkgcHVibGljIHBheWFibGUgb25seU93bmVyIHsKICAgICAgcmVxdWlyZShtc2cudmFsdWUgPiAwKTsKICAgICAgdG9rZW4ucmVjb3JkRGVwb3NpdChtc2cudmFsdWUpOwogICAgICBEZXBvc2l0Rm9yRGl2aWRlbmRzKG1zZy52YWx1ZSk7CiAgfQogIAogIGZ1bmN0aW9uIHN0b3BTYWxlcygpIHB1YmxpYyBvbmx5T3duZXJ7CiAgIG1heFN1cHBseSA9IHRva2VuLnRvdGFsU3VwcGx5KCk7CiAgfQogICAKICBmdW5jdGlvbiBmb3J3YXJkRnVuZHMoKSBpbnRlcm5hbCB7CiAgICBvd25lci50cmFuc2Zlcihtc2cudmFsdWUpOwogIH0KICAKICBmdW5jdGlvbiByYXRlKCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgaWYocmVkZWVtZWRTdXBwbHkoKSA8IDEwMDAwMDAwMDAwMDApCiAgICAgICAgcmV0dXJuIDY3NTsKICAgIGVsc2UgaWYgKHJlZGVlbWVkU3VwcGx5KCkgPCA1MDAwMDAwMDAwMDAwKQogICAgICAgIHJldHVybiA1NjM7CiAgICBlbHNlCiAgICAgICAgcmV0dXJuIDQ1MDsKICB9Cn0='.
	

]
