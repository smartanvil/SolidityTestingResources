Class {
	#name : #SRT678b713730b6d5d9314d39c82662c08540916c75,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT678b713730b6d5d9314d39c82662c08540916c75 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBQYXVzYWJsZQogKiBAZGV2IEJhc2UgY29udHJhY3Qgd2hpY2ggYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uCiAqLwpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKICBldmVudCBQYXVzZSgpOwogIGV2ZW50IFVucGF1c2UoKTsKCiAgYm9vbCBwdWJsaWMgcGF1c2VkID0gZmFsc2U7CgoKICAvKioKICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIG5vdCBwYXVzZWQuCiAgICovCiAgbW9kaWZpZXIgd2hlbk5vdFBhdXNlZCgpIHsKICAgIHJlcXVpcmUoIXBhdXNlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBwYXVzZWQuCiAgICovCiAgbW9kaWZpZXIgd2hlblBhdXNlZCgpIHsKICAgIHJlcXVpcmUocGF1c2VkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gcGF1c2UsIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUKICAgKi8KICBmdW5jdGlvbiBwYXVzZSgpIG9ubHlPd25lciB3aGVuTm90UGF1c2VkIHB1YmxpYyB7CiAgICBwYXVzZWQgPSB0cnVlOwogICAgUGF1c2UoKTsKICB9CgogIC8qKgogICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byB1bnBhdXNlLCByZXR1cm5zIHRvIG5vcm1hbCBzdGF0ZQogICAqLwogIGZ1bmN0aW9uIHVucGF1c2UoKSBvbmx5T3duZXIgd2hlblBhdXNlZCBwdWJsaWMgewogICAgcGF1c2VkID0gZmFsc2U7CiAgICBVbnBhdXNlKCk7CiAgfQp9CgovKioKICogQHRpdGxlIENsYWltYWJsZQogKiBAZGV2IEV4dGVuc2lvbiBmb3IgdGhlIE93bmFibGUgY29udHJhY3QsIHdoZXJlIHRoZSBvd25lcnNoaXAgbmVlZHMgdG8gYmUgY2xhaW1lZC4KICogVGhpcyBhbGxvd3MgdGhlIG5ldyBvd25lciB0byBhY2NlcHQgdGhlIHRyYW5zZmVyLgogKi8KY29udHJhY3QgQ2xhaW1hYmxlIGlzIE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIHBlbmRpbmdPd25lcjsKCiAgLyoqCiAgICogQGRldiBNb2RpZmllciB0aHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIHBlbmRpbmdPd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5UGVuZGluZ093bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHBlbmRpbmdPd25lcik7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gc2V0IHRoZSBwZW5kaW5nT3duZXIgYWRkcmVzcy4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgcGVuZGluZ093bmVyID0gbmV3T3duZXI7CiAgfQoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgcGVuZGluZ093bmVyIGFkZHJlc3MgdG8gZmluYWxpemUgdGhlIHRyYW5zZmVyLgogICAqLwogIGZ1bmN0aW9uIGNsYWltT3duZXJzaGlwKCkgb25seVBlbmRpbmdPd25lciBwdWJsaWMgewogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIHBlbmRpbmdPd25lcik7CiAgICBvd25lciA9IHBlbmRpbmdPd25lcjsKICAgIHBlbmRpbmdPd25lciA9IGFkZHJlc3MoMCk7CiAgfQp9CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBFUkM3MjEgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9laXBzL2lzc3Vlcy83MjEKICovCmNvbnRyYWN0IEVSQzcyMSB7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF90b2tlbklkKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX2FwcHJvdmVkLCB1aW50MjU2IF90b2tlbklkKTsKCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IF9iYWxhbmNlKTsKICBmdW5jdGlvbiBvd25lck9mKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3MgX293bmVyKTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYzsKICBmdW5jdGlvbiB0YWtlT3duZXJzaGlwKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYzsKfQoKLyoqCiAqIEB0aXRsZSBFUkM3MjFUb2tlbgogKiBHZW5lcmljIGltcGxlbWVudGF0aW9uIGZvciB0aGUgcmVxdWlyZWQgZnVuY3Rpb25hbGl0eSBvZiB0aGUgRVJDNzIxIHN0YW5kYXJkCiAqLwpjb250cmFjdCBFUkM3MjFUb2tlbiBpcyBFUkM3MjEgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAvLyBUb3RhbCBhbW91bnQgb2YgdG9rZW5zCiAgdWludDI1NiBwcml2YXRlIHRvdGFsVG9rZW5zOwoKICAvLyBNYXBwaW5nIGZyb20gdG9rZW4gSUQgdG8gb3duZXIKICBtYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIHByaXZhdGUgdG9rZW5Pd25lcjsKCiAgLy8gTWFwcGluZyBmcm9tIHRva2VuIElEIHRvIGFwcHJvdmVkIGFkZHJlc3MKICBtYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIHByaXZhdGUgdG9rZW5BcHByb3ZhbHM7CgogIC8vIE1hcHBpbmcgZnJvbSBvd25lciB0byBsaXN0IG9mIG93bmVkIHRva2VuIElEcwogIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NltdKSBwcml2YXRlIG93bmVkVG9rZW5zOwoKICAvLyBNYXBwaW5nIGZyb20gdG9rZW4gSUQgdG8gaW5kZXggb2YgdGhlIG93bmVyIHRva2VucyBsaXN0CiAgbWFwcGluZyh1aW50MjU2ID0+IHVpbnQyNTYpIHByaXZhdGUgb3duZWRUb2tlbnNJbmRleDsKCiAgLyoqCiAgKiBAZGV2IEd1YXJhbnRlZXMgbXNnLnNlbmRlciBpcyBvd25lciBvZiB0aGUgZ2l2ZW4gdG9rZW4KICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIHRoZSB0b2tlbiB0byB2YWxpZGF0ZSBpdHMgb3duZXJzaGlwIGJlbG9uZ3MgdG8gbXNnLnNlbmRlcgogICovCiAgbW9kaWZpZXIgb25seU93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgewogICAgcmVxdWlyZShvd25lck9mKF90b2tlbklkKSA9PSBtc2cuc2VuZGVyKTsKICAgIF87CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgdG90YWwgYW1vdW50IG9mIHRva2VucyBzdG9yZWQgYnkgdGhlIGNvbnRyYWN0CiAgKiBAcmV0dXJuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSB0b3RhbCBhbW91bnQgb2YgdG9rZW5zCiAgKi8KICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiB0b3RhbFRva2VuczsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF9vd25lciBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSBiYWxhbmNlIG9mCiAgKiBAcmV0dXJuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzCiAgKi8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBvd25lZFRva2Vuc1tfb3duZXJdLmxlbmd0aDsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBsaXN0IG9mIHRva2VucyBvd25lZCBieSBhIGdpdmVuIGFkZHJlc3MKICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyB0byBxdWVyeSB0aGUgdG9rZW5zIG9mCiAgKiBAcmV0dXJuIHVpbnQyNTZbXSByZXByZXNlbnRpbmcgdGhlIGxpc3Qgb2YgdG9rZW5zIG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcwogICovCiAgZnVuY3Rpb24gdG9rZW5zT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTZbXSkgewogICAgcmV0dXJuIG93bmVkVG9rZW5zW19vd25lcl07CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgb3duZXIgb2YgdGhlIHNwZWNpZmllZCB0b2tlbiBJRAogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIHF1ZXJ5IHRoZSBvd25lciBvZgogICogQHJldHVybiBvd25lciBhZGRyZXNzIGN1cnJlbnRseSBtYXJrZWQgYXMgdGhlIG93bmVyIG9mIHRoZSBnaXZlbiB0b2tlbiBJRAogICovCiAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICBhZGRyZXNzIG93bmVyID0gdG9rZW5Pd25lcltfdG9rZW5JZF07CiAgICByZXF1aXJlKG93bmVyICE9IGFkZHJlc3MoMCkpOwogICAgcmV0dXJuIG93bmVyOwogIH0KCiAgLyoqCiAgICogQGRldiBHZXRzIHRoZSBhcHByb3ZlZCBhZGRyZXNzIHRvIHRha2Ugb3duZXJzaGlwIG9mIGEgZ2l2ZW4gdG9rZW4gSUQKICAgKiBAcGFyYW0gX3Rva2VuSWQgdWludDI1NiBJRCBvZiB0aGUgdG9rZW4gdG8gcXVlcnkgdGhlIGFwcHJvdmFsIG9mCiAgICogQHJldHVybiBhZGRyZXNzIGN1cnJlbnRseSBhcHByb3ZlZCB0byB0YWtlIG93bmVyc2hpcCBvZiB0aGUgZ2l2ZW4gdG9rZW4gSUQKICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlZEZvcih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICByZXR1cm4gdG9rZW5BcHByb3ZhbHNbX3Rva2VuSWRdOwogIH0KCiAgLyoqCiAgKiBAZGV2IFRyYW5zZmVycyB0aGUgb3duZXJzaGlwIG9mIGEgZ2l2ZW4gdG9rZW4gSUQgdG8gYW5vdGhlciBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgdG8gcmVjZWl2ZSB0aGUgb3duZXJzaGlwIG9mIHRoZSBnaXZlbiB0b2tlbiBJRAogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIG9ubHlPd25lck9mKF90b2tlbklkKSB7CiAgICBjbGVhckFwcHJvdmFsQW5kVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdG9rZW5JZCk7CiAgfQoKICAvKioKICAqIEBkZXYgQXBwcm92ZXMgYW5vdGhlciBhZGRyZXNzIHRvIGNsYWltIGZvciB0aGUgb3duZXJzaGlwIG9mIHRoZSBnaXZlbiB0b2tlbiBJRAogICogQHBhcmFtIF90byBhZGRyZXNzIHRvIGJlIGFwcHJvdmVkIGZvciB0aGUgZ2l2ZW4gdG9rZW4gSUQKICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIHRoZSB0b2tlbiB0byBiZSBhcHByb3ZlZAogICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIG9ubHlPd25lck9mKF90b2tlbklkKSB7CiAgICBhZGRyZXNzIG93bmVyID0gb3duZXJPZihfdG9rZW5JZCk7CiAgICByZXF1aXJlKF90byAhPSBvd25lcik7CiAgICBpZiAoYXBwcm92ZWRGb3IoX3Rva2VuSWQpICE9IDAgfHwgX3RvICE9IDApIHsKICAgICAgdG9rZW5BcHByb3ZhbHNbX3Rva2VuSWRdID0gX3RvOwogICAgICBBcHByb3ZhbChvd25lciwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CiAgfQoKICAvKioKICAqIEBkZXYgQ2xhaW1zIHRoZSBvd25lcnNoaXAgb2YgYSBnaXZlbiB0b2tlbiBJRAogICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIGJlaW5nIGNsYWltZWQgYnkgdGhlIG1zZy5zZW5kZXIKICAqLwogIGZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHsKICAgIHJlcXVpcmUoaXNBcHByb3ZlZEZvcihtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwogICAgY2xlYXJBcHByb3ZhbEFuZFRyYW5zZmVyKG93bmVyT2YoX3Rva2VuSWQpLCBtc2cuc2VuZGVyLCBfdG9rZW5JZCk7CiAgfQoKICAvKioKICAqIEBkZXYgTWludCB0b2tlbiBmdW5jdGlvbgogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgb3duIHRoZSBtaW50ZWQgdG9rZW4KICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIHRoZSB0b2tlbiB0byBiZSBtaW50ZWQgYnkgdGhlIG1zZy5zZW5kZXIKICAqLwogIGZ1bmN0aW9uIF9taW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBpbnRlcm5hbCB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIGFkZFRva2VuKF90bywgX3Rva2VuSWQpOwogICAgVHJhbnNmZXIoMHgwLCBfdG8sIF90b2tlbklkKTsKICB9CgogIC8qKgogICogQGRldiBCdXJucyBhIHNwZWNpZmljIHRva2VuCiAgKiBAcGFyYW0gX3Rva2VuSWQgdWludDI1NiBJRCBvZiB0aGUgdG9rZW4gYmVpbmcgYnVybmVkIGJ5IHRoZSBtc2cuc2VuZGVyCiAgKi8KICBmdW5jdGlvbiBfYnVybih1aW50MjU2IF90b2tlbklkKSBvbmx5T3duZXJPZihfdG9rZW5JZCkgaW50ZXJuYWwgewogICAgaWYgKGFwcHJvdmVkRm9yKF90b2tlbklkKSAhPSAwKSB7CiAgICAgIGNsZWFyQXBwcm92YWwobXNnLnNlbmRlciwgX3Rva2VuSWQpOwogICAgfQogICAgcmVtb3ZlVG9rZW4obXNnLnNlbmRlciwgX3Rva2VuSWQpOwogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgMHgwLCBfdG9rZW5JZCk7CiAgfQoKICAvKioKICAgKiBAZGV2IFRlbGxzIHdoZXRoZXIgdGhlIG1zZy5zZW5kZXIgaXMgYXBwcm92ZWQgZm9yIHRoZSBnaXZlbiB0b2tlbiBJRCBvciBub3QKICAgKiBUaGlzIGZ1bmN0aW9uIGlzIG5vdCBwcml2YXRlIHNvIGl0IGNhbiBiZSBleHRlbmRlZCBpbiBmdXJ0aGVyIGltcGxlbWVudGF0aW9ucyBsaWtlIHRoZSBvcGVyYXRhYmxlIEVSQzcyMQogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBvZiB0aGUgb3duZXIgdG8gcXVlcnkgdGhlIGFwcHJvdmFsIG9mCiAgICogQHBhcmFtIF90b2tlbklkIHVpbnQyNTYgSUQgb2YgdGhlIHRva2VuIHRvIHF1ZXJ5IHRoZSBhcHByb3ZhbCBvZgogICAqIEByZXR1cm4gYm9vbCB3aGV0aGVyIHRoZSBtc2cuc2VuZGVyIGlzIGFwcHJvdmVkIGZvciB0aGUgZ2l2ZW4gdG9rZW4gSUQgb3Igbm90CiAgICovCiAgZnVuY3Rpb24gaXNBcHByb3ZlZEZvcihhZGRyZXNzIF9vd25lciwgdWludDI1NiBfdG9rZW5JZCkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gYXBwcm92ZWRGb3IoX3Rva2VuSWQpID09IF9vd25lcjsKICB9CgogIC8qKgogICogQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byBjbGVhciBjdXJyZW50IGFwcHJvdmFsIGFuZCB0cmFuc2ZlciB0aGUgb3duZXJzaGlwIG9mIGEgZ2l2ZW4gdG9rZW4gSUQKICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAqIEBwYXJhbSBfdG8gYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0aGUgdG9rZW4gdG8KICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIHRoZSB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZAogICovCiAgZnVuY3Rpb24gY2xlYXJBcHByb3ZhbEFuZFRyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBpbnRlcm5hbCB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3RvICE9IG93bmVyT2YoX3Rva2VuSWQpKTsKICAgIHJlcXVpcmUob3duZXJPZihfdG9rZW5JZCkgPT0gX2Zyb20pOwoKICAgIGNsZWFyQXBwcm92YWwoX2Zyb20sIF90b2tlbklkKTsKICAgIHJlbW92ZVRva2VuKF9mcm9tLCBfdG9rZW5JZCk7CiAgICBhZGRUb2tlbihfdG8sIF90b2tlbklkKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICB9CgogIC8qKgogICogQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byBjbGVhciBjdXJyZW50IGFwcHJvdmFsIG9mIGEgZ2l2ZW4gdG9rZW4gSUQKICAqIEBwYXJhbSBfdG9rZW5JZCB1aW50MjU2IElEIG9mIHRoZSB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZAogICovCiAgZnVuY3Rpb24gY2xlYXJBcHByb3ZhbChhZGRyZXNzIF9vd25lciwgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB7CiAgICByZXF1aXJlKG93bmVyT2YoX3Rva2VuSWQpID09IF9vd25lcik7CiAgICB0b2tlbkFwcHJvdmFsc1tfdG9rZW5JZF0gPSAwOwogICAgQXBwcm92YWwoX293bmVyLCAwLCBfdG9rZW5JZCk7CiAgfQoKICAvKioKICAqIEBkZXYgSW50ZXJuYWwgZnVuY3Rpb24gdG8gYWRkIGEgdG9rZW4gSUQgdG8gdGhlIGxpc3Qgb2YgYSBnaXZlbiBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgcmVwcmVzZW50aW5nIHRoZSBuZXcgb3duZXIgb2YgdGhlIGdpdmVuIHRva2VuIElECiAgKiBAcGFyYW0gX3Rva2VuSWQgdWludDI1NiBJRCBvZiB0aGUgdG9rZW4gdG8gYmUgYWRkZWQgdG8gdGhlIHRva2VucyBsaXN0IG9mIHRoZSBnaXZlbiBhZGRyZXNzCiAgKi8KICBmdW5jdGlvbiBhZGRUb2tlbihhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB7CiAgICByZXF1aXJlKHRva2VuT3duZXJbX3Rva2VuSWRdID09IGFkZHJlc3MoMCkpOwogICAgdG9rZW5Pd25lcltfdG9rZW5JZF0gPSBfdG87CiAgICB1aW50MjU2IGxlbmd0aCA9IGJhbGFuY2VPZihfdG8pOwogICAgb3duZWRUb2tlbnNbX3RvXS5wdXNoKF90b2tlbklkKTsKICAgIG93bmVkVG9rZW5zSW5kZXhbX3Rva2VuSWRdID0gbGVuZ3RoOwogICAgdG90YWxUb2tlbnMgPSB0b3RhbFRva2Vucy5hZGQoMSk7CiAgfQoKICAvKioKICAqIEBkZXYgSW50ZXJuYWwgZnVuY3Rpb24gdG8gcmVtb3ZlIGEgdG9rZW4gSUQgZnJvbSB0aGUgbGlzdCBvZiBhIGdpdmVuIGFkZHJlc3MKICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIHJlcHJlc2VudGluZyB0aGUgcHJldmlvdXMgb3duZXIgb2YgdGhlIGdpdmVuIHRva2VuIElECiAgKiBAcGFyYW0gX3Rva2VuSWQgdWludDI1NiBJRCBvZiB0aGUgdG9rZW4gdG8gYmUgcmVtb3ZlZCBmcm9tIHRoZSB0b2tlbnMgbGlzdCBvZiB0aGUgZ2l2ZW4gYWRkcmVzcwogICovCiAgZnVuY3Rpb24gcmVtb3ZlVG9rZW4oYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB7CiAgICByZXF1aXJlKG93bmVyT2YoX3Rva2VuSWQpID09IF9mcm9tKTsKCiAgICB1aW50MjU2IHRva2VuSW5kZXggPSBvd25lZFRva2Vuc0luZGV4W190b2tlbklkXTsKICAgIHVpbnQyNTYgbGFzdFRva2VuSW5kZXggPSBiYWxhbmNlT2YoX2Zyb20pLnN1YigxKTsKICAgIHVpbnQyNTYgbGFzdFRva2VuID0gb3duZWRUb2tlbnNbX2Zyb21dW2xhc3RUb2tlbkluZGV4XTsKCiAgICB0b2tlbk93bmVyW190b2tlbklkXSA9IDA7CiAgICBvd25lZFRva2Vuc1tfZnJvbV1bdG9rZW5JbmRleF0gPSBsYXN0VG9rZW47CiAgICBvd25lZFRva2Vuc1tfZnJvbV1bbGFzdFRva2VuSW5kZXhdID0gMDsKICAgIC8vIE5vdGUgdGhhdCB0aGlzIHdpbGwgaGFuZGxlIHNpbmdsZS1lbGVtZW50IGFycmF5cy4gSW4gdGhhdCBjYXNlLCBib3RoIHRva2VuSW5kZXggYW5kIGxhc3RUb2tlbkluZGV4IGFyZSBnb2luZyB0bwogICAgLy8gYmUgemVyby4gVGhlbiB3ZSBjYW4gbWFrZSBzdXJlIHRoYXQgd2Ugd2lsbCByZW1vdmUgX3Rva2VuSWQgZnJvbSB0aGUgb3duZWRUb2tlbnMgbGlzdCBzaW5jZSB3ZSBhcmUgZmlyc3Qgc3dhcHBpbmcKICAgIC8vIHRoZSBsYXN0VG9rZW4gdG8gdGhlIGZpcnN0IHBvc2l0aW9uLCBhbmQgdGhlbiBkcm9wcGluZyB0aGUgZWxlbWVudCBwbGFjZWQgaW4gdGhlIGxhc3QgcG9zaXRpb24gb2YgdGhlIGxpc3QKCiAgICBvd25lZFRva2Vuc1tfZnJvbV0ubGVuZ3RoLS07CiAgICBvd25lZFRva2Vuc0luZGV4W190b2tlbklkXSA9IDA7CiAgICBvd25lZFRva2Vuc0luZGV4W2xhc3RUb2tlbl0gPSB0b2tlbkluZGV4OwogICAgdG90YWxUb2tlbnMgPSB0b3RhbFRva2Vucy5zdWIoMSk7CiAgfQp9CgovKioKICogQHRpdGxlIEFjY2Vzc01pbnQKICogQGRldiBBZGRzIGdyYW50L3Jldm9rZSBmdW5jdGlvbnMgdG8gdGhlIGNvbnRyYWN0LgogKi8KY29udHJhY3QgQWNjZXNzTWludCBpcyBDbGFpbWFibGUgewoKICAvLyBBY2Nlc3MgZm9yIG1pbnRpbmcgbmV3IHRva2Vucy4KICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgcHJpdmF0ZSBtaW50QWNjZXNzOwoKICAvLyBFdmVudCB0aGF0IGlzIGZpcmVkIHdoZW4gbWludGVkLgogIGV2ZW50IE1pbnQoCiAgICBhZGRyZXNzIGluZGV4ZWQgX3RvLAogICAgdWludDI1NiBpbmRleGVkIF90b2tlbklkCiAgKTsKCiAgLy8gTW9kaWZpZXIgZm9yIGFjY2Vzc2liaWxpdHkgdG8gZGVmaW5lIG5ldyBoZXJvIHR5cGVzLgogIG1vZGlmaWVyIG9ubHlBY2Nlc3NNaW50IHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lciB8fCBtaW50QWNjZXNzW21zZy5zZW5kZXJdID09IHRydWUpOwogICAgXzsKICB9CgogIC8vIEBkZXYgR3JhbnQgYWNlc3MgdG8gbWludCBoZXJvZXMuCiAgZnVuY3Rpb24gZ3JhbnRBY2Nlc3NNaW50KGFkZHJlc3MgX2FkZHJlc3MpCiAgICBvbmx5T3duZXIKICAgIHB1YmxpYwogIHsKICAgIG1pbnRBY2Nlc3NbX2FkZHJlc3NdID0gdHJ1ZTsKICB9CgogIC8vIEBkZXYgUmV2b2tlIGFjZXNzIHRvIG1pbnQgaGVyb2VzLgogIGZ1bmN0aW9uIHJldm9rZUFjY2Vzc01pbnQoYWRkcmVzcyBfYWRkcmVzcykKICAgIG9ubHlPd25lcgogICAgcHVibGljCiAgewogICAgbWludEFjY2Vzc1tfYWRkcmVzc10gPSBmYWxzZTsKICB9Cgp9CgovKioKICogQHRpdGxlIFRoZSBzd2FwIGNvbnRyYWN0IChDYXJkID0+IHJld2FyZCkKICogQGRldiBXaXRoIHRoaXMgY29udHJhY3QsIGEgQ3J5cHRvU2FnYUNhcmQgaG9sZGVyIGNhbiBzd2FwIGhpcy9oZXIgQ3J5cHRvU2FnYUNhcmQgZm9yIHJld2FyZC4KICogIFRoaXMgY29udHJhY3QgaXMgaW50ZW5kZWQgdG8gYmUgaW5oZXJpdGVkIGJ5IENyeXB0b1NhZ2FDb3JlIGxhdGVyLgogKi8KY29udHJhY3QgQ3J5cHRvU2FnYUNhcmRTd2FwIGlzIE93bmFibGUgewoKICAvLyBDYXJkIGNvbnRyYWN0LgogIGFkZHJlc3MgaW50ZXJuYWwgY2FyZEFkZGVzczsKCiAgLy8gTW9kaWZpZXIgZm9yIGFjY2Vzc2liaWxpdHkgdG8gZGVmaW5lIG5ldyBoZXJvIHR5cGVzLgogIG1vZGlmaWVyIG9ubHlDYXJkIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjYXJkQWRkZXNzKTsKICAgIF87CiAgfQogIAogIC8vIEBkZXYgU2V0IHRoZSBhZGRyZXNzIG9mIHRoZSBjb250cmFjdCB0aGF0IHJlcHJlc2VudHMgRVJDNzIxIENhcmQuCiAgZnVuY3Rpb24gc2V0Q2FyZENvbnRyYWN0KGFkZHJlc3MgX2NvbnRyYWN0QWRkcmVzcykKICAgIHB1YmxpYwogICAgb25seU93bmVyCiAgewogICAgY2FyZEFkZGVzcyA9IF9jb250cmFjdEFkZHJlc3M7CiAgfQoKICAvLyBAZGV2IENvbnZlcnQgY2FyZCBpbnRvIHJld2FyZC4KICAvLyAgVGhpcyBzaG91bGQgYmUgaW1wbGVtZW50ZWQgYnkgQ3J5cHRvU2FnYUNvcmUgbGF0ZXIuCiAgZnVuY3Rpb24gc3dhcENhcmRGb3JSZXdhcmQoYWRkcmVzcyBfYnksIHVpbnQ4IF9yYW5rKQogICAgb25seUNhcmQKICAgIHB1YmxpYyAKICAgIHJldHVybnMgKHVpbnQyNTYpCiAgewogICAgcmV0dXJuIDA7CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBDcnlwdG9TYWdhIENhcmQKICogQGRldiBFUkM3MjEgVG9rZW4gdGhhdCByZXBlc2VudHMgQ3J5cHRvU2FnYSdzIGNhcmRzLgogKiAgQnV5IGNvbnN1bWluZyBhIGNhcmQsIHBsYXllcnMgb2YgQ3J5cHRvU2FnYSBjYW4gZ2V0IGEgaGVyb2UuCiAqLwpjb250cmFjdCBDcnlwdG9TYWdhQ2FyZCBpcyBFUkM3MjFUb2tlbiwgQ2xhaW1hYmxlLCBBY2Nlc3NNaW50IHsKCiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIkNyeXB0b1NhZ2EgQ2FyZCI7CiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiQ0FSRCI7CgogIC8vIFJhbmsgb2YgdGhlIHRva2VuLgogIG1hcHBpbmcodWludDI1NiA9PiB1aW50OCkgcHVibGljIHRva2VuSWRUb1Jhbms7CgogIC8vIFRoZSBudW1iZXIgb2YgdG9rZW5zIGV2ZXIgbWludGVkLgogIHVpbnQyNTYgcHVibGljIG51bWJlck9mVG9rZW5JZDsKCiAgLy8gVGhlIGNvbnZlcnRlciBjb250cmFjdC4KICBDcnlwdG9TYWdhQ2FyZFN3YXAgcHJpdmF0ZSBzd2FwQ29udHJhY3Q7CgogIC8vIEV2ZW50IHRoYXQgc2hvdWxkIGJlIGZpcmVkIHdoZW4gY2FyZCBpcyBjb252ZXJ0ZWQuCiAgZXZlbnQgQ2FyZFN3YXAoYWRkcmVzcyBpbmRleGVkIF9ieSwgdWludDI1NiBfdG9rZW5JZCwgdWludDI1NiBfcmV3YXJkSWQpOwoKICAvLyBAZGV2IFNldCB0aGUgYWRkcmVzcyBvZiB0aGUgY29udHJhY3QgdGhhdCByZXByZXNlbnRzIENyeXB0b1NhZ2EgQ2FyZHMuCiAgZnVuY3Rpb24gc2V0Q3J5cHRvU2FnYUNhcmRTd2FwQ29udHJhY3QoYWRkcmVzcyBfY29udHJhY3RBZGRyZXNzKQogICAgcHVibGljCiAgICBvbmx5T3duZXIKICB7CiAgICBzd2FwQ29udHJhY3QgPSBDcnlwdG9TYWdhQ2FyZFN3YXAoX2NvbnRyYWN0QWRkcmVzcyk7CiAgfQoKICBmdW5jdGlvbiByYW5rT2YodWludDI1NiBfdG9rZW5JZCkgCiAgICBwdWJsaWMgdmlldwogICAgcmV0dXJucyAodWludDgpCiAgewogICAgcmV0dXJuIHRva2VuSWRUb1JhbmtbX3Rva2VuSWRdOwogIH0KCiAgLy8gQGRldiBNaW50IGEgbmV3IGNhcmQuCiAgZnVuY3Rpb24gbWludChhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludDI1NiBfYW1vdW50LCB1aW50OCBfcmFuaykKICAgIG9ubHlBY2Nlc3NNaW50CiAgICBwdWJsaWMKICB7CiAgICBmb3IgKHVpbnQyNTYgaSA9IDA7IGkgPCBfYW1vdW50OyBpKyspIHsKICAgICAgX21pbnQoX2JlbmVmaWNpYXJ5LCBudW1iZXJPZlRva2VuSWQpOwogICAgICB0b2tlbklkVG9SYW5rW251bWJlck9mVG9rZW5JZF0gPSBfcmFuazsKICAgICAgbnVtYmVyT2ZUb2tlbklkICsrOwogICAgfQogIH0KCiAgLy8gQGRldiBTd2FwIHRoaXMgY2FyZCBmb3IgcmV3YXJkLgogIC8vICBUaGUgY2FyZCB3aWxsIGJlIGJ1cm50LgogIGZ1bmN0aW9uIHN3YXAodWludDI1NiBfdG9rZW5JZCkKICAgIG9ubHlPd25lck9mKF90b2tlbklkKQogICAgcHVibGljCiAgICByZXR1cm5zICh1aW50MjU2KQogIHsKICAgIHJlcXVpcmUoYWRkcmVzcyhzd2FwQ29udHJhY3QpICE9IGFkZHJlc3MoMCkpOwoKICAgIHZhciBfcmFuayA9IHRva2VuSWRUb1JhbmtbX3Rva2VuSWRdOwogICAgdmFyIF9yZXdhcmRJZCA9IHN3YXBDb250cmFjdC5zd2FwQ2FyZEZvclJld2FyZCh0aGlzLCBfcmFuayk7CiAgICBDYXJkU3dhcChvd25lck9mKF90b2tlbklkKSwgX3Rva2VuSWQsIF9yZXdhcmRJZCk7CiAgICBfYnVybihfdG9rZW5JZCk7CiAgICByZXR1cm4gX3Jld2FyZElkOwogIH0KCn0KCi8qKgogKiBAdGl0bGUgVGhlIHNtYXJ0IGNvbnRyYWN0IGZvciB0aGUgcHJlLXNhbGUuCiAqIEBkZXYgT3JpZ2luIENhcmQgaXMgYW4gRVJDMjAgdG9rZW4uCiAqLwpjb250cmFjdCBQcmVzYWxlIGlzIFBhdXNhYmxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgLy8gRXRoIHdpbGwgYmUgc2VudCB0byB0aGlzIHdhbGxldC4KICBhZGRyZXNzIHB1YmxpYyB3YWxsZXQ7CgogIC8vIFRoZSB0b2tlbiBjb250cmFjdC4KICBDcnlwdG9TYWdhQ2FyZCBwdWJsaWMgY2FyZENvbnRyYWN0OwoKICAvLyBTdGFydCBhbmQgZW5kIHRpbWVzdGFtcHMgd2hlcmUgaW52ZXN0bWVudHMgYXJlIGFsbG93ZWQgKGJvdGggaW5jbHVzaXZlKS4KICB1aW50MjU2IHB1YmxpYyBzdGFydFRpbWU7CiAgdWludDI1NiBwdWJsaWMgZW5kVGltZTsKCiAgLy8gUHJpY2UgZm9yIGEgY2FyZCBpbiB3ZWkuCiAgdWludDI1NiBwdWJsaWMgcHJpY2U7CgogIC8vIEFtb3VudCBvZiBjYXJkIHNvbGQuCiAgdWludDI1NiBwdWJsaWMgc29sZENhcmRzOwoKICAvLyBJbmNyZWFzZSBvZiBwcmljZSBwZXIgdHJhbnNhY3Rpb24uCiAgdWludDI1NiBwdWJsaWMgcHJpY2VJbmNyZWFzZTsKCiAgLy8gQW1vdW50IG9mIGNhcmQgcmVkZWVtZWQuCiAgdWludDI1NiBwdWJsaWMgcmVkZWVtZWRDYXJkczsKCiAgLy8gRXZlbnQgdGhhdCBpcyBmaXJlZCB3aGVuIHB1cmNoYXNlIHRyYW5zYWN0aW9uIGlzIG1hZGUuCiAgZXZlbnQgVG9rZW5QdXJjaGFzZSgKICAgIGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsIAogICAgYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCAKICAgIHVpbnQyNTYgdmFsdWUsCiAgICB1aW50MjU2IGFtb3VudAogICk7CgogIC8vIEV2ZW50IHRoYXQgaXMgZmlyZWQgd2hlbiByZWRlZW0gdG9rZW5zLgogIGV2ZW50IFRva2VuUmVkZWVtKAogICAgYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LAogICAgdWludDI1NiBhbW91bnQKICApOwoKICAvLyBFdmVudCB0aGF0IGlzIGZpcmVkIHdoZW4gcmVmdW5kaW5nIGV4Y2Vzc2l2ZSBtb25leSBmcm9tIHRoZXIgdXNlci4KICBldmVudCBSZWZ1bmRFdGgoCiAgICBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksCiAgICB1aW50MjU2IGFtb3VudAogICk7CgogIC8vIEBkZXYgQ29udHJ1Y3Rvci4KICBmdW5jdGlvbiBQcmVzYWxlKGFkZHJlc3MgX3dhbGxldCwgYWRkcmVzcyBfY2FyZEFkZHJlc3MsIHVpbnQyNTYgX3N0YXJ0VGltZSwgdWludDI1NiBfZW5kVGltZSwgdWludDI1NiBfcHJpY2UsIHVpbnQyNTYgX3ByaWNlSW5jcmVhc2UpCiAgICBwdWJsaWMKICB7CiAgICByZXF1aXJlKF9lbmRUaW1lID49IF9zdGFydFRpbWUpOwogICAgcmVxdWlyZShfcHJpY2UgPj0gMCk7CiAgICByZXF1aXJlKF9wcmljZUluY3JlYXNlID49IDApOwogICAgcmVxdWlyZShfd2FsbGV0ICE9IGFkZHJlc3MoMCkpOwogICAgCiAgICB3YWxsZXQgPSBfd2FsbGV0OwogICAgY2FyZENvbnRyYWN0ID0gQ3J5cHRvU2FnYUNhcmQoX2NhcmRBZGRyZXNzKTsKICAgIHN0YXJ0VGltZSA9IF9zdGFydFRpbWU7CiAgICBlbmRUaW1lID0gX2VuZFRpbWU7CiAgICBwcmljZSA9IF9wcmljZTsKICAgIHByaWNlSW5jcmVhc2UgPSBfcHJpY2VJbmNyZWFzZTsKICB9CgogIC8vIEByZXR1cm4gdHJ1ZSBpZiB0aGUgdHJhbnNhY3Rpb24gY2FuIGJ1eSB0b2tlbnMKICBmdW5jdGlvbiB2YWxpZFB1cmNoYXNlKCkKICAgIGludGVybmFsIHZpZXcgCiAgICByZXR1cm5zIChib29sKQogIHsKICAgIGJvb2wgd2l0aGluUGVyaW9kID0gbm93ID49IHN0YXJ0VGltZSAmJiBub3cgPD0gZW5kVGltZTsKICAgIGJvb2wgbm9uWmVyb1B1cmNoYXNlID0gbXNnLnZhbHVlICE9IDA7CiAgICByZXR1cm4gd2l0aGluUGVyaW9kICYmIG5vblplcm9QdXJjaGFzZTsKICB9CgogIC8vIEBOb3RpZnkgUmVkZWVtIGxpbWl0IGlzIDUwMCBjYXJkcy4KICAvLyBAcmV0dXJuIHRydWUgaWYgdGhlIHRyYW5zYWN0aW9uIGNhbiByZWRlZW0gdG9rZW5zCiAgZnVuY3Rpb24gdmFsaWRSZWRlZW0oKQogICAgaW50ZXJuYWwgdmlldwogICAgcmV0dXJucyAoYm9vbCkKICB7CiAgICBib29sIHdpdGhpblBlcmlvZCA9IG5vdyA+PSBzdGFydFRpbWUgJiYgbm93IDw9IGVuZFRpbWU7CiAgICBib29sIG5vdEV4Y2VlZFJlZGVlbUxpbWl0ID0gcmVkZWVtZWRDYXJkcyA8IDUwMDsKICAgIHJldHVybiB3aXRoaW5QZXJpb2QgJiYgbm90RXhjZWVkUmVkZWVtTGltaXQ7CiAgfQoKICAvLyBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBlbmRlZAogIGZ1bmN0aW9uIGhhc0VuZGVkKCkKICAgIHB1YmxpYyB2aWV3IAogICAgcmV0dXJucyAoYm9vbCkgCiAgewogICAgcmV0dXJuIG5vdyA+IGVuZFRpbWU7CiAgfQoKCiAgLy8gQGRldiBMb3cgbGV2ZWwgdG9rZW4gcHVyY2hhc2UgZnVuY3Rpb24uCiAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCB1aW50MjU2IF9hbW91bnQpCiAgICB3aGVuTm90UGF1c2VkCiAgICBwdWJsaWMKICAgIHBheWFibGUKICB7CiAgICByZXF1aXJlKF9iZW5lZmljaWFyeSAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUodmFsaWRQdXJjaGFzZSgpKTsKICAgIHJlcXVpcmUoX2Ftb3VudCA+PSAxICYmIF9hbW91bnQgPD0gNSk7CgogICAgdmFyIF9wcmljZU9mQnVuZGxlID0gcHJpY2UubXVsKF9hbW91bnQpOwoKICAgIHJlcXVpcmUobXNnLnZhbHVlID49IF9wcmljZU9mQnVuZGxlKTsKCiAgICAvLyBJbmNyZWFzZSB0aGUgcHJpY2UuCiAgICAvLyBUaGUgcHJpY2UgaW5jcmVhc2VzIG9ubHkgd2hlbiBhIHRyYW5zYWN0aW9uIGlzIG1hZGUuCiAgICAvLyBBbW91bnQgb2YgdG9rZW5zIHB1cmNoYXNlIGF0IGEgdHJhbnNhY3Rpb24gd29uJ3QgYWZmZWN0IHRoZSBwcmljZS4KICAgIHByaWNlID0gcHJpY2UuYWRkKHByaWNlSW5jcmVhc2UpOwoKICAgIC8vIE1pbnQgdG9rZW5zLgogICAgLy8gUmFuayAwIG1lYW5zIE9yaWdpbiBDYXJkLgogICAgY2FyZENvbnRyYWN0Lm1pbnQoX2JlbmVmaWNpYXJ5LCBfYW1vdW50LCAwKTsKCiAgICAvLyBBZGQgY291bnQgb2YgdG9rZW5zIHNvbGQuCiAgICBzb2xkQ2FyZHMgKz0gX2Ftb3VudDsKCiAgICAvLyBTZW5kIHRoZSByYWlzZWQgZXRoIHRvIHRoZSB3YWxsZXQuCiAgICB3YWxsZXQudHJhbnNmZXIoX3ByaWNlT2ZCdW5kbGUpOwoKICAgIC8vIFNlbmQgdGhlIGV4dGEgZXRoIHBhaWQgYnkgdGhlIHNlbmRlci4KICAgIHZhciBfZXh0cmFFdGhJbldlaSA9IG1zZy52YWx1ZS5zdWIoX3ByaWNlT2ZCdW5kbGUpOwogICAgaWYgKF9leHRyYUV0aEluV2VpID49IDApIHsKICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihfZXh0cmFFdGhJbldlaSk7CiAgICB9CgogICAgLy8gRmlyZSBldmVudC4KICAgIFRva2VuUHVyY2hhc2UobXNnLnNlbmRlciwgX2JlbmVmaWNpYXJ5LCBtc2cudmFsdWUsIF9hbW91bnQpOwogIH0KCiAgLy8gQGRldiBMb3cgbGV2ZWwgdG9rZW4gcmVkZWVtIGZ1bmN0aW9uLgogIGZ1bmN0aW9uIHJlZGVlbVRva2VucyhhZGRyZXNzIF9iZW5lZmljaWFyeSkKICAgIG9ubHlPd25lcgogICAgcHVibGljCiAgewogICAgcmVxdWlyZShfYmVuZWZpY2lhcnkgIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKHZhbGlkUmVkZWVtKCkpOwoKICAgIC8vIE1pbnQgdG9rZW4uCiAgICAvLyBSYW5rIDAgbWVhbnMgT3JpZ2luIENhcmQuCiAgICBjYXJkQ29udHJhY3QubWludChfYmVuZWZpY2lhcnksIDEsIDApOwoKICAgIC8vIEFkZCBjb3VudCBvZiB0b2tlbnMgcmVkZWVtZWQuCiAgICByZWRlZW1lZENhcmRzICsrOwoKICAgIC8vIEZpcmUgZXZlbnQuCiAgICBUb2tlblJlZGVlbShfYmVuZWZpY2lhcnksIDEpOwogIH0KCiAgLy8gQGRldiBTZXQgcHJpY2UgaW5jcmVhc2Ugb2YgdG9rZW4gcGVyIHRyYW5zYWN0aW9uLgogIC8vICBOb3RlIHRoYXQgdGhpcyB3aWxsIG5ldmVyIGJlY29tZSBiZWxvdyAwLCAKICAvLyAgd2hpY2ggbWVhbnMgZWFybHkgYnV5ZXJzIHdpbGwgYWx3YXlzIGJ1eSB0b2tlbnMgYXQgbG93ZXIgcHJpY2UgdGhhbiBsYXRlciBidXllcnMuCiAgZnVuY3Rpb24gc2V0UHJpY2VJbmNyZWFzZSh1aW50MjU2IF9wcmljZUluY3JlYXNlKQogICAgb25seU93bmVyCiAgICBwdWJsaWMKICB7CiAgICByZXF1aXJlKHByaWNlSW5jcmVhc2UgPj0gMCk7CiAgICAKICAgIC8vIFNldCBwcmljZSBpbmNyZWFzZSBwZXIgdHJhbnNhY3Rpb24uCiAgICBwcmljZUluY3JlYXNlID0gX3ByaWNlSW5jcmVhc2U7CiAgfQoKICAvLyBAZGV2IFdpdGhkcmF3IGV0aGVyIGNvbGxlY3RlZC4KICBmdW5jdGlvbiB3aXRoZHJhd2FsKCkKICAgIG9ubHlPd25lcgogICAgcHVibGljCiAgewogICAgd2FsbGV0LnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgfQoKfQ=='.
	

]
