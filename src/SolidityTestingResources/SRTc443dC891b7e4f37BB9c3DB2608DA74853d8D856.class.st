Class {
	#name : #SRTc443dC891b7e4f37BB9c3DB2608DA74853d8D856,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTc443dC891b7e4f37BB9c3DB2608DA74853d8D856 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKfQoKY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9Cgpjb250cmFjdCBMaW1pdGVkVHJhbnNmZXJUb2tlbiBpcyBFUkMyMCB7CgogIC8qKgogICAqIEBkZXYgQ2hlY2tzIHdoZXRoZXIgaXQgY2FuIHRyYW5zZmVyIG9yIG90aGVyd2lzZSB0aHJvd3MuCiAgICovCiAgbW9kaWZpZXIgY2FuVHJhbnNmZXIoYWRkcmVzcyBfc2VuZGVyLCB1aW50MjU2IF92YWx1ZSkgewogICByZXF1aXJlKF92YWx1ZSA8PSB0cmFuc2ZlcmFibGVUb2tlbnMoX3NlbmRlciwgdWludDY0KG5vdykpKTsKICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgQ2hlY2tzIG1vZGlmaWVyIGFuZCBhbGxvd3MgdHJhbnNmZXIgaWYgdG9rZW5zIGFyZSBub3QgbG9ja2VkLgogICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIHRva2Vucy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgY2FuVHJhbnNmZXIobXNnLnNlbmRlciwgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICB9CgogIC8qKgogICogQGRldiBDaGVja3MgbW9kaWZpZXIgYW5kIGFsbG93cyB0cmFuc2ZlciBpZiB0b2tlbnMgYXJlIG5vdCBsb2NrZWQuCiAgKiBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHNlbmQgdGhlIHRva2Vucy4KICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIHRva2Vucy4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBjYW5UcmFuc2ZlcihfZnJvbSwgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogIH0KCiAgLyoqCiAgICogQGRldiBEZWZhdWx0IHRyYW5zZmVyYWJsZSB0b2tlbnMgZnVuY3Rpb24gcmV0dXJucyBhbGwgdG9rZW5zIGZvciBhIGhvbGRlciAobm8gbGltaXQpLgogICAqIEBkZXYgT3ZlcndyaXRpbmcgdHJhbnNmZXJhYmxlVG9rZW5zKGFkZHJlc3MgaG9sZGVyLCB1aW50NjQgdGltZSkgaXMgdGhlIHdheSB0byBwcm92aWRlIHRoZQogICAqIHNwZWNpZmljIGxvZ2ljIGZvciBsaW1pdGluZyB0b2tlbiB0cmFuc2ZlcmFiaWxpdHkgZm9yIGEgaG9sZGVyIG92ZXIgdGltZS4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcmFibGVUb2tlbnMoYWRkcmVzcyBob2xkZXIsIHVpbnQ2NCB0aW1lKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGJhbGFuY2VPZihob2xkZXIpOwogIH0KfQoKbGlicmFyeSBTYWZlRVJDMjAgewogIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlcihFUkMyMEJhc2ljIHRva2VuLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBpbnRlcm5hbCB7CiAgICBhc3NlcnQodG9rZW4udHJhbnNmZXIodG8sIHZhbHVlKSk7CiAgfQoKICBmdW5jdGlvbiBzYWZlVHJhbnNmZXJGcm9tKEVSQzIwIHRva2VuLCBhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHsKICAgIGFzc2VydCh0b2tlbi50cmFuc2ZlckZyb20oZnJvbSwgdG8sIHZhbHVlKSk7CiAgfQoKICBmdW5jdGlvbiBzYWZlQXBwcm92ZShFUkMyMCB0b2tlbiwgYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBpbnRlcm5hbCB7CiAgICBhc3NlcnQodG9rZW4uYXBwcm92ZShzcGVuZGVyLCB2YWx1ZSkpOwogIH0KfQoKY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CgogICAgdWludDI1NiBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07CgogICAgLy8gQ2hlY2sgaXMgbm90IG5lZWRlZCBiZWNhdXNlIHN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0CiAgICAvLyByZXF1aXJlIChfdmFsdWUgPD0gX2FsbG93YW5jZSk7CgogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CgogIC8qKgogICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAogICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICovCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCmNvbnRyYWN0IE1pbnRhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZSB7CiAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKICBldmVudCBNaW50RmluaXNoZWQoKTsKCiAgYm9vbCBwdWJsaWMgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CgoKICBtb2RpZmllciBjYW5NaW50KCkgewogICAgcmVxdWlyZSghbWludGluZ0ZpbmlzaGVkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIG1pbnQgdG9rZW5zCiAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgbWludGVkIHRva2Vucy4KICAgKiBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAqIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoX2Ftb3VudCk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICBNaW50KF90bywgX2Ftb3VudCk7CiAgICBUcmFuc2ZlcigweDAsIF90bywgX2Ftb3VudCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gc3RvcCBtaW50aW5nIG5ldyB0b2tlbnMuCiAgICogQHJldHVybiBUcnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gZmluaXNoTWludGluZygpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgIE1pbnRGaW5pc2hlZCgpOwogICAgcmV0dXJuIHRydWU7CiAgfQp9Cgpjb250cmFjdCBUb2tlblRpbWVsb2NrIHsKICB1c2luZyBTYWZlRVJDMjAgZm9yIEVSQzIwQmFzaWM7CgogIC8vIEVSQzIwIGJhc2ljIHRva2VuIGNvbnRyYWN0IGJlaW5nIGhlbGQKICBFUkMyMEJhc2ljIHB1YmxpYyB0b2tlbjsKCiAgLy8gYmVuZWZpY2lhcnkgb2YgdG9rZW5zIGFmdGVyIHRoZXkgYXJlIHJlbGVhc2VkCiAgYWRkcmVzcyBwdWJsaWMgYmVuZWZpY2lhcnk7CgogIC8vIHRpbWVzdGFtcCB3aGVuIHRva2VuIHJlbGVhc2UgaXMgZW5hYmxlZAogIHVpbnQ2NCBwdWJsaWMgcmVsZWFzZVRpbWU7CgogIGZ1bmN0aW9uIFRva2VuVGltZWxvY2soRVJDMjBCYXNpYyBfdG9rZW4sIGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCB1aW50NjQgX3JlbGVhc2VUaW1lKSB7CiAgICByZXF1aXJlKF9yZWxlYXNlVGltZSA+IG5vdyk7CiAgICB0b2tlbiA9IF90b2tlbjsKICAgIGJlbmVmaWNpYXJ5ID0gX2JlbmVmaWNpYXJ5OwogICAgcmVsZWFzZVRpbWUgPSBfcmVsZWFzZVRpbWU7CiAgfQoKICAvKioKICAgKiBAbm90aWNlIFRyYW5zZmVycyB0b2tlbnMgaGVsZCBieSB0aW1lbG9jayB0byBiZW5lZmljaWFyeS4KICAgKiBEZXByZWNhdGVkOiBwbGVhc2UgdXNlIFRva2VuVGltZWxvY2sjcmVsZWFzZSBpbnN0ZWFkLgogICAqLwogIGZ1bmN0aW9uIGNsYWltKCkgcHVibGljIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBiZW5lZmljaWFyeSk7CiAgICByZWxlYXNlKCk7CiAgfQoKICAvKioKICAgKiBAbm90aWNlIFRyYW5zZmVycyB0b2tlbnMgaGVsZCBieSB0aW1lbG9jayB0byBiZW5lZmljaWFyeS4KICAgKi8KICBmdW5jdGlvbiByZWxlYXNlKCkgcHVibGljIHsKICAgIHJlcXVpcmUobm93ID49IHJlbGVhc2VUaW1lKTsKCiAgICB1aW50MjU2IGFtb3VudCA9IHRva2VuLmJhbGFuY2VPZih0aGlzKTsKICAgIHJlcXVpcmUoYW1vdW50ID4gMCk7CgogICAgdG9rZW4uc2FmZVRyYW5zZmVyKGJlbmVmaWNpYXJ5LCBhbW91bnQpOwogIH0KfQoKY29udHJhY3QgU3RhcnRlckNvaW4gaXMgTWludGFibGVUb2tlbiwgTGltaXRlZFRyYW5zZmVyVG9rZW4gewoKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJTdGFydGVyQ29pbiI7CiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJTVEFDIjsKICAgIHVpbnQ4IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwoKICAgIHVpbnQyNTYgcHVibGljIGVuZFRpbWVJQ087CiAgICBhZGRyZXNzIHB1YmxpYyBib3VudHlXYWxsZXQ7CgogICAgZnVuY3Rpb24gU3RhcnRlckNvaW4odWludDI1NiBfZW5kVGltZUlDTywgYWRkcmVzcyBfYm91bnR5V2FsbGV0KSB7CiAgICAgICAgZW5kVGltZUlDTyA9IF9lbmRUaW1lSUNPOwogICAgICAgIGJvdW50eVdhbGxldCA9IF9ib3VudHlXYWxsZXQ7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJhYmxlVG9rZW5zKGFkZHJlc3MgaG9sZGVyLCB1aW50NjQgdGltZSkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICAvLyBhbGxvdyB0cmFuc2ZlcnMgYWZ0ZXIgdGhlIGVuZCBvZiBJQ08KICAgICAgICByZXR1cm4gKHRpbWUgPiBlbmRUaW1lSUNPKSB8fCAoaG9sZGVyID09IGJvdW50eVdhbGxldCkgPyBiYWxhbmNlT2YoaG9sZGVyKSA6IDA7CiAgICB9Cgp9Cgpjb250cmFjdCBTdGFydGVyQ29pbkNyb3dkc2FsZSBpcyBPd25hYmxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogICAgLy8gVGhlIHRva2VuIGJlaW5nIHNvbGQKICAgIE1pbnRhYmxlVG9rZW4gcHVibGljIHRva2VuOwoKICAgIC8vIHN0YXJ0IGFuZCBlbmQgdGltZXN0YW1wcyB3aGVyZSBpbnZlc3RtZW50cyBhcmUgYWxsb3dlZCAoYm90aCBpbmNsdXNpdmUpCiAgICB1aW50MjU2IHB1YmxpYyBzdGFydFRpbWU7CiAgICB1aW50MjU2IHB1YmxpYyBlbmRUaW1lOwoKICAgIHVpbnQyNTZbMTFdIHB1YmxpYyB0aW1pbmdzOwogICAgdWludDhbMTBdIHB1YmxpYyBib251c2VzOwoKICAgIC8vIGFkZHJlc3Mgd2hlcmUgZnVuZHMgYXJlIGNvbGxlY3RlZAogICAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0ODk7CiAgICBhZGRyZXNzIHB1YmxpYyB3YWxsZXQxMDsKICAgIGFkZHJlc3MgcHVibGljIHdhbGxldDE7CgogICAgLy8gaG93IG1hbnkgdG9rZW4gdW5pdHMgYSBidXllciBnZXRzIHBlciB3ZWkKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IFJBVEUgPSA0NTAwOwoKICAgIC8vIGFtb3VudCBvZiByYWlzZWQgbW9uZXkgaW4gd2VpCiAgICB1aW50MjU2IHB1YmxpYyB3ZWlSYWlzZWQ7CgogICAgdWludDI1NiBwdWJsaWMgdG9rZW5Tb2xkOwoKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IENBUCA9IDE1NDYyMiBldGhlcjsKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IFRPS0VOX0NBUCA9IDY5NTc5NzUwMCAqICgxMCAqKiB1aW50MjU2KDE4KSk7IC8vIDQ1MDAwMDAwKzYyNzk3NTAwKzU4ODAwMDAwMCBTVEMKCiAgICBUb2tlblRpbWVsb2NrIHB1YmxpYyBkZXZUb2tlblRpbWVsb2NrOwogICAgVG9rZW5UaW1lbG9jayBwdWJsaWMgZm91bmRlcnNUb2tlblRpbWVsb2NrOwogICAgVG9rZW5UaW1lbG9jayBwdWJsaWMgdGVhbVRva2VuVGltZWxvY2s7CiAgICBUb2tlblRpbWVsb2NrIHB1YmxpYyBhZHZpc2Vyc1Rva2VuVGltZWxvY2s7CgogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgQk9VTlRZX1NVUFBMWSA9IDc4NDAwMDAwICogKDEwICoqIHVpbnQyNTYoMTgpKTsKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IERFVl9TVVBQTFkgPSA3ODQwMDAwMCAqICgxMCAqKiB1aW50MjU2KDE4KSk7CiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBGT1VOREVSU19TVVBQTFkgPSA1OTYwMDAwMCAqICgxMCAqKiB1aW50MjU2KDE4KSk7CiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBURUFNX1NVUFBMWSA9IDM5MjAwMDAwICogKDEwICoqIHVpbnQyNTYoMTgpKTsKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IEFEVklTRVJTX1NVUFBMWSA9IDI5NDAwMDAwICogKDEwICoqIHVpbnQyNTYoMTgpKTsKCgogICAgZnVuY3Rpb24gU3RhcnRlckNvaW5Dcm93ZHNhbGUoCiAgICAgICAgdWludDI1NiBbMTFdIF90aW1pbmdzLAogICAgICAgIHVpbnQ4IFsxMF0gX2JvbnVzZXMsCiAgICAgICAgYWRkcmVzcyBbM10gX3dhbGxldHMsCiAgICAgICAgYWRkcmVzcyBib3VudHlXYWxsZXQsCiAgICAgICAgYWRkcmVzcyBkZXZXYWxsZXQsCiAgICAgICAgdWludDY0IGRldlJlbGVhc2VUaW1lLAogICAgICAgIGFkZHJlc3MgZm91bmRlcnNXYWxsZXQsCiAgICAgICAgdWludDY0IGZvdW5kZXJzUmVsZWFzZVRpbWUsCiAgICAgICAgYWRkcmVzcyB0ZWFtV2FsbGV0LAogICAgICAgIHVpbnQ2NCB0ZWFtUmVsZWFzZVRpbWUsCiAgICAgICAgYWRkcmVzcyBhZHZpc2Vyc1dhbGxldCwKICAgICAgICB1aW50NjQgYWR2aXNlcnNSZWxlYXNlVGltZQogICAgICAgICkgewogICAgICAgICAgICByZXF1aXJlKF90aW1pbmdzWzBdID49IG5vdyk7CgogICAgICAgICAgICBmb3IodWludCBpID0gMTsgaSA8IHRpbWluZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICByZXF1aXJlKF90aW1pbmdzW2ldID49IF90aW1pbmdzW2ktMV0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aW1pbmdzID0gX3RpbWluZ3M7CiAgICAgICAgICAgIGJvbnVzZXMgPSBfYm9udXNlczsKICAgICAgICAgICAgc3RhcnRUaW1lID0gdGltaW5nc1swXTsKICAgICAgICAgICAgZW5kVGltZSA9IHRpbWluZ3NbdGltaW5ncy5sZW5ndGgtMV07CgogICAgICAgICAgICByZXF1aXJlKGRldlJlbGVhc2VUaW1lID49IGVuZFRpbWUpOwogICAgICAgICAgICByZXF1aXJlKGZvdW5kZXJzUmVsZWFzZVRpbWUgPj0gZW5kVGltZSk7CiAgICAgICAgICAgIHJlcXVpcmUodGVhbVJlbGVhc2VUaW1lID49IGVuZFRpbWUpOwogICAgICAgICAgICByZXF1aXJlKGFkdmlzZXJzUmVsZWFzZVRpbWUgPj0gZW5kVGltZSk7CgogICAgICAgICAgICByZXF1aXJlKF93YWxsZXRzWzBdICE9IDB4MCk7CiAgICAgICAgICAgIHJlcXVpcmUoX3dhbGxldHNbMV0gIT0gMHgwKTsKICAgICAgICAgICAgcmVxdWlyZShfd2FsbGV0c1syXSAhPSAweDApOwoKICAgICAgICAgICAgcmVxdWlyZShib3VudHlXYWxsZXQgIT0gMHgwKTsKICAgICAgICAgICAgcmVxdWlyZShkZXZXYWxsZXQgIT0gMHgwKTsKICAgICAgICAgICAgcmVxdWlyZShmb3VuZGVyc1dhbGxldCAhPSAweDApOwogICAgICAgICAgICByZXF1aXJlKHRlYW1XYWxsZXQgIT0gMHgwKTsKICAgICAgICAgICAgcmVxdWlyZShhZHZpc2Vyc1dhbGxldCAhPSAweDApOwoKICAgICAgICAgICAgd2FsbGV0ODkgPSBfd2FsbGV0c1swXTsKICAgICAgICAgICAgd2FsbGV0MTAgPSBfd2FsbGV0c1sxXTsKICAgICAgICAgICAgd2FsbGV0MSA9IF93YWxsZXRzWzJdOwoKICAgICAgICAgICAgdG9rZW4gPSBuZXcgU3RhcnRlckNvaW4oZW5kVGltZSwgYm91bnR5V2FsbGV0KTsKCiAgICAgICAgICAgIHRva2VuLm1pbnQoYm91bnR5V2FsbGV0LCBCT1VOVFlfU1VQUExZKTsKCiAgICAgICAgICAgIGRldlRva2VuVGltZWxvY2sgPSBuZXcgVG9rZW5UaW1lbG9jayh0b2tlbiwgZGV2V2FsbGV0LCBkZXZSZWxlYXNlVGltZSk7CiAgICAgICAgICAgIHRva2VuLm1pbnQoZGV2VG9rZW5UaW1lbG9jaywgREVWX1NVUFBMWSk7CgogICAgICAgICAgICBmb3VuZGVyc1Rva2VuVGltZWxvY2sgPSBuZXcgVG9rZW5UaW1lbG9jayh0b2tlbiwgZm91bmRlcnNXYWxsZXQsIGZvdW5kZXJzUmVsZWFzZVRpbWUpOwogICAgICAgICAgICB0b2tlbi5taW50KGZvdW5kZXJzVG9rZW5UaW1lbG9jaywgRk9VTkRFUlNfU1VQUExZKTsKCiAgICAgICAgICAgIHRlYW1Ub2tlblRpbWVsb2NrID0gbmV3IFRva2VuVGltZWxvY2sodG9rZW4sIHRlYW1XYWxsZXQsIHRlYW1SZWxlYXNlVGltZSk7CiAgICAgICAgICAgIHRva2VuLm1pbnQodGVhbVRva2VuVGltZWxvY2ssIFRFQU1fU1VQUExZKTsKCiAgICAgICAgICAgIGFkdmlzZXJzVG9rZW5UaW1lbG9jayA9IG5ldyBUb2tlblRpbWVsb2NrKHRva2VuLCBhZHZpc2Vyc1dhbGxldCwgYWR2aXNlcnNSZWxlYXNlVGltZSk7CiAgICAgICAgICAgIHRva2VuLm1pbnQoYWR2aXNlcnNUb2tlblRpbWVsb2NrLCBBRFZJU0VSU19TVVBQTFkpOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgKiBldmVudCBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAgICAgICogQHBhcmFtIHB1cmNoYXNlciB3aG8gcGFpZCBmb3IgdGhlIHRva2VucwogICAgICAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IHdobyBnb3QgdGhlIHRva2VucwogICAgICAgICogQHBhcmFtIHZhbHVlIHdlaXMgcGFpZCBmb3IgcHVyY2hhc2UKICAgICAgICAqIEBwYXJhbSBhbW91bnQgYW1vdW50IG9mIHRva2VucyBwdXJjaGFzZWQKICAgICAgICAqLwogICAgICAgIGV2ZW50IFRva2VuUHVyY2hhc2UoYWRkcmVzcyBpbmRleGVkIHB1cmNoYXNlciwgYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IGFtb3VudCk7CgogICAgICAgIC8vIGNyZWF0ZXMgdGhlIHRva2VuIHRvIGJlIHNvbGQuCiAgICAgICAgLy8gb3ZlcnJpZGUgdGhpcyBtZXRob2QgdG8gaGF2ZSBjcm93ZHNhbGUgb2YgYSBzcGVjaWZpYyBtaW50YWJsZSB0b2tlbi4KICAgICAgICBmdW5jdGlvbiBjcmVhdGVUb2tlbkNvbnRyYWN0KCkgaW50ZXJuYWwgcmV0dXJucyAoTWludGFibGVUb2tlbikgewogICAgICAgICAgICByZXR1cm4gbmV3IE1pbnRhYmxlVG9rZW4oKTsKICAgICAgICB9CgoKICAgICAgICAvLyBmYWxsYmFjayBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBidXkgdG9rZW5zCiAgICAgICAgZnVuY3Rpb24gKCkgcGF5YWJsZSB7CiAgICAgICAgICAgIGJ1eVRva2Vucyhtc2cuc2VuZGVyKTsKICAgICAgICB9CgogICAgICAgIC8vIGxvdyBsZXZlbCB0b2tlbiBwdXJjaGFzZSBmdW5jdGlvbgogICAgICAgIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgICAgIHJlcXVpcmUoYmVuZWZpY2lhcnkgIT0gMHgwKTsKICAgICAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPj0gMTAwKTsgLy8gcmVxdWlyZWQgZm9yIHByb3BlciBzcGxpdHRpbmcgZnVuZHMgYmV0d2VlbiAzIHdhbGxldHMKCiAgICAgICAgICAgIHVpbnQyNTYgd2VpQW1vdW50ID0gbXNnLnZhbHVlOwoKICAgICAgICAgICAgLy8gY2FsY3VsYXRlIHBlcmlvZCBib251cwogICAgICAgICAgICB1aW50MjU2IHBlcmlvZEJvbnVzOwoKICAgICAgICAgICAgZm9yICh1aW50OCBpID0gMTsgaSA8IHRpbWluZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICBpZiAoIG5vdyA8IHRpbWluZ3NbaV0gKSB7CiAgICAgICAgICAgICAgICBwZXJpb2RCb251cyA9IFJBVEUubXVsKHVpbnQyNTYoYm9udXNlc1tpLTFdKSkuZGl2KDEwMCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSBidWxrIHB1cmNoYXNlIGJvbnVzCiAgICAgICAgICAgIHVpbnQyNTYgYnVsa1B1cmNoYXNlQm9udXM7CiAgICAgICAgICAgIGlmICh3ZWlBbW91bnQgPj0gNTAgZXRoZXIpIHsKICAgICAgICAgICAgYnVsa1B1cmNoYXNlQm9udXMgPSAzNjAwOyAvLyA4MCUgYm9udXMgZm9yIFJBVEUgNDUwMAogICAgICAgICAgICB9IGVsc2UgaWYgKHdlaUFtb3VudCA+PSAzMCBldGhlcikgewogICAgICAgICAgICBidWxrUHVyY2hhc2VCb251cyA9IDMxNTA7IC8vIDcwJSBib251cyBmb3IgUkFURSA0NTAwCiAgICAgICAgICAgIH0gZWxzZSBpZiAod2VpQW1vdW50ID49IDEwIGV0aGVyKSB7CiAgICAgICAgICAgIGJ1bGtQdXJjaGFzZUJvbnVzID0gMjI1MDsgLy8gNTAlIGJvbnVzIGZvciBSQVRFIDQ1MDAKICAgICAgICAgICAgfSBlbHNlIGlmICh3ZWlBbW91bnQgPj0gNSBldGhlcikgewogICAgICAgICAgICBidWxrUHVyY2hhc2VCb251cyA9IDEzNTA7IC8vIDMwJSBib251cyBmb3IgUkFURSA0NTAwCiAgICAgICAgICAgIH0gZWxzZSBpZiAod2VpQW1vdW50ID49IDMgZXRoZXIpIHsKICAgICAgICAgICAgYnVsa1B1cmNoYXNlQm9udXMgPSA0NTA7IC8vIDEwJSBib251cyBmb3IgUkFURSA0NTAwCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHVpbnQyNTYgYWN0dWFsUmF0ZSA9IFJBVEUuYWRkKHBlcmlvZEJvbnVzKS5hZGQoYnVsa1B1cmNoYXNlQm9udXMpOwoKICAgICAgICAgICAgLy8gY2FsY3VsYXRlIHRva2VuIGFtb3VudCB0byBiZSBjcmVhdGVkCiAgICAgICAgICAgIHVpbnQyNTYgdG9rZW5zID0gd2VpQW1vdW50Lm11bChhY3R1YWxSYXRlKTsKCiAgICAgICAgICAgIC8vIHVwZGF0ZSBzdGF0ZQogICAgICAgICAgICB3ZWlSYWlzZWQgPSB3ZWlSYWlzZWQuYWRkKHdlaUFtb3VudCk7CiAgICAgICAgICAgIHRva2VuU29sZCA9IHRva2VuU29sZC5hZGQodG9rZW5zKTsKCiAgICAgICAgICAgIHJlcXVpcmUodmFsaWRQdXJjaGFzZSgpKTsKCiAgICAgICAgICAgIHRva2VuLm1pbnQoYmVuZWZpY2lhcnksIHRva2Vucyk7CiAgICAgICAgICAgIFRva2VuUHVyY2hhc2UobXNnLnNlbmRlciwgYmVuZWZpY2lhcnksIHdlaUFtb3VudCwgdG9rZW5zKTsKCiAgICAgICAgICAgIGZvcndhcmRGdW5kcygpOwogICAgICAgIH0KCiAgICAgICAgLy8gc2VuZCBldGhlciB0byB0aGUgZnVuZCBjb2xsZWN0aW9uIHdhbGxldAogICAgICAgIC8vIG92ZXJyaWRlIHRvIGNyZWF0ZSBjdXN0b20gZnVuZCBmb3J3YXJkaW5nIG1lY2hhbmlzbXMKICAgICAgICBmdW5jdGlvbiBmb3J3YXJkRnVuZHMoKSBpbnRlcm5hbCB7CiAgICAgICAgICB1aW50MjU2IHdlaTg5ID0gbXNnLnZhbHVlLm11bCg4OSkuZGl2KDEwMCk7CiAgICAgICAgICB1aW50MjU2IHdlaTEwID0gbXNnLnZhbHVlLmRpdigxMCk7CiAgICAgICAgICB1aW50MjU2IHdlaTEgPSBtc2cudmFsdWUuc3ViKHdlaTg5KS5zdWIod2VpMTApOwogICAgICAgICAgd2FsbGV0ODkudHJhbnNmZXIod2VpODkpOwogICAgICAgICAgd2FsbGV0MTAudHJhbnNmZXIod2VpMTApOwogICAgICAgICAgd2FsbGV0MS50cmFuc2Zlcih3ZWkxKTsKICAgICAgICB9CgogICAgICAgIC8vIGFkZCBvZmYgY2hhaW4gY29udHJpYnV0aW9uLiBCVEMgYWRkcmVzcyBvZiBjb250cmlidXRpb24gYWRkZWQgZm9yIHRyYW5zcGFyZW5jeQogICAgICAgIGZ1bmN0aW9uIGFkZE9mZkNoYWluQ29udHJpYnV0aW9uKGFkZHJlc3MgYmVuZWZpY2lhciwgdWludDI1NiB3ZWlBbW91bnQsIHVpbnQyNTYgdG9rZW5BbW91bnQsIHN0cmluZyBidGNBZGRyZXNzKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICAgICAgcmVxdWlyZShiZW5lZmljaWFyICE9IDB4MCk7CiAgICAgICAgICAgIHJlcXVpcmUod2VpQW1vdW50ID4gMCk7CiAgICAgICAgICAgIHJlcXVpcmUodG9rZW5BbW91bnQgPiAwKTsKICAgICAgICAgICAgd2VpUmFpc2VkICs9IHdlaUFtb3VudDsKICAgICAgICAgICAgdG9rZW5Tb2xkICs9IHRva2VuQW1vdW50OwogICAgICAgICAgICByZXF1aXJlKHZhbGlkUHVyY2hhc2UoKSk7CiAgICAgICAgICAgIHRva2VuLm1pbnQoYmVuZWZpY2lhciwgdG9rZW5BbW91bnQpOwogICAgICAgIH0KCgogICAgICAgIC8vIG92ZXJyaWRpbmcgQ3Jvd2RzYWxlI3ZhbGlkUHVyY2hhc2UgdG8gYWRkIGV4dHJhIENBUCBsb2dpYwogICAgICAgIC8vIEByZXR1cm4gdHJ1ZSBpZiBpbnZlc3RvcnMgY2FuIGJ1eSBhdCB0aGUgbW9tZW50CiAgICAgICAgZnVuY3Rpb24gdmFsaWRQdXJjaGFzZSgpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICAgICAgYm9vbCB3aXRoaW5DYXAgPSB3ZWlSYWlzZWQgPD0gQ0FQOwogICAgICAgICAgICBib29sIHdpdGhpblBlcmlvZCA9IG5vdyA+PSBzdGFydFRpbWUgJiYgbm93IDw9IGVuZFRpbWU7CiAgICAgICAgICAgIGJvb2wgd2l0aGluVG9rZW5DYXAgPSB0b2tlblNvbGQgPD0gVE9LRU5fQ0FQOwogICAgICAgICAgICByZXR1cm4gd2l0aGluUGVyaW9kICYmIHdpdGhpbkNhcCAmJiB3aXRoaW5Ub2tlbkNhcDsKICAgICAgICB9CgogICAgICAgIC8vIG92ZXJyaWRpbmcgQ3Jvd2RzYWxlI2hhc0VuZGVkIHRvIGFkZCBDQVAgbG9naWMKICAgICAgICAvLyBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBlbmRlZAogICAgICAgIGZ1bmN0aW9uIGhhc0VuZGVkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICAgICAgYm9vbCBjYXBSZWFjaGVkID0gd2VpUmFpc2VkID49IENBUDsKICAgICAgICAgICAgcmV0dXJuIG5vdyA+IGVuZFRpbWUgfHwgY2FwUmVhY2hlZDsKICAgICAgICB9CgogICAgfQ=='.
	

]
