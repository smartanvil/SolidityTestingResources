Class {
	#name : #SRT33a275B9cd129b34e5f0693D82d6d3Db26B0C3a0,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT33a275B9cd129b34e5f0693D82d6d3Db26B0C3a0 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgoKY29udHJhY3QgSW50ZXJmYWNlQ29udGVudENyZWF0b3JVbml2ZXJzZSB7CiAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzIF9vd25lcik7CiAgZnVuY3Rpb24gcHJpY2VPZih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHByaWNlKTsKICBmdW5jdGlvbiBnZXROZXh0UHJpY2UodWludCBwcmljZSwgdWludCBfdG9rZW5JZCkgcHVibGljIHB1cmUgcmV0dXJucyAodWludCk7CiAgZnVuY3Rpb24gbGFzdFN1YlRva2VuQnV5ZXJPZih1aW50IHRva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMoYWRkcmVzcyk7CiAgZnVuY3Rpb24gbGFzdFN1YlRva2VuQ3JlYXRvck9mKHVpbnQgdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyhhZGRyZXNzKTsKCiAgLy8KICBmdW5jdGlvbiBjcmVhdGVDb2xsZWN0aWJsZSh1aW50MjU2IHRva2VuSWQsIHVpbnQyNTYgX3ByaWNlLCBhZGRyZXNzIGNyZWF0b3IsIGFkZHJlc3Mgb3duZXIpIGV4dGVybmFsIDsKfQoKY29udHJhY3QgSW50ZXJmYWNlWUNDIHsKICBmdW5jdGlvbiBwYXlGb3JVcGdyYWRlKGFkZHJlc3MgdXNlciwgdWludCBwcmljZSkgZXh0ZXJuYWwgIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgZnVuY3Rpb24gbWludENvaW5zRm9yT2xkQ29sbGVjdGlibGVzKGFkZHJlc3MgdG8sIHVpbnQyNTYgYW1vdW50LCBhZGRyZXNzIHVuaXZlcnNlT3duZXIpIGV4dGVybmFsICByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogIGZ1bmN0aW9uIHRyYWRlUHJlVG9rZW4odWludCBwcmljZSwgYWRkcmVzcyBidXllciwgYWRkcmVzcyBzZWxsZXIsIHVpbnQgYnVyblBlcmNlbnQsIGFkZHJlc3MgdW5pdmVyc2VPd25lcikgZXh0ZXJuYWw7CiAgZnVuY3Rpb24gcGF5b3V0Rm9yTWluaW5nKGFkZHJlc3MgdXNlciwgdWludCBhbW91bnQpIGV4dGVybmFsOwogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5Owp9Cgpjb250cmFjdCBJbnRlcmZhY2VNaW5pbmcgewogIGZ1bmN0aW9uIGNyZWF0ZU1pbmVGb3JUb2tlbih1aW50IHRva2VuSWQsIHVpbnQgbGV2ZWwsIHVpbnQgeHAsIHVpbnQgbmV4dExldmVsQnJlYWssIHVpbnQgYmxvY2tudW1iZXIpIGV4dGVybmFsOwogIGZ1bmN0aW9uIHBheW91dE1pbmluZyh1aW50IHRva2VuSWQsIGFkZHJlc3Mgb3duZXIsIGFkZHJlc3MgbmV3T3duZXIpIGV4dGVybmFsOwogIGZ1bmN0aW9uIGxldmVsVXBNaW5pbmcodWludCB0b2tlbklkKSBleHRlcm5hbDsKfQoKbGlicmFyeSBTYWZlTWF0aCB7CgogIC8qKgogICogQGRldiBNdWx0aXBsaWVzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKGEgPT0gMCkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICAvKioKICAqIEBkZXYgSW50ZWdlciBkaXZpc2lvbiBvZiB0d28gbnVtYmVycywgdHJ1bmNhdGluZyB0aGUgcXVvdGllbnQuCiAgKi8KICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBTdWJzdHJhY3RzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cgKGkuZS4gaWYgc3VidHJhaGVuZCBpcyBncmVhdGVyIHRoYW4gbWludWVuZCkuCiAgKi8KICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICAvKioKICAqIEBkZXYgQWRkcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICovCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCmNvbnRyYWN0IE93bmVkIHsKICAvLyBUaGUgYWRkcmVzc2VzIG9mIHRoZSBhY2NvdW50cyAob3IgY29udHJhY3RzKSB0aGF0IGNhbiBleGVjdXRlIGFjdGlvbnMgd2l0aGluIGVhY2ggcm9sZXMuCiAgYWRkcmVzcyBwdWJsaWMgY2VvQWRkcmVzczsKICBhZGRyZXNzIHB1YmxpYyBjb29BZGRyZXNzOwogIGFkZHJlc3MgcHJpdmF0ZSBuZXdDZW9BZGRyZXNzOwogIGFkZHJlc3MgcHJpdmF0ZSBuZXdDb29BZGRyZXNzOwoKCiAgZnVuY3Rpb24gT3duZWQoKSBwdWJsaWMgewogICAgICBjZW9BZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgY29vQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgfQoKICAvKioqIEFDQ0VTUyBNT0RJRklFUlMgKioqLwogIC8vLyBAZGV2IEFjY2VzcyBtb2RpZmllciBmb3IgQ0VPLW9ubHkgZnVuY3Rpb25hbGl0eQogIG1vZGlmaWVyIG9ubHlDRU8oKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY2VvQWRkcmVzcyk7CiAgICBfOwogIH0KCiAgLy8vIEBkZXYgQWNjZXNzIG1vZGlmaWVyIGZvciBDT08tb25seSBmdW5jdGlvbmFsaXR5CiAgbW9kaWZpZXIgb25seUNPTygpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjb29BZGRyZXNzKTsKICAgIF87CiAgfQoKICAvLy8gQWNjZXNzIG1vZGlmaWVyIGZvciBjb250cmFjdCBvd25lciBvbmx5IGZ1bmN0aW9uYWxpdHkKICBtb2RpZmllciBvbmx5Q0xldmVsKCkgewogICAgcmVxdWlyZSgKICAgICAgbXNnLnNlbmRlciA9PSBjZW9BZGRyZXNzIHx8CiAgICAgIG1zZy5zZW5kZXIgPT0gY29vQWRkcmVzcwogICAgKTsKICAgIF87CiAgfQoKICAvLy8gQGRldiBBc3NpZ25zIGEgbmV3IGFkZHJlc3MgdG8gYWN0IGFzIHRoZSBDRU8uIE9ubHkgYXZhaWxhYmxlIHRvIHRoZSBjdXJyZW50IENFTy4KICAvLy8gQHBhcmFtIF9uZXdDRU8gVGhlIGFkZHJlc3Mgb2YgdGhlIG5ldyBDRU8KICBmdW5jdGlvbiBzZXRDRU8oYWRkcmVzcyBfbmV3Q0VPKSBwdWJsaWMgb25seUNFTyB7CiAgICByZXF1aXJlKF9uZXdDRU8gIT0gYWRkcmVzcygwKSk7CiAgICBuZXdDZW9BZGRyZXNzID0gX25ld0NFTzsKICB9CgogIC8vLyBAZGV2IEFzc2lnbnMgYSBuZXcgYWRkcmVzcyB0byBhY3QgYXMgdGhlIENPTy4gT25seSBhdmFpbGFibGUgdG8gdGhlIGN1cnJlbnQgQ09PLgogIC8vLyBAcGFyYW0gX25ld0NPTyBUaGUgYWRkcmVzcyBvZiB0aGUgbmV3IENPTwogIGZ1bmN0aW9uIHNldENPTyhhZGRyZXNzIF9uZXdDT08pIHB1YmxpYyBvbmx5Q0VPIHsKICAgIHJlcXVpcmUoX25ld0NPTyAhPSBhZGRyZXNzKDApKTsKICAgIG5ld0Nvb0FkZHJlc3MgPSBfbmV3Q09POwogIH0KCiAgZnVuY3Rpb24gYWNjZXB0Q2VvT3duZXJzaGlwKCkgcHVibGljIHsKICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG5ld0Nlb0FkZHJlc3MpOwogICAgICByZXF1aXJlKGFkZHJlc3MoMCkgIT0gbmV3Q2VvQWRkcmVzcyk7CiAgICAgIGNlb0FkZHJlc3MgPSBuZXdDZW9BZGRyZXNzOwogICAgICBuZXdDZW9BZGRyZXNzID0gYWRkcmVzcygwKTsKICB9CgogIGZ1bmN0aW9uIGFjY2VwdENvb093bmVyc2hpcCgpIHB1YmxpYyB7CiAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBuZXdDb29BZGRyZXNzKTsKICAgICAgcmVxdWlyZShhZGRyZXNzKDApICE9IG5ld0Nvb0FkZHJlc3MpOwogICAgICBjb29BZGRyZXNzID0gbmV3Q29vQWRkcmVzczsKICAgICAgbmV3Q29vQWRkcmVzcyA9IGFkZHJlc3MoMCk7CiAgfQoKICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyB5b3VDb2xsZWN0Q29udHJhY3RzOwogIGZ1bmN0aW9uIGFkZFlvdUNvbGxlY3RDb250cmFjdChhZGRyZXNzIGNvbnRyYWN0QWRkcmVzcywgYm9vbCBhY3RpdmUpIHB1YmxpYyBvbmx5Q09PIHsKICAgIHlvdUNvbGxlY3RDb250cmFjdHNbY29udHJhY3RBZGRyZXNzXSA9IGFjdGl2ZTsKICB9CiAgbW9kaWZpZXIgb25seVlDQygpIHsKICAgIHJlcXVpcmUoeW91Q29sbGVjdENvbnRyYWN0c1ttc2cuc2VuZGVyXSk7CiAgICBfOwogIH0KCiAgSW50ZXJmYWNlWUNDIHljYzsKICBJbnRlcmZhY2VDb250ZW50Q3JlYXRvclVuaXZlcnNlIHljdDsKICBJbnRlcmZhY2VNaW5pbmcgeWNtOwogIGZ1bmN0aW9uIHNldE1haW5Zb3VDb2xsZWN0Q29udHJhY3RBZGRyZXNzZXMoYWRkcmVzcyB5Y2NDb250cmFjdCwgYWRkcmVzcyB5Y3RDb250cmFjdCwgYWRkcmVzcyB5Y21Db250cmFjdCwgYWRkcmVzc1tdIG90aGVyQ29udHJhY3RzKSBwdWJsaWMgb25seUNPTyB7CiAgICB5Y2MgPSBJbnRlcmZhY2VZQ0MoeWNjQ29udHJhY3QpOwogICAgeWN0ID0gSW50ZXJmYWNlQ29udGVudENyZWF0b3JVbml2ZXJzZSh5Y3RDb250cmFjdCk7CiAgICB5Y20gPSBJbnRlcmZhY2VNaW5pbmcoeWNtQ29udHJhY3QpOwogICAgeW91Q29sbGVjdENvbnRyYWN0c1t5Y2NDb250cmFjdF0gPSB0cnVlOwogICAgeW91Q29sbGVjdENvbnRyYWN0c1t5Y3RDb250cmFjdF0gPSB0cnVlOwogICAgeW91Q29sbGVjdENvbnRyYWN0c1t5Y21Db250cmFjdF0gPSB0cnVlOwogICAgZm9yICh1aW50MTYgaW5kZXggPSAwOyBpbmRleCA8IG90aGVyQ29udHJhY3RzLmxlbmd0aDsgaW5kZXgrKykgewogICAgICB5b3VDb2xsZWN0Q29udHJhY3RzW290aGVyQ29udHJhY3RzW2luZGV4XV0gPSB0cnVlOwogICAgfQogIH0KICBmdW5jdGlvbiBzZXRZY2NDb250cmFjdEFkZHJlc3MoYWRkcmVzcyB5Y2NDb250cmFjdCkgcHVibGljIG9ubHlDT08gewogICAgeWNjID0gSW50ZXJmYWNlWUNDKHljY0NvbnRyYWN0KTsKICAgIHlvdUNvbGxlY3RDb250cmFjdHNbeWNjQ29udHJhY3RdID0gdHJ1ZTsKICB9CiAgZnVuY3Rpb24gc2V0WWN0Q29udHJhY3RBZGRyZXNzKGFkZHJlc3MgeWN0Q29udHJhY3QpIHB1YmxpYyBvbmx5Q09PIHsKICAgIHljdCA9IEludGVyZmFjZUNvbnRlbnRDcmVhdG9yVW5pdmVyc2UoeWN0Q29udHJhY3QpOwogICAgeW91Q29sbGVjdENvbnRyYWN0c1t5Y3RDb250cmFjdF0gPSB0cnVlOwogIH0KICBmdW5jdGlvbiBzZXRZY21Db250cmFjdEFkZHJlc3MoYWRkcmVzcyB5Y21Db250cmFjdCkgcHVibGljIG9ubHlDT08gewogICAgeWNtID0gSW50ZXJmYWNlTWluaW5nKHljbUNvbnRyYWN0KTsKICAgIHlvdUNvbGxlY3RDb250cmFjdHNbeWNtQ29udHJhY3RdID0gdHJ1ZTsKICB9Cgp9Cgpjb250cmFjdCBUcmFuc2ZlckludGVyZmFjZUVSQzcyMVlDIHsKICBmdW5jdGlvbiB0cmFuc2ZlclRva2VuKGFkZHJlc3MgdG8sIHVpbnQyNTYgdG9rZW5JZCkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7Cn0KY29udHJhY3QgVHJhbnNmZXJJbnRlcmZhY2VFUkMyMCB7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludCB0b2tlbnMpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwp9CgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIEVSQyBUb2tlbiBTdGFuZGFyZCAjMjAgSW50ZXJmYWNlCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9Db25zZW5TeXMvVG9rZW5zL2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy9laXAyMC9FSVAyMC5zb2wKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpjb250cmFjdCBZb3VDb2xsZWN0QmFzZSBpcyBPd25lZCB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIGV2ZW50IFJlZEJ1dHRvbih1aW50IHZhbHVlLCB1aW50IHRvdGFsU3VwcGx5KTsKCiAgLy8gUGF5b3V0CiAgZnVuY3Rpb24gcGF5b3V0KGFkZHJlc3MgX3RvKSBwdWJsaWMgb25seUNMZXZlbCB7CiAgICBfcGF5b3V0KF90bywgdGhpcy5iYWxhbmNlKTsKICB9CiAgZnVuY3Rpb24gcGF5b3V0KGFkZHJlc3MgX3RvLCB1aW50IGFtb3VudCkgcHVibGljIG9ubHlDTGV2ZWwgewogICAgaWYgKGFtb3VudD50aGlzLmJhbGFuY2UpCiAgICAgIGFtb3VudCA9IHRoaXMuYmFsYW5jZTsKICAgIF9wYXlvdXQoX3RvLCBhbW91bnQpOwogIH0KICBmdW5jdGlvbiBfcGF5b3V0KGFkZHJlc3MgX3RvLCB1aW50IGFtb3VudCkgcHJpdmF0ZSB7CiAgICBpZiAoX3RvID09IGFkZHJlc3MoMCkpIHsKICAgICAgY2VvQWRkcmVzcy50cmFuc2ZlcihhbW91bnQpOwogICAgfSBlbHNlIHsKICAgICAgX3RvLnRyYW5zZmVyKGFtb3VudCk7CiAgICB9CiAgfQoKICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAvLyBPd25lciBjYW4gdHJhbnNmZXIgb3V0IGFueSBhY2NpZGVudGFsbHkgc2VudCBFUkMyMCB0b2tlbnMKICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICBmdW5jdGlvbiB0cmFuc2ZlckFueUVSQzIwVG9rZW4oYWRkcmVzcyB0b2tlbkFkZHJlc3MsIHVpbnQgdG9rZW5zKSBwdWJsaWMgb25seUNFTyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgcmV0dXJuIFRyYW5zZmVySW50ZXJmYWNlRVJDMjAodG9rZW5BZGRyZXNzKS50cmFuc2ZlcihjZW9BZGRyZXNzLCB0b2tlbnMpOwogIH0KfQoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyBDb250cmFjdCBmdW5jdGlvbiB0byByZWNlaXZlIGFwcHJvdmFsIGFuZCBleGVjdXRlIGZ1bmN0aW9uIGluIG9uZSBjYWxsCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KY29udHJhY3QgQXBwcm92ZUFuZENhbGxGYWxsQmFjayB7CiAgICBmdW5jdGlvbiByZWNlaXZlQXBwcm92YWwoYWRkcmVzcyBmcm9tLCB1aW50MjU2IHRva2VucywgYWRkcmVzcyB0b2tlbiwgYnl0ZXMgZGF0YSkgcHVibGljOwp9Cgpjb250cmFjdCBFUkM3MjFZQyBpcyBZb3VDb2xsZWN0QmFzZSB7CiAgLy8KICAvLyBFUkM3MjEKCiAgICAvKioqIFNUT1JBR0UgKioqLwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBOQU1FID0gIllvdUNvbGxlY3RUb2tlbnMiOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBTWU1CT0wgPSAiWUNUIjsKICAgIHVpbnQyNTZbXSBwdWJsaWMgdG9rZW5zOwoKICAgIC8vLyBAZGV2IEEgbWFwcGluZyBmcm9tIGNvbGxlY3RpYmxlIElEcyB0byB0aGUgYWRkcmVzcyB0aGF0IG93bnMgdGhlbS4gQWxsIGNvbGxlY3RpYmxlcyBoYXZlCiAgICAvLy8gIHNvbWUgdmFsaWQgb3duZXIgYWRkcmVzcy4KICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgcHVibGljIHRva2VuSW5kZXhUb093bmVyOwoKICAgIC8vLyBAZGV2IEEgbWFwcGluZyBmcm9tIENvbGxlY3RpYmxlSURzIHRvIGFuIGFkZHJlc3MgdGhhdCBoYXMgYmVlbiBhcHByb3ZlZCB0byBjYWxsCiAgICAvLy8gIHRyYW5zZmVyRnJvbSgpLiBFYWNoIENvbGxlY3RpYmxlIGNhbiBvbmx5IGhhdmUgb25lIGFwcHJvdmVkIGFkZHJlc3MgZm9yIHRyYW5zZmVyCiAgICAvLy8gIGF0IGFueSB0aW1lLiBBIHplcm8gdmFsdWUgbWVhbnMgbm8gYXBwcm92YWwgaXMgb3V0c3RhbmRpbmcuCiAgICBtYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIHB1YmxpYyB0b2tlbkluZGV4VG9BcHByb3ZlZDsKCiAgICAvLyBAZGV2IEEgbWFwcGluZyBmcm9tIENvbGxlY3RpYmxlSURzIHRvIHRoZSBwcmljZSBvZiB0aGUgdG9rZW4uCiAgICBtYXBwaW5nICh1aW50MjU2ID0+IHVpbnQyNTYpIHB1YmxpYyB0b2tlbkluZGV4VG9QcmljZTsKCiAgICAvKioqIEVWRU5UUyAqKiovCiAgICAvLy8gQGRldiBUaGUgQmlydGggZXZlbnQgaXMgZmlyZWQgd2hlbmV2ZXIgYSBuZXcgY29sbGVjdGlibGUgY29tZXMgaW50byBleGlzdGVuY2UuCiAgICBldmVudCBCaXJ0aCh1aW50MjU2IHRva2VuSWQsIHVpbnQyNTYgc3RhcnRQcmljZSk7CiAgICAvLy8gQGRldiBUaGUgVG9rZW5Tb2xkIGV2ZW50IGlzIGZpcmVkIHdoZW5ldmVyIGEgdG9rZW4gaXMgc29sZC4KICAgIGV2ZW50IFRva2VuU29sZCh1aW50MjU2IGluZGV4ZWQgdG9rZW5JZCwgdWludDI1NiBwcmljZSwgYWRkcmVzcyBwcmV2T3duZXIsIGFkZHJlc3Mgd2lubmVyKTsKICAgIC8vIEVSQzcyMSBUcmFuc2ZlcgogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB0b2tlbklkKTsKICAgIC8vIEVSQzcyMSBBcHByb3ZhbAogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgYXBwcm92ZWQsIHVpbnQyNTYgdG9rZW5JZCk7CgogICAgLyoqKiBQVUJMSUMgRlVOQ1RJT05TICoqKi8KICAgIC8vLyBAbm90aWNlIEdyYW50IGFub3RoZXIgYWRkcmVzcyB0aGUgcmlnaHQgdG8gdHJhbnNmZXIgdG9rZW4gdmlhIHRha2VPd25lcnNoaXAoKSBhbmQgdHJhbnNmZXJGcm9tKCkuCiAgICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byBiZSBncmFudGVkIHRyYW5zZmVyIGFwcHJvdmFsLiBQYXNzIGFkZHJlc3MoMCkgdG8KICAgIC8vLyAgY2xlYXIgYWxsIGFwcHJvdmFscy4KICAgIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIElEIG9mIHRoZSBUb2tlbiB0aGF0IGNhbiBiZSB0cmFuc2ZlcnJlZCBpZiB0aGlzIGNhbGwgc3VjY2VlZHMuCiAgICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogICAgZnVuY3Rpb24gYXBwcm92ZVRva2VuKAogICAgICBhZGRyZXNzIF90bywKICAgICAgdWludDI1NiBfdG9rZW5JZAogICAgKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAvLyBDYWxsZXIgbXVzdCBvd24gdG9rZW4uCiAgICAgIHJlcXVpcmUoX293bnNUb2tlbihtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwoKICAgICAgdG9rZW5JbmRleFRvQXBwcm92ZWRbX3Rva2VuSWRdID0gX3RvOwoKICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3RvLCBfdG9rZW5JZCk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKCiAgICBmdW5jdGlvbiBnZXRUb3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQpIHsKICAgICAgcmV0dXJuIHRva2Vucy5sZW5ndGg7CiAgICB9CgogICAgZnVuY3Rpb24gaW1wbGVtZW50c0VSQzcyMSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKGJvb2wpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgoKICAgIC8vLyBGb3IgcXVlcnlpbmcgb3duZXIgb2YgdG9rZW4KICAgIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIHRva2VuSUQgZm9yIG93bmVyIGlucXVpcnkKICAgIC8vLyBAZGV2IFJlcXVpcmVkIGZvciBFUkMtNzIxIGNvbXBsaWFuY2UuCiAgICBmdW5jdGlvbiBvd25lck9mKHVpbnQyNTYgX3Rva2VuSWQpCiAgICAgIHB1YmxpYwogICAgICB2aWV3CiAgICAgIHJldHVybnMgKGFkZHJlc3Mgb3duZXIpCiAgICB7CiAgICAgIG93bmVyID0gdG9rZW5JbmRleFRvT3duZXJbX3Rva2VuSWRdOwogICAgfQoKCiAgICBmdW5jdGlvbiBwcmljZU9mKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgcHJpY2UpIHsKICAgICAgcHJpY2UgPSB0b2tlbkluZGV4VG9QcmljZVtfdG9rZW5JZF07CiAgICB9CgoKICAgIC8vLyBAbm90aWNlIEFsbG93IHByZS1hcHByb3ZlZCB1c2VyIHRvIHRha2Ugb3duZXJzaGlwIG9mIGEgdG9rZW4KICAgIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIElEIG9mIHRoZSBUb2tlbiB0aGF0IGNhbiBiZSB0cmFuc2ZlcnJlZCBpZiB0aGlzIGNhbGwgc3VjY2VlZHMuCiAgICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogICAgZnVuY3Rpb24gdGFrZU93bmVyc2hpcCh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgewogICAgICBhZGRyZXNzIG5ld093bmVyID0gbXNnLnNlbmRlcjsKICAgICAgYWRkcmVzcyBvbGRPd25lciA9IHRva2VuSW5kZXhUb093bmVyW190b2tlbklkXTsKCiAgICAgIC8vIFNhZmV0eSBjaGVjayB0byBwcmV2ZW50IGFnYWluc3QgYW4gdW5leHBlY3RlZCAweDAgZGVmYXVsdC4KICAgICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKCiAgICAgIC8vIE1ha2luZyBzdXJlIHRyYW5zZmVyIGlzIGFwcHJvdmVkCiAgICAgIHJlcXVpcmUoX2FwcHJvdmVkKG5ld093bmVyLCBfdG9rZW5JZCkpOwoKICAgICAgX3RyYW5zZmVyKG9sZE93bmVyLCBuZXdPd25lciwgX3Rva2VuSWQpOwogICAgfQoKICAgIC8vLyBPd25lciBpbml0YXRlcyB0aGUgdHJhbnNmZXIgb2YgdGhlIHRva2VuIHRvIGFub3RoZXIgYWNjb3VudAogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgZm9yIHRoZSB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZCB0by4KICAgIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIElEIG9mIHRoZSBUb2tlbiB0aGF0IGNhbiBiZSB0cmFuc2ZlcnJlZCBpZiB0aGlzIGNhbGwgc3VjY2VlZHMuCiAgICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogICAgZnVuY3Rpb24gdHJhbnNmZXIoCiAgICAgIGFkZHJlc3MgX3RvLAogICAgICB1aW50MjU2IF90b2tlbklkCiAgICApIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgIHJlcXVpcmUoX293bnNUb2tlbihtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwogICAgICBfdHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdG9rZW5JZCk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vLyBUaGlyZC1wYXJ0eSBpbml0aWF0ZXMgdHJhbnNmZXIgb2YgdG9rZW4gZnJvbSBhZGRyZXNzIF9mcm9tIHRvIGFkZHJlc3MgX3RvCiAgICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBhZGRyZXNzIGZvciB0aGUgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQgZnJvbS4KICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIGZvciB0aGUgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQgdG8uCiAgICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSBJRCBvZiB0aGUgVG9rZW4gdGhhdCBjYW4gYmUgdHJhbnNmZXJyZWQgaWYgdGhpcyBjYWxsIHN1Y2NlZWRzLgogICAgLy8vIEBkZXYgUmVxdWlyZWQgZm9yIEVSQy03MjEgY29tcGxpYW5jZS4KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbSgKICAgICAgYWRkcmVzcyBfZnJvbSwKICAgICAgYWRkcmVzcyBfdG8sCiAgICAgIHVpbnQyNTYgX3Rva2VuSWQKICAgICkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgcmVxdWlyZShfb3duc1Rva2VuKF9mcm9tLCBfdG9rZW5JZCkpOwogICAgICByZXF1aXJlKF9hcHByb3ZlZChfdG8sIF90b2tlbklkKSk7CgogICAgICBfdHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCgogICAgLy8vIEZvciBjaGVja2luZyBhcHByb3ZhbCBvZiB0cmFuc2ZlciBmb3IgYWRkcmVzcyBfdG8KICAgIGZ1bmN0aW9uIF9hcHByb3ZlZChhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgcmV0dXJuIHRva2VuSW5kZXhUb0FwcHJvdmVkW190b2tlbklkXSA9PSBfdG87CiAgICB9CgogICAgLy8vIENoZWNrIGZvciB0b2tlbiBvd25lcnNoaXAKICAgIGZ1bmN0aW9uIF9vd25zVG9rZW4oYWRkcmVzcyBjbGFpbWFudCwgdWludDI1NiBfdG9rZW5JZCkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgIHJldHVybiBjbGFpbWFudCA9PSB0b2tlbkluZGV4VG9Pd25lcltfdG9rZW5JZF07CiAgICB9CiAgICAvLyBGb3IgVXBjb21pbmcgUHJpY2UgQ2hhbmdlIEZlYXR1cmVzCiAgICBmdW5jdGlvbiBjaGFuZ2VUb2tlblByaWNlKHVpbnQyNTYgbmV3UHJpY2UsIHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsIG9ubHlZQ0MgewogICAgICB0b2tlbkluZGV4VG9QcmljZVtfdG9rZW5JZF0gPSBuZXdQcmljZTsKICAgIH0KCiAgICAvLy8gRm9yIHF1ZXJ5aW5nIGJhbGFuY2Ugb2YgYSBwYXJ0aWN1bGFyIGFjY291bnQKICAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIGZvciBiYWxhbmNlIHF1ZXJ5CiAgICAvLy8gQGRldiBSZXF1aXJlZCBmb3IgRVJDLTcyMSBjb21wbGlhbmNlLgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHJlc3VsdCkgewogICAgICAgIHVpbnQyNTYgdG90YWxUb2tlbnMgPSB0b2tlbnMubGVuZ3RoOwogICAgICAgIHVpbnQyNTYgdG9rZW5JbmRleDsKICAgICAgICB1aW50MjU2IHRva2VuSWQ7CiAgICAgICAgcmVzdWx0ID0gMDsKICAgICAgICBmb3IgKHRva2VuSW5kZXggPSAwOyB0b2tlbkluZGV4IDwgdG90YWxUb2tlbnM7IHRva2VuSW5kZXgrKykgewogICAgICAgICAgdG9rZW5JZCA9IHRva2Vuc1t0b2tlbkluZGV4XTsKICAgICAgICAgIGlmICh0b2tlbkluZGV4VG9Pd25lclt0b2tlbklkXSA9PSBfb3duZXIpIHsKICAgICAgICAgICAgcmVzdWx0Kys7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogICAgLy8vIEBkZXYgQXNzaWducyBvd25lcnNoaXAgb2YgYSBzcGVjaWZpYyBDb2xsZWN0aWJsZSB0byBhbiBhZGRyZXNzLgogICAgZnVuY3Rpb24gX3RyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBpbnRlcm5hbCB7CiAgICAgIC8vdHJhbnNmZXIgb3duZXJzaGlwCiAgICAgIHRva2VuSW5kZXhUb093bmVyW190b2tlbklkXSA9IF90bzsKCiAgICAgIC8vIFdoZW4gY3JlYXRpbmcgbmV3IGNvbGxlY3RpYmxlcyBfZnJvbSBpcyAweDAsIGJ1dCB3ZSBjYW4ndCBhY2NvdW50IHRoYXQgYWRkcmVzcy4KICAgICAgaWYgKF9mcm9tICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICAvLyBjbGVhciBhbnkgcHJldmlvdXNseSBhcHByb3ZlZCBvd25lcnNoaXAgZXhjaGFuZ2UKICAgICAgICBkZWxldGUgdG9rZW5JbmRleFRvQXBwcm92ZWRbX3Rva2VuSWRdOwogICAgICB9CgogICAgICAvLyBFbWl0IHRoZSB0cmFuc2ZlciBldmVudC4KICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogICAgfQoKCiAgICAvLy8gQHBhcmFtIF9vd25lciBUaGUgb3duZXIgd2hvc2UgY2VsZWJyaXR5IHRva2VucyB3ZSBhcmUgaW50ZXJlc3RlZCBpbi4KICAgIC8vLyBAZGV2IFRoaXMgbWV0aG9kIE1VU1QgTkVWRVIgYmUgY2FsbGVkIGJ5IHNtYXJ0IGNvbnRyYWN0IGNvZGUuIEZpcnN0LCBpdCdzIGZhaXJseQogICAgLy8vICBleHBlbnNpdmUgKGl0IHdhbGtzIHRoZSBlbnRpcmUgdG9rZW5zIGFycmF5IGxvb2tpbmcgZm9yIHRva2VucyBiZWxvbmdpbmcgdG8gb3duZXIpLAogICAgLy8vICBidXQgaXQgYWxzbyByZXR1cm5zIGEgZHluYW1pYyBhcnJheSwgd2hpY2ggaXMgb25seSBzdXBwb3J0ZWQgZm9yIHdlYjMgY2FsbHMsIGFuZAogICAgLy8vICBub3QgY29udHJhY3QtdG8tY29udHJhY3QgY2FsbHMuCiAgICBmdW5jdGlvbiB0b2tlbnNPZk93bmVyKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnQyNTZbXSBvd25lclRva2VucykgewogICAgICB1aW50MjU2IHRva2VuQ291bnQgPSBiYWxhbmNlT2YoX293bmVyKTsKICAgICAgaWYgKHRva2VuQ291bnQgPT0gMCkgewogICAgICAgICAgLy8gUmV0dXJuIGFuIGVtcHR5IGFycmF5CiAgICAgICAgcmV0dXJuIG5ldyB1aW50MjU2W10oMCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdWludDI1NltdIG1lbW9yeSByZXN1bHQgPSBuZXcgdWludDI1NltdKHRva2VuQ291bnQpOwogICAgICAgIHVpbnQyNTYgdG90YWxUb2tlbnMgPSBnZXRUb3RhbFN1cHBseSgpOwogICAgICAgIHVpbnQyNTYgcmVzdWx0SW5kZXggPSAwOwoKICAgICAgICB1aW50MjU2IHRva2VuSW5kZXg7CiAgICAgICAgdWludDI1NiB0b2tlbklkOwogICAgICAgIGZvciAodG9rZW5JbmRleCA9IDA7IHRva2VuSW5kZXggPCB0b3RhbFRva2VuczsgdG9rZW5JbmRleCsrKSB7CiAgICAgICAgICB0b2tlbklkID0gdG9rZW5zW3Rva2VuSW5kZXhdOwogICAgICAgICAgaWYgKHRva2VuSW5kZXhUb093bmVyW3Rva2VuSWRdID09IF9vd25lcikgewogICAgICAgICAgICByZXN1bHRbcmVzdWx0SW5kZXhdID0gdG9rZW5JZDsKICAgICAgICAgICAgcmVzdWx0SW5kZXggPSByZXN1bHRJbmRleC5hZGQoMSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgIH0KICAgIH0KCgogICAgICAvLyB1aW50MjU2W10gc3RvcmFnZSBfcmVzdWx0ID0gbmV3IHVpbnQyNTZbXSgpOwogICAgICAvLyB1aW50MjU2IHRvdGFsVG9rZW5zID0gZ2V0VG90YWxTdXBwbHkoKTsKCiAgICAgIC8vIGZvciAodWludDI1NiB0b2tlbkluZGV4ID0gMDsgdG9rZW5JbmRleCA8IHRvdGFsVG9rZW5zOyB0b2tlbkluZGV4KyspIHsKICAgICAgLy8gICBpZiAodG9rZW5JbmRleFRvT3duZXJbdG9rZW5zW3Rva2VuSW5kZXhdXSA9PSBfb3duZXIpIHsKICAgICAgLy8gICAgIF9yZXN1bHQucHVzaCh0b2tlbnNbdG9rZW5JbmRleF0pOwogICAgICAvLyAgIH0KICAgICAgLy8gfQogICAgICAvLyByZXR1cm4gX3Jlc3VsdDsKCgogICAgLy8vIEBkZXYgcmV0dXJucyBhbiBhcnJheSB3aXRoIGFsbCB0b2tlbiBpZHMKICAgIGZ1bmN0aW9uIGdldFRva2VuSWRzKCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50MjU2W10pIHsKICAgICAgcmV0dXJuIHRva2VuczsKICAgIH0KCiAgLy8KICAvLyAgRVJDNzIxIGVuZAogIC8vCn0KCmNvbnRyYWN0IFVuaXZlcnNlIGlzIEVSQzcyMVlDIHsKCiAgbWFwcGluZyAodWludCA9PiBhZGRyZXNzKSBwcml2YXRlIHN1YlRva2VuQ3JlYXRvcjsKICBtYXBwaW5nICh1aW50ID0+IGFkZHJlc3MpIHByaXZhdGUgbGFzdFN1YlRva2VuQnV5ZXI7CgogIHVpbnQxNiBjb25zdGFudCBNQVhfV09STERfSU5ERVggPSAxMDAwOwogIHVpbnQyNCBjb25zdGFudCBNQVhfQ09OVElORU5UX0lOREVYID0gMTAwMDAwMDA7CiAgdWludDY0IGNvbnN0YW50IE1BWF9TVUJDT05USU5FTlRfSU5ERVggPSAxMDAwMDAwMDAwMDAwMDsKICB1aW50NjQgY29uc3RhbnQgTUFYX0NPVU5UUllfSU5ERVggPSAxMDAwMDAwMDAwMDAwMDAwMDAwMDsKICB1aW50MTI4IGNvbnN0YW50IEZJRlRZX1RPS0VOU19JTkRFWCA9IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDsKICB1aW50MjU2IGNvbnN0YW50IFRSSUJMRV9UT0tFTlNfSU5ERVggPSAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwOwogIHVpbnQyNTYgY29uc3RhbnQgRE9VQkxFX1RPS0VOU19JTkRFWCA9IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwOwogIHVpbnQ4IGNvbnN0YW50IFVOSVZFUlNFX1RPS0VOX0lEID0gMDsKICB1aW50IHB1YmxpYyBtaW5TZWxmQnV5UHJpY2UgPSAxMCBldGhlcjsKICB1aW50IHB1YmxpYyBtaW5QcmljZUZvck1pbmluZ1VwZ3JhZGUgPSA1IGV0aGVyOwoKICAvKioqIENPTlNUUlVDVE9SICoqKi8KICBmdW5jdGlvbiBVbml2ZXJzZSgpIHB1YmxpYyB7CiAgfQoKICBmdW5jdGlvbiBjaGFuZ2VQcmljZUxpbWl0cyh1aW50IF9taW5TZWxmQnV5UHJpY2UsIHVpbnQgX21pblByaWNlRm9yTWluaW5nVXBncmFkZSkgcHVibGljIG9ubHlDT08gewogICAgbWluU2VsZkJ1eVByaWNlID0gX21pblNlbGZCdXlQcmljZTsKICAgIG1pblByaWNlRm9yTWluaW5nVXBncmFkZSA9IF9taW5QcmljZUZvck1pbmluZ1VwZ3JhZGU7CiAgfQoKICBmdW5jdGlvbiBnZXROZXh0UHJpY2UodWludCBwcmljZSwgdWludCBfdG9rZW5JZCkgcHVibGljIHB1cmUgcmV0dXJucyAodWludCkgewogICAgaWYgKF90b2tlbklkPkRPVUJMRV9UT0tFTlNfSU5ERVgpCiAgICAgIHJldHVybiBwcmljZS5tdWwoMik7CiAgICBpZiAoX3Rva2VuSWQ+VFJJQkxFX1RPS0VOU19JTkRFWCkKICAgICAgcmV0dXJuIHByaWNlLm11bCgzKTsKICAgIGlmIChfdG9rZW5JZD5GSUZUWV9UT0tFTlNfSU5ERVgpCiAgICAgIHJldHVybiBwcmljZS5tdWwoMykuZGl2KDIpOwogICAgaWYgKHByaWNlIDwgMS4yIGV0aGVyKQogICAgICByZXR1cm4gcHJpY2UubXVsKDIwMCkuZGl2KDkxKTsKICAgIGlmIChwcmljZSA8IDUgZXRoZXIpCiAgICAgIHJldHVybiBwcmljZS5tdWwoMTUwKS5kaXYoOTEpOwogICAgcmV0dXJuIHByaWNlLm11bCgxMjApLmRpdig5MSk7CiAgfQoKCiAgZnVuY3Rpb24gYnV5VG9rZW4odWludCBfdG9rZW5JZCkgcHVibGljIHBheWFibGUgewogICAgYWRkcmVzcyBvbGRPd25lciA9IHRva2VuSW5kZXhUb093bmVyW190b2tlbklkXTsKICAgIHVpbnQyNTYgc2VsbGluZ1ByaWNlID0gdG9rZW5JbmRleFRvUHJpY2VbX3Rva2VuSWRdOwogICAgcmVxdWlyZShvbGRPd25lciE9bXNnLnNlbmRlciB8fCBzZWxsaW5nUHJpY2UgPiBtaW5TZWxmQnV5UHJpY2UpOwogICAgcmVxdWlyZShtc2cudmFsdWUgPj0gc2VsbGluZ1ByaWNlKTsKICAgIHJlcXVpcmUoc2VsbGluZ1ByaWNlID4gMCk7CgogICAgdWludDI1NiBwdXJjaGFzZUV4Y2VzcyA9IG1zZy52YWx1ZS5zdWIoc2VsbGluZ1ByaWNlKTsKICAgIHVpbnQyNTYgcGF5bWVudCA9IHNlbGxpbmdQcmljZS5tdWwoOTEpLmRpdigxMDApOwogICAgdWludDI1NiBmZWVPbmNlID0gc2VsbGluZ1ByaWNlLnN1YihwYXltZW50KS5kaXYoOSk7CgogICAgLy8gVXBkYXRlIHByaWNlcwogICAgdG9rZW5JbmRleFRvUHJpY2VbX3Rva2VuSWRdID0gZ2V0TmV4dFByaWNlKHNlbGxpbmdQcmljZSwgX3Rva2VuSWQpOwogICAgLy8gVHJhbnNmZXJzIHRoZSBUb2tlbgogICAgdG9rZW5JbmRleFRvT3duZXJbX3Rva2VuSWRdID0gbXNnLnNlbmRlcjsKICAgIC8vIGNsZWFyIGFueSBwcmV2aW91c2x5IGFwcHJvdmVkIG93bmVyc2hpcCBleGNoYW5nZQogICAgZGVsZXRlIHRva2VuSW5kZXhUb0FwcHJvdmVkW190b2tlbklkXTsKICAgIC8vIHBheW91dCBtaW5pbmcgcmV3YXJkCiAgICBpZiAoX3Rva2VuSWQ+TUFYX1NVQkNPTlRJTkVOVF9JTkRFWCkgewogICAgICB5Y20ucGF5b3V0TWluaW5nKF90b2tlbklkLCBvbGRPd25lciwgbXNnLnNlbmRlcik7CiAgICAgIGlmIChzZWxsaW5nUHJpY2UgPiBtaW5QcmljZUZvck1pbmluZ1VwZ3JhZGUpCiAgICAgICAgeWNtLmxldmVsVXBNaW5pbmcoX3Rva2VuSWQpOwogICAgfQoKICAgIGlmIChfdG9rZW5JZCA+IDApIHsKICAgICAgLy8gVGF4ZXMgZm9yIFVuaXZlcnNlIG93bmVyCiAgICAgIGlmICh0b2tlbkluZGV4VG9Pd25lcltVTklWRVJTRV9UT0tFTl9JRF0hPWFkZHJlc3MoMCkpCiAgICAgICAgdG9rZW5JbmRleFRvT3duZXJbVU5JVkVSU0VfVE9LRU5fSURdLnRyYW5zZmVyKGZlZU9uY2UpOwogICAgICBpZiAoX3Rva2VuSWQgPiBNQVhfV09STERfSU5ERVgpIHsKICAgICAgICAvLyBUYXhlcyBmb3Igd29ybGQgb3duZXIKICAgICAgICBpZiAodG9rZW5JbmRleFRvT3duZXJbX3Rva2VuSWQgJSBNQVhfV09STERfSU5ERVhdIT1hZGRyZXNzKDApKQogICAgICAgICAgdG9rZW5JbmRleFRvT3duZXJbX3Rva2VuSWQgJSBNQVhfV09STERfSU5ERVhdLnRyYW5zZmVyKGZlZU9uY2UpOwogICAgICAgIGlmIChfdG9rZW5JZCA+IE1BWF9DT05USU5FTlRfSU5ERVgpIHsKICAgICAgICAgIC8vIFRheGVzIGZvciBjb250aW5lbnQgb3duZXIKICAgICAgICAgIGlmICh0b2tlbkluZGV4VG9Pd25lcltfdG9rZW5JZCAlIE1BWF9DT05USU5FTlRfSU5ERVhdIT1hZGRyZXNzKDApKQogICAgICAgICAgICB0b2tlbkluZGV4VG9Pd25lcltfdG9rZW5JZCAlIE1BWF9DT05USU5FTlRfSU5ERVhdLnRyYW5zZmVyKGZlZU9uY2UpOwogICAgICAgICAgaWYgKF90b2tlbklkID4gTUFYX1NVQkNPTlRJTkVOVF9JTkRFWCkgewogICAgICAgICAgICAvLyBUYXhlcyBmb3Igc3ViY29udGluZW50IG93bmVyCiAgICAgICAgICAgIGlmICh0b2tlbkluZGV4VG9Pd25lcltfdG9rZW5JZCAlIE1BWF9TVUJDT05USU5FTlRfSU5ERVhdIT1hZGRyZXNzKDApKQogICAgICAgICAgICAgIHRva2VuSW5kZXhUb093bmVyW190b2tlbklkICUgTUFYX1NVQkNPTlRJTkVOVF9JTkRFWF0udHJhbnNmZXIoZmVlT25jZSk7CiAgICAgICAgICAgIGlmIChfdG9rZW5JZCA+IE1BWF9DT1VOVFJZX0lOREVYKSB7CiAgICAgICAgICAgICAgLy8gVGF4ZXMgZm9yIGNvdW50cnkgb3duZXIKICAgICAgICAgICAgICBpZiAodG9rZW5JbmRleFRvT3duZXJbX3Rva2VuSWQgJSBNQVhfQ09VTlRSWV9JTkRFWF0hPWFkZHJlc3MoMCkpCiAgICAgICAgICAgICAgICB0b2tlbkluZGV4VG9Pd25lcltfdG9rZW5JZCAlIE1BWF9DT1VOVFJZX0lOREVYXS50cmFuc2ZlcihmZWVPbmNlKTsKICAgICAgICAgICAgICBsYXN0U3ViVG9rZW5CdXllcltVTklWRVJTRV9UT0tFTl9JRF0gPSBtc2cuc2VuZGVyOwogICAgICAgICAgICAgIGxhc3RTdWJUb2tlbkJ1eWVyW190b2tlbklkICUgTUFYX1dPUkxEX0lOREVYXSA9IG1zZy5zZW5kZXI7CiAgICAgICAgICAgICAgbGFzdFN1YlRva2VuQnV5ZXJbX3Rva2VuSWQgJSBNQVhfQ09OVElORU5UX0lOREVYXSA9IG1zZy5zZW5kZXI7CiAgICAgICAgICAgICAgbGFzdFN1YlRva2VuQnV5ZXJbX3Rva2VuSWQgJSBNQVhfU1VCQ09OVElORU5UX0lOREVYXSA9IG1zZy5zZW5kZXI7CiAgICAgICAgICAgICAgbGFzdFN1YlRva2VuQnV5ZXJbX3Rva2VuSWQgJSBNQVhfQ09VTlRSWV9JTkRFWF0gPSBtc2cuc2VuZGVyOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGlmIChsYXN0U3ViVG9rZW5CdXllcltfdG9rZW5JZF0gIT0gYWRkcmVzcygwKSkKICAgICAgICAgICAgICAgIGxhc3RTdWJUb2tlbkJ1eWVyW190b2tlbklkXS50cmFuc2ZlcihmZWVPbmNlKjIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAobGFzdFN1YlRva2VuQnV5ZXJbX3Rva2VuSWRdICE9IGFkZHJlc3MoMCkpCiAgICAgICAgICAgICAgbGFzdFN1YlRva2VuQnV5ZXJbX3Rva2VuSWRdLnRyYW5zZmVyKGZlZU9uY2UqMik7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChsYXN0U3ViVG9rZW5CdXllcltfdG9rZW5JZF0gIT0gYWRkcmVzcygwKSkKICAgICAgICAgICAgbGFzdFN1YlRva2VuQnV5ZXJbX3Rva2VuSWRdLnRyYW5zZmVyKGZlZU9uY2UqMik7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChsYXN0U3ViVG9rZW5CdXllcltfdG9rZW5JZF0gIT0gYWRkcmVzcygwKSkKICAgICAgICAgIGxhc3RTdWJUb2tlbkJ1eWVyW190b2tlbklkXS50cmFuc2ZlcihmZWVPbmNlKjIpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpZiAobGFzdFN1YlRva2VuQnV5ZXJbX3Rva2VuSWRdICE9IGFkZHJlc3MoMCkpCiAgICAgICAgbGFzdFN1YlRva2VuQnV5ZXJbX3Rva2VuSWRdLnRyYW5zZmVyKGZlZU9uY2UqMik7CiAgICB9CiAgICAvLyBUYXhlcyBmb3IgY29sbGVjdGlibGUgY3JlYXRvciAoZmlyc3Qgb3duZXIpCiAgICBpZiAoc3ViVG9rZW5DcmVhdG9yW190b2tlbklkXSE9YWRkcmVzcygwKSkKICAgICAgc3ViVG9rZW5DcmVhdG9yW190b2tlbklkXS50cmFuc2ZlcihmZWVPbmNlKTsKICAgIC8vIFBheW1lbnQgZm9yIG9sZCBvd25lcgogICAgaWYgKG9sZE93bmVyICE9IGFkZHJlc3MoMCkpIHsKICAgICAgb2xkT3duZXIudHJhbnNmZXIocGF5bWVudCk7CiAgICB9CgogICAgVG9rZW5Tb2xkKF90b2tlbklkLCBzZWxsaW5nUHJpY2UsIG9sZE93bmVyLCBtc2cuc2VuZGVyKTsKICAgIFRyYW5zZmVyKG9sZE93bmVyLCBtc2cuc2VuZGVyLCBfdG9rZW5JZCk7CiAgICAvLyByZWZ1bmQgd2hlbiBwYWlkIHRvbyBtdWNoCiAgICBpZiAocHVyY2hhc2VFeGNlc3M+MCkKICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihwdXJjaGFzZUV4Y2Vzcyk7CiAgfQogIAogIC8vLyBGb3IgY3JlYXRpbmcgQ29sbGVjdGlibGUKICBmdW5jdGlvbiBjcmVhdGVDb2xsZWN0aWJsZSh1aW50MjU2IHRva2VuSWQsIHVpbnQyNTYgX3ByaWNlLCBhZGRyZXNzIGNyZWF0b3IsIGFkZHJlc3Mgb3duZXIpIGV4dGVybmFsIG9ubHlZQ0MgewogICAgdG9rZW5JbmRleFRvUHJpY2VbdG9rZW5JZF0gPSBfcHJpY2U7CiAgICB0b2tlbkluZGV4VG9Pd25lclt0b2tlbklkXSA9IG93bmVyOwogICAgc3ViVG9rZW5DcmVhdG9yW3Rva2VuSWRdID0gY3JlYXRvcjsKICAgIEJpcnRoKHRva2VuSWQsIF9wcmljZSk7CiAgICB0b2tlbnMucHVzaCh0b2tlbklkKTsKICB9CgogIGZ1bmN0aW9uIGxhc3RTdWJUb2tlbkJ1eWVyT2YodWludCB0b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zKGFkZHJlc3MpIHsKICAgIHJldHVybiBsYXN0U3ViVG9rZW5CdXllclt0b2tlbklkXTsKICB9CiAgZnVuY3Rpb24gbGFzdFN1YlRva2VuQ3JlYXRvck9mKHVpbnQgdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyhhZGRyZXNzKSB7CiAgICByZXR1cm4gc3ViVG9rZW5DcmVhdG9yW3Rva2VuSWRdOwogIH0KCn0='.
	

]
