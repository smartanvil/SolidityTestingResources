Class {
	#name : #SRTbab3972d8baf95263a137bc0e3290a40224d95cb,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTbab3972d8baf95263a137bc0e3290a40224d95cb >> base64 [
	^ 'LyoqCiAgICBDb3B5cmlnaHQgKGMpIDIwMTggVGF5bG9yIE8mIzIyMDsKCiAgICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5CiAgICBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwgdG8gZGVhbAogICAgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cwogICAgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbAogICAgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzCiAgICBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgoKICAgIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluCiAgICBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KCiAgICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgogICAgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksCiAgICBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUKICAgIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIKICAgIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sCiAgICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOCiAgICBUSEUgU09GVFdBUkUuCgogICAgYmFzZWQgb24gdGhlIGNvbnRyYWN0cyBvZiBPcGVuWmVwcGVsaW46CiAgICBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5L3RyZWUvbWFzdGVyL2NvbnRyYWN0cwoKKiovCgpwcmFnbWEgc29saWRpdHkgXjAuNC4xODsKCi8qKgogKiBAdGl0bGUgT3duYWJsZQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuCiAqLwpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCgogIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKGEgPT0gMCkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgoKLyoqCiAgQHRpdGxlIFRheWxvclRva2VuCioqLwpjb250cmFjdCBUYXlsb3JUb2tlbiBpcyBPd25hYmxlewoKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIC8qKgogICAgICAgIEVWRU5UUwogICAgKiovCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpOwogICAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgX293bmVyLCB1aW50MjU2IF9hbW91bnQpOwogICAgLyoqCiAgICAgICAgQ09OVFJBQ1QgVkFSSUFCTEVTCiAgICAqKi8KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CgogICAgLy90aGlzIGFkZHJlc3MgY2FuIHRyYW5zZmVyIGV2ZW4gd2hlbiB0cmFuc2ZlciBpcyBkaXNhYmxlZC4KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIHdoaXRlbGlzdGVkVHJhbnNmZXI7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyB3aGl0ZWxpc3RlZEJ1cm47CgogICAgc3RyaW5nIHB1YmxpYyBuYW1lID0gIlRheWxvciI7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbCA9ICJUQVkiOwogICAgdWludDggcHVibGljIGRlY2ltYWxzID0gMTg7CiAgICB1aW50MjU2IGNvbnN0YW50IGludGVybmFsIERFQ0lNQUxfQ0FTRVMgPSAxMCoqMTg7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseSA9IDEwKio3ICogREVDSU1BTF9DQVNFUzsKICAgIGJvb2wgcHVibGljIHRyYW5zZmVyYWJsZSA9IGZhbHNlOwoKICAgIC8qKgogICAgICAgIE1PRElGSUVSUwogICAgKiovCiAgICBtb2RpZmllciBvbmx5V2hlblRyYW5zZmVyYWJsZSgpewogICAgICBpZighd2hpdGVsaXN0ZWRUcmFuc2Zlclttc2cuc2VuZGVyXSl7CiAgICAgICAgcmVxdWlyZSh0cmFuc2ZlcmFibGUpOwogICAgICB9CiAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgICAgQ09OU1RSVUNUT1IKICAgICoqLwoKICAgIC8qKgogICAgICBAZGV2IENvbnN0cnVjdG9yIGZ1bmN0aW9uIGV4ZWN1dGVkIG9uIGNvbnRyYWN0IGNyZWF0aW9uCiAgICAqKi8KICAgIGZ1bmN0aW9uIFRheWxvclRva2VuKCkKICAgICAgT3duYWJsZSgpCiAgICAgIHB1YmxpYwogICAgewogICAgICBiYWxhbmNlc1tvd25lcl0gPSBiYWxhbmNlc1tvd25lcl0uYWRkKHRvdGFsU3VwcGx5KTsKICAgICAgd2hpdGVsaXN0ZWRUcmFuc2Zlclttc2cuc2VuZGVyXSA9IHRydWU7CiAgICAgIHdoaXRlbGlzdGVkQnVyblttc2cuc2VuZGVyXSA9IHRydWU7CiAgICAgIFRyYW5zZmVyKGFkZHJlc3MoMCksb3duZXIsIHRvdGFsU3VwcGx5KTsKICAgIH0KCiAgICAvKioKICAgICAgICBPV05FUiBPTkxZIEZVTkNUSU9OUwogICAgKiovCgogICAgLyoqCiAgICAgIEBkZXYgQWN0aXZhdGVzIHRoZSB0cmFzZmVyIGZvciBhbGwgdXNlcnMKICAgICoqLwogICAgZnVuY3Rpb24gYWN0aXZhdGVUcmFuc2ZlcnMoKQogICAgICBwdWJsaWMKICAgICAgb25seU93bmVyCiAgICB7CiAgICAgIHRyYW5zZmVyYWJsZSA9IHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgIEBkZXYgQWxsb3dzIHRoZSBvd25lciB0byBhZGQgYWRkcmVzc2UgdGhhdCBjYW4gYnlwYXNzIHRoZQogICAgICB0cmFuc2ZlciBsb2NrLiBFZzogSUNPIGNvbnRyYWN0LCBUR0UgY29udHJhY3QuCiAgICAgIEBwYXJhbSBfYWRkcmVzcyBhZGRyZXNzIEFkZHJlc3MgdG8gYmUgYWRkZWQKICAgICoqLwogICAgZnVuY3Rpb24gYWRkV2hpdGVsaXN0ZWRUcmFuc2ZlcihhZGRyZXNzIF9hZGRyZXNzKQogICAgICBwdWJsaWMKICAgICAgb25seU93bmVyCiAgICB7CiAgICAgIHdoaXRlbGlzdGVkVHJhbnNmZXJbX2FkZHJlc3NdID0gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAgQGRldiBTZW5kcyBhbGwgYXZhaWJsZSBUQVkgdG8gdGhlIFRHRSBjb250cmFjdCB0byBiZSBwcm9wZXJseQogICAgICBkaXN0cmlidXRlCiAgICAgIEBwYXJhbSBfdGdlQWRkcmVzcyBhZGRyZXNzIEFkZHJlc3Mgb2YgdGhlIHRva2VuIGRpc3RyaWJ1dGlvbgogICAgICBjb250cmFjdAogICAgKiovCiAgICBmdW5jdGlvbiBkaXN0cmlidXRlKGFkZHJlc3MgX3RnZUFkZHJlc3MpCiAgICAgIHB1YmxpYwogICAgICBvbmx5T3duZXIKICAgIHsKICAgICAgd2hpdGVsaXN0ZWRUcmFuc2ZlcltfdGdlQWRkcmVzc10gPSB0cnVlOwogICAgICB0cmFuc2ZlcihfdGdlQWRkcmVzcywgYmFsYW5jZXNbb3duZXJdKTsKICAgIH0KCgogICAgLyoqCiAgICAgIEBkZXYgQWxsb3dzIHRoZSBvd25lciB0byBhZGQgYWRkcmVzc2UgdGhhdCBjYW4gYnVybiB0b2tlbnMKICAgICAgRWc6IElDTyBjb250cmFjdCwgVEdFIGNvbnRyYWN0LgogICAgICBAcGFyYW0gX2FkZHJlc3MgYWRkcmVzcyBBZGRyZXNzIHRvIGJlIGFkZGVkCiAgICAqKi8KICAgIGZ1bmN0aW9uIGFkZFdoaXRlbGlzdGVkQnVybihhZGRyZXNzIF9hZGRyZXNzKQogICAgICBwdWJsaWMKICAgICAgb25seU93bmVyCiAgICB7CiAgICAgIHdoaXRlbGlzdGVkQnVybltfYWRkcmVzc10gPSB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICAgIFBVQkxJQyBGVU5DVElPTlMKICAgICoqLwoKICAgIC8qKgogICAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpCiAgICAgIHB1YmxpYwogICAgICBvbmx5V2hlblRyYW5zZmVyYWJsZQogICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1ttc2cuc2VuZGVyXSk7CgogICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20KICAgICAgKGFkZHJlc3MgX2Zyb20sCiAgICAgICAgYWRkcmVzcyBfdG8sCiAgICAgICAgdWludDI1NiBfdmFsdWUpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seVdoZW5UcmFuc2ZlcmFibGUKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW19mcm9tXSk7CiAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKCiAgICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAgRm9yIHNlY3VyaXR5IHJlYXNvbnMsIGlmIG9uZSBuZWVkIHRvIGNoYW5nZSB0aGUgdmFsdWUgZnJvbSBhIGV4aXN0aW5nIGFsbG93YW5jZSwgaXQgbXVzdCBmdXJzdCBzZXRzCiAgICBpdCB0byB6ZXJvIGFuZCB0aGVuIHNldHMgdGhlIG5ldyB2YWx1ZQoKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpCiAgICAgIHB1YmxpYwogICAgICBvbmx5V2hlblRyYW5zZmVyYWJsZQogICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgICAvKioKICAgICAqIEBkZXYgSW5jcmVhc2UgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgICAqCiAgICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF9hZGRlZFZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGluY3JlYXNlIHRoZSBhbGxvd2FuY2UgYnkuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkKICAgICAgcHVibGljCiAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IERlY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICAgKgogICAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gZGVjcmVtZW50CiAgICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgICAqIEBwYXJhbSBfc3VidHJhY3RlZFZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGRlY3JlYXNlIHRoZSBhbGxvd2FuY2UgYnkuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKQogICAgICBwdWJsaWMKICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgICB9IGVsc2UgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgICB9CiAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICBAZGV2IEFsbG93cyBmb3IgbXNnLnNlbmRlciB0byBidXJuIGhpcyBvbiB0b2tlbnMKICAgICAgQHBhcmFtIF9hbW91bnQgdWludDI1NiBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBidXJuZWQKICAgICoqLwogICAgZnVuY3Rpb24gYnVybih1aW50MjU2IF9hbW91bnQpCiAgICAgIHB1YmxpYwogICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgIHJlcXVpcmUod2hpdGVsaXN0ZWRCdXJuW21zZy5zZW5kZXJdKTsKICAgICAgcmVxdWlyZShfYW1vdW50IDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX2Ftb3VudCk7CiAgICAgIHRvdGFsU3VwcGx5ID0gIHRvdGFsU3VwcGx5LnN1YihfYW1vdW50KTsKICAgICAgQnVybihtc2cuc2VuZGVyLCBfYW1vdW50KTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgoKICAgIC8qKgogICAgICAgIENPTlNUQU5UIEZVTkNUSU9OUwogICAgKiovCgogICAgLyoqCiAgICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICAgKi8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgdmlldyBwdWJsaWMgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9CgogICAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpCiAgICAgIHZpZXcKICAgICAgcHVibGljCiAgICAgIHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKQogICAgewogICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KCn0KCgovKioKICogQHRpdGxlIFBhdXNhYmxlCiAqIEBkZXYgQmFzZSBjb250cmFjdCB3aGljaCBhbGxvd3MgY2hpbGRyZW4gdG8gaW1wbGVtZW50IGFuIGVtZXJnZW5jeSBzdG9wIG1lY2hhbmlzbS4KICovCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgewogIGV2ZW50IFBhdXNlKCk7CiAgZXZlbnQgVW5wYXVzZSgpOwoKICBib29sIHB1YmxpYyBwYXVzZWQgPSBmYWxzZTsKCgogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgbm90IHBhdXNlZC4KICAgKi8KICBtb2RpZmllciB3aGVuTm90UGF1c2VkKCkgewogICAgcmVxdWlyZSghcGF1c2VkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIHBhdXNlZC4KICAgKi8KICBtb2RpZmllciB3aGVuUGF1c2VkKCkgewogICAgcmVxdWlyZShwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byBwYXVzZSwgdHJpZ2dlcnMgc3RvcHBlZCBzdGF0ZQogICAqLwogIGZ1bmN0aW9uIHBhdXNlKCkgb25seU93bmVyIHdoZW5Ob3RQYXVzZWQgcHVibGljIHsKICAgIHBhdXNlZCA9IHRydWU7CiAgICBQYXVzZSgpOwogIH0KCiAgLyoqCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHVucGF1c2UsIHJldHVybnMgdG8gbm9ybWFsIHN0YXRlCiAgICovCiAgZnVuY3Rpb24gdW5wYXVzZSgpIG9ubHlPd25lciB3aGVuUGF1c2VkIHB1YmxpYyB7CiAgICBwYXVzZWQgPSBmYWxzZTsKICAgIFVucGF1c2UoKTsKICB9Cn0KCgovKioKICBAdGl0bGUgQ3Jvd2RzYWxlCgoqKi8KY29udHJhY3QgQ3Jvd2RzYWxlIGlzIE93bmFibGUsIFBhdXNhYmxlIHsKCiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIC8qKgogICAgICBFVkVOVFMKICAqKi8KICBldmVudCBQdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgYnV5ZXIsIHVpbnQyNTYgd2VpQW1vdW50LCB1aW50MjU2IHRva2VuQW1vdW50KTsKICBldmVudCBGaW5hbGl6ZWQodWludDI1NiB0b2tlbnNTb2xkLCB1aW50MjU2IHdlaUFtb3VudCk7CgogIC8qKgogICAgICBDT05UUkFDVCBWQVJJQUJMRVMKICAqKi8KICBUYXlsb3JUb2tlbiBwdWJsaWMgdGF5bG9yVG9rZW47CgogIHVpbnQyNTYgcHVibGljIHN0YXJ0VGltZTsKICB1aW50MjU2IHB1YmxpYyBlbmRUaW1lOwogIHVpbnQyNTYgcHVibGljIHdlaVJhaXNlZDsKICB1aW50MjU2IHB1YmxpYyB0b2tlbnNTb2xkOwogIHVpbnQyNTYgcHVibGljIHRva2VuQ2FwOwogIHVpbnQyNTYgcHVibGljIHBvb2xFdGhTb2xkOwogIGJvb2wgcHVibGljIGZpbmFsaXplZDsKICBhZGRyZXNzIHB1YmxpYyB3YWxsZXQ7CgogIHVpbnQyNTYgcHVibGljIG1heEdhc1ByaWNlID0gNTAwMDAwMDAwMDA7CgogIHVpbnQyNTZbNF0gcHVibGljIHJhdGVzOwoKICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyB3aGl0ZWxpc3RlZDsKICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyB3aGl0ZWxpc3RlZFBvb2xzOwogIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGNvbnRyaWJ1dG9yczsKCiAgLyoqCiAgICAgIFBVQkxJQyBDT05TVEFOVFMKICAqKi8KICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBwb29sRXRoQ2FwID0gMTI1MCBldGhlcjsKICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBtaW5pbXVtUG9vbFB1cmNoYXNlID0gMTAwIGV0aGVyOwogIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IG1pbmltdW1QdXJjaGFzZSA9IDAuMDEgZXRoZXI7CiAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgbWF4aW11bVBvb2xQdXJjaGFzZSA9IDI1MCBldGhlcjsKICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBtYXhpbXVtUHVyY2hhc2UgPSA1MCBldGhlcjsKICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBzcGVjaWFsUG9vbHNSYXRlID0gNjAwMDAwMDAwMDAwMDAwOwoKCgogIC8qKgogICAgICBDT05TVFJVQ1RPUgogICoqLwoKICAvKioKICAgIEBkZXYgSUNPIENPTlNUUlVDVE9SCiAgICBAcGFyYW0gX3N0YXJ0VGltZSB1aW50MjU2IHRpbWVzdGFtcCB0aGF0IHRoZSBzYWxlIHdpbGwgYmVnaW4KICAgIEBwYXJhbSBfZHVyYXRpb24gdWludDI1NiAgaG93IGxvbmcoaW4gZGF5cykgdGhlIHNhbGUgd2lsbCBsYXN0CiAgICBAcGFyYW0gX3Rva2VuQ2FwIHVpbnQyNTYgSG93IG1hbnkgdG9rZW5zIHdpbGwgYmUgc29sZCBzYWxlCiAgICBAcGFyYW0gX3Rva2VuIGFkZHJlc3MgdGhlIGFkZHJlc3Mgb2YgdGhlIHRva2VuIGNvbnRyYWN0CiAgICBAcGFyYW0gX3dhbGxldCBhZGRyZXNzIHRoZSBhZGRyZXNzIG9mIHRoZSB3YWxsZXQgdGhhdCB3aWxsIHJlY2lldmUgZnVuZHMKICAqKi8KICBmdW5jdGlvbiBDcm93ZHNhbGUoCiAgICB1aW50MjU2IF9zdGFydFRpbWUsCiAgICB1aW50MjU2IF9kdXJhdGlvbiwKICAgIHVpbnQyNTYgX3Rva2VuQ2FwLAogICAgYWRkcmVzcyBfdG9rZW4sCiAgICBhZGRyZXNzIF93YWxsZXQpCiAgICBwdWJsaWMKICB7CiAgICByZXF1aXJlKF9zdGFydFRpbWUgPj0gbm93KTsKICAgIHJlcXVpcmUoX3Rva2VuICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfd2FsbGV0ICE9IGFkZHJlc3MoMCkpOwoKICAgIHRheWxvclRva2VuID0gVGF5bG9yVG9rZW4oX3Rva2VuKTsKCiAgICBzdGFydFRpbWUgPSBfc3RhcnRUaW1lOwogICAgZW5kVGltZSA9IHN0YXJ0VGltZSArIF9kdXJhdGlvbiAqIDEgc2Vjb25kcyA7CiAgICB3YWxsZXQgPSBfd2FsbGV0OwogICAgdG9rZW5DYXAgPSBfdG9rZW5DYXA7CiAgICByYXRlcyA9IFs3MDAwMDAwMDAwMDAwMDAsIDc5MDAwMDAwMDAwMDAwMCwgODYwMDAwMDAwMDAwMDAwLCA5MzAwMDAwMDAwMDAwMDBdOwogIH0KCgogIC8qKgogICAgICBQVUJMSUMgRlVOQ1RJT05TCgogICoqLwoKICAvKioKICAgIEBkZXYgRmFsbGJhY2sgZnVuY3Rpb24gdGhhdCBhY2NlcHRzIGV0aCBhbmQgYnV5IHRva2VucwogICoqLwogIGZ1bmN0aW9uICgpIHBheWFibGUgd2hlbk5vdFBhdXNlZCBwdWJsaWMgewogICAgYnV5VG9rZW5zKCk7CiAgfQoKICAvKioKICAgIEBkZXYgQWxsb3dzIHBhcnRpY2lwYW50cyB0byBidXkgdG9rZW5zCiAgKiovCiAgZnVuY3Rpb24gYnV5VG9rZW5zKCkgcGF5YWJsZSB3aGVuTm90UGF1c2VkIHB1YmxpYyB7CiAgICByZXF1aXJlKGlzVmFsaWRQdXJjaGFzZSgpKTsKCiAgICB1aW50MjU2IHRva2VuczsKICAgIHVpbnQyNTYgYW1vdW50ID0gbXNnLnZhbHVlOwoKCiAgICBpZih3aGl0ZWxpc3RlZFBvb2xzW21zZy5zZW5kZXJdICYmIHBvb2xFdGhTb2xkLmFkZChhbW91bnQpID4gcG9vbEV0aENhcCl7CiAgICAgIHVpbnQyNTYgdmFsaWRBbW91bnQgPSBwb29sRXRoQ2FwLnN1Yihwb29sRXRoU29sZCk7CiAgICAgIHJlcXVpcmUodmFsaWRBbW91bnQgPiAwKTsKICAgICAgdWludDI1NiBjaCA9IGFtb3VudC5zdWIodmFsaWRBbW91bnQpOwogICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKGNoKTsKICAgICAgYW1vdW50ID0gdmFsaWRBbW91bnQ7CiAgICB9CgogICAgdG9rZW5zICA9IGNhbGN1bGF0ZVRva2VuQW1vdW50KGFtb3VudCk7CgoKICAgIHVpbnQyNTYgdG9rZW5Qb29sID0gdG9rZW5zU29sZC5hZGQodG9rZW5zKTsKICAgIGlmKHRva2VuUG9vbCA+IHRva2VuQ2FwKXsKICAgICAgdWludDI1NiBwb3NzaWJsZVRva2VucyA9IHRva2VuQ2FwLnN1Yih0b2tlbnNTb2xkKTsKICAgICAgdWludDI1NiBjaGFuZ2UgPSBjYWxjdWxhdGVQcmljZUZvclRva2Vucyh0b2tlbnMuc3ViKHBvc3NpYmxlVG9rZW5zKSk7CiAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoY2hhbmdlKTsKICAgICAgdG9rZW5zID0gcG9zc2libGVUb2tlbnM7CiAgICAgIGFtb3VudCA9IGFtb3VudC5zdWIoY2hhbmdlKTsKICAgIH0KCgoKICAgIGNvbnRyaWJ1dG9yc1ttc2cuc2VuZGVyXSA9IGNvbnRyaWJ1dG9yc1ttc2cuc2VuZGVyXS5hZGQoYW1vdW50KTsKICAgIHRheWxvclRva2VuLnRyYW5zZmVyKG1zZy5zZW5kZXIsIHRva2Vucyk7CgogICAgdG9rZW5zU29sZCA9IHRva2Vuc1NvbGQuYWRkKHRva2Vucyk7CiAgICB3ZWlSYWlzZWQgPSB3ZWlSYWlzZWQuYWRkKGFtb3VudCk7CiAgICBpZih3aGl0ZWxpc3RlZFBvb2xzW21zZy5zZW5kZXJdKXsKICAgICAgcG9vbEV0aFNvbGQgPSBwb29sRXRoU29sZC5hZGQoYW1vdW50KTsKICAgIH0KCgogICAgZm9yd2FyZEZ1bmRzKGFtb3VudCk7CiAgICBQdXJjaGFzZShtc2cuc2VuZGVyLCBhbW91bnQsIHRva2Vucyk7CgogICAgaWYodG9rZW5DYXAuc3ViKHRva2Vuc1NvbGQpIDwgY2FsY3VsYXRlVG9rZW5BbW91bnQobWluaW11bVB1cmNoYXNlKSl7CiAgICAgIGZpbmFsaXplU2FsZSgpOwogICAgfQogIH0KCiAgLyoqCiAgICBAZGV2IEFsbG93cyBvd25lciB0byBhZGQgYWRkcmVzc2VzIHRvIHRoZSB3aGl0ZWxpc3RlZAogICAgQHBhcmFtIF9hZGRyZXNzIGFkZHJlc3MgVGhlIGFkZHJlc3MgdG8gYmUgYWRkZWQKICAgIEBwYXJhbSBpc1Bvb2wgYm9vbCBJbmRpY2F0aW5nIGlmIGFkZHJlc3MgcmVwcmVzZW50cyBhIGJ1eWluZyBwb29sCiAgKiovCiAgZnVuY3Rpb24gYWRkV2hpdGVsaXN0ZWQoYWRkcmVzcyBfYWRkcmVzcywgYm9vbCBpc1Bvb2wpCiAgICBwdWJsaWMKICAgIG9ubHlPd25lcgogICAgd2hlbk5vdFBhdXNlZAogIHsKICAgIGlmKGlzUG9vbCkgewogICAgICB3aGl0ZWxpc3RlZFBvb2xzW19hZGRyZXNzXSA9IHRydWU7CiAgICB9IGVsc2UgewogICAgICB3aGl0ZWxpc3RlZFtfYWRkcmVzc10gPSB0cnVlOwogICAgfQogIH0KCiAgLyoqCiAgICBAZGV2IGFsbG93cyB0aGUgb3duZXIgdG8gY2hhbmdlIHRoZSBtYXggZ2FzIHByaWNlCiAgICBAcGFyYW0gX2dhc1ByaWNlIHVpbnQyNTYgdGhlIG5ldyBtYXhpbXVtIGdhcyBwcmljZQogICoqLwogIGZ1bmN0aW9uIGNoYW5nZU1heEdhc3ByaWNlKHVpbnQyNTYgX2dhc1ByaWNlKQogICAgcHVibGljCiAgICBvbmx5T3duZXIKICAgIHdoZW5Ob3RQYXVzZWQKICB7CiAgICBtYXhHYXNQcmljZSA9IF9nYXNQcmljZTsKICB9CgogIC8qKgogICAgQGRldiBUcmlnZ2VycyB0aGUgZmluYWxpemF0aW9uIHByb2Nlc3MKICAqKi8KICBmdW5jdGlvbiBlbmRTYWxlKCkgd2hlbk5vdFBhdXNlZCBwdWJsaWMgewogICAgcmVxdWlyZShmaW5hbGl6ZWQgPT0gIGZhbHNlKTsKICAgIHJlcXVpcmUobm93ID4gZW5kVGltZSk7CiAgICBmaW5hbGl6ZVNhbGUoKTsKICB9CgogIC8qKgogICAgICBJTlRFUk5BTCBGVU5DVElPTlMKCiAgKiovCgogIC8qKgogICAgQGRldiBDaGVja3MgaWYgcHVyY2hhc2UgaXMgdmFsaWQKICAgIEByZXR1cm4gQm9vbCBJbmRpY2F0aW5nIGlmIHB1cmNoYXNlIGlzIHZhbGlkCiAgKiovCiAgZnVuY3Rpb24gaXNWYWxpZFB1cmNoYXNlKCkgdmlldyBpbnRlcm5hbCByZXR1cm5zKGJvb2wgdmFsaWQpIHsKICAgIHJlcXVpcmUobm93ID49IHN0YXJ0VGltZSAmJiBub3cgPD0gZW5kVGltZSk7CiAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSBtaW5pbXVtUHVyY2hhc2UpOwogICAgcmVxdWlyZSh0eC5nYXNwcmljZSA8PSBtYXhHYXNQcmljZSk7CiAgICB1aW50MjU2IHdlZWsgPSBnZXRDdXJyZW50V2VlaygpOwogICAgaWYod2VlayA9PSAwICYmIHdoaXRlbGlzdGVkUG9vbHNbbXNnLnNlbmRlcl0pewogICAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSBtaW5pbXVtUG9vbFB1cmNoYXNlKTsKICAgICAgcmVxdWlyZShjb250cmlidXRvcnNbbXNnLnNlbmRlcl0uYWRkKG1zZy52YWx1ZSkgPD0gbWF4aW11bVBvb2xQdXJjaGFzZSk7CiAgICB9IGVsc2UgewogICAgICByZXF1aXJlKHdoaXRlbGlzdGVkW21zZy5zZW5kZXJdIHx8IHdoaXRlbGlzdGVkUG9vbHNbbXNnLnNlbmRlcl0pOwogICAgICByZXF1aXJlKGNvbnRyaWJ1dG9yc1ttc2cuc2VuZGVyXS5hZGQobXNnLnZhbHVlKSA8PSBtYXhpbXVtUHVyY2hhc2UpOwogICAgfQogICAgcmV0dXJuIHRydWU7CiAgfQoKCgogIC8qKgogICAgQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0aGF0IHJlZGlyZWN0cyByZWNpZXZlZCBmdW5kcyB0byB3YWxsZXQKICAgIEBwYXJhbSBfYW1vdW50IHVpbnQyNTYgVGhlIGFtb3VudCB0byBiZSBmb3dhcmRlZAogICoqLwogIGZ1bmN0aW9uIGZvcndhcmRGdW5kcyh1aW50MjU2IF9hbW91bnQpIGludGVybmFsIHsKICAgIHdhbGxldC50cmFuc2ZlcihfYW1vdW50KTsKICB9CgogIC8qKgogICAgQGRldiBDYWxjdWxhdGVzIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYnV5ZXIgd2lsbCByZWNpZXZlCiAgICBAcGFyYW0gd2VpQW1vdW50IHVpbnQyNTYgVGhlIGFtb3VudCwgaW4gV2VpLCB0aGF0IHdpbGwgYmUgYm91Z2h0CiAgICBAcmV0dXJuIHVpbnQyNTYgUmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgd2VpQW1vdW50IGJ1eXMgaW4KICAgIHRoZSBjdXJyZW50IHN0YWdlIG9mIHRoZSBzYWxlCiAgKiovCiAgZnVuY3Rpb24gY2FsY3VsYXRlVG9rZW5BbW91bnQodWludDI1NiB3ZWlBbW91bnQpIHZpZXcgaW50ZXJuYWwgcmV0dXJucyh1aW50MjU2IHRva2VuQW1vdW50KXsKICAgIHVpbnQyNTYgd2VlayA9IGdldEN1cnJlbnRXZWVrKCk7CiAgICBpZih3ZWVrID09IDAgJiYgd2hpdGVsaXN0ZWRQb29sc1ttc2cuc2VuZGVyXSl7CiAgICAgIHJldHVybiB3ZWlBbW91bnQubXVsKDEwKioxOCkuZGl2KHNwZWNpYWxQb29sc1JhdGUpOwogICAgfQogICAgcmV0dXJuIHdlaUFtb3VudC5tdWwoMTAqKjE4KS5kaXYocmF0ZXNbd2Vla10pOwogIH0KCiAgLyoqCiAgICBAZGV2IENhbGN1bGF0ZXMgd2VpIGNvc3Qgb2Ygc3BlY2lmaWMgYW1vdW50IG9mIHRva2VucwogICAgQHBhcmFtIHRva2VuQW1vdW50IHVpbnQyNTYgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgY2FsY3VsYXRlZAogICAgQHJldHVybiB1aW50MjU2IFJlcHJlc2VudGluZyB0aGUgdG90YWwgY29zdCwgaW4gd2VpLCBmb3IgdG9rZW5BbW91bnQKICAqKi8KICBmdW5jdGlvbiBjYWxjdWxhdGVQcmljZUZvclRva2Vucyh1aW50MjU2IHRva2VuQW1vdW50KSB2aWV3IGludGVybmFsIHJldHVybnModWludDI1NiB3ZWlBbW91bnQpewogICAgdWludDI1NiB3ZWVrID0gZ2V0Q3VycmVudFdlZWsoKTsKICAgIHJldHVybiB0b2tlbkFtb3VudC5kaXYoMTAqKjE4KS5tdWwocmF0ZXNbd2Vla10pOwogIH0KCiAgLyoqCiAgICBAZGV2IENoZWNrcyB0aGUgY3VycmVudCB3ZWVrIGluIHRoZSBzYWxlLiBJdCdzIHplcm8gaW5kZXhlZCwgc28gdGhlIGZpcnN0CiAgICB3ZWVrIHJldHVybnMgMCwgdGhlIHNlbmNvbmQgMSwgYW5kIHNvIGZvcnRoLgogICAgQHJldHVybiBVaW50IHJlcHJlc2VudGluZyB0aGUgY3VycmVudCB3ZWVrCiAgKiovCiAgZnVuY3Rpb24gZ2V0Q3VycmVudFdlZWsoKSB2aWV3IGludGVybmFsIHJldHVybnModWludDI1NiBfd2Vlayl7CiAgICB1aW50MjU2IHdlZWsgPSAobm93LnN1YihzdGFydFRpbWUpKS5kaXYoMSB3ZWVrcyk7CiAgICBpZih3ZWVrID4gMyl7CiAgICAgIHdlZWsgPSAzOwogICAgfQogICAgcmV0dXJuIHdlZWs7CiAgfQoKICAvKioKICAgIEBkZXYgVHJpZ2dlcnMgdGhlIHNhbGUgZmluYWxpemF0aW9ucyBwcm9jZXNzCiAgKiovCiAgZnVuY3Rpb24gZmluYWxpemVTYWxlKCkgaW50ZXJuYWwgewogICAgdGF5bG9yVG9rZW4uYnVybih0YXlsb3JUb2tlbi5iYWxhbmNlT2YodGhpcykpOwogICAgZmluYWxpemVkID0gdHJ1ZTsKICAgIEZpbmFsaXplZCh0b2tlbnNTb2xkLCB3ZWlSYWlzZWQpOwogIH0KCiAgLyoqCiAgICAgIFJFQUQgT05MWSBGVU5DVElPTlMKCiAgKiovCgogIC8qKgogICAgQGRldiBHaXZlIHRoZSBjdXJyZW50IHJhdGUoaW4gV2VpKSB0aGF0IGJ1eXMgZXhhY3RseSBvbmUgdG9rZW4KICAqKi8KICBmdW5jdGlvbiBnZXRDdXJyZW50UmF0ZSgpIHZpZXcgcHVibGljIHJldHVybnModWludDI1NiBfcmF0ZSl7CiAgICByZXR1cm4gcmF0ZXNbZ2V0Q3VycmVudFdlZWsoKV07CiAgfQoKCn0='.
	

]
