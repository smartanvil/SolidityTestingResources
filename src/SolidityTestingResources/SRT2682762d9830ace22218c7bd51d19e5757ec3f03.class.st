Class {
	#name : #SRT2682762d9830ace22218c7bd51d19e5757ec3f03,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT2682762d9830ace22218c7bd51d19e5757ec3f03 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgovLy8gQHRpdGxlIHByb3ZpZGVzIHN1YmplY3QgdG8gcm9sZSBjaGVja2luZyBsb2dpYwpjb250cmFjdCBJQWNjZXNzUG9saWN5IHsKCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIFB1YmxpYyBmdW5jdGlvbnMKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8vLyBAbm90aWNlIFdlIGRvbid0IG1ha2UgdGhpcyBmdW5jdGlvbiBjb25zdGFudCB0byBhbGxvdyBmb3Igc3RhdGUtdXBkYXRpbmcgYWNjZXNzIGNvbnRyb2xzIHN1Y2ggYXMgcmF0ZSBsaW1pdGluZy4KICAgIC8vLyBAZGV2IGNoZWNrcyBpZiBzdWJqZWN0IGJlbG9uZ3MgdG8gcmVxdWVzdGVkIHJvbGUgZm9yIHBhcnRpY3VsYXIgb2JqZWN0CiAgICAvLy8gQHBhcmFtIHN1YmplY3QgYWRkcmVzcyB0byBiZSBjaGVja2VkIGFnYWluc3Qgcm9sZSwgdHlwaWNhbGx5IG1zZy5zZW5kZXIKICAgIC8vLyBAcGFyYW0gcm9sZSBpZGVudGlmaWVyIG9mIHJlcXVpcmVkIHJvbGUKICAgIC8vLyBAcGFyYW0gb2JqZWN0IGNvbnRyYWN0IGluc3RhbmNlIGNvbnRleHQgZm9yIHJvbGUgY2hlY2tpbmcsIHR5cGljYWxseSBjb250cmFjdCByZXF1ZXN0aW5nIHRoZSBjaGVjawogICAgLy8vIEBwYXJhbSB2ZXJiIGFkZGl0aW9uYWwgZGF0YSwgaW4gY3VycmVudCBBY2Nlc3NDb250cm9sbCBpbXBsZW1lbnRhdGlvbiBtc2cuc2lnCiAgICAvLy8gQHJldHVybiBpZiBzdWJqZWN0IGJlbG9uZ3MgdG8gYSByb2xlCiAgICBmdW5jdGlvbiBhbGxvd2VkKAogICAgICAgIGFkZHJlc3Mgc3ViamVjdCwKICAgICAgICBieXRlczMyIHJvbGUsCiAgICAgICAgYWRkcmVzcyBvYmplY3QsCiAgICAgICAgYnl0ZXM0IHZlcmIKICAgICkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zIChib29sKTsKfQoKLy8vIEB0aXRsZSBlbmFibGVzIGFjY2VzcyBjb250cm9sIGluIGltcGxlbWVudGluZyBjb250cmFjdAovLy8gQGRldiBzZWUgQWNjZXNzQ29udHJvbGxlZCBmb3IgaW1wbGVtZW50YXRpb24KY29udHJhY3QgSUFjY2Vzc0NvbnRyb2xsZWQgewoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gRXZlbnRzCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvLy8gQGRldiBtdXN0IGxvZyBvbiBhY2Nlc3MgcG9saWN5IGNoYW5nZQogICAgZXZlbnQgTG9nQWNjZXNzUG9saWN5Q2hhbmdlZCgKICAgICAgICBhZGRyZXNzIGNvbnRyb2xsZXIsCiAgICAgICAgSUFjY2Vzc1BvbGljeSBvbGRQb2xpY3ksCiAgICAgICAgSUFjY2Vzc1BvbGljeSBuZXdQb2xpY3kKICAgICk7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBQdWJsaWMgZnVuY3Rpb25zCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvLy8gQGRldiBhbGxvd3MgdG8gY2hhbmdlIGFjY2VzcyBjb250cm9sIG1lY2hhbmlzbSBmb3IgdGhpcyBjb250cmFjdAogICAgLy8vICAgICB0aGlzIG1ldGhvZCBtdXN0IGJlIGl0c2VsZiBhY2Nlc3MgY29udHJvbGxlZCwgc2VlIEFjY2Vzc0NvbnRyb2xsZWQgaW1wbGVtZW50YXRpb24gYW5kIG5vdGljZSBiZWxvdwogICAgLy8vIEBub3RpY2UgaXQgaXMgYSBodWdlIGlzc3VlIGZvciBTb2xpZGl0eSB0aGF0IG1vZGlmaWVycyBhcmUgbm90IHBhcnQgb2YgZnVuY3Rpb24gc2lnbmF0dXJlCiAgICAvLy8gICAgIHRoZW4gaW50ZXJmYWNlcyBjb3VsZCBiZSB1c2VkIGZvciBleGFtcGxlIHRvIGNvbnRyb2wgYWNjZXNzIHNlbWFudGljcwogICAgLy8vIEBwYXJhbSBuZXdQb2xpY3kgbmV3IGFjY2VzcyBwb2xpY3kgdG8gY29udHJvbGwgdGhpcyBjb250cmFjdAogICAgLy8vIEBwYXJhbSBuZXdBY2Nlc3NDb250cm9sbGVyIGFkZHJlc3Mgb2YgUk9MRV9BQ0NFU1NfQ09OVFJPTExFUiBvZiBuZXcgcG9saWN5IHRoYXQgY2FuIHNldCBhY2Nlc3MgdG8gdGhpcyBjb250cmFjdAogICAgZnVuY3Rpb24gc2V0QWNjZXNzUG9saWN5KElBY2Nlc3NQb2xpY3kgbmV3UG9saWN5LCBhZGRyZXNzIG5ld0FjY2Vzc0NvbnRyb2xsZXIpCiAgICAgICAgcHVibGljOwoKICAgIGZ1bmN0aW9uIGFjY2Vzc1BvbGljeSgpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChJQWNjZXNzUG9saWN5KTsKCn0KCmNvbnRyYWN0IFN0YW5kYXJkUm9sZXMgewoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gQ29uc3RhbnRzCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvLyBAbm90aWNlIFNvbGRpdHkgc29tZWhvdyBkb2Vzbid0IGV2YWx1YXRlIHRoaXMgY29tcGlsZSB0aW1lCiAgICAvLyBAZGV2IHJvbGUgd2hpY2ggaGFzIHJpZ2h0cyB0byBjaGFuZ2UgcGVybWlzc2lvbnMgYW5kIHNldCBuZXcgcG9saWN5IGluIGNvbnRyYWN0LCBrZWNjYWsyNTYoIkFjY2Vzc0NvbnRyb2xsZXIiKQogICAgYnl0ZXMzMiBpbnRlcm5hbCBjb25zdGFudCBST0xFX0FDQ0VTU19DT05UUk9MTEVSID0gMHhhYzQyZjhiZWIxNzk3NWVkMDYyZGNiODBjNjNlNmQyMDNlZjFjMmMzMzVjZWQxNDlkYzU2NjRjYzY3MWNiN2RhOwp9CgovLy8gQHRpdGxlIEdyYW51bGFyIGNvZGUgZXhlY3V0aW9uIHBlcm1pc3Npb25zCi8vLyBAbm90aWNlIEludGVuZGVkIHRvIHJlcGxhY2UgZXhpc3RpbmcgT3duYWJsZSBwYXR0ZXJuIHdpdGggbW9yZSBncmFudWxhciBwZXJtaXNzaW9ucyBzZXQgdG8gZXhlY3V0ZSBzbWFydCBjb250cmFjdCBmdW5jdGlvbnMKLy8vICAgICBmb3IgZWFjaCBmdW5jdGlvbiB3aGVyZSAnb25seScgbW9kaWZpZXIgaXMgYXBwbGllZCwgSUFjY2Vzc1BvbGljeSBpbXBsZW1lbnRhdGlvbiBpcyBjYWxsZWQgdG8gZXZhbHVhdGUgaWYgbXNnLnNlbmRlciBiZWxvbmdzIHRvIHJlcXVpcmVkIHJvbGUgZm9yIGNvbnRyYWN0IGJlaW5nIGNhbGxlZC4KLy8vICAgICBBY2Nlc3MgZXZhbHVhdGlvbiBzcGVjaWZpYyBiZWxvbmcgdG8gSUFjY2Vzc1BvbGljeSBpbXBsZW1lbnRhdGlvbiwgc2VlIFJvbGVCYXNlZEFjY2Vzc1BvbGljeSBmb3IgZGV0YWlscy4KLy8vIEBkZXYgU2hvdWxkIGJlIGluaGVyaXRlZCBieSBhIGNvbnRyYWN0IHJlcXVpcmluZyBzdWNoIHBlcm1pc3Npb25zIGNvbnRyb2xsLiBJQWNjZXNzUG9saWN5IG11c3QgYmUgcHJvdmlkZWQgaW4gY29uc3RydWN0b3IuIEFjY2VzcyBwb2xpY3kgbWF5IGJlIHJlcGxhY2VkIHRvIGEgZGlmZmVyZW50IG9uZQovLy8gICAgIGJ5IG1zZy5zZW5kZXIgd2l0aCBST0xFX0FDQ0VTU19DT05UUk9MTEVSIHJvbGUKY29udHJhY3QgQWNjZXNzQ29udHJvbGxlZCBpcyBJQWNjZXNzQ29udHJvbGxlZCwgU3RhbmRhcmRSb2xlcyB7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBNdXRhYmxlIHN0YXRlCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICBJQWNjZXNzUG9saWN5IHByaXZhdGUgX2FjY2Vzc1BvbGljeTsKCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIE1vZGlmaWVycwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgLy8vIEBkZXYgbGltaXRzIGZ1bmN0aW9uIGV4ZWN1dGlvbiBvbmx5IHRvIHNlbmRlcnMgYXNzaWduZWQgdG8gcmVxdWlyZWQgJ3JvbGUnCiAgICBtb2RpZmllciBvbmx5KGJ5dGVzMzIgcm9sZSkgewogICAgICAgIHJlcXVpcmUoX2FjY2Vzc1BvbGljeS5hbGxvd2VkKG1zZy5zZW5kZXIsIHJvbGUsIHRoaXMsIG1zZy5zaWcpKTsKICAgICAgICBfOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gQ29uc3RydWN0b3IKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIGZ1bmN0aW9uIEFjY2Vzc0NvbnRyb2xsZWQoSUFjY2Vzc1BvbGljeSBwb2xpY3kpIGludGVybmFsIHsKICAgICAgICByZXF1aXJlKGFkZHJlc3MocG9saWN5KSAhPSAweDApOwogICAgICAgIF9hY2Nlc3NQb2xpY3kgPSBwb2xpY3k7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBQdWJsaWMgZnVuY3Rpb25zCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvLwogICAgLy8gSW1wbGVtZW50cyBJQWNjZXNzQ29udHJvbGxlZAogICAgLy8KCiAgICBmdW5jdGlvbiBzZXRBY2Nlc3NQb2xpY3koSUFjY2Vzc1BvbGljeSBuZXdQb2xpY3ksIGFkZHJlc3MgbmV3QWNjZXNzQ29udHJvbGxlcikKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5KFJPTEVfQUNDRVNTX0NPTlRST0xMRVIpCiAgICB7CiAgICAgICAgLy8gUk9MRV9BQ0NFU1NfQ09OVFJPTExFUiBtdXN0IGJlIHByZXNlbnQKICAgICAgICAvLyB1bmRlciB0aGUgbmV3IHBvbGljeS4gVGhpcyBwcm92aWRlcyBzb21lCiAgICAgICAgLy8gcHJvdGVjdGlvbiBhZ2FpbnN0IGxvY2tpbmcgeW91cnNlbGYgb3V0LgogICAgICAgIHJlcXVpcmUobmV3UG9saWN5LmFsbG93ZWQobmV3QWNjZXNzQ29udHJvbGxlciwgUk9MRV9BQ0NFU1NfQ09OVFJPTExFUiwgdGhpcywgbXNnLnNpZykpOwoKICAgICAgICAvLyBXZSBjYW4gbm93IHNhZmVseSBzZXQgdGhlIG5ldyBwb2xpY3kgd2l0aG91dCBmb290IHNob290aW5nLgogICAgICAgIElBY2Nlc3NQb2xpY3kgb2xkUG9saWN5ID0gX2FjY2Vzc1BvbGljeTsKICAgICAgICBfYWNjZXNzUG9saWN5ID0gbmV3UG9saWN5OwoKICAgICAgICAvLyBMb2cgZXZlbnQKICAgICAgICBMb2dBY2Nlc3NQb2xpY3lDaGFuZ2VkKG1zZy5zZW5kZXIsIG9sZFBvbGljeSwgbmV3UG9saWN5KTsKICAgIH0KCiAgICBmdW5jdGlvbiBhY2Nlc3NQb2xpY3koKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoSUFjY2Vzc1BvbGljeSkKICAgIHsKICAgICAgICByZXR1cm4gX2FjY2Vzc1BvbGljeTsKICAgIH0KfQoKLy8vIEBub3RpY2UgaW1wbGVtZW50ZWQgaW4gdGhlIGNvbnRyYWN0IHRoYXQgaXMgdGhlIHRhcmdldCBvZiBzdGF0ZSBtaWdyYXRpb24KLy8vIEBkZXYgaW1wbGVtZW50YXRpb24gbXVzdCBwcm92aWRlIGFjdHVhbCBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkIGJ5IHNvdXJjZSB0byBtaWdyYXRlIHN0YXRlCmNvbnRyYWN0IElNaWdyYXRpb25UYXJnZXQgewoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gUHVibGljIGZ1bmN0aW9ucwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgLy8gc2hvdWxkIHJldHVybiBtaWdyYXRpb24gc291cmNlIGFkZHJlc3MKICAgIGZ1bmN0aW9uIGN1cnJlbnRNaWdyYXRpb25Tb3VyY2UoKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoYWRkcmVzcyk7Cn0KCi8vLyBAbm90aWNlIG1peGluIHRoYXQgZW5hYmxlcyBjb250cmFjdCB0byByZWNlaXZlIG1pZ3JhdGlvbgovLy8gQGRldiB3aGVuIGRlcml2ZWQgZnJvbQpjb250cmFjdCBNaWdyYXRpb25UYXJnZXQgaXMKICAgIElNaWdyYXRpb25UYXJnZXQKewogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBNb2RpZmllcnMKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8vIGludGVuZGVkIHRvIGJlIGFwcGxpZWQgb24gbWlncmF0aW9uIHJlY2VpdmluZyBmdW5jdGlvbgogICAgbW9kaWZpZXIgb25seU1pZ3JhdGlvblNvdXJjZSgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY3VycmVudE1pZ3JhdGlvblNvdXJjZSgpKTsKICAgICAgICBfOwogICAgfQp9Cgpjb250cmFjdCBFdXJvVG9rZW5NaWdyYXRpb25UYXJnZXQgaXMKICAgIE1pZ3JhdGlvblRhcmdldAp7CiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIFB1YmxpYyBmdW5jdGlvbnMKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8vLyBAbm90aWNlIGFjY2VwdHMgbWlncmF0aW9uIG9mIHNpbmdsZSBldXItdCB0b2tlbiBob2xkZXIKICAgIC8vLyBAZGV2IGFsbG93ZWQgdG8gYmUgY2FsbGVkIG9ubHkgZnJvbSBtaWdyYXRpb24gc291cmNlLCBkbyBub3QgZm9yZ2V0IHRvIGFkZCBhY2Nlc3NvciBtb2RpZmllciBpbiBpbXBsZW1lbnRhdGlvbgogICAgZnVuY3Rpb24gbWlncmF0ZUV1cm9Ub2tlbk93bmVyKGFkZHJlc3Mgb3duZXIsIHVpbnQyNTYgYW1vdW50KQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlNaWdyYXRpb25Tb3VyY2UoKTsKfQoKLy8vIEBub3RpY2UgaW1wbGVtZW50ZWQgaW4gdGhlIGNvbnRyYWN0IHRoYXQgc3RvcmVzIHN0YXRlIHRvIGJlIG1pZ3JhdGVkCi8vLyBAbm90aWNlIGNvbnRyYWN0IGlzIGNhbGxlZCBtaWdyYXRpb24gc291cmNlCi8vLyBAZGV2IG1pZ3JhdGlvbiB0YXJnZXQgaW1wbGVtZW50cyBJTWlncmF0aW9uVGFyZ2V0IGludGVyZmFjZSwgd2hlbiBpdCBpcyBwYXNzZWQgaW4gJ2VuYWJsZU1pZ3JhdGlvbicgZnVuY3Rpb24KLy8vIEBkZXYgJ21pZ3JhdGUnIGZ1bmN0aW9uIG1heSBiZSBjYWxsZWQgdG8gbWlncmF0ZSBwYXJ0IG9mIHN0YXRlIG93bmVkIGJ5IG1zZy5zZW5kZXIKLy8vIEBkZXYgaW4gbGVnYWwgdGVybXMgdGhpcyBjb3JyZXNwb25kcyB0byBhbWVuZGluZy9jaGFuZ2luZyBhZ3JlZW1lbnQgdGVybXMgYnkgY28tc2lnbmF0dXJlIG9mIHBhcnRpZXMKY29udHJhY3QgSU1pZ3JhdGlvblNvdXJjZSB7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBFdmVudHMKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIGV2ZW50IExvZ01pZ3JhdGlvbkVuYWJsZWQoCiAgICAgICAgYWRkcmVzcyB0YXJnZXQKICAgICk7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBQdWJsaWMgZnVuY3Rpb25zCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvLy8gQG5vdGljZSBzaG91bGQgbWlncmF0ZSBzdGF0ZSBvd25lZCBieSBtc2cuc2VuZGVyCiAgICAvLy8gQGRldiBpbnRlbmRlZCBmbG93IGlzIHRvOiByZWFkIHNvdXJjZSBzdGF0ZSwgY2xlYXIgc291cmNlIHN0YXRlLCBjYWxsIG1pZ3JhdGUgZnVuY3Rpb24gb24gdGFyZ2V0LCBsb2cgc3VjY2VzcyBldmVudAogICAgZnVuY3Rpb24gbWlncmF0ZSgpCiAgICAgICAgcHVibGljOwoKICAgIC8vLyBAbm90aWNlIHNob3VsZCBlbmFibGUgbWlncmF0aW9uIHRvIG1pZ3JhdGlvbiB0YXJnZXQKICAgIC8vLyBAZGV2IHNob3VsZCBsaW1pdCBhY2Nlc3MgdG8gc3BlY2lmaWMgcm9sZSBpbiBpbXBsZW1lbnRhdGlvbgogICAgZnVuY3Rpb24gZW5hYmxlTWlncmF0aW9uKElNaWdyYXRpb25UYXJnZXQgbWlncmF0aW9uKQogICAgICAgIHB1YmxpYzsKCiAgICAvLy8gQG5vdGljZSByZXR1cm5zIGN1cnJlbnQgbWlncmF0aW9uIHRhcmdldAogICAgZnVuY3Rpb24gY3VycmVudE1pZ3JhdGlvblRhcmdldCgpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChJTWlncmF0aW9uVGFyZ2V0KTsKfQoKLy8vIEBub3RpY2UgbWl4aW4gdGhhdCBlbmFibGVzIG1pZ3JhdGlvbiBwYXR0ZXJuIGZvciBhIGNvbnRyYWN0Ci8vLyBAZGV2IHdoZW4gZGVyaXZlZCBmcm9tCmNvbnRyYWN0IE1pZ3JhdGlvblNvdXJjZSBpcwogICAgSU1pZ3JhdGlvblNvdXJjZSwKICAgIEFjY2Vzc0NvbnRyb2xsZWQKewogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBJbW11dGFibGUgc3RhdGUKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8vLyBzdG9yZXMgcm9sZSBoYXNoIHRoYXQgY2FuIGVuYWJsZSBtaWdyYXRpb24KICAgIGJ5dGVzMzIgcHJpdmF0ZSBNSUdSQVRJT05fQURNSU47CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBNdXRhYmxlIHN0YXRlCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvLyBtaWdyYXRpb24gdGFyZ2V0IGNvbnRyYWN0CiAgICBJTWlncmF0aW9uVGFyZ2V0IGludGVybmFsIF9taWdyYXRpb247CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBNb2RpZmllcnMKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8vLyBAbm90aWNlIGFkZCB0byBlbmFibGVNaWdyYXRpb24gZnVuY3Rpb24gdG8gcHJldmVudCBjaGFuZ2luZyBvZiBtaWdyYXRpb24KICAgIC8vLyAgICAgdGFyZ2V0IG9uY2Ugc2V0CiAgICBtb2RpZmllciBvbmx5TWlncmF0aW9uRW5hYmxlZE9uY2UoKSB7CiAgICAgICAgcmVxdWlyZShhZGRyZXNzKF9taWdyYXRpb24pID09IDApOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seU1pZ3JhdGlvbkVuYWJsZWQoKSB7CiAgICAgICAgcmVxdWlyZShhZGRyZXNzKF9taWdyYXRpb24pICE9IDApOwogICAgICAgIF87CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDb25zdHJ1Y3RvcgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgZnVuY3Rpb24gTWlncmF0aW9uU291cmNlKAogICAgICAgIElBY2Nlc3NQb2xpY3kgcG9saWN5LAogICAgICAgIGJ5dGVzMzIgbWlncmF0aW9uQWRtaW5Sb2xlCiAgICApCiAgICAgICAgQWNjZXNzQ29udHJvbGxlZChwb2xpY3kpCiAgICAgICAgaW50ZXJuYWwKICAgIHsKICAgICAgICBNSUdSQVRJT05fQURNSU4gPSBtaWdyYXRpb25BZG1pblJvbGU7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBQdWJsaWMgZnVuY3Rpb25zCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvLy8gQG5vdGljZSBzaG91bGQgbWlncmF0ZSBzdGF0ZSB0aGF0IGJlbG9uZ3MgdG8gbXNnLnNlbmRlcgogICAgLy8vIEBkZXYgZG8gbm90IGZvcmdldCB0byBhZGQgYWNjZXNzb3IgbW9kaWZpZXIgaW4gaW1wbGVtZW50YXRpb24KICAgIGZ1bmN0aW9uIG1pZ3JhdGUoKQogICAgICAgIG9ubHlNaWdyYXRpb25FbmFibGVkKCkKICAgICAgICBwdWJsaWM7CgogICAgLy8vIEBub3RpY2Ugc2hvdWxkIGVuYWJsZSBtaWdyYXRpb24gdG8gbWlncmF0aW9uIHRhcmdldAogICAgLy8vIEBkZXYgZG8gbm90IGZvcmdldCB0byBhZGQgYWNjZXNzb3IgbW9kaWZpZXIgaW4gb3ZlcnJpZGUKICAgIGZ1bmN0aW9uIGVuYWJsZU1pZ3JhdGlvbihJTWlncmF0aW9uVGFyZ2V0IG1pZ3JhdGlvbikKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5TWlncmF0aW9uRW5hYmxlZE9uY2UoKQogICAgICAgIG9ubHkoTUlHUkFUSU9OX0FETUlOKQogICAgewogICAgICAgIC8vIHRoaXMgbXVzdCBiZSB0aGUgc291cmNlCiAgICAgICAgcmVxdWlyZShtaWdyYXRpb24uY3VycmVudE1pZ3JhdGlvblNvdXJjZSgpID09IGFkZHJlc3ModGhpcykpOwogICAgICAgIF9taWdyYXRpb24gPSBtaWdyYXRpb247CiAgICAgICAgTG9nTWlncmF0aW9uRW5hYmxlZChfbWlncmF0aW9uKTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSByZXR1cm5zIGN1cnJlbnQgbWlncmF0aW9uIHRhcmdldAogICAgZnVuY3Rpb24gY3VycmVudE1pZ3JhdGlvblRhcmdldCgpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChJTWlncmF0aW9uVGFyZ2V0KQogICAgewogICAgICAgIHJldHVybiBfbWlncmF0aW9uOwogICAgfQp9Cgpjb250cmFjdCBBY2Nlc3NSb2xlcyB7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDb25zdGFudHMKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8vIE5PVEU6IEFsbCByb2xlcyBhcmUgc2V0IHRvIHRoZSBrZWNjYWsyNTYgaGFzaCBvZiB0aGUKICAgIC8vIENhbWVsQ2FzZWQgcm9sZSBuYW1lLCBpLmUuCiAgICAvLyBST0xFX0xPQ0tFRF9BQ0NPVU5UX0FETUlOID0ga2VjY2FrMjU2KCJMb2NrZWRBY2NvdW50QWRtaW4iKQoKICAgIC8vIG1heSBzZXR1cCBMb2NrZWRBY2NvdW50LCBjaGFuZ2UgZGlzYnVyc2FsIG1lY2hhbmlzbSBhbmQgc2V0IG1pZ3JhdGlvbgogICAgYnl0ZXMzMiBpbnRlcm5hbCBjb25zdGFudCBST0xFX0xPQ0tFRF9BQ0NPVU5UX0FETUlOID0gMHg0Njc1ZGE1NDZkMmQ5MmM1Yjg2YzRmNzI2YTllNjEwMTBkY2U5MWNjY2MyNDkxY2U2MDE5ZTc4YjA5ZDI1NzJlOwoKICAgIC8vIG1heSBzZXR1cCB3aGl0ZWxpc3RzIGFuZCBhYm9ydCB3aGl0ZWxpc3RpbmcgY29udHJhY3Qgd2l0aCBjdXJ2ZSByb2xsYmFjawogICAgYnl0ZXMzMiBpbnRlcm5hbCBjb25zdGFudCBST0xFX1dISVRFTElTVF9BRE1JTiA9IDB4YWVmNDU2ZTdjODY0NDE4ZTFkMmE0MGQ5OTZjYTRmZWJmM2E3ZTMxN2ZlM2FmNWE3ZWE0ZGRhNTkwMzNiYmU1YzsKCiAgICAvLyBNYXkgaXNzdWUgKGdlbmVyYXRlKSBOZXVtYXJrcwogICAgYnl0ZXMzMiBpbnRlcm5hbCBjb25zdGFudCBST0xFX05FVU1BUktfSVNTVUVSID0gMHg5MjFjM2FmYTFmMWZmZjcwN2E3ODVmOTUzYTFlMTk3YmQyOGM5YzUwZTMwMDQyNGUwMTU5NTNjYmYxMjBjMDZjOwoKICAgIC8vIE1heSBidXJuIE5ldW1hcmtzIGl0IG93bnMKICAgIGJ5dGVzMzIgaW50ZXJuYWwgY29uc3RhbnQgUk9MRV9ORVVNQVJLX0JVUk5FUiA9IDB4MTljZTMzMTI4NWY0MTczOWNkMzM2MmEzZWMxNzZlZGZmZTAxNDMxMWMwZjgwNzU4MzRmZGQxOWQ2NzE4ZTY5ZjsKCiAgICAvLyBNYXkgY3JlYXRlIG5ldyBzbmFwc2hvdHMgb24gTmV1bWFyawogICAgYnl0ZXMzMiBpbnRlcm5hbCBjb25zdGFudCBST0xFX1NOQVBTSE9UX0NSRUFUT1IgPSAweDA4YzE3ODVhZmM1N2Y5MzM1MjNiYzUyNTgzYTcyY2U5ZTE5YjIyNDEzNTRlMDRkZDg2ZjQxZjg4N2UzZDgxNzQ7CgogICAgLy8gTWF5IGVuYWJsZS9kaXNhYmxlIHRyYW5zZmVycyBvbiBOZXVtYXJrCiAgICBieXRlczMyIGludGVybmFsIGNvbnN0YW50IFJPTEVfVFJBTlNGRVJfQURNSU4gPSAweGI2NTI3ZTk0NGNhY2EzZDE1MWIxZjk0ZTQ5YWM1ZTIyMzE0MjY5NDg2MDc0M2U2NjE2NDcyMGUwMzRlYzliMTk7CgogICAgLy8gbWF5IHJlY2xhaW0gdG9rZW5zL2V0aGVyIGZyb20gY29udHJhY3RzIHN1cHBvcnRpbmcgSVJlY2xhaW1hYmxlIGludGVyZmFjZQogICAgYnl0ZXMzMiBpbnRlcm5hbCBjb25zdGFudCBST0xFX1JFQ0xBSU1FUiA9IDB4MDU0MmJiZDBjNjcyNTc4OTY2ZGNjNTI1YjMwYWExNjcyM2JiMDQyNjc1NTU0YWM1YjAzNjJmODZiNmU5N2RjNTsKCiAgICAvLyByZXByZXNlbnRzIGxlZ2FsbHkgcGxhdGZvcm0gb3BlcmF0b3IgaW4gY2FzZSBvZiBmb3JrcyBhbmQgY29udHJhY3RzIHdpdGggbGVnYWwgYWdyZWVtZW50IGF0dGFjaGVkLiBrZWNjYWsyNTYoIlBsYXRmb3JtT3BlcmF0b3JSZXByZXNlbnRhdGl2ZSIpCiAgICBieXRlczMyIGludGVybmFsIGNvbnN0YW50IFJPTEVfUExBVEZPUk1fT1BFUkFUT1JfUkVQUkVTRU5UQVRJVkUgPSAweGIyYjMyMTM3NzY1M2Y2NTUyMDZmNzE1MTRmZjlmMTUwZDA4MjJkMDYyYTVhYmNmMjIwZDU0OWUxZGE3OTk5ZjA7CgogICAgLy8gYWxsb3dzIHRvIGRlcG9zaXQgRVVSLVQgYW5kIGFsbG93IGFkZHJlc3NlcyB0byBzZW5kIGFuZCByZWNlaXZlIEVVUi1ULiBrZWNjYWsyNTYoIkV1cnREZXBvc2l0TWFuYWdlciIpCiAgICBieXRlczMyIGludGVybmFsIGNvbnN0YW50IFJPTEVfRVVSVF9ERVBPU0lUX01BTkFHRVIgPSAweDdjOGVjZGNiYTgwY2U4Nzg0OGQxNmFkNzdlZjU3Y2MxOTZjMjA4ZmM5NWM1NjM4ZTRhNDhjNjgxYTM0ZDRmZTc7Cn0KCmNvbnRyYWN0IElCYXNpY1Rva2VuIHsKCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIEV2ZW50cwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgZXZlbnQgVHJhbnNmZXIoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIGZyb20sCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIHRvLAogICAgICAgIHVpbnQyNTYgYW1vdW50KTsKCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIFB1YmxpYyBmdW5jdGlvbnMKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8vLyBAZGV2IFRoaXMgZnVuY3Rpb24gbWFrZXMgaXQgZWFzeSB0byBnZXQgdGhlIHRvdGFsIG51bWJlciBvZiB0b2tlbnMKICAgIC8vLyBAcmV0dXJuIFRoZSB0b3RhbCBudW1iZXIgb2YgdG9rZW5zCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50MjU2KTsKCiAgICAvLy8gQHBhcmFtIG93bmVyIFRoZSBhZGRyZXNzIHRoYXQncyBiYWxhbmNlIGlzIGJlaW5nIHJlcXVlc3RlZAogICAgLy8vIEByZXR1cm4gVGhlIGJhbGFuY2Ugb2YgYG93bmVyYCBhdCB0aGUgY3VycmVudCBibG9jawogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgb3duZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwoKICAgIC8vLyBAbm90aWNlIFNlbmQgYGFtb3VudGAgdG9rZW5zIHRvIGB0b2AgZnJvbSBgbXNnLnNlbmRlcmAKICAgIC8vLyBAcGFyYW0gdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudAogICAgLy8vIEBwYXJhbSBhbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIHRyYW5zZmVyIHdhcyBzdWNjZXNzZnVsIG9yIG5vdAogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiBhbW91bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCn0KCi8vLyBAdGl0bGUgYWxsb3dzIGRlcml2aW5nIGNvbnRyYWN0IHRvIHJlY292ZXIgYW55IHRva2VuIG9yIGV0aGVyIHRoYXQgaXQgaGFzIGJhbGFuY2Ugb2YKLy8vIEBub3RpY2Ugbm90ZSB0aGF0IHRoaXMgb3BlbnMgeW91ciBjb250cmFjdHMgdG8gY2xhaW1zIGZyb20gdmFyaW91cyBwZW9wbGUgc2F5aW5nIHRoZXkgbG9zdCB0b2tlbnMgYW5kIHRoZXkgd2FudCB0aGVtIGJhY2sKLy8vICAgICBiZSByZWFkeSB0byBoYW5kbGUgc3VjaCBjbGFpbXMKLy8vIEBkZXYgdXNlIHdpdGggY2FyZSEKLy8vICAgICAxLiBST0xFX1JFQ0xBSU1FUiBpcyBhbGxvd2VkIHRvIGNsYWltIHRva2VucywgaXQncyBub3QgcmV0dXJuaW5nIHRva2VucyB0byBvcmlnaW5hbCBvd25lcgovLy8gICAgIDIuIGluIGRlcml2ZWQgY29udHJhY3QgdGhhdCBob2xkcyBhbnkgdG9rZW4gYnkgZGVzaWduIHlvdSBtdXN0IG92ZXJyaWRlIGByZWNsYWltYCBhbmQgYmxvY2sgc3VjaCBwb3NzaWJpbGl0eS4KLy8vICAgICAgICAgc2VlIExvY2tlZEFjY291bnQgYXMgYW4gZXhhbXBsZQpjb250cmFjdCBSZWNsYWltYWJsZSBpcyBBY2Nlc3NDb250cm9sbGVkLCBBY2Nlc3NSb2xlcyB7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDb25zdGFudHMKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIElCYXNpY1Rva2VuIGNvbnN0YW50IGludGVybmFsIFJFQ0xBSU1fRVRIRVIgPSBJQmFzaWNUb2tlbigweDApOwoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gUHVibGljIGZ1bmN0aW9ucwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgZnVuY3Rpb24gcmVjbGFpbShJQmFzaWNUb2tlbiB0b2tlbikKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5KFJPTEVfUkVDTEFJTUVSKQogICAgewogICAgICAgIGFkZHJlc3MgcmVjbGFpbWVyID0gbXNnLnNlbmRlcjsKICAgICAgICBpZih0b2tlbiA9PSBSRUNMQUlNX0VUSEVSKSB7CiAgICAgICAgICAgIHJlY2xhaW1lci50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHVpbnQyNTYgYmFsYW5jZSA9IHRva2VuLmJhbGFuY2VPZih0aGlzKTsKICAgICAgICAgICAgcmVxdWlyZSh0b2tlbi50cmFuc2ZlcihyZWNsYWltZXIsIGJhbGFuY2UpKTsKICAgICAgICB9CiAgICB9Cn0KCmNvbnRyYWN0IElUb2tlbk1ldGFkYXRhIHsKCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIFB1YmxpYyBmdW5jdGlvbnMKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIGZ1bmN0aW9uIHN5bWJvbCgpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChzdHJpbmcpOwoKICAgIGZ1bmN0aW9uIG5hbWUoKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoc3RyaW5nKTsKCiAgICBmdW5jdGlvbiBkZWNpbWFscygpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50OCk7Cn0KCi8vLyBAdGl0bGUgYWRkcyB0b2tlbiBtZXRhZGF0YSB0byB0b2tlbiBjb250cmFjdAovLy8gQGRldiBzZWUgTmV1bWFyayBmb3IgZXhhbXBsZSBpbXBsZW1lbnRhdGlvbgpjb250cmFjdCBUb2tlbk1ldGFkYXRhIGlzIElUb2tlbk1ldGFkYXRhIHsKCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIEltbXV0YWJsZSBzdGF0ZQogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgLy8gVGhlIFRva2VuJ3MgbmFtZTogZS5nLiBEaWdpeERBTyBUb2tlbnMKICAgIHN0cmluZyBwcml2YXRlIE5BTUU7CgogICAgLy8gQW4gaWRlbnRpZmllcjogZS5nLiBSRVAKICAgIHN0cmluZyBwcml2YXRlIFNZTUJPTDsKCiAgICAvLyBOdW1iZXIgb2YgZGVjaW1hbHMgb2YgdGhlIHNtYWxsZXN0IHVuaXQKICAgIHVpbnQ4IHByaXZhdGUgREVDSU1BTFM7CgogICAgLy8gQW4gYXJiaXRyYXJ5IHZlcnNpb25pbmcgc2NoZW1lCiAgICBzdHJpbmcgcHJpdmF0ZSBWRVJTSU9OOwoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gQ29uc3RydWN0b3IKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8vLyBAbm90aWNlIENvbnN0cnVjdG9yIHRvIHNldCBtZXRhZGF0YQogICAgLy8vIEBwYXJhbSB0b2tlbk5hbWUgTmFtZSBvZiB0aGUgbmV3IHRva2VuCiAgICAvLy8gQHBhcmFtIGRlY2ltYWxVbml0cyBOdW1iZXIgb2YgZGVjaW1hbHMgb2YgdGhlIG5ldyB0b2tlbgogICAgLy8vIEBwYXJhbSB0b2tlblN5bWJvbCBUb2tlbiBTeW1ib2wgZm9yIHRoZSBuZXcgdG9rZW4KICAgIC8vLyBAcGFyYW0gdmVyc2lvbiBUb2tlbiB2ZXJzaW9uIGllLiB3aGVuIGNsb25pbmcgaXMgdXNlZAogICAgZnVuY3Rpb24gVG9rZW5NZXRhZGF0YSgKICAgICAgICBzdHJpbmcgdG9rZW5OYW1lLAogICAgICAgIHVpbnQ4IGRlY2ltYWxVbml0cywKICAgICAgICBzdHJpbmcgdG9rZW5TeW1ib2wsCiAgICAgICAgc3RyaW5nIHZlcnNpb24KICAgICkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICBOQU1FID0gdG9rZW5OYW1lOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgbmFtZQogICAgICAgIFNZTUJPTCA9IHRva2VuU3ltYm9sOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSBzeW1ib2wKICAgICAgICBERUNJTUFMUyA9IGRlY2ltYWxVbml0czsgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgZGVjaW1hbHMKICAgICAgICBWRVJTSU9OID0gdmVyc2lvbjsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIFB1YmxpYyBmdW5jdGlvbnMKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIGZ1bmN0aW9uIG5hbWUoKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoc3RyaW5nKQogICAgewogICAgICAgIHJldHVybiBOQU1FOwogICAgfQoKICAgIGZ1bmN0aW9uIHN5bWJvbCgpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChzdHJpbmcpCiAgICB7CiAgICAgICAgcmV0dXJuIFNZTUJPTDsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWNpbWFscygpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50OCkKICAgIHsKICAgICAgICByZXR1cm4gREVDSU1BTFM7CiAgICB9CgogICAgZnVuY3Rpb24gdmVyc2lvbigpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChzdHJpbmcpCiAgICB7CiAgICAgICAgcmV0dXJuIFZFUlNJT047CiAgICB9Cn0KCmNvbnRyYWN0IElFUkMyMEFsbG93YW5jZSB7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBFdmVudHMKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIGV2ZW50IEFwcHJvdmFsKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBvd25lciwKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwKICAgICAgICB1aW50MjU2IGFtb3VudCk7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBQdWJsaWMgZnVuY3Rpb25zCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvLy8gQGRldiBUaGlzIGZ1bmN0aW9uIG1ha2VzIGl0IGVhc3kgdG8gcmVhZCB0aGUgYGFsbG93ZWRbXWAgbWFwCiAgICAvLy8gQHBhcmFtIG93bmVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IHRoYXQgb3ducyB0aGUgdG9rZW4KICAgIC8vLyBAcGFyYW0gc3BlbmRlciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBhYmxlIHRvIHRyYW5zZmVyIHRoZSB0b2tlbnMKICAgIC8vLyBAcmV0dXJuIEFtb3VudCBvZiByZW1haW5pbmcgdG9rZW5zIG9mIG93bmVyIHRoYXQgc3BlbmRlciBpcyBhbGxvd2VkCiAgICAvLy8gIHRvIHNwZW5kCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOwoKICAgIC8vLyBAbm90aWNlIGBtc2cuc2VuZGVyYCBhcHByb3ZlcyBgc3BlbmRlcmAgdG8gc3BlbmQgYGFtb3VudGAgdG9rZW5zIG9uCiAgICAvLy8gIGl0cyBiZWhhbGYuIFRoaXMgaXMgYSBtb2RpZmllZCB2ZXJzaW9uIG9mIHRoZSBFUkMyMCBhcHByb3ZlIGZ1bmN0aW9uCiAgICAvLy8gIHRvIGJlIGEgbGl0dGxlIGJpdCBzYWZlcgogICAgLy8vIEBwYXJhbSBzcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2VucwogICAgLy8vIEBwYXJhbSBhbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgYXBwcm92ZWQgZm9yIHRyYW5zZmVyCiAgICAvLy8gQHJldHVybiBUcnVlIGlmIHRoZSBhcHByb3ZhbCB3YXMgc3VjY2Vzc2Z1bAogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgYW1vdW50KQogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8vIEBub3RpY2UgU2VuZCBgYW1vdW50YCB0b2tlbnMgdG8gYHRvYCBmcm9tIGBmcm9tYCBvbiB0aGUgY29uZGl0aW9uIGl0CiAgICAvLy8gIGlzIGFwcHJvdmVkIGJ5IGBmcm9tYAogICAgLy8vIEBwYXJhbSBmcm9tIFRoZSBhZGRyZXNzIGhvbGRpbmcgdGhlIHRva2VucyBiZWluZyB0cmFuc2ZlcnJlZAogICAgLy8vIEBwYXJhbSB0byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICAvLy8gQHBhcmFtIGFtb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAgLy8vIEByZXR1cm4gVHJ1ZSBpZiB0aGUgdHJhbnNmZXIgd2FzIHN1Y2Nlc3NmdWwKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgYW1vdW50KQogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7Cgp9Cgpjb250cmFjdCBJRVJDMjBUb2tlbiBpcyBJQmFzaWNUb2tlbiwgSUVSQzIwQWxsb3dhbmNlIHsKCn0KCmNvbnRyYWN0IElFUkM2NzdDYWxsYmFjayB7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBQdWJsaWMgZnVuY3Rpb25zCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvLyBOT1RFOiBUaGlzIGNhbGwgY2FuIGJlIGluaXRpYXRlZCBieSBhbnlvbmUuIFlvdSBuZWVkIHRvIG1ha2Ugc3VyZSB0aGF0CiAgICAvLyBpdCBpcyBzZW5kIGJ5IHRoZSB0b2tlbiAoYHJlcXVpcmUobXNnLnNlbmRlciA9PSB0b2tlbilgKSBvciBtYWtlIHN1cmUKICAgIC8vIGFtb3VudCBpcyB2YWxpZCAoYHJlcXVpcmUodG9rZW4uYWxsb3dhbmNlKHRoaXMpID49IGFtb3VudClgKS4KICAgIGZ1bmN0aW9uIHJlY2VpdmVBcHByb3ZhbCgKICAgICAgICBhZGRyZXNzIGZyb20sCiAgICAgICAgdWludDI1NiBhbW91bnQsCiAgICAgICAgYWRkcmVzcyB0b2tlbiwgLy8gSUVSQzY2N1Rva2VuCiAgICAgICAgYnl0ZXMgZGF0YQogICAgKQogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7Cgp9Cgpjb250cmFjdCBJRVJDNjc3QWxsb3dhbmNlIGlzIElFUkMyMEFsbG93YW5jZSB7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBQdWJsaWMgZnVuY3Rpb25zCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvLy8gQG5vdGljZSBgbXNnLnNlbmRlcmAgYXBwcm92ZXMgYHNwZW5kZXJgIHRvIHNlbmQgYGFtb3VudGAgdG9rZW5zIG9uCiAgICAvLy8gIGl0cyBiZWhhbGYsIGFuZCB0aGVuIGEgZnVuY3Rpb24gaXMgdHJpZ2dlcmVkIGluIHRoZSBjb250cmFjdCB0aGF0IGlzCiAgICAvLy8gIGJlaW5nIGFwcHJvdmVkLCBgc3BlbmRlcmAuIFRoaXMgYWxsb3dzIHVzZXJzIHRvIHVzZSB0aGVpciB0b2tlbnMgdG8KICAgIC8vLyAgaW50ZXJhY3Qgd2l0aCBjb250cmFjdHMgaW4gb25lIGZ1bmN0aW9uIGNhbGwgaW5zdGVhZCBvZiB0d28KICAgIC8vLyBAcGFyYW0gc3BlbmRlciBUaGUgYWRkcmVzcyBvZiB0aGUgY29udHJhY3QgYWJsZSB0byB0cmFuc2ZlciB0aGUgdG9rZW5zCiAgICAvLy8gQHBhcmFtIGFtb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBhcHByb3ZlZCBmb3IgdHJhbnNmZXIKICAgIC8vLyBAcmV0dXJuIFRydWUgaWYgdGhlIGZ1bmN0aW9uIGNhbGwgd2FzIHN1Y2Nlc3NmdWwKICAgIGZ1bmN0aW9uIGFwcHJvdmVBbmRDYWxsKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiBhbW91bnQsIGJ5dGVzIGV4dHJhRGF0YSkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKfQoKY29udHJhY3QgSUVSQzY3N1Rva2VuIGlzIElFUkMyMFRva2VuLCBJRVJDNjc3QWxsb3dhbmNlIHsKfQoKY29udHJhY3QgTWF0aCB7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBJbnRlcm5hbCBmdW5jdGlvbnMKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8vIGFic29sdXRlIGRpZmZlcmVuY2U6IHx2MSAtIHYyfAogICAgZnVuY3Rpb24gYWJzRGlmZih1aW50MjU2IHYxLCB1aW50MjU2IHYyKQogICAgICAgIGludGVybmFsCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgcmV0dXJuIHYxID4gdjIgPyB2MSAtIHYyIDogdjIgLSB2MTsKICAgIH0KCiAgICAvLyBkaXZpZGUgdiBieSBkLCByb3VuZCB1cCBpZiByZW1haW5kZXIgaXMgMC41IG9yIG1vcmUKICAgIGZ1bmN0aW9uIGRpdlJvdW5kKHVpbnQyNTYgdiwgdWludDI1NiBkKQogICAgICAgIGludGVybmFsCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgcmV0dXJuIGFkZCh2LCBkLzIpIC8gZDsKICAgIH0KCiAgICAvLyBjb21wdXRlcyBkZWNpbWFsIGRlY2ltYWxGcmFjdGlvbiAnZnJhYycgb2YgJ2Ftb3VudCcgd2l0aCBtYXhpbXVtIHByZWNpc2lvbiAobXVsdGlwbGljYXRpb24gZmlyc3QpCiAgICAvLyBib3RoIGFtb3VudCBhbmQgZGVjaW1hbEZyYWN0aW9uIG11c3QgaGF2ZSAxOCBkZWNpbWFscyBwcmVjaXNpb24sIGZyYWMgMTAqKjE4IHJlcHJlc2VudHMgYSB3aG9sZSAoMTAwJSBvZikgYW1vdW50CiAgICAvLyBtaW5kIGxvc3Mgb2YgcHJlY2lzaW9uIGFzIGRlY2ltYWwgZnJhY3Rpb25zIGRvIG5vdCBoYXZlIGZpbml0ZSBiaW5hcnkgZXhwYW5zaW9uCiAgICAvLyBkbyBub3QgdXNlIGluc3RlYWQgb2YgZGl2aXNpb24KICAgIGZ1bmN0aW9uIGRlY2ltYWxGcmFjdGlvbih1aW50MjU2IGFtb3VudCwgdWludDI1NiBmcmFjKQogICAgICAgIGludGVybmFsCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgLy8gaXQncyBsaWtlIDEgZXRoZXIgaXMgMTAwJSBwcm9wb3J0aW9uCiAgICAgICAgcmV0dXJuIHByb3BvcnRpb24oYW1vdW50LCBmcmFjLCAxMCoqMTgpOwogICAgfQoKICAgIC8vIGNvbXB1dGVzIHBhcnQvdG90YWwgb2YgYW1vdW50IHdpdGggbWF4aW11bSBwcmVjaXNpb24gKG11bHRpcGxpY2F0aW9uIGZpcnN0KQogICAgLy8gcGFydCBhbmQgdG90YWwgbXVzdCBoYXZlIHRoZSBzYW1lIHVuaXRzCiAgICBmdW5jdGlvbiBwcm9wb3J0aW9uKHVpbnQyNTYgYW1vdW50LCB1aW50MjU2IHBhcnQsIHVpbnQyNTYgdG90YWwpCiAgICAgICAgaW50ZXJuYWwKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICByZXR1cm4gZGl2Um91bmQobXVsKGFtb3VudCwgcGFydCksIHRvdGFsKTsKICAgIH0KCiAgICAvLwogICAgLy8gT3BlbiBaZXBwZWxpbiBNYXRoIGxpYnJhcnkgYmVsb3cKICAgIC8vCgogICAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKQogICAgICAgIGludGVybmFsCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50MjU2KQogICAgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKQogICAgICAgIGludGVybmFsCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50MjU2KQogICAgewogICAgICAgIGFzc2VydChiIDw9IGEpOwogICAgICAgIHJldHVybiBhIC0gYjsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpCiAgICAgICAgaW50ZXJuYWwKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQyNTYpCiAgICB7CiAgICAgICAgdWludDI1NiBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSk7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gbWluKHVpbnQyNTYgYSwgdWludDI1NiBiKQogICAgICAgIGludGVybmFsCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50MjU2KQogICAgewogICAgICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOwogICAgfQoKICAgIGZ1bmN0aW9uIG1heCh1aW50MjU2IGEsIHVpbnQyNTYgYikKICAgICAgICBpbnRlcm5hbAogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludDI1NikKICAgIHsKICAgICAgICByZXR1cm4gYSA+IGIgPyBhIDogYjsKICAgIH0KfQoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBJQmFzaWNUb2tlbiwgTWF0aCB7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBNdXRhYmxlIHN0YXRlCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgaW50ZXJuYWwgX2JhbGFuY2VzOwoKICAgIHVpbnQyNTYgaW50ZXJuYWwgX3RvdGFsU3VwcGx5OwoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gUHVibGljIGZ1bmN0aW9ucwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgLyoqCiAgICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAgICogQHBhcmFtIHRvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICAgKiBAcGFyYW0gYW1vdW50IFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiBhbW91bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICB0cmFuc2ZlckludGVybmFsKG1zZy5zZW5kZXIsIHRvLCBhbW91bnQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vLyBAZGV2IFRoaXMgZnVuY3Rpb24gbWFrZXMgaXQgZWFzeSB0byBnZXQgdGhlIHRvdGFsIG51bWJlciBvZiB0b2tlbnMKICAgIC8vLyBAcmV0dXJuIFRoZSB0b3RhbCBudW1iZXIgb2YgdG9rZW5zCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50MjU2KQogICAgewogICAgICAgIHJldHVybiBfdG90YWxTdXBwbHk7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgICAqIEBwYXJhbSBvd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgICAqLwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgb3duZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpCiAgICB7CiAgICAgICAgcmV0dXJuIF9iYWxhbmNlc1tvd25lcl07CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBJbnRlcm5hbCBmdW5jdGlvbnMKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8vIGFjdHVhbCB0cmFuc2ZlciBmdW5jdGlvbiBjYWxsZWQgYnkgYWxsIHB1YmxpYyB2YXJpYW50cwogICAgZnVuY3Rpb24gdHJhbnNmZXJJbnRlcm5hbChhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgYW1vdW50KQogICAgICAgIGludGVybmFsCiAgICB7CiAgICAgICAgcmVxdWlyZSh0byAhPSBhZGRyZXNzKDApKTsKCiAgICAgICAgX2JhbGFuY2VzW2Zyb21dID0gc3ViKF9iYWxhbmNlc1tmcm9tXSwgYW1vdW50KTsKICAgICAgICBfYmFsYW5jZXNbdG9dID0gYWRkKF9iYWxhbmNlc1t0b10sIGFtb3VudCk7CiAgICAgICAgVHJhbnNmZXIoZnJvbSwgdG8sIGFtb3VudCk7CiAgICB9Cn0KCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMKICAgIElFUkMyMFRva2VuLAogICAgQmFzaWNUb2tlbiwKICAgIElFUkM2NzdUb2tlbgp7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBNdXRhYmxlIHN0YXRlCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIHByaXZhdGUgX2FsbG93ZWQ7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBQdWJsaWMgZnVuY3Rpb25zCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvLwogICAgLy8gSW1wbGVtZW50cyBFUkMyMAogICAgLy8KCiAgICAvKioKICAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICAqIEBwYXJhbSBmcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAgKiBAcGFyYW0gdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAgKiBAcGFyYW0gYW1vdW50IHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IGFtb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIC8vIGNoZWNrIGFuZCByZXNldCBhbGxvd2FuY2UKICAgICAgICB2YXIgYWxsb3dhbmNlID0gX2FsbG93ZWRbZnJvbV1bbXNnLnNlbmRlcl07CiAgICAgICAgX2FsbG93ZWRbZnJvbV1bbXNnLnNlbmRlcl0gPSBzdWIoYWxsb3dhbmNlLCBhbW91bnQpOwogICAgICAgIC8vIGRvIHRoZSB0cmFuc2ZlcgogICAgICAgIHRyYW5zZmVySW50ZXJuYWwoZnJvbSwgdG8sIGFtb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgQXByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICAqIEBwYXJhbSBzcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgKiBAcGFyYW0gYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IGFtb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zIChib29sKQogICAgewoKICAgICAgICAvLyBUbyBjaGFuZ2UgdGhlIGFwcHJvdmUgYW1vdW50IHlvdSBmaXJzdCBoYXZlIHRvIHJlZHVjZSB0aGUgYWRkcmVzc2VzYAogICAgICAgIC8vICBhbGxvd2FuY2UgdG8gemVybyBieSBjYWxsaW5nIGBhcHByb3ZlKF9zcGVuZGVyLCAwKWAgaWYgaXQgaXMgbm90CiAgICAgICAgLy8gIGFscmVhZHkgMCB0byBtaXRpZ2F0ZSB0aGUgcmFjZSBjb25kaXRpb24gZGVzY3JpYmVkIGhlcmU6CiAgICAgICAgLy8gIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICAgICAgcmVxdWlyZSgoYW1vdW50ID09IDApIHx8IChfYWxsb3dlZFttc2cuc2VuZGVyXVtzcGVuZGVyXSA9PSAwKSk7CgogICAgICAgIF9hbGxvd2VkW21zZy5zZW5kZXJdW3NwZW5kZXJdID0gYW1vdW50OwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIHNwZW5kZXIsIGFtb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgICogQHBhcmFtIG93bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICAqIEBwYXJhbSBzcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZmluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpYmxlIGZvciB0aGUgc3BlbmRlci4KICAgICovCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpCiAgICB7CiAgICAgICAgcmV0dXJuIF9hbGxvd2VkW293bmVyXVtzcGVuZGVyXTsKICAgIH0KCiAgICAvLwogICAgLy8gSW1wbGVtZW50cyBJRVJDNjc3VG9rZW4KICAgIC8vCgogICAgZnVuY3Rpb24gYXBwcm92ZUFuZENhbGwoCiAgICAgICAgYWRkcmVzcyBzcGVuZGVyLAogICAgICAgIHVpbnQyNTYgYW1vdW50LAogICAgICAgIGJ5dGVzIGV4dHJhRGF0YQogICAgKQogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmVxdWlyZShhcHByb3ZlKHNwZW5kZXIsIGFtb3VudCkpOwoKICAgICAgICAvLyBpbiBjYXNlIG9mIHJlLWVudHJ5IDEuIGFwcHJvdmFsIGlzIGRvbmUgMi4gbXNnLnNlbmRlciBpcyBkaWZmZXJlbnQKICAgICAgICBib29sIHN1Y2Nlc3MgPSBJRVJDNjc3Q2FsbGJhY2soc3BlbmRlcikucmVjZWl2ZUFwcHJvdmFsKAogICAgICAgICAgICBtc2cuc2VuZGVyLAogICAgICAgICAgICBhbW91bnQsCiAgICAgICAgICAgIHRoaXMsCiAgICAgICAgICAgIGV4dHJhRGF0YQogICAgICAgICk7CiAgICAgICAgcmVxdWlyZShzdWNjZXNzKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0KCi8vLyBTaW1wbGUgaW1wbGVtZW50YXRpb24gb2YgRXVyb1Rva2VuIHdoaWNoIGlzIHBlZ2dlZCAxOjEgdG8gY2VydGFpbiBvZmYtY2hhaW4KLy8vIHBvb2wgb2YgRXVyby4gQmFsYW5jZXMgb2YgdGhpcyB0b2tlbiBhcmUgaW50ZW5kZWQgdG8gYmUgbWlncmF0ZWQgdG8gZmluYWwKLy8vIGltcGxlbWVudGF0aW9uIHRoYXQgd2lsbCBiZSBhdmFpbGFibGUgbGF0ZXIKY29udHJhY3QgRXVyb1Rva2VuIGlzCiAgICBJRVJDNjc3VG9rZW4sCiAgICBBY2Nlc3NDb250cm9sbGVkLAogICAgU3RhbmRhcmRUb2tlbiwKICAgIFRva2VuTWV0YWRhdGEsCiAgICBNaWdyYXRpb25Tb3VyY2UsCiAgICBSZWNsYWltYWJsZQp7CiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIENvbnN0YW50cwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgc3RyaW5nIHByaXZhdGUgY29uc3RhbnQgTkFNRSA9ICJFdXJvIFRva2VuIjsKCiAgICBzdHJpbmcgcHJpdmF0ZSBjb25zdGFudCBTWU1CT0wgPSAiRVVSLVQiOwoKICAgIHVpbnQ4IHByaXZhdGUgY29uc3RhbnQgREVDSU1BTFMgPSAxODsKCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIE11dGFibGUgc3RhdGUKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8vIGEgbGlzdCBvZiBhZGRyZXNzZXMgdGhhdCBhcmUgYWxsb3dlZCB0byByZWNlaXZlIEVVUi1UCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgcHJpdmF0ZSBfYWxsb3dlZFRyYW5zZmVyVG87CgogICAgLy8gYSBsaXN0IG9mIG9mIGFkZHJlc3NlcyB0aGF0IGFyZSBhbGxvd2VkIHRvIHNlbmQgRVVSLVQKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBwcml2YXRlIF9hbGxvd2VkVHJhbnNmZXJGcm9tOwoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gRXZlbnRzCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICBldmVudCBMb2dEZXBvc2l0KAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCB0bywKICAgICAgICB1aW50MjU2IGFtb3VudAogICAgKTsKCiAgICBldmVudCBMb2dXaXRoZHJhd2FsKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBmcm9tLAogICAgICAgIHVpbnQyNTYgYW1vdW50CiAgICApOwoKICAgIGV2ZW50IExvZ0FsbG93ZWRGcm9tQWRkcmVzcygKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgZnJvbSwKICAgICAgICBib29sIGFsbG93ZWQKICAgICk7CgogICAgZXZlbnQgTG9nQWxsb3dlZFRvQWRkcmVzcygKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgdG8sCiAgICAgICAgYm9vbCBhbGxvd2VkCiAgICApOwoKICAgIC8vLyBAbm90aWNlIG1pZ3JhdGlvbiB3YXMgc3VjY2Vzc2Z1bAogICAgZXZlbnQgTG9nRXVyb1Rva2VuT3duZXJNaWdyYXRlZCgKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgb3duZXIsCiAgICAgICAgdWludDI1NiBhbW91bnQKICAgICk7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBNb2RpZmllcnMKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIG1vZGlmaWVyIG9ubHlBbGxvd2VkVHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSkgewogICAgICAgIHJlcXVpcmUoX2FsbG93ZWRUcmFuc2ZlckZyb21bZnJvbV0pOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seUFsbG93ZWRUcmFuc2ZlclRvKGFkZHJlc3MgdG8pIHsKICAgICAgICByZXF1aXJlKF9hbGxvd2VkVHJhbnNmZXJUb1t0b10pOwogICAgICAgIF87CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDb25zdHJ1Y3RvcgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgZnVuY3Rpb24gRXVyb1Rva2VuKElBY2Nlc3NQb2xpY3kgYWNjZXNzUG9saWN5KQogICAgICAgIEFjY2Vzc0NvbnRyb2xsZWQoYWNjZXNzUG9saWN5KQogICAgICAgIFN0YW5kYXJkVG9rZW4oKQogICAgICAgIFRva2VuTWV0YWRhdGEoTkFNRSwgREVDSU1BTFMsIFNZTUJPTCwgIiIpCiAgICAgICAgTWlncmF0aW9uU291cmNlKGFjY2Vzc1BvbGljeSwgUk9MRV9FVVJUX0RFUE9TSVRfTUFOQUdFUikKICAgICAgICBSZWNsYWltYWJsZSgpCiAgICAgICAgcHVibGljCiAgICB7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBQdWJsaWMgZnVuY3Rpb25zCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvLy8gQG5vdGljZSBkZXBvc2l0ICdhbW91bnQnIG9mIEVVUi1UIHRvIGFkZHJlc3MgJ3RvJwogICAgLy8vIEBkZXYgYWRkcmVzcyAndG8nIGlzIHdoaXRlbGlzdGVkIGFzIHJlY2lwaWVudCBvZiBmdXR1cmUgdHJhbnNmZXJzCiAgICAvLy8gQGRldiBkZXBvc2l0IG1heSBoYXBwZW4gb25seSBpbiBjYXNlIG9mIHN1Y2Nlc2Z1bCBLWUMgb2YgcmVjaXBpZW50IGFuZCB2YWxpZGF0aW9uIG9mIGJhbmtpbmcgZGF0YQogICAgLy8vIEBkZXYgd2hpY2ggaW4gdGhpcyBpbXBsZW1lbnRhdGlvbiBpcyBhbiBvZmYtY2hhaW4gcmVzcG9uc2liaWxpdHkgb2YgRVVSVF9ERVBPU0lUX01BTkFHRVIKICAgIGZ1bmN0aW9uIGRlcG9zaXQoYWRkcmVzcyB0bywgdWludDI1NiBhbW91bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seShST0xFX0VVUlRfREVQT1NJVF9NQU5BR0VSKQogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmVxdWlyZSh0byAhPSBhZGRyZXNzKDApKTsKICAgICAgICBfYmFsYW5jZXNbdG9dID0gYWRkKF9iYWxhbmNlc1t0b10sIGFtb3VudCk7CiAgICAgICAgX3RvdGFsU3VwcGx5ID0gYWRkKF90b3RhbFN1cHBseSwgYW1vdW50KTsKICAgICAgICBzZXRBbGxvd2VkVHJhbnNmZXJUbyh0bywgdHJ1ZSk7CiAgICAgICAgTG9nRGVwb3NpdCh0bywgYW1vdW50KTsKICAgICAgICBUcmFuc2ZlcihhZGRyZXNzKDApLCB0bywgYW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSB3aXRoZHJhd3MgJ2Ftb3VudCcgb2YgRVVSLVQgYnkgYnVybmluZyByZXF1aXJlZCBhbW91bnQgYW5kIHByb3ZpZGluZyBhIHByb29mIG9mIHdoaXRoZHJhd2FsCiAgICAvLy8gQGRldiBwcm9vZiBpcyBwcm92aWRlZCBpbiBmb3JtIG9mIGxvZyBlbnRyeSBvbiB3aGljaCBFVVJUX0RFUE9TSVRfTUFOQUdFUgogICAgLy8vIEBkZXYgd2lsbCBhY3Qgb2ZmLWNoYWluIHRvIHJldHVybiByZXF1aXJlZCBFdXJvIGFtb3VudCB0byBFVVItVCBob2xkZXIKICAgIGZ1bmN0aW9uIHdpdGhkcmF3KHVpbnQyNTYgYW1vdW50KQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIHJlcXVpcmUoX2JhbGFuY2VzW21zZy5zZW5kZXJdID49IGFtb3VudCk7CiAgICAgICAgX2JhbGFuY2VzW21zZy5zZW5kZXJdID0gc3ViKF9iYWxhbmNlc1ttc2cuc2VuZGVyXSwgYW1vdW50KTsKICAgICAgICBfdG90YWxTdXBwbHkgPSBzdWIoX3RvdGFsU3VwcGx5LCBhbW91bnQpOwogICAgICAgIExvZ1dpdGhkcmF3YWwobXNnLnNlbmRlciwgYW1vdW50KTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBhZGRyZXNzKDApLCBhbW91bnQpOwogICAgfQoKICAgIC8vLyBAbm90aWNlIGVuYWJsZXMgb3IgZGlzYWJsZXMgYWRkcmVzcyB0byBiZSByZWNlaXBpZW50IG9mIEVVUi1UCiAgICBmdW5jdGlvbiBzZXRBbGxvd2VkVHJhbnNmZXJUbyhhZGRyZXNzIHRvLCBib29sIGFsbG93ZWQpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seShST0xFX0VVUlRfREVQT1NJVF9NQU5BR0VSKQogICAgewogICAgICAgIF9hbGxvd2VkVHJhbnNmZXJUb1t0b10gPSBhbGxvd2VkOwogICAgICAgIExvZ0FsbG93ZWRUb0FkZHJlc3ModG8sIGFsbG93ZWQpOwogICAgfQoKICAgIC8vLyBAbm90aWNlIGVuYWJsZXMgb3IgZGlzYWJsZXMgYWRkcmVzcyB0byBiZSBzZW5kZXIgb2YgRVVSLVQKICAgIGZ1bmN0aW9uIHNldEFsbG93ZWRUcmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBib29sIGFsbG93ZWQpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seShST0xFX0VVUlRfREVQT1NJVF9NQU5BR0VSKQogICAgewogICAgICAgIF9hbGxvd2VkVHJhbnNmZXJGcm9tW2Zyb21dID0gYWxsb3dlZDsKICAgICAgICBMb2dBbGxvd2VkRnJvbUFkZHJlc3MoZnJvbSwgYWxsb3dlZCk7CiAgICB9CgogICAgZnVuY3Rpb24gYWxsb3dlZFRyYW5zZmVyVG8oYWRkcmVzcyB0bykKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmV0dXJuIF9hbGxvd2VkVHJhbnNmZXJUb1t0b107CiAgICB9CgogICAgZnVuY3Rpb24gYWxsb3dlZFRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20pCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHJldHVybiBfYWxsb3dlZFRyYW5zZmVyRnJvbVtmcm9tXTsKICAgIH0KCiAgICAvLwogICAgLy8gT3ZlcnJpZGVzIEVSQzIwIEludGVyZmFjZSB0byBhbGxvdyB0cmFuc2ZlciBmcm9tL3RvIGFsbG93ZWQgYWRkcmVzc2VzCiAgICAvLwoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgYW1vdW50KQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlBbGxvd2VkVHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIpCiAgICAgICAgb25seUFsbG93ZWRUcmFuc2ZlclRvKHRvKQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICByZXR1cm4gQmFzaWNUb2tlbi50cmFuc2Zlcih0bywgYW1vdW50KTsKICAgIH0KCiAgICAvLy8gQGRldiBicm9rZXIgYWN0cyBpbiB0aGUgbmFtZSBvZiAnZnJvbScgYWRkcmVzcyBzbyBicm9rZXIgbmVlZHMgdG8gaGF2ZSBwZXJtaXNzaW9uIHRvIHRyYW5zZmVyIGZyb20KICAgIC8vLyAgdGhpcyB3YXkgd2UgbWF5IGdpdmUgcGVybWlzc2lvbnMgdG8gYnJva2VyaW5nIHNtYXJ0IGNvbnRyYWN0cyB3aGlsZSBpbnZlc3RvcnMgZG8gbm90IGhhdmUgcGVybWlzc2lvbnMKICAgIC8vLyAgdG8gdHJhbnNmZXIuICd0bycgYWRkcmVzcyByZXF1aXJlcyBzdGFuZGFyZCB0cmFuc2ZlciB0byBwZXJtaXNzaW9uCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IGFtb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5QWxsb3dlZFRyYW5zZmVyRnJvbShtc2cuc2VuZGVyKQogICAgICAgIG9ubHlBbGxvd2VkVHJhbnNmZXJUbyh0bykKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgICAgcmV0dXJuIFN0YW5kYXJkVG9rZW4udHJhbnNmZXJGcm9tKGZyb20sIHRvLCBhbW91bnQpOwogICAgfQoKICAgIC8vCiAgICAvLyBPdmVycmlkZXMgbWlncmF0aW9uIHNvdXJjZQogICAgLy8KCiAgICBmdW5jdGlvbiBtaWdyYXRlKCkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5TWlncmF0aW9uRW5hYmxlZCgpCiAgICAgICAgb25seUFsbG93ZWRUcmFuc2ZlclRvKG1zZy5zZW5kZXIpCiAgICB7CiAgICAgICAgLy8gYnVybiBkZXBvc2l0CiAgICAgICAgdWludDI1NiBhbW91bnQgPSBfYmFsYW5jZXNbbXNnLnNlbmRlcl07CiAgICAgICAgaWYgKGFtb3VudCA+IDApIHsKICAgICAgICAgICAgX2JhbGFuY2VzW21zZy5zZW5kZXJdID0gMDsKICAgICAgICAgICAgX3RvdGFsU3VwcGx5ID0gc3ViKF90b3RhbFN1cHBseSwgYW1vdW50KTsKICAgICAgICB9CiAgICAgICAgLy8gcmVtb3ZlIGFsbCB0cmFuc2ZlciBwZXJtaXNzaW9ucwogICAgICAgIF9hbGxvd2VkVHJhbnNmZXJUb1ttc2cuc2VuZGVyXSA9IGZhbHNlOwogICAgICAgIF9hbGxvd2VkVHJhbnNmZXJGcm9tW21zZy5zZW5kZXJdID0gZmFsc2U7CiAgICAgICAgLy8gbWlncmF0ZSB0bwogICAgICAgIEV1cm9Ub2tlbk1pZ3JhdGlvblRhcmdldChfbWlncmF0aW9uKS5taWdyYXRlRXVyb1Rva2VuT3duZXIobXNnLnNlbmRlciwgYW1vdW50KTsKICAgICAgICAvLyBzZXQgZXZlbnQKICAgICAgICBMb2dFdXJvVG9rZW5Pd25lck1pZ3JhdGVkKG1zZy5zZW5kZXIsIGFtb3VudCk7CiAgICB9Cn0='.
	

]
