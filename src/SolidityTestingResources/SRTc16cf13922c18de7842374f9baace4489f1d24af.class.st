Class {
	#name : #SRTc16cf13922c18de7842374f9baace4489f1d24af,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTc16cf13922c18de7842374f9baace4489f1d24af >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgoKLyoKKiAgZGVleC5leGNoYW5nZSBwcmUtSUNPIHRva2VucyBzbWFydCBjb250cmFjdAoqICBpbXBsZW1lbnRzIFtFUkMtMjAgVG9rZW4gU3RhbmRhcmRdKGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2Jsb2IvbWFzdGVyL0VJUFMvZWlwLTIwLXRva2VuLXN0YW5kYXJkLm1kKQoqCiogIFN0eWxlCiogIDEpIGJlZm9yZSBzdGFydCBjb2RpbmcsIHJ1biBQeXRob24gYW5kIHR5cGUgJ2ltcG9ydCB0aGlzJyBpbiBQeXRob24gY29uc29sZS4KKiAgMikgd2UgYXZvaWQgdXNpbmcgaW5oZXJpdGFuY2UgKGNvbnRyYWN0IEIgaXMgQSkgYXMgaXQgbWFrZXMgY29kZSBsZXNzIGNsZWFyIGZvciBvYnNlcnZlcgoqICAoIkZsYXQgaXMgYmV0dGVyIHRoYW4gbmVzdGVkIiwgIlJlYWRhYmlsaXR5IGNvdW50cyIpCiogIDMpIHdlIGF2b2lkIHVzaW5nIC09IDsgPS0gOyArPTsgPSsKKiAgc2VlOiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXItY2FtcC92aXJ0dWFsLWFjY2VsZXJhdG9yL2lzc3Vlcy84CiogIGh0dHBzOi8vd3d3LmV0aG5ld3MuY29tL2V0aGVyY2FtcHMtaGtnLXRva2VuLWhhcy1hLWJ1Zy1hbmQtbmVlZHMtdG8tYmUtcmVpc3N1ZWQKKiAgNCkgYWx3YXlzIGV4cGxpY2l0bHkgbWFyayB2YXJpYWJsZXMgYW5kIGZ1bmN0aW9ucyB2aXNpYmlsaXR5ICgiRXhwbGljaXQgaXMgYmV0dGVyIHRoYW4gaW1wbGljaXQiKQoqICA1KSBldmVyeSBmdW5jdGlvbiBleGNlcHQgY29uc3RydWN0b3Igc2hvdWxkIHRyaWdnZXIgYXQgbGVhcyBvbmUgZXZlbnQuCiogIDYpIHNtYXJ0IGNvbnRyYWN0cyBoYXZlIHRvIGJlIGF1ZGl0ZWQgYW5kIHJldmlld2VkLCBjb21tZW50IHlvdXIgY29kZS4KKgoqICBDb2RlIGlzIHB1Ymxpc2hlZCBvbiBodHRwczovL2dpdGh1Yi5jb20vdGhlZGVleC90aGVkZWV4LmdpdGh1Yi5pbwoqLwoKCi8qICJJbnRlcmZhY2VzIiAqLwoKLy8gIHRoaXMgaXMgZXhwZWN0ZWQgZnJvbSBhbm90aGVyIGNvbnRyYWN0cwovLyAgaWYgaXQgd2FudHMgdG8gc3BlbmQgdG9rZW5zIG9mIGJlaGFsZiBvZiB0aGUgdG9rZW4gb3duZXIgaW4gb3VyIGNvbnRyYWN0Ci8vICB0aGlzIGNhbiBiZSB1c2VkIGluIG1hbnkgc2l0dWF0aW9ucywgZm9yIGV4YW1wbGUgdG8gY29udmVydCBwcmUtSUNPIHRva2VucyB0byBJQ08gdG9rZW5zCi8vICBzZWUgJ2FwcHJvdmVBbmRDYWxsJyBmdW5jdGlvbgpjb250cmFjdCBhbGxvd2FuY2VSZWNpcGllbnQgewogICAgZnVuY3Rpb24gcmVjZWl2ZUFwcHJvdmFsKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlLCBhZGRyZXNzIF9pbkNvbnRyYWN0LCBieXRlcyBfZXh0cmFEYXRhKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwp9CgoKLy8gc2VlOgovLyBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvNjc3CmNvbnRyYWN0IHRva2VuUmVjaXBpZW50IHsKICAgIGZ1bmN0aW9uIHRva2VuRmFsbGJhY2soYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9leHRyYURhdGEpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7Cn0KCgpjb250cmFjdCBERUVYIHsKCiAgICAvLyB2ZXIuIDIuMAoKICAgIC8qIC0tLS0tLS0tLS0gVmFyaWFibGVzICovCgogICAgLyogLS0tIEVSQy0yMCB2YXJpYWJsZXMgKi8KCiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9ibG9iL21hc3Rlci9FSVBTL2VpcC0yMC10b2tlbi1zdGFuZGFyZC5tZCNuYW1lCiAgICAvLyBmdW5jdGlvbiBuYW1lKCkgY29uc3RhbnQgcmV0dXJucyAoc3RyaW5nIG5hbWUpCiAgICBzdHJpbmcgcHVibGljIG5hbWUgPSAiZGVleCI7CgogICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvYmxvYi9tYXN0ZXIvRUlQUy9laXAtMjAtdG9rZW4tc3RhbmRhcmQubWQjc3ltYm9sCiAgICAvLyBmdW5jdGlvbiBzeW1ib2woKSBjb25zdGFudCByZXR1cm5zIChzdHJpbmcgc3ltYm9sKQogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAiZGVleCI7CgogICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvYmxvYi9tYXN0ZXIvRUlQUy9laXAtMjAtdG9rZW4tc3RhbmRhcmQubWQjZGVjaW1hbHMKICAgIC8vIGZ1bmN0aW9uIGRlY2ltYWxzKCkgY29uc3RhbnQgcmV0dXJucyAodWludDggZGVjaW1hbHMpCiAgICB1aW50OCBwdWJsaWMgZGVjaW1hbHMgPSAwOwoKICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2Jsb2IvbWFzdGVyL0VJUFMvZWlwLTIwLXRva2VuLXN0YW5kYXJkLm1kI3RvdGFsc3VwcGx5CiAgICAvLyBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgdG90YWxTdXBwbHkpCiAgICAvLyB3ZSBzdGFydCB3aXRoIHplcm8gYW5kIHdpbGwgY3JlYXRlIHRva2VucyBhcyBTQyByZWNlaXZlcyBFVEgKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwoKICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2Jsb2IvbWFzdGVyL0VJUFMvZWlwLTIwLXRva2VuLXN0YW5kYXJkLm1kI2JhbGFuY2VvZgogICAgLy8gZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBiYWxhbmNlT2Y7CgogICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvYmxvYi9tYXN0ZXIvRUlQUy9laXAtMjAtdG9rZW4tc3RhbmRhcmQubWQjYWxsb3dhbmNlCiAgICAvLyBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBwdWJsaWMgYWxsb3dhbmNlOwoKICAgIC8qIC0tLS0tIEZvciB0b2tlbnMgc2FsZSAqLwoKICAgIHVpbnQyNTYgcHVibGljIHNhbGVzQ291bnRlciA9IDA7CgogICAgdWludDI1NiBwdWJsaWMgbWF4U2FsZXNBbGxvd2VkOwoKICAgIGJvb2wgcHJpdmF0ZSB0cmFuc2ZlcnNCZXR3ZWVuU2FsZXNBbGxvd2VkOwoKICAgIC8vIGluaXRpYWwgdmFsdWUgc2hvdWxkIGJlIGNoYW5nZWQgYnkgdGhlIG93bmVyCiAgICB1aW50MjU2IHB1YmxpYyB0b2tlblByaWNlSW5XZWkgPSAwOwoKICAgIHVpbnQyNTYgcHVibGljIHNhbGVTdGFydFVuaXhUaW1lID0gMDsgLy8gYmxvY2sudGltZXN0YW1wCiAgICB1aW50MjU2IHB1YmxpYyBzYWxlRW5kVW5peFRpbWUgPSAwOyAgLy8gYmxvY2sudGltZXN0YW1wCgogICAgLyogLS0tIGFkbWluaXN0cmF0aXZlICovCiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgICAvLyBhY2NvdW50IHRoYXQgY2FuIHNldCBwcmljZXMKICAgIGFkZHJlc3MgcHVibGljIHByaWNlU2V0dGVyOwoKICAgIC8vIDAgLSBub3Qgc2V0CiAgICB1aW50MjU2IHByaXZhdGUgcHJpY2VNYXhXZWkgPSAwOwogICAgLy8gMCAtIG5vdCBzZXQKICAgIHVpbnQyNTYgcHJpdmF0ZSBwcmljZU1pbldlaSA9IDA7CgogICAgLy8gYWNjb3VudHMgaG9sZGluZyB0b2tlbnMgZm9yIGZvciB0aGUgdGVhbSwgZm9yIGFkdmlzZXJzIGFuZCBmb3IgdGhlIGJvdW50eSBjYW1wYWlnbgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgaXNQcmVmZXJyZWRUb2tlbnNBY2NvdW50OwoKICAgIGJvb2wgcHVibGljIGNvbnRyYWN0SW5pdGlhbGl6ZWQgPSBmYWxzZTsKCgogICAgLyogLS0tLS0tLS0tLSBDb25zdHJ1Y3RvciAqLwogICAgLy8gZG8gbm90IGZvcmdldCBhYm91dDoKICAgIC8vIGh0dHBzOi8vbWVkaXVtLmNvbS9AY29kZXRyYWN0aW8vYS1sb29rLWludG8tcGFyaXR5cy1tdWx0aXNpZy13YWxsZXQtYnVnLWFmZmVjdGluZy0xMDAtbWlsbGlvbi1pbi1ldGhlci1hbmQtdG9rZW5zLTM1NmY1YmE2ZTkwYQogICAgZnVuY3Rpb24gREVFWCgpIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CgogICAgICAgIC8vIGZvciB0ZXN0TmV0IGNhbiBiZSBtb3JlIHRoYW4gMgogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLWNoYW5nZSAgaW4gcHJvZHVjdGlvbiEKICAgICAgICBtYXhTYWxlc0FsbG93ZWQgPSAyOwogICAgICAgIC8vCiAgICAgICAgdHJhbnNmZXJzQmV0d2VlblNhbGVzQWxsb3dlZCA9IHRydWU7CiAgICB9CgoKICAgIGZ1bmN0aW9uIGluaXRDb250cmFjdChhZGRyZXNzIHRlYW0sIGFkZHJlc3MgYWR2aXNlcnMsIGFkZHJlc3MgYm91bnR5KSBwdWJsaWMgb25seUJ5KG93bmVyKSByZXR1cm5zIChib29sKXsKCiAgICAgICAgcmVxdWlyZShjb250cmFjdEluaXRpYWxpemVkID09IGZhbHNlKTsKICAgICAgICBjb250cmFjdEluaXRpYWxpemVkID0gdHJ1ZTsKCiAgICAgICAgcHJpY2VTZXR0ZXIgPSBtc2cuc2VuZGVyOwoKICAgICAgICB0b3RhbFN1cHBseSA9IDEwMDAwMDAwMDsKCiAgICAgICAgLy8gdG9rZW5zIGZvciBzYWxlIGdvIFNDIG93biBhY2NvdW50CiAgICAgICAgYmFsYW5jZU9mW3RoaXNdID0gNzUwMDAwMDA7CgogICAgICAgIC8vIGZvciB0aGUgdGVhbQogICAgICAgIGJhbGFuY2VPZlt0ZWFtXSA9IGJhbGFuY2VPZlt0ZWFtXSArIDE1MDAwMDAwOwogICAgICAgIGlzUHJlZmVycmVkVG9rZW5zQWNjb3VudFt0ZWFtXSA9IHRydWU7CgogICAgICAgIC8vIGZvciBhZHZpc2VycwogICAgICAgIGJhbGFuY2VPZlthZHZpc2Vyc10gPSBiYWxhbmNlT2ZbYWR2aXNlcnNdICsgNzAwMDAwMDsKICAgICAgICBpc1ByZWZlcnJlZFRva2Vuc0FjY291bnRbYWR2aXNlcnNdID0gdHJ1ZTsKCiAgICAgICAgLy8gZm9yIHRoZSBib3VudHkgY2FtcGFpZ24KICAgICAgICBiYWxhbmNlT2ZbYm91bnR5XSA9IGJhbGFuY2VPZltib3VudHldICsgMzAwMDAwMDsKICAgICAgICBpc1ByZWZlcnJlZFRva2Vuc0FjY291bnRbYm91bnR5XSA9IHRydWU7CgogICAgfQoKICAgIC8qIC0tLS0tLS0tLS0gRXZlbnRzICovCgogICAgLyogLS0tIEVSQy0yMCBldmVudHMgKi8KICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2Jsb2IvbWFzdGVyL0VJUFMvZWlwLTIwLXRva2VuLXN0YW5kYXJkLm1kI2V2ZW50cwoKICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2Jsb2IvbWFzdGVyL0VJUFMvZWlwLTIwLXRva2VuLXN0YW5kYXJkLm1kI3RyYW5zZmVyLTEKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwoKICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2Jsb2IvbWFzdGVyL0VJUFMvZWlwLTIwLXRva2VuLXN0YW5kYXJkLm1kI2FwcHJvdmFsCiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7CgogICAgLyogLS0tIEFkbWluaXN0cmF0aXZlIGV2ZW50czogICovCiAgICBldmVudCBPd25lckNoYW5nZWQoYWRkcmVzcyBpbmRleGVkIG9sZE93bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKICAgIC8qIC0tLS0gVG9rZW5zIGNyZWF0aW9uIGFuZCBzYWxlIGV2ZW50cyAgKi8KCiAgICBldmVudCBQcmljZUNoYW5nZWQodWludDI1NiBpbmRleGVkIG5ld1Rva2VuUHJpY2VJbldlaSk7CgogICAgZXZlbnQgU2FsZVN0YXJ0ZWQodWludDI1NiBzdGFydFVuaXhUaW1lLCB1aW50MjU2IGVuZFVuaXhUaW1lLCB1aW50MjU2IGluZGV4ZWQgc2FsZU51bWJlcik7CgogICAgZXZlbnQgTmV3VG9rZW5zU29sZCh1aW50MjU2IG51bWJlck9mVG9rZW5zLCBhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VkQnksIHVpbnQyNTYgaW5kZXhlZCBwcmljZUluV2VpKTsKCiAgICBldmVudCBXaXRoZHJhd2FsKGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCBzdW1JbldlaSk7CgogICAgLyogLS0tIEludGVyYWN0aW9uIHdpdGggb3RoZXIgY29udHJhY3RzIGV2ZW50cyAgKi8KICAgIGV2ZW50IERhdGFTZW50VG9Bbm90aGVyQ29udHJhY3QoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvQ29udHJhY3QsIGJ5dGVzIF9leHRyYURhdGEpOwoKICAgIC8qIC0tLS0tLS0tLS0gRnVuY3Rpb25zICovCgogICAgLyogLS0tIE1vZGlmaWVycyAgKi8KICAgIG1vZGlmaWVyIG9ubHlCeShhZGRyZXNzIF9hY2NvdW50KXsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gX2FjY291bnQpOwoKICAgICAgICBfOwogICAgfQoKICAgIC8qIC0tLSBFUkMtMjAgRnVuY3Rpb25zICovCiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9ibG9iL21hc3Rlci9FSVBTL2VpcC0yMC10b2tlbi1zdGFuZGFyZC5tZCNtZXRob2RzCgogICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvYmxvYi9tYXN0ZXIvRUlQUy9laXAtMjAtdG9rZW4tc3RhbmRhcmQubWQjdHJhbnNmZXIKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpewogICAgICAgIHJldHVybiB0cmFuc2ZlckZyb20obXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2Jsb2IvbWFzdGVyL0VJUFMvZWlwLTIwLXRva2VuLXN0YW5kYXJkLm1kI3RyYW5zZmVyZnJvbQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpewoKICAgICAgICAvLyB0cmFuc2ZlcnMgYXJlIHBvc3NpYmxlIG9ubHkgYWZ0ZXIgc2FsZSBpcyBmaW5pc2hlZAogICAgICAgIC8vIGV4Y2VwdCBmb3IgbWFuYWdlciBhbmQgcHJlZmVycmVkIGFjY291bnRzCgogICAgICAgIGJvb2wgc2FsZUZpbmlzaGVkID0gc2FsZUlzRmluaXNoZWQoKTsKICAgICAgICByZXF1aXJlKHNhbGVGaW5pc2hlZCB8fCBtc2cuc2VuZGVyID09IG93bmVyIHx8IGlzUHJlZmVycmVkVG9rZW5zQWNjb3VudFttc2cuc2VuZGVyXSk7CgogICAgICAgIC8vIHRyYW5zZmVycyBjYW4gYmUgZm9yYmlkZGVuIHVudGlsIGZpbmFsIElDTyBpcyBmaW5pc2hlZAogICAgICAgIC8vIGV4Y2VwdCBmb3IgbWFuYWdlciBhbmQgcHJlZmVycmVkIGFjY291bnRzCiAgICAgICAgcmVxdWlyZSh0cmFuc2ZlcnNCZXR3ZWVuU2FsZXNBbGxvd2VkIHx8IHNhbGVzQ291bnRlciA9PSBtYXhTYWxlc0FsbG93ZWQgfHwgbXNnLnNlbmRlciA9PSBvd25lciB8fCBpc1ByZWZlcnJlZFRva2Vuc0FjY291bnRbbXNnLnNlbmRlcl0pOwoKICAgICAgICAvLyBUcmFuc2ZlcnMgb2YgMCB2YWx1ZXMgTVVTVCBiZSB0cmVhdGVkIGFzIG5vcm1hbCB0cmFuc2ZlcnMgYW5kIGZpcmUgdGhlIFRyYW5zZmVyIGV2ZW50IChFUkMtMjApCiAgICAgICAgcmVxdWlyZShfdmFsdWUgPj0gMCk7CgogICAgICAgIC8vIFRoZSBmdW5jdGlvbiBTSE9VTEQgdGhyb3cgdW5sZXNzIHRoZSBfZnJvbSBhY2NvdW50IGhhcyBkZWxpYmVyYXRlbHkgYXV0aG9yaXplZCB0aGUgc2VuZGVyIG9mIHRoZSBtZXNzYWdlIHZpYSBzb21lIG1lY2hhbmlzbQogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBfZnJvbSB8fCBfdmFsdWUgPD0gYWxsb3dhbmNlW19mcm9tXVttc2cuc2VuZGVyXSk7CgogICAgICAgIC8vIGNoZWNrIGlmIF9mcm9tIGFjY291bnQgaGF2ZSByZXF1aXJlZCBhbW91bnQKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlT2ZbX2Zyb21dKTsKCiAgICAgICAgLy8gU3VidHJhY3QgZnJvbSB0aGUgc2VuZGVyCiAgICAgICAgYmFsYW5jZU9mW19mcm9tXSA9IGJhbGFuY2VPZltfZnJvbV0gLSBfdmFsdWU7CiAgICAgICAgLy8KICAgICAgICAvLyBBZGQgdGhlIHNhbWUgdG8gdGhlIHJlY2lwaWVudAogICAgICAgIGJhbGFuY2VPZltfdG9dID0gYmFsYW5jZU9mW190b10gKyBfdmFsdWU7CgogICAgICAgIC8vIElmIGFsbG93YW5jZSB1c2VkLCBjaGFuZ2UgYWxsb3dhbmNlcyBjb3JyZXNwb25kaW5nbHkKICAgICAgICBpZiAoX2Zyb20gIT0gbXNnLnNlbmRlcikgewogICAgICAgICAgICBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dhbmNlW19mcm9tXVttc2cuc2VuZGVyXSAtIF92YWx1ZTsKICAgICAgICB9CgogICAgICAgIC8vIGV2ZW50CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvYmxvYi9tYXN0ZXIvRUlQUy9laXAtMjAtdG9rZW4tc3RhbmRhcmQubWQjYXBwcm92ZQogICAgLy8gdGhlcmUgaXMgYW5kIGF0dGFjaywgc2VlOgogICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL0NPUklPTnBsYXRmb3JtL3NvbGlkaXR5L2lzc3Vlcy82LAogICAgLy8gaHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2ZpbGUvZC8wQnlNdE13Mmh1bDBFTjNOQ2FWRkhTRmR4UnpBL3ZpZXcKICAgIC8vIGJ1dCB0aGlzIGZ1bmN0aW9uIGlzIHJlcXVpcmVkIGJ5IEVSQy0yMAogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyl7CgogICAgICAgIHJlcXVpcmUoX3ZhbHVlID49IDApOwoKICAgICAgICBhbGxvd2FuY2VbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwoKICAgICAgICAvLyBldmVudAogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKiAgLS0tLS0tLS0tLSBJbnRlcmFjdGlvbiB3aXRoIG90aGVyIGNvbnRyYWN0cyAgKi8KCiAgICAvKiBVc2VyIGNhbiBhbGxvdyBhbm90aGVyIHNtYXJ0IGNvbnRyYWN0IHRvIHNwZW5kIHNvbWUgc2hhcmVzIGluIGhpcyBiZWhhbGYKICAgICogICh0aGlzIGZ1bmN0aW9uIHNob3VsZCBiZSBjYWxsZWQgYnkgdXNlciBpdHNlbGYpCiAgICAqICBAcGFyYW0gX3NwZW5kZXIgYW5vdGhlciBjb250cmFjdCdzIGFkZHJlc3MKICAgICogIEBwYXJhbSBfdmFsdWUgbnVtYmVyIG9mIHRva2VucwogICAgKiAgQHBhcmFtIF9leHRyYURhdGEgRGF0YSB0aGF0IGNhbiBiZSBzZW50IGZyb20gdXNlciB0byBhbm90aGVyIGNvbnRyYWN0IHRvIGJlIHByb2Nlc3NlZAogICAgKiAgYnl0ZXMgLSBkeW5hbWljYWxseS1zaXplZCBieXRlIGFycmF5LAogICAgKiAgc2VlIGh0dHA6Ly9zb2xpZGl0eS5yZWFkdGhlZG9jcy5pby9lbi92MC40LjE1L3R5cGVzLmh0bWwjZHluYW1pY2FsbHktc2l6ZWQtYnl0ZS1hcnJheQogICAgKiAgc2VlIHBvc3NpYmxlIGF0dGFjayBpbmZvcm1hdGlvbiBpbiBjb21tZW50cyB0byBmdW5jdGlvbiAnYXBwcm92ZScKICAgICogID4gdGhpcyBtYXkgYmUgdXNlZCB0byBjb252ZXJ0IHByZS1JQ08gdG9rZW5zIHRvIElDTyB0b2tlbnMKICAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlQW5kQ2FsbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2V4dHJhRGF0YSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewoKICAgICAgICBhcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUpOwoKICAgICAgICAvLyAnc3BlbmRlcicgaXMgYW5vdGhlciBjb250cmFjdCB0aGF0IGltcGxlbWVudHMgY29kZSBhcyBwcmVzY3JpYmVkIGluICdhbGxvd2FuY2VSZWNpcGllbnQnIGFib3ZlCiAgICAgICAgYWxsb3dhbmNlUmVjaXBpZW50IHNwZW5kZXIgPSBhbGxvd2FuY2VSZWNpcGllbnQoX3NwZW5kZXIpOwoKICAgICAgICAvLyBvdXIgY29udHJhY3QgY2FsbHMgJ3JlY2VpdmVBcHByb3ZhbCcgZnVuY3Rpb24gb2YgYW5vdGhlciBjb250cmFjdCAoJ2FsbG93YW5jZVJlY2lwaWVudCcpIHRvIHNlbmQgaW5mb3JtYXRpb24gYWJvdXQKICAgICAgICAvLyBhbGxvd2FuY2UgYW5kIGRhdGEgc2VudCBieSB1c2VyCiAgICAgICAgLy8gJ3RoaXMnIGlzIHRoaXMgKG91cikgY29udHJhY3QgYWRkcmVzcwogICAgICAgIGlmIChzcGVuZGVyLnJlY2VpdmVBcHByb3ZhbChtc2cuc2VuZGVyLCBfdmFsdWUsIHRoaXMsIF9leHRyYURhdGEpKSB7CiAgICAgICAgICAgIERhdGFTZW50VG9Bbm90aGVyQ29udHJhY3QobXNnLnNlbmRlciwgX3NwZW5kZXIsIF9leHRyYURhdGEpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgZWxzZSByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZUFsbEFuZENhbGwoYWRkcmVzcyBfc3BlbmRlciwgYnl0ZXMgX2V4dHJhRGF0YSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJldHVybiBhcHByb3ZlQW5kQ2FsbChfc3BlbmRlciwgYmFsYW5jZU9mW21zZy5zZW5kZXJdLCBfZXh0cmFEYXRhKTsKICAgIH0KCiAgICAvKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvNjc3CiAgICAqIHRyYW5zZmVyIHRva2VucyB3aXRoIGFkZGl0aW9uYWwgaW5mbyB0byBhbm90aGVyIHNtYXJ0IGNvbnRyYWN0LCBhbmQgY2FsbHMgaXRzIGNvcnJlc3BvbmRlbnQgZnVuY3Rpb24KICAgICogQHBhcmFtIGFkZHJlc3MgX3RvIC0gYW5vdGhlciBzbWFydCBjb250cmFjdCBhZGRyZXNzCiAgICAqIEBwYXJhbSB1aW50MjU2IF92YWx1ZSAtIG51bWJlciBvZiB0b2tlbnMKICAgICogQHBhcmFtIGJ5dGVzIF9leHRyYURhdGEgLSBkYXRhIHRvIHNlbmQgdG8gYW5vdGhlciBjb250cmFjdAogICAgKiA+IHRoaXMgbWF5IGJlIHVzZWQgdG8gY29udmVydCBwcmUtSUNPIHRva2VucyB0byBJQ08gdG9rZW5zCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJBbmRDYWxsKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2V4dHJhRGF0YSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyl7CgogICAgICAgIHRyYW5zZmVyRnJvbShtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CgogICAgICAgIHRva2VuUmVjaXBpZW50IHJlY2VpdmVyID0gdG9rZW5SZWNpcGllbnQoX3RvKTsKCiAgICAgICAgaWYgKHJlY2VpdmVyLnRva2VuRmFsbGJhY2sobXNnLnNlbmRlciwgX3ZhbHVlLCBfZXh0cmFEYXRhKSkgewogICAgICAgICAgICBEYXRhU2VudFRvQW5vdGhlckNvbnRyYWN0KG1zZy5zZW5kZXIsIF90bywgX2V4dHJhRGF0YSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICBlbHNlIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvLyBmb3IgZXhhbXBsZSBmb3IgY29udmV0aW5nIEFMTCB0b2tlbnMgb2YgdXNlciBhY2NvdW50IHRvIGFub3RoZXIgdG9rZW5zCiAgICBmdW5jdGlvbiB0cmFuc2ZlckFsbEFuZENhbGwoYWRkcmVzcyBfdG8sIGJ5dGVzIF9leHRyYURhdGEpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpewogICAgICAgIHJldHVybiB0cmFuc2ZlckFuZENhbGwoX3RvLCBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0sIF9leHRyYURhdGEpOwogICAgfQoKICAgIC8qIC0tLSBBZG1pbmlzdHJhdGl2ZSBmdW5jdGlvbnMgKi8KCiAgICBmdW5jdGlvbiBjaGFuZ2VPd25lcihhZGRyZXNzIF9uZXdPd25lcikgcHVibGljIG9ubHlCeShvd25lcikgcmV0dXJucyAoYm9vbCBzdWNjZXNzKXsKICAgICAgICAvLwogICAgICAgIHJlcXVpcmUoX25ld093bmVyICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICBhZGRyZXNzIG9sZE93bmVyID0gb3duZXI7CiAgICAgICAgb3duZXIgPSBfbmV3T3duZXI7CgogICAgICAgIE93bmVyQ2hhbmdlZChvbGRPd25lciwgX25ld093bmVyKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyogLS0tLS0tLS0tLSBDcmVhdGUgYW5kIHNlbGwgdG9rZW5zICAqLwoKICAgIC8qIHNldCB0aW1lIGZvciBzdGFydCBhbmQgdGltZSBmb3IgZW5kIHByZS1JQ08KICAgICogdGltZSBpcyBpbnRlZ2VyIHJlcHJlc2VudGluZyBibG9jayB0aW1lc3RhbXAKICAgICogaW4gVU5JWCBUaW1lLAogICAgKiBzZWU6IGh0dHBzOi8vd3d3LmVwb2NoY29udmVydGVyLmNvbQogICAgKiBAcGFyYW0gdWludDI1NiBzdGFydFRpbWUgLSB0aW1lIHRvIHN0YXJ0CiAgICAqIEBwYXJhbSB1aW50MjU2IGVuZFRpbWUgLSB0aW1lIHRvIGVuZAogICAgKiBzaG91bGQgYmUgdGFrZW4gaW50byBhY2NvdW50IHRoYXQKICAgICogImJsb2NrLnRpbWVzdGFtcCIgY2FuIGJlIGluZmx1ZW5jZWQgYnkgbWluZXJzIHRvIGEgY2VydGFpbiBkZWdyZWUuCiAgICAqIFRoYXQgbWVhbnMgdGhhdCBhIG1pbmVyIGNhbiAiY2hvb3NlIiB0aGUgYmxvY2sudGltZXN0YW1wLCB0byBhIGNlcnRhaW4gZGVncmVlLAogICAgKiB0byBjaGFuZ2UgdGhlIG91dGNvbWUgb2YgYSB0cmFuc2FjdGlvbiBpbiB0aGUgbWluZWQgYmxvY2suCiAgICAqIHNlZToKICAgICogaHR0cDovL3NvbGlkaXR5LnJlYWR0aGVkb2NzLmlvL2VuL3YwLjQuMTUvZnJlcXVlbnRseS1hc2tlZC1xdWVzdGlvbnMuaHRtbCNhcmUtdGltZXN0YW1wcy1ub3ctYmxvY2stdGltZXN0YW1wLXJlbGlhYmxlCiAgICAqLwoKICAgIGZ1bmN0aW9uIHN0YXJ0U2FsZSh1aW50MjU2IF9zdGFydFVuaXhUaW1lLCB1aW50MjU2IF9lbmRVbml4VGltZSkgcHVibGljIG9ubHlCeShvd25lcikgcmV0dXJucyAoYm9vbCBzdWNjZXNzKXsKCiAgICAgICAgcmVxdWlyZShiYWxhbmNlT2ZbdGhpc10gPiAwKTsKICAgICAgICByZXF1aXJlKHNhbGVzQ291bnRlciA8IG1heFNhbGVzQWxsb3dlZCk7CgogICAgICAgIC8vIHRpbWUgZm9yIHNhbGUgY2FuIGJlIHNldCBvbmx5IGlmOgogICAgICAgIC8vIHRoaXMgaXMgZmlyc3Qgc2FsZSAoc2FsZVN0YXJ0VW5peFRpbWUgPT0gMCAmJiBzYWxlRW5kVW5peFRpbWUgPT0gMCkgLCBvcjoKICAgICAgICAvLyBwcmV2aW91cyBzYWxlIGZpbmlzaGVkICggc2FsZUlzRmluaXNoZWQoKSApCiAgICAgICAgcmVxdWlyZSgKICAgICAgICAoc2FsZVN0YXJ0VW5peFRpbWUgPT0gMCAmJiBzYWxlRW5kVW5peFRpbWUgPT0gMCkgfHwgc2FsZUlzRmluaXNoZWQoKQogICAgICAgICk7CiAgICAgICAgLy8gdGltZSBjYW4gYmUgc2V0IG9ubHkgZm9yIGZ1dHVyZQogICAgICAgIHJlcXVpcmUoX3N0YXJ0VW5peFRpbWUgPiBub3cgJiYgX2VuZFVuaXhUaW1lID4gbm93KTsKICAgICAgICAvLyBlbmQgdGltZSBzaG91bGQgYmUgbGF0ZXIgdGhhbiBzdGFydCB0aW1lCiAgICAgICAgcmVxdWlyZShfZW5kVW5peFRpbWUgLSBfc3RhcnRVbml4VGltZSA+IDApOwoKICAgICAgICBzYWxlU3RhcnRVbml4VGltZSA9IF9zdGFydFVuaXhUaW1lOwogICAgICAgIHNhbGVFbmRVbml4VGltZSA9IF9lbmRVbml4VGltZTsKICAgICAgICBzYWxlc0NvdW50ZXIgPSBzYWxlc0NvdW50ZXIgKyAxOwoKICAgICAgICBTYWxlU3RhcnRlZChfc3RhcnRVbml4VGltZSwgX2VuZFVuaXhUaW1lLCBzYWxlc0NvdW50ZXIpOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBzYWxlSXNSdW5uaW5nKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpewoKICAgICAgICBpZiAoYmFsYW5jZU9mW3RoaXNdID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHNhbGVTdGFydFVuaXhUaW1lID09IDAgJiYgc2FsZUVuZFVuaXhUaW1lID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgaWYgKG5vdyA+IHNhbGVTdGFydFVuaXhUaW1lICYmIG5vdyA8IHNhbGVFbmRVbml4VGltZSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBmdW5jdGlvbiBzYWxlSXNGaW5pc2hlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKXsKCiAgICAgICAgaWYgKGJhbGFuY2VPZlt0aGlzXSA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgZWxzZSBpZiAoCiAgICAgICAgKHNhbGVTdGFydFVuaXhUaW1lID4gMCAmJiBzYWxlRW5kVW5peFRpbWUgPiAwKQogICAgICAgICYmIG5vdyA+IHNhbGVFbmRVbml4VGltZSkgewoKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICAvLyA8PDwKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlUHJpY2VTZXR0ZXIoYWRkcmVzcyBfcHJpY2VTZXR0ZXIpIHB1YmxpYyBvbmx5Qnkob3duZXIpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHByaWNlU2V0dGVyID0gX3ByaWNlU2V0dGVyOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldE1pbk1heFByaWNlSW5XZWkodWludDI1NiBfcHJpY2VNaW5XZWksIHVpbnQyNTYgX3ByaWNlTWF4V2VpKSBwdWJsaWMgb25seUJ5KG93bmVyKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpewogICAgICAgIHJlcXVpcmUoX3ByaWNlTWluV2VpID49IDAgJiYgX3ByaWNlTWF4V2VpID49IDApOwogICAgICAgIHByaWNlTWluV2VpID0gX3ByaWNlTWluV2VpOwogICAgICAgIHByaWNlTWF4V2VpID0gX3ByaWNlTWF4V2VpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKCiAgICBmdW5jdGlvbiBzZXRUb2tlblByaWNlSW5XZWkodWludDI1NiBfcHJpY2VJbldlaSkgcHVibGljIG9ubHlCeShwcmljZVNldHRlcikgcmV0dXJucyAoYm9vbCBzdWNjZXNzKXsKCiAgICAgICAgcmVxdWlyZShfcHJpY2VJbldlaSA+PSAwKTsKCiAgICAgICAgLy8gaWYgMCAtIG5vdCBzZXQKICAgICAgICBpZiAocHJpY2VNaW5XZWkgIT0gMCAmJiBfcHJpY2VJbldlaSA8IHByaWNlTWluV2VpKSB7CiAgICAgICAgICAgIHRva2VuUHJpY2VJbldlaSA9IHByaWNlTWluV2VpOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChwcmljZU1heFdlaSAhPSAwICYmIF9wcmljZUluV2VpID4gcHJpY2VNYXhXZWkpIHsKICAgICAgICAgICAgdG9rZW5QcmljZUluV2VpID0gcHJpY2VNYXhXZWk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICB0b2tlblByaWNlSW5XZWkgPSBfcHJpY2VJbldlaTsKICAgICAgICB9CgogICAgICAgIFByaWNlQ2hhbmdlZCh0b2tlblByaWNlSW5XZWkpOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBhbGxvd3Mgc2VuZGluZyBldGhlciBhbmQgcmVjZWl2aW5nIHRva2VucyBqdXN0IHVzaW5nIGNvbnRyYWN0IGFkZHJlc3MKICAgIC8vIHdhcm5pbmc6CiAgICAvLyAnSWYgdGhlIGZhbGxiYWNrIGZ1bmN0aW9uIHJlcXVpcmVzIG1vcmUgdGhhbiAyMzAwIGdhcywgdGhlIGNvbnRyYWN0IGNhbm5vdCByZWNlaXZlIEV0aGVyJwogICAgLy8gc2VlOgogICAgLy8gaHR0cHM6Ly9ldGhlcmV1bS5zdGFja2V4Y2hhbmdlLmNvbS9xdWVzdGlvbnMvMjE2NDMvZmFsbGJhY2stZnVuY3Rpb24tYmVzdC1wcmFjdGljZXMtd2hlbi1yZWdpc3RlcmluZy1pbmZvcm1hdGlvbgogICAgZnVuY3Rpb24oKSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgYnV5VG9rZW5zKCk7CiAgICB9CgogICAgLy8KICAgIGZ1bmN0aW9uIGJ1eVRva2VucygpIHB1YmxpYyBwYXlhYmxlIHJldHVybnMgKGJvb2wgc3VjY2Vzcyl7CgogICAgICAgIGlmIChzYWxlSXNSdW5uaW5nKCkgJiYgdG9rZW5QcmljZUluV2VpID4gMCkgewoKICAgICAgICAgICAgdWludDI1NiBudW1iZXJPZlRva2VucyA9IG1zZy52YWx1ZSAvIHRva2VuUHJpY2VJbldlaTsKCiAgICAgICAgICAgIGlmIChudW1iZXJPZlRva2VucyA8PSBiYWxhbmNlT2ZbdGhpc10pIHsKCiAgICAgICAgICAgICAgICBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPSBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gKyBudW1iZXJPZlRva2VuczsKICAgICAgICAgICAgICAgIGJhbGFuY2VPZlt0aGlzXSA9IGJhbGFuY2VPZlt0aGlzXSAtIG51bWJlck9mVG9rZW5zOwoKICAgICAgICAgICAgICAgIE5ld1Rva2Vuc1NvbGQobnVtYmVyT2ZUb2tlbnMsIG1zZy5zZW5kZXIsIHRva2VuUHJpY2VJbldlaSk7CgogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAvLyAocGF5YWJsZSkKICAgICAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAvLyAocGF5YWJsZSkKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qICBBZnRlciBzYWxlIGNvbnRyYWN0IG93bmVyCiAgICAqICAoY2FuIGJlIGFub3RoZXIgY29udHJhY3Qgb3IgYWNjb3VudCkKICAgICogIGNhbiB3aXRoZHJhdyBhbGwgY29sbGVjdGVkIEV0aGVyCiAgICAqLwogICAgZnVuY3Rpb24gd2l0aGRyYXdBbGxUb093bmVyKCkgcHVibGljIG9ubHlCeShvd25lcikgcmV0dXJucyAoYm9vbCkgewoKICAgICAgICAvLyBvbmx5IGFmdGVyIHNhbGUgaXMgZmluaXNoZWQ6CiAgICAgICAgcmVxdWlyZShzYWxlSXNGaW5pc2hlZCgpKTsKICAgICAgICB1aW50MjU2IHN1bUluV2VpID0gdGhpcy5iYWxhbmNlOwoKICAgICAgICBpZiAoCiAgICAgICAgLy8gbWFrZXMgd2l0aGRyYXdhbCBhbmQgcmV0dXJucyB0cnVlIG9yIGZhbHNlCiAgICAgICAgIW1zZy5zZW5kZXIuc2VuZCh0aGlzLmJhbGFuY2UpCiAgICAgICAgKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIC8vIGV2ZW50CiAgICAgICAgICAgIFdpdGhkcmF3YWwobXNnLnNlbmRlciwgc3VtSW5XZWkpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgLyogLS0tLS0tLS0tLSBSZWZlcnJhbCBTeXN0ZW0gKi8KCiAgICAvLyBsaXN0IG9mIHJlZ2lzdGVyZWQgcmVmZXJyZXJzCiAgICAvLyByZXByZXNlbnRlZCBieSBrZWNjYWsyNTYoYWRkcmVzcykgKHJldHVybnMgYnl0ZXMzMikKICAgIC8vICEgcmVmZXJyZXJzIGNhbiBub3QgYmUgcmVtb3ZlZCAhCiAgICBtYXBwaW5nIChieXRlczMyID0+IGJvb2wpIHByaXZhdGUgaXNSZWZlcnJlcjsKCiAgICB1aW50MjU2IHByaXZhdGUgcmVmZXJyYWxCb251cyA9IDA7CgogICAgdWludDI1NiBwcml2YXRlIHJlZmVycmVyQm9udXMgPSAwOwogICAgLy8gdG9rZW5zIG93bmVkIGJ5IHJlZmVycmVyczoKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludDI1NikgcHVibGljIHJlZmVycmVyQmFsYW5jZU9mOwoKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludCkgcHVibGljIHJlZmVycmVyTGlua2VkU2FsZXM7CgogICAgZnVuY3Rpb24gYWRkUmVmZXJyZXIoYnl0ZXMzMiBfcmVmZXJyZXIpIHB1YmxpYyBvbmx5Qnkob3duZXIpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyl7CiAgICAgICAgaXNSZWZlcnJlcltfcmVmZXJyZXJdID0gdHJ1ZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiByZW1vdmVSZWZlcnJlcihieXRlczMyIF9yZWZlcnJlcikgcHVibGljIG9ubHlCeShvd25lcikgcmV0dXJucyAoYm9vbCBzdWNjZXNzKXsKICAgICAgICBpc1JlZmVycmVyW19yZWZlcnJlcl0gPSBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBib251c2VzIGFyZSBzZXQgaW4gYXMgaW50ZWdlcnMgKDIwJSwgMzAlKSwgaW5pdGlhbCAwJQogICAgZnVuY3Rpb24gc2V0UmVmZXJyYWxCb251c2VzKHVpbnQyNTYgX3JlZmVycmFsQm9udXMsIHVpbnQyNTYgX3JlZmVycmVyQm9udXMpIHB1YmxpYyBvbmx5Qnkob3duZXIpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyl7CiAgICAgICAgcmVxdWlyZShfcmVmZXJyYWxCb251cyA+IDAgJiYgX3JlZmVycmVyQm9udXMgPiAwKTsKICAgICAgICByZWZlcnJhbEJvbnVzID0gX3JlZmVycmFsQm9udXM7CiAgICAgICAgcmVmZXJyZXJCb251cyA9IF9yZWZlcnJlckJvbnVzOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGJ1eVRva2Vuc1dpdGhSZWZlcnJlckFkZHJlc3MoYWRkcmVzcyBfcmVmZXJyZXIpIHB1YmxpYyBwYXlhYmxlIHJldHVybnMgKGJvb2wgc3VjY2Vzcyl7CgogICAgICAgIGJ5dGVzMzIgcmVmZXJyZXIgPSBrZWNjYWsyNTYoX3JlZmVycmVyKTsKCiAgICAgICAgaWYgKHNhbGVJc1J1bm5pbmcoKSAmJiB0b2tlblByaWNlSW5XZWkgPiAwKSB7CgogICAgICAgICAgICBpZiAoaXNSZWZlcnJlcltyZWZlcnJlcl0pIHsKCiAgICAgICAgICAgICAgICB1aW50MjU2IG51bWJlck9mVG9rZW5zID0gbXNnLnZhbHVlIC8gdG9rZW5QcmljZUluV2VpOwoKICAgICAgICAgICAgICAgIGlmIChudW1iZXJPZlRva2VucyA8PSBiYWxhbmNlT2ZbdGhpc10pIHsKCiAgICAgICAgICAgICAgICAgICAgcmVmZXJyZXJMaW5rZWRTYWxlc1tyZWZlcnJlcl0gPSByZWZlcnJlckxpbmtlZFNhbGVzW3JlZmVycmVyXSArIG51bWJlck9mVG9rZW5zOwoKICAgICAgICAgICAgICAgICAgICB1aW50MjU2IHJlZmVycmFsQm9udXNUb2tlbnMgPSAobnVtYmVyT2ZUb2tlbnMgKiAoMTAwICsgcmVmZXJyYWxCb251cykgLyAxMDApIC0gbnVtYmVyT2ZUb2tlbnM7CiAgICAgICAgICAgICAgICAgICAgdWludDI1NiByZWZlcnJlckJvbnVzVG9rZW5zID0gKG51bWJlck9mVG9rZW5zICogKDEwMCArIHJlZmVycmVyQm9udXMpIC8gMTAwKSAtIG51bWJlck9mVG9rZW5zOwoKICAgICAgICAgICAgICAgICAgICBiYWxhbmNlT2ZbdGhpc10gPSBiYWxhbmNlT2ZbdGhpc10gLSBudW1iZXJPZlRva2VucyAtIHJlZmVycmFsQm9udXNUb2tlbnMgLSByZWZlcnJlckJvbnVzVG9rZW5zOwoKICAgICAgICAgICAgICAgICAgICBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPSBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gKyAobnVtYmVyT2ZUb2tlbnMgKyByZWZlcnJhbEJvbnVzVG9rZW5zKTsKCiAgICAgICAgICAgICAgICAgICAgcmVmZXJyZXJCYWxhbmNlT2ZbcmVmZXJyZXJdID0gcmVmZXJyZXJCYWxhbmNlT2ZbcmVmZXJyZXJdICsgcmVmZXJyZXJCb251c1Rva2VuczsKCiAgICAgICAgICAgICAgICAgICAgTmV3VG9rZW5zU29sZChudW1iZXJPZlRva2VucyArIHJlZmVycmFsQm9udXNUb2tlbnMsIG1zZy5zZW5kZXIsIHRva2VuUHJpY2VJbldlaSk7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy8gKHBheWFibGUpCiAgICAgICAgICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAvLyAocGF5YWJsZSkKICAgICAgICAgICAgICAgIGJ1eVRva2VucygpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAvLyAocGF5YWJsZSkKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQogICAgfQoKICAgIGV2ZW50IFJlZmVycmVyQm9udXNUb2tlbnNUYWtlbihhZGRyZXNzIHJlZmVycmVyLCB1aW50MjU2IGJvbnVzVG9rZW5zVmFsdWUpOwoKICAgIGZ1bmN0aW9uIGdldFJlZmVycmVyQm9udXNUb2tlbnMoKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKXsKICAgICAgICByZXF1aXJlKHNhbGVJc0ZpbmlzaGVkKCkpOwogICAgICAgIHVpbnQyNTYgYm9udXNUb2tlbnMgPSByZWZlcnJlckJhbGFuY2VPZltrZWNjYWsyNTYobXNnLnNlbmRlcildOwogICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSA9IGJhbGFuY2VPZlttc2cuc2VuZGVyXSArIGJvbnVzVG9rZW5zOwogICAgICAgIFJlZmVycmVyQm9udXNUb2tlbnNUYWtlbihtc2cuc2VuZGVyLCBib251c1Rva2Vucyk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cgp9'.
	

]
