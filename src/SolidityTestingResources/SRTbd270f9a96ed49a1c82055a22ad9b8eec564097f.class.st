Class {
	#name : #SRTbd270f9a96ed49a1c82055a22ad9b8eec564097f,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTbd270f9a96ed49a1c82055a22ad9b8eec564097f >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjE7CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnRyYWN0cyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93IChpLmUuIGlmIHN1YnRyYWhlbmQgaXMgZ3JlYXRlciB0aGFuIG1pbnVlbmQpLgogICovCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgLyoqCiAgKiBAZGV2IEFkZHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgoKLyoqCiAqIEB0aXRsZSBTYWZlRVJDMjAKICogQGRldiBXcmFwcGVycyBhcm91bmQgRVJDMjAgb3BlcmF0aW9ucyB0aGF0IHRocm93IG9uIGZhaWx1cmUuCiAqIFRvIHVzZSB0aGlzIGxpYnJhcnkgeW91IGNhbiBhZGQgYSBgdXNpbmcgU2FmZUVSQzIwIGZvciBFUkMyMDtgIHN0YXRlbWVudCB0byB5b3VyIGNvbnRyYWN0LAogKiB3aGljaCBhbGxvd3MgeW91IHRvIGNhbGwgdGhlIHNhZmUgb3BlcmF0aW9ucyBhcyBgdG9rZW4uc2FmZVRyYW5zZmVyKC4uLilgLCBldGMuCiAqLwpsaWJyYXJ5IFNhZmVFUkMyMCB7CiAgZnVuY3Rpb24gc2FmZVRyYW5zZmVyKEVSQzIwQmFzaWMgdG9rZW4sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHsKICAgIGFzc2VydCh0b2tlbi50cmFuc2Zlcih0bywgdmFsdWUpKTsKICB9CgogIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlckZyb20oRVJDMjAgdG9rZW4sIGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgaW50ZXJuYWwgewogICAgYXNzZXJ0KHRva2VuLnRyYW5zZmVyRnJvbShmcm9tLCB0bywgdmFsdWUpKTsKICB9CgogIGZ1bmN0aW9uIHNhZmVBcHByb3ZlKEVSQzIwIHRva2VuLCBhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHsKICAgIGFzc2VydCh0b2tlbi5hcHByb3ZlKHNwZW5kZXIsIHZhbHVlKSk7CiAgfQp9CgoKLyoqCiAqIEB0aXRsZSBDb250cmFjdHMgdGhhdCBzaG91bGQgYmUgYWJsZSB0byByZWNvdmVyIHRva2VucwogKiBAYXV0aG9yIFN5bFRpCiAqIEBkZXYgVGhpcyBhbGxvdyBhIGNvbnRyYWN0IHRvIHJlY292ZXIgYW55IEVSQzIwIHRva2VuIHJlY2VpdmVkIGluIGEgY29udHJhY3QgYnkgdHJhbnNmZXJyaW5nIHRoZSBiYWxhbmNlIHRvIHRoZSBjb250cmFjdCBvd25lci4KICogVGhpcyB3aWxsIHByZXZlbnQgYW55IGFjY2lkZW50YWwgbG9zcyBvZiB0b2tlbnMuCiAqLwpjb250cmFjdCBDYW5SZWNsYWltVG9rZW4gaXMgT3duYWJsZSB7CiAgdXNpbmcgU2FmZUVSQzIwIGZvciBFUkMyMEJhc2ljOwoKICAvKioKICAgKiBAZGV2IFJlY2xhaW0gYWxsIEVSQzIwQmFzaWMgY29tcGF0aWJsZSB0b2tlbnMKICAgKiBAcGFyYW0gdG9rZW4gRVJDMjBCYXNpYyBUaGUgYWRkcmVzcyBvZiB0aGUgdG9rZW4gY29udHJhY3QKICAgKi8KICBmdW5jdGlvbiByZWNsYWltVG9rZW4oRVJDMjBCYXNpYyB0b2tlbikgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIHVpbnQyNTYgYmFsYW5jZSA9IHRva2VuLmJhbGFuY2VPZih0aGlzKTsKICAgIHRva2VuLnNhZmVUcmFuc2Zlcihvd25lciwgYmFsYW5jZSk7CiAgfQoKfQoKCi8qKgogKiBAdGl0bGUgQ29udHJhY3RzIHRoYXQgc2hvdWxkIG5vdCBvd24gQ29udHJhY3RzCiAqIEBhdXRob3IgUmVtY28gQmxvZW1lbiA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjQ5M2IyYzI0MmEyNjA5N2IiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+z4AuY29tPgogKiBAZGV2IFNob3VsZCBjb250cmFjdHMgKGFueXRoaW5nIE93bmFibGUpIGVuZCB1cCBiZWluZyBvd25lZCBieSB0aGlzIGNvbnRyYWN0LCBpdCBhbGxvd3MgdGhlIG93bmVyCiAqIG9mIHRoaXMgY29udHJhY3QgdG8gcmVjbGFpbSBvd25lcnNoaXAgb2YgdGhlIGNvbnRyYWN0cy4KICovCmNvbnRyYWN0IEhhc05vQ29udHJhY3RzIGlzIE93bmFibGUgewoKICAvKioKICAgKiBAZGV2IFJlY2xhaW0gb3duZXJzaGlwIG9mIE93bmFibGUgY29udHJhY3RzCiAgICogQHBhcmFtIGNvbnRyYWN0QWRkciBUaGUgYWRkcmVzcyBvZiB0aGUgT3duYWJsZSB0byBiZSByZWNsYWltZWQuCiAgICovCiAgZnVuY3Rpb24gcmVjbGFpbUNvbnRyYWN0KGFkZHJlc3MgY29udHJhY3RBZGRyKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgT3duYWJsZSBjb250cmFjdEluc3QgPSBPd25hYmxlKGNvbnRyYWN0QWRkcik7CiAgICBjb250cmFjdEluc3QudHJhbnNmZXJPd25lcnNoaXAob3duZXIpOwogIH0KfQoKCi8qKgogKiBAdGl0bGUgQ29udHJhY3RzIHRoYXQgc2hvdWxkIG5vdCBvd24gVG9rZW5zCiAqIEBhdXRob3IgUmVtY28gQmxvZW1lbiA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImQ2YTRiM2JiYjViOTk2ZTQiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+z4AuY29tPgogKiBAZGV2IFRoaXMgYmxvY2tzIGluY29taW5nIEVSQzIyMyB0b2tlbnMgdG8gcHJldmVudCBhY2NpZGVudGFsIGxvc3Mgb2YgdG9rZW5zLgogKiBTaG91bGQgdG9rZW5zIChhbnkgRVJDMjBCYXNpYyBjb21wYXRpYmxlKSBlbmQgdXAgaW4gdGhlIGNvbnRyYWN0LCBpdCBhbGxvd3MgdGhlCiAqIG93bmVyIHRvIHJlY2xhaW0gdGhlIHRva2Vucy4KICovCmNvbnRyYWN0IEhhc05vVG9rZW5zIGlzIENhblJlY2xhaW1Ub2tlbiB7CgogLyoqCiAgKiBAZGV2IFJlamVjdCBhbGwgRVJDMjIzIGNvbXBhdGlibGUgdG9rZW5zCiAgKiBAcGFyYW0gZnJvbV8gYWRkcmVzcyBUaGUgYWRkcmVzcyB0aGF0IGlzIHRyYW5zZmVycmluZyB0aGUgdG9rZW5zCiAgKiBAcGFyYW0gdmFsdWVfIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0aGUgc3BlY2lmaWVkIHRva2VuCiAgKiBAcGFyYW0gZGF0YV8gQnl0ZXMgVGhlIGRhdGEgcGFzc2VkIGZyb20gdGhlIGNhbGxlci4KICAqLwogIGZ1bmN0aW9uIHRva2VuRmFsbGJhY2soYWRkcmVzcyBmcm9tXywgdWludDI1NiB2YWx1ZV8sIGJ5dGVzIGRhdGFfKSBleHRlcm5hbCB7CiAgICBmcm9tXzsKICAgIHZhbHVlXzsKICAgIGRhdGFfOwogICAgcmV2ZXJ0KCk7CiAgfQoKfQoKCi8qKgogKiBAdGl0bGUgQ29udHJhY3RzIHRoYXQgc2hvdWxkIG5vdCBvd24gRXRoZXIKICogQGF1dGhvciBSZW1jbyBCbG9lbWVuIDw8YSBocmVmPSIvY2RuLWNnaS9sL2VtYWlsLXByb3RlY3Rpb24iIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iOWJlOWZlZjZmOGY0ZGJhOSI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvYT7PgC5jb20+CiAqIEBkZXYgVGhpcyB0cmllcyB0byBibG9jayBpbmNvbWluZyBldGhlciB0byBwcmV2ZW50IGFjY2lkZW50YWwgbG9zcyBvZiBFdGhlci4gU2hvdWxkIEV0aGVyIGVuZCB1cAogKiBpbiB0aGUgY29udHJhY3QsIGl0IHdpbGwgYWxsb3cgdGhlIG93bmVyIHRvIHJlY2xhaW0gdGhpcyBldGhlci4KICogQG5vdGljZSBFdGhlciBjYW4gc3RpbGwgYmUgc2VuZCB0byB0aGlzIGNvbnRyYWN0IGJ5OgogKiBjYWxsaW5nIGZ1bmN0aW9ucyBsYWJlbGVkIGBwYXlhYmxlYAogKiBgc2VsZmRlc3RydWN0KGNvbnRyYWN0X2FkZHJlc3MpYAogKiBtaW5pbmcgZGlyZWN0bHkgdG8gdGhlIGNvbnRyYWN0IGFkZHJlc3MKKi8KY29udHJhY3QgSGFzTm9FdGhlciBpcyBPd25hYmxlIHsKCiAgLyoqCiAgKiBAZGV2IENvbnN0cnVjdG9yIHRoYXQgcmVqZWN0cyBpbmNvbWluZyBFdGhlcgogICogQGRldiBUaGUgYHBheWFibGVgIGZsYWcgaXMgYWRkZWQgc28gd2UgY2FuIGFjY2VzcyBgbXNnLnZhbHVlYCB3aXRob3V0IGNvbXBpbGVyIHdhcm5pbmcuIElmIHdlCiAgKiBsZWF2ZSBvdXQgcGF5YWJsZSwgdGhlbiBTb2xpZGl0eSB3aWxsIGFsbG93IGluaGVyaXRpbmcgY29udHJhY3RzIHRvIGltcGxlbWVudCBhIHBheWFibGUKICAqIGNvbnN0cnVjdG9yLiBCeSBkb2luZyBpdCB0aGlzIHdheSB3ZSBwcmV2ZW50IGEgcGF5YWJsZSBjb25zdHJ1Y3RvciBmcm9tIHdvcmtpbmcuIEFsdGVybmF0aXZlbHkKICAqIHdlIGNvdWxkIHVzZSBhc3NlbWJseSB0byBhY2Nlc3MgbXNnLnZhbHVlLgogICovCiAgZnVuY3Rpb24gSGFzTm9FdGhlcigpIHB1YmxpYyBwYXlhYmxlIHsKICAgIHJlcXVpcmUobXNnLnZhbHVlID09IDApOwogIH0KCiAgLyoqCiAgICogQGRldiBEaXNhbGxvd3MgZGlyZWN0IHNlbmQgYnkgc2V0dGluZ3MgYSBkZWZhdWx0IGZ1bmN0aW9uIHdpdGhvdXQgdGhlIGBwYXlhYmxlYCBmbGFnLgogICAqLwogIGZ1bmN0aW9uKCkgZXh0ZXJuYWwgewogIH0KCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciBhbGwgRXRoZXIgaGVsZCBieSB0aGUgY29udHJhY3QgdG8gdGhlIG93bmVyLgogICAqLwogIGZ1bmN0aW9uIHJlY2xhaW1FdGhlcigpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICBhc3NlcnQob3duZXIuc2VuZCh0aGlzLmJhbGFuY2UpKTsKICB9Cn0KCgovKioKICogQHRpdGxlIEJhc2UgY29udHJhY3QgZm9yIGNvbnRyYWN0cyB0aGF0IHNob3VsZCBub3Qgb3duIHRoaW5ncy4KICogQGF1dGhvciBSZW1jbyBCbG9lbWVuIDw8YSBocmVmPSIvY2RuLWNnaS9sL2VtYWlsLXByb3RlY3Rpb24iIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iMjE1MzQ0NGM0MjRlNjExMyI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvYT7PgC5jb20+CiAqIEBkZXYgU29sdmVzIGEgY2xhc3Mgb2YgZXJyb3JzIHdoZXJlIGEgY29udHJhY3QgYWNjaWRlbnRhbGx5IGJlY29tZXMgb3duZXIgb2YgRXRoZXIsIFRva2VucyBvcgogKiBPd25lZCBjb250cmFjdHMuIFNlZSByZXNwZWN0aXZlIGJhc2UgY29udHJhY3RzIGZvciBkZXRhaWxzLgogKi8KY29udHJhY3QgTm9Pd25lciBpcyBIYXNOb0V0aGVyLCBIYXNOb1Rva2VucywgSGFzTm9Db250cmFjdHMgewp9CgoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICB1aW50MjU2IHRvdGFsU3VwcGx5XzsKCiAgLyoqCiAgKiBAZGV2IHRvdGFsIG51bWJlciBvZiB0b2tlbnMgaW4gZXhpc3RlbmNlCiAgKi8KICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiB0b3RhbFN1cHBseV87CiAgfQoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cgp9CgoKLyoqCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbgogKgogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgaW50ZXJuYWwgYWxsb3dlZDsKCgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1tfZnJvbV0pOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0pOwoKICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAqCiAgICogQmV3YXJlIHRoYXQgY2hhbmdpbmcgYW4gYWxsb3dhbmNlIHdpdGggdGhpcyBtZXRob2QgYnJpbmdzIHRoZSByaXNrIHRoYXQgc29tZW9uZSBtYXkgdXNlIGJvdGggdGhlIG9sZAogICAqIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZSB0cmFuc2FjdGlvbiBvcmRlcmluZy4gT25lIHBvc3NpYmxlIHNvbHV0aW9uIHRvIG1pdGlnYXRlIHRoaXMKICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CgogIC8qKgogICAqIEBkZXYgSW5jcmVhc2UgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKgogICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAogICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfYWRkZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBpbmNyZWFzZSB0aGUgYWxsb3dhbmNlIGJ5LgogICAqLwogIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRGVjcmVhc2UgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKgogICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGRlY3JlbWVudAogICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3VidHJhY3RlZFZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGRlY3JlYXNlIHRoZSBhbGxvd2FuY2UgYnkuCiAgICovCiAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCgovKioKICogQHRpdGxlIEJldGV4VG9rZW4KICovCmNvbnRyYWN0IEJldGV4VG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgTm9Pd25lciB7CgogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIkJldGV4IFRva2VuIjsgLy8gc29saXVtLWRpc2FibGUtbGluZSB1cHBlcmNhc2UKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIkJFVEVYIjsgLy8gc29saXVtLWRpc2FibGUtbGluZSB1cHBlcmNhc2UKICAgIHVpbnQ4IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OyAvLyBzb2xpdW0tZGlzYWJsZS1saW5lIHVwcGVyY2FzZQoKICAgIC8vIHRyYW5zZmVyIHVubG9jayB0aW1lIChleGNlcHQgdGVhbSBhbmQgYnJva2VyIHJlY2lwaWVudHMpCiAgICB1aW50MjU2IHB1YmxpYyBmaXJzdFVubG9ja1RpbWU7CgogICAgLy8gdHJhbnNmZXIgdW5sb2NrIHRpbWUgZm9yIHRoZSB0ZWFtIGFuZCBicm9rZXIgcmVjaXBpZW50cwogICAgdWludDI1NiBwdWJsaWMgc2Vjb25kVW5sb2NrVGltZTsgCgogICAgLy8gYWRkcmVzc2VzIGxvY2tlZCB0aWxsIHNlY29uZCB1bmxvY2sgdGltZQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgYmxvY2tlZFRpbGxTZWNvbmRVbmxvY2s7CgogICAgLy8gdG9rZW4gaG9sZGVycwogICAgYWRkcmVzc1tdIHB1YmxpYyBob2xkZXJzOwoKICAgIC8vIGhvbGRlciBudW1iZXIKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGhvbGRlck51bWJlcjsKCiAgICAvLyBJQ08gYWRkcmVzcwogICAgYWRkcmVzcyBwdWJsaWMgaWNvQWRkcmVzczsKCiAgICAvLyBzdXBwbHkgY29uc3RhbnRzCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBUT1RBTF9TVVBQTFkgPSAxMDAwMDAwMCAqICgxMCAqKiB1aW50MjU2KGRlY2ltYWxzKSk7CiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBTQUxFX1NVUFBMWSA9IDUwMDAwMDAgKiAoMTAgKiogdWludDI1NihkZWNpbWFscykpOwoKICAgIC8vIGZ1bmRzIHN1cHBseSBjb25zdGFudHMKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IEJPVU5UWV9TVVBQTFkgPSAyMDAwMDAgKiAoMTAgKiogdWludDI1NihkZWNpbWFscykpOwogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgUkVTRVJWRV9TVVBQTFkgPSA4MDAwMDAgKiAoMTAgKiogdWludDI1NihkZWNpbWFscykpOwogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgQlJPS0VSX1JFU0VSVkVfU1VQUExZID0gMTAwMDAwMCAqICgxMCAqKiB1aW50MjU2KGRlY2ltYWxzKSk7CiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBURUFNX1NVUFBMWSA9IDMwMDAwMDAgKiAoMTAgKiogdWludDI1NihkZWNpbWFscykpOwoKICAgIC8vIGZ1bmRzIGFkZHJlc3NlcyBjb25zdGFudHMKICAgIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IEJPVU5UWV9BRERSRVNTID0gMHg0OGMxNWU1QTkzNDNFMzIyMGNkRDgxMjc2MjBBRTI4NkEyMDQ0NDhhOwogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgUkVTRVJWRV9BRERSRVNTID0gMHhDOGZFNjU5QWFlRjczYjZlNDFERWU0MjdjOTg5MTUwZTNlREFmNTdEOwogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgQlJPS0VSX1JFU0VSVkVfQUREUkVTUyA9IDB4ODY5N2Q0NjE3MWFCQ2FEMmRDNUE0MDYxYjhDMzVmOTA5YTQwMjQxNzsKICAgIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IFRFQU1fQUREUkVTUyA9IDB4MTc2MTk4OEYwMkM3NUU3YzM0MzJmYTMxZDE3OWNhZDZDNTg0M0YyNDsKCiAgICAvLyBtaW4gdG9rZW5zIHRvIGJlIGEgaG9sZGVyLCAwLjEKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IE1JTl9IT0xERVJfVE9LRU5TID0gMTAgKiogdWludDI1NihkZWNpbWFscyAtIDEpOwogICAgCiAgICAvKioKICAgICAqIEBkZXYgQ29uc3RydWN0b3IKICAgICAqIEBwYXJhbSBfZmlyc3RVbmxvY2tUaW1lIGZpcnN0IHVubG9jayB0aW1lCiAgICAgKiBAcGFyYW0gX3NlY29uZFVubG9ja1RpbWUgc2Vjb25kIHVubG9jayB0aW1lCiAgICAgKi8KICAgIGZ1bmN0aW9uIEJldGV4VG9rZW4KICAgICgKICAgICAgICB1aW50MjU2IF9maXJzdFVubG9ja1RpbWUsIAogICAgICAgIHVpbnQyNTYgX3NlY29uZFVubG9ja1RpbWUKICAgICkKICAgICAgICBwdWJsaWMgCiAgICB7ICAgICAgICAKICAgICAgICByZXF1aXJlKF9zZWNvbmRVbmxvY2tUaW1lID4gZmlyc3RVbmxvY2tUaW1lKTsKCiAgICAgICAgZmlyc3RVbmxvY2tUaW1lID0gX2ZpcnN0VW5sb2NrVGltZTsKICAgICAgICBzZWNvbmRVbmxvY2tUaW1lID0gX3NlY29uZFVubG9ja1RpbWU7CgogICAgICAgIC8vIEFsbG9jYXRlIHRva2VucyB0byB0aGUgYm91bnR5IGZ1bmQKICAgICAgICBiYWxhbmNlc1tCT1VOVFlfQUREUkVTU10gPSBCT1VOVFlfU1VQUExZOwogICAgICAgIGhvbGRlcnMucHVzaChCT1VOVFlfQUREUkVTUyk7CiAgICAgICAgZW1pdCBUcmFuc2ZlcigweDAsIEJPVU5UWV9BRERSRVNTLCBCT1VOVFlfU1VQUExZKTsKCiAgICAgICAgLy8gQWxsb2NhdGUgdG9rZW5zIHRvIHRoZSByZXNlcnZlIGZ1bmQKICAgICAgICBiYWxhbmNlc1tSRVNFUlZFX0FERFJFU1NdID0gUkVTRVJWRV9TVVBQTFk7CiAgICAgICAgaG9sZGVycy5wdXNoKFJFU0VSVkVfQUREUkVTUyk7CiAgICAgICAgZW1pdCBUcmFuc2ZlcigweDAsIFJFU0VSVkVfQUREUkVTUywgUkVTRVJWRV9TVVBQTFkpOwoKICAgICAgICAvLyBBbGxvY2F0ZSB0b2tlbnMgdG8gdGhlIGJyb2tlciByZXNlcnZlIGZ1bmQKICAgICAgICBiYWxhbmNlc1tCUk9LRVJfUkVTRVJWRV9BRERSRVNTXSA9IEJST0tFUl9SRVNFUlZFX1NVUFBMWTsKICAgICAgICBob2xkZXJzLnB1c2goQlJPS0VSX1JFU0VSVkVfQUREUkVTUyk7CiAgICAgICAgZW1pdCBUcmFuc2ZlcigweDAsIEJST0tFUl9SRVNFUlZFX0FERFJFU1MsIEJST0tFUl9SRVNFUlZFX1NVUFBMWSk7CgogICAgICAgIC8vIEFsbG9jYXRlIHRva2VucyB0byB0aGUgdGVhbSBmdW5kCiAgICAgICAgYmFsYW5jZXNbVEVBTV9BRERSRVNTXSA9IFRFQU1fU1VQUExZOwogICAgICAgIGhvbGRlcnMucHVzaChURUFNX0FERFJFU1MpOwogICAgICAgIGVtaXQgVHJhbnNmZXIoMHgwLCBURUFNX0FERFJFU1MsIFRFQU1fU1VQUExZKTsKCiAgICAgICAgdG90YWxTdXBwbHlfID0gVE9UQUxfU1VQUExZLnN1YihTQUxFX1NVUFBMWSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IHNldCBJQ08gYWRkcmVzcyBhbmQgYWxsb2NhdGUgc2FsZSBzdXBwbHkgdG8gaXQKICAgICAqLwogICAgZnVuY3Rpb24gc2V0SUNPKGFkZHJlc3MgX2ljb0FkZHJlc3MpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoX2ljb0FkZHJlc3MgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShpY29BZGRyZXNzID09IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUodG90YWxTdXBwbHlfID09IFRPVEFMX1NVUFBMWS5zdWIoU0FMRV9TVVBQTFkpKTsKICAgICAgICAKICAgICAgICAvLyBBbGxvY2F0ZSB0b2tlbnMgdG8gdGhlIGljbyBjb250cmFjdAogICAgICAgIGJhbGFuY2VzW19pY29BZGRyZXNzXSA9IFNBTEVfU1VQUExZOwogICAgICAgIGVtaXQgVHJhbnNmZXIoMHgwLCBfaWNvQWRkcmVzcywgU0FMRV9TVVBQTFkpOwoKICAgICAgICBpY29BZGRyZXNzID0gX2ljb0FkZHJlc3M7CiAgICAgICAgdG90YWxTdXBwbHlfID0gVE9UQUxfU1VQUExZOwogICAgfQogICAgCiAgICAvLyBzdGFuZGFyZCB0cmFuc2ZlciBmdW5jdGlvbiB3aXRoIHRpbWVsb2NrcwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUodHJhbnNmZXJBbGxvd2VkKG1zZy5zZW5kZXIpKTsKICAgICAgICBlbmZvcmNlU2Vjb25kTG9jayhtc2cuc2VuZGVyLCBfdG8pOwogICAgICAgIHByZXNlcnZlSG9sZGVycyhtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICAvLyBzdGFuZGFyZCB0cmFuc2ZlckZyb20gZnVuY3Rpb24gd2l0aCB0aW1lbG9ja3MKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZSh0cmFuc2ZlckFsbG93ZWQobXNnLnNlbmRlcikpOwogICAgICAgIGVuZm9yY2VTZWNvbmRMb2NrKG1zZy5zZW5kZXIsIF90byk7CiAgICAgICAgcHJlc2VydmVIb2xkZXJzKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIC8vIGdldCBob2xkZXJzIGNvdW50CiAgICBmdW5jdGlvbiBnZXRIb2xkZXJzQ291bnQoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGhvbGRlcnMubGVuZ3RoOwogICAgfQoKICAgIC8vIGVuZm9yY2Ugc2Vjb25kIGxvY2sgb24gcmVjZWl2ZXIKICAgIGZ1bmN0aW9uIGVuZm9yY2VTZWNvbmRMb2NrKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvKSBpbnRlcm5hbCB7CiAgICAgICAgaWYgKG5vdyA8IHNlY29uZFVubG9ja1RpbWUpIHsgLy8gc29saXVtLWRpc2FibGUtbGluZSBzZWN1cml0eS9uby1ibG9jay1tZW1iZXJzCiAgICAgICAgICAgIGlmIChfZnJvbSA9PSBURUFNX0FERFJFU1MgfHwgX2Zyb20gPT0gQlJPS0VSX1JFU0VSVkVfQUREUkVTUykgewogICAgICAgICAgICAgICAgcmVxdWlyZShiYWxhbmNlc1tfdG9dID09IHVpbnQyNTYoMCkgfHwgYmxvY2tlZFRpbGxTZWNvbmRVbmxvY2tbX3RvXSk7CiAgICAgICAgICAgICAgICBibG9ja2VkVGlsbFNlY29uZFVubG9ja1tfdG9dID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvLyBwcmVzZXJ2ZSBob2xkZXJzIGxpc3QKICAgIGZ1bmN0aW9uIHByZXNlcnZlSG9sZGVycyhhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIGludGVybmFsIHsKICAgICAgICBpZiAoYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpIDwgTUlOX0hPTERFUl9UT0tFTlMpIAogICAgICAgICAgICByZW1vdmVIb2xkZXIoX2Zyb20pOwogICAgICAgIGlmIChiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpID49IE1JTl9IT0xERVJfVE9LRU5TKSAKICAgICAgICAgICAgYWRkSG9sZGVyKF90byk7ICAgCiAgICB9CgogICAgLy8gcmVtb3ZlIGhvbGRlciBmcm9tIHRoZSBob2xkZXJzIGxpc3QKICAgIGZ1bmN0aW9uIHJlbW92ZUhvbGRlcihhZGRyZXNzIF9ob2xkZXIpIGludGVybmFsIHsKICAgICAgICB1aW50MjU2IF9udW1iZXIgPSBob2xkZXJOdW1iZXJbX2hvbGRlcl07CgogICAgICAgIGlmIChfbnVtYmVyID09IDAgfHwgaG9sZGVycy5sZW5ndGggPT0gMCB8fCBfbnVtYmVyID4gaG9sZGVycy5sZW5ndGgpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgdWludDI1NiBfaW5kZXggPSBfbnVtYmVyLnN1YigxKTsKICAgICAgICB1aW50MjU2IF9sYXN0SW5kZXggPSBob2xkZXJzLmxlbmd0aC5zdWIoMSk7CiAgICAgICAgYWRkcmVzcyBfbGFzdEhvbGRlciA9IGhvbGRlcnNbX2xhc3RJbmRleF07CgogICAgICAgIGlmIChfaW5kZXggIT0gX2xhc3RJbmRleCkgewogICAgICAgICAgICBob2xkZXJzW19pbmRleF0gPSBfbGFzdEhvbGRlcjsKICAgICAgICAgICAgaG9sZGVyTnVtYmVyW19sYXN0SG9sZGVyXSA9IF9udW1iZXI7CiAgICAgICAgfQoKICAgICAgICBob2xkZXJOdW1iZXJbX2hvbGRlcl0gPSAwOwogICAgICAgIGhvbGRlcnMubGVuZ3RoID0gX2xhc3RJbmRleDsKICAgIH0gCgogICAgLy8gYWRkIGhvbGRlciB0byB0aGUgaG9sZGVycyBsaXN0CiAgICBmdW5jdGlvbiBhZGRIb2xkZXIoYWRkcmVzcyBfaG9sZGVyKSBpbnRlcm5hbCB7CiAgICAgICAgaWYgKGhvbGRlck51bWJlcltfaG9sZGVyXSA9PSAwKSB7CiAgICAgICAgICAgIGhvbGRlcnMucHVzaChfaG9sZGVyKTsKICAgICAgICAgICAgaG9sZGVyTnVtYmVyW19ob2xkZXJdID0gaG9sZGVycy5sZW5ndGg7CiAgICAgICAgfQogICAgfQoKICAgIC8vIEByZXR1cm4gdHJ1ZSBpZiB0cmFuc2ZlciBvcGVyYXRpb24gaXMgYWxsb3dlZAogICAgZnVuY3Rpb24gdHJhbnNmZXJBbGxvd2VkKGFkZHJlc3MgX3NlbmRlcikgaW50ZXJuYWwgdmlldyByZXR1cm5zKGJvb2wpIHsKICAgICAgICBpZiAobm93ID4gc2Vjb25kVW5sb2NrVGltZSB8fCBfc2VuZGVyID09IGljb0FkZHJlc3MpIC8vIHNvbGl1bS1kaXNhYmxlLWxpbmUgc2VjdXJpdHkvbm8tYmxvY2stbWVtYmVycwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAobm93IDwgZmlyc3RVbmxvY2tUaW1lKSAvLyBzb2xpdW0tZGlzYWJsZS1saW5lIHNlY3VyaXR5L25vLWJsb2NrLW1lbWJlcnMKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGlmIChibG9ja2VkVGlsbFNlY29uZFVubG9ja1tfc2VuZGVyXSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKfQ=='.
	

]
