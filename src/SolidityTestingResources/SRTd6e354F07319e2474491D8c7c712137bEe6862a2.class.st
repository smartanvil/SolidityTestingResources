Class {
	#name : #SRTd6e354F07319e2474491D8c7c712137bEe6862a2,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd6e354F07319e2474491D8c7c712137bEe6862a2 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7Cgpjb250cmFjdCBEU0F1dGhvcml0eSB7CiAgICBmdW5jdGlvbiBjYW5DYWxsKAogICAgICAgIGFkZHJlc3Mgc3JjLCBhZGRyZXNzIGRzdCwgYnl0ZXM0IHNpZwogICAgKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKfQoKY29udHJhY3QgRFNBdXRoRXZlbnRzIHsKICAgIGV2ZW50IExvZ1NldEF1dGhvcml0eSAoYWRkcmVzcyBpbmRleGVkIGF1dGhvcml0eSk7CiAgICBldmVudCBMb2dTZXRPd25lciAgICAgKGFkZHJlc3MgaW5kZXhlZCBvd25lcik7Cn0KCmNvbnRyYWN0IERTQXV0aCBpcyBEU0F1dGhFdmVudHMgewogICAgRFNBdXRob3JpdHkgIHB1YmxpYyAgYXV0aG9yaXR5OwogICAgYWRkcmVzcyAgICAgIHB1YmxpYyAgb3duZXI7CgogICAgZnVuY3Rpb24gRFNBdXRoKCkgcHVibGljIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgTG9nU2V0T3duZXIobXNnLnNlbmRlcik7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0T3duZXIoYWRkcmVzcyBvd25lcl8pCiAgICBwdWJsaWMKICAgIGF1dGgKICAgIHsKICAgICAgICBvd25lciA9IG93bmVyXzsKICAgICAgICBMb2dTZXRPd25lcihvd25lcik7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0QXV0aG9yaXR5KERTQXV0aG9yaXR5IGF1dGhvcml0eV8pCiAgICBwdWJsaWMKICAgIGF1dGgKICAgIHsKICAgICAgICBhdXRob3JpdHkgPSBhdXRob3JpdHlfOwogICAgICAgIExvZ1NldEF1dGhvcml0eShhdXRob3JpdHkpOwogICAgfQoKICAgIG1vZGlmaWVyIGF1dGggewogICAgICAgIHJlcXVpcmUoaXNBdXRob3JpemVkKG1zZy5zZW5kZXIsIG1zZy5zaWcpKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzQXV0aG9yaXplZChhZGRyZXNzIHNyYywgYnl0ZXM0IHNpZykgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYgKHNyYyA9PSBhZGRyZXNzKHRoaXMpKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSBpZiAoc3JjID09IG93bmVyKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSBpZiAoYXV0aG9yaXR5ID09IERTQXV0aG9yaXR5KDApKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gYXV0aG9yaXR5LmNhbkNhbGwoc3JjLCB0aGlzLCBzaWcpOwogICAgICAgIH0KICAgIH0KfQpjb250cmFjdCBEU05vdGUgewogICAgZXZlbnQgTG9nTm90ZSgKICAgICAgICBieXRlczQgICBpbmRleGVkICBzaWcsCiAgICAgICAgYWRkcmVzcyAgaW5kZXhlZCAgZ3V5LAogICAgICAgIGJ5dGVzMzIgIGluZGV4ZWQgIGZvbywKICAgICAgICBieXRlczMyICBpbmRleGVkICBiYXIsCiAgICAgICAgdWludCAgICAgICAgICAgICAgd2FkLAogICAgICAgIGJ5dGVzICAgICAgICAgICAgIGZheAogICAgKSBhbm9ueW1vdXM7CgogICAgbW9kaWZpZXIgbm90ZSB7CiAgICAgICAgYnl0ZXMzMiBmb287CiAgICAgICAgYnl0ZXMzMiBiYXI7CgogICAgICAgIGFzc2VtYmx5IHsKICAgICAgICAgICAgZm9vIDo9IGNhbGxkYXRhbG9hZCg0KQogICAgICAgICAgICBiYXIgOj0gY2FsbGRhdGFsb2FkKDM2KQogICAgICAgIH0KCiAgICAgICAgTG9nTm90ZShtc2cuc2lnLCBtc2cuc2VuZGVyLCBmb28sIGJhciwgbXNnLnZhbHVlLCBtc2cuZGF0YSk7CgogICAgICAgIF87CiAgICB9Cn0KY29udHJhY3QgRFNTdG9wIGlzIERTTm90ZSwgRFNBdXRoIHsKCiAgICBib29sIHB1YmxpYyBzdG9wcGVkOwoKICAgIG1vZGlmaWVyIHN0b3BwYWJsZSB7CiAgICAgICAgcmVxdWlyZSghc3RvcHBlZCk7CiAgICAgICAgXzsKICAgIH0KICAgIGZ1bmN0aW9uIHN0b3AoKSBwdWJsaWMgYXV0aCBub3RlIHsKICAgICAgICBzdG9wcGVkID0gdHJ1ZTsKICAgIH0KICAgIGZ1bmN0aW9uIHN0YXJ0KCkgcHVibGljIGF1dGggbm90ZSB7CiAgICAgICAgc3RvcHBlZCA9IGZhbHNlOwogICAgfQoKfQpjb250cmFjdCBEU01hdGggewogICAgZnVuY3Rpb24gYWRkKHVpbnQgeCwgdWludCB5KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeikgewogICAgICAgIHJlcXVpcmUoKHogPSB4ICsgeSkgPj0geCk7CiAgICB9CiAgICBmdW5jdGlvbiBzdWIodWludCB4LCB1aW50IHkpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCB6KSB7CiAgICAgICAgcmVxdWlyZSgoeiA9IHggLSB5KSA8PSB4KTsKICAgIH0KICAgIGZ1bmN0aW9uIG11bCh1aW50IHgsIHVpbnQgeSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IHopIHsKICAgICAgICByZXF1aXJlKHkgPT0gMCB8fCAoeiA9IHggKiB5KSAvIHkgPT0geCk7CiAgICB9Cn0KCmNvbnRyYWN0IEVSQzIwIHsKICAgIC8vLyBAcmV0dXJuIHRvdGFsIGFtb3VudCBvZiB0b2tlbnMKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQyNTYgc3VwcGx5KTsKCiAgICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBmcm9tIHdoaWNoIHRoZSBiYWxhbmNlIHdpbGwgYmUgcmV0cmlldmVkCiAgICAvLy8gQHJldHVybiBUaGUgYmFsYW5jZQogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKCiAgICAvLy8gQG5vdGljZSBzZW5kIGBfdmFsdWVgIHRva2VuIHRvIGBfdG9gIGZyb20gYG1zZy5zZW5kZXJgCiAgICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8vIEBub3RpY2Ugc2VuZCBgX3ZhbHVlYCB0b2tlbiB0byBgX3RvYCBmcm9tIGBfZnJvbWAgb24gdGhlIGNvbmRpdGlvbiBpdCBpcyBhcHByb3ZlZCBieSBgX2Zyb21gCiAgICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBhZGRyZXNzIG9mIHRoZSBzZW5kZXIKICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQKICAgIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQKICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIHRyYW5zZmVyIHdhcyBzdWNjZXNzZnVsIG9yIG5vdAogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8vIEBub3RpY2UgYG1zZy5zZW5kZXJgIGFwcHJvdmVzIGBfYWRkcmAgdG8gc3BlbmQgYF92YWx1ZWAgdG9rZW5zCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2VucwogICAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB3ZWkgdG8gYmUgYXBwcm92ZWQgZm9yIHRyYW5zZmVyCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBhcHByb3ZhbCB3YXMgc3VjY2Vzc2Z1bCBvciBub3QKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IG93bmluZyB0b2tlbnMKICAgIC8vLyBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgYWJsZSB0byB0cmFuc2ZlciB0aGUgdG9rZW5zCiAgICAvLy8gQHJldHVybiBBbW91bnQgb2YgcmVtYWluaW5nIHRva2VucyBhbGxvd2VkIHRvIHNwZW50CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZyk7CgogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKfQoKCmNvbnRyYWN0IENvaW4gaXMgRVJDMjAsIERTU3RvcCB7CiAgICBzdHJpbmcgaW50ZXJuYWwgY19uYW1lOwogICAgc3RyaW5nIGludGVybmFsIGNfc3ltYm9sOwogICAgdWludDggaW50ZXJuYWwgY19kZWNpbWFscyA9IDA7CiAgICB1aW50MjU2IGludGVybmFsIGNfdG90YWxTdXBwbHk7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgaW50ZXJuYWwgY19iYWxhbmNlczsKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGNfYXBwcm92YWxzOwoKICAgIGZ1bmN0aW9uIGluaXQodWludDI1NiB0b3RhbF9sZW1vcywgc3RyaW5nIHRva2VuX25hbWUsIHN0cmluZyB0b2tlbl9zeW1ib2wpIGludGVybmFsIHsKICAgICAgICBjX2JhbGFuY2VzW21zZy5zZW5kZXJdID0gdG90YWxfbGVtb3M7CiAgICAgICAgY190b3RhbFN1cHBseSA9IHRvdGFsX2xlbW9zOwogICAgICAgIGNfbmFtZSA9IHRva2VuX25hbWU7CiAgICAgICAgY19zeW1ib2wgPSB0b2tlbl9zeW1ib2w7CiAgICB9CgogICAgZnVuY3Rpb24oKSBwdWJsaWMgewogICAgICAgIGFzc2VydChmYWxzZSk7CiAgICB9CgogICAgZnVuY3Rpb24gbmFtZSgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zIChzdHJpbmcpIHsKICAgICAgICByZXR1cm4gY19uYW1lOwogICAgfQoKICAgIGZ1bmN0aW9uIHN5bWJvbCgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zIChzdHJpbmcpIHsKICAgICAgICByZXR1cm4gY19zeW1ib2w7CiAgICB9CgogICAgZnVuY3Rpb24gZGVjaW1hbHMoKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gY19kZWNpbWFsczsKICAgIH0KCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGNfdG90YWxTdXBwbHk7CiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBjX2JhbGFuY2VzW19vd25lcl07CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHN0b3BwYWJsZSByZXR1cm5zIChib29sKSB7CiAgICAgICAgLy8gdWludCBuZXZlciBsZXNzIHRoYW4gMC4gVGhlIG5lZ2F0aXZlIG51bWJlciB3aWxsIGJlY29tZSB0byBhIGJpZyBwb3NpdGl2ZSBudW1iZXIKICAgICAgICByZXF1aXJlKF92YWx1ZSA8IGNfdG90YWxTdXBwbHkpOwoKICAgICAgICBjX2FwcHJvdmFsc1ttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBjX2FwcHJvdmFsc1tfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KCn0KCmNvbnRyYWN0IEZyZWV6ZXJBdXRob3JpdHkgaXMgRFNBdXRob3JpdHkgewogICAgYWRkcmVzc1tdIGludGVybmFsIGNfZnJlZXplcnM7CiAgICAvLyBzaGEzKCJzZXRGcmVlemluZyhhZGRyZXNzLHVpbnQyNTYsdWludDI1Nix1aW50OCkiKS5zbGljZSgwLDEwKQogICAgYnl0ZXM0IGNvbnN0YW50IHNldEZyZWV6aW5nU2lnID0gYnl0ZXM0KDB4NTFjM2I4YTYpOwogICAgLy8gc2hhMygidHJhbnNmZXJBbmRGcmVlemluZyhhZGRyZXNzLHVpbnQyNTYsdWludDI1Nix1aW50MjU2LHVpbnQ4KSIpLnNsaWNlKDAsMTApCiAgICBieXRlczQgY29uc3RhbnQgdHJhbnNmZXJBbmRGcmVlemluZ1NpZyA9IGJ5dGVzNCgweGI4YTFmZGI2KTsKCiAgICBmdW5jdGlvbiBjYW5DYWxsKGFkZHJlc3MgY2FsbGVyLCBhZGRyZXNzLCBieXRlczQgc2lnKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgLy8gZnJlZXplciBjYW4gY2FsbCBzZXRGcmVlemluZywgdHJhbnNmZXJBbmRGcmVlemluZwogICAgICAgIGlmIChpc0ZyZWV6ZXIoY2FsbGVyKSAmJiBzaWcgPT0gc2V0RnJlZXppbmdTaWcgfHwgc2lnID09IHRyYW5zZmVyQW5kRnJlZXppbmdTaWcpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBhZGRGcmVlemVyKGFkZHJlc3MgZnJlZXplcikgcHVibGljIHsKICAgICAgICBpbnQgaSA9IGluZGV4T2YoY19mcmVlemVycywgZnJlZXplcik7CiAgICAgICAgaWYgKGkgPCAwKSB7CiAgICAgICAgICAgIGNfZnJlZXplcnMucHVzaChmcmVlemVyKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gcmVtb3ZlRnJlZXplcihhZGRyZXNzIGZyZWV6ZXIpIHB1YmxpYyB7CiAgICAgICAgaW50IGluZGV4ID0gaW5kZXhPZihjX2ZyZWV6ZXJzLCBmcmVlemVyKTsKICAgICAgICBpZiAoaW5kZXggPj0gMCkgewogICAgICAgICAgICB1aW50IGkgPSB1aW50KGluZGV4KTsKICAgICAgICAgICAgd2hpbGUgKGkgPCBjX2ZyZWV6ZXJzLmxlbmd0aCAtIDEpIHsKICAgICAgICAgICAgICAgIGNfZnJlZXplcnNbaV0gPSBjX2ZyZWV6ZXJzW2kgKyAxXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjX2ZyZWV6ZXJzLmxlbmd0aC0tOwogICAgICAgIH0KICAgIH0KCiAgICAvKiogRmluZHMgdGhlIGluZGV4IG9mIGEgZ2l2ZW4gdmFsdWUgaW4gYW4gYXJyYXkuICovCiAgICBmdW5jdGlvbiBpbmRleE9mKGFkZHJlc3NbXSB2YWx1ZXMsIGFkZHJlc3MgdmFsdWUpIGludGVybmFsIHB1cmUgcmV0dXJucyAoaW50KSB7CiAgICAgICAgdWludCBpID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHZhbHVlcy5sZW5ndGgpIHsKICAgICAgICAgICAgaWYgKHZhbHVlc1tpXSA9PSB2YWx1ZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGludChpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpKys7CiAgICAgICAgfQogICAgICAgIHJldHVybiBpbnQoLSAxKTsKICAgIH0KCiAgICBmdW5jdGlvbiBpc0ZyZWV6ZXIoYWRkcmVzcyBhZGRyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBpbmRleE9mKGNfZnJlZXplcnMsIGFkZHIpID49IDA7CiAgICB9Cn0KCmNvbnRyYWN0IExlbW9Db2luIGlzIENvaW4sIERTTWF0aCB7CiAgICBlbnVtIGZyZWV6aW5nX3R5cGVfZW51bSB7CiAgICAgICAgRlVORF9SQUlTSU5HX0ZSRUVaSU5HLAogICAgICAgIFZJUF9GUkVFWklORwogICAgfQoKICAgIC8vZnJlZXppbmcgc3RydWN0CiAgICBzdHJ1Y3QgRnJlZXppbmdOb2RlIHsKICAgICAgICB1aW50IGVuZF9zdGFtcDsKICAgICAgICB1aW50IG51bV9sZW1vczsKICAgICAgICBmcmVlemluZ190eXBlX2VudW0gZnJlZXppbmdfdHlwZTsKICAgIH0KCiAgICAvL2ZyZWV6aW5nIGFjY291bnQgbGlzdAogICAgbWFwcGluZyhhZGRyZXNzID0+IEZyZWV6aW5nTm9kZSBbXSkgaW50ZXJuYWwgY19mcmVlemluZ19saXN0OwoKICAgIGZ1bmN0aW9uIExlbW9Db2luKHVpbnQyNTYgdG90YWxfbGVtb3MsIHN0cmluZyB0b2tlbl9uYW1lLCBzdHJpbmcgdG9rZW5fc3ltYm9sKSBwdWJsaWMgewogICAgICAgIGluaXQodG90YWxfbGVtb3MsIHRva2VuX25hbWUsIHRva2VuX3N5bWJvbCk7CiAgICAgICAgc2V0QXV0aG9yaXR5KG5ldyBGcmVlemVyQXV0aG9yaXR5KCkpOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZEZyZWV6ZXIoYWRkcmVzcyBmcmVlemVyKSBhdXRoIHB1YmxpYyB7CiAgICAgICAgRnJlZXplckF1dGhvcml0eShhdXRob3JpdHkpLmFkZEZyZWV6ZXIoZnJlZXplcik7CiAgICB9CgogICAgZnVuY3Rpb24gcmVtb3ZlRnJlZXplcihhZGRyZXNzIGZyZWV6ZXIpIGF1dGggcHVibGljIHsKICAgICAgICBGcmVlemVyQXV0aG9yaXR5KGF1dGhvcml0eSkucmVtb3ZlRnJlZXplcihmcmVlemVyKTsKICAgIH0KCiAgICBldmVudCBDbGVhckV4cGlyZWRGcmVlemluZ0V2ZW50KGFkZHJlc3MgYWRkcik7CiAgICBldmVudCBTZXRGcmVlemluZ0V2ZW50KGFkZHJlc3MgYWRkciwgdWludCBlbmRfc3RhbXAsIHVpbnQgbnVtX2xlbW9zLCBmcmVlemluZ190eXBlX2VudW0gZnJlZXppbmdfdHlwZSk7CgogICAgZnVuY3Rpb24gY2xlYXJFeHBpcmVkRnJlZXppbmcoYWRkcmVzcyBhZGRyKSBwdWJsaWMgewogICAgICAgIHZhciBub2RlcyA9IGNfZnJlZXppbmdfbGlzdFthZGRyXTsKICAgICAgICB1aW50IGxlbmd0aCA9IG5vZGVzLmxlbmd0aDsKCiAgICAgICAgLy8gZmluZCBmaXJzdCBleHBpcmVkIGluZGV4CiAgICAgICAgdWludCBsZWZ0ID0gMDsKICAgICAgICB3aGlsZSAobGVmdCA8IGxlbmd0aCkgewogICAgICAgICAgICAvLyBub3QgZnJlZXppbmcgYW55IG1vcmUKICAgICAgICAgICAgaWYgKG5vZGVzW2xlZnRdLmVuZF9zdGFtcCA8PSBibG9jay50aW1lc3RhbXApIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxlZnQrKzsKICAgICAgICB9CgogICAgICAgIC8vIG5leHQgZnJvemVuIGluZGV4CiAgICAgICAgdWludCByaWdodCA9IGxlZnQgKyAxOwogICAgICAgIHdoaWxlIChsZWZ0IDwgbGVuZ3RoICYmIHJpZ2h0IDwgbGVuZ3RoKSB7CiAgICAgICAgICAgIC8vIHN0aWxsIGZyZWV6aW5nCiAgICAgICAgICAgIGlmIChub2Rlc1tyaWdodF0uZW5kX3N0YW1wID4gYmxvY2sudGltZXN0YW1wKSB7CiAgICAgICAgICAgICAgICBub2Rlc1tsZWZ0XSA9IG5vZGVzW3JpZ2h0XTsKICAgICAgICAgICAgICAgIGxlZnQrKzsKICAgICAgICAgICAgfQogICAgICAgICAgICByaWdodCsrOwogICAgICAgIH0KICAgICAgICBpZiAobGVuZ3RoICE9IGxlZnQpIHsKICAgICAgICAgICAgbm9kZXMubGVuZ3RoID0gbGVmdDsKICAgICAgICAgICAgQ2xlYXJFeHBpcmVkRnJlZXppbmdFdmVudChhZGRyKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdmFsaWRCYWxhbmNlT2YoYWRkcmVzcyBhZGRyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludCkgewogICAgICAgIHZhciBub2RlcyA9IGNfZnJlZXppbmdfbGlzdFthZGRyXTsKICAgICAgICB1aW50IGxlbmd0aCA9IG5vZGVzLmxlbmd0aDsKICAgICAgICB1aW50IHRvdGFsX2xlbW9zID0gYmFsYW5jZU9mKGFkZHIpOwoKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewogICAgICAgICAgICBpZiAobm9kZXNbaV0uZW5kX3N0YW1wID4gYmxvY2sudGltZXN0YW1wKSB7CiAgICAgICAgICAgICAgICB0b3RhbF9sZW1vcyA9IHN1Yih0b3RhbF9sZW1vcywgbm9kZXNbaV0ubnVtX2xlbW9zKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRvdGFsX2xlbW9zOwogICAgfQoKICAgIGZ1bmN0aW9uIGZyZWV6aW5nQmFsYW5jZU51bWJlck9mKGFkZHJlc3MgYWRkcikgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gY19mcmVlemluZ19saXN0W2FkZHJdLmxlbmd0aDsKICAgIH0KCiAgICBmdW5jdGlvbiBmcmVlemluZ0JhbGFuY2VJbmZvT2YoYWRkcmVzcyBhZGRyLCB1aW50IGluZGV4KSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludCwgdWludCwgdWludDgpIHsKICAgICAgICByZXR1cm4gKGNfZnJlZXppbmdfbGlzdFthZGRyXVtpbmRleF0uZW5kX3N0YW1wLCBjX2ZyZWV6aW5nX2xpc3RbYWRkcl1baW5kZXhdLm51bV9sZW1vcywgdWludDgoY19mcmVlemluZ19saXN0W2FkZHJdW2luZGV4XS5mcmVlemluZ190eXBlKSk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0RnJlZXppbmcoYWRkcmVzcyBhZGRyLCB1aW50IGVuZF9zdGFtcCwgdWludCBudW1fbGVtb3MsIHVpbnQ4IGZyZWV6aW5nX3R5cGUpIGF1dGggc3RvcHBhYmxlIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShibG9jay50aW1lc3RhbXAgPCBlbmRfc3RhbXApOwogICAgICAgIC8vIHVpbnQgbmV2ZXIgbGVzcyB0aGFuIDAuIFRoZSBuZWdhdGl2ZSBudW1iZXIgd2lsbCBiZWNvbWUgdG8gYSBiaWcgcG9zaXRpdmUgbnVtYmVyCiAgICAgICAgcmVxdWlyZShudW1fbGVtb3MgPCBjX3RvdGFsU3VwcGx5KTsKICAgICAgICBjbGVhckV4cGlyZWRGcmVlemluZyhhZGRyKTsKICAgICAgICB1aW50IHZhbGlkX2JhbGFuY2UgPSB2YWxpZEJhbGFuY2VPZihhZGRyKTsKICAgICAgICByZXF1aXJlKHZhbGlkX2JhbGFuY2UgPj0gbnVtX2xlbW9zKTsKCiAgICAgICAgRnJlZXppbmdOb2RlIG1lbW9yeSBub2RlID0gRnJlZXppbmdOb2RlKGVuZF9zdGFtcCwgbnVtX2xlbW9zLCBmcmVlemluZ190eXBlX2VudW0oZnJlZXppbmdfdHlwZSkpOwogICAgICAgIGNfZnJlZXppbmdfbGlzdFthZGRyXS5wdXNoKG5vZGUpOwoKICAgICAgICBTZXRGcmVlemluZ0V2ZW50KGFkZHIsIGVuZF9zdGFtcCwgbnVtX2xlbW9zLCBmcmVlemluZ190eXBlX2VudW0oZnJlZXppbmdfdHlwZSkpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyQW5kRnJlZXppbmcoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlLCB1aW50MjU2IGZyZWV6ZUFtb3VudCwgdWludCBlbmRfc3RhbXAsIHVpbnQ4IGZyZWV6aW5nX3R5cGUpIGF1dGggc3RvcHBhYmxlIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgLy8gdWludCBuZXZlciBsZXNzIHRoYW4gMC4gVGhlIG5lZ2F0aXZlIG51bWJlciB3aWxsIGJlY29tZSB0byBhIGJpZyBwb3NpdGl2ZSBudW1iZXIKICAgICAgICByZXF1aXJlKF92YWx1ZSA8IGNfdG90YWxTdXBwbHkpOwogICAgICAgIHJlcXVpcmUoZnJlZXplQW1vdW50IDw9IF92YWx1ZSk7CgogICAgICAgIHRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICAgICAgICBzZXRGcmVlemluZyhfdG8sIGVuZF9zdGFtcCwgZnJlZXplQW1vdW50LCBmcmVlemluZ190eXBlKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBzdG9wcGFibGUgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICAvLyB1aW50IG5ldmVyIGxlc3MgdGhhbiAwLiBUaGUgbmVnYXRpdmUgbnVtYmVyIHdpbGwgYmVjb21lIHRvIGEgYmlnIHBvc2l0aXZlIG51bWJlcgogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDwgY190b3RhbFN1cHBseSk7CiAgICAgICAgY2xlYXJFeHBpcmVkRnJlZXppbmcobXNnLnNlbmRlcik7CiAgICAgICAgdWludCBmcm9tX2xlbW9zID0gdmFsaWRCYWxhbmNlT2YobXNnLnNlbmRlcik7CgogICAgICAgIHJlcXVpcmUoZnJvbV9sZW1vcyA+PSBfdmFsdWUpOwoKICAgICAgICBjX2JhbGFuY2VzW21zZy5zZW5kZXJdID0gc3ViKGNfYmFsYW5jZXNbbXNnLnNlbmRlcl0sIF92YWx1ZSk7CiAgICAgICAgY19iYWxhbmNlc1tfdG9dID0gYWRkKGNfYmFsYW5jZXNbX3RvXSwgX3ZhbHVlKTsKCiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHN0b3BwYWJsZSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIC8vIHVpbnQgbmV2ZXIgbGVzcyB0aGFuIDAuIFRoZSBuZWdhdGl2ZSBudW1iZXIgd2lsbCBiZWNvbWUgdG8gYSBiaWcgcG9zaXRpdmUgbnVtYmVyCiAgICAgICAgcmVxdWlyZShfdmFsdWUgPCBjX3RvdGFsU3VwcGx5KTsKICAgICAgICByZXF1aXJlKGNfYXBwcm92YWxzW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUpOwoKICAgICAgICBjbGVhckV4cGlyZWRGcmVlemluZyhfZnJvbSk7CiAgICAgICAgdWludCBmcm9tX2xlbW9zID0gdmFsaWRCYWxhbmNlT2YoX2Zyb20pOwoKICAgICAgICByZXF1aXJlKGZyb21fbGVtb3MgPj0gX3ZhbHVlKTsKCiAgICAgICAgY19hcHByb3ZhbHNbX2Zyb21dW21zZy5zZW5kZXJdID0gc3ViKGNfYXBwcm92YWxzW19mcm9tXVttc2cuc2VuZGVyXSwgX3ZhbHVlKTsKICAgICAgICBjX2JhbGFuY2VzW19mcm9tXSA9IHN1YihjX2JhbGFuY2VzW19mcm9tXSwgX3ZhbHVlKTsKICAgICAgICBjX2JhbGFuY2VzW190b10gPSBhZGQoY19iYWxhbmNlc1tfdG9dLCBfdmFsdWUpOwoKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9'.
	

]
