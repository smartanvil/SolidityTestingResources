Class {
	#name : #SRT03c18d649e743ee0b09f28a81d33575f03af9826,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT03c18d649e743ee0b09f28a81d33575f03af9826 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTY7CgoKLyoqCiAqIEB0aXRsZSBXZUJldENyeXB0bwogKiBAYXV0aG9yIEFMX1gKICogQGRldiBUaGUgV0JDIEVSQy0yMjMgVG9rZW4gQ29udHJhY3QKICovCmNvbnRyYWN0IFdlQmV0Q3J5cHRvIHsKICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICJXZSBCZXQgQ3J5cHRvIjsKICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIldCQyI7CgkKICAgIGFkZHJlc3MgcHVibGljIHNlbGZBZGRyZXNzOwogICAgYWRkcmVzcyBwdWJsaWMgYWRtaW47CiAgICBhZGRyZXNzW10gcHJpdmF0ZSB1c2VyczsKCQogICAgdWludDggcHVibGljIGRlY2ltYWxzID0gNzsKICAgIHVpbnQyNTYgcHVibGljIHJlbGF0aXZlRGF0ZVNhdmU7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbEZ1bmRzOwogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHkgPSAzMDAwMDAwMDAwMDAwMDA7CiAgICB1aW50MjU2IHB1YmxpYyBwcmljZVBlckV0aGVyOwogICAgdWludDI1NiBwcml2YXRlIGFtb3VudEluQ2lyY3VsYXRpb247CiAgICB1aW50MjU2IHByaXZhdGUgY3VycmVudFByb2ZpdHM7CiAgICB1aW50MjU2IHByaXZhdGUgY3VycmVudEl0ZXJhdGlvbjsKCXVpbnQyNTYgcHJpdmF0ZSBhY3R1YWxQcm9maXRTcGxpdDsKCQogICAgYm9vbCBwdWJsaWMgREFwcFJlYWR5OwogICAgYm9vbCBwdWJsaWMgaXNGcm96ZW47Cglib29sIHB1YmxpYyBzcGxpdEluU2VydmljZSA9IHRydWU7Cglib29sIHByaXZhdGUgaGFzSUNPUnVuOwogICAgYm9vbCBwcml2YXRlIHJ1bm5pbmc7Cglib29sWzRdIHByaXZhdGUgZGV2QXBwcm92YWxzOwoJCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgbW9udGhseUxpbWl0OwoJCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgaXNBZGRlZDsKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBmcmVlemVVc2VyOwoJCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CgltYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGNvb2xkb3duOwoJCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpOwogICAgZXZlbnQgQ3VycmVudFRMU05Qcm9vZihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIHN0cmluZyBfcHJvb2YpOwogICAgCgkvKioKCSAqIEBub3RpY2UgRW5zdXJlcyBhZG1pbiBpcyBjYWxsZXIKCSAqLwogICAgbW9kaWZpZXIgaXNBZG1pbigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYWRtaW4pOwogICAgICAgIC8vQ29udGludWUgZXhlY3V0aW5nIHJlc3Qgb2YgbWV0aG9kIGJvZHkKICAgICAgICBfOwogICAgfQogICAgCiAgICAvKioKCSAqIEBub3RpY2UgUmUtZW50cnkgcHJvdGVjdGlvbgoJICovCiAgICBtb2RpZmllciBpc1J1bm5pbmcoKSB7CiAgICAgICAgcmVxdWlyZSghcnVubmluZyk7CiAgICAgICAgcnVubmluZyA9IHRydWU7CiAgICAgICAgXzsKICAgICAgICBydW5uaW5nID0gZmFsc2U7CiAgICB9CiAgICAKCS8qKgoJICogQG5vdGljZSBFbnN1cmVzIHN5c3RlbSBpc24ndCBmcm96ZW4KCSAqLwogICAgbW9kaWZpZXIgcmVxdWlyZVRoYXcoKSB7CiAgICAgICAgcmVxdWlyZSghaXNGcm96ZW4pOwogICAgICAgIF87CiAgICB9CiAgICAKCS8qKgoJICogQG5vdGljZSBFbnN1cmVzIHBsYXllciBpc24ndCBsb2dnZWQgaW4gb24gcGxhdGZvcm0KCSAqLwogICAgbW9kaWZpZXIgdXNlck5vdFBsYXlpbmcoYWRkcmVzcyBfdXNlcikgewogICAgICAgIHJlcXVpcmUoIWZyZWV6ZVVzZXJbX3VzZXJdKTsKICAgICAgICBfOwogICAgfQoJCgkvKioKCSAqIEBub3RpY2UgRW5zdXJlcyBmdW5jdGlvbiBydW5zIG9ubHkgb25jZQoJICovCgltb2RpZmllciBvbmVUaW1lKCkgewoJCXJlcXVpcmUoIWhhc0lDT1J1bik7CgkJXzsKCX0KICAgIAoJLyoqCgkgKiBAbm90aWNlIEVuc3VyZXMgV0JDIERBcHAgaXMgb25saW5lCgkgKi8KICAgIG1vZGlmaWVyIERBcHBPbmxpbmUoKSB7CiAgICAgICAgcmVxdWlyZShEQXBwUmVhZHkpOwogICAgICAgIF87CiAgICB9CiAgICAKICAgIC8qKgoJICogQG5vdGljZSBTYWZlTWF0aCBMaWJyYXJ5IHNhZmVTdWIgSW1wb3J0CgkgKiBAZGV2IAoJICAgICAgICBTaW5jZSB3ZSBhcmUgZGVhbGluZyB3aXRoIGEgbGltaXRlZCBjdXJyZW5jeQoJICAgICAgICBjaXJjdWxhdGlvbiBvZiAzMCBtaWxsaW9uIHRva2VucyBhbmQgdmFsdWVzCgkgICAgICAgIHRoYXQgd2lsbCBub3Qgc3VycGFzcyB0aGUgdWludDI1NiBsaW1pdCwgb25seQoJICAgICAgICBzYWZlU3ViIGlzIHJlcXVpcmVkIHRvIHByZXZlbnQgdW5kZXJmbG93cy4KCSAqLwogICAgZnVuY3Rpb24gc2FmZVN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiB6KSB7CiAgICAgICAgYXNzZXJ0KCh6ID0gYSAtIGIpIDw9IGEpOwogICAgfQoJCgkvKioKCSAqIEBub3RpY2UgV0JDIENvbnN0cnVjdG9yCgkgKiBAZGV2IAoJICAgICAgICBDb25zdHJ1Y3RvciBmdW5jdGlvbiBjb250YWluaW5nIHByb3BlciBpbml0aWFsaXphdGlvbnMgc3VjaCBhcyAKCSAgICAgICAgdG9rZW4gZGlzdHJpYnV0aW9uIHRvIHRoZSB0ZWFtIG1lbWJlcnMgYW5kIHB1c2hpbmcgdGhlIGZpcnN0IAoJICAgICAgICBwcm9maXQgc3BsaXQgdG8gNiBtb250aHMgd2hlbiB0aGUgREFwcCB3aWxsIGFscmVhZHkgYmUgbGl2ZS4KCSAqLwogICAgZnVuY3Rpb24gV2VCZXRDcnlwdG8oKSB7CiAgICAgICAgYWRtaW4gPSBtc2cuc2VuZGVyOwogICAgICAgIHNlbGZBZGRyZXNzID0gdGhpczsKICAgICAgICBiYWxhbmNlc1sweDE2NkNiNDg5NzNDMjQ0N2RhZkZBOEVGZDM1MjZkYTE4MDc2MDg4ZGVdID0gMjI1MDAwMDAwMDAwMDA7CiAgICAgICAgYWRkVXNlcigweDE2NkNiNDg5NzNDMjQ0N2RhZkZBOEVGZDM1MjZkYTE4MDc2MDg4ZGUpOwogICAgICAgIFRyYW5zZmVyKHNlbGZBZGRyZXNzLCAweDE2NkNiNDg5NzNDMjQ0N2RhZkZBOEVGZDM1MjZkYTE4MDc2MDg4ZGUsIDIyNTAwMDAwMDAwMDAwKTsKICAgICAgICBiYWxhbmNlc1sweEU1OUNiRDAyOGY3MTQ0N0I4MDRGMzFDZjBmQzQxRjBlNUUxM2Y0YkZdID0gMTUwMDAwMDAwMDAwMDA7CiAgICAgICAgYWRkVXNlcigweEU1OUNiRDAyOGY3MTQ0N0I4MDRGMzFDZjBmQzQxRjBlNUUxM2Y0YkYpOwogICAgICAgIFRyYW5zZmVyKHNlbGZBZGRyZXNzLCAweEU1OUNiRDAyOGY3MTQ0N0I4MDRGMzFDZjBmQzQxRjBlNUUxM2Y0YkYsIDE1MDAwMDAwMDAwMDAwKTsKICAgICAgICBiYWxhbmNlc1sweDFhYjEzRDJDMUFDNDMwMzczNzk4MUNlOEI4YkQ1MTE2Qzg0Yzc0NGRdID0gNTAwMDAwMDAwMDAwMDsKICAgICAgICBhZGRVc2VyKDB4MWFiMTNEMkMxQUM0MzAzNzM3OTgxQ2U4QjhiRDUxMTZDODRjNzQ0ZCk7CiAgICAgICAgVHJhbnNmZXIoc2VsZkFkZHJlc3MsIDB4MWFiMTNEMkMxQUM0MzAzNzM3OTgxQ2U4QjhiRDUxMTZDODRjNzQ0ZCwgNTAwMDAwMDAwMDAwMCk7CiAgICAgICAgYmFsYW5jZXNbMHgwNjkwOERmMzg5Q2YyNTg5Mzc1YjY5MDhEMGIxYzhGY0MzNDcyMUI1XSA9IDI1MDAwMDAwMDAwMDA7CiAgICAgICAgYWRkVXNlcigweDA2OTA4RGYzODlDZjI1ODkzNzViNjkwOEQwYjFjOEZjQzM0NzIxQjUpOwogICAgICAgIFRyYW5zZmVyKHNlbGZBZGRyZXNzLCAweDA2OTA4RGYzODlDZjI1ODkzNzViNjkwOEQwYjFjOEZjQzM0NzIxQjUsIDI1MDAwMDAwMDAwMDApOwogICAgICAgIGJhbGFuY2VzWzB4RWRCZDRjNjc1N0RDNDI1MzIxNTg0YTkxYkRCMzU1Q2U2NWM0MmIxM10gPSAyNTAwMDAwMDAwMDAwOwogICAgICAgIGFkZFVzZXIoMHhFZEJkNGM2NzU3REM0MjUzMjE1ODRhOTFiREIzNTVDZTY1YzQyYjEzKTsKICAgICAgICBUcmFuc2ZlcihzZWxmQWRkcmVzcywgMHhFZEJkNGM2NzU3REM0MjUzMjE1ODRhOTFiREIzNTVDZTY1YzQyYjEzLCAyNTAwMDAwMDAwMDAwKTsKICAgICAgICBiYWxhbmNlc1sweDQzMDlGYjRCMzFhQTY2NzY3M2Q2OWRiMTA3MkU2ZGNENTBGZDg4NThdID0gMjUwMDAwMDAwMDAwMDsKICAgICAgICBhZGRVc2VyKDB4NDMwOUZiNEIzMWFBNjY3NjczZDY5ZGIxMDcyRTZkY0Q1MEZkODg1OCk7CiAgICAgICAgVHJhbnNmZXIoc2VsZkFkZHJlc3MsIDB4NDMwOUZiNEIzMWFBNjY3NjczZDY5ZGIxMDcyRTZkY0Q1MEZkODg1OCwgMjUwMDAwMDAwMDAwMCk7CiAgICAgICAgcmVsYXRpdmVEYXRlU2F2ZSA9IG5vdyArIDE4MCBkYXlzOwogICAgICAgIHByaWNlUGVyRXRoZXIgPSAzMzIwOTsKICAgICAgICBiYWxhbmNlc1tzZWxmQWRkcmVzc10gPSAyNTAwMDAwMDAwMDAwMDA7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogQG5vdGljZSBDaGVjayB0aGUgbmFtZSBvZiB0aGUgdG9rZW4gfiBFUkMtMjAgU3RhbmRhcmQKICAgICAqIEByZXR1cm4gewoJCQkJCSJfbmFtZSI6ICJUaGUgdG9rZW4gbmFtZSIKCQkJCX0KICAgICAqLwogICAgZnVuY3Rpb24gbmFtZSgpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKHN0cmluZyBfbmFtZSkgewogICAgICAgIHJldHVybiBuYW1lOwogICAgfQogICAgCgkvKioKICAgICAqIEBub3RpY2UgQ2hlY2sgdGhlIHN5bWJvbCBvZiB0aGUgdG9rZW4gfiBFUkMtMjAgU3RhbmRhcmQKICAgICAqIEByZXR1cm4gewoJCQkJCSJfc3ltYm9sIjogIlRoZSB0b2tlbiBzeW1ib2wiCgkJCQl9CiAgICAgKi8KICAgIGZ1bmN0aW9uIHN5bWJvbCgpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKHN0cmluZyBfc3ltYm9sKSB7CiAgICAgICAgcmV0dXJuIHN5bWJvbDsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBAbm90aWNlIENoZWNrIHRoZSBkZWNpbWFscyBvZiB0aGUgdG9rZW4gfiBFUkMtMjAgU3RhbmRhcmQKICAgICAqIEByZXR1cm4gewoJCQkJCSJfZGVjaW1hbHMiOiAiVGhlIHRva2VuIGRlY2ltYWxzIgoJCQkJfQogICAgICovCiAgICBmdW5jdGlvbiBkZWNpbWFscygpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4IF9kZWNpbWFscykgewogICAgICAgIHJldHVybiBkZWNpbWFsczsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBAbm90aWNlIENoZWNrIHRoZSB0b3RhbCBzdXBwbHkgb2YgdGhlIHRva2VuIH4gRVJDLTIwIFN0YW5kYXJkCiAgICAgKiBAcmV0dXJuIHsKCQkJCQkiX3RvdGFsU3VwcGx5IjogIlRvdGFsIHN1cHBseSBvZiB0b2tlbnMiCgkJCQl9CiAgICAgKi8KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBfdG90YWxTdXBwbHkpIHsKICAgICAgICByZXR1cm4gdG90YWxTdXBwbHk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogQG5vdGljZSBRdWVyeSB0aGUgYXZhaWxhYmxlIGJhbGFuY2Ugb2YgYW4gYWRkcmVzcyB+IEVSQy0yMCBTdGFuZGFyZAoJICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB3aG9zZSBiYWxhbmNlIHdlIHdpc2ggdG8gcmV0cmlldmUKICAgICAqIEByZXR1cm4gewoJCQkJCSJiYWxhbmNlIjogIkJhbGFuY2Ugb2YgdGhlIGFkZHJlc3MiCgkJCQl9CiAgICAgKi8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9CgkKCS8qKgoJICogQG5vdGljZSBRdWVyeSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGUgc3BlbmRlciBhZGRyZXNzIGNhbiB3aXRoZHJhdyBmcm9tIHRoZSBvd25lciBhZGRyZXNzIH4gRVJDLTIwIFN0YW5kYXJkCgkgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHdobyBvd25zIHRoZSB0b2tlbnMKCSAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aG8gY2FuIHdpdGhkcmF3IHRoZSB0b2tlbnMKCSAqIEByZXR1cm4gewoJCQkJCSJyZW1haW5pbmciOiAiUmVtYWluaW5nIHdpdGhkcmF3YWwgYW1vdW50IgoJCQkJfQogICAgICovCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgICB9CiAgICAKICAgIC8qKgogICAgICogQG5vdGljZSBUcmFuc2ZlciB0b2tlbnMgZnJvbSBhbiBhZGRyZXNzIHRvIGFub3RoZXIgfiBFUkMtMjAgU3RhbmRhcmQKCSAqIEBkZXYgCgkgICAgICAgIEFkanVzdHMgdGhlIG1vbnRobHkgbGltaXQgaW4gY2FzZSB0aGUgX2Zyb20gYWRkcmVzcyBpcyB0aGUgQ2FzaW5vCgkgICAgICAgIGFuZCBlbnN1cmVzIHRoYXQgdGhlIHVzZXIgaXNuJ3QgbG9nZ2VkIGluIHdoZW4gcmV0cmlldmluZyBmdW5kcwoJICAgICAgICBzbyBhcyB0byBwcmV2ZW50IGFnYWluc3QgYSByYWNlIGF0dGFjayB3aXRoIHRoZSBDYXNpbm8uCiAgICAgKiBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3Mgd2hvc2UgYmFsYW5jZSB3ZSB3aWxsIHRyYW5zZmVyCiAgICAgKiBAcGFyYW0gX3RvIFRoZSByZWNpcGllbnQgYWRkcmVzcwoJICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBleHRlcm5hbCByZXF1aXJlVGhhdyB1c2VyTm90UGxheWluZyhfdG8pIHsKCQlyZXF1aXJlKGNvb2xkb3duW19mcm9tXVtfdG9dIDw9IG5vdyk7CiAgICAgICAgdmFyIF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVtfdG9dOwogICAgICAgIGlmIChfZnJvbSA9PSBzZWxmQWRkcmVzcykgewogICAgICAgICAgICBtb250aGx5TGltaXRbX3RvXSA9IHNhZmVTdWIobW9udGhseUxpbWl0W190b10sIF92YWx1ZSk7CiAgICAgICAgfQogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dK192YWx1ZTsKICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBzYWZlU3ViKGJhbGFuY2VzW19mcm9tXSwgX3ZhbHVlKTsKICAgICAgICBhbGxvd2VkW19mcm9tXVtfdG9dID0gc2FmZVN1YihfYWxsb3dhbmNlLCBfdmFsdWUpOwogICAgICAgIGFkZFVzZXIoX3RvKTsKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQogICAgCiAgICAvKioKCSAqIEBub3RpY2UgQXV0aG9yaXplIGFuIGFkZHJlc3MgdG8gcmV0cmlldmUgZnVuZHMgZnJvbSB5b3UgfiBFUkMtMjAgU3RhbmRhcmQKCSAqIEBkZXYgCgkgICAgICAgIEVhY2ggYXBwcm92YWwgY29tZXMgd2l0aCBhIGRlZmF1bHQgY29vbGRvd24gb2YgMzAgbWludXRlcwoJICAgICAgICB0byBwcmV2ZW50IGFnYWluc3QgdGhlIEVSQy0yMCByYWNlIGF0dGFjay4KCSAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB5b3Ugd2lzaCB0byBhdXRob3JpemUKCSAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgeW91IHdpc2ggdG8gYXV0aG9yaXplCgkgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIGV4dGVybmFsIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKCQljb29sZG93blttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBub3cgKyAzMCBtaW51dGVzOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgfQoJCgkvKioKCSAqIEBub3RpY2UgQXV0aG9yaXplIGFuIGFkZHJlc3MgdG8gcmV0cmlldmUgZnVuZHMgZnJvbSB5b3Ugd2l0aCBhIGN1c3RvbSBjb29sZG93biB+IEVSQy0yMCBTdGFuZGFyZAoJICogQGRldiBBbGxvd2luZyBjdXN0b20gY29vbGRvd24gZm9yIHRoZSBFUkMtMjAgcmFjZSBhdHRhY2sgcHJldmVudGlvbi4KCSAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB5b3Ugd2lzaCB0byBhdXRob3JpemUKCSAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgeW91IHdpc2ggdG8gYXV0aG9yaXplCgkgKiBAcGFyYW0gX2Nvb2xkb3duIFRoZSBhbW91bnQgb2Ygc2Vjb25kcyB0aGUgcmVjaXBpZW50IG5lZWRzIHRvIHdhaXQgYmVmb3JlIHdpdGhkcmF3aW5nIHRoZSBiYWxhbmNlCgkgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUsIHVpbnQyNTYgX2Nvb2xkb3duKSBleHRlcm5hbCB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CgkJY29vbGRvd25bbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gbm93ICsgX2Nvb2xkb3duOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgfQogICAgCiAgICAvKioKCSAqIEBub3RpY2UgVHJhbnNmZXIgdGhlIHNwZWNpZmllZCBhbW91bnQgdG8gdGhlIHRhcmdldCBhZGRyZXNzIH4gRVJDLTIwIFN0YW5kYXJkCgkgKiBAZGV2IAoJICAgICAgICBBIGJvb2xlYW4gaXMgcmV0dXJuZWQgc28gdGhhdCBjYWxsZXJzIG9mIHRoZSBmdW5jdGlvbiAKCSAgICAgICAgd2lsbCBrbm93IGlmIHRoZWlyIHRyYW5zYWN0aW9uIHdlbnQgdGhyb3VnaC4KCSAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgeW91IHdpc2ggdG8gc2VuZCB0aGUgdG9rZW5zIHRvCgkgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHlvdSB3aXNoIHRvIHNlbmQKCSAqIEByZXR1cm4gewoJCQkJCSJzdWNjZXNzIjogIlRyYW5zYWN0aW9uIHN1Y2Nlc3MiCgkJCQl9CiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgZXh0ZXJuYWwgaXNSdW5uaW5nIHJlcXVpcmVUaGF3IHJldHVybnMgKGJvb2wgc3VjY2Vzcyl7CiAgICAgICAgYnl0ZXMgbWVtb3J5IGVtcHR5OwogICAgICAgIGlmIChfdG8gPT0gc2VsZkFkZHJlc3MpIHsKICAgICAgICAgICAgcmV0dXJuIHRyYW5zZmVyVG9TZWxmKF92YWx1ZSwgZW1wdHkpOwogICAgICAgIH0gZWxzZSBpZiAoaXNDb250cmFjdChfdG8pKSB7CiAgICAgICAgICAgIHJldHVybiB0cmFuc2ZlclRvQ29udHJhY3QoX3RvLCBfdmFsdWUsIGVtcHR5KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gdHJhbnNmZXJUb0FkZHJlc3MoX3RvLCBfdmFsdWUsIGVtcHR5KTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8qKgoJICogQG5vdGljZSBDaGVjayB3aGV0aGVyIGFkZHJlc3MgaXMgYSBjb250cmFjdCB+IEVSQy0yMjMgUHJvcG9zZWQgU3RhbmRhcmQKCSAqIEBwYXJhbSBfYWRkcmVzcyBUaGUgYWRkcmVzcyB0byBjaGVjawoJICogQHJldHVybiB7CgkJCQkJImlzX2NvbnRyYWN0IjogIlJlc3VsdCBvZiBxdWVyeSIKCQkJCX0KICAgICAqLwogICAgZnVuY3Rpb24gaXNDb250cmFjdChhZGRyZXNzIF9hZGRyZXNzKSBpbnRlcm5hbCByZXR1cm5zIChib29sIGlzX2NvbnRyYWN0KSB7CiAgICAgICAgdWludCBsZW5ndGg7CiAgICAgICAgYXNzZW1ibHkgewogICAgICAgICAgICBsZW5ndGggOj0gZXh0Y29kZXNpemUoX2FkZHJlc3MpCiAgICAgICAgfQogICAgICAgIHJldHVybiBsZW5ndGggPiAwOwogICAgfQogICAgCiAgICAvKioKCSAqIEBub3RpY2UgVHJhbnNmZXIgdGhlIHNwZWNpZmllZCBhbW91bnQgdG8gdGhlIHRhcmdldCBhZGRyZXNzIHdpdGggZW1iZWRkZWQgYnl0ZXMgZGF0YSB+IEVSQy0yMjMgUHJvcG9zZWQgU3RhbmRhcmQKCSAqIEBkZXYgSW5jbHVkZXMgYW4gZXh0cmEgdHJhbnNmZXJUb1NlbGYgZnVuY3Rpb24gdG8gaGFuZGxlIENhc2lubyBkZXBvc2l0cwoJICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0bwoJICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byB0cmFuc2ZlcgoJICogQHBhcmFtIF9kYXRhIEFueSBleHRyYSBlbWJlZGRlZCBkYXRhIG9mIHRoZSB0cmFuc2FjdGlvbgoJICogQHJldHVybiB7CgkJCQkJInN1Y2Nlc3MiOiAiVHJhbnNhY3Rpb24gc3VjY2VzcyIKCQkJCX0KICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSkgZXh0ZXJuYWwgaXNSdW5uaW5nIHJlcXVpcmVUaGF3IHJldHVybnMgKGJvb2wgc3VjY2Vzcyl7CiAgICAgICAgaWYgKF90byA9PSBzZWxmQWRkcmVzcykgewogICAgICAgICAgICByZXR1cm4gdHJhbnNmZXJUb1NlbGYoX3ZhbHVlLCBfZGF0YSk7CiAgICAgICAgfSBlbHNlIGlmIChpc0NvbnRyYWN0KF90bykpIHsKICAgICAgICAgICAgcmV0dXJuIHRyYW5zZmVyVG9Db250cmFjdChfdG8sIF92YWx1ZSwgX2RhdGEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiB0cmFuc2ZlclRvQWRkcmVzcyhfdG8sIF92YWx1ZSwgX2RhdGEpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLyoqCgkgKiBAbm90aWNlIEhhbmRsZXMgdHJhbnNmZXIgdG8gYW4gRUNBIChFeHRlcm5hbGx5IENvbnRyb2xsZWQgQWNjb3VudCksIGEgbm9ybWFsIGFjY291bnQgfiBFUkMtMjIzIFByb3Bvc2VkIFN0YW5kYXJkCgkgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvCgkgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIHRyYW5zZmVyCgkgKiBAcGFyYW0gX2RhdGEgQW55IGV4dHJhIGVtYmVkZGVkIGRhdGEgb2YgdGhlIHRyYW5zYWN0aW9uCgkgKiBAcmV0dXJuIHsKCQkJCQkic3VjY2VzcyI6ICJUcmFuc2FjdGlvbiBzdWNjZXNzIgoJCQkJfQogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlclRvQWRkcmVzcyhhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9kYXRhKSBpbnRlcm5hbCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHNhZmVTdWIoYmFsYW5jZXNbbXNnLnNlbmRlcl0sIF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10rX3ZhbHVlOwogICAgICAgIGFkZFVzZXIoX3RvKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIC8qKgoJICogQG5vdGljZSBIYW5kbGVzIHRyYW5zZmVyIHRvIGEgY29udHJhY3QgfiBFUkMtMjIzIFByb3Bvc2VkIFN0YW5kYXJkCgkgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvCgkgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIHRyYW5zZmVyCgkgKiBAcGFyYW0gX2RhdGEgQW55IGV4dHJhIGVtYmVkZGVkIGRhdGEgb2YgdGhlIHRyYW5zYWN0aW9uCgkgKiBAcmV0dXJuIHsKCQkJCQkic3VjY2VzcyI6ICJUcmFuc2FjdGlvbiBzdWNjZXNzIgoJCQkJfQogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlclRvQ29udHJhY3QoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBzYWZlU3ViKGJhbGFuY2VzW21zZy5zZW5kZXJdLCBfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dK192YWx1ZTsKICAgICAgICBXZUJldENyeXB0byByZWMgPSBXZUJldENyeXB0byhfdG8pOwogICAgICAgIHJlYy50b2tlbkZhbGxiYWNrKG1zZy5zZW5kZXIsIF92YWx1ZSwgX2RhdGEpOwogICAgICAgIGFkZFVzZXIoX3RvKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIC8qKgoJICogQG5vdGljZSBIYW5kbGVzIENhc2lubyBkZXBvc2l0cyB+IEN1c3RvbSBFUkMtMjIzIFByb3Bvc2VkIFN0YW5kYXJkIEFkZGl0aW9uCgkgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIHRyYW5zZmVyCgkgKiBAcGFyYW0gX2RhdGEgQW55IGV4dHJhIGVtYmVkZGVkIGRhdGEgb2YgdGhlIHRyYW5zYWN0aW9uCgkgKiBAcmV0dXJuIHsKCQkJCQkic3VjY2VzcyI6ICJUcmFuc2FjdGlvbiBzdWNjZXNzIgoJCQkJfQogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlclRvU2VsZih1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2RhdGEpIGludGVybmFsIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gc2FmZVN1YihiYWxhbmNlc1ttc2cuc2VuZGVyXSwgX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tzZWxmQWRkcmVzc10gPSBiYWxhbmNlc1tzZWxmQWRkcmVzc10rX3ZhbHVlOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIHNlbGZBZGRyZXNzLCBfdmFsdWUpOwoJCWFsbG93ZWRbc2VsZkFkZHJlc3NdW21zZy5zZW5kZXJdID0gX3ZhbHVlICsgYWxsb3dlZFtzZWxmQWRkcmVzc11bbXNnLnNlbmRlcl07CgkJQXBwcm92YWwoc2VsZkFkZHJlc3MsIG1zZy5zZW5kZXIsIGFsbG93ZWRbc2VsZkFkZHJlc3NdW21zZy5zZW5kZXJdKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCQoJLyoqCgkgKiBAbm90aWNlIEVtcHR5IHRva2VuRmFsbGJhY2sgbWV0aG9kIHRvIGVuc3VyZSBFUkMtMjIzIGNvbXBhdGliaWxpdHkKCSAqIEBwYXJhbSBfc2VuZGVyIFRoZSBhZGRyZXNzIHdobyBzZW50IHRoZSBFUkMtMjIzIHRva2VucwoJICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0aGUgYWRkcmVzcyBzZW50IHRvIHRoaXMgY29udHJhY3QKCSAqIEBwYXJhbSBfZGF0YSBBbnkgZW1iZWRkZWQgZGF0YSBvZiB0aGUgdHJhbnNhY3Rpb24KCSAqLwoJZnVuY3Rpb24gdG9rZW5GYWxsYmFjayhhZGRyZXNzIF9zZW5kZXIsIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSkge30KCQoJLyoqCgkgKiBAbm90aWNlIENoZWNrIHRoZSBjb29sZG93biByZW1haW5pbmcgdW50aWwgdGhlIGFsbG93ZWUgY2FuIHdpdGhkcmF3IHRoZSBiYWxhbmNlCgkgKiBAcGFyYW0gX2FsbG93ZXIgVGhlIGhvbGRlciBvZiB0aGUgYmFsYW5jZQoJICogQHBhcmFtIF9hbGxvd2VlIFRoZSByZWNpcGllbnQgb2YgdGhlIGJhbGFuY2UKCSAqIEByZXR1cm4gewoJCQkJCSJyZW1haW5pbmciOiAiQ29vbGRvd24gcmVtYWluaW5nIGluIHNlY29uZHMiCgkJCQl9CiAgICAgKi8KCWZ1bmN0aW9uIGNoZWNrQ29vbGRvd24oYWRkcmVzcyBfYWxsb3dlciwgYWRkcmVzcyBfYWxsb3dlZSkgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKCQlpZiAoY29vbGRvd25bX2FsbG93ZXJdW19hbGxvd2VlXSA+IG5vdykgewoJCQlyZXR1cm4gKGNvb2xkb3duW19hbGxvd2VyXVtfYWxsb3dlZV0gLSBub3cpOwoJCX0gZWxzZSB7CgkJCXJldHVybiAwOwoJCX0KCX0KCQoJLyoqCgkgKiBAbm90aWNlIENoZWNrIGhvdyBtdWNoIENhc2lubyB3aXRoZHJhd2FsIGJhbGFuY2UgcmVtYWlucyBmb3IgYWRkcmVzcwoJICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBjaGVjawoJICogQHJldHVybiB7CgkJCQkJInJlbWFpbmluZyI6ICJXaXRoZHJhd2FsIGJhbGFuY2UgcmVtYWluaW5nIgoJCQkJfQogICAgICovCiAgICBmdW5jdGlvbiBjaGVja01vbnRobHlMaW1pdChhZGRyZXNzIF9vd25lcikgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgICAgICByZXR1cm4gbW9udGhseUxpbWl0W19vd25lcl07CiAgICB9CgkKCS8qKgoJICogQG5vdGljZSBSZXRyaWV2ZSBFUkMgVG9rZW5zIHNlbnQgdG8gY29udHJhY3QKCSAqIEBkZXYgRmVlbCBmcmVlIHRvIGNvbnRhY3QgdXMgYW5kIHJldHJpZXZlIHlvdXIgRVJDIHRva2VucyBzaG91bGQgeW91IHdpc2ggc28uCgkgKiBAcGFyYW0gX3Rva2VuIFRoZSB0b2tlbiBjb250cmFjdCBhZGRyZXNzCgkgKi8KICAgIGZ1bmN0aW9uIGNsYWltVG9rZW5zKGFkZHJlc3MgX3Rva2VuKSBpc0FkbWluIGV4dGVybmFsIHsgCgkJcmVxdWlyZShfdG9rZW4gIT0gc2VsZkFkZHJlc3MpOwogICAgICAgIFdlQmV0Q3J5cHRvIHRva2VuID0gV2VCZXRDcnlwdG8oX3Rva2VuKTsgCiAgICAgICAgdWludCBiYWxhbmNlID0gdG9rZW4uYmFsYW5jZU9mKHNlbGZBZGRyZXNzKTsgCiAgICAgICAgdG9rZW4udHJhbnNmZXIoYWRtaW4sIGJhbGFuY2UpOyAKICAgIH0KICAgIAoJLyoqCgkgKiBAbm90aWNlIEZyZWV6ZSB0b2tlbiBjaXJjdWxhdGlvbiAtIHNwbGl0UHJvZml0cyBpbnRlcm5hbAoJICogQGRldiAKCSAgICAgICAgRW5zdXJlcyB0aGF0IG9uZSBkb2Vzbid0IHRyYW5zZmVyIGhpcyB0b3RhbCBiYWxhbmNlIG1pZC1zcGxpdCB0byAKCSAgICAgICAgYW4gYWNjb3VudCBsYXRlciBpbiB0aGUgc3BsaXQgcXVldWUgaW4gb3JkZXIgdG8gcmVjZWl2ZSB0d2ljZSB0aGUKCSAgICAgICAgbW9udGhseSBwcm9maXRzCgkgKi8KICAgIGZ1bmN0aW9uIGFzc2V0RnJlZXplKCkgaW50ZXJuYWwgewogICAgICAgIGlzRnJvemVuID0gdHJ1ZTsKICAgIH0KICAgIAoJLyoqCgkgKiBAbm90aWNlIFJlLWVuYWJsZSB0b2tlbiBjaXJjdWxhdGlvbiAtIHNwbGl0UHJvZml0cyBpbnRlcm5hbAoJICovCiAgICBmdW5jdGlvbiBhc3NldFRoYXcoKSBpbnRlcm5hbCB7CiAgICAgICAgaXNGcm96ZW4gPSBmYWxzZTsKICAgIH0KICAgIAoJLyoqCgkgKiBAbm90aWNlIEZyZWV6ZSB0b2tlbiBjaXJjdWxhdGlvbgoJICogQGRldiBUbyBiZSB1c2VkIG9ubHkgaW4gZXh0cmVtZSBjaXJjdW1zdGFuY2VzLgoJICovCiAgICBmdW5jdGlvbiBlbWVyZ2VuY3lGcmVlemUoKSBpc0FkbWluIGV4dGVybmFsIHsKICAgICAgICBpc0Zyb3plbiA9IHRydWU7CiAgICB9CiAgICAKCS8qKgoJICogQG5vdGljZSBSZS1lbmFibGUgdG9rZW4gY2lyY3VsYXRpb24KCSAqIEBkZXYgVG8gYmUgdXNlZCBvbmx5IGluIGV4dHJlbWUgY2lyY3Vtc3RhbmNlcwoJICovCiAgICBmdW5jdGlvbiBlbWVyZ2VuY3lUaGF3KCkgaXNBZG1pbiBleHRlcm5hbCB7CiAgICAgICAgaXNGcm96ZW4gPSBmYWxzZTsKICAgIH0KCQoJLyoqCgkgKiBAbm90aWNlIERpc2FibGUgdGhlIHNwbGl0dGluZyBmdW5jdGlvbgoJICogQGRldiAKCSAgICAgICAgVG8gYmUgdXNlZCBpbiBjYXNlIHRoZSBzeXN0ZW0gaXMgdXBncmFkZWQgdG8gYSAKCSAgICAgICAgbm9kZS5qcyBvcGVyYXRlZCBwcm9maXQgcmV3YXJkIHN5c3RlbSB2aWEgdGhlIAoJCQlhbHRlckJhbmtCYWxhbmNlIGZ1bmN0aW9uLiBFbnN1cmVzIHNjYWxhYmlsaXR5IAoJCQlpbiBjYXNlIHVzZXJiYXNlIGdldHMgdG9vIGJpZy4KCSAqLwoJZnVuY3Rpb24gZW1lcmdlbmN5U3BsaXRUb2dnbGUoKSBpc0FkbWluIGV4dGVybmFsIHsKCQlzcGxpdEluU2VydmljZSA9ICFzcGxpdEluU2VydmljZTsKCX0KICAgIAoJLyoqCgkgKiBAbm90aWNlIEFkanVzdCB0aGUgcHJpY2Ugb2YgRXRoZXIgYWNjb3JkaW5nIHRvIENvaW4gTWFya2V0IENhcCdzIEFQSQoJICogQGRldiAKCSAgICAgICAgVGhlIHN1YmZvbGRlciBpcyBwdWJsaWMgZG9tYWluIHNvIGFueW9uZSBjYW4gdmVyaWZ5IHRoYXQgd2UgaW5kZWVkIGdvdCB0aGUgcHJpY2UKCSAgICAgICAgZnJvbSBhIHRydXN0ZWQgc291cmNlIGF0IHRoZSB0aW1lIHdlIHVwZGF0ZWQgaXQuIDIgZGVjaW1hbCBwcmVjaXNpb24gaXMgYWNoaWV2ZWQKCSAgICAgICAgYnkgbXVsdGlwbHlpbmcgdGhlIHByaWNlIG9mIEV0aGVyIGJ5IDEwMCBhbmQgdGhlbiBvZmZzZXR0aW5nIHRoZSBtdWx0aXBsaWNhdGlvbgoJICAgICAgICBpbiB0aGUgY2FsY3VsYXRpb24gdGhlIHByaWNlIGlzIHVzZWQgaW4uIFRoZSBUTFNOb3RhcnlQcm9vZiBzdHJpbmcgY2FuIGJlIGFkZGVkCgkgICAgICAgIHRvIHRoZSBlbmQgb2YgaHR0cHM6Ly93ZWJldGNyeXB0by5pby9UTFNOb3RhcnkvIHRvIGdldCB0aGUgcGVyc3BlY3RpdmUgVExTIHByb29mLgoJICogQHBhcmFtIG5ld1ByaWNlIFRoZSBuZXcgRXRoZXJldW0gcHJpY2Ugd2l0aCAyIGRlY2ltYWwgcHJlY2lzaW9uCgkgKiBAcGFyYW0gVExTTm90YXJ5UHJvb2YgVGhlIHdlYmV0Y3J5cHRvLmlvIHN1YmZvbGRlciB0aGUgVExTTm90YXJ5IHByb29mIGlzIHN0b3JlZAoJICovCiAgICBmdW5jdGlvbiBzZXRQcmljZU9mRXRoZXIodWludDI1NiBuZXdQcmljZSwgc3RyaW5nIFRMU05vdGFyeVByb29mKSBleHRlcm5hbCBpc0FkbWluIHsKICAgICAgICBwcmljZVBlckV0aGVyID0gbmV3UHJpY2U7CiAgICAgICAgQ3VycmVudFRMU05Qcm9vZihzZWxmQWRkcmVzcywgVExTTm90YXJ5UHJvb2YpOwogICAgfQoJCgkvKioKCSAqIEBub3RpY2UgR2V0IHRoZSBjdXJyZW50IDItZGVjaW1hbCBwcmVjaXNpb24gcHJpY2UgcGVyIHRva2VuCgkgKiBAZGV2IAoJICAgICAgICBUaGUgcHJpY2UgcmV0YWlucyB0aGUgMiBkZWNpbWFsIHByZWNpc2lvbiBieSBtdWx0aXBseWluZyBpdCB3aXRoCgkgICAgICAgIDEwMCBhbmQgb2Zmc2V0dGluZyB0aGF0IGluIHRoZSBjYWxjdWxhdGlvbnMgdGhlIHByaWNlIGlzIHVzZWQgaW4uCgkgICAgICAgIEZvciBleGFtcGxlIDUwIG1lYW5zIGVhY2ggdG9rZW4gY29zdHMgMC41MCQuCgkgKiBAcmV0dXJuIHsKCQkJCQkicHJpY2UiOiAiUHJpY2Ugb2YgYSBzaW5nbGUgV0JDIFRva2VuIgoJCQkJfQogICAgICovCglmdW5jdGlvbiBnZXRQcmljZVBlclRva2VuKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcHJpY2UpIHsKICAgICAgICBpZiAoYmFsYW5jZXNbc2VsZkFkZHJlc3NdID4gMjAwMDAwMDAwMDAwMDAwKSB7CiAgICAgICAgICAgIHJldHVybiA1MDsKICAgICAgICB9IGVsc2UgaWYgKGJhbGFuY2VzW3NlbGZBZGRyZXNzXSA+IDE1MDAwMDAwMDAwMDAwMCkgewoJCQlyZXR1cm4gMjAwOwoJCX0gZWxzZSBpZiAoYmFsYW5jZXNbc2VsZkFkZHJlc3NdID4gMTAwMDAwMDAwMDAwMDAwKSB7CgkJCXJldHVybiA0MDA7CgkJfSBlbHNlIHsKCQkJcmV0dXJuIDU1MDsKICAgICAgICB9CiAgICB9CgkKCS8qKgoJICogQG5vdGljZSBDb252ZXJ0IFdlaSB0byBXQkMgdG9rZW5zCgkgKiBAZGV2IAoJCSAgICBUaGUgX3ZhbHVlIGlzIG11bHRpcGxpZWQgYnkgMTBeNyBiZWNhdXNlIG9mIHRoZSA3IGRlY2ltYWwgcHJlY2lzaW9uCgkJCW9mIFdCQyBhbmQgdG8gZW5zdXJlIHRoYXQgYSB1c2VyIGNhbiBpbnZlc3QgbGVzcyB0aGFuIDEgZXRoZXIgYW5kIAoJCQlzdGlsbCBnZXQgaGlzIFdCQyB0b2tlbnMsIHByZXZlbnRpbmcgcm91bmRpbmcgZXJyb3JzLiBBIGhhcmQgY2FwCgkJCW9mIDUwMGsgV0JDIHRva2VucyBwZXIgcHVyY2hhc2UgaXMgZW5mb3JjZWQgc28gYXMgdG8gcHJldmVudCB1c2VycwoJCQlmcm9tIGJ1eWluZyBsYXJnZSBhbW91bnRzIGF0IGEgaGlnaGVyIG9yIGxvd2VyIEV0aGVyIHByaWNlIGR1ZSB0byAKCQkJaG91cmx5IHByaWNlIHVwZGF0ZXMuCgkgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgV2VpIHRvIGNvbnZlcnQKCSAqIEByZXR1cm4gewoJCQkJCSJ0b2tlbkFtb3VudCI6ICJBbW91bnQgb2YgV0JDIFRva2VucyBpbnB1dCBpcyB3b3J0aCIKCQkJCX0KICAgICAqLwoJZnVuY3Rpb24gY2FsY3VsYXRlVG9rZW5BbW91bnQodWludDI1NiBfdmFsdWUpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYgdG9rZW5BbW91bnQpIHsKCQl0b2tlbkFtb3VudCA9ICgoX3ZhbHVlKigxMCoqNykvMSBldGhlcikqcHJpY2VQZXJFdGhlcikvZ2V0UHJpY2VQZXJUb2tlbigpOwoJCWFzc2VydCh0b2tlbkFtb3VudCA8PSA1MDAwMDAwMDAwMDAwKTsKCX0KCQoJLyoqCgkgKiBAbm90aWNlIEFkZCB0aGUgYWRkcmVzcyB0byB0aGUgdXNlciBsaXN0IAoJICogQGRldiBVc2VkIGZvciB0aGUgc3BsaXR0aW5nIGZ1bmN0aW9uIHRvIHRha2UgaXQgaW50byBhY2NvdW50CgkgKiBAcGFyYW0gX3VzZXIgVXNlciB0byBhZGQgdG8gZGF0YWJhc2UKCSAqLwoJZnVuY3Rpb24gYWRkVXNlcihhZGRyZXNzIF91c2VyKSBpbnRlcm5hbCB7CgkJaWYgKCFpc0FkZGVkW191c2VyXSkgewogICAgICAgICAgICB1c2Vycy5wdXNoKF91c2VyKTsKICAgICAgICAgICAgbW9udGhseUxpbWl0W191c2VyXSA9IDUwMDAwMDAwMDAwMDA7CiAgICAgICAgICAgIGlzQWRkZWRbX3VzZXJdID0gdHJ1ZTsKICAgICAgICB9Cgl9CiAgICAKCS8qKgoJICogQG5vdGljZSBTcGxpdCB0aGUgbW9udGhseSBwcm9maXRzIG9mIHRoZSBDYXNpbm8gdG8gdGhlIHVzZXJzCgkgKiBAZGV2IAoJCQlUaGUgZm9ybXVsYSB0aGF0IGNhbGN1bGF0ZXMgdGhlIHByb2ZpdCBhIHVzZXIgaXMgb3dlZCBjYW4gYmUgc2VlbiBvbiAKCQkJdGhlIHdoaXRlIHBhcGVyLiBUaGUgYWN0dWFsUHJvZml0U3BsaXQgdmFyaWFibGUgc3RvcmVzIHRoZSBhY3R1YWwgdmFsdWVzCgkgICAJCXRoYXQgYXJlIGRpc3RyaWJ1dGVkIHRvIHRoZSB1c2VycyB0byBwcmV2ZW50IHJvdW5kaW5nIGVycm9ycyBmcm9tIGJ1cm5pbmcgCgkJCXRva2Vucy4gU2luY2UgZ2FzIHJlcXVpcmVtZW50cyB3aWxsIHNwaWtlIHRoZSBtb3JlIHVzZXJzIHVzZSBvdXIgcGxhdGZvcm0sCgkJCWEgbG9vcC1zdGF0ZS1zYXZlIGlzIGltcGxlbWVudGVkIHRvIGVuc3VyZSBzY2FsYWJpbGl0eS4KCSAqLwogICAgZnVuY3Rpb24gc3BsaXRQcm9maXRzKCkgZXh0ZXJuYWwgewoJCXJlcXVpcmUoc3BsaXRJblNlcnZpY2UpOwogICAgICAgIHVpbnQgaTsKICAgICAgICBpZiAoIWlzRnJvemVuKSB7CiAgICAgICAgICAgIHJlcXVpcmUobm93ID49IHJlbGF0aXZlRGF0ZVNhdmUpOwogICAgICAgICAgICBhc3NldEZyZWV6ZSgpOwogICAgICAgICAgICByZXF1aXJlKGJhbGFuY2VzW3NlbGZBZGRyZXNzXSA+IDMwMDAwMDAwMDAwMDAwKTsKICAgICAgICAgICAgcmVsYXRpdmVEYXRlU2F2ZSA9IG5vdyArIDMwIGRheXM7CiAgICAgICAgICAgIGN1cnJlbnRQcm9maXRzID0gKChiYWxhbmNlc1tzZWxmQWRkcmVzc10tMzAwMDAwMDAwMDAwMDApLzEwKSo3OyAKICAgICAgICAgICAgYW1vdW50SW5DaXJjdWxhdGlvbiA9IHNhZmVTdWIoMzAwMDAwMDAwMDAwMDAwLCBiYWxhbmNlc1tzZWxmQWRkcmVzc10pOwogICAgICAgICAgICBjdXJyZW50SXRlcmF0aW9uID0gMDsKCQkJYWN0dWFsUHJvZml0U3BsaXQgPSAwOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGZvciAoaSA9IGN1cnJlbnRJdGVyYXRpb247IGkgPCB1c2Vycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgbW9udGhseUxpbWl0W3VzZXJzW2ldXSA9IDUwMDAwMDAwMDAwMDA7CiAgICAgICAgICAgICAgICBpZiAobXNnLmdhcyA8IDI0MDAwMCkgewogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRJdGVyYXRpb24gPSBpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoJCQkJaWYgKGFsbG93ZWRbc2VsZkFkZHJlc3NdW3VzZXJzW2ldXSA9PSAwKSB7CgkJCQkJY2hlY2tTcGxpdEVuZChpKTsKCQkJCQljb250aW51ZTsKCQkJCX0gZWxzZSBpZiAoKGJhbGFuY2VzW3VzZXJzW2ldXS9hbGxvd2VkW3NlbGZBZGRyZXNzXVt1c2Vyc1tpXV0pIDwgMTkpIHsKCQkJCQljaGVja1NwbGl0RW5kKGkpOwogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQoJCQkJYWN0dWFsUHJvZml0U3BsaXQgKz0gKGJhbGFuY2VzW3VzZXJzW2ldXSpjdXJyZW50UHJvZml0cykvYW1vdW50SW5DaXJjdWxhdGlvbjsKICAgICAgICAgICAgICAgIGJhbGFuY2VzW3VzZXJzW2ldXSArPSAoYmFsYW5jZXNbdXNlcnNbaV1dKmN1cnJlbnRQcm9maXRzKS9hbW91bnRJbkNpcmN1bGF0aW9uOwoJCQkJY2hlY2tTcGxpdEVuZChpKTsKICAgICAgICAgICAgICAgIFRyYW5zZmVyKHNlbGZBZGRyZXNzLCB1c2Vyc1tpXSwgKGJhbGFuY2VzW3VzZXJzW2ldXS9hbW91bnRJbkNpcmN1bGF0aW9uKSpjdXJyZW50UHJvZml0cyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgkKCS8qKgoJICogQG5vdGljZSBDaGFuZ2UgdmFyaWFibGVzIG9uIHNwbGl0IGVuZAoJICogQHBhcmFtIGkgVGhlIGN1cnJlbnQgaW5kZXggb2YgdGhlIHNwbGl0IGxvb3AKCSAqLwoJZnVuY3Rpb24gY2hlY2tTcGxpdEVuZCh1aW50MjU2IGkpIGludGVybmFsIHsKCQlpZiAoaSA9PSB1c2Vycy5sZW5ndGgtMSkgewoJCQlhc3NldFRoYXcoKTsKCQkJYmFsYW5jZXNbMHgxNjZDYjQ4OTczQzI0NDdkYWZGQThFRmQzNTI2ZGExODA3NjA4OGRlXSA9IGJhbGFuY2VzWzB4MTY2Q2I0ODk3M0MyNDQ3ZGFmRkE4RUZkMzUyNmRhMTgwNzYwODhkZV0gKyBjdXJyZW50UHJvZml0cy8yMjsKCQkJYmFsYW5jZXNbc2VsZkFkZHJlc3NdID0gYmFsYW5jZXNbc2VsZkFkZHJlc3NdIC0gYWN0dWFsUHJvZml0U3BsaXQgLSBjdXJyZW50UHJvZml0cy8yMjsKCQl9Cgl9CgkKCS8qKgoJICogQG5vdGljZSBTcGxpdCB0aGUgdW5zb2xkIFdCQyBvZiB0aGUgSUNPCgkgKiBAZGV2IAoJCQlPbmUgdGltZSBmdW5jdGlvbiB0byBkaXN0cmlidXRlIHRoZSB1bnNvbGQgdG9rZW5zLgoJICovCiAgICBmdW5jdGlvbiBJQ09TcGxpdCgpIGV4dGVybmFsIGlzQWRtaW4gb25lVGltZSB7CiAgICAgICAgdWludCBpOwogICAgICAgIGlmICghaXNGcm96ZW4pIHsKICAgICAgICAgICAgcmVxdWlyZSgocmVsYXRpdmVEYXRlU2F2ZSAtIG5vdykgPj0gKHJlbGF0aXZlRGF0ZVNhdmUgLSAxNTAgZGF5cykpOwogICAgICAgICAgICBhc3NldEZyZWV6ZSgpOwogICAgICAgICAgICByZXF1aXJlKGJhbGFuY2VzW3NlbGZBZGRyZXNzXSA+IDUwMDAwMDAwMDAwMDAwKTsKICAgICAgICAgICAgY3VycmVudFByb2ZpdHMgPSAoKGJhbGFuY2VzW3NlbGZBZGRyZXNzXSAtIDUwMDAwMDAwMDAwMDAwKSAvIDEwKSAqIDc7IAogICAgICAgICAgICBhbW91bnRJbkNpcmN1bGF0aW9uID0gc2FmZVN1YigzMDAwMDAwMDAwMDAwMDAsIGJhbGFuY2VzW3NlbGZBZGRyZXNzXSk7CiAgICAgICAgICAgIGN1cnJlbnRJdGVyYXRpb24gPSAwOwoJCQlhY3R1YWxQcm9maXRTcGxpdCA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZm9yIChpID0gY3VycmVudEl0ZXJhdGlvbjsgaSA8IHVzZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAobXNnLmdhcyA8IDI0MDAwMCkgewogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRJdGVyYXRpb24gPSBpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoJCQkJYWN0dWFsUHJvZml0U3BsaXQgKz0gKGJhbGFuY2VzW3VzZXJzW2ldXSpjdXJyZW50UHJvZml0cykvYW1vdW50SW5DaXJjdWxhdGlvbjsKICAgICAgICAgICAgICAgIGJhbGFuY2VzW3VzZXJzW2ldXSArPSAoYmFsYW5jZXNbdXNlcnNbaV1dKmN1cnJlbnRQcm9maXRzKS9hbW91bnRJbkNpcmN1bGF0aW9uOwogICAgICAgICAgICAgICAgaWYgKGkgPT0gdXNlcnMubGVuZ3RoLTEpIHsKICAgICAgICAgICAgICAgICAgICBhc3NldFRoYXcoKTsKICAgICAgICAgICAgICAgICAgICBiYWxhbmNlc1tzZWxmQWRkcmVzc10gPSBiYWxhbmNlc1tzZWxmQWRkcmVzc10gLSBhY3R1YWxQcm9maXRTcGxpdDsKCQkJCQloYXNJQ09SdW4gPSB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgVHJhbnNmZXIoc2VsZkFkZHJlc3MsIHVzZXJzW2ldLCAoYmFsYW5jZXNbdXNlcnNbaV1dL2Ftb3VudEluQ2lyY3VsYXRpb24pKmN1cnJlbnRQcm9maXRzKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCQoJLyoqCgkgKiBAbm90aWNlIFNpZ24gdGhhdCB0aGUgREFwcCBpcyByZWFkeQoJICogQGRldiAKCSAgICAgICAgT25seSB0aGUgY29yZSB0ZWFtIG1lbWJlcnMgaGF2ZSBhY2Nlc3MgdG8gdGhpcyBmdW5jdGlvbi4gVGhpcyBpcyAKCSAgICAgICAgY3JlYXRlZCBhcyBhbiBleHRyYSBsYXllciBvZiBzZWN1cml0eSBmb3IgaW52ZXN0b3JzIGFuZCB1c2VycyBvZiAKCQkJdGhlIGNvaW4sIHNpbmNlIGEgbXVsdGktc2lnbmF0dXJlIGFwcHJvdmFsIGlzIHJlcXVpcmVkIGJlZm9yZSB0aGUgCgkJCWZ1bmN0aW9uIHRoYXQgYWx0ZXJzIHRoZSBDYXNpbm8gYmFsYW5jZSBpcyB1c2VkLgoJICovCiAgICBmdW5jdGlvbiBhc3N1cmVEQXBwSXNSZWFkeSgpIGV4dGVybmFsIHsKICAgICAgICBpZiAobXNnLnNlbmRlciA9PSAweDE2NkNiNDg5NzNDMjQ0N2RhZkZBOEVGZDM1MjZkYTE4MDc2MDg4ZGUpIHsKICAgICAgICAgICAgZGV2QXBwcm92YWxzWzBdID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgaWYgKG1zZy5zZW5kZXIgPT0gMHgxYWIxM0QyQzFBQzQzMDM3Mzc5ODFDZThCOGJENTExNkM4NGM3NDRkKSB7CiAgICAgICAgICAgIGRldkFwcHJvdmFsc1sxXSA9IHRydWU7CiAgICAgICAgfSBlbHNlIGlmIChtc2cuc2VuZGVyID09IDB4RUM1YTQ4ZDZGMTFGOGE5ODFhYTNEOTEzREEwQTY5MTk0MjgwY0RCYykgewogICAgICAgICAgICBkZXZBcHByb3ZhbHNbMl0gPSB0cnVlOwogICAgICAgIH0gZWxzZSBpZiAobXNnLnNlbmRlciA9PSAweEU1OUNiRDAyOGY3MTQ0N0I4MDRGMzFDZjBmQzQxRjBlNUUxM2Y0YkYpIHsKICAgICAgICAgICAgZGV2QXBwcm92YWxzWzNdID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewoJCQlyZXZlcnQoKTsKCQl9CiAgICB9CgkKCS8qKgogICAgICogQG5vdGljZSBWZXJpZnkgdGhhdCB0aGUgREFwcCBpcyByZWFkeQoJICogQGRldiAKCQkJU2luY2UgaXRlcmF0aW5nIHRocm91Z2ggdGhlIGRldkFwcHJvdmFscyBhcnJheSBjb3N0cyBnYXMKCQkJYW5kIHRoZSBmdW5jdGlvbnMgd2l0aCB0aGUgREFwcE9ubGluZSBtb2RpZmllciBhcmUgZ29pbmcKCQkJdG8gYmUgcmVwZXRpdGl2ZWx5IHVzZWQsIGl0IGlzIGJldHRlciB0byBzdG9yZSB0aGUgREFwcAoJCQlzdGF0ZSBpbiBhIHZhcmlhYmxlIHRoYXQgbmVlZHMgdG8gYmUgYWx0ZXJlZCBvbmNlLgoJICovCiAgICBmdW5jdGlvbiBpc0RBcHBSZWFkeSgpIGV4dGVybmFsIGlzQWRtaW4gewogICAgICAgIHVpbnQ4IG51bU9mQXBwcm92YWxzID0gMDsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBkZXZBcHByb3ZhbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGRldkFwcHJvdmFsc1tpXSkgewogICAgICAgICAgICAgICAgbnVtT2ZBcHByb3ZhbHMrKzsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBEQXBwUmVhZHkgPSAobnVtT2ZBcHByb3ZhbHM+PTIpOwogICAgfQogICAgCgkvKioKCSAqIEBub3RpY2UgUmlzZSBvciBsb3dlciB1c2VyIGJhbmsgYmFsYW5jZSAtIEJhY2tlbmQgRnVuY3Rpb24KCSAqIEBkZXYgCgkgICAgICAgIFRoaXMgYWxsb3dzIHJlYWwtdGltZSBhZGp1c3RtZW50IG9mIHRoZSBiYWxhbmNlIGEgdXNlciBoYXMgd2l0aGluIHRoZSBDYXNpbm8gdG8KCQkJcmVwcmVzZW50IGVhcm5pbmdzIGFuZCBsb3NzZXMuIFVuZGVyZmxvdyBpbXBvc3NpYmxlIHNpbmNlIG9ubHkgYmV0cyBjYW4gbG93ZXIgdGhlCgkJCWJhbGFuY2UuCgkgKiBAcGFyYW0gX3RvQWx0ZXIgVGhlIGFkZHJlc3Mgd2hvc2UgQ2FzaW5vIGJhbGFuY2UgdG8gYWx0ZXIKCSAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgdG8gYWx0ZXIgaXQgYnkKCSAqLwogICAgZnVuY3Rpb24gYWx0ZXJCYW5rQmFsYW5jZShhZGRyZXNzIF90b0FsdGVyLCB1aW50MjU2IF9hbW91bnQsIGJvb2wgc2lnbikgZXh0ZXJuYWwgREFwcE9ubGluZSBpc0FkbWluIHsKICAgICAgICBpZiAoc2lnbiAmJiAoX2Ftb3VudCthbGxvd2VkW3NlbGZBZGRyZXNzXVtfdG9BbHRlcl0pID4gYWxsb3dlZFtzZWxmQWRkcmVzc11bX3RvQWx0ZXJdKSB7CgkJCWFsbG93ZWRbc2VsZkFkZHJlc3NdW190b0FsdGVyXSA9IF9hbW91bnQgKyBhbGxvd2VkW3NlbGZBZGRyZXNzXVtfdG9BbHRlcl07CgkJCUFwcHJvdmFsKHNlbGZBZGRyZXNzLCBfdG9BbHRlciwgYWxsb3dlZFtzZWxmQWRkcmVzc11bX3RvQWx0ZXJdKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhbGxvd2VkW3NlbGZBZGRyZXNzXVtfdG9BbHRlcl0gPSBzYWZlU3ViKGFsbG93ZWRbc2VsZkFkZHJlc3NdW190b0FsdGVyXSwgX2Ftb3VudCk7CgkJCUFwcHJvdmFsKHNlbGZBZGRyZXNzLCBfdG9BbHRlciwgYWxsb3dlZFtzZWxmQWRkcmVzc11bX3RvQWx0ZXJdKTsKICAgICAgICB9CiAgICB9CiAgICAKCS8qKgoJICogQG5vdGljZSBGcmVlemUgdXNlciBkdXJpbmcgcGxhdGZvcm0gdXNlIC0gQmFja2VuZCBGdW5jdGlvbgoJICogQGRldiBQcmV2ZW50cyBhZ2FpbnN0IHRoZSBFUkMtMjAgcmFjZSBhdHRhY2sgb24gdGhlIENhc2lubwoJICogQHBhcmFtIF91c2VyIFRoZSB1c2VyIHRvIGZyZWV6ZQoJICovCiAgICBmdW5jdGlvbiBsb2dpblVzZXIoYWRkcmVzcyBfdXNlcikgZXh0ZXJuYWwgREFwcE9ubGluZSBpc0FkbWluIHsKICAgICAgICBmcmVlemVVc2VyW191c2VyXSA9IHRydWU7CiAgICB9CgkKCS8qKgoJICogQG5vdGljZSBEZS1GcmVlemUgdXNlciAtIEJhY2tlbmQgRnVuY3Rpb24KICAgICAqIEBkZXYgVXNlZCB3aGVuIGEgdXNlciBsb2dzIG91dCBvciBsb3NlcyBjb25uZWN0aW9uIHdpdGggdGhlIERBcHAKCSAqIEBwYXJhbSBfdXNlciBUaGUgdXNlciB0byBkZS1mcmVlemUKCSAqLwoJZnVuY3Rpb24gbG9nb3V0VXNlcihhZGRyZXNzIF91c2VyKSBleHRlcm5hbCBEQXBwT25saW5lIGlzQWRtaW4gewoJCWZyZWV6ZVVzZXJbX3VzZXJdID0gZmFsc2U7Cgl9CiAgICAKICAgIC8qKgoJICogQG5vdGljZSBGYWxsYmFjayBmdW5jdGlvbiAKCSAqIEBkZXYgVHJpZ2dlcmVkIHdoZW4gRXRoZXIgaXMgc2VudCB0byB0aGUgY29udHJhY3QuIFRocm93cyBpbnRlbnRpb25hbGx5IHRvIHJlZnVuZCB0aGUgc2VuZGVyLgoJICovCiAgICBmdW5jdGlvbigpIHBheWFibGUgewoJCXJldmVydCgpOwogICAgfQoJCgkvKioKCSAqIEBub3RpY2UgUHVyY2hhc2UgV0JDIFRva2VucyBmb3IgQWRkcmVzcyAtIElDTwoJICogQHBhcmFtIF9yZWNpcGllbnQgVGhlIHJlY2lwaWVudCBvZiB0aGUgV0JDIHRva2VucwoJICovCglmdW5jdGlvbiBidXlUb2tlbnNGb3JBZGRyZXNzKGFkZHJlc3MgX3JlY2lwaWVudCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgdG90YWxGdW5kcyA9IHRvdGFsRnVuZHMgKyBtc2cudmFsdWU7CiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPiAwKTsKCQlyZXF1aXJlKF9yZWNpcGllbnQgIT0gYWRtaW4pOwoJCXJlcXVpcmUoKHRvdGFsRnVuZHMvMSBldGhlcikqcHJpY2VQZXJFdGhlciA8IDYwMDAwMDAwMDApOwogICAgICAgIGFkZFVzZXIoX3JlY2lwaWVudCk7CgkJdWludCB0b2tlbkFtb3VudCA9IGNhbGN1bGF0ZVRva2VuQW1vdW50KG1zZy52YWx1ZSk7CgkJYmFsYW5jZXNbc2VsZkFkZHJlc3NdID0gYmFsYW5jZXNbc2VsZkFkZHJlc3NdIC0gdG9rZW5BbW91bnQ7CgkJYXNzZXJ0KGJhbGFuY2VzW3NlbGZBZGRyZXNzXSA+PSA1MDAwMDAwMDAwMDAwMCk7CiAgICAgICAgYmFsYW5jZXNbX3JlY2lwaWVudF0gPSBiYWxhbmNlc1tfcmVjaXBpZW50XSArIHRva2VuQW1vdW50OwogICAgICAgIFRyYW5zZmVyKHNlbGZBZGRyZXNzLCBfcmVjaXBpZW50LCB0b2tlbkFtb3VudCk7CiAgICAgICAgYWRkcmVzcyBldGhlclRyYW5zZmVyID0gMHgxNjZDYjQ4OTczQzI0NDdkYWZGQThFRmQzNTI2ZGExODA3NjA4OGRlOwogICAgICAgIGV0aGVyVHJhbnNmZXIudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgIH0KCQoJLyoqCgkgKiBAbm90aWNlIFB1cmNoYXNlIFdCQyBUb2tlbnMgZm9yIFNlbGYgLSBJQ08KCSAqLwoJZnVuY3Rpb24gYnV5VG9rZW5zRm9yU2VsZigpIGV4dGVybmFsIHBheWFibGUgewogICAgICAgIHRvdGFsRnVuZHMgPSB0b3RhbEZ1bmRzICsgbXNnLnZhbHVlOwoJCWFkZHJlc3MgZXRoZXJUcmFuc2ZlciA9IDB4MTY2Q2I0ODk3M0MyNDQ3ZGFmRkE4RUZkMzUyNmRhMTgwNzYwODhkZTsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+IDApOwoJCXJlcXVpcmUobXNnLnNlbmRlciAhPSBldGhlclRyYW5zZmVyKTsKCQlyZXF1aXJlKCh0b3RhbEZ1bmRzLzEgZXRoZXIpKnByaWNlUGVyRXRoZXIgPCA2MDAwMDAwMDAwKTsKICAgICAgICBhZGRVc2VyKG1zZy5zZW5kZXIpOwoJCXVpbnQgdG9rZW5BbW91bnQgPSBjYWxjdWxhdGVUb2tlbkFtb3VudChtc2cudmFsdWUpOwoJCWJhbGFuY2VzW3NlbGZBZGRyZXNzXSA9IGJhbGFuY2VzW3NlbGZBZGRyZXNzXSAtIHRva2VuQW1vdW50OwoJCWFzc2VydChiYWxhbmNlc1tzZWxmQWRkcmVzc10gPj0gNTAwMDAwMDAwMDAwMDApOwogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0gKyB0b2tlbkFtb3VudDsKICAgICAgICBUcmFuc2ZlcihzZWxmQWRkcmVzcywgbXNnLnNlbmRlciwgdG9rZW5BbW91bnQpOwogICAgICAgIGV0aGVyVHJhbnNmZXIudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgIH0KfQ=='.
	

]
