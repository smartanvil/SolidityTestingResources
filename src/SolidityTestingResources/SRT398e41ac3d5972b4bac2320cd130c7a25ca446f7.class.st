Class {
	#name : #SRT398e41ac3d5972b4bac2320cd130c7a25ca446f7,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT398e41ac3d5972b4bac2320cd130c7a25ca446f7 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjE7CgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCi8qKgogKiBAdGl0bGUgU2FmZU1hdGgKICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCmxpYnJhcnkgU2FmZU1hdGggewoKICAvKioKICAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAgKi8KICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKGEgPT0gMCkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICAvKioKICAgKiBAZGV2IEludGVnZXIgZGl2aXNpb24gb2YgdHdvIG51bWJlcnMsIHRydW5jYXRpbmcgdGhlIHF1b3RpZW50LgogICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgICogQGRldiBTdWJ0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAgKi8KICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICAvKioKICAgKiBAZGV2IEFkZHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKCi8qKgogKiBAdGl0bGUgQ3Jvd2RzYWxlCiAqIEBkZXYgQ3Jvd2RzYWxlIGlzIGEgYmFzZSBjb250cmFjdCBmb3IgbWFuYWdpbmcgYSB0b2tlbiBjcm93ZHNhbGUsCiAqIGFsbG93aW5nIGludmVzdG9ycyB0byBwdXJjaGFzZSB0b2tlbnMgd2l0aCBldGhlci4KICogVGhlIGV4dGVybmFsIGludGVyZmFjZSByZXByZXNlbnRzIHRoZSBiYXNpYyBpbnRlcmZhY2UgZm9yIHB1cmNoYXNpbmcgdG9rZW5zLCBhbmQgY29uZm9ybQogKiB0aGUgYmFzZSBhcmNoaXRlY3R1cmUgZm9yIGNyb3dkc2FsZXMuIAogKgogKiBQcmVzYWxlczoKICogQ2VydGFpbiBhZGRyZXNzZXMgYXJlIGFsbG93ZWQgdG8gYnV5IGF0IGEgcHJlc2FsZSByYXRlIGR1cmluZyB0aGUgcHJlc2FsZSBwZXJpb2QuIFRoZQogKiBjb250cmlidXRpb24gb2YgdGhlIGludmVzdG9yIG5lZWRzIHRvIGJlIG9mIGF0IGxlYXN0IDUgRVRILiBBIG1heGltdW0gb2YgMTUgbWlsbGlvbiB0b2tlbnMKICogaW4gdG90YWwgY2FuIGJlIGJvdWdodCBhdCB0aGUgcHJlc2FsZSByYXRlLiBPbmNlIHRoZSBwcmVzYWxlIGhhcyBiZWVuIGluc3RydWN0ZWQgdG8gZW5kLCBpdAogKiBpcyBub3QgcG9zc2libGUgdG8gZW5hYmxlIGl0IGFnYWluLgogKgogKiBTYWxlczoKICogQW55IGFkZHJlc3MgY2FuIHB1cmNoYXNlIGF0IHRoZSByZWd1bGFyIHNhbGUgcHJpY2UuIFNhbGVzIGNhbiBiZSBwYXVzZXMsIHJlc3VtZWQsIGFuZCBzdG9wcGVkLgogKgogKiBNaW50aW5nOgogKiBUaGUgdHJhbnNmZXJUb2tlbnMgZnVuY3Rpb24gd2lsbCBtaW50IHRoZSB0b2tlbnMgaW4gdGhlIFRva2VuIGNvbnRyYWN0LiBBZnRlciB0aGUgbWludGluZyAKICogaXMgZG9uZSwgdGhlIENyb3dkc2FsZSBpcyByZXNldC4KICogCiAqIFJlZnVuZHM6CiAqIEEgaW52ZXN0b3IgY2FuIGJlIHJlZnVuZGVkIGJ5IHRoZSBvd25lci4gQ2FsbGluZyB0aGUgcmVmdW5kIGZ1bmN0aW9uIHJlc2V0cyB0aGUgdG9rZW5zIGJvdWdodAogKiB0byB6ZXJvIGZvciB0aGF0IGludmVzdG9yLiBUaGUgRXRoZXIgcmVmdW5kIG5lZWRzIHRvIGJlIHByb2Nlc3NlZCBtYW51YWxseS4gSXQgaXMgaW1wb3J0YW50CiAqIHRvIHJlY29yZCBob3cgbWFueSB0b2tlbnMgdGhlIGludmVzdG9yIGhhZCBib3VnaHQgYmVmb3JlIGNhbGxpbmcgcmVmdW5kKCkuCiAqCiovCmNvbnRyYWN0IENyb3dkc2FsZSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIC8vIFRoZSB0b2tlbiBiZWluZyBzb2xkCiAgU3RhbmRhcmRUb2tlbiBwdWJsaWMgdG9rZW47CgogIC8vIEhvdyBtYW55IHRva2VuIHVuaXRzIGEgYnV5ZXIgZ2V0cyBwZXIgd2VpCiAgdWludDI1NiBwdWJsaWMgcmF0ZTsKCiAgLy8gSG93IG1hbnkgdG9rZW4gdW5pdHMgYSBidXllciBnZXRzIHBlciB3ZWkgaWYgZW50aXRsZWQgdG8gdGhlIHByZXNhbGUKICB1aW50IHB1YmxpYyBwcmVzYWxlUmF0ZTsKCiAgLy8gQW1vdW50IG9mIHdlaSByYWlzZWQKICB1aW50MjU2IHB1YmxpYyB3ZWlSYWlzZWQ7CgogIC8vIEFkbWluaXN0cmF0b3Igb2YgdGhlIHNhbGUKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgLy8gSG93IG1hbnkgdG9rZW5zIGVhY2ggYWRkcmVzcyBib3VnaHQgYXQgdGhlIG5vcm1hbCByYXRlCiAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgcmVndWxhclRva2Vuc1NvbGQ7CgogIC8vIEhvdyBtYW55IHRva2VucyBlYWNoIGFkZHJlc3MgYm91Z2h0IGF0IHRoZSBwcmVzYWxlIHJhdGUKICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBwcmVzYWxlVG9rZW5zU29sZDsKCiAgLy8gTGlzdCBvZiBhbGwgdGhlIGludmVzdG9ycwogIGFkZHJlc3NbXSBwdWJsaWMgaW52ZXN0b3JzOwoKICAvLyBXaGV0aGVyIHRoZSBzYWxlIGlzIGFjdGl2ZQogIGJvb2wgcHVibGljIGluU2FsZSA9IHRydWU7CgogIC8vIFdoZXRoZXIgdGhlIHByZXNhbGUgaXMgYWN0aXZlCiAgYm9vbCBwdWJsaWMgaW5QcmVzYWxlID0gdHJ1ZTsKCiAgLy8gSG93IG1hbnkgdG9rZW5zIGVhY2ggYWRkcmVzcyBjYW4gYnV5IGF0IHRoZSBwcmVzYWxlIHJhdGUKICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBwcmVzYWxlQWxsb2NhdGlvbnM7CgogIC8vIFRoZSB0b3RhbCBudW1iZXIgb2YgdG9rZW5zIGJvdWdodAogIHVpbnQyNTYgcHVibGljIHRvdGFsUHJlc2FsZVRva2Vuc1NvbGQgPSAwOwoKICAvLyBUaGUgdG90YWwgbnVtYmVyIG9mIHRva2VucyBib3VnaHQKICB1aW50MjU2IHB1YmxpYyB0b3RhbFJlZ3VsYXJUb2tlbnNTb2xkID0gMDsKCiAgLy8gVGhlIG1heGltdW0gbnVtYmVyIG9mIHRva2VucyB3aGljaCBjYW4gYmUgc29sZCBkdXJpbmcgcHJlc2FsZQogIHVpbnQyNTYgY29uc3RhbnQgcHVibGljIFBSRVNBTEVUT0tFTk1BWFNBTEVTID0gMTUwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA7CgogIC8vIFRoZSBtYXhpbXVtIG51bWJlciBvZiB0b2tlbnMgd2hpY2ggY2FuIGJlIHNvbGQgZHVyaW5nIHJlZ3VsYXIgc2FsZQogIHVpbnQyNTYgcHVibGljIHJlZ3VsYXJUb2tlbk1heFNhbGVzID0gMTYwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA7CgogIC8vIFRoZSBtaW5pbXVtIGludmVzdG1lbnQgKDUgRVRIKSBkdXJpbmcgcHJlc2FsZQogIHVpbnQyNTYgY29uc3RhbnQgcHVibGljIE1JTklNVU1JTlZFU1RNRU5UUFJFU0FMRSA9IDUwMDAwMDAwMDAwMDAwMDAwMDA7CgogIC8vIFRoZSBtaW5pbXVtIGludmVzdG1lbnQgKDUgRVRIKSBkdXJpbmcgc2FsZQogIHVpbnQyNTYgY29uc3RhbnQgcHVibGljIE1JTklNVU1JTlZFU1RNRU5UU0FMRSA9IDEwMDAwMDAwMDAwMDAwMDAwMDA7CgogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCiAgbW9kaWZpZXIgb25seUR1cmluZ1ByZXNhbGUoKSB7CiAgICByZXF1aXJlKGluUHJlc2FsZSk7CiAgICBfOwogIH0KCiAgbW9kaWZpZXIgb25seVdoZW5TYWxlc0VuYWJsZWQoKSB7CiAgICByZXF1aXJlKGluU2FsZSk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogRXZlbnQgZm9yIHRva2VuIHB1cmNoYXNlIGxvZ2dpbmcKICAgKiBAcGFyYW0gcHVyY2hhc2VyIHdobyBwYWlkIGZvciB0aGUgdG9rZW5zCiAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IHdobyBnb3QgdGhlIHRva2VucwogICAqIEBwYXJhbSB2YWx1ZSB3ZWlzIHBhaWQgZm9yIHB1cmNoYXNlCiAgICogQHBhcmFtIGFtb3VudCBhbW91bnQgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAqIEBwYXJhbSByYXRlIHRoZSByYXRlIGF0IHdoaWNoIHRoZSB0b2tlbnMgd2VyZSBwdXJjaGFzZWQKICAgKi8KICBldmVudCBUb2tlblB1cmNoYXNlKGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB2YWx1ZSwgdWludDI1NiBhbW91bnQsIHVpbnQyNTYgcmF0ZSk7CgogIC8qKgogICAqIENvbnN0cnVjdG9yIGZvciB0aGUgY3Jvd2RzYWxlCiAgICogQHBhcmFtIF9vd25lciBvd25lciBvZiB0aGUgY29udHJhY3QsIHdoaWNoIGNhbiBjYWxsIHByaXZpbGVnZWQgZnVuY3Rpb25zLCBhbmQgd2hlcmUgZXZlcnkgZXRoZXIKICAgKiAgICAgICAgaXMgc2VudCB0bwogICAqIEBwYXJhbSBfcmF0ZSB0aGUgcmF0ZSBmb3IgcmVndWxhciBzYWxlcwogICAqIEBwYXJhbSBfcmF0ZSB0aGUgcmF0ZSBmb3IgcHJlc2FsZXMKICAgKiBAcGFyYW0gX293bmVySW5pdGlhbFRva2VucyB0aGUgbnVtYmVyIG9mIHRva2VucyB0aGUgb3duZXIgaXMgYWxsb2NhdGVkIGluaXRpYWxseQogICAqLwogIGZ1bmN0aW9uIENyb3dkc2FsZSgKICAgIGFkZHJlc3MgX293bmVyLCAKICAgIHVpbnQyNTYgX3JhdGUsIAogICAgdWludDI1NiBfcHJlc2FsZVJhdGUsIAogICAgdWludDI1NiBfb3duZXJJbml0aWFsVG9rZW5zCiAgKSBwdWJsaWMgcGF5YWJsZSB7CiAgICByZXF1aXJlKF9yYXRlID4gMCk7CiAgICByZXF1aXJlKF9wcmVzYWxlUmF0ZSA+IDApOwogICAgcmVxdWlyZShfb3duZXIgIT0gYWRkcmVzcygwKSk7CgogICAgcmF0ZSA9IF9yYXRlOwogICAgcHJlc2FsZVJhdGUgPSBfcHJlc2FsZVJhdGU7CiAgICBvd25lciA9IF9vd25lcjsKCiAgICBpbnZlc3RvcnMucHVzaChvd25lcik7CiAgICByZWd1bGFyVG9rZW5zU29sZFtvd25lcl0gPSBfb3duZXJJbml0aWFsVG9rZW5zOwogIH0KCiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAvLyBDcm93ZHNhbGUgZXh0ZXJuYWwgaW50ZXJmYWNlCiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgZnVuY3Rpb24gKCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICBidXlUb2tlbnMoKTsKICB9CgogIC8qKgogICAqIFNldHMgdGhlIGFkZHJlc3Mgb2YgdGhlIFRva2VuIGNvbnRyYWN0LgogICAqLwogIGZ1bmN0aW9uIHNldFRva2VuKFN0YW5kYXJkVG9rZW4gX3Rva2VuKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHRva2VuID0gX3Rva2VuOwogIH0KCiAgLyoqCiAgICogQnV5IGEgdG9rZW4gYXQgcHJlc2FsZSBwcmljZS4gQ29udmVydHMgRVRIIHRvIGFzIG11Y2ggUU5UIHRoZSBzZW5kZXIgY2FuIHB1cmNoYXNlLiBBbnkgY2hhbmdlCiAgICogaXMgcmVmdW5kZWQgdG8gdGhlIHNlbmRlci4gTWluaW11bSBjb250cmlidXRpb24gaXMgNSBFVEguCiAgICovCiAgZnVuY3Rpb24gYnV5UHJlc2FsZVRva2VucygpIG9ubHlEdXJpbmdQcmVzYWxlIG9ubHlXaGVuU2FsZXNFbmFibGVkIHB1YmxpYyBwYXlhYmxlIHsKICAgIGFkZHJlc3MgX2JlbmVmaWNpYXJ5ID0gbXNnLnNlbmRlcjsKICAgIHVpbnQyNTYgd2VpQW1vdW50ID0gbXNnLnZhbHVlOwoKICAgIF9wcmVWYWxpZGF0ZVB1cmNoYXNlKF9iZW5lZmljaWFyeSk7CiAgICByZXF1aXJlKHdlaUFtb3VudCA+PSBNSU5JTVVNSU5WRVNUTUVOVFBSRVNBTEUpOwoKICAgIHVpbnQyNTYgcHJlc2FsZUFsbG9jYXRpb24gPSBwcmVzYWxlQWxsb2NhdGlvbnNbX2JlbmVmaWNpYXJ5XTsKCiAgICB1aW50MjU2IHByZXNhbGVUb2tlbnMgPSBfbWluMjU2KHdlaUFtb3VudC5tdWwocHJlc2FsZVJhdGUpLCBwcmVzYWxlQWxsb2NhdGlvbik7CgogICAgX3JlY29yZFByZXNhbGVQdXJjaGFzZShfYmVuZWZpY2lhcnksIHByZXNhbGVUb2tlbnMpOwoKICAgIC8vIFJlbW92ZSBwcmVzYWxlIHRva2VucyBhbGxvY2F0aW9uCiAgICBwcmVzYWxlQWxsb2NhdGlvbnNbX2JlbmVmaWNpYXJ5XSA9IHByZXNhbGVBbGxvY2F0aW9uc1tfYmVuZWZpY2lhcnldLnN1YihwcmVzYWxlVG9rZW5zKTsKCiAgICB1aW50MjU2IHdlaUNoYXJnZWQgPSBwcmVzYWxlVG9rZW5zLmRpdihwcmVzYWxlUmF0ZSk7CgogICAgLy8gUmV0dXJuIGFueSBleHRyYSBXZWkgdG8gdGhlIHNlbmRlcgogICAgdWludDI1NiBjaGFuZ2UgPSB3ZWlBbW91bnQuc3ViKHdlaUNoYXJnZWQpOwogICAgX2JlbmVmaWNpYXJ5LnRyYW5zZmVyKGNoYW5nZSk7CgogICAgLy8gVXBkYXRlIHRvdGFsIG51bWJlciBvZiBXZWkgcmFpc2VkCiAgICB3ZWlSYWlzZWQgPSB3ZWlSYWlzZWQuYWRkKHdlaUFtb3VudC5zdWIoY2hhbmdlKSk7CgogICAgZW1pdCBUb2tlblB1cmNoYXNlKG1zZy5zZW5kZXIsIF9iZW5lZmljaWFyeSwgd2VpQ2hhcmdlZCwgcHJlc2FsZVRva2VucywgcHJlc2FsZVJhdGUpOwoKICAgIC8vIEZvcndhcmQgdGhlIGZ1bmRzIHRvIG93bmVyCiAgICBfZm9yd2FyZEZ1bmRzKHdlaUNoYXJnZWQpOwogIH0KCiAgLyoqCiAgICogQnV5IGEgdG9rZW4gYXQgc2FsZSBwcmljZS4gTWluaW11bSBjb250cmlidXRpb24gaXMgMSBFVEguCiAgICovCiAgZnVuY3Rpb24gYnV5VG9rZW5zKCkgb25seVdoZW5TYWxlc0VuYWJsZWQgcHVibGljIHBheWFibGUgewogICAgYWRkcmVzcyBfYmVuZWZpY2lhcnkgPSBtc2cuc2VuZGVyOwogICAgdWludDI1NiB3ZWlBbW91bnQgPSBtc2cudmFsdWU7CiAgICBfcHJlVmFsaWRhdGVQdXJjaGFzZShfYmVuZWZpY2lhcnkpOwoKICAgIHJlcXVpcmUod2VpQW1vdW50ID49IE1JTklNVU1JTlZFU1RNRU5UU0FMRSk7CgogICAgdWludDI1NiB0b2tlbnMgPSB3ZWlBbW91bnQubXVsKHJhdGUpOwoKICAgIC8vIENoZWNrIHdlIGhhdmVuJ3Qgc29sZCB0b28gbWFueSB0b2tlbnMKICAgIHRvdGFsUmVndWxhclRva2Vuc1NvbGQgPSB0b3RhbFJlZ3VsYXJUb2tlbnNTb2xkLmFkZCh0b2tlbnMpOwogICAgcmVxdWlyZSh0b3RhbFJlZ3VsYXJUb2tlbnNTb2xkIDw9IHJlZ3VsYXJUb2tlbk1heFNhbGVzKTsKCiAgICAvLyBVcGRhdGUgdG90YWwgbnVtYmVyIG9mIFdlaSByYWlzZWQKICAgIHdlaVJhaXNlZCA9IHdlaVJhaXNlZC5hZGQod2VpQW1vdW50KTsKCiAgICBpbnZlc3RvcnMucHVzaChfYmVuZWZpY2lhcnkpOwoKICAgIC8vIEdpdmUgdG9rZW5zCiAgICByZWd1bGFyVG9rZW5zU29sZFtfYmVuZWZpY2lhcnldID0gcmVndWxhclRva2Vuc1NvbGRbX2JlbmVmaWNpYXJ5XS5hZGQodG9rZW5zKTsKCiAgICBlbWl0IFRva2VuUHVyY2hhc2UobXNnLnNlbmRlciwgX2JlbmVmaWNpYXJ5LCB3ZWlBbW91bnQsIHRva2VucywgcmF0ZSk7CgogICAgLy8gRm9yd2FyZCB0aGUgZnVuZHMgdG8gb3duZXIKICAgIF9mb3J3YXJkRnVuZHMod2VpQW1vdW50KTsKICB9CgogIC8qKgogICAqIFJlY29yZHMgYSBwdXJjaGFzZSB3aGljaCBoYXMgYmVlbiBjb21wbGV0ZWQgYmVmb3JlIHRoZSBpbnN0YW50aWF0aW9uIG9mIHRoaXMgY29udHJhY3QuCiAgICogQHBhcmFtIF9iZW5lZmljaWFyeSB0aGUgaW52ZXN0b3IKICAgKiBAcGFyYW0gX3ByZXNhbGVUb2tlbnMgdGhlIG51bWJlciBvZiB0b2tlbnMgd2hpY2ggdGhlIGludmVzdG9yIGhhcyBib3VnaHQKICAgKi8KICBmdW5jdGlvbiByZWNvcmRQcmVzYWxlUHVyY2hhc2UoYWRkcmVzcyBfYmVuZWZpY2lhcnksIHVpbnQyNTYgX3ByZXNhbGVUb2tlbnMpIHB1YmxpYyBvbmx5T3duZXIgewogICAgd2VpUmFpc2VkID0gd2VpUmFpc2VkLmFkZChfcHJlc2FsZVRva2Vucy5kaXYocHJlc2FsZVJhdGUpKTsKICAgIHJldHVybiBfcmVjb3JkUHJlc2FsZVB1cmNoYXNlKF9iZW5lZmljaWFyeSwgX3ByZXNhbGVUb2tlbnMpOwogIH0KCiAgZnVuY3Rpb24gZW5hYmxlU2FsZSgpIG9ubHlPd25lciBwdWJsaWMgewogICAgaW5TYWxlID0gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGRpc2FibGVTYWxlKCkgb25seU93bmVyIHB1YmxpYyB7CiAgICBpblNhbGUgPSBmYWxzZTsKICB9CgogIGZ1bmN0aW9uIGVuZFByZXNhbGUoKSBvbmx5T3duZXIgcHVibGljIHsKICAgIGluUHJlc2FsZSA9IGZhbHNlOwoKICAgIC8vIENvbnZlcnQgdGhlIHVuc29sZCBwcmVzYWxlIHRva2VucyB0byByZWd1bGFyIHRva2VucwogICAgdWludDI1NiByZW1haW5pbmdQcmVzYWxlVG9rZW5zID0gUFJFU0FMRVRPS0VOTUFYU0FMRVMuc3ViKHRvdGFsUHJlc2FsZVRva2Vuc1NvbGQpOwogICAgcmVndWxhclRva2VuTWF4U2FsZXMgPSByZWd1bGFyVG9rZW5NYXhTYWxlcy5hZGQocmVtYWluaW5nUHJlc2FsZVRva2Vucyk7CiAgfQoKICAvKioKICAgKiBNaW50cyB0aGUgdG9rZW5zIGluIHRoZSBUb2tlbiBjb250cmFjdC4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlclRva2VucygpIHB1YmxpYyBvbmx5T3duZXIgewogICAgZm9yICh1aW50MjU2IGkgPSAwOyBpIDwgaW52ZXN0b3JzLmxlbmd0aDsgaSA9IGkuYWRkKDEpKSB7CiAgICAgIGFkZHJlc3MgaW52ZXN0b3IgPSBpbnZlc3RvcnNbaV07CgogICAgICB1aW50MjU2IHRva2VucyA9IHJlZ3VsYXJUb2tlbnNTb2xkW2ludmVzdG9yXTsKICAgICAgdWludDI1NiBwcmVzYWxlVG9rZW5zID0gcHJlc2FsZVRva2Vuc1NvbGRbaW52ZXN0b3JdOwogICAgICAKICAgICAgcmVndWxhclRva2Vuc1NvbGRbaW52ZXN0b3JdID0gMDsKICAgICAgcHJlc2FsZVRva2Vuc1NvbGRbaW52ZXN0b3JdID0gMDsKCiAgICAgIGlmICh0b2tlbnMgPiAwKSB7CiAgICAgICAgX2RlbGl2ZXJUb2tlbnModG9rZW4sIGludmVzdG9yLCB0b2tlbnMpOwogICAgICB9CgogICAgICBpZiAocHJlc2FsZVRva2VucyA+IDApIHsKICAgICAgICBfZGVsaXZlclRva2Vucyh0b2tlbiwgaW52ZXN0b3IsIHByZXNhbGVUb2tlbnMpOwogICAgICB9CiAgICB9CiAgfQoKICAvKioKICAgKiBNaW50cyB0aGUgdG9rZW5zIGluIHRoZSBUb2tlbiBjb250cmFjdC4gV2l0aCBPZmZzZXQgYW5kIExpbWl0CiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJUb2tlbnNXaXRoT2Zmc2V0QW5kTGltaXQodWludDI1NiBvZmZzZXQsIHVpbnQyNTYgbGltaXQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgZm9yICh1aW50MjU2IGkgPSBvZmZzZXQ7IGkgPCAgX21pbjI1NihpbnZlc3RvcnMubGVuZ3RoLG9mZnNldCtsaW1pdCk7IGkgPSBpLmFkZCgxKSkgewogICAgICBhZGRyZXNzIGludmVzdG9yID0gaW52ZXN0b3JzW2ldOwoKICAgICAgdWludDI1NiB0b2tlbnMgPSByZWd1bGFyVG9rZW5zU29sZFtpbnZlc3Rvcl07CiAgICAgIHVpbnQyNTYgcHJlc2FsZVRva2VucyA9IHByZXNhbGVUb2tlbnNTb2xkW2ludmVzdG9yXTsKCiAgICAgIHJlZ3VsYXJUb2tlbnNTb2xkW2ludmVzdG9yXSA9IDA7CiAgICAgIHByZXNhbGVUb2tlbnNTb2xkW2ludmVzdG9yXSA9IDA7CgogICAgICBpZiAodG9rZW5zID4gMCkgewogICAgICAgIF9kZWxpdmVyVG9rZW5zKHRva2VuLCBpbnZlc3RvciwgdG9rZW5zKTsKICAgICAgfQoKICAgICAgaWYgKHByZXNhbGVUb2tlbnMgPiAwKSB7CiAgICAgICAgX2RlbGl2ZXJUb2tlbnModG9rZW4sIGludmVzdG9yLCBwcmVzYWxlVG9rZW5zKTsKICAgICAgfQogICAgfQogIH0KCgogIC8qKgogICAqIENsZWFycyB0aGUgbnVtYmVyIG9mIHRva2VucyBib3VnaHQgYnkgYW4gaW52ZXN0b3IuIFRoZSBFVEggcmVmdW5kIG5lZWRzIHRvIGJlIHByb2Nlc3NlZAogICAqIG1hbnVhbGx5LgogICAqLwogIGZ1bmN0aW9uIHJlZnVuZChhZGRyZXNzIGludmVzdG9yKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUoaW52ZXN0b3IgIT0gb3duZXIpOwoKICAgIHVpbnQyNTYgcmVndWxhclRva2VucyA9IHJlZ3VsYXJUb2tlbnNTb2xkW2ludmVzdG9yXTsKICAgIHRvdGFsUmVndWxhclRva2Vuc1NvbGQgPSB0b3RhbFJlZ3VsYXJUb2tlbnNTb2xkLnN1YihyZWd1bGFyVG9rZW5zKTsKICAgIHdlaVJhaXNlZCA9IHdlaVJhaXNlZC5zdWIocmVndWxhclRva2Vucy5kaXYocmF0ZSkpOwoKICAgIHVpbnQyNTYgcHJlc2FsZVRva2VucyA9IHByZXNhbGVUb2tlbnNTb2xkW2ludmVzdG9yXTsKICAgIHRvdGFsUHJlc2FsZVRva2Vuc1NvbGQgPSB0b3RhbFByZXNhbGVUb2tlbnNTb2xkLnN1YihwcmVzYWxlVG9rZW5zKTsKICAgIHdlaVJhaXNlZCA9IHdlaVJhaXNlZC5zdWIocHJlc2FsZVRva2Vucy5kaXYocHJlc2FsZVJhdGUpKTsKCiAgICByZWd1bGFyVG9rZW5zU29sZFtpbnZlc3Rvcl0gPSAwOwogICAgcHJlc2FsZVRva2Vuc1NvbGRbaW52ZXN0b3JdID0gMDsKCiAgICAvLyBNYW51YWxseSBzZW5kIGV0aGVyIHRvIHRoZSBhY2NvdW50CiAgfQoKICAvKioKICAqIEFjY2Vzc29yIGZvciBJbmRleAogICovCiAgZnVuY3Rpb24gZ2V0SW52ZXN0b3JBdEluZGV4KHVpbnQyNTYgX2luZGV4KSBwdWJsaWMgdmlldyByZXR1cm5zKGFkZHJlc3MpIHsKICAgIHJldHVybiBpbnZlc3RvcnNbX2luZGV4XTsKICB9CgogIC8qKgogICogUmV0dXJuIHRoZSBsZW5ndGggb2YgdGhlIGludmVzdG9ycyBhcnJheQogICovCiAgZnVuY3Rpb24gZ2V0SW52ZXN0b3JzTGVuZ3RoKCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50MjU2KSB7CiAgICByZXR1cm4gaW52ZXN0b3JzLmxlbmd0aDsKICB9CgogIC8qKgogICAqIEdldCB0aGUgbnVtYmVyIG9mIHRva2VucyBib3VnaHQgYXQgdGhlIHJlZ3VsYXIgcHJpY2UgZm9yIGFuIGFkZHJlc3MuCiAgICovCiAgZnVuY3Rpb24gZ2V0TnVtUmVndWxhclRva2Vuc0JvdWdodChhZGRyZXNzIF9hZGRyZXNzKSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnQyNTYpIHsKICAgIHJldHVybiByZWd1bGFyVG9rZW5zU29sZFtfYWRkcmVzc107CiAgfQoKICAvKioKICAgKiBHZXQgdGhlIG51bWJlciBvZiB0b2tlbnMgYm91Z2h0IGF0IHRoZSBwcmVzYWxlIHByaWNlIGZvciBhbiBhZGRyZXNzLgogICAqLwogIGZ1bmN0aW9uIGdldE51bVByZXNhbGVUb2tlbnNCb3VnaHQoYWRkcmVzcyBfYWRkcmVzcykgcHVibGljIHZpZXcgcmV0dXJucyh1aW50MjU2KSB7CiAgICByZXR1cm4gcHJlc2FsZVRva2Vuc1NvbGRbX2FkZHJlc3NdOwogIH0KCiAgLyoqCiAgICogR2V0IHRoZSBudW1iZXIgb2YgdG9rZW5zIHdoaWNoIGFuIGludmVzdG9yIGNhbiBwdXJjaGFzZSBhdCBwcmVzYWxlIHJhdGUuCiAgICovCiAgZnVuY3Rpb24gZ2V0UHJlc2FsZUFsbG9jYXRpb24oYWRkcmVzcyBpbnZlc3RvcikgdmlldyBwdWJsaWMgcmV0dXJucyh1aW50MjU2KSB7CiAgICByZXR1cm4gcHJlc2FsZUFsbG9jYXRpb25zW2ludmVzdG9yXTsKICB9CgogIC8qKgogICAqIFNldCB0aGUgbnVtYmVyIG9mIHRva2VucyB3aGljaCBhbiBpbnZlc3RvciBjYW4gcHVyY2hhc2UgYXQgcHJlc2FsZSByYXRlLgogICAqLwogIGZ1bmN0aW9uIHNldFByZXNhbGVBbGxvY2F0aW9uKGFkZHJlc3MgaW52ZXN0b3IsIHVpbnQgYWxsb2NhdGlvbikgb25seU93bmVyIHB1YmxpYyB7CiAgICBwcmVzYWxlQWxsb2NhdGlvbnNbaW52ZXN0b3JdID0gYWxsb2NhdGlvbjsKICB9CgogIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgLy8gSW50ZXJuYWwgaW50ZXJmYWNlIChleHRlbnNpYmxlKQogIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogIC8qKgogICAqIEBkZXYgVmFsaWRhdGlvbiBvZiBhbiBpbmNvbWluZyBwdXJjaGFzZS4gVXNlIHJlcXVpcmUgc3RhdGVtZW50cyB0byByZXZlcnQgc3RhdGUgd2hlbiBjb25kaXRpb25zIGFyZSBub3QgbWV0LiBVc2Ugc3VwZXIgdG8gY29uY2F0ZW5hdGUgdmFsaWRhdGlvbnMuCiAgICogQHBhcmFtIF9iZW5lZmljaWFyeSBBZGRyZXNzIHBlcmZvcm1pbmcgdGhlIHRva2VuIHB1cmNoYXNlCiAgICovCiAgZnVuY3Rpb24gX3ByZVZhbGlkYXRlUHVyY2hhc2UoYWRkcmVzcyBfYmVuZWZpY2lhcnkpIGludGVybmFsIHB1cmUgewogICAgcmVxdWlyZShfYmVuZWZpY2lhcnkgIT0gYWRkcmVzcygwKSk7CiAgfQoKICAvKioKICAgKiBAZGV2IFNvdXJjZSBvZiB0b2tlbnMuIE92ZXJyaWRlIHRoaXMgbWV0aG9kIHRvIG1vZGlmeSB0aGUgd2F5IGluIHdoaWNoIHRoZSBjcm93ZHNhbGUgdWx0aW1hdGVseSBnZXRzIGFuZCBzZW5kcyBpdHMgdG9rZW5zLgogICAqIEBwYXJhbSBfYmVuZWZpY2lhcnkgQWRkcmVzcyBwZXJmb3JtaW5nIHRoZSB0b2tlbiBwdXJjaGFzZQogICAqIEBwYXJhbSBfdG9rZW5BbW91bnQgTnVtYmVyIG9mIHRva2VucyB0byBiZSBlbWl0dGVkCiAgICovCiAgZnVuY3Rpb24gX2RlbGl2ZXJUb2tlbnMoU3RhbmRhcmRUb2tlbiBfdG9rZW4sIGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCB1aW50MjU2IF90b2tlbkFtb3VudCkgaW50ZXJuYWwgewogICAgX3Rva2VuLm1pbnQoX2JlbmVmaWNpYXJ5LCBfdG9rZW5BbW91bnQpOwogIH0KCiAgLyoqCiAgICogQGRldiBEZXRlcm1pbmVzIGhvdyBFVEggaXMgc3RvcmVkL2ZvcndhcmRlZCBvbiBwdXJjaGFzZXMuCiAgICovCiAgZnVuY3Rpb24gX2ZvcndhcmRGdW5kcyh1aW50MjU2IGFtb3VudCkgaW50ZXJuYWwgewogICAgb3duZXIudHJhbnNmZXIoYW1vdW50KTsKICB9CgogIGZ1bmN0aW9uIF9taW4yNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7CiAgfQoKICAvKioKICAgKiBSZWNvcmRzIGEgcHJlc2FsZSBwdXJjaGFzZS4KICAgKiBAcGFyYW0gX2JlbmVmaWNpYXJ5IHRoZSBpbnZlc3RvcgogICAqIEBwYXJhbSBfcHJlc2FsZVRva2VucyB0aGUgbnVtYmVyIG9mIHRva2VucyB3aGljaCB0aGUgaW52ZXN0b3IgaGFzIGJvdWdodAogICAqLwogIGZ1bmN0aW9uIF9yZWNvcmRQcmVzYWxlUHVyY2hhc2UoYWRkcmVzcyBfYmVuZWZpY2lhcnksIHVpbnQyNTYgX3ByZXNhbGVUb2tlbnMpIGludGVybmFsIHsKICAgIC8vIENoZWNrIHdlIGhhdmVuJ3Qgc29sZCB0b28gbWFueSBwcmVzYWxlIHRva2VucwogICAgdG90YWxQcmVzYWxlVG9rZW5zU29sZCA9IHRvdGFsUHJlc2FsZVRva2Vuc1NvbGQuYWRkKF9wcmVzYWxlVG9rZW5zKTsKICAgIHJlcXVpcmUodG90YWxQcmVzYWxlVG9rZW5zU29sZCA8PSBQUkVTQUxFVE9LRU5NQVhTQUxFUyk7CgogICAgaW52ZXN0b3JzLnB1c2goX2JlbmVmaWNpYXJ5KTsKCiAgICAvLyBHaXZlIHByZXNhbGUgdG9rZW5zCiAgICBwcmVzYWxlVG9rZW5zU29sZFtfYmVuZWZpY2lhcnldID0gcHJlc2FsZVRva2Vuc1NvbGRbX2JlbmVmaWNpYXJ5XS5hZGQoX3ByZXNhbGVUb2tlbnMpOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICB1aW50MjU2IHRvdGFsU3VwcGx5XyA9IDQ1NDY3MDAwMDAwMDAwMDAwMDAwMDAwMDAwOwoKICAvKioKICAqIEBkZXYgdG90YWwgbnVtYmVyIG9mIHRva2VucyBpbiBleGlzdGVuY2UKICAqLwogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIHRvdGFsU3VwcGx5XzsKICB9CgogIC8qKgogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGVtaXQgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgKi8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbgogKgogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogIC8vIE5hbWUgb2YgdGhlIHRva2VuCiAgc3RyaW5nIGNvbnN0YW50IHB1YmxpYyBuYW1lID0gIlF1YW50IjsKICAvLyBUb2tlbiBhYmJyZXZpYXRpb24KICBzdHJpbmcgY29uc3RhbnQgcHVibGljIHN5bWJvbCA9ICJRTlQiOwogIC8vIERlY2ltYWwgcGxhY2VzCiAgdWludDggY29uc3RhbnQgcHVibGljIGRlY2ltYWxzID0gMTg7CiAgLy8gWmVyb3MgYWZ0ZXIgdGhlIHBvaW50CiAgdWludDI1NiBjb25zdGFudCBwdWJsaWMgREVDSU1BTF9aRVJPUyA9IDEwMDAwMDAwMDAwMDAwMDAwMDA7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgaW50ZXJuYWwgYWxsb3dlZDsKCiAgYWRkcmVzcyBwdWJsaWMgY3Jvd2RzYWxlOwoKICBtb2RpZmllciBvbmx5Q3Jvd2RzYWxlKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNyb3dkc2FsZSk7CiAgICBfOwogIH0KCiAgZnVuY3Rpb24gU3RhbmRhcmRUb2tlbihhZGRyZXNzIF9jcm93ZHNhbGUpIHB1YmxpYyB7CiAgICByZXF1aXJlKF9jcm93ZHNhbGUgIT0gYWRkcmVzcygwKSk7CiAgICBjcm93ZHNhbGUgPSBfY3Jvd2RzYWxlOwogIH0KCiAgZnVuY3Rpb24gbWludChhZGRyZXNzIF9hZGRyZXNzLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIG9ubHlDcm93ZHNhbGUgewogICAgYmFsYW5jZXNbX2FkZHJlc3NdID0gYmFsYW5jZXNbX2FkZHJlc3NdLmFkZChfdmFsdWUpOwogICAgZW1pdCBUcmFuc2ZlcigwLCBfYWRkcmVzcywgX3ZhbHVlKTsKICB9CgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1tfZnJvbV0pOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0pOwoKICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIGVtaXQgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICoKICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICogYW5kIHRoZSBuZXcgYWxsb3dhbmNlIGJ5IHVuZm9ydHVuYXRlIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcwogICAqIHJhY2UgY29uZGl0aW9uIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUgYWZ0ZXJ3YXJkczoKICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIGVtaXQgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBAZGV2IEluY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX2FkZGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gaW5jcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBlbWl0IEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRGVjcmVhc2UgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKgogICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGRlY3JlbWVudAogICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3VidHJhY3RlZFZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGRlY3JlYXNlIHRoZSBhbGxvd2FuY2UgYnkuCiAgICovCiAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQogICAgZW1pdCBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKfQ=='.
	

]
