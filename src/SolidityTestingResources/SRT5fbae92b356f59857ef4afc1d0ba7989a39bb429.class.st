Class {
	#name : #SRT5fbae92b356f59857ef4afc1d0ba7989a39bb429,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT5fbae92b356f59857ef4afc1d0ba7989a39bb429 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKioKICogTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcwogKi8KCmxpYnJhcnkgU2FmZU1hdGggewoKCiAgICBmdW5jdGlvbiBtdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCkgewogICAgICAgIHVpbnQgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gc3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQpIHsKICAgICAgICBhc3NlcnQoYiA8PSBhKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQpIHsKICAgICAgICB1aW50IGMgPSBhICsgYjsKICAgICAgICBhc3NlcnQoYz49YSAmJiBjPj1iKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KfQoKCi8qIAogKiBUb2tlbiByZWxhdGVkIGNvbnRyYWN0cyAKICovCgoKLyoKICogRVJDMjBCYXNpYwogKiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCgpjb250cmFjdCBFUkMyMEJhc2ljIHsKICAgIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5OwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQgdmFsdWUpOwp9CgoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwoKY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKCi8qKgogKiBAdGl0bGUgQmFzaWMgdG9rZW4KICogQGRldiBCYXNpYyB2ZXJzaW9uIG9mIFN0YW5kYXJkVG9rZW4sIHdpdGggbm8gYWxsb3dhbmNlcy4KICovCgpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAgIC8qKgogICAgICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKCiAgICAgICAgLy8gU2FmZU1hdGguc3ViIHdpbGwgdGhyb3cgaWYgdGhlcmUgaXMgbm90IGVub3VnaCBiYWxhbmNlLgogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAgICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICAgICogQHJldHVybiBBbiB1aW50IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAgICAqLwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9Cgp9CgoKLyoqCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbgogKgogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgaW50ZXJuYWwgYWxsb3dlZDsKCgogICAgLyoqCiAgICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSk7CgogICAgICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgICAqCiAgICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAgICovCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KCn0KCgovKgogKiBPd25hYmxlCiAqCiAqIEJhc2UgY29udHJhY3Qgd2l0aCBhbiBvd25lci4KICogUHJvdmlkZXMgb25seU93bmVyIG1vZGlmaWVyLCB3aGljaCBwcmV2ZW50cyBmdW5jdGlvbiBmcm9tIHJ1bm5pbmcgaWYgaXQgaXMgY2FsbGVkIGJ5IGFueW9uZSBvdGhlciB0aGFuIHRoZSBvd25lci4KICovCgpjb250cmFjdCBPd25hYmxlIHsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwogICAgYWRkcmVzcyBwdWJsaWMgbmV3T3duZXI7CgogICAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsgCiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlOZXdPd25lcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gbmV3T3duZXIpOwogICAgICAgIF87CiAgICB9CiAgICAvKgogICAgLy8gVGhpcyBjb2RlIGlzIGRhbmdlcm91cyBiZWNhdXNlIGFuIGVycm9yIGluIHRoZSBuZXdPd25lciAKICAgIC8vIG1lYW5zIHRoYXQgdGhpcyBjb250cmFjdCB3aWxsIGJlIG93bmVybGVzcyAKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7IAogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICB9CiAgICovCgogICAgZnVuY3Rpb24gcHJvcG9zZU5ld093bmVyKGFkZHJlc3MgX25ld093bmVyKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoX25ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIG5ld093bmVyID0gX25ld093bmVyOwogICAgfQoKICAgIGZ1bmN0aW9uIGFjY2VwdE93bmVyc2hpcCgpIGV4dGVybmFsIG9ubHlOZXdPd25lciB7CiAgICAgICAgcmVxdWlyZShuZXdPd25lciAhPSBvd25lcik7CiAgICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgIH0KfQoKCi8qKgogKiBAdGl0bGUgTWludGFibGUgdG9rZW4KICogQGRldiBTaW1wbGUgRVJDMjAgVG9rZW4gZXhhbXBsZSwgd2l0aCBtaW50YWJsZSB0b2tlbiBjcmVhdGlvbgogKiBAZGV2IElzc3VlOiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvaXNzdWVzLzEyMAogKiBCYXNlZCBvbiBjb2RlIGJ5IFRva2VuTWFya2V0TmV0OiBodHRwczovL2dpdGh1Yi5jb20vVG9rZW5NYXJrZXROZXQvaWNvL2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy9NaW50YWJsZVRva2VuLnNvbAogKi8KCmNvbnRyYWN0IE1pbnRhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZSB7CiAgICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwogICAgZXZlbnQgTWludEZpbmlzaGVkKCk7CgogICAgYm9vbCBwdWJsaWMgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CgoKICAgIG1vZGlmaWVyIGNhbk1pbnQoKSB7CiAgICAgICAgcmVxdWlyZSghbWludGluZ0ZpbmlzaGVkKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBtaW50IHRva2VucwogICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgbWludGVkIHRva2Vucy4KICAgICAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIG1pbnQuCiAgICAgKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAgICovCiAgICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyBvbmx5T3duZXIgY2FuTWludCByZXR1cm5zIChib29sKSB7CiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoX2Ftb3VudCk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF9hbW91bnQpOwogICAgICAgIE1pbnQoX3RvLCBfYW1vdW50KTsKICAgICAgICBUcmFuc2ZlcihhZGRyZXNzKDApLCBfdG8sIF9hbW91bnQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBzdG9wIG1pbnRpbmcgbmV3IHRva2Vucy4KICAgICAqIEByZXR1cm4gVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAgICovCiAgICBmdW5jdGlvbiBmaW5pc2hNaW50aW5nKCkgcHVibGljIG9ubHlPd25lciBjYW5NaW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICBtaW50aW5nRmluaXNoZWQgPSB0cnVlOwogICAgICAgIE1pbnRGaW5pc2hlZCgpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9CgoKLyoqCiAqIEB0aXRsZSBCdXJuYWJsZSBUb2tlbgogKiBAZGV2IFRva2VuIHRoYXQgY2FuIGJlIGlycmV2ZXJzaWJseSBidXJuZWQgKGRlc3Ryb3llZCkuCiAqLwpjb250cmFjdCBCdXJuYWJsZVRva2VuIGlzIEJhc2ljVG9rZW4gewoKICAgIGV2ZW50IEJ1cm4oYWRkcmVzcyBpbmRleGVkIGJ1cm5lciwgdWludDI1NiB2YWx1ZSk7CgogICAgLyoqCiAgICAgKiBAZGV2IEJ1cm5zIGEgc3BlY2lmaWMgYW1vdW50IG9mIHRva2Vucy4KICAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbiB0byBiZSBidXJuZWQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJ1cm4odWludDI1NiBfdmFsdWUpIHB1YmxpYyAgewogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKICAgICAgICAvLyBubyBuZWVkIHRvIHJlcXVpcmUgdmFsdWUgPD0gdG90YWxTdXBwbHksIHNpbmNlIHRoYXQgd291bGQgaW1wbHkgdGhlCiAgICAgICAgLy8gc2VuZGVyJ3MgYmFsYW5jZSBpcyBncmVhdGVyIHRoYW4gdGhlIHRvdGFsU3VwcGx5LCB3aGljaCAqc2hvdWxkKiBiZSBhbiBhc3NlcnRpb24gZmFpbHVyZQoKICAgICAgICBhZGRyZXNzIGJ1cm5lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgYmFsYW5jZXNbYnVybmVyXSA9IGJhbGFuY2VzW2J1cm5lcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5zdWIoX3ZhbHVlKTsKICAgICAgICBCdXJuKGJ1cm5lciwgX3ZhbHVlKTsKICAgIH0KfQoKCi8qKgogKiBAdGl0bGUgUGF1c2FibGUKICogQGRldiBCYXNlIGNvbnRyYWN0IHdoaWNoIGFsbG93cyBjaGlsZHJlbiB0byBpbXBsZW1lbnQgYW4gZW1lcmdlbmN5IHN0b3AgbWVjaGFuaXNtLgogKi8KCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgewoKCiAgICBldmVudCBQYXVzZSgpOwogICAgZXZlbnQgVW5wYXVzZSgpOwoKICAgIGJvb2wgcHVibGljIHBhdXNlZCA9IHRydWU7CgoKICAgIC8qKgogICAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBub3QgcGF1c2VkLgogICAgICovCiAgICBtb2RpZmllciB3aGVuTm90UGF1c2VkKCkgewogICAgICAgIHJlcXVpcmUoIXBhdXNlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgcGF1c2VkLgogICAgICovCiAgICBtb2RpZmllciB3aGVuUGF1c2VkKCkgewogICAgICAgIHJlcXVpcmUocGF1c2VkKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHBhdXNlLCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlCiAgICAgKi8KICAgIGZ1bmN0aW9uIHBhdXNlKCkgb25seU93bmVyIHdoZW5Ob3RQYXVzZWQgcHVibGljIHsKICAgICAgICBwYXVzZWQgPSB0cnVlOwogICAgICAgIFBhdXNlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gdW5wYXVzZSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgICAqLwogICAgZnVuY3Rpb24gdW5wYXVzZSgpIG9ubHlPd25lciB3aGVuUGF1c2VkIHB1YmxpYyB7CiAgICAgICAgcGF1c2VkID0gZmFsc2U7CiAgICAgICAgVW5wYXVzZSgpOwogICAgfQp9CgoKCi8qIEB0aXRsZSBQYXVzYWJsZSB0b2tlbgogKgogKiBAZGV2IFN0YW5kYXJkVG9rZW4gbW9kaWZpZWQgd2l0aCBwYXVzYWJsZSB0cmFuc2ZlcnMuCiAqKi8KCmNvbnRyYWN0IFBhdXNhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgUGF1c2FibGUgewoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLmFwcHJvdmUoX3NwZW5kZXIsIF92YWx1ZSk7CiAgICB9Cgp9CgoKLyoKICogQWN0dWFsIHRva2VuIGNvbnRyYWN0CiAqLwoKY29udHJhY3QgQWNqVG9rZW4gaXMgQnVybmFibGVUb2tlbiwgTWludGFibGVUb2tlbiwgUGF1c2FibGVUb2tlbiB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiQXJ0aXN0IENvbm5lY3QgQ29pbiI7CiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJBQ0oiOwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKICAgIAogICAgZnVuY3Rpb24gQWNqVG9rZW4oKSBwdWJsaWMgewogICAgICAgIHRvdGFsU3VwcGx5ID0gMTUwMDAwMDAwIGV0aGVyOyAKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHRvdGFsU3VwcGx5OwogICAgICAgIHBhdXNlZCA9IHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gYWN0aXZhdGUoKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIHVucGF1c2UoKTsKICAgICAgICBmaW5pc2hNaW50aW5nKCk7CiAgICB9CgogICAgLy8gVGhpcyBtZXRob2Qgd2lsbCBiZSB1c2VkIGJ5IHRoZSBjcm93ZHNhbGUgc21hcnQgY29udHJhY3QgCiAgICAvLyB0aGF0IG93bnMgdGhlIEFjalRva2VuIGFuZCB3aWxsIGRpc3RyaWJ1dGUgCiAgICAvLyB0aGUgdG9rZW5zIHRvIHRoZSBjb250cmlidXRvcnMKICAgIGZ1bmN0aW9uIGluaXRpYWxUcmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIGV4dGVybmFsIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgc3VwZXIuYnVybihfYW1vdW50KTsKICAgIH0KCn0KCgpjb250cmFjdCBBY2pDcm93ZHNhbGUgaXMgT3duYWJsZSB7CgoKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIC8qIEJvbnVzZXMgKi8KCiAgICAvLyBQcmVzYWxlIGJvbnVzIHBlcmNlbnRhZ2UKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IEJPTlVTX1BSRVNBTEUgPSAxMDsgICAgICAgICAgICAKICAgIC8vIE1lZGl1bSBib251cyBwZXJjZW50YWdlCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBCT05VU19NSUQgPSAxMDsgICAgICAgICAgICAgICAgCiAgICAvLyBIaWdoIGJvbnVzIHBlcmNlbnRhZ2UKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IEJPTlVTX0hJID0gMjA7ICAgICAgICAgICAgICAgICAKICAgIC8vIE1lZGl1bSBib251cyB0aHJlc2hvbGQKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IEJPTlVTX01JRF9RVFkgPSAxNTAgZXRoZXI7ICAgICAKICAgIC8vIEhpZ2ggYm9udXMgdGhyZXNob2xkCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBCT05VU19ISV9RVFkgPSAzMzUgZXRoZXI7ICAgICAgCgogICAgLyogQWJzb2x1dGUgZGF0ZXMgYXMgdGltZXN0YW1wcyAqLwoKICAgIHVpbnQgcHVibGljIHN0YXJ0UHJlc2FsZTsgICAgICAgICAgICAKICAgIHVpbnQgcHVibGljIGVuZFByZXNhbGU7ICAgICAgICAgICAgIAogICAgdWludCBwdWJsaWMgc3RhcnRJY287ICAgICAgICAgICAgICAKICAgIHVpbnQgcHVibGljIGVuZEljbzsgICAgICAgICAgICAgICAKCiAgICAvLyAzMCBkYXlzIHJlZnVuZCBwZXJpb2Qgb24gZmFpbAogICAgdWludCBwdWJsaWMgY29uc3RhbnQgUkVGVU5EX1BFUklPRCA9IDMwIGRheXM7CgogICAgLyogVG9rZW5zICoqLwoKICAgIC8vIEluZGljYXRpdmUgdG9rZW4gYmFsYW5jZXMgZHVyaW5nIHRoZSBjcm93ZHNhbGUgCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIHRva2VuQmFsYW5jZXM7ICAgIAogICAgLy8gVG9rZW4gc21hcnQgY29udHJhY3QgYWRkcmVzcwogICAgYWRkcmVzcyBwdWJsaWMgdG9rZW47CiAgICAvLyBUb3RhbCB0b2tlbnMgY3JlYXRlZAogICAgdWludDI1NiBwdWJsaWMgdG9rZW5zVG90YWxTdXBwbHk7IAogICAgLy8gVG9rZW5zIGF2YWlsYWJsZSBmb3Igc2FsZQogICAgdWludDI1NiBwdWJsaWMgdG9rZW5zRm9yU2FsZTsgICAgCiAgICAvLyBUb2tlbnMgc29sZCB2aWEgYnV5VG9rZW5zCiAgICB1aW50MjU2IHB1YmxpYyB0b2tlbnNTb2xkOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAvLyBUb2tlbnMgY3JlYXRlZCBkdXJpbmcgdGhlIHNhbGUKICAgIHVpbnQyNTYgcHVibGljIHRva2Vuc0Rpc3RyaWJ1dGVkOyAgICAgICAgICAgICAgICAgICAgICAKICAgIC8vIHNvZnQgY2FwIGluIEVUSAogICAgdWludDI1NiBwdWJsaWMgdG9rZW5zU29mdENhcDsgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgLy8gSUNPIGZsYXQgcmF0ZSBzdWJqZWN0IHRvIGJvbnVzZXMKICAgIHVpbnQyNTYgcHVibGljIGV0aFRva2VuUmF0ZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoKICAgIC8qIE1hbmFnZW1lbnQgKi8KCiAgICAvLyBBbGxvdyBtdWx0aXBsZSBhZG1pbmlzdHJhdG9ycwogICAgbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBhZG1pbnM7ICAgICAgICAgICAgICAgIAoKICAgIC8qIFZhcmlvdXMgKi8KCiAgICAvLyBUb3RhbCB3ZWkgcmVjZWl2ZWQgCiAgICB1aW50MjU2IHB1YmxpYyB3ZWlSZWNlaXZlZDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAvLyBNaW5pbXVtIGNvbnRyaWJ1dGlvbiBpbiBFVEgKICAgIHVpbnQyNTYgcHVibGljIHdlaU1pbkNvbnRyaWJ1dGlvbiA9IDEgZXRoZXI7ICAgICAgICAgICAKICAgIC8vIENvbnRyaWJ1dGlvbnMgaW4gd2VpIGZvciBlYWNoIGFkZHJlc3MKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgY29udHJpYnV0aW9uczsKICAgIC8vIFJlZnVuZCBzdGF0ZSBmb3IgZWFjaCBhZGRyZXNzCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIHJlZnVuZHM7CgogICAgLyogV2FsbGV0cyAqLwoKICAgIC8vIENvbXBhbnkgd2FsbGV0IHRoYXQgd2lsbCByZWNlaXZlIHRoZSBFVEgKICAgIGFkZHJlc3MgcHVibGljIGNvbXBhbnlXYWxsZXQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgCgogICAgLyogRXZlbnRzICovCgogICAgLy8gWW9vaG9vIHNvbWVvbmUgY29udHJpYnV0ZWQgIQogICAgZXZlbnQgQ29udHJpYnV0ZShhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIHVpbnQgX2Ftb3VudCk7IAogICAgLy8gVG9rZW4gPD4gRVRIIHJhdGUgdXBkYXRlZAogICAgZXZlbnQgVG9rZW5SYXRlVXBkYXRlZCh1aW50IF9uZXdSYXRlKTsgICAgICAgICAgICAgICAgICAKICAgIC8vIEVUSCBSZWZ1bmQgCiAgICBldmVudCBSZWZ1bmRlZChhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIHVpbnQgX2Ftb3VudCk7ICAgIAoKICAgIC8qIE1vZGlmaWVycyAqLyAKCiAgICBtb2RpZmllciBiZWxvd1RvdGFsU3VwcGx5IHsKICAgICAgICByZXF1aXJlKHRva2Vuc0Rpc3RyaWJ1dGVkIDwgdG9rZW5zVG90YWxTdXBwbHkpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgYmVsb3dIYXJkQ2FwIHsKICAgICAgICByZXF1aXJlKHRva2Vuc0Rpc3RyaWJ1dGVkIDwgdG9rZW5zRm9yU2FsZSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBhZG1pbk9ubHkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lciB8fCBhZG1pbnNbbXNnLnNlbmRlcl0gPT0gdHJ1ZSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBjcm93ZHNhbGVGYWlsZWQgewogICAgICAgIHJlcXVpcmUoaXNGYWlsZWQoKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBjcm93ZHNhbGVTdWNjZXNzIHsKICAgICAgICByZXF1aXJlKGlzU3VjY2VzcygpKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIGR1cmluZ1NhbGUgewogICAgICAgIHJlcXVpcmUobm93IDwgZW5kSWNvKTsKICAgICAgICByZXF1aXJlKChub3cgPiBzdGFydFByZXNhbGUgJiYgbm93IDwgZW5kUHJlc2FsZSkgfHwgbm93ID4gc3RhcnRJY28pOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgYWZ0ZXJTYWxlIHsKICAgICAgICByZXF1aXJlKG5vdyA+IGVuZEljbyk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBhYm92ZU1pbmltdW0gewogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID49IHdlaU1pbkNvbnRyaWJ1dGlvbik7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKiBQdWJsaWMgbWV0aG9kcyAqLwoKICAgIC8qIAogICAgICogQ29uc3RydWN0b3IKICAgICAqIENyZWF0aW5nIHRoZSBuZXcgVG9rZW4gc21hcnQgY29udHJhY3QKICAgICAqIGFuZCBzZXR0aW5nIGl0cyBvd25lciB0byB0aGUgY3VycmVudCBzZW5kZXIKICAgICAqIAogICAgICovCiAgICBmdW5jdGlvbiBBY2pDcm93ZHNhbGUoCiAgICAgICAgICAgIHVpbnQgX3ByZXNhbGVTdGFydCwgCiAgICAgICAgICAgIHVpbnQgX3ByZXNhbGVFbmQsIAogICAgICAgICAgICB1aW50IF9pY29TdGFydCwgCiAgICAgICAgICAgIHVpbnQgX2ljb0VuZCwgCiAgICAgICAgICAgIHVpbnQyNTYgX3JhdGUsIAogICAgICAgICAgICB1aW50MjU2IF9jYXAsIAogICAgICAgICAgICB1aW50MjU2IF9nb2FsLCAKICAgICAgICAgICAgdWludDI1NiBfdG90YWxTdXBwbHksCiAgICAgICAgICAgIGFkZHJlc3MgX3Rva2VuCiAgICAgICAgICAgICkgcHVibGljIHsKCiAgICAgICAgcmVxdWlyZShfcHJlc2FsZUVuZCA+IF9wcmVzYWxlU3RhcnQpOwogICAgICAgIHJlcXVpcmUoX2ljb1N0YXJ0ID4gX3ByZXNhbGVFbmQpOwogICAgICAgIHJlcXVpcmUoX2ljb0VuZCA+IF9pY29TdGFydCk7CgogICAgICAgIHJlcXVpcmUoX3JhdGUgPiAwKTsgCiAgICAgICAgcmVxdWlyZShfY2FwID4gMCk7CiAgICAgICAgcmVxdWlyZShfZ29hbCA+IDApOwogICAgICAgIHJlcXVpcmUoX3RvdGFsU3VwcGx5ID4gX2dvYWwpOwoKICAgICAgICBzdGFydFByZXNhbGUgPSBfcHJlc2FsZVN0YXJ0OwogICAgICAgIGVuZFByZXNhbGUgPSBfcHJlc2FsZUVuZDsKICAgICAgICBzdGFydEljbyA9IF9pY29TdGFydDsKICAgICAgICBlbmRJY28gPSBfaWNvRW5kOwoKICAgICAgICBldGhUb2tlblJhdGUgPSBfcmF0ZTsgICAgICAgIAogICAgICAgIHRva2Vuc1NvZnRDYXAgPSBfY2FwLm11bCgxIGV0aGVyKTsKICAgICAgICB0b2tlbnNGb3JTYWxlID0gX2dvYWwubXVsKDEgZXRoZXIpOwogICAgICAgIHRva2Vuc1RvdGFsU3VwcGx5ID0gX3RvdGFsU3VwcGx5Lm11bCgxIGV0aGVyKTsKCiAgICAgICAgYWRtaW5zW21zZy5zZW5kZXJdID0gdHJ1ZTsKICAgICAgICBjb21wYW55V2FsbGV0ID0gbXNnLnNlbmRlcjsKCiAgICAgICAgdG9rZW4gPSBfdG9rZW47CiAgICB9CgoKICAgIC8qCiAgICAgKiBGYWxsYmFjayBwYXlhYmxlCiAgICAgKi8KICAgIGZ1bmN0aW9uICgpIGV4dGVybmFsIHBheWFibGUgewoKICAgICAgICBidXlUb2tlbnMobXNnLnNlbmRlcik7CiAgICB9CgoKICAgIC8qIENyb3dkc2FsZSBzdGFmZiBvbmx5ICovCgoKICAgIC8qCiAgICAgKiBBZG1pbiBtYW5hZ2VtZW50CiAgICAgKi8KICAgIGZ1bmN0aW9uIGFkZEFkbWluKGFkZHJlc3MgX2FkcikgZXh0ZXJuYWwgb25seU93bmVyIHsKCiAgICAgICAgcmVxdWlyZShfYWRyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIGFkbWluc1tfYWRyXSA9IHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gcmVtb3ZlQWRtaW4oYWRkcmVzcyBfYWRyKSBleHRlcm5hbCBvbmx5T3duZXIgewoKICAgICAgICByZXF1aXJlKF9hZHIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgYWRtaW5zW19hZHJdID0gZmFsc2U7CiAgICB9CgogICAgLyoKICAgICAqIENoYW5nZSB0aGUgY29tcGFueSB3YWxsZXQKICAgICAqLwogICAgZnVuY3Rpb24gdXBkYXRlQ29tcGFueVdhbGxldChhZGRyZXNzIF93YWxsZXQpIGV4dGVybmFsIGFkbWluT25seSB7CgogICAgICAgIGNvbXBhbnlXYWxsZXQgPSBfd2FsbGV0OwogICAgfQoKICAgIC8qCiAgICAgKiAgQ2hhbmdlIHRoZSBvd25lciBvZiB0aGUgdG9rZW4KICAgICAqLwogICAgZnVuY3Rpb24gcHJvcG9zZVRva2VuT3duZXIoYWRkcmVzcyBfbmV3T3duZXIpIGV4dGVybmFsIGFkbWluT25seSB7CgogICAgICAgIEFjalRva2VuIF90b2tlbiA9IEFjalRva2VuKHRva2VuKTsKICAgICAgICBfdG9rZW4ucHJvcG9zZU5ld093bmVyKF9uZXdPd25lcik7CiAgICB9CgogICAgZnVuY3Rpb24gYWNjZXB0VG9rZW5Pd25lcnNoaXAoKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIAogICAgICAgIEFjalRva2VuIF90b2tlbiA9IEFjalRva2VuKHRva2VuKTsKICAgICAgICBfdG9rZW4uYWNjZXB0T3duZXJzaGlwKCk7CgogICAgfQoKICAgIC8qCiAgICAgKiBBY3RpdmF0ZSB0aGUgdG9rZW4KICAgICAqLwogICAgZnVuY3Rpb24gYWN0aXZhdGVUb2tlbigpIGV4dGVybmFsIGFkbWluT25seSBjcm93ZHNhbGVTdWNjZXNzIGFmdGVyU2FsZSB7CiAgICAgICAgQWNqVG9rZW4gX3Rva2VuID0gQWNqVG9rZW4odG9rZW4pOwogICAgICAgIF90b2tlbi5hY3RpdmF0ZSgpOwogICAgfQoKICAgIC8qIAogICAgICogQWRqdXN0IHRoZSB0b2tlbiB2YWx1ZSBiZWZvcmUgdGhlIElDTwogICAgICovCiAgICBmdW5jdGlvbiBhZGp1c3RUb2tlbkV4Y2hhbmdlUmF0ZSh1aW50IF9yYXRlKSBleHRlcm5hbCBhZG1pbk9ubHkgewoKICAgICAgICByZXF1aXJlKG5vdyA+IGVuZFByZXNhbGUgJiYgbm93IDwgc3RhcnRJY28pOwogICAgICAgIGV0aFRva2VuUmF0ZSA9IF9yYXRlOwogICAgICAgIFRva2VuUmF0ZVVwZGF0ZWQoX3JhdGUpOwogICAgfQoKICAgIC8qIAogICAgICogU3RhcnQgdGhlcmVmdW5kIHBlcmlvZAogICAgICogRWFjaCBjb250cmlidXRvciBoYXMgdG8gY2xhaW0gb3duICBFVEggCiAgICAgKi8gICAgIAogICAgZnVuY3Rpb24gcmVmdW5kQ29udHJpYnV0aW9uKCkgZXh0ZXJuYWwgY3Jvd2RzYWxlRmFpbGVkIGFmdGVyU2FsZSB7CgogICAgICAgIHJlcXVpcmUoIXJlZnVuZHNbbXNnLnNlbmRlcl0pOwogICAgICAgIHJlcXVpcmUoY29udHJpYnV0aW9uc1ttc2cuc2VuZGVyXSA+IDApOwoKICAgICAgICB1aW50MjU2IF9hbW91bnQgPSBjb250cmlidXRpb25zW21zZy5zZW5kZXJdOwogICAgICAgIHRva2VuQmFsYW5jZXNbbXNnLnNlbmRlcl0gPSAwOwogICAgICAgIHJlZnVuZHNbbXNnLnNlbmRlcl0gPSB0cnVlOwogICAgICAgIFJlZnVuZGVkKG1zZy5zZW5kZXIsIGNvbnRyaWJ1dGlvbnNbbXNnLnNlbmRlcl0pOwogICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoX2Ftb3VudCk7CgogICAgfQoKICAgIC8qCiAgICAgKiBBZnRlciB0aGUgcmVmdW5kIHBlcmlvZCwgcmVtYWluaW5nIHRva2VucwogICAgICogYXJlIHRyYW5zZmVyZWQgdG8gdGhlIGNvbXBhbnkgd2FsbGV0CiAgICAgKiBBbGxvdyB3aXRoZHJhd2FsIGF0IGFueSB0aW1lIGlmIHRoZSBJQ08gaXMgYSBzdWNjZXNzLgogICAgICovICAgICAKICAgIGZ1bmN0aW9uIHdpdGhkcmF3VW5jbGFpbWVkKCkgZXh0ZXJuYWwgYWRtaW5Pbmx5IHsKCiAgICAgICAgcmVxdWlyZShub3cgPiBlbmRJY28gKyBSRUZVTkRfUEVSSU9EIHx8IGlzU3VjY2VzcygpKTsKICAgICAgICBjb21wYW55V2FsbGV0LnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgICB9CgogICAgLyoKICAgICAqIFByZS1JQ08gYW5kIG9mZmxpbmUgSW52ZXN0b3JzLCBjb2xsYWJvcmF0b3JzIGFuZCB0ZWFtIHRva2VucwogICAgICovCiAgICBmdW5jdGlvbiByZXNlcnZlVG9rZW5zKGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCB1aW50MjU2IF90b2tlbnNRdHkpIGV4dGVybmFsIGFkbWluT25seSBiZWxvd1RvdGFsU3VwcGx5IHsKCi8vICAgICAgICByZXF1aXJlKF9iZW5lZmljaWFyeSAhPSBhZGRyZXNzKDApKTsKICAgICAgICB1aW50IF9kaXN0cmlidXRlZCA9IHRva2Vuc0Rpc3RyaWJ1dGVkLmFkZChfdG9rZW5zUXR5KTsKCiAgICAgICAgcmVxdWlyZShfZGlzdHJpYnV0ZWQgPD0gdG9rZW5zVG90YWxTdXBwbHkpOwoKICAgICAgICB0b2tlbkJhbGFuY2VzW19iZW5lZmljaWFyeV0gPSBfdG9rZW5zUXR5LmFkZCh0b2tlbkJhbGFuY2VzW19iZW5lZmljaWFyeV0pOwogICAgICAgIHRva2Vuc0Rpc3RyaWJ1dGVkID0gX2Rpc3RyaWJ1dGVkOwoKICAgICAgICBBY2pUb2tlbiBfdG9rZW4gPSBBY2pUb2tlbih0b2tlbik7CiAgICAgICAgX3Rva2VuLmluaXRpYWxUcmFuc2ZlcihfYmVuZWZpY2lhcnksIF90b2tlbnNRdHkpOwogICAgfQoKCiAgICAvKgogICAgICogQWN0dWFsbHkgYnV5IHRoZSB0b2tlbnMKICAgICAqIHJlcXVpcmVzIGFuIGFjdGl2ZSBzYWxlIHRpbWUKICAgICAqIGFuZCBhbW91bnQgYWJvdmUgdGhlIG1pbmltdW0gY29udHJpYnV0aW9uCiAgICAgKiBhbmQgc29sZCB0b2tlbnMgaW5mZXJpb3IgdG8gdG9rZW5zIGZvciBzYWxlCiAgICAgKi8gICAgIAogICAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgX2JlbmVmaWNpYXJ5KSBwdWJsaWMgcGF5YWJsZSBkdXJpbmdTYWxlIGFib3ZlTWluaW11bSBiZWxvd0hhcmRDYXAgewoKICAgICAgICByZXF1aXJlKF9iZW5lZmljaWFyeSAhPSBhZGRyZXNzKDApKTsKICAgICAgICB1aW50MjU2IF93ZWlBbW91bnQgPSBtc2cudmFsdWU7ICAgICAgICAKICAgICAgICB1aW50MjU2IF90b2tlbnNRdHkgPSBtc2cudmFsdWUubXVsKGdldEJvbnVzKF93ZWlBbW91bnQpKTsKICAgICAgICB1aW50MjU2IF9kaXN0cmlidXRlZCA9IF90b2tlbnNRdHkuYWRkKHRva2Vuc0Rpc3RyaWJ1dGVkKTsKICAgICAgICB1aW50MjU2IF9zb2xkID0gX3Rva2Vuc1F0eS5hZGQodG9rZW5zU29sZCk7CgogICAgICAgIHJlcXVpcmUoX2Rpc3RyaWJ1dGVkIDw9IHRva2Vuc1RvdGFsU3VwcGx5KTsKICAgICAgICByZXF1aXJlKF9zb2xkIDw9IHRva2Vuc0ZvclNhbGUpOwoKICAgICAgICBjb250cmlidXRpb25zW19iZW5lZmljaWFyeV0gPSBfd2VpQW1vdW50LmFkZChjb250cmlidXRpb25zW19iZW5lZmljaWFyeV0pOwogICAgICAgIHRva2VuQmFsYW5jZXNbX2JlbmVmaWNpYXJ5XSA9IF90b2tlbnNRdHkuYWRkKHRva2VuQmFsYW5jZXNbX2JlbmVmaWNpYXJ5XSk7CiAgICAgICAgd2VpUmVjZWl2ZWQgPSB3ZWlSZWNlaXZlZC5hZGQoX3dlaUFtb3VudCk7CiAgICAgICAgdG9rZW5zRGlzdHJpYnV0ZWQgPSBfZGlzdHJpYnV0ZWQ7CiAgICAgICAgdG9rZW5zU29sZCA9IF9zb2xkOwoKICAgICAgICBDb250cmlidXRlKF9iZW5lZmljaWFyeSwgbXNnLnZhbHVlKTsKCiAgICAgICAgQWNqVG9rZW4gX3Rva2VuID0gQWNqVG9rZW4odG9rZW4pOwogICAgICAgIF90b2tlbi5pbml0aWFsVHJhbnNmZXIoX2JlbmVmaWNpYXJ5LCBfdG9rZW5zUXR5KTsKICAgIH0KCiAgICAvKgogICAgICogQ3Jvd2RzYWxlIEhlbHBlcnMgCiAgICAgKi8KICAgIGZ1bmN0aW9uIGhhc0VuZGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyhib29sKSB7CgogICAgICAgIHJldHVybiBub3cgPiBlbmRJY287CiAgICB9CgogICAgLyoKICAgICAqIENoZWNrcyBpZiB0aGUgY3Jvd2RzYWxlIGlzIGEgc3VjY2VzcwogICAgICovCiAgICBmdW5jdGlvbiBpc1N1Y2Nlc3MoKSBwdWJsaWMgdmlldyByZXR1cm5zKGJvb2wpIHsKCiAgICAgICAgaWYgKHRva2Vuc1NvbGQgPj0gdG9rZW5zU29mdENhcCkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qCiAgICAgKiBDaGVja3MgaWYgdGhlIGNyb3dkc2FsZSBmYWlsZWQKICAgICAqLwogICAgZnVuY3Rpb24gaXNGYWlsZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zKGJvb2wpIHsKCiAgICAgICAgaWYgKHRva2Vuc1NvbGQgPCB0b2tlbnNTb2Z0Q2FwICYmIG5vdyA+IGVuZEljbykgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qIAogICAgICogQm9udXMgY2FsY3VsYXRpb25zCiAgICAgKiBFaXRoZXIgdGltZSBvciBFVEggcXVhbnRpdHkgYmFzZWQgCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldEJvbnVzKHVpbnQyNTYgX3dlaSkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2IGV0aFRvQWNqKSB7CgogICAgICAgIHVpbnQyNTYgX2JvbnVzID0gMDsKCiAgICAgICAgLy8gVGltZSBiYXNlZCBib251cwogICAgICAgIGlmIChlbmRQcmVzYWxlID4gbm93KSB7CiAgICAgICAgICAgIF9ib251cyA9IF9ib251cy5hZGQoQk9OVVNfUFJFU0FMRSk7IAogICAgICAgIH0KCiAgICAgICAgLy8gRVRIIFF1YW50aXR5IGJhc2VkIGJvbnVzCiAgICAgICAgaWYgKF93ZWkgPj0gQk9OVVNfSElfUVRZKSB7IAogICAgICAgICAgICBfYm9udXMgPSBfYm9udXMuYWRkKEJPTlVTX0hJKTsKICAgICAgICB9IGVsc2UgaWYgKF93ZWkgPj0gQk9OVVNfTUlEX1FUWSkgewogICAgICAgICAgICBfYm9udXMgPSBfYm9udXMuYWRkKEJPTlVTX01JRCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZXRoVG9rZW5SYXRlLm11bCgxMDAgKyBfYm9udXMpIC8gMTAwOwogICAgfQoKfQ=='.
	

]
