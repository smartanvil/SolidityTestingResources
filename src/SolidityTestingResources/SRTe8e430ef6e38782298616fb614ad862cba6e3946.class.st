Class {
	#name : #SRTe8e430ef6e38782298616fb614ad862cba6e3946,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTe8e430ef6e38782298616fb614ad862cba6e3946 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjA7CgogCi8qCuKWiOKWgOKWgOKWiCDilojiloDiloDilogg4paIICAg4paIICAg4paI4paA4paE4paA4paIICDiloAgIOKWiOKWgOKWgOKWhAriloggIOKWiCDiloggIOKWiCDilojiloTilojiloTiloggICDilogg4paAIOKWiCDiloDilojiloAg4paI4paA4paA4paECuKWiOKWgOKWgOKWgCDiloDiloDiloDiloAgIOKWgCDiloAgICAg4paAICAg4paAIOKWgOKWgOKWgCDiloDiloDiloAgCgrilojiloDiloDilogg4paI4paA4paA4paIIOKWiOKWgOKWgOKWiCDilojiloDiloDilogg4paI4paA4paAICAg4paI4paA4paA4paIIOKWiOKWgOKWgCAgIOKWiCAgIOKWiCDilojiloDiloAg4paI4paA4paA4paIIOKWiCDilogK4paIICDilogg4paI4paE4paE4paAIOKWiCAg4paIIOKWiCAg4paIIOKWiOKWgOKWgCAgIOKWiCAg4paIIOKWiOKWgOKWgCAgIOKWiOKWhOKWiOKWhOKWiCDilojiloDiloAg4paI4paE4paE4paIIOKWiOKWgOKWhArilojiloDiloDiloAg4paAIOKWgOKWgCDiloDiloDiloDiloAg4paA4paA4paA4paAIOKWgCAgICAg4paA4paA4paA4paAIOKWgCAgICAgIOKWgCDiloAgIOKWgOKWgOKWgCDiloAgIOKWgCDiloAg4paACgrilojiloDiloTiloDilogg4paI4paA4paA4paIIOKWiOKWgOKWgOKWhCAgICDiloAgIOKWiOKWgOKWgOKWhCAgIOKWiOKWgOKWgOKWhCDiloggICDilojiloDiloDilogg4paI4paA4paAIOKWiCDilogK4paIIOKWgCDilogg4paI4paE4paE4paIIOKWiCAg4paIICAg4paA4paI4paAIOKWiCAg4paIICAg4paI4paA4paA4paEIOKWiCAgIOKWiOKWhOKWhOKWiCDiloggICDilojiloDiloQK4paAICAg4paAIOKWgCAg4paAIOKWgCAg4paAICAg4paA4paA4paAIOKWgCAg4paAICAg4paA4paA4paAICDiloDiloDiloAg4paAICDiloAg4paA4paA4paAIOKWgCDiloAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg4paI4paI4paI4paI4paI4paI4paI4paI4paI4paIICAgICAgIAogICAgICAgICAgICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiCAgICAgIAogICAgICAgICAgICAgIOKWiOKWiCAgICAgICAg4paI4paIICAgICAgCiAgICAgICAgICAgICAg4paI4paI4paE4paE4paE4paE4paE4paE4paE4paE4paE4paIICAgICAgCiAgICAgICAgICAgICAg4paI4paI4paA4paI4paI4paIIOKWiOKWiOKWiOKWgOKWiCAgICAgICAK4paIICAgICAgICAgICAgIOKWgOKWiCAgICAgICAg4paI4paAICAgICAgCuKWiOKWiCAgICAgICAgICAgICAgICAgIOKWiCAgICAgICAgICAgCiDiloggICAgICAgICAgICAgIOKWiOKWiCAgICAgICAgICAgICAgCuKWiOKWhCAgICAgICAgICAgIOKWiOKWiOKWiOKWiCDilojiloggIOKWiOKWiOKWiOKWiAog4paE4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paIICDilojiloggIOKWiOKWiOKWiOKWiOKWiOKWiCAgIAogICAg4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paIICDilojiloggIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiAogICAgICAgICAgICAg4paI4paI4paI4paIICDilojilogg4paI4paI4paI4paI4paIICDilojilojilogKICAgICAgICAgICAgICDilojilojiloggIOKWiOKWiCDilojilojilojilojiloggIOKWiOKWiOKWiAogICAgICAgICAgICAgIOKWiOKWiOKWiCAgICAg4paI4paI4paI4paI4paI4paI4paI4paI4paICiAgICAgICAgICAgICAg4paI4paIICAgICDilojilojilojilojilojilojilojilojiloAKICAgICAgICAgICAgICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiAogICAgICAgICAgICAgICAg4paI4paI4paI4paI4paI4paI4paI4paI4paI4paICiAgICAgICAgICAgICAgICAg4paI4paI4paI4paI4paI4paI4paI4paICiAgICAgICAgICAgICAgICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWhOKWhAogICAgICAgICAgICAgICAgICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWgAogICAgICAgICAgICAgICAgICAgICDilojilojilojiloggIOKWiOKWiOKWiAogICAgICAgICAgICAgICAgICAgIOKWhOKWiOKWiOKWiOKWiOKWhCAg4paI4paICiAgICAgICAgICAgICAgICAgICAg4paI4paI4paI4paI4paI4paIICAg4paACiAgICAgICAgICAgICAgICAgICAg4paA4paE4paE4paE4paE4paACioKKiBJc3N1ZTogT3JkaW5hcnkgcHlyYW1pZCBzY2hlbWVzIGhhdmUgYSB0b2tlbiBwcmljZSB0aGF0IHZhcmllcyB3aXRoIHRoZSBjb250cmFjdCBiYWxhbmNlLiAKKiBUaGlzIGxlYXZlcyB5b3UgdnVsbmVyYWJsZSB0byB0aGUgd2hpbXMgb2YgdGhlIG1hcmtldCwgYXMgYSBzdWRkZW4gY3Jhc2ggY2FuIGRyYWluIHlvdXIgaW52ZXN0bWVudCBhdCBhbnkgdGltZS4KKiBTb2x1dGlvbjogV2UgcmVtb3ZlIHRva2VucyBmcm9tIHRoZSBlcXVhdGlvbiBhbHRvZ2V0aGVyLCByZWxpZXZpbmcgaW52ZXN0b3JzIG9mIHZvbGF0aWxpdHkuIAoqIFRoZSBvdXRjb21lIGlzIGEgcHlyYW1pZCBzY2hlbWUgcG93ZXJlZCBlbnRpcmVseSBieSBkaXZpZGVuZHMuCiogV2UgZGlzdHJpYnV0ZSAzMyUgb2YgZXZlcnkgYnV5IGFuZCBzZWxsIHRvIHNoYXJlaG9sZGVycyBpbiBwcm9wb3J0aW9uIHRvIHRoZWlyIHN0YWtlIGluIHRoZSBjb250cmFjdC4gCiogT25jZSB5b3UndmUgbWFkZSBhIGRlcG9zaXQsIHlvdXIgZGl2aWRlbmRzIHdpbGwgYWNjdW11bGF0ZSBvdmVyIHRpbWUgd2hpbGUgeW91ciBpbnZlc3RtZW50IHJlbWFpbnMgc2FmZSBhbmQgc3RhYmxlLCAKKiBtYWtpbmcgdGhpcyB0aGUgdWx0aW1hdGUgdmVoaWNsZSBmb3IgcGFzc2l2ZSBpbmNvbWUuCioKCgpjb250cmFjdCBQb1dfTUlCIHsKICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgPSAgICAgICAgICAgIE1PRElGSUVSUyAgICAgICAgICA9CiAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIC8vIG9ubHkgcGVvcGxlIHdpdGggdG9rZW5zCiAgICBtb2RpZmllciBvbmx5QmFnaG9sZGVycygpIHsKICAgICAgICByZXF1aXJlKG15VG9rZW5zKCkgPiAwKTsKICAgICAgICBfOwogICAgfQoKICAgIC8vIG9ubHkgcGVvcGxlIHdpdGggcHJvZml0cwogICAgbW9kaWZpZXIgb25seVN0cm9uZ2hhbmRzKCkgewogICAgICAgIHJlcXVpcmUobXlEaXZpZGVuZHModHJ1ZSkgPiAwKTsKICAgICAgICBfOwogICAgfQoKICAgIC8vIGFkbWluaXN0cmF0b3JzIGNhbjoKICAgIC8vIC0+IGNoYW5nZSB0aGUgbmFtZSBvZiB0aGUgY29udHJhY3QKICAgIC8vIC0+IGNoYW5nZSB0aGUgbmFtZSBvZiB0aGUgdG9rZW4KICAgIC8vIC0+IGNoYW5nZSB0aGUgUG9TIGRpZmZpY3VsdHkgKEhvdyBtYW55IHRva2VucyBpdCBjb3N0cyB0byBob2xkIGEgbWFzdGVybm9kZSwgaW4gY2FzZSBpdCBnZXRzIGNyYXp5IGhpZ2ggbGF0ZXIpCiAgICAvLyB0aGV5IENBTk5PVDoKICAgIC8vIC0+IHRha2UgZnVuZHMKICAgIC8vIC0+IGRpc2FibGUgd2l0aGRyYXdhbHMKICAgIC8vIC0+IGtpbGwgdGhlIGNvbnRyYWN0CiAgICAvLyAtPiBjaGFuZ2UgdGhlIHByaWNlIG9mIHRva2VucwogICAgbW9kaWZpZXIgb25seUFkbWluaXN0cmF0b3IoKXsKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIHJlcXVpcmUoYWRtaW5pc3RyYXRvcnNba2VjY2FrMjU2KF9jdXN0b21lckFkZHJlc3MpXSk7CiAgICAgICAgXzsKICAgIH0KCgogICAgLy8gZW5zdXJlcyB0aGF0IHRoZSBmaXJzdCB0b2tlbnMgaW4gdGhlIGNvbnRyYWN0IHdpbGwgYmUgZXF1YWxseSBkaXN0cmlidXRlZAogICAgLy8gbWVhbmluZywgbm8gZGl2aW5lIGR1bXAgd2lsbCBiZSBldmVyIHBvc3NpYmxlCiAgICAvLyByZXN1bHQ6IGhlYWx0aHkgbG9uZ2V2aXR5LgogICAgbW9kaWZpZXIgYW50aUVhcmx5V2hhbGUodWludDI1NiBfYW1vdW50T2ZFdGhlcmV1bSl7CiAgICAgICAgYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKCiAgICAgICAgLy8gYXJlIHdlIHN0aWxsIGluIHRoZSB2dWxuZXJhYmxlIHBoYXNlPwogICAgICAgIC8vIGlmIHNvLCBlbmFjdCBhbnRpIGVhcmx5IHdoYWxlIHByb3RvY29sCiAgICAgICAgaWYoIG9ubHlBbWJhc3NhZG9ycyAmJiAoKHRvdGFsRXRoZXJldW1CYWxhbmNlKCkgLSBfYW1vdW50T2ZFdGhlcmV1bSkgPD0gYW1iYXNzYWRvclF1b3RhXyApKXsKICAgICAgICAgICAgcmVxdWlyZSgKICAgICAgICAgICAgICAgIC8vIGlzIHRoZSBjdXN0b21lciBpbiB0aGUgYW1iYXNzYWRvciBsaXN0PwogICAgICAgICAgICAgICAgYW1iYXNzYWRvcnNfW19jdXN0b21lckFkZHJlc3NdID09IHRydWUgJiYKCiAgICAgICAgICAgICAgICAvLyBkb2VzIHRoZSBjdXN0b21lciBwdXJjaGFzZSBleGNlZWQgdGhlIG1heCBhbWJhc3NhZG9yIHF1b3RhPwogICAgICAgICAgICAgICAgKGFtYmFzc2Fkb3JBY2N1bXVsYXRlZFF1b3RhX1tfY3VzdG9tZXJBZGRyZXNzXSArIF9hbW91bnRPZkV0aGVyZXVtKSA8PSBhbWJhc3NhZG9yTWF4UHVyY2hhc2VfCgogICAgICAgICAgICApOwoKICAgICAgICAgICAgLy8gdXBkYXRlZCB0aGUgYWNjdW11bGF0ZWQgcXVvdGEKICAgICAgICAgICAgYW1iYXNzYWRvckFjY3VtdWxhdGVkUXVvdGFfW19jdXN0b21lckFkZHJlc3NdID0gU2FmZU1hdGguYWRkKGFtYmFzc2Fkb3JBY2N1bXVsYXRlZFF1b3RhX1tfY3VzdG9tZXJBZGRyZXNzXSwgX2Ftb3VudE9mRXRoZXJldW0pOwoKICAgICAgICAgICAgLy8gZXhlY3V0ZQogICAgICAgICAgICBfOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIGluIGNhc2UgdGhlIGV0aGVyIGNvdW50IGRyb3BzIGxvdywgdGhlIGFtYmFzc2Fkb3IgcGhhc2Ugd29uJ3QgcmVpbml0aWF0ZQogICAgICAgICAgICBvbmx5QW1iYXNzYWRvcnMgPSBmYWxzZTsKICAgICAgICAgICAgXzsKICAgICAgICB9CgogICAgfQoKCiAgICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICA9ICAgICAgICAgICAgRVZFTlRTICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICBldmVudCBvblRva2VuUHVyY2hhc2UoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIGN1c3RvbWVyQWRkcmVzcywKICAgICAgICB1aW50MjU2IGluY29taW5nRXRoZXJldW0sCiAgICAgICAgdWludDI1NiB0b2tlbnNNaW50ZWQsCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIHJlZmVycmVkQnkKICAgICk7CgogICAgZXZlbnQgb25Ub2tlblNlbGwoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIGN1c3RvbWVyQWRkcmVzcywKICAgICAgICB1aW50MjU2IHRva2Vuc0J1cm5lZCwKICAgICAgICB1aW50MjU2IGV0aGVyZXVtRWFybmVkCiAgICApOwoKICAgIGV2ZW50IG9uUmVpbnZlc3RtZW50KAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBjdXN0b21lckFkZHJlc3MsCiAgICAgICAgdWludDI1NiBldGhlcmV1bVJlaW52ZXN0ZWQsCiAgICAgICAgdWludDI1NiB0b2tlbnNNaW50ZWQKICAgICk7CgogICAgZXZlbnQgb25XaXRoZHJhdygKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgY3VzdG9tZXJBZGRyZXNzLAogICAgICAgIHVpbnQyNTYgZXRoZXJldW1XaXRoZHJhd24KICAgICk7CgogICAgLy8gRVJDMjAKICAgIGV2ZW50IFRyYW5zZmVyKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBmcm9tLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCB0bywKICAgICAgICB1aW50MjU2IHRva2VucwogICAgKTsKCgogICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgID0gICAgICAgICAgICBDT05GSUdVUkFCTEVTICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgc3RyaW5nIHB1YmxpYyBuYW1lID0gIlBvV19NSUIiOwogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAiUG9XX01JQiI7CiAgICB1aW50OCBjb25zdGFudCBwdWJsaWMgZGVjaW1hbHMgPSAxODsKICAgIHVpbnQ4IGNvbnN0YW50IGludGVybmFsIGVudHJ5RmVlXyA9IDMzOyAvLyAyMCUgdG8gZW50ZXIgCiAgICB1aW50OCBjb25zdGFudCBpbnRlcm5hbCB0cmFuc2ZlckZlZV8gPSAxMDsgLy8gMTAlIHRyYW5zZmVyIGZlZQogICAgdWludDggY29uc3RhbnQgaW50ZXJuYWwgcmVmZmVyYWxGZWVfID0gMzM7IC8vIDMzJSBmcm9tIGVudGVyIGZlZSBkaXZzIG9yIDclIGZvciBlYWNoIGludml0ZQogICAgdWludDggY29uc3RhbnQgaW50ZXJuYWwgZXhpdEZlZV8gPSAzMzsgLy8gMjAlIGZvciBzZWxsaW5nCiAgICB1aW50MjU2IGNvbnN0YW50IGludGVybmFsIHRva2VuUHJpY2VJbml0aWFsXyA9IDAuMDAwMDAwMSBldGhlcjsKICAgIHVpbnQyNTYgY29uc3RhbnQgaW50ZXJuYWwgdG9rZW5QcmljZUluY3JlbWVudGFsXyA9IDAuMDAwMDAwMDEgZXRoZXI7CiAgICB1aW50MjU2IGNvbnN0YW50IGludGVybmFsIG1hZ25pdHVkZSA9IDIqKjY0OwoKICAgIC8vIHByb29mIG9mIHN0YWtlIChkZWZhdWx0cyBhdCAxMDAgdG9rZW5zKQogICAgdWludDI1NiBwdWJsaWMgc3Rha2luZ1JlcXVpcmVtZW50ID0gMTAwZTE4OwoKICAgIC8vIGFtYmFzc2Fkb3IgcHJvZ3JhbQogICAgbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIGludGVybmFsIGFtYmFzc2Fkb3JzXzsKICAgIHVpbnQyNTYgY29uc3RhbnQgaW50ZXJuYWwgYW1iYXNzYWRvck1heFB1cmNoYXNlXyA9IDEgZXRoZXI7CiAgICB1aW50MjU2IGNvbnN0YW50IGludGVybmFsIGFtYmFzc2Fkb3JRdW90YV8gPSAyMCBldGhlcjsgCgoKCiAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgPSAgICAgICAgICAgIERBVEFTRVRTICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIC8vIGFtb3VudCBvZiBzaGFyZXMgZm9yIGVhY2ggYWRkcmVzcyAoc2NhbGVkIG51bWJlcikKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBpbnRlcm5hbCB0b2tlbkJhbGFuY2VMZWRnZXJfOwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGludGVybmFsIHJlZmVycmFsQmFsYW5jZV87CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gaW50MjU2KSBpbnRlcm5hbCBwYXlvdXRzVG9fOwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGludGVybmFsIGFtYmFzc2Fkb3JBY2N1bXVsYXRlZFF1b3RhXzsKICAgIHVpbnQyNTYgaW50ZXJuYWwgdG9rZW5TdXBwbHlfID0gMDsKICAgIHVpbnQyNTYgaW50ZXJuYWwgcHJvZml0UGVyU2hhcmVfOwoKICAgIC8vIGFkbWluaXN0cmF0b3IgbGlzdCAoc2VlIGFib3ZlIG9uIHdoYXQgdGhleSBjYW4gZG8pCiAgICBtYXBwaW5nKGJ5dGVzMzIgPT4gYm9vbCkgcHVibGljIGFkbWluaXN0cmF0b3JzOwoKICAgIC8vIHdoZW4gdGhpcyBpcyBzZXQgdG8gdHJ1ZSwgb25seSBhbWJhc3NhZG9ycyBjYW4gcHVyY2hhc2UgdG9rZW5zICh0aGlzIHByZXZlbnRzIGEgd2hhbGUgcHJlbWluZSwgaXQgZW5zdXJlcyBhIGZhaXJseSBkaXN0cmlidXRlZCB1cHBlciBweXJhbWlkKQogICAgYm9vbCBwdWJsaWMgb25seUFtYmFzc2Fkb3JzID0gZmFsc2U7CgoKCiAgICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICA9ICAgICAgICAgICAgUFVCTElDIEZVTkNUSU9OUyAgICAgICAgICAgID0KICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgIAogICAgKiAtLSBBUFBMSUNBVElPTiBFTlRSWSBQT0lOVFMgLS0KICAgIAogICAgZnVuY3Rpb24gU3Ryb25nSG9sZCgpCiAgICAgICAgcHVibGljCiAgICB7CiAgICAgICAgLy8gYWRkIGFkbWluaXN0cmF0b3JzIGhlcmUKICAgICAgIAoKCiAgICB9CgoKICAgICAqCiAgICAgKiBDb252ZXJ0cyBhbGwgaW5jb21pbmcgZXRoZXJldW0gdG8gdG9rZW5zIGZvciB0aGUgY2FsbGVyLCBhbmQgcGFzc2VzIGRvd24gdGhlIHJlZmVycmFsIGFkZHkgKGlmIGFueSkKICAgICAKICAgIGZ1bmN0aW9uIGJ1eShhZGRyZXNzIF9yZWZlcnJlZEJ5KQogICAgICAgIHB1YmxpYwogICAgICAgIHBheWFibGUKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgcHVyY2hhc2VUb2tlbnMobXNnLnZhbHVlLCBfcmVmZXJyZWRCeSk7CiAgICB9CgogICAgICoKICAgICAqIEZhbGxiYWNrIGZ1bmN0aW9uIHRvIGhhbmRsZSBldGhlcmV1bSB0aGF0IHdhcyBzZW5kIHN0cmFpZ2h0IHRvIHRoZSBjb250cmFjdAogICAgICogVW5mb3J0dW5hdGVseSB3ZSBjYW5ub3QgdXNlIGEgcmVmZXJyYWwgYWRkcmVzcyB0aGlzIHdheS4KICAgICAKICAgIGZ1bmN0aW9uKCkKICAgICAgICBwYXlhYmxlCiAgICAgICAgcHVibGljCiAgICB7CiAgICAgICAgcHVyY2hhc2VUb2tlbnMobXNnLnZhbHVlLCAweDApOwogICAgfQoKICAgICAqCiAgICAgKiBDb252ZXJ0cyBhbGwgb2YgY2FsbGVyJ3MgZGl2aWRlbmRzIHRvIHRva2Vucy4KICAgIAogICAgZnVuY3Rpb24gcmVpbnZlc3QoKQogICAgICAgIG9ubHlTdHJvbmdoYW5kcygpCiAgICAgICAgcHVibGljCiAgICB7CiAgICAgICAgLy8gZmV0Y2ggZGl2aWRlbmRzCiAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gbXlEaXZpZGVuZHMoZmFsc2UpOyAvLyByZXRyaWV2ZSByZWYuIGJvbnVzIGxhdGVyIGluIHRoZSBjb2RlCgogICAgICAgIC8vIHBheSBvdXQgdGhlIGRpdmlkZW5kcyB2aXJ0dWFsbHkKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIHBheW91dHNUb19bX2N1c3RvbWVyQWRkcmVzc10gKz0gIChpbnQyNTYpIChfZGl2aWRlbmRzICogbWFnbml0dWRlKTsKCiAgICAgICAgLy8gcmV0cmlldmUgcmVmLiBib251cwogICAgICAgIF9kaXZpZGVuZHMgKz0gcmVmZXJyYWxCYWxhbmNlX1tfY3VzdG9tZXJBZGRyZXNzXTsKICAgICAgICByZWZlcnJhbEJhbGFuY2VfW19jdXN0b21lckFkZHJlc3NdID0gMDsKCiAgICAgICAgLy8gZGlzcGF0Y2ggYSBidXkgb3JkZXIgd2l0aCB0aGUgdmlydHVhbGl6ZWQgIndpdGhkcmF3biBkaXZpZGVuZHMiCiAgICAgICAgdWludDI1NiBfdG9rZW5zID0gcHVyY2hhc2VUb2tlbnMoX2RpdmlkZW5kcywgMHgwKTsKCiAgICAgICAgLy8gZmlyZSBldmVudAogICAgICAgIG9uUmVpbnZlc3RtZW50KF9jdXN0b21lckFkZHJlc3MsIF9kaXZpZGVuZHMsIF90b2tlbnMpOwogICAgfQoKICAgICAqCiAgICAgKiBBbGlhcyBvZiBzZWxsKCkgYW5kIHdpdGhkcmF3KCkuCiAgICAgCiAgICBmdW5jdGlvbiBleGl0KCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICAvLyBnZXQgdG9rZW4gY291bnQgZm9yIGNhbGxlciAmIHNlbGwgdGhlbSBhbGwKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIHVpbnQyNTYgX3Rva2VucyA9IHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc107CiAgICAgICAgaWYoX3Rva2VucyA+IDApIHNlbGwoX3Rva2Vucyk7CgogICAgICAgIC8vIGxhbWJvIGRlbGl2ZXJ5IHNlcnZpY2UKICAgICAgICB3aXRoZHJhdygpOwogICAgfQoKICAgICAqCiAgICAgKiBXaXRoZHJhd3MgYWxsIG9mIHRoZSBjYWxsZXJzIGVhcm5pbmdzLgogICAgIAogICAgZnVuY3Rpb24gd2l0aGRyYXcoKQogICAgICAgIG9ubHlTdHJvbmdoYW5kcygpCiAgICAgICAgcHVibGljCiAgICB7CiAgICAgICAgLy8gc2V0dXAgZGF0YQogICAgICAgIGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gbXlEaXZpZGVuZHMoZmFsc2UpOyAvLyBnZXQgcmVmLiBib251cyBsYXRlciBpbiB0aGUgY29kZQoKICAgICAgICAvLyB1cGRhdGUgZGl2aWRlbmQgdHJhY2tlcgogICAgICAgIHBheW91dHNUb19bX2N1c3RvbWVyQWRkcmVzc10gKz0gIChpbnQyNTYpIChfZGl2aWRlbmRzICogbWFnbml0dWRlKTsKCiAgICAgICAgLy8gYWRkIHJlZi4gYm9udXMKICAgICAgICBfZGl2aWRlbmRzICs9IHJlZmVycmFsQmFsYW5jZV9bX2N1c3RvbWVyQWRkcmVzc107CiAgICAgICAgcmVmZXJyYWxCYWxhbmNlX1tfY3VzdG9tZXJBZGRyZXNzXSA9IDA7CgogICAgICAgIC8vIGxhbWJvIGRlbGl2ZXJ5IHNlcnZpY2UKICAgICAgICBfY3VzdG9tZXJBZGRyZXNzLnRyYW5zZmVyKF9kaXZpZGVuZHMpOwoKICAgICAgICAvLyBmaXJlIGV2ZW50CiAgICAgICAgb25XaXRoZHJhdyhfY3VzdG9tZXJBZGRyZXNzLCBfZGl2aWRlbmRzKTsKICAgIH0KCiAgICAgKgogICAgICogTGlxdWlmaWVzIHRva2VucyB0byBldGhlcmV1bS4KICAgICAKICAgIGZ1bmN0aW9uIHNlbGwodWludDI1NiBfYW1vdW50T2ZUb2tlbnMpCiAgICAgICAgb25seUJhZ2hvbGRlcnMoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIC8vIHNldHVwIGRhdGEKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIC8vIHJ1c3NpYW4gaGFja2VycyBCVEZPCiAgICAgICAgcmVxdWlyZShfYW1vdW50T2ZUb2tlbnMgPD0gdG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSk7CiAgICAgICAgdWludDI1NiBfdG9rZW5zID0gX2Ftb3VudE9mVG9rZW5zOwogICAgICAgIHVpbnQyNTYgX2V0aGVyZXVtID0gdG9rZW5zVG9FdGhlcmV1bV8oX3Rva2Vucyk7CiAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChfZXRoZXJldW0sIGV4aXRGZWVfKSwgMTAwKTsKICAgICAgICB1aW50MjU2IF90YXhlZEV0aGVyZXVtID0gU2FmZU1hdGguc3ViKF9ldGhlcmV1bSwgX2RpdmlkZW5kcyk7CgogICAgICAgIC8vIGJ1cm4gdGhlIHNvbGQgdG9rZW5zCiAgICAgICAgdG9rZW5TdXBwbHlfID0gU2FmZU1hdGguc3ViKHRva2VuU3VwcGx5XywgX3Rva2Vucyk7CiAgICAgICAgdG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSA9IFNhZmVNYXRoLnN1Yih0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdLCBfdG9rZW5zKTsKCiAgICAgICAgLy8gdXBkYXRlIGRpdmlkZW5kcyB0cmFja2VyCiAgICAgICAgaW50MjU2IF91cGRhdGVkUGF5b3V0cyA9IChpbnQyNTYpIChwcm9maXRQZXJTaGFyZV8gKiBfdG9rZW5zICsgKF90YXhlZEV0aGVyZXVtICogbWFnbml0dWRlKSk7CiAgICAgICAgcGF5b3V0c1RvX1tfY3VzdG9tZXJBZGRyZXNzXSAtPSBfdXBkYXRlZFBheW91dHM7CgogICAgICAgIC8vIGRpdmlkaW5nIGJ5IHplcm8gaXMgYSBiYWQgaWRlYQogICAgICAgIGlmICh0b2tlblN1cHBseV8gPiAwKSB7CiAgICAgICAgICAgIC8vIHVwZGF0ZSB0aGUgYW1vdW50IG9mIGRpdmlkZW5kcyBwZXIgdG9rZW4KICAgICAgICAgICAgcHJvZml0UGVyU2hhcmVfID0gU2FmZU1hdGguYWRkKHByb2ZpdFBlclNoYXJlXywgKF9kaXZpZGVuZHMgKiBtYWduaXR1ZGUpIC8gdG9rZW5TdXBwbHlfKTsKICAgICAgICB9CgogICAgICAgIC8vIGZpcmUgZXZlbnQKICAgICAgICBvblRva2VuU2VsbChfY3VzdG9tZXJBZGRyZXNzLCBfdG9rZW5zLCBfdGF4ZWRFdGhlcmV1bSk7CiAgICB9CgoKICAgICAqCiAgICAgKiBUcmFuc2ZlciB0b2tlbnMgZnJvbSB0aGUgY2FsbGVyIHRvIGEgbmV3IGhvbGRlci4KICAgICAqIFJlbWVtYmVyLCB0aGVyZSdzIGEgMTAlIGZlZSBoZXJlIGFzIHdlbGwuCiAgICAgCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90b0FkZHJlc3MsIHVpbnQyNTYgX2Ftb3VudE9mVG9rZW5zKQogICAgICAgIG9ubHlCYWdob2xkZXJzKCkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zKGJvb2wpCiAgICB7CiAgICAgICAgLy8gc2V0dXAKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwoKICAgICAgICAvLyBtYWtlIHN1cmUgd2UgaGF2ZSB0aGUgcmVxdWVzdGVkIHRva2VucwogICAgICAgIC8vIGFsc28gZGlzYWJsZXMgdHJhbnNmZXJzIHVudGlsIGFtYmFzc2Fkb3IgcGhhc2UgaXMgb3ZlcgogICAgICAgIC8vICggd2UgZG9udCB3YW50IHdoYWxlIHByZW1pbmVzICkKICAgICAgICByZXF1aXJlKCFvbmx5QW1iYXNzYWRvcnMgJiYgX2Ftb3VudE9mVG9rZW5zIDw9IHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc10pOwoKICAgICAgICAvLyB3aXRoZHJhdyBhbGwgb3V0c3RhbmRpbmcgZGl2aWRlbmRzIGZpcnN0CiAgICAgICAgaWYobXlEaXZpZGVuZHModHJ1ZSkgPiAwKSB3aXRoZHJhdygpOwoKICAgICAgICAvLyBsaXF1aWZ5IDEwJSBvZiB0aGUgdG9rZW5zIHRoYXQgYXJlIHRyYW5zZmVyZWQKICAgICAgICAvLyB0aGVzZSBhcmUgZGlzcGVyc2VkIHRvIHNoYXJlaG9sZGVycwogICAgICAgIHVpbnQyNTYgX3Rva2VuRmVlID0gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChfYW1vdW50T2ZUb2tlbnMsIHRyYW5zZmVyRmVlXyksIDEwMCk7CiAgICAgICAgdWludDI1NiBfdGF4ZWRUb2tlbnMgPSBTYWZlTWF0aC5zdWIoX2Ftb3VudE9mVG9rZW5zLCBfdG9rZW5GZWUpOwogICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IHRva2Vuc1RvRXRoZXJldW1fKF90b2tlbkZlZSk7CgogICAgICAgIC8vIGJ1cm4gdGhlIGZlZSB0b2tlbnMKICAgICAgICB0b2tlblN1cHBseV8gPSBTYWZlTWF0aC5zdWIodG9rZW5TdXBwbHlfLCBfdG9rZW5GZWUpOwoKICAgICAgICAvLyBleGNoYW5nZSB0b2tlbnMKICAgICAgICB0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdID0gU2FmZU1hdGguc3ViKHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc10sIF9hbW91bnRPZlRva2Vucyk7CiAgICAgICAgdG9rZW5CYWxhbmNlTGVkZ2VyX1tfdG9BZGRyZXNzXSA9IFNhZmVNYXRoLmFkZCh0b2tlbkJhbGFuY2VMZWRnZXJfW190b0FkZHJlc3NdLCBfdGF4ZWRUb2tlbnMpOwoKICAgICAgICAvLyB1cGRhdGUgZGl2aWRlbmQgdHJhY2tlcnMKICAgICAgICBwYXlvdXRzVG9fW19jdXN0b21lckFkZHJlc3NdIC09IChpbnQyNTYpIChwcm9maXRQZXJTaGFyZV8gKiBfYW1vdW50T2ZUb2tlbnMpOwogICAgICAgIHBheW91dHNUb19bX3RvQWRkcmVzc10gKz0gKGludDI1NikgKHByb2ZpdFBlclNoYXJlXyAqIF90YXhlZFRva2Vucyk7CgogICAgICAgIC8vIGRpc3BlcnNlIGRpdmlkZW5kcyBhbW9uZyBob2xkZXJzCiAgICAgICAgcHJvZml0UGVyU2hhcmVfID0gU2FmZU1hdGguYWRkKHByb2ZpdFBlclNoYXJlXywgKF9kaXZpZGVuZHMgKiBtYWduaXR1ZGUpIC8gdG9rZW5TdXBwbHlfKTsKCiAgICAgICAgLy8gZmlyZSBldmVudAogICAgICAgIFRyYW5zZmVyKF9jdXN0b21lckFkZHJlc3MsIF90b0FkZHJlc3MsIF90YXhlZFRva2Vucyk7CgogICAgICAgIC8vIEVSQzIwCiAgICAgICAgcmV0dXJuIHRydWU7CgogICAgfQoKICAgICAtLS0tLS0tLS0tICBBRE1JTklTVFJBVE9SIE9OTFkgRlVOQ1RJT05TICAtLS0tLS0tLS0tCiAgICAgKgogICAgICogSW4gY2FzZSB0aGUgYW1hc3NhZG9yIHF1b3RhIGlzIG5vdCBtZXQsIHRoZSBhZG1pbmlzdHJhdG9yIGNhbiBtYW51YWxseSBkaXNhYmxlIHRoZSBhbWJhc3NhZG9yIHBoYXNlLgogICAgIAogICAgZnVuY3Rpb24gZGlzYWJsZUluaXRpYWxTdGFnZSgpCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIG9ubHlBbWJhc3NhZG9ycyA9IGZhbHNlOwogICAgfQoKICAgICAqCiAgICAgKiBJbiBjYXNlIG9uZSBvZiB1cyBkaWVzLCB3ZSBuZWVkIHRvIHJlcGxhY2Ugb3Vyc2VsdmVzLgogICAgIAogICAgZnVuY3Rpb24gc2V0QWRtaW5pc3RyYXRvcihieXRlczMyIF9pZGVudGlmaWVyLCBib29sIF9zdGF0dXMpCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIGFkbWluaXN0cmF0b3JzW19pZGVudGlmaWVyXSA9IF9zdGF0dXM7CiAgICB9CgogICAgICoKICAgICAqIFByZWNhdXRpb25hcnkgbWVhc3VyZXMgaW4gY2FzZSB3ZSBuZWVkIHRvIGFkanVzdCB0aGUgbWFzdGVybm9kZSByYXRlLgogICAgIAogICAgZnVuY3Rpb24gc2V0U3Rha2luZ1JlcXVpcmVtZW50KHVpbnQyNTYgX2Ftb3VudE9mVG9rZW5zKQogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yKCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICBzdGFraW5nUmVxdWlyZW1lbnQgPSBfYW1vdW50T2ZUb2tlbnM7CiAgICB9CgogICAgICoKICAgICAqIElmIHdlIHdhbnQgdG8gcmVicmFuZCwgd2UgY2FuLgogICAgIAogICAgZnVuY3Rpb24gc2V0TmFtZShzdHJpbmcgX25hbWUpCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIG5hbWUgPSBfbmFtZTsKICAgIH0KCiAgICAgKgogICAgICogSWYgd2Ugd2FudCB0byByZWJyYW5kLCB3ZSBjYW4uCiAgICAgCiAgICBmdW5jdGlvbiBzZXRTeW1ib2woc3RyaW5nIF9zeW1ib2wpCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIHN5bWJvbCA9IF9zeW1ib2w7CiAgICB9CgoKICAgICAtLS0tLS0tLS0tICBIRUxQRVJTIEFORCBDQUxDVUxBVE9SUyAgLS0tLS0tLS0tLQogICAgICoKICAgICAqIE1ldGhvZCB0byB2aWV3IHRoZSBjdXJyZW50IEV0aGVyZXVtIHN0b3JlZCBpbiB0aGUgY29udHJhY3QKICAgICAqIEV4YW1wbGU6IHRvdGFsRXRoZXJldW1CYWxhbmNlKCkKICAgICAKICAgIGZ1bmN0aW9uIHRvdGFsRXRoZXJldW1CYWxhbmNlKCkKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyh1aW50KQogICAgewogICAgICAgIHJldHVybiB0aGlzLmJhbGFuY2U7CiAgICB9CgogICAgICoKICAgICAqIFJldHJpZXZlIHRoZSB0b3RhbCB0b2tlbiBzdXBwbHkuCiAgICAgCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICByZXR1cm4gdG9rZW5TdXBwbHlfOwogICAgfQoKICAgICAqCiAgICAgKiBSZXRyaWV2ZSB0aGUgdG9rZW5zIG93bmVkIGJ5IHRoZSBjYWxsZXIuCiAgICAgCiAgICBmdW5jdGlvbiBteVRva2VucygpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIHJldHVybiBiYWxhbmNlT2YoX2N1c3RvbWVyQWRkcmVzcyk7CiAgICB9CgogICAgICoKICAgICAqIFJldHJpZXZlIHRoZSBkaXZpZGVuZHMgb3duZWQgYnkgdGhlIGNhbGxlci4KICAgICAqIElmIGBfaW5jbHVkZVJlZmVycmFsQm9udXNgIGlzIHRvIHRvIDEvdHJ1ZSwgdGhlIHJlZmVycmFsIGJvbnVzIHdpbGwgYmUgaW5jbHVkZWQgaW4gdGhlIGNhbGN1bGF0aW9ucy4KICAgICAqIFRoZSByZWFzb24gZm9yIHRoaXMsIGlzIHRoYXQgaW4gdGhlIGZyb250ZW5kLCB3ZSB3aWxsIHdhbnQgdG8gZ2V0IHRoZSB0b3RhbCBkaXZzIChnbG9iYWwgKyByZWYpCiAgICAgKiBCdXQgaW4gdGhlIGludGVybmFsIGNhbGN1bGF0aW9ucywgd2Ugd2FudCB0aGVtIHNlcGFyYXRlLgogICAgIAogICAgZnVuY3Rpb24gbXlEaXZpZGVuZHMoYm9vbCBfaW5jbHVkZVJlZmVycmFsQm9udXMpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIHJldHVybiBfaW5jbHVkZVJlZmVycmFsQm9udXMgPyBkaXZpZGVuZHNPZihfY3VzdG9tZXJBZGRyZXNzKSArIHJlZmVycmFsQmFsYW5jZV9bX2N1c3RvbWVyQWRkcmVzc10gOiBkaXZpZGVuZHNPZihfY3VzdG9tZXJBZGRyZXNzKSA7CiAgICB9CgogICAgICoKICAgICAqIFJldHJpZXZlIHRoZSB0b2tlbiBiYWxhbmNlIG9mIGFueSBzaW5nbGUgYWRkcmVzcy4KICAgICAKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MpCiAgICAgICAgdmlldwogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICByZXR1cm4gdG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXTsKICAgIH0KCiAgICAgKgogICAgICogUmV0cmlldmUgdGhlIGRpdmlkZW5kIGJhbGFuY2Ugb2YgYW55IHNpbmdsZSBhZGRyZXNzLgogICAgIAogICAgZnVuY3Rpb24gZGl2aWRlbmRzT2YoYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzKQogICAgICAgIHZpZXcKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgcmV0dXJuICh1aW50MjU2KSAoKGludDI1NikocHJvZml0UGVyU2hhcmVfICogdG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSkgLSBwYXlvdXRzVG9fW19jdXN0b21lckFkZHJlc3NdKSAvIG1hZ25pdHVkZTsKICAgIH0KCiAgICAgKgogICAgICogUmV0dXJuIHRoZSBidXkgcHJpY2Ugb2YgMSBpbmRpdmlkdWFsIHRva2VuLgogICAgIAogICAgZnVuY3Rpb24gc2VsbFByaWNlKCkKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIC8vIG91ciBjYWxjdWxhdGlvbiByZWxpZXMgb24gdGhlIHRva2VuIHN1cHBseSwgc28gd2UgbmVlZCBzdXBwbHkuIERvaC4KICAgICAgICBpZih0b2tlblN1cHBseV8gPT0gMCl7CiAgICAgICAgICAgIHJldHVybiB0b2tlblByaWNlSW5pdGlhbF8gLSB0b2tlblByaWNlSW5jcmVtZW50YWxfOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHVpbnQyNTYgX2V0aGVyZXVtID0gdG9rZW5zVG9FdGhlcmV1bV8oMWUxOCk7CiAgICAgICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoX2V0aGVyZXVtLCBleGl0RmVlXyksIDEwMCk7CiAgICAgICAgICAgIHVpbnQyNTYgX3RheGVkRXRoZXJldW0gPSBTYWZlTWF0aC5zdWIoX2V0aGVyZXVtLCBfZGl2aWRlbmRzKTsKICAgICAgICAgICAgcmV0dXJuIF90YXhlZEV0aGVyZXVtOwogICAgICAgIH0KICAgIH0KCiAgICAgKgogICAgICogUmV0dXJuIHRoZSBzZWxsIHByaWNlIG9mIDEgaW5kaXZpZHVhbCB0b2tlbi4KICAgICAKICAgIGZ1bmN0aW9uIGJ1eVByaWNlKCkKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIC8vIG91ciBjYWxjdWxhdGlvbiByZWxpZXMgb24gdGhlIHRva2VuIHN1cHBseSwgc28gd2UgbmVlZCBzdXBwbHkuIERvaC4KICAgICAgICBpZih0b2tlblN1cHBseV8gPT0gMCl7CiAgICAgICAgICAgIHJldHVybiB0b2tlblByaWNlSW5pdGlhbF8gKyB0b2tlblByaWNlSW5jcmVtZW50YWxfOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHVpbnQyNTYgX2V0aGVyZXVtID0gdG9rZW5zVG9FdGhlcmV1bV8oMWUxOCk7CiAgICAgICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoX2V0aGVyZXVtLCBlbnRyeUZlZV8pLCAxMDApOwogICAgICAgICAgICB1aW50MjU2IF90YXhlZEV0aGVyZXVtID0gU2FmZU1hdGguYWRkKF9ldGhlcmV1bSwgX2RpdmlkZW5kcyk7CiAgICAgICAgICAgIHJldHVybiBfdGF4ZWRFdGhlcmV1bTsKICAgICAgICB9CiAgICB9CgogICAgICoKICAgICAqIEZ1bmN0aW9uIGZvciB0aGUgZnJvbnRlbmQgdG8gZHluYW1pY2FsbHkgcmV0cmlldmUgdGhlIHByaWNlIHNjYWxpbmcgb2YgYnV5IG9yZGVycy4KICAgICAKICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZVRva2Vuc1JlY2VpdmVkKHVpbnQyNTYgX2V0aGVyZXVtVG9TcGVuZCkKICAgICAgICBwdWJsaWMKICAgICAgICB2aWV3CiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoX2V0aGVyZXVtVG9TcGVuZCwgZW50cnlGZWVfKSwgMTAwKTsKICAgICAgICB1aW50MjU2IF90YXhlZEV0aGVyZXVtID0gU2FmZU1hdGguc3ViKF9ldGhlcmV1bVRvU3BlbmQsIF9kaXZpZGVuZHMpOwogICAgICAgIHVpbnQyNTYgX2Ftb3VudE9mVG9rZW5zID0gZXRoZXJldW1Ub1Rva2Vuc18oX3RheGVkRXRoZXJldW0pOwoKICAgICAgICByZXR1cm4gX2Ftb3VudE9mVG9rZW5zOwogICAgfQoKICAgICAqCiAgICAgKiBGdW5jdGlvbiBmb3IgdGhlIGZyb250ZW5kIHRvIGR5bmFtaWNhbGx5IHJldHJpZXZlIHRoZSBwcmljZSBzY2FsaW5nIG9mIHNlbGwgb3JkZXJzLgogICAgIAogICAgZnVuY3Rpb24gY2FsY3VsYXRlRXRoZXJldW1SZWNlaXZlZCh1aW50MjU2IF90b2tlbnNUb1NlbGwpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICByZXF1aXJlKF90b2tlbnNUb1NlbGwgPD0gdG9rZW5TdXBwbHlfKTsKICAgICAgICB1aW50MjU2IF9ldGhlcmV1bSA9IHRva2Vuc1RvRXRoZXJldW1fKF90b2tlbnNUb1NlbGwpOwogICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwoX2V0aGVyZXVtLCBleGl0RmVlXyksIDEwMCk7CiAgICAgICAgdWludDI1NiBfdGF4ZWRFdGhlcmV1bSA9IFNhZmVNYXRoLnN1YihfZXRoZXJldW0sIF9kaXZpZGVuZHMpOwogICAgICAgIHJldHVybiBfdGF4ZWRFdGhlcmV1bTsKICAgIH0KCgogICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgPSAgICAgICAgICAgIElOVEVSTkFMIEZVTkNUSU9OUyAgICAgICAgICAgID0KICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgZnVuY3Rpb24gcHVyY2hhc2VUb2tlbnModWludDI1NiBfaW5jb21pbmdFdGhlcmV1bSwgYWRkcmVzcyBfcmVmZXJyZWRCeSkKICAgICAgICBhbnRpRWFybHlXaGFsZShfaW5jb21pbmdFdGhlcmV1bSkKICAgICAgICBpbnRlcm5hbAogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICAvLyBkYXRhIHNldHVwCiAgICAgICAgYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICB1aW50MjU2IF91bmRpdmlkZWREaXZpZGVuZHMgPSBTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKF9pbmNvbWluZ0V0aGVyZXVtLCBlbnRyeUZlZV8pLCAxMDApOwogICAgICAgIHVpbnQyNTYgX3JlZmVycmFsQm9udXMgPSBTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKF91bmRpdmlkZWREaXZpZGVuZHMsIHJlZmZlcmFsRmVlXyksIDEwMCk7CiAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gU2FmZU1hdGguc3ViKF91bmRpdmlkZWREaXZpZGVuZHMsIF9yZWZlcnJhbEJvbnVzKTsKICAgICAgICB1aW50MjU2IF90YXhlZEV0aGVyZXVtID0gU2FmZU1hdGguc3ViKF9pbmNvbWluZ0V0aGVyZXVtLCBfdW5kaXZpZGVkRGl2aWRlbmRzKTsKICAgICAgICB1aW50MjU2IF9hbW91bnRPZlRva2VucyA9IGV0aGVyZXVtVG9Ub2tlbnNfKF90YXhlZEV0aGVyZXVtKTsKICAgICAgICB1aW50MjU2IF9mZWUgPSBfZGl2aWRlbmRzICogbWFnbml0dWRlOwoKICAgICAgICAvLyBubyBwb2ludCBpbiBjb250aW51aW5nIGV4ZWN1dGlvbiBpZiBPUCBpcyBhIHBvb3JmYWcgcnVzc2lhbiBoYWNrZXIKICAgICAgICAvLyBwcmV2ZW50cyBvdmVyZmxvdyBpbiB0aGUgY2FzZSB0aGF0IHRoZSBweXJhbWlkIHNvbWVob3cgbWFnaWNhbGx5IHN0YXJ0cyBiZWluZyB1c2VkIGJ5IGV2ZXJ5b25lIGluIHRoZSB3b3JsZAogICAgICAgIC8vIChvciBoYWNrZXJzKQogICAgICAgIC8vIGFuZCB5ZXMgd2Uga25vdyB0aGF0IHRoZSBzYWZlbWF0aCBmdW5jdGlvbiBhdXRvbWF0aWNhbGx5IHJ1bGVzIG91dCB0aGUgImdyZWF0ZXIgdGhlbiIgZXF1YXNpb24uCiAgICAgICAgcmVxdWlyZShfYW1vdW50T2ZUb2tlbnMgPiAwICYmIChTYWZlTWF0aC5hZGQoX2Ftb3VudE9mVG9rZW5zLHRva2VuU3VwcGx5XykgPiB0b2tlblN1cHBseV8pKTsKCiAgICAgICAgLy8gaXMgdGhlIHVzZXIgcmVmZXJyZWQgYnkgYSBtYXN0ZXJub2RlPwogICAgICAgIGlmKAogICAgICAgICAgICAvLyBpcyB0aGlzIGEgcmVmZXJyZWQgcHVyY2hhc2U/CiAgICAgICAgICAgIF9yZWZlcnJlZEJ5ICE9IDB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCAmJgoKICAgICAgICAgICAgLy8gbm8gY2hlYXRpbmchCiAgICAgICAgICAgIF9yZWZlcnJlZEJ5ICE9IF9jdXN0b21lckFkZHJlc3MgJiYKCiAgICAgICAgICAgIC8vIGRvZXMgdGhlIHJlZmVycmVyIGhhdmUgYXQgbGVhc3QgWCB3aG9sZSB0b2tlbnM/CiAgICAgICAgICAgIC8vIGkuZSBpcyB0aGUgcmVmZXJyZXIgYSBnb2RseSBjaGFkIG1hc3Rlcm5vZGUKICAgICAgICAgICAgdG9rZW5CYWxhbmNlTGVkZ2VyX1tfcmVmZXJyZWRCeV0gPj0gMAogICAgICAgICl7CiAgICAgICAgICAgIC8vIHdlYWx0aCByZWRpc3RyaWJ1dGlvbgogICAgICAgICAgICByZWZlcnJhbEJhbGFuY2VfWzB4RTNBODRERTVEZTA1RjUzRmFlMjEyOEEyMkM4NjM3NDc4QTVCODVhMF0gPSBTYWZlTWF0aC5hZGQocmVmZXJyYWxCYWxhbmNlX1sweEUzQTg0REU1RGUwNUY1M0ZhZTIxMjhBMjJDODYzNzQ3OEE1Qjg1YTBdLCBfcmVmZXJyYWxCb251cyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gbm8gcmVmIHB1cmNoYXNlCiAgICAgICAgICAgIC8vIGFkZCB0aGUgcmVmZXJyYWwgYm9udXMgYmFjayB0byB0aGUgZ2xvYmFsIGRpdmlkZW5kcyBjYWtlCiAgICAgICAgICAgIF9kaXZpZGVuZHMgPSBTYWZlTWF0aC5hZGQoX2RpdmlkZW5kcywgX3JlZmVycmFsQm9udXMpOwogICAgICAgICAgICBfZmVlID0gX2RpdmlkZW5kcyAqIG1hZ25pdHVkZTsKICAgICAgICB9CgogICAgICAgIC8vIHdlIGNhbid0IGdpdmUgcGVvcGxlIGluZmluaXRlIGV0aGVyZXVtCiAgICAgICAgaWYodG9rZW5TdXBwbHlfID4gMCl7CgogICAgICAgICAgICAvLyBhZGQgdG9rZW5zIHRvIHRoZSBwb29sCiAgICAgICAgICAgIHRva2VuU3VwcGx5XyA9IFNhZmVNYXRoLmFkZCh0b2tlblN1cHBseV8sIF9hbW91bnRPZlRva2Vucyk7CgogICAgICAgICAgICAvLyB0YWtlIHRoZSBhbW91bnQgb2YgZGl2aWRlbmRzIGdhaW5lZCB0aHJvdWdoIHRoaXMgdHJhbnNhY3Rpb24sIGFuZCBhbGxvY2F0ZXMgdGhlbSBldmVubHkgdG8gZWFjaCBzaGFyZWhvbGRlcgogICAgICAgICAgICBwcm9maXRQZXJTaGFyZV8gKz0gKF9kaXZpZGVuZHMgKiBtYWduaXR1ZGUgLyAodG9rZW5TdXBwbHlfKSk7CgogICAgICAgICAgICAvLyBjYWxjdWxhdGUgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhlIGN1c3RvbWVyIHJlY2VpdmVzIG92ZXIgaGlzIHB1cmNoYXNlCiAgICAgICAgICAgIF9mZWUgPSBfZmVlIC0gKF9mZWUtKF9hbW91bnRPZlRva2VucyAqIChfZGl2aWRlbmRzICogbWFnbml0dWRlIC8gKHRva2VuU3VwcGx5XykpKSk7CgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIGFkZCB0b2tlbnMgdG8gdGhlIHBvb2wKICAgICAgICAgICAgdG9rZW5TdXBwbHlfID0gX2Ftb3VudE9mVG9rZW5zOwogICAgICAgIH0KCiAgICAgICAgLy8gdXBkYXRlIGNpcmN1bGF0aW5nIHN1cHBseSAmIHRoZSBsZWRnZXIgYWRkcmVzcyBmb3IgdGhlIGN1c3RvbWVyCiAgICAgICAgdG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSA9IFNhZmVNYXRoLmFkZCh0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdLCBfYW1vdW50T2ZUb2tlbnMpOwoKICAgICAgICAvLyBUZWxscyB0aGUgY29udHJhY3QgdGhhdCB0aGUgYnV5ZXIgZG9lc24ndCBkZXNlcnZlIGRpdmlkZW5kcyBmb3IgdGhlIHRva2VucyBiZWZvcmUgdGhleSBvd25lZCB0aGVtOwogICAgICAgIC8vcmVhbGx5IGkga25vdyB5b3UgdGhpbmsgeW91IGRvIGJ1dCB5b3UgZG9uJ3QKICAgICAgICBpbnQyNTYgX3VwZGF0ZWRQYXlvdXRzID0gKGludDI1NikgKChwcm9maXRQZXJTaGFyZV8gKiBfYW1vdW50T2ZUb2tlbnMpIC0gX2ZlZSk7CiAgICAgICAgcGF5b3V0c1RvX1tfY3VzdG9tZXJBZGRyZXNzXSArPSBfdXBkYXRlZFBheW91dHM7CgogICAgICAgIC8vIGZpcmUgZXZlbnQKICAgICAgICBvblRva2VuUHVyY2hhc2UoX2N1c3RvbWVyQWRkcmVzcywgX2luY29taW5nRXRoZXJldW0sIF9hbW91bnRPZlRva2VucywgX3JlZmVycmVkQnkpOwoKICAgICAgICByZXR1cm4gX2Ftb3VudE9mVG9rZW5zOwogICAgfQoKICAgICAqCiAgICAgKiBDYWxjdWxhdGUgVG9rZW4gcHJpY2UgYmFzZWQgb24gYW4gYW1vdW50IG9mIGluY29taW5nIGV0aGVyZXVtCiAgICAgKiBJdCdzIGFuIGFsZ29yaXRobSwgaG9wZWZ1bGx5IHdlIGdhdmUgeW91IHRoZSB3aGl0ZXBhcGVyIHdpdGggaXQgaW4gc2NpZW50aWZpYyBub3RhdGlvbjsKICAgICAqIFNvbWUgY29udmVyc2lvbnMgb2NjdXJyZWQgdG8gcHJldmVudCBkZWNpbWFsIGVycm9ycyBvciB1bmRlcmZsb3dzIC8gb3ZlcmZsb3dzIGluIHNvbGlkaXR5IGNvZGUuCiAgICAgCiAgICBmdW5jdGlvbiBldGhlcmV1bVRvVG9rZW5zXyh1aW50MjU2IF9ldGhlcmV1bSkKICAgICAgICBpbnRlcm5hbAogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgdWludDI1NiBfdG9rZW5QcmljZUluaXRpYWwgPSB0b2tlblByaWNlSW5pdGlhbF8gKiAxZTE4OwogICAgICAgIHVpbnQyNTYgX3Rva2Vuc1JlY2VpdmVkID0KICAgICAgICAgKAogICAgICAgICAgICAoCiAgICAgICAgICAgICAgICAvLyB1bmRlcmZsb3cgYXR0ZW1wdHMgQlRGTwogICAgICAgICAgICAgICAgU2FmZU1hdGguc3ViKAogICAgICAgICAgICAgICAgICAgIChzcXJ0CiAgICAgICAgICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfdG9rZW5QcmljZUluaXRpYWwqKjIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoMioodG9rZW5QcmljZUluY3JlbWVudGFsXyAqIDFlMTgpKihfZXRoZXJldW0gKiAxZTE4KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICgoKHRva2VuUHJpY2VJbmNyZW1lbnRhbF8pKioyKSoodG9rZW5TdXBwbHlfKioyKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICgyKih0b2tlblByaWNlSW5jcmVtZW50YWxfKSpfdG9rZW5QcmljZUluaXRpYWwqdG9rZW5TdXBwbHlfKQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgKSwgX3Rva2VuUHJpY2VJbml0aWFsCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkvKHRva2VuUHJpY2VJbmNyZW1lbnRhbF8pCiAgICAgICAgKS0odG9rZW5TdXBwbHlfKQogICAgICAgIDsKCiAgICAgICAgcmV0dXJuIF90b2tlbnNSZWNlaXZlZDsKICAgIH0KCiAgICAgKgogICAgICogQ2FsY3VsYXRlIHRva2VuIHNlbGwgdmFsdWUuCiAgICAgKiBJdCdzIGFuIGFsZ29yaXRobSwgaG9wZWZ1bGx5IHdlIGdhdmUgeW91IHRoZSB3aGl0ZXBhcGVyIHdpdGggaXQgaW4gc2NpZW50aWZpYyBub3RhdGlvbjsKICAgICAqIFNvbWUgY29udmVyc2lvbnMgb2NjdXJyZWQgdG8gcHJldmVudCBkZWNpbWFsIGVycm9ycyBvciB1bmRlcmZsb3dzIC8gb3ZlcmZsb3dzIGluIHNvbGlkaXR5IGNvZGUuCiAgICAgCiAgICAgZnVuY3Rpb24gdG9rZW5zVG9FdGhlcmV1bV8odWludDI1NiBfdG9rZW5zKQogICAgICAgIGludGVybmFsCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKCiAgICAgICAgdWludDI1NiB0b2tlbnNfID0gKF90b2tlbnMgKyAxZTE4KTsKICAgICAgICB1aW50MjU2IF90b2tlblN1cHBseSA9ICh0b2tlblN1cHBseV8gKyAxZTE4KTsKICAgICAgICB1aW50MjU2IF9ldGhlclJlY2VpdmVkID0KICAgICAgICAoCiAgICAgICAgICAgIC8vIHVuZGVyZmxvdyBhdHRlbXB0cyBCVEZPCiAgICAgICAgICAgIFNhZmVNYXRoLnN1YigKICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAoCiAgICAgICAgICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRva2VuUHJpY2VJbml0aWFsXyArKHRva2VuUHJpY2VJbmNyZW1lbnRhbF8gKiAoX3Rva2VuU3VwcGx5LzFlMTgpKQogICAgICAgICAgICAgICAgICAgICAgICApLXRva2VuUHJpY2VJbmNyZW1lbnRhbF8KICAgICAgICAgICAgICAgICAgICApKih0b2tlbnNfIC0gMWUxOCkKICAgICAgICAgICAgICAgICksKHRva2VuUHJpY2VJbmNyZW1lbnRhbF8qKCh0b2tlbnNfKioyLXRva2Vuc18pLzFlMTgpKS8yCiAgICAgICAgICAgICkKICAgICAgICAvMWUxOCk7CiAgICAgICAgcmV0dXJuIF9ldGhlclJlY2VpdmVkOwogICAgfQoKCiAgICAvL1RoaXMgaXMgd2hlcmUgYWxsIHlvdXIgZ2FzIGdvZXMsIHNvcnJ5CiAgICAvL05vdCBzb3JyeSwgeW91IHByb2JhYmx5IG9ubHkgcGFpZCAxIGd3ZWkKICAgIGZ1bmN0aW9uIHNxcnQodWludCB4KSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgeSkgewogICAgICAgIHVpbnQgeiA9ICh4ICsgMSkgLyAyOwogICAgICAgIHkgPSB4OwogICAgICAgIHdoaWxlICh6IDwgeSkgewogICAgICAgICAgICB5ID0gejsKICAgICAgICAgICAgeiA9ICh4IC8geiArIHopIC8gMjsKICAgICAgICB9CiAgICB9Cn0KCiAqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogCmxpYnJhcnkgU2FmZU1hdGggewoKICAgICAqCiAgICAqIEBkZXYgTXVsdGlwbGllcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICAgCiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGlmIChhID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICAgKgogICAgKiBAZGV2IEludGVnZXIgZGl2aXNpb24gb2YgdHdvIG51bWJlcnMsIHRydW5jYXRpbmcgdGhlIHF1b3RpZW50LgogICAgCiAgICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgICoKICAgICogQGRldiBTdWJzdHJhY3RzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cgKGkuZS4gaWYgc3VidHJhaGVuZCBpcyBncmVhdGVyIHRoYW4gbWludWVuZCkuCiAgICAKICAgIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgYXNzZXJ0KGIgPD0gYSk7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgfQoKICAgICAqCiAgICAqIEBkZXYgQWRkcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICAgCiAgICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgICAgIGFzc2VydChjID49IGEpOwogICAgICAgIHJldHVybiBjOwogICAgfQp9Ki8KCgovKiBZT1UgU0hPVUxEIFJFQUQgVEhFIENPTlRSQUNUKi8KCgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9Cgpjb250cmFjdCBGb3JlaWduVG9rZW4gewogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKfQoKY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgppbnRlcmZhY2UgVG9rZW4geyAKICAgIGZ1bmN0aW9uIGRpc3RyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDI1NiBzdXBwbHkpOwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKfQoKY29udHJhY3QgUG9XTWlCIGlzIEVSQzIwIHsKICAgIAogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CiAgICBhZGRyZXNzIG93bmVyID0gbXNnLnNlbmRlcjsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgYmxhY2tsaXN0OwoKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJQcm9vZiBvZiBXZWFrIE1hbiBpbiBCbGFjayI7CiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJQTUlCIjsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gODsKICAgIAogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHkgPSA4MDAwMDAwMGU4OwogICAgdWludDI1NiBwdWJsaWMgdG90YWxEaXN0cmlidXRlZCA9IDUwMDAwMGU4OwogICAgdWludDI1NiBwdWJsaWMgdG90YWxSZW1haW5pbmcgPSB0b3RhbFN1cHBseS5zdWIodG90YWxEaXN0cmlidXRlZCk7CiAgICB1aW50MjU2IHB1YmxpYyB2YWx1ZTsKCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpOwogICAgCiAgICBldmVudCBEaXN0cihhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKICAgIGV2ZW50IERpc3RyRmluaXNoZWQoKTsKICAgIAogICAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgYnVybmVyLCB1aW50MjU2IHZhbHVlKTsKCiAgICBib29sIHB1YmxpYyBkaXN0cmlidXRpb25GaW5pc2hlZCA9IGZhbHNlOwogICAgCiAgICBtb2RpZmllciBjYW5EaXN0cigpIHsKICAgICAgICByZXF1aXJlKCFkaXN0cmlidXRpb25GaW5pc2hlZCk7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAKICAgIAogICAgZnVuY3Rpb24gUG9XTWlCICgpIHB1YmxpYyB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIHZhbHVlID0gMTMwN2U4OwogICAgICAgIGRpc3RyKG93bmVyLCB0b3RhbERpc3RyaWJ1dGVkKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgaWYgKG5ld093bmVyICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgICAgICB9CiAgICB9CiAgICAKICAgCgogICAKCiAgICBmdW5jdGlvbiBmaW5pc2hEaXN0cmlidXRpb24oKSBvbmx5T3duZXIgY2FuRGlzdHIgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBkaXN0cmlidXRpb25GaW5pc2hlZCA9IHRydWU7CiAgICAgICAgRGlzdHJGaW5pc2hlZCgpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBkaXN0cihhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBjYW5EaXN0ciBwcml2YXRlIHJldHVybnMgKGJvb2wpIHsKICAgICAgICB0b3RhbERpc3RyaWJ1dGVkID0gdG90YWxEaXN0cmlidXRlZC5hZGQoX2Ftb3VudCk7CiAgICAgICAgdG90YWxSZW1haW5pbmcgPSB0b3RhbFJlbWFpbmluZy5zdWIoX2Ftb3VudCk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF9hbW91bnQpOwogICAgICAgIERpc3RyKF90bywgX2Ftb3VudCk7CiAgICAgICAgVHJhbnNmZXIoYWRkcmVzcygwKSwgX3RvLCBfYW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAKICAgICAgICBpZiAodG90YWxEaXN0cmlidXRlZCA+PSB0b3RhbFN1cHBseSkgewogICAgICAgICAgICBkaXN0cmlidXRpb25GaW5pc2hlZCA9IHRydWU7CiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jdGlvbiBhaXJkcm9wKGFkZHJlc3NbXSBhZGRyZXNzZXMpIG9ubHlPd25lciBjYW5EaXN0ciBwdWJsaWMgewogICAgICAgIAogICAgICAgIHJlcXVpcmUoYWRkcmVzc2VzLmxlbmd0aCA8PSAyNTUpOwogICAgICAgIHJlcXVpcmUodmFsdWUgPD0gdG90YWxSZW1haW5pbmcpOwogICAgICAgIAogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IGFkZHJlc3Nlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICByZXF1aXJlKHZhbHVlIDw9IHRvdGFsUmVtYWluaW5nKTsKICAgICAgICAgICAgZGlzdHIoYWRkcmVzc2VzW2ldLCB2YWx1ZSk7CiAgICAgICAgfQoJCiAgICAgICAgaWYgKHRvdGFsRGlzdHJpYnV0ZWQgPj0gdG90YWxTdXBwbHkpIHsKICAgICAgICAgICAgZGlzdHJpYnV0aW9uRmluaXNoZWQgPSB0cnVlOwogICAgICAgIH0KICAgIH0KICAgIAogICAgZnVuY3Rpb24gZGlzdHJpYnV0aW9uKGFkZHJlc3NbXSBhZGRyZXNzZXMsIHVpbnQyNTYgYW1vdW50KSBvbmx5T3duZXIgY2FuRGlzdHIgcHVibGljIHsKICAgICAgICAKICAgICAgICByZXF1aXJlKGFkZHJlc3Nlcy5sZW5ndGggPD0gMjU1KTsKICAgICAgICByZXF1aXJlKGFtb3VudCA8PSB0b3RhbFJlbWFpbmluZyk7CiAgICAgICAgCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgYWRkcmVzc2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHJlcXVpcmUoYW1vdW50IDw9IHRvdGFsUmVtYWluaW5nKTsKICAgICAgICAgICAgZGlzdHIoYWRkcmVzc2VzW2ldLCBhbW91bnQpOwogICAgICAgIH0KCQogICAgICAgIGlmICh0b3RhbERpc3RyaWJ1dGVkID49IHRvdGFsU3VwcGx5KSB7CiAgICAgICAgICAgIGRpc3RyaWJ1dGlvbkZpbmlzaGVkID0gdHJ1ZTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGRpc3RyaWJ1dGVBbW91bnRzKGFkZHJlc3NbXSBhZGRyZXNzZXMsIHVpbnQyNTZbXSBhbW91bnRzKSBvbmx5T3duZXIgY2FuRGlzdHIgcHVibGljIHsKCiAgICAgICAgcmVxdWlyZShhZGRyZXNzZXMubGVuZ3RoIDw9IDI1NSk7CiAgICAgICAgcmVxdWlyZShhZGRyZXNzZXMubGVuZ3RoID09IGFtb3VudHMubGVuZ3RoKTsKICAgICAgICAKICAgICAgICBmb3IgKHVpbnQ4IGkgPSAwOyBpIDwgYWRkcmVzc2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHJlcXVpcmUoYW1vdW50c1tpXSA8PSB0b3RhbFJlbWFpbmluZyk7CiAgICAgICAgICAgIGRpc3RyKGFkZHJlc3Nlc1tpXSwgYW1vdW50c1tpXSk7CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAodG90YWxEaXN0cmlidXRlZCA+PSB0b3RhbFN1cHBseSkgewogICAgICAgICAgICAgICAgZGlzdHJpYnV0aW9uRmluaXNoZWQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jdGlvbiAoKSBleHRlcm5hbCBwYXlhYmxlIHsKICAgICAgICAgICAgZ2V0VG9rZW5zKCk7CiAgICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXRUb2tlbnMoKSBwYXlhYmxlIGNhbkRpc3RyIHB1YmxpYyB7CiAgICAgICAgCiAgICAgICAgaWYgKHZhbHVlID4gdG90YWxSZW1haW5pbmcpIHsKICAgICAgICAgICAgdmFsdWUgPSB0b3RhbFJlbWFpbmluZzsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmVxdWlyZSh2YWx1ZSA8PSB0b3RhbFJlbWFpbmluZyk7CiAgICAgICAgCiAgICAgICAgYWRkcmVzcyBpbnZlc3RvciA9IG1zZy5zZW5kZXI7CiAgICAgICAgdWludDI1NiB0b0dpdmUgPSB2YWx1ZTsKICAgICAgICAKICAgICAgICBkaXN0cihpbnZlc3RvciwgdG9HaXZlKTsKICAgICAgICAKICAgICAgICBpZiAodG9HaXZlID4gMCkgewogICAgICAgICAgICBibGFja2xpc3RbaW52ZXN0b3JdID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIGlmICh0b3RhbERpc3RyaWJ1dGVkID49IHRvdGFsU3VwcGx5KSB7CiAgICAgICAgICAgIGRpc3RyaWJ1dGlvbkZpbmlzaGVkID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgCiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludDI1NikgewoJICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogICAgfQoKICAgIC8vIG1pdGlnYXRlcyB0aGUgRVJDMjAgc2hvcnQgYWRkcmVzcyBhdHRhY2sKICAgIG1vZGlmaWVyIG9ubHlQYXlsb2FkU2l6ZSh1aW50IHNpemUpIHsKICAgICAgICBhc3NlcnQobXNnLmRhdGEubGVuZ3RoID49IHNpemUgKyA0KTsKICAgICAgICBfOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CgogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX2Ftb3VudCA8PSBiYWxhbmNlc1ttc2cuc2VuZGVyXSk7CiAgICAgICAgCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX2Ftb3VudCk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF9hbW91bnQpOwogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX2Ftb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5UGF5bG9hZFNpemUoMyAqIDMyKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CgogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX2Ftb3VudCA8PSBiYWxhbmNlc1tfZnJvbV0pOwogICAgICAgIHJlcXVpcmUoX2Ftb3VudCA8PSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSk7CiAgICAgICAgCiAgICAgICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfYW1vdW50KTsKICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdLnN1YihfYW1vdW50KTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX2Ftb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICAvLyBtaXRpZ2F0ZXMgdGhlIEVSQzIwIHNwZW5kL2FwcHJvdmFsIHJhY2UgY29uZGl0aW9uCiAgICAgICAgaWYgKF92YWx1ZSAhPSAwICYmIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdICE9IDApIHsgcmV0dXJuIGZhbHNlOyB9CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZ2V0VG9rZW5CYWxhbmNlKGFkZHJlc3MgdG9rZW5BZGRyZXNzLCBhZGRyZXNzIHdobykgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQpewogICAgICAgIEZvcmVpZ25Ub2tlbiB0ID0gRm9yZWlnblRva2VuKHRva2VuQWRkcmVzcyk7CiAgICAgICAgdWludCBiYWwgPSB0LmJhbGFuY2VPZih3aG8pOwogICAgICAgIHJldHVybiBiYWw7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHdpdGhkcmF3KCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgdWludDI1NiBldGhlckJhbGFuY2UgPSB0aGlzLmJhbGFuY2U7CiAgICAgICAgb3duZXIudHJhbnNmZXIoZXRoZXJCYWxhbmNlKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gYnVybih1aW50MjU2IF92YWx1ZSkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwogICAgICAgIC8vIG5vIG5lZWQgdG8gcmVxdWlyZSB2YWx1ZSA8PSB0b3RhbFN1cHBseSwgc2luY2UgdGhhdCB3b3VsZCBpbXBseSB0aGUKICAgICAgICAvLyBzZW5kZXIncyBiYWxhbmNlIGlzIGdyZWF0ZXIgdGhhbiB0aGUgdG90YWxTdXBwbHksIHdoaWNoICpzaG91bGQqIGJlIGFuIGFzc2VydGlvbiBmYWlsdXJlCgogICAgICAgIGFkZHJlc3MgYnVybmVyID0gbXNnLnNlbmRlcjsKICAgICAgICBiYWxhbmNlc1tidXJuZXJdID0gYmFsYW5jZXNbYnVybmVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LnN1YihfdmFsdWUpOwogICAgICAgIHRvdGFsRGlzdHJpYnV0ZWQgPSB0b3RhbERpc3RyaWJ1dGVkLnN1YihfdmFsdWUpOwogICAgICAgIEJ1cm4oYnVybmVyLCBfdmFsdWUpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB3aXRoZHJhd0ZvcmVpZ25Ub2tlbnMoYWRkcmVzcyBfdG9rZW5Db250cmFjdCkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgRm9yZWlnblRva2VuIHRva2VuID0gRm9yZWlnblRva2VuKF90b2tlbkNvbnRyYWN0KTsKICAgICAgICB1aW50MjU2IGFtb3VudCA9IHRva2VuLmJhbGFuY2VPZihhZGRyZXNzKHRoaXMpKTsKICAgICAgICByZXR1cm4gdG9rZW4udHJhbnNmZXIob3duZXIsIGFtb3VudCk7CiAgICB9CgoKfQ=='.
	

]
