Class {
	#name : #SRT8fea6eb21213f311e1316330533d12d28a3b6e67,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT8fea6eb21213f311e1316330533d12d28a3b6e67 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKGEgPT0gMCkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9CgovKioKICogQHRpdGxlIFBhdXNhYmxlCiAqIEBkZXYgQmFzZSBjb250cmFjdCB3aGljaCBhbGxvd3MgY2hpbGRyZW4gdG8gaW1wbGVtZW50IGFuIGVtZXJnZW5jeSBzdG9wIG1lY2hhbmlzbS4KICovCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgewogIGV2ZW50IFBhdXNlKCk7CiAgZXZlbnQgVW5wYXVzZSgpOwoKICBib29sIHB1YmxpYyBwYXVzZWQgPSBmYWxzZTsKCgogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgbm90IHBhdXNlZC4KICAgKi8KICBtb2RpZmllciB3aGVuTm90UGF1c2VkKCkgewogICAgcmVxdWlyZSghcGF1c2VkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIHBhdXNlZC4KICAgKi8KICBtb2RpZmllciB3aGVuUGF1c2VkKCkgewogICAgcmVxdWlyZShwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byBwYXVzZSwgdHJpZ2dlcnMgc3RvcHBlZCBzdGF0ZQogICAqLwogIGZ1bmN0aW9uIHBhdXNlKCkgb25seU93bmVyIHdoZW5Ob3RQYXVzZWQgcHVibGljIHsKICAgIHBhdXNlZCA9IHRydWU7CiAgICBQYXVzZSgpOwogIH0KCiAgLyoqCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHVucGF1c2UsIHJldHVybnMgdG8gbm9ybWFsIHN0YXRlCiAgICovCiAgZnVuY3Rpb24gdW5wYXVzZSgpIG9ubHlPd25lciB3aGVuUGF1c2VkIHB1YmxpYyB7CiAgICBwYXVzZWQgPSBmYWxzZTsKICAgIFVucGF1c2UoKTsKICB9Cn0KCi8qKioqKgogICAgKiBPcmdpbmFsbHkgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5CiAgICAqIE1vZGlmaWVkIGJ5IGh0dHBzOi8vZ2l0aHViLmNvbS9hZ2Fyd2FsYWthcnNoCiAgICAqLwppbnRlcmZhY2UgdG9rZW5SZWNpcGllbnQgeyBmdW5jdGlvbiByZWNlaXZlQXBwcm92YWwoYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdmFsdWUsIGFkZHJlc3MgX3Rva2VuLCBieXRlcyBfZXh0cmFEYXRhKSBwdWJsaWM7IH0KLyoqKioqCiAgICAqIEB0aXRsZSBCYXNpYyBUb2tlbgogICAgKiBAZGV2IEJhc2ljIFZlcnNpb24gb2YgYSBHZW5lcmljIFRva2VuCiAgICAqLwpjb250cmFjdCBFUkMyMEJhc2ljVG9rZW4gaXMgUGF1c2FibGV7CiAgICAvLyAxOCBkZWNpbWFscyBpcyB0aGUgc3Ryb25nbHkgc3VnZ2VzdGVkIGRlZmF1bHQsIGF2b2lkIGNoYW5naW5nIGl0CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgICAvLyBUaGlzIGNyZWF0ZXMgYW4gYXJyYXkgd2l0aCBhbGwgYmFsYW5jZXMKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGJhbGFuY2VzOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBwdWJsaWMgYWxsb3dhbmNlOwoKICAgIC8vIFRoaXMgZ2VuZXJhdGVzIGEgcHVibGljIGV2ZW50IG9uIHRoZSBibG9ja2NoYWluIHRoYXQgd2lsbCBub3RpZnkgY2xpZW50cwogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7CgogICAgLy8gVGhpcyBub3RpZmllcyBjbGllbnRzIGFib3V0IHRoZSBhbW91bnQgYnVybnQKICAgIGV2ZW50IEJ1cm4oYWRkcmVzcyBpbmRleGVkIGZyb20sIHVpbnQyNTYgdmFsdWUpOwoKICAgIC8vRml4IGZvciB0aGUgRVJDMjAgc2hvcnQgYWRkcmVzcyBhdHRhY2suCiAgICBtb2RpZmllciBvbmx5UGF5bG9hZFNpemUodWludCBzaXplKSB7CiAgICAgICAgcmVxdWlyZShtc2cuZGF0YS5sZW5ndGggPj0gc2l6ZSArIDQpIDsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICogSW50ZXJuYWwgdHJhbnNmZXIsIG9ubHkgY2FuIGJlIGNhbGxlZCBieSB0aGlzIGNvbnRyYWN0CiAgICAgKi8KICAgIGZ1bmN0aW9uIF90cmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIHdoZW5Ob3RQYXVzZWQgaW50ZXJuYWwgewogICAgICAgIC8vIFByZXZlbnQgdHJhbnNmZXIgdG8gMHgwIGFkZHJlc3MuIFVzZSBidXJuKCkgaW5zdGVhZAogICAgICAgIHJlcXVpcmUoX3RvICE9IDB4MCk7CiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHNlbmRlciBoYXMgZW5vdWdoCiAgICAgICAgcmVxdWlyZShiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlKTsKICAgICAgICAvLyBDaGVjayBmb3Igb3ZlcmZsb3dzCiAgICAgICAgcmVxdWlyZShiYWxhbmNlc1tfdG9dICsgX3ZhbHVlID4gYmFsYW5jZXNbX3RvXSk7CiAgICAgICAgLy8gU2F2ZSB0aGlzIGZvciBhbiBhc3NlcnRpb24gaW4gdGhlIGZ1dHVyZQogICAgICAgIHVpbnQgcHJldmlvdXNCYWxhbmNlcyA9IGJhbGFuY2VzW19mcm9tXSArIGJhbGFuY2VzW190b107CiAgICAgICAgLy8gU3VidHJhY3QgZnJvbSB0aGUgc2VuZGVyCiAgICAgICAgYmFsYW5jZXNbX2Zyb21dIC09IF92YWx1ZTsKICAgICAgICAvLyBBZGQgdGhlIHNhbWUgdG8gdGhlIHJlY2lwaWVudAogICAgICAgIGJhbGFuY2VzW190b10gKz0gX3ZhbHVlOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgLy8gQXNzZXJ0cyBhcmUgdXNlZCB0byB1c2Ugc3RhdGljIGFuYWx5c2lzIHRvIGZpbmQgYnVncyBpbiB5b3VyIGNvZGUuIFRoZXkgc2hvdWxkIG5ldmVyIGZhaWwKICAgICAgICBhc3NlcnQoYmFsYW5jZXNbX2Zyb21dICsgYmFsYW5jZXNbX3RvXSA9PSBwcmV2aW91c0JhbGFuY2VzKTsKICAgIH0KCgogICAgLyoqCiAgICAgKiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvdGhlciBhZGRyZXNzCiAgICAgKgogICAgICogU2VuZCBgX3ZhbHVlYCB0b2tlbnMgdG8gYF90b2AgaW4gYmVoYWxmIG9mIGBfZnJvbWAKICAgICAqCiAgICAgKiBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3Mgb2YgdGhlIHNlbmRlcgogICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICAgKiBAcGFyYW0gX3ZhbHVlIHRoZSBhbW91bnQgdG8gc2VuZAogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSB3aGVuTm90UGF1c2VkIG9ubHlQYXlsb2FkU2l6ZSgyICogMzIpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdKTsgICAgIC8vIENoZWNrIGFsbG93YW5jZQogICAgICAgIGFsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOwogICAgICAgIF90cmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogVHJhbnNmZXIgdG9rZW5zCiAgICAgKgogICAgICogU2VuZCBgX3ZhbHVlYCB0b2tlbnMgdG8gYF90b2AgZnJvbSB5b3VyIGFjY291bnQKICAgICAqCiAgICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQKICAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIGFtb3VudCB0byBzZW5kCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgd2hlbk5vdFBhdXNlZCBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSBwdWJsaWMgewogICAgICAgIF90cmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAbm90aWNlIENyZWF0ZSBgbWludGVkQW1vdW50YCB0b2tlbnMgYW5kIHNlbmQgaXQgdG8gYHRhcmdldGAKICAgICAqIEBwYXJhbSB0YXJnZXQgQWRkcmVzcyB0byByZWNlaXZlIHRoZSB0b2tlbnMKICAgICAqIEBwYXJhbSBtaW50ZWRBbW91bnQgdGhlIGFtb3VudCBvZiB0b2tlbnMgaXQgd2lsbCByZWNlaXZlCiAgICAgKi8KICAgIGZ1bmN0aW9uIG1pbnRUb2tlbihhZGRyZXNzIHRhcmdldCwgdWludDI1NiBtaW50ZWRBbW91bnQpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGJhbGFuY2VzW3RhcmdldF0gKz0gbWludGVkQW1vdW50OwogICAgICAgIHRvdGFsU3VwcGx5ICs9IG1pbnRlZEFtb3VudDsKICAgICAgICBUcmFuc2ZlcigwLCB0aGlzLCBtaW50ZWRBbW91bnQpOwogICAgICAgIFRyYW5zZmVyKHRoaXMsIHRhcmdldCwgbWludGVkQW1vdW50KTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCBhbGxvd2FuY2UgZm9yIG90aGVyIGFkZHJlc3MKICAgICAqCiAgICAgKiBBbGxvd3MgYF9zcGVuZGVyYCB0byBzcGVuZCBubyBtb3JlIHRoYW4gYF92YWx1ZWAgdG9rZW5zIGluIHlvdXIgYmVoYWxmCiAgICAgKgogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIGF1dGhvcml6ZWQgdG8gc3BlbmQKICAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIG1heCBhbW91bnQgdGhleSBjYW4gc3BlbmQKICAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgYWxsb3dhbmNlW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCBhbGxvd2FuY2UgZm9yIG90aGVyIGFkZHJlc3MgYW5kIG5vdGlmeQogICAgICoKICAgICAqIEFsbG93cyBgX3NwZW5kZXJgIHRvIHNwZW5kIG5vIG1vcmUgdGhhbiBgX3ZhbHVlYCB0b2tlbnMgaW4geW91ciBiZWhhbGYsIGFuZCB0aGVuIHBpbmcgdGhlIGNvbnRyYWN0IGFib3V0IGl0CiAgICAgKgogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIGF1dGhvcml6ZWQgdG8gc3BlbmQKICAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIG1heCBhbW91bnQgdGhleSBjYW4gc3BlbmQKICAgICAqIEBwYXJhbSBfZXh0cmFEYXRhIHNvbWUgZXh0cmEgaW5mb3JtYXRpb24gdG8gc2VuZCB0byB0aGUgYXBwcm92ZWQgY29udHJhY3QKICAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZUFuZENhbGwoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9leHRyYURhdGEpCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgdG9rZW5SZWNpcGllbnQgc3BlbmRlciA9IHRva2VuUmVjaXBpZW50KF9zcGVuZGVyKTsKICAgICAgICBpZiAoYXBwcm92ZShfc3BlbmRlciwgX3ZhbHVlKSkgewogICAgICAgICAgICBzcGVuZGVyLnJlY2VpdmVBcHByb3ZhbChtc2cuc2VuZGVyLCBfdmFsdWUsIHRoaXMsIF9leHRyYURhdGEpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBEZXN0cm95IHRva2VucwogICAgICoKICAgICAqIFJlbW92ZSBgX3ZhbHVlYCB0b2tlbnMgZnJvbSB0aGUgc3lzdGVtIGlycmV2ZXJzaWJseQogICAgICoKICAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIGFtb3VudCBvZiBtb25leSB0byBidXJuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJ1cm4odWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXF1aXJlKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IF92YWx1ZSk7ICAgLy8gQ2hlY2sgaWYgdGhlIHNlbmRlciBoYXMgZW5vdWdoCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOyAgICAgICAgICAgIC8vIFN1YnRyYWN0IGZyb20gdGhlIHNlbmRlcgogICAgICAgIHRvdGFsU3VwcGx5IC09IF92YWx1ZTsgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlcyB0b3RhbFN1cHBseQogICAgICAgIEJ1cm4obXNnLnNlbmRlciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIERlc3Ryb3kgdG9rZW5zIGZyb20gb3RoZXIgYWNjb3VudAogICAgICoKICAgICAqIFJlbW92ZSBgX3ZhbHVlYCB0b2tlbnMgZnJvbSB0aGUgc3lzdGVtIGlycmV2ZXJzaWJseSBvbiBiZWhhbGYgb2YgYF9mcm9tYC4KICAgICAqCiAgICAgKiBAcGFyYW0gX2Zyb20gdGhlIGFkZHJlc3Mgb2YgdGhlIHNlbmRlcgogICAgICogQHBhcmFtIF92YWx1ZSB0aGUgYW1vdW50IG9mIG1vbmV5IHRvIGJ1cm4KICAgICAqLwogICAgZnVuY3Rpb24gYnVybkZyb20oYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXF1aXJlKGJhbGFuY2VzW19mcm9tXSA+PSBfdmFsdWUpOyAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgdGFyZ2V0ZWQgYmFsYW5jZSBpcyBlbm91Z2gKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdKTsgICAgLy8gQ2hlY2sgYWxsb3dhbmNlCiAgICAgICAgYmFsYW5jZXNbX2Zyb21dIC09IF92YWx1ZTsgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3VidHJhY3QgZnJvbSB0aGUgdGFyZ2V0ZWQgYmFsYW5jZQogICAgICAgIGFsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOyAgICAgICAgICAgICAvLyBTdWJ0cmFjdCBmcm9tIHRoZSBzZW5kZXIncyBhbGxvd2FuY2UKICAgICAgICB0b3RhbFN1cHBseSAtPSBfdmFsdWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRvdGFsU3VwcGx5CiAgICAgICAgQnVybihfZnJvbSwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAJICogUmV0dXJuIGJhbGFuY2Ugb2YgYW4gYWNjb3VudAogICAgICogQHBhcmFtIF9vd25lciB0aGUgYWRkcmVzcyB0byBnZXQgYmFsYW5jZQogIAkgKi8KICAJZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKSB7CiAgCQlyZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAJfQoKICAgIC8qKgogIAkgKiBSZXR1cm4gYWxsb3dhbmNlIGZvciBvdGhlciBhZGRyZXNzCiAgICAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHNwZW5kIHRvIHRoZSBvdGhlcgogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIGF1dGhvcml6ZWQgdG8gc3BlbmQKICAJICovCiAgCWZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcmVtYWluaW5nKSB7CiAgCQlyZXR1cm4gYWxsb3dhbmNlW19vd25lcl1bX3NwZW5kZXJdOwogIAl9Cn0KCmNvbnRyYWN0IEpXQ1Rva2VuIGlzIEVSQzIwQmFzaWNUb2tlbiB7Cgl1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCglzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgICAgICA9ICJKV0MiOyAvL3Rva2VucyBuYW1lCglzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCAgICA9ICJKV0MiOyAvL3Rva2VuIHN5bWJvbAoJdWludDI1NiBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsgICAgLy90b2tlbiBkZWNpbWFsCglzdHJpbmcgcHVibGljIGNvbnN0YW50IHZlcnNpb24gICA9ICIxLjAiOyAvL3Rva2VucyB2ZXJzaW9uCgoJdWludDI1NiBwdWJsaWMgdG9rZW5QcmVTYWxlICAgICAgICAgPSAxMDAwMDAwMDAgKiAxMCoqZGVjaW1hbHM7Ly90b2tlbnMgZm9yIHByZS1zYWxlCgl1aW50MjU2IHB1YmxpYyB0b2tlblB1YmxpY1NhbGUgICAgICA9IDQwMDAwMDAwMCAqIDEwKipkZWNpbWFsczsvL3Rva2VucyBmb3IgcHVibGljLXNhbGUKCXVpbnQyNTYgcHVibGljIHRva2VuUmVzZXJ2ZSAgICAgICAgID0gMzAwMDAwMDAwICogMTAqKmRlY2ltYWxzOy8vdG9rZW5zIGZvciByZXNlcnZlCgl1aW50MjU2IHB1YmxpYyB0b2tlblRlYW1TdXBwb3J0ZXIgICA9IDEyMDAwMDAwMCAqIDEwKipkZWNpbWFsczsvL3Rva2VucyBmb3IgVGVhbSAmIFN1cHBvcnRlcgoJdWludDI1NiBwdWJsaWMgdG9rZW5BZHZpc29yUGFydG5lcnMgPSA4MDAwMDAwMCAgKiAxMCoqZGVjaW1hbHM7Ly90b2tlbnMgZm9yIEFkdmlzb3IKCglhZGRyZXNzIHB1YmxpYyBpY29Db250cmFjdDsKCgkvLyBjb25zdHJ1Y3RvcgoJZnVuY3Rpb24gSldDVG9rZW4oKSBwdWJsaWMgewoJCXRvdGFsU3VwcGx5ID0gdG9rZW5QcmVTYWxlICsgdG9rZW5QdWJsaWNTYWxlICsgdG9rZW5SZXNlcnZlICsgdG9rZW5UZWFtU3VwcG9ydGVyICsgdG9rZW5BZHZpc29yUGFydG5lcnM7Cgl9CgoJLyoqCgkgKiBTZXQgSUNPIENvbnRyYWN0IGZvciB0aGlzIHRva2VuIHRvIG1ha2Ugc3VyZSBjYWxsZWQgYnkgb3VyIElDTyBjb250cmFjdAoJICogQHBhcmFtIF9pY29Db250cmFjdCAtIElDTyBDb250cmFjdCBhZGRyZXNzCgkgKi8KCWZ1bmN0aW9uIHNldEljb0NvbnRyYWN0KGFkZHJlc3MgX2ljb0NvbnRyYWN0KSBwdWJsaWMgb25seU93bmVyIHsKCQlpZiAoX2ljb0NvbnRyYWN0ICE9IGFkZHJlc3MoMCkpIHsKCQkJaWNvQ29udHJhY3QgPSBfaWNvQ29udHJhY3Q7CgkJfQoJfQoKCS8qKgoJICogU2VsbCB0b2tlbnMgd2hlbiBJQ08uIE9ubHkgY2FsbGVkIGJ5IElDTyBDb250cmFjdAoJICogQHBhcmFtIF9yZWNpcGllbnQgLSBhZGRyZXNzIHNlbmQgRVRIIHRvIGJ1eSB0b2tlbnMKCSAqIEBwYXJhbSBfdmFsdWUgLSBhbW91bnQgb2YgdG9rZW5zCgkgKi8KCWZ1bmN0aW9uIHNlbGwoYWRkcmVzcyBfcmVjaXBpZW50LCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CgkJYXNzZXJ0KF92YWx1ZSA+IDApOwoJCXJlcXVpcmUobXNnLnNlbmRlciA9PSBpY29Db250cmFjdCk7CgoJCWJhbGFuY2VzW19yZWNpcGllbnRdID0gYmFsYW5jZXNbX3JlY2lwaWVudF0uYWRkKF92YWx1ZSk7CgoJCVRyYW5zZmVyKDB4MCwgX3JlY2lwaWVudCwgX3ZhbHVlKTsKCQlyZXR1cm4gdHJ1ZTsKCX0KCgkvKioKCSAqIFNlbGwgdG9rZW5zIHdoZW4gd2UgZG9uJ3QgaGF2ZSBlbm91Z2ggdG9rZW4gaW4gUHJlU2FsZS4gT25seSBjYWxsZWQgYnkgSUNPIENvbnRyYWN0CgkgKiBAcGFyYW0gX3JlY2lwaWVudCAtIGFkZHJlc3Mgc2VuZCBFVEggdG8gYnV5IHRva2VucwoJICogQHBhcmFtIF92YWx1ZSAtIGFtb3VudCBvZiB0b2tlbnMKCSAqLwoJZnVuY3Rpb24gc2VsbFNwZWNpYWxUb2tlbnNGb3JQcmVTYWxlKGFkZHJlc3MgX3JlY2lwaWVudCwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewoJCWFzc2VydChfdmFsdWUgPiAwKTsKCQlyZXF1aXJlKG1zZy5zZW5kZXIgPT0gaWNvQ29udHJhY3QpOwoKCQliYWxhbmNlc1tfcmVjaXBpZW50XSA9IGJhbGFuY2VzW19yZWNpcGllbnRdLmFkZChfdmFsdWUpOwoJCXRva2VuUHJlU2FsZSA9IHRva2VuUHJlU2FsZS5hZGQoX3ZhbHVlKTsKCQl0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfdmFsdWUpOwoKCQlUcmFuc2ZlcigweDAsIF9yZWNpcGllbnQsIF92YWx1ZSk7CgkJcmV0dXJuIHRydWU7Cgl9CgoJLyoqCgkgKiBTZWxsIHRva2VucyB3aGVuIHdlIGRvbid0IGhhdmUgZW5vdWdoIHRva2VuIGluIFB1YmxpY1NhbGUuIE9ubHkgY2FsbGVkIGJ5IElDTyBDb250cmFjdAoJICogQHBhcmFtIF9yZWNpcGllbnQgLSBhZGRyZXNzIHNlbmQgRVRIIHRvIGJ1eSB0b2tlbnMKCSAqIEBwYXJhbSBfdmFsdWUgLSBhbW91bnQgb2YgdG9rZW5zCgkgKi8KCWZ1bmN0aW9uIHNlbGxTcGVjaWFsVG9rZW5zRm9yUHVibGljU2FsZShhZGRyZXNzIF9yZWNpcGllbnQsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKCQlhc3NlcnQoX3ZhbHVlID4gMCk7CgkJcmVxdWlyZShtc2cuc2VuZGVyID09IGljb0NvbnRyYWN0KTsKCgkJYmFsYW5jZXNbX3JlY2lwaWVudF0gPSBiYWxhbmNlc1tfcmVjaXBpZW50XS5hZGQoX3ZhbHVlKTsKCQl0b2tlblB1YmxpY1NhbGUgPSB0b2tlblB1YmxpY1NhbGUuYWRkKF92YWx1ZSk7CgkJdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoX3ZhbHVlKTsKCgkJVHJhbnNmZXIoMHgwLCBfcmVjaXBpZW50LCBfdmFsdWUpOwoJCXJldHVybiB0cnVlOwoJfQoKCS8qKgoJICogUGF5IGJvbnVzICYgYWZmaWxpYXRlIHRvIGFkZHJlc3MKCSAqIEBwYXJhbSBfcmVjaXBpZW50IC0gYWRkcmVzcyB0byByZWNlaXZlIGJvbnVzICYgYWZmaWxpYXRlCgkgKiBAcGFyYW0gX3ZhbHVlIC0gdmFsdWUgYm9udXMgJiBhZmZpbGlhdGUgdG8gZ2l2ZQoJICovCglmdW5jdGlvbiBwYXlCb251c0FmZmlsaWF0ZShhZGRyZXNzIF9yZWNpcGllbnQsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CgkJYXNzZXJ0KF92YWx1ZSA+IDApOwoJCXJlcXVpcmUobXNnLnNlbmRlciA9PSBpY29Db250cmFjdCk7CgoJCWJhbGFuY2VzW19yZWNpcGllbnRdID0gYmFsYW5jZXNbX3JlY2lwaWVudF0uYWRkKF92YWx1ZSk7CgkJdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoX3ZhbHVlKTsKCgkJVHJhbnNmZXIoMHgwLCBfcmVjaXBpZW50LCBfdmFsdWUpOwoJCXJldHVybiB0cnVlOwoJfQp9CgovKioKICogU3RvcmUgY29uZmlnIG9mIHBoYXNlIElDTwogKi8KY29udHJhY3QgSWNvUGhhc2UgewogIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IHBoYXNlUHJlc2FsZV9Gcm9tID0gMTUxNzQ5MzYwMDsvLzE0aCAwMS8wMi8yMDE4IEdNVAogIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IHBoYXNlUHJlc2FsZV9UbyA9IDE1MTg3MDMyMDA7Ly8xNGggMTUvMDIvMjAxOCBHTVQKCiAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgcGhhc2VQdWJsaWNTYWxlMV9Gcm9tID0gMTUyMDY5MDQwMDsvLzE0aCAxMC8wMy8yMDE4IEdNVAogIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IHBoYXNlUHVibGljU2FsZTFfVG8gPSAxNTIxMTIyNDAwOy8vMTRoIDE1LzAzLzIwMTggR01UCgogIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IHBoYXNlUHVibGljU2FsZTJfRnJvbSA9IDE1MjExMjI0MDA7Ly8xNGggMTUvMDMvMjAxOCBHTVQKICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBwaGFzZVB1YmxpY1NhbGUyX1RvID0gMTUyMTU1NDQwMDsvLzE0aCAyMC8wMy8yMDE4IEdNVAoKICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBwaGFzZVB1YmxpY1NhbGUzX0Zyb20gPSAxNTIxNTU0NDAwOy8vMTRoIDIwLzAzLzIwMTggR01UCiAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgcGhhc2VQdWJsaWNTYWxlM19UbyA9IDE1MjE5ODY0MDA7Ly8xNGggMjUvMDMvMjAxOCBHTVQKfQoKLyoqCiAqIFRoaXMgY29udHJhY3Qgd2lsbCBnaXZlIGFmZmlsaWF0ZSBmb3IgdXNlciB3aGVuIGJ1eSB0b2tlbnMuIFRoZSBhZmZpbGlhdGUgd2lsbCBiZSBwYWlkIGFmdGVyIGZpbmlzaGluZyBJQ08KICovCmNvbnRyYWN0IEFmZmlsaWF0ZSBpcyBPd25hYmxlIHsKCgkvL0NvbnRyb2wgQWZmaWxpYXRlIGZlYXR1cmUuCglib29sIHB1YmxpYyBpc0FmZmlsaWF0ZTsKCgkvL0FmZmlsaWF0ZSBsZXZlbCwgaW5pdCBpcyAxCgl1aW50MjU2IHB1YmxpYyBhZmZpbGlhdGVMZXZlbCA9IDE7CgoJLy9FYWNoIHVzZXIgd2lsbCBoYXZlIGRpZmZlcmVudCByYXRlCgltYXBwaW5nKHVpbnQyNTYgPT4gdWludDI1NikgcHVibGljIGFmZmlsaWF0ZVJhdGU7CgoJLy9LZWVwIGJhbGFuY2Ugb2YgdXNlcgoJbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyByZWZlcnJhbEJhbGFuY2U7Ly9yZWZlcmVlPT52YWx1ZQoKCW1hcHBpbmcoYWRkcmVzcyA9PiBhZGRyZXNzKSBwdWJsaWMgcmVmZXJyYWw7Ly9yZWZlcmVlPT5yZWZlcnJlcgoJbWFwcGluZyh1aW50MjU2ID0+IGFkZHJlc3MpIHB1YmxpYyByZWZlcnJhbEluZGV4Oy8vaW5kZXg9PnJlZmVyZWUKCgl1aW50MjU2IHB1YmxpYyByZWZlcnJhbENvdW50OwoKCS8qKgoJICogVGhyb3cgaWYgYWZmaWxpYXRlIGlzIGRpc2FibGUKCSAqLwoJbW9kaWZpZXIgd2hlbkFmZmlsaWF0ZSgpIHsKCQlyZXF1aXJlIChpc0FmZmlsaWF0ZSk7CgkJXzsKCX0KCgkvKioKCSAqIGNvbnN0cnVjdG9yIGFmZmlsaWF0ZSB3aXRoIGxldmVsIDEgcmF0ZSA9IDYlCgkgKi8KCWZ1bmN0aW9uIEFmZmlsaWF0ZSgpIHB1YmxpYyB7CgkJaXNBZmZpbGlhdGU9dHJ1ZTsKCQlhZmZpbGlhdGVMZXZlbD0xOwoJCWFmZmlsaWF0ZVJhdGVbMF09NjsKCX0KCgkvKioKCSAqIEVuYWJsZSBhZmZpbGlhdGUgZm9yIHRoZSBjb250cmFjdAoJICovCglmdW5jdGlvbiBlbmFibGVBZmZpbGlhdGUoKSBwdWJsaWMgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKCQlyZXF1aXJlICghaXNBZmZpbGlhdGUpOwoJCWlzQWZmaWxpYXRlPXRydWU7CgkJcmV0dXJuIHRydWU7Cgl9CgoJLyoqCgkgKiBEaXNhYmxlIGFmZmlsaWF0ZSBmb3IgdGhlIGNvbnRyYWN0CgkgKi8KCWZ1bmN0aW9uIGRpc2FibGVBZmZpbGlhdGUoKSBwdWJsaWMgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKCQlyZXF1aXJlIChpc0FmZmlsaWF0ZSk7CgkJaXNBZmZpbGlhdGU9ZmFsc2U7CgkJcmV0dXJuIHRydWU7Cgl9CgoJLyoqCgkgKiBSZXR1cm4gY3VycmVudCBhZmZpbGlhdGUgbGV2ZWwKCSAqLwoJZnVuY3Rpb24gZ2V0QWZmaWxpYXRlTGV2ZWwoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KQoJewoJCXJldHVybiBhZmZpbGlhdGVMZXZlbDsKCX0KCgkvKioKCSAqIFVwZGF0ZSBhZmZpbGlhdGUgbGV2ZWwgYnkgb3duZXIKCSAqIEBwYXJhbSBfbGV2ZWwgLSBuZXcgbGV2ZWwKCSAqLwoJZnVuY3Rpb24gc2V0QWZmaWxpYXRlTGV2ZWwodWludDI1NiBfbGV2ZWwpIHB1YmxpYyBvbmx5T3duZXIgd2hlbkFmZmlsaWF0ZSByZXR1cm5zKGJvb2wpCgl7CgkJYWZmaWxpYXRlTGV2ZWw9X2xldmVsOwoJCXJldHVybiB0cnVlOwoJfQoKCS8qKgoJICogR2V0IHJlZmVycmVyIGFkZHJlc3MKCSAqIEBwYXJhbSBfcmVmZXJlZSAtIHRoZSByZWZlcmVlIGFkZHJlc3MKCSAqLwoJZnVuY3Rpb24gZ2V0UmVmZXJyZXJBZGRyZXNzKGFkZHJlc3MgX3JlZmVyZWUpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzKQoJewoJCXJldHVybiByZWZlcnJhbFtfcmVmZXJlZV07Cgl9CgoJLyoqCgkgKiBHZXQgcmVmZXJlZSBhZGRyZXNzCgkgKiBAcGFyYW0gX3JlZmVycmVyIC0gdGhlIHJlZmVycmVyIGFkZHJlc3MKCSAqLwoJZnVuY3Rpb24gZ2V0UmVmZXJlZUFkZHJlc3MoYWRkcmVzcyBfcmVmZXJyZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzW10gX3JlZmVyZWUpCgl7CgkJYWRkcmVzc1tdIG1lbW9yeSByZWZlcmVlVGVtcCA9IG5ldyBhZGRyZXNzW10ocmVmZXJyYWxDb3VudCk7CgkJdWludCBjb3VudCA9IDA7CgkJdWludCBpOwoJCWZvciAoaT0wOyBpPHJlZmVycmFsQ291bnQ7IGkrKyl7CgkJCWlmKHJlZmVycmFsW3JlZmVycmFsSW5kZXhbaV1dID09IF9yZWZlcnJlcil7CgkJCQlyZWZlcmVlVGVtcFtjb3VudF0gPSByZWZlcnJhbEluZGV4W2ldOwoKCQkJCWNvdW50ICs9IDE7CgkJCX0KCQl9CgoJCV9yZWZlcmVlID0gbmV3IGFkZHJlc3NbXShjb3VudCk7CgkJZm9yIChpPTA7IGk8Y291bnQ7IGkrKykKCQkJX3JlZmVyZWVbaV0gPSByZWZlcmVlVGVtcFtpXTsKCX0KCgkvKioKCSAqIE1hcHBpbmcgcmVmZXJlZSBhZGRyZXNzIHdpdGggcmVmZXJyZXIgYWRkcmVzcwoJICogQHBhcmFtIF9wYXJlbnQgLSB0aGUgcmVmZXJyZXIgYWRkcmVzcwoJICogQHBhcmFtIF9jaGlsZCAtIHRoZSByZWZlcmVlIGFkZHJlc3MKCSAqLwoJZnVuY3Rpb24gc2V0UmVmZXJyYWxBZGRyZXNzKGFkZHJlc3MgX3BhcmVudCwgYWRkcmVzcyBfY2hpbGQpIHB1YmxpYyBvbmx5T3duZXIgd2hlbkFmZmlsaWF0ZSByZXR1cm5zIChib29sKQoJewoJCXJlcXVpcmUoX3BhcmVudCAhPSBhZGRyZXNzKDB4MDApKTsKCQlyZXF1aXJlKF9jaGlsZCAhPSBhZGRyZXNzKDB4MDApKTsKCgkJcmVmZXJyYWxJbmRleFtyZWZlcnJhbENvdW50XT1fY2hpbGQ7CgkJcmVmZXJyYWxbX2NoaWxkXT1fcGFyZW50OwoJCXJlZmVycmFsQ291bnQrKzsKCgkJcmVmZXJyYWxCYWxhbmNlW19jaGlsZF09MDsKCgkJcmV0dXJuIHRydWU7Cgl9CgoJLyoqCgkgKiBHZXQgYWZmaWxpYXRlIHJhdGUgYnkgbGV2ZWwKCSAqIEBwYXJhbSBfbGV2ZWwgLSBsZXZlbCB0byBnZXQgYWZmaWxpYXRlIHJhdGUKCSAqLwoJZnVuY3Rpb24gZ2V0QWZmaWxpYXRlUmF0ZSh1aW50MjU2IF9sZXZlbCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmF0ZSkKCXsKCQlyZXR1cm4gYWZmaWxpYXRlUmF0ZVtfbGV2ZWxdOwoJfQoKCS8qKgoJICogU2V0IGFmZmlsaWF0ZSByYXRlIGZvciBsZXZlbAoJICogQHBhcmFtIF9sZXZlbCAtIHRoZSBsZXZlbCB0byBiZSBzZXQgdGhlIG5ldyByYXRlCgkgKiBAcGFyYW0gX3JhdGUgLSBuZXcgcmF0ZQoJICovCglmdW5jdGlvbiBzZXRBZmZpbGlhdGVSYXRlKHVpbnQyNTYgX2xldmVsLCB1aW50MjU2IF9yYXRlKSBwdWJsaWMgb25seU93bmVyIHdoZW5BZmZpbGlhdGUgcmV0dXJucyAoYm9vbCkKCXsKCQlhZmZpbGlhdGVSYXRlW19sZXZlbF09X3JhdGU7CgkJcmV0dXJuIHRydWU7Cgl9CgoJLyoqCgkgKiBHZXQgYWZmaWxpYXRlIGJhbGFuY2Ugb2YgYW4gYWNjb3VudAoJICogQHBhcmFtIF9yZWZlcmVlIC0gdGhlIGFkZHJlc3MgdG8gZ2V0IGFmZmlsaWF0ZSBvZgoJICovCglmdW5jdGlvbiBiYWxhbmNlQWZmaWxpYXRlT2YoYWRkcmVzcyBfcmVmZXJlZSkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpCgl7CgkJcmV0dXJuIHJlZmVycmFsQmFsYW5jZVtfcmVmZXJlZV07Cgl9CgoJLyoqCgkgKiBQYXkgYWZmaWxpYXRlCgkgKi8KCWZ1bmN0aW9uIHBheUFmZmlsaWF0ZVRvQWRkcmVzcyhhZGRyZXNzIF9yZWZlcmVlKSBwdWJsaWMgb25seU93bmVyIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7Cn0KCi8qKgogKiBUaGlzIGNvbnRyYWN0IHdpbGwgZ2l2ZSBib251cyBmb3IgdXNlciB3aGVuIGJ1eSB0b2tlbnMuIFRoZSBib251cyB3aWxsIGJlIHBhaWQgYWZ0ZXIgZmluaXNoaW5nIElDTwogKi8KY29udHJhY3QgQm9udXMgaXMgSWNvUGhhc2UsIE93bmFibGUgewoJdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgoJLy9kZWNpbWFscyBvZiB0b2tlbnMKCXVpbnQyNTYgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKCgkvL2VuYWJsZS9kaXNhYmxlCglib29sIHB1YmxpYyBpc0JvbnVzOwoKCS8vc3RvcmFnZQoJbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBib251c0FjY291bnRCYWxhbmNlczsKCW1hcHBpbmcodWludDI1NiA9PiBhZGRyZXNzKSBwdWJsaWMgYm9udXNBY2NvdW50SW5kZXg7Cgl1aW50MjU2IHB1YmxpYyBib251c0FjY291bnRDb3VudDsKCglmdW5jdGlvbiBCb251cygpIHB1YmxpYyB7CgkJaXNCb251cyA9IHRydWU7Cgl9CgoJLyoqCgkgKiBFbmFibGUgYm9udXMKCSAqLwoJZnVuY3Rpb24gZW5hYmxlQm9udXMoKSBwdWJsaWMgb25seU93bmVyIHJldHVybnMgKGJvb2wpCgl7CgkJcmVxdWlyZSghaXNCb251cyk7CgkJaXNCb251cz10cnVlOwoJCXJldHVybiB0cnVlOwoJfQoKCS8qKgoJICogRGlzYWJsZSBib251cwoJICovCglmdW5jdGlvbiBkaXNhYmxlQm9udXMoKSBwdWJsaWMgb25seU93bmVyIHJldHVybnMgKGJvb2wpCgl7CgkJcmVxdWlyZShpc0JvbnVzKTsKCQlpc0JvbnVzPWZhbHNlOwoJCXJldHVybiB0cnVlOwoJfQoKCS8qKgoJICogR2V0IGJvbnVzIHBlcmNlbnQgYnkgdGltZQoJICovCglmdW5jdGlvbiBnZXRCb251c0J5VGltZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYpIHsKCQl1aW50MjU2IGJvbnVzID0gMDsKCgkJaWYobm93Pj1waGFzZVByZXNhbGVfRnJvbSAmJiBub3c8cGhhc2VQcmVzYWxlX1RvKXsKCQkJYm9udXMgPSAxMDsKCQl9IGVsc2UgaWYgKG5vdz49cGhhc2VQdWJsaWNTYWxlMV9Gcm9tICYmIG5vdzxwaGFzZVB1YmxpY1NhbGUxX1RvKSB7CgkJCWJvbnVzID0gNjsKCQl9IGVsc2UgaWYgKG5vdz49cGhhc2VQdWJsaWNTYWxlMl9Gcm9tICYmIG5vdzxwaGFzZVB1YmxpY1NhbGUyX1RvKSB7CgkJCWJvbnVzID0gMzsKCQl9IGVsc2UgaWYgKG5vdz49cGhhc2VQdWJsaWNTYWxlM19Gcm9tICYmIG5vdzxwaGFzZVB1YmxpY1NhbGUzX1RvKSB7CgkJCWJvbnVzID0gMTsKCQl9CgoJCXJldHVybiBib251czsKCX0KCgkvKioKCSAqIEdldCBib251cyBieSBldGgKCSAqIEBwYXJhbSBfdmFsdWUgLSBldGggdG8gY29udmVydCB0byBib251cwoJICovCglmdW5jdGlvbiBnZXRCb251c0J5RVRIKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KSB7CgkJdWludDI1NiBib251cyA9IDA7CgoJCWlmKG5vdz49cGhhc2VQcmVzYWxlX0Zyb20gJiYgbm93PHBoYXNlUHJlc2FsZV9Ubyl7CgkJCWlmKF92YWx1ZT49NDAwKjEwKipkZWNpbWFscyl7CgkJCQlib251cz1fdmFsdWUubXVsKDEwKS5kaXYoMTAwKTsKCQkJfSBlbHNlIGlmKF92YWx1ZT49MzAwKjEwKipkZWNpbWFscyl7CgkJCQlib251cz1fdmFsdWUubXVsKDUpLmRpdigxMDApOwoJCQl9CgkJfQoKCQlyZXR1cm4gYm9udXM7Cgl9CgoJLyoqCgkgKiBHZXQgYm9udXMgYmFsYW5jZSBvZiBhbiBhY2NvdW50CgkgKiBAcGFyYW0gX293bmVyIC0gdGhlIGFkZHJlc3MgdG8gZ2V0IGJvbnVzIG9mCgkgKi8KCWZ1bmN0aW9uIGJhbGFuY2VCb251c09mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKQoJewoJCXJldHVybiBib251c0FjY291bnRCYWxhbmNlc1tfb3duZXJdOwoJfQoKCS8qKgoJICogR2V0IGJvbnVzIGJhbGFuY2Ugb2YgYW4gYWNjb3VudAoJICovCglmdW5jdGlvbiBwYXlCb251c1RvQWRkcmVzcyhhZGRyZXNzIF9hZGRyZXNzKSBwdWJsaWMgb25seU93bmVyIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7Cn0KCi8qKgogKiBUaGlzIGNvbnRyYWN0IHdpbGwgc2VuZCB0b2tlbnMgd2hlbiBhbiBhY2NvdW50IHNlbmQgZXRoCiAqIE5vdGU6IGJlZm9yZSBzZW5kIGV0aCB0byB0b2tlbiwgYWRkcmVzcyBoYXMgdG8gYmUgcmVnaXN0ZXJlZCBieSByZWdpc3RlclJlY2lwaWVudCBmdW5jdGlvbgogKi8KY29udHJhY3QgSWNvQ29udHJhY3QgaXMgSWNvUGhhc2UsIE93bmFibGUsIFBhdXNhYmxlLCBBZmZpbGlhdGUsIEJvbnVzIHsKCXVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKCUpXQ1Rva2VuIGNjYzsKCgl1aW50MjU2IHB1YmxpYyB0b3RhbFRva2VuU2FsZTsKCXVpbnQyNTYgcHVibGljIG1pbkNvbnRyaWJ1dGlvbiA9IDAuNSBldGhlcjsvL21pbmltdW4gZXRoIHVzZWQgdG8gYnV5IHRva2VucwoJdWludDI1NiBwdWJsaWMgdG9rZW5FeGNoYW5nZVJhdGUgPSAxMDAwMDsvLzFFVEg9MTAwMDAgdG9rZW5zCgl1aW50MjU2IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwoKCXVpbnQyNTYgcHVibGljIHRva2VuUmVtYWluUHJlU2FsZTsvL3Rva2VucyByZW1haW4gZm9yIHByZS1zYWxlCgl1aW50MjU2IHB1YmxpYyB0b2tlblJlbWFpblB1YmxpY1NhbGU7Ly90b2tlbnMgZm9yIHB1YmxpYy1zYWxlCgoJYWRkcmVzcyBwdWJsaWMgZXRoRnVuZERlcG9zaXQgPSAweDFFYjBmQWFDNTJFRDBBZkNjYmYxRjNFNjdBMzk5RGE1NDQwMzUxY2Y7Ly9tdWx0aS1zaWcgd2FsbGV0CglhZGRyZXNzIHB1YmxpYyB0b2tlbkFkZHJlc3M7CgoJYm9vbCBwdWJsaWMgaXNGaW5hbGl6ZWQ7CgoJdWludDI1NiBwdWJsaWMgbWF4R2FzUmVmdW5kID0gMC4wMDQgZXRoZXI7Ly9tYXhpbXVtIGdhcyB1c2VkIHRvIHJlZnVuZCBmb3IgZWFjaCB0cmFuc2FjdGlvbgoKCS8vY29uc3RydWN0b3IKCWZ1bmN0aW9uIEljb0NvbnRyYWN0KGFkZHJlc3MgX3Rva2VuQWRkcmVzcykgcHVibGljIHsKCQl0b2tlbkFkZHJlc3MgPSBfdG9rZW5BZGRyZXNzOwoKCQljY2MgPSBKV0NUb2tlbih0b2tlbkFkZHJlc3MpOwoJCXRvdGFsVG9rZW5TYWxlID0gY2NjLnRva2VuUHJlU2FsZSgpICsgY2NjLnRva2VuUHVibGljU2FsZSgpOwoKCQl0b2tlblJlbWFpblByZVNhbGUgPSBjY2MudG9rZW5QcmVTYWxlKCk7Ly90b2tlbnMgcmVtYWluIGZvciBwcmUtc2FsZQoJCXRva2VuUmVtYWluUHVibGljU2FsZSA9IGNjYy50b2tlblB1YmxpY1NhbGUoKTsvL3Rva2VucyBmb3IgcHVibGljLXNhbGUKCgkJaXNGaW5hbGl6ZWQ9ZmFsc2U7Cgl9CgoJLyoqCgkgKiB3ZWIzIGNoYW5nZSB0b2tlbiBmcm9tIGV0aAoJICogQHBhcmFtIF92YWx1ZSAtIGFtb3VudCBvZiBFVEggdG8gY29udmVydCB0byB0b2tlbgoJICovCglmdW5jdGlvbiBjaGFuZ2VFVEgyVG9rZW4odWludDI1NiBfdmFsdWUpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYpIHsKCQl1aW50MjU2IGV0aGVyUmVjZXYgPSBfdmFsdWUgKyBtYXhHYXNSZWZ1bmQ7CgkJcmVxdWlyZSAoZXRoZXJSZWNldiA+PSBtaW5Db250cmlidXRpb24pOwoKCQl1aW50MjU2IHRva2VucyA9IGV0aGVyUmVjZXYubXVsKHRva2VuRXhjaGFuZ2VSYXRlKTsKCgkJLy9nZXQgY3VycmVudCBwaGFzZSBvZiBJQ08KCQl1aW50MjU2IHBoYXNlSUNPID0gZ2V0Q3VycmVudElDT1BoYXNlKCk7CgkJdWludDI1NiB0b2tlblJlbWFpbiA9IDA7CgkJaWYocGhhc2VJQ08gPT0gMSl7Ly9wcmUtc2FsZQoJCQl0b2tlblJlbWFpbiA9IHRva2VuUmVtYWluUHJlU2FsZTsKCQl9IGVsc2UgaWYgKHBoYXNlSUNPID09IDIgfHwgcGhhc2VJQ08gPT0gMyB8fCBwaGFzZUlDTyA9PSA0KSB7CgkJCXRva2VuUmVtYWluID0gdG9rZW5SZW1haW5QdWJsaWNTYWxlOwoJCX0KCgkJaWYgKHRva2VuUmVtYWluIDwgdG9rZW5zKSB7CgkJCXRva2Vucz10b2tlblJlbWFpbjsKCQl9CgoJCXJldHVybiB0b2tlbnM7Cgl9CgoJLyoqCgkgKiB3aWxsIGJlIGNhbGxlZCB3aGVuIHVzZXIgc2VuZCBldGggdG8gYnV5IHRva2VuCgkgKi8KCWZ1bmN0aW9uICgpIHB1YmxpYyBwYXlhYmxlIHdoZW5Ob3RQYXVzZWQgewoJCXJlcXVpcmUgKCFpc0ZpbmFsaXplZCk7CgkJcmVxdWlyZSAobXNnLnNlbmRlciAhPSBhZGRyZXNzKDApKTsKCgkJdWludDI1NiBldGhlclJlY2V2ID0gbXNnLnZhbHVlICsgbWF4R2FzUmVmdW5kOwoJCXJlcXVpcmUgKGV0aGVyUmVjZXYgPj0gbWluQ29udHJpYnV0aW9uKTsKCgkJdWludDI1NiB0b2tlbnMgPSBldGhlclJlY2V2Lm11bCh0b2tlbkV4Y2hhbmdlUmF0ZSk7CgoJCS8vZ2V0IGN1cnJlbnQgcGhhc2Ugb2YgSUNPCgkJdWludDI1NiBwaGFzZUlDTyA9IGdldEN1cnJlbnRJQ09QaGFzZSgpOwoKCQlyZXF1aXJlKHBoYXNlSUNPIT0wKTsKCgkJdWludDI1NiB0b2tlblJlbWFpbiA9IDA7CgkJaWYocGhhc2VJQ08gPT0gMSl7Ly9wcmUtc2FsZQoJCQl0b2tlblJlbWFpbiA9IHRva2VuUmVtYWluUHJlU2FsZTsKCQl9IGVsc2UgaWYgKHBoYXNlSUNPID09IDIgfHwgcGhhc2VJQ08gPT0gMyB8fCBwaGFzZUlDTyA9PSA0KSB7CgkJCXRva2VuUmVtYWluID0gdG9rZW5SZW1haW5QdWJsaWNTYWxlOwoJCX0KCgkJLy90aHJvdyBpZiB0b2tlblJlbWFpbj09MAoJCXJlcXVpcmUodG9rZW5SZW1haW4+MCk7CgoJCWlmICh0b2tlblJlbWFpbiA8IHRva2VucykgewoJCQkvL2lmIHRva2VucyBpcyBub3QgZW5vdWdoIHRvIGJ1eQoJCQl1aW50MjU2IHRva2Vuc1RvSW5jcmVhc2UgPSB0b2tlbnMuc3ViKHRva2VuUmVtYWluKTsKCQkJY2NjLnNlbGwobXNnLnNlbmRlciwgdG9rZW5SZW1haW4pOwoKCQkJaWYocGhhc2VJQ08gPT0gMSl7Ly9wcmUtc2FsZQoJCQkJY2NjLnNlbGxTcGVjaWFsVG9rZW5zRm9yUHJlU2FsZShtc2cuc2VuZGVyLCB0b2tlbnNUb0luY3JlYXNlKTsKCQkJfSBlbHNlIGlmIChwaGFzZUlDTyA9PSAyIHx8IHBoYXNlSUNPID09IDMgfHwgcGhhc2VJQ08gPT0gNCkgewoJCQkJY2NjLnNlbGxTcGVjaWFsVG9rZW5zRm9yUHVibGljU2FsZShtc2cuc2VuZGVyLCB0b2tlbnNUb0luY3JlYXNlKTsKCQkJfQoKCQkJdG9rZW5SZW1haW4gPSAwOwoJCX0gZWxzZSB7CgkJCWNjYy5zZWxsKG1zZy5zZW5kZXIsIHRva2Vucyk7CgkJCXRva2VuUmVtYWluID0gdG9rZW5SZW1haW4uc3ViKHRva2Vucyk7CgkJfQoKCQkvL3N0b3JlIHRva2VuIHJlbWFpbiBieSBwaGFzZQoJCWlmKHBoYXNlSUNPID09IDEpey8vcHJlLXNhbGUKCQkJdG9rZW5SZW1haW5QcmVTYWxlID0gdG9rZW5SZW1haW47CgkJfSBlbHNlIGlmIChwaGFzZUlDTyA9PSAyIHx8IHBoYXNlSUNPID09IDMgfHwgcGhhc2VJQ08gPT0gNCkgewoJCQl0b2tlblJlbWFpblB1YmxpY1NhbGUgPSB0b2tlblJlbWFpbjsKCQl9CgoJCWV0aEZ1bmREZXBvc2l0LnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CgoJCS8vYm9udXMKCQlpZihpc0JvbnVzKXsKCQkJLy9ib251cyBhbW91bnQKCQkJLy9nZXQgYm9udXMgYnkgZXRoCgkJCXVpbnQyNTYgYm9udXNCeUVUSCA9IGdldEJvbnVzQnlFVEgoZXRoZXJSZWNldik7CgkJCS8vZ2V0IGJvbnVzIGJ5IHRva2VuCgkJCXVpbnQyNTYgYm9udXNUb2tlbkJ5RVRIID0gYm9udXNCeUVUSC5tdWwodG9rZW5FeGNoYW5nZVJhdGUpOwoKCQkJLy9ib251cyB0aW1lCgkJCXVpbnQyNTYgYm9udXNUb2tlbkJ5VGltZSA9IHRva2Vucy5tdWwoZ2V0Qm9udXNCeVRpbWUoKSkuZGl2KDEwMCk7CgoJCQkvL3N0b3JlIGJvbnVzCgkJCWlmKGJvbnVzQWNjb3VudEJhbGFuY2VzW21zZy5zZW5kZXJdPT0wKXsvL25ldwoJCQkJYm9udXNBY2NvdW50SW5kZXhbYm9udXNBY2NvdW50Q291bnRdPW1zZy5zZW5kZXI7CgkJCQlib251c0FjY291bnRDb3VudCsrOwoJCQl9CgoJCQl1aW50MjU2IGJvbnVzVG9rZW49Ym9udXNUb2tlbkJ5VGltZStib251c1Rva2VuQnlFVEg7CgkJCWJvbnVzQWNjb3VudEJhbGFuY2VzW21zZy5zZW5kZXJdPWJvbnVzQWNjb3VudEJhbGFuY2VzW21zZy5zZW5kZXJdLmFkZChib251c1Rva2VuKTsKCQl9CgoJCS8vYWZmaWxpYXRlCgkJaWYoaXNBZmZpbGlhdGUpewoJCQlhZGRyZXNzIGNoaWxkPW1zZy5zZW5kZXI7CgkJCWZvcih1aW50MjU2IGk9MDsgaTxhZmZpbGlhdGVMZXZlbDsgaSsrKXsKCQkJCXVpbnQyNTYgZ2lmdFRva2VuPWFmZmlsaWF0ZVJhdGVbaV0ubXVsKHRva2VucykuZGl2KDEwMCk7CgoJCQkJYWRkcmVzcyBwYXJlbnQgPSByZWZlcnJhbFtjaGlsZF07CgkJCQlpZihwYXJlbnQgIT0gYWRkcmVzcygweDAwKSl7Ly9oYXMgYWZmaWxpYXRlCgkJCQkJcmVmZXJyYWxCYWxhbmNlW2NoaWxkXT1yZWZlcnJhbEJhbGFuY2VbY2hpbGRdLmFkZChnaWZ0VG9rZW4pOwoJCQkJfQoKCQkJCWNoaWxkPXBhcmVudDsKCQkJfQoJCX0KCX0KCgkvKioKCSAqIFBheSBhZmZpbGlhdGUgdG8gb25seSBhIGFkZHJlc3MKCSAqIEBwYXJhbSBfcmVmZXJlZSAtIHRoZSBhZGRyZXNzIG9mIHJlZmVyZWUKCSAqLwoJZnVuY3Rpb24gcGF5QWZmaWxpYXRlVG9BZGRyZXNzKGFkZHJlc3MgX3JlZmVyZWUpIHB1YmxpYyBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CgkJYWRkcmVzcyByZWZlcnJlciA9IHJlZmVycmFsW19yZWZlcmVlXTsKCQljY2MucGF5Qm9udXNBZmZpbGlhdGUocmVmZXJyZXIsIHJlZmVycmFsQmFsYW5jZVtfcmVmZXJlZV0pOwoKCQlyZWZlcnJhbEJhbGFuY2VbX3JlZmVyZWVdPTA7CgkJcmV0dXJuIHRydWU7Cgl9CgoJLyoqCgkgKiBQYXkgYm9udXMgdG8gb25seSBhIGFkZHJlc3MKCSAqIEBwYXJhbSBfYWRkcmVzcyAtIHRoZSBhZGRyZXNzIHRvIHBheSBib251cwoJICovCglmdW5jdGlvbiBwYXlCb251c1RvQWRkcmVzcyhhZGRyZXNzIF9hZGRyZXNzKSBwdWJsaWMgb25seU93bmVyIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewoJCWNjYy5wYXlCb251c0FmZmlsaWF0ZShfYWRkcmVzcywgYm9udXNBY2NvdW50QmFsYW5jZXNbX2FkZHJlc3NdKTsKCQlib251c0FjY291bnRCYWxhbmNlc1tfYWRkcmVzc109MDsKCQlyZXR1cm4gdHJ1ZTsKCX0KCglmdW5jdGlvbiBmaW5hbGl6ZSgpIGV4dGVybmFsIG9ubHlPd25lciB7CgkJcmVxdWlyZSAoIWlzRmluYWxpemVkKTsKCQkvLyBtb3ZlIHRvIG9wZXJhdGlvbmFsCgkJaXNGaW5hbGl6ZWQgPSB0cnVlOwoJCWV0aEZ1bmREZXBvc2l0LnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7Cgl9CgoJLyoqCgkgKiBHZXQgdGhlIGN1cnJlbnQgSUNPIHBoYXNlCgkgKi8KCWZ1bmN0aW9uIGdldEN1cnJlbnRJQ09QaGFzZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYgcGhhc2UpIHsKCQlwaGFzZSA9IDA7CgkJaWYobm93Pj1waGFzZVByZXNhbGVfRnJvbSAmJiBub3c8cGhhc2VQcmVzYWxlX1RvKXsKCQkJcGhhc2UgPSAxOwoJCX0gZWxzZSBpZiAobm93Pj1waGFzZVB1YmxpY1NhbGUxX0Zyb20gJiYgbm93PHBoYXNlUHVibGljU2FsZTFfVG8pIHsKCQkJcGhhc2UgPSAyOwoJCX0gZWxzZSBpZiAobm93Pj1waGFzZVB1YmxpY1NhbGUyX0Zyb20gJiYgbm93PHBoYXNlUHVibGljU2FsZTJfVG8pIHsKCQkJcGhhc2UgPSAzOwoJCX0gZWxzZSBpZiAobm93Pj1waGFzZVB1YmxpY1NhbGUzX0Zyb20gJiYgbm93PHBoYXNlUHVibGljU2FsZTNfVG8pIHsKCQkJcGhhc2UgPSA0OwoJCX0KCX0KCgkvKioKCSAqIEdldCBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYmUgc29sZAoJICovCglmdW5jdGlvbiBnZXRUb2tlblNvbGQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2IHRva2VuU29sZCkgewoJCS8vZ2V0IGN1cnJlbnQgcGhhc2Ugb2YgSUNPCgkJdWludDI1NiBwaGFzZUlDTyA9IGdldEN1cnJlbnRJQ09QaGFzZSgpOwoJCXRva2VuU29sZCA9IDA7CgkJaWYocGhhc2VJQ08gPT0gMSl7Ly9wcmUtc2FsZQoJCQl0b2tlblNvbGQgPSBjY2MudG9rZW5QcmVTYWxlKCkuc3ViKHRva2VuUmVtYWluUHJlU2FsZSk7CgkJfSBlbHNlIGlmIChwaGFzZUlDTyA9PSAyIHx8IHBoYXNlSUNPID09IDMgfHwgcGhhc2VJQ08gPT0gNCkgewoJCQl0b2tlblNvbGQgPSBjY2MudG9rZW5QcmVTYWxlKCkuc3ViKHRva2VuUmVtYWluUHJlU2FsZSkgKyBjY2MudG9rZW5QdWJsaWNTYWxlKCkuc3ViKHRva2VuUmVtYWluUHVibGljU2FsZSk7CgkJfQoJfQoKCS8qKgoJICogU2V0IHRva2VuIGV4Y2hhbmdlIHJhdGUKCSAqIEBwYXJhbSBfdG9rZW5FeGNoYW5nZVJhdGUgLSByYXRlIG9mIGV0aC10b2tlbgoJICovCglmdW5jdGlvbiBzZXRUb2tlbkV4Y2hhbmdlUmF0ZSh1aW50MjU2IF90b2tlbkV4Y2hhbmdlUmF0ZSkgcHVibGljIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CgkJcmVxdWlyZShfdG9rZW5FeGNoYW5nZVJhdGU+MCk7CgkJdG9rZW5FeGNoYW5nZVJhdGU9X3Rva2VuRXhjaGFuZ2VSYXRlOwoJCXJldHVybiB0cnVlOwoJfQoKCS8qKgoJICogc2V0IG1pbiBldGggY29udHJpYnV0ZQoJICogQHBhcmFtIF9taW5Db250cmlidXRpb24gLSBtaW4gZXRoIHRvIGNvbnRyaWJ1dGUKCSAqLwoJZnVuY3Rpb24gc2V0TWluQ29udHJpYnV0aW9uKHVpbnQyNTYgX21pbkNvbnRyaWJ1dGlvbikgcHVibGljIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CgkJcmVxdWlyZShfbWluQ29udHJpYnV0aW9uPjApOwoJCW1pbkNvbnRyaWJ1dGlvbj1fbWluQ29udHJpYnV0aW9uOwoJCXJldHVybiB0cnVlOwoJfQoKCS8qKgoJICogQ2hhbmdlIG11bHRpLXNpZyBhZGRyZXNzLCB0aGUgYWRkcmVzcyB0byByZWNlaXZlIEVUSAoJICogQHBhcmFtIF9ldGhGdW5kRGVwb3NpdCAtIG5ldyBtdWx0aS1zaWcgYWRkcmVzcwoJICovCglmdW5jdGlvbiBzZXRFdGhGdW5kRGVwb3NpdChhZGRyZXNzIF9ldGhGdW5kRGVwb3NpdCkgcHVibGljIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CgkJcmVxdWlyZShfZXRoRnVuZERlcG9zaXQgIT0gYWRkcmVzcygwKSk7CgkJZXRoRnVuZERlcG9zaXQ9X2V0aEZ1bmREZXBvc2l0OwoJCXJldHVybiB0cnVlOwoJfQoKCS8qKgoJICogU2V0IG1heCBnYXMgdG8gcmVmdW5kIHdoZW4gYW4gYWRkcmVzcyBzZW5kIEVUSCB0byBidXkgdG9rZW5zCgkgKiBAcGFyYW0gX21heEdhc1JlZnVuZCAtIG1heCBnYXMKCSAqLwoJZnVuY3Rpb24gc2V0TWF4R2FzUmVmdW5kKHVpbnQyNTYgX21heEdhc1JlZnVuZCkgcHVibGljIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CgkJcmVxdWlyZShfbWF4R2FzUmVmdW5kID4gMCk7CgkJbWF4R2FzUmVmdW5kID0gX21heEdhc1JlZnVuZDsKCQlyZXR1cm4gdHJ1ZTsKCX0KfQ=='.
	

]
