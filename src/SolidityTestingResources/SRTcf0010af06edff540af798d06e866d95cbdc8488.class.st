Class {
	#name : #SRTcf0010af06edff540af798d06e866d95cbdc8488,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTcf0010af06edff540af798d06e866d95cbdc8488 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjE7CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICAgIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgaWYgKGEgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgICAgdWludDI1NiBjID0gYSAqIGI7CiAgICAgICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICAgICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAgICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGFzc2VydChiIDw9IGEpOwogICAgICAgIHJldHVybiBhIC0gYjsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgICAgIGFzc2VydChjID49IGEpOwogICAgICAgIHJldHVybiBjOwogICAgfQp9Cgpjb250cmFjdCBVbmljb3JuTWFuYWdlbWVudEludGVyZmFjZSB7CgogICAgZnVuY3Rpb24gb3duZXJBZGRyZXNzKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIG1hbmFnZXJBZGRyZXNzKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIGNvbW11bml0eUFkZHJlc3MoKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGFkZHJlc3MpOwogICAgZnVuY3Rpb24gZGl2aWRlbmRNYW5hZ2VyQWRkcmVzcygpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYWRkcmVzcyk7CiAgICBmdW5jdGlvbiB3YWxsZXRBZGRyZXNzKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIGJsYWNrQm94QWRkcmVzcygpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYWRkcmVzcyk7CiAgICBmdW5jdGlvbiB1bmljb3JuQnJlZWRpbmdBZGRyZXNzKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIGdlbmVMYWJBZGRyZXNzKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIHVuaWNvcm5Ub2tlbkFkZHJlc3MoKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGFkZHJlc3MpOwogICAgZnVuY3Rpb24gY2FuZHlUb2tlbigpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYWRkcmVzcyk7CiAgICBmdW5jdGlvbiBjYW5keVBvd2VyVG9rZW4oKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGFkZHJlc3MpOwoKICAgIGZ1bmN0aW9uIGNyZWF0ZURpdmlkZW5kUGVyY2VudCgpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludCk7CiAgICBmdW5jdGlvbiBzZWxsRGl2aWRlbmRQZXJjZW50KCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50KTsKICAgIGZ1bmN0aW9uIHN1YkZyZWV6aW5nUHJpY2UoKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQpOwogICAgZnVuY3Rpb24gc3ViRnJlZXppbmdUaW1lKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50NjQpOwogICAgZnVuY3Rpb24gc3ViVG91ckZyZWV6aW5nUHJpY2UoKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQpOwogICAgZnVuY3Rpb24gc3ViVG91ckZyZWV6aW5nVGltZSgpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludDY0KTsKICAgIGZ1bmN0aW9uIGNyZWF0ZVVuaWNvcm5QcmljZSgpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludCk7CiAgICBmdW5jdGlvbiBjcmVhdGVVbmljb3JuUHJpY2VJbkNhbmR5KCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50KTsKICAgIGZ1bmN0aW9uIG9yYWNsaXplRmVlKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50KTsKCiAgICBmdW5jdGlvbiBwYXVzZWQoKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgLy8gICAgZnVuY3Rpb24gbG9ja2VkKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChib29sKTsKCiAgICBmdW5jdGlvbiBpc1RvdXJuYW1lbnQoYWRkcmVzcyBfdG91cm5hbWVudEFkZHJlc3MpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCk7CgogICAgZnVuY3Rpb24gZ2V0Q3JlYXRlVW5pY29ybkZ1bGxQcmljZSgpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludCk7CiAgICBmdW5jdGlvbiBnZXRIeWJyaWRpemF0aW9uRnVsbFByaWNlKHVpbnQgX3ByaWNlKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQpOwogICAgZnVuY3Rpb24gZ2V0U2VsbFVuaWNvcm5GdWxsUHJpY2UodWludCBfcHJpY2UpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludCk7CiAgICBmdW5jdGlvbiBnZXRDcmVhdGVVbmljb3JuRnVsbFByaWNlSW5DYW5keSgpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAodWludCk7CgoKICAgIC8vc2VydmljZQogICAgZnVuY3Rpb24gcmVnaXN0ZXJJbml0KGFkZHJlc3MgX2NvbnRyYWN0KSBleHRlcm5hbDsKCn0KCmNvbnRyYWN0IFVuaWNvcm5BY2Nlc3NDb250cm9sIHsKCiAgICBVbmljb3JuTWFuYWdlbWVudEludGVyZmFjZSBwdWJsaWMgdW5pY29ybk1hbmFnZW1lbnQ7CgogICAgZnVuY3Rpb24gVW5pY29ybkFjY2Vzc0NvbnRyb2woYWRkcmVzcyBfdW5pY29ybk1hbmFnZW1lbnRBZGRyZXNzKSBwdWJsaWMgewogICAgICAgIHVuaWNvcm5NYW5hZ2VtZW50ID0gVW5pY29ybk1hbmFnZW1lbnRJbnRlcmZhY2UoX3VuaWNvcm5NYW5hZ2VtZW50QWRkcmVzcyk7CiAgICAgICAgdW5pY29ybk1hbmFnZW1lbnQucmVnaXN0ZXJJbml0KHRoaXMpOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gdW5pY29ybk1hbmFnZW1lbnQub3duZXJBZGRyZXNzKCkpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seU1hbmFnZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHVuaWNvcm5NYW5hZ2VtZW50Lm1hbmFnZXJBZGRyZXNzKCkpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seUNvbW11bml0eSgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gdW5pY29ybk1hbmFnZW1lbnQuY29tbXVuaXR5QWRkcmVzcygpKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlUb3VybmFtZW50KCkgewogICAgICAgIHJlcXVpcmUodW5pY29ybk1hbmFnZW1lbnQuaXNUb3VybmFtZW50KG1zZy5zZW5kZXIpKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICAgICAgcmVxdWlyZSghdW5pY29ybk1hbmFnZW1lbnQucGF1c2VkKCkpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgd2hlblBhdXNlZCB7CiAgICAgICAgcmVxdWlyZSh1bmljb3JuTWFuYWdlbWVudC5wYXVzZWQoKSk7CiAgICAgICAgXzsKICAgIH0KCgogICAgbW9kaWZpZXIgb25seU1hbmFnZW1lbnQoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkZHJlc3ModW5pY29ybk1hbmFnZW1lbnQpKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlCcmVlZGluZygpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gdW5pY29ybk1hbmFnZW1lbnQudW5pY29ybkJyZWVkaW5nQWRkcmVzcygpKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlHZW5lTGFiKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSB1bmljb3JuTWFuYWdlbWVudC5nZW5lTGFiQWRkcmVzcygpKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlCbGFja0JveCgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gdW5pY29ybk1hbmFnZW1lbnQuYmxhY2tCb3hBZGRyZXNzKCkpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seVVuaWNvcm5Ub2tlbigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gdW5pY29ybk1hbmFnZW1lbnQudW5pY29yblRva2VuQWRkcmVzcygpKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzR2FtZVBhdXNlZCgpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiB1bmljb3JuTWFuYWdlbWVudC5wYXVzZWQoKTsKICAgIH0KfQoKY29udHJhY3QgVW5pY29ybkJyZWVkaW5nSW50ZXJmYWNlIHsKICAgIGZ1bmN0aW9uIGRlbGV0ZU9mZmVyKHVpbnQgX3VuaWNvcm5JZCkgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBkZWxldGVIeWJyaWRpemF0aW9uKHVpbnQgX3VuaWNvcm5JZCkgZXh0ZXJuYWw7Cn0KCgpjb250cmFjdCBVbmljb3JuQmFzZSBpcyBVbmljb3JuQWNjZXNzQ29udHJvbCB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKICAgIFVuaWNvcm5CcmVlZGluZ0ludGVyZmFjZSBwdWJsaWMgdW5pY29ybkJyZWVkaW5nOyAvL3NldCBvbiBkZXBsb3kKCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHVuaWNvcm5JZCk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBhcHByb3ZlZCwgdWludDI1NiB1bmljb3JuSWQpOwogICAgZXZlbnQgVW5pY29ybkdlbmVTZXQodWludCBpbmRleGVkIHVuaWNvcm5JZCk7CiAgICBldmVudCBVbmljb3JuR2VuZVVwZGF0ZSh1aW50IGluZGV4ZWQgdW5pY29ybklkKTsKICAgIGV2ZW50IFVuaWNvcm5GcmVlemluZ1RpbWVTZXQodWludCBpbmRleGVkIHVuaWNvcm5JZCwgdWludCB0aW1lKTsKICAgIGV2ZW50IFVuaWNvcm5Ub3VyRnJlZXppbmdUaW1lU2V0KHVpbnQgaW5kZXhlZCB1bmljb3JuSWQsIHVpbnQgdGltZSk7CgoKICAgIHN0cnVjdCBVbmljb3JuIHsKICAgICAgICBieXRlcyBnZW5lOwogICAgICAgIHVpbnQ2NCBiaXJ0aFRpbWU7CiAgICAgICAgdWludDY0IGZyZWV6aW5nRW5kVGltZTsKICAgICAgICB1aW50NjQgZnJlZXppbmdUb3VyRW5kVGltZTsKICAgICAgICBzdHJpbmcgbmFtZTsKICAgIH0KCiAgICB1aW50OCBtYXhGcmVlemluZ0luZGV4ID0gNzsKICAgIHVpbnQzMls4XSBpbnRlcm5hbCBmcmVlemluZyA9IFsKICAgIHVpbnQzMigxIGhvdXJzKSwgICAgLy8xIGhvdXIKICAgIHVpbnQzMigyIGhvdXJzKSwgICAgLy8yIC0gNCBob3VycwogICAgdWludDMyKDggaG91cnMpLCAgICAvLzggLSAxMiBob3VycwogICAgdWludDMyKDE2IGhvdXJzKSwgICAvLzE2IC0gMjQgaG91cnMKICAgIHVpbnQzMigzNiBob3VycyksICAgLy8zNiAtIDQ4IGhvdXJzCiAgICB1aW50MzIoNzIgaG91cnMpLCAgIC8vNzIgLSA5NiBob3VycwogICAgdWludDMyKDEyMCBob3VycyksICAvLzEyMCAtIDE0NCBob3VycwogICAgdWludDMyKDE2OCBob3VycykgICAvLzE2OCBob3VycwogICAgXTsKCiAgICAvL2NvdW50IGZvciByYW5kb20gcGx1cyBmcm9tIDAgdG8gLi4KICAgIHVpbnQzMls4XSBpbnRlcm5hbCBmcmVlemluZ1BsdXNDb3VudCA9IFsKICAgIDAsIDMsIDUsIDksIDEzLCAyNSwgMjUsIDAKICAgIF07CgogICAgLy8gVG90YWwgYW1vdW50IG9mIHVuaWNvcm5zCiAgICB1aW50MjU2IHByaXZhdGUgdG90YWxVbmljb3JuczsKCiAgICAvLyBJbmNyZW1lbnRhbCBjb3VudGVyIG9mIHVuaWNvcm5zIElkCiAgICB1aW50MjU2IHByaXZhdGUgbGFzdFVuaWNvcm5JZDsKCiAgICAvL01hcHBpbmcgZnJvbSB1bmljb3JuIElEIHRvIFVuaWNvcm4gc3RydWN0CiAgICBtYXBwaW5nKHVpbnQyNTYgPT4gVW5pY29ybikgcHVibGljIHVuaWNvcm5zOwoKICAgIC8vIE1hcHBpbmcgZnJvbSB1bmljb3JuIElEIHRvIG93bmVyCiAgICBtYXBwaW5nKHVpbnQyNTYgPT4gYWRkcmVzcykgcHJpdmF0ZSB1bmljb3JuT3duZXI7CgogICAgLy8gTWFwcGluZyBmcm9tIHVuaWNvcm4gSUQgdG8gYXBwcm92ZWQgYWRkcmVzcwogICAgbWFwcGluZyh1aW50MjU2ID0+IGFkZHJlc3MpIHByaXZhdGUgdW5pY29ybkFwcHJvdmFsczsKCiAgICAvLyBNYXBwaW5nIGZyb20gb3duZXIgdG8gbGlzdCBvZiBvd25lZCB1bmljb3JuIElEcwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTZbXSkgcHJpdmF0ZSBvd25lZFVuaWNvcm5zOwoKICAgIC8vIE1hcHBpbmcgZnJvbSB1bmljb3JuIElEIHRvIGluZGV4IG9mIHRoZSBvd25lciB1bmljb3JucyBsaXN0CiAgICAvLyDRgi7QtS4gSUQg0YPQvdC40LrQvtGA0L3QsCA9PiDQv9C+0YDRj9C00LrQvtCy0YvQuSDQvdC+0LzQtdGAINCyINGB0L/QuNGB0LrQtSDQstC70LDQtNC10LvRjNGG0LAKICAgIG1hcHBpbmcodWludDI1NiA9PiB1aW50MjU2KSBwcml2YXRlIG93bmVkVW5pY29ybnNJbmRleDsKCiAgICAvLyBNYXBwaW5nIGZyb20gdW5pY29ybiBJRCB0byBhcHByb3ZhbCBmb3IgR2VuZUxhYgogICAgbWFwcGluZyh1aW50MjU2ID0+IGJvb2wpIHByaXZhdGUgdW5pY29ybkFwcHJvdmFsc0ZvckdlbmVMYWI7CgogICAgbW9kaWZpZXIgb25seU93bmVyT2YodWludDI1NiBfdW5pY29ybklkKSB7CiAgICAgICAgcmVxdWlyZShvd25zKG1zZy5zZW5kZXIsIF91bmljb3JuSWQpKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEdldHMgdGhlIG93bmVyIG9mIHRoZSBzcGVjaWZpZWQgdW5pY29ybiBJRAogICAgKiBAcGFyYW0gX3VuaWNvcm5JZCB1aW50MjU2IElEIG9mIHRoZSB1bmljb3JuIHRvIHF1ZXJ5IHRoZSBvd25lciBvZgogICAgKiBAcmV0dXJuIG93bmVyIGFkZHJlc3MgY3VycmVudGx5IG1hcmtlZCBhcyB0aGUgb3duZXIgb2YgdGhlIGdpdmVuIHVuaWNvcm4gSUQKICAgICovCiAgICBmdW5jdGlvbiBvd25lck9mKHVpbnQyNTYgX3VuaWNvcm5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcykgewogICAgICAgIHJldHVybiB1bmljb3JuT3duZXJbX3VuaWNvcm5JZF07CiAgICAgICAgLy8gICAgICAgIGFkZHJlc3Mgb3duZXIgPSB1bmljb3JuT3duZXJbX3VuaWNvcm5JZF07CiAgICAgICAgLy8gICAgICAgIHJlcXVpcmUob3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgLy8gICAgICAgIHJldHVybiBvd25lcjsKICAgIH0KCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gdG90YWxVbmljb3JuczsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcwogICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgdG8gcXVlcnkgdGhlIGJhbGFuY2Ugb2YKICAgICogQHJldHVybiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcwogICAgKi8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBvd25lZFVuaWNvcm5zW19vd25lcl0ubGVuZ3RoOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEdldHMgdGhlIGxpc3Qgb2YgdW5pY29ybnMgb3duZWQgYnkgYSBnaXZlbiBhZGRyZXNzCiAgICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyB0byBxdWVyeSB0aGUgdW5pY29ybnMgb2YKICAgICogQHJldHVybiB1aW50MjU2W10gcmVwcmVzZW50aW5nIHRoZSBsaXN0IG9mIHVuaWNvcm5zIG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcwogICAgKi8KICAgIGZ1bmN0aW9uIHVuaWNvcm5zT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTZbXSkgewogICAgICAgIHJldHVybiBvd25lZFVuaWNvcm5zW19vd25lcl07CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgR2V0cyB0aGUgYXBwcm92ZWQgYWRkcmVzcyB0byB0YWtlIG93bmVyc2hpcCBvZiBhIGdpdmVuIHVuaWNvcm4gSUQKICAgICogQHBhcmFtIF91bmljb3JuSWQgdWludDI1NiBJRCBvZiB0aGUgdW5pY29ybiB0byBxdWVyeSB0aGUgYXBwcm92YWwgb2YKICAgICogQHJldHVybiBhZGRyZXNzIGN1cnJlbnRseSBhcHByb3ZlZCB0byB0YWtlIG93bmVyc2hpcCBvZiB0aGUgZ2l2ZW4gdW5pY29ybiBJRAogICAgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmVkRm9yKHVpbnQyNTYgX3VuaWNvcm5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcykgewogICAgICAgIHJldHVybiB1bmljb3JuQXBwcm92YWxzW191bmljb3JuSWRdOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IFRlbGxzIHdoZXRoZXIgdGhlIG1zZy5zZW5kZXIgaXMgYXBwcm92ZWQgZm9yIHRoZSBnaXZlbiB1bmljb3JuIElEIG9yIG5vdAogICAgKiBUaGlzIGZ1bmN0aW9uIGlzIG5vdCBwcml2YXRlIHNvIGl0IGNhbiBiZSBleHRlbmRlZCBpbiBmdXJ0aGVyIGltcGxlbWVudGF0aW9ucyBsaWtlIHRoZSBvcGVyYXRhYmxlIEVSQzcyMQogICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3Mgb2YgdGhlIG93bmVyIHRvIHF1ZXJ5IHRoZSBhcHByb3ZhbCBvZgogICAgKiBAcGFyYW0gX3VuaWNvcm5JZCB1aW50MjU2IElEIG9mIHRoZSB1bmljb3JuIHRvIHF1ZXJ5IHRoZSBhcHByb3ZhbCBvZgogICAgKiBAcmV0dXJuIGJvb2wgd2hldGhlciB0aGUgbXNnLnNlbmRlciBpcyBhcHByb3ZlZCBmb3IgdGhlIGdpdmVuIHVuaWNvcm4gSUQgb3Igbm90CiAgICAqLwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCB1aW50MjU2IF91bmljb3JuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gYXBwcm92ZWRGb3IoX3VuaWNvcm5JZCkgPT0gX293bmVyOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEFwcHJvdmVzIGFub3RoZXIgYWRkcmVzcyB0byBjbGFpbSBmb3IgdGhlIG93bmVyc2hpcCBvZiB0aGUgZ2l2ZW4gdW5pY29ybiBJRAogICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgdG8gYmUgYXBwcm92ZWQgZm9yIHRoZSBnaXZlbiB1bmljb3JuIElECiAgICAqIEBwYXJhbSBfdW5pY29ybklkIHVpbnQyNTYgSUQgb2YgdGhlIHVuaWNvcm4gdG8gYmUgYXBwcm92ZWQKICAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF91bmljb3JuSWQpIHB1YmxpYyBvbmx5T3duZXJPZihfdW5pY29ybklkKSB7CiAgICAgICAgLy/QvNC+0LTQuNGE0LjQutCw0YLQvtGAIG9ubHlPd25lck9mINCz0LDRgNCw0L3RgtC40YDRg9C10YIsINGH0YLQviBvd25lciA9IG1zZy5zZW5kZXIKICAgICAgICAvLyAgICAgICAgYWRkcmVzcyBvd25lciA9IG93bmVyT2YoX3VuaWNvcm5JZCk7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gbXNnLnNlbmRlcik7CiAgICAgICAgaWYgKGFwcHJvdmVkRm9yKF91bmljb3JuSWQpICE9IGFkZHJlc3MoMCkgfHwgX3RvICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgdW5pY29ybkFwcHJvdmFsc1tfdW5pY29ybklkXSA9IF90bzsKICAgICAgICAgICAgZW1pdCBBcHByb3ZhbChtc2cuc2VuZGVyLCBfdG8sIF91bmljb3JuSWQpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICogQGRldiBDbGFpbXMgdGhlIG93bmVyc2hpcCBvZiBhIGdpdmVuIHVuaWNvcm4gSUQKICAgICogQHBhcmFtIF91bmljb3JuSWQgdWludDI1NiBJRCBvZiB0aGUgdW5pY29ybiBiZWluZyBjbGFpbWVkIGJ5IHRoZSBtc2cuc2VuZGVyCiAgICAqLwogICAgZnVuY3Rpb24gdGFrZU93bmVyc2hpcCh1aW50MjU2IF91bmljb3JuSWQpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShhbGxvd2FuY2UobXNnLnNlbmRlciwgX3VuaWNvcm5JZCkpOwogICAgICAgIGNsZWFyQXBwcm92YWxBbmRUcmFuc2Zlcihvd25lck9mKF91bmljb3JuSWQpLCBtc2cuc2VuZGVyLCBfdW5pY29ybklkKTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBUcmFuc2ZlcnMgdGhlIG93bmVyc2hpcCBvZiBhIGdpdmVuIHVuaWNvcm4gSUQgdG8gYW5vdGhlciBhZGRyZXNzCiAgICAqIEBwYXJhbSBfdG8gYWRkcmVzcyB0byByZWNlaXZlIHRoZSBvd25lcnNoaXAgb2YgdGhlIGdpdmVuIHVuaWNvcm4gSUQKICAgICogQHBhcmFtIF91bmljb3JuSWQgdWludDI1NiBJRCBvZiB0aGUgdW5pY29ybiB0byBiZSB0cmFuc2ZlcnJlZAogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF91bmljb3JuSWQpIHB1YmxpYyBvbmx5T3duZXJPZihfdW5pY29ybklkKSB7CiAgICAgICAgY2xlYXJBcHByb3ZhbEFuZFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3VuaWNvcm5JZCk7CiAgICB9CgoKICAgIC8qKgogICAgKiBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIGNsZWFyIGN1cnJlbnQgYXBwcm92YWwgYW5kIHRyYW5zZmVyIHRoZSBvd25lcnNoaXAgb2YgYSBnaXZlbiB1bmljb3JuIElECiAgICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdW5pY29ybnMgZnJvbQogICAgKiBAcGFyYW0gX3RvIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdGhlIHVuaWNvcm4gdG8KICAgICogQHBhcmFtIF91bmljb3JuSWQgdWludDI1NiBJRCBvZiB0aGUgdW5pY29ybiB0byBiZSB0cmFuc2ZlcnJlZAogICAgKi8KICAgIGZ1bmN0aW9uIGNsZWFyQXBwcm92YWxBbmRUcmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdW5pY29ybklkKSBpbnRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShvd25zKF9mcm9tLCBfdW5pY29ybklkKSk7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gb3duZXJPZihfdW5pY29ybklkKSk7CgogICAgICAgIGNsZWFyQXBwcm92YWwoX2Zyb20sIF91bmljb3JuSWQpOwogICAgICAgIHJlbW92ZVVuaWNvcm4oX2Zyb20sIF91bmljb3JuSWQpOwogICAgICAgIGFkZFVuaWNvcm4oX3RvLCBfdW5pY29ybklkKTsKICAgICAgICBlbWl0IFRyYW5zZmVyKF9mcm9tLCBfdG8sIF91bmljb3JuSWQpOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIGNsZWFyIGN1cnJlbnQgYXBwcm92YWwgb2YgYSBnaXZlbiB1bmljb3JuIElECiAgICAqIEBwYXJhbSBfdW5pY29ybklkIHVpbnQyNTYgSUQgb2YgdGhlIHVuaWNvcm4gdG8gYmUgdHJhbnNmZXJyZWQKICAgICovCiAgICBmdW5jdGlvbiBjbGVhckFwcHJvdmFsKGFkZHJlc3MgX293bmVyLCB1aW50MjU2IF91bmljb3JuSWQpIHByaXZhdGUgewogICAgICAgIHJlcXVpcmUob3ducyhfb3duZXIsIF91bmljb3JuSWQpKTsKICAgICAgICB1bmljb3JuQXBwcm92YWxzW191bmljb3JuSWRdID0gMDsKICAgICAgICBlbWl0IEFwcHJvdmFsKF9vd25lciwgMCwgX3VuaWNvcm5JZCk7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgSW50ZXJuYWwgZnVuY3Rpb24gdG8gYWRkIGEgdW5pY29ybiBJRCB0byB0aGUgbGlzdCBvZiBhIGdpdmVuIGFkZHJlc3MKICAgICogQHBhcmFtIF90byBhZGRyZXNzIHJlcHJlc2VudGluZyB0aGUgbmV3IG93bmVyIG9mIHRoZSBnaXZlbiB1bmljb3JuIElECiAgICAqIEBwYXJhbSBfdW5pY29ybklkIHVpbnQyNTYgSUQgb2YgdGhlIHVuaWNvcm4gdG8gYmUgYWRkZWQgdG8gdGhlIHVuaWNvcm5zIGxpc3Qgb2YgdGhlIGdpdmVuIGFkZHJlc3MKICAgICovCiAgICBmdW5jdGlvbiBhZGRVbmljb3JuKGFkZHJlc3MgX3RvLCB1aW50MjU2IF91bmljb3JuSWQpIHByaXZhdGUgewogICAgICAgIHJlcXVpcmUodW5pY29ybk93bmVyW191bmljb3JuSWRdID09IGFkZHJlc3MoMCkpOwogICAgICAgIHVuaWNvcm5Pd25lcltfdW5pY29ybklkXSA9IF90bzsKICAgICAgICAvLyAgICAgICAgdWludDI1NiBsZW5ndGggPSBiYWxhbmNlT2YoX3RvKTsKICAgICAgICB1aW50MjU2IGxlbmd0aCA9IG93bmVkVW5pY29ybnNbX3RvXS5sZW5ndGg7CiAgICAgICAgb3duZWRVbmljb3Juc1tfdG9dLnB1c2goX3VuaWNvcm5JZCk7CiAgICAgICAgb3duZWRVbmljb3Juc0luZGV4W191bmljb3JuSWRdID0gbGVuZ3RoOwogICAgICAgIHRvdGFsVW5pY29ybnMgPSB0b3RhbFVuaWNvcm5zLmFkZCgxKTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byByZW1vdmUgYSB1bmljb3JuIElEIGZyb20gdGhlIGxpc3Qgb2YgYSBnaXZlbiBhZGRyZXNzCiAgICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIHJlcHJlc2VudGluZyB0aGUgcHJldmlvdXMgb3duZXIgb2YgdGhlIGdpdmVuIHVuaWNvcm4gSUQKICAgICogQHBhcmFtIF91bmljb3JuSWQgdWludDI1NiBJRCBvZiB0aGUgdW5pY29ybiB0byBiZSByZW1vdmVkIGZyb20gdGhlIHVuaWNvcm5zIGxpc3Qgb2YgdGhlIGdpdmVuIGFkZHJlc3MKICAgICovCiAgICBmdW5jdGlvbiByZW1vdmVVbmljb3JuKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3VuaWNvcm5JZCkgcHJpdmF0ZSB7CiAgICAgICAgcmVxdWlyZShvd25zKF9mcm9tLCBfdW5pY29ybklkKSk7CgogICAgICAgIHVpbnQyNTYgdW5pY29ybkluZGV4ID0gb3duZWRVbmljb3Juc0luZGV4W191bmljb3JuSWRdOwogICAgICAgIC8vICAgICAgICB1aW50MjU2IGxhc3RVbmljb3JuSW5kZXggPSBiYWxhbmNlT2YoX2Zyb20pLnN1YigxKTsKICAgICAgICB1aW50MjU2IGxhc3RVbmljb3JuSW5kZXggPSBvd25lZFVuaWNvcm5zW19mcm9tXS5sZW5ndGguc3ViKDEpOwogICAgICAgIHVpbnQyNTYgbGFzdFVuaWNvcm4gPSBvd25lZFVuaWNvcm5zW19mcm9tXVtsYXN0VW5pY29ybkluZGV4XTsKCiAgICAgICAgdW5pY29ybk93bmVyW191bmljb3JuSWRdID0gMDsKICAgICAgICBvd25lZFVuaWNvcm5zW19mcm9tXVt1bmljb3JuSW5kZXhdID0gbGFzdFVuaWNvcm47CiAgICAgICAgb3duZWRVbmljb3Juc1tfZnJvbV1bbGFzdFVuaWNvcm5JbmRleF0gPSAwOwogICAgICAgIC8vIE5vdGUgdGhhdCB0aGlzIHdpbGwgaGFuZGxlIHNpbmdsZS1lbGVtZW50IGFycmF5cy4gSW4gdGhhdCBjYXNlLCBib3RoIHVuaWNvcm5JbmRleCBhbmQgbGFzdFVuaWNvcm5JbmRleCBhcmUgZ29pbmcgdG8KICAgICAgICAvLyBiZSB6ZXJvLiBUaGVuIHdlIGNhbiBtYWtlIHN1cmUgdGhhdCB3ZSB3aWxsIHJlbW92ZSBfdW5pY29ybklkIGZyb20gdGhlIG93bmVkVW5pY29ybnMgbGlzdCBzaW5jZSB3ZSBhcmUgZmlyc3Qgc3dhcHBpbmcKICAgICAgICAvLyB0aGUgbGFzdFVuaWNvcm4gdG8gdGhlIGZpcnN0IHBvc2l0aW9uLCBhbmQgdGhlbiBkcm9wcGluZyB0aGUgZWxlbWVudCBwbGFjZWQgaW4gdGhlIGxhc3QgcG9zaXRpb24gb2YgdGhlIGxpc3QKCiAgICAgICAgb3duZWRVbmljb3Juc1tfZnJvbV0ubGVuZ3RoLS07CiAgICAgICAgb3duZWRVbmljb3Juc0luZGV4W191bmljb3JuSWRdID0gMDsKICAgICAgICBvd25lZFVuaWNvcm5zSW5kZXhbbGFzdFVuaWNvcm5dID0gdW5pY29ybkluZGV4OwogICAgICAgIHRvdGFsVW5pY29ybnMgPSB0b3RhbFVuaWNvcm5zLnN1YigxKTsKCiAgICAgICAgLy9kZWxldGluZyBzYWxlIG9mZmVyLCBpZiBleGlzdHMKICAgICAgICAvL1RPRE8gY2hlY2sgaWYgY29udHJhY3QgZXhpc3RzPwogICAgICAgIC8vICAgICAgICBpZiAoYWRkcmVzcyh1bmljb3JuQnJlZWRpbmcpICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICB1bmljb3JuQnJlZWRpbmcuZGVsZXRlT2ZmZXIoX3VuaWNvcm5JZCk7CiAgICAgICAgdW5pY29ybkJyZWVkaW5nLmRlbGV0ZUh5YnJpZGl6YXRpb24oX3VuaWNvcm5JZCk7CiAgICAgICAgLy8gICAgICAgIH0KICAgIH0KCiAgICAvL3NwZWNpZmljCiAgICAvLyAgICBmdW5jdGlvbiBidXJuVW5pY29ybih1aW50MjU2IF91bmljb3JuSWQpIG9ubHlPd25lck9mKF91bmljb3JuSWQpIHB1YmxpYyAgewogICAgLy8gICAgICAgIGlmIChhcHByb3ZlZEZvcihfdW5pY29ybklkKSAhPSAwKSB7CiAgICAvLyAgICAgICAgICAgIGNsZWFyQXBwcm92YWwobXNnLnNlbmRlciwgX3VuaWNvcm5JZCk7CiAgICAvLyAgICAgICAgfQogICAgLy8gICAgICAgIHJlbW92ZVVuaWNvcm4obXNnLnNlbmRlciwgX3VuaWNvcm5JZCk7CiAgICAvLyAgICAgICAgLy9kZXN0cm95IHVuaWNvcm4gZGF0YQogICAgLy8gICAgICAgIGRlbGV0ZSB1bmljb3Juc1tfdW5pY29ybklkXTsKICAgIC8vICAgICAgICBlbWl0IFRyYW5zZmVyKG1zZy5zZW5kZXIsIDB4MCwgX3VuaWNvcm5JZCk7CiAgICAvLyAgICB9CgoKICAgIGZ1bmN0aW9uIGNyZWF0ZVVuaWNvcm4oYWRkcmVzcyBfb3duZXIpIG9ubHlCcmVlZGluZyBleHRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmVxdWlyZShfb3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgdWludDI1NiBfdW5pY29ybklkID0gbGFzdFVuaWNvcm5JZCsrOwogICAgICAgIGFkZFVuaWNvcm4oX293bmVyLCBfdW5pY29ybklkKTsKICAgICAgICAvL3N0b3JlIG5ldyB1bmljb3JuIGRhdGEKICAgICAgICB1bmljb3Juc1tfdW5pY29ybklkXSA9IFVuaWNvcm4oewogICAgICAgICAgICBnZW5lIDogbmV3IGJ5dGVzKDApLAogICAgICAgICAgICBiaXJ0aFRpbWUgOiB1aW50NjQobm93KSwKICAgICAgICAgICAgZnJlZXppbmdFbmRUaW1lIDogMCwKICAgICAgICAgICAgZnJlZXppbmdUb3VyRW5kVGltZTogMCwKICAgICAgICAgICAgbmFtZTogJycKICAgICAgICAgICAgfSk7CiAgICAgICAgZW1pdCBUcmFuc2ZlcigweDAsIF9vd25lciwgX3VuaWNvcm5JZCk7CiAgICAgICAgcmV0dXJuIF91bmljb3JuSWQ7CiAgICB9CgoKICAgIGZ1bmN0aW9uIG93bnMoYWRkcmVzcyBfY2xhaW1hbnQsIHVpbnQyNTYgX3VuaWNvcm5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBvd25lck9mKF91bmljb3JuSWQpID09IF9jbGFpbWFudCAmJiBvd25lck9mKF91bmljb3JuSWQpICE9IGFkZHJlc3MoMCk7CiAgICB9CgoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdW5pY29ybklkKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3ModGhpcykpOwogICAgICAgIHJlcXVpcmUoYWxsb3dhbmNlKG1zZy5zZW5kZXIsIF91bmljb3JuSWQpKTsKICAgICAgICBjbGVhckFwcHJvdmFsQW5kVHJhbnNmZXIoX2Zyb20sIF90bywgX3VuaWNvcm5JZCk7CiAgICB9CgoKICAgIGZ1bmN0aW9uIGZyb21IZXhDaGFyKHVpbnQ4IF9jKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgcmV0dXJuIF9jIC0gKF9jIDwgNTggPyA0OCA6IChfYyA8IDk3ID8gNTUgOiA4NykpOwogICAgfQoKCiAgICBmdW5jdGlvbiBnZXRVbmljb3JuR2VuQnl0ZSh1aW50IF91bmljb3JuSWQsIHVpbnQgX2J5dGVObykgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpIHsKICAgICAgICB1aW50IG4gPSBfYnl0ZU5vIDw8IDE7IC8vID0gX2J5dGVObyAqIDIKICAgICAgICAvLyAgICAgICAgcmVxdWlyZSh1bmljb3Juc1tfdW5pY29ybklkXS5nZW5lLmxlbmd0aCA+PSBuICsgMSk7CiAgICAgICAgaWYgKHVuaWNvcm5zW191bmljb3JuSWRdLmdlbmUubGVuZ3RoIDwgbiArIDEpIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmcm9tSGV4Q2hhcih1aW50OCh1bmljb3Juc1tfdW5pY29ybklkXS5nZW5lW25dKSkgPDwgNCB8IGZyb21IZXhDaGFyKHVpbnQ4KHVuaWNvcm5zW191bmljb3JuSWRdLmdlbmVbbiArIDFdKSk7CiAgICB9CgoKICAgIGZ1bmN0aW9uIHNldE5hbWUodWludDI1NiBfdW5pY29ybklkLCBzdHJpbmcgX25hbWUgKSBwdWJsaWMgb25seU93bmVyT2YoX3VuaWNvcm5JZCkgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGJ5dGVzIG1lbW9yeSB0bXAgPSBieXRlcyh1bmljb3Juc1tfdW5pY29ybklkXS5uYW1lKTsKICAgICAgICByZXF1aXJlKHRtcC5sZW5ndGggPT0gMCk7CgogICAgICAgIHVuaWNvcm5zW191bmljb3JuSWRdLm5hbWUgPSBfbmFtZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCgogICAgZnVuY3Rpb24gZ2V0R2VuKHVpbnQgX3VuaWNvcm5JZCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChieXRlcyl7CiAgICAgICAgcmV0dXJuIHVuaWNvcm5zW191bmljb3JuSWRdLmdlbmU7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0R2VuZSh1aW50IF91bmljb3JuSWQsIGJ5dGVzIF9nZW5lKSBvbmx5QmxhY2tCb3ggZXh0ZXJuYWwgIHsKICAgICAgICBpZiAodW5pY29ybnNbX3VuaWNvcm5JZF0uZ2VuZS5sZW5ndGggPT0gMCkgewogICAgICAgICAgICB1bmljb3Juc1tfdW5pY29ybklkXS5nZW5lID0gX2dlbmU7CiAgICAgICAgICAgIGVtaXQgVW5pY29ybkdlbmVTZXQoX3VuaWNvcm5JZCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHVwZGF0ZUdlbmUodWludCBfdW5pY29ybklkLCBieXRlcyBfZ2VuZSkgb25seUdlbmVMYWIgcHVibGljIHsKICAgICAgICByZXF1aXJlKHVuaWNvcm5BcHByb3ZhbHNGb3JHZW5lTGFiW191bmljb3JuSWRdKTsKICAgICAgICBkZWxldGUgdW5pY29ybkFwcHJvdmFsc0ZvckdlbmVMYWJbX3VuaWNvcm5JZF07CiAgICAgICAgdW5pY29ybnNbX3VuaWNvcm5JZF0uZ2VuZSA9IF9nZW5lOwogICAgICAgIGVtaXQgVW5pY29ybkdlbmVVcGRhdGUoX3VuaWNvcm5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZUZvckdlbmVMYWIodWludDI1NiBfdW5pY29ybklkKSBwdWJsaWMgb25seU93bmVyT2YoX3VuaWNvcm5JZCkgewogICAgICAgIHVuaWNvcm5BcHByb3ZhbHNGb3JHZW5lTGFiW191bmljb3JuSWRdID0gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBjbGVhckFwcHJvdmFsRm9yR2VuZUxhYih1aW50MjU2IF91bmljb3JuSWQpIHB1YmxpYyBvbmx5T3duZXJPZihfdW5pY29ybklkKSB7CiAgICAgICAgZGVsZXRlIHVuaWNvcm5BcHByb3ZhbHNGb3JHZW5lTGFiW191bmljb3JuSWRdOwogICAgfQoKICAgIC8vdHJhbnNmZXIgYnkgbWFya2V0CiAgICBmdW5jdGlvbiBtYXJrZXRUcmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdW5pY29ybklkKSBvbmx5QnJlZWRpbmcgZXh0ZXJuYWwgewogICAgICAgIGNsZWFyQXBwcm92YWxBbmRUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdW5pY29ybklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwbHVzRnJlZXppbmdUaW1lKHVpbnQgX3VuaWNvcm5JZCkgb25seUJyZWVkaW5nIGV4dGVybmFsICB7CiAgICAgICAgdW5pY29ybnNbX3VuaWNvcm5JZF0uZnJlZXppbmdFbmRUaW1lID0gdWludDY0KF9nZXRGcmVlemVUaW1lKGdldFVuaWNvcm5HZW5CeXRlKF91bmljb3JuSWQsIDE2MykpICsgbm93KTsKICAgICAgICBlbWl0IFVuaWNvcm5GcmVlemluZ1RpbWVTZXQoX3VuaWNvcm5JZCwgdW5pY29ybnNbX3VuaWNvcm5JZF0uZnJlZXppbmdFbmRUaW1lKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwbHVzVG91ckZyZWV6aW5nVGltZSh1aW50IF91bmljb3JuSWQpIG9ubHlCcmVlZGluZyBleHRlcm5hbCB7CiAgICAgICAgdW5pY29ybnNbX3VuaWNvcm5JZF0uZnJlZXppbmdUb3VyRW5kVGltZSA9IHVpbnQ2NChfZ2V0RnJlZXplVGltZShnZXRVbmljb3JuR2VuQnl0ZShfdW5pY29ybklkLCAxNjgpKSArIG5vdyk7CiAgICAgICAgZW1pdCBVbmljb3JuVG91ckZyZWV6aW5nVGltZVNldChfdW5pY29ybklkLCB1bmljb3Juc1tfdW5pY29ybklkXS5mcmVlemluZ1RvdXJFbmRUaW1lKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfZ2V0RnJlZXplVGltZSh1aW50OCBmcmVlemluZ0luZGV4KSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQgdGltZSkgewogICAgICAgIGZyZWV6aW5nSW5kZXggJT0gbWF4RnJlZXppbmdJbmRleDsKICAgICAgICB0aW1lID0gZnJlZXppbmdbZnJlZXppbmdJbmRleF07CiAgICAgICAgaWYgKGZyZWV6aW5nUGx1c0NvdW50W2ZyZWV6aW5nSW5kZXhdICE9IDApIHsKICAgICAgICAgICAgdGltZSArPSAodWludChibG9jay5ibG9ja2hhc2goYmxvY2subnVtYmVyIC0gMSkpICUgZnJlZXppbmdQbHVzQ291bnRbZnJlZXppbmdJbmRleF0pICogMSBob3VyczsKICAgICAgICB9CiAgICB9CgoKICAgIC8vY2hhbmdlIGZyZWV6aW5nIHRpbWUgZm9yIGNhbmR5CiAgICBmdW5jdGlvbiBtaW51c0ZyZWV6aW5nVGltZSh1aW50IF91bmljb3JuSWQsIHVpbnQ2NCBfdGltZSkgb25seUJyZWVkaW5nIHB1YmxpYyB7CiAgICAgICAgLy/QvdC1INC80LjQvdGD0YHRg9C10Lwg0L3QsCDRg9C20LUg0YDQsNC30LzQvtGA0L7QttC10L3QvdGL0YUg0LrQvtC90Y/RhQogICAgICAgIHJlcXVpcmUodW5pY29ybnNbX3VuaWNvcm5JZF0uZnJlZXppbmdFbmRUaW1lID4gbm93KTsKICAgICAgICAvL9C90LUg0LjRgdC/0L7Qu9GM0LfRg9C10Lwgc2FmZU1hdGgsINGCLtC6LiBzdWJGcmVlemluZ1RpbWUg0LIg0YLQtdC+0YDQuNC4INC90LUg0LTQvtC70LbQtdC9INCx0YvRgtGMINCx0L7Qu9GM0YjQtSBub3cgJSkKICAgICAgICB1bmljb3Juc1tfdW5pY29ybklkXS5mcmVlemluZ0VuZFRpbWUgLT0gX3RpbWU7CiAgICB9CgogICAgLy9jaGFuZ2UgdG91ciBmcmVlemluZyB0aW1lIGZvciBjYW5keQogICAgZnVuY3Rpb24gbWludXNUb3VyRnJlZXppbmdUaW1lKHVpbnQgX3VuaWNvcm5JZCwgdWludDY0IF90aW1lKSBvbmx5QnJlZWRpbmcgcHVibGljIHsKICAgICAgICAvL9C90LUg0LzQuNC90YPRgdGD0LXQvCDQvdCwINGD0LbQtSDRgNCw0LfQvNC+0YDQvtC20LXQvdC90YvRhSDQutC+0L3Rj9GFCiAgICAgICAgcmVxdWlyZSh1bmljb3Juc1tfdW5pY29ybklkXS5mcmVlemluZ1RvdXJFbmRUaW1lID4gbm93KTsKICAgICAgICAvL9C90LUg0LjRgdC/0L7Qu9GM0LfRg9C10Lwgc2FmZU1hdGgsINGCLtC6LiBzdWJUb3VyRnJlZXppbmdUaW1lINCyINGC0LXQvtGA0LjQuCDQvdC1INC00L7Qu9C20LXQvSDQsdGL0YLRjCDQsdC+0LvRjNGI0LUgbm93ICUpCiAgICAgICAgdW5pY29ybnNbX3VuaWNvcm5JZF0uZnJlZXppbmdUb3VyRW5kVGltZSAtPSBfdGltZTsKICAgIH0KCiAgICBmdW5jdGlvbiBpc1VuZnJlZXplZCh1aW50IF91bmljb3JuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gKHVuaWNvcm5zW191bmljb3JuSWRdLmJpcnRoVGltZSA+IDAgJiYgdW5pY29ybnNbX3VuaWNvcm5JZF0uZnJlZXppbmdFbmRUaW1lIDw9IHVpbnQ2NChub3cpKTsKICAgIH0KCiAgICBmdW5jdGlvbiBpc1RvdXJVbmZyZWV6ZWQodWludCBfdW5pY29ybklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuICh1bmljb3Juc1tfdW5pY29ybklkXS5iaXJ0aFRpbWUgPiAwICYmIHVuaWNvcm5zW191bmljb3JuSWRdLmZyZWV6aW5nVG91ckVuZFRpbWUgPD0gdWludDY0KG5vdykpOwogICAgfQoKfQoKY29udHJhY3QgVW5pY29yblRva2VuIGlzIFVuaWNvcm5CYXNlIHsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJVbmljb3JuR08iOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiVU5HIjsKCiAgICBmdW5jdGlvbiBVbmljb3JuVG9rZW4oYWRkcmVzcyBfdW5pY29ybk1hbmFnZW1lbnRBZGRyZXNzKSBVbmljb3JuQWNjZXNzQ29udHJvbChfdW5pY29ybk1hbmFnZW1lbnRBZGRyZXNzKSBwdWJsaWMgewoKICAgIH0KCiAgICBmdW5jdGlvbiBpbml0KCkgb25seU1hbmFnZW1lbnQgd2hlblBhdXNlZCBleHRlcm5hbCB7CiAgICAgICAgdW5pY29ybkJyZWVkaW5nID0gVW5pY29ybkJyZWVkaW5nSW50ZXJmYWNlKHVuaWNvcm5NYW5hZ2VtZW50LnVuaWNvcm5CcmVlZGluZ0FkZHJlc3MoKSk7CiAgICB9CgogICAgZnVuY3Rpb24oKSBwdWJsaWMgewoKICAgIH0KfQ=='.
	

]
