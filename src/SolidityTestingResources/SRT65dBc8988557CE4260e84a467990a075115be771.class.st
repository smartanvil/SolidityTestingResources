Class {
	#name : #SRT65dBc8988557CE4260e84a467990a075115be771,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT65dBc8988557CE4260e84a467990a075115be771 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjsKCi8qKgogKiBAbm90aWNlIERlY2xhcmVzIGEgY29udHJhY3QgdGhhdCBjYW4gaGF2ZSBhbiBvd25lci4KICovCmNvbnRyYWN0IE93bmVkSSB7CiAgICBldmVudCBMb2dPd25lckNoYW5nZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgogICAgZnVuY3Rpb24gZ2V0T3duZXIoKQogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoYWRkcmVzcyk7CgogICAgZnVuY3Rpb24gc2V0T3duZXIoYWRkcmVzcyBuZXdPd25lcikKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpOyAKfQoKLyoqCiAqIEBub3RpY2UgRGVmaW5lcyBhIGNvbnRyYWN0IHRoYXQgY2FuIGhhdmUgYW4gb3duZXIuCiAqLwpjb250cmFjdCBPd25lZCBpcyBPd25lZEkgewogICAgLyoqCiAgICAgKiBAZGV2IE1hZGUgcHJpdmF0ZSB0byBwcm90ZWN0IGFnYWluc3QgY2hpbGQgY29udHJhY3Qgc2V0dGluZyBpdCB0byAwIGJ5IG1pc3Rha2UuCiAgICAgKi8KICAgIGFkZHJlc3MgcHJpdmF0ZSBvd25lcjsKCiAgICBmdW5jdGlvbiBPd25lZCgpIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgbW9kaWZpZXIgZnJvbU93bmVyIHsKICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lcikgewogICAgICAgICAgICB0aHJvdzsKICAgICAgICB9CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRPd25lcigpCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChhZGRyZXNzKSB7CiAgICAgICAgcmV0dXJuIG93bmVyOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldE93bmVyKGFkZHJlc3MgbmV3T3duZXIpCiAgICAgICAgZnJvbU93bmVyIAogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGlmIChuZXdPd25lciA9PSAwKSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KICAgICAgICBpZiAob3duZXIgIT0gbmV3T3duZXIpIHsKICAgICAgICAgICAgTG9nT3duZXJDaGFuZ2VkKG93bmVyLCBuZXdPd25lcik7CiAgICAgICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICAgICAgfQogICAgICAgIHN1Y2Nlc3MgPSB0cnVlOwogICAgfQp9Cgpjb250cmFjdCBXaXRoQmVuZWZpY2lhcnkgaXMgT3duZWQgewogICAgLyoqCiAgICAgKiBAbm90aWNlIEFkZHJlc3MgdGhhdCBpcyBmb3J3YXJkZWQgYWxsIHZhbHVlLgogICAgICogQGRldiBNYWRlIHByaXZhdGUgdG8gcHJvdGVjdCBhZ2FpbnN0IGNoaWxkIGNvbnRyYWN0IHNldHRpbmcgaXQgdG8gMCBieSBtaXN0YWtlLgogICAgICovCiAgICBhZGRyZXNzIHByaXZhdGUgYmVuZWZpY2lhcnk7CiAgICAKICAgIGV2ZW50IExvZ0JlbmVmaWNpYXJ5U2V0KGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c0JlbmVmaWNpYXJ5LCBhZGRyZXNzIGluZGV4ZWQgbmV3QmVuZWZpY2lhcnkpOwoKICAgIGZ1bmN0aW9uIFdpdGhCZW5lZmljaWFyeShhZGRyZXNzIF9iZW5lZmljaWFyeSkgcGF5YWJsZSB7CiAgICAgICAgaWYgKF9iZW5lZmljaWFyeSA9PSAwKSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KICAgICAgICBiZW5lZmljaWFyeSA9IF9iZW5lZmljaWFyeTsKICAgICAgICBpZiAobXNnLnZhbHVlID4gMCkgewogICAgICAgICAgICBhc3luY1NlbmQoYmVuZWZpY2lhcnksIG1zZy52YWx1ZSk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGFzeW5jU2VuZChhZGRyZXNzIGRlc3QsIHVpbnQgYW1vdW50KSBpbnRlcm5hbDsKCiAgICBmdW5jdGlvbiBnZXRCZW5lZmljaWFyeSgpCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChhZGRyZXNzKSB7CiAgICAgICAgcmV0dXJuIGJlbmVmaWNpYXJ5OwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEJlbmVmaWNpYXJ5KGFkZHJlc3MgbmV3QmVuZWZpY2lhcnkpCiAgICAgICAgZnJvbU93bmVyIAogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGlmIChuZXdCZW5lZmljaWFyeSA9PSAwKSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KICAgICAgICBpZiAoYmVuZWZpY2lhcnkgIT0gbmV3QmVuZWZpY2lhcnkpIHsKICAgICAgICAgICAgTG9nQmVuZWZpY2lhcnlTZXQoYmVuZWZpY2lhcnksIG5ld0JlbmVmaWNpYXJ5KTsKICAgICAgICAgICAgYmVuZWZpY2lhcnkgPSBuZXdCZW5lZmljaWFyeTsKICAgICAgICB9CiAgICAgICAgc3VjY2VzcyA9IHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gKCkgcGF5YWJsZSB7CiAgICAgICAgYXN5bmNTZW5kKGJlbmVmaWNpYXJ5LCBtc2cudmFsdWUpOwogICAgfQp9Cgpjb250cmFjdCBXaXRoRmVlIGlzIFdpdGhCZW5lZmljaWFyeSB7CiAgICAvLyBAbm90aWNlIENvbnRyYWN0cyBhc2tpbmcgZm9yIGEgY29uZmlybWF0aW9uIG9mIGEgY2VydGlmaWNhdGlvbiBuZWVkIHRvIHBhc3MgdGhpcyBmZWUuCiAgICB1aW50MjU2IHByaXZhdGUgcXVlcnlGZWU7CgogICAgZXZlbnQgTG9nUXVlcnlGZWVTZXQodWludDI1NiBwcmV2aW91c1F1ZXJ5RmVlLCB1aW50MjU2IG5ld1F1ZXJ5RmVlKTsKCiAgICBmdW5jdGlvbiBXaXRoRmVlKAogICAgICAgICAgICBhZGRyZXNzIGJlbmVmaWNpYXJ5LAogICAgICAgICAgICB1aW50MjU2IF9xdWVyeUZlZSkKICAgICAgICBXaXRoQmVuZWZpY2lhcnkoYmVuZWZpY2lhcnkpIHsKICAgICAgICBxdWVyeUZlZSA9IF9xdWVyeUZlZTsKICAgIH0KCiAgICBtb2RpZmllciByZXF1ZXN0RmVlUGFpZCB7CiAgICAgICAgaWYgKG1zZy52YWx1ZSA8IHF1ZXJ5RmVlKSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KICAgICAgICBhc3luY1NlbmQoZ2V0QmVuZWZpY2lhcnkoKSwgbXNnLnZhbHVlKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFF1ZXJ5RmVlKCkKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gcXVlcnlGZWU7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0UXVlcnlGZWUodWludDI1NiBuZXdRdWVyeUZlZSkKICAgICAgICBmcm9tT3duZXIKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBpZiAocXVlcnlGZWUgIT0gbmV3UXVlcnlGZWUpIHsKICAgICAgICAgICAgTG9nUXVlcnlGZWVTZXQocXVlcnlGZWUsIG5ld1F1ZXJ5RmVlKTsKICAgICAgICAgICAgcXVlcnlGZWUgPSBuZXdRdWVyeUZlZTsKICAgICAgICB9CiAgICAgICAgc3VjY2VzcyA9IHRydWU7CiAgICB9Cn0KCi8qCiAqIEBub3RpY2UgQmFzZSBjb250cmFjdCBzdXBwb3J0aW5nIGFzeW5jIHNlbmQgZm9yIHB1bGwgcGF5bWVudHMuCiAqIEluaGVyaXQgZnJvbSB0aGlzIGNvbnRyYWN0IGFuZCB1c2UgYXN5bmNTZW5kIGluc3RlYWQgb2Ygc2VuZC4KICogaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXAtc29saWRpdHkvYmxvYi9tYXN0ZXIvY29udHJhY3RzL1B1bGxQYXltZW50Q2FwYWJsZS5zb2wKICovCmNvbnRyYWN0IFB1bGxQYXltZW50Q2FwYWJsZSB7CiAgICB1aW50MjU2IHByaXZhdGUgdG90YWxCYWxhbmNlOwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHByaXZhdGUgcGF5bWVudHM7CgogICAgZXZlbnQgTG9nUGF5bWVudFJlY2VpdmVkKGFkZHJlc3MgaW5kZXhlZCBkZXN0LCB1aW50MjU2IGFtb3VudCk7CgogICAgZnVuY3Rpb24gUHVsbFBheW1lbnRDYXBhYmxlKCkgewogICAgICAgIGlmICgwIDwgdGhpcy5iYWxhbmNlKSB7CiAgICAgICAgICAgIGFzeW5jU2VuZChtc2cuc2VuZGVyLCB0aGlzLmJhbGFuY2UpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBzdG9yZSBzZW50IGFtb3VudCBhcyBjcmVkaXQgdG8gYmUgcHVsbGVkLCBjYWxsZWQgYnkgcGF5ZXIKICAgIGZ1bmN0aW9uIGFzeW5jU2VuZChhZGRyZXNzIGRlc3QsIHVpbnQyNTYgYW1vdW50KSBpbnRlcm5hbCB7CiAgICAgICAgaWYgKGFtb3VudCA+IDApIHsKICAgICAgICAgICAgdG90YWxCYWxhbmNlICs9IGFtb3VudDsKICAgICAgICAgICAgcGF5bWVudHNbZGVzdF0gKz0gYW1vdW50OwogICAgICAgICAgICBMb2dQYXltZW50UmVjZWl2ZWQoZGVzdCwgYW1vdW50KTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0VG90YWxCYWxhbmNlKCkKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gdG90YWxCYWxhbmNlOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFBheW1lbnRPZihhZGRyZXNzIGJlbmVmaWNpYXJ5KSAKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gcGF5bWVudHNbYmVuZWZpY2lhcnldOwogICAgfQoKICAgIC8vIHdpdGhkcmF3IGFjY3VtdWxhdGVkIGJhbGFuY2UsIGNhbGxlZCBieSBwYXllZQogICAgZnVuY3Rpb24gd2l0aGRyYXdQYXltZW50cygpCiAgICAgICAgZXh0ZXJuYWwgCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgdWludDI1NiBwYXltZW50ID0gcGF5bWVudHNbbXNnLnNlbmRlcl07CiAgICAgICAgcGF5bWVudHNbbXNnLnNlbmRlcl0gPSAwOwogICAgICAgIHRvdGFsQmFsYW5jZSAtPSBwYXltZW50OwogICAgICAgIGlmICghbXNnLnNlbmRlci5jYWxsLnZhbHVlKHBheW1lbnQpKCkpIHsKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgfQogICAgICAgIHN1Y2Nlc3MgPSB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGZpeEJhbGFuY2UoKQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgZnVuY3Rpb24gZml4QmFsYW5jZUludGVybmFsKGFkZHJlc3MgZGVzdCkKICAgICAgICBpbnRlcm5hbAogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGlmICh0b3RhbEJhbGFuY2UgPCB0aGlzLmJhbGFuY2UpIHsKICAgICAgICAgICAgdWludDI1NiBhbW91bnQgPSB0aGlzLmJhbGFuY2UgLSB0b3RhbEJhbGFuY2U7CiAgICAgICAgICAgIHBheW1lbnRzW2Rlc3RdICs9IGFtb3VudDsKICAgICAgICAgICAgTG9nUGF5bWVudFJlY2VpdmVkKGRlc3QsIGFtb3VudCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9CgovLyBAbm90aWNlIEludGVyZmFjZSBmb3IgYSBjZXJ0aWZpZXIgZGF0YWJhc2UKY29udHJhY3QgQ2VydGlmaWVyRGJJIHsKICAgIGV2ZW50IExvZ0NlcnRpZmllckFkZGVkKGFkZHJlc3MgaW5kZXhlZCBjZXJ0aWZpZXIpOwoKICAgIGV2ZW50IExvZ0NlcnRpZmllclJlbW92ZWQoYWRkcmVzcyBpbmRleGVkIGNlcnRpZmllcik7CgogICAgZnVuY3Rpb24gYWRkQ2VydGlmaWVyKGFkZHJlc3MgY2VydGlmaWVyKQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgZnVuY3Rpb24gcmVtb3ZlQ2VydGlmaWVyKGFkZHJlc3MgY2VydGlmaWVyKQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgZnVuY3Rpb24gZ2V0Q2VydGlmaWVyc0NvdW50KCkKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQgY291bnQpOwoKICAgIGZ1bmN0aW9uIGdldENlcnRpZmllclN0YXR1cyhhZGRyZXNzIGNlcnRpZmllckFkZHIpCiAgICAgICAgY29uc3RhbnQgCiAgICAgICAgcmV0dXJucyAoYm9vbCBhdXRob3Jpc2VkLCB1aW50MjU2IGluZGV4KTsKCiAgICBmdW5jdGlvbiBnZXRDZXJ0aWZpZXJBdEluZGV4KHVpbnQyNTYgaW5kZXgpCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChhZGRyZXNzKTsKCiAgICBmdW5jdGlvbiBpc0NlcnRpZmllcihhZGRyZXNzIGNlcnRpZmllcikKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKGJvb2wgaXNJbmRlZWQpOwp9Cgpjb250cmFjdCBDZXJ0aWZpY2F0aW9uRGJJIHsKICAgIGV2ZW50IExvZ0NlcnRpZmllckRiQ2hhbmdlZCgKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNDZXJ0aWZpZXJEYiwKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgbmV3Q2VydGlmaWVyRGIpOwoKICAgIGV2ZW50IExvZ1N0dWRlbnRDZXJ0aWZpZWQoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIHN0dWRlbnQsIHVpbnQgdGltZXN0YW1wLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBjZXJ0aWZpZXIsIGJ5dGVzMzIgaW5kZXhlZCBkb2N1bWVudCk7CgogICAgZXZlbnQgTG9nU3R1ZGVudFVuY2VydGlmaWVkKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBzdHVkZW50LCB1aW50IHRpbWVzdGFtcCwKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgY2VydGlmaWVyKTsKCiAgICBldmVudCBMb2dDZXJ0aWZpY2F0aW9uRG9jdW1lbnRBZGRlZCgKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgc3R1ZGVudCwgYnl0ZXMzMiBpbmRleGVkIGRvY3VtZW50KTsKCiAgICBldmVudCBMb2dDZXJ0aWZpY2F0aW9uRG9jdW1lbnRSZW1vdmVkKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBzdHVkZW50LCBieXRlczMyIGluZGV4ZWQgZG9jdW1lbnQpOwoKICAgIGZ1bmN0aW9uIGdldENlcnRpZmllckRiKCkKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKGFkZHJlc3MpOwoKICAgIGZ1bmN0aW9uIHNldENlcnRpZmllckRiKGFkZHJlc3MgbmV3Q2VydGlmaWVyRGIpCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCiAgICBmdW5jdGlvbiBjZXJ0aWZ5KGFkZHJlc3Mgc3R1ZGVudCwgYnl0ZXMzMiBkb2N1bWVudCkKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIGZ1bmN0aW9uIHVuY2VydGlmeShhZGRyZXNzIHN0dWRlbnQpCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCiAgICBmdW5jdGlvbiBhZGRDZXJ0aWZpY2F0aW9uRG9jdW1lbnQoYWRkcmVzcyBzdHVkZW50LCBieXRlczMyIGRvY3VtZW50KQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgZnVuY3Rpb24gYWRkQ2VydGlmaWNhdGlvbkRvY3VtZW50VG9TZWxmKGJ5dGVzMzIgZG9jdW1lbnQpCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCiAgICBmdW5jdGlvbiByZW1vdmVDZXJ0aWZpY2F0aW9uRG9jdW1lbnQoYWRkcmVzcyBzdHVkZW50LCBieXRlczMyIGRvY3VtZW50KQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgZnVuY3Rpb24gcmVtb3ZlQ2VydGlmaWNhdGlvbkRvY3VtZW50RnJvbVNlbGYoYnl0ZXMzMiBkb2N1bWVudCkKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIGZ1bmN0aW9uIGdldENlcnRpZmllZFN0dWRlbnRzQ291bnQoKQogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCBjb3VudCk7CgogICAgZnVuY3Rpb24gZ2V0Q2VydGlmaWVkU3R1ZGVudEF0SW5kZXgodWludCBpbmRleCkKICAgICAgICBwYXlhYmxlCiAgICAgICAgcmV0dXJucyAoYWRkcmVzcyBzdHVkZW50KTsKCiAgICBmdW5jdGlvbiBnZXRDZXJ0aWZpY2F0aW9uKGFkZHJlc3Mgc3R1ZGVudCkKICAgICAgICBwYXlhYmxlCiAgICAgICAgcmV0dXJucyAoYm9vbCBjZXJ0aWZpZWQsIHVpbnQgdGltZXN0YW1wLCBhZGRyZXNzIGNlcnRpZmllciwgdWludCBkb2N1bWVudENvdW50KTsKCiAgICBmdW5jdGlvbiBpc0NlcnRpZmllZChhZGRyZXNzIHN0dWRlbnQpCiAgICAgICAgcGF5YWJsZQogICAgICAgIHJldHVybnMgKGJvb2wgaXNJbmRlZWQpOwoKICAgIGZ1bmN0aW9uIGdldENlcnRpZmljYXRpb25Eb2N1bWVudEF0SW5kZXgoYWRkcmVzcyBzdHVkZW50LCB1aW50MjU2IGluZGV4KQogICAgICAgIHBheWFibGUKICAgICAgICByZXR1cm5zIChieXRlczMyIGRvY3VtZW50KTsKCiAgICBmdW5jdGlvbiBpc0NlcnRpZmljYXRpb24oYWRkcmVzcyBzdHVkZW50LCBieXRlczMyIGRvY3VtZW50KQogICAgICAgIHBheWFibGUKICAgICAgICByZXR1cm5zIChib29sIGlzSW5kZWVkKTsKfQoKY29udHJhY3QgQ2VydGlmaWNhdGlvbkRiIGlzIENlcnRpZmljYXRpb25EYkksIFdpdGhGZWUsIFB1bGxQYXltZW50Q2FwYWJsZSB7CiAgICAvLyBAbm90aWNlIFdoZXJlIHdlIGNoZWNrIGZvciBjZXJ0aWZpZXJzLgogICAgQ2VydGlmaWVyRGJJIHByaXZhdGUgY2VydGlmaWVyRGI7CgogICAgc3RydWN0IERvY3VtZW50U3RhdHVzIHsKICAgICAgICBib29sIGlzVmFsaWQ7CiAgICAgICAgdWludDI1NiBpbmRleDsKICAgIH0KCiAgICBzdHJ1Y3QgQ2VydGlmaWNhdGlvbiB7CiAgICAgICAgYm9vbCBjZXJ0aWZpZWQ7CiAgICAgICAgdWludDI1NiB0aW1lc3RhbXA7CiAgICAgICAgYWRkcmVzcyBjZXJ0aWZpZXI7CiAgICAgICAgbWFwcGluZyhieXRlczMyID0+IERvY3VtZW50U3RhdHVzKSBkb2N1bWVudFN0YXR1c2VzOwogICAgICAgIGJ5dGVzMzJbXSBkb2N1bWVudHM7CiAgICAgICAgdWludDI1NiBpbmRleDsKICAgIH0KCiAgICAvLyBAbm90aWNlIEFkZHJlc3Mgb2YgY2VydGlmaWVkIHN0dWRlbnRzLgogICAgbWFwcGluZyhhZGRyZXNzID0+IENlcnRpZmljYXRpb24pIHN0dWRlbnRDZXJ0aWZpY2F0aW9uczsKICAgIC8vIEBub3RpY2UgVGhlIHBvdGVudGlhbGx5IGxvbmcgbGlzdCBvZiBhbGwgY2VydGlmaWVkIHN0dWRlbnRzLgogICAgYWRkcmVzc1tdIGNlcnRpZmllZFN0dWRlbnRzOwoKICAgIGZ1bmN0aW9uIENlcnRpZmljYXRpb25EYigKICAgICAgICAgICAgYWRkcmVzcyBiZW5lZmljaWFyeSwKICAgICAgICAgICAgdWludDI1NiBjZXJ0aWZpY2F0aW9uUXVlcnlGZWUsCiAgICAgICAgICAgIGFkZHJlc3MgX2NlcnRpZmllckRiKQogICAgICAgICAgICBXaXRoRmVlKGJlbmVmaWNpYXJ5LCBjZXJ0aWZpY2F0aW9uUXVlcnlGZWUpIHsKICAgICAgICBpZiAoX2NlcnRpZmllckRiID09IDApIHsKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgfQogICAgICAgIGNlcnRpZmllckRiID0gQ2VydGlmaWVyRGJJKF9jZXJ0aWZpZXJEYik7CiAgICB9CgogICAgbW9kaWZpZXIgZnJvbUNlcnRpZmllciB7CiAgICAgICAgaWYgKCFjZXJ0aWZpZXJEYi5pc0NlcnRpZmllcihtc2cuc2VuZGVyKSkgewogICAgICAgICAgICB0aHJvdzsKICAgICAgICB9CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRDZXJ0aWZpZXJEYigpCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChhZGRyZXNzKSB7CiAgICAgICAgcmV0dXJuIGNlcnRpZmllckRiOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldENlcnRpZmllckRiKGFkZHJlc3MgbmV3Q2VydGlmaWVyRGIpCiAgICAgICAgZnJvbU93bmVyCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgaWYgKG5ld0NlcnRpZmllckRiID09IDApIHsKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgfQogICAgICAgIGlmIChjZXJ0aWZpZXJEYiAhPSBuZXdDZXJ0aWZpZXJEYikgewogICAgICAgICAgICBMb2dDZXJ0aWZpZXJEYkNoYW5nZWQoY2VydGlmaWVyRGIsIG5ld0NlcnRpZmllckRiKTsKICAgICAgICAgICAgY2VydGlmaWVyRGIgPSBDZXJ0aWZpZXJEYkkobmV3Q2VydGlmaWVyRGIpOwogICAgICAgIH0KICAgICAgICBzdWNjZXNzID0gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBjZXJ0aWZ5KGFkZHJlc3Mgc3R1ZGVudCwgYnl0ZXMzMiBkb2N1bWVudCkgCiAgICAgICAgZnJvbUNlcnRpZmllcgogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGlmIChzdHVkZW50ID09IDAgfHwgc3R1ZGVudENlcnRpZmljYXRpb25zW3N0dWRlbnRdLmNlcnRpZmllZCkgewogICAgICAgICAgICB0aHJvdzsKICAgICAgICB9CiAgICAgICAgYm9vbCBkb2N1bWVudEV4aXN0cyA9IGRvY3VtZW50ICE9IDA7CiAgICAgICAgc3R1ZGVudENlcnRpZmljYXRpb25zW3N0dWRlbnRdID0gQ2VydGlmaWNhdGlvbih7CiAgICAgICAgICAgIGNlcnRpZmllZDogdHJ1ZSwKICAgICAgICAgICAgdGltZXN0YW1wOiBub3csCiAgICAgICAgICAgIGNlcnRpZmllcjogbXNnLnNlbmRlciwKICAgICAgICAgICAgZG9jdW1lbnRzOiBuZXcgYnl0ZXMzMltdKDApLAogICAgICAgICAgICBpbmRleDogY2VydGlmaWVkU3R1ZGVudHMubGVuZ3RoCiAgICAgICAgfSk7CiAgICAgICAgaWYgKGRvY3VtZW50RXhpc3RzKSB7CiAgICAgICAgICAgIHN0dWRlbnRDZXJ0aWZpY2F0aW9uc1tzdHVkZW50XS5kb2N1bWVudFN0YXR1c2VzW2RvY3VtZW50XSA9IERvY3VtZW50U3RhdHVzKHsKICAgICAgICAgICAgICAgIGlzVmFsaWQ6IHRydWUsCiAgICAgICAgICAgICAgICBpbmRleDogc3R1ZGVudENlcnRpZmljYXRpb25zW3N0dWRlbnRdLmRvY3VtZW50cy5sZW5ndGgKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHN0dWRlbnRDZXJ0aWZpY2F0aW9uc1tzdHVkZW50XS5kb2N1bWVudHMucHVzaChkb2N1bWVudCk7CiAgICAgICAgfQogICAgICAgIGNlcnRpZmllZFN0dWRlbnRzLnB1c2goc3R1ZGVudCk7CiAgICAgICAgTG9nU3R1ZGVudENlcnRpZmllZChzdHVkZW50LCBub3csIG1zZy5zZW5kZXIsIGRvY3VtZW50KTsKICAgICAgICBzdWNjZXNzID0gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiB1bmNlcnRpZnkoYWRkcmVzcyBzdHVkZW50KSAKICAgICAgICBmcm9tQ2VydGlmaWVyIAogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGlmICghc3R1ZGVudENlcnRpZmljYXRpb25zW3N0dWRlbnRdLmNlcnRpZmllZAogICAgICAgICAgICAvLyBZb3UgbmVlZCB0byB1bmNlcnRpZnkgYWxsIGRvY3VtZW50cyBmaXJzdAogICAgICAgICAgICB8fCBzdHVkZW50Q2VydGlmaWNhdGlvbnNbc3R1ZGVudF0uZG9jdW1lbnRzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgfQogICAgICAgIHVpbnQyNTYgaW5kZXggPSBzdHVkZW50Q2VydGlmaWNhdGlvbnNbc3R1ZGVudF0uaW5kZXg7CiAgICAgICAgZGVsZXRlIHN0dWRlbnRDZXJ0aWZpY2F0aW9uc1tzdHVkZW50XTsKICAgICAgICBpZiAoY2VydGlmaWVkU3R1ZGVudHMubGVuZ3RoID4gMSkgewogICAgICAgICAgICBjZXJ0aWZpZWRTdHVkZW50c1tpbmRleF0gPSBjZXJ0aWZpZWRTdHVkZW50c1tjZXJ0aWZpZWRTdHVkZW50cy5sZW5ndGggLSAxXTsKICAgICAgICAgICAgc3R1ZGVudENlcnRpZmljYXRpb25zW2NlcnRpZmllZFN0dWRlbnRzW2luZGV4XV0uaW5kZXggPSBpbmRleDsKICAgICAgICB9CiAgICAgICAgY2VydGlmaWVkU3R1ZGVudHMubGVuZ3RoLS07CiAgICAgICAgTG9nU3R1ZGVudFVuY2VydGlmaWVkKHN0dWRlbnQsIG5vdywgbXNnLnNlbmRlcik7CiAgICAgICAgc3VjY2VzcyA9IHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkQ2VydGlmaWNhdGlvbkRvY3VtZW50KGFkZHJlc3Mgc3R1ZGVudCwgYnl0ZXMzMiBkb2N1bWVudCkKICAgICAgICBmcm9tQ2VydGlmaWVyCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgc3VjY2VzcyA9IGFkZENlcnRpZmljYXRpb25Eb2N1bWVudEludGVybmFsKHN0dWRlbnQsIGRvY3VtZW50KTsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRDZXJ0aWZpY2F0aW9uRG9jdW1lbnRUb1NlbGYoYnl0ZXMzMiBkb2N1bWVudCkKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBzdWNjZXNzID0gYWRkQ2VydGlmaWNhdGlvbkRvY3VtZW50SW50ZXJuYWwobXNnLnNlbmRlciwgZG9jdW1lbnQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZENlcnRpZmljYXRpb25Eb2N1bWVudEludGVybmFsKGFkZHJlc3Mgc3R1ZGVudCwgYnl0ZXMzMiBkb2N1bWVudCkKICAgICAgICBpbnRlcm5hbAogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGlmICghc3R1ZGVudENlcnRpZmljYXRpb25zW3N0dWRlbnRdLmNlcnRpZmllZAogICAgICAgICAgICB8fCBkb2N1bWVudCA9PSAwKSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KICAgICAgICBDZXJ0aWZpY2F0aW9uIGNlcnRpZmljYXRpb24gPSBzdHVkZW50Q2VydGlmaWNhdGlvbnNbc3R1ZGVudF07CiAgICAgICAgaWYgKCFjZXJ0aWZpY2F0aW9uLmRvY3VtZW50U3RhdHVzZXNbZG9jdW1lbnRdLmlzVmFsaWQpIHsKICAgICAgICAgICAgY2VydGlmaWNhdGlvbi5kb2N1bWVudFN0YXR1c2VzW2RvY3VtZW50XSA9IERvY3VtZW50U3RhdHVzKHsKICAgICAgICAgICAgICAgIGlzVmFsaWQ6ICB0cnVlLAogICAgICAgICAgICAgICAgaW5kZXg6IGNlcnRpZmljYXRpb24uZG9jdW1lbnRzLmxlbmd0aAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgY2VydGlmaWNhdGlvbi5kb2N1bWVudHMucHVzaChkb2N1bWVudCk7CiAgICAgICAgICAgIExvZ0NlcnRpZmljYXRpb25Eb2N1bWVudEFkZGVkKHN0dWRlbnQsIGRvY3VtZW50KTsKICAgICAgICB9CiAgICAgICAgc3VjY2VzcyA9IHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gcmVtb3ZlQ2VydGlmaWNhdGlvbkRvY3VtZW50KGFkZHJlc3Mgc3R1ZGVudCwgYnl0ZXMzMiBkb2N1bWVudCkKICAgICAgICBmcm9tQ2VydGlmaWVyCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgc3VjY2VzcyA9IHJlbW92ZUNlcnRpZmljYXRpb25Eb2N1bWVudEludGVybmFsKHN0dWRlbnQsIGRvY3VtZW50KTsKICAgIH0KCiAgICBmdW5jdGlvbiByZW1vdmVDZXJ0aWZpY2F0aW9uRG9jdW1lbnRGcm9tU2VsZihieXRlczMyIGRvY3VtZW50KQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHN1Y2Nlc3MgPSByZW1vdmVDZXJ0aWZpY2F0aW9uRG9jdW1lbnRJbnRlcm5hbChtc2cuc2VuZGVyLCBkb2N1bWVudCk7CiAgICB9CgogICAgZnVuY3Rpb24gcmVtb3ZlQ2VydGlmaWNhdGlvbkRvY3VtZW50SW50ZXJuYWwoYWRkcmVzcyBzdHVkZW50LCBieXRlczMyIGRvY3VtZW50KQogICAgICAgIGludGVybmFsCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgaWYgKCFzdHVkZW50Q2VydGlmaWNhdGlvbnNbc3R1ZGVudF0uY2VydGlmaWVkKSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KICAgICAgICBDZXJ0aWZpY2F0aW9uIGNlcnRpZmljYXRpb24gPSBzdHVkZW50Q2VydGlmaWNhdGlvbnNbc3R1ZGVudF07CiAgICAgICAgaWYgKGNlcnRpZmljYXRpb24uZG9jdW1lbnRTdGF0dXNlc1tkb2N1bWVudF0uaXNWYWxpZCkgewogICAgICAgICAgICB1aW50MjU2IGluZGV4ID0gY2VydGlmaWNhdGlvbi5kb2N1bWVudFN0YXR1c2VzW2RvY3VtZW50XS5pbmRleDsKICAgICAgICAgICAgZGVsZXRlIGNlcnRpZmljYXRpb24uZG9jdW1lbnRTdGF0dXNlc1tkb2N1bWVudF07CiAgICAgICAgICAgIGlmIChjZXJ0aWZpY2F0aW9uLmRvY3VtZW50cy5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgICAgICBjZXJ0aWZpY2F0aW9uLmRvY3VtZW50c1tpbmRleF0gPQogICAgICAgICAgICAgICAgICAgIGNlcnRpZmljYXRpb24uZG9jdW1lbnRzW2NlcnRpZmljYXRpb24uZG9jdW1lbnRzLmxlbmd0aCAtIDFdOwogICAgICAgICAgICAgICAgY2VydGlmaWNhdGlvbi5kb2N1bWVudFN0YXR1c2VzW2NlcnRpZmljYXRpb24uZG9jdW1lbnRzW2luZGV4XV0uaW5kZXggPSBpbmRleDsKICAgICAgICAgICAgfQogICAgICAgICAgICBjZXJ0aWZpY2F0aW9uLmRvY3VtZW50cy5sZW5ndGgtLTsKICAgICAgICAgICAgTG9nQ2VydGlmaWNhdGlvbkRvY3VtZW50UmVtb3ZlZChzdHVkZW50LCBkb2N1bWVudCk7CiAgICAgICAgfQogICAgICAgIHN1Y2Nlc3MgPSB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldENlcnRpZmllZFN0dWRlbnRzQ291bnQoKQogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludDI1NiBjb3VudCkgewogICAgICAgIGNvdW50ID0gY2VydGlmaWVkU3R1ZGVudHMubGVuZ3RoOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldENlcnRpZmllZFN0dWRlbnRBdEluZGV4KHVpbnQyNTYgaW5kZXgpCiAgICAgICAgcGF5YWJsZQogICAgICAgIHJlcXVlc3RGZWVQYWlkCiAgICAgICAgcmV0dXJucyAoYWRkcmVzcyBzdHVkZW50KSB7CiAgICAgICAgc3R1ZGVudCA9IGNlcnRpZmllZFN0dWRlbnRzW2luZGV4XTsKICAgIH0KCiAgICAvKioKICAgICAqIEBub3RpY2UgUmVxdWVzdGluZyBhIGNlcnRpZmljYXRpb24gaXMgYSBwYXlpbmcgZmVhdHVyZS4KICAgICAqLwogICAgZnVuY3Rpb24gZ2V0Q2VydGlmaWNhdGlvbihhZGRyZXNzIHN0dWRlbnQpCiAgICAgICAgcGF5YWJsZQogICAgICAgIHJlcXVlc3RGZWVQYWlkCiAgICAgICAgcmV0dXJucyAoYm9vbCBjZXJ0aWZpZWQsIHVpbnQyNTYgdGltZXN0YW1wLCBhZGRyZXNzIGNlcnRpZmllciwgdWludDI1NiBkb2N1bWVudENvdW50KSB7CiAgICAgICAgQ2VydGlmaWNhdGlvbiBjZXJ0aWZpY2F0aW9uID0gc3R1ZGVudENlcnRpZmljYXRpb25zW3N0dWRlbnRdOwogICAgICAgIHJldHVybiAoY2VydGlmaWNhdGlvbi5jZXJ0aWZpZWQsCiAgICAgICAgICAgIGNlcnRpZmljYXRpb24udGltZXN0YW1wLAogICAgICAgICAgICBjZXJ0aWZpY2F0aW9uLmNlcnRpZmllciwKICAgICAgICAgICAgY2VydGlmaWNhdGlvbi5kb2N1bWVudHMubGVuZ3RoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBub3RpY2UgUmVxdWVzdGluZyBhIGNlcnRpZmljYXRpb24gY29uZmlybWF0aW9uIGlzIGEgcGF5aW5nIGZlYXR1cmUuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGlzQ2VydGlmaWVkKGFkZHJlc3Mgc3R1ZGVudCkKICAgICAgICBwYXlhYmxlCiAgICAgICAgcmVxdWVzdEZlZVBhaWQKICAgICAgICByZXR1cm5zIChib29sIGlzSW5kZWVkKSB7CiAgICAgICAgaXNJbmRlZWQgPSBzdHVkZW50Q2VydGlmaWNhdGlvbnNbc3R1ZGVudF0uY2VydGlmaWVkOwogICAgfQoKICAgIC8qKgogICAgICogQG5vdGljZSBSZXF1ZXN0aW5nIGEgY2VydGlmaWNhdGlvbiBkb2N1bWVudCBieSBpbmRleCBpcyBhIHBheWluZyBmZWF0dXJlLgogICAgICovCiAgICBmdW5jdGlvbiBnZXRDZXJ0aWZpY2F0aW9uRG9jdW1lbnRBdEluZGV4KGFkZHJlc3Mgc3R1ZGVudCwgdWludDI1NiBpbmRleCkKICAgICAgICBwYXlhYmxlCiAgICAgICAgcmVxdWVzdEZlZVBhaWQKICAgICAgICByZXR1cm5zIChieXRlczMyIGRvY3VtZW50KSB7CiAgICAgICAgZG9jdW1lbnQgPSBzdHVkZW50Q2VydGlmaWNhdGlvbnNbc3R1ZGVudF0uZG9jdW1lbnRzW2luZGV4XTsKICAgIH0KCiAgICAvKioKICAgICAqIEBub3RpY2UgUmVxdWVzdGluZyBhIGNvbmZpcm1hdGlvbiB0aGF0IGEgZG9jdW1lbnQgaXMgYSBjZXJ0aWZpY2F0aW9uIGlzIGEgcGF5aW5nIGZlYXR1cmUuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGlzQ2VydGlmaWNhdGlvbihhZGRyZXNzIHN0dWRlbnQsIGJ5dGVzMzIgZG9jdW1lbnQpCiAgICAgICAgcGF5YWJsZQogICAgICAgIHJlcXVlc3RGZWVQYWlkCiAgICAgICAgcmV0dXJucyAoYm9vbCBpc0luZGVlZCkgewogICAgICAgIGlzSW5kZWVkID0gc3R1ZGVudENlcnRpZmljYXRpb25zW3N0dWRlbnRdLmRvY3VtZW50U3RhdHVzZXNbZG9jdW1lbnRdLmlzVmFsaWQ7CiAgICB9CgogICAgZnVuY3Rpb24gZml4QmFsYW5jZSgpCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmV0dXJuIGZpeEJhbGFuY2VJbnRlcm5hbChnZXRCZW5lZmljaWFyeSgpKTsKICAgIH0KfQ=='.
	

]
