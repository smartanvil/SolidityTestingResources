Class {
	#name : #SRTe319847f14624ad62a99c7eb5e6d738f61fcf185,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTe319847f14624ad62a99c7eb5e6d738f61fcf185 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjA7Cgpjb250cmFjdCBFdGhlclBhaW50IHsKICAgLy8gc2NhbGVGYWN0b3IgaXMgdXNlZCB0byBjb252ZXJ0IEV0aGVyIGludG8gdG9rZW5zIGFuZCB2aWNlLXZlcnNhOiB0aGV5J3JlIG9mIGRpZmZlcmVudAogICAvLyBvcmRlcnMgb2YgbWFnbml0dWRlLCBoZW5jZSB0aGUgbmVlZCB0byBicmlkZ2UgYmV0d2VlbiB0aGUgdHdvLgogICB1aW50MjU2IGNvbnN0YW50IHNjYWxlRmFjdG9yID0gMHgxMDAwMDAwMDAwMDAwMDAwMDsgLy8weDEwMDAwMDAwMDAwMDAwMDAwOyAgLy8gMl42NAoKICAgLy8gQ1JSID0gNTAlCiAgIC8vIENSUiBpcyBDYXNoIFJlc2VydmUgUmF0aW8gKGluIHRoaXMgY2FzZSBDcnlwdG8gUmVzZXJ2ZSBSYXRpbykuCiAgIC8vIEZvciBtb3JlIG9uIHRoaXM6IGNoZWNrIG91dCBodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9SZXNlcnZlX3JlcXVpcmVtZW50CiAgIGludCBjb25zdGFudCBjcnJfbiA9IDE7IC8vIENSUiBudW1lcmF0b3IKICAgaW50IGNvbnN0YW50IGNycl9kID0gMjsgLy8gQ1JSIGRlbm9taW5hdG9yCgogICAvLyBUaGUgcHJpY2UgY29lZmZpY2llbnQuIENob3NlbiBzdWNoIHRoYXQgYXQgMSB0b2tlbiB0b3RhbCBzdXBwbHkKICAgLy8gdGhlIGFtb3VudCBpbiByZXNlcnZlIGlzIDAuNSBldGhlciBhbmQgdG9rZW4gcHJpY2UgaXMgMSBFdGhlci4KICAgaW50IGNvbnN0YW50IHByaWNlX2NvZWZmID0gLTB4Mjk2QUJGNzg0QTM1ODQ2OEM7CgogICAvLyBBcnJheSBiZXR3ZWVuIGVhY2ggYWRkcmVzcyBhbmQgdGhlaXIgbnVtYmVyIG9mIHRva2Vucy4KICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTZbMTZdKSBwdWJsaWMgdG9rZW5CYWxhbmNlOwoKICAgdWludDI1NlsxMjhdWzEyOF0gcHVibGljIGNvbG9yUGVyQ29vcmRpbmF0ZTsKICAgdWludDI1NlsxNl0gcHVibGljIGNvbG9yUGVyQ2FudmFzOwoKICAgZXZlbnQgY29sb3JVcGRhdGUodWludDggcG9zeCwgdWludDggcG9zeSwgdWludDggY29sb3JpZCk7CiAgIGV2ZW50IHByaWNlVXBkYXRlKHVpbnQ4IGNvbG9yaWQpOwogICBldmVudCB0b2tlblVwZGF0ZSh1aW50OCBjb2xvcmlkLCBhZGRyZXNzIHdobyk7CiAgIGV2ZW50IGRpdmlkZW5kVXBkYXRlKCk7CgogICBldmVudCBwdXNodWludCh1aW50MjU2IHMpOwogICAgICAKICAgLy8gQXJyYXkgYmV0d2VlbiBlYWNoIGFkZHJlc3MgYW5kIGhvdyBtdWNoIEV0aGVyIGhhcyBiZWVuIHBhaWQgb3V0IHRvIGl0LgogICAvLyBOb3RlIHRoYXQgdGhpcyBpcyBzY2FsZWQgYnkgdGhlIHNjYWxlRmFjdG9yIHZhcmlhYmxlLgogICBtYXBwaW5nKGFkZHJlc3MgPT4gaW50MjU2WzE2XSkgcHVibGljIHBheW91dHM7CgogICAvLyBWYXJpYWJsZSB0cmFja2luZyBob3cgbWFueSB0b2tlbnMgYXJlIGluIGV4aXN0ZW5jZSBvdmVyYWxsLgogICB1aW50MjU2WzE2XSBwdWJsaWMgdG90YWxTdXBwbHk7CgogICB1aW50MjU2IHB1YmxpYyBhbGxUb3RhbFN1cHBseTsKCiAgIC8vIEFnZ3JlZ2F0ZSBzdW0gb2YgYWxsIHBheW91dHMuCiAgIC8vIE5vdGUgdGhhdCB0aGlzIGlzIHNjYWxlZCBieSB0aGUgc2NhbGVGYWN0b3IgdmFyaWFibGUuCiAgIGludDI1NlsxNl0gdG90YWxQYXlvdXRzOwoKICAgLy8gVmFyaWFibGUgdHJhY2tpbmcgaG93IG11Y2ggRXRoZXIgZWFjaCB0b2tlbiBpcyBjdXJyZW50bHkgd29ydGguCiAgIC8vIE5vdGUgdGhhdCB0aGlzIGlzIHNjYWxlZCBieSB0aGUgc2NhbGVGYWN0b3IgdmFyaWFibGUuCiAgIHVpbnQyNTZbMTZdIGVhcm5pbmdzUGVyVG9rZW47CiAgIAogICAvLyBDdXJyZW50IGNvbnRyYWN0IGJhbGFuY2UgaW4gRXRoZXIKICAgdWludDI1NlsxNl0gcHVibGljIGNvbnRyYWN0QmFsYW5jZTsKCiAgIGFkZHJlc3MgcHVibGljIG93bmVyOwoKICAgdWludDI1NiBwdWJsaWMgb3duZXJGZWU7CgoKCiAgIGZ1bmN0aW9uIEV0aGVyUGFpbnQoKSBwdWJsaWMgewogICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgICAgY29sb3JQZXJDYW52YXNbMF0gPSAxMjgqMTI4OwogICAgICBwdXNodWludCgxIGZpbm5leSk7CiAgIH0KCiAgIC8vIFJldHVybnMgdGhlIG51bWJlciBvZiB0b2tlbnMgY3VycmVudGx5IGhlbGQgYnkgX293bmVyLgogICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIsIHVpbnQ4IGNvbG9yaWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgaWYgKGNvbG9yaWQgPj0gMTYpewogICAgICAgICByZXZlcnQoKTsKICAgICAgfQogICAgICByZXR1cm4gdG9rZW5CYWxhbmNlW19vd25lcl1bY29sb3JpZF07CiAgIH0KCiAgIC8vIFdpdGhkcmF3cyBhbGwgZGl2aWRlbmRzIGhlbGQgYnkgdGhlIGNhbGxlciBzZW5kaW5nIHRoZSB0cmFuc2FjdGlvbiwgdXBkYXRlcwogICAvLyB0aGUgcmVxdWlzaXRlIGdsb2JhbCB2YXJpYWJsZXMsIGFuZCB0cmFuc2ZlcnMgRXRoZXIgYmFjayB0byB0aGUgY2FsbGVyLgogICBmdW5jdGlvbiB3aXRoZHJhdyh1aW50OCBjb2xvcmlkKSBwdWJsaWMgewogICAgICBpZiAoY29sb3JpZCA+PSAxNil7CiAgICAgICAgIHJldmVydCgpOwogICAgICB9CiAgICAgIC8vIFJldHJpZXZlIHRoZSBkaXZpZGVuZHMgYXNzb2NpYXRlZCB3aXRoIHRoZSBhZGRyZXNzIHRoZSByZXF1ZXN0IGNhbWUgZnJvbS4KICAgICAgdmFyIGJhbGFuY2UgPSBkaXZpZGVuZHMobXNnLnNlbmRlciwgY29sb3JpZCk7CiAgICAgIAogICAgICAvLyBVcGRhdGUgdGhlIHBheW91dHMgYXJyYXksIGluY3JlbWVudGluZyB0aGUgcmVxdWVzdCBhZGRyZXNzIGJ5IGBiYWxhbmNlYC4KICAgICAgcGF5b3V0c1ttc2cuc2VuZGVyXVtjb2xvcmlkXSArPSAoaW50MjU2KSAoYmFsYW5jZSAqIHNjYWxlRmFjdG9yKTsKICAgICAgCiAgICAgIC8vIEluY3JlYXNlIHRoZSB0b3RhbCBhbW91bnQgdGhhdCdzIGJlZW4gcGFpZCBvdXQgdG8gbWFpbnRhaW4gaW52YXJpYW5jZS4KICAgICAgdG90YWxQYXlvdXRzW2NvbG9yaWRdICs9IChpbnQyNTYpIChiYWxhbmNlICogc2NhbGVGYWN0b3IpOwogICAgICAKICAgICAgLy8gU2VuZCB0aGUgZGl2aWRlbmRzIHRvIHRoZSBhZGRyZXNzIHRoYXQgcmVxdWVzdGVkIHRoZSB3aXRoZHJhdy4KICAgICAgY29udHJhY3RCYWxhbmNlW2NvbG9yaWRdID0gc3ViKGNvbnRyYWN0QmFsYW5jZVtjb2xvcmlkXSwgZGl2KG11bChiYWxhbmNlLCA5NSksMTAwKSk7CiAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoYmFsYW5jZSk7CiAgIH0KCiAgIGZ1bmN0aW9uIHdpdGhkcmF3T3duZXJGZWUoKSBwdWJsaWN7CiAgICAgIGlmIChtc2cuc2VuZGVyID09IG93bmVyKXsKICAgICAgICAgb3duZXIudHJhbnNmZXIob3duZXJGZWUpOwogICAgICAgICBvd25lckZlZSA9IDA7CiAgICAgIH0KICAgfQoKICAgLy8gU2VsbHMgeW91ciB0b2tlbnMgZm9yIEV0aGVyLiBUaGlzIEV0aGVyIGlzIGFzc2lnbmVkIHRvIHRoZSBjYWxsZXJzIGVudHJ5CiAgIC8vIGluIHRoZSB0b2tlbkJhbGFuY2UgYXJyYXksIGFuZCB0aGVyZWZvcmUgaXMgc2hvd24gYXMgYSBkaXZpZGVuZC4gQSBzZWNvbmQKICAgLy8gY2FsbCB0byB3aXRoZHJhdygpIG11c3QgYmUgbWFkZSB0byBpbnZva2UgdGhlIHRyYW5zZmVyIG9mIEV0aGVyIGJhY2sgdG8geW91ciBhZGRyZXNzLgogICBmdW5jdGlvbiBzZWxsTXlUb2tlbnModWludDggY29sb3JpZCkgcHVibGljIHsKICAgICAgaWYgKGNvbG9yaWQgPj0gMTYpewogICAgICAgICByZXZlcnQoKTsKICAgICAgfQogICAgICB2YXIgYmFsYW5jZSA9IGJhbGFuY2VPZihtc2cuc2VuZGVyLCBjb2xvcmlkKTsKICAgICAgc2VsbChiYWxhbmNlLCBjb2xvcmlkKTsKICAgICAgcHJpY2VVcGRhdGUoY29sb3JpZCk7CiAgICAgIGRpdmlkZW5kVXBkYXRlKCk7CiAgICAgIHRva2VuVXBkYXRlKGNvbG9yaWQsIG1zZy5zZW5kZXIpOwogICB9CiAgIAogICAgZnVuY3Rpb24gc2VsbE15VG9rZW5zQW1vdW50KHVpbnQ4IGNvbG9yaWQsIHVpbnQyNTYgYW1vdW50KSBwdWJsaWMgewogICAgICBpZiAoY29sb3JpZCA+PSAxNil7CiAgICAgICAgIHJldmVydCgpOwogICAgICB9CiAgICAgIHZhciBiYWxhbmNlID0gYmFsYW5jZU9mKG1zZy5zZW5kZXIsIGNvbG9yaWQpOwogICAgICBpZiAoYW1vdW50IDw9IGJhbGFuY2UpewogICAgICAgIHNlbGwoYW1vdW50LCBjb2xvcmlkKTsKICAgICAgICBwcmljZVVwZGF0ZShjb2xvcmlkKTsKICAgICAgICBkaXZpZGVuZFVwZGF0ZSgpOwogICAgICAgIHRva2VuVXBkYXRlKGNvbG9yaWQsIG1zZy5zZW5kZXIpOwogICAgICB9CiAgIH0KCiAgIC8vIFRoZSBzbGFtLXRoZS1idXR0b24gZXNjYXBlIGhhdGNoLiBTZWxscyB0aGUgY2FsbGVycyB0b2tlbnMgZm9yIEV0aGVyLCB0aGVuIGltbWVkaWF0ZWx5CiAgIC8vIGludm9rZXMgdGhlIHdpdGhkcmF3KCkgZnVuY3Rpb24sIHNlbmRpbmcgdGhlIHJlc3VsdGluZyBFdGhlciB0byB0aGUgY2FsbGVycyBhZGRyZXNzLgogICAgZnVuY3Rpb24gZ2V0TWVPdXRPZkhlcmUoKSBwdWJsaWMgewogICAgICBmb3IgKHVpbnQ4IGk9MDsgaTwxNjsgaSsrKXsKICAgICAgICAgc2VsbE15VG9rZW5zKGkpOwogICAgICAgICB3aXRoZHJhdyhpKTsKICAgICAgfQoKICAgfQoKICAgLy8gR2F0ZWtlZXBlciBmdW5jdGlvbiB0byBjaGVjayBpZiB0aGUgYW1vdW50IG9mIEV0aGVyIGJlaW5nIHNlbnQgaXNuJ3QgZWl0aGVyCiAgIC8vIHRvbyBzbWFsbCBvciB0b28gbGFyZ2UuIElmIGl0IHBhc3NlcywgZ29lcyBkaXJlY3QgdG8gYnV5KCkuCiAgIGZ1bmN0aW9uIGZ1bmQodWludDggY29sb3JpZCwgdWludDggcG9zeCwgdWludDggcG9zeSkgcGF5YWJsZSBwdWJsaWMgewogICAgICAvLyBEb24ndCBhbGxvdyBmb3IgZnVuZGluZyBpZiB0aGUgYW1vdW50IG9mIEV0aGVyIHNlbnQgaXMgbGVzcyB0aGFuIDEgc3phYm8uCiAgICAgIGlmIChjb2xvcmlkID49IDE2KXsKICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgIH0KICAgICAgaWYgKChtc2cudmFsdWUgPiAwLjAwMDAwMSBldGhlcikgJiYgKHBvc3ggPj0gMCkgJiYgKHBvc3ggPD0gMTI3KSAmJiAocG9zeSA+PSAwKSAmJiAocG9zeSA8PSAxMjcpKSB7CiAgICAgICAgIGNvbnRyYWN0QmFsYW5jZVtjb2xvcmlkXSA9IGFkZChjb250cmFjdEJhbGFuY2VbY29sb3JpZF0sIGRpdihtdWwobXNnLnZhbHVlLCA5NSksMTAwKSk7CiAgICAgICAgIGJ1eShjb2xvcmlkKTsKICAgICAgICAgY29sb3JQZXJDYW52YXNbY29sb3JQZXJDb29yZGluYXRlW3Bvc3hdW3Bvc3ldXSA9IHN1Yihjb2xvclBlckNhbnZhc1tjb2xvclBlckNvb3JkaW5hdGVbcG9zeF1bcG9zeV1dLCAxKTsKICAgICAgICAgY29sb3JQZXJDb29yZGluYXRlW3Bvc3hdW3Bvc3ldID0gY29sb3JpZDsKICAgICAgICAgY29sb3JQZXJDYW52YXNbY29sb3JpZF0gPSBhZGQoY29sb3JQZXJDYW52YXNbY29sb3JpZF0sMSk7CiAgICAgICAgIGNvbG9yVXBkYXRlKHBvc3gsIHBvc3ksIGNvbG9yaWQpOwogICAgICAgICBwcmljZVVwZGF0ZShjb2xvcmlkKTsKICAgICAgICAgZGl2aWRlbmRVcGRhdGUoKTsKICAgICAgICAgdG9rZW5VcGRhdGUoY29sb3JpZCwgbXNnLnNlbmRlcik7CgogICAgICB9IGVsc2UgewogICAgICAgICByZXZlcnQoKTsKICAgICAgfQogICAgfQoKICAgLy8gRnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSAoZHluYW1pYykgcHJpY2Ugb2YgYnV5aW5nIGEgZmlubmV5IHdvcnRoIG9mIHRva2Vucy4KICAgZnVuY3Rpb24gYnV5UHJpY2UodWludDggY29sb3JpZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgaWYgKGNvbG9yaWQgPj0gMTYpewogICAgICAgICByZXZlcnQoKTsKICAgICAgfQogICAgICByZXR1cm4gZ2V0VG9rZW5zRm9yRXRoZXIoMSBmaW5uZXksIGNvbG9yaWQpOwogICB9CgogICAvLyBGdW5jdGlvbiB0aGF0IHJldHVybnMgdGhlIChkeW5hbWljKSBwcmljZSBvZiBzZWxsaW5nIGEgc2luZ2xlIHRva2VuLgogICBmdW5jdGlvbiBzZWxsUHJpY2UodWludDggY29sb3JpZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICAgaWYgKGNvbG9yaWQgPj0gMTYpewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICAgfQogICAgICAgIHZhciBldGggPSBnZXRFdGhlckZvclRva2VucygxIGZpbm5leSwgY29sb3JpZCk7CiAgICAgICAgdmFyIGZlZSA9IGRpdihldGgsIDEwKTsKICAgICAgICByZXR1cm4gZXRoIC0gZmVlOwogICAgfQoKICAgLy8gQ2FsY3VsYXRlIHRoZSBjdXJyZW50IGRpdmlkZW5kcyBhc3NvY2lhdGVkIHdpdGggdGhlIGNhbGxlciBhZGRyZXNzLiBUaGlzIGlzIHRoZSBuZXQgcmVzdWx0CiAgIC8vIG9mIG11bHRpcGx5aW5nIHRoZSBudW1iZXIgb2YgdG9rZW5zIGhlbGQgYnkgdGhlaXIgY3VycmVudCB2YWx1ZSBpbiBFdGhlciBhbmQgc3VidHJhY3RpbmcgdGhlCiAgIC8vIEV0aGVyIHRoYXQgaGFzIGFscmVhZHkgYmVlbiBwYWlkIG91dC4KICAgZnVuY3Rpb24gZGl2aWRlbmRzKGFkZHJlc3MgX293bmVyLCB1aW50OCBjb2xvcmlkKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBhbW91bnQpIHsKICAgICAgaWYgKGNvbG9yaWQgPj0gMTYpewogICAgICAgICByZXZlcnQoKTsKICAgICAgfQogICAgICByZXR1cm4gKHVpbnQyNTYpICgoaW50MjU2KShlYXJuaW5nc1BlclRva2VuW2NvbG9yaWRdICogdG9rZW5CYWxhbmNlW19vd25lcl1bY29sb3JpZF0pIC0gcGF5b3V0c1tfb3duZXJdW2NvbG9yaWRdKSAvIHNjYWxlRmFjdG9yOwogICB9CgogICAvLyBWZXJzaW9uIG9mIHdpdGhkcmF3IHRoYXQgZXh0cmFjdHMgdGhlIGRpdmlkZW5kcyBhbmQgc2VuZHMgdGhlIEV0aGVyIHRvIHRoZSBjYWxsZXIuCiAgIC8vIFRoaXMgaXMgb25seSB1c2VkIGluIHRoZSBjYXNlIHdoZW4gdGhlcmUgaXMgbm8gdHJhbnNhY3Rpb24gZGF0YSwgYW5kIHRoYXQgc2hvdWxkIGJlCiAgIC8vIHF1aXRlIHJhcmUgdW5sZXNzIGludGVyYWN0aW5nIGRpcmVjdGx5IHdpdGggdGhlIHNtYXJ0IGNvbnRyYWN0LgogICAvL2Z1bmN0aW9uIHdpdGhkcmF3T2xkKGFkZHJlc3MgdG8pIHB1YmxpYyB7CiAgICAgIC8vIFJldHJpZXZlIHRoZSBkaXZpZGVuZHMgYXNzb2NpYXRlZCB3aXRoIHRoZSBhZGRyZXNzIHRoZSByZXF1ZXN0IGNhbWUgZnJvbS4KICAgICAvLyB2YXIgYmFsYW5jZSA9IGRpdmlkZW5kcyhtc2cuc2VuZGVyKTsKICAgICAgCiAgICAgIC8vIFVwZGF0ZSB0aGUgcGF5b3V0cyBhcnJheSwgaW5jcmVtZW50aW5nIHRoZSByZXF1ZXN0IGFkZHJlc3MgYnkgYGJhbGFuY2VgLgogICAgICAvL3BheW91dHNbbXNnLnNlbmRlcl0gKz0gKGludDI1NikgKGJhbGFuY2UgKiBzY2FsZUZhY3Rvcik7CiAgICAgIAogICAgICAvLyBJbmNyZWFzZSB0aGUgdG90YWwgYW1vdW50IHRoYXQncyBiZWVuIHBhaWQgb3V0IHRvIG1haW50YWluIGludmFyaWFuY2UuCiAgICAgIC8vdG90YWxQYXlvdXRzICs9IChpbnQyNTYpIChiYWxhbmNlICogc2NhbGVGYWN0b3IpOwogICAgICAKICAgICAgLy8gU2VuZCB0aGUgZGl2aWRlbmRzIHRvIHRoZSBhZGRyZXNzIHRoYXQgcmVxdWVzdGVkIHRoZSB3aXRoZHJhdy4KICAgICAgLy9jb250cmFjdEJhbGFuY2UgPSBzdWIoY29udHJhY3RCYWxhbmNlLCBiYWxhbmNlKTsKICAgICAgLy90by50cmFuc2ZlcihiYWxhbmNlKTsgICAgICAKICAgLy99CgogICAvLyBJbnRlcm5hbCBiYWxhbmNlIGZ1bmN0aW9uLCB1c2VkIHRvIGNhbGN1bGF0ZSB0aGUgZHluYW1pYyByZXNlcnZlIHZhbHVlLgogICBmdW5jdGlvbiBiYWxhbmNlKHVpbnQ4IGNvbG9yaWQpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYW1vdW50KSB7CgogICAgICAvLyBtc2cudmFsdWUgaXMgdGhlIGFtb3VudCBvZiBFdGhlciBzZW50IGJ5IHRoZSB0cmFuc2FjdGlvbi4KICAgICAgcmV0dXJuIGNvbnRyYWN0QmFsYW5jZVtjb2xvcmlkXSAtIG1zZy52YWx1ZTsKICAgfQoKICAgZnVuY3Rpb24gYnV5KHVpbnQ4IGNvbG9yaWQpIGludGVybmFsIHsKCiAgICAgIC8vIEFueSB0cmFuc2FjdGlvbiBvZiBsZXNzIHRoYW4gMSBzemFibyBpcyBsaWtlbHkgdG8gYmUgd29ydGggbGVzcyB0aGFuIHRoZSBnYXMgdXNlZCB0byBzZW5kIGl0LgoKICAgICAgaWYgKG1zZy52YWx1ZSA8IDAuMDAwMDAxIGV0aGVyIHx8IG1zZy52YWx1ZSA+IDEwMDAwMDAgZXRoZXIpCiAgICAgICAgIHJldmVydCgpOwogICAgICAgICAgICAgICAgICAKICAgICAgLy8gbXNnLnNlbmRlciBpcyB0aGUgYWRkcmVzcyBvZiB0aGUgY2FsbGVyLgogICAgICAvL3ZhciBzZW5kZXIgPSBtc2cuc2VuZGVyOwogICAgICAKICAgICAgLy8gMTAlIG9mIHRoZSB0b3RhbCBFdGhlciBzZW50IGlzIHVzZWQgdG8gcGF5IGV4aXN0aW5nIGhvbGRlcnMuCiAgICAgIHZhciBmZWUgPSBtdWwoZGl2KG1zZy52YWx1ZSwgMjApLCA0KTsKICAgICAgCiAgICAgIC8vIFRoZSBhbW91bnQgb2YgRXRoZXIgdXNlZCB0byBwdXJjaGFzZSBuZXcgdG9rZW5zIGZvciB0aGUgY2FsbGVyLgogICAgICAvL3ZhciBudW1FdGhlciA9IG1zZy52YWx1ZSAtIGZlZTsKICAgICAgCiAgICAgIC8vIFRoZSBudW1iZXIgb2YgdG9rZW5zIHdoaWNoIGNhbiBiZSBwdXJjaGFzZWQgZm9yIG51bUV0aGVyLgogICAgICB2YXIgbnVtVG9rZW5zID0gZ2V0VG9rZW5zRm9yRXRoZXIobXNnLnZhbHVlIC0gZmVlLCBjb2xvcmlkKTsKICAgICAgCiAgICAgIC8vIFRoZSBidXllciBmZWUsIHNjYWxlZCBieSB0aGUgc2NhbGVGYWN0b3IgdmFyaWFibGUuCiAgICAgIHVpbnQyNTYgYnV5ZXJGZWUgPSAwOwogICAgICAKICAgICAgLy8gQ2hlY2sgdGhhdCB3ZSBoYXZlIHRva2VucyBpbiBleGlzdGVuY2UgKHRoaXMgc2hvdWxkIGFsd2F5cyBiZSB0cnVlKSwgb3IKICAgICAgLy8gZWxzZSB5b3UncmUgZ29ubmEgaGF2ZSBhIGJhZCB0aW1lLgogICAgICBpZiAodG90YWxTdXBwbHlbY29sb3JpZF0gPiAwKSB7CiAgICAgICAgIC8vIENvbXB1dGUgdGhlIGJvbnVzIGNvLWVmZmljaWVudCBmb3IgYWxsIGV4aXN0aW5nIGhvbGRlcnMgYW5kIHRoZSBidXllci4KICAgICAgICAgLy8gVGhlIGJ1eWVyIHJlY2VpdmVzIHBhcnQgb2YgdGhlIGRpc3RyaWJ1dGlvbiBmb3IgZWFjaCB0b2tlbiBib3VnaHQgaW4gdGhlCiAgICAgICAgIC8vIHNhbWUgd2F5IHRoZXkgd291bGQgaGF2ZSBpZiB0aGV5IGJvdWdodCBlYWNoIHRva2VuIGluZGl2aWR1YWxseS4KCiAgICAgICAgIGZvciAodWludDggYz0wOyBjPDE2OyBjKyspewogICAgICAgICAgICBpZiAodG90YWxTdXBwbHlbY10gPiAwKXsKICAgICAgICAgICAgICAgdmFyIHRoZUV4dHJhRmVlID0gbXVsKGRpdihtdWwoZGl2KGZlZSw0KSwgc2NhbGVGYWN0b3IpLCBhbGxUb3RhbFN1cHBseSksIHRvdGFsU3VwcGx5W2NdKSArIG11bChkaXYoZGl2KGZlZSw0KSwgMTI4KjEyOCksbXVsKGNvbG9yUGVyQ2FudmFzW2NdLCBzY2FsZUZhY3RvcikpOwogICAgICAgICAgICAgICAvL3ZhciBnbG9iYWxGZWUgPSBkaXYobXVsKG11bChkaXYoZGl2KGZlZSw0KSwgYWxsVG90YWxTdXBwbHkpLCB0b3RhbFN1cHBseVtjXSksIHNjYWxlRmFjdG9yKSx0b3RhbFN1cHBseVtjXSk7CgogICAgICAgICAgICAgICBpZiAoYz09Y29sb3JpZCl7CiAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgYnV5ZXJGZWUgPSAoZGl2KGZlZSw0KSArIGRpdih0aGVFeHRyYUZlZSxzY2FsZUZhY3RvcikpKnNjYWxlRmFjdG9yIC0gKGRpdihmZWUsIDQpICsgZGl2KHRoZUV4dHJhRmVlLHNjYWxlRmFjdG9yKSkgKiAoc2NhbGVGYWN0b3IgLSAocmVzZXJ2ZShjb2xvcmlkKSArIG1zZy52YWx1ZSAtIGZlZSkgKiBudW1Ub2tlbnMgKiBzY2FsZUZhY3RvciAvICh0b3RhbFN1cHBseVtjb2xvcmlkXSArIG51bVRva2VucykgLyAobXNnLnZhbHVlIC0gZmVlKSkKCQkJICAgICogKHVpbnQpKGNycl9kKSAvICh1aW50KShjcnJfZC1jcnJfbik7CiAgICAgICAgICAgICAKCgoKCiAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgZWxzZXsKCiAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgZWFybmluZ3NQZXJUb2tlbltjXSA9IGFkZChlYXJuaW5nc1BlclRva2VuW2NdLCBkaXYodGhlRXh0cmFGZWUsIHRvdGFsU3VwcGx5W2NdKSk7CgoKICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgIH0KICAgICAgICAgCgoKICAgICAgICAgCgoKCiAgICAgICAgIG93bmVyRmVlID0gYWRkKG93bmVyRmVlLCBkaXYoZmVlLDQpKTsKICAgICAgICAgICAgCiAgICAgICAgIC8vIFRoZSB0b3RhbCByZXdhcmQgdG8gYmUgZGlzdHJpYnV0ZWQgYW1vbmdzdCB0aGUgbWFzc2VzIGlzIHRoZSBmZWUgKGluIEV0aGVyKQogICAgICAgICAvLyBtdWx0aXBsaWVkIGJ5IHRoZSBib251cyBjby1lZmZpY2llbnQuCgoKICAgICAgICAgLy8gRmVlIGlzIGRpc3RyaWJ1dGVkIHRvIGFsbCBleGlzdGluZyB0b2tlbiBob2xkZXJzIGJlZm9yZSB0aGUgbmV3IHRva2VucyBhcmUgcHVyY2hhc2VkLgogICAgICAgICAvLyByZXdhcmRQZXJTaGFyZSBpcyB0aGUgYW1vdW50IGdhaW5lZCBwZXIgdG9rZW4gdGhhbmtzIHRvIHRoaXMgYnV5LWluLgoKICAgICAgICAgCiAgICAgICAgIC8vIFRoZSBFdGhlciB2YWx1ZSBwZXIgdG9rZW4gaXMgaW5jcmVhc2VkIHByb3BvcnRpb25hbGx5LgogICAgICAgICAvLyA1JQoKICAgICAgICAgZWFybmluZ3NQZXJUb2tlbltjb2xvcmlkXSA9IGVhcm5pbmdzUGVyVG9rZW5bY29sb3JpZF0gKyAgYnV5ZXJGZWUgLyAodG90YWxTdXBwbHlbY29sb3JpZF0pOwoKICAgICAgICAgICAgIAogICAgICAgICAKICAgICAgfQoKICAgICAgICAgdG90YWxTdXBwbHlbY29sb3JpZF0gPSBhZGQodG90YWxTdXBwbHlbY29sb3JpZF0sIG51bVRva2Vucyk7CgogICAgICAgICBhbGxUb3RhbFN1cHBseSA9IGFkZChhbGxUb3RhbFN1cHBseSwgbnVtVG9rZW5zKTsKCiAgICAgIC8vIEFkZCB0aGUgbnVtVG9rZW5zIHdoaWNoIHdlcmUganVzdCBjcmVhdGVkIHRvIHRoZSB0b3RhbCBzdXBwbHkuIFdlJ3JlIGEgY3J5cHRvIGNlbnRyYWwgYmFuayEKCgogICAgICAKCiAgICAgIC8vIEFzc2lnbiB0aGUgdG9rZW5zIHRvIHRoZSBiYWxhbmNlIG9mIHRoZSBidXllci4KICAgICAgdG9rZW5CYWxhbmNlW21zZy5zZW5kZXJdW2NvbG9yaWRdID0gYWRkKHRva2VuQmFsYW5jZVttc2cuc2VuZGVyXVtjb2xvcmlkXSwgbnVtVG9rZW5zKTsKCiAgICAgIC8vIFVwZGF0ZSB0aGUgcGF5b3V0IGFycmF5IHNvIHRoYXQgdGhlIGJ1eWVyIGNhbm5vdCBjbGFpbSBkaXZpZGVuZHMgb24gcHJldmlvdXMgcHVyY2hhc2VzLgogICAgICAvLyBBbHNvIGluY2x1ZGUgdGhlIGZlZSBwYWlkIGZvciBlbnRlcmluZyB0aGUgc2NoZW1lLgogICAgICAvLyBGaXJzdCB3ZSBjb21wdXRlIGhvdyBtdWNoIHdhcyBqdXN0IHBhaWQgb3V0IHRvIHRoZSBidXllci4uLgoKICAgICAgCiAgICAgIC8vIFRoZW4gd2UgdXBkYXRlIHRoZSBwYXlvdXRzIGFycmF5IGZvciB0aGUgYnV5ZXIgd2l0aCB0aGlzIGFtb3VudC4uLgogICAgICBwYXlvdXRzW21zZy5zZW5kZXJdW2NvbG9yaWRdICs9ICAoaW50MjU2KSAoKGVhcm5pbmdzUGVyVG9rZW5bY29sb3JpZF0gKiBudW1Ub2tlbnMpIC0gYnV5ZXJGZWUpOwogICAgICAKICAgICAgLy8gQW5kIHRoZW4gd2UgZmluYWxseSBhZGQgaXQgdG8gdGhlIHZhcmlhYmxlIHRyYWNraW5nIHRoZSB0b3RhbCBhbW91bnQgc3BlbnQgdG8gbWFpbnRhaW4gaW52YXJpYW5jZS4KICAgICAgdG90YWxQYXlvdXRzW2NvbG9yaWRdICAgICs9ICAoaW50MjU2KSAoKGVhcm5pbmdzUGVyVG9rZW5bY29sb3JpZF0gKiBudW1Ub2tlbnMpIC0gYnV5ZXJGZWUpOwogICAgICAKICAgfQoKICAgLy8gU2VsbCBmdW5jdGlvbiB0aGF0IHRha2VzIHRva2VucyBhbmQgY29udmVydHMgdGhlbSBpbnRvIEV0aGVyLiBBbHNvIGNvbWVzIHdpdGggYSAxMCUgZmVlCiAgIC8vIHRvIGRpc2NvdXJhZ2luZyBkdW1waW5nLCBhbmQgbWVhbnMgdGhhdCBpZiBzb21lb25lIG5lYXIgdGhlIHRvcCBzZWxscywgdGhlIGZlZSBkaXN0cmlidXRlZAogICAvLyB3aWxsIGJlICpzaWduaWZpY2FudCouCiAgIGZ1bmN0aW9uIHNlbGwodWludDI1NiBhbW91bnQsIHVpbnQ4IGNvbG9yaWQpIGludGVybmFsIHsKICAgICAgIC8vIENhbGN1bGF0ZSB0aGUgYW1vdW50IG9mIEV0aGVyIHRoYXQgdGhlIGhvbGRlcnMgdG9rZW5zIHNlbGwgZm9yIGF0IHRoZSBjdXJyZW50IHNlbGwgcHJpY2UuCiAgICAgIHZhciBudW1FdGhlcnNCZWZvcmVGZWUgPSBnZXRFdGhlckZvclRva2VucyhhbW91bnQsIGNvbG9yaWQpOwogICAgICAKICAgICAgLy8gMjAlIG9mIHRoZSByZXN1bHRpbmcgRXRoZXIgaXMgdXNlZCB0byBwYXkgcmVtYWluaW5nIGhvbGRlcnMuCiAgICAgIHZhciBmZWUgPSBtdWwoZGl2KG51bUV0aGVyc0JlZm9yZUZlZSwgMjApLCA0KTsKICAgICAgCiAgICAgIC8vIE5ldCBFdGhlciBmb3IgdGhlIHNlbGxlciBhZnRlciB0aGUgZmVlIGhhcyBiZWVuIHN1YnRyYWN0ZWQuCiAgICAgIHZhciBudW1FdGhlcnMgPSBudW1FdGhlcnNCZWZvcmVGZWUgLSBmZWU7CiAgICAgIAogICAgICAvLyAqUmVtb3ZlKiB0aGUgbnVtVG9rZW5zIHdoaWNoIHdlcmUganVzdCBzb2xkIGZyb20gdGhlIHRvdGFsIHN1cHBseS4gV2UncmUgL2RlZmluaXRlbHkvIGEgY3J5cHRvIGNlbnRyYWwgYmFuay4KICAgICAgdG90YWxTdXBwbHlbY29sb3JpZF0gPSBzdWIodG90YWxTdXBwbHlbY29sb3JpZF0sIGFtb3VudCk7CiAgICAgIGFsbFRvdGFsU3VwcGx5ID0gc3ViKGFsbFRvdGFsU3VwcGx5LCBhbW91bnQpOwogICAgICAKICAgICAgICAvLyBSZW1vdmUgdGhlIHRva2VucyBmcm9tIHRoZSBiYWxhbmNlIG9mIHRoZSBidXllci4KICAgICAgdG9rZW5CYWxhbmNlW21zZy5zZW5kZXJdW2NvbG9yaWRdID0gc3ViKHRva2VuQmFsYW5jZVttc2cuc2VuZGVyXVtjb2xvcmlkXSwgYW1vdW50KTsKCiAgICAgICAgLy8gVXBkYXRlIHRoZSBwYXlvdXQgYXJyYXkgc28gdGhhdCB0aGUgc2VsbGVyIGNhbm5vdCBjbGFpbSBmdXR1cmUgZGl2aWRlbmRzIHVubGVzcyB0aGV5IGJ1eSBiYWNrIGluLgogICAgICAvLyBGaXJzdCB3ZSBjb21wdXRlIGhvdyBtdWNoIHdhcyBqdXN0IHBhaWQgb3V0IHRvIHRoZSBzZWxsZXIuLi4KICAgICAgdmFyIHBheW91dERpZmYgPSAoaW50MjU2KSAoZWFybmluZ3NQZXJUb2tlbltjb2xvcmlkXSAqIGFtb3VudCArIChudW1FdGhlcnMgKiBzY2FsZUZhY3RvcikpOwogICAgICAKICAgICAgICAvLyBXZSByZWR1Y2UgdGhlIGFtb3VudCBwYWlkIG91dCB0byB0aGUgc2VsbGVyICh0aGlzIGVmZmVjdGl2ZWx5IHJlc2V0cyB0aGVpciBwYXlvdXRzIHZhbHVlIHRvIHplcm8sCiAgICAgIC8vIHNpbmNlIHRoZXkncmUgc2VsbGluZyBhbGwgb2YgdGhlaXIgdG9rZW5zKS4gVGhpcyBtYWtlcyBzdXJlIHRoZSBzZWxsZXIgaXNuJ3QgZGlzYWR2YW50YWdlZCBpZgogICAgICAvLyB0aGV5IGRlY2lkZSB0byBidXkgYmFjayBpbi4KICAgICAgcGF5b3V0c1ttc2cuc2VuZGVyXVtjb2xvcmlkXSAtPSBwYXlvdXREaWZmOyAgICAgCiAgICAgIAogICAgICAvLyBEZWNyZWFzZSB0aGUgdG90YWwgYW1vdW50IHRoYXQncyBiZWVuIHBhaWQgb3V0IHRvIG1haW50YWluIGludmFyaWFuY2UuCiAgICAgIHRvdGFsUGF5b3V0c1tjb2xvcmlkXSAtPSBwYXlvdXREaWZmOwogICAgICAKICAgICAgLy8gQ2hlY2sgdGhhdCB3ZSBoYXZlIHRva2VucyBpbiBleGlzdGVuY2UgKHRoaXMgaXMgYSBiaXQgb2YgYW4gaXJyZWxldmFudCBjaGVjayBzaW5jZSB3ZSdyZQogICAgICAvLyBzZWxsaW5nIHRva2VucywgYnV0IGl0IGd1YXJkcyBhZ2FpbnN0IGRpdmlzaW9uIGJ5IHplcm8pLgogICAgICBpZiAodG90YWxTdXBwbHlbY29sb3JpZF0gPiAwKSB7CiAgICAgICAgIC8vIFNjYWxlIHRoZSBFdGhlciB0YWtlbiBhcyB0aGUgc2VsbGluZyBmZWUgYnkgdGhlIHNjYWxlRmFjdG9yIHZhcmlhYmxlLgoKICAgICAgICAgZm9yICh1aW50OCBjPTA7IGM8MTY7IGMrKyl7CiAgICAgICAgICAgIGlmICh0b3RhbFN1cHBseVtjXSA+IDApewogICAgICAgICAgICAgICB2YXIgdGhlRXh0cmFGZWUgPSBtdWwoZGl2KG11bChkaXYoZmVlLDQpLCBzY2FsZUZhY3RvciksIGFsbFRvdGFsU3VwcGx5KSwgdG90YWxTdXBwbHlbY10pICsgbXVsKGRpdihkaXYoZmVlLDQpLCAxMjgqMTI4KSxtdWwoY29sb3JQZXJDYW52YXNbY10sIHNjYWxlRmFjdG9yKSk7CiAgICAgICAgICAgIAogICAgICAgICAgICAgICBlYXJuaW5nc1BlclRva2VuW2NdID0gYWRkKGVhcm5pbmdzUGVyVG9rZW5bY10sIGRpdih0aGVFeHRyYUZlZSx0b3RhbFN1cHBseVtjXSkpOwogICAgICAgICAgICB9CiAgICAgICAgIH0KCiAgICAgICAgIG93bmVyRmVlID0gYWRkKG93bmVyRmVlLCBkaXYoZmVlLDQpKTsKCiAgICAgICAgIHZhciBldGhlckZlZSA9IGRpdihmZWUsNCkgKiBzY2FsZUZhY3RvcjsKICAgICAgICAgCiAgICAgICAgIC8vIEZlZSBpcyBkaXN0cmlidXRlZCB0byBhbGwgcmVtYWluaW5nIHRva2VuIGhvbGRlcnMuCiAgICAgICAgIC8vIHJld2FyZFBlclNoYXJlIGlzIHRoZSBhbW91bnQgZ2FpbmVkIHBlciB0b2tlbiB0aGFua3MgdG8gdGhpcyBzZWxsLgogICAgICAgICB2YXIgcmV3YXJkUGVyU2hhcmUgPSBldGhlckZlZSAvIHRvdGFsU3VwcGx5W2NvbG9yaWRdOwogICAgICAgICAKICAgICAgICAgLy8gVGhlIEV0aGVyIHZhbHVlIHBlciB0b2tlbiBpcyBpbmNyZWFzZWQgcHJvcG9ydGlvbmFsbHkuCiAgICAgICAgIGVhcm5pbmdzUGVyVG9rZW5bY29sb3JpZF0gPSBhZGQoZWFybmluZ3NQZXJUb2tlbltjb2xvcmlkXSwgcmV3YXJkUGVyU2hhcmUpOwoKICAgICAgICAgCiAgICAgIH0KICAgfQoKICAgLy8gRHluYW1pYyB2YWx1ZSBvZiBFdGhlciBpbiByZXNlcnZlLCBhY2NvcmRpbmcgdG8gdGhlIENSUiByZXF1aXJlbWVudC4KICAgZnVuY3Rpb24gcmVzZXJ2ZSh1aW50OCBjb2xvcmlkKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGFtb3VudCkgewogICAgICByZXR1cm4gc3ViKGJhbGFuY2UoY29sb3JpZCksCiAgICAgICAgICAoKHVpbnQyNTYpICgoaW50MjU2KSAoZWFybmluZ3NQZXJUb2tlbltjb2xvcmlkXSAqIHRvdGFsU3VwcGx5W2NvbG9yaWRdKSAtIHRvdGFsUGF5b3V0c1tjb2xvcmlkXSkgLyBzY2FsZUZhY3RvcikpOwogICB9CgogICAvLyBDYWxjdWxhdGVzIHRoZSBudW1iZXIgb2YgdG9rZW5zIHRoYXQgY2FuIGJlIGJvdWdodCBmb3IgYSBnaXZlbiBhbW91bnQgb2YgRXRoZXIsIGFjY29yZGluZyB0byB0aGUKICAgLy8gZHluYW1pYyByZXNlcnZlIGFuZCB0b3RhbFN1cHBseSB2YWx1ZXMgKGRlcml2ZWQgZnJvbSB0aGUgYnV5IGFuZCBzZWxsIHByaWNlcykuCiAgIGZ1bmN0aW9uIGdldFRva2Vuc0ZvckV0aGVyKHVpbnQyNTYgZXRoZXJ2YWx1ZSwgdWludDggY29sb3JpZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgdG9rZW5zKSB7CiAgICAgIGlmIChjb2xvcmlkID49IDE2KXsKICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgIH0KICAgICAgcmV0dXJuIHN1YihmaXhlZEV4cChmaXhlZExvZyhyZXNlcnZlKGNvbG9yaWQpICsgZXRoZXJ2YWx1ZSkqY3JyX24vY3JyX2QgKyBwcmljZV9jb2VmZiksIHRvdGFsU3VwcGx5W2NvbG9yaWRdKTsKICAgfQoKCgogICAvLyBDb252ZXJ0cyBhIG51bWJlciB0b2tlbnMgaW50byBhbiBFdGhlciB2YWx1ZS4KICAgZnVuY3Rpb24gZ2V0RXRoZXJGb3JUb2tlbnModWludDI1NiB0b2tlbnMsIHVpbnQ4IGNvbG9yaWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGV0aGVydmFsdWUpIHsKICAgICAgaWYgKGNvbG9yaWQgPj0gMTYpewogICAgICAgICByZXZlcnQoKTsKICAgICAgfQogICAgICAvLyBIb3cgbXVjaCByZXNlcnZlIEV0aGVyIGRvIHdlIGhhdmUgbGVmdCBpbiB0aGUgY29udHJhY3Q/CiAgICAgIHZhciByZXNlcnZlQW1vdW50ID0gcmVzZXJ2ZShjb2xvcmlkKTsKCiAgICAgIC8vIElmIHlvdSdyZSB0aGUgSGlnaGxhbmRlciAob3IgYmFnaG9sZGVyKSwgeW91IGdldCBUaGUgUHJpemUuIEV2ZXJ5dGhpbmcgbGVmdCBpbiB0aGUgdmF1bHQuCiAgICAgIGlmICh0b2tlbnMgPT0gdG90YWxTdXBwbHlbY29sb3JpZF0pCiAgICAgICAgIHJldHVybiByZXNlcnZlQW1vdW50OwoKICAgICAgLy8gSWYgdGhlcmUgd291bGQgYmUgZXhjZXNzIEV0aGVyIGxlZnQgYWZ0ZXIgdGhlIHRyYW5zYWN0aW9uIHRoaXMgaXMgY2FsbGVkIHdpdGhpbiwgcmV0dXJuIHRoZSBFdGhlcgogICAgICAvLyBjb3JyZXNwb25kaW5nIHRvIHRoZSBlcXVhdGlvbiBpbiBEciBKb2NoZW4gSG9lbmlja2UncyBvcmlnaW5hbCBQb256aSBwYXBlciwgd2hpY2ggY2FuIGJlIGZvdW5kCiAgICAgIC8vIGF0IGh0dHBzOi8vdGVzdC5qb2NoZW4taG9lbmlja2UuZGUvZXRoL3BvbnppdG9rZW4vIGluIHRoZSB0aGlyZCBlcXVhdGlvbiwgd2l0aCB0aGUgQ1JSIG51bWVyYXRvciAKICAgICAgLy8gYW5kIGRlbm9taW5hdG9yIGFsdGVyZWQgdG8gMSBhbmQgMiByZXNwZWN0aXZlbHkuCiAgICAgIHJldHVybiBzdWIocmVzZXJ2ZUFtb3VudCwgZml4ZWRFeHAoKGZpeGVkTG9nKHRvdGFsU3VwcGx5W2NvbG9yaWRdIC0gdG9rZW5zKSAtIHByaWNlX2NvZWZmKSAqIGNycl9kL2Nycl9uKSk7CiAgIH0KCi8vIFlvdSBkb24ndCBjYXJlIGFib3V0IHRoZXNlLCBidXQgaWYgeW91IHJlYWxseSBkbyB0aGV5J3JlIGhleCB2YWx1ZXMgZm9yIAogICAvLyBjby1lZmZpY2llbnRzIHVzZWQgdG8gc2ltdWxhdGUgYXBwcm94aW1hdGlvbnMgb2YgdGhlIGxvZyBhbmQgZXhwIGZ1bmN0aW9ucy4KICAgaW50MjU2ICBjb25zdGFudCBvbmUgICAgICAgID0gMHgxMDAwMDAwMDAwMDAwMDAwMDsKICAgdWludDI1NiBjb25zdGFudCBzcXJ0MiAgICAgID0gMHgxNmEwOWU2NjdmM2JjYzkwODsKICAgdWludDI1NiBjb25zdGFudCBzcXJ0ZG90NSAgID0gMHgwYjUwNGYzMzNmOWRlNjQ4NDsKICAgaW50MjU2ICBjb25zdGFudCBsbjIgICAgICAgID0gMHgwYjE3MjE3ZjdkMWNmNzlhYzsKICAgaW50MjU2ICBjb25zdGFudCBsbjJfNjRkb3Q1ID0gMHgyY2I1M2YwOWYwNWNjNjI3Yzg7CiAgIGludDI1NiAgY29uc3RhbnQgYzEgICAgICAgICA9IDB4MWZmZmZmZmZmZmY5ZGFjOWI7CiAgIGludDI1NiAgY29uc3RhbnQgYzMgICAgICAgICA9IDB4MGFhYWFhYWFjMTY4Nzc5MDg7CiAgIGludDI1NiAgY29uc3RhbnQgYzUgICAgICAgICA9IDB4MDY2NjY2NGU1ZTlmYTBjOTk7CiAgIGludDI1NiAgY29uc3RhbnQgYzcgICAgICAgICA9IDB4MDQ5MjU0MDI2YTc2MzBhY2Y7CiAgIGludDI1NiAgY29uc3RhbnQgYzkgICAgICAgICA9IDB4MDM4YmQ3NWVkMzc3NTNkNjg7CiAgIGludDI1NiAgY29uc3RhbnQgYzExICAgICAgICA9IDB4MDMyODRhMGMxNDYxMDkyNGY7CgogICAvLyBUaGUgcG9seW5vbWlhbCBSID0gYzEqeCArIGMzKnheMyArIC4uLiArIGMxMSAqIHheMTEKICAgLy8gYXBwcm94aW1hdGVzIHRoZSBmdW5jdGlvbiBsb2coMSt4KS1sb2coMS14KQogICAvLyBIZW5jZSBSKHMpID0gbG9nKCgxK3MpLygxLXMpKSA9IGxvZyhhKQogICBmdW5jdGlvbiBmaXhlZExvZyh1aW50MjU2IGEpIGludGVybmFsIHB1cmUgcmV0dXJucyAoaW50MjU2IGxvZykgewogICAgICBpbnQzMiBzY2FsZSA9IDA7CiAgICAgIHdoaWxlIChhID4gc3FydDIpIHsKICAgICAgICAgYSAvPSAyOwogICAgICAgICBzY2FsZSsrOwogICAgICB9CiAgICAgIHdoaWxlIChhIDw9IHNxcnRkb3Q1KSB7CiAgICAgICAgIGEgKj0gMjsKICAgICAgICAgc2NhbGUtLTsKICAgICAgfQogICAgICBpbnQyNTYgcyA9ICgoKGludDI1NikoYSkgLSBvbmUpICogb25lKSAvICgoaW50MjU2KShhKSArIG9uZSk7CiAgICAgIHZhciB6ID0gKHMqcykgLyBvbmU7CiAgICAgIHJldHVybiBzY2FsZSAqIGxuMiArCiAgICAgICAgIChzKihjMSArICh6KihjMyArICh6KihjNSArICh6KihjNyArICh6KihjOSArICh6KmMxMS9vbmUpKQogICAgICAgICAgICAvb25lKSkvb25lKSkvb25lKSkvb25lKSkvb25lKTsKICAgfQoKICAgaW50MjU2IGNvbnN0YW50IGMyID0gIDB4MDJhYWFhYWFhYWEwMTVkYjA7CiAgIGludDI1NiBjb25zdGFudCBjNCA9IC0weDAwMGI2MGI2MDgwODM5OWQxOwogICBpbnQyNTYgY29uc3RhbnQgYzYgPSAgMHgwMDAwNDU1OTU2YmNjZGQwNjsKICAgaW50MjU2IGNvbnN0YW50IGM4ID0gLTB4MDAwMDAxYjg5M2FkMDRiM2E7CiAgIAogICAvLyBUaGUgcG9seW5vbWlhbCBSID0gMiArIGMyKnheMiArIGM0KnheNCArIC4uLgogICAvLyBhcHByb3hpbWF0ZXMgdGhlIGZ1bmN0aW9uIHgqKGV4cCh4KSsxKS8oZXhwKHgpLTEpCiAgIC8vIEhlbmNlIGV4cCh4KSA9IChSKHgpK3gpLyhSKHgpLXgpCiAgIGZ1bmN0aW9uIGZpeGVkRXhwKGludDI1NiBhKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYgZXhwKSB7CiAgICAgIGludDI1NiBzY2FsZSA9IChhICsgKGxuMl82NGRvdDUpKSAvIGxuMiAtIDY0OwogICAgICBhIC09IHNjYWxlKmxuMjsKICAgICAgaW50MjU2IHogPSAoYSphKSAvIG9uZTsKICAgICAgaW50MjU2IFIgPSAoKGludDI1NikoMikgKiBvbmUpICsKICAgICAgICAgKHoqKGMyICsgKHoqKGM0ICsgKHoqKGM2ICsgKHoqYzgvb25lKSkvb25lKSkvb25lKSkvb25lKTsKICAgICAgZXhwID0gKHVpbnQyNTYpICgoKFIgKyBhKSAqIG9uZSkgLyAoUiAtIGEpKTsKICAgICAgaWYgKHNjYWxlID49IDApCiAgICAgICAgIGV4cCA8PD0gc2NhbGU7CiAgICAgIGVsc2UKICAgICAgICAgZXhwID4+PSAtc2NhbGU7CiAgICAgIHJldHVybiBleHA7CiAgIH0KICAgCiAgIC8vIFRoZSBiZWxvdyBhcmUgc2FmZW1hdGggaW1wbGVtZW50YXRpb25zIG9mIHRoZSBmb3VyIGFyaXRobWV0aWMgb3BlcmF0b3JzCiAgIC8vIGRlc2lnbmVkIHRvIGV4cGxpY2l0bHkgcHJldmVudCBvdmVyLSBhbmQgdW5kZXItZmxvd3Mgb2YgaW50ZWdlciB2YWx1ZXMuCgogICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICBpZiAoYSA9PSAwKSB7CiAgICAgICAgIHJldHVybiAwOwogICAgICB9CiAgICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICAgIHJldHVybiBjOwogICB9CgogICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICAgIHJldHVybiBjOwogICB9CgogICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICBhc3NlcnQoYiA8PSBhKTsKICAgICAgcmV0dXJuIGEgLSBiOwogICB9CgogICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgICAgYXNzZXJ0KGMgPj0gYSk7CiAgICAgIHJldHVybiBjOwogICB9CgogICAvLyBUaGlzIGFsbG93cyB5b3UgdG8gYnV5IHRva2VucyBieSBzZW5kaW5nIEV0aGVyIGRpcmVjdGx5IHRvIHRoZSBzbWFydCBjb250cmFjdAogICAvLyB3aXRob3V0IGluY2x1ZGluZyBhbnkgdHJhbnNhY3Rpb24gZGF0YSAodXNlZnVsIGZvciwgc2F5LCBtb2JpbGUgd2FsbGV0IGFwcHMpLgogICBmdW5jdGlvbiAoKSBwYXlhYmxlIHB1YmxpYyB7CiAgICAgIC8vIG1zZy52YWx1ZSBpcyB0aGUgYW1vdW50IG9mIEV0aGVyIHNlbnQgYnkgdGhlIHRyYW5zYWN0aW9uLgogICAgICByZXZlcnQoKTsKICAgICAgLy9pZiAobXNnLnZhbHVlID4gMCkgewogICAgICAvLyAgIHJldmVydCgpOwogICAgICAvL30gZWxzZSB7CiAgICAgIC8vICAgZm9yICh1aW50OCBpPTA7IGk8MTY7IGkrKyl7CiAgICAgIC8vICAgICB3aXRoZHJhdyhpKTsKICAgICAgLy8gICB9CgogICAgICAvL30KICAgfQogICAKfQ=='.
	

]
