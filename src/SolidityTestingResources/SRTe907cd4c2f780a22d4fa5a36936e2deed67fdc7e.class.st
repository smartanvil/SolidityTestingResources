Class {
	#name : #SRTe907cd4c2f780a22d4fa5a36936e2deed67fdc7e,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTe907cd4c2f780a22d4fa5a36936e2deed67fdc7e >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgovLyBGaWxlOiBjb250cmFjdHMvQlRDLnNvbAoKLy8gQml0Y29pbiB0cmFuc2FjdGlvbiBwYXJzaW5nIGxpYnJhcnkKCi8vIENvcHlyaWdodCAyMDE2IHJhaW4gPGh0dHBzOi8va2V5YmFzZS5pby9yYWluPgovLwovLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgovLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKLy8KLy8gICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKLy8KLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQovLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAovLyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAovLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCi8vIGh0dHBzOi8vZW4uYml0Y29pbi5pdC93aWtpL1Byb3RvY29sX2RvY3VtZW50YXRpb24jdHgKLy8KLy8gUmF3IEJpdGNvaW4gdHJhbnNhY3Rpb24gc3RydWN0dXJlOgovLwovLyBmaWVsZCAgICAgfCBzaXplIHwgdHlwZSAgICAgfCBkZXNjcmlwdGlvbgovLyB2ZXJzaW9uICAgfCA0ICAgIHwgaW50MzIgICAgfCB0cmFuc2FjdGlvbiB2ZXJzaW9uIG51bWJlcgovLyBuX3R4X2luICAgfCAxLTkgIHwgdmFyX2ludCAgfCBudW1iZXIgb2YgdHJhbnNhY3Rpb24gaW5wdXRzCi8vIHR4X2luICAgICB8IDQxKyAgfCB0eF9pbltdICB8IGxpc3Qgb2YgdHJhbnNhY3Rpb24gaW5wdXRzCi8vIG5fdHhfb3V0ICB8IDEtOSAgfCB2YXJfaW50ICB8IG51bWJlciBvZiB0cmFuc2FjdGlvbiBvdXRwdXRzCi8vIHR4X291dCAgICB8IDkrICAgfCB0eF9vdXRbXSB8IGxpc3Qgb2YgdHJhbnNhY3Rpb24gb3V0cHV0cwovLyBsb2NrX3RpbWUgfCA0ICAgIHwgdWludDMyICAgfCBibG9jayBudW1iZXIgLyB0aW1lc3RhbXAgYXQgd2hpY2ggdHggbG9ja2VkCi8vCi8vIFRyYW5zYWN0aW9uIGlucHV0ICh0eF9pbikgc3RydWN0dXJlOgovLwovLyBmaWVsZCAgICAgIHwgc2l6ZSB8IHR5cGUgICAgIHwgZGVzY3JpcHRpb24KLy8gcHJldmlvdXMgICB8IDM2ICAgfCBvdXRwb2ludCB8IFByZXZpb3VzIG91dHB1dCB0cmFuc2FjdGlvbiByZWZlcmVuY2UKLy8gc2NyaXB0X2xlbiB8IDEtOSAgfCB2YXJfaW50ICB8IExlbmd0aCBvZiB0aGUgc2lnbmF0dXJlIHNjcmlwdAovLyBzaWdfc2NyaXB0IHwgPyAgICB8IHVjaGFyW10gIHwgU2NyaXB0IGZvciBjb25maXJtaW5nIHRyYW5zYWN0aW9uIGF1dGhvcml6YXRpb24KLy8gc2VxdWVuY2UgICB8IDQgICAgfCB1aW50MzIgICB8IFNlbmRlciB0cmFuc2FjdGlvbiB2ZXJzaW9uCi8vCi8vIE91dFBvaW50IHN0cnVjdHVyZToKLy8KLy8gZmllbGQgICAgICB8IHNpemUgfCB0eXBlICAgICB8IGRlc2NyaXB0aW9uCi8vIGhhc2ggICAgICAgfCAzMiAgIHwgY2hhclszMl0gfCBUaGUgaGFzaCBvZiB0aGUgcmVmZXJlbmNlZCB0cmFuc2FjdGlvbgovLyBpbmRleCAgICAgIHwgNCAgICB8IHVpbnQzMiAgIHwgVGhlIGluZGV4IG9mIHRoaXMgb3V0cHV0IGluIHRoZSByZWZlcmVuY2VkIHRyYW5zYWN0aW9uCi8vCi8vIFRyYW5zYWN0aW9uIG91dHB1dCAodHhfb3V0KSBzdHJ1Y3R1cmU6Ci8vCi8vIGZpZWxkICAgICAgICAgfCBzaXplIHwgdHlwZSAgICAgfCBkZXNjcmlwdGlvbgovLyB2YWx1ZSAgICAgICAgIHwgOCAgICB8IGludDY0ICAgIHwgVHJhbnNhY3Rpb24gdmFsdWUgKFNhdG9zaGlzKQovLyBwa19zY3JpcHRfbGVuIHwgMS05ICB8IHZhcl9pbnQgIHwgTGVuZ3RoIG9mIHRoZSBwdWJsaWMga2V5IHNjcmlwdAovLyBwa19zY3JpcHQgICAgIHwgPyAgICB8IHVjaGFyW10gIHwgUHVibGljIGtleSBhcyBhIEJpdGNvaW4gc2NyaXB0LgovLwovLyBWYXJpYWJsZSBpbnRlZ2VycyAodmFyX2ludCkgY2FuIGJlIGVuY29kZWQgZGlmZmVyZW50bHkgZGVwZW5kaW5nCi8vIG9uIHRoZSByZXByZXNlbnRlZCB2YWx1ZSwgdG8gc2F2ZSBzcGFjZS4gVmFyaWFibGUgaW50ZWdlcnMgYWx3YXlzCi8vIHByZWNlZGUgYW4gYXJyYXkgb2YgYSB2YXJpYWJsZSBsZW5ndGggZGF0YSB0eXBlIChlLmcuIHR4X2luKS4KLy8KLy8gVmFyaWFibGUgaW50ZWdlciBlbmNvZGluZ3MgYXMgYSBmdW5jdGlvbiBvZiByZXByZXNlbnRlZCB2YWx1ZToKLy8KLy8gdmFsdWUgICAgICAgICAgIHwgYnl0ZXMgIHwgZm9ybWF0Ci8vIDwweEZEICgyNTMpICAgICB8IDEgICAgICB8IHVpbnQ4Ci8vIDw9MHhGRkZGICg2NTUzNSl8IDMgICAgICB8IDB4RkQgZm9sbG93ZWQgYnkgbGVuZ3RoIGFzIHVpbnQxNgovLyA8PTB4RkZGRiBGRkZGICAgfCA1ICAgICAgfCAweEZFIGZvbGxvd2VkIGJ5IGxlbmd0aCBhcyB1aW50MzIKLy8gLSAgICAgICAgICAgICAgIHwgOSAgICAgIHwgMHhGRiBmb2xsb3dlZCBieSBsZW5ndGggYXMgdWludDY0Ci8vCi8vIFB1YmxpYyBrZXkgc2NyaXB0cyBgcGtfc2NyaXB0YCBhcmUgc2V0IG9uIHRoZSBvdXRwdXQgYW5kIGNhbgovLyB0YWtlIGEgbnVtYmVyIG9mIGZvcm1zLiBUaGUgcmVndWxhciB0cmFuc2FjdGlvbiBzY3JpcHQgaXMKLy8gY2FsbGVkICdwYXktdG8tcHVia2V5LWhhc2gnIChQMlBLSCk6Ci8vCi8vIE9QX0RVUCBPUF9IQVNIMTYwIDxwdWJLZXlIYXNoPiBPUF9FUVVBTFZFUklGWSBPUF9DSEVDS1NJRwovLwovLyBPUF94IGFyZSBCaXRjb2luIHNjcmlwdCBvcGNvZGVzLiBUaGUgYnl0ZXMgcmVwcmVzZW50YXRpb24gKGluY2x1ZGluZwovLyB0aGUgMHgxNCAyMC1ieXRlIHN0YWNrIHB1c2gpIGlzOgovLwovLyAweDc2IDB4QTkgMHgxNCA8cHViS2V5SGFzaD4gMHg4OCAweEFDCi8vCi8vIFRoZSA8cHViS2V5SGFzaD4gaXMgdGhlIHJpcGVtZDE2MCBoYXNoIG9mIHRoZSBzaGEyNTYgaGFzaCBvZgovLyB0aGUgcHVibGljIGtleSwgcHJlY2VkZWQgYnkgYSBuZXR3b3JrIHZlcnNpb24gYnl0ZS4gKDIxIGJ5dGVzIHRvdGFsKQovLwovLyBOZXR3b3JrIHZlcnNpb24gYnl0ZXM6IDB4MDAgKG1haW5uZXQpOyAweDZmICh0ZXN0bmV0KTsgMHgzNCAobmFtZWNvaW4pCi8vCi8vIFRoZSBCaXRjb2luIGFkZHJlc3MgaXMgZGVyaXZlZCBmcm9tIHRoZSBwdWJLZXlIYXNoLiBUaGUgYmluYXJ5IGZvcm0gaXMgdGhlCi8vIHB1YktleUhhc2gsIHBsdXMgYSBjaGVja3N1bSBhdCB0aGUgZW5kLiAgVGhlIGNoZWNrc3VtIGlzIHRoZSBmaXJzdCA0IGJ5dGVzCi8vIG9mIHRoZSAoMzIgYnl0ZSkgZG91YmxlIHNoYTI1NiBvZiB0aGUgcHViS2V5SGFzaC4gKDI1IGJ5dGVzIHRvdGFsKQovLyBUaGlzIGlzIGNvbnZlcnRlZCB0byBiYXNlNTggdG8gZm9ybSB0aGUgcHVibGljbHkgdXNlZCBCaXRjb2luIGFkZHJlc3MuCi8vIE1haW5uZXQgUDJQS0ggdHJhbnNhY3Rpb24gc2NyaXB0cyBhcmUgdG8gYWRkcmVzc2VzIGJlZ2lubmluZyB3aXRoICcxJy4KLy8KLy8gUDJTSCAoJ3BheSB0byBzY3JpcHQgaGFzaCcpIHNjcmlwdHMgb25seSBzdXBwbHkgYSBzY3JpcHQgaGFzaC4gVGhlIHNwZW5kZXIKLy8gbXVzdCB0aGVuIHByb3ZpZGUgdGhlIHNjcmlwdCB0aGF0IHdvdWxkIGFsbG93IHRoZW0gdG8gcmVkZWVtIHRoaXMgb3V0cHV0LgovLyBUaGlzIGFsbG93cyBmb3IgYXJiaXRyYXJpbHkgY29tcGxleCBzY3JpcHRzIHRvIGJlIGZ1bmRlZCB1c2luZyBvbmx5IGEKLy8gaGFzaCBvZiB0aGUgc2NyaXB0LCBhbmQgbW92ZXMgdGhlIG9udXMgb24gcHJvdmlkaW5nIHRoZSBzY3JpcHQgZnJvbQovLyB0aGUgc3BlbmRlciB0byB0aGUgcmVkZWVtZXIuCi8vCi8vIFRoZSBQMlNIIHNjcmlwdCBmb3JtYXQgaXMgc2ltcGxlOgovLwovLyBPUF9IQVNIMTYwIDxzY3JpcHRIYXNoPiBPUF9FUVVBTAovLwovLyAweEE5IDB4MTQgPHNjcmlwdEhhc2g+IDB4ODcKLy8KLy8gVGhlIDxzY3JpcHRIYXNoPiBpcyB0aGUgcmlwZW1kMTYwIGhhc2ggb2YgdGhlIHNoYTI1NiBoYXNoIG9mIHRoZQovLyByZWRlZW0gc2NyaXB0LiBUaGUgUDJTSCBhZGRyZXNzIGlzIGRlcml2ZWQgZnJvbSB0aGUgc2NyaXB0SGFzaC4KLy8gQWRkcmVzc2VzIGFyZSB0aGUgc2NyaXB0SGFzaCB3aXRoIGEgdmVyc2lvbiBwcmVmaXggb2YgNSwgZW5jb2RlZCBhcwovLyBCYXNlNThjaGVjay4gVGhlc2UgYWRkcmVzc2VzIGJlZ2luIHdpdGggYSAnMycuCgpwcmFnbWEgc29saWRpdHkgXjAuNC4xMTsKCi8vIHBhcnNlIGEgcmF3IGJpdGNvaW4gdHJhbnNhY3Rpb24gYnl0ZSBhcnJheQpsaWJyYXJ5IEJUQyB7CiAgICAvLyBDb252ZXJ0IGEgdmFyaWFibGUgaW50ZWdlciBpbnRvIHNvbWV0aGluZyB1c2VmdWwgYW5kIHJldHVybiBpdCBhbmQKICAgIC8vIHRoZSBpbmRleCB0byBhZnRlciBpdC4KICAgIGZ1bmN0aW9uIHBhcnNlVmFySW50KGJ5dGVzIHR4Qnl0ZXMsIHVpbnQgcG9zKSByZXR1cm5zICh1aW50LCB1aW50KSB7CiAgICAgICAgLy8gdGhlIGZpcnN0IGJ5dGUgdGVsbHMgdXMgaG93IGJpZyB0aGUgaW50ZWdlciBpcwogICAgICAgIHZhciBpYml0ID0gdWludDgodHhCeXRlc1twb3NdKTsKICAgICAgICBwb3MgKz0gMTsgIC8vIHNraXAgaWJpdAoKICAgICAgICBpZiAoaWJpdCA8IDB4ZmQpIHsKICAgICAgICAgICAgcmV0dXJuIChpYml0LCBwb3MpOwogICAgICAgIH0gZWxzZSBpZiAoaWJpdCA9PSAweGZkKSB7CiAgICAgICAgICAgIHJldHVybiAoZ2V0Qnl0ZXNMRSh0eEJ5dGVzLCBwb3MsIDE2KSwgcG9zICsgMik7CiAgICAgICAgfSBlbHNlIGlmIChpYml0ID09IDB4ZmUpIHsKICAgICAgICAgICAgcmV0dXJuIChnZXRCeXRlc0xFKHR4Qnl0ZXMsIHBvcywgMzIpLCBwb3MgKyA0KTsKICAgICAgICB9IGVsc2UgaWYgKGliaXQgPT0gMHhmZikgewogICAgICAgICAgICByZXR1cm4gKGdldEJ5dGVzTEUodHhCeXRlcywgcG9zLCA2NCksIHBvcyArIDgpOwogICAgICAgIH0KICAgIH0KICAgIC8vIGNvbnZlcnQgbGl0dGxlIGVuZGlhbiBieXRlcyB0byB1aW50CiAgICBmdW5jdGlvbiBnZXRCeXRlc0xFKGJ5dGVzIGRhdGEsIHVpbnQgcG9zLCB1aW50IGJpdHMpIHJldHVybnMgKHVpbnQpIHsKICAgICAgICBpZiAoYml0cyA9PSA4KSB7CiAgICAgICAgICAgIHJldHVybiB1aW50OChkYXRhW3Bvc10pOwogICAgICAgIH0gZWxzZSBpZiAoYml0cyA9PSAxNikgewogICAgICAgICAgICByZXR1cm4gdWludDE2KGRhdGFbcG9zXSkKICAgICAgICAgICAgICAgICArIHVpbnQxNihkYXRhW3BvcyArIDFdKSAqIDIgKiogODsKICAgICAgICB9IGVsc2UgaWYgKGJpdHMgPT0gMzIpIHsKICAgICAgICAgICAgcmV0dXJuIHVpbnQzMihkYXRhW3Bvc10pCiAgICAgICAgICAgICAgICAgKyB1aW50MzIoZGF0YVtwb3MgKyAxXSkgKiAyICoqIDgKICAgICAgICAgICAgICAgICArIHVpbnQzMihkYXRhW3BvcyArIDJdKSAqIDIgKiogMTYKICAgICAgICAgICAgICAgICArIHVpbnQzMihkYXRhW3BvcyArIDNdKSAqIDIgKiogMjQ7CiAgICAgICAgfSBlbHNlIGlmIChiaXRzID09IDY0KSB7CiAgICAgICAgICAgIHJldHVybiB1aW50NjQoZGF0YVtwb3NdKQogICAgICAgICAgICAgICAgICsgdWludDY0KGRhdGFbcG9zICsgMV0pICogMiAqKiA4CiAgICAgICAgICAgICAgICAgKyB1aW50NjQoZGF0YVtwb3MgKyAyXSkgKiAyICoqIDE2CiAgICAgICAgICAgICAgICAgKyB1aW50NjQoZGF0YVtwb3MgKyAzXSkgKiAyICoqIDI0CiAgICAgICAgICAgICAgICAgKyB1aW50NjQoZGF0YVtwb3MgKyA0XSkgKiAyICoqIDMyCiAgICAgICAgICAgICAgICAgKyB1aW50NjQoZGF0YVtwb3MgKyA1XSkgKiAyICoqIDQwCiAgICAgICAgICAgICAgICAgKyB1aW50NjQoZGF0YVtwb3MgKyA2XSkgKiAyICoqIDQ4CiAgICAgICAgICAgICAgICAgKyB1aW50NjQoZGF0YVtwb3MgKyA3XSkgKiAyICoqIDU2OwogICAgICAgIH0KICAgIH0KICAgIC8vIHNjYW4gdGhlIGZ1bGwgdHJhbnNhY3Rpb24gYnl0ZXMgYW5kIHJldHVybiB0aGUgZmlyc3QgdHdvIG91dHB1dAogICAgLy8gdmFsdWVzIChpbiBzYXRvc2hpcykgYW5kIGFkZHJlc3NlcyAoaW4gYmluYXJ5KQogICAgZnVuY3Rpb24gZ2V0Rmlyc3RUd29PdXRwdXRzKGJ5dGVzIHR4Qnl0ZXMpCiAgICAgICAgICAgICByZXR1cm5zICh1aW50LCBieXRlczIwLCB1aW50LCBieXRlczIwKQogICAgewogICAgICAgIHVpbnQgcG9zOwogICAgICAgIHVpbnRbXSBtZW1vcnkgaW5wdXRfc2NyaXB0X2xlbnMgPSBuZXcgdWludFtdKDIpOwogICAgICAgIHVpbnRbXSBtZW1vcnkgb3V0cHV0X3NjcmlwdF9sZW5zID0gbmV3IHVpbnRbXSgyKTsKICAgICAgICB1aW50W10gbWVtb3J5IHNjcmlwdF9zdGFydHMgPSBuZXcgdWludFtdKDIpOwogICAgICAgIHVpbnRbXSBtZW1vcnkgb3V0cHV0X3ZhbHVlcyA9IG5ldyB1aW50W10oMik7CiAgICAgICAgYnl0ZXMyMFtdIG1lbW9yeSBvdXRwdXRfYWRkcmVzc2VzID0gbmV3IGJ5dGVzMjBbXSgyKTsKCiAgICAgICAgcG9zID0gNDsgIC8vIHNraXAgdmVyc2lvbgoKICAgICAgICAoaW5wdXRfc2NyaXB0X2xlbnMsIHBvcykgPSBzY2FuSW5wdXRzKHR4Qnl0ZXMsIHBvcywgMCk7CgogICAgICAgIChvdXRwdXRfdmFsdWVzLCBzY3JpcHRfc3RhcnRzLCBvdXRwdXRfc2NyaXB0X2xlbnMsIHBvcykgPSBzY2FuT3V0cHV0cyh0eEJ5dGVzLCBwb3MsIDIpOwoKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCAyOyBpKyspIHsKICAgICAgICAgICAgdmFyIHBraGFzaCA9IHBhcnNlT3V0cHV0U2NyaXB0KHR4Qnl0ZXMsIHNjcmlwdF9zdGFydHNbaV0sIG91dHB1dF9zY3JpcHRfbGVuc1tpXSk7CiAgICAgICAgICAgIG91dHB1dF9hZGRyZXNzZXNbaV0gPSBwa2hhc2g7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gKG91dHB1dF92YWx1ZXNbMF0sIG91dHB1dF9hZGRyZXNzZXNbMF0sCiAgICAgICAgICAgICAgICBvdXRwdXRfdmFsdWVzWzFdLCBvdXRwdXRfYWRkcmVzc2VzWzFdKTsKICAgIH0KICAgIC8vIENoZWNrIHdoZXRoZXIgYGJ0Y0FkZHJlc3NgIGlzIGluIHRoZSB0cmFuc2FjdGlvbiBvdXRwdXRzICphbmQqCiAgICAvLyB3aGV0aGVyICphdCBsZWFzdCogYHZhbHVlYCBoYXMgYmVlbiBzZW50IHRvIGl0LgogICAgICAgIC8vIENoZWNrIHdoZXRoZXIgYGJ0Y0FkZHJlc3NgIGlzIGluIHRoZSB0cmFuc2FjdGlvbiBvdXRwdXRzICphbmQqCiAgICAvLyB3aGV0aGVyICphdCBsZWFzdCogYHZhbHVlYCBoYXMgYmVlbiBzZW50IHRvIGl0LgogICAgZnVuY3Rpb24gY2hlY2tWYWx1ZVNlbnQoYnl0ZXMgdHhCeXRlcywgYnl0ZXMyMCBidGNBZGRyZXNzLCB1aW50IHZhbHVlKQogICAgICAgICAgICAgcmV0dXJucyAoYm9vbCx1aW50KQogICAgewogICAgICAgIHVpbnQgcG9zID0gNDsgIC8vIHNraXAgdmVyc2lvbgogICAgICAgICgsIHBvcykgPSBzY2FuSW5wdXRzKHR4Qnl0ZXMsIHBvcywgMCk7ICAvLyBmaW5kIGVuZCBvZiBpbnB1dHMKCiAgICAgICAgLy8gc2NhbiAqYWxsKiB0aGUgb3V0cHV0cyBhbmQgZmluZCB3aGVyZSB0aGV5IGFyZQogICAgICAgIHZhciAob3V0cHV0X3ZhbHVlcywgc2NyaXB0X3N0YXJ0cywgb3V0cHV0X3NjcmlwdF9sZW5zLCkgPSBzY2FuT3V0cHV0cyh0eEJ5dGVzLCBwb3MsIDApOwoKICAgICAgICAvLyBsb29rIGF0IGVhY2ggb3V0cHV0IGFuZCBjaGVjayB3aGV0aGVyIGl0IGF0IGxlYXN0IHZhbHVlIHRvIGJ0Y0FkZHJlc3MKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBvdXRwdXRfdmFsdWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBwa2hhc2ggPSBwYXJzZU91dHB1dFNjcmlwdCh0eEJ5dGVzLCBzY3JpcHRfc3RhcnRzW2ldLCBvdXRwdXRfc2NyaXB0X2xlbnNbaV0pOwogICAgICAgICAgICBpZiAocGtoYXNoID09IGJ0Y0FkZHJlc3MgJiYgb3V0cHV0X3ZhbHVlc1tpXSA+PSB2YWx1ZSkgewogICAgICAgICAgICAgICAgcmV0dXJuICh0cnVlLG91dHB1dF92YWx1ZXNbaV0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgLy8gc2NhbiB0aGUgaW5wdXRzIGFuZCBmaW5kIHRoZSBzY3JpcHQgbGVuZ3Rocy4KICAgIC8vIHJldHVybiBhbiBhcnJheSBvZiBzY3JpcHQgbGVuZ3RocyBhbmQgdGhlIGVuZCBwb3NpdGlvbgogICAgLy8gb2YgdGhlIGlucHV0cy4KICAgIC8vIHRha2VzIGEgJ3N0b3AnIGFyZ3VtZW50IHdoaWNoIHNldHMgdGhlIG1heGltdW0gbnVtYmVyIG9mCiAgICAvLyBvdXRwdXRzIHRvIHNjYW4gdGhyb3VnaC4gc3RvcD0wID0+IHNjYW4gYWxsLgogICAgZnVuY3Rpb24gc2NhbklucHV0cyhieXRlcyB0eEJ5dGVzLCB1aW50IHBvcywgdWludCBzdG9wKQogICAgICAgICAgICAgcmV0dXJucyAodWludFtdLCB1aW50KQogICAgewogICAgICAgIHVpbnQgbl9pbnB1dHM7CiAgICAgICAgdWludCBoYWx0OwogICAgICAgIHVpbnQgc2NyaXB0X2xlbjsKCiAgICAgICAgKG5faW5wdXRzLCBwb3MpID0gcGFyc2VWYXJJbnQodHhCeXRlcywgcG9zKTsKCiAgICAgICAgaWYgKHN0b3AgPT0gMCB8fCBzdG9wID4gbl9pbnB1dHMpIHsKICAgICAgICAgICAgaGFsdCA9IG5faW5wdXRzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGhhbHQgPSBzdG9wOwogICAgICAgIH0KCiAgICAgICAgdWludFtdIG1lbW9yeSBzY3JpcHRfbGVucyA9IG5ldyB1aW50W10oaGFsdCk7CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaGFsdDsgaSsrKSB7CiAgICAgICAgICAgIHBvcyArPSAzNjsgIC8vIHNraXAgb3V0cG9pbnQKICAgICAgICAgICAgKHNjcmlwdF9sZW4sIHBvcykgPSBwYXJzZVZhckludCh0eEJ5dGVzLCBwb3MpOwogICAgICAgICAgICBzY3JpcHRfbGVuc1tpXSA9IHNjcmlwdF9sZW47CiAgICAgICAgICAgIHBvcyArPSBzY3JpcHRfbGVuICsgNDsgIC8vIHNraXAgc2lnX3NjcmlwdCwgc2VxCiAgICAgICAgfQoKICAgICAgICByZXR1cm4gKHNjcmlwdF9sZW5zLCBwb3MpOwogICAgfQogICAgLy8gc2NhbiB0aGUgb3V0cHV0cyBhbmQgZmluZCB0aGUgdmFsdWVzIGFuZCBzY3JpcHQgbGVuZ3Rocy4KICAgIC8vIHJldHVybiBhcnJheSBvZiB2YWx1ZXMsIGFycmF5IG9mIHNjcmlwdCBsZW5ndGhzIGFuZCB0aGUKICAgIC8vIGVuZCBwb3NpdGlvbiBvZiB0aGUgb3V0cHV0cy4KICAgIC8vIHRha2VzIGEgJ3N0b3AnIGFyZ3VtZW50IHdoaWNoIHNldHMgdGhlIG1heGltdW0gbnVtYmVyIG9mCiAgICAvLyBvdXRwdXRzIHRvIHNjYW4gdGhyb3VnaC4gc3RvcD0wID0+IHNjYW4gYWxsLgogICAgZnVuY3Rpb24gc2Nhbk91dHB1dHMoYnl0ZXMgdHhCeXRlcywgdWludCBwb3MsIHVpbnQgc3RvcCkKICAgICAgICAgICAgIHJldHVybnMgKHVpbnRbXSwgdWludFtdLCB1aW50W10sIHVpbnQpCiAgICB7CiAgICAgICAgdWludCBuX291dHB1dHM7CiAgICAgICAgdWludCBoYWx0OwogICAgICAgIHVpbnQgc2NyaXB0X2xlbjsKCiAgICAgICAgKG5fb3V0cHV0cywgcG9zKSA9IHBhcnNlVmFySW50KHR4Qnl0ZXMsIHBvcyk7CgogICAgICAgIGlmIChzdG9wID09IDAgfHwgc3RvcCA+IG5fb3V0cHV0cykgewogICAgICAgICAgICBoYWx0ID0gbl9vdXRwdXRzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGhhbHQgPSBzdG9wOwogICAgICAgIH0KCiAgICAgICAgdWludFtdIG1lbW9yeSBzY3JpcHRfc3RhcnRzID0gbmV3IHVpbnRbXShoYWx0KTsKICAgICAgICB1aW50W10gbWVtb3J5IHNjcmlwdF9sZW5zID0gbmV3IHVpbnRbXShoYWx0KTsKICAgICAgICB1aW50W10gbWVtb3J5IG91dHB1dF92YWx1ZXMgPSBuZXcgdWludFtdKGhhbHQpOwoKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhhbHQ7IGkrKykgewogICAgICAgICAgICBvdXRwdXRfdmFsdWVzW2ldID0gZ2V0Qnl0ZXNMRSh0eEJ5dGVzLCBwb3MsIDY0KTsKICAgICAgICAgICAgcG9zICs9IDg7CgogICAgICAgICAgICAoc2NyaXB0X2xlbiwgcG9zKSA9IHBhcnNlVmFySW50KHR4Qnl0ZXMsIHBvcyk7CiAgICAgICAgICAgIHNjcmlwdF9zdGFydHNbaV0gPSBwb3M7CiAgICAgICAgICAgIHNjcmlwdF9sZW5zW2ldID0gc2NyaXB0X2xlbjsKICAgICAgICAgICAgcG9zICs9IHNjcmlwdF9sZW47CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gKG91dHB1dF92YWx1ZXMsIHNjcmlwdF9zdGFydHMsIHNjcmlwdF9sZW5zLCBwb3MpOwogICAgfQogICAgLy8gU2xpY2UgMjAgY29udGlndW91cyBieXRlcyBmcm9tIGJ5dGVzIGBkYXRhYCwgc3RhcnRpbmcgYXQgYHN0YXJ0YAogICAgZnVuY3Rpb24gc2xpY2VCeXRlczIwKGJ5dGVzIGRhdGEsIHVpbnQgc3RhcnQpIHJldHVybnMgKGJ5dGVzMjApIHsKICAgICAgICB1aW50MTYwIHNsaWNlID0gMDsKICAgICAgICBmb3IgKHVpbnQxNjAgaSA9IDA7IGkgPCAyMDsgaSsrKSB7CiAgICAgICAgICAgIHNsaWNlICs9IHVpbnQxNjAoZGF0YVtpICsgc3RhcnRdKSA8PCAoOCAqICgxOSAtIGkpKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJ5dGVzMjAoc2xpY2UpOwogICAgfQogICAgLy8gcmV0dXJucyB0cnVlIGlmIHRoZSBieXRlcyBsb2NhdGVkIGluIHR4Qnl0ZXMgYnkgcG9zIGFuZAogICAgLy8gc2NyaXB0X2xlbiByZXByZXNlbnQgYSBQMlBLSCBzY3JpcHQKICAgIGZ1bmN0aW9uIGlzUDJQS0goYnl0ZXMgdHhCeXRlcywgdWludCBwb3MsIHVpbnQgc2NyaXB0X2xlbikgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiAoc2NyaXB0X2xlbiA9PSAyNSkgICAgICAgICAgIC8vIDIwIGJ5dGUgcHVia2V5aGFzaCArIDUgYnl0ZXMgb2Ygc2NyaXB0CiAgICAgICAgICAgICYmICh0eEJ5dGVzW3Bvc10gPT0gMHg3NikgICAgICAgLy8gT1BfRFVQCiAgICAgICAgICAgICYmICh0eEJ5dGVzW3BvcyArIDFdID09IDB4YTkpICAgLy8gT1BfSEFTSDE2MAogICAgICAgICAgICAmJiAodHhCeXRlc1twb3MgKyAyXSA9PSAweDE0KSAgIC8vIGJ5dGVzIHRvIHB1c2gKICAgICAgICAgICAgJiYgKHR4Qnl0ZXNbcG9zICsgMjNdID09IDB4ODgpICAvLyBPUF9FUVVBTFZFUklGWQogICAgICAgICAgICAmJiAodHhCeXRlc1twb3MgKyAyNF0gPT0gMHhhYyk7IC8vIE9QX0NIRUNLU0lHCiAgICB9CiAgICAvLyByZXR1cm5zIHRydWUgaWYgdGhlIGJ5dGVzIGxvY2F0ZWQgaW4gdHhCeXRlcyBieSBwb3MgYW5kCiAgICAvLyBzY3JpcHRfbGVuIHJlcHJlc2VudCBhIFAyU0ggc2NyaXB0CiAgICBmdW5jdGlvbiBpc1AyU0goYnl0ZXMgdHhCeXRlcywgdWludCBwb3MsIHVpbnQgc2NyaXB0X2xlbikgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiAoc2NyaXB0X2xlbiA9PSAyMykgICAgICAgICAgIC8vIDIwIGJ5dGUgc2NyaXB0aGFzaCArIDMgYnl0ZXMgb2Ygc2NyaXB0CiAgICAgICAgICAgICYmICh0eEJ5dGVzW3BvcyArIDBdID09IDB4YTkpICAgLy8gT1BfSEFTSDE2MAogICAgICAgICAgICAmJiAodHhCeXRlc1twb3MgKyAxXSA9PSAweDE0KSAgIC8vIGJ5dGVzIHRvIHB1c2gKICAgICAgICAgICAgJiYgKHR4Qnl0ZXNbcG9zICsgMjJdID09IDB4ODcpOyAvLyBPUF9FUVVBTAogICAgfQogICAgLy8gR2V0IHRoZSBwdWJrZXloYXNoIC8gc2NyaXB0aGFzaCBmcm9tIGFuIG91dHB1dCBzY3JpcHQuIEFzc3VtZXMKICAgIC8vIHBheS10by1wdWJrZXktaGFzaCAoUDJQS0gpIG9yIHBheS10by1zY3JpcHQtaGFzaCAoUDJTSCkgb3V0cHV0cy4KICAgIC8vIFJldHVybnMgdGhlIHB1YmtleWhhc2gvIHNjcmlwdGhhc2gsIG9yIHplcm8gaWYgdW5rbm93biBvdXRwdXQuCiAgICBmdW5jdGlvbiBwYXJzZU91dHB1dFNjcmlwdChieXRlcyB0eEJ5dGVzLCB1aW50IHBvcywgdWludCBzY3JpcHRfbGVuKQogICAgICAgICAgICAgcmV0dXJucyAoYnl0ZXMyMCkKICAgIHsKICAgICAgICBpZiAoaXNQMlBLSCh0eEJ5dGVzLCBwb3MsIHNjcmlwdF9sZW4pKSB7CiAgICAgICAgICAgIHJldHVybiBzbGljZUJ5dGVzMjAodHhCeXRlcywgcG9zICsgMyk7CiAgICAgICAgfSBlbHNlIGlmIChpc1AyU0godHhCeXRlcywgcG9zLCBzY3JpcHRfbGVuKSkgewogICAgICAgICAgICByZXR1cm4gc2xpY2VCeXRlczIwKHR4Qnl0ZXMsIHBvcyArIDIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9Pd25hYmxlLnNvbAoKY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgogIGZ1bmN0aW9uIE93bmFibGUoKSB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICBpZiAobXNnLnNlbmRlciA9PSBvd25lcikKICAgICAgXzsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciB7CiAgICBpZiAobmV3T3duZXIgIT0gYWRkcmVzcygwKSkgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9CgovLyBGaWxlOiBjb250cmFjdHMvUGF1c2FibGUuc29sCgovKgogKiBQYXVzYWJsZQogKiBBYnN0cmFjdCBjb250cmFjdCB0aGF0IGFsbG93cyBjaGlsZHJlbiB0byBpbXBsZW1lbnQgYW4KICogZW1lcmdlbmN5IHN0b3AgbWVjaGFuaXNtLgogKi8KCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgewogIGJvb2wgcHVibGljIHN0b3BwZWQ7CgogIG1vZGlmaWVyIHN0b3BJbkVtZXJnZW5jeSB7CiAgICBpZiAoc3RvcHBlZCkgewogICAgICB0aHJvdzsKICAgIH0KICAgIF87CiAgfQoKICBtb2RpZmllciBvbmx5SW5FbWVyZ2VuY3kgewogICAgaWYgKCFzdG9wcGVkKSB7CiAgICAgIHRocm93OwogICAgfQogICAgXzsKICB9CgogIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW1lcmdlbmN5LCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlCiAgZnVuY3Rpb24gZW1lcmdlbmN5U3RvcCgpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICBzdG9wcGVkID0gdHJ1ZTsKICB9CgogIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW5kIG9mIGVtZXJnZW5jeSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICBmdW5jdGlvbiByZWxlYXNlKCkgZXh0ZXJuYWwgb25seU93bmVyIG9ubHlJbkVtZXJnZW5jeSB7CiAgICBzdG9wcGVkID0gZmFsc2U7CiAgfQoKfQoKLy8gRmlsZTogY29udHJhY3RzL1NhZmVNYXRoLnNvbAoKLyoqCiAqIE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MKICovCmNvbnRyYWN0IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBzYWZlTXVsKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICB1aW50IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHNhZmVEaXYodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIGFzc2VydChiID4gMCk7CiAgICB1aW50IGMgPSBhIC8gYjsKICAgIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzYWZlU3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIHNhZmVBZGQodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIHVpbnQgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGM+PWEgJiYgYz49Yik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIG1heDY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7CiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7CiAgfQoKICBmdW5jdGlvbiBtaW42NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgewogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7CiAgfQoKICBmdW5jdGlvbiBtYXgyNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBhID49IGIgPyBhIDogYjsKICB9CgogIGZ1bmN0aW9uIG1pbjI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7CiAgfQoKfQoKLy8gRmlsZTogY29udHJhY3RzL1N0YW5kYXJkVG9rZW4uc29sCgpjb250cmFjdCBUb2tlbiB7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOwogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKfQoKCi8qICBFUkMgMjAgdG9rZW4gKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBUb2tlbiB7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIF92YWx1ZSA+IDApIHsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgIGlmIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7CiAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7CiAgICAgICAgYmFsYW5jZXNbX2Zyb21dIC09IF92YWx1ZTsKICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CgoKfQoKLy8gRmlsZTogY29udHJhY3RzL1V0aWxzLnNvbAoKY29udHJhY3QgVXRpbHN7CgoJLy92ZXJpZmllcyB0aGUgYW1vdW50IGdyZWF0ZXIgdGhhbiB6ZXJvCgoJbW9kaWZpZXIgZ3JlYXRlclRoYW5aZXJvKHVpbnQyNTYgX3ZhbHVlKXsKCQlyZXF1aXJlKF92YWx1ZT4wKTsKCQlfOwoJfQoKCS8vL3ZlcmlmaWVzIGFuIGFkZHJlc3MKCgltb2RpZmllciB2YWxpZEFkZHJlc3MoYWRkcmVzcyBfYWRkKXsKCQlyZXF1aXJlKF9hZGQhPTB4MCk7CgkJXzsKCX0KfQoKLy8gRmlsZTogY29udHJhY3RzL0Nyb3dkc2FsZS5zb2wKCmNvbnRyYWN0IENyb3dkc2FsZSBpcyBTdGFuZGFyZFRva2VuLCBQYXVzYWJsZSwgU2FmZU1hdGgsIFV0aWxzewoJc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIk11ZHJhIjsKCXN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIk1VRFJBIjsKCXVpbnQyNTYgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CglzdHJpbmcgcHVibGljIHZlcnNpb24gPSAiMS4wIjsKCWJvb2wgcHVibGljIHRyYWRpbmdTdGFydGVkID0gZmFsc2U7CgogICAgLyoqCiAgICogQGRldiBtb2RpZmllciB0aGF0IHRocm93cyBpZiB0cmFkaW5nIGhhcyBub3Qgc3RhcnRlZCB5ZXQKICAgKi8KICAgbW9kaWZpZXIgaGFzU3RhcnRlZFRyYWRpbmcoKSB7CiAgIAlyZXF1aXJlKHRyYWRpbmdTdGFydGVkKTsKICAgCV87CiAgIH0KICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgb3duZXIgdG8gZW5hYmxlIHRoZSB0cmFkaW5nLiBUaGlzIGNhbiBub3QgYmUgdW5kb25lCiAgICovCiAgIGZ1bmN0aW9uIHN0YXJ0VHJhZGluZygpIG9ubHlPd25lcigpIHsKICAgCXRyYWRpbmdTdGFydGVkID0gdHJ1ZTsKICAgfQoKICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBoYXNTdGFydGVkVHJhZGluZyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHtzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7fQoKICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgaGFzU3RhcnRlZFRyYWRpbmcgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7c3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7fQoKICAgZW51bSBTdGF0ZXsKICAgCUluYWN0aXZlLAogICAJRnVuZGluZywKICAgCVN1Y2Nlc3MsCiAgIAlGYWlsdXJlCiAgIH0KCiAgIHVpbnQyNTYgcHVibGljIGludmVzdG1lbnRFVEg7CiAgIHVpbnQyNTYgcHVibGljIGludmVzdG1lbnRCVEM7CiAgIG1hcHBpbmcodWludDI1NiA9PiBib29sKSB0cmFuc2FjdGlvbnNDbGFpbWVkOwogICB1aW50MjU2IHB1YmxpYyBpbml0aWFsU3VwcGx5OwogICBhZGRyZXNzIHdhbGxldDsKICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgX3RvdGFsU3VwcGx5ID0gMTAwICogKDEwKio2KSAqIDEwICoqIGRlY2ltYWxzOyAvLyAxMDBNIH4gMTAgQ3JvcmVzCiAgIHVpbnQyNTYgcHVibGljIGZ1bmRpbmdTdGFydEJsb2NrOyAvLyBjcm93ZHNhbGUgc3RhcnQgYmxvY2sKICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgbWluQnRjVmFsdWUgPSAxMDAwMDsgLy8gfiBhcHByb3ggMSQKICAgdWludDI1NiBwdWJsaWMgdG9rZW5zUGVyRXRoZXIgPSA0NTA7IC8vIDEgRVRIID0gNDYwIHRva2VucwogICB1aW50MjU2IHB1YmxpYyB0b2tlbnNQZXJCVEMgPSAxNDAgKiAxMCAqKiAxMCAqIDEwICoqIDI7IC8vIDEgYnRjID0gMTE1MDAgVG9rZW5zCiAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IHRva2VuQ3JlYXRpb25NYXggPSAxMCAqICgxMCoqNikgKiAxMCAqKiBkZWNpbWFsczsgLy8gMTBNIH4gMSBDcm9yZXMKICAgYWRkcmVzc1tdIHB1YmxpYyBpbnZlc3RvcnM7CgogICAvL2Rpc3BsYXlzIG51bWJlciBvZiB1bmlxIGludmVzdG9ycwogICBmdW5jdGlvbiBpbnZlc3RvcnNDb3VudCgpIGNvbnN0YW50IGV4dGVybmFsIHJldHVybnModWludCkgeyByZXR1cm4gaW52ZXN0b3JzLmxlbmd0aDsgfQoKICAgZnVuY3Rpb24gQ3Jvd2RzYWxlKHVpbnQyNTYgX2Z1bmRpbmdTdGFydEJsb2NrLCBhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfd2FsbGV0KXsKICAgICAgb3duZXIgPSBfb3duZXI7CiAgICAgIGZ1bmRpbmdTdGFydEJsb2NrID1fZnVuZGluZ1N0YXJ0QmxvY2s7CiAgICAgIHRvdGFsU3VwcGx5ID0gX3RvdGFsU3VwcGx5OwogICAgICBpbml0aWFsU3VwcGx5ID0gMDsKICAgICAgd2FsbGV0ID0gX3dhbGxldDsKCiAgICAgIC8vY2hlY2sgY29uZmlndXJhdGlvbiBpZiBzb21ldGhpbmcgaW4gc2V0dXAgaXMgbG9va2luZyB3ZWlyZAogICAgICBpZiAoCiAgICAgICAgdG9rZW5zUGVyRXRoZXIgPT0gMAogICAgICAgIHx8IHRva2Vuc1BlckJUQyA9PSAwCiAgICAgICAgfHwgb3duZXIgPT0gMHgwCiAgICAgICAgfHwgd2FsbGV0ID09IDB4MAogICAgICAgIHx8IGZ1bmRpbmdTdGFydEJsb2NrID09IDAKICAgICAgICB8fCB0b3RhbFN1cHBseSA9PSAwCiAgICAgICAgfHwgdG9rZW5DcmVhdGlvbk1heCA9PSAwCiAgICAgICAgfHwgZnVuZGluZ1N0YXJ0QmxvY2sgPD0gYmxvY2subnVtYmVyKQogICAgICB0aHJvdzsKCiAgIH0KCiAgIC8vIGRvbid0IGp1c3Qgc2VuZCBldGhlciB0byB0aGUgY29udHJhY3QgZXhwZWN0aW5nIHRvIGdldCB0b2tlbnMKICAgLy9mdW5jdGlvbigpIHsgdGhyb3c7IH0KICAgLy8vL0BkZXYgVGhpcyBmdW5jdGlvbiBtYW5hZ2VzIHRoZSBDcm93ZHNhbGUgU3RhdGUgbWFjaGluZQogICAvLy9XZSBtYWtlIGl0IGEgZnVuY3Rpb24gYW5kIGRvIG5vdCBhc3NpZ24gdG8gYSB2YXJpYWJsZS8vCiAgIC8vL3NvIHRoYXQgbm8gY2hhbmNlIG9mIHN0YWxlIHZhcmlhYmxlCiAgIGZ1bmN0aW9uIGdldFN0YXRlKCkgY29uc3RhbnQgcHVibGljIHJldHVybnMoU3RhdGUpewogICAJLy8vb25jZSB3ZSByZWFjaCBzdWNjZXNzIGxvY2sgdGhlIFN0YXRlCiAgIAlpZihibG9jay5udW1iZXI8ZnVuZGluZ1N0YXJ0QmxvY2spIHJldHVybiBTdGF0ZS5JbmFjdGl2ZTsKICAgCWVsc2UgaWYoYmxvY2subnVtYmVyPmZ1bmRpbmdTdGFydEJsb2NrICYmIGluaXRpYWxTdXBwbHk8dG9rZW5DcmVhdGlvbk1heCkgcmV0dXJuIFN0YXRlLkZ1bmRpbmc7CiAgIAllbHNlIGlmIChpbml0aWFsU3VwcGx5ID49IHRva2VuQ3JlYXRpb25NYXgpIHJldHVybiBTdGF0ZS5TdWNjZXNzOwogICAJZWxzZSByZXR1cm4gU3RhdGUuRmFpbHVyZTsKICAgfQoKICAgLy8vZ2V0IHRvdGFsIHRva2VucyBpbiB0aGF0IGFkZHJlc3MgbWFwcGluZwogICBmdW5jdGlvbiBnZXRUb2tlbnMoYWRkcmVzcyBhZGRyKSBwdWJsaWMgcmV0dXJucyh1aW50MjU2KXsKICAgCXJldHVybiBiYWxhbmNlc1thZGRyXTsKICAgfQoKICAgLy8vZ2V0IHRoZSBibG9jayBudW1iZXIgc3RhdGUKICAgZnVuY3Rpb24gZ2V0U3RhdGVGdW5kaW5nKCkgcHVibGljIHJldHVybnMgKHVpbnQyNTYpewogICAJLy8gYXZlcmFnZSA2MDAwIGJsb2NrcyBtaW5lZCBpbiAyNCBocnMKICAgCWlmKGJsb2NrLm51bWJlcjxmdW5kaW5nU3RhcnRCbG9jayArIDE4MDAwMCkgcmV0dXJuIDIwOyAvLyAxIG1vbnRoIDIwJQogICAJZWxzZSBpZihibG9jay5udW1iZXI+PWZ1bmRpbmdTdGFydEJsb2NrKyAxODAwMDEgJiYgYmxvY2subnVtYmVyPGZ1bmRpbmdTdGFydEJsb2NrICsgMjcwMDAwKSByZXR1cm4gMTA7IC8vIG5leHQgMTUgZGF5cwogICAJZWxzZSBpZihibG9jay5udW1iZXI+PWZ1bmRpbmdTdGFydEJsb2NrICsgMjcwMDAxICYmIGJsb2NrLm51bWJlcjxmdW5kaW5nU3RhcnRCbG9jayArIDM2MDAwKSByZXR1cm4gNTsgLy8gbmV4dCAxNSBkYXlzCiAgIAllbHNlIHJldHVybiAwOwogICB9CiAgIC8vL2EgZnVuY3Rpb24gdXNpbmcgc2FmZW1hdGggdG8gd29yayB3aXRoCiAgIC8vL3RoZSBuZXcgZnVuY3Rpb24KICAgZnVuY3Rpb24gY2FsTmV3VG9rZW5zKHVpbnQyNTYgdG9rZW5zKSByZXR1cm5zICh1aW50MjU2KXsKICAgCXVpbnQyNTYgZGlzYyA9IGdldFN0YXRlRnVuZGluZygpOwogICAJdG9rZW5zID0gc2FmZUFkZCh0b2tlbnMsc2FmZURpdihzYWZlTXVsKHRva2VucyxkaXNjKSwxMDApKTsKICAgCXJldHVybiB0b2tlbnM7CiAgIH0KCiAgIGZ1bmN0aW9uKCkgZXh0ZXJuYWwgcGF5YWJsZSBzdG9wSW5FbWVyZ2VuY3l7CiAgIAkvLyBBYm9ydCBpZiBub3QgaW4gRnVuZGluZyBBY3RpdmUgc3RhdGUuCiAgIAlpZihnZXRTdGF0ZSgpID09IFN0YXRlLlN1Y2Nlc3MpIHRocm93OwogICAJaWYgKG1zZy52YWx1ZSA9PSAwKSB0aHJvdzsKICAgCXVpbnQyNTYgbmV3Q3JlYXRlZFRva2VucyA9IHNhZmVNdWwobXNnLnZhbHVlLHRva2Vuc1BlckV0aGVyKTsKICAgCW5ld0NyZWF0ZWRUb2tlbnMgPSBjYWxOZXdUb2tlbnMobmV3Q3JlYXRlZFRva2Vucyk7CiAgIAkvLy9zaW5jZSB3ZSBhcmUgY3JlYXRpbmcgdG9rZW5zIHdlIG5lZWQgdG8gaW5jcmVhc2UgdGhlIHRvdGFsIHN1cHBseQogICAJaW5pdGlhbFN1cHBseSA9IHNhZmVBZGQoaW5pdGlhbFN1cHBseSxuZXdDcmVhdGVkVG9rZW5zKTsKICAgCWlmKGluaXRpYWxTdXBwbHk+dG9rZW5DcmVhdGlvbk1heCkgdGhyb3c7CiAgICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA9PSAwKSBpbnZlc3RvcnMucHVzaChtc2cuc2VuZGVyKTsKICAgICAgaW52ZXN0bWVudEVUSCArPSBtc2cudmFsdWU7CiAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gc2FmZUFkZChiYWxhbmNlc1ttc2cuc2VuZGVyXSxuZXdDcmVhdGVkVG9rZW5zKTsKICAgICAgLy8gUG9ja2V0IHRoZSBtb25leQogICAgICBpZighd2FsbGV0LnNlbmQobXNnLnZhbHVlKSkgdGhyb3c7CiAgIH0KCgogICAvLy90b2tlbiBkaXN0cmlidXRpb24gaW5pdGlhbCBmdW5jdGlvbiBmb3IgdGhlIG9uZSBpbiB0aGUgZXhjaGFuZ2VzCiAgIC8vL3RvIGJlIGRvbmUgb25seSB0aGUgb3duZXIgY2FuIHJ1biB0aGlzIGZ1bmN0aW9uCiAgIGZ1bmN0aW9uIHRva2VuQXNzaWduRXhjaGFuZ2UoYWRkcmVzcyBhZGRyLHVpbnQyNTYgdmFsKQogICBleHRlcm5hbAogICBzdG9wSW5FbWVyZ2VuY3kKICAgb25seU93bmVyKCkKICAgewogICAJaWYoZ2V0U3RhdGUoKSA9PSBTdGF0ZS5TdWNjZXNzKSB0aHJvdzsKICAgIGlmKGFkZHIgPT0gMHgwKSB0aHJvdzsKICAgCWlmICh2YWwgPT0gMCkgdGhyb3c7CiAgIAl1aW50MjU2IG5ld0NyZWF0ZWRUb2tlbnMgPSBzYWZlTXVsKHZhbCx0b2tlbnNQZXJFdGhlcik7CiAgIAluZXdDcmVhdGVkVG9rZW5zID0gY2FsTmV3VG9rZW5zKG5ld0NyZWF0ZWRUb2tlbnMpOwogICAJaW5pdGlhbFN1cHBseSA9IHNhZmVBZGQoaW5pdGlhbFN1cHBseSxuZXdDcmVhdGVkVG9rZW5zKTsKICAgCWlmKGluaXRpYWxTdXBwbHk+dG9rZW5DcmVhdGlvbk1heCkgdGhyb3c7CiAgICAgIGlmIChiYWxhbmNlc1thZGRyXSA9PSAwKSBpbnZlc3RvcnMucHVzaChhZGRyKTsKICAgICAgaW52ZXN0bWVudEVUSCArPSB2YWw7CiAgICAgIGJhbGFuY2VzW2FkZHJdID0gc2FmZUFkZChiYWxhbmNlc1thZGRyXSxuZXdDcmVhdGVkVG9rZW5zKTsKICAgfQoKICAgLy8vZnVuY3Rpb24gdG8gcnVuIHdoZW4gdGhlIHRyYW5zYWN0aW9uIGhhcyBiZWVuIHZlaWZpZWQKICAgZnVuY3Rpb24gcHJvY2Vzc1RyYW5zYWN0aW9uKGJ5dGVzIHR4biwgdWludDI1NiB0eEhhc2gsYWRkcmVzcyBhZGRyLGJ5dGVzMjAgYnRjYWRkcikKICAgZXh0ZXJuYWwKICAgc3RvcEluRW1lcmdlbmN5CiAgIG9ubHlPd25lcigpCiAgIHJldHVybnMgKHVpbnQpCiAgIHsKICAgCWlmKGdldFN0YXRlKCkgPT0gU3RhdGUuU3VjY2VzcykgdGhyb3c7CiAgICBpZihhZGRyID09IDB4MCkgdGhyb3c7CiAgIAl2YXIgKG91dHB1dDEsb3V0cHV0MixvdXRwdXQzLG91dHB1dDQpID0gQlRDLmdldEZpcnN0VHdvT3V0cHV0cyh0eG4pOwogICAgICBpZih0cmFuc2FjdGlvbnNDbGFpbWVkW3R4SGFzaF0pIHRocm93OwogICAgICB2YXIgKGEsYikgPSBCVEMuY2hlY2tWYWx1ZVNlbnQodHhuLGJ0Y2FkZHIsbWluQnRjVmFsdWUpOwogICAgICBpZihhKXsKICAgICAgICAgdHJhbnNhY3Rpb25zQ2xhaW1lZFt0eEhhc2hdID0gdHJ1ZTsKICAgICAgICAgdWludDI1NiBuZXdDcmVhdGVkVG9rZW5zID0gc2FmZU11bChiLHRva2Vuc1BlckJUQyk7CiAgICAgICAgIC8vL3NpbmNlIHdlIGFyZSBjcmVhdGluZyB0b2tlbnMgd2UgbmVlZCB0byBpbmNyZWFzZSB0aGUgdG90YWwgc3VwcGx5CiAgICAgICAgIG5ld0NyZWF0ZWRUb2tlbnMgPSBjYWxOZXdUb2tlbnMobmV3Q3JlYXRlZFRva2Vucyk7CiAgICAgICAgIGluaXRpYWxTdXBwbHkgPSBzYWZlQWRkKGluaXRpYWxTdXBwbHksbmV3Q3JlYXRlZFRva2Vucyk7CiAgICAgICAgIC8vL3JlbWVtYmVyIG5vdCB0byBnbyBvZmYgdGhlIExJTUlUUyEhCiAgICAgICAgIGlmKGluaXRpYWxTdXBwbHk+dG9rZW5DcmVhdGlvbk1heCkgdGhyb3c7CiAgICAgICAgIGlmIChiYWxhbmNlc1thZGRyXSA9PSAwKSBpbnZlc3RvcnMucHVzaChhZGRyKTsKICAgICAgICAgaW52ZXN0bWVudEJUQyArPSBiOwogICAgICAgICBiYWxhbmNlc1thZGRyXSA9IHNhZmVBZGQoYmFsYW5jZXNbYWRkcl0sbmV3Q3JlYXRlZFRva2Vucyk7CiAgICAgICAgIHJldHVybiAxOwogICAgICB9CiAgICAgIGVsc2UgcmV0dXJuIDA7CiAgIH0KCiAgIC8vL2NoYW5nZSBleGNoYW5nZSByYXRlIH4gdXBkYXRlIHByaWNlIGV2ZXJ5ZGF5CiAgIGZ1bmN0aW9uIGNoYW5nZUV4Y2hhbmdlUmF0ZSh1aW50MjU2IGV0aCwgdWludDI1NiBidGMpCiAgIGV4dGVybmFsCiAgIG9ubHlPd25lcigpCiAgIHsKICAgICBpZihldGggPT0gMCB8fCBidGMgPT0gMCkgdGhyb3c7CiAgICAgdG9rZW5zUGVyRXRoZXIgPSBldGg7CiAgICAgdG9rZW5zUGVyQlRDID0gYnRjOwogIH0KCiAgLy8vYmxhY2tsaXN0IHRoZSB1c2VycyB3aGljaCBhcmUgZnJhdWR1bGVudAogIC8vL2Zyb20gZ2V0dGluZyBhbnkgdG9rZW5zCiAgLy8vdG8gZG8gYWxzbyByZWZ1bmQganVzdCBpbiBjYXNlcwogIGZ1bmN0aW9uIGJsYWNrbGlzdChhZGRyZXNzIGFkZHIpCiAgZXh0ZXJuYWwKICBvbmx5T3duZXIoKQogIHsKICAgICBiYWxhbmNlc1thZGRyXSA9IDA7CiAgfQoKfQ=='.
	

]
