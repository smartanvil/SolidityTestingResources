Class {
	#name : #SRT14c1179b52a41b85b738a9483b12060516efcda4,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT14c1179b52a41b85b738a9483b12060516efcda4 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgoKLyoqCiogQHRpdGxlIFNhZmVNYXRoCiogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgICAvKioKICAgICogQGRldiBNdWx0aXBsaWVzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgICAqLwogICAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBpZiAoYSA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgICAgICB1aW50MjU2IGMgPSBhICogYjsKICAgICAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgSW50ZWdlciBkaXZpc2lvbiBvZiB0d28gbnVtYmVycywgdHJ1bmNhdGluZyB0aGUgcXVvdGllbnQuCiAgICAqLwogICAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgICAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgICAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAgICovCiAgICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGFzc2VydChiIDw9IGEpOwogICAgICAgIHJldHVybiBhIC0gYjsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgICAqLwogICAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgICAgICBhc3NlcnQoYyA+PSBhKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KfQoKCi8qKgogKiBAdGl0bGUgT3duYWJsZQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuCiAqLwpjb250cmFjdCBPd25hYmxlIHsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwoKICAgIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKICAgIC8qKgogICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgICogYWNjb3VudC4KICAgICovCiAgICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgICovCiAgICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgCiAgICAgICAgZW1pdCBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICB9Cn0KCmludGVyZmFjZSB0b2tlblJlY2lwaWVudCB7IGZ1bmN0aW9uIHJlY2VpdmVBcHByb3ZhbChhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF92YWx1ZSwgYWRkcmVzcyBfdG9rZW4sIGJ5dGVzIF9leHRyYURhdGEpIGV4dGVybmFsOyB9Cgpjb250cmFjdCBUb2tlbkVSQzIwIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIC8vIFB1YmxpYyB2YXJpYWJsZXMgb2YgdGhlIHRva2VuCiAgICBzdHJpbmcgcHVibGljIG5hbWU7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsKICAgIHVpbnQ4IHB1YmxpYyBkZWNpbWFscyA9IDE4OwogICAgLy8gMTggZGVjaW1hbHMgaXMgdGhlIHN0cm9uZ2x5IHN1Z2dlc3RlZCBkZWZhdWx0LCBhdm9pZCBjaGFuZ2luZyBpdAogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CgogICAgLy8gVGhpcyBjcmVhdGVzIGFuIGFycmF5IHdpdGggYWxsIGJhbGFuY2VzCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBiYWxhbmNlT2Y7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIHB1YmxpYyBhbGxvd2FuY2U7CgogICAgLy8gVGhpcyBnZW5lcmF0ZXMgYSBwdWJsaWMgZXZlbnQgb24gdGhlIGJsb2NrY2hhaW4gdGhhdCB3aWxsIG5vdGlmeSBjbGllbnRzCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKCiAgICAvLyBUaGlzIG5vdGlmaWVzIGNsaWVudHMgYWJvdXQgdGhlIGFtb3VudCBidXJudAogICAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgdWludDI1NiB2YWx1ZSk7CgogICAgLyoqCiAgICAqIENvbnN0cnVjdG9yIGZ1bmN0aW9uCiAgICAqCiAgICAqIEluaXRpYWxpemVzIGNvbnRyYWN0IHdpdGggaW5pdGlhbCBzdXBwbHkgdG9rZW5zIHRvIHRoZSBjcmVhdG9yIG9mIHRoZSBjb250cmFjdAogICAgKi8KICAgIGZ1bmN0aW9uIFRva2VuRVJDMjAoCiAgICAgICAgdWludDI1NiBpbml0aWFsU3VwcGx5LAogICAgICAgIHN0cmluZyB0b2tlbk5hbWUsCiAgICAgICAgc3RyaW5nIHRva2VuU3ltYm9sCiAgICApIHB1YmxpYyB7CiAgICAgICAgdG90YWxTdXBwbHkgPSBpbml0aWFsU3VwcGx5ICogMTAgKiogdWludDI1NihkZWNpbWFscyk7ICAvLyBVcGRhdGUgdG90YWwgc3VwcGx5IHdpdGggdGhlIGRlY2ltYWwgYW1vdW50CiAgICAgICAgYmFsYW5jZU9mW21zZy5zZW5kZXJdID0gdG90YWxTdXBwbHk7ICAgICAgICAgICAgICAgIC8vIEdpdmUgdGhlIGNyZWF0b3IgYWxsIGluaXRpYWwgdG9rZW5zCiAgICAgICAgbmFtZSA9IHRva2VuTmFtZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgbmFtZSBmb3IgZGlzcGxheSBwdXJwb3NlcwogICAgICAgIHN5bWJvbCA9IHRva2VuU3ltYm9sOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIHN5bWJvbCBmb3IgZGlzcGxheSBwdXJwb3NlcwogICAgfQoKICAgIC8qKgogICAgKiBJbnRlcm5hbCB0cmFuc2Zlciwgb25seSBjYW4gYmUgY2FsbGVkIGJ5IHRoaXMgY29udHJhY3QKICAgICoKICAgICogU2VuZCBgX3ZhbHVlYCB0b2tlbnMgdG8gYF90b2AgZnJvbSBgX2Zyb21gCiAgICAqCiAgICAqIEBwYXJhbSBfZnJvbSBBZGRyZXNzIG9mIHRoZSBzZW5kZXIKICAgICogQHBhcmFtIF90byBBZGRyZXNzIG9mIHRoZSByZWNpcGllbnQKICAgICogQHBhcmFtIF92YWx1ZSB0aGUgYW1vdW50IHRvIHNlbmQKICAgICovCiAgICBmdW5jdGlvbiBfdHJhbnNmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBpbnRlcm5hbCB7CiAgICAgICAgLy8gUHJldmVudCB0cmFuc2ZlciB0byAweDAgYWRkcmVzcy4gVXNlIGJ1cm4oKSBpbnN0ZWFkCiAgICAgICAgcmVxdWlyZShfdG8gIT0gMHgwKTsKICAgICAgICAvLyBDaGVjayBpZiB0aGUgc2VuZGVyIGhhcyBlbm91Z2gKICAgICAgICByZXF1aXJlKGJhbGFuY2VPZltfZnJvbV0gPj0gX3ZhbHVlKTsKCiAgICAgICAgLy8gQ2hlY2sgZm9yIG92ZXJmbG93cwogICAgICAgIHJlcXVpcmUoYmFsYW5jZU9mW190b10uYWRkKF92YWx1ZSkgPiBiYWxhbmNlT2ZbX3RvXSk7CgogICAgICAgIC8vIFNhdmUgdGhpcyBmb3IgYW4gYXNzZXJ0aW9uIGluIHRoZSBmdXR1cmUKICAgICAgICB1aW50IHByZXZpb3VzQmFsYW5jZXMgPSBiYWxhbmNlT2ZbX2Zyb21dLmFkZChiYWxhbmNlT2ZbX3RvXSk7CgogICAgICAgIC8vIFN1YnRyYWN0IGZyb20gdGhlIHNlbmRlcgogICAgICAgIGJhbGFuY2VPZltfZnJvbV0gPSBiYWxhbmNlT2ZbX2Zyb21dLnN1YihfdmFsdWUpOwoKICAgICAgICAvLyBBZGQgdGhlIHNhbWUgdG8gdGhlIHJlY2lwaWVudAogICAgICAgIGJhbGFuY2VPZltfdG9dID0gYmFsYW5jZU9mW190b10uYWRkKF92YWx1ZSk7CgogICAgICAgIGVtaXQgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICAvLyBBc3NlcnRzIGFyZSB1c2VkIHRvIHVzZSBzdGF0aWMgYW5hbHlzaXMgdG8gZmluZCBidWdzIGluIHlvdXIgY29kZS4gVGhleSBzaG91bGQgbmV2ZXIgZmFpbAogICAgICAgIGFzc2VydChiYWxhbmNlT2ZbX2Zyb21dLmFkZChiYWxhbmNlT2ZbX3RvXSkgPT0gcHJldmlvdXNCYWxhbmNlcyk7CiAgICB9CgogICAgLyoqCiAgICAqIFRyYW5zZmVyIHRva2VucwogICAgKgogICAgKiBTZW5kIGBfdmFsdWVgIHRva2VucyB0byBgX3RvYCBmcm9tIHlvdXIgYWNjb3VudAogICAgKgogICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQKICAgICogQHBhcmFtIF92YWx1ZSB0aGUgYW1vdW50IHRvIHNlbmQKICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB7CiAgICAgICAgX3RyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICAvKioKICAgICogVHJhbnNmZXIgdG9rZW5zIGZyb20gb3RoZXIgYWRkcmVzcwogICAgKgogICAgKiBTZW5kIGBfdmFsdWVgIHRva2VucyB0byBgX3RvYCBpbiBiZWhhbGYgb2YgYF9mcm9tYAogICAgKgogICAgKiBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3Mgb2YgdGhlIHNlbmRlcgogICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQKICAgICogQHBhcmFtIF92YWx1ZSB0aGUgYW1vdW50IHRvIHNlbmQKICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYWxsb3dhbmNlW19mcm9tXVttc2cuc2VuZGVyXSk7ICAgICAvLyBDaGVjayBhbGxvd2FuY2UKICAgICAgICAvL2FsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOwogICAgICAgIGFsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0gPSBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIF90cmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgKiBTZXQgYWxsb3dhbmNlIGZvciBvdGhlciBhZGRyZXNzCiAgICAqCiAgICAqIEFsbG93cyBgX3NwZW5kZXJgIHRvIHNwZW5kIG5vIG1vcmUgdGhhbiBgX3ZhbHVlYCB0b2tlbnMgaW4geW91ciBiZWhhbGYKICAgICoKICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIGF1dGhvcml6ZWQgdG8gc3BlbmQKICAgICogQHBhcmFtIF92YWx1ZSB0aGUgbWF4IGFtb3VudCB0aGV5IGNhbiBzcGVuZAogICAgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYwogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGFsbG93YW5jZVttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAqIFNldCBhbGxvd2FuY2UgZm9yIG90aGVyIGFkZHJlc3MgYW5kIG5vdGlmeQogICAgKgogICAgKiBBbGxvd3MgYF9zcGVuZGVyYCB0byBzcGVuZCBubyBtb3JlIHRoYW4gYF92YWx1ZWAgdG9rZW5zIGluIHlvdXIgYmVoYWxmLCBhbmQgdGhlbiBwaW5nIHRoZSBjb250cmFjdCBhYm91dCBpdAogICAgKgogICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3MgYXV0aG9yaXplZCB0byBzcGVuZAogICAgKiBAcGFyYW0gX3ZhbHVlIHRoZSBtYXggYW1vdW50IHRoZXkgY2FuIHNwZW5kCiAgICAqIEBwYXJhbSBfZXh0cmFEYXRhIHNvbWUgZXh0cmEgaW5mb3JtYXRpb24gdG8gc2VuZCB0byB0aGUgYXBwcm92ZWQgY29udHJhY3QKICAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlQW5kQ2FsbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2V4dHJhRGF0YSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHRva2VuUmVjaXBpZW50IHNwZW5kZXIgPSB0b2tlblJlY2lwaWVudChfc3BlbmRlcik7CiAgICAgICAgaWYgKGFwcHJvdmUoX3NwZW5kZXIsIF92YWx1ZSkpIHsKICAgICAgICAgICAgc3BlbmRlci5yZWNlaXZlQXBwcm92YWwobXNnLnNlbmRlciwgX3ZhbHVlLCB0aGlzLCBfZXh0cmFEYXRhKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQkKICAgIH0KCiAgICAvKioKICAgICAqIERlc3Ryb3kgdG9rZW5zCiAgICAgKgogICAgICogUmVtb3ZlIGBfdmFsdWVgIHRva2VucyBmcm9tIHRoZSBzeXN0ZW0gaXJyZXZlcnNpYmx5CiAgICAgKgogICAgICogQHBhcmFtIF92YWx1ZSB0aGUgYW1vdW50IG9mIG1vbmV5IHRvIGJ1cm4KICAgICAqLwogICAgZnVuY3Rpb24gYnVybih1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoYmFsYW5jZU9mW21zZy5zZW5kZXJdID49IF92YWx1ZSk7ICAgLy8gQ2hlY2sgaWYgdGhlIHNlbmRlciBoYXMgZW5vdWdoCiAgICAgICAgYmFsYW5jZU9mW21zZy5zZW5kZXJdIC09IF92YWx1ZTsgICAgICAgICAgICAvLyBTdWJ0cmFjdCBmcm9tIHRoZSBzZW5kZXIKICAgICAgICB0b3RhbFN1cHBseSAtPSBfdmFsdWU7ICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZXMgdG90YWxTdXBwbHkKICAgICAgICBlbWl0IEJ1cm4obXNnLnNlbmRlciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIERlc3Ryb3kgdG9rZW5zIGZyb20gb3RoZXIgYWNjb3VudAogICAgICoKICAgICAqIFJlbW92ZSBgX3ZhbHVlYCB0b2tlbnMgZnJvbSB0aGUgc3lzdGVtIGlycmV2ZXJzaWJseSBvbiBiZWhhbGYgb2YgYF9mcm9tYC4KICAgICAqCiAgICAgKiBAcGFyYW0gX2Zyb20gdGhlIGFkZHJlc3Mgb2YgdGhlIHNlbmRlcgogICAgICogQHBhcmFtIF92YWx1ZSB0aGUgYW1vdW50IG9mIG1vbmV5IHRvIGJ1cm4KICAgICAqLwogICAgZnVuY3Rpb24gYnVybkZyb20oYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXF1aXJlKGJhbGFuY2VPZltfZnJvbV0gPj0gX3ZhbHVlKTsgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHRhcmdldGVkIGJhbGFuY2UgaXMgZW5vdWdoCiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYWxsb3dhbmNlW19mcm9tXVttc2cuc2VuZGVyXSk7ICAgIC8vIENoZWNrIGFsbG93YW5jZQogICAgICAgIGJhbGFuY2VPZltfZnJvbV0gLT0gX3ZhbHVlOyAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTdWJ0cmFjdCBmcm9tIHRoZSB0YXJnZXRlZCBiYWxhbmNlCiAgICAgICAgYWxsb3dhbmNlW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7ICAgICAgICAgICAgIC8vIFN1YnRyYWN0IGZyb20gdGhlIHNlbmRlcidzIGFsbG93YW5jZQogICAgICAgIHRvdGFsU3VwcGx5IC09IF92YWx1ZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdG90YWxTdXBwbHkKICAgICAgICBlbWl0IEJ1cm4oX2Zyb20sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0KCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qICAgICAgIEFEVkFOQ0VEIFRPS0VOIFNUQVJUUyBIRVJFICAgICAgICovCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCmNvbnRyYWN0IElDT05JQ19OSUMgaXMgT3duYWJsZSwgVG9rZW5FUkMyMCB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpICAgIHB1YmxpYyAgZnJvemVuQWNjb3VudDsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGZyZWV6aW5nUGVyaW9kOyAvLyBob3cgbWFueSBkYXlzIHRoZSBhY2NvdW50IG11c3QgcmVtYWluIGZyb3plbj8KCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBleGNoYW5nZXNBY2NvdW50czsKCiAgICBhZGRyZXNzIHB1YmxpYyBib3VudHlNYW5hZ2VyQWRkcmVzczsgLy9ib3VudHkgbWFuYWdlciBhZGRyZXNzCiAgICBhZGRyZXNzIHB1YmxpYyBib3VudHlNYW5hZ2VyRGlzdHJpYnV0aW9uQ29udHJhY3QgPSAweDA7IC8vIGJvdW50eSBkaXN0cmlidXRvciBzbWFydCBjb250cmFjdCBhZGRyZXNzCgogICAgYWRkcmVzcyBwdWJsaWMgZnVuZEFjY291bnQ7IAkvLyBiYWxsYXN0IGZ1bmQgYWRkcmVzcwogICAgYm9vbCBwdWJsaWMgaXNTZXRGdW5kID0gZmFsc2U7CS8vIGlmIGJhbGxhc3QgZnVuZCBpcyBzZXQKCiAgICB1aW50MjU2IHB1YmxpYyBjcmVhdGlvbkRhdGU7CgogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgZnJvemVuRGF5c0ZvckFkdmlzb3IgICAgICAgPSAxODY7ICAKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IGZyb3plbkRheXNGb3JCb3VudHkgICAgICAgID0gMTg2OwogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgZnJvemVuRGF5c0ZvckVhcmx5SW52ZXN0b3IgPSA1MTsKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IGZyb3plbkRheXNGb3JJQ08gICAgICAgICAgID0gNjU7ICAgCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBmcm96ZW5EYXlzRm9yUGFydG5lciAgICAgICA9IDM2OTsKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IGZyb3plbkRheXNGb3JQcmVJQ08gICAgICAgID0gNTE7CgogICAgLyoqCiAgICAqIGFsbG93ZWQgZm9yIGEgYm91bnR5IG1hbmFnZXIgYWNjb3VudCBvbmx5CiAgICAqLwogICAgbW9kaWZpZXIgb25seUJvdW50eU1hbmFnZXIoKXsKICAgICAgICByZXF1aXJlKChtc2cuc2VuZGVyID09IGJvdW50eU1hbmFnZXJEaXN0cmlidXRpb25Db250cmFjdCkgfHwgKG1zZy5zZW5kZXIgPT0gYm91bnR5TWFuYWdlckFkZHJlc3MpKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgKiBhbGxvd2VkIGZvciBhIGZ1bmQgYWNjb3VudCBvbmx5CiAgICAqLwogICAgbW9kaWZpZXIgb25seUZ1bmQoKXsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gZnVuZEFjY291bnQpOwogICAgICAgIF87CiAgICB9CgogICAgLyogVGhpcyBnZW5lcmF0ZXMgYSBwdWJsaWMgZXZlbnQgb24gdGhlIGJsb2NrY2hhaW4gdGhhdCB3aWxsIG5vdGlmeSBjbGllbnRzICovCiAgICBldmVudCBGcm96ZW5GdW5kcyhhZGRyZXNzIHRhcmdldCwgYm9vbCBmcm96ZW4pOwoKICAgIC8qKgogICAgKiBJbml0aWFsaXplcyBjb250cmFjdCB3aXRoIGluaXRpYWwgc3VwcGx5IHRva2VucyB0byB0aGUgY3JlYXRvciBvZiB0aGUgY29udHJhY3QKICAgICovCiAgICBmdW5jdGlvbiBJQ09OSUNfTklDKAogICAgICAgIHVpbnQyNTYgaW5pdGlhbFN1cHBseSwKICAgICAgICBzdHJpbmcgdG9rZW5OYW1lLAogICAgICAgIHN0cmluZyB0b2tlblN5bWJvbAogICAgKSBUb2tlbkVSQzIwKGluaXRpYWxTdXBwbHksIHRva2VuTmFtZSwgdG9rZW5TeW1ib2wpIHB1YmxpYyAKICAgIHsKICAgICAgICAvKiBzb2xpdW0tZGlzYWJsZS1uZXh0LWxpbmUgKi8KICAgICAgICBjcmVhdGlvbkRhdGUgPSBub3c7CgogICAgICAgIC8vIFBBUlRORVJTIERJU1RSSUJVVElPTgogICAgICAgIF9pbml0aWFsaXplQWNjb3VudCgweDg1YWJlRDkyNDIwNWJiRTREMzIwNzdFNTk2ZTQ1QjlGNDBBQUY4ZDksIGZyb3plbkRheXNGb3JQYXJ0bmVyLCAyMTE1MDA3KTsKICAgICAgICBfaW5pdGlhbGl6ZUFjY291bnQoMHhmNzgxN0YwOEMyNjYwOTcwMDE0YTA4NmE0QmE2Nzk2MzZlNzNFOGVmLCBmcm96ZW5EYXlzRm9yUGFydG5lciwgODc0NTQ3Myk7CiAgICAgICAgX2luaXRpYWxpemVBY2NvdW50KDB4MmMyMDg2NzdmOEJBQjljNkE0NGJCZTM1NTRmMzZkMjQ0MEM5YjZDMiwgZnJvemVuRGF5c0ZvclBhcnRuZXIsIDM0OTgxODkpOwogICAgICAgIF9pbml0aWFsaXplQWNjb3VudCgweDM2ODlCOWE0M2FiOTA0RDcwZjM5NkIyQTI3RERhYzBFNTg4NUNGNjgsIGZyb3plbkRheXNGb3JQYXJ0bmVyLCAyNjIzNjQxOSk7CiAgICAgICAgX2luaXRpYWxpemVBY2NvdW50KDB4MjQ1QjA1OEM4YzI1NkQwMTE3NDJhRjVGYWEyOTYxOTg3MzVlRTBFZSwgZnJvemVuRGF5c0ZvclBhcnRuZXIsIDIxMTUwMSk7CiAgICAgICAgX2luaXRpYWxpemVBY2NvdW50KDB4ZUVGQTlmOGYzOWFhRjFkMUVkMTYwQWMyNDY1ZTkzN0E4RjE1NDE4MiwgZnJvemVuRGF5c0ZvclBhcnRuZXIsIDE3NDkwOTUpOwoKICAgICAgICAvLyBFQVJMWSBJTlZFU1RPUiBESVNUUklCVVRJT04KICAgICAgICBfaW5pdGlhbGl6ZUFjY291bnQoMHg0NzE4YkIyNmJDRTgyNDU5OTEzYWFDQTA5YTAwNkRhYTUxN0YxYzBFLCBmcm96ZW5EYXlzRm9yRWFybHlJbnZlc3RvciwgMjI1MDAwKTsKICAgICAgICBfaW5pdGlhbGl6ZUFjY291bnQoMHg4Y0MxZDkzMGU2ODVjOTc3RUZjRWY5ZGM0MTJEM0FEYkUxMUI4NGMxLCBmcm96ZW5EYXlzRm9yRWFybHlJbnZlc3RvciwgMjY3ODEwMCk7CgogICAgICAgIC8vIEFEVklTT1IgRElTVFJJQlVUSU9OCiAgICAgICAgX2luaXRpYWxpemVBY2NvdW50KDB4MjcyYzQxYjc2QmFkOTQ5NzM5ODM5RTZCQjVFYjlmMkIwQ0RGRDk1RCwgZnJvemVuRGF5c0ZvckFkdmlzb3IsIDEwNTc1MDMpOwogICAgICAgIF9pbml0aWFsaXplQWNjb3VudCgweDNhNWNkOUU3Y2NGRTRERDU0ODQzMzVGM0FGMzBDQ0FiYTk1RDA3QzMsIGZyb3plbkRheXNGb3JBZHZpc29yLCA1Mjg3NTIpOwogICAgICAgIF9pbml0aWFsaXplQWNjb3VudCgweEExMENDNTMyMUU4MzRjNDExMzdmMjE1MEE5YjBmMkFhMWM1MDE2LCBmcm96ZW5EYXlzRm9yQWR2aXNvciwgMTA1NzUwMyk7CiAgICAgICAgX2luaXRpYWxpemVBY2NvdW50KDB4NTlCNjQwYzU2NjNFNWU3OUNlOUY2OEVCYkMyODQ1NDQ5MERiQTdCOCwgZnJvemVuRGF5c0ZvckFkdmlzb3IsIDEwNTc1MDMpOwogICAgICAgIF9pbml0aWFsaXplQWNjb3VudCgweGRDQTY5RmJmRUZmNDg4NTFjZUM5MUI1NzYxMEZBNjBBQmMyN0FmM0IsIGZyb3plbkRheXNGb3JBZHZpc29yLCAzMTcyNTEwKTsKICAgICAgICBfaW5pdGlhbGl6ZUFjY291bnQoMHgzMzI1MjZGMDA4MmQ0ZDM4NUY5RWYzOTM4NDFmNDRjMWJmODEzRDhjLCBmcm96ZW5EYXlzRm9yQWR2aXNvciwgMzE3MjUxMCk7CiAgICAgICAgX2luaXRpYWxpemVBY2NvdW50KDB4ZjZCNDM2Y0JCMTc3Nzc3QTE3MDgxOTEyOEViQmVGMDcxNTEwMWVBMiwgZnJvemVuRGF5c0ZvckFkdmlzb3IsIDEyNzUwMDApOwogICAgICAgIF9pbml0aWFsaXplQWNjb3VudCgweEI3NmE2M0ZhNzY1OGFEMDQ4MDk4NmU2MDliOWQ1YjFmMWI2QjUzYjksIGZyb3plbkRheXNGb3JBZHZpc29yLCAxNDg3NTAwKTsKICAgICAgICBfaW5pdGlhbGl6ZUFjY291bnQoMHgyYkMyNDBiYzBEMjg3MjVkRjc5MDcwNmRhNzY2MzQxM2FjOEZhNWVlLCBmcm96ZW5EYXlzRm9yQWR2aXNvciwgMjEyNTAwMCk7CiAgICAgICAgX2luaXRpYWxpemVBY2NvdW50KDB4MzJBYTAyOTYxZmExNWU3NEQ4OTZDNDVBNDI4RTVkMTg4NGFmMjIxNywgZnJvemVuRGF5c0ZvckFkdmlzb3IsIDEwNTc1MDMpOwogICAgICAgIF9pbml0aWFsaXplQWNjb3VudCgweDUzNDBFQzcxNmEwMERiMTZhOUMyODkzNjllNGIzMGFlODk3QzI1ZDMsIGZyb3plbkRheXNGb3JBZHZpc29yLCAxNTg2MjU1KTsKICAgICAgICBfaW5pdGlhbGl6ZUFjY291bnQoMHgzOWQ2RkRCNEIwZjhkZkUzOUVDMGI0ZkU1RGQ5QjJmNjZlMzBmOEQxLCBmcm96ZW5EYXlzRm9yQWR2aXNvciwgODQ2MDAzKTsKICAgICAgICBfaW5pdGlhbGl6ZUFjY291bnQoMHhDZTQzOEM1MkQ5NWVlNDc2MzRmOUFlRTM2ZGU1NDg4RDBkNUQwRkJkLCBmcm96ZW5EYXlzRm9yQWR2aXNvciwgMjUwMDAwKTsKCiAgICAgICAgLy8gQk9VTlRZIERJU1RSSUJVVElPTgogICAgICAgIGJvdW50eU1hbmFnZXJBZGRyZXNzID0gMHhBOTkzOTkzOGU2QkFjQzBiNzQ4MDQ1YmU4MEZEOUU5NTg4OThlQjc5OwogICAgICAgIF9pbml0aWFsaXplQWNjb3VudChib3VudHlNYW5hZ2VyQWRkcmVzcywgZnJvemVuRGF5c0ZvckJvdW50eSwgMTUwMDAwMDApOwogICAgfQoKICAgIC8qKgogICAgKiBPbmx5IG93bmVyIGZ1bmN0aW9uIHRvIHNldCBiYWxsYXN0IGZ1bmQgYWNjb3VudCBhZGRyZXNzCiAgICAqIAogICAgKiBAZGV2IGl0IGNhbiBiZSBzZXQgb25seSBvbmNlCiAgICAqIEBwYXJhbSBfYWRkcmVzcyBzbWFydCBjb250cmFjdCBhZGRyZXNzIG9mIGJhbGxhc3QgZnVuZAogICAgKi8KICAgIGZ1bmN0aW9uIHNldEZ1bmRBY2NvdW50KGFkZHJlc3MgX2FkZHJlc3MpIG9ubHlPd25lciBwdWJsaWN7CiAgICAgICAgcmVxdWlyZSAoX2FkZHJlc3MgIT0gMHgwKTsKICAgICAgICByZXF1aXJlICghaXNTZXRGdW5kKTsKICAgICAgICBmdW5kQWNjb3VudCA9IF9hZGRyZXNzOwogICAgICAgIGlzU2V0RnVuZCA9IHRydWU7ICAgIAogICAgfQoKICAgIC8qKgogICAgKiBPbmx5IG93bmVyIGZ1bmN0aW9uIHRvIGFkZCBFeGNoYW5nZSBBY2NvdW50cwogICAgKgogICAgKiBAcGFyYW0gX2FkZHJlc3MgRXhjaGFuZ2UgYWRkcmVzcwogICAgKi8KICAgIGZ1bmN0aW9uIGFkZEV4Y2hhbmdlVGVzdEFjY291bnRzKGFkZHJlc3MgX2FkZHJlc3MpIG9ubHlPd25lciBwdWJsaWN7CiAgICAgICAgcmVxdWlyZShfYWRkcmVzcyAhPSAweDApOwogICAgICAgIGV4Y2hhbmdlc0FjY291bnRzW19hZGRyZXNzXSA9IHRydWU7CiAgICB9CgogICAgLyoqCiAgICAqIE9ubHkgb3duZXIgZnVuY3Rpb24gdG8gcmVtb3ZlIEV4Y2hhbmdlIEFjY291bnRzCiAgICAqCiAgICAqIEBwYXJhbSBfYWRkcmVzcyBFeGNoYW5nZSBhZGRyZXNzCiAgICAqLwogICAgZnVuY3Rpb24gcmVtb3ZlRXhjaGFuZ2VUZXN0QWNjb3VudHMoYWRkcmVzcyBfYWRkcmVzcykgb25seU93bmVyIHB1YmxpY3sKICAgICAgICBkZWxldGUgZXhjaGFuZ2VzQWNjb3VudHNbX2FkZHJlc3NdOwogICAgfQoKICAgIC8qKgogICAgKiBJbml0aWFsaXplIGFjY291bnRzIHdoZW4gdG9rZW4gZGVwbG95IG9jY3VycwogICAgKgogICAgKiBpbml0aWFsaXplIGBfYWRkcmVzc2AgYWNjb3VudCwgd2l0aCBiYWxhbmNlIGVxdWFsIGBfdmFsdWVgIGFuZCBmcm96ZW4gZm9yIGBfZnJvemVuRGF5c2AKICAgICoKICAgICogQHBhcmFtIF9hZGRyZXNzIHdhbGxldCBhZGRyZXNzIHRvIGluaXRpYWxpemUKICAgICogQHBhcmFtIF9mcm96ZW5EYXlzIHF1YW50aXR5IG9mIGRheXMgdG8gZnJlZXplIGFjY291bnQKICAgICogQHBhcmFtIF92YWx1ZSBxdWFudGl0eSBvZiB0b2tlbnMgdG8gc2VuZCB0byBhY2NvdW50CiAgICAqLwogICAgZnVuY3Rpb24gX2luaXRpYWxpemVBY2NvdW50KGFkZHJlc3MgX2FkZHJlc3MsIHVpbnQgX2Zyb3plbkRheXMsIHVpbnQgX3ZhbHVlKSBpbnRlcm5hbHsKICAgICAgICBfdHJhbnNmZXIobXNnLnNlbmRlciwgX2FkZHJlc3MsIF92YWx1ZSAqIDEwICoqIHVpbnQyNTYoZGVjaW1hbHMpKTsKICAgICAgICBmcmVlemluZ1BlcmlvZFtfYWRkcmVzc10gPSBfZnJvemVuRGF5czsKICAgICAgICBfZnJlZXplQWNjb3VudChfYWRkcmVzcywgdHJ1ZSk7CiAgICB9CgogICAgLyoqCiAgICAqIENoZWNrIGlmIGFjY291bnQgZnJlZXppbmcgcGVyaW9kIGV4cGlyZWQKICAgICoKICAgICogYG5vd2AgaGFzIHRvIGJlIGdyZWF0ZXIgb3IgZXF1YWwgdGhhbiBgY3JlYXRpb25EYXRlYCArIGBmcmVlemluZ1BlcmlvZFtfYWRkcmVzc11gICogYDEgZGF5YAogICAgKgogICAgKiBAcGFyYW0gX2FkZHJlc3MgYWNjb3VudCBhZGRyZXNzIHRvIGNoZWNrIGlmIGFsbG93ZWQgdG8gdHJhbnNmZXIgdG9rZW5zCiAgICAqIEByZXR1cm4gYm9vbCB0cnVlIGlmIGlzIGFsbG93ZWQgdG8gdHJhbnNmZXIgYW5kIGZhbHNlIGlmIG5vdAogICAgKi8KICAgIGZ1bmN0aW9uIF9pc1RyYW5zZmVyQWxsb3dlZCggYWRkcmVzcyBfYWRkcmVzcyApIHZpZXcgcHVibGljIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgLyogc29saXVtLWRpc2FibGUtbmV4dC1saW5lICovCiAgICAgICAgaWYoIG5vdyA+PSBjcmVhdGlvbkRhdGUgKyBmcmVlemluZ1BlcmlvZFtfYWRkcmVzc10gKiAxIGRheXMgKXsKICAgICAgICAgICAgcmV0dXJuICggdHJ1ZSApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiAoIGZhbHNlICk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgKiBJbnRlcm5hbCBmdW5jdGlvbiB0byB0cmFuc2ZlciB0b2tlbnMKICAgICoKICAgICogQHBhcmFtIF9mcm9tIGFjY291bnQgdG8gd2l0aGRyYXcgdG9rZW5zCiAgICAqIEBwYXJhbSBfdG8gYWNjb3VudCB0byByZWNlaXZlIHRva2VucwogICAgKiBAcGFyYW0gX3ZhbHVlIHF1YW50aXR5IG9mIHRva2VucyB0byB0cmFuc2ZlcgogICAgKi8KICAgIGZ1bmN0aW9uIF90cmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIGludGVybmFsIHsKICAgICAgICByZXF1aXJlIChfdG8gIT0gMHgwKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUHJldmVudCB0cmFuc2ZlciB0byAweDAgYWRkcmVzcy4gVXNlIGJ1cm4oKSBpbnN0ZWFkCiAgICAgICAgcmVxdWlyZSAoYmFsYW5jZU9mW19mcm9tXSA+PSBfdmFsdWUpOyAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBzZW5kZXIgaGFzIGVub3VnaAogICAgICAgIHJlcXVpcmUgKGJhbGFuY2VPZltfdG9dLmFkZChfdmFsdWUpID4gYmFsYW5jZU9mW190b10pOyAvLyBDaGVjayBmb3Igb3ZlcmZsb3dzCgogICAgICAgIC8vIGNoZWNrIGlmIHRoZSBzZW5kZXIgaXMgdW5kZXIgYSBmcmVlemluZyBwZXJpb2QKICAgICAgICBpZihfaXNUcmFuc2ZlckFsbG93ZWQoX2Zyb20pKXsgCiAgICAgICAgICAgIF9zZXRGcmVlemluZ1BlcmlvZChfZnJvbSwgZmFsc2UsIDApOwogICAgICAgIH0KCiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHJlY2lwaWVudCBpcyB1bmRlciBhIGZyZWV6aW5nIHBlcmlvZAogICAgICAgIGlmKF9pc1RyYW5zZmVyQWxsb3dlZChfdG8pKXsKICAgICAgICAgICAgX3NldEZyZWV6aW5nUGVyaW9kKF90bywgZmFsc2UsIDApOwogICAgICAgIH0KCiAgICAgICAgcmVxdWlyZSghZnJvemVuQWNjb3VudFtfZnJvbV0pOyAgICAgLy8gQ2hlY2sgaWYgc2VuZGVyIGlzIGZyb3plbgogICAgICAgIHJlcXVpcmUoIWZyb3plbkFjY291bnRbX3RvXSk7ICAgICAgIC8vIENoZWNrIGlmIHJlY2lwaWVudCBpcyBmcm96ZW4gICAgICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgYmFsYW5jZU9mW19mcm9tXSA9IGJhbGFuY2VPZltfZnJvbV0uc3ViKF92YWx1ZSk7ICAgIC8vIFN1YnRyYWN0IGZyb20gdGhlIHNlbmRlcgogICAgICAgIGJhbGFuY2VPZltfdG9dID0gYmFsYW5jZU9mW190b10uYWRkKF92YWx1ZSk7ICAgICAgICAvLyBBZGQgdGhlIHNhbWUgdG8gdGhlIHJlY2lwaWVudAoKICAgICAgICBlbWl0IFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICB9CiAgICAKICAgIC8qKgogICAgKiBJbnRlcm5hbCBmdW5jdGlvbiB0byBkZWxpdmVyIHRva2VucyBmb3IgYm91bnR5LCBwcmUtSUNPIG9yIElDTyB3aXRoIGRldGVybWluZWQgZnJlZXppbmcgcGVyaW9kcwogICAgKgogICAgKiBAcGFyYW0gX2Zyb20gYWNjb3VudCBhZGRyZXNzIHRvIHdpdGhkcmF3IHRva2VucwogICAgKiBAcGFyYW0gX3RvIGFjY291bnQgYWRkcmVzcyB0byBzZW5kIHRva2VucwogICAgKiBAcGFyYW0gX3ZhbHVlIHF1YW50aXR5IG9mIHRva2VzIHRvIHNlbmQKICAgICogQHBhcmFtIF9mcm96ZW5EYXlzIHF1YW50aXR5IG9mIGRheXMgdG8gZnJlZXplIGFjY291bnQKICAgICovCiAgICBmdW5jdGlvbiBfdG9rZW5EZWxpdmVyeShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUsIHVpbnQgX2Zyb3plbkRheXMpIGludGVybmFsIHsKICAgICAgICBmcmVlemluZ1BlcmlvZFtfdG9dID0gMDsKICAgICAgICBfZnJlZXplQWNjb3VudChfdG8sIGZhbHNlKTsKICAgICAgICBfdHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICBmcmVlemluZ1BlcmlvZFtfdG9dID0gX2Zyb3plbkRheXM7CiAgICAgICAgX2ZyZWV6ZUFjY291bnQoX3RvLCB0cnVlKTsgCiAgICB9CiAgICAKICAgIC8qKgogICAgKiBPbmx5IG93bmVyIGZ1bmN0aW9uIHRvIGRlbGl2ZXIgdG9rZW5zIGZvciBwcmUtSUNPIGludmVzdG9ycwogICAgKgogICAgKiBAcGFyYW0gX3RvIGFjY291bnQgYWRkcmVzcyB3aG8gd2lsbCByZWNlaXZlIHRoZSB0b2tlbnMKICAgICogQHBhcmFtIF92YWx1ZSBxdWFudGl0eSBvZiB0b2tlbnMgdG8gZGVsaXZlcgogICAgKi8KICAgIGZ1bmN0aW9uIHByZUlDT1Rva2VuRGVsaXZlcnkoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICBfdG9rZW5EZWxpdmVyeShtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSwgZnJvemVuRGF5c0ZvclByZUlDTyk7CiAgICB9CiAgICAKICAgIC8qKgogICAgKiBPbmx5IG93bmVyIGZ1bmN0aW9uIHRvIGRlbGl2ZXIgdG9rZW5zIGZvciBJQ08gaW52ZXN0b3JzCiAgICAqCiAgICAqIEBwYXJhbSBfdG8gYWNjb3VudCBhZGRyZXNzIHdobyB3aWxsIHJlY2VpdmUgdG9rZW5zCiAgICAqIEBwYXJhbSBfdmFsdWUgcXVhbnRpdHkgb2YgdG9rZW5zIHRvIGRlbGl2ZXIKICAgICovCiAgICBmdW5jdGlvbiBJQ09Ub2tlbkRlbGl2ZXJ5KGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgX3Rva2VuRGVsaXZlcnkobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUsIGZyb3plbkRheXNGb3JJQ08pOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBzZXRCb3VudHlEaXN0cmlidXRpb25Db250cmFjdChhZGRyZXNzIF9jb250cmFjdEFkZHJlc3MpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGJvdW50eU1hbmFnZXJEaXN0cmlidXRpb25Db250cmFjdCA9IF9jb250cmFjdEFkZHJlc3M7CiAgICB9CgogICAgLyoqCiAgICAqIE9ubHkgYm91bnR5IG1hbmFnZXIgZGlzdHJpYnV0aW9uIGNvbnRyYWN0IGZ1bmN0aW9uIHRvIGRlbGl2ZXIgdG9rZW5zIGZvciBib3VudHkgY29tbXVuaXR5CiAgICAqCiAgICAqIEBwYXJhbSBfdG8gYWNjb3VudCBhZGRyZXMgd2hvIHdpbGwgcmVjZWl2ZSB0b2tlbnMKICAgICogQHBhcmFtIF92YWx1ZSBxdWFudGl0eSBvZiB0b2tlbnMgdG8gZGVsaXZlcgogICAgKi8KICAgIGZ1bmN0aW9uIGJvdW50eVRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seUJvdW50eU1hbmFnZXIgcHVibGljIHsKICAgICAgICBfZnJlZXplQWNjb3VudChib3VudHlNYW5hZ2VyQWRkcmVzcywgZmFsc2UpOwogICAgICAgIF90b2tlbkRlbGl2ZXJ5KGJvdW50eU1hbmFnZXJBZGRyZXNzLCBfdG8sIF92YWx1ZSwgZnJvemVuRGF5c0ZvckJvdW50eSk7CiAgICAgICAgX2ZyZWV6ZUFjY291bnQoYm91bnR5TWFuYWdlckFkZHJlc3MsIHRydWUpOwogICAgfQoKICAgIC8qKgogICAgKiBGdW5jdGlvbiB0byBnZXQgZGF5cyB0byB1bmZyZWV6ZSBzb21lIGFjY291bnQKICAgICoKICAgICogQHBhcmFtIF9hZGRyZXNzIGFjY291bnQgYWRkcmVzcyB0byBnZXQgZGF5cwogICAgKiBAcmV0dXJuIHJlc3VsdCBxdWFudGl0eSBvZiBkYXlzIHRvIHVuZnJlZXplIGBhZGRyZXNzYAogICAgKi8KICAgIGZ1bmN0aW9uIGRheXNUb1VuZnJlZXplKGFkZHJlc3MgX2FkZHJlc3MpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXF1aXJlKF9hZGRyZXNzICE9IDB4MCk7CgogICAgICAgIC8qIHNvbGl1bS1kaXNhYmxlLW5leHQtbGluZSAqLwogICAgICAgIHVpbnQyNTYgX25vdyA9IG5vdzsKICAgICAgICB1aW50MjU2IHJlc3VsdCA9IDA7CgogICAgICAgIGlmKCBfbm93IDw9IGNyZWF0aW9uRGF0ZSArIGZyZWV6aW5nUGVyaW9kW19hZGRyZXNzXSAqIDEgZGF5cyApIHsKICAgICAgICAgICAgLy8gc3RpbGwgdW5kZXIgdGhlIGZyZWV6aW5nIHBlcmlvZC4KICAgICAgICAgICAgdWludDI1NiBmaW5hbFBlcmlvZCA9IChjcmVhdGlvbkRhdGUgKyBmcmVlemluZ1BlcmlvZFtfYWRkcmVzc10gKiAxIGRheXMpIC8gMSBkYXlzOwogICAgICAgICAgICB1aW50MjU2IGN1cnJlUGVyaW9kID0gX25vdyAvIDEgZGF5czsKICAgICAgICAgICAgcmVzdWx0ID0gZmluYWxQZXJpb2QgLSBjdXJyZVBlcmlvZDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgICAvKioKICAgICogQG5vdGljZSBgZnJlZXplPyBQcmV2ZW50IHwgQWxsb3dgIGB0YXJnZXRgIGZyb20gc2VuZGluZyAmIHJlY2VpdmluZyB0b2tlbnMKICAgICogQHBhcmFtIHRhcmdldCBBZGRyZXNzIHRvIGJlIGZyb3plbgogICAgKiBAcGFyYW0gZnJlZXplIGVpdGhlciB0byBmcmVlemUgaXQgb3Igbm90CiAgICAqLwogICAgZnVuY3Rpb24gX2ZyZWV6ZUFjY291bnQoYWRkcmVzcyB0YXJnZXQsIGJvb2wgZnJlZXplKSBpbnRlcm5hbCB7CiAgICAgICAgZnJvemVuQWNjb3VudFt0YXJnZXRdID0gZnJlZXplOwogICAgICAgIGVtaXQgRnJvemVuRnVuZHModGFyZ2V0LCBmcmVlemUpOwogICAgfQoKICAgIC8qKgogICAgKiBPbmx5IG93bmVyIGZ1bmN0aW9uIHRvIGNhbGwgYF9mcmVlemVBY2NvdW50YCBkaXJlY3RseQogICAgKgogICAgKiBAcGFyYW0gdGFyZ2V0IGFjY291bnQgYWRkcmVzcyB0byBmcmVlemUKICAgICogQHBhcmFtIGZyZWV6ZSB0cnVlIHRvIGZyZWV6ZSBhY2NvdW50IGFuZCBmYWxzZSB0byB1bmZyZWV6ZQogICAgKi8KICAgIGZ1bmN0aW9uIGZyZWV6ZUFjY291bnQoYWRkcmVzcyB0YXJnZXQsIGJvb2wgZnJlZXplKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICBfZnJlZXplQWNjb3VudCh0YXJnZXQsIGZyZWV6ZSk7CiAgICB9CiAgICAKICAgIC8qKgogICAgKiBJbnRlcm5hbCBjYWxsIHRvIHNldCBmcmVlemluZyBwZXJpb2QgZm9yIHNvbWUgYWNjb3VudAogICAgKgogICAgKiBAcGFyYW0gX3RhcmdldCBhY2NvdW50IGFkZHJlc3MgdG8gZnJlZXplCiAgICAqIEBwYXJhbSBfZnJlZXplIHRydWUgdG8gZnJlZXplIGFjY291bnQgYW5kIGZhbHNlIHRvIHVuZnJlZXplCiAgICAqIEBwYXJhbSBfZGF5cyBwZXJpb2QgdG8ga2VlcCBhY2NvdW50IGZyb3plbgogICAgKi8KICAgIGZ1bmN0aW9uIF9zZXRGcmVlemluZ1BlcmlvZChhZGRyZXNzIF90YXJnZXQsIGJvb2wgX2ZyZWV6ZSwgdWludDI1NiBfZGF5cykgaW50ZXJuYWwgewogICAgICAgIF9mcmVlemVBY2NvdW50KF90YXJnZXQsIF9mcmVlemUpOwogICAgICAgIGZyZWV6aW5nUGVyaW9kW190YXJnZXRdID0gX2RheXM7CiAgICB9CiAgICAKICAgIC8qKgogICAgKiBPbmx5IG93bmVyIGZ1bmN0aW9uIHRvIGNhbGwgYF9zZXRGcmVlemluZ1BlcmlvZGAgZGlyZWN0bHkKICAgICoKICAgICogQHBhcmFtIF90YXJnZXQgYWNjb3VudCBhZGRyZXNzIHRvIGZyZWV6ZQogICAgKiBAcGFyYW0gX2ZyZWV6ZSB0cnVlIHRvIGZyZWV6ZSBhY2NvdW50IGFuZCBmYWxzZSB0byB1bmZyZWV6ZQogICAgKiBAcGFyYW0gX2RheXMgcGVyaW9kIHRvIGtlZXAgYWNjb3VudCBmcm96ZW4KICAgICovCiAgICBmdW5jdGlvbiBzZXRGcmVlemluZ1BlcmlvZChhZGRyZXNzIF90YXJnZXQsIGJvb2wgX2ZyZWV6ZSwgdWludDI1NiBfZGF5cykgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgX3NldEZyZWV6aW5nUGVyaW9kKF90YXJnZXQsIF9mcmVlemUsIF9kYXlzKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAqIFRyYW5zZmVyIHRva2VucyBmcm9tIG90aGVyIGFkZHJlc3MKICAgICoKICAgICogU2VuZCBgX3ZhbHVlYCB0b2tlbnMgdG8gYF90b2AgaW4gYmVoYWxmIG9mIGBfZnJvbWAKICAgICoKICAgICogQHBhcmFtIF9mcm9tIFRoZSBhZGRyZXNzIG9mIHRoZSBzZW5kZXIKICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIGFtb3VudCB0byBzZW5kCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0pOyAgICAgLy8gQ2hlY2sgYWxsb3dhbmNlCiAgICAgICAgLy9hbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdIC09IF92YWx1ZTsKICAgICAgICBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dhbmNlW19mcm9tXVttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICBfdHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICogU2V0IGFsbG93YW5jZSBmb3Igb3RoZXIgYWRkcmVzcwogICAgKgogICAgKiBBbGxvd3MgYF9zcGVuZGVyYCB0byBzcGVuZCBubyBtb3JlIHRoYW4gYF92YWx1ZWAgdG9rZW5zIGluIHlvdXIgYmVoYWxmCiAgICAqCiAgICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBhdXRob3JpemVkIHRvIHNwZW5kCiAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIG1heCBhbW91bnQgdGhleSBjYW4gc3BlbmQKICAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHNlbmRlciBpcyB1bmRlciBhIGZyZWV6aW5nIHBlcmlvZAogICAgICAgIGlmKCBfaXNUcmFuc2ZlckFsbG93ZWQobXNnLnNlbmRlcikgKSAgewogICAgICAgICAgICBfc2V0RnJlZXppbmdQZXJpb2QobXNnLnNlbmRlciwgZmFsc2UsIDApOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBhbGxvd2FuY2VbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgKiBTZXQgYWxsb3dhbmNlIGZvciBvdGhlciBhZGRyZXNzIGFuZCBub3RpZnkKICAgICoKICAgICogQWxsb3dzIGBfc3BlbmRlcmAgdG8gc3BlbmQgbm8gbW9yZSB0aGFuIGBfdmFsdWVgIHRva2VucyBpbiB5b3VyIGJlaGFsZiwgYW5kIHRoZW4gcGluZyB0aGUgY29udHJhY3QgYWJvdXQgaXQKICAgICoKICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIGF1dGhvcml6ZWQgdG8gc3BlbmQKICAgICogQHBhcmFtIF92YWx1ZSB0aGUgbWF4IGFtb3VudCB0aGV5IGNhbiBzcGVuZAogICAgKiBAcGFyYW0gX2V4dHJhRGF0YSBzb21lIGV4dHJhIGluZm9ybWF0aW9uIHRvIHNlbmQgdG8gdGhlIGFwcHJvdmVkIGNvbnRyYWN0CiAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZUFuZENhbGwoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9leHRyYURhdGEpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICAvLyBjaGVjayBpZiB0aGUgc2VuZGVyIGlzIHVuZGVyIGEgZnJlZXppbmcgcGVyaW9kCiAgICAgICAgaWYoIF9pc1RyYW5zZmVyQWxsb3dlZChtc2cuc2VuZGVyKSApIHsKICAgICAgICAgICAgX3NldEZyZWV6aW5nUGVyaW9kKG1zZy5zZW5kZXIsIGZhbHNlLCAwKTsKICAgICAgICB9CgogICAgICAgIHRva2VuUmVjaXBpZW50IHNwZW5kZXIgPSB0b2tlblJlY2lwaWVudChfc3BlbmRlcik7CgogICAgICAgIGlmIChhcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUpKSB7CiAgICAgICAgICAgIHNwZW5kZXIucmVjZWl2ZUFwcHJvdmFsKG1zZy5zZW5kZXIsIF92YWx1ZSwgdGhpcywgX2V4dHJhRGF0YSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICogRGVzdHJveSB0b2tlbnMKICAgICoKICAgICogUmVtb3ZlIGBfdmFsdWVgIHRva2VucyBmcm9tIHRoZSBzeXN0ZW0gaXJyZXZlcnNpYmx5CiAgICAqCiAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIGFtb3VudCBvZiBtb25leSB0byBidXJuCiAgICAqLwogICAgZnVuY3Rpb24gYnVybih1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoYmFsYW5jZU9mW21zZy5zZW5kZXJdID49IF92YWx1ZSk7ICAgLy8gQ2hlY2sgaWYgdGhlIHNlbmRlciBoYXMgZW5vdWdoCiAgICAgICAgcmV0dXJuIF9idXJuKG1zZy5zZW5kZXIsIF92YWx1ZSk7CiAgICB9CgogICAgLyoqCiAgICAqIEludGVybmFsIGNhbGwgdG8gYnVybiB0b2tlbnMKICAgICogCiAgICAqIEBwYXJhbSBfZnJvbSB0aGUgYWRkcmVzcyB0byBidXJuIHRva2VucwogICAgKiBAcGFyYW0gX3ZhbHVlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJ1cm4KICAgICovCiAgICBmdW5jdGlvbiBfYnVybihhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF92YWx1ZSkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgYmFsYW5jZU9mW19mcm9tXSA9IGJhbGFuY2VPZltfZnJvbV0uc3ViKF92YWx1ZSk7ICAgICAgICAgICAgLy8gU3VidHJhY3QgZnJvbSB0aGUgc2VuZGVyCiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5zdWIoX3ZhbHVlKTsgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlcyB0b3RhbFN1cHBseQogICAgICAgIGVtaXQgQnVybihfZnJvbSwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICogRGVzdHJveSB0b2tlbnMgZnJvbSBvdGhlciBhY2NvdW50CiAgICAqCiAgICAqIFJlbW92ZSBgX3ZhbHVlYCB0b2tlbnMgZnJvbSB0aGUgc3lzdGVtIGlycmV2ZXJzaWJseSBvbiBiZWhhbGYgb2YgYF9mcm9tYC4KICAgICoKICAgICogQHBhcmFtIF9mcm9tIHRoZSBhZGRyZXNzIG9mIHRvIHdpdGhkcmF3IHRva2VucwogICAgKiBAcGFyYW0gX3ZhbHVlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJ1cm4KICAgICovCiAgICBmdW5jdGlvbiBidXJuRnJvbShhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoYmFsYW5jZU9mW19mcm9tXSA+PSBfdmFsdWUpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgdGFyZ2V0ZWQgYmFsYW5jZSBpcyBlbm91Z2gKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdKTsgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgYWxsb3dhbmNlCiAgICAgICAgYWxsb3dhbmNlW19mcm9tXVttc2cuc2VuZGVyXSA9IGFsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7IC8vIFN1YnRyYWN0IGZyb20gdGhlIHNlbmRlcidzIGFsbG93YW5jZQogICAgICAgIHJldHVybiBfYnVybihfZnJvbSwgX3ZhbHVlKTsKICAgIH0KCiAgICAvKioKICAgICogT25seSBiYWxsYXN0IGZ1bmQgZnVuY3Rpb24gdG8gYnVybiB0b2tlbnMgZnJvbSBhY2NvdW50CiAgICAqCiAgICAqIEFsbG93cyBgZnVuZEFjY291bnRgIGJ1cm4gdG9rZW5zIHRvIHNlbmQgZXF1aXZhbGVudCBldGhlciBmb3IgYWNjb3VudCB0aGF0IGNsYWltZWQgaXQKICAgICogQHBhcmFtIF9mcm9tIGFjY291bnQgYWRkcmVzcyB0byBidXJuIHRva2VucwogICAgKiBAcGFyYW0gX3ZhbHVlIHF1YW50aXR5IG9mIHRva2VucyB0byBidXJuCiAgICAqLwogICAgZnVuY3Rpb24gcmVkZW1wdGlvbkJ1cm4oYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdmFsdWUpIG9ubHlGdW5kIHB1YmxpY3sKICAgICAgICBfYnVybihfZnJvbSwgX3ZhbHVlKTsKICAgIH0gICAKfQ=='.
	

]
