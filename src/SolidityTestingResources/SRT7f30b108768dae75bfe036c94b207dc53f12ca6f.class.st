Class {
	#name : #SRT7f30b108768dae75bfe036c94b207dc53f12ca6f,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT7f30b108768dae75bfe036c94b207dc53f12ca6f >> base64 [
	^ 'Ly8vIEltcGxlbWVudHMgRVJDIDIwIFRva2VuIHN0YW5kYXJkOiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgoKLy8vIEB0aXRsZSBBYnN0cmFjdCB0b2tlbiBjb250cmFjdCAtIEZ1bmN0aW9ucyB0byBiZSBpbXBsZW1lbnRlZCBieSB0b2tlbiBjb250cmFjdHMuCmNvbnRyYWN0IFRva2VuIHsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8gVGhpcyBpcyBub3QgYW4gYWJzdHJhY3QgZnVuY3Rpb24sIGJlY2F1c2Ugc29sYyB3b24ndCByZWNvZ25pemUgZ2VuZXJhdGVkIGdldHRlciBmdW5jdGlvbnMgZm9yIHB1YmxpYyB2YXJpYWJsZXMgYXMgZnVuY3Rpb25zLgogICAgLy9mdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgc3VwcGx5KSB7fTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIG93bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOwoKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCmNvbnRyYWN0IER1dGNoQXVjdGlvbiB7CgogICAgLyoKICAgICAqICBFdmVudHMKICAgICAqLwogICAgZXZlbnQgQmlkU3VibWlzc2lvbihhZGRyZXNzIGluZGV4ZWQgc2VuZGVyLCB1aW50MjU2IGFtb3VudCk7CgogICAgLyoKICAgICAqICBDb25zdGFudHMKICAgICAqLwogICAgdWludCBjb25zdGFudCBwdWJsaWMgTUFYX1RPS0VOU19TT0xEID0gNTAwMDAwMCAqIDEwKioxODsgLy8gNU0KICAgIHVpbnQgY29uc3RhbnQgcHVibGljIFdBSVRJTkdfUEVSSU9EID0gNyBkYXlzOwoKICAgIC8qCiAgICAgKiAgU3RvcmFnZQogICAgICovCiAgICBUb2tlbiBwdWJsaWMgdmlydHVlUGxheWVyUG9pbnRzOwogICAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0OwogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICB1aW50IHB1YmxpYyBjZWlsaW5nOwogICAgdWludCBwdWJsaWMgcHJpY2VGYWN0b3I7CiAgICB1aW50IHB1YmxpYyBzdGFydEJsb2NrOwogICAgdWludCBwdWJsaWMgZW5kVGltZTsKICAgIHVpbnQgcHVibGljIHRvdGFsUmVjZWl2ZWQ7CiAgICB1aW50IHB1YmxpYyBmaW5hbFByaWNlOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgYmlkczsKICAgIFN0YWdlcyBwdWJsaWMgc3RhZ2U7CiAgICAKICAgIC8vIEJpZGRlciB3aGl0ZWxpc3QuIEVudHJpZXMgaW4gdGhlIGFycmF5IGFyZSB3aGl0ZWxpc3RlZCBhZGRyZXNzZXMKICAgIC8vIEVudHJpZXMgaW4gdGhlIGFkZHJlc3Mta2V5ZWQgbWFwIHJlcHJlc2VudCB0aGUgKGFycmF5X2luZGV4KzEpIG9mCiAgICAvLyB0aGUga2V5LiAKICAgIAogICAgYWRkcmVzc1tdIHB1YmxpYyBiaWRkZXJXaGl0ZWxpc3Q7IC8vIGFsbG93cyBpdGVyYXRpb24gb3ZlciB3aGl0ZWxpc3RlZCBhZGRyZXNzZXMKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCApIHB1YmxpYyB3aGl0ZWxpc3RJbmRleE1hcDsgIC8vIGFsbG93cyBmYXN0IGFkZHJlc3MgbG9va3VwCgogICAgLyoKICAgICAqICBFbnVtcwogICAgICovCiAgICBlbnVtIFN0YWdlcyB7CiAgICAgICAgQXVjdGlvbkRlcGxveWVkLAogICAgICAgIEF1Y3Rpb25TZXRVcCwKICAgICAgICBBdWN0aW9uU3RhcnRlZCwKICAgICAgICBBdWN0aW9uRW5kZWQsCiAgICAgICAgVHJhZGluZ1N0YXJ0ZWQKICAgIH0KCiAgICAvKgogICAgICogIE1vZGlmaWVycwogICAgICovCiAgICBtb2RpZmllciBhdFN0YWdlKFN0YWdlcyBfc3RhZ2UpIHsKICAgICAgICByZXF1aXJlIChzdGFnZSA9PSBfc3RhZ2UpOwogICAgICAgICAgICAvLyBDb250cmFjdCBtdXN0IGJlIGluIGV4cGVjdGVkIHN0YXRlCiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBpc093bmVyKCkgewogICAgICAgIHJlcXVpcmUgKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgICAgICAvLyBPbmx5IG93bmVyIGlzIGFsbG93ZWQgdG8gcHJvY2VlZAogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgaXNXYWxsZXQoKSB7CiAgICAgICAgcmVxdWlyZSAobXNnLnNlbmRlciA9PSB3YWxsZXQpOwogICAgICAgICAgICAvLyBPbmx5IHdhbGxldCBpcyBhbGxvd2VkIHRvIHByb2NlZWQKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIGlzVmFsaWRQYXlsb2FkKCkgewogICAgICAgIHJlcXVpcmUgKG1zZy5kYXRhLmxlbmd0aCA9PSA0IHx8IG1zZy5kYXRhLmxlbmd0aCA9PSAzNik7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciB0aW1lZFRyYW5zaXRpb25zKCkgewogICAgICAgIGlmIChzdGFnZSA9PSBTdGFnZXMuQXVjdGlvblN0YXJ0ZWQgJiYgY2FsY1Rva2VuUHJpY2UoKSA8PSBjYWxjU3RvcFByaWNlKCkpCiAgICAgICAgICAgIGZpbmFsaXplQXVjdGlvbigpOwogICAgICAgIGlmIChzdGFnZSA9PSBTdGFnZXMuQXVjdGlvbkVuZGVkICYmIG5vdyA+IGVuZFRpbWUgKyBXQUlUSU5HX1BFUklPRCkKICAgICAgICAgICAgc3RhZ2UgPSBTdGFnZXMuVHJhZGluZ1N0YXJ0ZWQ7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKgogICAgICogIFB1YmxpYyBmdW5jdGlvbnMKICAgICAqLwogICAgLy8vIEBkZXYgQ29udHJhY3QgY29uc3RydWN0b3IgZnVuY3Rpb24gc2V0cyBvd25lci4KICAgIC8vLyBAcGFyYW0gX3dhbGxldCBNdWx0aXNpZyB3YWxsZXQgZm9yIGF1Y3Rpb24gcHJvY2VlZHMuCiAgICAvLy8gQHBhcmFtIF9jZWlsaW5nIEF1Y3Rpb24gY2VpbGluZy4KICAgIC8vLyBAcGFyYW0gX3ByaWNlRmFjdG9yIEF1Y3Rpb24gcHJpY2UgZmFjdG9yLgogICAgZnVuY3Rpb24gRHV0Y2hBdWN0aW9uKGFkZHJlc3MgX3dhbGxldCwgdWludCBfY2VpbGluZywgdWludCBfcHJpY2VGYWN0b3IpCiAgICAgICAgcHVibGljCiAgICB7CiAgICAgICAgcmVxdWlyZSAoX3dhbGxldCAhPSAwKTsKICAgICAgICByZXF1aXJlIChfY2VpbGluZyAhPSAwKTsKICAgICAgICByZXF1aXJlIChfcHJpY2VGYWN0b3IgIT0gMCk7CiAgICAgICAgICAgIC8vIEFyZ3VtZW50cyBjYW5ub3QgYmUgbnVsbC4KICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgd2FsbGV0ID0gX3dhbGxldDsKICAgICAgICBjZWlsaW5nID0gX2NlaWxpbmc7CiAgICAgICAgcHJpY2VGYWN0b3IgPSBfcHJpY2VGYWN0b3I7CiAgICAgICAgc3RhZ2UgPSBTdGFnZXMuQXVjdGlvbkRlcGxveWVkOwogICAgfQoKICAgIC8vLyBAZGV2IFNldHVwIGZ1bmN0aW9uIHNldHMgZXh0ZXJuYWwgY29udHJhY3RzJyBhZGRyZXNzZXMuCiAgICAvLy8gQHBhcmFtIF92aXJ0dWVQbGF5ZXJQb2ludHMgdG9rZW4gY29udHJhY3QgYWRkcmVzcy4KICAgIGZ1bmN0aW9uIHNldHVwKGFkZHJlc3MgX3ZpcnR1ZVBsYXllclBvaW50cykKICAgICAgICBwdWJsaWMKICAgICAgICBpc093bmVyCiAgICAgICAgYXRTdGFnZShTdGFnZXMuQXVjdGlvbkRlcGxveWVkKQogICAgewogICAgICAgIHJlcXVpcmUgKF92aXJ0dWVQbGF5ZXJQb2ludHMgIT0gMCk7CiAgICAgICAgICAgIC8vIEFyZ3VtZW50IGNhbm5vdCBiZSBudWxsLgogICAgICAgIHZpcnR1ZVBsYXllclBvaW50cyA9IFRva2VuKF92aXJ0dWVQbGF5ZXJQb2ludHMpOwogICAgICAgIC8vIFZhbGlkYXRlIHRva2VuIGJhbGFuY2UKICAgICAgICByZXF1aXJlICh2aXJ0dWVQbGF5ZXJQb2ludHMuYmFsYW5jZU9mKHRoaXMpID09IE1BWF9UT0tFTlNfU09MRCk7CgogICAgICAgIHN0YWdlID0gU3RhZ2VzLkF1Y3Rpb25TZXRVcDsKICAgIH0KCgogICAgLy8vIEBkZXYgQWRkIGJpZGRlciBhZGRyZXNzIHRvIHdoaXRlbGlzdAogICAgLy8vIEBwYXJhbSBfYmlkZGVyQWRkciBCaWRkZXIgRXRoIGFkZHJlc3MKICAgIGZ1bmN0aW9uIGFkZFRvV2hpdGVsaXN0KGFkZHJlc3MgX2JpZGRlckFkZHIpCiAgICAgICAgcHVibGljCiAgICAgICAgaXNPd25lcgogICAgICAgIGF0U3RhZ2UoU3RhZ2VzLkF1Y3Rpb25TZXRVcCkKICAgIHsKICAgICAgICByZXF1aXJlKF9iaWRkZXJBZGRyICE9IDApOwogICAgICAgIGlmICh3aGl0ZWxpc3RJbmRleE1hcFtfYmlkZGVyQWRkcl0gPT0gMCkKICAgICAgICB7CiAgICAgICAgICAgIHVpbnQgaWR4UGx1c09uZSA9IGJpZGRlcldoaXRlbGlzdC5wdXNoKF9iaWRkZXJBZGRyKTsKICAgICAgICAgICAgd2hpdGVsaXN0SW5kZXhNYXBbX2JpZGRlckFkZHJdID0gaWR4UGx1c09uZTsgCiAgICAgICAgfQogICAgfQoKICAgIC8vLyBAZGV2IEFkZCBtdWx0aXBsZSBiaWRkZXIgYWRkcmVzc2VzIHRvIHdoaXRlbGlzdAogICAgLy8vIEBwYXJhbSBfYmlkZGVyQWRkcnMgQXJyYXkgb2YgQmlkZGVyIEV0aCBhZGRyZXNzZXMKICAgIGZ1bmN0aW9uIGFkZEFycmF5VG9XaGl0ZWxpc3QoYWRkcmVzc1tdIF9iaWRkZXJBZGRycykKICAgICAgICBwdWJsaWMKICAgICAgICBpc093bmVyCiAgICAgICAgYXRTdGFnZShTdGFnZXMuQXVjdGlvblNldFVwKQogICAgewogICAgICAgIHJlcXVpcmUoX2JpZGRlckFkZHJzLmxlbmd0aCAhPSAwKTsKICAgICAgICBmb3IodWludCBpZHggPSAwOyBpZHg8X2JpZGRlckFkZHJzLmxlbmd0aDsgaWR4KyspIHsKICAgICAgICAgICAgYWRkVG9XaGl0ZWxpc3QoX2JpZGRlckFkZHJzW2lkeF0pOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8gQGRldiBSZW1vdmUgYmlkZGVyIGFkZHJlc3MgZnJvbSB3aGl0ZWxpc3QKICAgIC8vLyBAcGFyYW0gX2JpZGRlckFkZHIgQmlkZGVyIEV0aCBhZGRyZXNzCiAgICBmdW5jdGlvbiByZW1vdmVGcm9tV2hpdGVsaXN0KGFkZHJlc3MgX2JpZGRlckFkZHIpCiAgICAgICAgcHVibGljCiAgICAgICAgaXNPd25lcgogICAgICAgIGF0U3RhZ2UoU3RhZ2VzLkF1Y3Rpb25TZXRVcCkgICAgICAgCiAgICB7CiAgICAgICAgcmVxdWlyZShfYmlkZGVyQWRkciAhPSAwKTsKICAgICAgICByZXF1aXJlKCB3aGl0ZWxpc3RJbmRleE1hcFtfYmlkZGVyQWRkcl0gIT0gMCk7IC8vIHRocm93IGlmIG5vdCBpbiBtYXAgICAgICAgICAgICAgCiAgICAgICAgdWludCBpZHggPSB3aGl0ZWxpc3RJbmRleE1hcFtfYmlkZGVyQWRkcl0gLSAxOwogICAgICAgIGJpZGRlcldoaXRlbGlzdFtpZHhdID0gMDsKICAgICAgICB3aGl0ZWxpc3RJbmRleE1hcFtfYmlkZGVyQWRkcl0gPSAwOwogICAgfQogICAgCiAgICAvLy8gQGRldiBJcyB0aGlzIGFkZHJlcyBpbiB0aGUgd2hpdGVsaXN0PwogICAgLy8vIEBwYXJhbSBfYWRkciBCaWRkZXIgRXRoIGFkZHJlc3MgICAgCiAgICBmdW5jdGlvbiBpc0luV2hpdGVsaXN0KGFkZHJlc3MgX2FkZHIpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zKGJvb2wpCiAgICB7CiAgICAgICAgcmV0dXJuICh3aGl0ZWxpc3RJbmRleE1hcFtfYWRkcl0gIT0gMCk7CiAgICB9CiAgICAKICAgIC8vLyBAZGV2IE51bWJlciBvZiBub24temVybyBlbnRyaWVzIGluIHdoaXRlbGlzdAogICAgLy8vIEByZXR1cm4gbnVtYmVyIG9mIG5vbi16ZXJvIGVudHJpZXMKICAgIGZ1bmN0aW9uIHdoaXRlbGlzdENvdW50KCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQpICAgICAgICAKICAgIHsKICAgICAgICB1aW50IGNvdW50ID0gMDsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGk8IGJpZGRlcldoaXRlbGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoYmlkZGVyV2hpdGVsaXN0W2ldICE9IDApCiAgICAgICAgICAgICAgICBjb3VudCsrOwogICAgICAgIH0KICAgICAgICByZXR1cm4gY291bnQ7CiAgICB9CiAgICAKICAgIC8vLyBAZGV2IEZldGNoIGVudHJpZXMgaW4gd2hpdGVsaXN0CiAgICAvLy8gQHBhcmFtIF9zdGFydElkeCBzdGFydGluZyBpbmRleAogICAgLy8vIEBwYXJhbSBfY291bnQgbnVtYmVyIHRvIGZldGNoLiB6ZXJvIGZvciBhbGwuCiAgICAvLy8gQHJldHVybiBhcnJheSBvZiBub24temVybyBlbnRyaWVzCiAgICAvLy8gTm90ZTogYmVjYXVzZSB0aGVyZSBjYW4gYmUgbnVsbCBlbnRyaWVzIGluIHRoZSBiaWRkZXJXaGl0ZWxpc3QgYXJyYXksCiAgICAvLy8gaW5kaWNlcyB1c2VkIGluIHRoaXMgY2FsbCBhcmUgbm90IHRoZSBzYW1lIGFzIHRob3NlIGluIGJpZGRlcndoaXRlTGlzdAogICAgZnVuY3Rpb24gd2hpdGVsaXN0RW50cmllcyh1aW50IF9zdGFydElkeCwgdWludCBfY291bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChhZGRyZXNzW10pICAgICAgICAKICAgIHsKICAgICAgICB1aW50IGFkZHJDb3VudCA9IHdoaXRlbGlzdENvdW50KCk7CiAgICAgICAgaWYgKF9jb3VudCA9PSAwKQogICAgICAgICAgICBfY291bnQgPSBhZGRyQ291bnQ7IAogICAgICAgIGlmIChfc3RhcnRJZHggPj0gYWRkckNvdW50KSB7CiAgICAgICAgICAgIF9zdGFydElkeCA9IDA7CiAgICAgICAgICAgIF9jb3VudCA9IDA7CiAgICAgICAgfSBlbHNlIGlmIChfc3RhcnRJZHggKyBfY291bnQgPiBhZGRyQ291bnQpIHsKICAgICAgICAgICAgX2NvdW50ID0gYWRkckNvdW50IC0gX3N0YXJ0SWR4OyAgICAgICAgCiAgICAgICAgfQoKICAgICAgICBhZGRyZXNzW10gbWVtb3J5IHJlc3VsdHMgPSBuZXcgYWRkcmVzc1tdKF9jb3VudCk7CiAgICAgICAgLy8gc2tpcCB0byBzdGFydElkeAogICAgICAgIHVpbnQgZHluQXJyYXlJZHggPSAwOyAKICAgICAgICB3aGlsZSAoX3N0YXJ0SWR4ID4gMCkgewogICAgICAgICAgICBpZiAoYmlkZGVyV2hpdGVsaXN0W2R5bkFycmF5SWR4KytdICE9IDApCiAgICAgICAgICAgICAgICBfc3RhcnRJZHgtLTsgIAogICAgICAgIH0gICAKICAgICAgICAvLyBjb3B5IGludG8gcmVzdWx0cwogICAgICAgIHVpbnQgcmVzdWx0c0lkeCA9IDA7IAogICAgICAgIHdoaWxlIChyZXN1bHRzSWR4IDwgX2NvdW50KSB7CiAgICAgICAgICAgIGFkZHJlc3MgYWRkciA9IGJpZGRlcldoaXRlbGlzdFtkeW5BcnJheUlkeCsrXTsKICAgICAgICAgICAgaWYgKGFkZHIgIT0gMCkKICAgICAgICAgICAgICAgIHJlc3VsdHNbcmVzdWx0c0lkeCsrXSA9IGFkZHI7ICAgICAgCiAgICAgICAgfQogICAgICAgIHJldHVybiByZXN1bHRzOyAgICAKICAgIH0gICAgCiAgICAKICAgIC8vLyBAZGV2IFN0YXJ0cyBhdWN0aW9uIGFuZCBzZXRzIHN0YXJ0QmxvY2suCiAgICBmdW5jdGlvbiBzdGFydEF1Y3Rpb24oKQogICAgICAgIHB1YmxpYwogICAgICAgIGlzV2FsbGV0CiAgICAgICAgYXRTdGFnZShTdGFnZXMuQXVjdGlvblNldFVwKQogICAgewogICAgICAgIHN0YWdlID0gU3RhZ2VzLkF1Y3Rpb25TdGFydGVkOwogICAgICAgIHN0YXJ0QmxvY2sgPSBibG9jay5udW1iZXI7CiAgICB9CgogICAgLy8vIEBkZXYgQ2hhbmdlcyBhdWN0aW9uIGNlaWxpbmcgYW5kIHN0YXJ0IHByaWNlIGZhY3RvciBiZWZvcmUgYXVjdGlvbiBpcyBzdGFydGVkLgogICAgLy8vIEBwYXJhbSBfY2VpbGluZyBVcGRhdGVkIGF1Y3Rpb24gY2VpbGluZy4KICAgIC8vLyBAcGFyYW0gX3ByaWNlRmFjdG9yIFVwZGF0ZWQgc3RhcnQgcHJpY2UgZmFjdG9yLgogICAgZnVuY3Rpb24gY2hhbmdlU2V0dGluZ3ModWludCBfY2VpbGluZywgdWludCBfcHJpY2VGYWN0b3IpCiAgICAgICAgcHVibGljCiAgICAgICAgaXNXYWxsZXQKICAgICAgICBhdFN0YWdlKFN0YWdlcy5BdWN0aW9uU2V0VXApCiAgICB7CiAgICAgICAgY2VpbGluZyA9IF9jZWlsaW5nOwogICAgICAgIHByaWNlRmFjdG9yID0gX3ByaWNlRmFjdG9yOwogICAgfQoKICAgIC8vLyBAZGV2IENhbGN1bGF0ZXMgY3VycmVudCB0b2tlbiBwcmljZS4KICAgIC8vLyBAcmV0dXJuIFJldHVybnMgdG9rZW4gcHJpY2UuCiAgICBmdW5jdGlvbiBjYWxjQ3VycmVudFRva2VuUHJpY2UoKQogICAgICAgIHB1YmxpYwogICAgICAgIHRpbWVkVHJhbnNpdGlvbnMKICAgICAgICByZXR1cm5zICh1aW50KQogICAgewogICAgICAgIGlmIChzdGFnZSA9PSBTdGFnZXMuQXVjdGlvbkVuZGVkIHx8IHN0YWdlID09IFN0YWdlcy5UcmFkaW5nU3RhcnRlZCkKICAgICAgICAgICAgcmV0dXJuIGZpbmFsUHJpY2U7CiAgICAgICAgcmV0dXJuIGNhbGNUb2tlblByaWNlKCk7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyBjb3JyZWN0IHN0YWdlLCBldmVuIGlmIGEgZnVuY3Rpb24gd2l0aCB0aW1lZFRyYW5zaXRpb25zIG1vZGlmaWVyIGhhcyBub3QgeWV0IGJlZW4gY2FsbGVkIHlldC4KICAgIC8vLyBAcmV0dXJuIFJldHVybnMgY3VycmVudCBhdWN0aW9uIHN0YWdlLgogICAgZnVuY3Rpb24gdXBkYXRlU3RhZ2UoKQogICAgICAgIHB1YmxpYwogICAgICAgIHRpbWVkVHJhbnNpdGlvbnMKICAgICAgICByZXR1cm5zIChTdGFnZXMpCiAgICB7CiAgICAgICAgcmV0dXJuIHN0YWdlOwogICAgfQoKICAgIC8vLyBAZGV2IEFsbG93cyB0byBzZW5kIGEgYmlkIHRvIHRoZSBhdWN0aW9uLgogICAgLy8vIEBwYXJhbSByZWNlaXZlciBCaWQgd2lsbCBiZSBhc3NpZ25lZCB0byB0aGlzIGFkZHJlc3MgaWYgc2V0LgogICAgZnVuY3Rpb24gYmlkKGFkZHJlc3MgcmVjZWl2ZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgcGF5YWJsZQogICAgICAgIGlzVmFsaWRQYXlsb2FkCiAgICAgICAgdGltZWRUcmFuc2l0aW9ucwogICAgICAgIGF0U3RhZ2UoU3RhZ2VzLkF1Y3Rpb25TdGFydGVkKQogICAgICAgIHJldHVybnMgKHVpbnQgYW1vdW50KQogICAgewogICAgICAgIC8vIElmIGEgYmlkIGlzIGRvbmUgb24gYmVoYWxmIG9mIGEgdXNlciB2aWEgU2hhcGVTaGlmdCwgdGhlIHJlY2VpdmVyIGFkZHJlc3MgaXMgc2V0LgogICAgICAgIGlmIChyZWNlaXZlciA9PSAwKQogICAgICAgICAgICByZWNlaXZlciA9IG1zZy5zZW5kZXI7CgogICAgICAgIHJlcXVpcmUoaXNJbldoaXRlbGlzdChyZWNlaXZlcikpOyAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICBhbW91bnQgPSBtc2cudmFsdWU7CiAgICAgICAgLy8gUHJldmVudCB0aGF0IG1vcmUgdGhhbiA5MCUgb2YgdG9rZW5zIGFyZSBzb2xkLiBPbmx5IHJlbGV2YW50IGlmIGNhcCBub3QgcmVhY2hlZC4KICAgICAgICB1aW50IG1heFdlaSA9IChNQVhfVE9LRU5TX1NPTEQgLyAxMCoqMTgpICogY2FsY1Rva2VuUHJpY2UoKSAtIHRvdGFsUmVjZWl2ZWQ7CiAgICAgICAgdWludCBtYXhXZWlCYXNlZE9uVG90YWxSZWNlaXZlZCA9IGNlaWxpbmcgLSB0b3RhbFJlY2VpdmVkOwogICAgICAgIGlmIChtYXhXZWlCYXNlZE9uVG90YWxSZWNlaXZlZCA8IG1heFdlaSkKICAgICAgICAgICAgbWF4V2VpID0gbWF4V2VpQmFzZWRPblRvdGFsUmVjZWl2ZWQ7CiAgICAgICAgLy8gT25seSBpbnZlc3QgbWF4aW11bSBwb3NzaWJsZSBhbW91bnQuCiAgICAgICAgaWYgKGFtb3VudCA+IG1heFdlaSkgewogICAgICAgICAgICBhbW91bnQgPSBtYXhXZWk7CiAgICAgICAgICAgIC8vIFNlbmQgY2hhbmdlIGJhY2sgdG8gcmVjZWl2ZXIgYWRkcmVzcy4gSW4gY2FzZSBvZiBhIFNoYXBlU2hpZnQgYmlkIHRoZSB1c2VyIHJlY2VpdmVzIHRoZSBjaGFuZ2UgYmFjayBkaXJlY3RseS4KICAgICAgICAgICAgcmVjZWl2ZXIudHJhbnNmZXIobXNnLnZhbHVlIC0gYW1vdW50KTsgLy8gdGhyb3dzIG9uIGZhaWx1cmUKICAgICAgICB9CiAgICAgICAgLy8gRm9yd2FyZCBmdW5kaW5nIHRvIGV0aGVyIHdhbGxldAogICAgICAgIHJlcXVpcmUgKGFtb3VudCAhPSAwKTsKICAgICAgICB3YWxsZXQudHJhbnNmZXIoYW1vdW50KTsgLy8gdGhyb3dzIG9uIGZhaWx1cmUKICAgICAgICBiaWRzW3JlY2VpdmVyXSArPSBhbW91bnQ7CiAgICAgICAgdG90YWxSZWNlaXZlZCArPSBhbW91bnQ7CiAgICAgICAgaWYgKG1heFdlaSA9PSBhbW91bnQpCiAgICAgICAgICAgIC8vIFdoZW4gbWF4V2VpIGlzIGVxdWFsIHRvIHRoZSBiaWcgYW1vdW50IHRoZSBhdWN0aW9uIGlzIGVuZGVkIGFuZCBmaW5hbGl6ZUF1Y3Rpb24gaXMgdHJpZ2dlcmVkLgogICAgICAgICAgICBmaW5hbGl6ZUF1Y3Rpb24oKTsKICAgICAgICBCaWRTdWJtaXNzaW9uKHJlY2VpdmVyLCBhbW91bnQpOwogICAgfQoKICAgIC8vLyBAZGV2IENsYWltcyB0b2tlbnMgZm9yIGJpZGRlciBhZnRlciBhdWN0aW9uLgogICAgLy8vIEBwYXJhbSByZWNlaXZlciBUb2tlbnMgd2lsbCBiZSBhc3NpZ25lZCB0byB0aGlzIGFkZHJlc3MgaWYgc2V0LgogICAgZnVuY3Rpb24gY2xhaW1Ub2tlbnMoYWRkcmVzcyByZWNlaXZlcikKICAgICAgICBwdWJsaWMKICAgICAgICBpc1ZhbGlkUGF5bG9hZAogICAgICAgIHRpbWVkVHJhbnNpdGlvbnMKICAgICAgICBhdFN0YWdlKFN0YWdlcy5UcmFkaW5nU3RhcnRlZCkKICAgIHsKICAgICAgICBpZiAocmVjZWl2ZXIgPT0gMCkKICAgICAgICAgICAgcmVjZWl2ZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIHVpbnQgdG9rZW5Db3VudCA9IGJpZHNbcmVjZWl2ZXJdICogMTAqKjE4IC8gZmluYWxQcmljZTsKICAgICAgICBiaWRzW3JlY2VpdmVyXSA9IDA7CiAgICAgICAgdmlydHVlUGxheWVyUG9pbnRzLnRyYW5zZmVyKHJlY2VpdmVyLCB0b2tlbkNvdW50KTsKICAgIH0KCiAgICAvLy8gQGRldiBDYWxjdWxhdGVzIHN0b3AgcHJpY2UuCiAgICAvLy8gQHJldHVybiBSZXR1cm5zIHN0b3AgcHJpY2UuCiAgICBmdW5jdGlvbiBjYWxjU3RvcFByaWNlKCkKICAgICAgICBjb25zdGFudAogICAgICAgIHB1YmxpYwogICAgICAgIHJldHVybnMgKHVpbnQpCiAgICB7CiAgICAgICAgcmV0dXJuIHRvdGFsUmVjZWl2ZWQgKiAxMCoqMTggLyBNQVhfVE9LRU5TX1NPTEQgKyAxOwogICAgfQoKICAgIC8vLyBAZGV2IENhbGN1bGF0ZXMgdG9rZW4gcHJpY2UuCiAgICAvLy8gQHJldHVybiBSZXR1cm5zIHRva2VuIHByaWNlLgogICAgZnVuY3Rpb24gY2FsY1Rva2VuUHJpY2UoKQogICAgICAgIGNvbnN0YW50CiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyAodWludCkKICAgIHsKICAgICAgICByZXR1cm4gcHJpY2VGYWN0b3IgKiAxMCoqMTggLyAoYmxvY2subnVtYmVyIC0gc3RhcnRCbG9jayArIDgwMDApICsgMTsKICAgIH0KCiAgICAvKgogICAgICogIFByaXZhdGUgZnVuY3Rpb25zCiAgICAgKi8KICAgIGZ1bmN0aW9uIGZpbmFsaXplQXVjdGlvbigpCiAgICAgICAgcHJpdmF0ZQogICAgewogICAgICAgIHN0YWdlID0gU3RhZ2VzLkF1Y3Rpb25FbmRlZDsKICAgICAgICBpZiAodG90YWxSZWNlaXZlZCA9PSBjZWlsaW5nKQogICAgICAgICAgICBmaW5hbFByaWNlID0gY2FsY1Rva2VuUHJpY2UoKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIGZpbmFsUHJpY2UgPSBjYWxjU3RvcFByaWNlKCk7CiAgICAgICAgdWludCBzb2xkVG9rZW5zID0gdG90YWxSZWNlaXZlZCAqIDEwKioxOCAvIGZpbmFsUHJpY2U7CiAgICAgICAgLy8gQXVjdGlvbiBjb250cmFjdCB0cmFuc2ZlcnMgYWxsIHVuc29sZCB0b2tlbnMgdG8gbXVsdGlzaWcgd2FsbGV0CiAgICAgICAgdmlydHVlUGxheWVyUG9pbnRzLnRyYW5zZmVyKHdhbGxldCwgTUFYX1RPS0VOU19TT0xEIC0gc29sZFRva2Vucyk7CiAgICAgICAgZW5kVGltZSA9IG5vdzsKICAgIH0KfQ=='.
	

]
