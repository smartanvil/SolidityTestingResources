Class {
	#name : #SRT0e752b742f744fdc2d93774da44c37b72c3e6952,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT0e752b742f744fdc2d93774da44c37b72c3e6952 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBPcGVuWmVwcGVsaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvYmxvYi92MS40LjAvY29udHJhY3RzL21hdGgvU2FmZU1hdGguc29sCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICAgIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgaWYgKGEgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgICAgdWludDI1NiBjID0gYSAqIGI7CiAgICAgICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgYXNzZXJ0KGIgPiAwKTsKICAgICAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGFzc2VydChiIDw9IGEpOwogICAgICAgIHJldHVybiBhIC0gYjsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgICAgIGFzc2VydChjID49IGEpOwogICAgICAgIHJldHVybiBjOwogICAgfQp9CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgT3BlblplcHBlbGluOiBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5L2Jsb2IvdjEuNC4wL2NvbnRyYWN0cy9vd25lcnNoaXAvT3duYWJsZS5zb2wKICovCmNvbnRyYWN0IE93bmFibGUgewogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgogICAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgogICAgLyoqCiAgICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICAgKi8KICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgICAqIGFjY291bnQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgIH0KCn0KCi8qKgogKiBAdGl0bGUgUGF1c2FibGUKICogQGRldiBCYXNlIGNvbnRyYWN0IHdoaWNoIGFsbG93cyBjaGlsZHJlbiB0byBpbXBsZW1lbnQgYW4gZW1lcmdlbmN5IHN0b3AgbWVjaGFuaXNtLgogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgT3BlblplcHBlbGluOiBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5L2Jsb2IvdjEuNC4wL2NvbnRyYWN0cy9saWZlY3ljbGUvUGF1c2FibGUuc29sCiAqLwpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKICAgIGV2ZW50IFBhdXNlKCk7CiAgICBldmVudCBVbnBhdXNlKCk7CgogICAgYm9vbCBwdWJsaWMgcGF1c2VkID0gZmFsc2U7CgogICAgLyoqCiAgICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIG5vdCBwYXVzZWQuCiAgICAgKi8KICAgIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICAgICAgcmVxdWlyZSghcGF1c2VkKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBwYXVzZWQuCiAgICAgKi8KICAgIG1vZGlmaWVyIHdoZW5QYXVzZWQoKSB7CiAgICAgICAgcmVxdWlyZShwYXVzZWQpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gcGF1c2UsIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUKICAgICAqLwogICAgZnVuY3Rpb24gcGF1c2UoKSBwdWJsaWMgb25seU93bmVyIHdoZW5Ob3RQYXVzZWQgewogICAgICAgIHBhdXNlZCA9IHRydWU7CiAgICAgICAgUGF1c2UoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byB1bnBhdXNlLCByZXR1cm5zIHRvIG5vcm1hbCBzdGF0ZQogICAgICovCiAgICBmdW5jdGlvbiB1bnBhdXNlKCkgcHVibGljIG9ubHlPd25lciB3aGVuUGF1c2VkIHsKICAgICAgICBwYXVzZWQgPSBmYWxzZTsKICAgICAgICBVbnBhdXNlKCk7CiAgICB9Cn0KCi8qKgogKiBAdGl0bGUgRVJDMjBCYXNpYwogKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE3OQogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgT3BlblplcHBlbGluOiBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5L2Jsb2IvdjEuNC4wL2NvbnRyYWN0cy90b2tlbi9FUkMyMEJhc2ljLnNvbAogKi8KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgT3BlblplcHBlbGluOiBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5L2Jsb2IvdjEuNC4wL2NvbnRyYWN0cy90b2tlbi9CYXNpY1Rva2VuLnNvbAogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgICAvKioKICAgICogQGRldiBUcmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICAgKi8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9Cgp9CgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IE9wZW5aZXBwZWxpbjogaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXBwZWxpbi1zb2xpZGl0eS9ibG9iL3YxLjQuMC9jb250cmFjdHMvdG9rZW4vRVJDMjAuc29sCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIAogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBPcGVuWmVwcGVsaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvYmxvYi92MS40LjAvY29udHJhY3RzL3Rva2VuL1N0YW5kYXJkVG9rZW4uc29sCiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgaW50ZXJuYWwgYWxsb3dlZDsKCiAgICAvKioKICAgICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgICAqIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSk7CgogICAgICAgIHVpbnQyNTYgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOwoKICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBfYWxsb3dhbmNlLnN1YihfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgICAqCiAgICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgICAqIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgICAqLwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgICB9Cn0KCi8qKgogKiBAdGl0bGUgTWludGFibGUgdG9rZW4KICogQGRldiBTaW1wbGUgRVJDMjAgVG9rZW4gZXhhbXBsZSwgd2l0aCBtaW50YWJsZSB0b2tlbiBjcmVhdGlvbgogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgT3BlblplcHBlbGluOiBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5L2Jsb2IvdjEuNC4wL2NvbnRyYWN0cy90b2tlbi9NaW50YWJsZVRva2VuLnNvbAogKi8KCmNvbnRyYWN0IE1pbnRhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZSB7CiAgICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwogICAgZXZlbnQgTWludEZpbmlzaGVkKCk7CgogICAgYm9vbCBwdWJsaWMgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CgogICAgYWRkcmVzcyBwdWJsaWMgbWludEFkZHJlc3M7CgogICAgbW9kaWZpZXIgY2FuTWludCgpIHsKICAgICAgICByZXF1aXJlKCFtaW50aW5nRmluaXNoZWQpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seU1pbnQoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG1pbnRBZGRyZXNzKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBjaGFuZ2UgYWRkcmVzcyB0aGF0IGlzIGFsbG93ZWQgdG8gZG8gZW1pc3Npb24uCiAgICAgKiBAcGFyYW0gX21pbnRBZGRyZXNzIEFkZHJlc3Mgb2YgdGhlIGVtaXNzaW9uIGNvbnRyYWN0LgogICAgICovCiAgICBmdW5jdGlvbiBzZXRNaW50QWRkcmVzcyhhZGRyZXNzIF9taW50QWRkcmVzcykgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShfbWludEFkZHJlc3MgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgbWludEFkZHJlc3MgPSBfbWludEFkZHJlc3M7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIG1pbnQgdG9rZW5zCiAgICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCByZWNlaXZlIHRoZSBtaW50ZWQgdG9rZW5zLgogICAgICogQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gbWludC4KICAgICAqIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICAgKi8KICAgIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIG9ubHlNaW50IGNhbk1pbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKF9hbW91bnQpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfYW1vdW50KTsKICAgICAgICBNaW50KF90bywgX2Ftb3VudCk7CiAgICAgICAgVHJhbnNmZXIoYWRkcmVzcygwKSwgX3RvLCBfYW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gc3RvcCBtaW50aW5nIG5ldyB0b2tlbnMuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgICAqLwogICAgZnVuY3Rpb24gZmluaXNoTWludGluZygpIHB1YmxpYyBvbmx5TWludCBjYW5NaW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICBtaW50aW5nRmluaXNoZWQgPSB0cnVlOwogICAgICAgIE1pbnRGaW5pc2hlZCgpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9CgovKioKICogQHRpdGxlIFRva2VuVGltZWxvY2sKICogQGRldiBUb2tlblRpbWVsb2NrIGlzIGEgdG9rZW4gaG9sZGVyIGNvbnRyYWN0IHRoYXQgd2lsbCBhbGxvdyBhCiAqIGJlbmVmaWNpYXJ5IHRvIGV4dHJhY3QgdGhlIHRva2VucyBhZnRlciBhIGdpdmVuIHJlbGVhc2UgdGltZQogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgT3BlblplcHBlbGluOiBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5L2Jsb2IvdjEuNC4wL2NvbnRyYWN0cy90b2tlbi9Ub2tlblRpbWVsb2NrLnNvbAogKi8KY29udHJhY3QgVG9rZW5UaW1lbG9jayB7CiAgICAvLyBFUkMyMCBiYXNpYyB0b2tlbiBjb250cmFjdCBiZWluZyBoZWxkCiAgICBFUkMyMEJhc2ljIHB1YmxpYyB0b2tlbjsKCiAgICAvLyBiZW5lZmljaWFyeSBvZiB0b2tlbnMgYWZ0ZXIgdGhleSBhcmUgcmVsZWFzZWQKICAgIGFkZHJlc3MgcHVibGljIGJlbmVmaWNpYXJ5OwoKICAgIC8vIHRpbWVzdGFtcCB3aGVuIHRva2VuIHJlbGVhc2UgaXMgZW5hYmxlZAogICAgdWludDI1NiBwdWJsaWMgcmVsZWFzZVRpbWU7CgogICAgLyoqCiAgICAgKiBAZGV2IFRoZSBUb2tlblRpbWVsb2NrIGNvbnN0cnVjdG9yIHNldHMgdG9rZW4gYWRkcmVzcywgYmVuZWZpY2lhcnkgYW5kIHRpbWUgdG8gcmVsZWFzZS4KICAgICAqIEBwYXJhbSBfdG9rZW4gQWRkcmVzcyBvZiB0aGUgdG9rZW4KICAgICAqIEBwYXJhbSBfYmVuZWZpY2lhcnkgQWRkcmVzcyB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgdG9rZW5zIGFmdGVyIHJlbGVhc2UKICAgICAqIEBwYXJhbSBfcmVsZWFzZVRpbWUgVGltZSB0aGF0IHdpbGwgYWxsb3cgcmVsZWFzZSB0aGUgdG9rZW5zCiAgICAgKi8KICAgIGZ1bmN0aW9uIFRva2VuVGltZWxvY2soRVJDMjBCYXNpYyBfdG9rZW4sIGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCB1aW50MjU2IF9yZWxlYXNlVGltZSkgcHVibGljIHsKICAgICAgICByZXF1aXJlKF9yZWxlYXNlVGltZSA+IG5vdyk7CiAgICAgICAgdG9rZW4gPSBfdG9rZW47CiAgICAgICAgYmVuZWZpY2lhcnkgPSBfYmVuZWZpY2lhcnk7CiAgICAgICAgcmVsZWFzZVRpbWUgPSBfcmVsZWFzZVRpbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IFRyYW5zZmVycyB0b2tlbnMgaGVsZCBieSB0aW1lbG9jayB0byBiZW5lZmljaWFyeS4KICAgICAqLwogICAgZnVuY3Rpb24gcmVsZWFzZSgpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShub3cgPj0gcmVsZWFzZVRpbWUpOwoKICAgICAgICB1aW50MjU2IGFtb3VudCA9IHRva2VuLmJhbGFuY2VPZih0aGlzKTsKICAgICAgICByZXF1aXJlKGFtb3VudCA+IDApOwoKICAgICAgICB0b2tlbi50cmFuc2ZlcihiZW5lZmljaWFyeSwgYW1vdW50KTsKICAgIH0KfQoKLyoqCiAqIEB0aXRsZSBDcmFmdHlDcm93ZHNhbGUKICogQGRldiBDcmFmdHlDcm93ZHNhbGUgaXMgYSBjb250cmFjdCBmb3IgbWFuYWdpbmcgYSBDcmFmdHkgdG9rZW4gY3Jvd2RzYWxlLgogKi8KY29udHJhY3QgQ3JhZnR5Q3Jvd2RzYWxlIGlzIFBhdXNhYmxlIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIC8vIEFtb3VudCByZWNlaXZlZCBmcm9tIGVhY2ggYWRkcmVzcwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHJlY2VpdmVkOwoKICAgIC8vIFRoZSB0b2tlbiBiZWluZyBzb2xkCiAgICBNaW50YWJsZVRva2VuIHB1YmxpYyB0b2tlbjsKCiAgICAvLyBzdGFydCBhbmQgZW5kIHRpbWVzdGFtcHMgd2hlcmUgaW52ZXN0bWVudHMgYXJlIGFsbG93ZWQgKGJvdGggaW5jbHVzaXZlKQogICAgdWludDI1NiBwdWJsaWMgcHJlU2FsZVN0YXJ0OwogICAgdWludDI1NiBwdWJsaWMgcHJlU2FsZUVuZDsKICAgIHVpbnQyNTYgcHVibGljIHNhbGVTdGFydDsKICAgIHVpbnQyNTYgcHVibGljIHNhbGVFbmQ7CgogICAgLy8gYW1vdW50IG9mIHRva2VucyBzb2xkCiAgICB1aW50MjU2IHB1YmxpYyBpc3N1ZWRUb2tlbnMgPSAwOwoKICAgIC8vIHRva2VuIGNhcAogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgaGFyZENhcCA9IDUwMDAwMDAwMDAgKiAxMCoqODsgLy8gNTAlCgogICAgLy8gdG9rZW4gd2FsbGV0cwogICAgdWludDI1NiBjb25zdGFudCB0ZWFtQ2FwID0gMTQ1MDAwMDAwMCAqIDEwKio4OyAvLyAxNC41JQogICAgdWludDI1NiBjb25zdGFudCBhZHZpc29yQ2FwID0gNDUwMDAwMDAwICogMTAqKjg7IC8vIDQuNSUKICAgIHVpbnQyNTYgY29uc3RhbnQgYm91bnR5Q2FwID0gMTAwMDAwMDAwICogMTAqKjg7IC8vIDElCiAgICB1aW50MjU2IGNvbnN0YW50IGZ1bmRDYXAgPSAzMDAwMDAwMDAwICogMTAqKjg7IC8vIDMwJQoKICAgIC8vIE51bWJlciBvZiBkYXlzIHRoZSB0b2tlbnMgd2lsbCBiZSBsb2NrZWQKICAgIHVpbnQyNTYgY29uc3RhbnQgbG9ja1RpbWUgPSAxODAgZGF5czsKCiAgICAvLyB3YWxsZXRzCiAgICBhZGRyZXNzIHB1YmxpYyBldGhlcldhbGxldDsKICAgIGFkZHJlc3MgcHVibGljIHRlYW1XYWxsZXQ7CiAgICBhZGRyZXNzIHB1YmxpYyBhZHZpc29yV2FsbGV0OwogICAgYWRkcmVzcyBwdWJsaWMgZnVuZFdhbGxldDsKICAgIGFkZHJlc3MgcHVibGljIGJvdW50eVdhbGxldDsKCiAgICAvLyB0aW1lbG9ja2VkIHRva2VucwogICAgVG9rZW5UaW1lbG9jayB0ZWFtVG9rZW5zOwoKICAgIHVpbnQyNTYgcHVibGljIHJhdGU7CgogICAgZW51bSBTdGF0ZSB7IEJFRk9SRV9TVEFSVCwgU0FMRSwgUkVGVU5ELCBDTE9TRUQgfQogICAgU3RhdGUgY3VycmVudFN0YXRlID0gU3RhdGUuQkVGT1JFX1NUQVJUOwoKICAgIC8qKgogICAgICogQGRldiBFdmVudCBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAgICogQHBhcmFtIHB1cmNoYXNlciB3aG8gcGFpZCBmb3IgdGhlIHRva2VucwogICAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IHdobyBnb3QgdGhlIHRva2VucwogICAgICogQHBhcmFtIGFtb3VudCBhbW91bnQgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAgICovCiAgICBldmVudCBUb2tlblB1cmNoYXNlKGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiBhbW91bnQpOwoKICAgIC8qKgogICAgICogQGRldiBFdmVudCBmb3IgcmVmdW5kCiAgICAgKiBAcGFyYW0gdG8gd2hvIHNlbnQgd2VpCiAgICAgKiBAcGFyYW0gYW1vdW50IGFtb3VudCBvZiB3ZWkgcmVmdW5kZWQKICAgICAqLwogICAgZXZlbnQgUmVmdW5kKGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwoKICAgIC8qKgogICAgICogQGRldiBtb2RpZmllciB0byBhbGxvdyB0b2tlbiBjcmVhdGlvbiBvbmx5IHdoZW4gdGhlIHNhbGUgaXMgb24KICAgICAqLwogICAgbW9kaWZpZXIgc2FsZUlzT24oKSB7CiAgICAgICAgcmVxdWlyZSgKICAgICAgICAgICAgKAogICAgICAgICAgICAgICAgKG5vdyA+PSBwcmVTYWxlU3RhcnQgJiYgbm93IDwgcHJlU2FsZUVuZCkgfHwgCiAgICAgICAgICAgICAgICAobm93ID49IHNhbGVTdGFydCAmJiBub3cgPCBzYWxlRW5kKQogICAgICAgICAgICApICYmIAogICAgICAgICAgICBpc3N1ZWRUb2tlbnMgPCBoYXJkQ2FwICYmIAogICAgICAgICAgICBjdXJyZW50U3RhdGUgPT0gU3RhdGUuU0FMRQogICAgICAgICk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgbW9kaWZpZXIgdG8gYWxsb3cgYWN0aW9uIG9ubHkgYmVmb3JlIHNhbGUKICAgICAqLwogICAgbW9kaWZpZXIgYmVmb3JlU2FsZSgpIHsKICAgICAgICByZXF1aXJlKCBub3cgPCBwcmVTYWxlU3RhcnQpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IG1vZGlmaWVyIHRoYXQgZmFpbHMgaWYgc3RhdGUgZG9lc24ndCBtYXRjaAogICAgICovCiAgICBtb2RpZmllciBpblN0YXRlKFN0YXRlIF9zdGF0ZSkgewogICAgICAgIHJlcXVpcmUoY3VycmVudFN0YXRlID09IF9zdGF0ZSk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQ3JhZnR5Q3Jvd2RzYWxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIHRva2VuLCBwZXJpb2QgYW5kIGV4Y2hhbmdlIHJhdGUKICAgICAqIEBwYXJhbSBfdG9rZW4gVGhlIGFkZHJlc3Mgb2YgQ3JhZnR5IFRva2VuLgogICAgICogQHBhcmFtIF9wcmVTYWxlU3RhcnQgVGhlIHN0YXJ0IHRpbWUgb2YgcHJlLXNhbGUuCiAgICAgKiBAcGFyYW0gX3ByZVNhbGVFbmQgVGhlIGVuZCB0aW1lIG9mIHByZS1zYWxlLgogICAgICogQHBhcmFtIF9zYWxlU3RhcnQgVGhlIHN0YXJ0IHRpbWUgb2Ygc2FsZS4KICAgICAqIEBwYXJhbSBfc2FsZUVuZCBUaGUgZW5kIHRpbWUgb2Ygc2FsZS4KICAgICAqIEBwYXJhbSBfcmF0ZSBUaGUgZXhjaGFuZ2UgcmF0ZSBvZiB0b2tlbnMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIENyYWZ0eUNyb3dkc2FsZShhZGRyZXNzIF90b2tlbiwgdWludDI1NiBfcHJlU2FsZVN0YXJ0LCB1aW50MjU2IF9wcmVTYWxlRW5kLCB1aW50MjU2IF9zYWxlU3RhcnQsIHVpbnQyNTYgX3NhbGVFbmQsIHVpbnQyNTYgX3JhdGUpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfdG9rZW4gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfcHJlU2FsZVN0YXJ0IDwgX3ByZVNhbGVFbmQgJiYgX3ByZVNhbGVFbmQgPCBfc2FsZVN0YXJ0ICYmIF9zYWxlU3RhcnQgPCBfc2FsZUVuZCk7CiAgICAgICAgcmVxdWlyZShfcmF0ZSA+IDApOwoKICAgICAgICB0b2tlbiA9IE1pbnRhYmxlVG9rZW4oX3Rva2VuKTsKICAgICAgICBwcmVTYWxlU3RhcnQgPSBfcHJlU2FsZVN0YXJ0OwogICAgICAgIHByZVNhbGVFbmQgPSBfcHJlU2FsZUVuZDsKICAgICAgICBzYWxlU3RhcnQgPSBfc2FsZVN0YXJ0OwogICAgICAgIHNhbGVFbmQgPSBfc2FsZUVuZDsKICAgICAgICByYXRlID0gX3JhdGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEZhbGxiYWNrIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIGJ1eSB0b2tlbnMKICAgICAqLwogICAgZnVuY3Rpb24gKCkgcHVibGljIHBheWFibGUgewogICAgICAgIGlmKG1zZy5zZW5kZXIgIT0gb3duZXIpCiAgICAgICAgICAgIGJ1eVRva2VucygpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB1c2VkIHRvIGJ1eSB0b2tlbnMKICAgICAqLwogICAgZnVuY3Rpb24gYnV5VG9rZW5zKCkgcHVibGljIHNhbGVJc09uIHdoZW5Ob3RQYXVzZWQgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID49IDIwIGZpbm5leSk7CgogICAgICAgIHVpbnQyNTYgd2VpQW1vdW50ID0gbXNnLnZhbHVlOwogICAgICAgIHVpbnQyNTYgY3VycmVudFJhdGUgPSBnZXRSYXRlKHdlaUFtb3VudCk7CgogICAgICAgIC8vIGNhbGN1bGF0ZSB0b2tlbiBhbW91bnQgdG8gYmUgY3JlYXRlZAogICAgICAgIHVpbnQyNTYgbmV3VG9rZW5zID0gd2VpQW1vdW50Lm11bChjdXJyZW50UmF0ZSkuZGl2KDEwKioxOCk7CgogICAgICAgIHJlcXVpcmUoaXNzdWVkVG9rZW5zLmFkZChuZXdUb2tlbnMpIDw9IGhhcmRDYXApOwogICAgICAgIAogICAgICAgIGlzc3VlZFRva2VucyA9IGlzc3VlZFRva2Vucy5hZGQobmV3VG9rZW5zKTsKICAgICAgICByZWNlaXZlZFttc2cuc2VuZGVyXSA9IHJlY2VpdmVkW21zZy5zZW5kZXJdLmFkZCh3ZWlBbW91bnQpOwogICAgICAgIHRva2VuLm1pbnQobXNnLnNlbmRlciwgbmV3VG9rZW5zKTsKICAgICAgICBUb2tlblB1cmNoYXNlKG1zZy5zZW5kZXIsIG1zZy5zZW5kZXIsIG5ld1Rva2Vucyk7CgogICAgICAgIGV0aGVyV2FsbGV0LnRyYW5zZmVyKG1zZy52YWx1ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHVzZWQgdG8gY2hhbmdlIHRoZSBleGNoYW5nZSByYXRlLgogICAgICogQHBhcmFtIF9yYXRlIFRoZSBuZXcgcmF0ZS4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0UmF0ZSh1aW50MjU2IF9yYXRlKSBwdWJsaWMgb25seU93bmVyIGJlZm9yZVNhbGUgewogICAgICAgIHJlcXVpcmUoX3JhdGUgPiAwKTsKCiAgICAgICAgcmF0ZSA9IF9yYXRlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB1c2VkIHRvIHNldCB3YWxsZXRzIGFuZCBlbmFibGUgdGhlIHNhbGUuCiAgICAgKiBAcGFyYW0gX2V0aGVyV2FsbGV0IEFkZHJlc3Mgb2YgZXRoZXIgd2FsbGV0LgogICAgICogQHBhcmFtIF90ZWFtV2FsbGV0IEFkZHJlc3Mgb2YgdGVhbSB3YWxsZXQuCiAgICAgKiBAcGFyYW0gX2Fkdmlzb3JXYWxsZXQgQWRkcmVzcyBvZiBhZHZpc29ycyB3YWxsZXQuCiAgICAgKiBAcGFyYW0gX2JvdW50eVdhbGxldCBBZGRyZXNzIG9mIGJvdW50eSB3YWxsZXQuCiAgICAgKiBAcGFyYW0gX2Z1bmRXYWxsZXQgQWRkcmVzcyBvZiBmdW5kIHdhbGxldC4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0V2FsbGV0cyhhZGRyZXNzIF9ldGhlcldhbGxldCwgYWRkcmVzcyBfdGVhbVdhbGxldCwgYWRkcmVzcyBfYWR2aXNvcldhbGxldCwgYWRkcmVzcyBfYm91bnR5V2FsbGV0LCBhZGRyZXNzIF9mdW5kV2FsbGV0KSBwdWJsaWMgb25seU93bmVyIGluU3RhdGUoU3RhdGUuQkVGT1JFX1NUQVJUKSB7CiAgICAgICAgcmVxdWlyZShfZXRoZXJXYWxsZXQgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdGVhbVdhbGxldCAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF9hZHZpc29yV2FsbGV0ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX2JvdW50eVdhbGxldCAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF9mdW5kV2FsbGV0ICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICBldGhlcldhbGxldCA9IF9ldGhlcldhbGxldDsKICAgICAgICB0ZWFtV2FsbGV0ID0gX3RlYW1XYWxsZXQ7CiAgICAgICAgYWR2aXNvcldhbGxldCA9IF9hZHZpc29yV2FsbGV0OwogICAgICAgIGJvdW50eVdhbGxldCA9IF9ib3VudHlXYWxsZXQ7CiAgICAgICAgZnVuZFdhbGxldCA9IF9mdW5kV2FsbGV0OwoKICAgICAgICB1aW50MjU2IHJlbGVhc2VUaW1lID0gc2FsZUVuZCArIGxvY2tUaW1lOwoKICAgICAgICAvLyBNaW50IGxvY2tlZCB0b2tlbnMKICAgICAgICB0ZWFtVG9rZW5zID0gbmV3IFRva2VuVGltZWxvY2sodG9rZW4sIHRlYW1XYWxsZXQsIHJlbGVhc2VUaW1lKTsKICAgICAgICB0b2tlbi5taW50KHRlYW1Ub2tlbnMsIHRlYW1DYXApOwoKICAgICAgICAvLyBNaW50IHJlbGVhc2VkIHRva2VucwogICAgICAgIHRva2VuLm1pbnQoYWR2aXNvcldhbGxldCwgYWR2aXNvckNhcCk7CiAgICAgICAgdG9rZW4ubWludChib3VudHlXYWxsZXQsIGJvdW50eUNhcCk7CiAgICAgICAgdG9rZW4ubWludChmdW5kV2FsbGV0LCBmdW5kQ2FwKTsKCiAgICAgICAgY3VycmVudFN0YXRlID0gU3RhdGUuU0FMRTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgR2VuZXJhdGUgdG9rZW5zIHRvIHNwZWNpZmljIGFkZHJlc3MsIG5lY2Vzc2FyeSB0byBhY2NlcHQgb3RoZXIgY3J5cHRvcy4KICAgICAqIEBwYXJhbSBiZW5lZmljaWFyeSBBZGRyZXNzIG9mIHRoZSBiZW5lZmljaWFyeS4KICAgICAqIEBwYXJhbSBuZXdUb2tlbnMgQW1vdW50IG9mIHRva2VucyB0byBiZSBtaW50ZWQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdlbmVyYXRlVG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQyNTYgbmV3VG9rZW5zKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKGJlbmVmaWNpYXJ5ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUobmV3VG9rZW5zID4gMCk7CiAgICAgICAgcmVxdWlyZShpc3N1ZWRUb2tlbnMuYWRkKG5ld1Rva2VucykgPD0gaGFyZENhcCk7CgogICAgICAgIGlzc3VlZFRva2VucyA9IGlzc3VlZFRva2Vucy5hZGQobmV3VG9rZW5zKTsKICAgICAgICB0b2tlbi5taW50KGJlbmVmaWNpYXJ5LCBuZXdUb2tlbnMpOwogICAgICAgIFRva2VuUHVyY2hhc2UobXNnLnNlbmRlciwgYmVuZWZpY2lhcnksIG5ld1Rva2Vucyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEZpbmlzaCBjcm93ZHNhbGUgYW5kIHRva2VuIG1pbnRpbmcuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGZpbmlzaENyb3dkc2FsZSgpIHB1YmxpYyBvbmx5T3duZXIgaW5TdGF0ZShTdGF0ZS5TQUxFKSB7CiAgICAgICAgcmVxdWlyZShub3cgPiBzYWxlRW5kKTsKICAgICAgICAvLyB0b2tlbnMgbm90IHNvbGQgdG8gZnVuZAogICAgICAgIHVpbnQyNTYgdW5zcGVudFRva2VucyA9IGhhcmRDYXAuc3ViKGlzc3VlZFRva2Vucyk7CiAgICAgICAgdG9rZW4ubWludChmdW5kV2FsbGV0LCB1bnNwZW50VG9rZW5zKTsKCiAgICAgICAgY3VycmVudFN0YXRlID0gU3RhdGUuQ0xPU0VEOwoKICAgICAgICB0b2tlbi5maW5pc2hNaW50aW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEVuYWJsZSByZWZ1bmQgYWZ0ZXIgc2FsZS4KICAgICAqLwogICAgZnVuY3Rpb24gZW5hYmxlUmVmdW5kKCkgcHVibGljIG9ubHlPd25lciBpblN0YXRlKFN0YXRlLkNMT1NFRCkgewogICAgICAgIGN1cnJlbnRTdGF0ZSA9IFN0YXRlLlJFRlVORDsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQ2hlY2sgdGhlIGFtb3VudCBvZiB3ZWkgcmVjZWl2ZWQgYnkgYmVuZWZpY2lhcnkuCiAgICAgKiBAcGFyYW0gYmVuZWZpY2lhcnkgQWRkcmVzcyBvZiBiZW5lZmljaWFyeS4KICAgICAqLwogICAgZnVuY3Rpb24gcmVjZWl2ZWRGcm9tKGFkZHJlc3MgYmVuZWZpY2lhcnkpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gcmVjZWl2ZWRbYmVuZWZpY2lhcnldOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB1c2VkIHRvIGNsYWltIHdlaSBpZiByZWZ1bmQgaXMgZW5hYmxlZC4KICAgICAqLwogICAgZnVuY3Rpb24gY2xhaW1SZWZ1bmQoKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCBpblN0YXRlKFN0YXRlLlJFRlVORCkgewogICAgICAgIHJlcXVpcmUocmVjZWl2ZWRbbXNnLnNlbmRlcl0gPiAwKTsKCiAgICAgICAgdWludDI1NiBhbW91bnQgPSByZWNlaXZlZFttc2cuc2VuZGVyXTsKICAgICAgICByZWNlaXZlZFttc2cuc2VuZGVyXSA9IDA7CiAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihhbW91bnQpOwogICAgICAgIFJlZnVuZChtc2cuc2VuZGVyLCBhbW91bnQpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB1c2VkIHRvIHJlbGVhc2UgdG9rZW4gb2YgdGVhbSB3YWxsZXQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHJlbGVhc2VUZWFtVG9rZW5zKCkgcHVibGljIHsKICAgICAgICB0ZWFtVG9rZW5zLnJlbGVhc2UoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdXNlZCB0byByZWNsYWltIGV0aGVyIGJ5IG93bmVyLgogICAgICovCiAgICBmdW5jdGlvbiByZWNsYWltRXRoZXIoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBvd25lci50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBHZXQgZXhjaGFuZ2UgcmF0ZSBiYXNlZCBvbiB0aW1lIGFuZCBhbW91bnQuCiAgICAgKiBAcGFyYW0gYW1vdW50IEFtb3VudCByZWNlaXZlZC4KICAgICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGV4Y2hhbmdlIHJhdGUuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFJhdGUodWludDI1NiBhbW91bnQpIGludGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGlmKG5vdyA8IHByZVNhbGVFbmQpIHsKICAgICAgICAgICAgcmVxdWlyZShhbW91bnQgPj0gNjc5NyBmaW5uZXkpOwoKICAgICAgICAgICAgaWYoYW1vdW50IDw9IDgxNTYgZmlubmV5KQogICAgICAgICAgICAgICAgcmV0dXJuIHJhdGUubXVsKDEwNSkuZGl2KDEwMCk7CiAgICAgICAgICAgIGlmKGFtb3VudCA8PSA5NTE1IGZpbm5leSkKICAgICAgICAgICAgICAgIHJldHVybiByYXRlLm11bCgxMDU1KS5kaXYoMTAwMCk7CiAgICAgICAgICAgIGlmKGFtb3VudCA8PSAxMDg3NCBmaW5uZXkpCiAgICAgICAgICAgICAgICByZXR1cm4gcmF0ZS5tdWwoMTA2NSkuZGl2KDEwMDApOwogICAgICAgICAgICBpZihhbW91bnQgPD0gMTIyMzQgZmlubmV5KQogICAgICAgICAgICAgICAgcmV0dXJuIHJhdGUubXVsKDEwOCkuZGl2KDEwMCk7CiAgICAgICAgICAgIGlmKGFtb3VudCA8PSAxMzU5MyBmaW5uZXkpCiAgICAgICAgICAgICAgICByZXR1cm4gcmF0ZS5tdWwoMTEwKS5kaXYoMTAwKTsKICAgICAgICAgICAgaWYoYW1vdW50IDw9IDI3MTg1IGZpbm5leSkKICAgICAgICAgICAgICAgIHJldHVybiByYXRlLm11bCgxMTMpLmRpdigxMDApOwogICAgICAgICAgICBpZihhbW91bnQgPiAyNzE4NSBmaW5uZXkpCiAgICAgICAgICAgICAgICByZXR1cm4gcmF0ZS5tdWwoMTIwKS5kaXYoMTAwKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByYXRlOwogICAgfQp9'.
	

]
