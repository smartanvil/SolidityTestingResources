Class {
	#name : #SRTd7f21117ea7f137e12d89b16adbf683f71d72c9c,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd7f21117ea7f137e12d89b16adbf683f71d72c9c >> base64 [
	^ 'LyogQXV0aG9yOiBWaWN0b3IgTWV6cmluICA8YSBocmVmPSIvY2RuLWNnaS9sL2VtYWlsLXByb3RlY3Rpb24iIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iNmUxODA3MGQxYTAxMWMyZTAzMGIxNDFjMDcwMDQwMGQwMTAzIj5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9hPiAqLwoKCnByYWdtYSBzb2xpZGl0eSBeMC40LjE4OwoKCgovKioKICogQHRpdGxlIFNhZmVNYXRoSW50ZXJmYWNlCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpjb250cmFjdCBTYWZlTWF0aEludGVyZmFjZSB7CiAgZnVuY3Rpb24gc2FmZU11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiBzYWZlRGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHNhZmVTdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gc2FmZUFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KTsKfQoKCgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpjb250cmFjdCBTYWZlTWF0aCBpcyBTYWZlTWF0aEludGVyZmFjZSB7CiAgZnVuY3Rpb24gc2FmZU11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHNhZmVEaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHNhZmVTdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCgoKLyoqCiAqIEB0aXRsZSBDb21tb25Nb2RpZmllcnNJbnRlcmZhY2UKICogQGRldiBCYXNlIGNvbnRyYWN0IHdoaWNoIGNvbnRhaW5zIGNvbW1vbiBjaGVja3MuCiAqLwpjb250cmFjdCBDb21tb25Nb2RpZmllcnNJbnRlcmZhY2UgewoKICAvKioKICAgKiBAZGV2IEFzc2VtYmxlIHRoZSBnaXZlbiBhZGRyZXNzIGJ5dGVjb2RlLiBJZiBieXRlY29kZSBleGlzdHMgdGhlbiB0aGUgX2FkZHIgaXMgYSBjb250cmFjdC4KICAgKi8KICBmdW5jdGlvbiBpc0NvbnRyYWN0KGFkZHJlc3MgX3RhcmdldEFkZHJlc3MpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wpOwoKICAvKioKICAgKiBAZGV2IG1vZGlmaWVyIHRvIGFsbG93IGFjdGlvbnMgb25seSB3aGVuIHRoZSBfdGFyZ2V0QWRkcmVzcyBpcyBhIGNvbnRyYWN0LgogICAqLwogIG1vZGlmaWVyIG9ubHlDb250cmFjdEFkZHJlc3MoYWRkcmVzcyBfdGFyZ2V0QWRkcmVzcykgewogICAgcmVxdWlyZShpc0NvbnRyYWN0KF90YXJnZXRBZGRyZXNzKSA9PSB0cnVlKTsKICAgIF87CiAgfQp9CgoKCi8qKgogKiBAdGl0bGUgQ29tbW9uTW9kaWZpZXJzCiAqIEBkZXYgQmFzZSBjb250cmFjdCB3aGljaCBjb250YWlucyBjb21tb24gY2hlY2tzLgogKi8KY29udHJhY3QgQ29tbW9uTW9kaWZpZXJzIGlzIENvbW1vbk1vZGlmaWVyc0ludGVyZmFjZSB7CgogIC8qKgogICAqIEBkZXYgQXNzZW1ibGUgdGhlIGdpdmVuIGFkZHJlc3MgYnl0ZWNvZGUuIElmIGJ5dGVjb2RlIGV4aXN0cyB0aGVuIHRoZSBfYWRkciBpcyBhIGNvbnRyYWN0LgogICAqLwogIGZ1bmN0aW9uIGlzQ29udHJhY3QoYWRkcmVzcyBfdGFyZ2V0QWRkcmVzcykgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZSAoX3RhcmdldEFkZHJlc3MgIT0gYWRkcmVzcygweDApKTsKCiAgICB1aW50MjU2IGxlbmd0aDsKICAgIGFzc2VtYmx5IHsKICAgICAgLy9yZXRyaWV2ZSB0aGUgc2l6ZSBvZiB0aGUgY29kZSBvbiB0YXJnZXQgYWRkcmVzcywgdGhpcyBuZWVkcyBhc3NlbWJseQogICAgICBsZW5ndGggOj0gZXh0Y29kZXNpemUoX3RhcmdldEFkZHJlc3MpCiAgICB9CiAgICByZXR1cm4gKGxlbmd0aCA+IDApOwogIH0KfQoKCgovKioKICogQHRpdGxlIEFzc2V0SURJbnRlcmZhY2UKICogQGRldiBJbnRlcmZhY2Ugb2YgYSBjb250cmFjdCB0aGF0IGFzc2lnbmVkIHRvIGFuIGFzc2V0IChKTlQsIGpVU0QgZXRjLikKICogQGRldiBDb250cmFjdHMgZm9yIHRoZSBzYW1lIGFzc2V0IChsaWtlIEpOVCwgalVTRCBldGMuKSB3aWxsIGhhdmUgdGhlIHNhbWUgQXNzZXRJRC4KICogQGRldiBUaGlzIHdpbGwgaGVscCB0byBhdm9pZCBtaXNjb25maWd1cmF0aW9uIG9mIGNvbnRyYWN0cwogKi8KY29udHJhY3QgQXNzZXRJREludGVyZmFjZSB7CiAgZnVuY3Rpb24gZ2V0QXNzZXRJRCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChzdHJpbmcpOwogIGZ1bmN0aW9uIGdldEFzc2V0SURIYXNoKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJ5dGVzMzIpOwp9CgoKCi8qKgogKiBAdGl0bGUgQXNzZXRJRAogKiBAZGV2IEJhc2UgY29udHJhY3QgaW1wbGVtZW50aW5nIEFzc2V0SURJbnRlcmZhY2UKICovCmNvbnRyYWN0IEFzc2V0SUQgaXMgQXNzZXRJREludGVyZmFjZSB7CgogIC8qIFN0b3JhZ2UgKi8KCiAgc3RyaW5nIGFzc2V0SUQ7CgoKICAvKiBDb25zdHJ1Y3RvciAqLwoKICBmdW5jdGlvbiBBc3NldElEKHN0cmluZyBfYXNzZXRJRCkgcHVibGljIHsKICAgIHJlcXVpcmUoYnl0ZXMoX2Fzc2V0SUQpLmxlbmd0aCA+IDApOwoKICAgIGFzc2V0SUQgPSBfYXNzZXRJRDsKICB9CgoKICAvKiBHZXR0ZXJzICovCgogIGZ1bmN0aW9uIGdldEFzc2V0SUQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoc3RyaW5nKSB7CiAgICByZXR1cm4gYXNzZXRJRDsKICB9CgogIGZ1bmN0aW9uIGdldEFzc2V0SURIYXNoKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJ5dGVzMzIpIHsKICAgIHJldHVybiBrZWNjYWsyNTYoYXNzZXRJRCk7CiAgfQp9CgoKLyoqCiAqIEB0aXRsZSBPd25hYmxlSW50ZXJmYWNlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGVJbnRlcmZhY2UgewoKICAvKioKICAgKiBAZGV2IFRoZSBnZXR0ZXIgZm9yICJvd25lciIgY29udHJhY3QgdmFyaWFibGUKICAgKi8KICBmdW5jdGlvbiBnZXRPd25lcigpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzKTsKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIGN1cnJlbnQgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZSAobXNnLnNlbmRlciA9PSBnZXRPd25lcigpKTsKICAgIF87CiAgfQp9CgoKCi8qKgogKiBAdGl0bGUgT3duYWJsZQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuCiAqLwpjb250cmFjdCBPd25hYmxlIGlzIE93bmFibGVJbnRlcmZhY2UgewoKICAvKiBTdG9yYWdlICovCgogIGFkZHJlc3Mgb3duZXIgPSBhZGRyZXNzKDB4MCk7CiAgYWRkcmVzcyBwcm9wb3NlZE93bmVyID0gYWRkcmVzcygweDApOwoKCiAgLyogRXZlbnRzICovCgogIGV2ZW50IE93bmVyQXNzaWduZWRFdmVudChhZGRyZXNzIGluZGV4ZWQgbmV3b3duZXIpOwogIGV2ZW50IE93bmVyc2hpcE9mZmVyQ3JlYXRlZEV2ZW50KGFkZHJlc3MgaW5kZXhlZCBjdXJyZW50b3duZXIsIGFkZHJlc3MgaW5kZXhlZCBwcm9wb3NlZG93bmVyKTsKICBldmVudCBPd25lcnNoaXBPZmZlckFjY2VwdGVkRXZlbnQoYWRkcmVzcyBpbmRleGVkIGN1cnJlbnRvd25lciwgYWRkcmVzcyBpbmRleGVkIHByb3Bvc2Vkb3duZXIpOwogIGV2ZW50IE93bmVyc2hpcE9mZmVyQ2FuY2VsbGVkRXZlbnQoYWRkcmVzcyBpbmRleGVkIGN1cnJlbnRvd25lciwgYWRkcmVzcyBpbmRleGVkIHByb3Bvc2Vkb3duZXIpOwoKCiAgLyoqCiAgICogQGRldiBUaGUgY29uc3RydWN0b3Igc2V0cyB0aGUgaW5pdGlhbCBgb3duZXJgIHRvIHRoZSBwYXNzZWQgYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKCiAgICBPd25lckFzc2lnbmVkRXZlbnQob3duZXIpOwogIH0KCgogIC8qKgogICAqIEBkZXYgT2xkIG93bmVyIHJlcXVlc3RzIHRyYW5zZmVyIG93bmVyc2hpcCB0byB0aGUgbmV3IG93bmVyLgogICAqIEBwYXJhbSBfcHJvcG9zZWRPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gY3JlYXRlT3duZXJzaGlwT2ZmZXIoYWRkcmVzcyBfcHJvcG9zZWRPd25lcikgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIHJlcXVpcmUgKHByb3Bvc2VkT3duZXIgPT0gYWRkcmVzcygweDApKTsKICAgIHJlcXVpcmUgKF9wcm9wb3NlZE93bmVyICE9IGFkZHJlc3MoMHgwKSk7CiAgICByZXF1aXJlIChfcHJvcG9zZWRPd25lciAhPSBhZGRyZXNzKHRoaXMpKTsKCiAgICBwcm9wb3NlZE93bmVyID0gX3Byb3Bvc2VkT3duZXI7CgogICAgT3duZXJzaGlwT2ZmZXJDcmVhdGVkRXZlbnQob3duZXIsIF9wcm9wb3NlZE93bmVyKTsKICB9CgoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgbmV3IG93bmVyIHRvIGFjY2VwdCBhbiBvd25lcnNoaXAgb2ZmZXIgdG8gY29udHJhY3QgY29udHJvbC4KICAgKi8KICAvL25vaW5zcGVjdGlvbiBVbnByb3RlY3RlZEZ1bmN0aW9uCiAgZnVuY3Rpb24gYWNjZXB0T3duZXJzaGlwT2ZmZXIoKSBleHRlcm5hbCB7CiAgICByZXF1aXJlIChwcm9wb3NlZE93bmVyICE9IGFkZHJlc3MoMHgwKSk7CiAgICByZXF1aXJlIChtc2cuc2VuZGVyID09IHByb3Bvc2VkT3duZXIpOwoKICAgIGFkZHJlc3MgX29sZE93bmVyID0gb3duZXI7CiAgICBvd25lciA9IHByb3Bvc2VkT3duZXI7CiAgICBwcm9wb3NlZE93bmVyID0gYWRkcmVzcygweDApOwoKICAgIE93bmVyQXNzaWduZWRFdmVudChvd25lcik7CiAgICBPd25lcnNoaXBPZmZlckFjY2VwdGVkRXZlbnQoX29sZE93bmVyLCBvd25lcik7CiAgfQoKCiAgLyoqCiAgICogQGRldiBPbGQgb3duZXIgY2FuY2VscyB0cmFuc2ZlciBvd25lcnNoaXAgdG8gdGhlIG5ldyBvd25lci4KICAgKi8KICBmdW5jdGlvbiBjYW5jZWxPd25lcnNoaXBPZmZlcigpIGV4dGVybmFsIHsKICAgIHJlcXVpcmUgKHByb3Bvc2VkT3duZXIgIT0gYWRkcmVzcygweDApKTsKICAgIHJlcXVpcmUgKG1zZy5zZW5kZXIgPT0gb3duZXIgfHwgbXNnLnNlbmRlciA9PSBwcm9wb3NlZE93bmVyKTsKCiAgICBhZGRyZXNzIF9vbGRQcm9wb3NlZE93bmVyID0gcHJvcG9zZWRPd25lcjsKICAgIHByb3Bvc2VkT3duZXIgPSBhZGRyZXNzKDB4MCk7CgogICAgT3duZXJzaGlwT2ZmZXJDYW5jZWxsZWRFdmVudChvd25lciwgX29sZFByb3Bvc2VkT3duZXIpOwogIH0KCgogIC8qKgogICAqIEBkZXYgVGhlIGdldHRlciBmb3IgIm93bmVyIiBjb250cmFjdCB2YXJpYWJsZQogICAqLwogIGZ1bmN0aW9uIGdldE93bmVyKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MpIHsKICAgIHJldHVybiBvd25lcjsKICB9CgogIC8qKgogICAqIEBkZXYgVGhlIGdldHRlciBmb3IgInByb3Bvc2VkT3duZXIiIGNvbnRyYWN0IHZhcmlhYmxlCiAgICovCiAgZnVuY3Rpb24gZ2V0UHJvcG9zZWRPd25lcigpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzKSB7CiAgICByZXR1cm4gcHJvcG9zZWRPd25lcjsKICB9Cn0KCgoKLyoqCiAqIEB0aXRsZSBNYW5hZ2VhYmxlSW50ZXJmYWNlCiAqIEBkZXYgQ29udHJhY3QgdGhhdCBhbGxvd3MgdG8gZ3JhbnQgcGVybWlzc2lvbnMgdG8gYW55IGFkZHJlc3MKICogQGRldiBJbiByZWFsIGxpZmUgd2UgYXJlIG5vIGFibGUgdG8gcGVyZm9ybSBhbGwgYWN0aW9ucyB3aXRoIGp1c3Qgb25lIEV0aGVyZXVtIGFkZHJlc3MKICogQGRldiBiZWNhdXNlIHJpc2tzIGFyZSB0b28gaGlnaC4KICogQGRldiBJbnN0ZWFkIG93bmVyIGRlbGVnYXRlcyByaWdodHMgdG8gbWFuYWdlIGFuIGNvbnRyYWN0IHRvIHRoZSBkaWZmZXJlbnQgYWRkcmVzc2VzIGFuZAogKiBAZGV2IHN0YXkgYWJsZSB0byByZXZva2UgcGVybWlzc2lvbnMgYXQgYW55IHRpbWUuCiAqLwpjb250cmFjdCBNYW5hZ2VhYmxlSW50ZXJmYWNlIHsKCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayBpZiB0aGUgbWFuYWdlciBjYW4gcGVyZm9ybSB0aGUgYWN0aW9uIG9yIG5vdAogICAqIEBwYXJhbSBfbWFuYWdlciAgICAgICAgYWRkcmVzcyBNYW5hZ2VyYHMgYWRkcmVzcwogICAqIEBwYXJhbSBfcGVybWlzc2lvbk5hbWUgc3RyaW5nICBQZXJtaXNzaW9uIG5hbWUKICAgKiBAcmV0dXJuIFRydWUgaWYgbWFuYWdlciBpcyBlbmFibGVkIGFuZCBoYXMgYmVlbiBncmFudGVkIG5lZWRlZCBwZXJtaXNzaW9uCiAgICovCiAgZnVuY3Rpb24gaXNNYW5hZ2VyQWxsb3dlZChhZGRyZXNzIF9tYW5hZ2VyLCBzdHJpbmcgX3Blcm1pc3Npb25OYW1lKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCk7CgogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdG8gdXNlIGluIGRlcml2ZWQgY29udHJhY3RzCiAgICovCiAgbW9kaWZpZXIgb25seUFsbG93ZWRNYW5hZ2VyKHN0cmluZyBfcGVybWlzc2lvbk5hbWUpIHsKICAgIHJlcXVpcmUoaXNNYW5hZ2VyQWxsb3dlZChtc2cuc2VuZGVyLCBfcGVybWlzc2lvbk5hbWUpID09IHRydWUpOwogICAgXzsKICB9Cn0KCgoKY29udHJhY3QgTWFuYWdlYWJsZSBpcyBPd25hYmxlSW50ZXJmYWNlLAogICAgICAgICAgICAgICAgICAgICAgIE1hbmFnZWFibGVJbnRlcmZhY2UgewoKICAvKiBTdG9yYWdlICovCgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgbWFuYWdlckVuYWJsZWQ7ICAvLyBoYXJkIHN3aXRjaCBmb3IgYSBtYW5hZ2VyIC0gb24vb2ZmCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChzdHJpbmcgPT4gYm9vbCkpIG1hbmFnZXJQZXJtaXNzaW9uczsgIC8vIGRldGFpbGVkIGluZm8gYWJvdXQgbWFuYWdlcmBzIHBlcm1pc3Npb25zCgoKICAvKiBFdmVudHMgKi8KCiAgZXZlbnQgTWFuYWdlckVuYWJsZWRFdmVudChhZGRyZXNzIGluZGV4ZWQgbWFuYWdlcik7CiAgZXZlbnQgTWFuYWdlckRpc2FibGVkRXZlbnQoYWRkcmVzcyBpbmRleGVkIG1hbmFnZXIpOwogIGV2ZW50IE1hbmFnZXJQZXJtaXNzaW9uR3JhbnRlZEV2ZW50KGFkZHJlc3MgaW5kZXhlZCBtYW5hZ2VyLCBzdHJpbmcgcGVybWlzc2lvbik7CiAgZXZlbnQgTWFuYWdlclBlcm1pc3Npb25SZXZva2VkRXZlbnQoYWRkcmVzcyBpbmRleGVkIG1hbmFnZXIsIHN0cmluZyBwZXJtaXNzaW9uKTsKCgogIC8qIENvbmZpZ3VyZSBjb250cmFjdCAqLwoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGFkZCBuZXcgbWFuYWdlcgogICAqIEBwYXJhbSBfbWFuYWdlciBhZGRyZXNzIE5ldyBtYW5hZ2VyCiAgICovCiAgZnVuY3Rpb24gZW5hYmxlTWFuYWdlcihhZGRyZXNzIF9tYW5hZ2VyKSBleHRlcm5hbCBvbmx5T3duZXIgb25seVZhbGlkTWFuYWdlckFkZHJlc3MoX21hbmFnZXIpIHsKICAgIHJlcXVpcmUobWFuYWdlckVuYWJsZWRbX21hbmFnZXJdID09IGZhbHNlKTsKCiAgICBtYW5hZ2VyRW5hYmxlZFtfbWFuYWdlcl0gPSB0cnVlOwogICAgTWFuYWdlckVuYWJsZWRFdmVudChfbWFuYWdlcik7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHJlbW92ZSBleGlzdGluZyBtYW5hZ2VyCiAgICogQHBhcmFtIF9tYW5hZ2VyIGFkZHJlc3MgRXhpc3RpbmcgbWFuYWdlcgogICAqLwogIGZ1bmN0aW9uIGRpc2FibGVNYW5hZ2VyKGFkZHJlc3MgX21hbmFnZXIpIGV4dGVybmFsIG9ubHlPd25lciBvbmx5VmFsaWRNYW5hZ2VyQWRkcmVzcyhfbWFuYWdlcikgewogICAgcmVxdWlyZShtYW5hZ2VyRW5hYmxlZFtfbWFuYWdlcl0gPT0gdHJ1ZSk7CgogICAgbWFuYWdlckVuYWJsZWRbX21hbmFnZXJdID0gZmFsc2U7CiAgICBNYW5hZ2VyRGlzYWJsZWRFdmVudChfbWFuYWdlcik7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGdyYW50IG5ldyBwZXJtaXNzaW9uIHRvIHRoZSBtYW5hZ2VyCiAgICogQHBhcmFtIF9tYW5hZ2VyICAgICAgICBhZGRyZXNzIEV4aXN0aW5nIG1hbmFnZXIKICAgKiBAcGFyYW0gX3Blcm1pc3Npb25OYW1lIHN0cmluZyAgR3JhbnRlZCBwZXJtaXNzaW9uIG5hbWUKICAgKi8KICBmdW5jdGlvbiBncmFudE1hbmFnZXJQZXJtaXNzaW9uKAogICAgYWRkcmVzcyBfbWFuYWdlciwgc3RyaW5nIF9wZXJtaXNzaW9uTmFtZQogICkKICAgIGV4dGVybmFsCiAgICBvbmx5T3duZXIKICAgIG9ubHlWYWxpZE1hbmFnZXJBZGRyZXNzKF9tYW5hZ2VyKQogICAgb25seVZhbGlkUGVybWlzc2lvbk5hbWUoX3Blcm1pc3Npb25OYW1lKQogIHsKICAgIHJlcXVpcmUobWFuYWdlclBlcm1pc3Npb25zW19tYW5hZ2VyXVtfcGVybWlzc2lvbk5hbWVdID09IGZhbHNlKTsKCiAgICBtYW5hZ2VyUGVybWlzc2lvbnNbX21hbmFnZXJdW19wZXJtaXNzaW9uTmFtZV0gPSB0cnVlOwogICAgTWFuYWdlclBlcm1pc3Npb25HcmFudGVkRXZlbnQoX21hbmFnZXIsIF9wZXJtaXNzaW9uTmFtZSk7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHJldm9rZSBwZXJtaXNzaW9uIG9mIHRoZSBtYW5hZ2VyCiAgICogQHBhcmFtIF9tYW5hZ2VyICAgICAgICBhZGRyZXNzIEV4aXN0aW5nIG1hbmFnZXIKICAgKiBAcGFyYW0gX3Blcm1pc3Npb25OYW1lIHN0cmluZyAgUmV2b2tlZCBwZXJtaXNzaW9uIG5hbWUKICAgKi8KICBmdW5jdGlvbiByZXZva2VNYW5hZ2VyUGVybWlzc2lvbigKICAgIGFkZHJlc3MgX21hbmFnZXIsIHN0cmluZyBfcGVybWlzc2lvbk5hbWUKICApCiAgICBleHRlcm5hbAogICAgb25seU93bmVyCiAgICBvbmx5VmFsaWRNYW5hZ2VyQWRkcmVzcyhfbWFuYWdlcikKICAgIG9ubHlWYWxpZFBlcm1pc3Npb25OYW1lKF9wZXJtaXNzaW9uTmFtZSkKICB7CiAgICByZXF1aXJlKG1hbmFnZXJQZXJtaXNzaW9uc1tfbWFuYWdlcl1bX3Blcm1pc3Npb25OYW1lXSA9PSB0cnVlKTsKCiAgICBtYW5hZ2VyUGVybWlzc2lvbnNbX21hbmFnZXJdW19wZXJtaXNzaW9uTmFtZV0gPSBmYWxzZTsKICAgIE1hbmFnZXJQZXJtaXNzaW9uUmV2b2tlZEV2ZW50KF9tYW5hZ2VyLCBfcGVybWlzc2lvbk5hbWUpOwogIH0KCgogIC8qIEdldHRlcnMgKi8KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayBtYW5hZ2VyIHN0YXR1cwogICAqIEBwYXJhbSBfbWFuYWdlciBhZGRyZXNzIE1hbmFnZXJgcyBhZGRyZXNzCiAgICogQHJldHVybiBUcnVlIGlmIG1hbmFnZXIgaXMgZW5hYmxlZAogICAqLwogIGZ1bmN0aW9uIGlzTWFuYWdlckVuYWJsZWQoCiAgICBhZGRyZXNzIF9tYW5hZ2VyCiAgKQogICAgcHVibGljCiAgICBjb25zdGFudAogICAgb25seVZhbGlkTWFuYWdlckFkZHJlc3MoX21hbmFnZXIpCiAgICByZXR1cm5zIChib29sKQogIHsKICAgIHJldHVybiBtYW5hZ2VyRW5hYmxlZFtfbWFuYWdlcl07CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHBlcm1pc3Npb25zIG9mIGEgbWFuYWdlcgogICAqIEBwYXJhbSBfbWFuYWdlciAgICAgICAgYWRkcmVzcyBNYW5hZ2VyYHMgYWRkcmVzcwogICAqIEBwYXJhbSBfcGVybWlzc2lvbk5hbWUgc3RyaW5nICBQZXJtaXNzaW9uIG5hbWUKICAgKiBAcmV0dXJuIFRydWUgaWYgbWFuYWdlciBoYXMgYmVlbiBncmFudGVkIG5lZWRlZCBwZXJtaXNzaW9uCiAgICovCiAgZnVuY3Rpb24gaXNQZXJtaXNzaW9uR3JhbnRlZCgKICAgIGFkZHJlc3MgX21hbmFnZXIsIHN0cmluZyBfcGVybWlzc2lvbk5hbWUKICApCiAgICBwdWJsaWMKICAgIGNvbnN0YW50CiAgICBvbmx5VmFsaWRNYW5hZ2VyQWRkcmVzcyhfbWFuYWdlcikKICAgIG9ubHlWYWxpZFBlcm1pc3Npb25OYW1lKF9wZXJtaXNzaW9uTmFtZSkKICAgIHJldHVybnMgKGJvb2wpCiAgewogICAgcmV0dXJuIG1hbmFnZXJQZXJtaXNzaW9uc1tfbWFuYWdlcl1bX3Blcm1pc3Npb25OYW1lXTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgaWYgdGhlIG1hbmFnZXIgY2FuIHBlcmZvcm0gdGhlIGFjdGlvbiBvciBub3QKICAgKiBAcGFyYW0gX21hbmFnZXIgICAgICAgIGFkZHJlc3MgTWFuYWdlcmBzIGFkZHJlc3MKICAgKiBAcGFyYW0gX3Blcm1pc3Npb25OYW1lIHN0cmluZyAgUGVybWlzc2lvbiBuYW1lCiAgICogQHJldHVybiBUcnVlIGlmIG1hbmFnZXIgaXMgZW5hYmxlZCBhbmQgaGFzIGJlZW4gZ3JhbnRlZCBuZWVkZWQgcGVybWlzc2lvbgogICAqLwogIGZ1bmN0aW9uIGlzTWFuYWdlckFsbG93ZWQoCiAgICBhZGRyZXNzIF9tYW5hZ2VyLCBzdHJpbmcgX3Blcm1pc3Npb25OYW1lCiAgKQogICAgcHVibGljCiAgICBjb25zdGFudAogICAgb25seVZhbGlkTWFuYWdlckFkZHJlc3MoX21hbmFnZXIpCiAgICBvbmx5VmFsaWRQZXJtaXNzaW9uTmFtZShfcGVybWlzc2lvbk5hbWUpCiAgICByZXR1cm5zIChib29sKQogIHsKICAgIHJldHVybiAobWFuYWdlckVuYWJsZWRbX21hbmFnZXJdICYmIG1hbmFnZXJQZXJtaXNzaW9uc1tfbWFuYWdlcl1bX3Blcm1pc3Npb25OYW1lXSk7CiAgfQoKCiAgLyogSGVscGVycyAqLwoKICAvKioKICAgKiBAZGV2IE1vZGlmaWVyIHRvIGNoZWNrIG1hbmFnZXIgYWRkcmVzcwogICAqLwogIG1vZGlmaWVyIG9ubHlWYWxpZE1hbmFnZXJBZGRyZXNzKGFkZHJlc3MgX21hbmFnZXIpIHsKICAgIHJlcXVpcmUoX21hbmFnZXIgIT0gYWRkcmVzcygweDApKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IE1vZGlmaWVyIHRvIGNoZWNrIG5hbWUgb2YgbWFuYWdlciBwZXJtaXNzaW9uCiAgICovCiAgbW9kaWZpZXIgb25seVZhbGlkUGVybWlzc2lvbk5hbWUoc3RyaW5nIF9wZXJtaXNzaW9uTmFtZSkgewogICAgcmVxdWlyZShieXRlcyhfcGVybWlzc2lvbk5hbWUpLmxlbmd0aCAhPSAwKTsKICAgIF87CiAgfQp9CgoKCi8qKgogKiBAdGl0bGUgUGF1c2FibGVJbnRlcmZhY2UKICogQGRldiBCYXNlIGNvbnRyYWN0IHdoaWNoIGFsbG93cyBjaGlsZHJlbiB0byBpbXBsZW1lbnQgYW4gZW1lcmdlbmN5IHN0b3AgbWVjaGFuaXNtLgogKiBAZGV2IEJhc2VkIG9uIHplcHBlbGluJ3MgUGF1c2FibGUsIGJ1dCBpbnRlZ3JhdGVkIHdpdGggTWFuYWdlYWJsZQogKiBAZGV2IENvbnRyYWN0IGlzIGluIHBhdXNlZCBzdGF0ZSBieSBkZWZhdWx0IGFuZCBzaG91bGQgYmUgZXhwbGljaXRseSB1bmxvY2tlZAogKi8KY29udHJhY3QgUGF1c2FibGVJbnRlcmZhY2UgewoKICAvKioKICAgKiBFdmVudHMKICAgKi8KCiAgZXZlbnQgUGF1c2VFdmVudCgpOwogIGV2ZW50IFVucGF1c2VFdmVudCgpOwoKCiAgLyoqCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG1hbmFnZXIgdG8gcGF1c2UsIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUKICAgKi8KICBmdW5jdGlvbiBwYXVzZUNvbnRyYWN0KCkgcHVibGljOwoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgbWFuYWdlciB0byB1bnBhdXNlLCByZXR1cm5zIHRvIG5vcm1hbCBzdGF0ZQogICAqLwogIGZ1bmN0aW9uIHVucGF1c2VDb250cmFjdCgpIHB1YmxpYzsKCiAgLyoqCiAgICogQGRldiBUaGUgZ2V0dGVyIGZvciAicGF1c2VkIiBjb250cmFjdCB2YXJpYWJsZQogICAqLwogIGZ1bmN0aW9uIGdldFBhdXNlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKTsKCgogIC8qKgogICAqIEBkZXYgbW9kaWZpZXIgdG8gYWxsb3cgYWN0aW9ucyBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IElTIHBhdXNlZAogICAqLwogIG1vZGlmaWVyIHdoZW5Db250cmFjdE5vdFBhdXNlZCgpIHsKICAgIHJlcXVpcmUoZ2V0UGF1c2VkKCkgPT0gZmFsc2UpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgbW9kaWZpZXIgdG8gYWxsb3cgYWN0aW9ucyBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IElTIE5PVCBwYXVzZWQKICAgKi8KICBtb2RpZmllciB3aGVuQ29udHJhY3RQYXVzZWQgewogICAgcmVxdWlyZShnZXRQYXVzZWQoKSA9PSB0cnVlKTsKICAgIF87CiAgfQp9CgoKCi8qKgogKiBAdGl0bGUgUGF1c2FibGUKICogQGRldiBCYXNlIGNvbnRyYWN0IHdoaWNoIGFsbG93cyBjaGlsZHJlbiB0byBpbXBsZW1lbnQgYW4gZW1lcmdlbmN5IHN0b3AgbWVjaGFuaXNtLgogKiBAZGV2IEJhc2VkIG9uIHplcHBlbGluJ3MgUGF1c2FibGUsIGJ1dCBpbnRlZ3JhdGVkIHdpdGggTWFuYWdlYWJsZQogKiBAZGV2IENvbnRyYWN0IGlzIGluIHBhdXNlZCBzdGF0ZSBieSBkZWZhdWx0IGFuZCBzaG91bGQgYmUgZXhwbGljaXRseSB1bmxvY2tlZAogKi8KY29udHJhY3QgUGF1c2FibGUgaXMgTWFuYWdlYWJsZUludGVyZmFjZSwKICAgICAgICAgICAgICAgICAgICAgUGF1c2FibGVJbnRlcmZhY2UgewoKICAvKioKICAgKiBTdG9yYWdlCiAgICovCgogIGJvb2wgcGF1c2VkID0gdHJ1ZTsKCgogIC8qKgogICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBtYW5hZ2VyIHRvIHBhdXNlLCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlCiAgICovCiAgZnVuY3Rpb24gcGF1c2VDb250cmFjdCgpIHB1YmxpYyBvbmx5QWxsb3dlZE1hbmFnZXIoJ3BhdXNlX2NvbnRyYWN0Jykgd2hlbkNvbnRyYWN0Tm90UGF1c2VkIHsKICAgIHBhdXNlZCA9IHRydWU7CiAgICBQYXVzZUV2ZW50KCk7CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgbWFuYWdlciB0byB1bnBhdXNlLCByZXR1cm5zIHRvIG5vcm1hbCBzdGF0ZQogICAqLwogIGZ1bmN0aW9uIHVucGF1c2VDb250cmFjdCgpIHB1YmxpYyBvbmx5QWxsb3dlZE1hbmFnZXIoJ3VucGF1c2VfY29udHJhY3QnKSB3aGVuQ29udHJhY3RQYXVzZWQgewogICAgcGF1c2VkID0gZmFsc2U7CiAgICBVbnBhdXNlRXZlbnQoKTsKICB9CgogIC8qKgogICAqIEBkZXYgVGhlIGdldHRlciBmb3IgInBhdXNlZCIgY29udHJhY3QgdmFyaWFibGUKICAgKi8KICBmdW5jdGlvbiBnZXRQYXVzZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHBhdXNlZDsKICB9Cn0KCgoKLyoqCiAqIEB0aXRsZSBCeXRlY29kZUV4ZWN1dG9ySW50ZXJmYWNlIGludGVyZmFjZQogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIGEgY29udHJhY3QgdGhhdCBleGVjdXRlIGFueSBieXRlY29kZSBvbiBiZWhhbGYgb2YgdGhlIGNvbnRyYWN0CiAqIEBkZXYgTGFzdCByZXNvcnQgZm9yIHRoZSBpbW11dGFibGUgYW5kIG5vdC1yZXBsYWNlYWJsZSBjb250cmFjdCA6KQogKi8KY29udHJhY3QgQnl0ZWNvZGVFeGVjdXRvckludGVyZmFjZSB7CgogIC8qIEV2ZW50cyAqLwoKICBldmVudCBDYWxsRXhlY3V0ZWRFdmVudChhZGRyZXNzIGluZGV4ZWQgdGFyZ2V0LAogICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQyNTYgc3VwcGxpZWRHYXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDI1NiBldGhWYWx1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBieXRlczMyIHRyYW5zYWN0aW9uQnl0ZWNvZGVIYXNoKTsKICBldmVudCBEZWxlZ2F0ZWNhbGxFeGVjdXRlZEV2ZW50KGFkZHJlc3MgaW5kZXhlZCB0YXJnZXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MjU2IHN1cHBsaWVkR2FzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnl0ZXMzMiB0cmFuc2FjdGlvbkJ5dGVjb2RlSGFzaCk7CgoKICAvKiBGdW5jdGlvbnMgKi8KCiAgZnVuY3Rpb24gZXhlY3V0ZUNhbGwoYWRkcmVzcyBfdGFyZ2V0LCB1aW50MjU2IF9zdXBwbGllZEdhcywgdWludDI1NiBfZXRoVmFsdWUsIGJ5dGVzIF90cmFuc2FjdGlvbkJ5dGVjb2RlKSBleHRlcm5hbDsKICBmdW5jdGlvbiBleGVjdXRlRGVsZWdhdGVjYWxsKGFkZHJlc3MgX3RhcmdldCwgdWludDI1NiBfc3VwcGxpZWRHYXMsIGJ5dGVzIF90cmFuc2FjdGlvbkJ5dGVjb2RlKSBleHRlcm5hbDsKfQoKCgovKioKICogQHRpdGxlIEJ5dGVjb2RlRXhlY3V0b3IKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiBhIGNvbnRyYWN0IHRoYXQgZXhlY3V0ZSBhbnkgYnl0ZWNvZGUgb24gYmVoYWxmIG9mIHRoZSBjb250cmFjdAogKiBAZGV2IExhc3QgcmVzb3J0IGZvciB0aGUgaW1tdXRhYmxlIGFuZCBub3QtcmVwbGFjZWFibGUgY29udHJhY3QgOikKICovCmNvbnRyYWN0IEJ5dGVjb2RlRXhlY3V0b3IgaXMgTWFuYWdlYWJsZUludGVyZmFjZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCeXRlY29kZUV4ZWN1dG9ySW50ZXJmYWNlIHsKCiAgLyogU3RvcmFnZSAqLwoKICBib29sIHVuZGVyRXhlY3V0aW9uID0gZmFsc2U7CgoKICAvKiBCeXRlY29kZUV4ZWN1dG9ySW50ZXJmYWNlICovCgogIGZ1bmN0aW9uIGV4ZWN1dGVDYWxsKAogICAgYWRkcmVzcyBfdGFyZ2V0LAogICAgdWludDI1NiBfc3VwcGxpZWRHYXMsCiAgICB1aW50MjU2IF9ldGhWYWx1ZSwKICAgIGJ5dGVzIF90cmFuc2FjdGlvbkJ5dGVjb2RlCiAgKQogICAgZXh0ZXJuYWwKICAgIG9ubHlBbGxvd2VkTWFuYWdlcignZXhlY3V0ZV9jYWxsJykKICB7CiAgICByZXF1aXJlKHVuZGVyRXhlY3V0aW9uID09IGZhbHNlKTsKCiAgICB1bmRlckV4ZWN1dGlvbiA9IHRydWU7IC8vIEF2b2lkIHJlY3Vyc2l2ZSBjYWxsaW5nCiAgICBfdGFyZ2V0LmNhbGwuZ2FzKF9zdXBwbGllZEdhcykudmFsdWUoX2V0aFZhbHVlKShfdHJhbnNhY3Rpb25CeXRlY29kZSk7CiAgICB1bmRlckV4ZWN1dGlvbiA9IGZhbHNlOwoKICAgIENhbGxFeGVjdXRlZEV2ZW50KF90YXJnZXQsIF9zdXBwbGllZEdhcywgX2V0aFZhbHVlLCBrZWNjYWsyNTYoX3RyYW5zYWN0aW9uQnl0ZWNvZGUpKTsKICB9CgogIGZ1bmN0aW9uIGV4ZWN1dGVEZWxlZ2F0ZWNhbGwoCiAgICBhZGRyZXNzIF90YXJnZXQsCiAgICB1aW50MjU2IF9zdXBwbGllZEdhcywKICAgIGJ5dGVzIF90cmFuc2FjdGlvbkJ5dGVjb2RlCiAgKQogICAgZXh0ZXJuYWwKICAgIG9ubHlBbGxvd2VkTWFuYWdlcignZXhlY3V0ZV9kZWxlZ2F0ZWNhbGwnKQogIHsKICAgIHJlcXVpcmUodW5kZXJFeGVjdXRpb24gPT0gZmFsc2UpOwoKICAgIHVuZGVyRXhlY3V0aW9uID0gdHJ1ZTsgLy8gQXZvaWQgcmVjdXJzaXZlIGNhbGxpbmcKICAgIF90YXJnZXQuZGVsZWdhdGVjYWxsLmdhcyhfc3VwcGxpZWRHYXMpKF90cmFuc2FjdGlvbkJ5dGVjb2RlKTsKICAgIHVuZGVyRXhlY3V0aW9uID0gZmFsc2U7CgogICAgRGVsZWdhdGVjYWxsRXhlY3V0ZWRFdmVudChfdGFyZ2V0LCBfc3VwcGxpZWRHYXMsIGtlY2NhazI1NihfdHJhbnNhY3Rpb25CeXRlY29kZSkpOwogIH0KfQoKCgovKioKICogQHRpdGxlIENyeWRyU3RvcmFnZUJhc2VJbnRlcmZhY2UgaW50ZXJmYWNlCiAqIEBkZXYgSW50ZXJmYWNlIG9mIGEgY29udHJhY3QgdGhhdCBtYW5hZ2VzIGJhbGFuY2Ugb2YgYW4gQ3J5RFIKICovCmNvbnRyYWN0IENyeWRyU3RvcmFnZUJhc2VJbnRlcmZhY2UgewoKICAvKiBFdmVudHMgKi8KCiAgZXZlbnQgQ3J5ZHJDb250cm9sbGVyQ2hhbmdlZEV2ZW50KGFkZHJlc3MgaW5kZXhlZCBjcnlkcmNvbnRyb2xsZXIpOwoKCiAgLyogQ29uZmlndXJhdGlvbiAqLwoKICBmdW5jdGlvbiBzZXRDcnlkckNvbnRyb2xsZXIoYWRkcmVzcyBfbmV3Q29udHJvbGxlcikgcHVibGljOwogIGZ1bmN0aW9uIGdldENyeWRyQ29udHJvbGxlcigpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzKTsKfQoKCgovKioKICogQHRpdGxlIENyeWRyU3RvcmFnZUJhc2UKICovCmNvbnRyYWN0IENyeWRyU3RvcmFnZUJhc2UgaXMgQ29tbW9uTW9kaWZpZXJzSW50ZXJmYWNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFzc2V0SURJbnRlcmZhY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWFuYWdlYWJsZUludGVyZmFjZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYXVzYWJsZUludGVyZmFjZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDcnlkclN0b3JhZ2VCYXNlSW50ZXJmYWNlIHsKCiAgLyogU3RvcmFnZSAqLwoKICBhZGRyZXNzIGNyeWRyQ29udHJvbGxlciA9IGFkZHJlc3MoMHgwKTsKCgogIC8qIENyeWRyU3RvcmFnZUJhc2VJbnRlcmZhY2UgKi8KCiAgLyogQ29uZmlndXJhdGlvbiAqLwoKICBmdW5jdGlvbiBzZXRDcnlkckNvbnRyb2xsZXIoCiAgICBhZGRyZXNzIF9jcnlkckNvbnRyb2xsZXIKICApCiAgICBwdWJsaWMKICAgIHdoZW5Db250cmFjdFBhdXNlZAogICAgb25seUNvbnRyYWN0QWRkcmVzcyhfY3J5ZHJDb250cm9sbGVyKQogICAgb25seUFsbG93ZWRNYW5hZ2VyKCdzZXRfY3J5ZHJfY29udHJvbGxlcicpCiAgewogICAgcmVxdWlyZShfY3J5ZHJDb250cm9sbGVyICE9IGFkZHJlc3MoY3J5ZHJDb250cm9sbGVyKSk7CiAgICByZXF1aXJlKF9jcnlkckNvbnRyb2xsZXIgIT0gYWRkcmVzcyh0aGlzKSk7CgogICAgY3J5ZHJDb250cm9sbGVyID0gX2NyeWRyQ29udHJvbGxlcjsKICAgIENyeWRyQ29udHJvbGxlckNoYW5nZWRFdmVudChfY3J5ZHJDb250cm9sbGVyKTsKICB9CgogIGZ1bmN0aW9uIGdldENyeWRyQ29udHJvbGxlcigpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzKSB7CiAgICByZXR1cm4gYWRkcmVzcyhjcnlkckNvbnRyb2xsZXIpOwogIH0KCgogIC8qIFBhdXNhYmxlSW50ZXJmYWNlICovCgogIC8qKgogICAqIEBkZXYgT3ZlcnJpZGUgbWV0aG9kIHRvIGVuc3VyZSB0aGF0IGNvbnRyYWN0IHByb3Blcmx5IGNvbmZpZ3VyZWQgYmVmb3JlIGl0IGlzIHVucGF1c2VkCiAgICovCiAgZnVuY3Rpb24gdW5wYXVzZUNvbnRyYWN0KCkgcHVibGljIHsKICAgIHJlcXVpcmUoaXNDb250cmFjdChjcnlkckNvbnRyb2xsZXIpID09IHRydWUpOwogICAgcmVxdWlyZShnZXRBc3NldElESGFzaCgpID09IEFzc2V0SURJbnRlcmZhY2UoY3J5ZHJDb250cm9sbGVyKS5nZXRBc3NldElESGFzaCgpKTsKCiAgICBzdXBlci51bnBhdXNlQ29udHJhY3QoKTsKICB9Cn0KCgoKLyoqCiAqIEB0aXRsZSBDcnlkclN0b3JhZ2VCbG9ja3NJbnRlcmZhY2UgaW50ZXJmYWNlCiAqIEBkZXYgSW50ZXJmYWNlIG9mIGEgY29udHJhY3QgdGhhdCBtYW5hZ2VzIGJhbGFuY2Ugb2YgYW4gQ3J5RFIKICovCmNvbnRyYWN0IENyeWRyU3RvcmFnZUJsb2Nrc0ludGVyZmFjZSB7CgogIC8qIEV2ZW50cyAqLwoKICBldmVudCBBY2NvdW50QmxvY2tlZEV2ZW50KGFkZHJlc3MgaW5kZXhlZCBhY2NvdW50KTsKICBldmVudCBBY2NvdW50VW5ibG9ja2VkRXZlbnQoYWRkcmVzcyBpbmRleGVkIGFjY291bnQpOwogIGV2ZW50IEFjY291bnRGdW5kc0Jsb2NrZWRFdmVudChhZGRyZXNzIGluZGV4ZWQgYWNjb3VudCwgdWludDI1NiB2YWx1ZSk7CiAgZXZlbnQgQWNjb3VudEZ1bmRzVW5ibG9ja2VkRXZlbnQoYWRkcmVzcyBpbmRleGVkIGFjY291bnQsIHVpbnQyNTYgdmFsdWUpOwoKCiAgLyogTG93LWxldmVsIGNoYW5nZSBvZiBibG9ja3MgYW5kIGdldHRlcnMgKi8KCiAgZnVuY3Rpb24gYmxvY2tBY2NvdW50KGFkZHJlc3MgX2FjY291bnQpIHB1YmxpYzsKICBmdW5jdGlvbiB1bmJsb2NrQWNjb3VudChhZGRyZXNzIF9hY2NvdW50KSBwdWJsaWM7CiAgZnVuY3Rpb24gZ2V0QWNjb3VudEJsb2NrcyhhZGRyZXNzIF9hY2NvdW50KSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CgogIGZ1bmN0aW9uIGJsb2NrQWNjb3VudEZ1bmRzKGFkZHJlc3MgX2FjY291bnQsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWM7CiAgZnVuY3Rpb24gdW5ibG9ja0FjY291bnRGdW5kcyhhZGRyZXNzIF9hY2NvdW50LCB1aW50MjU2IF92YWx1ZSkgcHVibGljOwogIGZ1bmN0aW9uIGdldEFjY291bnRCbG9ja2VkRnVuZHMoYWRkcmVzcyBfYWNjb3VudCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwp9CgoKCi8qKgogKiBAdGl0bGUgQ3J5ZHJTdG9yYWdlQmxvY2tzCiAqLwpjb250cmFjdCBDcnlkclN0b3JhZ2VCbG9ja3MgaXMgU2FmZU1hdGhJbnRlcmZhY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYXVzYWJsZUludGVyZmFjZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENyeWRyU3RvcmFnZUJhc2VJbnRlcmZhY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDcnlkclN0b3JhZ2VCbG9ja3NJbnRlcmZhY2UgewoKICAvKiBTdG9yYWdlICovCgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgYWNjb3VudEJsb2NrczsKICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIGFjY291bnRCbG9ja2VkRnVuZHM7CgoKICAvKiBDb25zdHJ1Y3RvciAqLwoKICBmdW5jdGlvbiBDcnlkclN0b3JhZ2VCbG9ja3MoKSBwdWJsaWMgewogICAgYWNjb3VudEJsb2Nrc1sweDBdID0gMHhmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmOwogIH0KCgogIC8qIExvdy1sZXZlbCBjaGFuZ2Ugb2YgYmxvY2tzIGFuZCBnZXR0ZXJzICovCgogIGZ1bmN0aW9uIGJsb2NrQWNjb3VudCgKICAgIGFkZHJlc3MgX2FjY291bnQKICApCiAgICBwdWJsaWMKICB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gZ2V0Q3J5ZHJDb250cm9sbGVyKCkpOwoKICAgIHJlcXVpcmUoX2FjY291bnQgIT0gYWRkcmVzcygweDApKTsKCiAgICBhY2NvdW50QmxvY2tzW19hY2NvdW50XSA9IHNhZmVBZGQoYWNjb3VudEJsb2Nrc1tfYWNjb3VudF0sIDEpOwogICAgQWNjb3VudEJsb2NrZWRFdmVudChfYWNjb3VudCk7CiAgfQoKICBmdW5jdGlvbiB1bmJsb2NrQWNjb3VudCgKICAgIGFkZHJlc3MgX2FjY291bnQKICApCiAgICBwdWJsaWMKICB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gZ2V0Q3J5ZHJDb250cm9sbGVyKCkpOwoKICAgIHJlcXVpcmUoX2FjY291bnQgIT0gYWRkcmVzcygweDApKTsKCiAgICBhY2NvdW50QmxvY2tzW19hY2NvdW50XSA9IHNhZmVTdWIoYWNjb3VudEJsb2Nrc1tfYWNjb3VudF0sIDEpOwogICAgQWNjb3VudFVuYmxvY2tlZEV2ZW50KF9hY2NvdW50KTsKICB9CgogIGZ1bmN0aW9uIGdldEFjY291bnRCbG9ja3MoCiAgICBhZGRyZXNzIF9hY2NvdW50CiAgKQogICAgcHVibGljCiAgICBjb25zdGFudAogICAgcmV0dXJucyAodWludDI1NikKICB7CiAgICByZXF1aXJlKF9hY2NvdW50ICE9IGFkZHJlc3MoMHgwKSk7CgogICAgcmV0dXJuIGFjY291bnRCbG9ja3NbX2FjY291bnRdOwogIH0KCiAgZnVuY3Rpb24gYmxvY2tBY2NvdW50RnVuZHMoCiAgICBhZGRyZXNzIF9hY2NvdW50LAogICAgdWludDI1NiBfdmFsdWUKICApCiAgICBwdWJsaWMKICB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gZ2V0Q3J5ZHJDb250cm9sbGVyKCkpOwoKICAgIHJlcXVpcmUoX2FjY291bnQgIT0gYWRkcmVzcygweDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlID4gMCk7CgogICAgYWNjb3VudEJsb2NrZWRGdW5kc1tfYWNjb3VudF0gPSBzYWZlQWRkKGFjY291bnRCbG9ja2VkRnVuZHNbX2FjY291bnRdLCBfdmFsdWUpOwogICAgQWNjb3VudEZ1bmRzQmxvY2tlZEV2ZW50KF9hY2NvdW50LCBfdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gdW5ibG9ja0FjY291bnRGdW5kcygKICAgIGFkZHJlc3MgX2FjY291bnQsCiAgICB1aW50MjU2IF92YWx1ZQogICkKICAgIHB1YmxpYwogIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBnZXRDcnlkckNvbnRyb2xsZXIoKSk7CgogICAgcmVxdWlyZShfYWNjb3VudCAhPSBhZGRyZXNzKDB4MCkpOwogICAgcmVxdWlyZShfdmFsdWUgPiAwKTsKCiAgICBhY2NvdW50QmxvY2tlZEZ1bmRzW19hY2NvdW50XSA9IHNhZmVTdWIoYWNjb3VudEJsb2NrZWRGdW5kc1tfYWNjb3VudF0sIF92YWx1ZSk7CiAgICBBY2NvdW50RnVuZHNVbmJsb2NrZWRFdmVudChfYWNjb3VudCwgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGdldEFjY291bnRCbG9ja2VkRnVuZHMoCiAgICBhZGRyZXNzIF9hY2NvdW50CiAgKQogICAgcHVibGljCiAgICBjb25zdGFudAogICAgcmV0dXJucyAodWludDI1NikKICB7CiAgICByZXF1aXJlKF9hY2NvdW50ICE9IGFkZHJlc3MoMHgwKSk7CgogICAgcmV0dXJuIGFjY291bnRCbG9ja2VkRnVuZHNbX2FjY291bnRdOwogIH0KfQoKCgovKioKICogQHRpdGxlIENyeWRyU3RvcmFnZUJhbGFuY2VJbnRlcmZhY2UgaW50ZXJmYWNlCiAqIEBkZXYgSW50ZXJmYWNlIG9mIGEgY29udHJhY3QgdGhhdCBtYW5hZ2VzIGJhbGFuY2Ugb2YgYW4gQ3J5RFIKICovCmNvbnRyYWN0IENyeWRyU3RvcmFnZUJhbGFuY2VJbnRlcmZhY2UgewoKICAvKiBFdmVudHMgKi8KCiAgZXZlbnQgQWNjb3VudEJhbGFuY2VJbmNyZWFzZWRFdmVudChhZGRyZXNzIGluZGV4ZWQgYWNjb3VudCwgdWludDI1NiB2YWx1ZSk7CiAgZXZlbnQgQWNjb3VudEJhbGFuY2VEZWNyZWFzZWRFdmVudChhZGRyZXNzIGluZGV4ZWQgYWNjb3VudCwgdWludDI1NiB2YWx1ZSk7CgoKICAvKiBMb3ctbGV2ZWwgY2hhbmdlIG9mIGJhbGFuY2UuIEltcGxpZWQgdGhhdCB0b3RhbFN1cHBseSBrZXB0IGluIHN5bmMuICovCgogIGZ1bmN0aW9uIGluY3JlYXNlQmFsYW5jZShhZGRyZXNzIF9hY2NvdW50LCB1aW50MjU2IF92YWx1ZSkgcHVibGljOwogIGZ1bmN0aW9uIGRlY3JlYXNlQmFsYW5jZShhZGRyZXNzIF9hY2NvdW50LCB1aW50MjU2IF92YWx1ZSkgcHVibGljOwogIGZ1bmN0aW9uIGdldEJhbGFuY2UoYWRkcmVzcyBfYWNjb3VudCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIGdldFRvdGFsU3VwcGx5KCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwp9CgoKCi8qKgogKiBAdGl0bGUgQ3J5ZHJTdG9yYWdlQmFsYW5jZQogKi8KY29udHJhY3QgQ3J5ZHJTdG9yYWdlQmFsYW5jZSBpcyBTYWZlTWF0aEludGVyZmFjZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYXVzYWJsZUludGVyZmFjZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDcnlkclN0b3JhZ2VCYXNlSW50ZXJmYWNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENyeWRyU3RvcmFnZUJhbGFuY2VJbnRlcmZhY2UgewoKICAvKiBTdG9yYWdlICovCgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CiAgdWludDI1NiB0b3RhbFN1cHBseSA9IDA7CgoKICAvKiBMb3ctbGV2ZWwgY2hhbmdlIG9mIGJhbGFuY2UgYW5kIGdldHRlcnMuIEltcGxpZWQgdGhhdCB0b3RhbFN1cHBseSBrZXB0IGluIHN5bmMuICovCgogIGZ1bmN0aW9uIGluY3JlYXNlQmFsYW5jZSgKICAgIGFkZHJlc3MgX2FjY291bnQsCiAgICB1aW50MjU2IF92YWx1ZQogICkKICAgIHB1YmxpYwogICAgd2hlbkNvbnRyYWN0Tm90UGF1c2VkCiAgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGdldENyeWRyQ29udHJvbGxlcigpKTsKCiAgICByZXF1aXJlKF9hY2NvdW50ICE9IGFkZHJlc3MoMHgwKSk7CiAgICByZXF1aXJlKF92YWx1ZSA+IDApOwoKICAgIGJhbGFuY2VzW19hY2NvdW50XSA9IHNhZmVBZGQoYmFsYW5jZXNbX2FjY291bnRdLCBfdmFsdWUpOwogICAgdG90YWxTdXBwbHkgPSBzYWZlQWRkKHRvdGFsU3VwcGx5LCBfdmFsdWUpOwogICAgQWNjb3VudEJhbGFuY2VJbmNyZWFzZWRFdmVudChfYWNjb3VudCwgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGRlY3JlYXNlQmFsYW5jZSgKICAgIGFkZHJlc3MgX2FjY291bnQsCiAgICB1aW50MjU2IF92YWx1ZQogICkKICAgIHB1YmxpYwogICAgd2hlbkNvbnRyYWN0Tm90UGF1c2VkCiAgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGdldENyeWRyQ29udHJvbGxlcigpKTsKCiAgICByZXF1aXJlKF9hY2NvdW50ICE9IGFkZHJlc3MoMHgwKSk7CiAgICByZXF1aXJlKF92YWx1ZSA+IDApOwoKICAgIGJhbGFuY2VzW19hY2NvdW50XSA9IHNhZmVTdWIoYmFsYW5jZXNbX2FjY291bnRdLCBfdmFsdWUpOwogICAgdG90YWxTdXBwbHkgPSBzYWZlU3ViKHRvdGFsU3VwcGx5LCBfdmFsdWUpOwogICAgQWNjb3VudEJhbGFuY2VEZWNyZWFzZWRFdmVudChfYWNjb3VudCwgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGdldEJhbGFuY2UoYWRkcmVzcyBfYWNjb3VudCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJlcXVpcmUoX2FjY291bnQgIT0gYWRkcmVzcygweDApKTsKCiAgICByZXR1cm4gYmFsYW5jZXNbX2FjY291bnRdOwogIH0KCiAgZnVuY3Rpb24gZ2V0VG90YWxTdXBwbHkoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIHRvdGFsU3VwcGx5OwogIH0KfQoKCgovKioKICogQHRpdGxlIENyeWRyU3RvcmFnZUFsbG93YW5jZUludGVyZmFjZSBpbnRlcmZhY2UKICogQGRldiBJbnRlcmZhY2Ugb2YgYSBjb250cmFjdCB0aGF0IG1hbmFnZXMgYmFsYW5jZSBvZiBhbiBDcnlEUgogKi8KY29udHJhY3QgQ3J5ZHJTdG9yYWdlQWxsb3dhbmNlSW50ZXJmYWNlIHsKCiAgLyogRXZlbnRzICovCgogIGV2ZW50IEFjY291bnRBbGxvd2FuY2VJbmNyZWFzZWRFdmVudChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKICBldmVudCBBY2NvdW50QWxsb3dhbmNlRGVjcmVhc2VkRXZlbnQoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7CgoKICAvKiBMb3ctbGV2ZWwgY2hhbmdlIG9mIGFsbG93YW5jZSAqLwoKICBmdW5jdGlvbiBpbmNyZWFzZUFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYzsKICBmdW5jdGlvbiBkZWNyZWFzZUFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYzsKICBmdW5jdGlvbiBnZXRBbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKfQoKCgovKioKICogQHRpdGxlIENyeWRyU3RvcmFnZUFsbG93YW5jZQogKi8KY29udHJhY3QgQ3J5ZHJTdG9yYWdlQWxsb3dhbmNlIGlzIFNhZmVNYXRoSW50ZXJmYWNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUGF1c2FibGVJbnRlcmZhY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDcnlkclN0b3JhZ2VCYXNlSW50ZXJmYWNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ3J5ZHJTdG9yYWdlQWxsb3dhbmNlSW50ZXJmYWNlIHsKCiAgLyogU3RvcmFnZSAqLwoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CgoKICAvKiBMb3ctbGV2ZWwgY2hhbmdlIG9mIGFsbG93YW5jZSBhbmQgZ2V0dGVycyAqLwoKICBmdW5jdGlvbiBpbmNyZWFzZUFsbG93YW5jZSgKICAgIGFkZHJlc3MgX293bmVyLAogICAgYWRkcmVzcyBfc3BlbmRlciwKICAgIHVpbnQyNTYgX3ZhbHVlCiAgKQogICAgcHVibGljCiAgICB3aGVuQ29udHJhY3ROb3RQYXVzZWQKICB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gZ2V0Q3J5ZHJDb250cm9sbGVyKCkpOwoKICAgIHJlcXVpcmUoX293bmVyICE9IGFkZHJlc3MoMHgwKSk7CiAgICByZXF1aXJlKF9zcGVuZGVyICE9IGFkZHJlc3MoMHgwKSk7CiAgICByZXF1aXJlKF9vd25lciAhPSBfc3BlbmRlcik7CiAgICByZXF1aXJlKF92YWx1ZSA+IDApOwoKICAgIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl0gPSBzYWZlQWRkKGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl0sIF92YWx1ZSk7CiAgICBBY2NvdW50QWxsb3dhbmNlSW5jcmVhc2VkRXZlbnQoX293bmVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGRlY3JlYXNlQWxsb3dhbmNlKAogICAgYWRkcmVzcyBfb3duZXIsCiAgICBhZGRyZXNzIF9zcGVuZGVyLAogICAgdWludDI1NiBfdmFsdWUKICApCiAgICBwdWJsaWMKICAgIHdoZW5Db250cmFjdE5vdFBhdXNlZAogIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBnZXRDcnlkckNvbnRyb2xsZXIoKSk7CgogICAgcmVxdWlyZShfb3duZXIgIT0gYWRkcmVzcygweDApKTsKICAgIHJlcXVpcmUoX3NwZW5kZXIgIT0gYWRkcmVzcygweDApKTsKICAgIHJlcXVpcmUoX293bmVyICE9IF9zcGVuZGVyKTsKICAgIHJlcXVpcmUoX3ZhbHVlID4gMCk7CgogICAgYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXSA9IHNhZmVTdWIoYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXSwgX3ZhbHVlKTsKICAgIEFjY291bnRBbGxvd2FuY2VEZWNyZWFzZWRFdmVudChfb3duZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gZ2V0QWxsb3dhbmNlKAogICAgYWRkcmVzcyBfb3duZXIsCiAgICBhZGRyZXNzIF9zcGVuZGVyCiAgKQogICAgcHVibGljCiAgICBjb25zdGFudAogICAgcmV0dXJucyAodWludDI1NikKICB7CiAgICByZXF1aXJlKF9vd25lciAhPSBhZGRyZXNzKDB4MCkpOwogICAgcmVxdWlyZShfc3BlbmRlciAhPSBhZGRyZXNzKDB4MCkpOwogICAgcmVxdWlyZShfb3duZXIgIT0gX3NwZW5kZXIpOwoKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KfQoKCgovKioKICogQHRpdGxlIENyeWRyU3RvcmFnZUVSQzIwSW50ZXJmYWNlIGludGVyZmFjZQogKiBAZGV2IEludGVyZmFjZSBvZiBhIGNvbnRyYWN0IHRoYXQgbWFuYWdlcyBiYWxhbmNlIG9mIGFuIENyeURSIGFuZCBoYXZlIG9wdGltaXphdGlvbiBmb3IgRVJDMjAgY29udHJvbGxlcnMKICovCmNvbnRyYWN0IENyeWRyU3RvcmFnZUVSQzIwSW50ZXJmYWNlIHsKCiAgLyogRXZlbnRzICovCgogIGV2ZW50IENyeWRyVHJhbnNmZXJyZWRFdmVudChhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKICBldmVudCBDcnlkclRyYW5zZmVycmVkRnJvbUV2ZW50KGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCBhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKICBldmVudCBDcnlkclNwZW5kaW5nQXBwcm92ZWRFdmVudChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKCgogIC8qIEVSQzIwIG9wdGltaXphdGlvbi4gX21zZ3NlbmRlciAtIGFjY291bnQgdGhhdCBpbnZva2VkIENyeWRyVmlldyAqLwoKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF9tc2dzZW5kZXIsIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9tc2dzZW5kZXIsIGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfbXNnc2VuZGVyLCBhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljOwp9CgoKCi8qKgogKiBAdGl0bGUgQ3J5ZHJTdG9yYWdlRVJDMjAKICovCmNvbnRyYWN0IENyeWRyU3RvcmFnZUVSQzIwIGlzIFNhZmVNYXRoSW50ZXJmYWNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYXVzYWJsZUludGVyZmFjZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ3J5ZHJTdG9yYWdlQmFzZUludGVyZmFjZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ3J5ZHJTdG9yYWdlQmFsYW5jZUludGVyZmFjZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ3J5ZHJTdG9yYWdlQWxsb3dhbmNlSW50ZXJmYWNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDcnlkclN0b3JhZ2VCbG9ja3NJbnRlcmZhY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENyeWRyU3RvcmFnZUVSQzIwSW50ZXJmYWNlIHsKCiAgZnVuY3Rpb24gdHJhbnNmZXIoCiAgICBhZGRyZXNzIF9tc2dzZW5kZXIsCiAgICBhZGRyZXNzIF90bywKICAgIHVpbnQyNTYgX3ZhbHVlCiAgKQogICAgcHVibGljCiAgICB3aGVuQ29udHJhY3ROb3RQYXVzZWQKICB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gZ2V0Q3J5ZHJDb250cm9sbGVyKCkpOwoKICAgIHJlcXVpcmUoX21zZ3NlbmRlciAhPSBfdG8pOwogICAgcmVxdWlyZShnZXRBY2NvdW50QmxvY2tzKF9tc2dzZW5kZXIpID09IDApOwogICAgcmVxdWlyZShzYWZlU3ViKGdldEJhbGFuY2UoX21zZ3NlbmRlciksIF92YWx1ZSkgPj0gZ2V0QWNjb3VudEJsb2NrZWRGdW5kcyhfbXNnc2VuZGVyKSk7CgogICAgZGVjcmVhc2VCYWxhbmNlKF9tc2dzZW5kZXIsIF92YWx1ZSk7CiAgICBpbmNyZWFzZUJhbGFuY2UoX3RvLCBfdmFsdWUpOwogICAgQ3J5ZHJUcmFuc2ZlcnJlZEV2ZW50KF9tc2dzZW5kZXIsIF90bywgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbSgKICAgIGFkZHJlc3MgX21zZ3NlbmRlciwKICAgIGFkZHJlc3MgX2Zyb20sCiAgICBhZGRyZXNzIF90bywKICAgIHVpbnQyNTYgX3ZhbHVlCiAgKQogICAgcHVibGljCiAgICB3aGVuQ29udHJhY3ROb3RQYXVzZWQKICB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gZ2V0Q3J5ZHJDb250cm9sbGVyKCkpOwoKICAgIHJlcXVpcmUoZ2V0QWNjb3VudEJsb2NrcyhfbXNnc2VuZGVyKSA9PSAwKTsKICAgIHJlcXVpcmUoZ2V0QWNjb3VudEJsb2NrcyhfZnJvbSkgPT0gMCk7CiAgICByZXF1aXJlKHNhZmVTdWIoZ2V0QmFsYW5jZShfZnJvbSksIF92YWx1ZSkgPj0gZ2V0QWNjb3VudEJsb2NrZWRGdW5kcyhfZnJvbSkpOwogICAgcmVxdWlyZShfZnJvbSAhPSBfdG8pOwoKICAgIGRlY3JlYXNlQWxsb3dhbmNlKF9mcm9tLCBfbXNnc2VuZGVyLCBfdmFsdWUpOwogICAgZGVjcmVhc2VCYWxhbmNlKF9mcm9tLCBfdmFsdWUpOwogICAgaW5jcmVhc2VCYWxhbmNlKF90bywgX3ZhbHVlKTsKICAgIENyeWRyVHJhbnNmZXJyZWRGcm9tRXZlbnQoX21zZ3NlbmRlciwgX2Zyb20sIF90bywgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGFwcHJvdmUoCiAgICBhZGRyZXNzIF9tc2dzZW5kZXIsCiAgICBhZGRyZXNzIF9zcGVuZGVyLAogICAgdWludDI1NiBfdmFsdWUKICApCiAgICBwdWJsaWMKICAgIHdoZW5Db250cmFjdE5vdFBhdXNlZAogIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBnZXRDcnlkckNvbnRyb2xsZXIoKSk7CgogICAgcmVxdWlyZShnZXRBY2NvdW50QmxvY2tzKF9tc2dzZW5kZXIpID09IDApOwogICAgcmVxdWlyZShnZXRBY2NvdW50QmxvY2tzKF9zcGVuZGVyKSA9PSAwKTsKCiAgICB1aW50MjU2IGN1cnJlbnRBbGxvd2FuY2UgPSBnZXRBbGxvd2FuY2UoX21zZ3NlbmRlciwgX3NwZW5kZXIpOwogICAgcmVxdWlyZShjdXJyZW50QWxsb3dhbmNlICE9IF92YWx1ZSk7CiAgICBpZiAoY3VycmVudEFsbG93YW5jZSA+IF92YWx1ZSkgewogICAgICBkZWNyZWFzZUFsbG93YW5jZShfbXNnc2VuZGVyLCBfc3BlbmRlciwgc2FmZVN1YihjdXJyZW50QWxsb3dhbmNlLCBfdmFsdWUpKTsKICAgIH0gZWxzZSB7CiAgICAgIGluY3JlYXNlQWxsb3dhbmNlKF9tc2dzZW5kZXIsIF9zcGVuZGVyLCBzYWZlU3ViKF92YWx1ZSwgY3VycmVudEFsbG93YW5jZSkpOwogICAgfQoKICAgIENyeWRyU3BlbmRpbmdBcHByb3ZlZEV2ZW50KF9tc2dzZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogIH0KfQoKCgovKioKICogQHRpdGxlIEpDYXNoQ3J5ZHJTdG9yYWdlCiAqIEBkZXYgSW1wbGVtZW50YXRpb24gb2YgYSBjb250cmFjdCB0aGF0IG1hbmFnZXMgZGF0YSBvZiBhbiBDcnlEUgogKi8KY29udHJhY3QgSkNhc2hDcnlkclN0b3JhZ2UgaXMgU2FmZU1hdGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbW1vbk1vZGlmaWVycywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQXNzZXRJRCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT3duYWJsZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWFuYWdlYWJsZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUGF1c2FibGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJ5dGVjb2RlRXhlY3V0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENyeWRyU3RvcmFnZUJhc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENyeWRyU3RvcmFnZUJhbGFuY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENyeWRyU3RvcmFnZUFsbG93YW5jZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ3J5ZHJTdG9yYWdlQmxvY2tzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDcnlkclN0b3JhZ2VFUkMyMCB7CgogIC8qIENvbnN0cnVjdG9yICovCgogIGZ1bmN0aW9uIEpDYXNoQ3J5ZHJTdG9yYWdlKHN0cmluZyBfYXNzZXRJRCkgQXNzZXRJRChfYXNzZXRJRCkgcHVibGljIHsgfQp9CgoKCmNvbnRyYWN0IEpOVFN0b3JhZ2UgaXMgSkNhc2hDcnlkclN0b3JhZ2UgewogIGZ1bmN0aW9uIEpOVFN0b3JhZ2UoKSBKQ2FzaENyeWRyU3RvcmFnZSgnSk5UJykgcHVibGljIHt9Cn0='.
	

]
