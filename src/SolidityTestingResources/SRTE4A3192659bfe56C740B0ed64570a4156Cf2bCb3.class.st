Class {
	#name : #SRTE4A3192659bfe56C740B0ed64570a4156Cf2bCb3,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTE4A3192659bfe56C740B0ed64570a4156Cf2bCb3 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTY7CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBwZW5kaW5nV2l0aGRyYXdhbHM7CiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCgoKZnVuY3Rpb24gd2l0aGRyYXcoKSB7CiAgICAgICAgdWludCBhbW91bnQgPSBwZW5kaW5nV2l0aGRyYXdhbHNbbXNnLnNlbmRlcl07CiAgICAgICAgcGVuZGluZ1dpdGhkcmF3YWxzW21zZy5zZW5kZXJdID0gMDsKICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKGFtb3VudCk7CiAgICB9Cgp9Ci8qKgogKiBAdGl0bGUgQ2xhaW1hYmxlCiAqIEBkZXYgRXh0ZW5zaW9uIGZvciB0aGUgT3duYWJsZSBjb250cmFjdCwgd2hlcmUgdGhlIG93bmVyc2hpcCBuZWVkcyB0byBiZSBjbGFpbWVkLgogKiBUaGlzIGFsbG93cyB0aGUgbmV3IG93bmVyIHRvIGFjY2VwdCB0aGUgdHJhbnNmZXIuCiAqLwoKY29udHJhY3QgQWlyRHJvcCBpcyBPd25hYmxlIHsKCiAgVG9rZW4gdG9rZW47CgogIGV2ZW50IFRyYW5zZmVycmVkVG9rZW4oYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKICBldmVudCBGYWlsZWRUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwoKICBtb2RpZmllciB3aGVuRHJvcElzQWN0aXZlKCkgewogICAgYXNzZXJ0KGlzQWN0aXZlKCkpOwoKICAgIF87CiAgfQphZGRyZXNzIHB1YmxpYyBjcmVhdG9yOwogIGZ1bmN0aW9uIEFpckRyb3AgKCkgewogICAgICBhZGRyZXNzIF90b2tlbkFkZHIgPSBjcmVhdG9yOyAvL2hlcmUgcGFzcyBhZGRyZXNzIG9mIHlvdXIgdG9rZW4KICAgICAgdG9rZW4gPSBUb2tlbihfdG9rZW5BZGRyKTsKICB9CgogIGZ1bmN0aW9uIGlzQWN0aXZlKCkgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuICgKICAgICAgICB0b2tlbnNBdmFpbGFibGUoKSA+IDAgLy8gVG9rZW5zIG11c3QgYmUgYXZhaWxhYmxlIHRvIHNlbmQKICAgICk7CiAgfQogIC8vYmVsb3cgZnVuY3Rpb24gY2FuIGJlIHVzZWQgd2hlbiB5b3Ugd2FudCB0byBzZW5kIGV2ZXJ5IHJlY2lwZWludCB3aXRoIGRpZmZlcmVudCBudW1iZXIgb2YgdG9rZW5zCiAgZnVuY3Rpb24gc2VuZFRva2VucyhhZGRyZXNzW10gZGVzdHMsIHVpbnQyNTZbXSB2YWx1ZXMpIHdoZW5Ecm9wSXNBY3RpdmUgb25seU93bmVyIGV4dGVybmFsIHsKICAgIHVpbnQyNTYgaSA9IDA7CiAgICB3aGlsZSAoaSA8IGRlc3RzLmxlbmd0aCkgewogICAgICAgIHVpbnQyNTYgdG9TZW5kID0gdmFsdWVzW2ldIDsKICAgICAgICBzZW5kSW50ZXJuYWxseShkZXN0c1tpXSAsIHRvU2VuZCwgdmFsdWVzW2ldKTsKICAgICAgICBpKys7CiAgICB9CiAgfQoKICAvLyB0aGlzIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHdoZW4geW91IHdhbnQgdG8gc2VuZCBzYW1lIG51bWJlciBvZiB0b2tlbnMgdG8gYWxsIHRoZSByZWNpcGllbnRzCiAgZnVuY3Rpb24gc2VuZFRva2Vuc1NpbmdsZVZhbHVlKGFkZHJlc3NbXSBkZXN0cywgdWludDI1NiB2YWx1ZSkgd2hlbkRyb3BJc0FjdGl2ZSBvbmx5T3duZXIgZXh0ZXJuYWwgewogICAgdWludDI1NiBpID0gMDsKICAgIHVpbnQyNTYgdG9TZW5kID0gdmFsdWU7CiAgICB3aGlsZSAoaSA8IGRlc3RzLmxlbmd0aCkgewogICAgICAgIHNlbmRJbnRlcm5hbGx5KGRlc3RzW2ldICwgdG9TZW5kLCB2YWx1ZSk7CiAgICAgICAgaSsrOwogICAgfQogIH0gIAoKICBmdW5jdGlvbiBzZW5kSW50ZXJuYWxseShhZGRyZXNzIHJlY2lwaWVudCwgdWludDI1NiB0b2tlbnNUb1NlbmQsIHVpbnQyNTYgdmFsdWVUb1ByZXNlbnQpIGludGVybmFsIHsKICAgIGlmKHJlY2lwaWVudCA9PSBhZGRyZXNzKDApKSByZXR1cm47CgogICAgaWYodG9rZW5zQXZhaWxhYmxlKCkgPj0gdG9rZW5zVG9TZW5kKSB7CiAgICAgIHRva2VuLnRyYW5zZmVyKHJlY2lwaWVudCwgdG9rZW5zVG9TZW5kKTsKICAgICAgVHJhbnNmZXJyZWRUb2tlbihyZWNpcGllbnQsIHZhbHVlVG9QcmVzZW50KTsKICAgIH0gZWxzZSB7CiAgICAgIEZhaWxlZFRyYW5zZmVyKHJlY2lwaWVudCwgdmFsdWVUb1ByZXNlbnQpOyAKICAgIH0KICB9ICAgCgoKICBmdW5jdGlvbiB0b2tlbnNBdmFpbGFibGUoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gdG9rZW4uYmFsYW5jZU9mKHRoaXMpOwogIH0KCn0KY29udHJhY3QgQ2xhaW1hYmxlIGlzIE93bmFibGUgewogICAgYWRkcmVzcyBwdWJsaWMgcGVuZGluZ093bmVyOwoKICAgIC8qKgogICAgICogQGRldiBNb2RpZmllciB0aHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIHBlbmRpbmdPd25lci4KICAgICAqLwogICAgbW9kaWZpZXIgb25seVBlbmRpbmdPd25lcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gcGVuZGluZ093bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gc2V0IHRoZSBwZW5kaW5nT3duZXIgYWRkcmVzcy4KICAgICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHBlbmRpbmdPd25lciA9IG5ld093bmVyOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBBbGxvd3MgdGhlIHBlbmRpbmdPd25lciBhZGRyZXNzIHRvIGZpbmFsaXplIHRoZSB0cmFuc2Zlci4KICAgICAqLwogICAgZnVuY3Rpb24gY2xhaW1Pd25lcnNoaXAoKSBvbmx5UGVuZGluZ093bmVyIHB1YmxpYyB7CiAgICAgICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIHBlbmRpbmdPd25lcik7CiAgICAgICAgb3duZXIgPSBwZW5kaW5nT3duZXI7CiAgICAgICAgcGVuZGluZ093bmVyID0gYWRkcmVzcygwKTsKICAgIH0KCgp9CgoKY29udHJhY3QgRXRoZXJUb0ZBUk0gaXMgT3duYWJsZSB7CiB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKCnVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5Oy8vIHRvdGFsIG5vIG9mIHRva2VucyBpbiBzdXBwbHkKdWludCByZW1haW5pbmc7CnVpbnQgcHJpY2U7CgptYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIGludmVzdG9yczsgLy9pdCBtYXBzIG5vIG9mIEZhcm1Db2luIGdpdmVuIHRvIGVhY2ggYWRkcmVzcwoKIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgpmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9CgpmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykge30KCmZ1bmN0aW9uICgpICBwYXlhYmxlIHsvLyBjYWxsZWQgd2hlbiBldGhlciBpcyBzZW5kCgogICAgdWludDI1NiByZW1haW5pbmc7CiAgICB1aW50MjU2IHRvdGFsU3VwcGx5OwogICAgdWludCBwcmljZTsKICAgIGFzc2VydChyZW1haW5pbmcgPCB0b3RhbFN1cHBseSk7CiAgICB1aW50IEZhcm1Db2luID0gZGl2KG1zZy52YWx1ZSxwcmljZSk7IC8vIGNhbGN1bGF0ZSBubyBvZiBGYXJtQ29pbiB0byBiZSBpc3N1ZWQgZGVwZW5kaW5nIG9uIHRoZSBwcmljZSBhbmQgZXRoZXIgc2VuZAogICAgYXNzZXJ0KEZhcm1Db2luIDwgc3ViKHRvdGFsU3VwcGx5LHJlbWFpbmluZykpOyAvL0Zhcm1Db2luIGF2YWlsYWJsZSBzaG91bGQgYmUgZ3JlYXRlciB0aGFuIHRoZSBvbmUgdG8gYmUgaXNzdWVkCiAgICBhZGQoaW52ZXN0b3JzW21zZy5zZW5kZXJdLEZhcm1Db2luKTsKICAgIHJlbWFpbmluZyA9IGFkZChyZW1haW5pbmcsIEZhcm1Db2luKTsKICAgIHRyYW5zZmVyKG1zZy5zZW5kZXIsIEZhcm1Db2luKTsKfQoKZnVuY3Rpb24gc2V0UHJpY2UodWludCBfcHJpY2UpCnsgLy8gIHByaWNlIG5lZWQgdG8gYmUgc2V0IG1hdWFsbHkgYXMgaXQgY2Fubm90IGJlIGRvbmUgdmlhIGV0aGVyZXVtIG5ldHdvcmsKICAgIHVpbnQgcHJpY2U7CiAgICBwcmljZSA9IF9wcmljZTsKfQp9Cgpjb250cmFjdCBQYXlUb2tlbiBpcyBFdGhlclRvRkFSTSB7CiBmdW5jdGlvbigpIHB1YmxpYyBwYXlhYmxlewogICAgICAgICBpZihtc2cuc2VuZGVyIT1vd25lcikKICAgICAgIGdpdmVSZXdhcmQobXNnLnNlbmRlcixtc2cudmFsdWUpOwp9CgogZnVuY3Rpb24gZ2l2ZVJld2FyZChhZGRyZXNzIF9wYXllcix1aW50IF9wYXltZW50KSBwdWJsaWMgcGF5YWJsZSByZXR1cm5zIChib29sIF9zdWNjZXNzKXsKICAgICAgICB1aW50IHRva2VuYW1vdW50ID0gX3BheW1lbnQgLyBwcmljZTsKICAgICAgICByZXR1cm4gdHJhbnNmZXIoX3BheWVyLHRva2VuYW1vdW50KTsKICAgIH0gICAgIAp9Cgpjb250cmFjdCBUb2tlbiBpcyBFdGhlclRvRkFSTSwgUGF5VG9rZW4gewoKICAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIGZyb20gd2hpY2ggdGhlIGJhbGFuY2Ugd2lsbCBiZSByZXRyaWV2ZWQKICAgIC8vLyBAcmV0dXJuIFRoZSBiYWxhbmNlCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkge30KCiAgICAvLy8gQG5vdGljZSBzZW5kIGBfdmFsdWVgIHRva2VuIHRvIGBfdG9gIGZyb20gYG1zZy5zZW5kZXJgCiAgICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7fQoKICAgIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgX2Zyb21gIG9uIHRoZSBjb25kaXRpb24gaXQgaXMgYXBwcm92ZWQgYnkgYF9mcm9tYAogICAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyCiAgICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykge30KCiAgICAvLy8gQG5vdGljZSBgbXNnLnNlbmRlcmAgYXBwcm92ZXMgYF9hZGRyYCB0byBzcGVuZCBgX3ZhbHVlYCB0b2tlbnMKICAgIC8vLyBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgYWJsZSB0byB0cmFuc2ZlciB0aGUgdG9rZW5zCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHdlaSB0byBiZSBhcHByb3ZlZCBmb3IgdHJhbnNmZXIKICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIGFwcHJvdmFsIHdhcyBzdWNjZXNzZnVsIG9yIG5vdAogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7fQoKICAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IG93bmluZyB0b2tlbnMKICAgIC8vLyBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgYWJsZSB0byB0cmFuc2ZlciB0aGUgdG9rZW5zCiAgICAvLy8gQHJldHVybiBBbW91bnQgb2YgcmVtYWluaW5nIHRva2VucyBhbGxvd2VkIHRvIHNwZW50CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7fQoKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7CiAgICAKfQoKCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgVG9rZW4gewoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgLy9EZWZhdWx0IGFzc3VtZXMgdG90YWxTdXBwbHkgY2FuJ3QgYmUgb3ZlciBtYXggKDJeMjU2IC0gMSkuCiAgICAgICAgLy9JZiB5b3VyIHRva2VuIGxlYXZlcyBvdXQgdG90YWxTdXBwbHkgYW5kIGNhbiBpc3N1ZSBtb3JlIHRva2VucyBhcyB0aW1lIGdvZXMgb24sIHlvdSBuZWVkIHRvIGNoZWNrIGlmIGl0IGRvZXNuJ3Qgd3JhcC4KICAgICAgICAvL1JlcGxhY2UgdGhlIGlmIHdpdGggdGhpcyBvbmUgaW5zdGVhZC4KICAgICAgICAvL2lmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+IGJhbGFuY2VzW190b10pIHsKICAgICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIF92YWx1ZSA+IDApIHsKICAgICAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOwogICAgICAgICAgICBiYWxhbmNlc1tfdG9dICs9IF92YWx1ZTsKICAgICAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgeyByZXR1cm4gZmFsc2U7IH0KICAgIH0KCiAgIAp1aW50IGNvbnN0YW50IE1BWF9VSU5UID0gMioqMjU2IC0gMTsKCi8vLyBAZGV2IEVSQzIwIHRyYW5zZmVyRnJvbSwgbW9kaWZpZWQgc3VjaCB0aGF0IGFuIGFsbG93YW5jZSBvZiBNQVhfVUlOVCByZXByZXNlbnRzIGFuIHVubGltaXRlZCBhbGxvd2FuY2UuCi8vLyBAcGFyYW0gX2Zyb20gQWRkcmVzcyB0byB0cmFuc2ZlciBmcm9tLgovLy8gQHBhcmFtIF90byBBZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgovLy8gQHBhcmFtIF92YWx1ZSBBbW91bnQgdG8gdHJhbnNmZXIuCi8vLyBAcmV0dXJuIFN1Y2Nlc3Mgb2YgdHJhbnNmZXIuCmZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpCiAgICBwdWJsaWMKICAgIHJldHVybnMgKGJvb2wpCnsKICAgIHVpbnQgYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07CiAgICByZXF1aXJlKGJhbGFuY2VzW19mcm9tXSA+PSBfdmFsdWUKICAgICAgICAgICAgJiYgYWxsb3dhbmNlID49IF92YWx1ZQogICAgICAgICAgICAmJiBiYWxhbmNlc1tfdG9dICsgX3ZhbHVlID49IGJhbGFuY2VzW190b10pOwogICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7CiAgICBiYWxhbmNlc1tfZnJvbV0gLT0gX3ZhbHVlOwogICAgaWYgKGFsbG93YW5jZSA8IE1BWF9VSU5UKSB7CiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOwogICAgfQogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwp9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKfQoKCgovL25hbWUgdGhpcyBjb250cmFjdCB3aGF0ZXZlciB5b3UnZCBsaWtlCmNvbnRyYWN0IEZhcm1Db2luIGlzIFN0YW5kYXJkVG9rZW4gewoKICAgCiAgICAvKiBQdWJsaWMgdmFyaWFibGVzIG9mIHRoZSB0b2tlbiAqLwoKICAgIC8qCiAgICBOT1RFOgogICAgVGhlIGZvbGxvd2luZyB2YXJpYWJsZXMgYXJlIE9QVElPTkFMIHZhbml0aWVzLiBPbmUgZG9lcyBub3QgaGF2ZSB0byBpbmNsdWRlIHRoZW0uCiAgICBUaGV5IGFsbG93IG9uZSB0byBjdXN0b21pc2UgdGhlIHRva2VuIGNvbnRyYWN0ICYgaW4gbm8gd2F5IGluZmx1ZW5jZXMgdGhlIGNvcmUgZnVuY3Rpb25hbGl0eS4KICAgIFNvbWUgd2FsbGV0cy9pbnRlcmZhY2VzIG1pZ2h0IG5vdCBldmVuIGJvdGhlciB0byBsb29rIGF0IHRoaXMgaW5mb3JtYXRpb24uCiAgICAqLwogICAgc3RyaW5nIHB1YmxpYyBuYW1lID0gJ1dvcmxkRmFybUNvaW4nOyAgICAgICAgICAgICAgICAgICAvL2ZhbmN5IG5hbWU6IGVnIFNpbW9uIEJ1Y2tzCiAgICB1aW50OCBwdWJsaWMgZGVjaW1hbHMgPSAwOyAgICAgICAgICAgICAgICAvL0hvdyBtYW55IGRlY2ltYWxzIHRvIHNob3cuIGllLiBUaGVyZSBjb3VsZCAxMDAwIGJhc2UgdW5pdHMgd2l0aCAzIGRlY2ltYWxzLiBNZWFuaW5nIDAuOTgwIFNCWCA9IDk4MCBiYXNlIHVuaXRzLiBJdCdzIGxpa2UgY29tcGFyaW5nIDEgd2VpIHRvIDEgZXRoZXIuCiAgICBzdHJpbmcgcHVibGljIHN5bWJvbCA9ICdXRkFSTSc7ICAgICAgICAgICAgICAgICAvL0FuIGlkZW50aWZpZXI6IGVnIFNCWAogICAgc3RyaW5nIHB1YmxpYyB2ZXJzaW9uID0gJ0gxLjAnOyAgICAgICAvL2h1bWFuIDAuMSBzdGFuZGFyZC4gSnVzdCBhbiBhcmJpdHJhcnkgdmVyc2lvbmluZyBzY2hlbWUuCgovLwovLyBDSEFOR0UgVEhFU0UgVkFMVUVTIEZPUiBZT1VSIFRPS0VOCi8vCgovL21ha2Ugc3VyZSB0aGlzIGZ1bmN0aW9uIG5hbWUgbWF0Y2hlcyB0aGUgY29udHJhY3QgbmFtZSBhYm92ZS4gU28gaWYgeW91J3JlIHRva2VuIGlzIGNhbGxlZCBUdXRvcmlhbFRva2VuLCBtYWtlIHN1cmUgdGhlIC8vY29udHJhY3QgbmFtZSBhYm92ZSBpcyBhbHNvIFR1dG9yaWFsVG9rZW4gaW5zdGVhZCBvZiBFUkMyMFRva2VuCgogICAgZnVuY3Rpb24gRmFybUNvaW4oCiAgICAgICAgKSB7CiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSA1MDAwMDAwOyAgICAgICAgICAgICAgIC8vIEdpdmUgdGhlIGNyZWF0b3IgYWxsIGluaXRpYWwgdG9rZW5zICgxMDAwMDAgZm9yIGV4YW1wbGUpCiAgICAgICAgdG90YWxTdXBwbHkgPSA1MDAwMDAwOyAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0b3RhbCBzdXBwbHkgKDEwMDAwMCBmb3IgZXhhbXBsZSkKICAgICAgICBuYW1lID0gIldvcmxkRmFybUNvaW4iOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSBuYW1lIGZvciBkaXNwbGF5IHB1cnBvc2VzCiAgICAgICAgZGVjaW1hbHMgPSAwOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBbW91bnQgb2YgZGVjaW1hbHMgZm9yIGRpc3BsYXkgcHVycG9zZXMKICAgICAgICBzeW1ib2wgPSAiV0ZBUk0iOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIHN5bWJvbCBmb3IgZGlzcGxheSBwdXJwb3NlcwogICAgfQoKICAgIC8qIEFwcHJvdmVzIGFuZCB0aGVuIGNhbGxzIHRoZSByZWNlaXZpbmcgY29udHJhY3QgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmVBbmRDYWxsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZXh0cmFEYXRhKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKCiAgICAgICAgLy9jYWxsIHRoZSByZWNlaXZlQXBwcm92YWwgZnVuY3Rpb24gb24gdGhlIGNvbnRyYWN0IHlvdSB3YW50IHRvIGJlIG5vdGlmaWVkLiBUaGlzIGNyYWZ0cyB0aGUgZnVuY3Rpb24gc2lnbmF0dXJlIG1hbnVhbGx5IHNvIG9uZSBkb2Vzbid0IGhhdmUgdG8gaW5jbHVkZSBhIGNvbnRyYWN0IGluIGhlcmUganVzdCBmb3IgdGhpcy4KICAgICAgICAvL3JlY2VpdmVBcHByb3ZhbChhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF92YWx1ZSwgYWRkcmVzcyBfdG9rZW5Db250cmFjdCwgYnl0ZXMgX2V4dHJhRGF0YSkKICAgICAgICAvL2l0IGlzIGFzc3VtZWQgdGhhdCB3aGVuIGRvZXMgdGhpcyB0aGF0IHRoZSBjYWxsICpzaG91bGQqIHN1Y2NlZWQsIG90aGVyd2lzZSBvbmUgd291bGQgdXNlIHZhbmlsbGEgYXBwcm92ZSBpbnN0ZWFkLgogICAgICAgIGlmKCFfc3BlbmRlci5jYWxsKGJ5dGVzNChieXRlczMyKHNoYTMoInJlY2VpdmVBcHByb3ZhbChhZGRyZXNzLHVpbnQyNTYsYWRkcmVzcyxieXRlcykiKSkpLCBtc2cuc2VuZGVyLCBfdmFsdWUsIHRoaXMsIF9leHRyYURhdGEpKSB7IHJldmVydDsgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9CgoKY29udHJhY3QgRmFybUNvaW5TYWxlIGlzIEZhcm1Db2luIHsKIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogICAgdWludDI1NiBwdWJsaWMgbWF4TWludGFibGU7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbE1pbnRlZDsKICAgIHVpbnQyNTYgdG90YWxUb2tlbnM7CiAgICB1aW50MjU2IHB1YmxpYyBkZWNpbWFscyA9IDA7CiAgICB1aW50IHB1YmxpYyBlbmRCbG9jazsKICAgIHVpbnQgcHVibGljIHN0YXJ0QmxvY2s7CiAgICB1aW50MjU2IHB1YmxpYyBleGNoYW5nZVJhdGU7CiAgICAKICAgIHVpbnQgcHVibGljIHN0YXJ0VGltZTsKICAgIGJvb2wgcHVibGljIGlzRnVuZGluZzsKICAgIGFkZHJlc3MgcHVibGljIEVUSFdhbGxldDsKICAgIHVpbnQyNTYgcHVibGljIGhlbGRUb3RhbDsKCiAgICBib29sIHByaXZhdGUgY29uZmlnU2V0OwogICAgYWRkcmVzcyBwdWJsaWMgY3JlYXRvcjsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBoZWxkVG9rZW5zOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgaGVsZFRpbWVsaW5lOwoKICAgIGV2ZW50IENvbnRyaWJ1dGlvbihhZGRyZXNzIGZyb20sIHVpbnQyNTYgYW1vdW50KTsKICAgIGV2ZW50IFJlbGVhc2VUb2tlbnMoYWRkcmVzcyBmcm9tLCB1aW50MjU2IGFtb3VudCk7CgovLyBzdGFydCBhbmQgZW5kIGRhdGVzIHdoZXJlIGNyb3dkc2FsZSBpcyBhbGxvd2VkIChib3RoIGluY2x1c2l2ZSkKICB1aW50MjU2IGNvbnN0YW50IHB1YmxpYyBTVEFSVCA9IDE1MTc0NjEyMDAwMDA7IC8vICtuZXcgRGF0ZSgyMDE4LCAyLCAxKSAvIDEwMDAKICB1aW50MjU2IGNvbnN0YW50IHB1YmxpYyBFTkQgPSAxNTIyNTU1MjAwMDAwOyAvLyArbmV3IERhdGUoMjAxOCwgNCwgMSkgLyAxMDAwCgovLyBAcmV0dXJuIHRoZSByYXRlIGluIEZBUk0gcGVyIDEgRVRIIGFjY29yZGluZyB0byB0aGUgdGltZSBvZiB0aGUgdHggYW5kIHRoZSBGQVJNIHByaWNpbmcgcHJvZ3JhbS4KICAgIC8vIEBPdmVycmlkZQogIGZ1bmN0aW9uIGdldFJhdGUoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJhdGUpIHsKICAgIGlmICAgICAgKG5vdyA8IFNUQVJUKSAgICAgICAgICAgIHJldHVybiByYXRlID0gMTE5MDQ3NjE5MDQ3NjIwMDsgLy8gcHJlc2FsZSwgNDAlIGJvbnVzCiAgICBlbHNlIGlmIChub3cgPD0gU1RBUlQgKyAgNiBkYXlzKSByZXR1cm4gcmF0ZSA9IDEyMzQ1Njc5MDAwMDAwMDAgOyAvLyBkYXkgMSB0byA2LCAzNSUgYm9udXMKICAgIGVsc2UgaWYgKG5vdyA8PSBTVEFSVCArIDEzIGRheXMpIHJldHVybiByYXRlID0gMTI4MjA1MTMwMDAwMDAwMCA7IC8vIGRheSA3IHRvIDEzLCAzMCUgYm9udXMKICAgIGVsc2UgaWYgKG5vdyA8PSBTVEFSVCArIDIwIGRheXMpIHJldHVybiByYXRlID0gMTMzMzMzMzMwMDAwMDAwMCA7IC8vIGRheSAxNCB0byAyMCwgMjUlIGJvbnVzCiAgICBlbHNlIGlmIChub3cgPD0gU1RBUlQgKyAyOCBkYXlzKSByZXR1cm4gcmF0ZSA9IDEzODg4ODg5MDAwMDAwMDAgOyAvLyBkYXkgMjEgdG8gMjgsIDIwJSBib251cwogICAgcmV0dXJuIHJhdGUgPSAxNjY2NjY2NzAwMDAwMDAwOyAvLyBubyBib251cwogCiAgfQogIAoKIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZTsKIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCiAKICAgIGZ1bmN0aW9uIGJ1eSgpIHBheWFibGUgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CglpZiAoIWlzRnVuZGluZykge3JldHVybiB0cnVlO30gCgllbHNlIHsKCXZhciBidXlQcmljZSA9IGdldFJhdGUoKTsKCWJ1eVByaWNlOwoJdWludCBhbW91bnQgPSBtc2cudmFsdWUgLyBidXlQcmljZTsgICAgICAgICAgICAgICAgCiAgICAgICAgdG90YWxUb2tlbnMgKz0gYW1vdW50OyAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgYmFsYW5jZVttc2cuc2VuZGVyXSArPSBhbW91bnQ7ICAgICAgICAgICAgICAgICAgIAogICAgICAgIFRyYW5zZmVyKHRoaXMsIG1zZy5zZW5kZXIsIGFtb3VudCk7IAoJcmV0dXJuIHRydWU7IH0gICAgICAgICAgICAKICAgIH0KCiAgICBmdW5jdGlvbiBmdW5kICh1aW50MjU2IGFtb3VudCkgb25seU93bmVyIHsKICAgICAgICBpZiAoIW1zZy5zZW5kZXIuc2VuZChhbW91bnQpKSB7ICAgICAgICAgICAgICAgICAgICAgIAkJCiAgICAgICAgICByZXZlcnQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICB9ICAgICAgICAgICAKICAgIH0KCiAgICBmdW5jdGlvbiAoKSBwYXlhYmxlIHsKICAgIHZhciBidXlQcmljZSA9IGdldFJhdGUoKTsKCWJ1eVByaWNlOwoJdWludCBhbW91bnQgPSBtc2cudmFsdWUgLyBidXlQcmljZTsgICAgICAgICAgICAgICAgCiAgICAgICAgdG90YWxUb2tlbnMgKz0gYW1vdW50OyAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgYmFsYW5jZVttc2cuc2VuZGVyXSArPSBhbW91bnQ7ICAgICAgICAgICAgICAgICAgIAogICAgICAgIFRyYW5zZmVyKHRoaXMsIG1zZy5zZW5kZXIsIGFtb3VudCk7IAoJIH0gICAgICAgICAgICAgICAKICAgIAogICAgZnVuY3Rpb24gRmFybUNvaW5TYWxlKCkgewogICAgICAgIHN0YXJ0QmxvY2sgPSBibG9jay5udW1iZXI7CiAgICAgICAgbWF4TWludGFibGUgPSA1MDAwMDAwOyAvLyAzIG1pbGxpb24gbWF4IHNlbGxhYmxlICgxOCBkZWNpbWFscykKICAgICAgICBFVEhXYWxsZXQgPSAweDNiNDQ0ZkM4YzJDNDVEQ2E1ZTY2MTBFNDlkQzU0NDIzYzVEY2Q4NkU7CiAgICAgICAgaXNGdW5kaW5nID0gdHJ1ZTsKICAgICAgICAKICAgICAgICBjcmVhdG9yID0gbXNnLnNlbmRlcjsKICAgICAgICBjcmVhdGVIZWxkQ29pbnMoKTsKICAgICAgICBzdGFydFRpbWUgPSAxNTE3NDYxMjAwMDAwOwogICAgICAgIHZhciBidXlQcmljZSA9IGdldFJhdGUoKTsKCSAgICBidXlQcmljZTsKICAgICAgICB9CgogCiAgICAvLyBzZXR1cCBmdW5jdGlvbiB0byBiZSByYW4gb25seSAxIHRpbWUKICAgIC8vIHNldHVwIHRva2VuIGFkZHJlc3MKICAgIC8vIHNldHVwIGVuZCBCbG9jayBudW1iZXIKICAgIGZ1bmN0aW9uIHNldHVwKGFkZHJlc3MgVE9LRU4sIHVpbnQgZW5kQmxvY2tUaW1lKSB7CiAgICAgICAgcmVxdWlyZSghY29uZmlnU2V0KTsKICAgICAgICBlbmRCbG9jayA9IGVuZEJsb2NrVGltZTsKICAgICAgICBjb25maWdTZXQgPSB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGNsb3NlU2FsZSgpIGV4dGVybmFsIHsKICAgICAgcmVxdWlyZShtc2cuc2VuZGVyPT1jcmVhdG9yKTsKICAgICAgaXNGdW5kaW5nID0gZmFsc2U7CiAgICB9CgogICAgLy8gQ09OVFJJQlVURSBGVU5DVElPTgogICAgLy8gY29udmVydHMgRVRIIHRvIFRPS0VOIGFuZCBzZW5kcyBuZXcgVE9LRU4gdG8gdGhlIHNlbmRlcgogICAgZnVuY3Rpb24gY29udHJpYnV0ZSgpIGV4dGVybmFsIHBheWFibGUgewogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlPjApOwogICAgICAgIHJlcXVpcmUoaXNGdW5kaW5nKTsKICAgICAgICByZXF1aXJlKGJsb2NrLm51bWJlciA8PSBlbmRCbG9jayk7CiAgICAgICAgdWludDI1NiBhbW91bnQgPSBtc2cudmFsdWUgKiBleGNoYW5nZVJhdGU7CiAgICAgICAgdWludDI1NiB0b3RhbCA9IHRvdGFsTWludGVkICsgYW1vdW50OwogICAgICAgIHJlcXVpcmUodG90YWw8PW1heE1pbnRhYmxlKTsKICAgICAgICB0b3RhbE1pbnRlZCArPSB0b3RhbDsKICAgICAgICBFVEhXYWxsZXQudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgICAgICBDb250cmlidXRpb24obXNnLnNlbmRlciwgYW1vdW50KTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZXBvc2l0KCkgcGF5YWJsZSB7CiAgICAgIGNyZWF0ZShtc2cuc2VuZGVyKTsKICAgIH0KICAgIGZ1bmN0aW9uIHJlZ2lzdGVyKGFkZHJlc3Mgc2VuZGVyKSBwYXlhYmxlIHsKICAgIH0KICAKICAgIGZ1bmN0aW9uIGNyZWF0ZShhZGRyZXNzIF9iZW5lZmljaWFyeSkgcGF5YWJsZXsKICAgIHVpbnQyNTYgYW1vdW50ID0gbXNnLnZhbHVlOwogICAgLy8vIAogICAgfQoKICAgIGZ1bmN0aW9uIHdpdGhkcmF3KCkgewogICAgcmVxdWlyZSAoIG1zZy5zZW5kZXIgPT0gb3duZXIgKTsKICAgIG1zZy5zZW5kZXIudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKfQogICAgLy8gdXBkYXRlIHRoZSBFVEgvQ09JTiByYXRlCiAgICBmdW5jdGlvbiB1cGRhdGVSYXRlKHVpbnQyNTYgcmF0ZSkgZXh0ZXJuYWwgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlcj09Y3JlYXRvcik7CiAgICAgICAgcmVxdWlyZShpc0Z1bmRpbmcpOwogICAgICAgIGV4Y2hhbmdlUmF0ZSA9IHJhdGU7CiAgICB9CgogICAgLy8gY2hhbmdlIGNyZWF0b3IgYWRkcmVzcwogICAgZnVuY3Rpb24gY2hhbmdlQ3JlYXRvcihhZGRyZXNzIF9jcmVhdG9yKSBleHRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyPT1jcmVhdG9yKTsKICAgICAgICBjcmVhdG9yID0gX2NyZWF0b3I7CiAgICB9CgogICAgLy8gY2hhbmdlIHRyYW5zZmVyIHN0YXR1cyBmb3IgV29ybGRGYXJtQ29pbiB0b2tlbgogICAgZnVuY3Rpb24gY2hhbmdlVHJhbnNmZXJTdGF0cyhib29sIF9hbGxvd2VkKSBleHRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyPT1jcmVhdG9yKTsKICAgICB9CgogICAgLy8gaW50ZXJuYWwgZnVuY3Rpb24gdGhhdCBhbGxvY2F0ZXMgYSBzcGVjaWZpYyBhbW91bnQgb2YgQVRZWCBhdCBhIHNwZWNpZmljIGJsb2NrIG51bWJlci4KICAgIC8vIG9ubHkgcmFuIDEgdGltZSBvbiBpbml0aWFsaXphdGlvbgogICAgZnVuY3Rpb24gY3JlYXRlSGVsZENvaW5zKCkgaW50ZXJuYWwgewogICAgICAgIC8vIFRPVEFMIFNVUFBMWSA9IDUsMDAwLDAwMAogICAgICAgIGNyZWF0ZUhvbGRUb2tlbihtc2cuc2VuZGVyLCAwKTsKICAgICAgICBjcmVhdGVIb2xkVG9rZW4oMHhkOTcxMEQ4MjlmYTdjMzZFMDI1MDExYjgwMTY2NDAwOUU0ZTdjNjlELCAxMDAwMDAwKTsKICAgICAgICBjcmVhdGVIb2xkVG9rZW4oMHhkOTcxMEQ4MjlmYTdjMzZFMDI1MDExYjgwMTY2NDAwOUU0ZTdjNjlELCAxMDAwMDAwKTsKICAgIH0KCiAgICAvLyBmdW5jdGlvbiB0byBjcmVhdGUgaGVsZCB0b2tlbnMgZm9yIGRldmVsb3BlcgogICAgZnVuY3Rpb24gY3JlYXRlSG9sZFRva2VuKGFkZHJlc3MgX3RvLCB1aW50MjU2IGFtb3VudCkgaW50ZXJuYWwgewogICAgICAgIGhlbGRUb2tlbnNbX3RvXSA9IGFtb3VudDsKICAgICAgICBoZWxkVGltZWxpbmVbX3RvXSA9IGJsb2NrLm51bWJlciArIDA7CiAgICAgICAgaGVsZFRvdGFsICs9IGFtb3VudDsKICAgICAgICB0b3RhbE1pbnRlZCArPSBoZWxkVG90YWw7CiAgICB9CgogICAgLy8gZnVuY3Rpb24gdG8gcmVsZWFzZSBoZWxkIHRva2VucyBmb3IgZGV2ZWxvcGVycwogICAgZnVuY3Rpb24gcmVsZWFzZUhlbGRDb2lucygpIGV4dGVybmFsIHsKICAgICAgICB1aW50MjU2IGhlbGQgPSBoZWxkVG9rZW5zW21zZy5zZW5kZXJdOwogICAgICAgIHVpbnQgaGVsZEJsb2NrID0gaGVsZFRpbWVsaW5lW21zZy5zZW5kZXJdOwogICAgICAgIHJlcXVpcmUoIWlzRnVuZGluZyk7CiAgICAgICAgcmVxdWlyZShoZWxkID49IDApOwogICAgICAgIHJlcXVpcmUoYmxvY2subnVtYmVyID49IGhlbGRCbG9jayk7CiAgICAgICAgaGVsZFRva2Vuc1ttc2cuc2VuZGVyXSA9IDA7CiAgICAgICAgaGVsZFRpbWVsaW5lW21zZy5zZW5kZXJdID0gMDsKICAgICAgICBSZWxlYXNlVG9rZW5zKG1zZy5zZW5kZXIsIGhlbGQpOwogICAgfQoKfQ=='.
	

]
