Class {
	#name : #SRT631d139a4e21c20dd75722ec7428315ce186ffd5,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT631d139a4e21c20dd75722ec7428315ce186ffd5 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgppbnRlcmZhY2UgVG9rZW5TdGFnZXNNYW5hZ2VyIHsKICAgIGZ1bmN0aW9uIGlzRGVidWcoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyhib29sKTsKICAgIGZ1bmN0aW9uIHNldFRva2VuKGFkZHJlc3MgdG9rZW5BZGRyZXNzKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBnZXRQb29sKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQ5Nik7CiAgICBmdW5jdGlvbiBnZXRCb251cygpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50OCk7CiAgICBmdW5jdGlvbiBpc0ZyZWV6ZVRpbWVvdXQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBpc1RpbWVvdXQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBpc0lDTygpIHB1YmxpYyB2aWV3IHJldHVybnMoYm9vbCk7CiAgICBmdW5jdGlvbiBpc0Nhbkxpc3QoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZUJvbnVzKHVpbnQ5NiBhbW91bnQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4OCk7CiAgICBmdW5jdGlvbiBkZWxlZ2F0ZUZyb21Qb29sKHVpbnQ5NiBhbW91bnQpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGRlbGVnYXRlRnJvbUJvbnVzKHVpbnQ4OCBhbW91bnQpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGRlbGVnYXRlRnJvbVJlZmVycmFsKHVpbnQ4OCBhbW91bnQpIHB1YmxpYzsKCiAgICBmdW5jdGlvbiBnZXRCb251c1Bvb2woKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50ODgpOwogICAgZnVuY3Rpb24gZ2V0UmVmZXJyYWxQb29sKCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludDg4KTsKfQoKY29udHJhY3QgQWRtaW5pc3RyYXRlZCB7CiAgICBhZGRyZXNzIHB1YmxpYyBhZG1pbmlzdHJhdG9yOwoKICAgIG1vZGlmaWVyIG9ubHlBZG1pbmlzdHJhdG9yKCkgewogICAgICAgIHJlcXVpcmUoYWRtaW5pc3RyYXRvciA9PSB0eC5vcmlnaW4pOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgbm90QWRtaW5pc3RyYXRvcigpIHsKICAgICAgICByZXF1aXJlKGFkbWluaXN0cmF0b3IgIT0gdHgub3JpZ2luKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEFkbWluaXN0cmF0b3IoYWRkcmVzcyBfYWRtaW5pc3RyYXRvcikKICAgICAgICBpbnRlcm5hbAogICAgewogICAgICAgIGFkbWluaXN0cmF0b3IgPSBfYWRtaW5pc3RyYXRvcjsKICAgIH0KfQoKLy8tLS0tLS0tLy8KY29udHJhY3QgVU5JVFN0YWdlc01hbmFnZXIgaXMgVG9rZW5TdGFnZXNNYW5hZ2VyLCBBZG1pbmlzdHJhdGVkIHsKICAgIHN0cnVjdCBTdGFnZU9mZmVyIHsKICAgICAgICB1aW50OTYgcG9vbDsKICAgICAgICB1aW50OCBib251czsKICAgIH0KCiAgICBzdHJ1Y3QgU3RhZ2UgewogICAgICAgIHVpbnQzMiBzdGFydHNBdDsKICAgICAgICB1aW50MzIgZW5kc0F0OwogICAgICAgIFN0YWdlT2ZmZXJbNV0gb2ZmZXJzOwogICAgfQoKICAgIHVpbnQ4OCBwdWJsaWMgYm9udXNQb29sID0gMTQzMjIwMTM3NTUyNjM3MjAwMDAwMDAwMDA7IC8vCgogICAgdWludDg4IHB1YmxpYyByZWZlcnJhbFBvb2wgPSAzNDUwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDsgLy8zNC41bWxuCgogICAgU3RhZ2VbM10gcHVibGljIHN0YWdlczsKCiAgICB1aW50OCBwdWJsaWMgc3RhZ2U7CiAgICB1aW50OCBwdWJsaWMgb2ZmZXIgPSAwOwoKICAgIFVOSVR2MiBwdWJsaWMgdG9rZW47CgogICAgYm9vbCBpbnRlcm5hbCBfaXNEZWJ1ZzsKCiAgICBldmVudCBTdGFnZVVwZGF0ZWQodWludDggcHJldlN0YWdlLCB1aW50OCBwcmVmT2ZmZXIsIHVpbnQ4IG5ld1N0YWdlLCB1aW50OCBuZXdPZmZlcik7CiAgICBldmVudCBUb2tlbnNEZWxlZ2F0ZWQodWludDk2IGFtb3VudCwgdWludDg4IGJvbnVzKTsKICAgIGV2ZW50IFJlZmVycmFsVG9rZW5zRGVsZWdhdGVkKHVpbnQ5NiBhbW91bnQpOwogICAgZXZlbnQgQm9udXNUb2tlbnNEZWxlZ2F0ZWQodWludDk2IGFtb3VudCk7CgogICAgbW9kaWZpZXIgdG9rZW5PckFkbWluKCkgewogICAgICAgIHJlcXVpcmUodHgub3JpZ2luID09IGFkbWluaXN0cmF0b3IgfHwgKGFkZHJlc3ModG9rZW4pICE9IGFkZHJlc3MoMCkgJiYgbXNnLnNlbmRlciA9PSBhZGRyZXNzKHRva2VuKSkpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seURlYnVnKCkgewogICAgICAgIHJlcXVpcmUoX2lzRGVidWcpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgY2FuRGVsZWdhdGUoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkZHJlc3ModG9rZW4pIHx8IChfaXNEZWJ1ZyAmJiB0eC5vcmlnaW4gPT0gYWRtaW5pc3RyYXRvcikpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gVU5JVFN0YWdlc01hbmFnZXIoYm9vbCBpc0RlYnVnLCBhZGRyZXNzIF90b2tlbikKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICBzZXRBZG1pbmlzdHJhdG9yKHR4Lm9yaWdpbik7CiAgICAgICAgdG9rZW4gPSBVTklUdjIoX3Rva2VuKTsKICAgICAgICBfaXNEZWJ1ZyA9IGlzRGVidWc7CgogICAgICAgIGJ1aWxkUHJlSUNPU3RhZ2UoKTsKICAgICAgICBidWlsZElDT1N0YWdlT25lKCk7CiAgICAgICAgYnVpbGRJQ09TdGFnZVR3bygpOwoKICAgICAgICBpZiAoIV9pc0RlYnVnKSB7CiAgICAgICAgICAgIHN3aXRjaFN0YWdlKCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGlzRGVidWcoKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXR1cm4gX2lzRGVidWc7CiAgICB9CgogICAgZnVuY3Rpb24gYnVpbGRQcmVJQ09TdGFnZSgpCiAgICAgICAgaW50ZXJuYWwKICAgIHsKICAgICAgICBzdGFnZXNbMF0uc3RhcnRzQXQgPSAxNTE1NjEwODAwOyAvLzEwdGggb2YgSmFudWFyeSAyMDE4IGF0IDE5OjAwVVRDCiAgICAgICAgc3RhZ2VzWzBdLmVuZHNBdCA9IDE1MTg4OTQwMDA7IC8vMTd0aCBvZiBGZWJydWFyeSAyMDE4IGF0IDE5OjAwVVRDCgogICAgICAgIHN0YWdlc1swXS5vZmZlcnNbMF0ucG9vbCA9IDI0NzA1NTAzNDM4ODE1OTMyMzg0MTQxMDQ5OyAvLzI1IG1sbiB0b2tlbnMKICAgICAgICBzdGFnZXNbMF0ub2ZmZXJzWzBdLmJvbnVzID0gNDA7CiAgICB9CgogICAgZnVuY3Rpb24gYnVpbGRJQ09TdGFnZU9uZSgpCiAgICAgICAgaW50ZXJuYWwKICAgIHsKICAgICAgICBzdGFnZXNbMV0uc3RhcnRzQXQgPSAxNTE5MzI2MDAwOyAvLzIydGggb2YgRmVicnVhcnkgMjAxOCBhdCAxOTowMFVUQwogICAgICAgIHN0YWdlc1sxXS5lbmRzQXQgPSAxNTIxNzQ1MjAwOyAvLzIydGggb2YgTWFyY2ggMjAxOCBhdCAxOTowMFVUQwoKICAgICAgICBzdGFnZXNbMV0ub2ZmZXJzWzBdLnBvb2wgPSA1MDAwMDAwICogKCAxMCoqMTggKTsgLy81IG1sbiB0b2tlbnMKICAgICAgICBzdGFnZXNbMV0ub2ZmZXJzWzBdLmJvbnVzID0gMzU7IC8vMzUlCgogICAgICAgIHN0YWdlc1sxXS5vZmZlcnNbMV0ucG9vbCA9IDUwMDAwMDAgKiAoIDEwKioxOCApOyAvLzUgbWxuIHRva2VucwogICAgICAgIHN0YWdlc1sxXS5vZmZlcnNbMV0uYm9udXMgPSAzMDsgLy8zMCUKCiAgICAgICAgc3RhZ2VzWzFdLm9mZmVyc1syXS5wb29sID0gNTAwMDAwMCAqICggMTAqKjE4ICk7IC8vNSBtbG4gdG9rZW5zCiAgICAgICAgc3RhZ2VzWzFdLm9mZmVyc1syXS5ib251cyA9IDI1OyAvLzI1JQoKICAgICAgICBzdGFnZXNbMV0ub2ZmZXJzWzNdLnBvb2wgPSA1MDAwMDAwICogKCAxMCoqMTggKTsgLy81IG1sbiB0b2tlbnMKICAgICAgICBzdGFnZXNbMV0ub2ZmZXJzWzNdLmJvbnVzID0gMjA7IC8vMjAlCgogICAgICAgIHN0YWdlc1sxXS5vZmZlcnNbNF0ucG9vbCA9IDEyMjUwMDAwMCAqICggMTAqKjE4ICk7IC8vMTIyLjUgbWxuIHRva2VucwogICAgICAgIHN0YWdlc1sxXS5vZmZlcnNbNF0uYm9udXMgPSAwOyAvLzAlCiAgICB9CgogICAgZnVuY3Rpb24gYnVpbGRJQ09TdGFnZVR3bygpCiAgICAgICAgaW50ZXJuYWwKICAgIHsKICAgICAgICBzdGFnZXNbMl0uc3RhcnRzQXQgPSAxNTI0MjUwODAwOyAvLzIwdGggb2YgQXByaWwgMjAxOCBhdCAxOTowMFVUQwogICAgICAgIHN0YWdlc1syXS5lbmRzQXQgPSAxNTI2ODQyODAwOyAvLzIwdGggb2YgTWF5IDIwMTggYXQgMTk6MDBVVEMKCiAgICAgICAgc3RhZ2VzWzJdLm9mZmVyc1swXS5wb29sID0gMTQyNzk0NDk2NTYxMTg0MDY3NjE1ODU4OTUxOwogICAgICAgIHN0YWdlc1syXS5vZmZlcnNbMF0uYm9udXMgPSAwOyAvLzAlCiAgICB9CgogICAgZnVuY3Rpb24gc3dpdGNoU3RhZ2UoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIHVpbnQ4IF9zdGFnZSA9IHN0YWdlOwogICAgICAgIHVpbnQ4IF9vZmZlciA9IDA7CgogICAgICAgIHdoaWxlKCBzdGFnZXMubGVuZ3RoID4gX3N0YWdlICkgewogICAgICAgICAgICBpZiAoc3RhZ2VzW19zdGFnZV0uZW5kc0F0IDw9IHVpbnQzMihub3cpKSB7CiAgICAgICAgICAgICAgICBfc3RhZ2UgKz0gMTsKICAgICAgICAgICAgICAgIF9vZmZlciA9IDA7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgd2hpbGUgKCBzdGFnZXNbX3N0YWdlXS5vZmZlcnMubGVuZ3RoID4gX29mZmVyICkgewogICAgICAgICAgICAgICAgaWYgKHN0YWdlc1tfc3RhZ2VdLm9mZmVyc1tfb2ZmZXJdLnBvb2wgPT0gMCkgewogICAgICAgICAgICAgICAgICAgIF9vZmZlciArPSAxOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHN0YWdlc1tfc3RhZ2VdLm9mZmVycy5sZW5ndGggPD0gX29mZmVyKSB7CiAgICAgICAgICAgICAgICBfc3RhZ2UgKz0gMTsKICAgICAgICAgICAgICAgIF9vZmZlciA9IDA7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAoc3RhZ2UgPCBfc3RhZ2UpIHsKICAgICAgICAgICAgbWlncmF0ZVBvb2woKTsKICAgICAgICB9CgogICAgICAgIFN0YWdlVXBkYXRlZChzdGFnZSwgb2ZmZXIsIF9zdGFnZSwgX29mZmVyKTsKCiAgICAgICAgc3RhZ2UgPSBfc3RhZ2U7CiAgICAgICAgb2ZmZXIgPSBfb2ZmZXI7CiAgICB9CgogICAgZnVuY3Rpb24gbWlncmF0ZVBvb2woKQogICAgICAgIGludGVybmFsCiAgICB7CiAgICAgICAgaWYgKCBzdGFnZSA8IChzdGFnZXMubGVuZ3RoIC0gMSkgKSB7CiAgICAgICAgICAgIGZvciAodWludDggaSA9IDA7IGkgPCBzdGFnZXNbc3RhZ2VdLm9mZmVycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgc3RhZ2VzW3N0YWdlcy5sZW5ndGggLSAxXS5vZmZlcnNbMF0ucG9vbCArPSBzdGFnZXNbc3RhZ2VdLm9mZmVyc1tpXS5wb29sOwogICAgICAgICAgICAgICAgc3RhZ2VzW3N0YWdlXS5vZmZlcnNbb2ZmZXJdLnBvb2wgPSAwOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8vU1RBUlQgRGVidWcgbWV0aG9kcwogICAgLyoKICAgIFdBUk5JTkchIFRoaXMgbWV0aG9kcyBhcmUgZm9yIGRlYnVnIHB1cnBvc2Ugb25seSBkdXJpbmcgdGVzdGluZy4KICAgIFRoZXkgd2lsbCB3b3JrIG9ubHkgb2YgaXNEZWJ1ZyBvcHRpb24gaXMgc2V0IHRvIHRydWUuCiAgICAqLwogICAgZnVuY3Rpb24gZFRpbWVvdXRDdXJyZW50U3RhZ2UoKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yCiAgICAgICAgb25seURlYnVnCiAgICB7CiAgICAgICAgc3RhZ2VzW3N0YWdlXS5lbmRzQXQgPSB1aW50MzIobm93KSAtIDEwOwogICAgfQoKICAgIGZ1bmN0aW9uIGRTdGFydHNOb3coKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yCiAgICAgICAgb25seURlYnVnCiAgICB7CiAgICAgICAgdWludDMyIHRpbWVEaWZmID0gc3RhZ2VzW3N0YWdlXS5lbmRzQXQgLSBzdGFnZXNbc3RhZ2VdLnN0YXJ0c0F0OwogICAgICAgIHN0YWdlc1tzdGFnZV0uc3RhcnRzQXQgPSB1aW50MzIobm93KTsKICAgICAgICBzdGFnZXNbc3RhZ2VdLmVuZHNBdCA9IHN0YWdlc1tzdGFnZV0uc3RhcnRzQXQgKyB0aW1lRGlmZjsKICAgIH0KCiAgICBmdW5jdGlvbiBkTmV4dFN0YWdlKHVpbnQzMiBzdGFydE9mZnNldCkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5QWRtaW5pc3RyYXRvcgogICAgICAgIG9ubHlEZWJ1ZwogICAgewogICAgICAgIGlmICggc3RhZ2UgPCBzdGFnZXMubGVuZ3RoICkgewogICAgICAgICAgICBkVGltZW91dEN1cnJlbnRTdGFnZSgpOwoKICAgICAgICAgICAgdWludDggbmV3U3RhZ2UgPSBzdGFnZSArIDE7CiAgICAgICAgICAgIHVpbnQzMiB0aW1lRGlmZiA9IHN0YWdlc1tuZXdTdGFnZV0uZW5kc0F0IC0gc3RhZ2VzW25ld1N0YWdlXS5zdGFydHNBdDsKCiAgICAgICAgICAgIHN0YWdlc1tuZXdTdGFnZV0uc3RhcnRzQXQgPSB1aW50MzIobm93KSArIHN0YXJ0T2Zmc2V0OwogICAgICAgICAgICBzdGFnZXNbbmV3U3RhZ2VdLmVuZHNBdCA9IHN0YWdlc1tuZXdTdGFnZV0uc3RhcnRzQXQgKyB0aW1lRGlmZjsKCiAgICAgICAgICAgIHN3aXRjaFN0YWdlKCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGROZXh0T2ZmZXIoKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yCiAgICAgICAgb25seURlYnVnCiAgICB7CiAgICAgICAgb2ZmZXIrKzsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gZEFsdGVyUHVsbCh1aW50OTYgbnVtVG9rZW5zKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yCiAgICAgICAgb25seURlYnVnCiAgICB7CiAgICAgICAgd2l0aGRyYXdUb2tlbnNGcm9tUG9vbChudW1Ub2tlbnMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRHZXRQb29sKHVpbnQ4IF9zdGFnZSwgdWludDggX29mZmVyKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yCiAgICAgICAgb25seURlYnVnCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnMgKHVpbnQ5NikKICAgIHsKICAgICAgICByZXR1cm4gc3RhZ2VzW19zdGFnZV0ub2ZmZXJzW19vZmZlcl0ucG9vbDsKICAgIH0KICAgIC8vRU5EIERlYnVnIG1ldGhvZHMKCiAgICBmdW5jdGlvbiB3aXRoZHJhd1Rva2Vuc0Zyb21Qb29sKHVpbnQ5NiBudW1Ub2tlbnMpCiAgICAgICAgaW50ZXJuYWwKICAgIHsKICAgICAgICByZXF1aXJlKG51bVRva2VucyA8PSBzdGFnZXNbc3RhZ2VdLm9mZmVyc1tvZmZlcl0ucG9vbCk7CgogICAgICAgIHN0YWdlc1tzdGFnZV0ub2ZmZXJzW29mZmVyXS5wb29sIC09IG51bVRva2VuczsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRDdXJyZW50U3RhZ2UoKQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zICh1aW50MzIgc3RhcnRzQXQsIHVpbnQzMiBlbmRzQXQsIHVpbnQ5NiBwb29sLCB1aW50OCBib251cykKICAgIHsKICAgICAgICB1aW50OCBfc3RhZ2UgPSBzdGFnZTsKICAgICAgICB1aW50OCBfb2ZmZXIgPSBvZmZlcjsKCiAgICAgICAgaWYgKCBfc3RhZ2UgPj0gc3RhZ2VzLmxlbmd0aCApIHsKICAgICAgICAgICAgX3N0YWdlID0gdWludDgoc3RhZ2VzLmxlbmd0aCAtIDEpOwogICAgICAgICAgICBfb2ZmZXIgPSAwOwogICAgICAgIH0KICAgICAgICAgICAgc3RhcnRzQXQgPSBzdGFnZXNbX3N0YWdlXS5zdGFydHNBdDsKICAgICAgICAgICAgZW5kc0F0ID0gc3RhZ2VzW19zdGFnZV0uZW5kc0F0OwogICAgICAgICAgICBwb29sID0gc3RhZ2VzW19zdGFnZV0ub2ZmZXJzW19vZmZlcl0ucG9vbDsKICAgICAgICAgICAgYm9udXMgPSBzdGFnZXNbX3N0YWdlXS5vZmZlcnNbX29mZmVyXS5ib251czsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRUb2tlbihhZGRyZXNzIHRva2VuQWRkcmVzcykKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5QWRtaW5pc3RyYXRvcgogICAgewogICAgICAgIHRva2VuID0gVU5JVHYyKHRva2VuQWRkcmVzcyk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0UG9vbCgpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50OTYpCiAgICB7CiAgICAgICAgdWludDggX3N0YWdlID0gc3RhZ2U7CiAgICAgICAgdWludDggX29mZmVyID0gb2ZmZXI7CgogICAgICAgIGlmICggIWlzSUNPKCkgKSB7CiAgICAgICAgICAgIF9zdGFnZSA9IHVpbnQ4KHN0YWdlcy5sZW5ndGggLSAxKTsKICAgICAgICAgICAgX29mZmVyID0gMDsKICAgICAgICB9CgogICAgICAgIHJldHVybiBzdGFnZXNbX3N0YWdlXS5vZmZlcnNbX29mZmVyXS5wb29sOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEJvbnVzKCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKHVpbnQ4KQogICAgewogICAgICAgIHVpbnQ4IF9zdGFnZSA9IHN0YWdlOwogICAgICAgIHVpbnQ4IF9vZmZlciA9IG9mZmVyOwoKICAgICAgICBpZiAoICFpc0lDTygpICkgewogICAgICAgICAgICBfc3RhZ2UgPSB1aW50OChzdGFnZXMubGVuZ3RoIC0gMSk7CiAgICAgICAgICAgIF9vZmZlciA9IDA7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gc3RhZ2VzW19zdGFnZV0ub2ZmZXJzW19vZmZlcl0uYm9udXM7CiAgICB9CgogICAgZnVuY3Rpb24gaXNUaW1lb3V0KCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgdWludDggX3N0YWdlID0gc3RhZ2U7CgogICAgICAgIGlmICggIWlzSUNPKCkgKSB7CiAgICAgICAgICAgIF9zdGFnZSA9IHVpbnQ4KHN0YWdlcy5sZW5ndGggLSAxKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBub3cgPj0gc3RhZ2VzW19zdGFnZV0uZW5kc0F0OwogICAgfQoKICAgIGZ1bmN0aW9uIGlzRnJlZXplVGltZW91dCgpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHJldHVybiBub3cgPj0gKHN0YWdlc1tzdGFnZXMubGVuZ3RoIC0gMV0uZW5kc0F0ICsgMTgwIGRheXMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzSUNPKCkKICAgICAgICBwdWJsaWMKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMoYm9vbCkKICAgIHsKICAgICAgICByZXR1cm4gc3RhZ2UgPCBzdGFnZXMubGVuZ3RoOwogICAgfQoKICAgIGZ1bmN0aW9uIGlzQ2FuTGlzdCgpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHJldHVybiAhaXNJQ08oKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRCb251c1Bvb2woKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyh1aW50ODgpCiAgICB7CiAgICAgICAgcmV0dXJuIGJvbnVzUG9vbDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRSZWZlcnJhbFBvb2woKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyh1aW50ODgpCiAgICB7CiAgICAgICAgcmV0dXJuIHJlZmVycmFsUG9vbDsKICAgIH0KCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVCb251cyh1aW50OTYgYW1vdW50KQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zICh1aW50ODggYm9udXMpCiAgICB7CiAgICAgICAgYm9udXMgPSB1aW50ODgoICggYW1vdW50ICogZ2V0Qm9udXMoKSApIC8gMTAwKTsKCiAgICAgICAgaWYgKGJvbnVzID4gYm9udXNQb29sKSB7CiAgICAgICAgICAgIGJvbnVzID0gYm9udXNQb29sOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBkZWxlZ2F0ZUZyb21Qb29sKHVpbnQ5NiBhbW91bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgY2FuRGVsZWdhdGUoKQogICAgewogICAgICAgIHJlcXVpcmUoYW1vdW50IDw9IGdldFBvb2woKSk7CiAgICAgICAgdWludDg4IGJvbnVzID0gY2FsY3VsYXRlQm9udXMoYW1vdW50KTsKCiAgICAgICAgc3RhZ2VzW3N0YWdlXS5vZmZlcnNbb2ZmZXJdLnBvb2wgLT0gYW1vdW50OwogICAgICAgIGJvbnVzUG9vbCAtPSBib251czsKCiAgICAgICAgVG9rZW5zRGVsZWdhdGVkKGFtb3VudCwgYm9udXMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlbGVnYXRlRnJvbUJvbnVzKHVpbnQ4OCBhbW91bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgY2FuRGVsZWdhdGUoKQogICAgewogICAgICAgIHJlcXVpcmUoYW1vdW50IDw9IGdldEJvbnVzUG9vbCgpKTsKCiAgICAgICAgYm9udXNQb29sIC09IGFtb3VudDsKICAgICAgICBCb251c1Rva2Vuc0RlbGVnYXRlZChhbW91bnQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlbGVnYXRlRnJvbVJlZmVycmFsKHVpbnQ4OCBhbW91bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgY2FuRGVsZWdhdGUoKQogICAgewogICAgICAgIHJlcXVpcmUoYW1vdW50IDw9IGdldFJlZmVycmFsUG9vbCgpKTsKCiAgICAgICAgcmVmZXJyYWxQb29sIC09IGFtb3VudDsKICAgICAgICBSZWZlcnJhbFRva2Vuc0RlbGVnYXRlZChhbW91bnQpOwogICAgfQp9Ci8vLS0tLS0tLS8vCgppbnRlcmZhY2UgV2hpdGVsaXN0IHsKICAgIGZ1bmN0aW9uIGFkZChhZGRyZXNzIF93bEFkZHJlc3MpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGFkZEJ1bGsoYWRkcmVzc1tdIF93bEFkZHJlc3NlcykgcHVibGljOwogICAgZnVuY3Rpb24gcmVtb3ZlKGFkZHJlc3MgX3dsQWRkcmVzc2VzKSBwdWJsaWM7CiAgICBmdW5jdGlvbiByZW1vdmVCdWxrKGFkZHJlc3NbXSBfd2xBZGRyZXNzZXMpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGdldEFsbCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKGFkZHJlc3NbXSk7CiAgICBmdW5jdGlvbiBpc0luTGlzdChhZGRyZXNzIF9jaGVja0FkZHJlc3MpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKGJvb2wpOwp9CgppbnRlcmZhY2UgRVJDMjAgewogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50IF92YWx1ZSk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKTsKCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQgYmFsYW5jZSk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcmVtYWluaW5nKTsKfQoKY29udHJhY3QgRVJDMjBDb250cmFjdCBpcyBFUkMyMCB7CiAgICAvL1Rva2VuIHN5bWJvbAogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiVU5JVCI7CgogICAgLy9Ub2tlbiBuYW1lCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiVW5pbG90IHRva2VuIjsKCiAgICAvL0l0IGNhbiBiZSByZWVlZWFseSBzbWFsbAogICAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CgogICAgLy8gQmFsYW5jZXMgZm9yIGVhY2ggYWNjb3VudAogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQ5NikgcHVibGljIGJhbGFuY2VzOwoKICAgIC8vIE93bmVyIG9mIGFjY291bnQgYXBwcm92ZXMgdGhlIHRyYW5zZmVyIG9mIGFuIGFtb3VudCB0byBhbm90aGVyIGFjY291bnQKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQ5NikpIGFsbG93ZWQ7CgogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCk7CgoKICAgIC8vIFdoYXQgaXMgdGhlIGJhbGFuY2Ugb2YgYSBwYXJ0aWN1bGFyIGFjY291bnQ/CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50IGJhbGFuY2UpCiAgICB7CiAgICAgICAgcmV0dXJuIHVpbnQoYmFsYW5jZXNbX293bmVyXSk7CiAgICB9CgoKICAgIC8vIFRyYW5zZmVyIHRoZSBiYWxhbmNlIGZyb20gb3duZXIncyBhY2NvdW50IHRvIGFub3RoZXIgYWNjb3VudAogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX2Ftb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgICAgaWYgKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IF9hbW91bnQKICAgICAgICAgICAgJiYgX2Ftb3VudCA+IDAKICAgICAgICAgICAgJiYgYmFsYW5jZXNbX3RvXSArIF9hbW91bnQgPiBiYWxhbmNlc1tfdG9dKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdIC09IHVpbnQ5NihfYW1vdW50KTsKICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSArPSB1aW50OTYoX2Ftb3VudCk7CiAgICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX2Ftb3VudCk7CgogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQoKCiAgICAvLyBTZW5kIF92YWx1ZSBhbW91bnQgb2YgdG9rZW5zIGZyb20gYWRkcmVzcyBfZnJvbSB0byBhZGRyZXNzIF90bwogICAgLy8gVGhlIHRyYW5zZmVyRnJvbSBtZXRob2QgaXMgdXNlZCBmb3IgYSB3aXRoZHJhdyB3b3JrZmxvdywgYWxsb3dpbmcgY29udHJhY3RzIHRvIHNlbmQKICAgIC8vIHRva2VucyBvbiB5b3VyIGJlaGFsZiwgZm9yIGV4YW1wbGUgdG8gImRlcG9zaXQiIHRvIGEgY29udHJhY3QgYWRkcmVzcyBhbmQvb3IgdG8gY2hhcmdlCiAgICAvLyBmZWVzIGluIHN1Yi1jdXJyZW5jaWVzOyB0aGUgY29tbWFuZCBzaG91bGQgZmFpbCB1bmxlc3MgdGhlIF9mcm9tIGFjY291bnQgaGFzCiAgICAvLyBkZWxpYmVyYXRlbHkgYXV0aG9yaXplZCB0aGUgc2VuZGVyIG9mIHRoZSBtZXNzYWdlIHZpYSBzb21lIG1lY2hhbmlzbTsgd2UgcHJvcG9zZQogICAgLy8gdGhlc2Ugc3RhbmRhcmRpemVkIEFQSXMgZm9yIGFwcHJvdmFsOgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKAogICAgICAgIGFkZHJlc3MgX2Zyb20sCiAgICAgICAgYWRkcmVzcyBfdG8sCiAgICAgICAgdWludDI1NiBfYW1vdW50CiAgICApCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKQogICAgewogICAgICAgIGlmIChiYWxhbmNlc1tfZnJvbV0gPj0gX2Ftb3VudAogICAgICAgICAgICAmJiBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfYW1vdW50CiAgICAgICAgICAgICYmIF9hbW91bnQgPiAwCiAgICAgICAgICAgICYmIGJhbGFuY2VzW190b10gKyBfYW1vdW50ID4gYmFsYW5jZXNbX3RvXSkgewogICAgICAgICAgICBiYWxhbmNlc1tfZnJvbV0gLT0gdWludDk2KF9hbW91bnQpOwogICAgICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSB1aW50OTYoX2Ftb3VudCk7CiAgICAgICAgICAgIGJhbGFuY2VzW190b10gKz0gdWludDk2KF9hbW91bnQpOwogICAgICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfYW1vdW50KTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KCgogICAgLy8gQWxsb3cgX3NwZW5kZXIgdG8gd2l0aGRyYXcgZnJvbSB5b3VyIGFjY291bnQsIG11bHRpcGxlIHRpbWVzLCB1cCB0byB0aGUgX3ZhbHVlIGFtb3VudC4KICAgIC8vIElmIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGFnYWluIGl0IG92ZXJ3cml0ZXMgdGhlIGN1cnJlbnQgYWxsb3dhbmNlIHdpdGggX3ZhbHVlLgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hbW91bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKQogICAgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gdWludDk2KF9hbW91bnQpOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfYW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCgogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCByZW1haW5pbmcpCiAgICB7CiAgICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgICB9Cn0KCmNvbnRyYWN0IFVuaWxvdFRva2VuIGlzIEVSQzIwIHsKICAgIHN0cnVjdCBUb2tlblN0YWdlIHsKICAgICAgICBzdHJpbmcgbmFtZTsKICAgICAgICB1aW50IG51bUNvaW5zU3RhcnQ7CiAgICAgICAgdWludCBjb2luc0F2YWlsYWJsZTsKICAgICAgICB1aW50IGJvbnVzOwogICAgICAgIHVpbnQgc3RhcnRzQXQ7CiAgICAgICAgdWludCBlbmRzQXQ7CiAgICAgICAgdWludCBiYWxhbmNlOyAvL0Ftb3VudCBvZiBldGhlciBzZW50IGR1cmluZyB0aGlzIHN0YWdlCiAgICB9CgogICAgLy9Ub2tlbiBzeW1ib2wKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIlVOSVQiOwogICAgLy9Ub2tlbiBuYW1lCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiVW5pbG90IHRva2VuIjsKICAgIC8vSXQgY2FuIGJlIHJlZWVlYWx5IHNtYWxsCiAgICB1aW50OCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKCiAgICAvL1RoaXMgb25lIGR1cGxpY2F0ZXMgdGhlIGFib3ZlIGJ1dCB3aWxsIGhhdmUgdG8gdXNlIGl0IGJlY2F1c2Ugb2YKICAgIC8vc29saWRpdHkgYnVnIHdpdGggcG93ZXIgb3BlcmF0aW9uCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBhY2N1cmFjeSA9IDEwMDAwMDAwMDAwMDAwMDAwMDA7CgogICAgLy81MDAgbWxuIHRva2VucwogICAgdWludDI1NiBpbnRlcm5hbCBfdG90YWxTdXBwbHkgPSA1MDAgKiAoMTAqKjYpICogYWNjdXJhY3k7CgogICAgLy9QdWJsaWMgaW52ZXN0b3IgY2FuIGJ1eSB0b2tlbnMgZm9yIDMwIGV0aGVyIGF0IG1heGltdW0KICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IHNpbmdsZUludmVzdG9yQ2FwID0gMzAgZXRoZXI7IC8vMzAgZXRoZXIKCiAgICAvL0Rpc3RyaWJ1dGlvbiB1bml0cwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgRFNUX0lDTyAgICAgPSA2MjsgLy82MiUKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IERTVF9SRVNFUlZFID0gMTA7IC8vMTAlCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBEU1RfQk9VTlRZICA9IDM7ICAvLzMlCiAgICAvL1JlZmVycmFsIGFuZCBCb251cyBQcm9ncmFtCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBEU1RfUl9OX0JfUFJPR1JBTSA9IDEwOyAvLzEwJQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgRFNUX0FEVklTRVJTICAgICAgPSA1OyAgLy81JQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgRFNUX1RFQU0gICAgICAgICAgPSAxMDsgLy8xMCUKCiAgICAvL1JlZmVycmFsIEJvbnVzZXMKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFJFRkVSUkFMX0JPTlVTX0xFVkVMMSA9IDU7IC8vNSUKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFJFRkVSUkFMX0JPTlVTX0xFVkVMMiA9IDQ7IC8vNCUKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFJFRkVSUkFMX0JPTlVTX0xFVkVMMyA9IDM7IC8vMyUKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFJFRkVSUkFMX0JPTlVTX0xFVkVMNCA9IDI7IC8vMiUKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFJFRkVSUkFMX0JPTlVTX0xFVkVMNSA9IDE7IC8vMSUKCiAgICAvL1Rva2VuIGFtb3VudAogICAgLy8yNSBtbG4gdG9rZW5zCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBUT0tFTl9BTU9VTlRfUFJFX0lDTyA9IDI1ICogKDEwKio2KSAqIGFjY3VyYWN5OwogICAgLy81IG1sbiB0b2tlbnMKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFRPS0VOX0FNT1VOVF9JQ09fU1RBR0UxX1BSRV9TQUxFMSA9IDUgKiAoMTAqKjYpICogYWNjdXJhY3k7CiAgICAvLzUgbWxuIHRva2VucwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgVE9LRU5fQU1PVU5UX0lDT19TVEFHRTFfUFJFX1NBTEUyID0gNSAqICgxMCoqNikgKiBhY2N1cmFjeTsKICAgIC8vNSBtbG4gdG9rZW5zCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBUT0tFTl9BTU9VTlRfSUNPX1NUQUdFMV9QUkVfU0FMRTMgPSA1ICogKDEwKio2KSAqIGFjY3VyYWN5OwogICAgLy81IG1sbiB0b2tlbnMKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFRPS0VOX0FNT1VOVF9JQ09fU1RBR0UxX1BSRV9TQUxFNCA9IDUgKiAoMTAqKjYpICogYWNjdXJhY3k7CiAgICAvLzEyMi41IG1sbiB0b2tlbnMKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFRPS0VOX0FNT1VOVF9JQ09fU1RBR0UxX1BSRV9TQUxFNSA9IDEyMjUgKiAoMTAqKjUpICogYWNjdXJhY3k7CiAgICAvLzI2NSBtbG4gdG9rZW5zCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBUT0tFTl9BTU9VTlRfSUNPX1NUQUdFMiA9IDE0MjUgKiAoMTAqKjUpICogYWNjdXJhY3k7CgogICAgdWludCBwdWJsaWMgY29uc3RhbnQgQk9OVVNfUFJFX0lDTyA9IDQwOyAvLzQwJQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgQk9OVVNfSUNPX1NUQUdFMV9QUkVfU0FMRTEgPSAzNTsgLy8zNSUKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IEJPTlVTX0lDT19TVEFHRTFfUFJFX1NBTEUyID0gMzA7IC8vMzAlCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBCT05VU19JQ09fU1RBR0UxX1BSRV9TQUxFMyA9IDI1OyAvLzI1JQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgQk9OVVNfSUNPX1NUQUdFMV9QUkVfU0FMRTQgPSAyMDsgLy8yMCUKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IEJPTlVTX0lDT19TVEFHRTFfUFJFX1NBTEU1ID0gMDsgLy8wJQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgQk9OVVNfSUNPX1NUQUdFMiA9IDA7IC8vTm8gYm9udXMKCiAgICAvL1Rva2VuIFByaWNlIG9uIENvaW4gT2ZmZXIKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IHByaWNlID0gNzkgc3phYm87IC8vMC4wMDAwNzkgRVRICgogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgQURWSVNPUlNfV0FMTEVUID0gMHg3NzY2MDc5NUJEMzYxQ2Q0M2MzNjI3ZUFkYWQ0NGREYzIwMjZhRDE3OwogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgUkVTRVJWRV9XQUxMRVQgPSAweDczMUI0Nzg0NzM1MmZBMmNGZjgzRDUyNTFGRDZhNTI2NmY5MDg3OGQ7CiAgICBhZGRyZXNzIHB1YmxpYyBjb25zdGFudCBCT1VOVFlfV0FMTEVUID0gMHg3OTRFRjljNjgwYkREMGJFZjQ4QmVmNDZiQTY4NDcxZTQ0OUQ2N0ZiOwogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgUl9OX0RfV0FMTEVUID0gMHg3OTRFRjljNjgwYkREMGJFZjQ4QmVmNDZiQTY4NDcxZTQ0OUQ2N0ZiOwogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgU1RPUkFHRV9XQUxMRVQgPSAweEUyQThGMTQ3ZmM4MDg3MzhDYWIxNTJiMDFDNzI0NUYzODZmRDhkODk7CgogICAgLy8gT3duZXIgb2YgdGhpcyBjb250cmFjdAogICAgYWRkcmVzcyBwdWJsaWMgYWRtaW5pc3RyYXRvcjsKCiAgICAvLyBCYWxhbmNlcyBmb3IgZWFjaCBhY2NvdW50CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogICAgLy8gT3duZXIgb2YgYWNjb3VudCBhcHByb3ZlcyB0aGUgdHJhbnNmZXIgb2YgYW4gYW1vdW50IHRvIGFub3RoZXIgYWNjb3VudAogICAgbWFwcGluZyhhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CgogICAgLy9Nb3N0bHkgbmVlZGVkIGZvciBpbnRlcm5hbCB1c2UKICAgIHVpbnQyNTYgaW50ZXJuYWwgdG90YWxDb2luc0F2YWlsYWJsZTsKCiAgICAvL0FsbCB0b2tlbiBzdGFnZXMuIFRvdGFsIDYgc3RhZ2VzCiAgICBUb2tlblN0YWdlWzddIHN0YWdlczsKCiAgICAvL0luZGV4IG9mIGN1cnJlbnQgc3RhZ2UgaW4gc3RhZ2UgYXJyYXkKICAgIHVpbnQgY3VycmVudFN0YWdlOwoKICAgIC8vRW5hYmxlcyBvciBkaXNhYmxlcyBkZWJ1ZyBtb2RlLiBEZWJ1ZyBtb2RlIGlzIHNldCBvbmx5IGluIGNvbnN0cnVjdG9yLgogICAgYm9vbCBpc0RlYnVnID0gZmFsc2U7CgogICAgZXZlbnQgU3RhZ2VVcGRhdGVkKHN0cmluZyBmcm9tLCBzdHJpbmcgdG8pOwoKICAgIC8vIEZ1bmN0aW9ucyB3aXRoIHRoaXMgbW9kaWZpZXIgY2FuIG9ubHkgYmUgZXhlY3V0ZWQgYnkgdGhlIG93bmVyCiAgICBtb2RpZmllciBvbmx5QWRtaW5pc3RyYXRvcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYWRtaW5pc3RyYXRvcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBub3RBZG1pbmlzdHJhdG9yKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciAhPSBhZG1pbmlzdHJhdG9yKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlEdXJpbmdJQ08oKSB7CiAgICAgICAgcmVxdWlyZShjdXJyZW50U3RhZ2UgPCBzdGFnZXMubGVuZ3RoKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlBZnRlcklDTygpewogICAgICAgIHJlcXVpcmUoY3VycmVudFN0YWdlID49IHN0YWdlcy5sZW5ndGgpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgbWVldFRoZUNhcCgpIHsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSBwcmljZSk7IC8vIEF0IGxlYXN0IG9uZSB0b2tlbgogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgaXNGcmVlemVkUmVzZXJ2ZShhZGRyZXNzIF9hZGRyZXNzKSB7CiAgICAgICAgcmVxdWlyZSggKCBfYWRkcmVzcyA9PSBSRVNFUlZFX1dBTExFVCApICYmIG5vdyA+IChzdGFnZXNbIChzdGFnZXMubGVuZ3RoIC0gMSkgXS5lbmRzQXQgKyAxODIgZGF5cykpOwogICAgICAgIF87CiAgICB9CgogICAgLy8gQ29uc3RydWN0b3IKICAgIGZ1bmN0aW9uIFVuaWxvdFRva2VuKCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICBhZG1pbmlzdHJhdG9yID0gbXNnLnNlbmRlcjsKICAgICAgICB0b3RhbENvaW5zQXZhaWxhYmxlID0gX3RvdGFsU3VwcGx5OwogICAgICAgIC8vV2FzIGFzIGZuIHBhcmFtZXRlciBmb3IgZGVidWdnaW5nCiAgICAgICAgaXNEZWJ1ZyA9IHRydWU7CgogICAgICAgIF9zZXR1cFN0YWdlcygpOwogICAgICAgIF9wcm9jZWVkU3RhZ2UoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwcmVhbG9jYXRlQ29pbnMoKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yCiAgICB7CiAgICAgICAgdG90YWxDb2luc0F2YWlsYWJsZSAtPSBiYWxhbmNlc1tBRFZJU09SU19XQUxMRVRdICs9ICggKCBfdG90YWxTdXBwbHkgKiBEU1RfQURWSVNFUlMgKSAvIDEwMCApOwogICAgICAgIHRvdGFsQ29pbnNBdmFpbGFibGUgLT0gYmFsYW5jZXNbUkVTRVJWRV9XQUxMRVRdICs9ICggKCBfdG90YWxTdXBwbHkgKiBEU1RfUkVTRVJWRSApIC8gMTAwICk7CgogICAgICAgIGFkZHJlc3NbN10gbWVtb3J5IHRlYW1XYWxsZXRzID0gZ2V0VGVhbVdhbGxldHMoKTsKICAgICAgICB1aW50IHRlYW1TdXBwbHkgPSAoICggX3RvdGFsU3VwcGx5ICogRFNUX1RFQU0gKSAvIDEwMCApOwogICAgICAgIHVpbnQgbWVtYmVyQW1vdW50ID0gdGVhbVN1cHBseSAvIHRlYW1XYWxsZXRzLmxlbmd0aDsKCiAgICAgICAgZm9yKHVpbnQgaSA9IDA7IGkgPCB0ZWFtV2FsbGV0cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoIGkgPT0gKCB0ZWFtV2FsbGV0cy5sZW5ndGggLSAxICkgKSB7CiAgICAgICAgICAgICAgICBtZW1iZXJBbW91bnQgPSB0ZWFtU3VwcGx5OwogICAgICAgICAgICB9CgogICAgICAgICAgICBiYWxhbmNlc1t0ZWFtV2FsbGV0c1tpXV0gKz0gbWVtYmVyQW1vdW50OwogICAgICAgICAgICB0ZWFtU3VwcGx5IC09IG1lbWJlckFtb3VudDsKICAgICAgICAgICAgdG90YWxDb2luc0F2YWlsYWJsZSAtPSBtZW1iZXJBbW91bnQ7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGdldFRlYW1XYWxsZXRzKCkKICAgICAgICBwdWJsaWMKICAgICAgICBwdXJlCiAgICAgICAgcmV0dXJucyAoYWRkcmVzc1s3XSBtZW1vcnkgcmVzdWx0KQogICAgewogICAgICAgIHJlc3VsdFswXSA9IDB4NDBlM0Q4ZkZjNDZkNzNBYjVERjg3OEM3NTFEODEzYTRjQjdCMzg4RDsKICAgICAgICByZXN1bHRbMV0gPSAweDVFMDY1YTgwZjY2MzVCNmE0NjMyM2UzMzgzMDU3Y0U2MDUxYUFjQTA7CiAgICAgICAgcmVzdWx0WzJdID0gMHgwY0YzNTg1RmJBQjJhMTI5OUY4MzQ3YTlCODdDRjdCNGZjZENFNTk5OwogICAgICAgIHJlc3VsdFszXSA9IDB4NWZEZDNCQTVCNkZmMzQ5ZDMxZUIwYTcyQTk1M0U0NTRDOTk0OTRhQzsKICAgICAgICByZXN1bHRbNF0gPSAweEM5YmU5ODE4ZUUxQjJjQ2YyRTRmNjY5ZDI0ZUIwNzk4MzkwRmZiNTQ7CiAgICAgICAgcmVzdWx0WzVdID0gMHg3NzY2MDc5NUJEMzYxQ2Q0M2MzNjI3ZUFkYWQ0NGREYzIwMjZhRDE3OwogICAgICAgIHJlc3VsdFs2XSA9IDB4ZDEzMjg5MjAzODg5YkQ4OThkNDllMzFhMTUwMDM4ODQ0MUMwMzY2MzsKICAgIH0KCiAgICBmdW5jdGlvbiBfc2V0dXBTdGFnZXMoKQogICAgICAgIGludGVybmFsCiAgICB7CiAgICAgICAgLy9QcmVzYWxlIHN0YWdlCiAgICAgICAgc3RhZ2VzWzBdLm5hbWUgPSAnUHJlc2FsZSBzdGFnZSc7CiAgICAgICAgc3RhZ2VzWzBdLm51bUNvaW5zU3RhcnQgPSB0b3RhbENvaW5zQXZhaWxhYmxlOwogICAgICAgIHN0YWdlc1swXS5jb2luc0F2YWlsYWJsZSA9IFRPS0VOX0FNT1VOVF9QUkVfSUNPOwogICAgICAgIHN0YWdlc1swXS5ib251cyA9IEJPTlVTX1BSRV9JQ087CgogICAgICAgIGlmIChpc0RlYnVnKSB7CiAgICAgICAgICAgIHN0YWdlc1swXS5zdGFydHNBdCA9IG5vdzsKICAgICAgICAgICAgc3RhZ2VzWzBdLmVuZHNBdCA9IHN0YWdlc1swXS5zdGFydHNBdCArIDMwIHNlY29uZHM7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RhZ2VzWzBdLnN0YXJ0c0F0ID0gMTUxNTYxMDgwMDsgLy8xMHRoIG9mIEphbnVhcnkgMjAxOCBhdCAxOTowMFVUQwogICAgICAgICAgICBzdGFnZXNbMF0uZW5kc0F0ID0gMTUxODg5NDAwMDsgLy8xN3RoIG9mIEZlYnJ1YXJ5IDIwMTggYXQgMTk6MDBVVEMKICAgICAgICB9CgogICAgICAgIC8vSUNPIFN0YWdlIDEgcHJlLXNhbGUgMQogICAgICAgIHN0YWdlc1sxXS5uYW1lID0gJ0lDTyBTdGFnZSAxIHByZS1zYWxlIDEnOwogICAgICAgIHN0YWdlc1sxXS5jb2luc0F2YWlsYWJsZSA9IFRPS0VOX0FNT1VOVF9JQ09fU1RBR0UxX1BSRV9TQUxFMTsKICAgICAgICBzdGFnZXNbMV0uYm9udXMgPSBCT05VU19JQ09fU1RBR0UxX1BSRV9TQUxFMTsKCiAgICAgICAgaWYgKGlzRGVidWcpIHsKICAgICAgICAgICAgc3RhZ2VzWzFdLnN0YXJ0c0F0ID0gc3RhZ2VzWzBdLmVuZHNBdDsKICAgICAgICAgICAgc3RhZ2VzWzFdLmVuZHNBdCA9IHN0YWdlc1sxXS5zdGFydHNBdCArIDMwIHNlY29uZHM7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RhZ2VzWzFdLnN0YXJ0c0F0ID0gMTUxOTMyNjAwMDsgLy8yMnRoIG9mIEZlYnJ1YXJ5IDIwMTggYXQgMTk6MDBVVEMKICAgICAgICAgICAgc3RhZ2VzWzFdLmVuZHNBdCA9IDE1MjE3NDUyMDA7IC8vMjJ0aCBvZiBNYXJjaCAyMDE4IGF0IDE5OjAwVVRDCiAgICAgICAgfQoKICAgICAgICAvL0lDTyBTdGFnZSAxIHByZS1zYWxlIDIKICAgICAgICBzdGFnZXNbMl0ubmFtZSA9ICdJQ08gU3RhZ2UgMSBwcmUtc2FsZSAyJzsKICAgICAgICBzdGFnZXNbMl0uY29pbnNBdmFpbGFibGUgPSBUT0tFTl9BTU9VTlRfSUNPX1NUQUdFMV9QUkVfU0FMRTI7CiAgICAgICAgc3RhZ2VzWzJdLmJvbnVzID0gQk9OVVNfSUNPX1NUQUdFMV9QUkVfU0FMRTI7CgogICAgICAgIHN0YWdlc1syXS5zdGFydHNBdCA9IHN0YWdlc1sxXS5zdGFydHNBdDsKICAgICAgICBzdGFnZXNbMl0uZW5kc0F0ID0gc3RhZ2VzWzFdLmVuZHNBdDsKCiAgICAgICAgLy9JQ08gU3RhZ2UgMSBwcmUtc2FsZSAzCiAgICAgICAgc3RhZ2VzWzNdLm5hbWUgPSAnSUNPIFN0YWdlIDEgcHJlLXNhbGUgMyc7CiAgICAgICAgc3RhZ2VzWzNdLmNvaW5zQXZhaWxhYmxlID0gVE9LRU5fQU1PVU5UX0lDT19TVEFHRTFfUFJFX1NBTEUzOwogICAgICAgIHN0YWdlc1szXS5ib251cyA9IEJPTlVTX0lDT19TVEFHRTFfUFJFX1NBTEUzOwoKICAgICAgICBzdGFnZXNbM10uc3RhcnRzQXQgPSBzdGFnZXNbMV0uc3RhcnRzQXQ7CiAgICAgICAgc3RhZ2VzWzNdLmVuZHNBdCA9IHN0YWdlc1sxXS5lbmRzQXQ7CgogICAgICAgIC8vSUNPIFN0YWdlIDEgcHJlLXNhbGUgNAogICAgICAgIHN0YWdlc1s0XS5uYW1lID0gJ0lDTyBTdGFnZSAxIHByZS1zYWxlIDQnOwogICAgICAgIHN0YWdlc1s0XS5jb2luc0F2YWlsYWJsZSA9IFRPS0VOX0FNT1VOVF9JQ09fU1RBR0UxX1BSRV9TQUxFNDsKICAgICAgICBzdGFnZXNbNF0uYm9udXMgPSBCT05VU19JQ09fU1RBR0UxX1BSRV9TQUxFNDsKCiAgICAgICAgc3RhZ2VzWzRdLnN0YXJ0c0F0ID0gc3RhZ2VzWzFdLnN0YXJ0c0F0OwogICAgICAgIHN0YWdlc1s0XS5lbmRzQXQgPSBzdGFnZXNbMV0uZW5kc0F0OwoKICAgICAgICAvL0lDTyBTdGFnZSAxIHByZS1zYWxlIDUKICAgICAgICBzdGFnZXNbNV0ubmFtZSA9ICdJQ08gU3RhZ2UgMSBwcmUtc2FsZSA1JzsKICAgICAgICBzdGFnZXNbNV0uY29pbnNBdmFpbGFibGUgPSBUT0tFTl9BTU9VTlRfSUNPX1NUQUdFMV9QUkVfU0FMRTU7CiAgICAgICAgc3RhZ2VzWzVdLmJvbnVzID0gQk9OVVNfSUNPX1NUQUdFMV9QUkVfU0FMRTU7CgogICAgICAgIHN0YWdlc1s1XS5zdGFydHNBdCA9IHN0YWdlc1sxXS5zdGFydHNBdDsKICAgICAgICBzdGFnZXNbNV0uZW5kc0F0ID0gc3RhZ2VzWzFdLmVuZHNBdDsKCiAgICAgICAgLy9JQ08gU3RhZ2UgMgogICAgICAgIHN0YWdlc1s2XS5uYW1lID0gJ0lDTyBTdGFnZSAyJzsKICAgICAgICBzdGFnZXNbNl0uY29pbnNBdmFpbGFibGUgPSBUT0tFTl9BTU9VTlRfSUNPX1NUQUdFMjsKICAgICAgICBzdGFnZXNbNl0uYm9udXMgPSBCT05VU19JQ09fU1RBR0UyOwoKICAgICAgICBpZiAoaXNEZWJ1ZykgewogICAgICAgICAgICBzdGFnZXNbNl0uc3RhcnRzQXQgPSBzdGFnZXNbNV0uZW5kc0F0OwogICAgICAgICAgICBzdGFnZXNbNl0uZW5kc0F0ID0gc3RhZ2VzWzZdLnN0YXJ0c0F0ICsgMzAgc2Vjb25kczsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzdGFnZXNbNl0uc3RhcnRzQXQgPSAxNTI0MjUwODAwOyAvLzIwdGggb2YgQXByaWwgMjAxOCBhdCAxOTowMFVUQwogICAgICAgICAgICBzdGFnZXNbNl0uZW5kc0F0ID0gMTUyNjg0MjgwMDsgLy8yMHRoIG9mIE1heSAyMDE4IGF0IDE5OjAwVVRDCiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIF9wcm9jZWVkU3RhZ2UoKQogICAgICAgIGludGVybmFsCiAgICB7CiAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAgICAgaWYgKCBjdXJyZW50U3RhZ2UgPCBzdGFnZXMubGVuZ3RoCiAgICAgICAgICAgICYmIChub3cgPj0gc3RhZ2VzW2N1cnJlbnRTdGFnZV0uZW5kc0F0IHx8IGdldEF2YWlsYWJsZUNvaW5zRm9yQ3VycmVudFN0YWdlKCkgPT0gMCkgKSB7CiAgICAgICAgICAgICAgICBjdXJyZW50U3RhZ2UrKzsKICAgICAgICAgICAgICAgIHVpbnQgdG90YWxUb2tlbnNGb3JTYWxlID0gVE9LRU5fQU1PVU5UX1BSRV9JQ08KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBUT0tFTl9BTU9VTlRfSUNPX1NUQUdFMV9QUkVfU0FMRTEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBUT0tFTl9BTU9VTlRfSUNPX1NUQUdFMV9QUkVfU0FMRTIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBUT0tFTl9BTU9VTlRfSUNPX1NUQUdFMV9QUkVfU0FMRTMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBUT0tFTl9BTU9VTlRfSUNPX1NUQUdFMV9QUkVfU0FMRTQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBUT0tFTl9BTU9VTlRfSUNPX1NUQUdFMjsKCiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFN0YWdlID49IHN0YWdlcy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICAvL0J1cm5pbmcgYWxsIHVuc29sZCB0b2tlbnMgYW5kIHByb3BvcnRpb25hbGx5IG90aGVyIGZvciBkZWxpZ2F0aW9uCiAgICAgICAgICAgICAgICAgICAgX3RvdGFsU3VwcGx5IC09ICggKCAoIHN0YWdlc1soc3RhZ2VzLmxlbmd0aCAtIDEpXS5jb2luc0F2YWlsYWJsZSAqIERTVF9CT1VOVFkgKSAvIDEwMCApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgKCAoIHN0YWdlc1soc3RhZ2VzLmxlbmd0aCAtIDEpXS5jb2luc0F2YWlsYWJsZSAqIERTVF9SX05fQl9QUk9HUkFNICkgLyAxMDAgKSApOwoKICAgICAgICAgICAgICAgICAgICBiYWxhbmNlc1tCT1VOVFlfV0FMTEVUXSA9ICgoKHRvdGFsVG9rZW5zRm9yU2FsZSAtIHN0YWdlc1soc3RhZ2VzLmxlbmd0aCAtIDEpXS5jb2luc0F2YWlsYWJsZSkgKiBEU1RfQk9VTlRZKS8xMDApOwogICAgICAgICAgICAgICAgICAgIGJhbGFuY2VzW1JfTl9EX1dBTExFVF0gPSAoKCh0b3RhbFRva2Vuc0ZvclNhbGUgLSBzdGFnZXNbKHN0YWdlcy5sZW5ndGggLSAxKV0uY29pbnNBdmFpbGFibGUpICogRFNUX1JfTl9CX1BST0dSQU0pLzEwMCk7CgogICAgICAgICAgICAgICAgICAgIHRvdGFsQ29pbnNBdmFpbGFibGUgPSAwOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOyAvL0lDTyBlbmRlZAogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHN0YWdlc1tjdXJyZW50U3RhZ2VdLm51bUNvaW5zU3RhcnQgPSB0b3RhbENvaW5zQXZhaWxhYmxlOwoKICAgICAgICAgICAgICAgIGlmICggY3VycmVudFN0YWdlID4gMCApIHsKICAgICAgICAgICAgICAgICAgICAvL01vdmUgYWxsIGxlZnQgdG9rZW5zIHRvIGxhc3Qgc3RhZ2UKICAgICAgICAgICAgICAgICAgICBzdGFnZXNbKHN0YWdlcy5sZW5ndGggLSAxKV0uY29pbnNBdmFpbGFibGUgKz0gc3RhZ2VzWyAoY3VycmVudFN0YWdlIC0gMSApIF0uY29pbnNBdmFpbGFibGU7CiAgICAgICAgICAgICAgICAgICAgU3RhZ2VVcGRhdGVkKHN0YWdlc1tjdXJyZW50U3RhZ2UgLSAxXS5uYW1lLCBzdGFnZXNbY3VycmVudFN0YWdlXS5uYW1lKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGdldFRvdGFsQ29pbnNBdmFpbGFibGUoKQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zKHVpbnQpCiAgICB7CiAgICAgICAgcmV0dXJuIHRvdGFsQ29pbnNBdmFpbGFibGU7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QXZhaWxhYmxlQ29pbnNGb3JDdXJyZW50U3RhZ2UoKQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zKHVpbnQpCiAgICB7CiAgICAgICAgVG9rZW5TdGFnZSBtZW1vcnkgc3RhZ2UgPSBzdGFnZXNbY3VycmVudFN0YWdlXTsKCiAgICAgICAgcmV0dXJuIHN0YWdlLmNvaW5zQXZhaWxhYmxlOwogICAgfQoKICAgIC8vLS0tLS0tLS0tLS0tLSBFUkMyMCBtZXRob2RzIC0tLS0tLS0tLS0tLS0vLwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludDI1NikKICAgIHsKICAgICAgICByZXR1cm4gX3RvdGFsU3VwcGx5OwogICAgfQoKCiAgICAvLyBXaGF0IGlzIHRoZSBiYWxhbmNlIG9mIGEgcGFydGljdWxhciBhY2NvdW50PwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKQogICAgewogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogICAgfQoKCiAgICAvLyBUcmFuc2ZlciB0aGUgYmFsYW5jZSBmcm9tIG93bmVyJ3MgYWNjb3VudCB0byBhbm90aGVyIGFjY291bnQKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seUFmdGVySUNPCiAgICAgICAgaXNGcmVlemVkUmVzZXJ2ZShfdG8pCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKQogICAgewogICAgICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfYW1vdW50CiAgICAgICAgICAgICYmIF9hbW91bnQgPiAwCiAgICAgICAgICAgICYmIGJhbGFuY2VzW190b10gKyBfYW1vdW50ID4gYmFsYW5jZXNbX3RvXSkgewogICAgICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSBfYW1vdW50OwogICAgICAgICAgICBiYWxhbmNlc1tfdG9dICs9IF9hbW91bnQ7CiAgICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX2Ftb3VudCk7CgogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQoKCiAgICAvLyBTZW5kIF92YWx1ZSBhbW91bnQgb2YgdG9rZW5zIGZyb20gYWRkcmVzcyBfZnJvbSB0byBhZGRyZXNzIF90bwogICAgLy8gVGhlIHRyYW5zZmVyRnJvbSBtZXRob2QgaXMgdXNlZCBmb3IgYSB3aXRoZHJhdyB3b3JrZmxvdywgYWxsb3dpbmcgY29udHJhY3RzIHRvIHNlbmQKICAgIC8vIHRva2VucyBvbiB5b3VyIGJlaGFsZiwgZm9yIGV4YW1wbGUgdG8gImRlcG9zaXQiIHRvIGEgY29udHJhY3QgYWRkcmVzcyBhbmQvb3IgdG8gY2hhcmdlCiAgICAvLyBmZWVzIGluIHN1Yi1jdXJyZW5jaWVzOyB0aGUgY29tbWFuZCBzaG91bGQgZmFpbCB1bmxlc3MgdGhlIF9mcm9tIGFjY291bnQgaGFzCiAgICAvLyBkZWxpYmVyYXRlbHkgYXV0aG9yaXplZCB0aGUgc2VuZGVyIG9mIHRoZSBtZXNzYWdlIHZpYSBzb21lIG1lY2hhbmlzbTsgd2UgcHJvcG9zZQogICAgLy8gdGhlc2Ugc3RhbmRhcmRpemVkIEFQSXMgZm9yIGFwcHJvdmFsOgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKAogICAgICAgIGFkZHJlc3MgX2Zyb20sCiAgICAgICAgYWRkcmVzcyBfdG8sCiAgICAgICAgdWludDI1NiBfYW1vdW50CiAgICApCiAgICAgICAgcHVibGljCiAgICAgICAgb25seUFmdGVySUNPCiAgICAgICAgaXNGcmVlemVkUmVzZXJ2ZShfZnJvbSkKICAgICAgICBpc0ZyZWV6ZWRSZXNlcnZlKF90bykKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgICAgaWYgKGJhbGFuY2VzW19mcm9tXSA+PSBfYW1vdW50CiAgICAgICAgICAgICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF9hbW91bnQKICAgICAgICAgICAgJiYgX2Ftb3VudCA+IDAKICAgICAgICAgICAgJiYgYmFsYW5jZXNbX3RvXSArIF9hbW91bnQgPiBiYWxhbmNlc1tfdG9dKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW19mcm9tXSAtPSBfYW1vdW50OwogICAgICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfYW1vdW50OwogICAgICAgICAgICBiYWxhbmNlc1tfdG9dICs9IF9hbW91bnQ7CiAgICAgICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF9hbW91bnQpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQoKCiAgICAvLyBBbGxvdyBfc3BlbmRlciB0byB3aXRoZHJhdyBmcm9tIHlvdXIgYWNjb3VudCwgbXVsdGlwbGUgdGltZXMsIHVwIHRvIHRoZSBfdmFsdWUgYW1vdW50LgogICAgLy8gSWYgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgYWdhaW4gaXQgb3ZlcndyaXRlcyB0aGUgY3VycmVudCBhbGxvd2FuY2Ugd2l0aCBfdmFsdWUuCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX2Ftb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5QWZ0ZXJJQ08KICAgICAgICBpc0ZyZWV6ZWRSZXNlcnZlKF9zcGVuZGVyKQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF9hbW91bnQ7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF9hbW91bnQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykKICAgIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KICAgIC8vLS0tLS0tLS0tLS0tLSBFUkMyMCBNZXRob2RzIEVORCAtLS0tLS0tLS0tLS0tLy8KCiAgICAvL1JldHVybnMgYm9udXMgZm9yIGNlcnRhaW4gbGV2ZWwgb2YgcmVmZXJlbmNlCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVSZWZlcnJhbEJvbnVzKHVpbnQgYW1vdW50LCB1aW50IGxldmVsKQogICAgICAgIHB1YmxpYwogICAgICAgIHB1cmUKICAgICAgICByZXR1cm5zICh1aW50IGJvbnVzKQogICAgewogICAgICAgIGJvbnVzID0gMDsKCiAgICAgICAgaWYgKCBsZXZlbCA9PSAxICkgewogICAgICAgICAgICBib251cyA9ICggKCBhbW91bnQgKiBSRUZFUlJBTF9CT05VU19MRVZFTDEgKSAvIDEwMCApOwogICAgICAgIH0gZWxzZSBpZiAobGV2ZWwgPT0gMikgewogICAgICAgICAgICBib251cyA9ICggKCBhbW91bnQgKiBSRUZFUlJBTF9CT05VU19MRVZFTDIgKSAvIDEwMCApOwogICAgICAgIH0gZWxzZSBpZiAobGV2ZWwgPT0gMykgewogICAgICAgICAgICBib251cyA9ICggKCBhbW91bnQgKiBSRUZFUlJBTF9CT05VU19MRVZFTDMgKSAvIDEwMCApOwogICAgICAgIH0gZWxzZSBpZiAobGV2ZWwgPT0gNCkgewogICAgICAgICAgICBib251cyA9ICggKCBhbW91bnQgKiBSRUZFUlJBTF9CT05VU19MRVZFTDQgKSAvIDEwMCApOwogICAgICAgIH0gZWxzZSBpZiAobGV2ZWwgPT0gNSkgewogICAgICAgICAgICBib251cyA9ICggKCBhbW91bnQgKiBSRUZFUlJBTF9CT05VU19MRVZFTDUgKSAvIDEwMCApOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVCb251cyh1aW50IGFtb3VudE9mVG9rZW5zKQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zICh1aW50KQogICAgewogICAgICAgIHJldHVybiAoICggc3RhZ2VzW2N1cnJlbnRTdGFnZV0uYm9udXMgKiBhbW91bnRPZlRva2VucyApIC8gMTAwICk7CiAgICB9CgogICAgZXZlbnQgVG9rZW5QdXJjaGFzZWQoc3RyaW5nIHN0YWdlLCB1aW50IHZhbHVlU3VibWl0dGVkLCB1aW50IHZhbHVlUmVmdW5kZWQsIHVpbnQgdG9rZW5zUHVyY2hhc2VkKTsKCiAgICBmdW5jdGlvbiAoKQogICAgICAgIHB1YmxpYwogICAgICAgIHBheWFibGUKICAgICAgICBub3RBZG1pbmlzdHJhdG9yCiAgICAgICAgb25seUR1cmluZ0lDTwogICAgICAgIG1lZXRUaGVDYXAKICAgIHsKICAgICAgICBfcHJvY2VlZFN0YWdlKCk7CiAgICAgICAgcmVxdWlyZShjdXJyZW50U3RhZ2UgPCBzdGFnZXMubGVuZ3RoKTsKICAgICAgICByZXF1aXJlKHN0YWdlc1tjdXJyZW50U3RhZ2VdLnN0YXJ0c0F0IDw9IG5vdyAmJiBub3cgPCBzdGFnZXNbY3VycmVudFN0YWdlXS5lbmRzQXQpOwogICAgICAgIHJlcXVpcmUoZ2V0QXZhaWxhYmxlQ29pbnNGb3JDdXJyZW50U3RhZ2UoKSA+IDApOwoKICAgICAgICB1aW50IHJlcXVlc3RlZEFtb3VudE9mVG9rZW5zID0gKCAoIG1zZy52YWx1ZSAqIGFjY3VyYWN5ICkgLyBwcmljZSApOwogICAgICAgIHVpbnQgYW1vdW50VG9CdXkgPSByZXF1ZXN0ZWRBbW91bnRPZlRva2VuczsKICAgICAgICB1aW50IHJlZnVuZCA9IDA7CgogICAgICAgIGlmICggYW1vdW50VG9CdXkgPiBnZXRBdmFpbGFibGVDb2luc0ZvckN1cnJlbnRTdGFnZSgpICkgewogICAgICAgICAgICBhbW91bnRUb0J1eSA9IGdldEF2YWlsYWJsZUNvaW5zRm9yQ3VycmVudFN0YWdlKCk7CiAgICAgICAgICAgIHJlZnVuZCA9ICggKCAocmVxdWVzdGVkQW1vdW50T2ZUb2tlbnMgLSBhbW91bnRUb0J1eSkgLyBhY2N1cmFjeSApICogcHJpY2UgKTsKCiAgICAgICAgICAgIC8vIFJldHVybmluZyBFVEgKICAgICAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlciggcmVmdW5kICk7CiAgICAgICAgfQoKICAgICAgICBUb2tlblB1cmNoYXNlZChzdGFnZXNbY3VycmVudFN0YWdlXS5uYW1lLCBtc2cudmFsdWUsIHJlZnVuZCwgYW1vdW50VG9CdXkpOwogICAgICAgIHN0YWdlc1tjdXJyZW50U3RhZ2VdLmNvaW5zQXZhaWxhYmxlIC09IGFtb3VudFRvQnV5OwogICAgICAgIHN0YWdlc1tjdXJyZW50U3RhZ2VdLmJhbGFuY2UgKz0gKG1zZy52YWx1ZSAtIHJlZnVuZCk7CgogICAgICAgIHVpbnQgYW1vdW50RGVsaXZlcmVkID0gYW1vdW50VG9CdXkgKyBjYWxjdWxhdGVCb251cyhhbW91bnRUb0J1eSk7CgogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdICs9IGFtb3VudERlbGl2ZXJlZDsKICAgICAgICB0b3RhbENvaW5zQXZhaWxhYmxlIC09IGFtb3VudERlbGl2ZXJlZDsKCiAgICAgICAgaWYgKCBnZXRBdmFpbGFibGVDb2luc0ZvckN1cnJlbnRTdGFnZSgpID09IDAgKSB7CiAgICAgICAgICAgIF9wcm9jZWVkU3RhZ2UoKTsKICAgICAgICB9CgogICAgICAgIFNUT1JBR0VfV0FMTEVULnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgICB9CgogICAgLy9JdCBkb2Vzbid0IHJlYWxseSBjbG9zZSB0aGUgc3RhZ2UKICAgIC8vSXQganVzdCBuZWVkZWQgdG8gcHVzaCB0cmFuc2FjdGlvbiB0byB1cGRhdGUgc3RhZ2UgYW5kIHVwZGF0ZSBibG9jay5ub3cKICAgIGZ1bmN0aW9uIGNsb3NlU3RhZ2UoKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yCiAgICB7CiAgICAgICAgX3Byb2NlZWRTdGFnZSgpOwogICAgfQp9Cgpjb250cmFjdCBVTklUdjIgaXMgRVJDMjBDb250cmFjdCxBZG1pbmlzdHJhdGVkIHsKICAgIC8vVG9rZW4gc3ltYm9sCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJVTklUIjsKICAgIC8vVG9rZW4gbmFtZQogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIlVuaWxvdCB0b2tlbiI7CiAgICAvL0l0IGNhbiBiZSByZWVlZWFseSBzbWFsbAogICAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CgogICAgLy9Ub3RhbCBzdXBwbHkgNTAwbWxuIGluIHRoZSBzdGFydAogICAgdWludDk2IHB1YmxpYyBfdG90YWxTdXBwbHkgPSB1aW50OTYoNTAwMDAwMDAwICogKDEwKioxOCkpOwoKICAgIFVuaWxvdFRva2VuIHB1YmxpYyBzb3VyY2VUb2tlbjsKCiAgICBXaGl0ZWxpc3QgcHVibGljIHRyYW5zZmVyV2hpdGVMaXN0OwoKICAgIFdoaXRlbGlzdCBwdWJsaWMgcGF5bWVudEdhdGV3YXlzOwoKICAgIFRva2VuU3RhZ2VzTWFuYWdlciBwdWJsaWMgc3RhZ2VzTWFuYWdlcjsKCiAgICBib29sIHB1YmxpYyB1bmxvY2tlZCA9IGZhbHNlOwoKICAgIGJvb2wgcHVibGljIGJ1cm5lZCA9IGZhbHNlOwoKICAgIC8vdG9rZW5JbXBvcnRbdG9rZW5Ib2xkZXJdW3NvdXJjZVRva2VuXSA9IHRydWUvZmFsc2U7CiAgICBtYXBwaW5nICggYWRkcmVzcyA9PiBtYXBwaW5nICggYWRkcmVzcyA9PiBib29sICkgKSBwdWJsaWMgdG9rZW5JbXBvcnQ7CgogICAgZXZlbnQgVG9rZW5zSW1wb3J0ZWQoYWRkcmVzcyBpbmRleGVkIHRva2VuSG9sZGVyLCB1aW50OTYgYW1vdW50LCBhZGRyZXNzIGluZGV4ZWQgc291cmNlKTsKICAgIGV2ZW50IFRva2Vuc0RlbGVnYXRlZChhZGRyZXNzIGluZGV4ZWQgdG9rZW5Ib2xkZXIsIHVpbnQ5NiBhbW91bnQsIGFkZHJlc3MgaW5kZXhlZCBzb3VyY2UpOwogICAgZXZlbnQgVW5sb2NrZWQoKTsKICAgIGV2ZW50IEJ1cm5lZCh1aW50OTYgYW1vdW50KTsKCiAgICBtb2RpZmllciBpc0xvY2tlZCgpIHsKICAgICAgICByZXF1aXJlKHVubG9ja2VkID09IGZhbHNlKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIGlzTm90QnVybmVkKCkgewogICAgICAgIHJlcXVpcmUoYnVybmVkID09IGZhbHNlKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIGlzVHJhbnNmZXJBbGxvd2VkKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvKSB7CiAgICAgICAgaWYgKCBzb3VyY2VUb2tlbi5SRVNFUlZFX1dBTExFVCgpID09IF9mcm9tICkgewogICAgICAgICAgICByZXF1aXJlKCBzdGFnZXNNYW5hZ2VyLmlzRnJlZXplVGltZW91dCgpICk7CiAgICAgICAgfQogICAgICAgIHJlcXVpcmUodW5sb2NrZWQKICAgICAgICAgICAgICAgIHx8ICggc3RhZ2VzTWFuYWdlciAhPSBhZGRyZXNzKDApICYmIHN0YWdlc01hbmFnZXIuaXNDYW5MaXN0KCkgKQogICAgICAgICAgICAgICAgfHwgKCB0cmFuc2ZlcldoaXRlTGlzdCAhPSBhZGRyZXNzKDApICYmICggdHJhbnNmZXJXaGl0ZUxpc3QuaXNJbkxpc3QoX2Zyb20pIHx8IHRyYW5zZmVyV2hpdGVMaXN0LmlzSW5MaXN0KF90bykgKSApCiAgICAgICAgKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIFVOSVR2MihhZGRyZXNzIF9zb3VyY2VUb2tlbikKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICBzZXRBZG1pbmlzdHJhdG9yKHR4Lm9yaWdpbik7CiAgICAgICAgc291cmNlVG9rZW4gPSBVbmlsb3RUb2tlbihfc291cmNlVG9rZW4pOwoKICAgICAgICAvKlRyYW5zYWN0aW9uczoKICAgICAgICAweDk5YzI4Njc1YWRiZDBkMGNiN2JkNzgzYWUxOTc0OTIwNzhkNDA2M2Y0MGMxMTEzOWRkMDdjMDE1YTU0M2ZmY2MKICAgICAgICAweDg2MDM4ZDExZWU4ZGE0NjcwMzMwOWQyZmI0NWQxNTBmMWRjNGUyYmJhNmQwYThmZWUxNTgwMTYxMTExMDRmZjEKICAgICAgICAweDAzNDBhOGEyZmI4OTUxM2MwMDg2YTM0NTk3MzQ3MGI3YmMzMzQyNGU4MThjYTZhMzJkY2Y5YWQ2NmJmOWQ3NWMKICAgICAgICAqLwogICAgICAgIGJhbGFuY2VzWzB4ZDEzMjg5MjAzODg5YkQ4OThkNDllMzFhMTUwMDM4ODQ0MUMwMzY2M10gKz0gMTQwMDAwMDAwMDAwMDAwMDAwMCAqIDM7CiAgICAgICAgbWFya0FzSW1wb3J0ZWQoMHhkQkY5OGRGNURBZDkwNzdmNDU3ZTFkY2Y4NUFhOTQyMEJjQThCNzYxLCAweGQxMzI4OTIwMzg4OWJEODk4ZDQ5ZTMxYTE1MDAzODg0NDFDMDM2NjMpOwoKICAgICAgICAvL1R4OiAweGVjOWI3YjRjMGYxNDM1MjgyZTJlOThhNjZlZmJkNzYxMGRlN2VhY2NlM2IyNDQ4Y2Q1ZjUwM2Q3MGE2NGE4OTUKICAgICAgICBiYWxhbmNlc1sweEUzMzMwNUIyRUZiY0IzMDJEQTUxM0MzODY3MUQwMTY0NjY1MWE4NjhdICs9IDE0MDAwMDAwMDAwMDAwMDAwMDA7CiAgICAgICAgbWFya0FzSW1wb3J0ZWQoMHhkQkY5OGRGNURBZDkwNzdmNDU3ZTFkY2Y4NUFhOTQyMEJjQThCNzYxLCAweEUzMzMwNUIyRUZiY0IzMDJEQTUxM0MzODY3MUQwMTY0NjY1MWE4NjgpOwoKICAgICAgICAvL0Fzc2lnbmluZyBib3VudHkKICAgICAgICBiYWxhbmNlc1sweDc5NEVGOWM2ODBiREQwYkVmNDhCZWY0NmJBNjg0NzFlNDQ5RDY3RmJdICs9IHVpbnQ5NigKICAgICAgICAgICAgKCB1aW50KF90b3RhbFN1cHBseSkgKiB1aW50OCggc291cmNlVG9rZW4uRFNUX0JPVU5UWSgpICkgKSAvIDEwMAogICAgICAgICk7CgogICAgICAgIC8vRG9uJ3QgaW1wb3J0IGJvdW50eSBhbmQgUiZCIHRva2VucwogICAgICAgIG1hcmtBc0ltcG9ydGVkKDB4ZEJGOThkRjVEQWQ5MDc3ZjQ1N2UxZGNmODVBYTk0MjBCY0E4Qjc2MSwgMHg3OTRFRjljNjgwYkREMGJFZjQ4QmVmNDZiQTY4NDcxZTQ0OUQ2N0ZiKTsKICAgICAgICBtYXJrQXNJbXBvcnRlZChzb3VyY2VUb2tlbiwgMHg3OTRFRjljNjgwYkREMGJFZjQ4QmVmNDZiQTY4NDcxZTQ0OUQ2N0ZiKTsKCiAgICAgICAgbWFya0FzSW1wb3J0ZWQoMHhkQkY5OGRGNURBZDkwNzdmNDU3ZTFkY2Y4NUFhOTQyMEJjQThCNzYxLCAweDkxRDc0MEQ4N0E4QWVFRDFmYzNFQTNDMzQ2ODQzMTczYzUyOUQ2M2UpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFRyYW5zZmVyV2hpdGVsaXN0KGFkZHJlc3Mgd2hpdGVMaXN0QWRkcmVzcykKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5QWRtaW5pc3RyYXRvcgogICAgICAgIGlzTm90QnVybmVkCiAgICB7CiAgICAgICAgdHJhbnNmZXJXaGl0ZUxpc3QgPSBXaGl0ZWxpc3Qod2hpdGVMaXN0QWRkcmVzcyk7CiAgICB9CgogICAgZnVuY3Rpb24gZGlzYWJsZVRyYW5zZmVyV2hpdGVsaXN0KCkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5QWRtaW5pc3RyYXRvcgogICAgICAgIGlzTm90QnVybmVkCiAgICB7CiAgICAgICAgdHJhbnNmZXJXaGl0ZUxpc3QgPSBXaGl0ZWxpc3QoYWRkcmVzcygwKSk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0U3RhZ2VzTWFuYWdlcihhZGRyZXNzIHN0YWdlc01hbmFnZXJDb250cmFjdCkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5QWRtaW5pc3RyYXRvcgogICAgICAgIGlzTm90QnVybmVkCiAgICB7CiAgICAgICAgc3RhZ2VzTWFuYWdlciA9IFRva2VuU3RhZ2VzTWFuYWdlcihzdGFnZXNNYW5hZ2VyQ29udHJhY3QpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFBheW1lbnRHYXRld2F5TGlzdChhZGRyZXNzIHBheW1lbnRHYXRld2F5TGlzdENvbnRyYWN0KQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yCiAgICAgICAgaXNOb3RCdXJuZWQKICAgIHsKICAgICAgICBwYXltZW50R2F0ZXdheXMgPSBXaGl0ZWxpc3QocGF5bWVudEdhdGV3YXlMaXN0Q29udHJhY3QpOwogICAgfQoKICAgIC8vU1RBUlQgSW1wb3J0IHJlbGF0ZWQgbWV0aG9kcwogICAgZnVuY3Rpb24gaXNJbXBvcnRlZChhZGRyZXNzIF9zb3VyY2VUb2tlbiwgYWRkcmVzcyBfdG9rZW5Ib2xkZXIpCiAgICAgICAgaW50ZXJuYWwKICAgICAgICBjb25zdGFudAogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmV0dXJuIHRva2VuSW1wb3J0W190b2tlbkhvbGRlcl1bX3NvdXJjZVRva2VuXTsKICAgIH0KCiAgICBmdW5jdGlvbiBtYXJrQXNJbXBvcnRlZChhZGRyZXNzIF9zb3VyY2VUb2tlbiwgYWRkcmVzcyBfdG9rZW5Ib2xkZXIpCiAgICAgICAgaW50ZXJuYWwKICAgIHsKICAgICAgICB0b2tlbkltcG9ydFtfdG9rZW5Ib2xkZXJdW19zb3VyY2VUb2tlbl0gPSB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGltcG9ydEZyb21Tb3VyY2UoRVJDMjAgX3NvdXJjZVRva2VuLCBhZGRyZXNzIF90b2tlbkhvbGRlcikKICAgICAgICBpbnRlcm5hbAogICAgewogICAgICAgIGlmICggIWlzSW1wb3J0ZWQoX3NvdXJjZVRva2VuLCBfdG9rZW5Ib2xkZXIpICkgewogICAgICAgICAgICB1aW50OTYgb2xkQmFsYW5jZSA9IHVpbnQ5Nihfc291cmNlVG9rZW4uYmFsYW5jZU9mKF90b2tlbkhvbGRlcikpOwogICAgICAgICAgICBiYWxhbmNlc1tfdG9rZW5Ib2xkZXJdICs9IG9sZEJhbGFuY2U7CiAgICAgICAgICAgIG1hcmtBc0ltcG9ydGVkKF9zb3VyY2VUb2tlbiwgX3Rva2VuSG9sZGVyKTsKCiAgICAgICAgICAgIFRva2Vuc0ltcG9ydGVkKF90b2tlbkhvbGRlciwgb2xkQmFsYW5jZSwgX3NvdXJjZVRva2VuKTsKICAgICAgICB9CiAgICB9CgogICAgLy9JbXBvcnRzIGZyb20gc291cmNlIHRva2VuCiAgICBmdW5jdGlvbiBpbXBvcnRUb2tlbnNGcm9tU291cmNlVG9rZW4oYWRkcmVzcyBfdG9rZW5Ib2xkZXIpCiAgICAgICAgaW50ZXJuYWwKICAgIHsKICAgICAgICBpbXBvcnRGcm9tU291cmNlKEVSQzIwKHNvdXJjZVRva2VuKSwgX3Rva2VuSG9sZGVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBpbXBvcnRGcm9tRXh0ZXJuYWwoRVJDMjAgX3NvdXJjZVRva2VuLCBhZGRyZXNzIF90b2tlbkhvbGRlcikKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5QWRtaW5pc3RyYXRvcgogICAgICAgIGlzTm90QnVybmVkCiAgICB7CiAgICAgICAgcmV0dXJuIGltcG9ydEZyb21Tb3VyY2UoX3NvdXJjZVRva2VuLCBfdG9rZW5Ib2xkZXIpOwogICAgfQoKICAgIC8vSW1wb3J0cyBmcm9tIHByb3ZpZGVkIHRva2VuCiAgICBmdW5jdGlvbiBpbXBvcnRUb2tlbnNTb3VyY2VCdWxrKEVSQzIwIF9zb3VyY2VUb2tlbiwgYWRkcmVzc1tdIF90b2tlbkhvbGRlcnMpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IKICAgICAgICBpc05vdEJ1cm5lZAogICAgewogICAgICAgIHJlcXVpcmUoX3Rva2VuSG9sZGVycy5sZW5ndGggPD0gMjU2KTsKCiAgICAgICAgZm9yICh1aW50OCBpID0gMDsgaSA8IF90b2tlbkhvbGRlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaW1wb3J0RnJvbVNvdXJjZShfc291cmNlVG9rZW4sIF90b2tlbkhvbGRlcnNbaV0pOwogICAgICAgIH0KICAgIH0KICAgIC8vRU5EIEltcG9ydCByZWxhdGVkIG1ldGhvZHMKCiAgICAvL1NUQVJUIEVSQzIwCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpCiAgICAgICAgcHVibGljCiAgICAgICAgY29uc3RhbnQKICAgICAgICByZXR1cm5zICh1aW50KQogICAgewogICAgICAgIHJldHVybiB1aW50KF90b3RhbFN1cHBseSk7CiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKQogICAgICAgIHB1YmxpYwogICAgICAgIGNvbnN0YW50CiAgICAgICAgcmV0dXJucyAodWludCBiYWxhbmNlKQogICAgewogICAgICAgIGJhbGFuY2UgPSBzdXBlci5iYWxhbmNlT2YoX293bmVyKTsKCiAgICAgICAgaWYgKCFpc0ltcG9ydGVkKHNvdXJjZVRva2VuLCBfb3duZXIpKSB7CiAgICAgICAgICAgIGJhbGFuY2UgKz0gc291cmNlVG9rZW4uYmFsYW5jZU9mKF9vd25lcik7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF9hbW91bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgaXNUcmFuc2ZlckFsbG93ZWQobXNnLnNlbmRlciwgX3RvKQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfYW1vdW50KTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oCiAgICAgICAgYWRkcmVzcyBfZnJvbSwKICAgICAgICBhZGRyZXNzIF90bywKICAgICAgICB1aW50MjU2IF9hbW91bnQKICAgICkKICAgICAgICBwdWJsaWMKICAgICAgICBpc1RyYW5zZmVyQWxsb3dlZChfZnJvbSwgX3RvKQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF9hbW91bnQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYW1vdW50KQogICAgICAgIHB1YmxpYwogICAgICAgIGlzVHJhbnNmZXJBbGxvd2VkKG1zZy5zZW5kZXIsIF9zcGVuZGVyKQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICByZXR1cm4gc3VwZXIuYXBwcm92ZShfc3BlbmRlciwgX2Ftb3VudCk7CiAgICB9CiAgICAvL0VORCBFUkMyMAoKICAgIGZ1bmN0aW9uIGRlbGVnYXRlVG9rZW5zKGFkZHJlc3MgdG9rZW5Ib2xkZXIsIHVpbnQ5NiBhbW91bnQpCiAgICAgICAgcHVibGljCiAgICAgICAgaXNOb3RCdXJuZWQKICAgIHsKICAgICAgICByZXF1aXJlKHBheW1lbnRHYXRld2F5cy5pc0luTGlzdChtc2cuc2VuZGVyKSk7CiAgICAgICAgcmVxdWlyZShzdGFnZXNNYW5hZ2VyLmlzSUNPKCkpOwogICAgICAgIHJlcXVpcmUoc3RhZ2VzTWFuYWdlci5nZXRQb29sKCkgPj0gYW1vdW50KTsKCiAgICAgICAgdWludDg4IGJvbnVzID0gc3RhZ2VzTWFuYWdlci5jYWxjdWxhdGVCb251cyhhbW91bnQpOwogICAgICAgIHN0YWdlc01hbmFnZXIuZGVsZWdhdGVGcm9tUG9vbChhbW91bnQpOwoKICAgICAgICBiYWxhbmNlc1t0b2tlbkhvbGRlcl0gKz0gYW1vdW50ICsgdWludDk2KGJvbnVzKTsKCiAgICAgICAgVG9rZW5zRGVsZWdhdGVkKHRva2VuSG9sZGVyLCBhbW91bnQsIG1zZy5zZW5kZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlbGVnYXRlQm9udXNUb2tlbnMoYWRkcmVzcyB0b2tlbkhvbGRlciwgdWludDg4IGFtb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICBpc05vdEJ1cm5lZAogICAgewogICAgICAgIHJlcXVpcmUocGF5bWVudEdhdGV3YXlzLmlzSW5MaXN0KG1zZy5zZW5kZXIpIHx8IHR4Lm9yaWdpbiA9PSBhZG1pbmlzdHJhdG9yKTsKICAgICAgICByZXF1aXJlKHN0YWdlc01hbmFnZXIuZ2V0Qm9udXNQb29sKCkgPj0gYW1vdW50KTsKCiAgICAgICAgc3RhZ2VzTWFuYWdlci5kZWxlZ2F0ZUZyb21Cb251cyhhbW91bnQpOwoKICAgICAgICBiYWxhbmNlc1t0b2tlbkhvbGRlcl0gKz0gYW1vdW50OwoKICAgICAgICBUb2tlbnNEZWxlZ2F0ZWQodG9rZW5Ib2xkZXIsIHVpbnQ5NihhbW91bnQpLCBtc2cuc2VuZGVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWxlZ2F0ZVJlZmVyYWxUb2tlbnMoYWRkcmVzcyB0b2tlbkhvbGRlciwgdWludDg4IGFtb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICBpc05vdEJ1cm5lZAogICAgewogICAgICAgIHJlcXVpcmUocGF5bWVudEdhdGV3YXlzLmlzSW5MaXN0KG1zZy5zZW5kZXIpIHx8IHR4Lm9yaWdpbiA9PSBhZG1pbmlzdHJhdG9yKTsKICAgICAgICByZXF1aXJlKHN0YWdlc01hbmFnZXIuZ2V0UmVmZXJyYWxQb29sKCkgPj0gYW1vdW50KTsKCiAgICAgICAgc3RhZ2VzTWFuYWdlci5kZWxlZ2F0ZUZyb21SZWZlcnJhbChhbW91bnQpOwoKICAgICAgICBiYWxhbmNlc1t0b2tlbkhvbGRlcl0gKz0gYW1vdW50OwoKICAgICAgICBUb2tlbnNEZWxlZ2F0ZWQodG9rZW5Ib2xkZXIsIGFtb3VudCwgbXNnLnNlbmRlcik7CiAgICB9CgogICAgZnVuY3Rpb24gZGVsZWdhdGVSZWZlcnJhbFRva2Vuc0J1bGsoYWRkcmVzc1tdIHRva2VuSG9sZGVycywgdWludDg4W10gYW1vdW50cykKICAgICAgICBwdWJsaWMKICAgICAgICBpc05vdEJ1cm5lZAogICAgewogICAgICAgIHJlcXVpcmUocGF5bWVudEdhdGV3YXlzLmlzSW5MaXN0KG1zZy5zZW5kZXIpIHx8IHR4Lm9yaWdpbiA9PSBhZG1pbmlzdHJhdG9yKTsKICAgICAgICByZXF1aXJlKHRva2VuSG9sZGVycy5sZW5ndGggPD0gMjU2KTsKICAgICAgICByZXF1aXJlKHRva2VuSG9sZGVycy5sZW5ndGggPT0gYW1vdW50cy5sZW5ndGgpOwoKICAgICAgICBmb3IgKCB1aW50OCBpID0gMDsgaSA8IHRva2VuSG9sZGVycy5sZW5ndGg7IGkrKyApIHsKICAgICAgICAgICAgZGVsZWdhdGVSZWZlcmFsVG9rZW5zKHRva2VuSG9sZGVyc1tpXSwgYW1vdW50c1tpXSk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHVubG9jaygpCiAgICAgICAgcHVibGljCiAgICAgICAgaXNMb2NrZWQKICAgICAgICBvbmx5QWRtaW5pc3RyYXRvcgogICAgewogICAgICAgIHVubG9ja2VkID0gdHJ1ZTsKICAgICAgICBVbmxvY2tlZCgpOwogICAgfQoKICAgIGZ1bmN0aW9uIGJ1cm4oKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yCiAgICB7CiAgICAgICAgcmVxdWlyZSghc3RhZ2VzTWFuYWdlci5pc0lDTygpKTsKCiAgICAgICAgdWludDk2IGJ1cm5BbW91bnQgPSBzdGFnZXNNYW5hZ2VyLmdldFBvb2woKQogICAgICAgICAgICAgICAgICAgICAgICArIHN0YWdlc01hbmFnZXIuZ2V0Qm9udXNQb29sKCkKICAgICAgICAgICAgICAgICAgICAgICAgKyBzdGFnZXNNYW5hZ2VyLmdldFJlZmVycmFsUG9vbCgpOwoKICAgICAgICBfdG90YWxTdXBwbHkgLT0gYnVybkFtb3VudDsKICAgICAgICBidXJuZWQgPSB0cnVlOwogICAgICAgIEJ1cm5lZChidXJuQW1vdW50KTsKICAgIH0KfQ=='.
	

]
