Class {
	#name : #SRTf97ee81b6fa1f9de273e8cd37abc361cf4a4d74e,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTf97ee81b6fa1f9de273e8cd37abc361cf4a4d74e >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7Cgpjb250cmFjdCBvd25lZCB7CiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKICAgIGZ1bmN0aW9uIG93bmVkKCkgcHVibGljIHtvd25lciA9IG1zZy5zZW5kZXI7fQogICAgbW9kaWZpZXIgb25seU93bmVyIHtyZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpO187fQogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHB1YmxpYyB7b3duZXIgPSBuZXdPd25lcjt9Cn0KCmNvbnRyYWN0IFdpdGhkcmF3YWxDb250cmFjdCBpcyBvd25lZCB7CgogICAgZnVuY3Rpb24gd2l0aGRyYXcoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICB1aW50IGFtb3VudCA9IGFkZHJlc3ModGhpcykuYmFsYW5jZTsKICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKGFtb3VudCk7CiAgICB9Cn0KCmNvbnRyYWN0IFNpbXBsZU1hcmtldCBpcyBvd25lZCwgV2l0aGRyYXdhbENvbnRyYWN0IHsKCiAgICB1aW50IHB1YmxpYyAgICBzdGFydFByaWNlOwogICAgdWludCBwdWJsaWMgICAgZml4UHJpY2UgID0gMC4xIGV0aGVyOwogICAgdWludCBpbnRlcm5hbCAgZGVjaW1hbHMgID0gMDsKICAgIGJ5dGVzMzIgcHVibGljIHByb2R1Y3RJZCA9IDB4MDsKCglzdHJ1Y3QgVXNlclN0cnVjdCB7CgkJdWludCB1c2VyTGlzdFBvaW50ZXI7CgkJYnl0ZXMzMltdIHByb2R1Y3RLZXlzOwoJCWJ5dGVzMzIgdXNlckVtYWlsOwoJCWJ5dGVzMzIgdXNlck5hbWU7CgkJbWFwcGluZyhieXRlczMyID0+IHVpbnQpIHByb2R1Y3RLZXlQb2ludGVyczsKCX0KCgltYXBwaW5nKGJ5dGVzMzIgPT4gVXNlclN0cnVjdCkgcHVibGljIHVzZXJTdHJ1Y3RzOwoJYnl0ZXMzMltdIHB1YmxpYyB1c2VyTGlzdDsKCglzdHJ1Y3QgUHJvZHVjdFN0cnVjdCB7CgkJdWludCBwcm9kdWN0TGlzdFBvaW50ZXI7CgkJYnl0ZXMzMiB1c2VyS2V5OwoJCWJ5dGVzMzIgc2l6ZTsKCQl1aW50IHByb2R1Y3RQcmljZTsKCQlzdHJpbmcgZGVsaXZlcnk7CgkJYm9vbCBpblNhbGU7CgkJYWRkcmVzc1tdIGhpc3RvcnlVc2VyOwoJCXVpbnRbXSBoaXN0b3J5RGF0ZTsKCQl1aW50W10gaGlzdG9yeVByaWNlOwoJfQoKCW1hcHBpbmcoYnl0ZXMzMiA9PiBQcm9kdWN0U3RydWN0KSBwdWJsaWMgcHJvZHVjdFN0cnVjdHM7CglieXRlczMyW10gcHVibGljIHByb2R1Y3RMaXN0OwoKCWV2ZW50IExvZ05ld1VzZXIoYWRkcmVzcyBzZW5kZXIsIGJ5dGVzMzIgdXNlcklkKTsKCWV2ZW50IExvZ05ld1Byb2R1Y3QoYWRkcmVzcyBzZW5kZXIsIGJ5dGVzMzIgcHJvZHVjdElkLCBieXRlczMyIHVzZXJJZCk7CglldmVudCBMb2dVc2VyRGVsZXRlZChhZGRyZXNzIHNlbmRlciwgYnl0ZXMzMiB1c2VySWQpOwoJZXZlbnQgTG9nUHJvZHVjdERlbGV0ZWQoYWRkcmVzcyBzZW5kZXIsIGJ5dGVzMzIgcHJvZHVjdElkKTsKCglmdW5jdGlvbiBnZXRVc2VyQ291bnQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50IHVzZXJDb3VudCkgewoJCXJldHVybiB1c2VyTGlzdC5sZW5ndGg7Cgl9CgoJZnVuY3Rpb24gZ2V0UHJvZHVjdENvdW50KCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludCBwcm9kdWN0Q291bnQpewoJCXJldHVybiBwcm9kdWN0TGlzdC5sZW5ndGg7Cgl9CgkKCWZ1bmN0aW9uIGdldFVzZXJQcm9kdWN0c0tleXMoYnl0ZXMzMiBfdXNlcklkKSBwdWJsaWMgdmlldyByZXR1cm5zKGJ5dGVzMzJbXSl7CgkgICAgcmVxdWlyZShpc1VzZXIoX3VzZXJJZCkpOwoJICAgIHJldHVybiB1c2VyU3RydWN0c1tfdXNlcklkXS5wcm9kdWN0S2V5czsKCX0KCglmdW5jdGlvbiBnZXRQcm9kdWN0SGlzdG9yeVVzZXIoYnl0ZXMzMiBfcHJvZHVjdElkKSBwdWJsaWMgdmlldyByZXR1cm5zKGFkZHJlc3NbXSkgewoJICAgIHJldHVybiBwcm9kdWN0U3RydWN0c1tfcHJvZHVjdElkXS5oaXN0b3J5VXNlcjsKCX0KCglmdW5jdGlvbiBnZXRQcm9kdWN0SGlzdG9yeURhdGUoYnl0ZXMzMiBfcHJvZHVjdElkKSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnRbXSkgewoJICAgIHJldHVybiBwcm9kdWN0U3RydWN0c1tfcHJvZHVjdElkXS5oaXN0b3J5RGF0ZTsKCX0KCglmdW5jdGlvbiBnZXRQcm9kdWN0SGlzdG9yeVByaWNlKGJ5dGVzMzIgX3Byb2R1Y3RJZCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50W10pIHsKCSAgICByZXR1cm4gcHJvZHVjdFN0cnVjdHNbX3Byb2R1Y3RJZF0uaGlzdG9yeVByaWNlOwoJfQoKCWZ1bmN0aW9uIGlzVXNlcihieXRlczMyIHVzZXJJZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMoYm9vbCBpc0luZGVlZCkgewoJCWlmKHVzZXJMaXN0Lmxlbmd0aD09MCkgcmV0dXJuIGZhbHNlOwoJCXJldHVybiB1c2VyTGlzdFt1c2VyU3RydWN0c1t1c2VySWRdLnVzZXJMaXN0UG9pbnRlcl0gPT0gdXNlcklkOwoJfQoKCWZ1bmN0aW9uIGlzUHJvZHVjdChieXRlczMyIF9wcm9kdWN0SWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKGJvb2wgaXNJbmRlZWQpIHsKCQlpZihwcm9kdWN0TGlzdC5sZW5ndGg9PTApIHJldHVybiBmYWxzZTsKCQlyZXR1cm4gcHJvZHVjdExpc3RbcHJvZHVjdFN0cnVjdHNbX3Byb2R1Y3RJZF0ucHJvZHVjdExpc3RQb2ludGVyXSA9PSBfcHJvZHVjdElkOwoJfQoKCWZ1bmN0aW9uIGlzVXNlclByb2R1Y3QoYnl0ZXMzMiBfcHJvZHVjdElkLCBieXRlczMyIF91c2VySWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKGJvb2wgaXNJbmRlZWQpIHsKCgkJaWYocHJvZHVjdExpc3QubGVuZ3RoPT0wKSByZXR1cm4gZmFsc2U7CgkJaWYodXNlckxpc3QubGVuZ3RoPT0wKSByZXR1cm4gZmFsc2U7CgoJCXJldHVybiBwcm9kdWN0U3RydWN0c1tfcHJvZHVjdElkXS51c2VyS2V5ID09IF91c2VySWQ7Cgl9CgoJZnVuY3Rpb24gZ2V0VXNlclByb2R1Y3RDb3VudChieXRlczMyIHVzZXJJZCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludCBwcm9kdWN0Q291bnQpIHsKCQlyZXF1aXJlKGlzVXNlcih1c2VySWQpKTsKCQlyZXR1cm4gdXNlclN0cnVjdHNbdXNlcklkXS5wcm9kdWN0S2V5cy5sZW5ndGg7Cgl9CgoJZnVuY3Rpb24gZ2V0VXNlclByb2R1Y3RBdEluZGV4KGJ5dGVzMzIgdXNlcklkLCB1aW50IHJvdykgcHVibGljIGNvbnN0YW50IHJldHVybnMoYnl0ZXMzMiBwcm9kdWN0S2V5KSB7CgkJcmVxdWlyZShpc1VzZXIodXNlcklkKSk7CgkJcmV0dXJuIHVzZXJTdHJ1Y3RzW3VzZXJJZF0ucHJvZHVjdEtleXNbcm93XTsKCX0KCglmdW5jdGlvbiBjcmVhdGVVc2VyKGJ5dGVzMzIgX3VzZXJOYW1lLCBieXRlczMyIF91c2VyRW1haWwpIHB1YmxpYyB7CgkgICAgcmVxdWlyZShtc2cuc2VuZGVyICE9IDApOwogICAgICAgIGJ5dGVzMzIgdXNlcklkID0gYnl0ZXMzMihtc2cuc2VuZGVyKTsKCQlyZXF1aXJlKCFpc1VzZXIodXNlcklkKSk7CgoJCXVzZXJTdHJ1Y3RzW3VzZXJJZF0udXNlckxpc3RQb2ludGVyID0gdXNlckxpc3QucHVzaCh1c2VySWQpLTE7CgkJdXNlclN0cnVjdHNbdXNlcklkXS51c2VyRW1haWwgICAgICAgPSBfdXNlckVtYWlsOwoJCXVzZXJTdHJ1Y3RzW3VzZXJJZF0udXNlck5hbWUgICAgICAgID0gX3VzZXJOYW1lOwoKCQllbWl0IExvZ05ld1VzZXIobXNnLnNlbmRlciwgdXNlcklkKTsKCX0KCglmdW5jdGlvbiBjcmVhdGVQcm9kdWN0KGJ5dGVzMzIgX3NpemUsIHN0cmluZyBkZWxpdmVyeSwgYnl0ZXMzMiBfdXNlck5hbWUsIGJ5dGVzMzIgX3VzZXJFbWFpbCkgcHVibGljIHBheWFibGUgcmV0dXJucyhib29sIHN1Y2Nlc3MpIHsKCQkKCQlyZXF1aXJlKG1zZy5zZW5kZXIgIT0gMCk7CiAgICAgICAgcmVxdWlyZShzdGFydFByaWNlICE9IDApOwogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlICA+PSBzdGFydFByaWNlKTsKICAgICAgICByZXF1aXJlKHByb2R1Y3RMaXN0Lmxlbmd0aCA8PSAxMDApOwogICAgICAgIAoJCWJ5dGVzMzIgdXNlcklkICAgID0gYnl0ZXMzMihtc2cuc2VuZGVyKTsKCQl1aW50IHByb2R1Y3RDb3VudCA9IHByb2R1Y3RMaXN0Lmxlbmd0aCArIDE7CgkJcHJvZHVjdElkICAgICAgICAgPSBieXRlczMyKHByb2R1Y3RDb3VudCk7CgogICAgICAgIGlmKCFpc1VzZXIodXNlcklkKSkgewogICAgICAgICAgICByZXF1aXJlKF91c2VyTmFtZSAhPTApOwogICAgICAgICAgICByZXF1aXJlKF91c2VyRW1haWwgIT0wKTsKICAgICAgICAgICAgY3JlYXRlVXNlcihfdXNlck5hbWUsIF91c2VyRW1haWwpOwogICAgICAgIH0KCgkJcmVxdWlyZShpc1VzZXIodXNlcklkKSk7CgkJcmVxdWlyZSghaXNQcm9kdWN0KHByb2R1Y3RJZCkpOwoKCQlwcm9kdWN0U3RydWN0c1twcm9kdWN0SWRdLnByb2R1Y3RMaXN0UG9pbnRlciA9IHByb2R1Y3RMaXN0LnB1c2gocHJvZHVjdElkKS0xOwoJCXByb2R1Y3RTdHJ1Y3RzW3Byb2R1Y3RJZF0udXNlcktleSAgICAgICAgICAgID0gdXNlcklkOwoJCXByb2R1Y3RTdHJ1Y3RzW3Byb2R1Y3RJZF0uc2l6ZSAgICAgICAgICAgICAgID0gX3NpemU7CgkJcHJvZHVjdFN0cnVjdHNbcHJvZHVjdElkXS5wcm9kdWN0UHJpY2UgICAgICAgPSBzdGFydFByaWNlOwoJCXByb2R1Y3RTdHJ1Y3RzW3Byb2R1Y3RJZF0uZGVsaXZlcnkgICAgICAgICAgID0gZGVsaXZlcnk7CgkJcHJvZHVjdFN0cnVjdHNbcHJvZHVjdElkXS5pblNhbGUgICAgICAgICAgICAgPSBmYWxzZTsKCgkJcHJvZHVjdFN0cnVjdHNbcHJvZHVjdElkXS5oaXN0b3J5VXNlci5wdXNoKG1zZy5zZW5kZXIpOwoJCXByb2R1Y3RTdHJ1Y3RzW3Byb2R1Y3RJZF0uaGlzdG9yeURhdGUucHVzaChub3cpOwoJCXByb2R1Y3RTdHJ1Y3RzW3Byb2R1Y3RJZF0uaGlzdG9yeVByaWNlLnB1c2goc3RhcnRQcmljZSk7CgkJCgkJdXNlclN0cnVjdHNbdXNlcklkXS5wcm9kdWN0S2V5UG9pbnRlcnNbcHJvZHVjdElkXSA9IHVzZXJTdHJ1Y3RzW3VzZXJJZF0ucHJvZHVjdEtleXMucHVzaChwcm9kdWN0SWQpIC0gMTsKCQkKCQllbWl0IExvZ05ld1Byb2R1Y3QobXNnLnNlbmRlciwgcHJvZHVjdElkLCB1c2VySWQpOwoJCQoJCXVpbnQgb2RkTW9uZXkgPSBtc2cudmFsdWUgLSBzdGFydFByaWNlOwoKICAgICAgICBhZGRyZXNzKHRoaXMpLnRyYW5zZmVyKHN0YXJ0UHJpY2UpOwogICAgICAgIHVpbnQgY291bnRQcm9kdWN0ID0gZ2V0UHJvZHVjdENvdW50KCk7CiAgICAgICAgc3RhcnRQcmljZSAgICAgICAgPSAoKGNvdW50UHJvZHVjdCAqIGZpeFByaWNlKSArIGZpeFByaWNlKSAqIDEwICoqIGRlY2ltYWxzOwoKICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKG9kZE1vbmV5KTsKCgkJcmV0dXJuIHRydWU7Cgl9CgoJZnVuY3Rpb24gZGVsZXRlVXNlcihieXRlczMyIHVzZXJJZCkgcHVibGljIG9ubHlPd25lciByZXR1cm5zKGJvb2wgc3VjY2VzKSB7CgoJCXJlcXVpcmUoaXNVc2VyKHVzZXJJZCkpOwoJCXJlcXVpcmUodXNlclN0cnVjdHNbdXNlcklkXS5wcm9kdWN0S2V5cy5sZW5ndGggPD0gMCk7CgoJCXVpbnQgcm93VG9EZWxldGUgID0gdXNlclN0cnVjdHNbdXNlcklkXS51c2VyTGlzdFBvaW50ZXI7CgkJYnl0ZXMzMiBrZXlUb01vdmUgPSB1c2VyTGlzdFt1c2VyTGlzdC5sZW5ndGgtMV07CgoJCXVzZXJMaXN0W3Jvd1RvRGVsZXRlXSAgICAgICAgICAgICAgICAgID0ga2V5VG9Nb3ZlOwoJCXVzZXJTdHJ1Y3RzW2tleVRvTW92ZV0udXNlckxpc3RQb2ludGVyID0gcm93VG9EZWxldGU7CgkJdXNlclN0cnVjdHNba2V5VG9Nb3ZlXS51c2VyRW1haWwgICAgICAgPSAweDA7CgkJdXNlclN0cnVjdHNba2V5VG9Nb3ZlXS51c2VyTmFtZSAgICAgICAgPSAweDA7CgoJCXVzZXJMaXN0Lmxlbmd0aC0tOwoKCQllbWl0IExvZ1VzZXJEZWxldGVkKG1zZy5zZW5kZXIsIHVzZXJJZCk7CgoJCXJldHVybiB0cnVlOwoJfQoKCWZ1bmN0aW9uIGRlbGV0ZVByb2R1Y3QoYnl0ZXMzMiBfcHJvZHVjdElkKSBwdWJsaWMgb25seU93bmVyIHJldHVybnMoYm9vbCBzdWNjZXNzKSB7CgkJCgkJcmVxdWlyZShpc1Byb2R1Y3QoX3Byb2R1Y3RJZCkpOwoJCQoJCXVpbnQgcm93VG9EZWxldGUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IHByb2R1Y3RTdHJ1Y3RzW19wcm9kdWN0SWRdLnByb2R1Y3RMaXN0UG9pbnRlcjsKCQlieXRlczMyIGtleVRvTW92ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSBwcm9kdWN0TGlzdFtwcm9kdWN0TGlzdC5sZW5ndGgtMV07CgoJCXByb2R1Y3RMaXN0W3Jvd1RvRGVsZXRlXSAgICAgICAgICAgICAgICAgICAgICA9IGtleVRvTW92ZTsKCQlwcm9kdWN0U3RydWN0c1tfcHJvZHVjdElkXS5wcm9kdWN0TGlzdFBvaW50ZXIgPSByb3dUb0RlbGV0ZTsKCQkKCQlwcm9kdWN0TGlzdC5sZW5ndGgtLTsKCgkJYnl0ZXMzMiB1c2VySWQgPSBwcm9kdWN0U3RydWN0c1tfcHJvZHVjdElkXS51c2VyS2V5OwoJCXJvd1RvRGVsZXRlICAgID0gdXNlclN0cnVjdHNbdXNlcklkXS5wcm9kdWN0S2V5UG9pbnRlcnNbX3Byb2R1Y3RJZF07CgkJa2V5VG9Nb3ZlICAgICAgPSB1c2VyU3RydWN0c1t1c2VySWRdLnByb2R1Y3RLZXlzW3VzZXJTdHJ1Y3RzW3VzZXJJZF0ucHJvZHVjdEtleXMubGVuZ3RoLTFdOwoKCQl1c2VyU3RydWN0c1t1c2VySWRdLnByb2R1Y3RLZXlzW3Jvd1RvRGVsZXRlXSAgICAgID0ga2V5VG9Nb3ZlOwoJCXVzZXJTdHJ1Y3RzW3VzZXJJZF0ucHJvZHVjdEtleVBvaW50ZXJzW2tleVRvTW92ZV0gPSByb3dUb0RlbGV0ZTsKCQkKCQl1c2VyU3RydWN0c1t1c2VySWRdLnByb2R1Y3RLZXlzLmxlbmd0aC0tOwoJCQoJCWVtaXQgTG9nUHJvZHVjdERlbGV0ZWQobXNnLnNlbmRlciwgX3Byb2R1Y3RJZCk7CgkJdWludCBjb3VudFByb2R1Y3QgPSBnZXRQcm9kdWN0Q291bnQoKTsKCQlwcm9kdWN0SWQgPSBieXRlczMyKGNvdW50UHJvZHVjdCAtIDEpOwoJCQoJCXJldHVybiB0cnVlOwoJfQoKCWZ1bmN0aW9uIGNoYW5nZU93bmVyKAoJICAgIGJ5dGVzMzIgX3Byb2R1Y3RJZCwgCgkgICAgYnl0ZXMzMiBfb2xkT3duZXIsIAoJICAgIGJ5dGVzMzIgX25ld093bmVyLCAKCSAgICBhZGRyZXNzIG9sZE93bmVyLCAKCSAgICBzdHJpbmcgX25ld0RlbGl2ZXJ5LAoJICAgIGJ5dGVzMzIgX3VzZXJOYW1lLAoJICAgIGJ5dGVzMzIgX3VzZXJFbWFpbAoJICAgICkgcHVibGljIHBheWFibGUgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CgoJICAgIHJlcXVpcmUoaXNQcm9kdWN0KF9wcm9kdWN0SWQpKTsKCSAgICByZXF1aXJlKGlzVXNlcihfb2xkT3duZXIpKTsKCSAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSBwcm9kdWN0U3RydWN0c1tfcHJvZHVjdElkXS5wcm9kdWN0UHJpY2UpOwoKCSAgICBpZihpc1VzZXJQcm9kdWN0KF9wcm9kdWN0SWQsIF9uZXdPd25lcikpIHJldHVybiBmYWxzZTsKCgkgICAgaWYoIWlzVXNlcihfbmV3T3duZXIpKSB7CiAgICAgICAgICAgIHJlcXVpcmUoX3VzZXJOYW1lICE9MCk7CiAgICAgICAgICAgIHJlcXVpcmUoX3VzZXJFbWFpbCAhPTApOwogICAgICAgICAgICBjcmVhdGVVc2VyKF91c2VyTmFtZSwgX3VzZXJFbWFpbCk7CiAgICAgICAgfQoKCSAgICBwcm9kdWN0U3RydWN0c1tfcHJvZHVjdElkXS51c2VyS2V5ICA9IF9uZXdPd25lcjsKCQlwcm9kdWN0U3RydWN0c1tfcHJvZHVjdElkXS5kZWxpdmVyeSA9IF9uZXdEZWxpdmVyeTsKCQlwcm9kdWN0U3RydWN0c1tfcHJvZHVjdElkXS5pblNhbGUgICA9IGZhbHNlOwoKCQlwcm9kdWN0U3RydWN0c1tfcHJvZHVjdElkXS5oaXN0b3J5VXNlci5wdXNoKG1zZy5zZW5kZXIpOwoJCXByb2R1Y3RTdHJ1Y3RzW19wcm9kdWN0SWRdLmhpc3RvcnlEYXRlLnB1c2gobm93KTsKCQlwcm9kdWN0U3RydWN0c1tfcHJvZHVjdElkXS5oaXN0b3J5UHJpY2UucHVzaChwcm9kdWN0U3RydWN0c1tfcHJvZHVjdElkXS5wcm9kdWN0UHJpY2UpOwoJCQogICAgCXVzZXJTdHJ1Y3RzW19uZXdPd25lcl0ucHJvZHVjdEtleVBvaW50ZXJzW19wcm9kdWN0SWRdID0gdXNlclN0cnVjdHNbX25ld093bmVyXS5wcm9kdWN0S2V5cy5wdXNoKF9wcm9kdWN0SWQpIC0gMTsKCiAgICAgICAgYm9vbCBzdGFydCA9IGZhbHNlOwoKICAgIAlmb3IodWludCBpPTA7aTx1c2VyU3RydWN0c1tfb2xkT3duZXJdLnByb2R1Y3RLZXlzLmxlbmd0aDtpKyspIHsKICAgIAkgICAgaWYoKGkrMSkgPT0gdXNlclN0cnVjdHNbX29sZE93bmVyXS5wcm9kdWN0S2V5cy5sZW5ndGgpewogICAgCSAgICAgICAgdXNlclN0cnVjdHNbX29sZE93bmVyXS5wcm9kdWN0S2V5c1tpXSA9IDB4MDsKICAgIAkgICAgfWVsc2V7CiAgICAJICAgICAgICBpZih1c2VyU3RydWN0c1tfb2xkT3duZXJdLnByb2R1Y3RLZXlzW2ldID09IF9wcm9kdWN0SWQgfHwgc3RhcnQpewogICAgCSAgICAgICAgICAgIHVzZXJTdHJ1Y3RzW19vbGRPd25lcl0ucHJvZHVjdEtleXNbaV0gPSB1c2VyU3RydWN0c1tfb2xkT3duZXJdLnByb2R1Y3RLZXlzW2krMV07CiAgICAJICAgICAgICAgICAgc3RhcnQgPSB0cnVlOwogICAgCSAgICAgICAgfQogICAgCSAgICB9CgkJfQoJCQoJCWRlbGV0ZSB1c2VyU3RydWN0c1tfb2xkT3duZXJdLnByb2R1Y3RLZXlQb2ludGVyc1tfcHJvZHVjdElkXTsKCQlkZWxldGUgdXNlclN0cnVjdHNbX29sZE93bmVyXS5wcm9kdWN0S2V5c1t1c2VyU3RydWN0c1tfb2xkT3duZXJdLnByb2R1Y3RLZXlzLmxlbmd0aC0xXTsKICAgICAgICB1c2VyU3RydWN0c1tfb2xkT3duZXJdLnByb2R1Y3RLZXlzLmxlbmd0aC0tOwoJCQoJCWFkZHJlc3ModGhpcykudHJhbnNmZXIobXNnLnZhbHVlKTsKCQlvbGRPd25lci50cmFuc2Zlcihtc2cudmFsdWUpOwoKCSAgICByZXR1cm4gdHJ1ZTsKCX0KCQoJZnVuY3Rpb24gY2hhbmdlSW5TYWxlKGJ5dGVzMzIgX3Byb2R1Y3RJZCwgYnl0ZXMzMiBfdXNlcklkLCB1aW50IF9uZXdQcmljZSkgcHVibGljIHBheWFibGUgcmV0dXJucyhib29sIHN1Y2Nlc3MpIHsKCgkgICByZXF1aXJlKGlzUHJvZHVjdChfcHJvZHVjdElkKSk7CgkgICByZXF1aXJlKGlzVXNlcihfdXNlcklkKSk7CgoJICAgcHJvZHVjdFN0cnVjdHNbX3Byb2R1Y3RJZF0ucHJvZHVjdFByaWNlID0gX25ld1ByaWNlOwoJICAgcHJvZHVjdFN0cnVjdHNbX3Byb2R1Y3RJZF0uaW5TYWxlICAgICAgID0gdHJ1ZTsKCgkgICByZXR1cm4gdHJ1ZTsKCX0KCiAgICBmdW5jdGlvbiBzZXRQcmljZXModWludCBfbmV3UHJpY2UpIGludGVybmFsIHsKICAgICAgICByZXF1aXJlKF9uZXdQcmljZSAhPSAwKTsKICAgICAgICBpZihzdGFydFByaWNlID09IDApIHsKICAgICAgICAgICAgc3RhcnRQcmljZSA9ICgxIGV0aGVyIC8gX25ld1ByaWNlKSAqIDEwICoqIGRlY2ltYWxzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHVpbnQgY291bnRQcm9kdWN0ID0gZ2V0UHJvZHVjdENvdW50KCk7CiAgICAgICAgICAgIHN0YXJ0UHJpY2UgPSAoMSBldGhlciAvIChjb3VudFByb2R1Y3QgKiBfbmV3UHJpY2UpKSAqIDEwICoqIGRlY2ltYWxzOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBzZXRGaXhQcmljZSh1aW50IF9uZXdGaXhQcmljZSkgcHVibGljIHBheWFibGUgb25seU93bmVyIHJldHVybnMoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyICAgIT0gMCk7CiAgICAgICAgcmVxdWlyZShfbmV3Rml4UHJpY2UgIT0gMCk7CiAgICAgICAgZml4UHJpY2UgPSBfbmV3Rml4UHJpY2U7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0RGVjaW1hbHModWludCBfbmV3RGVjaW1hbHMpIHB1YmxpYyBwYXlhYmxlIG9ubHlPd25lciByZXR1cm5zKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciAhPSAwKTsKICAgICAgICBkZWNpbWFscyA9IF9uZXdEZWNpbWFsczsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbigpIHB1YmxpYyBwYXlhYmxlIHt9CgogICAgZnVuY3Rpb24gU2ltcGxlTWFya2V0KCkgcHVibGljIHBheWFibGUgewogICAgICAgIHN0YXJ0UHJpY2UgPSAwLjEgZXRoZXI7CiAgICB9Cn0='.
	

]
