Class {
	#name : #SRT7e06a9512086bc44c51c07c2bf0af338420c2a13,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT7e06a9512086bc44c51c07c2bf0af338420c2a13 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovLyBGaWxlOiBjb250cmFjdHMvbGFuZC9MQU5EU3RvcmFnZS5zb2wKCmNvbnRyYWN0IExBTkRTdG9yYWdlIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBsYXRlc3RQaW5nOwoKICB1aW50MjU2IGNvbnN0YW50IGNsZWFyTG93ID0gMHhmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwOwogIHVpbnQyNTYgY29uc3RhbnQgY2xlYXJIaWdoID0gMHgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmOwogIHVpbnQyNTYgY29uc3RhbnQgZmFjdG9yID0gMHgxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgYXV0aG9yaXplZERlcGxveTsKCn0KCi8vIEZpbGU6IGNvbnRyYWN0cy91cGdyYWRhYmxlL093bmFibGVTdG9yYWdlLnNvbAoKY29udHJhY3QgT3duYWJsZVN0b3JhZ2UgewoKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgZnVuY3Rpb24gT3duYWJsZVN0b3JhZ2UoKSBpbnRlcm5hbCB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKfQoKLy8gRmlsZTogY29udHJhY3RzL3VwZ3JhZGFibGUvUHJveHlTdG9yYWdlLnNvbAoKY29udHJhY3QgUHJveHlTdG9yYWdlIHsKCiAgLyoqCiAgICogQ3VycmVudCBjb250cmFjdCB0byB3aGljaCB3ZSBhcmUgcHJveGluZwogICAqLwogIGFkZHJlc3MgcHVibGljIGN1cnJlbnRDb250cmFjdDsKICBhZGRyZXNzIHB1YmxpYyBwcm94eU93bmVyOwp9CgovLyBGaWxlOiBlcmM4MjEvY29udHJhY3RzL0Fzc2V0UmVnaXN0cnlTdG9yYWdlLnNvbAoKY29udHJhY3QgQXNzZXRSZWdpc3RyeVN0b3JhZ2UgewoKICBzdHJpbmcgaW50ZXJuYWwgX25hbWU7CiAgc3RyaW5nIGludGVybmFsIF9zeW1ib2w7CiAgc3RyaW5nIGludGVybmFsIF9kZXNjcmlwdGlvbjsKCiAgLyoqCiAgICogU3RvcmVzIHRoZSB0b3RhbCBjb3VudCBvZiBhc3NldHMgbWFuYWdlZCBieSB0aGlzIHJlZ2lzdHJ5CiAgICovCiAgdWludDI1NiBpbnRlcm5hbCBfY291bnQ7CgogIC8qKgogICAqIFN0b3JlcyBhbiBhcnJheSBvZiBhc3NldHMgb3duZWQgYnkgYSBnaXZlbiBhY2NvdW50CiAgICovCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTZbXSkgaW50ZXJuYWwgX2Fzc2V0c09mOwoKICAvKioKICAgKiBTdG9yZXMgdGhlIGN1cnJlbnQgaG9sZGVyIG9mIGFuIGFzc2V0CiAgICovCiAgbWFwcGluZyh1aW50MjU2ID0+IGFkZHJlc3MpIGludGVybmFsIF9ob2xkZXJPZjsKCiAgLyoqCiAgICogU3RvcmVzIHRoZSBpbmRleCBvZiBhbiBhc3NldCBpbiB0aGUgYF9hc3NldHNPZmAgYXJyYXkgb2YgaXRzIGhvbGRlcgogICAqLwogIG1hcHBpbmcodWludDI1NiA9PiB1aW50MjU2KSBpbnRlcm5hbCBfaW5kZXhPZkFzc2V0OwoKICAvKioKICAgKiBTdG9yZXMgdGhlIGRhdGEgYXNzb2NpYXRlZCB3aXRoIGFuIGFzc2V0CiAgICovCiAgbWFwcGluZyh1aW50MjU2ID0+IHN0cmluZykgaW50ZXJuYWwgX2Fzc2V0RGF0YTsKCiAgLyoqCiAgICogRm9yIGEgZ2l2ZW4gYWNjb3VudCwgZm9yIGEgZ2l2ZW4gb3BwZXJhdG9yLCBzdG9yZSB3aGV0aGVyIHRoYXQgb3BlcmF0b3IgaXMKICAgKiBhbGxvd2VkIHRvIHRyYW5zZmVyIGFuZCBtb2RpZnkgYXNzZXRzIG9uIGJlaGFsZiBvZiB0aGVtLgogICAqLwogIG1hcHBpbmcoYWRkcmVzcyA9PiBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkpIGludGVybmFsIF9vcGVyYXRvcnM7CgogIC8qKgogICAqIFNpbXBsZSByZWVudHJhbmN5IGxvY2sKICAgKi8KICBib29sIGludGVybmFsIF9yZWVudHJhbmN5Owp9CgovLyBGaWxlOiBjb250cmFjdHMvU3RvcmFnZS5zb2wKCmNvbnRyYWN0IFN0b3JhZ2UgaXMgUHJveHlTdG9yYWdlLCBPd25hYmxlU3RvcmFnZSwgQXNzZXRSZWdpc3RyeVN0b3JhZ2UsIExBTkRTdG9yYWdlIHsKfQoKLy8gRmlsZTogY29udHJhY3RzL3VwZ3JhZGFibGUvSUFwcGxpY2F0aW9uLnNvbAoKY29udHJhY3QgSUFwcGxpY2F0aW9uIHsKICBmdW5jdGlvbiBpbml0aWFsaXplKGJ5dGVzIGRhdGEpIHB1YmxpYzsKfQoKLy8gRmlsZTogY29udHJhY3RzL3VwZ3JhZGFibGUvT3duYWJsZS5zb2wKCmNvbnRyYWN0IE93bmFibGUgaXMgU3RvcmFnZSB7CgogIGV2ZW50IE93bmVyVXBkYXRlKGFkZHJlc3MgX3ByZXZPd25lciwgYWRkcmVzcyBfbmV3T3duZXIpOwoKICBmdW5jdGlvbiBieXRlc1RvQWRkcmVzcyAoYnl0ZXMgYikgcHVyZSBwdWJsaWMgcmV0dXJucyAoYWRkcmVzcykgewogICAgdWludCByZXN1bHQgPSAwOwogICAgZm9yICh1aW50IGkgPSBiLmxlbmd0aC0xOyBpKzEgPiAwOyBpLS0pIHsKICAgICAgdWludCBjID0gdWludChiW2ldKTsKICAgICAgdWludCB0b19pbmMgPSBjICogKCAxNiAqKiAoKGIubGVuZ3RoIC0gaS0xKSAqIDIpKTsKICAgICAgcmVzdWx0ICs9IHRvX2luYzsKICAgIH0KICAgIHJldHVybiBhZGRyZXNzKHJlc3VsdCk7CiAgfQoKICBtb2RpZmllciBvbmx5T3duZXIgewogICAgYXNzZXJ0KG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgogIGZ1bmN0aW9uIGluaXRpYWxpemUoYnl0ZXMgZGF0YSkgcHVibGljIHsKICAgIG93bmVyID0gYnl0ZXNUb0FkZHJlc3MoZGF0YSk7CiAgfQoKICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIF9uZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKF9uZXdPd25lciAhPSBvd25lcik7CiAgICBvd25lciA9IF9uZXdPd25lcjsKICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9sYW5kL0lMQU5EUmVnaXN0cnkuc29sCgppbnRlcmZhY2UgSUxBTkRSZWdpc3RyeSB7CgogIC8vIExBTkQgY2FuIGJlIGFzc2lnbmVkIGJ5IHRoZSBvd25lcgogIGZ1bmN0aW9uIGFzc2lnbk5ld1BhcmNlbChpbnQgeCwgaW50IHksIGFkZHJlc3MgYmVuZWZpY2lhcnkpIHB1YmxpYzsKICBmdW5jdGlvbiBhc3NpZ25NdWx0aXBsZVBhcmNlbHMoaW50W10geCwgaW50W10geSwgYWRkcmVzcyBiZW5lZmljaWFyeSkgcHVibGljOwoKICAvLyBBZnRlciBvbmUgeWVhciwgbGFuZCBjYW4gYmUgY2xhaW1lZCBmcm9tIGFuIGluYWN0aXZlIHB1YmxpYyBrZXkKICBmdW5jdGlvbiBwaW5nKCkgcHVibGljOwogIGZ1bmN0aW9uIGNsZWFyTGFuZChpbnRbXSB4LCBpbnRbXSB5KSBwdWJsaWM7CgogIC8vIExBTkQtY2VudHJpYyBnZXR0ZXJzCiAgZnVuY3Rpb24gZW5jb2RlVG9rZW5JZChpbnQgeCwgaW50IHkpIHZpZXcgcHVibGljIHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIGRlY29kZVRva2VuSWQodWludCB2YWx1ZSkgdmlldyBwdWJsaWMgcmV0dXJucyAoaW50LCBpbnQpOwogIGZ1bmN0aW9uIGV4aXN0cyhpbnQgeCwgaW50IHkpIHZpZXcgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIG93bmVyT2ZMYW5kKGludCB4LCBpbnQgeSkgdmlldyBwdWJsaWMgcmV0dXJucyAoYWRkcmVzcyk7CiAgZnVuY3Rpb24gb3duZXJPZkxhbmRNYW55KGludFtdIHgsIGludFtdIHkpIHZpZXcgcHVibGljIHJldHVybnMgKGFkZHJlc3NbXSk7CiAgZnVuY3Rpb24gbGFuZE9mKGFkZHJlc3Mgb3duZXIpIHZpZXcgcHVibGljIHJldHVybnMgKGludFtdLCBpbnRbXSk7CiAgZnVuY3Rpb24gbGFuZERhdGEoaW50IHgsIGludCB5KSB2aWV3IHB1YmxpYyByZXR1cm5zIChzdHJpbmcpOwoKICAvLyBUcmFuc2ZlciBMQU5ECiAgZnVuY3Rpb24gdHJhbnNmZXJMYW5kKGludCB4LCBpbnQgeSwgYWRkcmVzcyB0bykgcHVibGljOwogIGZ1bmN0aW9uIHRyYW5zZmVyTWFueUxhbmQoaW50W10geCwgaW50W10geSwgYWRkcmVzcyB0bykgcHVibGljOwoKICAvLyBVcGRhdGUgTEFORAogIGZ1bmN0aW9uIHVwZGF0ZUxhbmREYXRhKGludCB4LCBpbnQgeSwgc3RyaW5nIGRhdGEpIHB1YmxpYzsKICBmdW5jdGlvbiB1cGRhdGVNYW55TGFuZERhdGEoaW50W10geCwgaW50W10geSwgc3RyaW5nIGRhdGEpIHB1YmxpYzsKfQoKLy8gRmlsZTogZXJjODIxL2NvbnRyYWN0cy9JQXNzZXRIb2xkZXIuc29sCgppbnRlcmZhY2UgSUFzc2V0SG9sZGVyIHsKICBmdW5jdGlvbiBvbkFzc2V0UmVjZWl2ZWQoCiAgICAvKiBhZGRyZXNzIF9hc3NldFJlZ2lzdHJ5ID09IG1zZy5zZW5kZXIgKi8KICAgIHVpbnQyNTYgX2Fzc2V0SWQsCiAgICBhZGRyZXNzIF9wcmV2aW91c0hvbGRlciwKICAgIGFkZHJlc3MgX2N1cnJlbnRIb2xkZXIsCiAgICBieXRlcyAgIF91c2VyRGF0YSwKICAgIGFkZHJlc3MgX29wZXJhdG9yLAogICAgYnl0ZXMgICBfb3BlcmF0b3JEYXRhCiAgKSBwdWJsaWM7Cn0KCi8vIEZpbGU6IGVyYzgyMS9jb250cmFjdHMvSUFzc2V0UmVnaXN0cnkuc29sCgppbnRlcmZhY2UgSUFzc2V0UmVnaXN0cnkgewoKICAvKioKICAgKiBHbG9iYWwgUmVnaXN0cnkgZ2V0dGVyIGZ1bmN0aW9ucwogICAqLwogIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcpOwogIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZyk7CiAgZnVuY3Rpb24gZGVzY3JpcHRpb24oKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcpOwogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CgogIC8qKgogICAqIEFzc2V0LWNlbnRyaWMgZ2V0dGVyIGZ1bmN0aW9ucwogICAqLwogIGZ1bmN0aW9uIGV4aXN0cyh1aW50MjU2IGFzc2V0SWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwoKICBmdW5jdGlvbiBob2xkZXJPZih1aW50MjU2IGFzc2V0SWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3MpOwogIGZ1bmN0aW9uIHNhZmVIb2xkZXJPZih1aW50MjU2IGFzc2V0SWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3MpOwoKICBmdW5jdGlvbiBhc3NldERhdGEodWludDI1NiBhc3NldElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcpOwoKICAvKioKICAgKiBIb2xkZXItY2VudHJpYyBnZXR0ZXIgZnVuY3Rpb25zCiAgICovCiAgZnVuY3Rpb24gYXNzZXRDb3VudChhZGRyZXNzIGhvbGRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gYXNzZXRCeUluZGV4KGFkZHJlc3MgaG9sZGVyLCB1aW50MjU2IGluZGV4KSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiBhc3NldHNPZihhZGRyZXNzIGhvbGRlcikgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2W10pOwoKICAvKioKICAgKiBUcmFuc2ZlciBPcGVyYXRpb25zCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiBhc3NldElkKSBwdWJsaWM7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiBhc3NldElkLCBieXRlcyB1c2VyRGF0YSkgcHVibGljOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgYXNzZXRJZCwgYnl0ZXMgdXNlckRhdGEsIGJ5dGVzIG9wZXJhdG9yRGF0YSkgcHVibGljOwoKICAvKioKICAgKiBBdXRob3JpemF0aW9uIG9wZXJhdGlvbnMKICAgKi8KICBmdW5jdGlvbiBhdXRob3JpemVPcGVyYXRvcihhZGRyZXNzIG9wZXJhdG9yLCBib29sIGF1dGhvcml6ZWQpIHB1YmxpYzsKCiAgLyoqCiAgICogQXV0aG9yaXphdGlvbiBnZXR0ZXJzCiAgICovCiAgZnVuY3Rpb24gaXNPcGVyYXRvckF1dGhvcml6ZWRGb3IoYWRkcmVzcyBvcGVyYXRvciwgYWRkcmVzcyBhc3NldEhvbGRlcikKICAgIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwoKICAvKioKICAgKiBFdmVudHMKICAgKi8KICBldmVudCBUcmFuc2ZlcigKICAgIGFkZHJlc3MgaW5kZXhlZCBmcm9tLAogICAgYWRkcmVzcyBpbmRleGVkIHRvLAogICAgdWludDI1NiBpbmRleGVkIGFzc2V0SWQsCiAgICBhZGRyZXNzIG9wZXJhdG9yLAogICAgYnl0ZXMgdXNlckRhdGEsCiAgICBieXRlcyBvcGVyYXRvckRhdGEKICApOwogIGV2ZW50IFVwZGF0ZSgKICAgIHVpbnQyNTYgaW5kZXhlZCBhc3NldElkLAogICAgYWRkcmVzcyBpbmRleGVkIGhvbGRlciwKICAgIGFkZHJlc3MgaW5kZXhlZCBvcGVyYXRvciwKICAgIHN0cmluZyBkYXRhCiAgKTsKICBldmVudCBBdXRob3JpemVPcGVyYXRvcigKICAgIGFkZHJlc3MgaW5kZXhlZCBvcGVyYXRvciwKICAgIGFkZHJlc3MgaW5kZXhlZCBob2xkZXIsCiAgICBib29sIGF1dGhvcml6ZWQKICApOwp9CgovLyBGaWxlOiBlaXA4MjAvY29udHJhY3RzL0ludGVyZmFjZUltcGxlbWVudGF0aW9uUmVnaXN0cnkuc29sCgpjb250cmFjdCBJbnRlcmZhY2VJbXBsZW1lbnRhdGlvblJlZ2lzdHJ5IHsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcoYnl0ZXMzMiA9PiBhZGRyZXNzKSkgaW50ZXJmYWNlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYWRkcmVzcykgcHVibGljIG1hbmFnZXJzOwoKICAgIG1vZGlmaWVyIGNhbk1hbmFnZShhZGRyZXNzIGFkZHIpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYWRkciB8fCBtc2cuc2VuZGVyID09IG1hbmFnZXJzW2FkZHJdKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIGludGVyZmFjZUhhc2goc3RyaW5nIGludGVyZmFjZU5hbWUpIHB1YmxpYyBwdXJlIHJldHVybnMoYnl0ZXMzMikgewogICAgICAgIHJldHVybiBrZWNjYWsyNTYoaW50ZXJmYWNlTmFtZSk7CiAgICB9CgoKICAgIC8vLyBAbm90aWNlIFF1ZXJ5IGlmIGFuIGFkZHJlc3MgaW1wbGVtZW50cyBhbiBpbnRlcmZhY2UgYW5kIHRocnUgd2hpY2ggY29udHJhY3QKICAgIC8vLyBAcGFyYW0gYWRkciBBZGRyZXNzIHRoYXQgaXMgYmVpbmcgcXVlcmllZCBmb3IgdGhlIGltcGxlbWVudGF0aW9uIG9mIGFuIGludGVyZmFjZQogICAgLy8vIEBwYXJhbSBpSGFzaCBTSEEzIG9mIHRoZSBuYW1lIG9mIHRoZSBpbnRlcmZhY2UgYXMgYSBzdHJpbmcKICAgIC8vLyAgRXhhbXBsZSBgd2ViMy51dGlscy5zaGEzKCdJZXJjNzc3YCcpYAogICAgLy8vIEByZXR1cm4gVGhlIGFkZHJlc3Mgb2YgdGhlIGNvbnRyYWN0IHRoYXQgaW1wbGVtZW50cyBhIHNwZWZpY2ljIGludGVyZmFjZQogICAgLy8vICBvciAweDAgaWYgYGFkZHJgIGRvZXMgbm90IGltcGxlbWVudCB0aGlzIGludGVyZmFjZQogICAgZnVuY3Rpb24gZ2V0SW50ZXJmYWNlSW1wbGVtZW50ZXIoYWRkcmVzcyBhZGRyLCBieXRlczMyIGlIYXNoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcykgewogICAgICAgIHJldHVybiBpbnRlcmZhY2VzW2FkZHJdW2lIYXNoXTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBTZXRzIHRoZSBjb250cmFjdCB0aGF0IHdpbGwgaGFuZGxlIGEgc3BlY2lmaWMgaW50ZXJmYWNlOyBvbmx5CiAgICAvLy8gIHRoZSBhZGRyZXNzIGl0c2VsZiBvciBhIGBtYW5hZ2VyYCBkZWZpbmVkIGZvciB0aGF0IGFkZHJlc3MgY2FuIHNldCBpdAogICAgLy8vIEBwYXJhbSBhZGRyIEFkZHJlc3MgdGhhdCB5b3Ugd2FudCB0byBkZWZpbmUgdGhlIGludGVyZmFjZSBmb3IKICAgIC8vLyBAcGFyYW0gaUhhc2ggU0hBMyBvZiB0aGUgbmFtZSBvZiB0aGUgaW50ZXJmYWNlIGFzIGEgc3RyaW5nCiAgICAvLy8gIEZvciBleGFtcGxlIGB3ZWIzLnV0aWxzLnNoYTMoJ0llcmM3NzcnKWAgZm9yIHRoZSBJZXJjNzc3CiAgICBmdW5jdGlvbiBzZXRJbnRlcmZhY2VJbXBsZW1lbnRlcihhZGRyZXNzIGFkZHIsIGJ5dGVzMzIgaUhhc2gsIGFkZHJlc3MgaW1wbGVtZW50ZXIpIHB1YmxpYyBjYW5NYW5hZ2UoYWRkcikgIHsKICAgICAgICBpbnRlcmZhY2VzW2FkZHJdW2lIYXNoXSA9IGltcGxlbWVudGVyOwogICAgICAgIEludGVyZmFjZUltcGxlbWVudGVyU2V0KGFkZHIsIGlIYXNoLCBpbXBsZW1lbnRlcik7CiAgICB9CgogICAgLy8vIEBub3RpY2UgU2V0cyBhbiBleHRlcm5hbCBgbWFuYWdlcmAgdGhhdCB3aWxsIGJlIGFibGUgdG8gY2FsbCBgc2V0SW50ZXJmYWNlSW1wbGVtZW50ZXIoKWAKICAgIC8vLyAgb24gYmVoYWxmIG9mIHRoZSBhZGRyZXNzLgogICAgLy8vIEBwYXJhbSBhZGRyIEFkZHJlc3MgdGhhdCB5b3UgYXJlIGRlZmluaW5nIHRoZSBtYW5hZ2VyIGZvci4KICAgIC8vLyBAcGFyYW0gbmV3TWFuYWdlciBUaGUgYWRkcmVzcyBvZiB0aGUgbWFuYWdlciBmb3IgdGhlIGBhZGRyYCB0aGF0IHdpbGwgcmVwbGFjZQogICAgLy8vICB0aGUgb2xkIG9uZS4gIFNldCB0byAweDAgaWYgeW91IHdhbnQgdG8gcmVtb3ZlIHRoZSBtYW5hZ2VyLgogICAgZnVuY3Rpb24gY2hhbmdlTWFuYWdlcihhZGRyZXNzIGFkZHIsIGFkZHJlc3MgbmV3TWFuYWdlcikgcHVibGljIGNhbk1hbmFnZShhZGRyKSB7CiAgICAgICAgbWFuYWdlcnNbYWRkcl0gPSBuZXdNYW5hZ2VyOwogICAgICAgIE1hbmFnZXJDaGFuZ2VkKGFkZHIsIG5ld01hbmFnZXIpOwogICAgfQoKICAgIGV2ZW50IEludGVyZmFjZUltcGxlbWVudGVyU2V0KGFkZHJlc3MgaW5kZXhlZCBhZGRyLCBieXRlczMyIGluZGV4ZWQgaW50ZXJmYWNlSGFzaCwgYWRkcmVzcyBpbmRleGVkIGltcGxlbWVudGVyKTsKICAgIGV2ZW50IE1hbmFnZXJDaGFuZ2VkKGFkZHJlc3MgaW5kZXhlZCBhZGRyLCBhZGRyZXNzIGluZGV4ZWQgbmV3TWFuYWdlcik7Cn0KCi8vIEZpbGU6IGVpcDgyMC9jb250cmFjdHMvRUlQODIwLnNvbAoKY29udHJhY3QgRUlQODIwIHsKICAgIEludGVyZmFjZUltcGxlbWVudGF0aW9uUmVnaXN0cnkgaW50ZXJmYWNlSW1wbGVtZW50YXRpb25SZWdpc3RyeSA9IEludGVyZmFjZUltcGxlbWVudGF0aW9uUmVnaXN0cnkoMHg5NDQwNUMzMjIzMDg5QTk0MkI3NTk3ZEI5NkRjNjBGY0ExN0IwRTNBKTsKCiAgICBmdW5jdGlvbiBzZXRJbnRlcmZhY2VJbXBsZW1lbnRhdGlvbihzdHJpbmcgaWZhY2VMYWJlbCwgYWRkcmVzcyBpbXBsKSBpbnRlcm5hbCB7CiAgICAgICAgaW50ZXJmYWNlSW1wbGVtZW50YXRpb25SZWdpc3RyeS5zZXRJbnRlcmZhY2VJbXBsZW1lbnRlcih0aGlzLCBrZWNjYWsyNTYoaWZhY2VMYWJlbCksIGltcGwpOwogICAgfQoKICAgIGZ1bmN0aW9uIGludGVyZmFjZUFkZHIoYWRkcmVzcyBhZGRyLCBzdHJpbmcgaWZhY2VMYWJlbCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyhhZGRyZXNzKSB7CiAgICAgICAgcmV0dXJuIGludGVyZmFjZUltcGxlbWVudGF0aW9uUmVnaXN0cnkuZ2V0SW50ZXJmYWNlSW1wbGVtZW50ZXIoYWRkciwga2VjY2FrMjU2KGlmYWNlTGFiZWwpKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWxlZ2F0ZU1hbmFnZW1lbnQoYWRkcmVzcyBuZXdNYW5hZ2VyKSBpbnRlcm5hbCB7CiAgICAgICAgaW50ZXJmYWNlSW1wbGVtZW50YXRpb25SZWdpc3RyeS5jaGFuZ2VNYW5hZ2VyKHRoaXMsIG5ld01hbmFnZXIpOwogICAgfQp9CgovLyBGaWxlOiB6ZXBwZWxpbi1zb2xpZGl0eS9jb250cmFjdHMvbWF0aC9TYWZlTWF0aC5zb2wKCi8qKgogKiBAdGl0bGUgU2FmZU1hdGgKICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3IKICovCmxpYnJhcnkgU2FmZU1hdGggewogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCi8vIEZpbGU6IGVyYzgyMS9jb250cmFjdHMvU3RhbmRhcmRBc3NldFJlZ2lzdHJ5LnNvbAoKY29udHJhY3QgU3RhbmRhcmRBc3NldFJlZ2lzdHJ5IGlzIEFzc2V0UmVnaXN0cnlTdG9yYWdlLCBJQXNzZXRSZWdpc3RyeSwgRUlQODIwIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgLy8KICAvLyBHbG9iYWwgR2V0dGVycwogIC8vCgogIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBfbmFtZTsKICB9CgogIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZykgewogICAgcmV0dXJuIF9zeW1ib2w7CiAgfQoKICBmdW5jdGlvbiBkZXNjcmlwdGlvbigpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZykgewogICAgcmV0dXJuIF9kZXNjcmlwdGlvbjsKICB9CgogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIF9jb3VudDsKICB9CgogIC8vCiAgLy8gQXNzZXQtY2VudHJpYyBnZXR0ZXIgZnVuY3Rpb25zCiAgLy8KCiAgZnVuY3Rpb24gZXhpc3RzKHVpbnQyNTYgYXNzZXRJZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIF9ob2xkZXJPZlthc3NldElkXSAhPSAwOwogIH0KCiAgZnVuY3Rpb24gaG9sZGVyT2YodWludDI1NiBhc3NldElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICByZXR1cm4gX2hvbGRlck9mW2Fzc2V0SWRdOwogIH0KCiAgZnVuY3Rpb24gc2FmZUhvbGRlck9mKHVpbnQyNTYgYXNzZXRJZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcykgewogICAgYWRkcmVzcyBob2xkZXIgPSBfaG9sZGVyT2ZbYXNzZXRJZF07CiAgICByZXF1aXJlKGhvbGRlciAhPSAwKTsKICAgIHJldHVybiBob2xkZXI7CiAgfQoKICBmdW5jdGlvbiBhc3NldERhdGEodWludDI1NiBhc3NldElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBfYXNzZXREYXRhW2Fzc2V0SWRdOwogIH0KCiAgZnVuY3Rpb24gc2FmZUFzc2V0RGF0YSh1aW50MjU2IGFzc2V0SWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZykgewogICAgcmVxdWlyZShfaG9sZGVyT2ZbYXNzZXRJZF0gIT0gMCk7CiAgICByZXR1cm4gX2Fzc2V0RGF0YVthc3NldElkXTsKICB9CgogIC8vCiAgLy8gSG9sZGVyLWNlbnRyaWMgZ2V0dGVyIGZ1bmN0aW9ucwogIC8vCgogIGZ1bmN0aW9uIGFzc2V0Q291bnQoYWRkcmVzcyBob2xkZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBfYXNzZXRzT2ZbaG9sZGVyXS5sZW5ndGg7CiAgfQoKICBmdW5jdGlvbiBhc3NldEJ5SW5kZXgoYWRkcmVzcyBob2xkZXIsIHVpbnQyNTYgaW5kZXgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJlcXVpcmUoaW5kZXggPCBfYXNzZXRzT2ZbaG9sZGVyXS5sZW5ndGgpOwogICAgcmVxdWlyZShpbmRleCA8ICgxPDwxMjcpKTsKICAgIHJldHVybiBfYXNzZXRzT2ZbaG9sZGVyXVtpbmRleF07CiAgfQoKICBmdW5jdGlvbiBhc3NldHNPZihhZGRyZXNzIGhvbGRlcikgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2W10pIHsKICAgIHJldHVybiBfYXNzZXRzT2ZbaG9sZGVyXTsKICB9CgogIC8vCiAgLy8gQXV0aG9yaXphdGlvbiBnZXR0ZXJzCiAgLy8KCiAgZnVuY3Rpb24gaXNPcGVyYXRvckF1dGhvcml6ZWRGb3IoYWRkcmVzcyBvcGVyYXRvciwgYWRkcmVzcyBhc3NldEhvbGRlcikKICAgIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpCiAgewogICAgcmV0dXJuIF9vcGVyYXRvcnNbYXNzZXRIb2xkZXJdW29wZXJhdG9yXTsKICB9CgogIGZ1bmN0aW9uIGF1dGhvcml6ZU9wZXJhdG9yKGFkZHJlc3Mgb3BlcmF0b3IsIGJvb2wgYXV0aG9yaXplZCkgcHVibGljIHsKICAgIGlmIChhdXRob3JpemVkKSB7CiAgICAgIHJlcXVpcmUoIWlzT3BlcmF0b3JBdXRob3JpemVkRm9yKG9wZXJhdG9yLCBtc2cuc2VuZGVyKSk7CiAgICAgIF9hZGRBdXRob3JpemF0aW9uKG9wZXJhdG9yLCBtc2cuc2VuZGVyKTsKICAgIH0gZWxzZSB7CiAgICAgIHJlcXVpcmUoaXNPcGVyYXRvckF1dGhvcml6ZWRGb3Iob3BlcmF0b3IsIG1zZy5zZW5kZXIpKTsKICAgICAgX2NsZWFyQXV0aG9yaXphdGlvbihvcGVyYXRvciwgbXNnLnNlbmRlcik7CiAgICB9CiAgICBBdXRob3JpemVPcGVyYXRvcihvcGVyYXRvciwgbXNnLnNlbmRlciwgYXV0aG9yaXplZCk7CiAgfQoKICBmdW5jdGlvbiBfYWRkQXV0aG9yaXphdGlvbihhZGRyZXNzIG9wZXJhdG9yLCBhZGRyZXNzIGhvbGRlcikgcHJpdmF0ZSB7CiAgICBfb3BlcmF0b3JzW2hvbGRlcl1bb3BlcmF0b3JdID0gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIF9jbGVhckF1dGhvcml6YXRpb24oYWRkcmVzcyBvcGVyYXRvciwgYWRkcmVzcyBob2xkZXIpIHByaXZhdGUgewogICAgX29wZXJhdG9yc1tob2xkZXJdW29wZXJhdG9yXSA9IGZhbHNlOwogIH0KCiAgLy8KICAvLyBJbnRlcm5hbCBPcGVyYXRpb25zCiAgLy8KCiAgZnVuY3Rpb24gX2FkZEFzc2V0VG8oYWRkcmVzcyB0bywgdWludDI1NiBhc3NldElkKSBpbnRlcm5hbCB7CiAgICBfaG9sZGVyT2ZbYXNzZXRJZF0gPSB0bzsKCiAgICB1aW50MjU2IGxlbmd0aCA9IGFzc2V0Q291bnQodG8pOwoKICAgIF9hc3NldHNPZlt0b10ucHVzaChhc3NldElkKTsKCiAgICBfaW5kZXhPZkFzc2V0W2Fzc2V0SWRdID0gbGVuZ3RoOwoKICAgIF9jb3VudCA9IF9jb3VudC5hZGQoMSk7CiAgfQoKICBmdW5jdGlvbiBfYWRkQXNzZXRUbyhhZGRyZXNzIHRvLCB1aW50MjU2IGFzc2V0SWQsIHN0cmluZyBkYXRhKSBpbnRlcm5hbCB7CiAgICBfYWRkQXNzZXRUbyh0bywgYXNzZXRJZCk7CgogICAgX2Fzc2V0RGF0YVthc3NldElkXSA9IGRhdGE7CiAgfQoKICBmdW5jdGlvbiBfcmVtb3ZlQXNzZXRGcm9tKGFkZHJlc3MgZnJvbSwgdWludDI1NiBhc3NldElkKSBpbnRlcm5hbCB7CiAgICB1aW50MjU2IGFzc2V0SW5kZXggPSBfaW5kZXhPZkFzc2V0W2Fzc2V0SWRdOwogICAgdWludDI1NiBsYXN0QXNzZXRJbmRleCA9IGFzc2V0Q291bnQoZnJvbSkuc3ViKDEpOwogICAgdWludDI1NiBsYXN0QXNzZXRJZCA9IF9hc3NldHNPZltmcm9tXVtsYXN0QXNzZXRJbmRleF07CgogICAgX2hvbGRlck9mW2Fzc2V0SWRdID0gMDsKCiAgICAvLyBJbnNlcnQgdGhlIGxhc3QgYXNzZXQgaW50byB0aGUgcG9zaXRpb24gcHJldmlvdXNseSBvY2N1cGllZCBieSB0aGUgYXNzZXQgdG8gYmUgcmVtb3ZlZAogICAgX2Fzc2V0c09mW2Zyb21dW2Fzc2V0SW5kZXhdID0gbGFzdEFzc2V0SWQ7CgogICAgLy8gUmVzaXplIHRoZSBhcnJheQogICAgX2Fzc2V0c09mW2Zyb21dW2xhc3RBc3NldEluZGV4XSA9IDA7CiAgICBfYXNzZXRzT2ZbZnJvbV0ubGVuZ3RoLS07CgogICAgLy8gUmVtb3ZlIHRoZSBhcnJheSBpZiBubyBtb3JlIGFzc2V0cyBhcmUgb3duZWQgdG8gcHJldmVudCBwb2xsdXRpb24KICAgIGlmIChfYXNzZXRzT2ZbZnJvbV0ubGVuZ3RoID09IDApIHsKICAgICAgZGVsZXRlIF9hc3NldHNPZltmcm9tXTsKICAgIH0KCiAgICAvLyBVcGRhdGUgdGhlIGluZGV4IG9mIHBvc2l0aW9ucyBmb3IgdGhlIGFzc2V0CiAgICBfaW5kZXhPZkFzc2V0W2Fzc2V0SWRdID0gMDsKICAgIF9pbmRleE9mQXNzZXRbbGFzdEFzc2V0SWRdID0gYXNzZXRJbmRleDsKCiAgICBfY291bnQgPSBfY291bnQuc3ViKDEpOwogIH0KCiAgZnVuY3Rpb24gX3JlbW92ZUFzc2V0RGF0YSh1aW50MjU2IGFzc2V0SWQpIGludGVybmFsIHsKICAgIF9hc3NldERhdGFbYXNzZXRJZF0gPSAnJzsKICB9CgogIC8vCiAgLy8gU3VwcGx5LWFsdGVyaW5nIGZ1bmN0aW9ucwogIC8vCgogIGZ1bmN0aW9uIF9nZW5lcmF0ZSh1aW50MjU2IGFzc2V0SWQsIGFkZHJlc3MgYmVuZWZpY2lhcnksIHN0cmluZyBkYXRhKSBpbnRlcm5hbCB7CiAgICByZXF1aXJlKF9ob2xkZXJPZlthc3NldElkXSA9PSAwKTsKCiAgICBfYWRkQXNzZXRUbyhiZW5lZmljaWFyeSwgYXNzZXRJZCwgZGF0YSk7CgogICAgVHJhbnNmZXIoMCwgYmVuZWZpY2lhcnksIGFzc2V0SWQsIG1zZy5zZW5kZXIsIGJ5dGVzKGRhdGEpLCAnJyk7CiAgfQoKICBmdW5jdGlvbiBfZGVzdHJveSh1aW50MjU2IGFzc2V0SWQpIGludGVybmFsIHsKICAgIGFkZHJlc3MgaG9sZGVyID0gX2hvbGRlck9mW2Fzc2V0SWRdOwogICAgcmVxdWlyZShob2xkZXIgIT0gMCk7CgogICAgX3JlbW92ZUFzc2V0RnJvbShob2xkZXIsIGFzc2V0SWQpOwogICAgX3JlbW92ZUFzc2V0RGF0YShhc3NldElkKTsKCiAgICBUcmFuc2Zlcihob2xkZXIsIDAsIGFzc2V0SWQsIG1zZy5zZW5kZXIsICcnLCAnJyk7CiAgfQoKICAvLwogIC8vIFRyYW5zYWN0aW9uIHJlbGF0ZWQgb3BlcmF0aW9ucwogIC8vCgogIG1vZGlmaWVyIG9ubHlIb2xkZXIodWludDI1NiBhc3NldElkKSB7CiAgICByZXF1aXJlKF9ob2xkZXJPZlthc3NldElkXSA9PSBtc2cuc2VuZGVyKTsKICAgIF87CiAgfQoKICBtb2RpZmllciBvbmx5T3BlcmF0b3JPckhvbGRlcih1aW50MjU2IGFzc2V0SWQpIHsKICAgIHJlcXVpcmUoX2hvbGRlck9mW2Fzc2V0SWRdID09IG1zZy5zZW5kZXIKICAgICAgICAgfHwgaXNPcGVyYXRvckF1dGhvcml6ZWRGb3IobXNnLnNlbmRlciwgX2hvbGRlck9mW2Fzc2V0SWRdKSk7CiAgICBfOwogIH0KCiAgbW9kaWZpZXIgaXNEZXN0aW5hdGFyeURlZmluZWQoYWRkcmVzcyBkZXN0aW5hdGFyeSkgewogICAgcmVxdWlyZShkZXN0aW5hdGFyeSAhPSAwKTsKICAgIF87CiAgfQoKICBtb2RpZmllciBkZXN0aW5hdGFyeUlzTm90SG9sZGVyKHVpbnQyNTYgYXNzZXRJZCwgYWRkcmVzcyB0bykgewogICAgcmVxdWlyZShfaG9sZGVyT2ZbYXNzZXRJZF0gIT0gdG8pOwogICAgXzsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgYXNzZXRJZCkgcHVibGljIHsKICAgIHJldHVybiBfZG9UcmFuc2Zlcih0bywgYXNzZXRJZCwgJycsIDAsICcnKTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgYXNzZXRJZCwgYnl0ZXMgdXNlckRhdGEpIHB1YmxpYyB7CiAgICByZXR1cm4gX2RvVHJhbnNmZXIodG8sIGFzc2V0SWQsIHVzZXJEYXRhLCAwLCAnJyk7CiAgfQoKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IGFzc2V0SWQsIGJ5dGVzIHVzZXJEYXRhLCBieXRlcyBvcGVyYXRvckRhdGEpIHB1YmxpYyB7CiAgICByZXR1cm4gX2RvVHJhbnNmZXIodG8sIGFzc2V0SWQsIHVzZXJEYXRhLCBtc2cuc2VuZGVyLCBvcGVyYXRvckRhdGEpOwogIH0KCiAgZnVuY3Rpb24gX2RvVHJhbnNmZXIoCiAgICBhZGRyZXNzIHRvLCB1aW50MjU2IGFzc2V0SWQsIGJ5dGVzIHVzZXJEYXRhLCBhZGRyZXNzIG9wZXJhdG9yLCBieXRlcyBvcGVyYXRvckRhdGEKICApCiAgICBpc0Rlc3RpbmF0YXJ5RGVmaW5lZCh0bykKICAgIGRlc3RpbmF0YXJ5SXNOb3RIb2xkZXIoYXNzZXRJZCwgdG8pCiAgICBvbmx5T3BlcmF0b3JPckhvbGRlcihhc3NldElkKQogICAgaW50ZXJuYWwKICB7CiAgICByZXR1cm4gX2RvU2VuZCh0bywgYXNzZXRJZCwgdXNlckRhdGEsIG9wZXJhdG9yLCBvcGVyYXRvckRhdGEpOwogIH0KCgogIGZ1bmN0aW9uIF9kb1NlbmQoCiAgICBhZGRyZXNzIHRvLCB1aW50MjU2IGFzc2V0SWQsIGJ5dGVzIHVzZXJEYXRhLCBhZGRyZXNzIG9wZXJhdG9yLCBieXRlcyBvcGVyYXRvckRhdGEKICApCiAgICBpbnRlcm5hbAogIHsKICAgIGFkZHJlc3MgaG9sZGVyID0gX2hvbGRlck9mW2Fzc2V0SWRdOwogICAgX3JlbW92ZUFzc2V0RnJvbShob2xkZXIsIGFzc2V0SWQpOwogICAgX2FkZEFzc2V0VG8odG8sIGFzc2V0SWQpOwoKICAgIGlmIChfaXNDb250cmFjdCh0bykpIHsKICAgICAgcmVxdWlyZSghX3JlZW50cmFuY3kpOwogICAgICBfcmVlbnRyYW5jeSA9IHRydWU7CgogICAgICBhZGRyZXNzIHJlY2lwaWVudCA9IGludGVyZmFjZUFkZHIodG8sICdJQXNzZXRIb2xkZXInKTsKICAgICAgcmVxdWlyZShyZWNpcGllbnQgIT0gMCk7CgogICAgICBJQXNzZXRIb2xkZXIocmVjaXBpZW50KS5vbkFzc2V0UmVjZWl2ZWQoYXNzZXRJZCwgaG9sZGVyLCB0bywgdXNlckRhdGEsIG9wZXJhdG9yLCBvcGVyYXRvckRhdGEpOwoKICAgICAgX3JlZW50cmFuY3kgPSBmYWxzZTsKICAgIH0KCiAgICBUcmFuc2Zlcihob2xkZXIsIHRvLCBhc3NldElkLCBvcGVyYXRvciwgdXNlckRhdGEsIG9wZXJhdG9yRGF0YSk7CiAgfQoKICAvLwogIC8vIFVwZGF0ZSByZWxhdGVkIGZ1bmN0aW9ucwogIC8vCgogIGZ1bmN0aW9uIF91cGRhdGUodWludDI1NiBhc3NldElkLCBzdHJpbmcgZGF0YSkgaW50ZXJuYWwgewogICAgcmVxdWlyZShleGlzdHMoYXNzZXRJZCkpOwogICAgX2Fzc2V0RGF0YVthc3NldElkXSA9IGRhdGE7CiAgICBVcGRhdGUoYXNzZXRJZCwgX2hvbGRlck9mW2Fzc2V0SWRdLCBtc2cuc2VuZGVyLCBkYXRhKTsKICB9CgogIC8vCiAgLy8gVXRpbGl0aWVzCiAgLy8KCiAgZnVuY3Rpb24gX2lzQ29udHJhY3QoYWRkcmVzcyBhZGRyKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgIHVpbnQgc2l6ZTsKICAgIGFzc2VtYmx5IHsgc2l6ZSA6PSBleHRjb2Rlc2l6ZShhZGRyKSB9CiAgICByZXR1cm4gc2l6ZSA+IDA7CiAgfQp9CgovLyBGaWxlOiBjb250cmFjdHMvbGFuZC9MQU5EUmVnaXN0cnkuc29sCgpjb250cmFjdCBMQU5EUmVnaXN0cnkgaXMgU3RvcmFnZSwKICBPd25hYmxlLCBTdGFuZGFyZEFzc2V0UmVnaXN0cnksCiAgSUxBTkRSZWdpc3RyeQp7CgogIGZ1bmN0aW9uIGluaXRpYWxpemUoYnl0ZXMgZGF0YSkgcHVibGljIHsKICAgIF9uYW1lID0gJ0RlY2VudHJhbGFuZCBMQU5EJzsKICAgIF9zeW1ib2wgPSAnTEFORCc7CiAgICBfZGVzY3JpcHRpb24gPSAnQ29udHJhY3QgdGhhdCBzdG9yZXMgdGhlIERlY2VudHJhbGFuZCBMQU5EIHJlZ2lzdHJ5JzsKICAgIHN1cGVyLmluaXRpYWxpemUoZGF0YSk7CiAgfQoKICBmdW5jdGlvbiBhdXRob3JpemVEZXBsb3koYWRkcmVzcyBiZW5lZmljaWFyeSkgcHVibGljIG9ubHlPd25lciB7CiAgICBhdXRob3JpemVkRGVwbG95W2JlbmVmaWNpYXJ5XSA9IHRydWU7CiAgfQogIGZ1bmN0aW9uIGZvcmJpZERlcGxveShhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgb25seU93bmVyIHsKICAgIGF1dGhvcml6ZWREZXBsb3lbYmVuZWZpY2lhcnldID0gZmFsc2U7CiAgfQoKICBmdW5jdGlvbiBhc3NpZ25OZXdQYXJjZWwoaW50IHgsIGludCB5LCBhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgewogICAgcmVxdWlyZShhdXRob3JpemVkRGVwbG95W21zZy5zZW5kZXJdKTsKICAgIF9nZW5lcmF0ZShlbmNvZGVUb2tlbklkKHgsIHkpLCBiZW5lZmljaWFyeSwgJycpOwogIH0KCiAgZnVuY3Rpb24gYXNzaWduTXVsdGlwbGVQYXJjZWxzKGludFtdIHgsIGludFtdIHksIGFkZHJlc3MgYmVuZWZpY2lhcnkpIHB1YmxpYyB7CiAgICByZXF1aXJlKGF1dGhvcml6ZWREZXBsb3lbbXNnLnNlbmRlcl0pOwogICAgZm9yICh1aW50IGkgPSAwOyBpIDwgeC5sZW5ndGg7IGkrKykgewogICAgICBfZ2VuZXJhdGUoZW5jb2RlVG9rZW5JZCh4W2ldLCB5W2ldKSwgYmVuZWZpY2lhcnksICcnKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGRlc3Ryb3kodWludDI1NiBhc3NldElkKSBvbmx5T3duZXIgcHVibGljIHsKICAgIF9kZXN0cm95KGFzc2V0SWQpOwogIH0KCiAgLy8KICAvLyBJbmFjdGl2ZSBrZXlzIGFmdGVyIDEgeWVhciBsb3NlIG93bmVyc2hpcAogIC8vCgogIGZ1bmN0aW9uIHBpbmcoKSBwdWJsaWMgewogICAgbGF0ZXN0UGluZ1ttc2cuc2VuZGVyXSA9IG5vdzsKICB9CgogIGZ1bmN0aW9uIHNldExhdGVzdFRvTm93KGFkZHJlc3MgdXNlcikgb25seU93bmVyIHB1YmxpYyB7CiAgICBsYXRlc3RQaW5nW3VzZXJdID0gbm93OwogIH0KCiAgZnVuY3Rpb24gbXVsdGlwbGVQaW5nKGFkZHJlc3NbXSB1c2VycykgcHVibGljIHsKICAgIHJlcXVpcmUoYXV0aG9yaXplZERlcGxveVttc2cuc2VuZGVyXSk7CiAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCB1c2Vycy5sZW5ndGg7IGkrKykgewogICAgICBsYXRlc3RQaW5nW3VzZXJzW2ldXSA9IG5vdzsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGNsZWFyTGFuZChpbnRbXSB4LCBpbnRbXSB5KSBwdWJsaWMgewogICAgcmVxdWlyZSh4Lmxlbmd0aCA9PSB5Lmxlbmd0aCk7CiAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSsrKSB7CiAgICAgIHVpbnQgbGFuZElkID0gZW5jb2RlVG9rZW5JZCh4W2ldLCB5W2ldKTsKICAgICAgYWRkcmVzcyBob2xkZXIgPSBob2xkZXJPZihsYW5kSWQpOwogICAgICBpZiAobGF0ZXN0UGluZ1tob2xkZXJdIDwgbm93IC0gMSB5ZWFycykgewogICAgICAgIF9kZXN0cm95KGxhbmRJZCk7CiAgICAgIH0KICAgIH0KICB9CgogIC8vIEVSQzIwIGNvbXBhdGliaWxpdHkgZnVuY3Rpb25zCiAgZnVuY3Rpb24gZGVjaW1hbHMoKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50OCkgewogICAgcmV0dXJuIDA7CiAgfQoKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB1c2VyKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gYXNzZXRDb3VudCh1c2VyKTsKICB9CgogIC8vCiAgLy8gTEFORCBHZXR0ZXJzCiAgLy8KCiAgZnVuY3Rpb24gZW5jb2RlVG9rZW5JZChpbnQgeCwgaW50IHkpIHZpZXcgcHVibGljIHJldHVybnMgKHVpbnQpIHsKICAgIHJldHVybiAoKHVpbnQoeCkgKiBmYWN0b3IpICYgY2xlYXJMb3cpIHwgKHVpbnQoeSkgJiBjbGVhckhpZ2gpOwogIH0KCiAgZnVuY3Rpb24gZGVjb2RlVG9rZW5JZCh1aW50IHZhbHVlKSB2aWV3IHB1YmxpYyByZXR1cm5zIChpbnQsIGludCkgewogICAgdWludCB4ID0gKHZhbHVlICYgY2xlYXJMb3cpID4+IDEyODsKICAgIHVpbnQgeSA9ICh2YWx1ZSAmIGNsZWFySGlnaCk7CiAgICByZXR1cm4gKGV4cGFuZE5lZ2F0aXZlMTI4Qml0Q2FzdCh4KSwgZXhwYW5kTmVnYXRpdmUxMjhCaXRDYXN0KHkpKTsKICB9CgogIGZ1bmN0aW9uIGV4cGFuZE5lZ2F0aXZlMTI4Qml0Q2FzdCh1aW50IHZhbHVlKSB2aWV3IHB1YmxpYyByZXR1cm5zIChpbnQpIHsKICAgIGlmICh2YWx1ZSAmICgxPDwxMjcpICE9IDApIHsKICAgICAgcmV0dXJuIGludCh2YWx1ZSB8IGNsZWFyTG93KTsKICAgIH0KICAgIHJldHVybiBpbnQodmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gZXhpc3RzKGludCB4LCBpbnQgeSkgdmlldyBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIGV4aXN0cyhlbmNvZGVUb2tlbklkKHgsIHkpKTsKICB9CgogIGZ1bmN0aW9uIG93bmVyT2ZMYW5kKGludCB4LCBpbnQgeSkgdmlldyBwdWJsaWMgcmV0dXJucyAoYWRkcmVzcykgewogICAgcmV0dXJuIGhvbGRlck9mKGVuY29kZVRva2VuSWQoeCwgeSkpOwogIH0KCiAgZnVuY3Rpb24gb3duZXJPZkxhbmRNYW55KGludFtdIHgsIGludFtdIHkpIHZpZXcgcHVibGljIHJldHVybnMgKGFkZHJlc3NbXSkgewogICAgcmVxdWlyZSh4Lmxlbmd0aCA+IDApOwogICAgcmVxdWlyZSh4Lmxlbmd0aCA9PSB5Lmxlbmd0aCk7CgogICAgYWRkcmVzc1tdIG1lbW9yeSBhZGRycyA9IG5ldyBhZGRyZXNzW10oeC5sZW5ndGgpOwogICAgZm9yICh1aW50IGkgPSAwOyBpIDwgeC5sZW5ndGg7IGkrKykgewogICAgICBhZGRyc1tpXSA9IG93bmVyT2ZMYW5kKHhbaV0sIHlbaV0pOwogICAgfQoKICAgIHJldHVybiBhZGRyczsKICB9CgogIGZ1bmN0aW9uIGxhbmRPZihhZGRyZXNzIG93bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zIChpbnRbXSwgaW50W10pIHsKICAgIGludFtdIG1lbW9yeSB4ID0gbmV3IGludFtdKF9hc3NldHNPZltvd25lcl0ubGVuZ3RoKTsKICAgIGludFtdIG1lbW9yeSB5ID0gbmV3IGludFtdKF9hc3NldHNPZltvd25lcl0ubGVuZ3RoKTsKCiAgICBpbnQgYXNzZXRYOwogICAgaW50IGFzc2V0WTsKICAgIHVpbnQgbGVuZ3RoID0gX2Fzc2V0c09mW293bmVyXS5sZW5ndGg7CiAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAoYXNzZXRYLCBhc3NldFkpID0gZGVjb2RlVG9rZW5JZChfYXNzZXRzT2Zbb3duZXJdW2ldKTsKICAgICAgeFtpXSA9IGFzc2V0WDsKICAgICAgeVtpXSA9IGFzc2V0WTsKICAgIH0KCiAgICByZXR1cm4gKHgsIHkpOwogIH0KCiAgZnVuY3Rpb24gbGFuZERhdGEoaW50IHgsIGludCB5KSB2aWV3IHB1YmxpYyByZXR1cm5zIChzdHJpbmcpIHsKICAgIHJldHVybiBhc3NldERhdGEoZW5jb2RlVG9rZW5JZCh4LCB5KSk7CiAgfQoKICAvLwogIC8vIFRyYW5zZmVyIExBTkQKICAvLwoKICBmdW5jdGlvbiB0cmFuc2ZlckxhbmQoaW50IHgsIGludCB5LCBhZGRyZXNzIHRvKSBwdWJsaWMgewogICAgdHJhbnNmZXIodG8sIGVuY29kZVRva2VuSWQoeCwgeSkpOwogIH0KCiAgZnVuY3Rpb24gdHJhbnNmZXJNYW55TGFuZChpbnRbXSB4LCBpbnRbXSB5LCBhZGRyZXNzIHRvKSBwdWJsaWMgewogICAgcmVxdWlyZSh4Lmxlbmd0aCA9PSB5Lmxlbmd0aCk7CiAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSsrKSB7CiAgICAgIHRyYW5zZmVyKHRvLCBlbmNvZGVUb2tlbklkKHhbaV0sIHlbaV0pKTsKICAgIH0KICB9CgogIC8vCiAgLy8gVXBkYXRlIExBTkQKICAvLwoKICBmdW5jdGlvbiB1cGRhdGVMYW5kRGF0YShpbnQgeCwgaW50IHksIHN0cmluZyBkYXRhKSBwdWJsaWMgb25seU9wZXJhdG9yT3JIb2xkZXIoZW5jb2RlVG9rZW5JZCh4LCB5KSkgewogICAgcmV0dXJuIF91cGRhdGUoZW5jb2RlVG9rZW5JZCh4LCB5KSwgZGF0YSk7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVNYW55TGFuZERhdGEoaW50W10geCwgaW50W10geSwgc3RyaW5nIGRhdGEpIHB1YmxpYyB7CiAgICByZXF1aXJlKHgubGVuZ3RoID09IHkubGVuZ3RoKTsKICAgIGZvciAodWludCBpID0gMDsgaSA8IHgubGVuZ3RoOyBpKyspIHsKICAgICAgdXBkYXRlTGFuZERhdGEoeFtpXSwgeVtpXSwgZGF0YSk7CiAgICB9CiAgfQp9'.
	

]
