Class {
	#name : #SRT622dFfCc4e83C64ba959530A5a5580687a57581b,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT622dFfCc4e83C64ba959530A5a5580687a57581b >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICAgIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSAqIGI7CiAgICAgICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoYiA8PSBhKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgICAgICBhc3NlcnQoYyA+PSBhKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KfQoKY29udHJhY3Qgb3duZWQgewogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICBmdW5jdGlvbiBvd25lZCgpIHB1YmxpYyB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUobmV3T3duZXIgIT0gMHgwKTsKICAgICAgICBvd25lciA9IG5ld093bmVyOwogICAgfQp9Cgpjb250cmFjdCBCYXNpY1Rva2VuIGlzIG93bmVkIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgaW50ZXJuYWwgYmFsYW5jZV9vZjsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgaW50ZXJuYWwgYWxsb3dhbmNlczsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHByaXZhdGUgYWRkcmVzc19leGlzdDsKICAgIGFkZHJlc3NbXSBwcml2YXRlIGFkZHJlc3NfbGlzdDsKCiAgICBib29sIHB1YmxpYyB0cmFuc2Zlcl9jbG9zZSA9IGZhbHNlOwoKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwoKICAgIGZ1bmN0aW9uIEJhc2ljVG9rZW4oKSBwdWJsaWMgewogICAgfQoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHRva2VuX293bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2Vfb2ZbdG9rZW5fb3duZXJdOwogICAgfQoKICAgIGZ1bmN0aW9uIGFsbG93YW5jZSgKICAgICAgICBhZGRyZXNzIF9ob2FyZGVyLAogICAgICAgIGFkZHJlc3MgX3NwZW5kZXIKICAgICkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gYWxsb3dhbmNlc1tfaG9hcmRlcl1bX3NwZW5kZXJdOwogICAgfQoKICAgIGZ1bmN0aW9uIHN1cGVyQXBwcm92ZSgKICAgICAgICBhZGRyZXNzIF9ob2FyZGVyLAogICAgICAgIGFkZHJlc3MgX3NwZW5kZXIsCiAgICAgICAgdWludDI1NiBfdmFsdWUKICAgICkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF9ob2FyZGVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3NwZW5kZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPj0gMCk7CiAgICAgICAgYWxsb3dhbmNlc1tfaG9hcmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3NwZW5kZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPj0gMCk7CiAgICAgICAgYWxsb3dhbmNlc1ttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QWRkcmVzc0xlbmd0aCgpIG9ubHlPd25lciBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBhZGRyZXNzX2xpc3QubGVuZ3RoOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEFkZHJlc3NJbmRleCh1aW50IF9hZGRyZXNzX2luZGV4KSBvbmx5T3duZXIgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MgX2FkZHJlc3MpIHsKICAgICAgICBfYWRkcmVzcyA9IGFkZHJlc3NfbGlzdFtfYWRkcmVzc19pbmRleF07CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QWxsQWRkcmVzcygpIG9ubHlPd25lciBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzc1tdKSB7CiAgICAgICAgcmV0dXJuIGFkZHJlc3NfbGlzdDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRBZGRyZXNzRXhpc3QoYWRkcmVzcyBfdGFyZ2V0KSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmIChfdGFyZ2V0ID09IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBhZGRyZXNzX2V4aXN0W190YXJnZXRdOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBhZGRBZGRyZXNzKGFkZHJlc3MgX3RhcmdldCkgaW50ZXJuYWwgcmV0dXJucyhib29sKSB7CiAgICAgICAgaWYgKF90YXJnZXQgPT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIGlmIChhZGRyZXNzX2V4aXN0W190YXJnZXRdID09IHRydWUpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFkZHJlc3NfZXhpc3RbX3RhcmdldF0gPSB0cnVlOwogICAgICAgICAgICBhZGRyZXNzX2xpc3RbYWRkcmVzc19saXN0Lmxlbmd0aCsrXSA9IF90YXJnZXQ7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIG1pbnRUb2tlbigKICAgICAgICBhZGRyZXNzIF90bywKICAgICAgICB1aW50MjU2IHRva2VuX2Ftb3VudCwKICAgICAgICB1aW50MjU2IGZyZWV6ZV90aW1lc3RhbXAKICAgICkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKTsKCiAgICBmdW5jdGlvbiBzdXBlck1pbnQoCiAgICAgICAgYWRkcmVzcyBfdG8sCiAgICAgICAgdWludDI1NiB0b2tlbl9hbW91bnQsCiAgICAgICAgdWludDI1NiBmcmVlemVfdGltZXN0YW1wKSBvbmx5T3duZXIgcHVibGljIHJldHVybnMoYm9vbCk7CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYzsKCiAgICBmdW5jdGlvbiB0cmFuc2Zlck9wZW4oKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICB0cmFuc2Zlcl9jbG9zZSA9IGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyQ2xvc2UoKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICB0cmFuc2Zlcl9jbG9zZSA9IHRydWU7CiAgICB9Cn0KCmNvbnRyYWN0IFByZVNhbGUgaXMgb3duZWR7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICBzdHJ1Y3QgU2FsZSB7CiAgICAgICAgdWludCBzYWxlX251bWJlcjsKICAgICAgICB1aW50MjU2IHN0YXJ0X3RpbWVzdGFtcDsKICAgICAgICB1aW50MjU2IGVuZF90aW1lc3RhbXA7CiAgICAgICAgdWludDggYm9udXNfcmF0ZTsKICAgICAgICB1aW50MjU2IHNlbGxfbGltaXQ7CiAgICB9CgogICAgU2FsZVtdIHByaXZhdGUgc2FsZV9saXN0OwogICAgdWludDI1NltdIHByaXZhdGUgc2FsZV9zb2xkOwoKICAgIGZ1bmN0aW9uIFByZVNhbGUgKCkgcHVibGljIHsKCiAgICB9CgogICAgZnVuY3Rpb24gZ2V0U2FsZUxlbmd0aCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsKICAgICAgICByZXR1cm4gc2FsZV9saXN0Lmxlbmd0aDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRTYWxlSW5mbyh1aW50IF9pbmRleCkgcHVibGljIGNvbnN0YW50IHJldHVybnMoCiAgICAgICAgdWludCBzYWxlX251bWJlciwKICAgICAgICB1aW50MjU2IHN0YXJ0X3RpbWVzdGFtcCwKICAgICAgICB1aW50MjU2IGVuZF90aW1lc3RhbXAsCiAgICAgICAgdWludDggYm9udXNfcmF0ZSwKICAgICAgICB1aW50MjU2IHNlbGxfbGltaXQKICAgICkgewogICAgICAgIHNhbGVfbnVtYmVyID0gc2FsZV9saXN0W19pbmRleF0uc2FsZV9udW1iZXI7CiAgICAgICAgc3RhcnRfdGltZXN0YW1wID0gc2FsZV9saXN0W19pbmRleF0uc3RhcnRfdGltZXN0YW1wOwogICAgICAgIGVuZF90aW1lc3RhbXAgPSBzYWxlX2xpc3RbX2luZGV4XS5lbmRfdGltZXN0YW1wOwogICAgICAgIGJvbnVzX3JhdGUgPSBzYWxlX2xpc3RbX2luZGV4XS5ib251c19yYXRlOwogICAgICAgIHNlbGxfbGltaXQgPSBzYWxlX2xpc3RbX2luZGV4XS5zZWxsX2xpbWl0OwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFNhbGVTb2xkKHVpbnQgX2luZGV4KSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHNhbGVfc29sZFtfaW5kZXhdOwogICAgfQoKCiAgICBmdW5jdGlvbiBhZGRCb251cygKICAgICAgICB1aW50MjU2IF9hbW91bnQsCiAgICAgICAgdWludDggX2JvbnVzCiAgICApIGludGVybmFsIHB1cmUgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIF9hbW91bnQuYWRkKChfYW1vdW50Lm11bChfYm9udXMpKS5kaXYoMTAwKSk7CiAgICB9CgoKICAgIGZ1bmN0aW9uIG5ld1NhbGUoCiAgICAgICAgdWludDI1NiBzdGFydF90aW1lc3RhbXAsCiAgICAgICAgdWludDI1NiBlbmRfdGltZXN0YW1wLAogICAgICAgIHVpbnQ4IGJvbnVzX3JhdGUsCiAgICAgICAgdWludDI1NiBzZWxsX3Rva2VuX2xpbWl0CiAgICApIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoc3RhcnRfdGltZXN0YW1wID4gMCk7CiAgICAgICAgcmVxdWlyZShlbmRfdGltZXN0YW1wID4gMCk7CiAgICAgICAgcmVxdWlyZShzZWxsX3Rva2VuX2xpbWl0ID4gMCk7CgogICAgICAgIHVpbnQyNTYgc2FsZV9udW1iZXIgPSBzYWxlX2xpc3QubGVuZ3RoOwogICAgICAgIGZvciAodWludCBpPTA7IGkgPCBzYWxlX2xpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgcmVxdWlyZShzYWxlX2xpc3RbaV0uZW5kX3RpbWVzdGFtcCA8IHN0YXJ0X3RpbWVzdGFtcCk7CiAgICAgICAgfQoKICAgICAgICBzYWxlX2xpc3Rbc2FsZV9saXN0Lmxlbmd0aCsrXSA9IFNhbGUoewogICAgICAgICAgICBzYWxlX251bWJlcjogc2FsZV9udW1iZXIsCiAgICAgICAgICAgIHN0YXJ0X3RpbWVzdGFtcDogc3RhcnRfdGltZXN0YW1wLAogICAgICAgICAgICBlbmRfdGltZXN0YW1wOiBlbmRfdGltZXN0YW1wLAogICAgICAgICAgICBib251c19yYXRlOiBib251c19yYXRlLAogICAgICAgICAgICBzZWxsX2xpbWl0OiBzZWxsX3Rva2VuX2xpbWl0CiAgICAgICAgfSk7CiAgICAgICAgc2FsZV9zb2xkW3NhbGVfc29sZC5sZW5ndGgrK10gPSAwOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYW5nZVNhbGVJbmZvKAogICAgICAgIHVpbnQyNTYgX2luZGV4LAogICAgICAgIHVpbnQyNTYgc3RhcnRfdGltZXN0YW1wLAogICAgICAgIHVpbnQyNTYgZW5kX3RpbWVzdGFtcCwKICAgICAgICB1aW50OCBib251c19yYXRlLAogICAgICAgIHVpbnQyNTYgc2VsbF90b2tlbl9saW1pdAogICAgKSBvbmx5T3duZXIgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX2luZGV4IDwgc2FsZV9saXN0Lmxlbmd0aCk7CiAgICAgICAgcmVxdWlyZShzdGFydF90aW1lc3RhbXAgPiAwKTsKICAgICAgICByZXF1aXJlKGVuZF90aW1lc3RhbXAgPiAwKTsKICAgICAgICByZXF1aXJlKHNlbGxfdG9rZW5fbGltaXQgPiAwKTsKCiAgICAgICAgc2FsZV9saXN0W19pbmRleF0uc3RhcnRfdGltZXN0YW1wID0gc3RhcnRfdGltZXN0YW1wOwogICAgICAgIHNhbGVfbGlzdFtfaW5kZXhdLmVuZF90aW1lc3RhbXAgPSBlbmRfdGltZXN0YW1wOwogICAgICAgIHNhbGVfbGlzdFtfaW5kZXhdLmJvbnVzX3JhdGUgPSBib251c19yYXRlOwogICAgICAgIHNhbGVfbGlzdFtfaW5kZXhdLnNlbGxfbGltaXQgPSBzZWxsX3Rva2VuX2xpbWl0OwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYW5nZVNhbGVTdGFydCgKICAgICAgICB1aW50MjU2IF9pbmRleCwKICAgICAgICB1aW50MjU2IHN0YXJ0X3RpbWVzdGFtcAogICAgKSBvbmx5T3duZXIgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX2luZGV4IDwgc2FsZV9saXN0Lmxlbmd0aCk7CiAgICAgICAgcmVxdWlyZShzdGFydF90aW1lc3RhbXAgPiAwKTsKICAgICAgICBzYWxlX2xpc3RbX2luZGV4XS5zdGFydF90aW1lc3RhbXAgPSBzdGFydF90aW1lc3RhbXA7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlU2FsZUVuZCgKICAgICAgICB1aW50MjU2IF9pbmRleCwKICAgICAgICB1aW50MjU2IGVuZF90aW1lc3RhbXAKICAgICkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF9pbmRleCA8IHNhbGVfbGlzdC5sZW5ndGgpOwogICAgICAgIHJlcXVpcmUoZW5kX3RpbWVzdGFtcCA+IDApOwogICAgICAgIHNhbGVfbGlzdFtfaW5kZXhdLmVuZF90aW1lc3RhbXAgPSBlbmRfdGltZXN0YW1wOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYW5nZVNhbGVCb251c1JhdGUoCiAgICAgICAgdWludDI1NiBfaW5kZXgsCiAgICAgICAgdWludDggYm9udXNfcmF0ZQogICAgKSBvbmx5T3duZXIgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX2luZGV4IDwgc2FsZV9saXN0Lmxlbmd0aCk7CiAgICAgICAgc2FsZV9saXN0W19pbmRleF0uYm9udXNfcmF0ZSA9IGJvbnVzX3JhdGU7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlU2FsZVRva2VuTGltaXQoCiAgICAgICAgdWludDI1NiBfaW5kZXgsCiAgICAgICAgdWludDI1NiBzZWxsX3Rva2VuX2xpbWl0CiAgICApIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmVxdWlyZShfaW5kZXggPCBzYWxlX2xpc3QubGVuZ3RoKTsKICAgICAgICByZXF1aXJlKHNlbGxfdG9rZW5fbGltaXQgPiAwKTsKICAgICAgICBzYWxlX2xpc3RbX2luZGV4XS5zZWxsX2xpbWl0ID0gc2VsbF90b2tlbl9saW1pdDsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCgogICAgZnVuY3Rpb24gY2hlY2tTYWxlQ2FuU2VsbCgKICAgICAgICB1aW50MjU2IF9pbmRleCwKICAgICAgICB1aW50MjU2IF9hbW91bnQKICAgICkgaW50ZXJuYWwgdmlldyByZXR1cm5zKGJvb2wpIHsKICAgICAgICB1aW50MjU2IGluZGV4X3NvbGQgPSBzYWxlX3NvbGRbX2luZGV4XTsKICAgICAgICB1aW50MjU2IGluZGV4X2VuZF90aW1lc3RhbXAgPSBzYWxlX2xpc3RbX2luZGV4XS5lbmRfdGltZXN0YW1wOwogICAgICAgIHVpbnQyNTYgc2VsbF9saW1pdCA9IHNhbGVfbGlzdFtfaW5kZXhdLnNlbGxfbGltaXQ7CiAgICAgICAgdWludDggYm9udXNfcmF0ZSA9IHNhbGVfbGlzdFtfaW5kZXhdLmJvbnVzX3JhdGU7CiAgICAgICAgdWludDI1NiBzZWxsX2xpbWl0X3BsdXNfYm9udXMgPSBhZGRCb251cyhzZWxsX2xpbWl0LCBib251c19yYXRlKTsKCiAgICAgICAgaWYgKG5vdyA+PSBpbmRleF9lbmRfdGltZXN0YW1wKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgaWYgKGluZGV4X3NvbGQuYWRkKF9hbW91bnQpID4gc2VsbF9saW1pdF9wbHVzX2JvbnVzKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gYWRkU2FsZVNvbGQodWludDI1NiBfaW5kZXgsIHVpbnQyNTYgYW1vdW50KSBpbnRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShhbW91bnQgPiAwKTsKICAgICAgICByZXF1aXJlKF9pbmRleCA8IHNhbGVfc29sZC5sZW5ndGgpOwogICAgICAgIHJlcXVpcmUoY2hlY2tTYWxlQ2FuU2VsbChfaW5kZXgsIGFtb3VudCkgPT0gdHJ1ZSk7CiAgICAgICAgc2FsZV9zb2xkW19pbmRleF0gKz0gYW1vdW50OwogICAgfQoKICAgIGZ1bmN0aW9uIHN1YlNhbGVTb2xkKHVpbnQyNTYgX2luZGV4LCB1aW50MjU2IGFtb3VudCkgaW50ZXJuYWwgewogICAgICAgIHJlcXVpcmUoYW1vdW50ID4gMCk7CiAgICAgICAgcmVxdWlyZShfaW5kZXggPCBzYWxlX3NvbGQubGVuZ3RoKTsKICAgICAgICByZXF1aXJlKHNhbGVfc29sZFtfaW5kZXhdLnN1YihhbW91bnQpID49IDApOwogICAgICAgIHNhbGVfc29sZFtfaW5kZXhdIC09IGFtb3VudDsKICAgIH0KCiAgICBmdW5jdGlvbiBjYW5TYWxlSW5mbygpIHB1YmxpYyB2aWV3IHJldHVybnMoCiAgICAgICAgdWludCBzYWxlX251bWJlciwKICAgICAgICB1aW50MjU2IHN0YXJ0X3RpbWVzdGFtcCwKICAgICAgICB1aW50MjU2IGVuZF90aW1lc3RhbXAsCiAgICAgICAgdWludDggYm9udXNfcmF0ZSwKICAgICAgICB1aW50MjU2IHNlbGxfbGltaXQKICAgICkgewogICAgICAgIHZhcihzYWxlX2luZm8sIGlzU2FsZSkgPSBub3dTYWxlSW5mbygpOwogICAgICAgIHJlcXVpcmUoaXNTYWxlID09IHRydWUpOwogICAgICAgIHNhbGVfbnVtYmVyID0gc2FsZV9pbmZvLnNhbGVfbnVtYmVyOwogICAgICAgIHN0YXJ0X3RpbWVzdGFtcCA9IHNhbGVfaW5mby5zdGFydF90aW1lc3RhbXA7CiAgICAgICAgZW5kX3RpbWVzdGFtcCA9IHNhbGVfaW5mby5lbmRfdGltZXN0YW1wOwogICAgICAgIGJvbnVzX3JhdGUgPSBzYWxlX2luZm8uYm9udXNfcmF0ZTsKICAgICAgICBzZWxsX2xpbWl0ID0gc2FsZV9pbmZvLnNlbGxfbGltaXQ7CiAgICB9CgogICAgZnVuY3Rpb24gbm93U2FsZUluZm8oKSBpbnRlcm5hbCB2aWV3IHJldHVybnMoU2FsZSBzYWxlX2luZm8sIGJvb2wgaXNTYWxlKSB7CiAgICAgICAgaXNTYWxlID0gZmFsc2U7CiAgICAgICAgZm9yICh1aW50IGk9MDsgaSA8IHNhbGVfbGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB1aW50MjU2IGVuZF90aW1lc3RhbXAgPSBzYWxlX2xpc3RbaV0uZW5kX3RpbWVzdGFtcDsKICAgICAgICAgICAgdWludDI1NiBzZWxsX2xpbWl0ID0gc2FsZV9saXN0W2ldLnNlbGxfbGltaXQ7CiAgICAgICAgICAgIHVpbnQ4IGJvbnVzX3JhdGUgPSBzYWxlX2xpc3RbaV0uYm9udXNfcmF0ZTsKICAgICAgICAgICAgdWludDI1NiBzZWxsX2xpbWl0X3BsdXNfYm9udXMgPSBhZGRCb251cyhzZWxsX2xpbWl0LCBib251c19yYXRlKTsKICAgICAgICAgICAgdWludDI1NiB0ZW1wX3NvbGRfdG9rZW4gPSBzYWxlX3NvbGRbaV07CiAgICAgICAgICAgIGlmICgobm93IDw9IGVuZF90aW1lc3RhbXApICYmICh0ZW1wX3NvbGRfdG9rZW4gPCBzZWxsX2xpbWl0X3BsdXNfYm9udXMpKSB7CiAgICAgICAgICAgICAgICBzYWxlX2luZm8gPSBTYWxlKHsKICAgICAgICAgICAgICAgICAgICBzYWxlX251bWJlcjogc2FsZV9saXN0W2ldLnNhbGVfbnVtYmVyLAogICAgICAgICAgICAgICAgICAgIHN0YXJ0X3RpbWVzdGFtcDogc2FsZV9saXN0W2ldLnN0YXJ0X3RpbWVzdGFtcCwKICAgICAgICAgICAgICAgICAgICBlbmRfdGltZXN0YW1wOiBzYWxlX2xpc3RbaV0uZW5kX3RpbWVzdGFtcCwKICAgICAgICAgICAgICAgICAgICBib251c19yYXRlOiBzYWxlX2xpc3RbaV0uYm9udXNfcmF0ZSwKICAgICAgICAgICAgICAgICAgICBzZWxsX2xpbWl0OiBzYWxlX2xpc3RbaV0uc2VsbF9saW1pdAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBpc1NhbGUgPSB0cnVlOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpc1NhbGUgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9Cgpjb250cmFjdCBWb3RlIGlzIG93bmVkIHsKICAgIGV2ZW50IFByb3Bvc2FsQWRkKHVpbnQgdm90ZV9pZCwgYWRkcmVzcyBnZW5lcmF0b3IsIHN0cmluZyBkZXNjcmlwdCk7CiAgICBldmVudCBQcm9wb3NhbEVuZCh1aW50IHZvdGVfaWQsIHN0cmluZyBkZXNjcmlwdCk7CgogICAgc3RydWN0IFByb3Bvc2FsIHsKICAgICAgICBhZGRyZXNzIGdlbmVyYXRvcjsKICAgICAgICBzdHJpbmcgZGVzY3JpcHQ7CiAgICAgICAgdWludDI1NiBzdGFydF90aW1lc3RhbXA7CiAgICAgICAgdWludDI1NiBlbmRfdGltZXN0YW1wOwogICAgICAgIGJvb2wgZXhlY3V0ZWQ7CiAgICAgICAgdWludDI1NiB2b3RpbmdfY3V0OwogICAgICAgIHVpbnQyNTYgdGhyZXNob2xkOwoKICAgICAgICB1aW50MjU2IHZvdGluZ19jb3VudDsKICAgICAgICB1aW50MjU2IHRvdGFsX3dlaWdodDsKICAgICAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHZvdGVXZWlnaHRPZjsKICAgICAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHZvdGVkT2Y7CiAgICAgICAgYWRkcmVzc1tdIHZvdGVyX2FkZHJlc3M7CiAgICB9CgogICAgdWludCBwcml2YXRlIHZvdGVfaWQgPSAwOwogICAgUHJvcG9zYWxbXSBwcml2YXRlIFByb3Bvc2FsczsKCiAgICBmdW5jdGlvbiBnZXRQcm9wb3NhbExlbmd0aCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIFByb3Bvc2Fscy5sZW5ndGg7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0UHJvcG9zYWxJbmRleCh1aW50IF9wcm9wb3NhbF9pbmRleCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKAogICAgICAgIGFkZHJlc3MgZ2VuZXJhdG9yLAogICAgICAgIHN0cmluZyBkZXNjcmlwdCwKICAgICAgICB1aW50MjU2IHN0YXJ0X3RpbWVzdGFtcCwKICAgICAgICB1aW50MjU2IGVuZF90aW1lc3RhbXAsCiAgICAgICAgYm9vbCBleGVjdXRlZCwKICAgICAgICB1aW50MjU2IHZvdGluZ19jb3VudCwKICAgICAgICB1aW50MjU2IHRvdGFsX3dlaWdodCwKICAgICAgICB1aW50MjU2IHZvdGluZ19jdXQsCiAgICAgICAgdWludDI1NiB0aHJlc2hvbGQKICAgICkgewogICAgICAgIGdlbmVyYXRvciA9IFByb3Bvc2Fsc1tfcHJvcG9zYWxfaW5kZXhdLmdlbmVyYXRvcjsKICAgICAgICBkZXNjcmlwdCA9IFByb3Bvc2Fsc1tfcHJvcG9zYWxfaW5kZXhdLmRlc2NyaXB0OwogICAgICAgIHN0YXJ0X3RpbWVzdGFtcCA9IFByb3Bvc2Fsc1tfcHJvcG9zYWxfaW5kZXhdLnN0YXJ0X3RpbWVzdGFtcDsKICAgICAgICBlbmRfdGltZXN0YW1wID0gUHJvcG9zYWxzW19wcm9wb3NhbF9pbmRleF0uZW5kX3RpbWVzdGFtcDsKICAgICAgICBleGVjdXRlZCA9IFByb3Bvc2Fsc1tfcHJvcG9zYWxfaW5kZXhdLmV4ZWN1dGVkOwogICAgICAgIHZvdGluZ19jb3VudCA9IFByb3Bvc2Fsc1tfcHJvcG9zYWxfaW5kZXhdLnZvdGluZ19jb3VudDsKICAgICAgICB0b3RhbF93ZWlnaHQgPSBQcm9wb3NhbHNbX3Byb3Bvc2FsX2luZGV4XS50b3RhbF93ZWlnaHQ7CiAgICAgICAgdm90aW5nX2N1dCA9IFByb3Bvc2Fsc1tfcHJvcG9zYWxfaW5kZXhdLnZvdGluZ19jdXQ7CiAgICAgICAgdGhyZXNob2xkID0gUHJvcG9zYWxzW19wcm9wb3NhbF9pbmRleF0udGhyZXNob2xkOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFByb3Bvc2FsVm90ZXJMaXN0KHVpbnQgX3Byb3Bvc2FsX2luZGV4KSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzc1tdKSB7CiAgICAgICAgcmV0dXJuIFByb3Bvc2Fsc1tfcHJvcG9zYWxfaW5kZXhdLnZvdGVyX2FkZHJlc3M7CiAgICB9CgogICAgZnVuY3Rpb24gbmV3Vm90ZSgKICAgICAgICBhZGRyZXNzIHdobywKICAgICAgICBzdHJpbmcgZGVzY3JpcHQsCiAgICAgICAgdWludDI1NiBzdGFydF90aW1lc3RhbXAsCiAgICAgICAgdWludDI1NiBlbmRfdGltZXN0YW1wLAogICAgICAgIHVpbnQyNTYgdm90aW5nX2N1dCwKICAgICAgICB1aW50MjU2IHRocmVzaG9sZAogICAgKSBvbmx5T3duZXIgcHVibGljIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBpZiAoUHJvcG9zYWxzLmxlbmd0aCA+PSAxKSB7CiAgICAgICAgICAgIHJlcXVpcmUoUHJvcG9zYWxzW3ZvdGVfaWRdLmVuZF90aW1lc3RhbXAgPCBzdGFydF90aW1lc3RhbXApOwogICAgICAgICAgICByZXF1aXJlKFByb3Bvc2Fsc1t2b3RlX2lkXS5leGVjdXRlZCA9PSB0cnVlKTsKICAgICAgICB9CgogICAgICAgIHZvdGVfaWQgPSBQcm9wb3NhbHMubGVuZ3RoOwogICAgICAgIFByb3Bvc2FsIHN0b3JhZ2UgcCA9IFByb3Bvc2Fsc1tQcm9wb3NhbHMubGVuZ3RoKytdOwogICAgICAgIHAuZ2VuZXJhdG9yID0gd2hvOwogICAgICAgIHAuZGVzY3JpcHQgPSBkZXNjcmlwdDsKICAgICAgICBwLnN0YXJ0X3RpbWVzdGFtcCA9IHN0YXJ0X3RpbWVzdGFtcDsKICAgICAgICBwLmVuZF90aW1lc3RhbXAgPSBlbmRfdGltZXN0YW1wOwogICAgICAgIHAuZXhlY3V0ZWQgPSBmYWxzZTsKICAgICAgICBwLnZvdGluZ19jdXQgPSB2b3RpbmdfY3V0OwogICAgICAgIHAudGhyZXNob2xkID0gdGhyZXNob2xkOwoKICAgICAgICBwLnZvdGluZ19jb3VudCA9IDA7CiAgICAgICAgZGVsZXRlIHAudm90ZXJfYWRkcmVzczsKICAgICAgICBQcm9wb3NhbEFkZCh2b3RlX2lkLCB3aG8sIGRlc2NyaXB0KTsKICAgICAgICByZXR1cm4gdm90ZV9pZDsKICAgIH0KCiAgICBmdW5jdGlvbiB2b3RpbmcoYWRkcmVzcyBfdm90ZXIsIHVpbnQyNTYgX3dlaWdodCkgaW50ZXJuYWwgcmV0dXJucyhib29sKSB7CiAgICAgICAgaWYgKFByb3Bvc2Fsc1t2b3RlX2lkXS5lbmRfdGltZXN0YW1wIDwgbm93KSB7CiAgICAgICAgICAgIFByb3Bvc2Fsc1t2b3RlX2lkXS5leGVjdXRlZCA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICByZXF1aXJlKFByb3Bvc2Fsc1t2b3RlX2lkXS5leGVjdXRlZCA9PSBmYWxzZSk7CiAgICAgICAgcmVxdWlyZShQcm9wb3NhbHNbdm90ZV9pZF0uZW5kX3RpbWVzdGFtcCA+IG5vdyk7CiAgICAgICAgcmVxdWlyZShQcm9wb3NhbHNbdm90ZV9pZF0uc3RhcnRfdGltZXN0YW1wIDw9IG5vdyk7CiAgICAgICAgcmVxdWlyZShQcm9wb3NhbHNbdm90ZV9pZF0udm90ZWRPZltfdm90ZXJdID09IGZhbHNlKTsKICAgICAgICByZXF1aXJlKFByb3Bvc2Fsc1t2b3RlX2lkXS52b3RpbmdfY3V0IDw9IF93ZWlnaHQpOwoKICAgICAgICBQcm9wb3NhbHNbdm90ZV9pZF0udm90ZWRPZltfdm90ZXJdID0gdHJ1ZTsKICAgICAgICBQcm9wb3NhbHNbdm90ZV9pZF0udm90aW5nX2NvdW50ICs9IDE7CiAgICAgICAgUHJvcG9zYWxzW3ZvdGVfaWRdLnZvdGVXZWlnaHRPZltfdm90ZXJdID0gX3dlaWdodDsKICAgICAgICBQcm9wb3NhbHNbdm90ZV9pZF0udG90YWxfd2VpZ2h0ICs9IF93ZWlnaHQ7CiAgICAgICAgUHJvcG9zYWxzW3ZvdGVfaWRdLnZvdGVyX2FkZHJlc3NbUHJvcG9zYWxzW3ZvdGVfaWRdLnZvdGVyX2FkZHJlc3MubGVuZ3RoKytdID0gX3ZvdGVyOwoKICAgICAgICBpZiAoUHJvcG9zYWxzW3ZvdGVfaWRdLnRvdGFsX3dlaWdodCA+PSBQcm9wb3NhbHNbdm90ZV9pZF0udGhyZXNob2xkKSB7CiAgICAgICAgICAgIFByb3Bvc2Fsc1t2b3RlX2lkXS5leGVjdXRlZCA9IHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHZvdGVDbG9zZSgpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGlmIChQcm9wb3NhbHMubGVuZ3RoID49IDEpIHsKICAgICAgICAgICAgUHJvcG9zYWxzW3ZvdGVfaWRdLmV4ZWN1dGVkID0gdHJ1ZTsKICAgICAgICAgICAgUHJvcG9zYWxFbmQodm90ZV9pZCwgUHJvcG9zYWxzW3ZvdGVfaWRdLmRlc2NyaXB0KTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gY2hlY2tWb3RlKCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgaWYgKChQcm9wb3NhbHMubGVuZ3RoID49IDEpICYmCiAgICAgICAgICAgIChQcm9wb3NhbHNbdm90ZV9pZF0uZW5kX3RpbWVzdGFtcCA8IG5vdykpIHsKICAgICAgICAgICAgdm90ZUNsb3NlKCk7CiAgICAgICAgfQogICAgfQp9Cgpjb250cmFjdCBGcmVlemVUb2tlbiBpcyBvd25lZCB7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBmcmVlemVEYXRlT2Y7CgogICAgZXZlbnQgRnJlZXplKGFkZHJlc3MgaW5kZXhlZCBfd2hvLCB1aW50MjU2IF9kYXRlKTsKICAgIGV2ZW50IE1lbHQoYWRkcmVzcyBpbmRleGVkIF93aG8pOwoKICAgIGZ1bmN0aW9uIGNoZWNrRnJlZXplKGFkZHJlc3MgX3NlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAobm93ID49IGZyZWV6ZURhdGVPZltfc2VuZGVyXSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGZyZWV6ZVRvKGFkZHJlc3MgX3dobywgdWludDI1NiBfZGF0ZSkgaW50ZXJuYWwgewogICAgICAgIGZyZWV6ZURhdGVPZltfd2hvXSA9IF9kYXRlOwogICAgICAgIEZyZWV6ZShfd2hvLCBfZGF0ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gbWVsdE5vdyhhZGRyZXNzIF93aG8pIGludGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgZnJlZXplRGF0ZU9mW193aG9dID0gbm93OwogICAgICAgIE1lbHQoX3dobyk7CiAgICB9Cn0KCmNvbnRyYWN0IFRva2VuSW5mbyBpcyBvd25lZCB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICBhZGRyZXNzIHB1YmxpYyB0b2tlbl93YWxsZXRfYWRkcmVzczsKCiAgICBzdHJpbmcgcHVibGljIG5hbWUgPSAiQ1VCRSI7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbCA9ICJBVVRPIjsKICAgIHVpbnQyNTYgcHVibGljIGRlY2ltYWxzID0gMTg7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbF9zdXBwbHkgPSA3MjAwMDAwMDAwICogKDEwICoqIHVpbnQyNTYoZGVjaW1hbHMpKTsKCiAgICAvLyAxIGV0aGVyIDogMTAwLDAwMCB0b2tlbgogICAgdWludDI1NiBwdWJsaWMgY29udmVyc2lvbl9yYXRlID0gMTAwMDAwOwoKICAgIGV2ZW50IENoYW5nZVRva2VuTmFtZShhZGRyZXNzIGluZGV4ZWQgd2hvKTsKICAgIGV2ZW50IENoYW5nZVRva2VuU3ltYm9sKGFkZHJlc3MgaW5kZXhlZCB3aG8pOwogICAgZXZlbnQgQ2hhbmdlVG9rZW5XYWxsZXRBZGRyZXNzKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8pOwogICAgZXZlbnQgQ2hhbmdlVG90YWxTdXBwbHkodWludDI1NiBpbmRleGVkIGZyb20sIHVpbnQyNTYgaW5kZXhlZCB0byk7CiAgICBldmVudCBDaGFuZ2VDb252ZXJzaW9uUmF0ZSh1aW50MjU2IGluZGV4ZWQgZnJvbSwgdWludDI1NiBpbmRleGVkIHRvKTsKICAgIGV2ZW50IENoYW5nZUZyZWV6ZVRpbWUodWludDI1NiBpbmRleGVkIGZyb20sIHVpbnQyNTYgaW5kZXhlZCB0byk7CgogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiB0b3RhbF9zdXBwbHk7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlVG9rZW5OYW1lKHN0cmluZyBuZXdOYW1lKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICBuYW1lID0gbmV3TmFtZTsKICAgICAgICBDaGFuZ2VUb2tlbk5hbWUobXNnLnNlbmRlcik7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlVG9rZW5TeW1ib2woc3RyaW5nIG5ld1N5bWJvbCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgc3ltYm9sID0gbmV3U3ltYm9sOwogICAgICAgIENoYW5nZVRva2VuU3ltYm9sKG1zZy5zZW5kZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYW5nZVRva2VuV2FsbGV0KGFkZHJlc3MgbmV3VG9rZW5XYWxsZXQpIG9ubHlPd25lciBpbnRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShuZXdUb2tlbldhbGxldCAhPSBhZGRyZXNzKDApKTsKICAgICAgICBhZGRyZXNzIHByZV9hZGRyZXNzID0gdG9rZW5fd2FsbGV0X2FkZHJlc3M7CiAgICAgICAgdG9rZW5fd2FsbGV0X2FkZHJlc3MgPSBuZXdUb2tlbldhbGxldDsKICAgICAgICBDaGFuZ2VUb2tlbldhbGxldEFkZHJlc3MocHJlX2FkZHJlc3MsIHRva2VuX3dhbGxldF9hZGRyZXNzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGFuZ2VUb3RhbFN1cHBseSh1aW50MjU2IF90b3RhbF9zdXBwbHkpIG9ubHlPd25lciBpbnRlcm5hbCB7CiAgICAgICAgcmVxdWlyZShfdG90YWxfc3VwcGx5ID4gMCk7CiAgICAgICAgdWludDI1NiBwcmVfdG90YWxfc3VwcGx5ID0gdG90YWxfc3VwcGx5OwogICAgICAgIHRvdGFsX3N1cHBseSA9IF90b3RhbF9zdXBwbHk7CiAgICAgICAgQ2hhbmdlVG90YWxTdXBwbHkocHJlX3RvdGFsX3N1cHBseSwgdG90YWxfc3VwcGx5KTsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGFuZ2VDb252ZXJzaW9uUmF0ZSh1aW50MjU2IF9jb252ZXJzaW9uX3JhdGUpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX2NvbnZlcnNpb25fcmF0ZSA+IDApOwogICAgICAgIHVpbnQyNTYgcHJlX2NvbnZlcnNpb25fcmF0ZSA9IGNvbnZlcnNpb25fcmF0ZTsKICAgICAgICBjb252ZXJzaW9uX3JhdGUgPSBfY29udmVyc2lvbl9yYXRlOwogICAgICAgIENoYW5nZUNvbnZlcnNpb25SYXRlKHByZV9jb252ZXJzaW9uX3JhdGUsIGNvbnZlcnNpb25fcmF0ZSk7CiAgICB9Cn0KCmNvbnRyYWN0IFRva2VuIGlzIG93bmVkLCBQcmVTYWxlLCBGcmVlemVUb2tlbiwgVG9rZW5JbmZvLCBWb3RlLCBCYXNpY1Rva2VuIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIGJvb2wgcHVibGljIG9wZW5fZnJlZSA9IGZhbHNlOwoKICAgIGV2ZW50IFBheWFibGUoYWRkcmVzcyBpbmRleGVkIHdobywgdWludDI1NiBldGhfYW1vdW50KTsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwogICAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgdWludDI1NiB2YWx1ZSk7CiAgICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7CgogICAgZnVuY3Rpb24gVG9rZW4gKGFkZHJlc3MgX293bmVyX2FkZHJlc3MsIGFkZHJlc3MgX3Rva2VuX3dhbGxldF9hZGRyZXNzKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX3Rva2VuX3dhbGxldF9hZGRyZXNzICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICBpZiAoX293bmVyX2FkZHJlc3MgIT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICBvd25lciA9IF9vd25lcl9hZGRyZXNzOwogICAgICAgICAgICBiYWxhbmNlX29mW293bmVyXSA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgICAgICAgICBiYWxhbmNlX29mW293bmVyXSA9IDA7CiAgICAgICAgfQoKICAgICAgICB0b2tlbl93YWxsZXRfYWRkcmVzcyA9IF90b2tlbl93YWxsZXRfYWRkcmVzczsKICAgICAgICBiYWxhbmNlX29mW3Rva2VuX3dhbGxldF9hZGRyZXNzXSA9IHRvdGFsX3N1cHBseTsKICAgIH0KCiAgICBmdW5jdGlvbiBtaW50VG9rZW4oCiAgICAgICAgYWRkcmVzcyB0bywKICAgICAgICB1aW50MjU2IHRva2VuX2Ftb3VudCwKICAgICAgICB1aW50MjU2IGZyZWV6ZV90aW1lc3RhbXAKICAgICkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZSh0b2tlbl9hbW91bnQgPiAwKTsKICAgICAgICByZXF1aXJlKGJhbGFuY2Vfb2ZbdG9rZW5fd2FsbGV0X2FkZHJlc3NdID49IHRva2VuX2Ftb3VudCk7CiAgICAgICAgcmVxdWlyZShiYWxhbmNlX29mW3RvXSArIHRva2VuX2Ftb3VudCA+IGJhbGFuY2Vfb2ZbdG9dKTsKICAgICAgICB1aW50MjU2IHRva2VuX3BsdXNfYm9udXMgPSAwOwogICAgICAgIHVpbnQgc2FsZV9udW1iZXIgPSAwOwoKICAgICAgICB2YXIoc2FsZV9pbmZvLCBpc1NhbGUpID0gbm93U2FsZUluZm8oKTsKICAgICAgICBpZiAoaXNTYWxlKSB7CiAgICAgICAgICAgIHNhbGVfbnVtYmVyID0gc2FsZV9pbmZvLnNhbGVfbnVtYmVyOwogICAgICAgICAgICB1aW50OCBib251c19yYXRlID0gc2FsZV9pbmZvLmJvbnVzX3JhdGU7CiAgICAgICAgICAgIHRva2VuX3BsdXNfYm9udXMgPSBhZGRCb251cyh0b2tlbl9hbW91bnQsIGJvbnVzX3JhdGUpOwogICAgICAgICAgICByZXF1aXJlKGNoZWNrU2FsZUNhblNlbGwoc2FsZV9udW1iZXIsIHRva2VuX3BsdXNfYm9udXMpID09IHRydWUpOwogICAgICAgICAgICBhZGRTYWxlU29sZChzYWxlX251bWJlciwgdG9rZW5fcGx1c19ib251cyk7CiAgICAgICAgfSBlbHNlIGlmIChvcGVuX2ZyZWUpIHsKICAgICAgICAgICAgdG9rZW5fcGx1c19ib251cyA9IHRva2VuX2Ftb3VudDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXF1aXJlKG9wZW5fZnJlZSA9PSB0cnVlKTsKICAgICAgICB9CgogICAgICAgIGJhbGFuY2Vfb2ZbdG9rZW5fd2FsbGV0X2FkZHJlc3NdIC09IHRva2VuX3BsdXNfYm9udXM7CiAgICAgICAgYmFsYW5jZV9vZlt0b10gKz0gdG9rZW5fcGx1c19ib251czsKCiAgICAgICAgdWludDI1NiBfZnJlZXplID0gMDsKICAgICAgICBpZiAoZnJlZXplX3RpbWVzdGFtcCA+PSAwKSB7CiAgICAgICAgICAgIF9mcmVlemUgPSBmcmVlemVfdGltZXN0YW1wOwogICAgICAgIH0KCiAgICAgICAgZnJlZXplVG8odG8sIG5vdyArIF9mcmVlemUpOyAvLyBGcmVlemVUb2tlbi5zb2wKICAgICAgICBUcmFuc2ZlcigweDAsIHRvLCB0b2tlbl9wbHVzX2JvbnVzKTsKICAgICAgICBhZGRBZGRyZXNzKHRvKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBtaW50VG9rZW5CdWxrKGFkZHJlc3NbXSBfdG9zLCB1aW50MjU2W10gX2Ftb3VudHMpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX3Rvcy5sZW5ndGggPT0gX2Ftb3VudHMubGVuZ3RoKTsKICAgICAgICBmb3IgKHVpbnQgaT0wOyBpIDwgX3Rvcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBtaW50VG9rZW4oX3Rvc1tpXSwgX2Ftb3VudHNbaV0sIDApOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBzdXBlck1pbnQoCiAgICAgICAgYWRkcmVzcyB0bywKICAgICAgICB1aW50MjU2IHRva2VuX2Ftb3VudCwKICAgICAgICB1aW50MjU2IGZyZWV6ZV90aW1lc3RhbXAKICAgICkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXF1aXJlKHRva2VuX2Ftb3VudCA+IDApOwogICAgICAgIHJlcXVpcmUoYmFsYW5jZV9vZlt0b2tlbl93YWxsZXRfYWRkcmVzc10gPj0gdG9rZW5fYW1vdW50KTsKICAgICAgICByZXF1aXJlKGJhbGFuY2Vfb2ZbdG9dICsgdG9rZW5fYW1vdW50ID4gYmFsYW5jZV9vZlt0b10pOwoKICAgICAgICBiYWxhbmNlX29mW3Rva2VuX3dhbGxldF9hZGRyZXNzXSAtPSB0b2tlbl9hbW91bnQ7CiAgICAgICAgYmFsYW5jZV9vZlt0b10gKz0gdG9rZW5fYW1vdW50OwoKICAgICAgICB1aW50MjU2IF9mcmVlemUgPSAwOwogICAgICAgIGlmIChmcmVlemVfdGltZXN0YW1wID49IDApIHsKICAgICAgICAgICAgX2ZyZWV6ZSA9IGZyZWV6ZV90aW1lc3RhbXA7CiAgICAgICAgfQoKICAgICAgICBmcmVlemVUbyh0bywgbm93ICsgX2ZyZWV6ZSk7CiAgICAgICAgVHJhbnNmZXIoMHgwLCB0bywgdG9rZW5fYW1vdW50KTsKICAgICAgICBNaW50KHRvLCB0b2tlbl9hbW91bnQpOwogICAgICAgIGFkZEFkZHJlc3ModG8pOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHN1cGVyTWludEJ1bGsoYWRkcmVzc1tdIF90b3MsIHVpbnQyNTZbXSBfYW1vdW50cykgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfdG9zLmxlbmd0aCA9PSBfYW1vdW50cy5sZW5ndGgpOwogICAgICAgIGZvciAodWludCBpPTA7IGkgPCBfdG9zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHN1cGVyTWludChfdG9zW2ldLCBfYW1vdW50c1tpXSwgMCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyB7CiAgICAgICAgX3RyYW5zZmVyKG1zZy5zZW5kZXIsIHRvLCB2YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJCdWxrKGFkZHJlc3NbXSB0b3MsIHVpbnQyNTZbXSB2YWx1ZXMpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZSh0b3MubGVuZ3RoID09IHZhbHVlcy5sZW5ndGgpOwogICAgICAgIGZvciAodWludCBpPTA7IGkgPCB0b3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdHJhbnNmZXIodG9zW2ldLCB2YWx1ZXNbaV0pOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oCiAgICAgICAgYWRkcmVzcyBfZnJvbSwKICAgICAgICBhZGRyZXNzIF90bywKICAgICAgICB1aW50MjU2IF9hbW91bnQKICAgICkgcHVibGljIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfZnJvbSAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF9hbW91bnQgPD0gYWxsb3dhbmNlc1tfZnJvbV1bbXNnLnNlbmRlcl0pOwogICAgICAgIF90cmFuc2ZlcihfZnJvbSwgX3RvLCBfYW1vdW50KTsKICAgICAgICBhbGxvd2FuY2VzW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfYW1vdW50OwogICAgfQoKICAgIGZ1bmN0aW9uIF90cmFuc2ZlcigKICAgICAgICBhZGRyZXNzIF9mcm9tLAogICAgICAgIGFkZHJlc3MgX3RvLAogICAgICAgIHVpbnQyNTYgX2Ftb3VudAogICAgKSBwcml2YXRlIHsKICAgICAgICByZXF1aXJlKF9mcm9tICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoYmFsYW5jZV9vZltfZnJvbV0gPj0gX2Ftb3VudCk7CiAgICAgICAgcmVxdWlyZShiYWxhbmNlX29mW190b10uYWRkKF9hbW91bnQpID49IGJhbGFuY2Vfb2ZbX3RvXSk7CiAgICAgICAgcmVxdWlyZSh0cmFuc2Zlcl9jbG9zZSA9PSBmYWxzZSk7CiAgICAgICAgcmVxdWlyZShjaGVja0ZyZWV6ZShfZnJvbSkgPT0gZmFsc2UpOwoKICAgICAgICB1aW50MjU2IHByZXZCYWxhbmNlID0gYmFsYW5jZV9vZltfZnJvbV0gKyBiYWxhbmNlX29mW190b107CiAgICAgICAgYmFsYW5jZV9vZltfZnJvbV0gLT0gX2Ftb3VudDsKICAgICAgICBiYWxhbmNlX29mW190b10gKz0gX2Ftb3VudDsKICAgICAgICBhc3NlcnQoYmFsYW5jZV9vZltfZnJvbV0gKyBiYWxhbmNlX29mW190b10gPT0gcHJldkJhbGFuY2UpOwogICAgICAgIGFkZEFkZHJlc3MoX3RvKTsKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfYW1vdW50KTsKICAgIH0KCiAgICBmdW5jdGlvbiBidXJuKGFkZHJlc3MgX3dobywgdWludDI1NiBfYW1vdW50KSBvbmx5T3duZXIgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX2Ftb3VudCA+IDApOwogICAgICAgIHJlcXVpcmUoYmFsYW5jZU9mKF93aG8pID49IF9hbW91bnQpOwogICAgICAgIGJhbGFuY2Vfb2ZbX3dob10gLT0gX2Ftb3VudDsKICAgICAgICB0b3RhbF9zdXBwbHkgLT0gX2Ftb3VudDsKICAgICAgICBCdXJuKF93aG8sIF9hbW91bnQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZGl0aW9uYWxUb3RhbFN1cHBseSh1aW50MjU2IF9hZGRpdGlvbikgb25seU93bmVyIHB1YmxpYyByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF9hZGRpdGlvbiA+IDApOwogICAgICAgIHVpbnQyNTYgY2hhbmdlX3RvdGFsX3N1cHBseSA9IHRvdGFsX3N1cHBseS5hZGQoX2FkZGl0aW9uKTsKICAgICAgICBiYWxhbmNlX29mW3Rva2VuX3dhbGxldF9hZGRyZXNzXSArPSBfYWRkaXRpb247CiAgICAgICAgY2hhbmdlVG90YWxTdXBwbHkoY2hhbmdlX3RvdGFsX3N1cHBseSk7CiAgICB9CgogICAgZnVuY3Rpb24gdG9rZW5XYWxsZXRDaGFuZ2UoYWRkcmVzcyBuZXdUb2tlbldhbGxldCkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXF1aXJlKG5ld1Rva2VuV2FsbGV0ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHVpbnQyNTYgdG9rZW5fd2FsbGV0X2Ftb3VudCA9IGJhbGFuY2Vfb2ZbdG9rZW5fd2FsbGV0X2FkZHJlc3NdOwogICAgICAgIGJhbGFuY2Vfb2ZbbmV3VG9rZW5XYWxsZXRdID0gdG9rZW5fd2FsbGV0X2Ftb3VudDsKICAgICAgICBiYWxhbmNlX29mW3Rva2VuX3dhbGxldF9hZGRyZXNzXSA9IDA7CiAgICAgICAgY2hhbmdlVG9rZW5XYWxsZXQobmV3VG9rZW5XYWxsZXQpOwogICAgfQoKICAgIGZ1bmN0aW9uICgpIHBheWFibGUgcHVibGljIHsKICAgICAgICB1aW50MjU2IGV0aF9hbW91bnQgPSBtc2cudmFsdWU7CiAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihldGhfYW1vdW50KTsKICAgICAgICBQYXlhYmxlKG1zZy5zZW5kZXIsIGV0aF9hbW91bnQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRva2VuT3BlbigpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIG9wZW5fZnJlZSA9IHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gdG9rZW5DbG9zZSgpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIG9wZW5fZnJlZSA9IGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIGZyZWV6ZUFkZHJlc3MoCiAgICAgICAgYWRkcmVzcyBfd2hvLAogICAgICAgIHVpbnQyNTYgX2FkZFRpbWVzdGFtcAogICAgKSBvbmx5T3duZXIgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIGZyZWV6ZVRvKF93aG8sIF9hZGRUaW1lc3RhbXApOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIG1lbHRBZGRyZXNzKAogICAgICAgIGFkZHJlc3MgX3dobwogICAgKSBvbmx5T3duZXIgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIG1lbHROb3coX3dobyk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gY2FsbCBhIHZvdGluZyBpbiBWb3RlLnNvbAogICAgZnVuY3Rpb24gdm90ZUFncmVlKCkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBhZGRyZXNzIF92b3RlciA9IG1zZy5zZW5kZXI7CiAgICAgICAgdWludDI1NiBfYmFsYW5jZSA9IGJhbGFuY2VPZihfdm90ZXIpOwogICAgICAgIHJlcXVpcmUoX2JhbGFuY2UgPiAwKTsKICAgICAgICByZXR1cm4gdm90aW5nKF92b3RlciwgX2JhbGFuY2UpOwogICAgfQoKICAgIGZ1bmN0aW9uIHN1cGVyVm90ZUFncmVlKGFkZHJlc3Mgd2hvKSBvbmx5T3duZXIgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIHJlcXVpcmUod2hvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHVpbnQyNTYgX2JhbGFuY2UgPSBiYWxhbmNlT2Yod2hvKTsKICAgICAgICByZXF1aXJlKF9iYWxhbmNlID4gMCk7CiAgICAgICAgcmV0dXJuIHZvdGluZyh3aG8sIF9iYWxhbmNlKTsKICAgIH0KfQ=='.
	

]
