Class {
	#name : #SRT12321Fb3e2548b03eaD42F09cAb239cff377b4e2,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT12321Fb3e2548b03eaD42F09cAb239cff377b4e2 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovLy8gQHRpdGxlIE93bmFibGUKLy8vIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wgZnVuY3Rpb25zLAovLy8gdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuCi8vLyBAZGV2IEJhc2VkIG9uIE9wZW5aZXBwZWxpbidzIE93bmFibGUuCgpjb250cmFjdCBPd25hYmxlIHsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwogICAgYWRkcmVzcyBwdWJsaWMgbmV3T3duZXJDYW5kaWRhdGU7CgogICAgZXZlbnQgT3duZXJzaGlwUmVxdWVzdGVkKGFkZHJlc3MgaW5kZXhlZCBfYnksIGFkZHJlc3MgaW5kZXhlZCBfdG8pOwogICAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvKTsKCiAgICAvLy8gQGRldiBDb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyIGFjY291bnQuCiAgICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgLy8vIEBkZXYgUmV2ZXJ0cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlPd25lckNhbmRpZGF0ZSgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gbmV3T3duZXJDYW5kaWRhdGUpOwogICAgICAgIF87CiAgICB9CgogICAgLy8vIEBkZXYgUHJvcG9zZXMgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lckNhbmRpZGF0ZS4KICAgIC8vLyBAcGFyYW0gX25ld093bmVyQ2FuZGlkYXRlIGFkZHJlc3MgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAgZnVuY3Rpb24gcmVxdWVzdE93bmVyc2hpcFRyYW5zZmVyKGFkZHJlc3MgX25ld093bmVyQ2FuZGlkYXRlKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoX25ld093bmVyQ2FuZGlkYXRlICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICBuZXdPd25lckNhbmRpZGF0ZSA9IF9uZXdPd25lckNhbmRpZGF0ZTsKCiAgICAgICAgT3duZXJzaGlwUmVxdWVzdGVkKG1zZy5zZW5kZXIsIG5ld093bmVyQ2FuZGlkYXRlKTsKICAgIH0KCiAgICAvLy8gQGRldiBBY2NlcHQgb3duZXJzaGlwIHRyYW5zZmVyLiBUaGlzIG1ldGhvZCBuZWVkcyB0byBiZSBjYWxsZWQgYnkgdGhlIHBlcnZpb3VzbHkgcHJvcG9zZWQgb3duZXIuCiAgICBmdW5jdGlvbiBhY2NlcHRPd25lcnNoaXAoKSBleHRlcm5hbCBvbmx5T3duZXJDYW5kaWRhdGUgewogICAgICAgIGFkZHJlc3MgcHJldmlvdXNPd25lciA9IG93bmVyOwoKICAgICAgICBvd25lciA9IG5ld093bmVyQ2FuZGlkYXRlOwogICAgICAgIG5ld093bmVyQ2FuZGlkYXRlID0gYWRkcmVzcygwKTsKCiAgICAgICAgT3duZXJzaGlwVHJhbnNmZXJyZWQocHJldmlvdXNPd25lciwgb3duZXIpOwogICAgfQp9CgovLy8gQHRpdGxlIE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MKbGlicmFyeSBTYWZlTWF0aCB7CiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgICAgIHJlcXVpcmUoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgLy8gcmVxdWlyZShiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgICAgIC8vIHJlcXVpcmUoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmVxdWlyZShiIDw9IGEpOwogICAgICAgIHJldHVybiBhIC0gYjsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgICAgIHJlcXVpcmUoYyA+PSBhKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICBmdW5jdGlvbiBtYXg2NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDY0KSB7CiAgICAgICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOwogICAgfQoKICAgIGZ1bmN0aW9uIG1pbjY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50NjQpIHsKICAgICAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsKICAgIH0KCiAgICBmdW5jdGlvbiBtYXgyNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBhID49IGIgPyBhIDogYjsKICAgIH0KCiAgICBmdW5jdGlvbiBtaW4yNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOwogICAgfQoKICAgIGZ1bmN0aW9uIHRvUG93ZXIyKHVpbnQyNTYgYSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIG11bChhLCBhKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzcXJ0KHVpbnQyNTYgYSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gKGEgKyAxKSAvIDI7CiAgICAgICAgdWludDI1NiBiID0gYTsKICAgICAgICB3aGlsZSAoYyA8IGIpIHsKICAgICAgICAgICAgYiA9IGM7CiAgICAgICAgICAgIGMgPSAoYSAvIGMgKyBjKSAvIDI7CiAgICAgICAgfQogICAgICAgIHJldHVybiBiOwogICAgfQp9CgovLy8gQHRpdGxlIEVSQyBUb2tlbiBTdGFuZGFyZCAjMjAgSW50ZXJmYWNlIChodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjApCmNvbnRyYWN0IEVSQzIwIHsKICAgIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5OwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAodWludCBiYWxhbmNlKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCByZW1haW5pbmcpOwogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50IHZhbHVlKTsKfQoKCgovLy8gQHRpdGxlIEVSQyBUb2tlbiBTdGFuZGFyZCAjNjc3IEludGVyZmFjZSAoaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzY3NykKY29udHJhY3QgRVJDNjc3IGlzIEVSQzIwIHsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyQW5kQ2FsbChhZGRyZXNzIHRvLCB1aW50IHZhbHVlLCBieXRlcyBkYXRhKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBvayk7CgogICAgZXZlbnQgVHJhbnNmZXJBbmRDYWxsKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQgdmFsdWUsIGJ5dGVzIGRhdGEpOwp9CgovLy8gQHRpdGxlIEVSQzIyM1JlY2VpdmVyIEludGVyZmFjZQovLy8gQGRldiBCYXNlZCBvbiB0aGUgc3BlY3MgZm9ybTogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIyMwpjb250cmFjdCBFUkMyMjNSZWNlaXZlciB7CiAgICBmdW5jdGlvbiB0b2tlbkZhbGxiYWNrKGFkZHJlc3MgX3NlbmRlciwgdWludCBfdmFsdWUsIGJ5dGVzIF9kYXRhKSBleHRlcm5hbCByZXR1cm5zIChib29sIG9rKTsKfQoKCgoKLy8vIEB0aXRsZSBCYXNpYyBFUkMyMCB0b2tlbiBjb250cmFjdCBpbXBsZW1lbnRhdGlvbi4KLy8vIEBkZXYgQmFzZWQgb24gT3BlblplcHBlbGluJ3MgU3RhbmRhcmRUb2tlbi4KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMCB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7CiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKCiAgICAvLy8gQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAvLy8gQHBhcmFtIF92YWx1ZSB1aW50MjU2IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9ibG9iL21hc3Rlci9FSVBTL2VpcC0yMC5tZCNhcHByb3ZlIChzZWUgTk9URSkKICAgICAgICBpZiAoKF92YWx1ZSAhPSAwKSAmJiAoYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gIT0gMCkpIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQoKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKCiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vLyBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICAvLy8gQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAgLy8vIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgLy8vIEByZXR1cm4gdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQoKCiAgICAvLy8gQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAgIC8vLyBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICAgLy8vIEByZXR1cm4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KCiAgICAvLy8gQGRldiBUcmFuc2ZlciB0b2tlbiB0byBhIHNwZWNpZmllZCBhZGRyZXNzLgogICAgLy8vIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAgIC8vLyBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwoKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vLyBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIuCiAgICAvLy8gQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbS4KICAgIC8vLyBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8uCiAgICAvLy8gQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkLgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICB2YXIgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOwoKICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CgogICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsKCiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0KCgoKCgoKLy8vIEB0aXRsZSBTdGFuZGFyZDY3N1Rva2VuIGltcGxlbnRhdGlvbiwgYmFzZSBvbiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvNjc3Cgpjb250cmFjdCBTdGFuZGFyZDY3N1Rva2VuIGlzIEVSQzY3NywgQmFzaWNUb2tlbiB7CgogIC8vLyBAZGV2IEVSQzIyMyBzYWZlIHRva2VuIHRyYW5zZmVyIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogIC8vLyBAcGFyYW0gX3RvIGFkZHJlc3MgdGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8uCiAgLy8vIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZC4KICAvLy8gQHBhcmFtIF9kYXRhIGJ5dGVzIGRhdGEgdGhhdCBjYW4gYmUgYXR0YWNoZWQgdG8gdGhlIHRva2VuIHRyYW5zYXRpb24KICBmdW5jdGlvbiB0cmFuc2ZlckFuZENhbGwoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpKTsgLy8gZG8gYSBub3JtYWwgdG9rZW4gdHJhbnNmZXIKICAgIFRyYW5zZmVyQW5kQ2FsbChtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSwgX2RhdGEpOwogICAgLy9maWx0ZXJpbmcgaWYgdGhlIHRhcmdldCBpcyBhIGNvbnRyYWN0IHdpdGggYnl0ZWNvZGUgaW5zaWRlIGl0CiAgICBpZiAoaXNDb250cmFjdChfdG8pKSByZXR1cm4gY29udHJhY3RGYWxsYmFjayhfdG8sIF92YWx1ZSwgX2RhdGEpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLy8gQGRldiBjYWxsZWQgd2hlbiB0cmFuc2FjdGlvbiB0YXJnZXQgaXMgYSBjb250cmFjdAogIC8vLyBAcGFyYW0gX3RvIGFkZHJlc3MgdGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8uCiAgLy8vIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZC4KICAvLy8gQHBhcmFtIF9kYXRhIGJ5dGVzIGRhdGEgdGhhdCBjYW4gYmUgYXR0YWNoZWQgdG8gdGhlIHRva2VuIHRyYW5zYXRpb24KICBmdW5jdGlvbiBjb250cmFjdEZhbGxiYWNrKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSwgYnl0ZXMgX2RhdGEpIHByaXZhdGUgcmV0dXJucyAoYm9vbCkgewogICAgRVJDMjIzUmVjZWl2ZXIgcmVjZWl2ZXIgPSBFUkMyMjNSZWNlaXZlcihfdG8pOwogICAgcmVxdWlyZShyZWNlaXZlci50b2tlbkZhbGxiYWNrKG1zZy5zZW5kZXIsIF92YWx1ZSwgX2RhdGEpKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLy8vIEBkZXYgY2hlY2sgaWYgdGhlIGFkZHJlc3MgaXMgY29udHJhY3QKICAvLy8gYXNzZW1ibGUgdGhlIGdpdmVuIGFkZHJlc3MgYnl0ZWNvZGUuIElmIGJ5dGVjb2RlIGV4aXN0cyB0aGVuIHRoZSBfYWRkciBpcyBhIGNvbnRyYWN0LgogIC8vLyBAcGFyYW0gX2FkZHIgYWRkcmVzcyB0aGUgYWRkcmVzcyB0byBjaGVjawogIGZ1bmN0aW9uIGlzQ29udHJhY3QoYWRkcmVzcyBfYWRkcikgcHJpdmF0ZSBjb25zdGFudCByZXR1cm5zIChib29sIGlzX2NvbnRyYWN0KSB7CiAgICAvLyByZXRyaWV2ZSB0aGUgc2l6ZSBvZiB0aGUgY29kZSBvbiB0YXJnZXQgYWRkcmVzcywgdGhpcyBuZWVkcyBhc3NlbWJseQogICAgdWludCBsZW5ndGg7CiAgICBhc3NlbWJseSB7IGxlbmd0aCA6PSBleHRjb2Rlc2l6ZShfYWRkcikgfQogICAgcmV0dXJuIGxlbmd0aCA+IDA7CiAgfQp9CgoKCgoKLy8vIEB0aXRsZSBUb2tlbiBob2xkZXIgY29udHJhY3QuCmNvbnRyYWN0IFRva2VuSG9sZGVyIGlzIE93bmFibGUgewogICAgLy8vIEBkZXYgQWxsb3cgdGhlIG93bmVyIHRvIHRyYW5zZmVyIG91dCBhbnkgYWNjaWRlbnRhbGx5IHNlbnQgRVJDMjAgdG9rZW5zLgogICAgLy8vIEBwYXJhbSBfdG9rZW5BZGRyZXNzIGFkZHJlc3MgVGhlIGFkZHJlc3Mgb2YgdGhlIEVSQzIwIGNvbnRyYWN0LgogICAgLy8vIEBwYXJhbSBfYW1vdW50IHVpbnQyNTYgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQuCiAgICBmdW5jdGlvbiB0cmFuc2ZlckFueUVSQzIwVG9rZW4oYWRkcmVzcyBfdG9rZW5BZGRyZXNzLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmV0dXJuIEVSQzIwKF90b2tlbkFkZHJlc3MpLnRyYW5zZmVyKG93bmVyLCBfYW1vdW50KTsKICAgIH0KfQoKCgoKCgovLy8gQHRpdGxlIENvbHUgTG9jYWwgTmV0d29yayBjb250cmFjdC4KLy8vIEBhdXRob3IgVGFsIEJlamEuCmNvbnRyYWN0IENvbHVMb2NhbE5ldHdvcmsgaXMgT3duYWJsZSwgU3RhbmRhcmQ2NzdUb2tlbiwgVG9rZW5Ib2xkZXIgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIkNvbHUgTG9jYWwgTmV0d29yayI7CiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJDTE4iOwoKICAgIC8vIFVzaW5nIHNhbWUgZGVjaW1hbHMgdmFsdWUgYXMgRVRIIChtYWtlcyBFVEgtQ0xOIGNvbnZlcnNpb24gbXVjaCBlYXNpZXIpLgogICAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CgogICAgLy8gU3RhdGVzIHdoZXRoZXIgdG9rZW4gdHJhbnNmZXJzIGlzIGFsbG93ZWQgb3Igbm90LgogICAgLy8gVXNlZCBkdXJpbmcgdG9rZW4gc2FsZS4KICAgIGJvb2wgcHVibGljIGlzVHJhbnNmZXJhYmxlID0gZmFsc2U7CgogICAgZXZlbnQgVG9rZW5zVHJhbnNmZXJhYmxlKCk7CgogICAgbW9kaWZpZXIgdHJhbnNmZXJhYmxlKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lciB8fCBpc1RyYW5zZmVyYWJsZSk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLy8gQGRldiBDcmVhdGVzIGFsbCB0b2tlbnMgYW5kIGdpdmVzIHRoZW0gdG8gdGhlIG93bmVyLgogICAgZnVuY3Rpb24gQ29sdUxvY2FsTmV0d29yayh1aW50MjU2IF90b3RhbFN1cHBseSkgcHVibGljIHsKICAgICAgICB0b3RhbFN1cHBseSA9IF90b3RhbFN1cHBseTsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHRvdGFsU3VwcGx5OwogICAgfQoKICAgIC8vLyBAZGV2IHN0YXJ0IHRyYW5zZmVyYWJsZSBtb2RlLgogICAgZnVuY3Rpb24gbWFrZVRva2Vuc1RyYW5zZmVyYWJsZSgpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgaWYgKGlzVHJhbnNmZXJhYmxlKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlzVHJhbnNmZXJhYmxlID0gdHJ1ZTsKCiAgICAgICAgVG9rZW5zVHJhbnNmZXJhYmxlKCk7CiAgICB9CgogICAgLy8vIEBkZXYgU2FtZSBFUkMyMCBiZWhhdmlvciwgYnV0IHJldmVydHMgaWYgbm90IHRyYW5zZmVyYWJsZS4KICAgIC8vLyBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgIC8vLyBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgdHJhbnNmZXJhYmxlIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIuYXBwcm92ZShfc3BlbmRlciwgX3ZhbHVlKTsKICAgIH0KCiAgICAvLy8gQGRldiBTYW1lIEVSQzIwIGJlaGF2aW9yLCBidXQgcmV2ZXJ0cyBpZiBub3QgdHJhbnNmZXJhYmxlLgogICAgLy8vIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAgIC8vLyBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHRyYW5zZmVyYWJsZSByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICAvLy8gQGRldiBTYW1lIEVSQzIwIGJlaGF2aW9yLCBidXQgcmV2ZXJ0cyBpZiBub3QgdHJhbnNmZXJhYmxlLgogICAgLy8vIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHRvIHNlbmQgdG9rZW5zIGZyb20uCiAgICAvLy8gQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICAgLy8vIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZC4KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB0cmFuc2ZlcmFibGUgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICAvLy8gQGRldiBTYW1lIEVSQzY3NyBiZWhhdmlvciwgYnV0IHJldmVydHMgaWYgbm90IHRyYW5zZmVyYWJsZS4KICAgIC8vLyBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgICAvLy8gQHBhcmFtIF92YWx1ZSB1aW50MjU2IFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgICAvLy8gQHBhcmFtIF9kYXRhIGJ5dGVzIGRhdGEgdG8gc2VuZCB0byByZWNlaXZlciBpZiBpdCBpcyBhIGNvbnRyYWN0LgogICAgZnVuY3Rpb24gdHJhbnNmZXJBbmRDYWxsKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSwgYnl0ZXMgX2RhdGEpIHB1YmxpYyB0cmFuc2ZlcmFibGUgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlckFuZENhbGwoX3RvLCBfdmFsdWUsIF9kYXRhKTsKICAgIH0KfQoKCgogLy8vIEB0aXRsZSBTdGFuZGFyZCBFUkMyMjMgVG9rZW4gUmVjZWl2ZXIgaW1wbGVtZW50aW5nIHRva2VuRmFsbGJhY2sgZnVuY3Rpb24gYW5kIHRva2VuUGF5YWJsZSBtb2RpZmllcgoKY29udHJhY3QgU3RhbmRhcmQyMjNSZWNlaXZlciBpcyBFUkMyMjNSZWNlaXZlciB7CiAgVGtuIHRrbjsKCiAgc3RydWN0IFRrbiB7CiAgICBhZGRyZXNzIGFkZHI7CiAgICBhZGRyZXNzIHNlbmRlcjsgLy8gdGhlIHRyYW5zYWN0aW9uIGNhbGxlcgogICAgdWludDI1NiB2YWx1ZTsKICB9CgogIGJvb2wgX19pc1Rva2VuRmFsbGJhY2s7CgogIG1vZGlmaWVyIHRva2VuUGF5YWJsZSB7CiAgICByZXF1aXJlKF9faXNUb2tlbkZhbGxiYWNrKTsKICAgIF87CiAgfQoKICAvLy8gQGRldiBDYWxsZWQgd2hlbiB0aGUgcmVjZWl2ZXIgb2YgdHJhbnNmZXIgaXMgY29udHJhY3QKICAvLy8gQHBhcmFtIF9zZW5kZXIgYWRkcmVzcyB0aGUgYWRkcmVzcyBvZiB0b2tlbnMgc2VuZGVyCiAgLy8vIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZC4KICAvLy8gQHBhcmFtIF9kYXRhIGJ5dGVzIGRhdGEgdGhhdCBjYW4gYmUgYXR0YWNoZWQgdG8gdGhlIHRva2VuIHRyYW5zYXRpb24KICBmdW5jdGlvbiB0b2tlbkZhbGxiYWNrKGFkZHJlc3MgX3NlbmRlciwgdWludCBfdmFsdWUsIGJ5dGVzIF9kYXRhKSBleHRlcm5hbCByZXR1cm5zIChib29sIG9rKSB7CiAgICBpZiAoIXN1cHBvcnRzVG9rZW4obXNnLnNlbmRlcikpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8vIFByb2JsZW06IFRoaXMgd2lsbCBkbyBhIHNzdG9yZSB3aGljaCBpcyBleHBlbnNpdmUgZ2FzIHdpc2UuIEZpbmQgYSB3YXkgdG8ga2VlcCBpdCBpbiBtZW1vcnkuCiAgICAvLyBTb2x1dGlvbjogUmVtb3ZlIHRoZSB0aGUgZGF0YQogICAgdGtuID0gVGtuKG1zZy5zZW5kZXIsIF9zZW5kZXIsIF92YWx1ZSk7CiAgICBfX2lzVG9rZW5GYWxsYmFjayA9IHRydWU7CiAgICBpZiAoIWFkZHJlc3ModGhpcykuZGVsZWdhdGVjYWxsKF9kYXRhKSkgewogICAgICBfX2lzVG9rZW5GYWxsYmFjayA9IGZhbHNlOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICAvLyBhdm9pZCBkb2luZyBhbiBvdmVyd3JpdGUgdG8gLnRva2VuLCB3aGljaCB3b3VsZCBiZSBtb3JlIGV4cGVuc2l2ZQogICAgLy8gbWFrZXMgYWNjZXNzaW5nIC50a24gdmFsdWVzIG91dHNpZGUgdG9rZW5QYXlhYmxlIGZ1bmN0aW9ucyB1bnNhZmUKICAgIF9faXNUb2tlbkZhbGxiYWNrID0gZmFsc2U7CgogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBzdXBwb3J0c1Rva2VuKGFkZHJlc3MgdG9rZW4pIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKTsKfQoKCgoKCi8vLyBAdGl0bGUgVG9rZW5Pd25hYmxlCi8vLyBAZGV2IFRoZSBUb2tlbk93bmFibGUgY29udHJhY3QgYWRkcyBhIG9ubHlUb2tlbk93bmVyIG1vZGlmaWVyIGFzIGEgdG9rZW5SZWNlaXZlciB3aXRoIG93bmFibGUgYWRkYXB0YXRpb24KCmNvbnRyYWN0IFRva2VuT3duYWJsZSBpcyBTdGFuZGFyZDIyM1JlY2VpdmVyLCBPd25hYmxlIHsKICAgIC8vLyBAZGV2IFJldmVydHMgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyIGZvciB0b2tlbiBzZW5kaW5nLgogICAgbW9kaWZpZXIgb25seVRva2VuT3duZXIoKSB7CiAgICAgICAgcmVxdWlyZSh0a24uc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQp9CgoKCgoKCi8vLyBAdGl0bGUgVmVzdGluZyB0cnVzdGVlIGNvbnRyYWN0IGZvciBDb2x1IExvY2FsIE5ldHdvcmsuCi8vLyBAZGV2IFRoaXMgQ29udHJhY3QgY2FuJ3QgYmUgVG9rZW5Ib2xkZXIsIHNpbmNlIGl0IHdpbGwgYWxsb3cgaXRzIG93bmVyIHRvIGRyYWluIGl0cyB2ZXN0ZWQgdG9rZW5zLgovLy8gQGRldiBUaGlzIG1lYW5zIHRoYXQgYW55IHRva2VuIHNlbnQgdG8gaXQgZGlmZmVyZW50IHRoYW4gQ29sdUxvY2FsTmV0d29yayBpcyBiYXNpY2x5IHN0dWNrZWQgaGVyZSBmb3JldmVyLgovLy8gQGRldiBDb2x1TG9jYWxOZXR3b3JrIHRoYXQgc2VudCBoZXJlIChieSBtaXN0YWtlKSBjYW4gd2l0aGRyYXduIHVzaW5nIHRoZSBncmFudCBtZXRob2QuCmNvbnRyYWN0IFZlc3RpbmdUcnVzdGVlIGlzIFRva2VuT3duYWJsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICAvLyBDb2x1IExvY2FsIE5ldHdvcmsgY29udHJhY3QuCiAgICBDb2x1TG9jYWxOZXR3b3JrIHB1YmxpYyBjbG47CgogICAgLy8gVmVzdGluZyBncmFudCBmb3IgYSBzcGVpY2lmYyBob2xkZXIuCiAgICBzdHJ1Y3QgR3JhbnQgewogICAgICAgIHVpbnQyNTYgdmFsdWU7CiAgICAgICAgdWludDI1NiBzdGFydDsKICAgICAgICB1aW50MjU2IGNsaWZmOwogICAgICAgIHVpbnQyNTYgZW5kOwogICAgICAgIHVpbnQyNTYgaW5zdGFsbG1lbnRMZW5ndGg7IC8vIEluIHNlY29uZHMuCiAgICAgICAgdWludDI1NiB0cmFuc2ZlcnJlZDsKICAgICAgICBib29sIHJldm9rYWJsZTsKICAgIH0KCiAgICAvLyBIb2xkZXIgdG8gZ3JhbnQgaW5mb3JtYXRpb24gbWFwcGluZy4KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gR3JhbnQpIHB1YmxpYyBncmFudHM7CgogICAgLy8gVG90YWwgdG9rZW5zIHZlc3RlZC4KICAgIHVpbnQyNTYgcHVibGljIHRvdGFsVmVzdGluZzsKCiAgICBldmVudCBOZXdHcmFudChhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsKICAgIGV2ZW50IFRva2Vuc1VubG9ja2VkKGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsKICAgIGV2ZW50IEdyYW50UmV2b2tlZChhZGRyZXNzIGluZGV4ZWQgX2hvbGRlciwgdWludDI1NiBfcmVmdW5kKTsKCiAgICB1aW50IGNvbnN0YW50IE9LID0gMTsKICAgIHVpbnQgY29uc3RhbnQgRVJSX0lOVkFMSURfVkFMVUUgPSAxMDAwMTsKICAgIHVpbnQgY29uc3RhbnQgRVJSX0lOVkFMSURfVkVTVEVEID0gMTAwMDI7CiAgICB1aW50IGNvbnN0YW50IEVSUl9JTlZBTElEX1RSQU5TRkVSQUJMRSA9IDEwMDAzOwoKICAgIGV2ZW50IEVycm9yKGFkZHJlc3MgaW5kZXhlZCBzZW5kZXIsIHVpbnQgZXJyb3IpOwoKICAgIC8vLyBAZGV2IENvbnN0cnVjdG9yIHRoYXQgaW5pdGlhbGl6ZXMgdGhlIGFkZHJlc3Mgb2YgdGhlIENvbHUgTG9jYWwgTmV0d29yayBjb250cmFjdC4KICAgIC8vLyBAcGFyYW0gX2NsbiBDb2x1TG9jYWxOZXR3b3JrIFRoZSBhZGRyZXNzIG9mIHRoZSBwcmV2aW91c2x5IGRlcGxveWVkIENvbHUgTG9jYWwgTmV0d29yayBjb250cmFjdC4KICAgIGZ1bmN0aW9uIFZlc3RpbmdUcnVzdGVlKENvbHVMb2NhbE5ldHdvcmsgX2NsbikgcHVibGljIHsKICAgICAgICByZXF1aXJlKF9jbG4gIT0gYWRkcmVzcygwKSk7CgogICAgICAgIGNsbiA9IF9jbG47CiAgICB9CgogICAgLy8vIEBkZXYgQWxsb3cgb25seSBjbG4gdG9rZW4gdG8gYmUgdG9rZW5QYXlhYmxlCiAgICAvLy8gQHBhcmFtIHRva2VuIHRoZSB0b2tlbiB0byBjaGVjawogICAgZnVuY3Rpb24gc3VwcG9ydHNUb2tlbihhZGRyZXNzIHRva2VuKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiAoY2xuID09IHRva2VuKTsKICAgIH0KCiAgICAvLy8gQGRldiBHcmFudCB0b2tlbnMgdG8gYSBzcGVjaWZpZWQgYWRkcmVzcy4KICAgIC8vLyBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGhvbGRlciBhZGRyZXNzLgogICAgLy8vIEBwYXJhbSBfc3RhcnQgdWludDI1NiBUaGUgYmVnaW5uaW5nIG9mIHRoZSB2ZXN0aW5nIHBlcmlvZCAodGltZXN0YW1wKS4KICAgIC8vLyBAcGFyYW0gX2NsaWZmIHVpbnQyNTYgV2hlbiB0aGUgZmlyc3QgaW5zdGFsbG1lbnQgaXMgbWFkZSAodGltZXN0YW1wKS4KICAgIC8vLyBAcGFyYW0gX2VuZCB1aW50MjU2IFRoZSBlbmQgb2YgdGhlIHZlc3RpbmcgcGVyaW9kICh0aW1lc3RhbXApLgogICAgLy8vIEBwYXJhbSBfaW5zdGFsbG1lbnRMZW5ndGggdWludDI1NiBUaGUgbGVuZ3RoIG9mIGVhY2ggdmVzdGluZyBpbnN0YWxsbWVudCAoaW4gc2Vjb25kcykuCiAgICAvLy8gQHBhcmFtIF9yZXZva2FibGUgYm9vbCBXaGV0aGVyIHRoZSBncmFudCBpcyByZXZva2FibGUgb3Igbm90LgogICAgZnVuY3Rpb24gZ3JhbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3N0YXJ0LCB1aW50MjU2IF9jbGlmZiwgdWludDI1NiBfZW5kLAogICAgICAgIHVpbnQyNTYgX2luc3RhbGxtZW50TGVuZ3RoLCBib29sIF9yZXZva2FibGUpCiAgICAgICAgZXh0ZXJuYWwgb25seVRva2VuT3duZXIgdG9rZW5QYXlhYmxlIHsKCiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcyh0aGlzKSk7IC8vIFByb3RlY3QgdGhpcyBjb250cmFjdCBmcm9tIHJlY2VpdmluZyBhIGdyYW50LgoKICAgICAgICB1aW50MjU2IHZhbHVlID0gdGtuLnZhbHVlOwoKICAgICAgICByZXF1aXJlKHZhbHVlID4gMCk7CgogICAgICAgIC8vIFJlcXVpcmUgdGhhdCBldmVyeSBob2xkZXIgY2FuIGJlIGdyYW50ZWQgdG9rZW5zIG9ubHkgb25jZS4KICAgICAgICByZXF1aXJlKGdyYW50c1tfdG9dLnZhbHVlID09IDApOwoKICAgICAgICAvLyBSZXF1aXJlIGZvciB0aW1lIHJhbmdlcyB0byBiZSBjb25zaXN0ZW50IGFuZCB2YWxpZC4KICAgICAgICByZXF1aXJlKF9zdGFydCA8PSBfY2xpZmYgJiYgX2NsaWZmIDw9IF9lbmQpOwoKICAgICAgICAvLyBSZXF1aXJlIGluc3RhbGxtZW50IGxlbmd0aCB0byBiZSB2YWxpZCBhbmQgbm8gbG9uZ2VyIHRoYW4gKGVuZCAtIHN0YXJ0KS4KICAgICAgICByZXF1aXJlKF9pbnN0YWxsbWVudExlbmd0aCA+IDAgJiYgX2luc3RhbGxtZW50TGVuZ3RoIDw9IF9lbmQuc3ViKF9zdGFydCkpOwoKICAgICAgICAvLyBHcmFudCBtdXN0IG5vdCBleGNlZWQgdGhlIHRvdGFsIGFtb3VudCBvZiB0b2tlbnMgY3VycmVudGx5IGF2YWlsYWJsZSBmb3IgdmVzdGluZy4KICAgICAgICByZXF1aXJlKHRvdGFsVmVzdGluZy5hZGQodmFsdWUpIDw9IGNsbi5iYWxhbmNlT2YoYWRkcmVzcyh0aGlzKSkpOwoKICAgICAgICAvLyBBc3NpZ24gYSBuZXcgZ3JhbnQuCiAgICAgICAgZ3JhbnRzW190b10gPSBHcmFudCh7CiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgICAgICAgc3RhcnQ6IF9zdGFydCwKICAgICAgICAgICAgY2xpZmY6IF9jbGlmZiwKICAgICAgICAgICAgZW5kOiBfZW5kLAogICAgICAgICAgICBpbnN0YWxsbWVudExlbmd0aDogX2luc3RhbGxtZW50TGVuZ3RoLAogICAgICAgICAgICB0cmFuc2ZlcnJlZDogMCwKICAgICAgICAgICAgcmV2b2thYmxlOiBfcmV2b2thYmxlCiAgICAgICAgfSk7CgogICAgICAgIC8vIFNpbmNlIHRva2VucyBoYXZlIGJlZW4gZ3JhbnRlZCwgaW5jcmVhc2UgdGhlIHRvdGFsIGFtb3VudCB2ZXN0ZWQuCiAgICAgICAgdG90YWxWZXN0aW5nID0gdG90YWxWZXN0aW5nLmFkZCh2YWx1ZSk7CgogICAgICAgIE5ld0dyYW50KG1zZy5zZW5kZXIsIF90bywgdmFsdWUpOwogICAgfQoKICAgIC8vLyBAZGV2IEdyYW50IHRva2VucyB0byBhIHNwZWNpZmllZCBhZGRyZXNzLgogICAgLy8vIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgaG9sZGVyIGFkZHJlc3MuCiAgICAvLy8gQHBhcmFtIF92YWx1ZSB1aW50MjU2IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIGdyYW50ZWQuCiAgICAvLy8gQHBhcmFtIF9zdGFydCB1aW50MjU2IFRoZSBiZWdpbm5pbmcgb2YgdGhlIHZlc3RpbmcgcGVyaW9kICh0aW1lc3RhbXApLgogICAgLy8vIEBwYXJhbSBfY2xpZmYgdWludDI1NiBXaGVuIHRoZSBmaXJzdCBpbnN0YWxsbWVudCBpcyBtYWRlICh0aW1lc3RhbXApLgogICAgLy8vIEBwYXJhbSBfZW5kIHVpbnQyNTYgVGhlIGVuZCBvZiB0aGUgdmVzdGluZyBwZXJpb2QgKHRpbWVzdGFtcCkuCiAgICAvLy8gQHBhcmFtIF9pbnN0YWxsbWVudExlbmd0aCB1aW50MjU2IFRoZSBsZW5ndGggb2YgZWFjaCB2ZXN0aW5nIGluc3RhbGxtZW50IChpbiBzZWNvbmRzKS4KICAgIC8vLyBAcGFyYW0gX3Jldm9rYWJsZSBib29sIFdoZXRoZXIgdGhlIGdyYW50IGlzIHJldm9rYWJsZSBvciBub3QuCiAgICBmdW5jdGlvbiBncmFudChhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUsIHVpbnQyNTYgX3N0YXJ0LCB1aW50MjU2IF9jbGlmZiwgdWludDI1NiBfZW5kLAogICAgICAgIHVpbnQyNTYgX2luc3RhbGxtZW50TGVuZ3RoLCBib29sIF9yZXZva2FibGUpCiAgICAgICAgZXh0ZXJuYWwgb25seU93bmVyIHsKCiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcyh0aGlzKSk7IC8vIFByb3RlY3QgdGhpcyBjb250cmFjdCBmcm9tIHJlY2VpdmluZyBhIGdyYW50LgogICAgICAgIHJlcXVpcmUoX3ZhbHVlID4gMCk7CgogICAgICAgIC8vIFJlcXVpcmUgdGhhdCBldmVyeSBob2xkZXIgY2FuIGJlIGdyYW50ZWQgdG9rZW5zIG9ubHkgb25jZS4KICAgICAgICByZXF1aXJlKGdyYW50c1tfdG9dLnZhbHVlID09IDApOwoKICAgICAgICAvLyBSZXF1aXJlIGZvciB0aW1lIHJhbmdlcyB0byBiZSBjb25zaXN0ZW50IGFuZCB2YWxpZC4KICAgICAgICByZXF1aXJlKF9zdGFydCA8PSBfY2xpZmYgJiYgX2NsaWZmIDw9IF9lbmQpOwoKICAgICAgICAvLyBSZXF1aXJlIGluc3RhbGxtZW50IGxlbmd0aCB0byBiZSB2YWxpZCBhbmQgbm8gbG9uZ2VyIHRoYW4gKGVuZCAtIHN0YXJ0KS4KICAgICAgICByZXF1aXJlKF9pbnN0YWxsbWVudExlbmd0aCA+IDAgJiYgX2luc3RhbGxtZW50TGVuZ3RoIDw9IF9lbmQuc3ViKF9zdGFydCkpOwoKICAgICAgICAvLyBHcmFudCBtdXN0IG5vdCBleGNlZWQgdGhlIHRvdGFsIGFtb3VudCBvZiB0b2tlbnMgY3VycmVudGx5IGF2YWlsYWJsZSBmb3IgdmVzdGluZy4KICAgICAgICByZXF1aXJlKHRvdGFsVmVzdGluZy5hZGQoX3ZhbHVlKSA8PSBjbG4uYmFsYW5jZU9mKGFkZHJlc3ModGhpcykpKTsKCiAgICAgICAgLy8gQXNzaWduIGEgbmV3IGdyYW50LgogICAgICAgIGdyYW50c1tfdG9dID0gR3JhbnQoewogICAgICAgICAgICB2YWx1ZTogX3ZhbHVlLAogICAgICAgICAgICBzdGFydDogX3N0YXJ0LAogICAgICAgICAgICBjbGlmZjogX2NsaWZmLAogICAgICAgICAgICBlbmQ6IF9lbmQsCiAgICAgICAgICAgIGluc3RhbGxtZW50TGVuZ3RoOiBfaW5zdGFsbG1lbnRMZW5ndGgsCiAgICAgICAgICAgIHRyYW5zZmVycmVkOiAwLAogICAgICAgICAgICByZXZva2FibGU6IF9yZXZva2FibGUKICAgICAgICB9KTsKCiAgICAgICAgLy8gU2luY2UgdG9rZW5zIGhhdmUgYmVlbiBncmFudGVkLCBpbmNyZWFzZSB0aGUgdG90YWwgYW1vdW50IHZlc3RlZC4KICAgICAgICB0b3RhbFZlc3RpbmcgPSB0b3RhbFZlc3RpbmcuYWRkKF92YWx1ZSk7CgogICAgICAgIE5ld0dyYW50KG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXZva2UgdGhlIGdyYW50IG9mIHRva2VucyBvZiBhIHNwZWNpZmVkIGFkZHJlc3MuCiAgICAvLy8gQGRldiBVbmxvY2tlZCB0b2tlbnMgd2lsbCBiZSBzZW50IHRvIHRoZSBncmFudGVlLCB0aGUgcmVzdCBpcyB0cmFuc2ZlcnJlZCB0byB0aGUgdHJ1c3RlZSdzIG93bmVyLgogICAgLy8vIEBwYXJhbSBfaG9sZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgaGF2ZSBpdHMgdG9rZW5zIHJldm9rZWQuCiAgICBmdW5jdGlvbiByZXZva2UoYWRkcmVzcyBfaG9sZGVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBHcmFudCBtZW1vcnkgZ3JhbnQgPSBncmFudHNbX2hvbGRlcl07CgogICAgICAgIC8vIEdyYW50IG11c3QgYmUgcmV2b2thYmxlLgogICAgICAgIHJlcXVpcmUoZ3JhbnQucmV2b2thYmxlKTsKCiAgICAgICAgLy8gR2V0IHRoZSB0b3RhbCBhbW91bnQgb2YgdmVzdGVkIHRva2VucywgYWNjY29yZGluZyB0byBncmFudC4KICAgICAgICB1aW50MjU2IHZlc3RlZCA9IGNhbGN1bGF0ZVZlc3RlZFRva2VucyhncmFudCwgbm93KTsKCiAgICAgICAgLy8gQ2FsY3VsYXRlIHRoZSB1bnRyYW5zZmVycmVkIHZlc3RlZCB0b2tlbnMuCiAgICAgICAgdWludDI1NiB0cmFuc2ZlcmFibGUgPSB2ZXN0ZWQuc3ViKGdyYW50LnRyYW5zZmVycmVkKTsKCiAgICAgICAgaWYgKHRyYW5zZmVyYWJsZSA+IDApIHsKICAgICAgICAgICAgLy8gVXBkYXRlIHRyYW5zZmVycmVkIGFuZCB0b3RhbCB2ZXN0aW5nIGFtb3VudCwgdGhlbiB0cmFuc2ZlciByZW1haW5pbmcgdmVzdGVkIGZ1bmRzIHRvIGhvbGRlci4KICAgICAgICAgICAgZ3JhbnQudHJhbnNmZXJyZWQgPSBncmFudC50cmFuc2ZlcnJlZC5hZGQodHJhbnNmZXJhYmxlKTsKICAgICAgICAgICAgdG90YWxWZXN0aW5nID0gdG90YWxWZXN0aW5nLnN1Yih0cmFuc2ZlcmFibGUpOwogICAgICAgICAgICByZXF1aXJlKGNsbi50cmFuc2ZlcihfaG9sZGVyLCB0cmFuc2ZlcmFibGUpKTsKCiAgICAgICAgICAgIFRva2Vuc1VubG9ja2VkKF9ob2xkZXIsIHRyYW5zZmVyYWJsZSk7CiAgICAgICAgfQoKICAgICAgICAvLyBDYWxjdWxhdGUgYW1vdW50IG9mIHJlbWFpbmluZyB0b2tlbnMgdGhhdCBjYW4gc3RpbGwgYmUgcmV0dXJuZWQuCiAgICAgICAgdWludDI1NiByZWZ1bmQgPSBncmFudC52YWx1ZS5zdWIoZ3JhbnQudHJhbnNmZXJyZWQpOwoKICAgICAgICAvLyBSZW1vdmUgdGhlIGdyYW50LgogICAgICAgIGRlbGV0ZSBncmFudHNbX2hvbGRlcl07CgogICAgICAgIC8vIFVwZGF0ZSB0b3RhbCB2ZXN0aW5nIGFtb3VudCBhbmQgdHJhbnNmZXIgcHJldmlvdXNseSBjYWxjdWxhdGVkIHRva2VucyB0byBvd25lci4KICAgICAgICB0b3RhbFZlc3RpbmcgPSB0b3RhbFZlc3Rpbmcuc3ViKHJlZnVuZCk7CiAgICAgICAgcmVxdWlyZShjbG4udHJhbnNmZXIobXNnLnNlbmRlciwgcmVmdW5kKSk7CgogICAgICAgIEdyYW50UmV2b2tlZChfaG9sZGVyLCByZWZ1bmQpOwogICAgfQoKICAgIC8vLyBAZGV2IENhbGN1bGF0ZSB0aGUgYW1vdW50IG9mIHJlYWR5IHRva2VucyBvZiBhIGhvbGRlci4KICAgIC8vLyBAcGFyYW0gX2hvbGRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIG9mIHRoZSBob2xkZXIuCiAgICAvLy8gQHJldHVybiBhIHVpbnQyNTYgUmVwcmVzZW50aW5nIGEgaG9sZGVyJ3MgdG90YWwgYW1vdW50IG9mIHZlc3RlZCB0b2tlbnMuCiAgICBmdW5jdGlvbiByZWFkeVRva2VucyhhZGRyZXNzIF9ob2xkZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgR3JhbnQgbWVtb3J5IGdyYW50ID0gZ3JhbnRzW19ob2xkZXJdOwoKICAgICAgICBpZiAoZ3JhbnQudmFsdWUgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CgogICAgICAgIHVpbnQyNTYgdmVzdGVkID0gY2FsY3VsYXRlVmVzdGVkVG9rZW5zKGdyYW50LCBub3cpOwoKICAgICAgICBpZiAodmVzdGVkID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdmVzdGVkLnN1YihncmFudC50cmFuc2ZlcnJlZCk7CiAgICB9CgogICAgLy8vIEBkZXYgQ2FsY3VsYXRlIHRoZSB0b3RhbCBhbW91bnQgb2YgdmVzdGVkIHRva2VucyBvZiBhIGhvbGRlciBhdCBhIGdpdmVuIHRpbWUuCiAgICAvLy8gQHBhcmFtIF9ob2xkZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyBvZiB0aGUgaG9sZGVyLgogICAgLy8vIEBwYXJhbSBfdGltZSB1aW50MjU2IFRoZSBzcGVjaWZpYyB0aW1lIHRvIGNhbGN1bGF0ZSBhZ2FpbnN0LgogICAgLy8vIEByZXR1cm4gYSB1aW50MjU2IFJlcHJlc2VudGluZyBhIGhvbGRlcidzIHRvdGFsIGFtb3VudCBvZiB2ZXN0ZWQgdG9rZW5zLgogICAgZnVuY3Rpb24gdmVzdGVkVG9rZW5zKGFkZHJlc3MgX2hvbGRlciwgdWludDI1NiBfdGltZSkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBHcmFudCBtZW1vcnkgZ3JhbnQgPSBncmFudHNbX2hvbGRlcl07CiAgICAgICAgaWYgKGdyYW50LnZhbHVlID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gY2FsY3VsYXRlVmVzdGVkVG9rZW5zKGdyYW50LCBfdGltZSk7CiAgICB9CgogICAgLy8vIEBkZXYgQ2FsY3VsYXRlIGFtb3VudCBvZiB2ZXN0ZWQgdG9rZW5zIGF0IGEgc3BlY2lmYyB0aW1lLgogICAgLy8vIEBwYXJhbSBfZ3JhbnQgR3JhbnQgVGhlIHZlc3RpbmcgZ3JhbnQuCiAgICAvLy8gQHBhcmFtIF90aW1lIHVpbnQyNTYgVGhlIHRpbWUgdG8gYmUgY2hlY2tlZAogICAgLy8vIEByZXR1cm4gQW4gdWludDI1NiBSZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvZiB2ZXN0ZWQgdG9rZW5zIG9mIGEgc3BlY2lmaWMgZ3JhbnQuCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVWZXN0ZWRUb2tlbnMoR3JhbnQgX2dyYW50LCB1aW50MjU2IF90aW1lKSBwcml2YXRlIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIC8vIElmIHdlJ3JlIGJlZm9yZSB0aGUgY2xpZmYsIHRoZW4gbm90aGluZyBpcyB2ZXN0ZWQuCiAgICAgICAgaWYgKF90aW1lIDwgX2dyYW50LmNsaWZmKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KCiAgICAgICAgLy8gSWYgd2UncmUgYWZ0ZXIgdGhlIGVuZCBvZiB0aGUgdmVzdGluZyBwZXJpb2QgLSBldmVyeXRoaW5nIGlzIHZlc3RlZC4KICAgICAgICBpZiAoX3RpbWUgPj0gX2dyYW50LmVuZCkgewogICAgICAgICAgICByZXR1cm4gX2dyYW50LnZhbHVlOwogICAgICAgIH0KCiAgICAgICAgLy8gQ2FsY3VsYXRlIGFtb3VudCBvZiBpbnN0YWxsbWVudHMgcGFzdCB1bnRpbCBub3cuCiAgICAgICAgLy8KICAgICAgICAvLyBOT1RFOiByZXN1bHQgZ2V0cyBmbG9vcmVkIGJlY2F1c2Ugb2YgaW50ZWdlciBkaXZpc2lvbi4KICAgICAgICB1aW50MjU2IGluc3RhbGxtZW50c1Bhc3QgPSBfdGltZS5zdWIoX2dyYW50LnN0YXJ0KS5kaXYoX2dyYW50Lmluc3RhbGxtZW50TGVuZ3RoKTsKCiAgICAgICAgLy8gQ2FsY3VsYXRlIGFtb3VudCBvZiBkYXlzIGluIGVudGlyZSB2ZXN0aW5nIHBlcmlvZC4KICAgICAgICB1aW50MjU2IHZlc3RpbmdEYXlzID0gX2dyYW50LmVuZC5zdWIoX2dyYW50LnN0YXJ0KTsKCiAgICAgICAgLy8gQ2FsY3VsYXRlIGFuZCByZXR1cm4gdGhlIG51bWJlciBvZiB0b2tlbnMgYWNjb3JkaW5nIHRvIHZlc3RpbmcgZGF5cyB0aGF0IGhhdmUgcGFzc2VkLgogICAgICAgIHJldHVybiBfZ3JhbnQudmFsdWUubXVsKGluc3RhbGxtZW50c1Bhc3QubXVsKF9ncmFudC5pbnN0YWxsbWVudExlbmd0aCkpLmRpdih2ZXN0aW5nRGF5cyk7CiAgICB9CgogICAgLy8vIEBkZXYgVW5sb2NrIHZlc3RlZCB0b2tlbnMgYW5kIHRyYW5zZmVyIHRoZW0gdG8gdGhlIGdyYW50ZWUuCiAgICAvLy8gQHJldHVybiBhIHVpbnQgVGhlIHN1Y2Nlc3Mgb3IgZXJyb3IgY29kZS4KICAgIGZ1bmN0aW9uIHVubG9ja1Zlc3RlZFRva2VucygpIGV4dGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gdW5sb2NrVmVzdGVkVG9rZW5zKG1zZy5zZW5kZXIpOwogICAgfQoKICAgIC8vLyBAZGV2IFVubG9jayB2ZXN0ZWQgdG9rZW5zIGFuZCB0cmFuc2ZlciB0aGVtIHRvIHRoZSBncmFudGVlIChoZWxwZXIgZnVuY3Rpb24pLgogICAgLy8vIEBwYXJhbSBfZ3JhbnRlZSBhZGRyZXNzIFRoZSBhZGRyZXNzIG9mIHRoZSBncmFudGVlLgogICAgLy8vIEByZXR1cm4gYSB1aW50IFRoZSBzdWNjZXNzIG9yIGVycm9yIGNvZGUuCiAgICBmdW5jdGlvbiB1bmxvY2tWZXN0ZWRUb2tlbnMoYWRkcmVzcyBfZ3JhbnRlZSkgcHJpdmF0ZSByZXR1cm5zICh1aW50KSB7CiAgICAgICAgR3JhbnQgc3RvcmFnZSBncmFudCA9IGdyYW50c1tfZ3JhbnRlZV07CgogICAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgZ3JhbnQgaGFzIHRva2VucyBhdmFpbGFibGUuCiAgICAgICAgaWYgKGdyYW50LnZhbHVlID09IDApIHsKICAgICAgICAgICAgRXJyb3IoX2dyYW50ZWUsIEVSUl9JTlZBTElEX1ZBTFVFKTsKICAgICAgICAgICAgcmV0dXJuIEVSUl9JTlZBTElEX1ZBTFVFOwogICAgICAgIH0KCiAgICAgICAgLy8gR2V0IHRoZSB0b3RhbCBhbW91bnQgb2YgdmVzdGVkIHRva2VucywgYWNjY29yZGluZyB0byBncmFudC4KICAgICAgICB1aW50MjU2IHZlc3RlZCA9IGNhbGN1bGF0ZVZlc3RlZFRva2VucyhncmFudCwgbm93KTsKICAgICAgICBpZiAodmVzdGVkID09IDApIHsKICAgICAgICAgICAgRXJyb3IoX2dyYW50ZWUsIEVSUl9JTlZBTElEX1ZFU1RFRCk7CiAgICAgICAgICAgIHJldHVybiBFUlJfSU5WQUxJRF9WRVNURUQ7CiAgICAgICAgfQoKICAgICAgICAvLyBNYWtlIHN1cmUgdGhlIGhvbGRlciBkb2Vzbid0IHRyYW5zZmVyIG1vcmUgdGhhbiB3aGF0IGhlIGFscmVhZHkgaGFzLgogICAgICAgIHVpbnQyNTYgdHJhbnNmZXJhYmxlID0gdmVzdGVkLnN1YihncmFudC50cmFuc2ZlcnJlZCk7CiAgICAgICAgaWYgKHRyYW5zZmVyYWJsZSA9PSAwKSB7CiAgICAgICAgICAgIEVycm9yKF9ncmFudGVlLCBFUlJfSU5WQUxJRF9UUkFOU0ZFUkFCTEUpOwogICAgICAgICAgICByZXR1cm4gRVJSX0lOVkFMSURfVFJBTlNGRVJBQkxFOwogICAgICAgIH0KCiAgICAgICAgLy8gVXBkYXRlIHRyYW5zZmVycmVkIGFuZCB0b3RhbCB2ZXN0aW5nIGFtb3VudCwgdGhlbiB0cmFuc2ZlciByZW1haW5pbmcgdmVzdGVkIGZ1bmRzIHRvIGhvbGRlci4KICAgICAgICBncmFudC50cmFuc2ZlcnJlZCA9IGdyYW50LnRyYW5zZmVycmVkLmFkZCh0cmFuc2ZlcmFibGUpOwogICAgICAgIHRvdGFsVmVzdGluZyA9IHRvdGFsVmVzdGluZy5zdWIodHJhbnNmZXJhYmxlKTsKICAgICAgICByZXF1aXJlKGNsbi50cmFuc2ZlcihfZ3JhbnRlZSwgdHJhbnNmZXJhYmxlKSk7CgogICAgICAgIFRva2Vuc1VubG9ja2VkKF9ncmFudGVlLCB0cmFuc2ZlcmFibGUpOwogICAgICAgIHJldHVybiBPSzsKICAgIH0KCiAgICAvLy8gQGRldiBiYXRjaFVubG9ja1Zlc3RlZFRva2VucyB2ZXN0ZWQgdG9rZW5zIGFuZCB0cmFuc2ZlciB0aGVtIHRvIHRoZSBncmFudGVlcy4KICAgIC8vLyBAcGFyYW0gX2dyYW50ZWVzIGFkZHJlc3NbXSBUaGUgYWRkcmVzc2VzIG9mIHRoZSBncmFudGVlcy4KICAgIC8vLyBAcmV0dXJuIGEgYm9vIGlmIHN1Y2Nlc3MuCiAgICBmdW5jdGlvbiBiYXRjaFVubG9ja1Zlc3RlZFRva2VucyhhZGRyZXNzW10gX2dyYW50ZWVzKSBleHRlcm5hbCBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpPF9ncmFudGVlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB1bmxvY2tWZXN0ZWRUb2tlbnMoX2dyYW50ZWVzW2ldKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8vIEBkZXYgQWxsb3cgdGhlIG93bmVyIHRvIHRyYW5zZmVyIG91dCBhbnkgYWNjaWRlbnRhbGx5IHNlbnQgRVJDMjAgdG9rZW5zLgogICAgLy8vIEBwYXJhbSBfdG9rZW5BZGRyZXNzIGFkZHJlc3MgVGhlIGFkZHJlc3Mgb2YgdGhlIEVSQzIwIGNvbnRyYWN0LgogICAgLy8vIEBwYXJhbSBfYW1vdW50IHVpbnQyNTYgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQuCiAgICBmdW5jdGlvbiB3aXRoZHJhd0VSQzIwKGFkZHJlc3MgX3Rva2VuQWRkcmVzcywgdWludDI1NiBfYW1vdW50KSBwdWJsaWMgb25seU93bmVyIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGlmIChfdG9rZW5BZGRyZXNzID09IGFkZHJlc3MoY2xuKSkgewogICAgICAgICAgICAvLyBJZiB0aGUgdG9rZW4gaXMgY2xuLCBhbGxvdyB0byB3aXRoZHJhdyBvbmx5IG5vbiB2ZXN0ZWQgdG9rZW5zLgogICAgICAgICAgICB1aW50MjU2IGF2YWlsYWJsZUNMTiA9IGNsbi5iYWxhbmNlT2YodGhpcykuc3ViKHRvdGFsVmVzdGluZyk7CiAgICAgICAgICAgIHJlcXVpcmUoX2Ftb3VudCA8PSBhdmFpbGFibGVDTE4pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gRVJDMjAoX3Rva2VuQWRkcmVzcykudHJhbnNmZXIob3duZXIsIF9hbW91bnQpOwogICAgfQp9CgoKCgoKCgoKLy8vIEB0aXRsZSBDb2x1IExvY2FsIE5ldHdvcmsgc2FsZSBjb250cmFjdC4KLy8vIEBhdXRob3IgVGFsIEJlamEuCmNvbnRyYWN0IENvbHVMb2NhbE5ldHdvcmtTYWxlIGlzIE93bmFibGUsIFRva2VuSG9sZGVyIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIC8vIEV4dGVybmFsIHBhcnRpZXM6CgogICAgLy8gQ29sdSBMb2NhbCBOZXR3b3JrIGNvbnRyYWN0LgogICAgQ29sdUxvY2FsTmV0d29yayBwdWJsaWMgY2xuOwoKICAgIC8vIFZlc3RpbmcgY29udHJhY3QgZm9yIHByZXNhbGUgcGFydGljaXBhbnRzLgogICAgVmVzdGluZ1RydXN0ZWUgcHVibGljIHRydXN0ZWU7CgogICAgLy8gUmVjZWl2ZWQgZnVuZHMgYXJlIGZvcndhcmRlZCB0byB0aGlzIGFkZHJlc3MuCiAgICBhZGRyZXNzIHB1YmxpYyBmdW5kaW5nUmVjaXBpZW50OwoKICAgIC8vIFBvc3QtVERFIG11bHRpc2lnIGFkZHJlc3Nlcy4KICAgIGFkZHJlc3MgcHVibGljIGNvbW11bml0eVBvb2xBZGRyZXNzOwogICAgYWRkcmVzcyBwdWJsaWMgZnV0dXJlRGV2ZWxvcG1lbnRQb29sQWRkcmVzczsKICAgIGFkZHJlc3MgcHVibGljIHN0YWtlaG9sZGVyc1Bvb2xBZGRyZXNzOwoKICAgIC8vIENvbHUgTG9jYWwgTmV0d29yayBkZWNpbWFscy4KICAgIC8vIFVzaW5nIHNhbWUgZGVjaW1hbHMgdmFsdWUgYXMgRVRIIChtYWtlcyBFVEgtQ0xOIGNvbnZlcnNpb24gbXVjaCBlYXNpZXIpLgogICAgLy8gVGhpcyBpcyB0aGUgc2FtZSBhcyBpbiBDb2x1IExvY2FsIE5ldHdvcmsgY29udHJhY3QuCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBUT0tFTl9ERUNJTUFMUyA9IDEwICoqIDE4OwoKICAgIC8vIEFkZGl0aW9uYWwgTG9ja3VwIEFsbG9jYXRpb24gUG9vbAogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgQUxBUCA9IDQwNzAxMzMzNTkyNTkyNTkyNTkyNjE0MTE2OwoKICAgIC8vIE1heGltdW0gbnVtYmVyIG9mIHRva2VucyBpbiBjaXJjdWxhdGlvbjogMS41IHRyaWxsaW9uLgogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgTUFYX1RPS0VOUyA9IDE1ICogMTAgKiogOCAqIFRPS0VOX0RFQ0lNQUxTICsgQUxBUDsKCiAgICAvLyBNYXhpbXVtIHRva2VucyBvZmZlcmVkIGluIHRoZSBzYWxlICgzNSUpICsgQUxBUC4KICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IE1BWF9UT0tFTlNfU09MRCA9IDUyNSAqIDEwICoqIDYgKiBUT0tFTl9ERUNJTUFMUyArIEFMQVA7CgogICAgLy8gTWF4aW11bSB0b2tlbnMgb2ZmZXJlZCBpbiB0aGUgcHJlc2FsZSAoZnJvbSB0aGUgaW5pdGlhbCAzNSUgb2ZmZXJlZCB0b2tlbnMpICsgQUxBUC4KICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IE1BWF9QUkVTQUxFX1RPS0VOU19TT0xEID0gMjYyNSAqIDEwICoqIDUgKiBUT0tFTl9ERUNJTUFMUyArIEFMQVA7CgogICAgLy8gVG9rZW5zIGFsbG9jYXRlZCBmb3IgQ29tbXVuaXR5IHBvb2wgKDMwJSkuCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBDT01NVU5JVFlfUE9PTCA9IDQ1ICogMTAgKiogNyAqIFRPS0VOX0RFQ0lNQUxTOwoKICAgIC8vIFRva2VucyBhbGxvY2F0ZWQgZm9yIEZ1dHVyZSBkZXZlbG9wbWVudCBwb29sICgyOSUpLgogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgRlVUVVJFX0RFVkVMT1BNRU5UX1BPT0wgPSA0MzUgKiAxMCAqKiA2ICogVE9LRU5fREVDSU1BTFM7CgogICAgLy8gVG9rZW5zIGFsbG9jYXRlZCBmb3IgU3Rha2Vob2xkZXMgcG9vbCAoNiUpLgogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgU1RBS0VIT0xERVJTX1BPT0wgPSA5ICogMTAgKiogNyAqIFRPS0VOX0RFQ0lNQUxTOwoKICAgIC8vIENMTiB0byBFVEggcmF0aW8uCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBDTE5fUEVSX0VUSCA9IDg2MDA7CgogICAgLy8gU2FsZSBzdGFydCwgZW5kIGJsb2NrcyAodGltZSByYW5nZXMpCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBTQUxFX0RVUkFUSU9OID0gNCBkYXlzOwogICAgdWludDI1NiBwdWJsaWMgc3RhcnRUaW1lOwogICAgdWludDI1NiBwdWJsaWMgZW5kVGltZTsKCiAgICAvLyBBbW91bnQgb2YgdG9rZW5zIHNvbGQgdW50aWwgbm93IGluIHRoZSBzYWxlLgogICAgdWludDI1NiBwdWJsaWMgdG9rZW5zU29sZCA9IDA7CgogICAgLy8gQW1vdW50IG9mIHRva2VucyBzb2xkIHVudGlsIG5vdyBpbiB0aGUgcHJlc2FsZS4KICAgIHVpbnQyNTYgcHVibGljIHByZXNhbGVUb2tlbnNTb2xkID0gMDsKCiAgICAvLyBBY2N1bXVsYXRlZCBhbW91bnQgZWFjaCBwYXJ0aWNpcGFudCBoYXMgY29udHJpYnV0ZWQgc28gZmFyIGluIHRoZSBzYWxlIChpbiBXRUkpLgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgcGFydGljaXBhdGlvbkhpc3Rvcnk7CgogICAgLy8gQWNjdW11bGF0ZWQgYW1vdW50IGVhY2ggcGFydGljaXBhbnQgaGF2ZSBjb250cmlidXRlZCBzbyBmYXIgaW4gdGhlIHByZXNhbGUuCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBwYXJ0aWNpcGF0aW9uUHJlc2FsZUhpc3Rvcnk7CgogICAgLy8gTWF4aW11bSBhbW91bnQgdGhhdCBlYWNoIHBhcnRpY3VsYXIgaXMgYWxsb3dlZCB0byBjb250cmlidXRlIChpbiBFVEgtV0VJKS4KICAgIC8vIERlZmF1bHRzIHRvIHplcm8uIFNlcnZpbmcgYXMgYSBmdW5jdGlvbmFsIHdoaXRlbGlzdC4gCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBwYXJ0aWNpcGF0aW9uQ2FwczsKCiAgICAvLyBNYXhpbXVtIGFtb3VudCBBTllPTkUgaXMgY3VycmVudGx5IGFsbG93ZWQgdG8gY29udHJpYnV0ZS4gU2V0IHRvIG1heCB1aW50MjU2IHNvIG5vIGxpbWl0YXRpb24gb3RoZXIgdGhhbiBwZXJzb25hbCBwYXJ0aWNpcGF0aW9uQ2Fwcy4KICAgIHVpbnQyNTYgcHVibGljIGhhcmRQYXJ0aWNpcGF0aW9uQ2FwID0gdWludDI1NigtMSk7CgogICAgLy8gaW5pdGlhbGl6YXRpb24gb2YgdGhlIGNvbnRyYWN0LCBzcGxpdHRlZCBmcm9tIHRoZSBjb25zdHJ1Y3RvciB0byBhdm9pZCBnYXMgYmxvY2sgbGltaXQuCiAgICBib29sIHB1YmxpYyBpbml0aWFsaXplZCA9IGZhbHNlOwoKICAgIC8vIFZlc3RpbmcgcGxhbiBzdHJ1Y3R1cmUgZm9yIHByZXNhbGUKICAgIHN0cnVjdCBWZXN0aW5nUGxhbiB7CiAgICAgICAgdWludDI1NiBzdGFydE9mZnNldDsKICAgICAgICB1aW50MjU2IGNsaWZmT2Zmc2V0OwogICAgICAgIHVpbnQyNTYgZW5kT2Zmc2V0OwogICAgICAgIHVpbnQyNTYgaW5zdGFsbG1lbnRMZW5ndGg7CiAgICAgICAgdWludDggYWxhcFBlcmNlbnQ7CiAgICB9CgogICAgLy8gVmVzdGluZyBwbGFucyBmb3IgcHJlc2FsZQogICAgVmVzdGluZ1BsYW5bXSBwdWJsaWMgdmVzdGluZ1BsYW5zOwoKICAgIC8vIEVhY2ggdG9rZW4gdGhhdCBpcyBzZW50IGZyb20gdGhlIENvbHVMb2NhbE5ldHdvcmtTYWxlIGlzIGNvbnNpZGVyZWQgYXMgaXNzdWVkLgogICAgZXZlbnQgVG9rZW5zSXNzdWVkKGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB0b2tlbnMpOwoKICAgIC8vLyBAZGV2IFJldmVydHMgaWYgY2FsbGVkIG5vdCBiZWZvcmUgdGhlIHNhbGUuCiAgICBtb2RpZmllciBvbmx5QmVmb3JlU2FsZSgpIHsKICAgICAgICBpZiAobm93ID49IHN0YXJ0VGltZSkgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CgogICAgICAgIF87CiAgICB9CgogICAgLy8vIEBkZXYgUmV2ZXJ0cyBpZiBjYWxsZWQgbm90IGR1cmluZyB0aGUgc2FsZS4KICAgIG1vZGlmaWVyIG9ubHlEdXJpbmdTYWxlKCkgewogICAgICAgIGlmICh0b2tlbnNTb2xkID49IE1BWF9UT0tFTlNfU09MRCB8fCBub3cgPCBzdGFydFRpbWUgfHwgbm93ID49IGVuZFRpbWUpIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQoKICAgICAgICBfOwogICAgfQoKICAgIC8vLyBAZGV2IFJldmVydHMgaWYgY2FsbGVkIGJlZm9yZSB0aGUgc2FsZSBlbmRzLgogICAgbW9kaWZpZXIgb25seUFmdGVyU2FsZSgpIHsKICAgICAgICBpZiAoISh0b2tlbnNTb2xkID49IE1BWF9UT0tFTlNfU09MRCB8fCBub3cgPj0gZW5kVGltZSkpIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQoKICAgICAgICBfOwogICAgfQoKICAgIC8vLyBAZGV2IFJldmVydHMgaWYgY2FsbGVkIGJlZm9yZSB0aGUgc2FsZSBpcyBpbml0aWFsaXplZC4KICAgIG1vZGlmaWVyIG5vdEluaXRpYWxpemVkKCkgewogICAgICAgIGlmIChpbml0aWFsaXplZCkgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CgogICAgICAgIF87CiAgICB9CgoKICAgIC8vLyBAZGV2IFJldmVydHMgaWYgY2FsbGVkIGFmdGVyIHRoZSBzYWxlIGlzIGluaXRpYWxpemVkLgogICAgbW9kaWZpZXIgaXNJbml0aWFsaXplZCgpIHsKICAgICAgICBpZiAoIWluaXRpYWxpemVkKSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KCiAgICAgICAgXzsKICAgIH0KCiAgICAvLy8gQGRldiBDb25zdHJ1Y3RvciBzZXRzIHRoZSBzYWxlIGFkZHJlc3NlcyBhbmQgc3RhcnQgdGltZS4KICAgIC8vLyBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgb2YgdGhpcyBjb250cmFjdCBvd25lci4KICAgIC8vLyBAcGFyYW0gX2Z1bmRpbmdSZWNpcGllbnQgYWRkcmVzcyBUaGUgYWRkcmVzcyBvZiB0aGUgZnVuZGluZyByZWNpcGllbnQuCiAgICAvLy8gQHBhcmFtIF9jb21tdW5pdHlQb29sQWRkcmVzcyBhZGRyZXNzIFRoZSBhZGRyZXNzIG9mIHRoZSBjb21tdW5pdHkgcG9vbC4KICAgIC8vLyBAcGFyYW0gX2Z1dHVyZURldmVsb3BtZW50UG9vbEFkZHJlc3MgYWRkcmVzcyBUaGUgYWRkcmVzcyBvZiB0aGUgZnV0dXJlIGRldmVsb3BtZW50IHBvb2wuCiAgICAvLy8gQHBhcmFtIF9zdGFrZWhvbGRlcnNQb29sQWRkcmVzcyBhZGRyZXNzIFRoZSBhZGRyZXNzIG9mIHRoZSB0ZWFtIHBvb2wuCiAgICAvLy8gQHBhcmFtIF9zdGFydFRpbWUgdWludDI1NiBUaGUgc3RhcnQgdGltZSBvZiB0aGUgdG9rZW4gc2FsZS4KICAgIGZ1bmN0aW9uIENvbHVMb2NhbE5ldHdvcmtTYWxlKGFkZHJlc3MgX293bmVyLAogICAgICAgIGFkZHJlc3MgX2Z1bmRpbmdSZWNpcGllbnQsCiAgICAgICAgYWRkcmVzcyBfY29tbXVuaXR5UG9vbEFkZHJlc3MsCiAgICAgICAgYWRkcmVzcyBfZnV0dXJlRGV2ZWxvcG1lbnRQb29sQWRkcmVzcywKICAgICAgICBhZGRyZXNzIF9zdGFrZWhvbGRlcnNQb29sQWRkcmVzcywKICAgICAgICB1aW50MjU2IF9zdGFydFRpbWUpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfb3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfZnVuZGluZ1JlY2lwaWVudCAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF9jb21tdW5pdHlQb29sQWRkcmVzcyAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF9mdXR1cmVEZXZlbG9wbWVudFBvb2xBZGRyZXNzICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3N0YWtlaG9sZGVyc1Bvb2xBZGRyZXNzICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3N0YXJ0VGltZSA+IG5vdyk7CgogICAgICAgIG93bmVyID0gX293bmVyOwogICAgICAgIGZ1bmRpbmdSZWNpcGllbnQgPSBfZnVuZGluZ1JlY2lwaWVudDsKICAgICAgICBjb21tdW5pdHlQb29sQWRkcmVzcyA9IF9jb21tdW5pdHlQb29sQWRkcmVzczsKICAgICAgICBmdXR1cmVEZXZlbG9wbWVudFBvb2xBZGRyZXNzID0gX2Z1dHVyZURldmVsb3BtZW50UG9vbEFkZHJlc3M7CiAgICAgICAgc3Rha2Vob2xkZXJzUG9vbEFkZHJlc3MgPSBfc3Rha2Vob2xkZXJzUG9vbEFkZHJlc3M7CiAgICAgICAgc3RhcnRUaW1lID0gX3N0YXJ0VGltZTsKICAgICAgICBlbmRUaW1lID0gc3RhcnRUaW1lICsgU0FMRV9EVVJBVElPTjsKICAgIH0KCiAgICAvLy8gQGRldiBJbml0aWFsaXplIHRoZSBzYWxlIGNvbmRpdGlvbnMuCiAgICBmdW5jdGlvbiBpbml0aWFsaXplKCkgcHVibGljIG9ubHlPd25lciBub3RJbml0aWFsaXplZCB7CiAgICAgICAgaW5pdGlhbGl6ZWQgPSB0cnVlOwoKICAgICAgICB1aW50MjU2IG1vbnRocyA9IDEgeWVhcnMgLyAxMjsKCiAgICAgICAgdmVzdGluZ1BsYW5zLnB1c2goVmVzdGluZ1BsYW4oMCwgMCwgMSwgMSwgMCkpOwogICAgICAgIHZlc3RpbmdQbGFucy5wdXNoKFZlc3RpbmdQbGFuKDAsIDAsIDYgKiBtb250aHMsIDEgKiBtb250aHMsIDQpKTsKICAgICAgICB2ZXN0aW5nUGxhbnMucHVzaChWZXN0aW5nUGxhbigwLCAwLCAxIHllYXJzLCAxICogbW9udGhzLCAxMikpOwogICAgICAgIHZlc3RpbmdQbGFucy5wdXNoKFZlc3RpbmdQbGFuKDAsIDAsIDIgeWVhcnMsIDEgKiBtb250aHMsIDI2KSk7CiAgICAgICAgdmVzdGluZ1BsYW5zLnB1c2goVmVzdGluZ1BsYW4oMCwgMCwgMyB5ZWFycywgMSAqIG1vbnRocywgMzUpKTsKCiAgICAgICAgLy8gRGVwbG95IG5ldyBDb2x1TG9jYWxOZXR3b3JrIGNvbnRyYWN0LgogICAgICAgIGNsbiA9IG5ldyBDb2x1TG9jYWxOZXR3b3JrKE1BWF9UT0tFTlMpOwoKICAgICAgICAvLyBEZXBsb3kgbmV3IFZlc3RpbmdUcnVzdGVlIGNvbnRyYWN0LgogICAgICAgIHRydXN0ZWUgPSBuZXcgVmVzdGluZ1RydXN0ZWUoY2xuKTsKCiAgICAgICAgLy8gYWxsb2NhdGUgcG9vbCB0b2tlbnM6CiAgICAgICAgLy8gSXNzdWUgdGhlIHJlbWFpbmluZyB0b2tlbnMgdG8gZGVzaWduYXRlZCBwb29scy4KICAgICAgICByZXF1aXJlKHRyYW5zZmVyVG9rZW5zKGNvbW11bml0eVBvb2xBZGRyZXNzLCBDT01NVU5JVFlfUE9PTCkpOwoKICAgICAgICAvLyBzdGFrZWhvbGRlcnNQb29sQWRkcmVzcyB3aWxsIGNyZWF0ZSBpdHMgb3duIHZlc3RpbmcgdHJ1c3RzLgogICAgICAgIHJlcXVpcmUodHJhbnNmZXJUb2tlbnMoc3Rha2Vob2xkZXJzUG9vbEFkZHJlc3MsIFNUQUtFSE9MREVSU19QT09MKSk7CiAgICB9CgogICAgLy8vIEBkZXYgQWxsb2NhdGUgdG9rZW5zIHRvIHByZXNhbGUgcGFydGljaXBhbnQgYWNjb3JkaW5nIHRvIGl0cyB2ZXN0aW5nIHBsYW4gYW5kIGludmVzbWVudCB2YWx1ZS4KICAgIC8vLyBAcGFyYW0gX3JlY2lwaWVudCBhZGRyZXNzIFRoZSBwcmVzYWxlIHBhcnRpY2lwYW50IGFkZHJlc3MgdG8gcmVjaWV2ZSB0aGUgdG9rZW5zLgogICAgLy8vIEBwYXJhbSBfZXRoZXJWYWx1ZSB1aW50MjU2IFRoZSBpbnZlc21lbnQgdmFsdWUgKGluIEVUSCkuCiAgICAvLy8gQHBhcmFtIF92ZXN0aW5nUGxhbkluZGV4IHVpbnQ4IFRoZSB2ZXN0aW5nIHBsYW4gaW5kZXguCiAgICBmdW5jdGlvbiBwcmVzYWxlQWxsb2NhdGlvbihhZGRyZXNzIF9yZWNpcGllbnQsIHVpbnQyNTYgX2V0aGVyVmFsdWUsIHVpbnQ4IF92ZXN0aW5nUGxhbkluZGV4KSBleHRlcm5hbCBvbmx5T3duZXIgb25seUJlZm9yZVNhbGUgaXNJbml0aWFsaXplZCB7CiAgICAgICAgcmVxdWlyZShfcmVjaXBpZW50ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3Zlc3RpbmdQbGFuSW5kZXggPCB2ZXN0aW5nUGxhbnMubGVuZ3RoKTsKCiAgICAgICAgLy8gQ2FsY3VsYXRlIHBsYW4gYW5kIHRva2VuIGFtb3VudC4KICAgICAgICBWZXN0aW5nUGxhbiBtZW1vcnkgcGxhbiA9IHZlc3RpbmdQbGFuc1tfdmVzdGluZ1BsYW5JbmRleF07CiAgICAgICAgdWludDI1NiB0b2tlbnNBbmRBTEFQUGVyRXRoID0gQ0xOX1BFUl9FVEgubXVsKFNhZmVNYXRoLmFkZCgxMDAsIHBsYW4uYWxhcFBlcmNlbnQpKS5kaXYoMTAwKTsKCiAgICAgICAgdWludDI1NiB0b2tlbnNMZWZ0SW5QcmVTYWxlID0gTUFYX1BSRVNBTEVfVE9LRU5TX1NPTEQuc3ViKHByZXNhbGVUb2tlbnNTb2xkKTsKICAgICAgICB1aW50MjU2IHdlaUxlZnRJblNhbGUgPSB0b2tlbnNMZWZ0SW5QcmVTYWxlLmRpdih0b2tlbnNBbmRBTEFQUGVyRXRoKTsKICAgICAgICB1aW50MjU2IHdlaVRvUGFydGljaXBhdGUgPSBTYWZlTWF0aC5taW4yNTYoX2V0aGVyVmFsdWUsIHdlaUxlZnRJblNhbGUpOwogICAgICAgIHJlcXVpcmUod2VpVG9QYXJ0aWNpcGF0ZSA+IDApOwogICAgICAgIHBhcnRpY2lwYXRpb25QcmVzYWxlSGlzdG9yeVttc2cuc2VuZGVyXSA9IHBhcnRpY2lwYXRpb25QcmVzYWxlSGlzdG9yeVttc2cuc2VuZGVyXS5hZGQod2VpVG9QYXJ0aWNpcGF0ZSk7CiAgICAgICAgdWludDI1NiB0b2tlbnNUb1RyYW5zZmVyID0gd2VpVG9QYXJ0aWNpcGF0ZS5tdWwodG9rZW5zQW5kQUxBUFBlckV0aCk7CiAgICAgICAgcHJlc2FsZVRva2Vuc1NvbGQgPSBwcmVzYWxlVG9rZW5zU29sZC5hZGQodG9rZW5zVG9UcmFuc2Zlcik7CiAgICAgICAgdG9rZW5zU29sZCA9IHRva2Vuc1NvbGQuYWRkKHRva2Vuc1RvVHJhbnNmZXIpOwoKICAgICAgICAvLyBUcmFuc2ZlciB0b2tlbnMgdG8gdHJ1c3RlZSBhbmQgY3JlYXRlIGdyYW50LgogICAgICAgIGdyYW50KF9yZWNpcGllbnQsIHRva2Vuc1RvVHJhbnNmZXIsIHN0YXJ0VGltZS5hZGQocGxhbi5zdGFydE9mZnNldCksIHN0YXJ0VGltZS5hZGQocGxhbi5jbGlmZk9mZnNldCksCiAgICAgICAgICAgIHN0YXJ0VGltZS5hZGQocGxhbi5lbmRPZmZzZXQpLCBwbGFuLmluc3RhbGxtZW50TGVuZ3RoLCBmYWxzZSk7CiAgICB9CgogICAgLy8vIEBkZXYgQWRkIGEgbGlzdCBvZiBwYXJ0aWNpcGFudHMgdG8gYSBjYXBwZWQgcGFydGljaXBhdGlvbiB0aWVyLgogICAgLy8vIEBwYXJhbSBfcGFydGljaXBhbnRzIGFkZHJlc3NbXSBUaGUgbGlzdCBvZiBwYXJ0aWNpcGFudCBhZGRyZXNzZXMuCiAgICAvLy8gQHBhcmFtIF9jYXAgdWludDI1NiBUaGUgY2FwIGFtb3VudCAoaW4gRVRILVdFSSkuCiAgICBmdW5jdGlvbiBzZXRQYXJ0aWNpcGF0aW9uQ2FwKGFkZHJlc3NbXSBfcGFydGljaXBhbnRzLCB1aW50MjU2IF9jYXApIGV4dGVybmFsIG9ubHlPd25lciBpc0luaXRpYWxpemVkIHsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBfcGFydGljaXBhbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHBhcnRpY2lwYXRpb25DYXBzW19wYXJ0aWNpcGFudHNbaV1dID0gX2NhcDsKICAgICAgICB9CiAgICB9CgogICAgLy8vIEBkZXYgU2V0IGhhcmQgcGFydGljaXBhdGlvbiBjYXAgZm9yIGFsbCBwYXJ0aWNpcGFudHMuCiAgICAvLy8gQHBhcmFtIF9jYXAgdWludDI1NiBUaGUgaGFyZCBjYXAgYW1vdW50LgogICAgZnVuY3Rpb24gc2V0SGFyZFBhcnRpY2lwYXRpb25DYXAodWludDI1NiBfY2FwKSBleHRlcm5hbCBvbmx5T3duZXIgaXNJbml0aWFsaXplZCB7CiAgICAgICAgcmVxdWlyZShfY2FwID4gMCk7CgogICAgICAgIGhhcmRQYXJ0aWNpcGF0aW9uQ2FwID0gX2NhcDsKICAgIH0KCiAgICAvLy8gQGRldiBGYWxsYmFjayBmdW5jdGlvbiB0aGF0IHdpbGwgZGVsZWdhdGUgdGhlIHJlcXVlc3QgdG8gcGFydGljaXBhdGUoKS4KICAgIGZ1bmN0aW9uICgpIGV4dGVybmFsIHBheWFibGUgb25seUR1cmluZ1NhbGUgaXNJbml0aWFsaXplZCB7CiAgICAgICAgcGFydGljaXBhdGUobXNnLnNlbmRlcik7CiAgICB9CgogICAgLy8vIEBkZXYgQ3JlYXRlIGFuZCBzZWxsIHRva2VucyB0byB0aGUgY2FsbGVyLgogICAgLy8vIEBwYXJhbSBfcmVjaXBpZW50IGFkZHJlc3MgVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudCByZWNlaXZpbmcgdGhlIHRva2Vucy4KICAgIGZ1bmN0aW9uIHBhcnRpY2lwYXRlKGFkZHJlc3MgX3JlY2lwaWVudCkgcHVibGljIHBheWFibGUgb25seUR1cmluZ1NhbGUgaXNJbml0aWFsaXplZCB7CiAgICAgICAgcmVxdWlyZShfcmVjaXBpZW50ICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICAvLyBFbmZvcmNlIHBhcnRpY2lwYXRpb24gY2FwIChpbiBXRUkgcmVjZWl2ZWQpLgogICAgICAgIHVpbnQyNTYgd2VpQWxyZWFkeVBhcnRpY2lwYXRlZCA9IHBhcnRpY2lwYXRpb25IaXN0b3J5W19yZWNpcGllbnRdOwogICAgICAgIHVpbnQyNTYgcGFydGljaXBhdGlvbkNhcCA9IFNhZmVNYXRoLm1pbjI1NihwYXJ0aWNpcGF0aW9uQ2Fwc1tfcmVjaXBpZW50XSwgaGFyZFBhcnRpY2lwYXRpb25DYXApOwogICAgICAgIHVpbnQyNTYgY2FwcGVkV2VpUmVjZWl2ZWQgPSBTYWZlTWF0aC5taW4yNTYobXNnLnZhbHVlLCBwYXJ0aWNpcGF0aW9uQ2FwLnN1Yih3ZWlBbHJlYWR5UGFydGljaXBhdGVkKSk7CiAgICAgICAgcmVxdWlyZShjYXBwZWRXZWlSZWNlaXZlZCA+IDApOwoKICAgICAgICAvLyBBY2NlcHQgZnVuZHMgYW5kIHRyYW5zZmVyIHRvIGZ1bmRpbmcgcmVjaXBpZW50LgogICAgICAgIHVpbnQyNTYgdG9rZW5zTGVmdEluU2FsZSA9IE1BWF9UT0tFTlNfU09MRC5zdWIodG9rZW5zU29sZCk7CiAgICAgICAgdWludDI1NiB3ZWlMZWZ0SW5TYWxlID0gdG9rZW5zTGVmdEluU2FsZS5kaXYoQ0xOX1BFUl9FVEgpOwogICAgICAgIHVpbnQyNTYgd2VpVG9QYXJ0aWNpcGF0ZSA9IFNhZmVNYXRoLm1pbjI1NihjYXBwZWRXZWlSZWNlaXZlZCwgd2VpTGVmdEluU2FsZSk7CiAgICAgICAgcGFydGljaXBhdGlvbkhpc3RvcnlbX3JlY2lwaWVudF0gPSB3ZWlBbHJlYWR5UGFydGljaXBhdGVkLmFkZCh3ZWlUb1BhcnRpY2lwYXRlKTsKICAgICAgICBmdW5kaW5nUmVjaXBpZW50LnRyYW5zZmVyKHdlaVRvUGFydGljaXBhdGUpOwoKICAgICAgICAvLyBUcmFuc2ZlciB0b2tlbnMgdG8gcmVjaXBpZW50LgogICAgICAgIHVpbnQyNTYgdG9rZW5zVG9UcmFuc2ZlciA9IHdlaVRvUGFydGljaXBhdGUubXVsKENMTl9QRVJfRVRIKTsKICAgICAgICBpZiAodG9rZW5zTGVmdEluU2FsZS5zdWIodG9rZW5zVG9UcmFuc2ZlcikgPCBDTE5fUEVSX0VUSCkgewogICAgICAgICAgICAvLyBJZiBwdXJjaGFzZSB3b3VsZCBjYXVzZSBsZXNzIHRoYW4gQ0xOX1BFUl9FVEggdG9rZW5zIHRvIGJlIGxlZnQgdGhlbiBub2JvZHkgY291bGQgZXZlciBidXkgdGhlbS4KICAgICAgICAgICAgLy8gU28sIGdpZnQgdGhlbSB0byB0aGUgbGFzdCBidXllci4KICAgICAgICAgICAgdG9rZW5zVG9UcmFuc2ZlciA9IHRva2Vuc0xlZnRJblNhbGU7CiAgICAgICAgfQogICAgICAgIHRva2Vuc1NvbGQgPSB0b2tlbnNTb2xkLmFkZCh0b2tlbnNUb1RyYW5zZmVyKTsKICAgICAgICByZXF1aXJlKHRyYW5zZmVyVG9rZW5zKF9yZWNpcGllbnQsIHRva2Vuc1RvVHJhbnNmZXIpKTsKCiAgICAgICAgLy8gUGFydGlhbCByZWZ1bmQgaWYgZnVsbCBwYXJ0aWNpcGF0aW9uIG5vdCBwb3NzaWJsZQogICAgICAgIC8vIGUuZy4gZHVlIHRvIGNhcCBiZWluZyByZWFjaGVkLgogICAgICAgIHVpbnQyNTYgcmVmdW5kID0gbXNnLnZhbHVlLnN1Yih3ZWlUb1BhcnRpY2lwYXRlKTsKICAgICAgICBpZiAocmVmdW5kID4gMCkgewogICAgICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHJlZnVuZCk7CiAgICAgICAgfQogICAgfQoKICAgIC8vLyBAZGV2IEZpbmFsaXplcyB0aGUgdG9rZW4gc2FsZSBldmVudDogbWFrZSBmdXR1cmUgZGV2ZWxvcG1lbnQgcG9vbCBncmFudCAobG9ja3VwKSBhbmQgbWFrZSB0b2tlbiB0cmFuc2ZhcmFibGUuCiAgICBmdW5jdGlvbiBmaW5hbGl6ZSgpIGV4dGVybmFsIG9ubHlBZnRlclNhbGUgb25seU93bmVyIGlzSW5pdGlhbGl6ZWQgewogICAgICAgIGlmIChjbG4uaXNUcmFuc2ZlcmFibGUoKSkgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CgogICAgICAgIC8vIEFkZCB1bnNvbGQgdG9rZW4gdG8gdGhlIGZ1dHVyZSBkZXZlbG9wbWVudCBwb29sIGdyYW50IChsb2NrdXApLgogICAgICAgIHVpbnQyNTYgdG9rZW5zTGVmdEluU2FsZSA9IE1BWF9UT0tFTlNfU09MRC5zdWIodG9rZW5zU29sZCk7CiAgICAgICAgdWludDI1NiBmdXR1cmVEZXZlbG9wbWVudFBvb2wgPSBGVVRVUkVfREVWRUxPUE1FTlRfUE9PTC5hZGQodG9rZW5zTGVmdEluU2FsZSk7CiAgICAgICAgLy8gRnV0dXJlIERldmVsb3BtZW50IFBvb2wgaXMgbG9ja2VkIGZvciAzIHllYXJzLgogICAgICAgIGdyYW50KGZ1dHVyZURldmVsb3BtZW50UG9vbEFkZHJlc3MsIGZ1dHVyZURldmVsb3BtZW50UG9vbCwgc3RhcnRUaW1lLCBzdGFydFRpbWUuYWRkKDMgeWVhcnMpLAogICAgICAgICAgICBzdGFydFRpbWUuYWRkKDMgeWVhcnMpLCAxIGRheXMsIGZhbHNlKTsKCiAgICAgICAgLy8gTWFrZSB0b2tlbnMgVHJhbnNmZXJhYmxlLCBlbmQgdGhlIHNhbGUhLgogICAgICAgIGNsbi5tYWtlVG9rZW5zVHJhbnNmZXJhYmxlKCk7CiAgICB9CgogICAgZnVuY3Rpb24gZ3JhbnQoYWRkcmVzcyBfZ3JhbnRlZSwgdWludDI1NiBfYW1vdW50LCB1aW50MjU2IF9zdGFydCwgdWludDI1NiBfY2xpZmYsIHVpbnQyNTYgX2VuZCwKICAgICAgICB1aW50MjU2IF9pbnN0YWxsbWVudExlbmd0aCwgYm9vbCBfcmV2b2thYmxlKSBwcml2YXRlIHsKICAgICAgICAvLyBieXRlczQgZ3JhbnRTaWcgPSBieXRlczQoa2VjY2FrMjU2KCJncmFudChhZGRyZXNzLHVpbnQyNTYsdWludDI1Nix1aW50MjU2LHVpbnQyNTYsYm9vbCkiKSk7CiAgICAgICAgYnl0ZXM0IGdyYW50U2lnID0gMHg1ZWU3ZTk2ZDsKICAgICAgICAvLyA2IGFyZ3VtZW50cyBvZiBzaXplIDMyCiAgICAgICAgdWludDI1NiBhcmdzU2l6ZSA9IDYgKiAzMjsKICAgICAgICAvLyBzaWcgKyBhcmd1bWVudHMgc2l6ZQogICAgICAgIHVpbnQyNTYgZGF0YVNpemUgPSA0ICsgYXJnc1NpemU7CgogICAgICAgIGJ5dGVzIG1lbW9yeSBtX2RhdGEgPSBuZXcgYnl0ZXMoZGF0YVNpemUpOwoKICAgICAgICBhc3NlbWJseSB7CiAgICAgICAgICAgIC8vIEFkZCB0aGUgc2lnbmF0dXJlIGZpcnN0IHRvIG1lbW9yeQogICAgICAgICAgICBtc3RvcmUoYWRkKG1fZGF0YSwgMHgyMCksIGdyYW50U2lnKQogICAgICAgICAgICAvLyBBZGQgdGhlIHBhcmFtZXRlcnMKICAgICAgICAgICAgbXN0b3JlKGFkZChtX2RhdGEsIDB4MjQpLCBfZ3JhbnRlZSkKICAgICAgICAgICAgbXN0b3JlKGFkZChtX2RhdGEsIDB4NDQpLCBfc3RhcnQpCiAgICAgICAgICAgIG1zdG9yZShhZGQobV9kYXRhLCAweDY0KSwgX2NsaWZmKQogICAgICAgICAgICBtc3RvcmUoYWRkKG1fZGF0YSwgMHg4NCksIF9lbmQpCiAgICAgICAgICAgIG1zdG9yZShhZGQobV9kYXRhLCAweGE0KSwgX2luc3RhbGxtZW50TGVuZ3RoKQogICAgICAgICAgICBtc3RvcmUoYWRkKG1fZGF0YSwgMHhjNCksIF9yZXZva2FibGUpCiAgICAgICAgfQoKICAgICAgICByZXF1aXJlKHRyYW5zZmVyVG9rZW5zKHRydXN0ZWUsIF9hbW91bnQsIG1fZGF0YSkpOwogICAgfQoKICAgIC8vLyBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIHRoZSBzYWxlIGNvbnRyYWN0IHRvIGEgcmVjaXBpZW50LgogICAgLy8vIEBwYXJhbSBfcmVjaXBpZW50IGFkZHJlc3MgVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudC4KICAgIC8vLyBAcGFyYW0gX3Rva2VucyB1aW50MjU2IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIHRyYW5zZmVyLgogICAgZnVuY3Rpb24gdHJhbnNmZXJUb2tlbnMoYWRkcmVzcyBfcmVjaXBpZW50LCB1aW50MjU2IF90b2tlbnMpIHByaXZhdGUgcmV0dXJucyAoYm9vbCBhbnMpIHsKICAgICAgICBhbnMgPSBjbG4udHJhbnNmZXIoX3JlY2lwaWVudCwgX3Rva2Vucyk7CiAgICAgICAgaWYgKGFucykgewogICAgICAgICAgICBUb2tlbnNJc3N1ZWQoX3JlY2lwaWVudCwgX3Rva2Vucyk7CiAgICAgICAgfQogICAgfQoKICAgIC8vLyBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIHRoZSBzYWxlIGNvbnRyYWN0IHRvIGEgcmVjaXBpZW50LgogICAgLy8vIEBwYXJhbSBfcmVjaXBpZW50IGFkZHJlc3MgVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudC4KICAgIC8vLyBAcGFyYW0gX3Rva2VucyB1aW50MjU2IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIHRyYW5zZmVyLgogICAgLy8vIEBwYXJhbSBfZGF0YSBieXRlcyBkYXRhIHRvIHNlbmQgdG8gcmVjZWl2ZXIgaWYgaXQgaXMgYSBjb250cmFjdC4KICAgIGZ1bmN0aW9uIHRyYW5zZmVyVG9rZW5zKGFkZHJlc3MgX3JlY2lwaWVudCwgdWludDI1NiBfdG9rZW5zLCBieXRlcyBfZGF0YSkgcHJpdmF0ZSByZXR1cm5zIChib29sIGFucykgewogICAgICAgIC8vIFJlcXVlc3QgQ29sdSBMb2NhbCBOZXR3b3JrIGNvbnRyYWN0IHRvIHRyYW5zZmVyIHRoZSByZXF1ZXN0ZWQgdG9rZW5zIGZvciB0aGUgYnV5ZXIuCiAgICAgICAgYW5zID0gY2xuLnRyYW5zZmVyQW5kQ2FsbChfcmVjaXBpZW50LCBfdG9rZW5zLCBfZGF0YSk7CiAgICAgICAgaWYgKGFucykgewogICAgICAgICAgICBUb2tlbnNJc3N1ZWQoX3JlY2lwaWVudCwgX3Rva2Vucyk7CiAgICAgICAgfQogICAgfQoKICAgIC8vLyBAZGV2IFJlcXVlc3RzIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIENvbHUgTG9jYWwgTmV0d29yayBjb250cmFjdCB0byBhIG5ldyBvd25lci4KICAgIC8vLyBAcGFyYW0gX25ld093bmVyQ2FuZGlkYXRlIGFkZHJlc3MgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAgLy8vCiAgICAvLy8gTk9URToKICAgIC8vLyAgIDEuIFRoZSBuZXcgb3duZXIgd2lsbCBuZWVkIHRvIGNhbGwgQ29sdSBMb2NhbCBOZXR3b3JrIGNvbnRyYWN0J3MgYWNjZXB0T3duZXJzaGlwIGRpcmVjdGx5IGluIG9yZGVyIHRvIGFjY2VwdCB0aGUgb3duZXJzaGlwLgogICAgLy8vICAgMi4gQ2FsbGluZyB0aGlzIG1ldGhvZCBkdXJpbmcgdGhlIHRva2VuIHNhbGUgd2lsbCBwcmV2ZW50IHRoZSB0b2tlbiBzYWxlIHRvIGNvbnRpbnVlLCBzaW5jZSBvbmx5IHRoZSBvd25lciBvZgogICAgLy8vICAgICAgdGhlIENvbHUgTG9jYWwgTmV0d29yayBjb250cmFjdCBjYW4gdHJhbnNmZXIgdG9rZW5zIGR1cmluZyB0aGUgc2FsZS4KICAgIGZ1bmN0aW9uIHJlcXVlc3RDb2x1TG9jYWxOZXR3b3JrT3duZXJzaGlwVHJhbnNmZXIoYWRkcmVzcyBfbmV3T3duZXJDYW5kaWRhdGUpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgY2xuLnJlcXVlc3RPd25lcnNoaXBUcmFuc2ZlcihfbmV3T3duZXJDYW5kaWRhdGUpOwogICAgfQoKICAgIC8vLyBAZGV2IEFjY2VwdHMgbmV3IG93bmVyc2hpcCBvbiBiZWhhbGYgb2YgdGhlIENvbHUgTG9jYWwgTmV0d29yayBjb250cmFjdC4KICAgIC8vIFRoaXMgY2FuIGJlIHVzZWQgYnkgdGhlIHNhbGUgY29udHJhY3QgaXRzZWxmIHRvIGNsYWltIGJhY2sgb3duZXJzaGlwIG9mIHRoZSBDb2x1IExvY2FsIE5ldHdvcmsgY29udHJhY3QuCiAgICBmdW5jdGlvbiBhY2NlcHRDb2x1TG9jYWxOZXR3b3JrT3duZXJzaGlwKCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICBjbG4uYWNjZXB0T3duZXJzaGlwKCk7CiAgICB9CgogICAgLy8vIEBkZXYgUmVxdWVzdHMgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgVmVzdGluZ1RydXN0ZWUgY29udHJhY3QgdG8gYSBuZXcgb3duZXIuCiAgICAvLy8gQHBhcmFtIF9uZXdPd25lckNhbmRpZGF0ZSBhZGRyZXNzIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgIC8vLwogICAgLy8vIE5PVEU6CiAgICAvLy8gICAxLiBUaGUgbmV3IG93bmVyIHdpbGwgbmVlZCB0byBjYWxsIHRydXN0ZWUgY29udHJhY3QncyBhY2NlcHRPd25lcnNoaXAgZGlyZWN0bHkgaW4gb3JkZXIgdG8gYWNjZXB0IHRoZSBvd25lcnNoaXAuCiAgICAvLy8gICAyLiBDYWxsaW5nIHRoaXMgbWV0aG9kIGR1cmluZyB0aGUgdG9rZW4gc2FsZSB3aWxsIHByZXZlbnQgdGhlIHRva2VuIHNhbGUgZnJvbSBhbG9jYXRpb24gcHJlc2FsZSBncnVudHMgYWRkIGZpbmFsaXplLCBzaW5jZSBvbmx5IHRoZSBvd25lciBvZgogICAgLy8vICAgICAgdGhlIHRydXN0ZWUgY29udHJhY3QgY2FuIGNyZWF0ZSBncnVudHMgbmVlZGVkIGluIHRoZSBwcmVzYWxlQWxvY2F0aW9uIGFkZCBmaW5hbGl6ZSBtZXRob2RzLgogICAgZnVuY3Rpb24gcmVxdWVzdFZlc3RpbmdUcnVzdGVlT3duZXJzaGlwVHJhbnNmZXIoYWRkcmVzcyBfbmV3T3duZXJDYW5kaWRhdGUpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgdHJ1c3RlZS5yZXF1ZXN0T3duZXJzaGlwVHJhbnNmZXIoX25ld093bmVyQ2FuZGlkYXRlKTsKICAgIH0KCiAgICAvLy8gQGRldiBBY2NlcHRzIG5ldyBvd25lcnNoaXAgb24gYmVoYWxmIG9mIHRoZSBWZXN0aW5nVHJ1c3RlZSBjb250cmFjdC4KICAgIC8vLyBUaGlzIGNhbiBiZSB1c2VkIGJ5IHRoZSB0b2tlbiBzYWxlIGNvbnRyYWN0IGl0c2VsZiB0byBjbGFpbSBiYWNrIG93bmVyc2hpcCBvZiB0aGUgVmVzdGluZ1RydXN0ZWUgY29udHJhY3QuCiAgICBmdW5jdGlvbiBhY2NlcHRWZXN0aW5nVHJ1c3RlZU93bmVyc2hpcCgpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgdHJ1c3RlZS5hY2NlcHRPd25lcnNoaXAoKTsKICAgIH0KfQ=='.
	

]
