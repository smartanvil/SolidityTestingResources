Class {
	#name : #SRTdbdf683738e743bc14b1bc65c4fd5e0baf54417d,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTdbdf683738e743bc14b1bc65c4fd5e0baf54417d >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovLyBGaWxlOiB6ZXBwZWxpbi1zb2xpZGl0eS9jb250cmFjdHMvb3duZXJzaGlwL093bmFibGUuc29sCgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL2xpZmVjeWNsZS9QYXVzYWJsZS5zb2wKCi8qKgogKiBAdGl0bGUgUGF1c2FibGUKICogQGRldiBCYXNlIGNvbnRyYWN0IHdoaWNoIGFsbG93cyBjaGlsZHJlbiB0byBpbXBsZW1lbnQgYW4gZW1lcmdlbmN5IHN0b3AgbWVjaGFuaXNtLgogKi8KY29udHJhY3QgUGF1c2FibGUgaXMgT3duYWJsZSB7CiAgZXZlbnQgUGF1c2UoKTsKICBldmVudCBVbnBhdXNlKCk7CgogIGJvb2wgcHVibGljIHBhdXNlZCA9IGZhbHNlOwoKCiAgLyoqCiAgICogQGRldiBNb2RpZmllciB0byBtYWtlIGEgZnVuY3Rpb24gY2FsbGFibGUgb25seSB3aGVuIHRoZSBjb250cmFjdCBpcyBub3QgcGF1c2VkLgogICAqLwogIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICByZXF1aXJlKCFwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgcGF1c2VkLgogICAqLwogIG1vZGlmaWVyIHdoZW5QYXVzZWQoKSB7CiAgICByZXF1aXJlKHBhdXNlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHBhdXNlLCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlCiAgICovCiAgZnVuY3Rpb24gcGF1c2UoKSBvbmx5T3duZXIgd2hlbk5vdFBhdXNlZCBwdWJsaWMgewogICAgcGF1c2VkID0gdHJ1ZTsKICAgIFBhdXNlKCk7CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gdW5wYXVzZSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgKi8KICBmdW5jdGlvbiB1bnBhdXNlKCkgb25seU93bmVyIHdoZW5QYXVzZWQgcHVibGljIHsKICAgIHBhdXNlZCA9IGZhbHNlOwogICAgVW5wYXVzZSgpOwogIH0KfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL21hdGgvU2FmZU1hdGguc29sCgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKLy8gRmlsZTogemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL3Rva2VuL0VSQzIwL0VSQzIwQmFzaWMuc29sCgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCi8vIEZpbGU6IHplcHBlbGluLXNvbGlkaXR5L2NvbnRyYWN0cy90b2tlbi9FUkMyMC9CYXNpY1Rva2VuLnNvbAoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICB1aW50MjU2IHRvdGFsU3VwcGx5XzsKCiAgLyoqCiAgKiBAZGV2IHRvdGFsIG51bWJlciBvZiB0b2tlbnMgaW4gZXhpc3RlbmNlCiAgKi8KICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiB0b3RhbFN1cHBseV87CiAgfQoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cgp9CgovLyBGaWxlOiB6ZXBwZWxpbi1zb2xpZGl0eS9jb250cmFjdHMvdG9rZW4vRVJDMjAvRVJDMjAuc29sCgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgovLyBGaWxlOiB6ZXBwZWxpbi1zb2xpZGl0eS9jb250cmFjdHMvdG9rZW4vRVJDMjAvU3RhbmRhcmRUb2tlbi5zb2wKCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CgoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBAZGV2IEluY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX2FkZGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gaW5jcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IERlY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBkZWNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3N1YnRyYWN0ZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBkZWNyZWFzZSB0aGUgYWxsb3dhbmNlIGJ5LgogICAqLwogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9CgovLyBGaWxlOiBjb250cmFjdHMvQ3VycmVudFRva2VuLnNvbAoKY29udHJhY3QgQ3VycmVudFRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIFBhdXNhYmxlIHsKICAgIHN0cmluZyBjb25zdGFudCBwdWJsaWMgbmFtZSA9ICJDdXJyZW50Q29pbiI7CiAgICBzdHJpbmcgY29uc3RhbnQgcHVibGljIHN5bWJvbCA9ICJDVVIiOwogICAgdWludDggY29uc3RhbnQgcHVibGljIGRlY2ltYWxzID0gMTg7CgogICAgdWludDI1NiBjb25zdGFudCBwdWJsaWMgSU5JVElBTF9UT1RBTF9TVVBQTFkgPSAxZTExICogKHVpbnQyNTYoMTApICoqIGRlY2ltYWxzKTsKCiAgICBhZGRyZXNzIHByaXZhdGUgYWRkcmVzc0ljbzsKCiAgICBtb2RpZmllciBvbmx5SWNvKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBhZGRyZXNzSWNvKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IENyZWF0ZSBDdXJyZW50VG9rZW4gY29udHJhY3QgYW5kIHNldCBwYXVzZQogICAgKiBAcGFyYW0gX2ljbyBUaGUgYWRkcmVzcyBvZiBJQ08gY29udHJhY3QuCiAgICAqLwogICAgZnVuY3Rpb24gQ3VycmVudFRva2VuIChhZGRyZXNzIF9pY28pIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfaWNvICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICBhZGRyZXNzSWNvID0gX2ljbzsKCiAgICAgICAgdG90YWxTdXBwbHlfID0gdG90YWxTdXBwbHlfLmFkZChJTklUSUFMX1RPVEFMX1NVUFBMWSk7CiAgICAgICAgYmFsYW5jZXNbX2ljb10gPSBiYWxhbmNlc1tfaWNvXS5hZGQoSU5JVElBTF9UT1RBTF9TVVBQTFkpOwogICAgICAgIFRyYW5zZmVyKGFkZHJlc3MoMCksIF9pY28sIElOSVRJQUxfVE9UQUxfU1VQUExZKTsKCiAgICAgICAgcGF1c2UoKTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBUcmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcyB3aXRoIHBhdXNlIGZlYXR1cmUgZm9yIG93bmVyLgogICAgKiBAZGV2IE9ubHkgYXBwbGllcyB3aGVuIHRoZSB0cmFuc2ZlciBpcyBhbGxvd2VkIGJ5IHRoZSBvd25lci4KICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgd2hlbk5vdFBhdXNlZCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyIHdpdGggcGF1c2UgZmVhdHVyZSBmb3Igb3duZXIuCiAgICAqIEBkZXYgT25seSBhcHBsaWVzIHdoZW4gdGhlIHRyYW5zZmVyIGlzIGFsbG93ZWQgYnkgdGhlIG93bmVyLgogICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSB3aGVuTm90UGF1c2VkIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gSUNPIGFkZHJlc3MgdG8gYW5vdGhlciBhZGRyZXNzLgogICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tSWNvKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgb25seUljbyBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBCdXJuIHJlbWFpbmluZyB0b2tlbnMgZnJvbSB0aGUgSUNPIGJhbGFuY2UuCiAgICAqLwogICAgZnVuY3Rpb24gYnVybkZyb21JY28oKSBvbmx5SWNvIHB1YmxpYyB7CiAgICAgICAgdWludDI1NiByZW1haW5pbmdUb2tlbnMgPSBiYWxhbmNlT2YoYWRkcmVzc0ljbyk7CgogICAgICAgIGJhbGFuY2VzW2FkZHJlc3NJY29dID0gYmFsYW5jZXNbYWRkcmVzc0ljb10uc3ViKHJlbWFpbmluZ1Rva2Vucyk7CiAgICAgICAgdG90YWxTdXBwbHlfID0gdG90YWxTdXBwbHlfLnN1YihyZW1haW5pbmdUb2tlbnMpOwogICAgICAgIFRyYW5zZmVyKGFkZHJlc3NJY28sIGFkZHJlc3MoMCksIHJlbWFpbmluZ1Rva2Vucyk7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgQnVybiBhbGwgdG9rZW5zIGZvcm0gYmFsYW5jZSBvZiB0b2tlbiBob2xkZXIgZHVyaW5nIHJlZnVuZCBwcm9jZXNzLgogICAgKiBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3Mgb2YgdG9rZW4gaG9sZGVyIHdob3NlIHRva2VucyB0byBiZSBidXJuZWQuCiAgICAqLwogICAgZnVuY3Rpb24gYnVybkZyb21BZGRyZXNzKGFkZHJlc3MgX2Zyb20pIG9ubHlJY28gcHVibGljIHsKICAgICAgICB1aW50MjU2IGFtb3VudCA9IGJhbGFuY2VzW19mcm9tXTsKCiAgICAgICAgYmFsYW5jZXNbX2Zyb21dID0gMDsKICAgICAgICB0b3RhbFN1cHBseV8gPSB0b3RhbFN1cHBseV8uc3ViKGFtb3VudCk7CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIGFkZHJlc3MoMCksIGFtb3VudCk7CiAgICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9XaGl0ZWxpc3Quc29sCgovKioKICogQHRpdGxlIFdoaXRlbGlzdCBjb250cmFjdAogKiBAZGV2IFdoaXRlbGlzdCBmb3Igd2FsbGV0cy4KKi8KY29udHJhY3QgV2hpdGVsaXN0IGlzIE93bmFibGUgewogICAgbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIHdoaXRlbGlzdDsKCiAgICB1aW50MjU2IHB1YmxpYyB3aGl0ZWxpc3RMZW5ndGggPSAwOwoKICAgIC8qKgogICAgKiBAZGV2IEFkZCB3YWxsZXQgdG8gd2hpdGVsaXN0LgogICAgKiBAZGV2IEFjY2VwdCByZXF1ZXN0IGZyb20gdGhlIG93bmVyIG9ubHkuCiAgICAqIEBwYXJhbSBfd2FsbGV0IFRoZSBhZGRyZXNzIG9mIHdhbGxldCB0byBhZGQuCiAgICAqLyAgCiAgICBmdW5jdGlvbiBhZGRXYWxsZXQoYWRkcmVzcyBfd2FsbGV0KSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKF93YWxsZXQgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZSghaXNXaGl0ZWxpc3RlZChfd2FsbGV0KSk7CiAgICAgICAgd2hpdGVsaXN0W193YWxsZXRdID0gdHJ1ZTsKICAgICAgICB3aGl0ZWxpc3RMZW5ndGgrKzsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBSZW1vdmUgd2FsbGV0IGZyb20gd2hpdGVsaXN0LgogICAgKiBAZGV2IEFjY2VwdCByZXF1ZXN0IGZyb20gdGhlIG93bmVyIG9ubHkuCiAgICAqIEBwYXJhbSBfd2FsbGV0IFRoZSBhZGRyZXNzIG9mIHdoaXRlbGlzdGVkIHdhbGxldCB0byByZW1vdmUuCiAgICAqLyAgCiAgICBmdW5jdGlvbiByZW1vdmVXYWxsZXQoYWRkcmVzcyBfd2FsbGV0KSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKF93YWxsZXQgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShpc1doaXRlbGlzdGVkKF93YWxsZXQpKTsKICAgICAgICB3aGl0ZWxpc3RbX3dhbGxldF0gPSBmYWxzZTsKICAgICAgICB3aGl0ZWxpc3RMZW5ndGgtLTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBDaGVjayB0aGUgc3BlY2lmaWVkIHdhbGxldCB3aGV0aGVyIGl0IGlzIGluIHRoZSB3aGl0ZWxpc3QuCiAgICAqIEBwYXJhbSBfd2FsbGV0IFRoZSBhZGRyZXNzIG9mIHdhbGxldCB0byBjaGVjay4KICAgICovIAogICAgZnVuY3Rpb24gaXNXaGl0ZWxpc3RlZChhZGRyZXNzIF93YWxsZXQpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHdoaXRlbGlzdFtfd2FsbGV0XTsKICAgIH0KCn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9XaGl0ZWxpc3RhYmxlLnNvbAoKY29udHJhY3QgV2hpdGVsaXN0YWJsZSB7CiAgICBXaGl0ZWxpc3QgcHVibGljIHdoaXRlbGlzdDsKCiAgICBtb2RpZmllciB3aGVuV2hpdGVsaXN0ZWQoYWRkcmVzcyBfd2FsbGV0KSB7CiAgICAgICAgcmVxdWlyZSh3aGl0ZWxpc3QuaXNXaGl0ZWxpc3RlZChfd2FsbGV0KSk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBDb25zdHJ1Y3RvciBmb3IgV2hpdGVsaXN0YWJsZSBjb250cmFjdC4KICAgICovCiAgICBmdW5jdGlvbiBXaGl0ZWxpc3RhYmxlKCkgcHVibGljIHsKICAgICAgICB3aGl0ZWxpc3QgPSBuZXcgV2hpdGVsaXN0KCk7CiAgICB9Cn0KCi8vIEZpbGU6IGNvbnRyYWN0cy9DdXJyZW50Q3Jvd2RzYWxlLnNvbAoKY29udHJhY3QgQ3VycmVudENyb3dkc2FsZSBpcyBQYXVzYWJsZSwgV2hpdGVsaXN0YWJsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICB1aW50MjU2IGNvbnN0YW50IHByaXZhdGUgREVDSU1BTFMgPSAxODsKICAgIHVpbnQyNTYgY29uc3RhbnQgcHVibGljIFJFU0VSVkVEX1RPS0VOU19GT1VOREVSUyA9IDQwZTkgKiAoMTAgKiogREVDSU1BTFMpOwogICAgdWludDI1NiBjb25zdGFudCBwdWJsaWMgUkVTRVJWRURfVE9LRU5TX09QRVJBVElPTkFMX0VYUEVOU0VTID0gMTBlOSAqICgxMCAqKiBERUNJTUFMUyk7CiAgICB1aW50MjU2IGNvbnN0YW50IHB1YmxpYyBIQVJEQ0FQX1RPS0VOU19QUkVfSUNPID0gMTAwZTYgKiAoMTAgKiogREVDSU1BTFMpOwogICAgdWludDI1NiBjb25zdGFudCBwdWJsaWMgSEFSRENBUF9UT0tFTlNfSUNPID0gNDk5ZTggKiAoMTAgKiogREVDSU1BTFMpOwoKICAgIHVpbnQyNTYgcHVibGljIHN0YXJ0VGltZVByZUljbyA9IDA7CiAgICB1aW50MjU2IHB1YmxpYyBlbmRUaW1lUHJlSWNvID0gMDsKCiAgICB1aW50MjU2IHB1YmxpYyBzdGFydFRpbWVJY28gPSAwOwogICAgdWludDI1NiBwdWJsaWMgZW5kVGltZUljbyA9IDA7CgogICAgdWludDI1NiBwdWJsaWMgZXhjaGFuZ2VSYXRlUHJlSWNvID0gMDsKCiAgICBib29sIHB1YmxpYyBpc1Rva2VuUmF0ZUNhbGN1bGF0ZWQgPSBmYWxzZTsKCiAgICB1aW50MjU2IHB1YmxpYyBleGNoYW5nZVJhdGVJY28gPSAwOwoKICAgIHVpbnQyNTYgcHVibGljIG1pbmNhcCA9IDA7CiAgICB1aW50MjU2IHB1YmxpYyBtYXhjYXAgPSAwOwoKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBwcml2YXRlIGludmVzdG1lbnRzOyAgICAKCiAgICB1aW50MjU2IHB1YmxpYyB0b2tlbnNTb2xkSWNvID0gMDsKICAgIHVpbnQyNTYgcHVibGljIHRva2Vuc1JlbWFpbmluZ0ljbyA9IEhBUkRDQVBfVE9LRU5TX0lDTzsKICAgIHVpbnQyNTYgcHVibGljIHRva2Vuc1NvbGRUb3RhbCA9IDA7CgogICAgdWludDI1NiBwdWJsaWMgd2VpUmFpc2VkUHJlSWNvID0gMDsKICAgIHVpbnQyNTYgcHVibGljIHdlaVJhaXNlZEljbyA9IDA7CiAgICB1aW50MjU2IHB1YmxpYyB3ZWlSYWlzZWRUb3RhbCA9IDA7CgogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHByaXZhdGUgaW52ZXN0bWVudHNQcmVJY287CiAgICBhZGRyZXNzW10gcHJpdmF0ZSBpbnZlc3RvcnNQcmVJY287CgogICAgYWRkcmVzcyBwcml2YXRlIHdpdGhkcmF3YWxXYWxsZXQ7CgogICAgYm9vbCBwdWJsaWMgaXNUb2tlbnNQcmVJY29EaXN0cmlidXRlZCA9IGZhbHNlOwogICAgdWludDI1NiBwdWJsaWMgZGlzdHJpYnV0aW9uUHJlSWNvQ291bnQgPSAwOwoKICAgIEN1cnJlbnRUb2tlbiBwdWJsaWMgdG9rZW4gPSBuZXcgQ3VycmVudFRva2VuKHRoaXMpOwoKICAgIG1vZGlmaWVyIGJlZm9yZVJlYWNoaW5nSGFyZENhcCgpIHsKICAgICAgICByZXF1aXJlKHRva2Vuc1JlbWFpbmluZ0ljbyA+IDAgJiYgd2VpUmFpc2VkVG90YWwgPCBtYXhjYXApOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgd2hlblByZUljb1NhbGVIYXNFbmRlZCgpIHsKICAgICAgICByZXF1aXJlKG5vdyA+IGVuZFRpbWVQcmVJY28pOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgd2hlbkljb1NhbGVIYXNFbmRlZCgpIHsKICAgICAgICByZXF1aXJlKGVuZFRpbWVJY28gPiAwICYmIG5vdyA+IGVuZFRpbWVJY28pOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgQ29uc3RydWN0b3IgZm9yIEN1cnJlbnRDcm93ZHNhbGUgY29udHJhY3QuCiAgICAqIEBkZXYgU2V0IHRoZSBvd25lciB3aG8gY2FuIG1hbmFnZSB3aGl0ZWxpc3QgYW5kIHRva2VuLgogICAgKiBAcGFyYW0gX21pbmNhcCBUaGUgbWluY2FwIHZhbHVlLgogICAgKiBAcGFyYW0gX3N0YXJ0VGltZVByZUljbyBUaGUgcHJlLUlDTyBzdGFydCB0aW1lLgogICAgKiBAcGFyYW0gX2VuZFRpbWVQcmVJY28gVGhlIHByZS1JQ08gZW5kIHRpbWUuCiAgICAqIEBwYXJhbSBfZm91bmRlcnNXYWxsZXQgVGhlIGFkZHJlc3MgdG8gd2hpY2ggcmVzZXJ2ZWQgdG9rZW5zIGZvciBmb3VuZGVycyB3aWxsIGJlIHRyYW5zZmVycmVkLgogICAgKiBAcGFyYW0gX29wZXJhdGlvbmFsRXhwZW5zZXNXYWxsZXQgVGhlIGFkZHJlc3MgdG8gd2hpY2ggcmVzZXJ2ZWQgdG9rZW5zIGZvciBvcGVyYXRpb25hbCBleHBlbnNlcyB3aWxsIGJlIHRyYW5zZmVycmVkLgogICAgKiBAcGFyYW0gX3dpdGhkcmF3YWxXYWxsZXQgVGhlIGFkZHJlc3MgdG8gd2hpY2ggcmFpc2VkIGZ1bmRzIHdpbGwgYmUgd2l0aGRyYXduLgogICAgKi8KICAgIGZ1bmN0aW9uIEN1cnJlbnRDcm93ZHNhbGUoCiAgICAgICAgdWludDI1NiBfbWluY2FwLAogICAgICAgIHVpbnQyNTYgX21heGNhcCwKICAgICAgICB1aW50MjU2IF9zdGFydFRpbWVQcmVJY28sCiAgICAgICAgdWludDI1NiBfZW5kVGltZVByZUljbywKICAgICAgICBhZGRyZXNzIF9mb3VuZGVyc1dhbGxldCwKICAgICAgICBhZGRyZXNzIF9vcGVyYXRpb25hbEV4cGVuc2VzV2FsbGV0LAogICAgICAgIGFkZHJlc3MgX3dpdGhkcmF3YWxXYWxsZXQKICAgICkgV2hpdGVsaXN0YWJsZSgpIHB1YmxpYwogICAgewogICAgICAgIHJlcXVpcmUoX2ZvdW5kZXJzV2FsbGV0ICE9IGFkZHJlc3MoMCkgJiYgX29wZXJhdGlvbmFsRXhwZW5zZXNXYWxsZXQgIT0gYWRkcmVzcygwKSAmJiBfd2l0aGRyYXdhbFdhbGxldCAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF9zdGFydFRpbWVQcmVJY28gPj0gbm93ICYmIF9lbmRUaW1lUHJlSWNvID4gX3N0YXJ0VGltZVByZUljbyk7CiAgICAgICAgcmVxdWlyZShfbWluY2FwID4gMCAmJiBfbWF4Y2FwID4gX21pbmNhcCk7CgogICAgICAgIHN0YXJ0VGltZVByZUljbyA9IF9zdGFydFRpbWVQcmVJY287CiAgICAgICAgZW5kVGltZVByZUljbyA9IF9lbmRUaW1lUHJlSWNvOwoKICAgICAgICB3aXRoZHJhd2FsV2FsbGV0ID0gX3dpdGhkcmF3YWxXYWxsZXQ7CgogICAgICAgIG1pbmNhcCA9IF9taW5jYXA7CiAgICAgICAgbWF4Y2FwID0gX21heGNhcDsKCiAgICAgICAgd2hpdGVsaXN0LnRyYW5zZmVyT3duZXJzaGlwKG1zZy5zZW5kZXIpOwoKICAgICAgICB0b2tlbi50cmFuc2ZlckZyb21JY28oX2ZvdW5kZXJzV2FsbGV0LCBSRVNFUlZFRF9UT0tFTlNfRk9VTkRFUlMpOwogICAgICAgIHRva2VuLnRyYW5zZmVyRnJvbUljbyhfb3BlcmF0aW9uYWxFeHBlbnNlc1dhbGxldCwgUkVTRVJWRURfVE9LRU5TX09QRVJBVElPTkFMX0VYUEVOU0VTKTsKICAgICAgICB0b2tlbi50cmFuc2Zlck93bmVyc2hpcChtc2cuc2VuZGVyKTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBGYWxsYmFjayBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBidXkgdG9rZW5zLgogICAgKi8KICAgIGZ1bmN0aW9uKCkgcHVibGljIHBheWFibGUgewogICAgICAgIGlmIChpc1ByZUljbygpKSB7CiAgICAgICAgICAgIHNlbGxUb2tlbnNQcmVJY28oKTsKICAgICAgICB9IGVsc2UgaWYgKGlzSWNvKCkpIHsKICAgICAgICAgICAgc2VsbFRva2Vuc0ljbygpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICogQGRldiBDaGVjayB3aGV0aGVyIHRoZSBwcmUtSUNPIGlzIGFjdGl2ZSBhdCB0aGUgbW9tZW50LgogICAgKi8KICAgIGZ1bmN0aW9uIGlzUHJlSWNvKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICBib29sIHdpdGhpblByZUljbyA9IG5vdyA+PSBzdGFydFRpbWVQcmVJY28gJiYgbm93IDw9IGVuZFRpbWVQcmVJY287CiAgICAgICAgcmV0dXJuIHdpdGhpblByZUljbzsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBDaGVjayB3aGV0aGVyIHRoZSBJQ08gaXMgYWN0aXZlIGF0IHRoZSBtb21lbnQuCiAgICAqLwogICAgZnVuY3Rpb24gaXNJY28oKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGJvb2wgd2l0aGluSWNvID0gbm93ID49IHN0YXJ0VGltZUljbyAmJiBub3cgPD0gZW5kVGltZUljbzsKICAgICAgICByZXR1cm4gd2l0aGluSWNvOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IE1hbnVhbCByZWZ1bmQgaWYgbWluY2FwIGhhcyBub3QgYmVlbiByZWFjaGVkLgogICAgKiBAZGV2IE9ubHkgYXBwbGllcyB3aGVuIHRoZSBJQ08gd2FzIGVuZGVkLiAKICAgICovCiAgICBmdW5jdGlvbiBtYW51YWxSZWZ1bmQoKSB3aGVuSWNvU2FsZUhhc0VuZGVkIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZSh3ZWlSYWlzZWRUb3RhbCA8IG1pbmNhcCk7CgogICAgICAgIHVpbnQyNTYgd2VpQW1vdW50VG90YWwgPSBpbnZlc3RtZW50c1ttc2cuc2VuZGVyXTsKICAgICAgICByZXF1aXJlKHdlaUFtb3VudFRvdGFsID4gMCk7CgogICAgICAgIGludmVzdG1lbnRzW21zZy5zZW5kZXJdID0gMDsKCiAgICAgICAgdWludDI1NiB3ZWlBbW91bnRQcmVJY28gPSBpbnZlc3RtZW50c1ByZUljb1ttc2cuc2VuZGVyXTsKICAgICAgICB1aW50MjU2IHdlaUFtb3VudEljbyA9IHdlaUFtb3VudFRvdGFsOwoKICAgICAgICBpZiAod2VpQW1vdW50UHJlSWNvID4gMCkgewogICAgICAgICAgICBpbnZlc3RtZW50c1ByZUljb1ttc2cuc2VuZGVyXSA9IDA7CiAgICAgICAgICAgIHdlaVJhaXNlZFByZUljbyA9IHdlaVJhaXNlZFByZUljby5zdWIod2VpQW1vdW50UHJlSWNvKTsKICAgICAgICAgICAgd2VpQW1vdW50SWNvID0gd2VpQW1vdW50SWNvLnN1Yih3ZWlBbW91bnRQcmVJY28pOwogICAgICAgIH0KCiAgICAgICAgaWYgKHdlaUFtb3VudEljbyA+IDApIHsKICAgICAgICAgICAgd2VpUmFpc2VkSWNvID0gd2VpUmFpc2VkSWNvLnN1Yih3ZWlBbW91bnRJY28pOwogICAgICAgICAgICB1aW50MjU2IHRva2Vuc0ljbyA9IHdlaUFtb3VudEljby5tdWwoZXhjaGFuZ2VSYXRlSWNvKTsKICAgICAgICAgICAgdG9rZW5zU29sZEljbyA9IHRva2Vuc1NvbGRJY28uc3ViKHRva2Vuc0ljbyk7CiAgICAgICAgfQoKICAgICAgICB3ZWlSYWlzZWRUb3RhbCA9IHdlaVJhaXNlZFRvdGFsLnN1Yih3ZWlBbW91bnRUb3RhbCk7CgogICAgICAgIHVpbnQyNTYgdG9rZW5zQW1vdW50ID0gdG9rZW4uYmFsYW5jZU9mKG1zZy5zZW5kZXIpOwoKICAgICAgICB0b2tlbnNTb2xkVG90YWwgPSB0b2tlbnNTb2xkVG90YWwuc3ViKHRva2Vuc0Ftb3VudCk7CgogICAgICAgIHRva2VuLmJ1cm5Gcm9tQWRkcmVzcyhtc2cuc2VuZGVyKTsKCiAgICAgICAgbXNnLnNlbmRlci50cmFuc2Zlcih3ZWlBbW91bnRUb3RhbCk7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgU2VsbCB0b2tlbnMgZHVyaW5nIHByZS1JQ08uCiAgICAqIEBkZXYgU2VsbCB0b2tlbnMgb25seSBmb3Igd2hpdGVsaXN0ZWQgd2FsbGV0cy4KICAgICovCiAgICBmdW5jdGlvbiBzZWxsVG9rZW5zUHJlSWNvKCkgYmVmb3JlUmVhY2hpbmdIYXJkQ2FwIHdoZW5XaGl0ZWxpc3RlZChtc2cuc2VuZGVyKSB3aGVuTm90UGF1c2VkIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKGlzUHJlSWNvKCkpOwogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID4gMCk7CgogICAgICAgIHVpbnQyNTYgd2VpQW1vdW50ID0gbXNnLnZhbHVlOwogICAgICAgIHVpbnQyNTYgZXhjZXNzaXZlRnVuZHMgPSAwOwoKICAgICAgICB1aW50MjU2IHBsYW5uZWRXZWlUb3RhbCA9IHdlaVJhaXNlZFRvdGFsLmFkZCh3ZWlBbW91bnQpOwoKICAgICAgICBpZiAocGxhbm5lZFdlaVRvdGFsID4gbWF4Y2FwKSB7CiAgICAgICAgICAgIGV4Y2Vzc2l2ZUZ1bmRzID0gcGxhbm5lZFdlaVRvdGFsLnN1YihtYXhjYXApOwogICAgICAgICAgICB3ZWlBbW91bnQgPSBtYXhjYXAuc3ViKHdlaVJhaXNlZFRvdGFsKTsKICAgICAgICB9CgogICAgICAgIGludmVzdG1lbnRzW21zZy5zZW5kZXJdID0gaW52ZXN0bWVudHNbbXNnLnNlbmRlcl0uYWRkKHdlaUFtb3VudCk7CgogICAgICAgIHdlaVJhaXNlZFByZUljbyA9IHdlaVJhaXNlZFByZUljby5hZGQod2VpQW1vdW50KTsKICAgICAgICB3ZWlSYWlzZWRUb3RhbCA9IHdlaVJhaXNlZFRvdGFsLmFkZCh3ZWlBbW91bnQpOwoKICAgICAgICBhZGRJbnZlc3RtZW50UHJlSWNvKG1zZy5zZW5kZXIsIHdlaUFtb3VudCk7CgogICAgICAgIGlmIChleGNlc3NpdmVGdW5kcyA+IDApIHsKICAgICAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihleGNlc3NpdmVGdW5kcyk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IFNlbGwgdG9rZW5zIGR1cmluZyBJQ08uCiAgICAqIEBkZXYgU2VsbCB0b2tlbnMgb25seSBmb3Igd2hpdGVsaXN0ZWQgd2FsbGV0cy4KICAgICovCiAgICBmdW5jdGlvbiBzZWxsVG9rZW5zSWNvKCkgYmVmb3JlUmVhY2hpbmdIYXJkQ2FwIHdoZW5XaGl0ZWxpc3RlZChtc2cuc2VuZGVyKSB3aGVuTm90UGF1c2VkIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKGlzSWNvKCkpOwogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID4gMCk7CgogICAgICAgIHVpbnQyNTYgd2VpQW1vdW50ID0gbXNnLnZhbHVlOwogICAgICAgIHVpbnQyNTYgZXhjZXNzaXZlRnVuZHMgPSAwOwoKICAgICAgICB1aW50MjU2IHBsYW5uZWRXZWlUb3RhbCA9IHdlaVJhaXNlZFRvdGFsLmFkZCh3ZWlBbW91bnQpOwoKICAgICAgICBpZiAocGxhbm5lZFdlaVRvdGFsID4gbWF4Y2FwKSB7CiAgICAgICAgICAgIGV4Y2Vzc2l2ZUZ1bmRzID0gcGxhbm5lZFdlaVRvdGFsLnN1YihtYXhjYXApOwogICAgICAgICAgICB3ZWlBbW91bnQgPSBtYXhjYXAuc3ViKHdlaVJhaXNlZFRvdGFsKTsKICAgICAgICB9CgogICAgICAgIHVpbnQyNTYgdG9rZW5zQW1vdW50ID0gd2VpQW1vdW50Lm11bChleGNoYW5nZVJhdGVJY28pOwoKICAgICAgICBpZiAodG9rZW5zQW1vdW50ID4gdG9rZW5zUmVtYWluaW5nSWNvKSB7CiAgICAgICAgICAgIHVpbnQyNTYgd2VpVG9BY2NlcHQgPSB0b2tlbnNSZW1haW5pbmdJY28uZGl2KGV4Y2hhbmdlUmF0ZUljbyk7CiAgICAgICAgICAgIGV4Y2Vzc2l2ZUZ1bmRzID0gZXhjZXNzaXZlRnVuZHMuYWRkKHdlaUFtb3VudC5zdWIod2VpVG9BY2NlcHQpKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHRva2Vuc0Ftb3VudCA9IHRva2Vuc1JlbWFpbmluZ0ljbzsKICAgICAgICAgICAgd2VpQW1vdW50ID0gd2VpVG9BY2NlcHQ7CiAgICAgICAgfQoKICAgICAgICBpbnZlc3RtZW50c1ttc2cuc2VuZGVyXSA9IGludmVzdG1lbnRzW21zZy5zZW5kZXJdLmFkZCh3ZWlBbW91bnQpOwoKICAgICAgICB0b2tlbnNTb2xkSWNvID0gdG9rZW5zU29sZEljby5hZGQodG9rZW5zQW1vdW50KTsKICAgICAgICB0b2tlbnNTb2xkVG90YWwgPSB0b2tlbnNTb2xkVG90YWwuYWRkKHRva2Vuc0Ftb3VudCk7CiAgICAgICAgdG9rZW5zUmVtYWluaW5nSWNvID0gdG9rZW5zUmVtYWluaW5nSWNvLnN1Yih0b2tlbnNBbW91bnQpOwoKICAgICAgICB3ZWlSYWlzZWRJY28gPSB3ZWlSYWlzZWRJY28uYWRkKHdlaUFtb3VudCk7CiAgICAgICAgd2VpUmFpc2VkVG90YWwgPSB3ZWlSYWlzZWRUb3RhbC5hZGQod2VpQW1vdW50KTsKCiAgICAgICAgdG9rZW4udHJhbnNmZXJGcm9tSWNvKG1zZy5zZW5kZXIsIHRva2Vuc0Ftb3VudCk7CgogICAgICAgIGlmIChleGNlc3NpdmVGdW5kcyA+IDApIHsKICAgICAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihleGNlc3NpdmVGdW5kcyk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IFNlbmQgcmFpc2VkIGZ1bmRzIHRvIHRoZSB3aXRoZHJhd2FsIHdhbGxldC4KICAgICovCiAgICBmdW5jdGlvbiBmb3J3YXJkRnVuZHMoKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKHdlaVJhaXNlZFRvdGFsID49IG1pbmNhcCk7CiAgICAgICAgd2l0aGRyYXdhbFdhbGxldC50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IENhbGN1bGF0ZSB0b2tlbiBleGNoYW5nZSByYXRlIGZvciBwcmUtSUNPIGFuZCBJQ08uCiAgICAqIEBkZXYgT25seSBhcHBsaWVzIHdoZW4gdGhlIHByZS1JQ08gd2FzIGVuZGVkLgogICAgKiBAZGV2IE1heSBiZSBjYWxsZWQgb25seSBvbmNlLgogICAgKi8KICAgIGZ1bmN0aW9uIGNhbGNUb2tlblJhdGUoKSB3aGVuUHJlSWNvU2FsZUhhc0VuZGVkIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoIWlzVG9rZW5SYXRlQ2FsY3VsYXRlZCk7CiAgICAgICAgcmVxdWlyZSh3ZWlSYWlzZWRQcmVJY28gPiAwKTsKCiAgICAgICAgZXhjaGFuZ2VSYXRlUHJlSWNvID0gSEFSRENBUF9UT0tFTlNfUFJFX0lDTy5kaXYod2VpUmFpc2VkUHJlSWNvKTsKCiAgICAgICAgZXhjaGFuZ2VSYXRlSWNvID0gZXhjaGFuZ2VSYXRlUHJlSWNvLmRpdigyKTsKCiAgICAgICAgaXNUb2tlblJhdGVDYWxjdWxhdGVkID0gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBEaXN0cmlidXRlIHRva2VucyB0byBwcmUtSUNPIGludmVzdG9ycyB1c2luZyBwYWdpbmF0aW9uLgogICAgKiBAZGV2IFBhZ2luYXRpb24gcHJvY2VlZHMgdGhlIHNldCB2YWx1ZSAocGFnaW5hdGlvbkNvdW50KSBvZiB0b2tlbnMgZGlzdHJpYnV0aW9ucyBwZXIgb25lIGZ1bmN0aW9uIGNhbGwuCiAgICAqIEBwYXJhbSBfcGFnaW5hdGlvbkNvdW50IFRoZSB2YWx1ZSB0aGF0IHVzZWQgZm9yIHBhZ2luYXRpb24uCiAgICAqLwogICAgZnVuY3Rpb24gZGlzdHJpYnV0ZVRva2Vuc1ByZUljbyh1aW50MjU2IF9wYWdpbmF0aW9uQ291bnQpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoaXNUb2tlblJhdGVDYWxjdWxhdGVkICYmICFpc1Rva2Vuc1ByZUljb0Rpc3RyaWJ1dGVkKTsKICAgICAgICByZXF1aXJlKF9wYWdpbmF0aW9uQ291bnQgPiAwKTsKCiAgICAgICAgdWludDI1NiBjb3VudCA9IDA7CiAgICAgICAgZm9yICh1aW50MjU2IGkgPSBkaXN0cmlidXRpb25QcmVJY29Db3VudDsgaSA8IGdldFByZUljb0ludmVzdG9yc0NvdW50KCk7IGkrKykgewogICAgICAgICAgICBpZiAoY291bnQgPT0gX3BhZ2luYXRpb25Db3VudCkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdWludDI1NiBpbnZlc3RtZW50ID0gZ2V0UHJlSWNvSW52ZXN0bWVudChnZXRQcmVJY29JbnZlc3RvcihpKSk7CiAgICAgICAgICAgIHVpbnQyNTYgdG9rZW5zQW1vdW50ID0gaW52ZXN0bWVudC5tdWwoZXhjaGFuZ2VSYXRlUHJlSWNvKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHRva2Vuc1NvbGRUb3RhbCA9IHRva2Vuc1NvbGRUb3RhbC5hZGQodG9rZW5zQW1vdW50KTsKCiAgICAgICAgICAgIHRva2VuLnRyYW5zZmVyRnJvbUljbyhnZXRQcmVJY29JbnZlc3RvcihpKSwgdG9rZW5zQW1vdW50KTsKCiAgICAgICAgICAgIGNvdW50Kys7CiAgICAgICAgfQoKICAgICAgICBkaXN0cmlidXRpb25QcmVJY29Db3VudCA9IGRpc3RyaWJ1dGlvblByZUljb0NvdW50LmFkZChjb3VudCk7CgogICAgICAgIGlmIChkaXN0cmlidXRpb25QcmVJY29Db3VudCA9PSBnZXRQcmVJY29JbnZlc3RvcnNDb3VudCgpKSB7CiAgICAgICAgICAgIGlzVG9rZW5zUHJlSWNvRGlzdHJpYnV0ZWQgPSB0cnVlOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICogQGRldiBCdXJuIHVuc29sZCB0b2tlbnMgZnJvbSB0aGUgSUNPIGJhbGFuY2UuCiAgICAqIEBkZXYgT25seSBhcHBsaWVzIHdoZW4gdGhlIElDTyB3YXMgZW5kZWQuCiAgICAqLwogICAgZnVuY3Rpb24gYnVyblVuc29sZFRva2VucygpIHdoZW5JY29TYWxlSGFzRW5kZWQgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZSh0b2tlbnNSZW1haW5pbmdJY28gPiAwKTsKICAgICAgICB0b2tlbi5idXJuRnJvbUljbygpOwogICAgICAgIHRva2Vuc1JlbWFpbmluZ0ljbyA9IDA7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgQ291bnQgdGhlIHByZS1JQ08gaW52ZXN0b3JzIHRvdGFsLgogICAgKi8KICAgIGZ1bmN0aW9uIGdldFByZUljb0ludmVzdG9yc0NvdW50KCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gaW52ZXN0b3JzUHJlSWNvLmxlbmd0aDsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBHZXQgdGhlIHByZS1JQ08gaW52ZXN0b3IgYWRkcmVzcy4KICAgICogQHBhcmFtIF9pbmRleCB0aGUgaW5kZXggb2YgaW52ZXN0b3IgaW4gdGhlIGFycmF5LiAKICAgICovCiAgICBmdW5jdGlvbiBnZXRQcmVJY29JbnZlc3Rvcih1aW50MjU2IF9pbmRleCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKGFkZHJlc3MpIHsKICAgICAgICByZXR1cm4gaW52ZXN0b3JzUHJlSWNvW19pbmRleF07CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgR2V0cyB0aGUgYW1vdW50IG9mIHRva2VucyBmb3IgcHJlLUlDTyBpbnZlc3Rvci4KICAgICogQHBhcmFtIF9pbnZlc3RvclByZUljbyB0aGUgcHJlLUlDTyBpbnZlc3RvciBhZGRyZXNzLgogICAgKi8KICAgIGZ1bmN0aW9uIGdldFByZUljb0ludmVzdG1lbnQoYWRkcmVzcyBfaW52ZXN0b3JQcmVJY28pIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGludmVzdG1lbnRzUHJlSWNvW19pbnZlc3RvclByZUljb107CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgU2V0IHN0YXJ0IHRpbWUgYW5kIGVuZCB0aW1lIGZvciBJQ08uCiAgICAqIEBkZXYgT25seSBhcHBsaWVzIHdoZW4gdG9rZW5zIGRpc3RyaWJ1dGlvbnMgdG8gcHJlLUlDTyBpbnZlc3RvcnMgd2VyZSBwcm9jZXNzZWQuCiAgICAqIEBwYXJhbSBfc3RhcnRUaW1lSWNvIFRoZSBJQ08gc3RhcnQgdGltZS4KICAgICogQHBhcmFtIF9lbmRUaW1lSWNvIFRoZSBJQ08gZW5kIHRpbWUuCiAgICAqLwogICAgZnVuY3Rpb24gc2V0U3RhcnRUaW1lSWNvKHVpbnQyNTYgX3N0YXJ0VGltZUljbywgdWludDI1NiBfZW5kVGltZUljbykgd2hlblByZUljb1NhbGVIYXNFbmRlZCBiZWZvcmVSZWFjaGluZ0hhcmRDYXAgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfc3RhcnRUaW1lSWNvID49IG5vdyAmJiBfZW5kVGltZUljbyA+IF9zdGFydFRpbWVJY28pOwogICAgICAgIHJlcXVpcmUoaXNUb2tlblJhdGVDYWxjdWxhdGVkKTsKCiAgICAgICAgc3RhcnRUaW1lSWNvID0gX3N0YXJ0VGltZUljbzsKICAgICAgICBlbmRUaW1lSWNvID0gX2VuZFRpbWVJY287CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgQWRkIG5ldyBpbnZlc3RtZW50IHRvIHRoZSBwcmUtSUNPIGludmVzdG1lbnRzIHN0b3JhZ2UuCiAgICAqIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiBhIHByZS1JQ08gaW52ZXN0b3IuCiAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGludmVzdG1lbnQgcmVjZWl2ZWQgZnJvbSBhIHByZS1JQ08gaW52ZXN0b3IuCiAgICAqLwogICAgZnVuY3Rpb24gYWRkSW52ZXN0bWVudFByZUljbyhhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF92YWx1ZSkgaW50ZXJuYWwgewogICAgICAgIGlmIChpbnZlc3RtZW50c1ByZUljb1tfZnJvbV0gPT0gMCkgewogICAgICAgICAgICBpbnZlc3RvcnNQcmVJY28ucHVzaChfZnJvbSk7CiAgICAgICAgfQogICAgICAgIGludmVzdG1lbnRzUHJlSWNvW19mcm9tXSA9IGludmVzdG1lbnRzUHJlSWNvW19mcm9tXS5hZGQoX3ZhbHVlKTsKICAgIH0gIAp9CgovLyBGaWxlOiBjb250cmFjdHMvQ3VycmVudEZhY3Rvcnkuc29sCgpjb250cmFjdCBDdXJyZW50RmFjdG9yeSB7CiAgICBDdXJyZW50Q3Jvd2RzYWxlIHB1YmxpYyBjcm93ZHNhbGU7CgogICAgZnVuY3Rpb24gY3JlYXRlQ3Jvd2RzYWxlICgKICAgICAgICB1aW50MjU2IF9taW5jYXAsCiAgICAgICAgdWludDI1NiBfbWF4Y2FwLAogICAgICAgIHVpbnQyNTYgX3N0YXJ0VGltZVByZUljbywKICAgICAgICB1aW50MjU2IF9lbmRUaW1lUHJlSWNvLAogICAgICAgIGFkZHJlc3MgX2ZvdW5kZXJzV2FsbGV0LAogICAgICAgIGFkZHJlc3MgX29wZXJhdGlvbmFsRXhwZW5zZXNXYWxsZXQsCiAgICAgICAgYWRkcmVzcyBfd2l0aGRyYXdhbFdhbGxldAogICAgKSBwdWJsaWMKICAgIHsKICAgICAgICBjcm93ZHNhbGUgPSBuZXcgQ3VycmVudENyb3dkc2FsZSgKICAgICAgICAgICAgX21pbmNhcCwKICAgICAgICAgICAgX21heGNhcCwKICAgICAgICAgICAgX3N0YXJ0VGltZVByZUljbywKICAgICAgICAgICAgX2VuZFRpbWVQcmVJY28sCiAgICAgICAgICAgIF9mb3VuZGVyc1dhbGxldCwKICAgICAgICAgICAgX29wZXJhdGlvbmFsRXhwZW5zZXNXYWxsZXQsCiAgICAgICAgICAgIF93aXRoZHJhd2FsV2FsbGV0CiAgICAgICAgKTsKCiAgICAgICAgV2hpdGVsaXN0IHdoaXRlbGlzdCA9IGNyb3dkc2FsZS53aGl0ZWxpc3QoKTsKICAgICAgICB3aGl0ZWxpc3QudHJhbnNmZXJPd25lcnNoaXAobXNnLnNlbmRlcik7CgogICAgICAgIEN1cnJlbnRUb2tlbiB0b2tlbiA9IGNyb3dkc2FsZS50b2tlbigpOwogICAgICAgIHRva2VuLnRyYW5zZmVyT3duZXJzaGlwKG1zZy5zZW5kZXIpOwoKICAgICAgICBjcm93ZHNhbGUudHJhbnNmZXJPd25lcnNoaXAobXNnLnNlbmRlcik7CiAgICB9Cn0='.
	

]
