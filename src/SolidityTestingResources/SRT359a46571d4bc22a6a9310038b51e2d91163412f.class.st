Class {
	#name : #SRT359a46571d4bc22a6a9310038b51e2d91163412f,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT359a46571d4bc22a6a9310038b51e2d91163412f >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKY29udHJhY3QgQXBwcm92ZUFuZENhbGxSZWNlaXZlciB7CiAgICBmdW5jdGlvbiByZWNlaXZlQXBwcm92YWwoYWRkcmVzcyBmcm9tLCB1aW50MjU2IF9hbW91bnQsIGFkZHJlc3MgX3Rva2VuLCBieXRlcyBfZGF0YSkgcHVibGljOwp9Cgpjb250cmFjdCBUb2tlbkZhY3RvcnlJbnRlcmZhY2UgewoKICAgIGZ1bmN0aW9uIGNyZWF0ZUNsb25lVG9rZW4oCiAgICAgICAgYWRkcmVzcyBfcGFyZW50VG9rZW4sCiAgICAgICAgdWludCBfc25hcHNob3RCbG9jaywKICAgICAgICBzdHJpbmcgX3Rva2VuTmFtZSwKICAgICAgICBzdHJpbmcgX3Rva2VuU3ltYm9sCiAgICAgICkgcHVibGljIHJldHVybnMgKFNlcnZ1c1Rva2VuIG5ld1Rva2VuKTsKfQoKLyoqCiAqIEB0aXRsZSBDb250cm9sbGFibGUKICogQGRldiBUaGUgQ29udHJvbGxhYmxlIGNvbnRyYWN0IGhhcyBhbiBjb250cm9sbGVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IENvbnRyb2xsYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgY29udHJvbGxlcjsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlciBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIENvbnRyb2xsYWJsZSgpIHB1YmxpYyB7CiAgICBjb250cm9sbGVyID0gbXNnLnNlbmRlcjsKICB9CgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5Q29udHJvbGxlcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBjb250cm9sbGVyKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdDb250cm9sbGVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckNvbnRyb2woYWRkcmVzcyBuZXdDb250cm9sbGVyKSBwdWJsaWMgb25seUNvbnRyb2xsZXIgewogICAgaWYgKG5ld0NvbnRyb2xsZXIgIT0gYWRkcmVzcygwKSkgewogICAgICBjb250cm9sbGVyID0gbmV3Q29udHJvbGxlcjsKICAgIH0KICB9Cgp9CgovKioKICogQHRpdGxlIFNlcnZ1c1Rva2VuIChTUlYpCiAqIFN0YW5kYXJkIE1pbnRhYmxlIEVSQzIwIFRva2VuCiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6CiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KY29udHJhY3QgU2VydnVzVG9rZW5JbnRlcmZhY2UgaXMgQ29udHJvbGxhYmxlIHsKCiAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKICBldmVudCBNaW50RmluaXNoZWQoKTsKICBldmVudCBDbGFpbWVkVG9rZW5zKGFkZHJlc3MgaW5kZXhlZCBfdG9rZW4sIGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIHVpbnQgX2Ftb3VudCk7CiAgZXZlbnQgTmV3Q2xvbmVUb2tlbihhZGRyZXNzIGluZGV4ZWQgX2Nsb25lVG9rZW4sIHVpbnQgX3NuYXBzaG90QmxvY2spOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludDI1NiBfYW1vdW50KTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKCiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCk7CiAgZnVuY3Rpb24gdG90YWxTdXBwbHlBdCh1aW50IF9ibG9ja051bWJlcikgcHVibGljIGNvbnN0YW50IHJldHVybnModWludCk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKICBmdW5jdGlvbiBiYWxhbmNlT2ZBdChhZGRyZXNzIF9vd25lciwgdWludCBfYmxvY2tOdW1iZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogIGZ1bmN0aW9uIGFwcHJvdmVBbmRDYWxsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX2Ftb3VudCwgYnl0ZXMgX2V4dHJhRGF0YSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOwogIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfb3duZXIsIHVpbnQgX2Ftb3VudCkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGltcG9ydFByZXNhbGVCYWxhbmNlcyhhZGRyZXNzW10gX2FkZHJlc3NlcywgdWludDI1NltdIF9iYWxhbmNlcywgYWRkcmVzcyBfcHJlc2FsZUFkZHJlc3MpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBsb2NrUHJlc2FsZUJhbGFuY2VzKCkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gZW5hYmxlVHJhbnNmZXJzKGJvb2wgX3ZhbHVlKSBwdWJsaWM7CiAgZnVuY3Rpb24gZW5hYmxlTWFzdGVyVHJhbnNmZXJzKGJvb2wgX3ZhbHVlKSBwdWJsaWM7CiAgZnVuY3Rpb24gY3JlYXRlQ2xvbmVUb2tlbih1aW50IF9zbmFwc2hvdEJsb2NrLCBzdHJpbmcgX2Nsb25lVG9rZW5OYW1lLCBzdHJpbmcgX2Nsb25lVG9rZW5TeW1ib2wpIHB1YmxpYyByZXR1cm5zIChhZGRyZXNzKTsKCn0KLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIG9ubHlPd25lciB7CiAgICBpZiAobmV3T3duZXIgIT0gYWRkcmVzcygwKSkgewogICAgICBvd25lciA9IG5ld093bmVyOwogICAgfQogIH0KCn0KCmNvbnRyYWN0IFNlcnZ1c1Rva2VuIGlzIENvbnRyb2xsYWJsZSB7CgogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogIFNlcnZ1c1Rva2VuSW50ZXJmYWNlIHB1YmxpYyBwYXJlbnRUb2tlbjsKICBUb2tlbkZhY3RvcnlJbnRlcmZhY2UgcHVibGljIHRva2VuRmFjdG9yeTsKCiAgc3RyaW5nIHB1YmxpYyBuYW1lOwogIHN0cmluZyBwdWJsaWMgc3ltYm9sOwogIHN0cmluZyBwdWJsaWMgdmVyc2lvbjsKICB1aW50OCBwdWJsaWMgZGVjaW1hbHM7CgogIHVpbnQyNTYgcHVibGljIHBhcmVudFNuYXBTaG90QmxvY2s7CiAgdWludDI1NiBwdWJsaWMgY3JlYXRpb25CbG9jazsKICBib29sIHB1YmxpYyB0cmFuc2ZlcnNFbmFibGVkOwoKICBib29sIHB1YmxpYyBtYXN0ZXJUcmFuc2ZlcnNFbmFibGVkOwogIGFkZHJlc3MgcHVibGljIG1hc3RlcldhbGxldCA9IDB4OWQyM2NjNGVmYTM2NmI3MGYzNGYxODc5YmM2MTc4ZTZmMzM0MjQ0MTsKCgogIHN0cnVjdCBDaGVja3BvaW50IHsKICAgIHVpbnQxMjggZnJvbUJsb2NrOwogICAgdWludDEyOCB2YWx1ZTsKICB9CgogIENoZWNrcG9pbnRbXSB0b3RhbFN1cHBseUhpc3Rvcnk7CiAgbWFwcGluZyhhZGRyZXNzID0+IENoZWNrcG9pbnRbXSkgYmFsYW5jZXM7CiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpKSBhbGxvd2VkOwoKICBib29sIHB1YmxpYyBtaW50aW5nRmluaXNoZWQgPSBmYWxzZTsKICBib29sIHB1YmxpYyBwcmVzYWxlQmFsYW5jZXNMb2NrZWQgPSBmYWxzZTsKCiAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgVE9UQUxfUFJFU0FMRV9UT0tFTlMgPSAyODk2MDAwMDAwMDAwMDAwMDAwMDAwOwoKICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwogIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwogIGV2ZW50IENsYWltZWRUb2tlbnMoYWRkcmVzcyBpbmRleGVkIF90b2tlbiwgYWRkcmVzcyBpbmRleGVkIF9vd25lciwgdWludCBfYW1vdW50KTsKICBldmVudCBOZXdDbG9uZVRva2VuKGFkZHJlc3MgaW5kZXhlZCBjbG9uZVRva2VuKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX2Ftb3VudCk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7CgoKCgogIGZ1bmN0aW9uIFNlcnZ1c1Rva2VuKAogICAgYWRkcmVzcyBfdG9rZW5GYWN0b3J5LAogICAgYWRkcmVzcyBfcGFyZW50VG9rZW4sCiAgICB1aW50MjU2IF9wYXJlbnRTbmFwU2hvdEJsb2NrLAogICAgc3RyaW5nIF90b2tlbk5hbWUsCiAgICBzdHJpbmcgX3Rva2VuU3ltYm9sCiAgICApIHB1YmxpYyB7CiAgICAgIHRva2VuRmFjdG9yeSA9IFRva2VuRmFjdG9yeUludGVyZmFjZShfdG9rZW5GYWN0b3J5KTsKICAgICAgcGFyZW50VG9rZW4gPSBTZXJ2dXNUb2tlbkludGVyZmFjZShfcGFyZW50VG9rZW4pOwogICAgICBwYXJlbnRTbmFwU2hvdEJsb2NrID0gX3BhcmVudFNuYXBTaG90QmxvY2s7CiAgICAgIG5hbWUgPSBfdG9rZW5OYW1lOwogICAgICBzeW1ib2wgPSBfdG9rZW5TeW1ib2w7CiAgICAgIGRlY2ltYWxzID0gNjsKICAgICAgdHJhbnNmZXJzRW5hYmxlZCA9IGZhbHNlOwogICAgICBtYXN0ZXJUcmFuc2ZlcnNFbmFibGVkID0gZmFsc2U7CiAgICAgIGNyZWF0aW9uQmxvY2sgPSBibG9jay5udW1iZXI7CiAgICAgIHZlcnNpb24gPSAnMC4xJzsKICB9CgogIGZ1bmN0aW9uKCkgcHVibGljIHBheWFibGUgewogICAgcmV2ZXJ0KCk7CiAgfQoKCiAgLyoqCiAgKiBSZXR1cm5zIHRoZSB0b3RhbCBTZXJ2dXMgdG9rZW4gc3VwcGx5IGF0IHRoZSBjdXJyZW50IGJsb2NrCiAgKiBAcmV0dXJuIHRvdGFsIHN1cHBseSB7dWludDI1Nn0KICAqLwogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiB0b3RhbFN1cHBseUF0KGJsb2NrLm51bWJlcik7CiAgfQoKICAvKioKICAqIFJldHVybnMgdGhlIHRvdGFsIFNlcnZ1cyB0b2tlbiBzdXBwbHkgYXQgdGhlIGdpdmVuIGJsb2NrIG51bWJlcgogICogQHBhcmFtIF9ibG9ja051bWJlciB7dWludDI1Nn0KICAqIEByZXR1cm4gdG90YWwgc3VwcGx5IHt1aW50MjU2fQogICovCiAgZnVuY3Rpb24gdG90YWxTdXBwbHlBdCh1aW50MjU2IF9ibG9ja051bWJlcikgcHVibGljIGNvbnN0YW50IHJldHVybnModWludDI1NikgewogICAgLy8gVGhlc2UgbmV4dCBmZXcgbGluZXMgYXJlIHVzZWQgd2hlbiB0aGUgdG90YWxTdXBwbHkgb2YgdGhlIHRva2VuIGlzCiAgICAvLyAgcmVxdWVzdGVkIGJlZm9yZSBhIGNoZWNrIHBvaW50IHdhcyBldmVyIGNyZWF0ZWQgZm9yIHRoaXMgdG9rZW4sIGl0CiAgICAvLyAgcmVxdWlyZXMgdGhhdCB0aGUgYHBhcmVudFRva2VuLnRvdGFsU3VwcGx5QXRgIGJlIHF1ZXJpZWQgYXQgdGhlCiAgICAvLyAgZ2VuZXNpcyBibG9jayBmb3IgdGhpcyB0b2tlbiBhcyB0aGF0IGNvbnRhaW5zIHRvdGFsU3VwcGx5IG9mIHRoaXMKICAgIC8vICB0b2tlbiBhdCB0aGlzIGJsb2NrIG51bWJlci4KICAgIGlmICgodG90YWxTdXBwbHlIaXN0b3J5Lmxlbmd0aCA9PSAwKSB8fCAodG90YWxTdXBwbHlIaXN0b3J5WzBdLmZyb21CbG9jayA+IF9ibG9ja051bWJlcikpIHsKICAgICAgICBpZiAoYWRkcmVzcyhwYXJlbnRUb2tlbikgIT0gMCkgewogICAgICAgICAgICByZXR1cm4gcGFyZW50VG9rZW4udG90YWxTdXBwbHlBdChtaW4oX2Jsb2NrTnVtYmVyLCBwYXJlbnRTbmFwU2hvdEJsb2NrKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQoKICAgIC8vIFRoaXMgd2lsbCByZXR1cm4gdGhlIGV4cGVjdGVkIHRvdGFsU3VwcGx5IGR1cmluZyBub3JtYWwgc2l0dWF0aW9ucwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZ2V0VmFsdWVBdCh0b3RhbFN1cHBseUhpc3RvcnksIF9ibG9ja051bWJlcik7CiAgICB9CiAgfQoKICAvKioKICAqIFJldHVybnMgdGhlIHRva2VuIGhvbGRlciBiYWxhbmNlIGF0IHRoZSBjdXJyZW50IGJsb2NrCiAgKiBAcGFyYW0gX293bmVyIHthZGRyZXNzfQogICogQHJldHVybiBiYWxhbmNlIHt1aW50MjU2fQogICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VPZkF0KF9vd25lciwgYmxvY2subnVtYmVyKTsKICB9CgogIC8qKgogICogUmV0dXJucyB0aGUgdG9rZW4gaG9sZGVyIGJhbGFuY2UgdGhlIHRoZSBnaXZlbiBibG9jayBudW1iZXIKICAqIEBwYXJhbSBfb3duZXIge2FkZHJlc3N9CiAgKiBAcGFyYW0gX2Jsb2NrTnVtYmVyIHt1aW50MjU2fQogICogQHJldHVybiBiYWxhbmNlIHt1aW50MjU2fQogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mQXQoYWRkcmVzcyBfb3duZXIsIHVpbnQyNTYgX2Jsb2NrTnVtYmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgLy8gVGhlc2UgbmV4dCBmZXcgbGluZXMgYXJlIHVzZWQgd2hlbiB0aGUgYmFsYW5jZSBvZiB0aGUgdG9rZW4gaXMKICAgIC8vICByZXF1ZXN0ZWQgYmVmb3JlIGEgY2hlY2sgcG9pbnQgd2FzIGV2ZXIgY3JlYXRlZCBmb3IgdGhpcyB0b2tlbiwgaXQKICAgIC8vICByZXF1aXJlcyB0aGF0IHRoZSBgcGFyZW50VG9rZW4uYmFsYW5jZU9mQXRgIGJlIHF1ZXJpZWQgYXQgdGhlCiAgICAvLyAgZ2VuZXNpcyBibG9jayBmb3IgdGhhdCB0b2tlbiBhcyB0aGlzIGNvbnRhaW5zIGluaXRpYWwgYmFsYW5jZSBvZgogICAgLy8gIHRoaXMgdG9rZW4KICAgIGlmICgoYmFsYW5jZXNbX293bmVyXS5sZW5ndGggPT0gMCkgfHwgKGJhbGFuY2VzW19vd25lcl1bMF0uZnJvbUJsb2NrID4gX2Jsb2NrTnVtYmVyKSkgewogICAgICAgIGlmIChhZGRyZXNzKHBhcmVudFRva2VuKSAhPSAwKSB7CiAgICAgICAgICAgIHJldHVybiBwYXJlbnRUb2tlbi5iYWxhbmNlT2ZBdChfb3duZXIsIG1pbihfYmxvY2tOdW1iZXIsIHBhcmVudFNuYXBTaG90QmxvY2spKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBIYXMgbm8gcGFyZW50CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KCiAgICAvLyBUaGlzIHdpbGwgcmV0dXJuIHRoZSBleHBlY3RlZCBiYWxhbmNlIGR1cmluZyBub3JtYWwgc2l0dWF0aW9ucwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZ2V0VmFsdWVBdChiYWxhbmNlc1tfb3duZXJdLCBfYmxvY2tOdW1iZXIpOwogICAgfQogIH0KCiAgLyoqCiAgKiBTdGFuZGFyZCBFUkMyMCB0cmFuc2ZlciB0b2tlbnMgZnVuY3Rpb24KICAqIEBwYXJhbSBfdG8ge2FkZHJlc3N9CiAgKiBAcGFyYW0gX2Ftb3VudCB7dWludH0KICAqIEByZXR1cm4gc3VjY2VzcyB7Ym9vbH0KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJldHVybiBkb1RyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX2Ftb3VudCk7CiAgfQoKICAvKioKICAqIFN0YW5kYXJkIEVSQzIwIHRyYW5zZmVyRnJvbSBmdW5jdGlvbgogICogQHBhcmFtIF9mcm9tIHthZGRyZXNzfQogICogQHBhcmFtIF90byB7YWRkcmVzc30KICAqIEBwYXJhbSBfYW1vdW50IHt1aW50MjU2fQogICogQHJldHVybiBzdWNjZXNzIHtib29sfQogICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJlcXVpcmUoYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPj0gX2Ftb3VudCk7CiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfYW1vdW50OwogICAgcmV0dXJuIGRvVHJhbnNmZXIoX2Zyb20sIF90bywgX2Ftb3VudCk7CiAgfQoKICAvKioKICAqIFN0YW5kYXJkIEVSQzIwIGFwcHJvdmUgZnVuY3Rpb24KICAqIEBwYXJhbSBfc3BlbmRlciB7YWRkcmVzc30KICAqIEBwYXJhbSBfYW1vdW50IHt1aW50MjU2fQogICogQHJldHVybiBzdWNjZXNzIHtib29sfQogICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJlcXVpcmUodHJhbnNmZXJzRW5hYmxlZCk7CgogICAgLy9odHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgcmVxdWlyZSgoX2Ftb3VudCA9PSAwKSB8fCAoYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPT0gMCkpOwoKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX2Ftb3VudDsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfYW1vdW50KTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBTdGFuZGFyZCBFUkMyMCBhcHByb3ZlIGZ1bmN0aW9uCiAgKiBAcGFyYW0gX3NwZW5kZXIge2FkZHJlc3N9CiAgKiBAcGFyYW0gX2Ftb3VudCB7dWludDI1Nn0KICAqIEByZXR1cm4gc3VjY2VzcyB7Ym9vbH0KICAqLwogIGZ1bmN0aW9uIGFwcHJvdmVBbmRDYWxsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX2Ftb3VudCwgYnl0ZXMgX2V4dHJhRGF0YSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgYXBwcm92ZShfc3BlbmRlciwgX2Ftb3VudCk7CgogICAgQXBwcm92ZUFuZENhbGxSZWNlaXZlcihfc3BlbmRlcikucmVjZWl2ZUFwcHJvdmFsKAogICAgICAgIG1zZy5zZW5kZXIsCiAgICAgICAgX2Ftb3VudCwKICAgICAgICB0aGlzLAogICAgICAgIF9leHRyYURhdGEKICAgICk7CgogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAqIFN0YW5kYXJkIEVSQzIwIGFsbG93YW5jZSBmdW5jdGlvbgogICogQHBhcmFtIF9vd25lciB7YWRkcmVzc30KICAqIEBwYXJhbSBfc3BlbmRlciB7YWRkcmVzc30KICAqIEByZXR1cm4gcmVtYWluaW5nIHt1aW50MjU2fQogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CgogIC8qKgogICogSW50ZXJuYWwgVHJhbnNmZXIgZnVuY3Rpb24gLSBVcGRhdGVzIHRoZSBjaGVja3BvaW50IGxlZGdlcgogICogQHBhcmFtIF9mcm9tIHthZGRyZXNzfQogICogQHBhcmFtIF90byB7YWRkcmVzc30KICAqIEBwYXJhbSBfYW1vdW50IHt1aW50MjU2fQogICogQHJldHVybiBzdWNjZXNzIHtib29sfQogICovCiAgZnVuY3Rpb24gZG9UcmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBpbnRlcm5hbCByZXR1cm5zKGJvb2wpIHsKCiAgICBpZiAobXNnLnNlbmRlciAhPSBtYXN0ZXJXYWxsZXQpIHsKICAgICAgcmVxdWlyZSh0cmFuc2ZlcnNFbmFibGVkKTsKICAgIH0gZWxzZSB7CiAgICAgIHJlcXVpcmUobWFzdGVyVHJhbnNmZXJzRW5hYmxlZCk7CiAgICB9CgogICAgcmVxdWlyZShfYW1vdW50ID4gMCk7CiAgICByZXF1aXJlKHBhcmVudFNuYXBTaG90QmxvY2sgPCBibG9jay5udW1iZXIpOwogICAgcmVxdWlyZSgoX3RvICE9IDApICYmIChfdG8gIT0gYWRkcmVzcyh0aGlzKSkpOwoKICAgIC8vIElmIHRoZSBhbW91bnQgYmVpbmcgdHJhbnNmZXJlZCBpcyBtb3JlIHRoYW4gdGhlIGJhbGFuY2Ugb2YgdGhlCiAgICAvLyBhY2NvdW50IHRoZSB0cmFuc2ZlciByZXR1cm5zIGZhbHNlCiAgICB1aW50MjU2IHByZXZpb3VzQmFsYW5jZUZyb20gPSBiYWxhbmNlT2ZBdChfZnJvbSwgYmxvY2subnVtYmVyKTsKICAgIHJlcXVpcmUocHJldmlvdXNCYWxhbmNlRnJvbSA+PSBfYW1vdW50KTsKCiAgICAvLyBGaXJzdCB1cGRhdGUgdGhlIGJhbGFuY2UgYXJyYXkgd2l0aCB0aGUgbmV3IHZhbHVlIGZvciB0aGUgYWRkcmVzcwogICAgLy8gIHNlbmRpbmcgdGhlIHRva2VucwogICAgdXBkYXRlVmFsdWVBdE5vdyhiYWxhbmNlc1tfZnJvbV0sIHByZXZpb3VzQmFsYW5jZUZyb20gLSBfYW1vdW50KTsKCiAgICAvLyBUaGVuIHVwZGF0ZSB0aGUgYmFsYW5jZSBhcnJheSB3aXRoIHRoZSBuZXcgdmFsdWUgZm9yIHRoZSBhZGRyZXNzCiAgICAvLyAgcmVjZWl2aW5nIHRoZSB0b2tlbnMKICAgIHVpbnQyNTYgcHJldmlvdXNCYWxhbmNlVG8gPSBiYWxhbmNlT2ZBdChfdG8sIGJsb2NrLm51bWJlcik7CiAgICByZXF1aXJlKHByZXZpb3VzQmFsYW5jZVRvICsgX2Ftb3VudCA+PSBwcmV2aW91c0JhbGFuY2VUbyk7IC8vIENoZWNrIGZvciBvdmVyZmxvdwogICAgdXBkYXRlVmFsdWVBdE5vdyhiYWxhbmNlc1tfdG9dLCBwcmV2aW91c0JhbGFuY2VUbyArIF9hbW91bnQpOwoKICAgIC8vIEFuIGV2ZW50IHRvIG1ha2UgdGhlIHRyYW5zZmVyIGVhc3kgdG8gZmluZCBvbiB0aGUgYmxvY2tjaGFpbgogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX2Ftb3VudCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgoKICAvKioKICAqIFRva2VuIGNyZWF0aW9uIGZ1bmN0aW9ucyAtIGNhbiBvbmx5IGJlIGNhbGxlZCBieSB0aGUgdG9rZW5zYWxlIGNvbnRyb2xsZXIgZHVyaW5nIHRoZSB0b2tlbnNhbGUgcGVyaW9kCiAgKiBAcGFyYW0gX293bmVyIHthZGRyZXNzfQogICogQHBhcmFtIF9hbW91bnQge3VpbnQyNTZ9CiAgKiBAcmV0dXJuIHN1Y2Nlc3Mge2Jvb2x9CiAgKi8KICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX293bmVyLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyBvbmx5Q29udHJvbGxlciBjYW5NaW50IHJldHVybnMgKGJvb2wpIHsKICAgIHVpbnQyNTYgY3VyVG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseSgpOwogICAgdWludDI1NiBwcmV2aW91c0JhbGFuY2VUbyA9IGJhbGFuY2VPZihfb3duZXIpOwoKICAgIHJlcXVpcmUoY3VyVG90YWxTdXBwbHkgKyBfYW1vdW50ID49IGN1clRvdGFsU3VwcGx5KTsgLy8gQ2hlY2sgZm9yIG92ZXJmbG93CiAgICByZXF1aXJlKHByZXZpb3VzQmFsYW5jZVRvICsgX2Ftb3VudCA+PSBwcmV2aW91c0JhbGFuY2VUbyk7IC8vIENoZWNrIGZvciBvdmVyZmxvdwoKICAgIHVwZGF0ZVZhbHVlQXROb3codG90YWxTdXBwbHlIaXN0b3J5LCBjdXJUb3RhbFN1cHBseSArIF9hbW91bnQpOwogICAgdXBkYXRlVmFsdWVBdE5vdyhiYWxhbmNlc1tfb3duZXJdLCBwcmV2aW91c0JhbGFuY2VUbyArIF9hbW91bnQpOwogICAgVHJhbnNmZXIoMCwgX293bmVyLCBfYW1vdW50KTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgbW9kaWZpZXIgY2FuTWludCgpIHsKICAgIHJlcXVpcmUoIW1pbnRpbmdGaW5pc2hlZCk7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEltcG9ydCBwcmVzYWxlIGJhbGFuY2VzIGJlZm9yZSB0aGUgc3RhcnQgb2YgdGhlIHRva2VuIHNhbGUuIEFmdGVyIGltcG9ydGluZwogICAqIGJhbGFuY2VzLCBsb2NrUHJlc2FsZUJhbGFuY2VzKCkgaGFzIHRvIGJlIGNhbGxlZCB0byBwcmV2ZW50IGZ1cnRoZXIgbW9kaWZpY2F0aW9uCiAgICogb2YgcHJlc2FsZSBiYWxhbmNlcy4KICAgKiBAcGFyYW0gX2FkZHJlc3NlcyB7YWRkcmVzc1tdfSBBcnJheSBvZiBwcmVzYWxlIGFkZHJlc3NlcwogICAqIEBwYXJhbSBfYmFsYW5jZXMge3VpbnQyNTZbXX0gQXJyYXkgb2YgYmFsYW5jZXMgY29ycmVzcG9uZGluZyB0byBwcmVzYWxlIGFkZHJlc3Nlcy4KICAgKiBAcmV0dXJuIHN1Y2Nlc3Mge2Jvb2x9CiAgICovCiAgZnVuY3Rpb24gaW1wb3J0UHJlc2FsZUJhbGFuY2VzKGFkZHJlc3NbXSBfYWRkcmVzc2VzLCB1aW50MjU2W10gX2JhbGFuY2VzKSBwdWJsaWMgb25seUNvbnRyb2xsZXIgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShwcmVzYWxlQmFsYW5jZXNMb2NrZWQgPT0gZmFsc2UpOwoKICAgIGZvciAodWludDI1NiBpID0gMDsgaSA8IF9hZGRyZXNzZXMubGVuZ3RoOyBpKyspIHsKICAgICAgdXBkYXRlVmFsdWVBdE5vdyhiYWxhbmNlc1tfYWRkcmVzc2VzW2ldXSwgX2JhbGFuY2VzW2ldKTsKICAgICAgVHJhbnNmZXIoMCwgX2FkZHJlc3Nlc1tpXSwgX2JhbGFuY2VzW2ldKTsKICAgIH0KCiAgICB1cGRhdGVWYWx1ZUF0Tm93KHRvdGFsU3VwcGx5SGlzdG9yeSwgVE9UQUxfUFJFU0FMRV9UT0tFTlMpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBMb2NrIHByZXNhbGUgYmFsYW5jZXMgYWZ0ZXIgc3VjY2Vzc2Z1bCBwcmVzYWxlIGJhbGFuY2UgaW1wb3J0CiAgICogQHJldHVybiBBIGJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBsb2NrUHJlc2FsZUJhbGFuY2VzKCkgcHVibGljIG9ubHlDb250cm9sbGVyIHJldHVybnMgKGJvb2wpIHsKICAgIHByZXNhbGVCYWxhbmNlc0xvY2tlZCA9IHRydWU7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIExvY2sgdGhlIG1pbnRpbmcgb2YgU2VydnVzIFRva2VucyAtIHRvIGJlIGNhbGxlZCBhZnRlciB0aGUgcHJlc2FsZQogICAqIEByZXR1cm4ge2Jvb2x9IHN1Y2Nlc3MKICAqLwogIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBwdWJsaWMgb25seUNvbnRyb2xsZXIgcmV0dXJucyAoYm9vbCkgewogICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgIE1pbnRGaW5pc2hlZCgpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBFbmFibGUgb3IgYmxvY2sgdHJhbnNmZXJzIC0gdG8gYmUgY2FsbGVkIGluIGNhc2Ugb2YgZW1lcmdlbmN5CiAgICogQHBhcmFtIF92YWx1ZSB7Ym9vbH0KICAqLwogIGZ1bmN0aW9uIGVuYWJsZVRyYW5zZmVycyhib29sIF92YWx1ZSkgcHVibGljIG9ubHlDb250cm9sbGVyIHsKICAgIHRyYW5zZmVyc0VuYWJsZWQgPSBfdmFsdWU7CiAgfQoKICAvKioKICAgKiBFbmFibGUgb3IgYmxvY2sgdHJhbnNmZXJzIC0gdG8gYmUgY2FsbGVkIGluIGNhc2Ugb2YgZW1lcmdlbmN5CiAgICogQHBhcmFtIF92YWx1ZSB7Ym9vbH0KICAqLwogIGZ1bmN0aW9uIGVuYWJsZU1hc3RlclRyYW5zZmVycyhib29sIF92YWx1ZSkgcHVibGljIG9ubHlDb250cm9sbGVyIHsKICAgIG1hc3RlclRyYW5zZmVyc0VuYWJsZWQgPSBfdmFsdWU7CiAgfQoKICAvKioKICAgKiBJbnRlcm5hbCBiYWxhbmNlIG1ldGhvZCAtIGdldHMgYSBjZXJ0YWluIGNoZWNrcG9pbnQgdmFsdWUgYSBhIGNlcnRhaW4gX2Jsb2NrCiAgICogQHBhcmFtIF9jaGVja3BvaW50cyB7Q2hlY2twb2ludFtdfSBMaXN0IG9mIGNoZWNrcG9pbnRzIC0gc3VwcGx5IGhpc3Rvcnkgb3IgYmFsYW5jZSBoaXN0b3J5CiAgICogQHJldHVybiB2YWx1ZSB7dWludDI1Nn0gVmFsdWUgb2YgX2NoZWNrcG9pbnRzIGF0IF9ibG9jawogICovCiAgZnVuY3Rpb24gZ2V0VmFsdWVBdChDaGVja3BvaW50W10gc3RvcmFnZSBfY2hlY2twb2ludHMsIHVpbnQyNTYgX2Jsb2NrKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7CgogICAgICBpZiAoX2NoZWNrcG9pbnRzLmxlbmd0aCA9PSAwKQogICAgICAgIHJldHVybiAwOwogICAgICAvLyBTaG9ydGN1dCBmb3IgdGhlIGFjdHVhbCB2YWx1ZQogICAgICBpZiAoX2Jsb2NrID49IF9jaGVja3BvaW50c1tfY2hlY2twb2ludHMubGVuZ3RoLTFdLmZyb21CbG9jaykKICAgICAgICByZXR1cm4gX2NoZWNrcG9pbnRzW19jaGVja3BvaW50cy5sZW5ndGgtMV0udmFsdWU7CiAgICAgIGlmIChfYmxvY2sgPCBfY2hlY2twb2ludHNbMF0uZnJvbUJsb2NrKQogICAgICAgIHJldHVybiAwOwoKICAgICAgLy8gQmluYXJ5IHNlYXJjaCBvZiB0aGUgdmFsdWUgaW4gdGhlIGFycmF5CiAgICAgIHVpbnQyNTYgbWluID0gMDsKICAgICAgdWludDI1NiBtYXggPSBfY2hlY2twb2ludHMubGVuZ3RoLTE7CiAgICAgIHdoaWxlIChtYXggPiBtaW4pIHsKICAgICAgICAgIHVpbnQyNTYgbWlkID0gKG1heCArIG1pbiArIDEpIC8gMjsKICAgICAgICAgIGlmIChfY2hlY2twb2ludHNbbWlkXS5mcm9tQmxvY2s8PV9ibG9jaykgewogICAgICAgICAgICAgIG1pbiA9IG1pZDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgbWF4ID0gbWlkLTE7CiAgICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIF9jaGVja3BvaW50c1ttaW5dLnZhbHVlOwogIH0KCgogIC8qKgogICogSW50ZXJuYWwgdXBkYXRlIG1ldGhvZCAtIHVwZGF0ZXMgdGhlIGNoZWNrcG9pbnQgbGVkZ2VyIGF0IHRoZSBjdXJyZW50IGJsb2NrCiAgKiBAcGFyYW0gX2NoZWNrcG9pbnRzIHtDaGVja3BvaW50W119ICBMaXN0IG9mIGNoZWNrcG9pbnRzIC0gc3VwcGx5IGhpc3Rvcnkgb3IgYmFsYW5jZSBoaXN0b3J5CiAgKiBAcmV0dXJuIHZhbHVlIHt1aW50MjU2fSBWYWx1ZSB0byBhZGQgdG8gdGhlIGNoZWNrcG9pbnRzIGxlZGdlcgogICAqLwogIGZ1bmN0aW9uIHVwZGF0ZVZhbHVlQXROb3coQ2hlY2twb2ludFtdIHN0b3JhZ2UgX2NoZWNrcG9pbnRzLCB1aW50MjU2IF92YWx1ZSkgaW50ZXJuYWwgewogICAgICBpZiAoKF9jaGVja3BvaW50cy5sZW5ndGggPT0gMCkgfHwgKF9jaGVja3BvaW50c1tfY2hlY2twb2ludHMubGVuZ3RoLTFdLmZyb21CbG9jayA8IGJsb2NrLm51bWJlcikpIHsKICAgICAgICAgICAgICBDaGVja3BvaW50IHN0b3JhZ2UgbmV3Q2hlY2tQb2ludCA9IF9jaGVja3BvaW50c1tfY2hlY2twb2ludHMubGVuZ3RoKytdOwogICAgICAgICAgICAgIG5ld0NoZWNrUG9pbnQuZnJvbUJsb2NrID0gdWludDEyOChibG9jay5udW1iZXIpOwogICAgICAgICAgICAgIG5ld0NoZWNrUG9pbnQudmFsdWUgPSB1aW50MTI4KF92YWx1ZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIENoZWNrcG9pbnQgc3RvcmFnZSBvbGRDaGVja1BvaW50ID0gX2NoZWNrcG9pbnRzW19jaGVja3BvaW50cy5sZW5ndGgtMV07CiAgICAgICAgICAgICAgb2xkQ2hlY2tQb2ludC52YWx1ZSA9IHVpbnQxMjgoX3ZhbHVlKTsKICAgICAgICAgIH0KICB9CgoKICBmdW5jdGlvbiBtaW4odWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7CiAgfQoKICAvKioKICAqIENsb25lcyBTZXJ2dXMgVG9rZW4gYXQgdGhlIGdpdmVuIHNuYXBzaG90IGJsb2NrCiAgKiBAcGFyYW0gX3NuYXBzaG90QmxvY2sge3VpbnQyNTZ9CiAgKiBAcGFyYW0gX25hbWUge3N0cmluZ30gLSBUaGUgY2xvbmVkIHRva2VuIG5hbWUKICAqIEBwYXJhbSBfc3ltYm9sIHtzdHJpbmd9IC0gVGhlIGNsb25lZCB0b2tlbiBzeW1ib2wKICAqIEByZXR1cm4gY2xvbmVkVG9rZW5BZGRyZXNzIHthZGRyZXNzfQogICAqLwogIGZ1bmN0aW9uIGNyZWF0ZUNsb25lVG9rZW4odWludDI1NiBfc25hcHNob3RCbG9jaywgc3RyaW5nIF9uYW1lLCBzdHJpbmcgX3N5bWJvbCkgcHVibGljIHJldHVybnMoYWRkcmVzcykgewoKICAgICAgaWYgKF9zbmFwc2hvdEJsb2NrID09IDApIHsKICAgICAgICBfc25hcHNob3RCbG9jayA9IGJsb2NrLm51bWJlcjsKICAgICAgfQoKICAgICAgaWYgKF9zbmFwc2hvdEJsb2NrID4gYmxvY2subnVtYmVyKSB7CiAgICAgICAgX3NuYXBzaG90QmxvY2sgPSBibG9jay5udW1iZXI7CiAgICAgIH0KCiAgICAgIFNlcnZ1c1Rva2VuIGNsb25lVG9rZW4gPSB0b2tlbkZhY3RvcnkuY3JlYXRlQ2xvbmVUb2tlbigKICAgICAgICAgIHRoaXMsCiAgICAgICAgICBfc25hcHNob3RCbG9jaywKICAgICAgICAgIF9uYW1lLAogICAgICAgICAgX3N5bWJvbAogICAgICAgICk7CgoKICAgICAgY2xvbmVUb2tlbi50cmFuc2ZlckNvbnRyb2wobXNnLnNlbmRlcik7CgogICAgICAvLyBBbiBldmVudCB0byBtYWtlIHRoZSB0b2tlbiBlYXN5IHRvIGZpbmQgb24gdGhlIGJsb2NrY2hhaW4KICAgICAgTmV3Q2xvbmVUb2tlbihhZGRyZXNzKGNsb25lVG9rZW4pKTsKICAgICAgcmV0dXJuIGFkZHJlc3MoY2xvbmVUb2tlbik7CiAgICB9Cgp9CgovKioKICogQHRpdGxlIFBhdXNhYmxlCiAqIEBkZXYgQmFzZSBjb250cmFjdCB3aGljaCBhbGxvd3MgY2hpbGRyZW4gdG8gaW1wbGVtZW50IGFuIGVtZXJnZW5jeSBzdG9wIG1lY2hhbmlzbS4KICovCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgewogIGV2ZW50IFBhdXNlKCk7CiAgZXZlbnQgVW5wYXVzZSgpOwoKICBib29sIHB1YmxpYyBwYXVzZWQgPSBmYWxzZTsKCiAgZnVuY3Rpb24gUGF1c2FibGUoKSBwdWJsaWMge30KCiAgLyoqCiAgICogQGRldiBtb2RpZmllciB0byBhbGxvdyBhY3Rpb25zIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgSVMgcGF1c2VkCiAgICovCiAgbW9kaWZpZXIgd2hlbk5vdFBhdXNlZCgpIHsKICAgIHJlcXVpcmUoIXBhdXNlZCk7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBtb2RpZmllciB0byBhbGxvdyBhY3Rpb25zIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgSVMgTk9UIHBhdXNlZAogICAqLwogIG1vZGlmaWVyIHdoZW5QYXVzZWQgewogICAgcmVxdWlyZShwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byBwYXVzZSwgdHJpZ2dlcnMgc3RvcHBlZCBzdGF0ZQogICAqLwogIGZ1bmN0aW9uIHBhdXNlKCkgcHVibGljIG9ubHlPd25lciB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wpIHsKICAgIHBhdXNlZCA9IHRydWU7CiAgICBQYXVzZSgpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gdW5wYXVzZSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgKi8KICBmdW5jdGlvbiB1bnBhdXNlKCkgcHVibGljIG9ubHlPd25lciB3aGVuUGF1c2VkIHJldHVybnMgKGJvb2wpIHsKICAgIHBhdXNlZCA9IGZhbHNlOwogICAgVW5wYXVzZSgpOwogICAgcmV0dXJuIHRydWU7CiAgfQp9CgovKioKICogQHRpdGxlIFRva2Vuc2FsZQogKiBUb2tlbnNhbGUgYWxsb3dzIGludmVzdG9ycyB0byBtYWtlIHRva2VuIHB1cmNoYXNlcyBhbmQgYXNzaWducyB0aGVtIHRva2VucyBiYXNlZAoKICogb24gYSB0b2tlbiBwZXIgRVRIIHJhdGUuIEZ1bmRzIGNvbGxlY3RlZCBhcmUgZm9yd2FyZGVkIHRvIGEgd2FsbGV0IGFzIHRoZXkgYXJyaXZlLgogKi8KY29udHJhY3QgVG9rZW5TYWxlIGlzIFBhdXNhYmxlIHsKCiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIFNlcnZ1c1Rva2VuSW50ZXJmYWNlIHB1YmxpYyBzZXJ2dXNUb2tlbjsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFdlaVJhaXNlZDsKICB1aW50MjU2IHB1YmxpYyB0b2tlbnNNaW50ZWQ7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgdWludDI1NiBwdWJsaWMgY29udHJpYnV0b3JzOwogIHVpbnQyNTYgcHVibGljIGRlY2ltYWxzTXVsdGlwbGllcjsKICB1aW50MjU2IHB1YmxpYyBzdGFydFRpbWU7CiAgdWludDI1NiBwdWJsaWMgZW5kVGltZTsKICB1aW50MjU2IHB1YmxpYyByZW1haW5pbmdUb2tlbnM7CiAgdWludDI1NiBwdWJsaWMgYWxsb2NhdGVkVG9rZW5zOwoKICBib29sIHB1YmxpYyBmaW5hbGl6ZWQ7CgogIGJvb2wgcHVibGljIHNlcnZ1c1Rva2Vuc0FsbG9jYXRlZDsKICBhZGRyZXNzIHB1YmxpYyBzZXJ2dXNNdWx0aVNpZyA9IDB4MGNjM2UwOWM4YTUyZmEwMzEzMTU0MzIxYmU3MDY2MzVjZGJkZWMzNzsKCiAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgQkFTRV9QUklDRV9JTl9XRUkgPSAxMDAwMDAwMDAwMDAwMDAwOwogIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IFBVQkxJQ19UT0tFTlMgPSAxMDAwMDAwMDAgKiAoMTAgKiogNik7CiAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgVE9UQUxfUFJFU0FMRV9UT0tFTlMgPSA1MDAwMDAwMCAqICgxMCAqKiA2KTsKICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBUT0tFTlNfQUxMT0NBVEVEX1RPX1NFUlZVUyA9IDEwMDAwMDAwMCAqICgxMCAqKiA2KTsKCgoKICB1aW50MjU2IHB1YmxpYyB0b2tlbkNhcCA9IFBVQkxJQ19UT0tFTlMgLSBUT1RBTF9QUkVTQUxFX1RPS0VOUzsKICB1aW50MjU2IHB1YmxpYyBjYXAgPSB0b2tlbkNhcDsKICB1aW50MjU2IHB1YmxpYyB3ZWlDYXAgPSBjYXAgKiBCQVNFX1BSSUNFX0lOX1dFSTsKCiAgdWludDI1NiBwdWJsaWMgZmlyc3REaXNjb3VudFByaWNlID0gKEJBU0VfUFJJQ0VfSU5fV0VJICogODUpIC8gMTAwOwogIHVpbnQyNTYgcHVibGljIHNlY29uZERpc2NvdW50UHJpY2UgPSAoQkFTRV9QUklDRV9JTl9XRUkgKiA5MCkgLyAxMDA7CiAgdWludDI1NiBwdWJsaWMgdGhpcmREaXNjb3VudFByaWNlID0gKEJBU0VfUFJJQ0VfSU5fV0VJICogOTUpIC8gMTAwOwoKICB1aW50MjU2IHB1YmxpYyBmaXJzdERpc2NvdW50Q2FwID0gKHdlaUNhcCAqIDUpIC8gMTAwOwogIHVpbnQyNTYgcHVibGljIHNlY29uZERpc2NvdW50Q2FwID0gKHdlaUNhcCAqIDEwKSAvIDEwMDsKICB1aW50MjU2IHB1YmxpYyB0aGlyZERpc2NvdW50Q2FwID0gKHdlaUNhcCAqIDIwKSAvIDEwMDsKCiAgYm9vbCBwdWJsaWMgc3RhcnRlZCA9IGZhbHNlOwoKICBldmVudCBUb2tlblB1cmNoYXNlKGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB2YWx1ZSwgdWludDI1NiBhbW91bnQpOwogIGV2ZW50IE5ld0Nsb25lZFRva2VuKGFkZHJlc3MgaW5kZXhlZCBfY2xvbmVUb2tlbik7CiAgZXZlbnQgT25UcmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfYW1vdW50KTsKICBldmVudCBPbkFwcHJvdmUoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2Ftb3VudCk7CiAgZXZlbnQgTG9nSW50KHN0cmluZyBfbmFtZSwgdWludDI1NiBfdmFsdWUpOwogIGV2ZW50IEZpbmFsaXplZCgpOwoKICBmdW5jdGlvbiBUb2tlblNhbGUoYWRkcmVzcyBfdG9rZW5BZGRyZXNzLCB1aW50MjU2IF9zdGFydFRpbWUsIHVpbnQyNTYgX2VuZFRpbWUpIHB1YmxpYyB7CiAgICByZXF1aXJlKF90b2tlbkFkZHJlc3MgIT0gMHgwKTsKICAgIHJlcXVpcmUoX3N0YXJ0VGltZSA+IDApOwogICAgcmVxdWlyZShfZW5kVGltZSA+IF9zdGFydFRpbWUpOwoKICAgIHN0YXJ0VGltZSA9IF9zdGFydFRpbWU7CiAgICBlbmRUaW1lID0gX2VuZFRpbWU7CiAgICBzZXJ2dXNUb2tlbiA9IFNlcnZ1c1Rva2VuSW50ZXJmYWNlKF90b2tlbkFkZHJlc3MpOwoKICAgIGRlY2ltYWxzTXVsdGlwbGllciA9ICgxMCAqKiA2KTsKICB9CgoKICAvKioKICAgKiBIaWdoIGxldmVsIHRva2VuIHB1cmNoYXNlIGZ1bmN0aW9uCiAgICovCiAgZnVuY3Rpb24oKSBwdWJsaWMgcGF5YWJsZSB7CiAgICBidXlUb2tlbnMobXNnLnNlbmRlcik7CiAgfQoKICAvKioKICAgKiBMb3cgbGV2ZWwgdG9rZW4gcHVyY2hhc2UgZnVuY3Rpb24KICAgKiBAcGFyYW0gX2JlbmVmaWNpYXJ5IHdpbGwgcmVjZWl2ZSB0aGUgdG9rZW5zLgogICAqLwogIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIF9iZW5lZmljaWFyeSkgcHVibGljIHBheWFibGUgd2hlbk5vdFBhdXNlZCB3aGVuTm90RmluYWxpemVkIHsKICAgIHJlcXVpcmUoX2JlbmVmaWNpYXJ5ICE9IDB4MCk7CiAgICByZXF1aXJlKHZhbGlkUHVyY2hhc2UoKSk7CgogICAgdWludDI1NiB3ZWlBbW91bnQgPSBtc2cudmFsdWU7CiAgICB1aW50MjU2IHByaWNlSW5XZWkgPSBnZXRQcmljZUluV2VpKCk7CiAgICB0b3RhbFdlaVJhaXNlZCA9IHRvdGFsV2VpUmFpc2VkLmFkZCh3ZWlBbW91bnQpOwoKICAgIHVpbnQyNTYgdG9rZW5zID0gd2VpQW1vdW50Lm11bChkZWNpbWFsc011bHRpcGxpZXIpLmRpdihwcmljZUluV2VpKTsKICAgIHRva2Vuc01pbnRlZCA9IHRva2Vuc01pbnRlZC5hZGQodG9rZW5zKTsKICAgIHJlcXVpcmUodG9rZW5zTWludGVkIDwgdG9rZW5DYXApOwoKICAgIGNvbnRyaWJ1dG9ycyA9IGNvbnRyaWJ1dG9ycy5hZGQoMSk7CgogICAgc2VydnVzVG9rZW4ubWludChfYmVuZWZpY2lhcnksIHRva2Vucyk7CiAgICBUb2tlblB1cmNoYXNlKG1zZy5zZW5kZXIsIF9iZW5lZmljaWFyeSwgd2VpQW1vdW50LCB0b2tlbnMpOwogICAgZm9yd2FyZEZ1bmRzKCk7CiAgfQoKCiAgLyoqCiAgICogR2V0IHRoZSBwcmljZSBpbiB3ZWkgZm9yIGN1cnJlbnQgcHJlbWl1bQogICAqIEByZXR1cm4gcHJpY2Uge3VpbnQyNTZ9CiAgICovCiAgZnVuY3Rpb24gZ2V0UHJpY2VJbldlaSgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KSB7CgogICAgdWludDI1NiBwcmljZTsKCiAgICBpZiAodG90YWxXZWlSYWlzZWQgPCBmaXJzdERpc2NvdW50Q2FwKSB7CiAgICAgIHByaWNlID0gZmlyc3REaXNjb3VudFByaWNlOwogICAgfSBlbHNlIGlmICh0b3RhbFdlaVJhaXNlZCA8IHNlY29uZERpc2NvdW50Q2FwKSB7CiAgICAgIHByaWNlID0gc2Vjb25kRGlzY291bnRQcmljZTsKICAgIH0gZWxzZSBpZiAodG90YWxXZWlSYWlzZWQgPCB0aGlyZERpc2NvdW50Q2FwKSB7CiAgICAgIHByaWNlID0gdGhpcmREaXNjb3VudFByaWNlOwogICAgfSBlbHNlIHsKICAgICAgcHJpY2UgPSBCQVNFX1BSSUNFX0lOX1dFSTsKICAgIH0KCiAgICByZXR1cm4gcHJpY2U7CiAgfQoKICAvKioKICAqIEZvcndhcmRzIGZ1bmRzIHRvIHRoZSB0b2tlbnNhbGUgd2FsbGV0CiAgKi8KICBmdW5jdGlvbiBmb3J3YXJkRnVuZHMoKSBpbnRlcm5hbCB7CiAgICBzZXJ2dXNNdWx0aVNpZy50cmFuc2Zlcihtc2cudmFsdWUpOwogIH0KCgogIC8qKgogICogVmFsaWRhdGVzIHRoZSBwdXJjaGFzZSAocGVyaW9kLCBtaW5pbXVtIGFtb3VudCwgd2l0aGluIGNhcCkKICAqIEByZXR1cm4ge2Jvb2x9IHZhbGlkCiAgKi8KICBmdW5jdGlvbiB2YWxpZFB1cmNoYXNlKCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgdWludDI1NiBjdXJyZW50ID0gbm93OwogICAgYm9vbCBwcmVzYWxlU3RhcnRlZCA9IChjdXJyZW50ID49IHN0YXJ0VGltZSB8fCBzdGFydGVkKTsKICAgIGJvb2wgcHJlc2FsZU5vdEVuZGVkID0gY3VycmVudCA8PSBlbmRUaW1lOwogICAgYm9vbCBub25aZXJvUHVyY2hhc2UgPSBtc2cudmFsdWUgIT0gMDsKICAgIHJldHVybiBub25aZXJvUHVyY2hhc2UgJiYgcHJlc2FsZVN0YXJ0ZWQgJiYgcHJlc2FsZU5vdEVuZGVkOwogIH0KCiAgLyoqCiAgKiBSZXR1cm5zIHRoZSB0b3RhbCBTZXJ2dXMgdG9rZW4gc3VwcGx5CiAgKiBAcmV0dXJuIHRvdGFsU3VwcGx5IHt1aW50MjU2fSBTZXJ2dXMgVG9rZW4gVG90YWwgU3VwcGx5CiAgKi8KICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gc2VydnVzVG9rZW4udG90YWxTdXBwbHkoKTsKICB9CgogIC8qKgogICogUmV0dXJucyB0b2tlbiBob2xkZXIgU2VydnVzIFRva2VuIGJhbGFuY2UKICAqIEBwYXJhbSBfb3duZXIge2FkZHJlc3N9IFRva2VuIGhvbGRlciBhZGRyZXNzCiAgKiBAcmV0dXJuIGJhbGFuY2Uge3VpbnQyNTZ9IENvcnJlc3BvbmRpbmcgdG9rZW4gaG9sZGVyIGJhbGFuY2UKICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiBzZXJ2dXNUb2tlbi5iYWxhbmNlT2YoX293bmVyKTsKICB9CgogIC8qKgogICogQ2hhbmdlIHRoZSBTZXJ2dXMgVG9rZW4gY29udHJvbGxlcgogICogQHBhcmFtIF9uZXdDb250cm9sbGVyIHthZGRyZXNzfSBOZXcgU2VydnVzIFRva2VuIGNvbnRyb2xsZXIKICAqLwogIGZ1bmN0aW9uIGNoYW5nZUNvbnRyb2xsZXIoYWRkcmVzcyBfbmV3Q29udHJvbGxlcikgcHVibGljIHsKICAgIHJlcXVpcmUoaXNDb250cmFjdChfbmV3Q29udHJvbGxlcikpOwogICAgc2VydnVzVG9rZW4udHJhbnNmZXJDb250cm9sKF9uZXdDb250cm9sbGVyKTsKICB9CgoKICBmdW5jdGlvbiBlbmFibGVUcmFuc2ZlcnMoKSBwdWJsaWMgewogICAgaWYgKG5vdyA8IGVuZFRpbWUpIHsKICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIH0KICAgIHNlcnZ1c1Rva2VuLmVuYWJsZVRyYW5zZmVycyh0cnVlKTsKICB9CgogIGZ1bmN0aW9uIGxvY2tUcmFuc2ZlcnMoKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobm93IDwgZW5kVGltZSk7CiAgICBzZXJ2dXNUb2tlbi5lbmFibGVUcmFuc2ZlcnMoZmFsc2UpOwogIH0KCiAgZnVuY3Rpb24gZW5hYmxlTWFzdGVyVHJhbnNmZXJzKCkgcHVibGljIG9ubHlPd25lciB7CiAgICBzZXJ2dXNUb2tlbi5lbmFibGVNYXN0ZXJUcmFuc2ZlcnModHJ1ZSk7CiAgfQoKICBmdW5jdGlvbiBsb2NrTWFzdGVyVHJhbnNmZXJzKCkgcHVibGljIG9ubHlPd25lciB7CiAgICBzZXJ2dXNUb2tlbi5lbmFibGVNYXN0ZXJUcmFuc2ZlcnMoZmFsc2UpOwogIH0KCiAgZnVuY3Rpb24gZm9yY2VTdGFydCgpIHB1YmxpYyBvbmx5T3duZXIgewogICAgc3RhcnRlZCA9IHRydWU7CiAgfQoKICBmdW5jdGlvbiBhbGxvY2F0ZVNlcnZ1c1Rva2VucygpIHB1YmxpYyBvbmx5T3duZXIgd2hlbk5vdEZpbmFsaXplZCB7CiAgICByZXF1aXJlKCFzZXJ2dXNUb2tlbnNBbGxvY2F0ZWQpOwogICAgc2VydnVzVG9rZW4ubWludChzZXJ2dXNNdWx0aVNpZywgVE9LRU5TX0FMTE9DQVRFRF9UT19TRVJWVVMpOwogICAgc2VydnVzVG9rZW5zQWxsb2NhdGVkID0gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGZpbmFsaXplKCkgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKHBhdXNlZCk7CiAgICByZXF1aXJlKHNlcnZ1c1Rva2Vuc0FsbG9jYXRlZCk7CgogICAgc2VydnVzVG9rZW4uZmluaXNoTWludGluZygpOwogICAgc2VydnVzVG9rZW4uZW5hYmxlVHJhbnNmZXJzKHRydWUpOwogICAgRmluYWxpemVkKCk7CgogICAgZmluYWxpemVkID0gdHJ1ZTsKICB9CgoKICBmdW5jdGlvbiBpc0NvbnRyYWN0KGFkZHJlc3MgX2FkZHIpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMoYm9vbCkgewogICAgdWludCBzaXplOwogICAgaWYgKF9hZGRyID09IDApCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGFzc2VtYmx5IHsKICAgICAgICBzaXplIDo9IGV4dGNvZGVzaXplKF9hZGRyKQogICAgfQogICAgcmV0dXJuIHNpemU+MDsKICB9CgogIG1vZGlmaWVyIHdoZW5Ob3RGaW5hbGl6ZWQoKSB7CiAgICByZXF1aXJlKCFmaW5hbGl6ZWQpOwogICAgXzsKICB9Cgp9'.
	

]
