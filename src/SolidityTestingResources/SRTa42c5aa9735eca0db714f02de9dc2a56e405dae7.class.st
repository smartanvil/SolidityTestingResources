Class {
	#name : #SRTa42c5aa9735eca0db714f02de9dc2a56e405dae7,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTa42c5aa9735eca0db714f02de9dc2a56e405dae7 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4gMC40LjE2Owpjb250cmFjdCBvd25lZCB7CiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gIGJvb2wpIHB1YmxpYyBhZG1pbnM7CgogICAgZnVuY3Rpb24gb3duZWQoKSB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIGFkbWluc1ttc2cuc2VuZGVyXT10cnVlOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlBZG1pbiAgIHsKICAgICAgICByZXF1aXJlKGFkbWluc1ttc2cuc2VuZGVyXSA9PSB0cnVlKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciB7CiAgICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgIH0KICAgIGZ1bmN0aW9uIG1ha2VBZG1pbihhZGRyZXNzIG5ld0FkbWluLCBib29sIGlzQWRtaW4pIG9ubHlPd25lciB7CiAgICAgICAgYWRtaW5zW25ld0FkbWluXSA9IGlzQWRtaW47CiAgICB9Cn0KCmludGVyZmFjZSB0b2tlblJlY2lwaWVudCB7CiAgICBmdW5jdGlvbiByZWNlaXZlQXBwcm92YWwoYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdmFsdWUsIGFkZHJlc3MgX3Rva2VuLCBieXRlcyBfZXh0cmFEYXRhKTsKfQoKY29udHJhY3QgQkNUIGlzIG93bmVkIHsKICAgIC8vIFB1YmxpYyB2YXJpYWJsZXMgb2YgdGhlIHRva2VuCiAgICBzdHJpbmcgcHVibGljIG5hbWU7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsKICAgIHVpbnQ4IHB1YmxpYyBkZWNpbWFsczsKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogICAgdWludDI1NiBtaW5CYWxhbmNlRm9yQWNjb3VudHM7CiAgICBib29sIHB1YmxpYyB1c2Vyc0NhblRyYWRlOwogICAgYm9vbCBwdWJsaWMgdXNlcnNDYW5VbmZyZWV6ZTsKCiAgICBib29sIHB1YmxpYyBpY28gPSB0cnVlOyAvL3R1cm4gaWNvIG9uIGFuZCBvZgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgYWRtaW47CgoKICAgIG1vZGlmaWVyIG5vdElDTyB7CiAgICAgICAgcmVxdWlyZShhZG1pblttc2cuc2VuZGVyXSB8fCAhaWNvKTsKICAgICAgICBfOwogICAgfQoKCiAgICAvLyBUaGlzIGNyZWF0ZXMgYW4gYXJyYXkgd2l0aCBhbGwgYmFsYW5jZXMKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGJhbGFuY2VPZjsKCgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBwdWJsaWMgYWxsb3dhbmNlOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiAgYm9vbCkgcHVibGljIGZyb3plbjsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+ICBib29sKSBwdWJsaWMgY2FuVHJhZGU7IC8vdXNlciBhbGxvd2VkIHRvIGJ1eSBvciBzZWxsCgogICAgLy8gVGhpcyBnZW5lcmF0ZXMgYSBwdWJsaWMgZXZlbnQgb24gdGhlIGJsb2NrY2hhaW4gdGhhdCB3aWxsIG5vdGlmeSBjbGllbnRzCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKCiAgICAvL1RoaXMgZ2VuZXJhdGVzIGEgcHVibGljIGV2ZW4gb24gdGhlIGJsb2NraGNhaW4gd2hlbiBhbiBhZGRyZXNzIGlzIHJld2FyZAogICAgZXZlbnQgUmV3YXJkKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSwgc3RyaW5nIGRhdGEsIHVpbnQyNTYgdGltZSk7CgogICAgLy8gVGhpcyBub3RpZmllcyBjbGllbnRzIGFib3V0IHRoZSBhbW91bnQgYnVybnQKICAgIGV2ZW50IEJ1cm4oYWRkcmVzcyBpbmRleGVkIGZyb20sIHVpbnQyNTYgdmFsdWUpOwoKICAgIC8vIFRoaXMgZ2VuZXJhdGVzIGEgcHVibGljIGV2ZW50IG9uIHRoZSBibG9ja2NoYWluIHRoYXQgd2lsbCBub3RpZnkgY2xpZW50cwogICAgZXZlbnQgRnJvemVuKGFkZHJlc3MgaW5kZXhlZCBhZGRyLCBib29sIGZyb3plbik7CgogICAgLy8gVGhpcyBnZW5lcmF0ZXMgYSBwdWJsaWMgZXZlbnQgb24gdGhlIGJsb2NrY2hhaW4gdGhhdCB3aWxsIG5vdGlmeSBjbGllbnRzCiAgICBldmVudCBVbmxvY2soYWRkcmVzcyBpbmRleGVkIGFkZHIsIGFkZHJlc3MgZnJvbSwgdWludDI1NiB2YWwpOwoKICAgIC8vIFRoaXMgZ2VuZXJhdGVzIGEgcHVibGljIGV2ZW50IG9uIHRoZSBibG9ja2NoYWluIHRoYXQgd2lsbCBub3RpZnkgY2xpZW50cwoKCiAgICAvLyBUaGlzIGdlbmVyYXRlcyBhIHB1YmxpYyBldmVudCBvbiB0aGUgYmxvY2tjaGFpbiB0aGF0IHdpbGwgbm90aWZ5IGNsaWVudHMKICAgIC8vIGV2ZW50IFVuZnJlZXplKGFkZHJlc3MgaW5kZXhlZCBhZGRyKTsKCiAgICAvKioKICAgICAqIENvbnN0cmN0b3IgZnVuY3Rpb24KICAgICAqCiAgICAgKiBJbml0aWFsaXplcyBjb250cmFjdCB3aXRoIGluaXRpYWwgc3VwcGx5IHRva2VucyB0byB0aGUgY3JlYXRvciBvZiB0aGUgY29udHJhY3QKICAgICAqLwogICAgZnVuY3Rpb24gQkNUKCkgewogICAgICAgIHVpbnQyNTYgaW5pdGlhbFN1cHBseSA9IDIwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwOwogICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSA9IGluaXRpYWxTdXBwbHkgOyAgICAgICAgICAgICAgLy8gR2l2ZSB0aGUgY3JlYXRvciBhbGwgaW5pdGlhbCB0b2tlbnMKICAgICAgICB0b3RhbFN1cHBseSA9IGluaXRpYWxTdXBwbHk7ICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRvdGFsIHN1cHBseQogICAgICAgIG5hbWUgPSAiQm90Q29ubmVjdCI7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIG5hbWUgZm9yIGRpc3BsYXkgcHVycG9zZXMKICAgICAgICBzeW1ib2wgPSAiQkNUIjsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSBzeW1ib2wgZm9yIGRpc3BsYXkgcHVycG9zZXMKICAgICAgICBkZWNpbWFscyA9IDE4OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBbW91bnQgb2YgZGVjaW1hbHMgZm9yIGRpc3BsYXkgcHVycG9zZXMKICAgICAgICBtaW5CYWxhbmNlRm9yQWNjb3VudHMgPSAxMDAwMDAwMDAwMDAwMDAwOwogICAgICAgIHVzZXJzQ2FuVHJhZGU9ZmFsc2U7CiAgICAgICAgdXNlcnNDYW5VbmZyZWV6ZT1mYWxzZTsKICAgICAgICBhZG1pblttc2cuc2VuZGVyXT10cnVlOwogICAgICAgIGNhblRyYWRlW21zZy5zZW5kZXJdPXRydWU7CgogICAgfQoKICAgIC8qKgogICAgICogSW5jcmVhY2UgVG90YWwgU3VwcGx5CiAgICAgKgogICAgICogSW5jcmVhc2VzIHRoZSB0b3RhbCBjb2luIHN1cHBseQogICAgICovCiAgICBmdW5jdGlvbiBpbmNyZWFzZVRvdGFsU3VwcGx5IChhZGRyZXNzIHRhcmdldCwgIHVpbnQyNTYgaW5jcmVhc2VCeSApICBvbmx5T3duZXIgewogICAgICAgIGJhbGFuY2VPZlt0YXJnZXRdICs9IGluY3JlYXNlQnk7CiAgICAgICAgdG90YWxTdXBwbHkgKz0gaW5jcmVhc2VCeTsKICAgICAgICBUcmFuc2ZlcigwLCBvd25lciwgaW5jcmVhc2VCeSk7CiAgICAgICAgVHJhbnNmZXIob3duZXIsIHRhcmdldCwgaW5jcmVhc2VCeSk7CiAgICB9CgogICAgZnVuY3Rpb24gIHVzZXJzQ2FuVW5GcmVlemUoYm9vbCBjYW4pIHsKICAgICAgICB1c2Vyc0NhblVuZnJlZXplPWNhbjsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRNaW5CYWxhbmNlKHVpbnQgbWluaW11bUJhbGFuY2VJbldlaSkgb25seU93bmVyIHsKICAgICAgICBtaW5CYWxhbmNlRm9yQWNjb3VudHMgPSBtaW5pbXVtQmFsYW5jZUluV2VpOwogICAgfQoKICAgIC8qKgogICAgICogdHJhbnNmZXJBbmRGcmVlemUKICAgICAqCiAgICAgKiBGdW5jdGlvbiB0byB0cmFuc2ZlciB0byBhbmQgZnJlZXplIGFuZCBhY2NvdW50IGF0IHRoZSBzYW1lIHRpbWUKICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJBbmRGcmVlemUgKGFkZHJlc3MgdGFyZ2V0LCAgdWludDI1NiBhbW91bnQgKSAgb25seUFkbWluIHsKICAgICAgICBfdHJhbnNmZXIobXNnLnNlbmRlciwgdGFyZ2V0LCBhbW91bnQpOwogICAgICAgIGZyZWV6ZSh0YXJnZXQsIHRydWUpOwogICAgfQoKICAgIC8qKgogICAgICogX2ZyZWV6ZSBpbnRlcm5hbAogICAgICoKICAgICAqIGZ1bmN0aW9uIHRvIGZyZWV6ZSBhbiBhY2NvdW50CiAgICAgKi8KICAgIGZ1bmN0aW9uIF9mcmVlemUgKGFkZHJlc3MgdGFyZ2V0LCBib29sIGZyb3plICkgIGludGVybmFsICB7CgogICAgICAgIGZyb3plblt0YXJnZXRdPWZyb3plOwogICAgICAgIEZyb3plbih0YXJnZXQsIGZyb3plKTsKICAgIH0KCgoKICAgIC8qKgogICAgICogZnJlZXplCiAgICAgKgogICAgICogZnVuY3Rpb24gdG8gZnJlZXplIGFuIGFjY291bnQKICAgICAqLwogICAgZnVuY3Rpb24gZnJlZXplIChhZGRyZXNzIHRhcmdldCwgYm9vbCBmcm96ZSApICAgewogICAgICAgIGlmKGZyb3plIHx8ICghZnJvemUgJiYgIXVzZXJzQ2FuVW5mcmVlemUpKSB7CiAgICAgICAgICAgIHJlcXVpcmUoYWRtaW5bbXNnLnNlbmRlcl0pOwogICAgICAgIH0KCiAgICAgICAgX2ZyZWV6ZSh0YXJnZXQsIGZyb3plKTsKICAgIH0KCgoKICAgIC8qKgogICAgICogSW50ZXJuYWwgdHJhbnNmZXIsIG9ubHkgY2FuIGJlIGNhbGxlZCBieSB0aGlzIGNvbnRyYWN0CiAgICAgKi8KICAgIGZ1bmN0aW9uIF90cmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIGludGVybmFsIHsKICAgICAgICByZXF1aXJlKF90byAhPSAweDApOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUHJldmVudCB0cmFuc2ZlciB0byAweDAgYWRkcmVzcy4gVXNlIGJ1cm4oKSBpbnN0ZWFkCgogICAgICAgIHJlcXVpcmUoIWZyb3plbltfZnJvbV0pOyAgICAgICAgICAgICAgICAgICAgICAgLy9wcmV2ZW50IHRyYW5zZmVyIGZyb20gZnJvemVuIGFkZHJlc3MKICAgICAgICByZXF1aXJlKGJhbGFuY2VPZltfZnJvbV0gPj0gX3ZhbHVlKTsgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHNlbmRlciBoYXMgZW5vdWdoCiAgICAgICAgcmVxdWlyZShiYWxhbmNlT2ZbX3RvXSArIF92YWx1ZSA+IGJhbGFuY2VPZltfdG9dKTsgLy8gQ2hlY2sgZm9yIG92ZXJmbG93cwogICAgICAgIGJhbGFuY2VPZltfZnJvbV0gLT0gX3ZhbHVlOyAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTdWJ0cmFjdCBmcm9tIHRoZSBzZW5kZXIKICAgICAgICBiYWxhbmNlT2ZbX3RvXSArPSBfdmFsdWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHRoZSBzYW1lIHRvIHRoZSByZWNpcGllbnQKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgICogVHJhbnNmZXIgdG9rZW5zCiAgICAgKgogICAgICogU2VuZCBgX3ZhbHVlYCB0b2tlbnMgdG8gYF90b2AgZnJvbSB5b3VyIGFjY291bnQKICAgICAqCiAgICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQKICAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIGFtb3VudCB0byBzZW5kCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgbm90SUNPIHsKICAgICAgICByZXF1aXJlKCFmcm96ZW5bbXNnLnNlbmRlcl0pOyAgICAgICAgICAgICAgICAgICAgICAgLy9wcmV2ZW50IHRyYW5zZmVyIGZyb20gZnJvemVuIGFkZHJlc3MKICAgICAgICBpZiAobXNnLnNlbmRlci5iYWxhbmNlICA8IG1pbkJhbGFuY2VGb3JBY2NvdW50cykgewogICAgICAgICAgICBzZWxsKChtaW5CYWxhbmNlRm9yQWNjb3VudHMgLSBtc2cuc2VuZGVyLmJhbGFuY2UpICogc2VsbFByaWNlKTsKICAgICAgICB9CiAgICAgICAgX3RyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIH0KCgoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIHRvdGFsTG9ja2VkUmV3YXJkc09mOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBwdWJsaWMgbG9ja2VkUmV3YXJkc09mOyAvL2JhbGFuY2Ugb2YgYSBsb2NrZWQgcmV3YXJkCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKHVpbnQzMiAgPT4gYWRkcmVzcykpIHB1YmxpYyB1c2VyUmV3YXJkZXJzOyAvL2luZGV4ZWQgbGlzdCBvZiByZXdhcmRlZXMgcmV3YXJkZXIKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MzIpKSBwdWJsaWMgdXNlclJld2FyZENvdW50OyAvL2EgbGlzdCBvZiBudW1iZXIgb2YgdGltZXMgYSBjdXN0b21lciBoYXMgcmVjZWl2ZWQgcmV3YXJkIGZyb20gYSBnaXZlbiBtZXJjaGFudAogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MzIpIHB1YmxpYyB1c2VyUmV3YXJkZXJDb3VudDsgLy9udW1iZXIgb2YgcmV3YXJkZXJzIHBlciBjdXN0b21lcgoKICAgIC8vbWVyY2hhbnQKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gIHVpbnQyNTYgICkgcHVibGljIHRvdGFsUmV3YXJkSXNzdWVkT3V0OwoKICAgIC8qKgogICAgICogUmV3YXJkIHRva2VucyAtIHRva2VucyBnbyB0bwogICAgICoKICAgICAqIFNlbmQgYF92YWx1ZWAgdG9rZW5zIHRvIGBfdG9gIGZyb20geW91ciBhY2NvdW50CiAgICAgKgogICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICAgKiBAcGFyYW0gX3ZhbHVlIHRoZSBhbW91bnQgdG8gc2VuZAogICAgICovCiAgICBmdW5jdGlvbiByZXdhcmQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlLCBib29sIGxvY2tlZCwgc3RyaW5nIGRhdGEpIHsKICAgICAgICByZXF1aXJlKF90byAhPSAweDApOwogICAgICAgIHJlcXVpcmUoIWZyb3plblttc2cuc2VuZGVyXSk7ICAgICAgICAgICAgICAgICAgICAgICAvL3ByZXZlbnQgdHJhbnNmZXIgZnJvbSBmcm96ZW4gYWRkcmVzcwogICAgICAgIGlmIChtc2cuc2VuZGVyLmJhbGFuY2UgIDwgbWluQmFsYW5jZUZvckFjY291bnRzKSB7CiAgICAgICAgICAgIHNlbGwoKG1pbkJhbGFuY2VGb3JBY2NvdW50cyAtIG1zZy5zZW5kZXIuYmFsYW5jZSkgKiBzZWxsUHJpY2UpOwogICAgICAgIH0KICAgICAgICBpZighbG9ja2VkKSB7CiAgICAgICAgICAgIF90cmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAgIC8vcHJldmVudCB0cmFuc2ZlciBmcm9tIGZyb3plbiBhZGRyZXNzCiAgICAgICAgICAgIHJlcXVpcmUoYmFsYW5jZU9mW21zZy5zZW5kZXJdID49IF92YWx1ZSk7ICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBzZW5kZXIgaGFzIGVub3VnaAogICAgICAgICAgICByZXF1aXJlKHRvdGFsTG9ja2VkUmV3YXJkc09mW190b10gKyBfdmFsdWUgPiB0b3RhbExvY2tlZFJld2FyZHNPZltfdG9dKTsgLy8gQ2hlY2sgZm9yIG92ZXJmbG93cwogICAgICAgICAgICBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOyAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTdWJ0cmFjdCBmcm9tIHRoZSBzZW5kZXIKICAgICAgICAgICAgdG90YWxMb2NrZWRSZXdhcmRzT2ZbX3RvXSArPSBfdmFsdWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHRoZSBzYW1lIHRvIHRoZSByZWNpcGllbnQKICAgICAgICAgICAgbG9ja2VkUmV3YXJkc09mW190b11bbXNnLnNlbmRlcl0gKz0gX3ZhbHVlOwogICAgICAgICAgICBpZih1c2VyUmV3YXJkQ291bnRbX3RvXVttc2cuc2VuZGVyXT09MCkgewogICAgICAgICAgICAgICAgdXNlclJld2FyZGVyQ291bnRbX3RvXSArPSAxOwogICAgICAgICAgICAgICAgdXNlclJld2FyZGVyc1tfdG9dW3VzZXJSZXdhcmRlckNvdW50W190b11dPW1zZy5zZW5kZXI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdXNlclJld2FyZENvdW50W190b11bbXNnLnNlbmRlcl0rPTE7CiAgICAgICAgICAgIHRvdGFsUmV3YXJkSXNzdWVkT3V0W21zZy5zZW5kZXJdKz0gX3ZhbHVlOwogICAgICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgfQoKICAgICAgICBSZXdhcmQobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUsIGRhdGEsIG5vdyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUcmFuc2ZlciBsb2NrZWQgcmV3YXJkcwogICAgICoKICAgICAqIFNlbmQgYF92YWx1ZWAgdG9rZW5zIHRvIGBfdG9gIG1lcmNoYW50CiAgICAgKgogICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50CiAgICAgKiBAcGFyYW0gX3ZhbHVlIHRoZSBhbW91bnQgdG8gc2VuZAogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlclJld2FyZChhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHsKICAgICAgICByZXF1aXJlKCFmcm96ZW5bbXNnLnNlbmRlcl0pOyAgICAgICAgICAgICAgICAgICAgICAgLy9wcmV2ZW50IHRyYW5zZmVyIGZyb20gZnJvemVuIGFkZHJlc3MKICAgICAgICByZXF1aXJlKGxvY2tlZFJld2FyZHNPZlttc2cuc2VuZGVyXVtfdG9dID49IF92YWx1ZSApOwogICAgICAgIHJlcXVpcmUodG90YWxMb2NrZWRSZXdhcmRzT2ZbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlKTsKCiAgICAgICAgaWYgKG1zZy5zZW5kZXIuYmFsYW5jZSAgPCBtaW5CYWxhbmNlRm9yQWNjb3VudHMpIHsKICAgICAgICAgICAgc2VsbCgobWluQmFsYW5jZUZvckFjY291bnRzIC0gbXNnLnNlbmRlci5iYWxhbmNlKSAqIHNlbGxQcmljZSk7CiAgICAgICAgfQogICAgICAgIHRvdGFsTG9ja2VkUmV3YXJkc09mW21zZy5zZW5kZXJdIC09IF92YWx1ZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgdGhlIHNhbWUgdG8gdGhlIHJlY2lwaWVudAogICAgICAgIGxvY2tlZFJld2FyZHNPZlttc2cuc2VuZGVyXVtfdG9dIC09IF92YWx1ZTsKICAgICAgICBiYWxhbmNlT2ZbX3RvXSArPSBfdmFsdWU7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgICogVW5sb2NrZWQgbG9ja2VkIHJld2FyZHMgYnkgbWVyY2hhbnQKICAgICAqCiAgICAgKiBVbmxvY2sgYF92YWx1ZWAgdG9rZW5zIG9mIGBhZGRgCiAgICAgKgogICAgICogQHBhcmFtIGFkZHIgVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudAogICAgICogQHBhcmFtIF92YWx1ZSB0aGUgYW1vdW50IHRvIHVubG9jawogICAgICovCiAgICBmdW5jdGlvbiB1bmxvY2tSZXdhcmQoYWRkcmVzcyBhZGRyLCB1aW50MjU2IF92YWx1ZSkgewogICAgICAgIHJlcXVpcmUodG90YWxMb2NrZWRSZXdhcmRzT2ZbYWRkcl0gPiBfdmFsdWUpOyAgICAgICAgICAgICAgICAgICAgICAgLy9wcmV2ZW50IHRyYW5zZmVyIGZyb20gZnJvemVuIGFkZHJlc3MKICAgICAgICByZXF1aXJlKGxvY2tlZFJld2FyZHNPZlthZGRyXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUgKTsKICAgICAgICBpZihfdmFsdWU9PTApIF92YWx1ZT1sb2NrZWRSZXdhcmRzT2ZbYWRkcl1bbXNnLnNlbmRlcl07CiAgICAgICAgaWYgKG1zZy5zZW5kZXIuYmFsYW5jZSAgPCBtaW5CYWxhbmNlRm9yQWNjb3VudHMpIHsKICAgICAgICAgICAgc2VsbCgobWluQmFsYW5jZUZvckFjY291bnRzIC0gbXNnLnNlbmRlci5iYWxhbmNlKSAqIHNlbGxQcmljZSk7CiAgICAgICAgfQogICAgICAgIHRvdGFsTG9ja2VkUmV3YXJkc09mW2FkZHJdIC09IF92YWx1ZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgdGhlIHNhbWUgdG8gdGhlIHJlY2lwaWVudAogICAgICAgIGxvY2tlZFJld2FyZHNPZlthZGRyXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICAgICAgYmFsYW5jZU9mW2FkZHJdICs9IF92YWx1ZTsKICAgICAgICBVbmxvY2soYWRkciwgbXNnLnNlbmRlciwgX3ZhbHVlKTsKICAgIH0KCgoKICAgIC8qKgogICAgICogVHJhbnNmZXIgdG9rZW5zIGZyb20gb3RoZXIgYWRkcmVzcwogICAgICoKICAgICAqIFNlbmQgYF92YWx1ZWAgdG9rZW5zIHRvIGBfdG9gIGluIGJlaGFsZiBvZiBgX2Zyb21gCiAgICAgKgogICAgICogQHBhcmFtIF9mcm9tIFRoZSBhZGRyZXNzIG9mIHRoZSBzZW5kZXIKICAgICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudAogICAgICogQHBhcmFtIF92YWx1ZSB0aGUgYW1vdW50IHRvIHNlbmQKICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmVxdWlyZSghZnJvemVuW19mcm9tXSk7ICAgICAgICAgICAgICAgICAgICAgICAvL3ByZXZlbnQgdHJhbnNmZXIgZnJvbSBmcm96ZW4gYWRkcmVzcwogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0pOyAgICAgLy8gQ2hlY2sgYWxsb3dhbmNlCiAgICAgICAgYWxsb3dhbmNlW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICAgICAgX3RyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgYWxsb3dhbmNlIGZvciBvdGhlciBhZGRyZXNzCiAgICAgKgogICAgICogQWxsb3dzIGBfc3BlbmRlcmAgdG8gc3BlbmQgbm8gbW9yZSB0aGFuIGBfdmFsdWVgIHRva2VucyBpbiB5b3VyIGJlaGFsZgogICAgICoKICAgICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBhdXRob3JpemVkIHRvIHNwZW5kCiAgICAgKiBAcGFyYW0gX3ZhbHVlIHRoZSBtYXggYW1vdW50IHRoZXkgY2FuIHNwZW5kCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBhbGxvd2FuY2VbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IGFsbG93YW5jZSBmb3Igb3RoZXIgYWRkcmVzcyBhbmQgbm90aWZ5CiAgICAgKgogICAgICogQWxsb3dzIGBfc3BlbmRlcmAgdG8gc3BlbmQgbm8gbW9yZSB0aGFuIGBfdmFsdWVgIHRva2VucyBpbiB5b3VyIGJlaGFsZiwgYW5kIHRoZW4gcGluZyB0aGUgY29udHJhY3QgYWJvdXQgaXQKICAgICAqCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3MgYXV0aG9yaXplZCB0byBzcGVuZAogICAgICogQHBhcmFtIF92YWx1ZSB0aGUgbWF4IGFtb3VudCB0aGV5IGNhbiBzcGVuZAogICAgICogQHBhcmFtIF9leHRyYURhdGEgc29tZSBleHRyYSBpbmZvcm1hdGlvbiB0byBzZW5kIHRvIHRoZSBhcHByb3ZlZCBjb250cmFjdAogICAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlQW5kQ2FsbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2V4dHJhRGF0YSkgb25seU93bmVyCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICB0b2tlblJlY2lwaWVudCBzcGVuZGVyID0gdG9rZW5SZWNpcGllbnQoX3NwZW5kZXIpOwogICAgICAgIGlmIChhcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUpKSB7CiAgICAgICAgICAgIHNwZW5kZXIucmVjZWl2ZUFwcHJvdmFsKG1zZy5zZW5kZXIsIF92YWx1ZSwgdGhpcywgX2V4dHJhRGF0YSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIERlc3Ryb3kgdG9rZW5zCiAgICAgKgogICAgICogUmVtb3ZlIGBfdmFsdWVgIHRva2VucyBmcm9tIHRoZSBzeXN0ZW0gaXJyZXZlcnNpYmx5CiAgICAgKgogICAgICogQHBhcmFtIF92YWx1ZSB0aGUgYW1vdW50IG9mIG1vbmV5IHRvIGJ1cm4KICAgICAqLwogICAgZnVuY3Rpb24gYnVybih1aW50MjU2IF92YWx1ZSkgb25seU93bmVyIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoYmFsYW5jZU9mW21zZy5zZW5kZXJdID49IF92YWx1ZSk7ICAgLy8gQ2hlY2sgaWYgdGhlIHNlbmRlciBoYXMgZW5vdWdoCiAgICAgICAgYmFsYW5jZU9mW21zZy5zZW5kZXJdIC09IF92YWx1ZTsgICAgICAgICAgICAvLyBTdWJ0cmFjdCBmcm9tIHRoZSBzZW5kZXIKICAgICAgICB0b3RhbFN1cHBseSAtPSBfdmFsdWU7ICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZXMgdG90YWxTdXBwbHkKICAgICAgICBCdXJuKG1zZy5zZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBEZXN0cm95IHRva2VucyBmcm9tIG90aGVyIGNjb3VudAogICAgICoKICAgICAqIFJlbW92ZSBgX3ZhbHVlYCB0b2tlbnMgZnJvbSB0aGUgc3lzdGVtIGlycmV2ZXJzaWJseSBvbiBiZWhhbGYgb2YgYF9mcm9tYC4KICAgICAqCiAgICAgKiBAcGFyYW0gX2Zyb20gdGhlIGFkZHJlc3Mgb2YgdGhlIHNlbmRlcgogICAgICogQHBhcmFtIF92YWx1ZSB0aGUgYW1vdW50IG9mIG1vbmV5IHRvIGJ1cm4KICAgICAqLwogICAgZnVuY3Rpb24gYnVybkZyb20oYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdmFsdWUpICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXF1aXJlKGJhbGFuY2VPZltfZnJvbV0gPj0gX3ZhbHVlKTsgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHRhcmdldGVkIGJhbGFuY2UgaXMgZW5vdWdoCiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYWxsb3dhbmNlW19mcm9tXVttc2cuc2VuZGVyXSk7ICAgIC8vIENoZWNrIGFsbG93YW5jZQogICAgICAgIGJhbGFuY2VPZltfZnJvbV0gLT0gX3ZhbHVlOyAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTdWJ0cmFjdCBmcm9tIHRoZSB0YXJnZXRlZCBiYWxhbmNlCiAgICAgICAgYWxsb3dhbmNlW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7ICAgICAgICAgICAgIC8vIFN1YnRyYWN0IGZyb20gdGhlIHNlbmRlcidzIGFsbG93YW5jZQogICAgICAgIHRvdGFsU3VwcGx5IC09IF92YWx1ZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdG90YWxTdXBwbHkKICAgICAgICBCdXJuKF9mcm9tLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qCiAgICAgZnVuY3Rpb24gaW5jcmVhc2VTdXBwbHkoYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdmFsdWUpIG9ubHlPd25lciAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSAgewogICAgIGJhbGFuY2VPZltfZnJvbV0gKz0gX3ZhbHVlOyAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTdWJ0cmFjdCBmcm9tIHRoZSB0YXJnZXRlZCBiYWxhbmNlCiAgICAgdG90YWxTdXBwbHkgKz0gX3ZhbHVlOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0b3RhbFN1cHBseQogICAgIC8vIEJ1cm4oX2Zyb20sIF92YWx1ZSk7CiAgICAgcmV0dXJuIHRydWU7CiAgICAgfQogICAgICovCgoKCgogICAgdWludDI1NiBwdWJsaWMgc2VsbFByaWNlID0gNjA4OwogICAgdWludDI1NiBwdWJsaWMgYnV5UHJpY2UgPSA3NjA7CgogICAgZnVuY3Rpb24gc2V0UHJpY2VzKHVpbnQyNTYgbmV3U2VsbFByaWNlLCB1aW50MjU2IG5ld0J1eVByaWNlKSBvbmx5T3duZXIgewogICAgICAgIHNlbGxQcmljZSA9IG5ld1NlbGxQcmljZTsKICAgICAgICBidXlQcmljZSA9IG5ld0J1eVByaWNlOwogICAgfQogICAgZnVuY3Rpb24gc2V0VXNlcnNDYW5UcmFkZShib29sIHRyYWRlKSBvbmx5T3duZXIgewogICAgICAgIHVzZXJzQ2FuVHJhZGU9dHJhZGU7CiAgICB9CiAgICBmdW5jdGlvbiBzZXRDYW5UcmFkZShhZGRyZXNzIGFkZHIsIGJvb2wgdHJhZGUpIG9ubHlPd25lciB7CiAgICAgICAgY2FuVHJhZGVbYWRkcl09dHJhZGU7CiAgICB9CgogICAgLy91c2VyIGlzIGJ1eWluZyBncngKICAgIGZ1bmN0aW9uIGJ1eSgpIHBheWFibGUgcmV0dXJucyAodWludDI1NiBhbW91bnQpewogICAgICAgIGlmKCF1c2Vyc0NhblRyYWRlICYmICFjYW5UcmFkZVttc2cuc2VuZGVyXSkgcmV2ZXJ0KCk7CiAgICAgICAgYW1vdW50ID0gbXNnLnZhbHVlICogYnV5UHJpY2U7ICAgICAgICAgICAgICAgICAgICAvLyBjYWxjdWxhdGVzIHRoZSBhbW91bnQKCiAgICAgICAgcmVxdWlyZShiYWxhbmNlT2ZbdGhpc10gPj0gYW1vdW50KTsgICAgICAgICAgICAgICAvLyBjaGVja3MgaWYgaXQgaGFzIGVub3VnaCB0byBzZWxsCiAgICAgICAgYmFsYW5jZU9mW21zZy5zZW5kZXJdICs9IGFtb3VudDsgICAgICAgICAgICAgICAgICAvLyBhZGRzIHRoZSBhbW91bnQgdG8gYnV5ZXIncyBiYWxhbmNlCiAgICAgICAgYmFsYW5jZU9mW3RoaXNdIC09IGFtb3VudDsgICAgICAgICAgICAgICAgICAgICAgICAvLyBzdWJ0cmFjdHMgYW1vdW50IGZyb20gc2VsbGVyJ3MgYmFsYW5jZQogICAgICAgIFRyYW5zZmVyKHRoaXMsIG1zZy5zZW5kZXIsIGFtb3VudCk7ICAgICAgICAgICAgICAgLy8gZXhlY3V0ZSBhbiBldmVudCByZWZsZWN0aW5nIHRoZSBjaGFuZ2UKICAgICAgICByZXR1cm4gYW1vdW50OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVuZHMgZnVuY3Rpb24gYW5kIHJldHVybnMKICAgIH0KCiAgICAvL3VzZXIgaXMgc2VsbGluZyB1cyBncngsIHdlIGFyZSBzZWxsaW5nIGV0aCB0byB0aGUgdXNlcgogICAgZnVuY3Rpb24gc2VsbCh1aW50MjU2IGFtb3VudCkgcmV0dXJucyAodWludCByZXZlbnVlKXsKICAgICAgICByZXF1aXJlKCFmcm96ZW5bbXNnLnNlbmRlcl0pOwogICAgICAgIGlmKCF1c2Vyc0NhblRyYWRlICYmICFjYW5UcmFkZVttc2cuc2VuZGVyXSkgewogICAgICAgICAgICByZXF1aXJlKG1pbkJhbGFuY2VGb3JBY2NvdW50cyA+IGFtb3VudC9zZWxsUHJpY2UpOwogICAgICAgIH0KICAgICAgICByZXF1aXJlKGJhbGFuY2VPZlttc2cuc2VuZGVyXSA+PSBhbW91bnQpOyAgICAgICAgIC8vIGNoZWNrcyBpZiB0aGUgc2VuZGVyIGhhcyBlbm91Z2ggdG8gc2VsbAogICAgICAgIGJhbGFuY2VPZlt0aGlzXSArPSBhbW91bnQ7ICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWRkcyB0aGUgYW1vdW50IHRvIG93bmVyJ3MgYmFsYW5jZQogICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSAtPSBhbW91bnQ7ICAgICAgICAgICAgICAgICAgLy8gc3VidHJhY3RzIHRoZSBhbW91bnQgZnJvbSBzZWxsZXIncyBiYWxhbmNlCiAgICAgICAgcmV2ZW51ZSA9IGFtb3VudCAvIHNlbGxQcmljZTsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIuc2VuZChyZXZlbnVlKSk7ICAgICAgICAgICAgICAgIC8vIHNlbmRzIGV0aGVyIHRvIHRoZSBzZWxsZXI6IGl0J3MgaW1wb3J0YW50IHRvIGRvIHRoaXMgbGFzdCB0byBwcmV2ZW50IHJlY3Vyc2lvbiBhdHRhY2tzCiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgdGhpcywgYW1vdW50KTsgICAgICAgICAgICAgICAvLyBleGVjdXRlcyBhbiBldmVudCByZWZsZWN0aW5nIG9uIHRoZSBjaGFuZ2UKICAgICAgICByZXR1cm4gcmV2ZW51ZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVuZHMgZnVuY3Rpb24gYW5kIHJldHVybnMKICAgIH0KCiAgICBmdW5jdGlvbigpIHBheWFibGUgewogICAgfQogICAgZXZlbnQgV2l0aGRyYXduKGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7CiAgICBmdW5jdGlvbiB3aXRoZHJhdyhhZGRyZXNzIHRhcmdldCwgdWludDI1NiBhbW91bnQpIG9ubHlPd25lciB7CiAgICAgICAgdGFyZ2V0LnRyYW5zZmVyKGFtb3VudCk7CiAgICAgICAgV2l0aGRyYXduKHRhcmdldCwgYW1vdW50KTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRBZG1pbihhZGRyZXNzIGFkZHIsIGJvb2wgZW5hYmxlZCkgb25seU93bmVyIHsKICAgICAgICBhZG1pblthZGRyXT1lbmFibGVkOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldElDTyhib29sIGVuYWJsZWQpIG9ubHlPd25lciB7CiAgICAgICAgaWNvPWVuYWJsZWQ7CiAgICB9Cn0='.
	

]
