Class {
	#name : #SRTdf347911910b6c9a4286ba8e2ee5ea4a39eb2134,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTdf347911910b6c9a4286ba8e2ee5ea4a39eb2134 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKioKICogQm9iJ3MgUmVwYWlyIFRva2VuCiAqIGh0dHBzOi8vYm9ic3JlcGFpci5jb20vCiAqIFVzaW5nIEJsb2NrY2hhaW4gdG8gZWxpbWluYXRlIHJldmlldyBmcmF1ZCBhbmQgcHJvdmlkZSBsb3dlciBwcmljaW5nIGluIHRoZSBob21lIHJlcGFpciBpbmR1c3RyeSB0aHJvdWdoIGEgZGVjZW50cmFsaXplZCBwbGF0Zm9ybS4KICovCgovLz09PSBPcGVuWmVwcGVsaW4gTGlicmFyeSBDb250cmFjdHMgaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXBwZWxpbi1zb2xpZGl0eSA9PT0KCi8qKgogKiBAdGl0bGUgRVJDMjBCYXNpYwogKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE3OQogKi8KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBTYWZlRVJDMjAKICogQGRldiBXcmFwcGVycyBhcm91bmQgRVJDMjAgb3BlcmF0aW9ucyB0aGF0IHRocm93IG9uIGZhaWx1cmUuCiAqIFRvIHVzZSB0aGlzIGxpYnJhcnkgeW91IGNhbiBhZGQgYSBgdXNpbmcgU2FmZUVSQzIwIGZvciBFUkMyMDtgIHN0YXRlbWVudCB0byB5b3VyIGNvbnRyYWN0LAogKiB3aGljaCBhbGxvd3MgeW91IHRvIGNhbGwgdGhlIHNhZmUgb3BlcmF0aW9ucyBhcyBgdG9rZW4uc2FmZVRyYW5zZmVyKC4uLilgLCBldGMuCiAqLwpsaWJyYXJ5IFNhZmVFUkMyMCB7CiAgZnVuY3Rpb24gc2FmZVRyYW5zZmVyKEVSQzIwQmFzaWMgdG9rZW4sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHsKICAgIGFzc2VydCh0b2tlbi50cmFuc2Zlcih0bywgdmFsdWUpKTsKICB9CgogIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlckZyb20oRVJDMjAgdG9rZW4sIGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgaW50ZXJuYWwgewogICAgYXNzZXJ0KHRva2VuLnRyYW5zZmVyRnJvbShmcm9tLCB0bywgdmFsdWUpKTsKICB9CgogIGZ1bmN0aW9uIHNhZmVBcHByb3ZlKEVSQzIwIHRva2VuLCBhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIGludGVybmFsIHsKICAgIGFzc2VydCh0b2tlbi5hcHByb3ZlKHNwZW5kZXIsIHZhbHVlKSk7CiAgfQp9CgovKioKICAgQHRpdGxlIEVSQzgyNyBpbnRlcmZhY2UsIGFuIGV4dGVuc2lvbiBvZiBFUkMyMCB0b2tlbiBzdGFuZGFyZAoKICAgSW50ZXJmYWNlIG9mIGEgRVJDODI3IHRva2VuLCBmb2xsb3dpbmcgdGhlIEVSQzIwIHN0YW5kYXJkIHdpdGggZXh0cmEKICAgbWV0aG9kcyB0byB0cmFuc2ZlciB2YWx1ZSBhbmQgZGF0YSBhbmQgZXhlY3V0ZSBjYWxscyBpbiB0cmFuc2ZlcnMgYW5kCiAgIGFwcHJvdmFscy4KICovCmNvbnRyYWN0IEVSQzgyNyBpcyBFUkMyMCB7CgogIGZ1bmN0aW9uIGFwcHJvdmUoIGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSApIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiB0cmFuc2ZlciggYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSApIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oIGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2RhdGEgKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7Cgp9CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKGEgPT0gMCkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogIHVpbnQyNTYgdG90YWxTdXBwbHlfOwoKICAvKioKICAqIEBkZXYgdG90YWwgbnVtYmVyIG9mIHRva2VucyBpbiBleGlzdGVuY2UKICAqLwogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIHRvdGFsU3VwcGx5XzsKICB9CgogIC8qKgogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CgoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBAZGV2IEluY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX2FkZGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gaW5jcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IERlY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBkZWNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3N1YnRyYWN0ZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBkZWNyZWFzZSB0aGUgYWxsb3dhbmNlIGJ5LgogICAqLwogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9CgovKioKICAgQHRpdGxlIEVSQzgyNywgYW4gZXh0ZW5zaW9uIG9mIEVSQzIwIHRva2VuIHN0YW5kYXJkCgogICBJbXBsZW1lbnRhdGlvbiB0aGUgRVJDODI3LCBmb2xsb3dpbmcgdGhlIEVSQzIwIHN0YW5kYXJkIHdpdGggZXh0cmEKICAgbWV0aG9kcyB0byB0cmFuc2ZlciB2YWx1ZSBhbmQgZGF0YSBhbmQgZXhlY3V0ZSBjYWxscyBpbiB0cmFuc2ZlcnMgYW5kCiAgIGFwcHJvdmFscy4KICAgVXNlcyBPcGVuWmVwcGVsaW4gU3RhbmRhcmRUb2tlbi4KICovCmNvbnRyYWN0IEVSQzgyN1Rva2VuIGlzIEVSQzgyNywgU3RhbmRhcmRUb2tlbiB7CgogIC8qKgogICAgIEBkZXYgQWRkaXRpb24gdG8gRVJDMjAgdG9rZW4gbWV0aG9kcy4gSXQgYWxsb3dzIHRvCiAgICAgYXBwcm92ZSB0aGUgdHJhbnNmZXIgb2YgdmFsdWUgYW5kIGV4ZWN1dGUgYSBjYWxsIHdpdGggdGhlIHNlbnQgZGF0YS4KCiAgICAgQmV3YXJlIHRoYXQgY2hhbmdpbmcgYW4gYWxsb3dhbmNlIHdpdGggdGhpcyBtZXRob2QgYnJpbmdzIHRoZSByaXNrIHRoYXQKICAgICBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZQogICAgIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcyByYWNlIGNvbmRpdGlvbgogICAgIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUKICAgICBhZnRlcndhcmRzOgogICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CgogICAgIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICAgQHBhcmFtIF9kYXRhIEFCSS1lbmNvZGVkIGNvbnRyYWN0IGNhbGwgdG8gY2FsbCBgX3RvYCBhZGRyZXNzLgoKICAgICBAcmV0dXJuIHRydWUgaWYgdGhlIGNhbGwgZnVuY3Rpb24gd2FzIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseQogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9kYXRhKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfc3BlbmRlciAhPSBhZGRyZXNzKHRoaXMpKTsKCiAgICBzdXBlci5hcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUpOwoKICAgIHJlcXVpcmUoX3NwZW5kZXIuY2FsbChfZGF0YSkpOwoKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICAgQGRldiBBZGRpdGlvbiB0byBFUkMyMCB0b2tlbiBtZXRob2RzLiBUcmFuc2ZlciB0b2tlbnMgdG8gYSBzcGVjaWZpZWQKICAgICBhZGRyZXNzIGFuZCBleGVjdXRlIGEgY2FsbCB3aXRoIHRoZSBzZW50IGRhdGEgb24gdGhlIHNhbWUgdHJhbnNhY3Rpb24KCiAgICAgQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICAgQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91dCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJlZAogICAgIEBwYXJhbSBfZGF0YSBBQkktZW5jb2RlZCBjb250cmFjdCBjYWxsIHRvIGNhbGwgYF90b2AgYWRkcmVzcy4KCiAgICAgQHJldHVybiB0cnVlIGlmIHRoZSBjYWxsIGZ1bmN0aW9uIHdhcyBleGVjdXRlZCBzdWNjZXNzZnVsbHkKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9kYXRhKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcyh0aGlzKSk7CgogICAgc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwoKICAgIHJlcXVpcmUoX3RvLmNhbGwoX2RhdGEpKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICAgQGRldiBBZGRpdGlvbiB0byBFUkMyMCB0b2tlbiBtZXRob2RzLiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0bwogICAgIGFub3RoZXIgYW5kIG1ha2UgYSBjb250cmFjdCBjYWxsIG9uIHRoZSBzYW1lIHRyYW5zYWN0aW9uCgogICAgIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICAgQHBhcmFtIF90byBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAgIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3V0IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAgIEBwYXJhbSBfZGF0YSBBQkktZW5jb2RlZCBjb250cmFjdCBjYWxsIHRvIGNhbGwgYF90b2AgYWRkcmVzcy4KCiAgICAgQHJldHVybiB0cnVlIGlmIHRoZSBjYWxsIGZ1bmN0aW9uIHdhcyBleGVjdXRlZCBzdWNjZXNzZnVsbHkKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3ModGhpcykpOwoKICAgIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwoKICAgIHJlcXVpcmUoX3RvLmNhbGwoX2RhdGEpKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBZGRpdGlvbiB0byBTdGFuZGFyZFRva2VuIG1ldGhvZHMuIEluY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQKICAgKiBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlciBhbmQgZXhlY3V0ZSBhIGNhbGwgd2l0aCB0aGUgc2VudCBkYXRhLgogICAqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9hZGRlZFZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGluY3JlYXNlIHRoZSBhbGxvd2FuY2UgYnkuCiAgICogQHBhcmFtIF9kYXRhIEFCSS1lbmNvZGVkIGNvbnRyYWN0IGNhbGwgdG8gY2FsbCBgX3NwZW5kZXJgIGFkZHJlc3MuCiAgICovCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3NwZW5kZXIgIT0gYWRkcmVzcyh0aGlzKSk7CgogICAgc3VwZXIuaW5jcmVhc2VBcHByb3ZhbChfc3BlbmRlciwgX2FkZGVkVmFsdWUpOwoKICAgIHJlcXVpcmUoX3NwZW5kZXIuY2FsbChfZGF0YSkpOwoKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBZGRpdGlvbiB0byBTdGFuZGFyZFRva2VuIG1ldGhvZHMuIERlY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQKICAgKiBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlciBhbmQgZXhlY3V0ZSBhIGNhbGwgd2l0aCB0aGUgc2VudCBkYXRhLgogICAqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gZGVjcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zdWJ0cmFjdGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gZGVjcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKiBAcGFyYW0gX2RhdGEgQUJJLWVuY29kZWQgY29udHJhY3QgY2FsbCB0byBjYWxsIGBfc3BlbmRlcmAgYWRkcmVzcy4KICAgKi8KICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSwgYnl0ZXMgX2RhdGEpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF9zcGVuZGVyICE9IGFkZHJlc3ModGhpcykpOwoKICAgIHN1cGVyLmRlY3JlYXNlQXBwcm92YWwoX3NwZW5kZXIsIF9zdWJ0cmFjdGVkVmFsdWUpOwoKICAgIHJlcXVpcmUoX3NwZW5kZXIuY2FsbChfZGF0YSkpOwoKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCi8qKgogKiBAdGl0bGUgT3duYWJsZQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuCiAqLwpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCgogIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCi8qKgogKiBAdGl0bGUgTWludGFibGUgdG9rZW4KICogQGRldiBTaW1wbGUgRVJDMjAgVG9rZW4gZXhhbXBsZSwgd2l0aCBtaW50YWJsZSB0b2tlbiBjcmVhdGlvbgogKiBAZGV2IElzc3VlOiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvaXNzdWVzLzEyMAogKiBCYXNlZCBvbiBjb2RlIGJ5IFRva2VuTWFya2V0TmV0OiBodHRwczovL2dpdGh1Yi5jb20vVG9rZW5NYXJrZXROZXQvaWNvL2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy9NaW50YWJsZVRva2VuLnNvbAogKi8KY29udHJhY3QgTWludGFibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwogIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwoKICBib29sIHB1YmxpYyBtaW50aW5nRmluaXNoZWQgPSBmYWxzZTsKCgogIG1vZGlmaWVyIGNhbk1pbnQoKSB7CiAgICByZXF1aXJlKCFtaW50aW5nRmluaXNoZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gbWludCB0b2tlbnMKICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCByZWNlaXZlIHRoZSBtaW50ZWQgdG9rZW5zLgogICAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIG1pbnQuCiAgICogQHJldHVybiBBIGJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIG9ubHlPd25lciBjYW5NaW50IHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICB0b3RhbFN1cHBseV8gPSB0b3RhbFN1cHBseV8uYWRkKF9hbW91bnQpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF9hbW91bnQpOwogICAgTWludChfdG8sIF9hbW91bnQpOwogICAgVHJhbnNmZXIoYWRkcmVzcygwKSwgX3RvLCBfYW1vdW50KTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBzdG9wIG1pbnRpbmcgbmV3IHRva2Vucy4KICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBmaW5pc2hNaW50aW5nKCkgb25seU93bmVyIGNhbk1pbnQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIG1pbnRpbmdGaW5pc2hlZCA9IHRydWU7CiAgICBNaW50RmluaXNoZWQoKTsKICAgIHJldHVybiB0cnVlOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBEZXN0cnVjdGlibGUKICogQGRldiBCYXNlIGNvbnRyYWN0IHRoYXQgY2FuIGJlIGRlc3Ryb3llZCBieSBvd25lci4gQWxsIGZ1bmRzIGluIGNvbnRyYWN0IHdpbGwgYmUgc2VudCB0byB0aGUgb3duZXIuCiAqLwpjb250cmFjdCBEZXN0cnVjdGlibGUgaXMgT3duYWJsZSB7CgogIGZ1bmN0aW9uIERlc3RydWN0aWJsZSgpIHB1YmxpYyBwYXlhYmxlIHsgfQoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVycyB0aGUgY3VycmVudCBiYWxhbmNlIHRvIHRoZSBvd25lciBhbmQgdGVybWluYXRlcyB0aGUgY29udHJhY3QuCiAgICovCiAgZnVuY3Rpb24gZGVzdHJveSgpIG9ubHlPd25lciBwdWJsaWMgewogICAgc2VsZmRlc3RydWN0KG93bmVyKTsKICB9CgogIGZ1bmN0aW9uIGRlc3Ryb3lBbmRTZW5kKGFkZHJlc3MgX3JlY2lwaWVudCkgb25seU93bmVyIHB1YmxpYyB7CiAgICBzZWxmZGVzdHJ1Y3QoX3JlY2lwaWVudCk7CiAgfQp9CgovKioKICogQHRpdGxlIFBhdXNhYmxlCiAqIEBkZXYgQmFzZSBjb250cmFjdCB3aGljaCBhbGxvd3MgY2hpbGRyZW4gdG8gaW1wbGVtZW50IGFuIGVtZXJnZW5jeSBzdG9wIG1lY2hhbmlzbS4KICovCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgewogIGV2ZW50IFBhdXNlKCk7CiAgZXZlbnQgVW5wYXVzZSgpOwoKICBib29sIHB1YmxpYyBwYXVzZWQgPSBmYWxzZTsKCgogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgbm90IHBhdXNlZC4KICAgKi8KICBtb2RpZmllciB3aGVuTm90UGF1c2VkKCkgewogICAgcmVxdWlyZSghcGF1c2VkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIHBhdXNlZC4KICAgKi8KICBtb2RpZmllciB3aGVuUGF1c2VkKCkgewogICAgcmVxdWlyZShwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byBwYXVzZSwgdHJpZ2dlcnMgc3RvcHBlZCBzdGF0ZQogICAqLwogIGZ1bmN0aW9uIHBhdXNlKCkgb25seU93bmVyIHdoZW5Ob3RQYXVzZWQgcHVibGljIHsKICAgIHBhdXNlZCA9IHRydWU7CiAgICBQYXVzZSgpOwogIH0KCiAgLyoqCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHVucGF1c2UsIHJldHVybnMgdG8gbm9ybWFsIHN0YXRlCiAgICovCiAgZnVuY3Rpb24gdW5wYXVzZSgpIG9ubHlPd25lciB3aGVuUGF1c2VkIHB1YmxpYyB7CiAgICBwYXVzZWQgPSBmYWxzZTsKICAgIFVucGF1c2UoKTsKICB9Cn0KCi8qKgogKiBAdGl0bGUgQ29udHJhY3RzIHRoYXQgc2hvdWxkIG5vdCBvd24gRXRoZXIKICogQGF1dGhvciBSZW1jbyBCbG9lbWVuIDw8YSBocmVmPSIvY2RuLWNnaS9sL2VtYWlsLXByb3RlY3Rpb24iIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iZWY5ZDhhODI4YzgwYWZkZCI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvYT7PgC5jb20+CiAqIEBkZXYgVGhpcyB0cmllcyB0byBibG9jayBpbmNvbWluZyBldGhlciB0byBwcmV2ZW50IGFjY2lkZW50YWwgbG9zcyBvZiBFdGhlci4gU2hvdWxkIEV0aGVyIGVuZCB1cAogKiBpbiB0aGUgY29udHJhY3QsIGl0IHdpbGwgYWxsb3cgdGhlIG93bmVyIHRvIHJlY2xhaW0gdGhpcyBldGhlci4KICogQG5vdGljZSBFdGhlciBjYW4gc3RpbGwgYmUgc2VuZCB0byB0aGlzIGNvbnRyYWN0IGJ5OgogKiBjYWxsaW5nIGZ1bmN0aW9ucyBsYWJlbGVkIGBwYXlhYmxlYAogKiBgc2VsZmRlc3RydWN0KGNvbnRyYWN0X2FkZHJlc3MpYAogKiBtaW5pbmcgZGlyZWN0bHkgdG8gdGhlIGNvbnRyYWN0IGFkZHJlc3MKKi8KY29udHJhY3QgSGFzTm9FdGhlciBpcyBPd25hYmxlIHsKCiAgLyoqCiAgKiBAZGV2IENvbnN0cnVjdG9yIHRoYXQgcmVqZWN0cyBpbmNvbWluZyBFdGhlcgogICogQGRldiBUaGUgYHBheWFibGVgIGZsYWcgaXMgYWRkZWQgc28gd2UgY2FuIGFjY2VzcyBgbXNnLnZhbHVlYCB3aXRob3V0IGNvbXBpbGVyIHdhcm5pbmcuIElmIHdlCiAgKiBsZWF2ZSBvdXQgcGF5YWJsZSwgdGhlbiBTb2xpZGl0eSB3aWxsIGFsbG93IGluaGVyaXRpbmcgY29udHJhY3RzIHRvIGltcGxlbWVudCBhIHBheWFibGUKICAqIGNvbnN0cnVjdG9yLiBCeSBkb2luZyBpdCB0aGlzIHdheSB3ZSBwcmV2ZW50IGEgcGF5YWJsZSBjb25zdHJ1Y3RvciBmcm9tIHdvcmtpbmcuIEFsdGVybmF0aXZlbHkKICAqIHdlIGNvdWxkIHVzZSBhc3NlbWJseSB0byBhY2Nlc3MgbXNnLnZhbHVlLgogICovCiAgZnVuY3Rpb24gSGFzTm9FdGhlcigpIHB1YmxpYyBwYXlhYmxlIHsKICAgIHJlcXVpcmUobXNnLnZhbHVlID09IDApOwogIH0KCiAgLyoqCiAgICogQGRldiBEaXNhbGxvd3MgZGlyZWN0IHNlbmQgYnkgc2V0dGluZ3MgYSBkZWZhdWx0IGZ1bmN0aW9uIHdpdGhvdXQgdGhlIGBwYXlhYmxlYCBmbGFnLgogICAqLwogIGZ1bmN0aW9uKCkgZXh0ZXJuYWwgewogIH0KCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciBhbGwgRXRoZXIgaGVsZCBieSB0aGUgY29udHJhY3QgdG8gdGhlIG93bmVyLgogICAqLwogIGZ1bmN0aW9uIHJlY2xhaW1FdGhlcigpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICBhc3NlcnQob3duZXIuc2VuZCh0aGlzLmJhbGFuY2UpKTsKICB9Cn0KCi8qKgogKiBAdGl0bGUgQ29udHJhY3RzIHRoYXQgc2hvdWxkIG5vdCBvd24gQ29udHJhY3RzCiAqIEBhdXRob3IgUmVtY28gQmxvZW1lbiA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImZiODk5ZTk2OTg5NGJiYzkiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+z4AuY29tPgogKiBAZGV2IFNob3VsZCBjb250cmFjdHMgKGFueXRoaW5nIE93bmFibGUpIGVuZCB1cCBiZWluZyBvd25lZCBieSB0aGlzIGNvbnRyYWN0LCBpdCBhbGxvd3MgdGhlIG93bmVyCiAqIG9mIHRoaXMgY29udHJhY3QgdG8gcmVjbGFpbSBvd25lcnNoaXAgb2YgdGhlIGNvbnRyYWN0cy4KICovCmNvbnRyYWN0IEhhc05vQ29udHJhY3RzIGlzIE93bmFibGUgewoKICAvKioKICAgKiBAZGV2IFJlY2xhaW0gb3duZXJzaGlwIG9mIE93bmFibGUgY29udHJhY3RzCiAgICogQHBhcmFtIGNvbnRyYWN0QWRkciBUaGUgYWRkcmVzcyBvZiB0aGUgT3duYWJsZSB0byBiZSByZWNsYWltZWQuCiAgICovCiAgZnVuY3Rpb24gcmVjbGFpbUNvbnRyYWN0KGFkZHJlc3MgY29udHJhY3RBZGRyKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgT3duYWJsZSBjb250cmFjdEluc3QgPSBPd25hYmxlKGNvbnRyYWN0QWRkcik7CiAgICBjb250cmFjdEluc3QudHJhbnNmZXJPd25lcnNoaXAob3duZXIpOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBDb250cmFjdHMgdGhhdCBzaG91bGQgYmUgYWJsZSB0byByZWNvdmVyIHRva2VucwogKiBAYXV0aG9yIFN5bFRpCiAqIEBkZXYgVGhpcyBhbGxvdyBhIGNvbnRyYWN0IHRvIHJlY292ZXIgYW55IEVSQzIwIHRva2VuIHJlY2VpdmVkIGluIGEgY29udHJhY3QgYnkgdHJhbnNmZXJyaW5nIHRoZSBiYWxhbmNlIHRvIHRoZSBjb250cmFjdCBvd25lci4KICogVGhpcyB3aWxsIHByZXZlbnQgYW55IGFjY2lkZW50YWwgbG9zcyBvZiB0b2tlbnMuCiAqLwpjb250cmFjdCBDYW5SZWNsYWltVG9rZW4gaXMgT3duYWJsZSB7CiAgdXNpbmcgU2FmZUVSQzIwIGZvciBFUkMyMEJhc2ljOwoKICAvKioKICAgKiBAZGV2IFJlY2xhaW0gYWxsIEVSQzIwQmFzaWMgY29tcGF0aWJsZSB0b2tlbnMKICAgKiBAcGFyYW0gdG9rZW4gRVJDMjBCYXNpYyBUaGUgYWRkcmVzcyBvZiB0aGUgdG9rZW4gY29udHJhY3QKICAgKi8KICBmdW5jdGlvbiByZWNsYWltVG9rZW4oRVJDMjBCYXNpYyB0b2tlbikgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIHVpbnQyNTYgYmFsYW5jZSA9IHRva2VuLmJhbGFuY2VPZih0aGlzKTsKICAgIHRva2VuLnNhZmVUcmFuc2Zlcihvd25lciwgYmFsYW5jZSk7CiAgfQoKfQoKCi8qKgogKiBAdGl0bGUgQ29udHJhY3RzIHRoYXQgc2hvdWxkIG5vdCBvd24gVG9rZW5zCiAqIEBhdXRob3IgUmVtY28gQmxvZW1lbiA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImRhYThiZmI3YjliNTlhZTgiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+z4AuY29tPgogKiBAZGV2IFRoaXMgYmxvY2tzIGluY29taW5nIEVSQzIzIHRva2VucyB0byBwcmV2ZW50IGFjY2lkZW50YWwgbG9zcyBvZiB0b2tlbnMuCiAqIFNob3VsZCB0b2tlbnMgKGFueSBFUkMyMEJhc2ljIGNvbXBhdGlibGUpIGVuZCB1cCBpbiB0aGUgY29udHJhY3QsIGl0IGFsbG93cyB0aGUKICogb3duZXIgdG8gcmVjbGFpbSB0aGUgdG9rZW5zLgogKi8KY29udHJhY3QgSGFzTm9Ub2tlbnMgaXMgQ2FuUmVjbGFpbVRva2VuIHsKCiAvKioKICAqIEBkZXYgUmVqZWN0IGFsbCBFUkMyMyBjb21wYXRpYmxlIHRva2VucwogICogQHBhcmFtIGZyb21fIGFkZHJlc3MgVGhlIGFkZHJlc3MgdGhhdCBpcyB0cmFuc2ZlcnJpbmcgdGhlIHRva2VucwogICogQHBhcmFtIHZhbHVlXyB1aW50MjU2IHRoZSBhbW91bnQgb2YgdGhlIHNwZWNpZmllZCB0b2tlbgogICogQHBhcmFtIGRhdGFfIEJ5dGVzIFRoZSBkYXRhIHBhc3NlZCBmcm9tIHRoZSBjYWxsZXIuCiAgKi8KICBmdW5jdGlvbiB0b2tlbkZhbGxiYWNrKGFkZHJlc3MgZnJvbV8sIHVpbnQyNTYgdmFsdWVfLCBieXRlcyBkYXRhXykgcHVyZSBleHRlcm5hbCB7CiAgICBmcm9tXzsKICAgIHZhbHVlXzsKICAgIGRhdGFfOwogICAgcmV2ZXJ0KCk7CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBCYXNlIGNvbnRyYWN0IGZvciBjb250cmFjdHMgdGhhdCBzaG91bGQgbm90IG93biB0aGluZ3MuCiAqIEBhdXRob3IgUmVtY28gQmxvZW1lbiA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjU2MjQzMzNiMzUzOTE2NjQiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+z4AuY29tPgogKiBAZGV2IFNvbHZlcyBhIGNsYXNzIG9mIGVycm9ycyB3aGVyZSBhIGNvbnRyYWN0IGFjY2lkZW50YWxseSBiZWNvbWVzIG93bmVyIG9mIEV0aGVyLCBUb2tlbnMgb3IKICogT3duZWQgY29udHJhY3RzLiBTZWUgcmVzcGVjdGl2ZSBiYXNlIGNvbnRyYWN0cyBmb3IgZGV0YWlscy4KICovCmNvbnRyYWN0IE5vT3duZXIgaXMgSGFzTm9FdGhlciwgSGFzTm9Ub2tlbnMsIEhhc05vQ29udHJhY3RzIHsKfQoKLyoqCiAqIEB0aXRsZSBUb2tlblZlc3RpbmcKICogQGRldiBBIHRva2VuIGhvbGRlciBjb250cmFjdCB0aGF0IGNhbiByZWxlYXNlIGl0cyB0b2tlbiBiYWxhbmNlIGdyYWR1YWxseSBsaWtlIGEKICogdHlwaWNhbCB2ZXN0aW5nIHNjaGVtZSwgd2l0aCBhIGNsaWZmIGFuZCB2ZXN0aW5nIHBlcmlvZC4gT3B0aW9uYWxseSByZXZvY2FibGUgYnkgdGhlCiAqIG93bmVyLgogKi8KY29udHJhY3QgVG9rZW5WZXN0aW5nIGlzIE93bmFibGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogIHVzaW5nIFNhZmVFUkMyMCBmb3IgRVJDMjBCYXNpYzsKCiAgZXZlbnQgUmVsZWFzZWQodWludDI1NiBhbW91bnQpOwogIGV2ZW50IFJldm9rZWQoKTsKCiAgLy8gYmVuZWZpY2lhcnkgb2YgdG9rZW5zIGFmdGVyIHRoZXkgYXJlIHJlbGVhc2VkCiAgYWRkcmVzcyBwdWJsaWMgYmVuZWZpY2lhcnk7CgogIHVpbnQyNTYgcHVibGljIGNsaWZmOwogIHVpbnQyNTYgcHVibGljIHN0YXJ0OwogIHVpbnQyNTYgcHVibGljIGR1cmF0aW9uOwoKICBib29sIHB1YmxpYyByZXZvY2FibGU7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIHJlbGVhc2VkOwogIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIHJldm9rZWQ7CgogIC8qKgogICAqIEBkZXYgQ3JlYXRlcyBhIHZlc3RpbmcgY29udHJhY3QgdGhhdCB2ZXN0cyBpdHMgYmFsYW5jZSBvZiBhbnkgRVJDMjAgdG9rZW4gdG8gdGhlCiAgICogX2JlbmVmaWNpYXJ5LCBncmFkdWFsbHkgaW4gYSBsaW5lYXIgZmFzaGlvbiB1bnRpbCBfc3RhcnQgKyBfZHVyYXRpb24uIEJ5IHRoZW4gYWxsCiAgICogb2YgdGhlIGJhbGFuY2Ugd2lsbCBoYXZlIHZlc3RlZC4KICAgKiBAcGFyYW0gX2JlbmVmaWNpYXJ5IGFkZHJlc3Mgb2YgdGhlIGJlbmVmaWNpYXJ5IHRvIHdob20gdmVzdGVkIHRva2VucyBhcmUgdHJhbnNmZXJyZWQKICAgKiBAcGFyYW0gX2NsaWZmIGR1cmF0aW9uIGluIHNlY29uZHMgb2YgdGhlIGNsaWZmIGluIHdoaWNoIHRva2VucyB3aWxsIGJlZ2luIHRvIHZlc3QKICAgKiBAcGFyYW0gX2R1cmF0aW9uIGR1cmF0aW9uIGluIHNlY29uZHMgb2YgdGhlIHBlcmlvZCBpbiB3aGljaCB0aGUgdG9rZW5zIHdpbGwgdmVzdAogICAqIEBwYXJhbSBfcmV2b2NhYmxlIHdoZXRoZXIgdGhlIHZlc3RpbmcgaXMgcmV2b2NhYmxlIG9yIG5vdAogICAqLwogIGZ1bmN0aW9uIFRva2VuVmVzdGluZyhhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludDI1NiBfc3RhcnQsIHVpbnQyNTYgX2NsaWZmLCB1aW50MjU2IF9kdXJhdGlvbiwgYm9vbCBfcmV2b2NhYmxlKSBwdWJsaWMgewogICAgcmVxdWlyZShfYmVuZWZpY2lhcnkgIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF9jbGlmZiA8PSBfZHVyYXRpb24pOwoKICAgIGJlbmVmaWNpYXJ5ID0gX2JlbmVmaWNpYXJ5OwogICAgcmV2b2NhYmxlID0gX3Jldm9jYWJsZTsKICAgIGR1cmF0aW9uID0gX2R1cmF0aW9uOwogICAgY2xpZmYgPSBfc3RhcnQuYWRkKF9jbGlmZik7CiAgICBzdGFydCA9IF9zdGFydDsKICB9CgogIC8qKgogICAqIEBub3RpY2UgVHJhbnNmZXJzIHZlc3RlZCB0b2tlbnMgdG8gYmVuZWZpY2lhcnkuCiAgICogQHBhcmFtIHRva2VuIEVSQzIwIHRva2VuIHdoaWNoIGlzIGJlaW5nIHZlc3RlZAogICAqLwogIGZ1bmN0aW9uIHJlbGVhc2UoRVJDMjBCYXNpYyB0b2tlbikgcHVibGljIHsKICAgIHVpbnQyNTYgdW5yZWxlYXNlZCA9IHJlbGVhc2FibGVBbW91bnQodG9rZW4pOwoKICAgIHJlcXVpcmUodW5yZWxlYXNlZCA+IDApOwoKICAgIHJlbGVhc2VkW3Rva2VuXSA9IHJlbGVhc2VkW3Rva2VuXS5hZGQodW5yZWxlYXNlZCk7CgogICAgdG9rZW4uc2FmZVRyYW5zZmVyKGJlbmVmaWNpYXJ5LCB1bnJlbGVhc2VkKTsKCiAgICBSZWxlYXNlZCh1bnJlbGVhc2VkKTsKICB9CgogIC8qKgogICAqIEBub3RpY2UgQWxsb3dzIHRoZSBvd25lciB0byByZXZva2UgdGhlIHZlc3RpbmcuIFRva2VucyBhbHJlYWR5IHZlc3RlZAogICAqIHJlbWFpbiBpbiB0aGUgY29udHJhY3QsIHRoZSByZXN0IGFyZSByZXR1cm5lZCB0byB0aGUgb3duZXIuCiAgICogQHBhcmFtIHRva2VuIEVSQzIwIHRva2VuIHdoaWNoIGlzIGJlaW5nIHZlc3RlZAogICAqLwogIGZ1bmN0aW9uIHJldm9rZShFUkMyMEJhc2ljIHRva2VuKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUocmV2b2NhYmxlKTsKICAgIHJlcXVpcmUoIXJldm9rZWRbdG9rZW5dKTsKCiAgICB1aW50MjU2IGJhbGFuY2UgPSB0b2tlbi5iYWxhbmNlT2YodGhpcyk7CgogICAgdWludDI1NiB1bnJlbGVhc2VkID0gcmVsZWFzYWJsZUFtb3VudCh0b2tlbik7CiAgICB1aW50MjU2IHJlZnVuZCA9IGJhbGFuY2Uuc3ViKHVucmVsZWFzZWQpOwoKICAgIHJldm9rZWRbdG9rZW5dID0gdHJ1ZTsKCiAgICB0b2tlbi5zYWZlVHJhbnNmZXIob3duZXIsIHJlZnVuZCk7CgogICAgUmV2b2tlZCgpOwogIH0KCiAgLyoqCiAgICogQGRldiBDYWxjdWxhdGVzIHRoZSBhbW91bnQgdGhhdCBoYXMgYWxyZWFkeSB2ZXN0ZWQgYnV0IGhhc24ndCBiZWVuIHJlbGVhc2VkIHlldC4KICAgKiBAcGFyYW0gdG9rZW4gRVJDMjAgdG9rZW4gd2hpY2ggaXMgYmVpbmcgdmVzdGVkCiAgICovCiAgZnVuY3Rpb24gcmVsZWFzYWJsZUFtb3VudChFUkMyMEJhc2ljIHRva2VuKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gdmVzdGVkQW1vdW50KHRva2VuKS5zdWIocmVsZWFzZWRbdG9rZW5dKTsKICB9CgogIC8qKgogICAqIEBkZXYgQ2FsY3VsYXRlcyB0aGUgYW1vdW50IHRoYXQgaGFzIGFscmVhZHkgdmVzdGVkLgogICAqIEBwYXJhbSB0b2tlbiBFUkMyMCB0b2tlbiB3aGljaCBpcyBiZWluZyB2ZXN0ZWQKICAgKi8KICBmdW5jdGlvbiB2ZXN0ZWRBbW91bnQoRVJDMjBCYXNpYyB0b2tlbikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjdXJyZW50QmFsYW5jZSA9IHRva2VuLmJhbGFuY2VPZih0aGlzKTsKICAgIHVpbnQyNTYgdG90YWxCYWxhbmNlID0gY3VycmVudEJhbGFuY2UuYWRkKHJlbGVhc2VkW3Rva2VuXSk7CgogICAgaWYgKG5vdyA8IGNsaWZmKSB7CiAgICAgIHJldHVybiAwOwogICAgfSBlbHNlIGlmIChub3cgPj0gc3RhcnQuYWRkKGR1cmF0aW9uKSB8fCByZXZva2VkW3Rva2VuXSkgewogICAgICByZXR1cm4gdG90YWxCYWxhbmNlOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHRvdGFsQmFsYW5jZS5tdWwobm93LnN1YihzdGFydCkpLmRpdihkdXJhdGlvbik7CiAgICB9CiAgfQp9CgovLyA9PT0gTW9kaWZpZWQgT3BlblplcHBlbGluIGNvbnRyYWN0cyA9PT0KCi8qKgogKiBAdGl0bGUgQnVybmFibGUgVG9rZW4KICogQGRldiBUb2tlbiB0aGF0IGNhbiBiZSBpcnJldmVyc2libHkgYnVybmVkIChkZXN0cm95ZWQpLgogKiBCYXNlZCBvbiBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5L2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy90b2tlbi9FUkMyMC9CdXJuYWJsZVRva2VuLnNvbAogKi8KY29udHJhY3QgQnVybmFibGVUb2tlbiBpcyBCYXNpY1Rva2VuIHsKCiAgICBldmVudCBCdXJuKGFkZHJlc3MgaW5kZXhlZCBidXJuZXIsIHVpbnQyNTYgdmFsdWUpOwoKICAgIC8qKgogICAgICogQGRldiBCdXJucyBhIHNwZWNpZmljIGFtb3VudCBvZiB0b2tlbnMuCiAgICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgYnVybmVkLgogICAgICovCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW21zZy5zZW5kZXJdKTsKICAgICAgICAvLyBubyBuZWVkIHRvIHJlcXVpcmUgdmFsdWUgPD0gdG90YWxTdXBwbHksIHNpbmNlIHRoYXQgd291bGQgaW1wbHkgdGhlCiAgICAgICAgLy8gc2VuZGVyJ3MgYmFsYW5jZSBpcyBncmVhdGVyIHRoYW4gdGhlIHRvdGFsU3VwcGx5LCB3aGljaCAqc2hvdWxkKiBiZSBhbiBhc3NlcnRpb24gZmFpbHVyZQoKICAgICAgICBhZGRyZXNzIGJ1cm5lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgYmFsYW5jZXNbYnVybmVyXSA9IGJhbGFuY2VzW2J1cm5lcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgdG90YWxTdXBwbHlfID0gdG90YWxTdXBwbHlfLnN1YihfdmFsdWUpOwogICAgICAgIEJ1cm4oYnVybmVyLCBfdmFsdWUpOwogICAgICAgIFRyYW5zZmVyKGJ1cm5lciwgYWRkcmVzcygwKSwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQoKLyoqCiAqIEB0aXRsZSBCT0JUb2tlblZlc3RpbmcKICogQGRldiBFeHRlbmRzIFRva2VuVmVzdGluZyBjb250cmFjdCB0byBhbGxvdyByZWNsYWltIGV0aGVyIGFuZCBjb250cmFjdHMsIGlmIHRyYW5zZmVyZWQgdG8gdGhpcyBieSBtaXN0YWtlLgogKi8KY29udHJhY3QgQk9CVG9rZW5WZXN0aW5nIGlzIFRva2VuVmVzdGluZywgSGFzTm9FdGhlciwgSGFzTm9Db250cmFjdHMsIERlc3RydWN0aWJsZSB7CgogICAgLyoqCiAgICAgKiBAZGV2IENhbGwgY29uc3R1cmN0b3Igb2YgVG9rZW5WZXN0aW5nIHdpdGggZXhhY3RseSBzYW1lIHBhcmFtZXRlcnMKICAgICAqLwogICAgZnVuY3Rpb24gQk9CVG9rZW5WZXN0aW5nKGFkZHJlc3MgX2JlbmVmaWNpYXJ5LCB1aW50MjU2IF9zdGFydCwgdWludDI1NiBfY2xpZmYsIHVpbnQyNTYgX2R1cmF0aW9uLCBib29sIF9yZXZvY2FibGUpIAogICAgICAgICAgICAgICAgVG9rZW5WZXN0aW5nKCAgICAgICAgX2JlbmVmaWNpYXJ5LCAgICAgICAgIF9zdGFydCwgICAgICAgICBfY2xpZmYsICAgICAgICAgX2R1cmF0aW9uLCAgICAgIF9yZXZvY2FibGUpIHB1YmxpYyB7fQoKfQoKCi8qKgogKiBAdGl0bGUgUGF1c2FibGUgRVJDODI3dG9rZW4KICogQGRldiBFUkM4MjdUb2tlbiBtb2RpZmllZCB3aXRoIHBhdXNhYmxlIHRyYW5zZmVycy4gQmFzZWQgb24gT3BlblplcHBlbGluJ3MgUGF1c2FibGVUb2tlbgogKiovCmNvbnRyYWN0IFBhdXNhYmxlRVJDODI3VG9rZW4gaXMgRVJDODI3VG9rZW4sIFBhdXNhYmxlIHsKCiAgICAvLyBFUkMyMCBmdW5jdGlvbnMKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgICB9CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci5hcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLmluY3JlYXNlQXBwcm92YWwoX3NwZW5kZXIsIF9hZGRlZFZhbHVlKTsKICAgIH0KICAgIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXR1cm4gc3VwZXIuZGVjcmVhc2VBcHByb3ZhbChfc3BlbmRlciwgX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CgogICAgLy9FUkM4MjcgZnVuY3Rpb25zCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9kYXRhKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlLCBfZGF0YSk7CiAgICB9CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlLCBfZGF0YSk7CiAgICB9CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci5hcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUsIF9kYXRhKTsKICAgIH0KICAgIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSwgYnl0ZXMgX2RhdGEpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJldHVybiBzdXBlci5pbmNyZWFzZUFwcHJvdmFsKF9zcGVuZGVyLCBfYWRkZWRWYWx1ZSwgX2RhdGEpOwogICAgfQogICAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUsIGJ5dGVzIF9kYXRhKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXR1cm4gc3VwZXIuZGVjcmVhc2VBcHByb3ZhbChfc3BlbmRlciwgX3N1YnRyYWN0ZWRWYWx1ZSwgX2RhdGEpOwogICAgfQp9CgovLyA9PT0gQm9iJ3MgUmVwYWlyIENvbnRyYWN0cyA9PT0KCi8qKgogKiBAdGl0bGUgQWlyZHJvcHBhYmxlIFRva2VuCiAqLwpjb250cmFjdCBBaXJkcm9wVG9rZW4gaXMgUGF1c2FibGVFUkM4MjdUb2tlbiB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKICAgIHVpbnQ4IHByaXZhdGUgY29uc3RhbnQgUEVSQ0VOVF9ESVZJREVSID0gMTAwOyAgCgogICAgZXZlbnQgQWlyZHJvcFN0YXJ0KHVpbnQyNTYgbXVsdGlwbGllclBlcmNlbnQsIHVpbnQyNTYgYWlyZHJvcE51bWJlcik7CiAgICBldmVudCBBaXJkcm9wQ29tcGxldGUodWludDI1NiBhaXJkcm9wTnVtYmVyKTsKCiAgICB1aW50MjU2IHB1YmxpYyBtdWx0aXBsaWVyUGVyY2VudCA9IDA7ICAgICAgICAgICAgICAgLy9NdWx0aXBsaWVyIG9mIGN1cnJlbnQgYWlyZHJvcCAoZm9yIGV4YW1wbGUsIG11bHRpcGxpZXJQZXJjZW50ID0gMjAwIGFuZCBob2xkZXIgYmFsYW5jZSBpcyAxIFRPS0VOLCBhZnRlciBhaXJkcm9wIGl0IHdpbGwgYmUgMiBUT0tFTikKICAgIHVpbnQyNTYgcHVibGljIGN1cnJlbnRBaXJkcm9wID0gMDsgICAgICAgICAgICAgICAgICAvL051bWJlciBvZiBjdXJyZW50IGFpcmRyb3AuIElmIDAgLSBubyBhaXJkcm9wIHN0YXJ0ZWQKICAgIHVpbnQyNTYgcHVibGljIHVuZHJvcHBlZDsgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0Ftb3VudCBub3QgeWV0IGFpcmRyb3BwZWQKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgYWlyZHJvcHBlZDsgICAgICAgIC8vbWFwIG9mIGFscmVkYXkgYWlyZHJvcHBlZCBhZGRyZXNzZXMgICAgICAgCgogICAgLyoqCiAgICAqIEBub3RpY2UgU3RhcnQgYWlyZHJvcAogICAgKiBAcGFyYW0gX211bHRpcGxpZXJQZXJjZW50IE11bHRpcGxpZXIgb2YgdGhlIGFpcmRyb3AKICAgICovCiAgICBmdW5jdGlvbiBzdGFydEFpcmRyb3AodWludDI1NiBfbXVsdGlwbGllclBlcmNlbnQpIG9ubHlPd25lciBleHRlcm5hbCByZXR1cm5zKGJvb2wpewogICAgICAgIHBhdXNlKCk7CiAgICAgICAgcmVxdWlyZShtdWx0aXBsaWVyUGVyY2VudCA9PSAwKTsgICAgICAgICAgICAgICAgIC8vVGhpcyBtZWFucyBhaXJkcm9wIHdhcyBmaW5pc2hlZAogICAgICAgIHJlcXVpcmUoX211bHRpcGxpZXJQZXJjZW50ID4gUEVSQ0VOVF9ESVZJREVSKTsgICAvL1JlcXVpcmUgdGhhdCBhZnRlciBhaXJkcm9wIGFtb3VudCBvZiB0b2tlbnMgd2lsbCBiZSBncmVhdGVyIHRoYW4gYmVmb3JlCiAgICAgICAgY3VycmVudEFpcmRyb3AgPSBjdXJyZW50QWlyZHJvcC5hZGQoMSk7CiAgICAgICAgbXVsdGlwbGllclBlcmNlbnQgPSBfbXVsdGlwbGllclBlcmNlbnQ7CiAgICAgICAgdW5kcm9wcGVkID0gdG90YWxTdXBwbHkoKTsKICAgICAgICBhc3NlcnQobXVsdGlwbGllclBlcmNlbnQubXVsKHVuZHJvcHBlZCkgPiAwKTsgICAvL0Fzc2VydCB0aGF0IHdyb25nIG11bHRpcGxpZXIgd2lsbCBub3QgcmVzdWx0IGluIG93ZXJmbG93IGluIGFpcmRyb3BBbW91bnQoKQogICAgICAgIEFpcmRyb3BTdGFydChtdWx0aXBsaWVyUGVyY2VudCwgY3VycmVudEFpcmRyb3ApOwogICAgfQogICAgLyoqCiAgICAqIEBub3RpY2UgRmluaXNoIGFpcmRyb3AsIHVucGF1c2UgdG9rZW4gdHJhbnNmZXJzCiAgICAqIEBkZXYgQW55b25lIGNhbiBjYWxsIHRoaXMgZnVuY3Rpb24gYWZ0ZXIgYWxsIGFkZHJlc3NlcyBhcmUgYWlyZHJvcHBlZAogICAgKi8KICAgIGZ1bmN0aW9uIGZpbmlzaEFpcmRyb3AoKSBleHRlcm5hbCByZXR1cm5zKGJvb2wpewogICAgICAgIHJlcXVpcmUodW5kcm9wcGVkID09IDApOwogICAgICAgIG11bHRpcGxpZXJQZXJjZW50ID0gMDsKICAgICAgICBBaXJkcm9wQ29tcGxldGUoY3VycmVudEFpcmRyb3ApOwogICAgICAgIHVucGF1c2UoKTsKICAgIH0KCiAgICAvKioKICAgICogQG5vdGljZSBFeGVjdXRlIGFpcmRyb3AgZm9yIGEgYnVuY2ggb2YgYWRkcmVzc2VzLiBTaG91bGQgYmUgcmVwZWF0ZWQgZm9yIGFsbCBhZGRyZXNzZXMgd2l0aCBub24temVybyBhbW91bnQgb2YgdG9rZW5zLgogICAgKiBAZGV2IFRoaXMgZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCBieSBhbnlvbmUsIG5vdCBvbmx5IHRoZSBvd25lcgogICAgKiBAcGFyYW0gaG9sZGVycyBBcnJheSBvZiB0b2tlbiBob2xkZXIgYWRkcmVzc2VzLgogICAgKiBAcmV0dXJuIHRydWUgaWYgc3VjY2VzcwogICAgKi8KICAgIGZ1bmN0aW9uIGRyb3AoYWRkcmVzc1tdIGhvbGRlcnMpIGV4dGVybmFsIHJldHVybnMoYm9vbCl7CiAgICAgICAgZm9yKHVpbnQyNTYgaT0wOyBpIDwgaG9sZGVycy5sZW5ndGg7IGkrKyl7CiAgICAgICAgICAgIGFkZHJlc3MgaG9sZGVyID0gaG9sZGVyc1tpXTsKICAgICAgICAgICAgaWYoIWlzQWlyZHJvcHBlZChob2xkZXIpKXsKICAgICAgICAgICAgICAgIHVpbnQyNTYgYmFsYW5jZSA9IGJhbGFuY2VzW2hvbGRlcl07CiAgICAgICAgICAgICAgICB1bmRyb3BwZWQgPSB1bmRyb3BwZWQuc3ViKGJhbGFuY2UpOwogICAgICAgICAgICAgICAgYmFsYW5jZXNbaG9sZGVyXSA9IGFpcmRyb3BBbW91bnQoYmFsYW5jZSk7CiAgICAgICAgICAgICAgICB1aW50MjU2IGFtb3VudCA9IGJhbGFuY2VzW2hvbGRlcl0uc3ViKGJhbGFuY2UpOwogICAgICAgICAgICAgICAgdG90YWxTdXBwbHlfID0gdG90YWxTdXBwbHlfLmFkZChhbW91bnQpOwogICAgICAgICAgICAgICAgVHJhbnNmZXIoYWRkcmVzcygwKSwgaG9sZGVyLCBhbW91bnQpOwogICAgICAgICAgICAgICAgc2V0QWlyZHJvcHBlZChob2xkZXIpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgLyoqCiAgICAqIEBub3RpY2UgQ2FsY3VsYXRlcyBhbW91bnQgb2YgdG9rZW5zIGFmdGVyIGFpcmRyb3AKICAgICogQHBhcmFtIGFtb3VudCBCYWxhbmNlIGJlZm9yZSBhaXJkcm9wCiAgICAqIEByZXR1cm4gQW1vdW50IG9mIHRva2VucyBhZnRlciBhaXJkcm9wCiAgICAqLwogICAgZnVuY3Rpb24gYWlyZHJvcEFtb3VudCh1aW50MjU2IGFtb3VudCkgdmlldyBwdWJsaWMgcmV0dXJucyh1aW50MjU2KXsKICAgICAgICByZXF1aXJlKG11bHRpcGxpZXJQZXJjZW50ID4gMCk7CiAgICAgICAgcmV0dXJuIG11bHRpcGxpZXJQZXJjZW50Lm11bChhbW91bnQpLmRpdihQRVJDRU5UX0RJVklERVIpOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IENoZWNrIGlmIGFkZHJlc3Mgd2FzIGFscmVhZHkgYWlyZHJvcHBlZAogICAgKiBAcGFyYW0gaG9sZGVyIEFkZHJlc3Mgb2YgdG9rZW4gaG9sZGVyCiAgICAqIEByZXR1cm4gdHJ1ZSBpZiBhZGRyZXNzIHdhcyBhaXJkcm9wcGVkCiAgICAqLwogICAgZnVuY3Rpb24gaXNBaXJkcm9wcGVkKGFkZHJlc3MgaG9sZGVyKSB2aWV3IGludGVybmFsIHJldHVybnMoYm9vbCl7CiAgICAgICAgcmV0dXJuIChhaXJkcm9wcGVkW2hvbGRlcl0gPT0gY3VycmVudEFpcmRyb3ApOwogICAgfQogICAgLyoqCiAgICAqIEBkZXYgTWFyayBhZGRyZXNzIGFzIGFpcmRyb3BwZWQKICAgICogQHBhcmFtIGhvbGRlciBBZGRyZXNzIG9mIHRva2VuIGhvbGRlcgogICAgKi8KICAgIGZ1bmN0aW9uIHNldEFpcmRyb3BwZWQoYWRkcmVzcyBob2xkZXIpIGludGVybmFsIHsKICAgICAgICBhaXJkcm9wcGVkW2hvbGRlcl0gPSBjdXJyZW50QWlyZHJvcDsKICAgIH0KfQoKY29udHJhY3QgQk9CVG9rZW4gaXMgQWlyZHJvcFRva2VuLCBNaW50YWJsZVRva2VuLCBCdXJuYWJsZVRva2VuLCBOb093bmVyIHsKICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gJ0JPQic7CiAgICBzdHJpbmcgcHVibGljIG5hbWUgPSAnQk9CIFRva2VuJzsKICAgIHVpbnQ4IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwoKICAgIGFkZHJlc3MgZm91bmRlcjsgICAgICAgICAgICAgICAgLy9mb3VuZGVyIGFkZHJlc3MgdG8gYWxsb3cgaGltIHRyYW5zZmVyIHRva2VucyBldmVuIHdoZW4gdHJhbnNmZXJzIGRpc2FibGVkCiAgICBib29sIHB1YmxpYyB0cmFuc2ZlckVuYWJsZWQ7ICAgIC8vYWxsb3dzIHRvIGRpc3NhYmxlIHRyYW5zZmVycyB3aGlsZSBtaW50aW5nIGFuZCBpbiBjYXNlIG9mIGVtZXJnZW5jeQoKICAgIGZ1bmN0aW9uIHNldEZvdW5kZXIoYWRkcmVzcyBfZm91bmRlcikgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgZm91bmRlciA9IF9mb3VuZGVyOwogICAgfQogICAgZnVuY3Rpb24gc2V0VHJhbnNmZXJFbmFibGVkKGJvb2wgZW5hYmxlKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICB0cmFuc2ZlckVuYWJsZWQgPSBlbmFibGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBBbGxvdyB0cmFuc2ZlciBvbmx5IGFmdGVyIGNyb3dkc2FsZSBmaW5pc2hlZAogICAgICovCiAgICBtb2RpZmllciBjYW5UcmFuc2ZlcigpIHsKICAgICAgICByZXF1aXJlKCB0cmFuc2ZlckVuYWJsZWQgfHwgbXNnLnNlbmRlciA9PSBmb3VuZGVyIHx8IG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgY2FuVHJhbnNmZXIgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIGNhblRyYW5zZmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2RhdGEpIGNhblRyYW5zZmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlLCBfZGF0YSk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2RhdGEpIGNhblRyYW5zZmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUsIF9kYXRhKTsKICAgIH0KfQ=='.
	

]
