Class {
	#name : #SRTda9c03dfd4d137f926c3cf6953cb951832eb08b2,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTda9c03dfd4d137f926c3cf6953cb951832eb08b2 >> base64 [
	^ 'LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KLyogQ29weXJpZ2h0IChjKSAyMDE4IFRoZSBldGhlci5vbmxpbmUgUHJvamVjdC4gIEFsbCByaWdodHMgcmVzZXJ2ZWQuCi8qIAovKiBodHRwczovL2V0aGVyLm9ubGluZSAgVGhlIGZpcnN0IFJQRyBnYW1lIG9mIGJsb2NrY2hhaW4gICAgICAgICAgICAgICAgIAovKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLwpwcmFnbWEgc29saWRpdHkgXjAuNC4yMDsKCi8vLyBAdGl0bGUgRVJDLTE2NSBTdGFuZGFyZCBJbnRlcmZhY2UgRGV0ZWN0aW9uCi8vLyBAZGV2IFNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9ibG9iL21hc3Rlci9FSVBTL2VpcC0xNjUubWQKaW50ZXJmYWNlIEVSQzE2NSB7CiAgICBmdW5jdGlvbiBzdXBwb3J0c0ludGVyZmFjZShieXRlczQgaW50ZXJmYWNlSUQpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCk7Cn0KCi8vLyBAdGl0bGUgRVJDLTcyMSBOb24tRnVuZ2libGUgVG9rZW4gU3RhbmRhcmQKLy8vIEBkZXYgU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2Jsb2IvbWFzdGVyL0VJUFMvZWlwLTcyMS5tZApjb250cmFjdCBFUkM3MjEgaXMgRVJDMTY1IHsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdG9rZW5JZCk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX2FwcHJvdmVkLCB1aW50MjU2IF90b2tlbklkKTsKICAgIGV2ZW50IEFwcHJvdmFsRm9yQWxsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfb3BlcmF0b3IsIGJvb2wgX2FwcHJvdmVkKTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQsIGJ5dGVzIGRhdGEpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gc2FmZVRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9hcHByb3ZlZCwgdWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBzZXRBcHByb3ZhbEZvckFsbChhZGRyZXNzIF9vcGVyYXRvciwgYm9vbCBfYXBwcm92ZWQpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gZ2V0QXBwcm92ZWQodWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIGlzQXBwcm92ZWRGb3JBbGwoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX29wZXJhdG9yKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpOwp9CgovLy8gQHRpdGxlIEVSQy03MjEgTm9uLUZ1bmdpYmxlIFRva2VuIFN0YW5kYXJkCmludGVyZmFjZSBFUkM3MjFUb2tlblJlY2VpdmVyIHsKCWZ1bmN0aW9uIG9uRVJDNzIxUmVjZWl2ZWQoYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdG9rZW5JZCwgYnl0ZXMgZGF0YSkgZXh0ZXJuYWwgcmV0dXJucyhieXRlczQpOwp9Cgpjb250cmFjdCBBY2Nlc3NBZG1pbiB7CiAgICBib29sIHB1YmxpYyBpc1BhdXNlZCA9IGZhbHNlOwogICAgYWRkcmVzcyBwdWJsaWMgYWRkckFkbWluOyAgCgogICAgZXZlbnQgQWRtaW5UcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJlQWRtaW4sIGFkZHJlc3MgaW5kZXhlZCBuZXdBZG1pbik7CgogICAgZnVuY3Rpb24gQWNjZXNzQWRtaW4oKSBwdWJsaWMgewogICAgICAgIGFkZHJBZG1pbiA9IG1zZy5zZW5kZXI7CiAgICB9ICAKCgogICAgbW9kaWZpZXIgb25seUFkbWluKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBhZGRyQWRtaW4pOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgd2hlbk5vdFBhdXNlZCgpIHsKICAgICAgICByZXF1aXJlKCFpc1BhdXNlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciB3aGVuUGF1c2VkIHsKICAgICAgICByZXF1aXJlKGlzUGF1c2VkKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEFkbWluKGFkZHJlc3MgX25ld0FkbWluKSBleHRlcm5hbCBvbmx5QWRtaW4gewogICAgICAgIHJlcXVpcmUoX25ld0FkbWluICE9IGFkZHJlc3MoMCkpOwogICAgICAgIEFkbWluVHJhbnNmZXJyZWQoYWRkckFkbWluLCBfbmV3QWRtaW4pOwogICAgICAgIGFkZHJBZG1pbiA9IF9uZXdBZG1pbjsKICAgIH0KCiAgICBmdW5jdGlvbiBkb1BhdXNlKCkgZXh0ZXJuYWwgb25seUFkbWluIHdoZW5Ob3RQYXVzZWQgewogICAgICAgIGlzUGF1c2VkID0gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBkb1VucGF1c2UoKSBleHRlcm5hbCBvbmx5QWRtaW4gd2hlblBhdXNlZCB7CiAgICAgICAgaXNQYXVzZWQgPSBmYWxzZTsKICAgIH0KfQoKY29udHJhY3QgV2FyVG9rZW4gaXMgRVJDNzIxLCBBY2Nlc3NBZG1pbiB7CiAgICAvLy8gQGRldiBUaGUgZXF1aXBtZW50IGluZm8KICAgIHN0cnVjdCBGYXNoaW9uIHsKICAgICAgICB1aW50MTYgcHJvdG9JZDsgICAgIC8vIDAgIEVxdWlwbWVudCBJRAogICAgICAgIHVpbnQxNiBxdWFsaXR5OyAgICAgLy8gMSAgUmFyaXR5OiAxIENvYXJzZS8yIEdvb2QvMyBSYXJlLzQgRXBpYy81IExlZ2VuZGFyeQogICAgICAgIHVpbnQxNiBwb3M7ICAgICAgICAgLy8gMiAgU2xvdHM6IDEgV2VhcG9uLzIgSGF0LzMgQ2xvdGgvNCBQYW50LzUgU2hvZXMvOSBQZXRzCiAgICAgICAgdWludDE2IGhlYWx0aDsgICAgICAvLyAzICBIZWFsdGgKICAgICAgICB1aW50MTYgYXRrTWluOyAgICAgIC8vIDQgIE1pbiBhdHRhY2sKICAgICAgICB1aW50MTYgYXRrTWF4OyAgICAgIC8vIDUgIE1heCBhdHRhY2sKICAgICAgICB1aW50MTYgZGVmZW5jZTsgICAgIC8vIDYgIERlZmVubnNlCiAgICAgICAgdWludDE2IGNyaXQ7ICAgICAgICAvLyA3ICBDcml0aWNhbCByYXRlCiAgICAgICAgdWludDE2IGlzUGVyY2VudDsgICAvLyA4ICBBdHRyIHZhbHVlIHR5cGUKICAgICAgICB1aW50MTYgYXR0ckV4dDE7ICAgIC8vIDkgIGZ1dHVyZSBzdGF0IDEKICAgICAgICB1aW50MTYgYXR0ckV4dDI7ICAgIC8vIDEwIGZ1dHVyZSBzdGF0IDIKICAgICAgICB1aW50MTYgYXR0ckV4dDM7ICAgIC8vIDExIGZ1dHVyZSBzdGF0IDMKICAgIH0KCiAgICAvLy8gQGRldiBBbGwgZXF1aXBtZW50cyB0b2tlbkFycmF5IChub3QgZXhjZWVkaW5nIDJeMzItMSkKICAgIEZhc2hpb25bXSBwdWJsaWMgZmFzaGlvbkFycmF5OwoKICAgIC8vLyBAZGV2IEFtb3VudCBvZiB0b2tlbnMgZGVzdHJveWVkCiAgICB1aW50MjU2IGRlc3Ryb3lGYXNoaW9uQ291bnQ7CgogICAgLy8vIEBkZXYgRXF1aXBtZW50IHRva2VuIElEIHZzIG93bmVyIGFkZHJlc3MKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgZmFzaGlvbklkVG9Pd25lcjsKCiAgICAvLy8gQGRldiBFcXVpcG1lbnRzIG93bmVyIGJ5IHRoZSBvd25lciAoYXJyYXkpCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTZbXSkgb3duZXJUb0Zhc2hpb25BcnJheTsKCiAgICAvLy8gQGRldiBFcXVpcG1lbnQgdG9rZW4gSUQgc2VhcmNoIGluIG93bmVyIGFycmF5CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IHVpbnQyNTYpIGZhc2hpb25JZFRvT3duZXJJbmRleDsKCiAgICAvLy8gQGRldiBUaGUgYXV0aG9yaXplZCBhZGRyZXNzIGZvciBlYWNoIFdBUgogICAgbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSBmYXNoaW9uSWRUb0FwcHJvdmFsczsKCiAgICAvLy8gQGRldiBUaGUgYXV0aG9yaXplZCBvcGVyYXRvcnMgZm9yIGVhY2ggYWRkcmVzcwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpKSBvcGVyYXRvclRvQXBwcm92YWxzOwoKICAgIC8vLyBAZGV2IFRydXN0IGNvbnRyYWN0CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIGFjdGlvbkNvbnRyYWN0czsKCiAgICBmdW5jdGlvbiBzZXRBY3Rpb25Db250cmFjdChhZGRyZXNzIF9hY3Rpb25BZGRyLCBib29sIF91c2VmdWwpIGV4dGVybmFsIG9ubHlBZG1pbiB7CiAgICAgICAgYWN0aW9uQ29udHJhY3RzW19hY3Rpb25BZGRyXSA9IF91c2VmdWw7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QWN0aW9uQ29udHJhY3QoYWRkcmVzcyBfYWN0aW9uQWRkcikgZXh0ZXJuYWwgdmlldyBvbmx5QWRtaW4gcmV0dXJucyhib29sKSB7CiAgICAgICAgcmV0dXJuIGFjdGlvbkNvbnRyYWN0c1tfYWN0aW9uQWRkcl07CiAgICB9CgogICAgLy8vIEBkZXYgVGhpcyBlbWl0cyB3aGVuIHRoZSBhcHByb3ZlZCBhZGRyZXNzIGZvciBhbiBXQVIgaXMgY2hhbmdlZCBvciByZWFmZmlybWVkLgogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9hcHByb3ZlZCwgdWludDI1NiBfdG9rZW5JZCk7CgogICAgLy8vIEBkZXYgVGhpcyBlbWl0cyB3aGVuIGFuIG9wZXJhdG9yIGlzIGVuYWJsZWQgb3IgZGlzYWJsZWQgZm9yIGFuIG93bmVyLgogICAgZXZlbnQgQXBwcm92YWxGb3JBbGwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9vcGVyYXRvciwgYm9vbCBfYXBwcm92ZWQpOwoKICAgIC8vLyBAZGV2IFRoaXMgZW1pdHMgd2hlbiB0aGUgZXF1aXBtZW50IG93bmVyc2hpcCBjaGFuZ2VkIAogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB0b2tlbklkKTsKCiAgICAvLy8gQGRldiBUaGlzIGVtaXRzIHdoZW4gdGhlIGVxdWlwbWVudCBjcmVhdGVkCiAgICBldmVudCBDcmVhdGVGYXNoaW9uKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgdWludDI1NiB0b2tlbklkLCB1aW50MTYgcHJvdG9JZCwgdWludDE2IHF1YWxpdHksIHVpbnQxNiBwb3MsIHVpbnQxNiBjcmVhdGVUeXBlKTsKCiAgICAvLy8gQGRldiBUaGlzIGVtaXRzIHdoZW4gdGhlIGVxdWlwbWVudCdzIGF0dHJpYnV0ZXMgY2hhbmdlZAogICAgZXZlbnQgQ2hhbmdlRmFzaGlvbihhZGRyZXNzIGluZGV4ZWQgb3duZXIsIHVpbnQyNTYgdG9rZW5JZCwgdWludDE2IGNoYW5nZVR5cGUpOwoKICAgIC8vLyBAZGV2IFRoaXMgZW1pdHMgd2hlbiB0aGUgZXF1aXBtZW50IGRlc3Ryb3llZAogICAgZXZlbnQgRGVsZXRlRmFzaGlvbihhZGRyZXNzIGluZGV4ZWQgb3duZXIsIHVpbnQyNTYgdG9rZW5JZCwgdWludDE2IGRlbGV0ZVR5cGUpOwogICAgCiAgICBmdW5jdGlvbiBXYXJUb2tlbigpIHB1YmxpYyB7CiAgICAgICAgYWRkckFkbWluID0gbXNnLnNlbmRlcjsKICAgICAgICBmYXNoaW9uQXJyYXkubGVuZ3RoICs9IDE7CiAgICB9CgogICAgLy8gbW9kaWZpZXIKICAgIC8vLyBAZGV2IENoZWNrIGlmIHRva2VuIElEIGlzIHZhbGlkCiAgICBtb2RpZmllciBpc1ZhbGlkVG9rZW4odWludDI1NiBfdG9rZW5JZCkgewogICAgICAgIHJlcXVpcmUoX3Rva2VuSWQgPj0gMSAmJiBfdG9rZW5JZCA8PSBmYXNoaW9uQXJyYXkubGVuZ3RoKTsKICAgICAgICByZXF1aXJlKGZhc2hpb25JZFRvT3duZXJbX3Rva2VuSWRdICE9IGFkZHJlc3MoMCkpOyAKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIGNhblRyYW5zZmVyKHVpbnQyNTYgX3Rva2VuSWQpIHsKICAgICAgICBhZGRyZXNzIG93bmVyID0gZmFzaGlvbklkVG9Pd25lcltfdG9rZW5JZF07CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyIHx8IG1zZy5zZW5kZXIgPT0gZmFzaGlvbklkVG9BcHByb3ZhbHNbX3Rva2VuSWRdIHx8IG9wZXJhdG9yVG9BcHByb3ZhbHNbb3duZXJdW21zZy5zZW5kZXJdKTsKICAgICAgICBfOwogICAgfQoKICAgIC8vIEVSQzcyMQogICAgZnVuY3Rpb24gc3VwcG9ydHNJbnRlcmZhY2UoYnl0ZXM0IF9pbnRlcmZhY2VJZCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zKGJvb2wpIHsKICAgICAgICAvLyBFUkMxNjUgfHwgRVJDNzIxIHx8IEVSQzE2NV5FUkM3MjEKICAgICAgICByZXR1cm4gKF9pbnRlcmZhY2VJZCA9PSAweDAxZmZjOWE3IHx8IF9pbnRlcmZhY2VJZCA9PSAweDgwYWM1OGNkIHx8IF9pbnRlcmZhY2VJZCA9PSAweDgxNTM5MTZhKSAmJiAoX2ludGVyZmFjZUlkICE9IDB4ZmZmZmZmZmYpOwogICAgfQogICAgICAgIAogICAgZnVuY3Rpb24gbmFtZSgpIHB1YmxpYyBwdXJlIHJldHVybnMoc3RyaW5nKSB7CiAgICAgICAgcmV0dXJuICJXQVIgVG9rZW4iOwogICAgfQoKICAgIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyBwdXJlIHJldHVybnMoc3RyaW5nKSB7CiAgICAgICAgcmV0dXJuICJXQVIiOwogICAgfQoKICAgIC8vLyBAZGV2IFNlYXJjaCBmb3IgdG9rZW4gcXVhbnRpdHkgYWRkcmVzcwogICAgLy8vIEBwYXJhbSBfb3duZXIgQWRkcmVzcyB0aGF0IG5lZWRzIHRvIGJlIHNlYXJjaGVkCiAgICAvLy8gQHJldHVybiBSZXR1cm5zIHRva2VuIHF1YW50aXR5CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGV4dGVybmFsIHZpZXcgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgcmVxdWlyZShfb3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmV0dXJuIG93bmVyVG9GYXNoaW9uQXJyYXlbX293bmVyXS5sZW5ndGg7CiAgICB9CgogICAgLy8vIEBkZXYgRmluZCB0aGUgb3duZXIgb2YgYW4gV0FSCiAgICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSB0b2tlbklkIG9mIFdBUgogICAgLy8vIEByZXR1cm4gR2l2ZSBUaGUgYWRkcmVzcyBvZiB0aGUgb3duZXIgb2YgdGhpcyBXQVIKICAgIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgZXh0ZXJuYWwgdmlldyAvKmlzVmFsaWRUb2tlbihfdG9rZW5JZCkqLyByZXR1cm5zIChhZGRyZXNzIG93bmVyKSB7CiAgICAgICAgcmV0dXJuIGZhc2hpb25JZFRvT3duZXJbX3Rva2VuSWRdOwogICAgfQoKICAgIC8vLyBAZGV2IFRyYW5zZmVycyB0aGUgb3duZXJzaGlwIG9mIGFuIFdBUiBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIgYWRkcmVzcwogICAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgY3VycmVudCBvd25lciBvZiB0aGUgV0FSCiAgICAvLy8gQHBhcmFtIF90byBUaGUgbmV3IG93bmVyCiAgICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSBXQVIgdG8gdHJhbnNmZXIKICAgIC8vLyBAcGFyYW0gZGF0YSBBZGRpdGlvbmFsIGRhdGEgd2l0aCBubyBzcGVjaWZpZWQgZm9ybWF0LCBzZW50IGluIGNhbGwgdG8gYF90b2AKICAgIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQsIGJ5dGVzIGRhdGEpIAogICAgICAgIGV4dGVybmFsCiAgICAgICAgd2hlbk5vdFBhdXNlZAogICAgewogICAgICAgIF9zYWZlVHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF90b2tlbklkLCBkYXRhKTsKICAgIH0KCiAgICAvLy8gQGRldiBUcmFuc2ZlcnMgdGhlIG93bmVyc2hpcCBvZiBhbiBXQVIgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyIGFkZHJlc3MKICAgIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGN1cnJlbnQgb3duZXIgb2YgdGhlIFdBUgogICAgLy8vIEBwYXJhbSBfdG8gVGhlIG5ldyBvd25lcgogICAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgV0FSIHRvIHRyYW5zZmVyCiAgICBmdW5jdGlvbiBzYWZlVHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSAKICAgICAgICBleHRlcm5hbAogICAgICAgIHdoZW5Ob3RQYXVzZWQKICAgIHsKICAgICAgICBfc2FmZVRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdG9rZW5JZCwgIiIpOwogICAgfQoKICAgIC8vLyBAZGV2IFRyYW5zZmVyIG93bmVyc2hpcCBvZiBhbiBXQVIsICdfdG8nIG11c3QgYmUgYSB2YWlsZCBhZGRyZXNzLCBvciB0aGUgV0FSIHdpbGwgbG9zdAogICAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgY3VycmVudCBvd25lciBvZiB0aGUgV0FSCiAgICAvLy8gQHBhcmFtIF90byBUaGUgbmV3IG93bmVyCiAgICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSBXQVIgdG8gdHJhbnNmZXIKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkKICAgICAgICBleHRlcm5hbAogICAgICAgIHdoZW5Ob3RQYXVzZWQKICAgICAgICBpc1ZhbGlkVG9rZW4oX3Rva2VuSWQpCiAgICAgICAgY2FuVHJhbnNmZXIoX3Rva2VuSWQpCiAgICB7CiAgICAgICAgYWRkcmVzcyBvd25lciA9IGZhc2hpb25JZFRvT3duZXJbX3Rva2VuSWRdOwogICAgICAgIHJlcXVpcmUob3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShvd25lciA9PSBfZnJvbSk7CiAgICAgICAgCiAgICAgICAgX3RyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICAgIH0KCiAgICAvLy8gQGRldiBTZXQgb3IgcmVhZmZpcm0gdGhlIGFwcHJvdmVkIGFkZHJlc3MgZm9yIGFuIFdBUgogICAgLy8vIEBwYXJhbSBfYXBwcm92ZWQgVGhlIG5ldyBhcHByb3ZlZCBXQVIgY29udHJvbGxlcgogICAgLy8vIEBwYXJhbSBfdG9rZW5JZCBUaGUgV0FSIHRvIGFwcHJvdmUKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfYXBwcm92ZWQsIHVpbnQyNTYgX3Rva2VuSWQpCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICB3aGVuTm90UGF1c2VkCiAgICB7CiAgICAgICAgYWRkcmVzcyBvd25lciA9IGZhc2hpb25JZFRvT3duZXJbX3Rva2VuSWRdOwogICAgICAgIHJlcXVpcmUob3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyIHx8IG9wZXJhdG9yVG9BcHByb3ZhbHNbb3duZXJdW21zZy5zZW5kZXJdKTsKCiAgICAgICAgZmFzaGlvbklkVG9BcHByb3ZhbHNbX3Rva2VuSWRdID0gX2FwcHJvdmVkOwogICAgICAgIEFwcHJvdmFsKG93bmVyLCBfYXBwcm92ZWQsIF90b2tlbklkKTsKICAgIH0KCiAgICAvLy8gQGRldiBFbmFibGUgb3IgZGlzYWJsZSBhcHByb3ZhbCBmb3IgYSB0aGlyZCBwYXJ0eSAoIm9wZXJhdG9yIikgdG8gbWFuYWdlIGFsbCB5b3VyIGFzc2V0LgogICAgLy8vIEBwYXJhbSBfb3BlcmF0b3IgQWRkcmVzcyB0byBhZGQgdG8gdGhlIHNldCBvZiBhdXRob3JpemVkIG9wZXJhdG9ycy4KICAgIC8vLyBAcGFyYW0gX2FwcHJvdmVkIFRydWUgaWYgdGhlIG9wZXJhdG9ycyBpcyBhcHByb3ZlZCwgZmFsc2UgdG8gcmV2b2tlIGFwcHJvdmFsCiAgICBmdW5jdGlvbiBzZXRBcHByb3ZhbEZvckFsbChhZGRyZXNzIF9vcGVyYXRvciwgYm9vbCBfYXBwcm92ZWQpIAogICAgICAgIGV4dGVybmFsIAogICAgICAgIHdoZW5Ob3RQYXVzZWQKICAgIHsKICAgICAgICBvcGVyYXRvclRvQXBwcm92YWxzW21zZy5zZW5kZXJdW19vcGVyYXRvcl0gPSBfYXBwcm92ZWQ7CiAgICAgICAgQXBwcm92YWxGb3JBbGwobXNnLnNlbmRlciwgX29wZXJhdG9yLCBfYXBwcm92ZWQpOwogICAgfQoKICAgIC8vLyBAZGV2IEdldCB0aGUgYXBwcm92ZWQgYWRkcmVzcyBmb3IgYSBzaW5nbGUgV0FSCiAgICAvLy8gQHBhcmFtIF90b2tlbklkIFRoZSBXQVIgdG8gZmluZCB0aGUgYXBwcm92ZWQgYWRkcmVzcyBmb3IKICAgIC8vLyBAcmV0dXJuIFRoZSBhcHByb3ZlZCBhZGRyZXNzIGZvciB0aGlzIFdBUiwgb3IgdGhlIHplcm8gYWRkcmVzcyBpZiB0aGVyZSBpcyBub25lCiAgICBmdW5jdGlvbiBnZXRBcHByb3ZlZCh1aW50MjU2IF90b2tlbklkKSBleHRlcm5hbCB2aWV3IGlzVmFsaWRUb2tlbihfdG9rZW5JZCkgcmV0dXJucyAoYWRkcmVzcykgewogICAgICAgIHJldHVybiBmYXNoaW9uSWRUb0FwcHJvdmFsc1tfdG9rZW5JZF07CiAgICB9CgogICAgLy8vIEBkZXYgUXVlcnkgaWYgYW4gYWRkcmVzcyBpcyBhbiBhdXRob3JpemVkIG9wZXJhdG9yIGZvciBhbm90aGVyIGFkZHJlc3MKICAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRoYXQgb3ducyB0aGUgV0FScwogICAgLy8vIEBwYXJhbSBfb3BlcmF0b3IgVGhlIGFkZHJlc3MgdGhhdCBhY3RzIG9uIGJlaGFsZiBvZiB0aGUgb3duZXIKICAgIC8vLyBAcmV0dXJuIFRydWUgaWYgYF9vcGVyYXRvcmAgaXMgYW4gYXBwcm92ZWQgb3BlcmF0b3IgZm9yIGBfb3duZXJgLCBmYWxzZSBvdGhlcndpc2UKICAgIGZ1bmN0aW9uIGlzQXBwcm92ZWRGb3JBbGwoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX29wZXJhdG9yKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gb3BlcmF0b3JUb0FwcHJvdmFsc1tfb3duZXJdW19vcGVyYXRvcl07CiAgICB9CgogICAgLy8vIEBkZXYgQ291bnQgV0FScyB0cmFja2VkIGJ5IHRoaXMgY29udHJhY3QKICAgIC8vLyBAcmV0dXJuIEEgY291bnQgb2YgdmFsaWQgV0FScyB0cmFja2VkIGJ5IHRoaXMgY29udHJhY3QsIHdoZXJlIGVhY2ggb25lIG9mCiAgICAvLy8gIHRoZW0gaGFzIGFuIGFzc2lnbmVkIGFuZCBxdWVyeWFibGUgb3duZXIgbm90IGVxdWFsIHRvIHRoZSB6ZXJvIGFkZHJlc3MKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGZhc2hpb25BcnJheS5sZW5ndGggLSBkZXN0cm95RmFzaGlvbkNvdW50IC0gMTsKICAgIH0KCiAgICAvLy8gQGRldiBEbyB0aGUgcmVhbCB0cmFuc2ZlciB3aXRoIG91dCBhbnkgY29uZGl0aW9uIGNoZWNraW5nCiAgICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBvbGQgb3duZXIgb2YgdGhpcyBXQVIoSWYgY3JlYXRlZDogMHgwKQogICAgLy8vIEBwYXJhbSBfdG8gVGhlIG5ldyBvd25lciBvZiB0aGlzIFdBUiAKICAgIC8vLyBAcGFyYW0gX3Rva2VuSWQgVGhlIHRva2VuSWQgb2YgdGhlIFdBUgogICAgZnVuY3Rpb24gX3RyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBpbnRlcm5hbCB7CiAgICAgICAgaWYgKF9mcm9tICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgdWludDI1NiBpbmRleEZyb20gPSBmYXNoaW9uSWRUb093bmVySW5kZXhbX3Rva2VuSWRdOwogICAgICAgICAgICB1aW50MjU2W10gc3RvcmFnZSBmc0FycmF5ID0gb3duZXJUb0Zhc2hpb25BcnJheVtfZnJvbV07CiAgICAgICAgICAgIHJlcXVpcmUoZnNBcnJheVtpbmRleEZyb21dID09IF90b2tlbklkKTsKCiAgICAgICAgICAgIC8vIElmIHRoZSBXQVIgaXMgbm90IHRoZSBlbGVtZW50IG9mIGFycmF5LCBjaGFuZ2UgaXQgdG8gd2l0aCB0aGUgbGFzdAogICAgICAgICAgICBpZiAoaW5kZXhGcm9tICE9IGZzQXJyYXkubGVuZ3RoIC0gMSkgewogICAgICAgICAgICAgICAgdWludDI1NiBsYXN0VG9rZW5JZCA9IGZzQXJyYXlbZnNBcnJheS5sZW5ndGggLSAxXTsKICAgICAgICAgICAgICAgIGZzQXJyYXlbaW5kZXhGcm9tXSA9IGxhc3RUb2tlbklkOyAKICAgICAgICAgICAgICAgIGZhc2hpb25JZFRvT3duZXJJbmRleFtsYXN0VG9rZW5JZF0gPSBpbmRleEZyb207CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnNBcnJheS5sZW5ndGggLT0gMTsgCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoZmFzaGlvbklkVG9BcHByb3ZhbHNbX3Rva2VuSWRdICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgICAgIGRlbGV0ZSBmYXNoaW9uSWRUb0FwcHJvdmFsc1tfdG9rZW5JZF07CiAgICAgICAgICAgIH0gICAgICAKICAgICAgICB9CgogICAgICAgIC8vIEdpdmUgdGhlIFdBUiB0byAnX3RvJwogICAgICAgIGZhc2hpb25JZFRvT3duZXJbX3Rva2VuSWRdID0gX3RvOwogICAgICAgIG93bmVyVG9GYXNoaW9uQXJyYXlbX3RvXS5wdXNoKF90b2tlbklkKTsKICAgICAgICBmYXNoaW9uSWRUb093bmVySW5kZXhbX3Rva2VuSWRdID0gb3duZXJUb0Zhc2hpb25BcnJheVtfdG9dLmxlbmd0aCAtIDE7CiAgICAgICAgCiAgICAgICAgVHJhbnNmZXIoX2Zyb20gIT0gYWRkcmVzcygwKSA/IF9mcm9tIDogdGhpcywgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgLy8vIEBkZXYgQWN0dWFsbHkgcGVyZm9ybSB0aGUgc2FmZVRyYW5zZmVyRnJvbQogICAgZnVuY3Rpb24gX3NhZmVUcmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQsIGJ5dGVzIGRhdGEpIAogICAgICAgIGludGVybmFsCiAgICAgICAgaXNWYWxpZFRva2VuKF90b2tlbklkKSAKICAgICAgICBjYW5UcmFuc2ZlcihfdG9rZW5JZCkKICAgIHsKICAgICAgICBhZGRyZXNzIG93bmVyID0gZmFzaGlvbklkVG9Pd25lcltfdG9rZW5JZF07CiAgICAgICAgcmVxdWlyZShvd25lciAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKG93bmVyID09IF9mcm9tKTsKICAgICAgICAKICAgICAgICBfdHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwoKICAgICAgICAvLyBEbyB0aGUgY2FsbGJhY2sgYWZ0ZXIgZXZlcnl0aGluZyBpcyBkb25lIHRvIGF2b2lkIHJlZW50cmFuY3kgYXR0YWNrCiAgICAgICAgdWludDI1NiBjb2RlU2l6ZTsKICAgICAgICBhc3NlbWJseSB7IGNvZGVTaXplIDo9IGV4dGNvZGVzaXplKF90bykgfQogICAgICAgIGlmIChjb2RlU2l6ZSA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgYnl0ZXM0IHJldHZhbCA9IEVSQzcyMVRva2VuUmVjZWl2ZXIoX3RvKS5vbkVSQzcyMVJlY2VpdmVkKF9mcm9tLCBfdG9rZW5JZCwgZGF0YSk7CiAgICAgICAgLy8gYnl0ZXM0KGtlY2NhazI1Nigib25FUkM3MjFSZWNlaXZlZChhZGRyZXNzLHVpbnQyNTYsYnl0ZXMpIikpID0gMHhmMGI5ZTViYTsKICAgICAgICByZXF1aXJlKHJldHZhbCA9PSAweGYwYjllNWJhKTsKICAgIH0KCiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICAvLy8gQGRldiBFcXVpcG1lbnQgY3JlYXRpb24KICAgIC8vLyBAcGFyYW0gX293bmVyIE93bmVyIG9mIHRoZSBlcXVpcG1lbnQgY3JlYXRlZAogICAgLy8vIEBwYXJhbSBfYXR0cnMgQXR0cmlidXRlcyBvZiB0aGUgZXF1aXBtZW50IGNyZWF0ZWQKICAgIC8vLyBAcmV0dXJuIFRva2VuIElEIG9mIHRoZSBlcXVpcG1lbnQgY3JlYXRlZAogICAgZnVuY3Rpb24gY3JlYXRlRmFzaGlvbihhZGRyZXNzIF9vd25lciwgdWludDE2WzldIF9hdHRycywgdWludDE2IF9jcmVhdGVUeXBlKSAKICAgICAgICBleHRlcm5hbCAKICAgICAgICB3aGVuTm90UGF1c2VkCiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIHJlcXVpcmUoYWN0aW9uQ29udHJhY3RzW21zZy5zZW5kZXJdKTsKICAgICAgICByZXF1aXJlKF9vd25lciAhPSBhZGRyZXNzKDApKTsKCiAgICAgICAgdWludDI1NiBuZXdGYXNoaW9uSWQgPSBmYXNoaW9uQXJyYXkubGVuZ3RoOwogICAgICAgIHJlcXVpcmUobmV3RmFzaGlvbklkIDwgNDI5NDk2NzI5Nik7CgogICAgICAgIGZhc2hpb25BcnJheS5sZW5ndGggKz0gMTsKICAgICAgICBGYXNoaW9uIHN0b3JhZ2UgZnMgPSBmYXNoaW9uQXJyYXlbbmV3RmFzaGlvbklkXTsKICAgICAgICBmcy5wcm90b0lkID0gX2F0dHJzWzBdOwogICAgICAgIGZzLnF1YWxpdHkgPSBfYXR0cnNbMV07CiAgICAgICAgZnMucG9zID0gX2F0dHJzWzJdOwogICAgICAgIGlmIChfYXR0cnNbM10gIT0gMCkgewogICAgICAgICAgICBmcy5oZWFsdGggPSBfYXR0cnNbM107CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGlmIChfYXR0cnNbNF0gIT0gMCkgewogICAgICAgICAgICBmcy5hdGtNaW4gPSBfYXR0cnNbNF07CiAgICAgICAgICAgIGZzLmF0a01heCA9IF9hdHRyc1s1XTsKICAgICAgICB9CiAgICAgICAKICAgICAgICBpZiAoX2F0dHJzWzZdICE9IDApIHsKICAgICAgICAgICAgZnMuZGVmZW5jZSA9IF9hdHRyc1s2XTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKF9hdHRyc1s3XSAhPSAwKSB7CiAgICAgICAgICAgIGZzLmNyaXQgPSBfYXR0cnNbN107CiAgICAgICAgfQoKICAgICAgICBpZiAoX2F0dHJzWzhdICE9IDApIHsKICAgICAgICAgICAgZnMuaXNQZXJjZW50ID0gX2F0dHJzWzhdOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBfdHJhbnNmZXIoMCwgX293bmVyLCBuZXdGYXNoaW9uSWQpOwogICAgICAgIENyZWF0ZUZhc2hpb24oX293bmVyLCBuZXdGYXNoaW9uSWQsIF9hdHRyc1swXSwgX2F0dHJzWzFdLCBfYXR0cnNbMl0sIF9jcmVhdGVUeXBlKTsKICAgICAgICByZXR1cm4gbmV3RmFzaGlvbklkOwogICAgfQoKICAgIC8vLyBAZGV2IE9uZSBzcGVjaWZpYyBhdHRyaWJ1dGUgb2YgdGhlIGVxdWlwbWVudCBtb2RpZmllZAogICAgZnVuY3Rpb24gX2NoYW5nZUF0dHJCeUluZGV4KEZhc2hpb24gc3RvcmFnZSBfZnMsIHVpbnQxNiBfaW5kZXgsIHVpbnQxNiBfdmFsKSBpbnRlcm5hbCB7CiAgICAgICAgaWYgKF9pbmRleCA9PSAzKSB7CiAgICAgICAgICAgIF9mcy5oZWFsdGggPSBfdmFsOwogICAgICAgIH0gZWxzZSBpZihfaW5kZXggPT0gNCkgewogICAgICAgICAgICBfZnMuYXRrTWluID0gX3ZhbDsKICAgICAgICB9IGVsc2UgaWYoX2luZGV4ID09IDUpIHsKICAgICAgICAgICAgX2ZzLmF0a01heCA9IF92YWw7CiAgICAgICAgfSBlbHNlIGlmKF9pbmRleCA9PSA2KSB7CiAgICAgICAgICAgIF9mcy5kZWZlbmNlID0gX3ZhbDsKICAgICAgICB9IGVsc2UgaWYoX2luZGV4ID09IDcpIHsKICAgICAgICAgICAgX2ZzLmNyaXQgPSBfdmFsOwogICAgICAgIH0gZWxzZSBpZihfaW5kZXggPT0gOSkgewogICAgICAgICAgICBfZnMuYXR0ckV4dDEgPSBfdmFsOwogICAgICAgIH0gZWxzZSBpZihfaW5kZXggPT0gMTApIHsKICAgICAgICAgICAgX2ZzLmF0dHJFeHQyID0gX3ZhbDsKICAgICAgICB9IGVsc2UgaWYoX2luZGV4ID09IDExKSB7CiAgICAgICAgICAgIF9mcy5hdHRyRXh0MyA9IF92YWw7CiAgICAgICAgfQogICAgfQoKICAgIC8vLyBAZGV2IEVxdWltZW50IGF0dHJpYnV0ZXMgbW9kaWZpZWQgKG1heCA0IHN0YXRzIG1vZGlmaWVkKQogICAgLy8vIEBwYXJhbSBfdG9rZW5JZCBFcXVpcG1lbnQgVG9rZW4gSUQKICAgIC8vLyBAcGFyYW0gX2lkeEFycmF5IFN0YXRzIG9yZGVyIHRoYXQgbXVzdCBiZSBtb2RpZmllZAogICAgLy8vIEBwYXJhbSBfcGFyYW1zIFN0YXQgdmFsdWUgdGhhdCBtdXN0IGJlIG1vZGlmaWVkCiAgICAvLy8gQHBhcmFtIF9jaGFuZ2VUeXBlIE1vZGlmaWNhdGlvbiB0eXBlIHN1Y2ggYXMgZW5oYW5jZSwgc29ja2V0LCBldGMuCiAgICBmdW5jdGlvbiBjaGFuZ2VGYXNoaW9uQXR0cih1aW50MjU2IF90b2tlbklkLCB1aW50MTZbNF0gX2lkeEFycmF5LCB1aW50MTZbNF0gX3BhcmFtcywgdWludDE2IF9jaGFuZ2VUeXBlKSAKICAgICAgICBleHRlcm5hbCAKICAgICAgICB3aGVuTm90UGF1c2VkCiAgICAgICAgaXNWYWxpZFRva2VuKF90b2tlbklkKSAKICAgIHsKICAgICAgICByZXF1aXJlKGFjdGlvbkNvbnRyYWN0c1ttc2cuc2VuZGVyXSk7CgogICAgICAgIEZhc2hpb24gc3RvcmFnZSBmcyA9IGZhc2hpb25BcnJheVtfdG9rZW5JZF07CiAgICAgICAgaWYgKF9pZHhBcnJheVswXSA+IDApIHsKICAgICAgICAgICAgX2NoYW5nZUF0dHJCeUluZGV4KGZzLCBfaWR4QXJyYXlbMF0sIF9wYXJhbXNbMF0pOwogICAgICAgIH0KCiAgICAgICAgaWYgKF9pZHhBcnJheVsxXSA+IDApIHsKICAgICAgICAgICAgX2NoYW5nZUF0dHJCeUluZGV4KGZzLCBfaWR4QXJyYXlbMV0sIF9wYXJhbXNbMV0pOwogICAgICAgIH0KCiAgICAgICAgaWYgKF9pZHhBcnJheVsyXSA+IDApIHsKICAgICAgICAgICAgX2NoYW5nZUF0dHJCeUluZGV4KGZzLCBfaWR4QXJyYXlbMl0sIF9wYXJhbXNbMl0pOwogICAgICAgIH0KCiAgICAgICAgaWYgKF9pZHhBcnJheVszXSA+IDApIHsKICAgICAgICAgICAgX2NoYW5nZUF0dHJCeUluZGV4KGZzLCBfaWR4QXJyYXlbM10sIF9wYXJhbXNbM10pOwogICAgICAgIH0KCiAgICAgICAgQ2hhbmdlRmFzaGlvbihmYXNoaW9uSWRUb093bmVyW190b2tlbklkXSwgX3Rva2VuSWQsIF9jaGFuZ2VUeXBlKTsKICAgIH0KCiAgICAvLy8gQGRldiBFcXVpcG1lbnQgZGVzdHJ1Y3Rpb24KICAgIC8vLyBAcGFyYW0gX3Rva2VuSWQgRXF1aXBtZW50IFRva2VuIElECiAgICAvLy8gQHBhcmFtIF9kZWxldGVUeXBlIERlc3RydWN0aW9uIHR5cGUsIHN1Y2ggYXMgY3JhZnQKICAgIGZ1bmN0aW9uIGRlc3Ryb3lGYXNoaW9uKHVpbnQyNTYgX3Rva2VuSWQsIHVpbnQxNiBfZGVsZXRlVHlwZSkKICAgICAgICBleHRlcm5hbCAKICAgICAgICB3aGVuTm90UGF1c2VkCiAgICAgICAgaXNWYWxpZFRva2VuKF90b2tlbklkKSAKICAgIHsKICAgICAgICByZXF1aXJlKGFjdGlvbkNvbnRyYWN0c1ttc2cuc2VuZGVyXSk7CgogICAgICAgIGFkZHJlc3MgX2Zyb20gPSBmYXNoaW9uSWRUb093bmVyW190b2tlbklkXTsKICAgICAgICB1aW50MjU2IGluZGV4RnJvbSA9IGZhc2hpb25JZFRvT3duZXJJbmRleFtfdG9rZW5JZF07CiAgICAgICAgdWludDI1NltdIHN0b3JhZ2UgZnNBcnJheSA9IG93bmVyVG9GYXNoaW9uQXJyYXlbX2Zyb21dOyAKICAgICAgICByZXF1aXJlKGZzQXJyYXlbaW5kZXhGcm9tXSA9PSBfdG9rZW5JZCk7CgogICAgICAgIGlmIChpbmRleEZyb20gIT0gZnNBcnJheS5sZW5ndGggLSAxKSB7CiAgICAgICAgICAgIHVpbnQyNTYgbGFzdFRva2VuSWQgPSBmc0FycmF5W2ZzQXJyYXkubGVuZ3RoIC0gMV07CiAgICAgICAgICAgIGZzQXJyYXlbaW5kZXhGcm9tXSA9IGxhc3RUb2tlbklkOyAKICAgICAgICAgICAgZmFzaGlvbklkVG9Pd25lckluZGV4W2xhc3RUb2tlbklkXSA9IGluZGV4RnJvbTsKICAgICAgICB9CiAgICAgICAgZnNBcnJheS5sZW5ndGggLT0gMTsgCgogICAgICAgIGZhc2hpb25JZFRvT3duZXJbX3Rva2VuSWRdID0gYWRkcmVzcygwKTsKICAgICAgICBkZWxldGUgZmFzaGlvbklkVG9Pd25lckluZGV4W190b2tlbklkXTsKICAgICAgICBkZXN0cm95RmFzaGlvbkNvdW50ICs9IDE7CgogICAgICAgIFRyYW5zZmVyKF9mcm9tLCAwLCBfdG9rZW5JZCk7CgogICAgICAgIERlbGV0ZUZhc2hpb24oX2Zyb20sIF90b2tlbklkLCBfZGVsZXRlVHlwZSk7CiAgICB9CgogICAgLy8vIEBkZXYgU2FmZSB0cmFuc2ZlciBieSB0cnVzdCBjb250cmFjdHMKICAgIGZ1bmN0aW9uIHNhZmVUcmFuc2ZlckJ5Q29udHJhY3QodWludDI1NiBfdG9rZW5JZCwgYWRkcmVzcyBfdG8pIAogICAgICAgIGV4dGVybmFsCiAgICAgICAgd2hlbk5vdFBhdXNlZAogICAgewogICAgICAgIHJlcXVpcmUoYWN0aW9uQ29udHJhY3RzW21zZy5zZW5kZXJdKTsKCiAgICAgICAgcmVxdWlyZShfdG9rZW5JZCA+PSAxICYmIF90b2tlbklkIDw9IGZhc2hpb25BcnJheS5sZW5ndGgpOwogICAgICAgIGFkZHJlc3Mgb3duZXIgPSBmYXNoaW9uSWRUb093bmVyW190b2tlbklkXTsKICAgICAgICByZXF1aXJlKG93bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUob3duZXIgIT0gX3RvKTsKCiAgICAgICAgX3RyYW5zZmVyKG93bmVyLCBfdG8sIF90b2tlbklkKTsKICAgIH0KCiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICAvLy8gQGRldiBHZXQgZmFzaGlvbiBhdHRycyBieSB0b2tlbklkCiAgICBmdW5jdGlvbiBnZXRGYXNoaW9uKHVpbnQyNTYgX3Rva2VuSWQpIGV4dGVybmFsIHZpZXcgaXNWYWxpZFRva2VuKF90b2tlbklkKSByZXR1cm5zICh1aW50MTZbMTJdIGRhdGFzKSB7CiAgICAgICAgRmFzaGlvbiBzdG9yYWdlIGZzID0gZmFzaGlvbkFycmF5W190b2tlbklkXTsKICAgICAgICBkYXRhc1swXSA9IGZzLnByb3RvSWQ7CiAgICAgICAgZGF0YXNbMV0gPSBmcy5xdWFsaXR5OwogICAgICAgIGRhdGFzWzJdID0gZnMucG9zOwogICAgICAgIGRhdGFzWzNdID0gZnMuaGVhbHRoOwogICAgICAgIGRhdGFzWzRdID0gZnMuYXRrTWluOwogICAgICAgIGRhdGFzWzVdID0gZnMuYXRrTWF4OwogICAgICAgIGRhdGFzWzZdID0gZnMuZGVmZW5jZTsKICAgICAgICBkYXRhc1s3XSA9IGZzLmNyaXQ7CiAgICAgICAgZGF0YXNbOF0gPSBmcy5pc1BlcmNlbnQ7CiAgICAgICAgZGF0YXNbOV0gPSBmcy5hdHRyRXh0MTsKICAgICAgICBkYXRhc1sxMF0gPSBmcy5hdHRyRXh0MjsKICAgICAgICBkYXRhc1sxMV0gPSBmcy5hdHRyRXh0MzsKICAgIH0KCiAgICAvLy8gQGRldiBHZXQgdG9rZW5JZHMgYW5kIGZsYWdzIGJ5IG93bmVyCiAgICBmdW5jdGlvbiBnZXRPd25GYXNoaW9ucyhhZGRyZXNzIF9vd25lcikgZXh0ZXJuYWwgdmlldyByZXR1cm5zKHVpbnQyNTZbXSB0b2tlbnMsIHVpbnQzMltdIGZsYWdzKSB7CiAgICAgICAgcmVxdWlyZShfb3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgdWludDI1NltdIHN0b3JhZ2UgZnNBcnJheSA9IG93bmVyVG9GYXNoaW9uQXJyYXlbX293bmVyXTsKICAgICAgICB1aW50MjU2IGxlbmd0aCA9IGZzQXJyYXkubGVuZ3RoOwogICAgICAgIHRva2VucyA9IG5ldyB1aW50MjU2W10obGVuZ3RoKTsKICAgICAgICBmbGFncyA9IG5ldyB1aW50MzJbXShsZW5ndGgpOwogICAgICAgIGZvciAodWludDI1NiBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CiAgICAgICAgICAgIHRva2Vuc1tpXSA9IGZzQXJyYXlbaV07CiAgICAgICAgICAgIEZhc2hpb24gc3RvcmFnZSBmcyA9IGZhc2hpb25BcnJheVtmc0FycmF5W2ldXTsKICAgICAgICAgICAgZmxhZ3NbaV0gPSB1aW50MzIodWludDMyKGZzLnByb3RvSWQpICogMTAwICsgdWludDMyKGZzLnF1YWxpdHkpICogMTAgKyBmcy5wb3MpOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8gQGRldiBXQVIgdG9rZW4gaW5mbyByZXR1cm5lZCBiYXNlZCBvbiBUb2tlbiBJRCB0cmFuc2ZlcmVkICg2NCBhdCBtb3N0KQogICAgZnVuY3Rpb24gZ2V0RmFzaGlvbnNBdHRycyh1aW50MjU2W10gX3Rva2VucykgZXh0ZXJuYWwgdmlldyByZXR1cm5zKHVpbnQxNltdIGF0dHJzKSB7CiAgICAgICAgdWludDI1NiBsZW5ndGggPSBfdG9rZW5zLmxlbmd0aDsKICAgICAgICByZXF1aXJlKGxlbmd0aCA8PSA2NCk7CiAgICAgICAgYXR0cnMgPSBuZXcgdWludDE2W10obGVuZ3RoICogMTEpOwogICAgICAgIHVpbnQyNTYgdG9rZW5JZDsKICAgICAgICB1aW50MjU2IGluZGV4OwogICAgICAgIGZvciAodWludDI1NiBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CiAgICAgICAgICAgIHRva2VuSWQgPSBfdG9rZW5zW2ldOwogICAgICAgICAgICBpZiAoZmFzaGlvbklkVG9Pd25lclt0b2tlbklkXSAhPSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgICAgICBpbmRleCA9IGkgKiAxMTsKICAgICAgICAgICAgICAgIEZhc2hpb24gc3RvcmFnZSBmcyA9IGZhc2hpb25BcnJheVt0b2tlbklkXTsKICAgICAgICAgICAgICAgIGF0dHJzW2luZGV4XSA9IGZzLmhlYWx0aDsKICAgICAgICAgICAgICAgIGF0dHJzW2luZGV4ICsgMV0gPSBmcy5hdGtNaW47CiAgICAgICAgICAgICAgICBhdHRyc1tpbmRleCArIDJdID0gZnMuYXRrTWF4OwogICAgICAgICAgICAgICAgYXR0cnNbaW5kZXggKyAzXSA9IGZzLmRlZmVuY2U7CiAgICAgICAgICAgICAgICBhdHRyc1tpbmRleCArIDRdID0gZnMuY3JpdDsKICAgICAgICAgICAgICAgIGF0dHJzW2luZGV4ICsgNV0gPSBmcy5pc1BlcmNlbnQ7CiAgICAgICAgICAgICAgICBhdHRyc1tpbmRleCArIDZdID0gZnMuYXR0ckV4dDE7CiAgICAgICAgICAgICAgICBhdHRyc1tpbmRleCArIDddID0gZnMuYXR0ckV4dDI7CiAgICAgICAgICAgICAgICBhdHRyc1tpbmRleCArIDhdID0gZnMuYXR0ckV4dDM7CiAgICAgICAgICAgIH0gICAKICAgICAgICB9CiAgICB9Cn0='.
	

]
