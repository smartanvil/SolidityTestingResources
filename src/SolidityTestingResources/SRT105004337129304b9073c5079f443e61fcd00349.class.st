Class {
	#name : #SRT105004337129304b9073c5079f443e61fcd00349,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT105004337129304b9073c5079f443e61fcd00349 >> base64 [
	^ 'LyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCmNvbnRyYWN0IFRva2VuIHsKICAgIGZ1bmN0aW9uIGlzc3VlKGFkZHJlc3MgX3JlY2lwaWVudCwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykge30KICAgIGZ1bmN0aW9uIGlzc3VlQXRJY28oYWRkcmVzcyBfcmVjaXBpZW50LCB1aW50MjU2IF92YWx1ZSwgdWludDI1NiBfaWNvTnVtYmVyKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHt9CiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgc3VwcGx5KSB7fQogICAgZnVuY3Rpb24gdW5sb2NrKCkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7fQp9Cgpjb250cmFjdCBSSUNIQ3Jvd2RzYWxlIHsKCiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICAvLyBDcm93ZHNhbGUgYWRkcmVzc2VzCiAgICBhZGRyZXNzIHB1YmxpYyBjcmVhdG9yOyAvLyBDcmVhdG9yICgxJSBmdW5kaW5nKQogICAgYWRkcmVzcyBwdWJsaWMgYnV5QmFja0Z1bmQ7IC8vIEZ1bmQgZm9yIGJ1eWluZyBiYWNrIGFuZCBidXJuaW5nICg0OCUgZnVuZGluZykKICAgIGFkZHJlc3MgcHVibGljIGh1bWFuaXR5RnVuZDsgLy8gSHVtYW5pdHkgZnVuZCAoNTElIGZ1bmRpbmcpCgogICAgLy8gV2l0aGRyYXdhbCBydWxlcwogICAgdWludDI1NiBwdWJsaWMgY3JlYXRvcldpdGhkcmF3ID0gMDsgLy8gQ3VycmVudCB3aXRoZHJhd2VkCiAgICB1aW50MjU2IHB1YmxpYyBtYXhDcmVhdG9yV2l0aGRyYXcgPSA1ICogMTAgKiogMyAqIDEwKioxODsgLy8gRmlyc3QgNS4wMDAgRVRICiAgICB1aW50MjU2IHB1YmxpYyBwZXJjZW50YWdlSHVtYW5pdHlGdW5kID0gNTE7IC8vIFBlcmNlbnRhZ2UgZ29lcyB0byBIdW1hbml0eSBmdW5kCiAgICB1aW50MjU2IHB1YmxpYyBwZXJjZW50YWdlQnV5QmFja0Z1bmQgPSA0OTsgLy8gUGVyY2VudGFnZSBnb2VzIHRvIEJ1eS1iYWNrIGZ1bmQKCiAgICAvLyBFdGggdG8gdG9rZW4gcmF0ZQogICAgdWludDI1NiBwdWJsaWMgY3VycmVudE1hcmtldFJhdGUgPSA0MDA7IC8vIEN1cnJlbnQgbWFya2V0IHByaWNlIFJJQ0gvRVRILiBXaWxsIGJlIHVwZGF0ZWQgYmVmb3JlIGVhY2ggaWNvCiAgICB1aW50MjU2IHB1YmxpYyBtYXhpbXVtSWNvUmF0ZSA9IDMzMDsgLy8gTWF4aW11bSByYXRlIGF0IHdpY2ggd2lsbCBiZSBpc3N1ZWQgUklDSCB0b2tlbgogICAgdWludDI1NiBwdWJsaWMgbWluQWNjZXB0ZWRFdGhBbW91bnQgPSA0IGZpbm5leTsgLy8gMC4wMDQgZXRoZXIKCiAgICAvLyBJQ09zIHNwZWNpZmljYXRpb24KICAgIHVpbnQyNTYgcHVibGljIG1heFRvdGFsU3VwcGx5ID0gMTAwMDAwMDAwMCAqIDEwKio4OyAvLyAxIG1scmQuIHRva2VucwoKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gdWludDI1NikgaWNvVG9rZW5Jc3N1ZWQ7IC8vIElzc3VlZCBpbiBlYWNoIElDTwogICAgdWludDI1NiBwdWJsaWMgdG90YWxUb2tlbklzc3VlZDsgLy8gVG90YWwgb2YgaXNzdWVkIHRva2VucwoKICAgIHVpbnQyNTYgcHVibGljIGljb1BlcmlvZCA9IDEwIGRheXM7CiAgICB1aW50MjU2IHB1YmxpYyBub0ljb1BlcmlvZCA9IDEwIGRheXM7CiAgICB1aW50MjU2IHB1YmxpYyBtYXhJc3N1ZWRUb2tlbnNQZXJJY28gPSAxMCoqNiAqIDEwKio4OyAvLyAxIG1pbC4KICAgIHVpbnQyNTYgcHVibGljIHByZUljb1BlcmlvZCA9IDMwIGRheXM7CgogICAgdWludDI1NiBwdWJsaWMgYm9udXNQcmVJY28gPSA1MDsKICAgIHVpbnQyNTYgcHVibGljIGJvbnVzRmlyc3RJY28gPSAzMDsKICAgIHVpbnQyNTYgcHVibGljIGJvbnVzU2Vjb25kSWNvID0gMTA7CgogICAgdWludDI1NiBwdWJsaWMgYm9udXNTdWJzY3JpcHRpb24gPSA1OwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBzdWJzcmlwdGlvbkJvbnVzVG9rZW5zSXNzdWVkOwoKICAgIC8vIEJhbGFuY2VzCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSB0b2tlbkJhbGFuY2VzOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nICh1aW50MjU2ID0+IHVpbnQyNTYpKSB0b2tlbkJhbGFuY2VzUGVySWNvOwoKICAgIGVudW0gU3RhZ2VzIHsKICAgICAgICBDb3VudGRvd24sCiAgICAgICAgUHJlSWNvLAogICAgICAgIFByaW9yaXR5SWNvLAogICAgICAgIE9wZW5JY28sCiAgICAgICAgSWNvLCAvLyBbUHJlSWNvLCBQcmlvcml0eUljbywgT3Blbkljb10KICAgICAgICBOb0ljbywKICAgICAgICBFbmRlZAogICAgfQoKICAgIFN0YWdlcyBwdWJsaWMgc3RhZ2UgPSBTdGFnZXMuQ291bnRkb3duOwoKICAgIC8vIENyb3dkc2FsZSB0aW1lcwogICAgdWludCBwdWJsaWMgc3RhcnQ7CiAgICB1aW50IHB1YmxpYyBwcmVJY29TdGFydDsKCiAgICAvLyBSaWNoIHRva2VuCiAgICBUb2tlbiBwdWJsaWMgcmljaFRva2VuOwoKICAgIC8qKgogICAgICogVGhyb3cgaWYgYXQgc3RhZ2Ugb3RoZXIgdGhhbiBjdXJyZW50IHN0YWdlCiAgICAgKgogICAgICogQHBhcmFtIF9zdGFnZSBleHBlY3RlZCBzdGFnZSB0byB0ZXN0IGZvcgogICAgICovCiAgICBtb2RpZmllciBhdFN0YWdlKFN0YWdlcyBfc3RhZ2UpIHsKICAgICAgICB1cGRhdGVTdGF0ZSgpOwoKICAgICAgICBpZiAoc3RhZ2UgIT0gX3N0YWdlICYmIF9zdGFnZSAhPSBTdGFnZXMuSWNvKSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KCiAgICAgICAgaWYgKHN0YWdlICE9IFN0YWdlcy5Qcmlvcml0eUljbyAmJiBzdGFnZSAhPSBTdGFnZXMuT3BlbkljbyAmJiBzdGFnZSAhPSBTdGFnZXMuUHJlSWNvKSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KICAgICAgICBfOwogICAgfQoKCiAgICAvKioKICAgICAqIFRocm93IGlmIHNlbmRlciBpcyBub3QgY3JlYXRvcgogICAgICovCiAgICBtb2RpZmllciBvbmx5Q3JlYXRvcigpIHsKICAgICAgICBpZiAoY3JlYXRvciAhPSBtc2cuc2VuZGVyKSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICogR2V0IGJvbnVzIGZvciBwcm92aWRlZCBJQ08gbnVtYmVyCiAgICAgKgogICAgICogQHBhcmFtIF9jdXJyZW50SWNvIGN1cnJlbnQgaWNvIG51bWJlcgogICAgICogQHJldHVybiBwZXJjZW50YWdlCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFBlcmNlbnRhZ2VCb251c0Zvckljbyh1aW50MjU2IF9jdXJyZW50SWNvKSByZXR1cm5zICh1aW50MjU2IHBlcmNlbnRhZ2UpIHsKICAgICAgICB1cGRhdGVTdGF0ZSgpOwoKICAgICAgICBpZiAoc3RhZ2UgPT0gU3RhZ2VzLlByZUljbykgewogICAgICAgICAgICByZXR1cm4gYm9udXNQcmVJY287CiAgICAgICAgfQoKICAgICAgICBpZiAoX2N1cnJlbnRJY28gPT0gMSkgewogICAgICAgICAgICByZXR1cm4gYm9udXNGaXJzdEljbzsKICAgICAgICB9CgogICAgICAgIGlmIChfY3VycmVudEljbyA9PSAyKSB7CiAgICAgICAgICAgIHJldHVybiBib251c1NlY29uZEljbzsKICAgICAgICB9CgogICAgICAgIHJldHVybiAwOwogICAgfQoKICAgIC8qKgogICAgICogR2V0IGV0aGVyZXVtIGJhbGFuY2Ugb2YgYF9pbnZlc3RvcmAKICAgICAqCiAgICAgKiBAcGFyYW0gX2ludmVzdG9yIFRoZSBhZGRyZXNzIGZyb20gd2hpY2ggdGhlIGJhbGFuY2Ugd2lsbCBiZSByZXRyaWV2ZWQKICAgICAqIEByZXR1cm4gVGhlIGJhbGFuY2UKICAgICAqLwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX2ludmVzdG9yKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX2ludmVzdG9yXTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnN0cnVjdAogICAgICoKICAgICAqIEBwYXJhbSBfdG9rZW5BZGRyZXNzIFRoZSBhZGRyZXNzIG9mIHRoZSBSaWNoIHRva2VuIGNvbnRhY3QKICAgICAqIEBwYXJhbSBfY3JlYXRvciBDb250cmFjdCBjcmVhdG9yCiAgICAgKiBAcGFyYW0gX3N0YXJ0IFN0YXJ0IG9mIHRoZSBmaXJzdCBJQ08KICAgICAqIEBwYXJhbSBfcHJlSWNvU3RhcnQgU3RhcnQgb2YgcHJlLUlDTwogICAgICovCiAgICBmdW5jdGlvbiBSSUNIQ3Jvd2RzYWxlKGFkZHJlc3MgX3Rva2VuQWRkcmVzcywgYWRkcmVzcyBfY3JlYXRvciwgdWludDI1NiBfc3RhcnQsIHVpbnQyNTYgX3ByZUljb1N0YXJ0KSB7CiAgICAgICAgcmljaFRva2VuID0gVG9rZW4oX3Rva2VuQWRkcmVzcyk7CiAgICAgICAgY3JlYXRvciA9IF9jcmVhdG9yOwogICAgICAgIHN0YXJ0ID0gX3N0YXJ0OwogICAgICAgIHByZUljb1N0YXJ0ID0gX3ByZUljb1N0YXJ0OwogICAgfQoKICAgIC8qKgogICAgICogU2V0IGN1cnJlbnQgbWFya2V0IHJhdGUgRVRIL1JJQ0guIFdpbGwgYmUgY2FsZWQgYnkgY3JlYXRvciBiZWZvcmUgZWFjaCBJQ08KICAgICAqCiAgICAgKiBAcGFyYW0gX2N1cnJlbnRNYXJrZXRSYXRlIGN1cnJlbnQgRVRIL1JJQ0ggcmF0ZSBhdCB0aGUgbWFya2V0CiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldEN1cnJlbnRNYXJrZXRSYXRlKHVpbnQyNTYgX2N1cnJlbnRNYXJrZXRSYXRlKSBvbmx5Q3JlYXRvciByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgY3VycmVudE1hcmtldFJhdGUgPSBfY3VycmVudE1hcmtldFJhdGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgaHVtYW5pdHkgZnVuZCBhZGRyZXNzCiAgICAgKgogICAgICogQHBhcmFtIF9odW1hbml0eUZ1bmQgSHVtYW5pdHkgZnVuZCBhZGRyZXNzCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldEh1bWFuaXR5RnVuZChhZGRyZXNzIF9odW1hbml0eUZ1bmQpIG9ubHlDcmVhdG9yIHsKICAgICAgICBodW1hbml0eUZ1bmQgPSBfaHVtYW5pdHlGdW5kOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IGJ1eSBiYWNrIGZ1bmQgYWRkcmVzcwogICAgICoKICAgICAqIEBwYXJhbSBfYnV5QmFja0Z1bmQgQmF5IGJhY2sgZnVuZCBhZGRyZXNzCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldEJ1eUJhY2tGdW5kKGFkZHJlc3MgX2J1eUJhY2tGdW5kKSBvbmx5Q3JlYXRvciB7CiAgICAgICAgYnV5QmFja0Z1bmQgPSBfYnV5QmFja0Z1bmQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgY3VycmVudCByYXRlIGF0IHdoaWNoIHdpbGwgYmUgaXNzdWVkIHRva2VucwogICAgICoKICAgICAqIEByZXR1cm4gcmF0ZSBIb3cgbWFueSB0b2tlbnMgd2lsbCBiZSBpc3N1ZWQgZm9yIG9uZSBFVEgKICAgICAqLwogICAgZnVuY3Rpb24gZ2V0UmF0ZSgpIHJldHVybnMgKHVpbnQyNTYgcmF0ZSkgewogICAgICAgIGlmIChjdXJyZW50TWFya2V0UmF0ZSAqIDggLyAxMCA+IG1heGltdW1JY29SYXRlKSB7CiAgICAgICAgICAgIHJldHVybiBtYXhpbXVtSWNvUmF0ZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBjdXJyZW50TWFya2V0UmF0ZSAqIDggLyAxMDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHJ1biBwZWNlbnRhZ2Ugb2YgdG9rZW5zIG93bmVkIGJ5IHByb3ZpZGVkIGludmVzdG9yCiAgICAgKgogICAgICogQHBhcmFtIF9pbnZlc3RvciBhZGRyZXNzIG9mIGludmVzdG9yCiAgICAgKiBAcGFyYW0gZXhlcHRJbkljbyBJQ08gbnVtYmVyIHRoYXQgd2lsbCBiZSBleGNsdWRlZCBmcm9tIGNhbGN1bGF0aW9uICh1c3VhbGx5IGN1cnJlbnQgSUNPIG51bWJlcikKICAgICAqIEByZXR1cm4gaW52ZXN0b3IgcmF0ZSwgMTAwMDAwMCA9IDEwMCUKICAgICAqLwogICAgZnVuY3Rpb24gZ2V0SW52ZXN0b3JUb2tlblBlcmNlbnRhZ2UoYWRkcmVzcyBfaW52ZXN0b3IsIHVpbnQyNTYgZXhlcHRJbkljbykgcmV0dXJucyAodWludDI1NiBwZXJjZW50YWdlKSB7CiAgICAgICAgdWludDI1NiBkZWR1Y3Rpb25JbnZlc3RvciA9IDA7CiAgICAgICAgdWludDI1NiBkZWR1Y3Rpb25JY28gPSAwOwoKICAgICAgICBpZiAoZXhlcHRJbkljbyA+PSAwKSB7CiAgICAgICAgICAgIGRlZHVjdGlvbkludmVzdG9yID0gdG9rZW5CYWxhbmNlc1Blckljb1tfaW52ZXN0b3JdW2V4ZXB0SW5JY29dOwogICAgICAgICAgICBkZWR1Y3Rpb25JY28gPSBpY29Ub2tlbklzc3VlZFtleGVwdEluSWNvXTsKICAgICAgICB9CgogICAgICAgIGlmICh0b3RhbFRva2VuSXNzdWVkIC0gZGVkdWN0aW9uSWNvID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gMTAwMDAwMCAqICh0b2tlbkJhbGFuY2VzW19pbnZlc3Rvcl0gLSBkZWR1Y3Rpb25JbnZlc3RvcikgLyAodG90YWxUb2tlbklzc3VlZCAtIGRlZHVjdGlvbkljbyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IGBfd2VpYCB0byBhbiBhbW91bnQgaW4gUklDSCB1c2luZwogICAgICogdGhlIGN1cnJlbnQgcmF0ZQogICAgICoKICAgICAqIEBwYXJhbSBfd2VpIGFtb3VudCBvZiB3ZWkgdG8gY29udmVydAogICAgICogQHJldHVybiBUaGUgYW1vdW50IGluIFJJQ0gKICAgICAqLwogICAgZnVuY3Rpb24gdG9SSUNIKHVpbnQyNTYgX3dlaSkgcmV0dXJucyAodWludDI1NiBhbW91bnQpIHsKICAgICAgICB1aW50MjU2IHJhdGUgPSBnZXRSYXRlKCk7CgogICAgICAgIHJldHVybiBfd2VpICogcmF0ZSAqIDEwKio4IC8gMSBldGhlcjsgLy8gMTAqKjggZm9yIDggZGVjaW1hbHMKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBJQ08gbnVtYmVyIChQcmVJY28gaGFzIGluZGV4IDApCiAgICAgKgogICAgICogQHJldHVybiBJQ08gbnVtYmVyCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRJY29OdW1iZXIoKSByZXR1cm5zICh1aW50MjU2IGFtb3VudCkgewogICAgICAgIHVpbnQyNTYgdGltZUJlaGluZCA9IG5vdyAtIHN0YXJ0OwogICAgICAgIGlmIChub3cgPCBzdGFydCkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CgogICAgICAgIHJldHVybiAxICsgKCh0aW1lQmVoaW5kIC0gKHRpbWVCZWhpbmQgJSAoaWNvUGVyaW9kICsgbm9JY29QZXJpb2QpKSkgLyAoaWNvUGVyaW9kICsgbm9JY29QZXJpb2QpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFVwZGF0ZSBjcm93ZCBzYWxlIHN0YWdlIGJhc2VkIG9uIGN1cnJlbnQgdGltZSBhbmQgSUNPIHBlcmlvZHMKICAgICAqLwogICAgZnVuY3Rpb24gdXBkYXRlU3RhdGUoKSB7CiAgICAgICAgdWludDI1NiB0aW1lQmVoaW5kID0gbm93IC0gc3RhcnQ7CiAgICAgICAgdWludDI1NiBjdXJyZW50SWNvTnVtYmVyID0gZ2V0Q3VycmVudEljb051bWJlcigpOwoKICAgICAgICBpZiAoaWNvVG9rZW5Jc3N1ZWRbY3VycmVudEljb051bWJlcl0gPj0gbWF4SXNzdWVkVG9rZW5zUGVySWNvKSB7CiAgICAgICAgICAgIHN0YWdlID0gU3RhZ2VzLk5vSWNvOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAodG90YWxUb2tlbklzc3VlZCA+PSBtYXhUb3RhbFN1cHBseSkgewogICAgICAgICAgICBzdGFnZSA9IFN0YWdlcy5FbmRlZDsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKG5vdyA+PSBwcmVJY29TdGFydCAmJiBub3cgPD0gcHJlSWNvU3RhcnQgKyBwcmVJY29QZXJpb2QpIHsKICAgICAgICAgICAgc3RhZ2UgPSBTdGFnZXMuUHJlSWNvOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAobm93IDwgc3RhcnQpIHsKICAgICAgICAgICAgc3RhZ2UgPSBTdGFnZXMuQ291bnRkb3duOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB1aW50MjU2IHRpbWVGcm9tSWNvU3RhcnQgPSB0aW1lQmVoaW5kIC0gKGN1cnJlbnRJY29OdW1iZXIgLSAxKSAqIChpY29QZXJpb2QgKyBub0ljb1BlcmlvZCk7CgogICAgICAgIGlmICh0aW1lRnJvbUljb1N0YXJ0ID4gaWNvUGVyaW9kKSB7CiAgICAgICAgICAgIHN0YWdlID0gU3RhZ2VzLk5vSWNvOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAodGltZUZyb21JY29TdGFydCA+IGljb1BlcmlvZCAvIDIpIHsKICAgICAgICAgICAgc3RhZ2UgPSBTdGFnZXMuT3BlbkljbzsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgc3RhZ2UgPSBTdGFnZXMuUHJpb3JpdHlJY287CiAgICB9CgoKICAgIC8qKgogICAgICogVHJhbnNmZXIgYXBwcm9wcmlhdGUgcGVyY2VudGFnZSBvZiByYWlzZWQgYW1vdW50IHRvIHRoZSBjb21wYW55IGFkZHJlc3MgYW5kIGh1bWFuaXR5IGFuZCBidXkgYmFjayBmdW5kCiAgICAgKi8KICAgIGZ1bmN0aW9uIHdpdGhkcmF3KCkgb25seUNyZWF0b3IgewogICAgICAgIHVpbnQyNTYgZXRoQmFsYW5jZSA9IHRoaXMuYmFsYW5jZTsKICAgICAgICB1aW50MjU2IGFtb3VudFRvU2VuZCA9IGV0aEJhbGFuY2UgLSAxMDAwMDAwMDA7CgogICAgICAgIGlmIChjcmVhdG9yV2l0aGRyYXcgPCBtYXhDcmVhdG9yV2l0aGRyYXcpIHsKICAgICAgICAgICAgaWYgKGFtb3VudFRvU2VuZCA+IG1heENyZWF0b3JXaXRoZHJhdyAtIGNyZWF0b3JXaXRoZHJhdykgewogICAgICAgICAgICAgICAgYW1vdW50VG9TZW5kID0gbWF4Q3JlYXRvcldpdGhkcmF3IC0gY3JlYXRvcldpdGhkcmF3OwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIWNyZWF0b3Iuc2VuZChhbW91bnRUb1NlbmQpKSB7CiAgICAgICAgICAgICAgICB0aHJvdzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY3JlYXRvcldpdGhkcmF3ICs9IGFtb3VudFRvU2VuZDsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdWludDI1NiBldGhGb3JIdW1hbml0eUZ1bmQgPSBhbW91bnRUb1NlbmQgKiBwZXJjZW50YWdlSHVtYW5pdHlGdW5kIC8gMTAwOwogICAgICAgIHVpbnQyNTYgZXRoRm9yQnV5QmFja0Z1bmQgPSBhbW91bnRUb1NlbmQgKiBwZXJjZW50YWdlQnV5QmFja0Z1bmQgLyAxMDA7CgogICAgICAgIGlmICghaHVtYW5pdHlGdW5kLnNlbmQoZXRoRm9ySHVtYW5pdHlGdW5kKSkgewogICAgICAgICAgICB0aHJvdzsKICAgICAgICB9CgogICAgICAgIGlmICghYnV5QmFja0Z1bmQuc2VuZChldGhGb3JCdXlCYWNrRnVuZCkpIHsKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQWRkIGFkZGl0aW9uYWwgYm9udXMgdG9rZW5zIGZvciBzdWJzY3JpYmVkIGludmVzdG9ycwogICAgICoKICAgICAqIEBwYXJhbSBpbnZlc3RvckFkZHJlc3MgQWRkcmVzcyBvZiBpbnZlc3RvcgogICAgICovCiAgICBmdW5jdGlvbiBzZW5kU3Vic2NyaXB0aW9uQm9udXMoYWRkcmVzcyBpbnZlc3RvckFkZHJlc3MpIG9ubHlDcmVhdG9yIHsKICAgICAgICB1aW50MjU2IHN1YnNjcmlwdGlvbkJvbnVzID0gdG9rZW5CYWxhbmNlc1tpbnZlc3RvckFkZHJlc3NdICogYm9udXNTdWJzY3JpcHRpb24gLyAxMDA7CgogICAgICAgIGlmIChzdWJzcmlwdGlvbkJvbnVzVG9rZW5zSXNzdWVkW2ludmVzdG9yQWRkcmVzc10gPCBzdWJzY3JpcHRpb25Cb251cykgewogICAgICAgICAgICB1aW50MjU2IHRvQmVJc3N1ZWQgPSBzdWJzY3JpcHRpb25Cb251cyAtIHN1YnNyaXB0aW9uQm9udXNUb2tlbnNJc3N1ZWRbaW52ZXN0b3JBZGRyZXNzXTsKICAgICAgICAgICAgaWYgKCFyaWNoVG9rZW4uaXNzdWUoaW52ZXN0b3JBZGRyZXNzLCB0b0JlSXNzdWVkKSkgewogICAgICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHN1YnNyaXB0aW9uQm9udXNUb2tlbnNJc3N1ZWRbaW52ZXN0b3JBZGRyZXNzXSArPSB0b0JlSXNzdWVkOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJlY2VpdmVzIEV0aCBhbmQgaXNzdWUgUklDSCB0b2tlbnMgdG8gdGhlIHNlbmRlcgogICAgICovCiAgICBmdW5jdGlvbiAoKSBwYXlhYmxlIGF0U3RhZ2UoU3RhZ2VzLkljbykgewogICAgICAgIHVpbnQyNTYgcmVjZWl2ZWRFdGggPSBtc2cudmFsdWU7CgogICAgICAgIGlmIChyZWNlaXZlZEV0aCA8IG1pbkFjY2VwdGVkRXRoQW1vdW50KSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KCiAgICAgICAgdWludDI1NiB0b2tlbnNUb0JlSXNzdWVkID0gdG9SSUNIKHJlY2VpdmVkRXRoKTsKICAgICAgICB1aW50MjU2IGN1cnJlbnRJY28gPSBnZXRDdXJyZW50SWNvTnVtYmVyKCk7CgogICAgICAgIC8vYWRkIGJvbnVzCiAgICAgICAgdG9rZW5zVG9CZUlzc3VlZCA9IHRva2Vuc1RvQmVJc3N1ZWQgKyAodG9rZW5zVG9CZUlzc3VlZCAqIGdldFBlcmNlbnRhZ2VCb251c0ZvckljbyhjdXJyZW50SWNvKSAvIDEwMCk7CgogICAgICAgIGlmICh0b2tlbnNUb0JlSXNzdWVkID09IDAgfHwgaWNvVG9rZW5Jc3N1ZWRbY3VycmVudEljb10gKyB0b2tlbnNUb0JlSXNzdWVkID4gbWF4SXNzdWVkVG9rZW5zUGVySWNvKSB7CiAgICAgICAgICAgIHRocm93OwogICAgICAgIH0KCiAgICAgICAgaWYgKHN0YWdlID09IFN0YWdlcy5Qcmlvcml0eUljbykgewogICAgICAgICAgICB1aW50MjU2IGFscmVhZHlCb3VnaHRJbkljbyA9IHRva2VuQmFsYW5jZXNQZXJJY29bbXNnLnNlbmRlcl1bY3VycmVudEljb107CiAgICAgICAgICAgIHVpbnQyNTYgY2FuQnV5VG9rZW5zSW5UaGlzSWNvID0gbWF4SXNzdWVkVG9rZW5zUGVySWNvICogZ2V0SW52ZXN0b3JUb2tlblBlcmNlbnRhZ2UobXNnLnNlbmRlciwgY3VycmVudEljbykgLyAxMDAwMDAwOwoKICAgICAgICAgICAgaWYgKHRva2Vuc1RvQmVJc3N1ZWQgPiBjYW5CdXlUb2tlbnNJblRoaXNJY28gLSBhbHJlYWR5Qm91Z2h0SW5JY28pIHsKICAgICAgICAgICAgICAgIHRocm93OwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoIXJpY2hUb2tlbi5pc3N1ZShtc2cuc2VuZGVyLCB0b2tlbnNUb0JlSXNzdWVkKSkgewogICAgICAgICAgICB0aHJvdzsKICAgICAgICB9CgogICAgICAgIGljb1Rva2VuSXNzdWVkW2N1cnJlbnRJY29dICs9IHRva2Vuc1RvQmVJc3N1ZWQ7CiAgICAgICAgdG90YWxUb2tlbklzc3VlZCArPSB0b2tlbnNUb0JlSXNzdWVkOwogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdICs9IHJlY2VpdmVkRXRoOwogICAgICAgIHRva2VuQmFsYW5jZXNbbXNnLnNlbmRlcl0gKz0gdG9rZW5zVG9CZUlzc3VlZDsKICAgICAgICB0b2tlbkJhbGFuY2VzUGVySWNvW21zZy5zZW5kZXJdW2N1cnJlbnRJY29dICs9IHRva2Vuc1RvQmVJc3N1ZWQ7CiAgICB9Cn0='.
	

]
