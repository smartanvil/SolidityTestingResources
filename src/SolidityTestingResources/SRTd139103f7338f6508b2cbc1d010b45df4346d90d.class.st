Class {
	#name : #SRTd139103f7338f6508b2cbc1d010b45df4346d90d,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd139103f7338f6508b2cbc1d010b45df4346d90d >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIHB1cmUgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIHB1cmUgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgIT0gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIHB1cmUgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIHB1cmUgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KICAKICBmdW5jdGlvbiBtdWxCeUZyYWN0aW9uKHVpbnQyNTYgbnVtYmVyLCB1aW50MjU2IG51bWVyYXRvciwgdWludDI1NiBkZW5vbWluYXRvcikgcHVyZSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgIHJldHVybiBkaXYobXVsKG51bWJlciwgbnVtZXJhdG9yKSwgZGVub21pbmF0b3IpOwogIH0KfQoKCgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgoKCi8qKgogKiBAdGl0bGUgQmFzaWMgdG9rZW4KICogQGRldiBCYXNpYyB2ZXJzaW9uIG9mIFN0YW5kYXJkVG9rZW4sIHdpdGggbm8gYWxsb3dhbmNlcy4KICovCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgLyoqCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1ttc2cuc2VuZGVyXSk7CgogICAgLy8gU2FmZU1hdGguc3ViIHdpbGwgdGhyb3cgaWYgdGhlcmUgaXMgbm90IGVub3VnaCBiYWxhbmNlLgogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgKi8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKfQoKCgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgoKCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CgoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBAZGV2IEluY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX2FkZGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gaW5jcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IERlY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBkZWNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3N1YnRyYWN0ZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBkZWNyZWFzZSB0aGUgYWxsb3dhbmNlIGJ5LgogICAqLwogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9CgoKCi8qKgogKiBAdGl0bGUgT3duYWJsZQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuCiAqLwpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCgogIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCgoKLyoqCiAqIEB0aXRsZSBQYXVzYWJsZQogKiBAZGV2IEJhc2UgY29udHJhY3Qgd2hpY2ggYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uCiAqLwpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKCiAgLy8gdGltZXN0YW1wcyB1bnRpbCBhbGwgdG9rZW5zIHRyYW5zZmVycyBhcmUgYmxvY2tlZAogIHVpbnQyNTYgcHVibGljIGJsb2NrZWRUaW1lRm9yQm91bnR5VG9rZW5zID0gMDsKICB1aW50MjU2IHB1YmxpYyBibG9ja2VkVGltZUZvckludmVzdGVkVG9rZW5zID0gMDsKCiAgLy8gbWluaW11bSB0aW1lc3RhbXAgdGhhdCB0b2tlbnMgd2lsbCBiZSBibG9ja2VkIGZvciB0cmFuc2ZlcnMKICB1aW50MjU2IGNvbnN0YW50IE1JTl9ibG9ja2VkVGltZUZvckJvdW50eVRva2VucyA9IDE1MjQ5NDkyMDA7IC8vMjkuMDQuMjAxOCwgMDowMDowMAogIHVpbnQyNTYgY29uc3RhbnQgTUlOX2Jsb2NrZWRUaW1lRm9ySW52ZXN0ZWRUb2tlbnMgPSAxNTIxMDYxMjAwOyAvLzE1LjAzLjIwMTgsIDA6MDA6MDAKCiAgLy9BZGRyZXNzZXMgcHJlLWljbyBpbnZlc3RvcnMKICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgcHJlSWNvQWNjb3VudHM7CgogIC8vQWRkcmVzc2VzIGJvdW50eSBjYW1wYWlnbgogIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBib3VudHlBY2NvdW50czsKCiAgLy9BZGRyZXNzZXMgd2l0aCBmb3VuZGVycyB0b2tlbnMgYW5kIGZsYWcgaXMgaXQgYmxvY2tpbmcgdHJhbnNmZXJzIGZyb20gdGhpcyBhZGRyZXNzCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIGZvdW5kZXJBY2NvdW50czsgLy8gMSAtIGJsb2NrIHRyYW5zZmVycywgMiAtIGRvIG5vdCBibG9jayB0cmFuc2ZlcnMKCiAgZnVuY3Rpb24gUGF1c2FibGUoKSBwdWJsaWMgewogICAgYmxvY2tlZFRpbWVGb3JCb3VudHlUb2tlbnMgPSBNSU5fYmxvY2tlZFRpbWVGb3JCb3VudHlUb2tlbnM7CiAgICBibG9ja2VkVGltZUZvckludmVzdGVkVG9rZW5zID0gTUlOX2Jsb2NrZWRUaW1lRm9ySW52ZXN0ZWRUb2tlbnM7CiAgfQoKICAvKioKICAqIEBkZXYgY2FsbGVkIGJ5IG93bmVyIGZvciBjaGFuZ2luZyBibG9ja2VkVGltZUZvckJvdW50eVRva2VucwogICovCiAgZnVuY3Rpb24gY2hhbmdlQmxvY2tlZFRpbWVGb3JCb3VudHlUb2tlbnModWludDI1NiBfYmxvY2tlZFRpbWUpIG9ubHlPd25lciBleHRlcm5hbCB7CiAgICByZXF1aXJlKF9ibG9ja2VkVGltZSA8IE1JTl9ibG9ja2VkVGltZUZvckJvdW50eVRva2Vucyk7CiAgICBibG9ja2VkVGltZUZvckJvdW50eVRva2VucyA9IF9ibG9ja2VkVGltZTsKICB9CgogIC8qKgoqIEBkZXYgY2FsbGVkIGJ5IG93bmVyIGZvciBjaGFuZ2luZyBibG9ja2VkVGltZUZvckludmVzdGVkVG9rZW5zCiovCiAgZnVuY3Rpb24gY2hhbmdlQmxvY2tlZFRpbWVGb3JJbnZlc3RlZFRva2Vucyh1aW50MjU2IF9ibG9ja2VkVGltZSkgb25seU93bmVyIGV4dGVybmFsIHsKICAgIHJlcXVpcmUoX2Jsb2NrZWRUaW1lIDwgTUlOX2Jsb2NrZWRUaW1lRm9ySW52ZXN0ZWRUb2tlbnMpOwogICAgYmxvY2tlZFRpbWVGb3JJbnZlc3RlZFRva2VucyA9IF9ibG9ja2VkVGltZTsKICB9CgoKICAvKioKICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIG5vdCBwYXVzZWQuCiAgICovCiAgbW9kaWZpZXIgd2hlbk5vdFBhdXNlZCgpIHsKICAgIHJlcXVpcmUoIWdldFBhdXNlZCgpKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIHBhdXNlZC4KICAgKi8KICBtb2RpZmllciB3aGVuUGF1c2VkKCkgewogICAgcmVxdWlyZShnZXRQYXVzZWQoKSk7CiAgICBfOwogIH0KCiAgZnVuY3Rpb24gZ2V0UGF1c2VkKCkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgewogICAgaWYgKG5vdyA+IGJsb2NrZWRUaW1lRm9yQm91bnR5VG9rZW5zICYmIG5vdyA+IGJsb2NrZWRUaW1lRm9ySW52ZXN0ZWRUb2tlbnMpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSBlbHNlIHsKICAgICAgdWludDI1NiBibG9ja2VkVGltZSA9IGNoZWNrVGltZUZvclRyYW5zZmVyKG1zZy5zZW5kZXIpOwogICAgICByZXR1cm4gbm93IDwgYmxvY2tlZFRpbWU7CiAgICB9CiAgfQoKCiAgLyoqCiAgKiBAZGV2IGNhbGxlZCBieSBvd25lciwgYWRkIHByZUljb0FjY291bnQKICAqLwogIGZ1bmN0aW9uIGFkZFByZUljb0FjY291bnRzKGFkZHJlc3MgX2FkZHIpIG9ubHlPd25lciBpbnRlcm5hbCB7CiAgICByZXF1aXJlKF9hZGRyICE9IDB4MCk7CiAgICBwcmVJY29BY2NvdW50c1tfYWRkcl0gPSB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IGNhbGxlZCBieSBvd25lciwgYWRkIGFkZEJvdW50eUFjY291bnQKICAqLwogIGZ1bmN0aW9uIGFkZEJvdW50eUFjY291bnRzKGFkZHJlc3MgX2FkZHIpIG9ubHlPd25lciBpbnRlcm5hbCB7CiAgICByZXF1aXJlKF9hZGRyICE9IDB4MCk7CiAgICBwcmVJY29BY2NvdW50c1tfYWRkcl0gPSB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IGNhbGxlZCBieSBvd25lciwgYWRkIGZvdW5kZXJBY2NvdW50CiAgKi8KICBmdW5jdGlvbiBhZGRGb3VuZGVyQWNjb3VudHMoYWRkcmVzcyBfYWRkciwgdWludCBfZmxhZykgb25seU93bmVyIGV4dGVybmFsIHsKICAgIHJlcXVpcmUoX2FkZHIgIT0gMHgwKTsKICAgIGZvdW5kZXJBY2NvdW50c1tfYWRkcl0gPSBfZmxhZzsKICB9CgogIC8qKgogICAqIEBkZXYgY2FsbGVkIGJ5IGV4dGVybmFsIGNvbnRyYWN0IChJbW1sYVRva2VuKSBmb3IgY2hlY2tpbmcgcmlnaHRzIGZvciB0cmFuc2ZlcnMsIGRlcGVuZHMgb24gd2hvIG93bmVyIG9mIHRoaXMgYWRkcmVzcwogICAqLwogIGZ1bmN0aW9uIGNoZWNrVGltZUZvclRyYW5zZmVyKGFkZHJlc3MgX2FjY291bnQpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChmb3VuZGVyQWNjb3VudHNbX2FjY291bnRdID09IDEpIHsKICAgICAgcmV0dXJuIGJsb2NrZWRUaW1lRm9ySW52ZXN0ZWRUb2tlbnM7CiAgICB9IGVsc2UgaWYoZm91bmRlckFjY291bnRzW19hY2NvdW50XSA9PSAyKSB7CiAgICAgIHJldHVybiAxOyAvL2RvIG5vdCBibG9jayB0cmFuc2ZlcnMKICAgIH0gZWxzZSBpZiAocHJlSWNvQWNjb3VudHNbX2FjY291bnRdKSB7CiAgICAgIHJldHVybiBibG9ja2VkVGltZUZvckludmVzdGVkVG9rZW5zOwogICAgfSBlbHNlIGlmIChib3VudHlBY2NvdW50c1tfYWNjb3VudF0pIHsKICAgICAgcmV0dXJuIGJsb2NrZWRUaW1lRm9yQm91bnR5VG9rZW5zOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGJsb2NrZWRUaW1lRm9ySW52ZXN0ZWRUb2tlbnM7CiAgICB9CiAgfQp9CgoKCi8qKgogKiBAdGl0bGUgUGF1c2FibGUgdG9rZW4KICoKICogQGRldiBTdGFuZGFyZFRva2VuIG1vZGlmaWVkIHdpdGggcGF1c2FibGUgdHJhbnNmZXJzLgogKiovCgpjb250cmFjdCBQYXVzYWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIFBhdXNhYmxlIHsKCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sKSB7CiAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLmFwcHJvdmUoX3NwZW5kZXIsIF92YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgcmV0dXJuIHN1cGVyLmluY3JlYXNlQXBwcm92YWwoX3NwZW5kZXIsIF9hZGRlZFZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJldHVybiBzdXBlci5kZWNyZWFzZUFwcHJvdmFsKF9zcGVuZGVyLCBfc3VidHJhY3RlZFZhbHVlKTsKICB9Cn0KCgoKCi8qKgogKiBAdGl0bGUgTWludGFibGUgdG9rZW4KICogQGRldiBTaW1wbGUgRVJDMjAgVG9rZW4gZXhhbXBsZSwgd2l0aCBtaW50YWJsZSB0b2tlbiBjcmVhdGlvbgogKiBAZGV2IElzc3VlOiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvaXNzdWVzLzEyMAogKiBCYXNlZCBvbiBjb2RlIGJ5IFRva2VuTWFya2V0TmV0OiBodHRwczovL2dpdGh1Yi5jb20vVG9rZW5NYXJrZXROZXQvaWNvL2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy9NaW50YWJsZVRva2VuLnNvbAogKi8KCmNvbnRyYWN0IE1pbnRhYmxlVG9rZW4gaXMgUGF1c2FibGVUb2tlbiB7CiAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKICBldmVudCBNaW50RmluaXNoZWQoKTsKCiAgYm9vbCBwdWJsaWMgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CgoKICBtb2RpZmllciBjYW5NaW50KCkgewogICAgcmVxdWlyZSghbWludGluZ0ZpbmlzaGVkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIG1pbnQgdG9rZW5zCiAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgbWludGVkIHRva2Vucy4KICAgKiBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAqIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoX2Ftb3VudCk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICBNaW50KF90bywgX2Ftb3VudCk7CiAgICBUcmFuc2ZlcihhZGRyZXNzKDApLCBfdG8sIF9hbW91bnQpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gbWludCB0b2tlbnMgZm9yIHByZS1pY28KICAgKi8KICBmdW5jdGlvbiBtdWx0aU1pbnRQcmVpY28oYWRkcmVzc1tdIF9kZXN0cywgdWludDI1NltdIF92YWx1ZXMpIG9ubHlPd25lciBjYW5NaW50IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGkgPSAwOwogICAgdWludDI1NiBjb3VudCA9IF9kZXN0cy5sZW5ndGg7CiAgICB3aGlsZSAoaSA8IGNvdW50KSB7CiAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKF92YWx1ZXNbaV0pOwogICAgICBiYWxhbmNlc1tfZGVzdHNbaV1dID0gYmFsYW5jZXNbX2Rlc3RzW2ldXS5hZGQoX3ZhbHVlc1tpXSk7CiAgICAgIGFkZFByZUljb0FjY291bnRzKF9kZXN0c1tpXSk7CiAgICAgIE1pbnQoX2Rlc3RzW2ldLCBfdmFsdWVzW2ldKTsKICAgICAgVHJhbnNmZXIoYWRkcmVzcygwKSwgX2Rlc3RzW2ldLCBfdmFsdWVzW2ldKTsKICAgICAgaSArPSAxOwogICAgfQogICAgcmV0dXJuKGkpOwogIH0KCiAgLyoqCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIG1pbnQgdG9rZW5zIGZvciBwcmUtaWNvCiAgICovCiAgZnVuY3Rpb24gbXVsdGlNaW50Qm91bnR5KGFkZHJlc3NbXSBfZGVzdHMsIHVpbnQyNTZbXSBfdmFsdWVzKSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBpID0gMDsKICAgIHVpbnQyNTYgY291bnQgPSBfZGVzdHMubGVuZ3RoOwogICAgd2hpbGUgKGkgPCBjb3VudCkgewogICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfdmFsdWVzW2ldKTsKICAgICAgYmFsYW5jZXNbX2Rlc3RzW2ldXSA9IGJhbGFuY2VzW19kZXN0c1tpXV0uYWRkKF92YWx1ZXNbaV0pOwogICAgICBhZGRCb3VudHlBY2NvdW50cyhfZGVzdHNbaV0pOwogICAgICBNaW50KF9kZXN0c1tpXSwgX3ZhbHVlc1tpXSk7CiAgICAgIFRyYW5zZmVyKGFkZHJlc3MoMCksIF9kZXN0c1tpXSwgX3ZhbHVlc1tpXSk7CiAgICAgIGkgKz0gMTsKICAgIH0KICAgIHJldHVybihpKTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gc3RvcCBtaW50aW5nIG5ldyB0b2tlbnMuCiAgICogQHJldHVybiBUcnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gZmluaXNoTWludGluZygpIG9ubHlPd25lciBjYW5NaW50IHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBtaW50aW5nRmluaXNoZWQgPSB0cnVlOwogICAgTWludEZpbmlzaGVkKCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCgoKLyoqCiAqIEB0aXRsZSBFUkMyMCB0b2tlbiB0aGF0IHRyYW5zZmVyYWJsZSBieSBvd25lcgogKi8KY29udHJhY3QgVHJhbnNmZXJhYmxlQnlPd25lciBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKCiAgLy8gdGltZXN0YW1wIHVudGlsIG93bmVyIGNvdWxkIHRyYW5zZmVyIGFsbCB0b2tlbnMKICB1aW50MjU2IGNvbnN0YW50IHB1YmxpYyBPV05FUl9UUkFOU0ZFUl9UT0tFTlMgPSBub3cgKyAxIHllYXJzOwoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIgYnkgb3duZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJCeU93bmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKG5vdyA8IE9XTkVSX1RSQU5TRkVSX1RPS0VOUyk7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW19mcm9tXSk7CgogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQp9CgoKCmNvbnRyYWN0IEltbWxhVG9rZW4gaXMgTWludGFibGVUb2tlbiwgVHJhbnNmZXJhYmxlQnlPd25lciB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICAvKgogICAgICogVG9rZW4gbWV0YSBkYXRhCiAgICAgKi8KICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJJTU1MQSI7CiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJJTUwiOwogICAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7Cn0KCgoKY29udHJhY3QgSW1tbGFEaXN0cmlidXRpb24gaXMgT3duYWJsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICAvLyBtaW5pbXVtIGFtb3VudCBvZiB0b2tlbnMgYSBidXllciBnZXRzIHBlciAxIGV0aGVyCiAgICB1aW50MjU2IGNvbnN0YW50IFJBVEVfTUlOID0gMzY0MDsKCiAgICAvLyB0aW1lc3RhbXAgdW50aWwgb3duZXIgY291bGQgdHJhbnNmZXIgYWxsIHRva2VucwogICAgdWludDI1NiBjb25zdGFudCBwdWJsaWMgT1dORVJfVFJBTlNGRVJfVE9LRU5TID0gbm93ICsgMSB5ZWFyczsKCiAgICAvLyBUaGUgdG9rZW4gYmVpbmcgc29sZAogICAgSW1tbGFUb2tlbiBwdWJsaWMgdG9rZW47CgogICAgLy9tYXhpbXVtIHRva2VucyBmb3IgbWludCBpbiBhZGRpdGlvbmFsIGVtaXNzaW9uCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBlbWlzc2lvbkxpbWl0ID0gNDE4MTI0MjM1ICogMSBldGhlcjsKCiAgICAvLyBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYWxyZWFkeSBtaW50ZWQgaW4gYWRkaXRpb25hbCBlbWlzc2lvbgogICAgdWludDI1NiBwdWJsaWMgYWRkaXRpb25hbEVtaXNzaW9uID0gMDsKCiAgICAvLyBhbW91bnQgb2YgdG9rZW4gdGhhdCBjdXJyZW50bHkgYXZhaWxhYmxlIGZvciBidXlpbmcKICAgIHVpbnQyNTYgcHVibGljIGF2YWlsYWJsZUVtaXNzaW9uID0gMDsKCiAgICBib29sIHB1YmxpYyBtaW50aW5nUHJlSWNvRmluaXNoID0gZmFsc2U7CiAgICBib29sIHB1YmxpYyBtaW50aW5nQm91bnR5RmluaXNoID0gZmFsc2U7CiAgICBib29sIHB1YmxpYyBtaW50aW5nRm91bmRlcnNGaW5pc2ggPSBmYWxzZTsKCiAgICAvLyBhZGRyZXNzIHdoZXJlIGZ1bmRzIGFyZSBjb2xsZWN0ZWQgKGJ5IGRlZmF1bHQgdF9TbGF2YSBhZGRyZXNzKQogICAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0OwoKICAgIC8vIGhvdyBtYW55IHRva2VuIHVuaXRzIGEgYnV5ZXIgZ2V0cyBwZXIgMSBldGhlcgogICAgdWludDI1NiBwdWJsaWMgcmF0ZTsKCiAgICBhZGRyZXNzIGNvbnN0YW50IHB1YmxpYyB0X0ltbWxhVG9rZW5EZXBvc2l0b3J5ID0gMHg2NDA3NUVFZjY0ZDlFMTA1QTYxMjI3Q2NDZDVmQTlGNmI1NERCMjc4OwogICAgYWRkcmVzcyBjb25zdGFudCBwdWJsaWMgdF9JbW1sYVRva2VuRGVwb3NpdG9yeTIgPSAweDJGYWFmMzcxQWY2MzkyZmRkMzAxNkUxMTFmQjRiM0I1NTFFZTQ2YUI7CiAgICBhZGRyZXNzIGNvbnN0YW50IHB1YmxpYyB0X0ltbWxhQm91bnR5VG9rZW5EZXBvc2l0b3J5ID0gMHg1QUIwOEM1RGZkNTNiOGY2ZjZDM2UzYmJGRGI1MjExNzBDMzg2M0IwOwogICAgYWRkcmVzcyBjb25zdGFudCBwdWJsaWMgdF9BbmRyZXkgPSAweDAyNzgxMEE5QzE3Y2IwRTczOWEzMzc2OUE5RTc5NEFBRjQwRDIzMzg7CiAgICBhZGRyZXNzIGNvbnN0YW50IHB1YmxpYyB0X01pY2hhaWwgPSAweDAwYWYwNmNGMEFlNkJEODNmQzM2YjZBZTA5MmJiNEY2NjlCNmRiRjA7CiAgICBhZGRyZXNzIGNvbnN0YW50IHB1YmxpYyB0X1NsYXZhID0gMHgwMGMxMUU1QjBiNWRiMDIzNERmRjlhMzU3RjU2MDc3YzlhN0E4M0QwOwogICAgYWRkcmVzcyBjb25zdGFudCBwdWJsaWMgdF9BbmRyZXkyID0gMHhDN2U3ODhGZWFFNjE1MDMxMzYwMjFjQzQ4YTBjOTViQjY2ZDBCOWYyOwogICAgYWRkcmVzcyBjb25zdGFudCBwdWJsaWMgdF9NaWNoYWlsMiA9IDB4YjZmNEVEMkNFMTlBMDhjMTY0NzkwNDE5RDVkODdEMzA3NEQ0QmQ5MjsKICAgIGFkZHJlc3MgY29uc3RhbnQgcHVibGljIHRfU2xhdmEyID0gMHgwMGRlZDMwMDI2MTM1ZkJDNDYwYzJBOWJmN2JlQzA2YzdGMzExMDFhOwoKICAgIC8qKgogICAgICogQGRldiBQcm9wb3NhbHMgZm9yIG1pbnQgdG9rZW5zIHRvIHNvbWUgYWRkcmVzcwogICAgICovCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gUHJvcG9zYWwpIHB1YmxpYyBwcm9wb3NhbHM7CgogICAgc3RydWN0IFByb3Bvc2FsIHsKICAgICAgICBhZGRyZXNzIHdhbGxldDsKICAgICAgICB1aW50MjU2IGFtb3VudDsKICAgICAgICB1aW50MjU2IG51bWJlck9mVm90ZXM7CiAgICAgICAgbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIHZvdGVkOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBNZW1iZXJzIG9mIGNvbmdyZXNzCiAgICAgKi8KICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgY29uZ3Jlc3M7CgogICAgLyoqCiAgICAgKiBAZGV2IE1pbmltYWwgcXVvcnVtIHZhbHVlCiAgICAgKi8KICAgIHVpbnQyNTYgcHVibGljIG1pbmltdW1RdW9ydW0gPSAxOwoKICAgIC8qKgogICAqIGV2ZW50IGZvciB0b2tlbiBwdXJjaGFzZSBsb2dnaW5nCiAgICogQHBhcmFtIHB1cmNoYXNlciB3aG8gcGFpZCBmb3IgdGhlIHRva2VucwogICAqIEBwYXJhbSB2YWx1ZSB3ZWlzIHBhaWQgZm9yIHB1cmNoYXNlCiAgICogQHBhcmFtIGFtb3VudCBhbW91bnQgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAqLwogICAgZXZlbnQgVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IGFtb3VudCk7CgogICAgLyoqCiAgICAgKiBAZGV2IE9uIHByb3Bvc2FsIGFkZGVkCiAgICAgKiBAcGFyYW0gY29uZ3Jlc3NtYW4gQ29uZ3Jlc3NtYW4gYWRkcmVzcwogICAgICogQHBhcmFtIHdhbGxldCBXYWxsZXQKICAgICAqIEBwYXJhbSBhbW91bnQgQW1vdW50IG9mIHdlaSB0byB0cmFuc2ZlcgogICAgICovCiAgICBldmVudCBQcm9wb3NhbEFkZGVkKGFkZHJlc3MgaW5kZXhlZCBjb25ncmVzc21hbiwgYWRkcmVzcyBpbmRleGVkIHdhbGxldCwgdWludDI1NiBpbmRleGVkIGFtb3VudCk7CgogICAgLyoqCiAgICAgKiBAZGV2IE9uIHByb3Bvc2FsIHBhc3NlZAogICAgICogQHBhcmFtIGNvbmdyZXNzbWFuIENvbmdyZXNzbWFuIGFkZHJlc3MKICAgICAqIEBwYXJhbSB3YWxsZXQgV2FsbGV0CiAgICAgKiBAcGFyYW0gYW1vdW50IEFtb3VudCBvZiB3ZWkgdG8gdHJhbnNmZXIKICAgICAqLwogICAgZXZlbnQgUHJvcG9zYWxQYXNzZWQoYWRkcmVzcyBpbmRleGVkIGNvbmdyZXNzbWFuLCBhZGRyZXNzIGluZGV4ZWQgd2FsbGV0LCB1aW50MjU2IGluZGV4ZWQgYW1vdW50KTsKCiAgICAvKioKICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIG1pbnRpbmcgZm9yIHByZS1pY28gaXMgbm90IHBhdXNlZC4KICAgKi8KICAgIG1vZGlmaWVyIHdoZW5Ob3RQcmVJY29GaW5pc2goKSB7CiAgICAgICAgcmVxdWlyZSghbWludGluZ1ByZUljb0ZpbmlzaCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIG1pbnRpbmcgZm9yIGJvdW50eSBpcyBub3QgcGF1c2VkLgogICAqLwogICAgbW9kaWZpZXIgd2hlbk5vdEJvdW50eUZpbmlzaCgpIHsKICAgICAgICByZXF1aXJlKCFtaW50aW5nQm91bnR5RmluaXNoKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgbWludGluZyBmb3IgYm91bnR5IGlzIG5vdCBwYXVzZWQuCiAgICovCiAgICBtb2RpZmllciB3aGVuTm90TWludGluZ0ZvdW5kZXJzKCkgewogICAgICAgIHJlcXVpcmUoIW1pbnRpbmdGb3VuZGVyc0ZpbmlzaCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgTW9kaWZpZXIgdGhhdCBhbGxvd3Mgb25seSBjb25ncmVzcyB0byB2b3RlIGFuZCBjcmVhdGUgbmV3IHByb3Bvc2FscwogICAgICovCiAgICBtb2RpZmllciBvbmx5Q29uZ3Jlc3MgewogICAgICAgIHJlcXVpcmUgKGNvbmdyZXNzW21zZy5zZW5kZXJdKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qCiAgICAgKiBJbW1sYURpc3RyaWJ1dGlvbiBjb25zdHJ1Y3RvcgogICAgICovCiAgICBmdW5jdGlvbiBJbW1sYURpc3RyaWJ1dGlvbihhZGRyZXNzIF90b2tlbikgcHVibGljIHBheWFibGUgeyAvLyBnYXMgNjI5NzA2NwogICAgICAgIHRva2VuID0gSW1tbGFUb2tlbihfdG9rZW4pOwoKICAgICAgICAvL0BUT0RPIC0gY2hhbmdlIHRoaXMgdG8gdF9TbGF2YSAoMHgwMGMxMUU1QjBiNWRiMDIzNERmRjlhMzU3RjU2MDc3YzlhN0E4M0QwKSBhZGRyZXNzIG9yIGRlcGxveSBjb250cmFjdCBmcm9tIHRoaXMgYWRkcmVzcwogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKCiAgICAgICAgd2FsbGV0ID0gb3duZXI7CiAgICAgICAgcmF0ZSA9IFJBVEVfTUlOOwoKICAgICAgICBjb25ncmVzc1t0X0FuZHJleV0gPSB0cnVlOwogICAgICAgIGNvbmdyZXNzW3RfTWljaGFpbF0gPSB0cnVlOwogICAgICAgIGNvbmdyZXNzW3RfU2xhdmFdID0gdHJ1ZTsKICAgICAgICBtaW5pbXVtUXVvcnVtID0gMzsKICAgIH0KCiAgICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gbWludCB0b2tlbnMgdG8gZm91bmRlcnMKICAgKi8KICAgIGZ1bmN0aW9uIG1pbnRUb0ZvdW5kZXJzKCkgb25seU93bmVyIHdoZW5Ob3RNaW50aW5nRm91bmRlcnMgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBtaW50VG9Gb3VuZGVycyh0X0ltbWxhVG9rZW5EZXBvc2l0b3J5LCA1MjAwMCAqIDEgZXRoZXIsIDIpOwogICAgICAgIG1pbnRUb0ZvdW5kZXJzKHRfSW1tbGFUb2tlbkRlcG9zaXRvcnkyLCAwLCAyKTsKICAgICAgICBtaW50VG9Gb3VuZGVycyh0X0ltbWxhQm91bnR5VG9rZW5EZXBvc2l0b3J5LCAwLCAyKTsKICAgICAgICBtaW50VG9Gb3VuZGVycyh0X0FuZHJleSwgICA1MjU1MTA4NDk4MzYwODYwMDAwMDAwMDAsIDEpOwogICAgICAgIG1pbnRUb0ZvdW5kZXJzKHRfTWljaGFpbCwgIDM5NDEzMzEzNzM3NzA2NTAwMDAwMDAwMCwgMSk7CiAgICAgICAgbWludFRvRm91bmRlcnModF9TbGF2YSwgICAgMzk0MTMzMTM3Mzc3MDY1MDAwMDAwMDAwLCAxKTsKICAgICAgICBtaW50VG9Gb3VuZGVycyh0X0FuZHJleTIsICAyODQxMzkwMTY4NTMwNjAwMDAwMDAwMDAsIDIpOwogICAgICAgIG1pbnRUb0ZvdW5kZXJzKHRfTWljaGFpbDIsIDIxMzEwNDI2MjYzOTc5NTAwMDAwMDAwMCwgMik7CiAgICAgICAgbWludFRvRm91bmRlcnModF9TbGF2YTIsICAgMjEzMTA0MjYyNjM5Nzk1MDAwMDAwMDAwLCAyKTsKICAgICAgICBtaW50aW5nRm91bmRlcnNGaW5pc2ggPSB0cnVlOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBmYWxsYmFjayBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBidXkgdG9rZW5zCiAgICBmdW5jdGlvbiAoKSBleHRlcm5hbCBwYXlhYmxlIHsKICAgICAgICBidXlUb2tlbnMoKTsKICAgIH0KCiAgICAvLyBsb3cgbGV2ZWwgdG9rZW4gcHVyY2hhc2UgZnVuY3Rpb24KICAgIGZ1bmN0aW9uIGJ1eVRva2VucygpIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKGF2YWlsYWJsZUVtaXNzaW9uID4gMCk7CiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgIT0gMCk7CgogICAgICAgIGFkZHJlc3MgaW52ZXN0b3IgPSBtc2cuc2VuZGVyOwogICAgICAgIHVpbnQyNTYgd2VpQW1vdW50ID0gbXNnLnZhbHVlOwoKICAgICAgICB1aW50MjU2IHRva2Vuc0Ftb3VudCA9IHdlaUFtb3VudC5tdWwocmF0ZSk7CgogICAgICAgIC8vY2FsY3VsYXRlIGNoYW5nZQogICAgICAgIHVpbnQyNTYgdG9rZW5zQ2hhbmdlID0gMDsKICAgICAgICBpZiAodG9rZW5zQW1vdW50ID4gYXZhaWxhYmxlRW1pc3Npb24pIHsKICAgICAgICAgICAgdG9rZW5zQ2hhbmdlID0gdG9rZW5zQW1vdW50IC0gYXZhaWxhYmxlRW1pc3Npb247CiAgICAgICAgICAgIHRva2Vuc0Ftb3VudCA9IGF2YWlsYWJsZUVtaXNzaW9uOwogICAgICAgIH0KCiAgICAgICAgLy9tYWtlIGNoYW5nZQogICAgICAgIHVpbnQyNTYgd2VpQ2hhbmdlID0gMDsKICAgICAgICBpZiAodG9rZW5zQ2hhbmdlID4gMCkgewogICAgICAgICAgICB3ZWlDaGFuZ2UgPSB0b2tlbnNDaGFuZ2UuZGl2KHJhdGUpOwogICAgICAgICAgICBpbnZlc3Rvci50cmFuc2Zlcih3ZWlDaGFuZ2UpOwogICAgICAgIH0KCiAgICAgICAgdWludDI1NiB3ZWlSYWlzZWQgPSB3ZWlBbW91bnQgLSB3ZWlDaGFuZ2U7CgogICAgICAgIC8vIHVwZGF0ZSByYWlzZWQgYW1vdW50IGFuZCBhZGRpdGlvbmFsIGVtaXNzaW9uCiAgICAgICAgYWRkaXRpb25hbEVtaXNzaW9uID0gYWRkaXRpb25hbEVtaXNzaW9uLmFkZCh0b2tlbnNBbW91bnQpOwogICAgICAgIGF2YWlsYWJsZUVtaXNzaW9uID0gYXZhaWxhYmxlRW1pc3Npb24uc3ViKHRva2Vuc0Ftb3VudCk7CgogICAgICAgIC8vc2VuZCB0b2tlbnMgdG8gaW52ZXN0b3IKICAgICAgICB0b2tlbi5taW50KGludmVzdG9yLCB0b2tlbnNBbW91bnQpOwogICAgICAgIFRva2VuUHVyY2hhc2UoaW52ZXN0b3IsIHdlaVJhaXNlZCwgdG9rZW5zQW1vdW50KTsKICAgICAgICBtaW50Qm9udXNUb0ZvdW5kZXJzKHRva2Vuc0Ftb3VudCk7CgogICAgICAgIC8vc2VuZCBldGhlciB0byBvd25lciB3YWxsZXQKICAgICAgICB3YWxsZXQudHJhbnNmZXIod2VpUmFpc2VkKTsKICAgIH0KCiAgICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gbWFrZSBhZGRpdGlvbmFsIGVtaXNzaW9uCiAgICovCiAgICBmdW5jdGlvbiB1cGRhdGVBZGRpdGlvbmFsRW1pc3Npb24odWludDI1NiBfYW1vdW50LCB1aW50MjU2IF9yYXRlKSBvbmx5T3duZXIgcHVibGljIHsgLy8gZ2FzIDQ4MTkxCiAgICAgICAgcmVxdWlyZShfYW1vdW50ID4gMCk7CiAgICAgICAgcmVxdWlyZShfYW1vdW50IDwgKGVtaXNzaW9uTGltaXQgLSBhZGRpdGlvbmFsRW1pc3Npb24pKTsKCiAgICAgICAgYXZhaWxhYmxlRW1pc3Npb24gPSBfYW1vdW50OwogICAgICAgIGlmIChfcmF0ZSA+IFJBVEVfTUlOKSB7CiAgICAgICAgICAgIHJhdGUgPSBSQVRFX01JTjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByYXRlID0gX3JhdGU7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byBzdG9wIG1pbnRpbmcKICAgKi8KICAgIGZ1bmN0aW9uIHN0b3BQcmVJY29NaW50KCkgb25seU93bmVyIHdoZW5Ob3RQcmVJY29GaW5pc2ggcHVibGljIHsKICAgICAgICBtaW50aW5nUHJlSWNvRmluaXNoID0gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gc3RvcCBtaW50aW5nCiAgICovCiAgICBmdW5jdGlvbiBzdG9wQm91bnR5TWludCgpIG9ubHlPd25lciB3aGVuTm90Qm91bnR5RmluaXNoIHB1YmxpYyB7CiAgICAgICAgbWludGluZ0JvdW50eUZpbmlzaCA9IHRydWU7CiAgICB9CgogICAgLyoqCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIG1pbnQgdG9rZW5zIGZvciBwcmUtaWNvCiAgICovCiAgICBmdW5jdGlvbiBtdWx0aU1pbnRQcmVJY28oYWRkcmVzc1tdIF9kZXN0cywgdWludDI1NltdIF92YWx1ZXMpIG9ubHlPd25lciB3aGVuTm90UHJlSWNvRmluaXNoIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgdG9rZW4ubXVsdGlNaW50UHJlaWNvKF9kZXN0cywgX3ZhbHVlcyk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIG1pbnQgdG9rZW5zIGZvciBib3VudHkKICAgKi8KICAgIGZ1bmN0aW9uIG11bHRpTWludEJvdW50eShhZGRyZXNzW10gX2Rlc3RzLCB1aW50MjU2W10gX3ZhbHVlcykgb25seU93bmVyIHdoZW5Ob3RCb3VudHlGaW5pc2ggcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICB0b2tlbi5tdWx0aU1pbnRCb3VudHkoX2Rlc3RzLCBfdmFsdWVzKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgKiBAZGV2IGNhbGxlZCB0byBtaW50IHRva2VucyB0byBmb3VuZGVycwogICAqLwogICAgZnVuY3Rpb24gbWludFRvRm91bmRlcnMoYWRkcmVzcyBfZGVzdCwgdWludDI1NiBfdmFsdWUsIHVpbnQgX2ZsYWcpIGludGVybmFsIHsKICAgICAgICB0b2tlbi5taW50KF9kZXN0LCBfdmFsdWUpOwogICAgICAgIHRva2VuLmFkZEZvdW5kZXJBY2NvdW50cyhfZGVzdCwgX2ZsYWcpOwogICAgfQoKICAgIC8qKgogICAqIEBkZXYgY2FsbGVkIHRvIG1pbnQgYm9udXMgdG9rZW5zIHRvIGZvdW5kZXJzCiAgICovCiAgICBmdW5jdGlvbiBtaW50Qm9udXNUb0ZvdW5kZXJzKHVpbnQyNTYgX3ZhbHVlKSBpbnRlcm5hbCB7CgogICAgICAgIHVpbnQyNTYgdmFsdWVXaXRoQ29lZmZpY2llbnQgPSAoX3ZhbHVlICogMTAwMCkgLyA4MTM7CiAgICAgICAgdWludDI1NiB2YWx1ZVdpdGhNdWx0aXBsaWVyMSA9IHZhbHVlV2l0aENvZWZmaWNpZW50IC8gMTA7CiAgICAgICAgdWludDI1NiB2YWx1ZVdpdGhNdWx0aXBsaWVyMiA9ICh2YWx1ZVdpdGhDb2VmZmljaWVudCAqIDcpIC8gMTAwOwoKICAgICAgICB0b2tlbi5taW50KHRfQW5kcmV5LCAodmFsdWVXaXRoTXVsdGlwbGllcjEgKiA0KSAvIDEwKTsKICAgICAgICB0b2tlbi5taW50KHRfTWljaGFpbCwgKHZhbHVlV2l0aE11bHRpcGxpZXIxICogMykgLyAxMCk7CiAgICAgICAgdG9rZW4ubWludCh0X1NsYXZhLCAodmFsdWVXaXRoTXVsdGlwbGllcjEgKiAzKSAvIDEwKTsKICAgICAgICB0b2tlbi5taW50KHRfQW5kcmV5MiwgKHZhbHVlV2l0aE11bHRpcGxpZXIyICogNCkgLyAxMCk7CiAgICAgICAgdG9rZW4ubWludCh0X01pY2hhaWwyLCAodmFsdWVXaXRoTXVsdGlwbGllcjIgKiAzKSAvIDEwKTsKICAgICAgICB0b2tlbi5taW50KHRfU2xhdmEyLCAodmFsdWVXaXRoTXVsdGlwbGllcjIgKiAzKSAvIDEwKTsKICAgICAgICB0b2tlbi5taW50KHRfSW1tbGFCb3VudHlUb2tlbkRlcG9zaXRvcnksICh2YWx1ZVdpdGhDb2VmZmljaWVudCAqIDE1KSAvIDEwMDApOwogICAgfQoKICAgIC8qKgogICogQGRldiBjYWxsZWQgYnkgb3duZXIgZm9yIGNoYW5naW5nIGJsb2NrZWRUaW1lRm9yQm91bnR5VG9rZW5zCiAgKi8KICAgIGZ1bmN0aW9uIGNoYW5nZUJsb2NrZWRUaW1lRm9yQm91bnR5VG9rZW5zKHVpbnQyNTYgX2Jsb2NrZWRUaW1lKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICB0b2tlbi5jaGFuZ2VCbG9ja2VkVGltZUZvckJvdW50eVRva2VucyhfYmxvY2tlZFRpbWUpOwogICAgfQoKICAgIC8qKgogICogQGRldiBjYWxsZWQgYnkgb3duZXIgZm9yIGNoYW5naW5nIGJsb2NrZWRUaW1lRm9ySW52ZXN0ZWRUb2tlbnMKICAqLwogICAgZnVuY3Rpb24gY2hhbmdlQmxvY2tlZFRpbWVGb3JJbnZlc3RlZFRva2Vucyh1aW50MjU2IF9ibG9ja2VkVGltZSkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgdG9rZW4uY2hhbmdlQmxvY2tlZFRpbWVGb3JJbnZlc3RlZFRva2VucyhfYmxvY2tlZFRpbWUpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBDcmVhdGUgYSBuZXcgcHJvcG9zYWwKICAgICAqIEBwYXJhbSBfd2FsbGV0IEJlbmVmaWNpYXJ5IGFjY291bnQgYWRkcmVzcwogICAgICogQHBhcmFtIF9hbW91bnQgQW1vdW50IG9mIHRva2VucwogICAgICovCiAgICBmdW5jdGlvbiBwcm9wb3NhbChhZGRyZXNzIF93YWxsZXQsIHVpbnQyNTYgX2Ftb3VudCkgb25seUNvbmdyZXNzIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShhdmFpbGFibGVFbWlzc2lvbiA+IDApOwogICAgICAgIHJlcXVpcmUoX2Ftb3VudCA+IDApOwogICAgICAgIHJlcXVpcmUoX3dhbGxldCAhPSAweDApOwogICAgICAgIAogICAgICAgIGlmIChwcm9wb3NhbHNbX3dhbGxldF0uYW1vdW50ID4gMCkgewogICAgICAgICAgICByZXF1aXJlKHByb3Bvc2Fsc1tfd2FsbGV0XS52b3RlZFttc2cuc2VuZGVyXSAhPSB0cnVlKTsgLy8gSWYgaGFzIGFscmVhZHkgdm90ZWQsIGNhbmNlbAogICAgICAgICAgICByZXF1aXJlKHByb3Bvc2Fsc1tfd2FsbGV0XS5hbW91bnQgPT0gX2Ftb3VudCk7IC8vIElmIGFtb3VudHMgaXMgZXF1YWwKCiAgICAgICAgICAgIHByb3Bvc2Fsc1tfd2FsbGV0XS52b3RlZFttc2cuc2VuZGVyXSA9IHRydWU7IC8vIFNldCB0aGlzIHZvdGVyIGFzIGhhdmluZyB2b3RlZAogICAgICAgICAgICBwcm9wb3NhbHNbX3dhbGxldF0ubnVtYmVyT2ZWb3RlcysrOyAvLyBJbmNyZWFzZSB0aGUgbnVtYmVyIG9mIHZvdGVzCgogICAgICAgICAgICAvL3Byb3Bvc2FsIHBhc3NlZAogICAgICAgICAgICBpZiAocHJvcG9zYWxzW193YWxsZXRdLm51bWJlck9mVm90ZXMgPj0gbWluaW11bVF1b3J1bSkgewogICAgICAgICAgICAgICAgaWYgKF9hbW91bnQgPiBhdmFpbGFibGVFbWlzc2lvbikgewogICAgICAgICAgICAgICAgICAgIF9hbW91bnQgPSBhdmFpbGFibGVFbWlzc2lvbjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgcmFpc2VkIGFtb3VudCBhbmQgYWRkaXRpb25hbCBlbWlzc2lvbgogICAgICAgICAgICAgICAgYWRkaXRpb25hbEVtaXNzaW9uID0gYWRkaXRpb25hbEVtaXNzaW9uLmFkZChfYW1vdW50KTsKICAgICAgICAgICAgICAgIGF2YWlsYWJsZUVtaXNzaW9uID0gYXZhaWxhYmxlRW1pc3Npb24uc3ViKF9hbW91bnQpOwoKICAgICAgICAgICAgICAgIHRva2VuLm1pbnQoX3dhbGxldCwgX2Ftb3VudCk7CiAgICAgICAgICAgICAgICBUb2tlblB1cmNoYXNlKF93YWxsZXQsIDAsIF9hbW91bnQpOwogICAgICAgICAgICAgICAgUHJvcG9zYWxQYXNzZWQobXNnLnNlbmRlciwgX3dhbGxldCwgX2Ftb3VudCk7CgogICAgICAgICAgICAgICAgbWludEJvbnVzVG9Gb3VuZGVycyhfYW1vdW50KTsKICAgICAgICAgICAgICAgIGRlbGV0ZSBwcm9wb3NhbHNbX3dhbGxldF07CiAgICAgICAgICAgIH0KCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgUHJvcG9zYWwgc3RvcmFnZSBwID0gcHJvcG9zYWxzW193YWxsZXRdOwoKICAgICAgICAgICAgcC53YWxsZXQgICAgICAgICAgID0gX3dhbGxldDsKICAgICAgICAgICAgcC5hbW91bnQgICAgICAgICAgID0gX2Ftb3VudDsKICAgICAgICAgICAgcC5udW1iZXJPZlZvdGVzICAgID0gMTsKICAgICAgICAgICAgcC52b3RlZFttc2cuc2VuZGVyXSA9IHRydWU7CgogICAgICAgICAgICBQcm9wb3NhbEFkZGVkKG1zZy5zZW5kZXIsIF93YWxsZXQsIF9hbW91bnQpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAqIEBkZXYgY2FsbGVkIGJ5IG93bmVyIGZvciB0cmFuc2ZlciB0b2tlbnMKICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJUb2tlbnMoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfYW1vdW50ID4gMCk7CgogICAgICAgIC8vY2FuJ3QgdHJhbnNmZXIgYWZ0ZXIgT1dORVJfVFJBTlNGRVJfVE9LRU5TIGRhdGUgKGFmdGVyIDEgeWVhcikKICAgICAgICByZXF1aXJlKG5vdyA8IE9XTkVSX1RSQU5TRkVSX1RPS0VOUyk7CgogICAgICAgIC8vY2FuJ3QgdHJhbnNmZXIgZnJvbSBhbmQgdG8gY29uZ3Jlc3NtYW4gYWRkcmVzc2VzCiAgICAgICAgcmVxdWlyZSghY29uZ3Jlc3NbX2Zyb21dKTsKICAgICAgICByZXF1aXJlKCFjb25ncmVzc1tfdG9dKTsKCiAgICAgICAgdG9rZW4udHJhbnNmZXJCeU93bmVyKF9mcm9tLCBfdG8sIF9hbW91bnQpOwogICAgfQp9'.
	

]
