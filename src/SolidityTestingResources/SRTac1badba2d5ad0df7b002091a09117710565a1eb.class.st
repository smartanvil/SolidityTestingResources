Class {
	#name : #SRTac1badba2d5ad0df7b002091a09117710565a1eb,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTac1badba2d5ad0df7b002091a09117710565a1eb >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7IC8vIHNvbGhpbnQtZGlzYWJsZS1saW5lCgpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKY29udHJhY3QgRVJDNzIxIHsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSUQpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKICAgIGZ1bmN0aW9uIGltcGxlbWVudHNFUkM3MjEoKSBwdWJsaWMgcHVyZSByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JRCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBhZGRyKTsKICAgIGZ1bmN0aW9uIHRha2VPd25lcnNoaXAodWludDI1NiBfdG9rZW5JRCkgcHVibGljOwogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHRvdGFsKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JRCkgcHVibGljOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSUQpIHB1YmxpYzsKCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHRva2VuSUQpOyAvLyBzb2xoaW50LWRpc2FibGUtbGluZQogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgYXBwcm92ZWQsIHVpbnQyNTYgdG9rZW5JRCk7CgogICAgZnVuY3Rpb24gbmFtZSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKHN0cmluZyk7CiAgICBmdW5jdGlvbiBzeW1ib2woKSBwdWJsaWMgcHVyZSByZXR1cm5zIChzdHJpbmcpOwp9Cgpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cn0KCmNvbnRyYWN0IE1hbmFnZWFibGUgaXMgT3duYWJsZSB7CgogICAgYWRkcmVzcyBwdWJsaWMgbWFuYWdlcjsKICAgIGJvb2wgcHVibGljIGNvbnRyYWN0TG9jazsKCiAgICBldmVudCBNYW5hZ2VyVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzTWFuYWdlciwgYWRkcmVzcyBpbmRleGVkIG5ld01hbmFnZXIpOwogICAgZXZlbnQgQ29udHJhY3RMb2NrQ2hhbmdlZChhZGRyZXNzIGFkbWluLCBib29sIHN0YXRlKTsKCiAgICBmdW5jdGlvbiBNYW5hZ2VhYmxlKCkgcHVibGljIHsKICAgICAgICBtYW5hZ2VyID0gbXNnLnNlbmRlcjsKICAgICAgICBjb250cmFjdExvY2sgPSBmYWxzZTsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5TWFuYWdlcigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gbWFuYWdlcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5QWRtaW4oKSB7CiAgICAgICAgcmVxdWlyZSgobXNnLnNlbmRlciA9PSBtYW5hZ2VyKSB8fCAobXNnLnNlbmRlciA9PSBvd25lcikpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgaXNVbmxvY2tlZCgpIHsKICAgICAgICByZXF1aXJlKCFjb250cmFjdExvY2spOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJNYW5hZ2VyKGFkZHJlc3MgbmV3TWFuYWdlcikgcHVibGljIG9ubHlBZG1pbiB7CiAgICAgICAgcmVxdWlyZShuZXdNYW5hZ2VyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIE1hbmFnZXJUcmFuc2ZlcnJlZChtYW5hZ2VyLCBuZXdNYW5hZ2VyKTsKICAgICAgICBtYW5hZ2VyID0gbmV3TWFuYWdlcjsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRDb250cmFjdExvY2soYm9vbCBzZXR0aW5nKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICBjb250cmFjdExvY2sgPSBzZXR0aW5nOwogICAgICAgIENvbnRyYWN0TG9ja0NoYW5nZWQobXNnLnNlbmRlciwgc2V0dGluZyk7CiAgICB9CgogICAgZnVuY3Rpb24gcGF5b3V0KGFkZHJlc3MgX3RvKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBpZiAoX3RvID09IGFkZHJlc3MoMCkpIHsKICAgICAgICAgICAgb3duZXIudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfdG8udHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gd2l0aGRyYXdGdW5kcyhhZGRyZXNzIF90bywgdWludDI1NiBhbW91bnQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUodGhpcy5iYWxhbmNlID49IGFtb3VudCk7CiAgICAgICAgaWYgKF90byA9PSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIG93bmVyLnRyYW5zZmVyKGFtb3VudCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3RvLnRyYW5zZmVyKGFtb3VudCk7CiAgICAgICAgfQogICAgfQp9Cgpjb250cmFjdCBUb2tlbkxheWVyIGlzIEVSQzcyMSwgTWFuYWdlYWJsZSB7CgogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBFVkVOVFMgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAgIGV2ZW50IFRva2VuQ3JlYXRlZCh1aW50MjU2IHRva2VuSWQsIGJ5dGVzMzIgbmFtZSwgdWludDI1NiBwYXJlbnRJZCwgYWRkcmVzcyBvd25lcik7CiAgICBldmVudCBUb2tlbkRlbGV0ZWQodWludDI1NiB0b2tlbklkKTsKCiAgICBldmVudCBUb2tlblNvbGQoCiAgICAgICAgdWludDI1NiB0b2tlbklkLCB1aW50MjU2IG9sZFByaWNlLAogICAgICAgIHVpbnQyNTYgbmV3UHJpY2UsIGFkZHJlc3MgcHJldk93bmVyLAogICAgICAgIGFkZHJlc3Mgd2lubmVyLCBieXRlczMyIG5hbWUsCiAgICAgICAgdWludDI1NiBwYXJlbnRJZAogICAgKTsKCiAgICBldmVudCBQcmljZUNoYW5nZWQodWludDI1NiB0b2tlbklkLCB1aW50MjU2IG9sZFByaWNlLCB1aW50MjU2IG5ld1ByaWNlKTsKICAgIGV2ZW50IFBhcmVudENoYW5nZWQodWludDI1NiB0b2tlbklkLCB1aW50MjU2IG9sZFBhcmVudElkLCB1aW50MjU2IG5ld1BhcmVudElkKTsKICAgIGV2ZW50IE5hbWVDaGFuZ2VkKHVpbnQyNTYgdG9rZW5JZCwgYnl0ZXMzMiBvbGROYW1lLCBieXRlczMyIG5ld05hbWUpOwogICAgZXZlbnQgTWV0YURhdGFDaGFuZ2VkKHVpbnQyNTYgdG9rZW5JZCwgYnl0ZXMzMiBvbGRNZXRhLCBieXRlczMyIG5ld01ldGEpOwovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBTVE9SQUdFICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgdWludDI1NiBwcml2YXRlIGNvbnN0YW50IERFRkFVTFRQQVJFTlQgPSAxMjM0NTY3ODk7CgogICAgbWFwcGluZyAodWludDI1NiA9PiBUb2tlbikgICBwcml2YXRlIHRva2VuSW5kZXhUb1Rva2VuOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwcml2YXRlIG93bmVyc2hpcFRva2VuQ291bnQ7CgogICAgYWRkcmVzcyBwdWJsaWMgZ2FtZUFkZHJlc3M7CiAgICBhZGRyZXNzIHB1YmxpYyBwYXJlbnRBZGRyOwoKICAgIHVpbnQyNTYgcHJpdmF0ZSB0b3RhbFRva2VuczsKICAgIHVpbnQyNTYgcHVibGljIGRldkZlZSA9IDUwOwogICAgdWludDI1NiBwdWJsaWMgb3duZXJGZWUgPSAyMDA7CiAgICB1aW50MjU2WzEwXSBwcml2YXRlIGNoYWluRmVlcyA9IFsxMF07CgogICAgc3RydWN0IFRva2VuIHsKICAgICAgICBib29sIGV4aXN0czsKICAgICAgICBhZGRyZXNzIGFwcHJvdmVkOwogICAgICAgIGFkZHJlc3Mgb3duZXI7CiAgICAgICAgYnl0ZXMzMiBtZXRhZGF0YTsKICAgICAgICBieXRlczMyIG5hbWU7CiAgICAgICAgdWludDI1NiBsYXN0QmxvY2s7CiAgICAgICAgdWludDI1NiBwYXJlbnRJZDsKICAgICAgICB1aW50MjU2IHByaWNlOwogICAgfQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIE1PRElGSUVSUyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgbW9kaWZpZXIgb25seVN5c3RlbSgpIHsKICAgICAgICByZXF1aXJlKChtc2cuc2VuZGVyID09IGdhbWVBZGRyZXNzKSB8fCAobXNnLnNlbmRlciA9PSBtYW5hZ2VyKSk7CiAgICAgICAgXzsKICAgIH0KLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIENPTlNUUlVDVE9SICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAgIGZ1bmN0aW9uIFRva2VuTGF5ZXIoYWRkcmVzcyBfZ2FtZUFkZHJlc3MsIGFkZHJlc3MgX3BhcmVudEFkZHIpIHB1YmxpYyB7CiAgICAgICAgZ2FtZUFkZHJlc3MgPSBfZ2FtZUFkZHJlc3M7CiAgICAgICAgcGFyZW50QWRkciA9IF9wYXJlbnRBZGRyOwogICAgfQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIFBVQkxJQyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgZnVuY3Rpb24gaW1wbGVtZW50c0VSQzcyMSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBuYW1lKCkgcHVibGljIHB1cmUgcmV0dXJucyAoc3RyaW5nKSB7CiAgICAgICAgcmV0dXJuICJDcnlwdG9DaXRpZXMiOwogICAgfQoKICAgIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyBwdXJlIHJldHVybnMgKHN0cmluZykgewogICAgICAgIHJldHVybiAiQ291bnRyeVRva2VuIjsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkLCBhZGRyZXNzIF9mcm9tKSBwdWJsaWMgb25seVN5c3RlbSB7CiAgICAgICAgX2FwcHJvdmUoX3RvLCBfdG9rZW5JZCwgX2Zyb20pOwogICAgfQoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBpc1VubG9ja2VkIHsKICAgICAgICBfYXBwcm92ZShfdG8sIF90b2tlbklkLCBtc2cuc2VuZGVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgICAgIHJldHVybiBvd25lcnNoaXBUb2tlbkNvdW50W19vd25lcl07CiAgICB9CgogICAgZnVuY3Rpb24gYnVuZGxlVG9rZW4odWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50MjU2WzhdIF90b2tlbkRhdGEpIHsKICAgICAgICBUb2tlbiBzdG9yYWdlIHRva2VuID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdOwoKICAgICAgICB1aW50MjU2WzhdIG1lbW9yeSB0b2tlbkRhdGE7CgogICAgICAgIHRva2VuRGF0YVswXSA9IHVpbnQyNTYodG9rZW4ubmFtZSk7CiAgICAgICAgdG9rZW5EYXRhWzFdID0gdG9rZW4ucGFyZW50SWQ7CiAgICAgICAgdG9rZW5EYXRhWzJdID0gdG9rZW4ucHJpY2U7CiAgICAgICAgdG9rZW5EYXRhWzNdID0gdWludDI1Nih0b2tlbi5vd25lcik7CiAgICAgICAgdG9rZW5EYXRhWzRdID0gX2dldE5leHRQcmljZShfdG9rZW5JZCk7CiAgICAgICAgdG9rZW5EYXRhWzVdID0gZGV2RmVlK2dldENoYWluRmVlcyhfdG9rZW5JZCk7CiAgICAgICAgdG9rZW5EYXRhWzZdID0gdWludDI1Nih0b2tlbi5hcHByb3ZlZCk7CiAgICAgICAgdG9rZW5EYXRhWzddID0gdWludDI1Nih0b2tlbi5tZXRhZGF0YSk7CiAgICAgICAgcmV0dXJuIHRva2VuRGF0YTsKICAgIH0KCiAgICBmdW5jdGlvbiB0YWtlT3duZXJzaGlwKHVpbnQyNTYgX3Rva2VuSWQsIGFkZHJlc3MgX3RvKSBwdWJsaWMgb25seVN5c3RlbSB7CiAgICAgICAgX3Rha2VPd25lcnNoaXAoX3Rva2VuSWQsIF90byk7CiAgICB9CgogICAgZnVuY3Rpb24gdGFrZU93bmVyc2hpcCh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgaXNVbmxvY2tlZCB7CiAgICAgICAgX3Rha2VPd25lcnNoaXAoX3Rva2VuSWQsIG1zZy5zZW5kZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRva2Vuc09mT3duZXIoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTZbXSBvd25lclRva2VucykgewogICAgICAgIHVpbnQyNTYgdG9rZW5Db3VudCA9IGJhbGFuY2VPZihfb3duZXIpOwogICAgICAgIGlmICh0b2tlbkNvdW50ID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyB1aW50MjU2W10oMCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdWludDI1NltdIG1lbW9yeSByZXN1bHQgPSBuZXcgdWludDI1NltdKHRva2VuQ291bnQpOwogICAgICAgICAgICB1aW50MjU2IF90b3RhbFRva2VucyA9IHRvdGFsU3VwcGx5KCk7CiAgICAgICAgICAgIHVpbnQyNTYgcmVzdWx0SW5kZXggPSAwOwoKICAgICAgICAgICAgdWludDI1NiB0b2tlbklkID0gMDsKICAgICAgICAgICAgdWludDI1NiB0b2tlbkluZGV4ID0gMDsKICAgICAgICAgICAgd2hpbGUgKHRva2VuSW5kZXggPD0gX3RvdGFsVG9rZW5zKSB7CiAgICAgICAgICAgICAgICBpZiAoZXhpc3RzKHRva2VuSWQpKSB7CiAgICAgICAgICAgICAgICAgICAgdG9rZW5JbmRleCsrOwogICAgICAgICAgICAgICAgICAgIGlmICh0b2tlbkluZGV4VG9Ub2tlblt0b2tlbklkXS5vd25lciA9PSBfb3duZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3Jlc3VsdEluZGV4XSA9IHRva2VuSWQ7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdEluZGV4Kys7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdG9rZW5JZCsrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiB0b3RhbCkgewogICAgICAgIHJldHVybiB0b3RhbFRva2VuczsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIG9ubHlTeXN0ZW0gewogICAgICAgIF9jaGVja1RoZW5UcmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBpc1VubG9ja2VkIHsKICAgICAgICBfY2hlY2tUaGVuVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgb25seVN5c3RlbSB7CiAgICAgICAgX3RyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBpc1VubG9ja2VkIHsKICAgICAgICBfdHJhbnNmZXJGcm9tKF9mcm9tLCBtc2cuc2VuZGVyLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gY3JlYXRlVG9rZW4oCiAgICAgICAgdWludDI1NiBfdG9rZW5JZCwgYWRkcmVzcyBfb3duZXIsCiAgICAgICAgYnl0ZXMzMiBfbmFtZSwgdWludDI1NiBfcGFyZW50SWQsCiAgICAgICAgdWludDI1NiBfcHJpY2UsIGJ5dGVzMzIgX21ldGFkYXRhCiAgICApIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIHJlcXVpcmUoX3ByaWNlID4gMCk7CiAgICAgICAgcmVxdWlyZShfYWRkcmVzc05vdE51bGwoX293bmVyKSk7CiAgICAgICAgcmVxdWlyZShfdG9rZW5JZCA9PSB1aW50MjU2KHVpbnQzMihfdG9rZW5JZCkpKTsKICAgICAgICByZXF1aXJlKCFleGlzdHMoX3Rva2VuSWQpKTsKCiAgICAgICAgdG90YWxUb2tlbnMrKzsKCiAgICAgICAgVG9rZW4gbWVtb3J5IF90b2tlbiA9IFRva2VuKHsKICAgICAgICAgICAgbmFtZTogX25hbWUsCiAgICAgICAgICAgIHBhcmVudElkOiBfcGFyZW50SWQsCiAgICAgICAgICAgIGV4aXN0czogdHJ1ZSwKICAgICAgICAgICAgcHJpY2U6IF9wcmljZSwKICAgICAgICAgICAgb3duZXI6IF9vd25lciwKICAgICAgICAgICAgYXBwcm92ZWQgOiAwLAogICAgICAgICAgICBsYXN0QmxvY2sgOiBibG9jay5udW1iZXIsCiAgICAgICAgICAgIG1ldGFkYXRhIDogX21ldGFkYXRhCiAgICAgICAgfSk7CgogICAgICAgIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXSA9IF90b2tlbjsKCiAgICAgICAgVG9rZW5DcmVhdGVkKF90b2tlbklkLCBfbmFtZSwgX3BhcmVudElkLCBfb3duZXIpOwoKICAgICAgICBfdHJhbnNmZXIoYWRkcmVzcygwKSwgX293bmVyLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gY3JlYXRlVG9rZW5zKAogICAgICAgIHVpbnQyNTZbXSBfdG9rZW5JZHMsIGFkZHJlc3NbXSBfb3duZXJzLAogICAgICAgIGJ5dGVzMzJbXSBfbmFtZXMsIHVpbnQyNTZbXSBfcGFyZW50SWRzLAogICAgICAgIHVpbnQyNTZbXSBfcHJpY2VzLCBieXRlczMyW10gX21ldGFkYXRhcwogICAgKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICBmb3IgKHVpbnQyNTYgaWQgPSAwOyBpZCA8IF90b2tlbklkcy5sZW5ndGg7IGlkKyspIHsKICAgICAgICAgICAgY3JlYXRlVG9rZW4oCiAgICAgICAgICAgICAgICBfdG9rZW5JZHNbaWRdLCBfb3duZXJzW2lkXSwgX25hbWVzW2lkXSwKICAgICAgICAgICAgICAgIF9wYXJlbnRJZHNbaWRdLCBfcHJpY2VzW2lkXSwgX21ldGFkYXRhc1tpZF0KICAgICAgICAgICAgICAgICk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGRlbGV0ZVRva2VuKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIHJlcXVpcmUoX3Rva2VuSWQgPT0gdWludDI1Nih1aW50MzIoX3Rva2VuSWQpKSk7CiAgICAgICAgcmVxdWlyZShleGlzdHMoX3Rva2VuSWQpKTsKICAgICAgICB0b3RhbFRva2Vucy0tOwoKICAgICAgICBhZGRyZXNzIG9sZE93bmVyID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm93bmVyOwoKICAgICAgICBvd25lcnNoaXBUb2tlbkNvdW50W29sZE93bmVyXSA9IG93bmVyc2hpcFRva2VuQ291bnRbb2xkT3duZXJdLS07CiAgICAgICAgZGVsZXRlIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXTsKICAgICAgICBUb2tlbkRlbGV0ZWQoX3Rva2VuSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGluY3JlbWVudFByaWNlKHVpbnQyNTYgX3Rva2VuSWQsIGFkZHJlc3MgX3RvKSBwdWJsaWMgb25seVN5c3RlbSB7CiAgICAgICAgcmVxdWlyZShleGlzdHMoX3Rva2VuSWQpKTsKICAgICAgICB1aW50MjU2IF9wcmljZSA9IHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5wcmljZTsKICAgICAgICBhZGRyZXNzIF9vd25lciA9IHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5vd25lcjsKICAgICAgICB1aW50MjU2IF90b3RhbEZlZXMgPSBnZXRDaGFpbkZlZXMoX3Rva2VuSWQpOwogICAgICAgIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5wcmljZSA9IF9wcmljZS5tdWwoMTAwMCtvd25lckZlZSkuZGl2KDEwMDAtKGRldkZlZStfdG90YWxGZWVzKSk7CgogICAgICAgIFRva2VuU29sZCgKICAgICAgICAgICAgX3Rva2VuSWQsIF9wcmljZSwgdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLnByaWNlLAogICAgICAgICAgICBfb3duZXIsIF90bywgdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm5hbWUsCiAgICAgICAgICAgIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5wYXJlbnRJZAogICAgICAgICk7CiAgICB9CgogICAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzIF9vd25lcikgewogICAgICAgIHJlcXVpcmUoZXhpc3RzKF90b2tlbklkKSk7CiAgICAgICAgX293bmVyID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm93bmVyOwogICAgfQoKICAgIGZ1bmN0aW9uIGJsb2NrZWQodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCBfYmxvY2tlZCkgewogICAgICAgIHJldHVybiAodG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLmxhc3RCbG9jayA9PSBibG9jay5udW1iZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIGV4aXN0cyh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXR1cm4gKHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5leGlzdHMpOwogICAgfQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgZnVuY3Rpb24gc2V0TGF5ZXJQYXJlbnQoYWRkcmVzcyBfcGFyZW50KSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICBwYXJlbnRBZGRyID0gX3BhcmVudDsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRHYW1lKGFkZHJlc3MgX2dhbWVBZGRyZXNzKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICBnYW1lQWRkcmVzcyA9IF9nYW1lQWRkcmVzczsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRQcmljZSh1aW50MjU2IF90b2tlbklkLCB1aW50MjU2IF9wcmljZSwgYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBvbmx5U3lzdGVtIHsKICAgICAgICByZXF1aXJlKF9vd25zKF9vd25lciwgX3Rva2VuSWQpKTsKICAgICAgICB1aW50MjU2IG9sZFByaWNlID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLnByaWNlOwogICAgICAgIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5wcmljZSA9IF9wcmljZTsKICAgICAgICBQcmljZUNoYW5nZWQoX3Rva2VuSWQsIG9sZFByaWNlLCBfcHJpY2UpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFBhcmVudCh1aW50MjU2IF90b2tlbklkLCB1aW50MjU2IF9wYXJlbnRJZCkgcHVibGljIG9ubHlBZG1pbiB7CiAgICAgICAgcmVxdWlyZShleGlzdHMoX3Rva2VuSWQpKTsKICAgICAgICB1aW50MjU2IG9sZFBhcmVudElkID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLnBhcmVudElkOwogICAgICAgIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5wYXJlbnRJZCA9IF9wYXJlbnRJZDsKICAgICAgICBQYXJlbnRDaGFuZ2VkKF90b2tlbklkLCBvbGRQYXJlbnRJZCwgX3BhcmVudElkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXROYW1lKHVpbnQyNTYgX3Rva2VuSWQsIGJ5dGVzMzIgX25hbWUpIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIHJlcXVpcmUoZXhpc3RzKF90b2tlbklkKSk7CiAgICAgICAgYnl0ZXMzMiBvbGROYW1lID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm5hbWU7CiAgICAgICAgdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm5hbWUgPSBfbmFtZTsKICAgICAgICBOYW1lQ2hhbmdlZChfdG9rZW5JZCwgb2xkTmFtZSwgX25hbWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldE1ldGFkYXRhKHVpbnQyNTYgX3Rva2VuSWQsIGJ5dGVzMzIgX21ldGFkYXRhKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICByZXF1aXJlKGV4aXN0cyhfdG9rZW5JZCkpOwogICAgICAgIGJ5dGVzMzIgb2xkTWV0YSA9IHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5tZXRhZGF0YTsKICAgICAgICB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ubWV0YWRhdGEgPSBfbWV0YWRhdGE7CiAgICAgICAgTWV0YURhdGFDaGFuZ2VkKF90b2tlbklkLCBvbGRNZXRhLCBfbWV0YWRhdGEpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldERldkZlZSh1aW50MjU2IF9kZXZGZWUpIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIGRldkZlZSA9IF9kZXZGZWU7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0T3duZXJGZWUodWludDI1NiBfb3duZXJGZWUpIHB1YmxpYyBvbmx5QWRtaW4gewogICAgICAgIG93bmVyRmVlID0gX293bmVyRmVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldENoYWluRmVlcyh1aW50MjU2WzEwXSBfY2hhaW5GZWVzKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICBjaGFpbkZlZXMgPSBfY2hhaW5GZWVzOwogICAgfQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIEdFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgZnVuY3Rpb24gZ2V0VG9rZW4odWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucwogICAgKAogICAgICAgIGJ5dGVzMzIgdG9rZW5OYW1lLCB1aW50MjU2IHBhcmVudElkLCB1aW50MjU2IHByaWNlLAogICAgICAgIGFkZHJlc3MgX293bmVyLCB1aW50MjU2IG5leHRQcmljZSwgdWludDI1NiBuZXh0UHJpY2VGZWVzLAogICAgICAgIGFkZHJlc3MgYXBwcm92ZWQsIGJ5dGVzMzIgbWV0YWRhdGEKICAgICkgewogICAgICAgIFRva2VuIHN0b3JhZ2UgdG9rZW4gPSB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF07CgogICAgICAgIHRva2VuTmFtZSA9IHRva2VuLm5hbWU7CiAgICAgICAgcGFyZW50SWQgPSB0b2tlbi5wYXJlbnRJZDsKICAgICAgICBwcmljZSA9IHRva2VuLnByaWNlOwogICAgICAgIF9vd25lciA9IHRva2VuLm93bmVyOwogICAgICAgIG5leHRQcmljZSA9IF9nZXROZXh0UHJpY2UoX3Rva2VuSWQpOwogICAgICAgIG5leHRQcmljZUZlZXMgPSBkZXZGZWUrZ2V0Q2hhaW5GZWVzKF90b2tlbklkKTsKICAgICAgICBtZXRhZGF0YSA9IHRva2VuLm1ldGFkYXRhOwogICAgICAgIGFwcHJvdmVkID0gdG9rZW4uYXBwcm92ZWQ7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0Q2hhaW5GZWVzKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgX3RvdGFsKSB7CiAgICAgICAgdWludDI1NiBjaGFpbkxlbmd0aCA9IF9nZXRDaGFpbkxlbmd0aChfdG9rZW5JZCk7CiAgICAgICAgdWludDI1NiB0b3RhbEZlZSA9IDA7CiAgICAgICAgZm9yICh1aW50IGlkID0gMDsgaWQgPCBjaGFpbkxlbmd0aDsgaWQrKykgewogICAgICAgICAgICB0b3RhbEZlZSA9IHRvdGFsRmVlICsgY2hhaW5GZWVzW2lkXTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuKHRvdGFsRmVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRDaGFpbkZlZUFycmF5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NlsxMF0gbWVtb3J5IF9jaGFpbkZlZXMpIHsKICAgICAgICByZXR1cm4oY2hhaW5GZWVzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRQcmljZU9mKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgcHJpY2UpIHsKICAgICAgICByZXF1aXJlKGV4aXN0cyhfdG9rZW5JZCkpOwogICAgICAgIHJldHVybiB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ucHJpY2U7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0UGFyZW50T2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBwYXJlbnRJZCkgewogICAgICAgIHJlcXVpcmUoZXhpc3RzKF90b2tlbklkKSk7CiAgICAgICAgcmV0dXJuIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5wYXJlbnRJZDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRNZXRhZGF0YU9mKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJ5dGVzMzIgbWV0YWRhdGEpIHsKICAgICAgICByZXF1aXJlKGV4aXN0cyhfdG9rZW5JZCkpOwogICAgICAgIHJldHVybiAodG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm1ldGFkYXRhKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRDaGFpbih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzWzEwXSBtZW1vcnkgX293bmVycykgewogICAgICAgIHJlcXVpcmUoZXhpc3RzKF90b2tlbklkKSk7CgogICAgICAgIHVpbnQyNTYgX3BhcmVudElkID0gZ2V0UGFyZW50T2YoX3Rva2VuSWQpOwogICAgICAgIGFkZHJlc3MgX3BhcmVudEFkZHIgPSBwYXJlbnRBZGRyOwoKICAgICAgICBhZGRyZXNzWzEwXSBtZW1vcnkgcmVzdWx0OwoKICAgICAgICBpZiAoX3BhcmVudElkICE9IERFRkFVTFRQQVJFTlQgJiYgX2FkZHJlc3NOb3ROdWxsKF9wYXJlbnRBZGRyKSkgewogICAgICAgICAgICB1aW50MjU2IHJlc3VsdEluZGV4ID0gMDsKCiAgICAgICAgICAgIFRva2VuTGF5ZXIgbGF5ZXIgPSBUb2tlbkxheWVyKF9wYXJlbnRBZGRyKTsKICAgICAgICAgICAgYm9vbCBwYXJlbnRFeGlzdHMgPSBsYXllci5leGlzdHMoX3BhcmVudElkKTsKCiAgICAgICAgICAgIHdoaWxlICgoX3BhcmVudElkICE9IERFRkFVTFRQQVJFTlQpICYmIF9hZGRyZXNzTm90TnVsbChfcGFyZW50QWRkcikgJiYgcGFyZW50RXhpc3RzKSB7CiAgICAgICAgICAgICAgICBwYXJlbnRFeGlzdHMgPSBsYXllci5leGlzdHMoX3BhcmVudElkKTsKICAgICAgICAgICAgICAgIGlmICghcGFyZW50RXhpc3RzKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuKHJlc3VsdCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXN1bHRbcmVzdWx0SW5kZXhdID0gbGF5ZXIub3duZXJPZihfcGFyZW50SWQpOwogICAgICAgICAgICAgICAgcmVzdWx0SW5kZXgrKzsKCiAgICAgICAgICAgICAgICBfcGFyZW50SWQgPSBsYXllci5nZXRQYXJlbnRPZihfcGFyZW50SWQpOwogICAgICAgICAgICAgICAgX3BhcmVudEFkZHIgPSBsYXllci5wYXJlbnRBZGRyKCk7CgogICAgICAgICAgICAgICAgbGF5ZXIgPSBUb2tlbkxheWVyKF9wYXJlbnRBZGRyKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuKHJlc3VsdCk7CiAgICAgICAgfQogICAgfQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBQUklWQVRFICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgZnVuY3Rpb24gX2FkZHJlc3NOb3ROdWxsKGFkZHJlc3MgX3RvKSBwcml2YXRlIHB1cmUgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBfdG8gIT0gYWRkcmVzcygwKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfYXBwcm92ZWQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuICh0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0uYXBwcm92ZWQgPT0gX3RvKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfb3ducyhhZGRyZXNzIGNsYWltYW50LCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBjbGFpbWFudCA9PSB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ub3duZXI7CiAgICB9CgogICAgZnVuY3Rpb24gX2NoZWNrVGhlblRyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHsKICAgICAgICByZXF1aXJlKF9vd25zKF9mcm9tLCBfdG9rZW5JZCkpOwogICAgICAgIHJlcXVpcmUoX2FkZHJlc3NOb3ROdWxsKF90bykpOwogICAgICAgIHJlcXVpcmUoZXhpc3RzKF90b2tlbklkKSk7CiAgICAgICAgX3RyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfdHJhbnNmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgewogICAgICAgIG93bmVyc2hpcFRva2VuQ291bnRbX3RvXSsrOwogICAgICAgIHRva2VuSW5kZXhUb1Rva2VuW190b2tlbklkXS5vd25lciA9IF90bzsKICAgICAgICB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ubGFzdEJsb2NrID0gYmxvY2subnVtYmVyOwoKICAgICAgICBpZiAoX2Zyb20gIT0gYWRkcmVzcygwKSkgewogICAgICAgICAgICBvd25lcnNoaXBUb2tlbkNvdW50W19mcm9tXS0tOwogICAgICAgICAgICB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0uYXBwcm92ZWQgPSAwOwogICAgICAgIH0KCiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIF9hcHByb3ZlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkLCBhZGRyZXNzIF9mcm9tKSBwcml2YXRlIHsKICAgICAgICByZXF1aXJlKF9vd25zKF9mcm9tLCBfdG9rZW5JZCkpOwoKICAgICAgICB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0uYXBwcm92ZWQgPSBfdG87CgogICAgICAgIEFwcHJvdmFsKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfdGFrZU93bmVyc2hpcCh1aW50MjU2IF90b2tlbklkLCBhZGRyZXNzIF90bykgcHJpdmF0ZSB7CiAgICAgICAgYWRkcmVzcyBuZXdPd25lciA9IF90bzsKICAgICAgICBhZGRyZXNzIG9sZE93bmVyID0gdG9rZW5JbmRleFRvVG9rZW5bX3Rva2VuSWRdLm93bmVyOwoKICAgICAgICByZXF1aXJlKF9hZGRyZXNzTm90TnVsbChuZXdPd25lcikpOwogICAgICAgIHJlcXVpcmUoX2FwcHJvdmVkKG5ld093bmVyLCBfdG9rZW5JZCkpOwoKICAgICAgICBfdHJhbnNmZXIob2xkT3duZXIsIG5ld093bmVyLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gX3RyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHJpdmF0ZSB7CiAgICAgICAgcmVxdWlyZShfb3ducyhfZnJvbSwgX3Rva2VuSWQpKTsKICAgICAgICByZXF1aXJlKF9hcHByb3ZlZChfdG8sIF90b2tlbklkKSk7CiAgICAgICAgcmVxdWlyZShfYWRkcmVzc05vdE51bGwoX3RvKSk7CgogICAgICAgIF90cmFuc2ZlcihfZnJvbSwgX3RvLCBfdG9rZW5JZCk7CiAgICB9CgogICAgZnVuY3Rpb24gX2dldENoYWluTGVuZ3RoKHVpbnQyNTYgX3Rva2VuSWQpIHByaXZhdGUgdmlldyByZXR1cm5zICh1aW50MjU2IF9sZW5ndGgpIHsKICAgICAgICB1aW50MjU2IGxlbmd0aDsKCiAgICAgICAgdWludDI1NiBfcGFyZW50SWQgPSBnZXRQYXJlbnRPZihfdG9rZW5JZCk7CiAgICAgICAgYWRkcmVzcyBfcGFyZW50QWRkciA9IHBhcmVudEFkZHI7CiAgICAgICAgaWYgKF9wYXJlbnRJZCA9PSBERUZBVUxUUEFSRU5UIHx8ICFfYWRkcmVzc05vdE51bGwoX3BhcmVudEFkZHIpKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KCiAgICAgICAgVG9rZW5MYXllciBsYXllciA9IFRva2VuTGF5ZXIoX3BhcmVudEFkZHIpOwogICAgICAgIGJvb2wgcGFyZW50RXhpc3RzID0gbGF5ZXIuZXhpc3RzKF9wYXJlbnRJZCk7CgogICAgICAgIHdoaWxlICgoX3BhcmVudElkICE9IERFRkFVTFRQQVJFTlQpICYmIF9hZGRyZXNzTm90TnVsbChfcGFyZW50QWRkcikgJiYgcGFyZW50RXhpc3RzKSB7CiAgICAgICAgICAgIHBhcmVudEV4aXN0cyA9IGxheWVyLmV4aXN0cyhfcGFyZW50SWQpOwogICAgICAgICAgICBpZighcGFyZW50RXhpc3RzKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuKGxlbmd0aCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX3BhcmVudElkID0gbGF5ZXIuZ2V0UGFyZW50T2YoX3BhcmVudElkKTsKICAgICAgICAgICAgX3BhcmVudEFkZHIgPSBsYXllci5wYXJlbnRBZGRyKCk7CiAgICAgICAgICAgIGxheWVyID0gVG9rZW5MYXllcihfcGFyZW50QWRkcik7CiAgICAgICAgICAgIGxlbmd0aCsrOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuKGxlbmd0aCk7CiAgICB9CgogICAgZnVuY3Rpb24gX2dldE5leHRQcmljZSh1aW50MjU2IF90b2tlbklkKSBwcml2YXRlIHZpZXcgcmV0dXJucyAodWludDI1NiBfbmV4dFByaWNlKSB7CiAgICAgICAgdWludDI1NiBfcHJpY2UgPSB0b2tlbkluZGV4VG9Ub2tlbltfdG9rZW5JZF0ucHJpY2U7CiAgICAgICAgdWludDI1NiBfdG90YWxGZWVzID0gZ2V0Q2hhaW5GZWVzKF90b2tlbklkKTsKICAgICAgICBfcHJpY2UgPSBfcHJpY2UubXVsKDEwMDArb3duZXJGZWUpLmRpdigxMDAwLShkZXZGZWUrX3RvdGFsRmVlcykpOwogICAgICAgIHJldHVybihfcHJpY2UpOwogICAgfQp9'.
	

]
