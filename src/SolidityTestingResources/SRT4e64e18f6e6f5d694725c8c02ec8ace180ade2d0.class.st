Class {
	#name : #SRT4e64e18f6e6f5d694725c8c02ec8ace180ade2d0,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT4e64e18f6e6f5d694725c8c02ec8ace180ade2d0 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuODsKCmNvbnRyYWN0IG93bmVkIHsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwoKICAgIGZ1bmN0aW9uIG93bmVkKCkgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5T3duZXIgewogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IG93bmVyKSB0aHJvdzsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciB7CiAgICAgICAgaWYgKG5ld093bmVyID09IDB4MCkgdGhyb3c7CiAgICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgIH0KfQoKCi8qKgogKiBPdmVyZmxvdyBhd2FyZSB1aW50IG1hdGggZnVuY3Rpb25zLgogKi8KY29udHJhY3QgU2FmZU1hdGggewogIC8vaW50ZXJuYWxzCgogIGZ1bmN0aW9uIHNhZmVNdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgIHVpbnQgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc2FmZVN1Yih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICB1aW50IGMgPSBhICsgYjsKICAgIGFzc2VydChjPj1hICYmIGM+PWIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBhc3NlcnQoYm9vbCBhc3NlcnRpb24pIGludGVybmFsIHsKICAgIGlmICghYXNzZXJ0aW9uKSB0aHJvdzsKICB9Cn0KCmNvbnRyYWN0IFRva2VuIHsKICAgIC8qIFRoaXMgaXMgYSBzbGlnaHQgY2hhbmdlIHRvIHRoZSBFUkMyMCBiYXNlIHN0YW5kYXJkLgogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHN1cHBseSk7CiAgICBpcyByZXBsYWNlZCB3aXRoOgogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgICBUaGlzIGF1dG9tYXRpY2FsbHkgY3JlYXRlcyBhIGdldHRlciBmdW5jdGlvbiBmb3IgdGhlIHRvdGFsU3VwcGx5LgogICAgVGhpcyBpcyBtb3ZlZCB0byB0aGUgYmFzZSBjb250cmFjdCBzaW5jZSBwdWJsaWMgZ2V0dGVyIGZ1bmN0aW9ucyBhcmUgbm90CiAgICBjdXJyZW50bHkgcmVjb2duaXNlZCBhcyBhbiBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgbWF0Y2hpbmcgYWJzdHJhY3QKICAgIGZ1bmN0aW9uIGJ5IHRoZSBjb21waWxlci4KICAgICovCiAgICAvLy8gdG90YWwgYW1vdW50IG9mIHRva2VucwogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CgoKICAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIGZyb20gd2hpY2ggdGhlIGJhbGFuY2Ugd2lsbCBiZSByZXRyaWV2ZWQKICAgIC8vLyBAcmV0dXJuIFRoZSBiYWxhbmNlCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7CgogICAgLy8vIEBub3RpY2Ugc2VuZCBgX3ZhbHVlYCB0b2tlbiB0byBgX3RvYCBmcm9tIGBtc2cuc2VuZGVyYAogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudAogICAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZAogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgdHJhbnNmZXIgd2FzIHN1Y2Nlc3NmdWwgb3Igbm90CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgLy8vIEBub3RpY2Ugc2VuZCBgX3ZhbHVlYCB0b2tlbiB0byBgX3RvYCBmcm9tIGBfZnJvbWAgb24gdGhlIGNvbmRpdGlvbiBpdCBpcyBhcHByb3ZlZCBieSBgX2Zyb21gCiAgICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBhZGRyZXNzIG9mIHRoZSBzZW5kZXIKICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQKICAgIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQKICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIHRyYW5zZmVyIHdhcyBzdWNjZXNzZnVsIG9yIG5vdAogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCiAgICAvLy8gQG5vdGljZSBgbXNnLnNlbmRlcmAgYXBwcm92ZXMgYF9zcGVuZGVyYCB0byBzcGVuZCBgX3ZhbHVlYCB0b2tlbnMKICAgIC8vLyBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgYWJsZSB0byB0cmFuc2ZlciB0aGUgdG9rZW5zCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBhcHByb3ZlZCBmb3IgdHJhbnNmZXIKICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIGFwcHJvdmFsIHdhcyBzdWNjZXNzZnVsIG9yIG5vdAogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCiAgICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBvd25pbmcgdG9rZW5zCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2VucwogICAgLy8vIEByZXR1cm4gQW1vdW50IG9mIHJlbWFpbmluZyB0b2tlbnMgYWxsb3dlZCB0byBzcGVudAogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZyk7CgogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKfQoKY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBUb2tlbiB7CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIGJhbGFuY2VzW190b10gKyBfdmFsdWUgPiBiYWxhbmNlc1tfdG9dKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdIC09IF92YWx1ZTsKICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7CiAgICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgaWYgKGJhbGFuY2VzW19mcm9tXSA+PSBfdmFsdWUgJiYgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIGJhbGFuY2VzW190b10gKyBfdmFsdWUgPiBiYWxhbmNlc1tfdG9dKSB7CiAgICAgICAgICAgIGJhbGFuY2VzW19mcm9tXSAtPSBfdmFsdWU7CiAgICAgICAgICAgIGJhbGFuY2VzW190b10gKz0gX3ZhbHVlOwogICAgICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICAgICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSB7IHJldHVybiBmYWxzZTsgfQogICAgfQoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwp9CgovKiBJQ2xvdWRTZWMgQ29udHJhY3QgKi8KY29udHJhY3QgSUNsb3VkU2VjVG9rZW4gaXMgb3duZWQsIFNhZmVNYXRoLCBTdGFuZGFyZFRva2VuIHsKICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICJJQ2xvdWRTZWMiOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgbmFtZSBmb3IgZGlzcGxheSBwdXJwb3NlcwogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAiQ0xPVUQiOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSBzeW1ib2wgZm9yIGRpc3BsYXkgcHVycG9zZXMKICAgIGFkZHJlc3MgcHVibGljIElDbG91ZFNlY0FkZHJlc3MgPSB0aGlzOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZHJlc3Mgb2YgdGhlIElDbG91ZFNlYyB0b2tlbgogICAgdWludDggcHVibGljIGRlY2ltYWxzID0gMDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQW1vdW50IG9mIGRlY2ltYWxzIGZvciBkaXNwbGF5IHB1cnBvc2VzCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseSA9IDIwMDAwMDAwMDAwMDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAkvLyBTZXQgdG90YWwgc3VwcGx5IG9mIElDbG91ZFNlY3MKICAgIHVpbnQyNTYgcHVibGljIGJ1eVByaWNlRXRoID0gMTAwMDAwMDAwMDAwIHdlaTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQnV5IHByaWNlIGZvciBJQ2xvdWRTZWNzCiAgICB1aW50MjU2IHB1YmxpYyBzZWxsUHJpY2VFdGggPSAxMDAwMDAwMDAwMDAgd2VpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNlbGwgcHJpY2UgZm9yIElDbG91ZFNlY3MKICAgIHVpbnQyNTYgcHVibGljIGdhc0ZvckNMT1VEID0gMSBmaW5uZXk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEV0aCBmcm9tIGNvbnRyYWN0IGFnYWluc3QgQ0xPVUQgdG8gcGF5IHR4CiAgICB1aW50MjU2IHB1YmxpYyBDTE9VREZvckdhcyA9IDEwOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDTE9VRCB0byBjb250cmFjdCBhZ2FpbnN0IGV0aCB0byBwYXkgdHgKICAgIHVpbnQyNTYgcHVibGljIGdhc1Jlc2VydmUgPSAxMCBmaW5uZXk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEV0aCBhbW91bnQgdGhhdCByZW1haW5zIGluIHRoZSBjb250cmFjdCBmb3IgZ2FzIGFuZCBjYW4ndCBiZSBzb2xkCiAgICB1aW50MjU2IHB1YmxpYyBtaW5CYWxhbmNlRm9yQWNjb3VudHMgPSAxIGZpbm5leTsgICAgICAgICAgICAgICAgICAgICAgIAkvLyBNaW5pbWFsIGV0aCBiYWxhbmNlIG9mIHNlbmRlciBhbmQgcmVjaXBpZW50CiAgICBib29sIHB1YmxpYyBkaXJlY3RUcmFkZUFsbG93ZWQgPSBmYWxzZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBIYWx0IHRyYWRpbmcgQ0xPVUQgYnkgc2VuZGluZyB0byB0aGUgY29udHJhY3QgZGlyZWN0bHkKCgovKiBJbml0aWFsaXplcyBjb250cmFjdCB3aXRoIGluaXRpYWwgc3VwcGx5IHRva2VucyB0byB0aGUgY3JlYXRvciBvZiB0aGUgY29udHJhY3QgKi8KICAgIGZ1bmN0aW9uIElDbG91ZFNlY1Rva2VuKCkgewogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gdG90YWxTdXBwbHk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2l2ZSB0aGUgY3JlYXRvciBhbGwgdG9rZW5zCiAgICB9CgoKLyogQ29uc3RydWN0b3IgcGFyYW1ldGVycyAqLwogICAgZnVuY3Rpb24gc2V0RXRoZXJQcmljZXModWludDI1NiBuZXdCdXlQcmljZUV0aCwgdWludDI1NiBuZXdTZWxsUHJpY2VFdGgpIG9ubHlPd25lciB7CiAgICAgICAgYnV5UHJpY2VFdGggPSBuZXdCdXlQcmljZUV0aDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTZXQgcHJpY2VzIHRvIGJ1eSBhbmQgc2VsbCBDTE9VRAogICAgICAgIHNlbGxQcmljZUV0aCA9IG5ld1NlbGxQcmljZUV0aDsKICAgIH0KICAgIGZ1bmN0aW9uIHNldEdhc0ZvckNMT1VEKHVpbnQgbmV3R2FzQW1vdW50SW5XZWkpIG9ubHlPd25lciB7CiAgICAgICAgZ2FzRm9yQ0xPVUQgPSBuZXdHYXNBbW91bnRJbldlaTsKICAgIH0KICAgIGZ1bmN0aW9uIHNldENMT1VERm9yR2FzKHVpbnQgbmV3Q0xPVURBbW91bnQpIG9ubHlPd25lciB7CiAgICAgICAgQ0xPVURGb3JHYXMgPSBuZXdDTE9VREFtb3VudDsKICAgIH0KICAgIGZ1bmN0aW9uIHNldEdhc1Jlc2VydmUodWludCBuZXdHYXNSZXNlcnZlSW5XZWkpIG9ubHlPd25lciB7CiAgICAgICAgZ2FzUmVzZXJ2ZSA9IG5ld0dhc1Jlc2VydmVJbldlaTsKICAgIH0KICAgIGZ1bmN0aW9uIHNldE1pbkJhbGFuY2UodWludCBtaW5pbXVtQmFsYW5jZUluV2VpKSBvbmx5T3duZXIgewogICAgICAgIG1pbkJhbGFuY2VGb3JBY2NvdW50cyA9IG1pbmltdW1CYWxhbmNlSW5XZWk7CiAgICB9CgoKLyogSGFsdHMgb3IgdW5oYWx0cyBkaXJlY3QgdHJhZGVzIHdpdGhvdXQgdGhlIHNlbGwvYnV5IGZ1bmN0aW9ucyBiZWxvdyAqLwogICAgZnVuY3Rpb24gaGFsdERpcmVjdFRyYWRlKCkgb25seU93bmVyIHsKICAgICAgICBkaXJlY3RUcmFkZUFsbG93ZWQgPSBmYWxzZTsKICAgIH0KICAgIGZ1bmN0aW9uIHVuaGFsdERpcmVjdFRyYWRlKCkgb25seU93bmVyIHsKICAgICAgICBkaXJlY3RUcmFkZUFsbG93ZWQgPSB0cnVlOwogICAgfQoKCi8qIFRyYW5zZmVyIGZ1bmN0aW9uIGV4dGVuZGVkIGJ5IGNoZWNrIG9mIGV0aCBiYWxhbmNlcyBhbmQgcGF5IHRyYW5zYWN0aW9uIGNvc3RzIHdpdGggQ0xPVUQgaWYgbm90IGVub3VnaCBldGggKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgaWYgKF92YWx1ZSA8IENMT1VERm9yR2FzKSB0aHJvdzsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFByZXZlbnRzIGRyYWluIGFuZCBzcGFtCiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIgJiYgX3RvID09IElDbG91ZFNlY0FkZHJlc3MgJiYgZGlyZWN0VHJhZGVBbGxvd2VkKSB7CiAgICAgICAgICAgIHNlbGxJQ2xvdWRTZWNzQWdhaW5zdEV0aGVyKF92YWx1ZSk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUcmFkZSBJQ2xvdWRTZWNzIGFnYWluc3QgZXRoIGJ5IHNlbmRpbmcgdG8gdGhlIHRva2VuIGNvbnRyYWN0CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBiYWxhbmNlc1tfdG9dICsgX3ZhbHVlID4gYmFsYW5jZXNbX3RvXSkgeyAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHNlbmRlciBoYXMgZW5vdWdoIGFuZCBmb3Igb3ZlcmZsb3dzCiAgICAgICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gc2FmZVN1YihiYWxhbmNlc1ttc2cuc2VuZGVyXSwgX3ZhbHVlKTsgICAvLyBTdWJ0cmFjdCBDTE9VRCBmcm9tIHRoZSBzZW5kZXIKCiAgICAgICAgICAgIGlmIChtc2cuc2VuZGVyLmJhbGFuY2UgPj0gbWluQmFsYW5jZUZvckFjY291bnRzICYmIF90by5iYWxhbmNlID49IG1pbkJhbGFuY2VGb3JBY2NvdW50cykgeyAgICAvLyBDaGVjayBpZiBzZW5kZXIgY2FuIHBheSBnYXMgYW5kIGlmIHJlY2lwaWVudCBjb3VsZAogICAgICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSA9IHNhZmVBZGQoYmFsYW5jZXNbX3RvXSwgX3ZhbHVlKTsgICAgICAgICAgICAgLy8gQWRkIHRoZSBzYW1lIGFtb3VudCBvZiBDTE9VRCB0byB0aGUgcmVjaXBpZW50CiAgICAgICAgICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7ICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RpZnkgYW55b25lIGxpc3RlbmluZyB0aGF0IHRoaXMgdHJhbnNmZXIgdG9vayBwbGFjZQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBiYWxhbmNlc1t0aGlzXSA9IHNhZmVBZGQoYmFsYW5jZXNbdGhpc10sIENMT1VERm9yR2FzKTsgICAgICAgIC8vIFBheSBDTE9VREZvckdhcyB0byB0aGUgY29udHJhY3QKICAgICAgICAgICAgICAgIGJhbGFuY2VzW190b10gPSBzYWZlQWRkKGJhbGFuY2VzW190b10sIHNhZmVTdWIoX3ZhbHVlLCBDTE9VREZvckdhcykpOyAgLy8gUmVjaXBpZW50IGJhbGFuY2UgLUNMT1VERm9yR2FzCiAgICAgICAgICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIHNhZmVTdWIoX3ZhbHVlLCBDTE9VREZvckdhcykpOyAgICAgIC8vIE5vdGlmeSBhbnlvbmUgbGlzdGVuaW5nIHRoYXQgdGhpcyB0cmFuc2ZlciB0b29rIHBsYWNlCgogICAgICAgICAgICAgICAgaWYobXNnLnNlbmRlci5iYWxhbmNlIDwgbWluQmFsYW5jZUZvckFjY291bnRzKSB7CiAgICAgICAgICAgICAgICAgICAgaWYoIW1zZy5zZW5kZXIuc2VuZChnYXNGb3JDTE9VRCkpIHRocm93OyAgICAgICAgICAgICAgICAgIC8vIFNlbmQgZXRoIHRvIHNlbmRlcgogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZihfdG8uYmFsYW5jZSA8IG1pbkJhbGFuY2VGb3JBY2NvdW50cykgewogICAgICAgICAgICAgICAgICAgIGlmKCFfdG8uc2VuZChnYXNGb3JDTE9VRCkpIHRocm93OyAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTZW5kIGV0aCB0byByZWNpcGllbnQKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7IHRocm93OyB9CiAgICB9CgoKLyogVXNlciBidXlzIElDbG91ZFNlY3MgYW5kIHBheXMgaW4gRXRoZXIgKi8KICAgIGZ1bmN0aW9uIGJ1eUlDbG91ZFNlY3NBZ2FpbnN0RXRoZXIoKSBwYXlhYmxlIHJldHVybnMgKHVpbnQgYW1vdW50KSB7CiAgICAgICAgaWYgKGJ1eVByaWNlRXRoID09IDAgfHwgbXNnLnZhbHVlIDwgYnV5UHJpY2VFdGgpIHRocm93OyAgICAgICAgICAgICAvLyBBdm9pZCBkaXZpZGluZyAwLCBzZW5kaW5nIHNtYWxsIGFtb3VudHMgYW5kIHNwYW0KICAgICAgICBhbW91bnQgPSBtc2cudmFsdWUgLyBidXlQcmljZUV0aDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSB0aGUgYW1vdW50IG9mIElDbG91ZFNlY3MKICAgICAgICBpZiAoYmFsYW5jZXNbdGhpc10gPCBhbW91bnQpIHRocm93OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGl0IGhhcyBlbm91Z2ggdG8gc2VsbAogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gc2FmZUFkZChiYWxhbmNlc1ttc2cuc2VuZGVyXSwgYW1vdW50KTsgICAgICAgLy8gQWRkIHRoZSBhbW91bnQgdG8gYnV5ZXIncyBiYWxhbmNlCiAgICAgICAgYmFsYW5jZXNbdGhpc10gPSBzYWZlU3ViKGJhbGFuY2VzW3RoaXNdLCBhbW91bnQpOyAgICAgICAgICAgICAgICAgICAvLyBTdWJ0cmFjdCBhbW91bnQgZnJvbSBJQ2xvdWRTZWMgYmFsYW5jZQogICAgICAgIFRyYW5zZmVyKHRoaXMsIG1zZy5zZW5kZXIsIGFtb3VudCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRXhlY3V0ZSBhbiBldmVudCByZWZsZWN0aW5nIHRoZSBjaGFuZ2UKICAgICAgICByZXR1cm4gYW1vdW50OwogICAgfQoKCi8qIFVzZXIgc2VsbHMgSUNsb3VkU2VjcyBhbmQgZ2V0cyBFdGhlciAqLwogICAgZnVuY3Rpb24gc2VsbElDbG91ZFNlY3NBZ2FpbnN0RXRoZXIodWludDI1NiBhbW91bnQpIHJldHVybnMgKHVpbnQgcmV2ZW51ZSkgewogICAgICAgIGlmIChzZWxsUHJpY2VFdGggPT0gMCB8fCBhbW91bnQgPCBDTE9VREZvckdhcykgdGhyb3c7ICAgICAgICAgICAgICAgICAvLyBBdm9pZCBzZWxsaW5nIGFuZCBzcGFtCiAgICAgICAgaWYgKGJhbGFuY2VzW21zZy5zZW5kZXJdIDwgYW1vdW50KSB0aHJvdzsgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgc2VuZGVyIGhhcyBlbm91Z2ggdG8gc2VsbAogICAgICAgIHJldmVudWUgPSBzYWZlTXVsKGFtb3VudCwgc2VsbFByaWNlRXRoKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmV2ZW51ZSA9IGV0aCB0aGF0IHdpbGwgYmUgc2VuZCB0byB0aGUgdXNlcgogICAgICAgIGlmIChzYWZlU3ViKHRoaXMuYmFsYW5jZSwgcmV2ZW51ZSkgPCBnYXNSZXNlcnZlKSB0aHJvdzsgICAgICAgICAgICAgLy8gS2VlcCBtaW4gYW1vdW50IG9mIGV0aCBpbiBjb250cmFjdCB0byBwcm92aWRlIGdhcyBmb3IgdHJhbnNhY3Rpb25zCiAgICAgICAgaWYgKCFtc2cuc2VuZGVyLnNlbmQocmV2ZW51ZSkpIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTZW5kIGV0aGVyIHRvIHRoZSBzZWxsZXIuIEl0J3MgaW1wb3J0YW50CiAgICAgICAgICAgIHRocm93OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUbyBkbyB0aGlzIGxhc3QgdG8gYXZvaWQgcmVjdXJzaW9uIGF0dGFja3MKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBiYWxhbmNlc1t0aGlzXSA9IHNhZmVBZGQoYmFsYW5jZXNbdGhpc10sIGFtb3VudCk7ICAgICAgICAgICAgICAgLy8gQWRkIHRoZSBhbW91bnQgdG8gSUNsb3VkU2VjIGJhbGFuY2UKICAgICAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBzYWZlU3ViKGJhbGFuY2VzW21zZy5zZW5kZXJdLCBhbW91bnQpOyAgIC8vIFN1YnRyYWN0IHRoZSBhbW91bnQgZnJvbSBzZWxsZXIncyBiYWxhbmNlCiAgICAgICAgICAgIFRyYW5zZmVyKHRoaXMsIG1zZy5zZW5kZXIsIHJldmVudWUpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBFeGVjdXRlIGFuIGV2ZW50IHJlZmxlY3Rpbmcgb24gdGhlIGNoYW5nZQogICAgICAgICAgICByZXR1cm4gcmV2ZW51ZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRW5kIGZ1bmN0aW9uIGFuZCByZXR1cm5zCiAgICAgICAgfQogICAgfQoKCi8qIHJlZnVuZCB0byBvd25lciAqLwogICAgZnVuY3Rpb24gcmVmdW5kVG9Pd25lciAodWludDI1NiBhbW91bnRPZkV0aCwgdWludDI1NiBDTE9VRCkgb25seU93bmVyIHsKICAgICAgICB1aW50MjU2IGV0aCA9IHNhZmVNdWwoYW1vdW50T2ZFdGgsIDEgZXRoZXIpOwogICAgICAgIGlmICghbXNnLnNlbmRlci5zZW5kKGV0aCkpIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2VuZCBldGhlciB0byB0aGUgb3duZXIuIEl0J3MgaW1wb3J0YW50CiAgICAgICAgICAgIHRocm93OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUbyBkbyB0aGlzIGxhc3QgdG8gYXZvaWQgcmVjdXJzaW9uIGF0dGFja3MKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBUcmFuc2Zlcih0aGlzLCBtc2cuc2VuZGVyLCBldGgpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRXhlY3V0ZSBhbiBldmVudCByZWZsZWN0aW5nIG9uIHRoZSBjaGFuZ2UKICAgICAgICB9CiAgICAgICAgaWYgKGJhbGFuY2VzW3RoaXNdIDwgQ0xPVUQpIHRocm93OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGl0IGhhcyBlbm91Z2ggdG8gc2VsbAogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gc2FmZUFkZChiYWxhbmNlc1ttc2cuc2VuZGVyXSwgQ0xPVUQpOyAgICAgICAgICAvLyBBZGQgdGhlIGFtb3VudCB0byBidXllcidzIGJhbGFuY2UKICAgICAgICBiYWxhbmNlc1t0aGlzXSA9IHNhZmVTdWIoYmFsYW5jZXNbdGhpc10sIENMT1VEKTsgICAgICAgICAgICAgICAgICAgICAgLy8gU3VidHJhY3QgYW1vdW50IGZyb20gc2VsbGVyJ3MgYmFsYW5jZQogICAgICAgIFRyYW5zZmVyKHRoaXMsIG1zZy5zZW5kZXIsIENMT1VEKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBFeGVjdXRlIGFuIGV2ZW50IHJlZmxlY3RpbmcgdGhlIGNoYW5nZQogICAgfQoKCi8qIFRoaXMgdW5uYW1lZCBmdW5jdGlvbiBpcyBjYWxsZWQgd2hlbmV2ZXIgc29tZW9uZSB0cmllcyB0byBzZW5kIGV0aGVyIHRvIGl0IGFuZCBwb3NzaWJseSBzZWxscyBJQ2xvdWRTZWNzICovCiAgICBmdW5jdGlvbigpIHBheWFibGUgewogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IG93bmVyKSB7CiAgICAgICAgICAgIGlmICghZGlyZWN0VHJhZGVBbGxvd2VkKSB0aHJvdzsKICAgICAgICAgICAgYnV5SUNsb3VkU2Vjc0FnYWluc3RFdGhlcigpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFsbG93IGRpcmVjdCB0cmFkZXMgYnkgc2VuZGluZyBldGggdG8gdGhlIGNvbnRyYWN0CiAgICAgICAgfQogICAgfQp9'.
	

]
