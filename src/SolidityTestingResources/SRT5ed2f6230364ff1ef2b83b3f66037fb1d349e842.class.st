Class {
	#name : #SRT5ed2f6230364ff1ef2b83b3f66037fb1d349e842,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT5ed2f6230364ff1ef2b83b3f66037fb1d349e842 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CgovKgogICAgVXRpbGl0aWVzICYgQ29tbW9uIE1vZGlmaWVycwoqLwpjb250cmFjdCBVdGlscyB7CiAgICAvKioKICAgICAgICBjb25zdHJ1Y3RvcgogICAgKi8KICAgIGZ1bmN0aW9uIFV0aWxzKCkgewogICAgfQoKICAgIC8vIHZlcmlmaWVzIHRoYXQgYW4gYW1vdW50IGlzIGdyZWF0ZXIgdGhhbiB6ZXJvCiAgICBtb2RpZmllciBncmVhdGVyVGhhblplcm8odWludDI1NiBfYW1vdW50KSB7CiAgICAgICAgcmVxdWlyZShfYW1vdW50ID4gMCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLyB2YWxpZGF0ZXMgYW4gYWRkcmVzcyAtIGN1cnJlbnRseSBvbmx5IGNoZWNrcyB0aGF0IGl0IGlzbid0IG51bGwKICAgIG1vZGlmaWVyIHZhbGlkQWRkcmVzcyhhZGRyZXNzIF9hZGRyZXNzKSB7CiAgICAgICAgcmVxdWlyZShfYWRkcmVzcyAhPSAweDApOwogICAgICAgIF87CiAgICB9CgogICAgLy8gdmVyaWZpZXMgdGhhdCB0aGUgYWRkcmVzcyBpcyBkaWZmZXJlbnQgdGhhbiB0aGlzIGNvbnRyYWN0IGFkZHJlc3MKICAgIG1vZGlmaWVyIG5vdFRoaXMoYWRkcmVzcyBfYWRkcmVzcykgewogICAgICAgIHJlcXVpcmUoX2FkZHJlc3MgIT0gYWRkcmVzcyh0aGlzKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLyBPdmVyZmxvdyBwcm90ZWN0ZWQgbWF0aCBmdW5jdGlvbnMKCiAgICAvKioKICAgICAgICBAZGV2IHJldHVybnMgdGhlIHN1bSBvZiBfeCBhbmQgX3ksIGFzc2VydHMgaWYgdGhlIGNhbGN1bGF0aW9uIG92ZXJmbG93cwoKICAgICAgICBAcGFyYW0gX3ggICB2YWx1ZSAxCiAgICAgICAgQHBhcmFtIF95ICAgdmFsdWUgMgoKICAgICAgICBAcmV0dXJuIHN1bQogICAgKi8KICAgIGZ1bmN0aW9uIHNhZmVBZGQodWludDI1NiBfeCwgdWludDI1NiBfeSkgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgeiA9IF94ICsgX3k7CiAgICAgICAgYXNzZXJ0KHogPj0gX3gpOwogICAgICAgIHJldHVybiB6OwogICAgfQoKICAgIC8qKgogICAgICAgIEBkZXYgcmV0dXJucyB0aGUgZGlmZmVyZW5jZSBvZiBfeCBtaW51cyBfeSwgYXNzZXJ0cyBpZiB0aGUgc3VidHJhY3Rpb24gcmVzdWx0cyBpbiBhIG5lZ2F0aXZlIG51bWJlcgoKICAgICAgICBAcGFyYW0gX3ggICBtaW51ZW5kCiAgICAgICAgQHBhcmFtIF95ICAgc3VidHJhaGVuZAoKICAgICAgICBAcmV0dXJuIGRpZmZlcmVuY2UKICAgICovCiAgICBmdW5jdGlvbiBzYWZlU3ViKHVpbnQyNTYgX3gsIHVpbnQyNTYgX3kpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoX3ggPj0gX3kpOwogICAgICAgIHJldHVybiBfeCAtIF95OwogICAgfQoKICAgIC8qKgogICAgICAgIEBkZXYgcmV0dXJucyB0aGUgcHJvZHVjdCBvZiBtdWx0aXBseWluZyBfeCBieSBfeSwgYXNzZXJ0cyBpZiB0aGUgY2FsY3VsYXRpb24gb3ZlcmZsb3dzCgogICAgICAgIEBwYXJhbSBfeCAgIGZhY3RvciAxCiAgICAgICAgQHBhcmFtIF95ICAgZmFjdG9yIDIKCiAgICAgICAgQHJldHVybiBwcm9kdWN0CiAgICAqLwogICAgZnVuY3Rpb24gc2FmZU11bCh1aW50MjU2IF94LCB1aW50MjU2IF95KSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiB6ID0gX3ggKiBfeTsKICAgICAgICBhc3NlcnQoX3ggPT0gMCB8fCB6IC8gX3ggPT0gX3kpOwogICAgICAgIHJldHVybiB6OwogICAgfQp9CgoKCi8qCiAgICBPd25lZCBjb250cmFjdCBpbnRlcmZhY2UKKi8KY29udHJhY3QgSU93bmVkIHsKICAgIC8vIHRoaXMgZnVuY3Rpb24gaXNuJ3QgYWJzdHJhY3Qgc2luY2UgdGhlIGNvbXBpbGVyIGVtaXRzIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGVkIGdldHRlciBmdW5jdGlvbnMgYXMgZXh0ZXJuYWwKICAgIGZ1bmN0aW9uIG93bmVyKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MpIHt9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBfbmV3T3duZXIpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGFjY2VwdE93bmVyc2hpcCgpIHB1YmxpYzsKfQoKCi8qCiAgICBQcm92aWRlcyBzdXBwb3J0IGFuZCB1dGlsaXRpZXMgZm9yIGNvbnRyYWN0IG93bmVyc2hpcAoqLwpjb250cmFjdCBPd25lZCBpcyBJT3duZWQgewogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICBhZGRyZXNzIHB1YmxpYyBuZXdPd25lcjsKCiAgICBldmVudCBPd25lclVwZGF0ZShhZGRyZXNzIF9wcmV2T3duZXIsIGFkZHJlc3MgX25ld093bmVyKTsKCiAgICAvKioKICAgICAgICBAZGV2IGNvbnN0cnVjdG9yCiAgICAqLwogICAgZnVuY3Rpb24gT3duZWQoKSB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIC8vIGFsbG93cyBleGVjdXRpb24gYnkgdGhlIG93bmVyIG9ubHkKICAgIG1vZGlmaWVyIG93bmVyT25seSB7CiAgICAgICAgYXNzZXJ0KG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAgICAgQGRldiBhbGxvd3MgdHJhbnNmZXJyaW5nIHRoZSBjb250cmFjdCBvd25lcnNoaXAKICAgICAgICB0aGUgbmV3IG93bmVyIHN0aWxsIG5lZWRzIHRvIGFjY2VwdCB0aGUgdHJhbnNmZXIKICAgICAgICBjYW4gb25seSBiZSBjYWxsZWQgYnkgdGhlIGNvbnRyYWN0IG93bmVyCgogICAgICAgIEBwYXJhbSBfbmV3T3duZXIgICAgbmV3IGNvbnRyYWN0IG93bmVyCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBfbmV3T3duZXIpIHB1YmxpYyBvd25lck9ubHkgewogICAgICAgIHJlcXVpcmUoX25ld093bmVyICE9IG93bmVyKTsKICAgICAgICBuZXdPd25lciA9IF9uZXdPd25lcjsKICAgIH0KCiAgICAvKioKICAgICAgICBAZGV2IHVzZWQgYnkgYSBuZXcgb3duZXIgdG8gYWNjZXB0IGFuIG93bmVyc2hpcCB0cmFuc2ZlcgogICAgKi8KICAgIGZ1bmN0aW9uIGFjY2VwdE93bmVyc2hpcCgpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG5ld093bmVyKTsKICAgICAgICBPd25lclVwZGF0ZShvd25lciwgbmV3T3duZXIpOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICAgICAgbmV3T3duZXIgPSAweDA7CiAgICB9Cn0KCgoKLyoKICAgIEVSQzIwIFN0YW5kYXJkIFRva2VuIGludGVyZmFjZQoqLwpjb250cmFjdCBJRVJDMjBUb2tlbiB7CiAgICAvLyB0aGVzZSBmdW5jdGlvbnMgYXJlbid0IGFic3RyYWN0IHNpbmNlIHRoZSBjb21waWxlciBlbWl0cyBhdXRvbWF0aWNhbGx5IGdlbmVyYXRlZCBnZXR0ZXIgZnVuY3Rpb25zIGFzIGV4dGVybmFsCiAgICBmdW5jdGlvbiBuYW1lKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHN0cmluZykge30KICAgIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChzdHJpbmcpIHt9CiAgICBmdW5jdGlvbiBkZWNpbWFscygpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50OCkge30KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHt9CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7IF9vd25lcjsgfQogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgeyBfb3duZXI7IF9zcGVuZGVyOyB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7Cn0KCgovKgogICAgVG9rZW4gSG9sZGVyIGludGVyZmFjZQoqLwpjb250cmFjdCBJVG9rZW5Ib2xkZXIgaXMgSU93bmVkIHsKICAgIGZ1bmN0aW9uIHdpdGhkcmF3VG9rZW5zKElFUkMyMFRva2VuIF90b2tlbiwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgcHVibGljOwp9CgoKLyoKICAgIFdlIGNvbnNpZGVyIGV2ZXJ5IGNvbnRyYWN0IHRvIGJlIGEgJ3Rva2VuIGhvbGRlcicgc2luY2UgaXQncyBjdXJyZW50bHkgbm90IHBvc3NpYmxlCiAgICBmb3IgYSBjb250cmFjdCB0byBkZW55IHJlY2VpdmluZyB0b2tlbnMuCgogICAgVGhlIFRva2VuSG9sZGVyJ3MgY29udHJhY3Qgc29sZSBwdXJwb3NlIGlzIHRvIHByb3ZpZGUgYSBzYWZldHkgbWVjaGFuaXNtIHRoYXQgYWxsb3dzCiAgICB0aGUgb3duZXIgdG8gc2VuZCB0b2tlbnMgdGhhdCB3ZXJlIHNlbnQgdG8gdGhlIGNvbnRyYWN0IGJ5IG1pc3Rha2UgYmFjayB0byB0aGVpciBzZW5kZXIuCiovCmNvbnRyYWN0IFRva2VuSG9sZGVyIGlzIElUb2tlbkhvbGRlciwgT3duZWQsIFV0aWxzIHsKICAgIC8qKgogICAgICAgIEBkZXYgY29uc3RydWN0b3IKICAgICovCiAgICBmdW5jdGlvbiBUb2tlbkhvbGRlcigpIHsKICAgIH0KCiAgICAvKioKICAgICAgICBAZGV2IHdpdGhkcmF3cyB0b2tlbnMgaGVsZCBieSB0aGUgY29udHJhY3QgYW5kIHNlbmRzIHRoZW0gdG8gYW4gYWNjb3VudAogICAgICAgIGNhbiBvbmx5IGJlIGNhbGxlZCBieSB0aGUgb3duZXIKCiAgICAgICAgQHBhcmFtIF90b2tlbiAgIEVSQzIwIHRva2VuIGNvbnRyYWN0IGFkZHJlc3MKICAgICAgICBAcGFyYW0gX3RvICAgICAgYWNjb3VudCB0byByZWNlaXZlIHRoZSBuZXcgYW1vdW50CiAgICAgICAgQHBhcmFtIF9hbW91bnQgIGFtb3VudCB0byB3aXRoZHJhdwogICAgKi8KICAgIGZ1bmN0aW9uIHdpdGhkcmF3VG9rZW5zKElFUkMyMFRva2VuIF90b2tlbiwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkKICAgICAgICBwdWJsaWMKICAgICAgICBvd25lck9ubHkKICAgICAgICB2YWxpZEFkZHJlc3MoX3Rva2VuKQogICAgICAgIHZhbGlkQWRkcmVzcyhfdG8pCiAgICAgICAgbm90VGhpcyhfdG8pCiAgICB7CiAgICAgICAgYXNzZXJ0KF90b2tlbi50cmFuc2ZlcihfdG8sIF9hbW91bnQpKTsKICAgIH0KfQoKCgoKCi8qCiAgICBTbWFydCBUb2tlbiBpbnRlcmZhY2UKKi8KY29udHJhY3QgSVNtYXJ0VG9rZW4gaXMgSU93bmVkLCBJRVJDMjBUb2tlbiB7CiAgICBmdW5jdGlvbiBkaXNhYmxlVHJhbnNmZXJzKGJvb2wgX2Rpc2FibGUpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGlzc3VlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGRlc3Ryb3koYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfYW1vdW50KSBwdWJsaWM7Cn0KCgovKgogICAgVGhlIHNtYXJ0IHRva2VuIGNvbnRyb2xsZXIgaXMgYW4gdXBncmFkYWJsZSBwYXJ0IG9mIHRoZSBzbWFydCB0b2tlbiB0aGF0IGFsbG93cwogICAgbW9yZSBmdW5jdGlvbmFsaXR5IGFzIHdlbGwgYXMgZml4ZXMgZm9yIGJ1Z3MvZXhwbG9pdHMuCiAgICBPbmNlIGl0IGFjY2VwdHMgb3duZXJzaGlwIG9mIHRoZSB0b2tlbiwgaXQgYmVjb21lcyB0aGUgdG9rZW4ncyBzb2xlIGNvbnRyb2xsZXIKICAgIHRoYXQgY2FuIGV4ZWN1dGUgYW55IG9mIGl0cyBmdW5jdGlvbnMuCgogICAgVG8gdXBncmFkZSB0aGUgY29udHJvbGxlciwgb3duZXJzaGlwIG11c3QgYmUgdHJhbnNmZXJyZWQgdG8gYSBuZXcgY29udHJvbGxlciwgYWxvbmcgd2l0aAogICAgYW55IHJlbGV2YW50IGRhdGEuCgogICAgVGhlIHNtYXJ0IHRva2VuIG11c3QgYmUgc2V0IG9uIGNvbnN0cnVjdGlvbiBhbmQgY2Fubm90IGJlIGNoYW5nZWQgYWZ0ZXJ3YXJkcy4KICAgIFdyYXBwZXJzIGFyZSBwcm92aWRlZCAoYXMgb3Bwb3NlZCB0byBhIHNpbmdsZSAnZXhlY3V0ZScgZnVuY3Rpb24pIGZvciBlYWNoIG9mIHRoZSB0b2tlbidzIGZ1bmN0aW9ucywgZm9yIGVhc2llciBhY2Nlc3MuCgogICAgTm90ZSB0aGF0IHRoZSBjb250cm9sbGVyIGNhbiB0cmFuc2ZlciB0b2tlbiBvd25lcnNoaXAgdG8gYSBuZXcgY29udHJvbGxlciB0aGF0CiAgICBkb2Vzbid0IGFsbG93IGV4ZWN1dGluZyBhbnkgZnVuY3Rpb24gb24gdGhlIHRva2VuLCBmb3IgYSB0cnVzdGxlc3Mgc29sdXRpb24uCiAgICBEb2luZyB0aGF0IHdpbGwgYWxzbyByZW1vdmUgdGhlIG93bmVyJ3MgYWJpbGl0eSB0byB1cGdyYWRlIHRoZSBjb250cm9sbGVyLgoqLwpjb250cmFjdCBTbWFydFRva2VuQ29udHJvbGxlciBpcyBUb2tlbkhvbGRlciB7CiAgICBJU21hcnRUb2tlbiBwdWJsaWMgdG9rZW47ICAgLy8gc21hcnQgdG9rZW4KCiAgICAvKioKICAgICAgICBAZGV2IGNvbnN0cnVjdG9yCiAgICAqLwogICAgZnVuY3Rpb24gU21hcnRUb2tlbkNvbnRyb2xsZXIoSVNtYXJ0VG9rZW4gX3Rva2VuKQogICAgICAgIHZhbGlkQWRkcmVzcyhfdG9rZW4pCiAgICB7CiAgICAgICAgdG9rZW4gPSBfdG9rZW47CiAgICB9CgogICAgLy8gZW5zdXJlcyB0aGF0IHRoZSBjb250cm9sbGVyIGlzIHRoZSB0b2tlbidzIG93bmVyCiAgICBtb2RpZmllciBhY3RpdmUoKSB7CiAgICAgICAgYXNzZXJ0KHRva2VuLm93bmVyKCkgPT0gYWRkcmVzcyh0aGlzKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLyBlbnN1cmVzIHRoYXQgdGhlIGNvbnRyb2xsZXIgaXMgbm90IHRoZSB0b2tlbidzIG93bmVyCiAgICBtb2RpZmllciBpbmFjdGl2ZSgpIHsKICAgICAgICBhc3NlcnQodG9rZW4ub3duZXIoKSAhPSBhZGRyZXNzKHRoaXMpKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICAgIEBkZXYgYWxsb3dzIHRyYW5zZmVycmluZyB0aGUgdG9rZW4gb3duZXJzaGlwCiAgICAgICAgdGhlIG5ldyBvd25lciBzdGlsbCBuZWVkIHRvIGFjY2VwdCB0aGUgdHJhbnNmZXIKICAgICAgICBjYW4gb25seSBiZSBjYWxsZWQgYnkgdGhlIGNvbnRyYWN0IG93bmVyCgogICAgICAgIEBwYXJhbSBfbmV3T3duZXIgICAgbmV3IHRva2VuIG93bmVyCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJUb2tlbk93bmVyc2hpcChhZGRyZXNzIF9uZXdPd25lcikgcHVibGljIG93bmVyT25seSB7CiAgICAgICAgdG9rZW4udHJhbnNmZXJPd25lcnNoaXAoX25ld093bmVyKTsKICAgIH0KCiAgICAvKioKICAgICAgICBAZGV2IHVzZWQgYnkgYSBuZXcgb3duZXIgdG8gYWNjZXB0IGEgdG9rZW4gb3duZXJzaGlwIHRyYW5zZmVyCiAgICAgICAgY2FuIG9ubHkgYmUgY2FsbGVkIGJ5IHRoZSBjb250cmFjdCBvd25lcgogICAgKi8KICAgIGZ1bmN0aW9uIGFjY2VwdFRva2VuT3duZXJzaGlwKCkgcHVibGljIG93bmVyT25seSB7CiAgICAgICAgdG9rZW4uYWNjZXB0T3duZXJzaGlwKCk7CiAgICB9CgogICAgLyoqCiAgICAgICAgQGRldiBkaXNhYmxlcy9lbmFibGVzIHRva2VuIHRyYW5zZmVycwogICAgICAgIGNhbiBvbmx5IGJlIGNhbGxlZCBieSB0aGUgY29udHJhY3Qgb3duZXIKCiAgICAgICAgQHBhcmFtIF9kaXNhYmxlICAgIHRydWUgdG8gZGlzYWJsZSB0cmFuc2ZlcnMsIGZhbHNlIHRvIGVuYWJsZSB0aGVtCiAgICAqLwogICAgZnVuY3Rpb24gZGlzYWJsZVRva2VuVHJhbnNmZXJzKGJvb2wgX2Rpc2FibGUpIHB1YmxpYyBvd25lck9ubHkgewogICAgICAgIHRva2VuLmRpc2FibGVUcmFuc2ZlcnMoX2Rpc2FibGUpOwogICAgfQoKICAgIC8qKgogICAgICAgIEBkZXYgd2l0aGRyYXdzIHRva2VucyBoZWxkIGJ5IHRoZSB0b2tlbiBhbmQgc2VuZHMgdGhlbSB0byBhbiBhY2NvdW50CiAgICAgICAgY2FuIG9ubHkgYmUgY2FsbGVkIGJ5IHRoZSBvd25lcgoKICAgICAgICBAcGFyYW0gX3Rva2VuICAgRVJDMjAgdG9rZW4gY29udHJhY3QgYWRkcmVzcwogICAgICAgIEBwYXJhbSBfdG8gICAgICBhY2NvdW50IHRvIHJlY2VpdmUgdGhlIG5ldyBhbW91bnQKICAgICAgICBAcGFyYW0gX2Ftb3VudCAgYW1vdW50IHRvIHdpdGhkcmF3CiAgICAqLwogICAgZnVuY3Rpb24gd2l0aGRyYXdGcm9tVG9rZW4oSUVSQzIwVG9rZW4gX3Rva2VuLCBhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBwdWJsaWMgb3duZXJPbmx5IHsKICAgICAgICBJVG9rZW5Ib2xkZXIodG9rZW4pLndpdGhkcmF3VG9rZW5zKF90b2tlbiwgX3RvLCBfYW1vdW50KTsKICAgIH0KfQoKCi8qCiAgICBQcm92aWRlcyBzdXBwb3J0IGFuZCB1dGlsaXRpZXMgZm9yIGNvbnRyYWN0IG1hbmFnZW1lbnQKKi8KY29udHJhY3QgTWFuYWdlZCB7CiAgICBhZGRyZXNzIHB1YmxpYyBtYW5hZ2VyOwogICAgYWRkcmVzcyBwdWJsaWMgbmV3TWFuYWdlcjsKCiAgICBldmVudCBNYW5hZ2VyVXBkYXRlKGFkZHJlc3MgX3ByZXZNYW5hZ2VyLCBhZGRyZXNzIF9uZXdNYW5hZ2VyKTsKCiAgICAvKioKICAgICAgICBAZGV2IGNvbnN0cnVjdG9yCiAgICAqLwogICAgZnVuY3Rpb24gTWFuYWdlZCgpIHsKICAgICAgICBtYW5hZ2VyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICAvLyBhbGxvd3MgZXhlY3V0aW9uIGJ5IHRoZSBtYW5hZ2VyIG9ubHkKICAgIG1vZGlmaWVyIG1hbmFnZXJPbmx5IHsKICAgICAgICBhc3NlcnQobXNnLnNlbmRlciA9PSBtYW5hZ2VyKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICAgIEBkZXYgYWxsb3dzIHRyYW5zZmVycmluZyB0aGUgY29udHJhY3QgbWFuYWdlbWVudAogICAgICAgIHRoZSBuZXcgbWFuYWdlciBzdGlsbCBuZWVkcyB0byBhY2NlcHQgdGhlIHRyYW5zZmVyCiAgICAgICAgY2FuIG9ubHkgYmUgY2FsbGVkIGJ5IHRoZSBjb250cmFjdCBtYW5hZ2VyCgogICAgICAgIEBwYXJhbSBfbmV3TWFuYWdlciAgICBuZXcgY29udHJhY3QgbWFuYWdlcgogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyTWFuYWdlbWVudChhZGRyZXNzIF9uZXdNYW5hZ2VyKSBwdWJsaWMgbWFuYWdlck9ubHkgewogICAgICAgIHJlcXVpcmUoX25ld01hbmFnZXIgIT0gbWFuYWdlcik7CiAgICAgICAgbmV3TWFuYWdlciA9IF9uZXdNYW5hZ2VyOwogICAgfQoKICAgIC8qKgogICAgICAgIEBkZXYgdXNlZCBieSBhIG5ldyBtYW5hZ2VyIHRvIGFjY2VwdCBhIG1hbmFnZW1lbnQgdHJhbnNmZXIKICAgICovCiAgICBmdW5jdGlvbiBhY2NlcHRNYW5hZ2VtZW50KCkgcHVibGljIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gbmV3TWFuYWdlcik7CiAgICAgICAgTWFuYWdlclVwZGF0ZShtYW5hZ2VyLCBuZXdNYW5hZ2VyKTsKICAgICAgICBtYW5hZ2VyID0gbmV3TWFuYWdlcjsKICAgICAgICBuZXdNYW5hZ2VyID0gMHgwOwogICAgfQp9CgoKLyoKICAgIEVJUDIyOCBUb2tlbiBDb252ZXJ0ZXIgaW50ZXJmYWNlCiovCmNvbnRyYWN0IElUb2tlbkNvbnZlcnRlciB7CiAgICBmdW5jdGlvbiBjb252ZXJ0aWJsZVRva2VuQ291bnQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDE2KTsKICAgIGZ1bmN0aW9uIGNvbnZlcnRpYmxlVG9rZW4odWludDE2IF90b2tlbkluZGV4KSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcyk7CiAgICBmdW5jdGlvbiBnZXRSZXR1cm4oSUVSQzIwVG9rZW4gX2Zyb21Ub2tlbiwgSUVSQzIwVG9rZW4gX3RvVG9rZW4sIHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gY29udmVydChJRVJDMjBUb2tlbiBfZnJvbVRva2VuLCBJRVJDMjBUb2tlbiBfdG9Ub2tlbiwgdWludDI1NiBfYW1vdW50LCB1aW50MjU2IF9taW5SZXR1cm4pIHB1YmxpYyByZXR1cm5zICh1aW50MjU2KTsKICAgIC8vIGRlcHJlY2F0ZWQsIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkKICAgIGZ1bmN0aW9uIGNoYW5nZShJRVJDMjBUb2tlbiBfZnJvbVRva2VuLCBJRVJDMjBUb2tlbiBfdG9Ub2tlbiwgdWludDI1NiBfYW1vdW50LCB1aW50MjU2IF9taW5SZXR1cm4pIHB1YmxpYyByZXR1cm5zICh1aW50MjU2KTsKfQoKCi8qCiAgICBCYW5jb3IgRm9ybXVsYSBpbnRlcmZhY2UKKi8KY29udHJhY3QgSUJhbmNvckZvcm11bGEgewogICAgZnVuY3Rpb24gY2FsY3VsYXRlUHVyY2hhc2VSZXR1cm4odWludDI1NiBfc3VwcGx5LCB1aW50MjU2IF9jb25uZWN0b3JCYWxhbmNlLCB1aW50MzIgX2Nvbm5lY3RvcldlaWdodCwgdWludDI1NiBfZGVwb3NpdEFtb3VudCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gY2FsY3VsYXRlU2FsZVJldHVybih1aW50MjU2IF9zdXBwbHksIHVpbnQyNTYgX2Nvbm5lY3RvckJhbGFuY2UsIHVpbnQzMiBfY29ubmVjdG9yV2VpZ2h0LCB1aW50MjU2IF9zZWxsQW1vdW50KSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7Cn0KCgovKgogICAgQmFuY29yIEdhcyBQcmljZSBMaW1pdCBpbnRlcmZhY2UKKi8KY29udHJhY3QgSUJhbmNvckdhc1ByaWNlTGltaXQgewogICAgZnVuY3Rpb24gZ2FzUHJpY2UoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikge30KfQoKCi8qCiAgICBUaGUgQmFuY29yR2FzUHJpY2VMaW1pdCBjb250cmFjdCBzZXJ2ZXMgYXMgYW4gZXh0cmEgZnJvbnQtcnVubmluZyBhdHRhY2sgbWl0aWdhdGlvbiBtZWNoYW5pc20uCiAgICBJdCBzZXRzIGEgbWF4aW11bSBnYXMgcHJpY2Ugb24gYWxsIGJhbmNvciBjb252ZXJzaW9ucywgd2hpY2ggcHJldmVudHMgdXNlcnMgZnJvbSAiY3V0dGluZyBpbiBsaW5lIgogICAgaW4gb3JkZXIgdG8gZnJvbnQtcnVuIG90aGVyIHRyYW5zYWN0aW9ucy4KICAgIFRoZSBnYXMgcHJpY2UgbGltaXQgaXMgdW5pdmVyc2FsIHRvIGFsbCBjb252ZXJ0ZXJzIGFuZCBpdCBjYW4gYmUgdXBkYXRlZCBieSB0aGUgb3duZXIgdG8gYmUgaW4gbGluZQogICAgd2l0aCB0aGUgbmV0d29yaydzIGN1cnJlbnQgZ2FzIHByaWNlLgoqLwpjb250cmFjdCBCYW5jb3JHYXNQcmljZUxpbWl0IGlzIElCYW5jb3JHYXNQcmljZUxpbWl0LCBPd25lZCwgVXRpbHMgewogICAgdWludDI1NiBwdWJsaWMgZ2FzUHJpY2UgPSAwIHdlaTsgICAgLy8gbWF4aW11bSBnYXMgcHJpY2UgZm9yIGJhbmNvciB0cmFuc2FjdGlvbnMKCiAgICAvKioKICAgICAgICBAZGV2IGNvbnN0cnVjdG9yCgogICAgICAgIEBwYXJhbSBfZ2FzUHJpY2UgICAgZ2FzIHByaWNlIGxpbWl0CiAgICAqLwogICAgZnVuY3Rpb24gQmFuY29yR2FzUHJpY2VMaW1pdCh1aW50MjU2IF9nYXNQcmljZSkKICAgICAgICBncmVhdGVyVGhhblplcm8oX2dhc1ByaWNlKQogICAgewogICAgICAgIGdhc1ByaWNlID0gX2dhc1ByaWNlOwogICAgfQoKICAgIC8qCiAgICAgICAgQGRldiBhbGxvd3MgdGhlIG93bmVyIHRvIHVwZGF0ZSB0aGUgZ2FzIHByaWNlIGxpbWl0CgogICAgICAgIEBwYXJhbSBfZ2FzUHJpY2UgICAgbmV3IGdhcyBwcmljZSBsaW1pdAogICAgKi8KICAgIGZ1bmN0aW9uIHNldEdhc1ByaWNlKHVpbnQyNTYgX2dhc1ByaWNlKQogICAgICAgIHB1YmxpYwogICAgICAgIG93bmVyT25seQogICAgICAgIGdyZWF0ZXJUaGFuWmVybyhfZ2FzUHJpY2UpCiAgICB7CiAgICAgICAgZ2FzUHJpY2UgPSBfZ2FzUHJpY2U7CiAgICB9Cn0KCgovKgogICAgQmFuY29yIFF1aWNrIENvbnZlcnRlciBpbnRlcmZhY2UKKi8KY29udHJhY3QgSUJhbmNvclF1aWNrQ29udmVydGVyIHsKICAgIGZ1bmN0aW9uIGNvbnZlcnQoSUVSQzIwVG9rZW5bXSBfcGF0aCwgdWludDI1NiBfYW1vdW50LCB1aW50MjU2IF9taW5SZXR1cm4pIHB1YmxpYyBwYXlhYmxlIHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gY29udmVydEZvcihJRVJDMjBUb2tlbltdIF9wYXRoLCB1aW50MjU2IF9hbW91bnQsIHVpbnQyNTYgX21pblJldHVybiwgYWRkcmVzcyBfZm9yKSBwdWJsaWMgcGF5YWJsZSByZXR1cm5zICh1aW50MjU2KTsKfQoKCi8qCiAgICBCYW5jb3IgQ29udmVydGVyIEV4dGVuc2lvbnMgaW50ZXJmYWNlCiovCmNvbnRyYWN0IElCYW5jb3JDb252ZXJ0ZXJFeHRlbnNpb25zIHsKICAgIGZ1bmN0aW9uIGZvcm11bGEoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoSUJhbmNvckZvcm11bGEpIHt9CiAgICBmdW5jdGlvbiBnYXNQcmljZUxpbWl0KCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKElCYW5jb3JHYXNQcmljZUxpbWl0KSB7fQogICAgZnVuY3Rpb24gcXVpY2tDb252ZXJ0ZXIoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoSUJhbmNvclF1aWNrQ29udmVydGVyKSB7fQp9CgoKCi8qCiAgICBFdGhlciBUb2tlbiBpbnRlcmZhY2UKKi8KY29udHJhY3QgSUV0aGVyVG9rZW4gaXMgSVRva2VuSG9sZGVyLCBJRVJDMjBUb2tlbiB7CiAgICBmdW5jdGlvbiBkZXBvc2l0KCkgcHVibGljIHBheWFibGU7CiAgICBmdW5jdGlvbiB3aXRoZHJhdyh1aW50MjU2IF9hbW91bnQpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIHdpdGhkcmF3VG8oYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCk7Cn0KCgovKgogICAgVGhlIEJhbmNvclF1aWNrQ29udmVydGVyIGNvbnRyYWN0IHByb3ZpZGVzIGFsbG93cyBjb252ZXJ0aW5nIGJldHdlZW4gYW55IHRva2VuIGluIHRoZSAKICAgIGJhbmNvciBuZXR3b3JrIGluIGEgc2luZ2xlIHRyYW5zYWN0aW9uLgoKICAgIEEgbm90ZSBvbiBjb252ZXJzaW9uIHBhdGhzIC0KICAgIENvbnZlcnNpb24gcGF0aCBpcyBhIGRhdGEgc3RydWN0dXJlIHRoYXQncyB1c2VkIHdoZW4gY29udmVydGluZyBhIHRva2VuIHRvIGFub3RoZXIgdG9rZW4gaW4gdGhlIGJhbmNvciBuZXR3b3JrCiAgICB3aGVuIHRoZSBjb252ZXJzaW9uIGNhbm5vdCBuZWNlc3NhcmlseSBiZSBkb25lIGJ5IHNpbmdsZSBjb252ZXJ0ZXIgYW5kIG1pZ2h0IHJlcXVpcmUgbXVsdGlwbGUgJ2hvcHMnLgogICAgVGhlIHBhdGggZGVmaW5lcyB3aGljaCBjb252ZXJ0ZXJzIHNob3VsZCBiZSB1c2VkIGFuZCB3aGF0IGtpbmQgb2YgY29udmVyc2lvbiBzaG91bGQgYmUgZG9uZSBpbiBlYWNoIHN0ZXAuCgogICAgVGhlIHBhdGggZm9ybWF0IGRvZXNuJ3QgaW5jbHVkZSBjb21wbGV4IHN0cnVjdHVyZSBhbmQgaW5zdGVhZCwgaXQgaXMgcmVwcmVzZW50ZWQgYnkgYSBzaW5nbGUgYXJyYXkKICAgIGluIHdoaWNoIGVhY2ggJ2hvcCcgaXMgcmVwcmVzZW50ZWQgYnkgYSAyLXR1cGxlIC0gc21hcnQgdG9rZW4gJiB0byB0b2tlbi4KICAgIEluIGFkZGl0aW9uLCB0aGUgZmlyc3QgZWxlbWVudCBpcyBhbHdheXMgdGhlIHNvdXJjZSB0b2tlbi4KICAgIFRoZSBzbWFydCB0b2tlbiBpcyBvbmx5IHVzZWQgYXMgYSBwb2ludGVyIHRvIGEgY29udmVydGVyIChzaW5jZSBjb252ZXJ0ZXIgYWRkcmVzc2VzIGFyZSBtb3JlIGxpa2VseSB0byBjaGFuZ2UpLgoKICAgIEZvcm1hdDoKICAgIFtzb3VyY2UgdG9rZW4sIHNtYXJ0IHRva2VuLCB0byB0b2tlbiwgc21hcnQgdG9rZW4sIHRvIHRva2VuLi4uXQoqLwpjb250cmFjdCBCYW5jb3JRdWlja0NvbnZlcnRlciBpcyBJQmFuY29yUXVpY2tDb252ZXJ0ZXIsIFRva2VuSG9sZGVyIHsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIGV0aGVyVG9rZW5zOyAgIC8vIGxpc3Qgb2YgYWxsIHN1cHBvcnRlZCBldGhlciB0b2tlbnMKCiAgICAvKioKICAgICAgICBAZGV2IGNvbnN0cnVjdG9yCiAgICAqLwogICAgZnVuY3Rpb24gQmFuY29yUXVpY2tDb252ZXJ0ZXIoKSB7CiAgICB9CgogICAgLy8gdmFsaWRhdGVzIGEgY29udmVyc2lvbiBwYXRoIC0gdmVyaWZpZXMgdGhhdCB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIGlzIG9kZCBhbmQgdGhhdCBtYXhpbXVtIG51bWJlciBvZiAnaG9wcycgaXMgMTAKICAgIG1vZGlmaWVyIHZhbGlkQ29udmVyc2lvblBhdGgoSUVSQzIwVG9rZW5bXSBfcGF0aCkgewogICAgICAgIHJlcXVpcmUoX3BhdGgubGVuZ3RoID4gMiAmJiBfcGF0aC5sZW5ndGggPD0gKDEgKyAyICogMTApICYmIF9wYXRoLmxlbmd0aCAlIDIgPT0gMSk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvKioKICAgICAgICBAZGV2IGFsbG93cyB0aGUgb3duZXIgdG8gcmVnaXN0ZXIvdW5yZWdpc3RlciBldGhlciB0b2tlbnMKCiAgICAgICAgQHBhcmFtIF90b2tlbiAgICAgICBldGhlciB0b2tlbiBjb250cmFjdCBhZGRyZXNzCiAgICAgICAgQHBhcmFtIF9yZWdpc3RlciAgICB0cnVlIHRvIHJlZ2lzdGVyLCBmYWxzZSB0byB1bnJlZ2lzdGVyCiAgICAqLwogICAgZnVuY3Rpb24gcmVnaXN0ZXJFdGhlclRva2VuKElFdGhlclRva2VuIF90b2tlbiwgYm9vbCBfcmVnaXN0ZXIpCiAgICAgICAgcHVibGljCiAgICAgICAgb3duZXJPbmx5CiAgICAgICAgdmFsaWRBZGRyZXNzKF90b2tlbikKICAgICAgICBub3RUaGlzKF90b2tlbikKICAgIHsKICAgICAgICBldGhlclRva2Vuc1tfdG9rZW5dID0gX3JlZ2lzdGVyOwogICAgfQoKICAgIC8qKgogICAgICAgIEBkZXYgY29udmVydHMgdGhlIHRva2VuIHRvIGFueSBvdGhlciB0b2tlbiBpbiB0aGUgYmFuY29yIG5ldHdvcmsgYnkgZm9sbG93aW5nCiAgICAgICAgYSBwcmVkZWZpbmVkIGNvbnZlcnNpb24gcGF0aCBhbmQgdHJhbnNmZXJzIHRoZSByZXN1bHQgdG9rZW5zIHRvIGEgdGFyZ2V0IGFjY291bnQKICAgICAgICBub3RlIHRoYXQgdGhlIGNvbnZlcnRlciBzaG91bGQgYWxyZWFkeSBvd24gdGhlIHNvdXJjZSB0b2tlbnMKCiAgICAgICAgQHBhcmFtIF9wYXRoICAgICAgICBjb252ZXJzaW9uIHBhdGgsIHNlZSBjb252ZXJzaW9uIHBhdGggZm9ybWF0IGFib3ZlCiAgICAgICAgQHBhcmFtIF9hbW91bnQgICAgICBhbW91bnQgdG8gY29udmVydCBmcm9tIChpbiB0aGUgaW5pdGlhbCBzb3VyY2UgdG9rZW4pCiAgICAgICAgQHBhcmFtIF9taW5SZXR1cm4gICBpZiB0aGUgY29udmVyc2lvbiByZXN1bHRzIGluIGFuIGFtb3VudCBzbWFsbGVyIHRoYW4gdGhlIG1pbmltdW0gcmV0dXJuIC0gaXQgaXMgY2FuY2VsbGVkLCBtdXN0IGJlIG5vbnplcm8KICAgICAgICBAcGFyYW0gX2ZvciAgICAgICAgIGFjY291bnQgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIGNvbnZlcnNpb24gcmVzdWx0CgogICAgICAgIEByZXR1cm4gdG9rZW5zIGlzc3VlZCBpbiByZXR1cm4KICAgICovCiAgICBmdW5jdGlvbiBjb252ZXJ0Rm9yKElFUkMyMFRva2VuW10gX3BhdGgsIHVpbnQyNTYgX2Ftb3VudCwgdWludDI1NiBfbWluUmV0dXJuLCBhZGRyZXNzIF9mb3IpCiAgICAgICAgcHVibGljCiAgICAgICAgcGF5YWJsZQogICAgICAgIHZhbGlkQ29udmVyc2lvblBhdGgoX3BhdGgpCiAgICAgICAgcmV0dXJucyAodWludDI1NikKICAgIHsKICAgICAgICAvLyBpZiBFVEggaXMgcHJvdmlkZWQsIGVuc3VyZSB0aGF0IHRoZSBhbW91bnQgaXMgaWRlbnRpY2FsIHRvIF9hbW91bnQgYW5kIHZlcmlmeSB0aGF0IHRoZSBzb3VyY2UgdG9rZW4gaXMgYW4gZXRoZXIgdG9rZW4KICAgICAgICBJRVJDMjBUb2tlbiBmcm9tVG9rZW4gPSBfcGF0aFswXTsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA9PSAwIHx8IChfYW1vdW50ID09IG1zZy52YWx1ZSAmJiBldGhlclRva2Vuc1tmcm9tVG9rZW5dKSk7CgogICAgICAgIElTbWFydFRva2VuIHNtYXJ0VG9rZW47CiAgICAgICAgSUVSQzIwVG9rZW4gdG9Ub2tlbjsKICAgICAgICBJVG9rZW5Db252ZXJ0ZXIgY29udmVydGVyOwogICAgICAgIHVpbnQyNTYgcGF0aExlbmd0aCA9IF9wYXRoLmxlbmd0aDsKCiAgICAgICAgLy8gaWYgRVRIIHdhcyBzZW50IHdpdGggdGhlIGNhbGwsIHRoZSBzb3VyY2UgaXMgYW4gZXRoZXIgdG9rZW4gLSBkZXBvc2l0IHRoZSBFVEggaW4gaXQKICAgICAgICAvLyBvdGhlcndpc2UsIHdlIGFzc3VtZSB3ZSBhbHJlYWR5IGhhdmUgdGhlIHRva2VucwogICAgICAgIGlmIChtc2cudmFsdWUgPiAwKQogICAgICAgICAgICBJRXRoZXJUb2tlbihmcm9tVG9rZW4pLmRlcG9zaXQudmFsdWUobXNnLnZhbHVlKSgpOwoKICAgICAgICAvLyBpdGVyYXRlIG92ZXIgdGhlIGNvbnZlcnNpb24gcGF0aAogICAgICAgIGZvciAodWludDI1NiBpID0gMTsgaSA8IHBhdGhMZW5ndGg7IGkgKz0gMikgewogICAgICAgICAgICBzbWFydFRva2VuID0gSVNtYXJ0VG9rZW4oX3BhdGhbaV0pOwogICAgICAgICAgICB0b1Rva2VuID0gX3BhdGhbaSArIDFdOwogICAgICAgICAgICBjb252ZXJ0ZXIgPSBJVG9rZW5Db252ZXJ0ZXIoc21hcnRUb2tlbi5vd25lcigpKTsKCiAgICAgICAgICAgIC8vIGlmIHRoZSBzbWFydCB0b2tlbiBpc24ndCB0aGUgc291cmNlIChmcm9tIHRva2VuKSwgdGhlIGNvbnZlcnRlciBkb2Vzbid0IGhhdmUgY29udHJvbCBvdmVyIGl0IGFuZCB0aHVzIHdlIG5lZWQgdG8gYXBwcm92ZSB0aGUgcmVxdWVzdAogICAgICAgICAgICBpZiAoc21hcnRUb2tlbiAhPSBmcm9tVG9rZW4pCiAgICAgICAgICAgICAgICBlbnN1cmVBbGxvd2FuY2UoZnJvbVRva2VuLCBjb252ZXJ0ZXIsIF9hbW91bnQpOwoKICAgICAgICAgICAgLy8gbWFrZSB0aGUgY29udmVyc2lvbiAtIGlmIGl0J3MgdGhlIGxhc3Qgb25lLCBhbHNvIHByb3ZpZGUgdGhlIG1pbmltdW0gcmV0dXJuIHZhbHVlCiAgICAgICAgICAgIF9hbW91bnQgPSBjb252ZXJ0ZXIuY2hhbmdlKGZyb21Ub2tlbiwgdG9Ub2tlbiwgX2Ftb3VudCwgaSA9PSBwYXRoTGVuZ3RoIC0gMiA/IF9taW5SZXR1cm4gOiAxKTsKICAgICAgICAgICAgZnJvbVRva2VuID0gdG9Ub2tlbjsKICAgICAgICB9CgogICAgICAgIC8vIGZpbmlzaGVkIHRoZSBjb252ZXJzaW9uLCB0cmFuc2ZlciB0aGUgZnVuZHMgdG8gdGhlIHRhcmdldCBhY2NvdW50CiAgICAgICAgLy8gaWYgdGhlIHRhcmdldCB0b2tlbiBpcyBhbiBldGhlciB0b2tlbiwgd2l0aGRyYXcgdGhlIHRva2VucyBhbmQgc2VuZCB0aGVtIGFzIEVUSAogICAgICAgIC8vIG90aGVyd2lzZSwgdHJhbnNmZXIgdGhlIHRva2VucyBhcyBpcwogICAgICAgIGlmIChldGhlclRva2Vuc1t0b1Rva2VuXSkKICAgICAgICAgICAgSUV0aGVyVG9rZW4odG9Ub2tlbikud2l0aGRyYXdUbyhfZm9yLCBfYW1vdW50KTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIGFzc2VydCh0b1Rva2VuLnRyYW5zZmVyKF9mb3IsIF9hbW91bnQpKTsKCiAgICAgICAgcmV0dXJuIF9hbW91bnQ7CiAgICB9CgogICAgLyoqCiAgICAgICAgQGRldiBjbGFpbXMgdGhlIGNhbGxlcidzIHRva2VucywgY29udmVydHMgdGhlbSB0byBhbnkgb3RoZXIgdG9rZW4gaW4gdGhlIGJhbmNvciBuZXR3b3JrCiAgICAgICAgYnkgZm9sbG93aW5nIGEgcHJlZGVmaW5lZCBjb252ZXJzaW9uIHBhdGggYW5kIHRyYW5zZmVycyB0aGUgcmVzdWx0IHRva2VucyB0byBhIHRhcmdldCBhY2NvdW50CiAgICAgICAgbm90ZSB0aGF0IGFsbG93YW5jZSBtdXN0IGJlIHNldCBiZWZvcmVoYW5kCgogICAgICAgIEBwYXJhbSBfcGF0aCAgICAgICAgY29udmVyc2lvbiBwYXRoLCBzZWUgY29udmVyc2lvbiBwYXRoIGZvcm1hdCBhYm92ZQogICAgICAgIEBwYXJhbSBfYW1vdW50ICAgICAgYW1vdW50IHRvIGNvbnZlcnQgZnJvbSAoaW4gdGhlIGluaXRpYWwgc291cmNlIHRva2VuKQogICAgICAgIEBwYXJhbSBfbWluUmV0dXJuICAgaWYgdGhlIGNvbnZlcnNpb24gcmVzdWx0cyBpbiBhbiBhbW91bnQgc21hbGxlciB0aGFuIHRoZSBtaW5pbXVtIHJldHVybiAtIGl0IGlzIGNhbmNlbGxlZCwgbXVzdCBiZSBub256ZXJvCiAgICAgICAgQHBhcmFtIF9mb3IgICAgICAgICBhY2NvdW50IHRoYXQgd2lsbCByZWNlaXZlIHRoZSBjb252ZXJzaW9uIHJlc3VsdAoKICAgICAgICBAcmV0dXJuIHRva2VucyBpc3N1ZWQgaW4gcmV0dXJuCiAgICAqLwogICAgZnVuY3Rpb24gY2xhaW1BbmRDb252ZXJ0Rm9yKElFUkMyMFRva2VuW10gX3BhdGgsIHVpbnQyNTYgX2Ftb3VudCwgdWludDI1NiBfbWluUmV0dXJuLCBhZGRyZXNzIF9mb3IpIHB1YmxpYyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgLy8gd2UgbmVlZCB0byB0cmFuc2ZlciB0aGUgdG9rZW5zIGZyb20gdGhlIGNhbGxlciB0byB0aGUgY29udmVydGVyIGJlZm9yZSB3ZSBmb2xsb3cKICAgICAgICAvLyB0aGUgY29udmVyc2lvbiBwYXRoLCB0byBhbGxvdyBpdCB0byBleGVjdXRlIHRoZSBjb252ZXJzaW9uIG9uIGJlaGFsZiBvZiB0aGUgY2FsbGVyCiAgICAgICAgLy8gbm90ZTogd2UgYXNzdW1lIHdlIGFscmVhZHkgaGF2ZSBhbGxvd2FuY2UKICAgICAgICBJRVJDMjBUb2tlbiBmcm9tVG9rZW4gPSBfcGF0aFswXTsKICAgICAgICBhc3NlcnQoZnJvbVRva2VuLnRyYW5zZmVyRnJvbShtc2cuc2VuZGVyLCB0aGlzLCBfYW1vdW50KSk7CiAgICAgICAgcmV0dXJuIGNvbnZlcnRGb3IoX3BhdGgsIF9hbW91bnQsIF9taW5SZXR1cm4sIF9mb3IpOwogICAgfQoKICAgIC8qKgogICAgICAgIEBkZXYgY29udmVydHMgdGhlIHRva2VuIHRvIGFueSBvdGhlciB0b2tlbiBpbiB0aGUgYmFuY29yIG5ldHdvcmsgYnkgZm9sbG93aW5nCiAgICAgICAgYSBwcmVkZWZpbmVkIGNvbnZlcnNpb24gcGF0aCBhbmQgdHJhbnNmZXJzIHRoZSByZXN1bHQgdG9rZW5zIGJhY2sgdG8gdGhlIHNlbmRlcgogICAgICAgIG5vdGUgdGhhdCB0aGUgY29udmVydGVyIHNob3VsZCBhbHJlYWR5IG93biB0aGUgc291cmNlIHRva2VucwoKICAgICAgICBAcGFyYW0gX3BhdGggICAgICAgIGNvbnZlcnNpb24gcGF0aCwgc2VlIGNvbnZlcnNpb24gcGF0aCBmb3JtYXQgYWJvdmUKICAgICAgICBAcGFyYW0gX2Ftb3VudCAgICAgIGFtb3VudCB0byBjb252ZXJ0IGZyb20gKGluIHRoZSBpbml0aWFsIHNvdXJjZSB0b2tlbikKICAgICAgICBAcGFyYW0gX21pblJldHVybiAgIGlmIHRoZSBjb252ZXJzaW9uIHJlc3VsdHMgaW4gYW4gYW1vdW50IHNtYWxsZXIgdGhhbiB0aGUgbWluaW11bSByZXR1cm4gLSBpdCBpcyBjYW5jZWxsZWQsIG11c3QgYmUgbm9uemVybwoKICAgICAgICBAcmV0dXJuIHRva2VucyBpc3N1ZWQgaW4gcmV0dXJuCiAgICAqLwogICAgZnVuY3Rpb24gY29udmVydChJRVJDMjBUb2tlbltdIF9wYXRoLCB1aW50MjU2IF9hbW91bnQsIHVpbnQyNTYgX21pblJldHVybikgcHVibGljIHBheWFibGUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBjb252ZXJ0Rm9yKF9wYXRoLCBfYW1vdW50LCBfbWluUmV0dXJuLCBtc2cuc2VuZGVyKTsKICAgIH0KCiAgICAvKioKICAgICAgICBAZGV2IGNsYWltcyB0aGUgY2FsbGVyJ3MgdG9rZW5zLCBjb252ZXJ0cyB0aGVtIHRvIGFueSBvdGhlciB0b2tlbiBpbiB0aGUgYmFuY29yIG5ldHdvcmsKICAgICAgICBieSBmb2xsb3dpbmcgYSBwcmVkZWZpbmVkIGNvbnZlcnNpb24gcGF0aCBhbmQgdHJhbnNmZXJzIHRoZSByZXN1bHQgdG9rZW5zIGJhY2sgdG8gdGhlIHNlbmRlcgogICAgICAgIG5vdGUgdGhhdCBhbGxvd2FuY2UgbXVzdCBiZSBzZXQgYmVmb3JlaGFuZAoKICAgICAgICBAcGFyYW0gX3BhdGggICAgICAgIGNvbnZlcnNpb24gcGF0aCwgc2VlIGNvbnZlcnNpb24gcGF0aCBmb3JtYXQgYWJvdmUKICAgICAgICBAcGFyYW0gX2Ftb3VudCAgICAgIGFtb3VudCB0byBjb252ZXJ0IGZyb20gKGluIHRoZSBpbml0aWFsIHNvdXJjZSB0b2tlbikKICAgICAgICBAcGFyYW0gX21pblJldHVybiAgIGlmIHRoZSBjb252ZXJzaW9uIHJlc3VsdHMgaW4gYW4gYW1vdW50IHNtYWxsZXIgdGhhbiB0aGUgbWluaW11bSByZXR1cm4gLSBpdCBpcyBjYW5jZWxsZWQsIG11c3QgYmUgbm9uemVybwoKICAgICAgICBAcmV0dXJuIHRva2VucyBpc3N1ZWQgaW4gcmV0dXJuCiAgICAqLwogICAgZnVuY3Rpb24gY2xhaW1BbmRDb252ZXJ0KElFUkMyMFRva2VuW10gX3BhdGgsIHVpbnQyNTYgX2Ftb3VudCwgdWludDI1NiBfbWluUmV0dXJuKSBwdWJsaWMgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBjbGFpbUFuZENvbnZlcnRGb3IoX3BhdGgsIF9hbW91bnQsIF9taW5SZXR1cm4sIG1zZy5zZW5kZXIpOwogICAgfQoKICAgIC8qKgogICAgICAgIEBkZXYgdXRpbGl0eSwgY2hlY2tzIHdoZXRoZXIgYWxsb3dhbmNlIGZvciB0aGUgZ2l2ZW4gc3BlbmRlciBleGlzdHMgYW5kIGFwcHJvdmVzIG9uZSBpZiBpdCBkb2Vzbid0CgogICAgICAgIEBwYXJhbSBfdG9rZW4gICB0b2tlbiB0byBjaGVjayB0aGUgYWxsb3dhbmNlIGluCiAgICAgICAgQHBhcmFtIF9zcGVuZGVyIGFwcHJvdmVkIGFkZHJlc3MKICAgICAgICBAcGFyYW0gX3ZhbHVlICAgYWxsb3dhbmNlIGFtb3VudAogICAgKi8KICAgIGZ1bmN0aW9uIGVuc3VyZUFsbG93YW5jZShJRVJDMjBUb2tlbiBfdG9rZW4sIGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwcml2YXRlIHsKICAgICAgICAvLyBjaGVjayBpZiBhbGxvd2FuY2UgZm9yIHRoZSBnaXZlbiBhbW91bnQgYWxyZWFkeSBleGlzdHMKICAgICAgICBpZiAoX3Rva2VuLmFsbG93YW5jZSh0aGlzLCBfc3BlbmRlcikgPj0gX3ZhbHVlKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIC8vIGlmIHRoZSBhbGxvd2FuY2UgaXMgbm9uemVybywgbXVzdCByZXNldCBpdCB0byAwIGZpcnN0CiAgICAgICAgaWYgKF90b2tlbi5hbGxvd2FuY2UodGhpcywgX3NwZW5kZXIpICE9IDApCiAgICAgICAgICAgIGFzc2VydChfdG9rZW4uYXBwcm92ZShfc3BlbmRlciwgMCkpOwoKICAgICAgICAvLyBhcHByb3ZlIHRoZSBuZXcgYWxsb3dhbmNlCiAgICAgICAgYXNzZXJ0KF90b2tlbi5hcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUpKTsKICAgIH0KfQ=='.
	

]
