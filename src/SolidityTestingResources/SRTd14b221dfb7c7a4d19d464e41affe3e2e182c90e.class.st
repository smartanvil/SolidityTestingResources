Class {
	#name : #SRTd14b221dfb7c7a4d19d464e41affe3e2e182c90e,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd14b221dfb7c7a4d19d464e41affe3e2e182c90e >> base64 [
	^ 'Y29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CgogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICB1aW50MjU2IF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CgogIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0uYWRkKF9hZGRlZFZhbHVlKTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9Cgpjb250cmFjdCBPd25lZCAKewogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8pOwoKICAgIGZ1bmN0aW9uIE93bmVkKCkgCiAgICB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlPd25lciAKICAgIHsKICAgICAgICByZXF1aXJlIChtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciAKICAgIHsKICAgICAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICB9Cn0KCmNvbnRyYWN0IHg4ODggaXMgU3RhbmRhcmRUb2tlbgp7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICJNZXRhIEV4Y2hhbmdlIHg4ODgiOwogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAiWDg4OCI7CiAgICB1aW50OCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSA2OwogICAgCiAgICB1aW50MjU2IHZlcnNpb24gPSAxMDA5MDA5OTk5OTsKICAgIAogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHkgPSA1MTI1Mzg3ODg4ICogKHVpbnQyNTYoMTApICoqIGRlY2ltYWxzKTsKCiAgICB1aW50MjU2IHB1YmxpYyBleGNoRmVlID0gdWludDI1NigxICogKHVpbnQyNTYoMTApICoqIChkZWNpbWFscyAtIDIpKSk7CgogICAgdWludDI1NiBwdWJsaWMgc3RhcnRUaW1lc3RhbXA7CiAgICAKICAgIHVpbnQyNTYgcHVibGljIGF2Z1JhdGUgPSB1aW50MjU2KHVpbnQyNTYoMTApKiooMTgtZGVjaW1hbHMpKS5kaXYoODg4KTsKCiAgICBhZGRyZXNzIHB1YmxpYyBzdHVmZiA9IDB4MENjQ2I5YkFBZEQ2MUY5ZTBhYjI1YkQ3ODI3NjUwMTM4MTc4MjFiRDsKICAgIGFkZHJlc3MgcHVibGljIHRlYW1hID0gMHgyMGYzNDk5MTdkMjUyMWM0MWY4ZWM5YzBhMWY3ZTBjMzZhZjBiNDZmOwogICAgYWRkcmVzcyBwdWJsaWMgYmFzZW93bmVyOwoKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgX3ZlcmlmeTsKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgX3RyYWRlcjsKICAgIG1hcHBpbmcodWludDI1NiA9PiBhZGRyZXNzKSBwdWJsaWMgX21rczsKICAgIHVpbnQyNTYgcHVibGljIG1ha2Vyc0NvdW50OwoKICAgIGV2ZW50IExvZ1RyYW5zZmVyKGFkZHJlc3Mgc2VuZGVyLCBhZGRyZXNzIHRvLCB1aW50IGFtb3VudCk7CiAgICBldmVudCBDbGVhcmluZyhhZGRyZXNzIHRvLCB1aW50MjU2IGFtb3VudCk7CgogICAgZXZlbnQgVHJhZGVMaXN0aW5nKGFkZHJlc3MgaW5kZXhlZCBvd25lckFkZHJlc3MsIGFkZHJlc3MgaW5kZXhlZCB0b2tlblRyYWRlckFkZHJlc3MsCiAgICBhZGRyZXNzIGluZGV4ZWQgYXNzZXQsIHVpbnQyNTYgYnV5UHJpY2UsIHVpbnQyNTYgc2VsbFByaWNlLGJvb2wgYnV5c1Rva2VucywgYm9vbCBzZWxsc1Rva2Vucyk7CiAgICBldmVudCBPd25lcldpdGhkcmV3RVJDMjBUb2tlbihhZGRyZXNzIGluZGV4ZWQgdG9rZW5BZGRyZXNzLCB1aW50MjU2IHRva2Vucyk7CgogICAgZnVuY3Rpb24geDg4OCgpIAogICAgewogICAgICAgIG1ha2Vyc0NvdW50ID0gMDsKICAgICAgICBzdGFydFRpbWVzdGFtcCA9IG5vdzsKICAgICAgICBiYXNlb3duZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIGJhbGFuY2VzW2Jhc2Vvd25lcl0gPSB0b3RhbFN1cHBseTsKICAgICAgICBUcmFuc2ZlcigweDAsIGJhc2Vvd25lciwgdG90YWxTdXBwbHkpOwogICAgfQoKICAgIGZ1bmN0aW9uIGJ2YShhZGRyZXNzIHBhcnRuZXIsIHVpbnQyNTYgdmFsdWUsIGFkZHJlc3MgYWR2aXNlcilwYXlhYmxlIHB1YmxpYyAKICAgIHsKICAgICAgdWludDI1NiB0b2tlbkFtb3VudCA9IGNhbGNUb3RhbCh2YWx1ZSk7CiAgICAgIGlmKG1zZy52YWx1ZSAhPSAwKQogICAgICB7CiAgICAgICAgdG9rZW5BbW91bnQgPSBjYWxjQ291bnQobXNnLnZhbHVlKTsKICAgICAgfWVsc2UKICAgICAgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBzdHVmZik7CiAgICAgIH0KICAgICAgaWYobXNnLnZhbHVlICE9IDApCiAgICAgIHsKICAgICAgICBDbGVhcmluZyhzdHVmZiwgbXNnLnZhbHVlLm11bCg0MCkuZGl2KDEwMCkpOwogICAgICAgIHN0dWZmLnRyYW5zZmVyKG1zZy52YWx1ZS5tdWwoNDApLmRpdigxMDApKTsKICAgICAgICBDbGVhcmluZyh0ZWFtYSwgbXNnLnZhbHVlLm11bCg0MCkuZGl2KDEwMCkpOwogICAgICAgIHRlYW1hLnRyYW5zZmVyKG1zZy52YWx1ZS5tdWwoNDApLmRpdigxMDApKTsKICAgICAgICBpZihwYXJ0bmVyICE9IGFkdmlzZXIgJiYgYmFsYW5jZXNbYWR2aXNlcl0hPTApCiAgICAgICAgewogICAgICAgICAgQ2xlYXJpbmcoYWR2aXNlciwgbXNnLnZhbHVlLm11bCgyMCkuZGl2KDEwMCkpOwogICAgICAgICAgYWR2aXNlci50cmFuc2Zlcihtc2cudmFsdWUubXVsKDIwKS5kaXYoMTAwKSk7CiAgICAgICAgfWVsc2UKICAgICAgICB7CiAgICAgICAgICBDbGVhcmluZyhzdHVmZiwgbXNnLnZhbHVlLm11bCgxMCkuZGl2KDEwMCkpOwogICAgICAgICAgc3R1ZmYudHJhbnNmZXIobXNnLnZhbHVlLm11bCgxMCkuZGl2KDEwMCkpOwogICAgICAgICAgQ2xlYXJpbmcodGVhbWEsIG1zZy52YWx1ZS5tdWwoMTApLmRpdigxMDApKTsKICAgICAgICAgIHRlYW1hLnRyYW5zZmVyKG1zZy52YWx1ZS5tdWwoMTApLmRpdigxMDApKTsKICAgICAgICB9IAogICAgICB9CiAgICAgIGJhbGFuY2VzW2Jhc2Vvd25lcl0gPSBiYWxhbmNlc1tiYXNlb3duZXJdLnN1Yih0b2tlbkFtb3VudCk7CiAgICAgIGJhbGFuY2VzW3BhcnRuZXJdID0gYmFsYW5jZXNbcGFydG5lcl0uYWRkKHRva2VuQW1vdW50KTsKICAgICAgVHJhbnNmZXIoYmFzZW93bmVyLCBwYXJ0bmVyLCB0b2tlbkFtb3VudCk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uKCkgcGF5YWJsZSBwdWJsaWMKICAgIHsKICAgICAgaWYobXNnLnZhbHVlICE9IDApCiAgICAgIHsKICAgICAgICB1aW50MjU2IHRva2VuQW1vdW50ID0gbXNnLnZhbHVlLmRpdihhdmdSYXRlKTsKICAgICAgICBDbGVhcmluZyhzdHVmZiwgbXNnLnZhbHVlLm11bCg1MCkuZGl2KDEwMCkpOwogICAgICAgIHN0dWZmLnRyYW5zZmVyKG1zZy52YWx1ZS5tdWwoNTApLmRpdigxMDApKTsKICAgICAgICBDbGVhcmluZyh0ZWFtYSwgbXNnLnZhbHVlLm11bCg1MCkuZGl2KDEwMCkpOwogICAgICAgIHRlYW1hLnRyYW5zZmVyKG1zZy52YWx1ZS5tdWwoNTApLmRpdigxMDApKTsKICAgICAgICBpZihtc2cuc2VuZGVyIT1zdHVmZikKICAgICAgICB7CiAgICAgICAgICBiYWxhbmNlc1tiYXNlb3duZXJdID0gYmFsYW5jZXNbYmFzZW93bmVyXS5zdWIodG9rZW5BbW91bnQpOwogICAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5hZGQodG9rZW5BbW91bnQpOwogICAgICAgICAgVHJhbnNmZXIoYmFzZW93bmVyLCBtc2cuc2VuZGVyLCB0b2tlbkFtb3VudCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gY2FsY1RvdGFsKHVpbnQyNTYgY291bnQpIGNvbnN0YW50IHJldHVybnModWludDI1NikgCiAgICB7CiAgICAgICAgcmV0dXJuIGNvdW50Lm11bChnZXREZWZsYXRvcigpKS5kaXYoMTAwKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjYWxjQ291bnQodWludDI1NiB3ZWlBbW91bnQpIGNvbnN0YW50IHJldHVybnModWludDI1NikgCiAgICB7CiAgICAgICAgcmV0dXJuIHdlaUFtb3VudC5kaXYoYXZnUmF0ZSkubXVsKGdldERlZmxhdG9yKCkpLmRpdigxMDApOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldERlZmxhdG9yKCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikKICAgIHsKICAgICAgICBpZiAobm93IDw9IHN0YXJ0VGltZXN0YW1wICsgMjggZGF5cykvLzM4JSAKICAgICAgICB7CiAgICAgICAgICAgIHJldHVybiAxMzg7CiAgICAgICAgfWVsc2UgaWYgKG5vdyA8PSBzdGFydFRpbWVzdGFtcCArIDU2IGRheXMpLy8yMyUgCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gMTIzOwogICAgICAgIH1lbHNlIGlmIChub3cgPD0gc3RhcnRUaW1lc3RhbXAgKyA4NCBkYXlzKS8vMTUlIAogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIDExNTsKICAgICAgICB9ZWxzZSBpZiAobm93IDw9IHN0YXJ0VGltZXN0YW1wICsgMTEyIGRheXMpLy85JQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIDEwOTsKICAgICAgICB9ZWxzZSBpZiAobm93IDw9IHN0YXJ0VGltZXN0YW1wICsgMTQwIGRheXMpLy81JQogICAgICAgIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiAxMDU7CiAgICAgICAgfWVsc2UKICAgICAgICB7CiAgICAgICAgICAgIHJldHVybiAxMDA7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHZlcmlmeShhZGRyZXNzIHRyYWRlQ29udHJhY3QpIGNvbnN0YW50IHJldHVybnMgKAogICAgICAgIGJvb2wgICAgdmFsaWQsCiAgICAgICAgYWRkcmVzcyBvd25lciwKICAgICAgICBhZGRyZXNzIGFzc2V0LAogICAgICAgIHVpbnQyNTYgdW5pdHMsCiAgICAgICAgdWludDI1NiBidXlQcmljZSwKICAgICAgICB1aW50MjU2IHNlbGxQcmljZSwKICAgICAgICBib29sICAgIGJ1eXNUb2tlbnMsCiAgICAgICAgYm9vbCAgICBzZWxsc1Rva2VucwogICAgKSAKICAgIHsKICAgICAgICB2YWxpZCA9IF92ZXJpZnlbdHJhZGVDb250cmFjdF07CiAgICAgICAgaWYgKHZhbGlkKSAKICAgICAgICB7CiAgICAgICAgICAgIFRva2VuVHJhZGVyIHQgPSBUb2tlblRyYWRlcih0cmFkZUNvbnRyYWN0KTsKICAgICAgICAgICAgb3duZXIgICAgICAgICA9IHQub3duZXIoKTsKICAgICAgICAgICAgYXNzZXQgICAgICAgICA9IHQuYXNzZXQoKTsKICAgICAgICAgICAgdW5pdHMgICAgICAgICA9IHQudW5pdHMoKTsKICAgICAgICAgICAgYnV5UHJpY2UgICAgICA9IHQuYnV5UHJpY2UoKTsKICAgICAgICAgICAgc2VsbFByaWNlICAgICA9IHQuc2VsbFByaWNlKCk7CiAgICAgICAgICAgIGJ1eXNUb2tlbnMgICAgPSB0LmJ1eXNUb2tlbnMoKTsKICAgICAgICAgICAgc2VsbHNUb2tlbnMgICA9IHQuc2VsbHNUb2tlbnMoKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0VHJhZGVyKHVpbnQyNTYgaWQpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICgKICAgICAgICBib29sICAgIHZhbGlkLAogICAgICAgIGFkZHJlc3MgdHJhZGUsCiAgICAgICAgYWRkcmVzcyBvd25lciwKICAgICAgICBhZGRyZXNzIGFzc2V0LAogICAgICAgIHVpbnQyNTYgdW5pdHMsCiAgICAgICAgdWludDI1NiBidXlQcmljZSwKICAgICAgICB1aW50MjU2IHNlbGxQcmljZSwKICAgICAgICBib29sICAgIGJ1eXNUb2tlbnMsCiAgICAgICAgYm9vbCAgICBzZWxsc1Rva2VucwogICAgKSAKICAgIHsKICAgICAgaWYoaWQgPCBtYWtlcnNDb3VudCkKICAgICAgewogICAgICAgIHRyYWRlID0gX21rc1tpZF07CiAgICAgICAgdmFsaWQgPSBfdmVyaWZ5W3RyYWRlXTsKICAgICAgICBpZiAodmFsaWQpIAogICAgICAgIHsKICAgICAgICAgICAgVG9rZW5UcmFkZXIgdCA9IFRva2VuVHJhZGVyKHRyYWRlKTsKICAgICAgICAgICAgb3duZXIgICAgICAgICA9IHQub3duZXIoKTsKICAgICAgICAgICAgYXNzZXQgICAgICAgICA9IHQuYXNzZXQoKTsKICAgICAgICAgICAgdW5pdHMgICAgICAgICA9IHQudW5pdHMoKTsKICAgICAgICAgICAgYnV5UHJpY2UgICAgICA9IHQuYnV5UHJpY2UoKTsKICAgICAgICAgICAgc2VsbFByaWNlICAgICA9IHQuc2VsbFByaWNlKCk7CiAgICAgICAgICAgIGJ1eXNUb2tlbnMgICAgPSB0LmJ1eXNUb2tlbnMoKTsKICAgICAgICAgICAgc2VsbHNUb2tlbnMgICA9IHQuc2VsbHNUb2tlbnMoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIAogICAgZnVuY3Rpb24gY3JlYXRlVHJhZGVDb250cmFjdCgKICAgICAgICBhZGRyZXNzIGFzc2V0LAogICAgICAgIGFkZHJlc3MgZXhjaGFuZ2UsCiAgICAgICAgdWludDI1NiB1bml0cywKICAgICAgICB1aW50MjU2IGJ1eVByaWNlLAogICAgICAgIHVpbnQyNTYgc2VsbFByaWNlLAogICAgICAgIGJvb2wgICAgYnV5c1Rva2VucywKICAgICAgICBib29sICAgIHNlbGxzVG9rZW5zCiAgICApIHB1YmxpYyByZXR1cm5zIChhZGRyZXNzIHRyYWRlcikgCiAgICB7CiAgICAgICAgcmVxdWlyZSAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPiAxMDAwICogKHVpbnQyNTYoMTApICoqIGRlY2ltYWxzKSk7CiAgICAgICAgcmVxdWlyZSAoYXNzZXQgIT0gMHgwKTsKICAgICAgICByZXF1aXJlKGJ1eVByaWNlID4gMCAmJiBzZWxsUHJpY2UgPiAwKTsKICAgICAgICByZXF1aXJlKGJ1eVByaWNlIDwgc2VsbFByaWNlKTsKICAgICAgICByZXF1aXJlICh1bml0cyAhPSAweDApOwoKICAgICAgICB0cmFkZXIgPSBuZXcgVG9rZW5UcmFkZXIoCiAgICAgICAgICAgIGFzc2V0LAogICAgICAgICAgICBiYXNlb3duZXIsCiAgICAgICAgICAgIGV4Y2hhbmdlLAogICAgICAgICAgICBleGNoRmVlLAogICAgICAgICAgICB1bml0cywKICAgICAgICAgICAgYnV5UHJpY2UsCiAgICAgICAgICAgIHNlbGxQcmljZSwKICAgICAgICAgICAgYnV5c1Rva2VucywKICAgICAgICAgICAgc2VsbHNUb2tlbnMpOwogICAgICAgIF92ZXJpZnlbdHJhZGVyXSA9IHRydWU7CiAgICAgICAgX21rc1ttYWtlcnNDb3VudF0gPSB0cmFkZXI7CiAgICAgICAgbWFrZXJzQ291bnQgPSBtYWtlcnNDb3VudC5hZGQoMSk7CiAgICAgICAgYmFsYW5jZXNbYmFzZW93bmVyXSArPSAxMDAwICogKHVpbnQyNTYoMTApICoqIGRlY2ltYWxzKTsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSAxMDAwICogKHVpbnQyNTYoMTApICoqIGRlY2ltYWxzKTsKICAgICAgICBUb2tlblRyYWRlcih0cmFkZXIpLnRyYW5zZmVyT3duZXJzaGlwKG1zZy5zZW5kZXIpOwogICAgICAgIFRyYWRlTGlzdGluZyhtc2cuc2VuZGVyLCB0cmFkZXIsIGFzc2V0LCBidXlQcmljZSwgc2VsbFByaWNlLCBidXlzVG9rZW5zLCBzZWxsc1Rva2Vucyk7CiAgICB9CgogICAgZnVuY3Rpb24gY2xlYW51cCgpIAogICAgewogICAgICByZXZlcnQoKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIAogICAgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCkgCiAgICB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcmVtYWluaW5nKQogICAgewogICAgICAgIHJldHVybiBzdXBlci5hbGxvd2FuY2UoX293bmVyLCBfc3BlbmRlcik7CiAgICB9Cgp9Cgpjb250cmFjdCBUb2tlblRyYWRlciBpcyBPd25lZCAKewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CiAgICBhZGRyZXNzIHB1YmxpYyBhc3NldDsgICAgICAgLy8gYWRkcmVzcyBvZiB0b2tlbgogICAgYWRkcmVzcyBwdWJsaWMgZXhjaGFuZ2U7ICAgIC8vIGFkZHJlc3Mgb2YgbWV0YSBleGNoYW5nZQogICAgYWRkcmVzcyBwdWJsaWMgYmFzZW93bmVyOyAgIC8vIGFkZHJlc3Mgb2YgbWV0YSBleGNoYW5nZQogICAgdWludDI1NiBwdWJsaWMgdW5pdHM7ICAgICAgIC8vIGZyYWN0aW9uYWxpdHkgb2YgYXNzZXQgdG9rZW4gCiAgICB1aW50MjU2IHB1YmxpYyBidXlQcmljZTsgICAgLy8gY29udHJhY3QgYnV5cyBsb3RzIG9mIHRva2VuIGF0IHRoaXMgcHJpY2UKICAgIHVpbnQyNTYgcHVibGljIHNlbGxQcmljZTsgICAvLyBjb250cmFjdCBzZWxscyBsb3RzIGF0IHRoaXMgcHJpY2UKICAgIHVpbnQyNTYgcHVibGljIGV4Y2hGZWU7ICAgICAvLyBleGNoYW5nZSBmZWUKICAgIGJvb2wgcHVibGljIGJ1eXNUb2tlbnM7ICAgICAvLyBpcyBjb250cmFjdCBidXlpbmcKICAgIGJvb2wgcHVibGljIHNlbGxzVG9rZW5zOyAgICAvLyBpcyBjb250cmFjdCBzZWxsaW5nCiAgICAKICAgIGV2ZW50IEFjdGl2YXRlZEV2ZW50KGJvb2wgYnV5cywgYm9vbCBzZWxscyk7CiAgICBldmVudCBNYWtlckRlcG9zaXRlZEV0aGVyKHVpbnQyNTYgYW1vdW50KTsKICAgIGV2ZW50IE1ha2VyV2l0aGRyZXdBc3NldCh1aW50MjU2IHRva2Vucyk7CiAgICBldmVudCBNYWtlclRyYW5zZmVycmVkQXNzZXQoYWRkcmVzcyB0b1Rva2VuVHJhZGVyLCB1aW50MjU2IHRva2Vucyk7CiAgICBldmVudCBNYWtlcldpdGhkcmV3RVJDMjBUb2tlbihhZGRyZXNzIHRva2VuQWRkcmVzcywgdWludDI1NiB0b2tlbnMpOwogICAgZXZlbnQgTWFrZXJXaXRoZHJld0V0aGVyKHVpbnQyNTYgZXRoZXJzKTsKICAgIGV2ZW50IE1ha2VyVHJhbnNmZXJyZWRFdGhlcihhZGRyZXNzIHRvVG9rZW5UcmFkZXIsIHVpbnQyNTYgZXRoZXJzKTsKICAgIGV2ZW50IFRha2VyQm91Z2h0QXNzZXQoYWRkcmVzcyBpbmRleGVkIGJ1eWVyLCB1aW50MjU2IGV0aGVyc1NlbnQsIHVpbnQyNTYgZXRoZXJzUmV0dXJuZWQsIHVpbnQyNTYgdG9rZW5zQm91Z2h0KTsKICAgIGV2ZW50IFRha2VyU29sZEFzc2V0KGFkZHJlc3MgaW5kZXhlZCBzZWxsZXIsIHVpbnQyNTYgYW1vdW50T2ZUb2tlbnNUb1NlbGwsIHVpbnQyNTYgdG9rZW5zU29sZCwgdWludDI1NiBldGhlclZhbHVlT2ZUb2tlbnNTb2xkKTsKCiAgICAvLyBDb25zdHJ1Y3RvciAtIG9ubHkgdG8gYmUgY2FsbGVkIGJ5IHRoZSBUb2tlblRyYWRlckZhY3RvcnkgY29udHJhY3QKICAgIGZ1bmN0aW9uIFRva2VuVHJhZGVyICgKICAgICAgICBhZGRyZXNzIF9hc3NldCwKICAgICAgICBhZGRyZXNzIF9iYXNlb3duZXIsCiAgICAgICAgYWRkcmVzcyBfZXhjaGFuZ2UsCiAgICAgICAgdWludDI1NiBfZXhjaEZlZSwKICAgICAgICB1aW50MjU2IF91bml0cywKICAgICAgICB1aW50MjU2IF9idXlQcmljZSwKICAgICAgICB1aW50MjU2IF9zZWxsUHJpY2UsCiAgICAgICAgYm9vbCAgICBfYnV5c1Rva2VucywKICAgICAgICBib29sICAgIF9zZWxsc1Rva2VucwogICAgKSAKICAgIHsKICAgICAgICBhc3NldCAgICAgICA9IF9hc3NldDsKICAgICAgICB1bml0cyAgICAgICA9IF91bml0czsKICAgICAgICBidXlQcmljZSAgICA9IF9idXlQcmljZTsKICAgICAgICBiYXNlb3duZXIgICA9IF9iYXNlb3duZXI7CiAgICAgICAgZXhjaGFuZ2UgICAgPSBfZXhjaGFuZ2U7CiAgICAgICAgZXhjaEZlZSAgICAgPSBfZXhjaEZlZTsKICAgICAgICBzZWxsUHJpY2UgICA9IF9zZWxsUHJpY2U7CiAgICAgICAgYnV5c1Rva2VucyAgPSBfYnV5c1Rva2VuczsKICAgICAgICBzZWxsc1Rva2VucyA9IF9zZWxsc1Rva2VuczsKICAgICAgICBBY3RpdmF0ZWRFdmVudChidXlzVG9rZW5zLCBzZWxsc1Rva2Vucyk7CiAgICB9CgogICAgZnVuY3Rpb24gYWN0aXZhdGUgKAogICAgICAgIGFkZHJlc3MgX2Fzc2V0LAogICAgICAgIHVpbnQyNTYgX3VuaXRzLAogICAgICAgIHVpbnQyNTYgX2J1eVByaWNlLAogICAgICAgIHVpbnQyNTYgX3NlbGxQcmljZSwKICAgICAgICBib29sICAgIF9idXlzVG9rZW5zLAogICAgICAgIGJvb2wgICAgX3NlbGxzVG9rZW5zCiAgICApIG9ubHlPd25lciAKICAgIHsKICAgICAgICByZXF1aXJlKEVSQzIwKGV4Y2hhbmdlKS5hcHByb3ZlKGJhc2Vvd25lcixleGNoRmVlKSk7CiAgICAgICAgcmVxdWlyZShFUkMyMChleGNoYW5nZSkudHJhbnNmZXIoYmFzZW93bmVyLGV4Y2hGZWUpKTsKICAgICAgICBhc3NldCAgICAgICA9IF9hc3NldDsKICAgICAgICB1bml0cyAgICAgICA9IF91bml0czsKICAgICAgICBidXlQcmljZSAgICA9IF9idXlQcmljZTsKICAgICAgICBzZWxsUHJpY2UgICA9IF9zZWxsUHJpY2U7CiAgICAgICAgYnV5c1Rva2VucyAgPSBfYnV5c1Rva2VuczsKICAgICAgICBzZWxsc1Rva2VucyA9IF9zZWxsc1Rva2VuczsKICAgICAgICBBY3RpdmF0ZWRFdmVudChidXlzVG9rZW5zLCBzZWxsc1Rva2Vucyk7CiAgICB9CgogICAgZnVuY3Rpb24gbWFrZXJEZXBvc2l0RXRoZXIoKSBwYXlhYmxlIG9ubHlPd25lciAKICAgIHsKICAgICAgICByZXF1aXJlKEVSQzIwKGV4Y2hhbmdlKS5hcHByb3ZlKGJhc2Vvd25lcixleGNoRmVlKSk7CiAgICAgICAgcmVxdWlyZShFUkMyMChleGNoYW5nZSkudHJhbnNmZXIoYmFzZW93bmVyLGV4Y2hGZWUpKTsKICAgICAgICBNYWtlckRlcG9zaXRlZEV0aGVyKG1zZy52YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gbWFrZXJXaXRoZHJhd0Fzc2V0KHVpbnQyNTYgdG9rZW5zKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBvaykgCiAgICB7CiAgICAgICAgcmVxdWlyZShFUkMyMChleGNoYW5nZSkuYXBwcm92ZShiYXNlb3duZXIsZXhjaEZlZSkpOwogICAgICAgIHJlcXVpcmUoRVJDMjAoZXhjaGFuZ2UpLnRyYW5zZmVyKGJhc2Vvd25lcixleGNoRmVlKSk7CiAgICAgICAgTWFrZXJXaXRoZHJld0Fzc2V0KHRva2Vucyk7CiAgICAgICAgRVJDMjAoYXNzZXQpLmFwcHJvdmUob3duZXIsIHRva2Vucyk7CiAgICAgICAgcmV0dXJuIEVSQzIwKGFzc2V0KS50cmFuc2Zlcihvd25lciwgdG9rZW5zKTsKICAgIH0KCiAgICBmdW5jdGlvbiBtYWtlclRyYW5zZmVyQXNzZXQoCiAgICAgICAgVG9rZW5UcmFkZXIgdG9Ub2tlblRyYWRlciwKICAgICAgICB1aW50MjU2IHRva2VucwogICAgKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBvaykgCiAgICB7CiAgICAgICAgcmVxdWlyZSAob3duZXIgPT0gdG9Ub2tlblRyYWRlci5vd25lcigpIHx8IGFzc2V0ID09IHRvVG9rZW5UcmFkZXIuYXNzZXQoKSk7IAogICAgICAgIHJlcXVpcmUoRVJDMjAoZXhjaGFuZ2UpLmFwcHJvdmUoYmFzZW93bmVyLGV4Y2hGZWUpKTsKICAgICAgICByZXF1aXJlKEVSQzIwKGV4Y2hhbmdlKS50cmFuc2ZlcihiYXNlb3duZXIsZXhjaEZlZSkpOwogICAgICAgIE1ha2VyVHJhbnNmZXJyZWRBc3NldCh0b1Rva2VuVHJhZGVyLCB0b2tlbnMpOwogICAgICAgIEVSQzIwKGFzc2V0KS5hcHByb3ZlKHRvVG9rZW5UcmFkZXIsdG9rZW5zKTsKICAgICAgICByZXR1cm4gRVJDMjAoYXNzZXQpLnRyYW5zZmVyKHRvVG9rZW5UcmFkZXIsIHRva2Vucyk7CiAgICB9CgogICAgZnVuY3Rpb24gbWFrZXJXaXRoZHJhd0VSQzIwVG9rZW4oCiAgICAgICAgYWRkcmVzcyB0b2tlbkFkZHJlc3MsCiAgICAgICAgdWludDI1NiB0b2tlbnMKICAgICkgb25seU93bmVyIHJldHVybnMgKGJvb2wgb2spIAogICAgewogICAgICAgIHJlcXVpcmUoRVJDMjAoZXhjaGFuZ2UpLmFwcHJvdmUoYmFzZW93bmVyLGV4Y2hGZWUpKTsKICAgICAgICByZXF1aXJlKEVSQzIwKGV4Y2hhbmdlKS50cmFuc2ZlcihiYXNlb3duZXIsZXhjaEZlZSkpOwogICAgICAgIE1ha2VyV2l0aGRyZXdFUkMyMFRva2VuKHRva2VuQWRkcmVzcywgdG9rZW5zKTsKICAgICAgICBFUkMyMCh0b2tlbkFkZHJlc3MpLmFwcHJvdmUob3duZXIsIHRva2Vucyk7CiAgICAgICAgcmV0dXJuIEVSQzIwKHRva2VuQWRkcmVzcykudHJhbnNmZXIob3duZXIsIHRva2Vucyk7CiAgICB9CgogICAgZnVuY3Rpb24gbWFrZXJXaXRoZHJhd0V0aGVyKHVpbnQyNTYgZXRoZXJzKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBvaykgCiAgICB7CiAgICAgICAgaWYgKHRoaXMuYmFsYW5jZSA+PSBldGhlcnMpIAogICAgICAgIHsKICAgICAgICAgICAgcmVxdWlyZShFUkMyMChleGNoYW5nZSkuYXBwcm92ZShiYXNlb3duZXIsZXhjaEZlZSkpOwogICAgICAgICAgICByZXF1aXJlKEVSQzIwKGV4Y2hhbmdlKS50cmFuc2ZlcihiYXNlb3duZXIsZXhjaEZlZSkpOwogICAgICAgICAgICBNYWtlcldpdGhkcmV3RXRoZXIoZXRoZXJzKTsKICAgICAgICAgICAgcmV0dXJuIG93bmVyLnNlbmQoZXRoZXJzKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gbWFrZXJUcmFuc2ZlckV0aGVyKAogICAgICAgIFRva2VuVHJhZGVyIHRvVG9rZW5UcmFkZXIsCiAgICAgICAgdWludDI1NiBldGhlcnMKICAgICkgb25seU93bmVyIHJldHVybnMgKGJvb2wpIAogICAgewogICAgICAgIHJlcXVpcmUgKG93bmVyID09IHRvVG9rZW5UcmFkZXIub3duZXIoKSB8fCBhc3NldCA9PSB0b1Rva2VuVHJhZGVyLmFzc2V0KCkpOyAKICAgICAgICByZXF1aXJlKEVSQzIwKGV4Y2hhbmdlKS5hcHByb3ZlKGJhc2Vvd25lcixleGNoRmVlKSk7CiAgICAgICAgcmVxdWlyZShFUkMyMChleGNoYW5nZSkudHJhbnNmZXIoYmFzZW93bmVyLGV4Y2hGZWUpKTsKICAgICAgICBpZiAodGhpcy5iYWxhbmNlID49IGV0aGVycykgCiAgICAgICAgewogICAgICAgICAgICBNYWtlclRyYW5zZmVycmVkRXRoZXIodG9Ub2tlblRyYWRlciwgZXRoZXJzKTsKICAgICAgICAgICAgdG9Ub2tlblRyYWRlci5tYWtlckRlcG9zaXRFdGhlci52YWx1ZShldGhlcnMpKCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHRha2VyQnV5QXNzZXQoKSBwYXlhYmxlIAogICAgewogICAgICAgIGlmIChzZWxsc1Rva2VucyB8fCBtc2cuc2VuZGVyID09IG93bmVyKSAKICAgICAgICB7CiAgICAgICAgICAgIHJlcXVpcmUoRVJDMjAoZXhjaGFuZ2UpLmFwcHJvdmUoYmFzZW93bmVyLGV4Y2hGZWUpKTsKICAgICAgICAgICAgcmVxdWlyZShFUkMyMChleGNoYW5nZSkudHJhbnNmZXIoYmFzZW93bmVyLGV4Y2hGZWUpKTsKICAgICAgICAgICAgdWludDI1NiBvcmRlciAgICA9ICBtc2cudmFsdWUgLyBzZWxsUHJpY2U7ICAgICAgICAgICAgICAgICAgICAgICAgLy8vbWF4IHRva2VucyBpbiBvcmRlcgogICAgICAgICAgICB1aW50MjU2IGNhbl9zZWxsID0gIEVSQzIwKGFzc2V0KS5iYWxhbmNlT2YoYWRkcmVzcyh0aGlzKSkvdW5pdHM7ICAvLy9jdXJyZW50IGJhbGFuY2UgaW4gdG9rZW4KICAgICAgICAgICAgdWludDI1NiBjaGFuZ2UgPSAwOwogICAgICAgICAgICBpZiAobXNnLnZhbHVlID4gKGNhbl9zZWxsICogc2VsbFByaWNlKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY2hhbmdlICA9IG1zZy52YWx1ZSAtIChjYW5fc2VsbCAqIHNlbGxQcmljZSk7CiAgICAgICAgICAgICAgICBvcmRlciA9IGNhbl9zZWxsOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChjaGFuZ2UgPiAwKSAKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyLnNlbmQoY2hhbmdlKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKG9yZGVyID4gMCkgCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHJlcXVpcmUgKEVSQzIwKGFzc2V0KS5hcHByb3ZlKG1zZy5zZW5kZXIsIG9yZGVyICogdW5pdHMpKTsKICAgICAgICAgICAgICAgIHJlcXVpcmUgKEVSQzIwKGFzc2V0KS50cmFuc2Zlcihtc2cuc2VuZGVyLCBvcmRlciAqIHVuaXRzKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgVGFrZXJCb3VnaHRBc3NldChtc2cuc2VuZGVyLCBtc2cudmFsdWUsIGNoYW5nZSwgb3JkZXIgKiB1bml0cyk7CiAgICAgICAgfQogICAgICAgIGVsc2UgcmVxdWlyZSAobXNnLnNlbmRlci5zZW5kKG1zZy52YWx1ZSkpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRha2VyU2VsbEFzc2V0KHVpbnQyNTYgYW1vdW50T2ZUb2tlbnNUb1NlbGwpIHB1YmxpYyAgCiAgICB7CiAgICAgICAgaWYgKGJ1eXNUb2tlbnMgfHwgbXNnLnNlbmRlciA9PSBvd25lcikgCiAgICAgICAgewogICAgICAgICAgICByZXF1aXJlKEVSQzIwKGV4Y2hhbmdlKS5hcHByb3ZlKGJhc2Vvd25lcixleGNoRmVlKSk7CiAgICAgICAgICAgIHJlcXVpcmUoRVJDMjAoZXhjaGFuZ2UpLnRyYW5zZmVyKGJhc2Vvd25lcixleGNoRmVlKSk7CiAgICAgICAgICAgIHVpbnQyNTYgY2FuX2J1eSA9IHRoaXMuYmFsYW5jZSAvIGJ1eVByaWNlOyAgICAgICAgICAvL2xpbWl0IG9mIGV0aGVycyAKICAgICAgICAgICAgdWludDI1NiBvcmRlciA9IGFtb3VudE9mVG9rZW5zVG9TZWxsIC8gdW5pdHM7ICAgICAgIC8vbGltaXQgb2YgdG9rZW5zIHRvIHNlbGwKICAgICAgICAgICAgaWYgKG9yZGVyID4gY2FuX2J1eSkgb3JkZXIgPSBjYW5fYnV5OwogICAgICAgICAgICBpZiAob3JkZXIgPiAwKSAKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcmVxdWlyZShFUkMyMChhc3NldCkudHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIGFkZHJlc3ModGhpcyksIG9yZGVyICogdW5pdHMpKTsKICAgICAgICAgICAgICAgIHJlcXVpcmUobXNnLnNlbmRlci5zZW5kKG9yZGVyICogYnV5UHJpY2UpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBUYWtlclNvbGRBc3NldChtc2cuc2VuZGVyLCBhbW91bnRPZlRva2Vuc1RvU2VsbCwgb3JkZXIgKiB1bml0cywgYnV5UHJpY2UgKiB1bml0cyk7CiAgICAgICAgfQogICAgfQogICAgZnVuY3Rpb24gKCkgcGF5YWJsZSAKICAgIHsKICAgICAgICB0YWtlckJ1eUFzc2V0KCk7CiAgICB9Cn0='.
	

]
