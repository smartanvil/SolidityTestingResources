Class {
	#name : #SRT192eb1a97aee2b87c924dc2b8d8eb914dcb5f87f,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT192eb1a97aee2b87c924dc2b8d8eb914dcb5f87f >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCgoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9CgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogIC8qKgogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cgp9CgoKLyoqCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbgogKgogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgaW50ZXJuYWwgYWxsb3dlZDsKCgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1tfZnJvbV0pOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0pOwoKICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAqCiAgICogQmV3YXJlIHRoYXQgY2hhbmdpbmcgYW4gYWxsb3dhbmNlIHdpdGggdGhpcyBtZXRob2QgYnJpbmdzIHRoZSByaXNrIHRoYXQgc29tZW9uZSBtYXkgdXNlIGJvdGggdGhlIG9sZAogICAqIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZSB0cmFuc2FjdGlvbiBvcmRlcmluZy4gT25lIHBvc3NpYmxlIHNvbHV0aW9uIHRvIG1pdGlnYXRlIHRoaXMKICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KCiAgLyoqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgfSBlbHNlIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBCdXJuYWJsZSBUb2tlbgogKiBAZGV2IFRva2VuIHRoYXQgY2FuIGJlIGlycmV2ZXJzaWJseSBidXJuZWQgKGRlc3Ryb3llZCkuCiAqLwpjb250cmFjdCBCdXJuYWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4gewoKICAgIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IEJVUk5fQUREUkVTUyA9IDA7CgogICAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgYnVybmVyLCB1aW50MjU2IHZhbHVlKTsKCgkKCWZ1bmN0aW9uIGJ1cm5Ub2tlbnNJbnRlcm5hbChhZGRyZXNzIF9hZGRyZXNzLCB1aW50MjU2IF92YWx1ZSkgaW50ZXJuYWwgewogICAgICAgIHJlcXVpcmUoX3ZhbHVlID4gMCk7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2FkZHJlc3NdKTsKICAgICAgICAvLyBubyBuZWVkIHRvIHJlcXVpcmUgdmFsdWUgPD0gdG90YWxTdXBwbHksIHNpbmNlIHRoYXQgd291bGQgaW1wbHkgdGhlCiAgICAgICAgLy8gc2VuZGVyJ3MgYmFsYW5jZSBpcyBncmVhdGVyIHRoYW4gdGhlIHRvdGFsU3VwcGx5LCB3aGljaCAqc2hvdWxkKiBiZSBhbiBhc3NlcnRpb24gZmFpbHVyZQoKICAgICAgICBhZGRyZXNzIGJ1cm5lciA9IF9hZGRyZXNzOwogICAgICAgIGJhbGFuY2VzW2J1cm5lcl0gPSBiYWxhbmNlc1tidXJuZXJdLnN1YihfdmFsdWUpOwogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuc3ViKF92YWx1ZSk7CiAgICAgICAgQnVybihidXJuZXIsIF92YWx1ZSk7CgkJVHJhbnNmZXIoYnVybmVyLCBCVVJOX0FERFJFU1MsIF92YWx1ZSk7CgkJCgl9CgkJCn0KCi8qKgogKiBAdGl0bGUgSGFuZGVsaW9uIFRva2VuCiAqIEBkZXYgTWFpbiB0b2tlbiB1c2VkIGZvciBIYW5kZWxpb24gY3Jvd2RzYWxlCiAqLwogY29udHJhY3QgSElPTlRva2VuIGlzIEJ1cm5hYmxlVG9rZW4sIE93bmFibGUKIHsKCQoJLyoqIEhhbmRlbGlvbiB0b2tlbiBuYW1lIG9mZmljaWFsIG5hbWUuICovCglzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiSElPTiBUb2tlbiBieSBIYW5kZWxpb24iOyAKCSAKCSAvKiogSGFuZGVsaW9uIHRva2VuIG9mZmljaWFsIHN5bWJvbC4qLwoJc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiSElPTiI7IAoKCS8qKiBOdW1iZXIgb2YgZGVjaW1hbCB1bml0cyBmb3IgSGFuZGVsaW9uIHRva2VuICovCgl1aW50MjU2IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwoKCS8qIFByZWlzc3VlZCB0b2tlbiBhbW91bnQgKi8KCXVpbnQyNTYgcHVibGljIGNvbnN0YW50IFBSRUlTU1VFRF9BTU9VTlQgPSAyOTc1MDAwMCAqIDEgZXRoZXI7CgkJCQoJLyoqIAoJICogSW5kaWNhdGVzIHdoZWF0aGVyIHRva2VuIHRyYW5zZmVyIGlzIGFsbG93ZWQuIFRva2VuIHRyYW5zZmVyIGlzIGFsbG93ZWQgYWZ0ZXIgY3Jvd2RzYWxlIGlzIG92ZXIuIAoJICogQmVmb3JlIGNyb3dkc2FsZSBpcyBvdmVyIG9ubHkgdG9rZW4gb3duZXIgaXMgYWxsb3dlZCB0byB0cmFuc2ZlciB0b2tlbnMgdG8gaW52ZXN0b3JzLgoJICovCglib29sIHB1YmxpYyB0cmFuc2ZlckFsbG93ZWQgPSBmYWxzZTsKCQkJCgkvKiogUmFpc2VzIHdoZW4gaW5pdGlhbCBhbW91bnQgb2YgdG9rZW5zIGlzIHByZWlzc3VlZCAqLwoJZXZlbnQgTG9nVG9rZW5QcmVpc3N1ZWQoYWRkcmVzcyBvd25lcmVBZGRyZXNzLCB1aW50MjU2IGFtb3VudCk7CgkKCQoJbW9kaWZpZXIgY2FuVHJhbnNmZXIoYWRkcmVzcyBzZW5kZXIpCgl7CgkJcmVxdWlyZSh0cmFuc2ZlckFsbG93ZWQgfHwgc2VuZGVyID09IG93bmVyKTsKCQkKCQlfOwoJfQoJCgkvKioKCSAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIEhhbmRlbGlvbiB0b2tlbgoJICovCglmdW5jdGlvbiBISU9OVG9rZW4oKQoJewoJCS8vIEFkZHJlc3Mgb2YgdG9rZW4gY3JlYXRvci4gVGhlIGNyZWF0b3Igb2YgdGhpcyB0b2tlbiBpcyBtYWpvciBob2xkZXIgb2YgYWxsIHByZWlzc3VlZCB0b2tlbnMgYmVmb3JlIGNyb3dkc2FsZSBzdGFydHMKCQlvd25lciA9IG1zZy5zZW5kZXI7CgkgCgkJLy8gU2VuZCBhbGwgcHJlLWNyZWF0ZWQgdG9rZW5zIHRvIHRva2VuIGNyZWF0b3IgYWRkcmVzcwoJCXRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKFBSRUlTU1VFRF9BTU9VTlQpOwoJCWJhbGFuY2VzW293bmVyXSA9IGJhbGFuY2VzW293bmVyXS5hZGQoUFJFSVNTVUVEX0FNT1VOVCk7CgkJCgkJTG9nVG9rZW5QcmVpc3N1ZWQob3duZXIsIFBSRUlTU1VFRF9BTU9VTlQpOwoJfQoJCgkvKioKCSAqIFJldHVybnMgVG9rZW4gY3JlYXRvciBhZGRyZXNzCgkgKi8KCWZ1bmN0aW9uIGdldENyZWF0b3JBZGRyZXNzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMoYWRkcmVzcyBjcmVhdG9yQWRkcmVzcykKCXsKCQlyZXR1cm4gb3duZXI7Cgl9CgkKCS8qKgoJICogR2V0cyB0b3RhbCBzdXBwbHkgb2YgSGFuZGVsaW9uIHRva2VuCgkgKi8KCWZ1bmN0aW9uIGdldFRvdGFsU3VwcGx5KCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludDI1NikKCXsKCQlyZXR1cm4gdG90YWxTdXBwbHk7Cgl9CgkKCS8qKgoJICogR2V0cyBudW1iZXIgb2YgcmVtYWluaW5nIHRva2VucwoJICovCglmdW5jdGlvbiBnZXRSZW1haW5pbmdUb2tlbnMoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KQoJewoJCXJldHVybiBiYWxhbmNlT2Yob3duZXIpOwoJfQkKCQoJLyoqCgkgKiBBbGxvd3MgdG9rZW4gdHJhbnNmZXIuIFNob3VsZCBiZSBjYWxsZWQgYWZ0ZXIgY3Jvd2RzYWxlIGlzIG92ZXIKCSAqLwoJZnVuY3Rpb24gYWxsb3dUcmFuc2ZlcigpIG9ubHlPd25lciBwdWJsaWMKCXsKCQl0cmFuc2ZlckFsbG93ZWQgPSB0cnVlOwoJfQoJCgkKCS8qKgoJICogT3ZlcnJpZGVzIHRyYW5zZmVyIGZ1bmN0aW9uIGJ5IGFkZGluZyBjaGVjayB3aGV0aGVyIHRyYW5zZmVyIGlzIGFsbHdlZAoJICovCglmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIGNhblRyYW5zZmVyKG1zZy5zZW5kZXIpIHB1YmxpYyByZXR1cm5zIChib29sKQkKCXsKCQlzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7Cgl9CgoJLyoqCgkgKiBPdmVycmlkZSB0cmFuc2ZlckZyb20gZnVuY3Rpb24gYW5kIGFkZHMgYSBjaGVjayB3aGV0aGVyIHRyYW5zZmVyIGlzIGFsbHdlZAoJICovCglmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBjYW5UcmFuc2ZlcihfZnJvbSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsJCgkJc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7Cgl9CgkKCS8qKgogICAgICogQGRldiBCdXJucyBhIHNwZWNpZmljIGFtb3VudCBvZiB0b2tlbnMuCiAgICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgYnVybmVkLgogICAgICovCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgewoJCWJ1cm5Ub2tlbnNJbnRlcm5hbChtc2cuc2VuZGVyLCBfdmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBCdXJucyBhIHNwZWNpZmljIGFtb3VudCBvZiB0b2tlbnMgZm9yIHNwZWNpZmljIGFkZHJlc3MuIENhbiBiZSBjYWxsZWQgb25seSBieSB0b2tlbiBvd25lci4KCSAqIEBwYXJhbSBfYWRkcmVzcyAKICAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbiB0byBiZSBidXJuZWQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJ1cm4oYWRkcmVzcyBfYWRkcmVzcywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyBvbmx5T3duZXIgewoJCWJ1cm5Ub2tlbnNJbnRlcm5hbChfYWRkcmVzcywgX3ZhbHVlKTsKICAgIH0KfQoKLyoKICogU3RvcHBhYmxlCiAqCiAqIEFic3RyYWN0IGNvbnRyYWN0IHRoYXQgYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbgogKiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uCiAqCiAqCiAqLwpjb250cmFjdCBTdG9wcGFibGUgaXMgT3duYWJsZSB7CiAgYm9vbCBwdWJsaWMgc3RvcHBlZDsKCiAgbW9kaWZpZXIgc3RvcEluRW1lcmdlbmN5IHsKICAgIHJlcXVpcmUoIXN0b3BwZWQpOwogICAgXzsKICB9CgogIG1vZGlmaWVyIHN0b3BOb25Pd25lcnNJbkVtZXJnZW5jeSB7CiAgICByZXF1aXJlKCFzdG9wcGVkIHx8IG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgogIG1vZGlmaWVyIG9ubHlJbkVtZXJnZW5jeSB7CiAgICByZXF1aXJlKHN0b3BwZWQpOwogICAgXzsKICB9CgogIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW1lcmdlbmN5LCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlCiAgZnVuY3Rpb24gc3RvcCgpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICBzdG9wcGVkID0gdHJ1ZTsKICB9CgogIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW5kIG9mIGVtZXJnZW5jeSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICBmdW5jdGlvbiB1bnN0b3AoKSBleHRlcm5hbCBvbmx5T3duZXIgb25seUluRW1lcmdlbmN5IHsKICAgIHN0b3BwZWQgPSBmYWxzZTsKICB9Cgp9CgovKioKICogSGFuZGVsaW9uIElDTyBjcm93ZHNhbGUuCiAqIAogKi8KY29udHJhY3QgSEFOREVMSU9OZGlzY291bnRTQUxFIGlzIE93bmFibGUsIFN0b3BwYWJsZQp7Cgl1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCglzdHJ1Y3QgRnVuZGluZ1RpZXIgewoJCXVpbnQyNTYgY2FwOwoJCXVpbnQyNTYgcmF0ZTsKCX0KCQkKCS8qKiBIYW5kZWxpb24gdG9rZW4gd2UgYXJlIHNlbGxpbmcgaW4gdGhpcyBjcm93ZHNhbGUgKi8KCUhJT05Ub2tlbiBwdWJsaWMgdG9rZW47IAoJCgkvKiogVG9rZW4gcHJpY2UgdGllcnMgYW5kIGNhcHMgKi8KCUZ1bmRpbmdUaWVyIHB1YmxpYyB0aWVyMTsKCQoJRnVuZGluZ1RpZXIgcHVibGljIHRpZXIyOwoJCglGdW5kaW5nVGllciBwdWJsaWMgdGllcjM7CgkKCUZ1bmRpbmdUaWVyIHB1YmxpYyB0aWVyNDsKCQoJRnVuZGluZ1RpZXIgcHVibGljIHRpZXI1OwkKCgkvKiogaW5jbHVzaXZlIHN0YXJ0IHRpbWVzdGFtcHMgb2YgY3Jvd2RzYWxlICovCgl1aW50MjU2IHB1YmxpYyBzdGFydFRpbWU7CgoJLyoqIGluY2x1c2l2ZSBlbmQgdGltZXN0YW1wIG9mIGNyb3dlZHNhbGUgKi8KCXVpbnQyNTYgcHVibGljIGVuZFRpbWU7CgoJLyoqIGFkZHJlc3Mgd2hlcmUgZnVuZHMgYXJlIGNvbGxlY3RlZCAqLwoJYWRkcmVzcyBwdWJsaWMgbXVsdGlzaWdXYWxsZXQ7CgkKCS8qKiBtaW5pbWFsIGFtb3VudCBvZiBzb2xkIHRva2VucyBmb3IgY3Jvd2RzYWxlIHRvIGJlIGNvbnNpZGVyZWQgYXMgc3VjY2Vzc2Z1bCAqLwoJdWludDI1NiBwdWJsaWMgbWluaW11bVRva2VuQW1vdW50OwoKCS8qKiBtYXhpbWFsIG51bWJlciBvZiB0b2tlbnMgd2UgY2FuIHNlbGwgKi8KCXVpbnQyNTYgcHVibGljIG1heGltdW1Ub2tlbkFtb3VudDsKCgkvLyBhbW91bnQgb2YgcmFpc2VkIG1vbmV5IGluIHdlaQoJdWludDI1NiBwdWJsaWMgd2VpUmFpc2VkOwoKCS8qKiBhbW91bnQgb2Ygc29sZCB0b2tlbnMgKi8KCXVpbnQyNTYgcHVibGljIHRva2Vuc1NvbGQ7CgoJLyoqIG51bWJlciBvZiB1bmlxdWUgaW52ZXN0b3JzICovCgl1aW50IHB1YmxpYyBpbnZlc3RvckNvdW50OwoKCS8qKiBJZGVudGlmaWVzIHdoZXRoZXIgY3Jvd2RzYWxlIGhhcyBiZWVuIGZpbmFsaXplZCAqLwoJYm9vbCBwdWJsaWMgZmluYWxpemVkOwoKCS8qKiBJZGVudGlmaWVzIHdoZWF0aGVyIHJlZnVuZCBpcyBvcGVuZWQgKi8KCWJvb2wgcHVibGljIGlzUmVmdW5kaW5nOwoKCS8qKiBBbW91bnQgb2YgcmVjZWl2ZWQgRVRIIGJ5IGludmVzdG9yICovCgltYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBpbnZlc3RlZEFtb3VudE9mOwoKCS8qKiBBbW91bnQgb2Ygc2VsbGVkIHRva2VucyBieSBpbnZlc3RvciAqLwoJbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgdG9rZW5BbW91bnRPZjsKCQoJLyoqCgkqIGV2ZW50IGZvciB0b2tlbiBwdXJjaGFzZSBsb2dnaW5nCgkqIEBwYXJhbSBwdXJjaGFzZXIgd2hvIHBhaWQgZm9yIHRoZSB0b2tlbnMKCSogQHBhcmFtIGJlbmVmaWNpYXJ5IHdobyBnb3QgdGhlIHRva2VucwoJKiBAcGFyYW0gdmFsdWUgd2VpcyBwYWlkIGZvciBwdXJjaGFzZQoJKiBAcGFyYW0gYW1vdW50IGFtb3VudCBvZiB0b2tlbnMgcHVyY2hhc2VkCgkqLwoJZXZlbnQgTG9nVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgdmFsdWUsIHVpbnQyNTYgYW1vdW50KTsKCglldmVudCBMb2dDcm93ZHNhbGVTdGFydGVkKCk7CgoJZXZlbnQgTG9nQ3Jvd2RzYWxlRmluYWxpemVkKGJvb2wgaXNHb2FsUmVhY2hlZCk7CgoJZXZlbnQgTG9nUmVmdW5kaW5nT3BlbmVkKHVpbnQyNTYgcmVmdW5kQW1vdW50KTsKCglldmVudCBMb2dJbnZlc3RvclJlZnVuZGVkKGFkZHJlc3MgaW52ZXN0b3JBZGRyZXNzLCB1aW50MjU2IHJlZnVuZGVkQW1vdW50KTsKCQoJLyoqCgkgKiBTdGFydCBkYXRlOiAwOC0xMi0yMDE3IDEyOjAwIEdNVAoJICogRW5kIGRhdGU6IDMxLTAzLTIwMTggMTI6MDAgR01UCgkgKi8KCWZ1bmN0aW9uIEhBTkRFTElPTmRpc2NvdW50U0FMRSgpIAoJewoJCWNyZWF0ZVRva2VuQ29udHJhY3QoKTsKCQkKCQlzdGFydFRpbWUgPSAxNTEyNzM0NDAwOwoJCWVuZFRpbWUgPSAxNTIyNDk3NjAwOwoKCQltdWx0aXNpZ1dhbGxldCA9IDB4N0UyM2NGYTA1MGQyM0I5NzA2YTA3MWRFZDBBNjJkMzBBRTZCQjZjODsKCQkKCQltaW5pbXVtVG9rZW5BbW91bnQgPSA0ODMwOTg4ICogMSBldGhlcjsKCQltYXhpbXVtVG9rZW5BbW91bnQgPSAyOTc1MDAwMCAqIDEgZXRoZXI7CgoJCXRva2Vuc1NvbGQgPSAwOwoJCXdlaVJhaXNlZCA9IDA7CgoJCXRpZXIxID0gRnVuZGluZ1RpZXIoe2NhcDogMjA4MTMzOCAqIDEgZXRoZXIsIHJhdGU6IDQ4MH0pOwoJCXRpZXIyID0gRnVuZGluZ1RpZXIoe2NhcDogNDgzMDk4OCAqIDEgZXRoZXIsIHJhdGU6IDQ2MH0pOwoJCXRpZXIzID0gRnVuZGluZ1RpZXIoe2NhcDogOTgzMDk4OCAqIDEgZXRoZXIsIHJhdGU6IDQ0MH0pOwoJCXRpZXI0ID0gRnVuZGluZ1RpZXIoe2NhcDogMTQ4MzA5ODggKiAxIGV0aGVyLCByYXRlOiA0MjB9KTsKCQl0aWVyNSA9IEZ1bmRpbmdUaWVyKHtjYXA6IDIzMTg0NzM4ICogMSBldGhlciwgcmF0ZTogNDAwfSk7CgoJCWZpbmFsaXplZCA9IGZhbHNlOwoJfQoJCgkgCgkvKioKCSAqIE92ZXJyaWRpbmcgZnVuY3Rpb24gdG8gY3JlYXRlIEhhbmRlbGlvblRva2VuCgkgKi8KCWZ1bmN0aW9uIGNyZWF0ZVRva2VuQ29udHJhY3QoKSBpbnRlcm5hbAoJewoJCXRva2VuID0gSElPTlRva2VuKDB4YTA4OTI3MzcyNGUwNzY0NGRhOTczOWE3MDhlNTQ0ODAwZDkyNTExNSk7Cgl9CgkKCWZ1bmN0aW9uIGNhbGN1bGF0ZVRpZXJUb2tlbnMoRnVuZGluZ1RpZXIgX3RpZXIsIHVpbnQyNTYgX2Ftb3VudCwgdWludDI1NiBfY3VycmVudFRva2VuQW1vdW50KSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KQoJewoJCXVpbnQyNTYgbWF4VGllclRva2VucyA9IF90aWVyLmNhcC5zdWIoX2N1cnJlbnRUb2tlbkFtb3VudCk7CgoJCWlmIChtYXhUaWVyVG9rZW5zIDw9IDApCgkJewoJCQlyZXR1cm4gMDsKCQl9CgkJCQkKCQl1aW50MjU2IHRva2VuQ291bnQgPSBfYW1vdW50Lm11bChfdGllci5yYXRlKTsKCQkJCgkJaWYgKHRva2VuQ291bnQgPiBtYXhUaWVyVG9rZW5zKQoJCXsKCQkJdG9rZW5Db3VudCA9IG1heFRpZXJUb2tlbnM7CgkJfQoJCQkKCQlyZXR1cm4gdG9rZW5Db3VudDsKCX0KCQoJZnVuY3Rpb24gY2FsY3VsYXRlVG9rZW5BbW91bnQodWludDI1NiBfd2VpQW1vdW50KSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KQoJewkJCgkJdWludDI1NiBuVG9rZW5zID0gdG9rZW5zU29sZDsKCQl1aW50MjU2IHJlbWFpbmluZ1dlaSA9IF93ZWlBbW91bnQ7CgkJdWludDI1NiB0aWVyVG9rZW5zID0gMDsKCQkKCQlpZiAoblRva2VucyA8IHRpZXIxLmNhcCkKCQl7CQkJCgkJCXRpZXJUb2tlbnMgPSBjYWxjdWxhdGVUaWVyVG9rZW5zKHRpZXIxLCByZW1haW5pbmdXZWksIG5Ub2tlbnMpOwoJCQluVG9rZW5zID0gblRva2Vucy5hZGQodGllclRva2Vucyk7CQkKCQkJcmVtYWluaW5nV2VpID0gcmVtYWluaW5nV2VpLnN1Yih0aWVyVG9rZW5zLmRpdih0aWVyMS5yYXRlKSk7CgkJfQoJCQoJCWlmIChyZW1haW5pbmdXZWkgPiAwICYmIG5Ub2tlbnMgPCB0aWVyMi5jYXApCgkJewoJCQl0aWVyVG9rZW5zID0gY2FsY3VsYXRlVGllclRva2Vucyh0aWVyMiwgcmVtYWluaW5nV2VpLCBuVG9rZW5zKTsKCQkJblRva2VucyA9IG5Ub2tlbnMuYWRkKHRpZXJUb2tlbnMpOwkJCQoJCQlyZW1haW5pbmdXZWkgPSByZW1haW5pbmdXZWkuc3ViKHRpZXJUb2tlbnMuZGl2KHRpZXIyLnJhdGUpKTsKCQl9CgoJCWlmIChyZW1haW5pbmdXZWkgPiAwICYmIG5Ub2tlbnMgPCB0aWVyMy5jYXApCgkJewoJCQl0aWVyVG9rZW5zID0gY2FsY3VsYXRlVGllclRva2Vucyh0aWVyMywgcmVtYWluaW5nV2VpLCBuVG9rZW5zKTsKCQkJblRva2VucyA9IG5Ub2tlbnMuYWRkKHRpZXJUb2tlbnMpOwkJCQoJCQlyZW1haW5pbmdXZWkgPSByZW1haW5pbmdXZWkuc3ViKHRpZXJUb2tlbnMuZGl2KHRpZXIzLnJhdGUpKTsKCQl9CgoJCWlmIChyZW1haW5pbmdXZWkgPiAwICYmIG5Ub2tlbnMgPCB0aWVyNC5jYXApCgkJewoJCQl0aWVyVG9rZW5zID0gY2FsY3VsYXRlVGllclRva2Vucyh0aWVyNCwgcmVtYWluaW5nV2VpLCBuVG9rZW5zKTsKCQkJblRva2VucyA9IG5Ub2tlbnMuYWRkKHRpZXJUb2tlbnMpOwkJCQoJCQlyZW1haW5pbmdXZWkgPSByZW1haW5pbmdXZWkuc3ViKHRpZXJUb2tlbnMuZGl2KHRpZXI0LnJhdGUpKTsKCQl9CgoJCWlmIChyZW1haW5pbmdXZWkgPiAwICYmIG5Ub2tlbnMgPCB0aWVyNS5jYXApCgkJewoJCQl0aWVyVG9rZW5zID0gY2FsY3VsYXRlVGllclRva2Vucyh0aWVyNSwgcmVtYWluaW5nV2VpLCBuVG9rZW5zKTsKCQkJblRva2VucyA9IG5Ub2tlbnMuYWRkKHRpZXJUb2tlbnMpOwkJCQoJCQlyZW1haW5pbmdXZWkgPSByZW1haW5pbmdXZWkuc3ViKHRpZXJUb2tlbnMuZGl2KHRpZXI1LnJhdGUpKTsKCQl9CQkKCQkKCQlyZXF1aXJlKHJlbWFpbmluZ1dlaSA9PSAwKTsKCQkKCQlyZXR1cm4gblRva2Vucy5zdWIodG9rZW5zU29sZCk7Cgl9CQoKCS8vIGZhbGxiYWNrIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIGJ1eSB0b2tlbnMKCWZ1bmN0aW9uICgpIHB1YmxpYyBwYXlhYmxlIHsKCQlidXlUb2tlbnMobXNnLnNlbmRlcik7Cgl9CgoJLy8gbG93IGxldmVsIHRva2VuIHB1cmNoYXNlIGZ1bmN0aW9uCglmdW5jdGlvbiBidXlUb2tlbnMoYWRkcmVzcyBiZW5lZmljaWFyeSkgcHVibGljIHBheWFibGUgc3RvcEluRW1lcmdlbmN5IAoJewoJCXJlcXVpcmUoYmVuZWZpY2lhcnkgIT0gYWRkcmVzcygwKSk7CgkJcmVxdWlyZSh2YWxpZFB1cmNoYXNlKCkpOwoKCQl1aW50MjU2IHdlaUFtb3VudCA9IG1zZy52YWx1ZTsKCgkJLy8gY2FsY3VsYXRlIHRva2VuIGFtb3VudCB0byBiZSBjcmVhdGVkCgkJLy91aW50MjU2IHRva2VucyA9IHdlaUFtb3VudC5tdWwocmF0ZSk7CgkJdWludDI1NiB0b2tlbnMgPSBjYWxjdWxhdGVUb2tlbkFtb3VudCh3ZWlBbW91bnQpOwoKCQkvLyBDaGVjayB3aGV0aGVyIHdpdGhpbiB0aGlzIHR0cmFuc2FjdGlvbiB3ZSB3aWxsIG5vdCBvdmVyZmxvdyBtYXhpbXVtIHRva2VuIGFtb3VudAoJCXJlcXVpcmUodG9rZW5zU29sZC5hZGQodG9rZW5zKSA8PSBtYXhpbXVtVG9rZW5BbW91bnQpOwoKCQkvLyB1cGRhdGUgc3RhdGUKCQl3ZWlSYWlzZWQgPSB3ZWlSYWlzZWQuYWRkKHdlaUFtb3VudCk7CgkJdG9rZW5zU29sZCA9IHRva2Vuc1NvbGQuYWRkKHRva2Vucyk7CgkJaW52ZXN0ZWRBbW91bnRPZltiZW5lZmljaWFyeV0gPSBpbnZlc3RlZEFtb3VudE9mW2JlbmVmaWNpYXJ5XS5hZGQod2VpQW1vdW50KTsKCQl0b2tlbkFtb3VudE9mW2JlbmVmaWNpYXJ5XSA9IHRva2VuQW1vdW50T2ZbYmVuZWZpY2lhcnldLmFkZCh0b2tlbnMpOwoKCQkvLyBmb3J3YXJkIHRva2VucyB0byBwdXJjaGFzZXIKCQlmb3J3YXJkVG9rZW5zKGJlbmVmaWNpYXJ5LCB0b2tlbnMpOwoKCQlMb2dUb2tlblB1cmNoYXNlKG1zZy5zZW5kZXIsIGJlbmVmaWNpYXJ5LCB3ZWlBbW91bnQsIHRva2Vucyk7CgoJCS8vIGZvcndhcmQgRVRIIHRvIG11bHRpc2lnIHdhbGxldAoJCWZvcndhcmRGdW5kcygpOwoJfQoKCS8qKgoJICogVGhpcyBmdW5jdGlvbiBqdXN0IHRyYW5zZmVycyB0b2tlbnMgdG8gYmVuZWZpY2lhcnkgYWRkcmVzcy4gCgkgKiBJdCBzaG91bGQgYmUgdXNlZCBmb3IgY2FzZXMgd2hlbiBpbnZlc3RvciBidXlzIHRva2VucyB1c2luZyBvdGhlciBjdXJyZW5jaWVzCgkgKi8KCWZ1bmN0aW9uIHRyYW5zZmVyVG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQyNTYgYW1vdW50KSBwdWJsaWMgb25seU93bmVyCgl7CgkJcmVxdWlyZShiZW5lZmljaWFyeSAhPSBhZGRyZXNzKDApKTsKCQlyZXF1aXJlKGFtb3VudCA+IDApOwoKCQl1aW50MjU2IHdlaUFtb3VudCA9IGFtb3VudCAqIDEgZXRoZXI7CgkJCgkJdG9rZW5zU29sZCA9IHRva2Vuc1NvbGQuYWRkKHdlaUFtb3VudCk7CgkJdG9rZW5BbW91bnRPZltiZW5lZmljaWFyeV0gPSB0b2tlbkFtb3VudE9mW2JlbmVmaWNpYXJ5XS5hZGQod2VpQW1vdW50KTsKCQkKCQlmb3J3YXJkVG9rZW5zKGJlbmVmaWNpYXJ5LCB3ZWlBbW91bnQpOwoJfQoJCgkJLyoqCgkgKiBUaGlzIGZ1bmN0aW9uIGp1c3QgdHJhbnNmZXJzIHRva2VucyB3aXRoIGRlY2ltYWxzIHRvIGJlbmVmaWNpYXJ5IGFkZHJlc3MuIAoJICogSXQgc2hvdWxkIGJlIHVzZWQgZm9yIGNhc2VzIHdoZW4gaW52ZXN0b3IgYnV5cyB0b2tlbnMgdXNpbmcgb3RoZXIgY3VycmVuY2llcwoJICovCglmdW5jdGlvbiB0cmFuc2ZlclRva2Vuc1dlaShhZGRyZXNzIGJlbmVmaWNpYXJ5LCB1aW50MjU2IGFtb3VudCkgcHVibGljIG9ubHlPd25lcgoJewoJCXJlcXVpcmUoYmVuZWZpY2lhcnkgIT0gYWRkcmVzcygwKSk7CgkJcmVxdWlyZShhbW91bnQgPiAwKTsKCgkJdWludDI1NiB3ZWlBbW91bnQgPSBhbW91bnQ7CgkJCgkJdG9rZW5zU29sZCA9IHRva2Vuc1NvbGQuYWRkKHdlaUFtb3VudCk7CgkJdG9rZW5BbW91bnRPZltiZW5lZmljaWFyeV0gPSB0b2tlbkFtb3VudE9mW2JlbmVmaWNpYXJ5XS5hZGQod2VpQW1vdW50KTsKCQkKCQlmb3J3YXJkVG9rZW5zKGJlbmVmaWNpYXJ5LCB3ZWlBbW91bnQpOwoJfQoJCgkvLyBzZW5kIGV0aGVyIHRvIHRoZSBmdW5kIGNvbGxlY3Rpb24gd2FsbGV0CgkvLyBvdmVycmlkZSB0byBjcmVhdGUgY3VzdG9tIGZ1bmQgZm9yd2FyZGluZyBtZWNoYW5pc21zCglmdW5jdGlvbiBmb3J3YXJkRnVuZHMoKSBpbnRlcm5hbCB7CgkJbXVsdGlzaWdXYWxsZXQudHJhbnNmZXIobXNnLnZhbHVlKTsKCX0KCQoJLyoqCgkgKiBGb3J3YXJkIGhhbmRlbGlvbiB0b2tlbnMgdG8gcHVyY2hhc2V0CgkgKi8KCWZ1bmN0aW9uIGZvcndhcmRUb2tlbnMoYWRkcmVzcyBfcHVyY2hhc2VyLCB1aW50MjU2IF9hbW91bnQpIGludGVybmFsCgl7CgkJdG9rZW4udHJhbnNmZXIoX3B1cmNoYXNlciwgX2Ftb3VudCk7Cgl9CgoJLyoqCgkqIENsb3NlcyBjcm93ZHNhbGUgYW5kIGNoYW5nZXMgaXRzIHN0YXRlIHRvIEZpbmFsaXplZC4gCgkqIFdhcm5pbmcgLSB0aGlzIGFjdGlvbiBpcyB1bmRvYWJsZSEKCSovCglmdW5jdGlvbiBmaW5hbGl6ZSgpIHB1YmxpYyBvbmx5T3duZXIKCXsKCQlmaW5hbGl6ZWQgPSB0cnVlOwoJCQoJCUxvZ0Nyb3dkc2FsZUZpbmFsaXplZChnb2FsUmVhY2hlZCgpKTsKCX0KCQoJLyoqCgkgKiBCdXJucyBhbGwgY2FsbGVyIHRva2VucwoJICoKCSAqLwoJZnVuY3Rpb24gYnVyblRva2Vuc0ludGVybmFsKGFkZHJlc3MgX2FkZHJlc3MsIHVpbnQyNTYgdG9rZW5BbW91bnQpIGludGVybmFsCgl7CgkJcmVxdWlyZShfYWRkcmVzcyAhPSBhZGRyZXNzKDApKTsKCQkKCQl1aW50MjU2IHRva2Vuc1RvQnVybiA9IHRva2VuQW1vdW50OwoJCXVpbnQyNTYgbWF4VG9rZW5zID0gdG9rZW4uYmFsYW5jZU9mKF9hZGRyZXNzKTsKCQkKCQlpZiAodG9rZW5zVG9CdXJuID4gbWF4VG9rZW5zKQoJCXsKCQkJdG9rZW5zVG9CdXJuID0gbWF4VG9rZW5zOwoJCX0KCQkKCQl0b2tlbi5idXJuKF9hZGRyZXNzLCB0b2tlbnNUb0J1cm4pOwoJfQoJCQoJLyoqCgkgKiBCdXJucyByZW1haW5pbmcgdG9rZW5zIHdoaWNoIGFyZSBub3Qgc29sZCBkdXJpbmcgY3Jvd2RzYWxlCgkgKi8KCWZ1bmN0aW9uIGJ1cm5SZW1haW5pbmdUb2tlbnMoKSBwdWJsaWMgb25seU93bmVyCgl7CgkJYnVyblRva2Vuc0ludGVybmFsKHRoaXMsIGdldFJlbWFpbmluZ1Rva2VucygpKTsKCX0KCQkKCQkKCS8qKgoJICogR2V0cyByZW1haW5pbmcgdG9rZW5zIG9uIGEgY29udHJhY3QKCSAqLwoJZnVuY3Rpb24gZ2V0UmVtYWluaW5nVG9rZW5zKCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludDI1NikKCXsKCQlyZXR1cm4gdG9rZW4uZ2V0UmVtYWluaW5nVG9rZW5zKCk7Cgl9CgkKCS8qKgoJICogR2V0cyB0b3RhbCBzdXBwbHkgb2YgdG9rZW5zCgkgKi8KCWZ1bmN0aW9uIGdldFRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZXMpCgl7CgkJcmV0dXJuIHRva2VuLmdldFRvdGFsU3VwcGx5KCk7Cgl9CgkKCS8qKgoJICogR2V0cyBhbW91bnQgb2YgdG9rZW4gb2Ygc3BlY2lmaWMgaW52ZXN0b3IKCSAqLwoJZnVuY3Rpb24gZ2V0VG9rZW5BbW91bnRPZihhZGRyZXNzIGludmVzdG9yKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlcykKCXsKCQlyZXR1cm4gdG9rZW4uYmFsYW5jZU9mKGludmVzdG9yKTsKCX0KCgkvLyBAcmV0dXJuIHRydWUgaWYgdGhlIHRyYW5zYWN0aW9uIGNhbiBidXkgdG9rZW5zCglmdW5jdGlvbiB2YWxpZFB1cmNoYXNlKCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewoJCWJvb2wgd2l0aGluUGVyaW9kID0gbm93ID49IHN0YXJ0VGltZSAmJiBub3cgPD0gZW5kVGltZTsKCQlib29sIG5vblplcm9QdXJjaGFzZSA9IG1zZy52YWx1ZSAhPSAwOwoJCWJvb2wgbm90RmluYWxpemVkID0gIWZpbmFsaXplZDsKCQlib29sIG1heENhcE5vdFJlYWNoZWQgPSB0b2tlbnNTb2xkIDwgbWF4aW11bVRva2VuQW1vdW50OwoKCQlyZXR1cm4gd2l0aGluUGVyaW9kICYmIG5vblplcm9QdXJjaGFzZSAmJiBub3RGaW5hbGl6ZWQgJiYgbWF4Q2FwTm90UmVhY2hlZDsKCX0KCglmdW5jdGlvbiBnb2FsUmVhY2hlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKQoJewoJCXJldHVybiB0b2tlbnNTb2xkID49IG1pbmltdW1Ub2tlbkFtb3VudDsKCX0KCgkvLyBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBlbmRlZAoJZnVuY3Rpb24gaGFzRW5kZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewoJCXJldHVybiBub3cgPiBlbmRUaW1lOwoJfQkKfQ=='.
	

]
