Class {
	#name : #SRT2bd1f12269c1ff80042c8d354bba4c1ca52e2061,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT2bd1f12269c1ff80042c8d354bba4c1ca52e2061 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgoKLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5CiAqLwpjb250cmFjdCBFUkMyMEJhc2ljIHsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKCgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuIAogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsKICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuIAogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cgp9CgoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCgovKioKICogQHRpdGxlIFN0YW5kYXJkIEVSQzIwIHRva2VuCiAqCiAqIEBkZXYgSW1wbGVtZW50YXRpb24gb2YgdGhlIGJhc2ljIHN0YW5kYXJkIHRva2VuLgogKiBAZGV2IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgRmlyc3RCbG9vZDogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sCiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwoKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdXQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICB2YXIgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOwoKICAgIC8vIENoZWNrIGlzIG5vdCBuZWVkZWQgYmVjYXVzZSBzdWIoX2FsbG93YW5jZSwgX3ZhbHVlKSB3aWxsIGFscmVhZHkgdGhyb3cgaWYgdGhpcyBjb25kaXRpb24gaXMgbm90IG1ldAogICAgLy8gcmVxdWlyZSAoX3ZhbHVlIDw9IF9hbGxvd2FuY2UpOwoKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBfYWxsb3dhbmNlLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CgogICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2AKICAgIC8vICBhbGxvd2FuY2UgdG8gemVybyBieSBjYWxsaW5nIGBhcHByb3ZlKF9zcGVuZGVyLCAwKWAgaWYgaXQgaXMgbm90CiAgICAvLyAgYWxyZWFkeSAwIHRvIG1pdGlnYXRlIHRoZSByYWNlIGNvbmRpdGlvbiBkZXNjcmliZWQgaGVyZToKICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgcmVxdWlyZSgoX3ZhbHVlID09IDApIHx8IChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9PSAwKSk7CgogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKfQoKCgovLy8gQHRpdGxlIFN0YW5kYXJkVG9rZW4gd2hpY2ggY2lyY3VsYXRpb24gY2FuIGJlIGRlbGF5ZWQgYW5kIHN0YXJ0ZWQgYnkgYW5vdGhlciBjb250cmFjdC4KLy8vIEBkZXYgVG8gYmUgdXNlZCBhcyBhIG1peGluIGNvbnRyYWN0LgovLy8gVGhlIGNvbnRyYWN0IGlzIGNyZWF0ZWQgaW4gZGlzYWJsZWQgc3RhdGU6IGNpcmN1bGF0aW9uIGlzIGRpc2FibGVkLgpjb250cmFjdCBDaXJjdWxhdGluZ1Rva2VuIGlzIFN0YW5kYXJkVG9rZW4gewoKICAgIGV2ZW50IENpcmN1bGF0aW9uRW5hYmxlZCgpOwoKICAgIG1vZGlmaWVyIHJlcXVpcmVzQ2lyY3VsYXRpb24gewogICAgICAgIHJlcXVpcmUobV9pc0NpcmN1bGF0aW5nKTsKICAgICAgICBfOwogICAgfQoKCiAgICAvLyBQVUJMSUMgaW50ZXJmYWNlCgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXF1aXJlc0NpcmN1bGF0aW9uIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJlcXVpcmVzQ2lyY3VsYXRpb24gcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXF1aXJlc0NpcmN1bGF0aW9uIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIuYXBwcm92ZShfc3BlbmRlciwgX3ZhbHVlKTsKICAgIH0KCgogICAgLy8gSU5URVJOQUwgZnVuY3Rpb25zCgogICAgZnVuY3Rpb24gZW5hYmxlQ2lyY3VsYXRpb24oKSBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYgKG1faXNDaXJjdWxhdGluZykKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBtX2lzQ2lyY3VsYXRpbmcgPSB0cnVlOwogICAgICAgIENpcmN1bGF0aW9uRW5hYmxlZCgpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKCiAgICAvLyBGSUVMRFMKCiAgICAvLy8gQG5vdGljZSBhcmUgdGhlIGNpcmN1bGF0aW9uIHN0YXJ0ZWQ/CiAgICBib29sIHB1YmxpYyBtX2lzQ2lyY3VsYXRpbmc7Cn0KCgovLyBDb2RlIHRha2VuIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL2RhcHAtYmluL2Jsb2IvbWFzdGVyL3dhbGxldC93YWxsZXQuc29sCi8vIEF1ZGl0LCByZWZhY3RvcmluZyBhbmQgaW1wcm92ZW1lbnRzIGJ5IGdpdGh1Yi5jb20vRWVuYWUKCi8vIEBhdXRob3JzOgovLyBHYXYgV29vZCA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImI5ZGVmOWRjY2RkMWRkZGNjZjk3ZGFkNmQ0Ij5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9hPj4KLy8gaW5oZXJpdGFibGUgInByb3BlcnR5IiBjb250cmFjdCB0aGF0IGVuYWJsZXMgbWV0aG9kcyB0byBiZSBwcm90ZWN0ZWQgYnkgcmVxdWlyaW5nIHRoZSBhY3F1aWVzY2VuY2Ugb2YgZWl0aGVyIGEKLy8gc2luZ2xlLCBvciwgY3J1Y2lhbGx5LCBlYWNoIG9mIGEgbnVtYmVyIG9mLCBkZXNpZ25hdGVkIG93bmVycy4KLy8gdXNhZ2U6Ci8vIHVzZSBtb2RpZmllcnMgb25seW93bmVyIChqdXN0IG93biBvd25lZCkgb3Igb25seW1hbnlvd25lcnMoaGFzaCksIHdoZXJlYnkgdGhlIHNhbWUgaGFzaCBtdXN0IGJlIHByb3ZpZGVkIGJ5Ci8vIHNvbWUgbnVtYmVyIChzcGVjaWZpZWQgaW4gY29uc3RydWN0b3IpIG9mIHRoZSBzZXQgb2Ygb3duZXJzIChzcGVjaWZpZWQgaW4gdGhlIGNvbnN0cnVjdG9yLCBtb2RpZmlhYmxlKSBiZWZvcmUgdGhlCi8vIGludGVyaW9yIGlzIGV4ZWN1dGVkLgoKCi8vLyBub3RlOiBkdXJpbmcgYW55IG93bmVyc2hpcCBjaGFuZ2VzIGFsbCBwZW5kaW5nIG9wZXJhdGlvbnMgKHdhaXRpbmcgZm9yIG1vcmUgc2lnbmF0dXJlcykgYXJlIGNhbmNlbGxlZAovLyBUT0RPIGFjY2VwdE93bmVyc2hpcApjb250cmFjdCBtdWx0aW93bmVkIHsKCgkvLyBUWVBFUwoKICAgIC8vIHN0cnVjdCBmb3IgdGhlIHN0YXR1cyBvZiBhIHBlbmRpbmcgb3BlcmF0aW9uLgogICAgc3RydWN0IE11bHRpT3duZWRPcGVyYXRpb25QZW5kaW5nU3RhdGUgewogICAgICAgIC8vIGNvdW50IG9mIGNvbmZpcm1hdGlvbnMgbmVlZGVkCiAgICAgICAgdWludCB5ZXROZWVkZWQ7CgogICAgICAgIC8vIGJpdG1hcCBvZiBjb25maXJtYXRpb25zIHdoZXJlIG93bmVyICNvd25lckluZGV4J3MgZGVjaXNpb24gY29ycmVzcG9uZHMgdG8gMioqb3duZXJJbmRleCBiaXQKICAgICAgICB1aW50IG93bmVyc0RvbmU7CgogICAgICAgIC8vIHBvc2l0aW9uIG9mIHRoaXMgb3BlcmF0aW9uIGtleSBpbiBtX211bHRpT3duZWRQZW5kaW5nSW5kZXgKICAgICAgICB1aW50IGluZGV4OwogICAgfQoKCS8vIEVWRU5UUwoKICAgIGV2ZW50IENvbmZpcm1hdGlvbihhZGRyZXNzIG93bmVyLCBieXRlczMyIG9wZXJhdGlvbik7CiAgICBldmVudCBSZXZva2UoYWRkcmVzcyBvd25lciwgYnl0ZXMzMiBvcGVyYXRpb24pOwogICAgZXZlbnQgRmluYWxDb25maXJtYXRpb24oYWRkcmVzcyBvd25lciwgYnl0ZXMzMiBvcGVyYXRpb24pOwoKICAgIC8vIHNvbWUgb3RoZXJzIGFyZSBpbiB0aGUgY2FzZSBvZiBhbiBvd25lciBjaGFuZ2luZy4KICAgIGV2ZW50IE93bmVyQ2hhbmdlZChhZGRyZXNzIG9sZE93bmVyLCBhZGRyZXNzIG5ld093bmVyKTsKICAgIGV2ZW50IE93bmVyQWRkZWQoYWRkcmVzcyBuZXdPd25lcik7CiAgICBldmVudCBPd25lclJlbW92ZWQoYWRkcmVzcyBvbGRPd25lcik7CgogICAgLy8gdGhlIGxhc3Qgb25lIGlzIGVtaXR0ZWQgaWYgdGhlIHJlcXVpcmVkIHNpZ25hdHVyZXMgY2hhbmdlCiAgICBldmVudCBSZXF1aXJlbWVudENoYW5nZWQodWludCBuZXdSZXF1aXJlbWVudCk7CgoJLy8gTU9ESUZJRVJTCgogICAgLy8gc2ltcGxlIHNpbmdsZS1zaWcgZnVuY3Rpb24gbW9kaWZpZXIuCiAgICBtb2RpZmllciBvbmx5b3duZXIgewogICAgICAgIHJlcXVpcmUoaXNPd25lcihtc2cuc2VuZGVyKSk7CiAgICAgICAgXzsKICAgIH0KICAgIC8vIG11bHRpLXNpZyBmdW5jdGlvbiBtb2RpZmllcjogdGhlIG9wZXJhdGlvbiBtdXN0IGhhdmUgYW4gaW50cmluc2ljIGhhc2ggaW4gb3JkZXIKICAgIC8vIHRoYXQgbGF0ZXIgYXR0ZW1wdHMgY2FuIGJlIHJlYWxpc2VkIGFzIHRoZSBzYW1lIHVuZGVybHlpbmcgb3BlcmF0aW9uIGFuZAogICAgLy8gdGh1cyBjb3VudCBhcyBjb25maXJtYXRpb25zLgogICAgbW9kaWZpZXIgb25seW1hbnlvd25lcnMoYnl0ZXMzMiBfb3BlcmF0aW9uKSB7CiAgICAgICAgaWYgKGNvbmZpcm1BbmRDaGVjayhfb3BlcmF0aW9uKSkgewogICAgICAgICAgICBfOwogICAgICAgIH0KICAgICAgICAvLyBFdmVuIGlmIHJlcXVpcmVkIG51bWJlciBvZiBjb25maXJtYXRpb25zIGhhcyd0IGJlZW4gY29sbGVjdGVkIHlldCwKICAgICAgICAvLyB3ZSBjYW4ndCB0aHJvdyBoZXJlIC0gYmVjYXVzZSBjaGFuZ2VzIHRvIHRoZSBzdGF0ZSBoYXZlIHRvIGJlIHByZXNlcnZlZC4KICAgICAgICAvLyBCdXQsIGNvbmZpcm1BbmRDaGVjayBpdHNlbGYgd2lsbCB0aHJvdyBpbiBjYXNlIHNlbmRlciBpcyBub3QgYW4gb3duZXIuCiAgICB9CgogICAgbW9kaWZpZXIgdmFsaWROdW1Pd25lcnModWludCBfbnVtT3duZXJzKSB7CiAgICAgICAgcmVxdWlyZShfbnVtT3duZXJzID4gMCAmJiBfbnVtT3duZXJzIDw9IGNfbWF4T3duZXJzKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG11bHRpT3duZWRWYWxpZFJlcXVpcmVtZW50KHVpbnQgX3JlcXVpcmVkLCB1aW50IF9udW1Pd25lcnMpIHsKICAgICAgICByZXF1aXJlKF9yZXF1aXJlZCA+IDAgJiYgX3JlcXVpcmVkIDw9IF9udW1Pd25lcnMpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb3duZXJFeGlzdHMoYWRkcmVzcyBfYWRkcmVzcykgewogICAgICAgIHJlcXVpcmUoaXNPd25lcihfYWRkcmVzcykpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb3duZXJEb2VzTm90RXhpc3QoYWRkcmVzcyBfYWRkcmVzcykgewogICAgICAgIHJlcXVpcmUoIWlzT3duZXIoX2FkZHJlc3MpKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG11bHRpT3duZWRPcGVyYXRpb25Jc0FjdGl2ZShieXRlczMyIF9vcGVyYXRpb24pIHsKICAgICAgICByZXF1aXJlKGlzT3BlcmF0aW9uQWN0aXZlKF9vcGVyYXRpb24pKTsKICAgICAgICBfOwogICAgfQoKCS8vIE1FVEhPRFMKCiAgICAvLyBjb25zdHJ1Y3RvciBpcyBnaXZlbiBudW1iZXIgb2Ygc2lncyByZXF1aXJlZCB0byBkbyBwcm90ZWN0ZWQgIm9ubHltYW55b3duZXJzIiB0cmFuc2FjdGlvbnMKICAgIC8vIGFzIHdlbGwgYXMgdGhlIHNlbGVjdGlvbiBvZiBhZGRyZXNzZXMgY2FwYWJsZSBvZiBjb25maXJtaW5nIHRoZW0gKG1zZy5zZW5kZXIgaXMgbm90IGFkZGVkIHRvIHRoZSBvd25lcnMhKS4KICAgIGZ1bmN0aW9uIG11bHRpb3duZWQoYWRkcmVzc1tdIF9vd25lcnMsIHVpbnQgX3JlcXVpcmVkKQogICAgICAgIHZhbGlkTnVtT3duZXJzKF9vd25lcnMubGVuZ3RoKQogICAgICAgIG11bHRpT3duZWRWYWxpZFJlcXVpcmVtZW50KF9yZXF1aXJlZCwgX293bmVycy5sZW5ndGgpCiAgICB7CiAgICAgICAgYXNzZXJ0KGNfbWF4T3duZXJzIDw9IDI1NSk7CgogICAgICAgIG1fbnVtT3duZXJzID0gX293bmVycy5sZW5ndGg7CiAgICAgICAgbV9tdWx0aU93bmVkUmVxdWlyZWQgPSBfcmVxdWlyZWQ7CgogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IF9vd25lcnMubGVuZ3RoOyArK2kpCiAgICAgICAgewogICAgICAgICAgICBhZGRyZXNzIG93bmVyID0gX293bmVyc1tpXTsKICAgICAgICAgICAgLy8gaW52YWxpZCBhbmQgZHVwbGljYXRlIGFkZHJlc3NlcyBhcmUgbm90IGFsbG93ZWQKICAgICAgICAgICAgcmVxdWlyZSgwICE9IG93bmVyICYmICFpc093bmVyKG93bmVyKSAvKiBub3QgaXNPd25lciB5ZXQhICovKTsKCiAgICAgICAgICAgIHVpbnQgY3VycmVudE93bmVySW5kZXggPSBjaGVja093bmVySW5kZXgoaSArIDEgLyogZmlyc3Qgc2xvdCBpcyB1bnVzZWQgKi8pOwogICAgICAgICAgICBtX293bmVyc1tjdXJyZW50T3duZXJJbmRleF0gPSBvd25lcjsKICAgICAgICAgICAgbV9vd25lckluZGV4W293bmVyXSA9IGN1cnJlbnRPd25lckluZGV4OwogICAgICAgIH0KCiAgICAgICAgYXNzZXJ0T3duZXJzQXJlQ29uc2lzdGVudCgpOwogICAgfQoKICAgIC8vIFJlcGxhY2VzIGFuIG93bmVyIGBfZnJvbWAgd2l0aCBhbm90aGVyIGBfdG9gLgogICAgLy8gQWxsIHBlbmRpbmcgb3BlcmF0aW9ucyB3aWxsIGJlIGNhbmNlbGVkIQogICAgZnVuY3Rpb24gY2hhbmdlT3duZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8pCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICBvd25lckV4aXN0cyhfZnJvbSkKICAgICAgICBvd25lckRvZXNOb3RFeGlzdChfdG8pCiAgICAgICAgb25seW1hbnlvd25lcnMoc2hhMyhtc2cuZGF0YSkpCiAgICB7CiAgICAgICAgYXNzZXJ0T3duZXJzQXJlQ29uc2lzdGVudCgpOwoKICAgICAgICBjbGVhclBlbmRpbmcoKTsKICAgICAgICB1aW50IG93bmVySW5kZXggPSBjaGVja093bmVySW5kZXgobV9vd25lckluZGV4W19mcm9tXSk7CiAgICAgICAgbV9vd25lcnNbb3duZXJJbmRleF0gPSBfdG87CiAgICAgICAgbV9vd25lckluZGV4W19mcm9tXSA9IDA7CiAgICAgICAgbV9vd25lckluZGV4W190b10gPSBvd25lckluZGV4OwoKICAgICAgICBhc3NlcnRPd25lcnNBcmVDb25zaXN0ZW50KCk7CiAgICAgICAgT3duZXJDaGFuZ2VkKF9mcm9tLCBfdG8pOwogICAgfQoKICAgIC8vIEFsbCBwZW5kaW5nIG9wZXJhdGlvbnMgd2lsbCBiZSBjYW5jZWxlZCEKICAgIGZ1bmN0aW9uIGFkZE93bmVyKGFkZHJlc3MgX293bmVyKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgb3duZXJEb2VzTm90RXhpc3QoX293bmVyKQogICAgICAgIHZhbGlkTnVtT3duZXJzKG1fbnVtT3duZXJzICsgMSkKICAgICAgICBvbmx5bWFueW93bmVycyhzaGEzKG1zZy5kYXRhKSkKICAgIHsKICAgICAgICBhc3NlcnRPd25lcnNBcmVDb25zaXN0ZW50KCk7CgogICAgICAgIGNsZWFyUGVuZGluZygpOwogICAgICAgIG1fbnVtT3duZXJzKys7CiAgICAgICAgbV9vd25lcnNbbV9udW1Pd25lcnNdID0gX293bmVyOwogICAgICAgIG1fb3duZXJJbmRleFtfb3duZXJdID0gY2hlY2tPd25lckluZGV4KG1fbnVtT3duZXJzKTsKCiAgICAgICAgYXNzZXJ0T3duZXJzQXJlQ29uc2lzdGVudCgpOwogICAgICAgIE93bmVyQWRkZWQoX293bmVyKTsKICAgIH0KCiAgICAvLyBBbGwgcGVuZGluZyBvcGVyYXRpb25zIHdpbGwgYmUgY2FuY2VsZWQhCiAgICBmdW5jdGlvbiByZW1vdmVPd25lcihhZGRyZXNzIF9vd25lcikKICAgICAgICBleHRlcm5hbAogICAgICAgIG93bmVyRXhpc3RzKF9vd25lcikKICAgICAgICB2YWxpZE51bU93bmVycyhtX251bU93bmVycyAtIDEpCiAgICAgICAgbXVsdGlPd25lZFZhbGlkUmVxdWlyZW1lbnQobV9tdWx0aU93bmVkUmVxdWlyZWQsIG1fbnVtT3duZXJzIC0gMSkKICAgICAgICBvbmx5bWFueW93bmVycyhzaGEzKG1zZy5kYXRhKSkKICAgIHsKICAgICAgICBhc3NlcnRPd25lcnNBcmVDb25zaXN0ZW50KCk7CgogICAgICAgIGNsZWFyUGVuZGluZygpOwogICAgICAgIHVpbnQgb3duZXJJbmRleCA9IGNoZWNrT3duZXJJbmRleChtX293bmVySW5kZXhbX293bmVyXSk7CiAgICAgICAgbV9vd25lcnNbb3duZXJJbmRleF0gPSAwOwogICAgICAgIG1fb3duZXJJbmRleFtfb3duZXJdID0gMDsKICAgICAgICAvL21ha2Ugc3VyZSBtX251bU93bmVycyBpcyBlcXVhbCB0byB0aGUgbnVtYmVyIG9mIG93bmVycyBhbmQgYWx3YXlzIHBvaW50cyB0byB0aGUgbGFzdCBvd25lcgogICAgICAgIHJlb3JnYW5pemVPd25lcnMoKTsKCiAgICAgICAgYXNzZXJ0T3duZXJzQXJlQ29uc2lzdGVudCgpOwogICAgICAgIE93bmVyUmVtb3ZlZChfb3duZXIpOwogICAgfQoKICAgIC8vIEFsbCBwZW5kaW5nIG9wZXJhdGlvbnMgd2lsbCBiZSBjYW5jZWxlZCEKICAgIGZ1bmN0aW9uIGNoYW5nZVJlcXVpcmVtZW50KHVpbnQgX25ld1JlcXVpcmVkKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgbXVsdGlPd25lZFZhbGlkUmVxdWlyZW1lbnQoX25ld1JlcXVpcmVkLCBtX251bU93bmVycykKICAgICAgICBvbmx5bWFueW93bmVycyhzaGEzKG1zZy5kYXRhKSkKICAgIHsKICAgICAgICBtX211bHRpT3duZWRSZXF1aXJlZCA9IF9uZXdSZXF1aXJlZDsKICAgICAgICBjbGVhclBlbmRpbmcoKTsKICAgICAgICBSZXF1aXJlbWVudENoYW5nZWQoX25ld1JlcXVpcmVkKTsKICAgIH0KCiAgICAvLyBHZXRzIGFuIG93bmVyIGJ5IDAtaW5kZXhlZCBwb3NpdGlvbgogICAgZnVuY3Rpb24gZ2V0T3duZXIodWludCBvd25lckluZGV4KSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcykgewogICAgICAgIHJldHVybiBtX293bmVyc1tvd25lckluZGV4ICsgMV07CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0T3duZXJzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3NbXSkgewogICAgICAgIGFkZHJlc3NbXSBtZW1vcnkgcmVzdWx0ID0gbmV3IGFkZHJlc3NbXShtX251bU93bmVycyk7CiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgbV9udW1Pd25lcnM7IGkrKykKICAgICAgICAgICAgcmVzdWx0W2ldID0gZ2V0T3duZXIoaSk7CgogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogICAgZnVuY3Rpb24gaXNPd25lcihhZGRyZXNzIF9hZGRyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBtX293bmVySW5kZXhbX2FkZHJdID4gMDsKICAgIH0KCiAgICAvLyBUZXN0cyBvd25lcnNoaXAgb2YgdGhlIGN1cnJlbnQgY2FsbGVyLgogICAgLy8gSXQncyBhZHZpc2FibGUgdG8gY2FsbCBpdCBieSBuZXcgb3duZXIgdG8gbWFrZSBzdXJlIHRoYXQgdGhlIHNhbWUgZXJyb25lb3VzIGFkZHJlc3MgaXMgbm90IGNvcHktcGFzdGVkIHRvCiAgICAvLyBhZGRPd25lci9jaGFuZ2VPd25lciBhbmQgdG8gaXNPd25lci4KICAgIGZ1bmN0aW9uIGFtSU93bmVyKCkgZXh0ZXJuYWwgY29uc3RhbnQgb25seW93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBSZXZva2VzIGEgcHJpb3IgY29uZmlybWF0aW9uIG9mIHRoZSBnaXZlbiBvcGVyYXRpb24KICAgIGZ1bmN0aW9uIHJldm9rZShieXRlczMyIF9vcGVyYXRpb24pCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICBtdWx0aU93bmVkT3BlcmF0aW9uSXNBY3RpdmUoX29wZXJhdGlvbikKICAgICAgICBvbmx5b3duZXIKICAgIHsKICAgICAgICB1aW50IG93bmVySW5kZXhCaXQgPSBtYWtlT3duZXJCaXRtYXBCaXQobXNnLnNlbmRlcik7CiAgICAgICAgdmFyIHBlbmRpbmcgPSBtX211bHRpT3duZWRQZW5kaW5nW19vcGVyYXRpb25dOwogICAgICAgIHJlcXVpcmUocGVuZGluZy5vd25lcnNEb25lICYgb3duZXJJbmRleEJpdCA+IDApOwoKICAgICAgICBhc3NlcnRPcGVyYXRpb25Jc0NvbnNpc3RlbnQoX29wZXJhdGlvbik7CgogICAgICAgIHBlbmRpbmcueWV0TmVlZGVkKys7CiAgICAgICAgcGVuZGluZy5vd25lcnNEb25lIC09IG93bmVySW5kZXhCaXQ7CgogICAgICAgIGFzc2VydE9wZXJhdGlvbklzQ29uc2lzdGVudChfb3BlcmF0aW9uKTsKICAgICAgICBSZXZva2UobXNnLnNlbmRlciwgX29wZXJhdGlvbik7CiAgICB9CgogICAgZnVuY3Rpb24gaGFzQ29uZmlybWVkKGJ5dGVzMzIgX29wZXJhdGlvbiwgYWRkcmVzcyBfb3duZXIpCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICBjb25zdGFudAogICAgICAgIG11bHRpT3duZWRPcGVyYXRpb25Jc0FjdGl2ZShfb3BlcmF0aW9uKQogICAgICAgIG93bmVyRXhpc3RzKF9vd25lcikKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHJldHVybiAhKG1fbXVsdGlPd25lZFBlbmRpbmdbX29wZXJhdGlvbl0ub3duZXJzRG9uZSAmIG1ha2VPd25lckJpdG1hcEJpdChfb3duZXIpID09IDApOwogICAgfQoKICAgIC8vIElOVEVSTkFMIE1FVEhPRFMKCiAgICBmdW5jdGlvbiBjb25maXJtQW5kQ2hlY2soYnl0ZXMzMiBfb3BlcmF0aW9uKQogICAgICAgIHByaXZhdGUKICAgICAgICBvbmx5b3duZXIKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIGlmICg1MTIgPT0gbV9tdWx0aU93bmVkUGVuZGluZ0luZGV4Lmxlbmd0aCkKICAgICAgICAgICAgLy8gSW4gY2FzZSBtX211bHRpT3duZWRQZW5kaW5nSW5kZXggZ3Jvd3MgdG9vIG11Y2ggd2UgaGF2ZSB0byBzaHJpbmsgaXQ6IG90aGVyd2lzZSBhdCBzb21lIHBvaW50CiAgICAgICAgICAgIC8vIHdlIHdvbid0IGJlIGFibGUgdG8gZG8gaXQgYmVjYXVzZSBvZiBibG9jayBnYXMgbGltaXQuCiAgICAgICAgICAgIC8vIFllcywgcGVuZGluZyBjb25maXJtYXRpb25zIHdpbGwgYmUgbG9zdC4gRG9udCBzZWUgYW55IHNlY3VyaXR5IG9yIHN0YWJpbGl0eSBpbXBsaWNhdGlvbnMuCiAgICAgICAgICAgIC8vIFRPRE8gdXNlIG1vcmUgZ3JhY2VmdWwgYXBwcm9hY2ggbGlrZSBjb21wYWN0IG9yIHJlbW92YWwgb2YgY2xlYXJQZW5kaW5nIGNvbXBsZXRlbHkKICAgICAgICAgICAgY2xlYXJQZW5kaW5nKCk7CgogICAgICAgIHZhciBwZW5kaW5nID0gbV9tdWx0aU93bmVkUGVuZGluZ1tfb3BlcmF0aW9uXTsKCiAgICAgICAgLy8gaWYgd2UncmUgbm90IHlldCB3b3JraW5nIG9uIHRoaXMgb3BlcmF0aW9uLCBzd2l0Y2ggb3ZlciBhbmQgcmVzZXQgdGhlIGNvbmZpcm1hdGlvbiBzdGF0dXMuCiAgICAgICAgaWYgKCEgaXNPcGVyYXRpb25BY3RpdmUoX29wZXJhdGlvbikpIHsKICAgICAgICAgICAgLy8gcmVzZXQgY291bnQgb2YgY29uZmlybWF0aW9ucyBuZWVkZWQuCiAgICAgICAgICAgIHBlbmRpbmcueWV0TmVlZGVkID0gbV9tdWx0aU93bmVkUmVxdWlyZWQ7CiAgICAgICAgICAgIC8vIHJlc2V0IHdoaWNoIG93bmVycyBoYXZlIGNvbmZpcm1lZCAobm9uZSkgLSBzZXQgb3VyIGJpdG1hcCB0byAwLgogICAgICAgICAgICBwZW5kaW5nLm93bmVyc0RvbmUgPSAwOwogICAgICAgICAgICBwZW5kaW5nLmluZGV4ID0gbV9tdWx0aU93bmVkUGVuZGluZ0luZGV4Lmxlbmd0aCsrOwogICAgICAgICAgICBtX211bHRpT3duZWRQZW5kaW5nSW5kZXhbcGVuZGluZy5pbmRleF0gPSBfb3BlcmF0aW9uOwogICAgICAgICAgICBhc3NlcnRPcGVyYXRpb25Jc0NvbnNpc3RlbnQoX29wZXJhdGlvbik7CiAgICAgICAgfQoKICAgICAgICAvLyBkZXRlcm1pbmUgdGhlIGJpdCB0byBzZXQgZm9yIHRoaXMgb3duZXIuCiAgICAgICAgdWludCBvd25lckluZGV4Qml0ID0gbWFrZU93bmVyQml0bWFwQml0KG1zZy5zZW5kZXIpOwogICAgICAgIC8vIG1ha2Ugc3VyZSB3ZSAodGhlIG1lc3NhZ2Ugc2VuZGVyKSBoYXZlbid0IGNvbmZpcm1lZCB0aGlzIG9wZXJhdGlvbiBwcmV2aW91c2x5LgogICAgICAgIGlmIChwZW5kaW5nLm93bmVyc0RvbmUgJiBvd25lckluZGV4Qml0ID09IDApIHsKICAgICAgICAgICAgLy8gb2sgLSBjaGVjayBpZiBjb3VudCBpcyBlbm91Z2ggdG8gZ28gYWhlYWQuCiAgICAgICAgICAgIGFzc2VydChwZW5kaW5nLnlldE5lZWRlZCA+IDApOwogICAgICAgICAgICBpZiAocGVuZGluZy55ZXROZWVkZWQgPT0gMSkgewogICAgICAgICAgICAgICAgLy8gZW5vdWdoIGNvbmZpcm1hdGlvbnM6IHJlc2V0IGFuZCBydW4gaW50ZXJpb3IuCiAgICAgICAgICAgICAgICBkZWxldGUgbV9tdWx0aU93bmVkUGVuZGluZ0luZGV4W21fbXVsdGlPd25lZFBlbmRpbmdbX29wZXJhdGlvbl0uaW5kZXhdOwogICAgICAgICAgICAgICAgZGVsZXRlIG1fbXVsdGlPd25lZFBlbmRpbmdbX29wZXJhdGlvbl07CiAgICAgICAgICAgICAgICBGaW5hbENvbmZpcm1hdGlvbihtc2cuc2VuZGVyLCBfb3BlcmF0aW9uKTsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgLy8gbm90IGVub3VnaDogcmVjb3JkIHRoYXQgdGhpcyBvd25lciBpbiBwYXJ0aWN1bGFyIGNvbmZpcm1lZC4KICAgICAgICAgICAgICAgIHBlbmRpbmcueWV0TmVlZGVkLS07CiAgICAgICAgICAgICAgICBwZW5kaW5nLm93bmVyc0RvbmUgfD0gb3duZXJJbmRleEJpdDsKICAgICAgICAgICAgICAgIGFzc2VydE9wZXJhdGlvbklzQ29uc2lzdGVudChfb3BlcmF0aW9uKTsKICAgICAgICAgICAgICAgIENvbmZpcm1hdGlvbihtc2cuc2VuZGVyLCBfb3BlcmF0aW9uKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvLyBSZWNsYWltcyBmcmVlIHNsb3RzIGJldHdlZW4gdmFsaWQgb3duZXJzIGluIG1fb3duZXJzLgogICAgLy8gVE9ETyBnaXZlbiB0aGF0IGl0cyBjYWxsZWQgYWZ0ZXIgZWFjaCByZW1vdmFsLCBpdCBjb3VsZCBiZSBzaW1wbGlmaWVkLgogICAgZnVuY3Rpb24gcmVvcmdhbml6ZU93bmVycygpIHByaXZhdGUgewogICAgICAgIHVpbnQgZnJlZSA9IDE7CiAgICAgICAgd2hpbGUgKGZyZWUgPCBtX251bU93bmVycykKICAgICAgICB7CiAgICAgICAgICAgIC8vIGl0ZXJhdGluZyB0byB0aGUgZmlyc3QgZnJlZSBzbG90IGZyb20gdGhlIGJlZ2lubmluZwogICAgICAgICAgICB3aGlsZSAoZnJlZSA8IG1fbnVtT3duZXJzICYmIG1fb3duZXJzW2ZyZWVdICE9IDApIGZyZWUrKzsKCiAgICAgICAgICAgIC8vIGl0ZXJhdGluZyB0byB0aGUgZmlyc3Qgb2NjdXBpZWQgc2xvdCBmcm9tIHRoZSBlbmQKICAgICAgICAgICAgd2hpbGUgKG1fbnVtT3duZXJzID4gMSAmJiBtX293bmVyc1ttX251bU93bmVyc10gPT0gMCkgbV9udW1Pd25lcnMtLTsKCiAgICAgICAgICAgIC8vIHN3YXAsIGlmIHBvc3NpYmxlLCBzbyBmcmVlIHNsb3QgaXMgbG9jYXRlZCBhdCB0aGUgZW5kIGFmdGVyIHRoZSBzd2FwCiAgICAgICAgICAgIGlmIChmcmVlIDwgbV9udW1Pd25lcnMgJiYgbV9vd25lcnNbbV9udW1Pd25lcnNdICE9IDAgJiYgbV9vd25lcnNbZnJlZV0gPT0gMCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgLy8gb3duZXJzIGJldHdlZW4gc3dhcHBlZCBzbG90cyBzaG91bGQndCBiZSByZW51bWJlcmVkIC0gdGhhdCBzYXZlcyBhIGxvdCBvZiBnYXMKICAgICAgICAgICAgICAgIG1fb3duZXJzW2ZyZWVdID0gbV9vd25lcnNbbV9udW1Pd25lcnNdOwogICAgICAgICAgICAgICAgbV9vd25lckluZGV4W21fb3duZXJzW2ZyZWVdXSA9IGZyZWU7CiAgICAgICAgICAgICAgICBtX293bmVyc1ttX251bU93bmVyc10gPSAwOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGNsZWFyUGVuZGluZygpIHByaXZhdGUgb25seW93bmVyIHsKICAgICAgICB1aW50IGxlbmd0aCA9IG1fbXVsdGlPd25lZFBlbmRpbmdJbmRleC5sZW5ndGg7CiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHsKICAgICAgICAgICAgaWYgKG1fbXVsdGlPd25lZFBlbmRpbmdJbmRleFtpXSAhPSAwKQogICAgICAgICAgICAgICAgZGVsZXRlIG1fbXVsdGlPd25lZFBlbmRpbmdbbV9tdWx0aU93bmVkUGVuZGluZ0luZGV4W2ldXTsKICAgICAgICB9CiAgICAgICAgZGVsZXRlIG1fbXVsdGlPd25lZFBlbmRpbmdJbmRleDsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGVja093bmVySW5kZXgodWludCBvd25lckluZGV4KSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICBhc3NlcnQoMCAhPSBvd25lckluZGV4ICYmIG93bmVySW5kZXggPD0gY19tYXhPd25lcnMpOwogICAgICAgIHJldHVybiBvd25lckluZGV4OwogICAgfQoKICAgIGZ1bmN0aW9uIG1ha2VPd25lckJpdG1hcEJpdChhZGRyZXNzIG93bmVyKSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICB1aW50IG93bmVySW5kZXggPSBjaGVja093bmVySW5kZXgobV9vd25lckluZGV4W293bmVyXSk7CiAgICAgICAgcmV0dXJuIDIgKiogb3duZXJJbmRleDsKICAgIH0KCiAgICBmdW5jdGlvbiBpc09wZXJhdGlvbkFjdGl2ZShieXRlczMyIF9vcGVyYXRpb24pIHByaXZhdGUgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiAwICE9IG1fbXVsdGlPd25lZFBlbmRpbmdbX29wZXJhdGlvbl0ueWV0TmVlZGVkOwogICAgfQoKCiAgICBmdW5jdGlvbiBhc3NlcnRPd25lcnNBcmVDb25zaXN0ZW50KCkgcHJpdmF0ZSBjb25zdGFudCB7CiAgICAgICAgYXNzZXJ0KG1fbnVtT3duZXJzID4gMCk7CiAgICAgICAgYXNzZXJ0KG1fbnVtT3duZXJzIDw9IGNfbWF4T3duZXJzKTsKICAgICAgICBhc3NlcnQobV9vd25lcnNbMF0gPT0gMCk7CiAgICAgICAgYXNzZXJ0KDAgIT0gbV9tdWx0aU93bmVkUmVxdWlyZWQgJiYgbV9tdWx0aU93bmVkUmVxdWlyZWQgPD0gbV9udW1Pd25lcnMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGFzc2VydE9wZXJhdGlvbklzQ29uc2lzdGVudChieXRlczMyIF9vcGVyYXRpb24pIHByaXZhdGUgY29uc3RhbnQgewogICAgICAgIHZhciBwZW5kaW5nID0gbV9tdWx0aU93bmVkUGVuZGluZ1tfb3BlcmF0aW9uXTsKICAgICAgICBhc3NlcnQoMCAhPSBwZW5kaW5nLnlldE5lZWRlZCk7CiAgICAgICAgYXNzZXJ0KG1fbXVsdGlPd25lZFBlbmRpbmdJbmRleFtwZW5kaW5nLmluZGV4XSA9PSBfb3BlcmF0aW9uKTsKICAgICAgICBhc3NlcnQocGVuZGluZy55ZXROZWVkZWQgPD0gbV9tdWx0aU93bmVkUmVxdWlyZWQpOwogICAgfQoKCiAgIAkvLyBGSUVMRFMKCiAgICB1aW50IGNvbnN0YW50IGNfbWF4T3duZXJzID0gMjUwOwoKICAgIC8vIHRoZSBudW1iZXIgb2Ygb3duZXJzIHRoYXQgbXVzdCBjb25maXJtIHRoZSBzYW1lIG9wZXJhdGlvbiBiZWZvcmUgaXQgaXMgcnVuLgogICAgdWludCBwdWJsaWMgbV9tdWx0aU93bmVkUmVxdWlyZWQ7CgoKICAgIC8vIHBvaW50ZXIgdXNlZCB0byBmaW5kIGEgZnJlZSBzbG90IGluIG1fb3duZXJzCiAgICB1aW50IHB1YmxpYyBtX251bU93bmVyczsKCiAgICAvLyBsaXN0IG9mIG93bmVycyAoYWRkcmVzc2VzKSwKICAgIC8vIHNsb3QgMCBpcyB1bnVzZWQgc28gdGhlcmUgYXJlIG5vIG93bmVyIHdoaWNoIGluZGV4IGlzIDAuCiAgICAvLyBUT0RPIGNvdWxkIHdlIHNhdmUgc3BhY2UgYXQgdGhlIGVuZCBvZiB0aGUgYXJyYXkgZm9yIHRoZSBjb21tb24gY2FzZSBvZiA8MTAgb3duZXJzPyBhbmQgc2hvdWxkIHdlPwogICAgYWRkcmVzc1syNTZdIGludGVybmFsIG1fb3duZXJzOwoKICAgIC8vIGluZGV4IG9uIHRoZSBsaXN0IG9mIG93bmVycyB0byBhbGxvdyByZXZlcnNlIGxvb2t1cDogb3duZXIgYWRkcmVzcyA9PiBpbmRleCBpbiBtX293bmVycwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIGludGVybmFsIG1fb3duZXJJbmRleDsKCgogICAgLy8gdGhlIG9uZ29pbmcgb3BlcmF0aW9ucy4KICAgIG1hcHBpbmcoYnl0ZXMzMiA9PiBNdWx0aU93bmVkT3BlcmF0aW9uUGVuZGluZ1N0YXRlKSBpbnRlcm5hbCBtX211bHRpT3duZWRQZW5kaW5nOwogICAgYnl0ZXMzMltdIGludGVybmFsIG1fbXVsdGlPd25lZFBlbmRpbmdJbmRleDsKfQoKCi8qKgogKiBAdGl0bGUgQ29udHJhY3Qgd2hpY2ggaXMgb3duZWQgYnkgb3duZXJzIGFuZCBvcGVyYXRlZCBieSBjb250cm9sbGVyLgogKgogKiBAbm90aWNlIFByb3ZpZGVzIGEgd2F5IHRvIHNldCB1cCBhbiBlbnRpdHkgKHR5cGljYWxseSBvdGhlciBjb250cmFjdCkgZW50aXRsZWQgdG8gY29udHJvbCBhY3Rpb25zIG9mIHRoaXMgY29udHJhY3QuCiAqIENvbnRyb2xsZXIgaXMgc2V0IHVwIGJ5IG93bmVycyBvciBkdXJpbmcgY29uc3RydWN0aW9uLgogKgogKiBAZGV2IGNvbnRyb2xsZXIgY2hlY2sgaXMgcGVyZm9ybWVkIGJ5IG9ubHlDb250cm9sbGVyIG1vZGlmaWVyLgogKi8KY29udHJhY3QgTXVsdGlvd25lZENvbnRyb2xsZWQgaXMgbXVsdGlvd25lZCB7CgogICAgZXZlbnQgQ29udHJvbGxlclNldChhZGRyZXNzIGNvbnRyb2xsZXIpOwogICAgZXZlbnQgQ29udHJvbGxlclJldGlyZWQoYWRkcmVzcyB3YXMpOwoKCiAgICBtb2RpZmllciBvbmx5Q29udHJvbGxlciB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG1fY29udHJvbGxlcik7CiAgICAgICAgXzsKICAgIH0KCgogICAgLy8gUFVCTElDIGludGVyZmFjZQoKICAgIGZ1bmN0aW9uIE11bHRpb3duZWRDb250cm9sbGVkKGFkZHJlc3NbXSBfb3duZXJzLCB1aW50IF9zaWduYXR1cmVzUmVxdWlyZWQsIGFkZHJlc3MgX2NvbnRyb2xsZXIpCiAgICAgICAgbXVsdGlvd25lZChfb3duZXJzLCBfc2lnbmF0dXJlc1JlcXVpcmVkKQogICAgewogICAgICAgIG1fY29udHJvbGxlciA9IF9jb250cm9sbGVyOwogICAgICAgIENvbnRyb2xsZXJTZXQobV9jb250cm9sbGVyKTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBzZXRzIHRoZSBjb250cm9sbGVyCiAgICBmdW5jdGlvbiBzZXRDb250cm9sbGVyKGFkZHJlc3MgX2NvbnRyb2xsZXIpIGV4dGVybmFsIG9ubHltYW55b3duZXJzKHNoYTMobXNnLmRhdGEpKSB7CiAgICAgICAgbV9jb250cm9sbGVyID0gX2NvbnRyb2xsZXI7CiAgICAgICAgQ29udHJvbGxlclNldChtX2NvbnRyb2xsZXIpOwogICAgfQoKICAgIC8vLyBAbm90aWNlIGFiaWxpdHkgZm9yIGNvbnRyb2xsZXIgdG8gc3RlcCBkb3duCiAgICBmdW5jdGlvbiBkZXRhY2hDb250cm9sbGVyKCkgZXh0ZXJuYWwgb25seUNvbnRyb2xsZXIgewogICAgICAgIGFkZHJlc3Mgd2FzID0gbV9jb250cm9sbGVyOwogICAgICAgIG1fY29udHJvbGxlciA9IGFkZHJlc3MoMCk7CiAgICAgICAgQ29udHJvbGxlclJldGlyZWQod2FzKTsKICAgIH0KCgogICAgLy8gRklFTERTCgogICAgLy8vIEBub3RpY2UgYWRkcmVzcyBvZiBlbnRpdHkgZW50aXRsZWQgdG8gbWludCBuZXcgdG9rZW5zCiAgICBhZGRyZXNzIHB1YmxpYyBtX2NvbnRyb2xsZXI7Cn0KCgovLy8gQHRpdGxlIFN0YW5kYXJkVG9rZW4gd2hpY2ggY2FuIGJlIG1pbnRlZCBieSBhbm90aGVyIGNvbnRyYWN0Lgpjb250cmFjdCBNaW50YWJsZU11bHRpb3duZWRUb2tlbiBpcyBNdWx0aW93bmVkQ29udHJvbGxlZCwgU3RhbmRhcmRUb2tlbiB7CgogICAgLy8vIEBkZXYgcGFyYW1ldGVycyBvZiBhbiBleHRyYSB0b2tlbiBlbWlzc2lvbgogICAgc3RydWN0IEVtaXNzaW9uSW5mbyB7CiAgICAgICAgLy8gdG9rZW5zIGNyZWF0ZWQKICAgICAgICB1aW50MjU2IGNyZWF0ZWQ7CgogICAgICAgIC8vIHRvdGFsU3VwcGx5IGF0IHRoZSBtb21lbnQgb2YgZW1pc3Npb24gKGV4Y2x1ZGluZyBjcmVhdGVkIHRva2VucykKICAgICAgICB1aW50MjU2IHRvdGFsU3VwcGx5V2FzOwogICAgfQoKICAgIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGFtb3VudCk7CiAgICBldmVudCBFbWlzc2lvbih1aW50MjU2IHRva2Vuc0NyZWF0ZWQsIHVpbnQyNTYgdG90YWxTdXBwbHlXYXMsIHVpbnQyNTYgdGltZSk7CiAgICBldmVudCBEaXZpZGVuZChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKCgogICAgLy8gUFVCTElDIGludGVyZmFjZQoKICAgIGZ1bmN0aW9uIE1pbnRhYmxlTXVsdGlvd25lZFRva2VuKGFkZHJlc3NbXSBfb3duZXJzLCB1aW50IF9zaWduYXR1cmVzUmVxdWlyZWQsIGFkZHJlc3MgX21pbnRlcikKICAgICAgICBNdWx0aW93bmVkQ29udHJvbGxlZChfb3duZXJzLCBfc2lnbmF0dXJlc1JlcXVpcmVkLCBfbWludGVyKQogICAgewogICAgICAgIGRpdmlkZW5kc1Bvb2wgPSB0aGlzOyAgIC8vIG9yIGFueSBvdGhlciBzcGVjaWFsIHVuZm9yZ2VhYmxlIHZhbHVlLCBhY3R1YWxseQoKICAgICAgICAvLyBlbWlzc2lvbiAjMCBpcyBhIGR1bW15OiBiZWNhdXNlIG9mIGRlZmF1bHQgdmFsdWUgMCBpbiBtX2xhc3RBY2NvdW50RW1pc3Npb24KICAgICAgICBtX2VtaXNzaW9ucy5wdXNoKEVtaXNzaW9uSW5mbyh7Y3JlYXRlZDogMCwgdG90YWxTdXBwbHlXYXM6IDB9KSk7CiAgICB9CgogICAgLy8vIEBub3RpY2UgUmVxdWVzdCBkaXZpZGVuZHMgZm9yIGN1cnJlbnQgYWNjb3VudC4KICAgIGZ1bmN0aW9uIHJlcXVlc3REaXZpZGVuZHMoKSBleHRlcm5hbCB7CiAgICAgICAgcGF5RGl2aWRlbmRzVG8obXNnLnNlbmRlcik7CiAgICB9CgogICAgLy8vIEBub3RpY2UgaG9vayBvbiBzdGFuZGFyZCBFUkMyMCN0cmFuc2ZlciB0byBwYXkgZGl2aWRlbmRzCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBwYXlEaXZpZGVuZHNUbyhtc2cuc2VuZGVyKTsKICAgICAgICBwYXlEaXZpZGVuZHNUbyhfdG8pOwogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgLy8vIEBub3RpY2UgaG9vayBvbiBzdGFuZGFyZCBFUkMyMCN0cmFuc2ZlckZyb20gdG8gcGF5IGRpdmlkZW5kcwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHBheURpdmlkZW5kc1RvKF9mcm9tKTsKICAgICAgICBwYXlEaXZpZGVuZHNUbyhfdG8pOwogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICAvLyBEaXNhYmxlZDogdGhpcyBjb3VsZCBiZSB1bmRlc2lyYWJsZSBiZWNhdXNlIHN1bSBvZiAoYmFsYW5jZU9mKCkgZm9yIGVhY2ggdG9rZW4gb3duZXIpICE9IHRvdGFsU3VwcGx5CiAgICAvLyAoYnV0OiBzdW0gb2YgKGJhbGFuY2VzW293bmVyXSBmb3IgZWFjaCB0b2tlbiBvd25lcikgPT0gdG90YWxTdXBwbHkhKS4KICAgIC8vCiAgICAvLyBAbm90aWNlIGhvb2sgb24gc3RhbmRhcmQgRVJDMjAjYmFsYW5jZU9mIHRvIHRha2UgZGl2aWRlbmRzIGludG8gY29uc2lkZXJhdGlvbgogICAgLy8gZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyAgICAgdmFyIChoYXNOZXdEaXZpZGVuZHMsIGRpdmlkZW5kcykgPSBjYWxjdWxhdGVEaXZpZGVuZHNGb3IoX293bmVyKTsKICAgIC8vICAgICByZXR1cm4gaGFzTmV3RGl2aWRlbmRzID8gc3VwZXIuYmFsYW5jZU9mKF9vd25lcikuYWRkKGRpdmlkZW5kcykgOiBzdXBlci5iYWxhbmNlT2YoX293bmVyKTsKICAgIC8vIH0KCgogICAgLy8vIEBkZXYgbWludHMgbmV3IHRva2VucwogICAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBleHRlcm5hbCBvbmx5Q29udHJvbGxlciB7CiAgICAgICAgcmVxdWlyZShtX2V4dGVybmFsTWludGluZ0VuYWJsZWQpOwogICAgICAgIHBheURpdmlkZW5kc1RvKF90byk7CiAgICAgICAgbWludEludGVybmFsKF90bywgX2Ftb3VudCk7CiAgICB9CgogICAgLy8vIEBkZXYgZGlzYWJsZXMgbWludCgpLCBpcnJldmVyc2libGUhCiAgICBmdW5jdGlvbiBkaXNhYmxlTWludGluZygpIGV4dGVybmFsIG9ubHlDb250cm9sbGVyIHsKICAgICAgICByZXF1aXJlKG1fZXh0ZXJuYWxNaW50aW5nRW5hYmxlZCk7CiAgICAgICAgbV9leHRlcm5hbE1pbnRpbmdFbmFibGVkID0gZmFsc2U7CiAgICB9CgoKICAgIC8vIElOVEVSTkFMIGZ1bmN0aW9ucwoKICAgIC8qKgogICAgICogQG5vdGljZSBTdGFydHMgbmV3IHRva2VuIGVtaXNzaW9uCiAgICAgKiBAcGFyYW0gX3Rva2Vuc0NyZWF0ZWQgQW1vdW50IG9mIHRva2VucyB0byBjcmVhdGUKICAgICAqIEBkZXYgRGl2aWRlbmRzIGFyZSBub3QgZGlzdHJpYnV0ZWQgaW1tZWRpYXRlbHkgYXMgaXQgY291bGQgcmVxdWlyZSBiaWxsaW9ucyBvZiBnYXMsCiAgICAgKiBpbnN0ZWFkIHRoZXkgYXJlIGBwdWxsZWRgIGJ5IGEgaG9sZGVyIGZyb20gZGl2aWRlbmRzIHBvb2wgYWNjb3VudCBiZWZvcmUgYW55IHVwZGF0ZSB0byB0aGUgaG9sZGVyIGFjY291bnQgb2NjdXJzLgogICAgICovCiAgICBmdW5jdGlvbiBlbWlzc2lvbkludGVybmFsKHVpbnQyNTYgX3Rva2Vuc0NyZWF0ZWQpIGludGVybmFsIHsKICAgICAgICByZXF1aXJlKDAgIT0gX3Rva2Vuc0NyZWF0ZWQpOwogICAgICAgIHJlcXVpcmUoX3Rva2Vuc0NyZWF0ZWQgPCB0b3RhbFN1cHBseSAvIDIpOyAgLy8gb3RoZXJ3aXNlIGl0IGxvb2tzIGxpa2UgYW4gZXJyb3IKCiAgICAgICAgdWludDI1NiB0b3RhbFN1cHBseVdhcyA9IHRvdGFsU3VwcGx5OwoKICAgICAgICBtX2VtaXNzaW9ucy5wdXNoKEVtaXNzaW9uSW5mbyh7Y3JlYXRlZDogX3Rva2Vuc0NyZWF0ZWQsIHRvdGFsU3VwcGx5V2FzOiB0b3RhbFN1cHBseVdhc30pKTsKICAgICAgICBtaW50SW50ZXJuYWwoZGl2aWRlbmRzUG9vbCwgX3Rva2Vuc0NyZWF0ZWQpOwoKICAgICAgICBFbWlzc2lvbihfdG9rZW5zQ3JlYXRlZCwgdG90YWxTdXBwbHlXYXMsIG5vdyk7CiAgICB9CgogICAgZnVuY3Rpb24gbWludEludGVybmFsKGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIGludGVybmFsIHsKICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfYW1vdW50KTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICAgICAgTWludChfdG8sIF9hbW91bnQpOwogICAgfQoKICAgIC8vLyBAZGV2IGFkZHMgZGl2aWRlbmRzIHRvIHRoZSBhY2NvdW50IF90bwogICAgZnVuY3Rpb24gcGF5RGl2aWRlbmRzVG8oYWRkcmVzcyBfdG8pIGludGVybmFsIHsKICAgICAgICB2YXIgKGhhc05ld0RpdmlkZW5kcywgZGl2aWRlbmRzKSA9IGNhbGN1bGF0ZURpdmlkZW5kc0ZvcihfdG8pOwogICAgICAgIGlmICghaGFzTmV3RGl2aWRlbmRzKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIGlmICgwICE9IGRpdmlkZW5kcykgewogICAgICAgICAgICBiYWxhbmNlc1tkaXZpZGVuZHNQb29sXSA9IGJhbGFuY2VzW2RpdmlkZW5kc1Bvb2xdLnN1YihkaXZpZGVuZHMpOwogICAgICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoZGl2aWRlbmRzKTsKICAgICAgICB9CiAgICAgICAgbV9sYXN0QWNjb3VudEVtaXNzaW9uW190b10gPSBnZXRMYXN0RW1pc3Npb25OdW0oKTsKICAgIH0KCiAgICAvLy8gQGRldiBjYWxjdWxhdGVzIGRpdmlkZW5kcyBmb3IgdGhlIGFjY291bnQgX2ZvcgogICAgLy8vIEByZXR1cm4gKHRydWUgaWYgc3RhdGUgaGFzIHRvIGJlIHVwZGF0ZWQsIGRpdmlkZW5kIGFtb3VudCAoY291bGQgYmUgMCEpKQogICAgZnVuY3Rpb24gY2FsY3VsYXRlRGl2aWRlbmRzRm9yKGFkZHJlc3MgX2ZvcikgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCBoYXNOZXdEaXZpZGVuZHMsIHVpbnQgZGl2aWRlbmRzKSB7CiAgICAgICAgYXNzZXJ0KF9mb3IgIT0gZGl2aWRlbmRzUG9vbCk7ICAvLyBubyBkaXZpZGVuZHMgZm9yIHRoZSBwb29sIQoKICAgICAgICB1aW50MjU2IGxhc3RFbWlzc2lvbk51bSA9IGdldExhc3RFbWlzc2lvbk51bSgpOwogICAgICAgIHVpbnQyNTYgbGFzdEFjY291bnRFbWlzc2lvbk51bSA9IG1fbGFzdEFjY291bnRFbWlzc2lvbltfZm9yXTsKICAgICAgICBhc3NlcnQobGFzdEFjY291bnRFbWlzc2lvbk51bSA8PSBsYXN0RW1pc3Npb25OdW0pOwogICAgICAgIGlmIChsYXN0QWNjb3VudEVtaXNzaW9uTnVtID09IGxhc3RFbWlzc2lvbk51bSkKICAgICAgICAgICAgcmV0dXJuIChmYWxzZSwgMCk7CgogICAgICAgIHVpbnQyNTYgaW5pdGlhbEJhbGFuY2UgPSBiYWxhbmNlc1tfZm9yXTsgICAgLy8gYmV3YXJlIG9mIHJlY3Vyc2lvbiEKICAgICAgICBpZiAoMCA9PSBpbml0aWFsQmFsYW5jZSkKICAgICAgICAgICAgcmV0dXJuICh0cnVlLCAwKTsKCiAgICAgICAgdWludDI1NiBiYWxhbmNlID0gaW5pdGlhbEJhbGFuY2U7CiAgICAgICAgZm9yICh1aW50MjU2IGVtaXNzaW9uVG9Qcm9jZXNzID0gbGFzdEFjY291bnRFbWlzc2lvbk51bSArIDE7IGVtaXNzaW9uVG9Qcm9jZXNzIDw9IGxhc3RFbWlzc2lvbk51bTsgZW1pc3Npb25Ub1Byb2Nlc3MrKykgewogICAgICAgICAgICBFbWlzc2lvbkluZm8gc3RvcmFnZSBlbWlzc2lvbiA9IG1fZW1pc3Npb25zW2VtaXNzaW9uVG9Qcm9jZXNzXTsKICAgICAgICAgICAgYXNzZXJ0KDAgIT0gZW1pc3Npb24uY3JlYXRlZCAmJiAwICE9IGVtaXNzaW9uLnRvdGFsU3VwcGx5V2FzKTsKCiAgICAgICAgICAgIHVpbnQyNTYgZGl2aWRlbmQgPSBiYWxhbmNlLm11bChlbWlzc2lvbi5jcmVhdGVkKS5kaXYoZW1pc3Npb24udG90YWxTdXBwbHlXYXMpOwogICAgICAgICAgICBEaXZpZGVuZChfZm9yLCBkaXZpZGVuZCk7CgogICAgICAgICAgICBiYWxhbmNlID0gYmFsYW5jZS5hZGQoZGl2aWRlbmQpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuICh0cnVlLCBiYWxhbmNlLnN1Yihpbml0aWFsQmFsYW5jZSkpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldExhc3RFbWlzc2lvbk51bSgpIHByaXZhdGUgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBtX2VtaXNzaW9ucy5sZW5ndGggLSAxOwogICAgfQoKCiAgICAvLyBGSUVMRFMKCiAgICAvLy8gQG5vdGljZSBpZiB0aGlzIHRydWUgdGhlbiB0b2tlbiBpcyBzdGlsbCBleHRlcm5hbGx5IG1pbnRhYmxlIChidXQgdGhpcyBmbGFnIGRvZXMndCBhZmZlY3QgZW1pc3Npb25zISkKICAgIGJvb2wgcHVibGljIG1fZXh0ZXJuYWxNaW50aW5nRW5hYmxlZCA9IHRydWU7CgogICAgLy8vIEBkZXYgaW50ZXJuYWwgYWRkcmVzcyBvZiBkaXZpZGVuZHMgaW4gYmFsYW5jZXMgbWFwcGluZy4KICAgIGFkZHJlc3MgZGl2aWRlbmRzUG9vbDsKCiAgICAvLy8gQG5vdGljZSByZWNvcmQgb2YgaXNzdWVkIGRpdmlkZW5kIGVtaXNzaW9ucwogICAgRW1pc3Npb25JbmZvW10gcHVibGljIG1fZW1pc3Npb25zOwoKICAgIC8vLyBAZGV2IGZvciBlYWNoIHRva2VuIGhvbGRlcjogbGFzdCBlbWlzc2lvbiAoaW5kZXggaW4gbV9lbWlzc2lvbnMpIHdoaWNoIHdhcyBwcm9jZXNzZWQgZm9yIHRoaXMgaG9sZGVyCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgbV9sYXN0QWNjb3VudEVtaXNzaW9uOwp9CgoKLy8vIEB0aXRsZSBTdG9yaXFhIGNvaW4gY29udHJhY3QKY29udHJhY3QgU1RRVG9rZW4gaXMgQ2lyY3VsYXRpbmdUb2tlbiwgTWludGFibGVNdWx0aW93bmVkVG9rZW4gewoKCiAgICAvLyBQVUJMSUMgaW50ZXJmYWNlCgogICAgZnVuY3Rpb24gU1RRVG9rZW4oYWRkcmVzc1tdIF9vd25lcnMpCiAgICAgICAgTWludGFibGVNdWx0aW93bmVkVG9rZW4oX293bmVycywgMiwgLyogbWludGVyOiAqLyBhZGRyZXNzKDApKQogICAgewogICAgICAgIHJlcXVpcmUoMyA9PSBfb3duZXJzLmxlbmd0aCk7CiAgICB9CgogICAgLy8vIEBub3RpY2UgQWxsb3dzIHRva2VuIHRyYW5zZmVycwogICAgZnVuY3Rpb24gc3RhcnRDaXJjdWxhdGlvbigpIGV4dGVybmFsIG9ubHlDb250cm9sbGVyIHsKICAgICAgICBhc3NlcnQoZW5hYmxlQ2lyY3VsYXRpb24oKSk7ICAgIC8vIG11c3QgYmUgY2FsbGVkIG9uY2UKICAgIH0KCiAgICAvLy8gQG5vdGljZSBTdGFydHMgbmV3IHRva2VuIGVtaXNzaW9uCiAgICAvLy8gQHBhcmFtIF90b2tlbnNDcmVhdGVkSW5TVFEgQW1vdW50IG9mIFNUUSAobm90IFNUUS13ZWkhKSB0byBjcmVhdGUsIGxpa2UgMzAgMDAwIG9yIHNvCiAgICBmdW5jdGlvbiBlbWlzc2lvbih1aW50MjU2IF90b2tlbnNDcmVhdGVkSW5TVFEpIGV4dGVybmFsIG9ubHltYW55b3duZXJzKHNoYTMobXNnLmRhdGEpKSB7CiAgICAgICAgZW1pc3Npb25JbnRlcm5hbChfdG9rZW5zQ3JlYXRlZEluU1RRLm11bCh1aW50MjU2KDEwKSAqKiB1aW50MjU2KGRlY2ltYWxzKSkpOwogICAgfQoKCiAgICAvLyBGSUVMRFMKCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAnU3RvcmlxYSBUb2tlbic7CiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICdTVFEnOwogICAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7Cn0='.
	

]
