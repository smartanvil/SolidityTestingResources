Class {
	#name : #SRTd0792ac0de7ef31197c5f452b21a34389ecc725f,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd0792ac0de7ef31197c5f452b21a34389ecc725f >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7CgpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKLy8vIEB0aXRsZSBJbnRlcmZhY2UgZm9yIGNvbnRyYWN0cyBjb25mb3JtaW5nIHRvIEVSQy03MjE6IE5vbi1GdW5naWJsZSBUb2tlbnMKLy8vIEBhdXRob3IgRGlldGVyIFNoaXJsZXkgPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iYWNjOGM5ZDhjOWVjY2RkNGM1YzNjMWQ2YzljMjgyY2ZjMyI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj4+IChodHRwczovL2dpdGh1Yi5jb20vZGV0ZSkKY29udHJhY3QgRVJDNzIxIHsKICAgIC8vIFJlcXVpcmVkIG1ldGhvZHMKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiB0b3RhbCk7CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7CiAgICBmdW5jdGlvbiBvd25lck9mKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3Mgb3duZXIpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljOwoKICAgIC8vIEV2ZW50cwogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHRva2VuSWQpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBhcHByb3ZlZCwgdWludDI1NiB0b2tlbklkKTsKCiAgICAvLyBPcHRpb25hbAogICAgLy8gZnVuY3Rpb24gbmFtZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZyBuYW1lKTsKICAgIC8vIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZyBzeW1ib2wpOwogICAgLy8gZnVuY3Rpb24gdG9rZW5zT2ZPd25lcihhZGRyZXNzIF9vd25lcikgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2W10gdG9rZW5JZHMpOwogICAgLy8gZnVuY3Rpb24gdG9rZW5NZXRhZGF0YSh1aW50MjU2IF90b2tlbklkLCBzdHJpbmcgX3ByZWZlcnJlZFRyYW5zcG9ydCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nIGluZm9VcmwpOwoKICAgIC8vIEVSQy0xNjUgQ29tcGF0aWJpbGl0eSAoaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE2NSkKICAgIC8vIGZ1bmN0aW9uIHN1cHBvcnRzSW50ZXJmYWNlKGJ5dGVzNCBfaW50ZXJmYWNlSUQpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCk7Cn0KCmNvbnRyYWN0IENyeXB0b1dhdGVyTWFyZ2luIGlzIEVSQzcyMXsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgZXZlbnQgQm91Z2h0ICh1aW50MjU2IGluZGV4ZWQgX2l0ZW1JZCwgYWRkcmVzcyBpbmRleGVkIF9vd25lciwgdWludDI1NiBfcHJpY2UpOwogIGV2ZW50IFNvbGQgKHVpbnQyNTYgaW5kZXhlZCBfaXRlbUlkLCBhZGRyZXNzIGluZGV4ZWQgX293bmVyLCB1aW50MjU2IF9wcmljZSk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF90b2tlbklkKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX2FwcHJvdmVkLCB1aW50MjU2IF90b2tlbklkKTsKCiAgYWRkcmVzcyBwcml2YXRlIG93bmVyOwogIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHJpdmF0ZSBhZG1pbnM7CiAgSUl0ZW1SZWdpc3RyeSBwcml2YXRlIGl0ZW1SZWdpc3RyeTsKCiAgdWludDI1NiBwcml2YXRlIGluY3JlYXNlTGltaXQxID0gMC4wMiBldGhlcjsKICB1aW50MjU2IHByaXZhdGUgaW5jcmVhc2VMaW1pdDIgPSAwLjUgZXRoZXI7CiAgdWludDI1NiBwcml2YXRlIGluY3JlYXNlTGltaXQzID0gMi4wIGV0aGVyOwogIHVpbnQyNTYgcHJpdmF0ZSBpbmNyZWFzZUxpbWl0NCA9IDUuMCBldGhlcjsKCiAgdWludDI1NltdIHByaXZhdGUgbGlzdGVkSXRlbXM7CiAgbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSBwcml2YXRlIG93bmVyT2ZJdGVtOwogIG1hcHBpbmcgKHVpbnQyNTYgPT4gdWludDI1NikgcHJpdmF0ZSBwcmljZU9mSXRlbTsKICBtYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIHByaXZhdGUgYXBwcm92ZWRPZkl0ZW07CgogIGZ1bmN0aW9uIENyeXB0b1dhdGVyTWFyZ2luICgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICBhZG1pbnNbb3duZXJdID0gdHJ1ZTsgICAgCiAgICBpc3N1ZUNhcmQoMSwgNiwgMC4xIGV0aGVyKTsKICB9CgogIC8qIE1vZGlmaWVycyAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUob3duZXIgPT0gbXNnLnNlbmRlcik7CiAgICBfOwogIH0KCiAgbW9kaWZpZXIgb25seUFkbWlucygpIHsKICAgIHJlcXVpcmUoYWRtaW5zW21zZy5zZW5kZXJdKTsKICAgIF87CiAgfQoKICAvKiBPd25lciAqLwogIGZ1bmN0aW9uIHNldE93bmVyIChhZGRyZXNzIF9vd25lcikgb25seU93bmVyKCkgcHVibGljIHsKICAgIG93bmVyID0gX293bmVyOwogIH0KCiAgZnVuY3Rpb24gc2V0SXRlbVJlZ2lzdHJ5IChhZGRyZXNzIF9pdGVtUmVnaXN0cnkpIG9ubHlPd25lcigpIHB1YmxpYyB7CiAgICBpdGVtUmVnaXN0cnkgPSBJSXRlbVJlZ2lzdHJ5KF9pdGVtUmVnaXN0cnkpOwogIH0KCiAgZnVuY3Rpb24gYWRkQWRtaW4gKGFkZHJlc3MgX2FkbWluKSBvbmx5T3duZXIoKSBwdWJsaWMgewogICAgYWRtaW5zW19hZG1pbl0gPSB0cnVlOwogIH0KCiAgZnVuY3Rpb24gcmVtb3ZlQWRtaW4gKGFkZHJlc3MgX2FkbWluKSBvbmx5T3duZXIoKSBwdWJsaWMgewogICAgZGVsZXRlIGFkbWluc1tfYWRtaW5dOwogIH0KCiAgLyogV2l0aGRyYXcgKi8KICAvKgogICAgTk9USUNFOiBUaGVzZSBmdW5jdGlvbnMgd2l0aGRyYXcgdGhlIGRldmVsb3BlcidzIGN1dCB3aGljaCBpcyBsZWZ0CiAgICBpbiB0aGUgY29udHJhY3QgYnkgYGJ1eWAuIFVzZXIgZnVuZHMgYXJlIGltbWVkaWF0ZWx5IHNlbnQgdG8gdGhlIG9sZAogICAgb3duZXIgaW4gYGJ1eWAsIG5vIHVzZXIgZnVuZHMgYXJlIGxlZnQgaW4gdGhlIGNvbnRyYWN0LgogICovCiAgZnVuY3Rpb24gd2l0aGRyYXdBbGwgKCkgb25seUFkbWlucygpIHB1YmxpYyB7CiAgIG1zZy5zZW5kZXIudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICB9CgogIGZ1bmN0aW9uIHdpdGhkcmF3QW1vdW50ICh1aW50MjU2IF9hbW91bnQpIG9ubHlBZG1pbnMoKSBwdWJsaWMgewogICAgbXNnLnNlbmRlci50cmFuc2ZlcihfYW1vdW50KTsKICB9CgogIC8qIExpc3RpbmcgKi8KICBmdW5jdGlvbiBwb3B1bGF0ZUZyb21JdGVtUmVnaXN0cnkgKHVpbnQyNTZbXSBfaXRlbUlkcykgb25seU93bmVyKCkgcHVibGljIHsKICAgIGZvciAodWludDI1NiBpID0gMDsgaSA8IF9pdGVtSWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGlmIChwcmljZU9mSXRlbVtfaXRlbUlkc1tpXV0gPiAwIHx8IGl0ZW1SZWdpc3RyeS5wcmljZU9mKF9pdGVtSWRzW2ldKSA9PSAwKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGxpc3RJdGVtRnJvbVJlZ2lzdHJ5KF9pdGVtSWRzW2ldKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGxpc3RJdGVtRnJvbVJlZ2lzdHJ5ICh1aW50MjU2IF9pdGVtSWQpIG9ubHlPd25lcigpIHB1YmxpYyB7CiAgICByZXF1aXJlKGl0ZW1SZWdpc3RyeSAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoaXRlbVJlZ2lzdHJ5Lm93bmVyT2YoX2l0ZW1JZCkgIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKGl0ZW1SZWdpc3RyeS5wcmljZU9mKF9pdGVtSWQpID4gMCk7CgogICAgdWludDI1NiBwcmljZSA9IGl0ZW1SZWdpc3RyeS5wcmljZU9mKF9pdGVtSWQpOwogICAgYWRkcmVzcyBpdGVtT3duZXIgPSBpdGVtUmVnaXN0cnkub3duZXJPZihfaXRlbUlkKTsKICAgIGxpc3RJdGVtKF9pdGVtSWQsIHByaWNlLCBpdGVtT3duZXIpOwogIH0KCiAgZnVuY3Rpb24gbGlzdE11bHRpcGxlSXRlbXMgKHVpbnQyNTZbXSBfaXRlbUlkcywgdWludDI1NiBfcHJpY2UsIGFkZHJlc3MgX293bmVyKSBvbmx5QWRtaW5zKCkgZXh0ZXJuYWwgewogICAgZm9yICh1aW50MjU2IGkgPSAwOyBpIDwgX2l0ZW1JZHMubGVuZ3RoOyBpKyspIHsKICAgICAgbGlzdEl0ZW0oX2l0ZW1JZHNbaV0sIF9wcmljZSwgX293bmVyKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGxpc3RJdGVtICh1aW50MjU2IF9pdGVtSWQsIHVpbnQyNTYgX3ByaWNlLCBhZGRyZXNzIF9vd25lcikgb25seUFkbWlucygpIHB1YmxpYyB7CiAgICByZXF1aXJlKF9wcmljZSA+IDApOwogICAgcmVxdWlyZShwcmljZU9mSXRlbVtfaXRlbUlkXSA9PSAwKTsKICAgIHJlcXVpcmUob3duZXJPZkl0ZW1bX2l0ZW1JZF0gPT0gYWRkcmVzcygwKSk7CgogICAgb3duZXJPZkl0ZW1bX2l0ZW1JZF0gPSBfb3duZXI7CiAgICBwcmljZU9mSXRlbVtfaXRlbUlkXSA9IF9wcmljZTsKICAgIGxpc3RlZEl0ZW1zLnB1c2goX2l0ZW1JZCk7CiAgfQoKICAvKiBCdXlpbmcgKi8KICBmdW5jdGlvbiBjYWxjdWxhdGVOZXh0UHJpY2UgKHVpbnQyNTYgX3ByaWNlKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IF9uZXh0UHJpY2UpIHsKICAgIGlmIChfcHJpY2UgPCBpbmNyZWFzZUxpbWl0MSkgewogICAgICByZXR1cm4gX3ByaWNlLm11bCgyMDApLmRpdig5NSk7CiAgICB9IGVsc2UgaWYgKF9wcmljZSA8IGluY3JlYXNlTGltaXQyKSB7CiAgICAgIHJldHVybiBfcHJpY2UubXVsKDEzNSkuZGl2KDk2KTsKICAgIH0gZWxzZSBpZiAoX3ByaWNlIDwgaW5jcmVhc2VMaW1pdDMpIHsKICAgICAgcmV0dXJuIF9wcmljZS5tdWwoMTI1KS5kaXYoOTcpOwogICAgfSBlbHNlIGlmIChfcHJpY2UgPCBpbmNyZWFzZUxpbWl0NCkgewogICAgICByZXR1cm4gX3ByaWNlLm11bCgxMTcpLmRpdig5Nyk7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gX3ByaWNlLm11bCgxMTUpLmRpdig5OCk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjYWxjdWxhdGVEZXZDdXQgKHVpbnQyNTYgX3ByaWNlKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IF9kZXZDdXQpIHsKICAgIGlmIChfcHJpY2UgPCBpbmNyZWFzZUxpbWl0MSkgewogICAgICByZXR1cm4gX3ByaWNlLm11bCg1KS5kaXYoMTAwKTsgLy8gNSUKICAgIH0gZWxzZSBpZiAoX3ByaWNlIDwgaW5jcmVhc2VMaW1pdDIpIHsKICAgICAgcmV0dXJuIF9wcmljZS5tdWwoNCkuZGl2KDEwMCk7IC8vIDQlCiAgICB9IGVsc2UgaWYgKF9wcmljZSA8IGluY3JlYXNlTGltaXQzKSB7CiAgICAgIHJldHVybiBfcHJpY2UubXVsKDMpLmRpdigxMDApOyAvLyAzJQogICAgfSBlbHNlIGlmIChfcHJpY2UgPCBpbmNyZWFzZUxpbWl0NCkgewogICAgICByZXR1cm4gX3ByaWNlLm11bCgzKS5kaXYoMTAwKTsgLy8gMyUKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBfcHJpY2UubXVsKDIpLmRpdigxMDApOyAvLyAyJQogICAgfQogIH0KCiAgLyoKICAgICBCdXkgYSBjb3VudHJ5IGRpcmVjdGx5IGZyb20gdGhlIGNvbnRyYWN0IGZvciB0aGUgY2FsY3VsYXRlZCBwcmljZQogICAgIHdoaWNoIGVuc3VyZXMgdGhhdCB0aGUgb3duZXIgZ2V0cyBhIHByb2ZpdC4gIEFsbCBjb3VudHJpZXMgdGhhdAogICAgIGhhdmUgYmVlbiBsaXN0ZWQgY2FuIGJlIGJvdWdodCBieSB0aGlzIG1ldGhvZC4gVXNlciBmdW5kcyBhcmUgc2VudAogICAgIGRpcmVjdGx5IHRvIHRoZSBwcmV2aW91cyBvd25lciBhbmQgYXJlIG5ldmVyIHN0b3JlZCBpbiB0aGUgY29udHJhY3QuCiAgKi8KICBmdW5jdGlvbiBidXkgKHVpbnQyNTYgX2l0ZW1JZCkgcGF5YWJsZSBwdWJsaWMgewogICAgcmVxdWlyZShwcmljZU9mKF9pdGVtSWQpID4gMCk7CiAgICByZXF1aXJlKG93bmVyT2YoX2l0ZW1JZCkgIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSBwcmljZU9mKF9pdGVtSWQpKTsKICAgIHJlcXVpcmUob3duZXJPZihfaXRlbUlkKSAhPSBtc2cuc2VuZGVyKTsKICAgIHJlcXVpcmUoIWlzQ29udHJhY3QobXNnLnNlbmRlcikpOwogICAgcmVxdWlyZShtc2cuc2VuZGVyICE9IGFkZHJlc3MoMCkpOwoKICAgIGFkZHJlc3Mgb2xkT3duZXIgPSBvd25lck9mKF9pdGVtSWQpOwogICAgYWRkcmVzcyBuZXdPd25lciA9IG1zZy5zZW5kZXI7CiAgICB1aW50MjU2IHByaWNlID0gcHJpY2VPZihfaXRlbUlkKTsKICAgIHVpbnQyNTYgZXhjZXNzID0gbXNnLnZhbHVlLnN1YihwcmljZSk7CgogICAgX3RyYW5zZmVyKG9sZE93bmVyLCBuZXdPd25lciwgX2l0ZW1JZCk7CiAgICBwcmljZU9mSXRlbVtfaXRlbUlkXSA9IG5leHRQcmljZU9mKF9pdGVtSWQpOwoKICAgIEJvdWdodChfaXRlbUlkLCBuZXdPd25lciwgcHJpY2UpOwogICAgU29sZChfaXRlbUlkLCBvbGRPd25lciwgcHJpY2UpOwoKICAgIC8vIERldmV2bG9wZXIncyBjdXQgd2hpY2ggaXMgbGVmdCBpbiBjb250cmFjdCBhbmQgYWNjZXNlZCBieQogICAgLy8gYHdpdGhkcmF3QWxsYCBhbmQgYHdpdGhkcmF3QW1vdW50VG9gIG1ldGhvZHMuCiAgICB1aW50MjU2IGRldkN1dCA9IGNhbGN1bGF0ZURldkN1dChwcmljZSk7CgogICAgLy8gVHJhbnNmZXIgcGF5bWVudCB0byBvbGQgb3duZXIgbWludXMgdGhlIGRldmVsb3BlcidzIGN1dC4KICAgIG9sZE93bmVyLnRyYW5zZmVyKHByaWNlLnN1YihkZXZDdXQpKTsKCiAgICBpZiAoZXhjZXNzID4gMCkgewogICAgICBuZXdPd25lci50cmFuc2ZlcihleGNlc3MpOwogICAgfQogIH0KCiAgLyogRVJDNzIxICovCgogIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcgbmFtZSkgewogICAgcmV0dXJuICJDcnlwdG9oZXJvLnBybyI7CiAgfQoKICBmdW5jdGlvbiBzeW1ib2woKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcgc3ltYm9sKSB7CiAgICByZXR1cm4gIkNUSCI7CiAgfQoKICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgX3RvdGFsU3VwcGx5KSB7CiAgICByZXR1cm4gbGlzdGVkSXRlbXMubGVuZ3RoOwogIH0KCiAgZnVuY3Rpb24gYmFsYW5jZU9mIChhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBfYmFsYW5jZSkgewogICAgdWludDI1NiBjb3VudGVyID0gMDsKCiAgICBmb3IgKHVpbnQyNTYgaSA9IDA7IGkgPCBsaXN0ZWRJdGVtcy5sZW5ndGg7IGkrKykgewogICAgICBpZiAob3duZXJPZihsaXN0ZWRJdGVtc1tpXSkgPT0gX293bmVyKSB7CiAgICAgICAgY291bnRlcisrOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGNvdW50ZXI7CiAgfQoKICBmdW5jdGlvbiBvd25lck9mICh1aW50MjU2IF9pdGVtSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3MgX293bmVyKSB7CiAgICByZXR1cm4gb3duZXJPZkl0ZW1bX2l0ZW1JZF07CiAgfQoKICBmdW5jdGlvbiB0b2tlbnNPZiAoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTZbXSBfdG9rZW5JZHMpIHsKICAgIHVpbnQyNTZbXSBtZW1vcnkgaXRlbXMgPSBuZXcgdWludDI1NltdKGJhbGFuY2VPZihfb3duZXIpKTsKCiAgICB1aW50MjU2IGl0ZW1Db3VudGVyID0gMDsKICAgIGZvciAodWludDI1NiBpID0gMDsgaSA8IGxpc3RlZEl0ZW1zLmxlbmd0aDsgaSsrKSB7CiAgICAgIGlmIChvd25lck9mKGxpc3RlZEl0ZW1zW2ldKSA9PSBfb3duZXIpIHsKICAgICAgICBpdGVtc1tpdGVtQ291bnRlcl0gPSBsaXN0ZWRJdGVtc1tpXTsKICAgICAgICBpdGVtQ291bnRlciArPSAxOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGl0ZW1zOwogIH0KCiAgZnVuY3Rpb24gdG9rZW5FeGlzdHMgKHVpbnQyNTYgX2l0ZW1JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCBfZXhpc3RzKSB7CiAgICByZXR1cm4gcHJpY2VPZihfaXRlbUlkKSA+IDA7CiAgfQoKICBmdW5jdGlvbiBhcHByb3ZlZEZvcih1aW50MjU2IF9pdGVtSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3MgX2FwcHJvdmVkKSB7CiAgICByZXR1cm4gYXBwcm92ZWRPZkl0ZW1bX2l0ZW1JZF07CiAgfQoKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF9pdGVtSWQpIHB1YmxpYyB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgIT0gX3RvKTsKICAgIHJlcXVpcmUodG9rZW5FeGlzdHMoX2l0ZW1JZCkpOwogICAgcmVxdWlyZShvd25lck9mKF9pdGVtSWQpID09IG1zZy5zZW5kZXIpOwoKICAgIGlmIChfdG8gPT0gMCkgewogICAgICBpZiAoYXBwcm92ZWRPZkl0ZW1bX2l0ZW1JZF0gIT0gMCkgewogICAgICAgIGRlbGV0ZSBhcHByb3ZlZE9mSXRlbVtfaXRlbUlkXTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCAwLCBfaXRlbUlkKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgYXBwcm92ZWRPZkl0ZW1bX2l0ZW1JZF0gPSBfdG87CiAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF90bywgX2l0ZW1JZCk7CiAgICB9CiAgfQoKICAvKiBUcmFuc2ZlcnJpbmcgYSBjb3VudHJ5IHRvIGFub3RoZXIgb3duZXIgd2lsbCBlbnRpdGxlIHRoZSBuZXcgb3duZXIgdGhlIHByb2ZpdHMgZnJvbSBgYnV5YCAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF9pdGVtSWQpIHB1YmxpYyB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXJPZihfaXRlbUlkKSk7CiAgICBfdHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfaXRlbUlkKTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfaXRlbUlkKSBwdWJsaWMgewogICAgcmVxdWlyZShhcHByb3ZlZEZvcihfaXRlbUlkKSA9PSBtc2cuc2VuZGVyKTsKICAgIF90cmFuc2ZlcihfZnJvbSwgX3RvLCBfaXRlbUlkKTsKICB9CgogIGZ1bmN0aW9uIF90cmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfaXRlbUlkKSBpbnRlcm5hbCB7CiAgICByZXF1aXJlKHRva2VuRXhpc3RzKF9pdGVtSWQpKTsKICAgIHJlcXVpcmUob3duZXJPZihfaXRlbUlkKSA9PSBfZnJvbSk7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3ModGhpcykpOwoKICAgIG93bmVyT2ZJdGVtW19pdGVtSWRdID0gX3RvOwogICAgYXBwcm92ZWRPZkl0ZW1bX2l0ZW1JZF0gPSAwOwoKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF9pdGVtSWQpOwogIH0KCiAgLyogUmVhZCAqLwogIGZ1bmN0aW9uIGlzQWRtaW4gKGFkZHJlc3MgX2FkbWluKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sIF9pc0FkbWluKSB7CiAgICByZXR1cm4gYWRtaW5zW19hZG1pbl07CiAgfQoKICBmdW5jdGlvbiBwcmljZU9mICh1aW50MjU2IF9pdGVtSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgX3ByaWNlKSB7CiAgICByZXR1cm4gcHJpY2VPZkl0ZW1bX2l0ZW1JZF07CiAgfQoKICBmdW5jdGlvbiBuZXh0UHJpY2VPZiAodWludDI1NiBfaXRlbUlkKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IF9uZXh0UHJpY2UpIHsKICAgIHJldHVybiBjYWxjdWxhdGVOZXh0UHJpY2UocHJpY2VPZihfaXRlbUlkKSk7CiAgfQoKICBmdW5jdGlvbiBhbGxPZiAodWludDI1NiBfaXRlbUlkKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGFkZHJlc3MgX293bmVyLCB1aW50MjU2IF9wcmljZSwgdWludDI1NiBfbmV4dFByaWNlKSB7CiAgICByZXR1cm4gKG93bmVyT2YoX2l0ZW1JZCksIHByaWNlT2YoX2l0ZW1JZCksIG5leHRQcmljZU9mKF9pdGVtSWQpKTsKICB9CgogIGZ1bmN0aW9uIGl0ZW1zRm9yU2FsZUxpbWl0ICh1aW50MjU2IF9mcm9tLCB1aW50MjU2IF90YWtlKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2W10gX2l0ZW1zKSB7CiAgICB1aW50MjU2W10gbWVtb3J5IGl0ZW1zID0gbmV3IHVpbnQyNTZbXShfdGFrZSk7CgogICAgZm9yICh1aW50MjU2IGkgPSAwOyBpIDwgX3Rha2U7IGkrKykgewogICAgICBpdGVtc1tpXSA9IGxpc3RlZEl0ZW1zW19mcm9tICsgaV07CiAgICB9CgogICAgcmV0dXJuIGl0ZW1zOwogIH0KCiAgLyogVXRpbCAqLwogIGZ1bmN0aW9uIGlzQ29udHJhY3QoYWRkcmVzcyBhZGRyKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgIHVpbnQgc2l6ZTsKICAgIGFzc2VtYmx5IHsgc2l6ZSA6PSBleHRjb2Rlc2l6ZShhZGRyKSB9IC8vIHNvbGl1bS1kaXNhYmxlLWxpbmUKICAgIHJldHVybiBzaXplID4gMDsKICB9CiAgCiAgZnVuY3Rpb24gY2hhbmdlUHJpY2UodWludDI1NiBfaXRlbUlkLCB1aW50MjU2IF9wcmljZSkgcHVibGljIG9ubHlBZG1pbnMoKSB7CiAgICByZXF1aXJlKF9wcmljZSA+IDApOwogICAgcmVxdWlyZShhZG1pbnNbb3duZXJPZkl0ZW1bX2l0ZW1JZF1dKTsKICAgIHByaWNlT2ZJdGVtW19pdGVtSWRdID0gX3ByaWNlOwogIH0KICAKICBmdW5jdGlvbiBpc3N1ZUNhcmQodWludDI1NiBsLCB1aW50MjU2IHIsIHVpbnQyNTYgcHJpY2UpIG9ubHlBZG1pbnMoKSBwdWJsaWMgewogICAgZm9yICh1aW50MjU2IGkgPSBsOyBpIDw9IHI7IGkrKykgewogICAgICBvd25lck9mSXRlbVtpXSA9IG1zZy5zZW5kZXI7CiAgICAgIHByaWNlT2ZJdGVtW2ldID0gcHJpY2U7CiAgICAgIGxpc3RlZEl0ZW1zLnB1c2goaSk7CiAgICB9ICAgICAgCiAgIH0gIAp9ICAgCgppbnRlcmZhY2UgSUl0ZW1SZWdpc3RyeSB7CiAgZnVuY3Rpb24gaXRlbXNGb3JTYWxlTGltaXQgKHVpbnQyNTYgX2Zyb20sIHVpbnQyNTYgX3Rha2UpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTZbXSBfaXRlbXMpOwogIGZ1bmN0aW9uIG93bmVyT2YgKHVpbnQyNTYgX2l0ZW1JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBfb3duZXIpOwogIGZ1bmN0aW9uIHByaWNlT2YgKHVpbnQyNTYgX2l0ZW1JZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBfcHJpY2UpOwp9'.
	

]
