Class {
	#name : #SRTa0acc9fe716c39a68dafb8f10c75b1276b08a17c,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTa0acc9fe716c39a68dafb8f10c75b1276b08a17c >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7Cgpjb250cmFjdCBUaXR0eUJhc2UgewoKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8pOwogICAgZXZlbnQgQ3JlYXRpb24oYWRkcmVzcyBpbmRleGVkIGZyb20sIHVpbnQyNTYgdGl0dHlJZCwgdWludDI1NiB3cElkKTsKICAgIGV2ZW50IEFkZEFjY2Vzc29yeSh1aW50MjU2IHRpdHR5SWQsIHVpbnQyNTYgYWNjZXNzb3J5SWQpOwoKICAgIHN0cnVjdCBBY2Nlc3NvcnkgewoKICAgICAgICB1aW50MjU2IGlkOwogICAgICAgIHN0cmluZyBuYW1lOwogICAgICAgIHVpbnQyNTYgcHJpY2U7CiAgICAgICAgYm9vbCBpc0FjdGl2ZTsKCiAgICB9CgogICAgc3RydWN0IFRpdHR5IHsKCiAgICAgICAgdWludDI1NiBpZDsKICAgICAgICBzdHJpbmcgbmFtZTsKICAgICAgICBzdHJpbmcgZ2VuZGVyOwogICAgICAgIHVpbnQyNTYgb3JpZ2luYWxQcmljZTsKICAgICAgICB1aW50MjU2IHNhbGVQcmljZTsKICAgICAgICB1aW50MjU2W10gYWNjZXNzb3JpZXM7CiAgICAgICAgYm9vbCBmb3JTYWxlOwogICAgfQoKICAgIC8vU3RvcmFnZQogICAgVGl0dHlbXSBUaXR0aWVzOwogICAgQWNjZXNzb3J5W10gQWNjZXNzb3JpZXM7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIHB1YmxpYyB0aXR0eUluZGV4VG9Pd25lcjsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIG93bmVyVGl0dGllc0NvdW50OwogICAgbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSBwdWJsaWMgdGl0dHlBcHByb3ZlSW5kZXg7CgogICAgZnVuY3Rpb24gX3RyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90aXR0eUlkKSBpbnRlcm5hbCB7CgogICAgICAgIG93bmVyVGl0dGllc0NvdW50W190b10rKzsKCiAgICAgICAgdGl0dHlJbmRleFRvT3duZXJbX3RpdHR5SWRdID0gX3RvOwogICAgICAgIGlmIChfZnJvbSAhPSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIG93bmVyVGl0dGllc0NvdW50W19mcm9tXS0tOwogICAgICAgICAgICBkZWxldGUgdGl0dHlBcHByb3ZlSW5kZXhbX3RpdHR5SWRdOwogICAgICAgIH0KCiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90byk7CgogICAgfQoKICAgIGZ1bmN0aW9uIF9jaGFuZ2VUaXR0eVByaWNlICh1aW50MjU2IF9uZXdQcmljZSwgdWludDI1NiBfdGl0dHlJZCkgaW50ZXJuYWwgewoKICAgICAgICByZXF1aXJlKHRpdHR5SW5kZXhUb093bmVyW190aXR0eUlkXSA9PSBtc2cuc2VuZGVyKTsKICAgICAgICBUaXR0eSBzdG9yYWdlIF90aXR0eSA9IFRpdHRpZXNbX3RpdHR5SWRdOwogICAgICAgIF90aXR0eS5zYWxlUHJpY2UgPSBfbmV3UHJpY2U7CgogICAgICAgIFRpdHRpZXNbX3RpdHR5SWRdID0gX3RpdHR5OwogICAgfQoKICAgIGZ1bmN0aW9uIF9zZXRUaXR0eUZvclNhbGUgKGJvb2wgX2ZvclNhbGUsIHVpbnQyNTYgX3RpdHR5SWQpIGludGVybmFsIHsKCiAgICAgICAgcmVxdWlyZSh0aXR0eUluZGV4VG9Pd25lcltfdGl0dHlJZF0gPT0gbXNnLnNlbmRlcik7CiAgICAgICAgVGl0dHkgc3RvcmFnZSBfdGl0dHkgPSBUaXR0aWVzW190aXR0eUlkXTsKICAgICAgICBfdGl0dHkuZm9yU2FsZSA9IF9mb3JTYWxlOwoKICAgICAgICBUaXR0aWVzW190aXR0eUlkXSA9IF90aXR0eTsKICAgIH0KCiAgICBmdW5jdGlvbiBfY2hhbmdlTmFtZSAoc3RyaW5nIF9uYW1lLCB1aW50MjU2IF90aXR0eUlkKSBpbnRlcm5hbCB7CgogICAgICAgIHJlcXVpcmUodGl0dHlJbmRleFRvT3duZXJbX3RpdHR5SWRdID09IG1zZy5zZW5kZXIpOwogICAgICAgIFRpdHR5IHN0b3JhZ2UgX3RpdHR5ID0gVGl0dGllc1tfdGl0dHlJZF07CiAgICAgICAgX3RpdHR5Lm5hbWUgPSBfbmFtZTsKCiAgICAgICAgVGl0dGllc1tfdGl0dHlJZF0gPSBfdGl0dHk7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkQWNjZXNzb3J5ICh1aW50MjU2IF9pZCwgc3RyaW5nIF9uYW1lLCB1aW50MjU2IF9wcmljZSwgdWludDI1NiB0aXR0eUlkICkgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewoKICAgICAgICBBY2Nlc3NvcnkgbWVtb3J5IF9hY2Nlc3NvcnkgPSBBY2Nlc3NvcnkoewoKICAgICAgICAgICAgaWQ6IF9pZCwKICAgICAgICAgICAgbmFtZTogX25hbWUsCiAgICAgICAgICAgIHByaWNlOiBfcHJpY2UsCiAgICAgICAgICAgIGlzQWN0aXZlOiB0cnVlCgogICAgICAgIH0pOwoKICAgICAgICBUaXR0eSBzdG9yYWdlIHRpdHR5ID0gVGl0dGllc1t0aXR0eUlkXTsKICAgICAgICB1aW50MjU2IG5ld0FjY2Vzc29yeUlkID0gQWNjZXNzb3JpZXMucHVzaChfYWNjZXNzb3J5KSAtIDE7CiAgICAgICAgdGl0dHkuYWNjZXNzb3JpZXMucHVzaChuZXdBY2Nlc3NvcnlJZCk7CiAgICAgICAgQWRkQWNjZXNzb3J5KHRpdHR5SWQsIG5ld0FjY2Vzc29yeUlkKTsKCiAgICAgICAgcmV0dXJuIG5ld0FjY2Vzc29yeUlkOwoKICAgIH0KCiAgICBmdW5jdGlvbiB0b3RhbEFjY2Vzc29yaWVzKHVpbnQyNTYgX3RpdHR5SWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKCiAgICAgICAgVGl0dHkgc3RvcmFnZSB0aXR0eSA9IFRpdHRpZXNbX3RpdHR5SWRdOwogICAgICAgIHJldHVybiB0aXR0eS5hY2Nlc3Nvcmllcy5sZW5ndGg7CgogICAgfQoKICAgIGZ1bmN0aW9uIGdldEFjY2Vzc29yeSh1aW50MjU2IF90aXR0eUlkLCB1aW50MjU2IF9hSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgaWQsIHN0cmluZyBuYW1lLCAgdWludDI1NiBwcmljZSwgYm9vbCBhY3RpdmUpIHsKCiAgICAgICAgVGl0dHkgc3RvcmFnZSB0aXR0eSA9IFRpdHRpZXNbX3RpdHR5SWRdOwogICAgICAgIHVpbnQyNTYgYWNjSWQgPSB0aXR0eS5hY2Nlc3Nvcmllc1tfYUlkXTsKICAgICAgICBBY2Nlc3Nvcnkgc3RvcmFnZSBhY2Nlc3NvcnkgPSBBY2Nlc3Nvcmllc1thY2NJZF07CiAgICAgICAgaWQgPSBhY2Nlc3NvcnkuaWQ7CiAgICAgICAgbmFtZSA9IGFjY2Vzc29yeS5uYW1lOwogICAgICAgIHByaWNlID0gYWNjZXNzb3J5LnByaWNlOwogICAgICAgIGFjdGl2ZSA9IGFjY2Vzc29yeS5pc0FjdGl2ZTsKCiAgICB9CgogICAgZnVuY3Rpb24gY3JlYXRlVGl0dHkgKHVpbnQyNTYgX2lkLCBzdHJpbmcgX2dlbmRlciwgdWludDI1NiBfcHJpY2UsIGFkZHJlc3MgX293bmVyLCBzdHJpbmcgX25hbWUpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgICAgICAKICAgICAgICBUaXR0eSBtZW1vcnkgX3RpdHR5ID0gVGl0dHkoewogICAgICAgICAgICBpZDogX2lkLAogICAgICAgICAgICBuYW1lOiBfbmFtZSwKICAgICAgICAgICAgZ2VuZGVyOiBfZ2VuZGVyLAogICAgICAgICAgICBvcmlnaW5hbFByaWNlOiBfcHJpY2UsCiAgICAgICAgICAgIHNhbGVQcmljZTogX3ByaWNlLAogICAgICAgICAgICBhY2Nlc3NvcmllczogbmV3IHVpbnQyNTZbXSgwKSwKICAgICAgICAgICAgZm9yU2FsZTogZmFsc2UKICAgICAgICB9KTsKCiAgICAgICAgdWludDI1NiBuZXdUaXR0eUlkID0gVGl0dGllcy5wdXNoKF90aXR0eSkgLSAxOwoKICAgICAgICBDcmVhdGlvbigKICAgICAgICAgICAgX293bmVyLAogICAgICAgICAgICBuZXdUaXR0eUlkLAogICAgICAgICAgICBfaWQKICAgICAgICApOwoKICAgICAgICBfdHJhbnNmZXIoMCwgX293bmVyLCBuZXdUaXR0eUlkKTsKICAgICAgICByZXR1cm4gbmV3VGl0dHlJZDsKICAgIH0KCiAgICAKCn0KCgovLy8gQHRpdGxlIEludGVyZmFjZSBmb3IgY29udHJhY3RzIGNvbmZvcm1pbmcgdG8gRVJDLTcyMTogTm9uLUZ1bmdpYmxlIFRva2VucwovLy8gQGF1dGhvciBEaWV0ZXIgU2hpcmxleSA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjAxNjU2NDc1NjQ0MTYwNzk2ODZlNmM3YjY0NmYyZjYyNmUiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+PiAoaHR0cHM6Ly9naXRodWIuY29tL2RldGUpCmNvbnRyYWN0IEVSQzcyMSB7CiAgICBmdW5jdGlvbiBpbXBsZW1lbnRzRVJDNzIxKCkgcHVibGljIHB1cmUgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgdG90YWwpOwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwogICAgZnVuY3Rpb24gb3duZXJPZih1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzIG93bmVyKTsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYzsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgaW5kZXhlZCB0b2tlbklkKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIGFwcHJvdmVkLCB1aW50MjU2IGluZGV4ZWQgdG9rZW5JZCk7CgogICAgLy8gT3B0aW9uYWwKICAgIC8vIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcgbmFtZSk7CiAgICAvLyBmdW5jdGlvbiBzeW1ib2woKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcgc3ltYm9sKTsKICAgIC8vIGZ1bmN0aW9uIHRva2VuT2ZPd25lckJ5SW5kZXgoYWRkcmVzcyBfb3duZXIsIHVpbnQyNTYgX2luZGV4KSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYgdG9rZW5JZCk7CiAgICAvLyBmdW5jdGlvbiB0b2tlbk1ldGFkYXRhKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZyBpbmZvVXJsKTsKfQoKCgoKCgoKCmNvbnRyYWN0IFRpdHR5T3duZXJzaGlwIGlzIFRpdHR5QmFzZSwgRVJDNzIxIHsKCiAgICBzdHJpbmcgcHVibGljIG5hbWUgPSAiQ3J5cHRvVGl0dGVzIjsKICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIkNUIjsKCiAgICBmdW5jdGlvbiBpbXBsZW1lbnRzRVJDNzIxKCkgcHVibGljIHB1cmUgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIF9pc093bmVyKGFkZHJlc3MgX3VzZXIsIHVpbnQyNTYgX3RpdHR5SWQpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiB0aXR0eUluZGV4VG9Pd25lcltfdGl0dHlJZF0gPT0gX3VzZXI7CiAgICB9CgogICAgZnVuY3Rpb24gX2FwcHJvdmUodWludDI1NiBfdGl0dHlJZCwgYWRkcmVzcyBfYXBwcm92ZWQpIGludGVybmFsIHsKICAgICAgICAgdGl0dHlBcHByb3ZlSW5kZXhbX3RpdHR5SWRdID0gX2FwcHJvdmVkOyAKICAgIH0KCiAgICBmdW5jdGlvbiBfYXBwcm92ZUZvcihhZGRyZXNzIF91c2VyLCB1aW50MjU2IF90aXR0eUlkKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICAgcmV0dXJuIHRpdHR5QXBwcm92ZUluZGV4W190aXR0eUlkXSA9PSBfdXNlcjsgCiAgICB9CgogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHRvdGFsKSB7CiAgICAgICAgcmV0dXJuIFRpdHRpZXMubGVuZ3RoIC0gMTsKICAgIH0KCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgICAgIHJldHVybiBvd25lclRpdHRpZXNDb3VudFtfb3duZXJdOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBvd25lck9mKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3Mgb3duZXIpIHsKICAgICAgICBvd25lciA9IHRpdHR5SW5kZXhUb093bmVyW190b2tlbklkXTsKICAgICAgICByZXF1aXJlKG93bmVyICE9IGFkZHJlc3MoMCkpOwogICAgfQoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfaXNPd25lcihtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwogICAgICAgIF9hcHByb3ZlKF90b2tlbklkLCBfdG8pOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF90bywgX3Rva2VuSWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIHsKICAgICAgICByZXF1aXJlKF9hcHByb3ZlRm9yKG1zZy5zZW5kZXIsIF90b2tlbklkKSk7CiAgICAgICAgcmVxdWlyZShfaXNPd25lcihfZnJvbSwgX3Rva2VuSWQpKTsKCiAgICAgICAgX3RyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKICAgICAgICAKCiAgICB9CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgcHVibGljIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF9pc093bmVyKG1zZy5zZW5kZXIsIF90b2tlbklkKSk7CgogICAgICAgIF90cmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF90b2tlbklkKTsKICAgIH0KCgoKfQoKY29udHJhY3QgVGl0dHlQdXJjaGFzZSBpcyBUaXR0eU93bmVyc2hpcCB7CgogICAgYWRkcmVzcyBwcml2YXRlIHdhbGxldDsKICAgIGFkZHJlc3MgcHJpdmF0ZSBib2F0OwoKICAgIGZ1bmN0aW9uIFRpdHR5UHVyY2hhc2UoYWRkcmVzcyBfd2FsbGV0LCBhZGRyZXNzIF9ib2F0KSBwdWJsaWMgewogICAgICAgIHdhbGxldCA9IF93YWxsZXQ7CiAgICAgICAgYm9hdCA9IF9ib2F0OwoKICAgICAgICBjcmVhdGVUaXR0eSgwLCAidW5pc3NleCIsIDEwMDAwMDAwMDAsIGFkZHJlc3MoMCksICJnZW5lc2lzIik7CiAgICB9CgogICAgZnVuY3Rpb24gcHVyY2hhc2VOZXcodWludDI1NiBfaWQsIHN0cmluZyBfbmFtZSwgc3RyaW5nIF9nZW5kZXIsIHVpbnQyNTYgX3ByaWNlKSBwdWJsaWMgcGF5YWJsZSB7CgogICAgICAgIGlmIChtc2cudmFsdWUgPT0gMCAmJiBtc2cudmFsdWUgIT0gX3ByaWNlKQogICAgICAgICAgICByZXZlcnQoKTsKCiAgICAgICAgdWludDI1NiBib2F0RmVlID0gY2FsY3VsYXRlQm9hdEZlZShtc2cudmFsdWUpOwogICAgICAgIGNyZWF0ZVRpdHR5KF9pZCwgX2dlbmRlciwgX3ByaWNlLCBtc2cuc2VuZGVyLCBfbmFtZSk7CiAgICAgICAgd2FsbGV0LnRyYW5zZmVyKG1zZy52YWx1ZSAtIGJvYXRGZWUpOwogICAgICAgIGJvYXQudHJhbnNmZXIoYm9hdEZlZSk7CgogICAgfQoKICAgIGZ1bmN0aW9uIHB1cmNoYXNlRXhpc3RlbnQodWludDI1NiBfdGl0dHlJZCkgcHVibGljIHBheWFibGUgewoKICAgICAgICBUaXR0eSBzdG9yYWdlIHRpdHR5ID0gVGl0dGllc1tfdGl0dHlJZF07CiAgICAgICAgdWludDI1NiBmZWUgPSBjYWxjdWxhdGVGZWUodGl0dHkuc2FsZVByaWNlKTsKICAgICAgICBpZiAobXNnLnZhbHVlID09IDAgJiYgbXNnLnZhbHVlICE9IHRpdHR5LnNhbGVQcmljZSkKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgCiAgICAgICAgdWludDI1NiB2YWwgPSBtc2cudmFsdWUgLSBmZWU7CiAgICAgICAgYWRkcmVzcyBvd25lciA9IHRpdHR5SW5kZXhUb093bmVyW190aXR0eUlkXTsKICAgICAgICBfYXBwcm92ZShfdGl0dHlJZCwgbXNnLnNlbmRlcik7CiAgICAgICAgdHJhbnNmZXJGcm9tKG93bmVyLCBtc2cuc2VuZGVyLCBfdGl0dHlJZCk7CiAgICAgICAgb3duZXIudHJhbnNmZXIodmFsKTsKICAgICAgICB3YWxsZXQudHJhbnNmZXIoZmVlKTsKCiAgICB9CgogICAgZnVuY3Rpb24gcHVyY2hhc2VBY2Nlc3NvcnkodWludDI1NiBfdGl0dHlJZCwgdWludDI1NiBfYWNjSWQsIHN0cmluZyBfbmFtZSwgdWludDI1NiBfcHJpY2UpIHB1YmxpYyBwYXlhYmxlIHsKCiAgICAgICAgaWYgKG1zZy52YWx1ZSA9PSAwICYmIG1zZy52YWx1ZSAhPSBfcHJpY2UpCiAgICAgICAgICAgIHJldmVydCgpOwoKICAgICAgICB3YWxsZXQudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgICAgICBhZGRBY2Nlc3NvcnkoX2FjY0lkLCBfbmFtZSwgX3ByaWNlLCAgX3RpdHR5SWQpOwogICAgICAgIAogICAgICAgIAogICAgfQoKICAgIGZ1bmN0aW9uIGdldEFtb3VudE9mVGl0dGllcygpIHB1YmxpYyB2aWV3IHJldHVybnModWludCkgewogICAgICAgIHJldHVybiBUaXR0aWVzLmxlbmd0aDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRMYXRlc3RJZCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gVGl0dGllcy5sZW5ndGggLSAxOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFRpdHR5QnlXcElkKGFkZHJlc3MgX293bmVyLCB1aW50MjU2IF93cElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sIG93biwgdWludDI1NiB0aXR0eUlkKSB7CiAgICAgICAgCiAgICAgICAgZm9yICh1aW50MjU2IGkgPSAxOyBpPD10b3RhbFN1cHBseSgpOyBpKyspIHsKICAgICAgICAgICAgVGl0dHkgc3RvcmFnZSB0aXR0eSA9IFRpdHRpZXNbaV07CiAgICAgICAgICAgIGJvb2wgaXNPd25lciA9IF9pc093bmVyKF9vd25lciwgaSk7CiAgICAgICAgICAgIGlmICh0aXR0eS5pZCA9PSBfd3BJZCAmJiBpc093bmVyKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gKHRydWUsIGkpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVybiAoZmFsc2UsIDApOwogICAgfQoKICAgIGZ1bmN0aW9uIGJlbG9uZ3NUbyhhZGRyZXNzIF9hY2NvdW50LCB1aW50MjU2IF90aXR0eUlkKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIF9pc093bmVyKF9hY2NvdW50LCBfdGl0dHlJZCk7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlUHJpY2UodWludDI1NiBfcHJpY2UsIHVpbnQyNTYgX3RpdHR5SWQpIHB1YmxpYyB7CiAgICAgICAgX2NoYW5nZVRpdHR5UHJpY2UoX3ByaWNlLCBfdGl0dHlJZCk7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlTmFtZShzdHJpbmcgX25hbWUsIHVpbnQyNTYgX3RpdHR5SWQpIHB1YmxpYyB7CiAgICAgICAgX2NoYW5nZU5hbWUoX25hbWUsIF90aXR0eUlkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBtYWtlSXRTZWxsYWJsZSh1aW50MjU2IF90aXR0eUlkKSBwdWJsaWMgewogICAgICAgIF9zZXRUaXR0eUZvclNhbGUodHJ1ZSwgX3RpdHR5SWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZUZlZSAodWludDI1NiBfcHJpY2UpIGludGVybmFsIHB1cmUgcmV0dXJucyh1aW50KSB7CiAgICAgICAgcmV0dXJuIChfcHJpY2UgKiAxMCkvMTAwOwogICAgfQoKICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZUJvYXRGZWUgKHVpbnQyNTYgX3ByaWNlKSBpbnRlcm5hbCBwdXJlIHJldHVybnModWludCkgewogICAgICAgIHJldHVybiAoX3ByaWNlICogMjUpLzEwMDsKICAgIH0KCiAgICBmdW5jdGlvbigpIGV4dGVybmFsIHt9CgogICAgZnVuY3Rpb24gZ2V0QVRpdHR5KHVpbnQyNTYgX3RpdHR5SWQpCiAgICAgICAgcHVibGljIAogICAgICAgIHZpZXcgCiAgICAgICAgcmV0dXJucyAoCiAgICAgICAgdWludDI1NiBpZCwKICAgICAgICBzdHJpbmcgbmFtZSwKICAgICAgICBzdHJpbmcgZ2VuZGVyLAogICAgICAgIHVpbnQyNTYgb3JpZ2luYWxQcmljZSwKICAgICAgICB1aW50MjU2IHNhbGVQcmljZSwKICAgICAgICBib29sIGZvclNhbGUKICAgICAgICApIHsKCiAgICAgICAgICAgIFRpdHR5IHN0b3JhZ2UgdGl0dHkgPSBUaXR0aWVzW190aXR0eUlkXTsKICAgICAgICAgICAgaWQgPSB0aXR0eS5pZDsKICAgICAgICAgICAgbmFtZSA9IHRpdHR5Lm5hbWU7CiAgICAgICAgICAgIGdlbmRlciA9IHRpdHR5LmdlbmRlcjsKICAgICAgICAgICAgb3JpZ2luYWxQcmljZSA9IHRpdHR5Lm9yaWdpbmFsUHJpY2U7CiAgICAgICAgICAgIHNhbGVQcmljZSA9IHRpdHR5LnNhbGVQcmljZTsKICAgICAgICAgICAgZm9yU2FsZSA9IHRpdHR5LmZvclNhbGU7CiAgICAgICAgfQoKfQoKY29udHJhY3QgQ1RBdWN0aW9uIHsKCiAgICBzdHJ1Y3QgQXVjdGlvbiB7CiAgICAgICAgLy8gUGFyYW1ldGVycyBvZiB0aGUgYXVjdGlvbi4gVGltZXMgYXJlIGVpdGhlcgogICAgICAgIC8vIGFic29sdXRlIHVuaXggdGltZXN0YW1wcyAoc2Vjb25kcyBzaW5jZSAxOTcwLTAxLTAxKQogICAgICAgIC8vIG9yIHRpbWUgcGVyaW9kcyBpbiBzZWNvbmRzLgogICAgICAgIHVpbnQgYXVjdGlvbkVuZDsKCiAgICAgICAgLy8gQ3VycmVudCBzdGF0ZSBvZiB0aGUgYXVjdGlvbi4KICAgICAgICBhZGRyZXNzIGhpZ2hlc3RCaWRkZXI7CiAgICAgICAgdWludCBoaWdoZXN0QmlkOwoKICAgICAgICAvL01pbnVtaW4gQmlkIFNldCBieSB0aGUgYmVuZWZpY2lhcnkKICAgICAgICB1aW50IG1pbmltdW1CaWQ7CgogICAgICAgIC8vIFNldCB0byB0cnVlIGF0IHRoZSBlbmQsIGRpc2FsbG93cyBhbnkgY2hhbmdlCiAgICAgICAgYm9vbCBlbmRlZDsKCiAgICAgICAgLy9UaXR0eSBiZWluZyBBdWN0aW9uZWQKICAgICAgICB1aW50IHRpdHR5OwoKICAgICAgICAvL0JlbmVmaWNpYXJ5CiAgICAgICAgYWRkcmVzcyBiZW5lZmljaWFyeTsKCiAgICAgICAgLy9idXlub3cgcHJpY2UKICAgICAgICB1aW50IGJ1eU5vd1ByaWNlOwogICAgfQoKICAgIEF1Y3Rpb25bXSBBdWN0aW9uczsKCiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsgCiAgICBhZGRyZXNzIHB1YmxpYyBjdFdhbGxldDsgCiAgICBhZGRyZXNzIHB1YmxpYyB0aXR0eUNvbnRyYWN0QWRkcmVzczsKCiAgICAvLyBBbGxvd2VkIHdpdGhkcmF3YWxzIG9mIHByZXZpb3VzIGJpZHMKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50KSBwZW5kaW5nUmV0dXJuczsKCiAgICAvLyBDcmlwdG9UaXR0eSBDb250cmFjdAogICAgVGl0dHlQdXJjaGFzZSBwdWJsaWMgdGl0dHlDb250cmFjdDsKCiAgICAvLyBFdmVudHMgdGhhdCB3aWxsIGJlIGZpcmVkIG9uIGNoYW5nZXMuCiAgICBldmVudCBIaWdoZXN0QmlkSW5jcmVhc2VkKHVpbnQgYXVjdGlvbiwgYWRkcmVzcyBiaWRkZXIsIHVpbnQgYW1vdW50KTsKICAgIGV2ZW50IEF1Y3Rpb25FbmRlZChhZGRyZXNzIHdpbm5lciwgdWludCBhbW91bnQpOwogICAgZXZlbnQgQnV5Tm93KGFkZHJlc3MgYnV5ZXIsIHVpbnQgYW1vdW50KTsKICAgIGV2ZW50IEF1Y3Rpb25DYW5jZWwodWludCBhdWN0aW9uKTsKICAgIGV2ZW50IE5ld0F1Y3Rpb25DcmVhdGVkKHVpbnQgYXVjdGlvbklkLCB1aW50IHRpdHR5KTsKICAgIGV2ZW50IERpZE5vdEZpbmlzaFlldCh1aW50IHRpbWUsIHVpbnQgYXVjdGlvblRpbWUpOwogICAgZXZlbnQgTm90VGhlQ29udHJhY3RPd25lcihhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNlbmRlcik7CgogICAgLy8gVGhlIGZvbGxvd2luZyBpcyBhIHNvLWNhbGxlZCBuYXRzcGVjIGNvbW1lbnQsCiAgICAvLyByZWNvZ25pemFibGUgYnkgdGhlIHRocmVlIHNsYXNoZXMuCiAgICAvLyBJdCB3aWxsIGJlIHNob3duIHdoZW4gdGhlIHVzZXIgaXMgYXNrZWQgdG8KICAgIC8vIGNvbmZpcm0gYSB0cmFuc2FjdGlvbi4KCiAgICAvLy8gQ3JlYXRlIGEgc2ltcGxlIGF1Y3Rpb24gd2l0aCBgX2JpZGRpbmdUaW1lYAogICAgLy8vIHNlY29uZHMgYmlkZGluZyB0aW1lIG9uIGJlaGFsZiBvZiB0aGUKICAgIC8vLyBiZW5lZmljaWFyeSBhZGRyZXNzIGBfYmVuZWZpY2lhcnlgLgogICAgZnVuY3Rpb24gQ1RBdWN0aW9uKAogICAgICAgIGFkZHJlc3MgX3RpdHR5UHVyY2hhc2VBZGRyZXNzLAogICAgICAgIGFkZHJlc3MgX3dhbGxldAogICAgKSBwdWJsaWMgCiAgICB7ICAgCiAgICAgICAgdGl0dHlDb250cmFjdEFkZHJlc3MgPSBfdGl0dHlQdXJjaGFzZUFkZHJlc3M7CiAgICAgICAgdGl0dHlDb250cmFjdCA9IFRpdHR5UHVyY2hhc2UoX3RpdHR5UHVyY2hhc2VBZGRyZXNzKTsKICAgICAgICBjdFdhbGxldCA9IF93YWxsZXQ7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOyAKICAgIH0KCiAgICBmdW5jdGlvbiBjcmVhdGVBdWN0aW9uKHVpbnQgX2JpZGRpbmdUaW1lLCB1aW50IF90aXR0eSwgdWludCBfbWluaW11bUJpZCwgdWludCBfYnV5Tm93UHJpY2UpIHB1YmxpYyB7CgogICAgICAgIGFkZHJlc3Mgb3duZXJBZGRyZXNzID0gdGl0dHlDb250cmFjdC5vd25lck9mKF90aXR0eSk7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyQWRkcmVzcyk7CgogICAgICAgIEF1Y3Rpb24gbWVtb3J5IGF1Y3Rpb24gPSBBdWN0aW9uKHsKICAgICAgICAgICAgYXVjdGlvbkVuZDogbm93ICsgX2JpZGRpbmdUaW1lLAogICAgICAgICAgICB0aXR0eTogX3RpdHR5LAogICAgICAgICAgICBiZW5lZmljaWFyeTogbXNnLnNlbmRlciwKICAgICAgICAgICAgaGlnaGVzdEJpZGRlcjogMCwKICAgICAgICAgICAgaGlnaGVzdEJpZDogMCwKICAgICAgICAgICAgZW5kZWQ6IGZhbHNlLAogICAgICAgICAgICBtaW5pbXVtQmlkOiBfbWluaW11bUJpZCwKICAgICAgICAgICAgYnV5Tm93UHJpY2U6IF9idXlOb3dQcmljZQogICAgICAgIH0pOwoKICAgICAgICB1aW50IGF1Y3Rpb25JZCA9IEF1Y3Rpb25zLnB1c2goYXVjdGlvbikgLSAxOwogICAgICAgIE5ld0F1Y3Rpb25DcmVhdGVkKGF1Y3Rpb25JZCwgX3RpdHR5KTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRUaXR0eU93bmVyKHVpbnQgX3RpdHR5KSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICAgICAgYWRkcmVzcyBvd25lckFkZHJlc3MgPSB0aXR0eUNvbnRyYWN0Lm93bmVyT2YoX3RpdHR5KTsKICAgICAgICByZXR1cm4gb3duZXJBZGRyZXNzOwogICAgfSAKCiAgICAvLy8gQmlkIG9uIGFuIGF1Y3Rpb24gd2l0aCB0aGUgdmFsdWUgc2VudAogICAgLy8vIHRvZ2V0aGVyIHdpdGggdGhpcyB0cmFuc2FjdGlvbi4KICAgIC8vLyBUaGUgdmFsdWUgd2lsbCBvbmx5IGJlIHJlZnVuZGVkIGlmIHRoZQogICAgLy8vIGF1Y3Rpb24gaXMgbm90IHdvbi4KICAgIGZ1bmN0aW9uIGJpZCh1aW50IF9hdWN0aW9uKSBwdWJsaWMgcGF5YWJsZSB7CgogICAgICAgIEF1Y3Rpb24gbWVtb3J5IGF1Y3Rpb24gPSBBdWN0aW9uc1tfYXVjdGlvbl07CgogICAgICAgIC8vIFJldmVydCB0aGUgY2FsbCBpZiB0aGUgYmlkZGluZwogICAgICAgIC8vIHBlcmlvZCBpcyBvdmVyLgogICAgICAgIHJlcXVpcmUobm93IDw9IGF1Y3Rpb24uYXVjdGlvbkVuZCk7CgogICAgICAgIC8vIFJldmVydCB0aGUgY2FsbCB2YWx1ZSBpcyBsZXNzIHRoYW4gdGhlIG1pbmltdW1CaWQuCiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPj0gYXVjdGlvbi5taW5pbXVtQmlkKTsKCiAgICAgICAgLy8gSWYgdGhlIGJpZCBpcyBub3QgaGlnaGVyLCBzZW5kIHRoZQogICAgICAgIC8vIG1vbmV5IGJhY2suCiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPiBhdWN0aW9uLmhpZ2hlc3RCaWQpOwoKICAgICAgICBpZiAoYXVjdGlvbi5oaWdoZXN0QmlkICE9IDApIHsKICAgICAgICAgICAgLy8gU2VuZGluZyBiYWNrIHRoZSBtb25leSBieSBzaW1wbHkgdXNpbmcKICAgICAgICAgICAgLy8gaGlnaGVzdEJpZGRlci5zZW5kKGhpZ2hlc3RCaWQpIGlzIGEgc2VjdXJpdHkgcmlzawogICAgICAgICAgICAvLyBiZWNhdXNlIGl0IGNvdWxkIGV4ZWN1dGUgYW4gdW50cnVzdGVkIGNvbnRyYWN0LgogICAgICAgICAgICAvLyBJdCBpcyBhbHdheXMgc2FmZXIgdG8gbGV0IHRoZSByZWNpcGllbnRzCiAgICAgICAgICAgIC8vIHdpdGhkcmF3IHRoZWlyIG1vbmV5IHRoZW1zZWx2ZXMuCiAgICAgICAgICAgIHBlbmRpbmdSZXR1cm5zW2F1Y3Rpb24uaGlnaGVzdEJpZGRlcl0gKz0gYXVjdGlvbi5oaWdoZXN0QmlkOwogICAgICAgIH0KICAgICAgICBhdWN0aW9uLmhpZ2hlc3RCaWRkZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIGF1Y3Rpb24uaGlnaGVzdEJpZCA9IG1zZy52YWx1ZTsKICAgICAgICBBdWN0aW9uc1tfYXVjdGlvbl0gPSBhdWN0aW9uOwogICAgICAgIEhpZ2hlc3RCaWRJbmNyZWFzZWQoX2F1Y3Rpb24sIG1zZy5zZW5kZXIsIG1zZy52YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gYnV5Tm93KHVpbnQgX2F1Y3Rpb24pIHB1YmxpYyBwYXlhYmxlIHsKCiAgICAgICAgQXVjdGlvbiBtZW1vcnkgYXVjdGlvbiA9IEF1Y3Rpb25zW19hdWN0aW9uXTsKCiAgICAgICAgcmVxdWlyZShub3cgPj0gYXVjdGlvbi5hdWN0aW9uRW5kKTsgLy8gYXVjdGlvbiBoYXMgZW5kZWQKICAgICAgICByZXF1aXJlKCFhdWN0aW9uLmVuZGVkKTsgLy8gdGhpcyBmdW5jdGlvbiBoYXMgYWxyZWFkeSBiZWVuIGNhbGxlZAoKICAgICAgICAvL1JlcXVpcmUgdGhhdCB0aGUgdmFsdWUgc2VudCBpcyB0aGUgYnV5Tm93UHJpY2UgU2V0IGJ5IHRoZSBPd25lci9CZW5uZWZpY2FyeQogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID09IGF1Y3Rpb24uYnV5Tm93UHJpY2UpOwoKICAgICAgICAvL1JlcXVpcmUgdGhhdCB0aGVyZSBhcmUgbm8gYmlkcwogICAgICAgIHJlcXVpcmUoYXVjdGlvbi5oaWdoZXN0QmlkID09IDApOwoKICAgICAgICAvLyBFbmQgQXVjdGlvbgogICAgICAgIGF1Y3Rpb24uZW5kZWQgPSB0cnVlOwogICAgICAgIEF1Y3Rpb25zW19hdWN0aW9uXSA9IGF1Y3Rpb247CiAgICAgICAgQnV5Tm93KG1zZy5zZW5kZXIsIG1zZy52YWx1ZSk7CgogICAgICAgIC8vIFNlbmQgdGhlIEZ1bmRzCiAgICAgICAgdGl0dHlDb250cmFjdC50cmFuc2ZlckZyb20oYXVjdGlvbi5iZW5lZmljaWFyeSwgbXNnLnNlbmRlciwgYXVjdGlvbi50aXR0eSk7CiAgICAgICAgdWludCBmZWUgPSBjYWxjdWxhdGVGZWUobXNnLnZhbHVlKTsKICAgICAgICBjdFdhbGxldC50cmFuc2ZlcihmZWUpOwogICAgICAgIGF1Y3Rpb24uYmVuZWZpY2lhcnkudHJhbnNmZXIobXNnLnZhbHVlLWZlZSk7CiAgICB9CgogICAgLy8vIFdpdGhkcmF3IGEgYmlkIHRoYXQgd2FzIG92ZXJiaWQuCiAgICBmdW5jdGlvbiB3aXRoZHJhdygpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgdWludCBhbW91bnQgPSBwZW5kaW5nUmV0dXJuc1ttc2cuc2VuZGVyXTsKICAgICAgICByZXF1aXJlKGFtb3VudCA+IDApOwogICAgICAgIC8vIEl0IGlzIGltcG9ydGFudCB0byBzZXQgdGhpcyB0byB6ZXJvIGJlY2F1c2UgdGhlIHJlY2lwaWVudAogICAgICAgIC8vIGNhbiBjYWxsIHRoaXMgZnVuY3Rpb24gYWdhaW4gYXMgcGFydCBvZiB0aGUgcmVjZWl2aW5nIGNhbGwKICAgICAgICAvLyBiZWZvcmUgYHNlbmRgIHJldHVybnMuCiAgICAgICAgcGVuZGluZ1JldHVybnNbbXNnLnNlbmRlcl0gPSAwOwoKICAgICAgICBpZiAoIW1zZy5zZW5kZXIuc2VuZChhbW91bnQpKSB7CiAgICAgICAgICAgIC8vIE5vIG5lZWQgdG8gY2FsbCB0aHJvdyBoZXJlLCBqdXN0IHJlc2V0IHRoZSBhbW91bnQgb3dpbmcKICAgICAgICAgICAgcGVuZGluZ1JldHVybnNbbXNnLnNlbmRlcl0gPSBhbW91bnQ7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gYXVjdGlvbkNhbmNlbCh1aW50IF9hdWN0aW9uKSBwdWJsaWMgewoKICAgICAgICBBdWN0aW9uIG1lbW9yeSBhdWN0aW9uID0gQXVjdGlvbnNbX2F1Y3Rpb25dOwoKICAgICAgICAvL2hhcyB0byBiZSB0aGUgYmVuZWZpY2lhcnkKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYXVjdGlvbi5iZW5lZmljaWFyeSk7CgogICAgICAgIC8vQXVjdGlvbiBFbmRlZAogICAgICAgIHJlcXVpcmUobm93ID49IGF1Y3Rpb24uYXVjdGlvbkVuZCk7CgogICAgICAgIC8vaGFzIG5vIG1heGJpZCAKICAgICAgICByZXF1aXJlKGF1Y3Rpb24uaGlnaGVzdEJpZCA9PSAwKTsKCiAgICAgICAgYXVjdGlvbi5lbmRlZCA9IHRydWU7CiAgICAgICAgQXVjdGlvbnNbX2F1Y3Rpb25dID0gYXVjdGlvbjsKICAgICAgICBBdWN0aW9uQ2FuY2VsKF9hdWN0aW9uKTsKCiAgICB9CgogICAgLy8vIEVuZCB0aGUgYXVjdGlvbiBhbmQgc2VuZCB0aGUgaGlnaGVzdCBiaWQKICAgIC8vLyB0byB0aGUgYmVuZWZpY2lhcnkgYW5kIDEwJSB0byBDVC4KICAgIGZ1bmN0aW9uIGF1Y3Rpb25FbmQodWludCBfYXVjdGlvbikgcHVibGljIHsKCiAgICAgICAgLy8gSnVzdCBjcnlwdG90aXR0aWVzIENFTyBjYW4gZW5kIHRoZSBhdWN0aW9uCiAgICAgICAgcmVxdWlyZSAob3duZXIgPT0gbXNnLnNlbmRlcik7CgogICAgICAgIEF1Y3Rpb24gbWVtb3J5IGF1Y3Rpb24gPSBBdWN0aW9uc1tfYXVjdGlvbl07CgogICAgICAgIHJlcXVpcmUgKG5vdyA+PSBhdWN0aW9uLmF1Y3Rpb25FbmQpOyAvLyBhdWN0aW9uIGhhcyBlbmRlZAogICAgICAgIHJlcXVpcmUoIWF1Y3Rpb24uZW5kZWQpOyAvLyB0aGlzIGZ1bmN0aW9uIGhhcyBhbHJlYWR5IGJlZW4gY2FsbGVkCgogICAgICAgIC8vIEVuZCBBdWN0aW9uCiAgICAgICAgYXVjdGlvbi5lbmRlZCA9IHRydWU7CiAgICAgICAgQXVjdGlvbnNbX2F1Y3Rpb25dID0gYXVjdGlvbjsKICAgICAgICBBdWN0aW9uRW5kZWQoYXVjdGlvbi5oaWdoZXN0QmlkZGVyLCBhdWN0aW9uLmhpZ2hlc3RCaWQpOwogICAgICAgIGlmIChhdWN0aW9uLmhpZ2hlc3RCaWQgIT0gMCkgewogICAgICAgICAgICAvLyBTZW5kIHRoZSBGdW5kcwogICAgICAgICAgICB0aXR0eUNvbnRyYWN0LnRyYW5zZmVyRnJvbShhdWN0aW9uLmJlbmVmaWNpYXJ5LCBhdWN0aW9uLmhpZ2hlc3RCaWRkZXIsIGF1Y3Rpb24udGl0dHkpOwogICAgICAgICAgICB1aW50IGZlZSA9IGNhbGN1bGF0ZUZlZShhdWN0aW9uLmhpZ2hlc3RCaWQpOwogICAgICAgICAgICBjdFdhbGxldC50cmFuc2ZlcihmZWUpOwogICAgICAgICAgICBhdWN0aW9uLmJlbmVmaWNpYXJ5LnRyYW5zZmVyKGF1Y3Rpb24uaGlnaGVzdEJpZC1mZWUpOwogICAgICAgIH0KCiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QXVjdGlvbkluZm8odWludCBfYXVjdGlvbikgcHVibGljIHZpZXcgcmV0dXJucyAodWludCBlbmQsIGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQgbWF4QmlkLCBhZGRyZXNzIG1heEJpZGRlcikgewoKICAgICAgICBBdWN0aW9uIHN0b3JhZ2UgYXVjdGlvbiA9IEF1Y3Rpb25zW19hdWN0aW9uXTsKCiAgICAgICAgZW5kID0gYXVjdGlvbi5hdWN0aW9uRW5kOwogICAgICAgIGJlbmVmaWNpYXJ5ID0gYXVjdGlvbi5iZW5lZmljaWFyeTsKICAgICAgICBtYXhCaWQgPSBhdWN0aW9uLmhpZ2hlc3RCaWQ7CiAgICAgICAgbWF4QmlkZGVyID0gYXVjdGlvbi5oaWdoZXN0QmlkZGVyOwogICAgfQoKICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZUZlZSAodWludDI1NiBfcHJpY2UpIGludGVybmFsIHB1cmUgcmV0dXJucyh1aW50KSB7CiAgICAgICAgcmV0dXJuIChfcHJpY2UgKiAxMCkvMTAwOwogICAgfQp9'.
	

]
