Class {
	#name : #SRT176ec7b6afb4e023b2c33a6f0b309ed5975d1e92,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT176ec7b6afb4e023b2c33a6f0b309ed5975d1e92 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGlmIChhID09IDApIHsKICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgICAgICB1aW50MjU2IGMgPSBhICogYjsKICAgICAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCi8qKgogKiBAdGl0bGUgRVJDMjBCYXNpYwogKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE3OQogKi8KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuIAogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKCiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgLyoqCiAgKiBNb2RpZmllciBhdm9pZHMgc2hvcnQgYWRkcmVzcyBhdHRhY2tzLgogICogRm9yIG1vcmUgaW5mbyBjaGVjazogaHR0cHM6Ly9lcmljcmFmYWxvZmYuY29tL2FuYWx5emluZy10aGUtZXJjMjAtc2hvcnQtYWRkcmVzcy1hdHRhY2svCiAgKi8KICBtb2RpZmllciBvbmx5UGF5bG9hZFNpemUodWludCBzaXplKSB7CiAgICAgIGlmIChtc2cuZGF0YS5sZW5ndGggPCBzaXplICsgNCkgewogICAgICByZXZlcnQoKTsKICAgICAgfQogICAgICBfOwogIH0KCiAgLyoqCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgb25seVBheWxvYWRTaXplKDIgKiAzMikgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1ttc2cuc2VuZGVyXSk7CiAgICAKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuIAogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKfQoKCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CgoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIG9ubHlQYXlsb2FkU2l6ZSgzICogMzIpIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUpOwogICAgcmVxdWlyZShiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlKTsKICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAvLyBUbyBjaGFuZ2UgdGhlIGFwcHJvdmUgYW1vdW50IHlvdSBmaXJzdCBoYXZlIHRvIHJlZHVjZSB0aGUgYWRkcmVzc2VzYAogICAgLy8gIGFsbG93YW5jZSB0byB6ZXJvIGJ5IGNhbGxpbmcgYGFwcHJvdmUoX3NwZW5kZXIsIDApYCBpZiBpdCBpcyBub3QKICAgIC8vICBhbHJlYWR5IDAgdG8gbWl0aWdhdGUgdGhlIHJhY2UgY29uZGl0aW9uIGRlc2NyaWJlZCBoZXJlOgogICAgLy8gIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICByZXF1aXJlKChfdmFsdWUgPT0gMCkgfHwgKGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID09IDApKTsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CiAgCiAgLyoqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwgCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICovCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIGludGVybmFsIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCi8qKgogKiBAdGl0bGUgUGF1c2FibGUKICogQGRldiBCYXNlIGNvbnRyYWN0IHdoaWNoIGFsbG93cyBjaGlsZHJlbiB0byBpbXBsZW1lbnQgYW4gZW1lcmdlbmN5IHN0b3AgbWVjaGFuaXNtLgogKi8KY29udHJhY3QgUGF1c2FibGUgaXMgT3duYWJsZSAgewogICAgZXZlbnQgUGF1c2UoKTsKICAgIGV2ZW50IFVucGF1c2UoKTsKICAgIGV2ZW50IEZyZWV6ZSAoKTsKICAgIGV2ZW50IExvZ0ZyZWV6ZSgpOwoKICAgIGJvb2wgcHVibGljIHBhdXNlZCA9IGZhbHNlOwoKICAgIGFkZHJlc3MgcHVibGljIGZvdW5kZXI7CiAgICAKICAgIC8qKgogICAgKiBAZGV2IG1vZGlmaWVyIHRvIGFsbG93IGFjdGlvbnMgb25seSB3aGVuIHRoZSBjb250cmFjdCBJUyBwYXVzZWQKICAgICovCiAgICBtb2RpZmllciB3aGVuTm90UGF1c2VkKCkgewogICAgICAgIHJlcXVpcmUoIXBhdXNlZCB8fCBtc2cuc2VuZGVyID09IGZvdW5kZXIpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgbW9kaWZpZXIgdG8gYWxsb3cgYWN0aW9ucyBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IElTIE5PVCBwYXVzZWQKICAgICovCiAgICBtb2RpZmllciB3aGVuUGF1c2VkKCkgewogICAgICAgIHJlcXVpcmUocGF1c2VkKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gcGF1c2UsIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUKICAgICovCiAgICBmdW5jdGlvbiBwYXVzZSgpIHB1YmxpYyBvbmx5T3duZXIgd2hlbk5vdFBhdXNlZCB7CiAgICAgICAgcGF1c2VkID0gdHJ1ZTsKICAgICAgICBQYXVzZSgpOwogICAgfQogICAgCgogICAgLyoqCiAgICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byB1bnBhdXNlLCByZXR1cm5zIHRvIG5vcm1hbCBzdGF0ZQogICAgKi8KICAgIGZ1bmN0aW9uIHVucGF1c2UoKSBwdWJsaWMgb25seU93bmVyIHdoZW5QYXVzZWQgewogICAgICAgIHBhdXNlZCA9IGZhbHNlOwogICAgICAgIFVucGF1c2UoKTsKICAgIH0KfQoKY29udHJhY3QgUGF1c2FibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBQYXVzYWJsZSB7CgogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgb25seVBheWxvYWRTaXplKDIgKiAzMikgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIG9ubHlQYXlsb2FkU2l6ZSgzICogMzIpIHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICB9CgogIC8vVGhlIGZ1bmN0aW9ucyBiZWxvdyBzdXJ2ZSBubyByZWFsIHB1cnBvc2UuIEV2ZW4gaWYgb25lIHdlcmUgdG8gYXBwcm92ZSBhbm90aGVyIHRvIHNwZW5kCiAgLy90b2tlbnMgb24gdGhlaXIgYmVoYWxmLCB0aG9zZSB0b2tlbnMgd2lsbCBzdGlsbCBvbmx5IGJlIHRyYW5zZmVyYWJsZSB3aGVuIHRoZSB0b2tlbiBjb250cmFjdAogIC8vaXMgbm90IHBhdXNlZC4KCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLmFwcHJvdmUoX3NwZW5kZXIsIF92YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgcmV0dXJuIHN1cGVyLmluY3JlYXNlQXBwcm92YWwoX3NwZW5kZXIsIF9hZGRlZFZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgd2hlbk5vdFBhdXNlZCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHJldHVybiBzdXBlci5kZWNyZWFzZUFwcHJvdmFsKF9zcGVuZGVyLCBfc3VidHJhY3RlZFZhbHVlKTsKICB9Cn0KCmNvbnRyYWN0IE1pbnRhYmxlVG9rZW4gaXMgUGF1c2FibGVUb2tlbiB7CiAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKICBldmVudCBNaW50RmluaXNoZWQoKTsKCiAgYm9vbCBwdWJsaWMgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CgoKICBtb2RpZmllciBjYW5NaW50KCkgewogICAgcmVxdWlyZSghbWludGluZ0ZpbmlzaGVkKTsKICAgIF87CiAgfQoKICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyBvbmx5T3duZXIgY2FuTWludCByZXR1cm5zIChib29sKSB7CiAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfYW1vdW50KTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfYW1vdW50KTsKICAgIE1pbnQoX3RvLCBfYW1vdW50KTsKICAgIFRyYW5zZmVyKGFkZHJlc3MoMCksIF90bywgX2Ftb3VudCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBwdWJsaWMgb25seU93bmVyIGNhbk1pbnQgcmV0dXJucyAoYm9vbCkgewogICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgIE1pbnRGaW5pc2hlZCgpOwogICAgcmV0dXJuIHRydWU7CiAgfQp9Cgpjb250cmFjdCBUZXN0VG9rZW4gaXMgTWludGFibGVUb2tlbiB7CgogIHN0cmluZyBwdWJsaWMgbmFtZTsKICBzdHJpbmcgcHVibGljIHN5bWJvbDsKICB1aW50OCBwdWJsaWMgZGVjaW1hbHM7CgogIGV2ZW50IFRva2Vuc0J1cm5lZChhZGRyZXNzIGluaXRpYXRpb3IsIGFkZHJlc3MgaW5kZXhlZCBfcGFydG5lciwgdWludDI1NiBfdG9rZW5zKTsKIAoKICAvKioKICAgKiBAZGV2IENvbnN0cnVjdG9yIHRoYXQgZ2l2ZXMgdGhlIGZvdW5kZXIgYWxsIG9mIHRoZSBleGlzdGluZyB0b2tlbnMuCiAgICovCiAgICBmdW5jdGlvbiBUZXN0VG9rZW4oKSBwdWJsaWMgewogICAgICAgIG5hbWUgPSAiRlRlc3QzIjsKICAgICAgICBzeW1ib2wgPSAiRk9UMyI7CiAgICAgICAgZGVjaW1hbHMgPSAxODsKICAgICAgICB0b3RhbFN1cHBseSA9IDE1MDAwMDAwZTE4OwogICAgICAgIGZvdW5kZXIgPSAweGM4NTA5NTI1Nzk0NkQ4ODU4NWFiMTIwNTA4OTBiZGQ2ZjA3YTgwRjA7CiAgICAgICAgYmFsYW5jZXNbZm91bmRlcl0gPSB0b3RhbFN1cHBseTsgLy8xNSwwMDAsMDAwIHRva2VucyBmb3IgZm91bmRlcnMgZm9yIG1hcmtldGluZy4KICAgICAgICBUcmFuc2ZlcigweDAsIGZvdW5kZXIsIDE1MDAwMDAwZTE4KTsKICAgICAgICBwYXVzZSgpOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlGb3VuZGVyIHsKICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGZvdW5kZXIpOwogICAgICBfOwogICAgfQoKICAgIGV2ZW50IE5ld0ZvdW5kZXJBZGRyZXNzKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8pOwoKICAgIGZ1bmN0aW9uIGNoYW5nZUZvdW5kZXJBZGRyZXNzKGFkZHJlc3MgX25ld0ZvdW5kZXIpIHB1YmxpYyBvbmx5Rm91bmRlciB7CiAgICAgICAgcmVxdWlyZShfbmV3Rm91bmRlciAhPSAweDApOwogICAgICAgIE5ld0ZvdW5kZXJBZGRyZXNzKGZvdW5kZXIsIF9uZXdGb3VuZGVyKTsKICAgICAgICBmb3VuZGVyID0gX25ld0ZvdW5kZXI7CiAgICB9CgogICAgLyoKICAgICogQGRldiBUb2tlbiBidXJuIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBhdCB0aGUgdGltZSBvZiB0b2tlbiBzd2FwCiAgICAqIEBwYXJhbSBfcGFydG5lciBhZGRyZXNzIHRvIHVzZSBmb3IgdG9rZW4gYmFsYW5jZSBidXJpbmcKICAgICogQHBhcmFtIF90b2tlbnMgdWludDI1NiBhbW91bnQgb2YgdG9rZW5zIHRvIGJ1cm4KICAgICovCiAgICBmdW5jdGlvbiBidXJuVG9rZW5zKGFkZHJlc3MgX3BhcnRuZXIsIHVpbnQyNTYgX3Rva2VucykgcHVibGljIG9ubHlGb3VuZGVyIHsKICAgICAgICByZXF1aXJlKGJhbGFuY2VzW19wYXJ0bmVyXSA+PSBfdG9rZW5zKTsKICAgICAgICBiYWxhbmNlc1tfcGFydG5lcl0gPSBiYWxhbmNlc1tfcGFydG5lcl0uc3ViKF90b2tlbnMpOwogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuc3ViKF90b2tlbnMpOwogICAgICAgIFRva2Vuc0J1cm5lZChtc2cuc2VuZGVyLCBfcGFydG5lciwgX3Rva2Vucyk7CiAgICB9Cn0KCgpjb250cmFjdCBDcm93ZHNhbGUgaXMgT3duYWJsZSB7CgogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgVGVzdFRva2VuIHB1YmxpYyB0b2tlbjsKICAgIHVpbnQyNTYgcHVibGljIHRva2Vuc0ZvclByZUlDTzsKICAgIHVpbnQyNTYgcHVibGljIHRva2VuQ2FwRm9yRmlyc3RNYWluU3RhZ2U7CiAgICB1aW50MjU2IHB1YmxpYyB0b2tlbkNhcEZvclNlY29uZE1haW5TdGFnZTsKICAgIHVpbnQyNTYgcHVibGljIHRva2VuQ2FwRm9yVGhpcmRNYWluU3RhZ2U7CiAgICB1aW50MjU2IHB1YmxpYyB0b2tlbkNhcEZvckZvdXJ0aE1haW5TdGFnZTsKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsVG9rZW5zRm9yU2FsZTsKICAgIHVpbnQyNTYgcHVibGljIHN0YXJ0VGltZTsKICAgIHVpbnQyNTYgcHVibGljIGVuZFRpbWU7CiAgICBhZGRyZXNzIHB1YmxpYyB3YWxsZXQ7CiAgICB1aW50MjU2IHB1YmxpYyByYXRlOwogICAgdWludDI1NiBwdWJsaWMgd2VpUmFpc2VkOwoKICAgIHVpbnQyNTZbNF0gcHVibGljIElDT2JvbnVzU3RhZ2VzOwoKICAgIHVpbnQyNTYgcHVibGljIHByZUlDT2R1cmF0aW9uOwogICAgYm9vbCBwdWJsaWMgbWFpblNhbGVBY3RpdmU7CgogICAgdWludDI1NiBwdWJsaWMgdG9rZW5zU29sZDsKCiAgICAvKioKICAgICogZXZlbnQgZm9yIHRva2VuIHB1cmNoYXNlIGxvZ2dpbmcKICAgICogQHBhcmFtIHB1cmNoYXNlciB3aG8gcGFpZCBmb3IgdGhlIHRva2VucwogICAgKiBAcGFyYW0gYmVuZWZpY2lhcnkgd2hvIGdvdCB0aGUgdG9rZW5zCiAgICAqIEBwYXJhbSB2YWx1ZSB3ZWlzIHBhaWQgZm9yIHB1cmNoYXNlCiAgICAqIEBwYXJhbSBhbW91bnQgYW1vdW50IG9mIHRva2VucyBwdXJjaGFzZWQKICAgICovCiAgICBldmVudCBUb2tlblB1cmNoYXNlKGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB2YWx1ZSwgdWludDI1NiBhbW91bnQpOwogICAgZXZlbnQgSUNPU2FsZUV4dGVuZGVkKHVpbnQyNTYgbmV3RW5kVGltZSk7CgogICAgZnVuY3Rpb24gQ3Jvd2RzYWxlKCkgcHVibGljIHsKICAgICAgICB0b2tlbiA9IG5ldyBUZXN0VG9rZW4oKTsgIC8vbXNnLnNlbmRlciBpcyBwYXNzZWQgYXMgdGhlIGZvdW5kZXIgd2FsbGV0IHdoaWNoIHdpbGwgcmVjaWV2ZSB0aGUgMTUsMDAwLDAwMCB0b2tlbnMKICAgICAgICBzdGFydFRpbWUgPSBub3c7IAogICAgICAgIHJhdGUgPSAxMTYwOwogICAgICAgIHdhbGxldCA9IDB4Yzg1MDk1MjU3OTQ2RDg4NTg1YWIxMjA1MDg5MGJkZDZmMDdhODBGMDsKICAgICAgICB0b2tlbnNGb3JQcmVJQ08gPSA0NTAwMDAwZTE4OwoKICAgICAgICB0b2tlbkNhcEZvckZpcnN0TWFpblN0YWdlID0gMTE1MDAwMDBlMTg7ICAvLzcsMDAwLDAwMCArIDQsNTAwLDAwMAogICAgICAgIHRva2VuQ2FwRm9yU2Vjb25kTWFpblN0YWdlID0gMTg1MDAwMDBlMTg7ICAvLzExLDUwMCwwMDAgKyA3LDAwMCwwMDAKICAgICAgICB0b2tlbkNhcEZvclRoaXJkTWFpblN0YWdlID0gMjU1MDAwMDBlMTg7ICAvLzE4LDUwMCwwMDAgKyA3LDAwMCwwMDAKICAgICAgICB0b2tlbkNhcEZvckZvdXJ0aE1haW5TdGFnZSA9IDM1MDAwMDAwZTE4OyAgLy8yNSw1MDAsMDAwICsgOSw1MDAsMDAwCgogICAgICAgIHRvdGFsVG9rZW5zRm9yU2FsZSA9IDM1MDAwMDAwZTE4OwogICAgICAgIHRva2Vuc1NvbGQgPSAwOwoKICAgICAgICBwcmVJQ09kdXJhdGlvbiA9IG5vdy5hZGQoMzAgbWludXRlcyk7CiAgICAgICAgZW5kVGltZSA9IHByZUlDT2R1cmF0aW9uOwoKICAgICAgICBtYWluU2FsZUFjdGl2ZSA9IGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uKCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwogICAgfQoKICAgIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIF9hZGRyKSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZSh2YWxpZFB1cmNoYXNlKCkgJiYgdG9rZW5zU29sZCA8IHRvdGFsVG9rZW5zRm9yU2FsZSk7CiAgICAgICAgcmVxdWlyZShfYWRkciAhPSAweDAgJiYgbXNnLnZhbHVlID4gMTAwIGZpbm5leSk7ICAKICAgICAgICB1aW50MjU2IHRvTWludDsKICAgICAgICBpZihub3cgPD0gcHJlSUNPZHVyYXRpb24pIHsKICAgICAgICAgICAgaWYodG9rZW5zU29sZCA+PSB0b2tlbnNGb3JQcmVJQ08pIHsgcmV2ZXJ0KCk7IH0KICAgICAgICAgICAgdG9NaW50ID0gbXNnLnZhbHVlLm11bChyYXRlLm11bCgyKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYoIW1haW5TYWxlQWN0aXZlKSB7IHJldmVydCgpOyB9CiAgICAgICAgICAgIHRvTWludCA9IG1zZy52YWx1ZS5tdWwoZ2V0UmF0ZVdpdGhCb251cygpKTsKICAgICAgICB9CiAgICAgICAgdG9rZW5zU29sZCA9IHRva2Vuc1NvbGQuYWRkKHRvTWludCk7CiAgICAgICAgdG9rZW4ubWludChfYWRkciwgdG9NaW50KTsKICAgICAgICBmb3J3YXJkRnVuZHMoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBmb3J3YXJkRnVuZHMoKSBpbnRlcm5hbCB7CiAgICAgICAgd2FsbGV0LnRyYW5zZmVyKG1zZy52YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gcHJvY2Vzc09mZmxpbmVQdXJjaGFzZShhZGRyZXNzIF90bywgdWludDI1NiBfdG9NaW50KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKHRva2Vuc1NvbGQuYWRkKF90b01pbnQpIDw9IHRvdGFsVG9rZW5zRm9yU2FsZSk7CiAgICAgICAgcmVxdWlyZShfdG9NaW50ID4gMCAmJiBfdG8gIT0gMHgwKTsKICAgICAgICB0b2tlbnNTb2xkID0gdG9rZW5zU29sZC5hZGQoX3RvTWludCk7CiAgICAgICAgdG9rZW4ubWludChfdG8sIF90b01pbnQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHZhbGlkUHVyY2hhc2UoKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICBib29sIHdpdGhpblBlcmlvZCA9IG5vdyA+PSBzdGFydFRpbWUgJiYgbm93IDw9IGVuZFRpbWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRGlucyBwZXJpb2RlIHRvdGFsIElDTwogICAgICAgIGJvb2wgbm9uWmVyb1B1cmNoYXNlID0gbXNnLnZhbHVlICE9IDA7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBFVEggZW52aWF0cyBkaWZlcmVudCBkZSAwCiAgICAgICAgcmV0dXJuIHdpdGhpblBlcmlvZCAmJiBub25aZXJvUHVyY2hhc2U7CiAgICB9CgoKICAgIGZ1bmN0aW9uIGdldFJhdGVXaXRoQm9udXMoKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYgcmF0ZVdpdGhEaXNjb3VudCkgewogICAgICAgIGlmIChub3cgPiBwcmVJQ09kdXJhdGlvbiAmJiB0b2tlbnNTb2xkIDwgdG90YWxUb2tlbnNGb3JTYWxlKSB7CiAgICAgICAgICAgIHJldHVybiByYXRlLm11bChnZXRDdXJyZW50Qm9udXMoKSkuZGl2KDEwMCkuYWRkKHJhdGUpOwogICAgICAgICAgICByZXR1cm4gcmF0ZVdpdGhEaXNjb3VudDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJhdGU7CiAgICB9CgogICAgLyoqCiAgICAqIEZ1bmN0aW9uIGlzIGNhbGxlZCB3aGVuIHRoZSBidXkgZnVuY3Rpb24gaXMgaW52b2tlZCAgb25seSBhZnRlciB0aGUgcHJlIHNhbGUgZHVyYXRpb24gYW5kIHJldHVybnMgCiAgICAqIHRoZSBjdXJyZW50IGRpc2NvdW50IGluIHBlcmNlbnRhZ2UuIEluIHRoaXMgZXhhbXBsZSwgdGhlIGRpc2NvdW50IHN0YXJ0cyBhdCAyMCUgYW5kIHJlZHVjZXMgYnkgNSUgZm9yIAogICAgKiBldmVyeSBkaXNjb3VudCBzdGFnZSB0aGF0IGhhcyBwYXNzZWQuIEFmdGVyIHRoZSA4dGggd2VlaywgdGhlIGRpc2NvdW50IHBlcmNlbnRhZ2Ugd2lsbCBiZSBzZXQgdG8gMC4KICAgICoKICAgICogZGF5IDMxIC0gMzcgICAvIHdlZWsgMTogMjAlCiAgICAqIGRheSAzOCAtIDQ0ICAgLyB3ZWVrIDI6IDE1JQogICAgKiBkYXkgNDUgLSA1MSAgIC8gd2VlayAzOiAxMCUKICAgICogZGF5IDUyIC0gNTggICAvIHdlZWsgNDogIDAlCiAgICAqLwogICAgZnVuY3Rpb24gZ2V0Q3VycmVudEJvbnVzKCkgaW50ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2IGRpc2NvdW50KSB7CiAgICAgICAgcmVxdWlyZSh0b2tlbnNTb2xkIDwgdG9rZW5DYXBGb3JGb3VydGhNYWluU3RhZ2UpOwogICAgICAgIHVpbnQyNTYgdGltZVN0YW1wID0gbm93OwogICAgICAgIHVpbnQyNTYgc3RhZ2U7CgogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IElDT2JvbnVzU3RhZ2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmICh0aW1lU3RhbXAgPD0gSUNPYm9udXNTdGFnZXNbaV0pIHsKICAgICAgICAgICAgICAgIHN0YWdlID0gaSArIDE7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfSAKICAgICAgICB9IAoKICAgICAgICBpZihzdGFnZSA9PSAxICYmIHRva2Vuc1NvbGQgPCB0b2tlbkNhcEZvckZpcnN0TWFpblN0YWdlKSB7IGRpc2NvdW50ID0gMjA7IH0KICAgICAgICBpZihzdGFnZSA9PSAxICYmIHRva2Vuc1NvbGQgPj0gdG9rZW5DYXBGb3JGaXJzdE1haW5TdGFnZSkgeyBkaXNjb3VudCA9IDE1OyB9CiAgICAgICAgaWYoc3RhZ2UgPT0gMSAmJiB0b2tlbnNTb2xkID49IHRva2VuQ2FwRm9yU2Vjb25kTWFpblN0YWdlKSB7IGRpc2NvdW50ID0gMTA7IH0KICAgICAgICBpZihzdGFnZSA9PSAxICYmIHRva2Vuc1NvbGQgPj0gdG9rZW5DYXBGb3JUaGlyZE1haW5TdGFnZSkgeyBkaXNjb3VudCA9IDA7IH0KCiAgICAgICAgaWYoc3RhZ2UgPT0gMiAmJiB0b2tlbnNTb2xkIDwgdG9rZW5DYXBGb3JTZWNvbmRNYWluU3RhZ2UpIHsgZGlzY291bnQgPSAxNTsgfQogICAgICAgIGlmKHN0YWdlID09IDIgJiYgdG9rZW5zU29sZCA+PSB0b2tlbkNhcEZvclNlY29uZE1haW5TdGFnZSkgeyBkaXNjb3VudCA9IDEwOyB9CiAgICAgICAgaWYoc3RhZ2UgPT0gMiAmJiB0b2tlbnNTb2xkID49IHRva2VuQ2FwRm9yVGhpcmRNYWluU3RhZ2UpIHsgZGlzY291bnQgPSAwOyB9CgogICAgICAgIGlmKHN0YWdlID09IDMgJiYgdG9rZW5zU29sZCA8IHRva2VuQ2FwRm9yVGhpcmRNYWluU3RhZ2UpIHsgZGlzY291bnQgPSAxMDsgfQogICAgICAgIGlmKHN0YWdlID09IDMgJiYgdG9rZW5zU29sZCA+PSB0b2tlbkNhcEZvclRoaXJkTWFpblN0YWdlKSB7IGRpc2NvdW50ID0gMDsgfQoKICAgICAgICBpZihzdGFnZSA9PSA0KSB7IGRpc2NvdW50ID0gMDsgfQoKICAgICAgICByZXR1cm4gZGlzY291bnQ7CiAgICB9CgoKICAgIAogICAgLyoqCiAgICAqIEZ1bmN0aW9uIGFjdGl2YXRlcyB0aGUgbWFpbiBJQ08gb25seSB3aGVuIHRoZSBkdXJhdGlvbiBvZiB0aGUgcHJlSUNPIGhhc3MgZmluaXNoZWQuIFRoaXMgZnVuY3Rpb24KICAgICogY2FuIG9ubHkgYmUgY2FsbGVkIGJ5IHRoZSBvd25lciBvZiB0aGUgY29udHJhY3QuIE9uY2UgY2FsbGVkLCB0aGUgYm9udXMgc3RhZ2VzIHdpbGwgYmUgc2V0IGFzIHN1Y2g6CiAgICAqIHdlZWsgMSB3aWxsIGhhdmUgMjAlIGJvbnVzLCB3ZWVrIDIgd2lsbCBoYXZlIDE1JSBib251cywgd2VlayAzIHdpbGwgaGF2ZSAxMCUgYm9udXMgYW5kIHdlZWsgNCB3aWxsIAogICAgKiBoYXZlIG5vIGJvbnVzLgogICAgKiovCiAgICBmdW5jdGlvbiBhY3RpdmF0ZU1haW5TYWxlKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShub3cgPiBwcmVJQ09kdXJhdGlvbiB8fCB0b2tlbnNTb2xkID49IHRva2Vuc0ZvclByZUlDTyk7CiAgICAgICAgcmVxdWlyZSghbWFpblNhbGVBY3RpdmUpOwogICAgICAgIGlmKG5vdyA8IHByZUlDT2R1cmF0aW9uKSB7IHByZUlDT2R1cmF0aW9uID0gbm93OyB9CiAgICAgICAgbWFpblNhbGVBY3RpdmUgPSB0cnVlOwogICAgICAgIElDT2JvbnVzU3RhZ2VzWzBdID0gbm93LmFkZCg3IG1pbnV0ZXMpOwoKICAgICAgICBmb3IgKHVpbnQgeSA9IDE7IHkgPCBJQ09ib251c1N0YWdlcy5sZW5ndGg7IHkrKykgewogICAgICAgICAgICBJQ09ib251c1N0YWdlc1t5XSA9IElDT2JvbnVzU3RhZ2VzW3kgLSAxXS5hZGQoNyBtaW51dGVzKTsKICAgICAgICB9CgogICAgICAgIGVuZFRpbWUgPSBJQ09ib251c1N0YWdlc1szXTsKICAgIH0KCiAgICBmdW5jdGlvbiBleHRlbmREdXJhdGlvbih1aW50MjU2IF9uZXdFbmRUaW1lKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKGVuZFRpbWUgPCBfbmV3RW5kVGltZSAmJiBtYWluU2FsZUFjdGl2ZSk7CiAgICAgICAgZW5kVGltZSA9IF9uZXdFbmRUaW1lOwogICAgICAgIElDT1NhbGVFeHRlbmRlZChfbmV3RW5kVGltZSk7CiAgICB9CgoKICAgIGZ1bmN0aW9uIGhhc0VuZGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCkgeyAKICAgICAgICByZXR1cm4gbm93ID4gZW5kVGltZTsKICAgIH0KCiAgICAvKioKICAgICogQWxsb3dzIHRoZSBvd25lciBvZiB0aGUgSUNPIGNvbnRyYWN0IHRvIHVucGF1c2UgdGhlIHRva2VuIGNvbnRyYWN0LiBUaGlzIGZ1bmN0aW9uIGlzIG5lZWRlZAogICAgKiBiZWNhdXNlIHRoZSBJQ08gY29udHJhY3QgZGVwbG95cyBhIG5ldyBpbnN0YW5jZSBvZiB0aGUgdG9rZW4gY29udHJhY3QsIGFuZCBieSBkZWZhdWx0IHRoZSAKICAgICogRVRIIGFkZHJlc3Mgd2hpY2ggZGVwbG95cyBhIGNvbnRyYWN0IHdoaWNoIGlzIE93bmFibGUgaXMgYXNzaWduZWQgb3duZXJzaGlwIG9mIHRoZSBjb250cmFjdCwKICAgICogc28gdGhlIElDTyBjb250cmFjdCBpcyB0aGUgb3duZXIgb2YgdGhlIHRva2VuIGNvbnRyYWN0LiBTaW5jZSB1bnBhdXNlIGlzIGEgZnVuY3Rpb24gd2hpY2ggY2FuCiAgICAqIG9ubHkgYmUgZXhlY3V0ZWQgYnkgdGhlIG93bmVyLCBieSBhZGRpbmcgdGhpcyBmdW5jdGlvbiBoZXJlLCB0aGVuIHRoZSBvd25lciBvZiB0aGUgSUNPIGNvbnRyYWN0CiAgICAqIGNhbiBjYWxsIHRoaXMgYW5kIHRoZW4gdGhlIElDTyBjb250cmFjdCB3aWxsIGludm9rZSB0aGUgdW5wYXVzZSBmdW5jdGlvbiBvZiB0aGUgdG9rZW4gY29udHJhY3QKICAgICogYW5kIHRodXMgdGhlIHRva2VuIGNvbnRyYWN0IHdpbGwgc3VjY2Vzc2Z1bGx5IHVucGF1c2UgYXMgaXRzIG93bmVyIHRoZSBJQ08gY29udHJhY3QgaW52b2tlbmQKICAgICogdGhlIHRoZSBmdW5jdGlvbi4gCiAgICAqLwogICAgZnVuY3Rpb24gdW5wYXVzZVRva2VuKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgdG9rZW4udW5wYXVzZSgpOwogICAgfQp9'.
	

]
