Class {
	#name : #SRT42a8e4d6a899a3095c32381d30bef5a0a9214ea4,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT42a8e4d6a899a3095c32381d30bef5a0a9214ea4 >> base64 [
	^ 'LyohIGlhbS5zb2wgfCAoYykgMjAxOCBEZXZlbG9wIGJ5IEJlbG92SVRMYWIgTExDIChzbWFydGNvbnRyYWN0LnJ1KSwgYXV0aG9yIEBzdHVwaWRsb3Zlam95IHwgTGljZW5zZTogTUlUICovCgpwcmFnbWEgc29saWRpdHkgMC40LjIxOwoKbGlicmFyeSBTYWZlTWF0aCB7CiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgaWYoYSA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgICAgICB1aW50MjU2IGMgPSBhICogYjsKICAgICAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnModWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoYiA8PSBhKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnModWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgICAgIGFzc2VydChjID49IGEpOwogICAgICAgIHJldHVybiBjOwogICAgfQp9Cgpjb250cmFjdCBPd25hYmxlIHsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwoKICAgIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsgXzsgfQoKICAgIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICAgICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIH0KfQoKY29udHJhY3QgV2l0aGRyYXdhYmxlIGlzIE93bmFibGUgewogICAgZnVuY3Rpb24gd2l0aGRyYXdFdGhlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZSh0aGlzLmJhbGFuY2UgPj0gX3ZhbHVlKTsKCiAgICAgICAgX3RvLnRyYW5zZmVyKF92YWx1ZSk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHdpdGhkcmF3VG9rZW5zKEVSQzIwIF90b2tlbiwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5T3duZXIgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICByZXR1cm4gX3Rva2VuLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICAgIH0KfQoKY29udHJhY3QgUGF1c2FibGUgaXMgT3duYWJsZSB7CiAgICBib29sIHB1YmxpYyBwYXVzZWQgPSBmYWxzZTsKCiAgICBldmVudCBQYXVzZSgpOwogICAgZXZlbnQgVW5wYXVzZSgpOwoKICAgIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7IHJlcXVpcmUoIXBhdXNlZCk7IF87IH0KICAgIG1vZGlmaWVyIHdoZW5QYXVzZWQoKSB7IHJlcXVpcmUocGF1c2VkKTsgXzsgfQoKICAgIGZ1bmN0aW9uIHBhdXNlKCkgb25seU93bmVyIHdoZW5Ob3RQYXVzZWQgcHVibGljIHsKICAgICAgICBwYXVzZWQgPSB0cnVlOwogICAgICAgIFBhdXNlKCk7CiAgICB9CgogICAgZnVuY3Rpb24gdW5wYXVzZSgpIG9ubHlPd25lciB3aGVuUGF1c2VkIHB1YmxpYyB7CiAgICAgICAgcGF1c2VkID0gZmFsc2U7CiAgICAgICAgVW5wYXVzZSgpOwogICAgfQp9Cgpjb250cmFjdCBFUkMyMCB7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIHZpZXcgcmV0dXJucyh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zKGJvb2wpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMoYm9vbCk7CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zKGJvb2wpOwp9Cgpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICAgIHN0cmluZyBwdWJsaWMgbmFtZTsKICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sOwogICAgdWludDggcHVibGljIGRlY2ltYWxzOwoKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgaW50ZXJuYWwgYWxsb3dlZDsKCiAgICBmdW5jdGlvbiBTdGFuZGFyZFRva2VuKHN0cmluZyBfbmFtZSwgc3RyaW5nIF9zeW1ib2wsIHVpbnQ4IF9kZWNpbWFscykgcHVibGljIHsKICAgICAgICBuYW1lID0gX25hbWU7CiAgICAgICAgc3ltYm9sID0gX3N5bWJvbDsKICAgICAgICBkZWNpbWFscyA9IF9kZWNpbWFsczsKICAgIH0KCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnModWludDI1NiBiYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwoKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBtdWx0aVRyYW5zZmVyKGFkZHJlc3NbXSBfdG8sIHVpbnQyNTZbXSBfdmFsdWUpIHB1YmxpYyByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF90by5sZW5ndGggPT0gX3ZhbHVlLmxlbmd0aCk7CgogICAgICAgIGZvcih1aW50IGkgPSAwOyBpIDwgX3RvLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHRyYW5zZmVyKF90b1tpXSwgX3ZhbHVlW2ldKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1tfZnJvbV0pOwogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKCiAgICAgICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CgogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwoKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwoKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKCiAgICAgICAgaWYoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgICAgICB9CgogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9Cgpjb250cmFjdCBNaW50YWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIE93bmFibGUgewogICAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgYW1vdW50KTsKICAgIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwoKICAgIGJvb2wgcHVibGljIG1pbnRpbmdGaW5pc2hlZCA9IGZhbHNlOwoKICAgIG1vZGlmaWVyIGNhbk1pbnQoKSB7IHJlcXVpcmUoIW1pbnRpbmdGaW5pc2hlZCk7IF87IH0KCiAgICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIG9ubHlPd25lciBjYW5NaW50IHB1YmxpYyByZXR1cm5zKGJvb2wpIHsKICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfYW1vdW50KTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CgogICAgICAgIE1pbnQoX3RvLCBfYW1vdW50KTsKICAgICAgICBUcmFuc2ZlcihhZGRyZXNzKDApLCBfdG8sIF9hbW91bnQpOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBmaW5pc2hNaW50aW5nKCkgb25seU93bmVyIGNhbk1pbnQgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIG1pbnRpbmdGaW5pc2hlZCA9IHRydWU7CgogICAgICAgIE1pbnRGaW5pc2hlZCgpOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQoKY29udHJhY3QgQ2FwcGVkVG9rZW4gaXMgTWludGFibGVUb2tlbiB7CiAgICB1aW50MjU2IHB1YmxpYyBjYXA7CgogICAgZnVuY3Rpb24gQ2FwcGVkVG9rZW4odWludDI1NiBfY2FwKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX2NhcCA+IDApOwogICAgICAgIGNhcCA9IF9jYXA7CiAgICB9CgogICAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmVxdWlyZSh0b3RhbFN1cHBseS5hZGQoX2Ftb3VudCkgPD0gY2FwKTsKCiAgICAgICAgcmV0dXJuIHN1cGVyLm1pbnQoX3RvLCBfYW1vdW50KTsKICAgIH0KfQoKY29udHJhY3QgQnVybmFibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuIHsKICAgIGV2ZW50IEJ1cm4oYWRkcmVzcyBpbmRleGVkIGJ1cm5lciwgdWludDI1NiB2YWx1ZSk7CgogICAgZnVuY3Rpb24gYnVybih1aW50MjU2IF92YWx1ZSkgcHVibGljIHsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1ttc2cuc2VuZGVyXSk7CgogICAgICAgIGFkZHJlc3MgYnVybmVyID0gbXNnLnNlbmRlcjsKCiAgICAgICAgYmFsYW5jZXNbYnVybmVyXSA9IGJhbGFuY2VzW2J1cm5lcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5zdWIoX3ZhbHVlKTsKCiAgICAgICAgQnVybihidXJuZXIsIF92YWx1ZSk7CiAgICB9Cn0KCi8qCiAgICBJQ08gSUFNCiovCmNvbnRyYWN0IFRva2VuIGlzIENhcHBlZFRva2VuLCBCdXJuYWJsZVRva2VuLCBXaXRoZHJhd2FibGUgewogICAgZnVuY3Rpb24gVG9rZW4oKSBDYXBwZWRUb2tlbig3MDAwMDAwMCAqIDEgZXRoZXIpIFN0YW5kYXJkVG9rZW4oIklBTSBBZXJvIiwgIklBTSIsIDE4KSBwdWJsaWMgewogICAgICAgIAogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKCiAgICAgICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwoKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQoKY29udHJhY3QgQ3Jvd2RzYWxlIGlzIFBhdXNhYmxlLCBXaXRoZHJhd2FibGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CgogICAgc3RydWN0IFN0ZXAgewogICAgICAgIHVpbnQgcHJpY2VUb2tlbldlaTsKICAgICAgICB1aW50IHRva2Vuc0ZvclNhbGU7CiAgICAgICAgdWludCBtaW5JbnZlc3RFdGg7CiAgICAgICAgdWludCB0b2tlbnNTb2xkOwogICAgICAgIHVpbnQgY29sbGVjdGVkV2VpOwoKICAgICAgICBib29sIHRyYW5zZmVyQmFsYW5jZTsKICAgICAgICBib29sIHNhbGU7CiAgICAgICAgYm9vbCBpc3N1ZTsKICAgIH0KCiAgICBUb2tlbiBwdWJsaWMgdG9rZW47CiAgICBhZGRyZXNzIHB1YmxpYyBiZW5lZmljaWFyeSA9IDB4NGFlN2JkZjk1MzBjZEI2NjZGQzE0REY3OUMxNjllMTQ1MDRjNjIxQTsKCiAgICBTdGVwW10gcHVibGljIHN0ZXBzOwogICAgdWludDggcHVibGljIGN1cnJlbnRTdGVwID0gMDsKCiAgICBib29sIHB1YmxpYyBjcm93ZHNhbGVDbG9zZWQgPSBmYWxzZTsKCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGNhblNlbGw7CgogICAgZXZlbnQgUHVyY2hhc2UoYWRkcmVzcyBpbmRleGVkIGhvbGRlciwgdWludDI1NiB0b2tlbkFtb3VudCwgdWludDI1NiBldGhlckFtb3VudCk7CiAgICBldmVudCBJc3N1ZShhZGRyZXNzIGluZGV4ZWQgaG9sZGVyLCB1aW50MjU2IHRva2VuQW1vdW50KTsKICAgIGV2ZW50IFNlbGwoYWRkcmVzcyBpbmRleGVkIGhvbGRlciwgdWludDI1NiB0b2tlbkFtb3VudCwgdWludDI1NiBldGhlckFtb3VudCk7CiAgICBldmVudCBOZXdSYXRlKHVpbnQyNTYgcmF0ZSk7CiAgICBldmVudCBOZXh0U3RlcCh1aW50OCBzdGVwKTsKICAgIGV2ZW50IENyb3dkc2FsZUNsb3NlKCk7CgogICAgZnVuY3Rpb24gQ3Jvd2RzYWxlKCkgcHVibGljIHsKICAgICAgICB0b2tlbiA9IG5ldyBUb2tlbigpOwoKICAgICAgICBzdGVwcy5wdXNoKFN0ZXAoMSBldGhlciAvIDEwMDAsIDEwMDAwMDAgKiAxIGV0aGVyLCAwLjAxIGV0aGVyLCAwLCAwLCB0cnVlLCBmYWxzZSwgdHJ1ZSkpOwogICAgICAgIHN0ZXBzLnB1c2goU3RlcCgxIGV0aGVyIC8gMTAwMCwgMTUwMDAwMCAqIDEgZXRoZXIsIDAuMDEgZXRoZXIsIDAsIDAsIHRydWUsIGZhbHNlLCB0cnVlKSk7CiAgICAgICAgc3RlcHMucHVzaChTdGVwKDEgZXRoZXIgLyAxMDAwLCAzMDAwMDAwICogMSBldGhlciwgMC4wMSBldGhlciwgMCwgMCwgdHJ1ZSwgZmFsc2UsIHRydWUpKTsKICAgICAgICBzdGVwcy5wdXNoKFN0ZXAoMSBldGhlciAvIDEwMDAsIDkwMDAwMDAgKiAxIGV0aGVyLCAwLjAxIGV0aGVyLCAwLCAwLCB0cnVlLCBmYWxzZSwgdHJ1ZSkpOwogICAgICAgIHN0ZXBzLnB1c2goU3RlcCgxIGV0aGVyIC8gMTAwMCwgMzUwMDAwMDAgKiAxIGV0aGVyLCAwLjAxIGV0aGVyLCAwLCAwLCB0cnVlLCBmYWxzZSwgdHJ1ZSkpOwogICAgICAgIHN0ZXBzLnB1c2goU3RlcCgxIGV0aGVyIC8gMTAwMCwgMjA1MDAwMDAgKiAxIGV0aGVyLCAwLjAxIGV0aGVyLCAwLCAwLCB0cnVlLCB0cnVlLCB0cnVlKSk7CiAgICB9CgogICAgZnVuY3Rpb24oKSBwYXlhYmxlIHB1YmxpYyB7CiAgICAgICAgcHVyY2hhc2UoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRUb2tlblJhdGUodWludCBfdmFsdWUpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoIWNyb3dkc2FsZUNsb3NlZCk7CgogICAgICAgIHN0ZXBzW2N1cnJlbnRTdGVwXS5wcmljZVRva2VuV2VpID0gMSBldGhlciAvIF92YWx1ZTsKCiAgICAgICAgTmV3UmF0ZShzdGVwc1tjdXJyZW50U3RlcF0ucHJpY2VUb2tlbldlaSk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHB1cmNoYXNlKCkgd2hlbk5vdFBhdXNlZCBwYXlhYmxlIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZSghY3Jvd2RzYWxlQ2xvc2VkKTsKCiAgICAgICAgU3RlcCBtZW1vcnkgc3RlcCA9IHN0ZXBzW2N1cnJlbnRTdGVwXTsKCiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPj0gc3RlcC5taW5JbnZlc3RFdGgpOwogICAgICAgIHJlcXVpcmUoc3RlcC50b2tlbnNTb2xkIDwgc3RlcC50b2tlbnNGb3JTYWxlKTsKCiAgICAgICAgdWludCBzdW0gPSBtc2cudmFsdWU7CiAgICAgICAgdWludCBhbW91bnQgPSBzdW0ubXVsKDEgZXRoZXIpLmRpdihzdGVwLnByaWNlVG9rZW5XZWkpOwogICAgICAgIHVpbnQgcmV0U3VtID0gMDsKICAgICAgICAKICAgICAgICBpZihzdGVwLnRva2Vuc1NvbGQuYWRkKGFtb3VudCkgPiBzdGVwLnRva2Vuc0ZvclNhbGUpIHsKICAgICAgICAgICAgdWludCByZXRBbW91bnQgPSBzdGVwLnRva2Vuc1NvbGQuYWRkKGFtb3VudCkuc3ViKHN0ZXAudG9rZW5zRm9yU2FsZSk7CiAgICAgICAgICAgIHJldFN1bSA9IHJldEFtb3VudC5tdWwoc3RlcC5wcmljZVRva2VuV2VpKS5kaXYoMSBldGhlcik7CgogICAgICAgICAgICBhbW91bnQgPSBhbW91bnQuc3ViKHJldEFtb3VudCk7CiAgICAgICAgICAgIHN1bSA9IHN1bS5zdWIocmV0U3VtKTsKICAgICAgICB9CgogICAgICAgIHN0ZXBzW2N1cnJlbnRTdGVwXS50b2tlbnNTb2xkID0gc3RlcC50b2tlbnNTb2xkLmFkZChhbW91bnQpOwogICAgICAgIHN0ZXBzW2N1cnJlbnRTdGVwXS5jb2xsZWN0ZWRXZWkgPSBzdGVwLmNvbGxlY3RlZFdlaS5hZGQoc3VtKTsKCiAgICAgICAgaWYoY3VycmVudFN0ZXAgPT0gMCkgewogICAgICAgICAgICBjYW5TZWxsW21zZy5zZW5kZXJdID0gY2FuU2VsbFttc2cuc2VuZGVyXS5hZGQoYW1vdW50KTsKICAgICAgICB9CgogICAgICAgIGlmKHN0ZXAudHJhbnNmZXJCYWxhbmNlKSB7CiAgICAgICAgICAgIHVpbnQgcDEgPSBzdW0uZGl2KDIwMCk7CiAgICAgICAgICAgICgweEQ4QzdmMjIxNWY5MDQ2M2MxNThFOTFiOTJEODFmMEExRTMxODdDMUIpLnRyYW5zZmVyKHAxLm11bCgzKSk7CiAgICAgICAgICAgICgweDhDOGQ4MGVmZmIyYzVDMUU0RDg1N2UyODY4MjJFMEU2NDFjQTM4MzYpLnRyYW5zZmVyKHAxLm11bCgzKSk7CiAgICAgICAgICAgIGJlbmVmaWNpYXJ5LnRyYW5zZmVyKHN1bS5zdWIocDEubXVsKDYpKSk7CiAgICAgICAgfQogICAgICAgIHRva2VuLm1pbnQobXNnLnNlbmRlciwgYW1vdW50KTsKCiAgICAgICAgaWYocmV0U3VtID4gMCkgewogICAgICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHJldFN1bSk7CiAgICAgICAgfQoKICAgICAgICBQdXJjaGFzZShtc2cuc2VuZGVyLCBhbW91bnQsIHN1bSk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGlzc3VlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgb25seU93bmVyIHdoZW5Ob3RQYXVzZWQgcHVibGljIHsKICAgICAgICByZXF1aXJlKCFjcm93ZHNhbGVDbG9zZWQpOwoKICAgICAgICBTdGVwIG1lbW9yeSBzdGVwID0gc3RlcHNbY3VycmVudFN0ZXBdOwogICAgICAgIAogICAgICAgIHJlcXVpcmUoc3RlcC5pc3N1ZSk7CiAgICAgICAgcmVxdWlyZShzdGVwLnRva2Vuc1NvbGQuYWRkKF92YWx1ZSkgPD0gc3RlcC50b2tlbnNGb3JTYWxlKTsKCiAgICAgICAgc3RlcHNbY3VycmVudFN0ZXBdLnRva2Vuc1NvbGQgPSBzdGVwLnRva2Vuc1NvbGQuYWRkKF92YWx1ZSk7CgogICAgICAgIGlmKGN1cnJlbnRTdGVwID09IDApIHsKICAgICAgICAgICAgY2FuU2VsbFtfdG9dID0gY2FuU2VsbFtfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgdG9rZW4ubWludChfdG8sIF92YWx1ZSk7CgogICAgICAgIElzc3VlKF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZWxsKHVpbnQyNTYgX3ZhbHVlKSB3aGVuTm90UGF1c2VkIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZSghY3Jvd2RzYWxlQ2xvc2VkKTsKCiAgICAgICAgcmVxdWlyZShjYW5TZWxsW21zZy5zZW5kZXJdID49IF92YWx1ZSk7CiAgICAgICAgcmVxdWlyZSh0b2tlbi5iYWxhbmNlT2YobXNnLnNlbmRlcikgPj0gX3ZhbHVlKTsKCiAgICAgICAgU3RlcCBtZW1vcnkgc3RlcCA9IHN0ZXBzW2N1cnJlbnRTdGVwXTsKICAgICAgICAKICAgICAgICByZXF1aXJlKHN0ZXAuc2FsZSk7CgogICAgICAgIGNhblNlbGxbbXNnLnNlbmRlcl0gPSBjYW5TZWxsW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgICAgIHRva2VuLnRyYW5zZmVyT3duZXIobXNnLnNlbmRlciwgYmVuZWZpY2lhcnksIF92YWx1ZSk7CgogICAgICAgIHVpbnQgc3VtID0gX3ZhbHVlLm11bChzdGVwLnByaWNlVG9rZW5XZWkpLmRpdigxIGV0aGVyKTsKCiAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihzdW0pOwoKICAgICAgICBTZWxsKG1zZy5zZW5kZXIsIF92YWx1ZSwgc3VtKTsKICAgIH0KCiAgICBmdW5jdGlvbiBuZXh0U3RlcCh1aW50IF92YWx1ZSkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZSghY3Jvd2RzYWxlQ2xvc2VkKTsKICAgICAgICByZXF1aXJlKHN0ZXBzLmxlbmd0aCAtIDEgPiBjdXJyZW50U3RlcCk7CiAgICAgICAgCiAgICAgICAgY3VycmVudFN0ZXAgKz0gMTsKCiAgICAgICAgc2V0VG9rZW5SYXRlKF92YWx1ZSk7CgogICAgICAgIE5leHRTdGVwKGN1cnJlbnRTdGVwKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjbG9zZUNyb3dkc2FsZSgpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoIWNyb3dkc2FsZUNsb3NlZCk7CiAgICAgICAgCiAgICAgICAgYmVuZWZpY2lhcnkudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgICAgICB0b2tlbi5taW50KGJlbmVmaWNpYXJ5LCB0b2tlbi5jYXAoKS5zdWIodG9rZW4udG90YWxTdXBwbHkoKSkpOwogICAgICAgIHRva2VuLmZpbmlzaE1pbnRpbmcoKTsKICAgICAgICB0b2tlbi50cmFuc2Zlck93bmVyc2hpcChiZW5lZmljaWFyeSk7CgogICAgICAgIGNyb3dkc2FsZUNsb3NlZCA9IHRydWU7CgogICAgICAgIENyb3dkc2FsZUNsb3NlKCk7CiAgICB9Cn0='.
	

]
