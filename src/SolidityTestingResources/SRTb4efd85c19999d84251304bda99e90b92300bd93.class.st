Class {
	#name : #SRTb4efd85c19999d84251304bda99e90b92300bd93,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTb4efd85c19999d84251304bda99e90b92300bd93 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7Cgpjb250cmFjdCBPd25lZCB7CgogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICBhZGRyZXNzIHB1YmxpYyBuZXdPd25lcjsKICAgIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90byk7CgogICAgZnVuY3Rpb24gT3duZWQoKSB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgX25ld093bmVyKSBvbmx5T3duZXIgewogICAgICAgIG5ld093bmVyID0gX25ld093bmVyOwogICAgfQoKICAgIGZ1bmN0aW9uIGFjY2VwdE93bmVyc2hpcCgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gbmV3T3duZXIpOwogICAgICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgIH0KICAgIAp9Cgpjb250cmFjdCBUb2tlbiB7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZyk7CiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpOwp9CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gbWF4NjQodWludDY0IGEsIHVpbnQ2NCBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50NjQpIHsKICAgIHJldHVybiBhID49IGIgPyBhIDogYjsKICB9CgogIGZ1bmN0aW9uIG1pbjY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7CiAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsKICB9CgogIGZ1bmN0aW9uIG1heDI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOwogIH0KCiAgZnVuY3Rpb24gbWluMjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsKICB9Cgp9Cgpjb250cmFjdCBTYWxlc0FnZW50SW50ZXJmYWNlIHsKICAgICAvKioqKiBQcm9wZXJ0aWVzICoqKioqKioqKioqLwogICAgLy8gTWFpbiBjb250cmFjdCB0b2tlbiBhZGRyZXNzCiAgICBhZGRyZXNzIHRva2VuQ29udHJhY3RBZGRyZXNzOwogICAgLy8gQ29udHJpYnV0aW9ucyBwZXIgYWRkcmVzcwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgY29udHJpYnV0aW9uczsgICAgCiAgICAvLyBUb3RhbCBFVEggY29udHJpYnV0ZWQgICAgIAogICAgdWludDI1NiBwdWJsaWMgY29udHJpYnV0ZWRUb3RhbDsgICAgICAgICAgICAgICAgICAgICAgIAogICAgLy8vIEBkZXYgT25seSBhbGxvdyBhY2Nlc3MgZnJvbSB0aGUgbWFpbiB0b2tlbiBjb250cmFjdAogICAgbW9kaWZpZXIgb25seVRva2VuQ29udHJhY3QoKSB7Xzt9CiAgICAvKioqIEV2ZW50cyAqKioqKioqKioqKioqKioqLwogICAgZXZlbnQgQ29udHJpYnV0ZShhZGRyZXNzIF9hZ2VudCwgYWRkcmVzcyBfc2VuZGVyLCB1aW50MjU2IF92YWx1ZSk7CiAgICBldmVudCBGaW5hbGlzZVNhbGUoYWRkcmVzcyBfYWdlbnQsIGFkZHJlc3MgX3NlbmRlciwgdWludDI1NiBfdmFsdWUpOwogICAgZXZlbnQgUmVmdW5kKGFkZHJlc3MgX2FnZW50LCBhZGRyZXNzIF9zZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsKICAgIGV2ZW50IENsYWltVG9rZW5zKGFkZHJlc3MgX2FnZW50LCBhZGRyZXNzIF9zZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsgIAogICAgLyoqKiBNZXRob2RzICoqKioqKioqKioqKioqKiovCiAgICAvLy8gQGRldiBUaGUgYWRkcmVzcyB1c2VkIGZvciB0aGUgZGVwb3NpdEFkZHJlc3MgbXVzdCBjaGVja2luIHdpdGggdGhlIGNvbnRyYWN0IHRvIHZlcmlmeSBpdCBjYW4gaW50ZXJhY3Qgd2l0aCB0aGlzIGNvbnRyYWN0LCBtdXN0IGhhcHBlbiBvciBpdCB3b24ndCBhY2NlcHQgZnVuZHMKICAgIGZ1bmN0aW9uIGdldERlcG9zaXRBZGRyZXNzVmVyaWZ5KCkgcHVibGljOwogICAgLy8vIEBkZXYgR2V0IHRoZSBjb250cmlidXRpb24gdG90YWwgb2YgRVRIIGZyb20gYSBjb250cmlidXRvcgogICAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIG93bmVycyBhZGRyZXNzCiAgICBmdW5jdGlvbiBnZXRDb250cmlidXRpb25PZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKfQoKLyogIEVSQyAyMCB0b2tlbiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIFRva2VuIHsKCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIF92YWx1ZSA+IDApIHsKICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSBfdmFsdWU7CiAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICBpZiAoYmFsYW5jZXNbX2Zyb21dID49IF92YWx1ZSAmJiBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgewogICAgICAgIGJhbGFuY2VzW190b10gKz0gX3ZhbHVlOwogICAgICAgIGJhbGFuY2VzW19mcm9tXSAtPSBfdmFsdWU7CiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOwogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7Cn0KCi8vLyBAdGl0bGUgVGhlIG1haW4gUm9ja2V0IFBvb2wgVG9rZW4gKFJQTCkgY29udHJhY3QKLy8vIEBhdXRob3IgRGF2aWQgUnVnZW5keWtlIC0gaHR0cDovL3d3dy5yb2NrZXRwb29sLm5ldAoKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiogICBUaGlzIGlzIHRoZSBtYWluIFJvY2tldCBQb29sIFRva2VuIChSUEwpIGNvbnRyYWN0LiBJdCBmZWF0dXJlcwoqICAgU21hcnQgQWdlbnQgY29tcGF0aWJpbGl0eS4gVGhlIFNhbGUgQWdlbnQgaXMgYSBuZXcgdHlwZSBvZiAKKiAgIGNvbnRyYWN0IHRoYXQgY2FuIGF1dGhvcmlzZSB0aGUgbWludGluZyBvZiB0b2tlbnMgb24gYmVoYWxmIG9mCiogICB0aGUgdHJhZGl0aW9uYWwgRVJDMjAgdG9rZW4gY29udHJhY3QuIFRoaXMgYWxsb3dzIHlvdSB0byAKKiAgIGRpc3RyaWJ1dGUgeW91ciBJQ08gdG9rZW5zIHRocm91Z2ggbXVsdGlwbGUgU2FsZSBBZ2VudHMsIAoqICAgYXQgdmFyaW91cyB0aW1lcywgb2YgdmFyaW91cyB0b2tlbiBxdWFudGl0aWVzIGFuZCBvZiB2YXJ5aW5nCiogICBmdW5kIHRhcmdldHMuIE9uY2UgeW914oCZdmUgd3JpdHRlbiBhIG5ldyBTYWxlIEFnZW50IGNvbnRyYWN0LAoqICAgeW91IGNhbiByZWdpc3RlciBoaW0gd2l0aCB0aGUgbWFpbiBFUkMyMCB0b2tlbiBjb250cmFjdCwgCiogICBoZeKAmXMgdGhlbiBwZXJtaXR0ZWQgdG8gc2VsbCBpdOKAmXMgdG9rZW5zIG9uIHlvdXIgYmVoYWxmIHVzaW5nCiogICBndWlkZWxpbmVzIHN1Y2ggYXMgdGhlIGFtb3VudCBvZiB0b2tlbnMgaGXigJlzIGFsbG93ZWQgdG8gc2VsbCwgCiogICB0aGUgbWF4aW11bSBldGhlciBoZeKAmXMgYWxsb3dlZCB0byByYWlzZSwgdGhlIHN0YXJ0IGJsb2NrIGFuZAoqICAgZW5kIGJsb2NrcyBoZeKAmXMgYWxsb3dlZCB0byBzZWxsIGJldHdlZW4gYW5kIG1vcmUuCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKY29udHJhY3QgUm9ja2V0UG9vbFRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIE93bmVkIHsKCiAgICAgLyoqKiogUHJvcGVydGllcyAqKioqKioqKioqKi8KCiAgICBzdHJpbmcgcHVibGljIG5hbWUgPSAiUm9ja2V0IFBvb2wiOwogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAiUlBMIjsKICAgIHN0cmluZyBwdWJsaWMgdmVyc2lvbiA9ICIxLjAiOwogICAgLy8gU2V0IG91ciB0b2tlbiB1bml0cwogICAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CiAgICB1aW50MjU2IHB1YmxpYyBleHBvbmVudCA9IDEwKip1aW50MjU2KGRlY2ltYWxzKTsKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5ID0gMDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSB0b3RhbCBvZiB0b2tlbnMgY3VycmVudGx5IG1pbnRlZCBieSBzYWxlcyBhZ2VudCBjb250cmFjdHMgICAgCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseUNhcCA9IDE4ICogKDEwKio2KSAqIGV4cG9uZW50OyAgICAvLyAxOCBNaWxsaW9uIHRva2VucwoKCiAgICAvKioqKiBMaWJzICoqKioqKioqKioqKioqKioqLwogICAgCiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgIAogICAgCiAgICAvKioqIFNhbGUgQWRkcmVzc2VzICoqKioqKioqKi8KICAgICAgIAogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBTYWxlc0FnZW50KSBwcml2YXRlIHNhbGVzQWdlbnRzOyAgIC8vIE91ciBjb250cmFjdCBhZGRyZXNzZXMgb2Ygb3VyIHNhbGVzIGNvbnRyYWN0cyAKICAgIGFkZHJlc3NbXSBwcml2YXRlIHNhbGVzQWdlbnRzQWRkcmVzc2VzOyAgICAgICAgICAgICAgICAvLyBLZWVwIGFuIGFycmF5IG9mIGFsbCBvdXIgc2FsZXMgYWdlbnQgYWRkcmVzc2VzIGZvciBpdGVyYXRpb24KCiAgICAvKioqIFN0cnVjdHMgKioqKioqKioqKioqKioqLwogICAgICAgICAgICAgCiAgICBzdHJ1Y3QgU2FsZXNBZ2VudCB7ICAgICAgICAgICAgICAgICAgICAgLy8gVGhlc2UgYXJlIGNvbnRyYWN0IGFkZHJlc3NlcyB0aGF0IGFyZSBhdXRob3Jpc2VkIHRvIG1pbnQgdG9rZW5zCiAgICAgICAgYWRkcmVzcyBzYWxlQ29udHJhY3RBZGRyZXNzOyAgICAgICAgLy8gQWRkcmVzcyBvZiB0aGUgY29udHJhY3QKICAgICAgICBieXRlczMyIHNhbGVDb250cmFjdFR5cGU7ICAgICAgICAgICAvLyBUeXBlIG9mIHRoZSBjb250cmFjdCBpZS4gcHJlc2FsZSwgY3Jvd2RzYWxlIAogICAgICAgIHVpbnQyNTYgdGFyZ2V0RXRoTWF4OyAgICAgICAgICAgICAgIC8vIFRoZSBtYXggYW1vdW50IG9mIGV0aGVyIHRoZSBhZ2VudCBpcyBhbGxvd2VkIHJhaXNlCiAgICAgICAgdWludDI1NiB0YXJnZXRFdGhNaW47ICAgICAgICAgICAgICAgLy8gVGhlIG1pbiBhbW91bnQgb2YgZXRoZXIgdG8gcmFpc2UgdG8gY29uc2lkZXIgdGhpcyBjb250cmFjdHMgc2FsZXMgYSBzdWNjZXNzCiAgICAgICAgdWludDI1NiB0b2tlbnNMaW1pdDsgICAgICAgICAgICAgICAgLy8gVGhlIG1heGltdW0gYW1vdW50IG9mIHRva2VucyB0aGlzIHNhbGUgY29udHJhY3QgaXMgYWxsb3dlZCB0byBkaXN0cmlidXRlCiAgICAgICAgdWludDI1NiB0b2tlbnNNaW50ZWQ7ICAgICAgICAgICAgICAgLy8gVGhlIGN1cnJlbnQgYW1vdW50IG9mIHRva2VucyBtaW50ZWQgYnkgdGhpcyBhZ2VudAogICAgICAgIHVpbnQyNTYgbWluRGVwb3NpdDsgICAgICAgICAgICAgICAgIC8vIFRoZSBtaW5pbXVtIGRlcG9zaXQgYW1vdW50IGFsbG93ZWQKICAgICAgICB1aW50MjU2IG1heERlcG9zaXQ7ICAgICAgICAgICAgICAgICAvLyBUaGUgbWF4aW11bSBkZXBvc2l0IGFtb3VudCBhbGxvd2VkCiAgICAgICAgdWludDI1NiBzdGFydEJsb2NrOyAgICAgICAgICAgICAgICAgLy8gVGhlIHN0YXJ0IGJsb2NrIHdoZW4gYWxsb3dlZCB0byBtaW50IHRva2VucwogICAgICAgIHVpbnQyNTYgZW5kQmxvY2s7ICAgICAgICAgICAgICAgICAgIC8vIFRoZSBlbmQgYmxvY2sgd2hlbiB0byBmaW5pc2ggbWludGluZyB0b2tlbnMKICAgICAgICBhZGRyZXNzIGRlcG9zaXRBZGRyZXNzOyAgICAgICAgICAgICAvLyBUaGUgYWRkcmVzcyB0aGF0IHJlY2VpdmVzIHRoZSBldGhlciBmb3IgdGhhdCBzYWxlIGNvbnRyYWN0CiAgICAgICAgYm9vbCBkZXBvc2l0QWRkcmVzc0NoZWNrZWRJbjsgICAgICAgLy8gVGhlIGFkZHJlc3MgdGhhdCByZWNlaXZlcyB0aGUgZXRoZXIgZm9yIHRoYXQgc2FsZSBjb250cmFjdCBtdXN0IGNoZWNrIGluIHdpdGggaXRzIHNhbGUgY29udHJhY3QgdG8gdmVyaWZ5IGl0cyBhIHZhbGlkIGFkZHJlc3MgdGhhdCBjYW4gaW50ZXJhY3QKICAgICAgICBib29sIGZpbmFsaXNlZDsgICAgICAgICAgICAgICAgICAgICAvLyBIYXMgdGhpcyBzYWxlcyBjb250cmFjdCBiZWVuIGNvbXBsZXRlZCBhbmQgdGhlIGV0aGVyIHNlbnQgdG8gdGhlIGRlcG9zaXQgYWRkcmVzcz8KICAgICAgICBib29sIGV4aXN0czsgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhlIG1hcHBpbmcgZXhpc3RzCiAgICB9CgogICAgLyoqKiBFdmVudHMgKioqKioqKioqKioqKioqKi8KCiAgICBldmVudCBNaW50VG9rZW4oYWRkcmVzcyBfYWdlbnQsIGFkZHJlc3MgX2FkZHJlc3MsIHVpbnQyNTYgX3ZhbHVlKTsKICAgIGV2ZW50IFNhbGVGaW5hbGlzZWQoYWRkcmVzcyBfYWdlbnQsIGFkZHJlc3MgX2FkZHJlc3MsIHVpbnQyNTYgX3ZhbHVlKTsKICAKICAgIC8qKiogVGVzdHMgKioqKioqKioqKioqKioqKiovCgogICAgZXZlbnQgRmxhZ1VpbnQodWludDI1NiBmbGFnKTsKICAgIGV2ZW50IEZsYWdBZGRyZXNzKGFkZHJlc3MgZmxhZyk7CgogICAgCiAgICAvKioqIE1vZGlmaWVycyAqKioqKioqKioqKioqLwoKICAgIC8vLyBAZGV2IE9ubHkgYWxsb3cgYWNjZXNzIGZyb20gdGhlIGxhdGVzdCB2ZXJzaW9uIG9mIGEgc2FsZXMgY29udHJhY3QKICAgIG1vZGlmaWVyIGlzU2FsZXNDb250cmFjdChhZGRyZXNzIF9zZW5kZXIpIHsKICAgICAgICAvLyBJcyB0aGlzIGFuIGF1dGhvcmlzZWQgc2FsZSBjb250cmFjdD8KICAgICAgICBhc3NlcnQoc2FsZXNBZ2VudHNbX3NlbmRlcl0uZXhpc3RzID09IHRydWUpOwogICAgICAgIF87CiAgICB9CgogICAgCiAgICAvKioqKiBNZXRob2RzICoqKioqKioqKioqLwoKICAgIC8vLyBAZGV2IFJQTCBUb2tlbiBJbml0CiAgICBmdW5jdGlvbiBSb2NrZXRQb29sVG9rZW4oKSB7fQoKCiAgICAvLyBAZGV2IEdlbmVyYWwgdmFsaWRhdGlvbiBmb3IgYSBzYWxlcyBhZ2VudCBjb250cmFjdCByZWNlaXZpbmcgYSBjb250cmlidXRpb24sIGFkZGl0aW9uYWwgdmFsaWRhdGlvbiBjYW4gYmUgZG9uZSBpbiB0aGUgc2FsZSBjb250cmFjdCBpZiByZXF1aXJlZAogICAgLy8gQHBhcmFtIF92YWx1ZSBUaGUgdmFsdWUgb2YgdGhlIGNvbnRyaWJ1dGlvbiBpbiB3ZWkKICAgIC8vIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICBmdW5jdGlvbiB2YWxpZGF0ZUNvbnRyaWJ1dGlvbih1aW50MjU2IF92YWx1ZSkgaXNTYWxlc0NvbnRyYWN0KG1zZy5zZW5kZXIpIHJldHVybnMgKGJvb2wpIHsKICAgICAgICAvLyBHZXQgYW4gaW5zdGFuY2Ugb2YgdGhlIHNhbGUgYWdlbnQgY29udHJhY3QKICAgICAgICBTYWxlc0FnZW50SW50ZXJmYWNlIHNhbGVBZ2VudCA9IFNhbGVzQWdlbnRJbnRlcmZhY2UobXNnLnNlbmRlcik7CiAgICAgICAgLy8gRGlkIHRoZXkgc2VuZCBhbnl0aGluZyBmcm9tIGEgcHJvcGVyIGFkZHJlc3M/CiAgICAgICAgYXNzZXJ0KF92YWx1ZSA+IDApOyAgCiAgICAgICAgLy8gQ2hlY2sgdGhlIGRlcG9zaXRBZGRyZXNzIGhhcyBiZWVuIHZlcmlmaWVkIGJ5IHRoZSBhY2NvdW50IGhvbGRlcgogICAgICAgIGFzc2VydChzYWxlc0FnZW50c1ttc2cuc2VuZGVyXS5kZXBvc2l0QWRkcmVzc0NoZWNrZWRJbiA9PSB0cnVlKTsKICAgICAgICAvLyBDaGVjayBpZiB3ZSdyZSBvayB0byByZWNlaXZlIGNvbnRyaWJ1dGlvbnMsIGhhdmUgd2Ugc3RhcnRlZD8KICAgICAgICBhc3NlcnQoYmxvY2subnVtYmVyID4gc2FsZXNBZ2VudHNbbXNnLnNlbmRlcl0uc3RhcnRCbG9jayk7ICAgICAgIAogICAgICAgIC8vIEFscmVhZHkgZW5kZWQ/IE9yIGlmIHRoZSBlbmQgYmxvY2sgaXMgMCwgaXQncyBhbiBvcGVuIGVuZGVkIHNhbGUgdW50aWwgZmluYWxpc2VkIGJ5IHRoZSBkZXBvc2l0QWRkcmVzcwogICAgICAgIGFzc2VydChibG9jay5udW1iZXIgPCBzYWxlc0FnZW50c1ttc2cuc2VuZGVyXS5lbmRCbG9jayB8fCBzYWxlc0FnZW50c1ttc2cuc2VuZGVyXS5lbmRCbG9jayA9PSAwKTsgCiAgICAgICAgLy8gSXMgaXQgYWJvdmUgdGhlIG1pbiBkZXBvc2l0IGFtb3VudD8KICAgICAgICBhc3NlcnQoX3ZhbHVlID49IHNhbGVzQWdlbnRzW21zZy5zZW5kZXJdLm1pbkRlcG9zaXQpOyAKICAgICAgICAvLyBJcyBpdCBiZWxvdyB0aGUgbWF4IGRlcG9zaXQgYWxsb3dlZD8KICAgICAgICBhc3NlcnQoX3ZhbHVlIDw9IHNhbGVzQWdlbnRzW21zZy5zZW5kZXJdLm1heERlcG9zaXQpOyAKICAgICAgICAvLyBObyBjb250cmlidXRpb25zIGlmIHRoZSBzYWxlIGNvbnRyYWN0IGhhcyBmaW5hbGlzZWQKICAgICAgICBhc3NlcnQoc2FsZXNBZ2VudHNbbXNnLnNlbmRlcl0uZmluYWxpc2VkID09IGZhbHNlKTsgICAgICAKICAgICAgICAvLyBEb2VzIHRoaXMgZGVwb3NpdCBwdXQgaXQgb3ZlciB0aGUgbWF4IHRhcmdldCBldGhlciBmb3IgdGhlIHNhbGUgY29udHJhY3Q/CiAgICAgICAgYXNzZXJ0KHNhbGVBZ2VudC5jb250cmlidXRlZFRvdGFsKCkuYWRkKF92YWx1ZSkgPD0gc2FsZXNBZ2VudHNbbXNnLnNlbmRlcl0udGFyZ2V0RXRoTWF4KTsgICAgICAgCiAgICAgICAgLy8gQWxsIGdvb2QKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCgogICAgLy8gQGRldiBHZW5lcmFsIHZhbGlkYXRpb24gZm9yIGEgc2FsZXMgYWdlbnQgY29udHJhY3QgdGhhdCByZXF1aXJlcyB0aGUgdXNlciBjbGFpbSB0aGUgdG9rZW5zIGFmdGVyIHRoZSBzYWxlIGhhcyBmaW5pc2hlZAogICAgLy8gQHBhcmFtIF9zZW5kZXIgVGhlIGFkZHJlc3Mgc2VudCB0aGUgcmVxdWVzdAogICAgLy8gQHJldHVybiBBIGJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgIGZ1bmN0aW9uIHZhbGlkYXRlQ2xhaW1Ub2tlbnMoYWRkcmVzcyBfc2VuZGVyKSBpc1NhbGVzQ29udHJhY3QobXNnLnNlbmRlcikgcmV0dXJucyAoYm9vbCkgewogICAgICAgIC8vIEdldCBhbiBpbnN0YW5jZSBvZiB0aGUgc2FsZSBhZ2VudCBjb250cmFjdAogICAgICAgIFNhbGVzQWdlbnRJbnRlcmZhY2Ugc2FsZUFnZW50ID0gU2FsZXNBZ2VudEludGVyZmFjZShtc2cuc2VuZGVyKTsKICAgICAgICAvLyBNdXN0IGhhdmUgcHJldmlvdXNseSBjb250cmlidXRlZAogICAgICAgIGFzc2VydChzYWxlQWdlbnQuZ2V0Q29udHJpYnV0aW9uT2YoX3NlbmRlcikgPiAwKTsgCiAgICAgICAgLy8gU2FsZSBjb250cmFjdCBjb21wbGV0ZWQKICAgICAgICBhc3NlcnQoYmxvY2subnVtYmVyID4gc2FsZXNBZ2VudHNbbXNnLnNlbmRlcl0uZW5kQmxvY2spOyAgCiAgICAgICAgLy8gQWxsIGdvb2QKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIAoKICAgIC8vIEBkZXYgTWludCB0aGUgUm9ja2V0IFBvb2wgVG9rZW5zIChSUEwpCiAgICAvLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCByZWNlaXZlIHRoZSBtaW50ZWQgdG9rZW5zLgogICAgLy8gQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gbWludC4KICAgIC8vIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50IF9hbW91bnQpIGlzU2FsZXNDb250cmFjdChtc2cuc2VuZGVyKSByZXR1cm5zIChib29sKSB7CiAgICAgICAgLy8gQ2hlY2sgaWYgd2UncmUgb2sgdG8gbWludCBuZXcgdG9rZW5zLCBoYXZlIHdlIHN0YXJ0ZWQ/CiAgICAgICAgLy8gV2UgZG9udCBjaGVjayBmb3IgdGhlIGVuZCBibG9jayBhcyBzb21lIHNhbGUgYWdlbnRzIG1pbnQgdG9rZW5zIGR1cmluZyB0aGUgc2FsZSwgYW5kIHNvbWUgYWZ0ZXIgaXRzIGZpbmlzaGVkIChwcm9wb3J0aW9uYWwgc2FsZXMpCiAgICAgICAgYXNzZXJ0KGJsb2NrLm51bWJlciA+IHNhbGVzQWdlbnRzW21zZy5zZW5kZXJdLnN0YXJ0QmxvY2spOyAgIAogICAgICAgIC8vIENoZWNrIHRoZSBkZXBvc2l0QWRkcmVzcyBoYXMgYmVlbiB2ZXJpZmllZCBieSB0aGUgZGVzaWduYXRlZCBhY2NvdW50IGhvbGRlciB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgZnVuZHMgZnJvbSB0aGF0IGFnZW50CiAgICAgICAgYXNzZXJ0KHNhbGVzQWdlbnRzW21zZy5zZW5kZXJdLmRlcG9zaXRBZGRyZXNzQ2hlY2tlZEluID09IHRydWUpOwogICAgICAgIC8vIE5vIG1pbnRpbmcgaWYgdGhlIHNhbGUgY29udHJhY3QgaGFzIGZpbmFsaXNlZAogICAgICAgIGFzc2VydChzYWxlc0FnZW50c1ttc2cuc2VuZGVyXS5maW5hbGlzZWQgPT0gZmFsc2UpOwogICAgICAgIC8vIENoZWNrIHdlIGRvbid0IGV4Y2VlZCB0aGUgYXNzaWduZWQgdG9rZW5zIG9mIHRoZSBzYWxlIGFnZW50CiAgICAgICAgYXNzZXJ0KHNhbGVzQWdlbnRzW21zZy5zZW5kZXJdLnRva2Vuc0xpbWl0ID49IHNhbGVzQWdlbnRzW21zZy5zZW5kZXJdLnRva2Vuc01pbnRlZC5hZGQoX2Ftb3VudCkpOwogICAgICAgIC8vIFZlcmlmeSBvayBiYWxhbmNlcyBhbmQgdmFsdWVzCiAgICAgICAgYXNzZXJ0KF9hbW91bnQgPiAwKTsKICAgICAgICAgLy8gQ2hlY2sgd2UgZG9uJ3QgZXhjZWVkIHRoZSBzdXBwbHkgbGltaXQKICAgICAgICBhc3NlcnQodG90YWxTdXBwbHkuYWRkKF9hbW91bnQpIDw9IHRvdGFsU3VwcGx5Q2FwKTsKICAgICAgICAgLy8gT2sgYWxsIGdvb2QsIGF1dG9tYXRpY2FsbHkgY2hlY2tzIGZvciBvdmVyZmxvdyB3aXRoIHNhZmVNYXRoCiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF9hbW91bnQpOwogICAgICAgIC8vIEFkZCB0byB0aGUgdG90YWwgbWludGVkIGZvciB0aGF0IGFnZW50LCBhdXRvbWF0aWNhbGx5IGNoZWNrcyBmb3Igb3ZlcmZsb3cgd2l0aCBzYWZlTWF0aAogICAgICAgIHNhbGVzQWdlbnRzW21zZy5zZW5kZXJdLnRva2Vuc01pbnRlZCA9IHNhbGVzQWdlbnRzW21zZy5zZW5kZXJdLnRva2Vuc01pbnRlZC5hZGQoX2Ftb3VudCk7CiAgICAgICAgLy8gQWRkIHRvIHRoZSBvdmVyYWxsIHRvdGFsIG1pbnRlZCwgYXV0b21hdGljYWxseSBjaGVja3MgZm9yIG92ZXJmbG93IHdpdGggc2FmZU1hdGgKICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfYW1vdW50KTsKICAgICAgICAvLyBGaXJlIHRoZSBldmVudAogICAgICAgIE1pbnRUb2tlbihtc2cuc2VuZGVyLCBfdG8sIF9hbW91bnQpOwogICAgICAgIC8vIEZpcmUgdGhlIHRyYW5zZmVyIGV2ZW50CiAgICAgICAgVHJhbnNmZXIoMHgwLCBfdG8sIF9hbW91bnQpOyAKICAgICAgICAvLyBDb21wbGV0ZWQKICAgICAgICByZXR1cm4gdHJ1ZTsgCiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGNhbiBzdGlsbCBiZSBtaW50ZWQKICAgIGZ1bmN0aW9uIGdldFJlbWFpbmluZ1Rva2VucygpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gdG90YWxTdXBwbHlDYXAuc3ViKHRvdGFsU3VwcGx5KTsKICAgIH0KICAgIAogICAgLy8vIEBkZXYgU2V0IHRoZSBhZGRyZXNzIG9mIGEgbmV3IGNyb3dkc2FsZS9wcmVzYWxlIGNvbnRyYWN0IGFnZW50IGlmIG5lZWRlZCwgdXNlZnVsbCBmb3IgdXBncmFkaW5nCiAgICAvLy8gQHBhcmFtIF9zYWxlQWRkcmVzcyBUaGUgYWRkcmVzcyBvZiB0aGUgbmV3IHRva2VuIHNhbGUgY29udHJhY3QKICAgIC8vLyBAcGFyYW0gX3NhbGVDb250cmFjdFR5cGUgVHlwZSBvZiB0aGUgY29udHJhY3QgaWUuIHByZXNhbGUsIGNyb3dkc2FsZSwgcXVhcnRlcmx5CiAgICAvLy8gQHBhcmFtIF90YXJnZXRFdGhNaW4gVGhlIG1pbiBhbW91bnQgb2YgZXRoZXIgdG8gcmFpc2UgdG8gY29uc2lkZXIgdGhpcyBjb250cmFjdHMgc2FsZXMgYSBzdWNjZXNzCiAgICAvLy8gQHBhcmFtIF90YXJnZXRFdGhNYXggVGhlIG1heCBhbW91bnQgb2YgZXRoZXIgdGhlIGFnZW50IGlzIGFsbG93ZWQgcmFpc2UKICAgIC8vLyBAcGFyYW0gX3Rva2Vuc0xpbWl0IFRoZSBtYXhpbXVtIGFtb3VudCBvZiB0b2tlbnMgdGhpcyBzYWxlIGNvbnRyYWN0IGlzIGFsbG93ZWQgdG8gZGlzdHJpYnV0ZQogICAgLy8vIEBwYXJhbSBfbWluRGVwb3NpdCBUaGUgbWluaW11bSBkZXBvc2l0IGFtb3VudCBhbGxvd2VkCiAgICAvLy8gQHBhcmFtIF9tYXhEZXBvc2l0IFRoZSBtYXhpbXVtIGRlcG9zaXQgYW1vdW50IGFsbG93ZWQKICAgIC8vLyBAcGFyYW0gX3N0YXJ0QmxvY2sgVGhlIHN0YXJ0IGJsb2NrIHdoZW4gYWxsb3dlZCB0byBtaW50IHRva2VucwogICAgLy8vIEBwYXJhbSBfZW5kQmxvY2sgVGhlIGVuZCBibG9jayB3aGVuIHRvIGZpbmlzaCBtaW50aW5nIHRva2VucwogICAgLy8vIEBwYXJhbSBfZGVwb3NpdEFkZHJlc3MgVGhlIGFkZHJlc3MgdGhhdCByZWNlaXZlcyB0aGUgZXRoZXIgZm9yIHRoYXQgc2FsZSBjb250cmFjdAogICAgZnVuY3Rpb24gc2V0U2FsZUFnZW50Q29udHJhY3QoCiAgICAgICAgYWRkcmVzcyBfc2FsZUFkZHJlc3MsIAogICAgICAgICBzdHJpbmcgX3NhbGVDb250cmFjdFR5cGUsIAogICAgICAgIHVpbnQyNTYgX3RhcmdldEV0aE1pbiwgCiAgICAgICAgdWludDI1NiBfdGFyZ2V0RXRoTWF4LCAKICAgICAgICB1aW50MjU2IF90b2tlbnNMaW1pdCwgCiAgICAgICAgdWludDI1NiBfbWluRGVwb3NpdCwKICAgICAgICB1aW50MjU2IF9tYXhEZXBvc2l0LAogICAgICAgIHVpbnQyNTYgX3N0YXJ0QmxvY2ssIAogICAgICAgIHVpbnQyNTYgX2VuZEJsb2NrLCAKICAgICAgICBhZGRyZXNzIF9kZXBvc2l0QWRkcmVzcwogICAgKSAKICAgIC8vIE9ubHkgdGhlIG93bmVyIGNhbiByZWdpc3RlciBhIG5ldyBzYWxlIGFnZW50CiAgICBwdWJsaWMgb25seU93bmVyICAKICAgIHsKICAgICAgICAvLyBWYWxpZCBhZGRyZXNzZXM/CiAgICAgICAgYXNzZXJ0KF9zYWxlQWRkcmVzcyAhPSAweDAgJiYgX2RlcG9zaXRBZGRyZXNzICE9IDB4MCk7ICAKICAgICAgICAvLyBNdXN0IGhhdmUgc29tZSBhdmFpbGFibGUgdG9rZW5zCiAgICAgICAgYXNzZXJ0KF90b2tlbnNMaW1pdCA+IDAgJiYgX3Rva2Vuc0xpbWl0IDw9IHRvdGFsU3VwcGx5Q2FwKTsKICAgICAgICAvLyBNYWtlIHN1cmUgdGhlIG1pbiBkZXBvc2l0IGlzIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgbWF4CiAgICAgICAgYXNzZXJ0KF9taW5EZXBvc2l0IDw9IF9tYXhEZXBvc2l0KTsKICAgICAgICAvLyBBZGQgdGhlIG5ldyBzYWxlcyBjb250cmFjdAogICAgICAgIHNhbGVzQWdlbnRzW19zYWxlQWRkcmVzc10gPSBTYWxlc0FnZW50KHsKICAgICAgICAgICAgc2FsZUNvbnRyYWN0QWRkcmVzczogX3NhbGVBZGRyZXNzLAogICAgICAgICAgICBzYWxlQ29udHJhY3RUeXBlOiBzaGEzKF9zYWxlQ29udHJhY3RUeXBlKSwKICAgICAgICAgICAgdGFyZ2V0RXRoTWluOiBfdGFyZ2V0RXRoTWluLAogICAgICAgICAgICB0YXJnZXRFdGhNYXg6IF90YXJnZXRFdGhNYXgsCiAgICAgICAgICAgIHRva2Vuc0xpbWl0OiBfdG9rZW5zTGltaXQsCiAgICAgICAgICAgIHRva2Vuc01pbnRlZDogMCwKICAgICAgICAgICAgbWluRGVwb3NpdDogX21pbkRlcG9zaXQsCiAgICAgICAgICAgIG1heERlcG9zaXQ6IF9tYXhEZXBvc2l0LAogICAgICAgICAgICBzdGFydEJsb2NrOiBfc3RhcnRCbG9jaywKICAgICAgICAgICAgZW5kQmxvY2s6IF9lbmRCbG9jaywKICAgICAgICAgICAgZGVwb3NpdEFkZHJlc3M6IF9kZXBvc2l0QWRkcmVzcywKICAgICAgICAgICAgZGVwb3NpdEFkZHJlc3NDaGVja2VkSW46IGZhbHNlLAogICAgICAgICAgICBmaW5hbGlzZWQ6IGZhbHNlLAogICAgICAgICAgICBleGlzdHM6IHRydWUgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgfSk7CiAgICAgICAgLy8gU3RvcmUgb3VyIGFnZW50IGFkZHJlc3Mgc28gd2UgY2FuIGl0ZXJhdGUgb3ZlciBpdCBpZiBuZWVkZWQKICAgICAgICBzYWxlc0FnZW50c0FkZHJlc3Nlcy5wdXNoKF9zYWxlQWRkcmVzcyk7CiAgICB9CgoKICAgIC8vLyBAZGV2IFNldHMgdGhlIGNvbnRyYWN0IHNhbGUgYWdlbnQgcHJvY2VzcyBhcyBjb21wbGV0ZWQsIHRoYXQgc2FsZXMgYWdlbnQgaXMgbm93IHJldGlyZWQKICAgIGZ1bmN0aW9uIHNldFNhbGVDb250cmFjdEZpbmFsaXNlZChhZGRyZXNzIF9zZW5kZXIpIGlzU2FsZXNDb250cmFjdChtc2cuc2VuZGVyKSBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgLy8gR2V0IGFuIGluc3RhbmNlIG9mIHRoZSBzYWxlIGFnZW50IGNvbnRyYWN0CiAgICAgICAgU2FsZXNBZ2VudEludGVyZmFjZSBzYWxlQWdlbnQgPSBTYWxlc0FnZW50SW50ZXJmYWNlKG1zZy5zZW5kZXIpOwogICAgICAgIC8vIEZpbmFsaXNlIHRoZSBjcm93ZHNhbGUgZnVuZHMKICAgICAgICBhc3NlcnQoIXNhbGVzQWdlbnRzW21zZy5zZW5kZXJdLmZpbmFsaXNlZCk7ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAvLyBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjZWl2ZSB0aGlzIGNvbnRyYWN0cyBkZXBvc2l0LCBzaG91bGQgbWF0Y2ggdGhlIG9yaWdpbmFsIHNlbmRlcnMKICAgICAgICBhc3NlcnQoc2FsZXNBZ2VudHNbbXNnLnNlbmRlcl0uZGVwb3NpdEFkZHJlc3MgPT0gX3NlbmRlcik7ICAgICAgICAgICAgCiAgICAgICAgLy8gSWYgdGhlIGVuZCBibG9jayBpcyAwLCBpdCBtZWFucyBhbiBvcGVuIGVuZGVkIGNyb3dkc2FsZSwgb25jZSBpdCdzIGZpbmFsaXNlZCwgdGhlIGVuZCBibG9jayBpcyBzZXQgdG8gdGhlIGN1cnJlbnQgb25lCiAgICAgICAgaWYgKHNhbGVzQWdlbnRzW21zZy5zZW5kZXJdLmVuZEJsb2NrID09IDApIHsKICAgICAgICAgICAgc2FsZXNBZ2VudHNbbXNnLnNlbmRlcl0uZW5kQmxvY2sgPSBibG9jay5udW1iZXI7CiAgICAgICAgfQogICAgICAgIC8vIE5vdCB5ZXQgZmluaXNoZWQ/CiAgICAgICAgYXNzZXJ0KGJsb2NrLm51bWJlciA+PSBzYWxlc0FnZW50c1ttc2cuc2VuZGVyXS5lbmRCbG9jayk7ICAgICAgICAgCiAgICAgICAgLy8gTm90IGVub3VnaCByYWlzZWQ/CiAgICAgICAgYXNzZXJ0KHNhbGVBZ2VudC5jb250cmlidXRlZFRvdGFsKCkgPj0gc2FsZXNBZ2VudHNbbXNnLnNlbmRlcl0udGFyZ2V0RXRoTWluKTsKICAgICAgICAvLyBXZSdyZSBkb25lIG5vdwogICAgICAgIHNhbGVzQWdlbnRzW21zZy5zZW5kZXJdLmZpbmFsaXNlZCA9IHRydWU7CiAgICAgICAgLy8gRmlyZSB0aGUgZXZlbnQKICAgICAgICBTYWxlRmluYWxpc2VkKG1zZy5zZW5kZXIsIF9zZW5kZXIsIHNhbGVzQWdlbnRzW21zZy5zZW5kZXJdLnRva2Vuc01pbnRlZCk7CiAgICAgICAgLy8gQWxsIGdvb2QKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCgogICAgLy8vIEBkZXYgVmVyaWZpZXMgaWYgdGhlIGN1cnJlbnQgYWRkcmVzcyBtYXRjaGVzIHRoZSBkZXBvc2l0QWRkcmVzcwogICAgLy8vIEBwYXJhbSBfdmVyaWZ5QWRkcmVzcyBUaGUgYWRkcmVzcyB0byB2ZXJpZnkgaXQgbWF0Y2hlcyB0aGUgZGVwb3NpdEFkZHJlc3MgZ2l2ZW4gZm9yIHRoZSBzYWxlcyBhZ2VudAogICAgZnVuY3Rpb24gc2V0U2FsZUNvbnRyYWN0RGVwb3NpdEFkZHJlc3NWZXJpZmllZChhZGRyZXNzIF92ZXJpZnlBZGRyZXNzKSBpc1NhbGVzQ29udHJhY3QobXNnLnNlbmRlcikgcHVibGljIHsKICAgICAgICAvLyBDaGVjayBpdHMgdmVyaWZpZWQKICAgICAgICBhc3NlcnQoc2FsZXNBZ2VudHNbbXNnLnNlbmRlcl0uZGVwb3NpdEFkZHJlc3MgPT0gX3ZlcmlmeUFkZHJlc3MgJiYgX3ZlcmlmeUFkZHJlc3MgIT0gMHgwKTsKICAgICAgICAvLyBPayBzZXQgaXQgbm93CiAgICAgICAgc2FsZXNBZ2VudHNbbXNnLnNlbmRlcl0uZGVwb3NpdEFkZHJlc3NDaGVja2VkSW4gPSB0cnVlOwogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgdHJ1ZSBpZiB0aGlzIHNhbGVzIGNvbnRyYWN0IGhhcyBmaW5hbGlzZWQKICAgIC8vLyBAcGFyYW0gX3NhbGVzQWdlbnRBZGRyZXNzIFRoZSBhZGRyZXNzIG9mIHRoZSB0b2tlbiBzYWxlIGFnZW50IGNvbnRyYWN0CiAgICBmdW5jdGlvbiBnZXRTYWxlQ29udHJhY3RJc0ZpbmFsaXNlZChhZGRyZXNzIF9zYWxlc0FnZW50QWRkcmVzcykgY29uc3RhbnQgaXNTYWxlc0NvbnRyYWN0KF9zYWxlc0FnZW50QWRkcmVzcykgcHVibGljIHJldHVybnMoYm9vbCkgewogICAgICAgIHJldHVybiBzYWxlc0FnZW50c1tfc2FsZXNBZ2VudEFkZHJlc3NdLmZpbmFsaXNlZDsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIHRoZSBtaW4gdGFyZ2V0IGFtb3VudCBvZiBldGhlciB0aGUgY29udHJhY3Qgd2FudHMgdG8gcmFpc2UKICAgIC8vLyBAcGFyYW0gX3NhbGVzQWdlbnRBZGRyZXNzIFRoZSBhZGRyZXNzIG9mIHRoZSB0b2tlbiBzYWxlIGFnZW50IGNvbnRyYWN0CiAgICBmdW5jdGlvbiBnZXRTYWxlQ29udHJhY3RUYXJnZXRFdGhlck1pbihhZGRyZXNzIF9zYWxlc0FnZW50QWRkcmVzcykgY29uc3RhbnQgaXNTYWxlc0NvbnRyYWN0KF9zYWxlc0FnZW50QWRkcmVzcykgcHVibGljIHJldHVybnModWludDI1NikgewogICAgICAgIHJldHVybiBzYWxlc0FnZW50c1tfc2FsZXNBZ2VudEFkZHJlc3NdLnRhcmdldEV0aE1pbjsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIHRoZSBtYXggdGFyZ2V0IGFtb3VudCBvZiBldGhlciB0aGUgY29udHJhY3QgY2FuIHJhaXNlCiAgICAvLy8gQHBhcmFtIF9zYWxlc0FnZW50QWRkcmVzcyBUaGUgYWRkcmVzcyBvZiB0aGUgdG9rZW4gc2FsZSBhZ2VudCBjb250cmFjdAogICAgZnVuY3Rpb24gZ2V0U2FsZUNvbnRyYWN0VGFyZ2V0RXRoZXJNYXgoYWRkcmVzcyBfc2FsZXNBZ2VudEFkZHJlc3MpIGNvbnN0YW50IGlzU2FsZXNDb250cmFjdChfc2FsZXNBZ2VudEFkZHJlc3MpIHB1YmxpYyByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gc2FsZXNBZ2VudHNbX3NhbGVzQWdlbnRBZGRyZXNzXS50YXJnZXRFdGhNYXg7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyB0aGUgbWluIGRlcG9zaXQgYW1vdW50IG9mIGV0aGVyCiAgICAvLy8gQHBhcmFtIF9zYWxlc0FnZW50QWRkcmVzcyBUaGUgYWRkcmVzcyBvZiB0aGUgdG9rZW4gc2FsZSBhZ2VudCBjb250cmFjdAogICAgZnVuY3Rpb24gZ2V0U2FsZUNvbnRyYWN0RGVwb3NpdEV0aGVyTWluKGFkZHJlc3MgX3NhbGVzQWdlbnRBZGRyZXNzKSBjb25zdGFudCBpc1NhbGVzQ29udHJhY3QoX3NhbGVzQWdlbnRBZGRyZXNzKSBwdWJsaWMgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHNhbGVzQWdlbnRzW19zYWxlc0FnZW50QWRkcmVzc10ubWluRGVwb3NpdDsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIHRoZSBtYXggZGVwb3NpdCBhbW91bnQgb2YgZXRoZXIKICAgIC8vLyBAcGFyYW0gX3NhbGVzQWdlbnRBZGRyZXNzIFRoZSBhZGRyZXNzIG9mIHRoZSB0b2tlbiBzYWxlIGFnZW50IGNvbnRyYWN0CiAgICBmdW5jdGlvbiBnZXRTYWxlQ29udHJhY3REZXBvc2l0RXRoZXJNYXgoYWRkcmVzcyBfc2FsZXNBZ2VudEFkZHJlc3MpIGNvbnN0YW50IGlzU2FsZXNDb250cmFjdChfc2FsZXNBZ2VudEFkZHJlc3MpIHB1YmxpYyByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gc2FsZXNBZ2VudHNbX3NhbGVzQWdlbnRBZGRyZXNzXS5tYXhEZXBvc2l0OwogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgdGhlIGFkZHJlc3Mgd2hlcmUgdGhlIHNhbGUgY29udHJhY3RzIGV0aGVyIHdpbGwgYmUgZGVwb3NpdGVkCiAgICAvLy8gQHBhcmFtIF9zYWxlc0FnZW50QWRkcmVzcyBUaGUgYWRkcmVzcyBvZiB0aGUgdG9rZW4gc2FsZSBhZ2VudCBjb250cmFjdAogICAgZnVuY3Rpb24gZ2V0U2FsZUNvbnRyYWN0RGVwb3NpdEFkZHJlc3MoYWRkcmVzcyBfc2FsZXNBZ2VudEFkZHJlc3MpIGNvbnN0YW50IGlzU2FsZXNDb250cmFjdChfc2FsZXNBZ2VudEFkZHJlc3MpIHB1YmxpYyByZXR1cm5zKGFkZHJlc3MpIHsKICAgICAgICByZXR1cm4gc2FsZXNBZ2VudHNbX3NhbGVzQWdlbnRBZGRyZXNzXS5kZXBvc2l0QWRkcmVzczsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIHRoZSB0cnVlIGlmIHRoZSBzYWxlIGFnZW50cyBkZXBvc2l0IGFkZHJlc3MgaGFzIGJlZW4gdmVyaWZpZWQKICAgIC8vLyBAcGFyYW0gX3NhbGVzQWdlbnRBZGRyZXNzIFRoZSBhZGRyZXNzIG9mIHRoZSB0b2tlbiBzYWxlIGFnZW50IGNvbnRyYWN0CiAgICBmdW5jdGlvbiBnZXRTYWxlQ29udHJhY3REZXBvc2l0QWRkcmVzc1ZlcmlmaWVkKGFkZHJlc3MgX3NhbGVzQWdlbnRBZGRyZXNzKSBjb25zdGFudCBpc1NhbGVzQ29udHJhY3QoX3NhbGVzQWdlbnRBZGRyZXNzKSBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmV0dXJuIHNhbGVzQWdlbnRzW19zYWxlc0FnZW50QWRkcmVzc10uZGVwb3NpdEFkZHJlc3NDaGVja2VkSW47CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyB0aGUgc3RhcnQgYmxvY2sgZm9yIHRoZSBzYWxlIGFnZW50CiAgICAvLy8gQHBhcmFtIF9zYWxlc0FnZW50QWRkcmVzcyBUaGUgYWRkcmVzcyBvZiB0aGUgdG9rZW4gc2FsZSBhZ2VudCBjb250cmFjdAogICAgZnVuY3Rpb24gZ2V0U2FsZUNvbnRyYWN0U3RhcnRCbG9jayhhZGRyZXNzIF9zYWxlc0FnZW50QWRkcmVzcykgY29uc3RhbnQgaXNTYWxlc0NvbnRyYWN0KF9zYWxlc0FnZW50QWRkcmVzcykgcHVibGljIHJldHVybnModWludDI1NikgewogICAgICAgIHJldHVybiBzYWxlc0FnZW50c1tfc2FsZXNBZ2VudEFkZHJlc3NdLnN0YXJ0QmxvY2s7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyB0aGUgc3RhcnQgYmxvY2sgZm9yIHRoZSBzYWxlIGFnZW50CiAgICAvLy8gQHBhcmFtIF9zYWxlc0FnZW50QWRkcmVzcyBUaGUgYWRkcmVzcyBvZiB0aGUgdG9rZW4gc2FsZSBhZ2VudCBjb250cmFjdAogICAgZnVuY3Rpb24gZ2V0U2FsZUNvbnRyYWN0RW5kQmxvY2soYWRkcmVzcyBfc2FsZXNBZ2VudEFkZHJlc3MpIGNvbnN0YW50IGlzU2FsZXNDb250cmFjdChfc2FsZXNBZ2VudEFkZHJlc3MpIHB1YmxpYyByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gc2FsZXNBZ2VudHNbX3NhbGVzQWdlbnRBZGRyZXNzXS5lbmRCbG9jazsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIHRoZSBtYXggdG9rZW5zIGZvciB0aGUgc2FsZSBhZ2VudAogICAgLy8vIEBwYXJhbSBfc2FsZXNBZ2VudEFkZHJlc3MgVGhlIGFkZHJlc3Mgb2YgdGhlIHRva2VuIHNhbGUgYWdlbnQgY29udHJhY3QKICAgIGZ1bmN0aW9uIGdldFNhbGVDb250cmFjdFRva2Vuc0xpbWl0KGFkZHJlc3MgX3NhbGVzQWdlbnRBZGRyZXNzKSBjb25zdGFudCBpc1NhbGVzQ29udHJhY3QoX3NhbGVzQWdlbnRBZGRyZXNzKSBwdWJsaWMgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHNhbGVzQWdlbnRzW19zYWxlc0FnZW50QWRkcmVzc10udG9rZW5zTGltaXQ7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyB0aGUgdG9rZW4gdG90YWwgY3VycmVudGx5IG1pbnRlZCBieSB0aGUgc2FsZSBhZ2VudAogICAgLy8vIEBwYXJhbSBfc2FsZXNBZ2VudEFkZHJlc3MgVGhlIGFkZHJlc3Mgb2YgdGhlIHRva2VuIHNhbGUgYWdlbnQgY29udHJhY3QKICAgIGZ1bmN0aW9uIGdldFNhbGVDb250cmFjdFRva2Vuc01pbnRlZChhZGRyZXNzIF9zYWxlc0FnZW50QWRkcmVzcykgY29uc3RhbnQgaXNTYWxlc0NvbnRyYWN0KF9zYWxlc0FnZW50QWRkcmVzcykgcHVibGljIHJldHVybnModWludDI1NikgewogICAgICAgIHJldHVybiBzYWxlc0FnZW50c1tfc2FsZXNBZ2VudEFkZHJlc3NdLnRva2Vuc01pbnRlZDsKICAgIH0KCiAgICAKfQ=='.
	

]
