Class {
	#name : #SRTff030dca3c6d546328945b6c1bcdb4f5ba2b22da,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTff030dca3c6d546328945b6c1bcdb4f5ba2b22da >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7CgovKioKICogQ29udHJhY3QgIk1hdGgiCiAqIFB1cnBvc2U6IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MKICovCmxpYnJhcnkgTWF0aCB7CgogICAgLyoqCiAgICAqIE11bHRpcGxpY2F0aW9uIHdpdGggc2FmZXR5IGNoZWNrCiAgICAqLwogICAgZnVuY3Rpb24gTXVsKHVpbnQgYSwgdWludCBiKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICAgIHVpbnQgYyA9IGEgKiBiOwogICAgICAvL2NoZWNrIHJlc3VsdCBzaG91bGQgbm90IGJlIG90aGVyIHdpc2UgdW50aWwgYT0wCiAgICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICAgIHJldHVybiBjOwogICAgfQoKICAgIC8qKgogICAgKiBEaXZpc2lvbiB3aXRoIHNhZmV0eSBjaGVjawogICAgKi8KICAgIGZ1bmN0aW9uIERpdih1aW50IGEsIHVpbnQgYikgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgICAvL292ZXJmbG93IGNoZWNrOyBiIG11c3Qgbm90IGJlIDAKICAgICAgYXNzZXJ0KGIgPiAwKTsKICAgICAgdWludCBjID0gYSAvIGI7CiAgICAgIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOwogICAgICByZXR1cm4gYzsKICAgIH0KCiAgICAvKioKICAgICogU3VidHJhY3Rpb24gd2l0aCBzYWZldHkgY2hlY2sKICAgICovCiAgICBmdW5jdGlvbiBTdWIodWludCBhLCB1aW50IGIpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQpIHsKICAgICAgLy9iIG11c3QgYmUgZ3JlYXRlciB0aGF0IGEgYXMgd2UgbmVlZCB0byBzdG9yZSB2YWx1ZSBpbiB1bnNpZ25lZCBpbnRlZ2VyCiAgICAgIGFzc2VydChiIDw9IGEpOwogICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgLyoqCiAgICAqIEFkZGl0aW9uIHdpdGggc2FmZXR5IGNoZWNrCiAgICAqLwogICAgZnVuY3Rpb24gQWRkKHVpbnQgYSwgdWludCBiKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICAgIHVpbnQgYyA9IGEgKyBiOwogICAgICAvL3Jlc3VsdCBtdXN0IGJlIGdyZWF0ZXIgYXMgYSBvciBiIGNhbiBub3QgYmUgbmVnYXRpdmUKICAgICAgYXNzZXJ0KGM+PWEgJiYgYz49Yik7CiAgICAgIHJldHVybiBjOwogICAgfQp9CgovKioKICogQ29udHJhY3QgIkVSQzIwQmFzaWMiCiAqIFB1cnBvc2U6IERlZmluaW5nIEVSQzIwIHN0YW5kYXJkIHdpdGggYmFzaWMgZnVuY3Rpb25hbGl0eSBsaWtlIC0gQ2hlY2tCYWxhbmNlIGFuZCBUcmFuc2ZlciBpbmNsdWRpbmcgVHJhbnNmZXIgZXZlbnQKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIAogIC8vR2l2ZSByZWFsdGltZSB0b3RhbFN1cHBseSBvZiBFWEggdG9rZW4KICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgLy9HZXQgRVhIIHRva2VuIGJhbGFuY2UgZm9yIHByb3ZpZGVkIGFkZHJlc3MgaW4gbG93ZXN0IGRlbm9taW5hdGlvbgogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQpOwoKICAvL1RyYW5zZmVyIEVYSCB0b2tlbiB0byBwcm92aWRlZCBhZGRyZXNzCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sIG9rKTsKCiAgLy9FbWl0IFRyYW5zZmVyIGV2ZW50IG91dHNpZGUgb2YgYmxvY2tjaGFpbiBmb3IgZXZlcnkgRVhIIHRva2VuIHRyYW5zZmVycwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludCBfdmFsdWUpOwp9CgovKioKICogQ29udHJhY3QgIkVSQzIwIgogKiBQdXJwb3NlOiBEZWZpbmluZyBFUkMyMCBzdGFuZGFyZCB3aXRoIG1vcmUgYWR2YW5jZWQgZnVuY3Rpb25hbGl0eSBsaWtlIC0gQXV0aG9yaXplIHNwZW5kZXIgdG8gdHJhbnNmZXIgRVhIIHRva2VuCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKCiAgLy9HZXQgRVhIIHRva2VuIGFtb3VudCB0aGF0IHNwZW5kZXIgY2FuIHNwZW5kIGZyb20gcHJvdmlkZWQgb3duZXIncyBhY2NvdW50IAogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KTsKCiAgLy9UcmFuc2ZlciBpbml0aWF0ZWQgYnkgc3BlbmRlciAKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sIG9rKTsKCiAgLy9BZGQgc3BlbmRlciB0byBhdXRocml6ZSBmb3Igc3BlbmRpbmcgc3BlY2lmaWVkIGFtb3VudCBvZiBFWEggVG9rZW4KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sIG9rKTsKCiAgLy9FbWl0IGV2ZW50IGZvciBhbnkgYXBwcm92YWwgcHJvdmlkZWQgdG8gc3BlbmRlcgogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOwp9CgoKLyoqCiAqIENvbnRyYWN0ICJPd25hYmxlIgogKiBQdXJwb3NlOiBEZWZpbmVzIE93bmVyIGZvciBjb250cmFjdCBhbmQgcHJvdmlkZSBmdW5jdGlvbmFsaXR5IHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0byBhbm90aGVyIGFjY291bnQKICovCmNvbnRyYWN0IE93bmFibGUgewoKICAvL293bmVyIHZhcmlhYmxlIHRvIHN0b3JlIGNvbnRyYWN0IG93bmVyIGFjY291bnQKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgLy9Db25zdHJ1Y3RvciBmb3IgdGhlIGNvbnRyYWN0IHRvIHN0b3JlIG93bmVyJ3MgYWNjb3VudCBvbiBkZXBsb3llbWVudAogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KICAKICAvL21vZGlmaWVyIHRvIGNoZWNrIHRyYW5zYWN0aW9uIGluaXRpYXRvciBpcyBvbmx5IG93bmVyCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgaWYgKG1zZy5zZW5kZXIgPT0gb3duZXIpCiAgICAgIF87CiAgfQoKICAvL293bmVyc2hpcCBjYW4gYmUgdHJhbnNmZXJyZWQgdG8gcHJvdmlkZWQgbmV3T3duZXIuIEZ1bmN0aW9uIGNhbiBvbmx5IGJlIGluaXRpYXRlZCBieSBjb250cmFjdCBvd25lcidzIGFjY291bnQKICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIGlmIChuZXdPd25lciAhPSBhZGRyZXNzKDApKSAKICAgICAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCi8qKgogKiBDb250cmFjdCAiUGF1c2FibGUiCiAqIFB1cnBvc2U6IENvbnRyYWN0IHRvIHByb3ZpZGUgZnVuY3Rpb25hbGl0eSB0byBwYXVzZSBhbmQgcmVzdW1lIFNhbGUgaW4gY2FzZSBvZiBlbWVyZ2VuY3kKICovCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgewoKICAvL2ZsYWcgdG8gaW5kaWNhdGUgd2hldGhlciBTYWxlIGlzIHBhdXNlZCBvciBub3QKICBib29sIHB1YmxpYyBzdG9wcGVkOwoKICAvL0VtaXQgZXZlbnQgd2hlbiBhbnkgY2hhbmdlIGhhcHBlbnMgaW4gY3Jvd2RzYWxlIHN0YXRlCiAgZXZlbnQgU3RhdGVDaGFuZ2VkKGJvb2wgY2hhbmdlZCk7CgogIC8vbW9kaWZpZXIgdG8gY29udGludWUgd2l0aCB0cmFuc2FjdGlvbiBvbmx5IHdoZW4gU2FsZSBpcyBub3QgcGF1c2VkCiAgbW9kaWZpZXIgc3RvcEluRW1lcmdlbmN5IHsKICAgIHJlcXVpcmUoIXN0b3BwZWQpOwogICAgXzsKICB9CgogIC8vbW9kaWZpZXIgdG8gY29udGludWUgd2l0aCB0cmFuc2FjdGlvbiBvbmx5IHdoZW4gU2FsZSBpcyBwYXVzZWQKICBtb2RpZmllciBvbmx5SW5FbWVyZ2VuY3kgewogICAgcmVxdWlyZShzdG9wcGVkKTsKICAgIF87CiAgfQoKICAvLyBjYWxsZWQgYnkgdGhlIG93bmVyIG9uIGVtZXJnZW5jeSwgcGF1c2UgU2FsZQogIGZ1bmN0aW9uIGVtZXJnZW5jeVN0b3AoKSBleHRlcm5hbCBvbmx5T3duZXIgIHsKICAgIHN0b3BwZWQgPSB0cnVlOwogICAgLy9FbWl0IGV2ZW50IHdoZW4gY3Jvd2RzYWxlIHN0YXRlIGNoYW5nZXMKICAgIFN0YXRlQ2hhbmdlZCh0cnVlKTsKICB9CgogIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW5kIG9mIGVtZXJnZW5jeSwgcmVzdW1lcyBTYWxlCiAgZnVuY3Rpb24gcmVsZWFzZSgpIGV4dGVybmFsIG9ubHlPd25lciBvbmx5SW5FbWVyZ2VuY3kgewogICAgc3RvcHBlZCA9IGZhbHNlOwogICAgLy9FbWl0IGV2ZW50IHdoZW4gY3Jvd2RzYWxlIHN0YXRlIGNoYW5nZXMKICAgIFN0YXRlQ2hhbmdlZCh0cnVlKTsKICB9Cgp9CgovKioKICogQ29udHJhY3QgIkVYSCIKICogUHVycG9zZTogQ3JlYXRlIEVYSCB0b2tlbgogKi8KY29udHJhY3QgRVhIIGlzIEVSQzIwLCBPd25hYmxlIHsKCiAgdXNpbmcgTWF0aCBmb3IgdWludDsKCiAgLyogUHVibGljIHZhcmlhYmxlcyBvZiB0aGUgdG9rZW4gKi8KICAvL1RvIHN0b3JlIG5hbWUgZm9yIHRva2VuCiAgc3RyaW5nIHB1YmxpYyBuYW1lOwoKICAvL1RvIHN0b3JlIHN5bWJvbCBmb3IgdG9rZW4gICAgICAgCiAgc3RyaW5nIHB1YmxpYyBzeW1ib2w7CgogIC8vVG8gc3RvcmUgZGVjaW1hbCBwbGFjZXMgZm9yIHRva2VuCiAgdWludDggcHVibGljIGRlY2ltYWxzOyAgICAKCiAgLy9UbyBzdG9yZSBkZWNpbWFsIHZlcnNpb24gZm9yIHRva2VuCiAgc3RyaW5nIHB1YmxpYyB2ZXJzaW9uID0gJ3YxLjAnOyAKCiAgLy9UbyBzdG9yZSBjdXJyZW50IHN1cHBseSBvZiBFWEggVG9rZW4KICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgLy9mbGFnIHRvIGluZGljYXRlIHdoZXRoZXIgdHJhbnNmZXIgb2YgRVhIIFRva2VuIGlzIGFsbG93ZWQgb3Igbm90CiAgYm9vbCBwdWJsaWMgbG9ja2VkOwoKICAvL21hcCB0byBzdG9yZSBFWEggVG9rZW4gYmFsYW5jZSBjb3JyZXNwb25kaW5nIHRvIGFkZHJlc3MKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgYmFsYW5jZXM7CgogIC8vVG8gc3RvcmUgc3BlbmRlciB3aXRoIGFsbG93ZWQgYW1vdW50IG9mIEVYSCBUb2tlbiB0byBzcGVuZCBjb3JyZXNwb25kaW5nIHRvIEVYSCBUb2tlbiBob2xkZXIncyBhY2NvdW50CiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpKSBhbGxvd2VkOwoKICAvL1RvIGhhbmRsZSBFUkMyMCBzaG9ydCBhZGRyZXNzIGF0dGFjayAgCiAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgc2l6ZSkgewogICAgIHJlcXVpcmUobXNnLmRhdGEubGVuZ3RoID49IHNpemUgKyA0KTsKICAgICBfOwogIH0KICAKICAvLyBMb2NrIHRyYW5zZmVyIGR1cmluZyBTYWxlCiAgbW9kaWZpZXIgb25seVVubG9ja2VkKCkgewogICAgcmVxdWlyZSghbG9ja2VkIHx8IG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgogIC8vQ29udHJ1Y3RvciB0byBkZWZpbmUgRVhIIFRva2VuIHRva2VuIHByb3BlcnRpZXMKICBmdW5jdGlvbiBFWEgoKSBwdWJsaWMgewoKICAgIC8vIGxvY2sgdGhlIHRyYW5zZmVyIGZ1bmN0aW9uIGR1cmluZyBTYWxlCiAgICBsb2NrZWQgPSB0cnVlOwoKICAgIC8vaW5pdGlhbCB0b2tlbiBzdXBwbHkgaXMgMAogICAgdG90YWxTdXBwbHkgPSAwOwoKICAgIC8vTmFtZSBmb3IgdG9rZW4gc2V0IHRvIEVYSCBUb2tlbgogICAgbmFtZSA9ICdFWEggVG9rZW4nOwoKICAgIC8vIFN5bWJvbCBmb3IgdG9rZW4gc2V0IHRvICdFWEgnCiAgICBzeW1ib2wgPSAnRVhIJzsKIAogICAgZGVjaW1hbHMgPSAxODsKICB9CiAKICAvL0ltcGxlbWVudGF0aW9uIGZvciB0cmFuc2ZlcnJpbmcgRVhIIFRva2VuIHRvIHByb3ZpZGVkIGFkZHJlc3MgCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSBwdWJsaWMgb25seVVubG9ja2VkIHJldHVybnMgKGJvb2wpewoKICAgIC8vQ2hlY2sgcHJvdmlkZWQgRVhIIFRva2VuIHNob3VsZCBub3QgYmUgMAogICAgaWYgKF92YWx1ZSA+IDAgJiYgIShfdG8gPT0gYWRkcmVzcygwKSkpIHsKICAgICAgLy9kZWR1Y3QgRVhIIFRva2VuIGFtb3VudCBmcm9tIHRyYW5zYWN0aW9uIGluaXRpYXRvcgogICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLlN1YihfdmFsdWUpOwogICAgICAvL0FkZCBFWEggVG9rZW4gdG8gYmFsYWNlIG9mIHRhcmdldCBhY2NvdW50CiAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLkFkZChfdmFsdWUpOwogICAgICAvL0VtaXQgZXZlbnQgZm9yIHRyYW5zZmVycmluZyBFWEggVG9rZW4KICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIGVsc2V7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9CgogIC8vVHJhbnNmZXIgaW5pdGlhdGVkIGJ5IHNwZW5kZXIgCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDMgKiAzMikgcHVibGljIG9ubHlVbmxvY2tlZCByZXR1cm5zIChib29sKSB7CgogICAgLy9DaGVjayBwcm92aWRlZCBFWEggVG9rZW4gc2hvdWxkIG5vdCBiZSAwCiAgICBpZiAoX3ZhbHVlID4gMCAmJiAoX3RvICE9IGFkZHJlc3MoMCkgJiYgX2Zyb20gIT0gYWRkcmVzcygwKSkpIHsKICAgICAgLy9HZXQgYW1vdW50IG9mIEVYSCBUb2tlbiBmb3Igd2hpY2ggc3BlbmRlciBpcyBhdXRob3JpemVkCiAgICAgIHZhciBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07CiAgICAgIC8vQWRkIGFtb3VudCBvZiBFWEggVG9rZW4gaW4gdHJhcmdldCBhY2NvdW50J3MgYmFsYW5jZQogICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5BZGQoIF92YWx1ZSk7CiAgICAgIC8vRGVkdWN0IEVYSCBUb2tlbiBhbW91bnQgZnJvbSBfZnJvbSBhY2NvdW50CiAgICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5TdWIoIF92YWx1ZSk7CiAgICAgIC8vRGVkdWN0IEF1dGhvcml6ZWQgYW1vdW50IGZvciBzcGVuZGVyCiAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5TdWIoIF92YWx1ZSk7CiAgICAgIC8vRW1pdCBldmVudCBmb3IgVHJhbnNmZXIKICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9ZWxzZXsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0KCiAgLy9HZXQgRVhIIFRva2VuIGJhbGFuY2UgZm9yIHByb3ZpZGVkIGFkZHJlc3MKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KICAKICAvL0FkZCBzcGVuZGVyIHRvIGF1dGhvcml6ZSBmb3Igc3BlbmRpbmcgc3BlY2lmaWVkIGFtb3VudCBvZiBFWEggVG9rZW4gCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3NwZW5kZXIgIT0gYWRkcmVzcygwKSk7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIC8vRW1pdCBldmVudCBmb3IgYXBwcm92YWwgcHJvdmlkZWQgdG8gc3BlbmRlcgogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8vR2V0IEVYSCBUb2tlbiBhbW91bnQgdGhhdCBzcGVuZGVyIGNhbiBzcGVuZCBmcm9tIHByb3ZpZGVkIG93bmVyJ3MgYWNjb3VudCAKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50IHJlbWFpbmluZykgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQogIAp9CgovKioKICogQ29udHJhY3QgIkNyb3dkc2FsZSIKICogUHVycG9zZTogQ29udHJhY3QgZm9yIGNyb3dkc2FsZSBvZiBFWEggVG9rZW4KICovCmNvbnRyYWN0IENyb3dkc2FsZSBpcyBFWEgsIFBhdXNhYmxlIHsKCiAgdXNpbmcgTWF0aCBmb3IgdWludDsKICAKICAvKiBQdWJsaWMgdmFyaWFibGVzIGZvciBTYWxlICovCgogIC8vIFNhbGUgc3RhcnQgYmxvY2sKICB1aW50IHB1YmxpYyBzdGFydEJsb2NrOyAgIAoKICAvLyBTYWxlIGVuZCBibG9jayAgCiAgdWludCBwdWJsaWMgZW5kQmxvY2s7ICAKCiAgLy8gVG8gc3RvcmUgbWF4aW11bSBudW1iZXIgb2YgRVhIIFRva2VuIHRvIHNlbGwKICB1aW50IHB1YmxpYyBtYXhDYXA7ICAgCgogIC8vIFRvIHN0b3JlIG1heGltdW0gbnVtYmVyIG9mIEVYSCBUb2tlbiB0byBzZWxsIGluIFByZVNhbGUKICB1aW50IHB1YmxpYyBtYXhDYXBQcmVTYWxlOyAgIAoKICAvLyBUbyBzdG9yZSB0b3RhbCBudW1iZXIgb2YgRVRIIHJlY2VpdmVkCiAgdWludCBwdWJsaWMgRVRIUmVjZWl2ZWQ7ICAgIAoKICAvLyBOdW1iZXIgb2YgdG9rZW5zIHRoYXQgY2FuIGJlIHB1cmNoYXNlZCB3aXRoIDEgRXRoZXIKICB1aW50IHB1YmxpYyBQUklDRTsgICAKCiAgLy8gVG8gaW5kaWNhdGUgU2FsZSBzdGF0dXM7IGNyb3dkc2FsZVN0YXR1cz0wID0+IGNyb3dkc2FsZSBub3Qgc3RhcnRlZDsgY3Jvd2RzYWxlU3RhdHVzPTE9PiBjcm93ZHNhbGUgc3RhcnRlZDsgY3Jvd2RzYWxlU3RhdHVzPTI9PiBjcm93ZHNhbGUgZmluaXNoZWQKICB1aW50IHB1YmxpYyBjcm93ZHNhbGVTdGF0dXM7IAoKICAvLyBUbyBzdG9yZSBjcm93ZFNhbGUgdHlwZTsgY3Jvd2RTYWxlVHlwZT0wID0+IFByZVNhbGU7IGNyb3dkU2FsZVR5cGU9MSA9PiBDcm93ZFNhbGUKICB1aW50IHB1YmxpYyBjcm93ZFNhbGVUeXBlOyAKCiAgLy9Ub3RhbCBTdXBwbHkgaW4gUHJlU2FsZQogIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5UHJlU2FsZTsgCgogIC8vTm8gb2YgZGF5cyBmb3Igd2hpY2ggcHJlc2FsZSB3aWxsIGJlIG9wZW4KICB1aW50IHB1YmxpYyBkdXJhdGlvblByZVNhbGU7CgogIC8vVmFsdWUgb2YgMSBldGhlciwgaWUsIDEgZm9sbG93ZWQgYnkgMTggemVybwogIHVpbnQgdmFsdWVPbmVFdGhlciA9IDFlMTg7CgogIC8vTm8gb2YgZGF5cyBmb3Igd2hpY2ggdGhlIGNvbXBsZXRlIGNyb3dkc2FsZSB3aWxsIHJ1bi0gcHJlc2FsZSAgKyBjcm93ZHNhbGUKICB1aW50IHB1YmxpYyBkdXJhdGlvbkNyb3dkU2FsZTsKCiAgLy9TdG9yZSB0b3RhbCBudW1iZXIgb2YgaW52ZXN0b3JzCiAgdWludCBwdWJsaWMgY291bnRUb3RhbEludmVzdG9yczsKCiAgLy9OdW1iZXIgb2YgaW52ZXN0b3JzIHdobyBoYXZlIHJlY2VpdmVkIHJlZnVuZAogIHVpbnQgcHVibGljIGNvdW50SW52ZXN0b3JzUmVmdW5kZWQ7CiAgCiAgLy9TZXQgc3RhdHVzIG9mIHJlZnVuZAogIHVpbnQgcHVibGljIHJlZnVuZFN0YXR1czsKCiAvL21heENBcCBmb3IgbWludCBhbmQgdHJhbnNmZXIKICB1aW50IHB1YmxpYyBtYXhDYXBNaW50VHJhbnNmZXIgOwoKICAvL3RvdGFsIHN1cHBseSBmb3IgbWludCBhbmQgdHJhbnNmZXIKICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseU1pbnRUcmFuc2ZlcjsKCiAgLy90b3RhbCB0b2tlbnMgc29sZCBpbiBjcm93ZHNhbGUKICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseUNyb3dkc2FsZTsKCiAgLy9TdG9yZXMgdG90YWwgaW52ZXN0cm9zIGluIGNyb3dkc2FsZQogIHVpbnQyNTYgcHVibGljIGNvdW50VG90YWxJbnZlc3RvcnNJbkNyb3dkc2FsZTsKCiAgdWludDI1NiBwdWJsaWMgY291bnRJbnZlc3RvcnNSZWZ1bmRlZEluQ3Jvd2RzYWxlOwoKICAvL1N0cnVjdHVyZSBmb3IgaW52ZXN0b3JzOyBob2xkcyByZWNlaXZlZCB3ZWkgYW1vdW50IGFuZCBFWEggVG9rZW4gc2VudAogIHN0cnVjdCBJbnZlc3RvciB7CiAgICAvL3dlaSByZWNlaXZlZCBkdXJpbmcgUHJlU2FsZQogICAgdWludCB3ZWlSZWNlaXZlZENyb3dkc2FsZVR5cGUwOwogICAgLy93ZWkgcmVjZWl2ZWQgZHVyaW5nIENyb3dkU2FsZQogICAgdWludCB3ZWlSZWNlaXZlZENyb3dkc2FsZVR5cGUxOwogICAgLy9Ub2tlbnMgc2VudCBkdXJpbmcgUHJlU2FsZQogICAgdWludCBleGhTZW50Q3Jvd2RzYWxlVHlwZTA7CiAgICAvL1Rva2VucyBzZW50IGR1cmluZyBDcm93ZFNhbGUKICAgIHVpbnQgZXhoU2VudENyb3dkc2FsZVR5cGUxOwogICAgLy9VbmlxdWVseSBpZGVudGlmeSBhbiBpbnZlc3Rvcih1c2VkIGZvciBpdGVyYXRpbmcpCiAgICB1aW50IGludmVzdG9ySUQ7CiAgfQoKICAvL2ludmVzdG9ycyBpbmRleGVkIGJ5IHRoZWlyIEVUSCBhZGRyZXNzCiAgbWFwcGluZyhhZGRyZXNzID0+IEludmVzdG9yKSBwdWJsaWMgaW52ZXN0b3JzOwogIC8vaW52ZXN0b3JzIGluZGV4ZWQgYnkgdGhlaXIgSURzCiAgbWFwcGluZyAodWludCA9PiBhZGRyZXNzKSBwdWJsaWMgaW52ZXN0b3JMaXN0OwoKICAKICAvL0VtaXQgZXZlbnQgb24gcmVjZWl2aW5nIEVUSAogIGV2ZW50IFJlY2VpdmVkRVRIKGFkZHJlc3MgYWRkciwgdWludCB2YWx1ZSk7CgogIC8vRW1pdCBldmVudCBvbiB0cmFuc2ZlcnJpbmcgRVhIIFRva2VuIHRvIHVzZXIgd2hlbiBwYXltZW50IGlzIHJlY2VpdmVkIGluIHRyYWRpdGlvbmFsIHdheXMgb3IgQiB0eXBlIEVYSCBUb2tlbiBjb252ZXJ0ZWQgdG8gQSB0eXBlIEVYSCBUb2tlbgogIGV2ZW50IE1pbnRBbmRUcmFuc2ZlckVYSChhZGRyZXNzIGFkZHIsIHVpbnQgdmFsdWUsIGJ5dGVzMzIgY29tbWVudCk7CgogIC8vY29uc3RydWN0b3IgdG8gaW5pdGlhbGl6ZSBjb250cmFjdCB2YXJpYWJsZXMKICBmdW5jdGlvbiBDcm93ZHNhbGUoKSBwdWJsaWMgewoKICAgIC8vV2lsbCBiZSBzZXQgaW4gZnVuY3Rpb24gc3RhcnQ7IE1ha2VzIHN1cmUgU2FsZSB3aWxsIGJlIHN0YXJ0ZWQgb25seSB3aGVuIHN0YXJ0KCkgZnVuY3Rpb24gaXMgY2FsbGVkCiAgICBzdGFydEJsb2NrID0gMDsgICAKICAgIC8vV2lsbCBiZSBzZXQgaW4gZnVuY3Rpb24gc3RhcnQ7IE1ha2VzIHN1cmUgU2FsZSB3aWxsIGJlIHN0YXJ0ZWQgb25seSB3aGVuIHN0YXJ0KCkgZnVuY3Rpb24gaXMgY2FsbGVkICAgICAgICAKICAgIGVuZEJsb2NrID0gMDsgICAgCiAgICAvL01heCBudW1iZXIgb2YgRVhIIFRva2VuIHRvIHNlbGwgaW4gQ3Jvd2RTYWxlW0luY2x1ZGVzIHRoZSB0b2tlbnMgc29sZCBpbiBwcmVzYWxlXSgzM00pCiAgICBtYXhDYXAgPSAzMTc1MDAwMGUxODsKICAgIC8vTWF4IG51bWJlciBvZiBFWEggVG9rZW4gdG8gc2VsbCBpbiBQcmVzYWxlKDAuNU0pCiAgICBtYXhDYXBQcmVTYWxlID0gNTAwMDAwZTE4OwogICAgLy8xMjUwMDAwIFRva2VucyBhdmFsYWJsZSBmb3IgTWludCBhbmQgVHJhbnNmZXIKICAgIG1heENhcE1pbnRUcmFuc2ZlciA9IDEyNTAwMDBlMTg7CiAgICAvLyBFWEggVG9rZW4gcGVyIGV0aGVyCiAgICBQUklDRSA9IDEwOyAKICAgIC8vSW5kaWNhdGVzIFNhbGUgc3RhdHVzOyBTYWxlIGlzIG5vdCBzdGFydGVkIHlldAogICAgY3Jvd2RzYWxlU3RhdHVzID0gMDsgICAgCiAgICAvL0F0IHRpbWUgb2YgZGVwbG95bWVudCBjcm93ZFNhbGUgdHlwZSBpcyBzZXQgdG8gUHJlc2FsZQogICAgY3Jvd2RTYWxlVHlwZSA9IDA7CiAgICAvLyBOdW1iZXIgb2YgZGF5cyBhZnRlciB3aGljaCBzYWxlIHdpbGwgc3RhcnQgc2luY2UgdGhlIHN0YXJ0aW5nIG9mIHByZXNhbGUsIGEgc2luZ2xlIHZhbHVlIHRvIHJlcGxhY2UgdGhlIGhhcmRjb2RlZAogICAgZHVyYXRpb25QcmVTYWxlID0gOCBkYXlzICsgMSBob3VyczsKICAgIC8vIE51bWJlciBvZiBkYXlzIGZvciB3aGljaCBjb21wbGV0ZSBjcm93ZHNhbGUgd2lsbCBydW4sIGllLCBwcmVzYWxlIGFuZCBjcm93ZHNhbGUgcGVyaW9kCiAgICBkdXJhdGlvbkNyb3dkU2FsZSA9IDI4IGRheXM7CiAgICAvLyBJbnZlc3RvciBjb3VudCBpcyAwIGluaXRpYWxseQogICAgY291bnRUb3RhbEludmVzdG9ycyA9IDA7CiAgICAvL0luaXRpYWxseSBubyBpbnZlc3RvciBoYXMgYmVlbiByZWZ1bmRlZAogICAgY291bnRJbnZlc3RvcnNSZWZ1bmRlZCA9IDA7CiAgICAvL1JlZnVuZCBlbGlnaWJsZSBvciBub3QKICAgIHJlZnVuZFN0YXR1cyA9IDA7CgogICAgY291bnRUb3RhbEludmVzdG9yc0luQ3Jvd2RzYWxlID0gMDsKICAgIGNvdW50SW52ZXN0b3JzUmVmdW5kZWRJbkNyb3dkc2FsZSA9IDA7CiAgICAKICB9CgogIC8vTW9kaWZpZXIgdG8gbWFrZSBzdXJlIHRyYW5zYWN0aW9uIGlzIGhhcHBlbmluZyBkdXJpbmcgU2FsZQogIG1vZGlmaWVyIHJlc3BlY3RUaW1lRnJhbWUoKSB7CiAgICBhc3NlcnQoISgobm93IDwgc3RhcnRCbG9jaykgfHwgKG5vdyA+IGVuZEJsb2NrICkpKTsKICAgIF87CiAgfQoKICAvKgogICogVG8gc3RhcnQgU2FsZSBmcm9tIFByZXNhbGUKICAqLwogIGZ1bmN0aW9uIHN0YXJ0KCkgcHVibGljIG9ubHlPd25lciB7CiAgICAvL1NldCBibG9jayBudW1iZXIgdG8gY3VycmVudCBibG9jayBudW1iZXIKICAgIGFzc2VydChzdGFydEJsb2NrID09IDApOwogICAgc3RhcnRCbG9jayA9IG5vdzsgICAgICAgICAgICAKICAgIC8vU2V0IGVuZCBibG9jayBudW1iZXIKICAgIGVuZEJsb2NrID0gbm93LkFkZChkdXJhdGlvbkNyb3dkU2FsZS5BZGQoZHVyYXRpb25QcmVTYWxlKSk7CiAgICAvL1NhbGUgcHJlc2FsZSBpcyBzdGFydGVkCiAgICBjcm93ZHNhbGVTdGF0dXMgPSAxOwogICAgLy9FbWl0IGV2ZW50IHdoZW4gY3Jvd2RzYWxlIHN0YXRlIGNoYW5nZXMKICAgIFN0YXRlQ2hhbmdlZCh0cnVlKTsgIAogIH0KCiAgLyoKICAqIFRvIHN0YXJ0IENyb3dkc2FsZQogICovCiAgZnVuY3Rpb24gc3RhcnRTYWxlKCkgcHVibGljIG9ubHlPd25lcgogIHsKICAgIGlmKG5vdyA+IHN0YXJ0QmxvY2suQWRkKGR1cmF0aW9uUHJlU2FsZSkgJiYgbm93IDw9IGVuZEJsb2NrKXsKICAgICAgICBjcm93ZHNhbGVTdGF0dXMgPSAxOwogICAgICAgIGNyb3dkU2FsZVR5cGUgPSAxOwogICAgICAgIGlmKGNyb3dkU2FsZVR5cGUgIT0gMSkKICAgICAgICB7CiAgICAgICAgICB0b3RhbFN1cHBseUNyb3dkc2FsZSA9IHRvdGFsU3VwcGx5UHJlU2FsZTsKICAgICAgICB9CiAgICAgICAgLy9FbWl0IGV2ZW50IHdoZW4gY3Jvd2RzYWxlIHN0YXRlIGNoYW5nZXMKICAgICAgICBTdGF0ZUNoYW5nZWQodHJ1ZSk7IAogICAgfQogICAgZWxzZQogICAgICByZXZlcnQoKTsKICB9CgogIC8qCiAgKiBUbyBleHRlbmQgZHVyYXRpb24gb2YgQ3Jvd2RzYWxlCiAgKi8KICBmdW5jdGlvbiB1cGRhdGVEdXJhdGlvbih1aW50IHRpbWUpIHB1YmxpYyBvbmx5T3duZXIKICB7CiAgICAgIHJlcXVpcmUodGltZSAhPSAwKTsKICAgICAgYXNzZXJ0KHN0YXJ0QmxvY2sgIT0gMCk7CiAgICAgIGFzc2VydChjcm93ZFNhbGVUeXBlID09IDEgJiYgY3Jvd2RzYWxlU3RhdHVzICE9IDIpOwogICAgICBkdXJhdGlvbkNyb3dkU2FsZSA9IGR1cmF0aW9uQ3Jvd2RTYWxlLkFkZCh0aW1lKTsKICAgICAgZW5kQmxvY2sgPSBlbmRCbG9jay5BZGQodGltZSk7CiAgICAgIC8vRW1pdCBldmVudCB3aGVuIGNyb3dkc2FsZSBzdGF0ZSBjaGFuZ2VzCiAgICAgIFN0YXRlQ2hhbmdlZCh0cnVlKTsKICB9CgogIC8qCiAgKiBUbyBzZXQgcHJpY2UgZm9yIEVYSCBUb2tlbgogICovCiAgZnVuY3Rpb24gc2V0UHJpY2UodWludCBwcmljZSkgcHVibGljIG9ubHlPd25lcgogIHsKICAgICAgcmVxdWlyZSggcHJpY2UgIT0gMCk7CiAgICAgIFBSSUNFID0gcHJpY2U7CiAgICAgIC8vRW1pdCBldmVudCB3aGVuIGNyb3dkc2FsZSBzdGF0ZSBjaGFuZ2VzCiAgICAgIFN0YXRlQ2hhbmdlZCh0cnVlKTsKICB9CiAgCiAgLyoKICAqIFRvIGVuYWJsZSB0cmFuc2ZlcnMgb2YgRVhIIFRva2VuIGFmdGVyIGNvbXBsZXRpb24gb2YgU2FsZQogICovCiAgZnVuY3Rpb24gdW5sb2NrKCkgcHVibGljIG9ubHlPd25lcgogIHsKICAgIGxvY2tlZCA9IGZhbHNlOwogICAgLy9FbWl0IGV2ZW50IHdoZW4gY3Jvd2RzYWxlIHN0YXRlIGNoYW5nZXMKICAgIFN0YXRlQ2hhbmdlZCh0cnVlKTsKICB9CiAgCiAgLy9mYWxsYmFjayBmdW5jdGlvbiBpLmUuIHBheWFibGU7IGluaXRpYXRlcyB3aGVuIGFueSBhZGRyZXNzIHRyYW5zZmVycyBFdGggdG8gQ29udHJhY3QgYWRkcmVzcwogIGZ1bmN0aW9uICgpIHB1YmxpYyBwYXlhYmxlIHsKICAvL2NhbGwgY3JlYXRlVG9rZW4gZnVuY3Rpb24gd2l0aCBhY2NvdW50IHdobyB0cmFuc2ZlcnJlZCBFdGggdG8gY29udHJhY3QgYWRkcmVzcwogICAgY3JlYXRlVG9rZW5zKG1zZy5zZW5kZXIpOwogIH0KCiAgLyoKICAqIFRvIGNyZWF0ZSBFWEggVG9rZW4gYW5kIGFzc2lnbiB0byB0cmFuc2FjdGlvbiBpbml0aWF0b3IKICAqLwogIGZ1bmN0aW9uIGNyZWF0ZVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KSBpbnRlcm5hbCBzdG9wSW5FbWVyZ2VuY3kgIHJlc3BlY3RUaW1lRnJhbWUgewogICAgLy9NYWtlIHN1cmUgU2FsZSBpcyBydW5uaW5nCiAgICBhc3NlcnQoY3Jvd2RzYWxlU3RhdHVzID09IDEpOyAKICAgIC8vRG9uJ3QgYWNjZXB0IGZ1bmQgdG8gcHVyY2hhc2UgbGVzcyB0aGFuIDEgRVhIIFRva2VuICAgCiAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSAxIGV0aGVyL2dldFByaWNlKCkpOyAgIAogICAgLy9NYWtlIHN1cmUgc2VudCBFdGggaXMgbm90IDAgICAgICAgICAgIAogICAgcmVxdWlyZShtc2cudmFsdWUgIT0gMCk7CiAgICAvL0NhbGN1bGF0ZSBFWEggVG9rZW4gdG8gc2VuZAogICAgdWludCBleGhUb1NlbmQgPSBtc2cudmFsdWUuTXVsKGdldFByaWNlKCkpOwoKICAgIC8vTWFrZSBlbnRyeSBpbiBJbnZlc3RvciBpbmRleGVkIHdpdGggYWRkcmVzcwogICAgSW52ZXN0b3Igc3RvcmFnZSBpbnZlc3RvclN0cnVjdCA9IGludmVzdG9yc1tiZW5lZmljaWFyeV07CgogICAgLy8gRm9yIFByZXNhbGUKICAgIGlmKGNyb3dkU2FsZVR5cGUgPT0gMCl7CiAgICAgIHJlcXVpcmUoZXhoVG9TZW5kLkFkZCh0b3RhbFN1cHBseVByZVNhbGUpIDw9IG1heENhcFByZVNhbGUpOwogICAgICB0b3RhbFN1cHBseVByZVNhbGUgPSB0b3RhbFN1cHBseVByZVNhbGUuQWRkKGV4aFRvU2VuZCk7CiAgICAgIGlmKChtYXhDYXBQcmVTYWxlLlN1Yih0b3RhbFN1cHBseVByZVNhbGUpIDwgdmFsdWVPbmVFdGhlcil8fChub3cgPiAoc3RhcnRCbG9jay5BZGQoNyBkYXlzICsgMSBob3VycykpKSl7CiAgICAgICAgY3Jvd2RzYWxlU3RhdHVzID0gMjsKICAgICAgfSAgICAgICAgCiAgICAgIGludmVzdG9yU3RydWN0LndlaVJlY2VpdmVkQ3Jvd2RzYWxlVHlwZTAgPSBpbnZlc3RvclN0cnVjdC53ZWlSZWNlaXZlZENyb3dkc2FsZVR5cGUwLkFkZChtc2cudmFsdWUpOwogICAgICBpbnZlc3RvclN0cnVjdC5leGhTZW50Q3Jvd2RzYWxlVHlwZTAgPSBpbnZlc3RvclN0cnVjdC5leGhTZW50Q3Jvd2RzYWxlVHlwZTAuQWRkKGV4aFRvU2VuZCk7CiAgICB9CgogICAgLy8gRm9yIENyb3dkU2FsZQogICAgZWxzZSBpZiAoY3Jvd2RTYWxlVHlwZSA9PSAxKXsKICAgICAgaWYgKGV4aFRvU2VuZC5BZGQodG90YWxTdXBwbHkpID4gbWF4Q2FwICkgewogICAgICAgIHJldmVydCgpOwogICAgICB9CiAgICAgIHRvdGFsU3VwcGx5Q3Jvd2RzYWxlID0gdG90YWxTdXBwbHlDcm93ZHNhbGUuQWRkKGV4aFRvU2VuZCk7CiAgICAgIGlmKG1heENhcC5TdWIodG90YWxTdXBwbHlDcm93ZHNhbGUpIDwgdmFsdWVPbmVFdGhlcikKICAgICAgewogICAgICAgIGNyb3dkc2FsZVN0YXR1cyA9IDI7CiAgICAgIH0KICAgICAgaWYoaW52ZXN0b3JTdHJ1Y3QuaW52ZXN0b3JJRCA9PSAwIHx8IGludmVzdG9yU3RydWN0LndlaVJlY2VpdmVkQ3Jvd2RzYWxlVHlwZTEgPT0gMCl7CiAgICAgICAgY291bnRUb3RhbEludmVzdG9yc0luQ3Jvd2RzYWxlKys7CiAgICAgIH0KICAgICAgaW52ZXN0b3JTdHJ1Y3Qud2VpUmVjZWl2ZWRDcm93ZHNhbGVUeXBlMSA9IGludmVzdG9yU3RydWN0LndlaVJlY2VpdmVkQ3Jvd2RzYWxlVHlwZTEuQWRkKG1zZy52YWx1ZSk7CiAgICAgIGludmVzdG9yU3RydWN0LmV4aFNlbnRDcm93ZHNhbGVUeXBlMSA9IGludmVzdG9yU3RydWN0LmV4aFNlbnRDcm93ZHNhbGVUeXBlMS5BZGQoZXhoVG9TZW5kKTsKICAgIH0KCiAgICAvL0lmIGl0IGlzIGEgbmV3IGludmVzdG9yLCB0aGVuIGNyZWF0ZSBhIG5ldyBpZAogICAgaWYoaW52ZXN0b3JTdHJ1Y3QuaW52ZXN0b3JJRCA9PSAwKXsKICAgICAgICBjb3VudFRvdGFsSW52ZXN0b3JzKys7CiAgICAgICAgaW52ZXN0b3JTdHJ1Y3QuaW52ZXN0b3JJRCA9IGNvdW50VG90YWxJbnZlc3RvcnM7CiAgICAgICAgaW52ZXN0b3JMaXN0W2NvdW50VG90YWxJbnZlc3RvcnNdID0gYmVuZWZpY2lhcnk7CiAgICB9CgogICAgLy91cGRhdGUgdG90YWwgc3VwcGx5IG9mIEVYSCBUb2tlbgogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5BZGQoZXhoVG9TZW5kKTsKICAgIC8vIFVwZGF0ZSB0aGUgdG90YWwgd2VpIGNvbGxlY3RlZCBkdXJpbmcgU2FsZQogICAgRVRIUmVjZWl2ZWQgPSBFVEhSZWNlaXZlZC5BZGQobXNnLnZhbHVlKTsgIAogICAgLy9VcGRhdGUgRVhIIFRva2VuIGJhbGFuY2UgZm9yIHRyYW5zYWN0aW9uIGluaXRpYXRvcgogICAgYmFsYW5jZXNbYmVuZWZpY2lhcnldID0gYmFsYW5jZXNbYmVuZWZpY2lhcnldLkFkZChleGhUb1NlbmQpOwogICAgLy9FbWl0IGV2ZW50IGZvciBjb250cmlidXRpb24KICAgIFJlY2VpdmVkRVRIKGJlbmVmaWNpYXJ5LEVUSFJlY2VpdmVkKTsgCiAgICAvL0VUSFJlY2VpdmVkIGR1cmluZyBTYWxlIHdpbGwgcmVtYWluIHdpdGggY29udHJhY3QKICAgIEdldEVYSEZ1bmRBY2NvdW50KCkudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgIC8vRW1pdCBldmVudCB3aGVuIGNyb3dkc2FsZSBzdGF0ZSBjaGFuZ2VzCiAgICBTdGF0ZUNoYW5nZWQodHJ1ZSk7CiAgfQoKICAvKgogICogVG8gZW5hYmxlIHZlc3Rpbmcgb2YgQiB0eXBlIEVYSCBUb2tlbgogICovCiAgZnVuY3Rpb24gTWludEFuZFRyYW5zZmVyVG9rZW4oYWRkcmVzcyBiZW5lZmljaWFyeSx1aW50IGV4aFRvQ3JlZGl0LGJ5dGVzMzIgY29tbWVudCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgIC8vQXZhaWxhYmxlIGFmdGVyIHRoZSBjcm93ZHNhbGUgaXMgc3RhcnRlZAogICAgYXNzZXJ0KHN0YXJ0QmxvY2sgIT0gMCk7CiAgICAvL0NoZWNrIHdoZXRoZXIgdG9rZW5zIGFyZSBhdmFpbGFibGUgb3Igbm90CiAgICBhc3NlcnQodG90YWxTdXBwbHlNaW50VHJhbnNmZXIgPD0gbWF4Q2FwTWludFRyYW5zZmVyKTsKICAgIC8vQ2hlY2sgd2hldGhlciB0aGUgYW1vdW50IG9mIHRva2VuIGFyZSBhdmFpbGFibGUgdG8gdHJhbnNmZXIKICAgIHJlcXVpcmUodG90YWxTdXBwbHlNaW50VHJhbnNmZXIuQWRkKGV4aFRvQ3JlZGl0KSA8PSBtYXhDYXBNaW50VHJhbnNmZXIpOwogICAgLy9VcGRhdGUgRVhIIFRva2VuIGJhbGFuY2UgZm9yIGJlbmVmaWNpYXJ5CiAgICBiYWxhbmNlc1tiZW5lZmljaWFyeV0gPSBiYWxhbmNlc1tiZW5lZmljaWFyeV0uQWRkKGV4aFRvQ3JlZGl0KTsKICAgIC8vVXBkYXRlIHRvdGFsIHN1cHBseSBmb3IgRVhIIFRva2VuCiAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LkFkZChleGhUb0NyZWRpdCk7CiAgICAvL3VwZGF0ZSB0b3RhbCBzdXBwbHkgZm9yIEVYSCB0b2tlbiBpbiBtaW50IGFuZCB0cmFuc2ZlcgogICAgdG90YWxTdXBwbHlNaW50VHJhbnNmZXIgPSB0b3RhbFN1cHBseU1pbnRUcmFuc2Zlci5BZGQoZXhoVG9DcmVkaXQpOwogICAgLy8gc2VuZCBldmVudCBmb3IgdHJhbnNmZXJyaW5nIEVYSCBUb2tlbiBvbiBvZmZsaW5lIHBheW1lbnQKICAgIE1pbnRBbmRUcmFuc2ZlckVYSChiZW5lZmljaWFyeSwgZXhoVG9DcmVkaXQsY29tbWVudCk7CiAgICAvL0VtaXQgZXZlbnQgd2hlbiBjcm93ZHNhbGUgc3RhdGUgY2hhbmdlcwogICAgU3RhdGVDaGFuZ2VkKHRydWUpOyAgCiAgfQoKICAvKgogICogVG8gZ2V0IHByaWNlIGZvciBFWEggVG9rZW4KICAqLwogIGZ1bmN0aW9uIGdldFByaWNlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcmVzdWx0KSB7CiAgICAgIGlmIChjcm93ZFNhbGVUeXBlID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIChQUklDRS5NdWwoMTAwKSkuRGl2KDcwKTsKICAgICAgfQogICAgICBpZiAoY3Jvd2RTYWxlVHlwZSA9PSAxKSB7CiAgICAgICAgICB1aW50IGNyb3dkc2FsZVByaWNlQnJhY2tldCA9IDEgd2Vla3M7CiAgICAgICAgICB1aW50IHN0YXJ0Q3Jvd2RzYWxlID0gc3RhcnRCbG9jay5BZGQoZHVyYXRpb25QcmVTYWxlKTsKICAgICAgICAgICAgaWYgKG5vdyA+IHN0YXJ0Q3Jvd2RzYWxlICYmIG5vdyA8PSBzdGFydENyb3dkc2FsZS5BZGQoY3Jvd2RzYWxlUHJpY2VCcmFja2V0KSkgewogICAgICAgICAgICAgICAgcmV0dXJuICgoUFJJQ0UuTXVsKDEwMCkpLkRpdig4MCkpOwogICAgICAgICAgICB9ZWxzZSBpZiAobm93ID4gc3RhcnRDcm93ZHNhbGUuQWRkKGNyb3dkc2FsZVByaWNlQnJhY2tldCkgJiYgbm93IDw9IChzdGFydENyb3dkc2FsZS5BZGQoY3Jvd2RzYWxlUHJpY2VCcmFja2V0Lk11bCgyKSkpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gKFBSSUNFLk11bCgxMDApKS5EaXYoODUpOwogICAgICAgICAgICB9ZWxzZSBpZiAobm93ID4gKHN0YXJ0Q3Jvd2RzYWxlLkFkZChjcm93ZHNhbGVQcmljZUJyYWNrZXQuTXVsKDIpKSkgJiYgbm93IDw9IChzdGFydENyb3dkc2FsZS5BZGQoY3Jvd2RzYWxlUHJpY2VCcmFja2V0Lk11bCgzKSkpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gKFBSSUNFLk11bCgxMDApKS5EaXYoOTApOwogICAgICAgICAgICB9ZWxzZSBpZiAobm93ID4gKHN0YXJ0Q3Jvd2RzYWxlLkFkZChjcm93ZHNhbGVQcmljZUJyYWNrZXQuTXVsKDMpKSkgJiYgbm93IDw9IChzdGFydENyb3dkc2FsZS5BZGQoY3Jvd2RzYWxlUHJpY2VCcmFja2V0Lk11bCg0KSkpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gKFBSSUNFLk11bCgxMDApKS5EaXYoOTUpOwogICAgICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIFBSSUNFOwogIH0KCiAgZnVuY3Rpb24gR2V0RVhIRnVuZEFjY291bnQoKSBpbnRlcm5hbCByZXR1cm5zIChhZGRyZXNzKSB7CiAgICB1aW50IHJlbWFpbmRlciA9IGJsb2NrLm51bWJlciUxMDsKICAgIGlmKHJlbWFpbmRlcj09MCl7CiAgICAgIHJldHVybiAweGRhMTQxZTcwNDYwMWY4QzhFMzQzQzVjQTI0NjM1NWM4MTIyMzhEOTE7CiAgICB9IGVsc2UgaWYocmVtYWluZGVyPT0xKXsKICAgICAgcmV0dXJuIDB4MjM4MTk2MzkwNkM0MzRkRDQ2Mzk0ODlCZWM5QTJiQjU1RDgzY0MxNDsKICAgIH0gZWxzZSBpZihyZW1haW5kZXI9PTIpewogICAgICByZXR1cm4gMHg1MzdDNzExOTQ1MkE3ODE0QUJEMUM0RUQ3MUY2ZUNEMjUyMjVDMEY2OwogICAgfSBlbHNlIGlmKHJlbWFpbmRlcj09Myl7CiAgICAgIHJldHVybiAweDFGMDQ4ODBmRmRGZmYwNWQzNjMwN2Y2OUVBQWM4NjQ1Qjk4NDQ5RTI7CiAgICB9IGVsc2UgaWYocmVtYWluZGVyPT00KXsKICAgICAgcmV0dXJuIDB4ZDcyQjgyYjY5RkVlMjlkODFmNWUyREE2NmFCOTEwMTRhRGFFMEFBMDsKICAgIH0gZWxzZSBpZihyZW1haW5kZXI9PTUpewogICAgICByZXR1cm4gMHhmNjNiZWY2QjY3MDY0MDUzMTkxZGM0YkM2RjFEMDY1OTJDMDc5MjVmOwogICAgfSBlbHNlIGlmKHJlbWFpbmRlcj09Nil7CiAgICAgIHJldHVybiAweDczODFGOUM1ZDM1RTg5NWU4MGFEZUMxZTFBMzU0MTg2MEY4NzY2MDA7CiAgICB9IGVsc2UgaWYocmVtYWluZGVyPT03KXsKICAgICAgcmV0dXJuIDB4MzcwMzAxQUU0NjU5RDI5NzViZTlGOTc2MDExYzc4N0VDNTllMDY0NTsKICAgIH0gZWxzZSBpZihyZW1haW5kZXI9PTgpewogICAgICByZXR1cm4gMHgyQzA0MWI2QTdmRjI3Nzk2NmNCMGI0Y2I5NjZhYUI4RmMxMTc4YWM1OwogICAgfWVsc2UgewogICAgICByZXR1cm4gMHg4QTQwMTI5MEEzOURjOEQwNDZlNDJCQUJhZjVhODE4ZTI5YWU0ZmRhOwogICAgfQogIH0KCiAgLyoKICAqIEZpbmFsaXplIHRoZSBjcm93ZHNhbGUKICAqLwogIGZ1bmN0aW9uIGZpbmFsaXplKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAvL01ha2Ugc3VyZSBTYWxlIGlzIHJ1bm5pbmcKICAgIGFzc2VydChjcm93ZHNhbGVTdGF0dXM9PTEgJiYgY3Jvd2RTYWxlVHlwZT09MSk7CiAgICAvLyBjYW5ub3QgZmluYWxpc2UgYmVmb3JlIGVuZCBvciB1bnRpbCBtYXhjYXAgaXMgcmVhY2hlZAogICAgICBhc3NlcnQoISgodG90YWxTdXBwbHlDcm93ZHNhbGUgPCBtYXhDYXAgJiYgbm93IDwgZW5kQmxvY2spICYmIChtYXhDYXAuU3ViKHRvdGFsU3VwcGx5Q3Jvd2RzYWxlKSA+PSB2YWx1ZU9uZUV0aGVyKSkpOyAgCiAgICAgIC8vSW5kaWNhdGVzIFNhbGUgaXMgZW5kZWQKICAgICAgCiAgICAgIC8vQ2hlY2tzIGlmIHRoZSBmdW5kcmFpc2luZyBnb2FsIGlzIHJlYWNoZWQgaW4gY3Jvd2RzYWxlIG9yIG5vdAogICAgICBpZiAodG90YWxTdXBwbHkgPCA1MzAwMDAwZTE4KQogICAgICAgIHJlZnVuZFN0YXR1cyA9IDI7CiAgICAgIGVsc2UKICAgICAgICByZWZ1bmRTdGF0dXMgPSAxOwogICAgICAKICAgIC8vY3Jvd2RzYWxlIGlzIGVuZGVkCiAgICBjcm93ZHNhbGVTdGF0dXMgPSAyOwogICAgLy9FbWl0IGV2ZW50IHdoZW4gY3Jvd2RzYWxlIHN0YXRlIGNoYW5nZXMKICAgIFN0YXRlQ2hhbmdlZCh0cnVlKTsKICB9CgogIC8qCiAgKiBSZWZ1bmQgdGhlIGludmVzdG9ycyBpbiBjYXNlIHRhcmdldCBvZiBjcm93ZHNhbGUgbm90IGFjaGlldmVkCiAgKi8KICBmdW5jdGlvbiByZWZ1bmQoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgYXNzZXJ0KHJlZnVuZFN0YXR1cyA9PSAyKTsKICAgICAgdWludCBiYXRjaFNpemUgPSBjb3VudEludmVzdG9yc1JlZnVuZGVkLkFkZCg1MCkgPCBjb3VudFRvdGFsSW52ZXN0b3JzID8gY291bnRJbnZlc3RvcnNSZWZ1bmRlZC5BZGQoNTApOiBjb3VudFRvdGFsSW52ZXN0b3JzOwogICAgICBmb3IodWludCBpPWNvdW50SW52ZXN0b3JzUmVmdW5kZWQuQWRkKDEpOyBpIDw9IGJhdGNoU2l6ZTsgaSsrKXsKICAgICAgICAgIGFkZHJlc3MgaW52ZXN0b3JBZGRyZXNzID0gaW52ZXN0b3JMaXN0W2ldOwogICAgICAgICAgSW52ZXN0b3Igc3RvcmFnZSBpbnZlc3RvclN0cnVjdCA9IGludmVzdG9yc1tpbnZlc3RvckFkZHJlc3NdOwogICAgICAgICAgLy9JZiBwdXJjaGFzZSBoYXMgYmVlbiBtYWRlIGR1cmluZyBDcm93ZFNhbGUKICAgICAgICAgIGlmKGludmVzdG9yU3RydWN0LmV4aFNlbnRDcm93ZHNhbGVUeXBlMSA+IDAgJiYgaW52ZXN0b3JTdHJ1Y3QuZXhoU2VudENyb3dkc2FsZVR5cGUxIDw9IGJhbGFuY2VzW2ludmVzdG9yQWRkcmVzc10pewogICAgICAgICAgICAgIC8vcmV0dXJuIGV2ZXJ5dGhpbmcKICAgICAgICAgICAgICBpbnZlc3RvckFkZHJlc3MudHJhbnNmZXIoaW52ZXN0b3JTdHJ1Y3Qud2VpUmVjZWl2ZWRDcm93ZHNhbGVUeXBlMSk7CiAgICAgICAgICAgICAgLy9SZWR1Y2UgRVRIUmVjZWl2ZWQKICAgICAgICAgICAgICBFVEhSZWNlaXZlZCA9IEVUSFJlY2VpdmVkLlN1YihpbnZlc3RvclN0cnVjdC53ZWlSZWNlaXZlZENyb3dkc2FsZVR5cGUxKTsKICAgICAgICAgICAgICAvL1VwZGF0ZSB0b3RhbFN1cHBseQogICAgICAgICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuU3ViKGludmVzdG9yU3RydWN0LmV4aFNlbnRDcm93ZHNhbGVUeXBlMSk7CiAgICAgICAgICAgICAgLy8gcmVkdWNlIGJhbGFuY2VzCiAgICAgICAgICAgICAgYmFsYW5jZXNbaW52ZXN0b3JBZGRyZXNzXSA9IGJhbGFuY2VzW2ludmVzdG9yQWRkcmVzc10uU3ViKGludmVzdG9yU3RydWN0LmV4aFNlbnRDcm93ZHNhbGVUeXBlMSk7CiAgICAgICAgICAgICAgLy9zZXQgZXZlcnl0aGluZyB0byB6ZXJvIGFmdGVyIHRyYW5zZmVyIHN1Y2Nlc3NmdWwKICAgICAgICAgICAgICBpbnZlc3RvclN0cnVjdC53ZWlSZWNlaXZlZENyb3dkc2FsZVR5cGUxID0gMDsKICAgICAgICAgICAgICBpbnZlc3RvclN0cnVjdC5leGhTZW50Q3Jvd2RzYWxlVHlwZTEgPSAwOwogICAgICAgICAgICAgIGNvdW50SW52ZXN0b3JzUmVmdW5kZWRJbkNyb3dkc2FsZSA9IGNvdW50SW52ZXN0b3JzUmVmdW5kZWRJbkNyb3dkc2FsZS5BZGQoMSk7CiAgICAgICAgICB9CiAgICAgIH0KICAgICAgLy9VcGRhdGUgdGhlIG51bWJlciBvZiBpbnZlc3RvcnMgdGhhdCBoYXZlIHJlY2lldmVkIHJlZnVuZAogICAgICBjb3VudEludmVzdG9yc1JlZnVuZGVkID0gYmF0Y2hTaXplOwogICAgICBTdGF0ZUNoYW5nZWQodHJ1ZSk7CiAgfQoKICAvKgogICAqIEZhaWxzYWZlIGRyYWluCiAgICovCiAgZnVuY3Rpb24gZHJhaW4oKSBwdWJsaWMgb25seU93bmVyIHsKICAgIEdldEVYSEZ1bmRBY2NvdW50KCkudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICB9CgogIC8qCiAgKiBGdW5jdGlvbiB0byBhZGQgRXRoZXIgaW4gdGhlIGNvbnRyYWN0IAogICovCiAgZnVuY3Rpb24gZnVuZENvbnRyYWN0Rm9yUmVmdW5kKCkgcGF5YWJsZXsKICAgIC8vIFN0YXRlQ2hhbmdlZCh0cnVlKTsKICB9Cgp9'.
	

]
