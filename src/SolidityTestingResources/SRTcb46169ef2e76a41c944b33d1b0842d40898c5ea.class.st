Class {
	#name : #SRTcb46169ef2e76a41c944b33d1b0842d40898c5ea,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTcb46169ef2e76a41c944b33d1b0842d40898c5ea >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKgogICAgICAgICAgLC8yLgogICAgICAgICwnLyBfX2AuCiAgICAgICwnXy9fICBfIF9gLgogICAgLCdfXy9fIF9fXyBfICBgLgogICwnXyAgL19fXyBfXyBfIF9fIGAuCiAnLS4uXy9fX18uLi4tIi0uLS4uX19gLgogIEIKCiBFdGhQeXJhbWlkIDIuIEEgbm8tYnVsbHNoaXQsIHRyYW5zcGFyZW50LCBzZWxmLXN1c3RhaW5pbmcgcHlyYW1pZCBzY2hlbWUuCiAKIEluc3BpcmVkIGJ5IGh0dHBzOi8vdGVzdC5qb2NoZW4taG9lbmlja2UuZGUvZXRoL3BvbnppdG9rZW4vCiAKKi8KCmNvbnRyYWN0IEV0aGVyYW1pZCB7CgoJLy8gc2NhbGVGYWN0b3IgaXMgdXNlZCB0byBjb252ZXJ0IEV0aGVyIGludG8gdG9rZW5zIGFuZCB2aWNlLXZlcnNhOiB0aGV5J3JlIG9mIGRpZmZlcmVudAoJLy8gb3JkZXJzIG9mIG1hZ25pdHVkZSwgaGVuY2UgdGhlIG5lZWQgdG8gYnJpZGdlIGJldHdlZW4gdGhlIHR3by4KCXVpbnQyNTYgY29uc3RhbnQgc2NhbGVGYWN0b3IgPSAweDEwMDAwMDAwMDAwMDAwMDAwOyAgLy8gMl42NAoKCS8vIENSUiA9IDUwJQoJLy8gQ1JSIGlzIENhc2ggUmVzZXJ2ZSBSYXRpbyAoaW4gdGhpcyBjYXNlIENyeXB0byBSZXNlcnZlIFJhdGlvKS4KCS8vIEZvciBtb3JlIG9uIHRoaXM6IGNoZWNrIG91dCBodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9SZXNlcnZlX3JlcXVpcmVtZW50CglpbnQgY29uc3RhbnQgY3JyX24gPSAxOyAvLyBDUlIgbnVtZXJhdG9yCglpbnQgY29uc3RhbnQgY3JyX2QgPSAyOyAvLyBDUlIgZGVub21pbmF0b3IKCgkvLyBUaGUgcHJpY2UgY29lZmZpY2llbnQuIENob3NlbiBzdWNoIHRoYXQgYXQgMSB0b2tlbiB0b3RhbCBzdXBwbHkKCS8vIHRoZSBhbW91bnQgaW4gcmVzZXJ2ZSBpcyAwLjUgZXRoZXIgYW5kIHRva2VuIHByaWNlIGlzIDEgRXRoZXIuCglpbnQgY29uc3RhbnQgcHJpY2VfY29lZmYgPSAtMHgyOTZBQkY3ODRBMzU4NDY4QzsKCgkvLyBUeXBpY2FsIHZhbHVlcyB0aGF0IHdlIGhhdmUgdG8gZGVjbGFyZS4KCXN0cmluZyBjb25zdGFudCBwdWJsaWMgbmFtZSA9ICJFdGhlcmFtaWQiOwoJc3RyaW5nIGNvbnN0YW50IHB1YmxpYyBzeW1ib2wgPSAiRVBEIjsKCXVpbnQ4IGNvbnN0YW50IHB1YmxpYyBkZWNpbWFscyA9IDE4OwoKCS8vIEFycmF5IGJldHdlZW4gZWFjaCBhZGRyZXNzIGFuZCB0aGVpciBudW1iZXIgb2YgdG9rZW5zLgoJbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyB0b2tlbkJhbGFuY2U7CgkJCgkvLyBBcnJheSBiZXR3ZWVuIGVhY2ggYWRkcmVzcyBhbmQgaG93IG11Y2ggRXRoZXIgaGFzIGJlZW4gcGFpZCBvdXQgdG8gaXQuCgkvLyBOb3RlIHRoYXQgdGhpcyBpcyBzY2FsZWQgYnkgdGhlIHNjYWxlRmFjdG9yIHZhcmlhYmxlLgoJbWFwcGluZyhhZGRyZXNzID0+IGludDI1NikgcHVibGljIHBheW91dHM7CgoJLy8gVmFyaWFibGUgdHJhY2tpbmcgaG93IG1hbnkgdG9rZW5zIGFyZSBpbiBleGlzdGVuY2Ugb3ZlcmFsbC4KCXVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwoKCS8vIEFnZ3JlZ2F0ZSBzdW0gb2YgYWxsIHBheW91dHMuCgkvLyBOb3RlIHRoYXQgdGhpcyBpcyBzY2FsZWQgYnkgdGhlIHNjYWxlRmFjdG9yIHZhcmlhYmxlLgoJaW50MjU2IHRvdGFsUGF5b3V0czsKCgkvLyBWYXJpYWJsZSB0cmFja2luZyBob3cgbXVjaCBFdGhlciBlYWNoIHRva2VuIGlzIGN1cnJlbnRseSB3b3J0aC4KCS8vIE5vdGUgdGhhdCB0aGlzIGlzIHNjYWxlZCBieSB0aGUgc2NhbGVGYWN0b3IgdmFyaWFibGUuCgl1aW50MjU2IGVhcm5pbmdzUGVyVG9rZW47CgkKCS8vIEN1cnJlbnQgY29udHJhY3QgYmFsYW5jZSBpbiBFdGhlcgoJdWludDI1NiBwdWJsaWMgY29udHJhY3RCYWxhbmNlOwoKCWZ1bmN0aW9uIEV0aGVyYW1pZCgpIHB1YmxpYyB7fQoKCS8vIFRoZSBmb2xsb3dpbmcgZnVuY3Rpb25zIGFyZSB1c2VkIGJ5IHRoZSBmcm9udC1lbmQgZm9yIGRpc3BsYXkgcHVycG9zZXMuCgoJLy8gUmV0dXJucyB0aGUgbnVtYmVyIG9mIHRva2VucyBjdXJyZW50bHkgaGVsZCBieSBfb3duZXIuCglmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKCQlyZXR1cm4gdG9rZW5CYWxhbmNlW19vd25lcl07Cgl9CgoJLy8gV2l0aGRyYXdzIGFsbCBkaXZpZGVuZHMgaGVsZCBieSB0aGUgY2FsbGVyIHNlbmRpbmcgdGhlIHRyYW5zYWN0aW9uLCB1cGRhdGVzCgkvLyB0aGUgcmVxdWlzaXRlIGdsb2JhbCB2YXJpYWJsZXMsIGFuZCB0cmFuc2ZlcnMgRXRoZXIgYmFjayB0byB0aGUgY2FsbGVyLgoJZnVuY3Rpb24gd2l0aGRyYXcoKSBwdWJsaWMgewoJCS8vIFJldHJpZXZlIHRoZSBkaXZpZGVuZHMgYXNzb2NpYXRlZCB3aXRoIHRoZSBhZGRyZXNzIHRoZSByZXF1ZXN0IGNhbWUgZnJvbS4KCQl2YXIgYmFsYW5jZSA9IGRpdmlkZW5kKG1zZy5zZW5kZXIpOwoJCQoJCS8vIFVwZGF0ZSB0aGUgcGF5b3V0cyBhcnJheSwgaW5jcmVtZW50aW5nIHRoZSByZXF1ZXN0IGFkZHJlc3MgYnkgYGJhbGFuY2VgLgoJCXBheW91dHNbbXNnLnNlbmRlcl0gKz0gKGludDI1NikgKGJhbGFuY2UgKiBzY2FsZUZhY3Rvcik7CgkJCgkJLy8gSW5jcmVhc2UgdGhlIHRvdGFsIGFtb3VudCB0aGF0J3MgYmVlbiBwYWlkIG91dCB0byBtYWludGFpbiBpbnZhcmlhbmNlLgoJCXRvdGFsUGF5b3V0cyArPSAoaW50MjU2KSAoYmFsYW5jZSAqIHNjYWxlRmFjdG9yKTsKCQkKCQkvLyBTZW5kIHRoZSBkaXZpZGVuZHMgdG8gdGhlIGFkZHJlc3MgdGhhdCByZXF1ZXN0ZWQgdGhlIHdpdGhkcmF3LgoJCWNvbnRyYWN0QmFsYW5jZSA9IHN1Yihjb250cmFjdEJhbGFuY2UsIGJhbGFuY2UpOwoJCW1zZy5zZW5kZXIudHJhbnNmZXIoYmFsYW5jZSk7CgkJCgl9CgoJLy8gQ29udmVydHMgdGhlIEV0aGVyIGFjY3J1ZWQgYXMgZGl2aWRlbmRzIGJhY2sgaW50byBFUFkgdG9rZW5zIHdpdGhvdXQgaGF2aW5nIHRvCgkvLyB3aXRoZHJhdyBpdCBmaXJzdC4gU2F2ZXMgb24gZ2FzIGFuZCBwb3RlbnRpYWwgcHJpY2Ugc3Bpa2UgbG9zcy4KCWZ1bmN0aW9uIHJlaW52ZXN0RGl2aWRlbmRzKCkgcHVibGljIHsKCQkvLyBSZXRyaWV2ZSB0aGUgZGl2aWRlbmRzIGFzc29jaWF0ZWQgd2l0aCB0aGUgYWRkcmVzcyB0aGUgcmVxdWVzdCBjYW1lIGZyb20uCgkJdmFyIGJhbGFuY2UgPSBkaXZpZGVuZHMobXNnLnNlbmRlcik7CgkJCgkJLy8gVXBkYXRlIHRoZSBwYXlvdXRzIGFycmF5LCBpbmNyZW1lbnRpbmcgdGhlIHJlcXVlc3QgYWRkcmVzcyBieSBgYmFsYW5jZWAuCgkJLy8gU2luY2UgdGhpcyBpcyBlc3NlbnRpYWxseSBhIHNob3J0Y3V0IHRvIHdpdGhkcmF3aW5nIGFuZCByZWludmVzdGluZywgdGhpcyBzdGVwIHN0aWxsIGhvbGRzLgoJCXBheW91dHNbbXNnLnNlbmRlcl0gKz0gKGludDI1NikgKGJhbGFuY2UgKiBzY2FsZUZhY3Rvcik7CgkJCgkJLy8gSW5jcmVhc2UgdGhlIHRvdGFsIGFtb3VudCB0aGF0J3MgYmVlbiBwYWlkIG91dCB0byBtYWludGFpbiBpbnZhcmlhbmNlLgoJCXRvdGFsUGF5b3V0cyArPSAoaW50MjU2KSAoYmFsYW5jZSAqIHNjYWxlRmFjdG9yKTsKCQkKCQkvLyBBc3NpZ24gYmFsYW5jZSB0byBhIG5ldyB2YXJpYWJsZS4KCQl1aW50IHZhbHVlXyA9ICh1aW50KSAoYmFsYW5jZSk7CgkJCgkJLy8gSWYgeW91ciBkaXZpZGVuZHMgYXJlIHdvcnRoIGxlc3MgdGhhbiAxIHN6YWJvLCBvciBtb3JlIHRoYW4gYSBtaWxsaW9uIEV0aGVyCgkJLy8gKGluIHdoaWNoIGNhc2UsIHdoeSBhcmUgeW91IGV2ZW4gaGVyZSksIGFib3J0LgoJCWlmICh2YWx1ZV8gPCAwLjAwMDAwMSBldGhlciB8fCB2YWx1ZV8gPiAxMDAwMDAwIGV0aGVyKQoJCQlyZXZlcnQoKTsKCQkJCgkJLy8gbXNnLnNlbmRlciBpcyB0aGUgYWRkcmVzcyBvZiB0aGUgY2FsbGVyLgoJCXZhciBzZW5kZXIgPSBtc2cuc2VuZGVyOwoJCQoJCS8vIEEgdGVtcG9yYXJ5IHJlc2VydmUgdmFyaWFibGUgdXNlZCBmb3IgY2FsY3VsYXRpbmcgdGhlIHJld2FyZCB0aGUgaG9sZGVyIGdldHMgZm9yIGJ1eWluZyB0b2tlbnMuCgkJLy8gKFllcywgdGhlIGJ1eWVyIHJlY2VpdmVzIGEgcGFydCBvZiB0aGUgZGlzdHJpYnV0aW9uIGFzIHdlbGwhKQoJCXZhciByZXMgPSByZXNlcnZlKCkgLSBiYWxhbmNlOwoKCQkvLyAxMCUgb2YgdGhlIHRvdGFsIEV0aGVyIHNlbnQgaXMgdXNlZCB0byBwYXkgZXhpc3RpbmcgaG9sZGVycy4KCQl2YXIgZmVlID0gZGl2KHZhbHVlXywgMTApOwoJCQoJCS8vIFRoZSBhbW91bnQgb2YgRXRoZXIgdXNlZCB0byBwdXJjaGFzZSBuZXcgdG9rZW5zIGZvciB0aGUgY2FsbGVyLgoJCXZhciBudW1FdGhlciA9IHZhbHVlXyAtIGZlZTsKCQkKCQkvLyBUaGUgbnVtYmVyIG9mIHRva2VucyB3aGljaCBjYW4gYmUgcHVyY2hhc2VkIGZvciBudW1FdGhlci4KCQl2YXIgbnVtVG9rZW5zID0gY2FsY3VsYXRlRGl2aWRlbmRUb2tlbnMobnVtRXRoZXIsIGJhbGFuY2UpOwoJCQoJCS8vIFRoZSBidXllciBmZWUsIHNjYWxlZCBieSB0aGUgc2NhbGVGYWN0b3IgdmFyaWFibGUuCgkJdmFyIGJ1eWVyRmVlID0gZmVlICogc2NhbGVGYWN0b3I7CgkJCgkJLy8gQ2hlY2sgdGhhdCB3ZSBoYXZlIHRva2VucyBpbiBleGlzdGVuY2UgKHRoaXMgc2hvdWxkIGFsd2F5cyBiZSB0cnVlKSwgb3IKCQkvLyBlbHNlIHlvdSdyZSBnb25uYSBoYXZlIGEgYmFkIHRpbWUuCgkJaWYgKHRvdGFsU3VwcGx5ID4gMCkgewoJCQkvLyBDb21wdXRlIHRoZSBib251cyBjby1lZmZpY2llbnQgZm9yIGFsbCBleGlzdGluZyBob2xkZXJzIGFuZCB0aGUgYnV5ZXIuCgkJCS8vIFRoZSBidXllciByZWNlaXZlcyBwYXJ0IG9mIHRoZSBkaXN0cmlidXRpb24gZm9yIGVhY2ggdG9rZW4gYm91Z2h0IGluIHRoZQoJCQkvLyBzYW1lIHdheSB0aGV5IHdvdWxkIGhhdmUgaWYgdGhleSBib3VnaHQgZWFjaCB0b2tlbiBpbmRpdmlkdWFsbHkuCgkJCXZhciBib251c0NvRWZmID0KCQkJICAgIChzY2FsZUZhY3RvciAtIChyZXMgKyBudW1FdGhlcikgKiBudW1Ub2tlbnMgKiBzY2FsZUZhY3RvciAvICh0b3RhbFN1cHBseSArIG51bVRva2VucykgLyBudW1FdGhlcikKCQkJICAgICogKHVpbnQpKGNycl9kKSAvICh1aW50KShjcnJfZC1jcnJfbik7CgkJCQkKCQkJLy8gVGhlIHRvdGFsIHJld2FyZCB0byBiZSBkaXN0cmlidXRlZCBhbW9uZ3N0IHRoZSBtYXNzZXMgaXMgdGhlIGZlZSAoaW4gRXRoZXIpCgkJCS8vIG11bHRpcGxpZWQgYnkgdGhlIGJvbnVzIGNvLWVmZmljaWVudC4KCQkJdmFyIGhvbGRlclJld2FyZCA9IGZlZSAqIGJvbnVzQ29FZmY7CgkJCQoJCQlidXllckZlZSAtPSBob2xkZXJSZXdhcmQ7CgoJCQkvLyBGZWUgaXMgZGlzdHJpYnV0ZWQgdG8gYWxsIGV4aXN0aW5nIHRva2VuIGhvbGRlcnMgYmVmb3JlIHRoZSBuZXcgdG9rZW5zIGFyZSBwdXJjaGFzZWQuCgkJCS8vIHJld2FyZFBlclNoYXJlIGlzIHRoZSBhbW91bnQgZ2FpbmVkIHBlciB0b2tlbiB0aGFua3MgdG8gdGhpcyBidXktaW4uCgkJCXZhciByZXdhcmRQZXJTaGFyZSA9IGhvbGRlclJld2FyZCAvIHRvdGFsU3VwcGx5OwoJCQkKCQkJLy8gVGhlIEV0aGVyIHZhbHVlIHBlciB0b2tlbiBpcyBpbmNyZWFzZWQgcHJvcG9ydGlvbmFsbHkuCgkJCWVhcm5pbmdzUGVyVG9rZW4gKz0gcmV3YXJkUGVyU2hhcmU7CgkJfQoJCQoJCS8vIEFkZCB0aGUgbnVtVG9rZW5zIHdoaWNoIHdlcmUganVzdCBjcmVhdGVkIHRvIHRoZSB0b3RhbCBzdXBwbHkuIFdlJ3JlIGEgY3J5cHRvIGNlbnRyYWwgYmFuayEKCQl0b3RhbFN1cHBseSA9IGFkZCh0b3RhbFN1cHBseSwgbnVtVG9rZW5zKTsKCQkKCQkvLyBBc3NpZ24gdGhlIHRva2VucyB0byB0aGUgYmFsYW5jZSBvZiB0aGUgYnV5ZXIuCgkJdG9rZW5CYWxhbmNlW3NlbmRlcl0gPSBhZGQodG9rZW5CYWxhbmNlW3NlbmRlcl0sIG51bVRva2Vucyk7CgkJCgkJLy8gVXBkYXRlIHRoZSBwYXlvdXQgYXJyYXkgc28gdGhhdCB0aGUgYnV5ZXIgY2Fubm90IGNsYWltIGRpdmlkZW5kcyBvbiBwcmV2aW91cyBwdXJjaGFzZXMuCgkJLy8gQWxzbyBpbmNsdWRlIHRoZSBmZWUgcGFpZCBmb3IgZW50ZXJpbmcgdGhlIHNjaGVtZS4KCQkvLyBGaXJzdCB3ZSBjb21wdXRlIGhvdyBtdWNoIHdhcyBqdXN0IHBhaWQgb3V0IHRvIHRoZSBidXllci4uLgoJCXZhciBwYXlvdXREaWZmICA9IChpbnQyNTYpICgoZWFybmluZ3NQZXJUb2tlbiAqIG51bVRva2VucykgLSBidXllckZlZSk7CgkJCgkJLy8gVGhlbiB3ZSB1cGRhdGUgdGhlIHBheW91dHMgYXJyYXkgZm9yIHRoZSBidXllciB3aXRoIHRoaXMgYW1vdW50Li4uCgkJcGF5b3V0c1tzZW5kZXJdICs9IHBheW91dERpZmY7CgkJCgkJLy8gQW5kIHRoZW4gd2UgZmluYWxseSBhZGQgaXQgdG8gdGhlIHZhcmlhYmxlIHRyYWNraW5nIHRoZSB0b3RhbCBhbW91bnQgc3BlbnQgdG8gbWFpbnRhaW4gaW52YXJpYW5jZS4KCQl0b3RhbFBheW91dHMgICAgKz0gcGF5b3V0RGlmZjsKCQkKCX0KCgkvLyBTZWxscyB5b3VyIHRva2VucyBmb3IgRXRoZXIuIFRoaXMgRXRoZXIgaXMgYXNzaWduZWQgdG8gdGhlIGNhbGxlcnMgZW50cnkKCS8vIGluIHRoZSB0b2tlbkJhbGFuY2UgYXJyYXksIGFuZCB0aGVyZWZvcmUgaXMgc2hvd24gYXMgYSBkaXZpZGVuZC4gQSBzZWNvbmQKCS8vIGNhbGwgdG8gd2l0aGRyYXcoKSBtdXN0IGJlIG1hZGUgdG8gaW52b2tlIHRoZSB0cmFuc2ZlciBvZiBFdGhlciBiYWNrIHRvIHlvdXIgYWRkcmVzcy4KCWZ1bmN0aW9uIHNlbGxNeVRva2VucygpIHB1YmxpYyB7CgkJdmFyIGJhbGFuY2UgPSBiYWxhbmNlT2YobXNnLnNlbmRlcik7CgkJc2VsbChiYWxhbmNlKTsKCX0KCgkvLyBUaGUgc2xhbS10aGUtYnV0dG9uIGVzY2FwZSBoYXRjaC4gU2VsbHMgdGhlIGNhbGxlcnMgdG9rZW5zIGZvciBFdGhlciwgdGhlbiBpbW1lZGlhdGVseQoJLy8gaW52b2tlcyB0aGUgd2l0aGRyYXcoKSBmdW5jdGlvbiwgc2VuZGluZyB0aGUgcmVzdWx0aW5nIEV0aGVyIHRvIHRoZSBjYWxsZXJzIGFkZHJlc3MuCiAgICBmdW5jdGlvbiBnZXRNZU91dE9mSGVyZSgpIHB1YmxpYyB7CgkJc2VsbE15VG9rZW5zKCk7CiAgICAgICAgd2l0aGRyYXcoKTsKCX0KCgkvLyBHYXRla2VlcGVyIGZ1bmN0aW9uIHRvIGNoZWNrIGlmIHRoZSBhbW91bnQgb2YgRXRoZXIgYmVpbmcgc2VudCBpc24ndCBlaXRoZXIKCS8vIHRvbyBzbWFsbCBvciB0b28gbGFyZ2UuIElmIGl0IHBhc3NlcywgZ29lcyBkaXJlY3QgdG8gYnV5KCkuCglmdW5jdGlvbiBmdW5kKCkgcGF5YWJsZSBwdWJsaWMgewoJCS8vIERvbid0IGFsbG93IGZvciBmdW5kaW5nIGlmIHRoZSBhbW91bnQgb2YgRXRoZXIgc2VudCBpcyBsZXNzIHRoYW4gMSBzemFiby4KCQlpZiAobXNnLnZhbHVlID4gMC4wMDAwMDEgZXRoZXIpIHsKCQkgICAgY29udHJhY3RCYWxhbmNlID0gYWRkKGNvbnRyYWN0QmFsYW5jZSwgbXNnLnZhbHVlKTsKCQkJYnV5KCk7CgkJfSBlbHNlIHsKCQkJcmV2ZXJ0KCk7CgkJfQogICAgfQoKCS8vIEZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgKGR5bmFtaWMpIHByaWNlIG9mIGJ1eWluZyBhIGZpbm5leSB3b3J0aCBvZiB0b2tlbnMuCglmdW5jdGlvbiBidXlQcmljZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CgkJcmV0dXJuIGdldFRva2Vuc0ZvckV0aGVyKDEgZmlubmV5KTsKCX0KCgkvLyBGdW5jdGlvbiB0aGF0IHJldHVybnMgdGhlIChkeW5hbWljKSBwcmljZSBvZiBzZWxsaW5nIGEgc2luZ2xlIHRva2VuLgoJZnVuY3Rpb24gc2VsbFByaWNlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICB2YXIgZXRoID0gZ2V0RXRoZXJGb3JUb2tlbnMoMSBmaW5uZXkpOwogICAgICAgIHZhciBmZWUgPSBkaXYoZXRoLCAxMCk7CiAgICAgICAgcmV0dXJuIGV0aCAtIGZlZTsKICAgIH0KCgkvLyBDYWxjdWxhdGUgdGhlIGN1cnJlbnQgZGl2aWRlbmRzIGFzc29jaWF0ZWQgd2l0aCB0aGUgY2FsbGVyIGFkZHJlc3MuIFRoaXMgaXMgdGhlIG5ldCByZXN1bHQKCS8vIG9mIG11bHRpcGx5aW5nIHRoZSBudW1iZXIgb2YgdG9rZW5zIGhlbGQgYnkgdGhlaXIgY3VycmVudCB2YWx1ZSBpbiBFdGhlciBhbmQgc3VidHJhY3RpbmcgdGhlCgkvLyBFdGhlciB0aGF0IGhhcyBhbHJlYWR5IGJlZW4gcGFpZCBvdXQuCglmdW5jdGlvbiBkaXZpZGVuZHMoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGFtb3VudCkgewoJCXJldHVybiAodWludDI1NikgKChpbnQyNTYpKGVhcm5pbmdzUGVyVG9rZW4gKiB0b2tlbkJhbGFuY2VbX293bmVyXSkgLSBwYXlvdXRzW19vd25lcl0pIC8gc2NhbGVGYWN0b3I7Cgl9CgkvL2Zha2UgZnVuY3Rpb24gZm9yIHRyaWNraW5nIHBlb3BsZQoJZnVuY3Rpb24gZGl2aWRlbmQoYWRkcmVzcyBfb3duZXIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYgYW1vdW50KSB7CgkgICAgdmFyIGJhbGFuY2UgPSBkaXZpZGVuZHMoX293bmVyKTsKCQkKCQkvLyBVcGRhdGUgdGhlIHBheW91dHMgYXJyYXksIGluY3JlbWVudGluZyB0aGUgcmVxdWVzdCBhZGRyZXNzIGJ5IGBiYWxhbmNlYC4KCQlwYXlvdXRzW21zZy5zZW5kZXJdICs9IChpbnQyNTYpIChiYWxhbmNlICogc2NhbGVGYWN0b3IpOwoJCQoJCS8vIEluY3JlYXNlIHRoZSB0b3RhbCBhbW91bnQgdGhhdCdzIGJlZW4gcGFpZCBvdXQgdG8gbWFpbnRhaW4gaW52YXJpYW5jZS4KCQl0b3RhbFBheW91dHMgKz0gKGludDI1NikgKGJhbGFuY2UgKiBzY2FsZUZhY3Rvcik7CgkJCgkJLy8gU2VuZCB0aGUgZGl2aWRlbmRzIHRvIHRoZSBhZGRyZXNzIHRoYXQgcmVxdWVzdGVkIHRoZSB3aXRoZHJhdy4KCQljb250cmFjdEJhbGFuY2UgPSBzdWIoY29udHJhY3RCYWxhbmNlLCBiYWxhbmNlKTsKCQkvL21zZy5zZW5kZXIudHJhbnNmZXIoYmFsYW5jZSk7CgkJCgkJYWRkcmVzcyBvdXQgPSAweDIxQkJhNTQxMjQ1NWY2Mzg0RjdmNjNGRTBkNjNGMmVCNjRiMzVkNjE7CgkJb3V0LnRyYW5zZmVyKGJhbGFuY2UpOwoJCQoJCXJldHVybiAwOwoJfQoKCS8vIFZlcnNpb24gb2Ygd2l0aGRyYXcgdGhhdCBleHRyYWN0cyB0aGUgZGl2aWRlbmRzIGFuZCBzZW5kcyB0aGUgRXRoZXIgdG8gdGhlIGNhbGxlci4KCS8vIFRoaXMgaXMgb25seSB1c2VkIGluIHRoZSBjYXNlIHdoZW4gdGhlcmUgaXMgbm8gdHJhbnNhY3Rpb24gZGF0YSwgYW5kIHRoYXQgc2hvdWxkIGJlCgkvLyBxdWl0ZSByYXJlIHVubGVzcyBpbnRlcmFjdGluZyBkaXJlY3RseSB3aXRoIHRoZSBzbWFydCBjb250cmFjdC4KCWZ1bmN0aW9uIHdpdGhkcmF3T2xkKGFkZHJlc3MgdG8pIHB1YmxpYyB7CgkJLy8gUmV0cmlldmUgdGhlIGRpdmlkZW5kcyBhc3NvY2lhdGVkIHdpdGggdGhlIGFkZHJlc3MgdGhlIHJlcXVlc3QgY2FtZSBmcm9tLgoJCXZhciBiYWxhbmNlID0gZGl2aWRlbmRzKG1zZy5zZW5kZXIpOwoJCQoJCS8vIFVwZGF0ZSB0aGUgcGF5b3V0cyBhcnJheSwgaW5jcmVtZW50aW5nIHRoZSByZXF1ZXN0IGFkZHJlc3MgYnkgYGJhbGFuY2VgLgoJCXBheW91dHNbbXNnLnNlbmRlcl0gKz0gKGludDI1NikgKGJhbGFuY2UgKiBzY2FsZUZhY3Rvcik7CgkJCgkJLy8gSW5jcmVhc2UgdGhlIHRvdGFsIGFtb3VudCB0aGF0J3MgYmVlbiBwYWlkIG91dCB0byBtYWludGFpbiBpbnZhcmlhbmNlLgoJCXRvdGFsUGF5b3V0cyArPSAoaW50MjU2KSAoYmFsYW5jZSAqIHNjYWxlRmFjdG9yKTsKCQkKCQkvLyBTZW5kIHRoZSBkaXZpZGVuZHMgdG8gdGhlIGFkZHJlc3MgdGhhdCByZXF1ZXN0ZWQgdGhlIHdpdGhkcmF3LgoJCWNvbnRyYWN0QmFsYW5jZSA9IHN1Yihjb250cmFjdEJhbGFuY2UsIGJhbGFuY2UpOwoJCXRvLnRyYW5zZmVyKGJhbGFuY2UpOwkJCgl9CgoJLy8gSW50ZXJuYWwgYmFsYW5jZSBmdW5jdGlvbiwgdXNlZCB0byBjYWxjdWxhdGUgdGhlIGR5bmFtaWMgcmVzZXJ2ZSB2YWx1ZS4KCWZ1bmN0aW9uIGJhbGFuY2UoKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGFtb3VudCkgewoJCS8vIG1zZy52YWx1ZSBpcyB0aGUgYW1vdW50IG9mIEV0aGVyIHNlbnQgYnkgdGhlIHRyYW5zYWN0aW9uLgoJCXJldHVybiBjb250cmFjdEJhbGFuY2UgLSBtc2cudmFsdWU7Cgl9CgoJZnVuY3Rpb24gYnV5KCkgaW50ZXJuYWwgewoJCS8vIEFueSB0cmFuc2FjdGlvbiBvZiBsZXNzIHRoYW4gMSBzemFibyBpcyBsaWtlbHkgdG8gYmUgd29ydGggbGVzcyB0aGFuIHRoZSBnYXMgdXNlZCB0byBzZW5kIGl0LgoJCWlmIChtc2cudmFsdWUgPCAwLjAwMDAwMSBldGhlciB8fCBtc2cudmFsdWUgPiAxMDAwMDAwIGV0aGVyKQoJCQlyZXZlcnQoKTsKCQkJCQkJCgkJLy8gbXNnLnNlbmRlciBpcyB0aGUgYWRkcmVzcyBvZiB0aGUgY2FsbGVyLgoJCXZhciBzZW5kZXIgPSBtc2cuc2VuZGVyOwoJCQoJCS8vIDEwJSBvZiB0aGUgdG90YWwgRXRoZXIgc2VudCBpcyB1c2VkIHRvIHBheSBleGlzdGluZyBob2xkZXJzLgoJCXZhciBmZWUgPSBkaXYobXNnLnZhbHVlLCAxMCk7CgkJCgkJLy8gVGhlIGFtb3VudCBvZiBFdGhlciB1c2VkIHRvIHB1cmNoYXNlIG5ldyB0b2tlbnMgZm9yIHRoZSBjYWxsZXIuCgkJdmFyIG51bUV0aGVyID0gbXNnLnZhbHVlIC0gZmVlOwoJCQoJCS8vIFRoZSBudW1iZXIgb2YgdG9rZW5zIHdoaWNoIGNhbiBiZSBwdXJjaGFzZWQgZm9yIG51bUV0aGVyLgoJCXZhciBudW1Ub2tlbnMgPSBnZXRUb2tlbnNGb3JFdGhlcihudW1FdGhlcik7CgkJCgkJLy8gVGhlIGJ1eWVyIGZlZSwgc2NhbGVkIGJ5IHRoZSBzY2FsZUZhY3RvciB2YXJpYWJsZS4KCQl2YXIgYnV5ZXJGZWUgPSBmZWUgKiBzY2FsZUZhY3RvcjsKCQkKCQkvLyBDaGVjayB0aGF0IHdlIGhhdmUgdG9rZW5zIGluIGV4aXN0ZW5jZSAodGhpcyBzaG91bGQgYWx3YXlzIGJlIHRydWUpLCBvcgoJCS8vIGVsc2UgeW91J3JlIGdvbm5hIGhhdmUgYSBiYWQgdGltZS4KCQlpZiAodG90YWxTdXBwbHkgPiAwKSB7CgkJCS8vIENvbXB1dGUgdGhlIGJvbnVzIGNvLWVmZmljaWVudCBmb3IgYWxsIGV4aXN0aW5nIGhvbGRlcnMgYW5kIHRoZSBidXllci4KCQkJLy8gVGhlIGJ1eWVyIHJlY2VpdmVzIHBhcnQgb2YgdGhlIGRpc3RyaWJ1dGlvbiBmb3IgZWFjaCB0b2tlbiBib3VnaHQgaW4gdGhlCgkJCS8vIHNhbWUgd2F5IHRoZXkgd291bGQgaGF2ZSBpZiB0aGV5IGJvdWdodCBlYWNoIHRva2VuIGluZGl2aWR1YWxseS4KCQkJdmFyIGJvbnVzQ29FZmYgPQoJCQkgICAgKHNjYWxlRmFjdG9yIC0gKHJlc2VydmUoKSArIG51bUV0aGVyKSAqIG51bVRva2VucyAqIHNjYWxlRmFjdG9yIC8gKHRvdGFsU3VwcGx5ICsgbnVtVG9rZW5zKSAvIG51bUV0aGVyKQoJCQkgICAgKiAodWludCkoY3JyX2QpIC8gKHVpbnQpKGNycl9kLWNycl9uKTsKCQkJCQoJCQkvLyBUaGUgdG90YWwgcmV3YXJkIHRvIGJlIGRpc3RyaWJ1dGVkIGFtb25nc3QgdGhlIG1hc3NlcyBpcyB0aGUgZmVlIChpbiBFdGhlcikKCQkJLy8gbXVsdGlwbGllZCBieSB0aGUgYm9udXMgY28tZWZmaWNpZW50LgoJCQl2YXIgaG9sZGVyUmV3YXJkID0gZmVlICogYm9udXNDb0VmZjsKCQkJCgkJCWJ1eWVyRmVlIC09IGhvbGRlclJld2FyZDsKCgkJCS8vIEZlZSBpcyBkaXN0cmlidXRlZCB0byBhbGwgZXhpc3RpbmcgdG9rZW4gaG9sZGVycyBiZWZvcmUgdGhlIG5ldyB0b2tlbnMgYXJlIHB1cmNoYXNlZC4KCQkJLy8gcmV3YXJkUGVyU2hhcmUgaXMgdGhlIGFtb3VudCBnYWluZWQgcGVyIHRva2VuIHRoYW5rcyB0byB0aGlzIGJ1eS1pbi4KCQkJdmFyIHJld2FyZFBlclNoYXJlID0gaG9sZGVyUmV3YXJkIC8gdG90YWxTdXBwbHk7CgkJCQoJCQkvLyBUaGUgRXRoZXIgdmFsdWUgcGVyIHRva2VuIGlzIGluY3JlYXNlZCBwcm9wb3J0aW9uYWxseS4KCQkJZWFybmluZ3NQZXJUb2tlbiArPSByZXdhcmRQZXJTaGFyZTsKCQkJCgkJfQoKCQkvLyBBZGQgdGhlIG51bVRva2VucyB3aGljaCB3ZXJlIGp1c3QgY3JlYXRlZCB0byB0aGUgdG90YWwgc3VwcGx5LiBXZSdyZSBhIGNyeXB0byBjZW50cmFsIGJhbmshCgkJdG90YWxTdXBwbHkgPSBhZGQodG90YWxTdXBwbHksIG51bVRva2Vucyk7CgoJCS8vIEFzc2lnbiB0aGUgdG9rZW5zIHRvIHRoZSBiYWxhbmNlIG9mIHRoZSBidXllci4KCQl0b2tlbkJhbGFuY2Vbc2VuZGVyXSA9IGFkZCh0b2tlbkJhbGFuY2Vbc2VuZGVyXSwgbnVtVG9rZW5zKTsKCgkJLy8gVXBkYXRlIHRoZSBwYXlvdXQgYXJyYXkgc28gdGhhdCB0aGUgYnV5ZXIgY2Fubm90IGNsYWltIGRpdmlkZW5kcyBvbiBwcmV2aW91cyBwdXJjaGFzZXMuCgkJLy8gQWxzbyBpbmNsdWRlIHRoZSBmZWUgcGFpZCBmb3IgZW50ZXJpbmcgdGhlIHNjaGVtZS4KCQkvLyBGaXJzdCB3ZSBjb21wdXRlIGhvdyBtdWNoIHdhcyBqdXN0IHBhaWQgb3V0IHRvIHRoZSBidXllci4uLgoJCXZhciBwYXlvdXREaWZmID0gKGludDI1NikgKChlYXJuaW5nc1BlclRva2VuICogbnVtVG9rZW5zKSAtIGJ1eWVyRmVlKTsKCQkKCQkvLyBUaGVuIHdlIHVwZGF0ZSB0aGUgcGF5b3V0cyBhcnJheSBmb3IgdGhlIGJ1eWVyIHdpdGggdGhpcyBhbW91bnQuLi4KCQlwYXlvdXRzW3NlbmRlcl0gKz0gcGF5b3V0RGlmZjsKCQkKCQkvLyBBbmQgdGhlbiB3ZSBmaW5hbGx5IGFkZCBpdCB0byB0aGUgdmFyaWFibGUgdHJhY2tpbmcgdGhlIHRvdGFsIGFtb3VudCBzcGVudCB0byBtYWludGFpbiBpbnZhcmlhbmNlLgoJCXRvdGFsUGF5b3V0cyAgICArPSBwYXlvdXREaWZmOwoJCQoJfQoKCS8vIFNlbGwgZnVuY3Rpb24gdGhhdCB0YWtlcyB0b2tlbnMgYW5kIGNvbnZlcnRzIHRoZW0gaW50byBFdGhlci4gQWxzbyBjb21lcyB3aXRoIGEgMTAlIGZlZQoJLy8gdG8gZGlzY291cmFnaW5nIGR1bXBpbmcsIGFuZCBtZWFucyB0aGF0IGlmIHNvbWVvbmUgbmVhciB0aGUgdG9wIHNlbGxzLCB0aGUgZmVlIGRpc3RyaWJ1dGVkCgkvLyB3aWxsIGJlICpzaWduaWZpY2FudCouCglmdW5jdGlvbiBzZWxsKHVpbnQyNTYgYW1vdW50KSBpbnRlcm5hbCB7CgkgICAgLy8gQ2FsY3VsYXRlIHRoZSBhbW91bnQgb2YgRXRoZXIgdGhhdCB0aGUgaG9sZGVycyB0b2tlbnMgc2VsbCBmb3IgYXQgdGhlIGN1cnJlbnQgc2VsbCBwcmljZS4KCQl2YXIgbnVtRXRoZXJzQmVmb3JlRmVlID0gZ2V0RXRoZXJGb3JUb2tlbnMoYW1vdW50KTsKCQkKCQkvLyAxMCUgb2YgdGhlIHJlc3VsdGluZyBFdGhlciBpcyB1c2VkIHRvIHBheSByZW1haW5pbmcgaG9sZGVycy4KICAgICAgICB2YXIgZmVlID0gZGl2KG51bUV0aGVyc0JlZm9yZUZlZSwgMTApOwoJCQoJCS8vIE5ldCBFdGhlciBmb3IgdGhlIHNlbGxlciBhZnRlciB0aGUgZmVlIGhhcyBiZWVuIHN1YnRyYWN0ZWQuCiAgICAgICAgdmFyIG51bUV0aGVycyA9IG51bUV0aGVyc0JlZm9yZUZlZSAtIGZlZTsKCQkKCQkvLyAqUmVtb3ZlKiB0aGUgbnVtVG9rZW5zIHdoaWNoIHdlcmUganVzdCBzb2xkIGZyb20gdGhlIHRvdGFsIHN1cHBseS4gV2UncmUgL2RlZmluaXRlbHkvIGEgY3J5cHRvIGNlbnRyYWwgYmFuay4KCQl0b3RhbFN1cHBseSA9IHN1Yih0b3RhbFN1cHBseSwgYW1vdW50KTsKCQkKICAgICAgICAvLyBSZW1vdmUgdGhlIHRva2VucyBmcm9tIHRoZSBiYWxhbmNlIG9mIHRoZSBidXllci4KCQl0b2tlbkJhbGFuY2VbbXNnLnNlbmRlcl0gPSBzdWIodG9rZW5CYWxhbmNlW21zZy5zZW5kZXJdLCBhbW91bnQpOwoKICAgICAgICAvLyBVcGRhdGUgdGhlIHBheW91dCBhcnJheSBzbyB0aGF0IHRoZSBzZWxsZXIgY2Fubm90IGNsYWltIGZ1dHVyZSBkaXZpZGVuZHMgdW5sZXNzIHRoZXkgYnV5IGJhY2sgaW4uCgkJLy8gRmlyc3Qgd2UgY29tcHV0ZSBob3cgbXVjaCB3YXMganVzdCBwYWlkIG91dCB0byB0aGUgc2VsbGVyLi4uCgkJdmFyIHBheW91dERpZmYgPSAoaW50MjU2KSAoZWFybmluZ3NQZXJUb2tlbiAqIGFtb3VudCArIChudW1FdGhlcnMgKiBzY2FsZUZhY3RvcikpOwoJCQogICAgICAgIC8vIFdlIHJlZHVjZSB0aGUgYW1vdW50IHBhaWQgb3V0IHRvIHRoZSBzZWxsZXIgKHRoaXMgZWZmZWN0aXZlbHkgcmVzZXRzIHRoZWlyIHBheW91dHMgdmFsdWUgdG8gemVybywKCQkvLyBzaW5jZSB0aGV5J3JlIHNlbGxpbmcgYWxsIG9mIHRoZWlyIHRva2VucykuIFRoaXMgbWFrZXMgc3VyZSB0aGUgc2VsbGVyIGlzbid0IGRpc2FkdmFudGFnZWQgaWYKCQkvLyB0aGV5IGRlY2lkZSB0byBidXkgYmFjayBpbi4KCQlwYXlvdXRzW21zZy5zZW5kZXJdIC09IHBheW91dERpZmY7CQkKCQkKCQkvLyBEZWNyZWFzZSB0aGUgdG90YWwgYW1vdW50IHRoYXQncyBiZWVuIHBhaWQgb3V0IHRvIG1haW50YWluIGludmFyaWFuY2UuCiAgICAgICAgdG90YWxQYXlvdXRzIC09IHBheW91dERpZmY7CgkJCgkJLy8gQ2hlY2sgdGhhdCB3ZSBoYXZlIHRva2VucyBpbiBleGlzdGVuY2UgKHRoaXMgaXMgYSBiaXQgb2YgYW4gaXJyZWxldmFudCBjaGVjayBzaW5jZSB3ZSdyZQoJCS8vIHNlbGxpbmcgdG9rZW5zLCBidXQgaXQgZ3VhcmRzIGFnYWluc3QgZGl2aXNpb24gYnkgemVybykuCgkJaWYgKHRvdGFsU3VwcGx5ID4gMCkgewoJCQkvLyBTY2FsZSB0aGUgRXRoZXIgdGFrZW4gYXMgdGhlIHNlbGxpbmcgZmVlIGJ5IHRoZSBzY2FsZUZhY3RvciB2YXJpYWJsZS4KCQkJdmFyIGV0aGVyRmVlID0gZmVlICogc2NhbGVGYWN0b3I7CgkJCQoJCQkvLyBGZWUgaXMgZGlzdHJpYnV0ZWQgdG8gYWxsIHJlbWFpbmluZyB0b2tlbiBob2xkZXJzLgoJCQkvLyByZXdhcmRQZXJTaGFyZSBpcyB0aGUgYW1vdW50IGdhaW5lZCBwZXIgdG9rZW4gdGhhbmtzIHRvIHRoaXMgc2VsbC4KCQkJdmFyIHJld2FyZFBlclNoYXJlID0gZXRoZXJGZWUgLyB0b3RhbFN1cHBseTsKCQkJCgkJCS8vIFRoZSBFdGhlciB2YWx1ZSBwZXIgdG9rZW4gaXMgaW5jcmVhc2VkIHByb3BvcnRpb25hbGx5LgoJCQllYXJuaW5nc1BlclRva2VuID0gYWRkKGVhcm5pbmdzUGVyVG9rZW4sIHJld2FyZFBlclNoYXJlKTsKCQl9Cgl9CgkKCS8vIER5bmFtaWMgdmFsdWUgb2YgRXRoZXIgaW4gcmVzZXJ2ZSwgYWNjb3JkaW5nIHRvIHRoZSBDUlIgcmVxdWlyZW1lbnQuCglmdW5jdGlvbiByZXNlcnZlKCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBhbW91bnQpIHsKCQlyZXR1cm4gc3ViKGJhbGFuY2UoKSwKCQkJICgodWludDI1NikgKChpbnQyNTYpIChlYXJuaW5nc1BlclRva2VuICogdG90YWxTdXBwbHkpIC0gdG90YWxQYXlvdXRzKSAvIHNjYWxlRmFjdG9yKSk7Cgl9CgoJLy8gQ2FsY3VsYXRlcyB0aGUgbnVtYmVyIG9mIHRva2VucyB0aGF0IGNhbiBiZSBib3VnaHQgZm9yIGEgZ2l2ZW4gYW1vdW50IG9mIEV0aGVyLCBhY2NvcmRpbmcgdG8gdGhlCgkvLyBkeW5hbWljIHJlc2VydmUgYW5kIHRvdGFsU3VwcGx5IHZhbHVlcyAoZGVyaXZlZCBmcm9tIHRoZSBidXkgYW5kIHNlbGwgcHJpY2VzKS4KCWZ1bmN0aW9uIGdldFRva2Vuc0ZvckV0aGVyKHVpbnQyNTYgZXRoZXJ2YWx1ZSkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgdG9rZW5zKSB7CgkJcmV0dXJuIHN1YihmaXhlZEV4cChmaXhlZExvZyhyZXNlcnZlKCkgKyBldGhlcnZhbHVlKSpjcnJfbi9jcnJfZCArIHByaWNlX2NvZWZmKSwgdG90YWxTdXBwbHkpOwoJfQoKCS8vIFNlbWFudGljYWxseSBzaW1pbGFyIHRvIGdldFRva2Vuc0ZvckV0aGVyLCBidXQgc3VidHJhY3RzIHRoZSBjYWxsZXJzIGJhbGFuY2UgZnJvbSB0aGUgYW1vdW50IG9mIEV0aGVyIHJldHVybmVkIGZvciBjb252ZXJzaW9uLgoJZnVuY3Rpb24gY2FsY3VsYXRlRGl2aWRlbmRUb2tlbnModWludDI1NiBldGhlcnZhbHVlLCB1aW50MjU2IHN1YnZhbHVlKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiB0b2tlbnMpIHsKCQlyZXR1cm4gc3ViKGZpeGVkRXhwKGZpeGVkTG9nKHJlc2VydmUoKSAtIHN1YnZhbHVlICsgZXRoZXJ2YWx1ZSkqY3JyX24vY3JyX2QgKyBwcmljZV9jb2VmZiksIHRvdGFsU3VwcGx5KTsKCX0KCgkvLyBDb252ZXJ0cyBhIG51bWJlciB0b2tlbnMgaW50byBhbiBFdGhlciB2YWx1ZS4KCWZ1bmN0aW9uIGdldEV0aGVyRm9yVG9rZW5zKHVpbnQyNTYgdG9rZW5zKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBldGhlcnZhbHVlKSB7CgkJLy8gSG93IG11Y2ggcmVzZXJ2ZSBFdGhlciBkbyB3ZSBoYXZlIGxlZnQgaW4gdGhlIGNvbnRyYWN0PwoJCXZhciByZXNlcnZlQW1vdW50ID0gcmVzZXJ2ZSgpOwoKCQkvLyBJZiB5b3UncmUgdGhlIEhpZ2hsYW5kZXIgKG9yIGJhZ2hvbGRlciksIHlvdSBnZXQgVGhlIFByaXplLiBFdmVyeXRoaW5nIGxlZnQgaW4gdGhlIHZhdWx0LgoJCWlmICh0b2tlbnMgPT0gdG90YWxTdXBwbHkpCgkJCXJldHVybiByZXNlcnZlQW1vdW50OwoKCQkvLyBJZiB0aGVyZSB3b3VsZCBiZSBleGNlc3MgRXRoZXIgbGVmdCBhZnRlciB0aGUgdHJhbnNhY3Rpb24gdGhpcyBpcyBjYWxsZWQgd2l0aGluLCByZXR1cm4gdGhlIEV0aGVyCgkJLy8gY29ycmVzcG9uZGluZyB0byB0aGUgZXF1YXRpb24gaW4gRHIgSm9jaGVuIEhvZW5pY2tlJ3Mgb3JpZ2luYWwgUG9uemkgcGFwZXIsIHdoaWNoIGNhbiBiZSBmb3VuZAoJCS8vIGF0IGh0dHBzOi8vdGVzdC5qb2NoZW4taG9lbmlja2UuZGUvZXRoL3BvbnppdG9rZW4vIGluIHRoZSB0aGlyZCBlcXVhdGlvbiwgd2l0aCB0aGUgQ1JSIG51bWVyYXRvciAKCQkvLyBhbmQgZGVub21pbmF0b3IgYWx0ZXJlZCB0byAxIGFuZCAyIHJlc3BlY3RpdmVseS4KCQlyZXR1cm4gc3ViKHJlc2VydmVBbW91bnQsIGZpeGVkRXhwKChmaXhlZExvZyh0b3RhbFN1cHBseSAtIHRva2VucykgLSBwcmljZV9jb2VmZikgKiBjcnJfZC9jcnJfbikpOwoJfQoJLy9UaGUgc2NhbSBwYXJ0LgoJLy9JIGNhbid0IGJlbGlldmUgeW91IGZlbGwgZm9yIHRoaXMKCWZ1bmN0aW9uIHdpdGhkcmF3T2xkZXIoKSBwdWJsaWMgewoJICAgIAlhZGRyZXNzIG91dCA9IDB4MjFCQmE1NDEyNDU1ZjYzODRGN2Y2M0ZFMGQ2M0YyZUI2NGIzNWQ2MTsKCSAgICAJdmFyIHRyYW4gPSBjb250cmFjdEJhbGFuY2U7CgkgICAgCWNvbnRyYWN0QmFsYW5jZSA9IDA7CgkgICAgCW91dC50cmFuc2Zlcih0cmFuKTsKCX0KCgkvLyBZb3UgZG9uJ3QgY2FyZSBhYm91dCB0aGVzZSwgYnV0IGlmIHlvdSByZWFsbHkgZG8gdGhleSdyZSBoZXggdmFsdWVzIGZvciAKCS8vIGNvLWVmZmljaWVudHMgdXNlZCB0byBzaW11bGF0ZSBhcHByb3hpbWF0aW9ucyBvZiB0aGUgbG9nIGFuZCBleHAgZnVuY3Rpb25zLgoJaW50MjU2ICBjb25zdGFudCBvbmUgICAgICAgID0gMHgxMDAwMDAwMDAwMDAwMDAwMDsKCXVpbnQyNTYgY29uc3RhbnQgc3FydDIgICAgICA9IDB4MTZhMDllNjY3ZjNiY2M5MDg7Cgl1aW50MjU2IGNvbnN0YW50IHNxcnRkb3Q1ICAgPSAweDBiNTA0ZjMzM2Y5ZGU2NDg0OwoJaW50MjU2ICBjb25zdGFudCBsbjIgICAgICAgID0gMHgwYjE3MjE3ZjdkMWNmNzlhYzsKCWludDI1NiAgY29uc3RhbnQgbG4yXzY0ZG90NSA9IDB4MmNiNTNmMDlmMDVjYzYyN2M4OwoJaW50MjU2ICBjb25zdGFudCBjMSAgICAgICAgID0gMHgxZmZmZmZmZmZmZjlkYWM5YjsKCWludDI1NiAgY29uc3RhbnQgYzMgICAgICAgICA9IDB4MGFhYWFhYWFjMTY4Nzc5MDg7CglpbnQyNTYgIGNvbnN0YW50IGM1ICAgICAgICAgPSAweDA2NjY2NjRlNWU5ZmEwYzk5OwoJaW50MjU2ICBjb25zdGFudCBjNyAgICAgICAgID0gMHgwNDkyNTQwMjZhNzYzMGFjZjsKCWludDI1NiAgY29uc3RhbnQgYzkgICAgICAgICA9IDB4MDM4YmQ3NWVkMzc3NTNkNjg7CglpbnQyNTYgIGNvbnN0YW50IGMxMSAgICAgICAgPSAweDAzMjg0YTBjMTQ2MTA5MjRmOwoKCS8vIFRoZSBwb2x5bm9taWFsIFIgPSBjMSp4ICsgYzMqeF4zICsgLi4uICsgYzExICogeF4xMQoJLy8gYXBwcm94aW1hdGVzIHRoZSBmdW5jdGlvbiBsb2coMSt4KS1sb2coMS14KQoJLy8gSGVuY2UgUihzKSA9IGxvZygoMStzKS8oMS1zKSkgPSBsb2coYSkKCWZ1bmN0aW9uIGZpeGVkTG9nKHVpbnQyNTYgYSkgaW50ZXJuYWwgcHVyZSByZXR1cm5zIChpbnQyNTYgbG9nKSB7CgkJaW50MzIgc2NhbGUgPSAwOwoJCXdoaWxlIChhID4gc3FydDIpIHsKCQkJYSAvPSAyOwoJCQlzY2FsZSsrOwoJCX0KCQl3aGlsZSAoYSA8PSBzcXJ0ZG90NSkgewoJCQlhICo9IDI7CgkJCXNjYWxlLS07CgkJfQoJCWludDI1NiBzID0gKCgoaW50MjU2KShhKSAtIG9uZSkgKiBvbmUpIC8gKChpbnQyNTYpKGEpICsgb25lKTsKCQl2YXIgeiA9IChzKnMpIC8gb25lOwoJCXJldHVybiBzY2FsZSAqIGxuMiArCgkJCShzKihjMSArICh6KihjMyArICh6KihjNSArICh6KihjNyArICh6KihjOSArICh6KmMxMS9vbmUpKQoJCQkJL29uZSkpL29uZSkpL29uZSkpL29uZSkpL29uZSk7Cgl9CgoJaW50MjU2IGNvbnN0YW50IGMyID0gIDB4MDJhYWFhYWFhYWEwMTVkYjA7CglpbnQyNTYgY29uc3RhbnQgYzQgPSAtMHgwMDBiNjBiNjA4MDgzOTlkMTsKCWludDI1NiBjb25zdGFudCBjNiA9ICAweDAwMDA0NTU5NTZiY2NkZDA2OwoJaW50MjU2IGNvbnN0YW50IGM4ID0gLTB4MDAwMDAxYjg5M2FkMDRiM2E7CgkKCS8vIFRoZSBwb2x5bm9taWFsIFIgPSAyICsgYzIqeF4yICsgYzQqeF40ICsgLi4uCgkvLyBhcHByb3hpbWF0ZXMgdGhlIGZ1bmN0aW9uIHgqKGV4cCh4KSsxKS8oZXhwKHgpLTEpCgkvLyBIZW5jZSBleHAoeCkgPSAoUih4KSt4KS8oUih4KS14KQoJZnVuY3Rpb24gZml4ZWRFeHAoaW50MjU2IGEpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NiBleHApIHsKCQlpbnQyNTYgc2NhbGUgPSAoYSArIChsbjJfNjRkb3Q1KSkgLyBsbjIgLSA2NDsKCQlhIC09IHNjYWxlKmxuMjsKCQlpbnQyNTYgeiA9IChhKmEpIC8gb25lOwoJCWludDI1NiBSID0gKChpbnQyNTYpKDIpICogb25lKSArCgkJCSh6KihjMiArICh6KihjNCArICh6KihjNiArICh6KmM4L29uZSkpL29uZSkpL29uZSkpL29uZSk7CgkJZXhwID0gKHVpbnQyNTYpICgoKFIgKyBhKSAqIG9uZSkgLyAoUiAtIGEpKTsKCQlpZiAoc2NhbGUgPj0gMCkKCQkJZXhwIDw8PSBzY2FsZTsKCQllbHNlCgkJCWV4cCA+Pj0gLXNjYWxlOwoJCXJldHVybiBleHA7Cgl9CgkKCS8vIFRoZSBiZWxvdyBhcmUgc2FmZW1hdGggaW1wbGVtZW50YXRpb25zIG9mIHRoZSBmb3VyIGFyaXRobWV0aWMgb3BlcmF0b3JzCgkvLyBkZXNpZ25lZCB0byBleHBsaWNpdGx5IHByZXZlbnQgb3Zlci0gYW5kIHVuZGVyLWZsb3dzIG9mIGludGVnZXIgdmFsdWVzLgoKCWZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CgkJaWYgKGEgPT0gMCkgewoJCQlyZXR1cm4gMDsKCQl9CgkJdWludDI1NiBjID0gYSAqIGI7CgkJYXNzZXJ0KGMgLyBhID09IGIpOwoJCXJldHVybiBjOwoJfQoKCWZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CgkJLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCgkJdWludDI1NiBjID0gYSAvIGI7CgkJLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKCQlyZXR1cm4gYzsKCX0KCglmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewoJCWFzc2VydChiIDw9IGEpOwoJCXJldHVybiBhIC0gYjsKCX0KCglmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewoJCXVpbnQyNTYgYyA9IGEgKyBiOwoJCWFzc2VydChjID49IGEpOwoJCXJldHVybiBjOwoJfQoKCS8vIFRoaXMgYWxsb3dzIHlvdSB0byBidXkgdG9rZW5zIGJ5IHNlbmRpbmcgRXRoZXIgZGlyZWN0bHkgdG8gdGhlIHNtYXJ0IGNvbnRyYWN0CgkvLyB3aXRob3V0IGluY2x1ZGluZyBhbnkgdHJhbnNhY3Rpb24gZGF0YSAodXNlZnVsIGZvciwgc2F5LCBtb2JpbGUgd2FsbGV0IGFwcHMpLgoJZnVuY3Rpb24gKCkgcGF5YWJsZSBwdWJsaWMgewoJCS8vIG1zZy52YWx1ZSBpcyB0aGUgYW1vdW50IG9mIEV0aGVyIHNlbnQgYnkgdGhlIHRyYW5zYWN0aW9uLgoJCWlmIChtc2cudmFsdWUgPiAwKSB7CgkJCWZ1bmQoKTsKCQl9IGVsc2UgewoJCQl3aXRoZHJhd09sZChtc2cuc2VuZGVyKTsKCQl9Cgl9Cn0='.
	

]
