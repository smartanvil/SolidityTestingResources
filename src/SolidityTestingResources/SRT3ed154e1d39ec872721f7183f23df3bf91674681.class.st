Class {
	#name : #SRT3ed154e1d39ec872721f7183f23df3bf91674681,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT3ed154e1d39ec872721f7183f23df3bf91674681 >> base64 [
	^ 'Ly9GaWxlOiBub2RlX21vZHVsZXMvZ2l2ZXRoLWNvbW1vbi1jb250cmFjdHMvY29udHJhY3RzL0VSQzIwLnNvbApwcmFnbWEgc29saWRpdHkgXjAuNC4xNTsKCgovKioKICogQHRpdGxlIEVSQzIwCiAqIEBkZXYgQSBzdGFuZGFyZCBpbnRlcmZhY2UgZm9yIHRva2Vucy4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9ibG9iL21hc3Rlci9FSVBTL2VpcC0yMC10b2tlbi1zdGFuZGFyZC5tZAogKi8KY29udHJhY3QgRVJDMjAgewogIAogICAgLy8vIEBkZXYgUmV0dXJucyB0aGUgdG90YWwgdG9rZW4gc3VwcGx5LgogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBzdXBwbHkpOwoKICAgIC8vLyBAZGV2IFJldHVybnMgdGhlIGFjY291bnQgYmFsYW5jZSBvZiBhbm90aGVyIGFjY291bnQgd2l0aCBhZGRyZXNzIF9vd25lci4KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7CgogICAgLy8vIEBkZXYgVHJhbnNmZXJzIF92YWx1ZSBhbW91bnQgb2YgdG9rZW5zIHRvIGFkZHJlc3MgX3RvCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8vLyBAZGV2IFRyYW5zZmVycyBfdmFsdWUgYW1vdW50IG9mIHRva2VucyBmcm9tIGFkZHJlc3MgX2Zyb20gdG8gYWRkcmVzcyBfdG8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8vLyBAZGV2IEFsbG93cyBfc3BlbmRlciB0byB3aXRoZHJhdyBmcm9tIHlvdXIgYWNjb3VudCBtdWx0aXBsZSB0aW1lcywgdXAgdG8gdGhlIF92YWx1ZSBhbW91bnQKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8vLyBAZGV2IFJldHVybnMgdGhlIGFtb3VudCB3aGljaCBfc3BlbmRlciBpcyBzdGlsbCBhbGxvd2VkIHRvIHdpdGhkcmF3IGZyb20gX293bmVyLgogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOwoKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7Cgp9Ci8vRmlsZTogbm9kZV9tb2R1bGVzL2dpdmV0aC1jb21tb24tY29udHJhY3RzL2NvbnRyYWN0cy9Pd25lZC5zb2wKcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgoKLy8vIEB0aXRsZSBPd25lZAovLy8gQGF1dGhvciBBZHJpJiMyMjQ7IE1hc3NhbmV0IDw8YSBocmVmPSIvY2RuLWNnaS9sL2VtYWlsLXByb3RlY3Rpb24iIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iODRlNWUwZjZlZGU1YzRlN2ViZTBlMWU3ZWJlYWYwZTFmY2YwYWFlZGViIj5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9hPj4KLy8vIEBub3RpY2UgVGhlIE93bmVkIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgCi8vLyAgYXV0aG9yaXphdGlvbiBjb250cm9sIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzICYgdGhlIGltcGxlbWVudGF0aW9uIG9mCi8vLyAgInVzZXIgcGVybWlzc2lvbnMiCmNvbnRyYWN0IE93bmVkIHsKCiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKICAgIGFkZHJlc3MgcHVibGljIG5ld093bmVyQ2FuZGlkYXRlOwoKICAgIGV2ZW50IE93bmVyc2hpcFJlcXVlc3RlZChhZGRyZXNzIGluZGV4ZWQgYnksIGFkZHJlc3MgaW5kZXhlZCB0byk7CiAgICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvKTsKICAgIGV2ZW50IE93bmVyc2hpcFJlbW92ZWQoKTsKCiAgICAvLy8gQGRldiBUaGUgY29uc3RydWN0b3Igc2V0cyB0aGUgYG1zZy5zZW5kZXJgIGFzIHRoZWBvd25lcmAgb2YgdGhlIGNvbnRyYWN0CiAgICBmdW5jdGlvbiBPd25lZCgpIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgLy8vIEBkZXYgYG93bmVyYCBpcyB0aGUgb25seSBhZGRyZXNzIHRoYXQgY2FuIGNhbGwgYSBmdW5jdGlvbiB3aXRoIHRoaXMKICAgIC8vLyBtb2RpZmllcgogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUgKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgLy8vIEBub3RpY2UgYG93bmVyYCBjYW4gc3RlcCBkb3duIGFuZCBhc3NpZ24gc29tZSBvdGhlciBhZGRyZXNzIHRvIHRoaXMgcm9sZQogICAgLy8vIEBwYXJhbSBfbmV3T3duZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIG5ldyBvd25lci4KICAgIGZ1bmN0aW9uIGNoYW5nZU93bmVyc2hpcChhZGRyZXNzIF9uZXdPd25lcikgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKF9uZXdPd25lciAhPSAweDApOwoKICAgICAgICBhZGRyZXNzIG9sZE93bmVyID0gb3duZXI7CiAgICAgICAgb3duZXIgPSBfbmV3T3duZXI7CiAgICAgICAgbmV3T3duZXJDYW5kaWRhdGUgPSAweDA7CgogICAgICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG9sZE93bmVyLCBvd25lcik7CiAgICB9CgogICAgLy8vIEBub3RpY2UgYG9ubHlPd25lcmAgUHJvcG9zZXMgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYQogICAgLy8vICBuZXcgb3duZXIKICAgIC8vLyBAcGFyYW0gX25ld093bmVyQ2FuZGlkYXRlIFRoZSBhZGRyZXNzIGJlaW5nIHByb3Bvc2VkIGFzIHRoZSBuZXcgb3duZXIKICAgIGZ1bmN0aW9uIHByb3Bvc2VPd25lcnNoaXAoYWRkcmVzcyBfbmV3T3duZXJDYW5kaWRhdGUpIG9ubHlPd25lciB7CiAgICAgICAgbmV3T3duZXJDYW5kaWRhdGUgPSBfbmV3T3duZXJDYW5kaWRhdGU7CiAgICAgICAgT3duZXJzaGlwUmVxdWVzdGVkKG1zZy5zZW5kZXIsIG5ld093bmVyQ2FuZGlkYXRlKTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBDYW4gb25seSBiZSBjYWxsZWQgYnkgdGhlIGBuZXdPd25lckNhbmRpZGF0ZWAsIGFjY2VwdHMgdGhlCiAgICAvLy8gIHRyYW5zZmVyIG9mIG93bmVyc2hpcAogICAgZnVuY3Rpb24gYWNjZXB0T3duZXJzaGlwKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBuZXdPd25lckNhbmRpZGF0ZSk7CgogICAgICAgIGFkZHJlc3Mgb2xkT3duZXIgPSBvd25lcjsKICAgICAgICBvd25lciA9IG5ld093bmVyQ2FuZGlkYXRlOwogICAgICAgIG5ld093bmVyQ2FuZGlkYXRlID0gMHgwOwoKICAgICAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvbGRPd25lciwgb3duZXIpOwogICAgfQoKICAgIC8vLyBAbm90aWNlIERlY2VudHJhbGl6ZXMgdGhlIGNvbnRyYWN0LCB0aGlzIG9wZXJhdGlvbiBjYW5ub3QgYmUgdW5kb25lIAogICAgLy8vIEBwYXJhbSBfZGFjIGAweGRhY2AgaGFzIHRvIGJlIGVudGVyZWQgZm9yIHRoaXMgZnVuY3Rpb24gdG8gd29yawogICAgZnVuY3Rpb24gcmVtb3ZlT3duZXJzaGlwKGFkZHJlc3MgX2RhYykgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKF9kYWMgPT0gMHhkYWMpOwogICAgICAgIG93bmVyID0gMHgwOwogICAgICAgIG5ld093bmVyQ2FuZGlkYXRlID0gMHgwOwogICAgICAgIE93bmVyc2hpcFJlbW92ZWQoKTsgICAgIAogICAgfQoKfSAKCi8vRmlsZTogbm9kZV9tb2R1bGVzL2dpdmV0aC1jb21tb24tY29udHJhY3RzL2NvbnRyYWN0cy9Fc2NhcGFibGUuc29sCi8qCiAgICBDb3B5cmlnaHQgMjAxNiwgSm9yZGkgQmF5bGluYQogICAgQ29udHJpYnV0b3I6IEFkcmkmIzIyNDsgTWFzc2FuZXQgPDxhIGhyZWY9Ii9jZG4tY2dpL2wvZW1haWwtcHJvdGVjdGlvbiIgY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSIxODc5N2M2YTcxNzk1ODdiNzc3YzdkN2I3Nzc2NmM3ZDYwNmMzNjcxNzciPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+PgoKICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAgICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQogICAgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3IKICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgogICAgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCiAgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgogICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQogICAgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KCiAgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQogICAgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0uICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCiovCgpwcmFnbWEgc29saWRpdHkgXjAuNC4xNTsKCgoKCgovLy8gQGRldiBgRXNjYXBhYmxlYCBpcyBhIGJhc2UgbGV2ZWwgY29udHJhY3QgYnVpbHQgb2ZmIG9mIHRoZSBgT3duZWRgCi8vLyAgY29udHJhY3QgdGhhdCBjcmVhdGVzIGFuIGVzY2FwZSBoYXRjaCBmdW5jdGlvbiB0byBzZW5kIGl0cyBldGhlciB0bwovLy8gIGBlc2NhcGVIYXRjaERlc3RpbmF0aW9uYCB3aGVuIGNhbGxlZCBieSB0aGUgYGVzY2FwZUhhdGNoQ2FsbGVyYCBpbiB0aGUgY2FzZSB0aGF0Ci8vLyAgc29tZXRoaW5nIHVuZXhwZWN0ZWQgaGFwcGVucwpjb250cmFjdCBFc2NhcGFibGUgaXMgT3duZWQgewogICAgYWRkcmVzcyBwdWJsaWMgZXNjYXBlSGF0Y2hDYWxsZXI7CiAgICBhZGRyZXNzIHB1YmxpYyBlc2NhcGVIYXRjaERlc3RpbmF0aW9uOwogICAgbWFwcGluZyAoYWRkcmVzcz0+Ym9vbCkgcHJpdmF0ZSBlc2NhcGVCbGFja2xpc3Q7CgogICAgLy8vIEBub3RpY2UgVGhlIENvbnN0cnVjdG9yIGFzc2lnbnMgdGhlIGBlc2NhcGVIYXRjaERlc3RpbmF0aW9uYCBhbmQgdGhlCiAgICAvLy8gIGBlc2NhcGVIYXRjaENhbGxlcmAKICAgIC8vLyBAcGFyYW0gX2VzY2FwZUhhdGNoRGVzdGluYXRpb24gVGhlIGFkZHJlc3Mgb2YgYSBzYWZlIGxvY2F0aW9uICh1c3UgYQogICAgLy8vICBNdWx0aXNpZykgdG8gc2VuZCB0aGUgZXRoZXIgaGVsZCBpbiB0aGlzIGNvbnRyYWN0CiAgICAvLy8gQHBhcmFtIF9lc2NhcGVIYXRjaENhbGxlciBUaGUgYWRkcmVzcyBvZiBhIHRydXN0ZWQgYWNjb3VudCBvciBjb250cmFjdCB0bwogICAgLy8vICBjYWxsIGBlc2NhcGVIYXRjaCgpYCB0byBzZW5kIHRoZSBldGhlciBpbiB0aGlzIGNvbnRyYWN0IHRvIHRoZQogICAgLy8vICBgZXNjYXBlSGF0Y2hEZXN0aW5hdGlvbmAgaXQgd291bGQgYmUgaWRlYWwgdGhhdCBgZXNjYXBlSGF0Y2hDYWxsZXJgIGNhbm5vdCBtb3ZlCiAgICAvLy8gIGZ1bmRzIG91dCBvZiBgZXNjYXBlSGF0Y2hEZXN0aW5hdGlvbmAKICAgIGZ1bmN0aW9uIEVzY2FwYWJsZShhZGRyZXNzIF9lc2NhcGVIYXRjaENhbGxlciwgYWRkcmVzcyBfZXNjYXBlSGF0Y2hEZXN0aW5hdGlvbikgewogICAgICAgIGVzY2FwZUhhdGNoQ2FsbGVyID0gX2VzY2FwZUhhdGNoQ2FsbGVyOwogICAgICAgIGVzY2FwZUhhdGNoRGVzdGluYXRpb24gPSBfZXNjYXBlSGF0Y2hEZXN0aW5hdGlvbjsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5RXNjYXBlSGF0Y2hDYWxsZXJPck93bmVyIHsKICAgICAgICByZXF1aXJlICgobXNnLnNlbmRlciA9PSBlc2NhcGVIYXRjaENhbGxlcil8fChtc2cuc2VuZGVyID09IG93bmVyKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBUaGUgYGJsYWNrbGlzdEVzY2FwZVRva2VucygpYCBtYXJrcyBhIHRva2VuIGluIGEgd2hpdGVsaXN0IHRvIGJlCiAgICAvLy8gICBlc2NhcGVkLiBUaGUgcHJvdXBvc2UgaXMgdG8gYmUgZG9uZSBhdCBjb25zdHJ1Y3Rpb24gdGltZS4KICAgIC8vLyBAcGFyYW0gX3Rva2VuIHRoZSBiZSBibG9hY2tsaXN0ZWQgZm9yIGVzY2FwZQogICAgZnVuY3Rpb24gYmxhY2tsaXN0RXNjYXBlVG9rZW4oYWRkcmVzcyBfdG9rZW4pIGludGVybmFsIHsKICAgICAgICBlc2NhcGVCbGFja2xpc3RbX3Rva2VuXSA9IHRydWU7CiAgICAgICAgRXNjYXBlSGF0Y2hCbGFja2lzdGVkVG9rZW4oX3Rva2VuKTsKICAgIH0KCiAgICBmdW5jdGlvbiBpc1Rva2VuRXNjYXBhYmxlKGFkZHJlc3MgX3Rva2VuKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiAhZXNjYXBlQmxhY2tsaXN0W190b2tlbl07CiAgICB9CgogICAgLy8vIEBub3RpY2UgVGhlIGBlc2NhcGVIYXRjaCgpYCBzaG91bGQgb25seSBiZSBjYWxsZWQgYXMgYSBsYXN0IHJlc29ydCBpZiBhCiAgICAvLy8gc2VjdXJpdHkgaXNzdWUgaXMgdW5jb3ZlcmVkIG9yIHNvbWV0aGluZyB1bmV4cGVjdGVkIGhhcHBlbmVkCiAgICAvLy8gQHBhcmFtIF90b2tlbiB0byB0cmFuc2ZlciwgdXNlIDB4MCBmb3IgZXRoZXJzCiAgICBmdW5jdGlvbiBlc2NhcGVIYXRjaChhZGRyZXNzIF90b2tlbikgcHVibGljIG9ubHlFc2NhcGVIYXRjaENhbGxlck9yT3duZXIgeyAgIAogICAgICAgIHJlcXVpcmUoZXNjYXBlQmxhY2tsaXN0W190b2tlbl09PWZhbHNlKTsKCiAgICAgICAgdWludDI1NiBiYWxhbmNlOwoKICAgICAgICBpZiAoX3Rva2VuID09IDB4MCkgewogICAgICAgICAgICBiYWxhbmNlID0gdGhpcy5iYWxhbmNlOwogICAgICAgICAgICBlc2NhcGVIYXRjaERlc3RpbmF0aW9uLnRyYW5zZmVyKGJhbGFuY2UpOwogICAgICAgICAgICBFc2NhcGVIYXRjaENhbGxlZChfdG9rZW4sIGJhbGFuY2UpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBFUkMyMCB0b2tlbiA9IEVSQzIwKF90b2tlbik7CiAgICAgICAgYmFsYW5jZSA9IHRva2VuLmJhbGFuY2VPZih0aGlzKTsKICAgICAgICB0b2tlbi50cmFuc2Zlcihlc2NhcGVIYXRjaERlc3RpbmF0aW9uLCBiYWxhbmNlKTsKICAgICAgICBFc2NhcGVIYXRjaENhbGxlZChfdG9rZW4sIGJhbGFuY2UpOwogICAgfQoKICAgIC8vLyBAbm90aWNlIENoYW5nZXMgdGhlIGFkZHJlc3MgYXNzaWduZWQgdG8gY2FsbCBgZXNjYXBlSGF0Y2goKWAKICAgIC8vLyBAcGFyYW0gX25ld0VzY2FwZUhhdGNoQ2FsbGVyIFRoZSBhZGRyZXNzIG9mIGEgdHJ1c3RlZCBhY2NvdW50IG9yIGNvbnRyYWN0IHRvCiAgICAvLy8gIGNhbGwgYGVzY2FwZUhhdGNoKClgIHRvIHNlbmQgdGhlIGV0aGVyIGluIHRoaXMgY29udHJhY3QgdG8gdGhlCiAgICAvLy8gIGBlc2NhcGVIYXRjaERlc3RpbmF0aW9uYCBpdCB3b3VsZCBiZSBpZGVhbCB0aGF0IGBlc2NhcGVIYXRjaENhbGxlcmAgY2Fubm90CiAgICAvLy8gIG1vdmUgZnVuZHMgb3V0IG9mIGBlc2NhcGVIYXRjaERlc3RpbmF0aW9uYAogICAgZnVuY3Rpb24gY2hhbmdlSGF0Y2hFc2NhcGVDYWxsZXIoYWRkcmVzcyBfbmV3RXNjYXBlSGF0Y2hDYWxsZXIpIG9ubHlFc2NhcGVIYXRjaENhbGxlck9yT3duZXIgewogICAgICAgIGVzY2FwZUhhdGNoQ2FsbGVyID0gX25ld0VzY2FwZUhhdGNoQ2FsbGVyOwogICAgfQoKICAgIGV2ZW50IEVzY2FwZUhhdGNoQmxhY2tpc3RlZFRva2VuKGFkZHJlc3MgdG9rZW4pOwogICAgZXZlbnQgRXNjYXBlSGF0Y2hDYWxsZWQoYWRkcmVzcyB0b2tlbiwgdWludCBhbW91bnQpOwp9CgovL0ZpbGU6IC4vY29udHJhY3RzL1dpdGhkcmF3Q29udHJhY3Quc29sCnByYWdtYSBzb2xpZGl0eSBeMC40LjE4OwovKgogICAgQ29weXJpZ2h0IDIwMTcsIEpvcmRpIEJheWxpbmEKCiAgICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQogICAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKICAgIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCiAgICAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgoKICAgIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAogICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKICAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKICAgIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCgogICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKICAgIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgoqLwoKCi8vLyBAZGV2IFRoaXMgZGVjbGFyZXMgYSBmZXcgZnVuY3Rpb25zIGZyb20gYE1pbmlNZVRva2VuYCBzbyB0aGF0IHRoZQovLy8gIGBXaXRoZHJhd0NvbnRyYWN0YCBjYW4gaW50ZXJmYWNlIHdpdGggdGhlIGBNaW5pTWVUb2tlbmAKY29udHJhY3QgTWluaU1lVG9rZW4gewogICAgZnVuY3Rpb24gYmFsYW5jZU9mQXQoYWRkcmVzcyBfb3duZXIsIHVpbnQgX2Jsb2NrTnVtYmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludCk7CiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseUF0KHVpbnQgX2Jsb2NrTnVtYmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50KTsKfQoKCgoKLy8vIEBkZXYgVGhpcyBpcyB0aGUgbWFpbiBjb250cmFjdCwgaXQgaXMgaW50ZW5kZWQgdG8gZGlzdHJpYnV0ZSBkZXBvc2l0ZWQgZnVuZHMKLy8vICBmcm9tIGEgVFJVU1RFRCBgb3duZXJgIHRvIHRva2VuIGhvbGRlcnMgb2YgYSBNaW5pTWUgc3R5bGUgRVJDLTIwIFRva2VuOwovLy8gIG9ubHkgZGVwb3NpdHMgZnJvbSB0aGUgYG93bmVyYCB1c2luZyB0aGUgZnVuY3Rpb25zIGBuZXdUb2tlblBheW1lbnQoKWAgJgovLy8gIGBuZXdFdGhlclBheW1lbnQoKWAgd2lsbCBiZSBkaXN0cmlidXRlZCwgYW55IG90aGVyIGZ1bmRzIHNlbnQgdG8gdGhpcwovLy8gIGNvbnRyYWN0IGNhbiBvbmx5IGJlIHJlbW92ZWQgdmlhIHRoZSBgZXNjYXBlSGF0Y2goKWAKY29udHJhY3QgV2l0aGRyYXdDb250cmFjdCBpcyBFc2NhcGFibGUgewoKICAgIC8vLyBAZGV2IFRyYWNrcyB0aGUgZGVwb3NpdHMgbWFkZSB0byB0aGlzIGNvbnRyYWN0CiAgICBzdHJ1Y3QgRGVwb3NpdCB7CiAgICAgICAgdWludCBibG9jazsgICAgLy8gRGV0ZXJtaW5lcyB3aGljaCB0b2tlbiBob2xkZXJzIGFyZSBhYmxlIHRvIGNvbGxlY3QKICAgICAgICBFUkMyMCB0b2tlbjsgICAvLyBUaGUgdG9rZW4gYWRkcmVzcyAoMHgwIGlmIGV0aGVyKQogICAgICAgIHVpbnQgYW1vdW50OyAgIC8vIFRoZSBhbW91bnQgZGVwb3NpdGVkIGluIHRoZSBzbWFsbGVzdCB1bml0ICh3ZWkgaWYgRVRIKQogICAgICAgIGJvb2wgY2FuY2VsZWQ7IC8vIFRydWUgaWYgY2FuY2VsZWQgYnkgdGhlIGBvd25lcmAKICAgIH0KCiAgICBEZXBvc2l0W10gcHVibGljIGRlcG9zaXRzOyAvLyBBcnJheSBvZiBkZXBvc2l0cyB0byB0aGlzIGNvbnRyYWN0CiAgICBNaW5pTWVUb2tlbiByZXdhcmRUb2tlbjsgICAgIC8vIFRva2VuIHRoYXQgaXMgdXNlZCBmb3Igd2l0aGRyYXdzCgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgbmV4dERlcG9zaXRUb1BheW91dDsgLy8gVHJhY2tzIFBheW91dHMKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyh1aW50ID0+IGJvb2wpKSBza2lwRGVwb3NpdHM7CgovLy8vLy8vLy8KLy8gQ29uc3RydWN0b3IKLy8vLy8vLy8vCgogICAgLy8vIEBub3RpY2UgVGhlIENvbnN0cnVjdG9yIGNyZWF0ZXMgdGhlIGBXaXRoZHJhd0NvbnRyYWN0YCBvbiB0aGUgYmxvY2tjaGFpbgogICAgLy8vICB0aGUgYG93bmVyYCByb2xlIGlzIGFzc2lnbmVkIHRvIHRoZSBhZGRyZXNzIHRoYXQgZGVwbG95cyB0aGlzIGNvbnRyYWN0CiAgICAvLy8gQHBhcmFtIF9yZXdhcmRUb2tlbiBUaGUgYWRkcmVzcyBvZiB0aGUgdG9rZW4gdGhhdCBpcyB1c2VkIHRvIGRldGVybWluZSB0aGUKICAgIC8vLyAgZGlzdHJpYnV0aW9uIG9mIHRoZSBkZXBvc2l0cyBhY2NvcmRpbmcgdG8gdGhlIGJhbGFuY2UgaGVsZCBhdCB0aGUKICAgIC8vLyAgZGVwb3NpdCdzIHNwZWNpZmllZCBgYmxvY2tgCiAgICAvLy8gQHBhcmFtIF9lc2NhcGVIYXRjaENhbGxlciBUaGUgYWRkcmVzcyBvZiBhIHRydXN0ZWQgYWNjb3VudCBvciBjb250cmFjdAogICAgLy8vICB0byBjYWxsIGBlc2NhcGVIYXRjaCgpYCB0byBzZW5kIHRoZSBzcGVjaWZpZWQgdG9rZW4gKG9yIGV0aGVyKSBoZWxkIGluCiAgICAvLy8gIHRoaXMgY29udHJhY3QgdG8gdGhlIGBlc2NhcGVIYXRjaERlc3RpbmF0aW9uYAogICAgLy8vIEBwYXJhbSBfZXNjYXBlSGF0Y2hEZXN0aW5hdGlvbiBUaGUgYWRkcmVzcyBvZiBhIHNhZmUgbG9jYXRpb24gKHVzdSBhCiAgICAvLy8gIE11bHRpc2lnKSB0byBzZW5kIHRoZSBldGhlciBhbmQgdG9rZW5zIGhlbGQgaW4gdGhpcyBjb250cmFjdCB3aGVuIHRoZQogICAgLy8vICBgZXNjYXBlSGF0Y2goKWAgaXMgY2FsbGVkCiAgICBmdW5jdGlvbiBXaXRoZHJhd0NvbnRyYWN0KAogICAgICAgIE1pbmlNZVRva2VuIF9yZXdhcmRUb2tlbiwKICAgICAgICBhZGRyZXNzIF9lc2NhcGVIYXRjaENhbGxlciwKICAgICAgICBhZGRyZXNzIF9lc2NhcGVIYXRjaERlc3RpbmF0aW9uKQogICAgICAgIEVzY2FwYWJsZShfZXNjYXBlSGF0Y2hDYWxsZXIsIF9lc2NhcGVIYXRjaERlc3RpbmF0aW9uKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIHJld2FyZFRva2VuID0gX3Jld2FyZFRva2VuOwogICAgfQoKICAgIC8vLyBAZGV2IFdoZW4gZXRoZXIgaXMgc2VudCB0byB0aGlzIGNvbnRyYWN0IGBuZXdFdGhlckRlcG9zaXQoKWAgaXMgY2FsbGVkCiAgICBmdW5jdGlvbiAoKSBwYXlhYmxlIHB1YmxpYyB7CiAgICAgICAgbmV3RXRoZXJEZXBvc2l0KDApOwogICAgfQovLy8vLy8vLy8KLy8gT3duZXIgRnVuY3Rpb25zCi8vLy8vLy8vLwoKICAgIC8vLyBAbm90aWNlIEFkZHMgYW4gZXRoZXIgZGVwb3NpdCB0byBgZGVwb3NpdHNbXWA7IG9ubHkgdGhlIGBvd25lcmAgY2FuCiAgICAvLy8gIGRlcG9zaXQgaW50byB0aGlzIGNvbnRyYWN0CiAgICAvLy8gQHBhcmFtIF9ibG9jayBUaGUgYmxvY2sgaGVpZ2h0IHRoYXQgZGV0ZXJtaW5lcyB0aGUgc25hcHNob3Qgb2YgdG9rZW4KICAgIC8vLyAgaG9sZGVycyB0aGF0IHdpbGwgYmUgYWJsZSB0byB3aXRoZHJhdyB0aGVpciBzaGFyZSBvZiB0aGlzIGRlcG9zaXQ7IHRoaXMKICAgIC8vLyAgYmxvY2sgbXVzdCBiZSBzZXQgaW4gdGhlIHBhc3QsIGlmIDAgaXQgZGVmYXVsdHMgdG8gb25lIGJsb2NrIGJlZm9yZSB0aGUKICAgIC8vLyAgdHJhbnNhY3Rpb24KICAgIC8vLyBAcmV0dXJuIF9pZERlcG9zaXQgVGhlIGlkIG51bWJlciBmb3IgdGhlIGRlcG9zaXQKICAgIGZ1bmN0aW9uIG5ld0V0aGVyRGVwb3NpdCh1aW50IF9ibG9jaykKICAgICAgICBwdWJsaWMgb25seU93bmVyIHBheWFibGUKICAgICAgICByZXR1cm5zICh1aW50IF9pZERlcG9zaXQpCiAgICB7CiAgICAgICAgcmVxdWlyZShtc2cudmFsdWU+MCk7CiAgICAgICAgcmVxdWlyZShfYmxvY2sgPCBibG9jay5udW1iZXIpOwogICAgICAgIF9pZERlcG9zaXQgPSBkZXBvc2l0cy5sZW5ndGggKys7CgogICAgICAgIC8vIFJlY29yZCB0aGUgZGVwb3NpdAogICAgICAgIERlcG9zaXQgc3RvcmFnZSBkID0gZGVwb3NpdHNbX2lkRGVwb3NpdF07CiAgICAgICAgZC5ibG9jayA9IF9ibG9jayA9PSAwID8gYmxvY2subnVtYmVyIC0xIDogX2Jsb2NrOwogICAgICAgIGQudG9rZW4gPSBFUkMyMCgwKTsKICAgICAgICBkLmFtb3VudCA9IG1zZy52YWx1ZTsKICAgICAgICBOZXdEZXBvc2l0KF9pZERlcG9zaXQsIEVSQzIwKDApLCBtc2cudmFsdWUpOwogICAgfQoKICAgIC8vLyBAbm90aWNlIEFkZHMgYSB0b2tlbiBkZXBvc2l0IHRvIGBkZXBvc2l0c1tdYDsgb25seSB0aGUgYG93bmVyYCBjYW4KICAgIC8vLyAgY2FsbCB0aGlzIGZ1bmN0aW9uIGFuZCBpdCB3aWxsIG9ubHkgd29yayBpZiB0aGUgYWNjb3VudCBzZW5kaW5nIHRoZQogICAgLy8vICB0b2tlbnMgaGFzIGNhbGxlZCBgYXBwcm92ZSgpYCBzbyB0aGF0IHRoaXMgY29udHJhY3QgY2FuIGNhbGwKICAgIC8vLyAgYHRyYW5zZmVyRnJvbSgpYCBhbmQgdGFrZSB0aGUgdG9rZW5zCiAgICAvLy8gQHBhcmFtIF90b2tlbiBUaGUgYWRkcmVzcyBmb3IgdGhlIEVSQzIwIHRoYXQgaXMgYmVpbmcgZGVwb3NpdGVkCiAgICAvLy8gQHBhcmFtIF9hbW91bnQgVGhlIHF1YW50aXR5IG9mIHRva2VucyB0aGF0IGlzIGRlcG9zaXRlZCBpbnRvIHRoZQogICAgLy8vICBjb250cmFjdCBpbiB0aGUgc21hbGxlc3QgdW5pdCBvZiB0b2tlbnMgKGlmIGEgdG9rZW4gaGFzIGl0cyBkZWNpbWFscwogICAgLy8vICBzZXQgdG8gMTggYW5kIDEgdG9rZW4gaXMgc2VudCwgdGhlIGBfYW1vdW50YCB3b3VsZCBiZSAxMF4xOCkKICAgIC8vLyBAcGFyYW0gX2Jsb2NrIFRoZSBibG9jayBoZWlnaHQgdGhhdCBkZXRlcm1pbmVzIHRoZSBzbmFwc2hvdCBvZiB0b2tlbgogICAgLy8vICBob2xkZXJzIHRoYXQgd2lsbCBiZSBhYmxlIHRvIHdpdGhkcmF3IHRoZWlyIHNoYXJlIG9mIHRoaXMgZGVwb3NpdDsgdGhpcwogICAgLy8vICBibG9jayBtdXN0IGJlIHNldCBpbiB0aGUgcGFzdCwgaWYgMCBpdCBkZWZhdWx0cyB0byBvbmUgYmxvY2sgYmVmb3JlIHRoZQogICAgLy8vICB0cmFuc2FjdGlvbgogICAgLy8vIEByZXR1cm4gX2lkRGVwb3NpdCBUaGUgaWQgbnVtYmVyIGZvciB0aGUgZGVwb3NpdAogICAgZnVuY3Rpb24gbmV3VG9rZW5EZXBvc2l0KEVSQzIwIF90b2tlbiwgdWludCBfYW1vdW50LCB1aW50IF9ibG9jaykKICAgICAgICBwdWJsaWMgb25seU93bmVyCiAgICAgICAgcmV0dXJucyAodWludCBfaWREZXBvc2l0KQogICAgewogICAgICAgIHJlcXVpcmUoX2Ftb3VudCA+IDApOwogICAgICAgIHJlcXVpcmUoX2Jsb2NrIDwgYmxvY2subnVtYmVyKTsKCiAgICAgICAgLy8gTXVzdCBgYXBwcm92ZSgpYCB0aGlzIGNvbnRyYWN0IGluIGEgcHJldmlvdXMgdHJhbnNhY3Rpb24KICAgICAgICByZXF1aXJlKCBfdG9rZW4udHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIGFkZHJlc3ModGhpcyksIF9hbW91bnQpICk7CiAgICAgICAgX2lkRGVwb3NpdCA9IGRlcG9zaXRzLmxlbmd0aCArKzsKCiAgICAgICAgLy8gUmVjb3JkIHRoZSBkZXBvc2l0CiAgICAgICAgRGVwb3NpdCBzdG9yYWdlIGQgPSBkZXBvc2l0c1tfaWREZXBvc2l0XTsKICAgICAgICBkLmJsb2NrID0gX2Jsb2NrID09IDAgPyBibG9jay5udW1iZXIgLTEgOiBfYmxvY2s7CiAgICAgICAgZC50b2tlbiA9IF90b2tlbjsKICAgICAgICBkLmFtb3VudCA9IF9hbW91bnQ7CiAgICAgICAgTmV3RGVwb3NpdChfaWREZXBvc2l0LCBfdG9rZW4sIF9hbW91bnQpOwogICAgfQoKICAgIC8vLyBAbm90aWNlIFRoaXMgZnVuY3Rpb24gaXMgYSBmYWlsc2FmZSBmdW5jdGlvbiBpbiBjYXNlIGEgdG9rZW4gaXMKICAgIC8vLyAgZGVwb3NpdGVkIHRoYXQgaGFzIGFuIGlzc3VlIHRoYXQgY291bGQgcHJldmVudCBpdCdzIHdpdGhkcmF3IGxvb3AgYnJlYWsKICAgIC8vLyAgKGUuZy4gdHJhbnNmZXJzIGFyZSBkaXNhYmxlZCksIGNhbiBvbmx5IGJlIGNhbGxlZCBieSB0aGUgYG93bmVyYAogICAgLy8vIEBwYXJhbSBfaWREZXBvc2l0IFRoZSBpZCBudW1iZXIgZm9yIHRoZSBkZXBvc2l0IGJlaW5nIGNhbmNlbGVkCiAgICBmdW5jdGlvbiBjYW5jZWxQYXltZW50R2xvYmFsbHkodWludCBfaWREZXBvc2l0KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKF9pZERlcG9zaXQgPCBkZXBvc2l0cy5sZW5ndGgpOwogICAgICAgIGRlcG9zaXRzW19pZERlcG9zaXRdLmNhbmNlbGVkID0gdHJ1ZTsKICAgICAgICBDYW5jZWxQYXltZW50R2xvYmFsbHkoX2lkRGVwb3NpdCk7CiAgICB9CgovLy8vLy8vLy8KLy8gUHVibGljIEZ1bmN0aW9ucwovLy8vLy8vLy8KICAgIC8vLyBAbm90aWNlIFNlbmRzIGFsbCB0aGUgdG9rZW5zIGFuZCBldGhlciB0byB0aGUgdG9rZW4gaG9sZGVyIGJ5IGxvb3BpbmcKICAgIC8vLyAgdGhyb3VnaCBhbGwgdGhlIGRlcG9zaXRzLCBkZXRlcm1pbmluZyB0aGUgYXBwcm9wcmlhdGUgYW1vdW50IGJ5CiAgICAvLy8gIGRpdmlkaW5nIHRoZSBgdG90YWxTdXBwbHlgIGJ5IHRoZSBudW1iZXIgb2YgdG9rZW5zIHRoZSB0b2tlbiBob2xkZXIgaGFkCiAgICAvLy8gIGF0IGBkZXBvc2l0LmJsb2NrYCBmb3IgZWFjaCBkZXBvc2l0OyB0aGlzIGZ1bmN0aW9uIG1heSBoYXZlIHRvIGJlCiAgICAvLy8gIGNhbGxlZCBtdWx0aXBsZSB0aW1lcyBpZiB0aGVpciBhcmUgbWFueSBkZXBvc2l0cwogICAgZnVuY3Rpb24gd2l0aGRyYXcoKSBwdWJsaWMgewogICAgICAgIHVpbnQgYWNjID0gMDsgLy8gQWNjdW11bGF0ZXMgdGhlIGFtb3VudCBvZiB0b2tlbnMvZXRoZXIgdG8gYmUgc2VudAogICAgICAgIHVpbnQgaSA9IG5leHREZXBvc2l0VG9QYXlvdXRbbXNnLnNlbmRlcl07IC8vIEl0ZXJhdGVzIHRocm91Z2ggdGhlIGRlcG9zaXRzCiAgICAgICAgcmVxdWlyZShpPGRlcG9zaXRzLmxlbmd0aCk7CiAgICAgICAgRVJDMjAgY3VycmVudFRva2VuID0gZGVwb3NpdHNbaV0udG9rZW47IC8vIFNldHMgdGhlIGBjdXJyZW50VG9rZW5gIHRvIGV0aGVyCgogICAgICAgIHJlcXVpcmUobXNnLmdhcz4xNDkwMDApOyAvLyBUaHJvd3MgaWYgdGhlcmUgaXMgbm8gZ2FzIHRvIGRvIGF0IGxlYXN0IGEgc2luZ2xlIHRyYW5zZmVyLgogICAgICAgIHdoaWxlICgoIGk8IGRlcG9zaXRzLmxlbmd0aCkgJiYgKCBtc2cuZ2FzID4gMTQ4MDAwKSkgewogICAgICAgICAgICBEZXBvc2l0IHN0b3JhZ2UgZCA9IGRlcG9zaXRzW2ldOwoKICAgICAgICAgICAgLy8gTWFrZSBzdXJlIGBkZXBvc2l0W2ldYCBzaG91bGRuJ3QgYmUgc2tpcHBlZAogICAgICAgICAgICBpZiAoKCFkLmNhbmNlbGVkKSYmKCFpc0RlcG9zaXRTa2lwZWQobXNnLnNlbmRlciwgaSkpKSB7CgogICAgICAgICAgICAgICAgLy8gVGhlIGN1cnJlbnQgZGlwb3N0aSBpcyBkaWZmZXJlbnQgb2YgdGhlIGFjY3VtdWxhdGVkIHVudGlsIG5vdywKICAgICAgICAgICAgICAgIC8vIHNvIHdlIHJldHVybiB0aGUgYWNjdW11bGF0ZWQgdG9rZW5zIHVudGlsIG5vdyBhbmQgcmVzc2V0IHRoZQogICAgICAgICAgICAgICAgLy8gYWNjdW11bGF0b3IuCiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFRva2VuICE9IGQudG9rZW4pIHsKICAgICAgICAgICAgICAgICAgICBuZXh0RGVwb3NpdFRvUGF5b3V0W21zZy5zZW5kZXJdID0gaTsKICAgICAgICAgICAgICAgICAgICByZXF1aXJlKGRvUGF5bWVudChpLTEsIG1zZy5zZW5kZXIsIGN1cnJlbnRUb2tlbiwgYWNjKSk7CiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KG5leHREZXBvc2l0VG9QYXlvdXRbbXNnLnNlbmRlcl0gPT0gaSk7CiAgICAgICAgICAgICAgICAgICAgY3VycmVudFRva2VuID0gZC50b2tlbjsKICAgICAgICAgICAgICAgICAgICBhY2MgPTA7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gQWNjdW11bGF0ZSB0aGUgYW1vdW50IHRvIHNlbmQgZm9yIHRoZSBgY3VycmVudFRva2VuYAogICAgICAgICAgICAgICAgYWNjICs9ICBkLmFtb3VudCAqCiAgICAgICAgICAgICAgICAgICAgICAgIHJld2FyZFRva2VuLmJhbGFuY2VPZkF0KG1zZy5zZW5kZXIsIGQuYmxvY2spIC8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJld2FyZFRva2VuLnRvdGFsU3VwcGx5QXQoZC5ibG9jayk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGkrKzsgLy8gTmV4dCBkZXBvc2l0IDotRAogICAgICAgIH0KICAgICAgICAvLyBSZXR1cm4gdGhlIGFjY3VtdWxhdGVkIHRva2Vucy4KICAgICAgICBuZXh0RGVwb3NpdFRvUGF5b3V0W21zZy5zZW5kZXJdID0gaTsKICAgICAgICByZXF1aXJlKGRvUGF5bWVudChpLTEsIG1zZy5zZW5kZXIsIGN1cnJlbnRUb2tlbiwgYWNjKSk7CiAgICAgICAgYXNzZXJ0KG5leHREZXBvc2l0VG9QYXlvdXRbbXNnLnNlbmRlcl0gPT0gaSk7CiAgICB9CgogICAgLy8vIEBub3RpY2UgVGhpcyBmdW5jdGlvbiBpcyBhIGZhaWxzYWZlIGZ1bmN0aW9uIGluIGNhc2UgYSB0b2tlbiBob2xkZXIKICAgIC8vLyAgd2FudHMgdG8gc2tpcCBhIHBheW1lbnQsIGNhbiBvbmx5IGJlIGFwcGxpZWQgdG8gb25lIGRlcG9zaXQgYXQgYSB0aW1lCiAgICAvLy8gIGFuZCBvbmx5IGFmZmVjdHMgdGhlIHBheW1lbnQgZm9yIHRoZSBgbXNnLnNlbmRlcmAgY2FsbGluZyB0aGUgZnVuY3Rpb247CiAgICAvLy8gIGNhbiBiZSB1bmRvbmUgYnkgY2FsbGluZyBhZ2FpbiB3aXRoIGBza2lwID09IGZhbHNlYAogICAgLy8vIEBwYXJhbSBfaWREZXBvc2l0IFRoZSBpZCBudW1iZXIgZm9yIHRoZSBkZXBvc2l0IGJlaW5nIGNhbmNlbGVkCiAgICAvLy8gQHBhcmFtIF9za2lwIFRydWUgaWYgdGhlIGNhbGxlciB3YW50cyB0byBza2lwIHRoZSBwYXltZW50IGZvciBgaWREZXBvc2l0YAogICAgZnVuY3Rpb24gc2tpcFBheW1lbnQodWludCBfaWREZXBvc2l0LCBib29sIF9za2lwKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX2lkRGVwb3NpdCA8IGRlcG9zaXRzLmxlbmd0aCk7CiAgICAgICAgc2tpcERlcG9zaXRzW21zZy5zZW5kZXJdW19pZERlcG9zaXRdID0gX3NraXA7CiAgICAgICAgU2tpcFBheW1lbnQoX2lkRGVwb3NpdCwgX3NraXApOwogICAgfQoKLy8vLy8vLy8vCi8vIENvbnN0YW50IEZ1bmN0aW9ucwovLy8vLy8vLy8KCiAgICAvLy8gQG5vdGljZSBDYWxjdWxhdGVzIHRoZSBhbW91bnQgb2YgYSBnaXZlbiB0b2tlbiAob3IgZXRoZXIpIHRoZSBob2xkZXIgY2FuCiAgICAvLy8gIHJlY2VpdmUKICAgIC8vLyBAcGFyYW0gX3Rva2VuIFRoZSBhZGRyZXNzIG9mIHRoZSB0b2tlbiBiZWluZyBxdWVyaWVkLCAweDAgPSBldGhlcgogICAgLy8vIEBwYXJhbSBfaG9sZGVyIFRoZSBhZGRyZXNzIGJlaW5nIGNoZWNrZWQKICAgIC8vLyBAcmV0dXJuIFRoZSBhbW91bnQgb2YgYHRva2VuYCBhYmxlIHRvIGJlIGNvbGxlY3RlZCBpbiB0aGUgc21hbGxlc3QKICAgIC8vLyAgdW5pdCBvZiB0aGUgYHRva2VuYCAod2VpIGZvciBldGhlcikKICAgIGZ1bmN0aW9uIGdldFBlbmRpbmdSZXdhcmQoRVJDMjAgX3Rva2VuLCBhZGRyZXNzIF9ob2xkZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsKICAgICAgICB1aW50IGFjYyA9MDsKICAgICAgICBmb3IgKHVpbnQgaT1uZXh0RGVwb3NpdFRvUGF5b3V0W21zZy5zZW5kZXJdOyBpPGRlcG9zaXRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIERlcG9zaXQgc3RvcmFnZSBkID0gZGVwb3NpdHNbaV07CiAgICAgICAgICAgIGlmICgoZC50b2tlbiA9PSBfdG9rZW4pJiYoIWQuY2FuY2VsZWQpICYmICghaXNEZXBvc2l0U2tpcGVkKF9ob2xkZXIsIGkpKSkgewogICAgICAgICAgICAgICAgYWNjICs9ICBkLmFtb3VudCAqCiAgICAgICAgICAgICAgICAgICAgcmV3YXJkVG9rZW4uYmFsYW5jZU9mQXQoX2hvbGRlciwgZC5ibG9jaykgLwogICAgICAgICAgICAgICAgICAgICAgICByZXdhcmRUb2tlbi50b3RhbFN1cHBseUF0KGQuYmxvY2spOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBhY2M7CiAgICB9CgogICAgLy8vIEBub3RpY2UgQSBjaGVjayB0byBzZWUgaWYgYSBzcGVjaWZpYyBhZGRyZXNzIGhhcyBhbnl0aGluZyB0byBjb2xsZWN0CiAgICAvLy8gQHBhcmFtIF9ob2xkZXIgVGhlIGFkZHJlc3MgYmVpbmcgY2hlY2tlZCBmb3IgYXZhaWxhYmxlIGRlcG9zaXRzCiAgICAvLy8gQHJldHVybiBUcnVlIGlmIHRoZXJlIGFyZSBwYXltZW50cyB0byBiZSBjb2xsZWN0ZWQKICAgIGZ1bmN0aW9uIGNhbldpdGhkcmF3KGFkZHJlc3MgX2hvbGRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAobmV4dERlcG9zaXRUb1BheW91dFtfaG9sZGVyXSA9PSBkZXBvc2l0cy5sZW5ndGgpIHJldHVybiBmYWxzZTsKICAgICAgICBmb3IgKHVpbnQgaT1uZXh0RGVwb3NpdFRvUGF5b3V0W21zZy5zZW5kZXJdOyBpPGRlcG9zaXRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIERlcG9zaXQgc3RvcmFnZSBkID0gZGVwb3NpdHNbaV07CiAgICAgICAgICAgIGlmICgoIWQuY2FuY2VsZWQpICYmICghaXNEZXBvc2l0U2tpcGVkKF9ob2xkZXIsIGkpKSkgewogICAgICAgICAgICAgICAgdWludCBhbW91bnQgPSAgZC5hbW91bnQgKgogICAgICAgICAgICAgICAgICAgIHJld2FyZFRva2VuLmJhbGFuY2VPZkF0KF9ob2xkZXIsIGQuYmxvY2spIC8KICAgICAgICAgICAgICAgICAgICAgICAgcmV3YXJkVG9rZW4udG90YWxTdXBwbHlBdChkLmJsb2NrKTsKICAgICAgICAgICAgICAgIGlmIChhbW91bnQ+MCkgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8vLyBAbm90aWNlIENoZWNrcyBob3cgbWFueSBkZXBvc2l0cyBoYXZlIGJlZW4gbWFkZQogICAgLy8vIEByZXR1cm4gVGhlIG51bWJlciBvZiBkZXBvc2l0cwogICAgZnVuY3Rpb24gbkRlcG9zaXRzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gZGVwb3NpdHMubGVuZ3RoOwogICAgfQoKICAgIC8vLyBAbm90aWNlIENoZWNrcyB0byBzZWUgaWYgYSBzcGVjaWZpYyBkZXBvc2l0IGhhcyBiZWVuIHNraXBwZWQKICAgIC8vLyBAcGFyYW0gX2hvbGRlciBUaGUgYWRkcmVzcyBiZWluZyBjaGVja2VkIGZvciBhdmFpbGFibGUgZGVwb3NpdHMKICAgIC8vLyBAcGFyYW0gX2lkRGVwb3NpdCBUaGUgaWQgbnVtYmVyIGZvciB0aGUgZGVwb3NpdCBiZWluZyBjYW5jZWxlZAogICAgLy8vIEByZXR1cm4gVHJ1ZSBpZiB0aGUgc3BlY2lmaWVkIGRlcG9zaXQgaGFzIGJlZW4gc2tpcHBlZAogICAgZnVuY3Rpb24gaXNEZXBvc2l0U2tpcGVkKGFkZHJlc3MgX2hvbGRlciwgdWludCBfaWREZXBvc2l0KSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmV0dXJuIHNraXBEZXBvc2l0c1tfaG9sZGVyXVtfaWREZXBvc2l0XTsKICAgIH0KCi8vLy8vLy8vLwovLyBJbnRlcm5hbCBGdW5jdGlvbnMKLy8vLy8vLy8vCgogICAgLy8vIEBub3RpY2UgVHJhbnNmZXJzIGBhbW91bnRgIG9mIGB0b2tlbmAgdG8gYGRlc3RgLCBvbmx5IHVzZWQgaW50ZXJuYWxseSwKICAgIC8vLyAgYW5kIGRvZXMgbm90IHRocm93LCB3aWxsIGFsd2F5cyByZXR1cm4gYHRydWVgIG9yIGBmYWxzZWAKICAgIC8vLyBAcGFyYW0gX3Rva2VuIFRoZSBhZGRyZXNzIGZvciB0aGUgRVJDMjAgdGhhdCBpcyBiZWluZyB0cmFuc2ZlcnJlZAogICAgLy8vIEBwYXJhbSBfZGVzdCBUaGUgZGVzdGluYXRpb24gYWRkcmVzcyBvZiB0aGUgdHJhbnNmZXIKICAgIC8vLyBAcGFyYW0gX2Ftb3VudCBUaGUgcXVhbnRpdHkgb2YgdG9rZW5zIHRoYXQgaXMgYmVpbmcgdHJhbnNmZXJyZWQKICAgIC8vLyAgZGVub21pbmF0ZWQgaW4gdGhlIHNtYWxsZXN0IHVuaXQgb2YgdG9rZW5zIChpZiBhIHRva2VuIGhhcyBpdHMgZGVjaW1hbHMKICAgIC8vLyAgc2V0IHRvIDE4IGFuZCAxIHRva2VuIGlzIGJlaW5nIHRyYW5zZmVycmVkIHRoZSBgYW1vdW50YCB3b3VsZCBiZSAxMF4xOCkKICAgIC8vLyBAcmV0dXJuIFRydWUgaWYgdGhlIHBheW1lbnQgc3VjY2VlZGVkCiAgICBmdW5jdGlvbiBkb1BheW1lbnQodWludCBfaWREZXBvc2l0LCAgYWRkcmVzcyBfZGVzdCwgRVJDMjAgX3Rva2VuLCB1aW50IF9hbW91bnQpIGludGVybmFsIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAoX2Ftb3VudCA9PSAwKSByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAoYWRkcmVzcyhfdG9rZW4pID09IDApIHsKICAgICAgICAgICAgaWYgKCFfZGVzdC5zZW5kKF9hbW91bnQpKSByZXR1cm4gZmFsc2U7ICAgLy8gSWYgd2UgY2FuJ3Qgc2VuZCwgd2UgY29udGludWUuLi4KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAoIV90b2tlbi50cmFuc2ZlcihfZGVzdCwgX2Ftb3VudCkpIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgV2l0aGRyYXcoX2lkRGVwb3NpdCwgX2Rlc3QsIF90b2tlbiwgX2Ftb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QmFsYW5jZShFUkMyMCBfdG9rZW4sIGFkZHJlc3MgX2hvbGRlcikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIGlmIChhZGRyZXNzKF90b2tlbikgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gX2hvbGRlci5iYWxhbmNlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBfdG9rZW4uYmFsYW5jZU9mKF9ob2xkZXIpOwogICAgICAgIH0KICAgIH0KCi8vLy8vLy8vLwovLyBFdmVudHMKLy8vLy8vLy8vCgogICAgZXZlbnQgV2l0aGRyYXcodWludCBpbmRleGVkIGxhc3RJZFBheW1lbnQsIGFkZHJlc3MgaW5kZXhlZCBob2xkZXIsIEVSQzIwIGluZGV4ZWQgdG9rZW5Db250cmFjdCwgdWludCBhbW91bnQpOwogICAgZXZlbnQgTmV3RGVwb3NpdCh1aW50IGluZGV4ZWQgaWREZXBvc2l0LCBFUkMyMCBpbmRleGVkIHRva2VuQ29udHJhY3QsIHVpbnQgYW1vdW50KTsKICAgIGV2ZW50IENhbmNlbFBheW1lbnRHbG9iYWxseSh1aW50IGluZGV4ZWQgaWREZXBvc2l0KTsKICAgIGV2ZW50IFNraXBQYXltZW50KHVpbnQgaW5kZXhlZCBpZERlcG9zaXQsIGJvb2wgc2tpcCk7Cn0='.
	

]
