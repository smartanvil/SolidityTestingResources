Class {
	#name : #SRT82e12fc71975047b7395dd21e826f93360264345,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT82e12fc71975047b7395dd21e826f93360264345 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjE7CgovLy8gQHRpdGxlIFNhZmVNYXRoIGNvbnRyYWN0IC0gTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcy4KLy8vIEBhdXRob3IgT3BlblplcHBlbGluOiBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5L2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy9tYXRoL1NhZmVNYXRoLnNvbApjb250cmFjdCBTYWZlTWF0aAp7CiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoYiA+IDApOwogICAgICAgIHVpbnQgYyA9IGEgLyBiOwogICAgICAgIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgYXNzZXJ0KGIgPD0gYSk7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludCBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSk7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gcG93KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICB1aW50IGMgPSBhICoqIGI7CiAgICAgICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KfQoKY29udHJhY3QgT3duYWJsZQp7CiAgICBldmVudCBOZXdPd25lcihhZGRyZXNzIG9sZCwgYWRkcmVzcyBjdXJyZW50KTsKICAgIGV2ZW50IE5ld1BvdGVudGlhbE93bmVyKGFkZHJlc3Mgb2xkLCBhZGRyZXNzIHBvdGVudGlhbCk7CgogICAgYWRkcmVzcyBwdWJsaWMgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgYWRkcmVzcyBwdWJsaWMgcG90ZW50aWFsT3duZXI7CgogICAgbW9kaWZpZXIgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seVBvdGVudGlhbE93bmVyIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gcG90ZW50aWFsT3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gc2V0T3duZXIoYWRkcmVzcyBfbmV3KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBlbWl0IE5ld1BvdGVudGlhbE93bmVyKG93bmVyLCBfbmV3KTsKICAgICAgICBwb3RlbnRpYWxPd25lciA9IF9uZXc7CiAgICB9CgogICAgZnVuY3Rpb24gY29uZmlybU93bmVyc2hpcCgpIHB1YmxpYyBvbmx5UG90ZW50aWFsT3duZXIgewogICAgICAgIGVtaXQgTmV3T3duZXIob3duZXIsIHBvdGVudGlhbE93bmVyKTsKICAgICAgICBvd25lciA9IHBvdGVudGlhbE93bmVyOwogICAgICAgIHBvdGVudGlhbE93bmVyID0gMDsKICAgIH0KfQoKLy8vIEB0aXRsZSBBYnN0cmFjdCBUb2tlbiwgRVJDMjAgdG9rZW4gaW50ZXJmYWNlCmNvbnRyYWN0IEVSQzIwSQp7CiAgICBmdW5jdGlvbiBuYW1lKCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHN0cmluZyk7CiAgICBmdW5jdGlvbiBzeW1ib2woKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAoc3RyaW5nKTsKICAgIGZ1bmN0aW9uIGRlY2ltYWxzKCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwoKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCi8vLyBGdWxsIGNvbXBsZXRlIGltcGxlbWVudHMgRVJDIDIwIFRva2VuIHN0YW5kYXJkOiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKY29udHJhY3QgRVJDMjAgaXMgRVJDMjBJLCBTYWZlTWF0aAp7CiAgICBzdHJpbmcgIHB1YmxpYyBuYW1lOwogICAgc3RyaW5nICBwdWJsaWMgc3ltYm9sOwogICAgdWludDggICBwdWJsaWMgZGVjaW1hbHM7CiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICAgIHN0cmluZyAgcHVibGljIHZlcnNpb247CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCiAgICAvLy8gQGRldiBSZXR1cm5zIG51bWJlciBvZiB0b2tlbnMgb3duZWQgYnkgZ2l2ZW4gYWRkcmVzcy4KICAgIGZ1bmN0aW9uIG5hbWUoKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcpIHsKICAgICAgICByZXR1cm4gbmFtZTsKICAgIH0KCiAgICAvLy8gQGRldiBSZXR1cm5zIG51bWJlciBvZiB0b2tlbnMgb3duZWQgYnkgZ2l2ZW4gYWRkcmVzcy4KICAgIGZ1bmN0aW9uIHN5bWJvbCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHN0cmluZykgewogICAgICAgIHJldHVybiBzeW1ib2w7CiAgICB9CgogICAgLy8vIEBkZXYgUmV0dXJucyBudW1iZXIgb2YgdG9rZW5zIG93bmVkIGJ5IGdpdmVuIGFkZHJlc3MuCiAgICBmdW5jdGlvbiBkZWNpbWFscygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgcmV0dXJuIGRlY2ltYWxzOwogICAgfQoKICAgIC8vLyBAZGV2IFJldHVybnMgbnVtYmVyIG9mIHRva2VucyBvd25lZCBieSBnaXZlbiBhZGRyZXNzLgogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIHRvdGFsU3VwcGx5OwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAgICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAgICovCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDB4MCkpOwogICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1ttc2cuc2VuZGVyXSk7CgogICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHN1YihiYWxhbmNlc1ttc2cuc2VuZGVyXSwgX3ZhbHVlKTsKICAgICAgYmFsYW5jZXNbX3RvXSA9IGFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOwogICAgICBlbWl0IFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1tfZnJvbV0pOwogICAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSk7CgogICAgICBiYWxhbmNlc1tfZnJvbV0gPSBzdWIoYmFsYW5jZXNbX2Zyb21dLCBfdmFsdWUpOwogICAgICBiYWxhbmNlc1tfdG9dID0gYWRkKGJhbGFuY2VzW190b10sIF92YWx1ZSk7CiAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gc3ViKCBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSwgX3ZhbHVlKTsKICAgICAgZW1pdCBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAgICoKICAgICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgICAqIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZSB0cmFuc2FjdGlvbiBvcmRlcmluZy4gT25lIHBvc3NpYmxlIHNvbHV0aW9uIHRvIG1pdGlnYXRlIHRoaXMKICAgICAqIHJhY2UgY29uZGl0aW9uIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUgYWZ0ZXJ3YXJkczoKICAgICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgZW1pdCBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgICAqLwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBJbmNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAgICoKICAgICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAogICAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX2FkZGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gaW5jcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgICAqLwogICAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFkZChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSwgX2FkZGVkVmFsdWUpOwogICAgICBlbWl0IEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBEZWNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAgICoKICAgICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGRlY3JlbWVudAogICAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcGFyYW0gX3N1YnRyYWN0ZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBkZWNyZWFzZSB0aGUgYWxsb3dhbmNlIGJ5LgogICAgICovCiAgICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgICB9IGVsc2UgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gc3ViKG9sZFZhbHVlLCBfc3VidHJhY3RlZFZhbHVlKTsKICAgICAgfQogICAgICBlbWl0IEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQp9Cgpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKCiAgICBldmVudCBFUGF1c2UoKTsgLy9hZGRyZXNzIG93bmVyLCBzdHJpbmcgZXZlbnQKICAgIGV2ZW50IEVVbnBhdXNlKCk7CgogICAgYm9vbCBwdWJsaWMgcGF1c2VkID0gdHJ1ZTsKCiAgICBtb2RpZmllciB3aGVuTm90UGF1c2VkKCkKICAgIHsKICAgICAgICByZXF1aXJlKCFwYXVzZWQpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gcGF1c2UoKSBwdWJsaWMgb25seU93bmVyCiAgICB7CiAgICAgICAgcGF1c2VkID0gdHJ1ZTsKICAgICAgICBlbWl0IEVQYXVzZSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIHVucGF1c2UoKSBwdWJsaWMgb25seU93bmVyCiAgICB7CiAgICAgICAgcGF1c2VkID0gZmFsc2U7CiAgICAgICAgZW1pdCBFVW5wYXVzZSgpOwogICAgfQp9Cgpjb250cmFjdCBNaW50YWJsZVRva2VuIGlzIEVSQzIwLCBPd25hYmxlCnsKICAgIHVpbnQyNTYgbWF4U3VwcGx5ID0gMWUyNTsgLy90b2tlbnMgbGltaXQKCiAgICAvLyB0cmlnZ2VyZWQgd2hlbiB0aGUgdG90YWwgc3VwcGx5IGlzIGluY3JlYXNlZAogICAgZXZlbnQgSXNzdWFuY2UodWludDI1NiBfYW1vdW50KTsKICAgIC8vIHRyaWdnZXJlZCB3aGVuIHRoZSB0b3RhbCBzdXBwbHkgaXMgZGVjcmVhc2VkCiAgICBldmVudCBEZXN0cnVjdGlvbih1aW50MjU2IF9hbW91bnQpOwoKICAgIC8qKgogICAgICAgIEBkZXYgaW5jcmVhc2VzIHRoZSB0b2tlbiBzdXBwbHkgYW5kIHNlbmRzIHRoZSBuZXcgdG9rZW5zIHRvIGFuIGFjY291bnQKICAgICAgICBjYW4gb25seSBiZSBjYWxsZWQgYnkgdGhlIGNvbnRyYWN0IG93bmVyCiAgICAgICAgQHBhcmFtIF90byAgICAgICAgIGFjY291bnQgdG8gcmVjZWl2ZSB0aGUgbmV3IGFtb3VudAogICAgICAgIEBwYXJhbSBfYW1vdW50ICAgICBhbW91bnQgdG8gaW5jcmVhc2UgdGhlIHN1cHBseSBieQogICAgKi8KICAgIGZ1bmN0aW9uIGlzc3VlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUobWF4U3VwcGx5ID49IHRvdGFsU3VwcGx5ICsgX2Ftb3VudCk7CiAgICAgICAgdG90YWxTdXBwbHkgKz0gIF9hbW91bnQ7CiAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfYW1vdW50OwogICAgICAgIGVtaXQgSXNzdWFuY2UoX2Ftb3VudCk7CiAgICAgICAgZW1pdCBUcmFuc2Zlcih0aGlzLCBfdG8sIF9hbW91bnQpOwogICAgfQoKICAgIC8qKgogICAgICAgIEBkZXYgcmVtb3ZlcyB0b2tlbnMgZnJvbSBhbiBhY2NvdW50IGFuZCBkZWNyZWFzZXMgdGhlIHRva2VuIHN1cHBseQogICAgICAgIGNhbiBvbmx5IGJlIGNhbGxlZCBieSB0aGUgY29udHJhY3Qgb3duZXIKICAgICAgICAoaWYgcm9iYmVycyBkZXRlY3RlZCwgaWYgd2lsbCBiZSBjb25zZW5zdXMgYWJvdXQgdG9rZW4gYW1vdW50KQogICAgICAgIEBwYXJhbSBfZnJvbSAgICAgICBhY2NvdW50IHRvIHJlbW92ZSB0aGUgYW1vdW50IGZyb20KICAgICAgICBAcGFyYW0gX2Ftb3VudCAgICAgYW1vdW50IHRvIGRlY3JlYXNlIHRoZSBzdXBwbHkgYnkKICAgICovCiAgICBmdW5jdGlvbiBkZXN0cm95KGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgYmFsYW5jZXNbX2Zyb21dIC09IF9hbW91bnQ7CiAgICAgICAgdG90YWxTdXBwbHkgLT0gX2Ftb3VudDsKICAgICAgICBlbWl0IFRyYW5zZmVyKF9mcm9tLCB0aGlzLCBfYW1vdW50KTsKICAgICAgICBlbWl0IERlc3RydWN0aW9uKF9hbW91bnQpOwogICAgfQp9CgovKioKICogQHRpdGxlIFBhdXNhYmxlIHRva2VuCiAqIEBkZXYgU3RhbmRhcmRUb2tlbiBtb2RpZmllZCB3aXRoIHBhdXNhYmxlIHRyYW5zZmVycy4KICoqLwpjb250cmFjdCBQYXVzYWJsZVRva2VuIGlzIE1pbnRhYmxlVG9rZW4sIFBhdXNhYmxlIHsKCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKQogICAgICAgIHB1YmxpYwogICAgICAgIHdoZW5Ob3RQYXVzZWQKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKQogICAgICAgIHB1YmxpYwogICAgICAgIHdoZW5Ob3RQYXVzZWQKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHJldHVybiBzdXBlci5hcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkKICAgICAgICBwdWJsaWMKICAgICAgICB3aGVuTm90UGF1c2VkCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXR1cm4gc3VwZXIuaW5jcmVhc2VBcHByb3ZhbChfc3BlbmRlciwgX2FkZGVkVmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKQogICAgICAgIHB1YmxpYwogICAgICAgIHdoZW5Ob3RQYXVzZWQKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHJldHVybiBzdXBlci5kZWNyZWFzZUFwcHJvdmFsKF9zcGVuZGVyLCBfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KCn0KCmNvbnRyYWN0IEN1c3RvbWNvaW4gaXMgUGF1c2FibGVUb2tlbiB7CgogICAgYWRkcmVzcyBpbnRlcm5hbCBzZWxsZXI7CgogICAgLyoqCiAgICAgICAgQGRldiBtb2RpZmllZCBwYXVzYWJsZS90cnVzdGVlIHNlbGxlciBjb250cmFjdAogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICBpZihwYXVzZWQpIHsKICAgICAgICAgICAgcmVxdWlyZShzZWxsZXIgPT0gbXNnLnNlbmRlcik7CiAgICAgICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gc2VuZFRva2VuKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIG9ubHlPd25lcgogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygweDApKTsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1t0aGlzXSk7CiAgICAgICAgYmFsYW5jZXNbdGhpc10gPSBzdWIoYmFsYW5jZXNbdGhpc10sIF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOwogICAgICAgIGVtaXQgVHJhbnNmZXIodGhpcywgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKCiAgICBmdW5jdGlvbiBzZXRTZWxsZXIoYWRkcmVzcyBfc2VsbGVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBzZWxsZXIgPSBfc2VsbGVyOwogICAgfQoKICAgIC8qKiBAZGV2IHRyYW5zZmVyIGV0aGVyZXVtIGZyb20gY29udHJhY3QgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRXRoZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlPd25lcgogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgX3RvLnRyYW5zZmVyKF92YWx1ZSk7IC8vIENIRUNLIFRISVMKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAgICBAZGV2IG93bmVyIGNhbiB0cmFuc2ZlciBvdXQgYW55IGFjY2lkZW50YWxseSBzZW50IEVSQzIwIHRva2VucwogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRVJDMjBUb2tlbihhZGRyZXNzIHRva2VuQWRkcmVzcywgYWRkcmVzcyB0bywgdWludDI1NiB0b2tlbnMpCiAgICAgICAgcHVibGljCiAgICAgICAgb25seU93bmVyCiAgICAgICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXR1cm4gRVJDMjAodG9rZW5BZGRyZXNzKS50cmFuc2Zlcih0bywgdG9rZW5zKTsKICAgIH0KCiAgICAvKioKICAgICAgICBAZGV2IG1hc3MgdHJhbnNmZXIKICAgICAgICBAcGFyYW0gX2hvbGRlcnMgYWRkcmVzc2VzIG9mIHRoZSBvd25lcnMgdG8gYmUgbm90aWZpZWQgWyJhZGRyZXNzXzEiLCAiYWRkcmVzc18yIiwgLi5dCiAgICAgKi8KICAgIGZ1bmN0aW9uIG1hc3NUcmFuc2ZlcihhZGRyZXNzIFtdIF9ob2xkZXJzLCB1aW50MjU2IFtdIF9wYXltZW50cykKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5T3duZXIKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHVpbnQyNTYgaGwgPSBfaG9sZGVycy5sZW5ndGg7CiAgICAgICAgdWludDI1NiBwbCA9IF9wYXltZW50cy5sZW5ndGg7CiAgICAgICAgcmVxdWlyZShobCA8PSAxMDAgJiYgaGwgPT0gcGwpOwogICAgICAgIGZvciAodWludDI1NiBpID0gMDsgaSA8IGhsOyBpKyspIHsKICAgICAgICAgICAgdHJhbnNmZXIoX2hvbGRlcnNbaV0sIF9wYXltZW50c1tpXSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qCiAgICAgICAgQGRldiB0b2tlbnMgY29uc3RydWN0b3IKICAgICovCiAgICBmdW5jdGlvbiBDdXN0b21jb2luKCkgcHVibGljCiAgICB7CiAgICAgICAgbmFtZSA9ICJDdXN0b21jb2luIjsKICAgICAgICBzeW1ib2wgPSAiQ1NUTSI7CiAgICAgICAgZGVjaW1hbHMgPSAxODsKICAgICAgICB2ZXJzaW9uID0gIjEuMyI7CiAgICAgICAgaXNzdWUodGhpcywgMWU3ICogMWUxOCk7CiAgICB9CgogICAgZnVuY3Rpb24oKSBwdWJsaWMgcGF5YWJsZSB7fQp9Cgpjb250cmFjdCBIZWxwZXIgewoKICAgIGZ1bmN0aW9uIHRvU3RyaW5nKGFkZHJlc3MgeCkgaW50ZXJuYWwgcHVyZQogICAgICAgIHJldHVybnMgKHN0cmluZykKICAgIHsKICAgICAgICBieXRlcyBtZW1vcnkgYiA9IG5ldyBieXRlcygyMCk7CiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgMjA7IGkrKykKICAgICAgICAgICAgYltpXSA9IGJ5dGUodWludDgodWludCh4KSAvICgyKiooOCooMTkgLSBpKSkpKSk7CiAgICAgICAgcmV0dXJuIHN0cmluZyhiKTsKICAgIH0KfQoKY29udHJhY3QgQ3VzdG9tY29pbkNyb3dkc2FsZSBpcyBPd25hYmxlLCBTYWZlTWF0aCwgSGVscGVyIHsKCiAgICAvLyB0cmlnZ2VyZWQgb24gdG9rZW4gc2VsbAogICAgZXZlbnQgSW52ZXN0ZWQoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIGludmVzdG9yRXRoQWRkciwKICAgICAgICBzdHJpbmcgIGluZGV4ZWQgY3VycmVuY3ksCiAgICAgICAgdWludDI1NiBpbmRleGVkIGludmVzdGVkQW1vdW50LAogICAgICAgIHN0cmluZyAgdHhIYXNoLAogICAgICAgIHVpbnQyNTYgdG9rbmVzU2VudAogICAgKTsKICAgIC8vIHRyaWdnZXJlZCB3aGVuIGNyb3dkc2FsZSBwZXJpb2QgaXMgb3ZlcgogICAgZXZlbnQgQ3Jvd2RTYWxlRmluaXNoZWQoKTsKCiAgICBDdXN0b21jb2luIHB1YmxpYyB0b2tlbkFkZHJlc3M7CgogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKICAgIHVpbnQyNTYgREVDID0gMTAgKiogdWludDI1NihkZWNpbWFscyk7CiAgICB1aW50MjU2IHB1YmxpYyByZWNlaXZlZEVUSDsKICAgIHVpbnQyNTYgcHVibGljIHByaWNlOwoKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gSW52ZXN0bWVudCkgcHVibGljIHBheW1lbnRzOwoKICAgIC8qKgogICAgICAgIEBkZXYgY29udHJhY3QgY29uc3RydWN0b3IKICAgICovCiAgICBmdW5jdGlvbiBDdXN0b21jb2luQ3Jvd2RzYWxlKGFkZHJlc3MgX2RlcGxveWVkKSBwdWJsaWMgewogICAgICAgIHRva2VuQWRkcmVzcyA9IEN1c3RvbWNvaW4oX2RlcGxveWVkKTsKICAgICAgICBzZXRQcmljZSgxMDAwMCk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0UHJpY2UodWludDI1NiBfdmFsdWUpIHB1YmxpYwogICAgICAgb25seU93bmVyCiAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIHByaWNlID0gX3ZhbHVlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHN0cnVjdCBDcm93ZHNhbGUgewogICAgICAgIHVpbnQyNTYgdG9rZW5zOyAgICAvLyBUb2tlbnMgaW4gY3Jvd2RzYWxlCiAgICAgICAgdWludCAgICBzdGFydERhdGU7IC8vIERhdGUgd2hlbiBjcm93c2FsZSB3aWxsIGJlIHN0YXJ0aW5nLCBhZnRlciBpdHMgc3RhcnRpbmcgdGhhdCBwcm9wZXJ0eSB3aWxsIGJlIHRoZSAwCiAgICAgICAgdWludCAgICBlbmREYXRlOyAgIC8vIERhdGUgd2hlbiBjcm93ZHNhbGUgd2lsbCBiZSBzdG9wCiAgICAgICAgdWludDggICBib251czsgICAgIC8vIEJvbnVzCiAgICB9CgogICAgQ3Jvd2RzYWxlIHB1YmxpYyBDcm93ZDsKCiAgICAvKgogICAgICAgIEBkZXYgc3RhcnQgY3Jvd2RzYWxlIChhbnkpCiAgICAgICAgQHBhcmFtIF90b2tlbnMgLSBIb3cgbXVjaCB0b2tlbnMgd2lsbCBoYXZlIHRoZSBjcm93ZHNhbGUgLSBhbW91bnQgaHVtYW5saWtlIHZhbHVlICgxMDAwMCkKICAgICAgICBAcGFyYW0gX3N0YXJ0RGF0ZSAtIFdoZW4gY3Jvd2RzYWxlIHdpbGwgYmUgc3RhcnQgLSB1bml4IHRpbWVzdGFtcCAoMTUxMjIzMTcwMykKICAgICAgICBAcGFyYW0gX2VuZERhdGUgLSBXaGVuIGNyb3dkc2FsZSB3aWxsIGJlIGVuZCAtIGh1bWFubGlrZSB2YWx1ZSAoNykgc2FtZSBhcyA3IGRheXMKICAgICAgICBAcGFyYW0gX2JvbnVzIC0gQm9udXMgZm9yIHRoZSBjcm93ZCAtIGh1bWFubGl2ZSB2YWx1ZSAoNykgc2FtZSBhcyA3ICUKICAgICovCiAgICBmdW5jdGlvbiBzdGFydENyb3dkc2FsZSgKICAgICAgICB1aW50MjU2IF90b2tlbnMsCiAgICAgICAgdWludCAgICBfc3RhcnREYXRlLAogICAgICAgIHVpbnQgICAgX2VuZERhdGUsCiAgICAgICAgdWludDggICBfYm9udXMKICAgICkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5T3duZXIKICAgIHsKICAgICAgICBDcm93ZCA9IENyb3dkc2FsZSAoCiAgICAgICAgICAgIF90b2tlbnMgKiBERUMsCiAgICAgICAgICAgIF9zdGFydERhdGUsCiAgICAgICAgICAgIF9zdGFydERhdGUgKyBfZW5kRGF0ZSAqIDEgZGF5cyAsCiAgICAgICAgICAgIF9ib251cwogICAgICAgICAgICApOwogICAgICAgIHNhbGVTdGF0ID0gdHJ1ZTsKICAgIH0KCiAgICAvKgogICAgICAgIEBkZXYgdXBkYXRlIGNyb3dkc2FsZSBpZiBzbXRoIGluY29ycmVjdAogICAgKi8KICAgIGZ1bmN0aW9uIHVwZGF0ZUNyb3dkKAogICAgICAgIHVpbnQyNTYgdG9rZW5zLAogICAgICAgIHVpbnQgICAgc3RhcnREYXRlLAogICAgICAgIHVpbnQgICAgZW5kRGF0ZSwKICAgICAgICB1aW50OCAgIGJvbnVzCiAgICApCiAgICAgICAgcHVibGljCiAgICAgICAgb25seU93bmVyCiAgICB7CiAgICAgICAgQ3Jvd2QgPSBDcm93ZHNhbGUoCiAgICAgICAgICAgIHRva2VucywKICAgICAgICAgICAgc3RhcnREYXRlLAogICAgICAgICAgICBlbmREYXRlLAogICAgICAgICAgICBib251cwogICAgICAgICAgICApOwogICAgfQoKICAgIC8qCiAgICAgICAgQGRldiBzYWZlIHNhbGVzIGNvbnRvbGxlcgogICAgKi8KICAgIGZ1bmN0aW9uIGNvbmZpcm1TZWxsKHVpbnQyNTYgX2Ftb3VudCkgaW50ZXJuYWwgdmlldwogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgaWYgKENyb3dkLnRva2VucyA8IF9hbW91bnQpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAgICBAZGV2IGNvdW50IHN1bW0gd2l0aCBib251cwogICAgKi8KICAgIGZ1bmN0aW9uIGNvdW50Qm9udXModWludDI1NiBhbW91bnQpIGludGVybmFsIHZpZXcKICAgICAgICByZXR1cm5zICh1aW50MjU2KQogICAgewogICAgICAgIHVpbnQyNTYgX2Ftb3VudCA9IGRpdihtdWwoYW1vdW50LCBERUMpLCBwcmljZSk7CiAgICAgICAgcmV0dXJuIF9hbW91bnQgPSBhZGQoX2Ftb3VudCwgd2l0aEJvbnVzKF9hbW91bnQsIENyb3dkLmJvbnVzKSk7CiAgICB9CgogICAgLyoqCiAgICAgICAgQGRldiBzYWxlcyBtYW5hZ2VyCiAgICAqLwogICAgZnVuY3Rpb24gcGF5bWVudENvbnRyb2xsZXIoYWRkcmVzcyBzZW5kZXIsIHVpbnQyNTYgdmFsdWUpIGludGVybmFsCiAgICAgICAgcmV0dXJucyAodWludDI1NikKICAgIHsKICAgICAgICB1aW50MjU2IGJvbnVzVmFsdWUgPSBjb3VudEJvbnVzKHZhbHVlKTsKICAgICAgICBib29sIGNvbmYgPSBjb25maXJtU2VsbChib251c1ZhbHVlKTsKICAgICAgICB1aW50MjU2IHJlc3VsdDsKICAgICAgICBpZiAoY29uZikgewogICAgICAgICAgICByZXN1bHQgPSBib251c1ZhbHVlOwogICAgICAgICAgICBzZWxsKHNlbmRlciwgYm9udXNWYWx1ZSk7CiAgICAgICAgICAgIGlmIChub3cgPj0gQ3Jvd2QuZW5kRGF0ZSkgewogICAgICAgICAgICAgICAgc2FsZVN0YXQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGVtaXQgQ3Jvd2RTYWxlRmluaXNoZWQoKTsgLy8gaWYgdGltZSBpcyB1cAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICByZXN1bHQgPSBDcm93ZC50b2tlbnM7CiAgICAgICAgICAgIHNlbGwoc2VuZGVyLCBDcm93ZC50b2tlbnMpOyAvLyBzZWxsIHRva2VucyB3aGljaCBoYXMgYmVlbiBhY2Nlc3NpYmxlCiAgICAgICAgICAgIHNhbGVTdGF0ID0gZmFsc2U7CiAgICAgICAgICAgIGVtaXQgQ3Jvd2RTYWxlRmluaXNoZWQoKTsgIC8vIGlmIHRva2VucyBzb2xkCiAgICAgICAgfQogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogICAgLyoqCiAgICAgICAgQGRldiBzZWxsIGZ1bmN0aW9uIGltcGxlbWVudHMKICAgICovCiAgICBmdW5jdGlvbiBzZWxsKGFkZHJlc3MgX2ludmVzdG9yLCB1aW50MjU2IF9hbW91bnQpIGludGVybmFsCiAgICB7CiAgICAgICAgQ3Jvd2QudG9rZW5zID0gc3ViKENyb3dkLnRva2VucywgX2Ftb3VudCk7CiAgICAgICAgdG9rZW5BZGRyZXNzLnRyYW5zZmVyKF9pbnZlc3RvciwgX2Ftb3VudCk7CiAgICAgICAgLy9pZighZXRoT3duZXIuc2VuZChtc2cudmFsdWUpKSByZXZlcnQoKTsKICAgIH0KCiAgICAvKioKICAgICAgICBAZGV2IGFkZGluZyBib251cwogICAgKi8KICAgIGZ1bmN0aW9uIHdpdGhCb251cyh1aW50MjU2IF9hbW91bnQsIHVpbnQgX3BlcmNlbnQpIGludGVybmFsIHB1cmUKICAgICAgICByZXR1cm5zICh1aW50MjU2KQogICAgewogICAgICAgIHJldHVybiBkaXYobXVsKF9hbW91bnQsIF9wZXJjZW50KSwgMTAwKTsKICAgIH0KCiAgICAvLyBzYWZlIHN0b3JhZ2UgZm9yIGFsbCB0eHMKICAgIHVpbnQyNTYgcHVibGljIHBheW1lbnRJZDsKCiAgICBmdW5jdGlvbiBzZXRJZCgpIGludGVybmFsIHsKICAgICAgICBwYXltZW50SWQrKzsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRJZCgpIHB1YmxpYyB2aWV3CiAgICAgICAgcmV0dXJucyAodWludDI1NikKICAgIHsKICAgICAgICByZXR1cm4gcGF5bWVudElkOwogICAgfQoKICAgIHN0cnVjdCBJbnZlc3RtZW50IHsKICAgICAgICBzdHJpbmcgIGN1cnJlbmN5OwogICAgICAgIGFkZHJlc3MgaW52ZXN0b3JFdGhBZGRyOwogICAgICAgIHN0cmluZyAgdHhIYXNoOwogICAgICAgIHVpbnQyNTYgaW52ZXN0ZWRBbW91bnQ7CiAgICAgICAgdWludDI1NiB0b2tlbnNTZW50OwogICAgICAgIHVpbnQyNTYgcHJpY2VJblVzZDsKICAgIH0KCiAgICBmdW5jdGlvbiBwYXltZW50TWFuYWdlcigKICAgICAgICBzdHJpbmcgIGN1cnJlbmN5LAogICAgICAgIGFkZHJlc3MgaW52ZXN0b3JFdGhBZGRyLAogICAgICAgIHN0cmluZyAgdHhIYXNoLAogICAgICAgIHVpbnQyNTYgaW52ZXN0ZWRBbW91bnQsCiAgICAgICAgdWludDI1NiB0b2tlbnNGb3JTZW50CiAgICApCiAgICAgICAgaW50ZXJuYWwKICAgIHsKICAgICAgICByZXF1aXJlKGJ5dGVzKGN1cnJlbmN5KS5sZW5ndGggIT0gMCAmJgogICAgICAgICAgICAgICAgaW52ZXN0b3JFdGhBZGRyICE9IDB4MCAmJgogICAgICAgICAgICAgICAgYnl0ZXModHhIYXNoKS5sZW5ndGggIT0gMCAmJgogICAgICAgICAgICAgICAgaW52ZXN0ZWRBbW91bnQgIT0gMCAmJgogICAgICAgICAgICAgICAgaW52ZXN0b3JFdGhBZGRyICE9IDApOwogICAgICAgIHNldElkKCk7CiAgICAgICAgdWludDI1NiBpZCA9IGdldElkKCk7CiAgICAgICAgdWludDI1NiB0b2tlbnNXaXRoQm9udXMgPSBwYXltZW50Q29udHJvbGxlcihpbnZlc3RvckV0aEFkZHIsIHRva2Vuc0ZvclNlbnQpOwogICAgICAgIHBheW1lbnRzW2lkXS5jdXJyZW5jeSA9IGN1cnJlbmN5OwogICAgICAgIHBheW1lbnRzW2lkXS5pbnZlc3RvckV0aEFkZHIgPSBpbnZlc3RvckV0aEFkZHI7CiAgICAgICAgcGF5bWVudHNbaWRdLnR4SGFzaCA9IHR4SGFzaDsKICAgICAgICBwYXltZW50c1tpZF0uaW52ZXN0ZWRBbW91bnQgPSBpbnZlc3RlZEFtb3VudDsKICAgICAgICBwYXltZW50c1tpZF0udG9rZW5zU2VudCA9IHRva2Vuc1dpdGhCb251czsKICAgICAgICBlbWl0IEludmVzdGVkKGludmVzdG9yRXRoQWRkciwgY3VycmVuY3ksIGludmVzdGVkQW1vdW50LCB0eEhhc2gsIHRva2Vuc1dpdGhCb251cyk7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkUGF5bWVudCgKICAgICAgICBzdHJpbmcgIGN1cnJlbmN5LAogICAgICAgIGFkZHJlc3MgaW52ZXN0b3JFdGhBZGRyLAogICAgICAgIHN0cmluZyAgdHhIYXNoLAogICAgICAgIHVpbnQyNTYgaW52ZXN0ZWRBbW91bnQsCiAgICAgICAgdWludDI1NiB0b2tlbnNGb3JTZW50CiAgICApCiAgICAgICAgcHVibGljIG9ubHlPd25lcgogICAgewogICAgICAgIHBheW1lbnRNYW5hZ2VyKGN1cnJlbmN5LCBpbnZlc3RvckV0aEFkZHIsIHR4SGFzaCwgaW52ZXN0ZWRBbW91bnQsIHRva2Vuc0ZvclNlbnQpOwogICAgfQoKICAgIGJvb2wgaW50ZXJuYWwgc2FsZVN0YXQgPSBmYWxzZTsKCiAgICBmdW5jdGlvbiBzd2l0Y2hTYWxlKCkgcHVibGljIG9ubHlPd25lcgogICAgICAgIHJldHVybnMoYm9vbCkKICAgIHsKICAgICAgICBpZihzYWxlU3RhdCA9PSB0cnVlKSB7CiAgICAgICAgICAgIHNhbGVTdGF0ID0gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc2FsZVN0YXQgPSB0cnVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gc2FsZVN0YXQ7CiAgICB9CgogICAgZnVuY3Rpb24gc2FsZUlzT24oKSB2aWV3IHB1YmxpYwogICAgICAgIHJldHVybnMoYm9vbCkKICAgIHsKICAgICAgICByZXR1cm4gc2FsZVN0YXQ7CiAgICB9CgogICAgLyoqCiAgICAgQGRldiBGdW5jdGlvbiBwYXltZW50cyBoYW5kbGVyCiAgICAqLwogICAgZnVuY3Rpb24oKSBwdWJsaWMgcGF5YWJsZQogICAgewogICAgICAgIGFzc2VydChtc2cudmFsdWUgPj0gMSBldGhlciAvIDEwKTsKICAgICAgICByZXF1aXJlKENyb3dkLnN0YXJ0RGF0ZSA8PSBub3cpOwoKICAgICAgICBpZiAoc2FsZUlzT24oKSA9PSB0cnVlKSB7CiAgICAgICAgICAgIGFkZHJlc3ModG9rZW5BZGRyZXNzKS50cmFuc2Zlcihtc2cudmFsdWUpOyAvLyB0cmFuc2ZlciB0byB0aGUgZ2VuZXJhbCBjb250cmFjdAogICAgICAgICAgICBwYXltZW50TWFuYWdlcigiZXRoIiwgbXNnLnNlbmRlciwgdG9TdHJpbmcodHgub3JpZ2luKSwgbXNnLnZhbHVlLCBtc2cudmFsdWUpOwogICAgICAgICAgICByZWNlaXZlZEVUSCA9IGFkZChyZWNlaXZlZEVUSCwgbXNnLnZhbHVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CiAgICB9Cn0='.
	

]
