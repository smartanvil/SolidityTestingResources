Class {
	#name : #SRTf8a15b1540d5f9d002d9ccb7fd1f23e795c2859d,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTf8a15b1540d5f9d002d9ccb7fd1f23e795c2859d >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4gMC40LjE3OwoKY29udHJhY3QgU2FmZU1hdGggewogICAgZnVuY3Rpb24gc2FmZU11bCh1aW50IGEsIHVpbnQgYikgcHVyZSBpbnRlcm5hbCByZXR1cm5zKHVpbnQpIHsKICAgICAgICB1aW50IGMgPSBhICogYjsKICAgICAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGZ1bmN0aW9uIHNhZmVTdWIodWludCBhLCB1aW50IGIpIHB1cmUgaW50ZXJuYWwgcmV0dXJucyh1aW50KSB7CiAgICAgICAgYXNzZXJ0KGIgPD0gYSk7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgfQoKICAgIGZ1bmN0aW9uIHNhZmVBZGQodWludCBhLCB1aW50IGIpIHB1cmUgaW50ZXJuYWwgcmV0dXJucyh1aW50KSB7CiAgICAgICAgdWludCBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSAmJiBjID49IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQp9CgoKCgpjb250cmFjdCBPd25hYmxlIHsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwoKICAgIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBpZiAobmV3T3duZXIgIT0gYWRkcmVzcygwKSkgCiAgICAgICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICB9CgogICAgZnVuY3Rpb24ga2lsbCgpIHB1YmxpYyB7CiAgICAgICAgaWYgKG1zZy5zZW5kZXIgPT0gb3duZXIpIAogICAgICAgICAgICBzZWxmZGVzdHJ1Y3Qob3duZXIpOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgICAgICBpZiAobXNnLnNlbmRlciA9PSBvd25lcikKICAgICAgICAgICAgXzsKICAgIH0KfQoKY29udHJhY3QgUGF1c2FibGUgaXMgT3duYWJsZSB7CiAgICBib29sIHB1YmxpYyBzdG9wcGVkOwoKICAgIG1vZGlmaWVyIHN0b3BJbkVtZXJnZW5jeSB7CiAgICAgICAgaWYgKHN0b3BwZWQpIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seUluRW1lcmdlbmN5IHsKICAgICAgICBpZiAoIXN0b3BwZWQpIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQogICAgICAgIF87CiAgICB9CgogICAgLy8gQ2FsbGVkIGJ5IHRoZSBvd25lciBpbiBlbWVyZ2VuY3ksIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUKICAgIGZ1bmN0aW9uIGVtZXJnZW5jeVN0b3AoKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIHN0b3BwZWQgPSB0cnVlOwogICAgfQoKICAgIC8vIENhbGxlZCBieSB0aGUgb3duZXIgdG8gZW5kIG9mIGVtZXJnZW5jeSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgIGZ1bmN0aW9uIHJlbGVhc2UoKSBleHRlcm5hbCBvbmx5T3duZXIgb25seUluRW1lcmdlbmN5IHsKICAgICAgICBzdG9wcGVkID0gZmFsc2U7CiAgICB9Cn0KCgpjb250cmFjdCBFUkMyMCB7CiAgICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseTsKCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnModWludCk7CgogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyh1aW50KTsKCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50IHZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sIG9rKTsKCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50IHZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sIG9rKTsKCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludCB2YWx1ZSkgcHVibGljIHJldHVybnMoYm9vbCBvayk7CgogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50IHZhbHVlKTsKfQoKCmNvbnRyYWN0IFRva2VuIGlzIEVSQzIwLCBTYWZlTWF0aCwgT3duYWJsZSB7CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sKTsKfQoKLy8gUHJlc2FsZSBTbWFydCBDb250cmFjdAovLyBUaGlzIHNtYXJ0IGNvbnRyYWN0IGNvbGxlY3RzIEVUSCBhbmQgaW4gcmV0dXJuIHNlbmRzIHRva2VucyB0byB0aGUgYmFja2Vycwpjb250cmFjdCBQcmVzYWxlIGlzIFNhZmVNYXRoLCBQYXVzYWJsZSB7CgogICAgc3RydWN0IEJhY2tlciB7CiAgICAgICAgdWludCB3ZWlSZWNlaXZlZDsgLy8gYW1vdW50IG9mIEVUSCBjb250cmlidXRlZAogICAgICAgIHVpbnQgdG9rZW5zVG9TZW5kOyAvLyBhbW91bnQgb2YgdG9rZW5zICBzZW50CiAgICAgICAgYm9vbCBjbGFpbWVkOwogICAgICAgIGJvb2wgcmVmdW5kZWQ7CiAgICB9CiAgIAogICAgYWRkcmVzcyBwdWJsaWMgbXVsdGlzaWc7IC8vIE11bHRpc2lnIGNvbnRyYWN0IHRoYXQgd2lsbCByZWNlaXZlIHRoZSBFVEggICAgCiAgICB1aW50IHB1YmxpYyBldGhSZWNlaXZlZDsgLy8gTnVtYmVyIG9mIEVUSCByZWNlaXZlZAogICAgdWludCBwdWJsaWMgdG9rZW5zU2VudDsgLy8gTnVtYmVyIG9mIHRva2VucyBzZW50IHRvIEVUSCBjb250cmlidXRvcnMKICAgIHVpbnQgcHVibGljIHN0YXJ0QmxvY2s7IC8vIFByZXNhbGUgc3RhcnQgYmxvY2sKICAgIHVpbnQgcHVibGljIGVuZEJsb2NrOyAvLyBQcmVzYWxlIGVuZCBibG9jawoKICAgIHVpbnQgcHVibGljIG1pbkludmVzdG1lbnQ7IC8vIE1pbmltdW0gYW1vdW50IHRvIGludmVzdAogICAgdWludCBwdWJsaWMgbWF4SW52ZXN0bWVudDsgLy8gTWF4aW11bSBpbnZlc3RtZW50CiAgICBib29sIHB1YmxpYyBwcmVzYWxlQ2xvc2VkOyAvLyBJcyBwcmVzYWxlIHN0aWxsIG9uIGdvaW5nICAgICAKICAgIHVpbnQgcHVibGljIHRva2VuUHJpY2VXZWk7IC8vIHByaWNlIG9mIHRva2VuIGluIHdlaQogICAgVG9rZW4gcHVibGljIHRva2VuOyAvLyBhZGRyZXNzcyBvZiB0b2tlbiBjb250cmFjdAoKCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gQmFja2VyKSBwdWJsaWMgYmFja2VyczsgLy9iYWNrZXIgbGlzdAogICAgYWRkcmVzc1tdIHB1YmxpYyBiYWNrZXJzSW5kZXg7ICAvLyB0byBiZSBhYmxlIHRvIGl0ZXJhdGUgdGhyb3VnaCBiYWNrZXIgbGlzdAogICAgdWludCBwdWJsaWMgbWF4Q2FwOyAgLy8gbWF4IGNhcAogICAgdWludCBwdWJsaWMgY2xhaW1Db3VudDsgIC8vIG51bWJlciBvZiBjb250cmlidXRvcnMgY2xhbWluZyB0b2tlbnMKICAgIHVpbnQgcHVibGljIHJlZnVuZENvdW50OyAgLy8gbnVtYmVyIG9mIGNvbnRyaWJ1dG9ycyByZWNlaXZpZyByZWZ1bmRzCiAgICB1aW50IHB1YmxpYyB0b3RhbENsYWltZWQ7ICAvLyB0b3RhbCBvZiB0b2tlbnMgY2xhaW1lZAogICAgdWludCBwdWJsaWMgdG90YWxSZWZ1bmRlZDsgIC8vIHRvdGFsIG9mIHRva2VucyByZWZ1bmRlZAogICAgYm9vbCBwdWJsaWMgbWFpblNhbGVTdWNjZXNzZnVsbDsgLy8gdHJ1ZSBpZiBtYWluIHNhbGUgd2FzIHN1Y2Nlc3NmdWxsCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgcHVibGljIGNsYWltZWQ7IC8vIFRva2VucyBjbGFpbWVkIGJ5IGNvbnRpYnV0b3JzCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgcHVibGljIHJlZnVuZGVkOyAvLyBUb2tlbnMgcmVmdW5kZWQgdG8gY29udHJpYnV0b3JzCgoKICAgIC8vIEBub3RpY2UgdG8gdmVyaWZ5IGlmIGFjdGlvbiBpcyBub3QgcGVyZm9ybWVkIG91dCBvZiB0aGUgY2FtcGFpbmcgcmFuZ2UKICAgIG1vZGlmaWVyIHJlc3BlY3RUaW1lRnJhbWUoKSB7CiAgICAgICAgaWYgKChibG9jay5udW1iZXIgPCBzdGFydEJsb2NrKSB8fCAoYmxvY2subnVtYmVyID4gZW5kQmxvY2spKSAKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgXzsKICAgIH0KCiAgICAvLyBAbm90aWNlIG92ZXJ3cnRpbmcgdGhpcyBmdW5jdGlvbiB0byBlbnN1cmUgdGhhdCBtb25leSBpZiBhbnkgICAgIGlzIHJldHVybmVkIHRvIGF1dGhvcml6ZWQgcGFydHkuIAogICAgZnVuY3Rpb24ga2lsbCgpIHB1YmxpYyB7CiAgICAgICAgaWYgKG1zZy5zZW5kZXIgPT0gb3duZXIpIAogICAgICAgICAgICBzZWxmZGVzdHJ1Y3QobXVsdGlzaWcpOwogICAgfQoKCiAgICAvLyBFdmVudHMKICAgIGV2ZW50IFJlY2VpdmVkRVRIKGFkZHJlc3MgYmFja2VyLCB1aW50IGFtb3VudCwgdWludCB0b2tlbkFtb3VudCk7CiAgICBldmVudCBUb2tlbnNDbGFpbWVkKGFkZHJlc3MgYmFja2VyLCB1aW50IGNvdW50KTsKICAgIGV2ZW50IFJlZnVuZGVkKGFkZHJlc3MgYmFja2VyLCB1aW50IGFtb3VudCk7CgoKCiAgICAvLyBQcmVzYWxlICB7Y29uc3RydWN0b3J9CiAgICAvLyBAbm90aWNlIGZpcmVkIHdoZW4gY29udHJhY3QgaXMgY3JhdGVkLiBJbml0aWxpemVzIGFsbCBuZWVkZWQgdmFyaWFibGVzLgogICAgZnVuY3Rpb24gUHJlc2FsZSgpIHB1YmxpYyB7ICAgICAgICAKICAgICAgICBtdWx0aXNpZyA9IDB4RjgyMUZkOTlCQ0EyMTExMzI3YjZhNDExQzkwQkU0OWRjZjc4Q0UwZjsgCiAgICAgICAgbWluSW52ZXN0bWVudCA9IDVlMTc7ICAvLyAwLjUgZXRoCiAgICAgICAgbWF4SW52ZXN0bWVudCA9IDc1IGV0aGVyOyAgICAgIAogICAgICAgIG1heENhcCA9IDgyNTAwMDAwZTE4OwogICAgICAgIHN0YXJ0QmxvY2sgPSAwOyAvLyBTaG91bGQgd2FpdCBmb3IgdGhlIGNhbGwgb2YgdGhlIGZ1bmN0aW9uIHN0YXJ0CiAgICAgICAgZW5kQmxvY2sgPSAwOyAvLyBTaG91bGQgd2FpdCBmb3IgdGhlIGNhbGwgb2YgdGhlIGZ1bmN0aW9uIHN0YXJ0ICAgICAgIAogICAgICAgIHRva2VuUHJpY2VXZWkgPSAxMTAwMDAwMDAwMDAwMDAwOyAgICAgIAogICAgICAgIHRva2Vuc1NlbnQgPSAyNTM0NTU5ODgzZTE2OyAgICAgICAgIAogICAgfQoKICAgIC8vIEBub3RpY2XigIsg4oCLcmV0dXJu4oCLIOKAiyBudW1iZXLigIsgb2bigIsg4oCLY29udHJpYnV0b3JzCiAgICAvL+KAiyDigItAcmV0dXJu4oCLIOKAiyDigIt7dWludH3igIsg4oCLIG51bWJlcuKAiyDigIsgb2YgY29udHJpYnV0b3JzCiAgICBmdW5jdGlvbiBudW1iZXJPZkJhY2tlcnMoKSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnQpIHsKICAgICAgICByZXR1cm4gYmFja2Vyc0luZGV4Lmxlbmd0aDsKICAgIH0KCiAgICAvLyBAbm90aWNlIHRvIHBvcHVsYXRlIHdlYnNpdGUgd2l0aCBzdGF0dXMgb2YgdGhlIHNhbGUgCiAgICBmdW5jdGlvbiByZXR1cm5XZWJzaXRlRGF0YSgpIGV4dGVybmFsIHZpZXcgcmV0dXJucyh1aW50LCB1aW50LCB1aW50LCB1aW50LCB1aW50LCB1aW50LCB1aW50LCB1aW50LCB1aW50LCBib29sLCBib29sKSB7CiAgICAKICAgICAgICByZXR1cm4gKHN0YXJ0QmxvY2ssIGVuZEJsb2NrLCBudW1iZXJPZkJhY2tlcnMoKSwgZXRoUmVjZWl2ZWQsIG1heENhcCwgdG9rZW5zU2VudCwgdG9rZW5QcmljZVdlaSwgbWluSW52ZXN0bWVudCwgbWF4SW52ZXN0bWVudCwgc3RvcHBlZCwgcHJlc2FsZUNsb3NlZCApOwogICAgfQoKICAgIC8vIEBub3RpY2UgY2FsbGVkIHRvIG1hcmsgY29udHJpYnV0b3JzIHdoZW4gdG9rZW5zIGFyZSB0cmFuc2ZlcmVkIHRvIHRoZW0gYWZ0ZXIgSUNPIG1hbnVhbGx5LiAKICAgIC8vIEBwYXJhbSBfYmFja2VyIHthZGRyZXNzfSBhZGRyZXNzIG9mIGJlbmVmaWNpYXJ5CiAgICBmdW5jdGlvbiBjbGFpbVRva2Vuc0ZvclVzZXIoYWRkcmVzcyBfYmFja2VyKSBvbmx5T3duZXIoKSBleHRlcm5hbCByZXR1cm5zKGJvb2wpIHsKCiAgICAgICAgcmVxdWlyZSAoIWJhY2tlci5yZWZ1bmRlZCk7IC8vIGlmIHJlZnVuZGVkLCBkb24ndCBhbGxvdyB0b2tlbnMgdG8gYmUgY2xhaW1lZCAgICAgICAgICAgCiAgICAgICAgcmVxdWlyZSAoIWJhY2tlci5jbGFpbWVkKTsgLy8gaWYgdG9rZW5zIGNsYWltZWQsIGRvbid0IGFsbG93IHRvIGJlIGNsYWltZWQgYWdhaW4gICAgICAgICAgICAKICAgICAgICByZXF1aXJlIChiYWNrZXIudG9rZW5zVG9TZW5kICE9IDApOyAvLyBvbmx5IGNvbnRpbnVlIGlmIHRoZXJlIGFyZSBhbnkgdG9rZW5zIHRvIHNlbmQgICAgICAgIAogICAgICAgIEJhY2tlciBzdG9yYWdlIGJhY2tlciA9IGJhY2tlcnNbX2JhY2tlcl07CiAgICAgICAgYmFja2VyLmNsYWltZWQgPSB0cnVlOyAgLy8gbWFyayByZWNvcmQgYXMgY2xhaW1lZAoKICAgICAgICBpZiAoIXRva2VuLnRyYW5zZmVyKF9iYWNrZXIsIGJhY2tlci50b2tlbnNUb1NlbmQpKSAKICAgICAgICAgICAgcmV2ZXJ0KCk7IC8vIHNlbmQgY2xhaW1lZCB0b2tlbnMgdG8gY29udHJpYnV0b3IgYWNjb3VudAoKICAgICAgICBUb2tlbnNDbGFpbWVkKG1zZy5zZW5kZXIsIGJhY2tlci50b2tlbnNUb1NlbmQpOyAgCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgoKICAgIC8vIHtmYWxsYmFjayBmdW5jdGlvbn0KICAgIC8vIEBub3RpY2UgSXQgd2lsbCBjYWxsIGludGVybmFsIGZ1bmN0aW9uIHdoaWNoIGhhbmRlbHMgYWxsb2NhdGlvbiBvZiBFdGhlciBhbmQgY2FsY3VsYXRlcyBQUFAgdG9rZW5zLgogICAgZnVuY3Rpb24gKCkgcHVibGljIHBheWFibGUgewogICAgICAgIGNvbnRyaWJ1dGUobXNnLnNlbmRlcik7CiAgICB9CgogICAgLy8gQG5vdGljZSBpbiBjYXNlIHJlZnVuZHMgYXJlIG5lZWRlZCwgbW9uZXkgY2FuIGJlIHJldHVybmVkIHRvIHRoZSBjb250cmFjdAogICAgZnVuY3Rpb24gZnVuZENvbnRyYWN0KCkgZXh0ZXJuYWwgcGF5YWJsZSBvbmx5T3duZXIoKSByZXR1cm5zIChib29sKSB7CiAgICAgICAgbWFpblNhbGVTdWNjZXNzZnVsbCA9IGZhbHNlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vIEBub3RpY2UgSXQgd2lsbCBiZSBjYWxsZWQgYnkgb3duZXIgdG8gc3RhcnQgdGhlIHNhbGUgICAgCiAgICAvLyBibG9jayBudW1iZXJzIHdpbGwgYmUgY2FsY3VsYXRlZCBiYXNlZCBvbiBjdXJyZW50IGJsb2NrIHRpbWUgYXZlcmFnZS4gCiAgICBmdW5jdGlvbiBzdGFydCh1aW50IF9ibG9jaykgZXh0ZXJuYWwgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUoX2Jsb2NrIDwgNTQwMDApOyAgLy8gMi41KjYwKjI0KjE1IGRheXMgPSA1NDAwMCAgCiAgICAgICAgc3RhcnRCbG9jayA9IGJsb2NrLm51bWJlcjsKICAgICAgICBlbmRCbG9jayA9IHNhZmVBZGQoc3RhcnRCbG9jaywgX2Jsb2NrKTsgICAKICAgIH0KCiAgICAvLyBAbm90aWNlIER1ZSB0byBjaGFuZ2luZyBhdmVyYWdlIG9mIGJsb2NrIHRpbWUKICAgIC8vIHRoaXMgZnVuY3Rpb24gd2lsbCBhbGxvdyBvbiBhZGp1c3RpbmcgZHVyYXRpb24gb2YgY2FtcGFpZ24gY2xvc2VyIHRvIHRoZSBlbmQgCiAgICAvLyBAcGFyYW0gX2Jsb2NrICBudW1iZXIgb2YgYmxvY2tzIHJlcHJlc2VudGluZyBkdXJhdGlvbiAKICAgIGZ1bmN0aW9uIGFkanVzdER1cmF0aW9uKHVpbnQgX2Jsb2NrKSBleHRlcm5hbCBvbmx5T3duZXIoKSB7CiAgICAgICAgCiAgICAgICAgcmVxdWlyZShfYmxvY2sgPD0gNzIwMDApOyAgLy8gMi41KjYwKjI0KjIwIGRheXMgPSA3MjAwMCAgICAgCiAgICAgICAgcmVxdWlyZShfYmxvY2sgPiBzYWZlU3ViKGJsb2NrLm51bWJlciwgc3RhcnRCbG9jaykpOyAvLyBlbnN1cmUgdGhhdCBlbmRCbG9jayBpcyBub3Qgc2V0IGluIHRoZSBwYXN0CiAgICAgICAgZW5kQmxvY2sgPSBzYWZlQWRkKHN0YXJ0QmxvY2ssIF9ibG9jayk7ICAgCiAgICB9CgogICAgCgoKICAgIC8vIEBub3RpY2Ugc2V0IHRoZSBhZGRyZXNzIG9mIHRoZSB0b2tlbiBjb250cmFjdAogICAgLy8gQHBhcmFtIF90b2tlbiAge1Rva2VufSBhZGRyZXNzIG9mIHRoZSB0b2tlbiBjb250cmFjdAogICAgZnVuY3Rpb24gc2V0VG9rZW4oVG9rZW4gX3Rva2VuKSBwdWJsaWMgb25seU93bmVyKCkgcmV0dXJucyhib29sKSB7CgogICAgICAgIHRva2VuID0gX3Rva2VuOwogICAgICAgIG1haW5TYWxlU3VjY2Vzc2Z1bGwgPSB0cnVlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vIEBub3RpY2Ugc2V0cyBzdGF0dXMgb2YgbWFpbiBJQ08KICAgIC8vIEBwYXJhbSBfc3RhdHVzIHtib29sfSB0cnVlIGlmIHB1YmxpYyBJQ08gd2FzIHN1Y2Nlc3NmdWwKICAgIGZ1bmN0aW9uIHNldE1haW5DYW1wYWlnblN0YXR1cyhib29sIF9zdGF0dXMpIHB1YmxpYyBvbmx5T3duZXIoKSB7CiAgICAgICAgbWFpblNhbGVTdWNjZXNzZnVsbCA9IF9zdGF0dXM7CiAgICB9CgogICAgLy8gQG5vdGljZSBJdCB3aWxsIGJlIGNhbGxlZCBieSBmYWxsYmFjayBmdW5jdGlvbiB3aGVuZXZlciBldGhlciBpcyBzZW50IHRvIGl0CiAgICAvLyBAcGFyYW0gIF9jb250cmlidXRvciB7YWRkcmVzc30gYWRkcmVzcyBvZiBiZW5lZmljaWFyeQogICAgLy8gQHJldHVybiByZXMge2Jvb2x9IHRydWUgaWYgdHJhbnNhY3Rpb24gd2FzIHN1Y2Nlc3NmdWwKCiAgICBmdW5jdGlvbiBjb250cmlidXRlKGFkZHJlc3MgX2NvbnRyaWJ1dG9yKSBpbnRlcm5hbCBzdG9wSW5FbWVyZ2VuY3kgcmVzcGVjdFRpbWVGcmFtZSByZXR1cm5zKGJvb2wgcmVzKSB7CiAgICAgICAgIAogICAgICAgIHJlcXVpcmUgKG1zZy52YWx1ZSA+PSBtaW5JbnZlc3RtZW50ICYmIG1zZy52YWx1ZSA8PSBtYXhJbnZlc3RtZW50KTsgIC8vIGVuc3VyZSB0aGF0IG1pbiBhbmQgbWF4IGNvbnRyaWJ1dGlvbnMgYW1vdW50IGlzIG1ldAogICAgICAgICAgICAgICAgICAgCiAgICAgICAgdWludCB0b2tlbnNUb1NlbmQgPSBjYWxjdWxhdGVOb09mVG9rZW5zVG9TZW5kKCk7CiAgICAgICAgCiAgICAgICAgcmVxdWlyZSAoc2FmZUFkZCh0b2tlbnNTZW50LCB0b2tlbnNUb1NlbmQpIDw9IG1heENhcCk7ICAvLyBFbnN1cmUgdGhhdCBtYXggY2FwIGhhc24ndCBiZWVuIHJlYWNoZWQKCiAgICAgICAgQmFja2VyIHN0b3JhZ2UgYmFja2VyID0gYmFja2Vyc1tfY29udHJpYnV0b3JdOwoKICAgICAgICBpZiAoYmFja2VyLndlaVJlY2VpdmVkID09IDApCiAgICAgICAgICAgIGJhY2tlcnNJbmRleC5wdXNoKF9jb250cmlidXRvcik7CgogICAgICAgIGJhY2tlci50b2tlbnNUb1NlbmQgPSBzYWZlQWRkKGJhY2tlci50b2tlbnNUb1NlbmQsIHRva2Vuc1RvU2VuZCk7CiAgICAgICAgYmFja2VyLndlaVJlY2VpdmVkID0gc2FmZUFkZChiYWNrZXIud2VpUmVjZWl2ZWQsIG1zZy52YWx1ZSk7CiAgICAgICAgZXRoUmVjZWl2ZWQgPSBzYWZlQWRkKGV0aFJlY2VpdmVkLCBtc2cudmFsdWUpOyAvLyBVcGRhdGUgdGhlIHRvdGFsIEV0aGVyIHJlY2l2ZWQKICAgICAgICB0b2tlbnNTZW50ID0gc2FmZUFkZCh0b2tlbnNTZW50LCB0b2tlbnNUb1NlbmQpOwoKICAgICAgICBtdWx0aXNpZy50cmFuc2Zlcihtc2cudmFsdWUpOyAgLy8gc2VuZCBtb25leSB0byBtdWx0aXNpZ25hdHVyZSB3YWxsZXQKCiAgICAgICAgUmVjZWl2ZWRFVEgoX2NvbnRyaWJ1dG9yLCBtc2cudmFsdWUsIHRva2Vuc1RvU2VuZCk7IC8vIFJlZ2lzdGVyIGV2ZW50CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gQG5vdGljZSBJdCBpcyBjYWxsZWQgYnkgY29udHJpYnV0ZSB0byBkZXRlcm1pbmUgYW1vdW50IG9mIHRva2VucyBmb3IgZ2l2ZW4gY29udHJpYnV0aW9uICAgIAogICAgLy8gQHJldHVybiB0b2tlbnNUb1B1cmNoYXNlIHt1aW50fSB2YWx1ZSBvZiB0b2tlbnMgdG8gcHVyY2hhc2UKCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVOb09mVG9rZW5zVG9TZW5kKCkgdmlldyBpbnRlcm5hbCByZXR1cm5zKHVpbnQpIHsKICAgICAgICAgCiAgICAgICAgdWludCB0b2tlbkFtb3VudCA9IHNhZmVNdWwobXNnLnZhbHVlLCAxZTE4KSAvIHRva2VuUHJpY2VXZWk7CiAgICAgICAgdWludCBldGhBbW91bnQgPSBtc2cudmFsdWU7CgogICAgICAgIGlmIChldGhBbW91bnQgPj0gNTAgZXRoZXIpCiAgICAgICAgICAgIHJldHVybiB0b2tlbkFtb3VudCArICh0b2tlbkFtb3VudCAqIDUpIC8gMTAwOyAgLy8gNSUgcGVyY2VudCBib251cwogICAgICAgIGVsc2UgaWYgKGV0aEFtb3VudCA+PSAxNSBldGhlcikKICAgICAgICAgICAgcmV0dXJuIHRva2VuQW1vdW50ICsgKHRva2VuQW1vdW50ICogMjUpIC8gMTAwMDsgLy8gMi41JSBwZXJjZW50IGJvbnVzCiAgICAgICAgZWxzZSAKICAgICAgICAgICAgcmV0dXJuIHRva2VuQW1vdW50OwogICAgfQoKICAgIC8vIEBub3RpY2UgVGhpcyBmdW5jdGlvbiB3aWxsIGZpbmFsaXplIHRoZSBzYWxlLgogICAgLy8gSXQgd2lsbCBvbmx5IGV4ZWN1dGUgaWYgcHJlZGV0ZXJtaW5lZCBzYWxlIHRpbWUgcGFzc2VkIAoKICAgIGZ1bmN0aW9uIGZpbmFsaXplKCkgZXh0ZXJuYWwgb25seU93bmVyKCkgewoKICAgICAgICByZXF1aXJlICghcHJlc2FsZUNsb3NlZCk7ICAgICAgICAgICAKICAgICAgICByZXF1aXJlIChibG9jay5udW1iZXIgPj0gZW5kQmxvY2spOyAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgcHJlc2FsZUNsb3NlZCA9IHRydWU7CiAgICB9CgoKICAgIC8vIEBub3RpY2UgY29udHJpYnV0b3JzIGNhbiBjbGFpbSB0b2tlbnMgYWZ0ZXIgcHVibGljIElDTyBpcyBmaW5pc2hlZAogICAgLy8gdG9rZW5zIGFyZSBvbmx5IGNsYWltYWJsZSB3aGVuIHRva2VuIGFkZHJlc3MgaXMgYXZhaWxhYmxlLiAKCiAgICBmdW5jdGlvbiBjbGFpbVRva2VucygpIGV4dGVybmFsIHsKCiAgICAgICAgcmVxdWlyZShtYWluU2FsZVN1Y2Nlc3NmdWxsKTsKICAgICAgIAogICAgICAgIHJlcXVpcmUgKHRva2VuICE9IGFkZHJlc3MoMCkpOyAgLy8gYWRkcmVzcyBvZiB0aGUgdG9rZW4gaXMgc2V0IGFmdGVyIElDTwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2xhaW1pbmcgb2YgdG9rZW5zIHdpbGwgYmUgb25seSBwb3NzaWJsZSBvbmNlIGFkZHJlc3Mgb2YgdG9rZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlzIHNldCB0aHJvdWdoIHNldFRva2VuCiAgICAgICAgICAgCiAgICAgICAgQmFja2VyIHN0b3JhZ2UgYmFja2VyID0gYmFja2Vyc1ttc2cuc2VuZGVyXTsKCiAgICAgICAgcmVxdWlyZSAoIWJhY2tlci5yZWZ1bmRlZCk7IC8vIGlmIHJlZnVuZGVkLCBkb24ndCBhbGxvdyBmb3IgYW5vdGhlciByZWZ1bmQgICAgICAgICAgIAogICAgICAgIHJlcXVpcmUgKCFiYWNrZXIuY2xhaW1lZCk7IC8vIGlmIHRva2VucyBjbGFpbWVkLCBkb24ndCBhbGxvdyByZWZ1bmRpbmcgICAgICAgICAgICAKICAgICAgICByZXF1aXJlIChiYWNrZXIudG9rZW5zVG9TZW5kICE9IDApOyAgIC8vIG9ubHkgY29udGludWUgaWYgdGhlcmUgYXJlIGFueSB0b2tlbnMgdG8gc2VuZCAgICAgICAgICAgCgogICAgICAgIGNsYWltQ291bnQrKzsKICAgICAgICBjbGFpbWVkW21zZy5zZW5kZXJdID0gYmFja2VyLnRva2Vuc1RvU2VuZDsgIC8vIHNhdmUgY2xhaW1lZCB0b2tlbnMKICAgICAgICBiYWNrZXIuY2xhaW1lZCA9IHRydWU7CiAgICAgICAgdG90YWxDbGFpbWVkID0gc2FmZUFkZCh0b3RhbENsYWltZWQsIGJhY2tlci50b2tlbnNUb1NlbmQpOwogICAgICAgIAogICAgICAgIGlmICghdG9rZW4udHJhbnNmZXIobXNnLnNlbmRlciwgYmFja2VyLnRva2Vuc1RvU2VuZCkpIAogICAgICAgICAgICByZXZlcnQoKTsgLy8gc2VuZCBjbGFpbWVkIHRva2VucyB0byBjb250cmlidXRvciBhY2NvdW50CgogICAgICAgIFRva2Vuc0NsYWltZWQobXNnLnNlbmRlciwgYmFja2VyLnRva2Vuc1RvU2VuZCk7ICAKICAgIH0KCiAgICAvLyBAbm90aWNlIGFsbG93IHJlZnVuZCB3aGVuIElDTyBmYWlsZWQKICAgIC8vIEluIHN1Y2ggYSBjYXNlIGNvbnRyYWN0IHdpbGwgbmVlZCB0byBiZSBmdW5kZWQuIAogICAgLy8gVW50aWwgY29udHJhY3QgaXMgZnVuZGVkIHRoaXMgZnVuY3Rpb24gd2lsbCB0aHJvdwoKICAgIGZ1bmN0aW9uIHJlZnVuZCgpIGV4dGVybmFsIHsKCiAgICAgICAgcmVxdWlyZSghbWFpblNhbGVTdWNjZXNzZnVsbCk7ICAvLyBlbnN1cmUgdGhhdCBJQ08gZmFpbGVkCiAgICAgICAgcmVxdWlyZSh0aGlzLmJhbGFuY2UgPiAwKTsgIC8vIGNvbnRyYWN0IHdpbGwgaG9sZCAwIGV0aGVyIGF0IHRoZSBlbmQgb2YgY2FtcGFpZ24uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb250cmFjdCBuZWVkcyB0byBiZSBmdW5kZWQgdGhyb3VnaCBmdW5kQ29udHJhY3QoKSAKICAgICAgICBCYWNrZXIgc3RvcmFnZSBiYWNrZXIgPSBiYWNrZXJzW21zZy5zZW5kZXJdOwoKICAgICAgICByZXF1aXJlICghYmFja2VyLmNsYWltZWQpOyAvLyBjaGVjayBpZiB0b2tlbnMgaGF2ZSBiZWVuIGFsbG9jYXRlZCBhbHJlYWR5ICAgICAgICAgICAgICAgICAgIAogICAgICAgIHJlcXVpcmUgKCFiYWNrZXIucmVmdW5kZWQpOyAvLyBjaGVjayBpZiB1c2VyIGhhcyBiZWVuIGFscmVhZHkgcmVmdW5kZWQgICAgIAogICAgICAgIHJlcXVpcmUoYmFja2VyLndlaVJlY2VpdmVkICE9IDApOyAgLy8gY2hlY2sgaWYgdXNlciBoYXMgYWN0dWFsbHkgc2VudCBhbnkgY29udHJpYnV0aW9ucyAgICAgICAgCgogICAgICAgIGJhY2tlci5yZWZ1bmRlZCA9IHRydWU7IC8vIG1hcmsgY29udHJpYnV0b3IgYXMgcmVmdW5kZWQuIAogICAgICAgIHRvdGFsUmVmdW5kZWQgPSBzYWZlQWRkKHRvdGFsUmVmdW5kZWQsIGJhY2tlci53ZWlSZWNlaXZlZCk7CiAgICAgICAgcmVmdW5kQ291bnQgKys7CiAgICAgICAgcmVmdW5kZWRbbXNnLnNlbmRlcl0gPSBiYWNrZXIud2VpUmVjZWl2ZWQ7CgogICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoYmFja2VyLndlaVJlY2VpdmVkKTsgIC8vIHJlZnVuZCBjb250cmlidXRpb24gICAgICAgIAogICAgICAgIFJlZnVuZGVkKG1zZy5zZW5kZXIsIGJhY2tlci53ZWlSZWNlaXZlZCk7IC8vIGxvZyBldmVudAogICAgfQoKCiAgICAvLyBAbm90aWNlIEZhaWxzYWZlIGRyYWluCiAgICBmdW5jdGlvbiBkcmFpbigpIGV4dGVybmFsIG9ubHlPd25lcigpIHsKICAgICAgICBtdWx0aXNpZy50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogICAgICAgICAgICAKICAgIH0KfQ=='.
	

]
