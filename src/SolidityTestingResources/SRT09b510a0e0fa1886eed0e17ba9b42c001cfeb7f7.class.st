Class {
	#name : #SRT09b510a0e0fa1886eed0e17ba9b42c001cfeb7f7,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT09b510a0e0fa1886eed0e17ba9b42c001cfeb7f7 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjA7CiAKLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5CiAqLwpjb250cmFjdCBFUkMyMEJhc2ljIHsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCi8qKgogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKi8KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKGEgPT0gMCkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgICAKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKICAKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgogIC8qKgogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4KICAgKi8KICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7ICAgICAgCiAgICBvd25lciA9IG5ld093bmVyOwogIH0KfQoKLyoqCiAqIEB0aXRsZSBQYXVzYWJsZQogKiBAZGV2IEJhc2UgY29udHJhY3Qgd2hpY2ggYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uCiAqLwpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBzYWxlQWdlbnQ7CiAgYWRkcmVzcyBwdWJsaWMgcGFydG5lcjsKCiAgbW9kaWZpZXIgb25seUFkbWluKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyIHx8IG1zZy5zZW5kZXIgPT0gc2FsZUFnZW50IHx8IG1zZy5zZW5kZXIgPT0gcGFydG5lcik7CiAgICBfOwogIH0KCiAgZnVuY3Rpb24gc2V0U2FsZUFnZW50KGFkZHJlc3MgbmV3U2FsZUFnZW50KSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUobmV3U2FsZUFnZW50ICE9IGFkZHJlc3MoMCkpOyAKICAgIHNhbGVBZ2VudCA9IG5ld1NhbGVBZ2VudDsKICB9CgogIGZ1bmN0aW9uIHNldFBhcnRuZXIoYWRkcmVzcyBuZXdQYXJ0bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUobmV3UGFydG5lciAhPSBhZGRyZXNzKDApKTsgCiAgICBwYXJ0bmVyID0gbmV3UGFydG5lcjsKICB9CgogIGV2ZW50IFBhdXNlKCk7CiAgZXZlbnQgVW5wYXVzZSgpOwoKICBib29sIHB1YmxpYyBwYXVzZWQgPSBmYWxzZTsKCgogIC8qKgogICAqIEBkZXYgTW9kaWZpZXIgdG8gbWFrZSBhIGZ1bmN0aW9uIGNhbGxhYmxlIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgaXMgbm90IHBhdXNlZC4KICAgKi8KICBtb2RpZmllciB3aGVuTm90UGF1c2VkKCkgewogICAgcmVxdWlyZSghcGF1c2VkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IE1vZGlmaWVyIHRvIG1ha2UgYSBmdW5jdGlvbiBjYWxsYWJsZSBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IGlzIHBhdXNlZC4KICAgKi8KICBtb2RpZmllciB3aGVuUGF1c2VkKCkgewogICAgcmVxdWlyZShwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgY2FsbGVkIGJ5IHRoZSBvd25lciB0byBwYXVzZSwgdHJpZ2dlcnMgc3RvcHBlZCBzdGF0ZQogICAqLwogIGZ1bmN0aW9uIHBhdXNlKCkgb25seU93bmVyIHdoZW5Ob3RQYXVzZWQgcHVibGljIHsKICAgIHBhdXNlZCA9IHRydWU7CiAgICBQYXVzZSgpOwogIH0KCiAgLyoqCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHVucGF1c2UsIHJldHVybnMgdG8gbm9ybWFsIHN0YXRlCiAgICovCiAgZnVuY3Rpb24gdW5wYXVzZSgpIG9ubHlPd25lciB3aGVuUGF1c2VkIHB1YmxpYyB7CiAgICBwYXVzZWQgPSBmYWxzZTsKICAgIFVucGF1c2UoKTsKICB9Cn0KCi8qKgogKiBAdGl0bGUgQmFzaWMgdG9rZW4KICogQGRldiBCYXNpYyB2ZXJzaW9uIG9mIFN0YW5kYXJkVG9rZW4sIHdpdGggbm8gYWxsb3dhbmNlcy4gCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMsIFBhdXNhYmxlIHsKICAgIAogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogIHVpbnQyNTYgcHVibGljIHN0b3JhZ2VUaW1lID0gMTUyMjc0OTYwMDsgLy8gMDQvMDMvMjAxOCBAIDEwOjAwYW0gKFVUQykKCiAgbW9kaWZpZXIgY2hlY2tTdG9yYWdlVGltZSgpIHsKICAgIHJlcXVpcmUobm93ID49IHN0b3JhZ2VUaW1lKTsKICAgIF87CiAgfQoKICBtb2RpZmllciBvbmx5UGF5bG9hZFNpemUodWludDI1NiBudW13b3JkcykgewogICAgYXNzZXJ0KG1zZy5kYXRhLmxlbmd0aCA+PSBudW13b3JkcyAqIDMyICsgNCk7CiAgICBfOwogIH0KCiAgZnVuY3Rpb24gc2V0U3RvcmFnZVRpbWUodWludDI1NiBfdGltZSkgcHVibGljIG9ubHlPd25lciB7CiAgICBzdG9yYWdlVGltZSA9IF90aW1lOwogIH0KCiAgLyoqCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMKICBvbmx5UGF5bG9hZFNpemUoMikgd2hlbk5vdFBhdXNlZCBjaGVja1N0b3JhZ2VUaW1lIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuIAogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbgogKgogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdXQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVyZWQKICAgKi8KCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIAogIG9ubHlQYXlsb2FkU2l6ZSgzKSB3aGVuTm90UGF1c2VkIGNoZWNrU3RvcmFnZVRpbWUgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1tfZnJvbV0pOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0pOwoKICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgQXByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIAogIG9ubHlQYXlsb2FkU2l6ZSgyKSB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wpIHsKCiAgICAvLyBUbyBjaGFuZ2UgdGhlIGFwcHJvdmUgYW1vdW50IHlvdSBmaXJzdCBoYXZlIHRvIHJlZHVjZSB0aGUgYWRkcmVzc2VzYAogICAgLy8gIGFsbG93YW5jZSB0byB6ZXJvIGJ5IGNhbGxpbmcgYGFwcHJvdmUoX3NwZW5kZXIsIDApYCBpZiBpdCBpcyBub3QKICAgIC8vICBhbHJlYWR5IDAgdG8gbWl0aWdhdGUgdGhlIHJhY2UgY29uZGl0aW9uIGRlc2NyaWJlZCBoZXJlOgogICAgLy8gIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICByZXF1aXJlKChfdmFsdWUgPT0gMCkgfHwgKGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID09IDApKTsKCiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZmluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CgogICAvKioKICAgKiBAZGV2IEluY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX2FkZGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gaW5jcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyAKICBvbmx5UGF5bG9hZFNpemUoMikKICByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IERlY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBkZWNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3N1YnRyYWN0ZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBkZWNyZWFzZSB0aGUgYWxsb3dhbmNlIGJ5LgogICAqLwogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgCiAgb25seVBheWxvYWRTaXplKDIpCiAgcmV0dXJucyAoYm9vbCkgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCi8qKgogKiBAdGl0bGUgTWludGFibGUgdG9rZW4KICogQGRldiBTaW1wbGUgRVJDMjAgVG9rZW4gZXhhbXBsZSwgd2l0aCBtaW50YWJsZSB0b2tlbiBjcmVhdGlvbgogKiBAZGV2IElzc3VlOiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvaXNzdWVzLzEyMAogKiBCYXNlZCBvbiBjb2RlIGJ5IFRva2VuTWFya2V0TmV0OiBodHRwczovL2dpdGh1Yi5jb20vVG9rZW5NYXJrZXROZXQvaWNvL2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy9NaW50YWJsZVRva2VuLnNvbAogKi8KCmNvbnRyYWN0IE1pbnRhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbnsKICAgIAogIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGFtb3VudCk7CiAgCiAgZXZlbnQgTWludEZpbmlzaGVkKCk7CgogIGJvb2wgcHVibGljIG1pbnRpbmdGaW5pc2hlZCA9IGZhbHNlOwoKICBtb2RpZmllciBjYW5NaW50KCkgewogICAgcmVxdWlyZSghbWludGluZ0ZpbmlzaGVkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIG1pbnQgdG9rZW5zCiAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjaWV2ZSB0aGUgbWludGVkIHRva2Vucy4KICAgKiBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAqIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBwdWJsaWMgb25seUFkbWluIHdoZW5Ob3RQYXVzZWQgY2FuTWludCByZXR1cm5zICAoYm9vbCkgewogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoX2Ftb3VudCk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICBNaW50KF90bywgX2Ftb3VudCk7CiAgICBUcmFuc2ZlcihhZGRyZXNzKHRoaXMpLCBfdG8sIF9hbW91bnQpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHN0b3AgbWludGluZyBuZXcgdG9rZW5zLgogICAqIEByZXR1cm4gVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBwdWJsaWMgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgIG1pbnRpbmdGaW5pc2hlZCA9IHRydWU7CiAgICBNaW50RmluaXNoZWQoKTsKICAgIHJldHVybiB0cnVlOwogIH0KICAKfQoKLyoqCiAqIEB0aXRsZSBCdXJuYWJsZSBUb2tlbgogKiBAZGV2IFRva2VuIHRoYXQgY2FuIGJlIGlycmV2ZXJzaWJseSBidXJuZWQgKGRlc3Ryb3llZCkuCiAqLwpjb250cmFjdCBCdXJuYWJsZVRva2VuIGlzIE1pbnRhYmxlVG9rZW4gewoKICBldmVudCBCdXJuKGFkZHJlc3MgaW5kZXhlZCBidXJuZXIsIHVpbnQyNTYgdmFsdWUpOwoKICAvKioKICAgKiBAZGV2IEJ1cm5zIGEgc3BlY2lmaWMgYW1vdW50IG9mIHRva2Vucy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgYnVybmVkLgogICAqLwogIGZ1bmN0aW9uIGJ1cm4odWludDI1NiBfdmFsdWUpIHB1YmxpYyBvbmx5UGF5bG9hZFNpemUoMSkgewogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwogICAgLy8gbm8gbmVlZCB0byByZXF1aXJlIHZhbHVlIDw9IHRvdGFsU3VwcGx5LCBzaW5jZSB0aGF0IHdvdWxkIGltcGx5IHRoZQogICAgLy8gc2VuZGVyJ3MgYmFsYW5jZSBpcyBncmVhdGVyIHRoYW4gdGhlIHRvdGFsU3VwcGx5LCB3aGljaCAqc2hvdWxkKiBiZSBhbiBhc3NlcnRpb24gZmFpbHVyZQogICAgYWRkcmVzcyBidXJuZXIgPSBtc2cuc2VuZGVyOwogICAgYmFsYW5jZXNbYnVybmVyXSA9IGJhbGFuY2VzW2J1cm5lcl0uc3ViKF92YWx1ZSk7CiAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LnN1YihfdmFsdWUpOwogICAgQnVybihidXJuZXIsIF92YWx1ZSk7CiAgICBUcmFuc2ZlcihidXJuZXIsIGFkZHJlc3MoMCksIF92YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBidXJuRnJvbShhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIAogIG9ubHlQYXlsb2FkU2l6ZSgyKQogIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgcmVxdWlyZShiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlKTsvLyBDaGVjayBpZiB0aGUgdGFyZ2V0ZWQgYmFsYW5jZSBpcyBlbm91Z2gKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsvLyBDaGVjayBhbGxvd2FuY2UKICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsgLy8gU3VidHJhY3QgZnJvbSB0aGUgdGFyZ2V0ZWQgYmFsYW5jZQogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsgLy8gU3VidHJhY3QgZnJvbSB0aGUgc2VuZGVyJ3MgYWxsb3dhbmNlCiAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LnN1YihfdmFsdWUpOwogICAgQnVybihfZnJvbSwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogICAgfQp9Cgpjb250cmFjdCBBbHR0ZXhUb2tlbiBpcyBCdXJuYWJsZVRva2VuIHsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJBbHR0ZXgiOwogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiQUxUWCI7CiAgICB1aW50OCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSA4Owp9Cgpjb250cmFjdCBDcm93ZHNhbGUgaXMgT3duYWJsZSB7CiAgICAKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwogICAgdWludDI1NiBwdWJsaWMgc3RhcnRUaW1lUm91bmQxOwogICAgdWludDI1NiBwdWJsaWMgZW5kVGltZVJvdW5kMTsKCiAgICB1aW50MjU2IHB1YmxpYyBzdGFydFRpbWVSb3VuZDI7CiAgICB1aW50MjU2IHB1YmxpYyBlbmRUaW1lUm91bmQyOwoKICAgIC8vIG9uZSB0b2tlbiBwZXIgb25lIHJhdGUKICAgIHVpbnQyNTYgcHVibGljIHJhdGVSb3VuZDEgPSAxMjAwOwogICAgdWludDI1NiBwdWJsaWMgcmF0ZVJvdW5kMjsKCiAgICB1aW50MjU2IGNvbnN0YW50IGRlYyA9IDEwICoqIDg7CiAgICB1aW50MjU2IHB1YmxpYyBzdXBwbHkgPSA1MDAwMDAwMCAqIDEwICoqIDg7CiAgICB1aW50MjU2IHB1YmxpYyBwZXJjZW50VG9rZW5zVG9TYWxlID0gNjA7CiAgICB1aW50MjU2IHB1YmxpYyB0b2tlbnNUb1NhbGUgPSBzdXBwbHkubXVsKHBlcmNlbnRUb2tlbnNUb1NhbGUpLmRpdigxMDApOwogICAgLy8gYWRkcmVzcyB3aGVyZSBmdW5kcyBhcmUgY29sbGVjdGVkCiAgICBhZGRyZXNzIHB1YmxpYyB3YWxsZXQ7CgogICAgQWx0dGV4VG9rZW4gcHVibGljIHRva2VuOwogICAgLy8gQW1vdW50IG9mIHJhaXNlZCBtb25leSBpbiB3ZWkKICAgIHVpbnQyNTYgcHVibGljIHdlaVJhaXNlZCA9IDE3NDcyICogMTAgKiogMTY7IC8vIDE3NC43MiBFVEgKICAgIHVpbnQyNTYgcHVibGljIG1pblRva2Vuc1RvU2FsZSA9IDQ1ICogZGVjOwogICAgLy8gQ29tcGFueSBhZGRyZXNzZXMKICAgIGFkZHJlc3MgcHVibGljIFRlYW1BbmRBZHZpc29yczsKICAgIGFkZHJlc3MgcHVibGljIEludmVzdG9yczsKCiAgICB1aW50MjU2IHRpbWVCb251czEgPSAyMDsKICAgIHVpbnQyNTYgdGltZUJvbnVzMiA9IDEwOwoKICAgIC8vIFJvdW5kIGJvbnVzZXMKICAgIHVpbnQyNTYgYm9udXMxID0gMTA7CiAgICB1aW50MjU2IGJvbnVzMiA9IDE1OwogICAgdWludDI1NiBib251czMgPSAyMDsKICAgIHVpbnQyNTYgYm9udXM0ID0gMzA7CgogICAgLy8gQW1vdW50IGJvbnVzZXMKICAgIHVpbnQyNTYgYW1vdW50MSA9IDUwMCAqIGRlYzsKICAgIHVpbnQyNTYgYW1vdW50MiA9IDEwMDAgKiBkZWM7CiAgICB1aW50MjU2IGFtb3VudDMgPSA1MDAwICogZGVjOwogICAgdWludDI1NiBhbW91bnQ0ID0gMTAwMDAgKiBkZWM7CgogICAgYm9vbCBpbml0YWxNaW50ZWQgPSBmYWxzZTsKICAgIGJvb2wgY2hlY2tCb251cyA9IGZhbHNlOwoKICAgIGZ1bmN0aW9uIENyb3dkc2FsZSgKICAgICAgICBhZGRyZXNzIF90b2tlbiwKICAgICAgICB1aW50MjU2IF9zdGFydFRpbWVSb3VuZDEsIC8vIDE1MjAxMjE2MDAgLSAwMy8wNC8yMDE4IEAgMTI6MDBhbSAoVVRDKQogICAgICAgIHVpbnQyNTYgX3N0YXJ0VGltZVJvdW5kMiwgLy8gMTUyMTQxNzYwMCAtIDAzLzE5LzIwMTggQCAxMjowMGFtIChVVEMpCiAgICAgICAgdWludDI1NiBfZW5kVGltZVJvdW5kMSwgLy8gMTUyMTQxNzYwMCAtIDAzLzE5LzIwMTggQCAxMjowMGFtIChVVEMpCiAgICAgICAgdWludDI1NiBfZW5kVGltZVJvdW5kMiwgLy8gMTUyNTMwNTYwMCAtIDA1LzAzLzIwMTggQCAxMjowMGFtIChVVEMpCiAgICAgICAgYWRkcmVzcyBfd2FsbGV0LAogICAgICAgIGFkZHJlc3MgX1RlYW1BbmRBZHZpc29ycywKICAgICAgICBhZGRyZXNzIF9JbnZlc3RvcnMpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfdG9rZW4gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfZW5kVGltZVJvdW5kMSA+IF9zdGFydFRpbWVSb3VuZDEpOwogICAgICAgIHJlcXVpcmUoX2VuZFRpbWVSb3VuZDIgPiBfc3RhcnRUaW1lUm91bmQyKTsKICAgICAgICByZXF1aXJlKF93YWxsZXQgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfVGVhbUFuZEFkdmlzb3JzICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX0ludmVzdG9ycyAhPSBhZGRyZXNzKDApKTsKICAgICAgICB0b2tlbiA9IEFsdHRleFRva2VuKF90b2tlbik7CiAgICAgICAgc3RhcnRUaW1lUm91bmQxID0gX3N0YXJ0VGltZVJvdW5kMTsKICAgICAgICBzdGFydFRpbWVSb3VuZDIgPSBfc3RhcnRUaW1lUm91bmQyOwogICAgICAgIGVuZFRpbWVSb3VuZDEgPSBfZW5kVGltZVJvdW5kMTsKICAgICAgICBlbmRUaW1lUm91bmQyID0gX2VuZFRpbWVSb3VuZDI7CiAgICAgICAgd2FsbGV0ID0gX3dhbGxldDsKICAgICAgICBUZWFtQW5kQWR2aXNvcnMgPSBfVGVhbUFuZEFkdmlzb3JzOwogICAgICAgIEludmVzdG9ycyA9IF9JbnZlc3RvcnM7CiAgICB9CgogICAgZnVuY3Rpb24gaW5pdGlhbE1pbnQoKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKCFpbml0YWxNaW50ZWQpOwogICAgICAgIHVpbnQyNTYgX2luaXRpYWxSYWlzZWQgPSAxNzQ3MiAqIDEwICoqIDE2OwogICAgICAgIHVpbnQyNTYgX3Rva2VucyA9IF9pbml0aWFsUmFpc2VkLm11bCgxNTAwKS5kaXYoMTAgKiogMTApOwogICAgICAgIHRva2VuLm1pbnQoSW52ZXN0b3JzLCBfdG9rZW5zLmFkZChfdG9rZW5zLm11bCg0MCkuZGl2KDEwMCkpKTsKICAgICAgICBpbml0YWxNaW50ZWQgPSB0cnVlOwogICAgfQoKICAgIG1vZGlmaWVyIHNhbGVJc09uKCkgewogICAgICAgIHVpbnQgdG9rZW5TdXBwbHkgPSB0b2tlbi50b3RhbFN1cHBseSgpOwogICAgICAgIHJlcXVpcmUobm93ID4gc3RhcnRUaW1lUm91bmQxICYmIG5vdyA8IGVuZFRpbWVSb3VuZDIpOwogICAgICAgIHJlcXVpcmUodG9rZW5TdXBwbHkgPD0gdG9rZW5zVG9TYWxlKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFBlcmNlbnRUb2tlbnNUb1NhbGUoCiAgICAgICAgdWludDI1NiBfbmV3UGVyY2VudFRva2Vuc1RvU2FsZSkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcGVyY2VudFRva2Vuc1RvU2FsZSA9IF9uZXdQZXJjZW50VG9rZW5zVG9TYWxlOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldE1pblRva2Vuc1RvU2FsZSgKICAgICAgICB1aW50MjU2IF9uZXdNaW5Ub2tlbnNUb1NhbGUpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIG1pblRva2Vuc1RvU2FsZSA9IF9uZXdNaW5Ub2tlbnNUb1NhbGU7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0Q2hlY2tCb251cygKICAgICAgICBib29sIF9uZXdDaGVja0JvbnVzKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICBjaGVja0JvbnVzID0gX25ld0NoZWNrQm9udXM7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0QW1vdW50KAogICAgICAgIHVpbnQyNTYgX25ld0Ftb3VudDEsCiAgICAgICAgdWludDI1NiBfbmV3QW1vdW50MiwKICAgICAgICB1aW50MjU2IF9uZXdBbW91bnQzLAogICAgICAgIHVpbnQyNTYgX25ld0Ftb3VudDQpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGFtb3VudDEgPSBfbmV3QW1vdW50MTsKICAgICAgICBhbW91bnQyID0gX25ld0Ftb3VudDI7CiAgICAgICAgYW1vdW50MyA9IF9uZXdBbW91bnQzOwogICAgICAgIGFtb3VudDQgPSBfbmV3QW1vdW50NDsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRCb251c2VzKAogICAgICAgIHVpbnQyNTYgX25ld0JvbnVzMSwKICAgICAgICB1aW50MjU2IF9uZXdCb251czIsCiAgICAgICAgdWludDI1NiBfbmV3Qm9udXMzLAogICAgICAgIHVpbnQyNTYgX25ld0JvbnVzNCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgYm9udXMxID0gX25ld0JvbnVzMTsKICAgICAgICBib251czIgPSBfbmV3Qm9udXMyOwogICAgICAgIGJvbnVzMyA9IF9uZXdCb251czM7CiAgICAgICAgYm9udXM0ID0gX25ld0JvbnVzNDsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRSb3VuZFRpbWUoCiAgICAgIHVpbnQyNTYgX25ld1N0YXJ0VGltZVJvdW5kMiwKICAgICAgdWludDI1NiBfbmV3RW5kVGltZVJvdW5kMikgb25seU93bmVyIHB1YmxpYyB7CiAgICAgIHJlcXVpcmUoX25ld0VuZFRpbWVSb3VuZDIgPiBfbmV3U3RhcnRUaW1lUm91bmQyKTsKICAgICAgICBzdGFydFRpbWVSb3VuZDIgPSBfbmV3U3RhcnRUaW1lUm91bmQyOwogICAgICAgIGVuZFRpbWVSb3VuZDIgPSBfbmV3RW5kVGltZVJvdW5kMjsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRSYXRlKHVpbnQyNTYgX25ld1JhdGVSb3VuZDIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJhdGVSb3VuZDIgPSBfbmV3UmF0ZVJvdW5kMjsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRUaW1lQm9udXModWludDI1NiBfbmV3VGltZUJvbnVzKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICB0aW1lQm9udXMyID0gX25ld1RpbWVCb251czsKICAgIH0KIAogICAgZnVuY3Rpb24gc2V0VGVhbUFkZHJlc3MoCiAgICAgICAgYWRkcmVzcyBfbmV3VGVhbUFuZEFkdmlzb3JzLAogICAgICAgIGFkZHJlc3MgX25ld0ludmVzdG9ycywKICAgICAgICBhZGRyZXNzIF9uZXdXYWxsZXQpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX25ld1RlYW1BbmRBZHZpc29ycyAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF9uZXdJbnZlc3RvcnMgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZShfbmV3V2FsbGV0ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIFRlYW1BbmRBZHZpc29ycyA9IF9uZXdUZWFtQW5kQWR2aXNvcnM7CiAgICAgICAgSW52ZXN0b3JzID0gX25ld0ludmVzdG9yczsKICAgICAgICB3YWxsZXQgPSBfbmV3V2FsbGV0OwogICAgfQoKCiAgICBmdW5jdGlvbiBnZXRBbW91bnQodWludDI1NiBfdmFsdWUpIGludGVybmFsIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYW1vdW50ID0gMDsKICAgICAgICB1aW50MjU2IGFsbCA9IDEwMDsKICAgICAgICB1aW50MjU2IHRva2VuU3VwcGx5ID0gdG9rZW4udG90YWxTdXBwbHkoKTsKICAgICAgICBpZihub3cgPj0gc3RhcnRUaW1lUm91bmQxICYmIG5vdyA8IGVuZFRpbWVSb3VuZDEpIHsgLy8gUm91bmQgMQogICAgICAgICAgICBhbW91bnQgPSBfdmFsdWUubXVsKHJhdGVSb3VuZDEpOwogICAgICAgICAgICBhbW91bnQgPSBhbW91bnQuYWRkKGFtb3VudC5tdWwodGltZUJvbnVzMSkuZGl2KGFsbCkpOwogICAgICAgIH0gZWxzZSBpZihub3cgPj0gc3RhcnRUaW1lUm91bmQyICYmIG5vdyA8IGVuZFRpbWVSb3VuZDIpIHsgLy8gUm91bmQgMgogICAgICAgICAgICBhbW91bnQgPSBfdmFsdWUubXVsKHJhdGVSb3VuZDIpOwogICAgICAgICAgICBhbW91bnQgPSBhbW91bnQuYWRkKGFtb3VudC5tdWwodGltZUJvbnVzMikuZGl2KGFsbCkpOwogICAgICAgIH0gCiAgICAgICAgcmVxdWlyZShhbW91bnQgPj0gbWluVG9rZW5zVG9TYWxlKTsKICAgICAgICByZXF1aXJlKGFtb3VudCAhPSAwICYmIGFtb3VudC5hZGQodG9rZW5TdXBwbHkpIDwgdG9rZW5zVG9TYWxlKTsKICAgICAgICByZXR1cm4gYW1vdW50OwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEJvbnVzKHVpbnQyNTYgX3ZhbHVlKSBpbnRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBpZihfdmFsdWUgPj0gYW1vdW50MSAmJiBfdmFsdWUgPCBhbW91bnQyKSB7IAogICAgICAgICAgICByZXR1cm4gYm9udXMxOwogICAgICAgIH0gZWxzZSBpZihfdmFsdWUgPj0gYW1vdW50MiAmJiBfdmFsdWUgPCBhbW91bnQzKSB7CiAgICAgICAgICAgIHJldHVybiBib251czI7CiAgICAgICAgfSBlbHNlIGlmKF92YWx1ZSA+PSBhbW91bnQzICYmIF92YWx1ZSA8IGFtb3VudDQpIHsKICAgICAgICAgICAgcmV0dXJuIGJvbnVzMzsKICAgICAgICB9IGVsc2UgaWYoX3ZhbHVlID49IGFtb3VudDQpIHsKICAgICAgICAgICAgcmV0dXJuIGJvbnVzNDsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAqIGV2ZW50cyBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAgKiBAcGFyYW0gcHVyY2hhc2VyIHdobyBwYWlkIGZvciB0aGUgdG9rZW5zCiAgICAqIEBwYXJhbSBiZW5lZmljaWFyeSB3aG8gZ290IHRoZSB0b2tlbnMKICAgICogQHBhcmFtIHZhbHVlIHdlaXMgcGFpZCBmb3IgcHVyY2hhc2UKICAgICogQHBhcmFtIGFtb3VudCBhbW91bnQgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAgKi8KICAgIGV2ZW50IFRva2VuUHVyY2hhc2UoYWRkcmVzcyBpbmRleGVkIHB1cmNoYXNlciwgYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IGFtb3VudCk7CiAgICBldmVudCBUb2tlblBhcnRuZXJzKGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiBhbW91bnQpOwoKICAgIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KSBzYWxlSXNPbiBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgcmVxdWlyZShiZW5lZmljaWFyeSAhPSBhZGRyZXNzKDApKTsKICAgICAgICB1aW50MjU2IHdlaUFtb3VudCA9IChtc2cudmFsdWUpLmRpdigxMCAqKiAxMCk7CgogICAgICAgIC8vIGNhbGN1bGF0ZSB0b2tlbiBhbW91bnQgdG8gYmUgY3JlYXRlZAogICAgICAgIHVpbnQyNTYgdG9rZW5zID0gZ2V0QW1vdW50KHdlaUFtb3VudCk7CgogICAgICAgIGlmKGNoZWNrQm9udXMpIHsKICAgICAgICAgIHVpbnQyNTYgYm9udXNOb3cgPSBnZXRCb251cyh0b2tlbnMpOwogICAgICAgICAgdG9rZW5zID0gdG9rZW5zLmFkZCh0b2tlbnMubXVsKGJvbnVzTm93KS5kaXYoMTAwKSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHdlaVJhaXNlZCA9IHdlaVJhaXNlZC5hZGQobXNnLnZhbHVlKTsKICAgICAgICB0b2tlbi5taW50KGJlbmVmaWNpYXJ5LCB0b2tlbnMpOwogICAgICAgIFRva2VuUHVyY2hhc2UobXNnLnNlbmRlciwgYmVuZWZpY2lhcnksIHdlaUFtb3VudCwgdG9rZW5zKTsKCiAgICAgICAgd2FsbGV0LnRyYW5zZmVyKG1zZy52YWx1ZSk7CgogICAgICAgIHVpbnQyNTYgdGFhVG9rZW5zID0gdG9rZW5zLm11bCgyMCkuZGl2KDEwMCk7CiAgICAgICAgdG9rZW4ubWludChUZWFtQW5kQWR2aXNvcnMsIHRhYVRva2Vucyk7CiAgICAgICAgVG9rZW5QYXJ0bmVycyhtc2cuc2VuZGVyLCBUZWFtQW5kQWR2aXNvcnMsIHRhYVRva2Vucyk7CiAgICB9CgogICAgLy8gZmFsbGJhY2sgZnVuY3Rpb24gY2FuIGJlIHVzZWQgdG8gYnV5IHRva2VucwogICAgZnVuY3Rpb24gKCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwogICAgfQoKICAgIC8vIEByZXR1cm4gdHJ1ZSBpZiB0b2tlbnNhbGUgZXZlbnQgaGFzIGVuZGVkCiAgICBmdW5jdGlvbiBoYXNFbmRlZCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gbm93ID4gZW5kVGltZVJvdW5kMjsKICAgIH0KCiAgICBmdW5jdGlvbiBraWxsKCkgb25seU93bmVyIHB1YmxpYyB7IHNlbGZkZXN0cnVjdChvd25lcik7IH0KICAgIAp9'.
	

]
