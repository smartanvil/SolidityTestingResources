Class {
	#name : #SRT8c4ccf23d8674a04665e9e7a64260aa4c0030aeb,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT8c4ccf23d8674a04665e9e7a64260aa4c0030aeb >> base64 [
	^ 'Ly8gQ29weXJpZ2h0IChDKSAyMDE3ICBNaXhCeXRlcywgTExDCgovLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKS4KLy8gWW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoKLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQovLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAovLyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCAoZXhwcmVzcyBvciBpbXBsaWVkKS4KCnByYWdtYSBzb2xpZGl0eSBeMC40LjE1OwoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGlmIChhID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoYiA8PSBhKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgICAgICBhc3NlcnQoYyA+PSBhKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KfQoKCi8qKgogKiBAdGl0bGUgSGVscHMgY29udHJhY3RzIGd1YXJkIGFnYWlucyByZW50cmFuY3kgYXR0YWNrcy4KICogQGF1dGhvciBSZW1jbyBCbG9lbWVuIDw8YSBocmVmPSIvY2RuLWNnaS9sL2VtYWlsLXByb3RlY3Rpb24iIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iNmExODBmMDcwOTA1MmE1OCI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvYT7PgC5jb20+CiAqIEBub3RpY2UgSWYgeW91IG1hcmsgYSBmdW5jdGlvbiBgbm9uUmVlbnRyYW50YCwgeW91IHNob3VsZCBhbHNvCiAqIG1hcmsgaXQgYGV4dGVybmFsYC4KICovCmNvbnRyYWN0IFJlZW50cmFuY3lHdWFyZCB7CgogICAgLyoqCiAgICAgKiBAZGV2IFdlIHVzZSBhIHNpbmdsZSBsb2NrIGZvciB0aGUgd2hvbGUgY29udHJhY3QuCiAgICAgKi8KICAgIGJvb2wgcHJpdmF0ZSByZW50cmFuY3lfbG9jayA9IGZhbHNlOwoKICAgIC8qKgogICAgICogQGRldiBQcmV2ZW50cyBhIGNvbnRyYWN0IGZyb20gY2FsbGluZyBpdHNlbGYsIGRpcmVjdGx5IG9yIGluZGlyZWN0bHkuCiAgICAgKiBAbm90aWNlIElmIHlvdSBtYXJrIGEgZnVuY3Rpb24gYG5vblJlZW50cmFudGAsIHlvdSBzaG91bGQgYWxzbwogICAgICogbWFyayBpdCBgZXh0ZXJuYWxgLiBDYWxsaW5nIG9uZSBub25SZWVudHJhbnQgZnVuY3Rpb24gZnJvbQogICAgICogYW5vdGhlciBpcyBub3Qgc3VwcG9ydGVkLiBJbnN0ZWFkLCB5b3UgY2FuIGltcGxlbWVudCBhCiAgICAgKiBgcHJpdmF0ZWAgZnVuY3Rpb24gZG9pbmcgdGhlIGFjdHVhbCB3b3JrLCBhbmQgYSBgZXh0ZXJuYWxgCiAgICAgKiB3cmFwcGVyIG1hcmtlZCBhcyBgbm9uUmVlbnRyYW50YC4KICAgICAqLwogICAgbW9kaWZpZXIgbm9uUmVlbnRyYW50KCkgewogICAgICAgIHJlcXVpcmUoIXJlbnRyYW5jeV9sb2NrKTsKICAgICAgICByZW50cmFuY3lfbG9jayA9IHRydWU7CiAgICAgICAgXzsKICAgICAgICByZW50cmFuY3lfbG9jayA9IGZhbHNlOwogICAgfQoKfQoKCi8vLyBub3RlOiBkdXJpbmcgYW55IG93bmVyc2hpcCBjaGFuZ2VzIGFsbCBwZW5kaW5nIG9wZXJhdGlvbnMgKHdhaXRpbmcgZm9yIG1vcmUgc2lnbmF0dXJlcykgYXJlIGNhbmNlbGxlZAovLyBUT0RPIGFjY2VwdE93bmVyc2hpcApjb250cmFjdCBtdWx0aW93bmVkIHsKCiAgICAvLyBUWVBFUwoKICAgIC8vIHN0cnVjdCBmb3IgdGhlIHN0YXR1cyBvZiBhIHBlbmRpbmcgb3BlcmF0aW9uLgogICAgc3RydWN0IE11bHRpT3duZWRPcGVyYXRpb25QZW5kaW5nU3RhdGUgewogICAgLy8gY291bnQgb2YgY29uZmlybWF0aW9ucyBuZWVkZWQKICAgIHVpbnQgeWV0TmVlZGVkOwoKICAgIC8vIGJpdG1hcCBvZiBjb25maXJtYXRpb25zIHdoZXJlIG93bmVyICNvd25lckluZGV4J3MgZGVjaXNpb24gY29ycmVzcG9uZHMgdG8gMioqb3duZXJJbmRleCBiaXQKICAgIHVpbnQgb3duZXJzRG9uZTsKCiAgICAvLyBwb3NpdGlvbiBvZiB0aGlzIG9wZXJhdGlvbiBrZXkgaW4gbV9tdWx0aU93bmVkUGVuZGluZ0luZGV4CiAgICB1aW50IGluZGV4OwogICAgfQoKICAgIC8vIEVWRU5UUwoKICAgIGV2ZW50IENvbmZpcm1hdGlvbihhZGRyZXNzIG93bmVyLCBieXRlczMyIG9wZXJhdGlvbik7CiAgICBldmVudCBSZXZva2UoYWRkcmVzcyBvd25lciwgYnl0ZXMzMiBvcGVyYXRpb24pOwogICAgZXZlbnQgRmluYWxDb25maXJtYXRpb24oYWRkcmVzcyBvd25lciwgYnl0ZXMzMiBvcGVyYXRpb24pOwoKICAgIC8vIHNvbWUgb3RoZXJzIGFyZSBpbiB0aGUgY2FzZSBvZiBhbiBvd25lciBjaGFuZ2luZy4KICAgIGV2ZW50IE93bmVyQ2hhbmdlZChhZGRyZXNzIG9sZE93bmVyLCBhZGRyZXNzIG5ld093bmVyKTsKICAgIGV2ZW50IE93bmVyQWRkZWQoYWRkcmVzcyBuZXdPd25lcik7CiAgICBldmVudCBPd25lclJlbW92ZWQoYWRkcmVzcyBvbGRPd25lcik7CgogICAgLy8gdGhlIGxhc3Qgb25lIGlzIGVtaXR0ZWQgaWYgdGhlIHJlcXVpcmVkIHNpZ25hdHVyZXMgY2hhbmdlCiAgICBldmVudCBSZXF1aXJlbWVudENoYW5nZWQodWludCBuZXdSZXF1aXJlbWVudCk7CgogICAgLy8gTU9ESUZJRVJTCgogICAgLy8gc2ltcGxlIHNpbmdsZS1zaWcgZnVuY3Rpb24gbW9kaWZpZXIuCiAgICBtb2RpZmllciBvbmx5b3duZXIgewogICAgICAgIHJlcXVpcmUoaXNPd25lcihtc2cuc2VuZGVyKSk7CiAgICAgICAgXzsKICAgIH0KICAgIC8vIG11bHRpLXNpZyBmdW5jdGlvbiBtb2RpZmllcjogdGhlIG9wZXJhdGlvbiBtdXN0IGhhdmUgYW4gaW50cmluc2ljIGhhc2ggaW4gb3JkZXIKICAgIC8vIHRoYXQgbGF0ZXIgYXR0ZW1wdHMgY2FuIGJlIHJlYWxpc2VkIGFzIHRoZSBzYW1lIHVuZGVybHlpbmcgb3BlcmF0aW9uIGFuZAogICAgLy8gdGh1cyBjb3VudCBhcyBjb25maXJtYXRpb25zLgogICAgbW9kaWZpZXIgb25seW1hbnlvd25lcnMoYnl0ZXMzMiBfb3BlcmF0aW9uKSB7CiAgICAgICAgaWYgKGNvbmZpcm1BbmRDaGVjayhfb3BlcmF0aW9uKSkgewogICAgICAgICAgICBfOwogICAgICAgIH0KICAgICAgICAvLyBFdmVuIGlmIHJlcXVpcmVkIG51bWJlciBvZiBjb25maXJtYXRpb25zIGhhcyd0IGJlZW4gY29sbGVjdGVkIHlldCwKICAgICAgICAvLyB3ZSBjYW4ndCB0aHJvdyBoZXJlIC0gYmVjYXVzZSBjaGFuZ2VzIHRvIHRoZSBzdGF0ZSBoYXZlIHRvIGJlIHByZXNlcnZlZC4KICAgICAgICAvLyBCdXQsIGNvbmZpcm1BbmRDaGVjayBpdHNlbGYgd2lsbCB0aHJvdyBpbiBjYXNlIHNlbmRlciBpcyBub3QgYW4gb3duZXIuCiAgICB9CgogICAgbW9kaWZpZXIgdmFsaWROdW1Pd25lcnModWludCBfbnVtT3duZXJzKSB7CiAgICAgICAgcmVxdWlyZShfbnVtT3duZXJzID4gMCAmJiBfbnVtT3duZXJzIDw9IGNfbWF4T3duZXJzKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG11bHRpT3duZWRWYWxpZFJlcXVpcmVtZW50KHVpbnQgX3JlcXVpcmVkLCB1aW50IF9udW1Pd25lcnMpIHsKICAgICAgICByZXF1aXJlKF9yZXF1aXJlZCA+IDAgJiYgX3JlcXVpcmVkIDw9IF9udW1Pd25lcnMpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb3duZXJFeGlzdHMoYWRkcmVzcyBfYWRkcmVzcykgewogICAgICAgIHJlcXVpcmUoaXNPd25lcihfYWRkcmVzcykpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb3duZXJEb2VzTm90RXhpc3QoYWRkcmVzcyBfYWRkcmVzcykgewogICAgICAgIHJlcXVpcmUoIWlzT3duZXIoX2FkZHJlc3MpKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG11bHRpT3duZWRPcGVyYXRpb25Jc0FjdGl2ZShieXRlczMyIF9vcGVyYXRpb24pIHsKICAgICAgICByZXF1aXJlKGlzT3BlcmF0aW9uQWN0aXZlKF9vcGVyYXRpb24pKTsKICAgICAgICBfOwogICAgfQoKICAgIC8vIE1FVEhPRFMKCiAgICAvLyBjb25zdHJ1Y3RvciBpcyBnaXZlbiBudW1iZXIgb2Ygc2lncyByZXF1aXJlZCB0byBkbyBwcm90ZWN0ZWQgIm9ubHltYW55b3duZXJzIiB0cmFuc2FjdGlvbnMKICAgIC8vIGFzIHdlbGwgYXMgdGhlIHNlbGVjdGlvbiBvZiBhZGRyZXNzZXMgY2FwYWJsZSBvZiBjb25maXJtaW5nIHRoZW0gKG1zZy5zZW5kZXIgaXMgbm90IGFkZGVkIHRvIHRoZSBvd25lcnMhKS4KICAgIGZ1bmN0aW9uIG11bHRpb3duZWQoYWRkcmVzc1tdIF9vd25lcnMsIHVpbnQgX3JlcXVpcmVkKQogICAgdmFsaWROdW1Pd25lcnMoX293bmVycy5sZW5ndGgpCiAgICBtdWx0aU93bmVkVmFsaWRSZXF1aXJlbWVudChfcmVxdWlyZWQsIF9vd25lcnMubGVuZ3RoKQogICAgewogICAgICAgIGFzc2VydChjX21heE93bmVycyA8PSAyNTUpOwoKICAgICAgICBtX251bU93bmVycyA9IF9vd25lcnMubGVuZ3RoOwogICAgICAgIG1fbXVsdGlPd25lZFJlcXVpcmVkID0gX3JlcXVpcmVkOwoKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBfb3duZXJzLmxlbmd0aDsgKytpKQogICAgICAgIHsKICAgICAgICAgICAgYWRkcmVzcyBvd25lciA9IF9vd25lcnNbaV07CiAgICAgICAgICAgIC8vIGludmFsaWQgYW5kIGR1cGxpY2F0ZSBhZGRyZXNzZXMgYXJlIG5vdCBhbGxvd2VkCiAgICAgICAgICAgIHJlcXVpcmUoMCAhPSBvd25lciAmJiAhaXNPd25lcihvd25lcikgLyogbm90IGlzT3duZXIgeWV0ISAqLyk7CgogICAgICAgICAgICB1aW50IGN1cnJlbnRPd25lckluZGV4ID0gY2hlY2tPd25lckluZGV4KGkgKyAxIC8qIGZpcnN0IHNsb3QgaXMgdW51c2VkICovKTsKICAgICAgICAgICAgbV9vd25lcnNbY3VycmVudE93bmVySW5kZXhdID0gb3duZXI7CiAgICAgICAgICAgIG1fb3duZXJJbmRleFtvd25lcl0gPSBjdXJyZW50T3duZXJJbmRleDsKICAgICAgICB9CgogICAgICAgIGFzc2VydE93bmVyc0FyZUNvbnNpc3RlbnQoKTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSByZXBsYWNlcyBhbiBvd25lciBgX2Zyb21gIHdpdGggYW5vdGhlciBgX3RvYC4KICAgIC8vLyBAcGFyYW0gX2Zyb20gYWRkcmVzcyBvZiBvd25lciB0byByZXBsYWNlCiAgICAvLy8gQHBhcmFtIF90byBhZGRyZXNzIG9mIG5ldyBvd25lcgogICAgLy8gQWxsIHBlbmRpbmcgb3BlcmF0aW9ucyB3aWxsIGJlIGNhbmNlbGVkIQogICAgZnVuY3Rpb24gY2hhbmdlT3duZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8pCiAgICBleHRlcm5hbAogICAgb3duZXJFeGlzdHMoX2Zyb20pCiAgICBvd25lckRvZXNOb3RFeGlzdChfdG8pCiAgICBvbmx5bWFueW93bmVycyhzaGEzKG1zZy5kYXRhKSkKICAgIHsKICAgICAgICBhc3NlcnRPd25lcnNBcmVDb25zaXN0ZW50KCk7CgogICAgICAgIGNsZWFyUGVuZGluZygpOwogICAgICAgIHVpbnQgb3duZXJJbmRleCA9IGNoZWNrT3duZXJJbmRleChtX293bmVySW5kZXhbX2Zyb21dKTsKICAgICAgICBtX293bmVyc1tvd25lckluZGV4XSA9IF90bzsKICAgICAgICBtX293bmVySW5kZXhbX2Zyb21dID0gMDsKICAgICAgICBtX293bmVySW5kZXhbX3RvXSA9IG93bmVySW5kZXg7CgogICAgICAgIGFzc2VydE93bmVyc0FyZUNvbnNpc3RlbnQoKTsKICAgICAgICBPd25lckNoYW5nZWQoX2Zyb20sIF90byk7CiAgICB9CgogICAgLy8vIEBub3RpY2UgYWRkcyBhbiBvd25lcgogICAgLy8vIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBvZiBuZXcgb3duZXIKICAgIC8vIEFsbCBwZW5kaW5nIG9wZXJhdGlvbnMgd2lsbCBiZSBjYW5jZWxlZCEKICAgIGZ1bmN0aW9uIGFkZE93bmVyKGFkZHJlc3MgX293bmVyKQogICAgZXh0ZXJuYWwKICAgIG93bmVyRG9lc05vdEV4aXN0KF9vd25lcikKICAgIHZhbGlkTnVtT3duZXJzKG1fbnVtT3duZXJzICsgMSkKICAgIG9ubHltYW55b3duZXJzKHNoYTMobXNnLmRhdGEpKQogICAgewogICAgICAgIGFzc2VydE93bmVyc0FyZUNvbnNpc3RlbnQoKTsKCiAgICAgICAgY2xlYXJQZW5kaW5nKCk7CiAgICAgICAgbV9udW1Pd25lcnMrKzsKICAgICAgICBtX293bmVyc1ttX251bU93bmVyc10gPSBfb3duZXI7CiAgICAgICAgbV9vd25lckluZGV4W19vd25lcl0gPSBjaGVja093bmVySW5kZXgobV9udW1Pd25lcnMpOwoKICAgICAgICBhc3NlcnRPd25lcnNBcmVDb25zaXN0ZW50KCk7CiAgICAgICAgT3duZXJBZGRlZChfb3duZXIpOwogICAgfQoKICAgIC8vLyBAbm90aWNlIHJlbW92ZXMgYW4gb3duZXIKICAgIC8vLyBAcGFyYW0gX293bmVyIGFkZHJlc3Mgb2Ygb3duZXIgdG8gcmVtb3ZlCiAgICAvLyBBbGwgcGVuZGluZyBvcGVyYXRpb25zIHdpbGwgYmUgY2FuY2VsZWQhCiAgICBmdW5jdGlvbiByZW1vdmVPd25lcihhZGRyZXNzIF9vd25lcikKICAgIGV4dGVybmFsCiAgICBvd25lckV4aXN0cyhfb3duZXIpCiAgICB2YWxpZE51bU93bmVycyhtX251bU93bmVycyAtIDEpCiAgICBtdWx0aU93bmVkVmFsaWRSZXF1aXJlbWVudChtX211bHRpT3duZWRSZXF1aXJlZCwgbV9udW1Pd25lcnMgLSAxKQogICAgb25seW1hbnlvd25lcnMoc2hhMyhtc2cuZGF0YSkpCiAgICB7CiAgICAgICAgYXNzZXJ0T3duZXJzQXJlQ29uc2lzdGVudCgpOwoKICAgICAgICBjbGVhclBlbmRpbmcoKTsKICAgICAgICB1aW50IG93bmVySW5kZXggPSBjaGVja093bmVySW5kZXgobV9vd25lckluZGV4W19vd25lcl0pOwogICAgICAgIG1fb3duZXJzW293bmVySW5kZXhdID0gMDsKICAgICAgICBtX293bmVySW5kZXhbX293bmVyXSA9IDA7CiAgICAgICAgLy9tYWtlIHN1cmUgbV9udW1Pd25lcnMgaXMgZXF1YWwgdG8gdGhlIG51bWJlciBvZiBvd25lcnMgYW5kIGFsd2F5cyBwb2ludHMgdG8gdGhlIGxhc3Qgb3duZXIKICAgICAgICByZW9yZ2FuaXplT3duZXJzKCk7CgogICAgICAgIGFzc2VydE93bmVyc0FyZUNvbnNpc3RlbnQoKTsKICAgICAgICBPd25lclJlbW92ZWQoX293bmVyKTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBjaGFuZ2VzIHRoZSByZXF1aXJlZCBudW1iZXIgb2Ygb3duZXIgc2lnbmF0dXJlcwogICAgLy8vIEBwYXJhbSBfbmV3UmVxdWlyZWQgbmV3IG51bWJlciBvZiBzaWduYXR1cmVzIHJlcXVpcmVkCiAgICAvLyBBbGwgcGVuZGluZyBvcGVyYXRpb25zIHdpbGwgYmUgY2FuY2VsZWQhCiAgICBmdW5jdGlvbiBjaGFuZ2VSZXF1aXJlbWVudCh1aW50IF9uZXdSZXF1aXJlZCkKICAgIGV4dGVybmFsCiAgICBtdWx0aU93bmVkVmFsaWRSZXF1aXJlbWVudChfbmV3UmVxdWlyZWQsIG1fbnVtT3duZXJzKQogICAgb25seW1hbnlvd25lcnMoc2hhMyhtc2cuZGF0YSkpCiAgICB7CiAgICAgICAgbV9tdWx0aU93bmVkUmVxdWlyZWQgPSBfbmV3UmVxdWlyZWQ7CiAgICAgICAgY2xlYXJQZW5kaW5nKCk7CiAgICAgICAgUmVxdWlyZW1lbnRDaGFuZ2VkKF9uZXdSZXF1aXJlZCk7CiAgICB9CgogICAgLy8vIEBub3RpY2UgR2V0cyBhbiBvd25lciBieSAwLWluZGV4ZWQgcG9zaXRpb24KICAgIC8vLyBAcGFyYW0gb3duZXJJbmRleCAwLWluZGV4ZWQgb3duZXIgcG9zaXRpb24KICAgIGZ1bmN0aW9uIGdldE93bmVyKHVpbnQgb3duZXJJbmRleCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MpIHsKICAgICAgICByZXR1cm4gbV9vd25lcnNbb3duZXJJbmRleCArIDFdOwogICAgfQoKICAgIC8vLyBAbm90aWNlIEdldHMgb3duZXJzCiAgICAvLy8gQHJldHVybiBtZW1vcnkgYXJyYXkgb2Ygb3duZXJzCiAgICBmdW5jdGlvbiBnZXRPd25lcnMoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzc1tdKSB7CiAgICAgICAgYWRkcmVzc1tdIG1lbW9yeSByZXN1bHQgPSBuZXcgYWRkcmVzc1tdKG1fbnVtT3duZXJzKTsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBtX251bU93bmVyczsgaSsrKQogICAgICAgIHJlc3VsdFtpXSA9IGdldE93bmVyKGkpOwoKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICAgIC8vLyBAbm90aWNlIGNoZWNrcyBpZiBwcm92aWRlZCBhZGRyZXNzIGlzIGFuIG93bmVyIGFkZHJlc3MKICAgIC8vLyBAcGFyYW0gX2FkZHIgYWRkcmVzcyB0byBjaGVjawogICAgLy8vIEByZXR1cm4gdHJ1ZSBpZiBpdCdzIGFuIG93bmVyCiAgICBmdW5jdGlvbiBpc093bmVyKGFkZHJlc3MgX2FkZHIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIG1fb3duZXJJbmRleFtfYWRkcl0gPiAwOwogICAgfQoKICAgIC8vLyBAbm90aWNlIFRlc3RzIG93bmVyc2hpcCBvZiB0aGUgY3VycmVudCBjYWxsZXIuCiAgICAvLy8gQHJldHVybiB0cnVlIGlmIGl0J3MgYW4gb3duZXIKICAgIC8vIEl0J3MgYWR2aXNhYmxlIHRvIGNhbGwgaXQgYnkgbmV3IG93bmVyIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSBzYW1lIGVycm9uZW91cyBhZGRyZXNzIGlzIG5vdCBjb3B5LXBhc3RlZCB0bwogICAgLy8gYWRkT3duZXIvY2hhbmdlT3duZXIgYW5kIHRvIGlzT3duZXIuCiAgICBmdW5jdGlvbiBhbUlPd25lcigpIGV4dGVybmFsIGNvbnN0YW50IG9ubHlvd25lciByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8vIEBub3RpY2UgUmV2b2tlcyBhIHByaW9yIGNvbmZpcm1hdGlvbiBvZiB0aGUgZ2l2ZW4gb3BlcmF0aW9uCiAgICAvLy8gQHBhcmFtIF9vcGVyYXRpb24gb3BlcmF0aW9uIHZhbHVlLCB0eXBpY2FsbHkgc2hhMyhtc2cuZGF0YSkKICAgIGZ1bmN0aW9uIHJldm9rZShieXRlczMyIF9vcGVyYXRpb24pCiAgICBleHRlcm5hbAogICAgbXVsdGlPd25lZE9wZXJhdGlvbklzQWN0aXZlKF9vcGVyYXRpb24pCiAgICBvbmx5b3duZXIKICAgIHsKICAgICAgICB1aW50IG93bmVySW5kZXhCaXQgPSBtYWtlT3duZXJCaXRtYXBCaXQobXNnLnNlbmRlcik7CiAgICAgICAgdmFyIHBlbmRpbmcgPSBtX211bHRpT3duZWRQZW5kaW5nW19vcGVyYXRpb25dOwogICAgICAgIHJlcXVpcmUocGVuZGluZy5vd25lcnNEb25lICYgb3duZXJJbmRleEJpdCA+IDApOwoKICAgICAgICBhc3NlcnRPcGVyYXRpb25Jc0NvbnNpc3RlbnQoX29wZXJhdGlvbik7CgogICAgICAgIHBlbmRpbmcueWV0TmVlZGVkKys7CiAgICAgICAgcGVuZGluZy5vd25lcnNEb25lIC09IG93bmVySW5kZXhCaXQ7CgogICAgICAgIGFzc2VydE9wZXJhdGlvbklzQ29uc2lzdGVudChfb3BlcmF0aW9uKTsKICAgICAgICBSZXZva2UobXNnLnNlbmRlciwgX29wZXJhdGlvbik7CiAgICB9CgogICAgLy8vIEBub3RpY2UgQ2hlY2tzIGlmIG93bmVyIGNvbmZpcm1lZCBnaXZlbiBvcGVyYXRpb24KICAgIC8vLyBAcGFyYW0gX29wZXJhdGlvbiBvcGVyYXRpb24gdmFsdWUsIHR5cGljYWxseSBzaGEzKG1zZy5kYXRhKQogICAgLy8vIEBwYXJhbSBfb3duZXIgYW4gb3duZXIgYWRkcmVzcwogICAgZnVuY3Rpb24gaGFzQ29uZmlybWVkKGJ5dGVzMzIgX29wZXJhdGlvbiwgYWRkcmVzcyBfb3duZXIpCiAgICBleHRlcm5hbAogICAgY29uc3RhbnQKICAgIG11bHRpT3duZWRPcGVyYXRpb25Jc0FjdGl2ZShfb3BlcmF0aW9uKQogICAgb3duZXJFeGlzdHMoX293bmVyKQogICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICByZXR1cm4gIShtX211bHRpT3duZWRQZW5kaW5nW19vcGVyYXRpb25dLm93bmVyc0RvbmUgJiBtYWtlT3duZXJCaXRtYXBCaXQoX293bmVyKSA9PSAwKTsKICAgIH0KCiAgICAvLyBJTlRFUk5BTCBNRVRIT0RTCgogICAgZnVuY3Rpb24gY29uZmlybUFuZENoZWNrKGJ5dGVzMzIgX29wZXJhdGlvbikKICAgIHByaXZhdGUKICAgIG9ubHlvd25lcgogICAgcmV0dXJucyAoYm9vbCkKICAgIHsKICAgICAgICBpZiAoNTEyID09IG1fbXVsdGlPd25lZFBlbmRpbmdJbmRleC5sZW5ndGgpCiAgICAgICAgLy8gSW4gY2FzZSBtX211bHRpT3duZWRQZW5kaW5nSW5kZXggZ3Jvd3MgdG9vIG11Y2ggd2UgaGF2ZSB0byBzaHJpbmsgaXQ6IG90aGVyd2lzZSBhdCBzb21lIHBvaW50CiAgICAgICAgLy8gd2Ugd29uJ3QgYmUgYWJsZSB0byBkbyBpdCBiZWNhdXNlIG9mIGJsb2NrIGdhcyBsaW1pdC4KICAgICAgICAvLyBZZXMsIHBlbmRpbmcgY29uZmlybWF0aW9ucyB3aWxsIGJlIGxvc3QuIERvbnQgc2VlIGFueSBzZWN1cml0eSBvciBzdGFiaWxpdHkgaW1wbGljYXRpb25zLgogICAgICAgIC8vIFRPRE8gdXNlIG1vcmUgZ3JhY2VmdWwgYXBwcm9hY2ggbGlrZSBjb21wYWN0IG9yIHJlbW92YWwgb2YgY2xlYXJQZW5kaW5nIGNvbXBsZXRlbHkKICAgICAgICBjbGVhclBlbmRpbmcoKTsKCiAgICAgICAgdmFyIHBlbmRpbmcgPSBtX211bHRpT3duZWRQZW5kaW5nW19vcGVyYXRpb25dOwoKICAgICAgICAvLyBpZiB3ZSdyZSBub3QgeWV0IHdvcmtpbmcgb24gdGhpcyBvcGVyYXRpb24sIHN3aXRjaCBvdmVyIGFuZCByZXNldCB0aGUgY29uZmlybWF0aW9uIHN0YXR1cy4KICAgICAgICBpZiAoISBpc09wZXJhdGlvbkFjdGl2ZShfb3BlcmF0aW9uKSkgewogICAgICAgICAgICAvLyByZXNldCBjb3VudCBvZiBjb25maXJtYXRpb25zIG5lZWRlZC4KICAgICAgICAgICAgcGVuZGluZy55ZXROZWVkZWQgPSBtX211bHRpT3duZWRSZXF1aXJlZDsKICAgICAgICAgICAgLy8gcmVzZXQgd2hpY2ggb3duZXJzIGhhdmUgY29uZmlybWVkIChub25lKSAtIHNldCBvdXIgYml0bWFwIHRvIDAuCiAgICAgICAgICAgIHBlbmRpbmcub3duZXJzRG9uZSA9IDA7CiAgICAgICAgICAgIHBlbmRpbmcuaW5kZXggPSBtX211bHRpT3duZWRQZW5kaW5nSW5kZXgubGVuZ3RoKys7CiAgICAgICAgICAgIG1fbXVsdGlPd25lZFBlbmRpbmdJbmRleFtwZW5kaW5nLmluZGV4XSA9IF9vcGVyYXRpb247CiAgICAgICAgICAgIGFzc2VydE9wZXJhdGlvbklzQ29uc2lzdGVudChfb3BlcmF0aW9uKTsKICAgICAgICB9CgogICAgICAgIC8vIGRldGVybWluZSB0aGUgYml0IHRvIHNldCBmb3IgdGhpcyBvd25lci4KICAgICAgICB1aW50IG93bmVySW5kZXhCaXQgPSBtYWtlT3duZXJCaXRtYXBCaXQobXNnLnNlbmRlcik7CiAgICAgICAgLy8gbWFrZSBzdXJlIHdlICh0aGUgbWVzc2FnZSBzZW5kZXIpIGhhdmVuJ3QgY29uZmlybWVkIHRoaXMgb3BlcmF0aW9uIHByZXZpb3VzbHkuCiAgICAgICAgaWYgKHBlbmRpbmcub3duZXJzRG9uZSAmIG93bmVySW5kZXhCaXQgPT0gMCkgewogICAgICAgICAgICAvLyBvayAtIGNoZWNrIGlmIGNvdW50IGlzIGVub3VnaCB0byBnbyBhaGVhZC4KICAgICAgICAgICAgYXNzZXJ0KHBlbmRpbmcueWV0TmVlZGVkID4gMCk7CiAgICAgICAgICAgIGlmIChwZW5kaW5nLnlldE5lZWRlZCA9PSAxKSB7CiAgICAgICAgICAgICAgICAvLyBlbm91Z2ggY29uZmlybWF0aW9uczogcmVzZXQgYW5kIHJ1biBpbnRlcmlvci4KICAgICAgICAgICAgICAgIGRlbGV0ZSBtX211bHRpT3duZWRQZW5kaW5nSW5kZXhbbV9tdWx0aU93bmVkUGVuZGluZ1tfb3BlcmF0aW9uXS5pbmRleF07CiAgICAgICAgICAgICAgICBkZWxldGUgbV9tdWx0aU93bmVkUGVuZGluZ1tfb3BlcmF0aW9uXTsKICAgICAgICAgICAgICAgIEZpbmFsQ29uZmlybWF0aW9uKG1zZy5zZW5kZXIsIF9vcGVyYXRpb24pOwogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAvLyBub3QgZW5vdWdoOiByZWNvcmQgdGhhdCB0aGlzIG93bmVyIGluIHBhcnRpY3VsYXIgY29uZmlybWVkLgogICAgICAgICAgICAgICAgcGVuZGluZy55ZXROZWVkZWQtLTsKICAgICAgICAgICAgICAgIHBlbmRpbmcub3duZXJzRG9uZSB8PSBvd25lckluZGV4Qml0OwogICAgICAgICAgICAgICAgYXNzZXJ0T3BlcmF0aW9uSXNDb25zaXN0ZW50KF9vcGVyYXRpb24pOwogICAgICAgICAgICAgICAgQ29uZmlybWF0aW9uKG1zZy5zZW5kZXIsIF9vcGVyYXRpb24pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8vIFJlY2xhaW1zIGZyZWUgc2xvdHMgYmV0d2VlbiB2YWxpZCBvd25lcnMgaW4gbV9vd25lcnMuCiAgICAvLyBUT0RPIGdpdmVuIHRoYXQgaXRzIGNhbGxlZCBhZnRlciBlYWNoIHJlbW92YWwsIGl0IGNvdWxkIGJlIHNpbXBsaWZpZWQuCiAgICBmdW5jdGlvbiByZW9yZ2FuaXplT3duZXJzKCkgcHJpdmF0ZSB7CiAgICAgICAgdWludCBmcmVlID0gMTsKICAgICAgICB3aGlsZSAoZnJlZSA8IG1fbnVtT3duZXJzKQogICAgICAgIHsKICAgICAgICAgICAgLy8gaXRlcmF0aW5nIHRvIHRoZSBmaXJzdCBmcmVlIHNsb3QgZnJvbSB0aGUgYmVnaW5uaW5nCiAgICAgICAgICAgIHdoaWxlIChmcmVlIDwgbV9udW1Pd25lcnMgJiYgbV9vd25lcnNbZnJlZV0gIT0gMCkgZnJlZSsrOwoKICAgICAgICAgICAgLy8gaXRlcmF0aW5nIHRvIHRoZSBmaXJzdCBvY2N1cGllZCBzbG90IGZyb20gdGhlIGVuZAogICAgICAgICAgICB3aGlsZSAobV9udW1Pd25lcnMgPiAxICYmIG1fb3duZXJzW21fbnVtT3duZXJzXSA9PSAwKSBtX251bU93bmVycy0tOwoKICAgICAgICAgICAgLy8gc3dhcCwgaWYgcG9zc2libGUsIHNvIGZyZWUgc2xvdCBpcyBsb2NhdGVkIGF0IHRoZSBlbmQgYWZ0ZXIgdGhlIHN3YXAKICAgICAgICAgICAgaWYgKGZyZWUgPCBtX251bU93bmVycyAmJiBtX293bmVyc1ttX251bU93bmVyc10gIT0gMCAmJiBtX293bmVyc1tmcmVlXSA9PSAwKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAvLyBvd25lcnMgYmV0d2VlbiBzd2FwcGVkIHNsb3RzIHNob3VsZCd0IGJlIHJlbnVtYmVyZWQgLSB0aGF0IHNhdmVzIGEgbG90IG9mIGdhcwogICAgICAgICAgICAgICAgbV9vd25lcnNbZnJlZV0gPSBtX293bmVyc1ttX251bU93bmVyc107CiAgICAgICAgICAgICAgICBtX293bmVySW5kZXhbbV9vd25lcnNbZnJlZV1dID0gZnJlZTsKICAgICAgICAgICAgICAgIG1fb3duZXJzW21fbnVtT3duZXJzXSA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gY2xlYXJQZW5kaW5nKCkgcHJpdmF0ZSBvbmx5b3duZXIgewogICAgICAgIHVpbnQgbGVuZ3RoID0gbV9tdWx0aU93bmVkUGVuZGluZ0luZGV4Lmxlbmd0aDsKICAgICAgICAvLyBUT0RPIGJsb2NrIGdhcyBsaW1pdAogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CiAgICAgICAgICAgIGlmIChtX211bHRpT3duZWRQZW5kaW5nSW5kZXhbaV0gIT0gMCkKICAgICAgICAgICAgZGVsZXRlIG1fbXVsdGlPd25lZFBlbmRpbmdbbV9tdWx0aU93bmVkUGVuZGluZ0luZGV4W2ldXTsKICAgICAgICB9CiAgICAgICAgZGVsZXRlIG1fbXVsdGlPd25lZFBlbmRpbmdJbmRleDsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGVja093bmVySW5kZXgodWludCBvd25lckluZGV4KSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICBhc3NlcnQoMCAhPSBvd25lckluZGV4ICYmIG93bmVySW5kZXggPD0gY19tYXhPd25lcnMpOwogICAgICAgIHJldHVybiBvd25lckluZGV4OwogICAgfQoKICAgIGZ1bmN0aW9uIG1ha2VPd25lckJpdG1hcEJpdChhZGRyZXNzIG93bmVyKSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICB1aW50IG93bmVySW5kZXggPSBjaGVja093bmVySW5kZXgobV9vd25lckluZGV4W293bmVyXSk7CiAgICAgICAgcmV0dXJuIDIgKiogb3duZXJJbmRleDsKICAgIH0KCiAgICBmdW5jdGlvbiBpc09wZXJhdGlvbkFjdGl2ZShieXRlczMyIF9vcGVyYXRpb24pIHByaXZhdGUgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiAwICE9IG1fbXVsdGlPd25lZFBlbmRpbmdbX29wZXJhdGlvbl0ueWV0TmVlZGVkOwogICAgfQoKCiAgICBmdW5jdGlvbiBhc3NlcnRPd25lcnNBcmVDb25zaXN0ZW50KCkgcHJpdmF0ZSBjb25zdGFudCB7CiAgICAgICAgYXNzZXJ0KG1fbnVtT3duZXJzID4gMCk7CiAgICAgICAgYXNzZXJ0KG1fbnVtT3duZXJzIDw9IGNfbWF4T3duZXJzKTsKICAgICAgICBhc3NlcnQobV9vd25lcnNbMF0gPT0gMCk7CiAgICAgICAgYXNzZXJ0KDAgIT0gbV9tdWx0aU93bmVkUmVxdWlyZWQgJiYgbV9tdWx0aU93bmVkUmVxdWlyZWQgPD0gbV9udW1Pd25lcnMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGFzc2VydE9wZXJhdGlvbklzQ29uc2lzdGVudChieXRlczMyIF9vcGVyYXRpb24pIHByaXZhdGUgY29uc3RhbnQgewogICAgICAgIHZhciBwZW5kaW5nID0gbV9tdWx0aU93bmVkUGVuZGluZ1tfb3BlcmF0aW9uXTsKICAgICAgICBhc3NlcnQoMCAhPSBwZW5kaW5nLnlldE5lZWRlZCk7CiAgICAgICAgYXNzZXJ0KG1fbXVsdGlPd25lZFBlbmRpbmdJbmRleFtwZW5kaW5nLmluZGV4XSA9PSBfb3BlcmF0aW9uKTsKICAgICAgICBhc3NlcnQocGVuZGluZy55ZXROZWVkZWQgPD0gbV9tdWx0aU93bmVkUmVxdWlyZWQpOwogICAgfQoKCiAgICAvLyBGSUVMRFMKCiAgICB1aW50IGNvbnN0YW50IGNfbWF4T3duZXJzID0gMjUwOwoKICAgIC8vIHRoZSBudW1iZXIgb2Ygb3duZXJzIHRoYXQgbXVzdCBjb25maXJtIHRoZSBzYW1lIG9wZXJhdGlvbiBiZWZvcmUgaXQgaXMgcnVuLgogICAgdWludCBwdWJsaWMgbV9tdWx0aU93bmVkUmVxdWlyZWQ7CgoKICAgIC8vIHBvaW50ZXIgdXNlZCB0byBmaW5kIGEgZnJlZSBzbG90IGluIG1fb3duZXJzCiAgICB1aW50IHB1YmxpYyBtX251bU93bmVyczsKCiAgICAvLyBsaXN0IG9mIG93bmVycyAoYWRkcmVzc2VzKSwKICAgIC8vIHNsb3QgMCBpcyB1bnVzZWQgc28gdGhlcmUgYXJlIG5vIG93bmVyIHdoaWNoIGluZGV4IGlzIDAuCiAgICAvLyBUT0RPIGNvdWxkIHdlIHNhdmUgc3BhY2UgYXQgdGhlIGVuZCBvZiB0aGUgYXJyYXkgZm9yIHRoZSBjb21tb24gY2FzZSBvZiA8MTAgb3duZXJzPyBhbmQgc2hvdWxkIHdlPwogICAgYWRkcmVzc1syNTZdIGludGVybmFsIG1fb3duZXJzOwoKICAgIC8vIGluZGV4IG9uIHRoZSBsaXN0IG9mIG93bmVycyB0byBhbGxvdyByZXZlcnNlIGxvb2t1cDogb3duZXIgYWRkcmVzcyA9PiBpbmRleCBpbiBtX293bmVycwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIGludGVybmFsIG1fb3duZXJJbmRleDsKCgogICAgLy8gdGhlIG9uZ29pbmcgb3BlcmF0aW9ucy4KICAgIG1hcHBpbmcoYnl0ZXMzMiA9PiBNdWx0aU93bmVkT3BlcmF0aW9uUGVuZGluZ1N0YXRlKSBpbnRlcm5hbCBtX211bHRpT3duZWRQZW5kaW5nOwogICAgYnl0ZXMzMltdIGludGVybmFsIG1fbXVsdGlPd25lZFBlbmRpbmdJbmRleDsKfQoKCi8qKgogKiBAdGl0bGUgQ29udHJhY3Qgd2hpY2ggaXMgb3duZWQgYnkgb3duZXJzIGFuZCBvcGVyYXRlZCBieSBjb250cm9sbGVyLgogKgogKiBAbm90aWNlIFByb3ZpZGVzIGEgd2F5IHRvIHNldCB1cCBhbiBlbnRpdHkgKHR5cGljYWxseSBvdGhlciBjb250cmFjdCkgZW50aXRsZWQgdG8gY29udHJvbCBhY3Rpb25zIG9mIHRoaXMgY29udHJhY3QuCiAqIENvbnRyb2xsZXIgaXMgc2V0IHVwIGJ5IG93bmVycyBvciBkdXJpbmcgY29uc3RydWN0aW9uLgogKgogKiBAZGV2IGNvbnRyb2xsZXIgY2hlY2sgaXMgcGVyZm9ybWVkIGJ5IG9ubHlDb250cm9sbGVyIG1vZGlmaWVyLgogKi8KY29udHJhY3QgTXVsdGlvd25lZENvbnRyb2xsZWQgaXMgbXVsdGlvd25lZCB7CgogICAgZXZlbnQgQ29udHJvbGxlclNldChhZGRyZXNzIGNvbnRyb2xsZXIpOwogICAgZXZlbnQgQ29udHJvbGxlclJldGlyZWQoYWRkcmVzcyB3YXMpOwoKCiAgICBtb2RpZmllciBvbmx5Q29udHJvbGxlciB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG1fY29udHJvbGxlcik7CiAgICAgICAgXzsKICAgIH0KCgogICAgLy8gUFVCTElDIGludGVyZmFjZQoKICAgIGZ1bmN0aW9uIE11bHRpb3duZWRDb250cm9sbGVkKGFkZHJlc3NbXSBfb3duZXJzLCB1aW50IF9zaWduYXR1cmVzUmVxdWlyZWQsIGFkZHJlc3MgX2NvbnRyb2xsZXIpCiAgICBtdWx0aW93bmVkKF9vd25lcnMsIF9zaWduYXR1cmVzUmVxdWlyZWQpCiAgICB7CiAgICAgICAgbV9jb250cm9sbGVyID0gX2NvbnRyb2xsZXI7CiAgICAgICAgQ29udHJvbGxlclNldChtX2NvbnRyb2xsZXIpOwogICAgfQoKICAgIC8vLyBAZGV2IHNldHMgdGhlIGNvbnRyb2xsZXIKICAgIGZ1bmN0aW9uIHNldENvbnRyb2xsZXIoYWRkcmVzcyBfY29udHJvbGxlcikgZXh0ZXJuYWwgb25seW1hbnlvd25lcnMoc2hhMyhtc2cuZGF0YSkpIHsKICAgICAgICBtX2NvbnRyb2xsZXIgPSBfY29udHJvbGxlcjsKICAgICAgICBDb250cm9sbGVyU2V0KG1fY29udHJvbGxlcik7CiAgICB9CgogICAgLy8vIEBkZXYgYWJpbGl0eSBmb3IgY29udHJvbGxlciB0byBzdGVwIGRvd24KICAgIGZ1bmN0aW9uIGRldGFjaENvbnRyb2xsZXIoKSBleHRlcm5hbCBvbmx5Q29udHJvbGxlciB7CiAgICAgICAgYWRkcmVzcyB3YXMgPSBtX2NvbnRyb2xsZXI7CiAgICAgICAgbV9jb250cm9sbGVyID0gYWRkcmVzcygwKTsKICAgICAgICBDb250cm9sbGVyUmV0aXJlZCh3YXMpOwogICAgfQoKCiAgICAvLyBGSUVMRFMKCiAgICAvLy8gQG5vdGljZSBhZGRyZXNzIG9mIGVudGl0eSBlbnRpdGxlZCB0byBtaW50IG5ldyB0b2tlbnMKICAgIGFkZHJlc3MgcHVibGljIG1fY29udHJvbGxlcjsKfQoKCi8vLyBAdGl0bGUgdXRpbGl0eSBtZXRob2RzIGFuZCBtb2RpZmllcnMgb2YgYXJndW1lbnRzIHZhbGlkYXRpb24KY29udHJhY3QgQXJndW1lbnRzQ2hlY2tlciB7CgogICAgLy8vIEBkZXYgY2hlY2sgd2hpY2ggcHJldmVudHMgc2hvcnQgYWRkcmVzcyBhdHRhY2sKICAgIG1vZGlmaWVyIHBheWxvYWRTaXplSXModWludCBzaXplKSB7CiAgICAgICAgcmVxdWlyZShtc2cuZGF0YS5sZW5ndGggPT0gc2l6ZSArIDQgLyogZnVuY3Rpb24gc2VsZWN0b3IgKi8pOwogICAgICAgIF87CiAgICB9CgogICAgLy8vIEBkZXYgY2hlY2sgdGhhdCBhZGRyZXNzIGlzIHZhbGlkCiAgICBtb2RpZmllciB2YWxpZEFkZHJlc3MoYWRkcmVzcyBhZGRyKSB7CiAgICAgICAgcmVxdWlyZShhZGRyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIF87CiAgICB9Cn0KCgovLy8gQHRpdGxlIHJlZ2lzdHJ5IG9mIGZ1bmRzIHNlbnQgYnkgaW52ZXN0b3JzCmNvbnRyYWN0IEZ1bmRzUmVnaXN0cnkgaXMgQXJndW1lbnRzQ2hlY2tlciwgTXVsdGlvd25lZENvbnRyb2xsZWQsIFJlZW50cmFuY3lHdWFyZCB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICBlbnVtIFN0YXRlIHsKICAgICAgICAvLyBnYXRoZXJpbmcgZnVuZHMKICAgICAgICBHQVRIRVJJTkcsCiAgICAgICAgLy8gcmV0dXJuaW5nIGZ1bmRzIHRvIGludmVzdG9ycwogICAgICAgIFJFRlVORElORywKICAgICAgICAvLyBmdW5kcyBjYW4gYmUgcHVsbGVkIGJ5IG93bmVycwogICAgICAgIFNVQ0NFRURFRAogICAgfQoKICAgIGV2ZW50IFN0YXRlQ2hhbmdlZChTdGF0ZSBfc3RhdGUpOwogICAgZXZlbnQgSW52ZXN0ZWQoYWRkcmVzcyBpbmRleGVkIGludmVzdG9yLCB1aW50MjU2IGFtb3VudCk7CiAgICBldmVudCBFdGhlclNlbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50IHZhbHVlKTsKICAgIGV2ZW50IFJlZnVuZFNlbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50IHZhbHVlKTsKCgogICAgbW9kaWZpZXIgcmVxdWlyZXNTdGF0ZShTdGF0ZSBfc3RhdGUpIHsKICAgICAgICByZXF1aXJlKG1fc3RhdGUgPT0gX3N0YXRlKTsKICAgICAgICBfOwogICAgfQoKCiAgICAvLyBQVUJMSUMgaW50ZXJmYWNlCgogICAgZnVuY3Rpb24gRnVuZHNSZWdpc3RyeShhZGRyZXNzW10gX293bmVycywgdWludCBfc2lnbmF0dXJlc1JlcXVpcmVkLCBhZGRyZXNzIF9jb250cm9sbGVyKQogICAgICAgIE11bHRpb3duZWRDb250cm9sbGVkKF9vd25lcnMsIF9zaWduYXR1cmVzUmVxdWlyZWQsIF9jb250cm9sbGVyKQogICAgewogICAgfQoKICAgIC8vLyBAZGV2IHBlcmZvcm1zIG9ubHkgYWxsb3dlZCBzdGF0ZSB0cmFuc2l0aW9ucwogICAgZnVuY3Rpb24gY2hhbmdlU3RhdGUoU3RhdGUgX25ld1N0YXRlKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgb25seUNvbnRyb2xsZXIKICAgIHsKICAgICAgICBhc3NlcnQobV9zdGF0ZSAhPSBfbmV3U3RhdGUpOwoKICAgICAgICBpZiAoU3RhdGUuR0FUSEVSSU5HID09IG1fc3RhdGUpIHsgICBhc3NlcnQoU3RhdGUuUkVGVU5ESU5HID09IF9uZXdTdGF0ZSB8fCBTdGF0ZS5TVUNDRUVERUQgPT0gX25ld1N0YXRlKTsgfQogICAgICAgIGVsc2UgYXNzZXJ0KGZhbHNlKTsKCiAgICAgICAgbV9zdGF0ZSA9IF9uZXdTdGF0ZTsKICAgICAgICBTdGF0ZUNoYW5nZWQobV9zdGF0ZSk7CiAgICB9CgogICAgLy8vIEBkZXYgcmVjb3JkcyBhbiBpbnZlc3RtZW50CiAgICBmdW5jdGlvbiBpbnZlc3RlZChhZGRyZXNzIF9pbnZlc3RvcikKICAgICAgICBleHRlcm5hbAogICAgICAgIHBheWFibGUKICAgICAgICBvbmx5Q29udHJvbGxlcgogICAgICAgIHJlcXVpcmVzU3RhdGUoU3RhdGUuR0FUSEVSSU5HKQogICAgewogICAgICAgIHVpbnQyNTYgYW1vdW50ID0gbXNnLnZhbHVlOwogICAgICAgIHJlcXVpcmUoMCAhPSBhbW91bnQpOwogICAgICAgIGFzc2VydChfaW52ZXN0b3IgIT0gbV9jb250cm9sbGVyKTsKCiAgICAgICAgLy8gcmVnaXN0ZXIgaW52ZXN0b3IKICAgICAgICBpZiAoMCA9PSBtX3dlaUJhbGFuY2VzW19pbnZlc3Rvcl0pCiAgICAgICAgICAgIG1faW52ZXN0b3JzLnB1c2goX2ludmVzdG9yKTsKCiAgICAgICAgLy8gcmVnaXN0ZXIgcGF5bWVudAogICAgICAgIHRvdGFsSW52ZXN0ZWQgPSB0b3RhbEludmVzdGVkLmFkZChhbW91bnQpOwogICAgICAgIG1fd2VpQmFsYW5jZXNbX2ludmVzdG9yXSA9IG1fd2VpQmFsYW5jZXNbX2ludmVzdG9yXS5hZGQoYW1vdW50KTsKCiAgICAgICAgSW52ZXN0ZWQoX2ludmVzdG9yLCBhbW91bnQpOwogICAgfQoKICAgIC8vLyBAbm90aWNlIG93bmVyczogc2VuZCBgdmFsdWVgIG9mIGV0aGVyIHRvIGFkZHJlc3MgYHRvYCwgY2FuIGJlIGNhbGxlZCBpZiBjcm93ZHNhbGUgc3VjY2VlZGVkCiAgICAvLy8gQHBhcmFtIHRvIHdoZXJlIHRvIHNlbmQgZXRoZXIKICAgIC8vLyBAcGFyYW0gdmFsdWUgYW1vdW50IG9mIHdlaSB0byBzZW5kCiAgICBmdW5jdGlvbiBzZW5kRXRoZXIoYWRkcmVzcyB0bywgdWludCB2YWx1ZSkKICAgICAgICBleHRlcm5hbAogICAgICAgIHZhbGlkQWRkcmVzcyh0bykKICAgICAgICBvbmx5bWFueW93bmVycyhzaGEzKG1zZy5kYXRhKSkKICAgICAgICByZXF1aXJlc1N0YXRlKFN0YXRlLlNVQ0NFRURFRCkKICAgIHsKICAgICAgICByZXF1aXJlKHZhbHVlID4gMCAmJiB0aGlzLmJhbGFuY2UgPj0gdmFsdWUpOwogICAgICAgIHRvLnRyYW5zZmVyKHZhbHVlKTsKICAgICAgICBFdGhlclNlbnQodG8sIHZhbHVlKTsKICAgIH0KCiAgICAvLy8gQG5vdGljZSB3aXRoZHJhdyBhY2N1bXVsYXRlZCBiYWxhbmNlLCBjYWxsZWQgYnkgcGF5ZWUgaW4gY2FzZSBjcm93ZHNhbGUgZmFpbGVkCiAgICBmdW5jdGlvbiB3aXRoZHJhd1BheW1lbnRzKGFkZHJlc3MgcGF5ZWUpCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICBub25SZWVudHJhbnQKICAgICAgICBvbmx5Q29udHJvbGxlcgogICAgICAgIHJlcXVpcmVzU3RhdGUoU3RhdGUuUkVGVU5ESU5HKQogICAgewogICAgICAgIHVpbnQyNTYgcGF5bWVudCA9IG1fd2VpQmFsYW5jZXNbcGF5ZWVdOwoKICAgICAgICByZXF1aXJlKHBheW1lbnQgIT0gMCk7CiAgICAgICAgcmVxdWlyZSh0aGlzLmJhbGFuY2UgPj0gcGF5bWVudCk7CgogICAgICAgIHRvdGFsSW52ZXN0ZWQgPSB0b3RhbEludmVzdGVkLnN1YihwYXltZW50KTsKICAgICAgICBtX3dlaUJhbGFuY2VzW3BheWVlXSA9IDA7CgogICAgICAgIHBheWVlLnRyYW5zZmVyKHBheW1lbnQpOwogICAgICAgIFJlZnVuZFNlbnQocGF5ZWUsIHBheW1lbnQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEludmVzdG9yc0NvdW50KCkgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludCkgeyByZXR1cm4gbV9pbnZlc3RvcnMubGVuZ3RoOyB9CgoKICAgIC8vIEZJRUxEUwoKICAgIC8vLyBAbm90aWNlIHRvdGFsIGFtb3VudCBvZiBpbnZlc3RtZW50cyBpbiB3ZWkKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsSW52ZXN0ZWQ7CgogICAgLy8vIEBub3RpY2Ugc3RhdGUgb2YgdGhlIHJlZ2lzdHJ5CiAgICBTdGF0ZSBwdWJsaWMgbV9zdGF0ZSA9IFN0YXRlLkdBVEhFUklORzsKCiAgICAvLy8gQGRldiBiYWxhbmNlcyBvZiBpbnZlc3RvcnMgaW4gd2VpCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIG1fd2VpQmFsYW5jZXM7CgogICAgLy8vIEBkZXYgbGlzdCBvZiB1bmlxdWUgaW52ZXN0b3JzCiAgICBhZGRyZXNzW10gcHVibGljIG1faW52ZXN0b3JzOwp9'.
	

]
