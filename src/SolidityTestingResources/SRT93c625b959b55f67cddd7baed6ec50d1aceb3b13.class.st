Class {
	#name : #SRT93c625b959b55f67cddd7baed6ec50d1aceb3b13,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT93c625b959b55f67cddd7baed6ec50d1aceb3b13 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vICdFVkUnICdEZXZlcnkgRVZFJyBjcm93ZHNhbGUgYW5kIHRva2VuIGNvbnRyYWN0cwovLwovLyBTeW1ib2wgICAgICA6IEVWRQovLyBOYW1lICAgICAgICA6IERldmVyeSBFVkUKLy8gVG90YWwgc3VwcGx5OiBNaW50ZWQKLy8gRGVjaW1hbHMgICAgOiAxOAovLwovLyBFbmpveS4KLy8KLy8gKGMpIEJva2t5UG9vQmFoIC8gQm9rIENvbnN1bHRpbmcgUHR5IEx0ZCBmb3IgRGV2ZXJ5IDIwMTguIFRoZSBNSVQgTGljZW5jZS4KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyBFUkMgVG9rZW4gU3RhbmRhcmQgIzIwIEludGVyZmFjZQovLyBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9ibG9iL21hc3Rlci9FSVBTL2VpcC0yMC10b2tlbi1zdGFuZGFyZC5tZAovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmNvbnRyYWN0IEVSQzIwSW50ZXJmYWNlIHsKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgdG9rZW5Pd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQgYmFsYW5jZSk7CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyB0b2tlbk93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50IHJlbWFpbmluZyk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50IHRva2VucykgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludCB0b2tlbnMpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludCB0b2tlbnMpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQgdG9rZW5zKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCB0b2tlbk93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludCB0b2tlbnMpOwp9CgoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyBCb2treVBvb0JhaCdzIFRva2VuIFRlbGVwb3J0YXRpb24gU2VydmljZSBJbnRlcmZhY2UgdjEuMDAKLy8KLy8gRW5qb3kuIChjKSBCb2treVBvb0JhaCAvIEJvayBDb25zdWx0aW5nIFB0eSBMdGQgMjAxNy4gVGhlIE1JVCBMaWNlbmNlLgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmNvbnRyYWN0IEJUVFNUb2tlbkludGVyZmFjZSBpcyBFUkMyMEludGVyZmFjZSB7CiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBidHRzVmVyc2lvbiA9IDEwMDsKCiAgICBieXRlcyBwdWJsaWMgY29uc3RhbnQgc2lnbmluZ1ByZWZpeCA9ICJceDE5RXRoZXJldW0gU2lnbmVkIE1lc3NhZ2U6XG4zMiI7CiAgICBieXRlczQgcHVibGljIGNvbnN0YW50IHNpZ25lZFRyYW5zZmVyU2lnID0gIlx4NzVceDMyXHhlYVx4YWMiOwogICAgYnl0ZXM0IHB1YmxpYyBjb25zdGFudCBzaWduZWRBcHByb3ZlU2lnID0gIlx4ZTlceGFmXHhhN1x4YTEiOwogICAgYnl0ZXM0IHB1YmxpYyBjb25zdGFudCBzaWduZWRUcmFuc2ZlckZyb21TaWcgPSAiXHgzNFx4NGJceGNjXHg3ZCI7CiAgICBieXRlczQgcHVibGljIGNvbnN0YW50IHNpZ25lZEFwcHJvdmVBbmRDYWxsU2lnID0gIlx4ZjFceDZmXHg5Ylx4NTMiOwoKICAgIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8pOwogICAgZXZlbnQgTWludGVyVXBkYXRlZChhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8pOwogICAgZXZlbnQgTWludChhZGRyZXNzIGluZGV4ZWQgdG9rZW5Pd25lciwgdWludCB0b2tlbnMsIGJvb2wgbG9ja0FjY291bnQpOwogICAgZXZlbnQgTWludGluZ0Rpc2FibGVkKCk7CiAgICBldmVudCBUcmFuc2ZlcnNFbmFibGVkKCk7CiAgICBldmVudCBBY2NvdW50VW5sb2NrZWQoYWRkcmVzcyBpbmRleGVkIHRva2VuT3duZXIpOwoKICAgIGZ1bmN0aW9uIGFwcHJvdmVBbmRDYWxsKGFkZHJlc3Mgc3BlbmRlciwgdWludCB0b2tlbnMsIGJ5dGVzIGRhdGEpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gc2lnbmVke1h9IGZ1bmN0aW9ucwogICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICBmdW5jdGlvbiBzaWduZWRUcmFuc2Zlckhhc2goYWRkcmVzcyB0b2tlbk93bmVyLCBhZGRyZXNzIHRvLCB1aW50IHRva2VucywgdWludCBmZWUsIHVpbnQgbm9uY2UpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJ5dGVzMzIgaGFzaCk7CiAgICBmdW5jdGlvbiBzaWduZWRUcmFuc2ZlckNoZWNrKGFkZHJlc3MgdG9rZW5Pd25lciwgYWRkcmVzcyB0bywgdWludCB0b2tlbnMsIHVpbnQgZmVlLCB1aW50IG5vbmNlLCBieXRlcyBzaWcsIGFkZHJlc3MgZmVlQWNjb3VudCkgcHVibGljIHZpZXcgcmV0dXJucyAoQ2hlY2tSZXN1bHQgcmVzdWx0KTsKICAgIGZ1bmN0aW9uIHNpZ25lZFRyYW5zZmVyKGFkZHJlc3MgdG9rZW5Pd25lciwgYWRkcmVzcyB0bywgdWludCB0b2tlbnMsIHVpbnQgZmVlLCB1aW50IG5vbmNlLCBieXRlcyBzaWcsIGFkZHJlc3MgZmVlQWNjb3VudCkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgZnVuY3Rpb24gc2lnbmVkQXBwcm92ZUhhc2goYWRkcmVzcyB0b2tlbk93bmVyLCBhZGRyZXNzIHNwZW5kZXIsIHVpbnQgdG9rZW5zLCB1aW50IGZlZSwgdWludCBub25jZSkgcHVibGljIHZpZXcgcmV0dXJucyAoYnl0ZXMzMiBoYXNoKTsKICAgIGZ1bmN0aW9uIHNpZ25lZEFwcHJvdmVDaGVjayhhZGRyZXNzIHRva2VuT3duZXIsIGFkZHJlc3Mgc3BlbmRlciwgdWludCB0b2tlbnMsIHVpbnQgZmVlLCB1aW50IG5vbmNlLCBieXRlcyBzaWcsIGFkZHJlc3MgZmVlQWNjb3VudCkgcHVibGljIHZpZXcgcmV0dXJucyAoQ2hlY2tSZXN1bHQgcmVzdWx0KTsKICAgIGZ1bmN0aW9uIHNpZ25lZEFwcHJvdmUoYWRkcmVzcyB0b2tlbk93bmVyLCBhZGRyZXNzIHNwZW5kZXIsIHVpbnQgdG9rZW5zLCB1aW50IGZlZSwgdWludCBub25jZSwgYnl0ZXMgc2lnLCBhZGRyZXNzIGZlZUFjY291bnQpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwoKICAgIGZ1bmN0aW9uIHNpZ25lZFRyYW5zZmVyRnJvbUhhc2goYWRkcmVzcyBzcGVuZGVyLCBhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQgdG9rZW5zLCB1aW50IGZlZSwgdWludCBub25jZSkgcHVibGljIHZpZXcgcmV0dXJucyAoYnl0ZXMzMiBoYXNoKTsKICAgIGZ1bmN0aW9uIHNpZ25lZFRyYW5zZmVyRnJvbUNoZWNrKGFkZHJlc3Mgc3BlbmRlciwgYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50IHRva2VucywgdWludCBmZWUsIHVpbnQgbm9uY2UsIGJ5dGVzIHNpZywgYWRkcmVzcyBmZWVBY2NvdW50KSBwdWJsaWMgdmlldyByZXR1cm5zIChDaGVja1Jlc3VsdCByZXN1bHQpOwogICAgZnVuY3Rpb24gc2lnbmVkVHJhbnNmZXJGcm9tKGFkZHJlc3Mgc3BlbmRlciwgYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50IHRva2VucywgdWludCBmZWUsIHVpbnQgbm9uY2UsIGJ5dGVzIHNpZywgYWRkcmVzcyBmZWVBY2NvdW50KSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKCiAgICBmdW5jdGlvbiBzaWduZWRBcHByb3ZlQW5kQ2FsbEhhc2goYWRkcmVzcyB0b2tlbk93bmVyLCBhZGRyZXNzIHNwZW5kZXIsIHVpbnQgdG9rZW5zLCBieXRlcyBfZGF0YSwgdWludCBmZWUsIHVpbnQgbm9uY2UpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJ5dGVzMzIgaGFzaCk7CiAgICBmdW5jdGlvbiBzaWduZWRBcHByb3ZlQW5kQ2FsbENoZWNrKGFkZHJlc3MgdG9rZW5Pd25lciwgYWRkcmVzcyBzcGVuZGVyLCB1aW50IHRva2VucywgYnl0ZXMgX2RhdGEsIHVpbnQgZmVlLCB1aW50IG5vbmNlLCBieXRlcyBzaWcsIGFkZHJlc3MgZmVlQWNjb3VudCkgcHVibGljIHZpZXcgcmV0dXJucyAoQ2hlY2tSZXN1bHQgcmVzdWx0KTsKICAgIGZ1bmN0aW9uIHNpZ25lZEFwcHJvdmVBbmRDYWxsKGFkZHJlc3MgdG9rZW5Pd25lciwgYWRkcmVzcyBzcGVuZGVyLCB1aW50IHRva2VucywgYnl0ZXMgX2RhdGEsIHVpbnQgZmVlLCB1aW50IG5vbmNlLCBieXRlcyBzaWcsIGFkZHJlc3MgZmVlQWNjb3VudCkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CgogICAgZnVuY3Rpb24gbWludChhZGRyZXNzIHRva2VuT3duZXIsIHVpbnQgdG9rZW5zLCBib29sIGxvY2tBY2NvdW50KSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIHVubG9ja0FjY291bnQoYWRkcmVzcyB0b2tlbk93bmVyKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBkaXNhYmxlTWludGluZygpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGVuYWJsZVRyYW5zZmVycygpIHB1YmxpYzsKCiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIHNpZ25lZHtYfUNoZWNrIHJldHVybiBzdGF0dXMKICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgZW51bSBDaGVja1Jlc3VsdCB7CiAgICAgICAgU3VjY2VzcywgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAwIFN1Y2Nlc3MKICAgICAgICBOb3RUcmFuc2ZlcmFibGUsICAgICAgICAgICAgICAgICAgIC8vIDEgVG9rZW5zIG5vdCB0cmFuc2ZlcmFibGUgeWV0CiAgICAgICAgQWNjb3VudExvY2tlZCwgICAgICAgICAgICAgICAgICAgICAvLyAyIEFjY291bnQgbG9ja2VkCiAgICAgICAgU2lnbmVyTWlzbWF0Y2gsICAgICAgICAgICAgICAgICAgICAvLyAzIE1pc21hdGNoIGluIHNpZ25pbmcgYWNjb3VudAogICAgICAgIEFscmVhZHlFeGVjdXRlZCwgICAgICAgICAgICAgICAgICAgLy8gNCBUcmFuc2ZlciBhbHJlYWR5IGV4ZWN1dGVkCiAgICAgICAgSW5zdWZmaWNpZW50QXBwcm92ZWRUb2tlbnMsICAgICAgICAvLyA1IEluc3VmZmljaWVudCBhcHByb3ZlZCB0b2tlbnMKICAgICAgICBJbnN1ZmZpY2llbnRBcHByb3ZlZFRva2Vuc0ZvckZlZXMsIC8vIDYgSW5zdWZmaWNpZW50IGFwcHJvdmVkIHRva2VucyBmb3IgZmVlcwogICAgICAgIEluc3VmZmljaWVudFRva2VucywgICAgICAgICAgICAgICAgLy8gNyBJbnN1ZmZpY2llbnQgdG9rZW5zCiAgICAgICAgSW5zdWZmaWNpZW50VG9rZW5zRm9yRmVlcywgICAgICAgICAvLyA4IEluc3VmZmljaWVudCB0b2tlbnMgZm9yIGZlZXMKICAgICAgICBPdmVyZmxvd0Vycm9yICAgICAgICAgICAgICAgICAgICAgIC8vIDkgT3ZlcmZsb3cgZXJyb3IKICAgIH0KfQoKCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8gUGFyaXR5IFBJQ09QUyBXaGl0ZWxpc3QgSW50ZXJmYWNlCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KY29udHJhY3QgUElDT1BTQ2VydGlmaWVyIHsKICAgIGZ1bmN0aW9uIGNlcnRpZmllZChhZGRyZXNzKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCk7Cn0KCgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIFNhZmUgbWF0aHMKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpsaWJyYXJ5IFNhZmVNYXRoIHsKICAgIGZ1bmN0aW9uIGFkZCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50IGMpIHsKICAgICAgICBjID0gYSArIGI7CiAgICAgICAgcmVxdWlyZShjID49IGEpOwogICAgfQogICAgZnVuY3Rpb24gc3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgYykgewogICAgICAgIHJlcXVpcmUoYiA8PSBhKTsKICAgICAgICBjID0gYSAtIGI7CiAgICB9CiAgICBmdW5jdGlvbiBtdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCBjKSB7CiAgICAgICAgYyA9IGEgKiBiOwogICAgICAgIHJlcXVpcmUoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgfQogICAgZnVuY3Rpb24gZGl2KHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQgYykgewogICAgICAgIHJlcXVpcmUoYiA+IDApOwogICAgICAgIGMgPSBhIC8gYjsKICAgIH0KfQoKCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8gT3duZWQgY29udHJhY3QKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpjb250cmFjdCBPd25lZCB7CiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKICAgIGFkZHJlc3MgcHVibGljIG5ld093bmVyOwoKICAgIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90byk7CgogICAgbW9kaWZpZXIgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gT3duZWQoKSBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgX25ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBuZXdPd25lciA9IF9uZXdPd25lcjsKICAgIH0KICAgIGZ1bmN0aW9uIGFjY2VwdE93bmVyc2hpcCgpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG5ld093bmVyKTsKICAgICAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICAgICAgbmV3T3duZXIgPSBhZGRyZXNzKDApOwogICAgfQp9CgoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyBEZXZlcnkgVmVzdGluZyBDb250cmFjdAovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmNvbnRyYWN0IERldmVyeVZlc3RpbmcgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CgogICAgRGV2ZXJ5Q3Jvd2RzYWxlIHB1YmxpYyBjcm93ZHNhbGU7CiAgICB1aW50IHB1YmxpYyB0b3RhbFByb3BvcnRpb247CiAgICB1aW50IHB1YmxpYyB0b3RhbFRva2VuczsKICAgIHVpbnQgcHVibGljIHN0YXJ0RGF0ZTsKCiAgICBzdHJ1Y3QgRW50cnkgewogICAgICAgIHVpbnQgcHJvcG9ydGlvbjsKICAgICAgICB1aW50IHBlcmlvZHM7CiAgICAgICAgdWludCBwZXJpb2RMZW5ndGg7CiAgICAgICAgdWludCB3aXRoZHJhd247CiAgICB9CiAgICBtYXBwaW5nIChhZGRyZXNzID0+IEVudHJ5KSBwdWJsaWMgZW50cmllczsKCiAgICBldmVudCBOZXdFbnRyeShhZGRyZXNzIGluZGV4ZWQgaG9sZGVyLCB1aW50IHByb3BvcnRpb24sIHVpbnQgcGVyaW9kcywgdWludCBwZXJpb2RMZW5ndGgpOwogICAgZXZlbnQgV2l0aGRyYXduKGFkZHJlc3MgaW5kZXhlZCBob2xkZXIsIHVpbnQgd2l0aGRyYXduKTsKCiAgICBmdW5jdGlvbiBEZXZlcnlWZXN0aW5nKGFkZHJlc3MgX2Nyb3dkc2FsZSkgcHVibGljIHsKICAgICAgICBjcm93ZHNhbGUgPSBEZXZlcnlDcm93ZHNhbGUoX2Nyb3dkc2FsZSk7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkRW50cnlJbkRheXMoYWRkcmVzcyBob2xkZXIsIHVpbnQgcHJvcG9ydGlvbiwgdWludCBwZXJpb2RzKSBwdWJsaWMgewogICAgICAgIGFkZEVudHJ5KGhvbGRlciwgcHJvcG9ydGlvbiwgcGVyaW9kcywgMSBkYXlzKTsKICAgIH0KICAgIGZ1bmN0aW9uIGFkZEVudHJ5SW5Nb250aHMoYWRkcmVzcyBob2xkZXIsIHVpbnQgcHJvcG9ydGlvbiwgdWludCBwZXJpb2RzKSBwdWJsaWMgewogICAgICAgIGFkZEVudHJ5KGhvbGRlciwgcHJvcG9ydGlvbiwgcGVyaW9kcywgMzAgZGF5cyk7CiAgICB9CiAgICBmdW5jdGlvbiBhZGRFbnRyeUluWWVhcnMoYWRkcmVzcyBob2xkZXIsIHVpbnQgcHJvcG9ydGlvbiwgdWludCBwZXJpb2RzKSBwdWJsaWMgewogICAgICAgIGFkZEVudHJ5KGhvbGRlciwgcHJvcG9ydGlvbiwgcGVyaW9kcywgMzY1IGRheXMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZEVudHJ5KGFkZHJlc3MgaG9sZGVyLCB1aW50IHByb3BvcnRpb24sIHVpbnQgcGVyaW9kcywgdWludCBwZXJpb2RMZW5ndGgpIGludGVybmFsIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gY3Jvd2RzYWxlLm93bmVyKCkpOwogICAgICAgIHJlcXVpcmUoaG9sZGVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUocHJvcG9ydGlvbiA+IDApOwogICAgICAgIHJlcXVpcmUocGVyaW9kcyA+IDApOwogICAgICAgIHJlcXVpcmUoZW50cmllc1tob2xkZXJdLnByb3BvcnRpb24gPT0gMCk7CiAgICAgICAgZW50cmllc1tob2xkZXJdID0gRW50cnkoewogICAgICAgICAgICBwcm9wb3J0aW9uOiBwcm9wb3J0aW9uLAogICAgICAgICAgICBwZXJpb2RzOiBwZXJpb2RzLAogICAgICAgICAgICBwZXJpb2RMZW5ndGg6IHBlcmlvZExlbmd0aCwKICAgICAgICAgICAgd2l0aGRyYXduOiAwCiAgICAgICAgfSk7CiAgICAgICAgdG90YWxQcm9wb3J0aW9uID0gdG90YWxQcm9wb3J0aW9uLmFkZChwcm9wb3J0aW9uKTsKICAgICAgICBOZXdFbnRyeShob2xkZXIsIHByb3BvcnRpb24sIHBlcmlvZHMsIHBlcmlvZExlbmd0aCk7CiAgICB9CgogICAgZnVuY3Rpb24gdG9rZW5TaGFyZShhZGRyZXNzIGhvbGRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHVpbnQgcmVzdWx0ID0gMDsKICAgICAgICBFbnRyeSBtZW1vcnkgZW50cnkgPSBlbnRyaWVzW2hvbGRlcl07CiAgICAgICAgaWYgKGVudHJ5LnByb3BvcnRpb24gPiAwICYmIHRvdGFsUHJvcG9ydGlvbiA+IDApIHsKICAgICAgICAgICAgcmVzdWx0ID0gdG90YWxUb2tlbnMubXVsKGVudHJ5LnByb3BvcnRpb24pLmRpdih0b3RhbFByb3BvcnRpb24pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgZnVuY3Rpb24gdmVzdGVkKGFkZHJlc3MgaG9sZGVyLCB1aW50IHRpbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQpIHsKICAgICAgICB1aW50IHJlc3VsdCA9IDA7CiAgICAgICAgaWYgKHN0YXJ0RGF0ZSA+IDAgJiYgdGltZSA+IHN0YXJ0RGF0ZSkgewogICAgICAgICAgICBFbnRyeSBtZW1vcnkgZW50cnkgPSBlbnRyaWVzW2hvbGRlcl07CiAgICAgICAgICAgIGlmIChlbnRyeS5wcm9wb3J0aW9uID4gMCAmJiB0b3RhbFByb3BvcnRpb24gPiAwKSB7CiAgICAgICAgICAgICAgICB1aW50IF90b2tlblNoYXJlID0gdG90YWxUb2tlbnMubXVsKGVudHJ5LnByb3BvcnRpb24pLmRpdih0b3RhbFByb3BvcnRpb24pOwogICAgICAgICAgICAgICAgaWYgKHRpbWUgPj0gc3RhcnREYXRlLmFkZChlbnRyeS5wZXJpb2RzLm11bChlbnRyeS5wZXJpb2RMZW5ndGgpKSkgewogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IF90b2tlblNoYXJlOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB1aW50IHBlcmlvZHMgPSB0aW1lLnN1YihzdGFydERhdGUpLmRpdihlbnRyeS5wZXJpb2RMZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IF90b2tlblNoYXJlLm11bChwZXJpb2RzKS5kaXYoZW50cnkucGVyaW9kcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIGZ1bmN0aW9uIHdpdGhkcmF3YWJsZShhZGRyZXNzIGhvbGRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHVpbnQgcmVzdWx0ID0gMDsKICAgICAgICBFbnRyeSBtZW1vcnkgZW50cnkgPSBlbnRyaWVzW2hvbGRlcl07CiAgICAgICAgaWYgKGVudHJ5LnByb3BvcnRpb24gPiAwICYmIHRvdGFsUHJvcG9ydGlvbiA+IDApIHsKICAgICAgICAgICAgdWludCBfdmVzdGVkID0gdmVzdGVkKGhvbGRlciwgbm93KTsKICAgICAgICAgICAgcmVzdWx0ID0gX3Zlc3RlZC5zdWIoZW50cnkud2l0aGRyYXduKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIGZ1bmN0aW9uIHdpdGhkcmF3KCkgcHVibGljIHsKICAgICAgICBFbnRyeSBzdG9yYWdlIGVudHJ5ID0gZW50cmllc1ttc2cuc2VuZGVyXTsKICAgICAgICByZXF1aXJlKGVudHJ5LnByb3BvcnRpb24gPiAwICYmIHRvdGFsUHJvcG9ydGlvbiA+IDApOwogICAgICAgIHVpbnQgX3Zlc3RlZCA9IHZlc3RlZChtc2cuc2VuZGVyLCBub3cpOwogICAgICAgIHVpbnQgX3dpdGhkcmF3biA9IGVudHJ5LndpdGhkcmF3bjsKICAgICAgICByZXF1aXJlKF92ZXN0ZWQgPiBfd2l0aGRyYXduKTsKICAgICAgICB1aW50IF93aXRoZHJhd2FibGUgPSBfdmVzdGVkLnN1Yihfd2l0aGRyYXduKTsKICAgICAgICBlbnRyeS53aXRoZHJhd24gPSBfdmVzdGVkOwogICAgICAgIHJlcXVpcmUoY3Jvd2RzYWxlLmJ0dHNUb2tlbigpLnRyYW5zZmVyKG1zZy5zZW5kZXIsIF93aXRoZHJhd2FibGUpKTsKICAgICAgICBXaXRoZHJhd24obXNnLnNlbmRlciwgX3dpdGhkcmF3YWJsZSk7CiAgICB9CiAgICBmdW5jdGlvbiB3aXRoZHJhd24oYWRkcmVzcyBob2xkZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQpIHsKICAgICAgICBFbnRyeSBtZW1vcnkgZW50cnkgPSBlbnRyaWVzW2hvbGRlcl07CiAgICAgICAgcmV0dXJuIGVudHJ5LndpdGhkcmF3bjsKICAgIH0KCiAgICBmdW5jdGlvbiBmaW5hbGlzZSgpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkZHJlc3MoY3Jvd2RzYWxlKSk7CiAgICAgICAgdG90YWxUb2tlbnMgPSBjcm93ZHNhbGUuYnR0c1Rva2VuKCkuYmFsYW5jZU9mKGFkZHJlc3ModGhpcykpOwogICAgICAgIHN0YXJ0RGF0ZSA9IG5vdzsKICAgIH0KCn0KCgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIERldmVyeSBDcm93ZHNhbGUgQ29udHJhY3QKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpjb250cmFjdCBEZXZlcnlDcm93ZHNhbGUgaXMgT3duZWQgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CgogICAgQlRUU1Rva2VuSW50ZXJmYWNlIHB1YmxpYyBidHRzVG9rZW47CiAgICB1aW50OCBwdWJsaWMgY29uc3RhbnQgVE9LRU5fREVDSU1BTFMgPSAxODsKCiAgICBFUkMyMEludGVyZmFjZSBwdWJsaWMgcHJlc2FsZVRva2VuID0gRVJDMjBJbnRlcmZhY2UoMHg4Y2ExZDlDMzNjMzM4NTIwNjA0MDQ0OTc3YmU2OWE5QUMxOWQ2RTU0KTsKICAgIHVpbnQgcHVibGljIHByZXNhbGVFdGhBbW91bnRzUHJvY2Vzc2VkOwogICAgYm9vbCBwdWJsaWMgcHJlc2FsZVByb2Nlc3NlZDsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFBSRVNBTEVfQk9OVVNfUEVSQ0VOVCA9IDU7CgogICAgdWludCBwdWJsaWMgY29uc3RhbnQgUEVSX0FDQ09VTlRfQURESVRJT05BTF9UT0tFTlMgPSAyMDAgKiAxMCoqdWludChUT0tFTl9ERUNJTUFMUyk7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgYm9udXNUb2tlbnNBbGxvY2F0ZTsKCiAgICBQSUNPUFNDZXJ0aWZpZXIgcHVibGljIHBpY29wc0NlcnRpZmllciA9IFBJQ09QU0NlcnRpZmllcigweDFlMkYwNThDNDNhYzg5NjU5MzhGNmU5Q0EyODY2ODVBM0U2M0YyNEUpOwoKICAgIGFkZHJlc3MgcHVibGljIHdhbGxldCA9IDB4ODc0MTBlRTkzQkRhMjQ0NTMzOWM5MzcyYjIwQkYyNWUxMzhGODU4QzsKICAgIGFkZHJlc3MgcHVibGljIHJlc2VydmVXYWxsZXQgPSAweDg3NDEwZUU5M0JEYTI0NDUzMzljOTM3MmIyMEJGMjVlMTM4Rjg1OEM7CiAgICBEZXZlcnlWZXN0aW5nIHB1YmxpYyB2ZXN0aW5nVGVhbVdhbGxldDsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFRFQU1fUEVSQ0VOVF9FVkUgPSAxNTsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFJFU0VSVkVfUEVSQ0VOVF9FVkUgPSAyNTsKICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFRBUkdFVF9FVkUgPSAxMDAwMDAwMDAgKiAxMCoqdWludChUT0tFTl9ERUNJTUFMUyk7CiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBQUkVTQUxFUExVU0NST1dEU0FMRV9FVkUgPSBUQVJHRVRfRVZFICogKDEwMCAtIFRFQU1fUEVSQ0VOVF9FVkUgLSBSRVNFUlZFX1BFUkNFTlRfRVZFKSAvIDEwMDsKCiAgICAvLyBTdGFydCAxOCBKYW4gMjAxOCAxNjowMCBVVEMgPT4gIkZyaSwgMTkgSmFuIDIwMTggMDM6MDA6MDAgQUVEVCIKICAgIC8vIG5ldyBEYXRlKDE1MTYyOTEyMDAgKiAxMDAwKS50b1VUQ1N0cmluZygpID0+ICJUaHUsIDE4IEphbiAyMDE4IDE2OjAwOjAwIFVUQyIKICAgIHVpbnQgcHVibGljIHN0YXJ0RGF0ZSA9IDE1MTYyOTEyMDA7CiAgICB1aW50IHB1YmxpYyBmaXJzdFBlcmlvZEVuZERhdGUgPSBzdGFydERhdGUgKyAxMiBob3VyczsKICAgIHVpbnQgcHVibGljIGVuZERhdGUgPSBzdGFydERhdGUgKyAxNCBkYXlzOwoKICAgIC8vIEVUSC9VU0QgcmF0ZSB1c2VkIDEsMDAwCiAgICB1aW50IHB1YmxpYyB1c2RQZXJLRXRoZXIgPSAxMDAwMDAwOwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgQ0FQX1VTRCA9IDEwMDAwMDAwOwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgTUlOX0NPTlRSSUJVVElPTl9FVEggPSAwLjAxIGV0aGVyOwogICAgdWludCBwdWJsaWMgZmlyc3RQZXJpb2RDYXAgPSAzIGV0aGVyOwoKICAgIHVpbnQgcHVibGljIGNvbnRyaWJ1dGVkRXRoOwogICAgdWludCBwdWJsaWMgY29udHJpYnV0ZWRVc2Q7CiAgICB1aW50IHB1YmxpYyBnZW5lcmF0ZWRFdmU7CgogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBhY2NvdW50RXRoQW1vdW50OwoKICAgIGJvb2wgcHVibGljIGZpbmFsaXNlZDsKCiAgICBldmVudCBCVFRTVG9rZW5VcGRhdGVkKGFkZHJlc3MgaW5kZXhlZCBvbGRCVFRTVG9rZW4sIGFkZHJlc3MgaW5kZXhlZCBuZXdCVFRTVG9rZW4pOwogICAgZXZlbnQgUElDT1BTQ2VydGlmaWVyVXBkYXRlZChhZGRyZXNzIGluZGV4ZWQgb2xkUElDT1BTQ2VydGlmaWVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3UElDT1BTQ2VydGlmaWVyKTsKICAgIGV2ZW50IFdhbGxldFVwZGF0ZWQoYWRkcmVzcyBpbmRleGVkIG9sZFdhbGxldCwgYWRkcmVzcyBpbmRleGVkIG5ld1dhbGxldCk7CiAgICBldmVudCBSZXNlcnZlV2FsbGV0VXBkYXRlZChhZGRyZXNzIGluZGV4ZWQgb2xkUmVzZXJ2ZVdhbGxldCwgYWRkcmVzcyBpbmRleGVkIG5ld1Jlc2VydmVXYWxsZXQpOwogICAgZXZlbnQgU3RhcnREYXRlVXBkYXRlZCh1aW50IG9sZFN0YXJ0RGF0ZSwgdWludCBuZXdTdGFydERhdGUpOwogICAgZXZlbnQgRmlyc3RQZXJpb2RFbmREYXRlVXBkYXRlZCh1aW50IG9sZEZpcnN0UGVyaW9kRW5kRGF0ZSwgdWludCBuZXdGaXJzdFBlcmlvZEVuZERhdGUpOwogICAgZXZlbnQgRW5kRGF0ZVVwZGF0ZWQodWludCBvbGRFbmREYXRlLCB1aW50IG5ld0VuZERhdGUpOwogICAgZXZlbnQgVXNkUGVyS0V0aGVyVXBkYXRlZCh1aW50IG9sZFVzZFBlcktFdGhlciwgdWludCBuZXdVc2RQZXJLRXRoZXIpOwogICAgZXZlbnQgRmlyc3RQZXJpb2RDYXBVcGRhdGVkKHVpbnQgb2xkRmlyc3RQZXJpb2RDYXAsIHVpbnQgbmV3Rmlyc3RQZXJpb2RDYXApOwogICAgZXZlbnQgQ29udHJpYnV0ZWQoYWRkcmVzcyBpbmRleGVkIGFkZHIsIHVpbnQgZXRoQW1vdW50LCB1aW50IGV0aFJlZnVuZCwgdWludCBhY2NvdW50RXRoQW1vdW50LCB1aW50IHVzZEFtb3VudCwgdWludCBib251c1BlcmNlbnQsIHVpbnQgZXZlQW1vdW50LCB1aW50IGNvbnRyaWJ1dGVkRXRoLCB1aW50IGNvbnRyaWJ1dGVkVXNkLCB1aW50IGdlbmVyYXRlZEV2ZSk7CgogICAgZnVuY3Rpb24gRGV2ZXJ5Q3Jvd2RzYWxlKCkgcHVibGljIHsKICAgICAgICB2ZXN0aW5nVGVhbVdhbGxldCA9IG5ldyBEZXZlcnlWZXN0aW5nKHRoaXMpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEJUVFNUb2tlbihhZGRyZXNzIF9idHRzVG9rZW4pIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUobm93IDw9IHN0YXJ0RGF0ZSk7CiAgICAgICAgQlRUU1Rva2VuVXBkYXRlZChhZGRyZXNzKGJ0dHNUb2tlbiksIF9idHRzVG9rZW4pOwogICAgICAgIGJ0dHNUb2tlbiA9IEJUVFNUb2tlbkludGVyZmFjZShfYnR0c1Rva2VuKTsKICAgIH0KICAgIGZ1bmN0aW9uIHNldFBJQ09QU0NlcnRpZmllcihhZGRyZXNzIF9waWNvcHNDZXJ0aWZpZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUobm93IDw9IHN0YXJ0RGF0ZSk7CiAgICAgICAgUElDT1BTQ2VydGlmaWVyVXBkYXRlZChhZGRyZXNzKHBpY29wc0NlcnRpZmllciksIF9waWNvcHNDZXJ0aWZpZXIpOwogICAgICAgIHBpY29wc0NlcnRpZmllciA9IFBJQ09QU0NlcnRpZmllcihfcGljb3BzQ2VydGlmaWVyKTsKICAgIH0KICAgIGZ1bmN0aW9uIHNldFdhbGxldChhZGRyZXNzIF93YWxsZXQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIFdhbGxldFVwZGF0ZWQod2FsbGV0LCBfd2FsbGV0KTsKICAgICAgICB3YWxsZXQgPSBfd2FsbGV0OwogICAgfQogICAgZnVuY3Rpb24gc2V0UmVzZXJ2ZVdhbGxldChhZGRyZXNzIF9yZXNlcnZlV2FsbGV0KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBSZXNlcnZlV2FsbGV0VXBkYXRlZChyZXNlcnZlV2FsbGV0LCBfcmVzZXJ2ZVdhbGxldCk7CiAgICAgICAgcmVzZXJ2ZVdhbGxldCA9IF9yZXNlcnZlV2FsbGV0OwogICAgfQogICAgZnVuY3Rpb24gc2V0U3RhcnREYXRlKHVpbnQgX3N0YXJ0RGF0ZSkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShfc3RhcnREYXRlID49IG5vdyk7CiAgICAgICAgU3RhcnREYXRlVXBkYXRlZChzdGFydERhdGUsIF9zdGFydERhdGUpOwogICAgICAgIHN0YXJ0RGF0ZSA9IF9zdGFydERhdGU7CiAgICB9CiAgICBmdW5jdGlvbiBzZXRGaXJzdFBlcmlvZEVuZERhdGUodWludCBfZmlyc3RQZXJpb2RFbmREYXRlKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKF9maXJzdFBlcmlvZEVuZERhdGUgPj0gbm93KTsKICAgICAgICByZXF1aXJlKF9maXJzdFBlcmlvZEVuZERhdGUgPj0gc3RhcnREYXRlKTsKICAgICAgICBGaXJzdFBlcmlvZEVuZERhdGVVcGRhdGVkKGZpcnN0UGVyaW9kRW5kRGF0ZSwgX2ZpcnN0UGVyaW9kRW5kRGF0ZSk7CiAgICAgICAgZmlyc3RQZXJpb2RFbmREYXRlID0gX2ZpcnN0UGVyaW9kRW5kRGF0ZTsKICAgIH0KICAgIGZ1bmN0aW9uIHNldEVuZERhdGUodWludCBfZW5kRGF0ZSkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShfZW5kRGF0ZSA+PSBub3cpOwogICAgICAgIHJlcXVpcmUoX2VuZERhdGUgPj0gZmlyc3RQZXJpb2RFbmREYXRlKTsKICAgICAgICBFbmREYXRlVXBkYXRlZChlbmREYXRlLCBfZW5kRGF0ZSk7CiAgICAgICAgZW5kRGF0ZSA9IF9lbmREYXRlOwogICAgfQogICAgZnVuY3Rpb24gc2V0VXNkUGVyS0V0aGVyKHVpbnQgX3VzZFBlcktFdGhlcikgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShub3cgPD0gc3RhcnREYXRlKTsKICAgICAgICBVc2RQZXJLRXRoZXJVcGRhdGVkKHVzZFBlcktFdGhlciwgX3VzZFBlcktFdGhlcik7CiAgICAgICAgdXNkUGVyS0V0aGVyID0gX3VzZFBlcktFdGhlcjsKICAgIH0KICAgIGZ1bmN0aW9uIHNldEZpcnN0UGVyaW9kQ2FwKHVpbnQgX2ZpcnN0UGVyaW9kQ2FwKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKF9maXJzdFBlcmlvZENhcCA+PSBNSU5fQ09OVFJJQlVUSU9OX0VUSCk7CiAgICAgICAgRmlyc3RQZXJpb2RDYXBVcGRhdGVkKGZpcnN0UGVyaW9kQ2FwLCBfZmlyc3RQZXJpb2RDYXApOwogICAgICAgIGZpcnN0UGVyaW9kQ2FwID0gX2ZpcnN0UGVyaW9kQ2FwOwogICAgfQoKICAgIC8vIHVzZFBlcktFdGhlciA9IDEsMDAwLDAwMAogICAgLy8gY2FwRXRoICAgICAgID0gVVNEIDEwLDAwMCwwMDAgLyAxLDAwMCA9IDEwLDAwMAogICAgLy8gcHJlc2FsZUV0aCAgID0gNCw1NjEuNzY0NzA1ODgyMzUzCiAgICAvLyBjcm93ZHNhbGVFdGggPSBjYXBFdGggLSBwcmVzYWxlRXRoCiAgICAvLyAgICAgICAgICAgICAgPSA1LDQzOC4yMzUyOTQxMTc2NDcKICAgIC8vIHRvdGFsRXZlICAgICA9IDEwMCwwMDAsMDAwCiAgICAvLyBwcmVzYWxlUGx1c0Nyb3dkc2FsZUV2ZSA9IDYwJSB4IHRvdGFsRXZlID0gNjAsMDAwLDAwMAogICAgLy8gZXZlUGVyRXRoIHggcHJlc2FsZUV0aCB4IDEuMDUgKyBldmVQZXJFdGggeCBjcm93ZHNhbGVFdGggPSBwcmVzYWxlUGx1c0Nyb3dkc2FsZUV2ZQogICAgLy8gZXZlUGVyRXRoIHggKHByZXNhbGVFdGggeCAxLjA1ICsgY3Jvd2RzYWxlRXRoKSA9IHByZXNhbGVQbHVzQ3Jvd2RzYWxlRXZlCiAgICAvLyBldmVQZXJFdGggPSBwcmVzYWxlUGx1c0Nyb3dkc2FsZUV2ZSAvIChwcmVzYWxlRXRoIHggMS4wNSArIGNyb3dkc2FsZUV0aCkKICAgIC8vICAgICAgICAgICA9IDYwLDAwMCwwMDAvKDQsNTYxLjc2NDcwNTg4MjM1MyoxLjA1ICsgNSw0MzguMjM1Mjk0MTE3NjQ3KQogICAgLy8gICAgICAgICAgID0gNSw4NjYuMTk4OTA0NDAxMDg2OTcKICAgIC8vIHVzZFBlckV2ZSA9IDEsMDAwIC8gNSw4NjYuMTk4OTA0NDAxMDg2OTcgPSAwLjE3MDQ2ODEzNzI1NDkwMiAKCiAgICBmdW5jdGlvbiBjYXBFdGgoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIENBUF9VU0QgKiAxMCoqdWludCgzICsgMTgpIC8gdXNkUGVyS0V0aGVyOwogICAgfQogICAgZnVuY3Rpb24gcHJlc2FsZUV0aCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gcHJlc2FsZVRva2VuLnRvdGFsU3VwcGx5KCk7CiAgICB9CiAgICBmdW5jdGlvbiBjcm93ZHNhbGVFdGgoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIGNhcEV0aCgpLnN1YihwcmVzYWxlRXRoKCkpOwogICAgfQogICAgZnVuY3Rpb24gZXZlRnJvbUV0aCh1aW50IGV0aEFtb3VudCwgdWludCBib251c1BlcmNlbnQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQpIHsKICAgICAgICB1aW50IGFkanVzdGVkRXRoID0gcHJlc2FsZUV0aCgpLm11bCgxMDAgKyBQUkVTQUxFX0JPTlVTX1BFUkNFTlQpLmFkZChjcm93ZHNhbGVFdGgoKS5tdWwoMTAwKSkuZGl2KDEwMCk7CiAgICAgICAgcmV0dXJuIGV0aEFtb3VudC5tdWwoMTAwICsgYm9udXNQZXJjZW50KS5tdWwoUFJFU0FMRVBMVVNDUk9XRFNBTEVfRVZFKS5kaXYoYWRqdXN0ZWRFdGgpLmRpdigxMDApOwogICAgfQogICAgZnVuY3Rpb24gZXZlUGVyRXRoKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiBldmVGcm9tRXRoKDEwKioxOCwgMCk7CiAgICB9CiAgICBmdW5jdGlvbiB1c2RQZXJFdmUoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50KSB7CiAgICAgICAgdWludCBldmVQZXJLRXRoID0gZXZlRnJvbUV0aCgxMCoqKDE4ICsgMyksIDApOwogICAgICAgIHJldHVybiB1c2RQZXJLRXRoZXIubXVsKDEwKiooMTggKyAxOCkpLmRpdihldmVQZXJLRXRoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZW5lcmF0ZVRva2Vuc0ZvclByZXNhbGVBY2NvdW50cyhhZGRyZXNzW10gYWNjb3VudHMpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoYnR0c1Rva2VuICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoIXByZXNhbGVQcm9jZXNzZWQpOwogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IGFjY291bnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGFkZHJlc3MgYWNjb3VudCA9IGFjY291bnRzW2ldOwogICAgICAgICAgICB1aW50IGV0aEFtb3VudCA9IHByZXNhbGVUb2tlbi5iYWxhbmNlT2YoYWNjb3VudCk7CiAgICAgICAgICAgIHVpbnQgZXZlQW1vdW50ID0gYnR0c1Rva2VuLmJhbGFuY2VPZihhY2NvdW50KTsKICAgICAgICAgICAgaWYgKGV2ZUFtb3VudCA9PSAwICYmIGV0aEFtb3VudCAhPSAwKSB7CiAgICAgICAgICAgICAgICBwcmVzYWxlRXRoQW1vdW50c1Byb2Nlc3NlZCA9IHByZXNhbGVFdGhBbW91bnRzUHJvY2Vzc2VkLmFkZChldGhBbW91bnQpOwogICAgICAgICAgICAgICAgYWNjb3VudEV0aEFtb3VudFthY2NvdW50XSA9IGFjY291bnRFdGhBbW91bnRbYWNjb3VudF0uYWRkKGV0aEFtb3VudCk7CiAgICAgICAgICAgICAgICBldmVBbW91bnQgPSBldmVGcm9tRXRoKGV0aEFtb3VudCwgUFJFU0FMRV9CT05VU19QRVJDRU5UKTsKICAgICAgICAgICAgICAgIGV2ZUFtb3VudCA9IGV2ZUFtb3VudC5hZGQoUEVSX0FDQ09VTlRfQURESVRJT05BTF9UT0tFTlMpOwogICAgICAgICAgICAgICAgYm9udXNUb2tlbnNBbGxvY2F0ZVthY2NvdW50XSA9IHRydWU7CiAgICAgICAgICAgICAgICB1aW50IHVzZEFtb3VudCA9IGV0aEFtb3VudC5tdWwodXNkUGVyS0V0aGVyKS5kaXYoMTAqKnVpbnQoMyArIDE4KSk7CiAgICAgICAgICAgICAgICBjb250cmlidXRlZEV0aCA9IGNvbnRyaWJ1dGVkRXRoLmFkZChldGhBbW91bnQpOwogICAgICAgICAgICAgICAgY29udHJpYnV0ZWRVc2QgPSBjb250cmlidXRlZFVzZC5hZGQodXNkQW1vdW50KTsKICAgICAgICAgICAgICAgIGdlbmVyYXRlZEV2ZSA9IGdlbmVyYXRlZEV2ZS5hZGQoZXZlQW1vdW50KTsKICAgICAgICAgICAgICAgIENvbnRyaWJ1dGVkKGFjY291bnQsIGV0aEFtb3VudCwgMCwgZXRoQW1vdW50LCB1c2RBbW91bnQsIFBSRVNBTEVfQk9OVVNfUEVSQ0VOVCwgZXZlQW1vdW50LAogICAgICAgICAgICAgICAgICAgIGNvbnRyaWJ1dGVkRXRoLCBjb250cmlidXRlZFVzZCwgZ2VuZXJhdGVkRXZlKTsKICAgICAgICAgICAgICAgIGJ0dHNUb2tlbi5taW50KGFjY291bnQsIGV2ZUFtb3VudCwgZmFsc2UpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChwcmVzYWxlRXRoQW1vdW50c1Byb2Nlc3NlZCA9PSBwcmVzYWxlVG9rZW4udG90YWxTdXBwbHkoKSkgewogICAgICAgICAgICBwcmVzYWxlUHJvY2Vzc2VkID0gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gKCkgcHVibGljIHBheWFibGUgewogICAgICAgIHJlcXVpcmUoIWZpbmFsaXNlZCk7CiAgICAgICAgdWludCBldGhBbW91bnQgPSBtc2cudmFsdWU7CiAgICAgICAgaWYgKG1zZy5zZW5kZXIgPT0gb3duZXIpIHsKICAgICAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPT0gTUlOX0NPTlRSSUJVVElPTl9FVEgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlcXVpcmUobm93ID49IHN0YXJ0RGF0ZSAmJiBub3cgPD0gZW5kRGF0ZSk7CiAgICAgICAgICAgIGlmIChub3cgPD0gZmlyc3RQZXJpb2RFbmREYXRlKSB7CiAgICAgICAgICAgICAgICByZXF1aXJlKGFjY291bnRFdGhBbW91bnRbbXNnLnNlbmRlcl0uYWRkKGV0aEFtb3VudCkgPD0gZmlyc3RQZXJpb2RDYXApOwogICAgICAgICAgICAgICAgcmVxdWlyZShwaWNvcHNDZXJ0aWZpZXIuY2VydGlmaWVkKG1zZy5zZW5kZXIpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXF1aXJlKGNvbnRyaWJ1dGVkRXRoIDwgY2FwRXRoKCkpOwogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID49IE1JTl9DT05UUklCVVRJT05fRVRIKTsKICAgICAgICB1aW50IGV0aFJlZnVuZCA9IDA7CiAgICAgICAgaWYgKGNvbnRyaWJ1dGVkRXRoLmFkZChldGhBbW91bnQpID4gY2FwRXRoKCkpIHsKICAgICAgICAgICAgZXRoQW1vdW50ID0gY2FwRXRoKCkuc3ViKGNvbnRyaWJ1dGVkRXRoKTsKICAgICAgICAgICAgZXRoUmVmdW5kID0gbXNnLnZhbHVlLnN1YihldGhBbW91bnQpOwogICAgICAgIH0KICAgICAgICB1aW50IHVzZEFtb3VudCA9IGV0aEFtb3VudC5tdWwodXNkUGVyS0V0aGVyKS5kaXYoMTAqKnVpbnQoMyArIDE4KSk7CiAgICAgICAgdWludCBldmVBbW91bnQgPSBldmVGcm9tRXRoKGV0aEFtb3VudCwgMCk7CiAgICAgICAgaWYgKHBpY29wc0NlcnRpZmllci5jZXJ0aWZpZWQobXNnLnNlbmRlcikgJiYgIWJvbnVzVG9rZW5zQWxsb2NhdGVbbXNnLnNlbmRlcl0pIHsKICAgICAgICAgICAgZXZlQW1vdW50ID0gZXZlQW1vdW50LmFkZChQRVJfQUNDT1VOVF9BRERJVElPTkFMX1RPS0VOUyk7CiAgICAgICAgICAgIGJvbnVzVG9rZW5zQWxsb2NhdGVbbXNnLnNlbmRlcl0gPSB0cnVlOwogICAgICAgIH0KICAgICAgICBnZW5lcmF0ZWRFdmUgPSBnZW5lcmF0ZWRFdmUuYWRkKGV2ZUFtb3VudCk7CiAgICAgICAgY29udHJpYnV0ZWRFdGggPSBjb250cmlidXRlZEV0aC5hZGQoZXRoQW1vdW50KTsKICAgICAgICBjb250cmlidXRlZFVzZCA9IGNvbnRyaWJ1dGVkVXNkLmFkZCh1c2RBbW91bnQpOwogICAgICAgIGFjY291bnRFdGhBbW91bnRbbXNnLnNlbmRlcl0gPSBhY2NvdW50RXRoQW1vdW50W21zZy5zZW5kZXJdLmFkZChldGhBbW91bnQpOwogICAgICAgIGJ0dHNUb2tlbi5taW50KG1zZy5zZW5kZXIsIGV2ZUFtb3VudCwgZmFsc2UpOwogICAgICAgIGlmIChldGhBbW91bnQgPiAwKSB7CiAgICAgICAgICAgIHdhbGxldC50cmFuc2ZlcihldGhBbW91bnQpOwogICAgICAgIH0KICAgICAgICBDb250cmlidXRlZChtc2cuc2VuZGVyLCBldGhBbW91bnQsIGV0aFJlZnVuZCwgYWNjb3VudEV0aEFtb3VudFttc2cuc2VuZGVyXSwgdXNkQW1vdW50LCAwLCBldmVBbW91bnQsCiAgICAgICAgICAgIGNvbnRyaWJ1dGVkRXRoLCBjb250cmlidXRlZFVzZCwgZ2VuZXJhdGVkRXZlKTsKICAgICAgICBpZiAoZXRoUmVmdW5kID4gMCkgewogICAgICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKGV0aFJlZnVuZCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHJvdW5kVXAodWludCBhKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQpIHsKICAgICAgICB1aW50IG11bHRpcGxlID0gMTAqKnVpbnQoVE9LRU5fREVDSU1BTFMpOwogICAgICAgIHVpbnQgcmVtYWluZGVyID0gYSAlIG11bHRpcGxlOwogICAgICAgIGlmIChyZW1haW5kZXIgPiAwKSB7CiAgICAgICAgICAgIHJldHVybiBhLmFkZChtdWx0aXBsZSkuc3ViKHJlbWFpbmRlcik7CiAgICAgICAgfQogICAgfQogICAgZnVuY3Rpb24gZmluYWxpc2UoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKCFmaW5hbGlzZWQpOwogICAgICAgIHJlcXVpcmUobm93ID4gZW5kRGF0ZSB8fCBjb250cmlidXRlZEV0aCA+PSBjYXBFdGgoKSk7CiAgICAgICAgdWludCB0b3RhbCA9IGdlbmVyYXRlZEV2ZS5tdWwoMTAwKS5kaXYodWludCgxMDApLnN1YihURUFNX1BFUkNFTlRfRVZFKS5zdWIoUkVTRVJWRV9QRVJDRU5UX0VWRSkpOwogICAgICAgIHVpbnQgYW1vdW50VGVhbSA9IHRvdGFsLm11bChURUFNX1BFUkNFTlRfRVZFKS5kaXYoMTAwKTsKICAgICAgICB1aW50IGFtb3VudFJlc2VydmUgPSB0b3RhbC5tdWwoUkVTRVJWRV9QRVJDRU5UX0VWRSkuZGl2KDEwMCk7CiAgICAgICAgZ2VuZXJhdGVkRXZlID0gZ2VuZXJhdGVkRXZlLmFkZChhbW91bnRUZWFtKS5hZGQoYW1vdW50UmVzZXJ2ZSk7CiAgICAgICAgdWludCByb3VuZGVkID0gcm91bmRVcChnZW5lcmF0ZWRFdmUpOwogICAgICAgIGlmIChyb3VuZGVkID4gZ2VuZXJhdGVkRXZlKSB7CiAgICAgICAgICAgIHVpbnQgZHVzdCA9IHJvdW5kZWQuc3ViKGdlbmVyYXRlZEV2ZSk7CiAgICAgICAgICAgIGdlbmVyYXRlZEV2ZSA9IGdlbmVyYXRlZEV2ZS5hZGQoZHVzdCk7CiAgICAgICAgICAgIGFtb3VudFJlc2VydmUgPSBhbW91bnRSZXNlcnZlLmFkZChkdXN0KTsKICAgICAgICB9CiAgICAgICAgaWYgKGdlbmVyYXRlZEV2ZSA+IFRBUkdFVF9FVkUpIHsKICAgICAgICAgICAgdWludCBkaWZmID0gZ2VuZXJhdGVkRXZlLnN1YihUQVJHRVRfRVZFKTsKICAgICAgICAgICAgZ2VuZXJhdGVkRXZlID0gVEFSR0VUX0VWRTsKICAgICAgICAgICAgYW1vdW50UmVzZXJ2ZSA9IGFtb3VudFJlc2VydmUuc3ViKGRpZmYpOwogICAgICAgIH0KICAgICAgICBidHRzVG9rZW4ubWludChhZGRyZXNzKHZlc3RpbmdUZWFtV2FsbGV0KSwgYW1vdW50VGVhbSwgZmFsc2UpOwogICAgICAgIGJ0dHNUb2tlbi5taW50KHJlc2VydmVXYWxsZXQsIGFtb3VudFJlc2VydmUsIGZhbHNlKTsKICAgICAgICBidHRzVG9rZW4uZGlzYWJsZU1pbnRpbmcoKTsKICAgICAgICB2ZXN0aW5nVGVhbVdhbGxldC5maW5hbGlzZSgpOwogICAgICAgIGZpbmFsaXNlZCA9IHRydWU7CiAgICB9Cn0='.
	

]
