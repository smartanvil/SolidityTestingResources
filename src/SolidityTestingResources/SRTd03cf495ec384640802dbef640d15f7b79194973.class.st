Class {
	#name : #SRTd03cf495ec384640802dbef640d15f7b79194973,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd03cf495ec384640802dbef640d15f7b79194973 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7Ci8qKgogKiBAdGl0bGUgRVJDMjBCYXNpYwogKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE3OQogKi8KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9Ci8qKgogKiBAdGl0bGUgT3duYWJsZQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuCiAqLwpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIGludGVybmFsIG93bmVyOwogIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KICAvKioKICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLgogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQp9Ci8qKgogKiBAdGl0bGUgQmVuZWJpdElDTwogKiBAYXV0aG9yIEhhbXphIFlhc2luIHx8IEp1bmFpZCBNdXNodGFxCiAqIEBkZXYgQmVuaWJpdENyb3dkc2FsZSBpcyBhIGJhc2UgY29udHJhY3QgZm9yIG1hbmFnaW5nIGEgdG9rZW4gY3Jvd2RzYWxlLgogKiBDcm93ZHNhbGVzIGhhdmUgYSBzdGFydCBhbmQgZW5kIHRpbWVzdGFtcHMsIHdoZXJlIGludmVzdG9ycyBjYW4gbWFrZQogKiB0b2tlbiBwdXJjaGFzZXMgYW5kIHRoZSBjcm93ZHNhbGUgd2lsbCBhc3NpZ24gdGhlbSBCTkUgdG9rZW5zIGJhc2VkCiAqIG9uIGEgQk5FIHRva2VuIHBlciBFVEggcmF0ZS4gRnVuZHMgY29sbGVjdGVkIGFyZSBmb3J3YXJkZWQgdG8gYSB3YWxsZXQKICogYXMgdGhleSBhcnJpdmUuCiAqLwovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgKi8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KfQovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQovKioKICogQHRpdGxlIFN0YW5kYXJkIEVSQzIwIHRva2VuCiAqCiAqIEBkZXYgSW1wbGVtZW50YXRpb24gb2YgdGhlIGJhc2ljIHN0YW5kYXJkIHRva2VuLgogKiBAZGV2IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgRmlyc3RCbG9vZDogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sCiAqLwpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgIHVpbnQyNTYgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOwogICAgLy8gQ2hlY2sgaXMgbm90IG5lZWRlZCBiZWNhdXNlIHN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0CiAgICAvLyByZXF1aXJlIChfdmFsdWUgPD0gX2FsbG93YW5jZSk7CiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgLyoqCiAgICogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICoKICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICogYW5kIHRoZSBuZXcgYWxsb3dhbmNlIGJ5IHVuZm9ydHVuYXRlIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcwogICAqIHJhY2UgY29uZGl0aW9uIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUgYWZ0ZXJ3YXJkczoKICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAqLwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CiAgLyoqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkKICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KLyoqCiAqIEB0aXRsZSBNaW50YWJsZSB0b2tlbgogKiBAZGV2IFNpbXBsZSBFUkMyMCBUb2tlbiBleGFtcGxlLCB3aXRoIG1pbnRhYmxlIHRva2VuIGNyZWF0aW9uCiAqIEBkZXYgSXNzdWU6ICogaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXBwZWxpbi1zb2xpZGl0eS9pc3N1ZXMvMTIwCiAqIEJhc2VkIG9uIGNvZGUgYnkgVG9rZW5NYXJrZXROZXQ6IGh0dHBzOi8vZ2l0aHViLmNvbS9Ub2tlbk1hcmtldE5ldC9pY28vYmxvYi9tYXN0ZXIvY29udHJhY3RzL01pbnRhYmxlVG9rZW4uc29sCiAqLwpjb250cmFjdCBNaW50YWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIE93bmFibGUgewogIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGFtb3VudCk7CiAgZXZlbnQgTWludEZpbmlzaGVkKCk7CiAgYm9vbCBwdWJsaWMgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CiAgbW9kaWZpZXIgY2FuTWludCgpIHsKICAgIHJlcXVpcmUoIW1pbnRpbmdGaW5pc2hlZCk7CiAgICBfOwogIH0KICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIG1pbnQgdG9rZW5zCiAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgbWludGVkIHRva2Vucy4KICAgKiBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAqIEByZXR1cm4gQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICovCiAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgLy90b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfYW1vdW50KTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfYW1vdW50KTsKICAgIE1pbnQoX3RvLCBfYW1vdW50KTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX2Ftb3VudCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBzdG9wIG1pbnRpbmcgbmV3IHRva2Vucy4KICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBmaW5pc2hNaW50aW5nKCkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBtaW50aW5nRmluaXNoZWQgPSB0cnVlOwogICAgTWludEZpbmlzaGVkKCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgZnVuY3Rpb24gYnVyblRva2Vucyh1aW50MjU2IF91bnNvbGRUb2tlbnMpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdG90YWxTdXBwbHkgPSBTYWZlTWF0aC5zdWIodG90YWxTdXBwbHksIF91bnNvbGRUb2tlbnMpOwogIH0KfQovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQovKioKICogQHRpdGxlIEJlbmViaXQgQ3Jvd2RzYWxlCiAqIEBhdXRob3IgSnVuYWlkIE11c2h0YXEgfHwgSGFtemEgWWFzaW4KICogQGRldiBDcm93ZHNhbGUgaXMgYSBiYXNlIGNvbnRyYWN0IGZvciBtYW5hZ2luZyBhIHRva2VuIGNyb3dkc2FsZS4KICogQ3Jvd2RzYWxlcyBoYXZlIGEgc3RhcnQgYW5kIGVuZCB0aW1lc3RhbXBzLCB3aGVyZSBpbnZlc3RvcnMgY2FuIG1ha2UKICogdG9rZW4gcHVyY2hhc2VzIGFuZCB0aGUgY3Jvd2RzYWxlIHdpbGwgYXNzaWduIHRoZW0gdG9rZW5zIGJhc2VkCiAqIG9uIGEgdG9rZW4gcGVyIEVUSCByYXRlLiBGdW5kcyBjb2xsZWN0ZWQgYXJlIGZvcndhcmRlZCB0byBhIHdhbGxldAogKiBhcyB0aGV5IGFycml2ZS4KICovCmNvbnRyYWN0IENyb3dkc2FsZSBpcyBPd25hYmxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKICAvLyBUaGUgdG9rZW4gYmVpbmcgc29sZAogIE1pbnRhYmxlVG9rZW4gcHJpdmF0ZSB0b2tlbjsKICAvLyBzdGFydCBhbmQgZW5kIHRpbWVzdGFtcHMgd2hlcmUgaW52ZXN0bWVudHMgYXJlIGFsbG93ZWQgKGJvdGggaW5jbHVzaXZlKQogIHVpbnQyNTYgcHVibGljIHByZVN0YXJ0VGltZTsKICB1aW50MjU2IHB1YmxpYyBwcmVFbmRUaW1lOwogIHVpbnQyNTYgcHVibGljIElDT3N0YXJ0VGltZTsKICB1aW50MjU2IHB1YmxpYyBJQ09FbmRUaW1lOwogIAogIC8vIEJvbnVzZXMgd2lsbCBiZSBjYWxjdWxhdGVkIGhlcmUgb2YgSUNPIGFuZCBQcmUtSUNPIChib3RoIGluY2x1c2l2ZSkKICB1aW50MjU2IHByaXZhdGUgcHJlSUNPQm9udXM7CiAgdWludDI1NiBwcml2YXRlIGZpcnN0V2Vla0JvbnVzOwogIHVpbnQyNTYgcHJpdmF0ZSBzZWNvbmRXZWVrQm9udXM7CiAgdWludDI1NiBwcml2YXRlIHRoaXJkV2Vla0JvbnVzOwogIHVpbnQyNTYgcHJpdmF0ZSBmb3J0aFdlZWtCb251czsKICAKICAKICAvLyB3YWxsZXQgYWRkcmVzcyB3aGVyZSBmdW5kcyB3aWxsIGJlIHNhdmVkCiAgYWRkcmVzcyBpbnRlcm5hbCB3YWxsZXQ7CiAgCiAgLy8gYmFzZS1yYXRlIG9mIGEgcGFydGljdWxhciBCZW5lYml0IHRva2VuCiAgdWludDI1NiBwdWJsaWMgcmF0ZTsKICAvLyBhbW91bnQgb2YgcmFpc2VkIG1vbmV5IGluIHdlaQogIHVpbnQyNTYgaW50ZXJuYWwgd2VpUmFpc2VkOwogIC8vIFdlZWtzIGluIFVUQwogIHVpbnQyNTYgd2Vla09uZTsKICB1aW50MjU2IHdlZWtUd287CiAgdWludDI1NiB3ZWVrVGhyZWU7CiAgdWludDI1NiB3ZWVrRm9ydGg7CiAgCiAgLy8gdG90YWwgc3VwcGx5IG9mIHRva2VuIAogIHVpbnQyNTYgcHJpdmF0ZSB0b3RhbFN1cHBseSA9IDMwMDAwMDAwMCAqICgxMCoqMTgpOwogIC8vIHB1YmxpYyBzdXBwbHkgb2YgdG9rZW4gCiAgdWludDI1NiBwcml2YXRlIHB1YmxpY1N1cHBseSA9IFNhZmVNYXRoLm11bChTYWZlTWF0aC5kaXYodG90YWxTdXBwbHksMTAwKSw3NSk7CiAgLy8gcmV3YXJkcyBzdXBwbHkgb2YgdG9rZW4gCiAgdWludDI1NiBwcml2YXRlIHJld2FyZHNTdXBwbHkgPSBTYWZlTWF0aC5tdWwoU2FmZU1hdGguZGl2KHRvdGFsU3VwcGx5LDEwMCksMTUpOwogIC8vIHRlYW0gc3VwcGx5IG9mIHRva2VuIAogIHVpbnQyNTYgcHJpdmF0ZSB0ZWFtU3VwcGx5ID0gU2FmZU1hdGgubXVsKFNhZmVNYXRoLmRpdih0b3RhbFN1cHBseSwxMDApLDUpOwogIC8vIGFkdmlzb3Igc3VwcGx5IG9mIHRva2VuIAogIHVpbnQyNTYgcHJpdmF0ZSBhZHZpc29yU3VwcGx5ID0gU2FmZU1hdGgubXVsKFNhZmVNYXRoLmRpdih0b3RhbFN1cHBseSwxMDApLDMpOwogIC8vIGJvdW50eSBzdXBwbHkgb2YgdG9rZW4gCiAgdWludDI1NiBwcml2YXRlIGJvdW50eVN1cHBseSA9IFNhZmVNYXRoLm11bChTYWZlTWF0aC5kaXYodG90YWxTdXBwbHksMTAwKSwyKTsKICAvLyBwcmVJQ08gc3VwcGx5IG9mIHRva2VuIAogIHVpbnQyNTYgcHJpdmF0ZSBwcmVpY29TdXBwbHkgPSBTYWZlTWF0aC5tdWwoU2FmZU1hdGguZGl2KHB1YmxpY1N1cHBseSwxMDApLDE1KTsKICAvLyBJQ08gc3VwcGx5IG9mIHRva2VuIAogIHVpbnQyNTYgcHJpdmF0ZSBpY29TdXBwbHkgPSBTYWZlTWF0aC5tdWwoU2FmZU1hdGguZGl2KHB1YmxpY1N1cHBseSwxMDApLDg1KTsKICAvLyBSZW1haW5pbmcgUHVibGljIFN1cHBseSBvZiB0b2tlbiAKICB1aW50MjU2IHByaXZhdGUgcmVtYWluaW5nUHVibGljU3VwcGx5ID0gcHVibGljU3VwcGx5OwogIC8vIFJlbWFpbmluZyBSZXdhcmQgU3VwcGx5IG9mIHRva2VuIAogIHVpbnQyNTYgcHJpdmF0ZSByZW1haW5pbmdSZXdhcmRzU3VwcGx5ID0gcmV3YXJkc1N1cHBseTsKICAvLyBSZW1haW5pbmcgQm91bnR5IFN1cHBseSBvZiB0b2tlbiAKICB1aW50MjU2IHByaXZhdGUgcmVtYWluaW5nQm91bnR5U3VwcGx5ID0gYm91bnR5U3VwcGx5OwogIC8vIFJlbWFpbmluZyBBZHZpc29yIFN1cHBseSBvZiB0b2tlbiAKICB1aW50MjU2IHByaXZhdGUgcmVtYWluaW5nQWR2aXNvclN1cHBseSA9IGFkdmlzb3JTdXBwbHk7CiAgLy8gUmVtYWluaW5nIFRlYW0gU3VwcGx5IG9mIHRva2VuIAogIHVpbnQyNTYgcHJpdmF0ZSByZW1haW5pbmdUZWFtU3VwcGx5ID0gdGVhbVN1cHBseTsKICAvLyBUaW1lIGxvY2sgb3IgdmVzdGVkIHBlcmlvZCBvZiB0b2tlbiBmb3IgdGVhbSBhbGxvY2F0ZWQgdG9rZW4KICB1aW50MjU2IHByaXZhdGUgdGVhbVRpbWVMb2NrOwogIC8vIFRpbWUgbG9jayBvciB2ZXN0ZWQgcGVyaW9kIG9mIHRva2VuIGZvciBBZHZpc29yIGFsbG9jYXRlZCB0b2tlbgogIHVpbnQyNTYgcHJpdmF0ZSBhZHZpc29yVGltZUxvY2s7CiAgLyoqCiAgICogIEBib29sIGNoZWNrQnVyblRva2VucwogICAqICBAYm9vbCB1cGdyYWRlSUNPU3VwcGx5CiAgICogIEBib29sIGdyYW50VGVhbVN1cHBseQogICAqICBAYm9vbCBncmFudEFkdmlzb3JTdXBwbHkgICAgIAogICovCiAgYm9vbCBwcml2YXRlIGNoZWNrQnVyblRva2VuczsKICBib29sIHByaXZhdGUgdXBncmFkZUlDT1N1cHBseTsKICBib29sIHByaXZhdGUgZ3JhbnRUZWFtU3VwcGx5OwogIGJvb2wgcHJpdmF0ZSBncmFudEFkdmlzb3JTdXBwbHk7CiAgLyoqCiAgICogZXZlbnQgZm9yIHRva2VuIHB1cmNoYXNlIGxvZ2dpbmcKICAgKiBAcGFyYW0gcHVyY2hhc2VyIHdobyBwYWlkIGZvciB0aGUgdG9rZW5zCiAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IHdobyBnb3QgdGhlIHRva2VucwogICAqIEBwYXJhbSB2YWx1ZSB3ZWlzIHBhaWQgZm9yIHB1cmNoYXNlCiAgICogQHBhcmFtIGFtb3VudCBhbW91bnQgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAqLwogIGV2ZW50IFRva2VuUHVyY2hhc2UoYWRkcmVzcyBpbmRleGVkIHB1cmNoYXNlciwgYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IGFtb3VudCk7CiAgLy8gQmVuZWJpdCBDcm93ZHNhbGUgY29uc3RydWN0b3IKICBmdW5jdGlvbiBDcm93ZHNhbGUodWludDI1NiBfc3RhcnRUaW1lLCB1aW50MjU2IF9lbmRUaW1lLCB1aW50MjU2IF9yYXRlLCBhZGRyZXNzIF93YWxsZXQpIHsKICAgIHJlcXVpcmUoX3N0YXJ0VGltZSA+PSBub3cpOwogICAgcmVxdWlyZShfZW5kVGltZSA+PSBfc3RhcnRUaW1lKTsKICAgIHJlcXVpcmUoX3JhdGUgPiAwKTsKICAgIHJlcXVpcmUoX3dhbGxldCAhPSAweDApOwogICAgLy8gQmVuZWJpdCB0b2tlbiBjcmVhdGlvbiAKICAgIHRva2VuID0gY3JlYXRlVG9rZW5Db250cmFjdCgpOwogICAgLy8gUHJlLUlDTyBzdGFydCBUaW1lCiAgICBwcmVTdGFydFRpbWUgPSBfc3RhcnRUaW1lOwogICAgLy8gUHJlLUlDTyBlbmQgdGltZQogICAgcHJlRW5kVGltZSA9IDE1MjE2MzcyMDA7CiAgICAvLyBJQ08gc3RhcnQgVGltZQogICAgSUNPc3RhcnRUaW1lID0gMTUyMTk4MjgwMDsKICAgIC8vIElDTyBlbmQgVGltZQogICAgSUNPRW5kVGltZSA9IF9lbmRUaW1lOwogICAgLy8gQmFzZSBSYXRlIG9mIEJORSBUb2tlbgogICAgcmF0ZSA9IF9yYXRlOwogICAgLy8gTXVsdGktc2lnIHdhbGxldCB3aGVyZSBmdW5kcyB3aWxsIGJlIHNhdmVkCiAgICB3YWxsZXQgPSBfd2FsbGV0OwogICAgLyoqIENhbGN1bGF0aW9ucyBvZiBCb251c2VzIGluIElDTyBvciBQcmUtSUNPICovCiAgICBwcmVJQ09Cb251cyA9IFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwocmF0ZSwzMCksMTAwKTsKICAgIGZpcnN0V2Vla0JvbnVzID0gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChyYXRlLDIwKSwxMDApOwogICAgc2Vjb25kV2Vla0JvbnVzID0gU2FmZU1hdGguZGl2KFNhZmVNYXRoLm11bChyYXRlLDE1KSwxMDApOwogICAgdGhpcmRXZWVrQm9udXMgPSBTYWZlTWF0aC5kaXYoU2FmZU1hdGgubXVsKHJhdGUsMTApLDEwMCk7CiAgICBmb3J0aFdlZWtCb251cyA9IFNhZmVNYXRoLmRpdihTYWZlTWF0aC5tdWwocmF0ZSw1KSwxMDApOwogICAgLyoqIElDTyBib251c2VzIHdlZWsgY2FsY3VsYXRpb25zICovCiAgICB3ZWVrT25lID0gU2FmZU1hdGguYWRkKElDT3N0YXJ0VGltZSwgNjA0ODAwKTsKICAgIHdlZWtUd28gPSBTYWZlTWF0aC5hZGQod2Vla09uZSwgNjA0ODAwKTsKICAgIHdlZWtUaHJlZSA9IFNhZmVNYXRoLmFkZCh3ZWVrVHdvLCA2MDQ4MDApOwogICAgd2Vla0ZvcnRoID0gU2FmZU1hdGguYWRkKHdlZWtUaHJlZSwgNjA0ODAwKTsKICAgIC8qKiBWZXN0ZWQgUGVyaW9kIGNhbGN1bGF0aW9ucyBmb3IgdGVhbSBhbmQgYWR2aXNvcnMqLwogICAgdGVhbVRpbWVMb2NrID0gU2FmZU1hdGguYWRkKElDT0VuZFRpbWUsIDMxNTM2MDAwKTsKICAgIGFkdmlzb3JUaW1lTG9jayA9IFNhZmVNYXRoLmFkZChJQ09FbmRUaW1lLCA1MzU2ODAwKTsKICAgIAogICAgY2hlY2tCdXJuVG9rZW5zID0gZmFsc2U7CiAgICB1cGdyYWRlSUNPU3VwcGx5ID0gZmFsc2U7CiAgICBncmFudEFkdmlzb3JTdXBwbHkgPSBmYWxzZTsKICAgIGdyYW50VGVhbVN1cHBseSA9IGZhbHNlOwogIH0KICAvLyBjcmVhdGVzIHRoZSB0b2tlbiB0byBiZSBzb2xkLgogIC8vIG92ZXJyaWRlIHRoaXMgbWV0aG9kIHRvIGhhdmUgY3Jvd2RzYWxlIG9mIGEgc3BlY2lmaWMgbWludGFibGUgdG9rZW4uCiAgZnVuY3Rpb24gY3JlYXRlVG9rZW5Db250cmFjdCgpIGludGVybmFsIHJldHVybnMgKE1pbnRhYmxlVG9rZW4pIHsKICAgIHJldHVybiBuZXcgTWludGFibGVUb2tlbigpOwogIH0KICAKICAvLyBmYWxsYmFjayBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBidXkgdG9rZW5zCiAgZnVuY3Rpb24gKCkgcGF5YWJsZSB7CiAgICBidXlUb2tlbnMobXNnLnNlbmRlcik7CiAgICAKICB9CiAgLy8gSGlnaCBsZXZlbCB0b2tlbiBwdXJjaGFzZSBmdW5jdGlvbgogIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgcGF5YWJsZSB7CiAgICByZXF1aXJlKGJlbmVmaWNpYXJ5ICE9IDB4MCk7CiAgICByZXF1aXJlKHZhbGlkUHVyY2hhc2UoKSk7CiAgICB1aW50MjU2IHdlaUFtb3VudCA9IG1zZy52YWx1ZTsKICAgIC8vIG1pbmltdW0gaW52ZXN0bWVudCBzaG91bGQgYmUgMC4wNSBFVEgKICAgIHJlcXVpcmUod2VpQW1vdW50ID49ICgwLjA1ICogMSBldGhlcikpOwogICAgCiAgICB1aW50MjU2IGFjY2Vzc1RpbWUgPSBub3c7CiAgICB1aW50MjU2IHRva2VucyA9IDA7CiAgLy8gY2FsY3VsYXRpbmcgdGhlIElDTyBhbmQgUHJlLUlDTyBib251c2VzIG9uIHRoZSBiYXNpcyBvZiB0aW1pbmcKICAgIGlmICgoYWNjZXNzVGltZSA+PSBwcmVTdGFydFRpbWUpICYmIChhY2Nlc3NUaW1lIDwgcHJlRW5kVGltZSkpIHsKICAgICAgICByZXF1aXJlKHByZWljb1N1cHBseSA+IDApOwogICAgICAgIHRva2VucyA9IFNhZmVNYXRoLmFkZCh0b2tlbnMsIHdlaUFtb3VudC5tdWwocHJlSUNPQm9udXMpKTsKICAgICAgICB0b2tlbnMgPSBTYWZlTWF0aC5hZGQodG9rZW5zLCB3ZWlBbW91bnQubXVsKHJhdGUpKTsKICAgICAgICAKICAgICAgICByZXF1aXJlKHByZWljb1N1cHBseSA+PSB0b2tlbnMpOwogICAgICAgIAogICAgICAgIHByZWljb1N1cHBseSA9IHByZWljb1N1cHBseS5zdWIodG9rZW5zKTsgICAgICAgIAogICAgICAgIHJlbWFpbmluZ1B1YmxpY1N1cHBseSA9IHJlbWFpbmluZ1B1YmxpY1N1cHBseS5zdWIodG9rZW5zKTsKICAgIH0gZWxzZSBpZiAoKGFjY2Vzc1RpbWUgPj0gSUNPc3RhcnRUaW1lKSAmJiAoYWNjZXNzVGltZSA8PSBJQ09FbmRUaW1lKSkgewogICAgICAgIGlmICghdXBncmFkZUlDT1N1cHBseSkgewogICAgICAgICAgaWNvU3VwcGx5ID0gU2FmZU1hdGguYWRkKGljb1N1cHBseSxwcmVpY29TdXBwbHkpOwogICAgICAgICAgdXBncmFkZUlDT1N1cHBseSA9IHRydWU7CiAgICAgICAgfQogICAgICAgIGlmICggYWNjZXNzVGltZSA8PSB3ZWVrT25lICkgewogICAgICAgICAgdG9rZW5zID0gU2FmZU1hdGguYWRkKHRva2Vucywgd2VpQW1vdW50Lm11bChmaXJzdFdlZWtCb251cykpOwogICAgICAgIH0gZWxzZSBpZiAoYWNjZXNzVGltZSA8PSB3ZWVrVHdvKSB7CiAgICAgICAgICB0b2tlbnMgPSBTYWZlTWF0aC5hZGQodG9rZW5zLCB3ZWlBbW91bnQubXVsKHNlY29uZFdlZWtCb251cykpOwogICAgICAgIH0gZWxzZSBpZiAoIGFjY2Vzc1RpbWUgPCB3ZWVrVGhyZWUgKSB7CiAgICAgICAgICB0b2tlbnMgPSBTYWZlTWF0aC5hZGQodG9rZW5zLCB3ZWlBbW91bnQubXVsKHRoaXJkV2Vla0JvbnVzKSk7CiAgICAgICAgfSBlbHNlIGlmICggYWNjZXNzVGltZSA8IHdlZWtGb3J0aCApIHsKICAgICAgICAgIHRva2VucyA9IFNhZmVNYXRoLmFkZCh0b2tlbnMsIHdlaUFtb3VudC5tdWwoZm9ydGhXZWVrQm9udXMpKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgdG9rZW5zID0gU2FmZU1hdGguYWRkKHRva2Vucywgd2VpQW1vdW50Lm11bChyYXRlKSk7CiAgICAgICAgaWNvU3VwcGx5ID0gaWNvU3VwcGx5LnN1Yih0b2tlbnMpOyAgICAgICAgCiAgICAgICAgcmVtYWluaW5nUHVibGljU3VwcGx5ID0gcmVtYWluaW5nUHVibGljU3VwcGx5LnN1Yih0b2tlbnMpOwogICAgfSBlbHNlIGlmICgoYWNjZXNzVGltZSA+IHByZUVuZFRpbWUpICYmIChhY2Nlc3NUaW1lIDwgSUNPc3RhcnRUaW1lKSl7CiAgICAgIHJldmVydCgpOwogICAgfQogICAgLy8gdXBkYXRlIHN0YXRlCiAgICB3ZWlSYWlzZWQgPSB3ZWlSYWlzZWQuYWRkKHdlaUFtb3VudCk7CiAgICAvLyB0b2tlbnMgYXJlIG1pbnRpbmcgaGVyZQogICAgdG9rZW4ubWludChiZW5lZmljaWFyeSwgdG9rZW5zKTsKICAgIFRva2VuUHVyY2hhc2UobXNnLnNlbmRlciwgYmVuZWZpY2lhcnksIHdlaUFtb3VudCwgdG9rZW5zKTsKICAgIC8vIGZ1bmRzIGFyZSBmb3J3YXJkaW5nCiAgICBmb3J3YXJkRnVuZHMoKTsKICB9CiAgLy8gc2VuZCBldGhlciB0byB0aGUgZnVuZCBjb2xsZWN0aW9uIHdhbGxldAogIC8vIG92ZXJyaWRlIHRvIGNyZWF0ZSBjdXN0b20gZnVuZCBmb3J3YXJkaW5nIG1lY2hhbmlzbXMKICBmdW5jdGlvbiBmb3J3YXJkRnVuZHMoKSBpbnRlcm5hbCB7CiAgICB3YWxsZXQudHJhbnNmZXIobXNnLnZhbHVlKTsKICB9CiAgLy8gQHJldHVybiB0cnVlIGlmIHRoZSB0cmFuc2FjdGlvbiBjYW4gYnV5IHRva2VucwogIGZ1bmN0aW9uIHZhbGlkUHVyY2hhc2UoKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICBib29sIHdpdGhpblBlcmlvZCA9IG5vdyA+PSBwcmVTdGFydFRpbWUgJiYgbm93IDw9IElDT0VuZFRpbWU7CiAgICBib29sIG5vblplcm9QdXJjaGFzZSA9IG1zZy52YWx1ZSAhPSAwOwogICAgcmV0dXJuIHdpdGhpblBlcmlvZCAmJiBub25aZXJvUHVyY2hhc2U7CiAgfQogIC8vIEByZXR1cm4gdHJ1ZSBpZiBjcm93ZHNhbGUgZXZlbnQgaGFzIGVuZGVkCiAgZnVuY3Rpb24gaGFzRW5kZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICByZXR1cm4gbm93ID4gSUNPRW5kVGltZTsKICB9CiAgLy8gQHJldHVybiB0cnVlIGlmIGJ1cm5Ub2tlbiBmdW5jdGlvbiBoYXMgZW5kZWQKICBmdW5jdGlvbiBidXJuVG9rZW4oKSBvbmx5T3duZXIgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoaGFzRW5kZWQoKSk7CiAgICByZXF1aXJlKCFjaGVja0J1cm5Ub2tlbnMpOwogICAgdG9rZW4uYnVyblRva2VucyhyZW1haW5pbmdQdWJsaWNTdXBwbHkpOwogICAgdG90YWxTdXBwbHkgPSBTYWZlTWF0aC5zdWIodG90YWxTdXBwbHksIHJlbWFpbmluZ1B1YmxpY1N1cHBseSk7CiAgICByZW1haW5pbmdQdWJsaWNTdXBwbHkgPSAwOwogICAgY2hlY2tCdXJuVG9rZW5zID0gdHJ1ZTsKICAgIHJldHVybiB0cnVlOwogIH0KICAvKiogCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgYm91bnR5RnVuZHMgZnVuY3Rpb24gaGFzIGVuZGVkCiAgICAgKiBAcGFyYW0gYmVuZWZpY2lhcnkgYWRkcmVzcyB3aGVyZSBvd25lciB3YW50cyB0byB0cmFuc2ZlciB0b2tlbnMKICAgICAqIEBwYXJhbSB2YWx1ZVRva2VuIHZhbHVlIG9mIHRva2VuCiAgKi8KICBmdW5jdGlvbiBib3VudHlGdW5kcyhhZGRyZXNzIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHZhbHVlVG9rZW4pIG9ubHlPd25lciBwdWJsaWMgeyAKICAgIHZhbHVlVG9rZW4gPSBTYWZlTWF0aC5tdWwodmFsdWVUb2tlbiwgMSBldGhlcik7CiAgICByZXF1aXJlKHJlbWFpbmluZ0JvdW50eVN1cHBseSA+PSB2YWx1ZVRva2VuKTsKICAgIHJlbWFpbmluZ0JvdW50eVN1cHBseSA9IFNhZmVNYXRoLnN1YihyZW1haW5pbmdCb3VudHlTdXBwbHksdmFsdWVUb2tlbik7CiAgICB0b2tlbi5taW50KGJlbmVmaWNpYXJ5LCB2YWx1ZVRva2VuKTsKICB9CiAgLyoqIAogICAgICogQHJldHVybiB0cnVlIGlmIHJld2FyZHNGdW5kcyBmdW5jdGlvbiBoYXMgZW5kZWQKICAgICAqIEBwYXJhbSBiZW5lZmljaWFyeSBhZGRyZXNzIHdoZXJlIG93bmVyIHdhbnRzIHRvIHRyYW5zZmVyIHRva2VucwogICAgICogQHBhcmFtIHZhbHVlVG9rZW4gdmFsdWUgb2YgdG9rZW4KICAqLwogIGZ1bmN0aW9uIHJld2FyZHNGdW5kcyhhZGRyZXNzIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHZhbHVlVG9rZW4pIG9ubHlPd25lciBwdWJsaWMgeyAKICAgIHZhbHVlVG9rZW4gPSBTYWZlTWF0aC5tdWwodmFsdWVUb2tlbiwgMSBldGhlcik7CiAgICByZXF1aXJlKHJlbWFpbmluZ1Jld2FyZHNTdXBwbHkgPj0gdmFsdWVUb2tlbik7CiAgICByZW1haW5pbmdSZXdhcmRzU3VwcGx5ID0gU2FmZU1hdGguc3ViKHJlbWFpbmluZ1Jld2FyZHNTdXBwbHksdmFsdWVUb2tlbik7CiAgICB0b2tlbi5taW50KGJlbmVmaWNpYXJ5LCB2YWx1ZVRva2VuKTsKICB9IAogIC8qKgogICAgICBAcmV0dXJuIHRydWUgaWYgZ3JhbnRBZHZpc29yVG9rZW4gZnVuY3Rpb24gaGFzIGVuZGVkICAKICAqLwogIGZ1bmN0aW9uIGdyYW50QWR2aXNvclRva2VuKCkgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKCFncmFudEFkdmlzb3JTdXBwbHkpOwogICAgcmVxdWlyZShub3cgPiBhZHZpc29yVGltZUxvY2spOwogICAgdWludDI1NiB2YWx1ZVRva2VuID0gU2FmZU1hdGguZGl2KHJlbWFpbmluZ0Fkdmlzb3JTdXBwbHksMyk7CiAgICByZXF1aXJlKHJlbWFpbmluZ0Fkdmlzb3JTdXBwbHkgPj0gdmFsdWVUb2tlbik7CiAgICBncmFudEFkdmlzb3JTdXBwbHkgPSB0cnVlOwogICAgdG9rZW4ubWludCgweEFBODU1ZjZEODdkNUQ0NDNlRGE0OWFBMDM0ZkE5OUQ5RWVlQTAzMzcsIHZhbHVlVG9rZW4pOwogICAgdG9rZW4ubWludCgweDRCMmUzRTFCQkViMTE3Yjc4MWU3MUExMDM3NkE5Njk4NjBGQmNFQjMsIHZhbHVlVG9rZW4pOwogICAgdG9rZW4ubWludCgweGJiM2IzNzk5RDFiMzExODliNDkxQzI2QjFEN2MxNzMwN2ZiODdGNWQsIHZhbHVlVG9rZW4pOwogICAgcmVtYWluaW5nQWR2aXNvclN1cHBseSA9IDA7CiAgfQogIC8qKgogICAgICBAcmV0dXJuIHRydWUgaWYgZ3JhbnRUZWFtVG9rZW4gZnVuY3Rpb24gaGFzIGVuZGVkICAKICAqLwogICAgZnVuY3Rpb24gZ3JhbnRUZWFtVG9rZW4oKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUoIWdyYW50VGVhbVN1cHBseSk7CiAgICByZXF1aXJlKG5vdyA+IHRlYW1UaW1lTG9jayk7CiAgICB1aW50MjU2IHZhbHVlVG9rZW4gPSBTYWZlTWF0aC5kaXYocmVtYWluaW5nVGVhbVN1cHBseSwgNSk7CiAgICByZXF1aXJlKHJlbWFpbmluZ1RlYW1TdXBwbHkgPj0gdmFsdWVUb2tlbik7CiAgICBncmFudFRlYW1TdXBwbHkgPSB0cnVlOwogICAgdG9rZW4ubWludCgweEJFQjllNDA1N2Y5NTNBYUJkRjE0RGM0MDE4MDU2ODg4QzY3RTQwYjAsIHZhbHVlVG9rZW4pOwogICAgdG9rZW4ubWludCgweDcwZmNkMDc2MjllQjliNDA2MjIzMTY4QUVCOERlMDZFMjU2NEY1NTgsIHZhbHVlVG9rZW4pOwogICAgdG9rZW4ubWludCgweDBlNTYyZjEyMjM5QzY2MDYyN2JFMTg2ZGU2NTM1YzA1OTgzNTc5RTksIHZhbHVlVG9rZW4pOwogICAgdG9rZW4ubWludCgweDQyZTA0NWY0RDExOTIxMkFDMUNGNTgyMDQ4OEU2OUFBOTE2NERDNzAsIHZhbHVlVG9rZW4pOwogICAgdG9rZW4ubWludCgweDJmNTM2NzhhMzNDMGZFRThmMzBmYzVjZmFDNEU1RTE0MDM5N2I0MEQsIHZhbHVlVG9rZW4pOwogICAgcmVtYWluaW5nVGVhbVN1cHBseSA9IDA7CiAgICAKICB9Ci8qKiAKICAgKiBGdW5jdGlvbiB0cmFuc2ZlclRva2VuIHdvcmtzIHRvIHRyYW5zZmVyIHRva2VucyB0byB0aGUgc3BlY2lmaWVkIGFkZHJlc3Mgb24gdGhlCiAgICAgY2FsbCBvZiBvd25lciB3aXRoaW4gdGhlIGNyb3dkc2FsZSB0aW1lc3RhbXAuCiAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IGFkZHJlc3Mgd2hlcmUgb3duZXIgd2FudHMgdG8gdHJhbnNmZXIgdG9rZW5zCiAgICogQHBhcmFtIHRva2VucyB2YWx1ZSBvZiB0b2tlbgogKi8KICBmdW5jdGlvbiB0cmFuc2ZlclRva2VuKGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQyNTYgdG9rZW5zKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUoSUNPRW5kVGltZSA+IG5vdyk7CiAgICB0b2tlbnMgPSBTYWZlTWF0aC5tdWwodG9rZW5zLDEgZXRoZXIpOwogICAgcmVxdWlyZShyZW1haW5pbmdQdWJsaWNTdXBwbHkgPj0gdG9rZW5zKTsKICAgIHJlbWFpbmluZ1B1YmxpY1N1cHBseSA9IFNhZmVNYXRoLnN1YihyZW1haW5pbmdQdWJsaWNTdXBwbHksdG9rZW5zKTsKICAgIHRva2VuLm1pbnQoYmVuZWZpY2lhcnksIHRva2Vucyk7CiAgfQogIGZ1bmN0aW9uIGdldFRva2VuQWRkcmVzcygpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYWRkcmVzcykgewogICAgcmV0dXJuIHRva2VuOwogIH0KICBmdW5jdGlvbiBnZXRQdWJsaWNTdXBwbHkoKSBvbmx5T3duZXIgcHVibGljIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHJldHVybiByZW1haW5pbmdQdWJsaWNTdXBwbHk7CiAgfQp9Ci8qKgogKiBAdGl0bGUgQ2FwcGVkQ3Jvd2RzYWxlCiAqIEBkZXYgRXh0ZW5zaW9uIG9mIENyb3dkc2FsZSB3aXRoIGEgbWF4IGFtb3VudCBvZiBmdW5kcyByYWlzZWQKICovCmNvbnRyYWN0IENhcHBlZENyb3dkc2FsZSBpcyBDcm93ZHNhbGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogIHVpbnQyNTYgcHVibGljIGNhcDsKICBmdW5jdGlvbiBDYXBwZWRDcm93ZHNhbGUodWludDI1NiBfY2FwKSB7CiAgICByZXF1aXJlKF9jYXAgPiAwKTsKICAgIGNhcCA9IF9jYXA7CiAgfQogIC8vIG92ZXJyaWRpbmcgQ3Jvd2RzYWxlI3ZhbGlkUHVyY2hhc2UgdG8gYWRkIGV4dHJhIGNhcCBsb2dpYwogIC8vIEByZXR1cm4gdHJ1ZSBpZiBpbnZlc3RvcnMgY2FuIGJ1eSBhdCB0aGUgbW9tZW50CiAgZnVuY3Rpb24gdmFsaWRQdXJjaGFzZSgpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgIGJvb2wgd2l0aGluQ2FwID0gd2VpUmFpc2VkLmFkZChtc2cudmFsdWUpIDw9IGNhcDsKICAgIHJldHVybiBzdXBlci52YWxpZFB1cmNoYXNlKCkgJiYgd2l0aGluQ2FwOwogIH0KICAvLyBvdmVycmlkaW5nIENyb3dkc2FsZSNoYXNFbmRlZCB0byBhZGQgY2FwIGxvZ2ljCiAgLy8gQHJldHVybiB0cnVlIGlmIGNyb3dkc2FsZSBldmVudCBoYXMgZW5kZWQKICBmdW5jdGlvbiBoYXNFbmRlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICBib29sIGNhcFJlYWNoZWQgPSB3ZWlSYWlzZWQgPj0gY2FwOwogICAgcmV0dXJuIHN1cGVyLmhhc0VuZGVkKCkgfHwgY2FwUmVhY2hlZDsKICB9Cn0KLyoqCiAqIEB0aXRsZSBGaW5hbGl6YWJsZUNyb3dkc2FsZQogKiBAZGV2IEV4dGVuc2lvbiBvZiBDcm93ZHNhbGUgd2hlcmUgYW4gb3duZXIgY2FuIGRvIGV4dHJhIHdvcmsKICogYWZ0ZXIgZmluaXNoaW5nLgogKi8KY29udHJhY3QgRmluYWxpemFibGVDcm93ZHNhbGUgaXMgQ3Jvd2RzYWxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKICBib29sIGlzRmluYWxpemVkID0gZmFsc2U7CiAgZXZlbnQgRmluYWxpemVkKCk7CiAgLyoqCiAgICogQGRldiBNdXN0IGJlIGNhbGxlZCBhZnRlciBjcm93ZHNhbGUgZW5kcywgdG8gZG8gc29tZSBleHRyYSBmaW5hbGl6YXRpb24KICAgKiB3b3JrLiBDYWxscyB0aGUgY29udHJhY3QncyBmaW5hbGl6YXRpb24gZnVuY3Rpb24uCiAgICovCiAgZnVuY3Rpb24gZmluYWxpemUoKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUoIWlzRmluYWxpemVkKTsKICAgIHJlcXVpcmUoaGFzRW5kZWQoKSk7CiAgICBmaW5hbGl6YXRpb24oKTsKICAgIEZpbmFsaXplZCgpOwogICAgaXNGaW5hbGl6ZWQgPSB0cnVlOwogIH0KICAvKioKICAgKiBAZGV2IENhbiBiZSBvdmVycmlkZGVuIHRvIGFkZCBmaW5hbGl6YXRpb24gbG9naWMuIFRoZSBvdmVycmlkaW5nIGZ1bmN0aW9uCiAgICogc2hvdWxkIGNhbGwgc3VwZXIuZmluYWxpemF0aW9uKCkgdG8gZW5zdXJlIHRoZSBjaGFpbiBvZiBmaW5hbGl6YXRpb24gaXMKICAgKiBleGVjdXRlZCBlbnRpcmVseS4KICAgKi8KICBmdW5jdGlvbiBmaW5hbGl6YXRpb24oKSBpbnRlcm5hbCB7CiAgfQp9Ci8qKgogKiBAdGl0bGUgUmVmdW5kVmF1bHQKICogQGRldiBUaGlzIGNvbnRyYWN0IGlzIHVzZWQgZm9yIHN0b3JpbmcgZnVuZHMgd2hpbGUgYSBjcm93ZHNhbGUKICogaXMgaW4gcHJvZ3Jlc3MuIFN1cHBvcnRzIHJlZnVuZGluZyB0aGUgbW9uZXkgaWYgY3Jvd2RzYWxlIGZhaWxzLAogKiBhbmQgZm9yd2FyZGluZyBpdCBpZiBjcm93ZHNhbGUgaXMgc3VjY2Vzc2Z1bC4KICovCmNvbnRyYWN0IFJlZnVuZFZhdWx0IGlzIE93bmFibGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogIGVudW0gU3RhdGUgeyBBY3RpdmUsIFJlZnVuZGluZywgQ2xvc2VkIH0KICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBkZXBvc2l0ZWQ7CiAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0OwogIFN0YXRlIHB1YmxpYyBzdGF0ZTsKICBldmVudCBDbG9zZWQoKTsKICBldmVudCBSZWZ1bmRzRW5hYmxlZCgpOwogIGV2ZW50IFJlZnVuZGVkKGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB3ZWlBbW91bnQpOwogIGZ1bmN0aW9uIFJlZnVuZFZhdWx0KGFkZHJlc3MgX3dhbGxldCkgewogICAgcmVxdWlyZShfd2FsbGV0ICE9IDB4MCk7CiAgICB3YWxsZXQgPSBfd2FsbGV0OwogICAgc3RhdGUgPSBTdGF0ZS5BY3RpdmU7CiAgfQogIGZ1bmN0aW9uIGRlcG9zaXQoYWRkcmVzcyBpbnZlc3Rvcikgb25seU93bmVyIHB1YmxpYyBwYXlhYmxlIHsKICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuQWN0aXZlKTsKICAgIGRlcG9zaXRlZFtpbnZlc3Rvcl0gPSBkZXBvc2l0ZWRbaW52ZXN0b3JdLmFkZChtc2cudmFsdWUpOwogIH0KICBmdW5jdGlvbiBjbG9zZSgpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5BY3RpdmUpOwogICAgc3RhdGUgPSBTdGF0ZS5DbG9zZWQ7CiAgICBDbG9zZWQoKTsKICAgIHdhbGxldC50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogIH0KICBmdW5jdGlvbiBlbmFibGVSZWZ1bmRzKCkgb25seU93bmVyIHB1YmxpYyB7CiAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLkFjdGl2ZSk7CiAgICBzdGF0ZSA9IFN0YXRlLlJlZnVuZGluZzsKICAgIFJlZnVuZHNFbmFibGVkKCk7CiAgfQogIGZ1bmN0aW9uIHJlZnVuZChhZGRyZXNzIGludmVzdG9yKSBwdWJsaWMgewogICAgcmVxdWlyZShzdGF0ZSA9PSBTdGF0ZS5SZWZ1bmRpbmcpOwogICAgdWludDI1NiBkZXBvc2l0ZWRWYWx1ZSA9IGRlcG9zaXRlZFtpbnZlc3Rvcl07CiAgICBkZXBvc2l0ZWRbaW52ZXN0b3JdID0gMDsKICAgIGludmVzdG9yLnRyYW5zZmVyKGRlcG9zaXRlZFZhbHVlKTsKICAgIFJlZnVuZGVkKGludmVzdG9yLCBkZXBvc2l0ZWRWYWx1ZSk7CiAgfQp9Ci8qKgogKiBAdGl0bGUgUmVmdW5kYWJsZUNyb3dkc2FsZQogKiBAZGV2IEV4dGVuc2lvbiBvZiBDcm93ZHNhbGUgY29udHJhY3QgdGhhdCBhZGRzIGEgZnVuZGluZyBnb2FsLCBhbmQKICogdGhlIHBvc3NpYmlsaXR5IG9mIHVzZXJzIGdldHRpbmcgYSByZWZ1bmQgaWYgZ29hbCBpcyBub3QgbWV0LgogKiBVc2VzIGEgUmVmdW5kVmF1bHQgYXMgdGhlIGNyb3dkc2FsZSdzIHZhdWx0LgogKi8KY29udHJhY3QgUmVmdW5kYWJsZUNyb3dkc2FsZSBpcyBGaW5hbGl6YWJsZUNyb3dkc2FsZSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CiAgLy8gbWluaW11bSBhbW91bnQgb2YgZnVuZHMgdG8gYmUgcmFpc2VkIGluIHdlaXMKICB1aW50MjU2IHB1YmxpYyBnb2FsOwogIGJvb2wgcHJpdmF0ZSBfZ29hbFJlYWNoZWQgPSBmYWxzZTsKICAvLyByZWZ1bmQgdmF1bHQgdXNlZCB0byBob2xkIGZ1bmRzIHdoaWxlIGNyb3dkc2FsZSBpcyBydW5uaW5nCiAgUmVmdW5kVmF1bHQgcHJpdmF0ZSB2YXVsdDsKICBmdW5jdGlvbiBSZWZ1bmRhYmxlQ3Jvd2RzYWxlKHVpbnQyNTYgX2dvYWwpIHsKICAgIHJlcXVpcmUoX2dvYWwgPiAwKTsKICAgIHZhdWx0ID0gbmV3IFJlZnVuZFZhdWx0KHdhbGxldCk7CiAgICBnb2FsID0gX2dvYWw7CiAgfQogIC8vIFdlJ3JlIG92ZXJyaWRpbmcgdGhlIGZ1bmQgZm9yd2FyZGluZyBmcm9tIENyb3dkc2FsZS4KICAvLyBJbiBhZGRpdGlvbiB0byBzZW5kaW5nIHRoZSBmdW5kcywgd2Ugd2FudCB0byBjYWxsCiAgLy8gdGhlIFJlZnVuZFZhdWx0IGRlcG9zaXQgZnVuY3Rpb24KICBmdW5jdGlvbiBmb3J3YXJkRnVuZHMoKSBpbnRlcm5hbCB7CiAgICB2YXVsdC5kZXBvc2l0LnZhbHVlKG1zZy52YWx1ZSkobXNnLnNlbmRlcik7CiAgfQogIC8vIGlmIGNyb3dkc2FsZSBpcyB1bnN1Y2Nlc3NmdWwsIGludmVzdG9ycyBjYW4gY2xhaW0gcmVmdW5kcyBoZXJlCiAgZnVuY3Rpb24gY2xhaW1SZWZ1bmQoKSBwdWJsaWMgewogICAgcmVxdWlyZShpc0ZpbmFsaXplZCk7CiAgICByZXF1aXJlKCFnb2FsUmVhY2hlZCgpKTsKICAgIHZhdWx0LnJlZnVuZChtc2cuc2VuZGVyKTsKICB9CiAgLy8gdmF1bHQgZmluYWxpemF0aW9uIHRhc2ssIGNhbGxlZCB3aGVuIG93bmVyIGNhbGxzIGZpbmFsaXplKCkKICBmdW5jdGlvbiBmaW5hbGl6YXRpb24oKSBpbnRlcm5hbCB7CiAgICBpZiAoZ29hbFJlYWNoZWQoKSkgewogICAgICB2YXVsdC5jbG9zZSgpOwogICAgfSBlbHNlIHsKICAgICAgdmF1bHQuZW5hYmxlUmVmdW5kcygpOwogICAgfQogICAgc3VwZXIuZmluYWxpemF0aW9uKCk7CiAgfQogIGZ1bmN0aW9uIGdvYWxSZWFjaGVkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgIGlmICh3ZWlSYWlzZWQgPj0gZ29hbCkgewogICAgICBfZ29hbFJlYWNoZWQgPSB0cnVlOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gZWxzZSBpZiAoX2dvYWxSZWFjaGVkKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSAKICAgIGVsc2UgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHVwZGF0ZUdvYWxDaGVjaygpIG9ubHlPd25lciBwdWJsaWMgewogICAgX2dvYWxSZWFjaGVkID0gdHJ1ZTsKICB9CiAgZnVuY3Rpb24gZ2V0VmF1bHRBZGRyZXNzKCkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICByZXR1cm4gdmF1bHQ7CiAgfQp9Ci8qKgogKiBAdGl0bGUgQmVuZWJpdFRva2VuCiAqIEBhdXRob3IgSGFtemEgWWFzaW4gfHwgSnVuYWlkIE11c2h0YXEKICovCmNvbnRyYWN0IEJlbmViaXRUb2tlbiBpcyBNaW50YWJsZVRva2VuIHsKICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiQmVuZWJpdFRva2VuIjsKICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJCTkUiOwogIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7CiAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgX3RvdGFsU3VwcGx5ID0gMzAwMDAwMDAwICogMSBldGhlcjsKICAKLyoqIENvbnN0cnVjdG9yIEJlbmViaXRUb2tlbiAqLwogIGZ1bmN0aW9uIEJlbmViaXRUb2tlbigpIHsKICAgIHRvdGFsU3VwcGx5ID0gX3RvdGFsU3VwcGx5OwogIH0KfQpjb250cmFjdCBCZW5lYml0SUNPIGlzIENyb3dkc2FsZSwgQ2FwcGVkQ3Jvd2RzYWxlLCBSZWZ1bmRhYmxlQ3Jvd2RzYWxlIHsKICAgIHVpbnQyNTYgX3N0YXJ0VGltZSA9IDE1MTY2MjYwMDA7CiAgICB1aW50MjU2IF9lbmRUaW1lID0gMTUyNTA5MzIwMDsgCiAgICB1aW50MjU2IF9yYXRlID0gMzAwMDsKICAgIHVpbnQyNTYgX2dvYWwgPSA1MDAwICogMSBldGhlcjsKICAgIHVpbnQyNTYgX2NhcCA9IDQwMDAwICogMSBldGhlcjsKICAgIGFkZHJlc3MgX3dhbGxldCAgPSAweDg4QmZCZDJCNDY0QzE1YjI0NUE5ZjdhNTYzRDIwN2JkOEExNjEwNTQ7ICAgCiAgICAvKiogQ29uc3RydWN0b3IgQmVuZWJpdElDTyAqLwogICAgZnVuY3Rpb24gQmVuZWJpdElDTygpIAogICAgQ2FwcGVkQ3Jvd2RzYWxlKF9jYXApCiAgICBGaW5hbGl6YWJsZUNyb3dkc2FsZSgpCiAgICBSZWZ1bmRhYmxlQ3Jvd2RzYWxlKF9nb2FsKQogICAgQ3Jvd2RzYWxlKF9zdGFydFRpbWUsX2VuZFRpbWUsX3JhdGUsX3dhbGxldCkgCiAgICB7CiAgICAgICAgCiAgICB9CiAgICAvKiogQmVuZWJpdFRva2VuIENvbnRyYWN0IGlzIGdlbmVyYXRpbmcgZnJvbSBoZXJlICovCiAgICBmdW5jdGlvbiBjcmVhdGVUb2tlbkNvbnRyYWN0KCkgaW50ZXJuYWwgcmV0dXJucyAoTWludGFibGVUb2tlbikgewogICAgICAgIHJldHVybiBuZXcgQmVuZWJpdFRva2VuKCk7CiAgICB9Cn0='.
	

]
