Class {
	#name : #SRT36490a555a0019ea8457401584de111213ebd31a,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT36490a555a0019ea8457401584de111213ebd31a >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKioKICogQHRpdGxlIFNhZmVNYXRoIGZvciBwZXJmb3JtaW5nIHZhbGlkIG1hdGhlbWF0aWNzLgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAKICBmdW5jdGlvbiBNdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCkgewogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBEaXYodWludCBhLCB1aW50IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCkgewogICAgLy9hc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIERpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gU3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0gCgogIGZ1bmN0aW9uIEFkZCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfSAKfQoKLyoqCiogQHRpdGxlIENvbnRyYWN0IHRoYXQgd2lsbCB3b3JrIHdpdGggRVJDMjIzIHRva2Vucy4KKi8KY29udHJhY3QgRVJDMjIzUmVjZWl2aW5nQ29udHJhY3QgeyAKICAgIC8qKgogICAgICogQGRldiBTdGFuZGFyZCBFUkMyMjMgZnVuY3Rpb24gdGhhdCB3aWxsIGhhbmRsZSBpbmNvbWluZyB0b2tlbiB0cmFuc2ZlcnMuCiAgICAgKgogICAgICogQHBhcmFtIF9mcm9tICBUb2tlbiBzZW5kZXIgYWRkcmVzcy4KICAgICAqIEBwYXJhbSBfdmFsdWUgQW1vdW50IG9mIHRva2Vucy4KICAgICAqIEBwYXJhbSBfZGF0YSAgVHJhbnNhY3Rpb24gbWV0YWRhdGEuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRva2VuRmFsbGJhY2soYWRkcmVzcyBfZnJvbSwgdWludCBfdmFsdWUsIGJ5dGVzIF9kYXRhKSBwdWJsaWM7Cn0KCi8qKgogKiBDb250cmFjdCAiT3duYWJsZSIKICogUHVycG9zZTogRGVmaW5lcyBPd25lciBmb3IgY29udHJhY3QgYW5kIHByb3ZpZGUgZnVuY3Rpb25hbGl0eSB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8gYW5vdGhlciBhY2NvdW50CiAqLwpjb250cmFjdCBPd25hYmxlIHsKCiAgLy9vd25lciB2YXJpYWJsZSB0byBzdG9yZSBjb250cmFjdCBvd25lciBhY2NvdW50CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgLy9hZGQgYW5vdGhlciBvd25lciB0byB0cmFuc2ZlciBvd25lcnNoaXAKICBhZGRyZXNzIG9sZE93bmVyOwoKICAvL0NvbnN0cnVjdG9yIGZvciB0aGUgY29udHJhY3QgdG8gc3RvcmUgb3duZXIncyBhY2NvdW50IG9uIGRlcGxveWVtZW50CiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICBvbGRPd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKICAvL21vZGlmaWVyIHRvIGNoZWNrIHRyYW5zYWN0aW9uIGluaXRpYXRvciBpcyBvbmx5IG93bmVyCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZSAobXNnLnNlbmRlciA9PSBvd25lciB8fCBtc2cuc2VuZGVyID09IG9sZE93bmVyKTsKICAgICAgXzsKICB9CgogIC8vb3duZXJzaGlwIGNhbiBiZSB0cmFuc2ZlcnJlZCB0byBwcm92aWRlZCBuZXdPd25lci4gRnVuY3Rpb24gY2FuIG9ubHkgYmUgaW5pdGlhdGVkIGJ5IGNvbnRyYWN0IG93bmVyJ3MgYWNjb3VudAogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZSAobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCi8qKgogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiAqLwpjb250cmFjdCBFUkMyMCBpcyBPd25hYmxlIHsKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IHZhbHVlKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgX3N1Y2Nlc3MpOwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBfdmFsdWUpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgX3N1Y2Nlc3MpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIF9zdWNjZXNzKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50IF92YWx1ZSwgYnl0ZXMgY29tbWVudCk7Cn0KCmNvbnRyYWN0IENUViBpcyBFUkMyMCB7CgogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CiAgICAvL1RoZSBuYW1lIG9mIHRoZSAgdG9rZW4KICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJDb2luIFRWIjsKICAgIC8vVGhlIHRva2VuIHN5bWJvbAogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiQ1RWIjsKICAgIC8vVG8gZGVub3RlIHRoZSBsb2NraW5nIG9uIHRyYW5zZmVyIG9mIHRva2VucyBhbW9uZyB0b2tlbiBob2xkZXJzCiAgICBib29sIHB1YmxpYyBsb2NrZWQ7CiAgICAvL1RoZSBwcmVjaXNpb24gdXNlZCBpbiB0aGUgY2FsY3VsYXRpb25zIGluIGNvbnRyYWN0CiAgICB1aW50OCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKICAgIC8vbWF4aW11bSBudW1iZXIgb2YgdG9rZW5zCiAgICB1aW50MjU2IGNvbnN0YW50IE1BWENBUCA9IDI5OTk5OTkwZTE4OwogICAgLy8gbWF4aW11bSBudW1iZXIgb2YgdG9rZW5zIHRoYXQgY2FuIGJlIHN1cHBsaWVkIGJ5IHJlZmVycmFscwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgTUFYX1JFRkVSUkFMX1RPS0VOUyA9IDI5OTk5OTllMTg7CiAgICAvL3NldCB0aGUgc29mdGNhcCBvZiBldGhlciByZWNlaXZlZAogICAgdWludDI1NiBjb25zdGFudCBTT0ZUQ0FQID0gNzAgZXRoZXI7CiAgICAvL1JlZnVuZCBlbGlnaWJsZSBvciBub3QKICAgIC8vIDA6IHNhbGUgbm90IHN0YXJ0ZWQgeWV0LCByZWZ1bmRpbmcgaW52YWxpZAogICAgLy8gMTogcmVmdW5kIG5vdCByZXF1aXJlZAogICAgLy8gMjogc29mdGNhcCBub3QgcmVhY2hlZCwgcmVmdW5kIHJlcXVpcmVkCiAgICAvLyAzOiBSZWZ1bmQgaW4gcHJvZ3Jlc3MKICAgIC8vIDQ6IEV2ZXJ5b25lIHJlZnVuZGVkCiAgICB1aW50MjU2IHB1YmxpYyByZWZ1bmRTdGF0dXMgPSAwOwogICAgLy90aGUgYWNjb3VudCB3aGljaCB3aWxsIHJlY2VpdmUgYWxsIGJhbGFuY2UKICAgIGFkZHJlc3MgZXRoQ29sbGVjdG9yOwogICAgLy90byBzYXZlIHRvdGFsIG51bWJlciBvZiBldGhlcnMgcmVjZWl2ZWQKICAgIHVpbnQyNTYgdG90YWxXZWlSZWNlaXZlZDsKICAgIC8vY291bnQgdG9rZW5zIGVhcm5lZCBieSByZWZlcnJhbHMKICAgIHVpbnQyNTYgcHVibGljIHRva2Vuc1N1cHBsaWVkRnJvbVJlZmVycmFsID0gMDsKCiAgICAvL01hcHBpbmcgdG8gcmVsYXRlIG93bmVyIGFuZCBzcGVuZGVyIHRvIHRoZSB0b2tlbnMgYWxsb3dlZCB0byB0cmFuc2ZlciBmcm9tIG93bmVyCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwogICAgLy90byBtYW5hZ2UgcmVmZXJyYWxzCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYWRkcmVzcykgcHVibGljIHJlZmVycmVkQnk7CiAgICAvL01hcHBpbmcgdG8gcmVsYXRlIG51bWJlciBvZiAgdG9rZW4gdG8gdGhlIGFjY291bnQKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgICAvL1N0cnVjdHVyZSBmb3IgaW52ZXN0b3JzOyBob2xkcyByZWNlaXZlZCB3ZWkgYW1vdW50IGFuZCBUb2tlbiBzZW50CiAgICBzdHJ1Y3QgSW52ZXN0b3IgewogICAgICAgIC8vd2VpIHJlY2VpdmVkIGR1cmluZyBQcmVTYWxlCiAgICAgICAgdWludCB3ZWlSZWNlaXZlZDsKICAgICAgICAvL1Rva2VucyBzZW50IGR1cmluZyBDcm93ZFNhbGUKICAgICAgICB1aW50IHRva2Vuc1B1cmNoYXNlZDsKICAgICAgICAvL3VzZXIgaGFzIGJlZW4gcmVmdW5kZWQgb3Igbm90CiAgICAgICAgYm9vbCByZWZ1bmRlZDsKICAgICAgICAvL1VuaXF1ZWx5IGlkZW50aWZ5IGFuIGludmVzdG9yKHVzZWQgZm9yIGl0ZXJhdGluZykKICAgICAgICB1aW50IGludmVzdG9ySUQ7CiAgICB9CgogICAgLy90aW1lIHdoZW4gdGhlIHNhbGUgc3RhcnRzCiAgICB1aW50MjU2IHB1YmxpYyBzdGFydFRpbWU7CiAgICAvL3RpbWUgd2hlbiB0aGUgcHJlc2FsZSBlbmRzCiAgICB1aW50MjU2IHB1YmxpYyBlbmRUaW1lOwogICAgLy90byBjaGVjayB0aGUgc2FsZSBzdGF0dXMKICAgIGJvb2wgcHVibGljIHNhbGVSdW5uaW5nOwogICAgLy9pbnZlc3RvcnMgaW5kZXhlZCBieSB0aGVpciBFVEggYWRkcmVzcwogICAgbWFwcGluZyhhZGRyZXNzID0+IEludmVzdG9yKSBwdWJsaWMgaW52ZXN0b3JzOwogICAgLy9pbnZlc3RvcnMgaW5kZXhlZCBieSB0aGVpciBJRHMKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgcHVibGljIGludmVzdG9yTGlzdDsKICAgIC8vY291bnQgbnVtYmVyIG9mIGludmVzdG9ycwogICAgdWludDI1NiBwdWJsaWMgY291bnRUb3RhbEludmVzdG9yczsKICAgIC8vdG8ga2VlcCB0cmFjayBvZiBob3cgbWFueSBpbnZlc3RvcnMgaGF2ZSBiZWVuIHJlZnVuZGVkCiAgICB1aW50MjU2IGNvdW50SW52ZXN0b3JzUmVmdW5kZWQ7CiAgICAvL2J5IGRlZmF1bHQgYW55IG5ldyBhY2NvdW50IHdpbGwgc2hvdyBmYWxzZSBmb3IgcmVnaXN0ZXJlZCBtYXBwaW5nCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgcmVnaXN0ZXJlZDsKCiAgICBhZGRyZXNzW10gbGlzdE9mQWRkcmVzc2VzOwoKICAgIC8vZXZlbnRzCiAgICBldmVudCBTdGF0ZUNoYW5nZWQoYm9vbCk7CgogICAgZnVuY3Rpb24gQ1RWKCkgcHVibGljewogICAgICAgIHRvdGFsU3VwcGx5ID0gMDsKICAgICAgICBzdGFydFRpbWUgPSAwOwogICAgICAgIGVuZFRpbWUgPSAwOwogICAgICAgIHNhbGVSdW5uaW5nID0gZmFsc2U7CiAgICAgICAgbG9ja2VkID0gdHJ1ZTsKICAgICAgICBzZXRFdGhDb2xsZWN0b3IoMHhBZjNCQmY2NjM3NjlEZTllRWI2QzJiMjM1MjYyQ2Y3MDRlRDRFQTRiKTsKICAgIH0KICAgIC8vVG8gaGFuZGxlIEVSQzIwIHNob3J0IGFkZHJlc3MgYXR0YWNrCiAgICBtb2RpZmllciBvbmx5UGF5bG9hZFNpemUodWludCBzaXplKSB7CiAgICAgICAgcmVxdWlyZShtc2cuZGF0YS5sZW5ndGggPj0gc2l6ZSArIDQpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seVVubG9ja2VkKCkgeyAKICAgICAgICByZXF1aXJlICghbG9ja2VkKTsgCiAgICAgICAgXzsgCiAgICB9CgogICAgbW9kaWZpZXIgdmFsaWRUaW1lZnJhbWUoKXsKICAgICAgICByZXF1aXJlKHNhbGVSdW5uaW5nICYmIG5vdyA+PXN0YXJ0VGltZSAmJiBub3cgPCBlbmRUaW1lKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBzZXRFdGhDb2xsZWN0b3IoYWRkcmVzcyBfZXRoQ29sbGVjdG9yKSBwdWJsaWMgb25seU93bmVyewogICAgICAgIHJlcXVpcmUoX2V0aENvbGxlY3RvciAhPSBhZGRyZXNzKDApKTsKICAgICAgICBldGhDb2xsZWN0b3IgPSBfZXRoQ29sbGVjdG9yOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBzdGFydFNhbGUoKSBwdWJsaWMgb25seU93bmVyewogICAgICAgIHJlcXVpcmUoc3RhcnRUaW1lID09IDApOwogICAgICAgIHN0YXJ0VGltZSA9IG5vdzsKICAgICAgICBlbmRUaW1lID0gc3RhcnRUaW1lLkFkZCg3IHdlZWtzKTsKICAgICAgICBzYWxlUnVubmluZyA9IHRydWU7CiAgICB9CgogICAgLy9UbyBlbmFibGUgdHJhbnNmZXIgb2YgdG9rZW5zCiAgICBmdW5jdGlvbiB1bmxvY2tUcmFuc2ZlcigpIGV4dGVybmFsIG9ubHlPd25lcnsKICAgICAgICBsb2NrZWQgPSBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBDaGVjayBpZiB0aGUgYWRkcmVzcyBiZWluZyBwYXNzZWQgYmVsb25ncyB0byBhIGNvbnRyYWN0CiAgICAqCiAgICAqIEBwYXJhbSBfYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB2ZXJpZnkKICAgICogQHJldHVybiBBIGJvb2wgc3BlY2lmeWluZyBpZiB0aGUgYWRkcmVzcyBpcyB0aGF0IG9mIGNvbnRyYWN0IG9yIG5vdAogICAgKi8KICAgIGZ1bmN0aW9uIGlzQ29udHJhY3QoYWRkcmVzcyBfYWRkcmVzcykgcHJpdmF0ZSB2aWV3IHJldHVybnMoYm9vbCBfaXNDb250cmFjdCl7CiAgICAgICAgYXNzZXJ0KF9hZGRyZXNzICE9IGFkZHJlc3MoMCkgKTsKICAgICAgICB1aW50IGxlbmd0aDsKICAgICAgICAvL2lubGluZSBhc3NlbWJseSBjb2RlIHRvIGNoZWNrIHRoZSBsZW5ndGggb2YgYWRkcmVzcwogICAgICAgIGFzc2VtYmx5ewogICAgICAgICAgICBsZW5ndGggOj0gZXh0Y29kZXNpemUoX2FkZHJlc3MpCiAgICAgICAgfQogICAgICAgIGlmKGxlbmd0aCA+IDApewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgZWxzZXsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICogQGRldiBDaGVjayBiYWxhbmNlIG9mIGdpdmVuIGFjY291bnQgYWRkcmVzcwogICAgKgogICAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIGFjY291bnQgd2hvc2UgYmFsYW5jZSB5b3Ugd2FudCB0byBrbm93CiAgICAqIEByZXR1cm4gYmFsYW5jZSBvZiB0aGUgYWNjb3VudAogICAgKi8KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBfdmFsdWUpewogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IFRyYW5zZmVyIHNlbmRlcidzIHRva2VuIHRvIGEgZ2l2ZW4gYWRkcmVzcwogICAgKgogICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgICogQHJldHVybiBBIGJvb2wgaWYgdGhlIHRyYW5zZmVyIHdhcyBhIHN1Y2Nlc3Mgb3Igbm90CiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5VW5sb2NrZWQgb25seVBheWxvYWRTaXplKDIgKiAzMikgcHVibGljIHJldHVybnMoYm9vbCBfc3VjY2VzcykgewogICAgICAgIHJlcXVpcmUoIF90byAhPSBhZGRyZXNzKDApICk7CiAgICAgICAgYnl0ZXMgbWVtb3J5IF9lbXB0eTsKICAgICAgICBpZigoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPiBfdmFsdWUpICYmIF92YWx1ZSA+IDAgJiYgX3RvICE9IGFkZHJlc3MoMCkpewogICAgICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLlN1YihfdmFsdWUpOwogICAgICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5BZGQoX3ZhbHVlKTsKICAgICAgICAgICAgaWYoaXNDb250cmFjdChfdG8pKXsKICAgICAgICAgICAgICAgIEVSQzIyM1JlY2VpdmluZ0NvbnRyYWN0IHJlY2VpdmVyID0gRVJDMjIzUmVjZWl2aW5nQ29udHJhY3QoX3RvKTsKICAgICAgICAgICAgICAgIHJlY2VpdmVyLnRva2VuRmFsbGJhY2sobXNnLnNlbmRlciwgX3ZhbHVlLCBfZW1wdHkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlLCBfZW1wdHkpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgZWxzZXsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgdG8gYW4gYWRkcmVzcyBnaXZlbiBieSBzZW5kZXIuIFRvIG1ha2UgRVJDMjIzIGNvbXBsaWFudAogICAgKgogICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgICogQHBhcmFtIF9kYXRhIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gb2YgYWNjb3VudCBmcm9tIHdoZXJlIHRvIHRyYW5zZmVyIGZyb20KICAgICogQHJldHVybiBBIGJvb2wgaWYgdGhlIHRyYW5zZmVyIHdhcyBhIHN1Y2Nlc3Mgb3Igbm90CiAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBieXRlcyBfZGF0YSkgb25seVVubG9ja2VkIG9ubHlQYXlsb2FkU2l6ZSgzICogMzIpIHB1YmxpYyByZXR1cm5zKGJvb2wgX3N1Y2Nlc3MpIHsKICAgICAgICBpZigoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPiBfdmFsdWUpICYmIF92YWx1ZSA+IDAgJiYgX3RvICE9IGFkZHJlc3MoMCkpewogICAgICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLlN1YihfdmFsdWUpOwogICAgICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5BZGQoX3ZhbHVlKTsKICAgICAgICAgICAgaWYoaXNDb250cmFjdChfdG8pKXsKICAgICAgICAgICAgICAgIEVSQzIyM1JlY2VpdmluZ0NvbnRyYWN0IHJlY2VpdmVyID0gRVJDMjIzUmVjZWl2aW5nQ29udHJhY3QoX3RvKTsKICAgICAgICAgICAgICAgIHJlY2VpdmVyLnRva2VuRmFsbGJhY2sobXNnLnNlbmRlciwgX3ZhbHVlLCBfZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUsIF9kYXRhKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGVsc2V7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlciwgZm9yIEVSQzIwLgogICAgKgogICAgKiBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICAqIEBwYXJhbSBfdmFsdWUgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgICogQHJldHVybiBBIGJvb2wgaWYgdGhlIHRyYW5zZmVyIHdhcyBhIHN1Y2Nlc3Mgb3Igbm90IAogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIG9ubHlQYXlsb2FkU2l6ZSgzKjMyKSBwdWJsaWMgb25seVVubG9ja2VkIHJldHVybnMgKGJvb2wpewogICAgICAgIGJ5dGVzIG1lbW9yeSBfZW1wdHk7CiAgICAgICAgaWYoKF92YWx1ZSA+IDApCiAgICAgICAgICAgJiYgKF90byAhPSBhZGRyZXNzKDApKQogICAgICAgJiYgKF9mcm9tICE9IGFkZHJlc3MoMCkpCiAgICAgICAmJiAoYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPiBfdmFsdWUgKSl7CiAgICAgICAgICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLlN1YihfdmFsdWUpOwogICAgICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLkFkZChfdmFsdWUpOwogICAgICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uU3ViKF92YWx1ZSk7CiAgICAgICAgICAgaWYoaXNDb250cmFjdChfdG8pKXsKICAgICAgICAgICAgICAgRVJDMjIzUmVjZWl2aW5nQ29udHJhY3QgcmVjZWl2ZXIgPSBFUkMyMjNSZWNlaXZpbmdDb250cmFjdChfdG8pOwogICAgICAgICAgICAgICByZWNlaXZlci50b2tlbkZhbGxiYWNrKG1zZy5zZW5kZXIsIF92YWx1ZSwgX2VtcHR5KTsKICAgICAgICAgICB9CiAgICAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlLCBfZW1wdHkpOwogICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgfQogICAgICAgZWxzZXsKICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBoYXMgYWxsb3dlZCBhIHNwZW5kZXIgdG8gcmVjaWV2ZSBmcm9tIG93bmVyLgogICAgKgogICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIgdG8gc3BlbmQuCiAgICAqLwogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KXsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICAqCiAgICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCl7CiAgICAgICAgaWYoIChfdmFsdWUgPiAwKSAmJiAoX3NwZW5kZXIgIT0gYWRkcmVzcygwKSkgJiYgKGJhbGFuY2VzW21zZy5zZW5kZXJdID49IF92YWx1ZSkpewogICAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICBlbHNlewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IENhbGN1bGF0ZSBudW1iZXIgb2YgdG9rZW5zIHRoYXQgd2lsbCBiZSByZWNlaXZlZCBpbiBvbmUgZXRoZXIKICAgICogCiAgICAqLwogICAgZnVuY3Rpb24gZ2V0UHJpY2UoKSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IHByaWNlOwogICAgICAgIGlmKHRvdGFsU3VwcGx5IDw9IDFlNioxZTE4KQogICAgICAgICAgICBwcmljZSA9IDEzMzMwOwogICAgICAgIGVsc2UgaWYodG90YWxTdXBwbHkgPD0gNWU2KjFlMTgpCiAgICAgICAgICAgIHByaWNlID0gMTI1MDA7CiAgICAgICAgZWxzZSBpZih0b3RhbFN1cHBseSA8PSA5ZTYqMWUxOCkKICAgICAgICAgICAgcHJpY2UgPSAxMTc2MDsKICAgICAgICBlbHNlIGlmKHRvdGFsU3VwcGx5IDw9IDEzZTYqMWUxOCkKICAgICAgICAgICAgcHJpY2UgPSAxMTExMDsKICAgICAgICBlbHNlIGlmKHRvdGFsU3VwcGx5IDw9IDE3ZTYqMWUxOCkKICAgICAgICAgICAgcHJpY2UgPSAxMDUyMDsKICAgICAgICBlbHNlIGlmKHRvdGFsU3VwcGx5IDw9IDIxZTYqMWUxOCkKICAgICAgICAgICAgcHJpY2UgPSAxMDAwMDsKICAgICAgICBlbHNlewogICAgICAgICAgICAvL3plcm8gaW5kaWNhdGVzIHRoYXQgbm8gdG9rZW5zIHdpbGwgYmUgYWxsb2NhdGVkIHdoZW4gdG90YWwgc3VwcGx5CiAgICAgICAgICAgIC8vb2YgMjEgbWlsbGlvbiB0b2tlbnMgaXMgcmVhY2hlZAogICAgICAgICAgICBwcmljZSA9IDA7CiAgICAgICAgfQogICAgICAgIHJldHVybiBwcmljZTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gbWludEFuZFRyYW5zZmVyKGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQyNTYgbnVtYmVyT2ZUb2tlbnNXaXRob3V0RGVjaW1hbCwgYnl0ZXMgY29tbWVudCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgdWludDI1NiB0b2tlbnNUb0JlVHJhbnNmZXJyZWQgPSBudW1iZXJPZlRva2Vuc1dpdGhvdXREZWNpbWFsKjFlMTg7CiAgICAgICAgcmVxdWlyZSh0b3RhbFN1cHBseS5BZGQodG9rZW5zVG9CZVRyYW5zZmVycmVkKSA8PSBNQVhDQVApOwogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuQWRkKHRva2Vuc1RvQmVUcmFuc2ZlcnJlZCk7CiAgICAgICAgYmFsYW5jZXNbYmVuZWZpY2lhcnldID0gYmFsYW5jZXNbYmVuZWZpY2lhcnldLkFkZCh0b2tlbnNUb0JlVHJhbnNmZXJyZWQpOwogICAgICAgIFRyYW5zZmVyKG93bmVyLCBiZW5lZmljaWFyeSAsdG9rZW5zVG9CZVRyYW5zZmVycmVkLCBjb21tZW50KTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiB0byBlbmFibGUgcGF1c2Ugc2FsZSBmb3IgYnJlYWsgaW4gSUNPIGFuZCBQcmUtSUNPCiAgICAqCiAgICAqLwogICAgZnVuY3Rpb24gcGF1c2VTYWxlKCkgcHVibGljIG9ubHlPd25lcnsKICAgICAgICBhc3NlcnQoc2FsZVJ1bm5pbmcgJiYgc3RhcnRUaW1lID4gMCAmJiBub3cgPD0gZW5kVGltZSk7CiAgICAgICAgc2FsZVJ1bm5pbmcgPSBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICogQGRldiB0byByZXN1bWUgcGF1c2VkIHNhbGUKICAgICoKICAgICovCiAgICBmdW5jdGlvbiByZXN1bWVTYWxlKCkgcHVibGljIG9ubHlPd25lcnsKICAgICAgICBhc3NlcnQoIXNhbGVSdW5uaW5nICYmIHN0YXJ0VGltZSA+IDAgJiYgbm93IDw9IGVuZFRpbWUpOwogICAgICAgIHNhbGVSdW5uaW5nID0gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBidXlUb2tlbnMoYWRkcmVzcyBiZW5lZmljaWFyeSkgaW50ZXJuYWwgdmFsaWRUaW1lZnJhbWUgewogICAgICAgIHVpbnQyNTYgdG9rZW5zQm91Z2h0ID0gbXNnLnZhbHVlLk11bChnZXRQcmljZSgpKTsKICAgICAgICBiYWxhbmNlc1tiZW5lZmljaWFyeV0gPSBiYWxhbmNlc1tiZW5lZmljaWFyeV0uQWRkKHRva2Vuc0JvdWdodCk7CiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5BZGQodG9rZW5zQm91Z2h0KTsKCiAgICAgICAgLy9NYWtlIGVudHJ5IGluIEludmVzdG9yIGluZGV4ZWQgd2l0aCBhZGRyZXNzCiAgICAgICAgSW52ZXN0b3Igc3RvcmFnZSBpbnZlc3RvclN0cnVjdCA9IGludmVzdG9yc1tiZW5lZmljaWFyeV07CiAgICAgICAgLy9JZiBpdCBpcyBhIG5ldyBpbnZlc3RvciwgdGhlbiBjcmVhdGUgYSBuZXcgaWQKICAgICAgICBpZihpbnZlc3RvclN0cnVjdC5pbnZlc3RvcklEID09IDApewogICAgICAgICAgICBjb3VudFRvdGFsSW52ZXN0b3JzKys7CiAgICAgICAgICAgIGludmVzdG9yU3RydWN0LmludmVzdG9ySUQgPSBjb3VudFRvdGFsSW52ZXN0b3JzOwogICAgICAgICAgICBpbnZlc3Rvckxpc3RbY291bnRUb3RhbEludmVzdG9yc10gPSBiZW5lZmljaWFyeTsKICAgICAgICB9CiAgICAgICAgZWxzZXsKICAgICAgICAgICAgaW52ZXN0b3JTdHJ1Y3Qud2VpUmVjZWl2ZWQgPSBpbnZlc3RvclN0cnVjdC53ZWlSZWNlaXZlZC5BZGQobXNnLnZhbHVlKTsKICAgICAgICAgICAgaW52ZXN0b3JTdHJ1Y3QudG9rZW5zUHVyY2hhc2VkID0gaW52ZXN0b3JTdHJ1Y3QudG9rZW5zUHVyY2hhc2VkLkFkZCh0b2tlbnNCb3VnaHQpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvL0F3YXJkIHJlZmVycmFsIHRva2VucwogICAgICAgIGlmKHJlZmVycmVkQnlbbXNnLnNlbmRlcl0gIT0gYWRkcmVzcygwKSl7CiAgICAgICAgICAgIC8vZ2l2ZSBzb21lIHJlZmVycmFsIHRva2VucwogICAgICAgICAgICBiYWxhbmNlc1tyZWZlcnJlZEJ5W21zZy5zZW5kZXJdXSA9IGJhbGFuY2VzW3JlZmVycmVkQnlbbXNnLnNlbmRlcl1dLkFkZCh0b2tlbnNCb3VnaHQvMTApOwogICAgICAgICAgICB0b2tlbnNTdXBwbGllZEZyb21SZWZlcnJhbCA9IHRva2Vuc1N1cHBsaWVkRnJvbVJlZmVycmFsLkFkZCh0b2tlbnNCb3VnaHQvMTApOwogICAgICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LkFkZCh0b2tlbnNCb3VnaHQvMTApOwogICAgICAgIH0KICAgICAgICAvL2lmIHJlZmVycmVyIHdhcyBhbHNvIHJlZmVycmVkIGJ5IHNvbWVvbmUKICAgICAgICBpZihyZWZlcnJlZEJ5W3JlZmVycmVkQnlbbXNnLnNlbmRlcl1dICE9IGFkZHJlc3MoMCkpewogICAgICAgICAgICAvL2dpdmUgMSUgdG9rZW5zIHRvIDJuZCBnZW5lcmF0aW9uIHJlZmVycmVyCiAgICAgICAgICAgIGJhbGFuY2VzW3JlZmVycmVkQnlbcmVmZXJyZWRCeVttc2cuc2VuZGVyXV1dID0gYmFsYW5jZXNbcmVmZXJyZWRCeVtyZWZlcnJlZEJ5W21zZy5zZW5kZXJdXV0uQWRkKHRva2Vuc0JvdWdodC8xMDApOwogICAgICAgICAgICBpZih0b2tlbnNTdXBwbGllZEZyb21SZWZlcnJhbC5BZGQodG9rZW5zQm91Z2h0LzEwMCkgPCBNQVhfUkVGRVJSQUxfVE9LRU5TKQogICAgICAgICAgICAgICAgdG9rZW5zU3VwcGxpZWRGcm9tUmVmZXJyYWwgPSB0b2tlbnNTdXBwbGllZEZyb21SZWZlcnJhbC5BZGQodG9rZW5zQm91Z2h0LzEwMCk7CiAgICAgICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuQWRkKHRva2Vuc0JvdWdodC8xMDApOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBhc3NlcnQodG90YWxTdXBwbHkgPD0gTUFYQ0FQKTsKICAgICAgICB0b3RhbFdlaVJlY2VpdmVkID0gdG90YWxXZWlSZWNlaXZlZC5BZGQobXNnLnZhbHVlKTsKICAgICAgICBldGhDb2xsZWN0b3IudHJhbnNmZXIobXNnLnZhbHVlKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIHJlZ2lzdGVyIGEgcmVmZXJyYWwuCiAgICAgKiBXaG9ldmVyIGNhbGxzIHRoaXMgZnVuY3Rpb24sIGlzIHRlbGxpbmcgY29udHJhY3QsCiAgICAgKiB0aGF0ICJJIHdhcyByZWZlcnJlZCBieSByZWZlcnJlZEJ5QWRkcmVzcyIKICAgICAqIFdoZW5ldmVyIEkgYW0gZ29pbmcgdG8gYnV5IHRva2VucywgMTAlIHdpbGwgYmUgYXdhcmRlZCB0byByZWZlcnJlZEJ5QWRkcmVzcwogICAgICogCiAgICAgKiBAcGFyYW0gcmVmZXJyZWRCeUFkZHJlc3MgVGhlIGFkZHJlc3Mgb2YgcGVyc29uIHdobyByZWZlcnJlZCB0aGUgcGVyc29uIGNhbGxpbmcgdGhpcyBmdW5jdGlvbgogICAgICovCiAgICBmdW5jdGlvbiByZWdpc3RlclJlZmVycmFsIChhZGRyZXNzIHJlZmVycmVkQnlBZGRyZXNzKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciAhPSByZWZlcnJlZEJ5QWRkcmVzcyAmJiByZWZlcnJlZEJ5QWRkcmVzcyAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZWZlcnJlZEJ5W21zZy5zZW5kZXJdID0gcmVmZXJyZWRCeUFkZHJlc3M7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogQGRldiBPd25lciBpcyBhbGxvd2VkIHRvIG1hbnVhbGx5IHJlZ2lzdGVyIHdobyB3YXMgcmVmZXJyZWQgYnkgd2hvbQogICAgICogQHBhcmFtIGhlV2FzUmVmZXJyZWQgVGhlIGFkZHJlc3Mgb2YgcGVyc29uIHdobyB3YXMgcmVmZXJyZWQKICAgICAqIEBwYXJhbSBJX3JlZmVycmVkX3RoaXNfcGVyc29uIFRoZSBwZXJzb24gd2hvIHJlZmVycmVkIHRoZSBhYm92ZSBhZGRyZXNzCiAgICAgKi8KICAgIGZ1bmN0aW9uIHJlZmVycmFsUmVnaXN0cmF0aW9uKGFkZHJlc3MgaGVXYXNSZWZlcnJlZCwgYWRkcmVzcyBJX3JlZmVycmVkX3RoaXNfcGVyc29uKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKGhlV2FzUmVmZXJyZWQgIT0gYWRkcmVzcygwKSAmJiBJX3JlZmVycmVkX3RoaXNfcGVyc29uICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlZmVycmVkQnlbaGVXYXNSZWZlcnJlZF0gPSBJX3JlZmVycmVkX3RoaXNfcGVyc29uOwogICAgfQoKICAgIC8qKgogICAgKiBGaW5hbGl6ZSB0aGUgY3Jvd2RzYWxlCiAgICAqLwogICAgZnVuY3Rpb24gZmluYWxpemUoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICAvL01ha2Ugc3VyZSBTYWxlIGlzIHJ1bm5pbmcKICAgICAgICBhc3NlcnQoc2FsZVJ1bm5pbmcpOwogICAgICAgIGlmKE1BWENBUC5TdWIodG90YWxTdXBwbHkpIDw9IDEgZXRoZXIgfHwgbm93ID4gZW5kVGltZSl7CiAgICAgICAgICAgIC8vbm93IHNhbGUgY2FuIGJlIGZpbmlzaGVkCiAgICAgICAgICAgIHNhbGVSdW5uaW5nID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICAvL1JlZnVuZCBlbGlnaWJsZSBvciBub3QKICAgICAgICAvLyAwOiBzYWxlIG5vdCBzdGFydGVkIHlldCwgcmVmdW5kaW5nIGludmFsaWQKICAgICAgICAvLyAxOiByZWZ1bmQgbm90IHJlcXVpcmVkCiAgICAgICAgLy8gMjogc29mdGNhcCBub3QgcmVhY2hlZCwgcmVmdW5kIHJlcXVpcmVkCiAgICAgICAgLy8gMzogUmVmdW5kIGluIHByb2dyZXNzCiAgICAgICAgLy8gNDogRXZlcnlvbmUgcmVmdW5kZWQKCiAgICAgICAgLy9DaGVja3MgaWYgdGhlIGZ1bmRyYWlzaW5nIGdvYWwgaXMgcmVhY2hlZCBpbiBjcm93ZHNhbGUgb3Igbm90CiAgICAgICAgaWYgKHRvdGFsV2VpUmVjZWl2ZWQgPCBTT0ZUQ0FQKQogICAgICAgICAgICByZWZ1bmRTdGF0dXMgPSAyOwogICAgICAgIGVsc2UKICAgICAgICAgICAgcmVmdW5kU3RhdHVzID0gMTsKCiAgICAgICAgLy9jcm93ZHNhbGUgaXMgZW5kZWQKICAgICAgICBzYWxlUnVubmluZyA9IGZhbHNlOwogICAgICAgIC8vZW5hYmxlIHRyYW5zZmVycmluZyBvZiB0b2tlbnMgYW1vbmcgdG9rZW4gaG9sZGVycwogICAgICAgIGxvY2tlZCA9IGZhbHNlOwogICAgICAgIC8vRW1pdCBldmVudCB3aGVuIGNyb3dkc2FsZSBzdGF0ZSBjaGFuZ2VzCiAgICAgICAgU3RhdGVDaGFuZ2VkKHRydWUpOwogICAgfQoKICAgIC8qKgogICAgKiBSZWZ1bmQgdGhlIGludmVzdG9ycyBpbiBjYXNlIHRhcmdldCBvZiBjcm93ZHNhbGUgbm90IGFjaGlldmVkCiAgICAqLwogICAgZnVuY3Rpb24gcmVmdW5kKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgYXNzZXJ0KHJlZnVuZFN0YXR1cyA9PSAyIHx8IHJlZnVuZFN0YXR1cyA9PSAzKTsKICAgICAgICB1aW50IGJhdGNoU2l6ZSA9IGNvdW50SW52ZXN0b3JzUmVmdW5kZWQuQWRkKDMwKSA8IGNvdW50VG90YWxJbnZlc3RvcnMgPyBjb3VudEludmVzdG9yc1JlZnVuZGVkLkFkZCgzMCk6IGNvdW50VG90YWxJbnZlc3RvcnM7CiAgICAgICAgZm9yKHVpbnQgaT1jb3VudEludmVzdG9yc1JlZnVuZGVkLkFkZCgxKTsgaSA8PSBiYXRjaFNpemU7IGkrKyl7CiAgICAgICAgICAgIGFkZHJlc3MgaW52ZXN0b3JBZGRyZXNzID0gaW52ZXN0b3JMaXN0W2ldOwogICAgICAgICAgICBJbnZlc3RvciBzdG9yYWdlIGludmVzdG9yU3RydWN0ID0gaW52ZXN0b3JzW2ludmVzdG9yQWRkcmVzc107CiAgICAgICAgICAgIC8vSWYgcHVyY2hhc2UgaGFzIGJlZW4gbWFkZSBkdXJpbmcgQ3Jvd2RTYWxlCiAgICAgICAgICAgIGlmKGludmVzdG9yU3RydWN0LnRva2Vuc1B1cmNoYXNlZCA+IDAgJiYgaW52ZXN0b3JTdHJ1Y3QudG9rZW5zUHVyY2hhc2VkIDw9IGJhbGFuY2VzW2ludmVzdG9yQWRkcmVzc10pewogICAgICAgICAgICAgICAgLy9yZXR1cm4gZXZlcnl0aGluZwogICAgICAgICAgICAgICAgaW52ZXN0b3JBZGRyZXNzLnRyYW5zZmVyKGludmVzdG9yU3RydWN0LndlaVJlY2VpdmVkKTsKICAgICAgICAgICAgICAgIC8vUmVkdWNlIHRvdGFsV2VpUmVjZWl2ZWQKICAgICAgICAgICAgICAgIHRvdGFsV2VpUmVjZWl2ZWQgPSB0b3RhbFdlaVJlY2VpdmVkLlN1YihpbnZlc3RvclN0cnVjdC53ZWlSZWNlaXZlZCk7CiAgICAgICAgICAgICAgICAvL1VwZGF0ZSB0b3RhbFN1cHBseQogICAgICAgICAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5TdWIoaW52ZXN0b3JTdHJ1Y3QudG9rZW5zUHVyY2hhc2VkKTsKICAgICAgICAgICAgICAgIC8vIHJlZHVjZSBiYWxhbmNlcwogICAgICAgICAgICAgICAgYmFsYW5jZXNbaW52ZXN0b3JBZGRyZXNzXSA9IGJhbGFuY2VzW2ludmVzdG9yQWRkcmVzc10uU3ViKGludmVzdG9yU3RydWN0LnRva2Vuc1B1cmNoYXNlZCk7CiAgICAgICAgICAgICAgICAvL3NldCBldmVyeXRoaW5nIHRvIHplcm8gYWZ0ZXIgdHJhbnNmZXIgc3VjY2Vzc2Z1bAogICAgICAgICAgICAgICAgaW52ZXN0b3JTdHJ1Y3Qud2VpUmVjZWl2ZWQgPSAwOwogICAgICAgICAgICAgICAgaW52ZXN0b3JTdHJ1Y3QudG9rZW5zUHVyY2hhc2VkID0gMDsKICAgICAgICAgICAgICAgIGludmVzdG9yU3RydWN0LnJlZnVuZGVkID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAvL1VwZGF0ZSB0aGUgbnVtYmVyIG9mIGludmVzdG9ycyB0aGF0IGhhdmUgcmVjaWV2ZWQgcmVmdW5kCiAgICAgICAgY291bnRJbnZlc3RvcnNSZWZ1bmRlZCA9IGJhdGNoU2l6ZTsKICAgICAgICBpZihjb3VudEludmVzdG9yc1JlZnVuZGVkID09IGNvdW50VG90YWxJbnZlc3RvcnMpewogICAgICAgICAgICByZWZ1bmRTdGF0dXMgPSA0OwogICAgICAgIH0KICAgICAgICBTdGF0ZUNoYW5nZWQodHJ1ZSk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGV4dGVuZFNhbGUodWludDU2IG51bWJlck9mRGF5cykgcHVibGljIG9ubHlPd25lcnsKICAgICAgICBzYWxlUnVubmluZyA9IHRydWU7CiAgICAgICAgZW5kVGltZSA9IG5vdy5BZGQobnVtYmVyT2ZEYXlzKjg2NDAwKTsKICAgICAgICBTdGF0ZUNoYW5nZWQodHJ1ZSk7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgVGhpcyB3aWxsIHJlY2VpdmUgZXRoZXIgZnJvbSBvd25lciBzbyB0aGF0IHRoZSBjb250cmFjdCBoYXMgYmFsYW5jZSB3aGlsZSByZWZ1bmRpbmcKICAgICoKICAgICovCiAgICBmdW5jdGlvbiBwcmVwYXJlRm9yUmVmdW5kKCkgcHVibGljIHBheWFibGUge30KCiAgICBmdW5jdGlvbiAoKSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIpOwogICAgfQoKICAgIC8qKgogICAgKiBGYWlsc2FmZSBkcmFpbgogICAgKi8KICAgIGZ1bmN0aW9uIGRyYWluKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgb3duZXIudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgIH0KfQ=='.
	

]
