Class {
	#name : #SRT22b925def28A50EA5f1C13A2f056dDF2486D2Bc5,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT22b925def28A50EA5f1C13A2f056dDF2486D2Bc5 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCgoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgcHVibGljIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9CgovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7CgogIC8qKgogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcwogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4KICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbbXNnLnNlbmRlcl0pOwoKICAgIC8vIFNhZmVNYXRoLnN1YiB3aWxsIHRocm93IGlmIHRoZXJlIGlzIG5vdCBlbm91Z2ggYmFsYW5jZS4KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuCiAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLgogICovCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cgp9CgoKLyoqCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbgogKgogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgaW50ZXJuYWwgYWxsb3dlZDsKCgogIC8qKgogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20KICAgKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1tfZnJvbV0pOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0pOwoKICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAqCiAgICogQmV3YXJlIHRoYXQgY2hhbmdpbmcgYW4gYWxsb3dhbmNlIHdpdGggdGhpcyBtZXRob2QgYnJpbmdzIHRoZSByaXNrIHRoYXQgc29tZW9uZSBtYXkgdXNlIGJvdGggdGhlIG9sZAogICAqIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZSB0cmFuc2FjdGlvbiBvcmRlcmluZy4gT25lIHBvc3NpYmxlIHNvbHV0aW9uIHRvIG1pdGlnYXRlIHRoaXMKICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KCiAgLyoqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgfSBlbHNlIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKfQoKLyoqCiAqIEB0aXRsZSBCdXJuYWJsZSBUb2tlbgogKiBAZGV2IFRva2VuIHRoYXQgY2FuIGJlIGlycmV2ZXJzaWJseSBidXJuZWQgKGRlc3Ryb3llZCkuCiAqLwpjb250cmFjdCBCdXJuYWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4gewoKICAgIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IEJVUk5fQUREUkVTUyA9IDA7CgogICAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgYnVybmVyLCB1aW50MjU2IHZhbHVlKTsKCgkKCWZ1bmN0aW9uIGJ1cm5Ub2tlbnNJbnRlcm5hbChhZGRyZXNzIF9hZGRyZXNzLCB1aW50MjU2IF92YWx1ZSkgaW50ZXJuYWwgewogICAgICAgIHJlcXVpcmUoX3ZhbHVlID4gMCk7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2FkZHJlc3NdKTsKICAgICAgICAvLyBubyBuZWVkIHRvIHJlcXVpcmUgdmFsdWUgPD0gdG90YWxTdXBwbHksIHNpbmNlIHRoYXQgd291bGQgaW1wbHkgdGhlCiAgICAgICAgLy8gc2VuZGVyJ3MgYmFsYW5jZSBpcyBncmVhdGVyIHRoYW4gdGhlIHRvdGFsU3VwcGx5LCB3aGljaCAqc2hvdWxkKiBiZSBhbiBhc3NlcnRpb24gZmFpbHVyZQoKICAgICAgICBhZGRyZXNzIGJ1cm5lciA9IF9hZGRyZXNzOwogICAgICAgIGJhbGFuY2VzW2J1cm5lcl0gPSBiYWxhbmNlc1tidXJuZXJdLnN1YihfdmFsdWUpOwogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuc3ViKF92YWx1ZSk7CiAgICAgICAgQnVybihidXJuZXIsIF92YWx1ZSk7CgkJVHJhbnNmZXIoYnVybmVyLCBCVVJOX0FERFJFU1MsIF92YWx1ZSk7CgkJCgl9CgkJCn0KCi8qKgogKiBAdGl0bGUgSGFuZGVsaW9uIFRva2VuCiAqIEBkZXYgTWFpbiB0b2tlbiB1c2VkIGZvciBIYW5kZWxpb24gY3Jvd2RzYWxlCiAqLwogY29udHJhY3QgSElPTlRva2VuIGlzIEJ1cm5hYmxlVG9rZW4sIE93bmFibGUKIHsKCQoJLyoqIEhhbmRlbGlvbiB0b2tlbiBuYW1lIG9mZmljaWFsIG5hbWUuICovCglzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiSElPTiBUb2tlbiBieSBIYW5kZWxpb24iOyAKCSAKCSAvKiogSGFuZGVsaW9uIHRva2VuIG9mZmljaWFsIHN5bWJvbC4qLwoJc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiSElPTiI7IAoKCS8qKiBOdW1iZXIgb2YgZGVjaW1hbCB1bml0cyBmb3IgSGFuZGVsaW9uIHRva2VuICovCgl1aW50MjU2IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwoKCS8qIFByZWlzc3VlZCB0b2tlbiBhbW91bnQgKi8KCXVpbnQyNTYgcHVibGljIGNvbnN0YW50IFBSRUlTU1VFRF9BTU9VTlQgPSAyOTc1MDAwMCAqIDEgZXRoZXI7CgkJCQoJLyoqIAoJICogSW5kaWNhdGVzIHdoZWF0aGVyIHRva2VuIHRyYW5zZmVyIGlzIGFsbG93ZWQuIFRva2VuIHRyYW5zZmVyIGlzIGFsbG93ZWQgYWZ0ZXIgY3Jvd2RzYWxlIGlzIG92ZXIuIAoJICogQmVmb3JlIGNyb3dkc2FsZSBpcyBvdmVyIG9ubHkgdG9rZW4gb3duZXIgaXMgYWxsb3dlZCB0byB0cmFuc2ZlciB0b2tlbnMgdG8gaW52ZXN0b3JzLgoJICovCglib29sIHB1YmxpYyB0cmFuc2ZlckFsbG93ZWQgPSBmYWxzZTsKCQkJCgkvKiogUmFpc2VzIHdoZW4gaW5pdGlhbCBhbW91bnQgb2YgdG9rZW5zIGlzIHByZWlzc3VlZCAqLwoJZXZlbnQgTG9nVG9rZW5QcmVpc3N1ZWQoYWRkcmVzcyBvd25lcmVBZGRyZXNzLCB1aW50MjU2IGFtb3VudCk7CgkKCQoJbW9kaWZpZXIgY2FuVHJhbnNmZXIoYWRkcmVzcyBzZW5kZXIpCgl7CgkJcmVxdWlyZSh0cmFuc2ZlckFsbG93ZWQgfHwgc2VuZGVyID09IG93bmVyKTsKCQkKCQlfOwoJfQoJCgkvKioKCSAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIEhhbmRlbGlvbiB0b2tlbgoJICovCglmdW5jdGlvbiBISU9OVG9rZW4oKQoJewoJCS8vIEFkZHJlc3Mgb2YgdG9rZW4gY3JlYXRvci4gVGhlIGNyZWF0b3Igb2YgdGhpcyB0b2tlbiBpcyBtYWpvciBob2xkZXIgb2YgYWxsIHByZWlzc3VlZCB0b2tlbnMgYmVmb3JlIGNyb3dkc2FsZSBzdGFydHMKCQlvd25lciA9IG1zZy5zZW5kZXI7CgkgCgkJLy8gU2VuZCBhbGwgcHJlLWNyZWF0ZWQgdG9rZW5zIHRvIHRva2VuIGNyZWF0b3IgYWRkcmVzcwoJCXRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKFBSRUlTU1VFRF9BTU9VTlQpOwoJCWJhbGFuY2VzW293bmVyXSA9IGJhbGFuY2VzW293bmVyXS5hZGQoUFJFSVNTVUVEX0FNT1VOVCk7CgkJCgkJTG9nVG9rZW5QcmVpc3N1ZWQob3duZXIsIFBSRUlTU1VFRF9BTU9VTlQpOwoJfQoJCgkvKioKCSAqIFJldHVybnMgVG9rZW4gY3JlYXRvciBhZGRyZXNzCgkgKi8KCWZ1bmN0aW9uIGdldENyZWF0b3JBZGRyZXNzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMoYWRkcmVzcyBjcmVhdG9yQWRkcmVzcykKCXsKCQlyZXR1cm4gb3duZXI7Cgl9CgkKCS8qKgoJICogR2V0cyB0b3RhbCBzdXBwbHkgb2YgSGFuZGVsaW9uIHRva2VuCgkgKi8KCWZ1bmN0aW9uIGdldFRvdGFsU3VwcGx5KCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludDI1NikKCXsKCQlyZXR1cm4gdG90YWxTdXBwbHk7Cgl9CgkKCS8qKgoJICogR2V0cyBudW1iZXIgb2YgcmVtYWluaW5nIHRva2VucwoJICovCglmdW5jdGlvbiBnZXRSZW1haW5pbmdUb2tlbnMoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KQoJewoJCXJldHVybiBiYWxhbmNlT2Yob3duZXIpOwoJfQkKCQoJLyoqCgkgKiBBbGxvd3MgdG9rZW4gdHJhbnNmZXIuIFNob3VsZCBiZSBjYWxsZWQgYWZ0ZXIgY3Jvd2RzYWxlIGlzIG92ZXIKCSAqLwoJZnVuY3Rpb24gYWxsb3dUcmFuc2ZlcigpIG9ubHlPd25lciBwdWJsaWMKCXsKCQl0cmFuc2ZlckFsbG93ZWQgPSB0cnVlOwoJfQoJCgkKCS8qKgoJICogT3ZlcnJpZGVzIHRyYW5zZmVyIGZ1bmN0aW9uIGJ5IGFkZGluZyBjaGVjayB3aGV0aGVyIHRyYW5zZmVyIGlzIGFsbHdlZAoJICovCglmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIGNhblRyYW5zZmVyKG1zZy5zZW5kZXIpIHB1YmxpYyByZXR1cm5zIChib29sKQkKCXsKCQlzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7Cgl9CgoJLyoqCgkgKiBPdmVycmlkZSB0cmFuc2ZlckZyb20gZnVuY3Rpb24gYW5kIGFkZHMgYSBjaGVjayB3aGV0aGVyIHRyYW5zZmVyIGlzIGFsbHdlZAoJICovCglmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBjYW5UcmFuc2ZlcihfZnJvbSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsJCgkJc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7Cgl9CgkKCS8qKgogICAgICogQGRldiBCdXJucyBhIHNwZWNpZmljIGFtb3VudCBvZiB0b2tlbnMuCiAgICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgYnVybmVkLgogICAgICovCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgewoJCWJ1cm5Ub2tlbnNJbnRlcm5hbChtc2cuc2VuZGVyLCBfdmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBCdXJucyBhIHNwZWNpZmljIGFtb3VudCBvZiB0b2tlbnMgZm9yIHNwZWNpZmljIGFkZHJlc3MuIENhbiBiZSBjYWxsZWQgb25seSBieSB0b2tlbiBvd25lci4KCSAqIEBwYXJhbSBfYWRkcmVzcyAKICAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbiB0byBiZSBidXJuZWQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJ1cm4oYWRkcmVzcyBfYWRkcmVzcywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyBvbmx5T3duZXIgewoJCWJ1cm5Ub2tlbnNJbnRlcm5hbChfYWRkcmVzcywgX3ZhbHVlKTsKICAgIH0KfQoKLyoKICogU3RvcHBhYmxlCiAqCiAqIEFic3RyYWN0IGNvbnRyYWN0IHRoYXQgYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbgogKiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uCiAqCiAqCiAqLwpjb250cmFjdCBTdG9wcGFibGUgaXMgT3duYWJsZSB7CiAgYm9vbCBwdWJsaWMgc3RvcHBlZDsKCiAgbW9kaWZpZXIgc3RvcEluRW1lcmdlbmN5IHsKICAgIHJlcXVpcmUoIXN0b3BwZWQpOwogICAgXzsKICB9CgogIG1vZGlmaWVyIHN0b3BOb25Pd25lcnNJbkVtZXJnZW5jeSB7CiAgICByZXF1aXJlKCFzdG9wcGVkIHx8IG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgXzsKICB9CgogIG1vZGlmaWVyIG9ubHlJbkVtZXJnZW5jeSB7CiAgICByZXF1aXJlKHN0b3BwZWQpOwogICAgXzsKICB9CgogIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW1lcmdlbmN5LCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlCiAgZnVuY3Rpb24gc3RvcCgpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICBzdG9wcGVkID0gdHJ1ZTsKICB9CgogIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW5kIG9mIGVtZXJnZW5jeSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICBmdW5jdGlvbiB1bnN0b3AoKSBleHRlcm5hbCBvbmx5T3duZXIgb25seUluRW1lcmdlbmN5IHsKICAgIHN0b3BwZWQgPSBmYWxzZTsKICB9Cgp9CgovKioKICogQHRpdGxlIENyb3dkc2FsZQogKiBAZGV2IENyb3dkc2FsZSBpcyBhIGJhc2UgY29udHJhY3QgZm9yIG1hbmFnaW5nIGEgdG9rZW4gY3Jvd2RzYWxlLgogKiBDcm93ZHNhbGVzIGhhdmUgYSBzdGFydCBhbmQgZW5kIHRpbWVzdGFtcHMsIHdoZXJlIGludmVzdG9ycyBjYW4gbWFrZQogKiB0b2tlbiBwdXJjaGFzZXMgYW5kIHRoZSBjcm93ZHNhbGUgd2lsbCBhc3NpZ24gdGhlbSB0b2tlbnMgYmFzZWQKICogb24gYSB0b2tlbiBwZXIgRVRIIHJhdGUuIEZ1bmRzIGNvbGxlY3RlZCBhcmUgZm9yd2FyZGVkIHRvIGEgd2FsbGV0CiAqIGFzIHRoZXkgYXJyaXZlLgogKi8KY29udHJhY3QgQ3Jvd2RzYWxlIGlzIE93bmFibGUsIFN0b3BwYWJsZQp7CgkKCXVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKCS8qKiBpbmNsdXNpdmUgc3RhcnQgdGltZXN0YW1wcyBvZiBjcm93ZHNhbGUgKi8KCXVpbnQyNTYgcHVibGljIHN0YXJ0VGltZTsKCgkvKiogaW5jbHVzaXZlIGVuZCB0aW1lc3RhbXAgb2YgY3Jvd2Vkc2FsZSAqLwoJdWludDI1NiBwdWJsaWMgZW5kVGltZTsKCgkvKiogYWRkcmVzcyB3aGVyZSBmdW5kcyBhcmUgY29sbGVjdGVkICovCglhZGRyZXNzIHB1YmxpYyBtdWx0aXNpZ1dhbGxldDsKCgkvLyBob3cgbWFueSB0b2tlbiB1bml0cyBhIGJ1eWVyIGdldHMgcGVyIHdlaQoJdWludDI1NiBwdWJsaWMgcmF0ZTsKCgkvKiogbWluaW1hbCBhbW91bnQgb2Ygc29sZCB0b2tlbnMgZm9yIGNyb3dkc2FsZSB0byBiZSBjb25zaWRlcmVkIGFzIHN1Y2Nlc3NmdWwgKi8KCXVpbnQyNTYgcHVibGljIG1pbmltdW1Ub2tlbkFtb3VudDsKCgkvKiogbWF4aW1hbCBudW1iZXIgb2YgdG9rZW5zIHdlIGNhbiBzZWxsICovCgl1aW50MjU2IHB1YmxpYyBtYXhpbXVtVG9rZW5BbW91bnQ7CgoJLy8gYW1vdW50IG9mIHJhaXNlZCBtb25leSBpbiB3ZWkKCXVpbnQyNTYgcHVibGljIHdlaVJhaXNlZDsKCgkvKiogYW1vdW50IG9mIHNvbGQgdG9rZW5zICovCgl1aW50MjU2IHB1YmxpYyB0b2tlbnNTb2xkOwoKCS8qKiBudW1iZXIgb2YgdW5pcXVlIGludmVzdG9ycyAqLwoJdWludCBwdWJsaWMgaW52ZXN0b3JDb3VudDsKCgkvKiogSWRlbnRpZmllcyB3aGV0aGVyIGNyb3dkc2FsZSBoYXMgYmVlbiBmaW5hbGl6ZWQgKi8KCWJvb2wgcHVibGljIGZpbmFsaXplZDsKCgkvKiogSWRlbnRpZmllcyB3aGVhdGhlciByZWZ1bmQgaXMgb3BlbmVkICovCglib29sIHB1YmxpYyBpc1JlZnVuZGluZzsKCgkvKiogQW1vdW50IG9mIHJlY2VpdmVkIEVUSCBieSBpbnZlc3RvciAqLwoJbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgaW52ZXN0ZWRBbW91bnRPZjsKCgkvKiogQW1vdW50IG9mIHNlbGxlZCB0b2tlbnMgYnkgaW52ZXN0b3IgKi8KCW1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIHRva2VuQW1vdW50T2Y7CgoJLyoqCgkqIGV2ZW50IGZvciB0b2tlbiBwdXJjaGFzZSBsb2dnaW5nCgkqIEBwYXJhbSBwdXJjaGFzZXIgd2hvIHBhaWQgZm9yIHRoZSB0b2tlbnMKCSogQHBhcmFtIGJlbmVmaWNpYXJ5IHdobyBnb3QgdGhlIHRva2VucwoJKiBAcGFyYW0gdmFsdWUgd2VpcyBwYWlkIGZvciBwdXJjaGFzZQoJKiBAcGFyYW0gYW1vdW50IGFtb3VudCBvZiB0b2tlbnMgcHVyY2hhc2VkCgkqLwoJZXZlbnQgTG9nVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgdmFsdWUsIHVpbnQyNTYgYW1vdW50KTsKCglldmVudCBMb2dDcm93ZHNhbGVTdGFydGVkKCk7CgoJZXZlbnQgTG9nQ3Jvd2RzYWxlRmluYWxpemVkKGJvb2wgaXNHb2FsUmVhY2hlZCk7CgoJZXZlbnQgTG9nUmVmdW5kaW5nT3BlbmVkKHVpbnQyNTYgcmVmdW5kQW1vdW50KTsKCglldmVudCBMb2dJbnZlc3RvclJlZnVuZGVkKGFkZHJlc3MgaW52ZXN0b3JBZGRyZXNzLCB1aW50MjU2IHJlZnVuZGVkQW1vdW50KTsKCgoJZnVuY3Rpb24gQ3Jvd2RzYWxlKHVpbnQyNTYgX3N0YXJ0VGltZSwgdWludDI1NiBfZW5kVGltZSwgdWludDI1NiBfcmF0ZSwgYWRkcmVzcyBfd2FsbGV0KSB7CgkJLy9yZXF1aXJlKF9zdGFydFRpbWUgPj0gbm93KTsKCQlyZXF1aXJlKF9lbmRUaW1lID49IF9zdGFydFRpbWUpOwoJCXJlcXVpcmUoX3JhdGUgPiAwKTsKCQlyZXF1aXJlKF93YWxsZXQgIT0gYWRkcmVzcygwKSk7CgoJCWNyZWF0ZVRva2VuQ29udHJhY3QoKTsKCQlzdGFydFRpbWUgPSBfc3RhcnRUaW1lOwoJCWVuZFRpbWUgPSBfZW5kVGltZTsKCQlyYXRlID0gX3JhdGU7CgkJbXVsdGlzaWdXYWxsZXQgPSBfd2FsbGV0OwoJCQoJfQoKCS8vIGNyZWF0ZXMgdGhlIHRva2VuIHRvIGJlIHNvbGQuCgkvLyBvdmVycmlkZSB0aGlzIG1ldGhvZCB0byBoYXZlIGNyb3dkc2FsZSBvZiBhIHNwZWNpZmljIHRva2VuLgoJZnVuY3Rpb24gY3JlYXRlVG9rZW5Db250cmFjdCgpIGludGVybmFsOwoKCS8qKgoJKiBQcmVhbG9jYXRlcyB0b2tlbnMgYmVmb3JlIGNyb3dkc2FsZSBzdGFydHMuCgkqIE92ZXJyaWRlIHRoaXMgZnVuY3Rpb24gdG8gcHJlYWxvY2F0ZSBmb3Igc3BlY2lmaWMgY3Jvd2RzYWxlCgkqLwoJZnVuY3Rpb24gcHJlYWxsb2NhdGVUb2tlbnMoKSBpbnRlcm5hbDsKCgoJLy8gZmFsbGJhY2sgZnVuY3Rpb24gY2FuIGJlIHVzZWQgdG8gYnV5IHRva2VucwoJZnVuY3Rpb24gKCkgcHVibGljIHBheWFibGUgewoJCWJ1eVRva2Vucyhtc2cuc2VuZGVyKTsKCX0KCgkvLyBsb3cgbGV2ZWwgdG9rZW4gcHVyY2hhc2UgZnVuY3Rpb24KCWZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwdWJsaWMgcGF5YWJsZSBzdG9wSW5FbWVyZ2VuY3kgCgl7CgkJcmVxdWlyZShiZW5lZmljaWFyeSAhPSBhZGRyZXNzKDApKTsKCQlyZXF1aXJlKHZhbGlkUHVyY2hhc2UoKSk7CgoJCXVpbnQyNTYgd2VpQW1vdW50ID0gbXNnLnZhbHVlOwoKCQkvLyBjYWxjdWxhdGUgdG9rZW4gYW1vdW50IHRvIGJlIGNyZWF0ZWQKCQkvL3VpbnQyNTYgdG9rZW5zID0gd2VpQW1vdW50Lm11bChyYXRlKTsKCQl1aW50MjU2IHRva2VucyA9IGNhbGN1bGF0ZVRva2VuQW1vdW50KHdlaUFtb3VudCk7CgoJCS8vIENoZWNrIHdoZXRoZXIgd2l0aGluIHRoaXMgdHRyYW5zYWN0aW9uIHdlIHdpbGwgbm90IG92ZXJmbG93IG1heGltdW0gdG9rZW4gYW1vdW50CgkJcmVxdWlyZSh0b2tlbnNTb2xkLmFkZCh0b2tlbnMpIDw9IG1heGltdW1Ub2tlbkFtb3VudCk7CgoJCS8vIHVwZGF0ZSBzdGF0ZQoJCXdlaVJhaXNlZCA9IHdlaVJhaXNlZC5hZGQod2VpQW1vdW50KTsKCQl0b2tlbnNTb2xkID0gdG9rZW5zU29sZC5hZGQodG9rZW5zKTsKCQlpbnZlc3RlZEFtb3VudE9mW2JlbmVmaWNpYXJ5XSA9IGludmVzdGVkQW1vdW50T2ZbYmVuZWZpY2lhcnldLmFkZCh3ZWlBbW91bnQpOwoJCXRva2VuQW1vdW50T2ZbYmVuZWZpY2lhcnldID0gdG9rZW5BbW91bnRPZltiZW5lZmljaWFyeV0uYWRkKHRva2Vucyk7CgoJCS8vIGZvcndhcmQgdG9rZW5zIHRvIHB1cmNoYXNlcgoJCWZvcndhcmRUb2tlbnMoYmVuZWZpY2lhcnksIHRva2Vucyk7CgoJCUxvZ1Rva2VuUHVyY2hhc2UobXNnLnNlbmRlciwgYmVuZWZpY2lhcnksIHdlaUFtb3VudCwgdG9rZW5zKTsKCgkJLy8gZm9yd2FyZCBFVEggdG8gbXVsdGlzaWcgd2FsbGV0CgkJZm9yd2FyZEZ1bmRzKCk7Cgl9CgoJLyoqCgkgKiBUaGlzIGZ1bmN0aW9uIGp1c3QgdHJhbnNmZXJzIHRva2VucyB0byBiZW5lZmljaWFyeSBhZGRyZXNzLiAKCSAqIEl0IHNob3VsZCBiZSB1c2VkIGZvciBjYXNlcyB3aGVuIGludmVzdG9yIGJ1eXMgdG9rZW5zIHVzaW5nIG90aGVyIGN1cnJlbmNpZXMKCSAqLwoJZnVuY3Rpb24gdHJhbnNmZXJUb2tlbnMoYWRkcmVzcyBiZW5lZmljaWFyeSwgdWludDI1NiBhbW91bnQpIHB1YmxpYyBvbmx5T3duZXIKCXsKCQlyZXF1aXJlKGJlbmVmaWNpYXJ5ICE9IGFkZHJlc3MoMCkpOwoJCXJlcXVpcmUoYW1vdW50ID4gMCk7CgoJCXVpbnQyNTYgd2VpQW1vdW50ID0gYW1vdW50ICogMSBldGhlcjsKCQkKCQl0b2tlbnNTb2xkID0gdG9rZW5zU29sZC5hZGQod2VpQW1vdW50KTsKCQl0b2tlbkFtb3VudE9mW2JlbmVmaWNpYXJ5XSA9IHRva2VuQW1vdW50T2ZbYmVuZWZpY2lhcnldLmFkZCh3ZWlBbW91bnQpOwoJCQoJCWZvcndhcmRUb2tlbnMoYmVuZWZpY2lhcnksIHdlaUFtb3VudCk7Cgl9CgkKCS8vIHNlbmQgZXRoZXIgdG8gdGhlIGZ1bmQgY29sbGVjdGlvbiB3YWxsZXQKCS8vIG92ZXJyaWRlIHRvIGNyZWF0ZSBjdXN0b20gZnVuZCBmb3J3YXJkaW5nIG1lY2hhbmlzbXMKCWZ1bmN0aW9uIGZvcndhcmRGdW5kcygpIGludGVybmFsIHsKCQltdWx0aXNpZ1dhbGxldC50cmFuc2Zlcihtc2cudmFsdWUpOwoJfQoKCgkvKioKCSogRm9yd2FyZHMgdG9rZW5zIHRvIHB1cmNoYXNlci4gCgkqIE92ZXJyaWRlIHRoaXMgZnVuY3Rpb24gdG8gc2VuZCBhcHByb3ByaWVhdGUgdG9rZW5zIGZvciBzcGVjaWZpYyBjcm93ZHNhbGUKCSovCglmdW5jdGlvbiBmb3J3YXJkVG9rZW5zKGFkZHJlc3MgX3B1cmNoYXNlciwgdWludDI1NiBfYW1vdW50KSBpbnRlcm5hbDsKCQoJCgkvKioKCSAqIENhbGN1bGF0ZXMgYW1vdW50IG9mIHRva2VucyBpbnZlc3RvciBpcyBidXlpbmcgYmFzZWQgb24gZnVuZHMKCSAqLwoJZnVuY3Rpb24gY2FsY3VsYXRlVG9rZW5BbW91bnQodWludDI1NiBfd2VpQW1vdW50KSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KTsKCgkvKioKCSogQ2xvc2VzIGNyb3dkc2FsZSBhbmQgY2hhbmdlcyBpdHMgc3RhdGUgdG8gRmluYWxpemVkLiAKCSogV2FybmluZyAtIHRoaXMgYWN0aW9uIGlzIHVuZG9hYmxlIQoJKi8KCWZ1bmN0aW9uIGZpbmFsaXplKCkgcHVibGljIG9ubHlPd25lcgoJewoJCWZpbmFsaXplZCA9IHRydWU7CgoJCWZpbmFsaXplSW50ZXJuYWwoKTsKCgkJTG9nQ3Jvd2RzYWxlRmluYWxpemVkKGdvYWxSZWFjaGVkKCkpOwoJfQoKCS8qKgoJKiBPdmVycmlkZSB0aGlzIGZ1bmN0aW9uIHRvIHBlcmZvcm0gYWRkaXRpb25hbCBhY3Rpb25zIG9uIGNyb3dkc2FsZSBmaW5hbGl6YXRpb24KCSoKCSovCglmdW5jdGlvbiBmaW5hbGl6ZUludGVybmFsKCkgaW50ZXJuYWw7CgoJLy8gQHJldHVybiB0cnVlIGlmIHRoZSB0cmFuc2FjdGlvbiBjYW4gYnV5IHRva2VucwoJZnVuY3Rpb24gdmFsaWRQdXJjaGFzZSgpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKCQlib29sIHdpdGhpblBlcmlvZCA9IG5vdyA+PSBzdGFydFRpbWUgJiYgbm93IDw9IGVuZFRpbWU7CgkJYm9vbCBub25aZXJvUHVyY2hhc2UgPSBtc2cudmFsdWUgIT0gMDsKCQlib29sIG5vdEZpbmFsaXplZCA9ICFmaW5hbGl6ZWQ7CgkJYm9vbCBtYXhDYXBOb3RSZWFjaGVkID0gdG9rZW5zU29sZCA8IG1heGltdW1Ub2tlbkFtb3VudDsKCgkJcmV0dXJuIHdpdGhpblBlcmlvZCAmJiBub25aZXJvUHVyY2hhc2UgJiYgbm90RmluYWxpemVkICYmIG1heENhcE5vdFJlYWNoZWQ7Cgl9CgoJZnVuY3Rpb24gZ29hbFJlYWNoZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkKCXsKCQlyZXR1cm4gdG9rZW5zU29sZCA+PSBtaW5pbXVtVG9rZW5BbW91bnQ7Cgl9CgoJLy8gQHJldHVybiB0cnVlIGlmIGNyb3dkc2FsZSBldmVudCBoYXMgZW5kZWQKCWZ1bmN0aW9uIGhhc0VuZGVkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKCQlyZXR1cm4gbm93ID4gZW5kVGltZTsKCX0KCgkvKioKCSogT3BlbnMgc21hcnQgY29udHJhY3QgZm9yIHJlZnVuZGluZwoJKi8KCWZ1bmN0aW9uIG9wZW5SZWZ1bmQoKSBwdWJsaWMgcGF5YWJsZSBvbmx5T3duZXIgCgl7CgkJLy8gQ2hlY2sgdGhhdCBhbW91bnQgb2YgZnVuZHMgdHJhbnNmZXJyZWQgZm9yIHJlZnVuZCBpcyBtb3JlIHRoYW4gMAoJCXJlcXVpcmUobXNnLnZhbHVlID4gMCk7CgoJCS8vIG1hcmsgcmVmdW5kaW5nIGFzIG9wZW5lZAoJCWlzUmVmdW5kaW5nID0gdHJ1ZTsgCgoJCS8vIHBlcmZvcm0gaW50ZXJuYWwgY3VzdG9tIGFjdGlvbnMKCQlvcGVuUmVmdW5kSW50ZXJuYWwoKTsKCgkJLy8gTG9nIHJlZnVuZCBldmVudAoJCUxvZ1JlZnVuZGluZ09wZW5lZChtc2cudmFsdWUpOwoJfQoKCS8qKgoJKiBpbXBsZW1lbnQgdGhpcyBmdW5jdGlvbiBpbiBhbmNlc3N0b3IgY2xhc3MgdG8gZXhlY3V0ZSBzcGVjaWZpYyBzbWFydCBjb250cmFjdCBhY3Rpb25zIG9uIG9wZW4gcmVmdW5kaW5nCgkqCgkqLwoJZnVuY3Rpb24gb3BlblJlZnVuZEludGVybmFsKCkgaW50ZXJuYWw7CiAgCgoJLyoqCgkgKiBSZXF1ZXN0cyByZWZ1bmQuIENhbiBiZSBjYWxsZWQgb25seSB3aGVuIGNvbnRyYWN0IGlzIG9wZW4gZm9yIHJlZnVuZGluZy4gCgkgKiBSZXR1cm5zIGludmVzdG9yIGZ1bmRzIGFuZCBidXJucyBoaXMgdG9rZW5zCgkgKi8KCWZ1bmN0aW9uIHJlcXVlc3RSZWZ1bmQoKSBwdWJsaWMKCXsKCQkvLyBjaGVjayBpZiByZWZ1bmRpbmcgaXMgb3BlbmVkCgkJcmVxdWlyZShpc1JlZnVuZGluZyk7CgoJCS8vIGNoZWNrIHRoYXQgYWRkcmVzcyBpcyB2YWxpZAoJCXJlcXVpcmUobXNnLnNlbmRlciAhPSBhZGRyZXNzKDApKTsKCgkJLy8gZ2V0IGludmVzdG9yIGludmVzdGVkIGFtb3VudCAKCQl1aW50MjU2IGludmVzdGVkQW1vdW50ID0gaW52ZXN0ZWRBbW91bnRPZlttc2cuc2VuZGVyXTsKCQkKCQl1aW50MjU2IHRva2VuQW1vdW50ID0gdG9rZW5BbW91bnRPZlttc2cuc2VuZGVyXTsKCQkgIAoJCS8vIGlmIGludmVzdGVkIGFtb3VudCBpcyAwIHRoZW4gdGhyb3cgZXJyb3IKCQlyZXF1aXJlKGludmVzdGVkQW1vdW50ID4gMCk7CgoJCS8vIGNoZWNrIGlmIHdlIGhhdmUgZW5vdWdoIGZ1bmRzIG9uIHNtYXJ0IGNvbnRyYWN0IHRvIHJlZnVuZCBpbnZlc3RvcgoJCXJlcXVpcmUodGhpcy5iYWxhbmNlID49IGludmVzdGVkQW1vdW50KTsKCgkJLy8gdXBkYXRlIGludmVzdG9yIGFtb3VudCAtIHJlc2V0IGl0IGl0cyBpbnZlc3RlZCBhbW91bnQgdG8gMAoJCWludmVzdGVkQW1vdW50T2ZbbXNnLnNlbmRlcl0gPSAwOwoKCQkvLyB1cGRhdGUgaW52ZXN0b3IgdG9rZW5zIC0gcmVzZXQgdG8gMAoJCXRva2VuQW1vdW50T2ZbbXNnLnNlbmRlcl0gPSAwOwoKCQkvLyBMb2cgZXZlbnQgdGhhdCBpbnZlc3RvciBoYXMgYmVlbiByZWZ1bmRlZAoJCUxvZ0ludmVzdG9yUmVmdW5kZWQobXNnLnNlbmRlciwgaW52ZXN0ZWRBbW91bnQpOwoKCQkvLyBidXJuIGludmVzdG9yIHRva2VucwoJCWJ1cm5Ub2tlbnNJbnRlcm5hbChtc2cuc2VuZGVyLCB0b2tlbkFtb3VudCk7CgkJCgkJLy8gZm9yd2FyZCBmdW5kcyB0byBpbnZlc3RvciBhZGRyZXNzCgkJbXNnLnNlbmRlci50cmFuc2ZlcihpbnZlc3RlZEFtb3VudCk7Cgl9CiAgCgkKCS8qKgoJICogQnVybnMgc3BlY2lmaWVkIGludmVzdG9yIHRva2VucwoJICovCglmdW5jdGlvbiBidXJuQWxsSW52ZXN0b3JUb2tlbnMoYWRkcmVzcyBfYWRkcmVzcykgcHVibGljIG9ubHlPd25lcgoJewoJCXJlcXVpcmUoX2FkZHJlc3MgIT0gYWRkcmVzcygwKSk7CgkJCgkJLy8gR2V0IGludmVzdG9yIHRva2VucwoJCXVpbnQyNTYgdG9rZW5BbW91bnQgPSB0b2tlbkFtb3VudE9mW19hZGRyZXNzXTsKCgkJaWYgKHRva2VuQW1vdW50ID4gMCkKCQl7CgkJCWJ1cm5Ub2tlbnNJbnRlcm5hbChfYWRkcmVzcywgdG9rZW5BbW91bnQpOwoJCX0KCX0KCgkvKioKCSAqIEJ1cm5zIHNwZWNpZmllZCBpbnZlc3RvciB0b2tlbnMKCSAqLwoJZnVuY3Rpb24gYnVybkludmVzdG9yVG9rZW5zKGFkZHJlc3MgX2FkZHJlc3MsIHVpbnQyNTYgYW1vdW50KSBwdWJsaWMgb25seU93bmVyCgl7CgkJcmVxdWlyZShfYWRkcmVzcyAhPSBhZGRyZXNzKDApKTsKCQkKCQlpZiAoYW1vdW50ID4gMCkKCQl7CgkJCWJ1cm5Ub2tlbnNJbnRlcm5hbChfYWRkcmVzcywgYW1vdW50ICogMSBldGhlcik7CgkJfQoJfQogIAoJLyoqCgkqIEltcGxlbWVudCB0aGlzIGZ1bmN0aW9uIGluIGFuY2VzdG9yIGNsYXNzZXMgdG8gcGVyZm9ybSB0b2tlbiBidXJuaW5nCgkqLwoJZnVuY3Rpb24gYnVyblRva2Vuc0ludGVybmFsKGFkZHJlc3MgX2FkZHJlc3MsIHVpbnQyNTYgdG9rZW5BbW91bnQpIGludGVybmFsOwoKCS8qKgoJKiBHZXRzIGN1cnJlbnQgY29udHJhY3QgYmFsYW5jZQoJKi8KCWZ1bmN0aW9uIGdldEJhbGFuY2UoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikKCXsKCSAgcmV0dXJuIHRoaXMuYmFsYW5jZTsKCX0KCQoJLyoqCgkgKiBNb3ZlcyBhbGwgZnVuZHMgZnJvbSBjb250cmFjdCB0byBvd25lcidzIHdhbGxldAoJICovCiAgCWZ1bmN0aW9uIHdpdGhkcmF3KCkgcHVibGljIG9ubHlPd25lcgoJewoJCXJlcXVpcmUodGhpcy5iYWxhbmNlID4gMCk7CgkJCgkJbXVsdGlzaWdXYWxsZXQudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKCX0gIAp9CgoKLyoqCiAqIEhhbmRlbGlvbiBJQ08gY3Jvd2RzYWxlLgogKiAKICovCmNvbnRyYWN0IEhhbmRlbGlvbkNyb3dkc2FsZSBpcyBDcm93ZHNhbGUKewoJc3RydWN0IEZ1bmRpbmdUaWVyIHsKCQl1aW50MjU2IGNhcDsKCQl1aW50MjU2IHJhdGU7Cgl9CgkKCS8qKiBhbW91bnQgb2YgdG9rZW5zIEhhbmRlbGlvbiBvd25lcnMgYXJlIGtlZXBpbmcgZm9yIHRoZW0gc2VsdmVzICovCgl1aW50MjU2IHB1YmxpYyBwcmVhbGxvY2F0ZWRUb2tlbkFtb3VudDsKCQoJLyoqIEhhbmRlbGlvbiB0b2tlbiB3ZSBhcmUgc2VsbGluZyBpbiB0aGlzIGNyb3dkc2FsZSAqLwoJSElPTlRva2VuIHB1YmxpYyB0b2tlbjsgCgkKCS8qKiBob3cgbWFueSB0b2tlbnMgZ29lcyB0byBjb250cmFjdCBvd25lcnMgZnJvbSBlYWNoIHRva2VuIHNlbnQgdG8gaW52ZXN0b3IgKi8KCXVpbnQyNTYgcHVibGljIG93bmVyRnJhY3Rpb247CgoJLyoqIFRva2VuIHByaWNlIHRpZXJzIGFuZCBjYXBzICovCglGdW5kaW5nVGllciBwdWJsaWMgdGllcjE7CgkKCUZ1bmRpbmdUaWVyIHB1YmxpYyB0aWVyMjsKCQoJRnVuZGluZ1RpZXIgcHVibGljIHRpZXIzOwoJCglGdW5kaW5nVGllciBwdWJsaWMgdGllcjQ7CgkKCUZ1bmRpbmdUaWVyIHB1YmxpYyB0aWVyNTsJCgkKCQoJLyoqCgkgKiBTdGFydCBkYXRlOiAwOC0xMi0yMDE3IDEyOjAwIEdNVAoJICogRW5kIGRhdGU6IDMxLTAzLTIwMTggMTI6MDAgR01UCgkgKi8KCWZ1bmN0aW9uIEhhbmRlbGlvbkNyb3dkc2FsZSgpIAoJCUNyb3dkc2FsZSgxNTEyNzM0NDAwLCAxNTIyNDk3NjAwLCAzMDAsICAweDdFMjNjRmEwNTBkMjNCOTcwNmEwNzFkRWQwQTYyZDMwQUU2QkI2YzgpIAoJewoJCW1pbmltdW1Ub2tlbkFtb3VudCA9IDUwMDAwMDAgKiAxIGV0aGVyOwoJCW1heGltdW1Ub2tlbkFtb3VudCA9IDI5NzUwMDAwICogMSBldGhlcjsKCQlwcmVhbGxvY2F0ZWRUb2tlbkFtb3VudCA9IDY1NjQ5MTIgKiAxIGV0aGVyOwoJCW93bmVyRnJhY3Rpb24gPSA0OwoKCQl0aWVyMSA9IEZ1bmRpbmdUaWVyKHtjYXA6IDIwODEzMzggKiAxIGV0aGVyLCByYXRlOiA0ODB9KTsKCQl0aWVyMiA9IEZ1bmRpbmdUaWVyKHtjYXA6IDI3NTAwMDAgKiAxIGV0aGVyLCByYXRlOiA0NjB9KTsKCQl0aWVyMyA9IEZ1bmRpbmdUaWVyKHtjYXA6IDUwMDAwMDAgKiAxIGV0aGVyLCByYXRlOiA0NDB9KTsKCQl0aWVyNCA9IEZ1bmRpbmdUaWVyKHtjYXA6IDUwMDAwMDAgKiAxIGV0aGVyLCByYXRlOiA0MjB9KTsKCQl0aWVyNSA9IEZ1bmRpbmdUaWVyKHtjYXA6IDgzNTM3NTAgKiAxIGV0aGVyLCByYXRlOiA0MDB9KTsKCQlwcmVhbGxvY2F0ZVRva2VucygpOwoKCQlmaW5hbGl6ZWQgPSBmYWxzZTsKCX0KCQoJIAoJLyoqCgkgKiBPdmVycmlkaW5nIGZ1bmN0aW9uIHRvIGNyZWF0ZSBIYW5kZWxpb25Ub2tlbgoJICovCglmdW5jdGlvbiBjcmVhdGVUb2tlbkNvbnRyYWN0KCkgaW50ZXJuYWwKCXsKCQl0b2tlbiA9IG5ldyBISU9OVG9rZW4oKTsKCX0KCQoJCgkvKioKCSAqIFByZWFsbG9jYXRlIHRva2VucyB0byBoYW5kZWxpb24gcGxhdGZvcm0gb3duZXJzICovCglmdW5jdGlvbiBwcmVhbGxvY2F0ZVRva2VucygpIGludGVybmFsIAoJewoJCXRva2Vuc1NvbGQgPSB0b2tlbnNTb2xkLmFkZChwcmVhbGxvY2F0ZWRUb2tlbkFtb3VudCk7CgkJCQkKCQlmb3J3YXJkVG9rZW5zKG11bHRpc2lnV2FsbGV0LCBwcmVhbGxvY2F0ZWRUb2tlbkFtb3VudCk7Cgl9CgkKCS8qKgoJICogRm9yd2FyZCBoYW5kZWxpb24gdG9rZW5zIHRvIHB1cmNoYXNldAoJICovCglmdW5jdGlvbiBmb3J3YXJkVG9rZW5zKGFkZHJlc3MgX3B1cmNoYXNlciwgdWludDI1NiBfYW1vdW50KSBpbnRlcm5hbAoJewoJCXRva2VuLnRyYW5zZmVyKF9wdXJjaGFzZXIsIF9hbW91bnQpOwoKCQkvKgoJCWlmIChfcHVyY2hhc2VyICE9IG11bHRpc2lnV2FsbGV0KQoJCXsKCQkJdWludDI1NiB0b2tlbnNUb093bmVycyA9IF9hbW91bnQuZGl2KG93bmVyRnJhY3Rpb24pOwoJCQkKCQkJdG9rZW4udHJhbnNmZXIobXVsdGlzaWdXYWxsZXQsIHRva2Vuc1RvT3duZXJzKTsKCQl9CgkJKi8KCX0KCglmdW5jdGlvbiBjYWxjdWxhdGVUaWVyVG9rZW5zKEZ1bmRpbmdUaWVyIF90aWVyLCB1aW50MjU2IF9hbW91bnQsIHVpbnQyNTYgX2N1cnJlbnRUb2tlbkFtb3VudCkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikKCXsKCQl1aW50MjU2IG1heFRpZXJUb2tlbnMgPSBfdGllci5jYXAuc3ViKF9jdXJyZW50VG9rZW5BbW91bnQpOwoKCQlpZiAobWF4VGllclRva2VucyA8PSAwKQoJCXsKCQkJcmV0dXJuIDA7CgkJfQoJCQkJCgkJdWludDI1NiB0b2tlbkNvdW50ID0gX2Ftb3VudC5tdWwoX3RpZXIucmF0ZSk7CgkJCQoJCWlmICh0b2tlbkNvdW50ID4gbWF4VGllclRva2VucykKCQl7CgkJCXRva2VuQ291bnQgPSBtYXhUaWVyVG9rZW5zOwoJCX0KCQkJCgkJcmV0dXJuIHRva2VuQ291bnQ7Cgl9CgkKCWZ1bmN0aW9uIGNhbGN1bGF0ZVRva2VuQW1vdW50KHVpbnQyNTYgX3dlaUFtb3VudCkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NikKCXsJCQoJCXVpbnQyNTYgblRva2VucyA9IHRva2Vuc1NvbGQ7CgkJdWludDI1NiByZW1haW5pbmdXZWkgPSBfd2VpQW1vdW50OwoJCXVpbnQyNTYgdGllclRva2VucyA9IDA7CgkJCgkJaWYgKG5Ub2tlbnMgPCB0aWVyMS5jYXApCgkJewkJCQoJCQl0aWVyVG9rZW5zID0gY2FsY3VsYXRlVGllclRva2Vucyh0aWVyMSwgcmVtYWluaW5nV2VpLCBuVG9rZW5zKTsKCQkJblRva2VucyA9IG5Ub2tlbnMuYWRkKHRpZXJUb2tlbnMpOwkJCgkJCXJlbWFpbmluZ1dlaSA9IHJlbWFpbmluZ1dlaS5zdWIodGllclRva2Vucy5kaXYodGllcjEucmF0ZSkpOwoJCX0KCQkKCQlpZiAocmVtYWluaW5nV2VpID4gMCAmJiBuVG9rZW5zIDwgdGllcjIuY2FwKQoJCXsKCQkJdGllclRva2VucyA9IGNhbGN1bGF0ZVRpZXJUb2tlbnModGllcjIsIHJlbWFpbmluZ1dlaSwgblRva2Vucyk7CgkJCW5Ub2tlbnMgPSBuVG9rZW5zLmFkZCh0aWVyVG9rZW5zKTsJCQkKCQkJcmVtYWluaW5nV2VpID0gcmVtYWluaW5nV2VpLnN1Yih0aWVyVG9rZW5zLmRpdih0aWVyMi5yYXRlKSk7CgkJfQoKCQlpZiAocmVtYWluaW5nV2VpID4gMCAmJiBuVG9rZW5zIDwgdGllcjMuY2FwKQoJCXsKCQkJdGllclRva2VucyA9IGNhbGN1bGF0ZVRpZXJUb2tlbnModGllcjMsIHJlbWFpbmluZ1dlaSwgblRva2Vucyk7CgkJCW5Ub2tlbnMgPSBuVG9rZW5zLmFkZCh0aWVyVG9rZW5zKTsJCQkKCQkJcmVtYWluaW5nV2VpID0gcmVtYWluaW5nV2VpLnN1Yih0aWVyVG9rZW5zLmRpdih0aWVyMy5yYXRlKSk7CgkJfQoKCQlpZiAocmVtYWluaW5nV2VpID4gMCAmJiBuVG9rZW5zIDwgdGllcjQuY2FwKQoJCXsKCQkJdGllclRva2VucyA9IGNhbGN1bGF0ZVRpZXJUb2tlbnModGllcjQsIHJlbWFpbmluZ1dlaSwgblRva2Vucyk7CgkJCW5Ub2tlbnMgPSBuVG9rZW5zLmFkZCh0aWVyVG9rZW5zKTsJCQkKCQkJcmVtYWluaW5nV2VpID0gcmVtYWluaW5nV2VpLnN1Yih0aWVyVG9rZW5zLmRpdih0aWVyNC5yYXRlKSk7CgkJfQoKCQlpZiAocmVtYWluaW5nV2VpID4gMCAmJiBuVG9rZW5zIDwgdGllcjUuY2FwKQoJCXsKCQkJdGllclRva2VucyA9IGNhbGN1bGF0ZVRpZXJUb2tlbnModGllcjUsIHJlbWFpbmluZ1dlaSwgblRva2Vucyk7CgkJCW5Ub2tlbnMgPSBuVG9rZW5zLmFkZCh0aWVyVG9rZW5zKTsJCQkKCQkJcmVtYWluaW5nV2VpID0gcmVtYWluaW5nV2VpLnN1Yih0aWVyVG9rZW5zLmRpdih0aWVyNS5yYXRlKSk7CgkJfQkJCgkJCgkJcmVxdWlyZShyZW1haW5pbmdXZWkgPT0gMCk7CgkJCgkJcmV0dXJuIG5Ub2tlbnMuc3ViKHRva2Vuc1NvbGQpOwoJfQoKCQoJLyoqCgkgKiBQZXJmb3JtIGFjdGlvbnMgb24gZmluYWxpemF0aW9uIC0gYWxsb3cgdG9rZW5zIHRyYW5zZmVyIAoJICovCglmdW5jdGlvbiBmaW5hbGl6ZUludGVybmFsKCkgaW50ZXJuYWwgb25seU93bmVyCgl7CgoJfQoJCgkvKioKCSAqIFBlcmZvcm1zIHNtYXJ0IGNvbnRyYWN0IGFkZGl0aW9uYWwgYWN0aW9ucyBvbiByZWZ1bmQgb3BlbmluZwoJICovCglmdW5jdGlvbiBvcGVuUmVmdW5kSW50ZXJuYWwoKSBpbnRlcm5hbCBvbmx5T3duZXIKCXsKCQoJfQoJCgkvKioKCSAqIEJ1cm5zIGFsbCBjYWxsZXIgdG9rZW5zCgkgKgoJICovCglmdW5jdGlvbiBidXJuVG9rZW5zSW50ZXJuYWwoYWRkcmVzcyBfYWRkcmVzcywgdWludDI1NiB0b2tlbkFtb3VudCkgaW50ZXJuYWwKCXsKCQlyZXF1aXJlKF9hZGRyZXNzICE9IGFkZHJlc3MoMCkpOwoJCQoJCXVpbnQyNTYgdG9rZW5zVG9CdXJuID0gdG9rZW5BbW91bnQ7CgkJdWludDI1NiBtYXhUb2tlbnMgPSB0b2tlbi5iYWxhbmNlT2YoX2FkZHJlc3MpOwoJCQoJCWlmICh0b2tlbnNUb0J1cm4gPiBtYXhUb2tlbnMpCgkJewoJCQl0b2tlbnNUb0J1cm4gPSBtYXhUb2tlbnM7CgkJfQoJCQoJCXRva2VuLmJ1cm4oX2FkZHJlc3MsIHRva2Vuc1RvQnVybik7Cgl9CgkKCQoJLyoqCgkgKiBHZXRzIHJlbWFpbmluZyB0b2tlbnMgb24gYSBjb250cmFjdAoJICovCglmdW5jdGlvbiBnZXRSZW1haW5pbmdUb2tlbnMoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KQoJewoJCXJldHVybiB0b2tlbi5nZXRSZW1haW5pbmdUb2tlbnMoKTsKCX0KCQoJLyoqCgkgKiBHZXRzIHRvdGFsIHN1cHBseSBvZiB0b2tlbnMKCSAqLwoJZnVuY3Rpb24gZ2V0VG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlcykKCXsKCQlyZXR1cm4gdG9rZW4uZ2V0VG90YWxTdXBwbHkoKTsKCX0KCQoJLyoqCgkgKiBHZXRzIGFtb3VudCBvZiB0b2tlbiBvZiBzcGVjaWZpYyBpbnZlc3RvcgoJICovCglmdW5jdGlvbiBnZXRUb2tlbkFtb3VudE9mKGFkZHJlc3MgaW52ZXN0b3IpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVzKQoJewoJCXJldHVybiB0b2tlbi5iYWxhbmNlT2YoaW52ZXN0b3IpOwoJfQoJCgkKCS8qKgoJICogQWxsb3cgdG9rZW4gdHJhbnNmZXIuIEJ5IGRlZmF1bHQgYW5kIGR1cmluZyBjcm93ZHNhbGUgdG9rZW5zIGFyZSBub24tdHJhbnNmZXJhYmxlLiAKCSAqIENhbGwgdGhlc2Ugb3BlcmF0aW9uIHdoZW4geW91IG5lZWQgdG8gYWxsb3cgdG9rZW4gdHJhbnNmZXIKCSAqLwoJZnVuY3Rpb24gYWxsb3dUb2tlblRyYW5zZmVyKCkgcHVibGljIG9ubHlPd25lcgoJewoJCXRva2VuLmFsbG93VHJhbnNmZXIoKTsJCQoJfQoJCgkvKioKCSAqIEJ1cm5zIHJlbWFpbmluZyB0b2tlbnMgd2hpY2ggYXJlIG5vdCBzb2xkIGR1cmluZyBjcm93ZHNhbGUKCSAqLwoJZnVuY3Rpb24gYnVyblJlbWFpbmluZ1Rva2VucygpIHB1YmxpYyBvbmx5T3duZXIKCXsKCQlidXJuVG9rZW5zSW50ZXJuYWwodGhpcywgZ2V0UmVtYWluaW5nVG9rZW5zKCkpOwoJfQoJCQp9'.
	

]
