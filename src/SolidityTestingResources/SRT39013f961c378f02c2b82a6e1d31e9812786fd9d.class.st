Class {
	#name : #SRT39013f961c378f02c2b82a6e1d31e9812786fd9d,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT39013f961c378f02c2b82a6e1d31e9812786fd9d >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuODsKCi8qKgpTTVNDb2luIGlzIGEgdG9rZW4gaW1wbGVtZW50YXRpb24gZm9yIFNwZWVkIE1pbmluZyBTZXJ2aWNlIChTTVMpIHByb2plY3QuCldlIGFyZSBhaW0gdG8gaXNzdWUgdGhlIFNNUyB0b2tlbnMgdG8gZ2l2ZSB0aGUgcHJpdmlsZWdlIHRvIHRoZSBjbG9zZWQgZ3JvdXAgb2YgaW52ZXN0b3JzLAphcyB0aGVuIHRoZXkgd2lsbCBiZSBhYmxlIHRvIHJlY2VpdmUgdGhlIGRldmlkZW5kcyBmcm9tIG91ciBtaW5pbmcgZmFybSBpbiBIb2trYWlkbyBhbmQgdGhlIG90aGVyIGNvdW50cmllcyBhcyB3ZWxsLgoKT3VyIGNsb3Vkc2FsZSBzdGFydHMgZnJvbSAyNyBPY3RvYmVyIDIwMTcsIDE0OjAwIChKU1QpIHdpdGggdGhlIGRpZmZlcmVudCBib251cyByYXRpbyBiYXNlZCBvbiB0aGUgbnVtYmVyIG9mIHRva2VuIGFuZCB0aGUgc2FsZSBwZXJpb2QuCgpTTVMgY29pbiB0ZWFtLApodHRwczovL3Ntc2NvaW4uanAKaHR0cHM6Ly9naXRodWIuY29tL1NwZWVkLU1pbmluZy9TTVNDb2luCmh0dHBzOi8vZXRoZXJzY2FuLmlvL2FkZHJlc3MvMHgzOTAxM2Y5NjFjMzc4ZjAyYzJiODJhNmUxZDMxZTk4MTI3ODZmZDlkCiAqLwoKbGlicmFyeSBTTVNMSUIgewogICAgLyoqCiAgICAgKiBEaXZpZGUgd2l0aCBzYWZldHkgY2hlY2sKICAgICAqLwogICAgZnVuY3Rpb24gc2FmZURpdih1aW50IGEsIHVpbnQgYikgcHVyZSBpbnRlcm5hbCByZXR1cm5zKHVpbnQpIHsKICAgICAgICAvL292ZXJmbG93IGNoZWNrOyBiIG11c3Qgbm90IGJlIDAKICAgICAgICBhc3NlcnQoYiA+IDApOwogICAgICAgIHVpbnQgYyA9IGEgLyBiOwogICAgICAgIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQp9Cgpjb250cmFjdCBFUkMyMCB7CiAgICAvLyBTdGFuZGFyZCBpbnRlcmZhY2UKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludDI1NiBfdG90YWxTdXBwbHkpOwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2IGJhbGFuY2UpOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludCB2YWx1ZSkgcHVibGljIHJldHVybnMoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQgdmFsdWUpIHB1YmxpYyByZXR1cm5zKGJvb2wgc3VjY2Vzcyk7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludCB2YWx1ZSkgcHVibGljIHJldHVybnMoYm9vbCBzdWNjZXNzKTsKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQgcmVtYWluaW5nKTsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQgdmFsdWUpOwogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludCB2YWx1ZSk7Cn0KCmNvbnRyYWN0IFNNU0NvaW4gaXMgRVJDMjAgewogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIlNwZWVkIE1pbmluZyBTZXJ2aWNlIjsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIlNNUyI7CiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDM7CgogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgVU5JVCA9IDEwICoqIGRlY2ltYWxzOwoKICAgIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5ID0gMDsgLy8gKGluaXRpYWwgd2l0aCAwKSwgdGFyZ2V0ZWQgMi45IE1pbGxpb24gU01TCgogICAgdWludCB0b2tlblNhbGVMb3QxID0gMTUwMDAwICogVU5JVDsKICAgIHVpbnQgcmVzZXJ2ZWRCb251c0xvdDEgPSA0NTAwMCAqIFVOSVQ7IC8vIDQ1LDAwMCB0b2tlbnMgYXJlIHRoZSBtYXhpbXVtIHBvc3NpYmxlIGJvbnVzIGZyb20gMzAlIG9mIDE1MCwwMDAgdG9rZW5zIGluIHRoZSBib251cyBwaGFzZQogICAgdWludCB0b2tlblNhbGVMb3QzWCA9IDUwMDAwICogVU5JVDsKCiAgICBzdHJ1Y3QgQm9udXNTdHJ1Y3QgewogICAgICAgIHVpbnQ4IHJhdGlvMTsKICAgICAgICB1aW50OCByYXRpbzI7CiAgICAgICAgdWludDggcmF0aW8zOwogICAgICAgIHVpbnQ4IHJhdGlvNDsKICAgIH0KICAgIEJvbnVzU3RydWN0IGJvbnVzUmF0aW87CgogICAgdWludCBwdWJsaWMgc2FsZUNvdW50ZXJUaGlzUGhhc2UgPSAwOwoKICAgIHVpbnQgcHVibGljIGxpbWl0ZWRTYWxlID0gMDsKCiAgICB1aW50IHB1YmxpYyBzZW50Qm9udXMgPSAwOwoKICAgIHVpbnQgcHVibGljIHNvbGRUb2tlbiA9IDA7CgogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIGJhbGFuY2VzOwoKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBtYXBwaW5nKGFkZHJlc3MgPT4gdWludCkpIGFsbG93ZWQ7CgogICAgYWRkcmVzc1tdIGFkZHJlc3NlczsKICAgIGFkZHJlc3NbXSBpbnZlc3RvckFkZHJlc3NlczsKCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYWRkcmVzcykgcHJpdmF0ZSB1c2VyU3RydWN0czsKCiAgICBhZGRyZXNzIG93bmVyOwoKICAgIGFkZHJlc3MgbWludCA9IGFkZHJlc3ModGhpcyk7ICAgLy8gQ29udHJhY3QgYWRkcmVzcyBhcyBhIG1pbnRlcgogICAgCiAgICBhZGRyZXNzIGdlbmVzaXMgPSAweDA7CgogICAgdWludDI1NiBwdWJsaWMgdG9rZW5QcmljZSA9IDAuOCBldGhlcjsKICAgIHVpbnQyNTYgcHVibGljIGZpcnN0TWVtYmVyc2hpcFB1cmNoYXNlID0gMC4xNiBldGhlcjsgICAvLyBXaGl0ZSBjYXJkIG1lbWJlcnNoaXAKCiAgICBldmVudCBMb2codWludCBlKTsKCiAgICBldmVudCBNZXNzYWdlKHN0cmluZyBtc2cpOwoKICAgIGV2ZW50IFRPS0VOKHN0cmluZyBlKTsKCiAgICBib29sIGljb09uU2FsZSA9IGZhbHNlOwoKICAgIGJvb2wgaWNvT25QYXVzZWQgPSBmYWxzZTsKCiAgICBib29sIHNwUGhhc2UgPSBmYWxzZTsKCiAgICB1aW50MjU2IHN0YXJ0RGF0ZTsKCiAgICB1aW50MjU2IGVuZERhdGU7CgogICAgdWludCBjdXJyZW50UGhhc2UgPSAwOwoKICAgIGJvb2wgbmVlZFRvRHJhaW4gPSBmYWxzZTsKCiAgICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIpIHsKICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgfQogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gU01TQ29pbigpIHB1YmxpYyB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEJvbnVzKHVpbnQ4IHJhdGlvMSwgdWludDggcmF0aW8yLCB1aW50OCByYXRpbzMsIHVpbnQ4IHJhdGlvNCkgcHJpdmF0ZSB7CiAgICAgICAgYm9udXNSYXRpby5yYXRpbzEgPSByYXRpbzE7CiAgICAgICAgYm9udXNSYXRpby5yYXRpbzIgPSByYXRpbzI7CiAgICAgICAgYm9udXNSYXRpby5yYXRpbzMgPSByYXRpbzM7CiAgICAgICAgYm9udXNSYXRpby5yYXRpbzQgPSByYXRpbzQ7CiAgICB9CgogICAgZnVuY3Rpb24gY2FsY0JvbnVzKHVpbnQyNTYgc2VuZGluZ1NNU1Rva2VuKSB2aWV3IHByaXZhdGUgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgLy8gQ2FsY3VsYXRpbmcgYm9udXMKICAgICAgICBpZiAoc2VuZGluZ1NNU1Rva2VuIDwgKDEwICogVU5JVCkpIHsgICAgICAgICAgICAvLyAwLTkKICAgICAgICAgICAgcmV0dXJuIChzZW5kaW5nU01TVG9rZW4gKiBib251c1JhdGlvLnJhdGlvMSkgLyAxMDA7CiAgICAgICAgfSBlbHNlIGlmIChzZW5kaW5nU01TVG9rZW4gPCAoNTAgKiBVTklUKSkgeyAgICAgLy8gMTAtNDkKICAgICAgICAgICAgcmV0dXJuIChzZW5kaW5nU01TVG9rZW4gKiBib251c1JhdGlvLnJhdGlvMikgLyAxMDA7CiAgICAgICAgfSBlbHNlIGlmIChzZW5kaW5nU01TVG9rZW4gPCAoMTAwICogVU5JVCkpIHsgICAgLy8gNTAtOTkKICAgICAgICAgICAgcmV0dXJuIChzZW5kaW5nU01TVG9rZW4gKiBib251c1JhdGlvLnJhdGlvMykgLyAxMDA7CiAgICAgICAgfSBlbHNlIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gMTAwKwogICAgICAgICAgICByZXR1cm4gKHNlbmRpbmdTTVNUb2tlbiAqIGJvbnVzUmF0aW8ucmF0aW80KSAvIDEwMDsKICAgICAgICB9CiAgICB9CgogICAgLy8gU2VsbGluZyBTTVMgdG9rZW4KICAgIGZ1bmN0aW9uICgpIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICB1aW50MjU2IHJlY2VpdmVkRVRIID0gMDsKICAgICAgICB1aW50MjU2IHJlY2VpdmVkRVRIVU5JVCA9IDA7CiAgICAgICAgdWludDI1NiBzZW5kaW5nU01TVG9rZW4gPSAwOwogICAgICAgIHVpbnQyNTYgc2VuZGluZ1NNU0JvbnVzID0gMDsKICAgICAgICBMb2cobXNnLnZhbHVlKTsKCiAgICAgICAgLy8gT25seSBmb3Igc2VsbGluZyB0byBpbnZlc3RvcnMKICAgICAgICBpZiAoaWNvT25TYWxlICYmICFpY29PblBhdXNlZCAmJiBtc2cuc2VuZGVyICE9IG93bmVyKSB7CiAgICAgICAgICAgIGlmIChub3cgPD0gZW5kRGF0ZSkgewogICAgICAgICAgICAgICAgLy8gQWxsIHRoZSBwaGFzZXMKICAgICAgICAgICAgICAgIExvZyhjdXJyZW50UGhhc2UpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICByZWNlaXZlZEVUSCA9IG1zZy52YWx1ZTsKICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBpbnZlc3RvciBhbHJlYWR5IGpvaW5lZCBhbmQgY29tcGxldGVkIG1lbWJlcnNoaXAgcGF5bWVudAogICAgICAgICAgICAgICAgLy8gSWYgYSBuZXcgaW52ZXN0b3IsIGNoZWNrIGlmIHRoZSBmaXJzdCBwdXJjaGFzZSBpcyBhdCBsZWFzdCBlcXVhbCB0byB0aGUgbWVtYmVyc2hpcCBwcmljZQogICAgICAgICAgICAgICAgaWYgKChjaGVja0FkZHJlc3MobXNnLnNlbmRlcikgJiYgY2hlY2tNaW5CYWxhbmNlKG1zZy5zZW5kZXIpKSB8fCBmaXJzdE1lbWJlcnNoaXBQdXJjaGFzZSA8PSByZWNlaXZlZEVUSCkgewogICAgICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0aW5nIFNNUwogICAgICAgICAgICAgICAgICAgIHJlY2VpdmVkRVRIVU5JVCA9IHJlY2VpdmVkRVRIICogVU5JVDsKICAgICAgICAgICAgICAgICAgICBzZW5kaW5nU01TVG9rZW4gPSBTTVNMSUIuc2FmZURpdihyZWNlaXZlZEVUSFVOSVQsIHRva2VuUHJpY2UpOwogICAgICAgICAgICAgICAgICAgIExvZyhzZW5kaW5nU01TVG9rZW4pOwoKICAgICAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGluZyBCb251cwogICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50UGhhc2UgPT0gMSB8fCBjdXJyZW50UGhhc2UgPT0gMiB8fCBjdXJyZW50UGhhc2UgPT0gMykgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBQaGFzZSAxLTMgd2l0aCBCb251cyAxCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRpbmdTTVNCb251cyA9IGNhbGNCb251cyhzZW5kaW5nU01TVG9rZW4pOwogICAgICAgICAgICAgICAgICAgICAgICBMb2coc2VuZGluZ1NNU0JvbnVzKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIC8vIEdpdmluZyBTTVMgKyBCb251cyAoaWYgYW55KQogICAgICAgICAgICAgICAgICAgIExvZyhzZW5kaW5nU01TVG9rZW4pOwogICAgICAgICAgICAgICAgICAgIGlmICghdHJhbnNmZXJUb2tlbnMobXNnLnNlbmRlciwgc2VuZGluZ1NNU1Rva2VuLCBzZW5kaW5nU01TQm9udXMpKQogICAgICAgICAgICAgICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy8gUmV2ZXJ0IGlmIHRvbyBmZXcgRVRIIGZvciB0aGUgZmlyc3QgcHVyY2hhc2UKICAgICAgICAgICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIFJldmVydCBmb3IgZW5kIHBoYXNlCiAgICAgICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIFJldmVydCBmb3IgSUNPIFBhdXNlZCwgU3RvcHBlZAogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CiAgICB9CgogICAgLy8gPT09PT09PT0gQm9udXMgUGVyaW9kIDEgPT09PT09PT0KICAgIC8vIC0tLSBCb251cyAtLS0KICAgIC8vIDAtOSBTTVMgLT4gNSUKICAgIC8vIDEwLTQ5IFNNUyAtPiAxMCUKICAgIC8vIDUwLTk5IFNNUyAtPiAyMCUKICAgIC8vIDEwMH4gU01TIC0+IDMwJQogICAgLy8gLS0tIFRpbWUgLS0tICgyIGRheXMgOSBob3VycyA1OSBtaW51dGVzIDU5IHNlY29uZHMgKQogICAgLy8gRnJvbSAyNyBPY3QgMjAxNywgMTQ6MDAgUE0gSlNUICgyNyBPY3QgMjAxNywgNTowMCBBTSBHTVQpCiAgICAvLyBUbyAgIDI5IE9jdCAyMDE3LCAyMzo1OSBQTSBKU1QgKDI5IE9jdCAyMDE3LCAxNDo1OSBQTSBHTVQpCiAgICBmdW5jdGlvbiBzdGFydDFCb251c1BlcmlvZDEoKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIC8vIFN1cHBseSBzZXR0aW5nIChvbmx5IG9uY2UpCiAgICAgICAgcmVxdWlyZShjdXJyZW50UGhhc2UgPT0gMCk7CgogICAgICAgIGJhbGFuY2VzW293bmVyXSA9IHRva2VuU2FsZUxvdDE7IC8vIFN0YXJ0IGJhbGFuY2UgZm9yIFNwZWVkTWluaW5nIENvLiwgTHRkLgogICAgICAgIGJhbGFuY2VzW2FkZHJlc3ModGhpcyldID0gdG9rZW5TYWxlTG90MTsgIC8vIFN0YXJ0IGJhbGFuY2UgZm9yIFNNU0NvaW4gKGZvciBpbnZlc3RvcnMpCiAgICAgICAgdG90YWxTdXBwbHkgPSBiYWxhbmNlc1tvd25lcl0gKyBiYWxhbmNlc1thZGRyZXNzKHRoaXMpXTsKICAgICAgICBzYWxlQ291bnRlclRoaXNQaGFzZSA9IDA7CiAgICAgICAgbGltaXRlZFNhbGUgPSB0b2tlblNhbGVMb3QxOwoKICAgICAgICAvLyBBZGQgb3duZXIgYWRkcmVzcyBpbnRvIHRoZSBsaXN0IGFzIHRoZSBmaXJzdCB3YWxsZXQgd2hvIG93biB0b2tlbihzKQogICAgICAgIGFkZEFkZHJlc3Mob3duZXIpOwoKICAgICAgICAvLyBTZW5kIG93bmVyIGFjY291bnQgdGhlIGluaXRpYWwgdG9rZW5zIChyYXRoZXIgdGhhbiBvbmx5IGEgY29udHJhY3QgYWRkcmVzcykKICAgICAgICBUcmFuc2ZlcihhZGRyZXNzKHRoaXMpLCBvd25lciwgYmFsYW5jZXNbb3duZXJdKTsKCiAgICAgICAgLy8gU2V0IGRyYWluaW5nIGlzIG5lZWRlZAogICAgICAgIG5lZWRUb0RyYWluID0gdHJ1ZTsKCiAgICAgICAgLy8gSUNPIHN0YWdlIGluaXQKICAgICAgICBpY29PblNhbGUgPSB0cnVlOwogICAgICAgIGljb09uUGF1c2VkID0gZmFsc2U7CiAgICAgICAgc3BQaGFzZSA9IGZhbHNlOwogICAgICAgIGN1cnJlbnRQaGFzZSA9IDE7CiAgICAgICAgc3RhcnREYXRlID0gYmxvY2sudGltZXN0YW1wOwogICAgICAgIGVuZERhdGUgPSBzdGFydERhdGUgKyAyIGRheXMgKyA5IGhvdXJzICsgNTkgbWludXRlcyArIDU5IHNlY29uZHM7CgogICAgICAgIC8vIEJvbnVzIHNldHRpbmcgCiAgICAgICAgc2V0Qm9udXMoNSwgMTAsIDIwLCAzMCk7CiAgICB9CgogICAgLy8gPT09PT09PT0gQm9udXMgUGVyaW9kIDIgPT09PT09PT0KICAgIC8vIC0tLSBCb251cyAtLS0KICAgIC8vIDAtOSBTTVMgLT4gMyUKICAgIC8vIDEwLTQ5IFNNUyAtPiA1JQogICAgLy8gNTAtOTkgU01TIC0+IDEwJQogICAgLy8gMTAwfiBTTVMgLT4gMTUlCiAgICAvLyAtLS0gVGltZSAtLS0gKDExIGRheXMgOSBob3VycyA1OSBtaW51dGVzIDU5IHNlY29uZHMpCiAgICAvLyBGcm9tIDMwIE9jdCAyMDE3LCAxNDowMCBQTSBKU1QgKDMwIE9jdCAyMDE3LCA1OjAwIEFNIEdNVCkKICAgIC8vIFRvICAgMTAgTm92IDIwMTcsIDIzOjU5IFBNIEpTVCAoMTAgTm92IDIwMTcsIDE0OjU5IFBNIEdNVCkKICAgIGZ1bmN0aW9uIHN0YXJ0MkJvbnVzUGVyaW9kMigpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgLy8gSUNPIHN0YWdlIGluaXQKICAgICAgICBpY29PblNhbGUgPSB0cnVlOwogICAgICAgIGljb09uUGF1c2VkID0gZmFsc2U7CiAgICAgICAgc3BQaGFzZSA9IGZhbHNlOwogICAgICAgIGN1cnJlbnRQaGFzZSA9IDI7CiAgICAgICAgc3RhcnREYXRlID0gYmxvY2sudGltZXN0YW1wOwogICAgICAgIGVuZERhdGUgPSBzdGFydERhdGUgKyAxMSBkYXlzICsgOSBob3VycyArIDU5IG1pbnV0ZXMgKyA1OSBzZWNvbmRzOwoKICAgICAgICAvLyBCb251cyBzZXR0aW5nIAogICAgICAgIHNldEJvbnVzKDMsIDUsIDEwLCAxNSk7CiAgICB9CgogICAgLy8gPT09PT09PT0gQm9udXMgUGVyaW9kIDMgPT09PT09PT0KICAgIC8vIC0tLSBCb251cyAtLS0KICAgIC8vIDAtOSBTTVMgLT4gMSUKICAgIC8vIDEwLTQ5IFNNUyAtPiAzJQogICAgLy8gNTAtOTkgU01TIC0+IDUlCiAgICAvLyAxMDB+IFNNUyAtPiA4JQogICAgLy8gLS0tIFRpbWUgLS0tICg1MCBkYXlzLCA1IGhvdXJzLCAxNCBtaW51dGVzIGFuZCA1OSBzZWNvbmRzKQogICAgLy8gRnJvbSAxMSBOb3YgMjAxNywgMTg6NDUgUE0gSlNUICgxMSBOb3YgMjAxNywgMDk6NDUgQU0gR01UKSAoaGFyZGZvcmsgbWFpbnRlbmFuY2UgMDA6MDAtMTg6NDUgSlNUKQogICAgLy8gVG8gICAzMSBEZWMgMjAxNywgMjM6NTkgUE0gSlNUICgzMSBEZWMgMjAxNywgMTQ6NTkgUE0gR01UKQogICAgZnVuY3Rpb24gc3RhcnQzQm9udXNQZXJpb2QzKCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICAvLyBJQ08gc3RhZ2UgaW5pdAogICAgICAgIGljb09uU2FsZSA9IHRydWU7CiAgICAgICAgaWNvT25QYXVzZWQgPSBmYWxzZTsKICAgICAgICBzcFBoYXNlID0gZmFsc2U7CiAgICAgICAgY3VycmVudFBoYXNlID0gMzsKICAgICAgICBzdGFydERhdGUgPSBibG9jay50aW1lc3RhbXA7CiAgICAgICAgZW5kRGF0ZSA9IHN0YXJ0RGF0ZSArIDUwIGRheXMgKyA1IGhvdXJzICsgMTQgbWludXRlcyArIDU5IHNlY29uZHM7CgogICAgICAgIC8vIEJvbnVzIHNldHRpbmcgCiAgICAgICAgc2V0Qm9udXMoMSwgMywgNSwgOCk7CiAgICB9CgogICAgLy8gPT09PT09PT0gTm9ybWFsIFBlcmlvZCAxICgyMDE4KSA9PT09PT09PQogICAgLy8gLS0tIFRpbWUgLS0tICgzMSBkYXlzKQogICAgLy8gRnJvbSAxIEphbiAyMDE4LCAwMDowMCBBTSBKU1QgKDMxIERlYyAyMDE3LCAxNTowMCBQTSBHTVQpCiAgICAvLyBUbyAgIDMxIEphbiAyMDE4LCAyMzo1OSBQTSBKU1QgKDMxIEphbiAyMDE4LCAxNDo1OSBQTSBHTVQpCiAgICBmdW5jdGlvbiBzdGFydDROb3JtYWxQZXJpb2QoKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIC8vIElDTyBzdGFnZSBpbml0CiAgICAgICAgaWNvT25TYWxlID0gdHJ1ZTsKICAgICAgICBpY29PblBhdXNlZCA9IGZhbHNlOwogICAgICAgIHNwUGhhc2UgPSBmYWxzZTsKICAgICAgICBjdXJyZW50UGhhc2UgPSA0OwogICAgICAgIHN0YXJ0RGF0ZSA9IGJsb2NrLnRpbWVzdGFtcDsKICAgICAgICBlbmREYXRlID0gc3RhcnREYXRlICsgMzEgZGF5czsKCiAgICAgICAgLy8gUmVzZXQgYm9udXMKICAgICAgICBzZXRCb251cygwLCAwLCAwLCAwKTsKICAgIH0KCiAgICAvLyA9PT09PT09PSBOb3JtYWwgUGVyaW9kIDIgKDIwMjApID09PT09PT09CiAgICAvLyAtLS0gQm9udXMgLS0tCiAgICAvLyAzWAogICAgLy8gLS0tIFRpbWUgLS0tICg3IGRheXMpCiAgICAvLyBGcm9tIDIgSmFuIDIwMjAsIDAwOjAwIEFNIEpTVCAoMSBKYW4gMjAyMCwgMTU6MDAgUE0gR01UKQogICAgLy8gVG8gICA4IEphbiAyMDIwLCAyMzo1OSBQTSBKU1QgKDggT2N0IDIwMjAsIDE0OjU5IFBNIEdNVCkKCiAgICAvLyA9PT09PT09PSBOb3JtYWwgUGVyaW9kIDMgKDIwMjUpID09PT09PT09CiAgICAvLyAtLS0gQm9udXMgLS0tCiAgICAvLyAzWAogICAgLy8gLS0tIFRpbWUgLS0tICg3IGRheXMpCiAgICAvLyBGcm9tIDIgSmFuIDIwMjUsIDAwOjAwIEFNIEpTVCAoMSBKYW4gMjAyNSwgMTU6MDAgUE0gR01UKQogICAgLy8gVG8gICA4IEphbiAyMDI1LCAyMzo1OSBQTSBKU1QgKDggT2N0IDIwMjUsIDE0OjU5IFBNIEdNVCkKICAgIGZ1bmN0aW9uIHN0YXJ0M1hQaGFzZSgpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgLy8gU3VwcGx5IHNldHRpbmcgKG9ubHkgYWZ0ZXIgcGhhc2UgNCBvciA1KQogICAgICAgIHJlcXVpcmUoY3VycmVudFBoYXNlID09IDQgfHwgY3VycmVudFBoYXNlID09IDUpOwogICAgICAgICAgICAKICAgICAgICAvLyBQbGVhc2UgZHJhaW4gU01TIGlmIGl0IHdhcyBub3QgZG9uZSB5ZXQKICAgICAgICByZXF1aXJlKCFuZWVkVG9EcmFpbik7CiAgICAgICAgICAgIAogICAgICAgIGJhbGFuY2VzW2FkZHJlc3ModGhpcyldID0gdG9rZW5TYWxlTG90M1g7CiAgICAgICAgdG90YWxTdXBwbHkgPSAzICogdG90YWxTdXBwbHk7CiAgICAgICAgdG90YWxTdXBwbHkgKz0gYmFsYW5jZXNbYWRkcmVzcyh0aGlzKV07CiAgICAgICAgc2FsZUNvdW50ZXJUaGlzUGhhc2UgPSAwOwogICAgICAgIGxpbWl0ZWRTYWxlID0gdG9rZW5TYWxlTG90M1g7CgogICAgICAgIC8vIEJvbnVzCiAgICAgICAgeDNUb2tlbigpOyAvLyAzWCBkaXN0cmlidXRpb25zIHRvIHRva2VuIGhvbGRlcnMKCiAgICAgICAgLy8gTWludCBuZXcgdG9rZW5zCiAgICAgICAgVHJhbnNmZXIobWludCwgYWRkcmVzcyh0aGlzKSwgYmFsYW5jZXNbYWRkcmVzcyh0aGlzKV0pOwogICAgICAgIAogICAgICAgIC8vIFNldCBkcmFpbmluZyBpcyBuZWVkZWQKICAgICAgICBuZWVkVG9EcmFpbiA9IHRydWU7CiAgICAgICAgCiAgICAgICAgLy8gSUNPIHN0YWdlIGluaXQKICAgICAgICBpY29PblNhbGUgPSB0cnVlOwogICAgICAgIGljb09uUGF1c2VkID0gZmFsc2U7CiAgICAgICAgc3BQaGFzZSA9IGZhbHNlOwogICAgICAgIGN1cnJlbnRQaGFzZSA9IDU7CiAgICAgICAgc3RhcnREYXRlID0gYmxvY2sudGltZXN0YW1wOwogICAgICAgIGVuZERhdGUgPSBzdGFydERhdGUgKyA3IGRheXM7CiAgICB9CgogICAgLy8gU2VsbGluZyBmcm9tIHRoZSBhdmFpbGFibGUgdG9rZW5zIChvbiBvd25lciB3YWxsZXQpIHRoYXQgd2UgY29sbGVjdGVkIGFmdGVyIGVhY2ggc2FsZSBlbmQKICAgIC8vIEFtb3VudCBpcyBpbmNsdWRpbmcgZnVsbCBkaWdpdAogICAgZnVuY3Rpb24gc3RhcnRNYW51YWxQZXJpb2QodWludCBfc2FsZVRva2VuKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIC8vIFN1cHBseSBzZXR0aW5nCgogICAgICAgIC8vIFJlcXVpcmUgZW5vdWdoIHRva2VuIGZyb20gb3duZXIgdG8gYmUgc29sZCBvbiBtYW51YWwgcGhhc2UgICAgICAgIAogICAgICAgIHJlcXVpcmUoYmFsYW5jZXNbb3duZXJdID49IF9zYWxlVG9rZW4pOwogICAgICAgIAogICAgICAgIC8vIFBsZWFzZSBkcmFpbiBTTVMgaWYgaXQgd2FzIG5vdCBkb25lIHlldAogICAgICAgIHJlcXVpcmUoIW5lZWRUb0RyYWluKTsKCiAgICAgICAgLy8gVHJhbnNmZXIgc2FsZSBhbW91bnQgdG8gU01TCiAgICAgICAgYmFsYW5jZXNbb3duZXJdIC09IF9zYWxlVG9rZW47CiAgICAgICAgYmFsYW5jZXNbYWRkcmVzcyh0aGlzKV0gKz0gX3NhbGVUb2tlbjsKICAgICAgICBzYWxlQ291bnRlclRoaXNQaGFzZSA9IDA7CiAgICAgICAgbGltaXRlZFNhbGUgPSBfc2FsZVRva2VuOwogICAgICAgIFRyYW5zZmVyKG93bmVyLCBhZGRyZXNzKHRoaXMpLCBfc2FsZVRva2VuKTsKICAgICAgICAKICAgICAgICAvLyBTZXQgZHJhaW5pbmcgaXMgbmVlZGVkCiAgICAgICAgbmVlZFRvRHJhaW4gPSB0cnVlOwogICAgICAgIAogICAgICAgIC8vIElDTyBzdGFnZSBpbml0CiAgICAgICAgaWNvT25TYWxlID0gdHJ1ZTsKICAgICAgICBpY29PblBhdXNlZCA9IGZhbHNlOwogICAgICAgIHNwUGhhc2UgPSB0cnVlOwogICAgICAgIHN0YXJ0RGF0ZSA9IGJsb2NrLnRpbWVzdGFtcDsKICAgICAgICBlbmREYXRlID0gc3RhcnREYXRlICsgNyBkYXlzOyAvLyBEZWZhdWx0IHJ1bm5pbmcgbWFudWFsIG1vZGUgZm9yIDcgZGF5cwogICAgfQoKICAgIGZ1bmN0aW9uIHgzVG9rZW4oKSBwcml2YXRlIHsKICAgICAgICAvLyBNdWx0aXBseSB0b2tlbiBieSAzIHRvIGFsbCB0aGUgY3VycmVudCBhZGRyZXNzZXMKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBhZGRyZXNzZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdWludCBjdXJyMVhCYWxhbmNlID0gYmFsYW5jZXNbYWRkcmVzc2VzW2ldXTsKICAgICAgICAgICAgLy8gSW4gdG90YWwgM1gsIHRoZW4gYWxzbyBjYWxjdWxhdGUgdmFsdWUgdG8gYmFsYW5jZXMKICAgICAgICAgICAgYmFsYW5jZXNbYWRkcmVzc2VzW2ldXSA9IDMgKiBjdXJyMVhCYWxhbmNlOwogICAgICAgICAgICAvLyBUcmFuc2ZlciAyWCBmcm9tIE1pbnQgdG8gYWRkIHdpdGggdGhlIGV4aXN0aW5nIDFYCiAgICAgICAgICAgIFRyYW5zZmVyKG1pbnQsIGFkZHJlc3Nlc1tpXSwgMiAqIGN1cnIxWEJhbGFuY2UpOwogICAgICAgICAgICAvLyBUbyBrZWVwIHRyYWNraW5nIGJvbnVzIGRpc3RyaWJ1dGlvbgogICAgICAgICAgICBzZW50Qm9udXMgKz0gKDIgKiBjdXJyMVhCYWxhbmNlKTsKICAgICAgICB9CiAgICB9CgogICAgLy8gQ2FsbGVkIGJ5IHRoZSBvd25lciwgdG8gZW5kIHRoZSBjdXJyZW50IHBoYXNlIGFuZCBtYXJrIGFzIGJ1cm5hYmxlCQkKICAgIGZ1bmN0aW9uIGVuZFBoYXNlKCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICBpY29PblNhbGUgPSBmYWxzZTsKICAgICAgICBpY29PblBhdXNlZCA9IHRydWU7CiAgICB9CgogICAgLy8gQ2FsbGVkIGJ5IHRoZSBvd25lciwgdG8gZW1lcmdlbmN5IHBhdXNlIHRoZSBjdXJyZW50IHBoYXNlCiAgICBmdW5jdGlvbiBwYXVzZVBoYXNlKCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICBpY29PblBhdXNlZCA9IHRydWU7CiAgICB9CgogICAgLy8gQ2FsbGVkIGJ5IHRoZSBvd25lciwgdG8gcmVzdW1lcyB0aGUgZW5kZWQvcGF1c2VkIHBoYXNlCiAgICBmdW5jdGlvbiByZXN1bWVQaGFzZSgpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgaWNvT25TYWxlID0gdHJ1ZTsKICAgICAgICBpY29PblBhdXNlZCA9IGZhbHNlOwogICAgfQoKICAgIC8vIENhbGxlZCBieSB0aGUgb3duZXIsIHRvIGV4dGVuZCBkZWFkbGluZSAodXN1YWxseSBmb3Igc3BlY2lhbCBwaGFzZSBtb2RlKQogICAgZnVuY3Rpb24gZXh0ZW5kMVdlZWsoKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIGVuZERhdGUgKz0gNyBkYXlzOwogICAgfQoKICAgIC8vIFN0YW5kYXJkIGludGVyZmFjZQogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2IF90b3RhbFN1cHBseSkgewogICAgICAgIHJldHVybiB0b3RhbFN1cHBseTsKICAgIH0KCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBzZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYgYmFsYW5jZSkgewogICAgICAgIHJldHVybiBiYWxhbmNlc1tzZW5kZXJdOwogICAgfQoKICAgIGZ1bmN0aW9uIHNvbGRUb2tlbigpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYgX3NvbGRUb2tlbikgewogICAgICAgIHJldHVybiBzb2xkVG9rZW47CiAgICB9CgogICAgZnVuY3Rpb24gc2VudEJvbnVzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludDI1NiBfc2VudEJvbnVzKSB7CiAgICAgICAgcmV0dXJuIHNlbnRCb251czsKICAgIH0KCiAgICBmdW5jdGlvbiBzYWxlQ291bnRlclRoaXNQaGFzZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYgX3NhbGVDb3VudGVyKSB7CiAgICAgICAgcmV0dXJuIHNhbGVDb3VudGVyVGhpc1BoYXNlOwogICAgfQoKICAgIC8vIFByaWNlIHNob3VsZCBiZSBlbnRlcmVkIGluIG11bHRpcGxlIG9mIDEwMDAwJ3MKICAgIC8vIEUuZy4gZm9yIC4wMDAxIGV0aGVyIGVudGVyIDEsIGZvciA1IGV0aGVyIHByaWNlIGVudGVyIDUwMDAwCiAgICBmdW5jdGlvbiBzZXRUb2tlblByaWNlKHVpbnQgZXRoUmF0ZSkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICB0b2tlblByaWNlID0gKGV0aFJhdGUgKiAxMCAqKiAxOCkgLyAxMDAwMDsgLy8gKENvbnZlcnQgdG8gZXRoZXIgdW5pdCB0aGVuIG1ha2UgNCBkZWNpbWFscyBmb3IgRVRIKQogICAgfQoKICAgIGZ1bmN0aW9uIHNldE1lbWJlcnNoaXBQcmljZSh1aW50IGV0aFJhdGUpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgZmlyc3RNZW1iZXJzaGlwUHVyY2hhc2UgPSAoZXRoUmF0ZSAqIDEwICoqIDE4KSAvIDEwMDAwOyAvLyAoQ29udmVydCB0byBldGhlciB1bml0IHRoZW4gbWFrZSA0IGRlY2ltYWxzIGZvciBFVEgpCiAgICB9CgogICAgLy8gVHJhbnNmZXIgdGhlIFNNUyBiYWxhbmNlIGZyb20gY2FsbGVyJ3Mgd2FsbGV0IGFkZHJlc3MgdG8gdGFyZ2V0J3Mgd2FsbGV0IGFkZHJlc3MKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyByZXR1cm5zKGJvb2wgc3VjY2VzcykgewogICAgICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfYW1vdW50ICYmIF9hbW91bnQgPiAwICYmIGJhbGFuY2VzW190b10gKyBfYW1vdW50ID4gYmFsYW5jZXNbX3RvXSkgewoKICAgICAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gLT0gX2Ftb3VudDsKICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfYW1vdW50OwogICAgICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF9hbW91bnQpOwoKICAgICAgICAgICAgLy8gQWRkIGRlc3RpbmF0aW9uIHdhbGxldCBhZGRyZXNzIHRvIHRoZSBsaXN0CiAgICAgICAgICAgIGFkZEFkZHJlc3MoX3RvKTsKCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9CgogICAgLy8gVHJhbnNmZXIgdGhlIFNNUyBiYWxhbmNlIGZyb20gc3BlY2lmaWMgd2FsbGV0IGFkZHJlc3MgdG8gdGFyZ2V0J3Mgd2FsbGV0IGFkZHJlc3MKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBwdWJsaWMgcmV0dXJucyhib29sIHN1Y2Nlc3MpIHsKICAgICAgICBpZiAoYmFsYW5jZXNbX2Zyb21dID49IF9hbW91bnQgJiYgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPj0gX2Ftb3VudCAmJiBfYW1vdW50ID4gMCAmJiBiYWxhbmNlc1tfdG9dICsgX2Ftb3VudCA+IGJhbGFuY2VzW190b10pIHsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBiYWxhbmNlc1tfZnJvbV0gLT0gX2Ftb3VudDsKICAgICAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gLT0gX2Ftb3VudDsKICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfYW1vdW50OwogICAgICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfYW1vdW50KTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBBbGxvdyBfc3BlbmRlciB0byB3aXRoZHJhdyBmcm9tIHlvdXIgYWNjb3VudCwgbXVsdGlwbGUgdGltZXMsIHVwIHRvIHRoZSBfdmFsdWUgYW1vdW50LgogICAgLy8gSWYgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgYWdhaW4gaXQgb3ZlcndyaXRlcyB0aGUgY3VycmVudCBhbGxvd2FuY2Ugd2l0aCBfdmFsdWUuCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIHJldHVybnMoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfYW1vdW50OwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfYW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBDaGVja2luZyBhbGxvd2FuY2UKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnModWludDI1NiByZW1haW5pbmcpIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KCiAgICAvLyBUcmFuc2ZlciB0aGUgU01TIGJhbGFuY2UgZnJvbSBTTVMncyBjb250cmFjdCBhZGRyZXNzIHRvIGFuIGludmVzdG9yJ3Mgd2FsbGV0IGFjY291bnQKICAgIGZ1bmN0aW9uIHRyYW5zZmVyVG9rZW5zKGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQsIHVpbnQyNTYgX2JvbnVzKSBwcml2YXRlIHJldHVybnMoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgaWYgKF9hbW91bnQgPiAwICYmIGJhbGFuY2VzW2FkZHJlc3ModGhpcyldID49IF9hbW91bnQgJiYgYmFsYW5jZXNbYWRkcmVzcyh0aGlzKV0gLSBfYW1vdW50ID49IDAgJiYgc29sZFRva2VuICsgX2Ftb3VudCA+IHNvbGRUb2tlbiAmJiBzYWxlQ291bnRlclRoaXNQaGFzZSArIF9hbW91bnQgPD0gbGltaXRlZFNhbGUgJiYgYmFsYW5jZXNbX3RvXSArIF9hbW91bnQgPiBiYWxhbmNlc1tfdG9dKSB7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBUcmFuc2ZlciB0b2tlbiBmcm9tIGNvbnRyYWN0IHRvIHRhcmdldAogICAgICAgICAgICBiYWxhbmNlc1thZGRyZXNzKHRoaXMpXSAtPSBfYW1vdW50OwogICAgICAgICAgICBzb2xkVG9rZW4gKz0gX2Ftb3VudDsKICAgICAgICAgICAgc2FsZUNvdW50ZXJUaGlzUGhhc2UgKz0gX2Ftb3VudDsKICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfYW1vdW50OwogICAgICAgICAgICBUcmFuc2ZlcihhZGRyZXNzKHRoaXMpLCBfdG8sIF9hbW91bnQpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gVHJhbnNmZXIgYm9udXMgdG9rZW4gZnJvbSBvd25lciB0byB0YXJnZXQKICAgICAgICAgICAgaWYgKGN1cnJlbnRQaGFzZSA8PSAzICYmIF9ib251cyA+IDAgJiYgYmFsYW5jZXNbb3duZXJdIC0gX2JvbnVzID49IDAgJiYgc2VudEJvbnVzICsgX2JvbnVzID4gc2VudEJvbnVzICYmIHNlbnRCb251cyArIF9ib251cyA8PSByZXNlcnZlZEJvbnVzTG90MSAmJiBiYWxhbmNlc1tfdG9dICsgX2JvbnVzID4gYmFsYW5jZXNbX3RvXSkgewoKICAgICAgICAgICAgICAgIC8vIFRyYW5zZmVyIHdpdGggYm9udXMKICAgICAgICAgICAgICAgIGJhbGFuY2VzW293bmVyXSAtPSBfYm9udXM7CiAgICAgICAgICAgICAgICBzZW50Qm9udXMgKz0gX2JvbnVzOwogICAgICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfYm9udXM7CiAgICAgICAgICAgICAgICBUcmFuc2Zlcihvd25lciwgX3RvLCBfYm9udXMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBBZGQgaW52ZXN0b3Igd2FsbGV0IGFkZHJlc3MgdG8gdGhlIGxpc3QKICAgICAgICAgICAgYWRkQWRkcmVzcyhfdG8pOwoKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBGdW5jdGlvbiB0byBnaXZlIHRva2VuIHRvIGludmVzdG9ycwogICAgLy8gV2lsbCBiZSB1c2VkIHRvIGluaXRpYWxpemUgdGhlIG51bWJlciBvZiB0b2tlbiBhbmQgbnVtYmVyIG9mIGJvbnVzIGFmdGVyIG1pZ3JhdGlvbgogICAgLy8gQWxzbyBpbnZlc3RvciBjYW4gYnV5IHRva2VuIGZyb20gdGhyaWRwYXJ0eSBjaGFubmVsIHRoZW4gb3duZXIgd2lsbCBydW4gdGhpcyBmdW5jdGlvbgogICAgLy8gQW1vdW50IGFuZCBib251cyBib3RoIGluY2x1ZGluZyBmdWxsIGRpZ2l0CiAgICBmdW5jdGlvbiBnaXZlQXdheXMoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCwgdWludDI1NiBfYm9udXMpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgLy8gQ2FsbGluZyBpbnRlcm5hbCB0cmFuc2ZlclRva2VucwogICAgICAgIGlmICghdHJhbnNmZXJUb2tlbnMoX3RvLCBfYW1vdW50LCBfYm9udXMpKQogICAgICAgICAgICByZXZlcnQoKTsKICAgIH0KCiAgICAvLyBUb2tlbiBib251cyByZXdhcmQgd2lsbCBiZSBnaXZlbiB0byBpbnZlc3RvciBvbiBlYWNoIHNhbGUgZW5kCiAgICAvLyBUaGlzIGJvbnVzIHBhcnQgd2lsbCBiZSB0cmFuc2ZlcnJlZCBmcm9tIHRoZSBjb21wYW55CiAgICAvLyBCb251cyB3aWxsIGJlIGdpdmVuIHRvIHRoZSBvbmUgd2hvIGhhcyBwYWlkIG1lbWJlcnNoaXAgKDAuMTYgRVRIIG9yIGhvbGRpbmcgbWluaW11bSBvZiAwLjIgU01TKQogICAgLy8gQW1vdW50IGlzIGluY2x1ZGluZyBmdWxsIGRpZ2l0CiAgICBmdW5jdGlvbiBnaXZlUmV3YXJkKHVpbnQyNTYgX2Ftb3VudCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICAvLyBDaGVja2luZyBpZiBhbW91bnQgaXMgYXZhaWxhYmxlIGFuZCBoYWQgc29sZCBzb21lIHRva2VuCiAgICAgICAgcmVxdWlyZShiYWxhbmNlc1tvd25lcl0gPj0gX2Ftb3VudCk7CgogICAgICAgIHVpbnQgdG90YWxJbnZlc3RvckhhbmQgPSAwOwogICAgICAgIC8vIC0tLS0tLS0tLS0tLSBTdW0gdXAgYWxsIGludmVzdG9yIHRva2VuCiAgICAgICAgZm9yICh1aW50IGlkeCA9IDA7IGlkeCA8IGludmVzdG9yQWRkcmVzc2VzLmxlbmd0aDsgaWR4KyspIHsKICAgICAgICAgICAgaWYgKGNoZWNrTWluQmFsYW5jZShpbnZlc3RvckFkZHJlc3Nlc1tpZHhdKSkKICAgICAgICAgICAgICAgIHRvdGFsSW52ZXN0b3JIYW5kICs9IGJhbGFuY2VzW2ludmVzdG9yQWRkcmVzc2VzW2lkeF1dOwogICAgICAgIH0KICAgICAgICB1aW50IHZhbHVlUGVyVG9rZW4gPSBfYW1vdW50ICogVU5JVCAvIHRvdGFsSW52ZXN0b3JIYW5kOwoKICAgICAgICAvLyAtLS0tLS0tLS0tLS0gR2l2aW5nIFJld2FyZCAtLS0tLS0tLS0tLS0KICAgICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGludmVzdG9yQWRkcmVzc2VzLmxlbmd0aDsgaWR4KyspIHsKICAgICAgICAgICAgaWYgKGNoZWNrTWluQmFsYW5jZShpbnZlc3RvckFkZHJlc3Nlc1tpZHhdKSkgewogICAgICAgICAgICAgICAgdWludCBib251c0ZvclRoaXNJbnZlc3RvciA9IGJhbGFuY2VzW2ludmVzdG9yQWRkcmVzc2VzW2lkeF1dICogdmFsdWVQZXJUb2tlbiAvIFVOSVQ7CiAgICAgICAgICAgICAgICBzZW50Qm9udXMgKz0gYm9udXNGb3JUaGlzSW52ZXN0b3I7CiAgICAgICAgICAgICAgICBiYWxhbmNlc1tvd25lcl0gLT0gYm9udXNGb3JUaGlzSW52ZXN0b3I7CiAgICAgICAgICAgICAgICBiYWxhbmNlc1tpbnZlc3RvckFkZHJlc3Nlc1tpZHhdXSArPSBib251c0ZvclRoaXNJbnZlc3RvcjsKICAgICAgICAgICAgICAgIFRyYW5zZmVyKG93bmVyLCBpbnZlc3RvckFkZHJlc3Nlc1tpZHhdLCBib251c0ZvclRoaXNJbnZlc3Rvcik7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLy8gQ2hlY2sgd2FsbGV0IGFkZHJlc3MgaWYgZXhpc3QKICAgIGZ1bmN0aW9uIGNoZWNrQWRkcmVzcyhhZGRyZXNzIF9hZGRyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyhib29sIGV4aXN0KSB7CiAgICAgICAgcmV0dXJuIHVzZXJTdHJ1Y3RzW19hZGRyXSA9PSBfYWRkcjsKICAgIH0KCiAgICAvLyBDaGVjayBpZiBtaW5CYWxhbmNlIGlzIGVub3VnaAogICAgZnVuY3Rpb24gY2hlY2tNaW5CYWxhbmNlKGFkZHJlc3MgX2FkZHIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKGJvb2wgZW5vdWdoKSB7CiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19hZGRyXSA+PSAoZmlyc3RNZW1iZXJzaGlwUHVyY2hhc2UgKiAxMDAwMCAvIHRva2VuUHJpY2UgKiBVTklUIC8gMTAwMDApOwogICAgfQogICAgCiAgICAvLyBBZGQgd2FsbGV0IGFkZHJlc3Mgd2l0aCBleGlzdGluZyBjaGVjawogICAgZnVuY3Rpb24gYWRkQWRkcmVzcyhhZGRyZXNzIF90bykgcHJpdmF0ZSB7CiAgICAgICAgaWYgKGFkZHJlc3Nlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGlmICh1c2VyU3RydWN0c1tfdG9dICE9IF90bykgewogICAgICAgICAgICAgICAgdXNlclN0cnVjdHNbX3RvXSA9IF90bzsKICAgICAgICAgICAgICAgIC8vIEFkZGluZyBhbGwgYWRkcmVzc2VzCiAgICAgICAgICAgICAgICBhZGRyZXNzZXMucHVzaChfdG8pOwogICAgICAgICAgICAgICAgLy8gQWRkaW5nIGludmVzdG9yIGFkZHJlc3NlcwogICAgICAgICAgICAgICAgaWYgKF90byAhPSBhZGRyZXNzKHRoaXMpICYmIF90byAhPSBvd25lcikKICAgICAgICAgICAgICAgICAgICBpbnZlc3RvckFkZHJlc3Nlcy5wdXNoKF90byk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB1c2VyU3RydWN0c1tfdG9dID0gX3RvOwogICAgICAgICAgICAvLyBBZGRpbmcgYWxsIGFkZHJlc3NlcwogICAgICAgICAgICBhZGRyZXNzZXMucHVzaChfdG8pOwogICAgICAgICAgICAvLyBBZGRpbmcgaW52ZXN0b3IgYWRkcmVzc2VzCiAgICAgICAgICAgIGlmIChfdG8gIT0gYWRkcmVzcyh0aGlzKSAmJiBfdG8gIT0gb3duZXIpCiAgICAgICAgICAgICAgICBpbnZlc3RvckFkZHJlc3Nlcy5wdXNoKF90byk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIERyYWluIGFsbCB0aGUgYXZhaWxhYmxlIEVUSCBmcm9tIHRoZSBjb250cmFjdCBiYWNrIHRvIG93bmVyJ3Mgd2FsbGV0CiAgICBmdW5jdGlvbiBkcmFpbkVUSCgpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgb3duZXIudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsKICAgIH0KCiAgICAvLyBEcmFpbiBhbGwgdGhlIGF2YWlsYWJsZSBTTVMgZnJvbSB0aGUgY29udHJhY3QgYmFjayB0byBvd25lcidzIHdhbGxldAogICAgLy8gVGhpcyB3aWxsIGRyYWluIG9ubHkgdGhlIGF2YWlsYWJsZSB0b2tlbiB1cCB0byB0aGUgY3VycmVudCBwaGFzZQogICAgZnVuY3Rpb24gZHJhaW5TTVMoKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgICAgIC8vIE9ubHkgYWxsb3dlZCB0byBiZSBleGVjdXRlZCBhZnRlciBlbmRQaGFzZQogICAgICAgIHJlcXVpcmUoIWljb09uU2FsZSk7CgogICAgICAgIC8vIEFsbG93IHRvIGRyYWluIFNNUyBhbmQgU01TIEJvbnVzIGJhY2sgdG8gb3duZXIgb25seSBvbiBQaGFzZSA0LCA1LCA2CiAgICAgICAgaWYgKGN1cnJlbnRQaGFzZSA+PSA0IHx8IHNwUGhhc2UpIHsKICAgICAgICAgICAgLy8gRHJhaW4gYWxsIGF2YWlsYWJsZSBTTVMKICAgICAgICAgICAgLy8gRnJvbSBTTVMgY29udHJhY3QKICAgICAgICAgICAgaWYgKGJhbGFuY2VzW2FkZHJlc3ModGhpcyldID4gMCkgewogICAgICAgICAgICAgICAgYmFsYW5jZXNbb3duZXJdICs9IGJhbGFuY2VzW2FkZHJlc3ModGhpcyldOwogICAgICAgICAgICAgICAgVHJhbnNmZXIoYWRkcmVzcyh0aGlzKSwgb3duZXIsIGJhbGFuY2VzW2FkZHJlc3ModGhpcyldKTsKICAgICAgICAgICAgICAgIGJhbGFuY2VzW2FkZHJlc3ModGhpcyldID0gMDsKCiAgICAgICAgICAgICAgICAvLyBDbGVhciBkcmFpbmluZyBzdGF0dXMKICAgICAgICAgICAgICAgIG5lZWRUb0RyYWluID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLy8gTWFudWFsIGJ1cm5pbmcgZnVuY3Rpb24KICAgIC8vIEZvcmNlIHRvIGJ1cm4gaXQgaW4gc29tZSBzaXR1YXRpb24KICAgIC8vIEFtb3VudCBpcyBpbmNsdWRpbmcgZGVjaW1hbCBwb2ludHMKICAgIGZ1bmN0aW9uIGhhcmRCdXJuU01TKGFkZHJlc3MgX2Zyb20sIHVpbnQgX2Ftb3VudCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICAvLyBCdXJuaW5nIGZyb20gc291cmNlIGFkZHJlc3MKICAgICAgICBpZiAoYmFsYW5jZXNbX2Zyb21dID4gMCkgewogICAgICAgICAgICBiYWxhbmNlc1tfZnJvbV0gLT0gX2Ftb3VudDsKICAgICAgICAgICAgdG90YWxTdXBwbHkgLT0gX2Ftb3VudDsKICAgICAgICAgICAgVHJhbnNmZXIoX2Zyb20sIGdlbmVzaXMsIF9hbW91bnQpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBGdW5jdGlvbiB1c2VkIGluIFJld2FyZCBjb250cmFjdCB0byBrbm93IGFkZHJlc3Mgb2YgdG9rZW4gaG9sZGVyCiAgICBmdW5jdGlvbiBnZXRBZGRyZXNzKHVpbnQgaSkgcHVibGljIGNvbnN0YW50IHJldHVybnMoYWRkcmVzcykgewogICAgICAgIHJldHVybiBhZGRyZXNzZXNbaV07CiAgICB9CgogICAgLy8gRnVuY3Rpb24gdXNlZCBpbiBSZXdhcmQgY29udHJhY3QgdG8gZ2V0IHRvIGtub3cgdGhlIGFkZHJlc3MgYXJyYXkgbGVuZ3RoCiAgICBmdW5jdGlvbiBnZXRBZGRyZXNzU2l6ZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsKICAgICAgICByZXR1cm4gYWRkcmVzc2VzLmxlbmd0aDsKICAgIH0KfQ=='.
	

]
