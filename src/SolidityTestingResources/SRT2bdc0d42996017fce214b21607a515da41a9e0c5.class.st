Class {
	#name : #SRT2bdc0d42996017fce214b21607a515da41a9e0c5,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT2bdc0d42996017fce214b21607a515da41a9e0c5 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7CmxpYnJhcnkgU2FmZU1hdGggewogIGZ1bmN0aW9uIG11bCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgdWludCBjID0gYSAqIGI7CiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQogIGZ1bmN0aW9uIGRpdih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgYXNzZXJ0KGIgPiAwKTsKICAgIHVpbnQgYyA9IGEgLyBiOwogICAgYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7CiAgICByZXR1cm4gYzsKICB9CiAgZnVuY3Rpb24gc3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CiAgZnVuY3Rpb24gYWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICB1aW50IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQogIGZ1bmN0aW9uIG1heDY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7CiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7CiAgfQogIGZ1bmN0aW9uIG1pbjY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7CiAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsKICB9CiAgZnVuY3Rpb24gbWF4MjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7CiAgfQogIGZ1bmN0aW9uIG1pbjI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7CiAgfQogIGZ1bmN0aW9uIGFzc2VydChib29sIGFzc2VydGlvbikgaW50ZXJuYWwgewogICAgaWYgKCFhc3NlcnRpb24pIHsKICAgICAgdGhyb3c7CiAgICB9CiAgfQp9CmNvbnRyYWN0IE93bmFibGUgewogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICBmdW5jdGlvbiBPd25hYmxlKCkgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KICAgIG1vZGlmaWVyIG9ubHlPd25lciB7CiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIpIHRocm93OwogICAgICAgIF87CiAgICB9CiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgewogICAgICAgIGlmIChuZXdPd25lciAhPSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICAgICAgfQogICAgfQp9Ci8qCiAqIFBhdXNhYmxlCiAqIEFic3RyYWN0IGNvbnRyYWN0IHRoYXQgYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbgogKiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uCiAqLwpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKICBib29sIHB1YmxpYyBzdG9wcGVkOwogIG1vZGlmaWVyIHN0b3BJbkVtZXJnZW5jeSB7CiAgICBpZiAoc3RvcHBlZCkgewogICAgICB0aHJvdzsKICAgIH0KICAgIF87CiAgfQogIAogIG1vZGlmaWVyIG9ubHlJbkVtZXJnZW5jeSB7CiAgICBpZiAoIXN0b3BwZWQpIHsKICAgICAgdGhyb3c7CiAgICB9CiAgICBfOwogIH0KICAvLyBjYWxsZWQgYnkgdGhlIG93bmVyIG9uIGVtZXJnZW5jeSwgdHJpZ2dlcnMgc3RvcHBlZCBzdGF0ZQogIGZ1bmN0aW9uIGVtZXJnZW5jeVN0b3AoKSBleHRlcm5hbCBvbmx5T3duZXIgewogICAgc3RvcHBlZCA9IHRydWU7CiAgfQogIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW5kIG9mIGVtZXJnZW5jeSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICBmdW5jdGlvbiByZWxlYXNlKCkgZXh0ZXJuYWwgb25seU93bmVyIG9ubHlJbkVtZXJnZW5jeSB7CiAgICBzdG9wcGVkID0gZmFsc2U7CiAgfQp9CmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgY29uc3RhbnQgcmV0dXJucyAodWludCk7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludCB2YWx1ZSk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSk7Cn0KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCk7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludCB2YWx1ZSk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQgdmFsdWUpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOwp9Ci8qCiAqIFB1bGxQYXltZW50CiAqIEJhc2UgY29udHJhY3Qgc3VwcG9ydGluZyBhc3luYyBzZW5kIGZvciBwdWxsIHBheW1lbnRzLgogKiBJbmhlcml0IGZyb20gdGhpcyBjb250cmFjdCBhbmQgdXNlIGFzeW5jU2VuZCBpbnN0ZWFkIG9mIHNlbmQuCiAqLwpjb250cmFjdCBQdWxsUGF5bWVudCB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CiAgCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBwYXltZW50czsKICBldmVudCBMb2dSZWZ1bmRFVEgoYWRkcmVzcyB0bywgdWludCB2YWx1ZSk7CiAgLyoqCiAgKiAgU3RvcmUgc2VudCBhbW91bnQgYXMgY3JlZGl0IHRvIGJlIHB1bGxlZCwgY2FsbGVkIGJ5IHBheWVyIAogICoqLwogIGZ1bmN0aW9uIGFzeW5jU2VuZChhZGRyZXNzIGRlc3QsIHVpbnQgYW1vdW50KSBpbnRlcm5hbCB7CiAgICBwYXltZW50c1tkZXN0XSA9IHBheW1lbnRzW2Rlc3RdLmFkZChhbW91bnQpOwogIH0KICAvLyB3aXRoZHJhdyBhY2N1bXVsYXRlZCBiYWxhbmNlLCBjYWxsZWQgYnkgcGF5ZWUKICBmdW5jdGlvbiB3aXRoZHJhd1BheW1lbnRzKCkgewogICAgYWRkcmVzcyBwYXllZSA9IG1zZy5zZW5kZXI7CiAgICB1aW50IHBheW1lbnQgPSBwYXltZW50c1twYXllZV07CiAgICAKICAgIGlmIChwYXltZW50ID09IDApIHsKICAgICAgdGhyb3c7CiAgICB9CiAgICBpZiAodGhpcy5iYWxhbmNlIDwgcGF5bWVudCkgewogICAgICB0aHJvdzsKICAgIH0KICAgIHBheW1lbnRzW3BheWVlXSA9IDA7CiAgICBpZiAoIXBheWVlLnNlbmQocGF5bWVudCkpIHsKICAgICAgdGhyb3c7CiAgICB9CiAgICBMb2dSZWZ1bmRFVEgocGF5ZWUscGF5bWVudCk7CiAgfQp9CmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgCiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CiAgCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIGJhbGFuY2VzOwogIAogIC8qCiAgICogRml4IGZvciB0aGUgRVJDMjAgc2hvcnQgYWRkcmVzcyBhdHRhY2sgIAogICovCiAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgc2l6ZSkgewogICAgIGlmKG1zZy5kYXRhLmxlbmd0aCA8IHNpemUgKyA0KSB7CiAgICAgICB0aHJvdzsKICAgICB9CiAgICAgXzsKICB9CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSB7CiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgfQogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cn0KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBCYXNpY1Rva2VuLCBFUkMyMCB7CiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpKSBhbGxvd2VkOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIG9ubHlQYXlsb2FkU2l6ZSgzICogMzIpIHsKICAgIHZhciBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07CiAgICAvLyBDaGVjayBpcyBub3QgbmVlZGVkIGJlY2F1c2Ugc3ViKF9hbGxvd2FuY2UsIF92YWx1ZSkgd2lsbCBhbHJlYWR5IHRocm93IGlmIHRoaXMgY29uZGl0aW9uIGlzIG5vdCBtZXQKICAgIC8vIGlmIChfdmFsdWUgPiBfYWxsb3dhbmNlKSB0aHJvdzsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBfYWxsb3dhbmNlLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICB9CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkgewogICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2AKICAgIC8vICBhbGxvd2FuY2UgdG8gemVybyBieSBjYWxsaW5nIGBhcHByb3ZlKF9zcGVuZGVyLCAwKWAgaWYgaXQgaXMgbm90CiAgICAvLyAgYWxyZWFkeSAwIHRvIG1pdGlnYXRlIHRoZSByYWNlIGNvbmRpdGlvbiBkZXNjcmliZWQgaGVyZToKICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgaWYgKChfdmFsdWUgIT0gMCkgJiYgKGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdICE9IDApKSB0aHJvdzsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgfQogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCByZW1haW5pbmcpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KfQovKioKICogIFNraW5Db2luIHRva2VuIGNvbnRyYWN0LiBJbXBsZW1lbnRzCiAqLwpjb250cmFjdCBTa2luQ29pbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiU2tpbkNvaW4iOwogIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIlNLSU4iOwogIHVpbnQgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gNjsKICAvLyBDb25zdHJ1Y3RvcgogIGZ1bmN0aW9uIFNraW5Db2luKCkgewogICAgICB0b3RhbFN1cHBseSA9IDEwMDAwMDAwMDAwMDAwMDA7CiAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gdG90YWxTdXBwbHk7IC8vIFNlbmQgYWxsIHRva2VucyB0byBvd25lcgogIH0KICAvKioKICAgKiAgQnVybiBhd2F5IHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIFNraW5Db2luIHRva2VucwogICAqLwogIGZ1bmN0aW9uIGJ1cm4odWludCBfdmFsdWUpIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIDB4MCwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KfQovKgogIENyb3dkc2FsZSBTbWFydCBDb250cmFjdCBmb3IgdGhlIHNraW5jb2luLm9yZyBwcm9qZWN0CiAgVGhpcyBzbWFydCBjb250cmFjdCBjb2xsZWN0cyBFVEgsIGFuZCBpbiByZXR1cm4gZW1pdHMgU2tpbkNvaW4gdG9rZW5zIHRvIHRoZSBiYWNrZXJzCiovCmNvbnRyYWN0IENyb3dkc2FsZSBpcyBQYXVzYWJsZSwgUHVsbFBheW1lbnQgewogICAgCiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKICAgIHN0cnVjdCBCYWNrZXIgewogICAgICAgIHVpbnQgd2VpUmVjZWl2ZWQ7IC8vIEFtb3VudCBvZiBFdGhlciBnaXZlbgogICAgICAgIHVpbnQgY29pblNlbnQ7CiAgICB9CiAgICAvKgogICAgKiBDb25zdGFudHMKICAgICovCiAgICAvKiBNaW5pbXVtIG51bWJlciBvZiBTa2luQ29pbiB0byBzZWxsICovCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBNSU5fQ0FQID0gMzAwMDAwMDAwMDAwMDA7IC8vIDMwLDAwMCwwMDAgU2tpbkNvaW5zCiAgICAvKiBNYXhpbXVtIG51bWJlciBvZiBTa2luQ29pbiB0byBzZWxsICovCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBNQVhfQ0FQID0gNjAwMDAwMDAwMDAwMDAwOyAvLyA2MDAsMDAwLDAwMCBTa2luQ29pbnMKICAgIC8qIE1pbmltdW0gYW1vdW50IHRvIGludmVzdCAqLwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgTUlOX0lOVkVTVF9FVEhFUiA9IDEwMCBmaW5uZXk7CiAgICAvKiBDcm93ZHNhbGUgcGVyaW9kICovCiAgICB1aW50IHByaXZhdGUgY29uc3RhbnQgQ1JPV0RTQUxFX1BFUklPRCA9IDMwIGRheXM7CiAgICAvKiBOdW1iZXIgb2YgU2tpbkNvaW5zIHBlciBFdGhlciAqLwogICAgdWludCBwdWJsaWMgY29uc3RhbnQgQ09JTl9QRVJfRVRIRVIgPSA2MDAwMDAwMDAwOyAvLyA2LDAwMCBTa2luQ29pbnMKICAgIC8qCiAgICAqIFZhcmlhYmxlcwogICAgKi8KICAgIC8qIFNraW5Db2luIGNvbnRyYWN0IHJlZmVyZW5jZSAqLwogICAgU2tpbkNvaW4gcHVibGljIGNvaW47CiAgICAvKiBNdWx0aXNpZyBjb250cmFjdCB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgRXRoZXIgKi8KICAgIGFkZHJlc3MgcHVibGljIG11bHRpc2lnRXRoZXI7CiAgICAvKiBOdW1iZXIgb2YgRXRoZXIgcmVjZWl2ZWQgKi8KICAgIHVpbnQgcHVibGljIGV0aGVyUmVjZWl2ZWQ7CiAgICAvKiBOdW1iZXIgb2YgU2tpbkNvaW5zIHNlbnQgdG8gRXRoZXIgY29udHJpYnV0b3JzICovCiAgICB1aW50IHB1YmxpYyBjb2luU2VudFRvRXRoZXI7CiAgICAvKiBDcm93ZHNhbGUgc3RhcnQgdGltZSAqLwogICAgdWludCBwdWJsaWMgc3RhcnRUaW1lOwogICAgLyogQ3Jvd2RzYWxlIGVuZCB0aW1lICovCiAgICB1aW50IHB1YmxpYyBlbmRUaW1lOwogICAgLyogSXMgY3Jvd2RzYWxlIHN0aWxsIG9uIGdvaW5nICovCiAgICBib29sIHB1YmxpYyBjcm93ZHNhbGVDbG9zZWQ7CiAgICAvKiBCYWNrZXJzIEV0aGVyIGluZGV4ZWQgYnkgdGhlaXIgRXRoZXJldW0gYWRkcmVzcyAqLwogICAgbWFwcGluZyhhZGRyZXNzID0+IEJhY2tlcikgcHVibGljIGJhY2tlcnM7CiAgICAvKgogICAgKiBNb2RpZmllcnMKICAgICovCiAgICBtb2RpZmllciBtaW5DYXBOb3RSZWFjaGVkKCkgewogICAgICAgIGlmICgobm93IDwgZW5kVGltZSkgfHwgY29pblNlbnRUb0V0aGVyID49IE1JTl9DQVAgKSB0aHJvdzsKICAgICAgICBfOwogICAgfQogICAgbW9kaWZpZXIgcmVzcGVjdFRpbWVGcmFtZSgpIHsKICAgICAgICBpZiAoKG5vdyA8IHN0YXJ0VGltZSkgfHwgKG5vdyA+IGVuZFRpbWUgKSkgdGhyb3c7CiAgICAgICAgXzsKICAgIH0KICAgIC8qCiAgICAgKiBFdmVudAogICAgKi8KICAgIGV2ZW50IExvZ1JlY2VpdmVkRVRIKGFkZHJlc3MgYWRkciwgdWludCB2YWx1ZSk7CiAgICBldmVudCBMb2dDb2luc0VtaXRlZChhZGRyZXNzIGluZGV4ZWQgZnJvbSwgdWludCBhbW91bnQpOwogICAgLyoKICAgICAqIENvbnN0cnVjdG9yCiAgICAqLwogICAgZnVuY3Rpb24gQ3Jvd2RzYWxlKGFkZHJlc3MgX3NraW5Db2luQWRkcmVzcywgYWRkcmVzcyBfdG8pIHsKICAgICAgICBjb2luID0gU2tpbkNvaW4oX3NraW5Db2luQWRkcmVzcyk7CiAgICAgICAgbXVsdGlzaWdFdGhlciA9IF90bzsKICAgIH0KICAgIC8qIAogICAgICogVGhlIGZhbGxiYWNrIGZ1bmN0aW9uIGNvcnJlc3BvbmRzIHRvIGEgZG9uYXRpb24gaW4gRVRICiAgICAgKi8KICAgIGZ1bmN0aW9uKCkgc3RvcEluRW1lcmdlbmN5IHJlc3BlY3RUaW1lRnJhbWUgcGF5YWJsZSB7CiAgICAgICAgcmVjZWl2ZUVUSChtc2cuc2VuZGVyKTsKICAgIH0KICAgIC8qIAogICAgICogVG8gY2FsbCB0byBzdGFydCB0aGUgY3Jvd2RzYWxlCiAgICAgKi8KICAgIGZ1bmN0aW9uIHN0YXJ0KCkgb25seU93bmVyIHsKICAgICAgICBpZiAoc3RhcnRUaW1lICE9IDApIHRocm93OyAvLyBDcm93ZHNhbGUgd2FzIGFscmVhZHkgc3RhcnRlZAogICAgICAgIHN0YXJ0VGltZSA9IG5vdyA7ICAgICAgICAgICAgCiAgICAgICAgZW5kVGltZSA9ICBub3cgKyBDUk9XRFNBTEVfUEVSSU9EOyAgICAKICAgIH0KICAgIC8qCiAgICAgKiAgUmVjZWl2ZXMgYSBkb25hdGlvbiBpbiBFdGhlcgogICAgKi8KICAgIGZ1bmN0aW9uIHJlY2VpdmVFVEgoYWRkcmVzcyBiZW5lZmljaWFyeSkgaW50ZXJuYWwgewogICAgICAgIGlmIChtc2cudmFsdWUgPCBNSU5fSU5WRVNUX0VUSEVSKSB0aHJvdzsgLy8gRG9uJ3QgYWNjZXB0IGZ1bmRpbmcgdW5kZXIgYSBwcmVkZWZpbmVkIHRocmVzaG9sZAogICAgICAgIAogICAgICAgIHVpbnQgY29pblRvU2VuZCA9IGJvbnVzKG1zZy52YWx1ZS5tdWwoQ09JTl9QRVJfRVRIRVIpLmRpdigxIGV0aGVyKSk7IC8vIENvbXB1dGUgdGhlIG51bWJlciBvZiBTa2luQ29pbiB0byBzZW5kCiAgICAgICAgaWYgKGNvaW5Ub1NlbmQuYWRkKGNvaW5TZW50VG9FdGhlcikgPiBNQVhfQ0FQKSB0aHJvdzsgICAgCiAgICAgICAgQmFja2VyIGJhY2tlciA9IGJhY2tlcnNbYmVuZWZpY2lhcnldOwogICAgICAgIGNvaW4udHJhbnNmZXIoYmVuZWZpY2lhcnksIGNvaW5Ub1NlbmQpOyAvLyBUcmFuc2ZlciBTa2luQ29pbnMgcmlnaHQgbm93IAogICAgICAgIGJhY2tlci5jb2luU2VudCA9IGJhY2tlci5jb2luU2VudC5hZGQoY29pblRvU2VuZCk7CiAgICAgICAgYmFja2VyLndlaVJlY2VpdmVkID0gYmFja2VyLndlaVJlY2VpdmVkLmFkZChtc2cudmFsdWUpOyAvLyBVcGRhdGUgdGhlIHRvdGFsIHdlaSBjb2xsZWN0ZWQgZHVyaW5nIHRoZSBjcm93ZGZ1bmRpbmcgZm9yIHRoaXMgYmFja2VyICAgIAogICAgICAgIGV0aGVyUmVjZWl2ZWQgPSBldGhlclJlY2VpdmVkLmFkZChtc2cudmFsdWUpOyAvLyBVcGRhdGUgdGhlIHRvdGFsIHdlaSBjb2xsZWN0ZWQgZHVyaW5nIHRoZSBjcm93ZGZ1bmRpbmcKICAgICAgICBjb2luU2VudFRvRXRoZXIgPSBjb2luU2VudFRvRXRoZXIuYWRkKGNvaW5Ub1NlbmQpOwogICAgICAgIC8vIFNlbmQgZXZlbnRzCiAgICAgICAgTG9nQ29pbnNFbWl0ZWQobXNnLnNlbmRlciAsY29pblRvU2VuZCk7CiAgICAgICAgTG9nUmVjZWl2ZWRFVEgoYmVuZWZpY2lhcnksIGV0aGVyUmVjZWl2ZWQpOyAKICAgIH0KICAgIAogICAgLyoKICAgICAqQ29tcHV0ZSB0aGUgU2tpbkNvaW4gYm9udXMgYWNjb3JkaW5nIHRvIHRoZSBpbnZlc3RtZW50IHBlcmlvZAogICAgICovCiAgICBmdW5jdGlvbiBib251cyh1aW50IGFtb3VudCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIGlmIChub3cgPCBzdGFydFRpbWUuYWRkKDIgZGF5cykpIHJldHVybiBhbW91bnQuYWRkKGFtb3VudC5kaXYoNSkpOyAgIC8vIGJvbnVzIDIwJQogICAgICAgIHJldHVybiBhbW91bnQ7CiAgICB9CiAgICAvKiAgCiAgICAgKiBGaW5hbGl6ZSB0aGUgY3Jvd2RzYWxlLCBzaG91bGQgYmUgY2FsbGVkIGFmdGVyIHRoZSByZWZ1bmQgcGVyaW9kCiAgICAqLwogICAgZnVuY3Rpb24gZmluYWxpemUoKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICBpZiAobm93IDwgZW5kVGltZSkgeyAvLyBDYW5ub3QgZmluYWxpc2UgYmVmb3JlIENST1dEU0FMRV9QRVJJT0Qgb3IgYmVmb3JlIHNlbGxpbmcgYWxsIGNvaW5zCiAgICAgICAgICAgIGlmIChjb2luU2VudFRvRXRoZXIgPT0gTUFYX0NBUCkgewogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGNvaW5TZW50VG9FdGhlciA8IE1JTl9DQVAgJiYgbm93IDwgZW5kVGltZSArIDE1IGRheXMpIHRocm93OyAvLyBJZiBNSU5fQ0FQIGlzIG5vdCByZWFjaGVkIGRvbm9ycyBoYXZlIDE1ZGF5cyB0byBnZXQgcmVmdW5kIGJlZm9yZSB3ZSBjYW4gZmluYWxpc2UKICAgICAgICBpZiAoIW11bHRpc2lnRXRoZXIuc2VuZCh0aGlzLmJhbGFuY2UpKSB0aHJvdzsgLy8gTW92ZSB0aGUgcmVtYWluaW5nIEV0aGVyIHRvIHRoZSBtdWx0aXNpZyBhZGRyZXNzCiAgICAgICAgCiAgICAgICAgdWludCByZW1haW5zID0gY29pbi5iYWxhbmNlT2YodGhpcyk7CiAgICAgICAgaWYgKHJlbWFpbnMgPiAwKSB7IC8vIEJ1cm4gdGhlIHJlc3Qgb2YgU2tpbkNvaW5zCiAgICAgICAgICAgIGlmICghY29pbi5idXJuKHJlbWFpbnMpKSB0aHJvdyA7CiAgICAgICAgfQogICAgICAgIGNyb3dkc2FsZUNsb3NlZCA9IHRydWU7CiAgICB9CiAgICAvKiAgCiAgICAqIEZhaWxzYWZlIGRyYWluCiAgICAqLwogICAgZnVuY3Rpb24gZHJhaW4oKSBvbmx5T3duZXIgewogICAgICAgIGlmICghb3duZXIuc2VuZCh0aGlzLmJhbGFuY2UpKSB0aHJvdzsKICAgIH0KICAgIC8qKgogICAgICogQWxsb3cgdG8gY2hhbmdlIHRoZSB0ZWFtIG11bHRpc2lnIGFkZHJlc3MgaW4gdGhlIGNhc2Ugb2YgZW1lcmdlbmN5LgogICAgICovCiAgICBmdW5jdGlvbiBzZXRNdWx0aXNpZyhhZGRyZXNzIGFkZHIpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGlmIChhZGRyID09IGFkZHJlc3MoMCkpIHRocm93OwogICAgICAgIG11bHRpc2lnRXRoZXIgPSBhZGRyOwogICAgfQogICAgLyoqCiAgICAgKiBNYW51YWxseSBiYWNrIFNraW5Db2luIG93bmVyIGFkZHJlc3MuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJhY2tTa2luQ29pbk93bmVyKCkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgY29pbi50cmFuc2Zlck93bmVyc2hpcChvd25lcik7CiAgICB9CiAgICAvKioKICAgICAqIFRyYW5zZmVyIHJlbWFpbnMgdG8gb3duZXIgaW4gY2FzZSBpZiBpbXBvc3NpYmxlIHRvIGRvIG1pbiBpbnZlc3QKICAgICAqLwogICAgZnVuY3Rpb24gZ2V0UmVtYWluQ29pbnMoKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICB2YXIgcmVtYWlucyA9IE1BWF9DQVAgLSBjb2luU2VudFRvRXRoZXI7CiAgICAgICAgdWludCBtaW5Db2luc1RvU2VsbCA9IGJvbnVzKE1JTl9JTlZFU1RfRVRIRVIubXVsKENPSU5fUEVSX0VUSEVSKSAvICgxIGV0aGVyKSk7CiAgICAgICAgaWYocmVtYWlucyA+IG1pbkNvaW5zVG9TZWxsKSB0aHJvdzsKICAgICAgICBCYWNrZXIgYmFja2VyID0gYmFja2Vyc1tvd25lcl07CiAgICAgICAgY29pbi50cmFuc2Zlcihvd25lciwgcmVtYWlucyk7IC8vIFRyYW5zZmVyIFNraW5Db2lucyByaWdodCBub3cgCiAgICAgICAgYmFja2VyLmNvaW5TZW50ID0gYmFja2VyLmNvaW5TZW50LmFkZChyZW1haW5zKTsKICAgICAgICBjb2luU2VudFRvRXRoZXIgPSBjb2luU2VudFRvRXRoZXIuYWRkKHJlbWFpbnMpOwogICAgICAgIC8vIFNlbmQgZXZlbnRzCiAgICAgICAgTG9nQ29pbnNFbWl0ZWQodGhpcyAscmVtYWlucyk7CiAgICAgICAgTG9nUmVjZWl2ZWRFVEgob3duZXIsIGV0aGVyUmVjZWl2ZWQpOyAKICAgIH0KICAgIC8qIAogICAgICogV2hlbiBNSU5fQ0FQIGlzIG5vdCByZWFjaDoKICAgICAqIDEpIGJhY2tlciBjYWxsIHRoZSAiYXBwcm92ZSIgZnVuY3Rpb24gb2YgdGhlIFNraW5Db2luIHRva2VuIGNvbnRyYWN0IHdpdGggdGhlIGFtb3VudCBvZiBhbGwgU2tpbkNvaW5zIHRoZXkgZ290IGluIG9yZGVyIHRvIGJlIHJlZnVuZAogICAgICogMikgYmFja2VyIGNhbGwgdGhlICJyZWZ1bmQiIGZ1bmN0aW9uIG9mIHRoZSBDcm93ZHNhbGUgY29udHJhY3Qgd2l0aCB0aGUgc2FtZSBhbW91bnQgb2YgU2tpbkNvaW5zCiAgICAgKiAzKSBiYWNrZXIgY2FsbCB0aGUgIndpdGhkcmF3UGF5bWVudHMiIGZ1bmN0aW9uIG9mIHRoZSBDcm93ZHNhbGUgY29udHJhY3QgdG8gZ2V0IGEgcmVmdW5kIGluIEVUSAogICAgICovCiAgICBmdW5jdGlvbiByZWZ1bmQodWludCBfdmFsdWUpIG1pbkNhcE5vdFJlYWNoZWQgcHVibGljIHsKICAgICAgICAKICAgICAgICBpZiAoX3ZhbHVlICE9IGJhY2tlcnNbbXNnLnNlbmRlcl0uY29pblNlbnQpIHRocm93OyAvLyBjb21wYXJlIHZhbHVlIGZyb20gYmFja2VyIGJhbGFuY2UKICAgICAgICBjb2luLnRyYW5zZmVyRnJvbShtc2cuc2VuZGVyLCBhZGRyZXNzKHRoaXMpLCBfdmFsdWUpOyAvLyBnZXQgdGhlIHRva2VuIGJhY2sgdG8gdGhlIGNyb3dkc2FsZSBjb250cmFjdAogICAgICAgIGlmICghY29pbi5idXJuKF92YWx1ZSkpIHRocm93IDsgLy8gdG9rZW4gc2VudCBmb3IgcmVmdW5kIGFyZSBidXJudAogICAgICAgIHVpbnQgRVRIVG9TZW5kID0gYmFja2Vyc1ttc2cuc2VuZGVyXS53ZWlSZWNlaXZlZDsKICAgICAgICBiYWNrZXJzW21zZy5zZW5kZXJdLndlaVJlY2VpdmVkPTA7CiAgICAgICAgaWYgKEVUSFRvU2VuZCA+IDApIHsKICAgICAgICAgICAgYXN5bmNTZW5kKG1zZy5zZW5kZXIsIEVUSFRvU2VuZCk7IC8vIHB1bGwgcGF5bWVudCB0byBnZXQgcmVmdW5kIGluIEVUSAogICAgICAgIH0KICAgIH0KfQ=='.
	

]
