Class {
	#name : #SRT221535cbced4c264e53373d81b73c29d010832a5,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT221535cbced4c264e53373d81b73c29d010832a5 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTc7CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCiAgICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICAgIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogICAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgXzsKICAgIH0KCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgcHVibGljIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3ModGhpcykpOwogICAgICAgIHJlcXVpcmUobmV3T3duZXIgIT0gb3duZXIpOyAgCiAgICAgICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgICAgICBvd25lciA9IG5ld093bmVyOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKfQoKLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5CiAqLwpjb250cmFjdCBFUkMyMEJhc2ljIHsKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CiAgICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICAgICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgICAgIHJldHVybiBjOwogICAgfQogICAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoYiA8PSBhKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CiAgICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgICAgIGFzc2VydChjID49IGEpOwogICAgICAgIHJldHVybiBjOwogICAgfQp9CgovKioKICogQHRpdGxlIEJhc2ljIHRva2VuCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuCiAqLwpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpewogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAgICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAgICovCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KfQoKLy8gKioqKioqKioqKioqKioqKioqKioqKioqIG5ldyBTdGFuZGFyZCAgRVJDMjAgdG9rZW4gd2l0aCBpbmNyZWFzZSBhbmQgZGVjcmFlc2UgYXBwcm92YWwgKioqKioqKioqKioqKioqKioqKioqKioKLyoqCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbgogKgogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBpbnRlcm5hbCBhbGxvd2VkOwoKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1tfZnJvbV0pOwogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKCiAgICAgICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgLyoqCiAgICogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCiAgICoKICAgKiBCZXdhcmUgdGhhdCBjaGFuZ2luZyBhbiBhbGxvd2FuY2Ugd2l0aCB0aGlzIG1ldGhvZCBicmluZ3MgdGhlIHJpc2sgdGhhdCBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkCiAgICogYW5kIHRoZSBuZXcgYWxsb3dhbmNlIGJ5IHVuZm9ydHVuYXRlIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcwogICAqIHJhY2UgY29uZGl0aW9uIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUgYWZ0ZXJ3YXJkczoKICAgKiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHNwZW50LgogICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KCiAgLyoqCiAgICogQGRldiBJbmNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9hZGRlZFZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGluY3JlYXNlIHRoZSBhbGxvd2FuY2UgYnkuCiAgICovCiAgICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogIC8qKgogICAqIEBkZXYgRGVjcmVhc2UgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKgogICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGRlY3JlbWVudAogICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3VidHJhY3RlZFZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGRlY3JlYXNlIHRoZSBhbGxvd2FuY2UgYnkuCiAgICovCiAgICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICAgICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKfQovLyAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgoKLyoqCiAqIEB0aXRsZSBNaW50YWJsZSB0b2tlbgogKiBAZGV2IFNpbXBsZSBFUkMyMCBUb2tlbiBleGFtcGxlLCB3aXRoIG1pbnRhYmxlIHRva2VuIGNyZWF0aW9uCiAqIEBkZXYgSXNzdWU6ICogaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXBwZWxpbi1zb2xpZGl0eS9pc3N1ZXMvMTIwCiAqIEJhc2VkIG9uIGNvZGUgYnkgVG9rZW5NYXJrZXROZXQ6IGh0dHBzOi8vZ2l0aHViLmNvbS9Ub2tlbk1hcmtldE5ldC9pY28vYmxvYi9tYXN0ZXIvY29udHJhY3RzL01pbnRhYmxlVG9rZW4uc29sCiAqLwpjb250cmFjdCBNaW50YWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIE93bmFibGUgewoKICAgIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGFtb3VudCk7CiAgICBldmVudCBNaW50RmluaXNoZWQoKTsKCiAgICBib29sIHB1YmxpYyBtaW50aW5nRmluaXNoZWQgPSBmYWxzZTsKCiAgICBtb2RpZmllciBjYW5NaW50KCkgewogICAgICAgIHJlcXVpcmUoIW1pbnRpbmdGaW5pc2hlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgLyoqCiAgKiBAZGV2IEZ1bmN0aW9uIHRvIG1pbnQgdG9rZW5zCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCByZWNpZXZlIHRoZSBtaW50ZWQgdG9rZW5zLgogICAgKiBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAgKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogICAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKF9hbW91bnQpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfYW1vdW50KTsKICAgICAgICBUcmFuc2ZlcigwWDAsIF90bywgX2Ftb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogIC8qKgogICogQGRldiBGdW5jdGlvbiB0byBzdG9wIG1pbnRpbmcgbmV3IHRva2Vucy4KICAqIEByZXR1cm4gVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogICAgZnVuY3Rpb24gZmluaXNoTWludGluZygpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIG1pbnRpbmdGaW5pc2hlZCA9IHRydWU7CiAgICAgICAgTWludEZpbmlzaGVkKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0KCmNvbnRyYWN0IE1vb1Rva2VuIGlzIE1pbnRhYmxlVG9rZW4gewogIC8vIENvaW4gUHJvcGVydGllcwogICAgc3RyaW5nIHB1YmxpYyBuYW1lID0gIk1PTyB0b2tlbiI7CiAgICBzdHJpbmcgcHVibGljIHN5bWJvbCA9ICJYTU9PIjsKICAgIHVpbnQyNTYgcHVibGljIGRlY2ltYWxzID0gMTg7CgogICAgZXZlbnQgRW1lcmdlbmN5RVJDMjBEcmFpbldhc0NhbGxlZChhZGRyZXNzIHRva2VuYWRkcmVzcywgdWludDI1NiBfYW1vdW50KTsKCiAgLy8gU3BlY2lhbCBwcm9wZXRpZXMKICAgIGJvb2wgcHVibGljIHRyYWRpbmdTdGFydGVkID0gZmFsc2U7CgogIC8qKgogICogQGRldiBtb2RpZmllciB0aGF0IHRocm93cyBpZiB0cmFkaW5nIGhhcyBub3Qgc3RhcnRlZCB5ZXQKICAgKi8KICAgIG1vZGlmaWVyIGhhc1N0YXJ0ZWRUcmFkaW5nKCkgewogICAgICAgIHJlcXVpcmUodHJhZGluZ1N0YXJ0ZWQpOwogICAgICAgIF87CiAgICB9CgogIC8qKgogICogQGRldiBBbGxvd3MgdGhlIG93bmVyIHRvIGVuYWJsZSB0aGUgdHJhZGluZy4gVGhpcyBjYW4gbm90IGJlIHVuZG9uZQogICovCiAgICBmdW5jdGlvbiBzdGFydFRyYWRpbmcoKSBwdWJsaWMgb25seU93bmVyIHJldHVybnMoYm9vbCkgewogICAgICAgIHJlcXVpcmUoIXRyYWRpbmdTdGFydGVkKTsKICAgICAgICB0cmFkaW5nU3RhcnRlZCA9IHRydWU7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogIC8qKgogICogQGRldiBBbGxvd3MgYW55b25lIHRvIHRyYW5zZmVyIHRoZSBNT08gdG9rZW5zIG9uY2UgdHJhZGluZyBoYXMgc3RhcnRlZAogICogQHBhcmFtIF90byB0aGUgcmVjaXBpZW50IGFkZHJlc3Mgb2YgdGhlIHRva2Vucy4KICAqIEBwYXJhbSBfdmFsdWUgbnVtYmVyIG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcmVkLgogICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBoYXNTdGFydGVkVHJhZGluZyBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CiAgICB9CgogIC8qKgogICogQGRldiBBbGxvd3MgYW55b25lIHRvIHRyYW5zZmVyIHRoZSBNT08gdG9rZW5zIG9uY2UgdHJhZGluZyBoYXMgc3RhcnRlZAogICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQgdGhlIGFtb3V0IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcmVkCiAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBoYXNTdGFydGVkVHJhZGluZyBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBlbWVyZ2VuY3lFUkMyMERyYWluKCBFUkMyMCBvZGRUb2tlbiwgdWludCBhbW91bnQgKSBwdWJsaWMgb25seU93bmVyIHJldHVybnMoYm9vbCl7CiAgICAgICAgb2RkVG9rZW4udHJhbnNmZXIob3duZXIsIGFtb3VudCk7CiAgICAgICAgRW1lcmdlbmN5RVJDMjBEcmFpbldhc0NhbGxlZChvZGRUb2tlbiwgYW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBpc093bmVyKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zKGJvb2wpewogICAgICAgIGlmIChvd25lciA9PSBfb3duZXIpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7ICAgIAogICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOyAgICAKICAgIH0gCiAgICB9Cn0KCgpjb250cmFjdCBNb29Ub2tlblNhbGUgaXMgT3duYWJsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgLy8gVGhlIHRva2VuIGJlaW5nIHNvbGQKICAgIE1vb1Rva2VuIHB1YmxpYyB0b2tlbjsKICAgIHVpbnQyNTYgcHVibGljIGRlY2ltYWxzOwogICAgdWludDI1NiBwdWJsaWMgb25lQ29pbjsKCiAgLy8gc3RhcnQgYW5kIGVuZCBibG9jayB3aGVyZSBpbnZlc3RtZW50cyBhcmUgYWxsb3dlZCAKICAgIHVpbnQyNTYgcHVibGljIFBSRVNBTEVfU1RBUlRUSU1FU1RBTVA7CiAgICB1aW50MjU2IHB1YmxpYyBQUkVTQUxFX0VORFRJTUVTVEFNUDsKCiAgLy8gc3RhcnQgYW5kIGVuZCBibG9jayB3aGVyZSBpbnZlc3RtZW50cyBhcmUgYWxsb3dlZCAKICAgIHVpbnQyNTYgcHVibGljIFBVQkxJQ1NBTEVfU1RBUlRUSU1FU1RBTVA7CiAgICB1aW50MjU2IHB1YmxpYyBQVUJMSUNTQUxFX0VORFRJTUVTVEFNUDsKCiAgLy8gYWRkcmVzcyB3aGVyZSBmdW5kcyBhcmUgY29sbGVjdGVkCiAgICBhZGRyZXNzIHB1YmxpYyBtdWx0aVNpZzsKCiAgICBmdW5jdGlvbiBzZXRXYWxsZXQoYWRkcmVzcyBfbmV3V2FsbGV0KSBwdWJsaWMgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBtdWx0aVNpZyA9IF9uZXdXYWxsZXQ7CiAgICAgICAgV2FsbGV0VXBkYXRlZChfbmV3V2FsbGV0KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gCgogICAgdWludDI1NiByYXRlOyAvLyBob3cgbWFueSB0b2tlbiB1bml0cyBhIGJ1eWVyIGdldHMgcGVyIHdlaQogICAgdWludDI1NiBwdWJsaWMgbWluQ29udHJpYnV0aW9uID0gMC4wMDAxIGV0aGVyOyAgLy8gbWluaW11bSBjb250cmlidXRpbyB0byBwYXJ0aWNpcGF0ZSBpbiB0b2tlbnNhbGUKICAgIHVpbnQyNTYgcHVibGljIG1heENvbnRyaWJ1dGlvbiA9IDEwMDAgZXRoZXI7CiAgICB1aW50MjU2IHB1YmxpYyB0b2tlbnNPZlRlYW1BbmRBZHZpc29yczsKCiAgLy8gYW1vdW50IG9mIHJhaXNlZCBtb25leSBpbiB3ZWkKICAgIHVpbnQyNTYgcHVibGljIHdlaVJhaXNlZDsKCiAgLy8gYW1vdW50IG9mIHJhaXNlZCB0b2tlbnMKICAgIHVpbnQyNTYgcHVibGljIHRva2VuUmFpc2VkOwoKICAvLyBtYXhpbXVtIGFtb3VudCBvZiB0b2tlbnMgYmVpbmcgY3JlYXRlZAogICAgdWludDI1NiBwdWJsaWMgbWF4VG9rZW5zOwoKICAvLyBtYXhpbXVtIGFtb3VudCBvZiB0b2tlbnMgZm9yIHNhbGUKICAgIHVpbnQyNTYgcHVibGljIHRva2Vuc0ZvclNhbGU7ICAKICAvLyBtYXhpbXVtIGFtb3VudCBvZiB0b2tlbnMgZm9yIHByZXNhbGUKICAvLyB1aW50MjU2IHB1YmxpYyB0b2tlbnNGb3JQcmVTYWxlOyAKCiAgLy8gbnVtYmVyIG9mIHBhcnRpY2lwYW50cyBpbiBwcmVzYWxlCiAgICB1aW50MjU2IHB1YmxpYyBudW1iZXJPZkNvbnRyaWJ1dG9ycyA9IDA7CgogIC8vICBmb3Igd2hpdGVsaXN0CiAgICBhZGRyZXNzIHB1YmxpYyBjczsKICAvLyAgZm9yIHdoaXRlbGlzdCBBTkQgcGxhY2VtZW50CiAgICBhZGRyZXNzIHB1YmxpYyBBZG1pbjsKCiAgLy8gIGZvciByYXRlCiAgICB1aW50IHB1YmxpYyBiYXNpY1JhdGU7CgogIC8vIGZvciBtYXhpbXVtIHRva2VuIHdoYXQgb25lIGNvbnRyaWJ1dG9yIGNhbiBidXkKICAgIHVpbnQgcHVibGljIG1heFRva2VuQ2FwOwogIC8vIGZvciBzdXNwZW5zaW9uCiAgICBib29sIHB1YmxpYyBzdXNwZW5kZWQ7CiAKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBhdXRob3Jpc2VkOyAvLyBqdXN0IHRvIGFubm95IHRoZSBoZWNrIG91dCBvZiBhbWVyaWNhbnMKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgYWRtaW5DYWxsTWludFRvVGVhbUNvdW50OyAvLyBjb3VudCB0byBhZG1pbiBvbmx5IG9uY2UgY2FuIGNhbGwgTWludFRvVGVhbUFuZEFkdmlzb3JzCgogICAgZXZlbnQgVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCB1aW50MjU2IGFtb3VudCwgdWludDI1NiBfdG9rZW5zKTsKICAgIGV2ZW50IFRva2VuUGxhY2VkKGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiBfdG9rZW5zKTsKICAgIGV2ZW50IFNhbGVDbG9zZWQoKTsKICAgIGV2ZW50IFRyYWRpbmdTdGFydGVkKCk7CiAgICBldmVudCBDbG9zZWQoKTsKICAgIGV2ZW50IEFkbWluVXBkYXRlZChhZGRyZXNzIG5ld0FkbWluQWRkcmVzcyk7CiAgICBldmVudCBDc1VwZGF0ZWQoYWRkcmVzcyBuZXdDU0FkZHJlc3MpOwogICAgZXZlbnQgRW1lcmdlbmN5RVJDMjBEcmFpbldhc0NhbGxlZChhZGRyZXNzIHRva2VuYWRkcmVzcywgdWludDI1NiBfYW1vdW50KTsKICAgIGV2ZW50IEF1dGhvcmlzZVN0YXR1c1VwZGF0ZWQoYWRkcmVzcyBhY2NvdW50cywgYm9vbCBzdGF0dXMpOwogICAgZXZlbnQgU2FsZVJlc3VtZWQoKTsKICAgIGV2ZW50IFNhbGVTdXNwZW5kZWQoKTsKICAgIGV2ZW50IFdhbGxldFVwZGF0ZWQoYWRkcmVzcyBuZXd3YWxsZXQpOwogICAKCiAgICBmdW5jdGlvbiBNb29Ub2tlblNhbGUoKSBwdWJsaWMgewogICAgICAgIFBSRVNBTEVfU1RBUlRUSU1FU1RBTVAgPSAxNTE2ODk2MDAwOwogICAgICAgIC8vIDE1MTY4OTYwMDAgY29udmVydHMgdG8gRnJpZGF5IEphbnVhcnkgMjYsIDIwMTggMDA6MDA6MDAgKGFtKSBpbiB0aW1lIHpvbmUgQXNpYS9TaW5nYXBvcmUgKCswOCkKICAgICAgICBQUkVTQUxFX0VORFRJTUVTVEFNUCA9IDE1MjIyMDk2MDA7CiAgICAgICAgLy8xNTIyMjA5NjAwIGNvbnZlcnRzIHRvIFdlZG5lc2RheSBNYXJjaCAyOCwgMjAxOCAxMjowMDowMCAocG0pIGluIHRpbWUgem9uZSBBc2lhL1NpbmdhcG9yZSAoKzA4KQogICAgICAgIFBVQkxJQ1NBTEVfU1RBUlRUSU1FU1RBTVAgPSAxNTIyMzgyNDAwOwogICAgICAgIC8vICAxNTIyMzgyNDAwIGNvbnZlcnRzIHRvIEZyaWRheSBNYXJjaCAzMCwgMjAxOCAxMjowMDowMCAocG0pIGluIHRpbWUgem9uZSBBc2lhL1NpbmdhcG9yZSAoKzA4KQogICAgICAgIFBVQkxJQ1NBTEVfRU5EVElNRVNUQU1QID0gMTUyNTA2MDgwMDsgCiAgICAgICAgLy8gMTUyNTA2MDgwMCBjb252ZXJ0cyB0byBNb25kYXkgQXByaWwgMzAsIDIwMTggMTI6MDA6MDAgKHBtKSBpbiB0aW1lIHpvbmUgQXNpYS9TaW5nYXBvcmUgKCswOCkKICAgICAgCiAgICAgICAgbXVsdGlTaWcgPSAweDkwNDIwQjhhZWY0MkY4NTZhMEFGQjRGRkJmYUE1NzQwNUZCMTkwZjM7CiAgIAogICAgICAgIHRva2VuID0gbmV3IE1vb1Rva2VuKCk7CiAgICAgICAgZGVjaW1hbHMgPSB0b2tlbi5kZWNpbWFscygpOwogICAgICAgIG9uZUNvaW4gPSAxMCAqKiBkZWNpbWFsczsKICAgICAgICBtYXhUb2tlbnMgPSA1MDAgKiAoMTAqKjYpICogb25lQ29pbjsKICAgICAgICB0b2tlbnNGb3JTYWxlID0gMjAwMjYwMDUwICogb25lQ29pbjsgLy8gMjAwIDI2MCAwNTAKICAgICAgICBiYXNpY1JhdGUgPSAxODAwOwogICAgICAgIHJhdGUgPSBiYXNpY1JhdGU7CiAgICAgICAgdG9rZW5zT2ZUZWFtQW5kQWR2aXNvcnMgPSA5OTczOTk1MCAqIG9uZUNvaW47ICAvLyBpdCB3YXMgbWlzc2luZyB0aGUgb25lY29pbiAsIDk5IDczOSA5NTAKICAgICAgICBtYXhUb2tlbkNhcCA9IGJhc2ljUmF0ZSAqIG1heENvbnRyaWJ1dGlvbiAqIDExLzEwOwogICAgICAgIHN1c3BlbmRlZCA9IGZhbHNlOwogICAgfQoKCiAgICBmdW5jdGlvbiBjdXJyZW50VGltZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIG5vdzsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBDYWxjdWxhdGVzIHRoZSByYXRlIHdpdGggYm9udXMgaW4gdGhlIHB1YmxpcyBzYWxlCiAgICAqLwogICAgZnVuY3Rpb24gZ2V0Q3VycmVudFJhdGUoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAKICAgICAgICBpZiAoY3VycmVudFRpbWUoKSA8PSBQUkVTQUxFX0VORFRJTUVTVEFNUCkgewogICAgICAgICAgICByZXR1cm4gYmFzaWNSYXRlICogNS80OwogICAgICAgIH0KCiAgICAgICAgaWYgKHRva2VuUmFpc2VkIDw9IDEwMDAwMDAwICogb25lQ29pbikgewogICAgICAgICAgICByZXR1cm4gYmFzaWNSYXRlICogMTEvMTA7CiAgICB9IGVsc2UgaWYgKHRva2VuUmFpc2VkIDw9IDIwMDAwMDAwICogb25lQ29pbikgewogICAgICAgIHJldHVybiBiYXNpY1JhdGUgKiAxMDc1LzEwMDA7CiAgICB9IGVsc2UgaWYgKHRva2VuUmFpc2VkIDw9IDMwMDAwMDAwICogb25lQ29pbikgewogICAgICAgIHJldHVybiBiYXNpY1JhdGUgKiAxMDUvMTAwOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gYmFzaWNSYXRlIDsKICAgIH0KICAgIH0KCgogIC8vIEByZXR1cm4gdHJ1ZSBpZiBjcm93ZHNhbGUgZXZlbnQgaGFzIGVuZGVkCiAgICBmdW5jdGlvbiBoYXNFbmRlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgaWYgKGN1cnJlbnRUaW1lKCkgPiBQVUJMSUNTQUxFX0VORFRJTUVTVEFNUCkKICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIGlmICB0aGUgdGltZSBpcyBvdmVyCiAgICAgICAgaWYgKHRva2VuUmFpc2VkID49IHRva2Vuc0ZvclNhbGUpCiAgICAgICAgICAgIHJldHVybiB0cnVlOyAvLyBpZiB3ZSByZWFjaCB0aGUgdG9rZW5zRm9yU2FsZSAKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgovLyBBbGxvd3MgYWRtaW4gdG8gc3VzcGVuZCB0aGUgc2FsZS4KICAgIGZ1bmN0aW9uIHN1c3BlbmQoKSBleHRlcm5hbCBvbmx5QWRtaW4gcmV0dXJucyhib29sKSB7CiAgICAgICAgaWYgKHN1c3BlbmRlZCA9PSB0cnVlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgc3VzcGVuZGVkID0gdHJ1ZTsKICAgICAgICBTYWxlU3VzcGVuZGVkKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgoKLy8gQWxsb3dzIGFkbWluIHRvIHJlc3VtZSB0aGUgc2FsZS4KICAgIGZ1bmN0aW9uIHJlc3VtZSgpIGV4dGVybmFsIG9ubHlBZG1pbiByZXR1cm5zKGJvb2wpIHsKICAgICAgICBpZiAoc3VzcGVuZGVkID09IGZhbHNlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgc3VzcGVuZGVkID0gZmFsc2U7CiAgICAgICAgU2FsZVJlc3VtZWQoKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgCiAgLy8gQGRldiB0aHJvd3MgaWYgcGVyc29uIHNlbmRpbmcgaXMgbm90IGNvbnRyYWN0IEFkbWluIG9yIGNzIHJvbGUKICAgIG1vZGlmaWVyIG9ubHlDU29yQWRtaW4oKSB7CiAgICAgICAgcmVxdWlyZSgobXNnLnNlbmRlciA9PSBBZG1pbikgfHwgKG1zZy5zZW5kZXI9PWNzKSk7CiAgICAgICAgXzsKICAgIH0KICAgIG1vZGlmaWVyIG9ubHlBZG1pbigpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gQWRtaW4pOwogICAgICAgIF87CiAgICB9CgogIC8qKgogICogQGRldiB0aHJvd3MgaWYgcGVyc29uIHNlbmRpbmcgaXMgbm90IGF1dGhvcmlzZWQgb3Igc2VuZHMgbm90aGluZyBvciB3ZSBhcmUgb3V0IG9mIHRpbWUKICAqLwogICAgbW9kaWZpZXIgb25seUF1dGhvcmlzZWQoKSB7CiAgICAgICAgcmVxdWlyZSAoYXV0aG9yaXNlZFttc2cuc2VuZGVyXSk7CiAgICAgICAgcmVxdWlyZSAoKGN1cnJlbnRUaW1lKCkgPj0gUFJFU0FMRV9TVEFSVFRJTUVTVEFNUCAmJiBjdXJyZW50VGltZSgpIDw9IFBSRVNBTEVfRU5EVElNRVNUQU1QICkgfHwgKGN1cnJlbnRUaW1lKCkgPj0gUFVCTElDU0FMRV9TVEFSVFRJTUVTVEFNUCAmJiBjdXJyZW50VGltZSgpIDw9IFBVQkxJQ1NBTEVfRU5EVElNRVNUQU1QICkpOwogICAgICAgIHJlcXVpcmUgKCEoaGFzRW5kZWQoKSkpOwogICAgICAgIHJlcXVpcmUgKG11bHRpU2lnICE9IDB4MCk7CiAgICAgICAgcmVxdWlyZSAobXNnLnZhbHVlID4gMSBmaW5uZXkpOwogICAgICAgIHJlcXVpcmUoIXN1c3BlbmRlZCk7CiAgICAgICAgcmVxdWlyZSh0b2tlbnNGb3JTYWxlID4gdG9rZW5SYWlzZWQpOyAvLyBjaGVjayB3ZSBhcmUgbm90IG92ZXIgdGhlIG51bWJlciBvZiB0b2tlbnNGb3JTYWxlCiAgICAgICAgXzsKICAgIH0KCiAgLyoqCiAgKiBAZGV2IGF1dGhvcmlzZSBhbiBhY2NvdW50IHRvIHBhcnRpY2lwYXRlCiAgKi8KICAgIGZ1bmN0aW9uIGF1dGhvcmlzZUFjY291bnQoYWRkcmVzcyB3aG9tKSBvbmx5Q1NvckFkbWluIHB1YmxpYyByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXF1aXJlKHdob20gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgcmVxdWlyZSh3aG9tICE9IGFkZHJlc3ModGhpcykpOwogICAgICAgIGF1dGhvcmlzZWRbd2hvbV0gPSB0cnVlOwogICAgICAgIEF1dGhvcmlzZVN0YXR1c1VwZGF0ZWQod2hvbSwgdHJ1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogIC8qKgogICogQGRldiBhdXRob3Jpc2UgYSBsb3Qgb2YgYWNjb3VudHMgaW4gb25lIGdvCiAgKi8KICAgIGZ1bmN0aW9uIGF1dGhvcmlzZU1hbnlBY2NvdW50cyhhZGRyZXNzW10gbWFueSkgb25seUNTb3JBZG1pbiBwdWJsaWMgcmV0dXJucyhib29sKSB7CiAgICAgICAgcmVxdWlyZShtYW55Lmxlbmd0aCA+IDApOyAgCiAgICAgICAgZm9yICh1aW50MjU2IGkgPSAwOyBpIDwgbWFueS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICByZXF1aXJlKG1hbnlbaV0gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgICAgIHJlcXVpcmUobWFueVtpXSAhPSBhZGRyZXNzKHRoaXMpKTsgIAogICAgICAgICAgICBhdXRob3Jpc2VkW21hbnlbaV1dID0gdHJ1ZTsKICAgICAgICAgICAgQXV0aG9yaXNlU3RhdHVzVXBkYXRlZChtYW55W2ldLCB0cnVlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7ICAgICAgICAgICAgCiAgICB9CgogIC8qKgogICogQGRldiBiYW4gYW4gYWNjb3VudCBmcm9tIHBhcnRpY2lwYXRpb24gKGRlZmF1bHQpCiAgKi8KICAgIGZ1bmN0aW9uIGJsb2NrQWNjb3VudChhZGRyZXNzIHdob20pIG9ubHlDU29yQWRtaW4gcHVibGljIHJldHVybnMoYm9vbCl7CiAgICAgICAgcmVxdWlyZSh3aG9tICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUod2hvbSAhPSBhZGRyZXNzKHRoaXMpKTsKICAgICAgICBhdXRob3Jpc2VkW3dob21dID0gZmFsc2U7CiAgICAgICAgQXV0aG9yaXNlU3RhdHVzVXBkYXRlZCh3aG9tLCBmYWxzZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogIC8qKgogICogQGRldiBzZXQgYSBuZXcgQ1MgcmVwcmVzZW50YXRpdmUKICAqLwogICAgZnVuY3Rpb24gc2V0Q1MoYWRkcmVzcyBuZXdDUykgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKXsKICAgICAgICByZXF1aXJlKG5ld0NTICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUobmV3Q1MgIT0gYWRkcmVzcyh0aGlzKSk7CiAgICAgICAgcmVxdWlyZShuZXdDUyAhPSBvd25lcik7ICAKICAgICAgICBjcyA9IG5ld0NTOwogICAgICAgIENzVXBkYXRlZChuZXdDUyk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogIC8qKgogICogQGRldiBzZXQgYSBuZXcgQWRtaW4gcmVwcmVzZW50YXRpdmUKICAqLwogICAgZnVuY3Rpb24gc2V0QWRtaW4oYWRkcmVzcyBuZXdBZG1pbikgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShuZXdBZG1pbiAhPSBhZGRyZXNzKDApKTsKICAgICAgICByZXF1aXJlKG5ld0FkbWluICE9IGFkZHJlc3ModGhpcykpOwogICAgICAgIHJlcXVpcmUobmV3QWRtaW4gIT0gb3duZXIpOyAgCiAgICAgICAgQWRtaW4gPSBuZXdBZG1pbjsKICAgICAgICBBZG1pblVwZGF0ZWQobmV3QWRtaW4pOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAvKioKICAqIEBkZXYgc2V0IGEgbmV3IFJhdGUgQkUgQ0FSRUZVTEw6IHdoZW4gd2UgY2FsY3VsYXRlIHRoZSBib251cyBiZXR0ZXIgaWYgd2UgaGF2ZSdudCByZW1haW5kZXIgCiAgKi8KICAgIGZ1bmN0aW9uIHNldEJhc2ljUmF0ZSh1aW50IG5ld1JhdGUpIG9ubHlBZG1pbiBwdWJsaWMgcmV0dXJucyAoYm9vbCl7CiAgICAgICAgcmVxdWlyZSgwIDwgbmV3UmF0ZSAmJiBuZXdSYXRlIDwgNTAwMCk7CiAgICAgICAgYmFzaWNSYXRlID0gbmV3UmF0ZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRNYXhUb2tlbkNhcCh1aW50IF9uZXdNYXhUb2tlbkNhcCkgb25seUFkbWluIHB1YmxpYyByZXR1cm5zIChib29sKXsKICAgICAgICByZXF1aXJlKDAgPCBfbmV3TWF4VG9rZW5DYXAgJiYgX25ld01heFRva2VuQ2FwIDwgdG9rZW5zRm9yU2FsZSk7CiAgICAgICAgbWF4VG9rZW5DYXAgPSBfbmV3TWF4VG9rZW5DYXA7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgCiAgICBmdW5jdGlvbiBpc093bmVyKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zKGJvb2wpewogICAgICAgIGlmIChvd25lciA9PSBfb3duZXIpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7ICAgIAogICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOyAgICAKICAgIH0gCiAgICB9CiAgCiAgICBmdW5jdGlvbiBpc0FkbWluKGFkZHJlc3MgX2FkbWluKSBwdWJsaWMgdmlldyByZXR1cm5zKGJvb2wpewogICAgICAgIGlmIChBZG1pbiA9PSBfYWRtaW4pIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7ICAgIAogICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOyAgICAKICAgIH0gCiAgICB9CgogICAgZnVuY3Rpb24gaXNDUyhhZGRyZXNzIF9jcykgcHVibGljIHZpZXcgcmV0dXJucyhib29sKXsKICAgICAgICBpZiAoY3MgPT0gX2NzKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOyAgICAKICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsgICAgCiAgICB9IAogICAgfQoKLyoqCiAgKiBAZGV2ICBvbmx5IEFkbWluIGNhbiBzZW5kIHRva2VucyBtYW51YWxseQogICovCiAgICBmdW5jdGlvbiBwbGFjZVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5LCB1aW50MjU2IF90b2tlbnMpIG9ubHlBZG1pbiBwdWJsaWMgcmV0dXJucyhib29sKXsKCiAgICAvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICAKICAgICAgICByZXF1aXJlKHRva2VuUmFpc2VkLmFkZChfdG9rZW5zKSA8PSB0b2tlbnNGb3JTYWxlKTsgLy8gd2UgZG9udCB3YW50IHRvIG92ZXJtaW50ICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAgICAvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCgogICAgICAgIHJlcXVpcmUoX3Rva2VucyAhPSAwKTsKICAgICAgICByZXF1aXJlKCFoYXNFbmRlZCgpKTsKICAgICAgICBpZiAodG9rZW4uYmFsYW5jZU9mKGJlbmVmaWNpYXJ5KSA9PSAwKSB7CiAgICAgICAgICAgIG51bWJlck9mQ29udHJpYnV0b3JzKys7CiAgICAgICAgfQogICAgICAgIHRva2VuUmFpc2VkID0gdG9rZW5SYWlzZWQuYWRkKF90b2tlbnMpOyAvLyBzbyB3ZSBjYW4gZ28gc2xpZ2h0bHkgb3ZlcgogICAgICAgIHRva2VuLm1pbnQoYmVuZWZpY2lhcnksIF90b2tlbnMpOwogICAgICAgIFRva2VuUGxhY2VkKGJlbmVmaWNpYXJ5LCBfdG9rZW5zKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgLy8gbG93IGxldmVsIHRva2VuIHB1cmNoYXNlIGZ1bmN0aW9uCiAgICBmdW5jdGlvbiBidXlUb2tlbnMoYWRkcmVzcyBiZW5lZmljaWFyeSwgdWludDI1NiBhbW91bnQpIG9ubHlBdXRob3Jpc2VkIGludGVybmFsIHJldHVybnMgKGJvb2wpewogICAgICAKICAgICAgICByYXRlID0gZ2V0Q3VycmVudFJhdGUoKTsKICAgICAgLy8gY2hlY2sgd2UgYXJlIGluIHByZSBzYWxlICwgYm9udXMgMjUlCiAgICAgICAgaWYgKGN1cnJlbnRUaW1lKCkgPD0gUFJFU0FMRV9FTkRUSU1FU1RBTVApIHsKICAgICAgICAgICAgbWluQ29udHJpYnV0aW9uID0gNTAgZXRoZXI7CiAgICAgICAgICAgIG1heENvbnRyaWJ1dGlvbiA9IDEwMDAgZXRoZXI7CiAgICAvLyB3ZSBhcmUgaW4gcHVibGljc2FsZSBib251cyBkZXBlbmRzIG9uIHRoZSBzb2xkIG91dCB0b2tlbnMuIHdlIHNldCB0aGUgcmF0ZSBpbiB0aGUgc2V0VGllcgogICAgfSBlbHNlIHsKICAgICAgICAgICAgbWluQ29udHJpYnV0aW9uID0gMC4yIGV0aGVyOwogICAgICAgICAgICBtYXhDb250cmlidXRpb24gPSAyMCBldGhlcjsKICAgICAgICB9CgogICAgLy9jaGVjayBtaW5pbXVtIGFuZCBtYXhpbXVtIGFtb3VudAogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID49IG1pbkNvbnRyaWJ1dGlvbik7CiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPD0gbWF4Q29udHJpYnV0aW9uKTsKICAgIAogICAgLy8gQ2FsY3VsYXRlIHRva2VuIGFtb3VudCB0byBiZSBwdXJjaGFzZWQgICAgCiAgICAgICAgdWludDI1NiB0b2tlbnMgPSBhbW91bnQubXVsKHJhdGUpOwogICAKICAgCiAgICAvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAgICAgICAgcmVxdWlyZSh0b2tlblJhaXNlZC5hZGQodG9rZW5zKSA8PSB0b2tlbnNGb3JTYWxlKTsgLy9pZiBkb250IHdhbnQgdG8gb3Zlcm1pbnQgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAgICAvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAgICAgICAgcmVxdWlyZSh0b2tlbi5iYWxhbmNlT2YoYmVuZWZpY2lhcnkpICsgdG9rZW5zIDw9IG1heFRva2VuQ2FwKTsgLy8gbGltaXQgb2YgdG9rZW5zIHdoYXQgYSBidXllciBjYW4gYnV5ICoqKioqCiAgICAvLyAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCgoKICAgIC8vIHVwZGF0ZSBzdGF0ZQogICAgICAgIHdlaVJhaXNlZCA9IHdlaVJhaXNlZC5hZGQoYW1vdW50KTsKICAgICAgICBpZiAodG9rZW4uYmFsYW5jZU9mKGJlbmVmaWNpYXJ5KSA9PSAwKSB7CiAgICAgICAgICAgIG51bWJlck9mQ29udHJpYnV0b3JzKys7CiAgICAgICAgfQogICAgICAgIHRva2VuUmFpc2VkID0gdG9rZW5SYWlzZWQuYWRkKHRva2Vucyk7IC8vIHNvIHdlIGNhbiBnbyBzbGlnaHRseSBvdmVyCiAgICAgICAgdG9rZW4ubWludChiZW5lZmljaWFyeSwgdG9rZW5zKTsKICAgICAgICBUb2tlblB1cmNoYXNlKGJlbmVmaWNpYXJ5LCBhbW91bnQsIHRva2Vucyk7CiAgICAgICAgbXVsdGlTaWcudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsgLy8gYmV0dGVyIGluIGNhc2UgYW55IG90aGVyIGV0aGVyIGVuZHMgdXAgaGVyZQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAvLyB0cmFuc2ZlciBvd25lcnNoaXAgb2YgdGhlIHRva2VuIHRvIHRoZSBvd25lciBvZiB0aGUgcHJlc2FsZSBjb250cmFjdAogICAgZnVuY3Rpb24gZmluaXNoU2FsZSgpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoaGFzRW5kZWQoKSk7CiAgICAvLyBhc3NpZ24gdGhlIHJlc3Qgb2YgdGhlIDMwMCBNIHRva2VucyB0byB0aGUgcmVzZXJ2ZQogICAgICAgIHVpbnQgdW5hc3NpZ25lZDsgICAgCiAgICAgICAgaWYodG9rZW5zRm9yU2FsZSA+IHRva2VuUmFpc2VkKSB7CiAgICAgICAgICAgIHVuYXNzaWduZWQgPSB0b2tlbnNGb3JTYWxlLnN1Yih0b2tlblJhaXNlZCk7CiAgICAgICAgICAgIHRva2VuUmFpc2VkID0gdG9rZW5SYWlzZWQuYWRkKHVuYXNzaWduZWQpOwogICAgICAgICAgICB0b2tlbi5taW50KG11bHRpU2lnLHVuYXNzaWduZWQpOwogICAgICAgICAgICBUb2tlblBsYWNlZChtdWx0aVNpZyx1bmFzc2lnbmVkKTsKICAgIH0KICAgICAgICBTYWxlQ2xvc2VkKCk7CiAgICAgICAgdG9rZW4uc3RhcnRUcmFkaW5nKCk7IAogICAgICAgIFRyYWRpbmdTdGFydGVkKCk7CiAgICAvLyBmcm9tIG5vdyBldmVyeW9uZSBjYW4gdHJhZGUgdGhlIHRva2VucyAgYW5kIHRoZSBvd25lciBvZiB0aGUgdG9rZW5jb250cmFjdCBzdGF5IHRoZSBzYWxlY29udHJhY3QKICAgIH0KIAovKioKKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKKiAgICBTUEVDSUFMIFBBUlQgU1RBUlQKKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKICAqIEBkZXYgb25seSBBZG1pbiBjYW4gbWludCBvbmNlIHRoZSBnaXZlbiBhbW91bnQgaW4gdGhlIGdpdmVuIHRpbWUKICAqIHRva2Vuc09mVGVhbUFuZEFkdmlzb3JzIHdhcyBnaXZlbiBieSBjb25zdW1lcgogICogbXVsdGlTaWcgd2FzIGdpdmVuIGJ5IGNvbnN1bWVyCioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAqLwogICAgZnVuY3Rpb24gbWludFRvVGVhbUFuZEFkdmlzb3JzKCkgcHVibGljIG9ubHlBZG1pbiB7CiAgICAgICAgcmVxdWlyZShoYXNFbmRlZCgpKTsKICAgICAgICByZXF1aXJlKGFkbWluQ2FsbE1pbnRUb1RlYW1Db3VudFttc2cuc2VuZGVyXSA9PSAwKTsgLy8gY291bnQgdG8gYWRtaW4gb25seSBvbmNlIGNhbiBjYWxsIE1pbnRUb1RlYW1BbmRBZHZpc29ycwogICAgICAgIHJlcXVpcmUoMTUzNTY0NDgwMCA8PSBjdXJyZW50VGltZSgpICYmIGN1cnJlbnRUaW1lKCkgPD0gMTUzNTczMTIwMCk7ICAvLyBBZG1pbiBoYXZlIDI0aCB0byBjYWxsIHRoaXMgZnVuY3Rpb24KICAgICAgLy8xNTM1NjQ0ODAwIGNvbnZlcnRzIHRvIEZyaWRheSBBdWd1c3QgMzEsIDIwMTggMDA6MDA6MDAgKGFtKSBpbiB0aW1lIHpvbmUgQXNpYS9TaW5nYXBvcmUgKCswOCkKICAgICAgLy8xNTM1NzMxMjAwIGNvbnZlcnRzIHRvIFNhdHVyZGF5IFNlcHRlbWJlciAwMSwgMjAxOCAwMDowMDowMCAoYW0pIGluIHRpbWUgem9uZSBBc2lhL1NpbmdhcG9yZSAoKzA4KQogICAgICAgIGFkbWluQ2FsbE1pbnRUb1RlYW1Db3VudFttc2cuc2VuZGVyXSsrOyAKICAgICAgICB0b2tlblJhaXNlZCA9IHRva2VuUmFpc2VkLmFkZCh0b2tlbnNPZlRlYW1BbmRBZHZpc29ycyk7CiAgICAgICAgdG9rZW4ubWludChtdWx0aVNpZyx0b2tlbnNPZlRlYW1BbmRBZHZpc29ycyk7CiAgICAgICAgVG9rZW5QbGFjZWQobXVsdGlTaWcsIHRva2Vuc09mVGVhbUFuZEFkdmlzb3JzKTsKICAgIH0KIC8qKgoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogICogQGRldiBvbmx5IEFkbWluIGNhbiBtaW50IGZyb20gIlNhbGVDbG9zZWQiIHRvICJDbG9zZWQiIAogICogX3Rva2VucyBnaXZlbiBieSBjbGllbnQgKGxpbWl0IGlmIHdlIHJlYWNoIHRoZSBtYXhUb2tlbnMpCiAgKiBtdWx0aVNpZyB3YXMgZ2l2ZW4gYnkgY2xpZW50CioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAqLyAKICAgIGZ1bmN0aW9uIGFmdGVyU2FsZU1pbnRpbmcodWludCBfdG9rZW5zKSBwdWJsaWMgb25seUFkbWluIHsKICAgICAgICByZXF1aXJlKGhhc0VuZGVkKCkpOwogICAgICAgIHVpbnQgbGltaXQgPSBtYXhUb2tlbnMuc3ViKHRva2Vuc09mVGVhbUFuZEFkdmlzb3JzKTsgCiAgICAgLy8gd2UgZG9udCB3YW50IHRvIG1pbnQgdGhlIHJlc2VydmVkIHRva2VucyBmb3IgVGVhbSBhbmQgQWR2aXNvcnMKICAgICAgICByZXF1aXJlKHRva2VuUmFpc2VkLmFkZChfdG9rZW5zKSA8PSBsaW1pdCk7ICAKICAgICAgICB0b2tlblJhaXNlZCA9IHRva2VuUmFpc2VkLmFkZChfdG9rZW5zKTsKICAgICAgICB0b2tlbi5taW50KG11bHRpU2lnLF90b2tlbnMpOwogICAgICAgIFRva2VuUGxhY2VkKG11bHRpU2lnLCBfdG9rZW5zKTsKICAgIH0gIAovKioKKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKICAqIEBkZXYgb25seSBPd25lciBjYW4gY2FsbCBhZnRlciB0aGUgc2FsZQogICogdW5hc3NpZ25lZCAsIGFsbCBtaXNzaW5nIHRva2VucyB3aWxsIGJlIG1pbnRlZAogICogbXVsdGlTaWcgd2FzIGdpdmVuIGJ5IGNsaWVudAogICogZmluaXNoIG1pbnRpbmcgYW5kIHRyYW5zZmVyIG93bmVyc2hpcCBvZiB0b2tlbgoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogKi8KICAgIGZ1bmN0aW9uIGNsb3NlKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZSgxNTM1NzMxMjAwIDw9IGN1cnJlbnRUaW1lKCkpOyAgLy8gb25seSBhZnRlciB0aGUgQXVnMzEKICAgICAgICB1aW50IHVuYXNzaWduZWQ7CiAgICAgICAgaWYoIG1heFRva2VucyA+IHRva2VuUmFpc2VkKSB7CiAgICAgICAgICAgIHVuYXNzaWduZWQgPSBtYXhUb2tlbnMuc3ViKHRva2VuUmFpc2VkKTsKICAgICAgICAgICAgdG9rZW5SYWlzZWQgPSB0b2tlblJhaXNlZC5hZGQodW5hc3NpZ25lZCk7CiAgICAgICAgICAgIHRva2VuLm1pbnQobXVsdGlTaWcsdW5hc3NpZ25lZCk7CiAgICAgICAgICAgIFRva2VuUGxhY2VkKG11bHRpU2lnLHVuYXNzaWduZWQpOwogICAgICAgICAgICBtdWx0aVNpZy50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOyAvLyBqdXN0IGluIGNhc2UgaWYgd2UgaGF2ZSBldGhlciBpbiB0aGUgY29udGFyY3QKICAgICAgICB9CiAgICAgICAgdG9rZW4uZmluaXNoTWludGluZygpOwogICAgICAgIHRva2VuLnRyYW5zZmVyT3duZXJzaGlwKG93bmVyKTsKICAgICAgICBDbG9zZWQoKTsKICAgIH0KLyoqCioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAgKiBFTkQgT0YgVEhFIFNQRUNJQUwgUEFSVAoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogKi8KCgogIC8vIGZhbGxiYWNrIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIGJ1eSB0b2tlbnMKICAgIGZ1bmN0aW9uICgpIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICBidXlUb2tlbnMobXNnLnNlbmRlciwgbXNnLnZhbHVlKTsKICAgIH0KCiAgLy8gZW1lcmdlbmN5IGlmIHRoZSBjb250YXJjdCBnZXQgRVJDMjAgdG9rZW5zCiAgICBmdW5jdGlvbiBlbWVyZ2VuY3lFUkMyMERyYWluKCBFUkMyMCBvZGRUb2tlbiwgdWludCBhbW91bnQgKSBwdWJsaWMgb25seUNTb3JBZG1pbiByZXR1cm5zKGJvb2wpewogICAgICAgIG9kZFRva2VuLnRyYW5zZmVyKG93bmVyLCBhbW91bnQpOwogICAgICAgIEVtZXJnZW5jeUVSQzIwRHJhaW5XYXNDYWxsZWQob2RkVG9rZW4sIGFtb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cgp9'.
	

]
