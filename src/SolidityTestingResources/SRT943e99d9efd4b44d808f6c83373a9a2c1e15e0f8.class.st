Class {
	#name : #SRT943e99d9efd4b44d808f6c83373a9a2c1e15e0f8,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT943e99d9efd4b44d808f6c83373a9a2c1e15e0f8 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTU7CgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCiAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICAvLyBTYWZlTWF0aC5zdWIgd2lsbCB0aHJvdyBpZiB0aGVyZSBpcyBub3QgZW5vdWdoIGJhbGFuY2UuCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKfQoKY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9Cgpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwoKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICB1aW50MjU2IF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKCiAgICAvLyBDaGVjayBpcyBub3QgbmVlZGVkIGJlY2F1c2Ugc3ViKF9hbGxvd2FuY2UsIF92YWx1ZSkgd2lsbCBhbHJlYWR5IHRocm93IGlmIHRoaXMgY29uZGl0aW9uIGlzIG5vdCBtZXQKICAgIC8vIHJlcXVpcmUgKF92YWx1ZSA8PSBfYWxsb3dhbmNlKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsKICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAqCiAgICogQmV3YXJlIHRoYXQgY2hhbmdpbmcgYW4gYWxsb3dhbmNlIHdpdGggdGhpcyBtZXRob2QgYnJpbmdzIHRoZSByaXNrIHRoYXQgc29tZW9uZSBtYXkgdXNlIGJvdGggdGhlIG9sZAogICAqIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZSB0cmFuc2FjdGlvbiBvcmRlcmluZy4gT25lIHBvc3NpYmxlIHNvbHV0aW9uIHRvIG1pdGlnYXRlIHRoaXMKICAgKiByYWNlIGNvbmRpdGlvbiBpcyB0byBmaXJzdCByZWR1Y2UgdGhlIHNwZW5kZXIncyBhbGxvd2FuY2UgdG8gMCBhbmQgc2V0IHRoZSBkZXNpcmVkIHZhbHVlIGFmdGVyd2FyZHM6CiAgICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogIH0KCiAgLyoqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlKQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOwogICAgfSBlbHNlIHsKICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBvbGRWYWx1ZS5zdWIoX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKfQoKY29udHJhY3QgTWludGFibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwogIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwoKICBib29sIHB1YmxpYyBtaW50aW5nRmluaXNoZWQgPSBmYWxzZTsKCgogIG1vZGlmaWVyIGNhbk1pbnQoKSB7CiAgICByZXF1aXJlKCFtaW50aW5nRmluaXNoZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gbWludCB0b2tlbnMKICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCByZWNlaXZlIHRoZSBtaW50ZWQgdG9rZW5zLgogICAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIG1pbnQuCiAgICogQHJldHVybiBBIGJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIG9ubHlPd25lciBjYW5NaW50IHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfYW1vdW50KTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfYW1vdW50KTsKICAgIE1pbnQoX3RvLCBfYW1vdW50KTsKICAgIFRyYW5zZmVyKDB4MCwgX3RvLCBfYW1vdW50KTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBzdG9wIG1pbnRpbmcgbmV3IHRva2Vucy4KICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBmaW5pc2hNaW50aW5nKCkgb25seU93bmVyIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBtaW50aW5nRmluaXNoZWQgPSB0cnVlOwogICAgTWludEZpbmlzaGVkKCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCmNvbnRyYWN0IElEZWFsVG9rZW4gewogICAgZnVuY3Rpb24gc3BlbmQoYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7Cn0KCmNvbnRyYWN0IERlYWxUb2tlbiBpcyBNaW50YWJsZVRva2VuLCBJRGVhbFRva2VuIHsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJEZWFsIFRva2VuIjsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIkRFQUwiOwogICAgdWludDggcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMDsKCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFRva2Vuc0J1cm50ID0gMDsKCiAgICBldmVudCBUb2tlbnNTcGVudChhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlKTsKCiAgICAvKioKICAgICAqIEBkZXYgLSBFbXB0eSBjb25zdHJ1Y3RvcgogICAgICovCiAgICBmdW5jdGlvbiBEZWFsVG9rZW4oKSBwdWJsaWMgeyB9CgogICAgLyoqCiAgICAgKiBAZGV2IC0gRnVuY3Rpb24gdGhhdCBhbGxvd3MgZm9yZWdyb3VuZCBjb250cmFjdCB0byBzcGVuZCAoYnVybikgdGhlIHRva2Vucy4KICAgICAqIEBwYXJhbSBfZnJvbSAtIEFjY291bnQgdG8gd2l0aGRyYXcgZnJvbS4KICAgICAqIEBwYXJhbSBfdmFsdWUgLSBOdW1iZXIgb2YgdG9rZW5zIHRvIHdpdGhkcmF3LgogICAgICogQHJldHVybiAtIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAgICovCiAgICBmdW5jdGlvbiBzcGVuZChhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF92YWx1ZSA+IDApOwoKICAgICAgICBpZiAoYmFsYW5jZXNbX2Zyb21dIDwgX3ZhbHVlIHx8IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdIDwgX3ZhbHVlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgICAgIHRvdGFsVG9rZW5zQnVybnQgPSB0b3RhbFRva2Vuc0J1cm50LmFkZChfdmFsdWUpOwogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuc3ViKF92YWx1ZSk7CiAgICAgICAgVG9rZW5zU3BlbnQoX2Zyb20sIF92YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IC0gQWxsb3cgYW5vdGhlciBjb250cmFjdCB0byBzcGVuZCBzb21lIHRva2VucyBvbiB5b3VyIGJlaGFsZgogICAgICogQHBhcmFtIF9zcGVuZGVyIC0gQ29udHJhY3QgdGhhdCB3aWxsIHNwZW5kIHRoZSB0b2tlbnMKICAgICAqIEBwYXJhbSBfdmFsdWUgLSBBbW91bnQgb2YgdG9rZW5zIHRvIHNwZW5kCiAgICAgKiBAcGFyYW0gX2V4dHJhRGF0YSAtIEFkZGl0aW9uYWwgZGF0YSB0byBwYXNzIHRvIHRoZSByZWNlaXZlQXBwcm92YWwKICAgICAqIEByZXR1cm4gLSAgQSBib29sZWFuIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFwcHJvdmVBbmRDYWxsKElUb2tlblJlY2lwaWVudCBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9leHRyYURhdGEpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICAgICAgX3NwZW5kZXIucmVjZWl2ZUFwcHJvdmFsKG1zZy5zZW5kZXIsIF92YWx1ZSwgdGhpcywgX2V4dHJhRGF0YSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0KCmNvbnRyYWN0IElGb3JlZ3JvdW5kIHsKICAgIGZ1bmN0aW9uIHBheUNvbnZlcnNpb25Gcm9tVHJhbnNhY3Rpb24odWludDI1NiBfcHJvbW90aW9uSUQsIGFkZHJlc3MgX3JlY2lwaWVudEFkZHJlc3MsIHVpbnQyNTYgX3RyYW5zYWN0aW9uQW1vdW50KSBleHRlcm5hbCBwYXlhYmxlOwogICAgZnVuY3Rpb24gY3JlYXRlTmV3RHluYW1pY1BheW1lbnRBZGRyZXNzKHVpbnQyNTYgX3Byb21vdGlvbklELCBhZGRyZXNzIHJlZmVycmVyKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZVRvdGFsRHVlKHVpbnQyNTYgX3Byb21vdGlvbklELCB1aW50MjU2IF90cmFuc2FjdGlvbkFtb3VudCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgX3RvdGFsUGF5bWVudCk7Cn0KCmNvbnRyYWN0IElGb3JlZ3JvdW5kRW5hYmxlZENvbnRyYWN0IHsKICAgZnVuY3Rpb24gcmVjZWl2ZUV0aGVyRnJvbUZvcmVncm91bmRBZGRyZXNzKGFkZHJlc3MgX29yaWdpbmF0aW5nQWRkcmVzcywgYWRkcmVzcyBfcmVsYXllZEZyb21BZGRyZXNzLCB1aW50MjU2IF9wcm9tb3Rpb25JRCwgYWRkcmVzcyBfcmVmZXJyZXIpIHB1YmxpYyBwYXlhYmxlOwp9Cgpjb250cmFjdCBGb3JlZ3JvdW5kQ2FsbGVyIGlzIElGb3JlZ3JvdW5kRW5hYmxlZENvbnRyYWN0IHsKICAgIElGb3JlZ3JvdW5kIHB1YmxpYyBmb3JlZ3JvdW5kOwoKICAgIGZ1bmN0aW9uIEZvcmVncm91bmRDYWxsZXIoSUZvcmVncm91bmQgX2ZvcmVncm91bmQpIHB1YmxpYyB7CiAgICAgICAgZm9yZWdyb3VuZCA9IF9mb3JlZ3JvdW5kOwogICAgfQoKICAgIC8vVGhpcyBldmVudCBpcyB1c2VmdWwgZm9yIHRlc3Rpbmcgd2hldGhlciBhIGNvbnRyYWN0IGhhcyBpbXBsZW1lbnRlZCBGb3JlZ3JvdW5kIGNvcnJlY3RseQogICAgLy9JdCBjYW4gZXZlbiBiZSB1c2VkIHByaW9yIHRvIHRoZSBpbXBsZW1lbnRpbmcgY29udHJhY3QgZ29pbmcgbGl2ZQogICAgZXZlbnQgRXRoZXJSZWNlaXZlZEZyb21SZWxheShhZGRyZXNzIGluZGV4ZWQgX29yaWdpbmF0aW5nQWRkcmVzcywgdWludDI1NiBpbmRleGVkIF9wcm9tb3Rpb25JRCwgYWRkcmVzcyBpbmRleGVkIF9yZWZlcnJlcik7CiAgICBldmVudCBGb3JlZ3JvdW5kUGF5bWVudFJlc3VsdChib29sIF9zdWNjZXNzLCB1aW50MjU2IGluZGV4ZWQgX3Byb21vdGlvbklELCBhZGRyZXNzIGluZGV4ZWQgX3JlZmVycmVyLCB1aW50MjU2IF92YWx1ZSk7CiAgICBldmVudCBDb250cmFjdEZ1bmRlZChhZGRyZXNzIGluZGV4ZWQgX3NlbmRlciwgdWludDI1NiBfdmFsdWUpOwoKICAgIC8vTm90ZTogd2UgZG9uJ3QgdXNlIHRoZSAicmVsYXllZEZyb21BZGRyZXNzIiB2YXJpYWJsZSBoZXJlLCBidXQgaXQgc2VlbXMgbGlrZSBpdCBzaG91bGQgc3RpbGwgYmUgcGFydCBvZiB0aGUgQVBJCiAgICBmdW5jdGlvbiByZWNlaXZlRXRoZXJGcm9tRm9yZWdyb3VuZEFkZHJlc3MoYWRkcmVzcyBfb3JpZ2luYXRpbmdBZGRyZXNzLCBhZGRyZXNzIF9yZWxheWVkRnJvbUFkZHJlc3MsIHVpbnQyNTYgX3Byb21vdGlvbklELCBhZGRyZXNzIF9yZWZlcnJlcikgcHVibGljIHBheWFibGUgewogICAgICAgIC8vTk9URTogYXZhaWxhYmxlIEV0aGVyIG1heSBiZSBsZXNzIHRoYW4gbXNnLnZhbHVlIGFmdGVyIHRoaXMgY2FsbAogICAgICAgIC8vTk9URTogb3JpZ2luYXRpbmdBZGRyZXNzIGluZGljYXRlcyB0aGUgdHJ1ZSBzZW5kZXIgb2YgdGhlIGZ1bmRzIGF0IHRoaXMgcG9pbnQsIG5vdCBtc2cuc2VuZGVyCiAgICAgICAgRXRoZXJSZWNlaXZlZEZyb21SZWxheShfb3JpZ2luYXRpbmdBZGRyZXNzLCBfcHJvbW90aW9uSUQsIF9yZWZlcnJlcik7CgogICAgICAgIHVpbnQyNTYgX2Ftb3VudFNwZW50ID0gcmVjZWl2ZUV0aGVyRnJvbVJlbGF5QWRkcmVzcyhfb3JpZ2luYXRpbmdBZGRyZXNzLCBtc2cudmFsdWUpOwoKICAgICAgICAvL05PVEU6IFRoaXMgbWFrZXMgYSBjYWxsIHRvIGFuIGV4dGVybmFsIGNvbnRyYWN0IChGb3JlZ3JvdW5kKSwgYnV0IGRvZXMgbm90IHVzZSAuY2FsbCAtLSB0aGlzIHNlZW1zIHVuYXZvaWRhYmxlCiAgICAgICAgdWludDI1NiBfcGF5bWVudFRvRm9yZWdyb3VuZCA9IGZvcmVncm91bmQuY2FsY3VsYXRlVG90YWxEdWUoX3Byb21vdGlvbklELCBfYW1vdW50U3BlbnQpOwogICAgICAgIC8vTk9URTogVXNpbmcgLmNhbGwgaW4gb3JkZXIgdG8gc3dhbGxvdyBhbnkgZXhjZXB0aW9ucwogICAgICAgIGJvb2wgX3N1Y2Nlc3MgPSBmb3JlZ3JvdW5kLmNhbGwuZ2FzKDEwMDAwMDApLnZhbHVlKF9wYXltZW50VG9Gb3JlZ3JvdW5kKShieXRlczQoa2VjY2FrMjU2KCJwYXlDb252ZXJzaW9uRnJvbVRyYW5zYWN0aW9uKHVpbnQyNTYsYWRkcmVzcyx1aW50MjU2KSIpKSwgX3Byb21vdGlvbklELCBfcmVmZXJyZXIsIF9hbW91bnRTcGVudCk7CiAgICAgICAgRm9yZWdyb3VuZFBheW1lbnRSZXN1bHQoX3N1Y2Nlc3MsIF9wcm9tb3Rpb25JRCwgX3JlZmVycmVyLCBtc2cudmFsdWUpOwogICAgfQoKICAgIC8vQWJzdHJhY3QgZnVuY3Rpb24gdG8gYmUgaW1wbGVtZW50ZWQgYnkgYWR2ZXJ0aXNlcidzIGNvbnRyYWN0CiAgICBmdW5jdGlvbiByZWNlaXZlRXRoZXJGcm9tUmVsYXlBZGRyZXNzKGFkZHJlc3MgX29yaWdpbmF0aW5nQWRkcmVzcywgdWludDI1NiBfYW1vdW50KSBpbnRlcm5hbCByZXR1cm5zKHVpbnQyNTYgX2Ftb3VudFNwZW50KTsKCiAgICAvL0Z1bmN0aW9uIGFsbG93cyBmb3IgYWRkaXRpb25hbCBmdW5kcyB0byBiZSBhZGRlZCB0byB0aGUgY29udHJhY3QgKHdpdGhvdXQgcHVyY2hhc2luZyB0b2tlbnMpCiAgICBmdW5jdGlvbiBmdW5kQ29udHJhY3QoKSBwYXlhYmxlIHsKICAgICAgICBDb250cmFjdEZ1bmRlZChtc2cuc2VuZGVyLCBtc2cudmFsdWUpOwogICAgfQp9Cgpjb250cmFjdCBGb3JlZ3JvdW5kVG9rZW5TYWxlIGlzIE93bmFibGUsIEZvcmVncm91bmRDYWxsZXIgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgdWludDI1NiBwdWJsaWMgcHVibGljVG9rZW5DYXA7CiAgICB1aW50MjU2IHB1YmxpYyBiYXNlVG9rZW5QcmljZTsKICAgIHVpbnQyNTYgcHVibGljIGN1cnJlbnRUb2tlblByaWNlOwoKICAgIHVpbnQyNTYgcHVibGljIHByaWNlU3RlcER1cmF0aW9uOwoKICAgIHVpbnQyNTYgcHVibGljIG51bWJlck9mUGFydGljaXBhbnRzOwogICAgdWludDI1NiBwdWJsaWMgbWF4U2FsZUJhbGFuY2U7CiAgICB1aW50MjU2IHB1YmxpYyBtaW5TYWxlQmFsYW5jZTsKICAgIHVpbnQyNTYgcHVibGljIHNhbGVCYWxhbmNlOwogICAgdWludDI1NiBwdWJsaWMgdG9rZW5CYWxhbmNlOwoKICAgIHVpbnQyNTYgcHVibGljIHN0YXJ0QmxvY2s7CiAgICB1aW50MjU2IHB1YmxpYyBlbmRCbG9jazsKCiAgICBhZGRyZXNzIHB1YmxpYyBzYWxlV2FsbGV0QWRkcmVzczsKCiAgICBhZGRyZXNzIHB1YmxpYyBkZXZUZWFtVG9rZW5BZGRyZXNzOwogICAgYWRkcmVzcyBwdWJsaWMgcGFydG5lcnNoaXBzVG9rZW5BZGRyZXNzOwogICAgYWRkcmVzcyBwdWJsaWMgaW5jZW50aXZlVG9rZW5BZGRyZXNzOwogICAgYWRkcmVzcyBwdWJsaWMgYm91bnR5VG9rZW5BZGRyZXNzOwoKICAgIGJvb2wgcHVibGljIHNhbGVTdXNwZW5kZWQgPSBmYWxzZTsKCiAgICBEZWFsVG9rZW4gcHVibGljIGRlYWxUb2tlbjsKICAgIFNhbGVTdGF0ZSBwdWJsaWMgc3RhdGU7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBQdXJjaGFzZURldGFpbHMpIHB1YmxpYyBwdXJjaGFzZXM7CgogICAgc3RydWN0IFB1cmNoYXNlRGV0YWlscyB7CiAgICAgICAgdWludDI1NiB0b2tlbkJhbGFuY2U7CiAgICAgICAgdWludDI1NiB3ZWlCYWxhbmNlOwogICAgfQoKICAgIGVudW0gU2FsZVN0YXRlIHtQcmVwYXJlZCwgRGVwbG95ZWQsIENvbmZpZ3VyZWQsIFN0YXJ0ZWQsIEVuZGVkLCBGaW5hbGl6ZWQsIFJlZnVuZGluZ30KCiAgICBldmVudCBUb2tlblB1cmNoYXNlZChhZGRyZXNzIGluZGV4ZWQgYnV5ZXIsIHVpbnQyNTYgdG9rZW5QcmljZSwgdWludDI1NiB0eEFtb3VudCwgdWludDI1NiBhY3R1YWxQdXJjaGFzZUFtb3VudCwgdWludDI1NiByZWZ1bmRlZEFtb3VudCwgdWludDI1NiB0b2tlbnNQdXJjaGFzZWQpOwogICAgZXZlbnQgU2FsZVN0YXJ0ZWQoKTsKICAgIGV2ZW50IFNhbGVFbmRlZCgpOwogICAgZXZlbnQgQ2xhaW1lZChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIHVpbnQyNTYgdG9rZW5zQ2xhaW1lZCk7CiAgICBldmVudCBSZWZ1bmRlZChhZGRyZXNzIGluZGV4ZWQgYnV5ZXIsIHVpbnQyNTYgYW1vdW50UmVmdW5kZWQpOwoKICAgIC8qKgogICAgICogQGRldiAtIG1vZGlmaWVyIHRoYXQgZXZhbHVhdGVzIHdoaWNoIHN0YXRlIHRoZSBzYWxlIHNob3VsZCBiZSBpbi4gRnVuY3Rpb25zIHRoYXQgdXNlIHRoaXMgbW9kaWZpZXIgY2Fubm90IGJlIGNvbnN0YW50IGR1ZSB0byBwb3RlbnRpYWwgc3RhdGUgY2hhbmdlCiAgICAgKi8KICAgIG1vZGlmaWVyIGV2YWx1YXRlU2FsZVN0YXRlIHsKICAgICAgICByZXF1aXJlKHNhbGVTdXNwZW5kZWQgPT0gZmFsc2UpOwoKICAgICAgICBpZiAoc3RhdGUgPT0gU2FsZVN0YXRlLkNvbmZpZ3VyZWQgJiYgYmxvY2subnVtYmVyID49IHN0YXJ0QmxvY2spIHsKICAgICAgICAgICAgc3RhdGUgPSBTYWxlU3RhdGUuU3RhcnRlZDsKICAgICAgICAgICAgU2FsZVN0YXJ0ZWQoKTsKICAgICAgICB9CgogICAgICAgIGlmIChzdGF0ZSA9PSBTYWxlU3RhdGUuU3RhcnRlZCkgewogICAgICAgICAgICBzZXRDdXJyZW50UHJpY2UoKTsKICAgICAgICB9CgogICAgICAgIGlmIChzdGF0ZSA9PSBTYWxlU3RhdGUuU3RhcnRlZCAmJiAoYmxvY2subnVtYmVyID4gZW5kQmxvY2sgfHwgc2FsZUJhbGFuY2UgPT0gbWF4U2FsZUJhbGFuY2UgfHwgbWF4U2FsZUJhbGFuY2Uuc3ViKHNhbGVCYWxhbmNlKSA8IGN1cnJlbnRUb2tlblByaWNlKSkgewogICAgICAgICAgICBlbmRTYWxlKCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoc3RhdGUgPT0gU2FsZVN0YXRlLkVuZGVkKSB7CiAgICAgICAgICAgIGZpbmFsaXplU2FsZSgpOwogICAgICAgIH0KICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiAtIENvbnN0cnVjdG9yIGZvciB0aGUgRm9yZWdyb3VuZCB0b2tlbiBzYWxlIGNvbnRyYWN0CiAgICAgKiBAcGFyYW0gX3B1YmxpY1Rva2VuQ2FwIC0gTWF4IG51bWJlciBvZiB0b2tlbnMgbWFkZSBhdmFpbGFibGUgdG8gdGhlIHB1YmxpYwogICAgICogQHBhcmFtIF90b2tlbkZsb29yIC0gTWluIG51bWJlciBvZiB0b2tlbnMgdG8gYmUgc29sZCB0byBiZSBjb25zaWRlcmVkIGEgc3VjY2Vzc2Z1bCBzYWxlCiAgICAgKiBAcGFyYW0gX3Rva2VuUmF0ZSAtIEluaXRpYWwgcHJpY2UgcGVyIHRva2VuCiAgICAgKiBAcGFyYW0gX2ZvcmVncm91bmQgLSBBZGRyZXNzIG9mIHRoZSBGb3JlZ3JvdW5kIGNvbnRyYWN0IHRoYXQgZ2V0cyBwYXNzZWQgb24gdG8gRm9yZWdyb3VuZENhbGxlcgogICAgICovCiAgICBmdW5jdGlvbiBGb3JlZ3JvdW5kVG9rZW5TYWxlKAogICAgICAgIHVpbnQyNTYgX3B1YmxpY1Rva2VuQ2FwLAogICAgICAgIHVpbnQyNTYgX3Rva2VuRmxvb3IsCiAgICAgICAgdWludDI1NiBfdG9rZW5SYXRlLAogICAgICAgIElGb3JlZ3JvdW5kIF9mb3JlZ3JvdW5kCiAgICApCiAgICAgICAgcHVibGljCiAgICAgICAgRm9yZWdyb3VuZENhbGxlcihfZm9yZWdyb3VuZCkKICAgIHsKICAgICAgICByZXF1aXJlKF9wdWJsaWNUb2tlbkNhcCA+IDApOwogICAgICAgIHJlcXVpcmUoX3Rva2VuRmxvb3IgPCBfcHVibGljVG9rZW5DYXApOwogICAgICAgIHJlcXVpcmUoX3Rva2VuUmF0ZSA+IDApOwoKICAgICAgICBwdWJsaWNUb2tlbkNhcCA9IF9wdWJsaWNUb2tlbkNhcDsKICAgICAgICBiYXNlVG9rZW5QcmljZSA9IF90b2tlblJhdGU7CiAgICAgICAgY3VycmVudFRva2VuUHJpY2UgPSBfdG9rZW5SYXRlOwoKICAgICAgICBkZWFsVG9rZW4gPSBuZXcgRGVhbFRva2VuKCk7CiAgICAgICAgbWF4U2FsZUJhbGFuY2UgPSBwdWJsaWNUb2tlbkNhcC5tdWwoY3VycmVudFRva2VuUHJpY2UpOwogICAgICAgIG1pblNhbGVCYWxhbmNlID0gX3Rva2VuRmxvb3IubXVsKGN1cnJlbnRUb2tlblByaWNlKTsKICAgICAgICBzdGF0ZSA9IFNhbGVTdGF0ZS5EZXBsb3llZDsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgLSBEZWZhdWx0IHBheWFibGUgZnVuY3Rpb24uIFdpbGwgcmVzdWx0IGluIHRva2VucyBiZWluZyBwdXJjaGFzZWQKICAgICAqLwogICAgZnVuY3Rpb24oKSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgcHVyY2hhc2VUb2tlbihtc2cuc2VuZGVyLCBtc2cudmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiAtIENvbmZpZ3VyZSBzcGVjaWZpYyBwYXJhbXMgb2YgdGhlIHNhbGUuIENhbiBvbmx5IGJlIGNhbGxlZCBvbmNlCiAgICAgKiBAcGFyYW0gX3N0YXJ0QmxvY2sgLSBCbG9jayB0aGUgc2FsZSBzaG91bGQgc3RhcnQgYXQKICAgICAqIEBwYXJhbSBfZW5kQmxvY2sgLSBCbG9jayB0aGUgc2FsZSBzaG91bGQgZW5kIGF0CiAgICAgKiBAcGFyYW0gX3dhbGxldCAtIFNhbGUgd2FsbGV0IGFkZHJlc3MgLSBmdW5kcyB3aWxsIGJlIHRyYW5zZmVycmVkIGhlcmUgb25jZSBzYWxlIGlzIGRvbmUKICAgICAqIEBwYXJhbSBfc3RlcER1cmF0aW9uIC0gSG93IG1hbnkgYmxvY2tzIHRvIHdhaXQgdG8gaW5jcmVhc2UgcHJpY2UKICAgICAqIEBwYXJhbSBfZGV2QWRkcmVzcyAtIEFkZHJlc3MgZm9yIHRoZSB0b2tlbnMgZGlzdHJpYnV0ZWQgZm9yIEZvcmVncm91bmQgZGV2ZWxvcG1lbnQgcHVycG9zZXMKICAgICAqIEBwYXJhbSBfcGFydG5lcnNoaXBBZGRyZXNzIC0gQWRkcmVzcyBmb3IgdGhlIHRva2VucyBkaXN0cmlidXRlZCBmb3IgRm9yZWdyb3VuZCBwYXJ0bmVyc2hpcHMKICAgICAqIEBwYXJhbSBfaW5jZW50aXZlQWRkcmVzcyAtIEFkZHJlc3MgZm9yIHRoZSB0b2tlbnMgZGlzdHJpYnV0ZWQgZm9yIEZvcmVncm91bmQgaW5jZW50aXZlcwogICAgICogQHBhcmFtIF9ib3VudHlBZGRyZXNzIC0gQWRkcmVzcyBmb3IgdGhlIHRva2VucyBkaXN0cmlidXRlZCBmb3IgRm9yZWdyb3VuZCBib3VudGllcwogICAgICovCiAgICBmdW5jdGlvbiBjb25maWd1cmVTYWxlKAogICAgICAgIHVpbnQyNTYgX3N0YXJ0QmxvY2ssCiAgICAgICAgdWludDI1NiBfZW5kQmxvY2ssCiAgICAgICAgYWRkcmVzcyBfd2FsbGV0LAogICAgICAgIHVpbnQyNTYgX3N0ZXBEdXJhdGlvbiwKICAgICAgICBhZGRyZXNzIF9kZXZBZGRyZXNzLAogICAgICAgIGFkZHJlc3MgX3BhcnRuZXJzaGlwQWRkcmVzcywKICAgICAgICBhZGRyZXNzIF9pbmNlbnRpdmVBZGRyZXNzLAogICAgICAgIGFkZHJlc3MgX2JvdW50eUFkZHJlc3MKICAgICkKICAgICAgICBleHRlcm5hbAogICAgICAgIG9ubHlPd25lcgogICAgewogICAgICAgIHJlcXVpcmUoX3N0YXJ0QmxvY2sgPj0gYmxvY2subnVtYmVyKTsKICAgICAgICByZXF1aXJlKF9lbmRCbG9jayA+PSBfc3RhcnRCbG9jayk7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTYWxlU3RhdGUuRGVwbG95ZWQpOwogICAgICAgIHJlcXVpcmUoX3dhbGxldCAhPSAweDApOwogICAgICAgIHJlcXVpcmUoX3N0ZXBEdXJhdGlvbiA+IDApOwogICAgICAgIHJlcXVpcmUoX2RldkFkZHJlc3MgIT0gMHgwKTsKICAgICAgICByZXF1aXJlKF9wYXJ0bmVyc2hpcEFkZHJlc3MgIT0gMHgwKTsKICAgICAgICByZXF1aXJlKF9pbmNlbnRpdmVBZGRyZXNzICE9IDB4MCk7CiAgICAgICAgcmVxdWlyZShfYm91bnR5QWRkcmVzcyAhPSAweDApOwoKICAgICAgICBzdGF0ZSA9IFNhbGVTdGF0ZS5Db25maWd1cmVkOwogICAgICAgIHN0YXJ0QmxvY2sgPSBfc3RhcnRCbG9jazsKICAgICAgICBlbmRCbG9jayA9IF9lbmRCbG9jazsKICAgICAgICBzYWxlV2FsbGV0QWRkcmVzcyA9IF93YWxsZXQ7CiAgICAgICAgcHJpY2VTdGVwRHVyYXRpb24gPSBfc3RlcER1cmF0aW9uOwogICAgICAgIGRldlRlYW1Ub2tlbkFkZHJlc3MgPSBfZGV2QWRkcmVzczsKICAgICAgICBwYXJ0bmVyc2hpcHNUb2tlbkFkZHJlc3MgPSBfcGFydG5lcnNoaXBBZGRyZXNzOwogICAgICAgIGluY2VudGl2ZVRva2VuQWRkcmVzcyA9IF9pbmNlbnRpdmVBZGRyZXNzOwogICAgICAgIGJvdW50eVRva2VuQWRkcmVzcyA9IF9ib3VudHlBZGRyZXNzOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiAtIENsYWltIHRva2VucyBvbmNlIHNhbGUgaXMgb3ZlcgogICAgICovCiAgICBmdW5jdGlvbiBjbGFpbVRva2VuKCkKICAgICAgICBleHRlcm5hbAogICAgICAgIGV2YWx1YXRlU2FsZVN0YXRlCiAgICB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTYWxlU3RhdGUuRmluYWxpemVkKTsKICAgICAgICByZXF1aXJlKHB1cmNoYXNlc1ttc2cuc2VuZGVyXS50b2tlbkJhbGFuY2UgPiAwKTsKCiAgICAgICAgdWludDI1NiBfdG9rZW5zUHVyY2hhc2VkID0gcHVyY2hhc2VzW21zZy5zZW5kZXJdLnRva2VuQmFsYW5jZTsKICAgICAgICBwdXJjaGFzZXNbbXNnLnNlbmRlcl0udG9rZW5CYWxhbmNlID0gMDsKICAgICAgICBwdXJjaGFzZXNbbXNnLnNlbmRlcl0ud2VpQmFsYW5jZSA9IDA7CgogICAgICAgIC8qIFRyYW5zZmVyIHRoZSB0b2tlbnMgKi8KICAgICAgICBkZWFsVG9rZW4udHJhbnNmZXIobXNnLnNlbmRlciwgX3Rva2Vuc1B1cmNoYXNlZCk7CiAgICAgICAgQ2xhaW1lZChtc2cuc2VuZGVyLCBfdG9rZW5zUHVyY2hhc2VkKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgLSBDbGFpbSBhIHJlZnVuZCBpZiB0aGUgdG9rZW4gc2FsZSBkaWQgbm90IHJlYWNoIGl0cyBtaW5pbXVtIHZhbHVlCiAgICAgKi8KICAgIGZ1bmN0aW9uIGNsYWltUmVmdW5kKCkKICAgICAgICBleHRlcm5hbAogICAgewogICAgICAgIHJlcXVpcmUoc3RhdGUgPT0gU2FsZVN0YXRlLlJlZnVuZGluZyk7CgogICAgICAgIHVpbnQyNTYgX2Ftb3VudFRvUmVmdW5kID0gcHVyY2hhc2VzW21zZy5zZW5kZXJdLndlaUJhbGFuY2U7CiAgICAgICAgcmVxdWlyZShfYW1vdW50VG9SZWZ1bmQgPiAwKTsKICAgICAgICBwdXJjaGFzZXNbbXNnLnNlbmRlcl0ud2VpQmFsYW5jZSA9IDA7CiAgICAgICAgcHVyY2hhc2VzW21zZy5zZW5kZXJdLnRva2VuQmFsYW5jZSA9IDA7CiAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihfYW1vdW50VG9SZWZ1bmQpOwogICAgICAgIFJlZnVuZGVkKG1zZy5zZW5kZXIsIF9hbW91bnRUb1JlZnVuZCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IC0gQWJpbGl0eSBmb3IgY29udHJhY3Qgb3duZXIgdG8gc3VzcGVuZCB0aGUgc2FsZSBpZiBuZWNlc3NhcnkKICAgICAqIEBwYXJhbSBfc3VzcGVuZCAtIEJvb2xlYW4gdmFsdWUgdG8gaW5kaWNhdGUgd2hldGhlciB0aGUgc2FsZSBpcyBzdXNwZW5kZWQgb3Igbm90CiAgICAgKi8KICAgIGZ1bmN0aW9uIHN1c3BlbmRTYWxlKGJvb2wgX3N1c3BlbmQpCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICBvbmx5T3duZXIKICAgIHsKICAgICAgICBzYWxlU3VzcGVuZGVkID0gX3N1c3BlbmQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IC0gUmV0dXJucyB0aGUgY29ycmVjdCBzYWxlIHN0YXRlIGJhc2VkIG9uIHRoZSBjdXJyZW50IGJsb2NrIG51bWJlcgogICAgICogQHJldHVybiAtIGN1cnJlbnQgc2FsZSBzdGF0ZSBhbmQgY3VycmVudCBzYWxlIHByaWNlCiAgICAgKi8KICAgIGZ1bmN0aW9uIHVwZGF0ZUxhdGVzdFNhbGVTdGF0ZSgpCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICBldmFsdWF0ZVNhbGVTdGF0ZQogICAgICAgIHJldHVybnMgKHVpbnQyNTYpCiAgICB7CiAgICAgICAgcmV0dXJuIHVpbnQyNTYoc3RhdGUpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiAtIFB1cmNoYXNlIGEgREVBTCB0b2tlbi4gU2FsZSBtdXN0IGJlIGluIHRoZSBjb3JyZWN0IHN0YXRlCiAgICAgKiBAcGFyYW0gX3JlY2lwaWVudCAtIGFkZHJlc3MgdG8gYXNzaWduIHRoZSBwdXJjaGFzZWQgdG9rZW5zIHRvCiAgICAgKiBAcGFyYW0gX2Ftb3VudCAtIGV0aCB2YWx1ZSBvZiB0b2tlbnMgdG8gYmUgcHVyY2hhc2VkCiAgICAgKi8KICAgIGZ1bmN0aW9uIHB1cmNoYXNlVG9rZW4oYWRkcmVzcyBfcmVjaXBpZW50LCB1aW50MjU2IF9hbW91bnQpCiAgICAgICAgaW50ZXJuYWwKICAgICAgICBldmFsdWF0ZVNhbGVTdGF0ZQogICAgICAgIHJldHVybnMgKHVpbnQyNTYpCiAgICB7CiAgICAgICAgcmVxdWlyZShzdGF0ZSA9PSBTYWxlU3RhdGUuU3RhcnRlZCk7CiAgICAgICAgcmVxdWlyZShfYW1vdW50ID49IGN1cnJlbnRUb2tlblByaWNlKTsKCiAgICAgICAgdWludDI1NiBfc2FsZVJlbWFpbmluZ0JhbGFuY2UgPSBtYXhTYWxlQmFsYW5jZS5zdWIoc2FsZUJhbGFuY2UpOwogICAgICAgIGJvb2wgX3Nob3VsZEVuZFNhbGUgPSBmYWxzZTsKCiAgICAgICAgLyogRW5zdXJlIHB1cmNoYXNlQW1vdW50IGJ1eXMgZXhhY3QgYW1vdW50IG9mIHRva2VucywgcmVmdW5kIHRoZSByZXN0IGltbWVkaWF0ZWx5ICovCiAgICAgICAgdWludDI1NiBfYW1vdW50VG9SZWZ1bmQgPSBfYW1vdW50ICUgY3VycmVudFRva2VuUHJpY2U7CiAgICAgICAgdWludDI1NiBfcHVyY2hhc2VBbW91bnQgPSBfYW1vdW50LnN1YihfYW1vdW50VG9SZWZ1bmQpOwoKICAgICAgICAvKiBUaGlzIHB1cmNoYXNlIHdpbGwgcHVzaCB1cyBvdmVyIHRoZSBtYXggYmFsYW5jZSAtIHNvIHJlZnVuZCB0aGF0IGFtb3VudCB0aGF0IGlzIG92ZXIgKi8KICAgICAgICBpZiAoX3NhbGVSZW1haW5pbmdCYWxhbmNlIDwgX3B1cmNoYXNlQW1vdW50KSB7CiAgICAgICAgICAgIHVpbnQyNTYgX2VuZE9mU2FsZVJlZnVuZCA9IF9zYWxlUmVtYWluaW5nQmFsYW5jZSAlIGN1cnJlbnRUb2tlblByaWNlOwogICAgICAgICAgICBfYW1vdW50VG9SZWZ1bmQgPSBfYW1vdW50VG9SZWZ1bmQuYWRkKF9wdXJjaGFzZUFtb3VudC5zdWIoX3NhbGVSZW1haW5pbmdCYWxhbmNlKS5hZGQoX2VuZE9mU2FsZVJlZnVuZCkpOwogICAgICAgICAgICBfcHVyY2hhc2VBbW91bnQgPSBfc2FsZVJlbWFpbmluZ0JhbGFuY2Uuc3ViKF9lbmRPZlNhbGVSZWZ1bmQpOwogICAgICAgICAgICBfc2hvdWxkRW5kU2FsZSA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICAvKiBDb3VudCB0aGUgbnVtYmVyIG9mIHVuaXF1ZSBwYXJ0aWNpcGFudHMgKi8KICAgICAgICBpZiAocHVyY2hhc2VzW19yZWNpcGllbnRdLnRva2VuQmFsYW5jZSA9PSAwKSB7CiAgICAgICAgICAgIG51bWJlck9mUGFydGljaXBhbnRzID0gbnVtYmVyT2ZQYXJ0aWNpcGFudHMuYWRkKDEpOwogICAgICAgIH0KCiAgICAgICAgdWludDI1NiBfdG9rZW5zUHVyY2hhc2VkID0gX3B1cmNoYXNlQW1vdW50LmRpdihjdXJyZW50VG9rZW5QcmljZSk7CiAgICAgICAgcHVyY2hhc2VzW19yZWNpcGllbnRdLnRva2VuQmFsYW5jZSA9IHB1cmNoYXNlc1tfcmVjaXBpZW50XS50b2tlbkJhbGFuY2UuYWRkKF90b2tlbnNQdXJjaGFzZWQpOwogICAgICAgIHB1cmNoYXNlc1tfcmVjaXBpZW50XS53ZWlCYWxhbmNlID0gcHVyY2hhc2VzW19yZWNpcGllbnRdLndlaUJhbGFuY2UuYWRkKF9wdXJjaGFzZUFtb3VudCk7CiAgICAgICAgc2FsZUJhbGFuY2UgPSBzYWxlQmFsYW5jZS5hZGQoX3B1cmNoYXNlQW1vdW50KTsKICAgICAgICB0b2tlbkJhbGFuY2UgPSB0b2tlbkJhbGFuY2UuYWRkKF90b2tlbnNQdXJjaGFzZWQpOwoKICAgICAgICBpZiAoX3B1cmNoYXNlQW1vdW50ID09IF9zYWxlUmVtYWluaW5nQmFsYW5jZSB8fCBfc2hvdWxkRW5kU2FsZSkgewogICAgICAgICAgICBlbmRTYWxlKCk7CiAgICAgICAgfQoKICAgICAgICAvKiBSZWZ1bmQgYW1vdW50cyBkdWUgaWYgdGhlcmUgYXJlIGFueSAqLwogICAgICAgIGlmIChfYW1vdW50VG9SZWZ1bmQgPiAwKSB7CiAgICAgICAgICAgIF9yZWNpcGllbnQudHJhbnNmZXIoX2Ftb3VudFRvUmVmdW5kKTsKICAgICAgICB9CgogICAgICAgIFRva2VuUHVyY2hhc2VkKF9yZWNpcGllbnQsIGN1cnJlbnRUb2tlblByaWNlLCBtc2cudmFsdWUsIF9wdXJjaGFzZUFtb3VudCwgX2Ftb3VudFRvUmVmdW5kLCBfdG9rZW5zUHVyY2hhc2VkKTsKICAgICAgICByZXR1cm4gX3B1cmNoYXNlQW1vdW50OwogICAgfQoKICAgIC8qKgogICAgICogQGRldiAtIEltcGxlbWVudGF0aW9uIG9mIEZvcmVncm91bmQgZnVuY3Rpb24gdG8gcmVjZWl2ZSBwYXltZW50CiAgICAgKiBAcGFyYW0gX29yaWdpbmF0aW5nQWRkcmVzcyAtIGFkZHJlc3MgdG8gYXNzaWduIHRoZSBwdXJjaGFzZWQgdG9rZW5zIHRvCiAgICAgKiBAcGFyYW0gX2Ftb3VudCAtIGV0aCB2YWx1ZSBvZiB0b2tlbnMgdG8gYmUgcHVyY2hhc2VkCiAgICAgKiBAcmV0dXJuIC0gVGhlIGFjdHVhbCBhbW91bnQgc3BlbnQgdG8gYnV5IHRva2VucyBhZnRlciB0YWtpbmcgc2FsZSBzdGF0ZSBhbmQgcmVmdW5kcyBpbnRvIGFjY291bnQKICAgICAqLwogICAgZnVuY3Rpb24gcmVjZWl2ZUV0aGVyRnJvbVJlbGF5QWRkcmVzcyhhZGRyZXNzIF9vcmlnaW5hdGluZ0FkZHJlc3MsIHVpbnQyNTYgX2Ftb3VudCkKICAgICAgICBpbnRlcm5hbAogICAgICAgIHJldHVybnMgKHVpbnQyNTYpCiAgICB7CiAgICAgICAgcmV0dXJuIHB1cmNoYXNlVG9rZW4oX29yaWdpbmF0aW5nQWRkcmVzcywgX2Ftb3VudCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IC0gSW50ZXJuYWwgZnVuY3Rpb24gdG8gY2FsY3VsYXRlIGFuZCBzdG9yZSB0aGUgY3VycmVudCB0b2tlbiBwcmljZSBiYXNlZCBvbiBibG9jayBudW1iZXIKICAgICAqLwogICAgZnVuY3Rpb24gc2V0Q3VycmVudFByaWNlKCkgaW50ZXJuYWwgewogICAgICAgIHVpbnQyNTYgX3NhbGVCbG9ja05vID0gYmxvY2subnVtYmVyIC0gc3RhcnRCbG9jazsKICAgICAgICB1aW50MjU2IF9udW1JbmNyZWFzZXMgPSBfc2FsZUJsb2NrTm8uZGl2KHByaWNlU3RlcER1cmF0aW9uKTsKCiAgICAgICAgaWYgKF9udW1JbmNyZWFzZXMgPT0gMCkKICAgICAgICAgICAgY3VycmVudFRva2VuUHJpY2UgPSBiYXNlVG9rZW5QcmljZTsKICAgICAgICBlbHNlIGlmIChfbnVtSW5jcmVhc2VzID09IDEpCiAgICAgICAgICAgIGN1cnJlbnRUb2tlblByaWNlID0gMC4wNiBldGhlcjsKICAgICAgICBlbHNlIGlmIChfbnVtSW5jcmVhc2VzID09IDIpCiAgICAgICAgICAgIGN1cnJlbnRUb2tlblByaWNlID0gMC4wNjUgZXRoZXI7CiAgICAgICAgZWxzZSBpZiAoX251bUluY3JlYXNlcyA9PSAzKQogICAgICAgICAgICBjdXJyZW50VG9rZW5QcmljZSA9IDAuMDcgZXRoZXI7CiAgICAgICAgZWxzZSBpZiAoX251bUluY3JlYXNlcyA+PSA0KQogICAgICAgICAgICBjdXJyZW50VG9rZW5QcmljZSA9IDAuMDggZXRoZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IC0gU2FsZSBlbmQgY29uZGl0aW9uIHJlYWNoZWQsIGRldGVybWluZSBpZiBzYWxlIHdhcyBzdWNjZXNzZnVsIGFuZCBzZXQgc3RhdGUgYWNjb3JkaW5nbHkKICAgICAqLwogICAgZnVuY3Rpb24gZW5kU2FsZSgpIGludGVybmFsIHsKICAgICAgICAvKiBJZiB3ZSBkaWRuJ3QgcmVhY2ggdGhlIG1pbiB2YWx1ZSAtIHNldCBzdGF0ZSB0byByZWZ1bmQgc28gdGhhdCBmdW5kcyBjYW4gcmVjbGFpbWVkIGJ5IHNhbGUgcGFydGljaXBhbnRzICovCiAgICAgICAgaWYgKHNhbGVCYWxhbmNlIDwgbWluU2FsZUJhbGFuY2UpIHsKICAgICAgICAgICAgc3RhdGUgPSBTYWxlU3RhdGUuUmVmdW5kaW5nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0YXRlID0gU2FsZVN0YXRlLkVuZGVkOwogICAgICAgICAgICAvKiBNaW50IHRoZSB0b2tlbnMgYW5kIGRpc3RyaWJ1dGUgaW50ZXJuYWxseSAqLwogICAgICAgICAgICBtaW50VG9rZW5zKCk7CiAgICAgICAgfQogICAgICAgIFNhbGVFbmRlZCgpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiAtIE1pbnRzIHRva2VucyBhbmQgZGlzdHJpYnV0ZXMgcHJlLWFsbG9jYXRlZCB0b2tlbnMgdG8gRm9yZWdyb3VuZCBhZGRyZXNzZXMKICAgICAqLwogICAgZnVuY3Rpb24gbWludFRva2VucygpIGludGVybmFsIHsKICAgICAgICB1aW50MjU2IF90b3RhbFRva2VucyA9ICh0b2tlbkJhbGFuY2UubXVsKDEwICoqIDE4KSkuZGl2KDc0KS5tdWwoMTAwKTsKCiAgICAgICAgLyogTWludCB0aGUgdG9rZW5zIGFuZCBhc3NpZ24gdGhlbSBhbGwgdG8gdGhlIFRva2VuU2FsZUNvbnRyYWN0IGZvciBkaXN0cmlidXRpb24gKi8KICAgICAgICBkZWFsVG9rZW4ubWludChhZGRyZXNzKHRoaXMpLCBfdG90YWxUb2tlbnMuZGl2KDEwICoqIDE4KSk7CgogICAgICAgIC8qIERpc3RyaWJ1dGUgbm9uIHB1YmxpYyB0b2tlbnMgKi8KICAgICAgICBkZWFsVG9rZW4udHJhbnNmZXIoZGV2VGVhbVRva2VuQWRkcmVzcywgKF90b3RhbFRva2Vucy5tdWwoMTApLmRpdigxMDApKS5kaXYoMTAgKiogMTgpKTsKICAgICAgICBkZWFsVG9rZW4udHJhbnNmZXIocGFydG5lcnNoaXBzVG9rZW5BZGRyZXNzLCAoX3RvdGFsVG9rZW5zLm11bCgxMCkuZGl2KDEwMCkpLmRpdigxMCAqKiAxOCkpOwogICAgICAgIGRlYWxUb2tlbi50cmFuc2ZlcihpbmNlbnRpdmVUb2tlbkFkZHJlc3MsIChfdG90YWxUb2tlbnMubXVsKDQpLmRpdigxMDApKS5kaXYoMTAgKiogMTgpKTsKICAgICAgICBkZWFsVG9rZW4udHJhbnNmZXIoYm91bnR5VG9rZW5BZGRyZXNzLCAoX3RvdGFsVG9rZW5zLm11bCgyKS5kaXYoMTAwKSkuZGl2KDEwICoqIDE4KSk7CgogICAgICAgIC8qIEZpbmlzaCBtaW50aW5nIHNvIHRoYXQgbm8gbW9yZSB0b2tlbnMgY2FuIGJlIG1pbnRlZCAqLwogICAgICAgIGRlYWxUb2tlbi5maW5pc2hNaW50aW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IC0gRmluYWxpemVzIHRoZSBzYWxlIHRyYW5zZmVycyB0aGUgY29udHJhY3QgYmFsYW5jZSB0byB0aGUgc2FsZSB3YWxsZXQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGZpbmFsaXplU2FsZSgpIGludGVybmFsIHsKICAgICAgICBzdGF0ZSA9IFNhbGVTdGF0ZS5GaW5hbGl6ZWQ7CiAgICAgICAgLyogVHJhbnNmZXIgY29udHJhY3QgYmFsYW5jZSB0byBzYWxlIHdhbGxldCAqLwogICAgICAgIHNhbGVXYWxsZXRBZGRyZXNzLnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgICB9Cn0KCmNvbnRyYWN0IElUb2tlblJlY2lwaWVudCB7CglmdW5jdGlvbiByZWNlaXZlQXBwcm92YWwoYWRkcmVzcyBfZnJvbSwgdWludCBfdmFsdWUsIGFkZHJlc3MgX3Rva2VuLCBieXRlcyBfZXh0cmFEYXRhKTsKfQ=='.
	

]
