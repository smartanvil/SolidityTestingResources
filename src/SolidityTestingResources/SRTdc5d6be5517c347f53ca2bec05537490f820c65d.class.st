Class {
	#name : #SRTdc5d6be5517c347f53ca2bec05537490f820c65d,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTdc5d6be5517c347f53ca2bec05537490f820c65d >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHRoYXQgYXJlIHNhZmUgZm9yIHVpbnQyNTYgYWdhaW5zdCBvdmVyZmxvdyBhbmQgbmVnYXRpdmUgdmFsdWVzCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXBwZWxpbi1zb2xpZGl0eS9ibG9iL21hc3Rlci9jb250cmFjdHMvbWF0aC9TYWZlTWF0aC5zb2wKICovCgpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKGEgPT0gMCkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9IAoKCgovKioKICogQHRpdGxlIE1vZGVyYXRlZAogKiBAZGV2IHJlc3RyaWN0cyBleGVjdXRpb24gb2YgJ29ubHlNb2RlcmF0b3InIG1vZGlmaWVkIGZ1bmN0aW9ucyB0byB0aGUgY29udHJhY3QgbW9kZXJhdG9yCiAqIEBkZXYgcmVzdHJpY3RzIGV4ZWN1dGlvbiBvZiAnaWZVbnJlc3RyaWN0ZWQnIG1vZGlmaWVkIGZ1bmN0aW9ucyB0byB3aGVuIHVucmVzdHJpY3RlZCAKICogICAgICBib29sZWFuIHN0YXRlIGlzIHRydWUKICogQGRldiBhbGxvd3MgZm9yIHRoZSBleHRyYWN0aW9uIG9mIGV0aGVyIG9yIG90aGVyIEVSQzIwIHRva2VucyBtaXN0YWtlbmx5IHNlbnQgdG8gdGhpcyBhZGRyZXNzCiAqLwpjb250cmFjdCBNb2RlcmF0ZWQgewogICAgCiAgICBhZGRyZXNzIHB1YmxpYyBtb2RlcmF0b3I7CiAgICAKICAgIGJvb2wgcHVibGljIHVucmVzdHJpY3RlZDsKICAgIAogICAgbW9kaWZpZXIgb25seU1vZGVyYXRvciB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG1vZGVyYXRvcik7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgbW9kaWZpZXIgaWZVbnJlc3RyaWN0ZWQgewogICAgICAgIHJlcXVpcmUodW5yZXN0cmljdGVkKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICBtb2RpZmllciBvbmx5UGF5bG9hZFNpemUodWludDI1NiBudW1Xb3JkcykgewogICAgICAgIGFzc2VydChtc2cuZGF0YS5sZW5ndGggPj0gbnVtV29yZHMgKiAzMiArIDQpOwogICAgICAgIF87CiAgICB9ICAgIAogICAgCiAgICBmdW5jdGlvbiBNb2RlcmF0ZWQoKSBwdWJsaWMgewogICAgICAgIG1vZGVyYXRvciA9IG1zZy5zZW5kZXI7CiAgICAgICAgdW5yZXN0cmljdGVkID0gdHJ1ZTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gcmVhc3NpZ25Nb2RlcmF0b3IoYWRkcmVzcyBuZXdNb2RlcmF0b3IpIHB1YmxpYyBvbmx5TW9kZXJhdG9yIHsKICAgICAgICBtb2RlcmF0b3IgPSBuZXdNb2RlcmF0b3I7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHJlc3RyaWN0KCkgcHVibGljIG9ubHlNb2RlcmF0b3IgewogICAgICAgIHVucmVzdHJpY3RlZCA9IGZhbHNlOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB1bnJlc3RyaWN0KCkgcHVibGljIG9ubHlNb2RlcmF0b3IgewogICAgICAgIHVucmVzdHJpY3RlZCA9IHRydWU7CiAgICB9ICAKICAgIAogICAgLy8vIFRoaXMgbWV0aG9kIGNhbiBiZSB1c2VkIHRvIGV4dHJhY3QgdG9rZW5zIG1pc3Rha2VubHkgc2VudCB0byB0aGlzIGNvbnRyYWN0LgogICAgLy8vIEBwYXJhbSBfdG9rZW4gVGhlIGFkZHJlc3Mgb2YgdGhlIHRva2VuIGNvbnRyYWN0IHRoYXQgeW91IHdhbnQgdG8gcmVjb3ZlcgogICAgZnVuY3Rpb24gZXh0cmFjdChhZGRyZXNzIF90b2tlbikgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF90b2tlbiAhPSBhZGRyZXNzKDB4MCkpOwogICAgICAgIFRva2VuIHRva2VuID0gVG9rZW4oX3Rva2VuKTsKICAgICAgICB1aW50MjU2IGJhbGFuY2UgPSB0b2tlbi5iYWxhbmNlT2YodGhpcyk7CiAgICAgICAgcmV0dXJuIHRva2VuLnRyYW5zZmVyKG1vZGVyYXRvciwgYmFsYW5jZSk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGlzQ29udHJhY3QoYWRkcmVzcyBfYWRkcikgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgdWludDI1NiBzaXplOwogICAgICAgIGFzc2VtYmx5IHsgc2l6ZSA6PSBleHRjb2Rlc2l6ZShfYWRkcikgfQogICAgICAgIHJldHVybiAoc2l6ZSA+IDApOwogICAgfSAgCiAgICAKICAgIGZ1bmN0aW9uIGdldE1vZGVyYXRvcigpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3MpIHsKICAgICAgICByZXR1cm4gbW9kZXJhdG9yOwogICAgfQp9IAoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBUb2tlbiB7IAoKICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOyAgICAKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsgICAgCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsgICAgCiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsgICAgCgp9CgoKCgoKCgovLyBAZGV2IEFzc2lnbiBtb2RlcmF0aW9uIG9mIGNvbnRyYWN0IHRvIENyb3dkU2FsZQoKY29udHJhY3QgTEVPTiBpcyBNb2RlcmF0ZWQgewkKCXVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKCQlzdHJpbmcgcHVibGljIG5hbWUgPSAiTEVPTlMgQ29pbiI7CQoJCXN0cmluZyBwdWJsaWMgc3ltYm9sID0gIkxFT05TIjsJCQkKCQl1aW50OCBwdWJsaWMgZGVjaW1hbHMgPSAxODsKCQkKCQltYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgaW50ZXJuYWwgYmFsYW5jZXM7CgkJbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBpbnRlcm5hbCBhbGxvd2VkOwoKCQl1aW50MjU2IGludGVybmFsIHRvdGFsU3VwcGx5XzsKCgkJLy8gdGhlIG1heGltdW0gbnVtYmVyIG9mIExFT05TIHRoZXJlIG1heSBleGlzdCBpcyBjYXBwZWQgYXQgMjAwIG1pbGxpb24gdG9rZW5zCgkJdWludDI1NiBwdWJsaWMgY29uc3RhbnQgbWF4aW11bVRva2VuSXNzdWUgPSAyMDAwMDAwMDAgKiAxMCoqMTg7CgkJCgkJZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7IAoJCWV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwkJCgoJCS8qKgoJCSogQGRldiB0b3RhbCBudW1iZXIgb2YgdG9rZW5zIGluIGV4aXN0ZW5jZQoJCSovCgkJZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CgkJCXJldHVybiB0b3RhbFN1cHBseV87CgkJfQoKCQkvKioKCQkqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKCQkqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCgkJKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuCgkJKi8KCQlmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyBpZlVucmVzdHJpY3RlZCBvbmx5UGF5bG9hZFNpemUoMikgcmV0dXJucyAoYm9vbCkgewoJCSAgICByZXR1cm4gX3RyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKCQl9CgoJCS8qKgoJCSogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCgkJKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCgkJKiBAcGFyYW0gX3RvIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KCQkqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZAoJCSovCgkJZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIGlmVW5yZXN0cmljdGVkIG9ubHlQYXlsb2FkU2l6ZSgzKSByZXR1cm5zIChib29sKSB7CgkJICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKCQkgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKCQkgICAgcmV0dXJuIF90cmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwoJCX0JCQoKCQlmdW5jdGlvbiBfdHJhbnNmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7CgkJCS8vIERvIG5vdCBhbGxvdyB0cmFuc2ZlcnMgdG8gMHgwIG9yIHRvIHRoaXMgY29udHJhY3QKCQkJcmVxdWlyZShfdG8gIT0gYWRkcmVzcygweDApICYmIF90byAhPSBhZGRyZXNzKHRoaXMpKTsKCQkJLy8gRG8gbm90IGFsbG93IHRyYW5zZmVyIG9mIHZhbHVlIGdyZWF0ZXIgdGhhbiBzZW5kZXIncyBjdXJyZW50IGJhbGFuY2UKCQkJcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKCQkJLy8gVXBkYXRlIGJhbGFuY2Ugb2Ygc2VuZGluZyBhZGRyZXNzCgkJCWJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsJCgkJCS8vIFVwZGF0ZSBiYWxhbmNlIG9mIHJlY2VpdmluZyBhZGRyZXNzCgkJCWJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwkJCgkJCS8vIEFuIGV2ZW50IHRvIG1ha2UgdGhlIHRyYW5zZmVyIGVhc3kgdG8gZmluZCBvbiB0aGUgYmxvY2tjaGFpbgoJCQlUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwoJCQlyZXR1cm4gdHJ1ZTsKCQl9CgoJCS8qKgoJCSogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KCQkqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgoJCSogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KCQkqLwoJCWZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewoJCQlyZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKCQl9CgoJCS8qKgoJCSogQGRldiBBcHByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuCgkJKgoJCSogQmV3YXJlIHRoYXQgY2hhbmdpbmcgYW4gYWxsb3dhbmNlIHdpdGggdGhpcyBtZXRob2QgYnJpbmdzIHRoZSByaXNrIHRoYXQgc29tZW9uZSBtYXkgdXNlIGJvdGggdGhlIG9sZAoJCSogYW5kIHRoZSBuZXcgYWxsb3dhbmNlIGJ5IHVuZm9ydHVuYXRlIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcwoJCSogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgoJCSogaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkKCQkqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KCQkqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCgkJKi8KCQlmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgaWZVbnJlc3RyaWN0ZWQgb25seVBheWxvYWRTaXplKDIpIHJldHVybnMgKGJvb2wgc3VjZXNzKSB7CgkJCS8vIENhbiBvbmx5IGFwcHJvdmUgd2hlbiB2YWx1ZSBoYXMgbm90IGFscmVhZHkgYmVlbiBzZXQgb3IgaXMgemVybwoJCQlyZXF1aXJlKGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID09IDAgfHwgX3ZhbHVlID09IDApOwoJCQlhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsKCQkJQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CgkJCXJldHVybiB0cnVlOwoJCX0KCgkJLyoqCgkJKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCgkJKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCgkJKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KCQkqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KCQkqLwoJCWZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewoJCQlyZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKCQl9CgoJCS8qKgoJCSogQGRldiBJbmNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgoJCSoKCQkqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAoJCSogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKCQkqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKCQkqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCgkJKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCgkJKiBAcGFyYW0gX2FkZGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gaW5jcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KCQkqLwoJCWZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfYWRkZWRWYWx1ZSkgcHVibGljIGlmVW5yZXN0cmljdGVkIG9ubHlQYXlsb2FkU2l6ZSgyKSByZXR1cm5zIChib29sKSB7CgkJCXJlcXVpcmUoX2FkZGVkVmFsdWUgPiAwKTsKCQkJYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwoJCQlBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwoJCQlyZXR1cm4gdHJ1ZTsKCQl9CgoJCS8qKgoJCSogQGRldiBEZWNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgoJCSoKCQkqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGRlY3JlbWVudAoJCSogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKCQkqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKCQkqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCgkJKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCgkJKiBAcGFyYW0gX3N1YnRyYWN0ZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBkZWNyZWFzZSB0aGUgYWxsb3dhbmNlIGJ5LgoJCSovCgkJZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF9zdWJ0cmFjdGVkVmFsdWUpIHB1YmxpYyBpZlVucmVzdHJpY3RlZCBvbmx5UGF5bG9hZFNpemUoMikgcmV0dXJucyAoYm9vbCkgewoJCQl1aW50MjU2IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CgkJCXJlcXVpcmUoX3N1YnRyYWN0ZWRWYWx1ZSA+IDApOwoJCQlpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CgkJCQlhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CgkJCX0gZWxzZSB7CgkJCQlhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKCQkJfQoJCQlBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwoJCQlyZXR1cm4gdHJ1ZTsKCQl9CgoJCS8qKgoJCSogQGRldiBGdW5jdGlvbiB0byBtaW50IHRva2VucwoJCSogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgbWludGVkIHRva2Vucy4KCQkqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIG1pbnQuCgkJKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgoJCSovCgkJZnVuY3Rpb24gZ2VuZXJhdGVUb2tlbnMoYWRkcmVzcyBfdG8sIHVpbnQgX2Ftb3VudCkgcHVibGljIG9ubHlNb2RlcmF0b3IgcmV0dXJucyAoYm9vbCkgewoJCSAgICByZXF1aXJlKGlzQ29udHJhY3QobW9kZXJhdG9yKSk7CgkJCXJlcXVpcmUodG90YWxTdXBwbHlfLmFkZChfYW1vdW50KSA8PSBtYXhpbXVtVG9rZW5Jc3N1ZSk7CgkJCXRvdGFsU3VwcGx5XyA9IHRvdGFsU3VwcGx5Xy5hZGQoX2Ftb3VudCk7CgkJCWJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfYW1vdW50KTsKCQkJVHJhbnNmZXIoYWRkcmVzcygweDApLCBfdG8sIF9hbW91bnQpOwoJCQlyZXR1cm4gdHJ1ZTsKCQl9CgkJLyoqCgkJKiBAZGV2IGZhbGxiYWNrIGZ1bmN0aW9uIC0gcmV2ZXJ0cyB0cmFuc2FjdGlvbgoJCSovCQkKICAgIAlmdW5jdGlvbiAoKSBleHRlcm5hbCBwYXlhYmxlIHsKICAgIAkgICAgcmV2ZXJ0KCk7CiAgICAJfQkJCn0KCgpjb250cmFjdCBDcm93ZFNhbGUgaXMgTW9kZXJhdGVkIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogICAgCiAgICAvLyBMRU9OIEVSQzIwIHNtYXJ0IGNvbnRyYWN0CiAgICBMRU9OIHB1YmxpYyB0b2tlbkNvbnRyYWN0OwogICAgCiAgICAvLyBjcm93ZHNhbGUgYWltcyB0byBzZWxsIGF0IGxlYXN0IDEwIDAwMCAwMDAgTEVPTlMKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IGNyb3dkc2FsZVRhcmdldCA9IDEwMDAwMDAwICogMTAqKjE4OwogICAgLy8gcnVubmluZyB0b3RhbCBvZiBMRU9OUyBzb2xkCiAgICB1aW50MjU2IHB1YmxpYyB0b2tlbnNTb2xkOwogICAgLy8gcnVubmluZyB0b3RhbCBvZiBldGhlciByYWlzZWQKICAgIHVpbnQyNTYgcHVibGljIHdlaVJhaXNlZDsKCiAgICAvLyAxIEV0aGVyIGJ1eXMgMTMgMDAwIExFT05TCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBldGhlclRvTEVPTlJhdGUgPSAxMzAwMDsKICAgIC8vIGFkZHJlc3MgdG8gcmVjZWl2ZSBldGhlciAKICAgIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IGV0aGVyVmF1bHQgPSAweEQ4ZDk3RTNCNWRCMTM4OTFlMDgyRjAwRUQzZmU5QTBCQzZCN2VBMDE7ICAgIAogICAgLy8gYWRkcmVzcyB0byBzdG9yZSBib3VudHkgYWxsb2NhdGlvbgogICAgYWRkcmVzcyBwdWJsaWMgY29uc3RhbnQgYm91bnR5VmF1bHQgPSAweDk2QjA4M2EyNTNBOTBlMzIxZmI5RjUzNjQ1NDgzNzQ1NjMwYmU5NTI7CiAgICAvLyB2ZXN0aW5nIGNvbnRyYWN0IHRvIHN0b3JlIHRlYW0gYWxsb2NhdGlvbgogICAgVmVzdGluZ1ZhdWx0IHB1YmxpYyB2ZXN0aW5nQ29udHJhY3Q7CiAgICAvLyBtaW5pbXVtIG9mIDEgZXRoZXIgdG8gcGFydGljaXBhdGUgaW4gY3Jvd2RzYWxlCiAgICB1aW50MjU2IGNvbnN0YW50IHB1cmNoYXNlTWluaW11bSA9IDEgZXRoZXI7CiAgICAvLyBtYXhpbXVtIG9mIDY1IGV0aGVyIAogICAgdWludDI1NiBjb25zdGFudCBwdXJjaGFzZU1heGltdW0gPSA2NSBldGhlcjsKICAgIAogICAgLy8gYm9vbGVhbiB0byBpbmRpY2F0ZSBjcm93ZHNhbGUgZmluYWxpemVkIHN0YXRlICAgIAogICAgYm9vbCBwdWJsaWMgaXNGaW5hbGl6ZWQ7CiAgICAvLyBib29sZWFuIHRvIGluZGljYXRlIGNyb3dkc2FsZSBpcyBhY3RpdmVseSBhY2NlcHRpbmcgZXRoZXIKICAgIGJvb2wgcHVibGljIGFjdGl2ZTsKICAgIAogICAgLy8gbWFwcGluZyBvZiB3aGl0ZWxpc3RlZCBwYXJ0aWNpcGFudHMKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgaW50ZXJuYWwgd2hpdGVsaXN0OyAgIAogICAgCiAgICAvLyBmaW5hbGl6YXRpb24gZXZlbnQKICAgIGV2ZW50IEZpbmFsaXplZCh1aW50MjU2IHNhbGVzLCB1aW50MjU2IHJhaXNlZCk7CiAgICAvLyBwdXJjaGFzZSBldmVudAogICAgZXZlbnQgUHVyY2hhc2VkKGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsIHVpbnQyNTYgdG9rZW5zLCB1aW50MjU2IHRvdHNhbGVzLCB1aW50MjU2IGV0aHJhaXNlZCk7CiAgICAvLyB3aGl0ZWxpc3RpbmcgZXZlbnQKICAgIGV2ZW50IFdoaXRlbGlzdGVkKGFkZHJlc3MgaW5kZXhlZCBwYXJ0aWNpcGFudCk7CiAgICAvLyByZXZvY2F0aW9uIG9mIHdoaXRlbGlzdGluZyBldmVudAogICAgZXZlbnQgUmV2b2tlZChhZGRyZXNzIGluZGV4ZWQgcGFydGljaXBhbnQpOwogICAgCiAgICAvLyBsaW1pdHMgcHVyY2hhc2UgdG8gd2hpdGVsaXN0ZWQgcGFydGljaXBhbnRzIG9ubHkKICAgIG1vZGlmaWVyIG9ubHlXaGl0ZWxpc3QgewogICAgICAgIHJlcXVpcmUod2hpdGVsaXN0W21zZy5zZW5kZXJdKTsKICAgICAgICBfOwogICAgfQogICAgLy8gcHVyY2hhc2Ugd2hpbGUgY3Jvd2RzYWxlIGlzIGxpdmUgb25seSAgIAogICAgbW9kaWZpZXIgd2hpbGVBY3RpdmUgewogICAgICAgIHJlcXVpcmUoYWN0aXZlKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICAvLyBjb25zdHJ1Y3RvcgogICAgLy8gQHBhcmFtIF90b2tlbkFkZHIsIHRoZSBhZGRyZXNzIG9mIHRoZSBkZXBsb3llZCBMRU9OIHRva2VuCiAgICBmdW5jdGlvbiBDcm93ZFNhbGUoYWRkcmVzcyBfdG9rZW5BZGRyKSBwdWJsaWMgewogICAgICAgIHRva2VuQ29udHJhY3QgPSBMRU9OKF90b2tlbkFkZHIpOwogICAgfSAgIAoKICAgIC8vIGZhbGxiYWNrIGZ1bmN0aW9uIGludm9rZXMgYnV5VG9rZW5zIG1ldGhvZAogICAgZnVuY3Rpb24oKSBleHRlcm5hbCBwYXlhYmxlIHsKICAgICAgICBidXlUb2tlbnMobXNnLnNlbmRlcik7CiAgICB9CiAgICAKICAgIC8vIGZvcndhcmRzIGV0aGVyIHJlY2VpdmVkIHRvIHJlZnVuZCB2YXVsdCBhbmQgZ2VuZXJhdGVzIHRva2VucyBmb3IgcHVyY2hhc2VyCiAgICBmdW5jdGlvbiBidXlUb2tlbnMoYWRkcmVzcyBfcHVyY2hhc2VyKSBwdWJsaWMgcGF5YWJsZSBpZlVucmVzdHJpY3RlZCBvbmx5V2hpdGVsaXN0IHdoaWxlQWN0aXZlIHsKICAgICAgICAvLyBwdXJjaGFzZSB2YWx1ZSBtdXN0IGJlIGJldHdlZW4gMTAgRXRoZXIgYW5kIDY1IEV0aGVyCiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPiBwdXJjaGFzZU1pbmltdW0gJiYgbXNnLnZhbHVlIDwgcHVyY2hhc2VNYXhpbXVtKTsKICAgICAgICAvLyB0cmFuc2ZlciBldGhlciB0byB0aGUgZXRoZXIgdmF1bHQKICAgICAgICBldGhlclZhdWx0LnRyYW5zZmVyKG1zZy52YWx1ZSk7CiAgICAgICAgLy8gaW5jcmVtZW50IHdlaSByYWlzZWQgdG90YWwKICAgICAgICB3ZWlSYWlzZWQgPSB3ZWlSYWlzZWQuYWRkKG1zZy52YWx1ZSk7CiAgICAgICAgLy8gMSBFVEhFUiBidXlzIDEzIDAwMCBMRU9OUwogICAgICAgIHVpbnQyNTYgX3Rva2VucyA9IChtc2cudmFsdWUpLm11bChldGhlclRvTEVPTlJhdGUpOyAKICAgICAgICAvLyBtaW50IHRva2VucyBpbnRvIHB1cmNoYXNlciBhZGRyZXNzCiAgICAgICAgcmVxdWlyZSh0b2tlbkNvbnRyYWN0LmdlbmVyYXRlVG9rZW5zKF9wdXJjaGFzZXIsIF90b2tlbnMpKTsKICAgICAgICAvLyBpbmNyZW1lbnQgdG9rZW4gc2FsZXMgdG90YWwKICAgICAgICB0b2tlbnNTb2xkID0gdG9rZW5zU29sZC5hZGQoX3Rva2Vucyk7CiAgICAgICAgLy8gZW1pdCBwdXJjaGFzZSBldmVudAogICAgICAgIFB1cmNoYXNlZChfcHVyY2hhc2VyLCBfdG9rZW5zLCB0b2tlbnNTb2xkLCB3ZWlSYWlzZWQpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBpbml0aWFsaXplKCkgZXh0ZXJuYWwgb25seU1vZGVyYXRvciB7CiAgICAgICAgLy8gY2Fubm90IGhhdmUgYmVlbiBmaW5hbGl6ZWQgbm9yIHByZXZpb3VzbHkgYWN0aXZhdGVkCiAgICAgICAgcmVxdWlyZSghaXNGaW5hbGl6ZWQgJiYgIWFjdGl2ZSk7CiAgICAgICAgLy8gY2hlY2sgdGhhdCB0aGlzIGNvbnRyYWN0IGFkZHJlc3MgaXMgdGhlIG1vZGVyYXRvciBvZiB0aGUgdG9rZW4gY29udHJhY3QKICAgICAgICByZXF1aXJlKHRva2VuQ29udHJhY3QuZ2V0TW9kZXJhdG9yKCkgPT0gYWRkcmVzcyh0aGlzKSk7CiAgICAgICAgLy8gcmVzdHJpY3QgdHJhZGluZwogICAgICAgIHRva2VuQ29udHJhY3QucmVzdHJpY3QoKTsKICAgICAgICAvLyBzZXQgY3Jvd2Qgc2FsZSB0byBhY3RpdmUgc3RhdGUKICAgICAgICBhY3RpdmUgPSB0cnVlOwogICAgfQogICAgCiAgICAvLyBjbG9zZSBzYWxlIGFuZCBhbGxvY2F0ZSBib3VudHkgYW5kIHRlYW0gdG9rZW5zCiAgICBmdW5jdGlvbiBmaW5hbGl6ZSgpIGV4dGVybmFsIG9ubHlNb2RlcmF0b3IgewogICAgICAgIC8vIGNhbm5vdCBoYXZlIGJlZW4gZmluYWxpemVkIGFuZCBtdXN0IGJlIGluIGFjdGl2ZSBzdGF0ZQogICAgICAgIHJlcXVpcmUoIWlzRmluYWxpemVkICYmIGFjdGl2ZSk7CiAgICAgICAgLy8gY2FsY3VsYXRlIHRlYW0gYWxsb2NhdGlvbiAoNDUlIG9mIHRvdGFsIHN1cHBseSkKICAgICAgICB1aW50MjU2IHRlYW1BbGxvY2F0aW9uID0gdG9rZW5zU29sZC5tdWwoOTAwMCkuZGl2KDEwMDAwKTsKICAgICAgICAvLyBjYWxjdWxhdGUgYm91bnR5IGFsbG9jYXRpb24gKDUlIG9mIHRvdGFsIHN1cHBseSkKICAgICAgICB1aW50MjU2IGJvdW50eUFsbG9jYXRpb24gPSB0b2tlbnNTb2xkLnN1Yih0ZWFtQWxsb2NhdGlvbik7CiAgICAgICAgLy8gc3Bhd24gbmV3IHZlc3RpbmcgY29udHJhY3QsIHRpbWUgb2YgcmVsZWFzZSBpbiBzaXggbW9udGhzIGZyb20gcHJlc2VudCBkYXRlCiAgICAgICAgdmVzdGluZ0NvbnRyYWN0ID0gbmV3IFZlc3RpbmdWYXVsdChhZGRyZXNzKHRva2VuQ29udHJhY3QpLCBldGhlclZhdWx0LCAoYmxvY2sudGltZXN0YW1wICsgMjYgd2Vla3MpKTsKICAgICAgICAvLyBnZW5lcmF0ZSB0ZWFtIGFsbG9jYXRpb24KICAgICAgICByZXF1aXJlKHRva2VuQ29udHJhY3QuZ2VuZXJhdGVUb2tlbnMoYWRkcmVzcyh2ZXN0aW5nQ29udHJhY3QpLCB0ZWFtQWxsb2NhdGlvbikpOwogICAgICAgIC8vIGdlbmVyYXRlIGJvdW50eSB0b2tlbnMKICAgICAgICByZXF1aXJlKHRva2VuQ29udHJhY3QuZ2VuZXJhdGVUb2tlbnMoYm91bnR5VmF1bHQsIGJvdW50eUFsbG9jYXRpb24pKTsKICAgICAgICAvLyBlbWl0IGZpbmFsaXplZCBldmVudAogICAgICAgIEZpbmFsaXplZCh0b2tlbnNTb2xkLCB3ZWlSYWlzZWQpOwogICAgICAgIC8vIHNldCBzdGF0ZSB0byBmaW5hbGl6ZWQKICAgICAgICBpc0ZpbmFsaXplZCA9IHRydWU7CiAgICAgICAgLy8gZGVhY3RpdmF0ZSBjcm93ZHNhbGUKICAgICAgICBhY3RpdmUgPSBmYWxzZTsKICAgIH0KICAgIAogICAgLy8gcmVhc3NpZ24gTEVPTiB0b2tlbiB0byB0aGUgc3Vic2VxdWVudCBJQ08gc21hcnQgY29udHJhY3QKICAgIGZ1bmN0aW9uIG1pZ3JhdGUoYWRkcmVzcyBfbW9kZXJhdG9yKSBleHRlcm5hbCBvbmx5TW9kZXJhdG9yIHsKICAgICAgICAvLyBvbmx5IGFmdGVyIGZpbmFsaXphdGlvbgogICAgICAgIHJlcXVpcmUoaXNGaW5hbGl6ZWQpOwogICAgICAgIC8vIGNhbiBvbmx5IHJlYXNzaWduIG1vZGVyYXRvciBwcml2ZWxlZ2UgdG8gYW5vdGhlciBjb250cmFjdAogICAgICAgIHJlcXVpcmUoaXNDb250cmFjdChfbW9kZXJhdG9yKSk7CiAgICAgICAgLy8gcmVhc3NpZ24gbW9kZXJhdG9yIHJvbGUKICAgICAgICB0b2tlbkNvbnRyYWN0LnJlYXNzaWduTW9kZXJhdG9yKF9tb2RlcmF0b3IpOyAgICAKICAgIH0KICAgIAogICAgLy8gYWRkIGFkZHJlc3MgdG8gd2hpdGVsaXN0CiAgICBmdW5jdGlvbiB2ZXJpZnlQYXJ0aWNpcGFudChhZGRyZXNzIHBhcnRpY2lwYW50KSBleHRlcm5hbCBvbmx5TW9kZXJhdG9yIHsKICAgICAgICAvLyB3aGl0ZWxpc3QgdGhlIGFkZHJlc3MKICAgICAgICB3aGl0ZWxpc3RbcGFydGljaXBhbnRdID0gdHJ1ZTsKICAgICAgICAvLyBlbWl0IHdoaXRlbGlzdGVkIGV2ZW50CiAgICAgICAgV2hpdGVsaXN0ZWQocGFydGljaXBhbnQpOwogICAgfQogICAgCiAgICAvLyByZW1vdmUgYWRkcmVzcyBmcm9tIHdoaXRlbGlzdAogICAgZnVuY3Rpb24gcmV2b2tlUGFydGljaXBhdGlvbihhZGRyZXNzIHBhcnRpY2lwYW50KSBleHRlcm5hbCBvbmx5TW9kZXJhdG9yIHsKICAgICAgICAvLyByZW1vdmUgYWRkcmVzcyBmcm9tIHdoaXRlbGlzdAogICAgICAgIHdoaXRlbGlzdFtwYXJ0aWNpcGFudF0gPSBmYWxzZTsKICAgICAgICAvLyBlbWl0IHJldm9rZWQgZXZlbnQKICAgICAgICBSZXZva2VkKHBhcnRpY2lwYW50KTsKICAgIH0KICAgIAogICAgLy8gY2hlY2sgaWYgYW4gYWRkcmVzcyBpcyB3aGl0ZWxpc3RlZAogICAgZnVuY3Rpb24gY2hlY2tQYXJ0aWNpcGFudFN0YXR1cyhhZGRyZXNzIHBhcnRpY2lwYW50KSBleHRlcm5hbCB2aWV3IHJldHVybnMgKGJvb2wgd2hpdGVsaXN0ZWQpIHsKICAgICAgICByZXR1cm4gd2hpdGVsaXN0W3BhcnRpY2lwYW50XTsKICAgIH0KfSAgIAoKLy8gVmVzdGluZyBjb250cmFjdCB0byBsb2NrIHRlYW0gYWxsb2NhdGlvbgpjb250cmFjdCBWZXN0aW5nVmF1bHQgewoKICAgIC8vIHJlZmVyZW5jZSB0byBMRU9OIHNtYXJ0IGNvbnRyYWN0CiAgICBMRU9OIHB1YmxpYyB0b2tlbkNvbnRyYWN0OyAKICAgIC8vIGFkZHJlc3MgdG8gd2hpY2ggdGhlIHRva2VucyBhcmUgcmVsZWFzZWQKICAgIGFkZHJlc3MgcHVibGljIGJlbmVmaWNpYXJ5OwogICAgLy8gdGltZSB1cG9uIHdoaWNoIHRva2VucyBtYXkgYmUgcmVsZWFzZWQKICAgIHVpbnQyNTYgcHVibGljIHJlbGVhc2VEYXRlOwogICAgCiAgICAvLyBjb25zdHJ1Y3RvciB0YWtlcyBMRU9OIHRva2VuIGFkZHJlc3MsIGV0aGVyVmF1bHQgYWRkcmVzcyBhbmQgY3VycmVudCB0aW1lICsgNiBtb250aHMgYXMgcGFyYW1ldGVycwogICAgZnVuY3Rpb24gVmVzdGluZ1ZhdWx0KGFkZHJlc3MgX3Rva2VuLCBhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludDI1NiBfdGltZSkgcHVibGljIHsKICAgICAgICB0b2tlbkNvbnRyYWN0ID0gTEVPTihfdG9rZW4pOwogICAgICAgIGJlbmVmaWNpYXJ5ID0gX2JlbmVmaWNpYXJ5OwogICAgICAgIHJlbGVhc2VEYXRlID0gX3RpbWU7CiAgICB9CiAgICAKICAgIC8vIGNoZWNrIHRva2VuIGJhbGFuY2UgaW4gdGhpcyBjb250cmFjdAogICAgZnVuY3Rpb24gY2hlY2tCYWxhbmNlKCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQyNTYgdG9rZW5CYWxhbmNlKSB7CiAgICAgICAgcmV0dXJuIHRva2VuQ29udHJhY3QuYmFsYW5jZU9mKHRoaXMpOwogICAgfQoKICAgIC8vIGZ1bmN0aW9uIHRvIHJlbGVhc2UgdG9rZW5zIHRvIGJlbmVmaWNpYXJ5IGFkZHJlc3MKICAgIGZ1bmN0aW9uIGNsYWltKCkgZXh0ZXJuYWwgewogICAgICAgIC8vIGNhbiBvbmx5IGJlIGludm9rZWQgYnkgYmVuZWZpY2lhcnkKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYmVuZWZpY2lhcnkpOwogICAgICAgIC8vIGNhbiBvbmx5IGJlIGludm9rZWQgYXQgbWF0dXJpdHkgb2YgdmVzdGluZyBwZXJpb2QKICAgICAgICByZXF1aXJlKGJsb2NrLnRpbWVzdGFtcCA+IHJlbGVhc2VEYXRlKTsKICAgICAgICAvLyBjb21wdXRlIGN1cnJlbnQgYmFsYW5jZQogICAgICAgIHVpbnQyNTYgYmFsYW5jZSA9IHRva2VuQ29udHJhY3QuYmFsYW5jZU9mKHRoaXMpOwogICAgICAgIC8vIHRyYW5zZmVyIHRva2VucyB0byBiZW5lZmljYXJ5CiAgICAgICAgdG9rZW5Db250cmFjdC50cmFuc2ZlcihiZW5lZmljaWFyeSwgYmFsYW5jZSk7CiAgICB9CiAgICAKICAgIC8vIGNoYW5nZSB0aGUgYmVuZWZpY2FyeSBhZGRyZXNzCiAgICBmdW5jdGlvbiBjaGFuZ2VCZW5lZmljaWFyeShhZGRyZXNzIF9uZXdCZW5lZmljaWFyeSkgZXh0ZXJuYWwgewogICAgICAgIC8vIGNhbiBvbmx5IGJlIGNoYW5nZWQgYnkgY3VycmVudCBiZW5lZmljYXJ5CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGJlbmVmaWNpYXJ5KTsKICAgICAgICAvLyBhc3NpZ24gdG8gbmV3IGJlbmVmaWNpYXJ5CiAgICAgICAgYmVuZWZpY2lhcnkgPSBfbmV3QmVuZWZpY2lhcnk7CiAgICB9CiAgICAKICAgIC8vLyBUaGlzIG1ldGhvZCBjYW4gYmUgdXNlZCB0byBleHRyYWN0IHRva2VucyBtaXN0YWtlbmx5IHNlbnQgdG8gdGhpcyBjb250cmFjdC4KICAgIC8vLyBAcGFyYW0gX3Rva2VuIFRoZSBhZGRyZXNzIG9mIHRoZSB0b2tlbiBjb250cmFjdCB0aGF0IHlvdSB3YW50IHRvIHJlY292ZXIKICAgIGZ1bmN0aW9uIGV4dHJhY3QoYWRkcmVzcyBfdG9rZW4pIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZShfdG9rZW4gIT0gYWRkcmVzcygweDApIHx8IF90b2tlbiAhPSBhZGRyZXNzKHRva2VuQ29udHJhY3QpKTsKICAgICAgICBUb2tlbiB0b2tlbiA9IFRva2VuKF90b2tlbik7CiAgICAgICAgdWludDI1NiBiYWxhbmNlID0gdG9rZW4uYmFsYW5jZU9mKHRoaXMpOwogICAgICAgIHJldHVybiB0b2tlbi50cmFuc2ZlcihiZW5lZmljaWFyeSwgYmFsYW5jZSk7CiAgICB9ICAgCiAgICAKICAgIGZ1bmN0aW9uKCkgZXh0ZXJuYWwgcGF5YWJsZSB7CiAgICAgICAgcmV2ZXJ0KCk7CiAgICB9Cn0='.
	

]
