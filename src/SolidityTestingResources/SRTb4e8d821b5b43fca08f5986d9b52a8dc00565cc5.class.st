Class {
	#name : #SRTb4e8d821b5b43fca08f5986d9b52a8dc00565cc5,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTb4e8d821b5b43fca08f5986d9b52a8dc00565cc5 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTc7CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBBcHBsaWNhdGlvbiBFbnRpdHkgR2VuZXJpYyBDb250cmFjdAogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImZjOTE5NTlmOTc4NWJjOTI5MzhiOTA5NThhOTlkMjhlOTMiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+PgoKICAgIFVzZWQgZm9yIHRoZSBBQkkgaW50ZXJmYWNlIHdoZW4gYXNzZXRzIG5lZWQgdG8gY2FsbCBBcHBsaWNhdGlvbiBFbnRpdHkuCgogICAgVGhpcyBpcyByZXF1aXJlZCwgb3RoZXJ3aXNlIHdlIGVuZCB1cCBsb2FkaW5nIHRoZSBhc3NldHMgdGhlbXNlbHZlcyB3aGVuIHdlIGxvYWQgdGhlIEFwcGxpY2F0aW9uRW50aXR5IGNvbnRyYWN0CiAgICBhbmQgZW5kIHVwIGluIGEgbG9vcAoqLwoKCgpjb250cmFjdCBBcHBsaWNhdGlvbkVudGl0eUFCSSB7CgogICAgYWRkcmVzcyBwdWJsaWMgUHJvcG9zYWxzRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgRnVuZGluZ0VudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIE1pbGVzdG9uZXNFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBNZWV0aW5nc0VudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIEJvdW50eU1hbmFnZXJFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBUb2tlbk1hbmFnZXJFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBMaXN0aW5nQ29udHJhY3RFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBGdW5kaW5nTWFuYWdlckVudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIE5ld3NDb250cmFjdEVudGl0eTsKCiAgICBib29sIHB1YmxpYyBfaW5pdGlhbGl6ZWQgPSBmYWxzZTsKICAgIGJvb2wgcHVibGljIF9sb2NrZWQgPSBmYWxzZTsKICAgIHVpbnQ4IHB1YmxpYyBDdXJyZW50RW50aXR5U3RhdGU7CiAgICB1aW50OCBwdWJsaWMgQXNzZXRDb2xsZWN0aW9uTnVtOwogICAgYWRkcmVzcyBwdWJsaWMgR2F0ZXdheUludGVyZmFjZUFkZHJlc3M7CiAgICBhZGRyZXNzIHB1YmxpYyBkZXBsb3llckFkZHJlc3M7CiAgICBhZGRyZXNzIHRlc3RBZGRyZXNzQWxsb3dVcGdyYWRlRnJvbTsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludDgpIHB1YmxpYyBFbnRpdHlTdGF0ZXM7CiAgICBtYXBwaW5nIChieXRlczMyID0+IGFkZHJlc3MpIHB1YmxpYyBBc3NldENvbGxlY3Rpb247CiAgICBtYXBwaW5nICh1aW50OCA9PiBieXRlczMyKSBwdWJsaWMgQXNzZXRDb2xsZWN0aW9uSWRUb05hbWU7CiAgICBtYXBwaW5nIChieXRlczMyID0+IHVpbnQyNTYpIHB1YmxpYyBCeWxhd3NVaW50MjU2OwogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiBieXRlczMyKSBwdWJsaWMgQnlsYXdzQnl0ZXMzMjsKCiAgICBmdW5jdGlvbiBBcHBsaWNhdGlvbkVudGl0eSgpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGdldEVudGl0eVN0YXRlKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gbGlua1RvR2F0ZXdheSggYWRkcmVzcyBfR2F0ZXdheUludGVyZmFjZUFkZHJlc3MsIGJ5dGVzMzIgX3NvdXJjZUNvZGVVcmwgKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIHNldFVwZ3JhZGVTdGF0ZSh1aW50OCBzdGF0ZSkgcHVibGljIDsKICAgIGZ1bmN0aW9uIGFkZEFzc2V0UHJvcG9zYWxzKGFkZHJlc3MgX2Fzc2V0QWRkcmVzc2VzKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIGFkZEFzc2V0RnVuZGluZyhhZGRyZXNzIF9hc3NldEFkZHJlc3NlcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBhZGRBc3NldE1pbGVzdG9uZXMoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYWRkQXNzZXRNZWV0aW5ncyhhZGRyZXNzIF9hc3NldEFkZHJlc3NlcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBhZGRBc3NldEJvdW50eU1hbmFnZXIoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYWRkQXNzZXRUb2tlbk1hbmFnZXIoYWRkcmVzcyBfYXNzZXRBZGRyZXNzZXMpIGV4dGVybmFsOwogICAgZnVuY3Rpb24gYWRkQXNzZXRGdW5kaW5nTWFuYWdlcihhZGRyZXNzIF9hc3NldEFkZHJlc3NlcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBhZGRBc3NldExpc3RpbmdDb250cmFjdChhZGRyZXNzIF9hc3NldEFkZHJlc3NlcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBhZGRBc3NldE5ld3NDb250cmFjdChhZGRyZXNzIF9hc3NldEFkZHJlc3NlcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBnZXRBc3NldEFkZHJlc3NCeU5hbWUoYnl0ZXMzMiBfbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyk7CiAgICBmdW5jdGlvbiBzZXRCeWxhd1VpbnQyNTYoYnl0ZXMzMiBuYW1lLCB1aW50MjU2IHZhbHVlKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBnZXRCeWxhd1VpbnQyNTYoYnl0ZXMzMiBuYW1lKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHNldEJ5bGF3Qnl0ZXMzMihieXRlczMyIG5hbWUsIGJ5dGVzMzIgdmFsdWUpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGdldEJ5bGF3Qnl0ZXMzMihieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJ5dGVzMzIpOwogICAgZnVuY3Rpb24gaW5pdGlhbGl6ZSgpIGV4dGVybmFsIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0UGFyZW50QWRkcmVzcygpIGV4dGVybmFsIHZpZXcgcmV0dXJucyhhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIGNyZWF0ZUNvZGVVcGdyYWRlUHJvcG9zYWwoIGFkZHJlc3MgX25ld0FkZHJlc3MsIGJ5dGVzMzIgX3NvdXJjZUNvZGVVcmwgKSBleHRlcm5hbCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIGFjY2VwdENvZGVVcGdyYWRlUHJvcG9zYWwoYWRkcmVzcyBfbmV3QWRkcmVzcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBpbml0aWFsaXplQXNzZXRzVG9UaGlzQXBwbGljYXRpb24oKSBleHRlcm5hbCByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyQXNzZXRzVG9OZXdBcHBsaWNhdGlvbihhZGRyZXNzIF9uZXdBZGRyZXNzKSBleHRlcm5hbCByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGxvY2soKSBleHRlcm5hbCByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGNhbkluaXRpYXRlQ29kZVVwZ3JhZGUoYWRkcmVzcyBfc2VuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zKGJvb2wpOwogICAgZnVuY3Rpb24gZG9TdGF0ZUNoYW5nZXMoKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBoYXNSZXF1aXJlZFN0YXRlQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gYW55QXNzZXRIYXNDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBleHRlbmRlZEFueUFzc2V0SGFzQ2hhbmdlcygpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRSZXF1aXJlZFN0YXRlQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4LCB1aW50OCk7CiAgICBmdW5jdGlvbiBnZXRUaW1lc3RhbXAoKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KTsKCn0KCi8qCgogKiBzb3VyY2UgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL2Jsb2NrYml0c2lvLwoKICogQG5hbWUgICAgICAgIEFwcGxpY2F0aW9uIEFzc2V0IENvbnRyYWN0CiAqIEBwYWNrYWdlICAgICBCbG9ja0JpdHNJTwogKiBAYXV0aG9yICAgICAgTWlja3kgU29jYWNpIDw8YSBocmVmPSIvY2RuLWNnaS9sL2VtYWlsLXByb3RlY3Rpb24iIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iMTE3Yzc4NzI3YTY4NTE3ZjdlNjY3ZDc4Njc3NDNmNjM3ZSI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvYT4+CgogQW55IGNvbnRyYWN0IGluaGVyaXRpbmcgdGhpcyB3aWxsIGJlIHVzYWJsZSBhcyBhbiBBc3NldCBpbiB0aGUgQXBwbGljYXRpb24gRW50aXR5CgoqLwoKCgoKY29udHJhY3QgQXBwbGljYXRpb25Bc3NldCB7CgogICAgZXZlbnQgRXZlbnRBcHBBc3NldE93bmVyU2V0KGJ5dGVzMzIgaW5kZXhlZCBfbmFtZSwgYWRkcmVzcyBpbmRleGVkIF9vd25lcik7CiAgICBldmVudCBFdmVudFJ1bkJlZm9yZUluaXQoYnl0ZXMzMiBpbmRleGVkIF9uYW1lKTsKICAgIGV2ZW50IEV2ZW50UnVuQmVmb3JlQXBwbHlpbmdTZXR0aW5ncyhieXRlczMyIGluZGV4ZWQgX25hbWUpOwoKCiAgICBtYXBwaW5nIChieXRlczMyID0+IHVpbnQ4KSBwdWJsaWMgRW50aXR5U3RhdGVzOwogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiB1aW50OCkgcHVibGljIFJlY29yZFN0YXRlczsKICAgIHVpbnQ4IHB1YmxpYyBDdXJyZW50RW50aXR5U3RhdGU7CgogICAgZXZlbnQgRXZlbnRFbnRpdHlQcm9jZXNzb3IoYnl0ZXMzMiBpbmRleGVkIF9hc3NldE5hbWUsIHVpbnQ4IGluZGV4ZWQgX2N1cnJlbnQsIHVpbnQ4IGluZGV4ZWQgX3JlcXVpcmVkKTsKICAgIGV2ZW50IERlYnVnRW50aXR5UmVxdWlyZWRDaGFuZ2VzKCBieXRlczMyIF9hc3NldE5hbWUsIHVpbnQ4IGluZGV4ZWQgX2N1cnJlbnQsIHVpbnQ4IGluZGV4ZWQgX3JlcXVpcmVkICk7CgogICAgYnl0ZXMzMiBwdWJsaWMgYXNzZXROYW1lOwoKICAgIC8qIEFzc2V0IHJlY29yZHMgKi8KICAgIHVpbnQ4IHB1YmxpYyBSZWNvcmROdW0gPSAwOwoKICAgIC8qIEFzc2V0IGluaXRpYWxpc2VkIG9yIG5vdCAqLwogICAgYm9vbCBwdWJsaWMgX2luaXRpYWxpemVkID0gZmFsc2U7CgogICAgLyogQXNzZXQgc2V0dGluZ3MgcHJlc2VudCBvciBub3QgKi8KICAgIGJvb2wgcHVibGljIF9zZXR0aW5nc0FwcGxpZWQgPSBmYWxzZTsKCiAgICAvKiBBc3NldCBvd25lciAoIEFwcGxpY2F0aW9uRW50aXR5IGFkZHJlc3MgKSAqLwogICAgYWRkcmVzcyBwdWJsaWMgb3duZXIgPSBhZGRyZXNzKDB4MCkgOwogICAgYWRkcmVzcyBwdWJsaWMgZGVwbG95ZXJBZGRyZXNzOwoKICAgIGZ1bmN0aW9uIEFwcGxpY2F0aW9uQXNzZXQoKSBwdWJsaWMgewogICAgICAgIGRlcGxveWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0SW5pdGlhbEFwcGxpY2F0aW9uQWRkcmVzcyhhZGRyZXNzIF9vd25lckFkZHJlc3MpIHB1YmxpYyBvbmx5RGVwbG95ZXIgcmVxdWlyZU5vdEluaXRpYWxpc2VkIHsKICAgICAgICBvd25lciA9IF9vd25lckFkZHJlc3M7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0SW5pdGlhbE93bmVyQW5kTmFtZShieXRlczMyIF9uYW1lKSBleHRlcm5hbAogICAgICAgIHJlcXVpcmVOb3RJbml0aWFsaXNlZAogICAgICAgIG9ubHlPd25lcgogICAgICAgIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgLy8gaW5pdCBzdGF0ZXMKICAgICAgICBzZXRBc3NldFN0YXRlcygpOwogICAgICAgIGFzc2V0TmFtZSA9IF9uYW1lOwogICAgICAgIC8vIHNldCBpbml0aWFsIHN0YXRlCiAgICAgICAgQ3VycmVudEVudGl0eVN0YXRlID0gZ2V0RW50aXR5U3RhdGUoIk5FVyIpOwogICAgICAgIHJ1bkJlZm9yZUluaXRpYWxpemF0aW9uKCk7CiAgICAgICAgX2luaXRpYWxpemVkID0gdHJ1ZTsKICAgICAgICBFdmVudEFwcEFzc2V0T3duZXJTZXQoX25hbWUsIG93bmVyKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRBc3NldFN0YXRlcygpIGludGVybmFsIHsKICAgICAgICAvLyBBc3NldCBTdGF0ZXMKICAgICAgICBFbnRpdHlTdGF0ZXNbIl9fSUdOT1JFRF9fIl0gICAgID0gMDsKICAgICAgICBFbnRpdHlTdGF0ZXNbIk5FVyJdICAgICAgICAgICAgID0gMTsKICAgICAgICAvLyBGdW5kaW5nIFN0YWdlIFN0YXRlcwogICAgICAgIFJlY29yZFN0YXRlc1siX19JR05PUkVEX18iXSAgICAgPSAwOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFJlY29yZFN0YXRlKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gUmVjb3JkU3RhdGVzW25hbWVdOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEVudGl0eVN0YXRlKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gRW50aXR5U3RhdGVzW25hbWVdOwogICAgfQoKICAgIGZ1bmN0aW9uIHJ1bkJlZm9yZUluaXRpYWxpemF0aW9uKCkgaW50ZXJuYWwgcmVxdWlyZU5vdEluaXRpYWxpc2VkICB7CiAgICAgICAgRXZlbnRSdW5CZWZvcmVJbml0KGFzc2V0TmFtZSk7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwbHlBbmRMb2NrU2V0dGluZ3MoKQogICAgICAgIHB1YmxpYwogICAgICAgIG9ubHlEZXBsb3llcgogICAgICAgIHJlcXVpcmVJbml0aWFsaXNlZAogICAgICAgIHJlcXVpcmVTZXR0aW5nc05vdEFwcGxpZWQKICAgICAgICByZXR1cm5zKGJvb2wpCiAgICB7CiAgICAgICAgcnVuQmVmb3JlQXBwbHlpbmdTZXR0aW5ncygpOwogICAgICAgIF9zZXR0aW5nc0FwcGxpZWQgPSB0cnVlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHJ1bkJlZm9yZUFwcGx5aW5nU2V0dGluZ3MoKSBpbnRlcm5hbCByZXF1aXJlSW5pdGlhbGlzZWQgcmVxdWlyZVNldHRpbmdzTm90QXBwbGllZCAgewogICAgICAgIEV2ZW50UnVuQmVmb3JlQXBwbHlpbmdTZXR0aW5ncyhhc3NldE5hbWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyVG9OZXdPd25lcihhZGRyZXNzIF9uZXdPd25lcikgcHVibGljIHJlcXVpcmVJbml0aWFsaXNlZCBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUob3duZXIgIT0gYWRkcmVzcygweDApICYmIF9uZXdPd25lciAhPSBhZGRyZXNzKDB4MCkpOwogICAgICAgIG93bmVyID0gX25ld093bmVyOwogICAgICAgIEV2ZW50QXBwQXNzZXRPd25lclNldChhc3NldE5hbWUsIG93bmVyKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvbkFzc2V0QWRkcmVzc0J5TmFtZShieXRlczMyIF9uYW1lKQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zKGFkZHJlc3MpCiAgICB7CiAgICAgICAgYWRkcmVzcyBhc3NldCA9IEFwcGxpY2F0aW9uRW50aXR5QUJJKG93bmVyKS5nZXRBc3NldEFkZHJlc3NCeU5hbWUoX25hbWUpOwogICAgICAgIGlmKCBhc3NldCAhPSBhZGRyZXNzKDB4MCkgKSB7CiAgICAgICAgICAgIHJldHVybiBhc3NldDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QXBwbGljYXRpb25TdGF0ZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KSB7CiAgICAgICAgcmV0dXJuIEFwcGxpY2F0aW9uRW50aXR5QUJJKG93bmVyKS5DdXJyZW50RW50aXR5U3RhdGUoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvbkVudGl0eVN0YXRlKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpIHsKICAgICAgICByZXR1cm4gQXBwbGljYXRpb25FbnRpdHlBQkkob3duZXIpLmdldEVudGl0eVN0YXRlKG5hbWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEFwcEJ5bGF3VWludDI1NihieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJlcXVpcmVJbml0aWFsaXNlZCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgQXBwbGljYXRpb25FbnRpdHlBQkkgQ3VycmVudEFwcCA9IEFwcGxpY2F0aW9uRW50aXR5QUJJKG93bmVyKTsKICAgICAgICByZXR1cm4gQ3VycmVudEFwcC5nZXRCeWxhd1VpbnQyNTYobmFtZSk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QXBwQnlsYXdCeXRlczMyKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmVxdWlyZUluaXRpYWxpc2VkIHJldHVybnMgKGJ5dGVzMzIpIHsKICAgICAgICBBcHBsaWNhdGlvbkVudGl0eUFCSSBDdXJyZW50QXBwID0gQXBwbGljYXRpb25FbnRpdHlBQkkob3duZXIpOwogICAgICAgIHJldHVybiBDdXJyZW50QXBwLmdldEJ5bGF3Qnl0ZXMzMihuYW1lKTsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlBcHBsaWNhdGlvbkVudGl0eSgpIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgcmVxdWlyZUluaXRpYWxpc2VkKCkgewogICAgICAgIHJlcXVpcmUoX2luaXRpYWxpemVkID09IHRydWUpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgcmVxdWlyZU5vdEluaXRpYWxpc2VkKCkgewogICAgICAgIHJlcXVpcmUoX2luaXRpYWxpemVkID09IGZhbHNlKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIHJlcXVpcmVTZXR0aW5nc0FwcGxpZWQoKSB7CiAgICAgICAgcmVxdWlyZShfc2V0dGluZ3NBcHBsaWVkID09IHRydWUpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgcmVxdWlyZVNldHRpbmdzTm90QXBwbGllZCgpIHsKICAgICAgICByZXF1aXJlKF9zZXR0aW5nc0FwcGxpZWQgPT0gZmFsc2UpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seURlcGxveWVyKCkgewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBkZXBsb3llckFkZHJlc3MpOwogICAgICAgIF87CiAgICB9CgogICAgbW9kaWZpZXIgb25seUFzc2V0KGJ5dGVzMzIgX25hbWUpIHsKICAgICAgICBhZGRyZXNzIEFzc2V0QWRkcmVzcyA9IGdldEFwcGxpY2F0aW9uQXNzZXRBZGRyZXNzQnlOYW1lKF9uYW1lKTsKICAgICAgICByZXF1aXJlKCBtc2cuc2VuZGVyID09IEFzc2V0QWRkcmVzcyk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRUaW1lc3RhbXAoKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIG5vdzsKICAgIH0KCgp9CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBBcHBsaWNhdGlvbiBBc3NldCBDb250cmFjdCBBQkkKICogQHBhY2thZ2UgICAgIEJsb2NrQml0c0lPCiAqIEBhdXRob3IgICAgICBNaWNreSBTb2NhY2kgPDxhIGhyZWY9Ii9jZG4tY2dpL2wvZW1haWwtcHJvdGVjdGlvbiIgY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSIxYTc3NzM3OTcxNjM1YTc0NzU2ZDc2NzM2YzdmMzQ2ODc1Ij5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9hPj4KCiBBbnkgY29udHJhY3QgaW5oZXJpdGluZyB0aGlzIHdpbGwgYmUgdXNhYmxlIGFzIGFuIEFzc2V0IGluIHRoZSBBcHBsaWNhdGlvbiBFbnRpdHkKCiovCgoKCmNvbnRyYWN0IEFCSUFwcGxpY2F0aW9uQXNzZXQgewoKICAgIGJ5dGVzMzIgcHVibGljIGFzc2V0TmFtZTsKICAgIHVpbnQ4IHB1YmxpYyBDdXJyZW50RW50aXR5U3RhdGU7CiAgICB1aW50OCBwdWJsaWMgUmVjb3JkTnVtOwogICAgYm9vbCBwdWJsaWMgX2luaXRpYWxpemVkOwogICAgYm9vbCBwdWJsaWMgX3NldHRpbmdzQXBwbGllZDsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwogICAgYWRkcmVzcyBwdWJsaWMgZGVwbG95ZXJBZGRyZXNzOwogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiB1aW50OCkgcHVibGljIEVudGl0eVN0YXRlczsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludDgpIHB1YmxpYyBSZWNvcmRTdGF0ZXM7CgogICAgZnVuY3Rpb24gc2V0SW5pdGlhbEFwcGxpY2F0aW9uQWRkcmVzcyhhZGRyZXNzIF9vd25lckFkZHJlc3MpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIHNldEluaXRpYWxPd25lckFuZE5hbWUoYnl0ZXMzMiBfbmFtZSkgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRSZWNvcmRTdGF0ZShieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGdldEVudGl0eVN0YXRlKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gYXBwbHlBbmRMb2NrU2V0dGluZ3MoKSBwdWJsaWMgcmV0dXJucyhib29sKTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyVG9OZXdPd25lcihhZGRyZXNzIF9uZXdPd25lcikgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0QXBwbGljYXRpb25Bc3NldEFkZHJlc3NCeU5hbWUoYnl0ZXMzMiBfbmFtZSkgcHVibGljIHJldHVybnMoYWRkcmVzcyk7CiAgICBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvblN0YXRlKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gZ2V0QXBwbGljYXRpb25FbnRpdHlTdGF0ZShieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGdldEFwcEJ5bGF3VWludDI1NihieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gZ2V0QXBwQnlsYXdCeXRlczMyKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAoYnl0ZXMzMik7CiAgICBmdW5jdGlvbiBnZXRUaW1lc3RhbXAoKSB2aWV3IHB1YmxpYyByZXR1cm5zICh1aW50MjU2KTsKCgp9CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBGdW5kaW5nIENvbnRyYWN0IEFCSQogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9ImYxOWM5ODkyOWE4OGIxOWY5ZTg2OWQ5ODg3OTRkZjgzOWUiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+PgoKIENvbnRhaW5zIHRoZSBGdW5kaW5nIENvbnRyYWN0IGNvZGUgZGVwbG95ZWQgYW5kIGxpbmtlZCB0byB0aGUgQXBwbGljYXRpb24gRW50aXR5CgoqLwoKCgoKCmNvbnRyYWN0IEFCSUZ1bmRpbmdNYW5hZ2VyIGlzIEFCSUFwcGxpY2F0aW9uQXNzZXQgewoKICAgIGJvb2wgcHVibGljIGZ1bmRpbmdQcm9jZXNzZWQ7CiAgICBib29sIEZ1bmRpbmdQb29sQmFsYW5jZXNBbGxvY2F0ZWQ7CiAgICB1aW50OCBwdWJsaWMgVmF1bHRDb3VudFBlclByb2Nlc3M7CiAgICB1aW50MjU2IHB1YmxpYyBsYXN0UHJvY2Vzc2VkVmF1bHRJZDsKICAgIHVpbnQyNTYgcHVibGljIHZhdWx0TnVtOwogICAgdWludDI1NiBwdWJsaWMgTG9ja2VkVm90aW5nVG9rZW5zOwogICAgYnl0ZXMzMiBwdWJsaWMgY3VycmVudFRhc2s7CiAgICBtYXBwaW5nIChieXRlczMyID0+IGJvb2wpIHB1YmxpYyB0YXNrQnlIYXNoOwogICAgbWFwcGluZyAgKGFkZHJlc3MgPT4gYWRkcmVzcykgcHVibGljIHZhdWx0TGlzdDsKICAgIG1hcHBpbmcgICh1aW50MjU2ID0+IGFkZHJlc3MpIHB1YmxpYyB2YXVsdEJ5SWQ7CgogICAgZnVuY3Rpb24gcmVjZWl2ZVBheW1lbnQoYWRkcmVzcyBfc2VuZGVyLCB1aW50OCBfcGF5bWVudF9tZXRob2QsIHVpbnQ4IF9mdW5kaW5nX3N0YWdlKSBwYXlhYmxlIHB1YmxpYyByZXR1cm5zKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0TXlWYXVsdEFkZHJlc3MoYWRkcmVzcyBfc2VuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKTsKICAgIGZ1bmN0aW9uIHNldFZhdWx0Q291bnRQZXJQcm9jZXNzKHVpbnQ4IF9wZXJQcm9jZXNzKSBleHRlcm5hbDsKICAgIGZ1bmN0aW9uIGdldEhhc2goYnl0ZXMzMiBhY3Rpb25UeXBlLCBieXRlczMyIGFyZzEpIHB1YmxpYyBwdXJlIHJldHVybnMgKCBieXRlczMyICk7CiAgICBmdW5jdGlvbiBnZXRDdXJyZW50TWlsZXN0b25lUHJvY2Vzc2VkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBwcm9jZXNzRnVuZGluZ0ZhaWxlZEZpbmlzaGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBwcm9jZXNzRnVuZGluZ1N1Y2Nlc3NmdWxGaW5pc2hlZCgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0Q3VycmVudE1pbGVzdG9uZUlkSGFzaCgpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYnl0ZXMzMik7CiAgICBmdW5jdGlvbiBwcm9jZXNzTWlsZXN0b25lRmluaXNoZWQoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIHByb2Nlc3NFbWVyZ2VuY3lGdW5kUmVsZWFzZUZpbmlzaGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRBZnRlclRyYW5zZmVyTG9ja2VkVG9rZW5CYWxhbmNlcyhhZGRyZXNzIHZhdWx0QWRkcmVzcywgYm9vbCBleGNsdWRlQ3VycmVudCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBWYXVsdFJlcXVlc3RlZFVwZGF0ZUZvckxvY2tlZFZvdGluZ1Rva2VucyhhZGRyZXNzIG93bmVyKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBkb1N0YXRlQ2hhbmdlcygpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGhhc1JlcXVpcmVkU3RhdGVDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRSZXF1aXJlZFN0YXRlQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4LCB1aW50OCk7CiAgICBmdW5jdGlvbiBBcHBsaWNhdGlvbkluRnVuZGluZ09yRGV2ZWxvcG1lbnQoKSBwdWJsaWMgdmlldyByZXR1cm5zKGJvb2wpOwoKfQoKLyoKCiAqIHNvdXJjZSAgICAgICBodHRwczovL2dpdGh1Yi5jb20vYmxvY2tiaXRzaW8vCgogKiBAbmFtZSAgICAgICAgTWVldGluZ3MgQ29udHJhY3QgQUJJCiAqIEBwYWNrYWdlICAgICBCbG9ja0JpdHNJTwogKiBAYXV0aG9yICAgICAgTWlja3kgU29jYWNpIDw8YSBocmVmPSIvY2RuLWNnaS9sL2VtYWlsLXByb3RlY3Rpb24iIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iMGM2MTY1NmY2Nzc1NGM2MjYzN2I2MDY1N2E2OTIyN2U2MyI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvYT4+CgogQ29udGFpbnMgdGhlIE1lZXRpbmdzIENvbnRyYWN0IGNvZGUgZGVwbG95ZWQgYW5kIGxpbmtlZCB0byB0aGUgQXBwbGljYXRpb24gRW50aXR5CgoqLwoKCgoKCmNvbnRyYWN0IEFCSU1lZXRpbmdzIGlzIEFCSUFwcGxpY2F0aW9uQXNzZXQgewogICAgc3RydWN0IFJlY29yZCB7CiAgICAgICAgYnl0ZXMzMiBoYXNoOwogICAgICAgIGJ5dGVzMzIgbmFtZTsKICAgICAgICB1aW50OCBzdGF0ZTsKICAgICAgICB1aW50MjU2IHRpbWVfc3RhcnQ7ICAgICAgICAgICAgICAgICAgICAgLy8gc3RhcnQgYXQgdW5peHRpbWVzdGFtcAogICAgICAgIHVpbnQyNTYgZHVyYXRpb247CiAgICAgICAgdWludDggaW5kZXg7CiAgICB9CiAgICBtYXBwaW5nICh1aW50OCA9PiBSZWNvcmQpIHB1YmxpYyBDb2xsZWN0aW9uOwp9CgovKgoKICogc291cmNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9ja2JpdHNpby8KCiAqIEBuYW1lICAgICAgICBQcm9wb3NhbHMgQ29udHJhY3QKICogQHBhY2thZ2UgICAgIEJsb2NrQml0c0lPCiAqIEBhdXRob3IgICAgICBNaWNreSBTb2NhY2kgPDxhIGhyZWY9Ii9jZG4tY2dpL2wvZW1haWwtcHJvdGVjdGlvbiIgY2xhc3M9Il9fY2ZfZW1haWxfXyIgZGF0YS1jZmVtYWlsPSJkZmIyYjZiY2I0YTY5ZmIxYjBhOGIzYjZhOWJhZjFhZGIwIj5bZW1haWwmIzE2MDtwcm90ZWN0ZWRdPC9hPj4KCiBDb250YWlucyB0aGUgUHJvcG9zYWxzIENvbnRyYWN0IGNvZGUgZGVwbG95ZWQgYW5kIGxpbmtlZCB0byB0aGUgQXBwbGljYXRpb24gRW50aXR5CgoqLwoKCgoKCmNvbnRyYWN0IEFCSVByb3Bvc2FscyBpcyBBQklBcHBsaWNhdGlvbkFzc2V0IHsKCiAgICBhZGRyZXNzIHB1YmxpYyBBcHBsaWNhdGlvbjsKICAgIGFkZHJlc3MgcHVibGljIExpc3RpbmdDb250cmFjdEVudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIEZ1bmRpbmdFbnRpdHk7CiAgICBhZGRyZXNzIHB1YmxpYyBGdW5kaW5nTWFuYWdlckVudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIFRva2VuTWFuYWdlckVudGl0eTsKICAgIGFkZHJlc3MgcHVibGljIFRva2VuRW50aXR5OwogICAgYWRkcmVzcyBwdWJsaWMgTWlsZXN0b25lc0VudGl0eTsKCiAgICBzdHJ1Y3QgUHJvcG9zYWxSZWNvcmQgewogICAgICAgIGFkZHJlc3MgY3JlYXRvcjsKICAgICAgICBieXRlczMyIG5hbWU7CiAgICAgICAgdWludDggYWN0aW9uVHlwZTsKICAgICAgICB1aW50OCBzdGF0ZTsKICAgICAgICBieXRlczMyIGhhc2g7ICAgICAgICAgICAgICAgICAgICAgICAvLyBhY3Rpb24gbmFtZSArIGFyZ3MgaGFzaAogICAgICAgIGFkZHJlc3MgYWRkcjsKICAgICAgICBieXRlczMyIHNvdXJjZUNvZGVVcmw7CiAgICAgICAgdWludDI1NiBleHRyYTsKICAgICAgICB1aW50MjU2IHRpbWVfc3RhcnQ7CiAgICAgICAgdWludDI1NiB0aW1lX2VuZDsKICAgICAgICB1aW50MjU2IGluZGV4OwogICAgfQoKICAgIHN0cnVjdCBWb3RlU3RydWN0IHsKICAgICAgICBhZGRyZXNzIHZvdGVyOwogICAgICAgIHVpbnQyNTYgdGltZTsKICAgICAgICBib29sICAgIHZvdGU7CiAgICAgICAgdWludDI1NiBwb3dlcjsKICAgICAgICBib29sICAgIGFubnVsbGVkOwogICAgICAgIHVpbnQyNTYgaW5kZXg7CiAgICB9CgogICAgc3RydWN0IFJlc3VsdFJlY29yZCB7CiAgICAgICAgdWludDI1NiB0b3RhbEF2YWlsYWJsZTsKICAgICAgICB1aW50MjU2IHJlcXVpcmVkRm9yUmVzdWx0OwogICAgICAgIHVpbnQyNTYgdG90YWxTb0ZhcjsKICAgICAgICB1aW50MjU2IHllczsKICAgICAgICB1aW50MjU2IG5vOwogICAgICAgIGJvb2wgICAgcmVxdWlyZXNDb3VudGluZzsKICAgIH0KCiAgICB1aW50OCBwdWJsaWMgQWN0aXZlUHJvcG9zYWxOdW07CiAgICB1aW50MjU2IHB1YmxpYyBWb3RlQ291bnRQZXJQcm9jZXNzOwogICAgYm9vbCBwdWJsaWMgRW1lcmdlbmN5RnVuZGluZ1JlbGVhc2VBcHByb3ZlZDsKCiAgICBtYXBwaW5nIChieXRlczMyID0+IHVpbnQ4KSBwdWJsaWMgQWN0aW9uVHlwZXM7CiAgICBtYXBwaW5nICh1aW50OCA9PiB1aW50MjU2KSBwdWJsaWMgQWN0aXZlUHJvcG9zYWxJZHM7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IGJvb2wpIHB1YmxpYyBFeHBpcmVkUHJvcG9zYWxJZHM7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IFByb3Bvc2FsUmVjb3JkKSBwdWJsaWMgUHJvcG9zYWxzQnlJZDsKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludDI1NikgcHVibGljIFByb3Bvc2FsSWRCeUhhc2g7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IG1hcHBpbmcgKHVpbnQyNTYgPT4gVm90ZVN0cnVjdCkgKSBwdWJsaWMgVm90ZXNCeVByb3Bvc2FsSWQ7CiAgICBtYXBwaW5nICh1aW50MjU2ID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gVm90ZVN0cnVjdCkgKSBwdWJsaWMgVm90ZXNCeUNhc3RlcjsKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gdWludDI1NikgcHVibGljIFZvdGVzTnVtQnlQcm9wb3NhbElkOwogICAgbWFwcGluZyAodWludDI1NiA9PiBSZXN1bHRSZWNvcmQgKSBwdWJsaWMgUmVzdWx0c0J5UHJvcG9zYWxJZDsKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gdWludDI1NikgcHVibGljIGxhc3RQcm9jZXNzZWRWb3RlSWRCeVByb3Bvc2FsOwogICAgbWFwcGluZyAodWludDI1NiA9PiB1aW50MjU2KSBwdWJsaWMgUHJvY2Vzc2VkVm90ZXNCeVByb3Bvc2FsOwogICAgbWFwcGluZyAodWludDI1NiA9PiB1aW50MjU2KSBwdWJsaWMgVm90ZUNvdW50QXRQcm9jZXNzaW5nU3RhcnRCeVByb3Bvc2FsOwoKICAgIGZ1bmN0aW9uIGdldFJlY29yZFN0YXRlKGJ5dGVzMzIgbmFtZSkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gZ2V0QWN0aW9uVHlwZShieXRlczMyIG5hbWUpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGdldFByb3Bvc2FsU3RhdGUodWludDI1NiBfcHJvcG9zYWxJZCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gZ2V0QnlsYXdzUHJvcG9zYWxWb3RpbmdEdXJhdGlvbigpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gZ2V0QnlsYXdzTWlsZXN0b25lTWluUG9zdHBvbmluZygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gZ2V0QnlsYXdzTWlsZXN0b25lTWF4UG9zdHBvbmluZygpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gZ2V0SGFzaCh1aW50OCBhY3Rpb25UeXBlLCBieXRlczMyIGFyZzEsIGJ5dGVzMzIgYXJnMikgcHVibGljIHB1cmUgcmV0dXJucyAoIGJ5dGVzMzIgKTsKICAgIGZ1bmN0aW9uIHByb2Nlc3MoKSBwdWJsaWM7CiAgICBmdW5jdGlvbiBoYXNSZXF1aXJlZFN0YXRlQ2hhbmdlcygpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0UmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCk7CiAgICBmdW5jdGlvbiBhZGRDb2RlVXBncmFkZVByb3Bvc2FsKGFkZHJlc3MgX2FkZHIsIGJ5dGVzMzIgX3NvdXJjZUNvZGVVcmwpIGV4dGVybmFsIHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gY3JlYXRlTWlsZXN0b25lQWNjZXB0YW5jZVByb3Bvc2FsKCkgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBjcmVhdGVNaWxlc3RvbmVQb3N0cG9uaW5nUHJvcG9zYWwodWludDI1NiBfZHVyYXRpb24pIGV4dGVybmFsIHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gZ2V0Q3VycmVudE1pbGVzdG9uZVBvc3Rwb25pbmdQcm9wb3NhbER1cmF0aW9uKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgICBmdW5jdGlvbiBnZXRDdXJyZW50TWlsZXN0b25lUHJvcG9zYWxTdGF0dXNGb3JUeXBlKHVpbnQ4IF9hY3Rpb25UeXBlICkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpOwogICAgZnVuY3Rpb24gY3JlYXRlRW1lcmdlbmN5RnVuZFJlbGVhc2VQcm9wb3NhbCgpIGV4dGVybmFsIHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gY3JlYXRlRGVsaXN0aW5nUHJvcG9zYWwodWludDI1NiBfcHJvamVjdElkKSBleHRlcm5hbCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIFJlZ2lzdGVyVm90ZSh1aW50MjU2IF9wcm9wb3NhbElkLCBib29sIF9teVZvdGUpIHB1YmxpYzsKICAgIGZ1bmN0aW9uIGhhc1ByZXZpb3VzVm90ZSh1aW50MjU2IF9wcm9wb3NhbElkLCBhZGRyZXNzIF92b3RlcikgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRUb3RhbFRva2VuVm90aW5nUG93ZXIoYWRkcmVzcyBfdm90ZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKCB1aW50MjU2ICk7CiAgICBmdW5jdGlvbiBnZXRWb3RpbmdQb3dlcih1aW50MjU2IF9wcm9wb3NhbElkLCBhZGRyZXNzIF92b3RlcikgcHVibGljIHZpZXcgcmV0dXJucyAoIHVpbnQyNTYgKTsKICAgIGZ1bmN0aW9uIHNldFZvdGVDb3VudFBlclByb2Nlc3ModWludDI1NiBfcGVyUHJvY2VzcykgZXh0ZXJuYWw7CiAgICBmdW5jdGlvbiBQcm9jZXNzVm90ZVRvdGFscyh1aW50MjU2IF9wcm9wb3NhbElkLCB1aW50MjU2IGxlbmd0aCkgcHVibGljOwogICAgZnVuY3Rpb24gY2FuRW5kVm90aW5nKHVpbnQyNTYgX3Byb3Bvc2FsSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gZ2V0UHJvcG9zYWxUeXBlKHVpbnQyNTYgX3Byb3Bvc2FsSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGV4cGlyeUNoYW5nZXNTdGF0ZSh1aW50MjU2IF9wcm9wb3NhbElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIG5lZWRzUHJvY2Vzc2luZyh1aW50MjU2IF9wcm9wb3NhbElkKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldE15Vm90ZUZvckN1cnJlbnRNaWxlc3RvbmVSZWxlYXNlKGFkZHJlc3MgX3ZvdGVyKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKTsKICAgIGZ1bmN0aW9uIGdldEhhc1ZvdGVGb3JDdXJyZW50TWlsZXN0b25lUmVsZWFzZShhZGRyZXNzIF92b3RlcikgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBnZXRNeVZvdGUodWludDI1NiBfcHJvcG9zYWxJZCwgYWRkcmVzcyBfdm90ZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpOwoKfQoKLyoKCiAqIHNvdXJjZSAgICAgICBodHRwczovL2dpdGh1Yi5jb20vYmxvY2tiaXRzaW8vCgogKiBAbmFtZSAgICAgICAgTWlsZXN0b25lcyBDb250cmFjdAogKiBAcGFja2FnZSAgICAgQmxvY2tCaXRzSU8KICogQGF1dGhvciAgICAgIE1pY2t5IFNvY2FjaSA8PGEgaHJlZj0iL2Nkbi1jZ2kvbC9lbWFpbC1wcm90ZWN0aW9uIiBjbGFzcz0iX19jZl9lbWFpbF9fIiBkYXRhLWNmZW1haWw9IjhkZTBlNGVlZTZmNGNkZTNlMmZhZTFlNGZiZThhM2ZmZTIiPltlbWFpbCYjMTYwO3Byb3RlY3RlZF08L2E+PgoKIENvbnRhaW5zIHRoZSBNaWxlc3RvbmVzIENvbnRyYWN0IGNvZGUgZGVwbG95ZWQgYW5kIGxpbmtlZCB0byB0aGUgQXBwbGljYXRpb24gRW50aXR5CgoqLwoKCgoKCgoKCgpjb250cmFjdCBNaWxlc3RvbmVzIGlzIEFwcGxpY2F0aW9uQXNzZXQgewoKICAgIEFCSUZ1bmRpbmdNYW5hZ2VyIEZ1bmRpbmdNYW5hZ2VyRW50aXR5OwogICAgQUJJUHJvcG9zYWxzIFByb3Bvc2Fsc0VudGl0eTsKICAgIEFCSU1lZXRpbmdzIE1lZXRpbmdzRW50aXR5OwoKICAgIHN0cnVjdCBSZWNvcmQgewogICAgICAgIGJ5dGVzMzIgbmFtZTsKICAgICAgICBzdHJpbmcgZGVzY3JpcHRpb247ICAgICAgICAgICAgICAgICAgICAgLy8gd2lsbCBjaGFuZ2UgdG8gaGFzaCBwb2ludGVyICggZXh0ZXJuYWwgc3RvcmFnZSApCiAgICAgICAgdWludDggc3RhdGU7CiAgICAgICAgdWludDI1NiBkdXJhdGlvbjsKICAgICAgICB1aW50MjU2IHRpbWVfc3RhcnQ7ICAgICAgICAgICAgICAgICAgICAgLy8gc3RhcnQgYXQgdW5peHRpbWVzdGFtcAogICAgICAgIHVpbnQyNTYgbGFzdF9zdGF0ZV9jaGFuZ2VfdGltZTsgICAgICAgICAvLyB0aW1lIG9mIGxhc3Qgc3RhdGUgY2hhbmdlCiAgICAgICAgdWludDI1NiB0aW1lX2VuZDsgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzdGltYXRlZCBlbmQgdGltZSA+PiBjYW4gYmUgaW5jcmVhc2VkIGJ5IHByb3Bvc2FsCiAgICAgICAgdWludDI1NiB0aW1lX2VuZGVkOyAgICAgICAgICAgICAgICAgICAgIC8vIGFjdHVhbCBlbmQgdGltZQogICAgICAgIHVpbnQyNTYgbWVldGluZ190aW1lOwogICAgICAgIHVpbnQ4IGZ1bmRpbmdfcGVyY2VudGFnZTsKICAgICAgICB1aW50OCBpbmRleDsKICAgIH0KCiAgICBtYXBwaW5nICh1aW50OCA9PiBSZWNvcmQpIHB1YmxpYyBDb2xsZWN0aW9uOwogICAgdWludDggcHVibGljIGN1cnJlbnRSZWNvcmQgPSAxOwoKICAgIGV2ZW50IERlYnVnUmVjb3JkUmVxdWlyZWRDaGFuZ2VzKCBieXRlczMyIGluZGV4ZWQgX2Fzc2V0TmFtZSwgdWludDggaW5kZXhlZCBfY3VycmVudCwgdWludDggaW5kZXhlZCBfcmVxdWlyZWQgKTsKICAgIGV2ZW50IERlYnVnQ2FsbEFnYWluKHVpbnQ4IGluZGV4ZWQgX3dobyk7CgogICAgZXZlbnQgRXZlbnRFbnRpdHlQcm9jZXNzb3IoYnl0ZXMzMiBpbmRleGVkIF9hc3NldE5hbWUsIHVpbnQ4IGluZGV4ZWQgX2N1cnJlbnQsIHVpbnQ4IGluZGV4ZWQgX3JlcXVpcmVkKTsKICAgIGV2ZW50IEV2ZW50UmVjb3JkUHJvY2Vzc29yKGJ5dGVzMzIgaW5kZXhlZCBfYXNzZXROYW1lLCB1aW50OCBpbmRleGVkIF9jdXJyZW50LCB1aW50OCBpbmRleGVkIF9yZXF1aXJlZCk7CgogICAgZXZlbnQgRGVidWdBY3Rpb24oYnl0ZXMzMiBpbmRleGVkIF9uYW1lLCBib29sIGluZGV4ZWQgX2FsbG93ZWQpOwoKCiAgICBmdW5jdGlvbiBzZXRBc3NldFN0YXRlcygpIGludGVybmFsIHsKCiAgICAgICAgLy8gQ29udHJhY3QgU3RhdGVzCiAgICAgICAgRW50aXR5U3RhdGVzWyJfX0lHTk9SRURfXyJdICAgICAgICAgICAgICAgICAgPSAwOwogICAgICAgIEVudGl0eVN0YXRlc1siTkVXIl0gICAgICAgICAgICAgICAgICAgICAgICAgID0gMTsKICAgICAgICBFbnRpdHlTdGF0ZXNbIldBSVRJTkciXSAgICAgICAgICAgICAgICAgICAgICA9IDI7CgogICAgICAgIEVudGl0eVN0YXRlc1siSU5fREVWRUxPUE1FTlQiXSAgICAgICAgICAgICAgID0gNTsKCiAgICAgICAgRW50aXR5U3RhdGVzWyJXQUlUSU5HX01FRVRJTkdfVElNRSJdICAgICAgICAgPSAxMDsKICAgICAgICBFbnRpdHlTdGF0ZXNbIkRFQURMSU5FX01FRVRJTkdfVElNRV9ZRVMiXSAgICA9IDExOwogICAgICAgIEVudGl0eVN0YXRlc1siREVBRExJTkVfTUVFVElOR19USU1FX0ZBSUxFRCJdID0gMTI7CgogICAgICAgIEVudGl0eVN0YXRlc1siVk9USU5HX0lOX1BST0dSRVNTIl0gICAgICAgICAgID0gMjA7CiAgICAgICAgLy8gRW50aXR5U3RhdGVzWyJWT1RJTkdfRU5ERUQiXSAgICAgICAgICAgICAgPSAyMTsKICAgICAgICBFbnRpdHlTdGF0ZXNbIlZPVElOR19FTkRFRF9ZRVMiXSAgICAgICAgICAgICA9IDIyOwogICAgICAgIEVudGl0eVN0YXRlc1siVk9USU5HX0VOREVEX05PIl0gICAgICAgICAgICAgID0gMjM7CiAgICAgICAgRW50aXR5U3RhdGVzWyJWT1RJTkdfRU5ERURfTk9fRklOQUwiXSAgICAgICAgPSAyNTsKCiAgICAgICAgRW50aXR5U3RhdGVzWyJWT1RJTkdfRlVORFNfUFJPQ0VTU0VEIl0gICAgICAgPSAzMDsKICAgICAgICBFbnRpdHlTdGF0ZXNbIkZJTkFMIl0gICAgICAgICAgICAgICAgICAgICAgICA9IDUwOwoKICAgICAgICBFbnRpdHlTdGF0ZXNbIkNBU0hCQUNLX09XTkVSX01JQSJdICAgICAgICAgICA9IDk5OwogICAgICAgIEVudGl0eVN0YXRlc1siREVWRUxPUE1FTlRfQ09NUExFVEUiXSAgICAgICAgID0gMjUwOwoKICAgICAgICAvLyBGdW5kaW5nIFN0YWdlIFN0YXRlcwogICAgICAgIFJlY29yZFN0YXRlc1siX19JR05PUkVEX18iXSAgICAgPSAwOwogICAgICAgIFJlY29yZFN0YXRlc1siTkVXIl0gICAgICAgICAgICAgPSAxOwogICAgICAgIFJlY29yZFN0YXRlc1siSU5fUFJPR1JFU1MiXSAgICAgPSAyOwogICAgICAgIFJlY29yZFN0YXRlc1siRklOQUwiXSAgICAgICAgICAgPSAzOwogICAgfQoKICAgIGZ1bmN0aW9uIHJ1bkJlZm9yZUluaXRpYWxpemF0aW9uKCkgaW50ZXJuYWwgcmVxdWlyZU5vdEluaXRpYWxpc2VkIHsKICAgICAgICBGdW5kaW5nTWFuYWdlckVudGl0eSA9IEFCSUZ1bmRpbmdNYW5hZ2VyKCBnZXRBcHBsaWNhdGlvbkFzc2V0QWRkcmVzc0J5TmFtZSgnRnVuZGluZ01hbmFnZXInKSApOwogICAgICAgIE1lZXRpbmdzRW50aXR5ID0gQUJJTWVldGluZ3MoIGdldEFwcGxpY2F0aW9uQXNzZXRBZGRyZXNzQnlOYW1lKCdNZWV0aW5ncycpICk7CiAgICAgICAgUHJvcG9zYWxzRW50aXR5ID0gQUJJUHJvcG9zYWxzKCBnZXRBcHBsaWNhdGlvbkFzc2V0QWRkcmVzc0J5TmFtZSgnUHJvcG9zYWxzJykgKTsKICAgICAgICBFdmVudFJ1bkJlZm9yZUluaXQoYXNzZXROYW1lKTsKICAgIH0KCiAgICBmdW5jdGlvbiBydW5CZWZvcmVBcHBseWluZ1NldHRpbmdzKCkgaW50ZXJuYWwgcmVxdWlyZUluaXRpYWxpc2VkIHJlcXVpcmVTZXR0aW5nc05vdEFwcGxpZWQgIHsKICAgICAgICAvLyBzZXR1cCBmaXJzdCBtaWxlc3RvbmUKICAgICAgICBSZWNvcmQgc3RvcmFnZSByZWMgPSBDb2xsZWN0aW9uW2N1cnJlbnRSZWNvcmRdOwogICAgICAgICAgICByZWMudGltZV9zdGFydCA9IGdldEJ5bGF3c1Byb2plY3REZXZlbG9wbWVudFN0YXJ0KCk7CiAgICAgICAgICAgIHJlYy50aW1lX2VuZCA9IHJlYy50aW1lX3N0YXJ0ICsgcmVjLmR1cmF0aW9uOwogICAgICAgIEV2ZW50UnVuQmVmb3JlQXBwbHlpbmdTZXR0aW5ncyhhc3NldE5hbWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEJ5bGF3c1Byb2plY3REZXZlbG9wbWVudFN0YXJ0KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBnZXRBcHBCeWxhd1VpbnQyNTYoImRldmVsb3BtZW50X3N0YXJ0Iik7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QnlsYXdzTWluVGltZUluVGhlRnV0dXJlRm9yTWVldGluZ0NyZWF0aW9uKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBnZXRBcHBCeWxhd1VpbnQyNTYoIm1lZXRpbmdfdGltZV9zZXRfcmVxIik7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QnlsYXdzQ2FzaEJhY2tWb3RlUmVqZWN0ZWREdXJhdGlvbigpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICByZXR1cm4gZ2V0QXBwQnlsYXdVaW50MjU2KCJjYXNoYmFja19pbnZlc3Rvcl9ubyIpOwogICAgfQoKICAgIC8qCiAgICAqIEFkZCBSZWNvcmQKICAgICoKICAgICogQHBhcmFtICAgICAgICBieXRlczMyIF9uYW1lCiAgICAqIEBwYXJhbSAgICAgICAgc3RyaW5nIF9kZXNjcmlwdGlvbgogICAgKiBAcGFyYW0gICAgICAgIHVpbnQyNTYgX2R1cmF0aW9uCiAgICAqIEBwYXJhbSAgICAgICAgdWludDI1NiBfZnVuZGluZ19wZXJjZW50YWdlCiAgICAqCiAgICAqIEBhY2Nlc3MgICAgICAgcHVibGljCiAgICAqIEB0eXBlICAgICAgICAgbWV0aG9kCiAgICAqIEBtb2RpZmllcnMgICAgb25seURlcGxveWVyLCByZXF1aXJlTm90SW5pdGlhbGlzZWQKICAgICovCiAgICBmdW5jdGlvbiBhZGRSZWNvcmQoCiAgICAgICAgYnl0ZXMzMiBfbmFtZSwKICAgICAgICBzdHJpbmcgX2Rlc2NyaXB0aW9uLAogICAgICAgIHVpbnQyNTYgX2R1cmF0aW9uLAogICAgICAgIHVpbnQ4ICAgX3BlcmMKICAgICkKICAgICAgICBwdWJsaWMKICAgICAgICBvbmx5RGVwbG95ZXIKICAgICAgICByZXF1aXJlU2V0dGluZ3NOb3RBcHBsaWVkCiAgICB7CgogICAgICAgIFJlY29yZCBzdG9yYWdlIHJlYyA9IENvbGxlY3Rpb25bKytSZWNvcmROdW1dOwoKICAgICAgICByZWMubmFtZSAgICAgICAgICAgICAgICA9IF9uYW1lOwogICAgICAgIHJlYy5kZXNjcmlwdGlvbiAgICAgICAgID0gX2Rlc2NyaXB0aW9uOwogICAgICAgIHJlYy5kdXJhdGlvbiAgICAgICAgICAgID0gX2R1cmF0aW9uOwogICAgICAgIHJlYy5mdW5kaW5nX3BlcmNlbnRhZ2UgID0gX3BlcmM7CiAgICAgICAgcmVjLnN0YXRlICAgICAgICAgICAgICAgPSBnZXRSZWNvcmRTdGF0ZSgiTkVXIik7CiAgICAgICAgcmVjLmluZGV4ICAgICAgICAgICAgICAgPSBSZWNvcmROdW07CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0TWlsZXN0b25lRnVuZGluZ1BlcmNlbnRhZ2UodWludDggcmVjb3JkSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KXsKICAgICAgICByZXR1cm4gQ29sbGVjdGlvbltyZWNvcmRJZF0uZnVuZGluZ19wZXJjZW50YWdlOwogICAgfQoKICAgIGZ1bmN0aW9uIGRvU3RhdGVDaGFuZ2VzKCkgcHVibGljIHsKCiAgICAgICAgdmFyIChDdXJyZW50UmVjb3JkU3RhdGUsIFJlY29yZFN0YXRlUmVxdWlyZWQsIEVudGl0eVN0YXRlUmVxdWlyZWQpID0gZ2V0UmVxdWlyZWRTdGF0ZUNoYW5nZXMoKTsKICAgICAgICBib29sIGNhbGxBZ2FpbiA9IGZhbHNlOwoKICAgICAgICBEZWJ1Z1JlY29yZFJlcXVpcmVkQ2hhbmdlcyggYXNzZXROYW1lLCBDdXJyZW50UmVjb3JkU3RhdGUsIFJlY29yZFN0YXRlUmVxdWlyZWQgKTsKICAgICAgICBEZWJ1Z0VudGl0eVJlcXVpcmVkQ2hhbmdlcyggYXNzZXROYW1lLCBDdXJyZW50RW50aXR5U3RhdGUsIEVudGl0eVN0YXRlUmVxdWlyZWQgKTsKCiAgICAgICAgaWYoIFJlY29yZFN0YXRlUmVxdWlyZWQgIT0gZ2V0UmVjb3JkU3RhdGUoIl9fSUdOT1JFRF9fIikgKSB7CiAgICAgICAgICAgIC8vIHByb2Nlc3MgcmVjb3JkIGNoYW5nZXMuCiAgICAgICAgICAgIFJlY29yZFByb2Nlc3NvcihDdXJyZW50UmVjb3JkU3RhdGUsIFJlY29yZFN0YXRlUmVxdWlyZWQpOwogICAgICAgICAgICBEZWJ1Z0NhbGxBZ2FpbigyKTsKICAgICAgICAgICAgY2FsbEFnYWluID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIGlmKEVudGl0eVN0YXRlUmVxdWlyZWQgIT0gZ2V0RW50aXR5U3RhdGUoIl9fSUdOT1JFRF9fIikgKSB7CiAgICAgICAgICAgIC8vIHByb2Nlc3MgZW50aXR5IGNoYW5nZXMuCiAgICAgICAgICAgIEVudGl0eVByb2Nlc3NvcihFbnRpdHlTdGF0ZVJlcXVpcmVkKTsKICAgICAgICAgICAgRGVidWdDYWxsQWdhaW4oMSk7CiAgICAgICAgICAgIGNhbGxBZ2FpbiA9IHRydWU7CiAgICAgICAgfQoKCiAgICB9CgogICAgZnVuY3Rpb24gTWlsZXN0b25lc0NhbkNoYW5nZSgpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmKAogICAgICAgICAgICBDdXJyZW50RW50aXR5U3RhdGUgPT0gZ2V0RW50aXR5U3RhdGUoIldBSVRJTkciKSB8fAogICAgICAgICAgICBDdXJyZW50RW50aXR5U3RhdGUgPT0gZ2V0RW50aXR5U3RhdGUoIklOX0RFVkVMT1BNRU5UIikgfHwKICAgICAgICAgICAgQ3VycmVudEVudGl0eVN0YXRlID09IGdldEVudGl0eVN0YXRlKCJWT1RJTkdfRlVORFNfUFJPQ0VTU0VEIikKICAgICAgICApIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCgogICAgLyoKICAgICAqIE1ldGhvZDogR2V0IFJlY29yZCBSZXF1aXJlZCBTdGF0ZSBDaGFuZ2VzCiAgICAgKgogICAgICogQGFjY2VzcyAgICAgICBwdWJsaWMKICAgICAqIEB0eXBlICAgICAgICAgbWV0aG9kCiAgICAgKgogICAgICogQHJldHVybiAgICAgICB1aW50OCBSZWNvcmRTdGF0ZVJlcXVpcmVkCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFJlY29yZFN0YXRlUmVxdWlyZWRDaGFuZ2VzKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDgpIHsKICAgICAgICBSZWNvcmQgbWVtb3J5IHJlY29yZCA9IENvbGxlY3Rpb25bY3VycmVudFJlY29yZF07CiAgICAgICAgdWludDggUmVjb3JkU3RhdGVSZXF1aXJlZCA9IGdldFJlY29yZFN0YXRlKCJfX0lHTk9SRURfXyIpOwoKICAgICAgICBpZiggQXBwbGljYXRpb25Jc0luRGV2ZWxvcG1lbnQoKSAmJiBNaWxlc3RvbmVzQ2FuQ2hhbmdlKCkgKSB7CgogICAgICAgICAgICBpZiggcmVjb3JkLnN0YXRlID09IGdldFJlY29yZFN0YXRlKCJORVciKSApIHsKCiAgICAgICAgICAgICAgICBpZiggZ2V0VGltZXN0YW1wKCkgPj0gcmVjb3JkLnRpbWVfc3RhcnQgKSB7CiAgICAgICAgICAgICAgICAgICAgUmVjb3JkU3RhdGVSZXF1aXJlZCA9IGdldFJlY29yZFN0YXRlKCJJTl9QUk9HUkVTUyIpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfSBlbHNlIGlmKCByZWNvcmQuc3RhdGUgPT0gZ2V0UmVjb3JkU3RhdGUoIklOX1BST0dSRVNTIikgKSB7CgogICAgICAgICAgICAgICAgaWYoIGdldFRpbWVzdGFtcCgpID49IHJlY29yZC50aW1lX2VuZCB8fCAoIGdldFRpbWVzdGFtcCgpID49IHJlY29yZC5tZWV0aW5nX3RpbWUgJiYgcmVjb3JkLm1lZXRpbmdfdGltZSA+IDAgKSApIHsKICAgICAgICAgICAgICAgICAgICBSZWNvcmRTdGF0ZVJlcXVpcmVkID0gZ2V0UmVjb3JkU3RhdGUoIkZJTkFMIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKCByZWNvcmQuc3RhdGUgPT0gUmVjb3JkU3RhdGVSZXF1aXJlZCApIHsKICAgICAgICAgICAgICAgIFJlY29yZFN0YXRlUmVxdWlyZWQgPSBnZXRSZWNvcmRTdGF0ZSgiX19JR05PUkVEX18iKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gUmVjb3JkU3RhdGVSZXF1aXJlZDsKICAgIH0KCgogICAgZnVuY3Rpb24gaGFzUmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAgICAgYm9vbCBoYXNDaGFuZ2VzID0gZmFsc2U7CiAgICAgICAgdmFyIChDdXJyZW50UmVjb3JkU3RhdGUsIFJlY29yZFN0YXRlUmVxdWlyZWQsIEVudGl0eVN0YXRlUmVxdWlyZWQpID0gZ2V0UmVxdWlyZWRTdGF0ZUNoYW5nZXMoKTsKICAgICAgICBDdXJyZW50UmVjb3JkU3RhdGUgPSAwOwoKICAgICAgICBpZiggUmVjb3JkU3RhdGVSZXF1aXJlZCAhPSBnZXRSZWNvcmRTdGF0ZSgiX19JR05PUkVEX18iKSApIHsKICAgICAgICAgICAgaGFzQ2hhbmdlcyA9IHRydWU7CiAgICAgICAgfQogICAgICAgIGlmKEVudGl0eVN0YXRlUmVxdWlyZWQgIT0gZ2V0RW50aXR5U3RhdGUoIl9fSUdOT1JFRF9fIikgKSB7CiAgICAgICAgICAgIGhhc0NoYW5nZXMgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGhhc0NoYW5nZXM7CiAgICB9CgogICAgLy8gdmlldyBtZXRob2RzIGRlY2lkZSBpZiBjaGFuZ2VzIGFyZSB0byBiZSBtYWRlCiAgICAvLyBpbiBjYXNlIG9mIHRhc2tzLCB3ZSBkbyB0aGVtIGluIHRoZSBQcm9jZXNzb3JzLgoKICAgIGZ1bmN0aW9uIFJlY29yZFByb2Nlc3Nvcih1aW50OCBDdXJyZW50UmVjb3JkU3RhdGUsIHVpbnQ4IFJlY29yZFN0YXRlUmVxdWlyZWQpIGludGVybmFsIHsKICAgICAgICBFdmVudFJlY29yZFByb2Nlc3NvciggYXNzZXROYW1lLCBDdXJyZW50UmVjb3JkU3RhdGUsIFJlY29yZFN0YXRlUmVxdWlyZWQgKTsKICAgICAgICB1cGRhdGVSZWNvcmQoIFJlY29yZFN0YXRlUmVxdWlyZWQgKTsKICAgIH0KCgogICAgZnVuY3Rpb24gRW50aXR5UHJvY2Vzc29yKHVpbnQ4IEVudGl0eVN0YXRlUmVxdWlyZWQpIGludGVybmFsIHsKICAgICAgICBFdmVudEVudGl0eVByb2Nlc3NvciggYXNzZXROYW1lLCBDdXJyZW50RW50aXR5U3RhdGUsIEVudGl0eVN0YXRlUmVxdWlyZWQgKTsKCiAgICAgICAgLy8gRG8gU3RhdGUgU3BlY2lmaWMgVXBkYXRlcwogICAgICAgIC8vIFVwZGF0ZSBvdXIgRW50aXR5IFN0YXRlCiAgICAgICAgQ3VycmVudEVudGl0eVN0YXRlID0gRW50aXR5U3RhdGVSZXF1aXJlZDsKCiAgICAgICAgaWYgKCBDdXJyZW50RW50aXR5U3RhdGUgPT0gZ2V0RW50aXR5U3RhdGUoIkRFQURMSU5FX01FRVRJTkdfVElNRV9ZRVMiKSApIHsKICAgICAgICAgICAgLy8gY3JlYXRlIG1lZXRpbmcKICAgICAgICAgICAgLy8gTWVldGluZ3MuY3JlYXRlKCJpbnRlcm5hbCIsICJNSUxFU1RPTkVfRU5EIiwgIiIpOwoKICAgICAgICB9IGVsc2UgaWYoIEN1cnJlbnRFbnRpdHlTdGF0ZSA9PSBnZXRFbnRpdHlTdGF0ZSgiVk9USU5HX0lOX1BST0dSRVNTIikgKSB7CiAgICAgICAgICAgIC8vIGNyZWF0ZSBwcm9wb3NhbCBhbmQgc3RhcnQgdm90aW5nIG9uIGl0CiAgICAgICAgICAgIGNyZWF0ZU1pbGVzdG9uZUFjY2VwdGFuY2VQcm9wb3NhbCgpOwoKICAgICAgICB9IGVsc2UgaWYoIEN1cnJlbnRFbnRpdHlTdGF0ZSA9PSBnZXRFbnRpdHlTdGF0ZSgiV0FJVElOR19NRUVUSU5HX1RJTUUiKSApIHsKCiAgICAgICAgICAgIFBvc3Rwb25lTWVldGluZ0lmQXBwcm92ZWQoKTsKCiAgICAgICAgfSBlbHNlIGlmKCBDdXJyZW50RW50aXR5U3RhdGUgPT0gZ2V0RW50aXR5U3RhdGUoIlZPVElOR19FTkRFRF9ZRVMiKSApIHsKCiAgICAgICAgfSBlbHNlIGlmKCBDdXJyZW50RW50aXR5U3RhdGUgPT0gZ2V0RW50aXR5U3RhdGUoIlZPVElOR19FTkRFRF9OTyIpICkgewoKICAgICAgICAgICAgLy8gcG9zc2libGUgY2FzaGJhY2sgdGltZSBzdGFydHMgZnJvbSBub3cKICAgICAgICAgICAgTWlsZXN0b25lQ2FzaEJhY2tUaW1lID0gZ2V0VGltZXN0YW1wKCk7CgogICAgICAgIH0gZWxzZSBpZiggQ3VycmVudEVudGl0eVN0YXRlID09IGdldEVudGl0eVN0YXRlKCJWT1RJTkdfRlVORFNfUFJPQ0VTU0VEIikgKSB7CiAgICAgICAgICAgIE1pbGVzdG9uZUNhc2hCYWNrVGltZSA9IDA7CiAgICAgICAgICAgIHN0YXJ0TmV4dE1pbGVzdG9uZSgpOwogICAgICAgIH0KCiAgICB9CgogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiBib29sKSBwdWJsaWMgTWlsZXN0b25lUG9zdHBvbmluZ0hhc2g7CgogICAgZnVuY3Rpb24gUG9zdHBvbmVNZWV0aW5nSWZBcHByb3ZlZCgpIGludGVybmFsIHsKICAgICAgICBpZihNaWxlc3RvbmVQb3N0cG9uaW5nSGFzaFsgYnl0ZXMzMihjdXJyZW50UmVjb3JkKSBdID09IGZhbHNlICkgewogICAgICAgICAgICBpZihQb3N0cG9uZUZvckN1cnJlbnRNaWxlc3RvbmVJc0FwcHJvdmVkKCkpIHsKICAgICAgICAgICAgICAgIHVpbnQyNTYgdGltZSA9IFByb3Bvc2Fsc0VudGl0eS5nZXRDdXJyZW50TWlsZXN0b25lUG9zdHBvbmluZ1Byb3Bvc2FsRHVyYXRpb24oKTsKICAgICAgICAgICAgICAgIFJlY29yZCBzdG9yYWdlIHJlY29yZCA9IENvbGxlY3Rpb25bY3VycmVudFJlY29yZF07CiAgICAgICAgICAgICAgICByZWNvcmQudGltZV9lbmQgPSByZWNvcmQudGltZV9lbmQgKyB0aW1lOwogICAgICAgICAgICAgICAgTWlsZXN0b25lUG9zdHBvbmluZ0hhc2hbIGJ5dGVzMzIoY3VycmVudFJlY29yZCkgXSA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gUG9zdHBvbmVGb3JDdXJyZW50TWlsZXN0b25lSXNBcHByb3ZlZCgpIGludGVybmFsIHZpZXcgcmV0dXJucyAoIGJvb2wgKSB7CiAgICAgICAgdWludDggUHJvcG9zYWxBY3Rpb25UeXBlID0gUHJvcG9zYWxzRW50aXR5LmdldEFjdGlvblR5cGUoIk1JTEVTVE9ORV9QT1NUUE9OSU5HIik7CiAgICAgICAgdWludDggUHJvcG9zYWxSZWNvcmRTdGF0ZSA9IFByb3Bvc2Fsc0VudGl0eS5nZXRDdXJyZW50TWlsZXN0b25lUHJvcG9zYWxTdGF0dXNGb3JUeXBlKCBQcm9wb3NhbEFjdGlvblR5cGUgICk7CiAgICAgICAgaWYoUHJvcG9zYWxSZWNvcmRTdGF0ZSA9PSBQcm9wb3NhbHNFbnRpdHkuZ2V0UmVjb3JkU3RhdGUoIlZPVElOR19SRVNVTFRfWUVTIikgKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgdWludDI1NiBwdWJsaWMgTWlsZXN0b25lQ2FzaEJhY2tUaW1lID0gMDsKCiAgICBmdW5jdGlvbiBhZnRlclZvdGVOb0Nhc2hCYWNrVGltZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKCBib29sICkgewogICAgICAgIHVpbnQyNTYgdGltZSA9ICBNaWxlc3RvbmVDYXNoQmFja1RpbWUgKyBnZXRCeWxhd3NDYXNoQmFja1ZvdGVSZWplY3RlZER1cmF0aW9uKCk7CiAgICAgICAgLy8gYWZ0ZXIgY2FzaCBiYWNrIHRpbWUKICAgICAgICBpZihnZXRUaW1lc3RhbXAoKSA+IHRpbWUpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRIYXNoKHVpbnQ4IGFjdGlvblR5cGUsIGJ5dGVzMzIgYXJnMSwgYnl0ZXMzMiBhcmcyKSBwdWJsaWMgcHVyZSByZXR1cm5zICggYnl0ZXMzMiApIHsKICAgICAgICByZXR1cm4ga2VjY2FrMjU2KGFjdGlvblR5cGUsIGFyZzEsIGFyZzIpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRIYXNoKCkgcHVibGljIHZpZXcgcmV0dXJucyAoIGJ5dGVzMzIgKSB7CiAgICAgICAgcmV0dXJuIGdldEhhc2goMSwgYnl0ZXMzMihjdXJyZW50UmVjb3JkKSwgMCk7CiAgICB9CgogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiB1aW50MjU2KSBwdWJsaWMgUHJvcG9zYWxJZEJ5SGFzaDsKICAgIGZ1bmN0aW9uIGNyZWF0ZU1pbGVzdG9uZUFjY2VwdGFuY2VQcm9wb3NhbCgpIGludGVybmFsIHsKICAgICAgICBpZihQcm9wb3NhbElkQnlIYXNoWyBnZXRDdXJyZW50SGFzaCgpIF0gPT0gMHgwICkgewogICAgICAgICAgICBQcm9wb3NhbElkQnlIYXNoWyBnZXRDdXJyZW50SGFzaCgpIF0gPSBQcm9wb3NhbHNFbnRpdHkuY3JlYXRlTWlsZXN0b25lQWNjZXB0YW5jZVByb3Bvc2FsKCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRQcm9wb3NhbElkKCkgaW50ZXJuYWwgdmlldyByZXR1cm5zICggdWludDI1NiApIHsKICAgICAgICByZXR1cm4gUHJvcG9zYWxJZEJ5SGFzaFsgZ2V0Q3VycmVudEhhc2goKSBdOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEN1cnJlbnRNaWxlc3RvbmVNZWV0aW5nVGltZSh1aW50MjU2IF9tZWV0aW5nX3RpbWUpIHB1YmxpYyBvbmx5RGVwbG95ZXIgewogICAgICAgIGlmICggQ3VycmVudEVudGl0eVN0YXRlID09IGdldEVudGl0eVN0YXRlKCJXQUlUSU5HX01FRVRJTkdfVElNRSIpICkgewogICAgICAgICAgICBpZihNZWV0aW5nVGltZVNldEZhaWx1cmUoKSA9PSBmYWxzZSApIHsKICAgICAgICAgICAgICAgIFJlY29yZCBzdG9yYWdlIHJlY29yZCA9IENvbGxlY3Rpb25bY3VycmVudFJlY29yZF07CiAgICAgICAgICAgICAgICAvLyBtaW5pbXVtIHggZGF5cyBpbnRvIHRoZSBmdXR1cmUKICAgICAgICAgICAgICAgIHVpbnQyNTYgbWluID0gZ2V0VGltZXN0YW1wKCkgKyBnZXRCeWxhd3NNaW5UaW1lSW5UaGVGdXR1cmVGb3JNZWV0aW5nQ3JlYXRpb24oKTsKICAgICAgICAgICAgICAgIC8vIG1pbmltdW0gZGF5cyBiZWZvcmUgZW5kIGRhdGUKICAgICAgICAgICAgICAgIHVpbnQyNTYgbWF4ID0gcmVjb3JkLnRpbWVfZW5kICsgMjQgKiAzNjAwOwogICAgICAgICAgICAgICAgaWYoX21lZXRpbmdfdGltZSA+IG1pbiAmJiBfbWVldGluZ190aW1lIDwgbWF4ICkgewogICAgICAgICAgICAgICAgICAgIHJlY29yZC5tZWV0aW5nX3RpbWUgPSBfbWVldGluZ190aW1lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV2ZXJ0KCk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXZlcnQoKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gc3RhcnROZXh0TWlsZXN0b25lKCkgaW50ZXJuYWwgewogICAgICAgIFJlY29yZCBzdG9yYWdlIHJlYyA9IENvbGxlY3Rpb25bY3VycmVudFJlY29yZF07CgogICAgICAgIC8vIHNldCBjdXJyZW50IHJlY29yZCBlbmQgZGF0ZSBldGMKICAgICAgICByZWMudGltZV9lbmRlZCA9IGdldFRpbWVzdGFtcCgpOwogICAgICAgIHJlYy5zdGF0ZSA9IGdldFJlY29yZFN0YXRlKCJGSU5BTCIpOwoKICAgICAgICBpZihjdXJyZW50UmVjb3JkIDwgUmVjb3JkTnVtKSB7CiAgICAgICAgICAgIC8vIGp1bXAgdG8gbmV4dCBtaWxlc3RvbmUKICAgICAgICAgICAgY3VycmVudFJlY29yZCsrOwoKICAgICAgICAgICAgUmVjb3JkIHN0b3JhZ2UgbmV4dFJlYyA9IENvbGxlY3Rpb25bY3VycmVudFJlY29yZF07CiAgICAgICAgICAgICAgICBuZXh0UmVjLnRpbWVfc3RhcnQgPSByZWMudGltZV9lbmRlZDsKICAgICAgICAgICAgICAgIG5leHRSZWMudGltZV9lbmQgPSByZWMudGltZV9lbmRlZCArIG5leHRSZWMuZHVyYXRpb247CiAgICAgICAgfQoKICAgIH0KCiAgICAvKgogICAgKiBVcGRhdGUgRXhpc3RpbmcgUmVjb3JkCiAgICAqCiAgICAqIEBwYXJhbSAgICAgICAgdWludDggX3JlY29yZF9pZAogICAgKiBAcGFyYW0gICAgICAgIHVpbnQ4IF9uZXdfc3RhdGUKICAgICogQHBhcmFtICAgICAgICB1aW50OCBfZHVyYXRpb24KICAgICoKICAgICogQGFjY2VzcyAgICAgICBwdWJsaWMKICAgICogQHR5cGUgICAgICAgICBtZXRob2QKICAgICogQG1vZGlmaWVycyAgICBvbmx5T3duZXIsIHJlcXVpcmVJbml0aWFsaXNlZCwgUmVjb3JkVXBkYXRlQWxsb3dlZAogICAgKgogICAgKiBAcmV0dXJuICAgICAgIHZvaWQKICAgICovCgogICAgZnVuY3Rpb24gdXBkYXRlUmVjb3JkKCB1aW50OCBfbmV3X3N0YXRlICkKICAgICAgICBpbnRlcm5hbAogICAgICAgIHJlcXVpcmVJbml0aWFsaXNlZAogICAgICAgIFJlY29yZFVwZGF0ZUFsbG93ZWQoX25ld19zdGF0ZSkKICAgICAgICByZXR1cm5zIChib29sKQogICAgewogICAgICAgIFJlY29yZCBzdG9yYWdlIHJlYyA9IENvbGxlY3Rpb25bY3VycmVudFJlY29yZF07CiAgICAgICAgcmVjLnN0YXRlICAgICAgID0gX25ld19zdGF0ZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCgogICAgLyoKICAgICogTW9kaWZpZXI6IFZhbGlkYXRlIGlmIHJlY29yZCB1cGRhdGVzIGFyZSBhbGxvd2VkCiAgICAqCiAgICAqIEB0eXBlICAgICAgICAgbW9kaWZpZXIKICAgICoKICAgICogQHBhcmFtICAgICAgICB1aW50OCBfcmVjb3JkX2lkCiAgICAqIEBwYXJhbSAgICAgICAgdWludDggX25ld19zdGF0ZQogICAgKiBAcGFyYW0gICAgICAgIHVpbnQyNTYgX2R1cmF0aW9uCiAgICAqCiAgICAqIEByZXR1cm4gICAgICAgYm9vbAogICAgKi8KCiAgICBtb2RpZmllciBSZWNvcmRVcGRhdGVBbGxvd2VkKHVpbnQ4IF9uZXdfc3RhdGUpIHsKICAgICAgICByZXF1aXJlKCBpc1JlY29yZFVwZGF0ZUFsbG93ZWQoIF9uZXdfc3RhdGUgKSAgKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qCiAgICAgKiBNZXRob2Q6IFZhbGlkYXRlIGlmIHJlY29yZCBjYW4gYmUgdXBkYXRlZCB0byByZXF1ZXN0ZWQgc3RhdGUKICAgICAqCiAgICAgKiBAYWNjZXNzICAgICAgIHB1YmxpYwogICAgICogQHR5cGUgICAgICAgICBtZXRob2QKICAgICAqCiAgICAgKiBAcGFyYW0gICAgICAgIHVpbnQ4IF9yZWNvcmRfaWQKICAgICAqIEBwYXJhbSAgICAgICAgdWludDggX25ld19zdGF0ZQogICAgICoKICAgICAqIEByZXR1cm4gICAgICAgYm9vbAogICAgICovCiAgICBmdW5jdGlvbiBpc1JlY29yZFVwZGF0ZUFsbG93ZWQodWludDggX25ld19zdGF0ZSApIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKCiAgICAgICAgdmFyIChDdXJyZW50UmVjb3JkU3RhdGUsIFJlY29yZFN0YXRlUmVxdWlyZWQsIEVudGl0eVN0YXRlUmVxdWlyZWQpID0gZ2V0UmVxdWlyZWRTdGF0ZUNoYW5nZXMoKTsKCiAgICAgICAgQ3VycmVudFJlY29yZFN0YXRlID0gMDsKICAgICAgICBFbnRpdHlTdGF0ZVJlcXVpcmVkID0gMDsKCiAgICAgICAgaWYoX25ld19zdGF0ZSA9PSB1aW50OChSZWNvcmRTdGF0ZVJlcXVpcmVkKSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qCiAgICAgKiBNZXRob2Q6IEdldCBSZWNvcmQgYW5kIEVudGl0eSBTdGF0ZSBDaGFuZ2VzCiAgICAgKgogICAgICogQGFjY2VzcyAgICAgICBwdWJsaWMKICAgICAqIEB0eXBlICAgICAgICAgbWV0aG9kCiAgICAgKgogICAgICogQHJldHVybiAgICAgICAoIHVpbnQ4IEN1cnJlbnRSZWNvcmRTdGF0ZSwgdWludDggUmVjb3JkU3RhdGVSZXF1aXJlZCwgdWludDggRW50aXR5U3RhdGVSZXF1aXJlZCkKICAgICAqLwogICAgZnVuY3Rpb24gZ2V0UmVxdWlyZWRTdGF0ZUNoYW5nZXMoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50OCwgdWludDgsIHVpbnQ4KSB7CgogICAgICAgIFJlY29yZCBtZW1vcnkgcmVjb3JkID0gQ29sbGVjdGlvbltjdXJyZW50UmVjb3JkXTsKCiAgICAgICAgdWludDggQ3VycmVudFJlY29yZFN0YXRlID0gcmVjb3JkLnN0YXRlOwogICAgICAgIHVpbnQ4IFJlY29yZFN0YXRlUmVxdWlyZWQgPSBnZXRSZWNvcmRTdGF0ZVJlcXVpcmVkQ2hhbmdlcygpOwogICAgICAgIHVpbnQ4IEVudGl0eVN0YXRlUmVxdWlyZWQgPSBnZXRFbnRpdHlTdGF0ZSgiX19JR05PUkVEX18iKTsKCiAgICAgICAgaWYoIEFwcGxpY2F0aW9uSXNJbkRldmVsb3BtZW50KCkgKSB7CgogICAgICAgICAgICAvLyBEbyBFbnRpdHkgQ2hlY2tzCgogICAgICAgICAgICBpZiAoIEN1cnJlbnRFbnRpdHlTdGF0ZSA9PSBnZXRFbnRpdHlTdGF0ZSgiV0FJVElORyIpICkgewoKICAgICAgICAgICAgICAgIGlmKFJlY29yZFN0YXRlUmVxdWlyZWQgPT0gZ2V0UmVjb3JkU3RhdGUoIklOX1BST0dSRVNTIikgKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gYm90aCByZWNvcmQgYW5kIGVudGl0eSBzdGF0ZXMgbmVlZCB0byBtb3ZlIHRvIElOX1BST0dSRVNTCiAgICAgICAgICAgICAgICAgICAgRW50aXR5U3RhdGVSZXF1aXJlZCA9IGdldEVudGl0eVN0YXRlKCJJTl9ERVZFTE9QTUVOVCIpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfSBlbHNlIGlmICggQ3VycmVudEVudGl0eVN0YXRlID09IGdldEVudGl0eVN0YXRlKCJJTl9ERVZFTE9QTUVOVCIpICkgewoKICAgICAgICAgICAgICAgIEVudGl0eVN0YXRlUmVxdWlyZWQgPSBnZXRFbnRpdHlTdGF0ZSgiV0FJVElOR19NRUVUSU5HX1RJTUUiKTsKCiAgICAgICAgICAgIH0gZWxzZSBpZiAoIEN1cnJlbnRFbnRpdHlTdGF0ZSA9PSBnZXRFbnRpdHlTdGF0ZSgiV0FJVElOR19NRUVUSU5HX1RJTUUiKSApIHsKCiAgICAgICAgICAgICAgICBpZihyZWNvcmQubWVldGluZ190aW1lID4gMCkgewoKICAgICAgICAgICAgICAgICAgICBFbnRpdHlTdGF0ZVJlcXVpcmVkID0gZ2V0RW50aXR5U3RhdGUoIkRFQURMSU5FX01FRVRJTkdfVElNRV9ZRVMiKTsKCiAgICAgICAgICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgICAgICAgICBpZihNaWxlc3RvbmVQb3N0cG9uaW5nSGFzaFsgYnl0ZXMzMihjdXJyZW50UmVjb3JkKSBdID09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKFBvc3Rwb25lRm9yQ3VycmVudE1pbGVzdG9uZUlzQXBwcm92ZWQoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgRW50aXR5U3RhdGVSZXF1aXJlZCA9IGdldEVudGl0eVN0YXRlKCJXQUlUSU5HX01FRVRJTkdfVElNRSIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZihNZWV0aW5nVGltZVNldEZhaWx1cmUoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBGb3JjZSBPd25lciBNaXNzaW5nIGluIEFjdGlvbiAtIENhc2ggQmFjayBQcm9jZWR1cmUKICAgICAgICAgICAgICAgICAgICAgICAgRW50aXR5U3RhdGVSZXF1aXJlZCA9IGdldEVudGl0eVN0YXRlKCJERUFETElORV9NRUVUSU5HX1RJTUVfRkFJTEVEIik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfSBlbHNlIGlmICggQ3VycmVudEVudGl0eVN0YXRlID09IGdldEVudGl0eVN0YXRlKCJERUFETElORV9NRUVUSU5HX1RJTUVfRkFJTEVEIikgKSB7CgoKICAgICAgICAgICAgfSBlbHNlIGlmICggQ3VycmVudEVudGl0eVN0YXRlID09IGdldEVudGl0eVN0YXRlKCJERUFETElORV9NRUVUSU5HX1RJTUVfWUVTIikgKSB7CgogICAgICAgICAgICAgICAgLy8gY3JlYXRlIHByb3Bvc2FsCiAgICAgICAgICAgICAgICAvLyBzdGFydCB2b3RpbmcgaWYgdGltZSBwYXNzZWQKICAgICAgICAgICAgICAgIGlmKGdldFRpbWVzdGFtcCgpID49IHJlY29yZC5tZWV0aW5nX3RpbWUgKSB7CiAgICAgICAgICAgICAgICAgICAgRW50aXR5U3RhdGVSZXF1aXJlZCA9IGdldEVudGl0eVN0YXRlKCJWT1RJTkdfSU5fUFJPR1JFU1MiKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIH0gZWxzZSBpZiAoIEN1cnJlbnRFbnRpdHlTdGF0ZSA9PSBnZXRFbnRpdHlTdGF0ZSgiVk9USU5HX0lOX1BST0dSRVNTIikgKSB7CgogICAgICAgICAgICAgICAgdWludDggUHJvcG9zYWxSZWNvcmRTdGF0ZSA9IFByb3Bvc2Fsc0VudGl0eS5nZXRQcm9wb3NhbFN0YXRlKCBnZXRDdXJyZW50UHJvcG9zYWxJZCgpICk7CgogICAgICAgICAgICAgICAgaWYgKCBQcm9wb3NhbFJlY29yZFN0YXRlID09IFByb3Bvc2Fsc0VudGl0eS5nZXRSZWNvcmRTdGF0ZSgiVk9USU5HX1JFU1VMVF9ZRVMiKSApIHsKICAgICAgICAgICAgICAgICAgICBFbnRpdHlTdGF0ZVJlcXVpcmVkID0gZ2V0RW50aXR5U3RhdGUoIlZPVElOR19FTkRFRF9ZRVMiKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoUHJvcG9zYWxSZWNvcmRTdGF0ZSA9PSBQcm9wb3NhbHNFbnRpdHkuZ2V0UmVjb3JkU3RhdGUoIlZPVElOR19SRVNVTFRfTk8iKSApIHsKICAgICAgICAgICAgICAgICAgICBFbnRpdHlTdGF0ZVJlcXVpcmVkID0gZ2V0RW50aXR5U3RhdGUoIlZPVElOR19FTkRFRF9OTyIpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfSBlbHNlIGlmICggQ3VycmVudEVudGl0eVN0YXRlID09IGdldEVudGl0eVN0YXRlKCJWT1RJTkdfRU5ERURfWUVTIikgKSB7CgogICAgICAgICAgICAgICAgaWYoIEZ1bmRpbmdNYW5hZ2VyRW50aXR5LkN1cnJlbnRFbnRpdHlTdGF0ZSgpID09IEZ1bmRpbmdNYW5hZ2VyRW50aXR5LmdldEVudGl0eVN0YXRlKCJNSUxFU1RPTkVfUFJPQ0VTU19ET05FIikpIHsKICAgICAgICAgICAgICAgICAgICBFbnRpdHlTdGF0ZVJlcXVpcmVkID0gZ2V0RW50aXR5U3RhdGUoIlZPVElOR19GVU5EU19QUk9DRVNTRUQiKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIH0gZWxzZSBpZiAoIEN1cnJlbnRFbnRpdHlTdGF0ZSA9PSBnZXRFbnRpdHlTdGF0ZSgiVk9USU5HX0VOREVEX05PIikgKSB7CgogICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgbWlsZXN0b25lIGNhc2hvdXQgcGVyaW9kIGhhcyBwYXNzZWQgYW5kIGlmIHNvIHByb2Nlc3MgZnVuZCByZWxlYXNlcwogICAgICAgICAgICAgICAgaWYoYWZ0ZXJWb3RlTm9DYXNoQmFja1RpbWUoKSkgewogICAgICAgICAgICAgICAgICAgIEVudGl0eVN0YXRlUmVxdWlyZWQgPSBnZXRFbnRpdHlTdGF0ZSgiVk9USU5HX0VOREVEX05PX0ZJTkFMIik7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICB9IGVsc2UgaWYgKCBDdXJyZW50RW50aXR5U3RhdGUgPT0gZ2V0RW50aXR5U3RhdGUoIlZPVElOR19FTkRFRF9OT19GSU5BTCIpICkgewoKICAgICAgICAgICAgICAgIGlmKCBGdW5kaW5nTWFuYWdlckVudGl0eS5DdXJyZW50RW50aXR5U3RhdGUoKSA9PSBGdW5kaW5nTWFuYWdlckVudGl0eS5nZXRFbnRpdHlTdGF0ZSgiTUlMRVNUT05FX1BST0NFU1NfRE9ORSIpKSB7CiAgICAgICAgICAgICAgICAgICAgRW50aXR5U3RhdGVSZXF1aXJlZCA9IGdldEVudGl0eVN0YXRlKCJWT1RJTkdfRlVORFNfUFJPQ0VTU0VEIik7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICB9IGVsc2UgaWYgKCBDdXJyZW50RW50aXR5U3RhdGUgPT0gZ2V0RW50aXR5U3RhdGUoIlZPVElOR19GVU5EU19QUk9DRVNTRUQiKSApIHsKCgogICAgICAgICAgICAgICAgaWYoY3VycmVudFJlY29yZCA8IFJlY29yZE51bSkgewogICAgICAgICAgICAgICAgICAgIEVudGl0eVN0YXRlUmVxdWlyZWQgPSBnZXRFbnRpdHlTdGF0ZSgiSU5fREVWRUxPUE1FTlQiKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CgogICAgICAgICAgICAgICAgICAgIGlmKEZ1bmRpbmdNYW5hZ2VyRW50aXR5LmdldEN1cnJlbnRNaWxlc3RvbmVQcm9jZXNzZWQoKSA9PSB0cnVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKEZ1bmRpbmdNYW5hZ2VyRW50aXR5LkN1cnJlbnRFbnRpdHlTdGF0ZSgpID09IEZ1bmRpbmdNYW5hZ2VyRW50aXR5LmdldEVudGl0eVN0YXRlKCJDT01QTEVURV9QUk9DRVNTX0RPTkUiKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgRW50aXR5U3RhdGVSZXF1aXJlZCA9IGdldEVudGl0eVN0YXRlKCJERVZFTE9QTUVOVF9DT01QTEVURSIpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgRW50aXR5U3RhdGVSZXF1aXJlZCA9IGdldEVudGl0eVN0YXRlKCJWT1RJTkdfRlVORFNfUFJPQ0VTU0VEIik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBFbnRpdHlTdGF0ZVJlcXVpcmVkID0gZ2V0RW50aXR5U3RhdGUoIklOX0RFVkVMT1BNRU5UIik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfQogICAgICAgICAgICAvKgogICAgICAgICAgICBlbHNlIGlmICggQ3VycmVudEVudGl0eVN0YXRlID09IGdldEVudGl0eVN0YXRlKCJERVZFTE9QTUVOVF9DT01QTEVURSIpICkgewoKICAgICAgICAgICAgfQogICAgICAgICAgICAqLwoKICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgaWYoIEN1cnJlbnRFbnRpdHlTdGF0ZSA9PSBnZXRFbnRpdHlTdGF0ZSgiTkVXIikgKSB7CiAgICAgICAgICAgICAgICBFbnRpdHlTdGF0ZVJlcXVpcmVkID0gZ2V0RW50aXR5U3RhdGUoIldBSVRJTkciKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIChDdXJyZW50UmVjb3JkU3RhdGUsIFJlY29yZFN0YXRlUmVxdWlyZWQsIEVudGl0eVN0YXRlUmVxdWlyZWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIEFwcGxpY2F0aW9uSXNJbkRldmVsb3BtZW50KCkgcHVibGljIHZpZXcgcmV0dXJucyhib29sKSB7CiAgICAgICAgaWYoIGdldEFwcGxpY2F0aW9uU3RhdGUoKSA9PSBnZXRBcHBsaWNhdGlvbkVudGl0eVN0YXRlKCJJTl9ERVZFTE9QTUVOVCIpICkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIE1lZXRpbmdUaW1lU2V0RmFpbHVyZSgpIHB1YmxpYyB2aWV3IHJldHVybnMgKGJvb2wpIHsKICAgICAgICBSZWNvcmQgbWVtb3J5IHJlY29yZCA9IENvbGxlY3Rpb25bY3VycmVudFJlY29yZF07CiAgICAgICAgdWludDI1NiBtZWV0aW5nQ3JlYXRpb25NYXhUaW1lID0gcmVjb3JkLnRpbWVfZW5kIC0gZ2V0QnlsYXdzTWluVGltZUluVGhlRnV0dXJlRm9yTWVldGluZ0NyZWF0aW9uKCk7CiAgICAgICAgaWYoZ2V0VGltZXN0YW1wKCkgPj0gbWVldGluZ0NyZWF0aW9uTWF4VGltZSApIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCn0='.
	

]
