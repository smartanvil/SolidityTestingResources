Class {
	#name : #SRT1ba798da29db821d92dfd9d10822ee5a850f65cc,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT1ba798da29db821d92dfd9d10822ee5a850f65cc >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMjA7CgovKgoqIFRlYW0gVW5Lb2luIHByZXNlbnRzLi4KKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qCioKKiBCdWlsdCBieSB0cnVzdGVkIGNvbW11bml0eSBtZW1iZXJzCiogVW5Lb2luLmNvbSBhIFBoaWwgYXBwcm92ZWQgUHlybWlkICAgICAgICAgICAgICAgICAgICAgICAgIAoqCiogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09KgoqIC0+IFdoYXQ/CiogVGhlIG9yaWdpbmFsIGF1dG9ub21vdXMgcHlyYW1pZCwgaW1wcm92ZWQ6CiogW3hdIE1vcmUgc3RhYmxlIHRoYW4gZXZlciwgaGF2aW5nIHdpdGhzdG9vZCBzZXZlcmUgdGVzdG5ldCBhYnVzZSBhbmQgYXR0YWNrIGF0dGVtcHRzIGZyb20gb3VyIGNvbW11bml0eSEuCiogW3hdIEF1ZGl0ZWQsIHRlc3RlZCwgYW5kIGFwcHJvdmVkIGJ5IGtub3duIGNvbW11bml0eSBzZWN1cml0eSBzcGVjaWFsaXN0cy4KKiBbWF0gTmV3IGZ1bmN0aW9uYWxpdHk7IHlvdSBjYW4gbm93IHBlcmZvcm0gcGFydGlhbCBzZWxsIG9yZGVycy4gSWYgeW91IHN1Y2N1bWIgdG8gd2VhayBoYW5kcywgeW91IGRvbid0IGhhdmUgdG8gZHVtcCBhbGwgb2YgeW91ciBiYWdzIQoqIFt4XSBOZXcgZnVuY3Rpb25hbGl0eTsgeW91IGNhbiBub3cgdHJhbnNmZXIgdG9rZW5zIGJldHdlZW4gd2FsbGV0cy4gVHJhZGluZyBpcyBub3cgcG9zc2libGUgZnJvbSB3aXRoaW4gdGhlIGNvbnRyYWN0IQoqIFt4XSBOZXcgRmVhdHVyZTogUG9TIE1hc3Rlcm5vZGVzISBUaGUgZmlyc3QgaW1wbGVtZW50YXRpb24gb2YgRXRoZXJldW0gU3Rha2luZyBpbiB0aGUgd29ybGQhIFZpdGFsaWsgaXMgbWFkLgoqIFt4XSBNYXN0ZXJub2RlczogSG9sZGluZyA1MCBVbktvaW4gVG9rZW5zIGFsbG93IHlvdSB0byBnZW5lcmF0ZSBhIE1hc3Rlcm5vZGUgbGluaywgTWFzdGVybm9kZSBsaW5rcyBhcmUgdXNlZCBhcyB1bmlxdWUgZW50cnkgcG9pbnRzIHRvIHRoZSBjb250cmFjdCEKKiBbeF0gTWFzdGVybm9kZXM6IEFsbCBwbGF5ZXJzIHdobyBlbnRlciB0aGUgY29udHJhY3QgdGhyb3VnaCB5b3VyIE1hc3Rlcm5vZGUgaGF2ZSAzMCUgb2YgdGhlaXIgMTAlIGRpdmlkZW5kcyBmZWUgcmVyb3V0ZWQgZnJvbSB0aGUgbWFzdGVyLW5vZGUsIHRvIHRoZSBub2RlLW1hc3RlciEKKgoqIC0+IFdoYXQgYWJvdXQgdGhlIGxhc3QgcHJvamVjdHM/CiogRXZlcnkgcHJvZ3JhbW1pbmcgbWVtYmVyIG9mIHRoZSBvbGQgZGV2IHRlYW0gaGFzIGJlZW4gZmlyZWQgYW5kL29yIGtpbGxlZC4KKiBUaGUgbmV3IGRldiB0ZWFtIGNvbnNpc3RzIG9mIHNlYXNvbmVkLCBwcm9mZXNzaW9uYWwgZGV2ZWxvcGVycyBhbmQgaGFzIGJlZW4gYXVkaXRlZCBieSB2ZXRlcmFuIHNvbGlkaXR5IGV4cGVydHMuCiogQWRkaXRpb25hbGx5LCB0d28gaW5kZXBlbmRlbnQgdGVzdG5ldCBpdGVyYXRpb25zIGhhdmUgYmVlbiB1c2VkIGJ5IGh1bmRyZWRzIG9mIHBlb3BsZTsgbm90IGEgc2luZ2xlIHBvaW50IG9mIGZhaWx1cmUgd2FzIGZvdW5kLgoqIAoqIC0+IFdobyB3b3JrZWQgb24gdGhpcyBwcm9qZWN0PwoqIFRydXN0ZWQgY29tbXVuaXR5IG1lbWJlcnMKKgoqLwoKY29udHJhY3QgVW5Lb2luIHsKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICA9ICAgICAgICAgICAgTU9ESUZJRVJTICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIC8vIG9ubHkgcGVvcGxlIHdpdGggdG9rZW5zCiAgICBtb2RpZmllciBvbmx5QmFnaG9sZGVycygpIHsKICAgICAgICByZXF1aXJlKG15VG9rZW5zKCkgPiAwKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICAvLyBvbmx5IHBlb3BsZSB3aXRoIHByb2ZpdHMKICAgIG1vZGlmaWVyIG9ubHlTdHJvbmdoYW5kcygpIHsKICAgICAgICByZXF1aXJlKG15RGl2aWRlbmRzKHRydWUpID4gMCk7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgLy8gYWRtaW5pc3RyYXRvcnMgY2FuOgogICAgLy8gLT4gY2hhbmdlIHRoZSBuYW1lIG9mIHRoZSBjb250cmFjdAogICAgLy8gLT4gY2hhbmdlIHRoZSBuYW1lIG9mIHRoZSB0b2tlbgogICAgLy8gLT4gY2hhbmdlIHRoZSBQb1MgZGlmZmljdWx0eSAoSG93IG1hbnkgdG9rZW5zIGl0IGNvc3RzIHRvIGhvbGQgYSBtYXN0ZXJub2RlLCBpbiBjYXNlIGl0IGdldHMgY3JhenkgaGlnaCBsYXRlcikKICAgIC8vIHRoZXkgQ0FOTk9UOgogICAgLy8gLT4gdGFrZSBmdW5kcwogICAgLy8gLT4gZGlzYWJsZSB3aXRoZHJhd2FscwogICAgLy8gLT4ga2lsbCB0aGUgY29udHJhY3QKICAgIC8vIC0+IGNoYW5nZSB0aGUgcHJpY2Ugb2YgdG9rZW5zCiAgICBtb2RpZmllciBvbmx5QWRtaW5pc3RyYXRvcigpewogICAgICAgIGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgcmVxdWlyZShhZG1pbmlzdHJhdG9yc1trZWNjYWsyNTYoX2N1c3RvbWVyQWRkcmVzcyldKTsKICAgICAgICBfOwogICAgfQogICAgCiAgICAKICAgIC8vIGVuc3VyZXMgdGhhdCB0aGUgZmlyc3QgdG9rZW5zIGluIHRoZSBjb250cmFjdCB3aWxsIGJlIGVxdWFsbHkgZGlzdHJpYnV0ZWQKICAgIC8vIG1lYW5pbmcsIG5vIGRpdmluZSBkdW1wIHdpbGwgYmUgZXZlciBwb3NzaWJsZQogICAgLy8gcmVzdWx0OiBoZWFsdGh5IGxvbmdldml0eS4KICAgIG1vZGlmaWVyIGFudGlFYXJseVdoYWxlKHVpbnQyNTYgX2Ftb3VudE9mRXRoZXJldW0pewogICAgICAgIGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgCiAgICAgICAgLy8gYXJlIHdlIHN0aWxsIGluIHRoZSB2dWxuZXJhYmxlIHBoYXNlPwogICAgICAgIC8vIGlmIHNvLCBlbmFjdCBhbnRpIGVhcmx5IHdoYWxlIHByb3RvY29sIAogICAgICAgIGlmKCBvbmx5QW1iYXNzYWRvcnMgJiYgKCh0b3RhbEV0aGVyZXVtQmFsYW5jZSgpIC0gX2Ftb3VudE9mRXRoZXJldW0pIDw9IGFtYmFzc2Fkb3JRdW90YV8gKSl7CiAgICAgICAgICAgIHJlcXVpcmUoCiAgICAgICAgICAgICAgICAvLyBpcyB0aGUgY3VzdG9tZXIgaW4gdGhlIGFtYmFzc2Fkb3IgbGlzdD8KICAgICAgICAgICAgICAgIGFtYmFzc2Fkb3JzX1tfY3VzdG9tZXJBZGRyZXNzXSA9PSB0cnVlICYmCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIGRvZXMgdGhlIGN1c3RvbWVyIHB1cmNoYXNlIGV4Y2VlZCB0aGUgbWF4IGFtYmFzc2Fkb3IgcXVvdGE/CiAgICAgICAgICAgICAgICAoYW1iYXNzYWRvckFjY3VtdWxhdGVkUXVvdGFfW19jdXN0b21lckFkZHJlc3NdICsgX2Ftb3VudE9mRXRoZXJldW0pIDw9IGFtYmFzc2Fkb3JNYXhQdXJjaGFzZV8KICAgICAgICAgICAgICAgIAogICAgICAgICAgICApOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gdXBkYXRlZCB0aGUgYWNjdW11bGF0ZWQgcXVvdGEgICAgCiAgICAgICAgICAgIGFtYmFzc2Fkb3JBY2N1bXVsYXRlZFF1b3RhX1tfY3VzdG9tZXJBZGRyZXNzXSA9IFNhZmVNYXRoLmFkZChhbWJhc3NhZG9yQWNjdW11bGF0ZWRRdW90YV9bX2N1c3RvbWVyQWRkcmVzc10sIF9hbW91bnRPZkV0aGVyZXVtKTsKICAgICAgICAKICAgICAgICAgICAgLy8gZXhlY3V0ZQogICAgICAgICAgICBfOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIGluIGNhc2UgdGhlIGV0aGVyIGNvdW50IGRyb3BzIGxvdywgdGhlIGFtYmFzc2Fkb3IgcGhhc2Ugd29uJ3QgcmVpbml0aWF0ZQogICAgICAgICAgICBvbmx5QW1iYXNzYWRvcnMgPSBmYWxzZTsKICAgICAgICAgICAgXzsgICAgCiAgICAgICAgfQogICAgICAgIAogICAgfQogICAgCiAgICAKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICA9ICAgICAgICAgICAgRVZFTlRTICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIGV2ZW50IG9uVG9rZW5QdXJjaGFzZSgKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgY3VzdG9tZXJBZGRyZXNzLAogICAgICAgIHVpbnQyNTYgaW5jb21pbmdFdGhlcmV1bSwKICAgICAgICB1aW50MjU2IHRva2Vuc01pbnRlZCwKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgcmVmZXJyZWRCeQogICAgKTsKICAgIAogICAgZXZlbnQgb25Ub2tlblNlbGwoCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIGN1c3RvbWVyQWRkcmVzcywKICAgICAgICB1aW50MjU2IHRva2Vuc0J1cm5lZCwKICAgICAgICB1aW50MjU2IGV0aGVyZXVtRWFybmVkCiAgICApOwogICAgCiAgICBldmVudCBvblJlaW52ZXN0bWVudCgKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgY3VzdG9tZXJBZGRyZXNzLAogICAgICAgIHVpbnQyNTYgZXRoZXJldW1SZWludmVzdGVkLAogICAgICAgIHVpbnQyNTYgdG9rZW5zTWludGVkCiAgICApOwogICAgCiAgICBldmVudCBvbldpdGhkcmF3KAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBjdXN0b21lckFkZHJlc3MsCiAgICAgICAgdWludDI1NiBldGhlcmV1bVdpdGhkcmF3bgogICAgKTsKICAgIAogICAgLy8gRVJDMjAKICAgIGV2ZW50IFRyYW5zZmVyKAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBmcm9tLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCB0bywKICAgICAgICB1aW50MjU2IHRva2VucwogICAgKTsKICAgIAogICAgCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgID0gICAgICAgICAgICBDT05GSUdVUkFCTEVTICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgICBzdHJpbmcgcHVibGljIG5hbWUgPSAiVW5Lb2luIjsKICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIlVLTiI7CiAgICB1aW50OCBjb25zdGFudCBwdWJsaWMgZGVjaW1hbHMgPSAxODsKICAgIHVpbnQ4IGNvbnN0YW50IGludGVybmFsIGRpdmlkZW5kRmVlXyA9IDU7IC8vIExvb2ssIHN0cm9uZyBNYXRoCiAgICB1aW50MjU2IGNvbnN0YW50IGludGVybmFsIHRva2VuUHJpY2VJbml0aWFsXyA9IDAuMDAwMDAwMSBldGhlcjsKICAgIHVpbnQyNTYgY29uc3RhbnQgaW50ZXJuYWwgdG9rZW5QcmljZUluY3JlbWVudGFsXyA9IDAuMDAwMDAwMDEgZXRoZXI7CiAgICB1aW50MjU2IGNvbnN0YW50IGludGVybmFsIG1hZ25pdHVkZSA9IDIqKjY0OwogICAgCiAgICAvLyBwcm9vZiBvZiBzdGFrZSAoZGVmYXVsdHMgYXQgMTAwIHRva2VucykKICAgIHVpbnQyNTYgcHVibGljIHN0YWtpbmdSZXF1aXJlbWVudCA9IDEwMGUxODsKICAgIAogICAgLy8gYW1iYXNzYWRvciBwcm9ncmFtCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgaW50ZXJuYWwgYW1iYXNzYWRvcnNfOwogICAgdWludDI1NiBjb25zdGFudCBpbnRlcm5hbCBhbWJhc3NhZG9yTWF4UHVyY2hhc2VfID0gMSBldGhlcjsKICAgIHVpbnQyNTYgY29uc3RhbnQgaW50ZXJuYWwgYW1iYXNzYWRvclF1b3RhXyA9IDIwIGV0aGVyOwogICAgCiAgICAKICAgIAogICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICA9ICAgICAgICAgICAgREFUQVNFVFMgICAgICAgICAgICA9CiAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgICAvLyBhbW91bnQgb2Ygc2hhcmVzIGZvciBlYWNoIGFkZHJlc3MgKHNjYWxlZCBudW1iZXIpCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgaW50ZXJuYWwgdG9rZW5CYWxhbmNlTGVkZ2VyXzsKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBpbnRlcm5hbCByZWZlcnJhbEJhbGFuY2VfOwogICAgbWFwcGluZyhhZGRyZXNzID0+IGludDI1NikgaW50ZXJuYWwgcGF5b3V0c1RvXzsKICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBpbnRlcm5hbCBhbWJhc3NhZG9yQWNjdW11bGF0ZWRRdW90YV87CiAgICB1aW50MjU2IGludGVybmFsIHRva2VuU3VwcGx5XyA9IDA7CiAgICB1aW50MjU2IGludGVybmFsIHByb2ZpdFBlclNoYXJlXzsKICAgIAogICAgLy8gYWRtaW5pc3RyYXRvciBsaXN0IChzZWUgYWJvdmUgb24gd2hhdCB0aGV5IGNhbiBkbykKICAgIG1hcHBpbmcoYnl0ZXMzMiA9PiBib29sKSBwdWJsaWMgYWRtaW5pc3RyYXRvcnM7CiAgICAKICAgIC8vIHdoZW4gdGhpcyBpcyBzZXQgdG8gdHJ1ZSwgb25seSBhbWJhc3NhZG9ycyBjYW4gcHVyY2hhc2UgdG9rZW5zICh0aGlzIHByZXZlbnRzIGEgd2hhbGUgcHJlbWluZSwgaXQgZW5zdXJlcyBhIGZhaXJseSBkaXN0cmlidXRlZCB1cHBlciBweXJhbWlkKQogICAgYm9vbCBwdWJsaWMgb25seUFtYmFzc2Fkb3JzID0gdHJ1ZTsKICAgIAoKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgPSAgICAgICAgICAgIFBVQkxJQyBGVU5DVElPTlMgICAgICAgICAgICA9CiAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgLyoKICAgICogLS0gQVBQTElDQVRJT04gRU5UUlkgUE9JTlRTIC0tICAKICAgICovCiAgICBmdW5jdGlvbiBVbktvaW4oKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIC8vIGFkZCBhZG1pbmlzdHJhdG9ycyBoZXJlCiAgICAgICAgYWRtaW5pc3RyYXRvcnNbMHg4YTc3MDE3YThjZWY2MzMzZTVkZjNhMDE2N2RiNWU0OTNlNzQyZGQyNWUwOWUxMjQ5NDcwOWFmNmRjYjBkNTg5XSA9IHRydWU7CiAgICB9CiAgICAgCiAgICAvKioKICAgICAqIENvbnZlcnRzIGFsbCBpbmNvbWluZyBldGhlcmV1bSB0byB0b2tlbnMgZm9yIHRoZSBjYWxsZXIsIGFuZCBwYXNzZXMgZG93biB0aGUgcmVmZXJyYWwgYWRkeSAoaWYgYW55KQogICAgICovCiAgICBmdW5jdGlvbiBidXkoYWRkcmVzcyBfcmVmZXJyZWRCeSkKICAgICAgICBwdWJsaWMKICAgICAgICBwYXlhYmxlCiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIHB1cmNoYXNlVG9rZW5zKG1zZy52YWx1ZSwgX3JlZmVycmVkQnkpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEZhbGxiYWNrIGZ1bmN0aW9uIHRvIGhhbmRsZSBldGhlcmV1bSB0aGF0IHdhcyBzZW5kIHN0cmFpZ2h0IHRvIHRoZSBjb250cmFjdAogICAgICogVW5mb3J0dW5hdGVseSB3ZSBjYW5ub3QgdXNlIGEgcmVmZXJyYWwgYWRkcmVzcyB0aGlzIHdheS4KICAgICAqLwogICAgZnVuY3Rpb24oKQogICAgICAgIHBheWFibGUKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICBwdXJjaGFzZVRva2Vucyhtc2cudmFsdWUsIDB4MCk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogQ29udmVydHMgYWxsIG9mIGNhbGxlcidzIGRpdmlkZW5kcyB0byB0b2tlbnMuCiAgICAqLwogICAgZnVuY3Rpb24gcmVpbnZlc3QoKQogICAgICAgIG9ubHlTdHJvbmdoYW5kcygpCiAgICAgICAgcHVibGljCiAgICB7CiAgICAgICAgLy8gZmV0Y2ggZGl2aWRlbmRzCiAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gbXlEaXZpZGVuZHMoZmFsc2UpOyAvLyByZXRyaWV2ZSByZWYuIGJvbnVzIGxhdGVyIGluIHRoZSBjb2RlCiAgICAgICAgCiAgICAgICAgLy8gcGF5IG91dCB0aGUgZGl2aWRlbmRzIHZpcnR1YWxseQogICAgICAgIGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgcGF5b3V0c1RvX1tfY3VzdG9tZXJBZGRyZXNzXSArPSAgKGludDI1NikgKF9kaXZpZGVuZHMgKiBtYWduaXR1ZGUpOwogICAgICAgIAogICAgICAgIC8vIHJldHJpZXZlIHJlZi4gYm9udXMKICAgICAgICBfZGl2aWRlbmRzICs9IHJlZmVycmFsQmFsYW5jZV9bX2N1c3RvbWVyQWRkcmVzc107CiAgICAgICAgcmVmZXJyYWxCYWxhbmNlX1tfY3VzdG9tZXJBZGRyZXNzXSA9IDA7CiAgICAgICAgCiAgICAgICAgLy8gZGlzcGF0Y2ggYSBidXkgb3JkZXIgd2l0aCB0aGUgdmlydHVhbGl6ZWQgIndpdGhkcmF3biBkaXZpZGVuZHMiCiAgICAgICAgdWludDI1NiBfdG9rZW5zID0gcHVyY2hhc2VUb2tlbnMoX2RpdmlkZW5kcywgMHgwKTsKICAgICAgICAKICAgICAgICAvLyBmaXJlIGV2ZW50CiAgICAgICAgb25SZWludmVzdG1lbnQoX2N1c3RvbWVyQWRkcmVzcywgX2RpdmlkZW5kcywgX3Rva2Vucyk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogQWxpYXMgb2Ygc2VsbCgpIGFuZCB3aXRoZHJhdygpLgogICAgICovCiAgICBmdW5jdGlvbiBleGl0KCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICAvLyBnZXQgdG9rZW4gY291bnQgZm9yIGNhbGxlciAmIHNlbGwgdGhlbSBhbGwKICAgICAgICBhZGRyZXNzIF9jdXN0b21lckFkZHJlc3MgPSBtc2cuc2VuZGVyOwogICAgICAgIHVpbnQyNTYgX3Rva2VucyA9IHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc107CiAgICAgICAgaWYoX3Rva2VucyA+IDApIHNlbGwoX3Rva2Vucyk7CiAgICAgICAgCiAgICAgICAgLy8gbGFtYm8gZGVsaXZlcnkgc2VydmljZQogICAgICAgIHdpdGhkcmF3KCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaXRoZHJhd3MgYWxsIG9mIHRoZSBjYWxsZXJzIGVhcm5pbmdzLgogICAgICovCiAgICBmdW5jdGlvbiB3aXRoZHJhdygpCiAgICAgICAgb25seVN0cm9uZ2hhbmRzKCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICAvLyBzZXR1cCBkYXRhCiAgICAgICAgYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICB1aW50MjU2IF9kaXZpZGVuZHMgPSBteURpdmlkZW5kcyhmYWxzZSk7IC8vIGdldCByZWYuIGJvbnVzIGxhdGVyIGluIHRoZSBjb2RlCiAgICAgICAgCiAgICAgICAgLy8gdXBkYXRlIGRpdmlkZW5kIHRyYWNrZXIKICAgICAgICBwYXlvdXRzVG9fW19jdXN0b21lckFkZHJlc3NdICs9ICAoaW50MjU2KSAoX2RpdmlkZW5kcyAqIG1hZ25pdHVkZSk7CiAgICAgICAgCiAgICAgICAgLy8gYWRkIHJlZi4gYm9udXMKICAgICAgICBfZGl2aWRlbmRzICs9IHJlZmVycmFsQmFsYW5jZV9bX2N1c3RvbWVyQWRkcmVzc107CiAgICAgICAgcmVmZXJyYWxCYWxhbmNlX1tfY3VzdG9tZXJBZGRyZXNzXSA9IDA7CiAgICAgICAgCiAgICAgICAgLy8gbGFtYm8gZGVsaXZlcnkgc2VydmljZQogICAgICAgIF9jdXN0b21lckFkZHJlc3MudHJhbnNmZXIoX2RpdmlkZW5kcyk7CiAgICAgICAgCiAgICAgICAgLy8gZmlyZSBldmVudAogICAgICAgIG9uV2l0aGRyYXcoX2N1c3RvbWVyQWRkcmVzcywgX2RpdmlkZW5kcyk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogTGlxdWlmaWVzIHRva2VucyB0byBldGhlcmV1bS4KICAgICAqLwogICAgZnVuY3Rpb24gc2VsbCh1aW50MjU2IF9hbW91bnRPZlRva2VucykKICAgICAgICBvbmx5QmFnaG9sZGVycygpCiAgICAgICAgcHVibGljCiAgICB7CiAgICAgICAgLy8gc2V0dXAgZGF0YQogICAgICAgIGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgLy8gcnVzc2lhbiBoYWNrZXJzIEJURk8KICAgICAgICByZXF1aXJlKF9hbW91bnRPZlRva2VucyA8PSB0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdKTsKICAgICAgICB1aW50MjU2IF90b2tlbnMgPSBfYW1vdW50T2ZUb2tlbnM7CiAgICAgICAgdWludDI1NiBfZXRoZXJldW0gPSB0b2tlbnNUb0V0aGVyZXVtXyhfdG9rZW5zKTsKICAgICAgICB1aW50MjU2IF9kaXZpZGVuZHMgPSBTYWZlTWF0aC5kaXYoX2V0aGVyZXVtLCBkaXZpZGVuZEZlZV8pOwogICAgICAgIHVpbnQyNTYgX3RheGVkRXRoZXJldW0gPSBTYWZlTWF0aC5zdWIoX2V0aGVyZXVtLCBfZGl2aWRlbmRzKTsKICAgICAgICAKICAgICAgICAvLyBidXJuIHRoZSBzb2xkIHRva2VucwogICAgICAgIHRva2VuU3VwcGx5XyA9IFNhZmVNYXRoLnN1Yih0b2tlblN1cHBseV8sIF90b2tlbnMpOwogICAgICAgIHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc10gPSBTYWZlTWF0aC5zdWIodG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSwgX3Rva2Vucyk7CiAgICAgICAgCiAgICAgICAgLy8gdXBkYXRlIGRpdmlkZW5kcyB0cmFja2VyCiAgICAgICAgaW50MjU2IF91cGRhdGVkUGF5b3V0cyA9IChpbnQyNTYpIChwcm9maXRQZXJTaGFyZV8gKiBfdG9rZW5zICsgKF90YXhlZEV0aGVyZXVtICogbWFnbml0dWRlKSk7CiAgICAgICAgcGF5b3V0c1RvX1tfY3VzdG9tZXJBZGRyZXNzXSAtPSBfdXBkYXRlZFBheW91dHM7ICAgICAgIAogICAgICAgIAogICAgICAgIC8vIGRpdmlkaW5nIGJ5IHplcm8gaXMgYSBiYWQgaWRlYQogICAgICAgIGlmICh0b2tlblN1cHBseV8gPiAwKSB7CiAgICAgICAgICAgIC8vIHVwZGF0ZSB0aGUgYW1vdW50IG9mIGRpdmlkZW5kcyBwZXIgdG9rZW4KICAgICAgICAgICAgcHJvZml0UGVyU2hhcmVfID0gU2FmZU1hdGguYWRkKHByb2ZpdFBlclNoYXJlXywgKF9kaXZpZGVuZHMgKiBtYWduaXR1ZGUpIC8gdG9rZW5TdXBwbHlfKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gZmlyZSBldmVudAogICAgICAgIG9uVG9rZW5TZWxsKF9jdXN0b21lckFkZHJlc3MsIF90b2tlbnMsIF90YXhlZEV0aGVyZXVtKTsKICAgIH0KICAgIAogICAgCiAgICAvKioKICAgICAqIFRyYW5zZmVyIHRva2VucyBmcm9tIHRoZSBjYWxsZXIgdG8gYSBuZXcgaG9sZGVyLgogICAgICogUmVtZW1iZXIsIHRoZXJlJ3MgYSAxMCUgZmVlIGhlcmUgYXMgd2VsbC4KICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG9BZGRyZXNzLCB1aW50MjU2IF9hbW91bnRPZlRva2VucykKICAgICAgICBvbmx5QmFnaG9sZGVycygpCiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyhib29sKQogICAgewogICAgICAgIC8vIHNldHVwCiAgICAgICAgYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICAKICAgICAgICAvLyBtYWtlIHN1cmUgd2UgaGF2ZSB0aGUgcmVxdWVzdGVkIHRva2VucwogICAgICAgIC8vIGFsc28gZGlzYWJsZXMgdHJhbnNmZXJzIHVudGlsIGFtYmFzc2Fkb3IgcGhhc2UgaXMgb3ZlcgogICAgICAgIC8vICggd2UgZG9udCB3YW50IHdoYWxlIHByZW1pbmVzICkKICAgICAgICByZXF1aXJlKCFvbmx5QW1iYXNzYWRvcnMgJiYgX2Ftb3VudE9mVG9rZW5zIDw9IHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc10pOwogICAgICAgIAogICAgICAgIC8vIHdpdGhkcmF3IGFsbCBvdXRzdGFuZGluZyBkaXZpZGVuZHMgZmlyc3QKICAgICAgICBpZihteURpdmlkZW5kcyh0cnVlKSA+IDApIHdpdGhkcmF3KCk7CiAgICAgICAgCiAgICAgICAgLy8gbGlxdWlmeSAxMCUgb2YgdGhlIHRva2VucyB0aGF0IGFyZSB0cmFuc2ZlcmVkCiAgICAgICAgLy8gdGhlc2UgYXJlIGRpc3BlcnNlZCB0byBzaGFyZWhvbGRlcnMKICAgICAgICB1aW50MjU2IF90b2tlbkZlZSA9IFNhZmVNYXRoLmRpdihfYW1vdW50T2ZUb2tlbnMsIGRpdmlkZW5kRmVlXyk7CiAgICAgICAgdWludDI1NiBfdGF4ZWRUb2tlbnMgPSBTYWZlTWF0aC5zdWIoX2Ftb3VudE9mVG9rZW5zLCBfdG9rZW5GZWUpOwogICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IHRva2Vuc1RvRXRoZXJldW1fKF90b2tlbkZlZSk7CiAgCiAgICAgICAgLy8gYnVybiB0aGUgZmVlIHRva2VucwogICAgICAgIHRva2VuU3VwcGx5XyA9IFNhZmVNYXRoLnN1Yih0b2tlblN1cHBseV8sIF90b2tlbkZlZSk7CgogICAgICAgIC8vIGV4Y2hhbmdlIHRva2VucwogICAgICAgIHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc10gPSBTYWZlTWF0aC5zdWIodG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSwgX2Ftb3VudE9mVG9rZW5zKTsKICAgICAgICB0b2tlbkJhbGFuY2VMZWRnZXJfW190b0FkZHJlc3NdID0gU2FmZU1hdGguYWRkKHRva2VuQmFsYW5jZUxlZGdlcl9bX3RvQWRkcmVzc10sIF90YXhlZFRva2Vucyk7CiAgICAgICAgCiAgICAgICAgLy8gdXBkYXRlIGRpdmlkZW5kIHRyYWNrZXJzCiAgICAgICAgcGF5b3V0c1RvX1tfY3VzdG9tZXJBZGRyZXNzXSAtPSAoaW50MjU2KSAocHJvZml0UGVyU2hhcmVfICogX2Ftb3VudE9mVG9rZW5zKTsKICAgICAgICBwYXlvdXRzVG9fW190b0FkZHJlc3NdICs9IChpbnQyNTYpIChwcm9maXRQZXJTaGFyZV8gKiBfdGF4ZWRUb2tlbnMpOwogICAgICAgIAogICAgICAgIC8vIGRpc3BlcnNlIGRpdmlkZW5kcyBhbW9uZyBob2xkZXJzCiAgICAgICAgcHJvZml0UGVyU2hhcmVfID0gU2FmZU1hdGguYWRkKHByb2ZpdFBlclNoYXJlXywgKF9kaXZpZGVuZHMgKiBtYWduaXR1ZGUpIC8gdG9rZW5TdXBwbHlfKTsKICAgICAgICAKICAgICAgICAvLyBmaXJlIGV2ZW50CiAgICAgICAgVHJhbnNmZXIoX2N1c3RvbWVyQWRkcmVzcywgX3RvQWRkcmVzcywgX3RheGVkVG9rZW5zKTsKICAgICAgICAKICAgICAgICAvLyBFUkMyMAogICAgICAgIHJldHVybiB0cnVlOwogICAgICAgCiAgICB9CiAgICAKICAgIC8qLS0tLS0tLS0tLSAgQURNSU5JU1RSQVRPUiBPTkxZIEZVTkNUSU9OUyAgLS0tLS0tLS0tLSovCiAgICAvKioKICAgICAqIEluIGNhc2UgdGhlIGFtYXNzYWRvciBxdW90YSBpcyBub3QgbWV0LCB0aGUgYWRtaW5pc3RyYXRvciBjYW4gbWFudWFsbHkgZGlzYWJsZSB0aGUgYW1iYXNzYWRvciBwaGFzZS4KICAgICAqLwogICAgZnVuY3Rpb24gZGlzYWJsZUluaXRpYWxTdGFnZSgpCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIG9ubHlBbWJhc3NhZG9ycyA9IGZhbHNlOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEluIGNhc2Ugb25lIG9mIHVzIGRpZXMsIHdlIG5lZWQgdG8gcmVwbGFjZSBvdXJzZWx2ZXMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldEFkbWluaXN0cmF0b3IoYnl0ZXMzMiBfaWRlbnRpZmllciwgYm9vbCBfc3RhdHVzKQogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yKCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICBhZG1pbmlzdHJhdG9yc1tfaWRlbnRpZmllcl0gPSBfc3RhdHVzOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFByZWNhdXRpb25hcnkgbWVhc3VyZXMgaW4gY2FzZSB3ZSBuZWVkIHRvIGFkanVzdCB0aGUgbWFzdGVybm9kZSByYXRlLgogICAgICovCiAgICBmdW5jdGlvbiBzZXRTdGFraW5nUmVxdWlyZW1lbnQodWludDI1NiBfYW1vdW50T2ZUb2tlbnMpCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIHN0YWtpbmdSZXF1aXJlbWVudCA9IF9hbW91bnRPZlRva2VuczsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBJZiB3ZSB3YW50IHRvIHJlYnJhbmQsIHdlIGNhbi4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0TmFtZShzdHJpbmcgX25hbWUpCiAgICAgICAgb25seUFkbWluaXN0cmF0b3IoKQogICAgICAgIHB1YmxpYwogICAgewogICAgICAgIG5hbWUgPSBfbmFtZTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBJZiB3ZSB3YW50IHRvIHJlYnJhbmQsIHdlIGNhbi4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0U3ltYm9sKHN0cmluZyBfc3ltYm9sKQogICAgICAgIG9ubHlBZG1pbmlzdHJhdG9yKCkKICAgICAgICBwdWJsaWMKICAgIHsKICAgICAgICBzeW1ib2wgPSBfc3ltYm9sOwogICAgfQoKICAgIAogICAgLyotLS0tLS0tLS0tICBIRUxQRVJTIEFORCBDQUxDVUxBVE9SUyAgLS0tLS0tLS0tLSovCiAgICAvKioKICAgICAqIE1ldGhvZCB0byB2aWV3IHRoZSBjdXJyZW50IEV0aGVyZXVtIHN0b3JlZCBpbiB0aGUgY29udHJhY3QKICAgICAqIEV4YW1wbGU6IHRvdGFsRXRoZXJldW1CYWxhbmNlKCkKICAgICAqLwogICAgZnVuY3Rpb24gdG90YWxFdGhlcmV1bUJhbGFuY2UoKQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zKHVpbnQpCiAgICB7CiAgICAgICAgcmV0dXJuIHRoaXMuYmFsYW5jZTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBSZXRyaWV2ZSB0aGUgdG90YWwgdG9rZW4gc3VwcGx5LgogICAgICovCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpCiAgICAgICAgcHVibGljCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICByZXR1cm4gdG9rZW5TdXBwbHlfOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFJldHJpZXZlIHRoZSB0b2tlbnMgb3duZWQgYnkgdGhlIGNhbGxlci4KICAgICAqLwogICAgZnVuY3Rpb24gbXlUb2tlbnMoKQogICAgICAgIHB1YmxpYwogICAgICAgIHZpZXcKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICByZXR1cm4gYmFsYW5jZU9mKF9jdXN0b21lckFkZHJlc3MpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFJldHJpZXZlIHRoZSBkaXZpZGVuZHMgb3duZWQgYnkgdGhlIGNhbGxlci4KICAgICAqIElmIGBfaW5jbHVkZVJlZmVycmFsQm9udXNgIGlzIHRvIHRvIDEvdHJ1ZSwgdGhlIHJlZmVycmFsIGJvbnVzIHdpbGwgYmUgaW5jbHVkZWQgaW4gdGhlIGNhbGN1bGF0aW9ucy4KICAgICAqIFRoZSByZWFzb24gZm9yIHRoaXMsIGlzIHRoYXQgaW4gdGhlIGZyb250ZW5kLCB3ZSB3aWxsIHdhbnQgdG8gZ2V0IHRoZSB0b3RhbCBkaXZzIChnbG9iYWwgKyByZWYpCiAgICAgKiBCdXQgaW4gdGhlIGludGVybmFsIGNhbGN1bGF0aW9ucywgd2Ugd2FudCB0aGVtIHNlcGFyYXRlLiAKICAgICAqLyAKICAgIGZ1bmN0aW9uIG15RGl2aWRlbmRzKGJvb2wgX2luY2x1ZGVSZWZlcnJhbEJvbnVzKSAKICAgICAgICBwdWJsaWMgCiAgICAgICAgdmlldyAKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzID0gbXNnLnNlbmRlcjsKICAgICAgICByZXR1cm4gX2luY2x1ZGVSZWZlcnJhbEJvbnVzID8gZGl2aWRlbmRzT2YoX2N1c3RvbWVyQWRkcmVzcykgKyByZWZlcnJhbEJhbGFuY2VfW19jdXN0b21lckFkZHJlc3NdIDogZGl2aWRlbmRzT2YoX2N1c3RvbWVyQWRkcmVzcykgOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFJldHJpZXZlIHRoZSB0b2tlbiBiYWxhbmNlIG9mIGFueSBzaW5nbGUgYWRkcmVzcy4KICAgICAqLwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcykKICAgICAgICB2aWV3CiAgICAgICAgcHVibGljCiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIHJldHVybiB0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFJldHJpZXZlIHRoZSBkaXZpZGVuZCBiYWxhbmNlIG9mIGFueSBzaW5nbGUgYWRkcmVzcy4KICAgICAqLwogICAgZnVuY3Rpb24gZGl2aWRlbmRzT2YoYWRkcmVzcyBfY3VzdG9tZXJBZGRyZXNzKQogICAgICAgIHZpZXcKICAgICAgICBwdWJsaWMKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgcmV0dXJuICh1aW50MjU2KSAoKGludDI1NikocHJvZml0UGVyU2hhcmVfICogdG9rZW5CYWxhbmNlTGVkZ2VyX1tfY3VzdG9tZXJBZGRyZXNzXSkgLSBwYXlvdXRzVG9fW19jdXN0b21lckFkZHJlc3NdKSAvIG1hZ25pdHVkZTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGJ1eSBwcmljZSBvZiAxIGluZGl2aWR1YWwgdG9rZW4uCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNlbGxQcmljZSgpIAogICAgICAgIHB1YmxpYyAKICAgICAgICB2aWV3IAogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICAvLyBvdXIgY2FsY3VsYXRpb24gcmVsaWVzIG9uIHRoZSB0b2tlbiBzdXBwbHksIHNvIHdlIG5lZWQgc3VwcGx5LiBEb2guCiAgICAgICAgaWYodG9rZW5TdXBwbHlfID09IDApewogICAgICAgICAgICByZXR1cm4gdG9rZW5QcmljZUluaXRpYWxfIC0gdG9rZW5QcmljZUluY3JlbWVudGFsXzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB1aW50MjU2IF9ldGhlcmV1bSA9IHRva2Vuc1RvRXRoZXJldW1fKDFlMTgpOwogICAgICAgICAgICB1aW50MjU2IF9kaXZpZGVuZHMgPSBTYWZlTWF0aC5kaXYoX2V0aGVyZXVtLCBkaXZpZGVuZEZlZV8gICk7CiAgICAgICAgICAgIHVpbnQyNTYgX3RheGVkRXRoZXJldW0gPSBTYWZlTWF0aC5zdWIoX2V0aGVyZXVtLCBfZGl2aWRlbmRzKTsKICAgICAgICAgICAgcmV0dXJuIF90YXhlZEV0aGVyZXVtOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHNlbGwgcHJpY2Ugb2YgMSBpbmRpdmlkdWFsIHRva2VuLgogICAgICovCiAgICBmdW5jdGlvbiBidXlQcmljZSgpIAogICAgICAgIHB1YmxpYyAKICAgICAgICB2aWV3IAogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICAvLyBvdXIgY2FsY3VsYXRpb24gcmVsaWVzIG9uIHRoZSB0b2tlbiBzdXBwbHksIHNvIHdlIG5lZWQgc3VwcGx5LiBEb2guCiAgICAgICAgaWYodG9rZW5TdXBwbHlfID09IDApewogICAgICAgICAgICByZXR1cm4gdG9rZW5QcmljZUluaXRpYWxfICsgdG9rZW5QcmljZUluY3JlbWVudGFsXzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB1aW50MjU2IF9ldGhlcmV1bSA9IHRva2Vuc1RvRXRoZXJldW1fKDFlMTgpOwogICAgICAgICAgICB1aW50MjU2IF9kaXZpZGVuZHMgPSBTYWZlTWF0aC5kaXYoX2V0aGVyZXVtLCBkaXZpZGVuZEZlZV8gICk7CiAgICAgICAgICAgIHVpbnQyNTYgX3RheGVkRXRoZXJldW0gPSBTYWZlTWF0aC5hZGQoX2V0aGVyZXVtLCBfZGl2aWRlbmRzKTsKICAgICAgICAgICAgcmV0dXJuIF90YXhlZEV0aGVyZXVtOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBGdW5jdGlvbiBmb3IgdGhlIGZyb250ZW5kIHRvIGR5bmFtaWNhbGx5IHJldHJpZXZlIHRoZSBwcmljZSBzY2FsaW5nIG9mIGJ1eSBvcmRlcnMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZVRva2Vuc1JlY2VpdmVkKHVpbnQyNTYgX2V0aGVyZXVtVG9TcGVuZCkgCiAgICAgICAgcHVibGljIAogICAgICAgIHZpZXcgCiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIHVpbnQyNTYgX2RpdmlkZW5kcyA9IFNhZmVNYXRoLmRpdihfZXRoZXJldW1Ub1NwZW5kLCBkaXZpZGVuZEZlZV8pOwogICAgICAgIHVpbnQyNTYgX3RheGVkRXRoZXJldW0gPSBTYWZlTWF0aC5zdWIoX2V0aGVyZXVtVG9TcGVuZCwgX2RpdmlkZW5kcyk7CiAgICAgICAgdWludDI1NiBfYW1vdW50T2ZUb2tlbnMgPSBldGhlcmV1bVRvVG9rZW5zXyhfdGF4ZWRFdGhlcmV1bSk7CiAgICAgICAgCiAgICAgICAgcmV0dXJuIF9hbW91bnRPZlRva2VuczsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBGdW5jdGlvbiBmb3IgdGhlIGZyb250ZW5kIHRvIGR5bmFtaWNhbGx5IHJldHJpZXZlIHRoZSBwcmljZSBzY2FsaW5nIG9mIHNlbGwgb3JkZXJzLgogICAgICovCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVFdGhlcmV1bVJlY2VpdmVkKHVpbnQyNTYgX3Rva2Vuc1RvU2VsbCkgCiAgICAgICAgcHVibGljIAogICAgICAgIHZpZXcgCiAgICAgICAgcmV0dXJucyh1aW50MjU2KQogICAgewogICAgICAgIHJlcXVpcmUoX3Rva2Vuc1RvU2VsbCA8PSB0b2tlblN1cHBseV8pOwogICAgICAgIHVpbnQyNTYgX2V0aGVyZXVtID0gdG9rZW5zVG9FdGhlcmV1bV8oX3Rva2Vuc1RvU2VsbCk7CiAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gU2FmZU1hdGguZGl2KF9ldGhlcmV1bSwgZGl2aWRlbmRGZWVfKTsKICAgICAgICB1aW50MjU2IF90YXhlZEV0aGVyZXVtID0gU2FmZU1hdGguc3ViKF9ldGhlcmV1bSwgX2RpdmlkZW5kcyk7CiAgICAgICAgcmV0dXJuIF90YXhlZEV0aGVyZXVtOwogICAgfQogICAgCiAgICAKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICA9ICAgICAgICAgICAgSU5URVJOQUwgRlVOQ1RJT05TICAgICAgICAgICAgPQogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIGZ1bmN0aW9uIHB1cmNoYXNlVG9rZW5zKHVpbnQyNTYgX2luY29taW5nRXRoZXJldW0sIGFkZHJlc3MgX3JlZmVycmVkQnkpCiAgICAgICAgYW50aUVhcmx5V2hhbGUoX2luY29taW5nRXRoZXJldW0pCiAgICAgICAgaW50ZXJuYWwKICAgICAgICByZXR1cm5zKHVpbnQyNTYpCiAgICB7CiAgICAgICAgLy8gZGF0YSBzZXR1cAogICAgICAgIGFkZHJlc3MgX2N1c3RvbWVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7CiAgICAgICAgdWludDI1NiBfdW5kaXZpZGVkRGl2aWRlbmRzID0gU2FmZU1hdGguZGl2KF9pbmNvbWluZ0V0aGVyZXVtLCBkaXZpZGVuZEZlZV8pOwogICAgICAgIHVpbnQyNTYgX3JlZmVycmFsQm9udXMgPSBTYWZlTWF0aC5kaXYoX3VuZGl2aWRlZERpdmlkZW5kcywgMyk7CiAgICAgICAgdWludDI1NiBfZGl2aWRlbmRzID0gU2FmZU1hdGguc3ViKF91bmRpdmlkZWREaXZpZGVuZHMsIF9yZWZlcnJhbEJvbnVzKTsKICAgICAgICB1aW50MjU2IF90YXhlZEV0aGVyZXVtID0gU2FmZU1hdGguc3ViKF9pbmNvbWluZ0V0aGVyZXVtLCBfdW5kaXZpZGVkRGl2aWRlbmRzKTsKICAgICAgICB1aW50MjU2IF9hbW91bnRPZlRva2VucyA9IGV0aGVyZXVtVG9Ub2tlbnNfKF90YXhlZEV0aGVyZXVtKTsKICAgICAgICB1aW50MjU2IF9mZWUgPSBfZGl2aWRlbmRzICogbWFnbml0dWRlOwogCiAgICAgICAgLy8gbm8gcG9pbnQgaW4gY29udGludWluZyBleGVjdXRpb24gaWYgT1AgaXMgYSBwb29yZmFnIHJ1c3NpYW4gaGFja2VyCiAgICAgICAgLy8gcHJldmVudHMgb3ZlcmZsb3cgaW4gdGhlIGNhc2UgdGhhdCB0aGUgcHlyYW1pZCBzb21laG93IG1hZ2ljYWxseSBzdGFydHMgYmVpbmcgdXNlZCBieSBldmVyeW9uZSBpbiB0aGUgd29ybGQKICAgICAgICAvLyAob3IgaGFja2VycykKICAgICAgICAvLyBhbmQgeWVzIHdlIGtub3cgdGhhdCB0aGUgc2FmZW1hdGggZnVuY3Rpb24gYXV0b21hdGljYWxseSBydWxlcyBvdXQgdGhlICJncmVhdGVyIHRoZW4iIGVxdWFzaW9uLgogICAgICAgIHJlcXVpcmUoX2Ftb3VudE9mVG9rZW5zID4gMCAmJiAoU2FmZU1hdGguYWRkKF9hbW91bnRPZlRva2Vucyx0b2tlblN1cHBseV8pID4gdG9rZW5TdXBwbHlfKSk7CiAgICAgICAgCiAgICAgICAgLy8gaXMgdGhlIHVzZXIgcmVmZXJyZWQgYnkgYSBtYXN0ZXJub2RlPwogICAgICAgIGlmKAogICAgICAgICAgICAvLyBpcyB0aGlzIGEgcmVmZXJyZWQgcHVyY2hhc2U/CiAgICAgICAgICAgIF9yZWZlcnJlZEJ5ICE9IDB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCAmJgoKICAgICAgICAgICAgLy8gbm8gY2hlYXRpbmchCiAgICAgICAgICAgIF9yZWZlcnJlZEJ5ICE9IF9jdXN0b21lckFkZHJlc3MgJiYKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIGRvZXMgdGhlIHJlZmVycmVyIGhhdmUgYXQgbGVhc3QgWCB3aG9sZSB0b2tlbnM/CiAgICAgICAgICAgIC8vIGkuZSBpcyB0aGUgcmVmZXJyZXIgYSBnb2RseSBjaGFkIG1hc3Rlcm5vZGUKICAgICAgICAgICAgdG9rZW5CYWxhbmNlTGVkZ2VyX1tfcmVmZXJyZWRCeV0gPj0gc3Rha2luZ1JlcXVpcmVtZW50CiAgICAgICAgKXsKICAgICAgICAgICAgLy8gd2VhbHRoIHJlZGlzdHJpYnV0aW9uCiAgICAgICAgICAgIHJlZmVycmFsQmFsYW5jZV9bX3JlZmVycmVkQnldID0gU2FmZU1hdGguYWRkKHJlZmVycmFsQmFsYW5jZV9bX3JlZmVycmVkQnldLCBfcmVmZXJyYWxCb251cyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gbm8gcmVmIHB1cmNoYXNlCiAgICAgICAgICAgIC8vIGFkZCB0aGUgcmVmZXJyYWwgYm9udXMgYmFjayB0byB0aGUgZ2xvYmFsIGRpdmlkZW5kcyBjYWtlCiAgICAgICAgICAgIF9kaXZpZGVuZHMgPSBTYWZlTWF0aC5hZGQoX2RpdmlkZW5kcywgX3JlZmVycmFsQm9udXMpOwogICAgICAgICAgICBfZmVlID0gX2RpdmlkZW5kcyAqIG1hZ25pdHVkZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gd2UgY2FuJ3QgZ2l2ZSBwZW9wbGUgaW5maW5pdGUgZXRoZXJldW0KICAgICAgICBpZih0b2tlblN1cHBseV8gPiAwKXsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIGFkZCB0b2tlbnMgdG8gdGhlIHBvb2wKICAgICAgICAgICAgdG9rZW5TdXBwbHlfID0gU2FmZU1hdGguYWRkKHRva2VuU3VwcGx5XywgX2Ftb3VudE9mVG9rZW5zKTsKIAogICAgICAgICAgICAvLyB0YWtlIHRoZSBhbW91bnQgb2YgZGl2aWRlbmRzIGdhaW5lZCB0aHJvdWdoIHRoaXMgdHJhbnNhY3Rpb24sIGFuZCBhbGxvY2F0ZXMgdGhlbSBldmVubHkgdG8gZWFjaCBzaGFyZWhvbGRlcgogICAgICAgICAgICBwcm9maXRQZXJTaGFyZV8gKz0gKF9kaXZpZGVuZHMgKiBtYWduaXR1ZGUgLyAodG9rZW5TdXBwbHlfKSk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBjYWxjdWxhdGUgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhlIGN1c3RvbWVyIHJlY2VpdmVzIG92ZXIgaGlzIHB1cmNoYXNlIAogICAgICAgICAgICBfZmVlID0gX2ZlZSAtIChfZmVlLShfYW1vdW50T2ZUb2tlbnMgKiAoX2RpdmlkZW5kcyAqIG1hZ25pdHVkZSAvICh0b2tlblN1cHBseV8pKSkpOwogICAgICAgIAogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIGFkZCB0b2tlbnMgdG8gdGhlIHBvb2wKICAgICAgICAgICAgdG9rZW5TdXBwbHlfID0gX2Ftb3VudE9mVG9rZW5zOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyB1cGRhdGUgY2lyY3VsYXRpbmcgc3VwcGx5ICYgdGhlIGxlZGdlciBhZGRyZXNzIGZvciB0aGUgY3VzdG9tZXIKICAgICAgICB0b2tlbkJhbGFuY2VMZWRnZXJfW19jdXN0b21lckFkZHJlc3NdID0gU2FmZU1hdGguYWRkKHRva2VuQmFsYW5jZUxlZGdlcl9bX2N1c3RvbWVyQWRkcmVzc10sIF9hbW91bnRPZlRva2Vucyk7CiAgICAgICAgCiAgICAgICAgLy8gVGVsbHMgdGhlIGNvbnRyYWN0IHRoYXQgdGhlIGJ1eWVyIGRvZXNuJ3QgZGVzZXJ2ZSBkaXZpZGVuZHMgZm9yIHRoZSB0b2tlbnMgYmVmb3JlIHRoZXkgb3duZWQgdGhlbTsKICAgICAgICAvL3JlYWxseSBpIGtub3cgeW91IHRoaW5rIHlvdSBkbyBidXQgeW91IGRvbid0CiAgICAgICAgaW50MjU2IF91cGRhdGVkUGF5b3V0cyA9IChpbnQyNTYpICgocHJvZml0UGVyU2hhcmVfICogX2Ftb3VudE9mVG9rZW5zKSAtIF9mZWUpOwogICAgICAgIHBheW91dHNUb19bX2N1c3RvbWVyQWRkcmVzc10gKz0gX3VwZGF0ZWRQYXlvdXRzOwogICAgICAgIAogICAgICAgIC8vIGZpcmUgZXZlbnQKICAgICAgICBvblRva2VuUHVyY2hhc2UoX2N1c3RvbWVyQWRkcmVzcywgX2luY29taW5nRXRoZXJldW0sIF9hbW91bnRPZlRva2VucywgX3JlZmVycmVkQnkpOwogICAgICAgIAogICAgICAgIHJldHVybiBfYW1vdW50T2ZUb2tlbnM7CiAgICB9CgogICAgLyoqCiAgICAgKiBDYWxjdWxhdGUgVG9rZW4gcHJpY2UgYmFzZWQgb24gYW4gYW1vdW50IG9mIGluY29taW5nIGV0aGVyZXVtCiAgICAgKiBJdCdzIGFuIGFsZ29yaXRobSwgaG9wZWZ1bGx5IHdlIGdhdmUgeW91IHRoZSB3aGl0ZXBhcGVyIHdpdGggaXQgaW4gc2NpZW50aWZpYyBub3RhdGlvbjsKICAgICAqIFNvbWUgY29udmVyc2lvbnMgb2NjdXJyZWQgdG8gcHJldmVudCBkZWNpbWFsIGVycm9ycyBvciB1bmRlcmZsb3dzIC8gb3ZlcmZsb3dzIGluIHNvbGlkaXR5IGNvZGUuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGV0aGVyZXVtVG9Ub2tlbnNfKHVpbnQyNTYgX2V0aGVyZXVtKQogICAgICAgIGludGVybmFsCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKICAgICAgICB1aW50MjU2IF90b2tlblByaWNlSW5pdGlhbCA9IHRva2VuUHJpY2VJbml0aWFsXyAqIDFlMTg7CiAgICAgICAgdWludDI1NiBfdG9rZW5zUmVjZWl2ZWQgPSAKICAgICAgICAgKAogICAgICAgICAgICAoCiAgICAgICAgICAgICAgICAvLyB1bmRlcmZsb3cgYXR0ZW1wdHMgQlRGTwogICAgICAgICAgICAgICAgU2FmZU1hdGguc3ViKAogICAgICAgICAgICAgICAgICAgIChzcXJ0CiAgICAgICAgICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfdG9rZW5QcmljZUluaXRpYWwqKjIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoMioodG9rZW5QcmljZUluY3JlbWVudGFsXyAqIDFlMTgpKihfZXRoZXJldW0gKiAxZTE4KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICgoKHRva2VuUHJpY2VJbmNyZW1lbnRhbF8pKioyKSoodG9rZW5TdXBwbHlfKioyKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICgyKih0b2tlblByaWNlSW5jcmVtZW50YWxfKSpfdG9rZW5QcmljZUluaXRpYWwqdG9rZW5TdXBwbHlfKQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgKSwgX3Rva2VuUHJpY2VJbml0aWFsCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkvKHRva2VuUHJpY2VJbmNyZW1lbnRhbF8pCiAgICAgICAgKS0odG9rZW5TdXBwbHlfKQogICAgICAgIDsKICAKICAgICAgICByZXR1cm4gX3Rva2Vuc1JlY2VpdmVkOwogICAgfQogICAgCiAgICAvKioKICAgICAqIENhbGN1bGF0ZSB0b2tlbiBzZWxsIHZhbHVlLgogICAgICogSXQncyBhbiBhbGdvcml0aG0sIGhvcGVmdWxseSB3ZSBnYXZlIHlvdSB0aGUgd2hpdGVwYXBlciB3aXRoIGl0IGluIHNjaWVudGlmaWMgbm90YXRpb247CiAgICAgKiBTb21lIGNvbnZlcnNpb25zIG9jY3VycmVkIHRvIHByZXZlbnQgZGVjaW1hbCBlcnJvcnMgb3IgdW5kZXJmbG93cyAvIG92ZXJmbG93cyBpbiBzb2xpZGl0eSBjb2RlLgogICAgICovCiAgICAgZnVuY3Rpb24gdG9rZW5zVG9FdGhlcmV1bV8odWludDI1NiBfdG9rZW5zKQogICAgICAgIGludGVybmFsCiAgICAgICAgdmlldwogICAgICAgIHJldHVybnModWludDI1NikKICAgIHsKCiAgICAgICAgdWludDI1NiB0b2tlbnNfID0gKF90b2tlbnMgKyAxZTE4KTsKICAgICAgICB1aW50MjU2IF90b2tlblN1cHBseSA9ICh0b2tlblN1cHBseV8gKyAxZTE4KTsKICAgICAgICB1aW50MjU2IF9ldGhlclJlY2VpdmVkID0KICAgICAgICAoCiAgICAgICAgICAgIC8vIHVuZGVyZmxvdyBhdHRlbXB0cyBCVEZPCiAgICAgICAgICAgIFNhZmVNYXRoLnN1YigKICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAoCiAgICAgICAgICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRva2VuUHJpY2VJbml0aWFsXyArKHRva2VuUHJpY2VJbmNyZW1lbnRhbF8gKiAoX3Rva2VuU3VwcGx5LzFlMTgpKQogICAgICAgICAgICAgICAgICAgICAgICApLXRva2VuUHJpY2VJbmNyZW1lbnRhbF8KICAgICAgICAgICAgICAgICAgICApKih0b2tlbnNfIC0gMWUxOCkKICAgICAgICAgICAgICAgICksKHRva2VuUHJpY2VJbmNyZW1lbnRhbF8qKCh0b2tlbnNfKioyLXRva2Vuc18pLzFlMTgpKS8yCiAgICAgICAgICAgICkKICAgICAgICAvMWUxOCk7CiAgICAgICAgcmV0dXJuIF9ldGhlclJlY2VpdmVkOwogICAgfQogICAgCiAgICAKICAgIC8vVGhpcyBpcyB3aGVyZSBhbGwgeW91ciBnYXMgZ29lcywgc29ycnkKICAgIC8vTm90IHNvcnJ5LCB5b3UgcHJvYmFibHkgb25seSBwYWlkIDEgZ3dlaQogICAgZnVuY3Rpb24gc3FydCh1aW50IHgpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludCB5KSB7CiAgICAgICAgdWludCB6ID0gKHggKyAxKSAvIDI7CiAgICAgICAgeSA9IHg7CiAgICAgICAgd2hpbGUgKHogPCB5KSB7CiAgICAgICAgICAgIHkgPSB6OwogICAgICAgICAgICB6ID0gKHggLyB6ICsgeikgLyAyOwogICAgICAgIH0KICAgIH0KfQoKLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CgogICAgLyoqCiAgICAqIEBkZXYgTXVsdGlwbGllcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICAgKi8KICAgIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgaWYgKGEgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgICAgdWludDI1NiBjID0gYSAqIGI7CiAgICAgICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEludGVnZXIgZGl2aXNpb24gb2YgdHdvIG51bWJlcnMsIHRydW5jYXRpbmcgdGhlIHF1b3RpZW50LgogICAgKi8KICAgIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICAgICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAgICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICAvKioKICAgICogQGRldiBTdWJzdHJhY3RzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cgKGkuZS4gaWYgc3VidHJhaGVuZCBpcyBncmVhdGVyIHRoYW4gbWludWVuZCkuCiAgICAqLwogICAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoYiA8PSBhKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgQWRkcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICAgKi8KICAgIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSArIGI7CiAgICAgICAgYXNzZXJ0KGMgPj0gYSk7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9Cn0='.
	

]
