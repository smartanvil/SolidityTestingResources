Class {
	#name : #SRTea84b8b889ee41d9c05c14e20e4ae1c59f8d1a32,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTea84b8b889ee41d9c05c14e20e4ae1c59f8d1a32 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMDsKCgovKgoKVGVtcG9yYXJ5IEhhc2ggUmVnaXN0cmFyIAo9PT09PT09PT09PT09PT09PT09PT09PT0KClRoaXMgaXMgYSBzaW1wbGlmaWVkIHZlcnNpb24gb2YgYSBoYXNoIHJlZ2lzdHJhci4gSXQgaXMgcHVycG9yc2VmdWxseSBsaW1pdGVkOgpuYW1lcyBjYW5ub3QgYmUgc2l4IGxldHRlcnMgb3Igc2hvcnRlciwgbmV3IGF1Y3Rpb25zIHdpbGwgc3RvcCBhZnRlciA0IHllYXJzCmFuZCBhbGwgZXRoZXIgc3RpbGwgbG9ja2VkIGFmdGVyIDggeWVhcnMgd2lsbCBiZWNvbWUgdW5yZWFjaGFibGUuCgpUaGUgcGxhbiBpcyB0byB0ZXN0IHRoZSBiYXNpYyBmZWF0dXJlcyBhbmQgdGhlbiBtb3ZlIHRvIGEgbmV3IGNvbnRyYWN0IGluIGF0IG1vc3QKMiB5ZWFycywgd2hlbiBzb21lIHNvcnQgb2YgcmVuZXdhbCBtZWNoYW5pc20gd2lsbCBiZSBlbmFibGVkLgoqLwoKY29udHJhY3QgQWJzdHJhY3RFTlMgewogICAgZnVuY3Rpb24gb3duZXIoYnl0ZXMzMiBub2RlKSBjb25zdGFudCByZXR1cm5zKGFkZHJlc3MpOwogICAgZnVuY3Rpb24gcmVzb2x2ZXIoYnl0ZXMzMiBub2RlKSBjb25zdGFudCByZXR1cm5zKGFkZHJlc3MpOwogICAgZnVuY3Rpb24gdHRsKGJ5dGVzMzIgbm9kZSkgY29uc3RhbnQgcmV0dXJucyh1aW50NjQpOwogICAgZnVuY3Rpb24gc2V0T3duZXIoYnl0ZXMzMiBub2RlLCBhZGRyZXNzIG93bmVyKTsKICAgIGZ1bmN0aW9uIHNldFN1Ym5vZGVPd25lcihieXRlczMyIG5vZGUsIGJ5dGVzMzIgbGFiZWwsIGFkZHJlc3Mgb3duZXIpOwogICAgZnVuY3Rpb24gc2V0UmVzb2x2ZXIoYnl0ZXMzMiBub2RlLCBhZGRyZXNzIHJlc29sdmVyKTsKICAgIGZ1bmN0aW9uIHNldFRUTChieXRlczMyIG5vZGUsIHVpbnQ2NCB0dGwpOwoKICAgIGV2ZW50IFRyYW5zZmVyKGJ5dGVzMzIgaW5kZXhlZCBub2RlLCBhZGRyZXNzIG93bmVyKTsKICAgIGV2ZW50IE5ld093bmVyKGJ5dGVzMzIgaW5kZXhlZCBub2RlLCBieXRlczMyIGluZGV4ZWQgbGFiZWwsIGFkZHJlc3Mgb3duZXIpOwogICAgZXZlbnQgTmV3UmVzb2x2ZXIoYnl0ZXMzMiBpbmRleGVkIG5vZGUsIGFkZHJlc3MgcmVzb2x2ZXIpOwogICAgZXZlbnQgTmV3VFRMKGJ5dGVzMzIgaW5kZXhlZCBub2RlLCB1aW50NjQgdHRsKTsKfQoKLyoqCiAqIEB0aXRsZSBEZWVkIHRvIGhvbGQgZXRoZXIgaW4gZXhjaGFuZ2UgZm9yIG93bmVyc2hpcCBvZiBhIG5vZGUKICogQGRldiBUaGUgZGVlZCBjYW4gYmUgY29udHJvbGxlZCBvbmx5IGJ5IHRoZSByZWdpc3RyYXIgYW5kIGNhbiBvbmx5IHNlbmQgZXRoZXIgYmFjayB0byB0aGUgb3duZXIuCiAqLwpjb250cmFjdCBEZWVkIHsKICAgIGFkZHJlc3MgcHVibGljIHJlZ2lzdHJhcjsKICAgIGFkZHJlc3MgY29uc3RhbnQgYnVybiA9IDB4ZGVhZDsKICAgIHVpbnQgcHVibGljIGNyZWF0aW9uRGF0ZTsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwogICAgYWRkcmVzcyBwdWJsaWMgcHJldmlvdXNPd25lcjsKICAgIHVpbnQgcHVibGljIHZhbHVlOwogICAgZXZlbnQgT3duZXJDaGFuZ2VkKGFkZHJlc3MgbmV3T3duZXIpOwogICAgZXZlbnQgRGVlZENsb3NlZCgpOwogICAgYm9vbCBhY3RpdmU7CgoKICAgIG1vZGlmaWVyIG9ubHlSZWdpc3RyYXIgewogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IHJlZ2lzdHJhcikgdGhyb3c7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5QWN0aXZlIHsKICAgICAgICBpZiAoIWFjdGl2ZSkgdGhyb3c7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiBEZWVkKHVpbnQgX3ZhbHVlKSB7CiAgICAgICAgcmVnaXN0cmFyID0gbXNnLnNlbmRlcjsKICAgICAgICBjcmVhdGlvbkRhdGUgPSBub3c7CiAgICAgICAgYWN0aXZlID0gdHJ1ZTsKICAgICAgICB2YWx1ZSA9IF92YWx1ZTsKICAgIH0KICAgICAgICAKICAgIGZ1bmN0aW9uIHNldE93bmVyKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlSZWdpc3RyYXIgewogICAgICAgIC8vIHNvIGNvbnRyYWN0cyBjYW4gY2hlY2sgd2hvIHNlbnQgdGhlbSB0aGUgb3duZXJzaGlwCiAgICAgICAgcHJldmlvdXNPd25lciA9IG93bmVyOwogICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICAgICAgT3duZXJDaGFuZ2VkKG5ld093bmVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRSZWdpc3RyYXIoYWRkcmVzcyBuZXdSZWdpc3RyYXIpIG9ubHlSZWdpc3RyYXIgewogICAgICAgIHJlZ2lzdHJhciA9IG5ld1JlZ2lzdHJhcjsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gc2V0QmFsYW5jZSh1aW50IG5ld1ZhbHVlKSBvbmx5UmVnaXN0cmFyIG9ubHlBY3RpdmUgcGF5YWJsZSB7CiAgICAgICAgLy8gQ2hlY2sgaWYgaXQgaGFzIGVub3VnaCBiYWxhbmNlIHRvIHNldCB0aGUgdmFsdWUKICAgICAgICBpZiAodmFsdWUgPCBuZXdWYWx1ZSkgdGhyb3c7CiAgICAgICAgdmFsdWUgPSBuZXdWYWx1ZTsKICAgICAgICAvLyBTZW5kIHRoZSBkaWZmZXJlbmNlIHRvIHRoZSBvd25lcgogICAgICAgIGlmICghb3duZXIuc2VuZCh0aGlzLmJhbGFuY2UgLSBuZXdWYWx1ZSkpIHRocm93OwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBDbG9zZSBhIGRlZWQgYW5kIHJlZnVuZCBhIHNwZWNpZmllZCBmcmFjdGlvbiBvZiB0aGUgYmlkIHZhbHVlCiAgICAgKiBAcGFyYW0gcmVmdW5kUmF0aW8gVGhlIGFtb3VudCoxLzEwMDAgdG8gcmVmdW5kCiAgICAgKi8KICAgIGZ1bmN0aW9uIGNsb3NlRGVlZCh1aW50IHJlZnVuZFJhdGlvKSBvbmx5UmVnaXN0cmFyIG9ubHlBY3RpdmUgewogICAgICAgIGFjdGl2ZSA9IGZhbHNlOyAgICAgICAgICAgIAogICAgICAgIGlmICghIGJ1cm4uc2VuZCgoKDEwMDAgLSByZWZ1bmRSYXRpbykgKiB0aGlzLmJhbGFuY2UpLzEwMDApKSB0aHJvdzsKICAgICAgICBEZWVkQ2xvc2VkKCk7CiAgICAgICAgZGVzdHJveURlZWQoKTsKICAgIH0gICAgCgogICAgLyoqCiAgICAgKiBAZGV2IENsb3NlIGEgZGVlZCBhbmQgcmVmdW5kIGEgc3BlY2lmaWVkIGZyYWN0aW9uIG9mIHRoZSBiaWQgdmFsdWUKICAgICAqLwogICAgZnVuY3Rpb24gZGVzdHJveURlZWQoKSB7CiAgICAgICAgaWYgKGFjdGl2ZSkgdGhyb3c7CiAgICAgICAgaWYob3duZXIuc2VuZCh0aGlzLmJhbGFuY2UpKQogICAgICAgICAgICBzZWxmZGVzdHJ1Y3QoYnVybik7CiAgICB9CgogICAgLy8gVGhlIGRlZmF1bHQgZnVuY3Rpb24ganVzdCByZWNlaXZlcyBhbiBhbW91bnQKICAgIGZ1bmN0aW9uICgpIHBheWFibGUge30KfQoKLyoqCiAqIEB0aXRsZSBSZWdpc3RyYXIKICogQGRldiBUaGUgcmVnaXN0cmFyIGhhbmRsZXMgdGhlIGF1Y3Rpb24gcHJvY2VzcyBmb3IgZWFjaCBzdWJub2RlIG9mIHRoZSBub2RlIGl0IG93bnMuCiAqLwpjb250cmFjdCBSZWdpc3RyYXIgewogICAgQWJzdHJhY3RFTlMgcHVibGljIGVuczsKICAgIGJ5dGVzMzIgcHVibGljIHJvb3ROb2RlOwoKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gZW50cnkpIF9lbnRyaWVzOwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nKGJ5dGVzMzIgPT4gRGVlZCkpIHB1YmxpYyBzZWFsZWRCaWRzOwogICAgCiAgICBlbnVtIE1vZGUgeyBPcGVuLCBBdWN0aW9uLCBPd25lZCwgRm9yYmlkZGVuLCBSZXZlYWwgfQogICAgdWludDMyIGNvbnN0YW50IGF1Y3Rpb25MZW5ndGggPSA1IGRheXM7CiAgICB1aW50MzIgY29uc3RhbnQgcmV2ZWFsUGVyaW9kID0gNDggaG91cnM7CiAgICB1aW50MzIgY29uc3RhbnQgaW5pdGlhbEF1Y3Rpb25QZXJpb2QgPSA0IHdlZWtzOwogICAgdWludCBjb25zdGFudCBtaW5QcmljZSA9IDAuMDEgZXRoZXI7CiAgICB1aW50IHB1YmxpYyByZWdpc3RyeVN0YXJ0ZWQ7CgogICAgZXZlbnQgQXVjdGlvblN0YXJ0ZWQoYnl0ZXMzMiBpbmRleGVkIGhhc2gsIHVpbnQgcmVnaXN0cmF0aW9uRGF0ZSk7CiAgICBldmVudCBOZXdCaWQoYnl0ZXMzMiBpbmRleGVkIGhhc2gsIGFkZHJlc3MgaW5kZXhlZCBiaWRkZXIsIHVpbnQgZGVwb3NpdCk7CiAgICBldmVudCBCaWRSZXZlYWxlZChieXRlczMyIGluZGV4ZWQgaGFzaCwgYWRkcmVzcyBpbmRleGVkIG93bmVyLCB1aW50IHZhbHVlLCB1aW50OCBzdGF0dXMpOwogICAgZXZlbnQgSGFzaFJlZ2lzdGVyZWQoYnl0ZXMzMiBpbmRleGVkIGhhc2gsIGFkZHJlc3MgaW5kZXhlZCBvd25lciwgdWludCB2YWx1ZSwgdWludCByZWdpc3RyYXRpb25EYXRlKTsKICAgIGV2ZW50IEhhc2hSZWxlYXNlZChieXRlczMyIGluZGV4ZWQgaGFzaCwgdWludCB2YWx1ZSk7CiAgICBldmVudCBIYXNoSW52YWxpZGF0ZWQoYnl0ZXMzMiBpbmRleGVkIGhhc2gsIHN0cmluZyBpbmRleGVkIG5hbWUsIHVpbnQgdmFsdWUsIHVpbnQgcmVnaXN0cmF0aW9uRGF0ZSk7CgogICAgc3RydWN0IGVudHJ5IHsKICAgICAgICBEZWVkIGRlZWQ7CiAgICAgICAgdWludCByZWdpc3RyYXRpb25EYXRlOwogICAgICAgIHVpbnQgdmFsdWU7CiAgICAgICAgdWludCBoaWdoZXN0QmlkOwogICAgfQoKICAgIC8vIFN0YXRlIHRyYW5zaXRpb25zIGZvciBuYW1lczoKICAgIC8vICAgT3BlbiAtPiBBdWN0aW9uIChzdGFydEF1Y3Rpb24pCiAgICAvLyAgIEF1Y3Rpb24gLT4gUmV2ZWFsCiAgICAvLyAgIFJldmVhbCAtPiBPd25lZAogICAgLy8gICBSZXZlYWwgLT4gT3BlbiAoaWYgbm9ib2R5IGJpZCkKICAgIC8vICAgT3duZWQgLT4gRm9yYmlkZGVuIChpbnZhbGlkYXRlTmFtZSkKICAgIC8vICAgT3duZWQgLT4gT3BlbiAocmVsZWFzZURlZWQpCiAgICBmdW5jdGlvbiBzdGF0ZShieXRlczMyIF9oYXNoKSBjb25zdGFudCByZXR1cm5zIChNb2RlKSB7CiAgICAgICAgdmFyIGVudHJ5ID0gX2VudHJpZXNbX2hhc2hdOwogICAgICAgIGlmKG5vdyA8IGVudHJ5LnJlZ2lzdHJhdGlvbkRhdGUpIHsKICAgICAgICAgICAgaWYobm93IDwgZW50cnkucmVnaXN0cmF0aW9uRGF0ZSAtIHJldmVhbFBlcmlvZCkgewogICAgICAgICAgICAgICAgcmV0dXJuIE1vZGUuQXVjdGlvbjsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiBNb2RlLlJldmVhbDsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmKGVudHJ5LmhpZ2hlc3RCaWQgPT0gMCkgewogICAgICAgICAgICAgICAgcmV0dXJuIE1vZGUuT3BlbjsKICAgICAgICAgICAgfSBlbHNlIGlmKGVudHJ5LmRlZWQgPT0gRGVlZCgwKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIE1vZGUuRm9yYmlkZGVuOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIE1vZGUuT3duZWQ7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAKICAgIG1vZGlmaWVyIGluU3RhdGUoYnl0ZXMzMiBfaGFzaCwgTW9kZSBfc3RhdGUpIHsKICAgICAgICBpZihzdGF0ZShfaGFzaCkgIT0gX3N0YXRlKSB0aHJvdzsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlPd25lcihieXRlczMyIF9oYXNoKSB7CiAgICAgICAgaWYgKHN0YXRlKF9oYXNoKSAhPSBNb2RlLk93bmVkIHx8IG1zZy5zZW5kZXIgIT0gX2VudHJpZXNbX2hhc2hdLmRlZWQub3duZXIoKSkgdGhyb3c7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgbW9kaWZpZXIgcmVnaXN0cnlPcGVuKCkgewogICAgICAgIGlmKG5vdyA8IHJlZ2lzdHJ5U3RhcnRlZCAgfHwgbm93ID4gcmVnaXN0cnlTdGFydGVkICsgNCB5ZWFycyB8fCBlbnMub3duZXIocm9vdE5vZGUpICE9IGFkZHJlc3ModGhpcykpIHRocm93OwogICAgICAgIF87CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGVudHJpZXMoYnl0ZXMzMiBfaGFzaCkgY29uc3RhbnQgcmV0dXJucyAoTW9kZSwgYWRkcmVzcywgdWludCwgdWludCwgdWludCkgewogICAgICAgIGVudHJ5IGggPSBfZW50cmllc1tfaGFzaF07CiAgICAgICAgcmV0dXJuIChzdGF0ZShfaGFzaCksIGguZGVlZCwgaC5yZWdpc3RyYXRpb25EYXRlLCBoLnZhbHVlLCBoLmhpZ2hlc3RCaWQpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEBkZXYgQ29uc3RydWN0cyBhIG5ldyBSZWdpc3RyYXIsIHdpdGggdGhlIHByb3ZpZGVkIGFkZHJlc3MgYXMgdGhlIG93bmVyIG9mIHRoZSByb290IG5vZGUuCiAgICAgKiBAcGFyYW0gX2VucyBUaGUgYWRkcmVzcyBvZiB0aGUgRU5TCiAgICAgKiBAcGFyYW0gX3Jvb3ROb2RlIFRoZSBoYXNoIG9mIHRoZSByb290bm9kZS4KICAgICAqLwogICAgZnVuY3Rpb24gUmVnaXN0cmFyKGFkZHJlc3MgX2VucywgYnl0ZXMzMiBfcm9vdE5vZGUsIHVpbnQgX3N0YXJ0RGF0ZSkgewogICAgICAgIGVucyA9IEFic3RyYWN0RU5TKF9lbnMpOwogICAgICAgIHJvb3ROb2RlID0gX3Jvb3ROb2RlOwogICAgICAgIHJlZ2lzdHJ5U3RhcnRlZCA9IF9zdGFydERhdGUgPiAwID8gX3N0YXJ0RGF0ZSA6IG5vdzsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgUmV0dXJucyB0aGUgbWF4aW11bSBvZiB0d28gdW5zaWduZWQgaW50ZWdlcnMKICAgICAqIEBwYXJhbSBhIEEgbnVtYmVyIHRvIGNvbXBhcmUKICAgICAqIEBwYXJhbSBiIEEgbnVtYmVyIHRvIGNvbXBhcmUKICAgICAqIEByZXR1cm4gVGhlIG1heGltdW0gb2YgdHdvIHVuc2lnbmVkIGludGVnZXJzCiAgICAgKi8KICAgIGZ1bmN0aW9uIG1heCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludCBtYXgpIHsKICAgICAgICBpZiAoYSA+IGIpCiAgICAgICAgICAgIHJldHVybiBhOwogICAgICAgIGVsc2UKICAgICAgICAgICAgcmV0dXJuIGI7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IFJldHVybnMgdGhlIG1pbmltdW0gb2YgdHdvIHVuc2lnbmVkIGludGVnZXJzCiAgICAgKiBAcGFyYW0gYSBBIG51bWJlciB0byBjb21wYXJlCiAgICAgKiBAcGFyYW0gYiBBIG51bWJlciB0byBjb21wYXJlCiAgICAgKiBAcmV0dXJuIFRoZSBtaW5pbXVtIG9mIHR3byB1bnNpZ25lZCBpbnRlZ2VycwogICAgICovCiAgICBmdW5jdGlvbiBtaW4odWludCBhLCB1aW50IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQgbWluKSB7CiAgICAgICAgaWYgKGEgPCBiKQogICAgICAgICAgICByZXR1cm4gYTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJldHVybiBiOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBSZXR1cm5zIHRoZSBsZW5ndGggb2YgYSBnaXZlbiBzdHJpbmcKICAgICAqIEBwYXJhbSBzIFRoZSBzdHJpbmcgdG8gbWVhc3VyZSB0aGUgbGVuZ3RoIG9mCiAgICAgKiBAcmV0dXJuIFRoZSBsZW5ndGggb2YgdGhlIGlucHV0IHN0cmluZwogICAgICovCiAgICBmdW5jdGlvbiBzdHJsZW4oc3RyaW5nIHMpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICAvLyBTdGFydGluZyBoZXJlIG1lYW5zIHRoZSBMU0Igd2lsbCBiZSB0aGUgYnl0ZSB3ZSBjYXJlIGFib3V0CiAgICAgICAgdWludCBwdHI7CiAgICAgICAgdWludCBlbmQ7CiAgICAgICAgYXNzZW1ibHkgewogICAgICAgICAgICBwdHIgOj0gYWRkKHMsIDEpCiAgICAgICAgICAgIGVuZCA6PSBhZGQobWxvYWQocyksIHB0cikKICAgICAgICB9CiAgICAgICAgZm9yICh1aW50IGxlbiA9IDA7IHB0ciA8IGVuZDsgbGVuKyspIHsKICAgICAgICAgICAgdWludDggYjsKICAgICAgICAgICAgYXNzZW1ibHkgeyBiIDo9IGFuZChtbG9hZChwdHIpLCAweEZGKSB9CiAgICAgICAgICAgIGlmIChiIDwgMHg4MCkgewogICAgICAgICAgICAgICAgcHRyICs9IDE7CiAgICAgICAgICAgIH0gZWxzZSBpZihiIDwgMHhFMCkgewogICAgICAgICAgICAgICAgcHRyICs9IDI7CiAgICAgICAgICAgIH0gZWxzZSBpZihiIDwgMHhGMCkgewogICAgICAgICAgICAgICAgcHRyICs9IDM7CiAgICAgICAgICAgIH0gZWxzZSBpZihiIDwgMHhGOCkgewogICAgICAgICAgICAgICAgcHRyICs9IDQ7CiAgICAgICAgICAgIH0gZWxzZSBpZihiIDwgMHhGQykgewogICAgICAgICAgICAgICAgcHRyICs9IDU7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBwdHIgKz0gNjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gbGVuOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBTdGFydCBhbiBhdWN0aW9uIGZvciBhbiBhdmFpbGFibGUgaGFzaAogICAgICogCiAgICAgKiBBbnlvbmUgY2FuIHN0YXJ0IGFuIGF1Y3Rpb24gYnkgc2VuZGluZyBhbiBhcnJheSBvZiBoYXNoZXMgdGhhdCB0aGV5IHdhbnQgdG8gYmlkIGZvci4gCiAgICAgKiBBcnJheXMgYXJlIHNlbnQgc28gdGhhdCBzb21lb25lIGNhbiBvcGVuIHVwIGFuIGF1Y3Rpb24gZm9yIFggZHVtbXkgaGFzaGVzIHdoZW4gdGhleSAKICAgICAqIGFyZSBvbmx5IHJlYWxseSBpbnRlcmVzdGVkIGluIGJpZGRpbmcgZm9yIG9uZS4gVGhpcyB3aWxsIGluY3JlYXNlIHRoZSBjb3N0IGZvciBhbiAKICAgICAqIGF0dGFja2VyIHRvIHNpbXBseSBiaWQgYmxpbmRseSBvbiBhbGwgbmV3IGF1Y3Rpb25zLiBEdW1teSBhdWN0aW9ucyB0aGF0IGFyZSAKICAgICAqIG9wZW4gYnV0IG5vdCBiaWQgb24gYXJlIGNsb3NlZCBhZnRlciBhIHdlZWsuIAogICAgICoKICAgICAqIEBwYXJhbSBfaGFzaCBUaGUgaGFzaCB0byBzdGFydCBhbiBhdWN0aW9uIG9uCiAgICAgKi8gICAgCiAgICBmdW5jdGlvbiBzdGFydEF1Y3Rpb24oYnl0ZXMzMiBfaGFzaCkgaW5TdGF0ZShfaGFzaCwgTW9kZS5PcGVuKSByZWdpc3RyeU9wZW4oKSB7CiAgICAgICAgZW50cnkgbmV3QXVjdGlvbiA9IF9lbnRyaWVzW19oYXNoXTsKCiAgICAgICAgLy8gZm9yIHRoZSBmaXJzdCBtb250aCBvZiB0aGUgcmVnaXN0cnksIG1ha2UgbG9uZ2VyIGF1Y3Rpb25zCiAgICAgICAgbmV3QXVjdGlvbi5yZWdpc3RyYXRpb25EYXRlID0gbWF4KG5vdyArIGF1Y3Rpb25MZW5ndGgsIHJlZ2lzdHJ5U3RhcnRlZCArIGluaXRpYWxBdWN0aW9uUGVyaW9kKTsKICAgICAgICBuZXdBdWN0aW9uLnZhbHVlID0gMDsKICAgICAgICBuZXdBdWN0aW9uLmhpZ2hlc3RCaWQgPSAwOwogICAgICAgIEF1Y3Rpb25TdGFydGVkKF9oYXNoLCBuZXdBdWN0aW9uLnJlZ2lzdHJhdGlvbkRhdGUpOyAgICAgIAogICAgfQoKICAgIC8qKgogICAgICogQGRldiBTdGFydCBtdWx0aXBsZSBhdWN0aW9ucyBmb3IgYmV0dGVyIGFub255bWl0eQogICAgICogQHBhcmFtIF9oYXNoZXMgQW4gYXJyYXkgb2YgaGFzaGVzLCBhdCBsZWFzdCBvbmUgb2Ygd2hpY2ggeW91IHByZXN1bWFibHkgd2FudCB0byBiaWQgb24KICAgICAqLwogICAgZnVuY3Rpb24gc3RhcnRBdWN0aW9ucyhieXRlczMyW10gX2hhc2hlcykgIHsKICAgICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBfaGFzaGVzLmxlbmd0aDsgaSArKyApIHsKICAgICAgICAgICAgc3RhcnRBdWN0aW9uKF9oYXNoZXNbaV0pOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBAZGV2IEhhc2ggdGhlIHZhbHVlcyByZXF1aXJlZCBmb3IgYSBzZWNyZXQgYmlkCiAgICAgKiBAcGFyYW0gaGFzaCBUaGUgbm9kZSBjb3JyZXNwb25kaW5nIHRvIHRoZSBkZXNpcmVkIG5hbWVoYXNoCiAgICAgKiBAcGFyYW0gb3duZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBvd24gdGhlIAogICAgICogQHBhcmFtIHZhbHVlIFRoZSBiaWQgYW1vdW50CiAgICAgKiBAcGFyYW0gc2FsdCBBIHJhbmRvbSB2YWx1ZSB0byBlbnN1cmUgc2VjcmVjeSBvZiB0aGUgYmlkCiAgICAgKiBAcmV0dXJuIFRoZSBoYXNoIG9mIHRoZSBiaWQgdmFsdWVzCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNoYUJpZChieXRlczMyIGhhc2gsIGFkZHJlc3Mgb3duZXIsIHVpbnQgdmFsdWUsIGJ5dGVzMzIgc2FsdCkgY29uc3RhbnQgcmV0dXJucyAoYnl0ZXMzMiBzZWFsZWRCaWQpIHsKICAgICAgICByZXR1cm4gc2hhMyhoYXNoLCBvd25lciwgdmFsdWUsIHNhbHQpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEBkZXYgU3VibWl0IGEgbmV3IHNlYWxlZCBiaWQgb24gYSBkZXNpcmVkIGhhc2ggaW4gYSBibGluZCBhdWN0aW9uCiAgICAgKiAKICAgICAqIEJpZHMgYXJlIHNlbnQgYnkgc2VuZGluZyBhIG1lc3NhZ2UgdG8gdGhlIG1haW4gY29udHJhY3Qgd2l0aCBhIGhhc2ggYW5kIGFuIGFtb3VudC4gVGhlIGhhc2ggCiAgICAgKiBjb250YWlucyBpbmZvcm1hdGlvbiBhYm91dCB0aGUgYmlkLCBpbmNsdWRpbmcgdGhlIGJpZGRlZCBoYXNoLCB0aGUgYmlkIGFtb3VudCwgYW5kIGEgcmFuZG9tIAogICAgICogc2FsdC4gQmlkcyBhcmUgbm90IHRpZWQgdG8gYW55IG9uZSBhdWN0aW9uIHVudGlsIHRoZXkgYXJlIHJldmVhbGVkLiBUaGUgdmFsdWUgb2YgdGhlIGJpZCAKICAgICAqIGl0c2VsZiBjYW4gYmUgbWFzcXVlcmFkZWQgYnkgc2VuZGluZyBtb3JlIHRoYW4gdGhlIHZhbHVlIG9mIHlvdXIgYWN0dWFsIGJpZC4gVGhpcyBpcyAKICAgICAqIGZvbGxvd2VkIGJ5IGEgMjRoIHJldmVhbCBwZXJpb2QuIEJpZHMgcmV2ZWFsZWQgYWZ0ZXIgdGhpcyBwZXJpb2Qgd2lsbCBiZSBidXJuZWQgYW5kIHRoZSBldGhlciB1bnJlY292ZXJhYmxlLiAKICAgICAqIFNpbmNlIHRoaXMgaXMgYW4gYXVjdGlvbiwgaXQgaXMgZXhwZWN0ZWQgdGhhdCBtb3N0IHB1YmxpYyBoYXNoZXMsIGxpa2Uga25vd24gZG9tYWlucyBhbmQgY29tbW9uIGRpY3Rpb25hcnkgCiAgICAgKiB3b3Jkcywgd2lsbCBoYXZlIG11bHRpcGxlIGJpZGRlcnMgcHVzaGluZyB0aGUgcHJpY2UgdXAuIAogICAgICoKICAgICAqIEBwYXJhbSBzZWFsZWRCaWQgQSBzZWFsZWRCaWQsIGNyZWF0ZWQgYnkgdGhlIHNoYUJpZCBmdW5jdGlvbgogICAgICovCiAgICBmdW5jdGlvbiBuZXdCaWQoYnl0ZXMzMiBzZWFsZWRCaWQpIHBheWFibGUgewogICAgICAgIGlmIChhZGRyZXNzKHNlYWxlZEJpZHNbbXNnLnNlbmRlcl1bc2VhbGVkQmlkXSkgPiAwICkgdGhyb3c7CiAgICAgICAgaWYgKG1zZy52YWx1ZSA8IG1pblByaWNlKSB0aHJvdzsKICAgICAgICAvLyBjcmVhdGVzIGEgbmV3IGhhc2ggY29udHJhY3Qgd2l0aCB0aGUgb3duZXIKICAgICAgICBEZWVkIG5ld0JpZCA9IG5ldyBEZWVkKG1zZy52YWx1ZSk7CiAgICAgICAgc2VhbGVkQmlkc1ttc2cuc2VuZGVyXVtzZWFsZWRCaWRdID0gbmV3QmlkOwogICAgICAgIE5ld0JpZChzZWFsZWRCaWQsIG1zZy5zZW5kZXIsIG1zZy52YWx1ZSk7CgogICAgICAgIGlmICghbmV3QmlkLnNlbmQobXNnLnZhbHVlKSkgdGhyb3c7CiAgICB9IAoKICAgIC8qKgogICAgICogQGRldiBTdWJtaXQgdGhlIHByb3BlcnRpZXMgb2YgYSBiaWQgdG8gcmV2ZWFsIHRoZW0KICAgICAqIEBwYXJhbSBfaGFzaCBUaGUgbm9kZSBpbiB0aGUgc2VhbGVkQmlkCiAgICAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIGluIHRoZSBzZWFsZWRCaWQKICAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGJpZCBhbW91bnQgaW4gdGhlIHNlYWxlZEJpZAogICAgICogQHBhcmFtIF9zYWx0IFRoZSBzYWxlIGluIHRoZSBzZWFsZWRCaWQKICAgICAqLyAKICAgIGZ1bmN0aW9uIHVuc2VhbEJpZChieXRlczMyIF9oYXNoLCBhZGRyZXNzIF9vd25lciwgdWludCBfdmFsdWUsIGJ5dGVzMzIgX3NhbHQpIHsKICAgICAgICBieXRlczMyIHNlYWwgPSBzaGFCaWQoX2hhc2gsIF9vd25lciwgX3ZhbHVlLCBfc2FsdCk7CiAgICAgICAgRGVlZCBiaWQgPSBzZWFsZWRCaWRzW21zZy5zZW5kZXJdW3NlYWxdOwogICAgICAgIGlmIChhZGRyZXNzKGJpZCkgPT0gMCApIHRocm93OwogICAgICAgIHNlYWxlZEJpZHNbbXNnLnNlbmRlcl1bc2VhbF0gPSBEZWVkKDApOwogICAgICAgIGJpZC5zZXRPd25lcihfb3duZXIpOwogICAgICAgIGVudHJ5IGggPSBfZW50cmllc1tfaGFzaF07CiAgICAgICAgdWludCBhY3R1YWxWYWx1ZSA9IG1pbihfdmFsdWUsIGJpZC52YWx1ZSgpKTsKICAgICAgICBiaWQuc2V0QmFsYW5jZShhY3R1YWxWYWx1ZSk7CgogICAgICAgIHZhciBhdWN0aW9uU3RhdGUgPSBzdGF0ZShfaGFzaCk7CiAgICAgICAgaWYoYXVjdGlvblN0YXRlID09IE1vZGUuT3duZWQpIHsKICAgICAgICAgICAgLy8gVG9vIGxhdGUhIEJpZGRlciBsb3NlcyB0aGVpciBiaWQuIEdldCdzIDAuNSUgYmFjay4KICAgICAgICAgICAgYmlkLmNsb3NlRGVlZCg1KTsKICAgICAgICAgICAgQmlkUmV2ZWFsZWQoX2hhc2gsIF9vd25lciwgYWN0dWFsVmFsdWUsIDEpOwogICAgICAgIH0gZWxzZSBpZihhdWN0aW9uU3RhdGUgIT0gTW9kZS5SZXZlYWwpIHsKICAgICAgICAgICAgLy8gSW52YWxpZCBwaGFzZQogICAgICAgICAgICB0aHJvdzsKICAgICAgICB9IGVsc2UgaWYgKF92YWx1ZSA8IG1pblByaWNlIHx8IGJpZC5jcmVhdGlvbkRhdGUoKSA+IGgucmVnaXN0cmF0aW9uRGF0ZSAtIHJldmVhbFBlcmlvZCkgewogICAgICAgICAgICAvLyBCaWQgdG9vIGxvdyBvciB0b28gbGF0ZSwgcmVmdW5kIDk5LjUlCiAgICAgICAgICAgIGJpZC5jbG9zZURlZWQoOTk1KTsKICAgICAgICAgICAgQmlkUmV2ZWFsZWQoX2hhc2gsIF9vd25lciwgYWN0dWFsVmFsdWUsIDApOwogICAgICAgIH0gZWxzZSBpZiAoX3ZhbHVlID4gaC5oaWdoZXN0QmlkKSB7CiAgICAgICAgICAgIC8vIG5ldyB3aW5uZXIKICAgICAgICAgICAgLy8gY2FuY2VsIHRoZSBvdGhlciBiaWQsIHJlZnVuZCA5OS41JQogICAgICAgICAgICBpZihhZGRyZXNzKGguZGVlZCkgIT0gMCkgewogICAgICAgICAgICAgICAgRGVlZCBwcmV2aW91c1dpbm5lciA9IGguZGVlZDsKICAgICAgICAgICAgICAgIHByZXZpb3VzV2lubmVyLmNsb3NlRGVlZCg5OTUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBzZXQgbmV3IHdpbm5lcgogICAgICAgICAgICAvLyBwZXIgdGhlIHJ1bGVzIG9mIGEgdmlja2VyeSBhdWN0aW9uLCB0aGUgdmFsdWUgYmVjb21lcyB0aGUgcHJldmlvdXMgaGlnaGVzdEJpZAogICAgICAgICAgICBoLnZhbHVlID0gaC5oaWdoZXN0QmlkOwogICAgICAgICAgICBoLmhpZ2hlc3RCaWQgPSBhY3R1YWxWYWx1ZTsKICAgICAgICAgICAgaC5kZWVkID0gYmlkOwogICAgICAgICAgICBCaWRSZXZlYWxlZChfaGFzaCwgX293bmVyLCBhY3R1YWxWYWx1ZSwgMik7CiAgICAgICAgfSBlbHNlIGlmIChfdmFsdWUgPiBoLnZhbHVlKSB7CiAgICAgICAgICAgIC8vIG5vdCB3aW5uZXIsIGJ1dCBhZmZlY3RzIHNlY29uZCBwbGFjZQogICAgICAgICAgICBoLnZhbHVlID0gYWN0dWFsVmFsdWU7CiAgICAgICAgICAgIGJpZC5jbG9zZURlZWQoOTk1KTsKICAgICAgICAgICAgQmlkUmV2ZWFsZWQoX2hhc2gsIF9vd25lciwgYWN0dWFsVmFsdWUsIDMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIGJpZCBkb2Vzbid0IGFmZmVjdCBhdWN0aW9uCiAgICAgICAgICAgIGJpZC5jbG9zZURlZWQoOTk1KTsKICAgICAgICAgICAgQmlkUmV2ZWFsZWQoX2hhc2gsIF9vd25lciwgYWN0dWFsVmFsdWUsIDQpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBAZGV2IENhbmNlbCBhIGJpZAogICAgICogQHBhcmFtIHNlYWwgVGhlIHZhbHVlIHJldHVybmVkIGJ5IHRoZSBzaGFCaWQgZnVuY3Rpb24KICAgICAqLyAKICAgIGZ1bmN0aW9uIGNhbmNlbEJpZChhZGRyZXNzIGJpZGRlciwgYnl0ZXMzMiBzZWFsKSB7CiAgICAgICAgRGVlZCBiaWQgPSBzZWFsZWRCaWRzW2JpZGRlcl1bc2VhbF07CiAgICAgICAgLy8gSWYgdGhlIGJpZCBoYXNuJ3QgYmVlbiByZXZlYWxlZCBhZnRlciBhbnkgcG9zc2libGUgYXVjdGlvbiBkYXRlLCB0aGVuIGNsb3NlIGl0CiAgICAgICAgaWYgKGFkZHJlc3MoYmlkKSA9PSAwIAogICAgICAgICAgICB8fCBub3cgPCBiaWQuY3JlYXRpb25EYXRlKCkgKyBpbml0aWFsQXVjdGlvblBlcmlvZCAKICAgICAgICAgICAgfHwgYmlkLm93bmVyKCkgPiAwKSB0aHJvdzsKCiAgICAgICAgLy8gU2VuZCB0aGUgY2FuY2VsbGVyIDAuNSUgb2YgdGhlIGJpZCwgYW5kIGJ1cm4gdGhlIHJlc3QuCiAgICAgICAgYmlkLnNldE93bmVyKG1zZy5zZW5kZXIpOwogICAgICAgIGJpZC5jbG9zZURlZWQoNSk7CiAgICAgICAgc2VhbGVkQmlkc1tiaWRkZXJdW3NlYWxdID0gRGVlZCgwKTsKICAgICAgICBCaWRSZXZlYWxlZChzZWFsLCBiaWRkZXIsIDAsIDUpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBGaW5hbGl6ZSBhbiBhdWN0aW9uIGFmdGVyIHRoZSByZWdpc3RyYXRpb24gZGF0ZSBoYXMgcGFzc2VkCiAgICAgKiBAcGFyYW0gX2hhc2ggVGhlIGhhc2ggb2YgdGhlIG5hbWUgdGhlIGF1Y3Rpb24gaXMgZm9yCiAgICAgKi8gCiAgICBmdW5jdGlvbiBmaW5hbGl6ZUF1Y3Rpb24oYnl0ZXMzMiBfaGFzaCkgb25seU93bmVyKF9oYXNoKSB7CiAgICAgICAgZW50cnkgaCA9IF9lbnRyaWVzW19oYXNoXTsKCiAgICAgICAgaC52YWx1ZSA9ICBtYXgoaC52YWx1ZSwgbWluUHJpY2UpOwoKICAgICAgICAvLyBBc3NpZ24gdGhlIG93bmVyIGluIEVOUwogICAgICAgIGVucy5zZXRTdWJub2RlT3duZXIocm9vdE5vZGUsIF9oYXNoLCBoLmRlZWQub3duZXIoKSk7CgogICAgICAgIERlZWQgZGVlZENvbnRyYWN0ID0gaC5kZWVkOwogICAgICAgIGRlZWRDb250cmFjdC5zZXRCYWxhbmNlKGgudmFsdWUpOwogICAgICAgIEhhc2hSZWdpc3RlcmVkKF9oYXNoLCBkZWVkQ29udHJhY3Qub3duZXIoKSwgaC52YWx1ZSwgaC5yZWdpc3RyYXRpb25EYXRlKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgVGhlIG93bmVyIG9mIGEgZG9tYWluIG1heSB0cmFuc2ZlciBpdCB0byBzb21lb25lIGVsc2UgYXQgYW55IHRpbWUuCiAgICAgKiBAcGFyYW0gX2hhc2ggVGhlIG5vZGUgdG8gdHJhbnNmZXIKICAgICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8KICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXIoYnl0ZXMzMiBfaGFzaCwgYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyKF9oYXNoKSB7CiAgICAgICAgZW50cnkgaCA9IF9lbnRyaWVzW19oYXNoXTsKICAgICAgICBoLmRlZWQuc2V0T3duZXIobmV3T3duZXIpOwogICAgICAgIGVucy5zZXRTdWJub2RlT3duZXIocm9vdE5vZGUsIF9oYXNoLCBuZXdPd25lcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IEFmdGVyIHNvbWUgdGltZSwgdGhlIG93bmVyIGNhbiByZWxlYXNlIHRoZSBwcm9wZXJ0eSBhbmQgZ2V0IHRoZWlyIGV0aGVyIGJhY2sKICAgICAqIEBwYXJhbSBfaGFzaCBUaGUgbm9kZSB0byByZWxlYXNlCiAgICAgKi8KICAgIGZ1bmN0aW9uIHJlbGVhc2VEZWVkKGJ5dGVzMzIgX2hhc2gpIG9ubHlPd25lcihfaGFzaCkgewogICAgICAgIGVudHJ5IGggPSBfZW50cmllc1tfaGFzaF07CiAgICAgICAgRGVlZCBkZWVkQ29udHJhY3QgPSBoLmRlZWQ7CiAgICAgICAgaWYgKG5vdyA8IGgucmVnaXN0cmF0aW9uRGF0ZSArIDEgeWVhcnMgCiAgICAgICAgICAgIHx8IG5vdyA+IHJlZ2lzdHJ5U3RhcnRlZCArIDggeWVhcnMpIHRocm93OwoKICAgICAgICBIYXNoUmVsZWFzZWQoX2hhc2gsIGgudmFsdWUpOwogICAgICAgIAogICAgICAgIGgudmFsdWUgPSAwOwogICAgICAgIGguaGlnaGVzdEJpZCA9IDA7CiAgICAgICAgaC5kZWVkID0gRGVlZCgwKTsKCiAgICAgICAgZW5zLnNldFN1Ym5vZGVPd25lcihyb290Tm9kZSwgX2hhc2gsIDApOwogICAgICAgIGRlZWRDb250cmFjdC5jbG9zZURlZWQoMTAwMCk7CiAgICB9ICAKCiAgICAvKioKICAgICAqIEBkZXYgU3VibWl0IGEgbmFtZSA2IGNoYXJhY3RlcnMgbG9uZyBvciBsZXNzLiBJZiBpdCBoYXMgYmVlbiByZWdpc3RlcmVkLCAKICAgICAqIHRoZSBzdWJtaXR0ZXIgd2lsbCBlYXJuIDUwJSBvZiB0aGUgZGVlZCB2YWx1ZS4gV2UgYXJlIHB1cnBvc2VmdWxseQogICAgICogaGFuZGljYXBwaW5nIHRoZSBzaW1wbGlmaWVkIHJlZ2lzdHJhciBhcyBhIHdheSB0byBmb3JjZSBpdCBpbnRvIGJlaW5nIHJlc3RydWN0dXJlZAogICAgICogaW4gYSBmZXcgeWVhcnMuCiAgICAgKiBAcGFyYW0gdW5oYXNoZWROYW1lIEFuIGludmFsaWQgbmFtZSB0byBzZWFyY2ggZm9yIGluIHRoZSByZWdpc3RyeS4KICAgICAqIAogICAgICovCiAgICBmdW5jdGlvbiBpbnZhbGlkYXRlTmFtZShzdHJpbmcgdW5oYXNoZWROYW1lKSBpblN0YXRlKHNoYTModW5oYXNoZWROYW1lKSwgTW9kZS5Pd25lZCkgewogICAgICAgIGlmIChzdHJsZW4odW5oYXNoZWROYW1lKSA+IDYgKSB0aHJvdzsKICAgICAgICBieXRlczMyIGhhc2ggPSBzaGEzKHVuaGFzaGVkTmFtZSk7CiAgICAgICAgCiAgICAgICAgZW50cnkgaCA9IF9lbnRyaWVzW2hhc2hdOwogICAgICAgIGVucy5zZXRTdWJub2RlT3duZXIocm9vdE5vZGUsIGhhc2gsIDApOwogICAgICAgIGlmKGFkZHJlc3MoaC5kZWVkKSAhPSAwKSB7CiAgICAgICAgICAgIC8vIFJld2FyZCB0aGUgZGlzY292ZXJlciB3aXRoIDUwJSBvZiB0aGUgZGVlZAogICAgICAgICAgICAvLyBUaGUgcHJldmlvdXMgb3duZXIgZ2V0cyA1MCUKICAgICAgICAgICAgaC5kZWVkLnNldEJhbGFuY2UoaC5kZWVkLnZhbHVlKCkvMik7CiAgICAgICAgICAgIGguZGVlZC5zZXRPd25lcihtc2cuc2VuZGVyKTsKICAgICAgICAgICAgaC5kZWVkLmNsb3NlRGVlZCgxMDAwKTsKICAgICAgICB9CiAgICAgICAgSGFzaEludmFsaWRhdGVkKGhhc2gsIHVuaGFzaGVkTmFtZSwgaC52YWx1ZSwgaC5yZWdpc3RyYXRpb25EYXRlKTsKICAgICAgICBoLmRlZWQgPSBEZWVkKDApOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBUcmFuc2ZlcnMgdGhlIGRlZWQgdG8gdGhlIGN1cnJlbnQgcmVnaXN0cmFyLCBpZiBkaWZmZXJlbnQgZnJvbSB0aGlzIG9uZS4KICAgICAqIFVzZWQgZHVyaW5nIHRoZSB1cGdyYWRlIHByb2Nlc3MgdG8gYSBwZXJtYW5lbnQgcmVnaXN0cmFyLgogICAgICogQHBhcmFtIF9oYXNoIFRoZSBuYW1lIGhhc2ggdG8gdHJhbnNmZXIuCiAgICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyUmVnaXN0cmFycyhieXRlczMyIF9oYXNoKSBvbmx5T3duZXIoX2hhc2gpIHsKICAgICAgICB2YXIgcmVnaXN0cmFyID0gZW5zLm93bmVyKHJvb3ROb2RlKTsKICAgICAgICBpZihyZWdpc3RyYXIgPT0gYWRkcmVzcyh0aGlzKSkKICAgICAgICAgICAgdGhyb3c7CgogICAgICAgIGVudHJ5IGggPSBfZW50cmllc1tfaGFzaF07CiAgICAgICAgaC5kZWVkLnNldFJlZ2lzdHJhcihyZWdpc3RyYXIpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBSZXR1cm5zIGEgZGVlZCBjcmVhdGVkIGJ5IGEgcHJldmlvdXMgaW5zdGFuY2Ugb2YgdGhlIHJlZ2lzdHJhci4KICAgICAqIEBwYXJhbSBkZWVkIFRoZSBhZGRyZXNzIG9mIHRoZSBkZWVkLgogICAgICovCiAgICBmdW5jdGlvbiByZXR1cm5EZWVkKERlZWQgZGVlZCkgewogICAgICAgIC8vIE9ubHkgcmV0dXJuIGlmIHdlIG93biB0aGUgZGVlZCwgYW5kIGl0IHdhcyBjcmVhdGVkIGJlZm9yZSBvdXIgc3RhcnQgZGF0ZS4KICAgICAgICBpZihkZWVkLnJlZ2lzdHJhcigpICE9IGFkZHJlc3ModGhpcykgfHwgZGVlZC5jcmVhdGlvbkRhdGUoKSA+IHJlZ2lzdHJ5U3RhcnRlZCkKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgZGVlZC5jbG9zZURlZWQoMTAwMCk7CiAgICB9Cn0='.
	

]
