Class {
	#name : #SRT1998b337ca479a623299a76bdafdf75b41070b79,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT1998b337ca479a623299a76bdafdf75b41070b79 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHB1YmxpYyB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOwogICAgb3duZXIgPSBuZXdPd25lcjsKICB9Cgp9Cgpjb250cmFjdCBSZWNlaXZpbmdDb250cmFjdENhbGxiYWNrIHsKCiAgZnVuY3Rpb24gdG9rZW5GYWxsYmFjayhhZGRyZXNzIF9mcm9tLCB1aW50IF92YWx1ZSkgcHVibGljOwoKfQoKCmNvbnRyYWN0IFJldHJpZXZlVG9rZW5zRmVhdHVyZSBpcyBPd25hYmxlIHsKCiAgZnVuY3Rpb24gcmV0cmlldmVUb2tlbnMoYWRkcmVzcyB0bywgYWRkcmVzcyBhbm90aGVyVG9rZW4pIHB1YmxpYyBvbmx5T3duZXIgewogICAgRVJDMjAgYWxpZW5Ub2tlbiA9IEVSQzIwKGFub3RoZXJUb2tlbik7CiAgICBhbGllblRva2VuLnRyYW5zZmVyKHRvLCBhbGllblRva2VuLmJhbGFuY2VPZih0aGlzKSk7CiAgfQoKfQoKCgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKGEgPT0gMCkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgoKLyoqCiAqIEB0aXRsZSBFUkMyMEJhc2ljCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5CiAqLwpjb250cmFjdCBFUkMyMEJhc2ljIHsKICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKCi8qKgogKiBAdGl0bGUgQmFzaWMgdG9rZW4KICogQGRldiBCYXNpYyB2ZXJzaW9uIG9mIFN0YW5kYXJkVG9rZW4sIHdpdGggbm8gYWxsb3dhbmNlcy4KICovCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgLyoqCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1ttc2cuc2VuZGVyXSk7CgogICAgLy8gU2FmZU1hdGguc3ViIHdpbGwgdGhyb3cgaWYgdGhlcmUgaXMgbm90IGVub3VnaCBiYWxhbmNlLgogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgKi8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKfQoKCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CgoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBAZGV2IEluY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX2FkZGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gaW5jcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IERlY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBkZWNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3N1YnRyYWN0ZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBkZWNyZWFzZSB0aGUgYWxsb3dhbmNlIGJ5LgogICAqLwogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9Cgpjb250cmFjdCBNaW50YWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4sIE93bmFibGUgewoKICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwoKICBldmVudCBNaW50RmluaXNoZWQoKTsKCiAgYm9vbCBwdWJsaWMgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CgogIGFkZHJlc3MgcHVibGljIHNhbGVBZ2VudDsKCiAgYWRkcmVzcyBwdWJsaWMgdW5sb2NrZWRBZGRyZXNzOwoKICBmdW5jdGlvbiBzZXRVbmxvY2tlZEFkZHJlc3MoYWRkcmVzcyBuZXdVbmxvY2tlZEFkZHJlc3MpIHB1YmxpYyBvbmx5T3duZXIgewogICAgdW5sb2NrZWRBZGRyZXNzID0gbmV3VW5sb2NrZWRBZGRyZXNzOwogIH0KCiAgbW9kaWZpZXIgbm90TG9ja2VkKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyIHx8IG1zZy5zZW5kZXIgPT0gc2FsZUFnZW50IHx8IG1zZy5zZW5kZXIgPT0gdW5sb2NrZWRBZGRyZXNzIHx8IG1pbnRpbmdGaW5pc2hlZCk7CiAgICBfOwogIH0KCiAgZnVuY3Rpb24gc2V0U2FsZUFnZW50KGFkZHJlc3MgbmV3U2FsZUFnbmV0KSBwdWJsaWMgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IHNhbGVBZ2VudCB8fCBtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIHNhbGVBZ2VudCA9IG5ld1NhbGVBZ25ldDsKICB9CgogIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoKG1zZy5zZW5kZXIgPT0gc2FsZUFnZW50IHx8IG1zZy5zZW5kZXIgPT0gb3duZXIpICYmICFtaW50aW5nRmluaXNoZWQpOwogICAgCiAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfYW1vdW50KTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfYW1vdW50KTsKICAgIE1pbnQoX3RvLCBfYW1vdW50KTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBzdG9wIG1pbnRpbmcgbmV3IHRva2Vucy4KICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBmaW5pc2hNaW50aW5nKCkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoKG1zZy5zZW5kZXIgPT0gc2FsZUFnZW50IHx8IG1zZy5zZW5kZXIgPT0gb3duZXIpICYmICFtaW50aW5nRmluaXNoZWQpOwogICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgIE1pbnRGaW5pc2hlZCgpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyBub3RMb2NrZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyBub3RMb2NrZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShmcm9tLCB0bywgdmFsdWUpOwogIH0KCn0KCgpjb250cmFjdCBOZXh0U2FsZUFnZW50RmVhdHVyZSBpcyBPd25hYmxlIHsKCiAgYWRkcmVzcyBwdWJsaWMgbmV4dFNhbGVBZ2VudDsKCiAgZnVuY3Rpb24gc2V0TmV4dFNhbGVBZ2VudChhZGRyZXNzIG5ld05leHRTYWxlQWdlbnQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgbmV4dFNhbGVBZ2VudCA9IG5ld05leHRTYWxlQWdlbnQ7CiAgfQoKfQoKY29udHJhY3QgUGVyY2VudFJhdGVQcm92aWRlciBpcyBPd25hYmxlIHsKCiAgdWludCBwdWJsaWMgcGVyY2VudFJhdGUgPSAxMDA7CgogIGZ1bmN0aW9uIHNldFBlcmNlbnRSYXRlKHVpbnQgbmV3UGVyY2VudFJhdGUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcGVyY2VudFJhdGUgPSBuZXdQZXJjZW50UmF0ZTsKICB9Cgp9CgoKY29udHJhY3QgV2FsbGV0UHJvdmlkZXIgaXMgT3duYWJsZSB7CgogIGFkZHJlc3MgcHVibGljIHdhbGxldDsKCiAgZnVuY3Rpb24gc2V0V2FsbGV0KGFkZHJlc3MgbmV3V2FsbGV0KSBwdWJsaWMgb25seU93bmVyIHsKICAgIHdhbGxldCA9IG5ld1dhbGxldDsKICB9Cgp9CgoKCmNvbnRyYWN0IElucHV0QWRkcmVzc0ZlYXR1cmUgewoKICBmdW5jdGlvbiBieXRlc1RvQWRkcmVzcyhieXRlcyBzb3VyY2UpIGludGVybmFsIHB1cmUgcmV0dXJucyhhZGRyZXNzKSB7CiAgICB1aW50IHJlc3VsdDsKICAgIHVpbnQgbXVsID0gMTsKICAgIGZvcih1aW50IGkgPSAyMDsgaSA+IDA7IGktLSkgewogICAgICByZXN1bHQgKz0gdWludDgoc291cmNlW2ktMV0pKm11bDsKICAgICAgbXVsID0gbXVsKjI1NjsKICAgIH0KICAgIHJldHVybiBhZGRyZXNzKHJlc3VsdCk7CiAgfQoKICBmdW5jdGlvbiBnZXRJbnB1dEFkZHJlc3MoKSBpbnRlcm5hbCBwdXJlIHJldHVybnMoYWRkcmVzcykgewogICAgaWYobXNnLmRhdGEubGVuZ3RoID09IDIwKSB7CiAgICAgIHJldHVybiBieXRlc1RvQWRkcmVzcyhieXRlcyhtc2cuZGF0YSkpOwogICAgfQogICAgcmV0dXJuIGFkZHJlc3MoMCk7CiAgfQoKfQoKY29udHJhY3QgSW52ZXN0ZWRQcm92aWRlciBpcyBPd25hYmxlIHsKCiAgdWludCBwdWJsaWMgaW52ZXN0ZWQ7Cgp9CgoKY29udHJhY3QgU3RhZ2VkQ3Jvd2RzYWxlIGlzIE93bmFibGUgewoKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsKCiAgc3RydWN0IE1pbGVzdG9uZSB7CiAgICB1aW50IHBlcmlvZDsKICAgIHVpbnQgYm9udXM7CiAgfQoKICB1aW50IHB1YmxpYyB0b3RhbFBlcmlvZDsKCiAgTWlsZXN0b25lW10gcHVibGljIG1pbGVzdG9uZXM7CgogIGZ1bmN0aW9uIG1pbGVzdG9uZXNDb3VudCgpIHB1YmxpYyB2aWV3IHJldHVybnModWludCkgewogICAgcmV0dXJuIG1pbGVzdG9uZXMubGVuZ3RoOwogIH0KCiAgZnVuY3Rpb24gYWRkTWlsZXN0b25lKHVpbnQgcGVyaW9kLCB1aW50IGJvbnVzKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUocGVyaW9kID4gMCk7CiAgICBtaWxlc3RvbmVzLnB1c2goTWlsZXN0b25lKHBlcmlvZCwgYm9udXMpKTsKICAgIHRvdGFsUGVyaW9kID0gdG90YWxQZXJpb2QuYWRkKHBlcmlvZCk7CiAgfQoKICBmdW5jdGlvbiByZW1vdmVNaWxlc3RvbmUodWludDggbnVtYmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobnVtYmVyIDwgbWlsZXN0b25lcy5sZW5ndGgpOwogICAgTWlsZXN0b25lIHN0b3JhZ2UgbWlsZXN0b25lID0gbWlsZXN0b25lc1tudW1iZXJdOwogICAgdG90YWxQZXJpb2QgPSB0b3RhbFBlcmlvZC5zdWIobWlsZXN0b25lLnBlcmlvZCk7CgogICAgZGVsZXRlIG1pbGVzdG9uZXNbbnVtYmVyXTsKCiAgICBmb3IgKHVpbnQgaSA9IG51bWJlcjsgaSA8IG1pbGVzdG9uZXMubGVuZ3RoIC0gMTsgaSsrKSB7CiAgICAgIG1pbGVzdG9uZXNbaV0gPSBtaWxlc3RvbmVzW2krMV07CiAgICB9CgogICAgbWlsZXN0b25lcy5sZW5ndGgtLTsKICB9CgogIGZ1bmN0aW9uIGNoYW5nZU1pbGVzdG9uZSh1aW50OCBudW1iZXIsIHVpbnQgcGVyaW9kLCB1aW50IGJvbnVzKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlcXVpcmUobnVtYmVyIDwgbWlsZXN0b25lcy5sZW5ndGgpOwogICAgTWlsZXN0b25lIHN0b3JhZ2UgbWlsZXN0b25lID0gbWlsZXN0b25lc1tudW1iZXJdOwoKICAgIHRvdGFsUGVyaW9kID0gdG90YWxQZXJpb2Quc3ViKG1pbGVzdG9uZS5wZXJpb2QpOwoKICAgIG1pbGVzdG9uZS5wZXJpb2QgPSBwZXJpb2Q7CiAgICBtaWxlc3RvbmUuYm9udXMgPSBib251czsKCiAgICB0b3RhbFBlcmlvZCA9IHRvdGFsUGVyaW9kLmFkZChwZXJpb2QpOwogIH0KCiAgZnVuY3Rpb24gaW5zZXJ0TWlsZXN0b25lKHVpbnQ4IG51bWJlckFmdGVyLCB1aW50IHBlcmlvZCwgdWludCBib251cykgcHVibGljIG9ubHlPd25lciB7CiAgICByZXF1aXJlKG51bWJlckFmdGVyIDwgbWlsZXN0b25lcy5sZW5ndGgpOwoKICAgIHRvdGFsUGVyaW9kID0gdG90YWxQZXJpb2QuYWRkKHBlcmlvZCk7CgogICAgbWlsZXN0b25lcy5sZW5ndGgrKzsKCiAgICBmb3IgKHVpbnQgaSA9IG1pbGVzdG9uZXMubGVuZ3RoIC0gMjsgaSA+IG51bWJlckFmdGVyOyBpLS0pIHsKICAgICAgbWlsZXN0b25lc1tpICsgMV0gPSBtaWxlc3RvbmVzW2ldOwogICAgfQoKICAgIG1pbGVzdG9uZXNbbnVtYmVyQWZ0ZXIgKyAxXSA9IE1pbGVzdG9uZShwZXJpb2QsIGJvbnVzKTsKICB9CgogIGZ1bmN0aW9uIGNsZWFyTWlsZXN0b25lcygpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShtaWxlc3RvbmVzLmxlbmd0aCA+IDApOwogICAgZm9yICh1aW50IGkgPSAwOyBpIDwgbWlsZXN0b25lcy5sZW5ndGg7IGkrKykgewogICAgICBkZWxldGUgbWlsZXN0b25lc1tpXTsKICAgIH0KICAgIG1pbGVzdG9uZXMubGVuZ3RoIC09IG1pbGVzdG9uZXMubGVuZ3RoOwogICAgdG90YWxQZXJpb2QgPSAwOwogIH0KCiAgZnVuY3Rpb24gbGFzdFNhbGVEYXRlKHVpbnQgc3RhcnQpIHB1YmxpYyB2aWV3IHJldHVybnModWludCkgewogICAgcmV0dXJuIHN0YXJ0ICsgdG90YWxQZXJpb2QgKiAxIGRheXM7CiAgfQoKICBmdW5jdGlvbiBjdXJyZW50TWlsZXN0b25lKHVpbnQgc3RhcnQpIHB1YmxpYyB2aWV3IHJldHVybnModWludCkgewogICAgdWludCBwcmV2aW91c0RhdGUgPSBzdGFydDsKICAgIGZvcih1aW50IGk9MDsgaSA8IG1pbGVzdG9uZXMubGVuZ3RoOyBpKyspIHsKICAgICAgaWYobm93ID49IHByZXZpb3VzRGF0ZSAmJiBub3cgPCBwcmV2aW91c0RhdGUgKyBtaWxlc3RvbmVzW2ldLnBlcmlvZCAqIDEgZGF5cykgewogICAgICAgIHJldHVybiBpOwogICAgICB9CiAgICAgIHByZXZpb3VzRGF0ZSA9IHByZXZpb3VzRGF0ZS5hZGQobWlsZXN0b25lc1tpXS5wZXJpb2QgKiAxIGRheXMpOwogICAgfQogICAgcmV2ZXJ0KCk7CiAgfQoKfQoKY29udHJhY3QgQ29tbW9uU2FsZSBpcyBJbnZlc3RlZFByb3ZpZGVyLCBXYWxsZXRQcm92aWRlciwgUGVyY2VudFJhdGVQcm92aWRlciwgUmV0cmlldmVUb2tlbnNGZWF0dXJlIHsKCiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CgogIGFkZHJlc3MgcHVibGljIGRpcmVjdE1pbnRBZ2VudDsKCiAgdWludCBwdWJsaWMgcHJpY2U7CgogIHVpbnQgcHVibGljIHN0YXJ0OwoKICB1aW50IHB1YmxpYyBtaW5JbnZlc3RlZExpbWl0OwoKICBNaW50YWJsZVRva2VuIHB1YmxpYyB0b2tlbjsKCiAgdWludCBwdWJsaWMgaGFyZGNhcDsKCiAgbW9kaWZpZXIgaXNVbmRlckhhcmRjYXAoKSB7CiAgICByZXF1aXJlKGludmVzdGVkIDwgaGFyZGNhcCk7CiAgICBfOwogIH0KCiAgZnVuY3Rpb24gc2V0SGFyZGNhcCh1aW50IG5ld0hhcmRjYXApIHB1YmxpYyBvbmx5T3duZXIgewogICAgaGFyZGNhcCA9IG5ld0hhcmRjYXA7CiAgfQoKICBtb2RpZmllciBvbmx5RGlyZWN0TWludEFnZW50T3JPd25lcigpIHsKICAgIHJlcXVpcmUoZGlyZWN0TWludEFnZW50ID09IG1zZy5zZW5kZXIgfHwgb3duZXIgPT0gbXNnLnNlbmRlcik7CiAgICBfOwogIH0KCiAgbW9kaWZpZXIgbWluSW52ZXN0TGltaXRlZCh1aW50IHZhbHVlKSB7CiAgICByZXF1aXJlKHZhbHVlID49IG1pbkludmVzdGVkTGltaXQpOwogICAgXzsKICB9CgogIGZ1bmN0aW9uIHNldFN0YXJ0KHVpbnQgbmV3U3RhcnQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgc3RhcnQgPSBuZXdTdGFydDsKICB9CgogIGZ1bmN0aW9uIHNldE1pbkludmVzdGVkTGltaXQodWludCBuZXdNaW5JbnZlc3RlZExpbWl0KSBwdWJsaWMgb25seU93bmVyIHsKICAgIG1pbkludmVzdGVkTGltaXQgPSBuZXdNaW5JbnZlc3RlZExpbWl0OwogIH0KCiAgZnVuY3Rpb24gc2V0RGlyZWN0TWludEFnZW50KGFkZHJlc3MgbmV3RGlyZWN0TWludEFnZW50KSBwdWJsaWMgb25seU93bmVyIHsKICAgIGRpcmVjdE1pbnRBZ2VudCA9IG5ld0RpcmVjdE1pbnRBZ2VudDsKICB9CgogIGZ1bmN0aW9uIHNldFByaWNlKHVpbnQgbmV3UHJpY2UpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcHJpY2UgPSBuZXdQcmljZTsKICB9CgogIGZ1bmN0aW9uIHNldFRva2VuKGFkZHJlc3MgbmV3VG9rZW4pIHB1YmxpYyBvbmx5T3duZXIgewogICAgdG9rZW4gPSBNaW50YWJsZVRva2VuKG5ld1Rva2VuKTsKICB9CgogIGZ1bmN0aW9uIGNhbGN1bGF0ZVRva2Vucyh1aW50IF9pbnZlc3RlZCkgaW50ZXJuYWwgcmV0dXJucyh1aW50KTsKCiAgZnVuY3Rpb24gbWludFRva2Vuc0V4dGVybmFsKGFkZHJlc3MgdG8sIHVpbnQgdG9rZW5zKSBwdWJsaWMgb25seURpcmVjdE1pbnRBZ2VudE9yT3duZXIgewogICAgbWludFRva2Vucyh0bywgdG9rZW5zKTsKICB9CgogIGZ1bmN0aW9uIG1pbnRUb2tlbnMoYWRkcmVzcyB0bywgdWludCB0b2tlbnMpIGludGVybmFsIHsKICAgIHRva2VuLm1pbnQodGhpcywgdG9rZW5zKTsKICAgIHRva2VuLnRyYW5zZmVyKHRvLCB0b2tlbnMpOwogIH0KCiAgZnVuY3Rpb24gZW5kU2FsZURhdGUoKSBwdWJsaWMgdmlldyByZXR1cm5zKHVpbnQpOwoKICBmdW5jdGlvbiBtaW50VG9rZW5zQnlFVEhFeHRlcm5hbChhZGRyZXNzIHRvLCB1aW50IF9pbnZlc3RlZCkgcHVibGljIG9ubHlEaXJlY3RNaW50QWdlbnRPck93bmVyIHJldHVybnModWludCkgewogICAgcmV0dXJuIG1pbnRUb2tlbnNCeUVUSCh0bywgX2ludmVzdGVkKTsKICB9CgogIGZ1bmN0aW9uIG1pbnRUb2tlbnNCeUVUSChhZGRyZXNzIHRvLCB1aW50IF9pbnZlc3RlZCkgaW50ZXJuYWwgaXNVbmRlckhhcmRjYXAgcmV0dXJucyh1aW50KSB7CiAgICBpbnZlc3RlZCA9IGludmVzdGVkLmFkZChfaW52ZXN0ZWQpOwogICAgdWludCB0b2tlbnMgPSBjYWxjdWxhdGVUb2tlbnMoX2ludmVzdGVkKTsKICAgIG1pbnRUb2tlbnModG8sIHRva2Vucyk7CiAgICByZXR1cm4gdG9rZW5zOwogIH0KCiAgZnVuY3Rpb24gZmFsbGJhY2soKSBpbnRlcm5hbCBtaW5JbnZlc3RMaW1pdGVkKG1zZy52YWx1ZSkgcmV0dXJucyh1aW50KSB7CiAgICByZXF1aXJlKG5vdyA+PSBzdGFydCAmJiBub3cgPCBlbmRTYWxlRGF0ZSgpKTsKICAgIHdhbGxldC50cmFuc2Zlcihtc2cudmFsdWUpOwogICAgcmV0dXJuIG1pbnRUb2tlbnNCeUVUSChtc2cuc2VuZGVyLCBtc2cudmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gKCkgcHVibGljIHBheWFibGUgewogICAgZmFsbGJhY2soKTsKICB9Cgp9CgoKY29udHJhY3QgUmVmZXJlcnNSZXdhcmRGZWF0dXJlIGlzIElucHV0QWRkcmVzc0ZlYXR1cmUsIENvbW1vblNhbGUgewoKICB1aW50IHB1YmxpYyByZWZlcmVyUGVyY2VudDsKCiAgdWludCBwdWJsaWMgcmVmZXJhbHNNaW5JbnZlc3RMaW1pdDsKCiAgZnVuY3Rpb24gc2V0UmVmZXJhbHNNaW5JbnZlc3RMaW1pdCh1aW50IG5ld1JlZmVyZXJhbHNNaW5JbnZlc3RMaW1pdCkgcHVibGljIG9ubHlPd25lciB7CiAgICByZWZlcmFsc01pbkludmVzdExpbWl0ID0gbmV3UmVmZXJlcmFsc01pbkludmVzdExpbWl0OwogIH0KCiAgZnVuY3Rpb24gc2V0UmVmZXJlclBlcmNlbnQodWludCBuZXdSZWZlcmVyUGVyY2VudCkgcHVibGljIG9ubHlPd25lciB7CiAgICByZWZlcmVyUGVyY2VudCA9IG5ld1JlZmVyZXJQZXJjZW50OwogIH0KCiAgZnVuY3Rpb24gZmFsbGJhY2soKSBpbnRlcm5hbCByZXR1cm5zKHVpbnQpIHsKICAgIHVpbnQgdG9rZW5zID0gc3VwZXIuZmFsbGJhY2soKTsKICAgIGlmKG1zZy52YWx1ZSA+PSByZWZlcmFsc01pbkludmVzdExpbWl0KSB7CiAgICAgIGFkZHJlc3MgcmVmZXJlciA9IGdldElucHV0QWRkcmVzcygpOwogICAgICBpZihyZWZlcmVyICE9IGFkZHJlc3MoMCkpIHsKICAgICAgICByZXF1aXJlKHJlZmVyZXIgIT0gYWRkcmVzcyh0b2tlbikgJiYgcmVmZXJlciAhPSBtc2cuc2VuZGVyICYmIHJlZmVyZXIgIT0gYWRkcmVzcyh0aGlzKSk7CiAgICAgICAgbWludFRva2VucyhyZWZlcmVyLCB0b2tlbnMubXVsKHJlZmVyZXJQZXJjZW50KS5kaXYocGVyY2VudFJhdGUpKTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIHRva2VuczsKICB9Cgp9Cgpjb250cmFjdCBSZWZlcmVyc0NvbW1vblNhbGUgaXMgUmV0cmlldmVUb2tlbnNGZWF0dXJlLCBSZWZlcmVyc1Jld2FyZEZlYXR1cmUgewoKCn0KCgpjb250cmFjdCBBc3NlbWJsZWRDb21tb25TYWxlIGlzIFN0YWdlZENyb3dkc2FsZSwgUmVmZXJlcnNDb21tb25TYWxlIHsKCiAgZnVuY3Rpb24gY2FsY3VsYXRlVG9rZW5zKHVpbnQgX2ludmVzdGVkKSBpbnRlcm5hbCByZXR1cm5zKHVpbnQpIHsKICAgIHVpbnQgbWlsZXN0b25lSW5kZXggPSBjdXJyZW50TWlsZXN0b25lKHN0YXJ0KTsKICAgIE1pbGVzdG9uZSBzdG9yYWdlIG1pbGVzdG9uZSA9IG1pbGVzdG9uZXNbbWlsZXN0b25lSW5kZXhdOwogICAgdWludCB0b2tlbnMgPSBfaW52ZXN0ZWQubXVsKHByaWNlKS5kaXYoMSBldGhlcik7CiAgICBpZihtaWxlc3RvbmUuYm9udXMgPiAwKSB7CiAgICAgIHRva2VucyA9IHRva2Vucy5hZGQodG9rZW5zLm11bChtaWxlc3RvbmUuYm9udXMpLmRpdihwZXJjZW50UmF0ZSkpOwogICAgfQogICAgcmV0dXJuIHRva2VuczsKICB9CgogIGZ1bmN0aW9uIGVuZFNhbGVEYXRlKCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50KSB7CiAgICByZXR1cm4gbGFzdFNhbGVEYXRlKHN0YXJ0KTsKICB9Cgp9Cgpjb250cmFjdCBDYWxsYmFja1Rlc3QgaXMgUmVjZWl2aW5nQ29udHJhY3RDYWxsYmFjayB7CiAgCiAgYWRkcmVzcyBwdWJsaWMgZnJvbTsKICB1aW50IHB1YmxpYyB2YWx1ZTsKICAKICBmdW5jdGlvbiB0b2tlbkZhbGxiYWNrKGFkZHJlc3MgX2Zyb20sIHVpbnQgX3ZhbHVlKSBwdWJsaWMKICB7CiAgICBmcm9tID0gX2Zyb207CiAgICB2YWx1ZSA9IF92YWx1ZTsKICB9Cgp9Cgpjb250cmFjdCBTb2Z0Y2FwRmVhdHVyZSBpcyBJbnZlc3RlZFByb3ZpZGVyLCBXYWxsZXRQcm92aWRlciB7CgogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50OwoKICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgcHVibGljIGJhbGFuY2VzOwoKICBib29sIHB1YmxpYyBzb2Z0Y2FwQWNoaWV2ZWQ7CgogIGJvb2wgcHVibGljIHJlZnVuZE9uOwoKICB1aW50IHB1YmxpYyBzb2Z0Y2FwOwoKICB1aW50IHB1YmxpYyBjb25zdGFudCBkZXZMaW1pdCA9IDQ1MDAwMDAwMDAwMDAwMDAwMDA7CgogIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IGRldldhbGxldCA9IDB4RUExNUFkYjY2REM5MmE0QmJDY0M4QmYzMmZkMjVFMmU4NmEyQTc3MDsKCiAgZnVuY3Rpb24gc2V0U29mdGNhcCh1aW50IG5ld1NvZnRjYXApIHB1YmxpYyBvbmx5T3duZXIgewogICAgc29mdGNhcCA9IG5ld1NvZnRjYXA7CiAgfQoKICBmdW5jdGlvbiB3aXRoZHJhdygpIHB1YmxpYyB7CiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIgfHwgbXNnLnNlbmRlciA9PSBkZXZXYWxsZXQpOwogICAgcmVxdWlyZShzb2Z0Y2FwQWNoaWV2ZWQpOwogICAgZGV2V2FsbGV0LnRyYW5zZmVyKGRldkxpbWl0KTsKICAgIHdhbGxldC50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOwogIH0KCiAgZnVuY3Rpb24gdXBkYXRlQmFsYW5jZShhZGRyZXNzIHRvLCB1aW50IGFtb3VudCkgaW50ZXJuYWwgewogICAgYmFsYW5jZXNbdG9dID0gYmFsYW5jZXNbdG9dLmFkZChhbW91bnQpOwogICAgaWYgKCFzb2Z0Y2FwQWNoaWV2ZWQgJiYgaW52ZXN0ZWQgPj0gc29mdGNhcCkgewogICAgICBzb2Z0Y2FwQWNoaWV2ZWQgPSB0cnVlOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcmVmdW5kKCkgcHVibGljIHsKICAgIHJlcXVpcmUocmVmdW5kT24gJiYgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPiAwKTsKICAgIHVpbnQgdmFsdWUgPSBiYWxhbmNlc1ttc2cuc2VuZGVyXTsKICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gMDsKICAgIG1zZy5zZW5kZXIudHJhbnNmZXIodmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gdXBkYXRlUmVmdW5kU3RhdGUoKSBpbnRlcm5hbCByZXR1cm5zKGJvb2wpIHsKICAgIGlmICghc29mdGNhcEFjaGlldmVkKSB7CiAgICAgIHJlZnVuZE9uID0gdHJ1ZTsKICAgIH0KICAgIHJldHVybiByZWZ1bmRPbjsKICB9Cgp9CgoKCgpjb250cmFjdCBDb25maWd1cmF0b3IgaXMgT3duYWJsZSB7CgogIE1pbnRhYmxlVG9rZW4gcHVibGljIHRva2VuOwoKICBQcmVJVE8gcHVibGljIHByZUlUTzsKCiAgSVRPIHB1YmxpYyBpdG87CgogIGZ1bmN0aW9uIGRlcGxveSgpIHB1YmxpYyBvbmx5T3duZXIgewoKICAgIHRva2VuID0gbmV3IEdlc2VUb2tlbigpOwoKICAgIHByZUlUTyA9IG5ldyBQcmVJVE8oKTsKCiAgICBwcmVJVE8uc2V0V2FsbGV0KDB4YTg2NzgwMzgzRTM1RGUzMzA5MThEOGU0MTk1RDY3MTE0MEE2MEE3NCk7CiAgICBwcmVJVE8uc2V0U3RhcnQoMTUyNjM0MjQwMCk7CiAgICBwcmVJVE8uc2V0UGVyaW9kKDE1KTsKICAgIHByZUlUTy5zZXRQcmljZSg3ODY3MDApOwogICAgcHJlSVRPLnNldE1pbkludmVzdGVkTGltaXQoMTAwMDAwMDAwMDAwMDAwMDAwKTsKICAgIHByZUlUTy5zZXRIYXJkY2FwKDM4MTgwMDAwMDAwMDAwMDAwMDAwMDApOwogICAgcHJlSVRPLnNldFNvZnRjYXAoMzY0MDAwMDAwMDAwMDAwMDAwMDAwMCk7CiAgICBwcmVJVE8uc2V0UmVmZXJhbHNNaW5JbnZlc3RMaW1pdCgxMDAwMDAwMDAwMDAwMDAwMDApOwogICAgcHJlSVRPLnNldFJlZmVyZXJQZXJjZW50KDUpOwogICAgcHJlSVRPLnNldFRva2VuKHRva2VuKTsKCiAgICB0b2tlbi5zZXRTYWxlQWdlbnQocHJlSVRPKTsKCiAgICBpdG8gPSBuZXcgSVRPKCk7CgogICAgaXRvLnNldFdhbGxldCgweDk4ODgyRDE3NjIzNEFFYjczNmJiQkRCMTczYThEMjQ3OTRBM2IwODUpOwogICAgaXRvLnNldFN0YXJ0KDE1Mjc4MTEyMDApOwogICAgaXRvLmFkZE1pbGVzdG9uZSg1LCAzMyk7CiAgICBpdG8uYWRkTWlsZXN0b25lKDUsIDE4KTsKICAgIGl0by5hZGRNaWxlc3RvbmUoNSwgMTEpOwogICAgaXRvLmFkZE1pbGVzdG9uZSg1LCA1KTsKICAgIGl0by5hZGRNaWxlc3RvbmUoMTAsIDApOwogICAgaXRvLnNldFByaWNlKDU1MDAwMCk7CiAgICBpdG8uc2V0TWluSW52ZXN0ZWRMaW1pdCgxMDAwMDAwMDAwMDAwMDAwMDApOwogICAgaXRvLnNldEhhcmRjYXAoNDkwOTAwMDAwMDAwMDAwMDAwMDAwMDApOwogICAgaXRvLnNldEJvdW50eVRva2Vuc1dhbGxldCgweDI4NzMyZjZkYzEyNjA2RDUyOWEwMjBiOWFjMDRDOWQ2Zjg4MUQzYzUpOwogICAgaXRvLnNldEFkdmlzb3JzVG9rZW5zV2FsbGV0KDB4Mjg3MzJmNmRjMTI2MDZENTI5YTAyMGI5YWMwNEM5ZDZmODgxRDNjNSk7CiAgICBpdG8uc2V0VGVhbVRva2Vuc1dhbGxldCgweDI4NzMyZjZkYzEyNjA2RDUyOWEwMjBiOWFjMDRDOWQ2Zjg4MUQzYzUpOwogICAgaXRvLnNldFJlc2VydmVkVG9rZW5zV2FsbGV0KDB4Mjg3MzJmNmRjMTI2MDZENTI5YTAyMGI5YWMwNEM5ZDZmODgxRDNjNSk7CiAgICBpdG8uc2V0Qm91bnR5VG9rZW5zUGVyY2VudCg1KTsKICAgIGl0by5zZXRBZHZpc29yc1Rva2Vuc1BlcmNlbnQoMTApOwogICAgaXRvLnNldFRlYW1Ub2tlbnNQZXJjZW50KDEwKTsKICAgIGl0by5zZXRSZXNlcnZlZFRva2Vuc1BlcmNlbnQoMTApOwogICAgaXRvLnNldFJlZmVyYWxzTWluSW52ZXN0TGltaXQoMTAwMDAwMDAwMDAwMDAwMDAwKTsKICAgIGl0by5zZXRSZWZlcmVyUGVyY2VudCg1KTsKICAgIGl0by5zZXRUb2tlbih0b2tlbik7CgogICAgcHJlSVRPLnNldE5leHRTYWxlQWdlbnQoaXRvKTsKCiAgICBhZGRyZXNzIG1hbmFnZXIgPSAweDY3NWVERTI3Y2FmYzhCZDA3YkZDRGE2ZkVGNmFjMjUwMzFjNzQ3NjY7CgogICAgdG9rZW4udHJhbnNmZXJPd25lcnNoaXAobWFuYWdlcik7CiAgICBwcmVJVE8udHJhbnNmZXJPd25lcnNoaXAobWFuYWdlcik7CiAgICBpdG8udHJhbnNmZXJPd25lcnNoaXAobWFuYWdlcik7CiAgfQoKfQoKY29udHJhY3QgRVJDMjBDdXR0ZWQgewogICAgCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIAp9Cgpjb250cmFjdCBHZXNlVG9rZW4gaXMgTWludGFibGVUb2tlbiB7CgogIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJHZXNlIjsKCiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiR1NFIjsKCiAgdWludDMyIHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDI7CgogIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSAgcHVibGljIHJlZ2lzdGVyZWRDYWxsYmFja3M7CgogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJldHVybiBwcm9jZXNzQ2FsbGJhY2soc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpLCBtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHByb2Nlc3NDYWxsYmFjayhzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKSwgX2Zyb20sIF90bywgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIHJlZ2lzdGVyQ2FsbGJhY2soYWRkcmVzcyBjYWxsYmFjaykgcHVibGljIG9ubHlPd25lciB7CiAgICByZWdpc3RlcmVkQ2FsbGJhY2tzW2NhbGxiYWNrXSA9IHRydWU7CiAgfQoKICBmdW5jdGlvbiBkZXJlZ2lzdGVyQ2FsbGJhY2soYWRkcmVzcyBjYWxsYmFjaykgcHVibGljIG9ubHlPd25lciB7CiAgICByZWdpc3RlcmVkQ2FsbGJhY2tzW2NhbGxiYWNrXSA9IGZhbHNlOwogIH0KCiAgZnVuY3Rpb24gcHJvY2Vzc0NhbGxiYWNrKGJvb2wgcmVzdWx0LCBhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQgdmFsdWUpIGludGVybmFsIHJldHVybnMoYm9vbCkgewogICAgaWYgKHJlc3VsdCAmJiByZWdpc3RlcmVkQ2FsbGJhY2tzW3RvXSkgewogICAgICBSZWNlaXZpbmdDb250cmFjdENhbGxiYWNrIHRhcmdldENhbGxiYWNrID0gUmVjZWl2aW5nQ29udHJhY3RDYWxsYmFjayh0byk7CiAgICAgIHRhcmdldENhbGxiYWNrLnRva2VuRmFsbGJhY2soZnJvbSwgdmFsdWUpOwogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKICB9Cgp9Cgpjb250cmFjdCBJVE8gaXMgQXNzZW1ibGVkQ29tbW9uU2FsZSB7CgogIGFkZHJlc3MgcHVibGljIGJvdW50eVRva2Vuc1dhbGxldDsKCiAgYWRkcmVzcyBwdWJsaWMgYWR2aXNvcnNUb2tlbnNXYWxsZXQ7CiAgCiAgYWRkcmVzcyBwdWJsaWMgdGVhbVRva2Vuc1dhbGxldDsKCiAgYWRkcmVzcyBwdWJsaWMgcmVzZXJ2ZWRUb2tlbnNXYWxsZXQ7CgogIHVpbnQgcHVibGljIGJvdW50eVRva2Vuc1BlcmNlbnQ7CiAgCiAgdWludCBwdWJsaWMgYWR2aXNvcnNUb2tlbnNQZXJjZW50OwoKICB1aW50IHB1YmxpYyB0ZWFtVG9rZW5zUGVyY2VudDsKCiAgdWludCBwdWJsaWMgcmVzZXJ2ZWRUb2tlbnNQZXJjZW50OwoKICBmdW5jdGlvbiBzZXRCb3VudHlUb2tlbnNQZXJjZW50KHVpbnQgbmV3Qm91bnR5VG9rZW5zUGVyY2VudCkgcHVibGljIG9ubHlPd25lciB7CiAgICBib3VudHlUb2tlbnNQZXJjZW50ID0gbmV3Qm91bnR5VG9rZW5zUGVyY2VudDsKICB9CiAgCiAgZnVuY3Rpb24gc2V0QWR2aXNvcnNUb2tlbnNQZXJjZW50KHVpbnQgbmV3QWR2aXNvcnNUb2tlbnNQZXJjZW50KSBwdWJsaWMgb25seU93bmVyIHsKICAgIGFkdmlzb3JzVG9rZW5zUGVyY2VudCA9IG5ld0Fkdmlzb3JzVG9rZW5zUGVyY2VudDsKICB9CgogIGZ1bmN0aW9uIHNldFRlYW1Ub2tlbnNQZXJjZW50KHVpbnQgbmV3VGVhbVRva2Vuc1BlcmNlbnQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgdGVhbVRva2Vuc1BlcmNlbnQgPSBuZXdUZWFtVG9rZW5zUGVyY2VudDsKICB9CgogIGZ1bmN0aW9uIHNldFJlc2VydmVkVG9rZW5zUGVyY2VudCh1aW50IG5ld1Jlc2VydmVkVG9rZW5zUGVyY2VudCkgcHVibGljIG9ubHlPd25lciB7CiAgICByZXNlcnZlZFRva2Vuc1BlcmNlbnQgPSBuZXdSZXNlcnZlZFRva2Vuc1BlcmNlbnQ7CiAgfQoKICBmdW5jdGlvbiBzZXRCb3VudHlUb2tlbnNXYWxsZXQoYWRkcmVzcyBuZXdCb3VudHlUb2tlbnNXYWxsZXQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgYm91bnR5VG9rZW5zV2FsbGV0ID0gbmV3Qm91bnR5VG9rZW5zV2FsbGV0OwogIH0KCiAgZnVuY3Rpb24gc2V0QWR2aXNvcnNUb2tlbnNXYWxsZXQoYWRkcmVzcyBuZXdBZHZpc29yc1Rva2Vuc1dhbGxldCkgcHVibGljIG9ubHlPd25lciB7CiAgICBhZHZpc29yc1Rva2Vuc1dhbGxldCA9IG5ld0Fkdmlzb3JzVG9rZW5zV2FsbGV0OwogIH0KCiAgZnVuY3Rpb24gc2V0VGVhbVRva2Vuc1dhbGxldChhZGRyZXNzIG5ld1RlYW1Ub2tlbnNXYWxsZXQpIHB1YmxpYyBvbmx5T3duZXIgewogICAgdGVhbVRva2Vuc1dhbGxldCA9IG5ld1RlYW1Ub2tlbnNXYWxsZXQ7CiAgfQoKICBmdW5jdGlvbiBzZXRSZXNlcnZlZFRva2Vuc1dhbGxldChhZGRyZXNzIG5ld1Jlc2VydmVkVG9rZW5zV2FsbGV0KSBwdWJsaWMgb25seU93bmVyIHsKICAgIHJlc2VydmVkVG9rZW5zV2FsbGV0ID0gbmV3UmVzZXJ2ZWRUb2tlbnNXYWxsZXQ7CiAgfQoKICBmdW5jdGlvbiBmaW5pc2goKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHVpbnQgc3VtbWFyeVRva2Vuc1BlcmNlbnQgPSBib3VudHlUb2tlbnNQZXJjZW50LmFkZChhZHZpc29yc1Rva2Vuc1BlcmNlbnQpLmFkZCh0ZWFtVG9rZW5zUGVyY2VudCkuYWRkKHJlc2VydmVkVG9rZW5zUGVyY2VudCk7CiAgICB1aW50IG1pbnRlZFRva2VucyA9IHRva2VuLnRvdGFsU3VwcGx5KCk7CiAgICB1aW50IGFsbFRva2VucyA9IG1pbnRlZFRva2Vucy5tdWwocGVyY2VudFJhdGUpLmRpdihwZXJjZW50UmF0ZS5zdWIoc3VtbWFyeVRva2Vuc1BlcmNlbnQpKTsKICAgIHVpbnQgYWR2aXNvcnNUb2tlbnMgPSBhbGxUb2tlbnMubXVsKGFkdmlzb3JzVG9rZW5zUGVyY2VudCkuZGl2KHBlcmNlbnRSYXRlKTsKICAgIHVpbnQgYm91bnR5VG9rZW5zID0gYWxsVG9rZW5zLm11bChib3VudHlUb2tlbnNQZXJjZW50KS5kaXYocGVyY2VudFJhdGUpOwogICAgdWludCB0ZWFtVG9rZW5zID0gYWxsVG9rZW5zLm11bCh0ZWFtVG9rZW5zUGVyY2VudCkuZGl2KHBlcmNlbnRSYXRlKTsKICAgIHVpbnQgcmVzZXJ2ZWRUb2tlbnMgPSBhbGxUb2tlbnMubXVsKHJlc2VydmVkVG9rZW5zUGVyY2VudCkuZGl2KHBlcmNlbnRSYXRlKTsKICAgIG1pbnRUb2tlbnMoYWR2aXNvcnNUb2tlbnNXYWxsZXQsIGFkdmlzb3JzVG9rZW5zKTsKICAgIG1pbnRUb2tlbnMoYm91bnR5VG9rZW5zV2FsbGV0LCBib3VudHlUb2tlbnMpOwogICAgbWludFRva2Vucyh0ZWFtVG9rZW5zV2FsbGV0LCB0ZWFtVG9rZW5zKTsKICAgIG1pbnRUb2tlbnMocmVzZXJ2ZWRUb2tlbnNXYWxsZXQsIHJlc2VydmVkVG9rZW5zKTsKICAgIHRva2VuLmZpbmlzaE1pbnRpbmcoKTsKICB9Cgp9Cgpjb250cmFjdCBQcmVJVE8gaXMgTmV4dFNhbGVBZ2VudEZlYXR1cmUsIFNvZnRjYXBGZWF0dXJlLCBSZWZlcmVyc0NvbW1vblNhbGUgewoKICB1aW50IHB1YmxpYyBwZXJpb2Q7CgogIGZ1bmN0aW9uIGNhbGN1bGF0ZVRva2Vucyh1aW50IF9pbnZlc3RlZCkgaW50ZXJuYWwgcmV0dXJucyh1aW50KSB7CiAgICByZXR1cm4gX2ludmVzdGVkLm11bChwcmljZSkuZGl2KDEgZXRoZXIpOwogIH0KCiAgZnVuY3Rpb24gc2V0UGVyaW9kKHVpbnQgbmV3UGVyaW9kKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHBlcmlvZCA9IG5ld1BlcmlvZDsKICB9CgogIGZ1bmN0aW9uIGVuZFNhbGVEYXRlKCkgcHVibGljIHZpZXcgcmV0dXJucyh1aW50KSB7CiAgICByZXR1cm4gc3RhcnQuYWRkKHBlcmlvZCAqIDEgZGF5cyk7CiAgfQogIAogIGZ1bmN0aW9uIG1pbnRUb2tlbnNCeUVUSChhZGRyZXNzIHRvLCB1aW50IF9pbnZlc3RlZCkgaW50ZXJuYWwgcmV0dXJucyh1aW50KSB7CiAgICB1aW50IF90b2tlbnMgPSBzdXBlci5taW50VG9rZW5zQnlFVEgodG8sIF9pbnZlc3RlZCk7CiAgICB1cGRhdGVCYWxhbmNlKHRvLCBfaW52ZXN0ZWQpOwogICAgcmV0dXJuIF90b2tlbnM7CiAgfQoKICBmdW5jdGlvbiBmaW5pc2goKSBwdWJsaWMgb25seU93bmVyIHsKICAgIGlmICh1cGRhdGVSZWZ1bmRTdGF0ZSgpKSB7CiAgICAgIHRva2VuLmZpbmlzaE1pbnRpbmcoKTsKICAgIH0gZWxzZSB7CiAgICAgIHdpdGhkcmF3KCk7CiAgICAgIHRva2VuLnNldFNhbGVBZ2VudChuZXh0U2FsZUFnZW50KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGZhbGxiYWNrKCkgaW50ZXJuYWwgbWluSW52ZXN0TGltaXRlZChtc2cudmFsdWUpIHJldHVybnModWludCkgewogICAgcmVxdWlyZShub3cgPj0gc3RhcnQgJiYgbm93IDwgZW5kU2FsZURhdGUoKSk7CiAgICB1aW50IHRva2VucyA9IG1pbnRUb2tlbnNCeUVUSChtc2cuc2VuZGVyLCBtc2cudmFsdWUpOwogICAgaWYobXNnLnZhbHVlID49IHJlZmVyYWxzTWluSW52ZXN0TGltaXQpIHsKICAgICAgYWRkcmVzcyByZWZlcmVyID0gZ2V0SW5wdXRBZGRyZXNzKCk7CiAgICAgIGlmKHJlZmVyZXIgIT0gYWRkcmVzcygwKSkgewogICAgICAgIHJlcXVpcmUocmVmZXJlciAhPSBhZGRyZXNzKHRva2VuKSAmJiByZWZlcmVyICE9IG1zZy5zZW5kZXIgJiYgcmVmZXJlciAhPSBhZGRyZXNzKHRoaXMpKTsKICAgICAgICBtaW50VG9rZW5zKHJlZmVyZXIsIHRva2Vucy5tdWwocmVmZXJlclBlcmNlbnQpLmRpdihwZXJjZW50UmF0ZSkpOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gdG9rZW5zOwogIH0KCn0KCgpjb250cmFjdCBUZXN0Q29uZmlndXJhdG9yIGlzIE93bmFibGUgewogIEdlc2VUb2tlbiBwdWJsaWMgdG9rZW47CiAgUHJlSVRPIHB1YmxpYyBwcmVJVE87CiAgSVRPIHB1YmxpYyBpdG87CgogIGZ1bmN0aW9uIHNldFRva2VuKGFkZHJlc3MgX3Rva2VuKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHRva2VuID0gR2VzZVRva2VuKF90b2tlbik7CiAgfQoKICBmdW5jdGlvbiBzZXRQcmVJVE8oYWRkcmVzcyBfcHJlSVRPKSBwdWJsaWMgb25seU93bmVyIHsKICAgIHByZUlUTyA9IFByZUlUTyhfcHJlSVRPKTsKICB9CgogIGZ1bmN0aW9uIHNldElUTyhhZGRyZXNzIF9pdG8pIHB1YmxpYyBvbmx5T3duZXIgewogICAgaXRvID0gSVRPKF9pdG8pOwogIH0KCiAgZnVuY3Rpb24gZGVwbG95KCkgcHVibGljIG9ubHlPd25lciB7CiAgICBwcmVJVE8uc2V0V2FsbGV0KDB4RUExNUFkYjY2REM5MmE0QmJDY0M4QmYzMmZkMjVFMmU4NmEyQTc3MCk7CiAgICBwcmVJVE8uc2V0U3RhcnQoMTUyMjEwODgwMCk7CiAgICBwcmVJVE8uc2V0UGVyaW9kKDE1KTsKICAgIHByZUlUTy5zZXRQcmljZSg3ODY3MDApOwogICAgcHJlSVRPLnNldE1pbkludmVzdGVkTGltaXQoMTAwMDAwMDAwMDAwMDAwMDAwKTsKICAgIHByZUlUTy5zZXRIYXJkY2FwKDM4MTgwMDAwMDAwMDAwMDAwMDAwMDApOwogICAgcHJlSVRPLnNldFNvZnRjYXAoMzY0MDAwMDAwMDAwMDAwMDAwMDAwMCk7CiAgICBwcmVJVE8uc2V0UmVmZXJhbHNNaW5JbnZlc3RMaW1pdCgxMDAwMDAwMDAwMDAwMDAwMDApOwogICAgcHJlSVRPLnNldFJlZmVyZXJQZXJjZW50KDUpOwogICAgcHJlSVRPLnNldFRva2VuKHRva2VuKTsKCiAgICB0b2tlbi5zZXRTYWxlQWdlbnQocHJlSVRPKTsKICAgIHByZUlUTy5zZXROZXh0U2FsZUFnZW50KGl0byk7CgogICAgaXRvLnNldFN0YXJ0KDE1MjIxMDg4MDApOwogICAgaXRvLmFkZE1pbGVzdG9uZSg1LCAzMyk7CiAgICBpdG8uYWRkTWlsZXN0b25lKDUsIDE4KTsKICAgIGl0by5hZGRNaWxlc3RvbmUoNSwgMTEpOwogICAgaXRvLmFkZE1pbGVzdG9uZSg1LCA1KTsKICAgIGl0by5hZGRNaWxlc3RvbmUoMTAsIDApOwogICAgaXRvLnNldFByaWNlKDU1MDAwMCk7CiAgICBpdG8uc2V0TWluSW52ZXN0ZWRMaW1pdCgxMDAwMDAwMDAwMDAwMDAwMDApOwogICAgaXRvLnNldEhhcmRjYXAoNDkwOTAwMDAwMDAwMDAwMDAwMDAwMDApOwogICAgaXRvLnNldFdhbGxldCgweEVBMTVBZGI2NkRDOTJhNEJiQ2NDOEJmMzJmZDI1RTJlODZhMkE3NzApOwogICAgaXRvLnNldEJvdW50eVRva2Vuc1dhbGxldCgweEVBMTVBZGI2NkRDOTJhNEJiQ2NDOEJmMzJmZDI1RTJlODZhMkE3NzApOwogICAgaXRvLnNldEFkdmlzb3JzVG9rZW5zV2FsbGV0KDB4RUExNUFkYjY2REM5MmE0QmJDY0M4QmYzMmZkMjVFMmU4NmEyQTc3MCk7CiAgICBpdG8uc2V0VGVhbVRva2Vuc1dhbGxldCgweEVBMTVBZGI2NkRDOTJhNEJiQ2NDOEJmMzJmZDI1RTJlODZhMkE3NzApOwogICAgaXRvLnNldFJlc2VydmVkVG9rZW5zV2FsbGV0KDB4RUExNUFkYjY2REM5MmE0QmJDY0M4QmYzMmZkMjVFMmU4NmEyQTc3MCk7CiAgICBpdG8uc2V0Qm91bnR5VG9rZW5zUGVyY2VudCg1KTsKICAgIGl0by5zZXRBZHZpc29yc1Rva2Vuc1BlcmNlbnQoMTApOwogICAgaXRvLnNldFRlYW1Ub2tlbnNQZXJjZW50KDEwKTsKICAgIGl0by5zZXRSZXNlcnZlZFRva2Vuc1BlcmNlbnQoMTApOwogICAgaXRvLnNldFJlZmVyYWxzTWluSW52ZXN0TGltaXQoMTAwMDAwMDAwMDAwMDAwMDAwKTsKICAgIGl0by5zZXRSZWZlcmVyUGVyY2VudCg1KTsKICAgIGl0by5zZXRUb2tlbih0b2tlbik7CgogICAgdG9rZW4udHJhbnNmZXJPd25lcnNoaXAob3duZXIpOwogICAgcHJlSVRPLnRyYW5zZmVyT3duZXJzaGlwKG93bmVyKTsKICAgIGl0by50cmFuc2Zlck93bmVyc2hpcChvd25lcik7CiAgfQp9'.
	

]
