Class {
	#name : #SRT29aa20fB9b23421E310BDB8a7cfB81d7fbB4a1b3,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT29aa20fB9b23421E310BDB8a7cfB81d7fbB4a1b3 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSB7CiAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgfQoKCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgewogICAgaWYgKG5ld093bmVyICE9IGFkZHJlc3MoMCkpIHsKICAgICAgb3duZXIgPSBuZXdPd25lcjsKICAgIH0KICB9Cgp9CgoKLyoqCiAqIEB0aXRsZSBIZWxwcyBjb250cmFjdHMgZ3VhcmQgYWdhaW5zIHJlbnRyYW5jeSBhdHRhY2tzLgogKiBAYXV0aG9yIFJlbWNvIEJsb2VtZW4gPDxzcGFuIGNsYXNzPSJfX2NmX2VtYWlsX18iIGRhdGEtY2ZlbWFpbD0iOTVlN2YwZjhmNmZhZDVhNyI+W2VtYWlsJiMxNjA7cHJvdGVjdGVkXTwvc3Bhbj7PgC5jb20+CiAqIEBub3RpY2UgSWYgeW91IG1hcmsgYSBmdW5jdGlvbiBgbm9uUmVlbnRyYW50YCwgeW91IHNob3VsZCBhbHNvCiAqIG1hcmsgaXQgYGV4dGVybmFsYC4KICovCmNvbnRyYWN0IFJlZW50cmFuY3lHdWFyZCB7CgogIC8qKgogICAqIEBkZXYgV2UgdXNlIGEgc2luZ2xlIGxvY2sgZm9yIHRoZSB3aG9sZSBjb250cmFjdC4KICAgKi8KICBib29sIHByaXZhdGUgcmVudHJhbmN5X2xvY2sgPSBmYWxzZTsKCiAgLyoqCiAgICogQGRldiBQcmV2ZW50cyBhIGNvbnRyYWN0IGZyb20gY2FsbGluZyBpdHNlbGYsIGRpcmVjdGx5IG9yIGluZGlyZWN0bHkuCiAgICogQG5vdGljZSBJZiB5b3UgbWFyayBhIGZ1bmN0aW9uIGBub25SZWVudHJhbnRgLCB5b3Ugc2hvdWxkIGFsc28KICAgKiBtYXJrIGl0IGBleHRlcm5hbGAuIENhbGxpbmcgb25lIG5vblJlZW50cmFudCBmdW5jdGlvbiBmcm9tCiAgICogYW5vdGhlciBpcyBub3Qgc3VwcG9ydGVkLiBJbnN0ZWFkLCB5b3UgY2FuIGltcGxlbWVudCBhCiAgICogYHByaXZhdGVgIGZ1bmN0aW9uIGRvaW5nIHRoZSBhY3R1YWwgd29yaywgYW5kIGEgYGV4dGVybmFsYAogICAqIHdyYXBwZXIgbWFya2VkIGFzIGBub25SZWVudHJhbnRgLgogICAqLwogIG1vZGlmaWVyIG5vblJlZW50cmFudCgpIHsKICAgIHJlcXVpcmUoIXJlbnRyYW5jeV9sb2NrKTsKICAgIHJlbnRyYW5jeV9sb2NrID0gdHJ1ZTsKICAgIF87CiAgICByZW50cmFuY3lfbG9jayA9IGZhbHNlOwogIH0KCn0KCgovLyBNaW5pbWFsIEJpdGNvaW5ldW0gaW50ZXJmYWNlIGZvciBwcm94eSBtaW5pbmcKY29udHJhY3QgQml0Y29pbmV1bUludGVyZmFjZSB7CiAgIGZ1bmN0aW9uIG1pbmUoKSBwYXlhYmxlOwogICBmdW5jdGlvbiBjbGFpbSh1aW50MjU2IF9ibG9ja051bWJlciwgYWRkcmVzcyBmb3JDcmVkaXRUbyk7CiAgIGZ1bmN0aW9uIGNoZWNrTWluaW5nQXR0ZW1wdCh1aW50MjU2IF9ibG9ja051bSwgYWRkcmVzcyBfc2VuZGVyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgIGZ1bmN0aW9uIGNoZWNrV2lubmluZyh1aW50MjU2IF9ibG9ja051bSkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKGJvb2wpOwogICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpOwogICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7CiAgIGZ1bmN0aW9uIGN1cnJlbnREaWZmaWN1bHR5V2VpKCkgY29uc3RhbnQgcHVibGljIHJldHVybnMgKHVpbnQyNTYpOwogICB9CgoKLy8gU2hhcmtwb29sIGlzIGEgcm9sbGluZyB3aW5kb3cgQml0Y29pbmV1bSBtaW5lcgovLyBTbWFydCBjb250cmFjdCBiYXNlZCB2aXJ0dWFsIG1pbmluZwovLyBodHRwOi8vd3d3LmJpdGNvaW5ldW0uY29tLwoKY29udHJhY3QgU2hhcmtQb29sIGlzIE93bmFibGUsIFJlZW50cmFuY3lHdWFyZCB7CgogICAgc3RyaW5nIGNvbnN0YW50IHB1YmxpYyBwb29sX25hbWUgPSAiU2hhcmtQb29sIDEwMCI7CgogICAgLy8gUGVyY2VudGFnZSBvZiBCVEUgcG9vbCB0YWtlcyBmb3Igb3BlcmF0aW9ucwogICAgdWludDI1NiBwdWJsaWMgcG9vbF9wZXJjZW50YWdlID0gMDsKCiAgICAvLyBMaW1pdGluZyB1c2VycyBiZWNhdXNlIG9mIGdhcyBsaW1pdHMKICAgIC8vIEkgd291bGQgbm90IGluY3JlYXNlIHRoaXMgdmFsdWUgaXQgY291bGQgbWFrZSB0aGUgcG9vbCB1bnN0YWJsZQogICAgdWludDI1NiBjb25zdGFudCBwdWJsaWMgbWF4X3VzZXJzID0gMTAwOwoKICAgIC8vIFRyYWNrIHRvdGFsIHVzZXJzIHRvIHN3aXRjaCB0byBkZWdyYWRlZCBjYXNlIHdoZW4gY29udHJhY3QgaXMgZnVsbAogICAgdWludDI1NiBwdWJsaWMgdG90YWxfdXNlcnMgPSAwOwoKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IGRpdmlzaWJsZV91bml0cyA9IDEwMDAwMDAwOwoKICAgIC8vIEhvdyBsb25nIHdpbGwgYSBwYXltZW50IGV2ZW50IG1pbmUgYmxvY2tzIGZvciB5b3UKICAgIHVpbnQyNTYgcHVibGljIGNvbnRyYWN0X3BlcmlvZCA9IDEwMDsKICAgIHVpbnQyNTYgcHVibGljIG1pbmVkX2Jsb2NrcyA9IDE7CiAgICB1aW50MjU2IHB1YmxpYyBjbGFpbWVkX2Jsb2NrcyA9IDE7CiAgICB1aW50MjU2IHB1YmxpYyBibG9ja0NyZWF0aW9uUmF0ZSA9IDA7CgogICAgQml0Y29pbmV1bUludGVyZmFjZSBiYXNlX2NvbnRyYWN0OwoKICAgIHN0cnVjdCB1c2VyIHsKICAgICAgICB1aW50MjU2IHN0YXJ0X2Jsb2NrOwogICAgICAgIHVpbnQyNTYgZW5kX2Jsb2NrOwogICAgICAgIHVpbnQyNTYgcHJvcG9ydGlvbmFsX2NvbnRyaWJ1dGlvbjsKICAgIH0KCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVzZXIpIHB1YmxpYyB1c2VyczsKICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gdWludDI1NikgcHVibGljIGF0dGVtcHRzOwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwogICAgdWludDhbXSBzbG90czsKICAgIGFkZHJlc3NbMjU2XSBwdWJsaWMgYWN0aXZlX3VzZXJzOyAvLyBTaG91bGQgZXF1YWwgbWF4X3VzZXJzCgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgICB9CgogICAgZnVuY3Rpb24gc2V0X3Bvb2xfcGVyY2VudGFnZSh1aW50OCBfcGVyY2VudGFnZSkgZXh0ZXJuYWwgbm9uUmVlbnRyYW50IG9ubHlPd25lciB7CiAgICAgICAvLyBKdXN0IGluIGNhc2Ugb3duZXIgaXMgY29tcHJvbWlzZWQKICAgICAgIHJlcXVpcmUoX3BlcmNlbnRhZ2UgPCA2KTsKICAgICAgIHBvb2xfcGVyY2VudGFnZSA9IF9wZXJjZW50YWdlOwogICAgfQoKCiAgICBmdW5jdGlvbiBmaW5kX2NvbnRyaWJ1dGlvbihhZGRyZXNzIF93aG8pIGNvbnN0YW50IGV4dGVybmFsIHJldHVybnMgKHVpbnQyNTYsIHVpbnQyNTYsIHVpbnQyNTYsIHVpbnQyNTYsIHVpbnQyNTYpIHsKICAgICAgaWYgKHVzZXJzW193aG9dLnN0YXJ0X2Jsb2NrID4gMCkgewogICAgICAgICB1c2VyIG1lbW9yeSB1ID0gdXNlcnNbX3dob107CiAgICAgICAgIHVpbnQyNTYgcmVtYWluaW5nX3BlcmlvZD0gMDsKICAgICAgICAgaWYgKHUuZW5kX2Jsb2NrID4gbWluZWRfYmxvY2tzKSB7CiAgICAgICAgICAgIHJlbWFpbmluZ19wZXJpb2QgPSB1LmVuZF9ibG9jayAtIG1pbmVkX2Jsb2NrczsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVtYWluaW5nX3BlcmlvZCA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgcmV0dXJuICh1LnN0YXJ0X2Jsb2NrLCB1LmVuZF9ibG9jaywKICAgICAgICAgICAgICAgICB1LnByb3BvcnRpb25hbF9jb250cmlidXRpb24sCiAgICAgICAgICAgICAgICAgdS5wcm9wb3J0aW9uYWxfY29udHJpYnV0aW9uICogY29udHJhY3RfcGVyaW9kLAogICAgICAgICAgICAgICAgIHUucHJvcG9ydGlvbmFsX2NvbnRyaWJ1dGlvbiAqIHJlbWFpbmluZ19wZXJpb2QpOwogICAgICB9CiAgICAgIHJldHVybiAoMCwwLDAsMCwwKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhbGxvY2F0ZV9zbG90KGFkZHJlc3MgX3dobykgaW50ZXJuYWwgewogICAgICAgaWYodG90YWxfdXNlcnMgPCBtYXhfdXNlcnMpIHsgCiAgICAgICAgICAgIC8vIEp1c3QgcHVzaCBpbnRvIGFjdGl2ZV91c2VycwogICAgICAgICAgICBhY3RpdmVfdXNlcnNbdG90YWxfdXNlcnNdID0gX3dobzsKICAgICAgICAgICAgdG90YWxfdXNlcnMgKz0gMTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIFRoZSBtYXhpbXVtIHVzZXJzIGhhdmUgYmVlbiByZWFjaGVkLCBjYW4gd2UgYWxsb2NhdGUgYSBmcmVlIHNwYWNlPwogICAgICAgICAgICBpZiAoc2xvdHMubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgICAgIC8vIFRoZXJlIGlzbid0IGFueSByb29tIGxlZnQKICAgICAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICB1aW50OCBsb2NhdGlvbiA9IHNsb3RzW3Nsb3RzLmxlbmd0aC0xXTsKICAgICAgICAgICAgICAgYWN0aXZlX3VzZXJzW2xvY2F0aW9uXSA9IF93aG87CiAgICAgICAgICAgICAgIGRlbGV0ZSBzbG90c1tzbG90cy5sZW5ndGgtMV07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgIH0KCiAgICAgZnVuY3Rpb24gZXh0ZXJuYWxfdG9faW50ZXJuYWxfYmxvY2tfbnVtYmVyKHVpbnQyNTYgX2V4dGVybmFsQmxvY2tOdW0pIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgLy8gYmxvY2tDcmVhdGlvblJhdGUgaXMgPiAwCiAgICAgICAgcmV0dXJuIF9leHRlcm5hbEJsb2NrTnVtIC8gYmxvY2tDcmVhdGlvblJhdGU7CiAgICAgfQoKICAgICBmdW5jdGlvbiBhdmFpbGFibGVfc2xvdHMoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgICAgIGlmICh0b3RhbF91c2VycyA8IG1heF91c2VycykgewogICAgICAgICAgICByZXR1cm4gbWF4X3VzZXJzIC0gdG90YWxfdXNlcnM7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBzbG90cy5sZW5ndGg7CiAgICAgICAgfQogICAgIH0KICAKICAgZXZlbnQgTG9nRXZlbnQoCiAgICAgICB1aW50MjU2IF9pbmZvCiAgICk7CgogICAgZnVuY3Rpb24gZ2V0X2JpdGNvaW5ldW1fY29udHJhY3RfYWRkcmVzcygpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzKSB7CiAgICAgICByZXR1cm4gMHg3M2REMDY5YzI5OUE1ZDY5MUU5ODM2MjQzQmNhZUM5YzhDMUQ4NzM0OyAvLyBQcm9kdWN0aW9uCiAgICAKICAgICAgIC8vIHJldHVybiAweDdlN2EyOTlkYTM0YTM1MGQwNGQyMDRjZDgwYWI1MWQwNjhhZDUzMGY7IC8vIFRlc3RpbmcKICAgIH0KCiAgICAvLyBpdGVyYXRlIG92ZXIgYWxsIGFjY291bnQgaG9sZGVycwogICAgLy8gYW5kIGJhbGFuY2UgdHJhbnNmZXIgcHJvcG9ydGlvbmFsIGJ0ZQogICAgLy8gYmFsYW5jZSBzaG91bGQgYmUgMCBhZnR3YXJkcyBpbiBhIHBlcmZlY3Qgd29ybGQKICAgIGZ1bmN0aW9uIGRpc3RyaWJ1dGVfcmV3YXJkKHVpbnQyNTYgX3RvdGFsQXR0ZW1wdCwgdWludDI1NiBfYmFsYW5jZSkgaW50ZXJuYWwgewogICAgICB1aW50MjU2IHJlbWFpbmluZ19iYWxhbmNlID0gX2JhbGFuY2U7CiAgICAgIGZvciAodWludDggaSA9IDA7IGkgPCB0b3RhbF91c2VyczsgaSsrKSB7CiAgICAgICAgICBhZGRyZXNzIHVzZXJfYWRkcmVzcyA9IGFjdGl2ZV91c2Vyc1tpXTsKICAgICAgICAgIGlmICh1c2VyX2FkZHJlc3MgPiAwICYmIHJlbWFpbmluZ19iYWxhbmNlICE9IDApIHsKICAgICAgICAgICAgICB1aW50MjU2IHByb3BvcnRpb24gPSB1c2Vyc1t1c2VyX2FkZHJlc3NdLnByb3BvcnRpb25hbF9jb250cmlidXRpb247CiAgICAgICAgICAgICAgdWludDI1NiBkaXZpZGVkX3BvcnRpb24gPSAocHJvcG9ydGlvbiAqIGRpdmlzaWJsZV91bml0cykgLyBfdG90YWxBdHRlbXB0OwogICAgICAgICAgICAgIHVpbnQyNTYgcGF5b3V0ID0gKF9iYWxhbmNlICogZGl2aWRlZF9wb3J0aW9uKSAvIGRpdmlzaWJsZV91bml0czsKICAgICAgICAgICAgICBpZiAocGF5b3V0ID4gcmVtYWluaW5nX2JhbGFuY2UpIHsKICAgICAgICAgICAgICAgICBwYXlvdXQgPSByZW1haW5pbmdfYmFsYW5jZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgYmFsYW5jZXNbdXNlcl9hZGRyZXNzXSA9IGJhbGFuY2VzW3VzZXJfYWRkcmVzc10gKyBwYXlvdXQ7CiAgICAgICAgICAgICAgcmVtYWluaW5nX2JhbGFuY2UgPSByZW1haW5pbmdfYmFsYW5jZSAtIHBheW91dDsKICAgICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIFNoYXJrUG9vbCgpIHsKICAgICAgYmxvY2tDcmVhdGlvblJhdGUgPSA1MDsgLy8gbWF0Y2ggYnRlCiAgICAgIGJhc2VfY29udHJhY3QgPSBCaXRjb2luZXVtSW50ZXJmYWNlKGdldF9iaXRjb2luZXVtX2NvbnRyYWN0X2FkZHJlc3MoKSk7CiAgICB9CgogICAgZnVuY3Rpb24gY3VycmVudF9leHRlcm5hbF9ibG9jaygpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIGJsb2NrLm51bWJlcjsKICAgIH0KCgogICAgZnVuY3Rpb24gY2FsY3VsYXRlX21pbmltdW1fY29udHJpYnV0aW9uKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpICB7CiAgICAgICByZXR1cm4gYmFzZV9jb250cmFjdC5jdXJyZW50RGlmZmljdWx0eVdlaSgpIC8gMTAwMDAwMDAgKiBjb250cmFjdF9wZXJpb2Q7CiAgICB9CgogICAgLy8gQSBkZWZhdWx0IGV0aGVyIHR4IHdpdGhvdXQgZ2FzIHNwZWNpZmllZCB3aWxsIGZhaWwuCiAgICBmdW5jdGlvbiAoKSBwYXlhYmxlIHsKICAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPj0gY2FsY3VsYXRlX21pbmltdW1fY29udHJpYnV0aW9uKCkpOwoKICAgICAgICAgLy8gRGlkIHRoZSB1c2VyIGFscmVhZHkgY29udHJpYnV0ZQogICAgICAgICB1c2VyIHN0b3JhZ2UgY3VycmVudF91c2VyID0gdXNlcnNbbXNnLnNlbmRlcl07CgogICAgICAgICAvLyBEb2VzIHVzZXIgZXhpc3QgYWxyZWFkeQogICAgICAgICBpZiAoY3VycmVudF91c2VyLnN0YXJ0X2Jsb2NrID4gMCkgewogICAgICAgICAgICBpZiAoY3VycmVudF91c2VyLmVuZF9ibG9jayA+IG1pbmVkX2Jsb2NrcykgewogICAgICAgICAgICAgICAgdWludDI1NiBwZXJpb2RzX2xlZnQgPSBjdXJyZW50X3VzZXIuZW5kX2Jsb2NrIC0gbWluZWRfYmxvY2tzOwogICAgICAgICAgICAgICAgdWludDI1NiBhbW91bnRfcmVtYWluaW5nID0gY3VycmVudF91c2VyLnByb3BvcnRpb25hbF9jb250cmlidXRpb24gKiBwZXJpb2RzX2xlZnQ7CiAgICAgICAgICAgICAgICBhbW91bnRfcmVtYWluaW5nID0gYW1vdW50X3JlbWFpbmluZyArIG1zZy52YWx1ZTsKICAgICAgICAgICAgICAgIGFtb3VudF9yZW1haW5pbmcgPSBhbW91bnRfcmVtYWluaW5nIC8gY29udHJhY3RfcGVyaW9kOwogICAgICAgICAgICAgICAgY3VycmVudF91c2VyLnByb3BvcnRpb25hbF9jb250cmlidXRpb24gPSBhbW91bnRfcmVtYWluaW5nOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICBjdXJyZW50X3VzZXIucHJvcG9ydGlvbmFsX2NvbnRyaWJ1dGlvbiA9IG1zZy52YWx1ZSAvIGNvbnRyYWN0X3BlcmlvZDsKICAgICAgICAgICAgfQoKICAgICAgICAgIC8vIElmIHRoZSB1c2VyIGV4aXN0cyBhbmQgaGFzIGEgYmFsYW5jZSBsZXQncyB0cmFuc2ZlciBpdCB0byB0aGVtCiAgICAgICAgICBkb19yZWRlbXB0aW9uKCk7CgogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgY3VycmVudF91c2VyLnByb3BvcnRpb25hbF9jb250cmlidXRpb24gPSBtc2cudmFsdWUgLyBjb250cmFjdF9wZXJpb2Q7CiAgICAgICAgICAgICAgIGFsbG9jYXRlX3Nsb3QobXNnLnNlbmRlcik7CiAgICAgICAgICB9CiAgICAgICAgICBjdXJyZW50X3VzZXIuc3RhcnRfYmxvY2sgPSBtaW5lZF9ibG9ja3M7CiAgICAgICAgICBjdXJyZW50X3VzZXIuZW5kX2Jsb2NrID0gbWluZWRfYmxvY2tzICsgY29udHJhY3RfcGVyaW9kOwogICAgICAgICB9CgogICAgCiAgICAvLyBQcm94eSBtaW5pbmcgdG8gdG9rZW4KICAgZnVuY3Rpb24gbWluZSgpIGV4dGVybmFsIG5vblJlZW50cmFudAogICB7CiAgICAgLy8gRGlkIHNvbWVvbmUgYWxyZWFkeSB0cnkgdG8gbWluZSB0aGlzIGJsb2NrPwogICAgIHVpbnQyNTYgX2Jsb2NrTnVtID0gZXh0ZXJuYWxfdG9faW50ZXJuYWxfYmxvY2tfbnVtYmVyKGN1cnJlbnRfZXh0ZXJuYWxfYmxvY2soKSk7CiAgICAgcmVxdWlyZSghYmFzZV9jb250cmFjdC5jaGVja01pbmluZ0F0dGVtcHQoX2Jsb2NrTnVtLCB0aGlzKSk7CgogICAgIC8vIEFscmlnaHQgbm9ib2R5IG1pbmVkIGxldHMgaXRlcmF0ZSBvdmVyIG91ciBhY3RpdmVfdXNlcnMKCiAgICAgdWludDI1NiB0b3RhbF9hdHRlbXB0ID0gMDsKICAgICB1aW50OCB0b3RhbF9lamVjdGVkID0gMDsgCgogICAgIGZvciAodWludDggaT0wOyBpIDwgdG90YWxfdXNlcnM7IGkrKykgewogICAgICAgICBhZGRyZXNzIHVzZXJfYWRkcmVzcyA9IGFjdGl2ZV91c2Vyc1tpXTsKICAgICAgICAgaWYgKHVzZXJfYWRkcmVzcyA+IDApIHsKICAgICAgICAgICAgIC8vIFRoaXMgdXNlciBleGlzdHMKICAgICAgICAgICAgIHVzZXIgbWVtb3J5IHUgPSB1c2Vyc1t1c2VyX2FkZHJlc3NdOwogICAgICAgICAgICAgaWYgKHUuZW5kX2Jsb2NrIDw9IG1pbmVkX2Jsb2NrcykgewogICAgICAgICAgICAgICAgLy8gVGhpcyB1c2VyIG5lZWRzIHRvIGJlIGVqZWN0ZWQsIG5vIG1vcmUgYXR0ZW1wdHMgbGVmdAogICAgICAgICAgICAgICAgLy8gYnV0IHdlIGxpbWl0IHRvIDIwIHRvIHByZXZlbnQgZ2FzIGlzc3VlcyBvbiBzbG90IGluc2VydAogICAgICAgICAgICAgICAgaWYgKHRvdGFsX2VqZWN0ZWQgPCAxMCkgewogICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBhY3RpdmVfdXNlcnNbaV07CiAgICAgICAgICAgICAgICAgICAgc2xvdHMucHVzaChpKTsKICAgICAgICAgICAgICAgICAgICBkZWxldGUgdXNlcnNbYWN0aXZlX3VzZXJzW2ldXTsKICAgICAgICAgICAgICAgICAgICB0b3RhbF9lamVjdGVkID0gdG90YWxfZWplY3RlZCArIDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAvLyBUaGlzIHVzZXIgaXMgc3RpbGwgYWN0aXZlCiAgICAgICAgICAgICAgIHRvdGFsX2F0dGVtcHQgPSB0b3RhbF9hdHRlbXB0ICsgdS5wcm9wb3J0aW9uYWxfY29udHJpYnV0aW9uOwogICAgICAgICAgICAgfQogICAgICAgICB9CiAgICAgfQogICAgIGlmICh0b3RhbF9hdHRlbXB0ID4gMCkgewogICAgICAgIC8vIE5vdyB3ZSBoYXZlIGEgdG90YWwgY29udHJpYnV0aW9uIGFtb3VudAogICAgICAgIGF0dGVtcHRzW19ibG9ja051bV0gPSB0b3RhbF9hdHRlbXB0OwogICAgICAgIGJhc2VfY29udHJhY3QubWluZS52YWx1ZSh0b3RhbF9hdHRlbXB0KSgpOwogICAgICAgIG1pbmVkX2Jsb2NrcyA9IG1pbmVkX2Jsb2NrcyArIDE7CiAgICAgfQogICB9CgogICBmdW5jdGlvbiBjbGFpbSh1aW50MjU2IF9ibG9ja051bWJlciwgYWRkcmVzcyBmb3JDcmVkaXRUbykKICAgICAgICAgICAgICAgICAgbm9uUmVlbnRyYW50CiAgICAgICAgICAgICAgICAgIGV4dGVybmFsIHJldHVybnMgKGJvb2wpIHsKICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgIC8vIERpZCB3ZSB3aW4gdGhlIGJsb2NrIGluIHF1ZXN0aW9uCiAgICAgICAgICAgICAgICAgIHJlcXVpcmUoYmFzZV9jb250cmFjdC5jaGVja1dpbm5pbmcoX2Jsb2NrTnVtYmVyKSk7CgogICAgICAgICAgICAgICAgICB1aW50MjU2IGluaXRpYWxfYmFsYW5jZSA9IGJhc2VfY29udHJhY3QuYmFsYW5jZU9mKHRoaXMpOwoKICAgICAgICAgICAgICAgICAgLy8gV2Ugd29uIGxldCdzIGdldCBvdXIgcmV3YXJkCiAgICAgICAgICAgICAgICAgIGJhc2VfY29udHJhY3QuY2xhaW0oX2Jsb2NrTnVtYmVyLCB0aGlzKTsKCiAgICAgICAgICAgICAgICAgIHVpbnQyNTYgYmFsYW5jZSA9IGJhc2VfY29udHJhY3QuYmFsYW5jZU9mKHRoaXMpOwogICAgICAgICAgICAgICAgICB1aW50MjU2IHRvdGFsX2F0dGVtcHQgPSBhdHRlbXB0c1tfYmxvY2tOdW1iZXJdOwoKICAgICAgICAgICAgICAgICAgZGlzdHJpYnV0ZV9yZXdhcmQodG90YWxfYXR0ZW1wdCwgYmFsYW5jZSAtIGluaXRpYWxfYmFsYW5jZSk7CiAgICAgICAgICAgICAgICAgIGNsYWltZWRfYmxvY2tzID0gY2xhaW1lZF9ibG9ja3MgKyAxOwogICAgICAgICAgICAgICAgICB9CgogICBmdW5jdGlvbiBkb19yZWRlbXB0aW9uKCkgaW50ZXJuYWwgewogICAgIHVpbnQyNTYgYmFsYW5jZSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdOwogICAgIGlmIChiYWxhbmNlID4gMCkgewogICAgICAgIHVpbnQyNTYgb3duZXJfY3V0ID0gKGJhbGFuY2UgLyAxMDApICogcG9vbF9wZXJjZW50YWdlOwogICAgICAgIHVpbnQyNTYgcmVtYWluZGVyID0gYmFsYW5jZSAtIG93bmVyX2N1dDsKICAgICAgICBpZiAob3duZXJfY3V0ID4gMCkgewogICAgICAgICAgICBiYXNlX2NvbnRyYWN0LnRyYW5zZmVyKG93bmVyLCBvd25lcl9jdXQpOwogICAgICAgIH0KICAgICAgICBiYXNlX2NvbnRyYWN0LnRyYW5zZmVyKG1zZy5zZW5kZXIsIHJlbWFpbmRlcik7CiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSAwOwogICAgfQogICB9CgogICBmdW5jdGlvbiByZWRlZW0oKSBleHRlcm5hbCBub25SZWVudHJhbnQKICAgICB7CiAgICAgICAgZG9fcmVkZW1wdGlvbigpOwogICAgIH0KCiAgIGZ1bmN0aW9uIGNoZWNrTWluaW5nQXR0ZW1wdCh1aW50MjU2IF9ibG9ja051bSwgYWRkcmVzcyBfc2VuZGVyKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICByZXR1cm4gYmFzZV9jb250cmFjdC5jaGVja01pbmluZ0F0dGVtcHQoX2Jsb2NrTnVtLCBfc2VuZGVyKTsKICAgfQogICAKICAgZnVuY3Rpb24gY2hlY2tXaW5uaW5nKHVpbnQyNTYgX2Jsb2NrTnVtKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgIHJldHVybiBiYXNlX2NvbnRyYWN0LmNoZWNrV2lubmluZyhfYmxvY2tOdW0pOwogICB9Cgp9'.
	

]
