Class {
	#name : #SRT4eb5f89549c4d7a57267340c13fcca1049b57f9e,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT4eb5f89549c4d7a57267340c13fcca1049b57f9e >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7CgoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoKICAgIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKCiAgICAvKioKICAgICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAgICogYWNjb3VudC4KICAgICAqLwogICAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB9CgoKICAgIC8qKgogICAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAgICovCiAgICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKCiAgICAvKioKICAgICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUobmV3T3duZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgICAgICBvd25lciA9IG5ld093bmVyOwogICAgfQoKfQoKY29udHJhY3QgdXNpbmdNeVdpc2hDb25zdHMgewogICAgdWludCBjb25zdGFudCBUT0tFTl9ERUNJTUFMUyA9IDE4OwogICAgdWludDggY29uc3RhbnQgVE9LRU5fREVDSU1BTFNfVUlOVDggPSAxODsKICAgIHVpbnQgY29uc3RhbnQgVE9LRU5fREVDSU1BTF9NVUxUSVBMSUVSID0gMTAgKiogVE9LRU5fREVDSU1BTFM7CgogICAgdWludCBjb25zdGFudCBURUFNX1RPS0VOUyA9ICAgMzE2MTIwMCAqIFRPS0VOX0RFQ0lNQUxfTVVMVElQTElFUjsKICAgIHVpbnQgY29uc3RhbnQgQk9VTlRZX1RPS0VOUyA9IDIwMDAwMDAgKiBUT0tFTl9ERUNJTUFMX01VTFRJUExJRVI7CiAgICB1aW50IGNvbnN0YW50IFBSRUlDT19UT0tFTlMgPSAzMDM4ODAwICogVE9LRU5fREVDSU1BTF9NVUxUSVBMSUVSOwogICAgdWludCBjb25zdGFudCBNSU5JTUFMX1BVUkNIQVNFID0gMC4wNSBldGhlcjsKCiAgICBhZGRyZXNzIGNvbnN0YW50IFRFQU1fQUREUkVTUyA9IDB4RTRGMEZmNDY0MWYzYzk5ZGUzNDJiMDZjMDY0MTRkOTRBNTg1ZUZmYjsKICAgIGFkZHJlc3MgY29uc3RhbnQgQk9VTlRZX0FERFJFU1MgPSAweDc2ZDQxMzZkNkVFNTNEQjRjYzA4N0YyRTI5OTAyODNkNTMxN0E1ZTk7CiAgICBhZGRyZXNzIGNvbnN0YW50IFBSRUlDT19BRERSRVNTID0gMHgxOTU2MTA4NTFBNDNFOTY4NTY0M0E4RjNiNDlGMEY4YTAxOTIwNGYxOwogICAgYWRkcmVzcyBjb25zdGFudCBDT0xEX1dBTExFVCA9IDB4ODA4MjZiNWI3MTdhRGQzRTg0MDM0MzM2NEVDOWQ5NzFGQmEzOTU1QzsKCiAgICBzdHJpbmcgY29uc3RhbnQgVE9LRU5fTkFNRSA9ICJNeVdpc2ggVG9rZW4iOwogICAgYnl0ZXMzMiBjb25zdGFudCBUT0tFTl9TWU1CT0wgPSAiV0lTSCI7Cn0KLyoqCiAqIEB0aXRsZSBTYWZlTWF0aAogKiBAZGV2IE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MgdGhhdCB0aHJvdyBvbiBlcnJvcgogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCi8qKgogKiBAdGl0bGUgRVJDMjBCYXNpYwogKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE3OQogKi8KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqLwpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sKTsKICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLiAKICovCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAgIC8qKgogICAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKDApKTsKCiAgICAgICAgLy8gU2FmZU1hdGguc3ViIHdpbGwgdGhyb3cgaWYgdGhlcmUgaXMgbm90IGVub3VnaCBiYWxhbmNlLgogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgogICAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAgICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAgICovCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogICAgfQoKfQoKLyoqCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbgogKgogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbAogKi8KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwoKCiAgICAvKioKICAgICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcgogICAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgICAqLwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwoKICAgICAgICB2YXIgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOwoKICAgICAgICAvLyBDaGVjayBpcyBub3QgbmVlZGVkIGJlY2F1c2Ugc3ViKF9hbGxvd2FuY2UsIF92YWx1ZSkgd2lsbCBhbHJlYWR5IHRocm93IGlmIHRoaXMgY29uZGl0aW9uIGlzIG5vdCBtZXQKICAgICAgICAvLyByZXF1aXJlIChfdmFsdWUgPD0gX2FsbG93YW5jZSk7CgogICAgICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQXBwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlaGFsZiBvZiBtc2cuc2VuZGVyLgogICAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgICAqLwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCkgewoKICAgICAgICAvLyBUbyBjaGFuZ2UgdGhlIGFwcHJvdmUgYW1vdW50IHlvdSBmaXJzdCBoYXZlIHRvIHJlZHVjZSB0aGUgYWRkcmVzc2VzYAogICAgICAgIC8vICBhbGxvd2FuY2UgdG8gemVybyBieSBjYWxsaW5nIGBhcHByb3ZlKF9zcGVuZGVyLCAwKWAgaWYgaXQgaXMgbm90CiAgICAgICAgLy8gIGFscmVhZHkgMCB0byBtaXRpZ2F0ZSB0aGUgcmFjZSBjb25kaXRpb24gZGVzY3JpYmVkIGhlcmU6CiAgICAgICAgLy8gIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICAgICAgcmVxdWlyZSgoX3ZhbHVlID09IDApIHx8IChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9PSAwKSk7CgogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZ5aW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlsYWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsKICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICAgIH0KCiAgICAvKioKICAgICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAogICAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICAgKi8KICAgIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgICAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgICAgIH0KICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKfQoKLyoqCiAqIEB0aXRsZSBNaW50YWJsZSB0b2tlbgogKiBAZGV2IFNpbXBsZSBFUkMyMCBUb2tlbiBleGFtcGxlLCB3aXRoIG1pbnRhYmxlIHRva2VuIGNyZWF0aW9uCiAqIEBkZXYgSXNzdWU6ICogaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXBwZWxpbi1zb2xpZGl0eS9pc3N1ZXMvMTIwCiAqIEJhc2VkIG9uIGNvZGUgYnkgVG9rZW5NYXJrZXROZXQ6IGh0dHBzOi8vZ2l0aHViLmNvbS9Ub2tlbk1hcmtldE5ldC9pY28vYmxvYi9tYXN0ZXIvY29udHJhY3RzL01pbnRhYmxlVG9rZW4uc29sCiAqLwoKY29udHJhY3QgTWludGFibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKICAgIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGFtb3VudCk7CgogICAgZXZlbnQgTWludEZpbmlzaGVkKCk7CgogICAgYm9vbCBwdWJsaWMgbWludGluZ0ZpbmlzaGVkID0gZmFsc2U7CgoKICAgIG1vZGlmaWVyIGNhbk1pbnQoKSB7CiAgICAgICAgcmVxdWlyZSghbWludGluZ0ZpbmlzaGVkKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBGdW5jdGlvbiB0byBtaW50IHRva2VucwogICAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgbWludGVkIHRva2Vucy4KICAgICAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIG1pbnQuCiAgICAgKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAgICovCiAgICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIG9ubHlPd25lciBjYW5NaW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfYW1vdW50KTsKICAgICAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7CiAgICAgICAgTWludChfdG8sIF9hbW91bnQpOwogICAgICAgIFRyYW5zZmVyKDB4MCwgX3RvLCBfYW1vdW50KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgRnVuY3Rpb24gdG8gc3RvcCBtaW50aW5nIG5ldyB0b2tlbnMuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgICAqLwogICAgZnVuY3Rpb24gZmluaXNoTWludGluZygpIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICAgICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgICAgICBNaW50RmluaXNoZWQoKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQoKLyoqCiAqIEB0aXRsZSBCdXJuYWJsZSBUb2tlbgogKiBAZGV2IFRva2VuIHRoYXQgY2FuIGJlIGlycmV2ZXJzaWJseSBidXJuZWQgKGRlc3Ryb3llZCkuCiAqLwpjb250cmFjdCBCdXJuYWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4gewoKICAgIGV2ZW50IEJ1cm4oYWRkcmVzcyBpbmRleGVkIGJ1cm5lciwgdWludDI1NiB2YWx1ZSk7CgogICAgLyoqCiAgICAgKiBAZGV2IEJ1cm5zIGEgc3BlY2lmaWMgYW1vdW50IG9mIHRva2Vucy4KICAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbiB0byBiZSBidXJuZWQuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJ1cm4odWludDI1NiBfdmFsdWUpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPiAwKTsKCiAgICAgICAgYWRkcmVzcyBidXJuZXIgPSBtc2cuc2VuZGVyOwogICAgICAgIGJhbGFuY2VzW2J1cm5lcl0gPSBiYWxhbmNlc1tidXJuZXJdLnN1YihfdmFsdWUpOwogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuc3ViKF92YWx1ZSk7CiAgICAgICAgQnVybihidXJuZXIsIF92YWx1ZSk7CiAgICB9Cn0KCmNvbnRyYWN0IE15V2lzaFRva2VuIGlzIHVzaW5nTXlXaXNoQ29uc3RzLCBNaW50YWJsZVRva2VuLCBCdXJuYWJsZVRva2VuIHsKICAgIC8qKgogICAgICogQGRldiBQYXVzZSB0b2tlbiB0cmFuc2Zlci4gQWZ0ZXIgc3VjY2Vzc2Z1bGx5IGZpbmlzaGVkIGNyb3dkc2FsZSBpdCBiZWNvbWVzIHRydWUuCiAgICAgKi8KICAgIGJvb2wgcHVibGljIHBhdXNlZCA9IHRydWU7CiAgICAvKioKICAgICAqIEBkZXYgQWNjb3VudHMgd2hvIGNhbiB0cmFuc2ZlciB0b2tlbiBldmVuIGlmIHBhdXNlZC4gV29ya3Mgb25seSBkdXJpbmcgY3Jvd2RzYWxlLgogICAgICovCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgZXhjbHVkZWQ7CgogICAgZnVuY3Rpb24gbmFtZSgpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zIChzdHJpbmcgX25hbWUpIHsKICAgICAgICByZXR1cm4gVE9LRU5fTkFNRTsKICAgIH0KCiAgICBmdW5jdGlvbiBzeW1ib2woKSBjb25zdGFudCBwdWJsaWMgcmV0dXJucyAoYnl0ZXMzMiBfc3ltYm9sKSB7CiAgICAgICAgcmV0dXJuIFRPS0VOX1NZTUJPTDsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWNpbWFscygpIGNvbnN0YW50IHB1YmxpYyByZXR1cm5zICh1aW50OCBfZGVjaW1hbHMpIHsKICAgICAgICByZXR1cm4gVE9LRU5fREVDSU1BTFNfVUlOVDg7CiAgICB9CgogICAgZnVuY3Rpb24gY3Jvd2RzYWxlRmluaXNoZWQoKSBvbmx5T3duZXIgewogICAgICAgIHBhdXNlZCA9IGZhbHNlOwogICAgICAgIGZpbmlzaE1pbnRpbmcoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRFeGNsdWRlZChhZGRyZXNzIF90b0V4Y2x1ZGUpIG9ubHlPd25lciB7CiAgICAgICAgZXhjbHVkZWRbX3RvRXhjbHVkZV0gPSB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKCFwYXVzZWQgfHwgZXhjbHVkZWRbX2Zyb21dKTsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmVxdWlyZSghcGF1c2VkIHx8IGV4Y2x1ZGVkW21zZy5zZW5kZXJdKTsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBCdXJuIHRva2VucyBmcm9tIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAgICAqIEBwYXJhbSBfZnJvbSAgICAgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBidXJuIHRva2VucyBmcm9tLgogICAgICogQHBhcmFtIF92YWx1ZSAgICB1aW50ICAgIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIGJ1cm5lZC4KICAgICAqLwogICAgZnVuY3Rpb24gYnVybkZyb20oYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXF1aXJlKF92YWx1ZSA+IDApOwogICAgICAgIHZhciBhbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsKICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5zdWIoX3ZhbHVlKTsKICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IGFsbG93YW5jZS5zdWIoX3ZhbHVlKTsKICAgICAgICBCdXJuKF9mcm9tLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9CmNvbnRyYWN0IE15V2lzaFJhdGVQcm92aWRlckkgewogICAgLyoqCiAgICAgKiBAZGV2IENhbGN1bGF0ZSBhY3R1YWwgcmF0ZSB1c2luZyB0aGUgc3BlY2lmaWVkIHBhcmFtZXRlcnMuCiAgICAgKiBAcGFyYW0gYnV5ZXIgICAgIEludmVzdG9yIChidXllcikgYWRkcmVzcy4KICAgICAqIEBwYXJhbSB0b3RhbFNvbGQgQW1vdW50IG9mIHNvbGQgdG9rZW5zLgogICAgICogQHBhcmFtIGFtb3VudFdlaSBBbW91bnQgb2Ygd2VpIHRvIHB1cmNoYXNlLgogICAgICogQHJldHVybiBFVEggdG8gVG9rZW4gcmF0ZS4KICAgICAqLwogICAgZnVuY3Rpb24gZ2V0UmF0ZShhZGRyZXNzIGJ1eWVyLCB1aW50IHRvdGFsU29sZCwgdWludCBhbW91bnRXZWkpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KTsKCiAgICAvKioKICAgICAqIEBkZXYgcmF0ZSBzY2FsZSAob3IgZGl2aWRlciksIHRvIHN1cHBvcnQgbm90IGludGVnZXIgcmF0ZXMuCiAgICAgKiBAcmV0dXJuIFJhdGUgZGl2aWRlci4KICAgICAqLwogICAgZnVuY3Rpb24gZ2V0UmF0ZVNjYWxlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOwoKICAgIC8qKgogICAgICogQHJldHVybiBBYnNvbHV0ZSBiYXNlIHJhdGUuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldEJhc2VSYXRlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOwp9Cgpjb250cmFjdCBNeVdpc2hSYXRlUHJvdmlkZXIgaXMgdXNpbmdNeVdpc2hDb25zdHMsIE15V2lzaFJhdGVQcm92aWRlckksIE93bmFibGUgewogICAgLy8gcmF0ZSBjYWxjdWxhdGUgYWNjdXJhY3kKICAgIHVpbnQgY29uc3RhbnQgUkFURV9TQ0FMRSA9IDEwMDAwOwogICAgdWludCBjb25zdGFudCBTVEVQXzMwID0gMzIwMDAwMCAqIFRPS0VOX0RFQ0lNQUxfTVVMVElQTElFUjsKICAgIHVpbnQgY29uc3RhbnQgU1RFUF8yMCA9IDY0MDAwMDAgKiBUT0tFTl9ERUNJTUFMX01VTFRJUExJRVI7CiAgICB1aW50IGNvbnN0YW50IFNURVBfMTAgPSA5NjAwMDAwICogVE9LRU5fREVDSU1BTF9NVUxUSVBMSUVSOwogICAgdWludCBjb25zdGFudCBSQVRFXzMwID0gMTk1MCAqIFJBVEVfU0NBTEU7CiAgICB1aW50IGNvbnN0YW50IFJBVEVfMjAgPSAxODAwICogUkFURV9TQ0FMRTsKICAgIHVpbnQgY29uc3RhbnQgUkFURV8xMCA9IDE2NTAgKiBSQVRFX1NDQUxFOwogICAgdWludCBjb25zdGFudCBCQVNFX1JBVEUgPSAxNTAwICogUkFURV9TQ0FMRTsKCiAgICBzdHJ1Y3QgRXhjbHVzaXZlUmF0ZSB7CiAgICAgICAgLy8gYmUgY2FyZWZ1bCwgYWNjdXJhY2llcyB0aGlzIGFib3V0IDE1IG1pbnV0ZXMKICAgICAgICB1aW50MzIgd29ya1VudGlsOwogICAgICAgIC8vIGV4Y2x1c2l2ZSByYXRlIG9yIDAKICAgICAgICB1aW50IHJhdGU7CiAgICAgICAgLy8gcmF0ZSBib251cyBwZXJjZW50LCB3aGljaCB3aWxsIGJlIGRpdmlkZWQgYnkgMTAwMCBvciAwCiAgICAgICAgdWludDE2IGJvbnVzUGVyY2VudDEwMDA7CiAgICAgICAgLy8gZmxhZyB0byBjaGVjaywgdGhhdCByZWNvcmQgZXhpc3RzCiAgICAgICAgYm9vbCBleGlzdHM7CiAgICB9CgogICAgbWFwcGluZyhhZGRyZXNzID0+IEV4Y2x1c2l2ZVJhdGUpIGV4Y2x1c2l2ZVJhdGU7CgogICAgZnVuY3Rpb24gZ2V0UmF0ZVNjYWxlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gUkFURV9TQ0FMRTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRCYXNlUmF0ZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIEJBU0VfUkFURTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRSYXRlKGFkZHJlc3MgYnV5ZXIsIHVpbnQgdG90YWxTb2xkLCB1aW50IGFtb3VudFdlaSkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICB1aW50IHJhdGU7CiAgICAgICAgLy8gYXBwbHkgc2FsZQogICAgICAgIGlmICh0b3RhbFNvbGQgPCBTVEVQXzMwKSB7CiAgICAgICAgICAgIHJhdGUgPSBSQVRFXzMwOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmICh0b3RhbFNvbGQgPCBTVEVQXzIwKSB7CiAgICAgICAgICAgIHJhdGUgPSBSQVRFXzIwOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmICh0b3RhbFNvbGQgPCBTVEVQXzEwKSB7CiAgICAgICAgICAgIHJhdGUgPSBSQVRFXzEwOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgcmF0ZSA9IEJBU0VfUkFURTsKICAgICAgICB9CgogICAgICAgIC8vIGFwcGx5IGJvbnVzIGZvciBhbW91bnQKICAgICAgICBpZiAoYW1vdW50V2VpID49IDEwMDAgZXRoZXIpIHsKICAgICAgICAgICAgcmF0ZSArPSByYXRlICogMTMgLyAxMDA7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKGFtb3VudFdlaSA+PSA1MDAgZXRoZXIpIHsKICAgICAgICAgICAgcmF0ZSArPSByYXRlICogMTAgLyAxMDA7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKGFtb3VudFdlaSA+PSAxMDAgZXRoZXIpIHsKICAgICAgICAgICAgcmF0ZSArPSByYXRlICogNyAvIDEwMDsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoYW1vdW50V2VpID49IDUwIGV0aGVyKSB7CiAgICAgICAgICAgIHJhdGUgKz0gcmF0ZSAqIDUgLyAxMDA7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKGFtb3VudFdlaSA+PSAzMCBldGhlcikgewogICAgICAgICAgICByYXRlICs9IHJhdGUgKiA0IC8gMTAwOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChhbW91bnRXZWkgPj0gMTAgZXRoZXIpIHsKICAgICAgICAgICAgcmF0ZSArPSByYXRlICogMjUgLyAxMDAwOwogICAgICAgIH0KCiAgICAgICAgRXhjbHVzaXZlUmF0ZSBtZW1vcnkgZVJhdGUgPSBleGNsdXNpdmVSYXRlW2J1eWVyXTsKICAgICAgICBpZiAoZVJhdGUuZXhpc3RzICYmIGVSYXRlLndvcmtVbnRpbCA+PSBub3cpIHsKICAgICAgICAgICAgaWYgKGVSYXRlLnJhdGUgIT0gMCkgewogICAgICAgICAgICAgICAgcmF0ZSA9IGVSYXRlLnJhdGU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmF0ZSArPSByYXRlICogZVJhdGUuYm9udXNQZXJjZW50MTAwMCAvIDEwMDA7CiAgICAgICAgfQogICAgICAgIHJldHVybiByYXRlOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEV4Y2x1c2l2ZVJhdGUoYWRkcmVzcyBfaW52ZXN0b3IsIHVpbnQgX3JhdGUsIHVpbnQxNiBfYm9udXNQZXJjZW50MTAwMCwgdWludDMyIF93b3JrVW50aWwpIG9ubHlPd25lciB7CiAgICAgICAgZXhjbHVzaXZlUmF0ZVtfaW52ZXN0b3JdID0gRXhjbHVzaXZlUmF0ZShfd29ya1VudGlsLCBfcmF0ZSwgX2JvbnVzUGVyY2VudDEwMDAsIHRydWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlbW92ZUV4Y2x1c2l2ZVJhdGUoYWRkcmVzcyBfaW52ZXN0b3IpIG9ubHlPd25lciB7CiAgICAgICAgZGVsZXRlIGV4Y2x1c2l2ZVJhdGVbX2ludmVzdG9yXTsKICAgIH0KfQovKioKICogQHRpdGxlIENyb3dkc2FsZSAKICogQGRldiBDcm93ZHNhbGUgaXMgYSBiYXNlIGNvbnRyYWN0IGZvciBtYW5hZ2luZyBhIHRva2VuIGNyb3dkc2FsZS4KICoKICogQ3Jvd2RzYWxlcyBoYXZlIGEgc3RhcnQgYW5kIGVuZCB0aW1lc3RhbXBzLCB3aGVyZSBpbnZlc3RvcnMgY2FuIG1ha2UKICogdG9rZW4gcHVyY2hhc2VzIGFuZCB0aGUgY3Jvd2RzYWxlIHdpbGwgYXNzaWduIHRoZW0gdG9rZW5zIGJhc2VkCiAqIG9uIGEgdG9rZW4gcGVyIEVUSCByYXRlLiBGdW5kcyBjb2xsZWN0ZWQgYXJlIGZvcndhcmRlZCB0byBhIHdhbGxldCAKICogYXMgdGhleSBhcnJpdmUuCiAqLwpjb250cmFjdCBDcm93ZHNhbGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7CgogICAgLy8gVGhlIHRva2VuIGJlaW5nIHNvbGQKICAgIE1pbnRhYmxlVG9rZW4gcHVibGljIHRva2VuOwoKICAgIC8vIHN0YXJ0IGFuZCBlbmQgdGltZXN0YW1wcyB3aGVyZSBpbnZlc3RtZW50cyBhcmUgYWxsb3dlZCAoYm90aCBpbmNsdXNpdmUpCiAgICB1aW50MzIgaW50ZXJuYWwgc3RhcnRUaW1lOwogICAgdWludDMyIGludGVybmFsIGVuZFRpbWU7CgogICAgLy8gYWRkcmVzcyB3aGVyZSBmdW5kcyBhcmUgY29sbGVjdGVkCiAgICBhZGRyZXNzIHB1YmxpYyB3YWxsZXQ7CgogICAgLy8gYW1vdW50IG9mIHJhaXNlZCBtb25leSBpbiB3ZWkKICAgIHVpbnQgcHVibGljIHdlaVJhaXNlZDsKCiAgICAvKioKICAgICAqIEBkZXYgQW1vdW50IG9mIGFscmVhZHkgc29sZCB0b2tlbnMuCiAgICAgKi8KICAgIHVpbnQgcHVibGljIHNvbGRUb2tlbnM7CgogICAgLyoqCiAgICAgKiBAZGV2IE1heGltdW0gYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAgICovCiAgICB1aW50IGludGVybmFsIGhhcmRDYXA7CgogICAgLyoqCiAgICAgKiBldmVudCBmb3IgdG9rZW4gcHVyY2hhc2UgbG9nZ2luZwogICAgICogQHBhcmFtIHB1cmNoYXNlciB3aG8gcGFpZCBmb3IgdGhlIHRva2VucwogICAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IHdobyBnb3QgdGhlIHRva2VucwogICAgICogQHBhcmFtIHZhbHVlIHdlaXMgcGFpZCBmb3IgcHVyY2hhc2UKICAgICAqIEBwYXJhbSBhbW91bnQgYW1vdW50IG9mIHRva2VucyBwdXJjaGFzZWQKICAgICAqLwogICAgZXZlbnQgVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgcHVyY2hhc2VyLCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQgdmFsdWUsIHVpbnQgYW1vdW50KTsKCiAgICBmdW5jdGlvbiBDcm93ZHNhbGUodWludCBfc3RhcnRUaW1lLCB1aW50IF9lbmRUaW1lLCB1aW50IF9oYXJkQ2FwLCBhZGRyZXNzIF93YWxsZXQpIHsKICAgICAgICByZXF1aXJlKF9lbmRUaW1lID49IF9zdGFydFRpbWUpOwogICAgICAgIHJlcXVpcmUoX3dhbGxldCAhPSAweDApOwogICAgICAgIHJlcXVpcmUoX2hhcmRDYXAgPiAwKTsKCiAgICAgICAgdG9rZW4gPSBjcmVhdGVUb2tlbkNvbnRyYWN0KCk7CiAgICAgICAgc3RhcnRUaW1lID0gdWludDMyKF9zdGFydFRpbWUpOwogICAgICAgIGVuZFRpbWUgPSB1aW50MzIoX2VuZFRpbWUpOwogICAgICAgIGhhcmRDYXAgPSBfaGFyZENhcDsKICAgICAgICB3YWxsZXQgPSBfd2FsbGV0OwogICAgfQoKICAgIC8vIGNyZWF0ZXMgdGhlIHRva2VuIHRvIGJlIHNvbGQuCiAgICAvLyBvdmVycmlkZSB0aGlzIG1ldGhvZCB0byBoYXZlIGNyb3dkc2FsZSBvZiBhIHNwZWNpZmljIG1pbnRhYmxlIHRva2VuLgogICAgZnVuY3Rpb24gY3JlYXRlVG9rZW5Db250cmFjdCgpIGludGVybmFsIHJldHVybnMgKE1pbnRhYmxlVG9rZW4pIHsKICAgICAgICByZXR1cm4gbmV3IE1pbnRhYmxlVG9rZW4oKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgdGhpcyBtZXRob2QgbWlnaHQgYmUgb3ZlcnJpZGRlbiBmb3IgaW1wbGVtZW50aW5nIGFueSBzYWxlIGxvZ2ljLgogICAgICogQHJldHVybiBBY3R1YWwgcmF0ZS4KICAgICAqLwogICAgZnVuY3Rpb24gZ2V0UmF0ZSh1aW50IGFtb3VudCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludCk7CgogICAgZnVuY3Rpb24gZ2V0QmFzZVJhdGUoKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50KTsKCiAgICAvKioKICAgICAqIEBkZXYgcmF0ZSBzY2FsZSAob3IgZGl2aWRlciksIHRvIHN1cHBvcnQgbm90IGludGVnZXIgcmF0ZXMuCiAgICAgKiBAcmV0dXJuIFJhdGUgZGl2aWRlci4KICAgICAqLwogICAgZnVuY3Rpb24gZ2V0UmF0ZVNjYWxlKCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVybiAxOwogICAgfQoKICAgIC8vIGZhbGxiYWNrIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIGJ1eSB0b2tlbnMKICAgIGZ1bmN0aW9uKCkgcGF5YWJsZSB7CiAgICAgICAgYnV5VG9rZW5zKG1zZy5zZW5kZXIsIG1zZy52YWx1ZSk7CiAgICB9CgogICAgLy8gbG93IGxldmVsIHRva2VuIHB1cmNoYXNlIGZ1bmN0aW9uCiAgICBmdW5jdGlvbiBidXlUb2tlbnMoYWRkcmVzcyBiZW5lZmljaWFyeSwgdWludCBhbW91bnRXZWkpIGludGVybmFsIHsKICAgICAgICByZXF1aXJlKGJlbmVmaWNpYXJ5ICE9IDB4MCk7CgogICAgICAgIC8vIHRvdGFsIG1pbnRlZCB0b2tlbnMKICAgICAgICB1aW50IHRvdGFsU3VwcGx5ID0gdG9rZW4udG90YWxTdXBwbHkoKTsKCiAgICAgICAgLy8gYWN0dWFsIHRva2VuIG1pbnRpbmcgcmF0ZSAod2l0aCBjb25zaWRlcmluZyBib251c2VzIGFuZCBkaXNjb3VudHMpCiAgICAgICAgdWludCBhY3R1YWxSYXRlID0gZ2V0UmF0ZShhbW91bnRXZWkpOwogICAgICAgIHVpbnQgcmF0ZVNjYWxlID0gZ2V0UmF0ZVNjYWxlKCk7CgogICAgICAgIHJlcXVpcmUodmFsaWRQdXJjaGFzZShhbW91bnRXZWksIGFjdHVhbFJhdGUsIHRvdGFsU3VwcGx5KSk7CgogICAgICAgIC8vIGNhbGN1bGF0ZSB0b2tlbiBhbW91bnQgdG8gYmUgY3JlYXRlZAogICAgICAgIHVpbnQgdG9rZW5zID0gYW1vdW50V2VpLm11bChhY3R1YWxSYXRlKS5kaXYocmF0ZVNjYWxlKTsKCiAgICAgICAgLy8gdXBkYXRlIHN0YXRlCiAgICAgICAgd2VpUmFpc2VkID0gd2VpUmFpc2VkLmFkZChhbW91bnRXZWkpOwogICAgICAgIHNvbGRUb2tlbnMgPSBzb2xkVG9rZW5zLmFkZCh0b2tlbnMpOwoKICAgICAgICB0b2tlbi5taW50KGJlbmVmaWNpYXJ5LCB0b2tlbnMpOwogICAgICAgIFRva2VuUHVyY2hhc2UobXNnLnNlbmRlciwgYmVuZWZpY2lhcnksIGFtb3VudFdlaSwgdG9rZW5zKTsKCiAgICAgICAgZm9yd2FyZEZ1bmRzKGFtb3VudFdlaSk7CiAgICB9CgogICAgLy8gc2VuZCBldGhlciB0byB0aGUgZnVuZCBjb2xsZWN0aW9uIHdhbGxldAogICAgLy8gb3ZlcnJpZGUgdG8gY3JlYXRlIGN1c3RvbSBmdW5kIGZvcndhcmRpbmcgbWVjaGFuaXNtcwogICAgZnVuY3Rpb24gZm9yd2FyZEZ1bmRzKHVpbnQgYW1vdW50V2VpKSBpbnRlcm5hbCB7CiAgICAgICAgd2FsbGV0LnRyYW5zZmVyKGFtb3VudFdlaSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IENoZWNrIGlmIHRoZSBzcGVjaWZpZWQgcHVyY2hhc2UgaXMgdmFsaWQuCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIHRyYW5zYWN0aW9uIGNhbiBidXkgdG9rZW5zCiAgICAgKi8KICAgIGZ1bmN0aW9uIHZhbGlkUHVyY2hhc2UodWludCBfYW1vdW50V2VpLCB1aW50IF9hY3R1YWxSYXRlLCB1aW50IF90b3RhbFN1cHBseSkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGJvb2wgd2l0aGluUGVyaW9kID0gbm93ID49IHN0YXJ0VGltZSAmJiBub3cgPD0gZW5kVGltZTsKICAgICAgICBib29sIG5vblplcm9QdXJjaGFzZSA9IF9hbW91bnRXZWkgIT0gMDsKICAgICAgICBib29sIGhhcmRDYXBOb3RSZWFjaGVkID0gX3RvdGFsU3VwcGx5IDw9IGhhcmRDYXA7CgogICAgICAgIHJldHVybiB3aXRoaW5QZXJpb2QgJiYgbm9uWmVyb1B1cmNoYXNlICYmIGhhcmRDYXBOb3RSZWFjaGVkOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBCZWNhdXNlIG9mIGRpc2NvdW50IGhhc0VuZGVkIG1pZ2h0IGJlIHRydWUsIGJ1dCB2YWxpZFB1cmNoYXNlIHJldHVybnMgZmFsc2UuCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBlbmRlZAogICAgICovCiAgICBmdW5jdGlvbiBoYXNFbmRlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIG5vdyA+IGVuZFRpbWUgfHwgdG9rZW4udG90YWxTdXBwbHkoKSA+IGhhcmRDYXA7CiAgICB9CgogICAgLyoqCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBzdGFydGVkCiAgICAgKi8KICAgIGZ1bmN0aW9uIGhhc1N0YXJ0ZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJldHVybiBub3cgPj0gc3RhcnRUaW1lOwogICAgfQp9Cgpjb250cmFjdCBGaW5hbGl6YWJsZUNyb3dkc2FsZSBpcyBDcm93ZHNhbGUsIE93bmFibGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgYm9vbCBwdWJsaWMgaXNGaW5hbGl6ZWQgPSBmYWxzZTsKCiAgICBldmVudCBGaW5hbGl6ZWQoKTsKCiAgICBmdW5jdGlvbiBGaW5hbGl6YWJsZUNyb3dkc2FsZSh1aW50IF9zdGFydFRpbWUsIHVpbnQgX2VuZFRpbWUsIHVpbnQgX2hhcmRDYXAsIGFkZHJlc3MgX3dhbGxldCkKICAgICAgICAgICAgQ3Jvd2RzYWxlKF9zdGFydFRpbWUsIF9lbmRUaW1lLCBfaGFyZENhcCwgX3dhbGxldCkgewogICAgfQoKICAgIC8qKgogICAgICogQGRldiBNdXN0IGJlIGNhbGxlZCBhZnRlciBjcm93ZHNhbGUgZW5kcywgdG8gZG8gc29tZSBleHRyYSBmaW5hbGl6YXRpb24KICAgICAqIHdvcmsuIENhbGxzIHRoZSBjb250cmFjdCdzIGZpbmFsaXphdGlvbiBmdW5jdGlvbi4KICAgICAqLwogICAgZnVuY3Rpb24gZmluYWxpemUoKSBvbmx5T3duZXIgbm90RmluYWxpemVkIHsKICAgICAgICByZXF1aXJlKGhhc0VuZGVkKCkpOwoKICAgICAgICBmaW5hbGl6YXRpb24oKTsKICAgICAgICBGaW5hbGl6ZWQoKTsKCiAgICAgICAgaXNGaW5hbGl6ZWQgPSB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBDYW4gYmUgb3ZlcnJpZGVuIHRvIGFkZCBmaW5hbGl6YXRpb24gbG9naWMuIFRoZSBvdmVycmlkaW5nIGZ1bmN0aW9uCiAgICAgKiBzaG91bGQgY2FsbCBzdXBlci5maW5hbGl6YXRpb24oKSB0byBlbnN1cmUgdGhlIGNoYWluIG9mIGZpbmFsaXphdGlvbiBpcwogICAgICogZXhlY3V0ZWQgZW50aXJlbHkuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGZpbmFsaXphdGlvbigpIGludGVybmFsIHsKICAgIH0KCiAgICBtb2RpZmllciBub3RGaW5hbGl6ZWQoKSB7CiAgICAgICAgcmVxdWlyZSghaXNGaW5hbGl6ZWQpOwogICAgICAgIF87CiAgICB9Cn0KCmNvbnRyYWN0IE15V2lzaENyb3dkc2FsZSBpcyB1c2luZ015V2lzaENvbnN0cywgRmluYWxpemFibGVDcm93ZHNhbGUgewogICAgTXlXaXNoUmF0ZVByb3ZpZGVySSBwdWJsaWMgcmF0ZVByb3ZpZGVyOwoKICAgIGZ1bmN0aW9uIE15V2lzaENyb3dkc2FsZSgKICAgICAgICAgICAgdWludCBfc3RhcnRUaW1lLAogICAgICAgICAgICB1aW50IF9lbmRUaW1lLAogICAgICAgICAgICB1aW50IF9oYXJkQ2FwVG9rZW5zCiAgICApCiAgICAgICAgICAgIEZpbmFsaXphYmxlQ3Jvd2RzYWxlKF9zdGFydFRpbWUsIF9lbmRUaW1lLCBfaGFyZENhcFRva2VucyAqIFRPS0VOX0RFQ0lNQUxfTVVMVElQTElFUiwgQ09MRF9XQUxMRVQpIHsKCiAgICAgICAgdG9rZW4ubWludChURUFNX0FERFJFU1MsIFRFQU1fVE9LRU5TKTsKICAgICAgICB0b2tlbi5taW50KEJPVU5UWV9BRERSRVNTLCBCT1VOVFlfVE9LRU5TKTsKICAgICAgICB0b2tlbi5taW50KFBSRUlDT19BRERSRVNTLCBQUkVJQ09fVE9LRU5TKTsKCiAgICAgICAgTXlXaXNoVG9rZW4odG9rZW4pLmFkZEV4Y2x1ZGVkKFRFQU1fQUREUkVTUyk7CiAgICAgICAgTXlXaXNoVG9rZW4odG9rZW4pLmFkZEV4Y2x1ZGVkKEJPVU5UWV9BRERSRVNTKTsKICAgICAgICBNeVdpc2hUb2tlbih0b2tlbikuYWRkRXhjbHVkZWQoUFJFSUNPX0FERFJFU1MpOwoKICAgICAgICBNeVdpc2hSYXRlUHJvdmlkZXIgcHJvdmlkZXIgPSBuZXcgTXlXaXNoUmF0ZVByb3ZpZGVyKCk7CiAgICAgICAgcHJvdmlkZXIudHJhbnNmZXJPd25lcnNoaXAob3duZXIpOwogICAgICAgIHJhdGVQcm92aWRlciA9IHByb3ZpZGVyOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBvdmVycmlkZSB0b2tlbiBjcmVhdGlvbiB0byBpbnRlZ3JhdGUgd2l0aCBNeVdpbGwgdG9rZW4uCiAgICAgKi8KICAgIGZ1bmN0aW9uIGNyZWF0ZVRva2VuQ29udHJhY3QoKSBpbnRlcm5hbCByZXR1cm5zIChNaW50YWJsZVRva2VuKSB7CiAgICAgICAgcmV0dXJuIG5ldyBNeVdpc2hUb2tlbigpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiBvdmVycmlkZSBnZXRSYXRlIHRvIGludGVncmF0ZSB3aXRoIHJhdGUgcHJvdmlkZXIuCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldFJhdGUodWludCBfdmFsdWUpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gcmF0ZVByb3ZpZGVyLmdldFJhdGUobXNnLnNlbmRlciwgc29sZFRva2VucywgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRCYXNlUmF0ZSgpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gcmF0ZVByb3ZpZGVyLmdldFJhdGUobXNnLnNlbmRlciwgc29sZFRva2VucywgTUlOSU1BTF9QVVJDSEFTRSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2IG92ZXJyaWRlIGdldFJhdGVTY2FsZSB0byBpbnRlZ3JhdGUgd2l0aCByYXRlIHByb3ZpZGVyLgogICAgICovCiAgICBmdW5jdGlvbiBnZXRSYXRlU2NhbGUoKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIHJhdGVQcm92aWRlci5nZXRSYXRlU2NhbGUoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQWRtaW4gY2FuIHNldCBuZXcgcmF0ZSBwcm92aWRlci4KICAgICAqIEBwYXJhbSBfcmF0ZVByb3ZpZGVyQWRkcmVzcyBOZXcgcmF0ZSBwcm92aWRlci4KICAgICAqLwogICAgZnVuY3Rpb24gc2V0UmF0ZVByb3ZpZGVyKGFkZHJlc3MgX3JhdGVQcm92aWRlckFkZHJlc3MpIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShfcmF0ZVByb3ZpZGVyQWRkcmVzcyAhPSAwKTsKICAgICAgICByYXRlUHJvdmlkZXIgPSBNeVdpc2hSYXRlUHJvdmlkZXJJKF9yYXRlUHJvdmlkZXJBZGRyZXNzKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgQWRtaW4gY2FuIG1vdmUgZW5kIHRpbWUuCiAgICAgKiBAcGFyYW0gX2VuZFRpbWUgTmV3IGVuZCB0aW1lLgogICAgICovCiAgICBmdW5jdGlvbiBzZXRFbmRUaW1lKHVpbnQgX2VuZFRpbWUpIG9ubHlPd25lciBub3RGaW5hbGl6ZWQgewogICAgICAgIHJlcXVpcmUoX2VuZFRpbWUgPiBzdGFydFRpbWUpOwogICAgICAgIGVuZFRpbWUgPSB1aW50MzIoX2VuZFRpbWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEhhcmRDYXAodWludCBfaGFyZENhcFRva2Vucykgb25seU93bmVyIG5vdEZpbmFsaXplZCB7CiAgICAgICAgcmVxdWlyZShfaGFyZENhcFRva2VucyAqIFRPS0VOX0RFQ0lNQUxfTVVMVElQTElFUiA+IGhhcmRDYXApOwogICAgICAgIGhhcmRDYXAgPSBfaGFyZENhcFRva2VucyAqIFRPS0VOX0RFQ0lNQUxfTVVMVElQTElFUjsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRTdGFydFRpbWUodWludCBfc3RhcnRUaW1lKSBvbmx5T3duZXIgbm90RmluYWxpemVkIHsKICAgICAgICByZXF1aXJlKF9zdGFydFRpbWUgPCBlbmRUaW1lKTsKICAgICAgICBzdGFydFRpbWUgPSB1aW50MzIoX3N0YXJ0VGltZSk7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkRXhjbHVkZWQoYWRkcmVzcyBfYWRkcmVzcykgb25seU93bmVyIG5vdEZpbmFsaXplZCB7CiAgICAgICAgTXlXaXNoVG9rZW4odG9rZW4pLmFkZEV4Y2x1ZGVkKF9hZGRyZXNzKTsKICAgIH0KCiAgICBmdW5jdGlvbiB2YWxpZFB1cmNoYXNlKHVpbnQgX2Ftb3VudFdlaSwgdWludCBfYWN0dWFsUmF0ZSwgdWludCBfdG90YWxTdXBwbHkpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICBpZiAoX2Ftb3VudFdlaSA8IE1JTklNQUxfUFVSQ0hBU0UpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gc3VwZXIudmFsaWRQdXJjaGFzZShfYW1vdW50V2VpLCBfYWN0dWFsUmF0ZSwgX3RvdGFsU3VwcGx5KTsKICAgIH0KCiAgICBmdW5jdGlvbiBmaW5hbGl6YXRpb24oKSBpbnRlcm5hbCB7CiAgICAgICAgc3VwZXIuZmluYWxpemF0aW9uKCk7CiAgICAgICAgdG9rZW4uZmluaXNoTWludGluZygpOwogICAgICAgIE15V2lzaFRva2VuKHRva2VuKS5jcm93ZHNhbGVGaW5pc2hlZCgpOwogICAgICAgIHRva2VuLnRyYW5zZmVyT3duZXJzaGlwKG93bmVyKTsKICAgIH0KfQ=='.
	

]
