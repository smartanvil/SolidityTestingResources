Class {
	#name : #SRT35516eddadb9a3b88e43ebcd271a56c130ea41b6,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT35516eddadb9a3b88e43ebcd271a56c130ea41b6 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuODsKCgovKioKICogTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcwogKiBCeSBPcGVuWmVwcGVsaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvY29udHJhY3RzL1NhZmVNYXRoLnNvbAogKi8KbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCmNvbnRyYWN0IENvbnRyYWN0UmVjZWl2ZXJ7CiAgICBmdW5jdGlvbiB0b2tlbkZhbGxiYWNrKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyAgX2RhdGEpIGV4dGVybmFsOwp9Cgpjb250cmFjdCBPd25hYmxlIHsKICAgIGFkZHJlc3MgcHVibGljIG93bmVyOwogICAgYWRkcmVzcyBwdWJsaWMgb3duZXJDYW5kaWRhdGU7CiAgICBldmVudCBPd25lclRyYW5zZmVyKGFkZHJlc3Mgb3JpZ2luYWxPd25lciwgYWRkcmVzcyBjdXJyZW50T3duZXIpOwoKICAgIG1vZGlmaWVyIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHByb3Bvc2VOZXdPd25lcihhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKG5ld093bmVyICE9IGFkZHJlc3MoMCkgJiYgbmV3T3duZXIgIT0gb3duZXIpOwogICAgICAgIG93bmVyQ2FuZGlkYXRlID0gbmV3T3duZXI7CiAgICB9CgogICAgZnVuY3Rpb24gYWNjZXB0T3duZXJUcmFuc2ZlcigpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyQ2FuZGlkYXRlKTsKICAgICAgICBPd25lclRyYW5zZmVyKG93bmVyLCBvd25lckNhbmRpZGF0ZSk7CiAgICAgICAgb3duZXIgPSBvd25lckNhbmRpZGF0ZTsKICAgIH0KfQoKY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9Cgpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsKICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgLyoqCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1ttc2cuc2VuZGVyXSk7CgogICAgLy8gU2FmZU1hdGguc3ViIHdpbGwgdGhyb3cgaWYgdGhlcmUgaXMgbm90IGVub3VnaCBiYWxhbmNlLgogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgKi8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOwogIH0KCn0KCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CgoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7CiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsKICB9CgogIC8qKgogICAqIGFwcHJvdmUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbG93ZWRbX3NwZW5kZXJdID09IDAuIFRvIGluY3JlbWVudAogICAqIGFsbG93ZWQgdmFsdWUgaXMgYmV0dGVyIHRvIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGF2b2lkIDIgY2FsbHMgKGFuZCB3YWl0IHVudGlsCiAgICogdGhlIGZpcnN0IHRyYW5zYWN0aW9uIGlzIG1pbmVkKQogICAqIEZyb20gTW9ub2xpdGhEQU8gVG9rZW4uc29sCiAgICovCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXS5hZGQoX2FkZGVkVmFsdWUpOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl07CiAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCi8vIEJhc2VkIGluIHBhcnQgb24gY29kZSBieSBPcGVuLVplcHBlbGluOiBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5LmdpdAovLyBCYXNlZCBpbiBwYXJ0IG9uIGNvZGUgYnkgRmlyc3RCbG9vZDogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sCi8vIFNtYXJ0IGNvbnRyYWN0IGZvciB0aGUgUmVwdVggdG9rZW4gJiB0aGUgZmlyc3QgY3Jvd2RzYWxlCmNvbnRyYWN0IFJlcHVYIGlzIFN0YW5kYXJkVG9rZW4sIE93bmFibGUgewogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIlJlcHVYIjsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIlJQWCI7CiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwogICAgYWRkcmVzcyBwdWJsaWMgbXVsdGlzaWc7IC8vbXVsdGlzaWcgd2FsbGV0LCB0byB3aGljaCBhbGwgY29udHJpYnV0aW9ucyB3aWxsIGJlIHNlbnQKCiAgICB1aW50MjU2IHB1YmxpYyBwaGFzZTFTdGFydEJsb2NrOyAvL0Nyb3dkc2FsZSBzdGFydCBibG9jawogICAgdWludDI1NiBwdWJsaWMgcGhhc2UxRW5kQmxvY2s7IC8vIERheSA3IChlc3RpbWF0ZSkKICAgIHVpbnQyNTYgcHVibGljIHBoYXNlMkVuZEJsb2NrOyAvLyBEYXkgMTMgKGVzdGltYXRlKQogICAgdWludDI1NiBwdWJsaWMgcGhhc2UzRW5kQmxvY2s7IC8vIERheSAxOSAoZXN0aW1hdGUpCiAgICB1aW50MjU2IHB1YmxpYyBwaGFzZTRFbmRCbG9jazsgLy8gRGF5IDI1IChlc3RpbWF0ZSkKICAgIHVpbnQyNTYgcHVibGljIHBoYXNlNUVuZEJsb2NrOyAvLyBEYXkgMzEgKGVzdGltYXRlKQogICAgdWludDI1NiBwdWJsaWMgZW5kQmxvY2s7IC8vd2hvbGUgY3Jvd2RzYWxlIGVuZCBibG9jawoKICAgIHVpbnQyNTYgcHVibGljIGJhc2VQcmljZSA9IDEyMjYgKiAoMTAqKjEyKTsgLy8gSUNPIHRva2VuIGJhc2UgcHJpY2U6IH4kMC4zNSAoZXN0aW1hdGUgYXNzdW1pbmcgJDI5MCBwZXIgRXRoKQoKICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5ID0gNTAwMDAwMDAwICogKDEwKipkZWNpbWFscyk7IC8vVG9rZW4gdG90YWwgc3VwcGx5OiA1MDAwMDAwMDAgUlBYCiAgICB1aW50MjU2IHB1YmxpYyBwcmVzYWxlVG9rZW5TdXBwbHkgPSB0b3RhbFN1cHBseS5tdWwoMTApLmRpdigxMDApOyAvL0Ftb3VudCBvZiB0b2tlbnMgYXZhaWxhYmxlIGR1cmluZyBwcmVzYWxlICgxMCUpCiAgICB1aW50MjU2IHB1YmxpYyBjcm93ZHNhbGVUb2tlblN1cHBseSA9IHRvdGFsU3VwcGx5Lm11bCg1MCkuZGl2KDEwMCk7IC8vQW1vdW50IG9mIHRva2VucyBhdmFpbGFibGUgZHVyaW5nIGNyb3dkc2FsZSAoNTAlKQogICAgdWludDI1NiBwdWJsaWMgcmV3YXJkc1Rva2VuU3VwcGx5ID0gdG90YWxTdXBwbHkubXVsKDE1KS5kaXYoMTAwKTsgLy9SZXdhcmRzIHBvb2wgKFZJUCBldGMsIDEwJSksIGFtYmFzc2Fkb3Igc2hhcmUoMyUpICYgSUNPIGJvdW50aWVzKDIlKQogICAgdWludDI1NiBwdWJsaWMgdGVhbVRva2VuU3VwcGx5ID0gdG90YWxTdXBwbHkubXVsKDEyKS5kaXYoMTAwKTsgLy9Ub2tlbnMgZGlzdHJpYnV0ZWQgdG8gdGVhbSAoMTIlIGluIHRvdGFsLCA0JSB2ZXN0ZWQgZm9yIDEyLCAyNCAmIDM2IG1vbnRocykKICAgIHVpbnQyNTYgcHVibGljIElDT1Jlc2VydmVTdXBwbHkgPSB0b3RhbFN1cHBseS5tdWwoMTMpLmRpdigxMDApOyAvL1Rva2VuIHJlc2VydmUgZm9yIDJuZCBJQ08gKGFmdGVyIDIgeWVhcnMgbWluLCAxMyUpCiAgICB1aW50MjU2IHB1YmxpYyBwcmVzYWxlVG9rZW5Tb2xkID0gMDsgLy9SZWNvcmRzIHRoZSBhbW91bnQgb2YgdG9rZW5zIHNvbGQgZHVyaW5nIHByZXNhbGUKICAgIHVpbnQyNTYgcHVibGljIGNyb3dkc2FsZVRva2VuU29sZCA9IDA7IC8vUmVjb3JkcyB0aGUgYW1vdW50IG9mIHRva2VucyBzb2xkIGR1cmluZyB0aGUgY3Jvd2RzYWxlCgogICAgdWludDI1NiBwdWJsaWMgcGhhc2UxQ2FwID0gMTI1MDAwMDAwICogKDEwKipkZWNpbWFscyk7CiAgICB1aW50MjU2IHB1YmxpYyBwaGFzZTJDYXAgPSBwaGFzZTFDYXAuYWRkKDUwMDAwMDAwICogKDEwKipkZWNpbWFscykpOwogICAgdWludDI1NiBwdWJsaWMgcGhhc2UzQ2FwID0gcGhhc2UyQ2FwLmFkZCgzNzUwMDAwMCAqICgxMCoqZGVjaW1hbHMpKTsKICAgIHVpbnQyNTYgcHVibGljIHBoYXNlNENhcCA9IHBoYXNlM0NhcC5hZGQoMjUwMDAwMDAgKiAoMTAqKmRlY2ltYWxzKSk7CgogICAgdWludDI1NiBwdWJsaWMgdHJhbnNmZXJMb2NrdXAgPSA1NzYwOyAvL0xvY2sgdXAgdG9rZW4gdHJhbnNmZXIgdW50aWwgfjIgZGF5cyBhZnRlciBjcm93ZHNhbGUgY29uY2x1ZGVzCiAgICB1aW50MjU2IHB1YmxpYyB0ZWFtTG9ja1VwOyAKICAgIHVpbnQyNTYgcHVibGljIElDT1Jlc2VydmVMb2NrVXA7CiAgICB1aW50MjU2IHByaXZhdGUgdGVhbVdpdGhkcmF3bENvdW50ID0gMDsKICAgIHVpbnQyNTYgcHVibGljIGF2ZXJhZ2VCbG9ja1RpbWUgPSAzMDsgLy9BdmVyYWdlIGJsb2NrIHRpbWUgaW4gc2Vjb25kcwoKICAgIGJvb2wgcHVibGljIHByZXNhbGVTdGFydGVkID0gZmFsc2U7CiAgICBib29sIHB1YmxpYyBwcmVzYWxlQ29uY2x1ZGVkID0gZmFsc2U7CiAgICBib29sIHB1YmxpYyBjcm93ZHNhbGVTdGFydGVkID0gZmFsc2U7CiAgICBib29sIHB1YmxpYyBjcm93ZHNhbGVDb25jbHVkZWQgPSBmYWxzZTsKICAgIGJvb2wgcHVibGljIElDT1Jlc2VydmVXaXRoZHJhd24gPSBmYWxzZTsKICAgIGJvb2wgcHVibGljIGhhbHRlZCA9IGZhbHNlOyAvL0hhbHQgY3Jvd2RzYWxlIGluIGVtZXJnZW5jeQoKICAgIHVpbnQyNTYgY29udHJpYnV0aW9uQ291bnQgPSAwOwogICAgYnl0ZXMzMltdIHB1YmxpYyBjb250cmlidXRpb25IYXNoZXM7CiAgICBtYXBwaW5nIChieXRlczMyID0+IENvbnRyaWJ1dGlvbikgcHJpdmF0ZSBjb250cmlidXRpb25zOwoKICAgIGV2ZW50IEhhbHQoKTsgLy9IYWx0IGV2ZW50CiAgICBldmVudCBVbmhhbHQoKTsgLy9VbmhhbHQgZXZlbnQKICAgIGV2ZW50IEJ1cm4oYWRkcmVzcyBidXJuZXIsIHVpbnQyNTYgYW1vdW50KTsKCiAgICBzdHJ1Y3QgQ29udHJpYnV0aW9uIHsKICAgICAgICBhZGRyZXNzIGNvbnRyaWJ1dG9yOwogICAgICAgIGFkZHJlc3MgcmVjaXBpZW50OwogICAgICAgIHVpbnQyNTYgZXRoV2VpOwogICAgICAgIHVpbnQyNTYgdG9rZW5zOwogICAgICAgIGJvb2wgcmVzb2x2ZWQ7CiAgICAgICAgYm9vbCBzdWNjZXNzOwogICAgICAgIHVpbnQ4IHN0YWdlOwogICAgfQoKICAgIGV2ZW50IENvbnRyaWJ1dGlvblJlY2VpdmVkKGJ5dGVzMzIgY29udHJpYnV0aW9uSGFzaCwgYWRkcmVzcyBjb250cmlidXRvciwgYWRkcmVzcyByZWNpcGllbnQsCiAgICAgICAgdWludDI1NiBldGhXZWksIHVpbnQyNTYgcGVuZGluZ1Rva2Vucyk7CgogICAgZXZlbnQgQ29udHJpYnV0aW9uUmVzb2x2ZWQoYnl0ZXMzMiBjb250cmlidXRpb25IYXNoLCBib29sIHBhc3MsIGFkZHJlc3MgY29udHJpYnV0b3IsIAogICAgICAgIGFkZHJlc3MgcmVjaXBpZW50LCB1aW50MjU2IGV0aFdlaSwgdWludDI1NiB0b2tlbnMpOwoKCiAgICAvLyBsb2NrdXAgZHVyaW5nIGFuZCBhZnRlciA0OGggb2YgZW5kIG9mIGNyb3dkc2FsZQogICAgbW9kaWZpZXIgY3Jvd2RzYWxlVHJhbnNmZXJMb2NrKCkgewogICAgICAgIHJlcXVpcmUoY3Jvd2RzYWxlQ29uY2x1ZGVkICYmIGJsb2NrLm51bWJlciA+PSBlbmRCbG9jay5hZGQodHJhbnNmZXJMb2NrdXApKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIHdoZW5Ob3RIYWx0ZWQoKSB7CiAgICAgICAgcmVxdWlyZSghaGFsdGVkKTsKICAgICAgICBfOwogICAgfQoKICAgIC8vQ29uc3RydWN0b3I6IHNldCBvd25lciAodGVhbSkgYWRkcmVzcyAmIGNyb3dkc2FsZSByZWNpcGllbnQgbXVsdGlzaWcgd2FsbGV0IGFkZHJlc3MKICAgIC8vQWxsb2NhdGUgcmV3YXJkIHRva2VucyB0byB0aGUgdGVhbSB3YWxsZXQKICAJZnVuY3Rpb24gUmVwdVgoYWRkcmVzcyBfbXVsdGlzaWcpIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICAgICAgbXVsdGlzaWcgPSBfbXVsdGlzaWc7CiAgICAgICAgYmFsYW5jZXNbb3duZXJdID0gcmV3YXJkc1Rva2VuU3VwcGx5OwogIAl9CgogICAgLy9GYWxsYmFjayBmdW5jdGlvbiB3aGVuIHJlY2VpdmluZyBFdGhlci4gQ29udHJpYnV0b3JzIGNhbiBkaXJlY3RseSBzZW5kIEV0aGVyIHRvIHRoZSB0b2tlbiBhZGRyZXNzIGR1cmluZyBjcm93ZHNhbGUuCiAgICBmdW5jdGlvbigpIHBheWFibGUgewogICAgICAgIGJ1eSgpOwogICAgfQoKCiAgICAvL0hhbHQgSUNPIGluIGNhc2Ugb2YgZW1lcmdlbmN5LgogICAgZnVuY3Rpb24gaGFsdCgpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIGhhbHRlZCA9IHRydWU7CiAgICAgICAgSGFsdCgpOwogICAgfQoKICAgIGZ1bmN0aW9uIHVuaGFsdCgpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIGhhbHRlZCA9IGZhbHNlOwogICAgICAgIFVuaGFsdCgpOwogICAgfQoKICAgIGZ1bmN0aW9uIHN0YXJ0UHJlc2FsZSgpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoIXByZXNhbGVTdGFydGVkKTsKICAgICAgICBwcmVzYWxlU3RhcnRlZCA9IHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gY29uY2x1ZGVQcmVzYWxlKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShwcmVzYWxlU3RhcnRlZCAmJiAhcHJlc2FsZUNvbmNsdWRlZCk7CiAgICAgICAgcHJlc2FsZUNvbmNsdWRlZCA9IHRydWU7CiAgICAgICAgLy9VbnNvbGQgdG9rZW5zIGluIHRoZSBwcmVzYWxlIGFyZSBtYWRlIGF2YWlsYWJsZSBpbiB0aGUgY3Jvd2RzYWxlLgogICAgICAgIGNyb3dkc2FsZVRva2VuU3VwcGx5ID0gY3Jvd2RzYWxlVG9rZW5TdXBwbHkuYWRkKHByZXNhbGVUb2tlblN1cHBseS5zdWIocHJlc2FsZVRva2VuU29sZCkpOyAKICAgIH0KCiAgICAvL0NhbiBvbmx5IGJlIGNhbGxlZCBhZnRlciBwcmVzYWxlIGlzIGNvbmNsdWRlZC4KICAgIGZ1bmN0aW9uIHN0YXJ0Q3Jvd2RzYWxlKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZShwcmVzYWxlQ29uY2x1ZGVkICYmICFjcm93ZHNhbGVTdGFydGVkKTsKICAgICAgICBjcm93ZHNhbGVTdGFydGVkID0gdHJ1ZTsKICAgICAgICBwaGFzZTFTdGFydEJsb2NrID0gYmxvY2subnVtYmVyOwogICAgICAgIHBoYXNlMUVuZEJsb2NrID0gcGhhc2UxU3RhcnRCbG9jay5hZGQoZGF5VG9CbG9ja051bWJlcig3KSk7CiAgICAgICAgcGhhc2UyRW5kQmxvY2sgPSBwaGFzZTFFbmRCbG9jay5hZGQoZGF5VG9CbG9ja051bWJlcig2KSk7CiAgICAgICAgcGhhc2UzRW5kQmxvY2sgPSBwaGFzZTJFbmRCbG9jay5hZGQoZGF5VG9CbG9ja051bWJlcig2KSk7CiAgICAgICAgcGhhc2U0RW5kQmxvY2sgPSBwaGFzZTNFbmRCbG9jay5hZGQoZGF5VG9CbG9ja051bWJlcig2KSk7CiAgICAgICAgcGhhc2U1RW5kQmxvY2sgPSBwaGFzZTRFbmRCbG9jay5hZGQoZGF5VG9CbG9ja051bWJlcig2KSk7CiAgICAgICAgZW5kQmxvY2sgPSBwaGFzZTVFbmRCbG9jazsKICAgIH0KCiAgICAvL0NhbiBvbmx5IGJlIGNhbGxlZCBlaXRoZXIgYWZ0ZXIgY3Jvd2RzYWxlIHRpbWUgcGVyaW9kIGVuZHMsIG9yIGFmdGVyIHRva2VucyBoYXZlIHNvbGQgb3V0CiAgICBmdW5jdGlvbiBjb25jbHVkZUNyb3dkc2FsZSgpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoY3Jvd2RzYWxlU3RhcnRlZCAmJiAhY3Jvd2RzYWxlT24oKSAmJiAhY3Jvd2RzYWxlQ29uY2x1ZGVkKTsKICAgICAgICBjcm93ZHNhbGVDb25jbHVkZWQgPSB0cnVlOwogICAgICAgIGVuZEJsb2NrID0gYmxvY2subnVtYmVyOwogICAgICAgIHVpbnQyNTYgdW5zb2xkID0gY3Jvd2RzYWxlVG9rZW5TdXBwbHkuc3ViKGNyb3dkc2FsZVRva2VuU29sZCk7CiAgICAgICAgaWYgKHVuc29sZCA+IDApIHsKICAgICAgICAgICAgLy9CdXJuIHVuc29sZCB0b2tlbnMKICAgICAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5zdWIodW5zb2xkKTsKICAgICAgICAgICAgQnVybih0aGlzLCB1bnNvbGQpOwogICAgICAgICAgICBUcmFuc2Zlcih0aGlzLCBhZGRyZXNzKDApLCB1bnNvbGQpOwogICAgICAgIH0KICAgICAgICB0ZWFtTG9ja1VwID0gZGF5VG9CbG9ja051bWJlcigzNjUpOyAvLzEyLW1vbnRoIGxvY2stdXAgcGVyaW9kCiAgICAgICAgSUNPUmVzZXJ2ZUxvY2tVcCA9IGRheVRvQmxvY2tOdW1iZXIoMzY1ICogMik7IC8vMiB5ZWFycyBsb2NrIHVwIHBlcmlvZAogICAgfQoKICAgIGZ1bmN0aW9uIHdpdGhkcmF3VGVhbVRva2VuKCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZSh0ZWFtV2l0aGRyYXdsQ291bnQgPCAzKTsKICAgICAgICByZXF1aXJlKGNyb3dkc2FsZUNvbmNsdWRlZCk7CiAgICAgICAgaWYgKHRlYW1XaXRoZHJhd2xDb3VudCA9PSAwKSB7CiAgICAgICAgICAgIHJlcXVpcmUoYmxvY2subnVtYmVyID49IGVuZEJsb2NrLmFkZCh0ZWFtTG9ja1VwKSk7IC8vMTItbW9udGggbG9jay11cAogICAgICAgIH0gZWxzZSBpZiAodGVhbVdpdGhkcmF3bENvdW50ID09IDEpIHsKICAgICAgICAgICAgcmVxdWlyZShibG9jay5udW1iZXIgPj0gZW5kQmxvY2suYWRkKHRlYW1Mb2NrVXAubXVsKDIpKSk7IC8vMjQtbW9udGggbG9jay11cAogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlcXVpcmUoYmxvY2subnVtYmVyID49IGVuZEJsb2NrLmFkZCh0ZWFtTG9ja1VwLm11bCgzKSkpOyAvLzM2LW1vbnRoIGxvY2stdXAKICAgICAgICB9CiAgICAgICAgdGVhbVdpdGhkcmF3bENvdW50Kys7CiAgICAgICAgdWludDI1NiB0b2tlbnMgPSB0ZWFtVG9rZW5TdXBwbHkuZGl2KDMpOwogICAgICAgIGJhbGFuY2VzW293bmVyXSA9IGJhbGFuY2VzW293bmVyXS5hZGQodG9rZW5zKTsKICAgICAgICBUcmFuc2Zlcih0aGlzLCBvd25lciwgdG9rZW5zKTsKICAgIH0KCiAgICBmdW5jdGlvbiB3aXRoZHJhd0lDT1Jlc2VydmUoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKCFJQ09SZXNlcnZlV2l0aGRyYXduKTsKICAgICAgICByZXF1aXJlKGNyb3dkc2FsZUNvbmNsdWRlZCk7CiAgICAgICAgcmVxdWlyZShibG9jay5udW1iZXIgPj0gZW5kQmxvY2suYWRkKElDT1Jlc2VydmVMb2NrVXApKTsKICAgICAgICBJQ09SZXNlcnZlV2l0aGRyYXduID0gdHJ1ZTsKICAgICAgICBiYWxhbmNlc1tvd25lcl0gPSBiYWxhbmNlc1tvd25lcl0uYWRkKElDT1Jlc2VydmVTdXBwbHkpOwogICAgICAgIFRyYW5zZmVyKHRoaXMsIG93bmVyLCBJQ09SZXNlcnZlU3VwcGx5KTsKICAgIH0KCiAgICBmdW5jdGlvbiBidXkoKSBwYXlhYmxlIHsKICAgICAgICBidXlSZWNpcGllbnQobXNnLnNlbmRlcik7CiAgICB9CgoKICAgIC8vQWxsb3cgYWRkcmVzc2VzIHRvIGJ1eSB0b2tlbiBmb3IgYW5vdGhlciBhY2NvdW50CiAgICBmdW5jdGlvbiBidXlSZWNpcGllbnQoYWRkcmVzcyByZWNpcGllbnQpIHB1YmxpYyBwYXlhYmxlIHdoZW5Ob3RIYWx0ZWQgewogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID4gMCk7CiAgICAgICAgcmVxdWlyZShwcmVzYWxlT24oKXx8Y3Jvd2RzYWxlT24oKSk7IC8vQ29udHJpYnV0aW9uIG9ubHkgYWxsb3dlZCBkdXJpbmcgcHJlc2FsZS9jcm93ZHNhbGUKICAgICAgICB1aW50MjU2IHRva2VucyA9IG1zZy52YWx1ZS5kaXYodG9rZW5QcmljZSgpKTsgCiAgICAgICAgdWludDggc3RhZ2UgPSAwOwoKICAgICAgICBpZihwcmVzYWxlT24oKSkgewogICAgICAgICAgICByZXF1aXJlKHByZXNhbGVUb2tlblNvbGQuYWRkKHRva2VucykgPD0gcHJlc2FsZVRva2VuU3VwcGx5KTsKICAgICAgICAgICAgcHJlc2FsZVRva2VuU29sZCA9IHByZXNhbGVUb2tlblNvbGQuYWRkKHRva2Vucyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVxdWlyZShjcm93ZHNhbGVUb2tlblNvbGQuYWRkKHRva2VucykgPD0gY3Jvd2RzYWxlVG9rZW5TdXBwbHkpOwogICAgICAgICAgICBjcm93ZHNhbGVUb2tlblNvbGQgPSBjcm93ZHNhbGVUb2tlblNvbGQuYWRkKHRva2Vucyk7CiAgICAgICAgICAgIHN0YWdlID0gMTsKICAgICAgICB9CiAgICAgICAgY29udHJpYnV0aW9uQ291bnQgPSBjb250cmlidXRpb25Db3VudC5hZGQoMSk7CiAgICAgICAgYnl0ZXMzMiB0cmFuc2FjdGlvbkhhc2ggPSBrZWNjYWsyNTYoY29udHJpYnV0aW9uQ291bnQsIG1zZy5zZW5kZXIsIG1zZy52YWx1ZSwgbXNnLmRhdGEsCiAgICAgICAgICAgIG1zZy5nYXMsIGJsb2NrLm51bWJlciwgdHguZ2FzcHJpY2UpOwogICAgICAgIGNvbnRyaWJ1dGlvbnNbdHJhbnNhY3Rpb25IYXNoXSA9IENvbnRyaWJ1dGlvbihtc2cuc2VuZGVyLCByZWNpcGllbnQsIG1zZy52YWx1ZSwgCiAgICAgICAgICAgIHRva2VucywgZmFsc2UsIGZhbHNlLCBzdGFnZSk7CiAgICAgICAgY29udHJpYnV0aW9uSGFzaGVzLnB1c2godHJhbnNhY3Rpb25IYXNoKTsKICAgICAgICBDb250cmlidXRpb25SZWNlaXZlZCh0cmFuc2FjdGlvbkhhc2gsIG1zZy5zZW5kZXIsIHJlY2lwaWVudCwgbXNnLnZhbHVlLCB0b2tlbnMpOwogICAgfQoKICAgIC8vQWNjZXB0IGEgY29udHJpYnV0aW9uIGlmIEtZQyBwYXNzZWQuCiAgICBmdW5jdGlvbiBhY2NlcHRDb250cmlidXRpb24oYnl0ZXMzMiB0cmFuc2FjdGlvbkhhc2gpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIENvbnRyaWJ1dGlvbiBzdG9yYWdlIGMgPSBjb250cmlidXRpb25zW3RyYW5zYWN0aW9uSGFzaF07CiAgICAgICAgcmVxdWlyZSghYy5yZXNvbHZlZCk7CiAgICAgICAgYy5yZXNvbHZlZCA9IHRydWU7CiAgICAgICAgYy5zdWNjZXNzID0gdHJ1ZTsKICAgICAgICBiYWxhbmNlc1tjLnJlY2lwaWVudF0gPSBiYWxhbmNlc1tjLnJlY2lwaWVudF0uYWRkKGMudG9rZW5zKTsKICAgICAgICBhc3NlcnQobXVsdGlzaWcuc2VuZChjLmV0aFdlaSkpOwogICAgICAgIFRyYW5zZmVyKHRoaXMsIGMucmVjaXBpZW50LCBjLnRva2Vucyk7CiAgICAgICAgQ29udHJpYnV0aW9uUmVzb2x2ZWQodHJhbnNhY3Rpb25IYXNoLCB0cnVlLCBtc2cuc2VuZGVyLCBjLnJlY2lwaWVudCwgYy5ldGhXZWksIAogICAgICAgICAgICBjLnRva2Vucyk7CiAgICB9CgogICAgLy9SZWplY3QgYSBjb250cmlidXRpb24gaWYgS1lDIGZhaWxlZC4KICAgIGZ1bmN0aW9uIHJlamVjdENvbnRyaWJ1dGlvbihieXRlczMyIHRyYW5zYWN0aW9uSGFzaCkgcHVibGljIG9ubHlPd25lciB7CiAgICAgICAgQ29udHJpYnV0aW9uIHN0b3JhZ2UgYyA9IGNvbnRyaWJ1dGlvbnNbdHJhbnNhY3Rpb25IYXNoXTsKICAgICAgICByZXF1aXJlKCFjLnJlc29sdmVkKTsKICAgICAgICBjLnJlc29sdmVkID0gdHJ1ZTsKICAgICAgICBjLnN1Y2Nlc3MgPSBmYWxzZTsKICAgICAgICBpZiAoYy5zdGFnZSA9PSAwKSB7CiAgICAgICAgICAgIHByZXNhbGVUb2tlblNvbGQgPSBwcmVzYWxlVG9rZW5Tb2xkLnN1YihjLnRva2Vucyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY3Jvd2RzYWxlVG9rZW5Tb2xkID0gY3Jvd2RzYWxlVG9rZW5Tb2xkLnN1YihjLnRva2Vucyk7CiAgICAgICAgfQogICAgICAgIGFzc2VydChjLmNvbnRyaWJ1dG9yLnNlbmQoYy5ldGhXZWkpKTsKICAgICAgICBDb250cmlidXRpb25SZXNvbHZlZCh0cmFuc2FjdGlvbkhhc2gsIGZhbHNlLCBtc2cuc2VuZGVyLCBjLnJlY2lwaWVudCwgYy5ldGhXZWksIAogICAgICAgICAgICBjLnRva2Vucyk7CiAgICB9CgoKICAgIC8vQnVybnMgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIGZyb20gdGhlIHRlYW0gd2FsbGV0IGFkZHJlc3MKICAgIGZ1bmN0aW9uIGJ1cm4odWludDI1NiBfdmFsdWUpIHB1YmxpYyBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5zdWIoX3ZhbHVlKTsKICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBhZGRyZXNzKDApLCBfdmFsdWUpOwogICAgICAgIEJ1cm4obXNnLnNlbmRlciwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvL0FsbG93IHRlYW0gdG8gY2hhbmdlIHRoZSByZWNpcGllbnQgbXVsdGlzaWcgYWRkcmVzcwogICAgZnVuY3Rpb24gc2V0TXVsdGlzaWcoYWRkcmVzcyBhZGRyKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgCXJlcXVpcmUoYWRkciAhPSBhZGRyZXNzKDApKTsKICAgICAgCW11bHRpc2lnID0gYWRkcjsKICAgIH0KCiAgICAvL0FsbG93cyBUZWFtIHRvIGFkanVzdCBhdmVyYWdlIGJsb2NrdGltZSBhY2NvcmRpbmcgdG8gbmV0d29yayBzdGF0dXMsIAogICAgLy9pbiBvcmRlciB0byBwcm92aWRlIG1vcmUgcHJlY2lzZSB0aW1pbmcgZm9yIElDTyBwaGFzZXMgJiBsb2NrLXVwIHBlcmlvZHMKICAgIGZ1bmN0aW9uIHNldEF2ZXJhZ2VCbG9ja1RpbWUodWludDI1NiBuZXdCbG9ja1RpbWUpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUobmV3QmxvY2tUaW1lID4gMCk7CiAgICAgICAgYXZlcmFnZUJsb2NrVGltZSA9IG5ld0Jsb2NrVGltZTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyBjcm93ZHNhbGVUcmFuc2ZlckxvY2sgCiAgICByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyAKICAgIGNyb3dkc2FsZVRyYW5zZmVyTG9jayByZXR1cm5zKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgLy9QcmljZSBvZiB0b2tlbiBpbiB0ZXJtcyBvZiBldGhlci4KICAgIGZ1bmN0aW9uIHRva2VuUHJpY2UoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgdWludDggcCA9IHBoYXNlKCk7CiAgICAgICAgaWYgKHAgPT0gMCkgcmV0dXJuIGJhc2VQcmljZS5tdWwoNDApLmRpdigxMDApOyAvL1ByZXNhbGU6IDYwJSBkaXNjb3VudAogICAgICAgIGlmIChwID09IDEpIHJldHVybiBiYXNlUHJpY2UubXVsKDUwKS5kaXYoMTAwKTsgLy9JQ08gcGhhc2UgMTogNTAlIGRpc2NvdW50CiAgICAgICAgaWYgKHAgPT0gMikgcmV0dXJuIGJhc2VQcmljZS5tdWwoNjApLmRpdigxMDApOyAvL1BoYXNlIDIgOjQwJSBkaXNjb3VudAogICAgICAgIGlmIChwID09IDMpIHJldHVybiBiYXNlUHJpY2UubXVsKDcwKS5kaXYoMTAwKTsgLy9QaGFzZSAzOiAzMCUgZGlzY291bnQKICAgICAgICBpZiAocCA9PSA0KSByZXR1cm4gYmFzZVByaWNlLm11bCg4MCkuZGl2KDEwMCk7IC8vUGhhc2UgNDogMjAlIGRpc2NvdW50CiAgICAgICAgaWYgKHAgPT0gNSkgcmV0dXJuIGJhc2VQcmljZS5tdWwoOTApLmRpdigxMDApOyAvL1BoYXNlIDU6IDEwJSBkaXNjb3VudAogICAgICAgIHJldHVybiBiYXNlUHJpY2U7CiAgICB9CgogICAgZnVuY3Rpb24gcGhhc2UoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDgpIHsKICAgICAgICBpZiAocHJlc2FsZU9uKCkpIHJldHVybiAwOwogICAgICAgIGlmIChjcm93ZHNhbGVUb2tlblNvbGQgPD0gcGhhc2UxQ2FwICYmIGJsb2NrLm51bWJlciA8PSBwaGFzZTFFbmRCbG9jaykgcmV0dXJuIDE7CiAgICAgICAgaWYgKGNyb3dkc2FsZVRva2VuU29sZCA8PSBwaGFzZTJDYXAgJiYgYmxvY2subnVtYmVyIDw9IHBoYXNlMkVuZEJsb2NrKSByZXR1cm4gMjsKICAgICAgICBpZiAoY3Jvd2RzYWxlVG9rZW5Tb2xkIDw9IHBoYXNlM0NhcCAmJiBibG9jay5udW1iZXIgPD0gcGhhc2UzRW5kQmxvY2spIHJldHVybiAzOwogICAgICAgIGlmIChjcm93ZHNhbGVUb2tlblNvbGQgPD0gcGhhc2U0Q2FwICYmIGJsb2NrLm51bWJlciA8PSBwaGFzZTRFbmRCbG9jaykgcmV0dXJuIDQ7CiAgICAgICAgaWYgKGNyb3dkc2FsZVRva2VuU29sZCA8PSBjcm93ZHNhbGVUb2tlblN1cHBseSAmJiBibG9jay5udW1iZXIgPD0gcGhhc2U1RW5kQmxvY2spIHJldHVybiA1OwogICAgICAgIHJldHVybiA2OwogICAgfQoKICAgIGZ1bmN0aW9uIHByZXNhbGVPbigpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIChwcmVzYWxlU3RhcnRlZCAmJiAhcHJlc2FsZUNvbmNsdWRlZCAmJiBwcmVzYWxlVG9rZW5Tb2xkIDwgcHJlc2FsZVRva2VuU3VwcGx5KTsKICAgIH0KCiAgICBmdW5jdGlvbiBjcm93ZHNhbGVPbigpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIChjcm93ZHNhbGVTdGFydGVkICYmIGJsb2NrLm51bWJlciA8PSBlbmRCbG9jayAmJiBjcm93ZHNhbGVUb2tlblNvbGQgPCBjcm93ZHNhbGVUb2tlblN1cHBseSk7CiAgICB9CgogICAgZnVuY3Rpb24gZGF5VG9CbG9ja051bWJlcih1aW50MjU2IGRheU51bSkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludDI1NikgewogICAgICAgIHJldHVybiBkYXlOdW0ubXVsKDg2NDAwKS5kaXYoYXZlcmFnZUJsb2NrVGltZSk7IC8vODY0MDAgPSAyNCo2MCo2MCA9IG51bWJlciBvZiBzZWNvbmRzIGluIGEgZGF5CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0Q29udHJpYnV0aW9uRnJvbUhhc2goYnl0ZXMzMiBjb250cmlidXRpb25IYXNoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoCiAgICAgICAgICAgIGFkZHJlc3MgY29udHJpYnV0b3IsCiAgICAgICAgICAgIGFkZHJlc3MgcmVjaXBpZW50LAogICAgICAgICAgICB1aW50MjU2IGV0aFdlaSwKICAgICAgICAgICAgdWludDI1NiB0b2tlbnMsCiAgICAgICAgICAgIGJvb2wgcmVzb2x2ZWQsCiAgICAgICAgICAgIGJvb2wgc3VjY2VzcwogICAgICAgICkgewogICAgICAgIENvbnRyaWJ1dGlvbiBjID0gY29udHJpYnV0aW9uc1tjb250cmlidXRpb25IYXNoXTsKICAgICAgICBjb250cmlidXRvciA9IGMuY29udHJpYnV0b3I7CiAgICAgICAgcmVjaXBpZW50ID0gYy5yZWNpcGllbnQ7CiAgICAgICAgZXRoV2VpID0gYy5ldGhXZWk7CiAgICAgICAgdG9rZW5zID0gYy50b2tlbnM7CiAgICAgICAgcmVzb2x2ZWQgPSBjLnJlc29sdmVkOwogICAgICAgIHN1Y2Nlc3MgPSBjLnN1Y2Nlc3M7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0Q29udHJpYnV0aW9uSGFzaGVzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJ5dGVzMzJbXSkgewogICAgICAgIHJldHVybiBjb250cmlidXRpb25IYXNoZXM7CiAgICB9Cgp9'.
	

]
