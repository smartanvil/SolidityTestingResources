Class {
	#name : #SRTbed908dc39c34125314f2141079b5ffadb270300,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTbed908dc39c34125314f2141079b5ffadb270300 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IDAuNC4yMTsKCgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgaWYgKGEgPT0gMCkgewogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOwogICAgYXNzZXJ0KGMgLyBhID09IGIpOwogICAgcmV0dXJuIGM7CiAgfQoKICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CgoKCi8qKgogKiBAdGl0bGUgT3duYWJsZQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuCiAqLwpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCgogIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBwcmV2aW91c093bmVyLCBhZGRyZXNzIGluZGV4ZWQgbmV3T3duZXIpOwoKCiAgLyoqCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICogYWNjb3VudC4KICAgKi8KICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIGVtaXQgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsKICAgIG93bmVyID0gbmV3T3duZXI7CiAgfQoKfQoKaW50ZXJmYWNlIFRva2VuIHsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOwogICAgZnVuY3Rpb24gZGVjaW1hbHMoKXB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQ4KTsKICAgIGZ1bmN0aW9uIGJ1cm5BbGxUb2tlbnMoKSBwdWJsaWM7Cn0KCi8qKgogKiBAdGl0bGUgVmF1bHQKICogQGRldiBUaGlzIGNvbnRyYWN0IGlzIHVzZWQgZm9yIHN0b3JpbmcgZnVuZHMgd2hpbGUgYSBjcm93ZHNhbGUKICogaXMgaW4gcHJvZ3Jlc3MuIEZ1bmRzIHdpbGwgYmUgdHJhbnNmZXJyZWQgdG8gb3duZXIgb25jZSBzYWxlIGVuZHMKICovCmNvbnRyYWN0IFZhdWx0IGlzIE93bmFibGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgZW51bSBTdGF0ZSB7IEFjdGl2ZSwgUmVmdW5kaW5nLCBXaXRoZHJhdyB9CgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgZGVwb3NpdGVkOwogICAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0OwogICAgU3RhdGUgcHVibGljIHN0YXRlOwoKICAgIGV2ZW50IFdpdGhkcmF3KCk7CiAgICBldmVudCBSZWZ1bmRzRW5hYmxlZCgpOwogICAgZXZlbnQgV2l0aGRyYXduKGFkZHJlc3MgX3dhbGxldCk7CiAgICBldmVudCBSZWZ1bmRlZChhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgd2VpQW1vdW50KTsKICAgICAgCiAgICBmdW5jdGlvbiBWYXVsdChhZGRyZXNzIF93YWxsZXQpIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShfd2FsbGV0ICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHdhbGxldCA9IF93YWxsZXQ7CiAgICAgICAgc3RhdGUgPSBTdGF0ZS5BY3RpdmU7CiAgICB9CgogICAgZnVuY3Rpb24gZGVwb3NpdChhZGRyZXNzIGludmVzdG9yKSBwdWJsaWMgb25seU93bmVyICBwYXlhYmxlewogICAgICAgIAogICAgICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuQWN0aXZlIHx8IHN0YXRlID09IFN0YXRlLldpdGhkcmF3KTsvL2FsbG93aW5nIHRvIGRlcG9zaXQgZXZlbiBpbiB3aXRoZHJhdyBzdGF0ZSBzaW5jZSB3aXRoZHJhdyBzdGF0ZSB3aWxsIGJlIHN0YXJ0ZWQgb25jZSB0b3RhbEZ1bmRpbmcgcmVhY2hlcyAxMCwwMDAgZXRoZXIKICAgICAgICBkZXBvc2l0ZWRbaW52ZXN0b3JdID0gZGVwb3NpdGVkW2ludmVzdG9yXS5hZGQobXNnLnZhbHVlKTsKICAgICAgICAKICAgIH0KCiAgICBmdW5jdGlvbiBhY3RpdmF0ZVdpdGhkcmF3YWwoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBpZihzdGF0ZSA9PSBTdGF0ZS5BY3RpdmUpewogICAgICAgICAgc3RhdGUgPSBTdGF0ZS5XaXRoZHJhdzsKICAgICAgICAgIGVtaXQgV2l0aGRyYXcoKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIGFjdGl2YXRlUmVmdW5kKClwdWJsaWMgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLkFjdGl2ZSk7CiAgICAgICAgc3RhdGUgPSBTdGF0ZS5SZWZ1bmRpbmc7CiAgICAgICAgZW1pdCBSZWZ1bmRzRW5hYmxlZCgpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB3aXRoZHJhd1RvV2FsbGV0KCkgb25seU93bmVyIHB1YmxpY3sKICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuV2l0aGRyYXcpOwogICAgd2FsbGV0LnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgICBlbWl0IFdpdGhkcmF3bih3YWxsZXQpOwogIH0KICAKICAgZnVuY3Rpb24gcmVmdW5kKGFkZHJlc3MgaW52ZXN0b3IpIHB1YmxpYyB7CiAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLlJlZnVuZGluZyk7CiAgICB1aW50MjU2IGRlcG9zaXRlZFZhbHVlID0gZGVwb3NpdGVkW2ludmVzdG9yXTsKICAgIGRlcG9zaXRlZFtpbnZlc3Rvcl0gPSAwOwogICAgaW52ZXN0b3IudHJhbnNmZXIoZGVwb3NpdGVkVmFsdWUpOwogICAgZW1pdCBSZWZ1bmRlZChpbnZlc3RvciwgZGVwb3NpdGVkVmFsdWUpOwogIH0KICAKIGZ1bmN0aW9uIGlzUmVmdW5kaW5nKClwdWJsaWMgb25seU93bmVyIHZpZXcgcmV0dXJucyhib29sKSB7CiAgICAgcmV0dXJuIChzdGF0ZSA9PSBTdGF0ZS5SZWZ1bmRpbmcpOwogfQp9CgoKY29udHJhY3QgRHJvbmVUb2tlblNhbGUgaXMgT3duYWJsZXsKICAgICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CiAgICAgIAogICAgICAvL1Rva2VuIHRvIGJlIHVzZWQgZm9yIHRoaXMgc2FsZQogICAgICBUb2tlbiBwdWJsaWMgdG9rZW47CiAgICAgIAogICAgICAvL0FsbCBmdW5kcyB3aWxsIGdvIGludG8gdGhpcyB2YXVsdAogICAgICBWYXVsdCBwdWJsaWMgdmF1bHQ7CiAgCiAgICAgIC8vcmF0ZSBvZiB0b2tlbiBpbiBldGhlciAxZXRoID0gMjAwMDAgRFJPTkUKICAgICAgdWludDI1NiBwdWJsaWMgcmF0ZSA9IDIwMDAwOwogICAgICAvKgogICAgICAqVGhlcmUgd2lsbCBiZSA0IHBoYXNlcwogICAgICAqIDEuIFByZS1zYWxlCiAgICAgICogMi4gSUNPIFBoYXNlIDEKICAgICAgKiAzLiBJQ08gUGhhc2UgMgogICAgICAqIDQuIElDTyBQaGFzZSAzCiAgICAgICovCiAgICAgIHN0cnVjdCBQaGFzZUluZm97CiAgICAgICAgICB1aW50MjU2IGhhcmRjYXA7CiAgICAgICAgICB1aW50MjU2IHN0YXJ0VGltZTsKICAgICAgICAgIHVpbnQyNTYgZW5kVGltZTsKICAgICAgICAgIHVpbnQ4IFszXSBib251c1BlcmNlbnRhZ2VzOy8vMyB0eXBlIG9mIGJvbnVzZXMgYWJvdmUgMTAwZXRoLCAxMC0xMDBldGhlciwgbGVzcyB0aGFuIDEwZXRoZXIKICAgICAgICAgIHVpbnQyNTYgd2VpUmFpc2VkOwogICAgICB9CiAgICAgIAogICAgICAvL2luZm8gb2YgZWFjaCBwaGFzZQogICAgICBQaGFzZUluZm9bXSBwdWJsaWMgcGhhc2VzOwogICAgICAKICAgICAgLy9Ub3RhbCBmdW5kaW5nCiAgICAgIHVpbnQyNTYgcHVibGljIHRvdGFsRnVuZGluZzsKICAgICAgCiAgICAgIC8vdG90YWwgdG9rZXNuIGF2YWlsYWJsZSBmb3Igc2FsZQogICAgICB1aW50MjU2IHRva2Vuc0F2YWlsYWJsZUZvclNhbGUgPSAzMDAwMDAwMDAwOwogICAgICAKICAgICAgCiAgICAgIHVpbnQ4IHB1YmxpYyBub09mUGhhc2VzOwogICAgICAKICAgICAgCiAgICAgIC8vS2VlcCB0cmFjayBvZiB3aGV0aGVyIGNvbnRyYWN0IGlzIHVwIG9yIG5vdAogICAgICBib29sIHB1YmxpYyBjb250cmFjdFVwOwogICAgICAKICAgICAgLy9LZWVwIHRyYWNrIG9mIHdoZXRoZXIgdGhlIHNhbGUgaGFzIGVuZGVkIG9yIG5vdAogICAgICBib29sIHB1YmxpYyBzYWxlRW5kZWQ7CiAgICAgIAogICAgICAvL0V2ZW50IHRvIHRyaWdnZXIgU2FsZSBzdG9wCiAgICAgIGV2ZW50IFNhbGVTdG9wcGVkKGFkZHJlc3MgX293bmVyLCB1aW50MjU2IHRpbWUpOwogICAgICAKICAgICAgLy9FdmVudCB0byB0cmlnZ2VyIG5vcm1hbCBmbG93IG9mIHNhbGUgZW5kCiAgICAgIGV2ZW50IEZpbmFsaXplZChhZGRyZXNzIF9vd25lciwgdWludDI1NiB0aW1lKTsKICAgIAogICAgIC8qKgogICAgICogZXZlbnQgZm9yIHRva2VuIHB1cmNoYXNlIGxvZ2dpbmcKICAgICAqIEBwYXJhbSBwdXJjaGFzZXIgd2hvIHBhaWQgZm9yIHRoZSB0b2tlbnMKICAgICAqIEBwYXJhbSBiZW5lZmljaWFyeSB3aG8gZ290IHRoZSB0b2tlbnMKICAgICAqIEBwYXJhbSB2YWx1ZSB3ZWlzIHBhaWQgZm9yIHB1cmNoYXNlCiAgICAgKiBAcGFyYW0gYW1vdW50IGFtb3VudCBvZiB0b2tlbnMgcHVyY2hhc2VkCiAgICAgKi8KICAgICBldmVudCBUb2tlblB1cmNoYXNlKGFkZHJlc3MgaW5kZXhlZCBwdXJjaGFzZXIsIGFkZHJlc3MgaW5kZXhlZCBiZW5lZmljaWFyeSwgdWludDI1NiB2YWx1ZSwgdWludDI1NiBhbW91bnQpOwogICAgCiAgICAvL21vZGlmaWVycyAgICAKICAgIG1vZGlmaWVyIF9jb250cmFjdFVwKCl7CiAgICAgICAgcmVxdWlyZShjb250cmFjdFVwKTsKICAgICAgICBfOwogICAgfQogIAogICAgIG1vZGlmaWVyIG5vblplcm9BZGRyZXNzKGFkZHJlc3MgX3RvKSB7CiAgICAgICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgbW9kaWZpZXIgbWluRXRoQ29udHJpYnV0aW9uKCkgewogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID49IDAuMSBldGhlcik7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgbW9kaWZpZXIgX3NhbGVFbmRlZCgpIHsKICAgICAgICByZXF1aXJlKHNhbGVFbmRlZCk7CiAgICAgICAgXzsKICAgIH0KICAgIAogICAgbW9kaWZpZXIgX3NhbGVOb3RFbmRlZCgpIHsKICAgICAgICByZXF1aXJlKCFzYWxlRW5kZWQpOwogICAgICAgIF87CiAgICB9CiAgCiAgICAKICAgIC8qKgogICAgKiAgICAgQGRldiBDaGVjayBpZiBzYWxlIGNvbnRyYWN0IGhhcyBlbm91Z2ggdG9rZW5zIG9uIGl0cyBhY2NvdW50IGJhbGFuY2UgCiAgICAqICAgICB0byByZXdhcmQgYWxsIHBvc3NpYmxlIHBhcnRpY2lwYXRpb25zIHdpdGhpbiBzYWxlIHBlcmlvZAogICAgKi8KICAgIGZ1bmN0aW9uIHBvd2VyVXBDb250cmFjdCgpIGV4dGVybmFsIG9ubHlPd25lciB7CiAgICAgICAgLy8gQ29udHJhY3Qgc2hvdWxkIG5vdCBiZSBwb3dlcmVkIHVwIHByZXZpb3VzbHkKICAgICAgICByZXF1aXJlKCFjb250cmFjdFVwKTsKCiAgICAgICAgLy8gQ29udHJhY3Qgc2hvdWxkIGhhdmUgZW5vdWdoIERST05FIGNyZWRpdHMKICAgICAgICByZXF1aXJlKHRva2VuLmJhbGFuY2VPZih0aGlzKSA+PSB0b2tlbnNBdmFpbGFibGVGb3JTYWxlKTsKICAgICAgICAKICAgICAgICAKICAgICAgCiAgICAgICAgLy9hY3RpdmF0ZSB0aGUgc2FsZSBwcm9jZXNzCiAgICAgICAgY29udHJhY3RVcCA9IHRydWU7CiAgICB9CiAgICAKICAgIC8vZm9yIEVtZXJnZW5jeS9IYXJkIHN0b3Agb2YgdGhlIHNhbGUKICAgIGZ1bmN0aW9uIGVtZXJnZW5jeVN0b3AoKSBleHRlcm5hbCBvbmx5T3duZXIgX2NvbnRyYWN0VXAgX3NhbGVOb3RFbmRlZHsKICAgICAgICBzYWxlRW5kZWQgPSB0cnVlOyAgICAKICAgICAgICAKICAgICBpZih0b3RhbEZ1bmRpbmcgPCAxMDAwMCBldGhlcil7CiAgICAgICAgICAgIHZhdWx0LmFjdGl2YXRlUmVmdW5kKCk7CiAgICAgICAgfQogICAgICAgIGVsc2V7CiAgICAgICAgICAgIHZhdWx0LmFjdGl2YXRlV2l0aGRyYXdhbCgpOwogICAgICAgIH0KICAgICAgICAKICAgICAgZW1pdCBTYWxlU3RvcHBlZChtc2cuc2VuZGVyLCBub3cpOwogICAgfQogICAgCiAgICAvKioKICAgKiBAZGV2IE11c3QgYmUgY2FsbGVkIGFmdGVyIHNhbGUgZW5kcywgdG8gZG8gc29tZSBleHRyYSBmaW5hbGl6YXRpb24KICAgKiB3b3JrLiBDYWxscyB0aGUgY29udHJhY3QncyBmaW5hbGl6YXRpb24gZnVuY3Rpb24uCiAgICovCiAgICBmdW5jdGlvbiBmaW5hbGl6ZSgpcHVibGljIG9ubHlPd25lciBfY29udHJhY3RVcCBfc2FsZU5vdEVuZGVkewogICAgICAgIHJlcXVpcmUoc2FsZVRpbWVPdmVyKCkpOwogICAgICAgIAogICAgICAgIHNhbGVFbmRlZCA9IHRydWU7CiAgICAgICAgCiAgICAgICAgaWYodG90YWxGdW5kaW5nIDwgMTAwMDAgZXRoZXIpewogICAgICAgICAgICB2YXVsdC5hY3RpdmF0ZVJlZnVuZCgpOwogICAgICAgIH0KICAgICAgICBlbHNlewogICAgICAgICAgICB2YXVsdC5hY3RpdmF0ZVdpdGhkcmF3YWwoKTsKICAgICAgICB9CiAgICAgICAKICAgICAgIGVtaXQgRmluYWxpemVkKG1zZy5zZW5kZXIsIG5vdyk7CiAgICB9CiAgICAKICAgICAgLy8gQHJldHVybiB0cnVlIGlmIGFsbCB0aGUgdGllcnMgaGFzIGJlZW4gZW5kZWQKICBmdW5jdGlvbiBzYWxlVGltZU92ZXIoKSBwdWJsaWMgdmlldyByZXR1cm5zIChib29sKSB7CiAgICAKICAgIHJldHVybiBub3cgPiBwaGFzZXNbbm9PZlBoYXNlcy0xXS5lbmRUaW1lOwogIH0KICAKICAgIC8vaWYgY3Jvd2RzYWxlcyBpcyBvdmVyLCB0aGUgbW9uZXkgcmFzaWVkIHNob3VsZCBiZSB0cmFuc2ZlcnJlZCB0byB0aGUgd2FsbGV0IGFkZHJlc3MKICBmdW5jdGlvbiB3aXRoZHJhd0Z1bmRzKCkgcHVibGljIG9ubHlPd25lcnsKICAKICAgICAgdmF1bHQud2l0aGRyYXdUb1dhbGxldCgpOwogIH0KICAKICAvL21ldGhvZCB0byByZWZ1bmQgbW9uZXkKICBmdW5jdGlvbiBnZXRSZWZ1bmQoKXB1YmxpYyB7CiAgICAgIAogICAgICB2YXVsdC5yZWZ1bmQobXNnLnNlbmRlcik7CiAgfQogIAogIC8qKgogICogQGRldiBDYW4gYmUgY2FsbGVkIG9ubHkgb25jZS4gVGhlIG1ldGhvZCB0byBhbGxvdyBvd25lciB0byBzZXQgdGllciBpbmZvcm1hdGlvbgogICogQHBhcmFtIF9ub09mUGhhc2VzIFRoZSBpbnRlZ2VyIHRvIHNldCBudW1iZXIgb2YgdGllcnMKICAqIEBwYXJhbSBfc3RhcnRUaW1lcyBUaGUgYXJyYXkgY29udGFpbmluZyBzdGFydCB0aW1lIG9mIGVhY2ggdGllcgogICogQHBhcmFtIF9lbmRUaW1lcyBUaGUgYXJyYXkgY29udGFpbmluZyBlbmQgdGltZSBvZiBlYWNoIHRpZXIKICAqIEBwYXJhbSBfaGFyZENhcHMgVGhlIGFycmF5IGNvbnRhaW5pbmcgaGFyZCBjYXAgZm9yIGVhY2ggdGllcgogICogQHBhcmFtIF9ib251c1BlcmNlbnRhZ2VzIFRoZSBhcnJheSBjb250YWluaW5nIGJvbnVzIHBlcmNlbnRhZ2UgZm9yIGVhY2ggdGllcgogICogVGhlIGFycmF5cyBzaG91bGQgYmUgaW4gc3luYyB3aXRoIGVhY2ggb3RoZXIuIEZvciBlYWNoIGluZGV4IDAgZm9yIGVhY2ggb2YgdGhlIGFycmF5IHNob3VsZCBjb250YWluIGluZm8gYWJvdXQgVGllciAxLCBzaW1pbGFybHkgZm9yIFRpZXIyLCAzIGFuZCA0IC4KICAqIFNhbGVzIGhhcmQgY2FwIHdpbGwgYmUgdGhlIGhhcmQgY2FwIG9mIGxhc3QgdGllcgogICovCiAgZnVuY3Rpb24gc2V0VGllcnNJbmZvKHVpbnQ4IF9ub09mUGhhc2VzLCB1aW50MjU2W10gX3N0YXJ0VGltZXMsIHVpbnQyNTZbXSBfZW5kVGltZXMsIHVpbnQyNTZbXSBfaGFyZENhcHMsIHVpbnQ4WzNdWzRdIF9ib251c1BlcmNlbnRhZ2VzKXByaXZhdGUgewogICAgCiAgICAKICAgIHJlcXVpcmUoX25vT2ZQaGFzZXM9PTQpOwogICAgCiAgICAvL0VhY2ggYXJyYXkgc2hvdWxkIGNvbnRhaW4gaW5mbyBhYm91dCBlYWNoIHRpZXIKICAgIHJlcXVpcmUoX3N0YXJ0VGltZXMubGVuZ3RoID09IF9ub09mUGhhc2VzKTsKICAgIHJlcXVpcmUoX2VuZFRpbWVzLmxlbmd0aD09X25vT2ZQaGFzZXMpOwogICAgcmVxdWlyZShfaGFyZENhcHMubGVuZ3RoPT1fbm9PZlBoYXNlcyk7CiAgICByZXF1aXJlKF9ib251c1BlcmNlbnRhZ2VzLmxlbmd0aD09X25vT2ZQaGFzZXMpOwogICAgCiAgICBub09mUGhhc2VzID0gX25vT2ZQaGFzZXM7CiAgICAKICAgIGZvcih1aW50OCBpPTA7aTxfbm9PZlBoYXNlcztpKyspewogICAgICAgIHJlcXVpcmUoX2hhcmRDYXBzW2ldPjApOwogICAgICAgIHJlcXVpcmUoX2VuZFRpbWVzW2ldPl9zdGFydFRpbWVzW2ldKTsKICAgICAgICBpZihpPjApewogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vc3RhcnQgdGltZSBvZiB0aGlzIHRpZXIgc2hvdWxkIGJlIGdyZWF0ZXIgdGhhbiBwcmV2aW91cyB0aWVyCiAgICAgICAgICAgIHJlcXVpcmUoX3N0YXJ0VGltZXNbaV0gPiBfZW5kVGltZXNbaS0xXSk7CiAgICAgICAgICAgIAogICAgICAgICAgICBwaGFzZXMucHVzaChQaGFzZUluZm8oewogICAgICAgICAgICAgICAgaGFyZGNhcDpfaGFyZENhcHNbaV0sCiAgICAgICAgICAgICAgICBzdGFydFRpbWU6X3N0YXJ0VGltZXNbaV0sCiAgICAgICAgICAgICAgICBlbmRUaW1lOl9lbmRUaW1lc1tpXSwKICAgICAgICAgICAgICAgIGJvbnVzUGVyY2VudGFnZXM6X2JvbnVzUGVyY2VudGFnZXNbaV0sCiAgICAgICAgICAgICAgICB3ZWlSYWlzZWQ6MAogICAgICAgICAgICB9KSk7CiAgICAgICAgfQogICAgICAgIGVsc2V7CiAgICAgICAgICAgIC8vc3RhcnQgdGltZSBvZiB0aWVyMSBzaG91bGQgYmUgZ3JlYXRlciB0aGFuIGN1cnJlbnQgdGltZQogICAgICAgICAgICByZXF1aXJlKF9zdGFydFRpbWVzW2ldPm5vdyk7CiAgICAgICAgICAKICAgICAgICAgICAgcGhhc2VzLnB1c2goUGhhc2VJbmZvKHsKICAgICAgICAgICAgICAgIGhhcmRjYXA6X2hhcmRDYXBzW2ldLAogICAgICAgICAgICAgICAgc3RhcnRUaW1lOl9zdGFydFRpbWVzW2ldLAogICAgICAgICAgICAgICAgZW5kVGltZTpfZW5kVGltZXNbaV0sCiAgICAgICAgICAgICAgICBib251c1BlcmNlbnRhZ2VzOl9ib251c1BlcmNlbnRhZ2VzW2ldLAogICAgICAgICAgICAgICAgd2VpUmFpc2VkOjAKICAgICAgICAgICAgfSkpOwogICAgICAgIH0KICAgIH0KICB9CiAgCiAgCiAgICAvKioKICAgICogQGRldiBDb25zdHJ1Y3RvciBtZXRob2QKICAgICogQHBhcmFtIF90b2tlblRvQmVVc2VkIEFkZHJlc3Mgb2YgdGhlIHRva2VuIHRvIGJlIHVzZWQgZm9yIFNhbGVzCiAgICAqIEBwYXJhbSBfd2FsbGV0IEFkZHJlc3Mgb2YgdGhlIHdhbGxldCB3aGljaCB3aWxsIHJlY2VpdmUgdGhlIGNvbGxlY3RlZCBmdW5kcwogICAgKi8gIAogICAgZnVuY3Rpb24gRHJvbmVUb2tlblNhbGUoYWRkcmVzcyBfdG9rZW5Ub0JlVXNlZCwgYWRkcmVzcyBfd2FsbGV0KXB1YmxpYyBub25aZXJvQWRkcmVzcyhfdG9rZW5Ub0JlVXNlZCkgbm9uWmVyb0FkZHJlc3MoX3dhbGxldCl7CiAgICAgICAgCiAgICAgICAgdG9rZW4gPSBUb2tlbihfdG9rZW5Ub0JlVXNlZCk7CiAgICAgICAgdmF1bHQgPSBuZXcgVmF1bHQoX3dhbGxldCk7CiAgICAgICAgCiAgICAgICAgdWludDI1NltdIG1lbW9yeSBzdGFydFRpbWVzID0gbmV3IHVpbnQyNTZbXSg0KTsKICAgICAgICB1aW50MjU2W10gbWVtb3J5IGVuZFRpbWVzID0gbmV3IHVpbnQyNTZbXSg0KTsKICAgICAgICB1aW50MjU2W10gbWVtb3J5IGhhcmRDYXBzID0gbmV3IHVpbnQyNTZbXSg0KTsKICAgICAgICB1aW50OFszXSBbNF0gbWVtb3J5IGJvbnVzUGVyY2VudGFnZXM7CiAgICAgICAgCiAgICAgICAgLy9wcmUtc2FsZXMKICAgICAgICBzdGFydFRpbWVzWzBdID0gMTUyMjMyMTIwMDsgLy9NQVJDSCAyOSwgMjAxOCAxMTowMCBBTSBHTVQKICAgICAgICBlbmRUaW1lc1swXSA9IDE1MjM3OTAwMDA7IC8vQVBSSUwgMTUsIDIwMTggMTE6MDAgQU0gR01UCiAgICAgICAgaGFyZENhcHNbMF0gPSAxMDAwMCBldGhlcjsKICAgICAgICBib251c1BlcmNlbnRhZ2VzWzBdWzBdID0gMzU7CiAgICAgICAgYm9udXNQZXJjZW50YWdlc1swXVsxXSA9IDMwOwogICAgICAgIGJvbnVzUGVyY2VudGFnZXNbMF1bMl0gPSAyNTsKICAgICAgICAKICAgICAgICAvL3BoYXNlLTEKICAgICAgICBzdGFydFRpbWVzWzFdID0gMTUyNTE3MjQ2MDsgLy9NQVkgMDEsIDIwMTggMTE6MDEgQU0gR01UIAogICAgICAgIGVuZFRpbWVzWzFdID0gMTUyNjM4MjAwMDsgLy9NQVkgMTUsIDIwMTggMTE6MDAgQU0gR01UCiAgICAgICAgaGFyZENhcHNbMV0gPSAyMDAwMCBldGhlcjsKICAgICAgICBib251c1BlcmNlbnRhZ2VzWzFdWzBdID0gMjU7Ly8gYWJvdmUgMTAwIGV0aGVyCiAgICAgICAgYm9udXNQZXJjZW50YWdlc1sxXVsxXSA9IDIwOy8vIDEwPD14PD0xMDAKICAgICAgICBib251c1BlcmNlbnRhZ2VzWzFdWzJdID0gMTU7Ly8gbGVzcyB0aGFuIDEwIGV0aGVyCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgLy9waGFzZS0yCiAgICAgICAgc3RhcnRUaW1lc1syXSA9IDE1MjYzODIwNjA7IC8vTUFZIDE1LCAyMDE4IDExOjAxIEFNIEdNVAogICAgICAgIGVuZFRpbWVzWzJdID0gMTUyNzg1MDgwMDsgLy9KVU5FIDAxLCAyMDE4IDExOjAwIEFNIEdNVAogICAgICAgIGhhcmRDYXBzWzJdID0gMzAwMDAgZXRoZXI7CiAgICAgICAgYm9udXNQZXJjZW50YWdlc1syXVswXSA9IDE1OwogICAgICAgIGJvbnVzUGVyY2VudGFnZXNbMl1bMV0gPSAxMDsKICAgICAgICBib251c1BlcmNlbnRhZ2VzWzJdWzJdID0gNTsKICAgICAgICAKICAgICAgICAvL3BoYXNlLTMKICAgICAgICBzdGFydFRpbWVzWzNdID0gMTUyNzg1MDg2MDsgLy9KVU5FIDAxLCAyMDE4IDExOjAxIEFNIEdNVAogICAgICAgIGVuZFRpbWVzWzNdID0gMTUzMzAzNDgwMDsgLy9KVUxZIDMxLCAyMDE4IDExOk9PIEFNIEdNVAogICAgICAgIGhhcmRDYXBzWzNdID0gNzUwMDAgZXRoZXI7CiAgICAgICAgYm9udXNQZXJjZW50YWdlc1szXVswXSA9IDA7CiAgICAgICAgYm9udXNQZXJjZW50YWdlc1szXVsxXSA9IDA7CiAgICAgICAgYm9udXNQZXJjZW50YWdlc1szXVsyXSA9IDA7CgogICAgICAgIHNldFRpZXJzSW5mbyg0LCBzdGFydFRpbWVzLCBlbmRUaW1lcywgaGFyZENhcHMsIGJvbnVzUGVyY2VudGFnZXMpOwogICAgICAgIAogICAgfQogICAgCgogICAvL0ZhbGxiYWNrIGZ1bmN0aW9uIHVzZWQgdG8gYnV5dG9rZW5zCiAgIGZ1bmN0aW9uKClwdWJsaWMgcGF5YWJsZXsKICAgICAgIGJ1eVRva2Vucyhtc2cuc2VuZGVyKTsKICAgfQogICAKICAgLyoqCiAgICogQGRldiBMb3cgbGV2ZWwgdG9rZW4gcHVyY2hhc2UgZnVuY3Rpb24KICAgKiBAcGFyYW0gYmVuZWZpY2lhcnkgVGhlIGFkZHJlc3Mgd2hvIHdpbGwgcmVjZWl2ZSB0aGUgdG9rZW5zIGZvciB0aGlzIHRyYW5zYWN0aW9uCiAgICovCiAgIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KXB1YmxpYyBfY29udHJhY3RVcCBfc2FsZU5vdEVuZGVkIG1pbkV0aENvbnRyaWJ1dGlvbiBub25aZXJvQWRkcmVzcyhiZW5lZmljaWFyeSkgcGF5YWJsZSByZXR1cm5zKGJvb2wpewogICAgICAgCiAgICAgICBpbnQ4IGN1cnJlbnRQaGFzZUluZGV4ID0gZ2V0Q3VycmVudGx5UnVubmluZ1BoYXNlKCk7CiAgICAgICBhc3NlcnQoY3VycmVudFBoYXNlSW5kZXg+PTApOwogICAgICAgCiAgICAgICAgLy8gcmVjaGVjayB0aGlzIGZvciBzdG9yYWdlIGFuZCBtZW1vcnkKICAgICAgIFBoYXNlSW5mbyBzdG9yYWdlIGN1cnJlbnRseVJ1bm5pbmdQaGFzZSA9IHBoYXNlc1t1aW50MjU2KGN1cnJlbnRQaGFzZUluZGV4KV07CiAgICAgICAKICAgICAgIAogICAgICAgdWludDI1NiB3ZWlBbW91bnQgPSBtc2cudmFsdWU7CgogICAgICAgLy9DaGVjayBoYXJkIGNhcCBmb3IgdGhpcyBwaGFzZSBoYXMgbm90IGJlZW4gcmVhY2hlZAogICAgICAgcmVxdWlyZSh3ZWlBbW91bnQuYWRkKGN1cnJlbnRseVJ1bm5pbmdQaGFzZS53ZWlSYWlzZWQpIDw9IGN1cnJlbnRseVJ1bm5pbmdQaGFzZS5oYXJkY2FwKTsKICAgICAgIAogICAgICAgCiAgICAgICB1aW50MjU2IHRva2VucyA9IHdlaUFtb3VudC5tdWwocmF0ZSkuZGl2KDEwMDAwMDAwMDAwMDAwMDAwMDApOy8vY29uc2lkZXJpbmcgZGVjaW1hbCBwbGFjZXMgdG8gYmUgemVybyBmb3IgdG9rZW4KICAgICAgIAogICAgICAgdWludDI1NiBib251c2VkVG9rZW5zID0gYXBwbHlCb251cyh0b2tlbnMsIGN1cnJlbnRseVJ1bm5pbmdQaGFzZS5ib251c1BlcmNlbnRhZ2VzLCB3ZWlBbW91bnQpOwogICAgICAgCiAgICAgIAogICAgICAgCiAgICAgIAogICAgICAgdG90YWxGdW5kaW5nID0gdG90YWxGdW5kaW5nLmFkZCh3ZWlBbW91bnQpOwogICAgICAgCiAgICAgICBjdXJyZW50bHlSdW5uaW5nUGhhc2Uud2VpUmFpc2VkID0gY3VycmVudGx5UnVubmluZ1BoYXNlLndlaVJhaXNlZC5hZGQod2VpQW1vdW50KTsKICAgICAgIAogICAgICAgdmF1bHQuZGVwb3NpdC52YWx1ZShtc2cudmFsdWUpKG1zZy5zZW5kZXIpOwogICAgICAgCiAgICAgICB0b2tlbi50cmFuc2ZlcihiZW5lZmljaWFyeSwgYm9udXNlZFRva2Vucyk7CiAgICAgICAKICAgICAgIGVtaXQgVG9rZW5QdXJjaGFzZShtc2cuc2VuZGVyLCBiZW5lZmljaWFyeSwgd2VpQW1vdW50LCBib251c2VkVG9rZW5zKTsKCiAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgIAogICB9CiAgIAogICAgLyoqCiAgICAqQGRldiBNZXRob2QgdG8gY2FsY3VsYXRlIGJvbnVzIGZvciB0aGUgdXNlciBhcyBwZXIgY3VycmVudGx5IHJ1bm5pbmcgcGhhc2UgYW5kIGNvbnRyaWJ1dGlvbiBieSB0aGUgdXNlcgogICAgKiBAcGFyYW0gdG9rZW5zIFRvdGFsIHRva2VucyBwdXJjaGFzZWQgYnkgdGhlIHVzZXIKICAgICogQHBhcmFtIHBlcmNlbnRhZ2VzIEFycmF5IG9mIGJvbnVzIHBlcmNlbnRhZ2VzIGZvciB0aGUgcGhhc2UgYXMgcGVyIGV0aGVycyBzZW50CiAgICAqIEBwYXJhbSB3ZWlTZW50IEFtb3VudCBvZiBldGhlcnMoaW4gZm9ybSBvZiB3ZWkpIHNlbnQgYnkgdGhlIHVzZXIKICAgICovCiAgICAgZnVuY3Rpb24gYXBwbHlCb251cyh1aW50MjU2IHRva2VucywgdWludDggWzNdcGVyY2VudGFnZXMsIHVpbnQyNTYgd2VpU2VudCkgcHJpdmF0ZSBwdXJlIHJldHVybnMgICh1aW50MjU2KSB7CiAgICAgICAgIAogICAgICAgICB1aW50MjU2IHRva2Vuc1RvQWRkID0gMDsKICAgICAgICAgCiAgICAgICAgIGlmKHdlaVNlbnQ8MTAgZXRoZXIpewogICAgICAgICAgICAgdG9rZW5zVG9BZGQgPSB0b2tlbnMubXVsKHBlcmNlbnRhZ2VzWzJdKS5kaXYoMTAwKTsKICAgICAgICAgfQogICAgICAgICBlbHNlIGlmKHdlaVNlbnQ+PTEwIGV0aGVyICYmIHdlaVNlbnQ8PTEwMCBldGhlcil7CiAgICAgICAgICAgICAgdG9rZW5zVG9BZGQgPSB0b2tlbnMubXVsKHBlcmNlbnRhZ2VzWzFdKS5kaXYoMTAwKTsKICAgICAgICAgfQogICAgICAgICAKICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICB0b2tlbnNUb0FkZCA9IHRva2Vucy5tdWwocGVyY2VudGFnZXNbMF0pLmRpdigxMDApOwogICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmV0dXJuIHRva2Vucy5hZGQodG9rZW5zVG9BZGQpOwogICAgfQogICAgCiAgIC8qKgogICAgKiBAZGV2IHJldHVybnMgdGhlIGN1cnJlbnRseSBydW5uaW5nIHRpZXIgaW5kZXggYXMgcGVyIHRpbWUKICAgICogUmV0dXJuIC0xIGlmIG5vIHRpZXIgaXMgcnVubmluZyBjdXJyZW50bHkKICAgICogKi8KICAgZnVuY3Rpb24gZ2V0Q3VycmVudGx5UnVubmluZ1BoYXNlKClwdWJsaWMgdmlldyByZXR1cm5zKGludDgpewogICAgICBmb3IodWludDggaT0wO2k8bm9PZlBoYXNlcztpKyspewogICAgICAgICAgaWYobm93Pj1waGFzZXNbaV0uc3RhcnRUaW1lICYmIG5vdzw9cGhhc2VzW2ldLmVuZFRpbWUpewogICAgICAgICAgICAgIHJldHVybiBpbnQ4KGkpOwogICAgICAgICAgfQogICAgICB9ICAgCiAgICAgIHJldHVybiAtMTsKICAgfQogICAKICAgCiAgIAogICAvKioKICAgKiBAZGV2IEdldCBmdW5jdGluZyBpbmZvIG9mIHVzZXIvYWRkcmVzcy4gSXQgd2lsbCByZXR1cm4gaG93IG11Y2ggZnVuZGluZyB0aGUgdXNlciBoYXMgbWFkZSBpbiB0ZXJtcyBvZiB3ZWkKICAgKi8KICAgZnVuY3Rpb24gZ2V0RnVuZGluZ0luZm9Gb3JVc2VyKGFkZHJlc3MgX3VzZXIpcHVibGljIHZpZXcgbm9uWmVyb0FkZHJlc3MoX3VzZXIpIHJldHVybnModWludDI1Nil7CiAgICAgICByZXR1cm4gdmF1bHQuZGVwb3NpdGVkKF91c2VyKTsKICAgfQogICAKICAgLyoqCiAgICpAZGV2IE1ldGhvZCB0byBjaGVjayB3aGV0aGVyIHJlZnVuZCBwcm9jZXNzIGhhcyBiZWVuIGluaXRpYXRlZCBvciBub3QgYnkgdGhlIGNvbnRyYWN0LgogICAqLwogICBmdW5jdGlvbiBpc1JlZnVuZGluZygpcHVibGljIHZpZXcgcmV0dXJucyhib29sKSB7CiAgICAgICByZXR1cm4gdmF1bHQuaXNSZWZ1bmRpbmcoKTsKICAgfQogICAKICAgLyoqCiAgICpAZGV2IE1ldGhvZCB0byBidXJuIGFsbCByZW1hbmluaW5nIHRva2VucyBsZWZ0IHdpdGggdGhlIHNhbGVzIGNvbnRyYWN0IGFmdGVyIHRoZSBzYWxlIGhhcyBlbmRlZAogICAqLwogICBmdW5jdGlvbiBidXJuUmVtYWluaW5nVG9rZW5zKClwdWJsaWMgb25seU93bmVyIF9jb250cmFjdFVwIF9zYWxlRW5kZWQgewogICAgICAgCiAgICAgICB0b2tlbi5idXJuQWxsVG9rZW5zKCk7CiAgIH0KICAgCiAgIC8qKgogICAqIEBkZXYgTWV0aG9kIHRvIGFjdGl2YXRlIHdpdGhkcmF3YWwgb2YgZnVuZHMgZXZlbiBpbiBiZXR3ZWVuIG9mIHNhbGUuIFRoZSBXSXRoZHJhd2FsIHdpbGwgb25seSBiZSBhY3RpdmF0ZSBpZmYgdG90YWxGdW5kaW5nIGhhcyByZWFjaGVkIDEwLDAwMCBldGhlcgogICAqLwogICBmdW5jdGlvbiBhY3RpdmF0ZVdpdGhkcmF3YWwoKXB1YmxpYyBvbmx5T3duZXIgX3NhbGVOb3RFbmRlZCBfY29udHJhY3RVcCB7CiAgICAgICAKICAgICAgIHJlcXVpcmUodG90YWxGdW5kaW5nID49IDEwMDAwIGV0aGVyKTsKICAgICAgIHZhdWx0LmFjdGl2YXRlV2l0aGRyYXdhbCgpOwogICAgICAgCiAgIH0KICAgICAgCn0='.
	

]
