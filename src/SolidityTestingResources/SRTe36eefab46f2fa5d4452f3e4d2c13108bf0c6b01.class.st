Class {
	#name : #SRTe36eefab46f2fa5d4452f3e4d2c13108bf0c6b01,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTe36eefab46f2fa5d4452f3e4d2c13108bf0c6b01 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTM7Cgpjb250cmFjdCBDb21tb25zIHsKCiAgICBpbnQyNTYgY29uc3RhbnQgSU5UMjU2X01JTiA9IGludDI1NigodWludDI1NigxKSA8PCAyNTUpKTsKICAgIGludDI1NiBjb25zdGFudCBJTlQyNTZfTUFYID0gaW50MjU2KH4oKHVpbnQyNTYoMSkgPDwgMjU1KSkpOwogICAgdWludDI1NiBjb25zdGFudCBVSU5UMjU2X01JTiA9IDA7CiAgICB1aW50MjU2IGNvbnN0YW50IFVJTlQyNTZfTUFYID0gfnVpbnQyNTYoMCk7CgogICAgc3RydWN0IEluZGV4RWxlbSB7CiAgICAgICAgYnl0ZXMzMiBtYXBwaW5nSWQ7CiAgICAgICAgaW50IG5PcDsKICAgIH0KCiAgICBmdW5jdGlvbiBDb21tb25zKCkgaW50ZXJuYWwgeyB9Cn0KCmNvbnRyYWN0IE93bmFibGUgewoKICAgIGFkZHJlc3MgaW50ZXJuYWwgb3duZXI7CgogICAgZXZlbnQgTG9nVHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBwcmV2aW91c093bmVyLCBhZGRyZXNzIG5ld093bmVyKTsKCiAgICAvKioKICAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyCiAgICAqIGFjY291bnQuCiAgICAqLwogICAgZnVuY3Rpb24gT3duYWJsZSgpIGludGVybmFsCiAgICB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIC8qKgogICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICAqLwogICAgbW9kaWZpZXIgb3duZXJPbmx5KCkKICAgIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogICAgLyoqCiAgICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICAqIEBwYXJhbSBfbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgX25ld093bmVyKSBleHRlcm5hbAogICAgICAgIG93bmVyT25seQogICAgewogICAgICAgIHJlcXVpcmUoX25ld093bmVyICE9IGFkZHJlc3MoMCkpOwogICAgICAgIGVtaXQgTG9nVHJhbnNmZXJPd25lcnNoaXAob3duZXIsIF9uZXdPd25lcik7CiAgICAgICAgb3duZXIgPSBfbmV3T3duZXI7CiAgICB9CgogICAgLyoqCiAgICAgKgogICAgICovCiAgICBmdW5jdGlvbiBnZXRPd25lcigpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYWRkcmVzcykgewogICAgICAgIHJldHVybiBvd25lcjsKICAgIH0KfQoKY29udHJhY3QgQXV0aG9yaXplZCBpcyBPd25hYmxlIHsKCiAgICBzdHJ1Y3QgVXNlciB7CiAgICAgICAgc3RyaW5nIGZyaWVuZGx5TmFtZTsKICAgICAgICBzdHJpbmcgb2ZmQ2hhaW5JZGVudGl0eTsKICAgICAgICBib29sIGlzUmVndWxhdG9yOwogICAgICAgIGJvb2wgaXNQcm9kdWNlcjsKICAgICAgICBib29sIGlzV2luZXJ5OwogICAgfQoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gVXNlcikgcHVibGljIG9uQ2hhaW5JZGVudGl0aWVzOyAgICAKICAgIG1hcHBpbmcgKGJ5dGVzMzIgPT4gYWRkcmVzcykgcHVibGljIG9uQ2hhaW5BZGRyZXNzZXM7CgogICAgZXZlbnQgTG9nU2V0VXNlcgogICAgKAogICAgICAgIGFkZHJlc3MgYWNjb3VudCwgCiAgICAgICAgc3RyaW5nIG9sZEZyaWVuZGx5TmFtZSwgCiAgICAgICAgc3RyaW5nIG9sZE9mZkNoYWluSWRlbnRpdHksIAogICAgICAgIGJvb2wgb2xkSXNQcm9kdWNlciwgCiAgICAgICAgYm9vbCBvbGRJc1dpbmVyeSwgCiAgICAgICAgYm9vbCBvbGRJc1JlZ3VsYXRvciwgCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIG9wZXJhdGlvblNlbmRlcgogICAgKTsKCiAgICBldmVudCBMb2dTZXRXaW5lcnkKICAgICgKICAgICAgICBhZGRyZXNzIHdpbmVyeSwgCiAgICAgICAgYm9vbCBvbGRJc1ZhbGlkLCAKICAgICAgICBib29sIGlzVmFsaWQsIAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBvcGVyYXRpb25TZW5kZXIKICAgICk7CgogICAgZXZlbnQgTG9nU2V0UmVndWxhdG9yCiAgICAoCiAgICAgICAgYWRkcmVzcyByZWd1bGF0b3IsIAogICAgICAgIGJvb2wgb2xkVmFsdWUsIAogICAgICAgIGJvb2wgdmFsdWUsIAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBvcGVyYXRpb25TZW5kZXIKICAgICk7CgogICAgZXZlbnQgTG9nU2V0UHJvZHVjZXIKICAgICgKICAgICAgICBhZGRyZXNzIHByb2R1Y2VyLCAKICAgICAgICBib29sIG9sZFZhbHVlLCAKICAgICAgICBib29sIHZhbHVlLCAKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgb3BlcmF0aW9uU2VuZGVyCiAgICApOwoKICAgIGZ1bmN0aW9uIEF1dGhvcml6ZWQoKSBpbnRlcm5hbCB7IH0KCiAgICBtb2RpZmllciBwcm9kdWNlcnNPbmx5KCkgewogICAgICAgIHJlcXVpcmUob25DaGFpbklkZW50aXRpZXNbbXNnLnNlbmRlcl0uaXNQcm9kdWNlcik7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciB3aW5lcmllc09ubHkoKSB7CiAgICAgICAgcmVxdWlyZShvbkNoYWluSWRlbnRpdGllc1ttc2cuc2VuZGVyXS5pc1dpbmVyeSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBtb2RpZmllciByZWd1bGF0b3JzT25seSgpIHsKICAgICAgICByZXF1aXJlKG9uQ2hhaW5JZGVudGl0aWVzW21zZy5zZW5kZXJdLmlzUmVndWxhdG9yKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFVzZXIoCiAgICAgICAgYWRkcmVzcyBfYWRkcmVzcywKICAgICAgICBzdHJpbmcgX2ZyaWVuZGx5TmFtZSwKICAgICAgICBzdHJpbmcgX29mZkNoYWluSWRlbnRpdHksCiAgICAgICAgYm9vbCBfaXNSZWd1bGF0b3IsCiAgICAgICAgYm9vbCBfaXNQcm9kdWNlciwKICAgICAgICBib29sIF9pc1dpbmVyeQogICAgKSAKICAgICAgICBwdWJsaWMKICAgICAgICBvd25lck9ubHkKICAgIHsKICAgICAgICBlbWl0IExvZ1NldFVzZXIgKAogICAgICAgICAgICBfYWRkcmVzcywgCiAgICAgICAgICAgIG9uQ2hhaW5JZGVudGl0aWVzW19hZGRyZXNzXS5mcmllbmRseU5hbWUsIAogICAgICAgICAgICBvbkNoYWluSWRlbnRpdGllc1tfYWRkcmVzc10ub2ZmQ2hhaW5JZGVudGl0eSwgCiAgICAgICAgICAgIG9uQ2hhaW5JZGVudGl0aWVzW19hZGRyZXNzXS5pc1Byb2R1Y2VyLCAKICAgICAgICAgICAgb25DaGFpbklkZW50aXRpZXNbX2FkZHJlc3NdLmlzV2luZXJ5LCAKICAgICAgICAgICAgb25DaGFpbklkZW50aXRpZXNbX2FkZHJlc3NdLmlzUmVndWxhdG9yLCAKICAgICAgICAgICAgbXNnLnNlbmRlcgogICAgICAgICk7CiAgICAgICAgb25DaGFpbkFkZHJlc3Nlc1trZWNjYWsyNTYoX29mZkNoYWluSWRlbnRpdHkpXSA9IF9hZGRyZXNzOwogICAgICAgIG9uQ2hhaW5JZGVudGl0aWVzW19hZGRyZXNzXS5mcmllbmRseU5hbWUgPSBfZnJpZW5kbHlOYW1lOwogICAgICAgIG9uQ2hhaW5JZGVudGl0aWVzW19hZGRyZXNzXS5vZmZDaGFpbklkZW50aXR5ID0gX29mZkNoYWluSWRlbnRpdHk7CiAgICAgICAgb25DaGFpbklkZW50aXRpZXNbX2FkZHJlc3NdLmlzUmVndWxhdG9yID0gX2lzUmVndWxhdG9yOwogICAgICAgIG9uQ2hhaW5JZGVudGl0aWVzW19hZGRyZXNzXS5pc1Byb2R1Y2VyID0gX2lzUHJvZHVjZXI7CiAgICAgICAgb25DaGFpbklkZW50aXRpZXNbX2FkZHJlc3NdLmlzV2luZXJ5ID0gX2lzV2luZXJ5OwogICAgfQoKICAgIGZ1bmN0aW9uIGdldE9mZkNoYWluSWRlbnRpdHkoYWRkcmVzcyBfYWRkcmVzcykgaW50ZXJuYWwgdmlldyByZXR1cm5zIChzdHJpbmcgb2ZmQ2hhaW5JZGVudGl0eSkKICAgIHsKICAgICAgICByZXR1cm4gb25DaGFpbklkZW50aXRpZXNbX2FkZHJlc3NdLm9mZkNoYWluSWRlbnRpdHk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0VXNlcihhZGRyZXNzIF9hZGRyZXNzKQogICAgICAgIGV4dGVybmFsIHZpZXcKICAgICAgICByZXR1cm5zICgKICAgICAgICAgICAgc3RyaW5nIGZyaWVuZGx5TmFtZSwgCiAgICAgICAgICAgIHN0cmluZyBvZmZDaGFpbklkZW50aXR5LCAKICAgICAgICAgICAgYm9vbCBpc1JlZ3VsYXRvciwgCiAgICAgICAgICAgIGJvb2wgaXNQcm9kdWNlciwgCiAgICAgICAgICAgIGJvb2wgaXNXaW5lcnkKICAgICAgICApIAogICAgewogICAgICAgIHJldHVybiAoCiAgICAgICAgICAgIG9uQ2hhaW5JZGVudGl0aWVzW19hZGRyZXNzXS5mcmllbmRseU5hbWUsCiAgICAgICAgICAgIG9uQ2hhaW5JZGVudGl0aWVzW19hZGRyZXNzXS5vZmZDaGFpbklkZW50aXR5LAogICAgICAgICAgICBvbkNoYWluSWRlbnRpdGllc1tfYWRkcmVzc10uaXNSZWd1bGF0b3IsCiAgICAgICAgICAgIG9uQ2hhaW5JZGVudGl0aWVzW19hZGRyZXNzXS5pc1Byb2R1Y2VyLAogICAgICAgICAgICBvbkNoYWluSWRlbnRpdGllc1tfYWRkcmVzc10uaXNXaW5lcnkKICAgICAgICApOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEFkZHJlc3Moc3RyaW5nIF9vZmZDaGFpbklkZW50aXR5KSBwdWJsaWMgdmlldyByZXR1cm5zIChhZGRyZXNzKSB7CiAgICAgICAgcmV0dXJuIG9uQ2hhaW5BZGRyZXNzZXNba2VjY2FrMjU2KF9vZmZDaGFpbklkZW50aXR5KV07CiAgICB9CgogICAgZnVuY3Rpb24gc2V0UmVndWxhdG9yKGFkZHJlc3MgX2FkZHJlc3MsIGJvb2wgX25ld1ZhbHVlKSBleHRlcm5hbCBvd25lck9ubHkgewogICAgICAgIGVtaXQgTG9nU2V0UmVndWxhdG9yKF9hZGRyZXNzLCBvbkNoYWluSWRlbnRpdGllc1tfYWRkcmVzc10uaXNSZWd1bGF0b3IsIF9uZXdWYWx1ZSwgbXNnLnNlbmRlcik7CiAgICAgICAgb25DaGFpbklkZW50aXRpZXNbX2FkZHJlc3NdLmlzUmVndWxhdG9yID0gX25ld1ZhbHVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFByb2R1Y2VyKGFkZHJlc3MgX2FkZHJlc3MsIGJvb2wgX25ld1ZhbHVlKSBleHRlcm5hbCBvd25lck9ubHkgewogICAgICAgIGVtaXQgTG9nU2V0UHJvZHVjZXIoX2FkZHJlc3MsIG9uQ2hhaW5JZGVudGl0aWVzW19hZGRyZXNzXS5pc1Byb2R1Y2VyLCBfbmV3VmFsdWUsIG1zZy5zZW5kZXIpOwogICAgICAgIG9uQ2hhaW5JZGVudGl0aWVzW19hZGRyZXNzXS5pc1Byb2R1Y2VyID0gX25ld1ZhbHVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFdpbmVyeShhZGRyZXNzIF9hZGRyZXNzLCBib29sIF9uZXdWYWx1ZSkgZXh0ZXJuYWwgb3duZXJPbmx5IHsKICAgICAgICBlbWl0IExvZ1NldFByb2R1Y2VyKF9hZGRyZXNzLCBvbkNoYWluSWRlbnRpdGllc1tfYWRkcmVzc10uaXNXaW5lcnksIF9uZXdWYWx1ZSwgbXNnLnNlbmRlcik7CiAgICAgICAgb25DaGFpbklkZW50aXRpZXNbX2FkZHJlc3NdLmlzV2luZXJ5ID0gX25ld1ZhbHVlOwogICAgfQoKfQoKY29udHJhY3QgV2luZXJ5T3BlcmF0aW9ucyBpcyBDb21tb25zLCBBdXRob3JpemVkIHsKCiAgICB1aW50MjU2IGNvbnN0YW50IE9QRVJBVElPTl9TRUFSQ0hfTUFYID0gdWludChJTlQyNTZfTUFYKTsKCiAgICBzdHJ1Y3QgV2luZXJ5T3BlcmF0aW9uIHsKICAgICAgICBhZGRyZXNzIG9wZXJhdGlvblNlbmRlcjsKICAgICAgICBzdHJpbmcgb2ZmQ2hhaW5JZGVudGl0eTsgICAvL2N1YWEKICAgICAgICBzdHJpbmcgb3BlcmF0aW9uSUQ7ICAgICAgICAvLyBoYXNoIChvZmZDaGFpbklkZW50aXR5LCBvcGVyYXRpb25EYXRlLCBvcGVyYXRpb25Db2RlKQogICAgICAgIHN0cmluZyBvcGVyYXRpb25Db2RlOyAgICAgIC8vRXMuIElNQk8KICAgICAgICB1aW50IG9wZXJhdGlvbkRhdGU7CiAgICAgICAgdWludDE2IGFyZWFDb2RlOyAgICAgICAgICAgLy8gbWFwcGluZwogICAgICAgIHN0cmluZyBjb2RlSUNRUkY7ICAgICAgICAgIC8vIGNvZGljZV9pY3FyZl9zdGFiaWxpbWVudG8KICAgICAgICBzdHJpbmcgYXR0cmlidXRlczsKICAgICAgICBQcm9kdWN0W10gcHJvZHM7CiAgICAgICAgSW5kZXhFbGVtW10gcGFyZW50TGlzdDsKICAgICAgICBJbmRleEVsZW1bXSBjaGlsZExpc3Q7ICAgICAgICAKICAgIH0KCiAgICBzdHJ1Y3QgUHJvZHVjdCB7CiAgICAgICAgc3RyaW5nIHByb2R1Y3RJRDsgICAgICAvLyBjb2RpY2VfcHJpbWFyaW8gKyBjb2RpY2Vfc2Vjb25kYXJpbwogICAgICAgIHN0cmluZyBxdWFudGl0eTsgICAgICAgIC8vIDEsMzQ1IGtnCiAgICAgICAgc3RyaW5nIGF0dHJpYnV0ZXM7ICAgICAgLy8gZHNkYTsgZGFzZDs7IHNhZGFzOwogICAgfQoKICAgIG1hcHBpbmcoYnl0ZXMzMiA9PiBXaW5lcnlPcGVyYXRpb25bXSkgcHVibGljIHdpbmVyaWVzOwoKICAgIGV2ZW50IExvZ0FkZFdpbmVyeU9wZXJhdGlvbigKICAgICAgICBzdHJpbmcgX3RyYWNrSUQsCiAgICAgICAgYWRkcmVzcyBvcGVyYXRpb25TZW5kZXIsCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIG9uQ2hhaW5JZGVudGl0eSwKICAgICAgICBzdHJpbmcgb3BlcmF0aW9uSUQsICAgICAgCiAgICAgICAgdWludCBpbmRleAogICAgKTsKCiAgICBldmVudCBMb2dBZGRQcm9kdWN0KAogICAgICAgIHN0cmluZyBfdHJhY2tJRCwKICAgICAgICBhZGRyZXNzIG9wZXJhdGlvblNlbmRlciwKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgb25DaGFpbklkZW50aXR5LAogICAgICAgIHN0cmluZyBpbmRleGVkIG9wZXJhdGlvbklELAogICAgICAgIHN0cmluZyBwcm9kdWN0SUQKICAgICk7CgogICAgZnVuY3Rpb24gV2luZXJ5T3BlcmF0aW9ucygpIGludGVybmFsIHsgfQogICAgCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgLy8gRXh0ZXJuYWwgZnVuY3Rpb25zIGZvciB3aW5lcmllcwogICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCiAgICBmdW5jdGlvbiBhZGRXaW5lcnlPcGVyYXRpb24oCiAgICAgICAgc3RyaW5nIF90cmFja0lELAogICAgICAgIHN0cmluZyBfb3BlcmF0aW9uSUQsCiAgICAgICAgc3RyaW5nIF9vcGVyYXRpb25Db2RlLAogICAgICAgIHVpbnQgX29wZXJhdGlvbkRhdGUsCiAgICAgICAgdWludDE2IF9hcmVhQ29kZSwKICAgICAgICBzdHJpbmcgX2NvZGVJQ1FSRgogICAgKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgd2luZXJpZXNPbmx5CiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKQogICAgewogICAgICAgIGJ5dGVzMzIgX21hcHBpbmdJRCA9IGtlY2NhazI1NihfdHJhY2tJRCwgbXNnLnNlbmRlcik7CiAgICAgICAgYWRkV2luZXJ5T3BlcmF0aW9uKAogICAgICAgICAgICBfbWFwcGluZ0lELAogICAgICAgICAgICBtc2cuc2VuZGVyLAogICAgICAgICAgICBvbkNoYWluSWRlbnRpdGllc1ttc2cuc2VuZGVyXS5vZmZDaGFpbklkZW50aXR5LAogICAgICAgICAgICBfb3BlcmF0aW9uSUQsCiAgICAgICAgICAgIF9vcGVyYXRpb25Db2RlLAogICAgICAgICAgICBfb3BlcmF0aW9uRGF0ZSwKICAgICAgICAgICAgX2FyZWFDb2RlLAogICAgICAgICAgICBfY29kZUlDUVJGCiAgICAgICAgKTsKICAgICAgICBlbWl0IExvZ0FkZFdpbmVyeU9wZXJhdGlvbigKICAgICAgICAgICAgX3RyYWNrSUQsCiAgICAgICAgICAgIG1zZy5zZW5kZXIsCiAgICAgICAgICAgIG1zZy5zZW5kZXIsCiAgICAgICAgICAgIF9vcGVyYXRpb25JRCwKICAgICAgICAgICAgd2luZXJpZXNbX21hcHBpbmdJRF0ubGVuZ3RoCiAgICAgICAgKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRQcm9kdWN0KAogICAgICAgIHN0cmluZyBfdHJhY2tJRCwKICAgICAgICB1aW50IF9pbmRleCwKICAgICAgICBzdHJpbmcgX3Byb2R1Y3RJRCwKICAgICAgICBzdHJpbmcgX3F1YW50aXR5LAogICAgICAgIHN0cmluZyBfYXR0cmlidXRlcwogICAgKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgd2luZXJpZXNPbmx5CiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKQogICAgewogICAgICAgIGJ5dGVzMzIgX21hcHBpbmdJRCA9IGtlY2NhazI1NihfdHJhY2tJRCwgbXNnLnNlbmRlcik7CiAgICAgICAgYWRkUHJvZHVjdCgKICAgICAgICAgICAgX21hcHBpbmdJRCwKICAgICAgICAgICAgX2luZGV4LAogICAgICAgICAgICBfcHJvZHVjdElELAogICAgICAgICAgICBfcXVhbnRpdHksCiAgICAgICAgICAgIF9hdHRyaWJ1dGVzCiAgICAgICAgKTsKICAgICAgICBlbWl0IExvZ0FkZFByb2R1Y3QoCiAgICAgICAgICAgIF90cmFja0lELAogICAgICAgICAgICBtc2cuc2VuZGVyLAogICAgICAgICAgICBtc2cuc2VuZGVyLAogICAgICAgICAgICB3aW5lcmllc1tfbWFwcGluZ0lEXVtfaW5kZXhdLm9wZXJhdGlvbklELAogICAgICAgICAgICBfcHJvZHVjdElECiAgICAgICAgKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRSZWZlcmVuY2VQYXJlbnRXaW5lcnlPcGVyYXRpb24oCiAgICAgICAgc3RyaW5nIF90cmFja0lELAogICAgICAgIHVpbnQgX251bUN1ck9wZXJhdGlvbiwKICAgICAgICBzdHJpbmcgX3BhcmVudFRyYWNrSUQsCiAgICAgICAgYWRkcmVzcyBfcGFyZW50V2luZXJ5LAogICAgICAgIGludCBfbnVtUGFyZW50ICAgICAgICAKICAgICkKICAgICAgICBleHRlcm5hbAogICAgICAgIHdpbmVyaWVzT25seQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICBhZGRSZWxhdGlvbnNoaXBCaW5kaW5nV2luZXJ5T3BlcmF0aW9uKAogICAgICAgICAgICBrZWNjYWsyNTYoX3RyYWNrSUQsIG1zZy5zZW5kZXIpLAogICAgICAgICAgICBfbnVtQ3VyT3BlcmF0aW9uLAogICAgICAgICAgICBrZWNjYWsyNTYoX3BhcmVudFRyYWNrSUQsIF9wYXJlbnRXaW5lcnkpLAogICAgICAgICAgICBfbnVtUGFyZW50CiAgICAgICAgKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRPcGVyYXRpb25BdHRyaWJ1dGVzKAogICAgICAgIHN0cmluZyBfdHJhY2tJRCwKICAgICAgICB1aW50IF9vcGVyYXRpb25JbmRleCwKICAgICAgICBzdHJpbmcgYXR0cmlidXRlcwogICAgKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgd2luZXJpZXNPbmx5CiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKQogICAgewogICAgICAgIGJ5dGVzMzIgX21hcHBpbmdJRCA9IGtlY2NhazI1NihfdHJhY2tJRCwgbXNnLnNlbmRlcik7CiAgICAgICAgd2luZXJpZXNbX21hcHBpbmdJRF1bX29wZXJhdGlvbkluZGV4XS5hdHRyaWJ1dGVzID0gYXR0cmlidXRlczsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRQcm9kdWN0QXR0cmlidXRlcygKICAgICAgICBzdHJpbmcgX3RyYWNrSUQsCiAgICAgICAgdWludCBfb3BlcmF0aW9uSW5kZXgsCiAgICAgICAgdWludCBfcHJvZHVjdEluZGV4LAogICAgICAgIHN0cmluZyBhdHRyaWJ1dGVzCiAgICApCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICB3aW5lcmllc09ubHkKICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpCiAgICB7CiAgICAgICAgYnl0ZXMzMiBfbWFwcGluZ0lEID0ga2VjY2FrMjU2KF90cmFja0lELCBtc2cuc2VuZGVyKTsKICAgICAgICB3aW5lcmllc1tfbWFwcGluZ0lEXVtfb3BlcmF0aW9uSW5kZXhdLnByb2RzW19wcm9kdWN0SW5kZXhdLmF0dHJpYnV0ZXMgPSBhdHRyaWJ1dGVzOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAvLyBFeHRlcm5hbCBmdW5jdGlvbnMgZm9yIHJlZ3VsYXRvcnMKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgogICAgZnVuY3Rpb24gYWRkV2luZXJ5T3BlcmF0aW9uQnlSZWd1bGF0b3IoCiAgICAgICAgc3RyaW5nIF90cmFja0lELAogICAgICAgIHN0cmluZyBfb2ZmQ2hhaW5JZGVudGl0eSwKICAgICAgICBzdHJpbmcgX29wZXJhdGlvbklELAogICAgICAgIHN0cmluZyBfb3BlcmF0aW9uQ29kZSwKICAgICAgICB1aW50IF9vcGVyYXRpb25EYXRlLAogICAgICAgIHVpbnQxNiBfYXJlYUNvZGUsCiAgICAgICAgc3RyaW5nIF9jb2RlSUNRUkYKICAgICkKICAgICAgICBleHRlcm5hbAogICAgICAgIHJlZ3VsYXRvcnNPbmx5CiAgICB7CiAgICAgICAgYWRkcmVzcyBfd2luZXJ5ID0gZ2V0QWRkcmVzcyhfb2ZmQ2hhaW5JZGVudGl0eSk7CiAgICAgICAgYnl0ZXMzMiBfbWFwcGluZ0lEID0ga2VjY2FrMjU2KF90cmFja0lELCBfd2luZXJ5KTsKICAgICAgICBhZGRXaW5lcnlPcGVyYXRpb24oCiAgICAgICAgICAgIF9tYXBwaW5nSUQsCiAgICAgICAgICAgIG1zZy5zZW5kZXIsCiAgICAgICAgICAgIF9vZmZDaGFpbklkZW50aXR5LAogICAgICAgICAgICBfb3BlcmF0aW9uSUQsCiAgICAgICAgICAgIF9vcGVyYXRpb25Db2RlLAogICAgICAgICAgICBfb3BlcmF0aW9uRGF0ZSwKICAgICAgICAgICAgX2FyZWFDb2RlLAogICAgICAgICAgICBfY29kZUlDUVJGCiAgICAgICAgKTsKICAgICAgICBlbWl0IExvZ0FkZFdpbmVyeU9wZXJhdGlvbigKICAgICAgICAgICAgX3RyYWNrSUQsCiAgICAgICAgICAgIG1zZy5zZW5kZXIsCiAgICAgICAgICAgIF93aW5lcnksCiAgICAgICAgICAgIF9vcGVyYXRpb25JRCwKICAgICAgICAgICAgd2luZXJpZXNbX21hcHBpbmdJRF0ubGVuZ3RoCiAgICAgICAgKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gYWRkUHJvZHVjdEJ5UmVndWxhdG9yKAogICAgICAgIHN0cmluZyBfdHJhY2tJRCwKICAgICAgICB1aW50IF9pbmRleCwKICAgICAgICBzdHJpbmcgX29mZkNoYWluSWRlbnRpdHksCiAgICAgICAgc3RyaW5nIF9wcm9kdWN0SUQsCiAgICAgICAgc3RyaW5nIF9xdWFudGl0eSwKICAgICAgICBzdHJpbmcgX2F0dHJpYnV0ZXMKICAgICkKICAgICAgICBleHRlcm5hbAogICAgICAgIHJlZ3VsYXRvcnNPbmx5CiAgICB7CiAgICAgICAgYWRkcmVzcyBfd2luZXJ5ID0gZ2V0QWRkcmVzcyhfb2ZmQ2hhaW5JZGVudGl0eSk7CiAgICAgICAgYnl0ZXMzMiBfbWFwcGluZ0lEID0ga2VjY2FrMjU2KF90cmFja0lELCBfd2luZXJ5KTsKICAgICAgICBhZGRQcm9kdWN0KAogICAgICAgICAgICBfbWFwcGluZ0lELAogICAgICAgICAgICBfaW5kZXgsCiAgICAgICAgICAgIF9wcm9kdWN0SUQsCiAgICAgICAgICAgIF9xdWFudGl0eSwKICAgICAgICAgICAgX2F0dHJpYnV0ZXMKICAgICAgICApOwogICAgICAgIGVtaXQgTG9nQWRkUHJvZHVjdCgKICAgICAgICAgICAgX3RyYWNrSUQsCiAgICAgICAgICAgIG1zZy5zZW5kZXIsCiAgICAgICAgICAgIF93aW5lcnksCiAgICAgICAgICAgIHdpbmVyaWVzW19tYXBwaW5nSURdW19pbmRleF0ub3BlcmF0aW9uSUQsCiAgICAgICAgICAgIF9wcm9kdWN0SUQKICAgICAgICApOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldE9wZXJhdGlvbkF0dHJpYnV0ZXNCeVJlZ3VsYXRvcigKICAgICAgICBzdHJpbmcgX3RyYWNrSUQsCiAgICAgICAgc3RyaW5nIF9vZmZDaGFpbklkZW50aXR5LAogICAgICAgIHVpbnQgX29wZXJhdGlvbkluZGV4LAogICAgICAgIHN0cmluZyBhdHRyaWJ1dGVzCiAgICApCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICByZWd1bGF0b3JzT25seQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsgICAgIAogICAgICAgIGFkZHJlc3MgX3dpbmVyeSA9IGdldEFkZHJlc3MoX29mZkNoYWluSWRlbnRpdHkpOwogICAgICAgIGJ5dGVzMzIgX21hcHBpbmdJRCA9IGtlY2NhazI1NihfdHJhY2tJRCwgX3dpbmVyeSk7CiAgICAgICAgd2luZXJpZXNbX21hcHBpbmdJRF1bX29wZXJhdGlvbkluZGV4XS5hdHRyaWJ1dGVzID0gYXR0cmlidXRlczsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRQcm9kdWN0QXR0cmlidXRlc0J5UmVndWxhdG9yKAogICAgICAgIHN0cmluZyBfdHJhY2tJRCwKICAgICAgICBzdHJpbmcgX29mZkNoYWluSWRlbnRpdHksCiAgICAgICAgdWludCBfb3BlcmF0aW9uSW5kZXgsCiAgICAgICAgdWludCBfcHJvZHVjdEluZGV4LAogICAgICAgIHN0cmluZyBhdHRyaWJ1dGVzCiAgICApCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICByZWd1bGF0b3JzT25seQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICBhZGRyZXNzIF93aW5lcnkgPSBnZXRBZGRyZXNzKF9vZmZDaGFpbklkZW50aXR5KTsKICAgICAgICBieXRlczMyIF9tYXBwaW5nSUQgPSBrZWNjYWsyNTYoX3RyYWNrSUQsIF93aW5lcnkpOwogICAgICAgIHdpbmVyaWVzW19tYXBwaW5nSURdW19vcGVyYXRpb25JbmRleF0ucHJvZHNbX3Byb2R1Y3RJbmRleF0uYXR0cmlidXRlcyA9IGF0dHJpYnV0ZXM7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkUmVmZXJlbmNlUGFyZW50V2luZXJ5T3BlcmF0aW9uQnlSZWd1bGF0b3IoCiAgICAgICAgc3RyaW5nIF90cmFja0lELAogICAgICAgIHN0cmluZyBfb2ZmQ2hhaW5JZGVudGl0eSwKICAgICAgICB1aW50IF9udW1DdXJPcGVyYXRpb24sCiAgICAgICAgc3RyaW5nIF9wYXJlbnRUcmFja0lELAogICAgICAgIHN0cmluZyBfcGFyZW50T2ZmQ2hhaW5JZGVudGl0eSwKICAgICAgICBpbnQgX251bVBhcmVudCAgICAgICAgCiAgICApCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICByZWd1bGF0b3JzT25seQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICBhZGRyZXNzIF93aW5lcnkgPSBnZXRBZGRyZXNzKF9vZmZDaGFpbklkZW50aXR5KTsKICAgICAgICBhZGRyZXNzIF9wYXJlbnRXaW5lcnkgPSBnZXRBZGRyZXNzKF9wYXJlbnRPZmZDaGFpbklkZW50aXR5KTsKICAgICAgICBhZGRSZWxhdGlvbnNoaXBCaW5kaW5nV2luZXJ5T3BlcmF0aW9uKAogICAgICAgICAgICBrZWNjYWsyNTYoX3RyYWNrSUQsIF93aW5lcnkpLAogICAgICAgICAgICBfbnVtQ3VyT3BlcmF0aW9uLAogICAgICAgICAgICBrZWNjYWsyNTYoX3BhcmVudFRyYWNrSUQsIF9wYXJlbnRXaW5lcnkpLAogICAgICAgICAgICBfbnVtUGFyZW50CiAgICAgICAgKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgLy8gSGVscGVycyBmb3IgJiMyMDg7QXBwcwogICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIAogICAgLy8vIEBub3RpY2UgKioqKgogICAgZnVuY3Rpb24gZ2V0V2luZXJ5T3BlcmF0aW9uKHN0cmluZyBfdHJhY2tJRCwgYWRkcmVzcyBfd2luZXJ5LCB1aW50IF9pbmRleCkKICAgICAgICBleHRlcm5hbCB2aWV3CiAgICAgICAgcmV0dXJucyAoCiAgICAgICAgICAgIGFkZHJlc3Mgb3BlcmF0aW9uU2VuZGVyLAogICAgICAgICAgICBzdHJpbmcgb2ZmQ2hhaW5JZGVudGl0eSwKICAgICAgICAgICAgc3RyaW5nIG9wZXJhdGlvbklELAogICAgICAgICAgICBzdHJpbmcgb3BlcmF0aW9uQ29kZSwKICAgICAgICAgICAgdWludCBvcGVyYXRpb25EYXRlLAogICAgICAgICAgICB1aW50MTYgYXJlYUNvZGUsCiAgICAgICAgICAgIHN0cmluZyBjb2RlSUNRUkYsCiAgICAgICAgICAgIHN0cmluZyBhdHRyaWJ1dGVzCiAgICAgICAgKQogICAgewogICAgICAgIGJ5dGVzMzIgX21hcHBpbmdJRCA9IGtlY2NhazI1NihfdHJhY2tJRCwgX3dpbmVyeSk7CiAgICAgICAgb3BlcmF0aW9uU2VuZGVyID0gd2luZXJpZXNbX21hcHBpbmdJRF1bX2luZGV4XS5vcGVyYXRpb25TZW5kZXI7CiAgICAgICAgb2ZmQ2hhaW5JZGVudGl0eSA9IHdpbmVyaWVzW19tYXBwaW5nSURdW19pbmRleF0ub2ZmQ2hhaW5JZGVudGl0eTsKICAgICAgICBvcGVyYXRpb25JRCA9IHdpbmVyaWVzW19tYXBwaW5nSURdW19pbmRleF0ub3BlcmF0aW9uSUQ7CiAgICAgICAgb3BlcmF0aW9uQ29kZSA9IHdpbmVyaWVzW19tYXBwaW5nSURdW19pbmRleF0ub3BlcmF0aW9uQ29kZTsKICAgICAgICBvcGVyYXRpb25EYXRlID0gd2luZXJpZXNbX21hcHBpbmdJRF1bX2luZGV4XS5vcGVyYXRpb25EYXRlOwogICAgICAgIGFyZWFDb2RlID0gd2luZXJpZXNbX21hcHBpbmdJRF1bX2luZGV4XS5hcmVhQ29kZTsKICAgICAgICBjb2RlSUNRUkYgPSB3aW5lcmllc1tfbWFwcGluZ0lEXVtfaW5kZXhdLmNvZGVJQ1FSRjsKICAgICAgICBhdHRyaWJ1dGVzID0gd2luZXJpZXNbX21hcHBpbmdJRF1bX2luZGV4XS5hdHRyaWJ1dGVzOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFByb2R1Y3RPcGVyYXRpb24oc3RyaW5nIF90cmFja0lELCBhZGRyZXNzIF93aW5lcnksIHVpbnQgX2luZGV4LCB1aW50IF9wcm9kdWN0SW5kZXgpCiAgICAgICAgZXh0ZXJuYWwgdmlldwogICAgICAgIHJldHVybnMgKAogICAgICAgICAgICBzdHJpbmcgcHJvZHVjdElELAogICAgICAgICAgICBzdHJpbmcgcXVhbnRpdHksCiAgICAgICAgICAgIHN0cmluZyBhdHRyaWJ1dGVzCiAgICAgICAgKQogICAgewogICAgICAgIGJ5dGVzMzIgX21hcHBpbmdJRCA9IGtlY2NhazI1NihfdHJhY2tJRCwgX3dpbmVyeSk7CiAgICAgICAgcHJvZHVjdElEID0gd2luZXJpZXNbX21hcHBpbmdJRF1bX2luZGV4XS5wcm9kc1tfcHJvZHVjdEluZGV4XS5wcm9kdWN0SUQ7CiAgICAgICAgcXVhbnRpdHkgPSB3aW5lcmllc1tfbWFwcGluZ0lEXVtfaW5kZXhdLnByb2RzW19wcm9kdWN0SW5kZXhdLnF1YW50aXR5OwogICAgICAgIGF0dHJpYnV0ZXMgPSB3aW5lcmllc1tfbWFwcGluZ0lEXVtfaW5kZXhdLnByb2RzW19wcm9kdWN0SW5kZXhdLmF0dHJpYnV0ZXM7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0TnVtUG9zaXRpb25PcGVyYXRpb24oc3RyaW5nIF90cmFja0lELCBhZGRyZXNzIF93aW5lcnksIHN0cmluZyBfb3BlcmF0aW9uSUQpCiAgICAgICAgZXh0ZXJuYWwgdmlldwogICAgICAgIHJldHVybnMgKGludCBwb3NpdGlvbikKICAgIHsKICAgICAgICBieXRlczMyIF9tYXBwaW5nSUQgPSBrZWNjYWsyNTYoX3RyYWNrSUQsIF93aW5lcnkpOwogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IHdpbmVyaWVzW19tYXBwaW5nSURdLmxlbmd0aCAmJiBpIDwgT1BFUkFUSU9OX1NFQVJDSF9NQVg7IGkrKykgewogICAgICAgICAgICBpZiAoa2VjY2FrMjU2KHdpbmVyaWVzW19tYXBwaW5nSURdW2ldLm9wZXJhdGlvbklEKSA9PSBrZWNjYWsyNTYoX29wZXJhdGlvbklEKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGludChpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gLTE7CiAgICB9CgogICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIC8vIFByaXZhdGUgZnVuY3Rpb25zCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKICAgIC8vLyBAbm90aWNlIFRPRE8gQ29tbWVudGkKICAgIGZ1bmN0aW9uIGFkZFdpbmVyeU9wZXJhdGlvbigKICAgICAgICBieXRlczMyIF9tYXBwaW5nSUQsCiAgICAgICAgYWRkcmVzcyBfb3BlcmF0aW9uU2VuZGVyLAogICAgICAgIHN0cmluZyBfb2ZmQ2hhaW5JZGVudGl0eSwKICAgICAgICBzdHJpbmcgX29wZXJhdGlvbklELAogICAgICAgIHN0cmluZyBfb3BlcmF0aW9uQ29kZSwKICAgICAgICB1aW50IF9vcGVyYXRpb25EYXRlLAogICAgICAgIHVpbnQxNiBfYXJlYUNvZGUsCiAgICAgICAgc3RyaW5nIF9jb2RlSUNRUkYKICAgICkKICAgICAgICBwcml2YXRlCiAgICB7CiAgICAgICAgdWludCBzaXplID0gd2luZXJpZXNbX21hcHBpbmdJRF0ubGVuZ3RoOwogICAgICAgIHdpbmVyaWVzW19tYXBwaW5nSURdLmxlbmd0aCsrOwogICAgICAgIHdpbmVyaWVzW19tYXBwaW5nSURdW3NpemVdLm9wZXJhdGlvblNlbmRlciA9IF9vcGVyYXRpb25TZW5kZXI7CiAgICAgICAgd2luZXJpZXNbX21hcHBpbmdJRF1bc2l6ZV0ub2ZmQ2hhaW5JZGVudGl0eSA9IF9vZmZDaGFpbklkZW50aXR5OwogICAgICAgIHdpbmVyaWVzW19tYXBwaW5nSURdW3NpemVdLm9wZXJhdGlvbklEID0gX29wZXJhdGlvbklEOwogICAgICAgIHdpbmVyaWVzW19tYXBwaW5nSURdW3NpemVdLm9wZXJhdGlvbkNvZGUgPSBfb3BlcmF0aW9uQ29kZTsKICAgICAgICB3aW5lcmllc1tfbWFwcGluZ0lEXVtzaXplXS5vcGVyYXRpb25EYXRlID0gX29wZXJhdGlvbkRhdGU7CiAgICAgICAgd2luZXJpZXNbX21hcHBpbmdJRF1bc2l6ZV0uYXJlYUNvZGUgPSBfYXJlYUNvZGU7CiAgICAgICAgd2luZXJpZXNbX21hcHBpbmdJRF1bc2l6ZV0uY29kZUlDUVJGID0gX2NvZGVJQ1FSRjsKICAgIH0KCiAgICAvLy8gQG5vdGljZSBUT0RPIENvbW1lbnRpCiAgICBmdW5jdGlvbiBhZGRQcm9kdWN0KAogICAgICAgIGJ5dGVzMzIgX21hcHBpbmdJRCwKICAgICAgICB1aW50IF9pbmRleCwKICAgICAgICBzdHJpbmcgX3Byb2R1Y3RJRCwKICAgICAgICBzdHJpbmcgX3F1YW50aXR5LAogICAgICAgIHN0cmluZyBfYXR0cmlidXRlcwogICAgKQogICAgICAgIHByaXZhdGUKICAgIHsKICAgICAgICB3aW5lcmllc1tfbWFwcGluZ0lEXVtfaW5kZXhdLnByb2RzLnB1c2goCiAgICAgICAgICAgIFByb2R1Y3QoCiAgICAgICAgICAgICAgICBfcHJvZHVjdElELAogICAgICAgICAgICAgICAgX3F1YW50aXR5LAogICAgICAgICAgICAgICAgX2F0dHJpYnV0ZXMKICAgICAgICAgICAgKQogICAgICAgICk7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkUmVsYXRpb25zaGlwQmluZGluZ1dpbmVyeU9wZXJhdGlvbigKICAgICAgICBieXRlczMyIF9tYXBwaW5nSUQsCiAgICAgICAgdWludCBfbnVtQ3VyT3BlcmF0aW9uLAogICAgICAgIGJ5dGVzMzIgX3BhcmVudE1hcHBpbmdJRCwgICAgICAgIAogICAgICAgIGludCBfbnVtUGFyZW50ICAgICAgICAKICAgICkKICAgICAgICBwcml2YXRlCiAgICB7CiAgICAgICAgcmVxdWlyZShfbnVtQ3VyT3BlcmF0aW9uIDwgT1BFUkFUSU9OX1NFQVJDSF9NQVgpOwogICAgICAgIHJlcXVpcmUoX251bVBhcmVudCA+PSAwKTsKICAgICAgICB1aW50IF9wYXJlbnRJbmRleCA9IHVpbnQoX251bVBhcmVudCk7CiAgICAgICAgaW50IF9udW1DdXJPcGVyYXRpb25JTlQgPSBpbnQoX251bUN1ck9wZXJhdGlvbik7CiAgICAgICAgd2luZXJpZXNbX21hcHBpbmdJRF1bX251bUN1ck9wZXJhdGlvbl0ucGFyZW50TGlzdC5wdXNoKEluZGV4RWxlbShfcGFyZW50TWFwcGluZ0lELCBfbnVtUGFyZW50KSk7CiAgICAgICAgd2luZXJpZXNbX3BhcmVudE1hcHBpbmdJRF1bX3BhcmVudEluZGV4XS5jaGlsZExpc3QucHVzaChJbmRleEVsZW0oX21hcHBpbmdJRCwgX251bUN1ck9wZXJhdGlvbklOVCkpOwogICAgfQoKICAvKgogICAgCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgLy8gJiMyMDg7QXBwcyBoZWxwZXJzCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKCgoKICAgIGZ1bmN0aW9uIGdldFBhcmVudE9wZXJhdGlvbihieXRlczMyIF9tYXBwaW5nSUQsIHVpbnQ4IF9pbmRleCwgdWludDggX25QYXJlbnQpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYnl0ZXMzMiBpZCwgaW50IG51bSkgewogICAgICAgIGlkID0gd2luZXJpZXNbX21hcHBpbmdJRF1bX2luZGV4XS5wYXJlbnRMaXN0W19uUGFyZW50XS5tYXBwaW5nSWQ7CiAgICAgICAgbnVtID0gd2luZXJpZXNbX21hcHBpbmdJRF1bX2luZGV4XS5wYXJlbnRMaXN0W19uUGFyZW50XS5uT3A7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0TnVtUGFyZW50T3BlcmF0aW9uKGJ5dGVzMzIgX21hcHBpbmdJRCwgdWludDggX2luZGV4KSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQgbnVtKSB7CiAgICAgICAgbnVtID0gd2luZXJpZXNbX21hcHBpbmdJRF1bX2luZGV4XS5wYXJlbnRMaXN0Lmxlbmd0aDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRDaGlsZE9wZXJhdGlvbihieXRlczMyIF9tYXBwaW5nSUQsIHVpbnQ4IF9pbmRleCwgdWludDggX25QYXJlbnQpIGV4dGVybmFsIHZpZXcgcmV0dXJucyAoYnl0ZXMzMiBpZCwgaW50IG51bSkgewogICAgICAgIGlkID0gd2luZXJpZXNbX21hcHBpbmdJRF1bX2luZGV4XS5jaGlsZExpc3RbX25QYXJlbnRdLm1hcHBpbmdJZDsKICAgICAgICBudW0gPSB3aW5lcmllc1tfbWFwcGluZ0lEXVtfaW5kZXhdLmNoaWxkTGlzdFtfblBhcmVudF0ubk9wOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldE51bUNoaWxkT3BlcmF0aW9uKGJ5dGVzMzIgX21hcHBpbmdJRCwgdWludDggX2luZGV4KSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQgbnVtKSB7CiAgICAgICAgbnVtID0gd2luZXJpZXNbX21hcHBpbmdJRF1bX2luZGV4XS5jaGlsZExpc3QubGVuZ3RoOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZXROdW1Qb3NpdGlvblByb2R1Y3QoYnl0ZXMzMiBfbWFwcGluZ0lELCB1aW50OCBfblBvc09wLCBzdHJpbmcgX3Byb2R1Y3RJZCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zIChpbnQgcG9zaXRpb24pIHsKICAgICAgICBwb3NpdGlvbiA9IC0xOwogICAgICAgIGZvciAodWludDggaSA9IDA7IGkgPCB3aW5lcmllc1tfbWFwcGluZ0lEXVtfblBvc09wXS5wcm9kcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoa2VjY2FrMjU2KHdpbmVyaWVzW19tYXBwaW5nSURdW19uUG9zT3BdLnByb2RzW2ldLnByb2R1Y3RJRCkgPT0ga2VjY2FrMjU2KF9wcm9kdWN0SWQpKQogICAgICAgICAgICAgICAgcG9zaXRpb24gPSBpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBnZXROdW1XaW5lcnlPcGVyYXRpb24oYnl0ZXMzMiBfbWFwcGluZ0lEKSBleHRlcm5hbCB2aWV3IHJldHVybnMgKHVpbnQgbnVtKSB7CiAgICAgICAgbnVtID0gd2luZXJpZXNbX21hcHBpbmdJRF0ubGVuZ3RoOwogICAgfQoKICAgICovCgp9Cgpjb250cmFjdCBQcm9kdWNlck9wZXJhdGlvbnMgaXMgQ29tbW9ucywgQXV0aG9yaXplZCB7CgogICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIC8vIFByb2R1Y2VyIG9wZXJhdGlvbnMKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgogICAgc3RydWN0IEhhcnZlc3RPcGVyYXRpb24gewogICAgICAgIGFkZHJlc3Mgb3BlcmF0aW9uU2VuZGVyOwogICAgICAgIHN0cmluZyBvZmZDaGFpbklkZW50aXR5OwogICAgICAgIHN0cmluZyBvcGVyYXRpb25JRDsgICAgLy8gY29kaWNlX2FsbGVnYXRvCiAgICAgICAgdWludDMyIHF1YW50aXR5OyAgICAgICAgLy8gdXZhX3JpdmVuZGljYXRhIChrZykKICAgICAgICB1aW50MjQgYXJlYUNvZGU7ICAgICAgICAvLyBjb2RfaXN0YXQgcmVnaW9uZV9wcm92ZW5pZW56YV91dmUsIG1hcHBpbmcKICAgICAgICB1aW50MTYgeWVhcjsgICAgICAgICAgICAvLyBhbm5vIHJhY2NvbHRhCiAgICAgICAgc3RyaW5nIGF0dHJpYnV0ZXM7ICAgICAgCiAgICAgICAgSW5kZXhFbGVtIGNoaWxkOwogICAgICAgIFZpbmV5YXJkW10gdmluZXlhcmRzOwogICAgfQoKICAgIHN0cnVjdCBWaW5leWFyZCB7CiAgICAgICAgdWludDE2IHZhcmlldHk7ICAgICAgICAvLyB2YXJpZXQmIzIyNDsgbWFwcGluZyBkZXNjcml6aW9uZV92YXJpZXRhCiAgICAgICAgdWludDI0IGFyZWFDb2RlOyAgICAgICAvLyBjb2RpY2VfaXN0YXRfY29tdW5lLCBtYXBwaW5nIGRhbCBxdWFsZSBzaSByaWNhdmVyJiMyMjQ7IGFuY2hlIHByb3YuIGUgZGVzY3JpemlvbmUKICAgICAgICB1aW50MzIgdXNlZFN1cmZhY2U7ICAgIC8vIHZpZ25ldG8gdXRpbGl6emF0byAoc3VwZXJmaWNpZV91dGlsaXp6YXRhKSBtcTIKICAgICAgICB1aW50MTYgcGxhbnRpbmdZZWFyOwogICAgfQoKICAgIG1hcHBpbmcoYnl0ZXMzMiA9PiBIYXJ2ZXN0T3BlcmF0aW9uKSBwdWJsaWMgaGFydmVzdHM7CiAgICAKICAgIGV2ZW50IExvZ1N0b3JlSGFydmVzdE9wZXJhdGlvbigKICAgICAgICBzdHJpbmcgdHJhY2tJRHMsCiAgICAgICAgYWRkcmVzcyBvcGVyYXRpb25TZW5kZXIsCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIG9uQ2hhaW5JZGVudGl0eSwKICAgICAgICBzdHJpbmcgb3BlcmF0aW9uSUQKICAgICk7CgogICAgZXZlbnQgTG9nQWRkVmluZXlhcmQoCiAgICAgICAgc3RyaW5nIHRyYWNrSURzLAogICAgICAgIGFkZHJlc3Mgb3BlcmF0aW9uU2VuZGVyLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBvbkNoYWluSWRlbnRpdHksCiAgICAgICAgdWludDI0IGluZGV4ZWQgYXJlYUNvZGUgICAgICAgCiAgICApOwoKICAgIGZ1bmN0aW9uIFByb2R1Y2VyT3BlcmF0aW9ucygpIGludGVybmFsIHsgfQogICAgCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgLy8gRXh0ZXJuYWwgZnVuY3Rpb25zIGZvciBwcm9kdWNlcnMKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgogICAgLy8vIEBub3RpY2UgKioqKgogICAgLy8vIEBkZXYgKioqKgogICAgLy8vIEBwYXJhbSBfdHJhY2tJRHMgKioqKgogICAgLy8vIEByZXR1cm4gdHJ1ZSBpZiBvcGVyYXRpb24gaXMgc3VjY2Vzc2Z1bAogICAgZnVuY3Rpb24gc3RvcmVIYXJ2ZXN0T3BlcmF0aW9uKAogICAgICAgIHN0cmluZyBfdHJhY2tJRHMsCiAgICAgICAgc3RyaW5nIF9vcGVyYXRpb25JRCwKICAgICAgICB1aW50MzIgX3F1YW50aXR5LAogICAgICAgIHVpbnQxNiBfYXJlYUNvZGUsCiAgICAgICAgdWludDE2IF95ZWFyLAogICAgICAgIHN0cmluZyBfYXR0cmlidXRlcwogICAgKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgcHJvZHVjZXJzT25seQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICBzdG9yZUhhcnZlc3RPcGVyYXRpb24oCiAgICAgICAgICAgIGtlY2NhazI1NihfdHJhY2tJRHMsIG1zZy5zZW5kZXIpLAogICAgICAgICAgICBtc2cuc2VuZGVyLAogICAgICAgICAgICBnZXRPZmZDaGFpbklkZW50aXR5KG1zZy5zZW5kZXIpLAogICAgICAgICAgICBfb3BlcmF0aW9uSUQsICAgICAgICAgICAgCiAgICAgICAgICAgIF9xdWFudGl0eSwKICAgICAgICAgICAgX2FyZWFDb2RlLAogICAgICAgICAgICBfeWVhciwKICAgICAgICAgICAgX2F0dHJpYnV0ZXMKICAgICAgICApOwogICAgICAgIGVtaXQgTG9nU3RvcmVIYXJ2ZXN0T3BlcmF0aW9uKAogICAgICAgICAgICBfdHJhY2tJRHMsCiAgICAgICAgICAgIG1zZy5zZW5kZXIsCiAgICAgICAgICAgIG1zZy5zZW5kZXIsCiAgICAgICAgICAgIF9vcGVyYXRpb25JRAogICAgICAgICk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8vIEBub3RpY2UgKioqKgogICAgLy8vIEBkZXYgKioqKgogICAgLy8vIEBwYXJhbSBfdHJhY2tJRHMgKioqKgogICAgLy8vIEByZXR1cm4gdHJ1ZSBpZiBvcGVyYXRpb24gaXMgc3VjY2Vzc2Z1bAogICAgZnVuY3Rpb24gYWRkVmluZXlhcmQoCiAgICAgICAgc3RyaW5nIF90cmFja0lEcywKICAgICAgICB1aW50MTYgX3ZhcmlldHksCiAgICAgICAgdWludDI0IF9hcmVhQ29kZSwKICAgICAgICB1aW50MzIgX3VzZWRTdXJmYWNlLAogICAgICAgIHVpbnQxNiBfcGxhbnRpbmdZZWFyCiAgICApCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICBwcm9kdWNlcnNPbmx5CiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKQogICAgewogICAgICAgIGFkZFZpbmV5YXJkKAogICAgICAgICAgICBrZWNjYWsyNTYoX3RyYWNrSURzLCBtc2cuc2VuZGVyKSwKICAgICAgICAgICAgX3ZhcmlldHksCiAgICAgICAgICAgIF9hcmVhQ29kZSwgICAgICAgICAgICAKICAgICAgICAgICAgX3VzZWRTdXJmYWNlLAogICAgICAgICAgICBfcGxhbnRpbmdZZWFyCiAgICAgICAgKTsKICAgICAgICBlbWl0IExvZ0FkZFZpbmV5YXJkKF90cmFja0lEcywgbXNnLnNlbmRlciwgbXNnLnNlbmRlciwgX2FyZWFDb2RlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgLy8gRXh0ZXJuYWwgZnVuY3Rpb25zIGZvciByZWd1bGF0b3JzCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKICAgIGZ1bmN0aW9uIHN0b3JlSGFydmVzdE9wZXJhdGlvbkJ5UmVndWxhdG9yKAogICAgICAgIHN0cmluZyBfdHJhY2tJRHMsCiAgICAgICAgc3RyaW5nIF9vZmZDaGFpbklkZW50aXR5LAogICAgICAgIHN0cmluZyBfb3BlcmF0aW9uSUQsCiAgICAgICAgdWludDMyIF9xdWFudGl0eSwKICAgICAgICB1aW50MTYgX2FyZWFDb2RlLAogICAgICAgIHVpbnQxNiBfeWVhciwKICAgICAgICBzdHJpbmcgX2F0dHJpYnV0ZXMKICAgICkKICAgICAgICBleHRlcm5hbAogICAgICAgIHJlZ3VsYXRvcnNPbmx5CiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKQogICAgewogICAgICAgIGFkZHJlc3MgX3Byb2R1Y2VyID0gZ2V0QWRkcmVzcyhfb2ZmQ2hhaW5JZGVudGl0eSk7CiAgICAgICAgc3RvcmVIYXJ2ZXN0T3BlcmF0aW9uKAogICAgICAgICAgICBrZWNjYWsyNTYoX3RyYWNrSURzLF9wcm9kdWNlciksCiAgICAgICAgICAgIG1zZy5zZW5kZXIsCiAgICAgICAgICAgIF9vZmZDaGFpbklkZW50aXR5LAogICAgICAgICAgICBfb3BlcmF0aW9uSUQsCiAgICAgICAgICAgIF9xdWFudGl0eSwKICAgICAgICAgICAgX2FyZWFDb2RlLAogICAgICAgICAgICBfeWVhciwKICAgICAgICAgICAgX2F0dHJpYnV0ZXMKICAgICAgICApOwogICAgICAgIGVtaXQgTG9nU3RvcmVIYXJ2ZXN0T3BlcmF0aW9uKAogICAgICAgICAgICBfdHJhY2tJRHMsCiAgICAgICAgICAgIG1zZy5zZW5kZXIsCiAgICAgICAgICAgIF9wcm9kdWNlciwKICAgICAgICAgICAgX29wZXJhdGlvbklECiAgICAgICAgKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRWaW5leWFyZEJ5UmVndWxhdG9yKAogICAgICAgIHN0cmluZyBfdHJhY2tJRHMsCiAgICAgICAgc3RyaW5nIF9vZmZDaGFpbklkZW50aXR5LAogICAgICAgIHVpbnQxNiBfdmFyaWV0eSwKICAgICAgICB1aW50MjQgX2FyZWFDb2RlLAogICAgICAgIHVpbnQzMiBfdXNlZFN1cmZhY2UsCiAgICAgICAgdWludDE2IF9wbGFudGluZ1llYXIKICAgICkKICAgICAgICBleHRlcm5hbAogICAgICAgIHJlZ3VsYXRvcnNPbmx5CiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKQogICAgewogICAgICAgIGFkZHJlc3MgX3Byb2R1Y2VyID0gZ2V0QWRkcmVzcyhfb2ZmQ2hhaW5JZGVudGl0eSk7CiAgICAgICAgcmVxdWlyZShfcHJvZHVjZXIgIT0gYWRkcmVzcygwKSk7CiAgICAgICAgYWRkVmluZXlhcmQoCiAgICAgICAgICAgIGtlY2NhazI1NihfdHJhY2tJRHMsX3Byb2R1Y2VyKSwKICAgICAgICAgICAgX3ZhcmlldHksCiAgICAgICAgICAgIF9hcmVhQ29kZSwKICAgICAgICAgICAgX3VzZWRTdXJmYWNlLAogICAgICAgICAgICBfcGxhbnRpbmdZZWFyCiAgICAgICAgKTsKICAgICAgICBlbWl0IExvZ0FkZFZpbmV5YXJkKF90cmFja0lEcywgbXNnLnNlbmRlciwgX3Byb2R1Y2VyLCBfYXJlYUNvZGUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAvLyBIZWxwZXJzIGZvciAmIzIwODtBcHBzCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKICAgIGZ1bmN0aW9uIGdldEhhcnZlc3RPcGVyYXRpb24oc3RyaW5nIF90cmFja0lELCBhZGRyZXNzIF9wcm9kdWNlcikKICAgICAgICBleHRlcm5hbCB2aWV3CiAgICAgICAgcmV0dXJucyAoCiAgICAgICAgICAgIGFkZHJlc3Mgb3BlcmF0aW9uU2VuZGVyLAogICAgICAgICAgICBzdHJpbmcgb2ZmQ2hhaW5JZGVudGl0eSwKICAgICAgICAgICAgc3RyaW5nIG9wZXJhdGlvbklELAogICAgICAgICAgICB1aW50MzIgcXVhbnRpdHksCiAgICAgICAgICAgIHVpbnQyNCBhcmVhQ29kZSwKICAgICAgICAgICAgdWludDE2IHllYXIsCiAgICAgICAgICAgIHN0cmluZyBhdHRyaWJ1dGVzCiAgICAgICAgKQogICAgewogICAgICAgIGJ5dGVzMzIgX21hcHBpbmdJRDMyID0ga2VjY2FrMjU2KF90cmFja0lELCBfcHJvZHVjZXIpOwogICAgICAgIG9wZXJhdGlvblNlbmRlciA9IGhhcnZlc3RzW19tYXBwaW5nSUQzMl0ub3BlcmF0aW9uU2VuZGVyOwogICAgICAgIG9mZkNoYWluSWRlbnRpdHkgPSBoYXJ2ZXN0c1tfbWFwcGluZ0lEMzJdLm9mZkNoYWluSWRlbnRpdHk7CiAgICAgICAgb3BlcmF0aW9uSUQgPSBoYXJ2ZXN0c1tfbWFwcGluZ0lEMzJdLm9wZXJhdGlvbklEOwogICAgICAgIHF1YW50aXR5ID0gaGFydmVzdHNbX21hcHBpbmdJRDMyXS5xdWFudGl0eTsKICAgICAgICBhcmVhQ29kZSA9IGhhcnZlc3RzW19tYXBwaW5nSUQzMl0uYXJlYUNvZGU7CiAgICAgICAgeWVhciA9IGhhcnZlc3RzW19tYXBwaW5nSUQzMl0ueWVhcjsKICAgICAgICBhdHRyaWJ1dGVzID0gaGFydmVzdHNbX21hcHBpbmdJRDMyXS5hdHRyaWJ1dGVzOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFZpbmV5YXJkKHN0cmluZyBfdHJhY2tJRCwgYWRkcmVzcyBfcHJvZHVjZXIsIHVpbnQgX2luZGV4KQogICAgICAgIGV4dGVybmFsIHZpZXcKICAgICAgICByZXR1cm5zICgKICAgICAgICAgICAgdWludDMyIHZhcmlldHksCiAgICAgICAgICAgIHVpbnQzMiBhcmVhQ29kZSwKICAgICAgICAgICAgdWludDMyIHVzZWRTdXJmYWNlLAogICAgICAgICAgICB1aW50MTYgcGxhbnRpbmdZZWFyCiAgICAgICAgKQogICAgewogICAgICAgIGJ5dGVzMzIgX21hcHBpbmdJRDMyID0ga2VjY2FrMjU2KF90cmFja0lELCBfcHJvZHVjZXIpOwogICAgICAgIHZhcmlldHkgPSBoYXJ2ZXN0c1tfbWFwcGluZ0lEMzJdLnZpbmV5YXJkc1tfaW5kZXhdLnZhcmlldHk7CiAgICAgICAgYXJlYUNvZGUgPSBoYXJ2ZXN0c1tfbWFwcGluZ0lEMzJdLnZpbmV5YXJkc1tfaW5kZXhdLmFyZWFDb2RlOwogICAgICAgIHVzZWRTdXJmYWNlID0gaGFydmVzdHNbX21hcHBpbmdJRDMyXS52aW5leWFyZHNbX2luZGV4XS51c2VkU3VyZmFjZTsKICAgICAgICBwbGFudGluZ1llYXIgPSBoYXJ2ZXN0c1tfbWFwcGluZ0lEMzJdLnZpbmV5YXJkc1tfaW5kZXhdLnBsYW50aW5nWWVhcjsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRWaW5leWFyZENvdW50KHN0cmluZyBfdHJhY2tJRCwgYWRkcmVzcyBfcHJvZHVjZXIpCiAgICAgICAgZXh0ZXJuYWwgdmlldwogICAgICAgIHJldHVybnMgKHVpbnQgbnVtYmVyT2ZWaW5leWFyZHMpCiAgICB7CiAgICAgICAgYnl0ZXMzMiBfbWFwcGluZ0lEMzIgPSBrZWNjYWsyNTYoX3RyYWNrSUQsIF9wcm9kdWNlcik7CiAgICAgICAgbnVtYmVyT2ZWaW5leWFyZHMgPSBoYXJ2ZXN0c1tfbWFwcGluZ0lEMzJdLnZpbmV5YXJkcy5sZW5ndGg7CiAgICB9CgogICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIC8vIFByaXZhdGUgZnVuY3Rpb25zCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKICAgIGZ1bmN0aW9uIHN0b3JlSGFydmVzdE9wZXJhdGlvbigKICAgICAgICBieXRlczMyIF9tYXBwaW5nSUQsCiAgICAgICAgYWRkcmVzcyBfb3BlcmF0aW9uU2VuZGVyLAogICAgICAgIHN0cmluZyBfb2ZmQ2hhaW5JZGVudGl0eSwKICAgICAgICBzdHJpbmcgX29wZXJhdGlvbklELAogICAgICAgIHVpbnQzMiBfcXVhbnRpdHksCiAgICAgICAgdWludDI0IF9hcmVhQ29kZSwgICAgICAgIAogICAgICAgIHVpbnQxNiBfeWVhciwKICAgICAgICBzdHJpbmcgX2F0dHJpYnV0ZXMKICAgICkKICAgICAgICBwcml2YXRlCiAgICB7CiAgICAgICAgaGFydmVzdHNbX21hcHBpbmdJRF0ub3BlcmF0aW9uU2VuZGVyID0gX29wZXJhdGlvblNlbmRlcjsKICAgICAgICBoYXJ2ZXN0c1tfbWFwcGluZ0lEXS5vZmZDaGFpbklkZW50aXR5ID0gX29mZkNoYWluSWRlbnRpdHk7CiAgICAgICAgaGFydmVzdHNbX21hcHBpbmdJRF0ub3BlcmF0aW9uSUQgPSBfb3BlcmF0aW9uSUQ7CiAgICAgICAgaGFydmVzdHNbX21hcHBpbmdJRF0ucXVhbnRpdHkgPSBfcXVhbnRpdHk7CiAgICAgICAgaGFydmVzdHNbX21hcHBpbmdJRF0uYXJlYUNvZGUgPSBfYXJlYUNvZGU7CiAgICAgICAgaGFydmVzdHNbX21hcHBpbmdJRF0ueWVhciA9IF95ZWFyOwogICAgICAgIGhhcnZlc3RzW19tYXBwaW5nSURdLmF0dHJpYnV0ZXMgPSBfYXR0cmlidXRlczsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRWaW5leWFyZCgKICAgICAgICBieXRlczMyIF9tYXBwaW5nSUQsCiAgICAgICAgdWludDE2IF92YXJpZXR5LAogICAgICAgIHVpbnQyNCBfYXJlYUNvZGUsCiAgICAgICAgdWludDMyIF91c2VkU3VyZmFjZSwKICAgICAgICB1aW50MTYgX3BsYW50aW5nWWVhciAgICAgICAgCiAgICApCiAgICAgICAgcHJpdmF0ZQogICAgewogICAgICAgIGhhcnZlc3RzW19tYXBwaW5nSURdLnZpbmV5YXJkcy5wdXNoKAogICAgICAgICAgICBWaW5leWFyZChfdmFyaWV0eSwgX2FyZWFDb2RlLCBfdXNlZFN1cmZhY2UsIF9wbGFudGluZ1llYXIpCiAgICAgICAgKTsKICAgIH0KICAgIAp9Cgpjb250cmFjdCBVcGdyYWRhYmxlIGlzIE93bmFibGUgewoKICAgIGFkZHJlc3MgcHVibGljIG5ld0FkZHJlc3M7CiAgICB1aW50ICAgIHB1YmxpYyBkZXByZWNhdGVkU2luY2U7CiAgICBzdHJpbmcgIHB1YmxpYyB2ZXJzaW9uOwogICAgc3RyaW5nICBwdWJsaWMgbmV3VmVyc2lvbjsKICAgIHN0cmluZyAgcHVibGljIHJlYXNvbjsKCiAgICBldmVudCBMb2dTZXREZXByZWNhdGVkKGFkZHJlc3MgbmV3QWRkcmVzcywgc3RyaW5nIG5ld1ZlcnNpb24sIHN0cmluZyByZWFzb24pOwoKICAgIC8qKgogICAgICoKICAgICAqLwogICAgZnVuY3Rpb24gVXBncmFkYWJsZShzdHJpbmcgX3ZlcnNpb24pIGludGVybmFsCiAgICB7CiAgICAgICAgdmVyc2lvbiA9IF92ZXJzaW9uOwogICAgfQoKICAgIC8qKgogICAgICoKICAgICAqLwogICAgZnVuY3Rpb24gc2V0RGVwcmVjYXRlZChhZGRyZXNzIF9uZXdBZGRyZXNzLCBzdHJpbmcgX25ld1ZlcnNpb24sIHN0cmluZyBfcmVhc29uKSBleHRlcm5hbAogICAgICAgIG93bmVyT25seQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICByZXF1aXJlKCFpc0RlcHJlY2F0ZWQoKSk7CiAgICAgICAgcmVxdWlyZShfbmV3QWRkcmVzcyAhPSBhZGRyZXNzKHRoaXMpKTsKICAgICAgICByZXF1aXJlKCFVcGdyYWRhYmxlKF9uZXdBZGRyZXNzKS5pc0RlcHJlY2F0ZWQoKSk7CiAgICAgICAgZGVwcmVjYXRlZFNpbmNlID0gbm93OwogICAgICAgIG5ld0FkZHJlc3MgPSBfbmV3QWRkcmVzczsKICAgICAgICBuZXdWZXJzaW9uID0gX25ld1ZlcnNpb247CiAgICAgICAgcmVhc29uID0gX3JlYXNvbjsKICAgICAgICBlbWl0IExvZ1NldERlcHJlY2F0ZWQoX25ld0FkZHJlc3MsIF9uZXdWZXJzaW9uLCBfcmVhc29uKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBub3RpY2UgY2hlY2sgaWYgdGhlIGNvbnRyYWN0IGlzIGRlcHJlY2F0ZWQKICAgICAqLwogICAgZnVuY3Rpb24gaXNEZXByZWNhdGVkKCkgcHVibGljIHZpZXcgcmV0dXJucyAoYm9vbCBkZXByZWNhdGVkKQogICAgewogICAgICAgIHJldHVybiAoZGVwcmVjYXRlZFNpbmNlICE9IDApOwogICAgfQp9Cgpjb250cmFjdCBTbWFydEJpbmRpbmcgaXMgQXV0aG9yaXplZCB7CgogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiBieXRlczMyKSBwdWJsaWMgYmluZGluZ1NtYXJ0SWRlbnRpdHk7CiAKICAgIGV2ZW50IExvZ0JpbmRTbWFydElkZW50aXR5ICgKICAgICAgICBzdHJpbmcgX3RyYWNrSURzLAogICAgICAgIGFkZHJlc3Mgb3BlcmF0aW9uU2VuZGVyLAogICAgICAgIGFkZHJlc3Mgb25DaGFpbklkZW50aXR5LAogICAgICAgIHN0cmluZyBzbWFydElkZW50aXR5CiAgICApOwoKICAgIGZ1bmN0aW9uIFNtYXJ0QmluZGluZygpIGludGVybmFsIHsgfQoKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAvLyBFeHRlcm5hbCBmdW5jdGlvbnMgZm9yIHdpbmVyaWVzCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKICAgIC8vLyBAbm90aWNlICoqKioKICAgIC8vLyBAZGV2ICoqKioKICAgIC8vLyBAcGFyYW0gX3RyYWNrSURzICoqKioKICAgIC8vLyBAcmV0dXJuIHRydWUgaWYgb3BlcmF0aW9uIGlzIHN1Y2Nlc3NmdWwKICAgIGZ1bmN0aW9uIGJpbmRTbWFydElkZW50aXR5KHN0cmluZyBfdHJhY2tJRHMsIHN0cmluZyBfc21hcnRJZGVudGl0eSkKICAgICAgICBleHRlcm5hbAogICAgICAgIHdpbmVyaWVzT25seQogICAgewogICAgICAgIGJpbmRpbmdTbWFydElkZW50aXR5W2tlY2NhazI1Nihfc21hcnRJZGVudGl0eSwgbXNnLnNlbmRlcildID0ga2VjY2FrMjU2KF90cmFja0lEcywgbXNnLnNlbmRlcik7CiAgICAgICAgZW1pdCBMb2dCaW5kU21hcnRJZGVudGl0eShfdHJhY2tJRHMsIG1zZy5zZW5kZXIsIG1zZy5zZW5kZXIsIF9zbWFydElkZW50aXR5KTsKICAgIH0KCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgLy8gRXh0ZXJuYWwgZnVuY3Rpb25zIGZvciByZWd1bGF0b3JzCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgCiAgICAvLy8gQG5vdGljZSAqKioqCiAgICAvLy8gQGRldiAqKioqCiAgICAvLy8gQHBhcmFtIF90cmFja0lEcyAqKioqCiAgICAvLy8gQHJldHVybiB0cnVlIGlmIG9wZXJhdGlvbiBpcyBzdWNjZXNzZnVsCiAgICBmdW5jdGlvbiBiaW5kU21hcnRJZGVudGl0eUJ5UmVndWxhdG9yKAogICAgICAgIHN0cmluZyBfdHJhY2tJRHMsCiAgICAgICAgc3RyaW5nIF9vZmZDaGFpbklkZW50aXR5LCAgCiAgICAgICAgc3RyaW5nIF9zbWFydElkZW50aXR5CiAgICApCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICByZWd1bGF0b3JzT25seQogICAgewogICAgICAgIGFkZHJlc3Mgd2luZXJ5ID0gZ2V0QWRkcmVzcyhfb2ZmQ2hhaW5JZGVudGl0eSk7CiAgICAgICAgYmluZGluZ1NtYXJ0SWRlbnRpdHlba2VjY2FrMjU2KF9zbWFydElkZW50aXR5LCB3aW5lcnkpXSA9IGtlY2NhazI1NihfdHJhY2tJRHMsIHdpbmVyeSk7CiAgICAgICAgZW1pdCBMb2dCaW5kU21hcnRJZGVudGl0eShfdHJhY2tJRHMsIG1zZy5zZW5kZXIsIHdpbmVyeSwgX3NtYXJ0SWRlbnRpdHkpOwogICAgfQoKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAvLyAmIzIwODtBcHBzIGhlbHBlcnMKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgogICAgZnVuY3Rpb24gZ2V0V2luZXJ5TWFwcGluZ0lEKHN0cmluZyBfc21hcnRJZGVudGl0eSwgc3RyaW5nIF9vZmZDaGFpbklkZW50aXR5KQogICAgICAgIGV4dGVybmFsIHZpZXcKICAgICAgICByZXR1cm5zIChieXRlczMyIHdpbmVyeU1hcHBpbmdJRCkKICAgIHsKICAgICAgICBieXRlczMyIGluZGV4ID0ga2VjY2FrMjU2KF9zbWFydElkZW50aXR5LCBnZXRBZGRyZXNzKF9vZmZDaGFpbklkZW50aXR5KSk7CiAgICAgICAgd2luZXJ5TWFwcGluZ0lEID0gYmluZGluZ1NtYXJ0SWRlbnRpdHlbaW5kZXhdOwogICAgfQoKfQoKY29udHJhY3QgV2luZVN1cHBseUNoYWluIGlzCiAgICBDb21tb25zLAogICAgQXV0aG9yaXplZCwKICAgIFVwZ3JhZGFibGUsCiAgICBQcm9kdWNlck9wZXJhdGlvbnMsCiAgICBXaW5lcnlPcGVyYXRpb25zLAogICAgU21hcnRCaW5kaW5nCnsKCiAgICBhZGRyZXNzIHB1YmxpYyBlbmRvcnNlbWVudHM7CgogICAgZnVuY3Rpb24gV2luZVN1cHBseUNoYWluKGFkZHJlc3MgX2VuZG9yc2VtZW50cykgVXBncmFkYWJsZSgiMS4wLjAiKSBwdWJsaWMgewogICAgICAgIGVuZG9yc2VtZW50cyA9IF9lbmRvcnNlbWVudHM7CiAgICB9CgogICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIC8vIEV4dGVybmFsIGZ1bmN0aW9ucyBmb3IgcmVndWxhdG9ycwogICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCiAgICAvLy8gQG5vdGljZSBUT0RPIEluc2VyaXJlIGNvbW1lbnRpCiAgICBmdW5jdGlvbiBzdGFydFdpbmVyeVByb2R1Y3RCeVJlZ3VsYXRvcigKICAgICAgICBzdHJpbmcgX2hhcnZlc3RUcmFja0lELAogICAgICAgIHN0cmluZyBfcHJvZHVjZXJPZmZDaGFpbklkZW50aXR5LAogICAgICAgIHN0cmluZyBfd2luZXJ5T3BlcmF0aW9uVHJhY2tJRHMsCiAgICAgICAgc3RyaW5nIF93aW5lcnlPZmZDaGFpbklkZW50aXR5LAogICAgICAgIGludCBfcHJvZHVjdEluZGV4CiAgICApCiAgICAgICAgZXh0ZXJuYWwKICAgICAgICByZWd1bGF0b3JzT25seQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykKICAgIHsKICAgICAgICByZXF1aXJlKF9wcm9kdWN0SW5kZXggPj0gMCk7CiAgICAgICAgYWRkcmVzcyBwcm9kdWNlciA9IGdldEFkZHJlc3MoX3Byb2R1Y2VyT2ZmQ2hhaW5JZGVudGl0eSk7CiAgICAgICAgYnl0ZXMzMiBoYXJ2ZXN0TWFwcGluZ0lEID0ga2VjY2FrMjU2KF9oYXJ2ZXN0VHJhY2tJRCwgcHJvZHVjZXIpOwogICAgICAgIGFkZHJlc3Mgd2luZXJ5ID0gZ2V0QWRkcmVzcyhfd2luZXJ5T2ZmQ2hhaW5JZGVudGl0eSk7CiAgICAgICAgYnl0ZXMzMiB3aW5lcnlPcGVyYXRpb25NYXBwaW5nSUQgPSBrZWNjYWsyNTYoX3dpbmVyeU9wZXJhdGlvblRyYWNrSURzLCB3aW5lcnkpOwogICAgICAgIGhhcnZlc3RzW2hhcnZlc3RNYXBwaW5nSURdLmNoaWxkID0gSW5kZXhFbGVtKHdpbmVyeU9wZXJhdGlvbk1hcHBpbmdJRCwgX3Byb2R1Y3RJbmRleCk7CiAgICAgICAgd2luZXJpZXNbd2luZXJ5T3BlcmF0aW9uTWFwcGluZ0lEXVt1aW50KF9wcm9kdWN0SW5kZXgpXS5wYXJlbnRMaXN0LnB1c2goCiAgICAgICAgICAgIEluZGV4RWxlbShoYXJ2ZXN0TWFwcGluZ0lELCAtMSkpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vLyBAbm90aWNlIFRPRE8gQ29tbWVudGkKICAgIC8vIFRPQ0hFQ0sgQUdHSVVOR0VSRSBSRVFVSVJFIFNVIFRJUE9fT1BFUkFaSU9ORSA9ICdDQVNEJyA/Pz8KICAgIGZ1bmN0aW9uIHN0YXJ0V2luZXJ5KAogICAgICAgIHN0cmluZyBfaGFydmVzdFRyYWNrSUQsCiAgICAgICAgc3RyaW5nIF9vZmZDaGFpblByb2R1Y2VySWRlbnRpdHksCiAgICAgICAgc3RyaW5nIF93aW5lcnlUcmFja0lELAogICAgICAgIHVpbnQgX3Byb2R1Y3RJbmRleAogICAgKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgd2luZXJpZXNPbmx5CiAgICB7CiAgICAgICAgcmVxdWlyZShfcHJvZHVjdEluZGV4ID49IDApOwogICAgICAgIGFkZHJlc3MgcHJvZHVjZXIgPSBnZXRBZGRyZXNzKF9vZmZDaGFpblByb2R1Y2VySWRlbnRpdHkpOwogICAgICAgIGJ5dGVzMzIgaGFydmVzdE1hcHBpbmdJRCA9IGtlY2NhazI1NihfaGFydmVzdFRyYWNrSUQsIHByb2R1Y2VyKTsKICAgICAgICBieXRlczMyIHdpbmVyeU9wZXJhdGlvbk1hcHBpbmdJRCA9IGtlY2NhazI1Nihfd2luZXJ5VHJhY2tJRCwgbXNnLnNlbmRlcik7CiAgICAgICAgd2luZXJpZXNbd2luZXJ5T3BlcmF0aW9uTWFwcGluZ0lEXVtfcHJvZHVjdEluZGV4XS5wYXJlbnRMaXN0LnB1c2goCiAgICAgICAgICAgIEluZGV4RWxlbShoYXJ2ZXN0TWFwcGluZ0lELCAtMSkpOwogICAgfQoKICAgIC8vLyBAbm90aWNlIFRPRE8gQ29tbWVudGkKICAgIC8vIFRPQ0hFQ0sgQUdHSVVOR0VSRSBSRVFVSVJFIFNVIFRJUE9fT1BFUkFaSU9ORSA9ICdDQVNEJyA/Pz8KICAgIGZ1bmN0aW9uIHN0YXJ0UHJvZHVjdCgKICAgICAgICBzdHJpbmcgX2hhcnZlc3RUcmFja0lELAogICAgICAgIHN0cmluZyBfd2luZXJ5VHJhY2tJRCwKICAgICAgICBzdHJpbmcgX29mZkNoYWluV2luZXJ5SWRlbnRpdHksCiAgICAgICAgaW50IF9wcm9kdWN0SW5kZXgKICAgICkKICAgICAgICBleHRlcm5hbAogICAgICAgIHByb2R1Y2Vyc09ubHkKICAgIHsKICAgICAgICByZXF1aXJlKF9wcm9kdWN0SW5kZXggPiAwKTsKICAgICAgICBieXRlczMyIGhhcnZlc3RNYXBwaW5nSUQgPSBrZWNjYWsyNTYoX2hhcnZlc3RUcmFja0lELCBtc2cuc2VuZGVyKTsKICAgICAgICBhZGRyZXNzIHdpbmVyeSA9IGdldEFkZHJlc3MoX29mZkNoYWluV2luZXJ5SWRlbnRpdHkpOwogICAgICAgIGJ5dGVzMzIgd2luZXJ5T3BlcmF0aW9uTWFwcGluZ0lEID0ga2VjY2FrMjU2KF93aW5lcnlUcmFja0lELCB3aW5lcnkpOwogICAgICAgIGhhcnZlc3RzW2hhcnZlc3RNYXBwaW5nSURdLmNoaWxkID0gSW5kZXhFbGVtKHdpbmVyeU9wZXJhdGlvbk1hcHBpbmdJRCwgX3Byb2R1Y3RJbmRleCk7CiAgICB9CgogICAgLy8vIEBub3RpY2UgKioqCiAgICAvLy8gQGRldiAqKioqCiAgICAvLy8gQHBhcmFtIF90cmFja0lEcyAqKgogICAgLy8vIEBwYXJhbSBfYWRkcmVzcyAqKgogICAgLy8vIEByZXR1cm4gbWFwcGluZ0lEIGlmICoqKgogICAgZnVuY3Rpb24gZ2V0TWFwcGluZ0lEKHN0cmluZyBfdHJhY2tJRHMsIGFkZHJlc3MgX2FkZHJlc3MpCiAgICAgICAgZXh0ZXJuYWwgcHVyZQogICAgICAgIHJldHVybnMgKGJ5dGVzMzIgbWFwcGluZ0lEKQogICAgewogICAgICAgIG1hcHBpbmdJRCA9IGtlY2NhazI1NihfdHJhY2tJRHMsIF9hZGRyZXNzKTsKICAgIH0KCn0='.
	

]
