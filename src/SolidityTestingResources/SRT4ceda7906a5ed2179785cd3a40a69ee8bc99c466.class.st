Class {
	#name : #SRT4ceda7906a5ed2179785cd3a40a69ee8bc99c466,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT4ceda7906a5ed2179785cd3a40a69ee8bc99c466 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5ID49MC40LjEwOwoKLy8gZnJvbSBaZXBwZWxpbgpjb250cmFjdCBTYWZlTWF0aCB7CiAgICBmdW5jdGlvbiBzYWZlTXVsKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgdWludCBjID0gYSAqIGI7CiAgICAgICAgcmVxdWlyZShhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gc2FmZVN1Yih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgICAgIHJlcXVpcmUoYiA8PSBhKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgZnVuY3Rpb24gc2FmZUFkZCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgewogICAgICAgIHVpbnQgYyA9IGEgKyBiOwogICAgICAgIHJlcXVpcmUoYz49YSAmJiBjPj1iKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KfQoKY29udHJhY3QgT3duZWQgewogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7CiAgICBhZGRyZXNzIG5ld093bmVyOwoKICAgIGZ1bmN0aW9uIE93bmVkKCkgewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5T3duZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYW5nZU93bmVyKGFkZHJlc3MgX25ld093bmVyKSBvbmx5T3duZXIgewogICAgICAgIG5ld093bmVyID0gX25ld093bmVyOwogICAgfQoKICAgIGZ1bmN0aW9uIGFjY2VwdE93bmVyc2hpcCgpIHsKICAgICAgICBpZiAobXNnLnNlbmRlciA9PSBuZXdPd25lcikgewogICAgICAgICAgICBvd25lciA9IG5ld093bmVyOwogICAgICAgIH0KICAgIH0KfQoKY29udHJhY3QgSVRva2VuIHsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBvd25lcikgcmV0dXJucyh1aW50KTsKfQoKLy8gSW4gY2FzZSBzb21lb25lIGFjY2lkZW50YWxseSBzZW5kcyB0b2tlbiB0byBvbmUgb2YgdGhlc2UgY29udHJhY3RzLAovLyBhZGQgYSB3YXkgdG8gZ2V0IHRoZW0gYmFjayBvdXQuCmNvbnRyYWN0IFRva2VuUmVjZWl2YWJsZSBpcyBPd25lZCB7CiAgICBmdW5jdGlvbiBjbGFpbVRva2VucyhhZGRyZXNzIF90b2tlbiwgYWRkcmVzcyBfdG8pIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7CiAgICAgICAgSVRva2VuIHRva2VuID0gSVRva2VuKF90b2tlbik7CiAgICAgICAgcmV0dXJuIHRva2VuLnRyYW5zZmVyKF90bywgdG9rZW4uYmFsYW5jZU9mKHRoaXMpKTsKICAgIH0KfQoKY29udHJhY3QgRXZlbnREZWZpbml0aW9ucyB7CiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50IHZhbHVlKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOwogICAgZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYnl0ZXMzMiBpbmRleGVkIHRvLCB1aW50IHZhbHVlKTsKICAgIGV2ZW50IENsYWltZWQoYWRkcmVzcyBpbmRleGVkIGNsYWltZXIsIHVpbnQgdmFsdWUpOwp9Cgpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25lZCB7CiAgICBib29sIHB1YmxpYyBwYXVzZWQ7CgogICAgZnVuY3Rpb24gcGF1c2UoKSBvbmx5T3duZXIgewogICAgICAgIHBhdXNlZCA9IHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gdW5wYXVzZSgpIG9ubHlPd25lciB7CiAgICAgICAgcGF1c2VkID0gZmFsc2U7CiAgICB9CgogICAgbW9kaWZpZXIgbm90UGF1c2VkKCkgewogICAgICAgIHJlcXVpcmUoIXBhdXNlZCk7CiAgICAgICAgXzsKICAgIH0KfQoKY29udHJhY3QgRmluYWxpemFibGUgaXMgT3duZWQgewogICAgYm9vbCBwdWJsaWMgZmluYWxpemVkOwoKICAgIGZ1bmN0aW9uIGZpbmFsaXplKCkgb25seU93bmVyIHsKICAgICAgICBmaW5hbGl6ZWQgPSB0cnVlOwogICAgfQoKICAgIG1vZGlmaWVyIG5vdEZpbmFsaXplZCgpIHsKICAgICAgICByZXF1aXJlKCFmaW5hbGl6ZWQpOwogICAgICAgIF87CiAgICB9Cn0KCmNvbnRyYWN0IExlZGdlciBpcyBPd25lZCwgU2FmZU1hdGgsIEZpbmFsaXphYmxlIHsKICAgIENvbnRyb2xsZXIgcHVibGljIGNvbnRyb2xsZXI7CiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgcHVibGljIGJhbGFuY2VPZjsKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSkgcHVibGljIGFsbG93YW5jZTsKICAgIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5OwogICAgdWludCBwdWJsaWMgbWludGluZ05vbmNlOwogICAgYm9vbCBwdWJsaWMgbWludGluZ1N0b3BwZWQ7CgogICAgLyoqCiAgICAgKiBVc2VkIGZvciB1cGRhdGluZyB0aGUgY29udHJhY3Qgd2l0aCBwcm9vZnMuIE5vdGUgdGhhdCB0aGUgbG9naWMKICAgICAqIGZvciBndWFyZGluZyBhZ2FpbnN0IHVud2FudGVkIGFjdGlvbnMgaGFwcGVucyBpbiB0aGUgY29udHJvbGxlci4gV2Ugb25seQogICAgICogc3BlY2lmeSBvbmx5Q29udHJvbGxlciBoZXJlLgogICAgICogQG5vdGljZTogbm90IHlldCB1c2VkCiAgICAgKi8KICAgIG1hcHBpbmcodWludDI1NiA9PiBieXRlczMyKSBwdWJsaWMgcHJvb2ZzOwoKICAgIC8qKgogICAgICogSWYgYnJpZGdlIGRlbGl2ZXJzIGN1cnJlbmN5IGJhY2sgZnJvbSB0aGUgb3RoZXIgbmV0d29yaywgaXQgbWF5IGJlIHRoYXQgd2UKICAgICAqIHdhbnQgdG8gbG9jayBpdCB1bnRpbCB0aGUgdXNlciBpcyBhYmxlIHRvICJjbGFpbSIgaXQuIFRoaXMgbWFwcGluZyB3b3VsZCBzdG9yZSB0aGUKICAgICAqIHN0YXRlIG9mIHRoZSB1bmNsYWltZWQgY3VycmVuY3kuCiAgICAgKiBAbm90aWNlOiBub3QgeWV0IHVzZWQKICAgICAqLwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBsb2NrZWQ7CgogICAgLyoqCiAgICAgKiBBcyBhIHByZWNhdXRpb25hcnkgbWVhc3VyZSwgd2UgbWF5IHdhbnQgdG8gaW5jbHVkZSBhIHN0cnVjdHVyZSB0byBzdG9yZSBuZWNlc3NhcnkKICAgICAqIGRhdGEgc2hvdWxkIHdlIGZpbmQgdGhhdCB3ZSByZXF1aXJlIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24uCiAgICAgKiBAbm90aWNlOiBub3QgeWV0IHVzZWQKICAgICAqLwogICAgbWFwcGluZyhieXRlczMyID0+IGJ5dGVzMzIpIHB1YmxpYyBtZXRhZGF0YTsKCiAgICAvKioKICAgICAqIFNldCBieSB0aGUgY29udHJvbGxlciB0byBpbmRpY2F0ZSB3aGVyZSB0aGUgdHJhbnNmZXJzIHNob3VsZCBnbyB0byBvbiBhIGJ1cm4KICAgICAqLwogICAgYWRkcmVzcyBwdWJsaWMgYnVybkFkZHJlc3M7CgogICAgLyoqCiAgICAgKiBNYXBwaW5nIGFsbG93aW5nIHVzIHRvIGlkZW50aWZ5IHRoZSBicmlkZ2Ugbm9kZXMsIGluIHRoZSBjdXJyZW50IHNldHVwCiAgICAgKiBtYW5pcHVsYXRpb24gb2YgdGhpcyBtYXBwaW5nIGlzIG9ubHkgYWNjZXNzaWJsZSBieSB0aGUgcGFyYW1ldGVyLgogICAgICovCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIGJyaWRnZU5vZGVzOwoKICAgIC8vIGZ1bmN0aW9ucyBiZWxvdyB0aGlzIGxpbmUgYXJlIG9ubHlPd25lcgoKICAgIGZ1bmN0aW9uIExlZGdlcigpIHsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRDb250cm9sbGVyKGFkZHJlc3MgX2NvbnRyb2xsZXIpIG9ubHlPd25lciBub3RGaW5hbGl6ZWQgewogICAgICAgIGNvbnRyb2xsZXIgPSBDb250cm9sbGVyKF9jb250cm9sbGVyKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgICAgICAgICBUbyBiZSBjYWxsZWQgb25jZSBtaW50aW5nIGlzIGNvbXBsZXRlLCBkaXNhYmxlcyBtaW50aW5nLiAgCiAgICAgKi8KICAgIGZ1bmN0aW9uIHN0b3BNaW50aW5nKCkgb25seU93bmVyIHsKICAgICAgICBtaW50aW5nU3RvcHBlZCA9IHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2ICAgICAgICAgVXNlZCB0byBtaW50IGEgYmF0Y2ggb2YgY3VycmVuY3kgYXQgb25jZS4KICAgICAqIAogICAgICogQG5vdGljZSAgICAgIFRoaXMgZ2l2ZXMgdXMgYSBtYXhpbXVtIG9mIDJeOTYgdG9rZW5zIHBlciB1c2VyLgogICAgICogQG5vdGljZSAgICAgIEV4cGVjdGVkIHBhY2tlZCBzdHJ1Y3R1cmUgaXMgW0FERFIoMjApIHwgVkFMVUUoMTIpXS4KICAgICAqCiAgICAgKiBAcGFyYW0gICAgICAgbm9uY2UgICBUaGUgbWludGluZyBub25jZSwgYW4gaW5jb3JyZWN0IG5vbmNlIGlzIHJlamVjdGVkLgogICAgICogQHBhcmFtICAgICAgIGJpdHMgICAgQW4gYXJyYXkgb2YgcGFja2VkIGJ5dGVzIG9mIGFkZHJlc3MsIHZhbHVlIG1hcHBpbmdzLiAgCiAgICAgKgogICAgICovCiAgICBmdW5jdGlvbiBtdWx0aU1pbnQodWludCBub25jZSwgdWludDI1NltdIGJpdHMpIG9ubHlPd25lciB7CiAgICAgICAgcmVxdWlyZSghbWludGluZ1N0b3BwZWQpOwogICAgICAgIGlmIChub25jZSAhPSBtaW50aW5nTm9uY2UpIHJldHVybjsKICAgICAgICBtaW50aW5nTm9uY2UgKz0gMTsKICAgICAgICB1aW50MjU2IGxvbWFzayA9ICgxIDw8IDk2KSAtIDE7CiAgICAgICAgdWludCBjcmVhdGVkID0gMDsKICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPGJpdHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgYWRkcmVzcyBhID0gYWRkcmVzcyhiaXRzW2ldPj45Nik7CiAgICAgICAgICAgIHVpbnQgdmFsdWUgPSBiaXRzW2ldJmxvbWFzazsKICAgICAgICAgICAgYmFsYW5jZU9mW2FdID0gYmFsYW5jZU9mW2FdICsgdmFsdWU7CiAgICAgICAgICAgIGNvbnRyb2xsZXIubGVkZ2VyVHJhbnNmZXIoMCwgYSwgdmFsdWUpOwogICAgICAgICAgICBjcmVhdGVkICs9IHZhbHVlOwogICAgICAgIH0KICAgICAgICB0b3RhbFN1cHBseSArPSBjcmVhdGVkOwogICAgfQoKICAgIC8vIGZ1bmN0aW9ucyBiZWxvdyB0aGlzIGxpbmUgYXJlIG9ubHlDb250cm9sbGVyCgogICAgbW9kaWZpZXIgb25seUNvbnRyb2xsZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkZHJlc3MoY29udHJvbGxlcikpOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5Q29udHJvbGxlciByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBpZiAoYmFsYW5jZU9mW19mcm9tXSA8IF92YWx1ZSkgcmV0dXJuIGZhbHNlOwoKICAgICAgICBiYWxhbmNlT2ZbX2Zyb21dID0gc2FmZVN1YihiYWxhbmNlT2ZbX2Zyb21dLCBfdmFsdWUpOwogICAgICAgIGJhbGFuY2VPZltfdG9dID0gc2FmZUFkZChiYWxhbmNlT2ZbX3RvXSwgX3ZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfc3BlbmRlciwgYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5Q29udHJvbGxlciByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBpZiAoYmFsYW5jZU9mW19mcm9tXSA8IF92YWx1ZSkgcmV0dXJuIGZhbHNlOwoKICAgICAgICB2YXIgYWxsb3dlZCA9IGFsbG93YW5jZVtfZnJvbV1bX3NwZW5kZXJdOwogICAgICAgIGlmIChhbGxvd2VkIDwgX3ZhbHVlKSByZXR1cm4gZmFsc2U7CgogICAgICAgIGJhbGFuY2VPZltfdG9dID0gc2FmZUFkZChiYWxhbmNlT2ZbX3RvXSwgX3ZhbHVlKTsKICAgICAgICBiYWxhbmNlT2ZbX2Zyb21dID0gc2FmZVN1YihiYWxhbmNlT2ZbX2Zyb21dLCBfdmFsdWUpOwogICAgICAgIGFsbG93YW5jZVtfZnJvbV1bX3NwZW5kZXJdID0gc2FmZVN1YihhbGxvd2VkLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSBvbmx5Q29udHJvbGxlciByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICAvLyByZXF1aXJlIHVzZXIgdG8gc2V0IHRvIHplcm8gYmVmb3JlIHJlc2V0dGluZyB0byBub256ZXJvCiAgICAgICAgaWYgKChfdmFsdWUgIT0gMCkgJiYgKGFsbG93YW5jZVtfb3duZXJdW19zcGVuZGVyXSAhPSAwKSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBhbGxvd2FuY2VbX293bmVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIG9ubHlDb250cm9sbGVyIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2FuY2VbX293bmVyXVtfc3BlbmRlcl07CiAgICAgICAgYWxsb3dhbmNlW19vd25lcl1bX3NwZW5kZXJdID0gc2FmZUFkZChvbGRWYWx1ZSwgX2FkZGVkVmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpIG9ubHlDb250cm9sbGVyIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2FuY2VbX293bmVyXVtfc3BlbmRlcl07CiAgICAgICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICAgICAgICBhbGxvd2FuY2VbX293bmVyXVtfc3BlbmRlcl0gPSAwOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFsbG93YW5jZVtfb3duZXJdW19zcGVuZGVyXSA9IHNhZmVTdWIob2xkVmFsdWUsIF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRQcm9vZih1aW50MjU2IF9rZXksIGJ5dGVzMzIgX3Byb29mKSBvbmx5Q29udHJvbGxlciB7CiAgICAgICAgcHJvb2ZzW19rZXldID0gX3Byb29mOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldExvY2tlZChhZGRyZXNzIF9rZXksIHVpbnQyNTYgX3ZhbHVlKSBvbmx5Q29udHJvbGxlciB7CiAgICAgICAgbG9ja2VkW19rZXldID0gX3ZhbHVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldE1ldGFkYXRhKGJ5dGVzMzIgX2tleSwgYnl0ZXMzMiBfdmFsdWUpIG9ubHlDb250cm9sbGVyIHsKICAgICAgICBtZXRhZGF0YVtfa2V5XSA9IF92YWx1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEJ1cm4gcmVsYXRlZCBmdW5jdGlvbmFsaXR5CiAgICAgKi8KCiAgICAvKioKICAgICAqIEBkZXYgICAgICAgIHNldHMgdGhlIGJ1cm4gYWRkcmVzcyB0byB0aGUgbmV3IHZhbHVlCiAgICAgKgogICAgICogQHBhcmFtICAgICAgX2FkZHJlc3MgIFRoZSBhZGRyZXNzCiAgICAgKgogICAgICovCiAgICBmdW5jdGlvbiBzZXRCdXJuQWRkcmVzcyhhZGRyZXNzIF9hZGRyZXNzKSBvbmx5Q29udHJvbGxlciB7CiAgICAgICAgYnVybkFkZHJlc3MgPSBfYWRkcmVzczsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRCcmlkZ2VOb2RlKGFkZHJlc3MgX2FkZHJlc3MsIGJvb2wgZW5hYmxlZCkgb25seUNvbnRyb2xsZXIgewogICAgICAgIGJyaWRnZU5vZGVzW19hZGRyZXNzXSA9IGVuYWJsZWQ7CiAgICB9Cn0KCmNvbnRyYWN0IENvbnRyb2xsZXJFdmVudERlZmluaXRpb25zIHsKICAgIC8qKgogICAgICogQW4gaW50ZXJuYWwgYnVybiBldmVudCwgZW1pdHRlZCBieSB0aGUgY29udHJvbGxlciBjb250cmFjdAogICAgICogd2hpY2ggdGhlIGJyaWRnZXMgY291bGQgYmUgbGlzdGVuaW5nIHRvLgogICAgICovCiAgICBldmVudCBDb250cm9sbGVyQnVybihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYnl0ZXMzMiBpbmRleGVkIHRvLCB1aW50IHZhbHVlKTsKfQoKLyoqCiAqIEB0aXRsZSBDb250cm9sbGVyIGZvciBidXNpbmVzcyBsb2dpYyBiZXR3ZWVuIHRoZSBFUkMyMCBBUEkgYW5kIFN0YXRlCiAqCiAqIENvbnRyb2xsZXIgaXMgcmVzcG9uc2libGUgZm9yIHRoZSBidXNpbmVzcyBsb2dpYyB0aGF0IHNpdHMgaW4gYmV0d2VlbgogKiB0aGUgTGVkZ2VyIChtb2RlbCkgYW5kIHRoZSBUb2tlbiAodmlldykuIFByZXNlbnRseSwgYWRoZXJlbmNlIHRvIHRoaXMgbW9kZWwKICogaXMgbm90IHN0cmljdCwgYnV0IHdlIGV4cGVjdCBmdXR1cmUgZnVuY3Rpb25hbGl0eSAoQnVybmluZywgQ2xhaW1pbmcpIHRvIGFkaGVyZQogKiB0byB0aGlzIG1vZGVsIG1vcmUgY2xvc2VseS4KICogCiAqIFRoZSBjb250cm9sbGVyIG11c3QgYmUgbGlua2VkIHRvIGEgVG9rZW4gYW5kIExlZGdlciB0byBiZWNvbWUgZnVuY3Rpb25hbC4KICogCiAqLwpjb250cmFjdCBDb250cm9sbGVyIGlzIE93bmVkLCBGaW5hbGl6YWJsZSwgQ29udHJvbGxlckV2ZW50RGVmaW5pdGlvbnMgewogICAgTGVkZ2VyIHB1YmxpYyBsZWRnZXI7CiAgICBUb2tlbiBwdWJsaWMgdG9rZW47CiAgICBhZGRyZXNzIHB1YmxpYyBidXJuQWRkcmVzczsKCiAgICBmdW5jdGlvbiBDb250cm9sbGVyKCkgewogICAgfQoKICAgIC8vIGZ1bmN0aW9ucyBiZWxvdyB0aGlzIGxpbmUgYXJlIG9ubHlPd25lcgoKCiAgICBmdW5jdGlvbiBzZXRUb2tlbihhZGRyZXNzIF90b2tlbikgb25seU93bmVyIHsKICAgICAgICB0b2tlbiA9IFRva2VuKF90b2tlbik7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0TGVkZ2VyKGFkZHJlc3MgX2xlZGdlcikgb25seU93bmVyIHsKICAgICAgICBsZWRnZXIgPSBMZWRnZXIoX2xlZGdlcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGV2ICAgICAgICAgU2V0cyB0aGUgYnVybiBhZGRyZXNzIGJ1cm4gdmFsdWVzIGdldCBtb3ZlZCB0by4gT25seSBjYWxsCiAgICAgKiAgICAgICAgICAgICAgYWZ0ZXIgdG9rZW4gYW5kIGxlZGdlciBjb250cmFjdHMgaGF2ZSBiZWVuIGhvb2tlZCB1cC4gRW5zdXJlcwogICAgICogICAgICAgICAgICAgIHRoYXQgYWxsIHRocmVlIHZhbHVlcyBhcmUgc2V0IGF0b21pY2FsbHkuCiAgICAgKiAgICAgICAgICAgICAKICAgICAqIEBub3RpY2UgICAgICBOZXcgRnVuY3Rpb25hbGl0eQogICAgICoKICAgICAqIEBwYXJhbSAgICAgICBfYWRkcmVzcyAgICBkZXNpcmVkIGFkZHJlc3MKICAgICAqCiAgICAgKi8KICAgIGZ1bmN0aW9uIHNldEJ1cm5BZGRyZXNzKGFkZHJlc3MgX2FkZHJlc3MpIG9ubHlPd25lciB7CiAgICAgICAgYnVybkFkZHJlc3MgPSBfYWRkcmVzczsKICAgICAgICBsZWRnZXIuc2V0QnVybkFkZHJlc3MoX2FkZHJlc3MpOwogICAgICAgIHRva2VuLnNldEJ1cm5BZGRyZXNzKF9hZGRyZXNzKTsKICAgIH0KCiAgICBtb2RpZmllciBvbmx5VG9rZW4oKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkZHJlc3ModG9rZW4pKTsKICAgICAgICBfOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlMZWRnZXIoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGFkZHJlc3MobGVkZ2VyKSk7CiAgICAgICAgXzsKICAgIH0KCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gbGVkZ2VyLnRvdGFsU3VwcGx5KCk7CiAgICB9CgogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX2EpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gbGVkZ2VyLmJhbGFuY2VPZihfYSk7CiAgICB9CgogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIGxlZGdlci5hbGxvd2FuY2UoX293bmVyLCBfc3BlbmRlcik7CiAgICB9CgogICAgLy8gZnVuY3Rpb25zIGJlbG93IHRoaXMgbGluZSBhcmUgb25seUxlZGdlcgoKICAgIC8vIGxldCB0aGUgbGVkZ2VyIHNlbmQgdHJhbnNmZXIgZXZlbnRzICh0aGUgbW9zdCBvYnZpb3VzIGNhc2UKICAgIC8vIGlzIHdoZW4gd2UgbWludCBkaXJlY3RseSB0byB0aGUgbGVkZ2VyIGFuZCBuZWVkIHRoZSBUcmFuc2ZlcigpCiAgICAvLyBldmVudHMgdG8gYXBwZWFyIGluIHRoZSB0b2tlbikKICAgIGZ1bmN0aW9uIGxlZGdlclRyYW5zZmVyKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludCB2YWwpIG9ubHlMZWRnZXIgewogICAgICAgIHRva2VuLmNvbnRyb2xsZXJUcmFuc2Zlcihmcm9tLCB0bywgdmFsKTsKICAgIH0KCiAgICAvLyBmdW5jdGlvbnMgYmVsb3cgdGhpcyBsaW5lIGFyZSBvbmx5VG9rZW4KCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIG9ubHlUb2tlbiByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXR1cm4gbGVkZ2VyLnRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX3NwZW5kZXIsIGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seVRva2VuIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJldHVybiBsZWRnZXIudHJhbnNmZXJGcm9tKF9zcGVuZGVyLCBfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSBvbmx5VG9rZW4gcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmV0dXJuIGxlZGdlci5hcHByb3ZlKF9vd25lciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIG9ubHlUb2tlbiByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXR1cm4gbGVkZ2VyLmluY3JlYXNlQXBwcm92YWwoX293bmVyLCBfc3BlbmRlciwgX2FkZGVkVmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpIG9ubHlUb2tlbiByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXR1cm4gbGVkZ2VyLmRlY3JlYXNlQXBwcm92YWwoX293bmVyLCBfc3BlbmRlciwgX3N1YnRyYWN0ZWRWYWx1ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBFbmQgT3JpZ2luYWwgQ29udHJhY3QKICAgICAqIEJlbG93IGlzIG5ldyBmdW5jdGlvbmFsaXR5CiAgICAgKi8KCiAgICAvKioKICAgICAqIEBkZXYgICAgICAgIEVuYWJsZXMgYnVybmluZyBvbiB0aGUgdG9rZW4gY29udHJhY3QKICAgICAqLwogICAgZnVuY3Rpb24gZW5hYmxlQnVybmluZygpIG9ubHlPd25lciB7CiAgICAgICAgdG9rZW4uZW5hYmxlQnVybmluZygpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiAgICAgICAgRGlzYWJsZXMgYnVybmluZyBvbiB0aGUgdG9rZW4gY29udHJhY3QKICAgICAqLwogICAgZnVuY3Rpb24gZGlzYWJsZUJ1cm5pbmcoKSBvbmx5T3duZXIgewogICAgICAgIHRva2VuLmRpc2FibGVCdXJuaW5nKCk7CiAgICB9CgogICAgLy8gcHVibGljIGZ1bmN0aW9ucwoKICAgIC8qKgogICAgICogQGRldiAgICAgICAgIAogICAgICoKICAgICAqIEBwYXJhbSAgICAgICBfZnJvbSAgICAgICBhY2NvdW50IHRoZSB2YWx1ZSBpcyBidXJuZWQgZnJvbQogICAgICogQHBhcmFtICAgICAgIF90byAgICAgICAgIHRoZSBhZGRyZXNzIHJlY2VpdmluZyB0aGUgdmFsdWUKICAgICAqIEBwYXJhbSAgICAgICBfYW1vdW50ICAgICB0aGUgdmFsdWUgYW1vdW50CiAgICAgKiAKICAgICAqIEByZXR1cm4gICAgICBzdWNjZXNzICAgICBvcGVyYXRpb24gc3VjY2Vzc2Z1bCBvciBub3QuCiAgICAgKi8gCiAgICBmdW5jdGlvbiBidXJuKGFkZHJlc3MgX2Zyb20sIGJ5dGVzMzIgX3RvLCB1aW50IF9hbW91bnQpIG9ubHlUb2tlbiByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBpZiAobGVkZ2VyLnRyYW5zZmVyKF9mcm9tLCBidXJuQWRkcmVzcywgX2Ftb3VudCkpIHsKICAgICAgICAgICAgQ29udHJvbGxlckJ1cm4oX2Zyb20sIF90bywgX2Ftb3VudCk7CiAgICAgICAgICAgIHRva2VuLmNvbnRyb2xsZXJCdXJuKF9mcm9tLCBfdG8sIF9hbW91bnQpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiAgICAgICAgIEltcGxlbWVudGF0aW9uIGZvciBjbGFpbSBtZWNoYW5pc20uIE5vdGUgdGhhdCB0aGlzIG1lY2hhbmlzbSBoYXMgbm90IHlldAogICAgICogICAgICAgICAgICAgIGJlZW4gaW1wbGVtZW50ZWQuIFRoaXMgZnVuY3Rpb24gaXMgb25seSBoZXJlIGZvciBmdXR1cmUgZXhwYW5zaW9uIGNhcGFiaWxpdGllcy4KICAgICAqICAgICAgICAgICAgICBQcmVzZW50bHksIGp1c3QgcmV0dXJucyBmYWxzZSB0byBpbmRpY2F0ZSBmYWlsdXJlLgogICAgICogICAgICAgICAgICAgIAogICAgICogQG5vdGljZSAgICAgIE9ubHkgb25lIG9mIGNsYWltQnlQcm9vZigpIG9yIGNsYWltKCkgd2lsbCBwb3RlbnRpYWxseSBiZSBhY3RpdmF0ZWQgaW4gdGhlIGZ1dHVyZS4KICAgICAqICAgICAgICAgICAgICBEZXBlbmRpbmcgb24gdGhlIGZ1bmN0aW9uYWxpdHkgcmVxdWlyZWQgYW5kIHJvdXRlIHNlbGVjdGVkLiAKICAgICAqCiAgICAgKiBAcGFyYW0gICAgICAgX2NsYWltZXIgICAgVGhlIGluZGl2aWR1YWwgY2xhaW1pbmcgdGhlIHRva2VucyAoYWxzbyB0aGUgcmVjaXBpZW50IG9mIHNhaWQgdG9rZW5zKS4KICAgICAqIEBwYXJhbSAgICAgICBkYXRhICAgICAgICBUaGUgaW5wdXQgZGF0YSByZXF1aXJlZCB0byByZWxlYXNlIHRoZSB0b2tlbnMuCiAgICAgKiBAcGFyYW0gICAgICAgc3VjY2VzcyAgICAgVGhlIHByb29mcyBhc3NvY2lhdGVkIHdpdGggdGhlIGRhdGEsIHRvIGluZGljYXRlIHRoZSBsZWdpdGltYWN5IG9mIHNhaWQgZGF0YS4KICAgICAqIEBwYXJhbSAgICAgICBudW1iZXIgICAgICBUaGUgYmxvY2sgbnVtYmVyIHRoZSBwcm9vZnMgYW5kIGRhdGEgY29ycmVzcG9uZCB0by4KICAgICAqCiAgICAgKiBAcmV0dXJuICAgICAgc3VjY2VzcyAgICAgb3BlcmF0aW9uIHN1Y2Nlc3NmdWwgb3Igbm90LgogICAgICogCiAgICAgKi8KICAgIGZ1bmN0aW9uIGNsYWltQnlQcm9vZihhZGRyZXNzIF9jbGFpbWVyLCBieXRlczMyW10gZGF0YSwgYnl0ZXMzMltdIHByb29mcywgdWludDI1NiBudW1iZXIpCiAgICAgICAgb25seVRva2VuCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiAgICAgICAgIEltcGxlbWVudGF0aW9uIGZvciBhbiBhbHRlcm5hdGl2ZSBjbGFpbSBtZWNoYW5pc20sIGluIHdoaWNoIHRoZSBwYXJ0aWNpcGFudAogICAgICogICAgICAgICAgICAgIGlzIG5vdCByZXF1aXJlZCB0byBjb25maXJtIHRocm91Z2ggcHJvb2ZzLiBOb3RlIHRoYXQgdGhpcyBtZWNoYW5pc20gaGFzIG5vdAogICAgICogICAgICAgICAgICAgIHlldCBiZWVuIGltcGxlbWVudGVkLgogICAgICogICAgICAgICAgICAgIAogICAgICogQG5vdGljZSAgICAgIE9ubHkgb25lIG9mIGNsYWltQnlQcm9vZigpIG9yIGNsYWltKCkgd2lsbCBwb3RlbnRpYWxseSBiZSBhY3RpdmF0ZWQgaW4gdGhlIGZ1dHVyZS4KICAgICAqICAgICAgICAgICAgICBEZXBlbmRpbmcgb24gdGhlIGZ1bmN0aW9uYWxpdHkgcmVxdWlyZWQgYW5kIHJvdXRlIHNlbGVjdGVkLgogICAgICogCiAgICAgKiBAcGFyYW0gICAgICAgX2NsYWltZXIgICAgVGhlIGluZGl2aWR1YWwgY2xhaW1pbmcgdGhlIHRva2VucyAoYWxzbyB0aGUgcmVjaXBpZW50IG9mIHNhaWQgdG9rZW5zKS4KICAgICAqIAogICAgICogQHJldHVybiAgICAgIHN1Y2Nlc3MgICAgIG9wZXJhdGlvbiBzdWNjZXNzZnVsIG9yIG5vdC4KICAgICAqLwogICAgZnVuY3Rpb24gY2xhaW0oYWRkcmVzcyBfY2xhaW1lcikgb25seVRva2VuIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KfQoKY29udHJhY3QgVG9rZW4gaXMgRmluYWxpemFibGUsIFRva2VuUmVjZWl2YWJsZSwgU2FmZU1hdGgsIEV2ZW50RGVmaW5pdGlvbnMsIFBhdXNhYmxlIHsKICAgIC8vIFNldCB0aGVzZSBhcHByb3ByaWF0ZWx5IGJlZm9yZSB5b3UgZGVwbG95CiAgICBzdHJpbmcgY29uc3RhbnQgcHVibGljIG5hbWUgPSAiQUlPTiI7CiAgICB1aW50OCBjb25zdGFudCBwdWJsaWMgZGVjaW1hbHMgPSA4OwogICAgc3RyaW5nIGNvbnN0YW50IHB1YmxpYyBzeW1ib2wgPSAiQUlPTiI7CiAgICBDb250cm9sbGVyIHB1YmxpYyBjb250cm9sbGVyOwogICAgc3RyaW5nIHB1YmxpYyBtb3RkOwogICAgZXZlbnQgTW90ZChzdHJpbmcgbWVzc2FnZSk7CgogICAgYWRkcmVzcyBwdWJsaWMgYnVybkFkZHJlc3M7IC8vQEFUVEVOVElPTjogc2V0IHRoaXMgdG8gYSBjb3JyZWN0IHZhbHVlCiAgICBib29sIHB1YmxpYyBidXJuYWJsZSA9IGZhbHNlOwoKICAgIC8vIGZ1bmN0aW9ucyBiZWxvdyB0aGlzIGxpbmUgYXJlIG9ubHlPd25lcgoKICAgIC8vIHNldCAibWVzc2FnZSBvZiB0aGUgZGF5IgogICAgZnVuY3Rpb24gc2V0TW90ZChzdHJpbmcgX20pIG9ubHlPd25lciB7CiAgICAgICAgbW90ZCA9IF9tOwogICAgICAgIE1vdGQoX20pOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldENvbnRyb2xsZXIoYWRkcmVzcyBfYykgb25seU93bmVyIG5vdEZpbmFsaXplZCB7CiAgICAgICAgY29udHJvbGxlciA9IENvbnRyb2xsZXIoX2MpOwogICAgfQoKICAgIC8vIGZ1bmN0aW9ucyBiZWxvdyB0aGlzIGxpbmUgYXJlIHB1YmxpYwoKICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIGEpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gY29udHJvbGxlci5iYWxhbmNlT2YoYSk7CiAgICB9CgogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7CiAgICAgICAgcmV0dXJuIGNvbnRyb2xsZXIudG90YWxTdXBwbHkoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsKICAgICAgICByZXR1cm4gY29udHJvbGxlci5hbGxvd2FuY2UoX293bmVyLCBfc3BlbmRlcik7CiAgICB9CgogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBub3RQYXVzZWQgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgaWYgKGNvbnRyb2xsZXIudHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpKSB7CiAgICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBub3RQYXVzZWQgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgaWYgKGNvbnRyb2xsZXIudHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIF9mcm9tLCBfdG8sIF92YWx1ZSkpIHsKICAgICAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSBub3RQYXVzZWQgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgLy8gcHJvbW90ZSBzYWZlIHVzZXIgYmVoYXZpb3IKICAgICAgICBpZiAoY29udHJvbGxlci5hcHByb3ZlKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpKSB7CiAgICAgICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIG5vdFBhdXNlZCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICBpZiAoY29udHJvbGxlci5pbmNyZWFzZUFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfYWRkZWRWYWx1ZSkpIHsKICAgICAgICAgICAgdWludCBuZXd2YWwgPSBjb250cm9sbGVyLmFsbG93YW5jZShtc2cuc2VuZGVyLCBfc3BlbmRlcik7CiAgICAgICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBuZXd2YWwpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkgbm90UGF1c2VkIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIGlmIChjb250cm9sbGVyLmRlY3JlYXNlQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF9zdWJ0cmFjdGVkVmFsdWUpKSB7CiAgICAgICAgICAgIHVpbnQgbmV3dmFsID0gY29udHJvbGxlci5hbGxvd2FuY2UobXNnLnNlbmRlciwgX3NwZW5kZXIpOwogICAgICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgbmV3dmFsKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvLyBtb2RpZmllciBvbmx5UGF5bG9hZFNpemUodWludCBudW13b3JkcykgewogICAgLy8gICAgIGFzc2VydChtc2cuZGF0YS5sZW5ndGggPj0gbnVtd29yZHMgKiAzMiArIDQpOwogICAgLy8gICAgIF87CiAgICAvLyB9CgogICAgLy8gZnVuY3Rpb25zIGJlbG93IHRoaXMgbGluZSBhcmUgb25seUNvbnRyb2xsZXIKCiAgICBtb2RpZmllciBvbmx5Q29udHJvbGxlcigpIHsKICAgICAgICBhc3NlcnQobXNnLnNlbmRlciA9PSBhZGRyZXNzKGNvbnRyb2xsZXIpKTsKICAgICAgICBfOwogICAgfQoKICAgIC8vIEluIHRoZSBmdXR1cmUsIHdoZW4gdGhlIGNvbnRyb2xsZXIgc3VwcG9ydHMgbXVsdGlwbGUgdG9rZW4KICAgIC8vIGhlYWRzLCBhbGxvdyB0aGUgY29udHJvbGxlciB0byByZWNvbnN0aXR1dGUgdGhlIHRyYW5zZmVyIGFuZAogICAgLy8gYXBwcm92YWwgaGlzdG9yeS4KCiAgICBmdW5jdGlvbiBjb250cm9sbGVyVHJhbnNmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5Q29udHJvbGxlciB7CiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjb250cm9sbGVyQXBwcm92ZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlciwgdWludCBfdmFsdWUpIG9ubHlDb250cm9sbGVyIHsKICAgICAgICBBcHByb3ZhbChfb3duZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiAgICAgICAgQnVybiBldmVudCBwb3NzaWJseSBjYWxsZWQgYnkgdGhlIGNvbnRyb2xsZXIgb24gYSBidXJuLiBUaGlzIGlzCiAgICAgKiAgICAgICAgICAgICB0aGUgcHVibGljIGZhY2luZyBldmVudCB0aGF0IGFueW9uZSBjYW4gdHJhY2ssIHRoZSBicmlkZ2VzIGxpc3RlbgogICAgICogICAgICAgICAgICAgdG8gYW4gYWx0ZXJuYXRpdmUgZXZlbnQgZW1pdHRlZCBieSB0aGUgY29udHJvbGxlci4KICAgICAqCiAgICAgKiBAcGFyYW0gICAgICBfZnJvbSAgIGFkZHJlc3MgdGhhdCBjb2lucyBhcmUgYnVybmVkIGZyb20KICAgICAqIEBwYXJhbSAgICAgIF90byAgICAgYWRkcmVzcyAob24gb3RoZXIgbmV0d29yaykgdGhhdCBjb2lucyBhcmUgcmVjZWl2ZWQgYnkKICAgICAqIEBwYXJhbSAgICAgIF92YWx1ZSAgYW1vdW50IG9mIHZhbHVlIHRvIGJlIGJ1cm5lZAogICAgICoKICAgICAqIEByZXR1cm4gICAgIHsgZGVzY3JpcHRpb25fb2ZfdGhlX3JldHVybl92YWx1ZSB9CiAgICAgKi8KICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXJCdXJuKGFkZHJlc3MgX2Zyb20sIGJ5dGVzMzIgX3RvLCB1aW50MjU2IF92YWx1ZSkgb25seUNvbnRyb2xsZXIgewogICAgICAgIEJ1cm4oX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjb250cm9sbGVyQ2xhaW0oYWRkcmVzcyBfY2xhaW1lciwgdWludDI1NiBfdmFsdWUpIG9ubHlDb250cm9sbGVyIHsKICAgICAgICBDbGFpbWVkKF9jbGFpbWVyLCBfdmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiAgICAgICAgU2V0cyB0aGUgYnVybiBhZGRyZXNzIHRvIGEgbmV3IHZhbHVlCiAgICAgKgogICAgICogQHBhcmFtICAgICAgX2FkZHJlc3MgIFRoZSBhZGRyZXNzCiAgICAgKgogICAgICovCiAgICBmdW5jdGlvbiBzZXRCdXJuQWRkcmVzcyhhZGRyZXNzIF9hZGRyZXNzKSBvbmx5Q29udHJvbGxlciB7CiAgICAgICAgYnVybkFkZHJlc3MgPSBfYWRkcmVzczsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgICAgICAgICBFbmFibGVzIGJ1cm5pbmcgdGhyb3VnaCBidXJuYWJsZSBib29sCiAgICAgKgogICAgICovCiAgICBmdW5jdGlvbiBlbmFibGVCdXJuaW5nKCkgb25seUNvbnRyb2xsZXIgewogICAgICAgIGJ1cm5hYmxlID0gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgICAgICAgICBEaXNhYmxlcyBidXJuaW5nIHRocm91Z2ggYnVybmFibGUgYm9vbAogICAgICoKICAgICAqLwogICAgZnVuY3Rpb24gZGlzYWJsZUJ1cm5pbmcoKSBvbmx5Q29udHJvbGxlciB7CiAgICAgICAgYnVybmFibGUgPSBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgICAgICAgICBJbmRpY2F0ZXMgdGhhdCBidXJuaW5nIGlzIGVuYWJsZWQKICAgICAqLwogICAgbW9kaWZpZXIgYnVybkVuYWJsZWQoKSB7CiAgICAgICAgcmVxdWlyZShidXJuYWJsZSA9PSB0cnVlKTsKICAgICAgICBfOwogICAgfQoKICAgIC8qKgogICAgICogQGRldiAgICAgICAgIGJ1cm4gZnVuY3Rpb24sIGNoYW5nZWQgZnJvbSBvcmlnaW5hbCBpbXBsZW1lbnRhdGlvbi4gUHVibGljIGZhY2luZyBBUEkKICAgICAqICAgICAgICAgICAgICBpbmRpY2F0aW5nIHdobyB0aGUgdG9rZW4gaG9sZGVyIHdhbnRzIHRvIGJ1cm4gY3VycmVuY3kgdG8gYW5kIHRoZSBhbW91bnQuCiAgICAgKgogICAgICogQHBhcmFtICAgICAgIF9hbW91bnQgIFRoZSBhbW91bnQKICAgICAqCiAgICAgKi8KICAgIGZ1bmN0aW9uIGJ1cm4oYnl0ZXMzMiBfdG8sIHVpbnQgX2Ftb3VudCkgbm90UGF1c2VkIGJ1cm5FbmFibGVkIHJldHVybnMgKGJvb2wgc3VjY2VzcykgewogICAgICAgIHJldHVybiBjb250cm9sbGVyLmJ1cm4obXNnLnNlbmRlciwgX3RvLCBfYW1vdW50KTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgICAgICAgICBjbGFpbSAocXVhbnR1bVJlY2VpdmUpIGFsbG93cyB0aGUgdXNlciB0byAicHJvdmUiIHNvbWUgYW4gSUNUIHRvIHRoZSBjb250cmFjdAogICAgICogICAgICAgICAgICAgIHRoZXJlYnkgdGhlcmVieSByZWxlYXNpbmcgdGhlIHRva2VucyBpbnRvIHRoZWlyIGFjY291bnQKICAgICAqIAogICAgICovCiAgICBmdW5jdGlvbiBjbGFpbUJ5UHJvb2YoYnl0ZXMzMltdIGRhdGEsIGJ5dGVzMzJbXSBwcm9vZnMsIHVpbnQyNTYgbnVtYmVyKSBub3RQYXVzZWQgYnVybkVuYWJsZWQgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgcmV0dXJuIGNvbnRyb2xsZXIuY2xhaW1CeVByb29mKG1zZy5zZW5kZXIsIGRhdGEsIHByb29mcywgbnVtYmVyKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXYgICAgICAgICBTaW1wbGlmaWVkIHZlcnNpb24gb2YgY2xhaW0sIGp1c3QgcmVxdWlyZXMgdXNlciB0byBjYWxsIHRvIGNsYWltLgogICAgICogICAgICAgICAgICAgIE5vIHByb29mIGlzIG5lZWRlZCwgd2hpY2ggdmVyc2lvbiBpcyBjaG9zZW4gZGVwZW5kcyBvbiBvdXIgYnJpZGdpbmcgbW9kZWwuCiAgICAgKgogICAgICogQHJldHVybiAgICAgIAogICAgICovCiAgICBmdW5jdGlvbiBjbGFpbSgpIG5vdFBhdXNlZCBidXJuRW5hYmxlZCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsKICAgICAgICByZXR1cm4gY29udHJvbGxlci5jbGFpbShtc2cuc2VuZGVyKTsKICAgIH0KfQ=='.
	

]
