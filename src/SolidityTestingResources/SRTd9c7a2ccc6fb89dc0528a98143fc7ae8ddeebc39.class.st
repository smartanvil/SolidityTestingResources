Class {
	#name : #SRTd9c7a2ccc6fb89dc0528a98143fc7ae8ddeebc39,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTd9c7a2ccc6fb89dc0528a98143fc7ae8ddeebc39 >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTE7Cgpjb250cmFjdCBPd25hYmxlIHsKICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgZnVuY3Rpb24gT3duYWJsZSgpIHsKICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgbW9kaWZpZXIgb25seU93bmVyKCkgewogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgIF87CiAgfQoKCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciB7CiAgICBpZiAobmV3T3duZXIgIT0gYWRkcmVzcygwKSkgewogICAgICBvd25lciA9IG5ld093bmVyOwogICAgfQogIH0KCn0KCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgewogIGV2ZW50IFBhdXNlKCk7CiAgZXZlbnQgVW5wYXVzZSgpOwoKICBib29sIHB1YmxpYyBwYXVzZWQgPSBmYWxzZTsKCgogIC8qKgogICAqIEBkZXYgbW9kaWZpZXIgdG8gYWxsb3cgYWN0aW9ucyBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IElTIHBhdXNlZAogICAqLwogIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICByZXF1aXJlKCFwYXVzZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgbW9kaWZpZXIgdG8gYWxsb3cgYWN0aW9ucyBvbmx5IHdoZW4gdGhlIGNvbnRyYWN0IElTIE5PVCBwYXVzZWQKICAgKi8KICBtb2RpZmllciB3aGVuUGF1c2VkIHsKICAgIHJlcXVpcmUocGF1c2VkKTsKICAgIF87CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gcGF1c2UsIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUKICAgKi8KICBmdW5jdGlvbiBwYXVzZSgpIG9ubHlPd25lciB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wpIHsKICAgIHBhdXNlZCA9IHRydWU7CiAgICBQYXVzZSgpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gdW5wYXVzZSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgKi8KICBmdW5jdGlvbiB1bnBhdXNlKCkgb25seU93bmVyIHdoZW5QYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcGF1c2VkID0gZmFsc2U7CiAgICBVbnBhdXNlKCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5OwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7Cn0KCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sKTsKICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsKfQoKbGlicmFyeSBTYWZlTWF0aCB7CiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwCiAgICB1aW50MjU2IGMgPSBhIC8gYjsKICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikgewogICAgYXNzZXJ0KGIgPD0gYSk7CiAgICByZXR1cm4gYSAtIGI7CiAgfQoKICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsKICAgIHVpbnQyNTYgYyA9IGEgKyBiOwogICAgYXNzZXJ0KGMgPj0gYSk7CiAgICByZXR1cm4gYzsKICB9Cn0KCmNvbnRyYWN0IENyb3dkc2FsZSB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIC8vIFRoZSB0b2tlbiBiZWluZyBzb2xkCiAgTWludGFibGVUb2tlbiBwdWJsaWMgdG9rZW47CgogIC8vIHN0YXJ0IGFuZCBlbmQgYmxvY2sgd2hlcmUgaW52ZXN0bWVudHMgYXJlIGFsbG93ZWQgKGJvdGggaW5jbHVzaXZlKQogIHVpbnQyNTYgcHVibGljIHN0YXJ0QmxvY2s7CiAgdWludDI1NiBwdWJsaWMgZW5kQmxvY2s7CgogIC8vIGFkZHJlc3Mgd2hlcmUgZnVuZHMgYXJlIGNvbGxlY3RlZAogIGFkZHJlc3MgcHVibGljIHdhbGxldDsKCiAgLy8gaG93IG1hbnkgdG9rZW4gdW5pdHMgYSBidXllciBnZXRzIHBlciB3ZWkKICB1aW50MjU2IHB1YmxpYyByYXRlOwoKICAvLyBhbW91bnQgb2YgcmFpc2VkIG1vbmV5IGluIHdlaQogIHVpbnQyNTYgcHVibGljIHdlaVJhaXNlZDsKCiAgLyoqCiAgICogZXZlbnQgZm9yIHRva2VuIHB1cmNoYXNlIGxvZ2dpbmcKICAgKiBAcGFyYW0gcHVyY2hhc2VyIHdobyBwYWlkIGZvciB0aGUgdG9rZW5zCiAgICogQHBhcmFtIGJlbmVmaWNpYXJ5IHdobyBnb3QgdGhlIHRva2VucwogICAqIEBwYXJhbSB2YWx1ZSB3ZWlzIHBhaWQgZm9yIHB1cmNoYXNlCiAgICogQHBhcmFtIGFtb3VudCBhbW91bnQgb2YgdG9rZW5zIHB1cmNoYXNlZAogICAqLwogIGV2ZW50IFRva2VuUHVyY2hhc2UoYWRkcmVzcyBpbmRleGVkIHB1cmNoYXNlciwgYWRkcmVzcyBpbmRleGVkIGJlbmVmaWNpYXJ5LCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IGFtb3VudCk7CgoKICBmdW5jdGlvbiBDcm93ZHNhbGUodWludDI1NiBfc3RhcnRCbG9jaywgdWludDI1NiBfZW5kQmxvY2ssIHVpbnQyNTYgX3JhdGUsIGFkZHJlc3MgX3dhbGxldCkgewogICAgcmVxdWlyZShfc3RhcnRCbG9jayA+PSBibG9jay5udW1iZXIpOwogICAgcmVxdWlyZShfZW5kQmxvY2sgPj0gX3N0YXJ0QmxvY2spOwogICAgcmVxdWlyZShfcmF0ZSA+IDApOwogICAgcmVxdWlyZShfd2FsbGV0ICE9IDB4MCk7CgogICAgdG9rZW4gPSBjcmVhdGVUb2tlbkNvbnRyYWN0KCk7CiAgICBzdGFydEJsb2NrID0gX3N0YXJ0QmxvY2s7CiAgICBlbmRCbG9jayA9IF9lbmRCbG9jazsKICAgIHJhdGUgPSBfcmF0ZTsKICAgIHdhbGxldCA9IF93YWxsZXQ7CiAgfQoKICAvLyBjcmVhdGVzIHRoZSB0b2tlbiB0byBiZSBzb2xkLgogIC8vIG92ZXJyaWRlIHRoaXMgbWV0aG9kIHRvIGhhdmUgY3Jvd2RzYWxlIG9mIGEgc3BlY2lmaWMgbWludGFibGUgdG9rZW4uCiAgZnVuY3Rpb24gY3JlYXRlVG9rZW5Db250cmFjdCgpIGludGVybmFsIHJldHVybnMgKE1pbnRhYmxlVG9rZW4pIHsKICAgIHJldHVybiBuZXcgTWludGFibGVUb2tlbigpOwogIH0KCgogIC8vIGZhbGxiYWNrIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIGJ1eSB0b2tlbnMKICBmdW5jdGlvbiAoKSBwYXlhYmxlIHsKICAgIGJ1eVRva2Vucyhtc2cuc2VuZGVyKTsKICB9CgogIC8vIGxvdyBsZXZlbCB0b2tlbiBwdXJjaGFzZSBmdW5jdGlvbgogIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwYXlhYmxlIHsKICAgIHJlcXVpcmUoYmVuZWZpY2lhcnkgIT0gMHgwKTsKICAgIHJlcXVpcmUodmFsaWRQdXJjaGFzZSgpKTsKCiAgICB1aW50MjU2IHdlaUFtb3VudCA9IG1zZy52YWx1ZTsKCiAgICAvLyBjYWxjdWxhdGUgdG9rZW4gYW1vdW50IHRvIGJlIGNyZWF0ZWQKICAgIHVpbnQyNTYgdG9rZW5zID0gd2VpQW1vdW50Lm11bChyYXRlKTsKCiAgICAvLyB1cGRhdGUgc3RhdGUKICAgIHdlaVJhaXNlZCA9IHdlaVJhaXNlZC5hZGQod2VpQW1vdW50KTsKCiAgICB0b2tlbi5taW50KGJlbmVmaWNpYXJ5LCB0b2tlbnMpOwogICAgVG9rZW5QdXJjaGFzZShtc2cuc2VuZGVyLCBiZW5lZmljaWFyeSwgd2VpQW1vdW50LCB0b2tlbnMpOwoKICAgIGZvcndhcmRGdW5kcygpOwogIH0KCiAgLy8gc2VuZCBldGhlciB0byB0aGUgZnVuZCBjb2xsZWN0aW9uIHdhbGxldAogIC8vIG92ZXJyaWRlIHRvIGNyZWF0ZSBjdXN0b20gZnVuZCBmb3J3YXJkaW5nIG1lY2hhbmlzbXMKICBmdW5jdGlvbiBmb3J3YXJkRnVuZHMoKSBpbnRlcm5hbCB7CiAgICB3YWxsZXQudHJhbnNmZXIobXNnLnZhbHVlKTsKICB9CgogIC8vIEByZXR1cm4gdHJ1ZSBpZiB0aGUgdHJhbnNhY3Rpb24gY2FuIGJ1eSB0b2tlbnMKICBmdW5jdGlvbiB2YWxpZFB1cmNoYXNlKCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgdWludDI1NiBjdXJyZW50ID0gYmxvY2subnVtYmVyOwogICAgYm9vbCB3aXRoaW5QZXJpb2QgPSBjdXJyZW50ID49IHN0YXJ0QmxvY2sgJiYgY3VycmVudCA8PSBlbmRCbG9jazsKICAgIGJvb2wgbm9uWmVyb1B1cmNoYXNlID0gbXNnLnZhbHVlICE9IDA7CiAgICByZXR1cm4gd2l0aGluUGVyaW9kICYmIG5vblplcm9QdXJjaGFzZTsKICB9CgogIC8vIEByZXR1cm4gdHJ1ZSBpZiBjcm93ZHNhbGUgZXZlbnQgaGFzIGVuZGVkCiAgZnVuY3Rpb24gaGFzRW5kZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIGJsb2NrLm51bWJlciA+IGVuZEJsb2NrOwogIH0KCgp9Cgpjb250cmFjdCBXaGl0ZWxpc3RlZENyb3dkc2FsZSBpcyBDcm93ZHNhbGUsIE93bmFibGUgewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogICAgLy8gbGlzdCBvZiBhZGRyZXNzZXMgdGhhdCBjYW4gcHVyY2hhc2UgYmVmb3JlIGNyb3dkc2FsZSBvcGVucwogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgd2hpdGVsaXN0OwoKICAgIGZ1bmN0aW9uIGFkZFRvV2hpdGVsaXN0KGFkZHJlc3MgYnV5ZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoYnV5ZXIgIT0gMHgwKTsKICAgICAgICB3aGl0ZWxpc3RbYnV5ZXJdID0gdHJ1ZTsKICAgIH0KCiAgICAvLyBAcmV0dXJuIHRydWUgaWYgYnV5ZXIgaXMgd2hpdGVsaXN0ZWQKICAgIGZ1bmN0aW9uIGlzV2hpdGVsaXN0ZWQoYWRkcmVzcyBidXllcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gd2hpdGVsaXN0W2J1eWVyXTsKICAgIH0KCiAgICAvLyBvdmVycmlkaW5nIENyb3dkc2FsZSN2YWxpZFB1cmNoYXNlIHRvIGFkZCB3aGl0ZWxpc3QgbG9naWMKICAgIC8vIEByZXR1cm4gdHJ1ZSBpZiBidXllcnMgY2FuIGJ1eSBhdCB0aGUgbW9tZW50CiAgICBmdW5jdGlvbiB2YWxpZFB1cmNoYXNlKCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIC8vIFtUT0RPXSBpc3N1ZSB3aXRoIG92ZXJyaWRpbmcgYW5kIGFzc29jaWF0aXZpdHkgb2YgbG9naWNhbCBvcGVyYXRvcnMKICAgICAgICByZXR1cm4gc3VwZXIudmFsaWRQdXJjaGFzZSgpIHx8ICghaGFzRW5kZWQoKSAmJiBpc1doaXRlbGlzdGVkKG1zZy5zZW5kZXIpKTsKICAgIH0KCn0KCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgLyoqCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICogQGRldiBHZXRzIHRoZSBiYWxhbmNlIG9mIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy4KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLgogICogQHJldHVybiBBbiB1aW50MjU2IHJlcHJlc2VudGluZyB0aGUgYW1vdW50IG93bmVkIGJ5IHRoZSBwYXNzZWQgYWRkcmVzcy4KICAqLwogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7CiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICB9Cgp9Cgpjb250cmFjdCBDb250aW51b3VzU2FsZSB7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgICAvLyB0aW1lIGJ1Y2tldCBzaXplCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBCVUNLRVRfU0laRSA9IDEyIGhvdXJzOwoKICAgIC8vIHRoZSB0b2tlbiBiZWluZyBzb2xkCiAgICBNaW50YWJsZVRva2VuIHB1YmxpYyB0b2tlbjsKCiAgICAvLyBhZGRyZXNzIHdoZXJlIGZ1bmRzIGFyZSBjb2xsZWN0ZWQKICAgIGFkZHJlc3MgcHVibGljIHdhbGxldDsKCiAgICAvLyBhbW91bnQgb2YgdG9rZW5zIGVtaXR0ZWQgcGVyIHdlaQogICAgdWludDI1NiBwdWJsaWMgcmF0ZTsKCiAgICAvLyBhbW91bnQgb2YgcmFpc2VkIG1vbmV5IGluIHdlaQogICAgdWludDI1NiBwdWJsaWMgd2VpUmFpc2VkOwoKICAgIC8vIG1heCBhbW91bnQgb2YgdG9rZW5zIHRvIG1pbnQgcGVyIHRpbWUgYnVja2V0CiAgICB1aW50MjU2IHB1YmxpYyBpc3N1YW5jZTsKCiAgICAvLyBsYXN0IHRpbWUgYnVja2V0IGZyb20gd2hpY2ggdG9rZW5zIGhhdmUgYmVlbiBwdXJjaGFzZWQKICAgIHVpbnQyNTYgcHVibGljIGxhc3RCdWNrZXQgPSAwOwoKICAgIC8vIGFtb3VudCBpc3N1ZWQgaW4gdGhlIGxhc3QgYnVja2V0CiAgICB1aW50MjU2IHB1YmxpYyBidWNrZXRBbW91bnQgPSAwOwoKICAgIGV2ZW50IFRva2VuUHVyY2hhc2UoYWRkcmVzcyBpbmRleGVkIGludmVzdG9yLCBhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgd2VpQW1vdW50LCB1aW50MjU2IHRva2Vucyk7CgogICAgZnVuY3Rpb24gQ29udGludW91c1NhbGUoCiAgICAgICAgdWludDI1NiBfcmF0ZSwKICAgICAgICBhZGRyZXNzIF93YWxsZXQsCiAgICAgICAgTWludGFibGVUb2tlbiBfdG9rZW4KICAgICkgewogICAgICAgIHJlcXVpcmUoX3JhdGUgIT0gMCk7CiAgICAgICAgcmVxdWlyZShfd2FsbGV0ICE9IDApOwogICAgICAgIC8vIHJlcXVpcmUoYWRkcmVzcyh0b2tlbikgIT0gMHgwKTsKCiAgICAgICAgcmF0ZSA9IF9yYXRlOwogICAgICAgIHdhbGxldCA9IF93YWxsZXQ7CiAgICAgICAgdG9rZW4gPSBfdG9rZW47CiAgICB9CgogICAgZnVuY3Rpb24oKSBwYXlhYmxlIHsKICAgICAgICBidXlUb2tlbnMobXNnLnNlbmRlcik7CiAgICB9CgogICAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnkpIHB1YmxpYyBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKGJlbmVmaWNpYXJ5ICE9IDB4MCk7CiAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgIT0gMCk7CgogICAgICAgIHByZXBhcmVDb250aW51b3VzUHVyY2hhc2UoKTsKICAgICAgICB1aW50MjU2IHRva2VucyA9IHByb2Nlc3NQdXJjaGFzZShiZW5lZmljaWFyeSk7CiAgICAgICAgY2hlY2tDb250aW51b3VzUHVyY2hhc2UodG9rZW5zKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwcmVwYXJlQ29udGludW91c1B1cmNoYXNlKCkgaW50ZXJuYWwgewogICAgICAgIHVpbnQyNTYgdGltZXN0YW1wID0gYmxvY2sudGltZXN0YW1wOwogICAgICAgIHVpbnQyNTYgYnVja2V0ID0gdGltZXN0YW1wIC0gKHRpbWVzdGFtcCAlIEJVQ0tFVF9TSVpFKTsKCiAgICAgICAgaWYgKGJ1Y2tldCA+IGxhc3RCdWNrZXQpIHsKICAgICAgICAgICAgbGFzdEJ1Y2tldCA9IGJ1Y2tldDsKICAgICAgICAgICAgYnVja2V0QW1vdW50ID0gMDsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gY2hlY2tDb250aW51b3VzUHVyY2hhc2UodWludDI1NiB0b2tlbnMpIGludGVybmFsIHsKICAgICAgICB1aW50MjU2IHVwZGF0ZWRCdWNrZXRBbW91bnQgPSBidWNrZXRBbW91bnQuYWRkKHRva2Vucyk7CiAgICAgICAgcmVxdWlyZSh1cGRhdGVkQnVja2V0QW1vdW50IDw9IGlzc3VhbmNlKTsKCiAgICAgICAgYnVja2V0QW1vdW50ID0gdXBkYXRlZEJ1Y2tldEFtb3VudDsKICAgIH0KCiAgICBmdW5jdGlvbiBwcm9jZXNzUHVyY2hhc2UoYWRkcmVzcyBiZW5lZmljaWFyeSkgaW50ZXJuYWwgcmV0dXJucyh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiB3ZWlBbW91bnQgPSBtc2cudmFsdWU7CgogICAgICAgIC8vIGNhbGN1bGF0ZSB0b2tlbiBhbW91bnQgdG8gYmUgY3JlYXRlZAogICAgICAgIHVpbnQyNTYgdG9rZW5zID0gd2VpQW1vdW50Lm11bChyYXRlKTsKCiAgICAgICAgLy8gdXBkYXRlIHN0YXRlCiAgICAgICAgd2VpUmFpc2VkID0gd2VpUmFpc2VkLmFkZCh3ZWlBbW91bnQpOwoKICAgICAgICB0b2tlbi5taW50KGJlbmVmaWNpYXJ5LCB0b2tlbnMpOwogICAgICAgIFRva2VuUHVyY2hhc2UobXNnLnNlbmRlciwgYmVuZWZpY2lhcnksIHdlaUFtb3VudCwgdG9rZW5zKTsKCiAgICAgICAgZm9yd2FyZEZ1bmRzKCk7CgogICAgICAgIHJldHVybiB0b2tlbnM7CiAgICB9CgogICAgZnVuY3Rpb24gZm9yd2FyZEZ1bmRzKCkgaW50ZXJuYWwgewogICAgICAgIHdhbGxldC50cmFuc2Zlcihtc2cudmFsdWUpOwogICAgfQp9Cgpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsKCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOwoKCiAgLyoqCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyCiAgICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bwogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdXQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVyZWQKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CiAgICB2YXIgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOwoKICAgIC8vIENoZWNrIGlzIG5vdCBuZWVkZWQgYmVjYXVzZSBzdWIoX2FsbG93YW5jZSwgX3ZhbHVlKSB3aWxsIGFscmVhZHkgdGhyb3cgaWYgdGhpcyBjb25kaXRpb24gaXMgbm90IG1ldAogICAgLy8gcmVxdWlyZSAoX3ZhbHVlIDw9IF9hbGxvd2FuY2UpOwoKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOwogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBfYWxsb3dhbmNlLnN1YihfdmFsdWUpOwogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7CgogICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2AKICAgIC8vICBhbGxvd2FuY2UgdG8gemVybyBieSBjYWxsaW5nIGBhcHByb3ZlKF9zcGVuZGVyLCAwKWAgaWYgaXQgaXMgbm90CiAgICAvLyAgYWxyZWFkeSAwIHRvIG1pdGlnYXRlIHRoZSByYWNlIGNvbmRpdGlvbiBkZXNjcmliZWQgaGVyZToKICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQogICAgcmVxdWlyZSgoX3ZhbHVlID09IDApIHx8IChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9PSAwKSk7CgogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqIEBwYXJhbSBfb3duZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCBvd25zIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWJsZSBmb3IgdGhlIHNwZW5kZXIuCiAgICovCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKfQoKY29udHJhY3QgQnVybmFibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuIHsKCiAgICBldmVudCBCdXJuKGFkZHJlc3MgaW5kZXhlZCBidXJuZXIsIHVpbnQyNTYgdmFsdWUpOwoKICAgIC8qKgogICAgICogQGRldiBCdXJucyBhIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zLgogICAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBidXJuLgogICAgICovCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgewogICAgICAgIHJlcXVpcmUoX3ZhbHVlID4gMCk7CgogICAgICAgIGFkZHJlc3MgYnVybmVyID0gbXNnLnNlbmRlcjsKICAgICAgICBiYWxhbmNlc1tidXJuZXJdID0gYmFsYW5jZXNbYnVybmVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LnN1YihfdmFsdWUpOwogICAgICAgIEJ1cm4obXNnLnNlbmRlciwgX3ZhbHVlKTsKICAgIH0KCn0KCmNvbnRyYWN0IFBhdXNhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgUGF1c2FibGUgewoKICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyKF90bywgX3ZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIHdoZW5Ob3RQYXVzZWQgcmV0dXJucyAoYm9vbCkgewogICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogIH0KfQoKY29udHJhY3QgTUFOQUNvbnRpbnVvdXNTYWxlIGlzIENvbnRpbnVvdXNTYWxlLCBPd25hYmxlIHsKCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBJTkZMQVRJT04gPSA4OwoKICAgIGJvb2wgcHVibGljIHN0YXJ0ZWQgPSBmYWxzZTsKCiAgICBldmVudCBSYXRlQ2hhbmdlKHVpbnQyNTYgYW1vdW50KTsKCiAgICBldmVudCBXYWxsZXRDaGFuZ2UoYWRkcmVzcyB3YWxsZXQpOwoKICAgIGZ1bmN0aW9uIE1BTkFDb250aW51b3VzU2FsZSgKICAgICAgICB1aW50MjU2IF9yYXRlLAogICAgICAgIGFkZHJlc3MgX3dhbGxldCwKICAgICAgICBNaW50YWJsZVRva2VuIF90b2tlbgogICAgKSBDb250aW51b3VzU2FsZShfcmF0ZSwgX3dhbGxldCwgX3Rva2VuKSB7CiAgICB9CgogICAgbW9kaWZpZXIgd2hlblN0YXJ0ZWQoKSB7CiAgICAgICAgcmVxdWlyZShzdGFydGVkKTsKICAgICAgICBfOwogICAgfQoKICAgIGZ1bmN0aW9uIHN0YXJ0KCkgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKCFzdGFydGVkKTsKCiAgICAgICAgLy8gaW5pdGlhbGl6ZSBpc3N1YW5jZQogICAgICAgIHVpbnQyNTYgZmluYWxTdXBwbHkgPSB0b2tlbi50b3RhbFN1cHBseSgpOwogICAgICAgIHVpbnQyNTYgYW5udWFsSXNzdWFuY2UgPSBmaW5hbFN1cHBseS5tdWwoSU5GTEFUSU9OKS5kaXYoMTAwKTsKICAgICAgICBpc3N1YW5jZSA9IGFubnVhbElzc3VhbmNlLm11bChCVUNLRVRfU0laRSkuZGl2KDEgeWVhcnMpOwoKICAgICAgICBzdGFydGVkID0gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBidXlUb2tlbnMoYWRkcmVzcyBiZW5lZmljaWFyeSkgd2hlblN0YXJ0ZWQgcHVibGljIHBheWFibGUgewogICAgICAgIHN1cGVyLmJ1eVRva2VucyhiZW5lZmljaWFyeSk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0V2FsbGV0KGFkZHJlc3MgX3dhbGxldCkgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKF93YWxsZXQgIT0gMHgwKTsKICAgICAgICB3YWxsZXQgPSBfd2FsbGV0OwogICAgICAgIFdhbGxldENoYW5nZShfd2FsbGV0KTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRSYXRlKHVpbnQyNTYgX3JhdGUpIG9ubHlPd25lciB7CiAgICAgICAgcmF0ZSA9IF9yYXRlOwogICAgICAgIFJhdGVDaGFuZ2UoX3JhdGUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHVucGF1c2VUb2tlbigpIG9ubHlPd25lciB7CiAgICAgICAgTUFOQVRva2VuKHRva2VuKS51bnBhdXNlKCk7CiAgICB9CgogICAgZnVuY3Rpb24gcGF1c2VUb2tlbigpIG9ubHlPd25lciB7CiAgICAgICAgTUFOQVRva2VuKHRva2VuKS5wYXVzZSgpOwogICAgfQp9Cgpjb250cmFjdCBGaW5hbGl6YWJsZUNyb3dkc2FsZSBpcyBDcm93ZHNhbGUsIE93bmFibGUgewogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwoKICBib29sIHB1YmxpYyBpc0ZpbmFsaXplZCA9IGZhbHNlOwoKICBldmVudCBGaW5hbGl6ZWQoKTsKCiAgLy8gc2hvdWxkIGJlIGNhbGxlZCBhZnRlciBjcm93ZHNhbGUgZW5kcywgdG8gZG8KICAvLyBzb21lIGV4dHJhIGZpbmFsaXphdGlvbiB3b3JrCiAgZnVuY3Rpb24gZmluYWxpemUoKSBvbmx5T3duZXIgewogICAgcmVxdWlyZSghaXNGaW5hbGl6ZWQpOwogICAgcmVxdWlyZShoYXNFbmRlZCgpKTsKCiAgICBmaW5hbGl6YXRpb24oKTsKICAgIEZpbmFsaXplZCgpOwoKICAgIGlzRmluYWxpemVkID0gdHJ1ZTsKICB9CgogIC8vIGVuZCB0b2tlbiBtaW50aW5nIG9uIGZpbmFsaXphdGlvbgogIC8vIG92ZXJyaWRlIHRoaXMgd2l0aCBjdXN0b20gbG9naWMgaWYgbmVlZGVkCiAgZnVuY3Rpb24gZmluYWxpemF0aW9uKCkgaW50ZXJuYWwgewogICAgdG9rZW4uZmluaXNoTWludGluZygpOwogIH0KCgoKfQoKY29udHJhY3QgTWludGFibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKICBldmVudCBNaW50KGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiBhbW91bnQpOwogIGV2ZW50IE1pbnRGaW5pc2hlZCgpOwoKICBib29sIHB1YmxpYyBtaW50aW5nRmluaXNoZWQgPSBmYWxzZTsKCgogIG1vZGlmaWVyIGNhbk1pbnQoKSB7CiAgICByZXF1aXJlKCFtaW50aW5nRmluaXNoZWQpOwogICAgXzsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gbWludCB0b2tlbnMKICAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCByZWNpZXZlIHRoZSBtaW50ZWQgdG9rZW5zLgogICAqIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIG1pbnQuCiAgICogQHJldHVybiBBIGJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgKi8KICBmdW5jdGlvbiBtaW50KGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIG9ubHlPd25lciBjYW5NaW50IHJldHVybnMgKGJvb2wpIHsKICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKF9hbW91bnQpOwogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF9hbW91bnQpOwogICAgTWludChfdG8sIF9hbW91bnQpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIHN0b3AgbWludGluZyBuZXcgdG9rZW5zLgogICAqIEByZXR1cm4gVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogIGZ1bmN0aW9uIGZpbmlzaE1pbnRpbmcoKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgewogICAgbWludGluZ0ZpbmlzaGVkID0gdHJ1ZTsKICAgIE1pbnRGaW5pc2hlZCgpOwogICAgcmV0dXJuIHRydWU7CiAgfQp9Cgpjb250cmFjdCBNQU5BVG9rZW4gaXMgQnVybmFibGVUb2tlbiwgUGF1c2FibGVUb2tlbiwgTWludGFibGVUb2tlbiB7CgogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiTUFOQSI7CgogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIkRlY2VudHJhbGFuZCBNQU5BIjsKCiAgICB1aW50OCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsKCiAgICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSB3aGVuTm90UGF1c2VkIHB1YmxpYyB7CiAgICAgICAgc3VwZXIuYnVybihfdmFsdWUpOwogICAgfQp9Cgpjb250cmFjdCBDYXBwZWRDcm93ZHNhbGUgaXMgQ3Jvd2RzYWxlIHsKICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKCiAgdWludDI1NiBwdWJsaWMgY2FwOwoKICBmdW5jdGlvbiBDYXBwZWRDcm93ZHNhbGUodWludDI1NiBfY2FwKSB7CiAgICByZXF1aXJlKF9jYXAgPiAwKTsKICAgIGNhcCA9IF9jYXA7CiAgfQoKICAvLyBvdmVycmlkaW5nIENyb3dkc2FsZSN2YWxpZFB1cmNoYXNlIHRvIGFkZCBleHRyYSBjYXAgbG9naWMKICAvLyBAcmV0dXJuIHRydWUgaWYgaW52ZXN0b3JzIGNhbiBidXkgYXQgdGhlIG1vbWVudAogIGZ1bmN0aW9uIHZhbGlkUHVyY2hhc2UoKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zIChib29sKSB7CiAgICBib29sIHdpdGhpbkNhcCA9IHdlaVJhaXNlZC5hZGQobXNnLnZhbHVlKSA8PSBjYXA7CiAgICByZXR1cm4gc3VwZXIudmFsaWRQdXJjaGFzZSgpICYmIHdpdGhpbkNhcDsKICB9CgogIC8vIG92ZXJyaWRpbmcgQ3Jvd2RzYWxlI2hhc0VuZGVkIHRvIGFkZCBjYXAgbG9naWMKICAvLyBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBlbmRlZAogIGZ1bmN0aW9uIGhhc0VuZGVkKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsKICAgIGJvb2wgY2FwUmVhY2hlZCA9IHdlaVJhaXNlZCA+PSBjYXA7CiAgICByZXR1cm4gc3VwZXIuaGFzRW5kZWQoKSB8fCBjYXBSZWFjaGVkOwogIH0KCn0KCmNvbnRyYWN0IE1BTkFDcm93ZHNhbGUgaXMgV2hpdGVsaXN0ZWRDcm93ZHNhbGUsIENhcHBlZENyb3dkc2FsZSwgRmluYWxpemFibGVDcm93ZHNhbGUgewoKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IFRPVEFMX1NIQVJFID0gMTAwOwogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgQ1JPV0RTQUxFX1NIQVJFID0gNDA7CiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBGT1VOREFUSU9OX1NIQVJFID0gNjA7CgogICAgLy8gcHJpY2UgYXQgd2hpY2ggd2hpdGVsaXN0ZWQgYnV5ZXJzIHdpbGwgYmUgYWJsZSB0byBidXkgdG9rZW5zCiAgICB1aW50MjU2IHB1YmxpYyBwcmVmZXJlbnRpYWxSYXRlOwoKICAgIC8vIGN1c3RvbWl6ZSB0aGUgcmF0ZSBmb3IgZWFjaCB3aGl0ZWxpc3RlZCBidXllcgogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgYnV5ZXJSYXRlOwoKICAgIC8vIGluaXRpYWwgcmF0ZSBhdCB3aGljaCB0b2tlbnMgYXJlIG9mZmVyZWQKICAgIHVpbnQyNTYgcHVibGljIGluaXRpYWxSYXRlOwoKICAgIC8vIGVuZCByYXRlIGF0IHdoaWNoIHRva2VucyBhcmUgb2ZmZXJlZAogICAgdWludDI1NiBwdWJsaWMgZW5kUmF0ZTsKCiAgICAvLyBjb250aW51b3VzIGNyb3dkc2FsZSBjb250cmFjdAogICAgTUFOQUNvbnRpbnVvdXNTYWxlIHB1YmxpYyBjb250aW51b3VzU2FsZTsKCiAgICBldmVudCBXYWxsZXRDaGFuZ2UoYWRkcmVzcyB3YWxsZXQpOwoKICAgIGV2ZW50IFByZWZlcmVudGlhbFJhdGVDaGFuZ2UoYWRkcmVzcyBpbmRleGVkIGJ1eWVyLCB1aW50MjU2IHJhdGUpOwoKICAgIGV2ZW50IEluaXRpYWxSYXRlQ2hhbmdlKHVpbnQyNTYgcmF0ZSk7CgogICAgZXZlbnQgRW5kUmF0ZUNoYW5nZSh1aW50MjU2IHJhdGUpOwoKICAgIGZ1bmN0aW9uIE1BTkFDcm93ZHNhbGUoKQogICAgICAgIENhcHBlZENyb3dkc2FsZSg4NjIwNiBldGhlcikKICAgICAgICBXaGl0ZWxpc3RlZENyb3dkc2FsZSgpCiAgICAgICAgRmluYWxpemFibGVDcm93ZHNhbGUoKQogICAgICAgIENyb3dkc2FsZSg0MTcwNjAwLCA0MjAyMDk3LCAxMjA4MywgMHgwMDBmYjgzNjk2NzdiMzA2NWRlNTgyMWE4NmJjOTU1MWQ1ZTVlYWI5KQogICAgewogICAgICAgIGluaXRpYWxSYXRlID0gMTIwODM7CiAgICAgICAgZW5kUmF0ZSA9IDcyNTA7CiAgICAgICAgcHJlZmVyZW50aWFsUmF0ZSA9IDEyMDgzOwoKICAgICAgICBjb250aW51b3VzU2FsZSA9IGNyZWF0ZUNvbnRpbnVvdXNTYWxlQ29udHJhY3QoKTsKCiAgICAgICAgTUFOQVRva2VuKHRva2VuKS5wYXVzZSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNyZWF0ZVRva2VuQ29udHJhY3QoKSBpbnRlcm5hbCByZXR1cm5zKE1pbnRhYmxlVG9rZW4pIHsKICAgICAgICByZXR1cm4gbmV3IE1BTkFUb2tlbigpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNyZWF0ZUNvbnRpbnVvdXNTYWxlQ29udHJhY3QoKSBpbnRlcm5hbCByZXR1cm5zKE1BTkFDb250aW51b3VzU2FsZSkgewogICAgICAgIHJldHVybiBuZXcgTUFOQUNvbnRpbnVvdXNTYWxlKHJhdGUsIHdhbGxldCwgdG9rZW4pOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldEJ1eWVyUmF0ZShhZGRyZXNzIGJ1eWVyLCB1aW50MjU2IHJhdGUpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIHJlcXVpcmUocmF0ZSAhPSAwKTsKICAgICAgICByZXF1aXJlKGlzV2hpdGVsaXN0ZWQoYnV5ZXIpKTsKICAgICAgICByZXF1aXJlKGJsb2NrLm51bWJlciA8IHN0YXJ0QmxvY2spOwoKICAgICAgICBidXllclJhdGVbYnV5ZXJdID0gcmF0ZTsKCiAgICAgICAgUHJlZmVyZW50aWFsUmF0ZUNoYW5nZShidXllciwgcmF0ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0SW5pdGlhbFJhdGUodWludDI1NiByYXRlKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKHJhdGUgIT0gMCk7CiAgICAgICAgcmVxdWlyZShibG9jay5udW1iZXIgPCBzdGFydEJsb2NrKTsKCiAgICAgICAgaW5pdGlhbFJhdGUgPSByYXRlOwoKICAgICAgICBJbml0aWFsUmF0ZUNoYW5nZShyYXRlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRFbmRSYXRlKHVpbnQyNTYgcmF0ZSkgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZShyYXRlICE9IDApOwogICAgICAgIHJlcXVpcmUoYmxvY2subnVtYmVyIDwgc3RhcnRCbG9jayk7CgogICAgICAgIGVuZFJhdGUgPSByYXRlOwoKICAgICAgICBFbmRSYXRlQ2hhbmdlKHJhdGUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFJhdGUoKSBpbnRlcm5hbCByZXR1cm5zKHVpbnQyNTYpIHsKICAgICAgICAvLyBzb21lIGVhcmx5IGJ1eWVycyBhcmUgb2ZmZXJlZCBhIGRpc2NvdW50IG9uIHRoZSBjcm93ZHNhbGUgcHJpY2UKICAgICAgICBpZiAoYnV5ZXJSYXRlW21zZy5zZW5kZXJdICE9IDApIHsKICAgICAgICAgICAgcmV0dXJuIGJ1eWVyUmF0ZVttc2cuc2VuZGVyXTsKICAgICAgICB9CgogICAgICAgIC8vIHdoaXRlbGlzdGVkIGJ1eWVycyBjYW4gcHVyY2hhc2UgYXQgcHJlZmVyZW50aWFsIHByaWNlIGJlZm9yZSBjcm93ZHNhbGUgZW5kcwogICAgICAgIGlmIChpc1doaXRlbGlzdGVkKG1zZy5zZW5kZXIpKSB7CiAgICAgICAgICAgIHJldHVybiBwcmVmZXJlbnRpYWxSYXRlOwogICAgICAgIH0KCiAgICAgICAgLy8gb3RoZXJ3aXNlIGNvbXB1dGUgdGhlIHByaWNlIGZvciB0aGUgYXVjdGlvbgogICAgICAgIHVpbnQyNTYgZWxhcHNlZCA9IGJsb2NrLm51bWJlciAtIHN0YXJ0QmxvY2s7CiAgICAgICAgdWludDI1NiByYXRlUmFuZ2UgPSBpbml0aWFsUmF0ZSAtIGVuZFJhdGU7CiAgICAgICAgdWludDI1NiBibG9ja1JhbmdlID0gZW5kQmxvY2sgLSBzdGFydEJsb2NrOwoKICAgICAgICByZXR1cm4gaW5pdGlhbFJhdGUuc3ViKHJhdGVSYW5nZS5tdWwoZWxhcHNlZCkuZGl2KGJsb2NrUmFuZ2UpKTsKICAgIH0KCiAgICAvLyBsb3cgbGV2ZWwgdG9rZW4gcHVyY2hhc2UgZnVuY3Rpb24KICAgIGZ1bmN0aW9uIGJ1eVRva2VucyhhZGRyZXNzIGJlbmVmaWNpYXJ5KSBwYXlhYmxlIHsKICAgICAgICByZXF1aXJlKGJlbmVmaWNpYXJ5ICE9IDB4MCk7CiAgICAgICAgcmVxdWlyZSh2YWxpZFB1cmNoYXNlKCkpOwoKICAgICAgICB1aW50MjU2IHdlaUFtb3VudCA9IG1zZy52YWx1ZTsKICAgICAgICB1aW50MjU2IHVwZGF0ZWRXZWlSYWlzZWQgPSB3ZWlSYWlzZWQuYWRkKHdlaUFtb3VudCk7CgogICAgICAgIHVpbnQyNTYgcmF0ZSA9IGdldFJhdGUoKTsKICAgICAgICAvLyBjYWxjdWxhdGUgdG9rZW4gYW1vdW50IHRvIGJlIGNyZWF0ZWQKICAgICAgICB1aW50MjU2IHRva2VucyA9IHdlaUFtb3VudC5tdWwocmF0ZSk7CgogICAgICAgIC8vIHVwZGF0ZSBzdGF0ZQogICAgICAgIHdlaVJhaXNlZCA9IHVwZGF0ZWRXZWlSYWlzZWQ7CgogICAgICAgIHRva2VuLm1pbnQoYmVuZWZpY2lhcnksIHRva2Vucyk7CiAgICAgICAgVG9rZW5QdXJjaGFzZShtc2cuc2VuZGVyLCBiZW5lZmljaWFyeSwgd2VpQW1vdW50LCB0b2tlbnMpOwoKICAgICAgICBmb3J3YXJkRnVuZHMoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRXYWxsZXQoYWRkcmVzcyBfd2FsbGV0KSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKF93YWxsZXQgIT0gMHgwKTsKICAgICAgICB3YWxsZXQgPSBfd2FsbGV0OwogICAgICAgIGNvbnRpbnVvdXNTYWxlLnNldFdhbGxldChfd2FsbGV0KTsKICAgICAgICBXYWxsZXRDaGFuZ2UoX3dhbGxldCk7CiAgICB9CgogICAgZnVuY3Rpb24gdW5wYXVzZVRva2VuKCkgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKGlzRmluYWxpemVkKTsKICAgICAgICBNQU5BVG9rZW4odG9rZW4pLnVucGF1c2UoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwYXVzZVRva2VuKCkgb25seU93bmVyIHsKICAgICAgICByZXF1aXJlKGlzRmluYWxpemVkKTsKICAgICAgICBNQU5BVG9rZW4odG9rZW4pLnBhdXNlKCk7CiAgICB9CgoKICAgIGZ1bmN0aW9uIGJlZ2luQ29udGludW91c1NhbGUoKSBvbmx5T3duZXIgcHVibGljIHsKICAgICAgICByZXF1aXJlKGlzRmluYWxpemVkKTsKCiAgICAgICAgdG9rZW4udHJhbnNmZXJPd25lcnNoaXAoY29udGludW91c1NhbGUpOwoKICAgICAgICBjb250aW51b3VzU2FsZS5zdGFydCgpOwogICAgICAgIGNvbnRpbnVvdXNTYWxlLnRyYW5zZmVyT3duZXJzaGlwKG93bmVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBmaW5hbGl6YXRpb24oKSBpbnRlcm5hbCB7CiAgICAgICAgdWludDI1NiB0b3RhbFN1cHBseSA9IHRva2VuLnRvdGFsU3VwcGx5KCk7CiAgICAgICAgdWludDI1NiBmaW5hbFN1cHBseSA9IFRPVEFMX1NIQVJFLm11bCh0b3RhbFN1cHBseSkuZGl2KENST1dEU0FMRV9TSEFSRSk7CgogICAgICAgIC8vIGVtaXQgdG9rZW5zIGZvciB0aGUgZm91bmRhdGlvbgogICAgICAgIHRva2VuLm1pbnQod2FsbGV0LCBGT1VOREFUSU9OX1NIQVJFLm11bChmaW5hbFN1cHBseSkuZGl2KFRPVEFMX1NIQVJFKSk7CgogICAgICAgIC8vIE5PVEU6IGNhbm5vdCBjYWxsIHN1cGVyIGhlcmUgYmVjYXVzZSBpdCB3b3VsZCBmaW5pc2ggbWludGluZyBhbmQKICAgICAgICAvLyB0aGUgY29udGludW91cyBzYWxlIHdvdWxkIG5vdCBiZSBhYmxlIHRvIHByb2NlZWQKICAgIH0KCn0='.
	

]
