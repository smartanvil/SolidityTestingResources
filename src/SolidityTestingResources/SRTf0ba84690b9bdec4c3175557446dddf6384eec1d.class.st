Class {
	#name : #SRTf0ba84690b9bdec4c3175557446dddf6384eec1d,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRTf0ba84690b9bdec4c3175557446dddf6384eec1d >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTk7CmxpYnJhcnkgU2FmZU1hdGggewoKICAvKioKICAqIEBkZXYgTXVsdGlwbGllcyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93LgogICovCiAgZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGlmIChhID09IDApIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB1aW50MjU2IGMgPSBhICogYjsKICAgIGFzc2VydChjIC8gYSA9PSBiKTsKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IEludGVnZXIgZGl2aXNpb24gb2YgdHdvIG51bWJlcnMsIHRydW5jYXRpbmcgdGhlIHF1b3RpZW50LgogICovCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgdWludDI1NiBjID0gYSAvIGI7CiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZAogICAgcmV0dXJuIGM7CiAgfQoKICAvKioKICAqIEBkZXYgU3Vic3RyYWN0cyB0d28gbnVtYmVycywgdGhyb3dzIG9uIG92ZXJmbG93IChpLmUuIGlmIHN1YnRyYWhlbmQgaXMgZ3JlYXRlciB0aGFuIG1pbnVlbmQpLgogICovCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgIGFzc2VydChiIDw9IGEpOwogICAgcmV0dXJuIGEgLSBiOwogIH0KCiAgLyoqCiAgKiBAZGV2IEFkZHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgIGFzc2VydChjID49IGEpOwogICAgcmV0dXJuIGM7CiAgfQp9CmNvbnRyYWN0IEVSQzcyMUFic3RyYWN0CnsKCWZ1bmN0aW9uIGltcGxlbWVudHNFUkM3MjEoKSBwdWJsaWMgcHVyZSByZXR1cm5zIChib29sKTsKCWZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsKCWZ1bmN0aW9uIG93bmVyT2YodWludDI1NiBfdG9rZW5JZCkgcHVibGljIHZpZXcgcmV0dXJucyAoYWRkcmVzcyBvd25lcik7CglmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWM7CglmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYzsKCWZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkKSBwdWJsaWM7CiAKCWV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgaW5kZXhlZCB0b2tlbklkKTsKCWV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIGFwcHJvdmVkLCB1aW50MjU2IGluZGV4ZWQgdG9rZW5JZCk7CgoJLy8gT3B0aW9uYWwKCS8vIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NiB0b3RhbCk7CgkvLyBmdW5jdGlvbiBuYW1lKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nIG5hbWUpOwoJLy8gZnVuY3Rpb24gc3ltYm9sKCkgcHVibGljIHZpZXcgcmV0dXJucyAoc3RyaW5nIHN5bWJvbCk7CgkvLyBmdW5jdGlvbiB0b2tlbk9mT3duZXJCeUluZGV4KGFkZHJlc3MgX293bmVyLCB1aW50MjU2IF9pbmRleCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICh1aW50MjU2IHRva2VuSWQpOwoJLy8gZnVuY3Rpb24gdG9rZW5NZXRhZGF0YSh1aW50MjU2IF90b2tlbklkKSBwdWJsaWMgdmlldyByZXR1cm5zIChzdHJpbmcgaW5mb1VybCk7Cn0KY29udHJhY3QgRVJDNzIxIGlzIEVSQzcyMUFic3RyYWN0CnsKCXN0cmluZyBjb25zdGFudCBwdWJsaWMgICBuYW1lID0gIk5CQSBPTkxJTkUiOwoJc3RyaW5nIGNvbnN0YW50IHB1YmxpYyBzeW1ib2wgPSAiVGlja2V0IjsKCgl1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsKCXN0cnVjdCBUb2tlbgoJewoJCXVpbnQyNTYgcHJpY2U7CQkJLy8gIHZhbHVlIG9mIHN0YWtlCgkJdWludDI1NglvcHRpb247CQkJLy8gIFtwYXlvdXRdOTZbaWRMb3R0ZXJ5XTY0W2NvbWJpbmF0aW9uXTMyW2RhdGVCdXldMAoJfQoJbWFwcGluZyAodWludDI1NiA9PiBUb2tlbikgdG9rZW5zOwoJCgkvLyBBIG1hcHBpbmcgZnJvbSB0b2tlbnMgSURzIHRvIHRoZSBhZGRyZXNzIHRoYXQgb3ducyB0aGVtLiBBbGwgdG9rZW5zIGhhdmUgc29tZSB2YWxpZCBvd25lciBhZGRyZXNzCgltYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIHB1YmxpYyB0b2tlbkluZGV4VG9Pd25lcjsKCQoJLy8gQSBtYXBwaW5nIGZyb20gb3duZXIgYWRkcmVzcyB0byBjb3VudCBvZiB0b2tlbnMgdGhhdCBhZGRyZXNzIG93bnMuCQoJbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBvd25lcnNoaXBUb2tlbkNvdW50OyAKCgkvLyBBIG1hcHBpbmcgZnJvbSB0b2tlbklEcyB0byBhbiBhZGRyZXNzIHRoYXQgaGFzIGJlZW4gYXBwcm92ZWQgdG8gY2FsbCB0cmFuc2ZlckZyb20oKS4KCS8vIEVhY2ggdG9rZW4gY2FuIG9ubHkgaGF2ZSBvbmUgYXBwcm92ZWQgYWRkcmVzcyBmb3IgdHJhbnNmZXIgYXQgYW55IHRpbWUuCgkvLyBBIHplcm8gdmFsdWUgbWVhbnMgbm8gYXBwcm92YWwgaXMgb3V0c3RhbmRpbmcuCgltYXBwaW5nICh1aW50MjU2ID0+IGFkZHJlc3MpIHB1YmxpYyB0b2tlbkluZGV4VG9BcHByb3ZlZDsKCQoJZnVuY3Rpb24gaW1wbGVtZW50c0VSQzcyMSgpIHB1YmxpYyBwdXJlIHJldHVybnMgKGJvb2wpCgl7CgkJcmV0dXJuIHRydWU7Cgl9CgoJZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2IGNvdW50KSAKCXsKCQlyZXR1cm4gb3duZXJzaGlwVG9rZW5Db3VudFtfb3duZXJdOwoJfQoJCglmdW5jdGlvbiBvd25lck9mKHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYyB2aWV3IHJldHVybnMgKGFkZHJlc3Mgb3duZXIpCgl7CgkJb3duZXIgPSB0b2tlbkluZGV4VG9Pd25lcltfdG9rZW5JZF07CgkJcmVxdWlyZShvd25lciAhPSBhZGRyZXNzKDApKTsKCX0KCQoJLy8gTWFya3MgYW4gYWRkcmVzcyBhcyBiZWluZyBhcHByb3ZlZCBmb3IgdHJhbnNmZXJGcm9tKCksIG92ZXJ3cml0aW5nIGFueSBwcmV2aW91cyBhcHByb3ZhbC4gCgkvLyBTZXR0aW5nIF9hcHByb3ZlZCB0byBhZGRyZXNzKDApIGNsZWFycyBhbGwgdHJhbnNmZXIgYXBwcm92YWwuCglmdW5jdGlvbiBfYXBwcm92ZSh1aW50MjU2IF90b2tlbklkLCBhZGRyZXNzIF9hcHByb3ZlZCkgaW50ZXJuYWwgCgl7CgkJdG9rZW5JbmRleFRvQXBwcm92ZWRbX3Rva2VuSWRdID0gX2FwcHJvdmVkOwoJfQoJCgkvLyBDaGVja3MgaWYgYSBnaXZlbiBhZGRyZXNzIGN1cnJlbnRseSBoYXMgdHJhbnNmZXJBcHByb3ZhbCBmb3IgYSBwYXJ0aWN1bGFyIHRva2VuLgoJLy8gcGFyYW0gX2NsYWltYW50IHRoZSBhZGRyZXNzIHdlIGFyZSBjb25maXJtaW5nIHRva2VuIGlzIGFwcHJvdmVkIGZvci4KCS8vIHBhcmFtIF90b2tlbklkIHRva2VuIGlkLCBvbmx5IHZhbGlkIHdoZW4gPiAwCglmdW5jdGlvbiBfYXBwcm92ZWRGb3IoYWRkcmVzcyBfY2xhaW1hbnQsIHVpbnQyNTYgX3Rva2VuSWQpIGludGVybmFsIHZpZXcgcmV0dXJucyAoYm9vbCkgewoJCXJldHVybiB0b2tlbkluZGV4VG9BcHByb3ZlZFtfdG9rZW5JZF0gPT0gX2NsYWltYW50OwoJfQoJCglmdW5jdGlvbiBhcHByb3ZlKCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCApIHB1YmxpYwoJewoJCS8vIE9ubHkgYW4gb3duZXIgY2FuIGdyYW50IHRyYW5zZmVyIGFwcHJvdmFsLgoJCXJlcXVpcmUoX293bnMobXNnLnNlbmRlciwgX3Rva2VuSWQpKTsKCgkJLy8gUmVnaXN0ZXIgdGhlIGFwcHJvdmFsIChyZXBsYWNpbmcgYW55IHByZXZpb3VzIGFwcHJvdmFsKS4KCQlfYXBwcm92ZShfdG9rZW5JZCwgX3RvKTsKCgkJLy8gRW1pdCBhcHByb3ZhbCBldmVudC4KCQllbWl0IEFwcHJvdmFsKG1zZy5zZW5kZXIsIF90bywgX3Rva2VuSWQpOwoJfQoJCglmdW5jdGlvbiB0cmFuc2ZlckZyb20oIGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF90b2tlbklkICkgcHVibGljCgl7CgkJLy8gQ2hlY2sgZm9yIGFwcHJvdmFsIGFuZCB2YWxpZCBvd25lcnNoaXAKCQlyZXF1aXJlKF9hcHByb3ZlZEZvcihtc2cuc2VuZGVyLCBfdG9rZW5JZCkpOwoJCXJlcXVpcmUoX293bnMoX2Zyb20sIF90b2tlbklkKSk7CgoJCS8vIFJlYXNzaWduIG93bmVyc2hpcCAoYWxzbyBjbGVhcnMgcGVuZGluZyBhcHByb3ZhbHMgYW5kIGVtaXRzIFRyYW5zZmVyIGV2ZW50KS4KCQlfdHJhbnNmZXIoX2Zyb20sIF90bywgX3Rva2VuSWQpOwoJfQoJCglmdW5jdGlvbiBfb3ducyhhZGRyZXNzIF9jbGFpbWFudCwgdWludDI1NiBfdG9rZW5JZCkgaW50ZXJuYWwgdmlldyByZXR1cm5zIChib29sKSB7CgkJcmV0dXJuIHRva2VuSW5kZXhUb093bmVyW190b2tlbklkXSA9PSBfY2xhaW1hbnQ7Cgl9CgkKCWZ1bmN0aW9uIF90cmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdG9rZW5JZCkgaW50ZXJuYWwgCgl7CgkJb3duZXJzaGlwVG9rZW5Db3VudFtfdG9dKys7CgkJdG9rZW5JbmRleFRvT3duZXJbX3Rva2VuSWRdID0gX3RvOwoKCQlpZiAoX2Zyb20gIT0gYWRkcmVzcygwKSkgCgkJewoJCQllbWl0IFRyYW5zZmVyKF9mcm9tLCBfdG8sIF90b2tlbklkKTsKCQkJb3duZXJzaGlwVG9rZW5Db3VudFtfZnJvbV0tLTsKCQkJLy8gY2xlYXIgYW55IHByZXZpb3VzbHkgYXBwcm92ZWQgb3duZXJzaGlwIGV4Y2hhbmdlCgkJCWRlbGV0ZSB0b2tlbkluZGV4VG9BcHByb3ZlZFtfdG9rZW5JZF07CgkJfQoKCX0KCQoJZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3Rva2VuSWQpIHB1YmxpYwoJewoJCXJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwoJCXJlcXVpcmUoX293bnMobXNnLnNlbmRlciwgX3Rva2VuSWQpKTsKCQlfdHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdG9rZW5JZCk7Cgl9Cgp9CmNvbnRyYWN0IE93bmVkIAp7CiAgICBhZGRyZXNzIHByaXZhdGUgY2FuZGlkYXRlOwoJYWRkcmVzcyBwdWJsaWMgb3duZXI7CgoJbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBhZG1pbnM7CgkKICAgIGZ1bmN0aW9uIE93bmVkKCkgcHVibGljIAoJewogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsKICAgICAgICBhZG1pbnNbb3duZXJdID0gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGFuZ2VPd25lcihhZGRyZXNzIG5ld093bmVyKSBwdWJsaWMgCgl7CgkJcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsKICAgICAgICBjYW5kaWRhdGUgPSBuZXdPd25lcjsKICAgIH0KCQoJZnVuY3Rpb24gY29uZmlybU93bmVyKCkgcHVibGljIAoJewogICAgICAgIHJlcXVpcmUoY2FuZGlkYXRlID09IG1zZy5zZW5kZXIpOyAvLyBydW4gYnkgbmFtZT1jYW5kaWRhdGUKCQlvd25lciA9IGNhbmRpZGF0ZTsKICAgIH0KCQogICAgZnVuY3Rpb24gYWRkQWRtaW4oYWRkcmVzcyBhZGRyKSBleHRlcm5hbCAKCXsKCQlyZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIGFkbWluc1thZGRyXSA9IHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gcmVtb3ZlQWRtaW4oYWRkcmVzcyBhZGRyKSBleHRlcm5hbAoJewoJCXJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICAgICAgYWRtaW5zW2FkZHJdID0gZmFsc2U7CiAgICB9Cn0KY29udHJhY3QgRnVuY3Rpb25hbAp7CgkvLyBwYXJzZUludChwYXJzZUZsb2F0KjEwXl9iKQoJZnVuY3Rpb24gcGFyc2VJbnQoc3RyaW5nIF9hLCB1aW50IF9iKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQpIAoJewoJCWJ5dGVzIG1lbW9yeSBicmVzdWx0ID0gYnl0ZXMoX2EpOwoJCXVpbnQgbWludCA9IDA7CgkJYm9vbCBkZWNpbWFscyA9IGZhbHNlOwoJCWZvciAodWludCBpPTA7IGk8YnJlc3VsdC5sZW5ndGg7IGkrKyl7CgkJCWlmICgoYnJlc3VsdFtpXSA+PSA0OCkmJihicmVzdWx0W2ldIDw9IDU3KSl7CgkJCQlpZiAoZGVjaW1hbHMpewoJCQkJICAgaWYgKF9iID09IDApIGJyZWFrOwoJCQkJCWVsc2UgX2ItLTsKCQkJCX0KCQkJCW1pbnQgKj0gMTA7CgkJCQltaW50ICs9IHVpbnQoYnJlc3VsdFtpXSkgLSA0ODsKCQkJfSBlbHNlIGlmIChicmVzdWx0W2ldID09IDQ2KSBkZWNpbWFscyA9IHRydWU7CgkJfQoJCWlmIChfYiA+IDApIG1pbnQgKj0gMTAqKl9iOwoJCXJldHVybiBtaW50OwoJfQoJCglmdW5jdGlvbiB1aW50MnN0cih1aW50IGkpIGludGVybmFsIHB1cmUgcmV0dXJucyAoc3RyaW5nKQoJewoJCWlmIChpID09IDApIHJldHVybiAiMCI7CgkJdWludCBqID0gaTsKCQl1aW50IGxlbjsKCQl3aGlsZSAoaiAhPSAwKXsKCQkJbGVuKys7CgkJCWogLz0gMTA7CgkJfQoJCWJ5dGVzIG1lbW9yeSBic3RyID0gbmV3IGJ5dGVzKGxlbik7CgkJdWludCBrID0gbGVuIC0gMTsKCQl3aGlsZSAoaSAhPSAwKXsKCQkJYnN0cltrLS1dID0gYnl0ZSg0OCArIGkgJSAxMCk7CgkJCWkgLz0gMTA7CgkJfQoJCXJldHVybiBzdHJpbmcoYnN0cik7Cgl9CgkKCWZ1bmN0aW9uIHN0ckNvbmNhdChzdHJpbmcgX2EsIHN0cmluZyBfYiwgc3RyaW5nIF9jKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHN0cmluZykKCXsKCQlieXRlcyBtZW1vcnkgX2JhID0gYnl0ZXMoX2EpOwoJCWJ5dGVzIG1lbW9yeSBfYmIgPSBieXRlcyhfYik7CgkJYnl0ZXMgbWVtb3J5IF9iYyA9IGJ5dGVzKF9jKTsKCQlzdHJpbmcgbWVtb3J5IGFiYzsKCQl1aW50IGsgPSAwOwoJCXVpbnQgaTsKCQlieXRlcyBtZW1vcnkgYmFiYzsKCQlpZiAoX2JhLmxlbmd0aD09MCkKCQl7CgkJCWFiYyA9IG5ldyBzdHJpbmcoX2JjLmxlbmd0aCk7CgkJCWJhYmMgPSBieXRlcyhhYmMpOwoJCX0KCQllbHNlCgkJewoJCQlhYmMgPSBuZXcgc3RyaW5nKF9iYS5sZW5ndGggKyBfYmIubGVuZ3RoKyBfYmMubGVuZ3RoKTsKCQkJYmFiYyA9IGJ5dGVzKGFiYyk7CgkJCWZvciAoaSA9IDA7IGkgPCBfYmEubGVuZ3RoOyBpKyspIGJhYmNbaysrXSA9IF9iYVtpXTsKCQkJZm9yIChpID0gMDsgaSA8IF9iYi5sZW5ndGg7IGkrKykgYmFiY1trKytdID0gX2JiW2ldOwoJCX0KICAgICAgICBmb3IgKGkgPSAwOyBpIDwgX2JjLmxlbmd0aDsgaSsrKSBiYWJjW2srK10gPSBfYmNbaV07CgkJcmV0dXJuIHN0cmluZyhiYWJjKTsKCX0KCQoJZnVuY3Rpb24gdGltZW5vdygpIHB1YmxpYyB2aWV3IHJldHVybnModWludDMyKSB7IHJldHVybiB1aW50MzIoYmxvY2sudGltZXN0YW1wKTsgfQp9CmNvbnRyYWN0IE5CQU9OTElORSBpcyBGdW5jdGlvbmFsLE93bmVkLEVSQzcyMXsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogICAgCiAgICBlbnVtIFNUQVRVUyB7CgkJTk9URk9VTkQsCQkvLzAgZ2FtZSBub3QgY3JlYXRlZAoJCVBMQVlJTkcsCQkvLzEgYnV5aW5nIHRpY2tldHMgZm9yIHBsYXllcnMKCQlQUk9DRVNTSU5HLAkJLy8yIHdhaXRpbmcgZm9yIHJlc3VsdAoJCVBBWUlORywJIAkJLy8zIHJlZGVlbWluZwoJCVJFRlVORElORwkJLy80IGNhbmNlbGluZyB0aGUgZ2FtZQoJfQogICAgc3RydWN0IEdhbWV7CiAgICAgICAgc3RyaW5nIG5hbWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0dhbWVOYW1lCiAgICAgICAgdWludDI1NiBpZDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0dhbWUgSUQKICAgICAgICB1aW50MjU2IHRvdGFsUG90OyAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vVG90YWwgRGVwb3NpdCAKICAgICAgICB1aW50MjU2IHRvdGFsV2lubmVyc0RlcG9zaXQ7ICAgICAgICAgICAgICAgIC8vVG90YWwgV2lubmVyIERlcG9zaXQKICAgICAgICB1aW50MjU2IGRhdGVTdG9wQnV5OyAgICAgICAgICAgICAgICAgICAgICAgIC8vRGVhZGxpbmUgb2YgYnV5aW5nIHRpY2tldHMgb2YgdGhlIGdhbWUKICAgICAgICBTVEFUVVMgc3RhdHVzOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vR2FtZSBTdGF0dXMgCiAgICAgICAgbWFwcGluZyh1aW50OD0+dWludDI1Nilwb3REZXRhaWw7ICAgICAgICAgICAvL1RoZSBhbW91bnQgb2YgZWFjaCBwbGF5ZXIgaW4gYSBHYW1lCiAgICAgICAgbWFwcGluZyh1aW50OD0+dWludDgpcmVzdWx0OyAgICAgICAgICAgICAgICAvL1RoZSByZXN1bHRzIG9mIDMwIHBsYXllcnMgaW4gYSBnYW1lIDA6TG9zZSAxOiBXaW4KICAgIH0KICAgIG1hcHBpbmcodWludDI1Nj0+R2FtZSlwcml2YXRlIGdhbWVzOyAgICAgICAgICAgIC8vaWQgZmluZCBnYW1lCiAgICB1aW50MjU2W10gcHJpdmF0ZSBnYW1lSWRMaXN0OwogICAgCiAgICB1aW50MjU2IHByaXZhdGUgY29uc3RhbnQgbWluX2Ftb3VudCA9IDAuMDA1IGV0aGVyOwogICAgdWludDI1NiBwcml2YXRlIGNvbnN0YW50IG1heF9hbW91bnQgPSAxMDAwIGV0aGVyOwogICAgCiAgICBmdW5jdGlvbiBOQkFPTkxJTkUgKCkgcHVibGljIHsKICAgIH0KCiAgICAvKiBNb2RpZmllcnMgKi8KICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgICAgICByZXF1aXJlKG93bmVyID09IG1zZy5zZW5kZXIpOwogICAgICAgIF87CiAgICB9CiAgICBtb2RpZmllciBvbmx5QWRtaW4gewogICAgICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lciB8fCBhZG1pbnNbbXNnLnNlbmRlcl0pOwogICAgICAgIF87CiAgICB9CgogICAgZnVuY3Rpb24gYWRkT25lR2FtZShzdHJpbmcgX25hbWUsdWludDI1NiBfZGVhZGxpbmUpb25seUFkbWluKCkgZXh0ZXJuYWx7CiAgICAgICAgdWludDI1NiBfaWQgPSBnYW1lSWRMaXN0Lmxlbmd0aDsKICAgICAgICByZXF1aXJlKGdhbWVzW19pZF0uc3RhdHVzID09IFNUQVRVUy5OT1RGT1VORCk7CiAgICAgICAgcmVxdWlyZSggX2RlYWRsaW5lID4gdGltZW5vdygpICk7CiAgICAgICAgZ2FtZXNbX2lkXSA9IEdhbWUoX25hbWUsX2lkLDAsMCxfZGVhZGxpbmUsU1RBVFVTLlBMQVlJTkcpOwogICAgICAgIGdhbWVJZExpc3QucHVzaChfaWQpOwogICAgfQogICAgZnVuY3Rpb24gZ2V0R2FtZXNMZW5ndGgoKXB1YmxpYyB2aWV3IHJldHVybnModWludDI1NiBsZW5ndGgpewogICAgICAgIHJldHVybiBnYW1lSWRMaXN0Lmxlbmd0aDsKICAgIH0KICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZURldkN1dCAodWludDI1NiBfcHJpY2UpIHB1YmxpYyBwdXJlIHJldHVybnMgKHVpbnQyNTYgX2RldkN1dCkgewogICAgICAgIHJldHVybiBfcHJpY2UubXVsKDUpLmRpdigxMDApOyAvLyA1JQogICAgfQogICAgZnVuY3Rpb24gZ2VuZXJhdGVUaWNrZXREYXRhKHVpbnQyNTYgaWRMb3R0ZXJ5LCB1aW50OCBjb21iaW5hdGlvbix1aW50OCBzdGF0dXMpIHB1YmxpYyB2aWV3IHJldHVybnModWludDI1NiBwYWNrZWQpewogICAgICAgIHBhY2tlZCA9ICh1aW50MjU2KHN0YXR1cykgPDwgMTIqOCkgKyAoIHVpbnQyNTYoaWRMb3R0ZXJ5KSA8PCA4KjggKSArICggdWludDI1Nihjb21iaW5hdGlvbikgPDwgNCo4ICkgKyB1aW50MjU2KGJsb2NrLnRpbWVzdGFtcCk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHBhcnNlVGlja2V0KHVpbnQyNTYJcGFja2VkKXB1YmxpYyBwdXJlIHJldHVybnModWludDggcGF5b3V0LHVpbnQyNTYgaWRMb3R0ZXJ5LHVpbnQyNTYgY29tYmluYXRpb24sdWludDI1NiBkYXRlQnV5KXsKCQlwYXlvdXQgPSB1aW50OCgocGFja2VkID4+ICgxMio4KSkgJiAweEZGKTsKCQlpZExvdHRlcnkgICA9IHVpbnQyNTYoKHBhY2tlZCA+PiAoOCo4KSkgJiAweEZGRkZGRkZGKTsKCQljb21iaW5hdGlvbiA9IHVpbnQyNTYoKHBhY2tlZCA+PiAoNCo4KSkgJiAweEZGRkZGRkZGKTsKCQlkYXRlQnV5ICAgICA9IHVpbnQyNTYocGFja2VkICYgMHhGRkZGRkZGRik7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHVwZGF0ZVRpY2tldFN0YXR1cyh1aW50MjU2CXBhY2tlZCx1aW50OCBuZXdTdGF0dXMpcHVibGljIHB1cmUgcmV0dXJucyh1aW50MjU2IG5wYWNrZWQpewoJCXVpbnQ4IHBheW91dCA9IHVpbnQ4KChwYWNrZWQgPj4gKDEyKjgpKSAmIDB4RkYpOwoJCW5wYWNrZWQgPSBwYWNrZWQgKyAodWludDI1NihuZXdTdGF0dXMtcGF5b3V0KTw8IDEyKjgpOwogICAgfQogICAgZnVuY3Rpb24gYnV5VGlja2V0KHVpbnQyNTYgX2lkLCB1aW50OCBfY2hvb3NlKXBheWFibGUgZXh0ZXJuYWx7CiAgICAgICAgR2FtZSBzdG9yYWdlIGN1ckdhbWUgPSBnYW1lc1tfaWRdOwogICAgICAgIHJlcXVpcmUoY3VyR2FtZS5zdGF0dXMgPT0gU1RBVFVTLlBMQVlJTkcpOwogICAgICAgIHJlcXVpcmUoIHRpbWVub3coKSA8IGN1ckdhbWUuZGF0ZVN0b3BCdXkgKTsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSBtaW5fYW1vdW50KTsKICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA8PSBtYXhfYW1vdW50KTsKICAgICAgICByZXF1aXJlKF9jaG9vc2UgPCAzMCYmX2Nob29zZSA+PSAwKTsKICAgICAgICB1aW50MjU2IGRldiA9IGNhbGN1bGF0ZURldkN1dChtc2cudmFsdWUpOwogICAgICAgIHVpbnQyNTYgZGVwb3NpdCA9IG1zZy52YWx1ZS5zdWIoZGV2KTsKICAgICAgICBjdXJHYW1lLnRvdGFsUG90ID0gY3VyR2FtZS50b3RhbFBvdC5hZGQoZGVwb3NpdCk7CiAgICAgICAgY3VyR2FtZS5wb3REZXRhaWxbX2Nob29zZV0gPSBjdXJHYW1lLnBvdERldGFpbFtfY2hvb3NlXS5hZGQoZGVwb3NpdCk7CgoJCVRva2VuIG1lbW9yeSBfdG9rZW4gPSBUb2tlbih7CgkJCXByaWNlOiBkZXBvc2l0LAoJCQlvcHRpb24gOiBnZW5lcmF0ZVRpY2tldERhdGEoX2lkLF9jaG9vc2UsMCkKCQl9KTsKCgkJdWludDI1NiBuZXdUb2tlbklkID0gdG90YWxTdXBwbHkrKzsKCQl0b2tlbnNbbmV3VG9rZW5JZF0gPSBfdG9rZW47CgkJX3RyYW5zZmVyKDAsIG1zZy5zZW5kZXIsIG5ld1Rva2VuSWQpOwoKICAgICAgICBpZihkZXYgPiAwKXsKICAgICAgICAgICAgb3duZXIudHJhbnNmZXIoZGV2KTsKICAgICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiBjYW5jZWxUaWNrZXQodWludDI1NiBfdGlkKXBheWFibGUgZXh0ZXJuYWx7CiAgICAgICAgLy9jb25maXJtIG93bmVyc2hpcAogICAgICAgIHJlcXVpcmUodG9rZW5JbmRleFRvT3duZXJbX3RpZF0gPT0gbXNnLnNlbmRlcik7CiAgICAgICAgVG9rZW4gc3RvcmFnZSBfdG9rZW4gPSB0b2tlbnNbX3RpZF07CiAgICAgICAgdWludDI1NiBnYW1lSWQgICA9IHVpbnQyNTYoKF90b2tlbi5vcHRpb24gPj4gKDgqOCkpICYgMHhGRkZGRkZGRik7CiAgICAgICAgR2FtZSBzdG9yYWdlIGN1ckdhbWUgPSBnYW1lc1tnYW1lSWRdOwogICAgICAgIC8vY29uZmlybSBnYW1lIHN0YXR1cwogICAgICAgIHJlcXVpcmUoY3VyR2FtZS5zdGF0dXMgPT0gU1RBVFVTLlBMQVlJTkcpOwogICAgICAgIC8vY29uZmlybSBnYW1lIHRpbWUgCiAgICAgICAgcmVxdWlyZSggdGltZW5vdygpIDwgY3VyR2FtZS5kYXRlU3RvcEJ1eSApOwogICAgICAgIHVpbnQ4IHRpY2tldFN0YXR1cyA9IHVpbnQ4KChfdG9rZW4ub3B0aW9uID4+ICgxMio4KSkgJiAweEZGKTsKICAgICAgICAvL2NvbmZpcm0gdGlja2V0IHN0YXR1cwogICAgICAgIHJlcXVpcmUodGlja2V0U3RhdHVzID09IDApOwogICAgICAgIHVpbnQyNTYgcmVmdW5kRmVlID0gX3Rva2VuLnByaWNlOwogICAgICAgIC8vY29uZmlybSB0aWNrZXQgcHJpY2UKICAgICAgICByZXF1aXJlKHJlZnVuZEZlZSA+IDApOwogICAgICAgIHVpbnQ4IF9jaG9vc2UgPSB1aW50OCgoX3Rva2VuLm9wdGlvbiA+PiAoNCo4KSkgJiAweEZGRkZGRkZGKTsKICAgICAgICBjdXJHYW1lLnRvdGFsUG90ID0gY3VyR2FtZS50b3RhbFBvdC5zdWIocmVmdW5kRmVlKTsKICAgICAgICBjdXJHYW1lLnBvdERldGFpbFtfY2hvb3NlXSA9IGN1ckdhbWUucG90RGV0YWlsW19jaG9vc2VdLnN1YihyZWZ1bmRGZWUpOwogICAgICAgIF90b2tlbi5vcHRpb24gPSB1cGRhdGVUaWNrZXRTdGF0dXMoX3Rva2VuLm9wdGlvbiwzKTsKICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHJlZnVuZEZlZSk7CiAgICB9CiAgICBmdW5jdGlvbiBvcGVuUmVzdWx0KHVpbnQyNTYgX2lkLHVpbnQ4W10gX3Jlc3VsdClvbmx5QWRtaW4oKSBleHRlcm5hbHsKICAgICAgICBHYW1lIHN0b3JhZ2UgY3VyR2FtZSA9IGdhbWVzW19pZF07CiAgICAgICAgcmVxdWlyZShjdXJHYW1lLnN0YXR1cyA9PSBTVEFUVVMuUExBWUlORyk7CiAgICAgICAgcmVxdWlyZSh0aW1lbm93KCkgPiBjdXJHYW1lLmRhdGVTdG9wQnV5ICsgMio2MCo2MCk7CiAgICAgICAgCiAgICAgICAgdWludDI1NiBfdG90YWxXaW5uZXJzRGVwb3NpdCA9IDA7CiAgICAgICAgZm9yKHVpbnQyNTYgaT0wOyBpPCBfcmVzdWx0Lmxlbmd0aDsgaSsrKXsKICAgICAgICAgICAgcmVxdWlyZShfcmVzdWx0W2ldPDMwJiZfcmVzdWx0W2ldPj0wKTsKICAgICAgICAgICAgY3VyR2FtZS5yZXN1bHRbX3Jlc3VsdFtpXV0gPSAxOwogICAgICAgICAgICBfdG90YWxXaW5uZXJzRGVwb3NpdCA9IF90b3RhbFdpbm5lcnNEZXBvc2l0LmFkZChjdXJHYW1lLnBvdERldGFpbFtfcmVzdWx0W2ldXSk7CiAgICAgICAgfQogICAgICAgIGlmKF90b3RhbFdpbm5lcnNEZXBvc2l0ID4gMCl7CiAgICAgICAgICAgIGN1ckdhbWUuc3RhdHVzID0gU1RBVFVTLlBBWUlORzsKICAgICAgICAgICAgY3VyR2FtZS50b3RhbFdpbm5lcnNEZXBvc2l0ID0gX3RvdGFsV2lubmVyc0RlcG9zaXQ7CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAgIGN1ckdhbWUuc3RhdHVzID0gU1RBVFVTLlJFRlVORElORzsKICAgICAgICB9CiAgICB9CgogICAgCiAgICBmdW5jdGlvbiBnZXRXaW5uaW5nUHJpemUodWludDI1NiBfdGlkKXBheWFibGUgZXh0ZXJuYWx7CiAgICAgICAgcmVxdWlyZSh0b2tlbkluZGV4VG9Pd25lcltfdGlkXSA9PSBtc2cuc2VuZGVyKTsKICAgICAgICBUb2tlbiBzdG9yYWdlIF90b2tlbiA9IHRva2Vuc1tfdGlkXTsKICAgICAgICB1aW50OCBfY2hvb3NlID0gdWludDgoKF90b2tlbi5vcHRpb24gPj4gKDQqOCkpICYgMHhGRkZGRkZGRik7CiAgICAgICAgdWludDI1NiBnYW1lSWQgICA9IHVpbnQyNTYoKF90b2tlbi5vcHRpb24gPj4gKDgqOCkpICYgMHhGRkZGRkZGRik7CiAgICAgICAgR2FtZSBzdG9yYWdlIGN1ckdhbWUgPSBnYW1lc1tnYW1lSWRdOwogICAgICAgIC8vY29uZmlybSBnYW1lIHN0YXR1cwogICAgICAgIHJlcXVpcmUoY3VyR2FtZS5zdGF0dXMgPT0gU1RBVFVTLlBBWUlORyk7CiAgICAgICAgcmVxdWlyZShjdXJHYW1lLnJlc3VsdFtfY2hvb3NlXSA9PSAxKTsKICAgICAgICByZXF1aXJlKGN1ckdhbWUudG90YWxXaW5uZXJzRGVwb3NpdCA+IDApOwogICAgICAgIHJlcXVpcmUoY3VyR2FtZS50b3RhbFBvdCA+IDApOwogICAgICAgIHVpbnQ4IHRpY2tldFN0YXR1cyA9IHVpbnQ4KChfdG9rZW4ub3B0aW9uID4+ICgxMio4KSkgJiAweEZGKTsKICAgICAgICAvL2NvbmZpcm0gdGlja2V0IHN0YXR1cwogICAgICAgIHJlcXVpcmUodGlja2V0U3RhdHVzID09IDApOwogICAgICAgIHVpbnQyNTYgcGF5YmFzZSA9IF90b2tlbi5wcmljZTsKICAgICAgICAvL2NvbmZpcm0gdGlja2V0IHByaWNlCiAgICAgICAgcmVxdWlyZShwYXliYXNlID4gMCk7CiAgICAgICAgdWludDI1NiB3aW5uaW5nUHJpemUgPSAwOwogICAgICAgIGlmKGN1ckdhbWUudG90YWxXaW5uZXJzRGVwb3NpdCA+IDApewogICAgICAgICAgICB3aW5uaW5nUHJpemUgPSAocGF5YmFzZS5tdWwoY3VyR2FtZS50b3RhbFBvdCkpLmRpdihjdXJHYW1lLnRvdGFsV2lubmVyc0RlcG9zaXQpOwogICAgICAgIH0KICAgICAgICBpZih3aW5uaW5nUHJpemUgPiAwKXsKICAgICAgICAgICAgX3Rva2VuLm9wdGlvbiA9IHVwZGF0ZVRpY2tldFN0YXR1cyhfdG9rZW4ub3B0aW9uLDEpOwogICAgICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHdpbm5pbmdQcml6ZSk7CiAgICAgICAgfQogICAgfQogICAgZnVuY3Rpb24gZ2V0UmVmdW5kKHVpbnQyNTYgX3RpZClwYXlhYmxlIGV4dGVybmFsewogICAgICAgIC8vY29uZmlybSBvd25lcnNoaXAKICAgICAgICByZXF1aXJlKHRva2VuSW5kZXhUb093bmVyW190aWRdID09IG1zZy5zZW5kZXIpOwogICAgICAgIFRva2VuIHN0b3JhZ2UgX3Rva2VuID0gdG9rZW5zW190aWRdOwogICAgICAgIHVpbnQyNTYgZ2FtZUlkICAgPSB1aW50MjU2KChfdG9rZW4ub3B0aW9uID4+ICg4KjgpKSAmIDB4RkZGRkZGRkYpOwogICAgICAgIEdhbWUgc3RvcmFnZSBjdXJHYW1lID0gZ2FtZXNbZ2FtZUlkXTsKICAgICAgICAvL2NvbmZpcm0gZ2FtZSBzdGF0dXMKICAgICAgICByZXF1aXJlKGN1ckdhbWUuc3RhdHVzID09IFNUQVRVUy5SRUZVTkRJTkcpOwogICAgICAgIHJlcXVpcmUoY3VyR2FtZS50b3RhbFdpbm5lcnNEZXBvc2l0ID09IDApOwogICAgICAgIHJlcXVpcmUoY3VyR2FtZS50b3RhbFBvdCA+IDApOwogICAgICAgIHVpbnQ4IHRpY2tldFN0YXR1cyA9IHVpbnQ4KChfdG9rZW4ub3B0aW9uID4+ICgxMio4KSkgJiAweEZGKTsKICAgICAgICAvL2NvbmZpcm0gdGlja2V0IHN0YXR1cwogICAgICAgIHJlcXVpcmUodGlja2V0U3RhdHVzID09IDApOwogICAgICAgIHVpbnQyNTYgcmVmdW5kRmVlID0gX3Rva2VuLnByaWNlOwogICAgICAgIC8vY29uZmlybSB0aWNrZXQgcHJpY2UKICAgICAgICByZXF1aXJlKHJlZnVuZEZlZSA+IDApOwogIAogICAgICAgIF90b2tlbi5vcHRpb24gPSB1cGRhdGVUaWNrZXRTdGF0dXMoX3Rva2VuLm9wdGlvbiwyKTsKICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHJlZnVuZEZlZSk7CiAgICB9CiAgICBmdW5jdGlvbiBnZXRHYW1lSW5mb0J5SWQodWludDI1NiBfaWQpcHVibGljIHZpZXcgcmV0dXJucygKICAgIHVpbnQyNTYgX3RvdGFsUG90LAogICAgdWludDI1NiBfdG90YWxXaW5uZXJzRGVwb3NpdCwKICAgIHVpbnQyNTYgX2RhdGVTdG9wQnV5LAogICAgdWludDggX2dhbWVTdGF0dXMsCiAgICBzdHJpbmcgX3BvdERldGFpbCwgCiAgICBzdHJpbmcgX3Jlc3VsdHMsCiAgICBzdHJpbmcgX25hbWUKICAgICkKICAgIHsKICAgICAgICBHYW1lIHN0b3JhZ2UgY3VyR2FtZSA9IGdhbWVzW19pZF07CiAgICAgICAgX3BvdERldGFpbCA9ICIiOwogICAgICAgIF9yZXN1bHRzID0gIiI7CiAgICAgICAgZm9yKHVpbnQ4IGk9MDtpPDMwO2krKyl7CiAgICAgICAgICAgIF9wb3REZXRhaWwgPSBzdHJDb25jYXQoX3BvdERldGFpbCwiLCIsdWludDJzdHIoY3VyR2FtZS5wb3REZXRhaWxbaV0pKTsKICAgICAgICAgICAgX3Jlc3VsdHMgPSBzdHJDb25jYXQoX3Jlc3VsdHMsIiwiLHVpbnQyc3RyKGN1ckdhbWUucmVzdWx0W2ldKSk7CiAgICAgICAgfQogICAgICAgIF90b3RhbFBvdCA9IGN1ckdhbWUudG90YWxQb3Q7CiAgICAgICAgX3RvdGFsV2lubmVyc0RlcG9zaXQgPSBjdXJHYW1lLnRvdGFsV2lubmVyc0RlcG9zaXQ7CiAgICAgICAgX2RhdGVTdG9wQnV5ID0gY3VyR2FtZS5kYXRlU3RvcEJ1eTsKICAgICAgICBfbmFtZSA9IGN1ckdhbWUubmFtZTsKICAgICAgICBfZ2FtZVN0YXR1cyA9IHVpbnQ4KGN1ckdhbWUuc3RhdHVzKTsKICAgICAgICBpZiAoIGN1ckdhbWUuc3RhdHVzID09IFNUQVRVUy5QTEFZSU5HICYmIHRpbWVub3coKSA+IF9kYXRlU3RvcEJ1eSApIF9nYW1lU3RhdHVzID0gdWludDgoU1RBVFVTLlBST0NFU1NJTkcpOwogICAgfQogICAgZnVuY3Rpb24gZ2V0QWxsR2FtZXMoYm9vbCBvbmx5UGxheWluZyx1aW50MjU2IGZyb20sIHVpbnQyNTYgdG8pcHVibGljIHZpZXcgcmV0dXJucyhzdHJpbmcgZ2FtZUluZm9MaXN0KXsKICAgICAgICBnYW1lSW5mb0xpc3QgPSAiIjsKICAgICAgICB1aW50MjU2IGNvdW50ZXIgPSAwOwogICAgICAgIGZvcih1aW50MjU2IGk9MDsgaTxnYW1lSWRMaXN0Lmxlbmd0aDsgaSsrKXsKICAgICAgICAgICAgaWYoY291bnRlciA8IGZyb20pewogICAgICAgICAgICAgICAgY291bnRlcisrOwogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoY291bnRlciA+IHRvKXsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKChvbmx5UGxheWluZyYmZ2FtZXNbZ2FtZUlkTGlzdFtpXV0uc3RhdHVzID09IFNUQVRVUy5QTEFZSU5HICYmIHRpbWVub3coKSA8IGdhbWVzW2dhbWVJZExpc3RbaV1dLmRhdGVTdG9wQnV5KXx8b25seVBsYXlpbmc9PWZhbHNlKXsKICAgICAgICAgICAgICAgIGdhbWVJbmZvTGlzdCA9IHN0ckNvbmNhdChnYW1lSW5mb0xpc3QsInwiLHVpbnQyc3RyKGdhbWVzW2dhbWVJZExpc3RbaV1dLmlkKSk7CiAgICAgICAgICAgICAgICBnYW1lSW5mb0xpc3QgPSBzdHJDb25jYXQoZ2FtZUluZm9MaXN0LCIsIixnYW1lc1tnYW1lSWRMaXN0W2ldXS5uYW1lKTsKICAgICAgICAgICAgICAgIGdhbWVJbmZvTGlzdCA9IHN0ckNvbmNhdChnYW1lSW5mb0xpc3QsIiwiLHVpbnQyc3RyKGdhbWVzW2dhbWVJZExpc3RbaV1dLnRvdGFsUG90KSk7CiAgICAgICAgICAgICAgICBnYW1lSW5mb0xpc3QgPSBzdHJDb25jYXQoZ2FtZUluZm9MaXN0LCIsIix1aW50MnN0cihnYW1lc1tnYW1lSWRMaXN0W2ldXS5kYXRlU3RvcEJ1eSkpOwogICAgICAgICAgICAgICAgaWYoZ2FtZXNbZ2FtZUlkTGlzdFtpXV0uc3RhdHVzID09IFNUQVRVUy5QTEFZSU5HICYmIHRpbWVub3coKSA+IGdhbWVzW2dhbWVJZExpc3RbaV1dLmRhdGVTdG9wQnV5KXsKICAgICAgICAgICAgICAgICAgICBnYW1lSW5mb0xpc3QgPSBzdHJDb25jYXQoZ2FtZUluZm9MaXN0LCIsIix1aW50MnN0cih1aW50KFNUQVRVUy5QUk9DRVNTSU5HKSkpOwogICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgZ2FtZUluZm9MaXN0ID0gc3RyQ29uY2F0KGdhbWVJbmZvTGlzdCwiLCIsdWludDJzdHIodWludChnYW1lc1tnYW1lSWRMaXN0W2ldXS5zdGF0dXMpKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb3VudGVyKys7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAgICAgCiAgICBmdW5jdGlvbiBnZXRNeVRpY2tldExpc3QoYm9vbCBhY3RpdmUsdWludDI1NiBmcm9tLCB1aW50MjU2IHRvKXB1YmxpYyB2aWV3IHJldHVybnMoc3RyaW5nIGluZm8pewogICAgICAgIGluZm8gPSAiIjsKICAgICAgICB1aW50MjU2IGNvdW50ZXIgPSAwOwogICAgICAgIGlmKG93bmVyc2hpcFRva2VuQ291bnRbbXNnLnNlbmRlcl0gPiAwKXsKICAgICAgICAgICAgZm9yKHVpbnQyNTYgaT0wOyBpPHRvdGFsU3VwcGx5OyBpKyspewogICAgICAgICAgICAgICAgaWYodG9rZW5JbmRleFRvT3duZXJbaV0gPT0gbXNnLnNlbmRlcil7CiAgICAgICAgICAgICAgICAgICAgaWYoY291bnRlciA8IGZyb20pewogICAgICAgICAgICAgICAgICAgICAgICBjb3VudGVyKys7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZihjb3VudGVyID4gdG8pewogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgVG9rZW4gbWVtb3J5IF90b2tlbiA9IHRva2Vuc1tpXTsKICAgICAgICAgICAgICAgICAgICB1aW50MjU2IGdhbWVJZCA9IHVpbnQyNTYoKF90b2tlbi5vcHRpb24gPj4gKDgqOCkpICYgMHhGRkZGRkZGRik7CiAgICAgICAgICAgICAgICAgICAgdWludDI1NiB0U3RhdHVzID0gdWludDI1NigoX3Rva2VuLm9wdGlvbiA+PiAoMTIqOCkpICYgMHhGRik7CiAgICAgICAgICAgICAgICAgICAgdWludDI1NiBkYXRlQnV5ID0gdWludDI1NihfdG9rZW4ub3B0aW9uICYgMHhGRkZGRkZGRik7CiAgICAgICAgICAgICAgICAgICAgdWludDI1NiBfY2hvb3NlID0gdWludDI1NigoX3Rva2VuLm9wdGlvbiA+PiAoNCo4KSkgJiAweEZGRkZGRkZGKTsKICAgICAgICAgICAgICAgICAgICB1aW50MjU2IG90aGVycGljayA9IGdldE51bWJlcnNPZlBpY2soZ2FtZUlkLHVpbnQ4KF9jaG9vc2UpKTsKICAgICAgICAgICAgICAgICAgICBHYW1lIHN0b3JhZ2UgY3VyR2FtZSA9IGdhbWVzW2dhbWVJZF07CiAgICAgICAgICAgICAgICAgICAgaWYoKGFjdGl2ZSYmKHRTdGF0dXMgPT0gMCYmKGN1ckdhbWUuc3RhdHVzID09IFNUQVRVUy5QTEFZSU5HfHwoY3VyR2FtZS5yZXN1bHRbdWludDgoX2Nob29zZSldID09IDEmJmN1ckdhbWUuc3RhdHVzID09IFNUQVRVUy5QQVlJTkcpfHxjdXJHYW1lLnN0YXR1cyA9PSBTVEFUVVMuUkVGVU5ESU5HKSkpfHxhY3RpdmUgPT0gZmFsc2UpewogICAgICAgICAgICAgICAgICAgICAgICBpbmZvID0gc3RyQ29uY2F0KGluZm8sInwiLHVpbnQyc3RyKGkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgaW5mbyA9IHN0ckNvbmNhdChpbmZvLCIsIix1aW50MnN0cihnYW1lSWQpKTsKICAgICAgICAgICAgICAgICAgICAgICAgaW5mbyA9IHN0ckNvbmNhdChpbmZvLCIsIix1aW50MnN0cihfdG9rZW4ucHJpY2UpKTsKICAgICAgICAgICAgICAgICAgICAgICAgaW5mbyA9IHN0ckNvbmNhdChpbmZvLCIsIix1aW50MnN0cihkYXRlQnV5KSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGluZm8gPSBzdHJDb25jYXQoaW5mbywiLCIsdWludDJzdHIoX2Nob29zZSkpOwogICAgICAgICAgICAgICAgICAgICAgICBpbmZvID0gc3RyQ29uY2F0KGluZm8sIiwiLHVpbnQyc3RyKG90aGVycGljaykpOwogICAgICAgICAgICAgICAgICAgICAgICBpbmZvID0gc3RyQ29uY2F0KGluZm8sIiwiLHVpbnQyc3RyKHRTdGF0dXMpKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoY3VyR2FtZS5zdGF0dXMgPT0gU1RBVFVTLlBMQVlJTkcgJiYgdGltZW5vdygpID4gY3VyR2FtZS5kYXRlU3RvcEJ1eSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvID0gc3RyQ29uY2F0KGluZm8sIiwiLHVpbnQyc3RyKHVpbnQoU1RBVFVTLlBST0NFU1NJTkcpKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mbyA9IHN0ckNvbmNhdChpbmZvLCIsIix1aW50MnN0cih1aW50KGN1ckdhbWUuc3RhdHVzKSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRTdGF0dXMgPT0gM3x8Y3VyR2FtZS5wb3REZXRhaWxbdWludDgoX2Nob29zZSldPT0wKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm8gPSBzdHJDb25jYXQoaW5mbywiLCIsdWludDJzdHIoMCkpOy8vQ2FuY2VsZWQgdGlja2V0CiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY3VyR2FtZS50b3RhbFdpbm5lcnNEZXBvc2l0ID4gMCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY3VyR2FtZS5yZXN1bHRbdWludDgoX2Nob29zZSldPT0xKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9XaW4gdGlja2V0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm8gPSBzdHJDb25jYXQoaW5mbywiLCIsdWludDJzdHIoX3Rva2VuLnByaWNlLm11bChjdXJHYW1lLnRvdGFsUG90KS5kaXYoY3VyR2FtZS50b3RhbFdpbm5lcnNEZXBvc2l0KSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0xvc2UgdGlja2V0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm8gPSBzdHJDb25jYXQoaW5mbywiLCIsdWludDJzdHIoX3Rva2VuLnByaWNlLm11bChjdXJHYW1lLnRvdGFsUG90KS5kaXYoY3VyR2FtZS5wb3REZXRhaWxbdWludDgoX2Nob29zZSldKSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vUGVuZGluZyBvciBQcm9jZXNzaW5nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mbyA9IHN0ckNvbmNhdChpbmZvLCIsIix1aW50MnN0cihfdG9rZW4ucHJpY2UubXVsKGN1ckdhbWUudG90YWxQb3QpLmRpdihjdXJHYW1lLnBvdERldGFpbFt1aW50OChfY2hvb3NlKV0pKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoY3VyR2FtZS5zdGF0dXMgPT0gU1RBVFVTLlBBWUlORyYmY3VyR2FtZS5yZXN1bHRbdWludDgoX2Nob29zZSldID09IDEpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mbyA9IHN0ckNvbmNhdChpbmZvLCIsIix1aW50MnN0cigxKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm8gPSBzdHJDb25jYXQoaW5mbywiLCIsdWludDJzdHIoMCkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGluZm8gPSBzdHJDb25jYXQoaW5mbywiLCIsdWludDJzdHIoY3VyR2FtZS50b3RhbFBvdCkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjb3VudGVyKys7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0TnVtYmVyc09mUGljayh1aW50MjU2IF9naWQsIHVpbnQ4IF9waWNrKXB1YmxpYyB2aWV3IHJldHVybnModWludDI1NiBudW0pewogICAgICAgIHJlcXVpcmUoX3BpY2sgPCAzMCYmX3BpY2sgPj0gMCk7CiAgICAgICAgR2FtZSBzdG9yYWdlIGN1ckdhbWUgPSBnYW1lc1tfZ2lkXTsKICAgICAgICBudW0gPSAwOwogICAgICAgIGZvcih1aW50MjU2IGk9MDsgaTx0b3RhbFN1cHBseTsgaSsrKXsKICAgICAgICAgICAgdWludDI1NiBkYXRhID0gdG9rZW5zW2ldLm9wdGlvbjsKICAgICAgICAgICAgdWludDI1NiBfZ2FtZUlkID0gdWludDI1NigoZGF0YSA+PiAoOCo4KSkgJiAweEZGRkZGRkZGKTsKICAgICAgICAgICAgaWYoY3VyR2FtZS5pZCA9PSBfZ2FtZUlkKXsKICAgICAgICAgICAgICAgIHVpbnQ4IF9jaG9vc2UgPSB1aW50OCgoZGF0YSA+PiAoNCo4KSkgJiAweEZGRkZGRkZGKTsKICAgICAgICAgICAgICAgIHVpbnQ4IHRTdGF0dXMgPSB1aW50OCgoZGF0YSA+PiAoMTIqOCkpICYgMHhGRik7CiAgICAgICAgICAgICAgICBpZihfcGljayA9PSBfY2hvb3NlJiZ0U3RhdHVzIT0zKXsKICAgICAgICAgICAgICAgICAgICBudW0rKzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQ=='.
	

]
