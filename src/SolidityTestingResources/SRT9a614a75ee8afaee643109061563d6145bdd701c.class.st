Class {
	#name : #SRT9a614a75ee8afaee643109061563d6145bdd701c,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT9a614a75ee8afaee643109061563d6145bdd701c >> base64 [
	^ 'LyoKaHR0cHM6Ly9sdW1iZXJzY291dC5pbyA6IGF1dCB2aWFtIGludmVuaWFtIGF1dCBmYWNpYW0KKi8KCgpwcmFnbWEgc29saWRpdHkgXjAuNC4xOTsKCi8qKgogKiBAdGl0bGUgRVJDMjBCYXNpYwogKiBAZGV2IFNpbXBsZXIgdmVyc2lvbiBvZiBFUkMyMCBpbnRlcmZhY2UKICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzE3OQogKi8KY29udHJhY3QgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KTsKICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsKfQoKCi8qKgogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMAogKi8KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7CiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1Nik7CiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCk7CiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7Cn0KCgovKioKICAgQHRpdGxlIEVSQzgyNyBpbnRlcmZhY2UsIGFuIGV4dGVuc2lvbiBvZiBFUkMyMCB0b2tlbiBzdGFuZGFyZAogICBJbnRlcmZhY2Ugb2YgYSBFUkM4MjcgdG9rZW4sIGZvbGxvd2luZyB0aGUgRVJDMjAgc3RhbmRhcmQgd2l0aCBleHRyYQogICBtZXRob2RzIHRvIHRyYW5zZmVyIHZhbHVlIGFuZCBkYXRhIGFuZCBleGVjdXRlIGNhbGxzIGluIHRyYW5zZmVycyBhbmQKICAgYXBwcm92YWxzLgogKi8KY29udHJhY3QgRVJDODI3IGlzIEVSQzIwIHsKCiAgZnVuY3Rpb24gYXBwcm92ZSggYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9kYXRhICkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIHRyYW5zZmVyKCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9kYXRhICkgcHVibGljIHJldHVybnMgKGJvb2wpOwogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbSggYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSApIHB1YmxpYyByZXR1cm5zIChib29sKTsKCn0KCgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKCiAgLyoqCiAgKiBAZGV2IE11bHRpcGxpZXMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdy4KICAqLwogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBpZiAoYSA9PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQogICAgdWludDI1NiBjID0gYSAqIGI7CiAgICBhc3NlcnQoYyAvIGEgPT0gYik7CiAgICByZXR1cm4gYzsKICB9CgogIC8qKgogICogQGRldiBJbnRlZ2VyIGRpdmlzaW9uIG9mIHR3byBudW1iZXJzLCB0cnVuY2F0aW5nIHRoZSBxdW90aWVudC4KICAqLwogIGZ1bmN0aW9uIGRpdih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDAKICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQKICAgIHJldHVybiBjOwogIH0KCiAgLyoqCiAgKiBAZGV2IFN1YnN0cmFjdHMgdHdvIG51bWJlcnMsIHRocm93cyBvbiBvdmVyZmxvdyAoaS5lLiBpZiBzdWJ0cmFoZW5kIGlzIGdyZWF0ZXIgdGhhbiBtaW51ZW5kKS4KICAqLwogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICBhc3NlcnQoYiA8PSBhKTsKICAgIHJldHVybiBhIC0gYjsKICB9CgogIC8qKgogICogQGRldiBBZGRzIHR3byBudW1iZXJzLCB0aHJvd3Mgb24gb3ZlcmZsb3cuCiAgKi8KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgdWludDI1NiBjID0gYSArIGI7CiAgICBhc3NlcnQoYyA+PSBhKTsKICAgIHJldHVybiBjOwogIH0KfQoKCi8qKgogKiBAdGl0bGUgQmFzaWMgdG9rZW4KICogQGRldiBCYXNpYyB2ZXJzaW9uIG9mIFN0YW5kYXJkVG9rZW4sIHdpdGggbm8gYWxsb3dhbmNlcy4KICovCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7CiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsKCiAgdWludDI1NiB0b3RhbFN1cHBseV87CgogIC8qKgogICogQGRldiB0b3RhbCBudW1iZXIgb2YgdG9rZW5zIGluIGV4aXN0ZW5jZQogICovCiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50MjU2KSB7CiAgICByZXR1cm4gdG90YWxTdXBwbHlfOwogIH0KCiAgLyoqCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIHRvLgogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLgogICovCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgcmVxdWlyZShfdG8gIT0gYWRkcmVzcygwKSk7CiAgICByZXF1aXJlKF92YWx1ZSA8PSBiYWxhbmNlc1ttc2cuc2VuZGVyXSk7CgogICAgLy8gU2FmZU1hdGguc3ViIHdpbGwgdGhyb3cgaWYgdGhlcmUgaXMgbm90IGVub3VnaCBiYWxhbmNlLgogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOwogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgKi8KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgewogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07CiAgfQoKfQoKCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGludGVybmFsIGFsbG93ZWQ7CgoKICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgcmVxdWlyZShfdmFsdWUgPD0gYmFsYW5jZXNbX2Zyb21dKTsKICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdKTsKCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsKICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhdCBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zcGVuZGVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHJldHVybiBBIHVpbnQyNTYgc3BlY2lmeWluZyB0aGUgYW1vdW50IG9mIHRva2VucyBzdGlsbCBhdmFpbGFibGUgZm9yIHRoZSBzcGVuZGVyLgogICAqLwogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07CiAgfQoKICAvKioKICAgKiBAZGV2IEluY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX2FkZGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gaW5jcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKi8KICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgKiBAZGV2IERlY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBkZWNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX3N1YnRyYWN0ZWRWYWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBkZWNyZWFzZSB0aGUgYWxsb3dhbmNlIGJ5LgogICAqLwogIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgdWludCBvbGRWYWx1ZSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOwogICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IDA7CiAgICB9IGVsc2UgewogICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IG9sZFZhbHVlLnN1Yihfc3VidHJhY3RlZFZhbHVlKTsKICAgIH0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9CgoKCi8qKgogICBAdGl0bGUgRVJDODI3LCBhbiBleHRlbnNpb24gb2YgRVJDMjAgdG9rZW4gc3RhbmRhcmQKICAgSW1wbGVtZW50YXRpb24gdGhlIEVSQzgyNywgZm9sbG93aW5nIHRoZSBFUkMyMCBzdGFuZGFyZCB3aXRoIGV4dHJhCiAgIG1ldGhvZHMgdG8gdHJhbnNmZXIgdmFsdWUgYW5kIGRhdGEgYW5kIGV4ZWN1dGUgY2FsbHMgaW4gdHJhbnNmZXJzIGFuZAogICBhcHByb3ZhbHMuCiAgIFVzZXMgT3BlblplcHBlbGluIFN0YW5kYXJkVG9rZW4uCiAqLwpjb250cmFjdCBFUkM4MjdUb2tlbiBpcyBFUkM4MjcsIFN0YW5kYXJkVG9rZW4gewoKICAvKioKICAgICBAZGV2IEFkZGl0aW9uIHRvIEVSQzIwIHRva2VuIG1ldGhvZHMuIEl0IGFsbG93cyB0bwogICAgIGFwcHJvdmUgdGhlIHRyYW5zZmVyIG9mIHZhbHVlIGFuZCBleGVjdXRlIGEgY2FsbCB3aXRoIHRoZSBzZW50IGRhdGEuCiAgICAgQmV3YXJlIHRoYXQgY2hhbmdpbmcgYW4gYWxsb3dhbmNlIHdpdGggdGhpcyBtZXRob2QgYnJpbmdzIHRoZSByaXNrIHRoYXQKICAgICBzb21lb25lIG1heSB1c2UgYm90aCB0aGUgb2xkIGFuZCB0aGUgbmV3IGFsbG93YW5jZSBieSB1bmZvcnR1bmF0ZQogICAgIHRyYW5zYWN0aW9uIG9yZGVyaW5nLiBPbmUgcG9zc2libGUgc29sdXRpb24gdG8gbWl0aWdhdGUgdGhpcyByYWNlIGNvbmRpdGlvbgogICAgIGlzIHRvIGZpcnN0IHJlZHVjZSB0aGUgc3BlbmRlcidzIGFsbG93YW5jZSB0byAwIGFuZCBzZXQgdGhlIGRlc2lyZWQgdmFsdWUKICAgICBhZnRlcndhcmRzOgogICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICAgQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICAgQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4KICAgICBAcGFyYW0gX2RhdGEgQUJJLWVuY29kZWQgY29udHJhY3QgY2FsbCB0byBjYWxsIGBfdG9gIGFkZHJlc3MuCiAgICAgQHJldHVybiB0cnVlIGlmIHRoZSBjYWxsIGZ1bmN0aW9uIHdhcyBleGVjdXRlZCBzdWNjZXNzZnVsbHkKICAgKi8KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3NwZW5kZXIgIT0gYWRkcmVzcyh0aGlzKSk7CgogICAgc3VwZXIuYXBwcm92ZShfc3BlbmRlciwgX3ZhbHVlKTsKCiAgICByZXF1aXJlKF9zcGVuZGVyLmNhbGwoX2RhdGEpKTsKCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAgIEBkZXYgQWRkaXRpb24gdG8gRVJDMjAgdG9rZW4gbWV0aG9kcy4gVHJhbnNmZXIgdG9rZW5zIHRvIGEgc3BlY2lmaWVkCiAgICAgYWRkcmVzcyBhbmQgZXhlY3V0ZSBhIGNhbGwgd2l0aCB0aGUgc2VudCBkYXRhIG9uIHRoZSBzYW1lIHRyYW5zYWN0aW9uCiAgICAgQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICAgQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91dCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJlZAogICAgIEBwYXJhbSBfZGF0YSBBQkktZW5jb2RlZCBjb250cmFjdCBjYWxsIHRvIGNhbGwgYF90b2AgYWRkcmVzcy4KICAgICBAcmV0dXJuIHRydWUgaWYgdGhlIGNhbGwgZnVuY3Rpb24gd2FzIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseQogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2RhdGEpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF90byAhPSBhZGRyZXNzKHRoaXMpKTsKCiAgICBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7CgogICAgcmVxdWlyZShfdG8uY2FsbChfZGF0YSkpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvKioKICAgICBAZGV2IEFkZGl0aW9uIHRvIEVSQzIwIHRva2VuIG1ldGhvZHMuIFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvCiAgICAgYW5vdGhlciBhbmQgbWFrZSBhIGNvbnRyYWN0IGNhbGwgb24gdGhlIHNhbWUgdHJhbnNhY3Rpb24KICAgICBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICAgIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gdHJhbnNmZXIgdG8KICAgICBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91dCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQKICAgICBAcGFyYW0gX2RhdGEgQUJJLWVuY29kZWQgY29udHJhY3QgY2FsbCB0byBjYWxsIGBfdG9gIGFkZHJlc3MuCiAgICAgQHJldHVybiB0cnVlIGlmIHRoZSBjYWxsIGZ1bmN0aW9uIHdhcyBleGVjdXRlZCBzdWNjZXNzZnVsbHkKICAgKi8KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3ModGhpcykpOwoKICAgIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwoKICAgIHJlcXVpcmUoX3RvLmNhbGwoX2RhdGEpKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBZGRpdGlvbiB0byBTdGFuZGFyZFRva2VuIG1ldGhvZHMuIEluY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQKICAgKiBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlciBhbmQgZXhlY3V0ZSBhIGNhbGwgd2l0aCB0aGUgc2VudCBkYXRhLgogICAqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gaW5jcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9hZGRlZFZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGluY3JlYXNlIHRoZSBhbGxvd2FuY2UgYnkuCiAgICogQHBhcmFtIF9kYXRhIEFCSS1lbmNvZGVkIGNvbnRyYWN0IGNhbGwgdG8gY2FsbCBgX3NwZW5kZXJgIGFkZHJlc3MuCiAgICovCiAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hZGRlZFZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgIHJlcXVpcmUoX3NwZW5kZXIgIT0gYWRkcmVzcyh0aGlzKSk7CgogICAgc3VwZXIuaW5jcmVhc2VBcHByb3ZhbChfc3BlbmRlciwgX2FkZGVkVmFsdWUpOwoKICAgIHJlcXVpcmUoX3NwZW5kZXIuY2FsbChfZGF0YSkpOwoKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQGRldiBBZGRpdGlvbiB0byBTdGFuZGFyZFRva2VuIG1ldGhvZHMuIERlY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQKICAgKiBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlciBhbmQgZXhlY3V0ZSBhIGNhbGwgd2l0aCB0aGUgc2VudCBkYXRhLgogICAqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gZGVjcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zdWJ0cmFjdGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gZGVjcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKiBAcGFyYW0gX2RhdGEgQUJJLWVuY29kZWQgY29udHJhY3QgY2FsbCB0byBjYWxsIGBfc3BlbmRlcmAgYWRkcmVzcy4KICAgKi8KICBmdW5jdGlvbiBkZWNyZWFzZUFwcHJvdmFsKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSwgYnl0ZXMgX2RhdGEpIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICByZXF1aXJlKF9zcGVuZGVyICE9IGFkZHJlc3ModGhpcykpOwoKICAgIHN1cGVyLmRlY3JlYXNlQXBwcm92YWwoX3NwZW5kZXIsIF9zdWJ0cmFjdGVkVmFsdWUpOwoKICAgIHJlcXVpcmUoX3NwZW5kZXIuY2FsbChfZGF0YSkpOwoKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCgoKLyoqCiAqIEB0aXRsZSBPd25hYmxlCiAqIEBkZXYgVGhlIE93bmFibGUgY29udHJhY3QgaGFzIGFuIG93bmVyIGFkZHJlc3MsIGFuZCBwcm92aWRlcyBiYXNpYyBhdXRob3JpemF0aW9uIGNvbnRyb2wKICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4KICovCmNvbnRyYWN0IE93bmFibGUgewogIGFkZHJlc3MgcHVibGljIG93bmVyOwoKCiAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzT3duZXIsIGFkZHJlc3MgaW5kZXhlZCBuZXdPd25lcik7CgoKICAvKioKICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXIKICAgKiBhY2NvdW50LgogICAqLwogIGZ1bmN0aW9uIE93bmFibGUoKSBwdWJsaWMgewogICAgb3duZXIgPSBtc2cuc2VuZGVyOwogIH0KCiAgLyoqCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLgogICAqLwogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7CiAgICBfOwogIH0KCiAgLyoqCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLgogICAqLwogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIHB1YmxpYyBvbmx5T3duZXIgewogICAgcmVxdWlyZShuZXdPd25lciAhPSBhZGRyZXNzKDApKTsKICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7CiAgICBvd25lciA9IG5ld093bmVyOwogIH0KCn0KCgpjb250cmFjdCBUQUxMWSBpcyBFUkM4MjdUb2tlbiwgT3duYWJsZQp7CiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsKICAgIAogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIlRBTExZIjsKICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIlRMWSI7CiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4OwogICAgCiAgICBhZGRyZXNzIHB1YmxpYyBmb3VuZGF0aW9uQWRkcmVzczsKICAgIGFkZHJlc3MgcHVibGljIGRldmVsb3BtZW50RnVuZEFkZHJlc3M7CiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBERVZFTE9QTUVOVF9GVU5EX0xPQ0tfVElNRVNQQU4gPSAyIHllYXJzOwogICAgCiAgICB1aW50MjU2IHB1YmxpYyBkZXZlbG9wbWVudEZ1bmRVbmxvY2tUaW1lOwogICAgCiAgICBib29sIHB1YmxpYyB0b2tlblNhbGVFbmFibGVkOwogICAgCiAgICB1aW50MjU2IHB1YmxpYyBwcmVTYWxlU3RhcnRUaW1lOwogICAgdWludDI1NiBwdWJsaWMgcHJlU2FsZUVuZFRpbWU7CiAgICB1aW50MjU2IHB1YmxpYyBwcmVTYWxlVExZcGVyRVRIOwogICAgCiAgICB1aW50MjU2IHB1YmxpYyBwcmVmZXJyZWRTYWxlU3RhcnRUaW1lOwogICAgdWludDI1NiBwdWJsaWMgcHJlZmVycmVkU2FsZUVuZFRpbWU7CiAgICB1aW50MjU2IHB1YmxpYyBwcmVmZXJyZWRTYWxlVExZcGVyRVRIOwoKICAgIHVpbnQyNTYgcHVibGljIG1haW5TYWxlU3RhcnRUaW1lOwogICAgdWludDI1NiBwdWJsaWMgbWFpblNhbGVFbmRUaW1lOwogICAgdWludDI1NiBwdWJsaWMgbWFpblNhbGVUTFlwZXJFVEg7CiAgICAKICAgIHVpbnQyNTYgcHVibGljIHByZVNhbGVUb2tlbnNMZWZ0Rm9yU2FsZSA9IDcwMDAwMDAwICogKHVpbnQyNTYoMTApKipkZWNpbWFscyk7CiAgICB1aW50MjU2IHB1YmxpYyBwcmVmZXJyZWRTYWxlVG9rZW5zTGVmdEZvclNhbGUgPSA3MDAwMDAwMCAqICh1aW50MjU2KDEwKSoqZGVjaW1hbHMpOwogICAgCiAgICB1aW50MjU2IHB1YmxpYyBtaW5pbXVtQW1vdW50VG9QYXJ0aWNpcGF0ZSA9IDAuNSBldGhlcjsKICAgIAogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBhZGRyZXNzVG9TcGVudEV0aGVyOwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBhZGRyZXNzVG9QdXJjaGFzZWRUb2tlbnM7CiAgICAKICAgIGZ1bmN0aW9uIFRBTExZKCkgcHVibGljCiAgICB7CiAgICAgICAgb3duZXIgPSAweGQ1MTJmYTlDYTNERjBhMjE0NWU3N0I0NDU1NzlENDIxMDM4MEE2MzU7CiAgICAgICAgZGV2ZWxvcG1lbnRGdW5kQWRkcmVzcyA9IDB4NEQxODcwMEEwNUQ5MmFlNWU0OTcyNGYxMzQ1N2UxOTU5MzI5ZTgwZTsKICAgICAgICBmb3VuZGF0aW9uQWRkcmVzcyA9IDB4ZjFBMmU3YTE2NEVGNTY4MDcxMDViYTE5OGVmOEYyNDY1QjY4MkIxNjsKICAgICAgICAKICAgICAgICBiYWxhbmNlc1tkZXZlbG9wbWVudEZ1bmRBZGRyZXNzXSA9IDMwMDAwMDAwMCAqICh1aW50MjU2KDEwKSoqZGVjaW1hbHMpOwogICAgICAgIFRyYW5zZmVyKDB4MCwgZGV2ZWxvcG1lbnRGdW5kQWRkcmVzcywgYmFsYW5jZXNbZGV2ZWxvcG1lbnRGdW5kQWRkcmVzc10pOwogICAgICAgIAogICAgICAgIGJhbGFuY2VzW3RoaXNdID0gMTAwMDAwMDAwMCAqICh1aW50MjU2KDEwKSoqZGVjaW1hbHMpOwogICAgICAgIFRyYW5zZmVyKDB4MCwgdGhpcywgYmFsYW5jZXNbdGhpc10pOwogICAgICAgIAogICAgICAgIHRvdGFsU3VwcGx5XyA9IGJhbGFuY2VzW3RoaXNdICsgYmFsYW5jZXNbZGV2ZWxvcG1lbnRGdW5kQWRkcmVzc107CiAgICAgICAgCiAgICAgICAgcHJlU2FsZVRMWXBlckVUSCA9IDMwMDAwOwogICAgICAgIHByZWZlcnJlZFNhbGVUTFlwZXJFVEggPSAyNTM3NTsKICAgICAgICBtYWluU2FsZVRMWXBlckVUSCA9IDIwMDAwOwogICAgICAgIAogICAgICAgIHByZVNhbGVTdGFydFRpbWUgPSAxNTE4NjUyODAwOwogICAgICAgIHByZVNhbGVFbmRUaW1lID0gMTUxOTUxNjgwMDsgLy8gMTUgZmVicnVhcnkgMjAxOCAtIDI1IGZlYnJ1YXJ5IDIwMTgKICAgICAgICAKICAgICAgICBwcmVmZXJyZWRTYWxlU3RhcnRUaW1lID0gMTUxOTg2MjQwMDsKICAgICAgICBwcmVmZXJyZWRTYWxlRW5kVGltZSA9IDE1MjEwNzIwMDA7IC8vIDAxIG1hcmNoIDIwMTggLSAxNSBtYXJjaCAyMDE4CiAgICAgICAgCiAgICAgICAgbWFpblNhbGVTdGFydFRpbWUgPSAxNTIxNTA0MDAwOwogICAgICAgIG1haW5TYWxlRW5kVGltZSA9IDE1MjY3NzQ0MDA7IC8vIDIwIG1hcmNoIDIwMTggLSAyMCBtYXkgMjAxOAogICAgICAgIAogICAgICAgIHRva2VuU2FsZUVuYWJsZWQgPSB0cnVlOwogICAgICAgIAogICAgICAgIGRldmVsb3BtZW50RnVuZFVubG9ja1RpbWUgPSBub3cgKyBERVZFTE9QTUVOVF9GVU5EX0xPQ0tfVElNRVNQQU47CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uICgpIHBheWFibGUgZXh0ZXJuYWwKICAgIHsKICAgICAgICByZXF1aXJlKHRva2VuU2FsZUVuYWJsZWQpOwogICAgICAgIAogICAgICAgIHJlcXVpcmUobXNnLnZhbHVlID49IG1pbmltdW1BbW91bnRUb1BhcnRpY2lwYXRlKTsKICAgICAgICAKICAgICAgICB1aW50MjU2IHRva2Vuc1B1cmNoYXNlZDsKICAgICAgICBpZiAobm93ID49IHByZVNhbGVTdGFydFRpbWUgJiYgbm93IDwgcHJlU2FsZUVuZFRpbWUpCiAgICAgICAgewogICAgICAgICAgICB0b2tlbnNQdXJjaGFzZWQgPSBtc2cudmFsdWUubXVsKHByZVNhbGVUTFlwZXJFVEgpOwogICAgICAgICAgICBwcmVTYWxlVG9rZW5zTGVmdEZvclNhbGUgPSBwcmVTYWxlVG9rZW5zTGVmdEZvclNhbGUuc3ViKHRva2Vuc1B1cmNoYXNlZCk7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKG5vdyA+PSBwcmVmZXJyZWRTYWxlU3RhcnRUaW1lICYmIG5vdyA8IHByZWZlcnJlZFNhbGVFbmRUaW1lKQogICAgICAgIHsKICAgICAgICAgICAgdG9rZW5zUHVyY2hhc2VkID0gbXNnLnZhbHVlLm11bChwcmVmZXJyZWRTYWxlVExZcGVyRVRIKTsKICAgICAgICAgICAgcHJlZmVycmVkU2FsZVRva2Vuc0xlZnRGb3JTYWxlID0gcHJlZmVycmVkU2FsZVRva2Vuc0xlZnRGb3JTYWxlLnN1Yih0b2tlbnNQdXJjaGFzZWQpOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChub3cgPj0gbWFpblNhbGVTdGFydFRpbWUgJiYgbm93IDwgbWFpblNhbGVFbmRUaW1lKQogICAgICAgIHsKICAgICAgICAgICAgdG9rZW5zUHVyY2hhc2VkID0gbXNnLnZhbHVlLm11bChtYWluU2FsZVRMWXBlckVUSCk7CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIHJldmVydCgpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBhZGRyZXNzVG9TcGVudEV0aGVyW21zZy5zZW5kZXJdID0gYWRkcmVzc1RvU3BlbnRFdGhlclttc2cuc2VuZGVyXS5hZGQobXNnLnZhbHVlKTsKICAgICAgICBhZGRyZXNzVG9QdXJjaGFzZWRUb2tlbnNbbXNnLnNlbmRlcl0gPSBhZGRyZXNzVG9QdXJjaGFzZWRUb2tlbnNbbXNnLnNlbmRlcl0uYWRkKHRva2Vuc1B1cmNoYXNlZCk7CiAgICAgICAgCiAgICAgICAgdGhpcy50cmFuc2Zlcihtc2cuc2VuZGVyLCB0b2tlbnNQdXJjaGFzZWQpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiByZWZ1bmQoKSBleHRlcm5hbAogICAgewogICAgICAgIC8vIE9ubHkgYWxsb3cgcmVmdW5kcyBiZWZvcmUgdGhlIG1haW4gc2FsZSBoYXMgZW5kZWQKICAgICAgICByZXF1aXJlKG5vdyA8IG1haW5TYWxlRW5kVGltZSk7CiAgICAgICAgCiAgICAgICAgdWludDI1NiB0b2tlbnNSZWZ1bmRlZCA9IGFkZHJlc3NUb1B1cmNoYXNlZFRva2Vuc1ttc2cuc2VuZGVyXTsKICAgICAgICB1aW50MjU2IGV0aGVyUmVmdW5kZWQgPSBhZGRyZXNzVG9TcGVudEV0aGVyW21zZy5zZW5kZXJdOwogICAgICAgIGFkZHJlc3NUb1B1cmNoYXNlZFRva2Vuc1ttc2cuc2VuZGVyXSA9IDA7CiAgICAgICAgYWRkcmVzc1RvU3BlbnRFdGhlclttc2cuc2VuZGVyXSA9IDA7CiAgICAgICAgCiAgICAgICAgLy8gU2VuZCB0aGUgdG9rZW5zIGJhY2sgdG8gdGhpcyBjb250cmFjdAogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKHRva2Vuc1JlZnVuZGVkKTsKICAgICAgICBiYWxhbmNlc1t0aGlzXSA9IGJhbGFuY2VzW3RoaXNdLmFkZCh0b2tlbnNSZWZ1bmRlZCk7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgdGhpcywgdG9rZW5zUmVmdW5kZWQpOwogICAgICAgIAogICAgICAgIC8vIEFkZCB0aGUgdG9rZW5zIGJhY2sgdG8gdGhlIHByZS1zYWxlIG9yIHByZWZlcnJlZCBzYWxlCiAgICAgICAgaWYgKG5vdyA8IHByZVNhbGVFbmRUaW1lKQogICAgICAgIHsKICAgICAgICAgICAgcHJlU2FsZVRva2Vuc0xlZnRGb3JTYWxlID0gcHJlU2FsZVRva2Vuc0xlZnRGb3JTYWxlLmFkZCh0b2tlbnNSZWZ1bmRlZCk7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKG5vdyA8IHByZWZlcnJlZFNhbGVFbmRUaW1lKQogICAgICAgIHsKICAgICAgICAgICAgcHJlZmVycmVkU2FsZVRva2Vuc0xlZnRGb3JTYWxlID0gcHJlZmVycmVkU2FsZVRva2Vuc0xlZnRGb3JTYWxlLmFkZCh0b2tlbnNSZWZ1bmRlZCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIFNlbmQgdGhlIGV0aGVyIGJhY2sgdG8gdGhlIHVzZXIKICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKGV0aGVyUmVmdW5kZWQpOwogICAgfQogICAgCiAgICAvLyBQcmV2ZW50IHRoZSBkZXZlbG9wbWVudCBmdW5kIGZyb20gdHJhbnNmZXJyaW5nIGl0cyB0b2tlbnMgd2hpbGUgdGhleSBhcmUgbG9ja2VkCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKQogICAgewogICAgICAgIGlmIChtc2cuc2VuZGVyID09IGRldmVsb3BtZW50RnVuZEFkZHJlc3MgJiYgbm93IDwgZGV2ZWxvcG1lbnRGdW5kVW5sb2NrVGltZSkgcmV2ZXJ0KCk7CiAgICAgICAgc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogICAgfQogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgaWYgKG1zZy5zZW5kZXIgPT0gZGV2ZWxvcG1lbnRGdW5kQWRkcmVzcyAmJiBub3cgPCBkZXZlbG9wbWVudEZ1bmRVbmxvY2tUaW1lKSByZXZlcnQoKTsKICAgICAgICBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSwgX2RhdGEpOwogICAgfQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgaWYgKF9mcm9tID09IGRldmVsb3BtZW50RnVuZEFkZHJlc3MgJiYgbm93IDwgZGV2ZWxvcG1lbnRGdW5kVW5sb2NrVGltZSkgcmV2ZXJ0KCk7CiAgICAgICAgc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7CiAgICB9CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHVibGljIHJldHVybnMgKGJvb2wpCiAgICB7CiAgICAgICAgaWYgKF9mcm9tID09IGRldmVsb3BtZW50RnVuZEFkZHJlc3MgJiYgbm93IDwgZGV2ZWxvcG1lbnRGdW5kVW5sb2NrVGltZSkgcmV2ZXJ0KCk7CiAgICAgICAgc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSwgX2RhdGEpOwogICAgfQogICAgCiAgICAvLyBBbGxvdyB0aGUgb3duZXIgdG8gcmV0cmlldmUgYWxsIHRoZSBjb2xsZWN0ZWQgRVRICiAgICBmdW5jdGlvbiBkcmFpbigpIGV4dGVybmFsIG9ubHlPd25lcgogICAgewogICAgICAgIG93bmVyLnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7CiAgICB9CiAgICAKICAgIC8vIEFsbG93IHRoZSBvd25lciB0byBlbmFibGUgb3IgZGlzYWJsZSB0aGUgdG9rZW4gc2FsZSBhdCBhbnkgdGltZS4KICAgIGZ1bmN0aW9uIGVuYWJsZVRva2VuU2FsZSgpIGV4dGVybmFsIG9ubHlPd25lcgogICAgewogICAgICAgIHRva2VuU2FsZUVuYWJsZWQgPSB0cnVlOwogICAgfQogICAgZnVuY3Rpb24gZGlzYWJsZVRva2VuU2FsZSgpIGV4dGVybmFsIG9ubHlPd25lcgogICAgewogICAgICAgIHRva2VuU2FsZUVuYWJsZWQgPSBmYWxzZTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gbW92ZVVuc29sZFRva2Vuc1RvRm91bmRhdGlvbigpIGV4dGVybmFsIG9ubHlPd25lcgogICAgewogICAgICAgIHRoaXMudHJhbnNmZXIoZm91bmRhdGlvbkFkZHJlc3MsIGJhbGFuY2VzW3RoaXNdKTsKICAgIH0KICAgIAogICAgLy8gUHJlLXNhbGUgY29uZmlndXJhdGlvbgogICAgZnVuY3Rpb24gc2V0UHJlU2FsZVRMWXBlckVUSCh1aW50MjU2IF9uZXdUTFlwZXJFVEgpIHB1YmxpYyBvbmx5T3duZXIKICAgIHsKICAgICAgICBwcmVTYWxlVExZcGVyRVRIID0gX25ld1RMWXBlckVUSDsKICAgIH0KICAgIGZ1bmN0aW9uIHNldFByZVNhbGVTdGFydEFuZEVuZFRpbWUodWludDI1NiBfbmV3U3RhcnRUaW1lLCB1aW50MjU2IF9uZXdFbmRUaW1lKSBwdWJsaWMgb25seU93bmVyCiAgICB7CiAgICAgICAgcHJlU2FsZVN0YXJ0VGltZSA9IF9uZXdTdGFydFRpbWU7CiAgICAgICAgcHJlU2FsZUVuZFRpbWUgPSBfbmV3RW5kVGltZTsKICAgIH0KICAgIAogICAgLy8gUHJlZmVycmVkIHNhbGUgY29uZmlndXJhdGlvbgogICAgZnVuY3Rpb24gc2V0UHJlZmVycmVkU2FsZVRMWXBlckVUSCh1aW50MjU2IF9uZXdUTFlwZXJFVEgpIHB1YmxpYyBvbmx5T3duZXIKICAgIHsKICAgICAgICBwcmVmZXJyZWRTYWxlVExZcGVyRVRIID0gX25ld1RMWXBlckVUSDsKICAgIH0KICAgIGZ1bmN0aW9uIHNldFByZWZlcnJlZFNhbGVTdGFydEFuZEVuZFRpbWUodWludDI1NiBfbmV3U3RhcnRUaW1lLCB1aW50MjU2IF9uZXdFbmRUaW1lKSBwdWJsaWMgb25seU93bmVyCiAgICB7CiAgICAgICAgcHJlZmVycmVkU2FsZVN0YXJ0VGltZSA9IF9uZXdTdGFydFRpbWU7CiAgICAgICAgcHJlZmVycmVkU2FsZUVuZFRpbWUgPSBfbmV3RW5kVGltZTsKICAgIH0KICAgIAogICAgLy8gTWFpbiBzYWxlIGNvbmZpZ3VyYXRpb24KICAgIGZ1bmN0aW9uIHNldE1haW5TYWxlVExZcGVyRVRIKHVpbnQyNTYgX25ld1RMWXBlckVUSCkgcHVibGljIG9ubHlPd25lcgogICAgewogICAgICAgIG1haW5TYWxlVExZcGVyRVRIID0gX25ld1RMWXBlckVUSDsKICAgIH0KICAgIGZ1bmN0aW9uIHNldE1haW5TYWxlU3RhcnRBbmRFbmRUaW1lKHVpbnQyNTYgX25ld1N0YXJ0VGltZSwgdWludDI1NiBfbmV3RW5kVGltZSkgcHVibGljIG9ubHlPd25lcgogICAgewogICAgICAgIG1haW5TYWxlU3RhcnRUaW1lID0gX25ld1N0YXJ0VGltZTsKICAgICAgICBtYWluU2FsZUVuZFRpbWUgPSBfbmV3RW5kVGltZTsKICAgIH0KfQ=='.
	

]
