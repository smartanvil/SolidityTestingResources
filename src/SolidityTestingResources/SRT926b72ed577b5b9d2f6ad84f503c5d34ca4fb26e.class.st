Class {
	#name : #SRT926b72ed577b5b9d2f6ad84f503c5d34ca4fb26e,
	#superclass : #SRTContracts,
	#category : #SolidityTestingResources
}

{ #category : #base64 }
SRT926b72ed577b5b9d2f6ad84f503c5d34ca4fb26e >> base64 [
	^ 'cHJhZ21hIHNvbGlkaXR5IF4wLjQuMTc7CgovKioKICogQHRpdGxlIE93bmFibGUKICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbAogKiBmdW5jdGlvbnMsIHRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgInVzZXIgcGVybWlzc2lvbnMiLgogKi8KY29udHJhY3QgT3duYWJsZSB7CiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKCgogIC8qKgogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcgogICAqIGFjY291bnQuCiAgICovCiAgICBmdW5jdGlvbiBPd25hYmxlKCkgcHVibGljIHsKICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7CiAgICB9CgoKICAvKioKICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuCiAgICovCiAgICBtb2RpZmllciBvbmx5T3duZXIoKXsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOwogICAgICAgIF87CiAgICB9CgogIC8qKgogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4KICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciBwdWJsaWMgewogICAgICAgIGlmIChuZXdPd25lciAhPSBhZGRyZXNzKDApKSB7CiAgICAgICAgICAgIG93bmVyID0gbmV3T3duZXI7CiAgICAgICAgfQogICAgfQp9CgoKLyoqCiAqIEB0aXRsZSBQYXVzYWJsZQogKiBAZGV2IEJhc2UgY29udHJhY3Qgd2hpY2ggYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uCiAqLwpjb250cmFjdCBQYXVzYWJsZSBpcyBPd25hYmxlIHsKICAgIGV2ZW50IFBhdXNlKCk7CiAgICBldmVudCBVbnBhdXNlKCk7CgogICAgYm9vbCBwdWJsaWMgcGF1c2VkID0gZmFsc2U7CgoKICAvKioKICAgKiBAZGV2IG1vZGlmaWVyIHRvIGFsbG93IGFjdGlvbnMgb25seSB3aGVuIHRoZSBjb250cmFjdCBJUyBwYXVzZWQKICAgKi8KICAgIG1vZGlmaWVyIHdoZW5Ob3RQYXVzZWQoKSB7CiAgICAgICAgcmVxdWlyZSAoIXBhdXNlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgLyoqCiAgICogQGRldiBtb2RpZmllciB0byBhbGxvdyBhY3Rpb25zIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgSVMgTk9UIHBhdXNlZAogICAqLwogICAgbW9kaWZpZXIgd2hlblBhdXNlZCB7CiAgICAgICAgcmVxdWlyZSAocGF1c2VkKTsKICAgICAgICBfOwogICAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gcGF1c2UsIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUKICAgKi8KICAgIGZ1bmN0aW9uIHBhdXNlKCkgb25seU93bmVyIHdoZW5Ob3RQYXVzZWQgIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcGF1c2VkID0gdHJ1ZTsKICAgICAgICBQYXVzZSgpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAvKioKICAgKiBAZGV2IGNhbGxlZCBieSB0aGUgb3duZXIgdG8gdW5wYXVzZSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUKICAgKi8KICAgIGZ1bmN0aW9uIHVucGF1c2UoKSBvbmx5T3duZXIgd2hlblBhdXNlZCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHBhdXNlZCA9IGZhbHNlOwogICAgICAgIFVucGF1c2UoKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQovKioKICogQHRpdGxlIEVSQzIwQmFzaWMKICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8xNzkKICovCmNvbnRyYWN0IEVSQzIwQmFzaWMgewogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7CiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIEVSQzIwIGludGVyZmFjZQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAKICovCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgewogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOwogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpOwogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sKTsKICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpOwp9CgovKioKICogQHRpdGxlIFNhZmVNYXRoCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yCiAqLwpsaWJyYXJ5IFNhZmVNYXRoIHsKICAgIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcHVyZSByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgdWludDI1NiBjID0gYSAqIGI7CiAgICAgICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHB1cmUgcmV0dXJucyAodWludDI1NikgewogICAgICAgIC8vIGFzc2VydChiID4gMCk7IC8vIFNvbGlkaXR5IGF1dG9tYXRpY2FsbHkgdGhyb3dzIHdoZW4gZGl2aWRpbmcgYnkgMAogICAgICAgIHVpbnQyNTYgYyA9IGEgLyBiOwogICAgICAgIC8vIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOyAvLyBUaGVyZSBpcyBubyBjYXNlIGluIHdoaWNoIHRoaXMgZG9lc24ndCBob2xkCiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICBhc3NlcnQoYiA8PSBhKTsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBwdXJlIHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICB1aW50MjU2IGMgPSBhICsgYjsKICAgICAgICBhc3NlcnQoYyA+PSBhKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KfQoKLyoqCiAqIEB0aXRsZSBCYXNpYyB0b2tlbgogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLgogKi8KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsKICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2OwogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIGJhbGFuY2VzOwoKICAvKioKICAqIEBkZXYgdHJhbnNmZXIgdG9rZW4gZm9yIGEgc3BlY2lmaWVkIGFkZHJlc3MKICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uCiAgICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCB0byBiZSB0cmFuc2ZlcnJlZC4KICAgKi8KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpewogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAvKioKICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuCiAgKiBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRvIHF1ZXJ5IHRoZSB0aGUgYmFsYW5jZSBvZi4KICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuCiAgICovCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsKICAgICAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsKICAgIH0KfQoKCi8qKgogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4KICoKICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wKICovCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIEJhc2ljVG9rZW4gewoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgaW50ZXJuYWwgYWxsb3dlZDsKCgogICAvKioKICAgKiBAZGV2IFRyYW5zZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIGFub3RoZXIKICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgICogQHBhcmFtIF92YWx1ZSB1aW50MjU2IHRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkCiAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHJlcXVpcmUoX3RvICE9IGFkZHJlc3MoMCkpOwogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGJhbGFuY2VzW19mcm9tXSk7CiAgICAgICAgcmVxdWlyZShfdmFsdWUgPD0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0pOwoKICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7CiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7CiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsKICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAvKioKICAgKiBAZGV2IEFwcHJvdmUgdGhlIHBhc3NlZCBhZGRyZXNzIHRvIHNwZW5kIHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIHRva2VucyBvbiBiZWhhbGYgb2YgbXNnLnNlbmRlci4KICAgKgogICAqIEJld2FyZSB0aGF0IGNoYW5naW5nIGFuIGFsbG93YW5jZSB3aXRoIHRoaXMgbWV0aG9kIGJyaW5ncyB0aGUgcmlzayB0aGF0IHNvbWVvbmUgbWF5IHVzZSBib3RoIHRoZSBvbGQKICAgKiBhbmQgdGhlIG5ldyBhbGxvd2FuY2UgYnkgdW5mb3J0dW5hdGUgdHJhbnNhY3Rpb24gb3JkZXJpbmcuIE9uZSBwb3NzaWJsZSBzb2x1dGlvbiB0byBtaXRpZ2F0ZSB0aGlzCiAgICogcmFjZSBjb25kaXRpb24gaXMgdG8gZmlyc3QgcmVkdWNlIHRoZSBzcGVuZGVyJ3MgYWxsb3dhbmNlIHRvIDAgYW5kIHNldCB0aGUgZGVzaXJlZCB2YWx1ZSBhZnRlcndhcmRzOgogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5CiAgICogQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuCiAgICovCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOwogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAvKioKICAgKiBAZGV2IEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLgogICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLgogICAqIEByZXR1cm4gQSB1aW50MjU2IHNwZWNpZnlpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWxhYmxlIGZvciB0aGUgc3BlbmRlci4KICAgKi8KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOwogICAgfQoKICAvKioKICAgKiBAZGV2IEluY3JlYXNlIHRoZSBhbW91bnQgb2YgdG9rZW5zIHRoYXQgYW4gb3duZXIgYWxsb3dlZCB0byBhIHNwZW5kZXIuCiAgICoKICAgKiBhcHByb3ZlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbGxvd2VkW19zcGVuZGVyXSA9PSAwLiBUbyBpbmNyZW1lbnQKICAgKiBhbGxvd2VkIHZhbHVlIGlzIGJldHRlciB0byB1c2UgdGhpcyBmdW5jdGlvbiB0byBhdm9pZCAyIGNhbGxzIChhbmQgd2FpdCB1bnRpbAogICAqIHRoZSBmaXJzdCB0cmFuc2FjdGlvbiBpcyBtaW5lZCkKICAgKiBGcm9tIE1vbm9saXRoREFPIFRva2VuLnNvbAogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4KICAgKiBAcGFyYW0gX2FkZGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gaW5jcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKi8KICAgIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdLmFkZChfYWRkZWRWYWx1ZSk7CiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgLyoqCiAgICogQGRldiBEZWNyZWFzZSB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLgogICAqCiAgICogYXBwcm92ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYWxsb3dlZFtfc3BlbmRlcl0gPT0gMC4gVG8gZGVjcmVtZW50CiAgICogYWxsb3dlZCB2YWx1ZSBpcyBiZXR0ZXIgdG8gdXNlIHRoaXMgZnVuY3Rpb24gdG8gYXZvaWQgMiBjYWxscyAoYW5kIHdhaXQgdW50aWwKICAgKiB0aGUgZmlyc3QgdHJhbnNhY3Rpb24gaXMgbWluZWQpCiAgICogRnJvbSBNb25vbGl0aERBTyBUb2tlbi5zb2wKICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuCiAgICogQHBhcmFtIF9zdWJ0cmFjdGVkVmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gZGVjcmVhc2UgdGhlIGFsbG93YW5jZSBieS4KICAgKi8KICAgIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfc3VidHJhY3RlZFZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXTsKICAgICAgICBpZiAoX3N1YnRyYWN0ZWRWYWx1ZSA+IG9sZFZhbHVlKSB7CiAgICAgICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gMDsKICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gb2xkVmFsdWUuc3ViKF9zdWJ0cmFjdGVkVmFsdWUpOwogICAgfQogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cgp9CgoKLyoqCiAqIEB0aXRsZSBNaW50YWJsZSB0b2tlbgogKiBAZGV2IFNpbXBsZSBFUkMyMCBUb2tlbiBleGFtcGxlLCB3aXRoIG1pbnRhYmxlIHRva2VuIGNyZWF0aW9uCiAqIEBkZXYgSXNzdWU6ICogaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXBwZWxpbi1zb2xpZGl0eS9pc3N1ZXMvMTIwCiAqIEJhc2VkIG9uIGNvZGUgYnkgVG9rZW5NYXJrZXROZXQ6IGh0dHBzOi8vZ2l0aHViLmNvbS9Ub2tlbk1hcmtldE5ldC9pY28vYmxvYi9tYXN0ZXIvY29udHJhY3RzL01pbnRhYmxlVG9rZW4uc29sCiAqLwoKY29udHJhY3QgTWludGFibGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsKICAgIGV2ZW50IE1pbnQoYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IGFtb3VudCk7CiAgICBldmVudCBNaW50RmluaXNoZWQoKTsKCiAgICBib29sIHB1YmxpYyBtaW50aW5nRmluaXNoZWQgPSBmYWxzZTsKCiAgICBtb2RpZmllciBjYW5NaW50KCkgewogICAgICAgIHJlcXVpcmUoIW1pbnRpbmdGaW5pc2hlZCk7CiAgICAgICAgXzsKICAgIH0KCiAgLyoqCiAgKiBAZGV2IEZ1bmN0aW9uIHRvIG1pbnQgdG9rZW5zCiAgKiBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCByZWNpZXZlIHRoZSBtaW50ZWQgdG9rZW5zLgogICAgKiBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBtaW50LgogICAgKiBAcmV0dXJuIEEgYm9vbGVhbiB0aGF0IGluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogICAgZnVuY3Rpb24gbWludChhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5T3duZXIgY2FuTWludCBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKF9hbW91bnQpOwogICAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfYW1vdW50KTsKICAgICAgICBUcmFuc2ZlcigwWDAsIF90bywgX2Ftb3VudCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogIC8qKgogICogQGRldiBGdW5jdGlvbiB0byBzdG9wIG1pbnRpbmcgbmV3IHRva2Vucy4KICAqIEByZXR1cm4gVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAqLwogICAgZnVuY3Rpb24gZmluaXNoTWludGluZygpIG9ubHlPd25lciBwdWJsaWMgcmV0dXJucyAoYm9vbCkgewogICAgICAgIG1pbnRpbmdGaW5pc2hlZCA9IHRydWU7CiAgICAgICAgTWludEZpbmlzaGVkKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0KCmNvbnRyYWN0IFJlcG9ydGVyVG9rZW4gaXMgTWludGFibGVUb2tlbiwgUGF1c2FibGV7CiAgICBzdHJpbmcgcHVibGljIG5hbWUgPSAiUmVwb3J0ZXIgVG9rZW4iOwogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAiTkVXUyI7CiAgICB1aW50MjU2IHB1YmxpYyBkZWNpbWFscyA9IDE4OwoKICAgIGJvb2wgcHVibGljIHRyYWRpbmdTdGFydGVkID0gZmFsc2U7CgogIC8qKgogICogQGRldiBtb2RpZmllciB0aGF0IHRocm93cyBpZiB0cmFkaW5nIGhhcyBub3Qgc3RhcnRlZCB5ZXQKICAgKi8KICAgIG1vZGlmaWVyIGhhc1N0YXJ0ZWRUcmFkaW5nKCkgewogICAgICAgIHJlcXVpcmUodHJhZGluZ1N0YXJ0ZWQpOwogICAgICAgIF87CiAgICB9CgogIC8qKgogICogQGRldiBBbGxvd3MgdGhlIG93bmVyIHRvIGVuYWJsZSB0aGUgdHJhZGluZy4gVGhpcyBjYW4gbm90IGJlIHVuZG9uZQogICovCiAgICBmdW5jdGlvbiBzdGFydFRyYWRpbmcoKSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICB0cmFkaW5nU3RhcnRlZCA9IHRydWU7CiAgICB9CgogIC8qKgogICAqIEBkZXYgQWxsb3dzIGFueW9uZSB0byB0cmFuc2ZlciB0aGUgUmVwb3J0ZXIgdG9rZW5zIG9uY2UgdHJhZGluZyBoYXMgc3RhcnRlZAogICAqIEBwYXJhbSBfdG8gdGhlIHJlY2lwaWVudCBhZGRyZXNzIG9mIHRoZSB0b2tlbnMuCiAgICogQHBhcmFtIF92YWx1ZSBudW1iZXIgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVyZWQuCiAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIGhhc1N0YXJ0ZWRUcmFkaW5nIHdoZW5Ob3RQYXVzZWQgcHVibGljIHJldHVybnMgKGJvb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOwogICAgfQoKICAvKioKICAqIEBkZXYgQWxsb3dzIGFueW9uZSB0byB0cmFuc2ZlciB0aGUgUmVwb3J0ZXIgdG9rZW5zIG9uY2UgdHJhZGluZyBoYXMgc3RhcnRlZAogICogQHBhcmFtIF9mcm9tIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggeW91IHdhbnQgdG8gc2VuZCB0b2tlbnMgZnJvbQogICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvCiAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQgdGhlIGFtb3V0IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcmVkCiAgICovCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBoYXNTdGFydGVkVHJhZGluZyB3aGVuTm90UGF1c2VkIHB1YmxpYyByZXR1cm5zIChib29sKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGVtZXJnZW5jeUVSQzIwRHJhaW4oIEVSQzIwIG9kZFRva2VuLCB1aW50IGFtb3VudCApIHB1YmxpYyB7CiAgICAgICAgb2RkVG9rZW4udHJhbnNmZXIob3duZXIsIGFtb3VudCk7CiAgICB9Cn0KCmNvbnRyYWN0IFJlcG9ydGVyVG9rZW5TYWxlIGlzIE93bmFibGUsIFBhdXNhYmxlewogICAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7CgogIC8vIFRoZSB0b2tlbiBiZWluZyBzb2xkCiAgICBSZXBvcnRlclRva2VuIHB1YmxpYyB0b2tlbjsKCiAgICB1aW50MjU2IHB1YmxpYyBkZWNpbWFsczsgIAogICAgdWludDI1NiBwdWJsaWMgb25lQ29pbjsKCiAgLy8gc3RhcnQgYW5kIGVuZCBibG9jayB3aGVyZSBpbnZlc3RtZW50cyBhcmUgYWxsb3dlZCAoYm90aCBpbmNsdXNpdmUpCiAgICB1aW50MjU2IHB1YmxpYyBzdGFydFRpbWVzdGFtcDsKICAgIHVpbnQyNTYgcHVibGljIGVuZFRpbWVzdGFtcDsKCiAgLy8gYWRkcmVzcyB3aGVyZSBmdW5kcyBhcmUgY29sbGVjdGVkCiAgICBhZGRyZXNzIHB1YmxpYyBtdWx0aVNpZzsKCiAgICBmdW5jdGlvbiBzZXRXYWxsZXQoYWRkcmVzcyBfbmV3V2FsbGV0KSBwdWJsaWMgb25seU93bmVyIHsKICAgICAgICBtdWx0aVNpZyA9IF9uZXdXYWxsZXQ7CiAgICB9CgogIC8vIFRoZXNlIHdpbGwgYmUgc2V0IGJ5IHNldFRpZXIoKQogICAgdWludDI1NiBwdWJsaWMgcmF0ZTsgLy8gaG93IG1hbnkgdG9rZW4gdW5pdHMgYSBidXllciBnZXRzIHBlciB3ZWkKICAgIHVpbnQyNTYgcHVibGljIG1pbkNvbnRyaWJ1dGlvbiA9IDAuMDAwMSBldGhlcjsgIC8vIG1pbmltdW0gY29udHJpYnV0aW8gdG8gcGFydGljaXBhdGUgaW4gdG9rZW5zYWxlCiAgICB1aW50MjU2IHB1YmxpYyBtYXhDb250cmlidXRpb24gPSAxMDAwIGV0aGVyOyAgLy8gZGVmYXVsdCBsaW1pdCB0byB0b2tlbnMgdGhhdCB0aGUgdXNlcnMgY2FuIGJ1eQoKICAvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioKCiAgLy8gYW1vdW50IG9mIHJhaXNlZCBtb25leSBpbiB3ZWkKICAgIHVpbnQyNTYgcHVibGljIHdlaVJhaXNlZDsKCiAgLy8gYW1vdW50IG9mIHJhaXNlZCB0b2tlbnMgCiAgICB1aW50MjU2IHB1YmxpYyB0b2tlblJhaXNlZDsKCiAgLy8gbWF4aW11bSBhbW91bnQgb2YgdG9rZW5zIGJlaW5nIGNyZWF0ZWQKICAgIHVpbnQyNTYgcHVibGljIG1heFRva2VuczsKCiAgLy8gbWF4aW11bSBhbW91bnQgb2YgdG9rZW5zIGZvciBzYWxlCiAgICB1aW50MjU2IHB1YmxpYyB0b2tlbnNGb3JTYWxlOyAgLy8gMzYgTWlsbGlvbiBUb2tlbnMgZm9yIFNBTEUKCiAgLy8gbnVtYmVyIG9mIHBhcnRpY2lwYW50cyBpbiBwcmVzYWxlCiAgICB1aW50MjU2IHB1YmxpYyBudW1iZXJPZlB1cmNoYXNlcnMgPSAwOwoKICAvLyAgZm9yIHdoaXRlbGlzdAogICAgYWRkcmVzcyBwdWJsaWMgY3M7CgogLy8gIGZvciByYXRlCiAgICB1aW50IHB1YmxpYyByOwoKCiAgLy8gc3dpdGNoIG9uL29mZiB0aGUgYXV0aG9yaXNhdGlvbiAsIGRlZmF1bHQ6IGZhbHNlCiAgICBib29sICBwdWJsaWMgZnJlZUZvckFsbCA9IGZhbHNlOwoKICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIGF1dGhvcmlzZWQ7IC8vIGp1c3QgdG8gYW5ub3kgdGhlIGhlY2sgb3V0IG9mIGFtZXJpY2FucwogICAgZXZlbnQgVG9rZW5QdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgYmVuZWZpY2lhcnksIHVpbnQyNTYgdmFsdWUsIHVpbnQyNTYgYW1vdW50KTsKICAgIGV2ZW50IFNhbGVDbG9zZWQoKTsKCiAgICBmdW5jdGlvbiBSZXBvcnRlclRva2VuU2FsZSgpIHB1YmxpYyB7CiAgICAgICAgc3RhcnRUaW1lc3RhbXAgPSAxNTA4Njg0NDAwOyAvLyAyMiBPY3QuIDIwMTcuIDE1OjAwIFVUQwogICAgICAgIGVuZFRpbWVzdGFtcCA9IDE1MjkwNzQ4MDA7ICAgLy8gKEdNVCk6IDIwMTguIEp1bmUgMTUuLCBGcmlkYXkgMTU6MDA6MDAKICAgICAgICBtdWx0aVNpZyA9IDB4RDAwZDA4NUYxMjVFQUZFQTllOGM1RDNmNGJjMjVlNkQwYzkzQWYwZTsKCiAgICAgICAgdG9rZW4gPSBuZXcgUmVwb3J0ZXJUb2tlbigpOwogICAgICAgIGRlY2ltYWxzID0gdG9rZW4uZGVjaW1hbHMoKTsKICAgICAgICBvbmVDb2luID0gMTAgKiogZGVjaW1hbHM7CiAgICAgICAgbWF4VG9rZW5zID0gNjAgKiAoMTAqKjYpICogb25lQ29pbjsKICAgICAgICB0b2tlbnNGb3JTYWxlID0gMzYgKiAoMTAqKjYpICogb25lQ29pbjsKICAgICAgICByYXRlID0gMzAwMDsKICAgIH0KCiAgICBmdW5jdGlvbiBjdXJyZW50VGltZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7CiAgICAgICAgcmV0dXJuIG5vdzsKICAgIH0KICAvKioKICAqIEBkZXYgQ2FsY3VsYXRlcyB0aGUgYW1vdW50IG9mIGJvbnVzIGNvaW5zIHRoZSBidXllciBnZXRzCiAgKi8KICAgIGZ1bmN0aW9uIHNldFRpZXIodWludCBuZXdSKSBpbnRlcm5hbCB7CiAgICAvLyBmaXJzdCA5TSB0b2tlbnMgZ2V0IGV4dHJhIDQyJSBvZiB0b2tlbnMsIG5leHQgaGFsZiBnZXQgMTclCiAgICAgICAgaWYgKHRva2VuUmFpc2VkIDw9IDkwMDAwMDAgKiBvbmVDb2luKSB7CiAgICAgICAgICAgIHJhdGUgPSBuZXdSICogMTQyLzEwMDsKICAgICAgLy9taW5Db250cmlidXRpb24gPSAxMDAgZXRoZXI7CiAgICAgIC8vbWF4Q29udHJpYnV0aW9uID0gMTAwMDAwMCBldGhlcjsKICAgIH0gZWxzZSBpZiAodG9rZW5SYWlzZWQgPD0gMTgwMDAwMDAgKiBvbmVDb2luKSB7CiAgICAgICAgcmF0ZSA9IG5ld1IgKiAxMTcvMTAwOwogICAgICAvL21pbkNvbnRyaWJ1dGlvbiA9IDUgZXRoZXI7CiAgICAgIC8vbWF4Q29udHJpYnV0aW9uID0gMTAwMDAwMCBldGhlcjsKICAgIH0gZWxzZSB7CiAgICAgICAgcmF0ZSA9IG5ld1IgKiAxOwogICAgICAvL21pbkNvbnRyaWJ1dGlvbiA9IDAuMDEgZXRoZXI7CiAgICAgIC8vbWF4Q29udHJpYnV0aW9uID0gMTAwIGV0aGVyOwogICAgfQogICAgfQoKICAvLyBAcmV0dXJuIHRydWUgaWYgY3Jvd2RzYWxlIGV2ZW50IGhhcyBlbmRlZAogICAgZnVuY3Rpb24gaGFzRW5kZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgewogICAgICAgIGlmIChjdXJyZW50VGltZSgpID4gZW5kVGltZXN0YW1wKQogICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAodG9rZW5SYWlzZWQgPj0gdG9rZW5zRm9yU2FsZSkKICAgICAgcmV0dXJuIHRydWU7IC8vIGlmIHdlIHJlYWNoIHRoZSB0b2tlbnNGb3JTYWxlCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAvKioKICAqIEBkZXYgdGhyb3dzIGlmIHBlcnNvbiBzZW5kaW5nIGlzIG5vdCBjb250cmFjdCBvd25lciBvciBjcyByb2xlCiAgICovCiAgICBtb2RpZmllciBvbmx5Q1Nvck93bmVyKCkgewogICAgICAgIHJlcXVpcmUoKG1zZy5zZW5kZXIgPT0gb3duZXIpIHx8IChtc2cuc2VuZGVyPT1jcykpOwogICAgICAgIF87CiAgICB9CiAgICBtb2RpZmllciBvbmx5Q1MoKSB7CiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNzKTsKICAgICAgICBfOwogICAgfQoKICAvKioKICAqIEBkZXYgdGhyb3dzIGlmIHBlcnNvbiBzZW5kaW5nIGlzIG5vdCBhdXRob3Jpc2VkIG9yIHNlbmRzIG5vdGhpbmcKICAqLwogICAgbW9kaWZpZXIgb25seUF1dGhvcmlzZWQoKSB7CiAgICAgICAgcmVxdWlyZSAoYXV0aG9yaXNlZFttc2cuc2VuZGVyXSB8fCBmcmVlRm9yQWxsKTsKICAgICAgICByZXF1aXJlIChjdXJyZW50VGltZSgpID49IHN0YXJ0VGltZXN0YW1wKTsKICAgICAgICByZXF1aXJlICghaGFzRW5kZWQoKSk7CiAgICAgICAgcmVxdWlyZSAobXVsdGlTaWcgIT0gMHgwKTsKICAgICAgICByZXF1aXJlKHRva2Vuc0ZvclNhbGUgPiB0b2tlblJhaXNlZCk7IC8vIGNoZWNrIHdlIGFyZSBub3Qgb3ZlciB0aGUgbnVtYmVyIG9mIHRva2Vuc0ZvclNhbGUKICAgICAgICBfOwogICAgfQoKICAvKioKICAqIEBkZXYgYXV0aG9yaXNlIGFuIGFjY291bnQgdG8gcGFydGljaXBhdGUKICAqLwogICAgZnVuY3Rpb24gYXV0aG9yaXNlQWNjb3VudChhZGRyZXNzIHdob20pIG9ubHlDU29yT3duZXIgcHVibGljIHsKICAgICAgICBhdXRob3Jpc2VkW3dob21dID0gdHJ1ZTsKICAgIH0KCiAgLyoqCiAgKiBAZGV2IGF1dGhvcmlzZSBhIGxvdCBvZiBhY2NvdW50cyBpbiBvbmUgZ28KICAqLwogICAgZnVuY3Rpb24gYXV0aG9yaXNlTWFueUFjY291bnRzKGFkZHJlc3NbXSBtYW55KSBvbmx5Q1Nvck93bmVyIHB1YmxpYyB7CiAgICAgICAgZm9yICh1aW50MjU2IGkgPSAwOyBpIDwgbWFueS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBhdXRob3Jpc2VkW21hbnlbaV1dID0gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogIC8qKgogICogQGRldiBiYW4gYW4gYWNjb3VudCBmcm9tIHBhcnRpY2lwYXRpb24gKGRlZmF1bHQpCiAgKi8KICAgIGZ1bmN0aW9uIGJsb2NrQWNjb3VudChhZGRyZXNzIHdob20pIG9ubHlDU29yT3duZXIgcHVibGljIHsKICAgICAgICBhdXRob3Jpc2VkW3dob21dID0gZmFsc2U7CiAgICB9ICAKICAgIAogIC8qKgogICogQGRldiBzZXQgYSBuZXcgQ1MgcmVwcmVzZW50YXRpdmUKICAqLwogICAgZnVuY3Rpb24gc2V0Q1MoYWRkcmVzcyBuZXdDUykgb25seU93bmVyIHB1YmxpYyB7CiAgICAgICAgY3MgPSBuZXdDUzsKICAgIH0KCiAgIC8qKgogICogQGRldiBzZXQgYSBuZXdSYXRlIGlmIGhhdmUgYSBiaWcgZGlmZmVyZW50IGluIGV0aGVyL2RvbGxhciByYXRlIAogICovCiAgICBmdW5jdGlvbiBzZXRSYXRlKHVpbnQgbmV3UmF0ZSkgb25seUNTIHB1YmxpYyB7CiAgICAgICAgcmVxdWlyZSgwIDwgbmV3UmF0ZSAmJiBuZXdSYXRlIDw9IDgwMDApOyAKICAgICAgICByID0gbmV3UmF0ZTsKICAgIH0KCgogICAgZnVuY3Rpb24gcGxhY2VUb2tlbnMoYWRkcmVzcyBiZW5lZmljaWFyeSwgdWludDI1NiBfdG9rZW5zKSBvbmx5Q1MgcHVibGljIHsKICAgIC8vY2hlY2sgbWluaW11bSBhbmQgbWF4aW11bSBhbW91bnQKICAgICAgICByZXF1aXJlKF90b2tlbnMgIT0gMCk7CiAgICAgICAgcmVxdWlyZSghaGFzRW5kZWQoKSk7CiAgICAgICAgdWludDI1NiBhbW91bnQgPSAwOwogICAgICAgIGlmICh0b2tlbi5iYWxhbmNlT2YoYmVuZWZpY2lhcnkpID09IDApIHsKICAgICAgICAgICAgbnVtYmVyT2ZQdXJjaGFzZXJzKys7CiAgICAgICAgfQogICAgICAgIHRva2VuUmFpc2VkID0gdG9rZW5SYWlzZWQuYWRkKF90b2tlbnMpOyAvLyBzbyB3ZSBjYW4gZ28gc2xpZ2h0bHkgb3ZlcgogICAgICAgIHRva2VuLm1pbnQoYmVuZWZpY2lhcnksIF90b2tlbnMpOwogICAgICAgIFRva2VuUHVyY2hhc2UoYmVuZWZpY2lhcnksIGFtb3VudCwgX3Rva2Vucyk7CiAgICB9CgogIC8vIGxvdyBsZXZlbCB0b2tlbiBwdXJjaGFzZSBmdW5jdGlvbgogICAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQyNTYgYW1vdW50KSBvbmx5QXV0aG9yaXNlZCB3aGVuTm90UGF1c2VkIGludGVybmFsIHsKCiAgICAgICAgc2V0VGllcihyKTsKCiAgICAvL2NoZWNrIG1pbmltdW0gYW5kIG1heGltdW0gYW1vdW50CiAgICAgICAgcmVxdWlyZShhbW91bnQgPj0gbWluQ29udHJpYnV0aW9uKTsKICAgICAgICByZXF1aXJlKGFtb3VudCA8PSBtYXhDb250cmlidXRpb24pOwoKICAgIC8vIGNhbGN1bGF0ZSB0b2tlbiBhbW91bnQgdG8gYmUgY3JlYXRlZAogICAgICAgIHVpbnQyNTYgdG9rZW5zID0gYW1vdW50Lm11bChyYXRlKTsKCiAgICAvLyB1cGRhdGUgc3RhdGUKICAgICAgICB3ZWlSYWlzZWQgPSB3ZWlSYWlzZWQuYWRkKGFtb3VudCk7CiAgICAgICAgaWYgKHRva2VuLmJhbGFuY2VPZihiZW5lZmljaWFyeSkgPT0gMCkgewogICAgICAgICAgICBudW1iZXJPZlB1cmNoYXNlcnMrKzsKICAgICAgfQogICAgICAgIHRva2VuUmFpc2VkID0gdG9rZW5SYWlzZWQuYWRkKHRva2Vucyk7IC8vIHNvIHdlIGNhbiBnbyBzbGlnaHRseSBvdmVyCiAgICAgICAgdG9rZW4ubWludChiZW5lZmljaWFyeSwgdG9rZW5zKTsKICAgICAgICBUb2tlblB1cmNoYXNlKGJlbmVmaWNpYXJ5LCBhbW91bnQsIHRva2Vucyk7CiAgICAgICAgbXVsdGlTaWcudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsgLy8gYmV0dGVyIGluIGNhc2UgYW55IG90aGVyIGV0aGVyIGVuZHMgdXAgaGVyZQogICAgfQoKICAvLyB0cmFuc2ZlciBvd25lcnNoaXAgb2YgdGhlIHRva2VuIHRvIHRoZSBvd25lciBvZiB0aGUgcHJlc2FsZSBjb250cmFjdAogICAgZnVuY3Rpb24gZmluaXNoU2FsZSgpIHB1YmxpYyBvbmx5T3duZXIgewogICAgICAgIHJlcXVpcmUoaGFzRW5kZWQoKSk7CgogICAgLy8gYXNzaWduIHRoZSByZXN0IG9mIHRoZSA2ME0gdG9rZW5zIHRvIHRoZSByZXNlcnZlCiAgICAgICAgdWludCB1bmFzc2lnbmVkOwogICAgICAgIGlmKG1heFRva2VucyA+IHRva2VuUmFpc2VkKSB7CiAgICAgICAgICAgIHVuYXNzaWduZWQgPSBtYXhUb2tlbnMuc3ViKHRva2VuUmFpc2VkKTsKICAgICAgICAgICAgdG9rZW4ubWludChtdWx0aVNpZyx1bmFzc2lnbmVkKTsKICAgIH0KICAgICAgICB0b2tlbi5maW5pc2hNaW50aW5nKCk7CiAgICAgICAgdG9rZW4udHJhbnNmZXJPd25lcnNoaXAob3duZXIpOwogICAgICAgIFNhbGVDbG9zZWQoKTsKICAgIH0KCiAgLy8gZmFsbGJhY2sgZnVuY3Rpb24gY2FuIGJlIHVzZWQgdG8gYnV5IHRva2VucwogICAgZnVuY3Rpb24gKCkgcHVibGljIHBheWFibGUgewogICAgICAgIGJ1eVRva2Vucyhtc2cuc2VuZGVyLCBtc2cudmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGVtZXJnZW5jeUVSQzIwRHJhaW4oIEVSQzIwIG9kZFRva2VuLCB1aW50IGFtb3VudCApIHB1YmxpYyB7CiAgICAgICAgb2RkVG9rZW4udHJhbnNmZXIob3duZXIsIGFtb3VudCk7CiAgICB9Cn0='.
	

]
